# 如何建立最大似然数据标注系统

> 原文：<https://towardsdatascience.com/how-to-set-up-an-ml-data-labeling-system-4eea9b15181f?source=collection_archive---------14----------------------->

![](img/17bef45a8333b28645b4d20244e08a72.png)![](img/466e9d0aa7be5f636609f2b13e4d7930.png)

ML 模型需要各种任务和模态的标记数据。左图:带有 [Supervise.ly](https://medium.com/deep-systems/video-labeling-tool-for-deep-learning-training-data-for-computer-vision-with-supervisely-bebbcefc55d) 的视频标注。右图:对带有[标签](https://docs.tagtog.net/)的文本进行命名实体识别。

今天大多数生产机器学习应用都是基于**监督学习**。在这种设置中，机器学习模型在一组标记为**的训练数据**上进行训练，以便学习如何完成某项任务。例如，ML 模型可以在标记有该图像中的宠物类型的图像上进行训练，以便训练的模型可以告诉你在一组未标记的图像中存在什么宠物。

为了获得带标签的训练数据，ML 团队经常依赖人类注释者，他们为模型的训练标记例子。开始时，标签“团队”可能由一个 ML 工程师一次在图像上画几个小时的方框组成。随着系统变得越来越成熟，团队希望通过利用自动化和依靠大型运营团队来产生更大数量的标记数据。

从概念上讲，标签系统很简单:用户应该能够向标签系统发送数据，并取回该数据的标签。然而，根据您的问题设置和需求，有许多方法可以设置带标签的数据管道。为了帮助你选择适合你的，这里有一些我们学到的关于如何建立一个伟大的 ML 数据标签系统的经验。

# 你想从标签中得到什么？

在我们讨论不同的贴标设置之前，我们应该先讨论一下在查看贴标系统时应该评估的因素。

*   **准确性:**一个标注系统应该准确一致地标注数据，否则你的模型就会学会做错事！例如，如果一个数据点被标记为欺诈，您希望确保它实际上是欺诈，而不是标记者的错误，否则您训练的模型在生产中运行时可能会犯类似的错误。虽然标签系统不可避免地会有一些错误率，但没有什么比由于标签准确性差而不知道是否可以信任您的数据和指标更糟糕的了！
*   **速度:**数据要快速大批量标注。一些应用程序使用标签作为实时模型预测的 QA，并要求接近实时的响应时间(一小时内)。然而，标记离线培训工作流可能会牺牲吞吐量的延迟。标签的数量可以从一周数百个样本到数十万个样本不等。
*   **成本:**标签要在时间和金钱上低成本生产。贴标签需要时间，因为它通常需要工程时间来建立数据管道，还需要操作时间来做实际的标签。这个时间是要花钱的，无论是直接雇人还是通过与外部提供商签约。

您的标签系统中的许多决策将在这些因素之间进行权衡。例如，如果您有严格的准确性要求，您可以实施 QA 流程来提高标签质量，但会增加额外的时间和成本。

然而，通常有一些技术可以统一改善所有这些因素。更好的贴标工具、自动化和特定领域的优化都可以明显提高贴标效率。

# 标签选项

ML 团队可以选择建立或购买标签系统的两个关键部分:

1.  用户检查、编辑和存储数据和标签所需的工具和软件。
2.  使用工具进行贴标的贴标机操作人员。

一些供应商将这两个组件作为完全托管的服务提供，而一些供应商只提供其中一个。一个 ML 团队也可以决定构建两者。一般来说，你自己建立的越多，你对标签过程的控制就越多，但是在时间和金钱上的成本也更高。

## **全面管理的标签服务**

完全托管服务允许您购买工具和操作人员进行贴标，通常按标签收费。这需要 ML 团队投入最少的时间，尽管他们会因此支付一些额外费用。

完全托管的服务是不需要专业工具或专业知识的标准任务的理想选择。完全托管的服务往往会针对最受欢迎的 ML 任务(例如，图像分类和检测)优化其技术工具链，并在劳动力成本较低的国家/地区部署运营力量，从而显著降低每个标签的成本。此外，一些完全托管的服务公司可能会提供附加功能，如标记自动化功能或基于标记数据的现成模型培训。

然而，全面管理的服务通常在较小的合同上投入较少的精力。一些较大的供应商将要求最低标签量，并且不会接受每年低于 10 万美元的合同！这是因为完全管理的提供者必须训练和维持他们自己的相当大的操作力量。为了获得合理的贴标质量，通常需要付出巨大的努力来培训贴标机完成某项任务，或者在不同客户的任务之间移动贴标机，这需要最小的合同规模来使这项投资物有所值。其他提供商提供现收现付定价，支持小型/尖峰标签工作负载，但代价是价格更高，复杂任务的标签准确性降低。

这些类型的提供商包括 Scale AI、Playment、阿彭、亚马逊 Sagemaker Ground Truth 和 Hive AI。

## 购买贴标工具

当您的钱比时间多时，完全托管服务通常是最佳选择。当您的组织扩大规模并考虑成本优化时，您可能希望切换到将标注操作与标注工具分离的模式。贴标工具由软件组成，使运营团队能够。它们由标记数据的 ui、跟踪标签的存储系统和以编程方式移动数据的 API 组成。

当独立考虑标记工具时，公司倾向于首先考虑开源工具。开源工具对于小批量的标签工作很有效，但是没有公司开发的软件那么多的支持和功能。开源工具通常不是托管的(因此需要一些初始设置)，并且通常不支持更高级的功能，如贴标机监控、任务分配和 QA 流程，这些功能对于将贴标扩展到大规模工作人员至关重要。这就是团队决定购买专用标签软件的原因。

购买贴标工具很像购买任何其他 SaaS 软件。大多数工具都托管在 SaaS，使得离岸操作团队无需大量 it 设置就能轻松访问。一些公司为敏感数据提供内部工具。一些工具提供商还将包括与他们过去合作过的操作人员合作的选项。然而，所有这些都为 ML 团队提供了为他们自己的操作人员创建帐户的能力。

ML 团队通常由工程师组成，他们更熟悉 Jupyter notebooks 和 Tensorflow 等机器学习工具，而不是 React 和 Node 等 web 开发工具。与建立专门的 Python GUIs 相比，购买标记工具允许团队使用更高质量的最终产品，并且比雇佣一组工具工程师来开发一个完美的 web UI 更便宜、更快速。

此外，在购买贴标工具时有很多选择。一些公司专门从事特定类型的标记——自然语言处理对音频对图像对视频——允许 ML 团队为工作选择最好的工具。如果没有足够好的产品，你可以雇佣一些工具工程师来自己开发。

仅工具提供者的例子包括 Labelbox、Dataloop、SuperAnnotate、Supervisely 和 Datasaur。

## 购买贴标操作劳动力

等式的另一半是贴标工人。如果您想以合理的成本扩大您的贴标产量，您可能不想让您的 ML 工程师每天数小时贴标数据。如果你能以很低的成本让离岸承包商做同样的工作，你甚至可能不想雇佣全职员工。

购买运营人员有很多种选择。如果你在寻找灵活的一次性工作，从 TaskRabbit 雇佣一个承包商相对容易。这有利于贴标签的工作，有灵活的需求，因为这是相对容易的训练一个贴标机一天，并保持他们只要你需要他们。另一方面，这比雇佣海外劳动力成本更高，因此更难扩大规模。

随着贴标需求的增加，您可能希望与能够提供更多贴标劳动力的运营提供商签订合同。这些贴标机更便宜，因为它们位于工资更低的国家，而且它们的劳动力习惯于为许多不同的公司和领域做标准的 ML 任务。

然而，对离岸工人的依赖意味着可能存在语言或文化障碍，需要额外的培训来实现所需的标签准确性。在我之前的一份工作中就有这样一个例子:我们曾要求我们的标签团队在校车图片周围画出边界框，但我们的标签团队所在的国家没有校车。我们必须编写一份培训指南，其中包含许多校车的示例图片，还包含一些看起来像校车的反例，比如同样黄色的皮卡车，以训练贴标机产生准确的标签。

这些供应商通常要求长期的承诺和最小的合同规模，这是基于预先预留一些贴标时间，使得 ML 团队有必要有一些持续的贴标需求，以使贴标机保持忙碌，或者冒着浪费已经付费的时间的风险。一些公司可能会提供会说英语的运营经理，以便更容易地培训和管理离岸团队，而其他公司只是提供招聘服务，并将协调工作留给 ML 团队。

外包运营提供商的例子包括 Cloudfactory、Samasource、TaskUs 和 iMerit。

## 卷你自己的

你也可以选择自己构建一切！这使您可以最大限度地控制贴标过程，但会花费大量时间和金钱。我不建议在大多数情况下这样做，但是有几个原因让你想把所有事情都放在家里:

*   您的任务如此独特，以至于外部提供的产品非常差，您可以在内部轻松构建更高质量的标签工具。
*   您拥有领域专业知识/理解能力，这使您能够以外部产品不会考虑的方式显著加快或自动化标记过程。
*   您的贴标任务非常困难，因此最好在内部雇佣和培训贴标机，以确保更好的质量控制和保留。这在医学机器学习等领域非常重要，在这些领域，唯一能够生成可接受质量标签的人是昂贵的医生！
*   你的运营规模足够大(比如谷歌/脸书的规模)，从零开始建立一个内部系统比从第三方购买服务更便宜。

构建标注工具可能是一项有些令人望而生畏的任务，并且根据任务的难度和运营团队的规模，其复杂性可能会急剧增加。您需要构建的组件包括:

*   用于查看数据和修改标签的用户界面。
*   一个工作流引擎，用于在不同的人、QA 标签之间分配标签工作，并协调冲突的标签。
*   贴标机质量+吞吐量统计，以监控和管理他们的生产力。
*   标签存储和版本控制。
*   自动化/预贴标功能，减少人工贴标机的工作量。

建立和管理内部运营团队很像管理普通员工，尽管规模远高于工程师/项目经理。你需要:

*   贴标机的人力资源基础设施。这包括招聘，面试和招聘贴标机的过程。一些团队将雇用运营人员作为全职员工，但大多数美国团队将依赖 1099 承包商来降低成本。
*   运营经理监督贴标工人。他们的工作包括与 ML 团队就贴标指南进行沟通，培训贴标机遵循这些指南，然后在他们工作时监控贴标产量和准确性。

# 最佳实践

不管你选择哪种标签，总有一些最佳实践可以让 ML 团队获得最好的结果。

## 编写良好的标签说明

不管你有什么样的标签设置，你都不可避免地需要训练一支标签队伍来根据 ML 团队定义的一组指令对数据进行注释。当贴标机遇到有趣的边缘情况或需求改变时，指令也必须发展以准确反映 ML 团队的期望。即使当您切换贴标工作人员或工具时，您也可以使用相同的贴标说明快速启动并运行新的贴标系统。

如果没有一套可靠的贴标说明，贴标机将会产生不正确(或者更糟，不一致)的结果，浪费时间和金钱。更重要的是，错误不是均匀地分布在整个数据集上，而是在数据集的某些子集上出现标记错误，如模糊的情况或标记者不知道如何处理的某些罕见情况。以下是一些可行的建议，以确保事情做得正确:

*   对于创建和编辑说明，请使用类似 comment 的工具，该工具允许多个团队成员编辑贴标说明，对有问题的更改进行评论，并与贴标机共享最终版本作为参考。
*   包括困难或模糊案例的例子(带图片),以及如何处理的说明。书面说明通常很难理解，但图片有助于清楚地传达应该做什么。
*   对您的标签文档进行版本控制。这有助于跟踪哪些贴标机已被重新培训，何时。这对于跨数据集的不同段跟踪标注说明的变化非常重要，尤其是当您需要更改以前的标注时！

对于伟大的标签说明的例子， [Landing AI](https://landing.ai/data-labeling-of-images-for-supervised-learning/) 为工业缺陷检测提供了一套伟大的标签说明，并为困难/模糊的场景提供了一些说明的例子。 [Waymo 开放数据集](https://github.com/waymo-research/waymo-open-dataset/blob/master/docs/labeling_specifications.md)还包含何时标记对象以及如何标记对象的说明。

## 信任但核实

一些团队会收到标签，并立即根据这些数据训练一个模型。然而，他们的模型的性能指标会很差，他们也不知道为什么。经过数周的焦虑和超参数优化，他们将检查标签，并意识到其中许多是不正确的，这意味着他们的模型在训练时变得混乱，他们的性能指标首先是不可靠的。

对你收到的新标签做一些基本的质量检查是非常重要的。虽然您的标签提供商可能在他们的流程中有一个 QA 步骤，并在您的合同中写入了标签质量承诺，但最终验证标签质量符合您预期的唯一方法是亲自看一看。事实上，许多标签错误不一定是丢失标签的直接错误，而是 ML 团队和标签团队之间沟通不畅和误解的结果。

检查标签质量的一个简单方法是简单地可视化由贴标系统产生的新标签的子集。这可以由 ML 工程师或产品经理在几个小时内完成，这可以是一个很好的检查，揭示标签说明含糊不清或被误解的地方。

确保标签质量保持高水平是一项持续的工作。错误悄悄溜走，最终被抓住，然后被修复。当标签数量变大时，团队应该将他们的 QA 时间集中在[他们的模型和标签不一致的地方](https://medium.com/aquarium-learning/its-the-data-stupid-2999841a4bf3)，这有效地处理了标签错误的数据点。甚至有更高技能的内部操作人员专门检查来自外部供应商的标签质量也是有用的！

## 在贴标系统之间进行烘烤

设置标签系统有很多选择！不仅要决定生产多少与购买多少，还有许多供应商提供类似的工具来完成某些标记任务，而且很难缩小购买和生产的选项/组合对您来说是最好的。通常有可能使用一组非常粗略的要求(支持贴标任务、定价、可用吞吐量等。)将一个大的选项列表削减到大约 5 个左右的最终候选项，但是您仍然需要一个过程来选择使用哪个系统。

在这里，重要的是要建立你要优化的评估标准。对于您的用例，贴标精度、速度和成本的正确组合是什么？一旦你有了一套明确的评估标准和一份标签选项的候选名单，你就可以在竞争的标签系统之间进行**测试**。这个测试的目的是在一个小数据集上对不同的标签系统进行比较，评估哪个选项在您的评估标准上表现最好，然后使用该信息选择哪个选项。

为了构建这个烘焙，我们建议您在内部使用专家贴标机手动标记一个小的“黄金”数据集。这位专家标签员通常最终成为为 ML 系统设定需求的 ML 团队的一员，例如 ML 工程师或产品经理。由于贴标机也是知道他们想从 ML 系统中得到什么的人，你可以相当合理地假设这组数据是你所能得到的最接近完美的标签。这位专家标签员还应该构建一套基本的标签说明，用于在新的数据集上生成更多的标签。

之后，您可以向候选贴标系统发送相同的黄金数据集(无标签)和相同的贴标说明。你可以很容易地衡量速度和成本。为了测量标签的准确性，您可以计算指标，将每个供应商的标签与您的专业贴标机的黄金标签集进行比较。

现在，您可以根据准确性、速度和成本的组合，选择在您的评估中得分最高的选项！这是一个很好的比较选项的定量方法，尽管你需要衡量你想要在这三个因素之间做出什么样的权衡。

每 3-6 个月重复一次这个练习也是有用的，看看其他提供者是否能达到更好的效果。贴标是一个竞争相当激烈的领域，相对来说已经商品化了，所以从一个供应商换到另一个供应商的摩擦相对较小，只要他们在你的烘焙比赛中表现良好。我们的公司 [Aquarium](http://aquariumlearning.com/) ，使得 ML 团队可以很容易地在标签系统之间进行权衡。水族馆允许团队将数据发送给标签供应商进行标记，然后与黄金数据集进行比较，评估结果的准确性。

# 摘要

有时弄清楚如何扩展 ML 系统是令人畏惧的，拥有一个良好的标记数据流是运送优秀模型的重要部分。在本帖中，我们列出了多种选择来设置 ML 标签系统，在成本、速度和灵活性之间进行权衡。我们还制定了一个流程，允许您公平地评估不同的标签选项，并选择最适合您的用例的选项。