# ä½¿ç”¨ Python è¿›è¡Œçº¿æ€§å›å½’çš„ç®€å•æŒ‡å—

> åŸæ–‡ï¼š<https://towardsdatascience.com/a-simple-guide-to-linear-regression-using-python-7050e8c751c1?source=collection_archive---------3----------------------->

## å­¦ä¹ æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒåŒæ—¶åœ¨ Python ä¸­æ„å»ºçº¿æ€§å›å½’æ¨¡å‹

![](img/47ccbfcf491396ea9fe3b8d9c99c7fb8.png)

ä½œè€…å›¾ç‰‡

æ¯ä¸ªæ•°æ®ç§‘å­¦å®¶åº”è¯¥å­¦ä¹ çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•ä¹‹ä¸€æ˜¯çº¿æ€§å›å½’ã€‚è¿™ä¸ªç®€å•çš„æ¨¡å‹å¸®åŠ©æˆ‘ä»¬æŒæ¡æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä¾‹å¦‚è¯†åˆ«å› å˜é‡å’Œè‡ªå˜é‡ï¼Œå»ºç«‹æ¨¡å‹ï¼Œä»¥åŠç†è§£æ¨¡å‹èƒŒåçš„æ•°å­¦å’Œç»Ÿè®¡å­¦ã€‚

åœ¨ Python ä¸­æœ‰ä¸¤ç§è¿›è¡Œçº¿æ€§å›å½’çš„å¸¸ç”¨æ–¹æ³•â€”â€”ä½¿ç”¨ statsmodel å’Œ sklearn åº“ã€‚ä¸¤è€…éƒ½æ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼Œå„æœ‰åˆ©å¼Šã€‚

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸¤è€…è¿›è¡Œçº¿æ€§å›å½’ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å°†å­¦ä¹ çº¿æ€§å›å½’æ¨¡å‹èƒŒåçš„æ‰€æœ‰æ ¸å¿ƒæ¦‚å¿µã€‚

```
**Table of Contents** 1\. [What is Linear Regression?](#8e94)
2\. [Linear Regression in Python](#65ed)
 - [The Data](#cbcb)
3\. [Linear Regression with Statsmodels](#0e95)
 - [Simple Linear Regression](#b74c)
 - [Multiple Linear Regression](#0fa8)
4\. [Linear Regression with sklearn](#894e)
5\. [Python for Data Science Cheat Sheet (Free PDF)](#ee7e)
```

# ä»€ä¹ˆæ˜¯çº¿æ€§å›å½’ï¼Ÿ

çº¿æ€§å›å½’æ˜¯ä¸€ç§å»ºæ¨¡ä¸¤ä¸ª(ç®€å•çº¿æ€§å›å½’)æˆ–å¤šä¸ªå˜é‡(å¤šå…ƒçº¿æ€§å›å½’)ä¹‹é—´å…³ç³»çš„æ–¹æ³•ã€‚åœ¨ç®€å•çº¿æ€§å›å½’ä¸­ï¼Œä¸€ä¸ªå˜é‡è¢«è§†ä¸ºé¢„æµ‹å˜é‡æˆ–è‡ªå˜é‡ï¼Œè€Œå¦ä¸€ä¸ªå˜é‡è¢«è§†ä¸ºç»“æœå˜é‡æˆ–å› å˜é‡ã€‚

è¿™æ˜¯çº¿æ€§å›å½’æ–¹ç¨‹:

![](img/6bf3b073d30f0425225a7d6372987ff9.png)

å…¶ä¸­ï¼Œ`y`ä¸ºå› å˜é‡(ç›®æ ‡å€¼)ï¼Œ`x1, x2, â€¦ xn`ä¸ºè‡ªå˜é‡(é¢„æµ‹å€¼)ï¼Œ`b0`ä¸ºæˆªè·ï¼Œ`b1, b2, ... bn`ä¸ºç³»æ•°ï¼Œ`n`ä¸ºè§‚å¯Ÿå€¼ã€‚

å¦‚æœç­‰å¼ä¸æ¸…æ¥šï¼Œä¸‹é¢çš„å›¾ç‰‡å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚

![](img/b3ed5239834381742416a674ef58cc3e.png)

ä¿¡ç”¨: [Quora](https://www.quora.com/What-does-regression-mean-in-statistics-and-machine-learning)

åœ¨å›¾ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªçº¿æ€§å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªè‡ªå˜é‡å¢åŠ æˆ–å‡å°‘ï¼Œå› å˜é‡ä¹Ÿä¼šå¢åŠ æˆ–å‡å°‘ã€‚

çº¿æ€§å›å½’å¯ç”¨äºè¿›è¡Œç®€å•çš„é¢„æµ‹ï¼Œä¾‹å¦‚æ ¹æ®å­¦ä¹ çš„å°æ—¶æ•°é¢„æµ‹è€ƒè¯•åˆ†æ•°ï¼Œæ ¹æ®å·¥ä½œç»éªŒé¢„æµ‹å‘˜å·¥çš„å·¥èµ„ç­‰ç­‰ã€‚

ç†è®ºå¤Ÿäº†ï¼æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•ç”¨ Python åšä¸€ä¸ªçº¿æ€§å›å½’ã€‚

# Python ä¸­çš„çº¿æ€§å›å½’

åœ¨ Python ä¸­æœ‰ä¸åŒçš„æ–¹æ³•è¿›è¡Œçº¿æ€§å›å½’ã€‚æœ€å—æ¬¢è¿çš„ä¸¤ä¸ªé€‰é¡¹æ˜¯ä½¿ç”¨ statsmodels å’Œ scikit-learn åº“ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å°†ç”¨æ¥åˆ›å»ºçº¿æ€§æ¨¡å‹çš„æ•°æ®ã€‚

## æ•°æ®

ä¸ºäº†åœ¨ Python ä¸­è¿›è¡Œçº¿æ€§å›å½’ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åŒ…å«æ³¢å£«é¡¿æˆ¿ä»·çš„æ•°æ®é›†ã€‚åŸå§‹æ•°æ®é›†æ¥è‡ª sklearn åº“ï¼Œä½†æˆ‘å¯¹å…¶è¿›è¡Œäº†ç®€åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºæ„å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªçº¿æ€§å›å½’ã€‚

ä½ å¯ä»¥åœ¨æˆ‘çš„ Github æˆ–è€… T2 çš„ Google Drive ä¸Šä¸‹è½½è¿™ä¸ªæ•°æ®é›†ã€‚ç¡®ä¿å°†è¿™ä¸ª CSV æ–‡ä»¶æ”¾åœ¨ Python è„šæœ¬æ‰€åœ¨çš„ç›®å½•ä¸­ã€‚

è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ•°æ®é›†ã€‚ä¸ºæ­¤ï¼Œå¯¼å…¥ pandas å¹¶è¿è¡Œä¸‹é¢çš„ä»£ç ã€‚

```
**import pandas as pd**
df_boston = pd.read_csv('Boston House Prices.csv')
df_boston
```

![](img/c642c3b9c38326249dc88153cf439bd6.png)

ä½œè€…å›¾ç‰‡

æœ‰ 3 åˆ—ã€‚â€œä»·å€¼â€åˆ—åŒ…å«ä»¥ 1000 ç¾å…ƒä¸ºå•ä½çš„è‡ªä½æˆ¿å±‹çš„ä¸­å€¼(è¿™æ˜¯æˆ‘ä»¬æƒ³è¦é¢„æµ‹çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡å€¼)ã€‚â€œæˆ¿é—´â€å’Œâ€œè·ç¦»â€åˆ—åŒ…å«æ¯ä¸ªä½æ‰€çš„å¹³å‡æˆ¿é—´æ•°å’Œåˆ°äº”ä¸ªæ³¢å£«é¡¿å°±ä¸šä¸­å¿ƒçš„åŠ æƒè·ç¦»(ä¸¤è€…éƒ½æ˜¯é¢„æµ‹å€¼)

ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¸Œæœ›æ ¹æ®æˆ¿å±‹çš„æˆ¿é—´æ•°é‡åŠå…¶åˆ°å°±ä¸šä¸­å¿ƒçš„è·ç¦»æ¥é¢„æµ‹æˆ¿å±‹ä»·å€¼ã€‚

# å¸¦ç»Ÿè®¡æ¨¡å‹çš„çº¿æ€§å›å½’

Statsmodels æ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬è¿›è¡Œç»Ÿè®¡æµ‹è¯•å’Œä¼°è®¡æ¨¡å‹çš„æ¨¡å—ã€‚å®ƒä¸ºæ¯ä¸ªä¼°è®¡é‡æä¾›äº†ä¸€ä¸ªå¹¿æ³›çš„ç»“æœåˆ—è¡¨ã€‚

å¦‚æœæ‚¨å·²ç»é€šè¿‡ Anaconda å®‰è£…äº† Pythonï¼Œé‚£ä¹ˆæ‚¨å·²ç»å®‰è£…äº† statsmodelsã€‚å¦‚æœæ²¡æœ‰ï¼Œä½ å¯ä»¥ç”¨ conda æˆ–è€… pip å®‰è£…ã€‚

```
# pip
pip install statsmodels# conda
conda install -c conda-forge statsmodels
```

ä¸€æ—¦å®‰è£…äº† statsmodelï¼Œå°±ç”¨ä¸‹é¢çš„ä»£ç è¡Œå¯¼å…¥å®ƒã€‚

```
**import statsmodels.api as sm**
```

åˆ›å»ºçº¿æ€§å›å½’ä¹‹å‰è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å®šä¹‰å› å˜é‡å’Œè‡ªå˜é‡ã€‚æˆ‘ä»¬å·²ç»åœ¨å‰ä¸€èŠ‚è®¨è®ºè¿‡äº†ã€‚å› å˜é‡æ˜¯æˆ‘ä»¬æƒ³è¦é¢„æµ‹çš„å€¼ï¼Œä¹Ÿç§°ä¸ºç›®æ ‡å€¼ã€‚å¦ä¸€æ–¹é¢ï¼Œè‡ªå˜é‡æ˜¯é¢„æµ‹å› å­ã€‚

åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬æœ‰ 2 ä¸ªé¢„æµ‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä¸­ä»»ä½•ä¸€ä¸ªæˆ–ä¸¤ä¸ªã€‚

è®©æˆ‘ä»¬ä»ç®€å•çš„çº¿æ€§å›å½’å¼€å§‹ã€‚ç®€å•çš„çº¿æ€§å›å½’ä¼°è®¡ä¸€ä¸ªè‡ªå˜é‡**å’Œä¸€ä¸ªå› å˜é‡**ä¹‹é—´çš„å…³ç³»ã€‚

## ç®€å•çº¿æ€§å›å½’

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘å°†é€‰æ‹©â€œæˆ¿é—´â€ä½œä¸ºæˆ‘ä»¬çš„é¢„æµ‹/ç‹¬ç«‹å˜é‡ã€‚

*   å› å˜é‡:â€œå€¼â€
*   è‡ªå˜é‡:â€œæˆ¿é—´â€

è®©æˆ‘ä»¬ä¹Ÿåœ¨ä»£ç ä¸­å®šä¹‰å› å˜é‡å’Œè‡ªå˜é‡ã€‚

```
y = df_boston['Value'] # dependent variable
x = df_boston['Rooms'] # independent variable
```

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨çº¿æ€§ä»£æ•°ç¬¦å·â€”â€”å°å†™å­—æ¯ç”¨äºå‘é‡ï¼Œå¤§å†™å­—æ¯ç”¨äºçŸ©é˜µã€‚

**æ‹Ÿåˆæ¨¡å‹** ç°åœ¨è¯¥æ‹Ÿåˆæ¨¡å‹äº†ã€‚ä¸ºäº†å‘æ‚¨è§£é‡Šæ‹Ÿåˆæ¨¡å‹çš„å«ä¹‰ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹ç”¨äºç®€å•çº¿æ€§å›å½’çš„é€šç”¨æ–¹ç¨‹ã€‚

```
ğ‘¦ = ğ‘ğ‘¥ + ğ‘
```

![](img/b3ed5239834381742416a674ef58cc3e.png)

ä¿¡ç”¨: [Quora](https://www.quora.com/What-does-regression-mean-in-statistics-and-machine-learning)

æ‹Ÿåˆæ¨¡å‹æ„å‘³ç€æ‰¾åˆ°`a`å’Œ`b`çš„æœ€ä¼˜å€¼ï¼Œå› æ­¤æˆ‘ä»¬è·å¾—ä¸€æ¡æœ€é€‚åˆæ•°æ®ç‚¹çš„çº¿ã€‚æ‹Ÿåˆè‰¯å¥½çš„æ¨¡å‹ä¼šäº§ç”Ÿæ›´å‡†ç¡®çš„ç»“æœï¼Œå› æ­¤åªæœ‰åœ¨æ‹Ÿåˆæ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨é¢„æµ‹å€¼æ¥é¢„æµ‹ç›®æ ‡å€¼ã€‚

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨ statsmodels æ‹Ÿåˆä¸€ä¸ªæ¨¡å‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨æ‹Ÿåˆæ¨¡å‹ä¹‹å‰æ·»åŠ ä¸€ä¸ªå¸¸æ•°(sklearn é»˜è®¤æ·»åŠ å®ƒ),ç„¶åæˆ‘ä»¬ä½¿ç”¨ã€‚fit()æ–¹æ³•ã€‚

```
x = sm.add_constant(x1) # adding a constant
lm = sm.OLS(y,x).fit() # fitting the model
```

â€œlmâ€ä»£è¡¨çº¿æ€§æ¨¡å‹ï¼Œä»£è¡¨æˆ‘ä»¬çš„æ‹Ÿåˆæ¨¡å‹ã€‚è¿™ä¸ªå˜é‡å°†å¸®åŠ©æˆ‘ä»¬é¢„æµ‹æˆ‘ä»¬çš„ç›®æ ‡å€¼ã€‚

```
>>> lm.predict(x)0      25.232623
1      24.305975
2      31.030253
3      29.919727
4      31.231138
         ...    
501    24.603318
502    20.346831
503    27.822178
504    26.328552
505    19.661029
```

ä¸Šé¢çš„ä»£ç æ ¹æ®â€œæˆ¿é—´â€åˆ—ä¸­çš„æ•°æ®é¢„æµ‹æˆ¿å±‹ä»·å€¼(æ‰“å°è¾“å‡º)ã€‚

## å›å½’è¡¨

è™½ç„¶æˆ‘ä»¬å¯ä»¥é¢„æµ‹ç›®æ ‡å€¼ï¼Œä½†æ˜¯åˆ†æè¿˜æ²¡æœ‰å®Œæˆã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªçº¿æ€§æ¨¡å‹çš„è¡¨ç°ã€‚å›å½’è¡¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¯¥è¡¨æä¾›äº†ä¸€ä¸ªç»“æœçš„è¯¦ç»†åˆ—è¡¨ï¼Œæ­ç¤ºäº†æˆ‘ä»¬çš„æ¨¡å‹æœ‰å¤šå¥½/å¤šå·®ã€‚

è¦è·å¾—å›å½’è¡¨ï¼Œè¯·è¿è¡Œä»¥ä¸‹ä»£ç :

```
lm.summary()
```

æ‚¨å°†è·å¾—æ­¤è¡¨:

![](img/2aafc9745f23af252489050fe7ddf55e.png)

ä½œè€…å›¾ç‰‡

è¿™ä¸ªè¡¨æ ¼çš„æ ‡é¢˜æ˜¯â€œOLS å›å½’ç»“æœâ€OLS ä»£è¡¨æ™®é€šæœ€å°äºŒä¹˜æ³•ï¼Œè¿™æ˜¯ä¼°è®¡çº¿æ€§å›å½’æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ç¬¬ä¸€å’Œç¬¬äºŒä¸ªè¡¨ä¸­çš„ä¸€äº›é‡è¦ç»“æœã€‚

*   ç¦»å¼€å˜é‡:è¿™æ˜¯å› å˜é‡(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­,â€œå€¼â€æ˜¯æˆ‘ä»¬çš„ç›®æ ‡å€¼)
*   r å¹³æ–¹:å– 0 åˆ° 1 ä¹‹é—´çš„å€¼ã€‚æ¥è¿‘ 0 çš„ r å¹³æ–¹å€¼å¯¹åº”äºè§£é‡Šä¸äº†ä»»ä½•æ•°æ®å¯å˜æ€§çš„å›å½’ï¼Œè€Œæ¥è¿‘ 1 çš„å€¼å¯¹åº”äºè§£é‡Šæ•°æ®å…¨éƒ¨å¯å˜æ€§çš„å›å½’ã€‚**è·å¾—çš„ r å¹³æ–¹å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ¿é—´æ•°é‡è§£é‡Šäº†æˆ¿å±‹ä»·å€¼å˜åŒ–çš„ 48.4%ã€‚**
*   Coef:è¿™äº›æ˜¯æˆ‘ä»¬ä¹‹å‰åœ¨æ¨¡å‹æ–¹ç¨‹ä¸­çœ‹åˆ°çš„ç³»æ•°(aï¼Œb)ã€‚
*   æ ‡å‡†è¯¯å·®:è¡¨ç¤ºé¢„æµ‹çš„å‡†ç¡®æ€§ã€‚æ ‡å‡†è¯¯å·®è¶Šä½ï¼Œé¢„æµ‹è¶Šå¥½ã€‚
*   tï¼ŒP>t (p å€¼):t åˆ†æ•°å’Œ P å€¼ç”¨äºå‡è®¾æ£€éªŒã€‚â€œæˆ¿é—´â€å˜é‡å…·æœ‰ç»Ÿè®¡å­¦æ˜¾è‘—æ€§ p å€¼ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ 95%çš„ç½®ä¿¡åº¦ä¸‹è¯´â€œæˆ¿é—´â€çš„å€¼åœ¨ 8.279 åˆ° 9.925 ä¹‹é—´ã€‚

**çº¿æ€§å›å½’æ–¹ç¨‹** æ ¹æ®ä¸Šè¡¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ç³»æ•°(coef)åˆ›å»ºçº¿æ€§æ–¹ç¨‹ï¼Œç„¶åç”¨æ•°æ®ç‚¹ç»˜åˆ¶å›å½’çº¿ã€‚

```
# Rooms coef: 9.1021
# Constant coef: - 34.6706# Linear equation: ğ‘¦ = ğ‘ğ‘¥ + ğ‘
y_pred = 9.1021 * x['Rooms'] - 34.6706
```

å…¶ä¸­ y_pred(ä¹Ÿç§°ä¸º yhat)æ˜¯å›å½’æ–¹ç¨‹ä¸­ y(å› å˜é‡)çš„é¢„æµ‹å€¼ã€‚

**çº¿æ€§å›å½’å›¾** ä¸ºäº†ç»˜åˆ¶æ–¹ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ seabornã€‚

```
**import seaborn as sns
import matplotlib.pyplot as plt**# plotting the data points
sns.scatterplot(x=x['Rooms'], y=y)#plotting the line
sns.lineplot(x=x['Rooms'],y=y_pred, color='red')#axes
plt.xlim(0)
plt.ylim(0)
plt.show()
```

ä¸Šé¢çš„ä»£ç äº§ç”Ÿäº†ä¸‹é¢çš„å›¾ã€‚

![](img/0b685b2e2ad262418cbe21eb7d33cea3.png)

ä½œè€…å›¾ç‰‡

çº¢è‰²çš„å›¾æ˜¯æˆ‘ä»¬ç”¨ Python æ„å»ºçš„çº¿æ€§å›å½’ã€‚æˆ‘ä»¬å¯ä»¥è¯´è¿™æ˜¯æœ€ç¬¦åˆè“è‰²æ•°æ®ç‚¹çš„çº¿ã€‚

æ­å–œä½ ï¼æ‚¨åˆšåˆšåœ¨ Python ä¸­æ„å»ºäº†ç¬¬ä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’ã€‚å¦‚æœä½ å‡†å¤‡è¿æ¥æŒ‘æˆ˜ï¼Œçœ‹çœ‹å¦‚ä½•è¿›è¡Œå¤šå…ƒçº¿æ€§å›å½’ã€‚

## å¤šå…ƒçº¿æ€§å›å½’

ç°åœ¨ä½ å·²ç»çŸ¥é“äº†çº¿æ€§å›å½’çš„æ ¸å¿ƒæ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ›å»ºä¸€ä¸ªå¤šå…ƒçº¿æ€§å›å½’ã€‚

è®©æˆ‘ä»¬ä»è®¾ç½®å› å˜é‡å’Œè‡ªå˜é‡å¼€å§‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ 2 ä¸ªç‹¬ç«‹å˜é‡ã€‚

*   å› å˜é‡:â€œå€¼â€
*   è‡ªå˜é‡:â€œæˆ¿é—´â€å’Œâ€œè·ç¦»â€

è®©æˆ‘ä»¬ä¹Ÿåœ¨ä»£ç ä¸­å®šä¹‰å› å˜é‡å’Œè‡ªå˜é‡ã€‚

```
y = df_boston['Value'] # dependent variable
X = df_boston[['Rooms', 'Distance']] # independent variable
```

ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå¸¸æ•°å¹¶æ‹Ÿåˆæ¨¡å‹ã€‚

```
X = sm.add_constant(X) # adding a constant
lm = sm.OLS(y, X).fit() # fitting the model
```

è®©æˆ‘ä»¬çœ‹çœ‹ç»“æœã€‚

```
lm.summary()
```

![](img/8fb5d50799901db0337df66a24e97149.png)

ä½œè€…å›¾ç‰‡

r å¹³æ–¹å¢åŠ äº†ä¸€ç‚¹ã€‚æ­¤å¤–ï¼Œåœ¨ç¬¬äºŒä¸ªè¡¨ä¸­æœ‰ä¸€ä¸ªæ–°è¡Œä»£è¡¨â€œè·ç¦»â€å˜é‡çš„å‚æ•°ã€‚è¯¥è¡¨çš„åˆ†æç±»ä¼¼äºç®€å•çš„çº¿æ€§å›å½’ï¼Œä½†å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶åœ¨è¯„è®ºéƒ¨åˆ†å‘Šè¯‰æˆ‘ã€‚

## ä½¿ç”¨ sklearn è¿›è¡Œçº¿æ€§å›å½’

Scikit-learn æ˜¯ Python ä¸­çš„æ ‡å‡†æœºå™¨å­¦ä¹ åº“ï¼Œå®ƒè¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œç®€å•çš„çº¿æ€§å›å½’æˆ–å¤šå…ƒçº¿æ€§å›å½’ã€‚

ç”±äºä¹‹å‰æˆ‘ä»¬å·²ç»ç”¨ statsmodels æ·±å…¥åˆ†æäº†ç®€å•çº¿æ€§å›å½’ï¼Œç°åœ¨æˆ‘ä»¬ç”¨ sklearn åšä¸€ä¸ªå¤šå…ƒçº¿æ€§å›å½’ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å®‰è£… sklearnã€‚å¦‚æœæ‚¨å·²ç»é€šè¿‡ Anaconda å®‰è£…äº† Pythonï¼Œé‚£ä¹ˆæ‚¨å·²ç»å®‰è£…äº† sklearnã€‚å¦‚æœæ²¡æœ‰ï¼Œä½ å¯ä»¥ç”¨ conda æˆ–è€… pip å®‰è£…ã€‚

```
# pip
pip install scikit-learn# conda
conda install -c conda-forge scikit-learn
```

ç°åœ¨è®©æˆ‘ä»¬ä» sklearn åº“ä¸­å¯¼å…¥ linear_modelã€‚

```
**from sklearn import linear_model**
```

å› å˜é‡å’Œè‡ªå˜é‡å¦‚ä¸‹ã€‚

```
y = df_boston['Value'] # dependent variable
X = df_boston[['Rooms', 'Distance']] # independent variable
```

ç°åœ¨æˆ‘ä»¬å¿…é¡»æ‹Ÿåˆæ¨¡å‹(æ³¨æ„ï¼Œä½¿ç”¨ sklearn çš„ fit æ–¹æ³•ä¸­çš„å‚æ•°é¡ºåºä¸ statsmodels ä¸åŒ)

```
lm = linear_model.LinearRegression()
lm.fit(X, y) # fitting the model
```

ä¸ statsmodels ç±»ä¼¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ predict æ–¹æ³•æ¥é¢„æµ‹ sklearn ä¸­çš„ç›®æ ‡å€¼ã€‚

```
lm.predict(X)
```

ç„¶è€Œï¼Œä¸ statsmodels ä¸åŒï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨`.summary()`å¾—åˆ°ä¸€ä¸ªæ±‡æ€»è¡¨ã€‚ç›¸åï¼Œæˆ‘ä»¬å¿…é¡»é€ä¸ªè°ƒç”¨æ¯ä¸ªå…ƒç´ ã€‚

```
>>> lm.score(X, y)
0.495>>> lm.coef_
array([8.80141183, 0.48884854])>>> lm.intercept_
-34.636050175473315
```

ç»“æœä¸æˆ‘ä»¬ä½¿ç”¨ statsmodels è·å¾—çš„è¡¨æ ¼ç›¸åŒã€‚

æ³¨æ„ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬æ²¡æœ‰å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•ã€‚åœ¨æ„å»ºæ¨¡å‹ä¹‹å‰æ‹†åˆ†æ•°æ®æ˜¯ä¸€ç§é¿å…è¿‡åº¦æ‹Ÿåˆçš„æµè¡Œæ–¹æ³•ã€‚è¿™å°†æ˜¯æœªæ¥æ–‡ç« çš„ä¸»é¢˜ï¼Œè¯·ç»§ç»­å…³æ³¨ï¼

å°±æ˜¯è¿™æ ·ï¼æ‚¨åˆšåˆšå­¦ä¹ äº†å¦‚ä½•åœ¨ Python ä¸­è¿›è¡Œç®€å•çš„å¤šå…ƒçº¿æ€§å›å½’ã€‚ä½ å¯ä»¥åœ¨æˆ‘çš„ [Github](https://github.com/ifrankandrade/model-building.git) ä¸Šæ‰¾åˆ°æœ¬æŒ‡å—ä¸­å†™çš„æ‰€æœ‰ä»£ç ã€‚

[](/a-beginners-guide-to-text-classification-with-scikit-learn-632357e16f3a) [## Scikit-Learn ç®€å•æŒ‡å—â€”ç”¨ Python æ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹

### Python ä¸­çš„ç¬¬ä¸€ä¸ª ML æ¨¡å‹ã€‚

towardsdatascience.com](/a-beginners-guide-to-text-classification-with-scikit-learn-632357e16f3a) 

[**ä¸ 3k ä»¥ä¸Šçš„äººä¸€èµ·åŠ å…¥æˆ‘çš„ç”µå­é‚®ä»¶åˆ—è¡¨ï¼Œè·å–æˆ‘åœ¨æ‰€æœ‰æ•™ç¨‹ä¸­ä½¿ç”¨çš„ Python for Data Science å¤‡å¿˜å•(å…è´¹ PDF)**](https://frankandrade.ck.page/bd063ff2d3)

å¦‚æœä½ å–œæ¬¢é˜…è¯»è¿™æ ·çš„æ•…äº‹ï¼Œå¹¶æƒ³æ”¯æŒæˆ‘æˆä¸ºä¸€åä½œå®¶ï¼Œå¯ä»¥è€ƒè™‘æŠ¥åæˆä¸ºä¸€ååª’ä½“æˆå‘˜ã€‚æ¯æœˆ 5 ç¾å…ƒï¼Œè®©æ‚¨å¯ä»¥æ— é™åˆ¶åœ°è®¿é—®æ•°ä»¥åƒè®¡çš„ Python æŒ‡å—å’Œæ•°æ®ç§‘å­¦æ–‡ç« ã€‚å¦‚æœä½ ä½¿ç”¨[æˆ‘çš„é“¾æ¥](https://frank-andrade.medium.com/membership)æ³¨å†Œï¼Œæˆ‘ä¼šèµšä¸€å°ç¬”ä½£é‡‘ï¼Œä¸éœ€è¦ä½ é¢å¤–ä»˜è´¹ã€‚

[](https://frank-andrade.medium.com/membership) [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥åª’ä½“â€”â€”å¼—å…°å…‹Â·å®‰å¾·æ‹‰å¾·

### ä½œä¸ºä¸€ä¸ªåª’ä½“ä¼šå‘˜ï¼Œä½ çš„ä¼šå‘˜è´¹çš„ä¸€éƒ¨åˆ†ä¼šç»™ä½ é˜…è¯»çš„ä½œå®¶ï¼Œä½ å¯ä»¥å®Œå…¨æ¥è§¦åˆ°æ¯ä¸€ä¸ªæ•…äº‹â€¦

frank-andrade.medium.com](https://frank-andrade.medium.com/membership)