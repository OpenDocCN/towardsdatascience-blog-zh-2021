# 加拿大阿尔伯塔省的野火蔓延模拟:一个使用带有 ConvLSTM 细胞的神经网络的试验，一个纯数据驱动的模拟

> 原文：<https://towardsdatascience.com/wildfire-spreading-modeling-in-alberta-canada-a-trial-using-a-neural-network-with-convlstm-cells-81c1a9f7d410?source=collection_archive---------26----------------------->

## [变更数据](https://towardsdatascience.com/tagged/data-for-change)

## 使用深度学习从卫星数据理解和模拟森林野火传播的个人尝试。

![](img/d52b4c9b696f68a38d8623ebaa1512f6.png)

作者图片

日期:最初发布于 2020 年 4 月 23 日，2021 年 6 月 24 日更新于[5]和[迈向数据科学](/wildfire-spreading-modeling-in-alberta-canada-a-trial-using-a-neural-network-with-convlstm-cells-81c1a9f7d410)
作者:Bessam Mehenni
主题:使用具有 ConvLSTM 细胞的神经网络对森林野火蔓延进行建模。加拿大阿尔伯塔省。

*我从关于麦克默里堡火灾序列的 MODIS 数据中创建的时间圈*

![](img/8e2cc97d01fad07cf791df7c3c6d60ef.png)

作者提供的图片

# 1.介绍

这项研究是我在巴黎一所数据科学学校结束培训时选择的一个课题的一部分。目的是测试具有 ConvLSTM 层的 2D 空间模型预测森林火灾蔓延的能力。

这是一个探索性的研究，实现了从零开始的深度学习。读者需要注意的是，这项研究并不是基于对林火蔓延模拟技术的全面了解。作者也不了解森林火灾的规律。

我们设计的模型使用由卫星[1]收集并由我处理的热异常坐标序列来获得像素图像的外观。此外，有助于火蔓延的特征与每个像素相关联，并且被模型考虑在内。气象特征来自阿尔伯塔省的一个政府网站。

我们正在研究的火灾序列特别发生在加拿大的阿尔伯塔地区。它们是大火。四个火灾序列，包括 2016 年 5 月著名的麦克默里堡火灾和 2011 年 6 月的理查森火灾，将用于训练和测试模型。麦克默里堡大火已导致 8 万人流离失所，并需要动员 3000 名消防员。我们将两个火灾序列命名为“Richardson phase 2”和“Central Alberta ”,这些名称纯属虚构。

![](img/9e3bfad975f8fa8b8843321f929b0cb2.png)

图 1a:空间和时间研究窗口|作者列表

数据来自三个不同的来源:

*   MODIS 卫星数据是从指定了空间和时间窗口的数据源[1]专门下载的。
*   气象数据是专门从数据源[2]下载的。
*   地形数据是从数据源手动读取的[3]。

# 2.方法

气象网站建立的网格主轴被用作开发更精细的表格数据网格的基础。我们开始进行一些人工读数，找出天气网格的坐标。

![](img/1d4e6d2a0b96977cd2a98e6f96e63aed.png)

图 1b:气象网站的网格图[2]

然后，我们必须建立一个更精细的二级网格(我们选择 2km x 2km ),其中每个基本网格包含以下信息:根据 MODIS 记录、转置或插值的气象数据、现场的高程数据，是否有火灾。这个项目的主要困难在于数据的预处理。这是一个工匠的工作，很难概括:

*   数据收集不是自动化的，甚至包括人工读数。
*   预处理是为四个选定的火灾研究区域量身定制的。我们花了很多时间开发预处理程序。在执行过程中，预处理程序在夜间运行数小时，以便幸运地到达我们在 GitHub 上提供的最终数据集[5]。

准备工作完成后，我们开始可视化数据。当我们观察到每天几十公里的明显蔓延模式时，我们对森林火灾的偏见，即森林火灾以均匀的速度从近到远蔓延的想法，被颠覆了。气象站那几天的风力强度可以被描述为“正常”，这就对与风有关的主要原因的想法提出了质疑。这里事实上是火爆发的强度创造了大量的上升气流；这些气流携带白炽粒子，它们参与了火势的快速蔓延。

我们通过描述性模型 DBSCAN 研究了火团的演化。这项技术对理解传播非常有用。它包括从接近到接近地分配聚类点。

下一步是试图模拟火灾蔓延，以便预测它。我们尝试了使用 ConvLSTM 层的深度学习模型。A. Xavier 在[6]中说::*它是一个递归层，就像 LSTM 一样，但是内部的矩阵乘数是用卷积运算交换的*。使用 ConvLSTM 模拟火灾蔓延的尝试没有产生令人满意的结果。

流体力学研究人员已将无量纲变量引入经验关联式，其目的是模拟物理现象。尽管这一尝试失败了，但我们在这个项目中的进展让我们相信，一个纯粹的数据驱动模型在翻译如此复杂的传播现象时会有困难。我们认为，数据驱动模型依赖于一些无量纲的物理变量(比如弗劳德数)是有意义的。

# 3.数据预处理

该模型实际上允许两个图像和一个与连续两天的数据相对应的火灾影响特征的相关矩阵。输出是火灾位置的图像，是最后一个输入图像后 3 天的预测。

模型的每个输入样本是 5D 阵列(样本 _nb，nb _ 步骤，行，列，nb _ 特征)，其中 nb _ 步骤是 2 天时间步长，行和列是行(这里是 45)和列(这里是 65)的数量，nb _ 特征是火灾影响特征的数量，这里是 9。这幅图像有 2925 个像素，每个像素代表一个 2 公里×2 公里的区域。

我们选择的影响特征有几种:

*   气象:降水量(mm)、湿度(%)、地面接收的太阳辐射(MJ/m2)、累计平均风速(km/h)、风向()。
*   地形:每个单元的高程。
*   植被:累积降水量(mm)在一定程度上反映了植被的含水量。
*   火特性:亮度。

在本研究的框架中，影响蔓延的人为因素被排除在外，特别是旨在控制火灾的灭火和预防措施(灭火、修剪植被区、浇水等)。).

风向是从考虑中的像素周围的两个或三个气象站的读数产生的量。它是通过反距离加权(IDW)插值法获得的。

不考虑空气温度因素，因为它是空气湿度的固有因素(见莫里尔图)。

起伏的斜率是传播的一个重要因素，没有明确地给模型。仅给出了小区的高度。他们来自源头[3]。

![](img/c1dec0bbe979a4cbc894e0c8fbde84ef.png)

图 2:麦克默里堡遗址的地形图

不管正确与否，我们决定使用亮度，这是一个与卫星传感器测量光线位置相同的量。我们认为，红外辐射可能是火的温度的镜像，因此也是火的强度的镜像，研究表明它会影响白炽粒子的传播[4]。

从阿尔伯塔省的火灾中收集的数据表明了几种火灾蔓延的模式。其中一个现象的特点是巨大的表观射速，并被证明是非常毁灭性的。它负责每天几公里的火灾传播距离。这种现象会留下一大堆小火。

在加拿大、美国、澳大利亚，有时在一些南欧国家如葡萄牙也能观察到这种现象。解释是炽热的植物粒子(飞溅的火花)向前投射。它们参与了火焰锋的快速推进。这种火灾行为明显不同于其他更常规的行为，后者的表观火灾速度为每天几千米。

![](img/0650e945f272e3fc79b2c2697a5a4c48.png)

图 3a:加拿大亚伯达省麦克默里堡 DBS can(2016 年 5 月 4 日)获得的火灾群|图片由作者提供

![](img/b131eafaa5265792380bba082c1f76ff.png)

图 3b:加拿大艾伯塔省麦克默里堡 DBS can(d+1 日:05–05–2016)获得的火灾群|图片由作者提供

![](img/57373c0a47acdc0a865361e7b3898c35.png)

图 3c:加拿大艾伯塔省麦克默里堡 DBS can(d+2 日:2016 年 5 月 6 日)获得的火灾群|图片由作者提供

我们通过应用描述性模型(DBSCAN)揭示了加拿大麦克默里堡火灾中的这一现象。2016 年 5 月这种现象发生的几天就导致了特大的火势蔓延。造成这种现象的物理因素很难确定。它们与大气中对流不稳定性的存在有关。火线的热功率也将密切决定白炽粒子覆盖的距离。

数据集按时间顺序分为两部分:38 天的训练样本(大约。56%或 111150 次观察)和 30 天验证样本(大约 44%或 87750 个观察值)。我们还预留了 9 天的测试样本。

# 4.神经网络的结构和相关参数

所提出的架构包括第一层 64 核 ConvLSTM，其核大小为(3×3)，接着是最大池层(2×2 ),其执行子采样操作以降低特征图的维度，接着是维度展平和三个全连接层，每个层具有 128、128 和 2925 个神经元层。这些层链接到 ReLu 激活功能。使用 sigmoid 激活函数在最后一层的输出端进行单向分类，该函数计算火灾形态的概率(“1”)。

![](img/355fd5416ff57bfa855f66a24e52403f.png)

图 4:con vltm 单元的示意图[6]

为了减轻模型过拟合，引入了正则化技术，例如应用于某些层的 L2 正则化。一些层之后是 0.4 的退出率。选择了 Adam 梯度优化算法。该模型使用 Keras 库和 Tensorflow 作为 GPU 加速环境(Google Colab)中的后端。

# 5.分类结果

下图是测试样本的混淆矩阵和 ROC 曲线。可以看出，该模型正确预测了火灾中的 22 个像素。精度是 2.3%:该模型犯了很多错误，因为它预测了大量着火的像素，而实际上并没有着火。

![](img/d6b51d5da338271bb7402cde2ed69ff9.png)

图 5:测试样本的混淆矩阵(阈值=0.65) |作者图片

![](img/d4aa54a470add594ced466cedd6a7d8d.png)

图 6:训练和测试样本 ROC 曲线

总体准确率得分为 90.0%。我们必须特别注意召回参数，因为不预测实际正在燃烧的燃烧像素是一个问题。在这里，我们希望看到尽可能高的召回率只有 14%。下图比较了测试样本在 9 天内的预测图像和实际图像。火灾概率阈值设置为 0.65。

![](img/a6e91b49c923e369a9079eb74d3ea7ed.png)

图 7:测试样本的预测和实际图像|作者提供的图像

我们可以看到，预测是火灾的分散像素，而实际上火灾区域是聚集在一起的。

积极的一点是，在第 3 天，火灾活动加剧，模型预测遵循这一趋势。在第 6 天的观察是相同的，只是预测转移到了第 7 天。这种延迟可能与提前 3 天预测的不确定性有关。

相反，第 9 天显示火灾活动减少，这也是模型预测的结果。

训练图像中的卷积识别模式。火焰图案每天都在重复，伴随着图像中特定区域的突出显示。这些地区每天都在变化。当然，该模型还没有针对不同的案例进行充分的训练。我们的研究受制于有限的训练数据。在这个意义上，我们可以区分卷积的限制:训练图像在图像的左下角没有火区。这一特征可以在模型预测中找到，这有利于图像的这一部分没有火。

# 6.结论

我们的模型不能提供未来三天火灾蔓延模式的准确视图。这种限制的原因可能是卷积原理本身和/或用于其训练的有限数据量和/或基于我们给它的特征该模型不能理解的现象的复杂性。火灾数据来自持续时间和范围方面的重大火灾事件。似乎很难想象我们能从阿尔伯塔省大量收集更多的火灾数据。

尽管如此，我们的模型显示了根据天气和非天气条件跟踪火灾活动增加或减少的能力。应该指出的是，我们天真地让我们的模型负责建立对传播现象的理解。但是现象并不简单。它们是复杂多样的。例如，在 Fort McMurray 记录中，我们观察到，在两个不同的天中，在相似的条件下(气象站的风速、湿度等)。)，发生了拮抗现象。在一个案例中，一天传播 5 公里。在另一种情况下，超过 50 公里的粒子跳跃传播。

我们可以说，我们选择的直接因素不足以解释这些现象。还涉及到与火和大气中空气的物理学有关的其他参数。

# 7.然后

研究调查了火灾和风况如何影响落到地面上的白炽植被颗粒的分布行为[4]。引入弗劳德无量纲变量，为火灾跳跃平均距离的计算提供规律。弗劳德数是流体力学模型中用来描述流态的参数。它代表了与流速相关的惯性力相对于浮力的相对重要性。在飞溅火花突然出现的情况下，存在的状态可能对应于由侧风控制的气流，也可能对应于由火焰强度控制的上升气流。计算跳火平均距离的公式已作为流态的函数提出[4]。

如果我们让一个模型更容易理解复杂的现象，它就能渴望表现。我认为预测火灾蔓延的最佳模型可能会处于深度学习(甚至强化学习)和物理建模之间的十字路口。除了已知的影响火势蔓延的直接因素(湿度、风速等)之外，还必须依靠。)，物理建模中常用的解释现象的参数。弗劳德数就是其中之一。

# 8.参考

[1][https://firms.modaps.eosdis.nasa.gov/](https://firms.modaps.eosdis.nasa.gov/)，2020 年 3 月 27 日

[2]http://www.agriculture.alberta.ca/acis/,2020 年 3 月 27 日

[3]https://earth.google.com/web/,2020 年 3 月 27 日

[4]尼古拉·萨尔多伊。[燃料颗粒的运输和燃烧](https://tel.archives-ouvertes.fr/tel-00289521v2) (2007 年)。物理学。普罗旺斯大学艾克斯马赛第一分校，2007 年。法国人。电话 00289521v2

[5][https://github . com/bessammehenni/Forest _ wild fire _ spreading _ convLSTM](https://github.com/bessammehenni/Forest_wildfire_spreading_convLSTM)

[6]来自 Neuronio 的 Alexandre Xavier，ConvLSTM 简介(2019 年 3 月 25 日)，[https://medium . com/neuro nio/An-introduction-to-convl STM-55c 9025563 a7](https://medium.com/neuronio/an-introduction-to-convlstm-55c9025563a7)

*感谢阅读！下一个故事下次见。*