# 用七个步骤设计一个联合学习系统

> 原文：<https://towardsdatascience.com/design-a-federated-learning-system-in-seven-steps-d0be641949c6?source=collection_archive---------13----------------------->

## 构建企业联合学习系统时，您应该考虑什么？

![](img/5a3819e0464d6da40af8cbe68977df93.png)

由[亨特·哈里特](https://unsplash.com/@hharritt?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

# 介绍

像谷歌和苹果这样的公司已经开创了联合学习，作为一种在分布式数据集上建立更高性能的机器学习模型而不损害隐私的方式。今天，谷歌使用联邦学习来支持 Gboard 中的键盘预测，苹果使用它来提高 Face ID 和 Siri 的准确性。

但是如何开始呢？

虽然有很多很棒的资源[描述了什么是联合学习，但是没有很多信息涵盖如何在你的业务中应用它。](https://changelog.com/practicalai/153)

本文旨在作为一个指南，帮助您建立一个可伸缩的联邦学习系统。因为不同用户和用例的需求可能不同，所以本指南不会为您提供所有答案。但是，它应该为您提供关键问题和注意事项，以帮助您设计适合您的系统。

在 [integrate.ai](https://integrate.ai/) (我是这里的工程主管)，我们专注于让联合学习更容易实现。以下是我们发现的七个步骤:

*   **第一步**:挑选你的模型框架
*   **第二步:**确定网络机制
*   **第三步:**构建集中式服务
*   **第四步:**设计客户端系统
*   **步骤 5:** 设置培训流程
*   **第六步:**建立模型管理系统
*   **第 7 步:**解决隐私和安全问题

# 联合学习 101

在我们开始之前，让我们确保您对联邦学习有一个基本的了解。

与需要将数据集中起来进行训练的传统机器学习技术不同，联合学习是一种在分布式数据集上训练模型的方法。机器学习模型的部分在数据所在的地方被训练(例如，这些可以是来自两个或更多公司的私有数据集)，并且模型参数在参与者之间被共享以产生改进的模型。没有数据在系统内移动，这意味着组织可以在不损害隐私或敏感知识产权的情况下进行协作，同时避免通过传统方式传输数据的痛苦和费用。

下面是一些可以使用联合学习的例子:

*   通过使用来自多个企业的数据改进机器人过程自动化解决方案中的自然语言处理模型
*   使用来自信用卡公司和银行的数据提高欺诈检测模型的准确性
*   利用广告商和出版商的数据改进归因模型
*   使用来自不同消费企业的数据增强个性化和推荐系统
*   使用来自多家医院的数据改进医疗诊断的计算机视觉模型
*   避免了出于机器学习目的将数据库迁移到一个集中位置的需要

是时候开始学习如何建立一个联合学习系统了。

为了简单起见，让我们假设我们正在进行水平联合学习。在这种情况下，机器学习任务的目标变量和输入在数据集之间是相同的，但是需要更多的样本来建立更好的模型。

# 步骤 1:选择你的模型框架

![](img/917e9a2c5696d5ab7a2c78626255d91c.png)

克里斯托夫·高尔在 [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

第一步是选择您的底层模型实现。您需要为您的应用程序选择一个对联邦学习有一定支持的模型框架。选择标准包括领域(如图像、NLP 或表格数据)、团队对技术的熟悉程度以及框架与现有基础设施的兼容性等项目。

[PyTorch](https://pytorch.org/) 或 [TensorFlow](https://www.tensorflow.org/) 是热门选择；这些库为联合学习提供了一些工具，但要获得完整的解决方案，还需要添加额外的生产就绪组件。主要组件如下所述。

# 步骤 2:确定网络机制

接下来，您需要确定使用什么样的网络机制。这种机制是在联合学习网络中的每个参与者之间传递指令的消息格式和框架。

有几个选项可供选择，包括:

*   PyTorch——open mined 的一个 py torch 框架，支持联合学习
*   [Flower](https://flower.dev/) —抽象消息流以支持多种建模框架的通用框架。
*   [tensor flow Federated](https://www.tensorflow.org/federated/tutorials/custom_federated_algorithms_1)—tensor flow 分配模型操作的方法

决定哪个选项适合您通常归结为您需要跨建模框架的网络机制有多灵活。例如，如果您的团队希望主要在 PyTorch 中工作，并且需要较低级别的建模操作，那么 PySyft 可能是一个不错的选择。

如果您希望优先考虑灵活性，那么 Flower 是一个不错的选择，因为它支持在不同的建模框架上进行联合学习。

网络和核心模型框架的选择也依赖于组织内部或多个组织之间的应用程序。在后一种情况下，选择需要为所有参与组织所接受。

现在，我们已经有了一些基础，可以开始构建一个联合学习系统了。

# 步骤 3:构建集中式服务

![](img/c6887489c28b64b6bcdb37afdd40b733.png)

由[罗德里戈·库格纳斯基](https://unsplash.com/@kugnharski?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/center?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

一旦选择了模型框架和网络机制，就需要建立一个集中的服务来管理参与者。这项服务将负责协调参与者之间的沟通，并监督培训进度。

从运营角度来看，该服务可能需要:

1.  内置认证和授权机制，以及保持其可靠性的支持结构；这包括确保服务是无状态的，以帮助负载平衡，这意味着需要选择一种存储机制来保存客户端之间传递的中间信息。
2.  以满足联合学习系统的需求。
3.  能够管理培训课程。

从功能角度来看，还需要考虑其他关键的设计因素。例如:

*   是否需要添加授权或服务隔离来分隔不同的数据网络？也就是说，一些参与者可以一起协作，但不能在组之间协作。
*   客户可以触发培训课程吗？还是必须集中管理？
*   客户端断开连接和重新连接将如何影响培训？参加培训的缔约方的数量增加了这一问题。
*   在培训期间应该收集哪些统计数据，如何设置监控，以便系统可以测量被培训模型的质量？
*   该服务将如何管理以不同速度运行的参与客户端？
*   如果客户变得不可靠，系统如何知道何时放弃客户，以便模型仍然可以继续被训练？

花时间设计一个考虑到这些因素的系统对于确保您将要实现的系统是可靠的、灵活的和有价值的是至关重要的。

# 步骤 4:设计客户端系统

![](img/e311cb91e9443b3ad05fafb1bd884f58.png)

照片由 [Unsplash](https://unsplash.com/s/photos/connection?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上的 [israel palacio](https://unsplash.com/@othentikisra?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 拍摄

现在是时候考虑客户机系统的可能设计了。该系统需要能够执行客户端训练操作，并与中央服务协调模型参数。客户端系统还需要从网络中的其他客户端获取新参数，以更新本地模型。

为了设计和交付一个可靠的客户端应用程序，您应该尝试回答以下问题:

*   客户机系统应该是一个可安装的包，还是应该像 docker 映像一样？如何管理依赖关系版本？
*   客户端将如何进行身份验证并与服务器通信？
*   如何监控培训过程？
*   在模型训练过程中如何处理错误恢复？

# 步骤 5:设置培训流程

联合学习系统需要知道应该使用来自每个客户端的什么私有数据来训练特定会话的本地模型。

该信息需要来自另一个用户或中央服务。因此，必须以某种形式管理关于可用数据的元信息；这通常由中央服务来完成。

这也要求客户端注册关于哪些数据集可用于其他客户端的元信息。类似地，需要从中央服务中检索每个客户端的元数据，关于哪些数据集应该用于训练会话。

# 第六步:建立模型管理系统

训练会话的输出是机器学习模型。联邦学习系统需要管理模型度量和访问，以便适当的用户可以使用经过训练的模型。

以下问题可用于指导系统如何管理模型:

*   是所有的参与者都可以访问模型的副本，还是只有部分参与者可以访问它？
*   模型将存储在哪里(通常由集中服务存储)？

# 步骤 7:解决隐私和安全问题

![](img/0858fdf93075330c14d8b761209c0d49.png)

照片由[飞:D](https://unsplash.com/@flyd2069?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 在 [Unsplash](https://unsplash.com/s/photos/cyber-security?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

最终模型对一个或多个参与者是本地可用的。因为该模型是通过在不同方之间共享权重来训练的，所以反转该模型以检索关于底层训练数据的洞察是可能的。

因此，确定模型本身的可接受风险非常重要。这些风险可能包括能够重新识别特定训练集中的个人或重新生成训练集本身，这可能包含参与者不想暴露的敏感 IP。

减轻这些风险有不同的方法；一个例子是在传输到中央服务之前对模型权重应用差分隐私。通过调整隐私预算，可以平衡最终模型的效用和您认为可接受的风险量。

优化模型风险与模型性能取决于用例，因此在做出决策时让合适的利益相关者参与进来非常重要。

# 结论

联合学习有巨大的潜力成为数据科学家的关键工具，使他们能够在分布式数据集上训练更好的模型，而不会损害隐私或敏感的知识产权。然而，理解在企业中从哪里以及如何开始实现联合学习似乎是一项艰巨的任务。

我希望上面的步骤有助于指导您使用联邦学习。如果你对本指南有任何问题或反馈，我很乐意在评论中讨论。