# ç”¨ PyCaret æ„å»ºï¼Œç”¨ FastAPI éƒ¨ç½²

> åŸæ–‡ï¼š<https://towardsdatascience.com/build-with-pycaret-deploy-with-fastapi-333c710dc786?source=collection_archive---------6----------------------->

## è¿™æ˜¯ä¸€ä¸ªå¾ªåºæ¸è¿›ã€åˆå­¦è€…å‹å¥½çš„æ•™ç¨‹ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨ PyCaret æ„å»ºç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ ç®¡é“ï¼Œå¹¶å°†å…¶ä½œä¸º API è¿›è¡Œéƒ¨ç½²ã€‚

![](img/a4e4a7468bfabd294f7baac55222cd77.png)

py caretâ€”â€”Python ä¸­çš„å¼€æºã€ä½ä»£ç æœºå™¨å­¦ä¹ åº“

# ğŸ‘‰ä»‹ç»

è¿™æ˜¯ä¸€ä¸ªå¾ªåºæ¸è¿›ã€åˆå­¦è€…å‹å¥½çš„æ•™ç¨‹ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨ [PyCaret](https://www.pycaret.org) æ„å»ºç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ ç®¡é“ï¼Œå¹¶ä½¿ç”¨ [FastAPI](https://fastapi.tiangolo.com/) å°†å…¶ä½œä¸º web API éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ã€‚

## æœ¬æ•™ç¨‹çš„å­¦ä¹ ç›®æ ‡

*   ä½¿ç”¨ PyCaret æ„å»ºç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ ç®¡é“
*   ä»€ä¹ˆæ˜¯éƒ¨ç½²ï¼Ÿæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦éƒ¨ç½²æœºå™¨å­¦ä¹ æ¨¡å‹
*   ä½¿ç”¨ FastAPI å¼€å‘ä¸€ä¸ª API æ¥ç”Ÿæˆå¯¹æœªçŸ¥æ•°æ®çš„é¢„æµ‹
*   ä½¿ç”¨ Python å‘ API å‘é€ä»¥ç¼–ç¨‹æ–¹å¼ç”Ÿæˆé¢„æµ‹çš„è¯·æ±‚ã€‚

æœ¬æ•™ç¨‹å°†åœ¨è¾ƒé«˜å±‚æ¬¡ä¸Šæ¶µç›–æ•´ä¸ªæœºå™¨å­¦ä¹ ç”Ÿå‘½å‘¨æœŸï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†:

![](img/5104566c15027e483c034377ee8a134e.png)

PyCaret â€”æœºå™¨å­¦ä¹ é«˜çº§å·¥ä½œæµ

# ğŸ’»åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å“ªäº›å·¥å…·ï¼Ÿ

## ğŸ‘‰PyCaret

PyCaret æ˜¯ä¸€ä¸ªå¼€æºçš„ä½ä»£ç æœºå™¨å­¦ä¹ åº“å’Œç«¯åˆ°ç«¯çš„æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå†…ç½®äº Python ä¸­ï¼Œç”¨äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚å®ƒå› å…¶æ˜“ç”¨æ€§ã€ç®€å•æ€§ä»¥åŠå¿«é€Ÿæœ‰æ•ˆåœ°æ„å»ºå’Œéƒ¨ç½²ç«¯åˆ°ç«¯ ML åŸå‹çš„èƒ½åŠ›è€Œå¹¿å—æ¬¢è¿ã€‚

PyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨å‡ è¡Œä»£ç ä»£æ›¿æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå‘¨æœŸæˆå€åœ°å¿«é€Ÿå’Œæœ‰æ•ˆã€‚

py caret**ç®€å•** **å¥½ç”¨**ã€‚PyCaret ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½é¡ºåºå­˜å‚¨åœ¨ä¸€ä¸ª**ç®¡é“**ä¸­ï¼Œè¯¥ç®¡é“å¯¹äº**éƒ¨ç½²æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–çš„ã€‚**æ— è®ºæ˜¯è¾“å…¥ç¼ºå¤±å€¼ã€ä¸€é”®ç¼–ç ã€è½¬æ¢åˆ†ç±»æ•°æ®ã€ç‰¹å¾å·¥ç¨‹ï¼Œç”šè‡³æ˜¯è¶…å‚æ•°è°ƒæ•´ï¼ŒPyCaret éƒ½èƒ½å®ç°è‡ªåŠ¨åŒ–ã€‚

è¦äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä»–ä»¬çš„ GitHubã€‚

## ğŸ‘‰FastAPI

FastAPI æ˜¯ä¸€ä¸ªç°ä»£ã€å¿«é€Ÿ(é«˜æ€§èƒ½)çš„ web æ¡†æ¶ï¼Œç”¨äºåŸºäºæ ‡å‡† Python ç±»å‹æç¤ºç”¨ Python 3.6+æ„å»º APIã€‚ä¸»è¦ç‰¹ç‚¹æ˜¯:

*   **å¿«**:éå¸¸é«˜çš„æ€§èƒ½ï¼Œä¸ **NodeJS** å’Œ **Go** ä¸ç›¸ä¸Šä¸‹(æ„Ÿè°¢ Starlette å’Œ Pydantic)ã€‚[æœ€å¿«çš„ Python æ¡†æ¶ä¹‹ä¸€](https://fastapi.tiangolo.com/#performance)ã€‚
*   **å¿«é€Ÿç¼–ç **:å°†å¼€å‘ç‰¹æ€§çš„é€Ÿåº¦æé«˜ 200%åˆ° 300%å·¦å³ã€‚
*   **æ˜“**:è®¾è®¡ä¸ºæ˜“äºä½¿ç”¨å’Œå­¦ä¹ ã€‚å‡å°‘é˜…è¯»æ–‡ä»¶çš„æ—¶é—´ã€‚

è¦äº†è§£ FastAPI çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä»–ä»¬çš„ [GitHub](https://github.com/tiangolo/fastapi) ã€‚

![](img/301eee71b2ff10b7c506b1bf943f451f.png)

PyCaret å’Œ FastAPI çš„å·¥ä½œæµ

## ğŸ‘‰æ­£åœ¨å®‰è£… PyCaret

å®‰è£… PyCaret éå¸¸å®¹æ˜“ï¼Œåªéœ€è¦å‡ åˆ†é’Ÿã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒæ¥é¿å…ä¸å…¶ä»–åº“çš„æ½œåœ¨å†²çªã€‚

PyCaret çš„é»˜è®¤å®‰è£…æ˜¯ pycaret çš„ç²¾ç®€ç‰ˆæœ¬ï¼Œåªå®‰è£…è¿™é‡Œåˆ—å‡ºçš„ç¡¬ä¾èµ–é¡¹ã€‚

```
**# install slim version (default)** pip install pycaret**# install the full version**
pip install pycaret[full]
```

å½“æ‚¨å®‰è£… pycaret çš„å®Œæ•´ç‰ˆæœ¬æ—¶ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ‰€æœ‰å¯é€‰ä¾èµ–é¡¹[ä¹Ÿä¼šè¢«å®‰è£…ã€‚](https://github.com/pycaret/pycaret/blob/master/requirements-optional.txt)

## ğŸ‘‰å®‰è£… FastAPI

æ‚¨å¯ä»¥ä» pip å®‰è£… FastAPIã€‚

```
pip install fastapi
```

# ğŸ‘‰å•†ä¸šé—®é¢˜

å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„æ¡ˆä¾‹ç ”ç©¶ï¼Œç”±è¾¾é¡¿å•†å­¦é™¢å‘è¡¨åœ¨[å“ˆä½›å•†å­¦é™¢](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ã€‚è¿™ä¸ªæ¡ˆå­æ˜¯å…³äºä¸¤ä¸ªæœªæ¥å°†è¦ç»“å©šçš„äººçš„æ•…äº‹ã€‚åå«*æ ¼é›·æ ¼*çš„å®¶ä¼™æƒ³ä¹°ä¸€æšæˆ’æŒ‡å‘ä¸€ä¸ªåå«*èæ‹‰*çš„å¥³å­©æ±‚å©šã€‚é—®é¢˜æ˜¯æ‰¾åˆ°èæ‹‰ä¼šå–œæ¬¢çš„æˆ’æŒ‡ï¼Œä½†åœ¨ä»–çš„å¯†å‹å»ºè®®åï¼Œæ ¼é›·æ ¼å†³å®šä¹°ä¸€é¢—é’»çŸ³ï¼Œè¿™æ ·èæ‹‰å°±å¯ä»¥å†³å®šå¥¹çš„é€‰æ‹©ã€‚ç„¶åï¼Œæ ¼é›·æ ¼æ”¶é›†äº† 6000 é¢—é’»çŸ³çš„ä»·æ ¼å’Œåˆ‡å‰²ã€é¢œè‰²ã€å½¢çŠ¶ç­‰å±æ€§æ•°æ®ã€‚

# ğŸ‘‰æ•°æ®

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€ä¸ªæ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†æ¥è‡ªè¾¾é¡¿å•†å­¦é™¢çš„ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„æ¡ˆä¾‹ç ”ç©¶ï¼Œå‘è¡¨åœ¨[å“ˆä½›å•†ä¸š](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ä¸Šã€‚æœ¬æ•™ç¨‹çš„ç›®æ ‡æ˜¯æ ¹æ®é’»çŸ³çš„é‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ç­‰å±æ€§æ¥é¢„æµ‹é’»çŸ³çš„ä»·æ ¼ã€‚æ‚¨å¯ä»¥ä» [PyCaret çš„å­˜å‚¨åº“](https://github.com/pycaret/pycaret/tree/master/datasets)ä¸‹è½½æ•°æ®é›†ã€‚

```
**# load the dataset from pycaret** from pycaret.datasets import get_data
data = get_data('diamond')
```

![](img/59224af5669b8aa635d96027ef45a0b8.png)

æ•°æ®ä¸­çš„æ ·æœ¬è¡Œ

# ğŸ‘‰æ¢ç´¢æ€§æ•°æ®åˆ†æ

è®©æˆ‘ä»¬åšä¸€äº›å¿«é€Ÿå¯è§†åŒ–æ¥è¯„ä¼°ç‹¬ç«‹ç‰¹å¾(é‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ã€å‡€åº¦ç­‰)ä¹‹é—´çš„å…³ç³»ã€‚)ä¸ç›®æ ‡å˜é‡å³`Price`

```
**# plot scatter carat_weight and Price**
import plotly.express as px
fig = px.scatter(x=data['Carat Weight'], y=data['Price'], 
                 facet_col = data['Cut'], opacity = 0.25, template = 'plotly_dark', trendline='ols',
                 trendline_color_override = 'red', title = 'SARAH GETS A DIAMOND - A CASE STUDY')
fig.show()
```

![](img/ed9f1000130827f13bb6dc9fdcfb5198.png)

èæ‹‰å¾—åˆ°äº†ä¸€ä»½é’»çŸ³æ¡ˆä¾‹ç ”ç©¶

è®©æˆ‘ä»¬æ£€æŸ¥ç›®æ ‡å˜é‡çš„åˆ†å¸ƒã€‚

```
**# plot histogram**
fig = px.histogram(data, x=["Price"], template = 'plotly_dark', title = 'Histogram of Price')
fig.show()
```

![](img/e535e3df0a0e2e62d37a9d328753ae2a.png)

è¯·æ³¨æ„ï¼Œ`Price`çš„åˆ†å¸ƒæ˜¯å³åçš„ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€ŸæŸ¥çœ‹å¯¹æ•°å˜æ¢æ˜¯å¦å¯ä»¥ä½¿`Price`æ¥è¿‘æ­£æ€ï¼Œä»è€Œç»™å‡è®¾æ­£æ€çš„ç®—æ³•ä¸€ä¸ªæœºä¼šã€‚

```
import numpy as np**# create a copy of data**
data_copy = data.copy()**# create a new feature Log_Price**
data_copy['Log_Price'] = np.log(data['Price'])**# plot histogram**
fig = px.histogram(data_copy, x=["Log_Price"], title = 'Histgram of Log Price', template = 'plotly_dark')
fig.show()
```

![](img/bef0fa3285c94c3fae33cd149c3450e8.png)

è¿™è¯å®äº†æˆ‘ä»¬çš„å‡è®¾ã€‚è¿™ç§è½¬æ¢å°†å¸®åŠ©æˆ‘ä»¬æ‘†è„±åæ€ï¼Œä½¿ç›®æ ‡å˜é‡æ¥è¿‘æ­£æ€ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬å°†åœ¨è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ä¹‹å‰è½¬æ¢`Price`å˜é‡ã€‚

# ğŸ‘‰æ•°æ®å‡†å¤‡

å¯¹äº PyCaret ä¸­çš„æ‰€æœ‰æ¨¡å—æ¥è¯´ï¼Œ`setup`æ˜¯åœ¨ PyCaret ä¸­æ‰§è¡Œçš„ä»»ä½•æœºå™¨å­¦ä¹ å®éªŒä¸­çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ªå¼ºåˆ¶æ­¥éª¤ã€‚è¯¥åŠŸèƒ½è´Ÿè´£è®­ç»ƒæ¨¡å‹ä¹‹å‰æ‰€éœ€çš„æ‰€æœ‰æ•°æ®å‡†å¤‡ã€‚é™¤äº†æ‰§è¡Œä¸€äº›åŸºæœ¬çš„é»˜è®¤å¤„ç†ä»»åŠ¡ï¼ŒPyCaret è¿˜æä¾›äº†ä¸€ç³»åˆ—é¢„å¤„ç†åŠŸèƒ½ã€‚è¦äº†è§£ PyCaret ä¸­æ‰€æœ‰é¢„å¤„ç†åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¿™ä¸ª[é“¾æ¥](https://pycaret.org/preprocessing/)ã€‚

```
**# init setup**
from pycaret.regression import *
s = setup(data, target = 'Price', transform_target = True)
```

![](img/f1245b82abf22574b1a4886c7578fbc4.png)

pycaret.regression æ¨¡å—ä¸­çš„è®¾ç½®å‡½æ•°

æ¯å½“åœ¨ PyCaret ä¸­åˆå§‹åŒ–`setup`å‡½æ•°æ—¶ï¼Œå®ƒéƒ½ä¼šåˆ†ææ•°æ®é›†å¹¶æ¨æ–­æ‰€æœ‰è¾“å…¥è¦ç´ çš„æ•°æ®ç±»å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥çœ‹åˆ°é™¤äº†`Carat Weight`æ‰€æœ‰å…¶ä»–ç‰¹å¾éƒ½è¢«æ¨æ–­ä¸ºåˆ†ç±»ï¼Œè¿™æ˜¯æ­£ç¡®çš„ã€‚æ‚¨å¯ä»¥æŒ‰ enter é”®ç»§ç»­ã€‚

æ³¨æ„ï¼Œæˆ‘åœ¨`setup`ä¸­ä½¿ç”¨äº†`transform_target = True`ã€‚PyCaret å°†ä½¿ç”¨ box-cox å˜æ¢åœ¨åå°è½¬æ¢`Price`å˜é‡ã€‚å®ƒä»¥ç±»ä¼¼äºæ—¥å¿—è½¬æ¢*(æŠ€æœ¯ä¸Šä¸åŒ)*çš„æ–¹å¼å½±å“æ•°æ®çš„åˆ†å¸ƒã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº box-cox å˜æ¢çš„çŸ¥è¯†ï¼Œä½ å¯ä»¥å‚è€ƒè¿™ä¸ª[é“¾æ¥](https://onlinestatbook.com/2/transformations/box-cox.html)ã€‚

![](img/cc53cd3dcd933f321031a4b014d5707d.png)

è®¾ç½®çš„è¾“å‡ºâ€”ä¸ºæ˜¾ç¤ºè€Œæˆªæ–­

# ğŸ‘‰æ¨¡å‹è®­ç»ƒå’Œé€‰æ‹©

ç°åœ¨æ•°æ®å‡†å¤‡å·¥ä½œå·²ç»å®Œæˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`compare_models`åŠŸèƒ½å¼€å§‹è®­ç»ƒè¿‡ç¨‹ã€‚æ­¤å‡½æ•°è®­ç»ƒæ¨¡å‹åº“ä¸­å¯ç”¨çš„æ‰€æœ‰ç®—æ³•ï¼Œå¹¶ä½¿ç”¨äº¤å‰éªŒè¯è¯„ä¼°å¤šä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚

```
**# compare all models**
best = compare_models()
```

![](img/84d5f17dbac103a24c3699521e3e0de1.png)

compare_models çš„è¾“å‡º

åŸºäº*å¹³å‡ç»å¯¹è¯¯å·®*çš„æœ€ä½³æ¨¡å‹æ˜¯`CatBoost Regressor`ã€‚ä½¿ç”¨ 10 å€äº¤å‰éªŒè¯çš„ MAE ä¸º 543 ç¾å…ƒï¼Œè€Œé’»çŸ³çš„å¹³å‡ä»·å€¼ä¸º 11ï¼Œ600 ç¾å…ƒã€‚è¿™è¿˜ä¸åˆ° 5%ã€‚å¯¹äºæˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€ä»˜å‡ºçš„åŠªåŠ›æ¥è¯´è¿˜ä¸é”™ã€‚

```
**# check the residuals of trained model**
plot_model(best, plot = 'residuals_interactive')
```

![](img/1e28b0917f49b9e33d315e6b69dad88c.png)

æœ€ä½³æ¨¡å‹çš„æ®‹å·®å’Œ QQ å›¾

```
**# check feature importance**
plot_model(best, plot = 'feature')
```

![](img/9741cdeefb633345b19166ca726e7999.png)

æœ€ä½³æ¨¡å‹çš„ç‰¹å¾é‡è¦æ€§

# å®Œæˆå¹¶ä¿å­˜ç®¡é“

ç°åœ¨è®©æˆ‘ä»¬æœ€ç»ˆç¡®å®šæœ€ä½³æ¨¡å‹ï¼Œå³åœ¨åŒ…æ‹¬æµ‹è¯•é›†åœ¨å†…çš„æ•´ä¸ªæ•°æ®é›†ä¸Šè®­ç»ƒæœ€ä½³æ¨¡å‹ï¼Œç„¶åå°†ç®¡é“ä¿å­˜ä¸º pickle æ–‡ä»¶ã€‚

```
**# finalize the model**
final_best = finalize_model(best)**# save model to disk** save_model(final_best, 'diamond-pipeline')
```

# ğŸ‘‰éƒ¨ç½²

> ***é¦–å…ˆï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦éƒ¨ç½²æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Ÿ***

*æœºå™¨å­¦ä¹ æ¨¡å‹çš„éƒ¨ç½²æ˜¯ä½¿æ¨¡å‹åœ¨ç”Ÿäº§ä¸­å¯ç”¨çš„è¿‡ç¨‹ï¼Œå…¶ä¸­ web åº”ç”¨ç¨‹åºã€ä¼ä¸šè½¯ä»¶å’Œ API å¯ä»¥é€šè¿‡æä¾›æ–°çš„æ•°æ®ç‚¹å’Œç”Ÿæˆé¢„æµ‹æ¥ä½¿ç”¨ç»è¿‡è®­ç»ƒçš„æ¨¡å‹ã€‚é€šå¸¸å»ºç«‹æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥ç”¨äºé¢„æµ‹ç»“æœ(äºŒè¿›åˆ¶å€¼ï¼Œå³ç”¨äºåˆ†ç±»çš„ 1 æˆ– 0ï¼Œç”¨äºå›å½’çš„è¿ç»­å€¼ï¼Œç”¨äºèšç±»çš„æ ‡ç­¾ç­‰)ã€‚ç”Ÿæˆé¢„æµ‹æœ‰ä¸¤ç§ä¸»è¦æ–¹å¼(I)æ‰¹é‡é¢„æµ‹ï¼›ä»¥åŠ(ii)å®æ—¶é¢„æµ‹ã€‚æœ¬æ•™ç¨‹å°†å±•ç¤ºå¦‚ä½•å°†æ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹éƒ¨ç½²ä¸º API ä»¥è¿›è¡Œå®æ—¶é¢„æµ‹ã€‚*

æ—¢ç„¶æˆ‘ä»¬å·²ç»ç†è§£äº†ä¸ºä»€ä¹ˆéƒ¨ç½²æ˜¯å¿…è¦çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»å…·å¤‡äº†åˆ›å»º API æ‰€éœ€çš„ä¸€åˆ‡ï¼Œå³*ä½œä¸º pickle æ–‡ä»¶*çš„è®­ç»ƒæ¨¡å‹ç®¡é“ã€‚ä½¿ç”¨ FastAPI åˆ›å»º API éå¸¸ç®€å•ã€‚

[https://gist . github . com/moe zali 1/4bd 5312d 27884d 7 b 07 f 66 bef CDC 28 CCF](https://gist.github.com/moezali1/4bd5312d27884d7b07f66befcdc28ccf)

ä»£ç çš„å‰å‡ è¡Œæ˜¯ç®€å•çš„å¯¼å…¥ã€‚ç¬¬ 8 è¡Œæ­£åœ¨é€šè¿‡è°ƒç”¨`FastAPI()`åˆå§‹åŒ–ä¸€ä¸ª appã€‚ç¬¬ 11 è¡Œä»æ‚¨çš„ç£ç›˜åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹`diamond-pipeline`(æ‚¨çš„è„šæœ¬å¿…é¡»ä¸æ–‡ä»¶åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­)ã€‚ç¬¬ 15â€“20 è¡Œå®šä¹‰äº†ä¸€ä¸ªåä¸º`predict`çš„å‡½æ•°ï¼Œå®ƒæ¥å—è¾“å…¥ï¼Œå¹¶åœ¨å†…éƒ¨ä½¿ç”¨ PyCaret çš„`predict_model`å‡½æ•°æ¥ç”Ÿæˆé¢„æµ‹ï¼Œå¹¶å°†å€¼ä½œä¸ºå­—å…¸è¿”å›(ç¬¬ 20 è¡Œ)ã€‚

ç„¶åï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œè¯¥è„šæœ¬ã€‚åœ¨æ‰§è¡Œæ­¤å‘½ä»¤ä¹‹å‰ï¼Œæ‚¨å¿…é¡»ä¸ python è„šæœ¬å’Œæ¨¡å‹ pickle æ–‡ä»¶ä½äºåŒä¸€ç›®å½•ä¸‹ã€‚

```
uvicorn main:app --reload
```

è¿™å°†åœ¨æœ¬åœ°ä¸»æœºä¸Šåˆå§‹åŒ–ä¸€ä¸ª API æœåŠ¡ã€‚åœ¨æ‚¨çš„æµè§ˆå™¨ä¸Šé”®å…¥[http://localhost:8000/docs](http://localhost:8000/docs)ï¼Œå®ƒåº”è¯¥æ˜¾ç¤ºå¦‚ä¸‹å†…å®¹:

![](img/ed9068582f64441134bc16f4e955a90a.png)

http://æœ¬åœ°ä¸»æœº:8000/docs

ç‚¹å‡»ç»¿è‰²çš„`**POST**` æŒ‰é’®ï¼Œä¼šæ‰“å¼€ä¸€ä¸ªè¿™æ ·çš„è¡¨å•:

![](img/7fd7b94676310f23883a10576c7b0b16.png)

[http://localhost:8000/docs](http://localhost:8000/docs)

ç‚¹å‡»å³ä¸Šè§’çš„**â€œè¯•ç”¨â€**ï¼Œåœ¨è¡¨æ ¼ä¸­å¡«å†™ä¸€äº›å€¼ï¼Œç„¶åç‚¹å‡»â€œæ‰§è¡Œâ€ã€‚å¦‚æœæ‚¨åšäº†æ‰€æœ‰æ­£ç¡®çš„äº‹æƒ…ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹å“åº”:

![](img/31331be5bfc6aaba88849ded97cb6255.png)

æ¥è‡ª FastAPI çš„å“åº”

è¯·æ³¨æ„ï¼Œåœ¨å“åº”ä¸»ä½“ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé¢„æµ‹å€¼ 5396(è¿™æ˜¯åŸºäºæˆ‘åœ¨è¡¨å•ä¸­è¾“å…¥çš„å€¼)ã€‚è¿™æ„å‘³ç€ï¼Œè€ƒè™‘åˆ°æ‚¨è¾“å…¥çš„æ‰€æœ‰å±æ€§ï¼Œè¿™é¢—é’»çŸ³çš„é¢„æµ‹ä»·æ ¼ä¸º 5396 ç¾å…ƒã€‚

è¿™å¤ªå¥½äº†ï¼Œè¿™è¡¨æ˜æˆ‘ä»¬çš„ API æ­£åœ¨å·¥ä½œã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Python æˆ–ä»»ä½•å…¶ä»–è¯­è¨€ä¸­çš„`requests`åº“æ¥è¿æ¥ API å¹¶ç”Ÿæˆé¢„æµ‹ã€‚æˆ‘ä¸ºæ­¤åˆ›å»ºäº†å¦‚ä¸‹æ‰€ç¤ºçš„è„šæœ¬:

[https://gist . github . com/moe zali 1/545 be 5743 b 61 aa 5477228 b 8727 e 40 b 59](https://gist.github.com/moezali1/545be5743b61aa5477228b8727e40b59)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°çš„è¿è¡Œæƒ…å†µ:

![](img/a42897886ae995e4647f0186e6781996.png)

ä¸ºè¿›è¡Œ API è°ƒç”¨è€Œåˆ›å»ºçš„ get_prediction å‡½æ•°

è¯·æ³¨æ„ï¼Œé¢„æµ‹å€¼æ˜¯ 5396ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸ä¸Šè¡¨ä¸­ç›¸åŒçš„å€¼ã€‚(1.1ï¼Œâ€œç†æƒ³â€ï¼Œâ€œHâ€ï¼Œâ€œSIIâ€ï¼Œâ€œVGâ€ï¼Œâ€œEXâ€ï¼Œâ€œGIAâ€)

æˆ‘å¸Œæœ›ä½ ä¼šå–œæ¬¢ PyCaret å’Œ FastAPI çš„æ˜“ç”¨æ€§å’Œç®€å•æ€§ã€‚åœ¨ä¸åˆ° 25 è¡Œä»£ç å’Œå‡ åˆ†é’Ÿçš„å®éªŒä¸­ï¼Œæˆ‘ä½¿ç”¨ PyCaret è®­ç»ƒå’Œè¯„ä¼°äº†å¤šä¸ªæ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ API éƒ¨ç½²äº† ML ç®¡é“ã€‚

# å³å°†æ¨å‡ºï¼

ä¸‹å‘¨æˆ‘å°†å†™ä¸€ç¯‡æ•™ç¨‹æ¥æ¨è¿›éƒ¨ç½²åˆ°ä¸‹ä¸€ä¸ªçº§åˆ«ï¼Œæˆ‘å°†åœ¨ä¸‹ä¸€ç¯‡æ•™ç¨‹ä¸­ä»‹ç»åƒå®¹å™¨åŒ–å’Œç å¤´å·¥äººè¿™æ ·çš„æ¦‚å¿µã€‚è¯·å…³æ³¨æˆ‘çš„[åª’ä½“](https://medium.com/@moez-62905)ã€ [LinkedIn](https://www.linkedin.com/in/profile-moez/) ã€ [Twitter](https://twitter.com/moezpycaretorg1) è·å–æ›´å¤šæ›´æ–°ã€‚

ä½¿ç”¨ Python ä¸­çš„è¿™ä¸ªè½»é‡çº§å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°çš„ç›®æ ‡æ˜¯æ— é™çš„ã€‚å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°ç»™æˆ‘ä»¬ GitHub åº“ä¸Šçš„â­ï¸ã€‚

è¦äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·å…³æ³¨æˆ‘ä»¬çš„ LinkedIn å’Œ Youtubeã€‚

åŠ å…¥æˆ‘ä»¬çš„ä¼‘é—²é¢‘é“ã€‚æ­¤å¤„é‚€è¯·é“¾æ¥[ã€‚](https://join.slack.com/t/pycaret/shared_invite/zt-p7aaexnl-EqdTfZ9U~mF0CwNcltffHg)

# æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£:

[ä½¿ç”¨ PyCaret 2.0](/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d)
[åœ¨ Power BI ä¸­æ„å»ºæ‚¨è‡ªå·±çš„ AutoML ä½¿ç”¨ Docker](/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01)
[åœ¨ Azure ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“åœ¨ Google Kubernetes å¼•æ“ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“](/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b)
[åœ¨ AWS Fargate ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“](/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507)
[æ„å»ºå’Œéƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹  web åº”ç”¨](/build-and-deploy-your-first-machine-learning-web-app-e020db344a99)
[ä½¿ç”¨ AWS Fargate æ— æœåŠ¡å™¨](/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2)
[æ„å»ºå’Œéƒ¨ç½²æœºå™¨](/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104)

# é‡è¦é“¾æ¥

[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/installation.html)
[åšå®¢](https://medium.com/@moez_62905)
[GitHub](http://www.github.com/pycaret/pycaret)
[stack overflow](https://stackoverflow.com/questions/tagged/pycaret)
[å®‰è£… PyCaret](https://pycaret.readthedocs.io/en/latest/installation.html) [ç¬”è®°æœ¬æ•™ç¨‹](https://pycaret.readthedocs.io/en/latest/tutorials.html) [æŠ•ç¨¿äº PyCaret](https://pycaret.readthedocs.io/en/latest/contribute.html)

# æƒ³äº†è§£æŸä¸ªç‰¹å®šæ¨¡å—ï¼Ÿ

å•å‡»ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ–‡æ¡£å’Œå·¥ä½œç¤ºä¾‹ã€‚

[åˆ†ç±»](https://pycaret.readthedocs.io/en/latest/api/classification.html) å›å½’ èšç±»
[å¼‚å¸¸æ£€æµ‹](https://pycaret.readthedocs.io/en/latest/api/anomaly.html)
[è‡ªç„¶è¯­è¨€å¤„ç†](https://pycaret.readthedocs.io/en/latest/api/nlp.html) [å…³è”è§„åˆ™æŒ–æ˜](https://pycaret.readthedocs.io/en/latest/api/arules.html)