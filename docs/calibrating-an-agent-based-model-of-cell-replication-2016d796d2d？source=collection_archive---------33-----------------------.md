# 校准基于代理的细胞复制模型

> 原文：<https://towardsdatascience.com/calibrating-an-agent-based-model-of-cell-replication-2016d796d2d?source=collection_archive---------33----------------------->

## 解释现实世界细胞样本中的部分同步性

基于主体的模型提供了探索和解释世界的另一种方式。他们可以通过告知其行为的逻辑提供预测*和*解释力，特别是如果他们根据现实世界的数据进行校准。

[在这篇论文](https://royalsocietypublishing.org/doi/full/10.1098/rsif.2019.0382)中，研究人员构建了一个数学模型来预测细胞样本复制中发生的部分同步性。我很好奇，想看看我能否采取一种基于智能体的方法来解决这个问题，这是否也能让我*解释*这一现象。我将使用 HASH，一个基于代理的在线模拟平台来构建我的模型，并根据原始论文中使用的真实数据对其进行校准。

# 细胞复制

细胞在许多不同的阶段之间有规律地转换: *G1* 、 *eS* 和 *S/G2/M* 。它们只在这个周期结束时进行有丝分裂(复制)，分裂成两个不同的细胞。由于这种加倍，细胞样品的生长呈指数增长，但仍然是离散的。因此，如果细胞样本是完全同步的(所有细胞处于周期的同一阶段，同时复制)，绘制细胞数量随时间的变化曲线将不会产生平滑的曲线，而是离散的跳跃。

为了确保样品中的细胞生长是平滑的曲线，为生物实验室和分析准备了异步样品，细胞随机分布在不同的阶段。然而，实验数据显示，大多数样本的行为是部分同步的，而不是异步的。这是很重要的，因为研究和结果是基于平稳指数增长的假设。

让我们尝试创建一个模型来解释这种部分同步的行为。

# 模型

这个模型中的代理只需要一种行为:复制。这种行为将跟踪每个代理的细胞周期，并在达到适当的阶段时生成一个新的细胞。定义这种行为暴露了一条非常重要的信息。当细胞分裂时，产生的两个细胞都处于细胞周期的开始。**他们已经同步**。尽管我们的代理最初是在细胞周期的随机阶段产生的，但我们的细胞复制得越多，同步性就可能出现得越多。如果我们的模型与观察到的数据匹配得足够好，这可能是理解制备样本中部分同步性的关键。

我将通过在细胞周期的每个阶段初始化正确数量的代理来确保我的初始状态与数据一致。每种试剂都根据其当前的细胞周期阶段用不同的颜色标记，与原始论文中使用的颜色相匹配。有三个不同的图来解释我们系统的状态:总细胞的时间序列、按颜色计数的细胞的时间序列和 Q 的时间序列(基于每个周期中细胞数量计算的比率)。

[你可以在这里找到型号](https://core.hash.ai/@hash/multi-stage-cell-replication/stable)。让我们看看我的第一个版本是什么样子的，与实际数据相比，我估计了每个周期的时间(*模型是蓝色的，对比实验数据是橙色的*):

![](img/15c710024fe8a038a1039b93c31f4cc4.png)

总细胞生长(图片由作者提供)

![](img/d5624d345e7036c63ae743abfe0ecb82.png)

各期细胞比例: *Q(t) = R(t) / (Y(t) + G(t))* (图片作者提供)

总的形状看起来是正确的，细胞总数呈指数增长，Q 值也是振荡的，尽管离数据还很远。增长和振荡周期都太快了。让我们看看是否可以使用优化引擎使模型更接近数据。我们将尝试发现细胞周期中每个阶段长度的最佳值，并确定我们先前的关键观察是否是部分同步性的有效解释。

# 校准

通过检查数据，看起来我们的细胞周期应该是大约 70 步长。我将为细胞周期的长度选择一个数值范围*、G1* 、 *eS* 和 *S/G2/M* ，它们的总和大约在那里。我将提供它们作为优化引擎的潜在值

![](img/de872629ab1f58fb080ab0948365a8d3.png)

在 HASH 中定义优化实验(图片由作者提供)

我将创建一个定制代理来计算每个时间步的模型输出和实验数据之间的误差。该代理将使用简单的平方和来捕获错误，优化引擎将尝试减少该值。首先，让我们试着拟合第二张图中的曲线，该图根据细胞周期中的阶段对药剂进行计数。

![](img/28707dc3e3ae03d8125637e0bbe2afda.png)

总细胞生长—第一次校准尝试(图片由作者提供)

![](img/e163be798abe4763829a64d835deff70.png)

细胞分阶段生长—第一次校准尝试(图片由作者提供)

![](img/e4ab3af6f85588b19a26580f56d6ace7.png)

q 比率—第一次校准尝试(图片由作者提供)

在前两个图中拟合看起来很好，但是 Q 的第三个图看起来不太拟合。让我们将误差度量改为对应于 Q 中的误差。这意味着平方和计算将使用从模拟和数据集计算的 Q 比率。这是优化的结果:

![](img/2c2dc7afa4d4d6d3f25c6d5dd46f2e4c.png)

总细胞生长—第二次校准尝试(图片由作者提供)

![](img/b26414b83d6477318d2982bcc97d3182.png)

细胞分阶段生长—第二次校准尝试(图片由作者提供)

![](img/74a8efa5b45894fd16cf02a2b2441348.png)

q 比率—第二次校准尝试(图片由作者提供)

q 现在有了一个更好的拟合，以其他两个图为代价。我将尝试合并这两个误差(按颜色的代理计数和 Q 比率),以便找到模型的最佳拟合。因为我从这些优化中获得了一些关于好的参数值的信息，所以我可以缩小实验定义的范围以提高其有效性。对于每个阶段的长度，我们将缩小到 5–10 之间的范围，而不是大约 20 个值的范围。

![](img/ab2d93cea37e948eab994f4a243afe8c.png)

总细胞生长—第三次校准尝试(图片由作者提供)

![](img/7659a00370d92d5a4d53b97bd7cc9eed.png)

细胞分阶段生长—第三次校准尝试(图片由作者提供)

![](img/0e7e07fdff748b10bdea109b9386a52f.png)

q 比率—第三次校准尝试(图片由作者提供)

现在看来，我们已经找到了一组值，为第二个和第三个图提供了最佳的拟合平衡。每个阶段长度的最终值为:

*   G1: 25 个时间步骤
*   埃斯:27 个时间步
*   S/G2/M: 18 个时间步长

每个时间步长相当于 1/4 小时。

用基于主体的模型复制实验数据的能力提供了对导致系统以特定方式运行的机制的洞察。与黑盒方法不同，使用基于代理的模型使我们不仅可以预测细胞生长，还可以解释为什么它会部分同步发生。在这种情况下，我们可以假设，观察到的行为是因为细胞复制得越多，它们就越有可能与共享“母”细胞的其他细胞排成一行。

像这样的洞察力可以让研究人员、实验室技术人员和审查委员会对细胞样本的行为方式做出更好的假设，让他们在预期和实验结果之间做出更明智的比较。这只是一个例子；使用根据真实世界数据校准的基于主体的模型也可以改善我们在经济、政府和许多其他领域的假设。