# 混淆矩阵到底是什么？

> 原文：<https://towardsdatascience.com/what-on-earth-is-a-confusion-matrix-d1717315106f?source=collection_archive---------38----------------------->

## 验证模型准确性的混淆矩阵的解释和使用。

![](img/04fb7730d296b6c3d4175815d71f9422.png)

(src =[https://pixabay.com/images/id-4493783/](https://pixabay.com/images/id-4493783/)

# 介绍

在数据科学中，预测总是需要用一些准确性指标来验证。这可能暗示了模型性能的隐现问题。衡量这一点总是很重要的，因为不使用具体的验证，就没有真正的方法来评估一个模型是否正确地完成了工作。由于模型是独立工作的，不需要人类的参与，在使用它们之前对它们进行测量无疑是一个好主意。

当然，为了测量模型的准确性，可以使用几种不同的度量标准。这些指标也可能取决于您试图解决的问题的类型。例如，具有连续目标的回归模型很可能会使用 r 度量，而不是标准的分类准确性。幸运的是，我最近写了一篇文章，通过一些流行的标准来验证机器学习模块，甚至深入到它们背后的数学。如果你对那篇文章感兴趣，你可以在这里阅读:

[](/writing-validation-metrics-from-scratch-e7d10af59f98) [## 从头开始编写验证指标

towardsdatascience.com](/writing-validation-metrics-from-scratch-e7d10af59f98) 

# 混淆矩阵

既然我们理解了为什么验证是重要的，并且对可用于测量模型的其他度量有了一定程度的了解，那么什么是混淆矩阵，以及什么使它成为模型验证的伟大工具呢？混淆矩阵，有时也称为误差矩阵，是一种矩阵或表格布局，允许对分类算法内的性能进行可视化。

您可能还记得，我提到了另一个通常用于分类准确性的指标。这个度量被称为广义百分比准确度。为了获得这个度量，我们简单地将 y-hat(我们预测的元素)中的每个值与测试目标中的值进行比较。之后，我们将正确答案的数量除以数组中值的数量。这将给我们一个正确预测的百分比。如果我们从 1 中减去这个，那么我们将得到模型的误差。在 Python 中，这样做的函数如下所示:

```
def categorical_acc(y, ŷ):
    n = len(ŷ)
    score = 0
    for i, w in zip(ŷ, y):
        if i == w;
            score += 1
    return(score / n)
```

这是判断绝对准确性的一个很好的方法。百分比值非常容易解释，如果我们告诉某人我们的模型有 98%的准确性，他们可能会知道这意味着什么。考虑到这一点，当然有一段时间这可能是最好的度量，即使是在展示你的模型的准确性的时候。例如，如果我向可能不知道混淆矩阵是什么的业务经理演示，那么对我来说，提供一个以易于解释的百分比记录的验证度量标准是很有意义的。

也就是说，虽然广义百分比准确性有时间和地点，但也有使用混淆矩阵的有效时间。混淆矩阵是一个很好的可视化工具，特别是当你和你的科学家同事一起工作的时候，它们可以告诉你更多关于你的模型的信息，而不仅仅是广义百分比的准确性。例如，我们可以判断我们的目标是否有一个特定的类，可能是多数类，被预测得太频繁了。这可能表明我们可能想要优化一些超参数，更可能使我们的数据多样化一些。在这样的例子中，混淆矩阵对于解决你的分类模型的问题非常有用。

混淆矩阵和其他典型的分类矩阵之间最显著的区别是混淆矩阵允许我们理解我们的单个类是如何使用我们的模型的。也就是说，使用混淆矩阵，我们不是一次性估计整个值集的准确性，而是对每个特征的负值和正值进行舍入，并将它们放在一起以便于比较。

混淆矩阵还允许我们评估第一类错误或第二类错误的可能性，这在处理分类时可能是有价值的信息。

# 结论

混淆矩阵是数据科学家的宝贵财富。它们允许我们非常有效地快速比较不同的特性和错误返回。虽然分类准确性肯定有一席之地，但这项技术向我们展示了更多关于我们的模型和数据的信息，而不仅仅是准确性得分。这个指标不仅可以用来验证你的模型，还可以很容易地用来诊断为什么你有你的准确性。感谢您的阅读！