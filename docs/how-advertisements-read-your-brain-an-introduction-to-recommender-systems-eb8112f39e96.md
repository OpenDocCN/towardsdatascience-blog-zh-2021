# 广告如何读懂你的大脑:推荐系统介绍

> 原文：<https://towardsdatascience.com/how-advertisements-read-your-brain-an-introduction-to-recommender-systems-eb8112f39e96?source=collection_archive---------29----------------------->

## 推荐系统可能非常准确。让我们弄清楚它们是如何工作的。

![](img/7c0b9941e99069e294dec66ffa3eee96.png)

沃伊泰克·维特科夫斯基在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

如今网络广告无处不在。你不可能在网上逛很多地方而不被邀请去买东西——也许是一件衬衫，也许是一副耳机。更重要的是，这些广告具有不可思议的准确性。我经常惊讶于我实际上会从展示给我的广告中购买多少东西。这些广告给我留下了深刻的印象，让我感到毛骨悚然，我决定弄清楚它们是如何运作的。事实证明，这些广告被称为**推荐系统**，实际上非常直观。在这篇文章中，我们将看看一个简单而有效的推荐系统，并解释它是如何工作的。

# 问题是

我们首先要定义一个具体的问题。假设我们为亚马逊工作，我们可以访问(用户名、产品 Id、评级)形式的产品评级数据库。由于亚马逊是一家如此大的公司，我们有很多这样的评级。我们的目标是预测数据库中尚不存在的(用户名，产品 Id)对的评分。

我们该如何解决这个问题？嗯，对于我们试图预测的每个(用户名，产品 Id)对，我们可能会查看用户名给出的其他评级。例如，如果我们看到 Username 对吉他弦和吉他拨片给予了很高的评价，我们可能会推断此人是一名吉他弹奏者，并且他也会对其他吉他配件如吉他调音器给予很高的评价。我们也可以为其他爱好做同样的事情。例如，如果有人给棒球棒和棒球鞋一个差评，我们也不会给棒球手套差评。

那么如何用数学方法来表达这个想法呢？我们可以使用一种叫做**的东西嵌入**。嵌入是复杂对象的一种紧凑表示(通常是一个向量)，例如，用户的偏好。具体来说，我们要做的是用向量来表示用户和产品。用户向量的每个元素都代表了用户对特定类型产品的喜欢程度。例如，我们可以设置用户向量的第一个元素代表棒球产品，第二个元素代表吉他产品。那么用户向量(3，-2)将意味着该用户喜欢棒球产品，而不喜欢吉他产品。

我们设置产品向量的每个元素来表示该类型产品的多少。例如,( 5，0)的产品向量将表示肯定是棒球产品的东西，而肯定不是吉他产品——类似于棒球棒的东西。(2，2)的乘积矢量将表示与棒球和吉他都相关的东西，可能是棒球主题的吉他。

一旦我们有了用户和产品向量，我们就可以用点积得到一个代表用户对产品偏好的数字。例如，对于用户向量(3，-2)和产品向量(5，0)，我们将得到点积 15，这意味着用户会喜欢这个项目，并给它一个高评级。如果产品向量是(2，2 ),我们将得到 2 的点积，这意味着用户对这个产品不冷不热。这是有意义的，因为(2，2)产品同样与棒球和吉他相关，而我们的(3，-2)用户喜欢棒球，但不喜欢吉他。我们可以将这一思想推广到任意大小的向量。除了棒球和吉他，我们还可以拥有 100 维向量，代表对 100 种不同产品的偏好。

既然我们已经有了表示用户和产品的方法，以及计算用户/产品对评级的方法，我们需要弄清楚如何训练我们的系统。换句话说，我们需要想出一种方法来获得准确的用户和产品嵌入。在训练开始时，我们没有关于用户或产品嵌入的信息，因此将这些嵌入设置为随机值似乎是合理的。回到我们的棒球/吉他示例，假设我们随机将用户嵌入设置为(3，-3)，将产品嵌入设置为(1，1)。预测评分是 0，我们假设这个用户的真实评分是 5。

我们预测的评分太低了。然后，我们可以调整用户嵌入和产品嵌入，以更好地匹配真实评级。例如，我们可以将用户嵌入改为(3.1，-2.9)，将产品嵌入改为(1.1，0.9)。这使我们更接近真实的评级，但我们还没有到那一步。然后我们可以尝试(3.2，-2.8)和(1.2，0.8)，再次检查，重新调整，等等。我们描述的这个过程是梯度下降，这很好，因为它很容易实现。

然而，我们还有一个问题，那就是如何选择我们的嵌入中应该包含什么类型的产品。显然，对于现实生活中的系统，我们需要的不仅仅是棒球类型和吉他类型。然而，我们不可能包含宇宙中的每一种产品类型，因为这将使事情在计算上不可行。相反，我们通过只设置嵌入的大小，并让训练算法决定使用什么产品类型来避免这个问题。现在我们来看看完整的训练算法。

# 训练算法:

*   为用户和产品嵌入确定一个维度 k(k = 40 是合理的)。
*   对于数据库中的每个用户，用随机值初始化一个 k 维向量作为该用户的嵌入。
*   对于数据库中的每个产品，用随机值初始化一个 k 维向量作为该产品的嵌入。
*   对于数据库中已经有评级的每个用户/产品组合(我们的训练集)，在适当的嵌入之间进行点积，并获得预测的评级。
*   获得所有预测评分和实际评分之间的误差平方和。这是总误差。
*   取关于用户和产品嵌入的总误差的梯度。对所有嵌入进行梯度下降。
*   重复进行，直到总误差满足一些预定义的标准。

如您所见，在我们的算法中，我们不需要精心挑选产品类型。我们让梯度下降为我们做到这一点。直观上，这个算法相当简单。我们所做的就是基于我们的嵌入计算我们的预测评级，将这些评级与真实评级进行比较，然后相应地更新嵌入。在实际方面，这种算法在实践中表现良好。它的一个变体在[网飞电影分级竞赛](https://www.netflixprize.com/)中名列前十。在比赛之后的几年里，许多新算法被提出，但它们似乎没有提供太多(~2%)的改进，并且有[再现性问题](https://arxiv.org/pdf/1905.01395v1.pdf)。

还有最后一件事。原来，我们的算法与奇异值分解(SVD)有关，奇异值分解是一种众所周知的矩阵分解方法。因为 SVD 被广泛使用，所以我们可以利用高度优化的 SVD 实现。完整的主题是另一个时间，但它值得一提。

在本文中，我们从头开始推理，提出了一个推荐系统，它可以与复杂得多的模型竞争。此外，我们的系统具有直观和易于实现的优点。请留下任何评论或问题，让我知道你接下来想看什么！