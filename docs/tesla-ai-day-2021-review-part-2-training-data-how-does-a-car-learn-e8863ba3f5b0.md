# 特斯拉人工智能日 2021 回顾—第 2 部分:训练数据。汽车是如何学习的？

> 原文：<https://towardsdatascience.com/tesla-ai-day-2021-review-part-2-training-data-how-does-a-car-learn-e8863ba3f5b0?source=collection_archive---------12----------------------->

## 人工智能|新闻

## 获取高质量真实世界数据的挑战。

![](img/4eb9388f1d446f588d692ec38f689969.png)

卢卡斯·布拉塞克在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

本文是 4 部分系列的第二部分:

> 1.[完全自动驾驶汽车的承诺](/tesla-ai-day-2021-review-part-1-the-promise-of-fully-self-driving-cars-8e469265509b)
> 
> **2。训练数据。汽车是如何学习的？**
> 
> 3.[项目道场。特斯拉的新型超级计算机](/tesla-ai-day-2021-review-part-3-project-dojo-teslas-new-supercomputer-715d102dbb29)
> 
> 4.[为什么特斯拉 2022 年不会有自主人形机器人](/tesla-ai-day-2021-review-part-4-why-tesla-wont-have-an-autonomous-humanoid-robot-in-2022-76dff743f885)

8 月 19 日，特斯拉举办了 2021 年最重要的人工智能活动之一；特斯拉人工智能日(你可以在这里观看整个事件)。

该公司的领先研究人员和工程师展示了硬件、软件、人工智能、机器人、计算和自动驾驶汽车的最新发展。该活动的重点是吸引潜在候选人在当前和未来项目中工作的注意力。

演讲分为四大部分。我将使用相同的大纲来分隔本系列的文章:

*   **特斯拉自动驾驶。**如何让汽车完全自主解决视觉、规划和控制。
*   **培训数据生成。**如何创建训练网络所需的大数据集:手动标注、自动标注和模拟。
*   **道场和 D1 芯片项目。**下一代 AI 训练计算机。
*   **特斯拉机器人。**马斯克说，自主人形机器人将执行“危险、重复、无聊的任务”。"将来体力劳动将是一种选择."

再来看第二部分:**训练数据。汽车是如何学习的？**

> **免责声明:**由于无法联系到特斯拉，我将在相应的时间段直接链接到 YouTube 演示文稿上的相关视觉效果。我建议你在阅读时点击这些链接，以便更好地理解这些解释。

当人们第一次接触人工智能时，他们倾向于将重点放在算法上。他们如何识别猫和狗的图片，如何学习下棋，或者如何作曲和写诗，这些都让人们感到惊讶，因为这感觉就像魔术一样。有很多种算法，但大多数有新闻价值的里程碑都是由一种类型产生的——媒体非常喜欢的——神经网络。

人们关心深度神经网络的能力，但他们忘记了这些“黑盒”模型只不过是空的外壳，没有大型数据集将它们训练成强大的预测器和分类器。

熟能生巧，深度神经网络也是如此。他们是怎么做到的？从数据中学习。只是因为人们已经创建、组织、清理、标记和管理了大型数据集，深度学习才有机会成为人工智能超级明星范式。

领先的深度学习专家吴恩达喜欢强调数据的重要性，而不是算法。他拒绝以模型为中心的机器学习趋势。他建议我们应该采取一种更加以数据为中心的方法——开发者修改数据集，而不是调整算法。

他认为，这种焦点的转移可以让人工智能社区对数据集的重要性有更好的看法；有时被遗忘的现代人工智能引擎。

# 真实世界数据的挑战

自动驾驶汽车是人工智能中数据重要性的最高指数之一。不仅驾驶汽车的系统需要惊人的大量数据，而且这些数据必须是真实世界的数据。为了理解从真实世界的数据进行预测有多困难，让我们看看当 ConvNets 面临 ImageNet 挑战时会发生什么。

2012 年，Geoffrey Hinton 的团队凭借[的 ConvNet 模型](https://papers.nips.cc/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf)赢得了挑战，以+10%的误差率击败了他们的(非深度学习)竞争对手——实现了 63.30%的最高准确率。这在当时是一个惊人的结果，但从那以后深度学习已经有了很大的进步。

今天，最好的 ConvNets 在相同的基准上实现了 [+90%的顶级精度](https://paperswithcode.com/sota/image-classification-on-imagenet)。这些模型在对 ImageNet 数据集中的图像进行分类方面比人类更好*。然而，当这些精确的模型在 object net(ImageNet 的真实版本)上测试时，它们经历了[40–45%的性能下降](https://objectnet.dev/objectnet-a-large-scale-bias-controlled-dataset-for-pushing-the-limits-of-object-recognition-models.pdf)。他们根本无法处理现实的巨大复杂性。*

*这是特斯拉在训练视觉和规划神经网络时面临的挑战。唯一可行的方法是用足够的真实世界数据训练算法，这样它们最终会经历几乎所有可能的场景。*

# *不寻常场景的挑战*

*然而，因为他们决定从图像空间预测转变为向量空间预测——正如我在本系列的第[部分](/tesla-ai-day-2021-review-part-1-the-promise-of-fully-self-driving-cars-8e469265509b)中解释的那样——他们需要向量空间数据集。他们如何获取这些数据集，使它们包含足够干净和多样的例子？他们唯一的选择是自己创建数据集。*

*作为第一步，他们建立了一个由 1000 人组成的团队进行人工标注。因为这个贴标签的过程既慢又精确，所以他们决定用他们的车队来做自动贴标签。这个想法是让汽车四处行驶——无论是否自动驾驶——捕捉视频，然后发送到一台超级计算机，为它们贴上标签以供进一步训练。*

*但这就够了吗？不。FSD 仍在发展中的主要原因之一是世界提供了无限多的情况。这可能会阻止汽车达到完美的准确性。尽管汽车学习了大量的数据，但没有人能确保它们在训练中会遇到所有这些可能性。*

*这就是为什么他们建立了一个模拟。它们可能会产生罕见的场景，尽管这些场景很可能永远不会发生，但发生的概率仍然很小。然后可以用这些数据训练汽车，为最意想不到的情况做准备。*

*从这里开始，我将文章分为四个部分:*

1.  *手动标注—从 2D 图像到 4D 矢量*
2.  *自动标记——人在回路之外*
3.  *模拟——自动驾驶仪的视频游戏*
4.  *见解。*

# *1.手动标注—从 2D 图像到 4D 矢量*

*特斯拉工程师首先意识到的一件事是，从第三方公司获取数据是不够的——质量可疑，延迟高。他们不能相信别人能完成如此高风险的任务。忠于他们的垂直整合原则，他们决定创建一个“1000 人的内部数据标签团队。”*

*这个团队负责在向量空间中手动标记初始训练数据集。一开始他们一个个给图像贴标签，看起来就是[这个](https://youtu.be/j0z4FweCy4M?t=5192)。现在，他们给 4D 向量空间重建贴上标签，看起来[好多了](https://youtu.be/j0z4FweCy4M?t=5217)。因为向量空间是从八个相机和多个帧中一次性构建的，所以每个单一标记工作现在的价值是以前的 100 倍。*

*对于大多数问题，手动标记是唯一可能的解决方案。但特斯拉工程师知道，他们永远不会获得足够的数据来可靠地训练汽车，仅仅通过手动标记——甚至在向量空间也不行。这就是为什么他们想方设法利用计算机的能力以及拥有分布式车队给他们带来的优势。他们设计了一条自动贴标流水线，以补充手动贴标机团队，后者将在事后检查噪音和错误。*

# *2.自动标记——人在回路之外*

*他们赌的是把人类排除在循环之外。虽然特斯拉的自动标签过程更像是“半自动标签”，但在很大程度上，汽车可以在没有人工干预的情况下进行训练。为了生成自动标记的数据，他们构思了一个[三步流水线](https://youtu.be/j0z4FweCy4M?t=5296):*

*   ***捕捉片段:**他们收集由不同数据片段组成的片段——视频、IMU、GPS、里程计等。汽车四处行驶，像平常一样捕捉数据，但这一次的目的是将其用于进一步的训练。是否启用自动驾驶在很大程度上与这一步无关。这使得特斯拉可以使用它的任何一辆汽车，捕捉海量数据。*
*   ***特征提取:**该数据通过离线神经网络传递，神经网络提取不同类型的中间特征——深度、分割掩模、点匹配等。使用离线网络的优势(我将在后面解释)是网络不仅可以访问过去的数据，还可以访问未来的数据，这提高了标签的准确性。*
*   ***标注:**中间特征通过其他算法，为数据生成标签。自动标记在三种情况下大放异彩:重构道路、遮挡和运动学。*

*让我们从一些角度来理解自动标记是如何工作的，以及为什么它如此重要。让我们想象一下，我们的特斯拉汽车从一个行人身边经过。当它向前移动时，前面、侧面和后面的摄像头会捕捉到这个人，并从不同角度生成单摄像头视频。然后，这些视频可以通过神经网络，生成环境和行人的向量空间表示。*

*因为信息现在是在向量空间中，所以后续的处理算法对行人的感知比单个相机/帧所能提供的更丰富。遮挡、照明、角度、位置……所有潜在的错误标记因素都被减少或消除。这使得网络在大多数情况下无需人工检查就能生成高置信度的标签。然后，这些标签可以“反向传播”到各个相机，从而实现完全自动化的标签过程，标签位于图像和向量空间级别，以及单个/多个相机。*

*自动贴标提供了一个至关重要的优势，因为无论多少人工贴标机都无法生成如此庞大的标签集。在描绘各种可能场景的框架中，在数千个不同的对象上创建完美的边界框和语义类是极其费力的。*

*通过这条新颖的管道，特斯拉可以在短时间内生成数百万个标签。一个由 1000 辆汽车组成的车队，配备 8 台摄像机，每台摄像机以 36 帧/秒的速度拍摄 1 小时，总共会产生大约 10 亿帧的惊人数量，数千个物体都被高度可信地标记出来。它改变了游戏规则。*

*让我们来看看自动标签发挥作用的案例。*

## *改造道路*

*自动标记流水线可以完成的任务之一是重建路面。手工操作既繁琐又不精确，所以他们决定利用一种叫做 [NeRFs](https://arxiv.org/abs/2003.08934) (神经辐射场)的最新技术。这个想法是用一个神经网络来隐含地表示路面。然后，他们将 x，y 图像坐标输入网络，网络提取高度(z)和各种语义，定义该确切位置的内容——车道线、路缘、人行横道……*

*这些 3D 点可以被重新投影到八个摄像机中，并且因为网络具有坐标和语义类，所以它知道在每个摄像机视图中在哪里定位对象。在对成千上万个查询执行了这个过程之后，每个单个 cam 帧将完全被指向不同语义类别(线、路缘、人行横道……)的点填充。然后，用点填充的每个帧可以与同一场景的图像空间分割联合优化，以[生成道路上有什么的精确标签](https://youtu.be/j0z4FweCy4M?t=5402)。*

*然后，一辆汽车可以行驶数英里，在旅途中生成数据，这些数据可以用来标记整个区域。对几辆从不同角度经过相同位置的汽车重复这一过程将提供超精确的标签，正如这里所示的。在为表面生成标签后，整个过程中第一次有人可以进入循环并检查它们以校正噪声。*

*除了道路，同样的技术也可以用于[重建 3D 静态物体](https://youtu.be/j0z4FweCy4M?t=5481)，比如停放的汽车、房屋、墙壁等。*

## *咬合和运动学*

*正如我上面提到的，在离线神经网络中处理数据的一个重要优势是，它们不仅可以访问过去的数据，还可以访问未来的数据。在测试时，汽车需要预测其他车辆的速度和加速度，以规划最佳路线。自动标记管道允许网络通过[欺骗和前瞻](https://youtu.be/j0z4FweCy4M?t=5514)生成完美的标签。*

*同样的技巧也可以用于遮挡。部分或暂时的遮挡可以通过预测被遮挡物体再次出现的未来帧来解决。生成的标签包括这些信息，这简化了引导神经网络的学习过程。*

## *自动贴标的一个实例*

*自动标注管道提供了极其丰富的标注集，包括道路表面、静态对象和移动对象的运动学，甚至包括那些被遮挡的对象。[这里有一个标签外观的视觉示例。数据集不仅创建和标注更高效，而且信息更精确、更丰富。特斯拉希望生产 100 万个这种质量的剪辑来训练他们的车队。](https://youtu.be/j0z4FweCy4M?t=5568)*

*他们最近为“消除雷达”项目实施了自动标记过程。在过去几年中，特斯拉受到的一个批评是，他们不应该忽视类似激光雷达技术的重要性。然而，看起来他们已经设法改善了极端条件下的预测。对于这个项目，他们希望在极端条件下捕捉数千个片段，在这些条件下，前端摄像机充满了来自前方车辆的噪声。在一周内，他们得到了 10k 剪辑标签，并从根本上改善了性能。*

# *3.模拟——自动驾驶仪的视频游戏*

*除了手动和自动标记，特斯拉还开发了一个模拟环境，在特殊情况下训练自动驾驶。他们希望尽可能真实地重建世界，以便 Autopilot 可以顺利地将其从模拟中获得的知识转移到现实世界中。*

*使模拟成为一个独特资源的是，它从向量空间开始，所以它有完美的标签。它探测和识别物体所需的所有信息都已经输入到计算机中。它提供了边界框，运动学，表面，深度，分段。在两种主要情况下，模拟达到了其他两种标记方法失败的程度。*

*   ***困难来源:**这种情况指的是这样的场景，这种场景不太可能发生，以至于车队中的任何一辆车都没有遇到过——例如，一只驼鹿在高速公路上与汽车一起奔跑。自动驾驶需要知道如何在最超现实的场景面前做出反应，以防它们最终发生。*
*   ***困难的标记:**在一个场景中，有数百人以不同的方向和速度行走——例如，在高峰时间的市中心——人类将花费许多小时来标记，自动标记将无法正常工作，这在训练数据中引入了太多的错误。在模拟中，因为数据已经存在，所以提供标签是微不足道的。*

*那么，他们需要什么来创造出如此高质量的真实世界呢？五大要素:*

1.  ***精确的传感器模拟:**自动驾驶仪在模拟中看到的必须与它在现实世界中遇到的极其相似。他们必须模拟真实汽车使用的摄像机的属性，以便模拟真实地再现环境。*
2.  ***真实感渲染:**模拟是用时空反走样来降低噪声的。他们还使用神经渲染技术，结合机器学习和计算机图形设计知识，实现可靠和可控的视频生成。*
3.  ***不同的演员和地点:**为了避免网络过度适应模拟中非常有限的一组资源，他们需要汽车、人、场景和物体的多样化组合。这同样适用于模拟的特定位置。他们总共模拟了 2000 多英里的道路。*
4.  ***可扩展的场景生成:**模拟中的大部分数据是由算法而非美工创建的。这允许在程序上可伸缩地创建新的场景。他们还应用对抗技术来更有力地测试网络的弱点。*
5.  ***场景重建(故障):**他们可以用自动标注流程重新创建场景，这样 Autopilot 就可以再次面对它的故障。他们拍摄视频，并在模拟中重建场景，让 Autopilot 产生新的结果，直到它提高性能。*

# *4.洞察力*

## *特斯拉走自己的路*

*还有其他公司在研究 FSD 汽车，比如 way mo——谷歌的自动驾驶子公司——和 Cruise。但是他们都没有选择[和特斯拉](https://cleantechnica.com/2019/06/20/if-gm-cruise-is-way-behind-waymo-how-does-it-compare-to-tesla/#:~:text=Tesla%20recently%20released%20its%20Autopilot%20mode%20for%20its%20cars.%20It%20has%20a%20fundamentally%20different%20intellectual%20approach%20to%20autonomy%20than%20Google%E2%80%99s%2C%20and%20it%E2%80%99s%20superior.)一样的道路。虽然马斯克不喜欢激光雷达和任何其他类型的传感器，这些传感器可能会使自动驾驶汽车变得更便宜，但其他公司打赌没有它们就不可能实现 FSD。2019 年，汽车分析师[布拉德·邓普顿](https://www.forbes.com/sites/bradtempleton/2019/05/20/elon-musk-declares-precision-maps-a-really-bad-idea-heres-why-others-disagree/?sh=1fcba4132a33)批评特斯拉固执地做其他人多年前放弃的事情。*

*然而，特斯拉用来生成大型、可靠、精确和高质量真实世界数据集的三种方法的结合为他们提供了超越竞争对手的巨大优势。为什么特斯拉可以利用如此强大的技术组合？秘方是有一支庞大的车队已经在世界各地行驶。*

*2020 年初，特斯拉交付了近 100 万辆汽车——其中 80%配备了最新硬件版本的 Autopilot。特斯拉最接近的竞争对手 Waymo 在 2020 年 10 月仅有 [600 辆自动驾驶汽车](https://www.theverge.com/2020/10/30/21538999/waymo-self-driving-car-data-miles-crashes-phoenix-google#:~:text=The%20public%20road,without%20safety%20drivers.%29)在凤凰城 100 平方英里的区域内漫游。迄今为止，特斯拉车队已经在自动驾驶上行驶了超过[30 亿英里](https://lexfridman.com/tesla-autopilot-miles-and-vehicles/#:~:text=Estimated%20Autopilot%20miles%20to-date%3A%20%C2%A03.3%20billion%20miles)，而 Waymo 车队已经行驶了大约[2000 万英里](https://www.engadget.com/waymo-autonomous-vehicles-update-san-francisco-193934150.html)。特斯拉手中的数据增加了 150 倍，呈指数级增长。*

*很难知道哪种方法更好——基于视觉还是结合其他传感器——甚至很难知道两者最终能否提供令人满意的结果。很明显，特斯拉在数量上占了上风，他们会将这种资源开发到极限。这是否足以让这项技术以其他人只能梦想的方式发挥作用还有待证明。*

## *过度适应世界*

*事实上，Waymo 汽车只能在凤凰城附近行驶，这带来了一个即使是特斯拉也无法逃避的问题:过度适配。如果捕获的数据对应于特定的区域，具有特定的条件、人员和环境，那么这些数据必然会有偏差。*

*没有其他方法来捕获真实世界的数据，所以这是一个不可避免的问题。在特斯拉及其竞争对手的汽车普及之前，这些公司的数据集中不会有足够的多样性来从世界的极端可变性中学习。*

*一个月前，Twitter 上的一名用户指出了这个问题:“驾驶 FSD Beta 9.2 在旧金山兜风。[……]它在加州的效果肯定比在罗德岛好。”对此，埃隆·马斯克回应道:*

*特斯拉会认为旧金山湾区完美的自治足以声称 FSD 已经准备好了吗？他们会在地球上的每条道路上实现比人类更好的自动驾驶吗？最有可能的结果将介于这两种可能性之间。然而，就可持续发展是否已经实现达成共识将是困难的。就像硅谷出现的其他技术一样，它将在相当长的时间后到达世界上最偏远的地方——如果有可能的话。*

*如果你喜欢这篇文章，可以考虑订阅我的免费周报<https://mindsoftomorrow.ck.page>**！每周都有关于人工智能的新闻、研究和见解！***

***您也可以直接支持我的工作，使用我的推荐链接* [*这里*](https://albertoromgar.medium.com/membership) *成为中级会员，获得无限权限！:)***