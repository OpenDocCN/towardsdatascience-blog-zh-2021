# Python ç¯å¢ƒã€ä¾èµ–å’ŒåŒ…ç®¡ç†æŒ‡å—:Conda +è¯—æ­Œ

> åŸæ–‡ï¼š<https://towardsdatascience.com/a-guide-to-python-environment-dependency-and-package-management-conda-poetry-f5a6c48d795?source=collection_archive---------23----------------------->

## å¤§èŸ’

## å¦‚ä½•å°†åŒ…è‡ªåŠ¨æ·»åŠ åˆ°æ‚¨çš„ç¯å¢ƒæ–‡ä»¶ä¸­ï¼Œè€Œä¸å¿…æ‹…å¿ƒä¾èµ–å…³ç³»

![](img/489dc477bdba430ac6de1eae12958772.png)

**é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰ä½¿ç”¨çš„å›¾ç‰‡å‡ä¸ºä½œè€…æ‰€æœ‰ã€‚*

å¦‚æœæ‚¨åœ¨ä¸åŒçš„å¼€å‘é˜¶æ®µå¤„ç†å¤šä¸ª Python é¡¹ç›®ï¼Œé‚£ä¹ˆæ‚¨çš„ç³»ç»Ÿä¸Šå¯èƒ½ä¼šæœ‰ä¸åŒçš„ç¯å¢ƒã€‚æœ‰å„ç§å·¥å…·å¯ä»¥åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œå¹¶å®‰è£…æ‚¨çš„é¡¹ç›®æ‰€éœ€çš„åº“ã€‚è¿™ç¯‡æ–‡ç« è®¨è®ºäº† Python æ‰“åŒ…ã€ç¯å¢ƒå’Œä¾èµ–ç®¡ç†ç³»ç»Ÿçš„ä¸åŒå¯ç”¨æŠ€æœ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ£€æŸ¥ä¸€ä¸ªç†æƒ³çš„è®¾ç½®(å½“ç„¶ï¼Œåœ¨æˆ‘çœ‹æ¥ğŸ™‚)é€‚åˆå¤§å¤šæ•°ä½¿ç”¨ [conda](https://conda.io/) å’Œ[poem](https://python-poetry.org/)çš„ Python é¡¹ç›®ã€‚

*åœ¨æœ¬æ–‡ä¸­ï¼Œåº“å’ŒåŒ…è¿™ä¸¤ä¸ªè¯å¯ä»¥äº’æ¢ä½¿ç”¨ï¼Œå®ƒä»¬éƒ½æŒ‡ Python åŒ…ã€‚*

è®©æˆ‘ä»¬é¦–å…ˆåˆ—å‡ºä¸åŒçš„æŠ€æœ¯ç»„ï¼Œå¹¶å¼ºè°ƒå‡ ä¸ªå·¥å…·

1.  **ä¸€ä¸ªç¯å¢ƒç®¡ç†ç³»ç»Ÿ:**[*Virtualenv*](https://virtualenv.pypa.io/en/latest/)*ã€åº·è¾¾ç¯å¢ƒã€* [*Pipenv*](https://github.com/pypa/pipenv)
2.  **åŒ…ä¾èµ–è§£æå™¨:** *condaï¼ŒPipenvï¼Œpoem*
3.  **åŒ…åº“:** *PyPIï¼ŒAnaconda ç­‰ã€‚*

# å…³äºåŒ…å­˜å‚¨åº“çš„å¿«é€Ÿè¯´æ˜

æœ€æµè¡Œçš„ Python åŒ…å­˜å‚¨åº“æ˜¯ Python åŒ…ç´¢å¼•(PyPI)ï¼Œè¿™æ˜¯è®¸å¤š Python åº“çš„å…¬å…±å­˜å‚¨åº“ã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ`pip install package_name`ä» PyPI å®‰è£…è½¯ä»¶åŒ…ã€‚Python åº“ä¹Ÿå¯ä»¥ä½¿ç”¨ conda æ‰“åŒ…ï¼Œconda åŒ…çš„ä¸€ä¸ªæµè¡Œå®¿ä¸»æ˜¯ Anacondaã€‚æ‚¨å¯ä»¥åœ¨ conda ç¯å¢ƒä¸­è¿è¡Œ`conda install package_name`æ¥å®‰è£… conda åŒ…ã€‚

# åº·è¾¾:ç™¾äº‹é€šï¼Ÿ

Pipenv æ˜¯ä¸ºäº†è§£å†³ virtualenv çš„è®¸å¤šç¼ºç‚¹è€Œåˆ›å»ºçš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¸ä¼šå°† virtualenv å’Œ Pipenv è§†ä¸ºç¯å¢ƒç®¡ç†è€…çš„ä¸»è¦åŸå› æ˜¯:

*   æˆ‘æƒ³æœ‰å®‰è£…åº·è¾¾è½¯ä»¶åŒ…çš„çµæ´»æ€§ã€‚
*   ä¸ conda ä¸åŒï¼Œvirtualenv å’Œ Pipenv éƒ½åªæ˜¯ Python ç¯å¢ƒã€‚

æ­£å¦‚æ‚¨åœ¨ç®€ä»‹ä¸­å¯èƒ½æ³¨æ„åˆ°çš„ï¼Œconda ç®¡ç†ç¯å¢ƒã€åŒ…å’Œä¾èµ–é¡¹ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå®ƒè¿˜æ˜¯è¯­è¨€ä¸å¯çŸ¥çš„ã€‚æ­¤å¤–ï¼Œconda è¿˜å¯ä»¥åœ¨æ´»åŠ¨çš„ conda ç¯å¢ƒä¸­ä½¿ç”¨ pip æ¥å®‰è£… PyPI åŒ…ã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…ä¸€ä¸ªå…¨æ–°çš„ conda ç¯å¢ƒ

```
conda create -n env_name python=3.7
```

æ€»æ˜¯å»ºè®®æ‹¥æœ‰ä¸€ä¸ªåŒ…å«æ‚¨çš„åº“åŠå…¶ç‰¹å®šç‰ˆæœ¬çš„ç¯å¢ƒæ–‡ä»¶ã€‚ç”±äºå¯ç§»æ¤æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯å†ç°æ€§ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»æ–‡ä»¶(ä¾‹å¦‚ï¼Œä¸‹é¢çš„ environment.yaml æ–‡ä»¶)åˆ›å»º conda ç¯å¢ƒ

```
conda env create -f environment.yaml
```

ç°åœ¨ï¼Œä½ å¯èƒ½ä¼šè¯´ï¼Œå¤ªå¥½äº†ï¼Œconda ä»€ä¹ˆéƒ½åšï¼Œæ‰€ä»¥ï¼Œè®©æˆ‘ä»¬åœ¨ conda ç¯å¢ƒä¸­ä½¿ç”¨ conda åŒ…ï¼Œè®© conda è§£å†³ä»»ä½•ä¾èµ–é—®é¢˜ã€‚

# conda çš„é—®é¢˜

æˆ‘è®¤ä¸ºåº·è¾¾åšå¾—å¤ªå¤šäº†ã€‚åœ¨ä½¿ç”¨ conda å‡ å¹´åï¼Œè¿™é‡Œæ˜¯æˆ‘å¯¹ conda ä½œä¸ºä¸€ä¸ªåŒ…å’Œä¾èµ–ç®¡ç†çš„ä¸€äº›è§‚å¯Ÿ:

# æ€§èƒ½é—®é¢˜

æˆ‘å¯¹ conda çš„ä¸»è¦é—®é¢˜æ˜¯å®ƒçš„æ€§èƒ½é—®é¢˜ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒï¼Œç”šè‡³æ›´æ–°ä¸€ä¸ªæ—§çš„ç¯å¢ƒï¼Œæœ‰æ—¶å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå°¤å…¶æ˜¯å½“æ‚¨æœ‰å¾ˆå¤šåŒ…çš„æ—¶å€™ã€‚è¿™å¯èƒ½æ˜¯å› ä¸º conda è¯•å›¾è§£å†³ä¾èµ–æ€§ã€‚å¾ˆå°‘æœ‰è¶…è¿‡ 30 åˆ†é’Ÿçš„æ—¶å€™(æ˜¯çš„ï¼Œ30 åˆ†é’Ÿï¼Œä¸æ˜¯ 30 ç§’ï¼)è¥é€ ç¯å¢ƒã€‚æˆ‘æœ€åˆè®¤ä¸ºæœ‰ä¸€ä¸ªè¿æ¥é—®é¢˜æˆ–è¿æ¥åˆ°åŒ…å­˜å‚¨åº“çš„é—®é¢˜ã€‚

# ä¾èµ–å…³ç³»è§£æç¨‹åºé—®é¢˜

Conda ç”šè‡³å¯èƒ½æ— æ³•è§£å†³ä¾èµ–æ€§é—®é¢˜ã€‚ç”±äºæˆ‘ä»¬çœ‹ä¸åˆ°ç‰¹å®š conda åŒ…çš„ä¾èµ–æ€§(ä¸åƒ poem)ï¼Œè§£å†³è¿™äº›é—®é¢˜å¯èƒ½ä¸å®¹æ˜“ã€‚

# Python æ‰“åŒ…

conda çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯å½“ä½ æƒ³ä¸ºä½ çš„åº“æ„å»ºä¸€ä¸ª conda åŒ…å¹¶å‘å¸ƒå®ƒçš„æ—¶å€™ã€‚è¿™ä¸æ˜¯å°äº‹(è‡³å°‘å¯¹æˆ‘æ¥è¯´)ï¼Œå› ä¸ºä½ éœ€è¦å‡ ä¸ªé…ç½®æ–‡ä»¶(åƒ meta.ymlï¼Œsetup.pyï¼Œ*ç­‰*)ã€‚).ä½ å¯èƒ½ä¹Ÿæœ‰ä¾èµ–é—®é¢˜ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ›´å¤šå…³äºå¦‚ä½•æ„å»º conda åŒ…[çš„ä¿¡æ¯ã€‚](https://docs.conda.io/projects/conda-build/en/latest/user-guide/tutorials/build-pkgs.html)

# è¯—æ„

[è¯—è¯](https://python-poetry.org/)æ˜¯ 2018 å¹´åˆæ­¥å‘å¸ƒçš„ python æ‰“åŒ…å’Œä¾èµ–ç®¡ç†ç³»ç»Ÿã€‚å®ƒå¹³æ»‘åœ°å¤„ç†äº†ä¾èµ–æ€§ï¼Œç‰¹åˆ«æ˜¯å¦‚æœæ‚¨åœ¨ä¸€ä¸ªæ–°çš„ç¯å¢ƒä¸­ä½¿ç”¨è¯—æ­Œï¼Œç„¶åæ·»åŠ æ‚¨çš„ Python åŒ…ã€‚å®ƒè¿˜å¯ä»¥ä»¥ç¡®å®šçš„æ–¹å¼å¤„ç†é¡¹ç›®çš„å…¶ä»–å·¥å…·å’Œé…ç½®ï¼Œå› ä¸ºå®ƒä½¿ç”¨ [TOML](https://toml.io/en/) æ ¼å¼ä½œä¸º Python é…ç½®æ–‡ä»¶ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒTOML æ—¨åœ¨ä½¿ç”¨æ˜“äºé˜…è¯»çš„æœ€å°é…ç½®æ–‡ä»¶ã€‚poem ä½¿ç”¨`pyproject.toml`é…ç½®æ–‡ä»¶æ¥å®‰è£… python åŒ…å¹¶è®¾ç½®é…ç½®ã€‚

# pyproject.toml: Python é…ç½®æ–‡ä»¶

`pyproject.toml` file æ˜¯åœ¨ [PEP518](https://www.python.org/dev/peps/pep-0518/) ä¸­å®šä¹‰çš„ä¸€ä¸ªæ–°çš„ Python é…ç½®æ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨æ„å»ºç³»ç»Ÿéœ€æ±‚ã€ä¾èµ–å…³ç³»ä»¥åŠè®¸å¤šå…¶ä»–é…ç½®ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ç”šè‡³å¯ä»¥æ›¿æ¢`setup.cfg`å’Œ`setup.py`æ–‡ä»¶ã€‚æ‚¨å¯ä»¥å°†å¤§å¤šæ•°ä¸ç‰¹å®š python åŒ…ç›¸å…³çš„é…ç½®ä¿å­˜åœ¨ä¸€ä¸ª`pyproject.toml`æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚ pytestã€coverageã€bumpversionã€Black code styling ç­‰ç­‰ã€‚ä»¥å‰ï¼Œä½ è¦ä¹ˆåœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ç¼–å†™è¿™äº›é…ç½®ï¼Œè¦ä¹ˆåœ¨å…¶ä»–é…ç½®æ–‡ä»¶ä¸­ç¼–å†™ï¼Œæ¯”å¦‚`setup.cfg`ã€‚ç„¶è€Œï¼Œ`pyproject.toml`å¯ä»¥åŒ…å«æ‰€æœ‰çš„éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥åŒ…å«æ‰€æœ‰çš„é¡¹ç›®åŒ…éœ€æ±‚ã€‚

# æè®®çš„è®¾ç½®

æˆ‘æ¨èä½¿ç”¨ conda ä½œä¸ºç¯å¢ƒç®¡ç†å™¨ï¼Œpip ä½œä¸ºåŒ…å®‰è£…å™¨ï¼Œpoem ä½œä¸ºä¾èµ–ç®¡ç†å™¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥è·å¾— conda ç¯å¢ƒä¸­çš„æ‰€æœ‰ PyPI åŒ…ï¼Œåœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å®‰è£… conda åŒ…ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨è¯—æ­Œå’Œå»ºè®®è®¾ç½®çš„ä¸€äº›å¥½å¤„:

*   æ›´å¥½çš„ä¾èµ–æ€§ç®¡ç†(é€šå¸¸æ¯” conda ä¾èµ–æ€§è§£æå™¨æ›´å¿«)
*   å…·æœ‰å¤§å¤šæ•°åŒ…é…ç½®(ä¾‹å¦‚ï¼Œpytestã€coverageã€bump2versionã€*ç­‰)ã€‚*)æ’æˆä¸€åˆ—çºµé˜Ÿã€‚
*   å¿…è¦æ—¶å¯ä»¥å®‰è£… conda è½¯ä»¶åŒ…(è¿™åº”è¯¥æ˜¯ä½ æœ€åçš„é€‰æ‹©ï¼)
*   è¯—å¯ä»¥è‡ªåŠ¨æ·»åŠ æ–°çš„åŒ…åˆ°`pyproject.toml`æ–‡ä»¶ä¸­ã€‚
*   è¯—æ­Œå¯ä»¥æ˜¾ç¤ºå•ä¸ªåŒ…çš„åº“ä¾èµ–åˆ—è¡¨ã€‚
*   æ„å»º Python åŒ…å¹¶å‘å¸ƒåˆ° PyPI å°±åƒè¿è¡Œä¸¤ä¸ªå‘½ä»¤ä¸€æ ·ç®€å•ï¼
*   ç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒä¸éœ€è¦å•ç‹¬çš„ç¯å¢ƒæ–‡ä»¶ã€‚

# æ­¥éª¤ 1:åˆ›å»ºä¸€ä¸ªæœ€å°çš„ conda ç¯å¢ƒ

æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ`conda env create -f environment.yaml`ä»ä¸‹é¢çš„ YAML æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ª conda ç¯å¢ƒã€‚è¿™å°†åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰ Python 3.8 çš„å…¨æ–° conda ç¯å¢ƒã€‚åœ¨ conda ç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥ä¼ é€’ä¸€ä¸ªé€šé“åˆ—è¡¨(é¡ºåºå¾ˆé‡è¦),æ‚¨å¯ä»¥ä»è¿™äº›é€šé“ä¸­å®‰è£…æ‚¨çš„è½¯ä»¶åŒ…ã€‚é™¤äº† Anaconda Cloud ä¸Šçš„*é»˜è®¤*é€šé“(ç”± [Anaconda](https://www.anaconda.com/) Inc .ç®¡ç†)ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–å¯ä»¥å®‰è£…åŒ…çš„é€šé“ã€‚ä¸€ä¸ªå—æ¬¢è¿çš„æ¸ é“æ˜¯ [conda-forge](https://conda-forge.org/) ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªç”±ç¤¾åŒºä¸»å¯¼çš„åŒ…é›†åˆã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªç§äººçš„åº·è¾¾é¢‘é“ï¼Œä½ å¯ä»¥å†™åœ¨é¢‘é“éƒ¨åˆ†ã€‚

# ç¬¬äºŒæ­¥:å®‰è£…è¯—æ­Œå·¥å…·

ä½ å¯ä»¥æŒ‰ç…§ä»–ä»¬çš„è¯´æ˜[åœ¨è¿™é‡Œ](https://python-poetry.org/docs/#installation)å®‰è£…è¯—æ­Œã€‚å¯¹äº OSxã€Linux æˆ– WSL (Windows å­ç³»ç»Ÿ Linux)ï¼Œæ¨èçš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å®‰è£… poemã€‚

```
curl -sSL [https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py](https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py) | python -
```

æ³¨æ„:ä½¿ç”¨è‡ªå®šä¹‰å®‰è£…ç¨‹åºçš„é¦–é€‰æ–¹æ³•(ä¸‹è½½ get-poem . py è„šæœ¬çš„ç¬¬ä¸€ç§æ–¹æ³•)å®‰è£…è¯—æ­Œå°†ä¼šå®‰è£…ä¸ç³»ç»Ÿå…¶ä½™éƒ¨åˆ†éš”ç¦»çš„è¯—æ­Œã€‚

âš ï¸è™½ç„¶ä¸æ¨èï¼Œä¹Ÿæœ‰ä¸€ä¸ª pip ç‰ˆæœ¬çš„è¯—æ­Œï¼Œä½ å¯ä»¥å®‰è£…(`pip install poetry`)ã€‚å¼€å‘äººå‘˜è­¦å‘Šä¸è¦åœ¨æ–‡æ¡£ä¸­ä½¿ç”¨ pip ç‰ˆæœ¬ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šå¯¼è‡´ä¸ç¯å¢ƒä¸­çš„å…¶ä»–åŒ…å‘ç”Ÿå†²çªã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„ç¯å¢ƒåŸºæœ¬ä¸Šæ˜¯ç©ºçš„(è™½ç„¶åœ¨åˆ›å»º conda ç¯å¢ƒæ—¶æœ‰äº›åŸºç¡€åŒ…æ˜¯åƒ pip ä¸€æ ·å®‰è£…çš„)ï¼Œé‚£ä¹ˆé€šè¿‡`pip`å®‰è£…å¤§æ¦‚å°±å¯ä»¥äº†ï¼

# ç¬¬ä¸‰æ­¥:é…ç½®ä½ çš„è¯—æ­Œ

è¦ä¸ºä¸€ä¸ªæ–°é¡¹ç›®é…ç½®è¯—æ­Œï¼Œè¯—æ­Œä½¿å¾—åˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰æ‚¨æƒ³è¦çš„è®¾ç½®çš„é…ç½®æ–‡ä»¶å˜å¾—éå¸¸å®¹æ˜“ã€‚æ‚¨å¯ä»¥é€šè¿‡ç®€å•åœ°è¿è¡Œ`poetry init`æ¥äº¤äº’å¼åœ°åˆ›å»ºä¸€ä¸ª`pyproject.toml`æ–‡ä»¶ã€‚è¿™å°†æç¤ºä¸€äº›å…³äºæ‚¨æƒ³è¦å®‰è£…çš„ Python åŒ…çš„é—®é¢˜ã€‚æ‚¨å¯ä»¥æŒ‰ Enter é”®ä½¿ç”¨é»˜è®¤é€‰é¡¹è¿›è¡Œå¤„ç†ã€‚

![](img/f426b2846053a91201f2360215d4f282.png)

é€šè¿‡è¿è¡Œè¯—æ­Œåˆå§‹åŒ–è¿›è¡Œäº¤äº’å¼é…ç½®

æ­£å¦‚ä½ åœ¨ä¸Šé¢çš„æˆªå›¾ä¸­çœ‹åˆ°çš„ï¼Œä½ å¯ä»¥åªä¸ºå¼€å‘ä¾èµ–æ·»åŠ ä¸€äº›åŒ…ã€‚ä¸ºä½ çš„é¡¹ç›®åˆå§‹åŒ–è¯—æ­Œå°†ä¼šåˆ›å»ºä¸€ä¸ª`pyproject.toml`æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†æˆ‘ä»¬åœ¨è®¾ç½®è¿‡ç¨‹ä¸­å®šä¹‰çš„æ‰€æœ‰é…ç½®ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªé’ˆå¯¹æ‰€æœ‰ä¾èµ–é¡¹çš„ä¸»è¦éƒ¨åˆ†(åœ¨ç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒä¸­éƒ½ä½¿ç”¨)ï¼Œä½†æˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ªéƒ¨åˆ†åŒ…å«ä¸»è¦ç”¨äºå¼€å‘ç›®çš„çš„åŒ…ï¼Œå¦‚ pytestã€sphinxã€*ç­‰*ã€‚è¿™æ˜¯ç›¸å¯¹äºå…¶ä»–ä¾èµ–ç®¡ç†å·¥å…·çš„å¦ä¸€ä¸ªä¼˜åŠ¿ã€‚æ‚¨çš„ç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒåªéœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚

# æ­¥éª¤ 4:å®‰è£…ä¾èµ–é¡¹

ä¸€æ—¦åœ¨ä¸€ä¸ª`pyproject.toml`æ–‡ä»¶ä¸­æœ‰äº†æ‚¨çš„ä¾èµ–é¡¹å’Œå…¶ä»–é…ç½®ï¼Œæ‚¨å°±å¯ä»¥é€šè¿‡ç®€å•åœ°è¿è¡Œ

```
poetry install
```

è¿™å°†åˆ›å»ºä¸€ä¸ª`poetry.lock`æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶åŸºæœ¬ä¸ŠåŒ…å«äº†æ‰€æœ‰åŒ…çš„ç²¾ç¡®ç‰ˆæœ¬ï¼Œè¿™äº›åŒ…ç”¨é‚£äº›ç‰¹å®šçš„ç‰ˆæœ¬é”å®šäº†é¡¹ç›®ã€‚æ‚¨éœ€è¦æäº¤`pyproject.toml`æ–‡ä»¶å’Œ`poetry.lock`æ–‡ä»¶ã€‚æˆ‘å¼ºçƒˆå»ºè®®æ‚¨ä¸è¦æ‰‹åŠ¨æ›´æ–° poetry.lock æ–‡ä»¶ã€‚è®©è¯—æ­Œå‘æŒ¥å®ƒçš„é­”åŠ›å§ï¼ï¼

# è¯—æ­ŒæŠ€å·§

## æ·»åŠ æ–°åŒ…

å¦‚æœæ‚¨æƒ³åœ¨æ‚¨çš„ç¯å¢ƒä¸­æ·»åŠ (æˆ–åˆ é™¤)ä¸€ä¸ªåŒ…ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤

```
poetry add package_name
```

è¿™å°†*è‡ªåŠ¨*å°†åŒ…åå’Œç‰ˆæœ¬æ·»åŠ åˆ°æ‚¨çš„`pyproject.toml`æ–‡ä»¶ä¸­ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°`poetry.lock`ã€‚`poetry add`è´Ÿè´£æ‰€æœ‰çš„ä¾èµ–é¡¹ï¼Œå¹¶å°†åŒ…æ·»åŠ åˆ°`[tool.poetry.dependencies]`éƒ¨åˆ†ã€‚

å¦‚æœæ‚¨æƒ³å°†ä¸€ä¸ªåŒ…æ·»åŠ åˆ°æ‚¨çš„å¼€å‘ç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ä¼ é€’ä¸€ä¸ªå¦‚ä¸‹çš„`--dev`é€‰é¡¹

```
poetry add package_name --dev
```

ä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…çš„ç‰¹å®šç‰ˆæœ¬ï¼Œç”šè‡³å¯ä»¥é€šè¿‡ git+https æˆ–è€… git+ssh æ¥æ·»åŠ ä¸€ä¸ªåŒ…(æ›´å¤šç»†èŠ‚è§[æ­¤å¤„](https://python-poetry.org/docs/cli/#add))ã€‚

# ç§»é™¤åŒ…

æ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼åˆ é™¤è½¯ä»¶åŒ…

```
poetry remove package_to_remove
```

# æ˜¾ç¤ºåŒ…ä¾èµ–å…³ç³»

å¦‚æœæ‚¨æƒ³æŸ¥çœ‹ç¯å¢ƒä¸­æ‰€æœ‰å·²å®‰è£…è½¯ä»¶åŒ…çš„åˆ—è¡¨ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤

```
poetry show
```

è¯·æ³¨æ„ï¼Œè¿™ä¹Ÿå°†æ˜¾ç¤ºåŒ…çš„ä¾èµ–å…³ç³»ã€‚æœ‰æ—¶æŸ¥çœ‹ Python åŒ…çš„ä¾èµ–å…³ç³»ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚å¹¸è¿çš„æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`poetry show`æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹æˆ‘ä»¬ç¯å¢ƒä¸­çš„`requests`åŒ…çš„ä¾èµ–åˆ—è¡¨

```
poetry show requests
```

![](img/a1ed34fe2b47f0a69ddc4293b3aebf08.png)

é¡¹ç›®ä¸­è¯·æ±‚åŒ…çš„æ‰€æœ‰ä¾èµ–é¡¹

æ›´å¥½çš„æ˜¯ï¼Œæ‚¨åªéœ€è¿è¡Œ

```
poetry show --tree
```

![](img/1766eb3cbf46245781673f53cc23d1dd.png)

æ‰€æœ‰é¡¹ç›®ä¾èµ–å…³ç³»çš„æ ‘

ä»ä¸Šå›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°è“è‰²å­—ä½“çš„åŒ…å(requests å’Œ pytest)è¢«æ˜¾å¼åœ°æ·»åŠ åˆ°äº†`pyproject.toml`æ–‡ä»¶ä¸­ã€‚é»„è‰²çš„å…¶ä»–åº“æ˜¯å®ƒä»¬çš„ä¾èµ–é¡¹ï¼Œä¸éœ€è¦åœ¨ toml æ–‡ä»¶ä¸­ã€‚

æ³¨æ„:æ‚¨å¯ä»¥ä½¿ç”¨`pip freeze` ( `pip freeze > requirements.txt`å¦‚æœæ‚¨æƒ³å°†ç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­)æ¥è¾“å‡ºæ‚¨çš„ç¯å¢ƒä¸­æ‰€æœ‰å·²å®‰è£…çš„åŒ…ï¼Œä½†æ˜¯é‚£å°†ä¼šéå¸¸æ··ä¹±ã€‚

# ç»“è®º

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä¸åŒçš„ Python ç¯å¢ƒã€åŒ…ç®¡ç†å’Œä¾èµ–è§£æå·¥å…·ã€‚ç„¶åï¼Œæˆ‘ä»¬å›é¡¾äº†å¦‚ä½•ä½¿ç”¨ conda ä½œä¸ºç¯å¢ƒç®¡ç†å™¨å’Œ poem ä½œä¸ºåŒ…ç®¡ç†å™¨å’Œä¾èµ–è§£æå™¨çš„è®¾ç½®ï¼Œä»¥åŠåœ¨ Python é¡¹ç›®ä¸­ä½¿ç”¨è¿™ç§ç»„åˆçš„å¥½å¤„ã€‚

å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ã€‚

æ„Ÿè°¢é˜…è¯»ï¼

[***è®¢é˜…æˆ‘çš„é‚®ä»¶åˆ—è¡¨***](https://www.ealizadeh.com/subscribe/)**å¦‚æœä½ å–œæ¬¢è¿™ä¸ªå¸–å­ã€‚æˆ‘å–œæ¬¢å†™å…³äºæ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ ã€ç»Ÿè®¡å­¦ä»¥åŠæœ‰è¶£çš„ Python åº“å’ŒæŠ€å·§çš„æ–‡ç« ã€‚ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘ä¸Š* [*ä¸­*](https://medium.com/@ealizadeh) *ï¼Œ* [*é¢†è‹±*](https://www.linkedin.com/in/alizadehesmaeil/) *ï¼Œæˆ–è€…* [*æ¨ç‰¹*](https://twitter.com/es_alizadeh) *ã€‚**

# *æœ‰ç”¨çš„é“¾æ¥*

 *[## ç®€ä»‹|æ–‡æ¡£|è¯—æ­Œâ€”â€”Python ä¾èµ–ç®¡ç†å’Œæ‰“åŒ…å˜å¾—ç®€å•ã€‚

### è¯—æ­Œæ˜¯ Python ä¸­è¿›è¡Œä¾èµ–ç®¡ç†å’Œæ‰“åŒ…çš„å·¥å…·ã€‚å®ƒå…è®¸æ‚¨å°†åº“å£°æ˜ä¸ºæ‚¨çš„é¡¹ç›®â€¦

python-poetry.org](https://python-poetry.org/docs/)* *[](https://github.com/carlosperate/awesome-pyproject) [## carlosperate/awesome-pyproject

### pyproject.toml æ˜¯ PEP 518 ä¸­å®šä¹‰çš„ä¸€ä¸ªæ–°çš„é…ç½®æ–‡ä»¶ã€‚å®ƒæ˜¯ä¸ºå­˜å‚¨æ„å»ºç³»ç»Ÿéœ€æ±‚è€Œè®¾è®¡çš„ï¼Œä½†æ˜¯å®ƒâ€¦

github.com](https://github.com/carlosperate/awesome-pyproject) [](/a-guide-to-conda-environments-bc6180fc533) [## åº·è¾¾ç¯å¢ƒæƒå¨æŒ‡å—

### å¦‚ä½•ä½¿ç”¨ conda for Python & R ç®¡ç†ç¯å¢ƒ

towardsdatascience.com](/a-guide-to-conda-environments-bc6180fc533) [](https://ahmed-nafies.medium.com/pip-pipenv-poetry-or-conda-7d2398adbac9) [## Pipï¼ŒPipenvï¼Œè¯—æ­Œæˆ–åº·è¾¾

### 2020 å¹´ç”¨å“ªä¸ª python åŒ…ç®¡ç†å™¨ï¼Ÿpip çš„æ›¿ä»£æ–¹æ¡ˆã€‚

ahmed-nafies.medium.com](https://ahmed-nafies.medium.com/pip-pipenv-poetry-or-conda-7d2398adbac9) 

*åŸè½½äº*[*https://www.ealizadeh.com*](https://www.ealizadeh.com/blog/guide-to-python-env-pkg-dependency-using-conda-poetry/)*ã€‚**