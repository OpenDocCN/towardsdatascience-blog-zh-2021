# 甘沃——抽象修复

> 原文：<https://towardsdatascience.com/gan-vogh-abstract-inpainting-63ab5da53b89?source=collection_archive---------39----------------------->

![](img/a32077494b4911570f2aa91174464838.png)

图 1:左:[约翰·克莱伯格](https://www.wikiart.org/de/albrecht-durer/bildnis-johann-kleeberger-1526)(阿尔布雷特·丢勒)的肖像——右:作者的图片。时尚数据培训网络。

## 人工艺术合成

I npainting 是一种根据原始内容以逼真的方式填充缺失像素来重建不完整图像的方法。目前，这个问题通常用深度卷积神经网络来解决。一种常见的解决方案是利用两种鉴别器架构来实现全局和局部一致性。全局鉴别器查看发生器的全部输出，局部鉴别器仅查看丢失像素的区域。

但是我们能做的不仅仅是猜测原文内容吗？为了生成艺术上有趣的图像，我们希望修复比原来更多的细节和抽象特征。虽然内容和风格确实可以完全不同，但是新生成的补丁和它周围的上下文之间的过渡仍然应该是平滑的。

![](img/79527816f9eece2965ad35e30df3b879.png)

图二。图片作者。

在这个实验中，我只使用正方形(瓷砖)作为随机放置在图像中的缺失区域。通常，学习修补和现有内容之间的平滑过渡可以通过空间折扣遮罩来实现。通过使用合适的损失函数，例如 L1 范数，比较屏蔽的输出和屏蔽的背景真相，屏蔽仅约束丢失面片边界处的像素。

接下来，我们看一下内容表示。我们的生成器架构应该生成与原始内容不完全匹配的内容。事实上，排除全局鉴别器正是我们想要的解决方案。在大多数情况下，本地鉴别器本身就足以为发生器提供有意义的梯度。令人惊讶的是，在剪贴画和卡通等非常简单的情况下，本地鉴别器会指导生成器重建逼真的图像补丁。

![](img/ee2a8591ad7a29e1c4bbc94a90098f58.png)

图 3:左:[站着的男性形象](https://www.wikiart.org/de/edward-wadsworth/male-figure-standing-1911)(爱德华·沃兹沃斯)——右:作者图片。网络训练分形和重复艺术。

这一想法是由于与大规模图像合成相关的过高计算要求而产生的。在我的实验中，每个数据集包含大约 2000 张 512x512 像素的图像，图像块大小为 256x256 像素。我在一个 8GB 的混合精度 GPU 上对每个数据集进行了大约 4 天的训练。

一般来说，没有全局鉴别器，该体系结构需要较少的资源。GANs 适用于小图像，因此简单的架构就足够了。此外，随机改变输入图像中的瓦片位置对应于数据扩充过程，允许小得多的数据集足以用于训练。

**推论**

与机器学习中的最佳实践相反，用训练数据生成抽象图像会导致最有趣和一致的结果。应用到完全不同的图像内容仍然有效，但是，每个图块的边界在最终结果中可能是可见的(图 3)。

![](img/1e00f9d95ae05a5c6f6df76c6c23e805.png)

图 4。作者图片

在推理时，我的脚本从左上角开始递归地修补所有的瓷砖。为了给生成器提供所需的上下文，从整个图像中裁剪出一个较大的正方形部分，如果图块与图像边界相邻，则使用反射填充进行扩展。在处理下一个补丁之前，新创建的补丁将被插入到图像中。

![](img/0fe1257ba78d9ec070c175b39f2febe3.png)

图 3:左:[柏树和两个女人](https://commons.wikimedia.org/wiki/File:Van_Gogh_-_Zypressen_und_zwei_Frauen.jpeg)(文森特·梵高)——右:作者的图片。网络培训海绵宝宝。

独立于训练数据，全局内容仍然在输出图像中表示。适合图像的补丁越多，单个补丁覆盖的信息就越少，从而可以重建更多的内容。细节被训练集的风格和内容所取代。

如果网络训练得不够好，或者输入图像远离训练域，则输出会变得非常嘈杂，图像上可能会出现补片边界。在某些情况下，网络会产生高度冗余的模式，类似于模式崩溃。

总之，我已经证明了抽象修复可以使用有限的资源产生具有精细细节的大型艺术品。它构成了一个有趣的和娱乐性的方法，应该进一步探讨！

![](img/936a38ae736a8463f138fcc8dcc06cf8.png)

图 4:谁住在海底的菠萝里？图片作者。