# PyMC3 ä¸­çš„è´å¶æ–¯ A/B æµ‹è¯•

> åŸæ–‡ï¼š<https://towardsdatascience.com/bayesian-a-b-testing-in-pymc3-54dceb87af74?source=collection_archive---------5----------------------->

## [è´å¶æ–¯ç»Ÿè®¡](https://medium.com/tag/bayesian-statistics)

## æŠ›å¼ƒ p å€¼ï¼Œæ‹¥æŠ±æ›´ç›´è§‚çš„æ¦‚ç‡

![](img/1ec847ad4abd56bb2fa00c10543ea094.png)

ç”± [OpticalNomad](https://unsplash.com/@opticalnomad?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

æœ‰æ—¶ï¼Œä½ ä¸å¾—ä¸åœ¨ä¸¤ä¸ªé€‰é¡¹ä¸­åšå‡ºé€‰æ‹©ã€‚è¿™å¯èƒ½æ˜¯åœ¨å®Œå…¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œä½ åªæœ‰ 50%çš„å¯èƒ½æ€§åšå‡ºæ›´å¥½çš„é€‰æ‹©ã€‚åœ¨ä¸€äº›ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œä½ ç”šè‡³å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„æŠ€å·§æ¥æé«˜è¿™ä¸ªæ¦‚ç‡ï¼Œæ­£å¦‚æˆ‘åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­æ‰€å±•ç¤ºçš„ã€‚

ç„¶è€Œï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä½ èƒ½å¤Ÿ**æ”¶é›†ä¸€äº›ä¿¡æ¯**å¸®åŠ©ä½ é€‰æ‹©æ›´å¥½çš„é€‰é¡¹ã€‚ä¸€ä¸ªç®€å•è€Œèªæ˜çš„æ–¹æ³•æ˜¯ *A/B æµ‹è¯•*ï¼Œä½ å¯èƒ½å·²ç»å¬è¯´è¿‡æˆ–è€…å·²ç»ä½¿ç”¨è¿‡äº†ã€‚

![](img/b27702e7e084ac01945dbbda4eab6534.png)

ä¸¤ä¸ªå®éªŒçš„ç»“æœã€‚æ˜¯ A è¿˜æ˜¯ B äº§ç”Ÿçš„ä»·å€¼æ›´é«˜ï¼Ÿä½ å¯¹æ­¤æœ‰å¤šç¡®å®šï¼Ÿå›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ç®€è¦è§£é‡Š A/B æµ‹è¯•èƒŒåçš„åŠ¨æœºï¼Œå¹¶æ¦‚è¿°å…¶èƒŒåçš„é€»è¾‘ã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜åœ¨äºå®ƒä½¿ç”¨äº†å®¹æ˜“è¢«è¯¯è§£çš„ p å€¼ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å°†èŠ±æ—¶é—´ç”¨å°‘è®¸*è´å¶æ–¯*é­”æ³•æ¥æ”¹è¿›è¿™ç§æ–¹æ³•ï¼Œäº§ç”Ÿ**è´å¶æ–¯ A/B æµ‹è¯•**ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Python ä¸­å‡ºè‰²çš„ PyMC3 åº“å®ç°ä¸€ä¸ªç®€å•çš„è´å¶æ–¯ A/B æµ‹è¯•ã€‚

> å¦‚æœæ‚¨ä¸å®Œå…¨ç¡®å®šä»€ä¹ˆæ˜¯è´å¶æ–¯ç»Ÿè®¡ï¼Œæˆ–è€…æ‚¨ä»¥å‰ä»æœªä½¿ç”¨è¿‡ PyMC3ï¼Œè¯·æŸ¥çœ‹æˆ‘å…³äºè¿™ä¸ªä¸»é¢˜çš„å…¥é—¨çº§æ–‡ç« :

[](/a-gentle-introduction-to-bayesian-inference-6a7552e313cb) [## è´å¶æ–¯æ¨ç†çš„ç®€æ˜ä»‹ç»

### äº†è§£é¢‘ç‡ä¸»ä¹‰è€…å’Œè´å¶æ–¯æ¨ç†æ–¹æ³•ä¹‹é—´çš„åŒºåˆ«

towardsdatascience.com](/a-gentle-introduction-to-bayesian-inference-6a7552e313cb) [](/conducting-bayesian-inference-in-python-using-pymc3-d407f8d934a5) [## ä½¿ç”¨ PyMC3 åœ¨ Python ä¸­è¿›è¡Œè´å¶æ–¯æ¨ç†

### é‡æ¸©ç¡¬å¸çš„ä¾‹å­ï¼Œå¹¶ä½¿ç”¨ PyMC3 è®¡ç®—è§£å†³å®ƒã€‚

towardsdatascience.com](/conducting-bayesian-inference-in-python-using-pymc3-d407f8d934a5) 

# A/B æµ‹è¯•åŠ¨æœº

å‡è®¾æ‚¨ç»è¥ç€ä¸€å®¶ç›¸å½“æˆåŠŸçš„åœ¨çº¿å•†åº—ï¼Œæ¯å¤©æœ‰å¤§çº¦ 10ï¼Œ000 åè®¿é—®è€…ã€‚è¿™ 10000 äººä¸­å¤§çº¦æœ‰ 100 äººå®é™…ä¸Šåœ¨ä½ çš„åº—é‡Œä¹°äº†ä¸œè¥¿â€”â€”ä½ æ‰€è°“çš„*è½¬åŒ–ç‡*å¤§çº¦æ˜¯ 100/10000 = 1%ï¼Œç›¸å½“å°ã€‚

> å¤§å¤šæ•°ç½‘ä¸Šå•†åº—çš„è½¬åŒ–ç‡åœ¨ 1-3%å·¦å³ï¼Œäºšé©¬é€Šç”šè‡³è¶…è¿‡ 10%ã€‚

å› ä¸ºæ— è®ºå¦‚ä½•éƒ½ä¼šæœ‰å¾ˆå¤šäººå…‰é¡¾ä½ çš„åº—é“ºï¼Œä½†åªæœ‰å¾ˆå°‘ä¸€éƒ¨åˆ†äººæˆä¸ºé¡¾å®¢ï¼Œæ‰€ä»¥ä½ å†³å®šæé«˜ä½ çš„åº—é“ºçš„è½¬åŒ–ç‡ï¼Œå› ä¸ºè¿™æ˜¯æé«˜æ”¶å…¥çš„æœ€å¤§æ æ†ã€‚ä½ è®¤ä¸º:

> æ˜¯ä»€ä¹ˆè®©äººä»¬ä¸ä¹°æˆ‘çš„å¥½äº§å“ï¼Ÿ

ä½ æƒ³ä¸å‡ºä¸€ä¸ªå¥½çš„è§£é‡Šï¼Œæ‰€ä»¥ä½ å‘ä¸€äº›æœ‹å‹å¯»æ±‚çµæ„Ÿã€‚ä»–ä»¬å‘Šè¯‰ä½ ï¼Œä»–ä»¬ä¸å–œæ¬¢ä½ è´­ä¹°æŒ‰é’®çš„è“è‰²ã€‚ä¹Ÿè®¸çº¢è‰²ä¼šæ›´å¸å¼•äººï¼Ÿè¿™æ˜¯ä½ å¯ä»¥æµ‹è¯•çš„ä¸œè¥¿ï¼

![](img/fb0f2418ca80cbad392512f052675417.png)

è®©æˆ˜æ–—å¼€å§‹å§ï¼å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æ–¹æ³•å¦‚ä¸‹:

> ä»¥ 50%çš„æ¦‚ç‡éšæœºå°†æ–°è®¿å®¢åˆ†é…åˆ°è“é˜Ÿæˆ–çº¢é˜Ÿã€‚è“é˜Ÿçš„äººä¼šçœ‹åˆ°è“è‰²æŒ‰é’®ï¼Œçº¢é˜Ÿä¼šçœ‹åˆ°çº¢è‰²æŒ‰é’®ã€‚åœ¨è¿è¡Œè¿™ä¸ªè¿‡ç¨‹ä¸€æ®µæ—¶é—´åï¼Œæ‚¨æ£€æŸ¥å“ªä¸ªå›¢é˜Ÿå®ç°äº†æ›´é«˜çš„è½¬åŒ–ç‡ã€‚

> *æœ¯è¯­:*ä½ ç§°è“é˜Ÿ**å¯¹ç…§ç»„**ï¼Œçº¢é˜Ÿ**æ²»ç–—ç»„æˆ–è¯•éªŒç»„**ã€‚å¯¹ç…§ç»„ç»™ä½ ä¸€ä¸ªæŒ‡ç¤ºï¼Œå¦‚æœä½ è®©ä¸€åˆ‡ä¿æŒåŸæ ·ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œæ²»ç–—ç»„å‘Šè¯‰ä½ å¦‚æœä½ åšæŸç§å¹²é¢„ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œæ¯”å¦‚æ”¹å˜æŒ‰é’®çš„é¢œè‰²ã€‚

è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨æƒ³è½»æ¾è¯„ä¼°å®éªŒï¼Œè¿™ç§éšæœºåŒ–å¾ˆé‡è¦ã€‚ä½ åº”è¯¥**è€Œä¸æ˜¯**åšçš„äº‹æƒ…åŒ…æ‹¬:

*   **å°†æ‰€æœ‰ç”·æ€§åˆ†é…åˆ°çº¢è‰²å›¢é˜Ÿï¼Œå°†æ‰€æœ‰å¥³æ€§åˆ†é…åˆ°è“è‰²å›¢é˜Ÿ**ï¼Œå› ä¸ºå³ä½¿ä¸€ä¸ªå›¢é˜Ÿçš„è½¬åŒ–ç‡é«˜å¾—å¤šï¼Œä½ ä¹Ÿæ— æ³•çŸ¥é“è¿™æ˜¯å› ä¸ºæŒ‰é’®çš„é¢œè‰²è¿˜æ˜¯ä»…ä»…å› ä¸ºæ€§åˆ«ã€‚
*   **æœ¬å‘¨å°†æ¯ä¸ªäººåˆ†é…åˆ°çº¢è‰²å›¢é˜Ÿï¼Œä¸‹å‘¨åˆ†é…åˆ°è“è‰²å›¢é˜Ÿ**ï¼Œå› ä¸ºå³ä½¿ä¸€ä¸ªå›¢é˜Ÿçš„è½¬æ¢ç‡å¾ˆé«˜ï¼Œä½ ä¹Ÿæ— æ³•çŸ¥é“è¿™æ˜¯å› ä¸ºæŒ‰é’®çš„é¢œè‰²ï¼Œè¿˜æ˜¯å› ä¸ºäººä»¬åœ¨ä¸€å‘¨å†…è´­ä¹°äº†æ›´å¤šçš„ä¸œè¥¿ï¼Œè€Œä¸è€ƒè™‘é¢œè‰²ã€‚ä¹Ÿè®¸å…¶ä¸­ä¸€å‘¨åŒ…æ‹¬åƒé»‘è‰²æ˜ŸæœŸäº”æˆ–åœ£è¯èŠ‚è¿™æ ·çš„èŠ‚æ—¥ï¼Œæˆ–è€…å…¶ä»–æ›´å¾®å¦™çš„å­£èŠ‚æ¨¡å¼ã€‚
*   â€¦

ä½ æ˜ç™½äº†ã€‚ä¸ºäº†æå–**æŒ‰é’®é¢œè‰²æ•ˆæœ** *ï¼Œ*åº”è¯¥æ²¡æœ‰å…¶ä»–**æ··æ·†**æ•ˆæœå¯ä»¥è§£é‡Šä¸¤ä¸ªå›¢é˜Ÿçš„ä¸åŒè½¬æ¢ç‡ã€‚

# å‡†å¤‡ A/B æµ‹è¯•

è®©æˆ‘ä»¬å‡è®¾æ‚¨ä¸ºæ‚¨çš„ A/B æµ‹è¯•è¿›è¡Œäº†ä¸€å¤©çš„é€‚å½“çš„æ•°æ®æ”¶é›†ï¼Œå¹¶æœ€ç»ˆè·å¾—äº†ä¸€äº›æ•°æ®ã€‚ä½ æœ‰ 10ï¼Œ000 åè®¿å®¢ï¼Œä½ å°†ä»–ä»¬éšæœºåˆ†ä¸ºè“é˜Ÿ(å¯¹ç…§ç»„)å’Œçº¢é˜Ÿ(æ²»ç–—ç»„)ã€‚ä½ è®°ä¸‹è¿™ä½æ¸¸å®¢æ˜¯å¦ä¹°äº†ä¸œè¥¿(ç¼–ç ä¸º **1** )æˆ–æ²¡æœ‰ä¹°(ç¼–ç ä¸º **0** )ã€‚

æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¨¡æ‹Ÿç»“æœ:

```
import numpy as np

np.random.seed(0)

blue_conversions = np.random.binomial(1, 0.01, size=4800)
red_conversions = np.random.binomial(1, 0.012, size=5200)
```

ä½ å¯ä»¥çœ‹åˆ°æˆ‘æŠŠ 1%ä½œä¸ºå¯¹ç…§ç»„è½¬åŒ–ç‡ï¼Œ1.2%ä½œä¸ºæ²»ç–—ç»„è½¬åŒ–ç‡ã€‚**æ‰€ä»¥ä½ å·²ç»çŸ¥é“ï¼Œå¦‚æœé‡‡æ ·æ²¡æœ‰åšä»€ä¹ˆå¥‡æ€ªçš„äº‹æƒ…ï¼Œçº¢è‰²æŒ‰é’®åº”è¯¥è¡¨ç°å¾—æ›´å¥½**ï¼ä½†è®©æˆ‘ä»¬ä»ç°åœ¨å¼€å§‹å‡è£…æˆ‘ä»¬ä¸çŸ¥é“è¿™äº›æ•°æ®æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬åœ¨ç°å®ä¸­ç»å¸¸é¢ä¸´çš„é—®é¢˜ã€‚

> å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œè¿™äº›ç»„æœ‰ä¸åŒçš„å¤§å°ï¼Œè¿™é€šå¸¸æ˜¯éšæœºåˆ†é…çš„ç»“æœã€‚ä»–ä»¬åœ¨ 10000/2 = 5000 å·¦å³ï¼Œä½†ä¸å¤ªå¯èƒ½å¾—åˆ°å¦‚æ­¤å®Œç¾çš„ 50:50 åˆ†æˆã€‚ç„¶è€Œï¼Œè¿™å¾ˆå¥½ã€‚

ä¸¤ä¸ª NumPy æ•°ç»„éƒ½ç”± 1 å’Œ 0 ç»„æˆï¼Œå¤§å¤šæ•°æ¡ç›®éƒ½æ˜¯ 0ã€‚

```
print(blue_conversions)
# output: [0 0 0 ... 0 0 0]
```

```
print(red_conversions)
# output: [0 0 0 ... 0 0 0]
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥çš„æ˜¯ one(å³è´­ä¹°äº†æŸäº›ä¸œè¥¿çš„è®¿é—®è€…)çš„ä»½é¢ã€‚

```
print(f'Blue: {blue_conversions.mean():.3%}')
print(f'Red: {red_conversions.mean():.3%}')
# output: Blue: 0.854%, Red: 1.135%
```

è¿™è¡¨æ˜çº¢è‰²æŒ‰é’®çš„æ€§èƒ½å¯èƒ½ä¼šæ›´å¥½ï¼Œä½†æˆ‘ä»¬ç°åœ¨è¿˜ä¸èƒ½ç¡®å®šã€‚å³ä½¿ä¸åŒç»„ä¹‹é—´çš„è½¬åŒ–ç‡å®Œå…¨ç›¸åŒï¼Œä¸€ç»„æœ€ç»ˆçš„è½¬åŒ–ç‡ä¹Ÿå¾ˆå¯èƒ½æ¯”å¦ä¸€ç»„é«˜ã€‚

æˆ‘ä»¬ä»ç„¶å¿…é¡»æ’é™¤è¿™ä»…ä»…æ˜¯ç”±äºå¶ç„¶è€Œå‘ç”Ÿçš„ï¼Œè¿™æ­£æ˜¯ A/B æµ‹è¯•çš„ç›®çš„ã€‚

# è¿›è¡Œ A/B æµ‹è¯•

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•èƒ½å¯¹æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…æå‡ºä¸€ä¸ªæ›´å¥½çš„è§£é‡Šã€‚è“è‰²æŒ‰é’®å¥½è¿˜æ˜¯çº¢è‰²æŒ‰é’®å¥½ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬å°†å†ç°ä¼ ç»Ÿçš„æ–¹å¼ï¼Œç„¶åï¼Œæˆ‘ä»¬å°†åšè´å¶æ–¯é£æ ¼ã€‚

## ä¼ ç»Ÿçš„æ–¹å¼

æˆ‘ä¸ä¼šåœ¨è¿™é‡Œæ·±å…¥æ¢è®¨ï¼Œå› ä¸ºæœ‰å¤§é‡çš„èµ„æºå¯ä»¥å®Œç¾åœ°è§£é‡Šå¦‚ä½•è¿›è¡Œä¸€ä¸ªæ™®é€šçš„ A/B æµ‹è¯•ã€‚ä½ æƒ³çŸ¥é“ä»¥ä¸‹ä¸¤ä¸ªå‡è®¾å“ªä¸ªæ˜¯æ­£ç¡®çš„:

![](img/d42aa9d64a3ddfe20388d9159dd99137.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

åŸºæœ¬ä¸Šï¼Œä½ è®¡ç®—æŸç§æµ‹è¯•ç»Ÿè®¡ï¼Œä¾‹å¦‚åœ¨è´¹å¸Œå°”ç²¾ç¡®æµ‹è¯•æˆ– T2 éŸ¦å°”å¥‡çš„ t-æµ‹è¯•ä¸­ã€‚ç„¶åè®¡ç®—ä¸€ä¸ª p å€¼ï¼Œå¹¶æ£€æŸ¥å®ƒæ˜¯å¦åœ¨æŸä¸ªä»»æ„èŒƒå›´å†…ï¼Œæ¯”å¦‚ 5%ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹**éŸ¦å°”å¥‡çš„** **t æµ‹è¯•**ã€‚

```
from scipy.stats import ttest_ind

print(f'p-value: {ttest_ind(blue_conversions, red_conversions, equal_var=False, alternative="less").pvalue:.1%}')
# output: p-value: 7.8%
```

å› ä¸ºæœ‰äº›äººçº ç»“äº p å€¼ï¼Œä½ å¯ä»¥è¿™æ ·è§£è¯»:

> å‡è®¾â‚€æ˜¯çœŸå®çš„ï¼Œæˆ‘ä»¬å¾—åˆ°æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„æˆ–è€…æ›´æç«¯çš„ç»“æœçš„å‡ ç‡æœ€å¤šæ˜¯ 7.8%ã€‚

ç”±äº 7.8% > 5%ï¼Œæˆ‘ä»¬ä¿æŒåŸå‡è®¾ã€‚æ²¡æœ‰è¯æ®è¡¨æ˜çº¢è‰²æŒ‰é’®æ˜æ˜¾æ¯”è“è‰²æŒ‰é’®å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬åªä¿ç•™è“è‰²æŒ‰é’®ã€‚

æˆ‘è®¤ä¸º p å€¼çš„å®šä¹‰ç›¸å½“ä¸ç›´è§‚â€”â€”æ¯ä¸ªæ›²è§£è¿‡ p å€¼çš„äººéƒ½è¯æ˜äº†è¿™ä¸€ç‚¹ã€‚æœ€å¸¸è§çš„**è¯¯è§£**å¦‚ä¸‹:

> è“è‰²æ›´å¥½çš„æ¦‚ç‡æ˜¯ 7.8%ã€‚(é”™ï¼ï¼ï¼)

è™½ç„¶è¿™æ˜¯ p å€¼å‘Šè¯‰ä½ çš„**è€Œä¸æ˜¯**ï¼Œä½†æ˜¯èƒ½å¤Ÿè¡¨è¾¾å‡ºè¿™æ ·ä¸€ä¸ªæ¸…æ™°è€Œç®€çŸ­çš„é™ˆè¿°æ˜¯å¯å–çš„ï¼Œä¸æ˜¯å—ï¼Ÿå¥½å§ï¼Œé‚£ä¹ˆï¼Œè´æ°æ‹¯æ•‘ã€‚

## è´å¶æ–¯æ–¹æ³•

è´å¶æ–¯ A/B æµ‹è¯•æœ‰ä»¥ä¸‹ä¼˜ç‚¹:

1.  å®ƒä½¿æ‚¨èƒ½å¤Ÿä»¥ä¸€å®šçš„æ¦‚ç‡åšå‡ºä¸€ä¸ªç‰ˆæœ¬æ¯”å¦ä¸€ä¸ªç‰ˆæœ¬æ›´å¥½çš„é™ˆè¿°ã€‚æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚
2.  ä½ ä¸éœ€è¦çŸ¥é“æ‰€æœ‰çš„ç»Ÿè®¡æµ‹è¯•ã€‚æ‚¨åªéœ€æ„å»ºä¸€ä¸ªåˆé€‚çš„ç”Ÿæˆæ¨¡å‹ï¼Œç„¶åæŒ‰ä¸‹è´å¶æ–¯æ¨ç†æŒ‰é’®ã€‚

> æˆ‘å‡è®¾ä½ ç°åœ¨å·²ç»æœ‰ä¸€äº›å…³äºä½¿ç”¨ PyMC3 çš„å…ˆéªŒçŸ¥è¯†ï¼Œå¦åˆ™ï¼Œæ£€æŸ¥æˆ‘ä¸Šé¢çš„é“¾æ¥æ–‡ç« ã€‚

ä¸ºäº†æ›´æ¸…æ¥šåœ°è¯´æ˜è¿™äº›ä¼˜ç‚¹ï¼Œè®©æˆ‘ä»¬å€ŸåŠ© PyMC3 ç”¨è´å¶æ–¯æ–¹æ³•æ¥åˆ†ææˆ‘ä»¬çš„é—®é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘è¦æ¨æ–­å“ªäº›å‚æ•°ã€‚è¿™å¾ˆå®¹æ˜“ï¼Œæœ‰ä¸¤ä¸ªæœªçŸ¥å‚æ•°:

*   è“è‰²æŒ‰é’®çš„è½¬æ¢ç‡
*   çº¢è‰²æŒ‰é’®çš„è½¬æ¢ç‡ã€‚

æˆ‘ä»¬ç°åœ¨éœ€è¦å†³å®šä¸¤ä¸ªå‚æ•°çš„å…ˆéªŒåˆ†å¸ƒã€‚ç”±äºè½¬æ¢ç‡å¯ä»¥åœ¨ 0 åˆ° 1 ä¹‹é—´ï¼Œæ‰€ä»¥[è´å¡”åˆ†å¸ƒ](https://en.wikipedia.org/wiki/Beta_distribution)æ˜¯æœ‰æ„ä¹‰çš„ã€‚Beta åˆ†å¸ƒæœ‰ä¸¤ä¸ªå‚æ•° *a* å’Œ *bï¼Œ*ï¼Œä½ å¯ä»¥é€šè¿‡æ”¹å˜å®ƒä»¬æ¥åˆ›å»ºä¸åŒçš„åˆ†å¸ƒã€‚

![](img/026c57f7cb48415d0c6a03b9727d44ea.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å› ä¸ºæˆ‘ä»¬çŸ¥é“è½¬æ¢ç‡ç›¸å½“å°ï¼Œä¾‹å¦‚ï¼Œä¸¤è€…çš„è‰¯å¥½å…ˆéªŒéƒ½æ˜¯Î²(1ï¼Œ99)ã€‚

![](img/16869ed9bd1b09d0c3fd777bf0b92ced.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å¿…é¡»æ¨¡æ‹Ÿæˆ‘ä»¬è§‚å¯Ÿåˆ°çš„ç»“æœ(åŒ…å« 0 å’Œ 1 çš„æ•°ç»„)æ˜¯å¦‚ä½•ä¸è¿™äº›å‚æ•°è”ç³»èµ·æ¥çš„ã€‚æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä½¿ç”¨[ä¼¯åŠªåˆ©å˜é‡](https://en.wikipedia.org/wiki/Bernoulli_distribution)ï¼Œå› ä¸ºå®ƒä»¬åªèƒ½å–å€¼ 0 å’Œ 1ï¼Œå¹¶ä½¿ç”¨å•ä¸ªæ¦‚ç‡å‚æ•°ã€‚

é•¿è¯çŸ­è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸‹é¢çš„å°ç¨‹åº:

```
import pymc3 as pm

with pm.Model():
    blue_rate = pm.Beta('blue_rate', 1, 99)
    red_rate = pm.Beta('red_rate', 1, 99)

    blue_obs = pm.Bernoulli('blue_obs', blue_rate, observed=blue_conversions)
    red_obs = pm.Bernoulli('red_obs', red_rate, observed=red_conversions)

    trace = pm.sample(return_inferencedata=True)
```

åŠ ä¸Šè§£é‡Šï¼Œè¿™ä¸ªç¨‹åºåº”è¯¥å¯¹ä½ æœ‰æ„ä¹‰ã€‚åœ¨æ¨¡å‹çš„å‰ä¸¤è¡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†å…ˆéªŒçŸ¥è¯†ã€‚ä¹‹åï¼Œæˆ‘ä»¬è®¾è®¡æ¨¡å‹çš„è¾“å‡º(ä¼¯åŠªåˆ©å˜é‡),å¹¶ä½¿ç”¨`observed`å‚æ•°é¢å¤–ç»™å‡ºæ¥è‡ª A/B æµ‹è¯•å‡†å¤‡çš„è§‚å¯Ÿç»“æœã€‚æœ€åä¸€è¡Œæ˜¯è‘—åçš„è´å¶æ–¯æ¨ç†æŒ‰é’®çš„ PyMC3 ç‰ˆæœ¬ã€‚

åœ¨`trace`å¯¹è±¡çš„å¸®åŠ©ä¸‹ï¼Œä½ å¯ä»¥é‡å»ºè½¬æ¢ç‡çš„åéªŒåˆ†å¸ƒã€‚

```
import arviz as az

az.plot_posterior(trace)
```

![](img/69825930362dfddb0a84148cb552c3ee.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æˆ‘ä»¬å‘ç°ï¼Œè“è‰²çš„è½¬åŒ–ç‡çº¦ä¸º 0.854%ï¼Œçº¢è‰²çš„è½¬åŒ–ç‡çº¦ä¸º 1.135%ï¼Œè¿™ä¸æˆ‘ä»¬çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡å€¼éå¸¸æ¥è¿‘ï¼Œç”šè‡³è¿˜æœ‰ä¸€ä¸ªå¯ä¿¡çš„ä¼°è®¡åŒºé—´ã€‚æ¯”å¦‚è“ç‡åœ¨ 0.62%åˆ° 1.1%ä¹‹é—´ï¼Œæœ‰ 94%çš„æ¦‚ç‡ã€‚

æ•´æ´ï¼Œå¯¹ä¸å¯¹ï¼Ÿä½†è¿™å¹¶æ²¡æœ‰å›ç­”æˆ‘ä»¬çš„é—®é¢˜ã€‚çº¢è‰²æŒ‰é’®çš„è½¬åŒ–ç‡æ¯”è“è‰²æŒ‰é’®çš„è½¬åŒ–ç‡é«˜çš„æ¦‚ç‡æœ‰å¤šå¤§ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸¤ä¸ªåéªŒåˆ†å¸ƒè¿›è¡Œé‡‡æ ·ï¼Œçœ‹çœ‹çº¢è‰²æ¯”ç‡é«˜äºè“è‰²æ¯”ç‡çš„é¢‘ç‡ã€‚å¹¸è¿çš„æ˜¯ï¼Œæ ·æœ¬å·²ç»å­˜å‚¨åœ¨`trace`å¯¹è±¡ä¸­ã€‚æˆ‘ä»¬åªéœ€äº†è§£çº¢è‰²é€Ÿç‡æ ·æœ¬æ¯”è“è‰²é€Ÿç‡æ ·æœ¬å¤§çš„é¢‘ç‡ã€‚

```
blue_rate_samples = trace.posterior['blue_rate'].values
red_rate_samples = trace.posterior['red_rate'].values

print(f'Probability that red is better: {(red_rate_samples > blue_rate_samples).mean():.1%}.')

# Output (for me):
# Probability that red is better: 91.7%.
```

è¿™æ˜¯æˆ‘ä»¬å¯ä»¥åˆä½œçš„äº‹æƒ…ï¼è¿™å¯¹æˆ‘ä»¬æ¥è¯´å¾ˆå®¹æ˜“ç†è§£ï¼Œä½†å¯¹å…¶ä»–æ‰€æœ‰äººæ¥è¯´ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œæˆ‘ç‰¹åˆ«å…³æ³¨ä¸šåŠ¡éƒ¨é—¨ã€‚çº¢è‰²æŒ‰é’®æ›´å¥½ï¼Œæ¦‚ç‡åœ¨ 92%å·¦å³ã€‚

*å®Œç¾ï¼*â€ï¼Œä½ æƒ³ç€å’Œä½ åº—é‡Œçš„çº¢ç‰ˆï¼Œå¸Œæœ›å®ƒèƒ½æé«˜ä½ çš„è½¬åŒ–ç‡ã€‚

![](img/d1c0633f57900599da5c04cbc4077130.png)

Uaaaï¼Œuaaaï¼Œuaaaã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ç°åœ¨æƒ³è±¡ä¸€ä¸‹:è¿™åªæ˜¯ä¸€ä¸ªå¾®å°çš„å˜åŒ–ï¼Œå´æœ‰å¯èƒ½å¢åŠ ä½ çš„é”€å”®é¢ã€‚å¯èƒ½æœ‰å„ç§å„æ ·çš„æˆ–å¤§æˆ–å°çš„ä¸œè¥¿ä½ å¯ä»¥ä¿®è¡¥ï¼Œè®©ä½ çš„å•†åº—æ›´å¥½ã€‚æ¯”èµ›åˆšåˆšå¼€å§‹ã€‚

# ç»“è®º

åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨ä¸¤ä¸ªé€‰é¡¹ä¸­åšå‡ºé€‰æ‹©ã€‚è¿™å¯ä»¥åªæ˜¯ä¸€ä¸ªæŒ‰é’®çš„é¢œè‰²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡åœ¨ç½‘ç«™ä¸Šçš„ä½ç½®ï¼ŒæŒ‰é’®æˆ–å›¾åƒä¸Šçš„æ–‡æœ¬ï¼Œæˆ–è€…ä»»ä½•å¯èƒ½è¢«æ”¹å˜çš„ä¸œè¥¿ã€‚

åœ¨ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´è¿›è¡Œé€‰æ‹©çš„ä¸€ç§æ–¹æ³•æ˜¯è¿è¡Œ A/B æµ‹è¯•ã€‚è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•:**ä½ æŠŠä½ çš„é¡¾å®¢åˆ†æˆä¸¤ç»„ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ä½ æƒ³æ”¹å˜çš„ä¸œè¥¿**ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæŒ‰é’®çš„é¢œè‰²ã€‚è¿™æ ·ä½ å°±å¯ä»¥ç¡®å®šåªæœ‰ä½ æ”¹å˜çš„äº‹æƒ…å¯¼è‡´äº†ç»“æœçš„æ”¹å˜ï¼Œå…¶ä»–çš„éƒ½æ²¡æœ‰ã€‚ä¸æ˜¯äººä»¬çš„å¹´é¾„æˆ–æ€§åˆ«ï¼Œä¹Ÿä¸æ˜¯ä½ æ”¶é›†æ•°æ®çš„å·¥ä½œæ—¥ã€‚

é€šå¸¸ï¼Œäººä»¬ä½¿ç”¨ p å€¼è¿›è¡Œç»å…¸çš„ A/B æµ‹è¯•ã€‚è™½ç„¶è¿™å¯¹äºç»Ÿè®¡å­¦å®¶æ¥è¯´æ˜¯ä¸€ä¸ªç†Ÿæ‚‰çš„æ¦‚å¿µï¼Œä½†æ™®é€šäººç»å¸¸ä¼šå¯¹æ¶‰åŠ p å€¼çš„é™ˆè¿°æ„Ÿåˆ°å›°æƒ‘ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è½¬å‘è´å¶æ–¯ A/B æµ‹è¯•ï¼Œå®ƒå…è®¸æ¯ä¸ªäººéƒ½å¯ä»¥å¾ˆå®¹æ˜“åœ°æŒæ¡ç»“æœã€‚æœ€åï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ç”¨ PyMC3 ä¸ç”¨å¤ªå¤šä»£ç å°±èƒ½å¾—å‡ºè¿™æ ·çš„ç»“æœã€‚

æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„ã€æœ‰ç”¨çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼

**ä½œä¸ºæœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ **

1.  **æƒ³æ”¯æŒæˆ‘å¤šå†™ç‚¹æœºå™¨å­¦ä¹ å’Œ**
2.  **æ— è®ºå¦‚ä½•éƒ½è¦è®¡åˆ’è·å¾—ä¸­ç­‰è®¢é˜…é‡ï¼Œ**

**ä¸ºä»€ä¹ˆä¸é€šè¿‡æ­¤é“¾æ¥**[](https://dr-robert-kuebler.medium.com/membership)****ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š****

***è¯´ç™½äº†ï¼Œç»™ä½ çš„ä»·æ ¼ä¸å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç›´æ¥å½’æˆ‘ã€‚***

**éå¸¸æ„Ÿè°¢ï¼Œå¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘çš„è¯ï¼**

> ***æœ‰é—®é¢˜å°±åœ¨*[*LinkedIn*](https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/)*ä¸Šå†™æˆ‘ï¼***