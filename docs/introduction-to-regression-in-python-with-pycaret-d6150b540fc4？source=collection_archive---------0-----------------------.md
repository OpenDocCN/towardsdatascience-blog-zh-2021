# ä½¿ç”¨ PyCaret ä»‹ç» Python ä¸­çš„å›å½’

> åŸæ–‡ï¼š<https://towardsdatascience.com/introduction-to-regression-in-python-with-pycaret-d6150b540fc4?source=collection_archive---------0----------------------->

![](img/f067f70a95a066c42a58806149593b08.png)

å¢å…‹Â·åˆ‡ç‘Ÿåœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

# 1.ä»‹ç»

[PyCaret](https://www.pycaret.org/) æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„å¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚è¿™æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ å’Œæ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æˆå€åœ°åŠ å¿«å®éªŒå‘¨æœŸï¼Œæé«˜æ‚¨çš„å·¥ä½œæ•ˆç‡ã€‚

ä¸å…¶ä»–å¼€æºæœºå™¨å­¦ä¹ åº“ç›¸æ¯”ï¼ŒPyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨æ¥ç”¨å‡ è¡Œä»£ç æ›¿æ¢æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå¿«é€Ÿæœ‰æ•ˆã€‚PyCaret æœ¬è´¨ä¸Šæ˜¯å‡ ä¸ªæœºå™¨å­¦ä¹ åº“å’Œæ¡†æ¶çš„ Python åŒ…è£…å™¨ï¼Œæ¯”å¦‚ scikit-learnã€XGBoostã€LightGBMã€CatBoostã€spaCyã€Optunaã€Hyperoptã€Ray ç­‰ç­‰ã€‚

PyCaret çš„è®¾è®¡å’Œç®€å•æ€§å—åˆ°äº†å…¬æ°‘æ•°æ®ç§‘å­¦å®¶è¿™ä¸€æ–°å…´è§’è‰²çš„å¯å‘ï¼Œè¿™æ˜¯ Gartner é¦–å…ˆä½¿ç”¨çš„æœ¯è¯­ã€‚å…¬æ°‘æ•°æ®ç§‘å­¦å®¶æ˜¯è¶…çº§ç”¨æˆ·ï¼Œä»–ä»¬å¯ä»¥æ‰§è¡Œç®€å•å’Œä¸­ç­‰å¤æ‚çš„åˆ†æä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡åœ¨ä»¥å‰éœ€è¦æ›´å¤šçš„æŠ€æœ¯ä¸“ä¸šçŸ¥è¯†ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹[ç½‘ç«™](https://www.pycaret.org/)æˆ–è€… [GitHub](https://www.github.com/pycaret/pycaret) ã€‚

# 2.æ•™ç¨‹ç›®æ ‡

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ :

*   **è·å–æ•°æ®:**å¦‚ä½•ä» PyCaret èµ„æºåº“å¯¼å…¥æ•°æ®ã€‚
*   **è®¾ç½®ç¯å¢ƒ:**å¦‚ä½•åœ¨ PyCaret ä¸­è®¾ç½®å›å½’å®éªŒï¼Œå¼€å§‹æ„å»ºå›å½’æ¨¡å‹ã€‚
*   **åˆ›å»ºæ¨¡å‹:**å¦‚ä½•åˆ›å»ºæ¨¡å‹ã€æ‰§è¡Œäº¤å‰éªŒè¯å’Œè¯„ä¼°å›å½’æŒ‡æ ‡ã€‚
*   **è°ƒæ•´æ¨¡å‹:**å¦‚ä½•è‡ªåŠ¨è°ƒæ•´å›å½’æ¨¡å‹çš„è¶…å‚æ•°ã€‚
*   **å›¾æ¨¡å‹:**å¦‚ä½•ä½¿ç”¨å„ç§å›¾åˆ†ææ¨¡å‹æ€§èƒ½ã€‚
*   **é¢„æµ‹æ¨¡å‹:**å¦‚ä½•å¯¹æ–°çš„/çœ‹ä¸è§çš„æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚
*   **ä¿å­˜/åŠ è½½æ¨¡å‹:**å¦‚ä½•ä¿å­˜/åŠ è½½æ¨¡å‹ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚

# 3.æ­£åœ¨å®‰è£… PyCaret

å®‰è£…å¾ˆå®¹æ˜“ï¼Œåªéœ€å‡ åˆ†é’Ÿã€‚PyCaret ä» pip çš„é»˜è®¤å®‰è£…åªå®‰è£…åœ¨ [requirements.txt](https://github.com/pycaret/pycaret/blob/master/requirements.txt) æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç¡¬ä¾èµ–é¡¹ã€‚

```
pip install pycaret
```

è¦å®‰è£…å®Œæ•´ç‰ˆ:

```
pip install pycaret[full]
```

# 4.ä»€ä¹ˆæ˜¯å›å½’ï¼Ÿ

å›å½’åˆ†ææ˜¯ä¸€ç»„ç»Ÿè®¡è¿‡ç¨‹ï¼Œç”¨äºä¼°è®¡å› å˜é‡(é€šå¸¸ç§°ä¸ºâ€œç»“æœå˜é‡â€æˆ–â€œç›®æ ‡å˜é‡â€)ä¸ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡(é€šå¸¸ç§°ä¸ºâ€œç‰¹å¾å˜é‡â€ã€â€œé¢„æµ‹å˜é‡â€æˆ–â€œåå˜é‡â€)ä¹‹é—´çš„å…³ç³»ã€‚æœºå™¨å­¦ä¹ ä¸­å›å½’çš„ç›®æ ‡æ˜¯é¢„æµ‹è¿ç»­å€¼ï¼Œå¦‚é”€å”®é¢ã€æ•°é‡ã€æ¸©åº¦ç­‰ã€‚

[**äº†è§£æ›´å¤šå›å½’**](https://hbr.org/2015/11/a-refresher-on-regression-analysis)

# 5.PyCaret ä¸­çš„å›å½’æ¨¡å—æ¦‚è¿°

[PyCaret çš„å›å½’æ¨¡å—](https://pycaret.readthedocs.io/en/latest/api/regression.html) ( `pycaret.regression`)æ˜¯ä¸€ä¸ªå—ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å—ï¼Œç”¨äºä½¿ç”¨å„ç§æŠ€æœ¯å’Œç®—æ³•é¢„æµ‹è¿ç»­å€¼/ç»“æœã€‚å›å½’å¯ç”¨äºé¢„æµ‹å€¼/ç»“æœï¼Œå¦‚é”€å”®é¢ã€å”®å‡ºå•ä½ã€æ¸©åº¦æˆ–ä»»ä½•è¿ç»­çš„æ•°å­—ã€‚

PyCaret çš„å›å½’æ¨¡å—æœ‰è¶…è¿‡ 25 ä¸ªç®—æ³•å’Œ 10 ä¸ªå›¾æ¥åˆ†ææ¨¡å‹çš„æ€§èƒ½ã€‚æ— è®ºæ˜¯è¶…å‚æ•°è°ƒæ•´ã€é›†æˆï¼Œè¿˜æ˜¯å †å ç­‰é«˜çº§æŠ€æœ¯ï¼ŒPyCaret çš„å›å½’æ¨¡å—éƒ½å…·å¤‡ã€‚

# 6.æ•™ç¨‹çš„æ•°æ®é›†

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyCaret çš„æ•°æ®é›†å­˜å‚¨åº“ä¸­çš„æ•°æ®é›†ã€‚è¯¥æ•°æ®åŒ…å« 6000 æ¡ç”¨äºè®­ç»ƒçš„è®°å½•ã€‚æ¯åˆ—çš„ç®€çŸ­æè¿°å¦‚ä¸‹:

*   **ID:** å”¯ä¸€æ ‡è¯†æ¯ä¸ªè§‚å¯Ÿ(è±å½¢)
*   **å…‹æ‹‰é‡é‡:**é’»çŸ³çš„é‡é‡ï¼Œå•ä½ä¸ºå…¬åˆ¶å…‹æ‹‰ã€‚ä¸€å…‹æ‹‰ç­‰äº 0.2 å…‹ï¼Œå¤§è‡´ç›¸å½“äºä¸€æšå›å½¢é’ˆçš„é‡é‡
*   **åˆ‡å·¥:**äº”ä¸ªæ•°å€¼ä¹‹ä¸€ï¼ŒæŒ‰ä»¥ä¸‹åˆæ„æ€§é¡ºåºæŒ‡ç¤ºé’»çŸ³çš„åˆ‡å·¥(ç­¾å-ç†æƒ³ã€ç†æƒ³ã€éå¸¸å¥½ã€è‰¯å¥½ã€ä¸€èˆ¬)
*   **é¢œè‰²:**å…­ä¸ªæ•°å€¼ä¸­çš„ä¸€ä¸ªï¼Œè¡¨ç¤ºé’»çŸ³çš„é¢œè‰²ï¼Œé¡ºåºå¦‚ä¸‹(Dã€Eã€Fâ€”â€”æ— è‰²ï¼ŒGã€Hã€Iâ€”â€”æ¥è¿‘æ— è‰²)
*   **å‡€åº¦:**è¡¨ç¤ºé’»çŸ³å‡€åº¦çš„ä¸ƒä¸ªå€¼ä¹‹ä¸€ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºæ’åˆ—(Fâ€”â€”æ— ç‘•ç–µï¼ŒIFâ€”â€”å†…éƒ¨æ— ç‘•ç–µï¼ŒVVS1 æˆ– vvs 2â€”â€”éå¸¸ã€éå¸¸è½»å¾®ï¼Œæˆ– VS1 æˆ– VS2â€”â€”éå¸¸è½»å¾®ï¼ŒSI1â€”â€”è½»å¾®)
*   **æŠ›å…‰åº¦:**è¡¨ç¤ºé’»çŸ³æŠ›å…‰åº¦çš„å››ä¸ªæ•°å€¼ä¹‹ä¸€(ID â€”ç†æƒ³ã€EX â€”ä¼˜ç§€ã€VG â€”éå¸¸å¥½ã€G â€”è‰¯å¥½)
*   **å¯¹ç§°æ€§:**è¡¨ç¤ºé’»çŸ³å¯¹ç§°æ€§çš„å››ä¸ªæ•°å€¼ä¹‹ä¸€(ID â€”ç†æƒ³ï¼ŒEX â€”ä¼˜ç§€ï¼ŒVG â€”éå¸¸å¥½ï¼ŒG â€”è‰¯å¥½)
*   **æŠ¥å‘Š:**ä¸¤ä¸ªå€¼ä¹‹ä¸€â€œAGSLâ€æˆ–â€œGIAâ€è¡¨ç¤ºå“ªä¸ªåˆ†çº§æœºæ„æŠ¥å‘Šäº†é’»çŸ³è´¨é‡
*   **ä»·æ ¼:**é’»çŸ³ä¼°ä»·çš„ç¾å…ƒé‡‘é¢`Target Column`

```
from pycaret.datasets import get_data
dataset = get_data('diamond')
```

![](img/47ef3fb508703eb19401c9d3f5a884b1.png)

```
#check the shape of data
dataset.shape(6000, 8)
```

ä¸ºäº†æ¼”ç¤ºå¯¹çœ‹ä¸è§çš„æ•°æ®ä½¿ç”¨`predict_model`å‡½æ•°ï¼Œä»åŸå§‹æ•°æ®é›†ä¸­ä¿ç•™äº† 600 æ¡è®°å½•çš„æ ·æœ¬ç”¨äºé¢„æµ‹ã€‚è¿™ä¸åº”ä¸è®­ç»ƒ/æµ‹è¯•åˆ†å‰²ç›¸æ··æ·†ï¼Œå› ä¸ºè¿™ç§ç‰¹å®šçš„åˆ†å‰²æ˜¯ä¸ºäº†æ¨¡æ‹ŸçœŸå®åœºæ™¯è€Œæ‰§è¡Œçš„ã€‚å¦ä¸€ç§æ€è€ƒæ–¹å¼æ˜¯ï¼Œåœ¨è¿›è¡Œè¿™ä¸ªæœºå™¨å­¦ä¹ å®éªŒçš„æ—¶å€™ï¼Œè¿™ 600 æ¡è®°å½•æ˜¯ä¸å¯ç”¨çš„ã€‚

```
data = dataset.sample(frac=0.9, random_state=786)
data_unseen = dataset.drop(data.index)

data.reset_index(drop=True, inplace=True)
data_unseen.reset_index(drop=True, inplace=True)

print('Data for Modeling: ' + str(data.shape))
print('Unseen Data For Predictions: ' + str(data_unseen.shape))**>>> Data for Modeling: (5400, 8)
>>> Unseen Data For Predictions: (600, 8)**
```

# 7.åœ¨ PyCaret ä¸­è®¾ç½®ç¯å¢ƒ

`setup`å‡½æ•°åœ¨ pycaret ä¸­åˆå§‹åŒ–ç¯å¢ƒï¼Œå¹¶åˆ›å»ºè½¬æ¢ç®¡é“ï¼Œä¸ºå»ºæ¨¡å’Œéƒ¨ç½²å‡†å¤‡æ•°æ®ã€‚åœ¨ pycaret ä¸­æ‰§è¡Œä»»ä½•å…¶ä»–å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨`setup`ã€‚å®ƒæœ‰ä¸¤ä¸ªå¼ºåˆ¶å‚æ•°:ä¸€ä¸ª pandas dataframe å’Œç›®æ ‡åˆ—çš„åç§°ã€‚æ‰€æœ‰å…¶ä»–å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œç”¨äºå®šåˆ¶é¢„å¤„ç†ç®¡é“(æˆ‘ä»¬å°†åœ¨åé¢çš„æ•™ç¨‹ä¸­çœ‹åˆ°)ã€‚

å½“æ‰§è¡Œ`setup`æ—¶ï¼ŒPyCaret çš„æ¨ç†ç®—æ³•å°†æ ¹æ®æŸäº›å±æ€§è‡ªåŠ¨æ¨æ–­æ‰€æœ‰ç‰¹å¾çš„æ•°æ®ç±»å‹ã€‚åº”è¯¥å¯ä»¥æ­£ç¡®æ¨æ–­å‡ºæ•°æ®ç±»å‹ï¼Œä½†æƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼ŒPyCaret åœ¨æ‰§è¡Œ`setup`å‡½æ•°åæ˜¾ç¤ºä¸€ä¸ªåŒ…å«ç‰¹å¾åŠå…¶æ¨æ–­æ•°æ®ç±»å‹çš„è¡¨æ ¼ã€‚å¦‚æœæ‰€æœ‰æ•°æ®ç±»å‹éƒ½è¢«æ­£ç¡®è¯†åˆ«ï¼Œå¯æŒ‰ä¸‹`enter`ç»§ç»­ï¼Œæˆ–æŒ‰ä¸‹`quit`ç»“æŸå®éªŒã€‚

ç¡®ä¿æ•°æ®ç±»å‹æ­£ç¡®åœ¨ PyCaret ä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨æ‰§è¡Œå¤šä¸ªç‰¹å®šäºç±»å‹çš„é¢„å¤„ç†ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡å¯¹äºæœºå™¨å­¦ä¹ æ¨¡å‹æ¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ã€‚

æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨`setup`ä¸­çš„`numeric_features`å’Œ`categorical_features`å‚æ•°æ¥é¢„å®šä¹‰æ•°æ®ç±»å‹ã€‚

```
from pycaret.regression import *
s = setup(data = data, target = 'Price', session_id=123)
```

![](img/cbee26cec9bae86a621b825bd6c09bc7.png)

æˆåŠŸæ‰§è¡Œè®¾ç½®åï¼Œå®ƒä¼šæ˜¾ç¤ºåŒ…å«å‡ æ¡é‡è¦ä¿¡æ¯çš„ä¿¡æ¯ç½‘æ ¼ã€‚å¤§éƒ¨åˆ†ä¿¡æ¯ä¸æ‰§è¡Œ`setup`æ—¶æ„å»ºçš„é¢„å¤„ç†æµæ°´çº¿æœ‰å…³ã€‚è¿™äº›ç‰¹æ€§çš„å¤§éƒ¨åˆ†è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ã€‚ä½†æ˜¯ï¼Œåœ¨æ­¤é˜¶æ®µéœ€è¦æ³¨æ„çš„ä¸€äº›é‡è¦äº‹é¡¹åŒ…æ‹¬:

*   **session_id:** ä¸€ä¸ªä¼ªéšæœºæ•°ï¼Œä½œä¸ºç§å­åˆ†å¸ƒåœ¨æ‰€æœ‰å‡½æ•°ä¸­ï¼Œä»¥ä¾¿ä»¥åå†ç°ã€‚å¦‚æœæ²¡æœ‰é€šè¿‡`session_id`ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œåˆ†é…ç»™æ‰€æœ‰åŠŸèƒ½ã€‚åœ¨æœ¬å®éªŒä¸­ï¼Œä¸ºäº†ä»¥åçš„å†ç°æ€§ï¼Œå°†`session_id`è®¾ç½®ä¸º`123`ã€‚
*   **åŸå§‹æ•°æ®:**æ˜¾ç¤ºæ•°æ®é›†çš„åŸå§‹å½¢çŠ¶ã€‚å¯¹äºè¿™ä¸ªå®éªŒï¼Œ(5400ï¼Œ8)æ„å‘³ç€åŒ…æ‹¬ç›®æ ‡åˆ—åœ¨å†…çš„ 5400 ä¸ªæ ·æœ¬å’Œ 8 ä¸ªç‰¹å¾ã€‚
*   **ç¼ºå¤±å€¼:**å½“åŸå§‹æ•°æ®ä¸­å­˜åœ¨ç¼ºå¤±å€¼æ—¶ï¼Œæ˜¾ç¤ºä¸ºçœŸã€‚å¯¹äºè¿™ä¸ªå®éªŒï¼Œæ•°æ®é›†ä¸­æ²¡æœ‰ç¼ºå¤±å€¼ã€‚
*   **æ•°å­—ç‰¹å¾:**æ¨æ–­ä¸ºæ•°å­—çš„ç‰¹å¾æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ8 ä¸ªè¦ç´ ä¸­æœ‰ 1 ä¸ªè¢«æ¨æ–­ä¸ºæ•°å€¼å‹ã€‚
*   **åˆ†ç±»ç‰¹å¾:**æ¨æ–­ä¸ºåˆ†ç±»çš„ç‰¹å¾æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ8 ä¸ªç‰¹å¾ä¸­æœ‰ 6 ä¸ªè¢«æ¨æ–­ä¸ºåˆ†ç±»ç‰¹å¾ã€‚
*   **è½¬æ¢åçš„è®­ç»ƒé›†:**æ˜¾ç¤ºè½¬æ¢åçš„è®­ç»ƒé›†çš„å½¢çŠ¶ã€‚æ³¨æ„ï¼Œå¯¹äºè½¬æ¢åçš„è®­ç»ƒé›†,( 5400ï¼Œ8)çš„åŸå§‹å½¢çŠ¶è¢«è½¬æ¢ä¸º(3779ï¼Œ28)ã€‚ç”±äºåˆ†ç±»ç¼–ç ï¼Œç‰¹å¾çš„æ•°é‡ä» 8 ä¸ªå¢åŠ åˆ° 28 ä¸ª
*   **è½¬æ¢åçš„æµ‹è¯•é›†:**æ˜¾ç¤ºè½¬æ¢åçš„æµ‹è¯•/ä¿æŒé›†çš„å½¢çŠ¶ã€‚åœ¨æµ‹è¯•/ä¿ç•™ç»„ä¸­æœ‰ 1621 ä¸ªæ ·æœ¬ã€‚è¯¥åˆ†å‰²åŸºäºé»˜è®¤å€¼ 70/30ï¼Œå¯ä½¿ç”¨`setup`ä¸­çš„`train_size` å‚æ•°è¿›è¡Œæ›´æ”¹ã€‚

è¯·æ³¨æ„ï¼Œæ‰§è¡Œå»ºæ¨¡æ‰€å¿…éœ€çš„ä¸€äº›ä»»åŠ¡æ˜¯å¦‚ä½•è‡ªåŠ¨å¤„ç†çš„ï¼Œä¾‹å¦‚ç¼ºå¤±å€¼æ’è¡¥(åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ•°æ®ä¸­æ²¡æœ‰ç¼ºå¤±å€¼ï¼Œä½†æˆ‘ä»¬ä»ç„¶éœ€è¦ç”¨äºæœªçŸ¥æ•°æ®çš„æ’è¡¥å™¨)ã€åˆ†ç±»ç¼–ç ç­‰ã€‚`setup`ä¸­çš„å¤§å¤šæ•°å‚æ•°æ˜¯å¯é€‰çš„ï¼Œç”¨äºå®šåˆ¶é¢„å¤„ç†æµæ°´çº¿ã€‚è¿™äº›å‚æ•°è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯å½“æ‚¨è¿›å…¥ä¸­çº§å’Œä¸“å®¶çº§åˆ«æ—¶ï¼Œæˆ‘ä»¬å°†æ›´åŠ è¯¦ç»†åœ°ä»‹ç»å®ƒä»¬ã€‚

# 8.æ¯”è¾ƒæ‰€æœ‰æ¨¡å‹

ä¸€æ—¦è®¾ç½®å®Œæˆï¼Œæ¯”è¾ƒæ‰€æœ‰æ¨¡å‹ä»¥è¯„ä¼°æ€§èƒ½æ˜¯å»ºæ¨¡çš„æ¨èèµ·ç‚¹(é™¤éæ‚¨ç¡®åˆ‡åœ°çŸ¥é“æ‚¨éœ€è¦å“ªç§æ¨¡å‹ï¼Œè€Œäº‹å®å¾€å¾€å¹¶éå¦‚æ­¤)ã€‚è¯¥å‡½æ•°è®­ç»ƒæ¨¡å‹åº“ä¸­çš„æ‰€æœ‰æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ k-fold äº¤å‰éªŒè¯å¯¹å®ƒä»¬è¿›è¡Œè¯„åˆ†ä»¥è¿›è¡Œåº¦é‡è¯„ä¼°ã€‚è¾“å‡ºæ‰“å°ä¸€ä¸ªè¯„åˆ†ç½‘æ ¼ï¼Œæ˜¾ç¤ºå¹³å‡å¹³å‡å¹³å‡è¯¯å·®ã€å¹³å‡å‡æ–¹è¯¯å·®ã€RMSEã€R2ã€å‡æ–¹æ ¹è¯¯å·®å’Œ MAPE(é»˜è®¤ä¸º 10)ä»¥åŠæ¯ä¸ªæ¨¡å‹èŠ±è´¹çš„è®­ç»ƒæ—¶é—´ã€‚

```
best = compare_models()
```

![](img/d7d9c5e54e192aa8a977ab2390899828.png)

ä¸€è¡Œä»£ç ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨äº¤å‰éªŒè¯è®­ç»ƒå’Œè¯„ä¼°äº† 20 å¤šä¸ªæ¨¡å‹ã€‚ä¸Šé¢æ‰“å°çš„è¯„åˆ†ç½‘æ ¼çªå‡ºæ˜¾ç¤ºäº†æœ€é«˜ç»©æ•ˆæŒ‡æ ‡ï¼Œä»…ä¾›æ¯”è¾ƒä¹‹ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç½‘æ ¼ä½¿ç”¨`R2`(ä»é«˜åˆ°ä½)æ’åºï¼Œè¿™å¯ä»¥é€šè¿‡ä¼ é€’`sort`å‚æ•°æ¥æ”¹å˜ã€‚ä¾‹å¦‚ï¼Œ`compare_models(sort = 'RMSLE')`å°†æŒ‰ç…§ RMSLE å¯¹ç½‘æ ¼è¿›è¡Œæ’åº(ä»ä½åˆ°é«˜ï¼Œå› ä¸ºè¶Šä½è¶Šå¥½)ã€‚

å¦‚æœæ‚¨æƒ³å°†æŠ˜å å‚æ•°ä»é»˜è®¤å€¼`10`æ›´æ”¹ä¸ºä¸åŒçš„å€¼ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨`fold`å‚æ•°ã€‚ä¾‹å¦‚`compare_models(fold = 5)`å°†å¯¹æ‰€æœ‰æ¨¡å‹è¿›è¡Œäº”é‡äº¤å‰éªŒè¯æ¯”è¾ƒã€‚å‡å°‘æŠ˜å æ¬¡æ•°å°†æ”¹å–„è®­ç»ƒæ—¶é—´ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`compare_models`æ ¹æ®é»˜è®¤çš„æ’åºé¡ºåºè¿”å›æ€§èƒ½æœ€å¥½çš„æ¨¡å‹ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨`n_select`å‚æ•°è¿”å›å‰ N ä¸ªæ¨¡å‹çš„åˆ—è¡¨ã€‚

# 9.åˆ›å»ºæ¨¡å‹

`create_model`æ˜¯ PyCaret ä¸­ç²’åº¦æœ€ç»†çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯å¤§å¤šæ•° PyCaret åŠŸèƒ½çš„åŸºç¡€ã€‚é¡¾åæ€ä¹‰ï¼Œè¯¥å‡½æ•°ä½¿ç”¨äº¤å‰éªŒè¯æ¥è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹ï¼Œäº¤å‰éªŒè¯å¯ä»¥ç”¨`fold`å‚æ•°æ¥è®¾ç½®ã€‚è¾“å‡ºæ‰“å°å‡ºä¸€ä¸ªå¾—åˆ†ç½‘æ ¼ï¼ŒæŒ‰æŠ˜å æ˜¾ç¤º MAEã€MSEã€RMSEã€R2ã€RMSLE å’Œ MAPEã€‚

å¯¹äºæœ¬æ•™ç¨‹çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸‹é¢çš„æ¨¡å‹ä½œä¸ºæˆ‘ä»¬çš„å€™é€‰æ¨¡å‹ã€‚è¿™äº›é€‰æ‹©ä»…ç”¨äºè¯´æ˜ç›®çš„ï¼Œå¹¶ä¸æ„å‘³ç€å®ƒä»¬æ˜¯æ­¤ç±»æ•°æ®çš„æœ€ä½³é€‰æ‹©æˆ–ç†æƒ³é€‰æ‹©ã€‚

*   AdaBoost å›å½’å™¨(â€œadaâ€)
*   å…‰æ¢¯åº¦æ¨è¿›æœº
*   å†³ç­–æ ‘(â€œdtâ€)

PyCaret çš„æ¨¡å‹åº“ä¸­æœ‰ 25 ä¸ªå¯ç”¨çš„å›å½’å˜é‡ã€‚è¦æŸ¥çœ‹æ‰€æœ‰å›å½’å˜é‡çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·æ£€æŸ¥ docstring æˆ–ä½¿ç”¨`models`å‡½æ•°æŸ¥çœ‹åº“ã€‚

```
models()
```

![](img/97278b095e087ce7aa2f9719d8b9fe7e.png)

## 9.1 AdaBoost å›å½’å™¨

```
ada = create_model('ada')
```

![](img/7e9fcc82c76df12f81e01f83f32e6588.png)

```
print(ada)**>>> OUTPUT** AdaBoostRegressor(base_estimator=None, learning_rate=1.0, loss='linear', n_estimators=50, random_state=123)
```

## 9.2 å…‰æ¢¯åº¦æ¨è¿›æœº

```
lightgbm = create_model('lightgbm')
```

![](img/41674e0cb00c0f239fa350b149e426de.png)

## 9.3 å†³ç­–æ ‘

```
dt = create_model('dt')
```

![](img/880569e1a19fd5475aa7035cbb2004f2.png)

è¯·æ³¨æ„ï¼Œæ‰€æœ‰å‹å·çš„å¹³å‡åˆ†æ•°ä¸`compare_models`ä¸­æ‰“å°çš„åˆ†æ•°ç›¸åŒ¹é…ã€‚è¿™æ˜¯å› ä¸ºæ‰“å°åœ¨`compare_models`åˆ†æ•°ç½‘æ ¼ä¸­çš„æŒ‡æ ‡æ˜¯æ‰€æœ‰ CV æŠ˜å çš„å¹³å‡åˆ†æ•°ã€‚ä¸`compare_models`ç±»ä¼¼ï¼Œå¦‚æœæ‚¨æƒ³å°†æŠ˜å å‚æ•°ä»é»˜è®¤å€¼ 10 æ›´æ”¹ä¸ºä¸åŒçš„å€¼ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨`create_model`åŠŸèƒ½ä¸­çš„`fold`å‚æ•°ã€‚ä¾‹å¦‚:`create_model('dt', fold = 5)`ä½¿ç”¨äº”é‡äº¤å‰éªŒè¯åˆ›å»ºå†³ç­–æ ‘ã€‚

# 10.è°ƒæ•´æ¨¡å‹

å½“ä½¿ç”¨`create_model`åŠŸèƒ½åˆ›å»ºæ¨¡å‹æ—¶ï¼Œå®ƒä½¿ç”¨é»˜è®¤çš„è¶…å‚æ•°æ¥è®­ç»ƒæ¨¡å‹ã€‚ä¸ºäº†è°ƒæ•´è¶…å‚æ•°ï¼Œä½¿ç”¨äº†`tune_model`åŠŸèƒ½ã€‚è¯¥åŠŸèƒ½åœ¨é¢„å®šä¹‰çš„æœç´¢ç©ºé—´ä¸­ä½¿ç”¨`RandomGridSearch`è‡ªåŠ¨è°ƒæ•´æ¨¡å‹çš„è¶…å‚æ•°ã€‚è¾“å‡ºæ‰“å°å‡ºä¸€ä¸ªå¾—åˆ†ç½‘æ ¼ï¼ŒæŒ‰æŠ˜å æ˜¾ç¤º MAEã€MSEã€RMSEã€R2ã€RMSLE å’Œ MAPEã€‚è¦ä½¿ç”¨è‡ªå®šä¹‰æœç´¢ç½‘æ ¼ï¼Œæ‚¨å¯ä»¥åœ¨`tune_model`å‡½æ•°ä¸­ä¼ é€’`custom_grid`å‚æ•°ã€‚

## 10.1 AdaBoost å›å½’å™¨

```
tuned_ada = tune_model(ada)
```

![](img/c7f49255ee6d0cb5ebe957f75f8d00a2.png)

```
print(tuned_ada)**>>> OUTPUT** AdaBoostRegressor(base_estimator=None, learning_rate=0.05, loss='linear',n_estimators=90, random_state=123)
```

## 10.2 å…‰æ¢¯åº¦æ¨è¿›æœº

```
import numpy as np
lgbm_params = {'num_leaves': np.arange(10,200,10),
                        'max_depth': [int(x) for x in np.linspace(10, 110, num = 11)],
                        'learning_rate': np.arange(0.1,1,0.1)
                        }tuned_lightgbm = tune_model(lightgbm, custom_grid = lgbm_params)
```

![](img/e5cd35cfc52ea98aead852f4b9d415d9.png)

```
print(tuned_lightgbm)**>>> OUTPUT**LGBMRegressor(boosting_type='gbdt', class_weight=None, colsample_bytree=1.0,
              importance_type='split', learning_rate=0.1, max_depth=60,
              min_child_samples=20, min_child_weight=0.001, min_split_gain=0.0,
              n_estimators=100, n_jobs=-1, num_leaves=120, objective=None,
              random_state=123, reg_alpha=0.0, reg_lambda=0.0, silent=True,
              subsample=1.0, subsample_for_bin=200000, subsample_freq=0)
```

## 10.3 å†³ç­–æ ‘

```
tuned_dt = tune_model(dt)
```

![](img/79b4fb5bad63d86fc8c95dbfb13173de.png)

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`tune_model`ä¼šä¼˜åŒ–`R2`ï¼Œä½†è¿™å¯ä»¥ä½¿ç”¨`optimize`å‚æ•°è¿›è¡Œæ›´æ”¹ã€‚ä¾‹å¦‚ï¼Œ`tune_model(dt, optimize = 'MAE')`å°†æœç´¢å¯¼è‡´æœ€ä½`MAE`è€Œä¸æ˜¯æœ€é«˜`R2`çš„å†³ç­–æ ‘å›å½’çš„è¶…å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é»˜è®¤æŒ‡æ ‡`R2`åªæ˜¯ä¸ºäº†ç®€å•èµ·è§ã€‚é€‰æ‹©æ­£ç¡®çš„åº¦é‡æ¥è¯„ä¼°å›å½’å˜é‡çš„æ–¹æ³•è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šï¼Œæ‚¨å¯ä»¥ [**å•å‡»æ­¤å¤„**](https://www.dataquest.io/blog/understanding-regression-error-metrics/) äº†è§£å›å½’è¯¯å·®åº¦é‡ã€‚

åœ¨æœ€ç»ˆç¡®å®šç”Ÿäº§çš„æœ€ä½³æ¨¡å‹æ—¶ï¼Œåº¦é‡å¹¶ä¸æ˜¯æ‚¨åº”è¯¥è€ƒè™‘çš„å”¯ä¸€æ ‡å‡†ã€‚è¦è€ƒè™‘çš„å…¶ä»–å› ç´ åŒ…æ‹¬è®­ç»ƒæ—¶é—´ã€k å€çš„æ ‡å‡†åå·®ç­‰ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å‘å‰çœ‹ï¼ŒæŠŠå­˜å‚¨åœ¨`tuned_lightgbm`å˜é‡ä¸­çš„è°ƒæ•´åçš„å…‰æ¢¯åº¦å¢å¼ºæœºå™¨ä½œä¸ºæœ¬æ•™ç¨‹å‰©ä½™éƒ¨åˆ†çš„æœ€ä½³æ¨¡å‹ã€‚

# 11.ç»˜åˆ¶æ¨¡å‹

åœ¨æ¨¡å‹æœ€ç»ˆç¡®å®šä¹‹å‰ï¼Œ`plot_model`å‡½æ•°å¯ç”¨äºåˆ†æä¸åŒæ–¹é¢çš„æ€§èƒ½ï¼Œå¦‚æ®‹å·®å›¾ã€é¢„æµ‹è¯¯å·®ã€ç‰¹å¾é‡è¦æ€§ç­‰ã€‚æ­¤å‡½æ•°æ¥å—ä¸€ä¸ªç»è¿‡è®­ç»ƒçš„æ¨¡å‹å¯¹è±¡ï¼Œå¹¶åŸºäºæµ‹è¯•/ä¿ç•™é›†è¿”å›ä¸€ä¸ªå›¾ã€‚

æœ‰è¶…è¿‡ 10 ä¸ªåœ°å—å¯ç”¨ï¼Œè¯·å‚è§`plot_model`æ–‡æ¡£ä¸­çš„å¯ç”¨åœ°å—åˆ—è¡¨ã€‚

## 11.1 æ®‹å·®å›¾

```
plot_model(tuned_lightgbm)
```

![](img/b2ba56cfe32bb117d4945a19d79a452a.png)

## 11.2 é¢„æµ‹è¯¯å·®å›¾

```
plot_model(tuned_lightgbm, plot = 'error')
```

![](img/b2e289fe895bffbe98668e37eb4272d3.png)

## 11.3 ç‰¹å¾é‡è¦æ€§å›¾

```
plot_model(tuned_lightgbm, plot='feature')
```

![](img/127962b024cbdce0660a1b71eb3a7418.png)

*åˆ†ææ¨¡å‹æ€§èƒ½çš„å¦ä¸€ç§*æ–¹æ³•æ˜¯ä½¿ç”¨`evaluate_model`åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½æ˜¾ç¤ºç»™å®šæ¨¡å‹æ‰€æœ‰å¯ç”¨å›¾çš„ç”¨æˆ·ç•Œé¢ã€‚å®ƒåœ¨å†…éƒ¨ä½¿ç”¨`plot_model`åŠŸèƒ½ã€‚

```
evaluate_model(tuned_lightgbm)
```

![](img/f65e96ddf91372ff31352b8b18d61af0.png)

# 12.æ ¹æ®æµ‹è¯•/ä¿ç•™æ ·æœ¬è¿›è¡Œé¢„æµ‹

åœ¨æœ€ç»ˆç¡®å®šæ¨¡å‹ä¹‹å‰ï¼Œå»ºè®®é€šè¿‡é¢„æµ‹æµ‹è¯•/åšæŒé›†å’Œå®¡æŸ¥è¯„ä¼°æŒ‡æ ‡æ¥æ‰§è¡Œæœ€åçš„æ£€æŸ¥ã€‚å¦‚æœæ‚¨æŸ¥çœ‹ä¸Šé¢ç¬¬ 6 èŠ‚ä¸­çš„ä¿¡æ¯ç½‘æ ¼ï¼Œæ‚¨å°†çœ‹åˆ° 30% (1621 ä¸ªæ ·æœ¬)çš„æ•°æ®è¢«åˆ†ç¦»å‡ºæ¥ä½œä¸ºæµ‹è¯•/ä¿ç•™æ ·æœ¬ã€‚æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„æ‰€æœ‰è¯„ä¼°æŒ‡æ ‡éƒ½æ˜¯ä»…åŸºäºè®­ç»ƒé›†(70%)çš„äº¤å‰éªŒè¯ç»“æœã€‚ç°åœ¨ï¼Œä½¿ç”¨æˆ‘ä»¬å­˜å‚¨åœ¨`tuned_lightgbm`ä¸­çš„æœ€ç»ˆè®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬å°†é¢„æµ‹æ‹’ä¸æ¥å—çš„æ ·æœ¬å¹¶è¯„ä¼°æŒ‡æ ‡ï¼Œä»¥æŸ¥çœ‹å®ƒä»¬æ˜¯å¦ä¸ CV ç»“æœæœ‰å®è´¨æ€§çš„ä¸åŒã€‚

```
predict_model(tuned_lightgbm);
```

![](img/c6b678185cbcce6d6791ccb9d0e7e575.png)

ä¸åœ¨`tuned_lightgbm` CV ç»“æœ(è§ä¸Šæ–‡ç¬¬ 10.2 èŠ‚)ä¸Šè·å¾—çš„`**0.9708**`ç›¸æ¯”ï¼Œæµ‹è¯•/ä¿æŒè£…ç½®ä¸Šçš„ R2 ä¸º`**0.9652**`ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªæ˜¾è‘—çš„å·®å¼‚ã€‚å¦‚æœæµ‹è¯•/ä¿æŒå’Œ CV ç»“æœä¹‹é—´å­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œåˆ™è¿™é€šå¸¸è¡¨æ˜è¿‡åº¦æ‹Ÿåˆï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯ç”±äºå…¶ä»–å‡ ä¸ªå› ç´ ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒæŸ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ç»§ç»­æœ€ç»ˆç¡®å®šæ¨¡å‹ï¼Œå¹¶å¯¹çœ‹ä¸è§çš„æ•°æ®è¿›è¡Œé¢„æµ‹(æˆ‘ä»¬åœ¨å¼€å§‹æ—¶å·²ç»åˆ†ç¦»å‡ºæ¥çš„ 10%çš„æ•°æ®ï¼Œä»æœªå‘ PyCaret å…¬å¼€)ã€‚

# 13.æœ€ç»ˆç¡®å®šç”¨äºéƒ¨ç½²çš„æ¨¡å‹

æ¨¡å‹å®šå‹æ˜¯å®éªŒçš„æœ€åä¸€æ­¥ã€‚PyCaret ä¸­çš„æœºå™¨å­¦ä¹ å·¥ä½œæµä»`setup`å¼€å§‹ï¼Œç„¶åä½¿ç”¨`compare_models`æ¯”è¾ƒæ‰€æœ‰æ¨¡å‹ï¼Œå¹¶åˆ—å‡ºå‡ ä¸ªå€™é€‰æ¨¡å‹(åŸºäºæ„Ÿå…´è¶£çš„åº¦é‡)ï¼Œä»¥æ‰§è¡Œå‡ ç§å»ºæ¨¡æŠ€æœ¯ï¼Œå¦‚è¶…å‚æ•°è°ƒæ•´ã€é›†æˆã€å †å ç­‰ã€‚è¿™ä¸€å·¥ä½œæµç¨‹æœ€ç»ˆå°†å¼•å¯¼æ‚¨æ‰¾åˆ°ç”¨äºå¯¹æ–°çš„å’ŒæœªçŸ¥çš„æ•°æ®è¿›è¡Œé¢„æµ‹çš„æœ€ä½³æ¨¡å‹ã€‚

`finalize_model`å‡½æ•°å°†æ¨¡å‹æ‹Ÿåˆåˆ°å®Œæ•´çš„æ•°æ®é›†ä¸Šï¼ŒåŒ…æ‹¬æµ‹è¯•/ä¿ç•™æ ·æœ¬(æœ¬ä¾‹ä¸­ä¸º 30%)ã€‚æ­¤å‡½æ•°çš„ç›®çš„æ˜¯åœ¨å°†æ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ä¹‹å‰ï¼Œåœ¨å®Œæ•´çš„æ•°æ®é›†ä¸Šè®­ç»ƒæ¨¡å‹ã€‚

```
final_lightgbm = finalize_model(tuned_lightgbm)print(final_lightgbm)**>>> OUTPUT**LGBMRegressor(boosting_type='gbdt', class_weight=None, colsample_bytree=1.0,
              importance_type='split', learning_rate=0.1, max_depth=60,
              min_child_samples=20, min_child_weight=0.001, min_split_gain=0.0,
              n_estimators=100, n_jobs=-1, num_leaves=120, objective=None,
              random_state=123, reg_alpha=0.0, reg_lambda=0.0, silent=True,
              subsample=1.0, subsample_for_bin=200000, subsample_freq=0)
```

è­¦å‘Š:æœ€åä¸€ä¸ªè­¦å‘Šã€‚ä½¿ç”¨`finalize_model`æœ€ç»ˆç¡®å®šæ¨¡å‹åï¼ŒåŒ…æ‹¬æµ‹è¯•/æ‹’ç»é›†åœ¨å†…çš„æ•´ä¸ªæ•°æ®é›†å°†ç”¨äºè®­ç»ƒã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ä½¿ç”¨`finalize_model`åï¼Œè¯¥æ¨¡å‹ç”¨äºå¯¹æ‹’ç»é›†è¿›è¡Œé¢„æµ‹ï¼Œåˆ™æ‰“å°çš„ä¿¡æ¯ç½‘æ ¼å°†ä¼šäº§ç”Ÿè¯¯å¯¼ï¼Œå› ä¸ºæ‚¨è¯•å›¾å¯¹ç”¨äºå»ºæ¨¡çš„ç›¸åŒæ•°æ®è¿›è¡Œé¢„æµ‹ã€‚

ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`predict_model`ä¸‹çš„`final_lightgbm`æ¥æ¯”è¾ƒä¿¡æ¯ç½‘æ ¼å’Œä¸Šé¢ç¬¬ 12 èŠ‚ä¸­çš„ä¿¡æ¯ç½‘æ ¼ã€‚

```
predict_model(final_lightgbm);
```

![](img/413f402ff6cf9c8102954e2a97f3d771.png)

è¯·æ³¨æ„ï¼Œ`final_lightgbm`ä¸­çš„ R2 æ˜¯å¦‚ä½•ä»`**0.9652**`å¢åŠ åˆ°`**0.9891**`çš„ï¼Œå°½ç®¡å‹å·æ˜¯ç›¸åŒçš„ã€‚è¿™æ˜¯å› ä¸º`final_lightgbm`å˜é‡æ˜¯åœ¨åŒ…æ‹¬æµ‹è¯•/æ‹’ç»é›†çš„å®Œæ•´æ•°æ®é›†ä¸Šè®­ç»ƒçš„ã€‚

# 14.æ ¹æ®çœ‹ä¸è§çš„æ•°æ®é¢„æµ‹

`predict_model`å‡½æ•°ç”¨äºé¢„æµ‹æœªçŸ¥/æ–°æ•°æ®é›†ã€‚ä¸ä¸Šä¸€èŠ‚å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬å°†ä¼ é€’`data_unseen`å‚æ•°ã€‚`data_unseen`æ˜¯åœ¨æœ¬æ•™ç¨‹å¼€å§‹æ—¶åˆ›å»ºçš„å˜é‡ï¼ŒåŒ…å«åŸå§‹æ•°æ®é›†çš„ 10% (600 ä¸ªæ ·æœ¬)ï¼Œè¯¥æ•°æ®é›†ä»æœªæš´éœ²ç»™ PyCaretã€‚(å‚è§ç¬¬ 5 èŠ‚çš„è§£é‡Š)

```
unseen_predictions = predict_model(final_lightgbm, data=data_unseen)
unseen_predictions.head()
```

![](img/fd3be5692680cb5828b69b996d8da4ce.png)

`Label`åˆ—è¢«æ·»åŠ åˆ°`data_unseen`é›†åˆä¸­ã€‚æ ‡ç­¾æ˜¯ä½¿ç”¨`final_lightgbm`æ¨¡å‹çš„é¢„æµ‹å€¼ã€‚å¦‚æœæ‚¨æƒ³è¦å¯¹é¢„æµ‹è¿›è¡Œèˆå…¥ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`predict_model`ä¸­çš„`round`å‚æ•°ã€‚æ‚¨è¿˜å¯ä»¥æ£€æŸ¥è¿™æ–¹é¢çš„æŒ‡æ ‡ï¼Œå› ä¸ºæ‚¨æœ‰ä¸€ä¸ªå®é™…çš„ç›®æ ‡åˆ—`Price`å¯ç”¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`pycaret.utils`æ¨¡å—ã€‚

```
from pycaret.utils import check_metric
check_metric(unseen_predictions.Price, unseen_predictions.Label, 'R2')**>>> OUTPUT** 0.9779
```

# 15.ä¿å­˜æ¨¡å‹

æˆ‘ä»¬ç°åœ¨å·²ç»å®Œæˆäº†å®éªŒï¼Œæœ€ç»ˆç¡®å®šäº†ç°åœ¨å­˜å‚¨åœ¨`final_lightgbm`å˜é‡ä¸­çš„`tuned_lightgbm`æ¨¡å‹ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨äº†å­˜å‚¨åœ¨`final_lightgbm`çš„æ¨¡å‹æ¥é¢„æµ‹`data_unseen`ã€‚è¿™ä½¿æˆ‘ä»¬çš„å®éªŒæ¥è¿‘å°¾å£°ï¼Œä½†ä»æœ‰ä¸€ä¸ªé—®é¢˜è¦é—®:å½“ä½ æœ‰æ›´å¤šçš„æ–°æ•°æ®è¦é¢„æµ‹æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ å¿…é¡»å†æ¬¡ç»å†æ•´ä¸ªå®éªŒå—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼ŒPyCaret çš„å†…ç½®å‡½æ•°`save_model`å…è®¸æ‚¨ä¿å­˜æ¨¡å‹å’Œæ•´ä¸ªè½¬æ¢ç®¡é“ä»¥å¤‡åç”¨ã€‚

```
save_model(final_lightgbm,'Final LightGBM Model 25Nov2020')Transformation Pipeline and Model Successfully Saved

**>>> OUTPUT**
(Pipeline(memory=None,
          steps=[('dtypes',
                  DataTypes_Auto_infer(categorical_features=[],
                                       display_types=True, features_todrop=[],
                                       id_columns=[], ml_usecase='regression',
                                       numerical_features=[], target='Price',
                                       time_features=[])),
                 ('imputer',
                  Simple_Imputer(categorical_strategy='not_available',
                                 fill_value_categorical=None,
                                 fill_value_numerical=None,
                                 numeric_strategy='...
                  LGBMRegressor(boosting_type='gbdt', class_weight=None,
                                colsample_bytree=1.0, importance_type='split',
                                learning_rate=0.1, max_depth=60,
                                min_child_samples=20, min_child_weight=0.001,
                                min_split_gain=0.0, n_estimators=100, n_jobs=-1,
                                num_leaves=120, objective=None, random_state=123,
                                reg_alpha=0.0, reg_lambda=0.0, silent=True,
                                subsample=1.0, subsample_for_bin=200000,
                                subsample_freq=0)]],
          verbose=False),
 'Final LightGBM Model 25Nov2020.pkl')
```

# 16.åŠ è½½ä¿å­˜çš„æ¨¡å‹

ä¸ºäº†å°†æ¥åœ¨ç›¸åŒæˆ–ä¸åŒçš„ç¯å¢ƒä¸­åŠ è½½å·²ä¿å­˜çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyCaret çš„`load_model`å‡½æ•°ï¼Œç„¶åè½»æ¾åœ°å°†å·²ä¿å­˜çš„æ¨¡å‹åº”ç”¨äºæ–°çš„æœªçŸ¥æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚

```
saved_final_lightgbm = load_model('Final LightGBM Model 25Nov2020')Transformation Pipeline and Model Successfully Loaded
```

ä¸€æ—¦æ¨¡å‹è¢«åŠ è½½åˆ°ç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„`predict_model`å‡½æ•°ç®€å•åœ°ä½¿ç”¨å®ƒæ¥é¢„æµ‹ä»»ä½•æ–°æ•°æ®ã€‚ä¸‹é¢æˆ‘ä»¬åº”ç”¨äº†åŠ è½½æ¨¡å‹æ¥é¢„æµ‹æˆ‘ä»¬åœ¨ä¸Šé¢ç¬¬ 13 èŠ‚ä¸­ä½¿ç”¨çš„ç›¸åŒçš„`data_unseen`ã€‚

```
new_prediction = predict_model(saved_final_lightgbm, data=data_unseen)new_prediction.head()
```

![](img/fd3be5692680cb5828b69b996d8da4ce.png)

æ³¨æ„`unseen_predictions`å’Œ`new_prediction`çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚

```
from pycaret.utils import check_metric
check_metric(new_prediction.Price, new_prediction.Label, 'R2')0.9779
```

# 17.æ€»ç»“/åç»­æ­¥éª¤ï¼Ÿ

æœ¬æ•™ç¨‹æ¶µç›–äº†ä»æ•°æ®æ‘„å–ã€é¢„å¤„ç†ã€è®­ç»ƒæ¨¡å‹ã€è¶…å‚æ•°è°ƒæ•´ã€é¢„æµ‹å’Œä¿å­˜æ¨¡å‹ä»¥å¤‡åç”¨çš„æ•´ä¸ªæœºå™¨å­¦ä¹ ç®¡é“ã€‚æˆ‘ä»¬å·²ç»åœ¨ä¸åˆ° 10 ä¸ªå‘½ä»¤ä¸­å®Œæˆäº†æ‰€æœ‰è¿™äº›æ­¥éª¤ï¼Œè¿™äº›å‘½ä»¤æ˜¯è‡ªç„¶æ„å»ºçš„ï¼Œè®°å¿†èµ·æ¥éå¸¸ç›´è§‚ï¼Œä¾‹å¦‚`create_model()`ã€`tune_model()`ã€`compare_models()`ã€‚åœ¨æ²¡æœ‰ PyCaret çš„æƒ…å†µä¸‹ï¼Œé‡æ–°åˆ›å»ºæ•´ä¸ªå®éªŒåœ¨å¤§å¤šæ•°åº“ä¸­éœ€è¦ 100 å¤šè¡Œä»£ç ã€‚

æˆ‘ä»¬åªè®²è¿°äº†`pycaret.regression`çš„åŸºç¡€çŸ¥è¯†ã€‚åœ¨æœªæ¥çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°ç ”ç©¶é«˜çº§é¢„å¤„ç†ã€é›†æˆã€å¹¿ä¹‰å †å å’Œå…¶ä»–æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯å…è®¸æ‚¨å®Œå…¨å®šåˆ¶æ‚¨çš„æœºå™¨å­¦ä¹ ç®¡é“ï¼Œå¹¶ä¸”æ˜¯ä»»ä½•æ•°æ®ç§‘å­¦å®¶éƒ½å¿…é¡»çŸ¥é“çš„ã€‚

æ„Ÿè°¢æ‚¨é˜…è¯»[ğŸ™](https://emojipedia.org/folded-hands/)

# é‡è¦é“¾æ¥

â­ [æ•™ç¨‹](https://github.com/pycaret/pycaret/tree/master/tutorials)py caret æ–°æ‰‹ï¼ŸæŸ¥çœ‹æˆ‘ä»¬çš„å®˜æ–¹ç¬”è®°æœ¬ï¼
ğŸ“‹[ç¤¾åŒºåˆ›å»ºçš„ç¤ºä¾‹ç¬”è®°æœ¬](https://github.com/pycaret/pycaret/tree/master/examples)ã€‚
ğŸ“™[åšå®¢](https://github.com/pycaret/pycaret/tree/master/resources)æŠ•ç¨¿äººçš„æ•™ç¨‹å’Œæ–‡ç« ã€‚
ğŸ“š[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/index.html)py caret çš„è¯¦ç»† API æ–‡æ¡£
ğŸ“º[è§†é¢‘æ•™ç¨‹](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g)æˆ‘ä»¬çš„è§†é¢‘æ•™ç¨‹æ¥è‡ªå„ç§èµ›äº‹ã€‚
ğŸ“¢[è®¨è®º](https://github.com/pycaret/pycaret/discussions)æœ‰ç–‘é—®ï¼Ÿä¸ç¤¾åŒºå’Œè´¡çŒ®è€…äº’åŠ¨ã€‚
ğŸ› ï¸ [å˜æ›´æ—¥å¿—](https://github.com/pycaret/pycaret/blob/master/CHANGELOG.md)å˜æ›´å’Œç‰ˆæœ¬å†å²ã€‚
ğŸŒ³[è·¯çº¿å›¾](https://github.com/pycaret/pycaret/issues/1756) PyCaret çš„è½¯ä»¶å’Œç¤¾åŒºå‘å±•è®¡åˆ’ã€‚

# ä½œè€…:

æˆ‘å†™çš„æ˜¯ PyCaret åŠå…¶åœ¨ç°å®ä¸–ç•Œä¸­çš„ç”¨ä¾‹ï¼Œå¦‚æœä½ æƒ³è‡ªåŠ¨å¾—åˆ°é€šçŸ¥ï¼Œä½ å¯ä»¥åœ¨[åª’ä½“](https://medium.com/@moez-62905)ã€ [LinkedIn](https://www.linkedin.com/in/profile-moez/) å’Œ [Twitter](https://twitter.com/moezpycaretorg1) ä¸Šå…³æ³¨æˆ‘ã€‚