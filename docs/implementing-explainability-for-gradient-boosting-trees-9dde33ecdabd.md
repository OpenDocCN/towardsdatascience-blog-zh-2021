# å®ç°æ¢¯åº¦æ¨è¿›æ ‘çš„å¯è§£é‡Šæ€§

> åŸæ–‡ï¼š<https://towardsdatascience.com/implementing-explainability-for-gradient-boosting-trees-9dde33ecdabd?source=collection_archive---------12----------------------->

## æ¢¯åº¦æ¨è¿›ä¸­çš„å†³ç­–è·¯å¾„å®ç°è¯æ˜äº†æ— éœ€ä»»ä½• XAI æ–¹æ³•çš„å±€éƒ¨å¯è§£é‡Šæ€§ã€‚

![](img/1f004ed97520eadf74c2d5e56ccbf6f7.png)

ç‰¹é›·å¼—Â·æ´¾ä¼Šçš„ç…§ç‰‡:æˆ‘ä»¬å–œæ¬¢è¿™ç‰‡æ£®æ—ï¼Œå› ä¸ºæˆ‘ä»¬å–œæ¬¢å¯è§£é‡Šæ€§

*ä½œè€…*:[Bea hernÃ¡ndez](https://medium.com/u/57438069e6ab?source=post_page-----9dde33ecdabd--------------------------------)@[chucheria](https://twitter.com/Chucheria)ï¼Œ[angel Delgado](https://medium.com/u/7462ba410e23?source=post_page-----9dde33ecdabd--------------------------------)[@ thin baker](https://twitter.com/thinbaker)

# 1.åŠ¨æœº

åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ ‘æ¨¡å‹çš„**é›†åˆ**å¦‚éšæœºæ£®æ—(RF)å’Œæ¢¯åº¦æ¨è¿›(GB)å·²ç»åœ¨åˆ†ç±»å’Œå›å½’é—®é¢˜(å¦‚æˆ¿ä»·é¢„æµ‹)ä¸­ç»™å‡ºäº†å¾ˆå¥½çš„ç»“æœã€‚

æˆ‘å’Œä¸€ä¸ªæœ‹å‹ä¸€ç›´åœ¨åšä¸€ä¸ªæˆ¿ä»·é¢„æµ‹é¡¹ç›®ï¼Œæˆ‘ä»¬æ„è¯†åˆ°ï¼Œå°½ç®¡ GB çš„ç»“æœå¾ˆå¥½ï¼Œä½†äººä»¬ä»ç»§ç»­ä½¿ç”¨çº¿æ€§å›å½’(LR)æ¨¡å‹æ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚è¿™æ˜¯å› ä¸º LR å…·æœ‰çš„ä¸€ä¸ªé‡è¦ç‰¹å¾:**ä¸ä»…æ¨¡å‹å¯è§£é‡Šï¼Œè€Œä¸”ç‰¹å¾å¯¹æ¨¡å‹é¢„æµ‹æœ‰è´¡çŒ®ã€‚**

RF å’Œ GB å°±æ˜¯è¿™ç§é»‘ç›’æ¨¡å‹çš„ä¾‹å­ã€‚ç„¶è€Œï¼Œå®ƒä»¬æ˜¯å»ºç«‹åœ¨å®Œå…¨å¯è§£é‡Šçš„å†³ç­–æ ‘ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŸºäºç³»ç»¼çš„å¯è§£é‡Šæ€§ä¸ºç³»ç»¼**å»ºç«‹ä¸€ä¸ªè§£é‡Šç®—æ³•ã€‚**

# 2.å¯è§£é‡Šæ€§

æ®è¯´ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¨¡å‹å°±æ˜¯å¯è§£é‡Šçš„ã€‚â€ã€‚è¿™ä¸»è¦å–å†³äºæ¨¡å‹çš„ç®—æ³•ï¼Œæœ‰äº›æ¨¡å‹ä¸æ”¯æŒè¿™ä¸ªé—®é¢˜ã€‚

ä¸ LR ç›¸æ¯”ï¼Œæ›´é«˜å®¹é‡çš„æ¨¡å‹å¯ä»¥å­¦ä¹ æ›´å¤æ‚çš„æ¨¡å¼æ¥è¿›è¡Œé¢„æµ‹ã€‚ç„¶è€Œï¼Œä»£ä»·æ˜¯é¢„æµ‹æ˜¯ä¸å¯è§£é‡Šçš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ—¢ä¸èƒ½è¯´å‡ºè¿™ç§é¢„æµ‹çš„åŸå› ï¼Œä¹Ÿä¸èƒ½è¯´å‡ºæ¯ä¸ªç‰¹å¾çš„è´¡çŒ®å¤§å°ã€‚è¿™ç§ä¸å¯è§£é‡Šçš„æ¨¡å‹è¢«ç§°ä¸º**é»‘ç®±æ¨¡å‹ã€‚**

åŒæ—¶ï¼Œæœ‰å¤šç§æ–¹æ³•æ¥è§£é‡Šé¢„æµ‹ã€‚

*   **å…¨å±€å¯è§£é‡Šæ€§**:æˆ‘ä»¬è¯•å›¾å›ç­”â€œä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªç‰¹æ€§å¯¹é¢„æµ‹æœ‰å¤šå¤§è´¡çŒ®ï¼Ÿâ€ã€‚ä¾‹å¦‚ï¼Œåœ¨æˆ¿ä»·é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬æƒ³è¦æ‰¾å‡ºâ€œç‰¹å¾å¹³æ–¹ç±³æ˜¯å¦æ¯”æµ´å®¤æ•°é‡å¯¹é¢„æµ‹æœ‰æ›´å¤§çš„å½±å“â€ã€‚
*   **å±€éƒ¨å¯è§£é‡Šæ€§**:æˆ‘ä»¬è¯•å›¾å›ç­”æ˜¯ä»€ä¹ˆç‰¹å¾å€¼ç»™äº†æˆ‘ä»¬ä¸€ä¸ªç‰¹å®šçš„é¢„æµ‹ã€‚ä¾‹å¦‚ï¼Œâ€œåœ¨è¿™ä¸ªæ ·æœ¬ä¸­ï¼Œé¢„æµ‹å€¼æ˜¯æŸä¸€ä¸ªï¼Œå› ä¸ºæˆ¿é—´æ•°æ˜¯ 4ï¼Œå¹¶ä¸”æˆ¿å­ä½äºè¿™ä¸ªç‰¹å®šçš„è¡—é“ä¸Šâ€ã€‚

ç›®å‰ï¼Œç»å¤§å¤šæ•°æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½éƒ½æ¯” LR å¥½å¾—å¤šã€‚ä¹‹æ‰€ä»¥è¿˜æ˜¯çƒ­é—¨æœºå‹ï¼Œæ˜¯å› ä¸ºä¸€ä¸ª LR çš„å¯è§£é‡Šæ€§å¾ˆå¼ºã€‚æœ‰äº† LRï¼Œä½ ä¸ä»…å¯ä»¥ç†è§£é¢„æµ‹ï¼Œè¿˜å¯ä»¥é‡åŒ–**æ¯ä¸ªç‰¹å¾å¯¹é¢„æµ‹çš„è´¡çŒ®**ï¼Œå› ä¸º LR å…¬å¼çš„æœ¬è´¨ã€‚

![](img/ed0f9a6c9e17dd17a76523f476d55207.png)

ä½œè€…å›¾ç‰‡:çº¿æ€§å›å½’é¢„æµ‹è´¡çŒ®

LR ä¸­çš„é¢„æµ‹ç”±ä¸‹å¼ç»™å‡º:

![](img/8db439872022075a4b9b547938da27ce.png)

è¿™å¯ä»¥è§£é‡Šä¸º

![](img/70a935fb0c199cafc3b463943ed7c18a.png)

å…¶ä¸­ *c_i* æ˜¯ç¬¬ *i ä¸ª*ç‰¹å¾çš„è´¡çŒ®ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¯è§£é‡Šçš„æ¨¡å‹**ï¼Œåœ¨æœ€ç»ˆå†³ç­–ä¸­æ²¡æœ‰æ¯ä¸ªç‰¹å¾**çš„è´¡çŒ®ã€‚æ¯”å¦‚å†³ç­–æ ‘ã€‚å†³ç­–æ ‘æ‰§è¡Œä¸€ç»„åˆ†å±‚å†³ç­–ä»¥è·å¾—è§£å†³æ–¹æ¡ˆ(ä¾‹å¦‚*æˆ¿é—´æ•°é‡> 3* )ï¼Œä»è€Œè·å¾—æœ€ç»ˆç»“æœã€‚æ¯ä¸ªå†³ç­–éƒ½æ˜¯ä¸€æ¬¡é’ˆå¯¹ä¸€ä¸ªç‰¹æ€§åšå‡ºçš„ï¼Œä½†æ˜¯æ¯ä¸ªå†³ç­–å¯¹æœ€ç»ˆç»“æœéƒ½æ²¡æœ‰è´¡çŒ®(è‡³å°‘ï¼Œæˆ‘ä»¬ä¼šç›´æ¥æå‡ºä¸€ä¸ªè§£å†³æ–¹æ¡ˆ)ã€‚

![](img/1d60b0bd875e549d5bd73a6d85010b29.png)

ä½œè€…å›¾ç‰‡:å†³ç­–æ ‘é€èŠ‚ç‚¹é¢„æµ‹

åœ¨å†³ç­–æ ‘ä¸­ï¼Œé¢„æµ‹æ˜¯:

![](img/18b7061a6df9d6ba686b32bba9a0a4fa.png)

å…¶ä¸­ *leaf(x)* æ˜¯æ ·æœ¬ *x* æ‰€åœ¨çš„æ ‘çš„å¶èŠ‚ç‚¹

![](img/6c3aabd0cbfc54769c08e901e59a5517.png)

GB(ä»¥åŠ RF)æ˜¯å†³ç­–æ ‘æ¨¡å‹çš„é›†åˆã€‚é›†æˆæ„å‘³ç€ GB æ˜¯ä¸€ç»„å…±åŒæ‰§è¡Œé¢„æµ‹çš„å†³ç­–æ ‘ã€‚ä¸€ä¸ªæ ‘çš„é›†åˆæ¯”å®ƒå•ç‹¬çš„ä»»ä½•ä¸€ä¸ªæ ‘è¡¨ç°å¾—å¥½å¾—å¤šï¼Œç„¶è€Œï¼Œé—®é¢˜æ˜¯**è¿™ä¸ªé›†åˆä¸æ˜¯å±€éƒ¨å¯è§£é‡Šçš„**ï¼Œå› ä¸ºæ¯æ£µæ ‘éƒ½æœ‰å®ƒè‡ªå·±çš„å®Œå…¨ç‹¬ç«‹äºå…¶ä»–æ ‘çš„å†³ç­–è·¯å¾„ï¼Œæˆ‘ä»¬åªèƒ½çŸ¥é“å“ªäº›ç‰¹å¾åœ¨æ€»ä½“ä¸Šæ›´é‡è¦(å…¨å±€è§£é‡Š)ã€‚

å…·ä½“æ¥è¯´ï¼ŒGB é›†æˆç®—æ³•åŸºäºä¸€ç§å«åš**å‰©ä½™å¯åŠ æ€§**çš„ä¸œè¥¿ã€‚è¿™æ„å‘³ç€ç³»ç»¼çš„æ¯ä¸€æ£µæ ‘éƒ½ä»ä¹‹å‰çš„æ ‘çš„é¢„æµ‹å’ŒçœŸå®å€¼(æ®‹å·®)ä¸­å­¦ä¹ å·®å¼‚ï¼Œå› æ­¤æœ€ç»ˆçš„é¢„æµ‹æ˜¯æ‰€æœ‰æ ‘çš„é¢„æµ‹(è´¡çŒ®)çš„æ€»å’Œ(å¯åŠ æ€§)ã€‚

![](img/6a0bb4deb6736e8ef056b589034f77a6.png)

ä½œè€…å›¾ç‰‡:åœ¨æ ‘è´¡çŒ®çº§åˆ«è§£é‡Šæ¢¯åº¦æ¨è¿›é¢„æµ‹

ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆå¯è§£é‡Šæ€§å¯¹æˆ‘ä»¬å¦‚æ­¤é‡è¦ã€‚åŸå› æ˜¯å› ä¸ºåœ¨æŸäº›é—®é¢˜ä¸Šï¼Œ**è§£é‡Šå’Œ**é¢„æµ‹ä¸€æ ·é‡è¦ã€‚åœ¨æˆ¿ä»·é¢„æµ‹ä¸­ï¼Œæ‚¨æƒ³çŸ¥é“æ˜¯ä»€ä¹ˆä½¿æŸä¸ªæˆ¿å­å¦‚æ­¤ä¾¿å®œ/æ˜‚è´µï¼Œæˆ–è€…å¦‚æœæŸä¸ªç‰¹å¾å€¼ä¸åŒï¼Œä»·æ ¼ä¼šå˜åŒ–å¤šå°‘ã€‚

è€ƒè™‘åˆ°æ‰€æœ‰è¿™äº›ä¿¡æ¯ï¼Œå¹¶è€ƒè™‘åˆ° GB ä¸ºå›å½’é—®é¢˜æä¾›çš„å·¨å¤§ç»“æœï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ç§ç®—æ³•ï¼Œä»¥æŸç§æ–¹å¼èšåˆæ¨¡å‹æ‰€æœ‰æ ‘çš„è´¡çŒ®ï¼Œä»¥ç†è§£é¢„æµ‹ã€‚

# 3.GB å†³ç­–è·¯å¾„

æˆ‘ä»¬å·²ç»æåˆ°ï¼Œæ¨¡å‹çš„å¯è§£é‡Šæ€§åªå–å†³äºå®ƒçš„ç®—æ³•ï¼Œæœ‰å¯è§£é‡Šçš„æ¨¡å‹å’Œé‚£äº›ä¸æ˜¯æ ¹æ®å®ƒçš„ç®—æ³•çš„æ¨¡å‹ï¼Œä½†ä»ç»Ÿè®¡ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬æ€»æ˜¯å¯ä»¥åˆ†ææ¨¡å‹è¿”å›çš„ç»“æœæ¥ç†è§£å®ƒä»¬ã€‚

è¿™äº›ç»Ÿè®¡æ–¹æ³•å…è®¸**æ¨¡å‹ä¸å¯çŸ¥çš„è§£é‡Šæ€§åˆ†æ**ã€‚ä¾‹å¦‚ï¼Œä¸€ç§å¸¸è§çš„åˆ†ææ–¹æ³•æ˜¯åˆ†è§£æ³•ã€‚å¦‚æœæˆ‘ä»¬ä»…ä»…æ”¹å˜ä¸€ä¸ªç‰¹å¾ï¼Œè¿™ç§åˆ†è§£å…è®¸æˆ‘ä»¬æµ‹é‡ä¸€ä¸ªé¢„æµ‹æ”¹å˜äº†å¤šå°‘ã€‚é¢„æµ‹ä¸­çš„å·®å¼‚ç»™å‡ºäº†ç‰¹å®šç‰¹å¾åœ¨æœ€ç»ˆç»“æœä¸­çš„è´¡çŒ®çš„ä¼°è®¡ã€‚

ç‰¹å¾åˆ†è§£è´¡çŒ® *X_i* :

![](img/b9f693a26b215f300d196ddc40a36e08.png)

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ª*é‡è¦æ€§*åº¦é‡å¹¶ä¸å®Œå…¨ç²¾ç¡®ï¼Œè€Œæ˜¯ä¸€ä¸ª**ç»Ÿè®¡ä¼°è®¡**ã€‚

å³ä½¿ GB çš„æ€§è´¨æ²¡æœ‰ç»™å‡ºå…¶é¢„æµ‹çš„è§£é‡Šï¼Œæ ‘ç®—æ³•é¢„æµ‹ä¸€æ¬¡æ‰§è¡Œæ¯ä¸ªå†³ç­–å€¼ã€‚è¿™ç§æ€§è´¨ä»¥åŠå‰©ä½™æ´»åŠ¨å…è®¸æˆ‘ä»¬è‡ªç„¶åœ°å°†åˆ†è§£ç‰¹å¾è´¡çŒ®çš„æƒ³æ³•åŒ…å«åœ¨æ¢¯åº¦å¢å¼ºç®—æ³•ä¸­ã€‚

# ç®—æ³•

# 1.èŠ‚ç‚¹è´¡çŒ®

å¯¹äºæ¯æ£µæ ‘ï¼Œé€šè¿‡ä¸€ç»„ç‰¹å¾å†³ç­–åˆ†å‰²(ä¾‹å¦‚æµ´å®¤æ•°é‡> 3)è¿›è¡Œé¢„æµ‹ï¼Œå¹¶ä¸”å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªå¯¹åº”äºæ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚è¿™äº›èŠ‚ç‚¹ä¸­çš„æ¯ä¸€ä¸ªéƒ½åˆ†é…æœ‰é¢„æµ‹å€¼ã€‚æ ‘çš„é¢„æµ‹æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚

ç±»ä¼¼äºåˆ†è§£åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªå†³ç­–çš„è´¡çŒ®ä¼°è®¡ä¸ºè¯¥èŠ‚ç‚¹çš„å€¼ä¸å‰ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ä¹‹é—´çš„å·®:

![](img/468d2e1b2e1e7b0aa61555b8f61a8533.png)

å…¶ä¸­ *c_i* æ˜¯å†³ç­– *i* çš„è´¡çŒ®ã€‚

# 2.æ ‘è´¡çŒ®

è¿™æ˜¯ç”±äºæ¥è‡ªæ¢¯åº¦å¢å¼ºç³»ç»¼çš„å‰©ä½™æ·»åŠ ã€‚æœ€ç»ˆçš„é¢„æµ‹æ˜¯æ‰€æœ‰æ ‘çš„é¢„æµ‹ä¹‹å’Œï¼Œæ‰€ä»¥æ¯æ£µæ ‘çš„è´¡çŒ®å°±æ˜¯å®ƒçš„é¢„æµ‹:

![](img/3618adcfa041c4a776627a05df3e364a.png)

å…¶ä¸­ *treePred_i* æ˜¯ç¬¬*æ£µ*æ£µçš„é¢„æµ‹ã€‚

# 3.å†³ç­–è´¡çŒ®

æˆ‘ä»¬çš„ç›®çš„æ˜¯äº†è§£æ¯ä¸ªå†³ç­–å¯¹æœ€ç»ˆç»“æœçš„è´¡çŒ®æœ‰å¤šå¤§ï¼Œå› æ­¤ï¼ŒæŒ‰ç…§å‰é¢çš„ä¸¤ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å†³ç­–çš„è´¡çŒ®æ¥ç¼–å†™é¢„æµ‹:

![](img/d3ec1c2ece57e747a4b15d71edc50b0f.png)

å…¶ä¸­ *value(node_i)_j* æ˜¯æ ‘ *j* çš„èŠ‚ç‚¹ *i* çš„å€¼ã€‚

# 4.ç‰¹å¾è´¡çŒ®

å¦‚æœæˆ‘ä»¬æ„è¯†åˆ°æ¯ä¸ªå†³ç­–éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹ç»‘å®šçš„ç‰¹å¾ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥è·å¾—æ¯ä¸ªå†³ç­–çš„è´¡çŒ®ï¼Œè¿˜å¯ä»¥æ ¹æ®ç‰¹å¾å°†å®ƒä»¬åˆ†ç»„å¹¶æ±‚å’Œï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—**ç‰¹å¾è´¡çŒ®å’Œå±€éƒ¨å¯è§£é‡Šæ€§ã€‚**

æ‰€ä»¥è§£é‡Šåº”è¯¥æ˜¯

*   å†³ç­– 1(ç‰¹å¾ j)-è´¡çŒ®èŠ‚ç‚¹ 1
*   å†³ç­– 2(ç‰¹å¾ k)-è´¡çŒ®èŠ‚ç‚¹ 2

ç”±äºæˆ‘ä»¬ä¸€ç›´åœ¨ä¸ ScikitLearnã€ [**çš„ GB åˆä½œï¼Œæˆ‘ä»¬å·²ç»åœ¨åº“**](https://github.com/scikit-learn/scikit-learn/issues/19294) å†…éƒ¨å®ç°äº†æˆ‘ä»¬çš„æ–¹æ³•ã€‚ScikitLearn æ˜¯æœ€å—æ¬¢è¿çš„æœºå™¨å­¦ä¹ åº“ä¹‹ä¸€ï¼Œå› æ­¤åœ¨å…¶ä¸­å®ç°å¯è§£é‡Šæ€§å¯¹è®¸å¤šäººæ¥è¯´éå¸¸æœ‰å¸®åŠ©(æˆ‘ä»¬ä»åœ¨ç­‰å¾…æˆ‘ä»¬çš„ PR è¢«æ¥å—)ã€‚

![](img/98372fc43825bf04069dd93e742ed8a9.png)

ä½œè€…å›¾ç‰‡:æˆ‘ä»¬å¯¹èŠ‚ç‚¹è´¡çŒ®å¯è§£é‡Šæ€§çš„å®ç°

# 4.ä»£ç ç¤ºä¾‹

ä¸ºäº†åœ¨å®è·µä¸­è§£é‡Šæ•´ä¸ªç®—æ³•ï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨ ScikitLearn GB ç±»æ¥è§£é‡Š Boston House Pricing æ•°æ®é›†çš„é¢„æµ‹(æ­£å¦‚æˆ‘ä»¬æåˆ°çš„ï¼Œæˆ‘ä»¬å·²ç»æ‰“å¼€äº† [**ä¸€ä¸ªé—®é¢˜**](https://github.com/scikit-learn/scikit-learn/issues/19294) ï¼Œå…¶ä¸­æˆ‘ä»¬åœ¨ decision_path æ–¹æ³•ä¸­å®ç°äº†æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ)ã€‚

# a.å†³ç­–å¯è§£é‡Šæ€§ç¤ºä¾‹

```
import numpy as np
from sklearn.datasets import load_boston
from sklearn.ensemble import GradientBoostingRegressor
from sklearn.model_selection import train_test_splitX, y = load_boston(return_X_y=True)
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)reg = GradientBoostingRegressor(random_state=0, n_estimators=5)
reg.fit(X_train, y_train)init, values, explanations = reg.decision_path(X[0:1])print("Prediction for X_i: ", reg.predict(X[0:1]))
print("init: ", init)
print("values: ", np.nansum(values), "\\n")print("Breakdown:")
for val, exp in zip(values.tolist()[0],explanations):
    if ~np.isnan(val) and val!=0:
        print("contribution of ", round(val,5),
                "\\t because column ", round(exp[0])," ", exp[1], " ", round(exp[2],2))Prediction for X_i:  23.48966781
Init:    22.608707124010557 
values:  0.8809606811142934Breakdown:
contribution of   0.85498 	 because column  12  <   8.13
contribution of  -0.27826 	 because column  5   <   7.43
contribution of  -0.36345 	 because column  5   <   6.66
contribution of   0.67168 	 because column  12  <   9.63
contribution of  -0.36681 	 because column  5   <   7.01
contribution of  -0.04358 	 because column  7   >   1.48
contribution of  -0.24703 	 because column  5   <   6.84
contribution of   0.2979 	 because column  12  <   14.4
contribution of  -0.02668 	 because column  7   >   1.47
contribution of   0.63668        because column  12  <   8.13
contribution of  -0.325 	 because column  5   <   7.01
contribution of  -0.04324 	 because column  7   >   1.48
contribution of   0.48953	 because column  12  <   9.71
contribution of  -0.33782 	 because column  5   <   6.8
contribution of  -0.03794 	 because column  0   <   4.73
```

æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œé¢„æµ‹å€¼(23.48)æ˜¯åˆå§‹å¹³å‡å€¼(22.60)åŠ ä¸Šåˆ†è§£ä¸­å¯ä»¥çœ‹åˆ°çš„ç‰¹å¾è´¡çŒ®å€¼(0.88)ä¹‹å’Œã€‚

# b.ç‰¹å¾å¯è§£é‡Šæ€§ç¤ºä¾‹

æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ï¼Œåˆ©ç”¨ä¹‹å‰çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç‰¹å¾å¯¹å†³ç­–è¿›è¡Œåˆ†ç»„ï¼Œä»¥è·å¾—ç‰¹å¾è´¡çŒ®

```
from collections import defaultdict
counter = defaultdict(float)
cols = [i[0] if i else None for i in explanations]for col,val in zip(cols, values.tolist()[0]):
    if ~np.isnan(val) and val!=0:
        counter[col]+=valfor col, val in counter.items():
    print("column ", col, "\\tcontributed ", val)column  12 	contributed   2.9507737309447437
column  5 	contributed  -1.918373871627328
column  7 	contributed  -0.11350035836622434
column  0 	contributed  -0.03793881983689874
```

æˆ‘ä»¬ä¸ä»…å¯ä»¥çœ‹åˆ°è¿™ä¸ªå†³ç­–æœ€é‡è¦çš„ç‰¹æ€§æ˜¯ç¬¬ 12ã€5ã€7ã€0 åˆ—ï¼Œè¿˜å¯ä»¥çœ‹åˆ°æ¯ä¸€åˆ—å¯¹æœ€ç»ˆç»“æœçš„è´¡çŒ®ã€‚

# 5.ç»“è®º

1.  åœ¨æŸäº›é—®é¢˜ä¸­ï¼Œå¯è§£é‡Šæ€§æ˜¯ä¸€ä¸ªå…³é”®æ¦‚å¿µï¼Œä¸ä»…æ˜¯ä¸ºäº†ç†è§£é¢„æµ‹ï¼Œä¹Ÿæ˜¯ä¸ºäº†è¡¡é‡æ¯ä¸ªç‰¹å¾å¯¹æœ€ç»ˆç»“æœçš„å½±å“ã€‚æ¨¡å‹çš„å¯è§£é‡Šæ€§æ˜¯å®ƒå›ºæœ‰çš„ä¸œè¥¿ã€‚
2.  é™¤äº†æ¨¡å‹çš„å¯è§£é‡Šæ€§ï¼Œè¿˜æœ‰ä¸€äº›ç»Ÿè®¡å·¥å…·å¯ä»¥è®©æˆ‘ä»¬ç†è§£å’Œä¼°è®¡æ¯ä¸ªå€¼å¯¹æ¨¡å‹çš„æœ€ç»ˆé¢„æµ‹çš„å½±å“ï¼Œæ¯”å¦‚åˆ†è§£ã€‚
3.  GB çš„æ€§è´¨(å³æ¥è‡ªæ ‘çš„å‰©ä½™å­¦ä¹ å’Œå†³ç­–è·¯å¾„)å…è®¸å†…åœ¨åœ°ä¼°è®¡æ¯ä¸ªå†³ç­–å’Œæ¯ä¸ªç‰¹å¾å¯¹é¢„æµ‹çš„è´¡çŒ®ï¼Œå› æ­¤å³ä½¿å®ƒä»¬ä¸æ˜¯å¯è§£é‡Šçš„ï¼Œå®ƒä»¬ä¹Ÿæ˜¯å¯è§£é‡Šçš„ã€‚

![](img/21fefb07b05c004b22a842b47fb673e0.png)

é©¬å…‹Â·æ³°æ ¼éœå¤«åœ¨ Unsplash ä¸Šçš„ç…§ç‰‡:æˆ‘ä»¬ä¹Ÿå–œæ¬¢è¿™ä¸ªç›†æ™¯

# å‚è€ƒ

*   [æ¯”åˆ‡å…‹ã€æ™®çƒ­ç±³æ–¯åŠ³å’Œå¸ƒæ—¥ç§‘å¤«æ–¯åŸºã€æ‰˜é©¬å…¹ã€‚è§£é‡Šæ€§æ¨¡å‹åˆ†æ](https://ema.drwhy.ai/)
*   [Gosiewskaã€Alicja å’Œ Przemyslaw Biecekã€‚2019.iBreakDown:éåŠ æ€§é¢„æµ‹æ¨¡å‹çš„æ¨¡å‹è§£é‡Šçš„ä¸ç¡®å®šæ€§](https://arxiv.org/abs/1903.11420v1)
*   [å†³ç­–è·¯å¾„ GitHub é—®é¢˜](https://github.com/scikit-learn/scikit-learn/issues/19294)
*   [Scikit-Learn é›†æˆ:æ¢¯åº¦æ¨è¿›å›å½’å™¨](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingRegressor.html)

**æ„Ÿè°¢é˜…è¯»ï¼ğŸ’–**