# Python æ·±åº¦å­¦ä¹ :ç¥ç»ç½‘ç»œ(å®Œæ•´æ•™ç¨‹)

> åŸæ–‡ï¼š<https://towardsdatascience.com/deep-learning-with-python-neural-networks-complete-tutorial-6b53c0b06af0?source=collection_archive---------0----------------------->

![](img/bf7a59d41b19f964ce71b34753c515bf.png)

ä½œè€…å›¾ç‰‡

## ç”¨ TensorFlow å»ºç«‹ã€ç»˜åˆ¶å’Œè§£é‡Šäººå·¥ç¥ç»ç½‘ç»œ

## æ‘˜è¦

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ç”¨ Python æ„å»ºç¥ç»ç½‘ç»œï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å¯è§†åŒ–å’Œåˆ›å»ºæ¨¡å‹é¢„æµ‹çš„è§£é‡Šå™¨å‘ä¸šåŠ¡è§£é‡Šæ·±åº¦å­¦ä¹ ã€‚

![](img/40f3c3dfb30b9524a34671107d917e15.png)

ä½œè€…å›¾ç‰‡

[**æ·±åº¦å­¦ä¹ **](https://en.wikipedia.org/wiki/Deep_learning) æ˜¯ä¸€ç§æ¨¡ä»¿äººç±»è·å–æŸäº›ç±»å‹çŸ¥è¯†çš„æ–¹å¼çš„æœºå™¨å­¦ä¹ ï¼Œä¸æ ‡å‡†æ¨¡å‹ç›¸æ¯”ï¼Œå®ƒåœ¨è¿™äº›å¹´é‡Œå˜å¾—æ›´å—æ¬¢è¿ã€‚è™½ç„¶ä¼ ç»Ÿç®—æ³•æ˜¯çº¿æ€§çš„ï¼Œä½†æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œé€šå¸¸æ˜¯ç¥ç»ç½‘ç»œï¼Œå †å åœ¨å¤æ‚æ€§å’ŒæŠ½è±¡æ€§ä¸æ–­å¢åŠ çš„å±‚æ¬¡ç»“æ„ä¸­(å› æ­¤æ˜¯æ·±åº¦å­¦ä¹ ä¸­çš„â€œæ·±åº¦â€)ã€‚

[**ç¥ç»ç½‘ç»œ**](https://en.wikipedia.org/wiki/Artificial_neural_network) åŸºäºä¸€ç»„ç›¸äº’è¿æ¥çš„å•å…ƒ(ç¥ç»å…ƒ)ï¼Œè¿™äº›å•å…ƒå°±åƒå¤§è„‘ä¸­çš„çªè§¦ä¸€æ ·ï¼Œå¯ä»¥å‘å…¶ä»–ç¥ç»å…ƒä¼ é€’ä¿¡å·ï¼Œè¿™æ ·ï¼Œå®ƒä»¬å°±åƒç›¸äº’è¿æ¥çš„è„‘ç»†èƒä¸€æ ·ï¼Œå¯ä»¥ä»¥æ›´åƒäººç±»çš„æ–¹å¼å­¦ä¹ å’Œåšå‡ºå†³å®šã€‚

ä»Šå¤©ï¼Œæ·±åº¦å­¦ä¹ éå¸¸å—æ¬¢è¿ï¼Œè®¸å¤šå…¬å¸éƒ½æƒ³ä½¿ç”¨å®ƒï¼Œå³ä½¿ä»–ä»¬å¹¶ä¸å®Œå…¨ç†è§£å®ƒã€‚é€šå¸¸ï¼Œæ•°æ®ç§‘å­¦å®¶é¦–å…ˆå¿…é¡»ä¸ºä¸šåŠ¡ç®€åŒ–è¿™äº›å¤æ‚çš„ç®—æ³•ï¼Œç„¶åè§£é‡Šå’Œè¯æ˜æ¨¡å‹çš„ç»“æœï¼Œè¿™å¯¹äºç¥ç»ç½‘ç»œæ¥è¯´å¹¶ä¸æ€»æ˜¯ç®€å•çš„ã€‚æˆ‘è®¤ä¸ºæœ€å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡æƒ³è±¡ã€‚

æˆ‘å°†å±•ç¤ºä¸€äº›æœ‰ç”¨çš„ Python ä»£ç ï¼Œè¿™äº›ä»£ç å¯ä»¥å¾ˆå®¹æ˜“åœ°åº”ç”¨äºå…¶ä»–ç±»ä¼¼çš„æƒ…å†µ(åªéœ€å¤åˆ¶ã€ç²˜è´´ã€è¿è¡Œ)ï¼Œå¹¶é€šè¿‡æ³¨é‡Šéå†æ¯ä¸€è¡Œä»£ç ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å¤åˆ¶è¿™äº›ç¤ºä¾‹ã€‚

ç‰¹åˆ«æ˜¯ï¼Œæˆ‘å°†ç»å†:

*   ç¯å¢ƒè®¾ç½®ï¼Œ*tensor flow*vs*py torchã€‚*
*   äººå·¥ç¥ç»ç½‘ç»œåˆ†è§£ï¼Œè¾“å…¥ï¼Œè¾“å‡ºï¼Œéšè—å±‚ï¼Œæ¿€æ´»å‡½æ•°ã€‚
*   ç”¨æ·±åº¦ç¥ç»ç½‘ç»œè¿›è¡Œæ·±åº¦å­¦ä¹ ã€‚
*   ä½¿ç”¨ *tensorflow/keras* è¿›è¡Œæ¨¡å‹è®¾è®¡ã€‚
*   ç”¨ *python å®ç°ç¥ç»ç½‘ç»œå¯è§†åŒ–ã€‚*
*   æ¨¡å‹åŸ¹è®­å’Œæµ‹è¯•ã€‚
*   ç”¨*å½¢çŠ¶è§£é‡Šã€‚*

## è®¾ç½®

æ„å»ºç¥ç»ç½‘ç»œçš„åº“ä¸»è¦æœ‰ä¸¤ä¸ª:[***tensor flow***](https://www.tensorflow.org/)(Google å¼€å‘)å’Œ[***py torch***](https://pytorch.org/)(è„¸ä¹¦å¼€å‘)*ã€‚ä»–ä»¬å¯ä»¥æ‰§è¡Œç±»ä¼¼çš„ä»»åŠ¡ï¼Œä½†å‰è€…æ›´é€‚åˆç”Ÿäº§ï¼Œè€Œåè€…åˆ™é€‚åˆå¿«é€Ÿæ„å»ºåŸå‹ï¼Œå› ä¸ºå®ƒæ›´å®¹æ˜“å­¦ä¹ ã€‚*

è¿™ä¸¤ä¸ªåº“å—åˆ°ç¤¾åŒºå’Œä¼ä¸šçš„é’çï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥åˆ©ç”¨ NVIDIA GPUs çš„å¼ºå¤§åŠŸèƒ½ã€‚è¿™å¯¹äºå¤„ç†å¤§å‹æ•°æ®é›†(å¦‚æ–‡æœ¬é›†æˆ–å›¾ç‰‡é›†)éå¸¸æœ‰ç”¨ï¼Œæœ‰æ—¶ä¹Ÿæ˜¯å¿…è¦çš„ã€‚

å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘å°†ä½¿ç”¨ *TensorFlow* å’Œ [*Keras*](https://www.tensorflow.org/api_docs/python/tf/keras) ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”çº¯ *TensorFlow* å’Œ *PyTorch* æ›´å‹å¥½çš„é«˜çº§æ¨¡å—ï¼Œå°½ç®¡é€Ÿåº¦ç¨æ…¢ã€‚

ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡ç»ˆç«¯å®‰è£… *TensorFlow* ;

```
pip install tensorflow
```

å¦‚æœä½ æƒ³å¯ç”¨ GPU æ”¯æŒï¼Œä½ å¯ä»¥é˜…è¯»[å®˜æ–¹æ–‡æ¡£](https://www.tensorflow.org/install/gpu)æˆ–éµå¾ªæœ¬[æŒ‡å—](/installing-tensorflow-with-cuda-cudnn-and-gpu-support-on-windows-10-60693e46e781)ã€‚è®¾ç½®å¥½ä¹‹åï¼Œä½ çš„ Python æŒ‡ä»¤ä¼šè¢«ä½ çš„æœºå™¨ç¿»è¯‘æˆ[*CUDA*](https://en.wikipedia.org/wiki/CUDA)*å¹¶ç”± GPU å¤„ç†ï¼Œè¿™æ ·ä½ çš„æ¨¡å‹è¿è¡Œèµ·æ¥ä¼šå¿«å¾—ä»¤äººéš¾ä»¥ç½®ä¿¡ã€‚*

*ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¬”è®°æœ¬ä¸Šå¯¼å…¥æ¥è‡ª *TensorFlow Keras* çš„ä¸»è¦æ¨¡å—ï¼Œå¹¶å¼€å§‹ç¼–ç :*

```
*from **tensorflow**.keras import models, layers, utils, backend as K
import **matplotlib**.pyplot as plt
import **shap***
```

## *äººå·¥ç¥ç»ç½‘ç»œ*

*äººå·¥ç¥ç»ç½‘ç»œç”±å…·æœ‰è¾“å…¥å’Œè¾“å‡ºç»´åº¦çš„å±‚ç»„æˆã€‚åè€…ç”±**ç¥ç»å…ƒ**(ä¹Ÿç§°ä¸ºâ€œèŠ‚ç‚¹â€)çš„æ•°é‡å†³å®šï¼Œè¿™æ˜¯ä¸€ä¸ªé€šè¿‡**æ¿€æ´»å‡½æ•°**(å¸®åŠ©ç¥ç»å…ƒæ‰“å¼€/å…³é—­)è¿æ¥åŠ æƒè¾“å…¥çš„è®¡ç®—å•å…ƒã€‚åƒå¤§å¤šæ•°æœºå™¨å­¦ä¹ ç®—æ³•ä¸€æ ·ï¼Œåœ¨è®­ç»ƒæœŸé—´éšæœºåˆå§‹åŒ–å’Œä¼˜åŒ–**æƒé‡**ï¼Œä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚*

*è¿™äº›å±‚å¯ä»¥åˆ†ä¸º:*

*   ***è¾“å…¥å±‚**è´Ÿè´£å°†è¾“å…¥å‘é‡ä¼ é€’ç»™ç¥ç»ç½‘ç»œã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ª 3 ä¸ªç‰¹å¾çš„çŸ©é˜µ(å½¢çŠ¶ NÃ—3)ï¼Œè¿™ä¸€å±‚å°† 3 ä¸ªæ•°å­—ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†ç›¸åŒçš„ 3 ä¸ªæ•°å­—ä¼ é€’ç»™ä¸‹ä¸€å±‚ã€‚*
*   ***éšå±‚**ä»£è¡¨ä¸­é—´èŠ‚ç‚¹ï¼Œå®ƒä»¬å¯¹æ•°å­—è¿›è¡Œå¤šæ¬¡å˜æ¢ï¼Œä»¥æé«˜æœ€ç»ˆç»“æœçš„å‡†ç¡®æ€§ï¼Œè¾“å‡ºç”±ç¥ç»å…ƒçš„æ•°é‡æ¥å®šä¹‰ã€‚*
*   ***è¾“å‡ºå±‚**ï¼Œè¿”å›ç¥ç»ç½‘ç»œçš„æœ€ç»ˆè¾“å‡ºã€‚å¦‚æœæˆ‘ä»¬æ­£åœ¨åšä¸€ä¸ªç®€å•çš„äºŒè¿›åˆ¶åˆ†ç±»æˆ–å›å½’ï¼Œè¾“å‡ºå±‚å°†åªæœ‰ 1 ä¸ªç¥ç»å…ƒ(å› æ­¤å®ƒåªè¿”å› 1 ä¸ªæ•°å­—)ã€‚åœ¨å…·æœ‰ 5 ä¸ªä¸åŒç±»åˆ«çš„å¤šç±»åˆ«åˆ†ç±»çš„æƒ…å†µä¸‹ï¼Œè¾“å‡ºå±‚å°†å…·æœ‰ 5 ä¸ªç¥ç»å…ƒã€‚*

*ANN æœ€ç®€å•çš„å½¢å¼æ˜¯ [**æ„ŸçŸ¥å™¨**](https://en.wikipedia.org/wiki/Perceptron) ï¼Œä¸€ä¸ªåªæœ‰ä¸€å±‚çš„æ¨¡å‹ï¼Œéå¸¸ç±»ä¼¼äºçº¿æ€§å›å½’æ¨¡å‹ã€‚é—®æ„ŸçŸ¥å™¨å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆï¼Œç›¸å½“äºé—®å¤šå±‚ç¥ç»ç½‘ç»œçš„å•ä¸ªèŠ‚ç‚¹å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆâ€¦â€¦æˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹ã€‚*

*å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å« N è¡Œã€3 ä¸ªç‰¹å¾å’Œ 1 ä¸ªç›®æ ‡å˜é‡(å³äºŒè¿›åˆ¶ 1/0)çš„æ•°æ®é›†:*

*![](img/e4ce4b730be464ef2fdfd509b0a8359e.png)*

*å›¾ç‰‡ä½œè€…ã€‚æˆ‘åœ¨ 0 å’Œ 1 ä¹‹é—´æ”¾äº†ä¸€äº›éšæœºæ•°(æ•°æ®åœ¨è¢«è¾“å…¥ç¥ç»ç½‘ç»œä¹‹å‰åº”è¯¥æ€»æ˜¯è¢«ç¼©æ”¾)ã€‚*

*å°±åƒåœ¨æ‰€æœ‰å…¶ä»–æœºå™¨å­¦ä¹ ç”¨ä¾‹ä¸­ä¸€æ ·ï¼Œæˆ‘ä»¬å°†è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œä½¿ç”¨é€è¡Œçš„ç‰¹å¾æ¥é¢„æµ‹ç›®æ ‡ã€‚è®©æˆ‘ä»¬ä»ç¬¬ä¸€æ’å¼€å§‹:*

*![](img/fa503015f1e44f2cd5257d11b85b60e6.png)*

*ä½œè€…å›¾ç‰‡*

*â€œè®­ç»ƒä¸€ä¸ªæ¨¡ç‰¹â€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿåœ¨æ•°å­¦å…¬å¼ä¸­å¯»æ‰¾æœ€ä½³å‚æ•°ï¼Œä½¿é¢„æµ‹è¯¯å·®æœ€å°åŒ–ã€‚åœ¨å›å½’æ¨¡å‹(å³çº¿æ€§å›å½’)ä¸­ï¼Œæ‚¨å¿…é¡»æ‰¾åˆ°æœ€ä½³æƒé‡ï¼Œåœ¨åŸºäºæ ‘çš„æ¨¡å‹(å³éšæœºæ£®æ—)ä¸­ï¼Œè¿™æ˜¯å…³äºæ‰¾åˆ°æœ€ä½³åˆ†å‰²ç‚¹â€¦*

*![](img/9fc84f2260abc19c4811f4ecd92339c7.png)*

*ä½œè€…å›¾ç‰‡*

*é€šå¸¸ï¼Œæƒé‡æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œç„¶åéšç€å­¦ä¹ çš„è¿›è¡Œè¿›è¡Œè°ƒæ•´ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†æŠŠå®ƒä»¬éƒ½è®¾ç½®ä¸º 1:*

*![](img/1dbf110799bb54730f75889b438848bf.png)*

*ä½œè€…å›¾ç‰‡*

*åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰åšä»»ä½•ä¸åŒäºçº¿æ€§å›å½’çš„äº‹æƒ…(è¿™å¯¹äºä¼ä¸šæ¥è¯´å¾ˆå®¹æ˜“ç†è§£)ã€‚ç°åœ¨ï¼Œè¿™é‡Œæ˜¯ä»çº¿æ€§æ¨¡å‹***Ïƒ(****Xi * wi****)= Y***åˆ°éçº¿æ€§æ¨¡å‹**ã€Ïƒ(Xi * wi)****)= Yâ€¦***è¿›å…¥æ¿€æ´»åŠŸèƒ½ã€‚**

**![](img/57a965f51e3ddd24e8f1c54f634d3120.png)**

**ä½œè€…å›¾ç‰‡**

**æ¿€æ´»å‡½æ•°å®šä¹‰äº†è¯¥èŠ‚ç‚¹çš„è¾“å‡ºã€‚æœ‰å¾ˆå¤šï¼Œç”šè‡³å¯ä»¥åˆ›å»ºä¸€äº›è‡ªå®šä¹‰å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨[å®˜æ–¹æ–‡æ¡£](https://www.tensorflow.org/api_docs/python/tf/keras/activations)ä¸­æ‰¾åˆ°è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶çœ‹çœ‹è¿™ä¸ª[å¤‡å¿˜å•](https://en.wikipedia.org/wiki/Activation_function)ã€‚å¦‚æœæˆ‘ä»¬åœ¨ç¤ºä¾‹ä¸­è®¾ç½®ä¸€ä¸ªç®€å•çš„çº¿æ€§å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸çº¿æ€§å›å½’æ¨¡å‹æ²¡æœ‰åŒºåˆ«ã€‚**

**![](img/5e75070ca8fb7ad9909e6e5052096bf7.png)**

**æ¥æº:[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Activation_function)**

**æˆ‘å°†ä½¿ç”¨ä¸€ä¸ªåªè¿”å› 1 æˆ– 0 çš„äºŒè¿›åˆ¶æ­¥éª¤æ¿€æ´»å‡½æ•°:**

**![](img/0892dbc23e05216a07211c5201aa983c.png)**

**æ¥æº:[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Activation_function)**

**![](img/e24eb20762e2c467bfb12625ad4fcd8d.png)**

**ä½œè€…å›¾ç‰‡**

**æˆ‘ä»¬æœ‰æ„ŸçŸ¥å™¨çš„è¾“å‡ºï¼Œæ„ŸçŸ¥å™¨æ˜¯ä¸€ä¸ªå•å±‚ç¥ç»ç½‘ç»œï¼Œå®ƒæ¥å—ä¸€äº›è¾“å…¥å¹¶è¿”å› 1 ä¸ªè¾“å‡ºã€‚ç°åœ¨ï¼Œæ¨¡å‹çš„è®­ç»ƒå°†é€šè¿‡å°†è¾“å‡ºä¸ç›®æ ‡è¿›è¡Œæ¯”è¾ƒã€è®¡ç®—è¯¯å·®å’Œä¼˜åŒ–æƒé‡æ¥ç»§ç»­ï¼Œä¸€æ¬¡åˆä¸€æ¬¡åœ°é‡å¤æ•´ä¸ªè¿‡ç¨‹ã€‚**

**![](img/0eac93f7b335f819fa1b57de1e391c86.png)**

**ä½œè€…å›¾ç‰‡**

**è¿™æ˜¯ä¸€ä¸ªç¥ç»å…ƒçš„å¸¸è§è¡¨ç°:**

**![](img/49b9584c15185ef4b8e48f669ed2881f.png)**

**ä½œè€…å›¾ç‰‡**

## **æ·±åº¦ç¥ç»ç½‘ç»œ**

**å¯ä»¥è¯´æ‰€æœ‰çš„æ·±åº¦å­¦ä¹ æ¨¡å‹éƒ½æ˜¯ç¥ç»ç½‘ç»œï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¥ç»ç½‘ç»œéƒ½æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œâ€œæ·±åº¦â€å­¦ä¹ é€‚ç”¨äºç®—æ³•è‡³å°‘æœ‰ 2 ä¸ªéšè—å±‚çš„æƒ…å†µ(æ‰€ä»¥åŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºæ€»å…±æœ‰ 4 å±‚)ã€‚**

**æƒ³è±¡åŒæ—¶å¤åˆ¶ç¥ç»å…ƒè¿‡ç¨‹ 3 æ¬¡:ç”±äºæ¯ä¸ªèŠ‚ç‚¹(åŠ æƒå’Œ&æ¿€æ´»å‡½æ•°)è¿”å›ä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬å°†æœ‰ç¬¬**ä¸ªéšè—å±‚**æœ‰ 3 ä¸ªè¾“å‡ºã€‚**

**![](img/b227e4bda32815580a5db1ebb2148d6b.png)**

**ä½œè€…å›¾ç‰‡**

**ç°åœ¨è®©æˆ‘ä»¬å†æ¬¡ä½¿ç”¨è¿™ 3 ä¸ªè¾“å‡ºä½œä¸ºç¬¬äºŒä¸ªéšè—å±‚**çš„è¾“å…¥ï¼Œè¿”å› 3 ä¸ªæ–°æ•°å­—ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ª**è¾“å‡ºå±‚**(ä»… 1 ä¸ªèŠ‚ç‚¹)æ¥è·å¾—æˆ‘ä»¬æ¨¡å‹çš„æœ€ç»ˆé¢„æµ‹ã€‚****

**![](img/f8dd4f3711c8761d61d8557b61737203.png)**

**ä½œè€…å›¾ç‰‡**

**è¯·è®°ä½ï¼Œè¿™äº›å±‚å¯ä»¥æœ‰ä¸åŒæ•°é‡çš„ç¥ç»å…ƒå’Œä¸åŒçš„æ¿€æ´»å‡½æ•°ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­ï¼Œè®­ç»ƒæƒé‡ä»¥ä¼˜åŒ–æœ€ç»ˆç»“æœã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ·»åŠ çš„å±‚æ•°è¶Šå¤šï¼Œå¯è®­ç»ƒå‚æ•°çš„æ•°é‡å°±è¶Šå¤§ã€‚**

**ç°åœ¨ä½ å¯ä»¥å›é¡¾ä¸€ä¸‹ç¥ç»ç½‘ç»œçš„å…¨è²Œ:**

**![](img/db79055f69c2f2ccadd9349f26be6275.png)**

**ä½œè€…å›¾ç‰‡**

**è¯·æ³¨æ„ï¼Œä¸ºäº†å°½å¯èƒ½ä¿æŒç®€å•ï¼Œæˆ‘æ²¡æœ‰æåˆ°ä¸šåŠ¡å¯èƒ½ä¸æ„Ÿå…´è¶£çš„æŸäº›ç»†èŠ‚ï¼Œä½†æ•°æ®ç§‘å­¦å®¶è‚¯å®šåº”è¯¥çŸ¥é“ã€‚ç‰¹åˆ«æ˜¯:**

*   ****åå·®**:åœ¨æ¯ä¸ªç¥ç»å…ƒå†…éƒ¨ï¼Œè¾“å…¥å’Œæƒé‡çš„çº¿æ€§ç»„åˆä¹ŸåŒ…æ‹¬åå·®ï¼Œç±»ä¼¼äºçº¿æ€§æ–¹ç¨‹ä¸­çš„å¸¸æ•°ï¼Œå› æ­¤ç¥ç»å…ƒçš„å®Œæ•´å…¬å¼ä¸º**

> *****ã€fã€‘(****ã€Xi * Wiã€‘+åç½®* ***)*****

*   ****åå‘ä¼ æ’­**:åœ¨è®­ç»ƒæœŸé—´ï¼Œæ¨¡å‹é€šè¿‡å°†è¯¯å·®ä¼ æ’­å›èŠ‚ç‚¹å¹¶æ›´æ–°å‚æ•°(æƒé‡å’Œåå·®)æ¥å­¦ä¹ ï¼Œä»¥æœ€å°åŒ–æŸå¤±ã€‚**

**![](img/567653325789dfe89cf4bd7245d4afb1.png)**

**æ¥æº: [3Blue1Brown (Youtube)](https://www.youtube.com/watch?v=Ilg3gGewQ5U)**

*   ****æ¢¯åº¦ä¸‹é™**:ç”¨äºè®­ç»ƒç¥ç»ç½‘ç»œçš„ä¼˜åŒ–ç®—æ³•ï¼Œè¯¥ç®—æ³•é€šè¿‡åœ¨æœ€é™¡ä¸‹é™æ–¹å‘ä¸Šé‡‡å–é‡å¤æ­¥éª¤æ¥æ‰¾åˆ°æŸå¤±å‡½æ•°çš„å±€éƒ¨æœ€å°å€¼ã€‚**

**![](img/e8ba7e4b11859dc2b22e8b991716f02b.png)**

**æ¥æº: [3Blue1Brown (Youtube](https://www.youtube.com/watch?v=IHZwWFHWa-w)**

## **æ¨¡å‹è®¾è®¡**

**ç”¨ *TensorFlow* æ„å»ºç¥ç»ç½‘ç»œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ç”¨ *Keras çš„ ***åºåˆ—*** ç±»ã€‚*è®©æˆ‘ä»¬ç”¨å®ƒæ¥åˆ¶ä½œæˆ‘ä»¬ä¹‹å‰ä¾‹å­ä¸­çš„æ„ŸçŸ¥å™¨ï¼Œè¿™æ ·ä¸€ä¸ªåªæœ‰ä¸€ä¸ª**å¯†é›†å±‚çš„æ¨¡å‹ã€‚**å®ƒæ˜¯æœ€åŸºæœ¬çš„å±‚ï¼Œå› ä¸ºå®ƒå‘æ‰€æœ‰ç¥ç»å…ƒæä¾›æ‰€æœ‰è¾“å…¥ï¼Œæ¯ä¸ªç¥ç»å…ƒæä¾›ä¸€ä¸ªè¾“å‡ºã€‚**

```
*model = models.**Sequential**(name="**Perceptron**", layers=[ layers.**Dense**(             **#a fully connected layer**
          name="dense",
          input_dim=3,        **#with 3 features as the input**
          units=1,            **#and 1 node because we want 1 output**
          activation='linear' **#f(x)=x**
    )
])
model.summary()*
```

*![](img/4210cf9565411045cf49d34900c203fd.png)*

*ä½œè€…å›¾ç‰‡*

*summary å‡½æ•°æä¾›äº†ç»“æ„å’Œå¤§å°çš„å¿«ç…§(æ ¹æ®è¦è®­ç»ƒçš„å‚æ•°)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæœ‰ 4 ä¸ª(3 ä¸ªæƒé‡å’Œ 1 ä¸ªåå·®)ï¼Œæ‰€ä»¥å®ƒéå¸¸ç²¾ç®€ã€‚*

*å¦‚æœä½ æƒ³ä½¿ç”¨ä¸€ä¸ªè¿˜æ²¡æœ‰åŒ…å«åœ¨ *Keras* ä¸­çš„æ¿€æ´»å‡½æ•°ï¼Œæ¯”å¦‚æˆ‘åœ¨å¯è§†åŒ–ç¤ºä¾‹ä¸­å±•ç¤ºçš„*äºŒè¿›åˆ¶æ­¥éª¤*å‡½æ•°ï¼Œä½ å¿…é¡»ä½¿ç”¨ raw *TensorFlow:**

```
***# define the function**
import **tensorflow** as tfdef **binary_step_activation**(x):
    **##return 1 if x>0 else 0** 
    return **K**.switch(x>0, **tf**.math.divide(x,x), **tf**.math.multiply(x,0)) **# build the model**
model = models.Sequential(name="Perceptron", layers=[
      layers.Dense(             
          name="dense",
          input_dim=3,        
          units=1,            
          activation=**binary_step_activation**
      )
])*
```

*ç°åœ¨è®©æˆ‘ä»¬å°è¯•ä»æ„ŸçŸ¥å™¨è½¬ç§»åˆ°æ·±åº¦ç¥ç»ç½‘ç»œã€‚ä¹Ÿè®¸ä½ ä¼šé—®è‡ªå·±ä¸€äº›é—®é¢˜:*

1.  ***å¤šå°‘å±‚ï¼Ÿ**æ­£ç¡®ç­”æ¡ˆæ˜¯â€œå°è¯•ä¸åŒçš„å˜ä½“ï¼Œçœ‹çœ‹ä»€ä¹ˆæœ‰æ•ˆâ€ã€‚æˆ‘é€šå¸¸ä½¿ç”¨ä¸¤ä¸ªå¸¦æœ‰ *Dropoutã€*çš„å¯†é›†éšè—å±‚ï¼Œè¿™æ˜¯ä¸€ç§é€šè¿‡å°†è¾“å…¥éšæœºè®¾ç½®ä¸º 0 æ¥å‡å°‘è¿‡åº¦æ‹Ÿåˆçš„æŠ€æœ¯ã€‚éšè—å±‚å¯¹äºå…‹æœæ•°æ®çš„éçº¿æ€§å¾ˆæœ‰ç”¨ï¼Œæ‰€ä»¥å¦‚æœä½ ä¸éœ€è¦*éçº¿æ€§*ï¼Œé‚£ä¹ˆä½ å¯ä»¥é¿å…éšè—å±‚ã€‚éšè—å±‚å¤ªå¤šä¼šå¯¼è‡´è¿‡æ‹Ÿåˆã€‚*

*![](img/bdbbe557407b5417dfa4aa80e78a9aae.png)*

*ä½œè€…å›¾ç‰‡*

1.  ***æœ‰å¤šå°‘ç¥ç»å…ƒï¼Ÿ**éšç¥ç»å…ƒçš„æ•°é‡åº”è¯¥åœ¨è¾“å…¥å±‚çš„å¤§å°å’Œè¾“å‡ºå±‚çš„å¤§å°ä¹‹é—´ã€‚æˆ‘çš„ç»éªŒæ³•åˆ™æ˜¯*(è¾“å…¥æ•°+ 1 è¾“å‡º)/2* ã€‚*
2.  ***ä»€ä¹ˆæ¿€æ´»åŠŸèƒ½ï¼Ÿæœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬ä¸èƒ½è¯´æœ‰ä¸€ä¸ªæ˜¯ç»å¯¹æ›´å¥½çš„ã€‚åæ­£ç”¨çš„æœ€å¤šçš„æ˜¯ *ReLU* ï¼Œä¸€ä¸ªåˆ†æ®µçº¿æ€§å‡½æ•°ï¼Œåªåœ¨è¾“å‡ºä¸ºæ­£çš„æƒ…å†µä¸‹è¿”å›è¾“å‡ºï¼Œä¸»è¦ç”¨äºéšè—å±‚ã€‚æ­¤å¤–ï¼Œè¾“å‡ºå±‚å¿…é¡»å…·æœ‰ä¸é¢„æœŸè¾“å‡ºå…¼å®¹çš„æ¿€æ´»ã€‚ä¾‹å¦‚ï¼Œ*çº¿æ€§*å‡½æ•°é€‚ç”¨äºå›å½’é—®é¢˜ï¼Œè€Œ *Sigmoid* å¸¸ç”¨äºåˆ†ç±»ã€‚***

*![](img/238d716eda766fbaed3ff57e9ea9b014.png)*

*æ¥æº:[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Activation_function)*

*æˆ‘å°†å‡è®¾ä¸€ä¸ªåŒ…å« N ä¸ªè¦ç´ å’Œ 1 ä¸ªäºŒå…ƒç›®æ ‡å˜é‡çš„è¾“å…¥æ•°æ®é›†(æœ€æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªåˆ†ç±»ç”¨ä¾‹)ã€‚*

```
*n_features = 10model = models.**Sequential**(name="**DeepNN**", layers=[
    **### hidden layer 1**
    layers.**Dense**(name="h1", input_dim=n_features,
                 units=int(round((n_features+1)/2)), 
                 activation='relu'),
    layers.**Dropout**(name="drop1", rate=0.2),

    **### hidden layer 2**
    layers.**Dense**(name="h2", units=int(round((n_features+1)/4)), 
                 activation='relu'),
    layers.**Dropout**(name="drop2", rate=0.2),

    **### layer output**
    layers.**Dense**(name="output", units=1, activation='sigmoid')
])
model.summary()*
```

*![](img/b5a3314c44d9724690e992a92c1b4d9e.png)*

*ä½œè€…å›¾ç‰‡*

*è¯·æ³¨æ„ï¼Œ*é¡ºåº*ç±»å¹¶ä¸æ˜¯ç”¨ *Keras* æ„å»ºç¥ç»ç½‘ç»œçš„å”¯ä¸€æ–¹æ³•ã€‚ ***æ¨¡å‹*** ç±»æä¾›äº†æ›´å¤šçš„çµæ´»æ€§å’Œå¯¹å±‚çš„æ§åˆ¶ï¼Œå®ƒå¯ä»¥ç”¨æ¥æ„å»ºå…·æœ‰å¤šä¸ªè¾“å…¥/è¾“å‡ºçš„æ›´å¤æ‚çš„æ¨¡å‹ã€‚æœ‰ä¸¤ä¸ªä¸»è¦åŒºåˆ«:*

*   *éœ€è¦æŒ‡å®šè¾“å…¥å±‚ï¼Œè€Œåœ¨*é¡ºåº*ç±»ä¸­ï¼Œå®ƒéšå«åœ¨ç¬¬ä¸€ä¸ªå¯†é›†å±‚çš„è¾“å…¥ç»´åº¦ä¸­ã€‚*
*   *è¿™äº›å±‚åƒå¯¹è±¡ä¸€æ ·ä¿å­˜ï¼Œå¹¶å¯åº”ç”¨äºå…¶ä»–å±‚çš„è¾“å‡ºï¼Œå¦‚:*è¾“å‡º=å±‚(â€¦)(è¾“å…¥)**

*è¿™å°±æ˜¯ä½ å¦‚ä½•ä½¿ç”¨*æ¨¡å‹*ç±»æ¥æ„å»ºæˆ‘ä»¬çš„æ„ŸçŸ¥å™¨å’Œ DeepNN:*

```
***# Perceptron**
inputs = layers.**Input**(name="input", shape=(3,))
outputs = layers.**Dense**(name="output", units=1, 
                       activation='linear')(inputs)
model = models.**Model**(inputs=inputs, outputs=outputs, 
                     name="**Perceptron**") **# DeepNN**
**### layer input**
inputs = layers.**Input**(name="input", shape=(n_features,))**### hidden layer 1**
h1 = layers.**Dense**(name="h1", units=int(round((n_features+1)/2)), activation='relu')(inputs)
h1 = layers.**Dropout**(name="drop1", rate=0.2)(h1)**### hidden layer 2**
h2 = layers.**Dense**(name="h2", units=int(round((n_features+1)/4)), activation='relu')(h1)
h2 = layers.**Dropout**(name="drop2", rate=0.2)(h2)**### layer output**
outputs = layers.**Dense**(name="output", units=1, activation='sigmoid')(h2)model = models.**Model**(inputs=inputs, outputs=outputs, name="**DeepNN**")*
```

*ç”¨æˆ·å¯ä»¥éšæ—¶æ£€æŸ¥æ¨¡å‹æ‘˜è¦ä¸­çš„å‚æ•°æ•°é‡æ˜¯å¦ä¸*åºåˆ—*ä¸­çš„å‚æ•°æ•°é‡ç›¸åŒã€‚*

## *å½¢è±¡åŒ–*

*è¯·è®°ä½ï¼Œæˆ‘ä»¬æ˜¯åœ¨å‘ä¼ä¸šè®²è¿°ä¸€ä¸ªæ•…äº‹ï¼Œè€Œå¯è§†åŒ–æ˜¯æˆ‘ä»¬æœ€å¥½çš„ç›Ÿå‹ã€‚æˆ‘å‡†å¤‡äº†ä¸€ä¸ªå‡½æ•°æ¥ä»å®ƒçš„ *TensorFlow* æ¨¡å‹ç»˜åˆ¶äººå·¥ç¥ç»ç½‘ç»œçš„ç»“æ„ï¼Œä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç :*

*è®©æˆ‘ä»¬åœ¨ä¸¤ä¸ªæ¨¡å‹ä¸Šè¯•è¯•ï¼Œé¦–å…ˆæ˜¯æ„ŸçŸ¥æœº:*

```
***visualize_nn**(model, description=True, figsize=(10,8))*
```

*![](img/96d5d72d9721c269aa7ecdf7f5bea728.png)*

*ä½œè€…å›¾ç‰‡*

*ç„¶åæ˜¯æ·±å±‚ç¥ç»ç½‘ç»œ:*

*![](img/95aca6dfb29dc9c2dd27132fbc76968d.png)*

*ä½œè€…å›¾ç‰‡*

**TensorFlow* ä¹Ÿæä¾›äº†ä¸€ä¸ªç»˜åˆ¶æ¨¡å‹ç»“æ„çš„å·¥å…·ï¼Œä½ å¯èƒ½æƒ³æŠŠå®ƒç”¨äºæ›´å¤æ‚çš„ç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬æ›´å¤æ‚çš„å±‚(CNNï¼ŒRNNï¼Œâ€¦)ã€‚æœ‰æ—¶å€™è®¾ç½®èµ·æ¥æœ‰ç‚¹æ£˜æ‰‹ï¼Œå¦‚æœä½ æœ‰é—®é¢˜[è¿™ç¯‡æ–‡ç« ](https://stackoverflow.com/questions/47605558/importerror-failed-to-import-pydot-you-must-install-pydot-and-graphviz-for-py)å¯èƒ½ä¼šæœ‰å¸®åŠ©ã€‚*

```
*utils.**plot_model**(model, to_file='model.png', show_shapes=True, show_layer_names=True)*
```

*![](img/54f1160d7ff1e1e7001ff4c66f12a14a.png)*

*ä½œè€…å›¾ç‰‡*

*è¿™ä¼šå°†è¯¥å›¾åƒä¿å­˜åœ¨æ‚¨çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨åªæƒ³åœ¨ç¬”è®°æœ¬ä¸Šç»˜åˆ¶å®ƒï¼Œæ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ é™¤è¯¥æ–‡ä»¶:*

```
*import **os**
os.remove('model.png')*
```

## *åŸ¹è®­å’Œæµ‹è¯•*

*æœ€åï¼Œæ˜¯æ—¶å€™è®­ç»ƒæˆ‘ä»¬çš„æ·±åº¦å­¦ä¹ æ¨¡å‹äº†ã€‚ä¸ºäº†è®©å®ƒè¿è¡Œï¼Œæˆ‘ä»¬å¿…é¡»â€œç¼–è¯‘â€ï¼Œæˆ–è€…æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰**ä¼˜åŒ–å™¨ã€**æŸå¤±å‡½æ•°ã€å’Œ**æŒ‡æ ‡**ã€‚æˆ‘é€šå¸¸ä½¿ç”¨*äºšå½“*ä¼˜åŒ–å™¨ï¼Œä¸€ç§æ¢¯åº¦ä¸‹é™çš„æ›¿ä»£ä¼˜åŒ–ç®—æ³•(è‡ªé€‚åº”ä¼˜åŒ–å™¨ä¸­æœ€å¥½çš„)ã€‚å…¶ä»–å‚æ•°å–å†³äºç”¨ä¾‹ã€‚*

*åœ¨(äºŒè¿›åˆ¶)åˆ†ç±»é—®é¢˜ä¸­ï¼Œä½ åº”è¯¥ä½¿ç”¨(*äºŒè¿›åˆ¶)äº¤å‰ç†µ*æŸå¤±æ¥æ¯”è¾ƒæ¯ä¸ªé¢„æµ‹çš„æ¦‚ç‡å’Œå®é™…çš„ç±»è¾“å‡ºã€‚è‡³äºæŒ‡æ ‡ï¼Œæˆ‘å–œæ¬¢åŒæ—¶ç›‘æ§*ç²¾ç¡®åº¦*å’Œ *F1 åˆ†æ•°*ï¼Œè¿™æ˜¯ä¸€ä¸ªç»“åˆäº†*ç²¾ç¡®åº¦*å’Œ*å¬å›*çš„æŒ‡æ ‡(åè€…å¿…é¡»å®ç°ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æœ‰åŒ…å«åœ¨ *TensorFlow* ä¸­)ã€‚*

```
***# define metrics**
def **Recall**(y_true, y_pred):
    true_positives = **K**.sum(**K**.round(**K**.clip(y_true * y_pred, 0, 1)))
    possible_positives = **K**.sum(**K**.round(**K**.clip(y_true, 0, 1)))
    recall = true_positives / (possible_positives + **K**.epsilon())
    return recall

def **Precision**(y_true, y_pred):
    true_positives = **K**.sum(**K**.round(**K**.clip(y_true * y_pred, 0, 1)))
    predicted_positives = **K**.sum(**K**.round(**K**.clip(y_pred, 0, 1)))
    precision = true_positives / (predicted_positives + **K**.epsilon())
    return precision

def **F1**(y_true, y_pred):
    precision = Precision(y_true, y_pred)
    recall = Recall(y_true, y_pred)
    return 2*((precision*recall)/(precision+recall+**K**.epsilon())) **# compile the neural network** model.compile(optimizer='**adam**', loss='**binary_crossentropy**', 
              metrics=[**'accuracy',F1**])*
```

*å¦ä¸€æ–¹é¢ï¼Œåœ¨å›å½’é—®é¢˜ä¸­ï¼Œæˆ‘é€šå¸¸å°† *MAE* è®¾ä¸ºæŸå¤±ï¼Œå°† *R å¹³æ–¹*è®¾ä¸ºåº¦é‡ã€‚*

```
***# define metrics**
def **R2**(y, y_hat):
    ss_res =  **K**.sum(K.square(y - y_hat)) 
    ss_tot = **K**.sum(K.square(y - **K**.mean(y))) 
    return ( 1 - ss_res/(ss_tot + **K**.epsilon()) ) **# compile the neural network** model.compile(optimizer='**adam**', loss='**mean_absolute_error**', 
              metrics=[**R2**])*
```

*åœ¨å¼€å§‹è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å†³å®š**æ—¶æœŸ**å’Œ**æ‰¹æ¬¡**:ç”±äºæ•°æ®é›†å¯èƒ½å¤ªå¤§è€Œæ— æ³•ä¸€æ¬¡å¤„ç†å®Œï¼Œæ‰€ä»¥å°†å…¶åˆ†æˆæ‰¹æ¬¡(æ‰¹æ¬¡å¤§å°è¶Šå¤§ï¼Œéœ€è¦çš„å†…å­˜ç©ºé—´å°±è¶Šå¤§)ã€‚åå‘ä¼ æ’­å’Œéšä¹‹è€Œæ¥çš„å‚æ•°æ›´æ–°åœ¨æ¯æ‰¹ä¸­éƒ½å‘ç”Ÿã€‚ä¸€ä¸ªæ—¶æœŸæ˜¯æ•´ä¸ªè®­ç»ƒé›†çš„ä¸€ä¸ªé˜¶æ®µã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨æœ‰ 100 ä¸ªè§‚å¯Ÿå€¼ï¼Œå¹¶ä¸”æ‰¹å¤§å°ä¸º 20ï¼Œåˆ™éœ€è¦ 5 ä¸ªæ‰¹æ¥å®Œæˆ 1 ä¸ªå†å…ƒã€‚æ‰¹é‡å¤§å°åº”è¯¥æ˜¯ 2 çš„å€æ•°(å¸¸è§çš„æ˜¯:32ã€64ã€128ã€256)ï¼Œå› ä¸ºè®¡ç®—æœºé€šå¸¸ä»¥ 2 çš„å¹‚æ¥ç»„ç»‡å†…å­˜ã€‚æˆ‘å€¾å‘äºä» 100 ä¸ª epochs å¼€å§‹ï¼Œæ‰¹é‡å¤§å°ä¸º 32ã€‚*

*åœ¨åŸ¹è®­æœŸé—´ï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°æŒ‡æ ‡ä¸æ–­æ”¹è¿›ï¼ŒæŸå¤±ä¸æ–­å‡å°‘ã€‚æ­¤å¤–ï¼Œæœ€å¥½ä¿ç•™ä¸€éƒ¨åˆ†æ•°æ®(20%-30%)ç”¨äº**éªŒè¯ã€‚**æ¢å¥è¯è¯´ï¼Œåœ¨è®­ç»ƒä¹‹å¤–ï¼Œæ¨¡å‹å°†åœ¨æ¯ä¸ªæ—¶æœŸç»“æŸæ—¶å°†è¿™éƒ¨åˆ†æ•°æ®åˆ†ç¦»å‡ºæ¥ä»¥è¯„ä¼°æŸå¤±å’ŒæŒ‡æ ‡ã€‚*

*å‡è®¾æ‚¨å·²ç»å°†æ•°æ®å‡†å¤‡å¥½æ”¾å…¥ä¸€äº› *X* å’Œ *y* æ•°ç»„ä¸­(å¦‚æœæ²¡æœ‰ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ç”Ÿæˆéšæœºæ•°æ®ï¼Œå¦‚*

```
*import **numpy** as npX = np.random.rand(1000,10)
y = np.random.choice([1,0], size=1000)*
```

*)ï¼Œæ‚¨å¯ä»¥å¯åŠ¨å¹¶å¯è§†åŒ–åŸ¹è®­ï¼Œå¦‚ä¸‹æ‰€ç¤º:*

```
***# train/validation**
training = model.fit(x=X, y=y, batch_size=32, epochs=100, shuffle=True, verbose=0, validation_split=0.3) **# plot** metrics = [k for k in training.history.keys() if ("loss" not in k) and ("val" not in k)]    
fig, ax = plt.subplots(nrows=1, ncols=2, sharey=True, figsize=(15,3))

**## training**    
ax[0].set(title="Training")    
ax11 = ax[0].twinx()    
ax[0].plot(training.history['loss'], color='black')    ax[0].set_xlabel('Epochs')    
ax[0].set_ylabel('Loss', color='black')    
for metric in metrics:        
    ax11.plot(training.history[metric], label=metric)    ax11.set_ylabel("Score", color='steelblue')    
ax11.legend()

**## validation**    
ax[1].set(title="Validation")    
ax22 = ax[1].twinx()    
ax[1].plot(training.history['val_loss'], color='black')    ax[1].set_xlabel('Epochs')    
ax[1].set_ylabel('Loss', color='black')    
for metric in metrics:          
    ax22.plot(training.history['val_'+metric], label=metric)    ax22.set_ylabel("Score", color="steelblue")    
plt.show()*
```

*![](img/4e4c86bcd13d1a0c830e95f712afadc4.png)*

*å›¾ç‰‡ä½œè€…ã€‚åˆ†ç±»ä¸¾ä¾‹ï¼Œ[ç¬”è®°æœ¬æ­¤å¤„](https://github.com/mdipietro09/DataScience_ArtificialIntelligence_Utils/blob/master/machine_learning/example_classification.ipynb)*

*![](img/088a07ece48700a835d2cee8e47d1013.png)*

*å›¾ç‰‡ä½œè€…ã€‚å›å½’ç¤ºä¾‹ï¼Œ[ç¬”è®°æœ¬æ­¤å¤„](https://github.com/mdipietro09/DataScience_ArtificialIntelligence_Utils/blob/master/machine_learning/example_regression.ipynb)*

*è¿™äº›å›¾å–è‡ªä¸¤ä¸ªå®é™…çš„ç”¨ä¾‹ï¼Œå®ƒä»¬å°†æ ‡å‡†çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¸ç¥ç»ç½‘ç»œè¿›è¡Œäº†æ¯”è¾ƒ(æ¯ä¸ªå›¾åƒä¸‹çš„é“¾æ¥)ã€‚*

## *å¯è§£é‡Šæ€§*

*æˆ‘ä»¬è®­ç»ƒå’Œæµ‹è¯•äº†æˆ‘ä»¬çš„æ¨¡å‹ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶æ²¡æœ‰è®©ä¼ä¸šç›¸ä¿¡ç»“æœâ€¦æˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªè§£é‡Šå™¨æ¥è¡¨æ˜æˆ‘ä»¬çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸æ˜¯ä¸€ä¸ªé»‘ç›’ã€‚*

*æˆ‘å‘ç°[***Shap***](https://shap.readthedocs.io/en/latest/index.html)*ä¸ç¥ç»ç½‘ç»œé…åˆå¾—éå¸¸å¥½:å¯¹äºæ¯ä¸€ä¸ªé¢„æµ‹ï¼Œå®ƒèƒ½å¤Ÿä¼°è®¡æ¯ä¸ªç‰¹å¾å¯¹æ¨¡å‹é¢„æµ‹å€¼çš„è´¡çŒ®ã€‚åŸºæœ¬ä¸Šå›ç­”äº†é—®é¢˜â€œ*ä¸ºä»€ä¹ˆæ¨¡å‹è¯´è¿™æ˜¯ 1 è€Œä¸æ˜¯ 0ï¼Ÿ*â€ã€‚**

**æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç :**

**è¯·æ³¨æ„ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨å…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹ä¸Šä½¿ç”¨è¯¥å‡½æ•°(å³çº¿æ€§å›å½’ã€éšæœºæ£®æ—)ï¼Œè€Œä¸ä»…ä»…æ˜¯ç¥ç»ç½‘ç»œã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœ *X_train* å‚æ•°ä¿æŒä¸º *Noneï¼Œ*æˆ‘çš„å‡½æ•°å‡è®¾å®ƒä¸æ˜¯æ·±åº¦å­¦ä¹ ã€‚**

**è®©æˆ‘ä»¬åœ¨åˆ†ç±»å’Œå›å½’ç¤ºä¾‹ä¸­æµ‹è¯•ä¸€ä¸‹:**

```
**i = 1explainer_shap(model, 
               X_names=list_feature_names, 
               X_instance=X[i], 
               X_train=X, 
               task="**classification**", **#task="regression"**
               top=10)**
```

**![](img/41d2b3bf33885381d04d4bcae9e81f2b.png)**

**å›¾ç‰‡ä½œè€…ã€‚åˆ†ç±»ä¸¾ä¾‹ï¼Œ[ç¬”è®°æœ¬æ­¤å¤„](https://github.com/mdipietro09/DataScience_ArtificialIntelligence_Utils/blob/master/machine_learning/example_classification.ipynb)ã€‚æ³°å¦å°¼å…‹å·æ•°æ®é›†ï¼Œé¢„æµ‹æ˜¯â€œå¹¸å­˜â€ä¸»è¦æ˜¯å› ä¸ºå“‘å˜é‡ Sex_male = 0ï¼Œæ‰€ä»¥ä¹˜å®¢æ˜¯å¥³çš„ã€‚**

**![](img/b310ce34f805b0b89467cd1af3c58003.png)**

**å›¾ç‰‡ä½œè€…ã€‚å›å½’ä¸¾ä¾‹ï¼Œ[ç¬”è®°æœ¬æ­¤å¤„](https://github.com/mdipietro09/DataScience_ArtificialIntelligence_Utils/blob/master/machine_learning/example_regression.ipynb)ã€‚æˆ¿ä»·æ•°æ®é›†ï¼Œè¿™ä¸ªæˆ¿ä»·çš„ä¸»è¦é©±åŠ¨åŠ›æ˜¯ä¸€ä¸ªå¤§çš„åœ°ä¸‹å®¤ã€‚**

## **ç»“è®º**

**è¿™ç¯‡æ–‡ç« æ˜¯ä¸€ä¸ªæ•™ç¨‹ï¼Œå±•ç¤ºäº†**å¦‚ä½•è®¾è®¡å’Œå»ºç«‹äººå·¥ç¥ç»ç½‘ç»œï¼Œæ·±åº¦å’Œéæ·±åº¦ã€‚**æˆ‘ä¸€æ­¥ä¸€æ­¥åœ°åˆ†è§£äº†å•ä¸ªç¥ç»å…ƒå†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œä»¥åŠæ›´æ™®éçš„å„å±‚å†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚æˆ‘è®©æ•…äº‹ä¿æŒç®€å•ï¼Œå°±å¥½åƒæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨å¤§é‡çš„å¯è§†åŒ–æŠ€æœ¯å‘ä¼ä¸šè§£é‡Šæ·±åº¦å­¦ä¹ ä¸€æ ·ã€‚**

**åœ¨æ•™ç¨‹çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨ *TensorFlow* åˆ›å»ºäº†ä¸€äº›ç¥ç»ç½‘ç»œï¼Œä»æ„ŸçŸ¥å™¨åˆ°æ›´å¤æ‚çš„ç¥ç»ç½‘ç»œã€‚ç„¶åï¼Œæˆ‘ä»¬è®­ç»ƒäº†æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå¹¶è¯„ä¼°äº†å®ƒå¯¹åˆ†ç±»å’Œå›å½’ç”¨ä¾‹çš„è§£é‡Šèƒ½åŠ›ã€‚**

**æˆ‘å¸Œæœ›ä½ å–œæ¬¢å®ƒï¼å¦‚æœ‰é—®é¢˜å’Œåé¦ˆï¼Œæˆ–è€…åªæ˜¯åˆ†äº«æ‚¨æ„Ÿå…´è¶£çš„é¡¹ç›®ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ã€‚**

> **ğŸ‘‰[æˆ‘ä»¬æ¥è¿çº¿](https://linktr.ee/maurodp)ğŸ‘ˆ**

> **æœ¬æ–‡æ˜¯ä½¿ç”¨ Python è¿›è¡Œæœºå™¨å­¦ä¹ çš„ç³»åˆ—æ–‡ç« **çš„ä¸€éƒ¨åˆ†ï¼Œå‚è§:****

**[](/machine-learning-with-python-classification-complete-tutorial-d2c99dc524ec) [## ç”¨ Python è¿›è¡Œæœºå™¨å­¦ä¹ :åˆ†ç±»(å®Œæ•´æ•™ç¨‹)

### æ•°æ®åˆ†æå’Œå¯è§†åŒ–ã€ç‰¹å¾å·¥ç¨‹å’Œé€‰æ‹©ã€æ¨¡å‹è®¾è®¡å’Œæµ‹è¯•ã€è¯„ä¼°å’Œè§£é‡Š

towardsdatascience.com](/machine-learning-with-python-classification-complete-tutorial-d2c99dc524ec) [](/machine-learning-with-python-regression-complete-tutorial-47268e546cea) [## Python æœºå™¨å­¦ä¹ :å›å½’(å®Œæ•´æ•™ç¨‹)

### æ•°æ®åˆ†æå’Œå¯è§†åŒ–ã€ç‰¹å¾å·¥ç¨‹å’Œé€‰æ‹©ã€æ¨¡å‹è®¾è®¡å’Œæµ‹è¯•ã€è¯„ä¼°å’Œè§£é‡Š

towardsdatascience.com](/machine-learning-with-python-regression-complete-tutorial-47268e546cea) [](/clustering-geospatial-data-f0584f0b04ec) [## èšç±»åœ°ç†ç©ºé—´æ•°æ®

### ä½¿ç”¨äº¤äº’å¼åœ°å›¾ç»˜åˆ¶æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ èšç±»

towardsdatascience.com](/clustering-geospatial-data-f0584f0b04ec) [](/modern-recommendation-systems-with-neural-networks-3cc06a6ded2c) [## åŸºäºç¥ç»ç½‘ç»œçš„ç°ä»£æ¨èç³»ç»Ÿ

### ä½¿ç”¨ Python å’Œ TensorFlow æ„å»ºæ··åˆæ¨¡å‹

towardsdatascience.com](/modern-recommendation-systems-with-neural-networks-3cc06a6ded2c)**