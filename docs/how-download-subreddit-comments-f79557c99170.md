# å¦‚ä½•ä¸‹è½½å­ç¼–è¾‘è¯„è®º

> åŸæ–‡ï¼š<https://towardsdatascience.com/how-download-subreddit-comments-f79557c99170?source=collection_archive---------22----------------------->

![](img/d16108002d775faa626f61ad7d3c383b.png)

å®‰å¦®Â·æ–¯æ™®æ‹‰ç‰¹åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

ä» NLP å’Œåˆ†æä»»åŠ¡çš„ç‰¹å®šå­ç¼–è¾‘ä¸­ä¸‹è½½æ‰€æœ‰è¯„è®ºã€‚ğŸ–‡github:[pistocop/subreddit-comments-dl](https://github.com/pistocop/subreddit-comments-dl)

> è¿™ä¸ªæ•…äº‹æ˜¯ä¸€ä¸ªæ›´å¤§é¡¹ç›®çš„ä¸€éƒ¨åˆ†:â€œåˆ©ç”¨ Reddit è¯„è®ºå’Œ ML æŠ€æœ¯åˆ›å»ºä¸€ä¸ªäº§å“çŸ¥è¯†åº“â€ï¼Œæ•¬è¯·å…³æ³¨ï¼

# ğŸƒTLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

èµ¶æ—¶é—´ï¼Ÿè¿è¡Œè¿™æ®µä»£ç ï¼

> *ğŸ’¡*ç¡®ä¿æ­£ç¡®è®¾ç½®â€œ< â€¦ >â€å‚æ•°ï¼

# ğŸ‘¨â€ğŸ«ä»‹ç»

å‡è®¾ä½ æƒ³åšä¸€ä¸ªå¸‚åœºè°ƒæŸ¥ï¼Œä¹Ÿè®¸æ˜¯åœ¨æŸä¸ªç‰¹å®šçš„é¢†åŸŸï¼Œæ¯”å¦‚æŸè¾†ç‰¹å®šçš„è‡ªè¡Œè½¦ï¼ŒæŸä¸ªç‰¹å®šçš„æ”¿å…šï¼Œç”šè‡³æ˜¯åœ¨ [Gamestop äº‹ä»¶](https://www.nytimes.com/2021/01/27/business/dealbook/reddit-wallstreetbets-gamestop.html)å‰å‡ å‘¨ [wallstreetbets](https://www.reddit.com/r/wallstreetbets/) ä¸Šå‘ç”Ÿäº†ä»€ä¹ˆã€‚

å¯¹äºè¿™ç§ç‰¹å®šçš„ä»»åŠ¡ï¼Œåˆ†æç”¨æˆ·è¯„è®ºå¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šï¼Œä» reddit è·å–è¿™äº›è¯„è®ºæ˜¯ä¸€ä¸ªå¿«é€Ÿè€Œèªæ˜çš„æƒ³æ³•ï¼Œå› ä¸ºè¿™äº›ç¤¾äº¤è¯„è®ºçš„è´¨é‡å¾ˆå¥½( [OpenAI ä¹Ÿç”¨å®ƒæ¥è®­ç»ƒ GPT æ¨¡å‹](https://openai.com/blog/better-language-models/))ã€‚

æ˜¯çš„ï¼Œç¡®å®æœ‰ä¸€ä¸ªé€‰æ‹©æ˜¯ä» [pushshift](https://pushshift.io/) ä¸‹è½½[Reddit çš„](https://files.pushshift.io/reddit/comments/)æœ€æ–°è½¬å‚¨ï¼Œä½†æ˜¯è·å¾—> 15Gb çš„æ•°æ®ä»¥ä½¿ç”¨å°‘äº 100Mb çš„æ•°æ®å¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½å¯è¡Œçš„æ–¹æ³•ã€‚æˆ‘ä»¬éœ€è¦å®Œæˆçš„ä»»åŠ¡ä¹Ÿä¸éœ€è¦æ¥è‡ª reddit çš„æ–°æ•°æ®ï¼Œå› ä¸º pushshift è½¬å‚¨æ¯æœˆè¿›è¡Œä¸€æ¬¡ã€‚

æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿé¿å…å ç”¨æ— ç”¨çš„ Pushshift å¸¦å®½ï¼Œè¿™æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨çš„ä»£ç è¢«å®šåˆ¶ä¸ºè°ƒç”¨ Pushshift æœ€å°‘æ¬¡æ•°ã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬æ¢ç´¢ä¸€ç§ä»ç‰¹å®šå­ç¼–è¾‘ä¸­æ”¶é›†è¯„è®ºçš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´çº¦æŸï¼Œä»¥ä¸€ç§ç®€å•å¿«æ·çš„æ–¹å¼ã€‚

# ğŸ¯ä¸»é¡¹ç›®

æœ¬æ–‡æ¢è®¨äº†ä¸€ä¸ªæ›´å¤§é¡¹ç›®çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œè¯¥é¡¹ç›®æ—¨åœ¨åˆ©ç”¨ reddit çš„è¯„è®ºæ¥æ„å»ºäº§å“çŸ¥è¯†åº“ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™æ˜¯ä¸€ä¸ªæ›´å¤§é“¾æ¡çš„ç¬¬ä¸€ç¯:

![](img/696e998bf4b1a85a75d8445f5f268077.png)

ä¸»ä½“å»ºç­‘æ¦‚è¿°â€”â€”ä½œè€…å½¢è±¡

# ğŸ›‚æ¢å¤å‡­æ®

é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ª reddit ä¸Šçš„[è´¦å·å’Œä¸€äº›è´¦å·å‚æ•°: *reddit_id* å’Œ *reddit_secret* ã€‚æŸ¥çœ‹ä¸‹ä¸€ä¸ªè¡¨ï¼Œäº†è§£å¦‚ä½•æ£€ç´¢è¿™äº›å‚æ•°ã€‚](https://www.reddit.com/register/)

![](img/bd1466ddc9e2bd91a9387426ad1af215.png)

å¸¦é“¾æ¥çš„åŸå§‹è¡¨æ ¼å¯åœ¨[pistocop.dev/posts/subreddit_downloader/](https://www.pistocop.dev/posts/subreddit_downloader/)è·å¾—

è¿˜åœ¨çº ç»“`reddit_id`å’Œ`reddit_secret`æ€ä¹ˆèµ°ï¼Ÿ
çœ‹çœ‹è¿™ç¯‡å¥½æ–‡ç« :

[](/how-to-use-the-reddit-api-in-python-5e05ddfd1e5c) [## å¦‚ä½•åœ¨ Python ä¸­ä½¿ç”¨ Reddit API

### Reddit API æ•°æ®æ”¶é›†ç®€å•æŒ‡å—

towardsdatascience.com](/how-to-use-the-reddit-api-in-python-5e05ddfd1e5c) 

# ğŸš€ä¸‹è½½æ•°æ®

> æˆ‘ä»¬å‡è®¾ python3 å·²ç»å®‰è£…å¹¶è¿è¡Œåœ¨æ‚¨çš„ç”µè„‘ä¸Š

åœ¨å‡­è¯æ£€ç´¢ä¹‹åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`src`æ–‡ä»¶å¤¹ä¸‹çš„è„šæœ¬`subreddit_downloader.py`æ¥é¢å¯¹æ•°æ®ä¸‹è½½éƒ¨åˆ†ã€‚
è„šæœ¬çš„å…¶ä»–å‚æ•°æœ‰:

*   `--output-dir` â†’å¯é€‰è¾“å‡ºç›®å½•ã€é»˜è®¤:ã€‚/data/]
*   `--batch-size` â†’æ¯æ¬¡è¯·æ±‚æäº¤â€œbatch _ size é»˜è®¤å€¼:10]
*   `--laps` â†’è¯·æ±‚æäº¤â€œbatch _ sizeâ€Reddit çš„æ¬¡æ•°[é»˜è®¤å€¼:3]
*   `--utc-after` â†’è·å–è¯¥ UTC æ—¥æœŸä¹‹åçš„æäº¤
*   `--utc-before` â†’åœ¨æ­¤ UTC æ—¥æœŸä¹‹å‰è·å–æäº¤å†…å®¹

ä¾‹å¦‚ï¼Œè¿™æ˜¯ä»[*AskReddit*](https://www.reddit.com/r/AskReddit/)*å’Œ [News](https://www.reddit.com/r/news/) ä¸‹è½½æŠ•ç¨¿å’Œç›¸å…³è¯„è®ºçš„åŸºæœ¬ç”¨æ³•:*

*ç”¨ä¸åŒçš„ subreddit å’Œä¸åŒçš„æ—¶é—´èŒƒå›´ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹ä»»æ„å¤šæ¬¡ã€‚*

> **ğŸ’¡æç¤º:ä½¿ç”¨ä¸€äº›åœ¨çº¿å·¥å…·ï¼Œæ¯”å¦‚ EpochConverter æ¥è®¡ç®—ä½ æƒ³è¦çš„ UTC æ—¶é—´**

# *ğŸ—æ„å»ºæ•°æ®é›†*

*ä¸‹è½½å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæœºå™¨å¯è¯»çš„æ•°æ®é›†ï¼Œä»¥åå¯ä»¥ç”¨äºåˆ†æã€æœºå™¨å­¦ä¹ å’Œè®¸å¤šå…¶ä»–ç›®çš„ã€‚*

*è¦æ„å»ºæ–°çš„æ•°æ®é›†ï¼Œåªéœ€è¿è¡Œ *dataset_builder.py* è„šæœ¬ï¼Œè¿›åº¦æ¡å°†æ˜¾ç¤ºæ„å»ºè¿‡ç¨‹ä¸­çš„çŠ¶æ€ã€‚æ„å»ºå®Œæˆåï¼Œæ‚¨å¯ä»¥åœ¨*æ•°æ®é›†*æ–‡ä»¶å¤¹ä¸‹æ£€æŸ¥æ‚¨çš„ç»“æœ:æ¯å½“æ‚¨æ„å»ºä¸€ä¸ªæ–°çš„æ•°æ®é›†æ—¶ï¼Œè„šæœ¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ã€‚*

> **ğŸ’¡*å¦‚æœæ‚¨ä½¿ç”¨ä¸åŒçš„`*--output-dir*`å‚æ•°è¿è¡Œ subreddit ä¸‹è½½è„šæœ¬ï¼Œè¯·ç›¸åº”åœ°æ›´æ”¹ dataset_builder.py `*--input-dir*` å‚æ•°*

## *ğŸ­è¾“å‡ºæ–‡ä»¶æ ¼å¼*

*åˆ›å»ºçš„æ•°æ®é›†é‡‡ç”¨ *CSV* æ ¼å¼ï¼Œå¹¶éµå¾ªä»¥ä¸‹ç»“æ„:*

*![](img/ad650df39f3d7aa24bc009d0064a4f5d.png)*

*[ä¸Šçš„åŸå§‹è¡¨æ ¼ **GitHub** ä¸Šçš„](https://github.com/pistocop/subreddit-comments-dl)*

*![](img/c68698297473e764450a0f1c6281443e.png)*

*[ä¸Šçš„åŸå§‹è¡¨æ ¼ **GitHub** ä¸Šçš„](https://github.com/pistocop/subreddit-comments-dl)*

# *ğŸ“Œç»“è®º*

*åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨ [praw](https://praw.readthedocs.io/en/latest/) å’Œ [pushshift](https://pushshift.io/api-parameters/) API ä»ç‰¹å®šçš„å­ç¼–è¾‘ä¸­æ”¶é›†æ•°æ®ã€‚è¿™ç§ä»‹ç»å¸Œæœ›æˆä¸ºä¸€ä¸ªæ›´é›„å¿ƒå‹ƒå‹ƒçš„é¡¹ç›®çš„ç¬¬ä¸€é¡¹ä»»åŠ¡ï¼Œè¯¥é¡¹ç›®ä¾§é‡äºå»ºç«‹ä¸€ä¸ªç‰¹å®šäº§å“æˆ–å®ä½“çš„çŸ¥è¯†åº“ã€‚å¦‚æœä½ æ„Ÿå…´è¶£çš„è¯ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ç”¨[å˜å½¢é‡‘åˆš](https://spacy.io/universe/project/spacy-transformers/)ä»è¯„è®ºä¸­æå–ä¿¡æ¯ï¼*

# *ğŸ“–è¯æ±‡è¡¨*

*   *reddit ç½‘ç«™ä¸Šä¸“æ³¨äºæŸä¸ªç‰¹å®šä¸»é¢˜çš„éƒ¨åˆ†*
*   **æäº¤*:å‡ºç°åœ¨æ¯ä¸ªå­ç¼–è¾‘ä¸­çš„å¸–å­ã€‚å½“ä½ æ‰“å¼€ä¸€ä¸ª subreddit é¡µé¢ï¼Œä½ çœ‹åˆ°çš„æ‰€æœ‰å¸–å­ã€‚æ¯ä¸ªæäº¤éƒ½æœ‰ä¸€ä¸ª*è¯„è®ºæ ‘**
*   **è¯„è®º*:Reddit ç”¨æˆ·åœ¨*æäº¤*ä¸‹çš„*å­ç¼–è¾‘
    -* ä¸­ç¼–å†™çš„æ–‡æœ¬ã€‚è¿™ä¸ªåº“çš„ä¸»è¦ç›®æ ‡æ˜¯æ”¶é›†å±äºå­ç¼–è¾‘çš„è¯„è®º*

# *âœç¬”è®°*

*   *åœ¨å¹•åï¼Œè„šæœ¬ä½¿ç”¨ [pushshift](https://pushshift.io/api-parameters/) æ¥æ”¶é›†æäº¤ idï¼Œä½¿ç”¨ [praw](https://praw.readthedocs.io/en/latest/) æ¥æ”¶é›†æäº¤çš„è¯„è®º
    â€”â€”ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦æ›´å°‘çš„æ•°æ®ç»™[pushshift](https://pushshift.io/api-parameters/)
    â€”â€”ç”±äºä½¿ç”¨äº† [praw](https://praw.readthedocs.io/en/latest/) APIï¼Œéœ€è¦ reddit å‡­è¯*
*   *å…³äº`--help`å‘½ä»¤ä¸‹çš„`subreddit_downloader.py`è„šæœ¬çš„æ›´å¤šä¿¡æ¯*