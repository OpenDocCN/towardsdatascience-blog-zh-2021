# spaCy 3.0 å…¥é—¨

> åŸæ–‡ï¼š<https://towardsdatascience.com/getting-started-with-nlp-with-spacy-3-0-ff6a4bc74d9b?source=collection_archive---------9----------------------->

## ç†è§£è¿è¡Œ spaCy ä»£ç æ—¶å‘ç”Ÿçš„äº‹æƒ…

![](img/5b436983febefc087618c2d5eef7c437.png)

å›¾ç‰‡æ¥æº:[å¨å»‰Â·å†ˆå…‹å°”](https://unsplash.com/@wilhelmgunkel)

# å…³äºè¿™ç¯‡æ–‡ç« 

è¿™ç¯‡æ–‡ç« æ˜¯æ•…äº‹â€œç†è§£ NLP â€”ä» TF-IDF åˆ°å˜å½¢é‡‘åˆš â€çš„æ”¯æŒææ–™çš„ä¸€éƒ¨åˆ†

æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•å¼€å§‹ä½¿ç”¨ spaCyã€‚æˆ‘ä»¬å°†æŠŠé‡ç‚¹æ”¾åœ¨å†…éƒ¨ï¼Œè€Œä¸ä»…ä»…æ˜¯å†™ä¸€äº›ä»£ç å’Œæ‰§è¡Œå®ƒã€‚è¿™æ„å‘³ç€â€”â€”æˆ‘ä»¬å°†å°è¯•æ›´æ·±å…¥åœ°ç ”ç©¶å½“æ‚¨æ‰§è¡Œæ¯ä¸ªä»£ç ç‰‡æ®µæ—¶å‘ç”Ÿäº†ä»€ä¹ˆã€‚

æ¯ä¸ªä»£ç ç‰‡æ®µéƒ½è¢«åˆ†è§£å¹¶è¯¦ç»†è§£é‡Šã€‚å¦‚æœæ‚¨åªæƒ³æŸ¥çœ‹è¿è¡Œä¸­çš„ä»£ç ï¼Œæ‚¨å¯èƒ½æƒ³è·³è¿‡ä¸­é—´çš„è¯¦ç»†è§£é‡Šï¼Œç›´æ¥åœ¨æ‚¨çš„ IDE ä¸Šè¿è¡Œä»£ç ã€‚

**æ˜¯ç»™è°çš„ï¼Ÿ**

å¦‚æœæ‚¨åˆšåˆšå¼€å§‹ä½¿ç”¨ NLPï¼Œæœ€å¥½é˜…è¯»ä¸€äº›å…³äº NLP åŸºæœ¬æ¦‚å¿µçš„æ–‡ç« ã€‚

åœ¨ç»§ç»­ä¹‹å‰ï¼Œæ‚¨å¯èƒ½æƒ³æ›´æ–°/ç†è§£ä¸€äº›æ¦‚å¿µâ€”

*   ä»£å¸
*   è¯æ€§æ ‡æ³¨
*   å‘½åå®ä½“è¯†åˆ«(NER)
*   è¯æ±‡åŒ–/è¯å¹²åŒ–

è¿™ç¯‡æ–‡ç« æ˜¯å†™ç»™ä»»ä½•ä¸€ä¸ªåˆšå¼€å§‹å°è¯• spaCy ä½œä¸ºä½ çš„è½¯ä»¶åŒ…çš„äººçš„ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ spaCy v3.0ã€‚

# å…³äºç©ºé—´çš„ä¸€ä¸ªç®€çŸ­è¯´æ˜

`spaCy`æ˜¯ä¸€ä¸ªå·¥ä¸šçº§ NLP åŒ…ã€‚

*   å®ƒå¾ˆå¿«(ç”¨ C ç¼–å†™ï¼Œå¸¦æœ‰ Python çš„è¯­è¨€ç»‘å®š)
*   è¿™æ˜¯ç”Ÿäº§çº§çš„
*   å—åˆ°æ´»è·ƒç¤¾åŒºçš„æ”¯æŒ
*   å›´ç»•å®ƒæ„å»ºäº†è®¸å¤šæ´»è·ƒçš„ç‹¬ç«‹é¡¹ç›®

# å®‰è£…å’Œè®¾ç½®

**æ­¥éª¤ 1 )** å®‰è£…`spaCy` å°±åƒå®‰è£…ä»»ä½•å…¶ä»–è½¯ä»¶åŒ…ä¸€æ ·

`> pip install spaCy`

**æ­¥éª¤ 2)ä»å‘½ä»¤æç¤ºç¬¦ä¸‹ä¸‹è½½**è‡³å°‘ä¸€ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„ç®¡é“æ¨¡å‹(è‹±è¯­ç‰ˆ)

`> spacy download en_core_web_sm`

è¿™ä¸‹è½½äº†ä¸€ä¸ªå°å‹çš„è‹±è¯­è¯­è¨€æ¨¡å‹ç®¡é“ï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°çš„å¤§é‡æ–‡æœ¬æ ·æœ¬ä¸Šè¿›è¡Œè®­ç»ƒã€‚å¯¹äºæˆ‘ä»¬ä¸‹è½½çš„è¯­è¨€ï¼Œå®ƒæœ‰`weights`ã€`vocabularies` ç­‰(*æˆ‘ä»¬è¿˜ä¸ç”¨æ‹…å¿ƒè¿™äº›æœ¯è¯­*)ã€‚ç°åœ¨æˆ‘ä»¬å‡†å¤‡å°è¯•ä¸€äº›ä¾‹å­ã€‚

ä½ å¯ä»¥ä¸‹è½½ 4 ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„ç®¡é“â€”

*   `en_core_web_sm` â€”å°å‹å·(13 MB)
*   `en_core_web_md` â€”ä¸­å‹é¢„è®­ç»ƒå‹å·(44 MB)
*   `en_core_web_lg` â€”å¤§å‹é¢„è®­ç»ƒæ¨¡å‹(742 MB)
*   `en_core_web_trf` ( â€”åŸºäºå˜å‹å™¨çš„é¢„è®­ç»ƒå‹å· 438 MB)

è¾“å‡ºçš„å‡†ç¡®æ€§å’Œæ•ˆç‡(æ‰§è¡Œé€Ÿåº¦)å°†å–å†³äºæ‚¨é€‰æ‹©çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚

# *#ä»£ç ç‰‡æ®µ 1 â€”å…¥é—¨*

```
import spacy
nlp = spacy.load("en_core_web_md")doc = nlp("On October 23, Apple CEO Tim Cook unveiled the new iPad Mini, fourth generation iPad with Retina display, new iMac, and the 13-inch MacBook Pro with Retina display.")
```

## è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

1.  æˆ‘ä»¬å¯¼å…¥äº†ä¸€ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„ spacy.lang å¯¹è±¡(å¦‚å‰æ‰€è¿°ï¼Œè¿™ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹åŸºäºæ¥è‡ªäº’è”ç½‘çš„è‹±è¯­æ–‡æœ¬æ ·æœ¬)ã€‚
2.  è¿è¡Œè¿™ä¸ª`nlp()`ç®¡é“(ä»¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª`Doc`)ã€‚
3.  è¿”å›ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥æ“ä½œçš„ç©ºé—´`Doc` å¯¹è±¡

## **å¹•åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ**

å½“ä½ æŠŠæ–‡æœ¬æ”¾åœ¨`nlp()`å‘¨å›´æ—¶ï¼Œä¼šå‘ç”Ÿå¾ˆå¤šäº‹æƒ…ã€‚è¦çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè°ƒç”¨`pipeline` å±æ€§ï¼Œä½ å°±ä¼šçœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆã€‚

```
>> nlp.pipeline
```

æŒ‰æ­£ç¡®é¡ºåºç»™å‡ºç®¡é“ä¸­åŒ…å«çš„ç»„ä»¶åˆ—è¡¨ã€‚

```
[('tok2vec', <spacy.pipeline.tok2vec.Tok2Vec at 0x24c8>),
 ('tagger', <spacy.pipeline.tagger.Tagger at 0x24c47c8>),
 ('parser', <spacy.pipeline.dep_parser.DependencyParser at 0x24c9ba8>),
 ('ner', <spacy.pipeline.ner.EntityRecognizer at 0x24c66508>),
 ('attribute_ruler',
  <spacy.pipeline.attributeruler.AttributeRuler at 0x24c67e08>),
 ('lemmatizer', <spacy.lang.en.lemmatizer.EnglishLemmatizer at 0x2403a88>)]
```

è¿™æ„å‘³ç€å½“æ‚¨è°ƒç”¨ nlp()æ—¶ï¼Œæ‚¨æ­£åœ¨è¿è¡Œä¸€ç³»åˆ—æ­¥éª¤â€”

![](img/daaacb5d62e643c230c0de03f05e11a4.png)

spaCy è¯­è¨€å¤„ç†ç®¡é“(å›¾ç‰‡ç”±ä½œè€…æä¾›)

*   **è®°å·èµ‹äºˆå™¨** â€”å°†æ–‡æœ¬è½¬æ¢æˆç”±å•è¯å’Œæ ‡ç‚¹ç»„æˆçš„å°æ®µâ€”â€”è¿™äº›å°æ®µè¢«ç§°ä¸º**è®°å·ã€‚**
*   **æ ‡è®°å™¨** â€”è¯¥ç»„ä»¶æ ¹æ®æ‰€ä½¿ç”¨çš„è¯­è¨€æ¨¡å‹ï¼Œå°†æ¯ä¸ªå•è¯æ ‡è®°ä¸ºç›¸åº”çš„ ***è¯æ€§*** ã€‚
*   **è§£æå™¨** â€”ç”¨äºä¾èµ–è§£æçš„ç»„ä»¶(æ¢å¥è¯è¯´ï¼Œæ‰¾åˆ°å¥å­ä¸­å•è¯ä¹‹é—´çš„ç»“æ„å’Œå…³ç³»â€”â€”åœ¨æœ¬æ–‡çš„ä¸Šä¸‹æ–‡ä¸­ç†è§£èµ·æ¥å¹¶ä¸é‡è¦)ã€‚
*   **NER** (å‘½åå®ä½“è¯†åˆ«å™¨)ã€‚
*   **å±æ€§æ ‡å°º** â€”å½“æ‚¨åˆ†é…è‡ªå·±çš„è§„åˆ™(ä¾‹å¦‚:å•è¯/çŸ­è¯­ä»¤ç‰ŒåŒ¹é…)æ—¶ï¼Œè¯¥ç»„ä»¶å¯ä»¥ä¸ºå•ä¸ªä»¤ç‰Œè®¾ç½®å±æ€§ã€‚
*   **è¯æ¡è§£é‡Šå™¨** â€”è¯¥ç»„ä»¶ä¸ºæ–‡æ¡£ä¸­çš„æ¯ä¸ªå•è¯/ç¬¦å·åˆ›å»ºè¯æ¡ã€‚(è¯æ¡ä¹Ÿç§°ä¸ºå•è¯çš„åŸºæœ¬å½¢å¼ã€‚)

**å“‡ï¼â€”** å¦‚ä½ æ‰€è§ï¼Œè¿™é‡Œå®Œæˆäº†å¾ˆå¤šå·¥ä½œã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªéå¸¸å¤§çš„æ–‡æœ¬ï¼Œå®ƒå¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´ã€‚

æ­¤æ—¶ï¼Œæˆ‘ä»¬å‡†å¤‡å¯¹`doc` å¯¹è±¡è¿›è¡Œä¸€äº›æ“ä½œã€‚

# *#ä»£ç ç‰‡æ®µ 2 â€”æ˜¾ç¤ºå‘½åå®ä½“*

```
#if you want to show the named entities in the text 
doc.ents # if you want to display the labels associated with it 
for tkn in doc.ents : 
    print(tkn.text ," - " ,tkn.label_)
```

ä¸Šé¢ä»£ç çš„è¾“å‡ºä¼šæ˜¯è¿™æ ·çš„â€”

![](img/c942c7cba68c8e2d89767f3ed6f9abd3.png)

ä»£ç çš„è¾“å‡º(å›¾ç‰‡ç”±ä½œè€…æä¾›)

æˆ–è€…å¦‚æœä½ æƒ³è¦ä¸€ä¸ªå¯è§†åŒ–çš„æ˜¾ç¤º

```
from spacy import displacy
displacy.render(doc, style='ent')
```

ä¼šç»™ä½ ä»¥ä¸‹çš„è¾“å‡ºã€‚

![](img/9a0f2cf4b40ca41b78e51eb6b4702eff.png)

æ–‡æ¡£ä¸­æ ‡è¯†çš„å®ä½“çš„ç©ºé—´è¾“å‡ºã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# #ä»£ç ç‰‡æ®µ 3â€”æ¢ç´¢ doc å¯¹è±¡

**1ã€‚å¥å­** â€”æ‚¨å¯ä»¥ä½¿ç”¨`doc` å¯¹è±¡ä¸­çš„`sents`å±æ€§å°†å¥å­åˆ†æˆä¸€ä¸ª`iterator` å¯¹è±¡ï¼Œåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ä¿å­˜æ¯ä¸ªå¥å­ã€‚

```
#working with sentences txt = â€œHello my dear fellow scholars ! This is Tomas from the German republic. Iam very happy to join you. How are you all feeling ?â€doc = nlp(txt)for sentences in doc.sents : 
    print(sentences)# or you can store it as a list
list_sentences = list(doc.sents)
```

ä¸Šè¿°ä»£ç çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º

![](img/980ae2c6b90ba3e8cbc48bf96749d0fe.png)

ä»£ç çš„è¾“å‡º(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ğŸ‘‰**æ³¨**:ä» doc å¯¹è±¡ä¸­æå–çš„å¥å­æ˜¯ä¸€ä¸ªç»Ÿè®¡é¢„æµ‹ï¼Œä¸ä¸€å®šæ˜¯æœ€å‡†ç¡®çš„ã€‚å®ƒä¸è¿›è¡Œç®€å•çš„åŸºäºè§„åˆ™çš„æ‹†åˆ†ï¼Œä¾‹å¦‚:åŸºäºâ€œå¥å·â€/â€œå¥å·â€å­—ç¬¦)

# #ä»£ç ç‰‡æ®µ 4â€”è§„åˆ™å’Œå­—ç¬¦ä¸²åŒ¹é…(è‡ªå®šä¹‰æœç´¢æ¨¡å¼)

spaCy å…è®¸æ‚¨æœç´¢è‡ªå®šä¹‰æœç´¢æ¨¡å¼ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåº”ç”¨äºå‰é¢ä¾‹å­çš„ç®€å•æ¨¡å¼ã€‚

```
txt_apl = "On October 23, Apple CEO Tim Cook unveiled the new iPad Mini, fourth generation iPad with Retina display, new iMac, and the 13-inch MacBook Pro with Retina display."doc = nlp(txt_apl)
```

ç°åœ¨ï¼Œåˆ›å»ºå¹¶æ·»åŠ **è‡ªå®šä¹‰æœç´¢æ¨¡å¼**:

```
from spacy.matcher import Matcher
mat = Matcher(nlp.vocab,validate = True)#create patterns for matching
patrn_mac = [ {'LOWER': 'ipad'}]
patrn_Appl = [ {'LOWER': {'IN': ['apple', 'appl']}}]mat.add('patrn_mac', [patrn_mac])
mat.add('patrn_Appl', [patrn_Appl])for match_id, start, end in mat(doc):
    print(doc[start: end], â€œfound at â€œ,[start,end])
```

ä¸Šé¢ä»£ç çš„è¾“å‡ºçœ‹èµ·æ¥åƒè¿™æ ·â€”

```
Apple found at  [4, 5]
iPad found at  [11, 12]
iPad found at  [16, 17]
```

## ä¸‹é¢æ˜¯æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…â€”åˆ†è§£æˆå‡ ä¸ªæ­¥éª¤:

1.  å¯¼å…¥ç›¸å…³åŒ…(æ­¤å¤„ä¸º`Matcher`)ã€‚
2.  é€šè¿‡åŒ…å«`spacy.vocab.Vocab`å¯¹è±¡ï¼Œåˆ›å»ºä¸€ä¸ª`Matcher` å¯¹è±¡`mat`ã€‚
3.  å®šä¹‰ä½ çš„æ¨¡å¼â€”â€”è¿™é‡Œæˆ‘ä»¬æƒ³æœç´¢ä»»ä½•å­—ç¬¦ä¸²ï¼Œè½¬æ¢æˆå°å†™ï¼Œå¹¶æ£€æŸ¥å®ƒæ˜¯å¦åŒ¹é…'`ipad`,å¹¶å°†è¯¥æ¨¡å¼å‘½åä¸º`patrn_mac.` ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬åˆ›å»ºå¦ä¸€ä¸ªåä¸º`patrn_Appl`çš„æ¨¡å¼ã€‚
4.  å°†è¿™äº›å›¾æ¡ˆæ·»åŠ åˆ°æˆ‘ä»¬åˆ›å»ºçš„`Matcher` å¯¹è±¡`(mat)`ä¸­ã€‚
5.  å¯¹æˆ‘ä»¬ä»æ–‡æœ¬ä¸­åˆ›å»ºçš„æ–‡æ¡£è¿è¡Œ/æ£€æŸ¥è¿™ä¸ª`Matcher` å¯¹è±¡ã€‚`mat(doc)` æ–¹æ³•è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«åŒ¹é… IDã€æ–‡æ¡£ä¸­åŒ¹é…çš„å¼€å§‹å’Œç»“æŸä½ç½®â€”â€”å¦‚ä¸‹æ‰€ç¤º:

```
[
 (4260053945752191717, 4, 5),
 (4964878671255706859, 11, 12),
 (4964878671255706859, 16, 17)
]
```

# æ¦‚è¿°

*   å½“æ‚¨è¿è¡Œ`nlp()`æ—¶ï¼Œå®ƒè¿è¡Œä¸€ä¸ªç»„ä»¶ç®¡é“â€” `tok2vec`ã€`tagger`ã€`parser`ã€`ner`ã€`attribute_ruler` å’Œ`lemmatizer`ã€‚
*   `doc.ents` åˆ—å‡ºé¢„è®­ç»ƒæ¨¡å‹è¯†åˆ«çš„å®ä½“ã€‚
*   æ‚¨å¯ä»¥ä½¿ç”¨`displacy` ç›´è§‚æŸ¥çœ‹ NER è¾“å‡ºã€‚
*   åœ¨æ–‡æ¡£ä¸­åˆ—å‡ºä½ çš„å¥å­ã€‚
*   æ‚¨å¯ä»¥ä½¿ç”¨`Matcher`æ¨¡å—åˆ›å»ºè‡ªå®šä¹‰å­—ç¬¦ä¸²åŒ¹é…æ¨¡å¼ã€‚

## ç»“æŸè¯­

è¿™æ˜¯å¯¹ spaCy å…¥é—¨çš„ç®€è¦ä»‹ç»ã€‚ç„¶è€Œï¼Œè¿™ç¯‡æ–‡ç« å¹¶æ²¡æœ‰å…¬æ­£åœ°è¯„ä»· spaCy ä½œä¸ºä¸€ä¸ªé«˜åº¦å¯æ‰©å±•çš„ NLP åŒ…çš„èƒ½åŠ›å’Œå¨åŠ›ã€‚åç»­æ–‡ç« å°†å±•ç¤º spaCy ä½œä¸º NLP åŒ…çš„ç”Ÿäº§å°±ç»ªé€‰æ‹©çš„å¼ºå¤§åŠŸèƒ½ã€‚

å¦‚æœä½ æƒ³é˜…è¯»ä¸€äº›å…³äº NLP çš„ç›¸å…³æ–‡ç« ï¼Œè¿™é‡Œæœ‰ä¸€ç¯‡

<https://pythoslabs.medium.com/10-use-cases-in-everyday-business-operations-using-nlp-af49b9650d8f>**ä½¿ç”¨ NLP çš„æ—¥å¸¸ä¸šåŠ¡è¿è¥ä¸­çš„ 10 ä¸ªç”¨ä¾‹**

**<https://pythoslabs.medium.com/10-use-cases-in-everyday-business-operations-using-nlp-af49b9650d8f> **