# 北美区域碳通量模式:用神经网络反向估算目标数据预测碳通量

> 原文：<https://towardsdatascience.com/the-north-american-regional-carbon-flux-model-predicting-carbon-flux-using-inversely-estimated-918bf31ea7dd?source=collection_archive---------35----------------------->

## [变更数据](https://towardsdatascience.com/tagged/data-for-change)

## *根据区域变量和反向估算的目标数据创建一个更有效的北美 CO2 通量模型*

我们能否创建一个碳通量模型，使用碳通量的逆模型估计来训练神经网络？我们可以不使用按比例放大的碳通量数据，而是使用捕捉大规模碳通量特征的逆模型估计，因为它们与大气 CO2 数据直接相关。这与其他模型不同，因为我们的模型不是使用站点级别的碳通量数据，而是使用区域范围的平均值来提供更广泛区域内碳通量活动的更好想法。但与现场水平的估计不同，反向通量缺乏一些详细的信息，如时间分辨率。通过使用区域环境变量，我们可以利用逆模型方法为北美建立一个 CO2 通量模型，从而为一个大区域建立数据驱动的碳通量估计。

[Github 资源库](https://github.com/ashwink0/narcf)
[Google Colab](https://colab.research.google.com/drive/1JRTEjfNAu7V0f2Y0ZY-JguDtX5Yao73I?usp=sharing)

# 数据是如何选择的

我们选择数据集的依据是，我们认为哪些特征能给我们提供北美碳通量的最佳指示，以及哪些因素促成了这一数字。我们首先研究了自然碳通量的主要驱动因素光合作用的指标，最终使用辐射、土壤水分、湿度、降水，然后使用逆模型估计碳通量数据来训练模型。我们还关注了北美地区每月 1x1 度分辨率的可用数据。这是因为较高分辨率下的数据不够精确，可能会使我们的模型难以在整个目标区域内表现良好。

# 提炼数据

![](img/8c39490697d6e7884db257ee5c620ff2.png)

图 1

通过在一个名为 pairplot 的工具中查看我们的数据，我们看到了哪些变量具有相似的数据，这些数据可能会通过引入冗余信息来误导模型。例如，precip 和 percip30d 变量在 pairplot 上彼此密切相关，但是在测试时，我们发现移除该变量不会以可测量的方式影响模型。

# 数据图

![](img/959b7f315d84cbb451a792c60bdf3b4c.png)

图 2

这张图表向我们展示了 2007 年北美目标数据集中的月平均碳通量，并让我们看到了季节性碳通量的模式

![](img/a3c1d7c84875633e80e0812037e5af7b.png)

图 3

该散点图显示了目标数据中所有年份的月平均通量值，我们稍后将使用这些数据来评估我们的模型。

# 自上而下与自下而上

在估算碳通量时，有两种主要方法。一种是自下而上的方法，在大约 1 公里的范围内进行碳通量测量，然后用大量的测量数据构建一个数据阵列。然而，对于模拟整个北美的碳通量的问题，这种方法是无效的，因为它依赖于外推和按比例放大到更大区域的关系，这可能是有问题的。自上而下建模的一个好处是，它可以根据大气 CO2 观测模式提供大面积净通量的估计值。一个缺点是，因为我们只有大面积的估计，我们不知道哪些来源可能造成更多的大气二氧化碳。

# 其他信息

对于我们选择的数据集，数据跨度从 2007 年到 2015 年。为了训练模型，我们将使用前 6 年的可用数据，其余时间用于测试。为了训练模型，我们使用 20%的验证分割，这意味着模型将在 20%的训练数据上进行连续评估。仅针对北美创建模型的主要原因主要是因为可以获得同一时间段和同一分辨率的训练数据。

# 背景资料

为了准确预测北美的碳通量值，我们使用神经网络来估计碳通量。神经网络是一种机器学习过程，它被建模为神经元的互连网络，从训练数据中“学习”，然后在给定一组特征或训练数据的情况下预测结果。这是通过使用输入数据，通过称为隐藏层的神经元层检查数据中的某些模式，然后产生预期与数据的真实值匹配的结果的过程来实现的。在我们的实验过程中可以观察到，隐藏层的数量和每个隐藏层中神经元的数量可以极大地影响模型的有效性。该模型中使用的特征是之前讨论的环境变量以及作为目标数据集的原始碳通量数据，或者该模型试图预测的内容。我们使用神经网络来估计碳通量，因为神经网络能够对碳通量数据中存在的复杂非线性关系进行建模。

# 该结构

对于我们模型的结构，我们首先查看了 WECANN 模型，它提出了一个类似的问题，但却估计了总碳通量(GPP)。然而，他们模型的结构在我们的测试中被证明是无效的，所以我们不得不使用一个更复杂的模型。

![](img/e2598c6f93ecfbf463577092b7af9453.png)

图 4

上面是来自具有 15 个神经元的单个隐藏层的模型的预测散点图，显示了简单模型如何不足以有效地提供有用的估计。

# 发展

在我们决定使用一个更复杂的模型后，我们开始添加另一层，并为该层迭代测试不同数量的神经元。

在单个隐藏层中的 25 个神经元处，我们观察到改进的模型性能，与实际值相比，估计值达到 0.92 相关值。

![](img/4ca3554e3a341da7c7a3d39b196d0087.png)

图 5

该散点图显示了模型的估计值与真实值的对比，并且与之前的简单模型相比，有效地估计了碳通量值。

# 问题

虽然我们上面展示的模型表现很好，但我们意识到该模型表现很好主要是因为我们包括的特征具有太多的信息，因此问题太简单了。这是因为我们包括了经度、纬度和月份，模型过于依赖这些数据来预测碳通量，而不是使用我们打算使用的环境变量。为了继续开发我们的模型，我们被迫删除所有空间和时间数据，只使用模型中的环境数据变量。

在这一点上，没有时间和空间变量，模型性能下降到 0.60 相关值以下。我们还决定需要一个更复杂的模型来改进基于我们地区数据的模型性能估计。

为了重新开始模型开发，我们首先查看模型实际预测的值与真实值的对比，以便更好地了解我们具体需要改进的地方。

![](img/8e46850abd07a003047de35c2645a6ed.png)

图 6

![](img/8b53112f293fddf93ae27edd54400d4e.png)

图 7

我们可以看到，模型通常了解哪些区域显示较高和较低的碳通量值，如北美西海岸附近较高的通量值，但在通量尺度的边缘补偿严重不足，特别是在美国东北部。这向我们表明，我们需要关注两种不同的策略:创建一个更复杂的模型，同时进行更长时间的训练。

同样，经过大量的实验，这是我们为我们的模型决定的结构。

```
model = Sequential() model.add(Dense(50,input_dim=X_full.shape[1], activation='relu')) model.add(Dense(100,input_dim=X_full.shape[1], activation='relu')) model.add(Dense(100,input_dim=X_full.shape[1], activation='relu')) model.add(Dense(100,input_dim=X_full.shape[1], activation='relu')) model.add(Dense(50,input_dim=X_full.shape[1], activation='relu')) model.add(Dense(50,input_dim=X_full.shape[1], activation='relu')) model.add(Dense(1,input_dim=X_full.shape[1], activation='linear'))
```

随着我们增加了四个隐藏层，并按比例增加了所有隐藏层节点，最大层的神经元从 20 个增加到 100 个，我们模型的准确性大大提高了。

![](img/8d44d042e77d792244d4c6accdcc2428.png)

图 8

我们还对我们训练模型的方式做了一些改变。我们开始训练 100 个时期的模型，而不是仅仅 20 个时期。我们还为 Keras 使用了 shuffle 选项，这改变了数据通过每个历元的方式，并使我们的验证数据与我们的测试数据相同，这改变了模型在训练时评估自身的方式。

现在，我们的相关值大约是 0.83。在此之后，我们为模型引入了一个新功能，以 id 的形式为北美 18 个不同的生物群落提供 data⁵的土地覆盖。一个生物群落的例子如下所示:

![](img/baf0c6971a7f0d9c78261777981fc28a.png)

图 9

我们决定把它包括进来，因为我们认为它可能填补了模型不能完全预测特定地区碳通量的一些空白。我们的相关值跃升至约 0.90，其散点图如下所示。

![](img/6bb6482965622e7a46a0be2ca5191bde.png)

图 10

# 评估我们的结果

如上所示，我们的模型可以准确地估计每月的碳通量，尽管在某些地区仍然略有低估，但它仍然可以仅基于区域变量模拟北美的碳通量。在我们的散点图上，我们可以看到我们的模型仍然在夏季左右挣扎，因为北美的平均碳通量大大增加，但在一年中的其他时间更准确。我们的月度碳通量散点图也证明了为什么我们的模型被低估了。

![](img/4d984dfca0409e813912208c5b23888d.png)

图 11

![](img/13434acf44148af0b9d777c5195bb771.png)

图 12

为了进一步评估我们的模型，我们希望将我们的结果与另一个碳通量模型进行比较，特别是使用自下而上方法建模碳通量的模型。为此，我们选择了 model⁵.的 Fluxcom 下图展示了我们的模型与 Fluxcom 模型在预测碳通量方面的对比:

![](img/8d40bcfd65ea1a08b51f500fb31730fd.png)

图 13

蓝色的 Fluxcom 模型实际上低估了冬季月份的碳通量，但与我们的模型和夏季月份的真实值保持一致，这是北美发生更多光合作用和碳通量输出的时间。这不仅显示了碳通量自下而上和逆向建模之间的差异，还显示了将逆向建模方法用于其他环境应用的可行性和潜在好处。

# 未来方向

在完成模型的创建之后，我想探索几个领域，这些领域可能会改进模型或将其投入某种用途。我可以做的一个补充是使用其他环境数据，如某些地区的森林覆盖率，以及某些生物群落如何比较和影响碳通量。我还想将我的模型扩展到一个更大的区域，并探索我可能需要做出哪些改变来适应世界的一部分。

# 参考

[1] Yoichi P Shiga，森林主导北美碳汇的年际变化(2018)，[https://iopscience.iop.org/article/10.1088/1748-9326/aad505](https://iopscience.iop.org/article/10.1088/1748-9326/aad505)

[2] Mesinger，f .，G. DiMego，E. Kalnay，K. Mitchell 和合著者，北美区域再分析。美国气象学会公报(2006 年)，[https://www . ncdc . NOAA . gov/data-access/model-data/model-datasets/north-American-regional-re analysis-narr](https://www.ncdc.noaa.gov/data-access/model-data/model-datasets/north-american-regional-reanalysis-narr)

[3] Alemohammad，Hamed & Fang，Bin & Konings，Alexandra & Green，Julia & Kolassa，Jana & Prigent，Catherine & Aires，Filipe & Miralles，Diego & Gentine，Pierre，Water，Energy，and Carbon with Artificial Neural Networks(we cann):使用太阳诱导荧光对全球地表湍流通量进行基于统计的估计，[https://BG . Copernicus . org/articles/14/4101/2017/BG-14-4101-2017](https://bg.copernicus.org/articles/14/4101/2017/bg-14-4101-2017-discussion.html)

[4] Martin Jung，从涡旋协方差站点到全球的碳通量:FLUXCOM 方法的综合和评估，[https://BG . Copernicus . org/articles/17/1343/2020/BG-17-1343-2020-discussion . html](https://bg.copernicus.org/articles/17/1343/2020/bg-17-1343-2020-discussion.html)

[5]弗里德尔、M.A .、A.H .斯特拉勒、j .霍奇斯、F.G .霍尔、G.J .克拉茨、B.W .米森、S.O .洛斯、E .布朗·德·科尔斯顿和 D.R .兰迪斯。2010.ISLSCP II MODIS(收集 4) IGBP 土地覆盖，2000–2001。美国田纳西州橡树岭 ORNL·DAAC。【https://doi.org/10.3334/ORNLDAAC/968 