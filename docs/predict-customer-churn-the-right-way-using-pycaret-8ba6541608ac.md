# ä½¿ç”¨ PyCaret é¢„æµ‹å®¢æˆ·æµå¤±(æ­£ç¡®çš„æ–¹å¼)

> åŸæ–‡ï¼š<https://towardsdatascience.com/predict-customer-churn-the-right-way-using-pycaret-8ba6541608ac?source=collection_archive---------0----------------------->

## å…³äºå¦‚ä½•ä½¿ç”¨ PyCaret æ­£ç¡®é¢„æµ‹å®¢æˆ·æµå¤±çš„åˆ†æ­¥æŒ‡å—ï¼Œå®é™…ä¸Šä¼˜åŒ–äº†ä¸šåŠ¡ç›®æ ‡å¹¶æé«˜äº†æŠ•èµ„å›æŠ¥ç‡

![](img/62e56d0299926d8e11447530300def1e.png)

ä½¿ç”¨ PyCaret é¢„æµ‹å®¢æˆ·æµå¤±(æ­£ç¡®çš„æ–¹å¼)â€”â€”ä½œè€…å›¾ç‰‡

# **ç®€ä»‹**

å¯¹äºé‡‡ç”¨åŸºäºè®¢é˜…çš„ä¸šåŠ¡æ¨¡å¼çš„å…¬å¸æ¥è¯´ï¼Œå®¢æˆ·ç»´ç³»æ˜¯ä¸»è¦çš„ KPI ä¹‹ä¸€ã€‚ç«äº‰éå¸¸æ¿€çƒˆï¼Œå°¤å…¶æ˜¯åœ¨ SaaS å¸‚åœºï¼Œæ¶ˆè´¹è€…å¯ä»¥è‡ªç”±åœ°ä»å¤§é‡ä¾›åº”å•†ä¸­è¿›è¡Œé€‰æ‹©ã€‚ä¸€æ¬¡ç³Ÿç³•çš„ä½“éªŒï¼Œå®¢æˆ·å¯èƒ½ä¼šè½¬å‘ç«äº‰å¯¹æ‰‹ï¼Œå¯¼è‡´å®¢æˆ·æµå¤±ã€‚

# **ä»€ä¹ˆæ˜¯å®¢æˆ·æµå¤±ï¼Ÿ**

å®¢æˆ·æµå¤±ç‡æ˜¯åœ¨ä¸€å®šæ—¶é—´å†…åœæ­¢ä½¿ç”¨è´µå…¬å¸äº§å“æˆ–æœåŠ¡çš„å®¢æˆ·çš„ç™¾åˆ†æ¯”ã€‚è®¡ç®—å®¢æˆ·æµå¤±ç‡çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ç”¨ç»™å®šæ—¶é—´é—´éš”å†…æµå¤±çš„å®¢æˆ·æ•°é‡é™¤ä»¥è¯¥æœŸé—´å¼€å§‹æ—¶çš„æ´»è·ƒå®¢æˆ·æ•°é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ 1000 ä¸ªå®¢æˆ·ï¼Œä¸Šä¸ªæœˆå¤±å»äº† 50 ä¸ªï¼Œé‚£ä¹ˆä½ çš„æœˆæµå¤±ç‡æ˜¯ 5%ã€‚

é¢„æµ‹å®¢æˆ·æµå¤±æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§ä½†æå…¶é‡è¦çš„å•†ä¸šé—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨å®¢æˆ·è·å–æˆæœ¬è¾ƒé«˜çš„è¡Œä¸šï¼Œå¦‚æŠ€æœ¯ã€ç”µä¿¡ã€é‡‘èç­‰ã€‚é¢„æµ‹ç‰¹å®šå®¢æˆ·é¢ä¸´é«˜é£é™©çš„èƒ½åŠ›ï¼ŒåŒæ—¶è¿˜æœ‰æ—¶é—´åšäº›ä»€ä¹ˆï¼Œå¯¹å…¬å¸æ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„é¢å¤–æ½œåœ¨æ”¶å…¥æ¥æºã€‚

# å®¢æˆ·æµå¤±æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨å®è·µä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Ÿ

å®¢æˆ·æµå¤±é¢„æµ‹æ¨¡å‹çš„ä¸»è¦ç›®æ ‡æ˜¯é€šè¿‡ä¸»åŠ¨ä¸å®¢æˆ·æ¥è§¦æ¥ç•™ä½æµå¤±é£é™©æœ€é«˜çš„å®¢æˆ·ã€‚ä¾‹å¦‚:æä¾›ç¤¼å“åˆ¸æˆ–ä»»ä½•ä¿ƒé”€ä»·æ ¼ï¼Œå¹¶å°†å…¶é”å®šä¸€ä¸¤å¹´ï¼Œä»¥å»¶é•¿å…¶å¯¹å…¬å¸çš„ç»ˆèº«ä»·å€¼ã€‚

è¿™é‡Œæœ‰ä¸¤ä¸ªå®½æ³›çš„æ¦‚å¿µéœ€è¦ç†è§£:

*   æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå®¢æˆ·æµå¤±é¢„æµ‹æ¨¡å‹æ¥æå‰é¢„æµ‹æµå¤±(æ¯”å¦‚æå‰ä¸€ä¸ªæœˆã€æå‰ä¸‰ä¸ªæœˆã€ç”šè‡³æå‰å…­ä¸ªæœˆâ€”â€”è¿™å®Œå…¨å–å†³äºç”¨ä¾‹)ã€‚è¿™æ„å‘³ç€ä½ å¿…é¡»éå¸¸å°å¿ƒæˆªæ­¢æ—¥æœŸï¼Œå³ä½ ä¸åº”è¯¥ä½¿ç”¨æˆªæ­¢æ—¥æœŸä¹‹åçš„ä»»ä½•ä¿¡æ¯ä½œä¸ºæœºå™¨å­¦ä¹ æ¨¡å‹ä¸­çš„ç‰¹å¾ï¼Œå¦åˆ™è¿™å°†æ˜¯æ³„æ¼ã€‚æˆªæ­¢æ—¥æœŸä¹‹å‰çš„æ—¶æœŸè¢«ç§°ä¸º**äº‹ä»¶ã€‚**
*   é€šå¸¸å¯¹äºå®¢æˆ·æµå¤±é¢„æµ‹ï¼Œæ‚¨éœ€è¦åšä¸€äº›å·¥ä½œæ¥åˆ›å»ºä¸€ä¸ª ***ç›®æ ‡åˆ—*** ï¼Œå®ƒé€šå¸¸ä¸ä¼šä»¥æ‚¨æƒ³è¦çš„å½¢å¼å‡ºç°ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¸Œæœ›é¢„æµ‹å®¢æˆ·æ˜¯å¦ä¼šåœ¨ä¸‹ä¸€å­£åº¦å†…æµå¤±ï¼Œå› æ­¤æ‚¨å°†éå†æˆªè‡³äº‹ä»¶æˆªæ­¢æ—¥æœŸçš„æ‰€æœ‰æ´»è·ƒå®¢æˆ·ï¼Œå¹¶æ£€æŸ¥ä»–ä»¬æ˜¯å¦ä¼šåœ¨ä¸‹ä¸€å­£åº¦ç¦»å¼€å…¬å¸(1 è¡¨ç¤ºæ˜¯ï¼Œ0 è¡¨ç¤ºå¦)ã€‚è¿™ç§æƒ…å†µä¸‹çš„å­£åº¦ç§°ä¸º**æ€§èƒ½çª—å£**ã€‚

![](img/de307effc7b7b2e64088d06b60672eda.png)

å¦‚ä½•åˆ›å»ºå®¢æˆ·æµå¤±æ•°æ®é›†â€”æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

# å®¢æˆ·æµå¤±æ¨¡å‹å·¥ä½œæµç¨‹

ç°åœ¨ï¼Œæ‚¨å·²ç»äº†è§£äº†æ•°æ®æ˜¯å¦‚ä½•æ¥æºçš„ä»¥åŠæµå¤±ç›®æ ‡æ˜¯å¦‚ä½•åˆ›å»ºçš„(è¿™æ˜¯é—®é¢˜ä¸­æœ€å…·æŒ‘æˆ˜æ€§çš„éƒ¨åˆ†ä¹‹ä¸€)ï¼Œè®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹è¿™ç§æœºå™¨å­¦ä¹ æ¨¡å‹å°†å¦‚ä½•åœ¨ä¸šåŠ¡ä¸­ä½¿ç”¨ã€‚ä»å·¦è‡³å³é˜…è¯»ä¸‹å›¾:

*   åŸºäºå®¢æˆ·æµå¤±å†å²(X ç‰¹å¾çš„äº‹ä»¶å‘¨æœŸå’Œç›®æ ‡å˜é‡çš„æ€§èƒ½çª—å£)è®­ç»ƒæ¨¡å‹ã€‚
*   æ¯ä¸ªæœˆï¼Œæ´»è·ƒå®¢æˆ·ç¾¤éƒ½è¢«ä¼ é€’åˆ°**æœºå™¨å­¦ä¹ é¢„æµ‹æ¨¡å‹**ä¸Šï¼Œä»¥è¿”å›æ¯ä¸ªå®¢æˆ·çš„æµå¤±æ¦‚ç‡(åœ¨å•†ä¸šè¡Œè¯ä¸­ï¼Œè¿™æœ‰æ—¶è¢«ç§°ä¸ºæµå¤±åˆ†æ•°)ã€‚
*   è¯¥åˆ—è¡¨å°†ä»æœ€é«˜æ¦‚ç‡å€¼åˆ°æœ€ä½æ¦‚ç‡å€¼(æˆ–ä»–ä»¬æ‰€è¯´çš„åˆ†æ•°)æ’åºï¼Œå®¢æˆ·ä¿ç•™å›¢é˜Ÿå°†å¼€å§‹ä¸å®¢æˆ·æ¥è§¦ä»¥é˜»æ­¢å®¢æˆ·æµå¤±ï¼Œé€šå¸¸é€šè¿‡æä¾›æŸç§ä¿ƒé”€æˆ–ç¤¼å“å¡æ¥é”å®šæœªæ¥å‡ å¹´ã€‚
*   æµå¤±ç‡éå¸¸ä½çš„å®¢æˆ·(æˆ–è€…åŸºæœ¬ä¸Šæ¨¡å‹é¢„æµ‹æ²¡æœ‰æµå¤±ç‡çš„å®¢æˆ·)æ˜¯å¿«ä¹çš„å®¢æˆ·ã€‚ä¸å¯¹å®ƒä»¬é‡‡å–ä»»ä½•æ“ä½œã€‚

![](img/b2c1ea8ada193b0e4a251413490969fb.png)

å®¢æˆ·æµå¤±æ¨¡å‹å·¥ä½œæµç¨‹-æŒ‰ä½œè€…åˆ†ç±»çš„å›¾ç‰‡

# è®©æˆ‘ä»¬ä»å®é™…ä¾‹å­å¼€å§‹

åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘å°†æ¼”ç¤ºæœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒå’Œé€‰æ‹©ã€è¶…å‚æ•°è°ƒæ•´ã€ç»“æœåˆ†æå’Œè§£é‡Šçš„å®Œæ•´ç«¯åˆ°ç«¯å·¥ä½œæµã€‚æˆ‘è¿˜å°†è®¨è®ºæ‚¨å¯ä»¥ä¼˜åŒ–çš„æŒ‡æ ‡ï¼Œä»¥åŠä¸ºä»€ä¹ˆ AUCã€å‡†ç¡®æ€§ã€å¬å›ç‡ç­‰ä¼ ç»ŸæŒ‡æ ‡å¯èƒ½ä¸é€‚åˆå®¢æˆ·æµå¤±æ¨¡å‹ã€‚æˆ‘å°†ä½¿ç”¨[py caret](https://www.pycaret.org)â€”â€”ä¸€ä¸ªå¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“æ¥æ‰§è¡Œè¿™ä¸ªå®éªŒã€‚æœ¬æ•™ç¨‹å‡è®¾æ‚¨å¯¹ PyCaret æœ‰åŸºæœ¬çš„äº†è§£ã€‚

# PyCaret

[PyCaret](https://www.pycaret.org/) æ˜¯ä¸€ä¸ªå¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“å’Œç«¯åˆ°ç«¯çš„æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå†…ç½®äº Python ä¸­ï¼Œç”¨äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚PyCaret ä»¥å…¶æ˜“ç”¨æ€§ã€ç®€å•æ€§ä»¥åŠå¿«é€Ÿé«˜æ•ˆåœ°æ„å»ºå’Œéƒ¨ç½²ç«¯åˆ°ç«¯æœºå™¨å­¦ä¹ ç®¡é“çš„èƒ½åŠ›è€Œé—»åã€‚è¦äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä»–ä»¬çš„ [GitHub](https://www.github.com/pycaret/pycaret) ã€‚

![](img/f81ef235ef65d76e55b7fe5d9390ea37.png)

PyCaret çš„ç‰¹ç‚¹â€”ä½œè€…å›¾ç‰‡

# å®‰è£… PyCaret

```
**# install pycaret** pip install pycaret
```

# ğŸ‘‰èµ„æ–™ç»„

å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘ä½¿ç”¨æ¥è‡ª Kaggle çš„[ç”µä¿¡å®¢æˆ·æµå¤±](https://www.kaggle.com/blastchar/telco-customer-churn)æ•°æ®é›†ã€‚æ•°æ®é›†å·²ç»åŒ…å«æˆ‘ä»¬å¯ä»¥æŒ‰åŸæ ·ä½¿ç”¨çš„ç›®æ ‡åˆ—ã€‚æ‚¨å¯ä»¥ç›´æ¥ä»è¿™ä¸ª [GitHub](https://raw.githubusercontent.com/srees1988/predict-churn-py/main/customer_churn_data.csv) é“¾æ¥ä¸­è¯»å–è¿™ä¸ªæ•°æ®é›†ã€‚(*å¤§å–Šåˆ° sres 1988*

```
**# import libraries**
import pandas as pd
import numpy as np**# read csv data** data **=** pd.read_csv('[https://raw.githubusercontent.com/srees1988/predict-churn-py/main/customer_churn_data.csv'](https://raw.githubusercontent.com/srees1988/predict-churn-py/main/customer_churn_data.csv'))
```

![](img/dd3f77dec505febc5c81e50782d7b8a3.png)

æ ·æœ¬æ•°æ®é›†-æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

# **ğŸ‘‰æ¢ç´¢æ€§æ•°æ®åˆ†æ**

```
**# check data types** data.dtypes
```

![](img/33a6bd0578cfb55b2622268bb288a786.png)

æ•°æ®ç±»å‹-æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

æ³¨æ„åˆ°`TotalCharges`æ˜¯ä¸€ä¸ª`object`ç±»å‹ï¼Œè€Œä¸æ˜¯`float64.`ï¼Œç»è¿‡è°ƒæŸ¥ï¼Œæˆ‘å‘ç°è¿™ä¸ªåˆ—ä¸­æœ‰ä¸€äº›ç©ºæ ¼ï¼Œè¿™å¯¼è‡´ Python å°†æ•°æ®ç±»å‹å¼ºåˆ¶ä¸º`object`ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ”¹å˜æ•°æ®ç±»å‹ä¹‹å‰ä¿®å‰ªç©ºç™½ã€‚

```
**# replace blanks with np.nan**
data['TotalCharges'] = data['TotalCharges'].replace(' ', np.nan)**# convert to float64**
data['TotalCharges'] = data['TotalCharges'].astype('float64')
```

ä»ç›´è§‰ä¸Šæ¥è¯´ï¼ŒåˆåŒç±»å‹ã€æœŸé™(å®¢æˆ·åœç•™çš„æ—¶é—´é•¿åº¦)å’Œå®šä»·è®¡åˆ’æ˜¯å®¢æˆ·æµå¤±æˆ–ä¿ç•™çš„éå¸¸é‡è¦çš„ä¿¡æ¯ã€‚è®©æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹è¿™ç§å…³ç³»:

[https://gist . github . com/moe zali 1/2624 c 9 a5 EAF 78d 9 a 7 FFA 1 b 97195 a 4812](https://gist.github.com/moezali1/2624c9a5eaf78d9a7ffa1b97195a4812)

![](img/54bf208c2dbe11e3602da0163a5cd25a.png)

æŒ‰ä»»æœŸã€è´¹ç”¨å’ŒåˆåŒç±»å‹åˆ’åˆ†çš„å®¢æˆ·æµå¤±(å›¾ç‰‡ç”±ä½œè€…æä¾›)

è¯·æ³¨æ„ï¼Œå¤§å¤šæ•°æµå¤±å¯ä»¥åœ¨â€œé€æœˆâ€åˆåŒä¸­çœ‹åˆ°ã€‚å½“ç„¶æœ‰é“ç†ã€‚æ­¤å¤–ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ï¼Œéšç€ä»»æœŸçš„å¢åŠ å’Œæ€»è´¹ç”¨çš„å¢åŠ ï¼Œä¸é«˜ä»»æœŸå’Œé«˜è´¹ç”¨çš„å®¢æˆ·ç›¸æ¯”ï¼Œé«˜ä»»æœŸå’Œä½è´¹ç”¨çš„å®¢æˆ·çš„å¯èƒ½æ€§è¾ƒå°ã€‚

**ç¼ºå¤±å€¼**

```
**# check missing values** data.isnull().sum()
```

![](img/a68b992a59f3ae5dc88f92bcff13de60.png)

ç¼ºå¤±å€¼-æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

è¯·æ³¨æ„ï¼Œå› ä¸ºæˆ‘ä»¬ç”¨`np.nan`æ›¿æ¢äº†ç©ºç™½å€¼ï¼Œæ‰€ä»¥ç°åœ¨`TotalCharges`ä¸­æœ‰ 11 è¡Œç¼ºå°‘å€¼ã€‚æ²¡é—®é¢˜â€”â€”æˆ‘ä¼šè®© PyCaret è‡ªåŠ¨ä¼°ç®—å®ƒã€‚

# **ğŸ‘‰æ•°æ®å‡†å¤‡**

å¯¹äº PyCaret ä¸­çš„æ‰€æœ‰æ¨¡å—æ¥è¯´ï¼Œ`setup`æ˜¯åœ¨ PyCaret ä¸­æ‰§è¡Œçš„ä»»ä½•æœºå™¨å­¦ä¹ å®éªŒä¸­çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ªå¼ºåˆ¶æ­¥éª¤ã€‚è¯¥åŠŸèƒ½è´Ÿè´£è®­ç»ƒæ¨¡å‹ä¹‹å‰æ‰€éœ€çš„æ‰€æœ‰æ•°æ®å‡†å¤‡ã€‚é™¤äº†æ‰§è¡Œä¸€äº›åŸºæœ¬çš„é»˜è®¤å¤„ç†ä»»åŠ¡ï¼ŒPyCaret è¿˜æä¾›äº†ä¸€ç³»åˆ—é¢„å¤„ç†åŠŸèƒ½ã€‚è¦äº†è§£ PyCaret ä¸­æ‰€æœ‰é¢„å¤„ç†åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¿™ä¸ª[é“¾æ¥](https://pycaret.org/preprocessing/)ã€‚

```
**# init setup**
from pycaret.classification import *
s = setup(data, target = 'Churn', ignore_features = ['customerID'])
```

![](img/f48a089eb1cde78706de55cfb3dfb81d.png)

pycaret.classification ä¸­çš„è®¾ç½®å‡½æ•°â€”æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

æ¯å½“åœ¨ PyCaret ä¸­åˆå§‹åŒ–`setup`å‡½æ•°æ—¶ï¼Œå®ƒéƒ½ä¼šåˆ†ææ•°æ®é›†å¹¶æ¨æ–­æ‰€æœ‰è¾“å…¥è¦ç´ çš„æ•°æ®ç±»å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥çœ‹åˆ°é™¤äº†`tenure` `MonthlyCharges`å’Œ`TotalCharges`ä¹‹å¤–ï¼Œå…¶ä»–éƒ½æ˜¯ç»å¯¹çš„ï¼Œè¿™æ˜¯æ­£ç¡®çš„ï¼Œä½ ç°åœ¨å¯ä»¥æŒ‰å›è½¦é”®ç»§ç»­ã€‚å¦‚æœæ•°æ®ç±»å‹æ¨æ–­ä¸æ­£ç¡®(è¿™æœ‰æ—¶ä¼šå‘ç”Ÿ)ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`numeric_feature`å’Œ`categorical_feature`æ¥è¦†ç›–æ•°æ®ç±»å‹ã€‚

å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘å·²ç»åœ¨`setup`å‡½æ•°ä¸­ä¼ é€’äº†`ignore_features = ['customerID']`ï¼Œå› æ­¤åœ¨è®­ç»ƒæ¨¡å‹æ—¶ä¸ä¼šè€ƒè™‘å®ƒã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ PyCaret ä¸ä¼šä»æ•°æ®é›†ä¸­åˆ é™¤è¯¥åˆ—ï¼Œå®ƒåªæ˜¯åœ¨æ¨¡å‹è®­ç»ƒçš„å¹•åå¿½ç•¥å®ƒã€‚å› æ­¤ï¼Œå½“æ‚¨åœ¨æœ€åç”Ÿæˆé¢„æµ‹æ—¶ï¼Œæ‚¨ä¸éœ€è¦æ‹…å¿ƒè‡ªå·±å°† IDs è¿æ¥å›æ¥ã€‚

![](img/bed1294c9c2e11b48a855b5c59015626.png)

è®¾ç½®çš„è¾“å‡º-ä¸ºæ˜¾ç¤ºè€Œæˆªæ–­-ä½œè€…æä¾›çš„å›¾åƒ

# ğŸ‘‰æ¨¡å‹è®­ç»ƒå’Œé€‰æ‹©

ç°åœ¨æ•°æ®å‡†å¤‡å·¥ä½œå·²ç»å®Œæˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`compare_models`åŠŸèƒ½å¼€å§‹åŸ¹è®­è¿‡ç¨‹ã€‚æ­¤å‡½æ•°è®­ç»ƒæ¨¡å‹åº“ä¸­å¯ç”¨çš„æ‰€æœ‰ç®—æ³•ï¼Œå¹¶ä½¿ç”¨äº¤å‰éªŒè¯è¯„ä¼°å¤šä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚

```
**# compare all models**
best_model = compare_models(sort='AUC')
```

![](img/962712dcc0da1a2f4e9ea20045e56024.png)

compare_models çš„è¾“å‡ºâ€”æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

åŸºäº **AUC** çš„æœ€ä½³æ¨¡å‹æ˜¯`Gradient Boosting Classifier` ã€‚ä½¿ç”¨ 10 å€äº¤å‰éªŒè¯çš„ AUC ä¸º 0.8472ã€‚

```
**# print best_model parameters**
print(best_model)
```

![](img/ba09cf95edcb60ebec3c1b5960204583.png)

æœ€ä½³æ¨¡å‹å‚æ•°â€”ä½œè€…å›¾ç‰‡

# **è¶…å‚æ•°è°ƒè°**

æ‚¨å¯ä»¥ä½¿ç”¨ PyCaret ä¸­çš„`tune_model`å‡½æ•°æ¥è‡ªåŠ¨è°ƒæ•´æ¨¡å‹çš„è¶…å‚æ•°ã€‚

```
**# tune best model**
tuned_best_model = tune_model(best_model)
```

![](img/c5c99dd0109c979e6705ffa80a081c6e.png)

tune_model ç»“æœâ€”ä½œè€…æä¾›çš„å›¾ç‰‡

è¯·æ³¨æ„ï¼ŒAUC ä»`0.8472`åˆ°`0.8478`ç•¥æœ‰å¢åŠ ã€‚

# æ¨¡å‹åˆ†æ

```
**# AUC Plot**
plot_model(tuned_best_model, plot = 'auc')
```

![](img/8cf753e596e64dfb8615d375b5404f24.png)

AUC å›¾â€”ä½œè€…æä¾›çš„å›¾åƒ

```
**# Feature Importance Plot**
plot_model(tuned_gbc, plot = 'feature')
```

![](img/358abaa3d04d62d698e0e0ef9dd48a50.png)

ç‰¹å¾é‡è¦æ€§å›¾â€”æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

```
**# Confusion Matrix**
plot_model(tuned_best_model, plot = 'confusion_matrix')
```

![](img/42cbed43c3d42668f51908ae5c0cc5a6.png)

æ··æ·†çŸ©é˜µæ¢¯åº¦æ¨è¿›åˆ†ç±»å™¨â€”å›¾ç‰‡ç”±ä½œè€…æä¾›

è¿™ä¸ªæ··æ·†çŸ©é˜µåœ¨æµ‹è¯•é›†ä¸Šï¼Œæµ‹è¯•é›†åŒ…æ‹¬æˆ‘ä»¬ 30%çš„æ•°æ®(2ï¼Œ113 è¡Œ)ï¼Œæˆ‘ä»¬æœ‰ 309 ä¸ª ***çœŸé˜³æ€§*** (15%) â€”è¿™äº›æ˜¯æˆ‘ä»¬å°†èƒ½å¤Ÿå»¶é•¿ç”Ÿå‘½å‘¨æœŸä»·å€¼çš„å®¢æˆ·ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰é¢„æµ‹åˆ°ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¹²é¢„çš„æœºä¼šã€‚

æˆ‘ä»¬ä¹Ÿæœ‰ 138 (7%) ***è¯¯æŠ¥*** æˆ‘ä»¬å°†ä¼šæŸå¤±é‡‘é’±ï¼Œå› ä¸ºæä¾›ç»™è¿™äº›å®¢æˆ·çš„ä¿ƒé”€åªæ˜¯é¢å¤–çš„æˆæœ¬ã€‚

1388 ä¸ª(66%)æ˜¯çœŸé˜´æ€§(å¥½å®¢æˆ·)ï¼Œ278 ä¸ª(13%)æ˜¯ ***å‡é˜´æ€§*** (è¿™æ˜¯é”™è¿‡çš„æœºä¼š)ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»è®­ç»ƒäº†å¤šä¸ªæ¨¡å‹ï¼Œä»¥é€‰æ‹©ç»™å‡ºæœ€é«˜ AUC çš„æœ€ä½³æ¨¡å‹ï¼Œç„¶åè°ƒæ•´æœ€ä½³æ¨¡å‹çš„è¶…å‚æ•°ï¼Œä»¥åœ¨ AUC æ–¹é¢è·å¾—æ›´å¤šä¸€ç‚¹çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œæœ€å¥½çš„ AUC ä¸ä¸€å®šè½¬åŒ–ä¸ºæœ€å¥½çš„å•†ä¸šæ¨¡å¼ã€‚

åœ¨ä¸€ä¸ªæµå¤±æ¨¡å‹ä¸­ï¼Œé€šå¸¸ ***çœŸé˜³æ€§*** çš„å›æŠ¥ä¸ ***å‡é˜³æ€§*** çš„æˆæœ¬å¤§ç›¸å¾„åº­ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‡è®¾:

*   å°†å‘æ‰€æœ‰è¢«è¯†åˆ«ä¸ºæµå¤±çš„å®¢æˆ·æä¾› 1000 ç¾å…ƒçš„ä»£é‡‘åˆ¸(çœŸé˜³æ€§+å‡é˜³æ€§)ï¼›
*   å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿé˜»æ­¢å®¢æˆ·æµå¤±ï¼Œæˆ‘ä»¬å°†è·å¾— 5000 ç¾å…ƒçš„å®¢æˆ·ç»ˆèº«ä»·å€¼ã€‚

ä½¿ç”¨è¿™äº›å‡è®¾å’Œä¸Šé¢çš„æ··æ·†çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—è¯¥æ¨¡å‹çš„ç¾å…ƒå½±å“:

![](img/c5aa5ac32cabd28b55cb1a8ba89558f6.png)

æ¨¡å‹å¯¹ 2ï¼Œ113 åå®¢æˆ·çš„å½±å“â€”â€”å›¾ç‰‡ç”±ä½œè€…æä¾›

è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ¨¡å¼ï¼Œä½†é—®é¢˜æ˜¯å®ƒä¸æ˜¯ä¸€ä¸ªå•†ä¸šæ™ºèƒ½æ¨¡å¼ã€‚ä¸æ²¡æœ‰æ¨¡å‹ç›¸æ¯”ï¼Œå®ƒåšå¾—éå¸¸å¥½ï¼Œä½†æ˜¯æˆ‘ä»¬å¦‚ä½•è®­ç»ƒå’Œé€‰æ‹©ä¸€ä¸ªæ¨¡å‹æ¥æœ€å¤§åŒ–å•†ä¸šä»·å€¼ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸šåŠ¡æŒ‡æ ‡æ¥è®­ç»ƒã€é€‰æ‹©å’Œä¼˜åŒ–æ¨¡å‹ï¼Œè€Œä¸æ˜¯ä»»ä½•ä¼ ç»Ÿçš„æŒ‡æ ‡ï¼Œå¦‚ AUC æˆ–å‡†ç¡®æ€§ã€‚

# **ğŸ‘‰åœ¨ PyCaret** ä¸­æ·»åŠ è‡ªå®šä¹‰æŒ‡æ ‡

å¤šäºäº† PyCaretï¼Œä½¿ç”¨`add_metric`å‡½æ•°å¯ä»¥éå¸¸å®¹æ˜“åœ°å®ç°è¿™ä¸€ç‚¹ã€‚

```
**# create a custom function** def calculate_profit(y, y_pred):
    tp = np.where((y_pred==1) & (y==1), (5000-1000), 0)
    fp = np.where((y_pred==1) & (y==0), -1000, 0)
    return np.sum([tp,fp])**# add metric to PyCaret** add_metric('profit', 'Profit', calculate_profit)
```

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œ`compare_models`çœ‹çœ‹ç¥å¥‡ä¹‹å¤„ã€‚

```
**# compare all models**
best_model = compare_models(sort='Profit')
```

![](img/4e6cf328bc091de52592565c4ffab023.png)

compare_models çš„è¾“å‡ºâ€”æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ

è¯·æ³¨æ„ï¼Œè¿™æ¬¡æ·»åŠ äº†ä¸€ä¸ªæ–°åˆ—`Profit`ï¼Œä»¤äººæƒŠè®¶çš„æœ´ç´ è´å¶æ–¯æ˜¯ä¸€ä¸ªåœ¨`AUC`æ–¹é¢ç›¸å½“ç³Ÿç³•çš„æ¨¡å‹ï¼Œä½†åœ¨åˆ©æ¶¦æ–¹é¢å´æ˜¯æœ€å¥½çš„æ¨¡å‹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•:

```
**# confusion matrix**
plot_model(best_model, plot = 'confusion_matrix')
```

![](img/43111ebbacc9b3b98dcb0cd8cfdb0830.png)

æ··æ·†çŸ©é˜µæœ´ç´ è´å¶æ–¯-ä½œè€…å›¾ç‰‡

å®¢æˆ·çš„æ€»æ•°ä»ç„¶æ˜¯ä¸€æ ·çš„(æµ‹è¯•é›†ä¸­æœ‰ 2ï¼Œ113 ä¸ªå®¢æˆ·)ï¼Œç°åœ¨å‘ç”Ÿå˜åŒ–çš„æ˜¯æ¨¡å‹å¦‚ä½•åœ¨è¯¯æŠ¥å’Œæ¼æŠ¥ä¸Šå‡ºé”™ã€‚è®©æˆ‘ä»¬ç”¨åŒæ ·çš„å‡è®¾(å¦‚ä¸Šæ‰€è¿°),ç”¨ä¸€äº›ç¾å…ƒä»·å€¼æ¥åå¯¹å®ƒ:

![](img/be597c8bb1b5a91d06c60dde98abec7e.png)

æ¨¡å‹å¯¹ 2ï¼Œ113 åå®¢æˆ·çš„å½±å“â€”â€”å›¾ç‰‡ç”±ä½œè€…æä¾›

> ***å˜­ï¼*** *æˆ‘ä»¬åˆšåˆšå¢åŠ äº†çº¦ 400ï¼Œ000 ç¾å…ƒçš„åˆ©æ¶¦ï¼Œå…¶ AUC æ¯”æœ€ä½³å‹å·ä½ 2%ã€‚è¿™æ˜¯æ€ä¹ˆå‘ç”Ÿçš„ï¼Ÿé¦–å…ˆï¼ŒAUC æˆ–ä»»ä½•å…¶ä»–ç°æˆçš„åˆ†ç±»æŒ‡æ ‡(*å‡†ç¡®åº¦ã€å¬å›ç‡ã€ç²¾ç¡®åº¦ã€F1ã€Kappa ç­‰)ã€‚*)ä¸æ˜¯ä¸€ä¸ªå•†ä¸šæ™ºèƒ½æŒ‡æ ‡ï¼Œå› æ­¤å®ƒæ²¡æœ‰è€ƒè™‘é£é™©å’Œå›æŠ¥ã€‚æ·»åŠ è‡ªå®šä¹‰æŒ‡æ ‡å¹¶å°†å…¶ç”¨äºæ¨¡å‹é€‰æ‹©æˆ–ä¼˜åŒ–æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æƒ³æ³•å’Œæ­£ç¡®çš„æ–¹æ³•ã€‚*

æˆ‘å¸Œæœ›ä½ ä¼šå–œæ¬¢ PyCaret çš„ç®€å•æ˜“ç”¨ã€‚åªéœ€å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè®­ç»ƒå¤šä¸ªæ¨¡å‹ï¼Œå¹¶é€‰æ‹©å¯¹ä¸šåŠ¡è‡³å…³é‡è¦çš„æ¨¡å‹ã€‚æˆ‘æ˜¯ä¸€ä¸ªæ™®é€šçš„åšå®¢ä½œè€…ï¼Œæˆ‘ä¸»è¦å†™ PyCaret åŠå…¶åœ¨ç°å®ä¸–ç•Œä¸­çš„ç”¨ä¾‹ï¼Œå¦‚æœä½ æƒ³è‡ªåŠ¨æ”¶åˆ°é€šçŸ¥ï¼Œä½ å¯ä»¥åœ¨ [Medium](https://medium.com/@moez-62905) ã€ [LinkedIn](https://www.linkedin.com/in/profile-moez/) å’Œ [Twitter](https://twitter.com/moezpycaretorg1) ä¸Šå…³æ³¨æˆ‘ã€‚

![](img/a2b33c94ff198e448e08dc3f87383811.png)

PyCaret â€”ä½œè€…å›¾ç‰‡

![](img/de69aee1dba2d884b952c8a15d9d4a1b.png)

PyCaret â€”ä½œè€…å›¾ç‰‡

ä½¿ç”¨ Python ä¸­çš„è¿™ä¸ªè½»é‡çº§å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°çš„ç›®æ ‡æ˜¯æ— é™çš„ã€‚å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°ç»™æˆ‘ä»¬ GitHub åº“ä¸Šçš„â­ï¸ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·åœ¨ LinkedIn å’Œ Youtube ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚

åŠ å…¥æˆ‘ä»¬çš„ä¼‘é—²é¢‘é“ã€‚é‚€è¯·é“¾æ¥[æ­¤å¤„](https://join.slack.com/t/pycaret/shared_invite/zt-p7aaexnl-EqdTfZ9U~mF0CwNcltffHg)ã€‚

# é‡è¦é“¾æ¥

[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/installation.html)
[åšå®¢](https://medium.com/@moez_62905)
[GitHub](http://www.github.com/pycaret/pycaret)
[stack overflow](https://stackoverflow.com/questions/tagged/pycaret)
[å®‰è£… PyCaret](https://pycaret.readthedocs.io/en/latest/installation.html) [ç¬”è®°æœ¬æ•™ç¨‹](https://pycaret.readthedocs.io/en/latest/tutorials.html) [æŠ•ç¨¿äº PyCaret](https://pycaret.readthedocs.io/en/latest/contribute.html)

# æ›´å¤š PyCaret ç›¸å…³æ•™ç¨‹:

</machine-learning-in-alteryx-with-pycaret-fafd52e2d4a>  </machine-learning-in-knime-with-pycaret-420346e133e2>  </easy-mlops-with-pycaret-mlflow-7fbcbf1e38c6>  </write-and-train-your-own-custom-machine-learning-models-using-pycaret-8fa76237374e> [## ä½¿ç”¨ PyCaret ç¼–å†™å’Œè®­ç»ƒæ‚¨è‡ªå·±çš„è‡ªå®šä¹‰æœºå™¨å­¦ä¹ æ¨¡å‹

towardsdatascience.com](/write-and-train-your-own-custom-machine-learning-models-using-pycaret-8fa76237374e) </build-with-pycaret-deploy-with-fastapi-333c710dc786>  </time-series-anomaly-detection-with-pycaret-706a6e2b2427>  </supercharge-your-machine-learning-experiments-with-pycaret-and-gradio-5932c61f80d9>  </multiple-time-series-forecasting-with-pycaret-bc0a779a22fe> 