# 超简洁的 Python 代码——精简代码并获得更好的精神健康

> 原文：<https://towardsdatascience.com/ultra-concise-python-code-shaving-code-and-finding-better-mental-health-24cc71439bce?source=collection_archive---------31----------------------->

![](img/0b1a4ae8c4f5d64619d65a45a4b88ed0.png)

作者图片

我称之为:razor **fine** 代码，但是“fine”使我们在这里讨论的东西变得模糊不清。这是严密的 python 代码。它的工作是用几行文字表达。但是是好是坏是你的事。这是你的心理健康电话。让我们做好准备:

当评审人员不幸检查我的代码时，他们被一位主管(现已去世)所说的“强烈厌恶声明变量两次”所伤害那位主管宁愿踩在黏糊糊的鳄梨核上滑倒，也不愿给予表扬。他没有给。不，他不喜欢我的清单理解`[i for i in range(….)]`、频繁的羊肉(`l = lambda x: …`)或者我的发型(-)。很好——我的第一直觉——因为他的代码很糟糕！但在他最后一次登录 github 并把他的账户留在地上后，我有理由思考。当某人的回购突然终止时，回顾我们与他的斗争是一种礼貌。为了配合超黑暗和广泛的单一材料主题的早晨——你明白的。嗯……我思考了一下，最终我明白了。他鄙视他的工作。当然，我不必用单行循环和修饰类来填充我的代码。我也可以去剪头发。但后来，我意识到:我喜欢它。我写代码的方式让我很开心。超简洁代码的噼啪声是好代码——对我来说是好代码——你也会发现对你也是好代码。

没有人喜欢重复自己——不重复是好习惯。但是我有一种倾向，那就是把好的练习“弯曲”到我古老的内在意大利语:Sorta di Estremo。Python 3.8 引入了新的“walrus”赋值操作符`:= `，从而引发了公共行为的变化。突然间，我们可以让代码变得超级紧凑，把袜子之类的新变量塞进口袋里，以便当天晚些时候使用。

```
a = 12 if (list_length := len(super_duper_long_list)) > 20000000 else list_length
```

(需要 Python 3.8+因为:=赋值表达式)

现在—能够在 if 语句中间声明一个变量 slap bang，然后在同一个语句中继续使用它，这有多好？太棒了。在上面的例子中，我们避免两次计算列表的长度。崇高的事业。为表现而拍背。是的，我们可以在 if 语句之前，得到列表的长度。但是我们会增加一条额外的线。这重要吗？好吧，如果我们遵循的原则是编写清晰简洁的代码，那么这很重要。因为受原则指导的人——在特定情况下指导他们如何行动的规则——以及从这些原则中看到好结果的人，他们是快乐的人。

成为一名优秀的编码员就是成为一名坚持编写简洁、高效、干净的代码并相信这一点的编码员。他们喜欢无需滚动就能适应屏幕的功能。

我们可以认为，变量的定义和它的使用都与这种语法保持在一起。团结无疑是一件非常好的事情，不是吗？内容和形式的结合。但是暂且把诡辩放在一边，我们也在避免一个变量被移动或分配到其他地方的错误和挫折。小 m 代表小优势。但是等等——在程序的生命中，我们不都已经到达了这样一个阶段吗？代码变得如此混乱，以至于我们无法正视混乱的源文件中的光标，更不用说引入变化或发现潜伏在某处的问题了。你当然有。这是一个愚蠢的作业错误(通常)。如果你和我一样是半个代码折叠牛仔，我肯定你会看到简洁代码的悲剧魔力。这就是“海象”,也就是`:= '操作符固定在语法中的东西，以便重新呼吸到 IDE 中——称之为代码的 KonMari 整洁——对我们的精神健康有相当大的好处。

好吧，我会——重构这简洁的一行有点困难。但是作为程序员，我们写代码来表达意图。这可能是我们的意图，或者是计算类的意图，但问题是我们如何让它浮在外面。即使它是最终的效果，我们代码的结果和影响，在开发的后期“bug”和关注我们——它是我们描绘程序的代码行。其他工具，如儿童视觉编码和人工智能翻译可能会在这里或那里爆发。但是现在我们的代码是关于笔触的，最好的基础是简洁。

想要另一个巧克力的例子吗？

```
max([l for p in glob.glob(parent_dir + “*”) for l in p if style_1_name in p if l.isnumeric()])
```

这个小小的列表理解获得了包含最大数字的文件路径(我特别喜欢像这样的双列表和三列表理解的顽皮处理——但是有人能想出一个优雅的方法来扩展它以处理包含大于 9 的数字的文件路径吗)。紧凑、极薄的代码可能非常有效——几个像样的变量名可能会解决一些问题——但是紧凑的代码效果最好。为什么？除了不得不实际思考我们所写的东西，除了更有效率，它变成了一个疯狂有趣的游戏，使我们的代码整洁、紧凑和实用。

把这些想象成在概念上类似于一个小的数学证明。即使它们没那么难。编程回归我们曾经玩的游戏出于选择(为了好玩！).这些归结起来的线成为足够小的挑战，一天可以解决多次，奖励足够鼓励更多的实践。然而，与大多数成人游戏不同，这些游戏实际上是有目的的。结果是超级整洁的代码，本质上更容易返回和审查。但是这种剃刀式编码实践的“游戏”元素并不是一个可以嘲笑的次要或附带的好处。

我希望我在生活中早点发现，享受工作的人并不是那些注意力持续时间像国王一样长的人。更确切地说，他们是那些了解他们的东西的人，正是那些了解东西的人给了最终的程序爪子。当然，它仍然需要翅膀才能飞翔，但是除非我们给它爪子，否则它无法在第一个使用者面前存活。

一位嬉皮士朋友说，“它在 IDE 里排了很长的队”，这次我有幸做了监督。但是那又怎么样呢？“一长串的真理只是句法上的真理。像这样写我们的 listy 代码是完全合法的 Python:"

```
image_paths = [p for f in [glob.glob(f”{t}/*” if t[-1] != “/”else f”{t}*”) for t in directory_paths]
for p in f if p[-3:] == “jpg”or p[-3:] == “png”]
```

“一个两倍价格的 bargin 五个一米老 mucka 的价格”[1]。是我们用冗长的形式或紧凑而明快的耳语方式来定义演示。重要的是，我们被鼓励挤压更多，并保持纪律。那是音调代码。

## 我们的无限循环

为什么简洁对我们来说很重要？我们只是对更简洁的代码感到自豪——它让我们在工作中得到尊重，从而得到更多的尊重和关心……我们在工作中更快乐。相当多。这是一个反馈循环，它让我们更有动力去探索项目中新的和不舒服的领域，语言，领域。当然，有很多兔子洞——但是你我的文学朋友不是爱丽丝。你是你的公司和利益可以乞求、借用或窃取的最好的程序员。这表现在你的作品中。

[1]我实际上从未说过那一点。但是想到我做到了就很有趣