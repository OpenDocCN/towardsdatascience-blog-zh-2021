# ä¸€ä¸ªéå¸¸è§„ä½†æ–¹ä¾¿çš„ Matplotlib Broken_Barh å‡½æ•°ï¼Œå½“å®ƒç‰¹åˆ«æœ‰ç”¨æ—¶

> åŸæ–‡ï¼š<https://towardsdatascience.com/an-unconventional-yet-convenient-matplotlib-broken-barh-function-and-when-it-is-particularly-88887b76c127?source=collection_archive---------26----------------------->

## å®ƒæ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•ä½¿ç”¨å’Œå®šåˆ¶ï¼Œä½•æ—¶ä½¿ç”¨

![](img/0cd0e8b812894f2eb0963399f04f8dfa.png)

ä½œè€…å›¾ç‰‡

å°½ç®¡å¯¹äº Python ä¸­çš„æŸäº›æ•°æ®å¯è§†åŒ–æƒ…å†µéå¸¸æ–¹ä¾¿ï¼Œä½†`[broken_barh](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.broken_barh.html)`æ˜¯ matplotlib ä¸­ä¸å¤ªä¸ºäººæ‰€çŸ¥å’Œè¢«ä½ä¼°çš„æ–¹æ³•ä¹‹ä¸€ã€‚å®ƒç”¨äºç»˜åˆ¶ä¸åŒ x èŒƒå›´çš„æ°´å¹³çŸ©å½¢åºåˆ—ï¼Œå¹¶ä¸”ä½äº y èŒƒå›´å®šä¹‰çš„ç›¸åŒå‚ç›´ä½ç½®ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒäº§ç”Ÿäº†ä¸€ä¸ªâ€œæ–­å¼€çš„â€æ°´å¹³æ¡å½¢å›¾ï¼Œå³ä¸€ä¸ªæœ‰é—´éš™çš„å›¾ã€‚

è¯­æ³•éå¸¸ç®€å•:è¯¥å‡½æ•°ä¸»è¦æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œ`xranges`å’Œ`yrange`ã€‚`xranges`å‚æ•°è¡¨ç¤º 2 é¡¹å…ƒç»„çš„åˆ—è¡¨æˆ–å…ƒç»„ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç»„çš„ç¬¬ä¸€é¡¹`xmin`æ˜¯ç›¸åº”çŸ©å½¢çš„æœ€å·¦ä¾§ x ä½ç½®ï¼Œç¬¬äºŒé¡¹`xwidth`æ˜¯è¯¥çŸ©å½¢çš„å®½åº¦ã€‚`yrange`å‚æ•°æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œè¡¨ç¤ºæ‰€æœ‰çŸ©å½¢çš„ y ä½ç½®å’Œé«˜åº¦ã€‚

ä¸€ä¸ªåŸºæœ¬çš„æƒ…èŠ‚æ˜¯è¿™æ ·çš„:

```
import matplotlib.pyplot as plt
import seaborn as sns
plt.figure(figsize=(8,2))
plt.broken_barh(xranges=[(1, 1), (3, 2)], yrange=(1, 1))
sns.despine()
plt.show()
```

![](img/b377dae9b05bdd792e4dfe417e6332e1.png)

ä½œè€…å›¾ç‰‡

ä¸€äº›é¢å¤–çš„ä¸è¨€è‡ªæ˜çš„å‚æ•°å¯ä»¥ç”¨æ¥å®šåˆ¶ç»“æœçŸ©å½¢çš„å¤–è§‚:`color`ã€`alpha`ã€`edgecolor`ã€`linewidth`ã€`linestyle`(å¯ä»¥æ˜¯`'solid'`ã€`'dashed'`ã€`'dashdot'`æˆ–`'dotted'`)ã€‚`hatch`å‚æ•°ç”¨äºç”¨å›¾æ¡ˆå¡«å……çŸ©å½¢ï¼Œå¯ä»¥å–ä¸‹åˆ—å€¼ä¹‹ä¸€æˆ–å…¶ç»„åˆä½œä¸ºå­—ç¬¦ä¸²:`/`ã€`\\`ã€`|`ã€`-`ã€`+`ã€`x`ã€`o`ã€`O`ã€`.`ã€`*`ã€‚`label`å‚æ•°è®¾ç½®å°†åœ¨å›¾ä¾‹ä¸­æ˜¾ç¤ºçš„æ ‡ç­¾ã€‚

è¿™äº›å‚æ•°ä¸­çš„æ¯ä¸€ä¸ªéƒ½å¯ä»¥æ˜¯åº”ç”¨äºæ‰€æœ‰çŸ©å½¢çš„å•ä¸ªè‡ªå˜é‡(æµ®ç‚¹æˆ–å­—ç¬¦ä¸²)(ä¾‹å¦‚`color='red'`)æˆ–è‡ªå˜é‡çš„åˆ—è¡¨/å…ƒç»„(ä¾‹å¦‚`color=('red','blue')`)ï¼Œåœ¨è¯¥åˆ—è¡¨/å…ƒç»„ä¸Šè¿­ä»£ä»¥åˆ›å»ºçŸ©å½¢çš„é—´æ­‡åºåˆ—:

```
plt.figure(figsize=(15,2))
x1 = (1, 1), (2.1, 2), (5, 2), (7.2, 1)
y1 = (1, 1)
plt.broken_barh(x1, y1, 
                color=['slateblue', 'orange'], alpha=0.7, 
                linewidth=4, 
                edgecolor=['black', 'brown', 'green', 'blue'], 
                linestyle='dashed', hatch='/')
sns.despine()
plt.show()
```

![](img/04b6b51f3225514ba193da03fef5bb68.png)

ä½œè€…å›¾ç‰‡

æˆ‘çŸ¥é“ï¼Œä¸Šé¢çš„æƒ…èŠ‚çœ‹èµ·æ¥æœ‰ç‚¹è®©äººä¸çŸ¥æ‰€æªğŸ™‚ç„¶è€Œï¼Œå®ƒæ¸…æ¥šåœ°æ˜¾ç¤ºäº†é™„åŠ å‚æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

`broken_barh`å‡½æ•°ä»€ä¹ˆæ—¶å€™èƒ½åœ¨ç°å®ä¸–ç•Œä¸­æ´¾ä¸Šç”¨åœºï¼Ÿ

# 1.è¦æ˜¾ç¤ºèŒƒå›´

ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŒä¸€ä¸ªå›¾ä¸Šæ˜¾ç¤ºä¸åŒç±»åˆ«çš„èŒƒå›´ï¼Œä¾‹å¦‚:

*   ä¸åŒç§ç±»åŠ¨ç‰©çš„è¾¹ç•Œæ¡ä»¶(æ¯”å¦‚æ¸©åº¦),
*   ä¸åŒåœ°ç†ä½ç½®åœ¨ä¸€æ®µæ—¶é—´å†…çš„é™é›¨é‡ï¼Œ
*   å„ç§å·¥ä½œçš„å·¥èµ„èŒƒå›´ã€‚

è®©æˆ‘ä»¬ç”¨è™šæ‹Ÿæ•°æ®æ¥çœ‹çœ‹æœ€åä¸€ç§æƒ…å†µ:

```
x_ranges = [[(3800, 600)], [(2000, 1000)], [(2700, 800)]]
y_start = 1
colors = ['deepskyblue', 'limegreen', 'magenta']
for i in range(len(x_ranges)):
    plt.broken_barh(x_ranges[i], (y_start+i, 0.5), color=colors[i])    
plt.title('Salary ranges by job ($)', fontsize=25)
plt.xticks(fontsize=14)
plt.yticks(ticks=[1.25, 2.25, 3.25], 
           labels=['Job1', 'Job2', 'Job3'], fontsize=16)
plt.tick_params(left=False)
sns.despine()
plt.show()
```

![](img/8dd5ced6aec8bae72d6f244c37b67d4e.png)

ä½œè€…å›¾ç‰‡

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`broken_barh`æ–¹æ³•å®é™…ä¸Šä¸ºæ¯ä¸ªç±»åˆ«ç»˜åˆ¶äº†ä¸€ä¸ªçŸ©å½¢ã€‚

**æ³¨æ„:**å½“æˆ‘ä»¬å¿…é¡»ä¸ºä¸€ä¸ªç±»åˆ«åªç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»å°†ç›¸åº”çš„ 2 é¡¹å…ƒç»„æ”¾åœ¨*åˆ—è¡¨*ä¸­ï¼Œè€Œä¸æ˜¯æ”¾åœ¨*å…ƒç»„*ä¸­ã€‚

# 2.å¼ºè°ƒå¦ä¸€ä¸ªå›¾å½¢ä¸Šçš„æŸäº›éŸ³ç¨‹

åœ¨å¼ºè°ƒå…¶ä»–å›¾è¡¨ä¸Šçš„æŸäº›ç‰¹å®šåŒºé—´æ—¶ï¼Œ`broken_barh`æ–¹æ³•æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ä¾‹å¦‚:

*   æˆ‘ä»¬æœ‰ä¸€ä¸ªåœ°ç†åŒºåŸŸåœ¨ä¸€æ®µæ—¶é—´å†…æ¸©åº¦æ³¢åŠ¨çš„çº¿å›¾ï¼Œæˆ‘ä»¬å¸Œæœ›æ˜¾ç¤ºæ¸©åº¦é«˜äºæŸä¸ªå€¼çš„æ—¶é—´é—´éš”ï¼Œ
*   è´§å¸æ±‡ç‡éšç€åˆ©æ¯çš„å˜åŒ–è€Œå˜åŒ–ï¼Œ
*   å½“äº¤é€šæ¯”å¹³å‡æ°´å¹³æ›´æ‹¥æŒ¤æ—¶ï¼Œäº¤é€šæµé‡æ³¢åŠ¨

ä¸‹å›¾å‡†ç¡®åœ°ä»£è¡¨äº†æœ€åä¸€ç§æƒ…å†µ:å·¥ä½œæ—¥ä» 06:00 åˆ° 19:00ï¼Œ [I-94 å·é™…å…¬è·¯](https://en.wikipedia.org/wiki/Interstate_94)ä¸Šæ¯å°æ—¶çš„äº¤é€šé‡æ³¢åŠ¨(æ•°æ®å–è‡ª [this repository](https://archive.ics.uci.edu/ml/datasets/Metro+Interstate+Traffic+Volume) ï¼Œç»è¿‡ä¿®æ”¹å’Œç•¥å¾®ä¿®æ”¹)ã€‚æˆ‘ä»¬åº”ç”¨äº†`broken_barh`æ–¹æ³•æ¥å¼ºè°ƒæµé‡é«˜äºå¹³å‡æ°´å¹³çš„æ—¶é—´èŒƒå›´:

```
import pandas as pd
cars_per_hr = pd.Series([4141, 4740, 4587, 4485, 4185, 4466, 4718, 4801, 4932, 5241, 5664, 5310, 4264, 3276])# Create a line plot
plt.figure(figsize=(10,5))
plt.plot(cars_per_hr, color="grey")# Create a broken horizontal bar plot
x = [(0.8, 0.95), (5.65, 6)]
y = (cars_per_hr.mean()-50, 100)
plt.broken_barh(x, y, color ='red')plt.title('Traffic volume from 06.00 till 19.00 on weekdays', 
          fontsize=25)
plt.xlabel('Time', fontsize=20)
plt.ylabel('Traffic volume, cars/hr', fontsize=20)
plt.xticks(ticks=list(range(14)), 
           labels=list(range(6,20)), fontsize=13)
plt.yticks(fontsize=13)
plt.xlim(0,13)
sns.despine()  
plt.show()
```

![](img/8b739c322d735a21a65e443473304229.png)

ä½œè€…å›¾ç‰‡

æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸¤ä¸ªæ—¶é—´æ®µçš„äº¤é€šæ¯”å¹³å‡æ°´å¹³æ›´æ‹¥æŒ¤:å¤§çº¦ä» 6.45 åˆ° 7.40ï¼Œä»¥åŠä» 11.40 åˆ° 17.40ã€‚

# 3.è¦åˆ›å»ºç”˜ç‰¹å›¾

æˆ–è®¸ï¼Œ`broken_barh`æ–¹æ³•çš„æœ€ä½³åº”ç”¨æ˜¯åˆ›å»ºç®€åŒ–çš„[ç”˜ç‰¹å›¾](https://en.wikipedia.org/wiki/Gantt_chart)ã€‚ç”˜ç‰¹å›¾æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ¡å½¢å›¾ï¼Œé€šå¸¸ç”¨äºæ˜¾ç¤ºä¸åŒæ´»åŠ¨ä¹‹é—´éšæ—¶é—´å˜åŒ–çš„å…³ç³»ã€‚è¿™äº›æ´»åŠ¨å¯ä»¥åŒ…æ‹¬:

*   é¡¹ç›®ç®¡ç†è¿›åº¦åŠå…¶å½“å‰çŠ¶æ€ï¼Œ
*   è¦å®Œæˆçš„ä»»åŠ¡åŠå…¶æˆªæ­¢æ—¥æœŸï¼Œ
*   æ­£åœ¨è¿›è¡Œçš„äº‹ä»¶ï¼Œ
*   å‡æœŸã€‚

åœ¨ Python ä¸­è¿˜æœ‰å…¶ä»–æ›´å¤æ‚çš„åˆ›å»ºç”˜ç‰¹å›¾çš„æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨ [Plotly](https://plotly.com/python/gantt/) æˆ– [python-gantt](https://pypi.org/project/python-gantt/) åº“ã€‚ç„¶è€Œï¼Œ`broken_barh` matplotlib å‡½æ•°ä¹Ÿè¶³ä»¥åˆ›å»ºä¸€ä¸ªåŸºæœ¬ä½†ä¿¡æ¯ä¸°å¯Œçš„å›¾å½¢ã€‚æ­¤å¤–ï¼Œå®ƒåªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥å®Œæˆã€‚

è®©æˆ‘ä»¬ä»¥ä»Šå¹´å¤å¤©çš„å‡æœŸè®¡åˆ’ä¸ºä¾‹æ¥è¯´æ˜è¿™ç§æ–¹æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬å°†ä¸ºä¸€ä¸ª 5 äººçš„éƒ¨é—¨ä½¿ç”¨è™šæ‹Ÿæ•°æ®:

```
plt.figure(figsize=(20,7))# Create broken horizontal bar plots for vacation ranges 
x_ranges = [[(0,3), (36,3), (69,12)], [(13,19), (55,5)], [(48,5), (76,12)], [(27,19)], [(0,4), (62,12), (86,2)]]
y_start = 0.75
colors = ['deepskyblue', 'indianred', 'limegreen', 'gold', 'violet']
for i in range(len(x_ranges)):
    plt.broken_barh(x_ranges[i], (y_start+i, 0.5), color=colors[i])# Create broken horizontal bar plots for weekends 
x_weekend = [(4,2), (11,2), (18,2), (25,2), (32,2), (39,2), (46,2), (53,2), (60,2), (67,2), (74,2), (81,2), (88,2)]
y_weekend = (0, 5.5)
plt.broken_barh(x_weekend, y_weekend, color='tomato', alpha=0.1)plt.title('Vacation schedule for June-August 2021', fontsize=35)
plt.xticks(ticks= [0, 4, 9, 14, 19, 24, 30, 34, 39, 44, 49, 54, 61, 65, 70, 75, 80, 85, 90],
           labels=['June', 5, 10, 15, 20, 25, 'July', 5, 10, 15, 20, 25, 'August', 5, 10, 15, 20, 25, 30], fontsize=20)
plt.yticks(ticks= [1, 2, 3, 4, 5], 
           labels=['Vladimir', 'Natalia', 'Michael', 'Peter', 'Elena'], fontsize=20)
plt.xlim(0, 92)
plt.ylim(0, 5.5)
plt.axvline(30, color='black')
plt.axvline(61, color='black')
plt.grid(axis='x')
plt.tick_params(left=False, bottom=False)
plt.show()
```

![](img/241958b7f8265d12981aafb26de4ee76.png)

ä½œè€…å›¾ç‰‡

å³ä½¿ä¸ä½¿ç”¨ä»»ä½•ä¸“é—¨çš„åº“ï¼Œä¸Šé¢çš„å›¾çœ‹èµ·æ¥ä¹Ÿå¾ˆæ¸…æ¥š:æˆ‘ä»¬çœ‹åˆ°äº†é›‡å‘˜çš„å§“åã€æ¯ä¸ªé›‡å‘˜çš„å‡æœŸæ•°å’Œå‡æœŸèŒƒå›´ã€ä¸»è¦çš„æ—¶é—´æ ‡å¿—(å¼€å§‹ã€5 æ—¥ã€10 æ—¥ç­‰ç­‰ã€‚æ¯ä¸ªæœˆã€æ‰€æœ‰çš„å‘¨æœ«)ã€é‡å å‡æœŸçš„æ—¶æ®µæˆ–è€…æ²¡æœ‰äººä¼‘å‡çš„æ—¶æ®µã€‚

# ç»“è®º

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†ä¸€ä¸ªå¾ˆå°‘ä½¿ç”¨ä½†å¾ˆæ–¹ä¾¿çš„`broken_barh` matplotlib æ–¹æ³•çš„è¯­æ³•ï¼Œå®šåˆ¶ç»“æœå›¾çš„æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯è¯¥æ–¹æ³•æœ‰ç‰¹æ®Šç”¨é€”çš„æƒ…å†µï¼Œå³åœ¨åŒä¸€å›¾ä¸Šæ˜¾ç¤ºä¸åŒç±»åˆ«çš„èŒƒå›´(è¾¹ç•Œæ¡ä»¶ã€å·¥èµ„èŒƒå›´)ï¼Œåœ¨å¦ä¸€ä¸ªå›¾ä¸Šå¼ºè°ƒä¸€äº›åŒºé—´(æ±‡ç‡å˜åŒ–ã€äº¤é€šé‡æ³¢åŠ¨)ï¼Œä»¥åŠåˆ›å»ºç”˜ç‰¹å›¾(å¯è§†åŒ–è®¡åˆ’ï¼Œå¦‚é¡¹ç›®æ­¥éª¤ã€ä»»åŠ¡æˆ–å‡æœŸ)ã€‚

æ„Ÿè°¢é˜…è¯»ï¼

**ç›¸å…³ä¸»é¢˜:**

</how-to-fill-plots-with-patterns-in-matplotlib-58ad41ea8cf8>  </bar-plots-alternatives-specific-types-9d10ef250e5>  <https://medium.com/geekculture/creating-toyplots-in-python-49de0bb27ec1> 