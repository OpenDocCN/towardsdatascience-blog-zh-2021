# æœ´ç´ è´å¶æ–¯åˆ†ç±»ç®—æ³•

> åŸæ–‡ï¼š<https://towardsdatascience.com/naive-bayes-algorithm-for-classification-bc5e98bff4d7?source=collection_archive---------9----------------------->

## å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯æ¨¡å‹åŠå…¶ Python å®ç°

![](img/83252837c40b893f88ecffed4a658172.png)

[æ¥æº](https://unsplash.com/photos/VAJEea9u6k8?utm_source=unsplash&utm_medium=referral&utm_content=creditShareLink)

åˆ†ç±»æ˜¯æœ€å¸¸ç”¨çš„é¢„æµ‹å½¢å¼ä¹‹ä¸€ï¼Œå…¶ç›®æ ‡æ˜¯é¢„æµ‹è®°å½•çš„ç±»åˆ«ã€‚å¯¹äº**äºŒå…ƒåˆ†ç±»ï¼Œ**æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é¢„æµ‹è®°å½•æ˜¯ 1 è¿˜æ˜¯ 0ï¼Œå¦‚åƒåœ¾é‚®ä»¶/éåƒåœ¾é‚®ä»¶æˆ–æµå¤±/éæµå¤±ï¼Œå¯¹äº**å¤šç±»åˆ†ç±»**ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é¢„æµ‹è®°å½•çš„ç±»åˆ«ï¼Œå¦‚å°†é‚®ä»¶åˆ†ç±»ä¸ºä¸»è¦/ç¤¾äº¤/ä¿ƒé”€ç­‰ã€‚

é™¤äº†å¤§éƒ¨åˆ†æ—¶é—´é¢„æµ‹æˆ‘ä»¬è®°å½•çš„ç±»åˆ«ï¼Œæˆ‘ä»¬è¿˜æƒ³çŸ¥é“å±äºæ„Ÿå…´è¶£ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ã€‚è¿™äº›æ¦‚ç‡å€¼ä¹Ÿè¢«ç§°ä¸º**å€¾å‘å¾—åˆ†**ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºæ„Ÿå…´è¶£çš„ç±»åˆ«è®¾ç½®æˆªæ­¢æ¦‚ç‡ï¼Œå¯¹äºå€¾å‘åˆ†æ•°ä½äºè¯¥å€¼çš„è®°å½•ï¼Œæˆ‘ä»¬è®¤ä¸ºè¯¥è®°å½•å±äºè¯¥ç±»åˆ«ï¼Œåä¹‹äº¦ç„¶ã€‚

å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œè¿™æ˜¯ä¸€ç§**ç›‘ç£å­¦ä¹ **çš„å½¢å¼ï¼Œæˆ‘ä»¬ä»è®°å½•ç±»åˆ«å·²çŸ¥çš„æ ‡è®°æ•°æ®å¼€å§‹ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¥æ•°æ®è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ï¼Œç„¶åå°†è¯¥æ¨¡å‹åº”ç”¨äºç±»åˆ«æœªçŸ¥çš„æ–°æ•°æ®ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡åœ¨ Python ä¸­å®ç°æ¥äº†è§£å¦‚ä½•ä½¿ç”¨æœ´ç´ è´å¶æ–¯ç®—æ³•æ¥è§£å†³å¤šç±»åˆ†ç±»é—®é¢˜ã€‚

> æˆ‘é¼“åŠ±ä»»ä½•äººæŸ¥çœ‹æˆ‘çš„ GitHub ä¸Šçš„ [Jupyter ç¬”è®°æœ¬](https://github.com/Idilismiguzel/Machine-Learning/blob/master/Classification/Naive_Bayes_Classifier.ipynb)ä»¥è·å¾—å®Œæ•´çš„åˆ†æå’Œä»£ç ã€‚

# è´å¶æ–¯å®šç†

è´å¶æ–¯å®šç†æä¾›äº†ä¸€ç§åœ¨å·²çŸ¥å…ˆéªŒçŸ¥è¯†çš„æƒ…å†µä¸‹è®¡ç®—å‡è®¾*çš„æ¦‚ç‡çš„æ–¹æ³•ã€‚*

![](img/4529c85bc17a99dd7f1ebc54364401c8.png)

ä½œè€…å›¾ç‰‡

**å…ˆéªŒæ¦‚ç‡**æ˜¯åœ¨æ”¶é›†æ–°æ•°æ®ä¹‹å‰äº‹ä»¶çš„æ¦‚ç‡ï¼Œå³ P(åƒåœ¾é‚®ä»¶)æ˜¯åœ¨çœ‹åˆ°ä»»ä½•æ–°é‚®ä»¶ä¹‹å‰åƒåœ¾é‚®ä»¶çš„æ¦‚ç‡ã€‚

**è¾¹é™…å¯èƒ½æ€§**ä¹Ÿç§°ä¸º**è¯æ®**æ˜¯è¯æ®äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ï¼Œå³ P(money)æ˜¯é‚®ä»¶æ–‡æœ¬ä¸­åŒ…å«â€œmoneyâ€çš„æ¦‚ç‡ã€‚

**å¯èƒ½æ€§**æ˜¯å‡è®¾äº‹ä»¶ä¸ºçœŸï¼Œè¯æ®å‘ç”Ÿçš„æ¦‚ç‡ï¼Œå³ P(money|spam)æ˜¯å‡è®¾é‚®ä»¶æ˜¯åƒåœ¾é‚®ä»¶ï¼Œé‚®ä»¶åŒ…å«â€œmoneyâ€çš„æ¦‚ç‡ã€‚

**åéªŒæ¦‚ç‡**æ˜¯åœ¨è¯æ®ä¿¡æ¯å·²ç»è¢«åˆå¹¶ä¹‹åçš„ç»“æœçš„æ¦‚ç‡ï¼Œå³ P(åƒåœ¾é‚®ä»¶|é‡‘é’±)æ˜¯ç»™å®šé‚®ä»¶åœ¨æ–‡æœ¬ä¸­åŒ…æ‹¬â€œé‡‘é’±â€çš„æƒ…å†µä¸‹é‚®ä»¶æ˜¯åƒåœ¾é‚®ä»¶çš„æ¦‚ç‡ã€‚

![](img/466a3f30b7a5b55d6be3c33331c6fe88.png)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ˜¯ç”¨ P(é‡‘é’±)å’Œ P(é‡‘é’±|åƒåœ¾é‚®ä»¶)ä»å…ˆéªŒæ¦‚ç‡ P(åƒåœ¾é‚®ä»¶)è®¡ç®—åéªŒæ¦‚ç‡ P(åƒåœ¾é‚®ä»¶|é‡‘é’±)ã€‚

**æœ€å¤§åéªŒæ¦‚ç‡(MAP)** æ˜¯åéªŒæ¦‚ç‡æœ€é«˜çš„å‡è®¾ã€‚åœ¨è®¡ç®—äº†å‡ ä¸ªå‡è®¾çš„åéªŒæ¦‚ç‡åï¼Œæˆ‘ä»¬é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„å‡è®¾ã€‚

ä¾‹å¦‚:å¦‚æœ P(spam|money) > P(not spam|money)é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯´è¯¥é‚®ä»¶å¯ä»¥å½’ç±»ä¸ºåƒåœ¾é‚®ä»¶ã€‚è¿™æ˜¯æœ€å¤§å¯èƒ½çš„å‡è®¾ã€‚

# å¦‚ä½•åœ¨åˆ†ç±»ä¸­ä½¿ç”¨è´å¶æ–¯å®šç†ï¼Ÿ

ç­”æ¡ˆæ˜¯**å¤©çœŸçš„è§£å†³æ–¹æ¡ˆ**ã€‚

ç²¾ç¡®çš„è´å¶æ–¯åˆ†ç±»åœ¨æŠ€æœ¯ä¸Šæ˜¯ä¸åˆ‡å®é™…çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ•°æ®é›†ä¸­æœ‰è®¸å¤šè¯æ®å˜é‡(é¢„æµ‹å€¼)ã€‚å½“é¢„æµ‹å€¼çš„æ•°é‡å¢åŠ æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦åˆ†ç±»çš„è®¸å¤šè®°å½•å°†ä¸ä¼šæœ‰ç²¾ç¡®çš„åŒ¹é…ã€‚

![](img/371b6e8d9c20eb0591da8fb6ccf62187.png)

> ä¸Šè¿°ç­‰å¼ä»…æ˜¾ç¤ºäº†æˆ‘ä»¬æœ‰ 3 ä¸ªè¯æ®å˜é‡çš„æƒ…å†µï¼Œå³ä½¿åªæœ‰ 3 ä¸ªï¼Œä¹Ÿä¸å®¹æ˜“æ‰¾åˆ°ç²¾ç¡®åŒ¹é…ã€‚

**å¤©çœŸçš„å‡è®¾**ä»‹ç»äº†ç»™å®šç±»å˜é‡æ˜¯ç‹¬ç«‹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¡ç®—æ¡ä»¶æ¦‚ç‡å¦‚ä¸‹:

![](img/59000fa8ea7c73dbeb28e70d1783a181.png)

å¤©çœŸçš„å‡è®¾

![](img/82d568269511df9bf1734b177d34354b.png)

æœ´ç´ è´å¶æ–¯å®šç†

é€šè¿‡å‡è®¾å˜é‡ä¹‹é—´çš„æ¡ä»¶ç‹¬ç«‹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å°†è´å¶æ–¯æ–¹ç¨‹è½¬æ¢æˆä¸€ä¸ªæ›´ç®€å•å’Œæœ´ç´ çš„æ–¹ç¨‹ã€‚å³ä½¿å‡è®¾å˜é‡ä¹‹é—´çš„ç‹¬ç«‹æ€§å¬èµ·æ¥å¾ˆè‚¤æµ…ï¼Œæœ´ç´ è´å¶æ–¯ç®—æ³•åœ¨è®¸å¤šåˆ†ç±»ä»»åŠ¡ä¸­è¡¨ç°å¾—ç›¸å½“å¥½ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ğŸ‘€

![](img/2c9f08d8bd63c3e2f05fb68f9e97f6d0.png)

[æ¥æº](https://unsplash.com/photos/vJritQGOFvc?utm_source=unsplash&utm_medium=referral&utm_content=creditShareLink)

# å¤šé¡¹å¼æ¨¡å‹çš„ 1ï¸âƒ£æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨

å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨é€‚ç”¨äºå…·æœ‰ç¦»æ•£ç‰¹å¾çš„åˆ†ç±»ï¼Œä¾‹å¦‚ç”¨äºæ–‡æœ¬åˆ†ç±»çš„å­—æ•°ã€‚å®ƒéœ€è¦æ•´æ•°ç‰¹å¾è®¡æ•°ï¼Œä¾‹å¦‚åº”ç”¨äºæ–‡æœ¬çš„è¯è¢‹æˆ– tf-idf ç‰¹å¾æå–ã€‚

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘å°†ä½¿ç”¨åä¸º[â€œTwenty news groupsâ€](http://qwone.com/~jason/20Newsgroups/)çš„æ•°æ®é›†ï¼Œå®ƒæ˜¯å¤§çº¦ 20ï¼Œ000 ä¸ªæ–°é—»ç»„æ–‡æ¡£çš„é›†åˆï¼Œå¹³å‡åˆ†å¸ƒåœ¨ 20 ä¸ªä¸åŒçš„æ–°é—»ç»„ä¸­ã€‚

```
**from** sklearn.datasets **import** fetch_20newsgroups# import dataset
data = fetch_20newsgroups()
data.target_names
```

ä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„ç¤ºä¾‹ï¼Œæˆ‘å°†é€‰æ‹©ä¸€äº›ç±»åˆ«æ¥è¿‡æ»¤æ•°æ®é›†ã€‚

```
# Selected categories
categories = [**'talk.politics.misc'**, **'talk.religion.misc'**, **'sci.med'**, **'sci.space'**, **'rec.autos']**# Create train and test dataset 
train = fetch_20newsgroups(subset=**'train'**, categories=categories)
test = fetch_20newsgroups(subset=**'test'**, categories=categories)
```

è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ•°æ®ä¾‹å­:

```
**print**(train.data[5])>>>
From: rts@nwu.edu (Ted Schreiber)
Subject: Opinions on recent Alfa Spiders
Nntp-Posting-Host: mac178.mech.nwu.edu
Organization: Mechanical Engineering
Lines: 15

Anyone have any opinions on fairly recent model Alfa Spiders (86-> ) 

Reliablilty for what their class ( I'm not talking Alfa vs. Toyota corrola which is more relaible ) 

As far as I can discern, in recent years, there are 3 levels with all basically the same mechanical aspects.

Please email any responses 

Ted Schreiber
Mechanical Enginering 
Northwestern University
Tel: 708.491.5386 FAX 708.491.3915 Email: rts@nwu.edu
```

ä¸ºäº†å°†æ–‡æœ¬æ•°æ®ç”¨äºä»»ä½•æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¯ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—å‘é‡ã€‚è¿™ä¸€æ­¥è¢«ç§°ä¸º**ç‰¹å¾å·¥ç¨‹**ï¼Œä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ tf-idf çŸ¢é‡å™¨ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå°† tf-idf å‘é‡é™„åŠ åˆ°å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨çš„ç®¡é“ã€‚

```
**from** sklearn.feature_extraction.text **import** TfidfVectorizer
**from** sklearn.naive_bayes **import** MultinomialNB
**from** sklearn.pipeline **import** make_pipeline# Create a pipelinemodel = make_pipeline(TfidfVectorizer(), MultinomialNB(alpha=1))
```

ğŸ“¢å¤šé¡¹å¼ä¸­çš„ **alpha** è¡¨ç¤ºåŠ æ³•å¹³æ»‘å‚æ•°ã€‚å¦‚æœæ˜¯ 0ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¹³æ»‘ã€‚

**âš¡ä¸ºä»€ä¹ˆè¦ç£¨å¹³ï¼Ÿ**å¹³æ»‘è§£å†³äº†æœ´ç´ è´å¶æ–¯ç®—æ³•ä¸­çš„**é›¶æ¦‚ç‡é—®é¢˜**ï¼Œå³ç»™æµ‹è¯•é›†ä¸­æ¯ä¸€ä¸ª**æ–°**æ•°æ®ç‚¹åˆ†é…æ¦‚ç‡ç­‰äºé›¶çš„é—®é¢˜ã€‚

```
# Fit the model with training set
model.fit(train.data, train.target)#Predict labels for the test set
labels = model.predict(test.data)
```

åœ¨ç”¨è®­ç»ƒé›†æ‹Ÿåˆæ¨¡å‹å¹¶é¢„æµ‹æµ‹è¯•é›†çš„æ ‡ç­¾ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶æ··æ·†çŸ©é˜µæ¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹ã€‚

```
**from** sklearn.metrics **import** confusion_matrix
**import** seaborn **as** sns
**import** matplotlib.pyplot **as** plt# Create the confusion matrix
conf_mat = confusion_matrix(test.target, labels, normalize=**"true"**)# Plot the confusion matrix
sns.heatmap(conf_mat.T, annot=**True**, fmt=**".0%"**, cmap=**"cividis"**, xticklabels=train.target_names, yticklabels=train.target_names)
plt.xlabel(**"True label"**)
plt.ylabel(**"Predicted label"**)
```

![](img/e3bc921acd3f582709ad2ca1bf722686.png)

åœ¨åˆ—ä¸Šæ ‡å‡†åŒ–çš„æ··æ·†çŸ©é˜µ(çœŸå€¼)

ä»æ··æ·†çŸ©é˜µä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨å¯¹äºä¸€äº›æ–°é—»ç±»åˆ«è¡¨ç°å¾—ç›¸å½“å¥½ï¼Œä¾‹å¦‚æ±½è½¦ã€åŒ»å­¦å’Œç©ºé—´ï¼Œå…¶ä¸­æ­£ç¡®é¢„æµ‹çœŸå®æ ‡ç­¾çš„æ—¶é—´ä¸º 98%ã€95%å’Œ 97%ã€‚ç„¶è€Œï¼Œæ­£å¦‚ä½ æ‰€æƒ³è±¡çš„ï¼Œå®ƒåœ¨æ”¿æ²»å’Œå®—æ•™ç±»åˆ«ä¸­å–å¾—äº†è¾ƒä½çš„ç»“æœ..

å¦‚æœä½ å¯¹æ–‡æœ¬åˆ†ç±»æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥é˜…è¯»æˆ‘ä¸‹é¢çš„æ–‡ç« ï¼Œæˆ‘å±•ç¤ºäº†æ–‡æœ¬æŒ–æ˜æŠ€æœ¯ï¼Œå¹¶ä½¿ç”¨é€»è¾‘å›å½’å¯¹äºšé©¬é€Šçš„ç¾é£Ÿè¯„è®ºæ•°æ®é›†è¿›è¡Œäº†åˆ†ç±»ã€‚

<https://medium.com/analytics-vidhya/applying-text-classification-using-logistic-regression-a-comparison-between-bow-and-tf-idf-1f1ed1b83640>  

# ç»“è®º

æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨é€šå¸¸é€‚ç”¨äºåˆå§‹åŸºçº¿åˆ†ç±»ã€‚å®ƒä»¬é€Ÿåº¦å¿«ï¼Œæ˜“äºå®ç°å’Œè§£é‡Šã€‚è¯è™½å¦‚æ­¤ï¼Œä½†å®ƒä»¬åœ¨å¤æ‚æ¨¡å‹ä¸­è¡¨ç°ä¸ä½³ï¼Œæ¯”å¦‚æ²¡æœ‰å¾ˆå¥½çš„åˆ†ç±»ã€‚

å°½ç®¡æœ´ç´ è´å¶æ–¯æ˜¯ä¸€ä¸ªç®€å•çš„åˆ†ç±»å™¨ï¼Œä½†å®ƒè¢«ç”¨äºè®¸å¤šåŸºäºæ–‡æœ¬æ•°æ®çš„åº”ç”¨ä¸­ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»(å¦‚æˆ‘ä»¬åœ¨ç¤ºä¾‹ä¸­æ‰€åšçš„)ã€æƒ…æ„Ÿåˆ†æ(å³ç†è§£ä¸€ä¸ªäººæ˜¯æ­£é¢è¿˜æ˜¯è´Ÿé¢æ€è€ƒ)å’Œæ¨èç³»ç»Ÿ(å³åœ¨åä½œè¿‡æ»¤ä¸­ï¼Œä¸ç®¡å®¢æˆ·æ˜¯å¦å¯¹ç‰¹å®šçš„äº§å“ç»„æ„Ÿå…´è¶£)ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ—å‡ºæœ´ç´ è´å¶æ–¯çš„å‡ ä¸ªä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚

âœ…å¿«é€Ÿè®­ç»ƒå’Œé¢„æµ‹

âœ…æ˜“äºå®ç°ï¼Œåªæœ‰å‡ ä¸ªå¯è°ƒå‚æ•°ï¼Œå¦‚Î±

âœ…å¾ˆå®¹æ˜“è§£é‡Šï¼Œå› ä¸ºä»–ä»¬æä¾›äº†ä¸€ä¸ªæ¦‚ç‡é¢„æµ‹

âŒå¤©çœŸåœ°å‡è®¾æ‰€æœ‰é¢„æµ‹è€…éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­å¹¶ä¸æˆç«‹

å½“å¹³æ»‘æŠ€æœ¯ä½¿ç”¨ä¸å½“æ—¶ï¼ŒâŒé›¶æ¦‚ç‡é—®é¢˜ä¼šå¼•å…¥é”™è¯¯çš„ç»“æœã€‚

âŒ:å®ƒä¼šäº§ç”Ÿé«˜åº¦åé¢‡çš„ä¼°è®¡ã€‚

æˆ‘å¸Œæœ›æ‚¨å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« å¹¶äº†è§£æœ´ç´ è´å¶æ–¯ç®—æ³•ã€‚

*å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥**[***åœ¨è¿™é‡Œé˜…è¯»æˆ‘çš„å…¶ä»–æ–‡ç« ***](https://medium.com/@idilismiguzel)**å’Œ* [***å…³æ³¨æˆ‘ä¸Šåª’***](http://medium.com/@idilismiguzel/follow)*å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚âœ¨***

***å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿ [**æˆä¸ºæ›´å¤šä¼šå‘˜ï¼**](https://idilismiguzel.medium.com/membership)***