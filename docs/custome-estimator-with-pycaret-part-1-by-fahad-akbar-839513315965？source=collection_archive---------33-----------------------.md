# ä½¿ç”¨ PyCaret çš„è‡ªå®šä¹‰ä¼°ç®—å™¨|ç¬¬ 1 éƒ¨åˆ†|ä½œè€…:Fahad Akbar

> åŸæ–‡ï¼š<https://towardsdatascience.com/custome-estimator-with-pycaret-part-1-by-fahad-akbar-839513315965?source=collection_archive---------33----------------------->

## é€šè¿‡ PyCaret åˆ›å»ºã€ä½¿ç”¨å’Œéƒ¨ç½²çµæ´»çš„å®šåˆ¶ä¼°ç®—å™¨

## é€šè¿‡ PyCaret åœ¨ Scipy ä¸­ä»å¤´å¼€å§‹æ„å»ºå’Œéƒ¨ç½² Sklearn å…¼å®¹ä¼°ç®—å™¨çš„å®è·µæŒ‡å—

![](img/5fb15a8911e4451f06d2299acec2e73c.png)

å›¾ç‰‡æ¥æº:[https://unsplash.com/photos/D5nh6mCW52c](https://unsplash.com/photos/D5nh6mCW52c)

æˆ‘ä»¬åŒæ„ï¼ŒPyCaret å¾ˆæ£’ã€‚åœ¨è¿™ä¹ˆçŸ­çš„æ—¶é—´å†…ï¼Œå®ƒå¯¹ä½ æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚ä½†æ˜¯æœ‰æ—¶å…‰æœ‰è¿™äº›æ˜¯ä¸å¤Ÿçš„ï¼Œæ‚¨å¸Œæœ›å¸¦æ¥æ‚¨è‡ªå·±å¼€å‘çš„æ›´é€‚åˆæ‚¨çš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…åœ¨å…¶ä»–åœ°æ–¹å¯ä»¥è·å¾—çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”æ‚¨å¸Œæœ› PyCaret æ¥é€‰æ‹©å®ƒã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¦åŠªåŠ›å®ç°çš„ï¼Œæˆ‘ä»¬å°†åˆ†ä¸¤éƒ¨åˆ†æ¥åšã€‚

åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ :
1ï¸âƒ£å¦‚ä½•ä½¿ç”¨ python çš„ç±»å¯¹è±¡åˆ¶ä½œä¸€ä¸ªç®€å•çš„ä¼°ç®—å™¨(æ¨¡å‹)
2ï¸âƒ£å¦‚ä½•ä½¿ç”¨ Scipy çš„ curve_fit ä¸ºæˆ‘ä»¬å¸¦æ¥ä¼˜åŠ¿
3ï¸âƒ£å¦‚ä½•ä½¿ curve_fit æ›´åŠ çµæ´»&æ•æ·ä»¥ä¾¿è¿›ä¸€æ­¥é›†æˆ

åœ¨ç¬¬ 2 éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ :
4ï¸âƒ£å¦‚ä½•ä½¿å®šåˆ¶çš„ä¼°ç®—å™¨ sklearn å…¼å®¹
5ï¸âƒ£å¦‚ä½•ä¸ PyCaret é›†æˆ

åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå›å½’ä¼°è®¡é‡ï¼Œå› ä¸ºæƒ³æ³•æ˜¯ä¸€æ ·çš„ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä»»ä½•ç±»å‹çš„ä¼°è®¡é‡ã€‚è®©æˆ‘ä»¬å¼€å§‹å»ºé€ å§

# ğŸ‘‰ä¸€ä¸ªç®€å•çš„ä¼°ç®—å™¨:

æˆ‘ä»¬å°†ä½¿ç”¨ Python çš„ç±»å¯¹è±¡åˆ¶ä½œä¼°ç®—å™¨ã€‚è¯¾å ‚å°±åƒè“å›¾ã€‚ä½ å¯ä»¥ä»ä¸€ä¸ªç±»åˆ›å»ºè®¸å¤šç‹¬ç«‹çš„å¯¹è±¡ï¼Œå°±åƒä½ å¯ä»¥ä»ä¸€ä¸ªè“å›¾å»ºé€ è®¸å¤šæˆ¿å­ä¸€æ ·ã€‚ä¾‹å¦‚ï¼Œä»â€œsklearn.linear_modelâ€å¯¼å…¥çš„â€œLogisticRegressionâ€æ˜¯ä¸€ä¸ªç±»ï¼Œå½“æˆ‘ä»¬é€šè¿‡è®¾ç½® *cls = LogisticRegression()* æ¥â€œå®ä¾‹åŒ–â€è¿™ä¸ªç±»æ—¶ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ª LogisticRegression çš„å¯¹è±¡ã€‚è¿˜æœ‰ä¸€ç‚¹ï¼Œç±»é‡Œé¢çš„å‡½æ•°å«åšâ€˜æ–¹æ³•â€™ã€‚æ¯”å¦‚ fit() / predict()å°±æ˜¯ LogisticRegression ç±»å†…éƒ¨çš„å‡½æ•°ï¼Œæˆ‘ä»¬åªè¦è°ƒç”¨ cls.fit()ç­‰å°±å¯ä»¥ä½¿ç”¨ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æœ‰ä¸€ä¸ªå¸¦æœ‰ fit & predict æ–¹æ³•çš„ç±»ã€‚ç¨åï¼Œæˆ‘ä»¬å°†æ·»åŠ å¦ä¸€ä¸ªæ–¹æ³•ï¼Œç§°ä¸º scoreã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œ äº†è§£æ›´å¤šå…³äº [***çš„è¯¾ç¨‹***](https://docs.python.org/3/tutorial/classes.html)

æˆ‘ä»¬è¦å»ºç«‹çš„ç¬¬ä¸€ä¸ªä¼°è®¡é‡æ˜¯ä¸€ä¸ªç®€å•çš„å‡å€¼ä¼°è®¡é‡ï¼Œç„¶åä¼šè·³åˆ°ä¸€ä¸ªæ›´å®ç”¨çš„ä¼°è®¡é‡ã€‚è¿™ä¸ªä¼°è®¡å™¨å°†ç®€å•åœ°é¢„æµ‹å¹³å‡å€¼ã€‚æˆ‘ä»¬å°†ä»è®­ç»ƒæ•°æ®ä¸­â€œä¼°è®¡â€è¿™ä¸ªâ€œå¹³å‡å€¼â€ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•åšçš„(æ³¨æ„è¯„è®ºï¼Œæˆ‘åœ¨ç¼–ç æ—¶è¯•å›¾è§£é‡Šå¾ˆå¤šğŸ’») :

ç°åœ¨æˆ‘ä»¬å·²ç»åšäº†ä¸€ä¸ªç®€å•çš„ä¼°è®¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­åšä¸€ä¸ªæ›´å…·ä½“çš„ä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­éœ€è¦ä¸€ä¸ªæ›´å¤æ‚çš„ç®—æ³•ã€‚

# ğŸ‘‰ç§‘å­¦æ›²çº¿æ‹Ÿåˆ:

åœ¨æˆ‘çš„è¡Œä¸šä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦é€šè¿‡ä»·æ ¼æ¥é¢„æµ‹äº§å“çš„æ•°é‡ã€‚å½“æˆ‘ä»¬å¯è§†åŒ–ä»·æ ¼å’Œæ•°é‡ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè§‚å¯Ÿåˆ°ä¸€ç§å¼¹æ€§è¡Œä¸ºï¼Œå³éšç€äº§å“ä»·æ ¼çš„ä¸Šå‡ï¼Œæ•°é‡ä¼šä¸‹é™ã€‚ç„¶è€Œï¼Œè¿™ç§è¡Œä¸ºåœ¨æŸäº›ä»·ä½ä¸Šè¡¨ç°å‡ºæ¥ã€‚åœ¨æç«¯ä»·æ ¼ç‚¹ï¼Œæ•°é‡å¯¹ä»·æ ¼çš„è¿›ä¸€æ­¥å˜åŒ–æ²¡æœ‰å¼¹æ€§/æ²¡æœ‰ååº”ã€‚åœ¨å›¾ä¸Šï¼Œè¿™çœ‹èµ·æ¥åƒä¸€æ¡æŒ‡æ•°æ›²çº¿ã€‚

![](img/9736019ff3ca0a9fee68c849b9252977.png)

ä½œè€…å›¾ç‰‡:æ•°é‡ä¸ä»·æ ¼

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦é€šè¿‡æ‹ŸåˆæŒ‡æ•°å½¢çŠ¶çš„æ›²çº¿æ¥æ¦‚æ‹¬è¿™ç§è¡Œä¸ºã€‚æŒ‡æ•°æ–¹ç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„:

![](img/4d3989fcc9a3603f67491536dc8868ad.png)

ä½œè€…å›¾ç‰‡

æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹ç¨‹ï¼Œé€šè¿‡ scipy çš„ã€ä¼˜åŒ–æ¨¡å—ã€‘*[***curve _ fit***](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html)å‡½æ•°ï¼Œå¸Œæœ›æ‰¾åˆ°/æ±‚è§£ç³»æ•° a & b .è¿‡ç¨‹ç›¸å½“ç®€å•ã€‚æˆ‘ä»¬å®šä¹‰è‡ªå®šä¹‰å‡½æ•°ï¼Œç„¶åå°†è¯¥å‡½æ•°ä¼ é€’ç»™ curve_fit å‡½æ•°çš„å‚æ•°(ä»¥åŠå…¶ä»–ä¸€äº›å‚æ•°)ã€‚**å‡ºäºè¿ç»­æ€§ç›®çš„ï¼Œæˆ‘å°†ç»§ç»­ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„ç©å…·æ•°æ®ã€‚ä»·æ ¼å’Œæ•°é‡è¯´æ˜åªæ˜¯ä¸ºäº†è¯æ˜ä½¿ç”¨è‡ªå®šä¹‰ç­‰å¼çš„æ„ä¹‰ã€‚**æˆ‘ä»¬å°†æŒ‘é€‰ä¸€ä¸ªç‰¹å¾ï¼Œå¹¶å°è¯•å°†å…¶ä¸æ ‡ç­¾ç›¸åŒ¹é…ã€‚ç¨åï¼Œæˆ‘ä»¬å°†å¯¹å¤šä¸ªç‰¹å¾é‡å¤ç›¸åŒçš„ç»ƒä¹ ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨åªæœ‰ä¸€ä¸ªç‰¹å¾çš„æŒ‡æ•°å‡½æ•°è¿›è¡Œæ›²çº¿æ‹Ÿåˆ(åŒæ ·ï¼Œè¯·é˜…è¯»ä»£ç ä¸­çš„æ³¨é‡Šï¼):*

# *ğŸ‘‰ä¸€ç§æ›´å®ç”¨çš„ä¼°ç®—æ–¹æ³•:*

*åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ã€€â€˜ğŸ‘Œï¼Œä½†æ˜¯ä½ æ³¨æ„åˆ°ä»€ä¹ˆäº†å—ï¼Ÿå¦‚æœä½ è®¤ä¸ºå®ƒä¸å®ç”¨ï¼Œé‚£ä½ å°±çŒœå¯¹äº†ï¼ã€‚åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œè¿˜æœ‰æ›´å¤šçš„ç‰¹æ€§å¯ç”¨ï¼Œåœ¨è¯•éªŒæ—¶ï¼Œæ‚¨å°†æ·»åŠ æˆ–å‡å°‘ä¸åŒçš„ç‰¹æ€§/åˆ—ã€‚å¦‚æœæˆ‘ä»¬åƒä¸Šé¢å†™çš„é‚£æ ·å†™ä»£ç ï¼Œé‚£ä¹ˆæ¯æ¬¡æˆ‘ä»¬è¯•éªŒä¸€ä¸ªæ–°ç‰¹æ€§æ—¶ï¼Œæ·»åŠ /åˆ é™¤ç³»æ•°å°†æ˜¯ä¸€åœºå™©æ¢¦ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè¶³å¤Ÿçµæ´»åœ°æä¾›ä»»æ„æ•°é‡çš„ç³»æ•°(ç‰¹æ€§),è€Œä¸å¿…æ”¹å˜å‡½æ•°ã€‚è®©æˆ‘ä»¬è¯•ç€è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå¯ç¼–ç¨‹å‡½æ•°ï¼Œå®ƒå¯ä»¥æ‹Ÿåˆå…·æœ‰ n ä¸ªç‰¹å¾çš„æŒ‡æ•°æ›²çº¿*

*![](img/c76bcf2645ae8556c53b241e4245e93d.png)*

*ä½œè€…å›¾ç‰‡*

*ç­”æ¡ˆæ˜¯ç”¨ä½ç½®å‚æ•°(*args)æ‰“åŒ…/è§£åŒ…ã€‚è¿™æ˜¯å¤„ç†è¿™ç§æƒ…å†µçš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œ é˜…è¯»æ›´å¤šå…³äºç«‹åœºè®ºç‚¹ [***ã€‚åœ¨æˆ‘ä»¬çš„ exp_curve å‡½æ•°ä¸­(åœ¨å‚æ•° x ä¹‹å),æˆ‘ä»¬å°†å…è®¸ç”¨æˆ·é€šè¿‡*args ä¼ é€’ä»»æ„æ•°é‡çš„ç³»æ•°(äº‹å®ä¸Šï¼Œåœ¨*ä¹‹åçš„åç§°å¹¶ä¸é‡è¦ï¼Œæ˜¯*å…·æœ‰é­”åŠ›)ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œ*args å°†äº§ç”Ÿä¸€ä¸ªç³»æ•°å…ƒç»„(åç§°ä¸º args ),æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå¾ªç¯æ¥æ„é€ æˆ‘ä»¬çš„å…¬å¼ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬çš„å¤§éƒ¨åˆ†å…¬å¼åªä¸è¿‡æ˜¯å½¼æ­¤çš„åºåˆ—å’Œç§¯ã€‚æˆ‘ä»¬å°†ä½¿ç”¨***](https://www.python.org/dev/peps/pep-0570/) ***[***æšä¸¾***](https://docs.python.org/3/library/functions.html#enumerate) å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è¿”å›ç³»æ•°åŠå…¶åœ¨å…ƒç»„ä¸­çš„ä½ç½®/ç´¢å¼•ã€‚æ£€æŸ¥ä¸‹é¢çš„ä»£ç ï¼Œäº†è§£å½“æˆ‘ä»¬ä¸€èµ·ä½¿ç”¨ä½ç½®å‚æ•°è§£åŒ…&æšä¸¾å‡½æ•°æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚****

*è¿˜æœ‰å¦ä¸€ä¸ªå¾®å¦™ä½†é‡è¦çš„ç‚¹ã€‚åœ¨æˆ‘ä»¬çš„ç­‰å¼ä¸­ï¼Œç³»æ•°çš„æ•°é‡å°†ç­‰äºç‰¹å¾çš„æ•°é‡+1ã€‚é¢å¤–çš„ä¸€ä¸ªæ˜¯æˆªè·â€œaâ€ï¼Œå®ƒå°†å§‹ç»ˆä½äºç´¢å¼•/ä½ç½® 0ã€‚ç°åœ¨è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ–°å‡½æ•°:*

*ä½œè€…å›¾ç‰‡*

*ç®€å•åœ°è¯´ï¼Œæˆ‘ä»¬ä»è®¾ç½®`y_=0 ,` å¼€å§‹ï¼Œä»`args[1:0]`ä¸­é€‰å–ç¬¬ä¸€ä¸ªç³»æ•°`a` ï¼Œå°†å…¶ä¹˜ä»¥ç¬¬ä¸€åˆ—`X[:,i]`ï¼Œç„¶åæ›´æ–°`y_`ã€‚æˆ‘ä»¬ç»§ç»­å¾ªç¯çš„ä¸‹ä¸€æ¬¡è¿­ä»£ï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ªç³»æ•°å’Œç‰¹å¾åˆ—çš„ä¹˜ç§¯ï¼Œå°†å…¶æ·»åŠ åˆ°`y_`ä¸­(è®°ä½æŒ‡æ•°æ–¹ç¨‹)ã€‚ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†æ‰€æœ‰çš„ç³»æ•°/ç‰¹å¾ï¼Œæˆ‘ä»¬åªéœ€å°†ç¬¬ä¸€ä¸ªç³»æ•°(æˆªè·)`args[0]` ä¹˜ä»¥`y_`çš„æŒ‡æ•°ï¼Œå¹¶å°†å…¶ä¿å­˜ä¸º`y`ã€‚*

> **æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨çŸ©é˜µä¹˜æ³•æ¥è¿›ä¸€æ­¥å®Œå–„è¿™ä¸ªå‡½æ•°ã€‚è¿™å¯ä»¥å¤§å¤§æé«˜é€Ÿåº¦ã€‚å¯¹äºè¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘å°†ç»§ç»­ä½¿ç”¨è¿­ä»£æ–¹æ³•ï¼Œåœ¨ä¸‹ä¸€éƒ¨åˆ†å°†åˆ‡æ¢åˆ°çŸ©é˜µä¹˜æ³•ã€‚**

*å¦‚æœä½ å·²ç»èµ°äº†è¿™ä¹ˆè¿œï¼Œæ˜ç™½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œç»™ä½ è‡ªå·±å’Œæˆ‘ä¸€ä¸ªé¼“åŠ±ğŸ˜„ã€‚å‰©ä¸‹çš„äº‹æƒ…å°±ç®€å•äº†ã€‚æˆ‘ä»¬æ‰€éœ€è¦çš„å°±æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰å‡½æ•°&æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ç±»ä¸­çš„ curve_fit å‡½æ•°ã€‚*

*è¿™ä¸€é›†åˆ°æ­¤ä¸ºæ­¢ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å­¦ä¹ äº† ***ä¼°è®¡å™¨ã€python ç±»å¯¹è±¡ã€æŒ‡æ•°å‡½æ•°ã€curve_fit å‡½æ•°ã€ä½ç½®å‚æ•°æ‰“åŒ…/è§£åŒ…ã€æšä¸¾å‡½æ•°&ï¼Œæœ€ç»ˆæ„å»ºäº†ä¸€ä¸ªæ›´åŠ å®šåˆ¶åŒ–çš„&çµæ´»å›å½’ä¼°è®¡å™¨*** ã€‚*

*åœ¨ä¸‹ä¸€é›†ï¼Œæˆ‘ä»¬å°†ä½¿è¿™ä¸ªä¼°è®¡å™¨ sklearn å…¼å®¹ï¼Œç„¶åå°†å®ƒä¸ pycaret é›†æˆã€‚æ•¬è¯·æœŸå¾…ï¼*

*â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
ä½ å¯ä»¥åœ¨ [**ä¸Šå…³æ³¨æˆ‘**](https://medium.com/@fahadakbar_50702) &ä¸Šè”ç³»æˆ‘ [**LinkedIn**](https://www.linkedin.com/in/fahadakbar/) &è®¿é—®æˆ‘çš„[**github**](https://github.com/brainalysis)â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–*

## *æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£:*

> *ğŸ‘‰[Docker](/make-your-data-science-life-easy-with-docker-c3e1fc0dee59)
> è®©æ‚¨çš„æ•°æ®ç§‘å­¦ç”Ÿæ´»å˜å¾—è½»æ¾ğŸ‘‰[ä½¿ç”¨ PyCaret çš„è‡ªå®šä¹‰ä¼°ç®—å™¨ï¼Œç¬¬ 2 éƒ¨åˆ†](https://fahadakbar-50702.medium.com/custom-estimator-with-pycaret-part-2-by-fahad-akbar-aee4dbdacbf)*