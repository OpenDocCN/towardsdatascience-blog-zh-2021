# 点击率模型的 ML 可观察性的最佳实践

> 原文：<https://towardsdatascience.com/best-practices-in-ml-observability-for-click-through-rate-models-8a0c6755a49a?source=collection_archive---------8----------------------->

![](img/e2c13b9b5ee6a48b85d0f9859c510e7f.png)

作者图片(阿里泽·艾)

## 在假期及以后保持点击量的小贴士

今年数字广告总支出预计将达到 4553 亿美元。其中，55.2%将用于展示广告，40.2%将用于搜索。随着数字格式占据了[广告收入的最大份额](https://www.washingtonpost.com/technology/2019/02/20/digital-advertising-surpass-print-tv-first-time-report-says/)，营销人员需要不断优化他们活动的效果。点击率(CTR)是广告商用来帮助量化数字广告效果的一个指标。对于直接回应广告客户来说，点击通常是消费者在线购买的第一步，或者在离线销售数据不可用或难以归因于给定广告的情况下，是购买意图的良好代理。

点击率的计算方法是将点击次数除以印象次数，并将结果表示为百分比。根据[最近的基准](https://www.smartinsights.com/internet-advertising/internet-advertising-analytics/display-advertising-clickthrough-rates/)，所有行业的 Google AdWords 的平均点击率在搜索网络上是 3.17%，在显示网络上是 0.45%。

多年来，机器学习(ML)系统在有效预测点击概率的能力方面变得更加复杂。影响点击率的因素很多，从上下文相关性(广告在哪里投放，在页面上的位置，广告形式等等。)到用户属性(一个人正在使用哪种设备和他们的位置或更深入的第一方人口统计数据、购物历史、媒体消费习惯等[数据](https://www.wsj.com/articles/big-tech-privacy-moves-spur-companies-to-amass-customer-data-11638456544))。

## 了解广告选择流程

为了更好地理解机器学习系统如何适应广告生态系统，让我们仔细看看广告选择过程。

[超过 90%](https://www.emarketer.com/content/forecast-2021-us-programmatic-digital-display-ad-spending-15-billion-higher) 的展示和搜索广告是通过编程方式进行交易的。当用户加载网页或应用程序(例如，纽约时报、Expedia、ESPN)或搜索引擎时，该过程开始。然后，[向广告交换发送一个请求](https://www.emarketer.com/content/us-programmatic-display-spending-will-grow-spite-of-recession)，其中包含诸如 URL、发布者名称、在页面上的位置、设备、匹配关键字等信息，以及其他帮助广告商更好地锁定特定受众的信息。广告交换然后通过需求侧平台(DSP)将请求提交给多个广告客户。具有匹配标准的广告的广告客户通过发出投标进入拍卖。然后进行拍卖，广告印象归出价最高者所有，广告随后出现在页面上。所有这些都发生在页面加载前的几毫秒内，用户不会察觉。如果用户对广告感兴趣，他们可以点击或采取其他行动；如果没有，他们可能只是滚动过去，或者根本没有注意到它。

ML 驱动的系统存在于交易的双方，提高了出版商的收益和广告商的 T4 业绩。尽管点击率是这篇文章的重点，也是最常用和最容易衡量的关键性能指标之一，但应该注意的是，存在各种各样的模型来优化一切，从电视规划到特定受众，再到视频广告可视性和最大限度地减少僵尸网络流量。

![](img/dec81f88546d1da21fca6feda86b48e6.png)

图片来源:Arize AI，IAB |广告技术生态系统

## CTR 模型特有的挑战

随着 CTR 模型投入生产，一些常见的挑战可能会导致性能低于预期。其中包括:

*   **未知的新趋势:** CTR 模型通常根据特定网站(即前 1000 家最受欢迎的新闻发布商)的历史数据以及其他输入进行训练。如果广告交换开始发送对不属于原始训练数据的新的流行网站的投标请求，则广告可能最终被放置在与广告的上下文不一致的页面上，从而导致较低的点击率。这方面的一个例子可能是当 Vice 或 Buzzfeed 等网站开始受欢迎，而人们对广告在这些网站上的表现知之甚少。
*   **一天中的时间或季节波动:**一些搜索关键词或显示广告在一年中的某些时段可能或多或少相关，或者在上午与下午相比不太可能被点击。例如，用户可能更有可能在午餐或晚餐时间点击寿司店的搜索广告，而不是在早上上班的路上。有鉴于此，跟踪模型在特定时间段内的表现或退化是至关重要的。
*   **关键输入数据错误、损坏或缺失:** CTR 模型经常受到数据质量问题的影响，包括缺失数据。如果模型的输入包含设备信息，则此功能的缺失或损坏可能会影响性能。更具体地说，带有“下载应用程序”行动号召的广告可能与移动设备上的某人更相关，并且如果在上下文相关性较低的计算机上发送给某人，则导致较低的点击率。类似地，当用户外出时，位置信息[与移动广告商特别相关](https://www.marketingdive.com/ex/mobilemarketer/cms/news/research/14731.html)，可能已经在购物了。移动广告中定位的一个例子是从用户到最近商店的距离。在这些情况下，不可靠的位置数据可能会对 CTR 性能产生负面影响。

**ML 监控的最佳实践&CTR 模型的可观察性**

一旦你为你的 CTR 模型建立了一个基线和监视器，手头的任务就变成了确定问题的根本原因，并在广告业绩显著下降之前做出反应。由于消费者行为和媒体消费总是在不断变化，因此快速发现问题或行为趋势的变化并采取行动非常重要。

**重要指标**

评估您的 CTR 模型时，需要注意的一些重要指标包括:

*   [**日志损失**](https://arize.com/blog-course/log-loss/) : [准确度](https://arize.com/glossary/accuracy/)是计算模型做出正确预测的次数的度量。然而，使用展示广告的平均点击率 0.45%，我们的模型可以通过预测“无点击”达到 99%的准确率，但仍然会错过每次点击机会。另一方面，对数损失是用于测量概率模型预测的最佳分类指标之一。 [Log loss](https://arize.com/glossary/logarithmic-loss/) 回答了模型认为实际观察到的结果有多大可能性的问题。预测值与实际值偏差越大，测井曲线损失越大。在这种情况下，预测得分可能是:“有人点击的可能性有多大？”(例如 0.15，0.2 0.05)，实际得分为“有人实际点击了吗？”(例如 0，1，0)。
*   [**PR AUC**](https://arize.com/blog/what-is-pr-auc/)**:**PR 曲线说明了在各种阈值设置下精度和召回率(PR)之间的权衡， [AUC](https://arize.com/blog/what-is-auc/) 是曲线下面积(AUC)。精度衡量真正肯定的肯定分类(真肯定和假肯定)的百分比；召回衡量真正的肯定(例如，预测的和实际的点击)相对于所有分类的肯定的百分比，包括那些被错误分类的(例如，假阴性)。通常，当您有一个小的阳性类或不平衡的数据集时，您最关心的是确保每个阳性预测是正确的(精度)，并且您获得尽可能多的阳性预测(召回)，这种情况下使用 PR-AUC 度量，非常适用于 CTR 模型。
*   **预测值与实际值的时间序列**:在对您的 CTR 模型进行故障排除时，绘制预测值与实际值的时间序列图可以向您显示您的模型何时遇到问题——这是发现您的模型何时最错误的良好第一步。如果模型有问题，您将看到特定时间段的波动，您可以单击深入了解，调查哪些部分是预测过高或过低的根本原因。

有了这些指标，团队可以更深入地研究性能退化，分析他们的模型是否显示了任何漂移，和/或表面不一致或其他数据质量问题。

![](img/2a7a027105d00ab54eb9c656eab10edd.png)

*图片作者/艾瑞泽 AI:* [*模型监控*](https://arize.com/model-monitoring/) *预测与实际*

## **性能下降**

一旦发现问题，确定导致性能下降的部分(或一组特征值)是至关重要的。通过过滤各种低性能切片来深入分析您的模型，有助于揭示影响性能的用户行为的特定波动。

再看一个寿司店广告的例子，模特表现突然下降背后的切片可能反映了一个事实，即模特在一天的不同时间没有得到足够的训练——例如在很少有人想吃寿司的清晨时段。然后，ML 团队可以适应性地重新训练模型，以提高一天中不同时间的性能，而不是选择在早餐时间对广告机会或搜索术语进行竞价。

## **漂移的重要性**

作为一名 ML 从业者，随着时间的推移，你可能会遇到漂移或分布变化。监测和排除漂移是每个从业者工具箱的重要组成部分。

尤其是在购物行为和媒体习惯不断变化的广告中，考虑漂移以确保你的模型保持相关性是很重要的。识别各种模型环境和版本之间的[特性、模型和实际偏差](https://arize.com/model-drift/)有助于识别模式、数据质量问题，以及跨您的发行版改变用户行为。

让我们回到你看到一个新的流行网站流量突然激增的例子。通过注意在训练中的特征输入(在这种情况下，新流行的站点)与你的特征在生产中看到的值之间的显著变化，你可以主动地重新训练你的模型以说明这个新的趋势站点。

你可能遇到的另一个例子(这一次是关于概念漂移)是，与模型的预测相比，实际点击量突然激增。深入研究可能会发现生产中存在的[欺诈性僵尸网络流量](https://www.adweek.com/performance-marketing/fraud-alert-millions-video-views-faked-sophisticated-new-bot-scam-156883/)，这在训练数据中是不存在的或已知的问题，因此需要一个经过修改和重新训练的模型来区分和预测人类和非人类的点击。

## **数据质量保证**

我们都听说过这样一句话，“垃圾进，垃圾出。”没有干净的数据，ML 模型无法做出准确的预测。了解不同要素之间的数据质量对于解决任何问题以及确保模型正常工作是非常必要的。

以我们之前的坏数据为例:挖掘不同的特性，我们注意到我们得到的设备和位置的数据是空的，这影响了模型正确预测 CTR 的能力。由于这两个特征在我们的预测中非常重要，注意到这一点对于能够确定问题的根本原因非常重要。

## 结论

随着数字广告支出持续增长，并成为品牌广告预算的更大一部分，数据科学和 ML 团队制定[可观察性战略](https://arize.com/ml-observability/)以捕捉、监控和排除生产中 CTR 模型的问题至关重要。通过采用一种既能被动监控关键指标，又能主动测量偏差、数据质量和性能的方法，ML 团队可以在潜在问题影响营销活动绩效之前提前采取措施。作为补充参考，[下面是一个 ML 可观察性平台](https://docs.arize.com/arize/resources/use-cases/click-through-rate)如何帮助客户解决点击率[模型监控](https://arize.com/model-monitoring/)和可观察性的问题。

## **联系我们**

如果这篇博客引起了你的注意，并且你渴望了解更多关于[机器学习可观察性](https://arize.com/ml-observability/)和[模型监控](https://arize.com/model-monitoring/)，请查看我们的其他[博客](https://arize.com/blog/)和关于 [ML 监控](https://arize.com/ml-monitoring/)的资源！如果您有兴趣加入一个有趣的 rockstar 工程团队，帮助模型成功生产，请随时[联系](https://arize.com/contact/)我们，并在此找到我们的空缺职位[!](https://arize.com/careers/)