# 理解动态时间扭曲的直观方法

> 原文：<https://towardsdatascience.com/intuitive-ways-of-understanding-dynamic-time-warping-5fb60fcbe037?source=collection_archive---------16----------------------->

## 通过编辑距离和等效性

![](img/397f2feb2d999a5abe49d659a24c62dd.png)

Joshua Sukoff 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

动态时间扭曲(DTW)，尽管它的名字很科幻，但它只不过是一种(特别有用的)测量两个时间序列`x=(x1,...,xn)`和`y=(y1,...,ym)`之间距离的技术。

*   “动态的”,因为算法涉及动态规划
*   时间，因为它是时间序列
*   因为它可以被解释为计算`x`和`y`的扭曲版本之间的“通常”距离

如何计算它的机制和各种可视化已经存在(例如，罗曼·塔维纳德在他们的博客上，章晓虎在 Medium 上，泰雷兹·塞恩·科尔廷在 YouTube 上)，但是这些解释缺少的是一种更深层次的直觉和一种你可以自己想出距离的感觉。

我在这里的目的是通过编辑距离和等价性给出一些解释，这将让你对 DTW 的现状有一个更直观的了解。你甚至可以用这些想法来构建你自己的距离概念！

为了帮助解释，我将使用示例`x=(0,1,1,-2,0)`和`y=(0,0,1,-1)`来说明为什么这两个序列之间的 DTW 距离是 1。

## DTW 通过编辑距离

编辑距离通常用于自然语言处理和 DNA 分析。维基百科关于[编辑距离](https://en.wikipedia.org/wiki/Edit_distance)的文章给出了很好的描述:

> **编辑距离**是一种通过计算将一个字符串转换成另一个字符串所需的最少操作次数来量化两个字符串之间不同程度的方法

标准的操作是:删除一个字符，插入一个字符，用一个字符替换另一个字符，每一个对距离的贡献是相等的。

DTW 可以被认为是编辑距离的一种形式，其中的操作如下:

*   可以在相邻空间中插入或删除条目的副本。这是零成本的。例如，通过复制`-2`条目从`(0,1,1,-2,0)`到`(0,1,1,-2,-2,0)`将是零成本操作。或者从`(0,1,1,-2,0)`到`(0,1,-2,0)`，移除一个`1`将是零成本操作。
*   可以编辑条目。如果把`a`编辑成`b`，代价就是`a`和`b`之间的距离。例如，通过将`1`编辑为`5`从`(0,1,1,-2,0)`转到`(0,1,5,-2,0)`将是成本为 4 的操作。
*   可以在序列末尾插入或删除零。这是零成本的。例如，通过移除末端的`0`从`(0,1,1,-2,0)`到`(0,1,1,-2)`将是零成本操作。

从`x`到`y`的 DTW 距离将是使用这三种操作编辑`x`到`y`的最低成本方式。注意第三个操作的原因是为了灵活地处理不同长度的系列。

作为一个小练习/挑战，尝试使用编辑距离显示`x=(0,1,1,-2,0)`和`y=(0,0,1,-1)`之间的距离等于`1`。

…

…

…

不，真的，我建议试一试。通过主动参与，然后被动阅读别人的答案，你会学到更多！

…

…

…

下面是我如何从`x`到`y`。(注意，可能会有多个编辑序列达到最小距离):

*   从`x=(0,1,1,-2,0)`开始
*   然后是`(0,0,1,1,-2,0)`，通过复制`0`。成本为 0
*   然后通过移除重复的`1`来移除`(0,0,1,-2,0)`。成本为 0
*   然后是`(0,0,1,-1,0)`，将`-2`编辑为`-1`。成本为 1
*   然后通过移除末端的`0`移动`(0,0,1,-1)`，即 y 轴。成本为 0

所以总成本是 1，因此 DTW 距离是 1。

请注意，这让我们对变形的构成有了一些了解。如果你要在图表上绘制这些时间序列:

*   添加或删除重复项对应于水平地局部挤压或拉伸事物
*   编辑一个条目相当于局部挤压或垂直拉伸东西

## 经由等价的 DTW

另一种方法是问:我希望距离捕捉到`x`和`y`之间的哪些差异，以及我希望距离忽略哪些差异？

有几种更正式的表达方式:

*   我怎样才能改变`x`和`y`而不影响它们之间的距离
*   距离函数的不变性是什么
*   我认为哪个时间序列与`x`的距离为 0
*   我认为哪些序列等同于`x`。这是我将使用的视角。

一旦你建立了等价的概念，我们就可以定义`x`和`y`之间的距离如下:

*   设`X`是等价于`x`的所有级数的集合
*   设`Y`是等价于`y`的所有数列的集合
*   设`d`是一些“通常的”距离概念，例如欧几里德距离`d(x,y) = sqrt(sum (xi-yi)^2)`或与 L1 范数的距离`d(x,y) = sum |xi-yi|`。
*   然后将`x`和`y`之间的距离定义为`d(x', y')`的最小值，其中`x'`距离`X`而`y'`距离`Y`。

这是你如何使用等价来创造距离概念的一般框架。(注意，这与如何测量点集之间的距离有关，例如，在聚类中，如果您知道如何测量单个点之间的距离)。

要使用此等效框架获得 DTW 距离:

*   我们说两个序列是等价的，如果你可以通过添加/删除重复的条目或者在末尾添加/删除 0 来从一个序列到另一个序列
*   `d`是距离 L1 范数的距离，所以`d(x,y) = sum |xi — yi|`

再一次，作为一个小练习，试着用这个视角来展示`x=(0,1,1,-2,0)`和`y=(0,0,1,-1)`之间的 DTW 距离是 1。

…

…

…

再说一次，我真的强烈建议你试试！如果你不确定该怎么做，那就意味着我的解释不太好；如果是这样的话，请告诉我，我可以为将来做些改进！

…

…

…

这就是我如何得到 1:

*   `(0,1,1,-2,0)`相当于`x'=(0,0,1,1,-2,0)`
*   `(0,0,1,-1)`相当于`y'=(0,0,1,1,-1,0)`
*   `x'`和`y'`之间的距离为`0+0+0+0+1+0 = 1`

## 结束语

我提供了两种不同的 DTW 算法的解释:

*   给定一组可能的操作，确定最小编辑距离
*   确定时间序列等价版本之间的最小 L1 范数距离

最后，我应该承认，我对小练习的回答忽略了一个重要的细节:我展示了如何可能得到 1，但我没有给出任何明确的论据证明这是最小的可能距离！对于具体的例子，这并不太难，但一般来说，这将是确定距离最困难的部分。

然而，这正是“动态”部分的用武之地！DTW 算法的好处在于，它为你提供了一个紧凑而简单的算法来计算最小值。