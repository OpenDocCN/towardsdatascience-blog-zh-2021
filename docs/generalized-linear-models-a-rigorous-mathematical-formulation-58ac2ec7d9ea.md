# GLMs 第一部分:严格的数学公式

> 原文：<https://towardsdatascience.com/generalized-linear-models-a-rigorous-mathematical-formulation-58ac2ec7d9ea?source=collection_archive---------12----------------------->

## 用标准和非标准形式的导数统一 GLMs 理论的直觉

![](img/f6521557020a967269e966d1173b6c08.png)

在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的 [ThisisEngineering RAEng](https://unsplash.com/@thisisengineering?utm_source=medium&utm_medium=referral)

# 1:背景和动机

广义线性模型(GLMs)在包括统计学、数据科学、机器学习和其他计算科学在内的领域中起着关键作用。这类模型是对某些响应变量类型的普通线性回归的推广，具有非正态分布的误差分布模型。

让我们回忆一下普通的线性回归:

![](img/4dd352a4734e75ff3509b03f4777943f.png)

作者图片

*(对于线性回归的彻底推导，具体来说就是普通最小二乘法和 BLUE(最佳线性无偏估计量)，* [*请参见我之前关于这个主题的文章*](/ols-linear-regression-gauss-markov-blue-and-understanding-the-math-453d7cc630a5) *。)*

但是如果我们的随机变量 ***Y*** 不是正态分布呢？另外，如果给定******Y***X***的条件分布不支持整个实值线呢？或许 ***Y*** 是泊松分布而***E【Y | X】***只在正实线上有支撑？又或许 ***Y*** 是伯努利分布而***E【Y | X】***只有支集[0，1】？我们仍然有兴趣构建一个“线性模型”作为 ***X*** 和β的函数，但是用条件分布 ***Y*** 的均值给定*，即***E【Y | X】***，无偏估计并有界在适当的支持范围内。*

*在统计建模技术的发展历史中，开发了不同的方法来处理具有不同条件分布的线性模型 ***Y*** 给定 ***X*** 。其中包括:*

*   *伯努利或二项分布的逻辑回归 ***Y****
*   *泊松回归为泊松分布 ***Y****
*   *指数回归为指数分布 ***Y****

*1972 年，统计学家约翰·内尔德和罗伯特·威德伯恩证明了上述线性建模技术可以统一到一个模型家族中。提到的分布，以及其他几个分布，都可以被参数化为属于**指数分布族**。结合线性预测器和有效的链接函数(我们将在本文中介绍)，我们将这一系列模型称为**广义线性模型**。通过将这些建模技术统一到单个系列中，我们可以将这些看似不同的模型视为解决相同“味道”的问题。从计算的角度来看，这些技术在 GLM 理论下的统一有着重要的意义，尤其是在 20 世纪 70 年代，当时科学计算还处于起步阶段。*

*这篇文章以规范和非规范的形式提供了普通 GLMs 的一个彻底的数学概述(有证明)。在下一篇文章中，我们将全面回顾为使 GLMs“适合”数据而开发的迭代数值程序*(牛顿-拉夫森法、费希尔评分法、迭代加权最小二乘法和梯度下降法)*，并进一步展示为什么将这些不同的建模技术统一到一个共同的问题类别中是如此方便。*

*这篇文章的目录如下:*

*![](img/7e8adde860e1898e7618282f5a3be423.png)*

*作者图片*

# *2: GLM 概述*

## *2.1:GLMs 的三个模型组件*

*所有 GLMs 都有三个主要组成部分:*

*![](img/88c9757fd928abf9636c267323583eab.png)*

*作者图片*

## *2.2:规范和非规范形式*

*现在，让我们以规范和非规范的形式，检查指数离差分布族的概率密度函数(PDF)的参数化:*

*![](img/4c3cca4515a860a4e03bd19731d431be.png)*

*作者图片*

## *2.3:审查费希尔信息*

*让我们回忆一下 Fisher 信息的推导，这对理解规范 GLMs 的期望值和方差 ***Y*** 很重要*

*![](img/4cbd2f508466e6121330bf89068759a9.png)*

*作者图片*

*![](img/e52409393762a7645abf1ab3c5dfb2d6.png)*

*作者图片*

*![](img/9414493fe0ebd6a7af609d0e89250891.png)*

*作者图片*

## *2.4:规范 GLMs 的期望值和方差*

*使用我们在第 *2.3 节*中对得分函数的期望值和 Fisher 信息的推导，我们可以推导出规范 GLMs 的期望值和方差:*

*![](img/e6bff776ed09dc926a15c8caaf13af52.png)*

*作者图片*

*![](img/88a86340631ca13850367c4347ff869f.png)*

*作者图片*

# *3:范例规范 GLMs*

*使用第 *2* 节中的推导，我们可以开始证明某些常见的回归建模技术都可以统一为规范的 GLMs。*

## *3.1:线性回归*

*对于线性回归，我们假设结果*是正态分布的。**

**![](img/1a59eec26b68751984bbb4660b55607c.png)**

**作者图片**

**我们来推导这样一个随机变量 ***Y*** 的期望值和方差:**

**![](img/0c64b5cef4bf85fed530e9487290a04b.png)**

**作者图片**

**![](img/dd015c78f01d5b3cfe029cea8748b11b.png)**

**作者图片**

**让我们定义链接函数，并展示如何将问题参数化为非规范 GLM:**

**![](img/395767a74c0a3b5f76caba3b8f6c874b.png)**

**作者图片**

**…并展示如何将其进一步简化为标准形式:**

**![](img/5e4b4a8d3a1a64be662f75978ed90498.png)**

**作者图片**

## **3.2:逻辑回归**

**对于逻辑回归，我们假设结果 ***Y*** 是二项分布。注意，伯努利分布是二项式的一个特例。**

**![](img/0ad9fec40f050072e4f17bef82e68952.png)**

**作者图片**

**我们来推导这样一个随机变量**的期望值和方差 *Y*** :**

**![](img/a5784de533373f2ed7c8b96c711c4a34.png)**

**作者图片**

**让我们定义链接函数，并展示如何将问题参数化为非规范 GLM:**

**![](img/fb183955f8fec319df357decf1d431e3.png)**

**作者图片**

**…并展示如何将其进一步简化为标准形式:**

**![](img/5aa6b001b5c85c2aa790acc9f2516297.png)**

**作者图片**

**![](img/5aff59bc1a4838d235c3962e044fc2ba.png)**

**作者图片**

## **3.3:泊松回归**

**对于泊松回归，我们假设结果 ***Y*** 是泊松分布的。**

**![](img/2f96a9cfd89485844e702ae6e2b9b829.png)**

**作者图片**

**我们来推导这样一个随机变量 ***Y*** 的期望值和方差:**

**![](img/1513404d6aa7c15c28def54ccb35a438.png)**

**作者图片**

**让我们定义链接函数，并展示如何将问题参数化为非规范 GLM:**

**![](img/08543d932f9ffa5554b7ac2108e7a6cf.png)**

**作者图片**

**…并展示如何将其进一步简化为标准形式:**

**![](img/204906118f3122d17cdfe61997c06d8d.png)**

**作者图片**

## **3.4:负二项式回归**

**对于负二项回归，我们假设结果 ***Y*** 是负二项分布。我们假设参数 *k* 已知。**

**![](img/969db3457062736347cacad2994cf7d5.png)**

**作者图片**

**我们来推导这样一个随机变量 ***Y*** 的期望值和方差:**

**![](img/4dad3e5968ca31d8e070fab0962cd720.png)**

**作者图片**

**![](img/58e168dd8f91536faec69eed3ee694ba.png)**

**作者图片**

**让我们定义链接函数，并展示如何将问题参数化为非规范 GLM:**

**![](img/dcc5714a31c476192925d724b3f55678.png)**

**作者图片**

**…并展示如何将其进一步简化为标准形式:**

**![](img/a9e3c49192d56cd1b683e7f448a45146.png)**

**作者图片**

**![](img/a40b88f9b707dfa99c54ec5e07d76cb1.png)**

**作者图片**

## **3.5:伽玛回归**

**对于伽玛回归，我们假设结果 ***Y*** 是伽玛分布的。我们还假设参数*α*是已知的。还要注意，指数分布、卡方分布和厄兰分布都是伽玛分布的特例。**

**![](img/e945580351d82c073046039f072f5800.png)**

**作者图片**

**我们来推导这样一个随机变量 ***Y*** 的期望值和方差:**

**![](img/023b124149e5b9a18c049fab78878ad0.png)**

**作者图片**

**让我们定义链接函数，并展示如何将问题参数化为非规范 GLM:**

**![](img/eae71506836da4942c080e14553c14ab.png)**

**作者图片**

**…并展示如何将其进一步简化为标准形式:**

**![](img/67e23982395a1f963118857702e45705.png)**

**作者图片**

**![](img/225b4d18d3e48c033ea97e6955bd59f7.png)**

**作者图片**

# **4:示例非规范 GLMs**

**我们将研究 Probit 回归，这是一种广泛使用的回归模型，是一种 GLM，但不能以规范形式参数化。**

## **4.1:概率单位回归**

**类似于逻辑回归，对于概率单位回归，我们假设结果 ***Y*** 为二项分布:**

**![](img/daa58a2f0eeb022e70f39a58221424f1.png)**

**作者图片**

**然而，概率单位回归利用了与逻辑回归不同的链接函数。概率单位回归没有使用对数优势关联函数，而是将标准正态累积分布函数(CDF)指定为关联函数。**

**![](img/d5137c41ef918f36ed7fb3bf6d6d9f32.png)**

**作者图片**

**概率单位回归不能以标准形式参数化的事实对于选择用于恢复模型参数的经验估计的迭代数值拟合过程(即牛顿-拉夫森对费希尔评分)具有重要意义。在以后的文章中，我们将全面介绍 GLMs 的迭代数值拟合过程。**

# **5:总结和结论**

**在这篇文章中，我们提供了常见的规范和非规范 GLMs 的严格数学概述。有关简要总结，请参见下表:**

**![](img/f3f18c7a3e074acd44df16a00971d802.png)**

**作者图片**

**在未来的文章中，我们将涵盖 GLMs 的迭代数值拟合过程，以及通过多级递归 GLM 模型的镜头对神经网络进行严格的数学推导。**

**希望以上有见地。正如我在以前的一些文章中提到的，我认为没有足够的人花时间去做这些类型的练习。对我来说，这种基于理论的洞察力让我在实践中更容易使用方法。我个人的目标是鼓励该领域的其他人采取类似的方法。我打算在未来写一些基础作品，所以请随时在 [**LinkedIn**](http://www.linkedin.com/in/andrew-rothman-49739630) 上与我联系，并在 Medium 上 [**关注我的更新！**](https://anr248.medium.com/)**