# ä½ åœ¨ç½‘ä¸Šçš„é…·å¶åœ°å›¾

> åŸæ–‡ï¼š<https://towardsdatascience.com/your-cool-folium-maps-on-the-web-313f9d1a6bcd?source=collection_archive---------13----------------------->

## åˆ©ç”¨ flask å’Œ heroku ä¸ä¸–ç•Œåˆ†äº«æ‚¨çš„äº¤äº’å¼åœ°å›¾

![](img/7bcf388e66c88eff73b25a02ad75db86.png)

ç¾å›½å®‡èˆªå±€åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„ç…§ç‰‡

è¿™æ˜¯[ç³»åˆ—](/making-simple-maps-with-folium-and-geopy-4b9e8ab98c00)çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæ—¨åœ¨åˆ†äº«å°†æ‚¨çš„äº¤äº’å¼åœ°å›¾æ‰˜ç®¡åœ¨ web ä¸Šæˆ–éƒ¨ç½²ä¸º web åº”ç”¨ç¨‹åºçš„æ­¥éª¤ã€‚å¦‚æœä½ åªæ˜¯ä¸ºäº†ä»£ç è€Œæ¥ï¼Œé‚£ä¹ˆ[å¼€å§‹](https://github.com/Alyeko/Making-Cool-Maps-In-Python)ã€‚æœ¬æ–‡åˆ†ä¸ºå…­ä¸ªéƒ¨åˆ†:

âˆ˜ [ç®€ä»‹](#716c)âˆ˜[éœ€è¦çš„æ–‡ä»¶å’Œæ–‡ä»¶ç»“æ„](#83e1)t13ã€‘âˆ˜[éƒ¨ç½²ä½¿ç”¨ github](#1399)t16ã€‘âˆ˜[éƒ¨ç½²ä½¿ç”¨ heroku CLI](#be6b)t19ã€‘âˆ˜[æœ€ç»ˆæƒ³æ³•](#5f7b)t22ã€‘âˆ˜[å¼•ç”¨](#18e5)

## ä»‹ç»

ä½ ä¸èƒ½æŠŠä½ çš„äº¤äº’å¼åœ°å›¾æ”¾åœ¨ä½ çš„ç”µè„‘ä¸Šã€‚ä¸ºäº†è®©å…¶ä»–äººä½¿ç”¨å®ƒå¹¶ä»ä¸­å—ç›Šï¼Œå®ƒå¿…é¡»åœ¨ç½‘ç»œä¸Šã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è®©è¿™æˆä¸ºå¯èƒ½ã€‚

## æ‰€éœ€æ–‡ä»¶å’Œæ–‡ä»¶ç»“æ„

Heroku éœ€è¦ç‰¹å®šçš„æ–‡ä»¶æ¥ä½¿éƒ¨ç½²è¿‡ç¨‹é¡ºåˆ©è¿›è¡Œã€‚å®ƒä»¬æ˜¯:

Procfile:å®ƒå‘Šè¯‰ heroku å¦‚ä½•è¿è¡Œæˆ‘ä»¬çš„ flask åº”ç”¨ç¨‹åºã€‚Procfile æ²¡æœ‰æ–‡ä»¶æ‰©å±•åã€‚

Procfile

[Gunicorn](https://gunicorn.org/) æ˜¯ä¸€ä¸ª Python WSGI HTTP æœåŠ¡å™¨ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬çš„äº‘åº”ç”¨å¹³å° heroku é€šè¿‡ WSGI åè®®ä¸ Flask è¿›è¡Œé€šä¿¡ã€‚

> WSGI ä»£è¡¨â€œWeb æœåŠ¡å™¨ç½‘å…³æ¥å£â€ã€‚å®ƒç”¨äºå°†æ¥è‡ª web æœåŠ¡å™¨(å¦‚ Apache æˆ– NGINX)çš„è¯·æ±‚è½¬å‘åˆ°åç«¯ Python web åº”ç”¨ç¨‹åºæˆ–æ¡†æ¶ã€‚ä»é‚£é‡Œï¼Œå“åº”è¢«ä¼ é€’å› web æœåŠ¡å™¨ä»¥å›å¤è¯·æ±‚è€…ã€‚

**éœ€æ±‚æ–‡ä»¶:**è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«è¿è¡Œ python æ–‡ä»¶æ‰€éœ€çš„åº“ï¼Œå³ *Flask* å’Œ *gunicorn* ï¼Œä»¥åŠæ‰€ä½¿ç”¨çš„å…·ä½“ç‰ˆæœ¬ã€‚Heroku éœ€è¦è¿™ä¸ªæ¥åˆ›é€ ä½ ç”¨æ¥äº§ç”Ÿç²¾ç¡®ç»“æœçš„ç²¾ç¡®ç¯å¢ƒã€‚

requirements.txt

**Templates æ–‡ä»¶å¤¹:**åˆ›å»ºå¥½ä½ çš„å¶å­åœ°å›¾å¹¶ä¿å­˜ä¸º html æ–‡ä»¶åï¼Œä½ éœ€è¦æŠŠ *the_map.html* æ”¾åˆ°è¿™ä¸ª *templates* æ–‡ä»¶å¤¹ä¸­ã€‚ *flask* å°†åœ¨è¿™é‡Œæœç´¢å®ƒï¼Œå¹¶å°†å…¶å‘ˆç°ç»™ web åº”ç”¨ç¨‹åºã€‚

![](img/d4fe8e9797039b5acdcdb917125dfddb.png)

å…ˆç¹ä¸ºå¿«' the_map.html '

**Python æ–‡ä»¶:**Python æ–‡ä»¶è¢«å‘½åä¸º *app.py*

åœ¨æ–‡ä»¶ä¸­:

*   *Flask* ç±»å’Œ *render_template* å‡½æ•°è¢«å¯¼å…¥ã€‚
*   åˆ›å»ºäº† app å¯¹è±¡ï¼Œå®ƒæ˜¯ Flask ç±»çš„å®ä¾‹ï¼Œä¸ gunicorn ä¸€èµ·å°†å¸®åŠ© heroku å°†æˆ‘ä»¬çš„åœ°å›¾éƒ¨ç½²ä¸º web åº”ç”¨ã€‚
*   åˆ›å»ºäº†è·¯ç”±è£…é¥°å™¨ï¼Œå¹¶ä¸ºå…¶å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ã€‚è£…é¥°å™¨å‘Šè¯‰åº”ç”¨ç¨‹åºå“ªä¸ª URL åº”è¯¥è°ƒç”¨å‡½æ•°(*render _ th*e _*m*AP())ã€‚è¯¥å‡½æ•°ä» templates æ–‡ä»¶å¤¹ä¸­è¿”å›å‘ˆç°çš„æ¨¡æ¿ã€‚å‘ˆç°æ¨¡æ¿æ„å‘³ç€å°†å®ƒè½¬æ¢æˆ HTML é¡µé¢ã€‚
*   ç”±äºè¯¥æ–‡ä»¶å°†é€šè¿‡ç»ˆç«¯è¿è¡Œ(è¯·å‚è§ä¸‹é¢çš„æ®µè½)ï¼Œ' if _ _ name _ _ = = _ _ main _ _ 'çš„è®¡ç®—ç»“æœä¸º trueï¼Œapp .å°†è¿è¡Œã€‚

app.py

ä½ é¦–å…ˆè¦ç¡®ä¿ç½‘ç»œåº”ç”¨ç¨‹åºåœ¨ä½ çš„ç”µè„‘ä¸Šè¿è¡Œã€‚å¦‚æœæ˜¯çš„è¯ï¼Œå®ƒä¼šåœ¨èµ«ç½—åº“æ˜Ÿçƒä¸Šè¿è¡Œã€‚è¦æ£€æŸ¥è¿™ä¸€ç‚¹:

*   æ‰“å¼€ç»ˆç«¯
*   å¯¼èˆªåˆ°æ‚¨æ­£åœ¨å·¥ä½œçš„ç›®å½•
*   èŒ¹*n*

å¦‚æœåœ°å›¾å‡ºç°åœ¨ç»ˆç«¯æ˜¾ç¤ºçš„åœ°å€ï¼Œä½ å¯ä»¥å‰å¾€ herokuã€‚

**æ–‡ä»¶ç»“æ„**

```
Making-Cool-Maps-In-Python/
       |---> app.py
       |---> requirements.txt
       |---> Procfile
       |---> templates/ 
             |---> the_map.html
```

## ä½¿ç”¨ Github éƒ¨ç½²

é€šè¿‡ä»¥ä¸‹æ­¥éª¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ github éƒ¨ç½²åœ°å›¾:

*   å‰å¾€*heroku.com*å¹¶ç™»å½•æˆ–æ³¨å†Œ
*   ç‚¹å‡»*åˆ›å»ºæ–°åº”ç”¨*æŒ‰é’®ï¼Œè¾“å…¥ a åç§°ï¼Œç‚¹å‡»*åˆ›å»ºåº”ç”¨æŒ‰é’®*
*   é€‰æ‹©ä¸€ç§éƒ¨ç½²æ–¹æ³•â€”è¿æ¥åˆ° github å¹¶ç™»å½•
*   é€‰æ‹©è¦è¿æ¥çš„å­˜å‚¨åº“å¹¶è¿æ¥
*   æ‚¨å¯ä»¥é€‰æ‹©*è‡ªåŠ¨éƒ¨ç½²*é€‰é¡¹ï¼Œè¿™å¯ä»¥ç¡®ä¿æ‚¨å¯¹ä¸»åˆ†æ”¯æ‰€åšçš„æ¯ä¸ªæ›´æ”¹éƒ½ä¼šå½±å“ web åº”ç”¨ç¨‹åº
*   ç‚¹å‡»*éƒ¨ç½²åˆ†æ”¯*ï¼Œç­‰å¾… heroku å®‰è£…å¹¶æ£€æµ‹åˆ†æ”¯ä¸­çš„æ–‡ä»¶

![](img/f187dddb072791c4b3ddf31b579b3f3d.png)

Heroku å°†åœ°å›¾å‘å¸ƒåˆ°ç½‘ç»œä¸Š

## ä½¿ç”¨ Heroku CLI éƒ¨ç½²

ä»è¿™é‡Œä¸‹è½½ CLIã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:

*   `heroku login`å¹¶è¾“å…¥æ‚¨çš„è¯¦ç»†ä¿¡æ¯
*   `heroku create â€˜app-nameâ€™`å…¶ä¸­â€œåº”ç”¨ç¨‹åºåç§°â€æ˜¯æ‚¨è‡ªå·±çš„åº”ç”¨ç¨‹åºåç§°
*   `git push heroku master`
*   `heroku config:set DEPLOY=heroku`ã€‚
*   `heroku open`æˆ–è€…é€šè¿‡æ‚¨çš„ heroku ä¸ªäººèµ„æ–™æ‰“å¼€æ‚¨çš„æ–‡ä»¶

## æœ€åçš„æƒ³æ³•

æˆ‘å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ã€‚é‚£å°±å»å§ï¼Œè¯•è¯•çœ‹ï¼Œä»¥åå†è°¢æˆ‘å§ï¼[ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹å·²éƒ¨ç½²çš„æ ‘å¶åœ°å›¾](https://interactive-folium-map.herokuapp.com/)ã€‚æ„Ÿè°¢é˜…è¯»ï¼ğŸ˜ƒğŸ‘‹

> æˆ‘å¬è§äº†ï¼Œæˆ‘å¿˜è®°äº†ã€‚æˆ‘çœ‹è§äº†ï¼Œæˆ‘è®°å¾—ã€‚æˆ‘çŸ¥é“ï¼Œæˆ‘ä¹Ÿç†è§£ã€‚â€”å­”å­

## å‚è€ƒ

[ä»€ä¹ˆæ˜¯ wsgiï¼Ÿ](https://www.liquidweb.com/kb/what-is-wsgi/)

[çƒ§ç“¶æ–‡ä»¶](https://flask.palletsprojects.com/en/1.1.x/api/#application-object)

[æ ˆæº¢å‡ºå¶é—®é¢˜](https://stackoverflow.com/questions/37379374/insert-the-folium-maps-into-the-jinja-template/60031784#60031784)