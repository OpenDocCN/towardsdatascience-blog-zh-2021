# 因果关系:导论

> 原文：<https://towardsdatascience.com/causality-an-introduction-f8a3f6ac4c4a?source=collection_archive---------4----------------------->

## 一个老问题的新科学

这是因果关系系列文章的第一篇。该系列是基于朱迪亚珍珠和其他研究人员在这一领域的工作。在这篇文章中，我将介绍珀尔所说的“因果新科学”[1]，将因果关系与我们的思维方式联系起来，强调传统统计学的问题，并展示如何用数学方法表示因果关系。在以后的帖子中，我们将更仔细地研究因果关系的两个领域: [**因果推断**](/causal-inference-962ae97cefda) 和 [**因果发现**](https://shawhin.medium.com/causal-discovery-6858f9af6dcb) **。**

![](img/279b55d624ac5382569343242051e4ee.png)

我知道你在想什么..为什么这里会有一张香蕉的图片？图片作者。

# 香蕉

考虑上图。是的，香蕉。我给你一点时间。

一个自然的问题是，“香蕉和因果关系有什么关系？”嗯，这很有趣，因为香蕉和因果关系之间没有关系。然而，你的大脑，不管是有意还是无意，可能试图建立一种联系。

归结为一个基本问题*为什么？*为什么是香蕉？我为什么会点击这篇博文？为什么我还在读这个？事实是我们一直在问自己为什么。我们的大脑会自动尝试编织因果故事，以帮助我们理解这个或许毫无意义的世界。这个问题的衍生形式如下。原因是什么？这是什么原因呢？或者接下来是什么？这是要去哪里？

虽然这种因果思维方式对我们来说是自然的，但我们传统的统计工具无法轻松处理因果关系。三个要点将说明传统统计在这方面的不足。我将这些点称为统计学的三个陷阱。

# 统计的 3 个陷阱

## 陷阱 1:虚假关联

我们都听说过这样一句古老的谚语:相关性不是因果关系。该陈述总结了**虚假相关性**的概念，即**统计相关性，没有因果关系**。考虑下图(我保证这次不吃香蕉)。在每年淹死在游泳池里的人数和尼克·凯奇电影的数量之间有很强的相关性(66%)。显然，有趣的是，这两个变量没有任何因果联系，尽管它们相互关联。更可笑的例子可以在图片来源[ [2](https://tylervigen.com/spurious-correlations) ]找到。

![](img/ef92d76637e3c982c92bb805dcde8f42.png)

每年溺水人数与尼克·凯奇电影数量的相关性。来源:https://tylervigen.com/spurious-correlations

虽然这是一个愚蠢的例子，但它提醒我们在处理相关性时必须小心。有人可能会指出建立统计意义，但是，有两个障碍。首先，这在现实世界中说起来容易做起来难(什么是好的 p 值？我们需要多少数据？)，第二，即使是统计学意义也不足以得出因果关系的结论。我们可以从另一个讽刺性的，但“统计有效”的，关于鹳和婴儿的故事[【3】](https://web.stanford.edu/class/hrp259/2007/regression/storke.pdf)中看到。

## 陷阱二:辛普森悖论

虚假相关性是众所周知的统计陷阱，所以*很容易注意到它。一个不太为人所知的陷阱是**辛普森悖论**，即**当** **相同的数据给出矛盾的结论，这取决于你如何看待它们**。*

假设有一种心脏病的实验疗法。我们从一组参与者那里收集数据，并绘制治疗和结果之间的关系。然后，我们将数据绘制在下图中。

![](img/72f45be4a08cd9b64b9eed94515c2390.png)

实验治疗和心脏病风险之间关系的假想例子。图片作者。

乍一看，我们可能会认为这是一个可怕的治疗。一个人服药越多或从事规定的行为越多，他们患心脏病的风险就越大。但是现在假设我们看一下下图所示的两组研究参与者。

![](img/54d31b37c9407f22ab26eaa135956432.png)

实验治疗和心脏病风险之间关系的假想例子，现在以参与者性别为条件。图片作者。

单独考虑每一个亚群，我们得到的结果与之前相反。在每一组中，即男性和女性，治疗的增加与心脏病风险的降低相关。朱迪亚·珀尔(Judea Pearl)的一句话很好地总结了这一悖论**“我们有一种对男人有利、对女人有利、但对人不利的治疗方法”**

让我们看另一个例子，但是用数字和现实。下图是德瑞克·基特和大卫·贾斯蒂斯在 1995 年和 1996 年的击球率。如果你孤立地看这两年中的任何一年，大卫·贾斯蒂斯都有更好的表现。然而，如果你把这两年加在一起，德瑞克·基特表现得更好。迷惑对吗？

![](img/20d5e246c8163e815c143848b107eea2.png)

比较 1995 年至 1996 年德瑞克·基特和大卫正义的击球率。来源:https://en.wikipedia.org/wiki/Simpson%27s_paradox

**辛普森悖论强调了你如何看待你的数据很重要。**所以问题变成了，我们如何对数据进行分区？尽管在统计学中没有标准的方法来处理这个问题，但是因果推理提供了一种处理这个问题的形式。这一切都归结为因果效应，即在调整适当的混杂因素后，量化一个变量对另一个变量的影响。下一篇关于因果推理的文章将对此进行更深入的探讨。

## 陷阱三:对称

当考虑因果关系时，传统统计学的问题源于代数的一个基本属性，对称性[ [4](https://doi.org/10.2202/1557-4679.1203) ]。等式的左边等于右边(这就是代数的要点)。等号意味着对称。然而，因果关系从根本上说是不对称的，即原因导致结果，而不是相反。

让我们看一个简单的例子。假设我们用下面的表达式对疾病和它产生的症状之间的关系进行建模。 *Y* 代表症状的严重程度， *X* 疾病的严重程度， *m* 是两者之间的联系， *b* 代表所有其他因素。

![](img/8e827a152997034e0e0a5ff2284743b5.png)

症状与疾病的简单关系。根据朱迪亚·珀尔[ [4](https://doi.org/10.2202/1557-4679.1203) ]的作品改编。图片作者。

利用代数规则，我们可以把上面的等式反过来得到下面的表达式。

![](img/2b10b7b40fbd4c719818524d25a1fc20.png)

症状与疾病的倒置关系。根据朱迪亚·珀尔[ [4](https://doi.org/10.2202/1557-4679.1203) ]的作品改编。图片作者。

问题来了，如果我们把第一个方程解释为疾病引起症状，那么我们就得把第二个方程解释为症状引起疾病！这当然不是真的。

在处理数据时，X 和 Y 之间的相关性意味着 Y 和 X 之间的相同相关性。这甚至进一步发展到更一般的统计相关性概念，即 X 和 Y 之间的相关性意味着 Y 和 X 之间的相关性。这一事实消除了将仅基于数据的模型(例如机器学习)解释为因果模型的可能性。然而，通过适当的假设，可能有希望从数据中了解因果结构，这将在以后关于因果发现的文章中讨论。

[](/causal-discovery-6858f9af6dcb) [## 因果发现

### 使用 Python 从数据中学习因果关系

towardsdatascience.com](/causal-discovery-6858f9af6dcb) 

因此，如果对称性是代数和统计的核心属性，我们需要一种不同的形式来处理不对称关系，以表示因果关系。下一节将介绍一种方法。

# 因果关系

在我们深入到用数学方法表示因果关系之前，我们应该回答一个更深层次的问题，什么是因果关系？**因果关系**超越了相关性，或者更一般的统计相关性，来描述一个系统的因果联系。

一个变量 X 可以说引起了另一个变量 Y，如果当所有混杂因素被调整后，**对 X 的一个干预导致了 Y 的变化，但对 Y 的一个干预不一定导致 X 的变化** [1]。这与相关性相反，相关性本质上是对称的，即如果 X 与 Y 相关，Y 与 X 相关，而如果 X 导致 Y，Y 可能不会导致 X。

![](img/81be3d0c477e6826acb8570cd5fa2be1.png)

因果关系的可视化。这里，对 X 的干预改变了 Y，然而对 Y 的干预使 X 保持不变。图片作者。

因果关系通过**结构因果模型(SCMs)** [ [5](https://arxiv.org/abs/2102.11107) 进行数学表示。SCMs 的两个关键要素是一个图形和一组方程式。更具体地说，图是一个**有向无环图(DAG)** 和方程组是一个**结构方程模型(SEM)** 。

**DAGs** 通过显示谁*听谁*的，或者更重要的是谁*不听谁*的来表示因果结构。DAG 是一种特殊的图,它的所有边都是有向的(信息流是单向的),并且不存在循环(离开顶点的信息不能返回)。因果 DAG 中的顶点(圆圈)表示变量，边(箭头)表示因果关系，其中变量是由其父代直接*导致*的。

SEMs 代表变量之间的关系。这些方程有两个特点。首先，等式是不对称的，这意味着等式只在一个方向有效。这意味着 SEM 不能被反演以导出替代 SEM 方程。第二，方程可以是非参数的，这意味着函数形式是未知的。

注意，从表面上看，SEM 比 DAG 包含更多的信息。Dag 概述因果关系，而 SEM 可以显示因果关系*和*关系的细节。虽然从这个角度来看 Dag 似乎是不必要的，但是*通过 Dag 以清晰的方式看到*因果关系是有巨大价值的，而通过 SEM 这种方式并不明显。此外，DAG 表示的选择最终开启了用于评估因果效应的 [d 分离](http://bayes.cs.ucla.edu/BOOK-2K/d-sep.html)方法。

![](img/b9f204bd6e332ef8cd92f97dcaa46482.png)

示例结构因果模型(SCM)。图片作者。

## 因果推理

现在有了形式主义，我们可以朝着用数学方法分析因果关系的方向前进。一个自然的起点是**因果推论**。因果推理的目标是**根据问题的因果结构**回答问题。

因果推理的起点是一个因果模型。换句话说，你至少需要知道，哪些变量*互相监听*。例如，你可能知道 X 导致 Y，但是不知道交互的细节。

因果推断有许多方面，如估计 [**因果关系**](/causal-effects-f30f962ffff3) ，使用**微积分**，分解**混淆**。我将在因果推理系列的下一篇文章中介绍和探讨这些话题。

[](/causal-inference-962ae97cefda) [## 因果推理

### 用 Python 回答因果问题

towardsdatascience.com](/causal-inference-962ae97cefda) 

## 因果发现

在因果推理中，问题的因果结构往往是假定的。换句话说，假设有一条 DAG 代表这种情况。然而，在实践中，一个系统的因果关系往往是未知的。**因果发现**旨在从观察数据中发现因果结构。

从本质上来说，因果发现是一个逆问题。这就像根据冰块在厨房地板上留下的水坑来预测它的形状一样。虽然这听起来不可能，但基本策略是用假设缩小可能的解决方案。我将把更多的细节留到因果发现系列的最后一篇文章中。

# 结论

正如许多数据科学家(或任何与数据打交道的人)会告诉你的，从数据中回答问题既是科学也是艺术。这门“新的因果科学”提供了一个理论框架，有助于为这门艺术指明方向。尽管许多基础已经奠定，但因果关系仍然是一个年轻的领域，有几个未决问题。

就像机器学习一样，因果关系的前沿也在不断前进。当然，我不可能在一篇博文中，甚至在一系列博文中全面地描述这个快速发展的领域。然而，在这个系列中，我的目标是分享一些我认为有用的关键观点和资源。为此，在接下来的几篇文章中，我将讨论因果关系的两大观点:[](/causal-inference-962ae97cefda)**和 [**因果发现**](https://shawhin.medium.com/causal-discovery-6858f9af6dcb) 。**

# **资源**

****更多关于因果关系** : [因果关系概述](https://shawhin.medium.com/understanding-causal-effects-37a054b2ec3b) | [因果关系:简介](/causality-an-introduction-f8a3f6ac4c4a) | [因果推断](/causal-inference-962ae97cefda) | [因果发现](/causal-discovery-6858f9af6dcb)**

****连接** : [我的网站](https://shawhint.github.io/) | [预定电话](https://calendly.com/shawhintalebi) | [邮件我](https://shawhint.github.io/connect.html)**

****社交**:[YouTube](https://www.youtube.com/channel/UCa9gErQ9AE5jT2DZLjXBIdA)|[LinkedIn](https://www.linkedin.com/in/shawhintalebi/)|[Twitter](https://twitter.com/ShawhinT)**

****支持** : [给我买杯咖啡](https://www.buymeacoffee.com/shawhint?source=about_page-------------------------------------) ☕️ | [成为会员](https://shawhin.medium.com/membership?source=about_page-------------------------------------) ⭐️**

**[](https://shawhin.medium.com/membership) [## 通过我的推荐链接加入媒体——肖文·塔莱比

### ⭐️成为会员使用我的推荐链接，并获得充分的媒体上的每一篇文章。您的会员费直接…

shawhin.medium.com](https://shawhin.medium.com/membership)** 

****[《为什么:因果的新科学》朱迪亚·珀尔著](https://www.amazon.com/Book-Why-Science-Cause-Effect/dp/046509760X)****

******【2】**【https://tylervigen.com/spurious-correlations】T2****

******【3】**[https://web . Stanford . edu/class/HRP 259/2007/regression/storke . pdf](https://web.stanford.edu/class/hrp259/2007/regression/storke.pdf)****

******【4】**珀尔，J. (2010)。因果推理导论，国际生物统计学杂志，6(2)。https://doi.org/10.2202/1557-4679.1203****

******【5】**schlkopf，B. (2021)。因果表征学习。[arXiv:2102.11107](https://arxiv.org/abs/2102.11107)【cs。LG]****