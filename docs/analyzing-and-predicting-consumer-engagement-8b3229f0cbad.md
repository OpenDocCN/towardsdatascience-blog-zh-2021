# 分析和预测消费者参与度

> 原文：<https://towardsdatascience.com/analyzing-and-predicting-consumer-engagement-8b3229f0cbad?source=collection_archive---------10----------------------->

## 我们将使用来自 Kaggle 的[互联网新闻和消费者参与数据集](https://www.kaggle.com/szymonjanowski/internet-articles-data-with-users-engagement)来分析消费者数据，预测热门文章和受欢迎程度评分。

![](img/b514f476d0aa01dc390604fe32b905c8.png)

在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上[视觉](https://unsplash.com/@visuals?utm_source=medium&utm_medium=referral)拍摄的照片

# 介绍

在这个项目中，我们将使用来自 Kaggle 的[互联网新闻和消费者参与数据集](https://www.kaggle.com/szymonjanowski/internet-articles-data-with-users-engagement)来预测热门文章和受欢迎程度评分。我们将探索我们的数据，以发现模式，如相关性，分布，均值和时间序列分析。我们将使用文本回归和文本分类模型来预测参与度得分和基于标题的热门文章。

文本分类在我们日常使用的应用程序中很常见。例如，电子邮件提供商使用文本分类来过滤掉收件箱中的垃圾邮件。文本分类的另一个最常见的用途是在客户服务中，他们使用情感分析来区分差评和好评 [ADDI AI 2050](https://addiai.com/text-classification/) 。我们将在标题上训练我们的模型，以便它可以预测文章是否在顶部。文本回归是类似的，其中我们采用文本矢量化数据并预测十进制值的流行度得分。

> *我们的重点将放在文章标题以及它如何影响其他功能上。*

# 资料组

该数据集([源](https://www.kaggle.com/szymonjanowski/internet-articles-data-with-users-engagement))受[知识共享— CC0 1.0 通用](https://creativecommons.org/publicdomain/zero/1.0/)许可，有关更多信息，请查看此处的元数据信息。该数据集是关于 2019 年 9 月 3 日至 2019 年 10 月 4 日收集的新闻文章。随后，脸书参与度数据(如分享数、评论和反应)丰富了这一数据。

*   Source *id* 列值表示发布者的唯一标识符，通常表示为小写的 sourcename，空格替换为下划线符号。
*   Source_name 列值表示发布者名称。
*   作者列值表示文章作者。一些出版商不共享他们的新闻作者的信息，在这种情况下，通常 source_name 会替换这些信息。
*   标题列值表示文章的标题。
*   描述列值表示通常在发布者网站的弹出窗口或推荐框中可见的短文描述。这个字段被缩短为几个句子的内容列。
*   Url 列值指示位于发布者网站上的文章的 URL(统一资源定位符)。
*   Url *到*图像列值表示与文章相关联的主图像的 Url。
*   Published_at 列值表示发布文章的确切日期和时间。日期和时间以 UTC (+000)时间格式显示。
*   内容列值表示文章的无格式内容。该字段被截断为 260 个字符。
*   Top_article 列值表示文章在发布者网站上被列为热门文章。该字段只能有两个值，当文章包含在流行/热门文章组中时为 1，否则为 0。

# 安装所需的软件包

我们将安装用于情感分析的 vaderSentiment，显示最常用词的 wordcloud，用于机器学习模型的 lightgbm，以及用于不平衡分类的 imblearn。

# 加载所需的库

# 探索数据

在这一部分中，我们将探索我们的数据并可视化关键特征，以理解消费者参与度。

## 加载数据

经过初步审查的数据集包含 10437 条记录和 14 列。

我们将重点关注:

*   文章标题
*   来源名称
*   作者
*   热门文章
*   用户参与特征。

# 缺少值

使用`.isna().sum()`我们可以检查每一列的缺失值。为了让它看起来更有趣，我们将我们的发现转换成一个带有`NA percent`和颜色渐变背景的表格。正如我们可以观察到的，大多数*内容*和*作者*名称列都缺少值。

# 前十名作者和来源名称

使用 seaborn 条形图，我们显示了前 10 名作者和来源名称。我们可以看到有些作者的名字与 publication/sources 相似。前三大主要来源是路透社、BBC 新闻和爱尔兰时报。排名前三的作者分别是美联社、路透社和 CBS 新闻。

# 顶级文章

使用 matplotlib 饼图，我们可以看到有 12%的热门文章。

# 接合箱线图

很难分析参与度数据的分布，因为它们有极端的异常值。我们可以使用`sns.kdeplot`和`np.log1p`来分析每个参与列，但是有一个更好的方法是使用 boxplot，将 *yscale* 设置为`Symlog`。

*   接合反应计数有 1 个中值，但它有多个平均值在 0–60 之间的异常值。
*   参与评论计数为 0 中等，但有多个平均值在 0-1 之间的异常值。
*   参与份额计数为 10 中等，但有多个平均值在 0-50 之间的异常值。
*   参与评论插件计数为 0 中等，但它有多个平均值为 0 的异常值。

# 评论插件

让我们看看评论插件，因为它有最奇怪的数据，平均值和中值都是 0。正如我们所看到的，99%的数据是零，其余的是 1-15 的异常值。

# 干净的标题

让我们清理标题，因为我们将在机器学习模型中使用它。我们的文本数据中有标点符号和大写单词，这将使我们的模型表现最差。

`clean_title`函数将清除括号、超链接、标点和包含数字的单词。

添加包含干净标题的新列

# 创造情感极性

使用 Vader 情绪强度分析器，我们将从干净的标题中提取分数，并将其分为 3 类:积极、消极和中性。

# 应用复合分数

# 运用情感

正如我们所看到的，我们已经在数据集中添加了 2 列，分别是情绪得分和基于得分的情感。

# 情感类别计数图

新闻标题多有中性情绪和负面情绪看新闻。

# 词云

我们将使用单词云库来显示标题和描述中最常用的单词。

最常见的单词是 **say、new、said、will 和 Trump** 。我们使用英语停用词来删除每个句子中的常用词。

# 时间序列

我们将在 2019 年 9 月 3 日至 2019 年 10 月 3 日期间策划消费者互动。

# 分割日期时间

我们将把日期拆分成星期、月份和年份，然后将它们添加到数据帧中。

# 一个月的雇佣次数

使用 seaborn 折线图显示一个月内的消费者参与模式。十月一日，消费者参与度出现高峰。可能是因为某个重大事件。除此之外，在 9 月 3 日、7 日和 12 日还有较小的反应高峰。

# 关联热图

反应、评论和分享参与度之间存在高度正相关。喜欢帖子的消费者最有可能分享和评论。约定和顶级文章之间没有其他显著的相关性，很明显，顶级文章的选择纯粹基于质量。

# 预处理

*   替换丢失的标题
*   将标题转换成矢量
*   替换 top_article 中缺少的值
*   使用 SMOTE 进行过采样
*   创造人气 pcore

# Tfidf 矢量器

我们的机器学习模型只理解数值，因此为了在文本数据上训练我们的模型，我们将把它转换成 TF-IDF 特征的矩阵。 [SKlearn](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html?highlight=tfidfvectorizer#sklearn.feature_extraction.text.TfidfVectorizer)

# 过采样

我们的`top_article`数据是不平衡的，因为我们只有 12%的 1。为了使我们的模型性能更好，我们将使用过采样方法 SMOTE(合成少数过采样技术)。我也尝试过其他过采样和欠采样方法，但 SMOTE 表现更好。

# 受欢迎程度得分

我们将添加所有四个参与列，然后采取类似于`np.log(X+1)`的`np.log1p(X)`。许多零约定将导致无穷大，因此将所有列加 1 将避免灾难。

我们可以清楚地看到大部分分布在 0-3 之间。

我们可以清楚地看到，最受欢迎的两家出版公司是《纽约时报》和 CNN。

# 测试分类器模型

让我们建立一个模型，该模型将获取标题并预测文章是否会成为热门。

*   x:标题
*   y:热门文章

# 建立模型

我们已经用 SGD 和随机森林分类器进行了实验，但是到目前为止，光照梯度增强模型表现得更好。在超参数调整之后，我们的模型就可以在数据集上训练了。

*   分为训练和测试。
*   将我们的置顶文章分层，使它们平均分布。
*   使用 LGBMClassifier
*   学习率=0.5，
*   max_depth=20，
*   num_leaves=50
*   n _ 估计值=120，
*   max_bin=2000
*   交互效度分析
*   培训和测试
*   混淆矩阵

# 交互效度分析

在对我们的模型进行交叉验证后，我们可以观察到我们的 f1 分数相当稳定。0.9 是我们能达到的最高值。

# 训练/测试模型

在训练数据集上拟合我们的模型后，我们可以看到`f1`和`accuracy_scores`在我们的测试数据集上都是+0.9。

## 保存模型

# 混淆矩阵

我们有一些假阳性和假阴性。总的来说，我们的 LGBM 模型表现得比预期的要好。

# 文本回归模型

*   x:标题
*   y:人气 _ 分数

我们将使用矢量化标题来预测受欢迎程度得分。我已经用逻辑回归和随机森林回归进行了实验，但是在我们的例子中，光梯度增强表现得很好。

*   用 1 填充缺失值。
*   训练和测试分割
*   LGBMRegressor
*   学习率=0.01，
*   max_depth=20，
*   num_leaves=50
*   n _ 估计值=150
*   交互效度分析
*   培训和测试

# 列车测试分离

# 建立模型

# 验证分数

该模型表现良好，因为没有超参数调整和逻辑回归，得分为 8+ RMSE。

# 培训和测试

在训练数据集上拟合模型之后，似乎我们的模型在测试数据集上也表现得很好。现在，我们将使用这两个模型来构建标题评分函数。

## 保存模型

# 标题评分

`title_score`函数获取标题并输出流行度得分，对热门文章进行分类。全面参与，包括反应、分享和评论。我们可以使用这些功能为我们的博客创造最好的标题。

**功能任务:**

*   清理文本
*   将文本矢量化
*   预测热门文章和受欢迎程度
*   打印热门文章、受欢迎程度得分和总参与度。

# 测试

是时候测试我们的功能和预测模型了。我们将首先测试数据集内的随机值，然后使用今天新闻的标题来确定分数。

正如我们可以清楚地看到我们的功能和两个模型的工作。

# 最新消息

## 随机测试最新消息

## 热门新闻测试

正如我们所见，它得到了很高的受欢迎程度。

我们再次测试了新闻头条，正如我们所见，根据我们的模型，它是头条。

# 结论

我们在探索数据和玩不同的机器学习技术和模型中获得了乐趣。简而言之，我们探索了我们的数据，并提供了独特的信息，可以帮助新闻机构创造更好的内容，从消费者那里获得高牵引力。我们开发了机器学习模型，将帮助作家和博客写手写出更好的标题。我们还发现，高人气并不意味着这篇文章会成为头条。

对于未来的工作，我想探索数据中的多个聚类，并使用文章的图像创建一个模型来预测受欢迎程度得分。我已经试验了深度学习文本生成模型，但由于内存限制，我仅限于简单的表格模型。

为了学习更多关于数据分析、自然语言处理和机器学习的知识，我建议你参加一个令人惊叹的 DataCamp 课程，并自己练习。

# 密码

代码可从以下网址获得:

*   [T3](https://deepnote.com/@abid/Internet-News-and-Consumer-Engagement-bahkGYxiTn2VtN5Jc-SeTA)
*   [**Deepnote 项目**](https://deepnote.com/project/Internet-News-and-Consumer-Engagement-bahkGYxiTn2VtN5Jc-SeTA)
*   [**DataCamp 项目**](https://app.datacamp.com/workspace/w/1a268889-1b7d-47b5-9553-7579cf8996e1)
*   [**Kaggle**](https://www.kaggle.com/kingabzpro/internet-news-and-consumer-engagement)
*   [**GitHub**](https://github.com/kingabzpro/Consumer-Engagement-Popularity)
*   [**DAGsHub**](https://dagshub.com/kingabzpro/Consumer-Engagement-Popularity)

# 作者

[阿比德·阿里·阿万](https://www.polywork.com/kingabzpro) ( [@1abidaliawan](https://twitter.com/1abidaliawan) )是一名认证数据科学家专业人士，热爱构建机器学习模型和研究最新的人工智能技术。目前在 PEC-PITC 测试人工智能产品，他们的工作后来获得批准用于人体试验，如乳腺癌分类器。