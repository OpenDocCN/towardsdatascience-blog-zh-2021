# å°å¿ƒç†ŠçŒ«çš„è™šæ‹Ÿå˜é‡é™·é˜±

> åŸæ–‡ï¼š<https://towardsdatascience.com/beware-of-the-dummy-variable-trap-in-pandas-727e8e6b8bde?source=collection_archive---------3----------------------->

## ä½¿ç”¨`pandas.get_dummies()`å¯¹æ•°æ®è¿›è¡Œç¼–ç æ—¶éœ€è¦è®°ä½çš„é‡è¦æ³¨æ„äº‹é¡¹

![](img/f7d66d8beca905070e07d891c0419eb9.png)

[ç”± www.freepik.com sentavio åˆ¶ä½œçš„ Man vector](https://www.freepik.com/vectors/man)

å¤„ç†åˆ†ç±»å˜é‡æ˜¯æœºå™¨å­¦ä¹ ç®¡é“çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚è™½ç„¶æœºå™¨å­¦ä¹ ç®—æ³•å¯ä»¥è‡ªç„¶åœ°å¤„ç†æ•°å­—å˜é‡ï¼Œä½†è¿™å¯¹äºå®ƒä»¬çš„åˆ†ç±»å¯¹åº”é¡¹æ˜¯æ— æ•ˆçš„ã€‚è™½ç„¶æœ‰åƒ [LightGBM](https://lightgbm.readthedocs.io/en/latest/Advanced-Topics.html#categorical-feature-support) å’Œ [Catboost](https://catboost.ai/docs/features/categorical-features.html) è¿™æ ·çš„ç®—æ³•å¯ä»¥å›ºæœ‰åœ°å¤„ç†åˆ†ç±»å˜é‡ï¼Œä½†å¤§å¤šæ•°å…¶ä»–ç®—æ³•éƒ½ä¸æ˜¯è¿™æ ·ã€‚è¿™äº›åˆ†ç±»å˜é‡å¿…é¡»é¦–å…ˆè½¬æ¢æˆæ•°å­—é‡ï¼Œä»¥è¾“å…¥åˆ°æœºå™¨å­¦ä¹ ç®—æ³•ä¸­ã€‚æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å¯¹åˆ†ç±»å˜é‡è¿›è¡Œç¼–ç ï¼Œæ¯”å¦‚ä¸€æ¬¡æ€§ç¼–ç ã€é¡ºåºç¼–ç ã€æ ‡ç­¾ç¼–ç ç­‰ã€‚ä½†æ˜¯æœ¬æ–‡ç€çœ¼äº pandas çš„è™šæ‹Ÿå˜é‡ç¼–ç ï¼Œå¹¶æ­ç¤ºäº†å®ƒçš„æ½œåœ¨å±€é™æ€§ã€‚

# åˆ†ç±»å˜é‡â€”å¿«é€Ÿä»‹ç»

ä¸€ä¸ª [**å˜é‡**](https://www.stat.berkeley.edu/~stark/SticiGui/Text/gloss.htm#variable) çš„å€¼åœ¨å¤šä¸ªç±»åˆ«ä¸­å˜åŒ–ï¼Œç§°ä¸ºåˆ†ç±»å˜é‡ï¼Œå¦‚æ€§åˆ«ã€å¤´å‘é¢œè‰²ã€ç§æ—ã€é‚®æ”¿ç¼–ç æˆ–ç¤¾ä¼šä¿é™©å·ã€‚ä¸¤ä¸ªé‚®æ”¿ç¼–ç æˆ–ç¤¾ä¼šä¿é™©å·çš„æ€»å’Œæ²¡æœ‰æ„ä¹‰ã€‚åŒæ ·ï¼Œé‚®æ”¿ç¼–ç åˆ—è¡¨çš„å¹³å‡å€¼ä¹Ÿæ²¡æœ‰æ„ä¹‰ã€‚åˆ†ç±»å˜é‡å¯ä»¥æ ¹æ®å®ƒä»¬åˆ†ç»„çš„å…ƒç´ ç§ç±»åˆ†ä¸ºä¸¤ä¸ªå­ç±»åˆ«:

![](img/af122419bc51da2b947c802d1e163a9c.png)

åˆ†ç±»å˜é‡|ä½œè€…å›¾ç‰‡

*   **åä¹‰å˜é‡**æ˜¯é‚£äº›ç±»åˆ«æ²¡æœ‰è‡ªç„¶é¡ºåºæˆ–æ’åºçš„å˜é‡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨`1`è¡¨ç¤ºçº¢è‰²ï¼Œç”¨`2`è¡¨ç¤ºè“è‰²ã€‚ä½†æ˜¯è¿™äº›æ•°å­—æ²¡æœ‰æ•°å­¦æ„ä¹‰ã€‚ä¹Ÿå°±æ˜¯ä¸èƒ½ç›¸åŠ ï¼Œä¹Ÿä¸èƒ½å–å¹³å‡å€¼ã€‚å±äºè¿™ä¸€ç±»åˆ«çš„ä¾‹å­æœ‰æ€§åˆ«ã€é‚®æ”¿ç¼–ç ã€å¤´å‘é¢œè‰²ç­‰ã€‚
*   æœ‰åºçš„å˜é‡æœ‰ä¸€ä¸ªå†…åœ¨çš„é¡ºåºï¼Œè¿™åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯æœ‰æ„ä¹‰çš„ã€‚ä¸€ä¸ªä¾‹å­æ˜¯è·Ÿè¸ªå­¦ç”Ÿçš„æˆç»©ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯ T4 äººçš„ç¤¾ä¼šç»æµåœ°ä½ã€‚

# ç”¨â€œ`pandas.get_dummies()``ç¼–ç åˆ†ç±»å˜é‡

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯åˆ†ç±»å˜é‡ï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬ä¸èƒ½åœ¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­ç›´æ¥ä½¿ç”¨å®ƒä»¬ã€‚å®ƒä»¬å¿…é¡»è¢«è½¬æ¢æˆæœ‰æ„ä¹‰çš„æ•°å­—è¡¨ç¤ºã€‚è¿™ä¸ªè¿‡ç¨‹å«åšç¼–ç ã€‚æœ‰å¾ˆå¤šç¼–ç åˆ†ç±»å˜é‡çš„æŠ€æœ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ç‰¹åˆ«å…³æ³¨ç”± pandas åº“æä¾›çš„ä¸€ç§å«åš`[get_dummies()](https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html)`çš„æŠ€æœ¯ã€‚

 [## pandas.get_dummies - pandas 1.2.4 æ–‡æ¡£

### å°†åˆ†ç±»å˜é‡è½¬æ¢ä¸ºè™šæ‹Ÿ/æŒ‡ç¤ºå˜é‡ã€‚å‚æ•°æ•°æ®ç±»ä¼¼æ•°ç»„ã€åºåˆ—æˆ–æ•°æ®å¸§çš„æ•°æ®â€¦

pandas.pydata.org](https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html) 

é¡¾åæ€ä¹‰ï¼Œ`pandas.get_dummies()`å‡½æ•°å°†åˆ†ç±»å˜é‡è½¬æ¢æˆå“‘å˜é‡æˆ–æŒ‡ç¤ºå˜é‡ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªç”±å…¬å¸å‘˜å·¥å±æ€§ç»„æˆçš„å‡è®¾æ•°æ®é›†ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥é¢„æµ‹å‘˜å·¥çš„å·¥èµ„ã€‚

æˆ‘ä»¬çš„æ•°æ®é›†çœ‹èµ·æ¥åƒè¿™æ ·:

```
df
```

![](img/db418d5e571ffd0b6ecb2c99887d13f8.png)

å‘˜å·¥æ•°æ®é›†|ä½œè€…å›¾ç‰‡

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä¸Šé¢çš„æ•°æ®é›†ä¸­æœ‰ä¸¤ä¸ªåˆ†ç±»åˆ—ï¼Œå³`Gender`å’Œ`EducationField`ã€‚è®©æˆ‘ä»¬ä½¿ç”¨`pandas.get_dummies()`å°†å®ƒä»¬ç¼–ç æˆæ•°å­—é‡ï¼Œå®ƒè¿”å›ä¸€ä¸ªè™šæ‹Ÿç¼–ç çš„æ•°æ®å¸§ã€‚

```
pd.get_dummies(df)
```

![](img/cd85e9c679c61e0e025f6fee97ca29a5.png)

ä½œè€…å›¾ç‰‡

åˆ—`Gender`è¢«è½¬æ¢æˆä¸¤åˆ—â€” `Gender_Female`å’Œ`Gender_Male`ï¼Œå®ƒä»¬çš„å€¼è¦ä¹ˆæ˜¯ 0ï¼Œè¦ä¹ˆæ˜¯ 1ã€‚ä¾‹å¦‚ï¼Œ`Gender_Female`åœ¨æœ‰å…³å‘˜å·¥æ˜¯å¥³æ€§çš„åœ°æ–¹æœ‰ä¸€ä¸ª`value = 1`ï¼Œåœ¨ä¸æ˜¯å¥³æ€§çš„åœ°æ–¹æœ‰ä¸€ä¸ª`value = 0`ã€‚å¯¹äºåˆ—`Gender_Male`ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

![](img/9c07be7ec9b1f269757387dac85fa538.png)

è™šæ‹Ÿç¼–ç æ€§åˆ«å˜é‡|ä½œè€…å›¾ç‰‡

ç±»ä¼¼åœ°ï¼Œåˆ—`EducationField`ä¹Ÿæ ¹æ®æ•™è‚²é¢†åŸŸåˆ†æˆä¸‰ä¸ªä¸åŒçš„åˆ—ã€‚äº‹æƒ…åˆ°ç°åœ¨éƒ½å¾ˆæ˜æ˜¾äº†ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç¼–ç æ•°æ®é›†æ¥è®­ç»ƒæ¨¡å‹æ—¶ï¼Œé—®é¢˜å°±å¼€å§‹äº†ã€‚

# è™šæ‹Ÿå˜é‡é™·é˜±

å‡è®¾æˆ‘ä»¬æƒ³è¦ä½¿ç”¨ç»™å®šçš„æ•°æ®æ¥å»ºç«‹ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œè¯¥æ¨¡å‹å¯ä»¥é¢„æµ‹å‘˜å·¥çš„æœˆè–ªã€‚è¿™æ˜¯ä¸€ä¸ªå›å½’é—®é¢˜çš„ç»å…¸ä¾‹å­ï¼Œå…¶ä¸­ç›®æ ‡å˜é‡æ˜¯`MonthlyIncome.`ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨`pandas.get_dummies()`å¯¹åˆ†ç±»å˜é‡è¿›è¡Œç¼–ç ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜:

## 1ï¸âƒ£.å¤šé‡å…±çº¿æ€§é—®é¢˜

![](img/3a53f33ea0252014875766661f0d351d.png)

é€šè¿‡ç»´æ©å›¾æç»˜å¤šé‡å…±çº¿æ€§|å›¾ç‰‡ç”±ä½œè€…æä¾›

> **æ³¨**:ä¸Šå›¾éå¸¸ç›´è§‚çš„è§£é‡Šäº†å¤šé‡å…±çº¿æ€§ã€‚æ„Ÿè°¢[å‡¯ä¼¦Â·æ ¼é›·æ–¯-é©¬ä¸](https://www.theanalysisfactor.com/author/kgm_admin/)ä»¥å¦‚æ­¤æ¸…æ™°çš„æ–¹å¼è§£é‡Šäº†è¿™ä¸ªæ¦‚å¿µã€‚è¯·å‚è€ƒä¸‹é¢çš„é“¾æ¥è½¬åˆ°æ–‡ç« ã€‚

[](https://www.theanalysisfactor.com/multicollinearity-explained-visually/) [## å¤šé‡å…±çº¿æ€§çš„å¯è§†åŒ–æè¿°â€”â€”åˆ†æå› å­

### å¤šé‡å…±çº¿æ€§æ˜¯ç»Ÿè®¡å­¦ä¸­çš„æœ¯è¯­ä¹‹ä¸€ï¼Œé€šå¸¸ä»¥ä¸¤ç§æ–¹å¼å®šä¹‰:1ã€‚éå¸¸æ•°å­¦åŒ–â€¦

www.theanalysisfactor.com](https://www.theanalysisfactor.com/multicollinearity-explained-visually/) 

å›å½’æ¨¡å‹çš„å‡è®¾ä¹‹ä¸€æ˜¯è§‚æµ‹å€¼å¿…é¡»ç›¸äº’ç‹¬ç«‹ã€‚**å¤šé‡å…±çº¿æ€§**å‘ç”Ÿåœ¨**å›å½’æ¨¡å‹**ä¸­çš„ç‹¬ç«‹å˜é‡ç›¸å…³æ—¶ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆç›¸å…³æ€§æ˜¯ä¸€ä¸ªé—®é¢˜å‘¢ï¼Ÿä¸ºäº†å¸®åŠ©ä½ è¯¦ç»†ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œé¿å…é‡å¤å‘æ˜è½®å­ï¼Œæˆ‘ä¼šç»™ä½ çœ‹ä¸€ç¯‡ç”±å‰å§†Â·å¼—ç½—æ–¯ç‰¹**å†™çš„[ä¼Ÿå¤§ä½œå“ï¼Œä»–éå¸¸ç®€æ´åœ°è§£é‡Šäº†è¿™ä¸ªæ¦‚å¿µã€‚ä»¥ä¸‹æ®µè½æ¥è‡ªåŒä¸€ç¯‡æ–‡ç« ã€‚](https://statisticsbyjim.com/regression/multicollinearity-in-regression-analysis/)**

> **[å›å½’åˆ†æ](https://statisticsbyjim.com/glossary/regression-analysis/)çš„ä¸€ä¸ªå…³é”®ç›®æ ‡æ˜¯éš”ç¦»æ¯ä¸ª[è‡ªå˜é‡](https://statisticsbyjim.com/glossary/predictor-variables/)å’Œ[å› å˜é‡](https://statisticsbyjim.com/glossary/response-variables/)ä¹‹é—´çš„å…³ç³»ã€‚å¯¹[å›å½’ç³»æ•°](https://statisticsbyjim.com/glossary/regression-coefficient/)çš„è§£é‡Šæ˜¯ï¼Œå½“ä½ ä¿æŒæ‰€æœ‰å…¶ä»–è‡ªå˜é‡ä¸å˜æ—¶ï¼Œå®ƒä»£è¡¨è‡ªå˜é‡æ¯å˜åŒ– 1 ä¸ªå•ä½ï¼Œå› å˜é‡çš„[å‡å€¼](https://statisticsbyjim.com/glossary/mean/)å˜åŒ–ã€‚**

**å¦‚æœæ‰€æœ‰å˜é‡éƒ½æ˜¯ç›¸å…³çš„ï¼Œé‚£ä¹ˆæ¨¡å‹å°†å¾ˆéš¾åˆ¤æ–­æŸä¸ªç‰¹å®šå˜é‡å¯¹ç›®æ ‡çš„å½±å“æœ‰å¤šå¤§ï¼Œå› ä¸ºæ‰€æœ‰å˜é‡éƒ½æ˜¯ç›¸å…³çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå›å½’æ¨¡å‹çš„ç³»æ•°å°†ä¸ä¼šä¼ è¾¾æ­£ç¡®çš„ä¿¡æ¯ã€‚**

## **pandas.get_dummies çš„å¤šé‡å…±çº¿æ€§é—®é¢˜**

**è€ƒè™‘ä¸Šé¢çš„é›‡å‘˜ä¾‹å­ã€‚è®©æˆ‘ä»¬ä»æ•°æ®é›†ä¸­åˆ†ç¦»å‡º`Gender`åˆ—ï¼Œå¹¶å¯¹å…¶è¿›è¡Œç¼–ç ã€‚**

**![](img/d84915d2d12105ba8fff0f038293109d.png)**

**å¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿï¼Œ`Gender_Female`å’Œ`Gender_Male`åˆ—æ˜¯å¤šå…±çº¿çš„ã€‚è¿™æ˜¯å› ä¸ºä¸€åˆ—ä¸­çš„å€¼`1`è‡ªåŠ¨æš—ç¤ºå¦ä¸€åˆ—ä¸­çš„å€¼`0`ã€‚è¿™ä¸ªé—®é¢˜è¢«ç§°ä¸ºè™šæ‹Ÿå˜é‡é™·é˜±ï¼Œå¯ä»¥è¡¨ç¤ºä¸º:**

```
Gender_Female = 1 - Gender_Male
```

## **è§£å†³æ–¹æ¡ˆ:åˆ é™¤ç¬¬ä¸€åˆ—**

**å¤šé‡å…±çº¿æ€§æ˜¯ä¸å¯å–çš„ï¼Œæ¯æ¬¡æˆ‘ä»¬ç”¨`pandas.get_dummies(),`ç¼–ç å˜é‡éƒ½ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯åˆ é™¤å…¶ä¸­ä¸€ä¸ªç”Ÿæˆçš„åˆ—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤`Gender_Female`æˆ–`Gender_Male` ï¼Œè€Œä¸ä¼šæ½œåœ¨åœ°ä¸¢å¤±ä»»ä½•ä¿¡æ¯ã€‚å¹¸è¿çš„æ˜¯ï¼Œ`pandas.get_dummies()`æœ‰ä¸€ä¸ªåä¸º`drop_first`çš„å‚æ•°ï¼Œå½“è®¾ç½®ä¸º`True`æ—¶ï¼Œå®ƒå°±èƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚**

```
pd.get_dummies(df, drop_first=True)
```

**![](img/7299d9f4568b9a6978693b0a291d9d34.png)**

**ä½œè€…å›¾ç‰‡**

**æˆ‘ä»¬å·²ç»è§£å†³äº†å¤šé‡å…±çº¿æ€§ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨ dummy_encoding æ—¶ï¼Œè¿˜å­˜åœ¨å¦ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚**

## **2ï¸âƒ£.è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„åˆ—ä¸åŒ¹é…**

**ä¸ºäº†ç”¨ç»™å®šçš„é›‡å‘˜æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬é¦–å…ˆå°†æ•°æ®é›†åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå°†æµ‹è¯•é›†æ”¾åœ¨ä¸€è¾¹ï¼Œè¿™æ ·æˆ‘ä»¬çš„æ¨¡å‹å°±ä¸ä¼šçœ‹åˆ°å®ƒã€‚**

```
from sklearn.model_selection import train_test_splitX = df.drop('MonthlyIncome', axis=1)
y = df['MonthlyIncome']X_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.2, random_state=1)
```

**ä¸‹ä¸€æ­¥æ˜¯å¯¹è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„åˆ†ç±»å˜é‡è¿›è¡Œç¼–ç ã€‚**

*   ****ç¼–ç è®­ç»ƒé›†****

```
pd.get_dummies(X_train)
```

**![](img/45c97bf771e7dcf00b15cb12a085e672.png)**

**æ­£å¦‚æ‰€æ–™ï¼Œ`Gender`å’Œ`EducationField`å±æ€§éƒ½è¢«ç¼–ç æˆæ•°å­—é‡ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†å¯¹æµ‹è¯•æ•°æ®é›†åº”ç”¨ç›¸åŒçš„è¿‡ç¨‹ã€‚**

*   ****ç¼–ç æµ‹è¯•é›†****

```
pd.get_dummies(X_test)
```

**![](img/32a9cf576df4f3d5b4cf3c924bc45b63.png)**

**ç­‰ç­‰ï¼å®šå‹é›†å’Œæµ‹è¯•é›†ä¸­å­˜åœ¨åˆ—ä¸åŒ¹é…ã€‚è¿™æ„å‘³ç€è®­ç»ƒé›†ä¸­çš„åˆ—æ•°ä¸ç­‰äºæµ‹è¯•é›†ä¸­çš„åˆ—æ•°ï¼Œè¿™å°†åœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­å¼•å‘é”™è¯¯ã€‚**

## **è§£å†³æ–¹æ¡ˆ 1: `Handle unknown by using .reindex and .fillna()`**

**è§£å†³è¿™ç§ç±»åˆ«ä¸åŒ¹é…çš„ä¸€ç§æ–¹æ³•æ˜¯å°†å¯¹è®­ç»ƒé›†è¿›è¡Œå“‘ç¼–ç åè·å¾—çš„åˆ—ä¿å­˜åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ç„¶åï¼Œç…§å¸¸å¯¹æµ‹è¯•é›†è¿›è¡Œç¼–ç ï¼Œå¹¶ä½¿ç”¨ç¼–ç çš„è®­ç»ƒé›†çš„åˆ—æ¥å¯¹é½ä¸¤ä¸ªæ•°æ®é›†ã€‚è®©æˆ‘ä»¬é€šè¿‡ä»£ç æ¥ç†è§£å®ƒ:**

```
# Dummy encoding Training set
X_train_encoded = pd.get_dummies(X_train)# Saving the columns in a list
cols = X_train_encoded.columns.tolist()# Viewing the first three rows of the encoded dataframe
X_train_encoded[:3]
```

**![](img/c16e3136eb96f2110d190f83ef1ce6bc.png)**

**ä½œè€…å›¾ç‰‡**

**ç°åœ¨ï¼Œæˆ‘ä»¬å°†å¯¹æµ‹è¯•é›†è¿›è¡Œç¼–ç ï¼Œç„¶åé‡æ–°æ’åˆ—è®­ç»ƒå’Œæµ‹è¯•åˆ—ï¼Œå¹¶ç”¨é›¶å¡«å……æ‰€æœ‰ç¼ºå¤±çš„å€¼ã€‚**

```
X_test_encoded = pd.get_dummies(X_test)
X_test_encoded = X_test_encoded.reindex(columns=cols).fillna(0)
X_test_encoded
```

**![](img/cab54c1036360f9c725e1c5c1848d19d.png)**

**ä½œè€…å›¾ç‰‡**

**å¦‚æ‚¨æ‰€è§ï¼Œç°åœ¨ä¸¤ä¸ªæ•°æ®é›†æ‹¥æœ‰ç›¸åŒæ•°é‡çš„åˆ—ï¼Œ**

## **è§£å†³æ–¹æ¡ˆ 2:ä½¿ç”¨`**One Hot Encoding**`**

**å¦ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨`[sklearn.preprocessing](https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing).OneHotEncoder().`ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`handle_unknown="ignore"`æ¥è§£å†³ç”±äºç¨€æœ‰ç±»åˆ«è€Œå¯¼è‡´çš„æ½œåœ¨é—®é¢˜ã€‚**

```
#One hot encoding the categorical columns in training setfrom sklearn.preprocessing import OneHotEncoder
ohe = OneHotEncoder(sparse=False, handle_unknown='ignore')
train_enc = ohe.fit_transform(X_train[['Gender','EducationField']])#Converting back to a dataframe 
pd.DataFrame(train_enc, columns=ohe.get_feature_names())[:3]
```

**![](img/16ebae32d08ac8cf965f212c9f169024.png)**

**ä½œè€…å›¾ç‰‡**

```
# Transforming the test settest_enc = ohe.fit_transform(X_test[['Gender','EducationField']])#Converting back to a dataframe
pd.DataFrame(test_enc,columns=ohe.get_feature_names())
```

**![](img/5fba805ec47ff872a17742b8f13582a8.png)**

**ä½œè€…å›¾ç‰‡**

**æ³¨æ„ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®å‚æ•°`drop=â€™if_binaryâ€™`æ¥åˆ é™¤ [OnehotEncoder](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html) ä¸­æ¯ä¸ªç‰¹æ€§çš„ä¸€ä¸ªç±»åˆ«ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ[æ–‡æ¡£](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html)ã€‚**

# **ç»“è®ºå’Œè¦ç‚¹**

**è¿™ç¯‡æ–‡ç« ç ”ç©¶äº†å¦‚ä½•ä½¿ç”¨ pandas å¯¹åˆ†ç±»å˜é‡è¿›è¡Œç¼–ç ï¼Œä»¥åŠä¸ä¹‹ç›¸å…³çš„å¸¸è§æ³¨æ„äº‹é¡¹ã€‚æˆ‘ä»¬è¿˜è¯¦ç»†ç ”ç©¶äº†é¿å…è¿™äº›é™·é˜±çš„å¯è¡Œè§£å†³æ–¹æ¡ˆã€‚æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½è®©ä½ ç›´è§‚åœ°äº†è§£ä»€ä¹ˆæ˜¯å“‘å˜é‡é™·é˜±ï¼Œä»¥åŠå¦‚ä½•é¿å…å®ƒã€‚æ­¤å¤–ï¼Œæœ¬æ–‡ä¸­å¼•ç”¨çš„ä¸¤ç¯‡æ–‡ç« æ˜¯å¾ˆå¥½çš„å‚è€ƒï¼Œå°¤å…¶æ˜¯å¦‚æœæ‚¨æƒ³æ›´æ·±å…¥åœ°ç ”ç©¶ä¸å¤šé‡å…±çº¿æ€§ç›¸å…³çš„é—®é¢˜ã€‚æˆ‘å¼ºçƒˆæ¨èä»–ä»¬ã€‚**

***ğŸ‘‰æœ‰å…´è¶£çœ‹æˆ‘å†™çš„å…¶ä»–æ–‡ç« ã€‚è¿™ä¸ª* [*å›è´­*](https://github.com/parulnith/Data-Science-Articles/blob/main/README.md) *åŒ…å«äº†æˆ‘åˆ†ç±»å†™çš„æ‰€æœ‰æ–‡ç« ã€‚***