# å¦‚ä½•æ‘†è„±æ ‡ç­¾å°‘:æ ‡ç­¾ä¼ æ’­

> åŸæ–‡ï¼š<https://towardsdatascience.com/how-to-get-away-with-few-labels-label-propagation-f891782ada5c?source=collection_archive---------3----------------------->

## [ç†è§£å¤§æ•°æ®](https://towardsdatascience.com/tagged/making-sense-of-big-data)

## èªæ˜ä¸€ç‚¹ï¼Œä¸è¦è‡ªå·±æ‰‹åŠ¨æ ‡æ³¨æ•°ç™¾ç”šè‡³æ•°åƒä¸ªæ•°æ®ç‚¹ã€‚

![](img/6eab733cdcee47c6a3051f736a48075e.png)

ç…§ç‰‡ç”±[å¸ƒå…°å¡Â·å¸•æ´›ç›Â·æ¡‘åˆ‡æ–¯](https://unsplash.com/@blancaplum?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

# ä»‹ç»

ç¾å›½æ•°æ®ç§‘å­¦å®¶çš„ä¸€ä¸ªç»å…¸ä»»åŠ¡æ˜¯ä¸ºæŸä¸ªé—®é¢˜å»ºç«‹åˆ†ç±»æ¨¡å‹ã€‚åœ¨ä¸€ä¸ªå®Œç¾çš„ä¸–ç•Œé‡Œï¼Œæ•°æ®æ ·æœ¬â€”â€”åŒ…æ‹¬å®ƒä»¬ç›¸åº”çš„æ ‡ç­¾â€”â€”æ˜¯æ”¾åœ¨ä¸€ä¸ªé“¶ç›˜é‡Œäº¤ç»™æˆ‘ä»¬çš„ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨æœºå™¨å­¦ä¹ æŠ€å·§å’Œ*Mathematica*ä»æ•°æ®ä¸­å¾—å‡ºä¸€äº›æœ‰ç”¨çš„è§è§£ã€‚åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ã€‚

ç„¶è€Œï¼Œåœ¨æˆ‘ä»¬è¿™ä¸ªä¸å®Œç¾å´åˆç¾ä¸½çš„ä¸–ç•Œé‡Œï¼Œç»å¸¸å‘ç”Ÿçš„äº‹æƒ…æ˜¯ä»¥ä¸‹ä¹‹ä¸€:

1.  **æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæå°çš„æ•°æ®é›†ï¼Œå®ƒè‡³å°‘æ˜¯å®Œå…¨æ ‡è®°çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ„å»ºæ¨¡å‹å¯èƒ½ä¼šéå¸¸æ£˜æ‰‹ã€‚æˆ‘ä»¬å¿…é¡»ä½¿ç”¨å…ˆè¿›çš„ç‰¹å¾å·¥ç¨‹ï¼Œç”šè‡³å¯èƒ½ä½¿ç”¨è´å¶æ–¯æ–¹æ³•å’Œå…¶ä»–å·¥å…·æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä»¥ Kaggle ä¸Šçš„[è¿‡æ‹ŸåˆæŒ‘æˆ˜ä¸ºä¾‹:è®­ç»ƒé›†ç”± 250 ä¸ªè®­ç»ƒæ ·æœ¬å’Œ 200 ä¸ªç‰¹å¾ç»„æˆã€‚ç©å¾—å¼€å¿ƒã€‚](https://www.kaggle.com/c/overfitting/)**
2.  **æˆ‘ä»¬å¾—åˆ°äº†è¶³å¤Ÿçš„æ•°æ®ï¼Œä½†å´æ²¡æœ‰ä»»ä½•æ ‡ç­¾ã€‚å—¯ï¼Œè¿æ°”ä¸å¥½ã€‚å°è¯•èšç±»ï¼Œä½†è¿™ä¸ä¸€å®šèƒ½è§£å†³æ‚¨çš„åˆ†ç±»é—®é¢˜ã€‚**
3.  **æˆ‘ä»¬å¾—åˆ°äº†è¶³å¤Ÿçš„æ•°æ®ï¼Œä½†åªæ˜¯éƒ¨åˆ†æ ‡æ³¨ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­è®¨è®ºçš„å†…å®¹ï¼ç»§ç»­è¯»ã€‚**

è®©æˆ‘ä»¬å‡è®¾ä»ç°åœ¨å¼€å§‹æˆ‘ä»¬å¤„äºç¬¬ä¸‰ç§æƒ…å†µ:æˆ‘ä»¬çš„æ•°æ®é›†çš„å¤§å°ç›¸å½“ä¸é”™ï¼Œæˆ‘ä»¬æœ‰å‡ åƒä¸ªæ ·æœ¬ï¼Œç”šè‡³å¯èƒ½æ˜¯ä¸€ç™¾ä¸‡ä¸ªã€‚ä½†æ˜¯çœ‹ç€æ ‡ç­¾ï¼ŒæŒ«è´¥æ„Ÿæ²¹ç„¶è€Œç”Ÿâ€” **åªæœ‰ä¸€å°éƒ¨åˆ†æ•°æ®è¢«è´´ä¸Šäº†æ ‡ç­¾ï¼**

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•å¤„ç†è¿™äº›å¸¸è§çš„æƒ…å†µã€‚

# å¤©çœŸçš„æ–¹æ³•

æ¥è¿‘è¿™ä¸ªè®¾ç½®çš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯æŠŠå®ƒè½¬æ¢æˆæˆ‘ä»¬æ›´ç†Ÿæ‚‰çš„ä¸œè¥¿ã€‚å…·ä½“æ¥è¯´:

> ä¸¢å¼ƒæœªæ ‡è®°çš„æ•°æ®ç‚¹ï¼Œå¹¶åœ¨å‰©ä½™çš„å®Œå…¨æ ‡è®°ä½†è¾ƒå°çš„æ•°æ®é›†ä¸Šè®­ç»ƒåˆ†ç±»å™¨ã€‚

æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ç§åšæ³•ã€‚

## èµæˆçš„æ„è§

*   æ˜“äºç†è§£å’Œå®æ–½
*   å¿«é€Ÿè½¬æ¢å’Œå¿«é€Ÿè®­ç»ƒï¼Œå› ä¸ºè¾ƒå°‘çš„æ ·æœ¬æ„å‘³ç€è¾ƒå°‘çš„è®¡ç®—

## éª—å±€

*   æ¨¡å‹å¯èƒ½ä¼šè¿‡åº¦é€‚åº”å‰©ä½™çš„æ•°æ®
*   æ ‡è®°æ•°æ®çš„è¿‡ç¨‹ä¸­çš„åå·®å¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹çš„é”™è¯¯å†³ç­–è¾¹ç•Œ

è™½ç„¶èµæˆä¸€æ–¹çš„è®ºç‚¹åº”è¯¥å¾ˆå®¹æ˜“ç†è§£ï¼Œä½†è®©æˆ‘ä»¬çœ‹ä¸€å¼ å›¾æ¥æ›´å¥½åœ°ç†è§£ç¼ºç‚¹ã€‚

![](img/e547caddd1218d7b55f1cd8dda49dfa6.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä½œä¸ºäººç±»ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°æœ‰ä¸¤ä¸ªæ–‘ç‚¹ã€‚å·¦è¾¹çš„åº”è¯¥æ˜¯è“è‰²çš„ï¼Œå³è¾¹çš„åº”è¯¥æ˜¯çº¢è‰²çš„ã€‚ä¸­é—´å¯èƒ½ä¼šæœ‰ä¸€äº›é‡å ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œå®ƒä»¬å¯ä»¥ç”¨ä¸€æ¡ç›´çº¿å¾ˆå¥½åœ°åˆ†å¼€ï¼Œå³é€»è¾‘å›å½’æˆ–çº¿æ€§ SVMã€‚

![](img/bb5f449e353fc25471cd70f26d47b5be.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ä¸¢å¼ƒæœªæ ‡è®°çš„æ•°æ®å¹¶æ‹Ÿåˆé€»è¾‘å›å½’ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°ä»¥ä¸‹å†³ç­–åŒºåŸŸ:

![](img/d55540c489b2cef9dafca031355f488e.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä¸å¤ªå¥½ã€‚ç”±äºè¿‡åº¦æ‹Ÿåˆï¼Œç»“æœå¹¶ä¸å·®ï¼Œå› ä¸ºé€»è¾‘å›å½’æ˜¯ä¸€ä¸ªç®€å•çš„æ¨¡å‹ã€‚ä½†æ˜¯è¢«æ ‡è®°çš„æ•°æ®ç‚¹çš„ä½ç½®æ˜¯**åç§»çš„**ï¼Œå³**å®ƒä»¬æœ‰ä¸€äº›å¥‡æ€ªçš„æ¨¡å¼**ï¼Œä½¿åˆ†ç±»å™¨æ··æ·†ã€‚å…¬å¹³åœ°è¯´ï¼Œå¦‚æœæ ‡è®°çš„æ•°æ®ç‚¹åœ¨ä¸¤ä¸ªæ–‘ç‚¹çš„ä¸­å¿ƒï¼Œé€»è¾‘å›å½’ä¼šå·¥ä½œå¾—æ›´å¥½ã€‚

å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬è¯•å›¾å°†éšæœºæ£®æ—å’Œç¥ç»ç½‘ç»œæ”¾åœ¨è§„æ¨¡ä¸º 4 çš„è®­ç»ƒé›†ä¸Šï¼Œä¹Ÿä¼šå‡ºç°**è¿‡æ‹Ÿåˆé—®é¢˜**ã€‚æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®º:

> ç®€å•åœ°ä¸¢å¼ƒæœªæ ‡è®°çš„æ•°æ®ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚

ç°åœ¨è®©æˆ‘ä»¬è½¬å‘ä¸€ç§æ›´æ™ºèƒ½çš„æŠ€æœ¯ï¼Œå®ƒä¸ä»…å…è®¸æˆ‘ä»¬æ•´åˆå·²æ ‡è®°æ•°æ®çš„çŸ¥è¯†ï¼Œè¿˜å…è®¸æˆ‘ä»¬æ•´åˆæœªæ ‡è®°æ•°æ®æ ·æœ¬çš„ç‰¹å¾ã€‚

> è¿™å°±æ˜¯äººä»¬æœ‰æ—¶æ‰€è¯´çš„**åŠç›‘ç£å­¦ä¹ **ã€‚

# æ ‡ç­¾ä¼ æ’­ç®—æ³•

æ ‡ç­¾ä¼ æ’­æ˜¯æœ±å°é‡‘å’Œé‚¹æ–ŒÂ·æ ¼æ‹‰é©¬å°¼[1]åœ¨ 2002 å¹´æå‡ºçš„ä¸€ä¸ªå¥½ä¸»æ„ã€‚

**é‡è¦æç¤º:**åœ¨è¿™é‡Œï¼Œæˆ‘å¯¹åŸå§‹è®ºæ–‡çš„æƒ³æ³•åšäº†ä¸€ç‚¹æ”¹åŠ¨ï¼Œä»¥ä¾¿äºè§£é‡Šå’Œç†è§£ã€‚è¿™ä¸¤ç§å˜ä½“ä»¥åŠå…¶ä»–ç°æœ‰å˜ä½“çš„ä¸»æ—¨ä»ç„¶æ˜¯ç›¸åŒçš„ã€‚

ä»ä¸€ä¸ªéå¸¸é«˜çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹:

## **1ã€‚ä»¥æ•°æ®æ ·æœ¬ä¸ºèŠ‚ç‚¹æ„å»ºä¸€ä¸ªå›¾ã€‚åœ¨æ¯å¯¹æ ·æœ¬ä¹‹é—´æ”¾ä¸€æ¡åŠ æƒè¾¹ã€‚æ ·æœ¬è¶Šæ¥è¿‘ï¼Œæƒé‡è¶Šé«˜ã€‚æ ‡ç­¾åœ¨è¿™ä¸€ç‚¹ä¸Šå¹¶ä¸é‡è¦ã€‚**

è¿™è¿«åˆ‡éœ€è¦ä¸€ä¸ªä¾‹å­ã€‚è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰å¦ä¸€ä¸ªäºŒç»´æ•°æ®é›†ï¼Œå®ƒåªåŒ…å«äº”ä¸ªæ ·æœ¬ã€‚æœ‰ä¸¤ä¸ªç±»åˆ«ï¼Œä¸€ä¸ªæ ·æœ¬æ²¡æœ‰æ ‡è®°ã€‚æ ·æœ¬æ˜¯æˆ‘ä»¬å›¾è¡¨çš„èŠ‚ç‚¹ã€‚

![](img/d70298ebfd5ba5076c22659f43cd4b93.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå®Œæ•´çš„å›¾å½¢ï¼Œå³è¿æ¥æ¯ä¸ªèŠ‚ç‚¹ä¸ä»»ä½•å…¶ä»–èŠ‚ç‚¹ã€‚æˆ‘ä»¬è¿˜ç”¨èŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»(=æ ·æœ¬)æ¥æ³¨é‡Šè¾¹ã€‚ä½ å¯ä»¥é€‰æ‹©ä»»ä½•ä½ å–œæ¬¢çš„è·ç¦»(å³æ¬§å‡ é‡Œå¾·è·ç¦»)ï¼Œå®ƒåªæ˜¯ç®—æ³•çš„å¦ä¸€ä¸ªè¶…å‚æ•°ã€‚

**æ³¨æ„:**æˆ‘çœç•¥äº†æ ‡è®°æ ·æœ¬ä¹‹é—´çš„è¾¹ç¼˜ï¼Œå› ä¸ºå®ƒä¿æŒäº†å¯è§†åŒ–çš„æ¸…æ™°ï¼Œå¹¶ä¸”ç®—æ³•æ— è®ºå¦‚ä½•éƒ½ä¸éœ€è¦é‚£äº›ã€‚

![](img/e6f0059fbef1308b6a93dfa8f33b4c55.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿˜è®°å¾—æˆ‘ä»¬è¯´è¿‡**æ›´æ¥è¿‘çš„æ ·æœ¬**ä¹‹é—´åº”è¯¥æœ‰**æ›´é«˜çš„æƒé‡**å—ï¼Ÿåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ˜¯åè¿‡æ¥çš„ï¼æœ‰å‡ ç§æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯:åœ¨æ‰€æœ‰æ•°å­—å‰é¢åŠ ä¸€ä¸ªå‡å·ï¼Œæˆ–è€…(ç›¸ä¹˜)åè½¬æ•°å­—ï¼Œä¾‹å¦‚ 4 â†’ 1/4=0.25ã€‚

ä½œè€…åœ¨[1]ä¸­æå‡ºçš„æ˜¯ä½¿ç”¨æŸç§**é«˜æ–¯**å‡½æ•°ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸º**å¾„å‘åŸºå‡½æ•°** (rbf)ã€‚

![](img/786a7a24a2071ce204b4cdf2356f71f4.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å…¶ä¸­ *x* å’Œ *x* ä¸ºæ ·æœ¬ã€‚å¦‚æœä¸¤ä¸ªæ ·æœ¬éå¸¸æ¥è¿‘ï¼Œå³| *x-x* '|çº¦ä¸º 0ï¼Œåˆ™å®ƒä»¬çš„è¾¹æƒé‡çº¦ä¸º 1ã€‚å®ƒä»¬ç¦»å¾—è¶Šè¿œï¼Œé‡é‡è¶Šæ¥è¿‘é›¶ã€‚

*Ïƒ* æ˜¯ä¸€ä¸ªæ‚¨å¯ä»¥éšæ„ä½¿ç”¨çš„è¶…å‚æ•°ã€‚ä¾‹å¦‚ï¼ŒScikit-learn å¯¹å®ƒçš„ç¼ºçœå€¼æ˜¯ *Ïƒ* = 20ã€‚

æ— è®ºå¦‚ä½•ï¼Œç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨ä¹˜æ³•é€†è¿ç®—ã€‚å›¾è¡¨å˜æˆäº†

![](img/3240bd712b72c942e7cdac0bd013dbf4.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™æ˜¯ç¬¬ä¸€æ­¥çš„ç»“å°¾ã€‚

## 2.è¦è·å–æœªæ ‡è®°æ ·æœ¬çš„æ ‡ç­¾ï¼Œä»è¯¥æ ·æœ¬å¼€å§‹è¿›è¡Œ[éšæœºæ¼«æ­¥](https://upload.wikimedia.org/wikipedia/commons/f/f3/Random_walk_2500_animated.svg)ã€‚éå†çš„ä¸€ä¸ªæ­¥éª¤åŒ…æ‹¬ä»ä¸€ä¸ªèŠ‚ç‚¹éšæœºè·³åˆ°ç›¸é‚»èŠ‚ç‚¹ã€‚å…·æœ‰è¾ƒé«˜æƒé‡çš„è¾¹è¢«é€‰æ‹©çš„æ¦‚ç‡è¾ƒé«˜ã€‚è®¡ç®—éšæœºæ¼«æ­¥é¦–å…ˆè¿›å…¥è“è‰²èŠ‚ç‚¹çš„æ¦‚ç‡ã€‚å¦‚æœå¤§äº 50%ï¼Œå°†èŠ‚ç‚¹æ ‡è®°ä¸ºè“è‰²ï¼Œå¦åˆ™æ ‡è®°ä¸ºçº¢è‰²ã€‚

è¿™å¬èµ·æ¥æ¯”å®é™…ä¸Šæ›´å›°éš¾ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ä»ä¸‹æ–¹ç™½è‰²çš„æœªæ ‡è®°èŠ‚ç‚¹å¼€å§‹ã€‚ä¸ºäº†ç»§ç»­ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰è·³è½¬åˆ°å¦ä¸€ä¸ªæœªæ ‡è®°èŠ‚ç‚¹çš„æ¦‚ç‡ï¼Œä¸¤ä¸ªè“è‰²èŠ‚ç‚¹å’Œçº¢è‰²èŠ‚ç‚¹ä¸­çš„ä¸€ä¸ªã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡è§„èŒƒåŒ–ã€‚

æœ‰å››ä¸ªæƒé‡ä¸º 1(é€šå‘è“è‰²èŠ‚ç‚¹)ã€0.25(å¦ä¸€ä¸ªè“è‰²èŠ‚ç‚¹)ã€0.5(å¦ä¸€ä¸ªæœªæ ‡è®°çš„èŠ‚ç‚¹)å’Œ 0.5(çº¢è‰²èŠ‚ç‚¹)çš„å¤–å‡ºè¾¹ã€‚æ‰€ä»¥ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åªè¦æŠŠè·³åˆ°çº¢è‰²èŠ‚ç‚¹çš„æ¦‚ç‡å®šä¹‰ä¸º 0.5/(1+0.25+0.5+0.5)=2/9ã€‚è·³åˆ°æ›´è¿‘çš„è“è‰²èŠ‚ç‚¹å‘ç”Ÿçš„æ¦‚ç‡ä¸º 1/(1+0.25+0.5+0.5)=4/9ã€‚å‰©ä¸‹çš„ä½ è‡ªå·±ç®—ã€‚

ä½¿ç”¨è¿™äº›æ¦‚ç‡ï¼Œæœ‰å¾ˆå¤šç†è®ºæ¶‰åŠåˆ°å¦‚ä½•è®¡ç®—å…ˆåˆ°è¾¾è“è‰²æˆ–çº¢è‰²èŠ‚ç‚¹çš„æ¦‚ç‡ã€‚ä½ å¯ä»¥é€šè¿‡[é©¬å°”å¯å¤«é“¾](https://en.wikipedia.org/wiki/Markov_chain)æ¥å®ç°ï¼Œè¿™æ˜¯æ•°å­¦ä¸­ä¸€ä¸ªè¿·äººçš„é¢†åŸŸã€‚æœ‰ä¸€å¤©æˆ‘ç”šè‡³å¯èƒ½ä¼šå†™ä¸€ç¯‡å…³äºå®ƒçš„æ–‡ç« ï¼Œä½†æ˜¯ç°åœ¨ï¼Œæˆ‘åªä¼šç»™ä½ æä¾›ç»“æœã€‚

äººä»¬å¯ä»¥è®¡ç®—ä»»ä¸€é¢œè‰²ç€é™†çš„ä¸‹åˆ—æ¦‚ç‡:

![](img/ec5a103c158d882a565089f7ff153f22.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æœ‰äº†è¿™ä¸ªç»“æœï¼Œæˆ‘ä»¬å¯ä»¥è¯´ä¸Šé¢çš„æœªæ ‡è®°èŠ‚ç‚¹å¯èƒ½å±äºçº¢è‰²ç±»ï¼Œè€Œä¸‹é¢çš„èŠ‚ç‚¹åº”è¯¥æ˜¯è“è‰²çš„ã€‚å¦‚æœæˆ‘ä»¬ä¸æƒ³å±€é™äºæŸä¸€ç±»ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿™äº›æ¦‚ç‡ä½œä¸ºè½¯æ ‡ç­¾ã€‚

![](img/6f577b9b4889e50df988f8a90135972a.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™å¤§æ¦‚ä¹Ÿæ˜¯ä½ ç›´è§‰ä¸Šå·²ç»é¢„æ–™åˆ°çš„ï¼Œè¿™å°±è¯´æ˜äº†è¿™ä¸ªæ–¹æ³•ã€‚

ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„å®é™…åº”ç”¨ï¼

# ä½¿ç”¨ scikit-learn è¿›è¡Œæ ‡ç­¾ä¼ æ’­

ä½¿ç”¨æ ‡ç­¾ä¼ æ’­å¾ˆå®¹æ˜“ï¼Œè¿™å†æ¬¡å½’åŠŸäº scikit-learnï¼åœ¨ä¸‹é¢çš„ç‰‡æ®µä¸­ï¼Œæˆ‘

1.  åŠ è½½æ‰€æœ‰åº“å’Œ MNIST æ•°æ®é›†ï¼Œ
2.  ç”¨ä¸€ä¸ª **-1** å±è”½æ ‡ç­¾çš„ **90%** å‘¨å›´ï¼Œä¸€ä¸ªä¸¢å¤±æ ‡ç­¾çš„é¢„æœŸè¾“å…¥ï¼Œç„¶å
3.  ä½¿ç”¨æ ‡ç­¾ä¼ æ’­æ¥æ¢å¤æˆ‘åˆšåˆšå±è”½çš„æ ‡ç­¾ã€‚

ç”±äºæˆ‘ä»¬çŸ¥é“çœŸæ­£çš„æ ‡ç­¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥è¯„ä¼°å±è”½é›†ä¸Šçš„æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½è¿™æ ·åšã€‚

```
import numpy as np
from sklearn.datasets import load_digits
from sklearn.metrics import classification_report
from sklearn.semi_supervised import LabelPropagation

np.random.seed(0)

X, y_true = load_digits(return_X_y=True)

n = len(y)
mask = np.random.choice(range(n), 9*n//10, replace=False)
y_missing = y_true.copy()
y_missing[mask] = -1 # -1 indicates a missing label

lp = LabelPropagation(gamma=.25) # rbf is the default, gamma = 1/ÏƒÂ²!
lp.fit(X, y_missing) # run the algorithm we described above

print(classification_report(y_true[mask], lp.transduction_[mask]))
```

è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:

```
 precision    recall  f1-score   support 0       0.98      0.99      0.98       161
           1       0.90      0.99      0.94       163
           2       1.00      0.96      0.98       159
           3       0.90      0.95      0.92       168
           4       0.98      0.97      0.97       159
           5       0.95      0.97      0.96       161
           6       0.99      0.98      0.98       166
           7       0.99      0.98      0.98       159
           8       0.91      0.85      0.88       160
           9       0.95      0.88      0.91       161

    accuracy                           **0.95**      1617
   macro avg       0.95      0.95      0.95      1617
weighted avg       0.95      0.95      0.95      1617
```

95%çš„å‡†ç¡®ç‡ï¼Œæˆ‘è¿˜èƒ½è¯´ä»€ä¹ˆï¼Ÿ*å¤ªç¥å¥‡äº†ï¼*è¯¥ç®—æ³•åªèƒ½è®¿é—® **10%** æ•°æ®çš„æ ‡ç­¾ï¼Œä½†å®ƒå‡ ä¹åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½èƒ½æ­£ç¡®æ ‡è®°å…¶ä»–æ ·æœ¬ã€‚å½“æˆ‘ç¬¬ä¸€æ¬¡åœ¨ [scikit-learn é¡µé¢](https://scikit-learn.org/stable/auto_examples/semi_supervised/plot_label_propagation_digits.html)ä¸Šçœ‹åˆ°è¿™ä¸ªä¾‹å­çš„å¦ä¸€ç§å½¢å¼æ—¶ï¼Œæˆ‘å°±å¼€å§‹ç›¸ä¿¡äº†ã€‚æˆ‘æ•¢æ‰“èµŒï¼Œè¿™å¯èƒ½å¯¹ä½ çš„æ—¥å¸¸å·¥ä½œä¹Ÿå¾ˆæœ‰ç”¨ï¼

å½“ç„¶ï¼Œè¿™ä¸æ˜¯ 100%æ­£ç¡®çš„ï¼Œä½†å¦‚æœä½ ä¸æƒ³è‡ªå·±æ ‡è®°æ•°åƒç”šè‡³æ•°ç™¾ä¸‡ä¸ªæ ·å“ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„é€‰æ‹©ã€‚

# è¯„è®º

ä½œä¸ºæœ€åçš„å®˜æ–¹è¡Œä¸ºï¼Œè®©æˆ‘ç»™ä½ æŒ‡å‡ºä¸€äº›æœ‰è¶£çš„ç»†èŠ‚ã€‚

## ä¸ KNN çš„è”ç³»

ä»”ç»†æƒ³æƒ³ï¼Œæ ‡ç­¾ä¼ æ’­æ„Ÿè§‰æœ‰ç‚¹[*k*-æœ€è¿‘é‚» *-ish*](/understanding-by-implementing-k-nearest-neighbors-469d6f84b8a9) *ï¼Œ*ä¸æ˜¯å—ï¼Ÿæƒ³è±¡ä½ è®­ç»ƒäº†ä¸€ä¸ª KNN åˆ†ç±»å™¨ã€‚åœ¨é¢„æµ‹æ—¶é—´ï¼Œä¸€ä¸ªæ²¡æœ‰æ ‡ç­¾çš„æ–°ç‚¹è¿›å…¥ã€‚ä½ æ‰«æä½ çš„æ•´ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œå¹¶ä»ä¸­æŒ‘é€‰æœ€æ¥è¿‘çš„ç‚¹ã€‚ç¦»æ–°ç‚¹è¶Šè¿‘çš„ç‚¹è¶Šé‡è¦ã€‚

æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæ ‡ç­¾ä¼ æ’­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸¤ä¸ªæ ·æœ¬ *x* ã€ *x* è¶Šè¿‘ï¼Œå®ƒä»¬ä¹‹é—´çš„è¾¹åœ¨å›¾ä¸­çš„æƒé‡å°±è¶Šå¤§ï¼Œä½ ä» *x* è·³åˆ° *x* çš„æ¦‚ç‡å°±è¶Šé«˜ï¼Œåä¹‹äº¦ç„¶ã€‚ç›¸ä¼¼ä¹‹å¤„æ˜¯å­˜åœ¨çš„ï¼Œç„¶è€Œæ ‡ç­¾ä¼ æ’­æ¯”æœ€è¿‘é‚»å±…è¦å¤æ‚ä¸€äº›ã€‚

æ ‡ç­¾ä¼ æ’­åŒæ—¶è€ƒè™‘äº†å¤§é‡æœªæ ‡è®°çš„æ ·æœ¬ï¼Œå®ƒä»¬ç›¸äº’å¸®åŠ©ï¼Œåœ¨å›¾å½¢/æ•°æ®é›†ä¸­çš„ä»»ä½•åœ°æ–¹ä¼ æ’­æ­£ç¡®çš„æ ‡ç­¾ã€‚å°± KNN è€Œè¨€ï¼Œæ¯ä¸ªæ ·æœ¬éƒ½æœ‰å…¶è‡ªèº«çš„ç‰¹ç‚¹ã€‚å› æ­¤ï¼Œä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œæ ‡ç­¾ä¼ æ’­æ˜¯ä¸€ç§æ›´æ™ºèƒ½çš„ç®—æ³•ã€‚è™½ç„¶æˆ‘ä»¬ä¸åº”è¯¥æŠŠè‹¹æœå’Œ*æ¢¨*ç›¸æå¹¶è®ºï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨å¾·å›½æ‰€è¯´çš„:ä¸¤ç§ç®—æ³•è§£å†³äº†ä¸åŒçš„é—®é¢˜ã€‚

## è¿™äº›å›¾è¡¨å¾ˆå¤§

å‡è®¾æ‚¨æœ‰ä¸€ä¸ªç”± 1ï¼Œ000ï¼Œ000 ä¸ªæ ·æœ¬ç»„æˆçš„æ•°æ®é›†ã€‚åœ¨æ ‡ç­¾ä¼ æ’­è¿‡ç¨‹ä¸­åˆ›å»ºçš„å›¾å½¢

> **1ï¼Œ000ï¼Œ000 * (1ï¼Œ000ï¼Œ000â€“1)/2 =**499ï¼Œ999ï¼Œ500ï¼Œ000

è¾¹ç¼˜ã€‚å¦‚æœæ‚¨å°†è¿™äº›è¾¹çš„æƒé‡å­˜å‚¨ä¸º 64 ä½æµ®ç‚¹ï¼Œé‚£å·²ç»æ˜¯ **4 TB** äº†ã€‚å†…å­˜å¤ªå¤§ï¼Œå†™å…¥ç£ç›˜æ—¶é€Ÿåº¦å¤ªæ…¢ã€‚è¯·æ³¨æ„ï¼Œè¿™æ˜¯æˆ‘è§£é‡Šç®—æ³•çš„æ–¹å¼ï¼Œä¹Ÿæ˜¯[scikit-learn](https://scikit-learn.org/stable/modules/generated/sklearn.semi_supervised.LabelPropagation.html)`[LabelPropagation](https://scikit-learn.org/stable/modules/generated/sklearn.semi_supervised.LabelPropagation.html)`çš„é»˜è®¤è¡Œä¸ºã€‚

åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥æ„å»ºä¸€ä¸ª*ä¸å®Œæ•´çš„*å›¾ã€‚ä¸å…¶å°†æ¯ä¸ªæ ·æœ¬èŠ‚ç‚¹ä¸å…¶ä»–èŠ‚ç‚¹è¿æ¥èµ·æ¥ï¼Œä¸å¦‚å°†å…¶ä¸å…¶ *k* æœ€è¿‘çš„é‚»å±…è¿æ¥èµ·æ¥ã€‚(*åˆæ¥äº†ã€‚*)

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªæœ‰ *k* * 1ï¼Œ000ï¼Œ000 æ¡è¾¹ï¼Œå¯¹äºåƒ *k* =7 è¿™æ ·çš„å°å€¼ï¼Œä»ç„¶å¾ˆå®¹æ˜“å¤„ç†ã€‚æ‚¨å¯ä»¥åœ¨ scikit-learn ä¸­ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œé€šè¿‡è®¾ç½®`kernel='knn'`ç„¶åä¹Ÿç©å¼„`n_neighbors`å‚æ•°ã€‚

# ç»“è®º

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†åªæœ‰ä¸€å°éƒ¨åˆ†æ ‡è®°æ•°æ®çš„æ•°æ®é›†çš„é—®é¢˜ã€‚æˆ‘ä»¬å·²ç»ç¡®å®šï¼Œä¸¢å¼ƒæœªæ ‡è®°çš„æ•°æ®ç‚¹å¯èƒ½ä¼šå¯¼è‡´ç¾éš¾ï¼Œéœ€è¦æ›´æ™ºèƒ½çš„æ–¹æ³•ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯æ ‡è®°ä¼ æ’­ã€‚

è¯¥ç®—æ³•é€šè¿‡æ„å»ºä¸€ä¸ªå›¾æ¥å·¥ä½œï¼Œå…¶ä¸­æ•°æ®é›†çš„æ ·æœ¬æ˜¯èŠ‚ç‚¹ï¼Œæ¯å¯¹æ ·æœ¬ä¹‹é—´æœ‰ä¸€æ¡è¾¹ã€‚å¯¹äºä¸€ä¸ªæœªæ ‡è®°çš„æ ·æœ¬ï¼Œä»é‚£é‡Œå¼€å§‹éšæœºæ¸¸èµ°ï¼Œçœ‹çœ‹ä½ å¤§éƒ¨åˆ†æ—¶é—´æ˜¯åœ¨å“ªä¸ªç±»åˆ«çš„å·²æ ‡è®°æ ·æœ¬ä¸­ç»“æŸçš„ã€‚

æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥éå¸¸å¥½åœ°å·¥ä½œï¼Œç”¨ä¸€ä¸ªåªæœ‰ 10%æ ‡è®°æ•°æ®çš„ MNIST ä¾‹å­æ¥è¯æ˜ã€‚å‡†ç¡®åº¦é«˜è¾¾ 95%ï¼Œè¿™å¹¶ä¸å®Œç¾ï¼Œä½†æ¯”å¦ä¸€ç§æ–¹æ³•æ›´å¥½:æ‰‹å·¥æ ‡è®°å‰©ä½™çš„ 90%æˆ– **1617** æ ·æœ¬ã€‚

ä½†æ˜¯ç­‰ç­‰â€¦â€¦æ‰‹å·¥æ ‡æ³¨å‰©ä½™çš„æ•°æ®é›†å®é™…ä¸Šä¸æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚ä»Šå¤©æˆ‘ä»¬æ²¡æœ‰è°ˆåˆ°çš„å¦ä¸€æ¡é“è·¯æ˜¯**ä¸»åŠ¨å­¦ä¹ ã€‚**

æ— è®ºå¦‚ä½•ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªæ—¶ä»£çš„æ•…äº‹ã€‚

# å‚è€ƒ

[1]æœ±å°é‡‘å’Œé‚¹æ–ŒÂ·æ ¼æ‹‰é©¬å°¼ï¼Œ[åˆ©ç”¨æ ‡ç­¾ä¼ æ’­ä»æœ‰æ ‡ç­¾å’Œæ— æ ‡ç­¾æ•°æ®ä¸­å­¦ä¹ ](http://pages.cs.wisc.edu/~jerryzhu/pub/CMU-CALD-02-107.pdf) (2002)ï¼ŒæŠ€æœ¯æŠ¥å‘Š-CALD-02-107ï¼Œå¡è€åŸºæ¢…éš†å¤§å­¦

ã€æ›´å¤šã€‘[sci kit-learn æ ‡ç­¾ä¼ æ’­ç”¨æˆ·æŒ‡å—](https://scikit-learn.org/stable/modules/semi_supervised.html#label-propagation)

æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„ã€æœ‰ç”¨çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼

**ä½œä¸ºæœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ **

1.  **æƒ³æ”¯æŒæˆ‘å¤šå†™ç‚¹æœºå™¨å­¦ä¹ å’Œ**
2.  **æ— è®ºå¦‚ä½•éƒ½è¦è®¡åˆ’è·å¾—ä¸­ç­‰è®¢é˜…é‡ï¼Œ**

**ä¸ºä»€ä¹ˆä¸é€šè¿‡æ­¤é“¾æ¥**[](https://dr-robert-kuebler.medium.com/membership)****ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š****

***è¯´ç™½äº†ï¼Œç»™ä½ çš„ä»·æ ¼ä¸å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç›´æ¥å½’æˆ‘ã€‚***

**éå¸¸æ„Ÿè°¢ï¼Œå¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘çš„è¯ï¼**

> ***æœ‰é—®é¢˜å°±åœ¨*[*LinkedIn*](https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/)*ä¸Šå†™æˆ‘ï¼***