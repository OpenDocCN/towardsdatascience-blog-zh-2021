# ç”µå­å•†åŠ¡ä¸­çš„ RFM ç»†åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/rfm-segmentation-in-e-commerce-e0209ce8fcf6?source=collection_archive---------13----------------------->

![](img/ccb4ee13349dbff52a9d563d35e48856.png)

ç…§ç‰‡æ¥è‡ª[pixabay.com](http://pixabay.com)

## å®ç”¨çš„ RFM æ•™ç¨‹ï¼ŒåŒ…å«è¯¦ç»†çš„æ•°æ®é¢„å¤„ç†æ­¥éª¤å’Œä¸šåŠ¡æ“ä½œé¡¹

å¦‚æœä½ æ˜¯ä¸€åå¯¹æ— ç›‘ç£å­¦ä¹ çš„å•†ä¸šåº”ç”¨â€”â€”å°¤å…¶æ˜¯èšç±»â€”â€”æ„Ÿå…´è¶£çš„æ•°æ®ä»ä¸šè€…ï¼Œä½ åº”è¯¥ç†Ÿæ‚‰ RFM åˆ†å‰²ã€‚

RFM ç»†åˆ†æ˜¯ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„åŸºäºä¸‰ä¸ªç”¨æˆ·ç‰¹å¾çš„ç”¨æˆ·ç»†åˆ†ç­–ç•¥:

1.  Recency (R):ç”¨æˆ·æœ€è¿‘ä¸€æ¬¡äº¤æ˜“æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ
2.  é¢‘ç‡(F):å®¢æˆ·å¤šä¹…äº¤æ˜“ä¸€æ¬¡ï¼Ÿ
3.  è´§å¸(M):ç”¨æˆ·çš„äº¤æ˜“è§„æ¨¡æ˜¯å¤šå°‘ï¼Ÿ

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ç§æŠ€æœ¯æ¥æ›´æ·±å…¥åœ°äº†è§£æˆ‘ä»¬çš„ç”¨æˆ·ç¾¤ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿæå‡º(æ›´é‡è¦çš„æ˜¯ï¼Œå›ç­”)ä»¥ä¸‹é‡è¦é—®é¢˜:

*   æˆ‘ä»¬ä¸ºç”¨æˆ·æä¾›äº†å¤šå°‘ç§ä¸åŒçš„ RFM ç»†åˆ†å¸‚åœºï¼Ÿæ¯ä¸ªç»†åˆ†å¸‚åœºæœ‰å“ªäº›ç‹¬ç‰¹çš„é«˜çº§ç‰¹å¾ï¼Ÿ(é€šè¿‡å›ç­”è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šå¯ç”¨äºæœ€å¤§åŒ–æ¯ä¸ªç»†åˆ†å¸‚åœºæ”¶å…¥çš„ä¸šåŠ¡æ æ†)
*   æ¯ä¸ª RFM ç‰‡æ®µçš„ç™¾åˆ†æ¯”æ˜¯å¤šå°‘ï¼Ÿ(å›ç­”è¿™ä¸ªé—®é¢˜æœ‰åŠ©äºåˆ¤æ–­æœºä¼š)

é‰´äºè¿™ç§æ–¹æ³•æ˜æ˜¾çš„æ½œåœ¨å¥½å¤„ï¼Œåœ¨äº’è”ç½‘ä¸Šæœ‰å¤§é‡å…³äº RFM åˆ†å‰²çš„èµ„æºä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä¼¼ä¹æ‰¾ä¸åˆ°ä¸€ä¸ªå…³äºå¦‚ä½•åˆ›å»º RFM åˆ†å‰²çš„å¥½æ•™ç¨‹ã€‚æˆ‘çš„ç»“æœè¡¨æ˜ï¼Œæ•™ç¨‹è¦ä¹ˆ

1.  æä¾›çš„æ•°æ®é¢„å¤„ç†æªæ–½ä¸å……åˆ†ï¼Œæ— æ³•çœŸæ­£é€‚ç”¨äºçœŸå®çš„ä¸šåŠ¡ç¯å¢ƒã€‚
2.  æˆ–è€…ï¼Œæ²¡æœ‰å¯¹æ”¶é›†çš„ç»†åˆ†å¸‚åœºè¿›è¡Œé€‚å½“çš„ä¸šåŠ¡åˆ†æï¼Œå¯¼è‡´æ²¡æœ‰å¯æ“ä½œçš„æ­¥éª¤æ¥è·Ÿè¿›è¿™é¡¹å·¥ä½œ(æˆ‘è®¤ä¸ºè¿™åº”è¯¥æ˜¯æ„å»º RFM ç»†åˆ†å¸‚åœºçš„é¦–è¦ç›®æ ‡)

è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘å†³å®šå†™è¿™ç¯‡æ•™ç¨‹ã€‚å°†æ¶µç›–ä»¥ä¸‹ä¸»é¢˜:

*   å…·æœ‰ç°å®(å•†ä¸š)è€ƒè™‘çš„è¯¦ç»†æ•°æ®é¢„å¤„ç†
*   è¿›è¡Œ K-å‡å€¼èšç±»(RFM åˆ†æ®µçš„å¼•æ“)çš„æœ€ä½³å®è·µï¼ŒåŒ…æ‹¬ç‰¹å¾æ ‡å‡†åŒ–å’Œç¡®å®šæœ€ä½³ K(èšç±»/åˆ†æ®µçš„æ•°é‡)ã€‚
*   å¯¹æ”¶é›†çš„ RFM ç»†åˆ†å¸‚åœºè¿›è¡Œå®é™…åˆ†æï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿé‡‡å–é€‚å½“çš„ä¸šåŠ¡è¡ŒåŠ¨ï¼Œä»¥åŠåç»­è¡ŒåŠ¨çš„æœºä¼šå¤§å°ã€‚

è®©æˆ‘ä»¬å¼€å§‹æ—…è¡Œå§ï¼Œåˆ«å†åºŸè¯äº†ï¼

# æ•°æ®

æœ¬æ–‡ä¸­ä½¿ç”¨çš„æ•°æ®æ˜¯ä¸€ä¸ªç”µå­å•†åŠ¡æ•°æ®é›†ï¼Œå¯é€šè¿‡[è¿™ä¸ªé“¾æ¥](https://www.kaggle.com/carrie1/ecommerce-data)åœ¨ Kaggle è·å¾—ã€‚æ•°æ®é›†æ˜¯äº¤æ˜“æ•°æ®ï¼ŒåŒ…å«ä¸€å®¶è‹±å›½é›¶å”®å•†åœ¨ 2011 å¹´çš„äº¤æ˜“ã€‚

# æ•°æ®é¢„å¤„ç†

**å¯¼å…¥æ•°æ®**

æˆ‘ä»¬çš„æ—…ç¨‹ä»å¯¼å…¥æ•°æ®å¼€å§‹ã€‚

```
# import data
import pandas as pdraw_data = pd.read_csv('data.csv')
raw_data.head()
```

![](img/b9238592f3ed291d8643cab78e276b4d.png)

raw_data.head()

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®æœ‰å…«åˆ—ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨åé¢çš„ç»ƒä¹ ä¸­å°†åªä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªå­é›†ã€‚

**åŸºç¡€æ•°æ®æ¸…ç†**

åŸæ¥ï¼Œæ•°æ®åœ¨æŸäº›åˆ—ä¸ŠåŒ…å«ç©ºè¡Œï¼Œä»¥åŠé‡å¤çš„è¡Œã€‚åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬æƒ³æ‘†è„±ä»–ä»¬ã€‚

```
# check NA/NULL
raw_data.isna().sum()
```

![](img/39da4af6453cc476e2029f8240c4ab50.png)

æˆ‘ä»¬ç¡®å®åœ¨ä¸€äº›åˆ—ä¸Šæœ‰ç©ºè¡Œ

```
# remove NULL
raw_data = raw_data.dropna(axis = 0, how = 'any')# check duplicates
raw_data.duplicated().sum() # 5225 duplicated rows detected# drop duplicates
raw_data = raw_data.drop_duplicates(ignore_index = True)
```

**ç‰¹å¾å·¥ç¨‹**

è¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬å¼€å§‹å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºå…·æœ‰é€‚å½“æ ¼å¼çš„æ•°æ®ï¼Œä»¥ä¾›å³å°†åˆ°æ¥çš„èšç±»ç®—æ³•ä½¿ç”¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†é‡‡å–ä»¥ä¸‹æªæ–½:

1.  å°†`InvoiceDate`åˆ—è½¬æ¢ä¸ºæ–¹ä¾¿çš„æ—¥æœŸæ—¶é—´æ ¼å¼
2.  é€šè¿‡å°†`Quantity`å’Œ`Unitprice`ç›¸ä¹˜æ¥åˆ›å»º`trx_amount`åˆ—
3.  å°†`CustomerID`åˆ—è½¬æ¢ä¸ºæ•´æ•°æ ¼å¼

```
# convert datetime column format
raw_data.InvoiceDate = pd.to_datetime(raw_data.InvoiceDate)# create trx_amount col
raw_data['TrxAmount'] = raw_data.Quantity * raw_data.UnitPrice# include only positive TrxAmount values(exclude credit)
raw_data = raw_data[raw_data['TrxAmount'] > 0]# cast CustomerID column to integer
raw_data.CustomerID = raw_data.CustomerID.astype('int')
```

æœ‰äº†ä»ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­è·å¾—çš„æœ€æ–°çš„`raw_data`æ•°æ®å¸§æ ¼å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸º RFM åˆ†å‰²æ„å»ºä¸€ä¸ªæ–°çš„æ•°æ®å¸§äº†ã€‚dataframe çš„å…³é”®å­—æ˜¯`CustomerID`ï¼Œæœ‰ä¸‰åˆ—ç‰¹æ€§:æœ€è¿‘ã€é¢‘ç‡å’Œè´§å¸ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬è®¨è®ºç¬¬ä¸€ä¸ªç‰¹æ€§:æœ€è¿‘æ€§ï¼Œæˆ‘è®¤ä¸ºå°±æ‰€éœ€çš„é¢„å¤„ç†è€Œè¨€ï¼Œè¿™æ˜¯ä¸‰ä¸ªç‰¹æ€§ä¸­æœ€å¤æ‚çš„ã€‚æˆ‘ä»¬å°†ä»ä¸‹é¢çš„ä»£ç å¼€å§‹ã€‚

```
# recency (r) df
data_r = raw_data[['InvoiceDate','CustomerID']].groupby('CustomerID')['InvoiceDate'].agg('max').reset_index()data_r.head()
```

![](img/02e3158cdf6ff42203b03911b996199a.png)

åˆå§‹æœ€è¿‘æ•°æ®å¸§:data_r.head()

æˆ‘ä»¬å°†ç”¨æˆ·æœ€è¿‘åº¦å®šä¹‰ä¸ºè‡ªä»ç”¨æˆ·è¿›è¡Œæœ€åä¸€æ¬¡äº¤æ˜“å·²ç»è¿‡å»äº†å¤šé•¿æ—¶é—´(ä»¥æœˆä¸ºå•ä½)ã€‚åœ¨è¿™ç‚¹ä¸Šï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç¡®å®šæˆ‘ä»¬ç”¨äºå‘åè®¡ç®—æœˆä»½çš„å½“å‰æ—¶é—´å‚è€ƒ:æˆ‘ä»¬å°†å®ƒè®¾ç½®ä¸º`InvoiceData`åˆ—çš„æœ€è¿‘å€¼ã€‚

```
# current time reference
cur_time = data_r.InvoiceDate.max()# month diff function
def month_diff(cur_time, datetime_val): 
    return 12 * (cur_time.year - datetime_val.year) + (cur_time.month - datetime_val.month)# recency month
data_r['Recency'] = data_r.InvoiceDate.apply(lambda datetime_val: month_diff(cur_time, datetime_val))
```

å…¶æ¬¡ï¼Œå¦‚æœå®¢æˆ·æœ€è¿‘ä¸€æ¬¡äº¤æ˜“å‘ç”Ÿåœ¨ 6 ä¸ªæœˆæˆ–æ›´ä¹…ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šè®¤ä¸ºä»–/å¥¹ç»å¯¹æ˜¯è¢«æ¿€æ€’äº†ï¼Œå› æ­¤ï¼Œå¦‚æœäº¤æ˜“æ—¶é—´è¶…è¿‡ 6 ä¸ªæœˆï¼Œæˆ‘ä»¬å°±æ²¡æœ‰å…´è¶£å¯¹æœ€è¿‘äº¤æ˜“å€¼è¿›è¡Œç¼–ç ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†æ‹¥æœ‰æœ‰æ„ä¹‰çš„é¢å¤–ä¿¡æ¯ã€‚æ¢å¥è¯è¯´ï¼Œæœ€è¿‘å€¼å¿…é¡»é™åˆ¶åœ¨æœ€é•¿ 6 ä¸ªæœˆã€‚

```
# clip max at 6 months backward
data_r.Recency = data_r.Recency.clip(lower = None, upper = 6)# drop InvoiceDate column
data_r = data_r.drop('InvoiceDate', axis = 1)# head
data_r.head()
```

![](img/e4ade73e986b1ea56238be72bfdeb14a.png)

å·²å¤„ç†çš„æœ€è¿‘æ•°æ®å¸§:data_r.head()

æˆ‘ä»¬ç»“æŸäº†æœ€è¿‘çš„äº‹ã€‚ç°åœ¨æˆ‘ä»¬å°†åˆ›å»ºé¢‘ç‡å’Œè´§å¸ç‰¹å¾ã€‚å› ä¸ºæˆ‘ä»¬åªæƒ³è¦æœ€æœ‰æ„ä¹‰(éè¿‡æ—¶)çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨æ„å»ºé¢‘ç‡å’Œè´§å¸ç‰¹å¾æ—¶ï¼Œæˆ‘ä»¬åªè€ƒè™‘è¿‡å» 6 ä¸ªæœˆçš„äº¤æ˜“:

*   é¢‘ç‡:ç”¨æˆ·åœ¨å‰å…­ä¸ªæœˆå®Œæˆçš„äº¤æ˜“æ¬¡æ•°ã€‚
*   è´§å¸:ç”¨æˆ·åœ¨è¿‡å»å…­ä¸ªæœˆçš„å¹³å‡äº¤æ˜“è§„æ¨¡

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»è®¡ç®—çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ªæ—¶é—´æ®µçº¦æŸä¹Ÿæ˜¯æœ‰åˆ©çš„ã€‚å‡è®¾ä½ åœ¨äºšé©¬é€Šå·¥ä½œï¼Œåˆ›å»º RFM ç»†åˆ†å¸‚åœºã€‚å¦‚æœæ‚¨ä¸é™åˆ¶æ—¶é—´çª—å£ï¼Œæ‚¨å°†æœ€ç»ˆä½¿ç”¨ä»–ä»¬è¶…è¿‡äºŒåå¹´çš„äº‹åŠ¡æ—¥å¿—æ•°æ®(è¿™åœ¨å¤§å°ä¸Šå¯èƒ½å¤ªå¤§äº†)ã€‚

```
# frequency & monetary(fm) df only w.r.t. last 6 months data
EARLIEST_DATE = pd.to_datetime('2011-06-09')
data_fm = raw_data[raw_data.InvoiceDate >= EARLIEST_DATE]
data_fm = data_fm[['InvoiceNo','CustomerID','TrxAmount']]data_fm = data_fm.groupby('CustomerID')[['InvoiceNo','TrxAmount']].agg({'InvoiceNo':'nunique', 'TrxAmount':'mean'}).reset_index()
data_fm = data_fm.rename(columns = {'InvoiceNo':'Frequency', 'TrxAmount':'Monetary'})
data_fm.Monetary = data_fm.Monetary.round(2)
data_fm.head()
```

![](img/ef181c828fa33b81df2465159de4a45a.png)

é¢‘ç‡-è´§å¸æ•°æ®æ¡†æ¶:data_fm.head()

æœ€åï¼Œæˆ‘ä»¬å°†è¿‘æœŸæ•°æ®æ¡†æ¶(`data_r`)ä¸é¢‘ç‡&è´§å¸æ•°æ®æ¡†æ¶(`data_fm`)ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°æˆ‘ä»¬çš„æœ€ç»ˆæ•°æ®ï¼

```
# join to have the final data df
data = data_r.merge(data_fm, on = 'CustomerID', how = 'left')
data = data.fillna(0)
data.head()
```

![](img/d23f967ad324a69fea0b2c15ecf19633.png)

æœ€ç»ˆæ•°æ®:data.head()

# åŸºäº K å‡å€¼èšç±»çš„ RFM åˆ†å‰²

**æ ‡å‡†åŒ–æ ç›®**

è¿™ä¸€æ­¥åœ¨å¾ˆå¤šæ•™ç¨‹ä¸­ç»å¸¸è¢«è·³è¿‡ã€‚ç„¶è€Œï¼Œæœ€ä½³å®è·µæ˜¯æ ‡å‡†åŒ– R-F-M ç‰¹å¾ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºè´§å¸å‡½æ•°å…·æœ‰è´§å¸çš„åº¦é‡ï¼Œè¿™æ„å‘³ç€æ ‡åº¦ä¸å…¶ä»–ç‰¹å¾æœ‰å¾ˆå¤§ä¸åŒã€‚é€šè¿‡å°†å…¶æ ‡å‡†åŒ–ï¼Œæˆ‘ä»¬ç¡®ä¿ K-means ç®—æ³•ä¸ä¼šé«˜ä¼°è¿™ä¸ªè´§å¸å‡½æ•°(å³ï¼Œå°†å®ƒè§†ä¸ºæ¯”å…¶ä»–ç‰¹å¾æ›´é‡è¦çš„ç‰¹å¾)ã€‚

```
from sklearn.preprocessing import StandardScaler# feature columns
feature_cols = ['Recency','Frequency','Monetary']# standardized df for training
standardized_data = data.copy()# standardization
scaler = StandardScaler()
scaler.fit(data[feature_cols])
standardized_features = scaler.transform(data[feature_cols])
standardized_data[feature_cols] = standardized_features
```

**è‚˜æ³•**

å¦‚ä½ æ‰€çŸ¥ï¼ŒK-means ç®—æ³•ä¸­çš„ K(èšç±»æ•°)æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æå‰ä»”ç»†é€‰æ‹©å®ƒã€‚è‚˜æ³•æ˜¯æœ€ä½³é€‰æ‹© K çš„ä¸€ç§å¸¸ç”¨æ–¹æ³•:æˆ‘ä»¬ç»˜åˆ¶å„ç§ K å€¼çš„è¯¯å·®å¹³æ–¹å’Œ(SSE ),å¹¶é€‰æ‹© SSE ä¸‹é™æ–œç‡åœ¨è¯¥å€¼å‰åæ˜¾è‘—å˜åŒ–çš„ K å€¼ã€‚

å¯¹äºé‚£äº›ä¸ç†Ÿæ‚‰ SSE çš„äººæ¥è¯´ï¼Œæœ¯è¯­â€œè¯¯å·®â€æŒ‡çš„æ˜¯æ•°æ®ç‚¹ä¸å…¶è´¨å¿ƒä¹‹é—´çš„åå·®/è·ç¦»ã€‚å› æ­¤ SSE æ˜¯æ‰€æœ‰æ•°æ®ç‚¹çš„è¿™ç§å¹³æ–¹è¯¯å·®çš„æ•°é‡ã€‚åŒæ ·å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒSSE å€¼æ€»æ˜¯éšç€ K çš„å¢åŠ è€Œå‡å°ã€‚

ä¸ºäº†ç»§ç»­ï¼Œæˆ‘ä»¬ç”¨åä¸ªä¸åŒçš„ K(1ï¼Œ2ï¼Œâ€¦ï¼Œ10)æ‹Ÿåˆ K-means ç®—æ³•åæ¬¡ï¼Œå¹¶ä¿å­˜æ¯ä¸ªæ”¶æ•›æ¨¡å‹çš„ SSE(æ³¨æ„ SSE å­˜å‚¨åœ¨`inertia_`å±æ€§ä¸­)ã€‚

```
# fit K-means clustering on various Ks
from sklearn.cluster import KMeanskmeans_kwargs = {
    "init" : "random",
    "n_init" : 10
}sse = []
for k in range(1,11):
    kmeans = KMeans(n_clusters=k, **kmeans_kwargs)
    kmeans.fit(standardized_data[feature_cols])
    sse.append(kmeans.inertia_)
```

è®©æˆ‘ä»¬æŠŠè‚˜æ³•å½¢è±¡åŒ–ï¼

```
# Elbow method plot
import matplotlib.pyplot as pltplt.figure(figsize = (12,8))
plt.plot(range(1,11), sse)
plt.xticks(range(1,11))
plt.xlabel("Number of Clusters")
plt.ylabel("Sum of Squared Error")
plt.show()
```

![](img/adc0f0376e0458dcabe7ac65771efc0d.png)

ä¸åŒæ•°é‡èšç±»çš„è¯¯å·®å¹³æ–¹å’Œ

çœ‹ä¸Šé¢çš„å›¾ï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬å¯ä»¥é€‰æ‹© K= 3:è§‚å¯Ÿåœ¨è¿™ä¸ªç‰¹å®šçš„ K å€¼ä¹‹å‰å’Œä¹‹åæ–œç‡çš„å·¨å¤§å·®å¼‚ã€‚

**æ‹Ÿåˆ K-è¡¨ç¤ºä½¿ç”¨æœ€ä¼˜ K**

åœ¨çŸ¥é“æœ€ä½³ K æ˜¯ 3 ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ª K å€¼å†æ¬¡æ‹Ÿåˆç®—æ³•ã€‚

```
kmeans_kwargs = {
    "init" : "random",
    "n_init" : 10
}# run kmeans with the optimal k
kmeans = KMeans(n_clusters=3, **kmeans_kwargs)
kmeans.fit(standardized_data[feature_cols])
data['cluster'] = kmeans.labels_
data.head()
```

![](img/9906fb4333aba66ab730308e68f5091d.png)

å…·æœ‰ä» K-means ç®—æ³•è·å¾—çš„èšç±»æ•°çš„æ•°æ®

# ç»“æœåˆ†æ

æˆ‘ä»¬çš„å·¥ä½œè¿˜æ²¡æœ‰ç»“æŸã€‚æˆ‘ä»¬å¿…é¡»åœ¨ç¾¤é›†è¢«æ”¶é›†åå¯¹å…¶è¿›è¡Œè§£é‡Šã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ˜¾ç¤º R-F-M å½¢å¿ƒå€¼ä»¥åŠæ¯ä¸ªé›†ç¾¤ä¸­çš„ç”¨æˆ·æ•°é‡æ¥æ€»ç»“æ‰€è·å¾—çš„é›†ç¾¤ã€‚

ä¸ºä»€ä¹ˆæ˜¯è´¨å¿ƒå€¼ï¼Ÿå› ä¸ºæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™äº›å€¼æ˜¯æ¯ä¸ªè·å¾—çš„èšç±»çš„ä»£è¡¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å€¼ä»ç›¸åº”çš„ç”¨æˆ·æ–¹é¢(R/F/M)æ¥è§£é‡Šå±äºç‰¹å®šé›†ç¾¤çš„ç”¨æˆ·çš„æ•´ä½“è¡Œä¸º/ç‰¹å¾ã€‚

```
# look at the centroids per cluster
centroid_df = data.groupby('cluster')[['Recency', 'Frequency', 'Monetary','CustomerID']].agg({'Recency': 'mean', 'Frequency': 'mean', 'Monetary':'mean','CustomerID':'nunique'}).reset_index()
centroid_df = centroid_df.rename(columns = {'CustomerID':'NumBuyers'})
centroid_df
```

![](img/7389ef8d9b5a947c973be3477d99d68e.png)

è·å¾—çš„èšç±»:è´¨å¿ƒç»†èŠ‚å’Œèšç±»å¤§å°

æ ¹æ®ä¸Šè¡¨ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªç”¨æˆ·ç¾¤/ç»†åˆ†å¸‚åœº:

1.  **é›†ç¾¤ 0:æˆ‘ä»¬çš„é¡¶çº§ç”¨æˆ·ç¾¤ã€‚**æ­¤ç±»åˆ«çš„ç”¨æˆ·æ˜¯æœ€è¿‘/å½“å‰çš„å®šæœŸè´­ä¹°è€…(æœ€è¿‘è´­ä¹°ç‡ä½ï¼Œé¢‘ç‡é«˜)ã€‚ä»–ä»¬æœ€è¿‘çš„ä¸€æ¬¡äº¤æ˜“ä¹Ÿå°±åœ¨å‡ å¤©å‰ï¼Œä¹‹å‰åŠå¹´çš„äº¤æ˜“é¢‘ç‡æ˜¯ 26 æ¬¡ã€‚ä¸å¹¸çš„æ˜¯ï¼Œä»–ä»¬ä¸ºæ•°ä¸å¤š(66 ä¸ªç”¨æˆ·ï¼Œç›¸å½“äºæ‰€æœ‰ç”¨æˆ·ç¾¤çš„ 1.5%)ã€‚
2.  ç¬¬ä¸€ç±»:æˆ‘ä»¬è¢«æ…åŠ¨çš„ç”¨æˆ·ç¾¤ã€‚è¿™ä¸€ç±»åˆ«çš„ç”¨æˆ·æ˜¯æˆ‘ä»¬é€‰æ‹©é€€å‡ºçš„å®¢æˆ·(æœ€è¿‘ç‡é«˜*ã€æ³¨æ„è¿™æ˜¯ä¸€ä»¶åäº‹ã€‘*ï¼Œé¢‘ç‡ä½)ã€‚ä»–ä»¬ä¸Šä¸€æ¬¡äº¤æ˜“æ˜¯äº”ä¸ªå¤šæœˆå‰ï¼Œä¹‹å‰åŠå¹´åªæœ‰ 0 æˆ– 1 æ¬¡äº¤æ˜“ï¼ä¸å¹¸çš„æ˜¯ï¼Œä»–ä»¬ä¹Ÿå¾ˆå¤š(1364 ä¸ªç”¨æˆ·ï¼Œç›¸å½“äºæ‰€æœ‰ç”¨æˆ·ç¾¤çš„ 31.5%)ã€‚
3.  **é›†ç¾¤ 2:æˆ‘ä»¬çš„ä¼‘é—²ç”¨æˆ·ç¾¤ã€‚**è¿™ä¸€ç±»åˆ«çš„ç”¨æˆ·æ˜¯æˆ‘ä»¬çš„å¸¸å®¢(æ— è®ºæ˜¯æœ€è¿‘çš„è¿˜æ˜¯é¢‘ç¹çš„)ã€‚ä»–ä»¬æœ€è¿‘çš„äº¤æ˜“å‘ç”Ÿåœ¨æœ€è¿‘ä¸¤ä¸ªæœˆå†…ï¼Œåœ¨ä¹‹å‰çš„å…­ä¸ªæœˆå†…äº¤æ˜“é¢‘ç‡é«˜è¾¾ä¸‰æ¬¡ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œä»–ä»¬æ˜¯æˆ‘ä»¬ç”¨æˆ·ç¾¤ä¸­æœ€å¤§çš„ä¸€éƒ¨åˆ†(2908 ä¸ªç”¨æˆ·ï¼Œç›¸å½“äºæ‰€æœ‰ç”¨æˆ·ç¾¤çš„ 67%)

```
# give high-level name for each cluster
centroid_df.pop('cluster')cluster_names = ['Top Buyers','Churned Buyers','Casual Buyers']
centroid_df['ClusterName'] = cluster_namescentroid_df
```

![](img/1958b014d13ae42dd5fb099628974e95.png)

è·å¾—äº†å…·æœ‰é«˜çº§åç§°çš„é›†ç¾¤

**å¯æ“ä½œçš„æ­¥éª¤**

æˆ‘ä»¬å°†æ ¹æ®å¯¹ä¸Šè¿°é›†ç¾¤çš„äº†è§£ï¼Œä¸ºæ¯ä¸ªé›†ç¾¤åˆ›å»ºä¸€ä¸ªå®šåˆ¶çš„æ¨å¹¿ç­–ç•¥ï¼Œå¦‚ä¸‹æ‰€ç¤º:

*   é¡¶çº§ä¹°å®¶:æ²¡æœ‰å¿…è¦ç”¨ä¼˜æƒ åˆ¸/ä¿ƒé”€æ´»åŠ¨æ¥å‹å€’ä»–ä»¬(è¿™ä¸ºæˆ‘ä»¬çœé’±)ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä¼˜åŒ–/åˆ©ç”¨æŸç§å¿ è¯šåº¦ç§¯åˆ†æ¥ç•™ä½ä»–ä»¬ã€‚
*   **ä¸´æ—¶ä¹°å®¶:**æˆ‘ä»¬éœ€è¦æé«˜è¿™ä¸€ç»†åˆ†å¸‚åœºçš„é¢‘ç‡å’Œè´§å¸ä»·å€¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æä¾›è¿”ç°å½¢å¼çš„ä¼˜æƒ åˆ¸æ¥å®ç°è¿™ä¸€ç‚¹(ä»¥å®ç°é‡å¤è´­ä¹°)ï¼Œå¹¶å…·æœ‰è¾ƒé«˜çš„èµ„æ ¼é—¨æ§›(ä¾‹å¦‚ï¼Œä¼˜æƒ åˆ¸ä»…å¯¹è‡³å°‘ 50 è‹±é•‘çš„äº¤æ˜“é‡‘é¢æœ‰æ•ˆ)ã€‚
*   è¢«æ…åŠ¨çš„ä¹°å®¶:æˆ‘ä»¬çš„é¦–è¦ä»»åŠ¡æ˜¯è®©ä»–ä»¬åœ¨è¢«æ…åŠ¨ä¸€æ®µæ—¶é—´åå†æ¬¡ä¸æˆ‘ä»¬äº¤æ˜“ã€‚ä¸ºäº†é¼“åŠ±ä»–ä»¬è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸¤å¼ å¤§é¢ç¦åˆ©åˆ¸ã€‚è¿™ä¸æŒç»­ä¸æ–­çš„æ¨é€é€šçŸ¥å¯†åˆ‡ç›¸å…³ã€‚

# æ€»ç»“å’Œç»“è®º

ç¥è´ºä½ è¯»åˆ°è¿™é‡Œï¼ğŸ‘

åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€æ­¥ä¸€æ­¥çš„ Python æ•™ç¨‹ï¼Œä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼åœ¨ç”µå­å•†åŠ¡ç¯å¢ƒä¸­æ‰§è¡Œäº† RFM åˆ†å‰²ï¼æˆ‘ä»¬é¦–å…ˆæ‰§è¡Œå½»åº•çš„æ•°æ®é¢„å¤„ç†ï¼Œç„¶åé€‚å½“åœ°æ‹Ÿåˆ K-means ç®—æ³•(ç»“åˆç‰¹å¾æ ‡å‡†åŒ–å’Œè‚˜æ–¹æ³•)ã€‚æœ€åï¼Œæˆ‘ä»¬è§£é‡Šäº†ç”±æ­¤äº§ç”Ÿçš„ç»†åˆ†å¸‚åœºï¼Œä»¥ä¾¿ä¸ºæ¯ä¸ªç»†åˆ†å¸‚åœºåˆ¶å®šä¸ªæ€§åŒ–çš„æ¨å¹¿è®¡åˆ’ã€‚

å•Šï¼Œå¯¹äº†ï¼Œå¯¹äºé‚£äº›å–œæ¬¢ GitHub ç•Œé¢çš„äººæ¥è¯´ï¼Œå®Œæ•´çš„ç¬”è®°æœ¬å¯ä»¥åœ¨æˆ‘çš„ GitHub repo [è¿™é‡Œ](https://github.com/pararawendy/RFM-in-ecommerce)æ‰¾åˆ°ã€‚

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ å³å°†åˆ°æ¥çš„ RFM ç»†åˆ†é¡¹ç›®/ä»»åŠ¡æœ‰æ‰€å¸®åŠ©ï¼æ€»è€Œè¨€ä¹‹ï¼Œæ„Ÿè°¢é˜…è¯»ï¼Œå¤§å®¶åœ¨ [LinkedIn](https://www.linkedin.com/in/pararawendy-indarjo/) ä¸Šå’Œæˆ‘è¿çº¿å§ï¼ğŸ‘‹