# 用 Python 创建用于分析实时数据的可扩展机器学习系统—第 1 部分

> 原文：<https://towardsdatascience.com/creating-scalable-machine-learning-systems-for-analyzing-real-time-data-in-python-part-1-c303fbf79424?source=collection_archive---------4----------------------->

## 本系列展示了如何实时输入数据、分析数据并将响应发送回感兴趣的受众。

最近，人们对用于分析实时数据并将结果实时发送给感兴趣的群体的可扩展机器学习(ML)系统产生了浓厚的兴趣。越来越多的企业热衷于为其业务部署实时预测或分析，这不仅是为了与众不同，也是为了在当今竞争激烈的**和快节奏的市场中提高整体绩效、客户体验和保留率。**

**从股票交易到使用天气数据预测航班延误，动物和人类的实时行为分析，或者构建客户支持聊天机器人，有不同的实时问题和不同的解决方法-数据分类和聚类，实时训练 ML 模型和反馈循环以在发生时进行完善，实时决策树，以及许多这样的不断发展的算法。**

**几年前，跟踪这些算法、验证、实施、测试、改进和循环使用是一个非常困难的问题。但是，因为像 [TensorFlow](https://tenserflow.org/) 、 [PyTorch](https://pytorch.org/) 、 [NumPy](https://numpy.org/) 、 [Scikit](https://scikit-learn.org/) 这样的机器学习和科学计算工具的兴起，这些任务都变得‘琐碎’了。此外，所有这些工具都支持 Python 或基于 Python，因此 Python 是解决这些问题的最合适的选择。**

**虽然分析部分由这些工具负责，但添加实时通信和实现接近零的延迟也有其自身的挑战——排队、有时限的保证交付和确认、离线交付等。幸运的是，我们有另一个 python 库来拯救我们，[mes ibo](https://pypi.org/project/mesibo/)——它使解决方案变得完整，完全用 Python 编写。**

**在本文中，我们将学习如何用 Python 开发可扩展的机器学习系统来分析实时数据，这将带来无限的可能性；处理实时股票市场或地理传感器只是一些随机的例子。如果您是 Python 开发人员，您会发现这篇文章是一个很好的起点。**

**为了分析任何数据，我们首先需要访问数据。因此，在第一部分中，我们将描述如何向 Python 应用程序添加实时通信，如何实时输入源数据并发送输出。然后，我们将在第二部分描述将整个实时平台下载到您的服务器，与您的数据库进行交互，以及添加 Tensorflow 和其他工具。**

# **实时与传统数据处理**

**在我们使用 [mesibo](https://pypi.org/project/mesibo/) 实时库之前，有必要快速了解一下实时和传统数据处理之间的区别。传统的和当今最主要的数据处理模型基于请求-响应模型，通常称为 REST，被超过 90%的应用程序使用。尽管 REST 对于静态或缓慢变化的数据非常优秀，但它不适合实时数据。实时数据处理应用程序保持实时连接，以零延迟方式发送和接收数据。如果您使用过传统的基于 REST 的 API，您可能会发现实时 API 略有不同，如下所述。**

# **使用 mesibo 实时 Python 库**

**让我们从在 Python 应用程序中添加实时通信开始。首先，您需要使用`pip`命令从 Python 包索引中下载 [mesibo](https://pypi.org/project/mesibo/) 库。或者，您也可以从 [mesibo Python 库](https://github.com/mesibo/python/)下载库源代码。Mesibo python 库支持所有 Linux 发行版、Mac OS，甚至 Raspberry Pi，因此您可以在几乎所有开发人员友好的平台上下载它。**

```
**pip3 install mesibo**
```

**一旦安装了 mesibo，就可以将 mesibo 导入到 Python 脚本中，如下所示**

**将 mesibo 导入 Python 脚本**

**mesibo 有一套定义非常好的 API。它有各种发送实时数据的函数和一个回调接口，一旦接收到实时传入数据就调用该接口。下面的脚本是一个简单的 mesibo 回调示例，当接收到一个实时消息(`Mesibo_OnMessage`)或者当一个实时消息被发送、传递、读取等时，就会调用这个示例。(`Mesibo_OnMessageStatus`)。还有更多回调函数，但为了简单起见，这里省略了。**

**但是，mesibo 不知道您的侦听器类，因此您应该首先向 mesibo 注册它，以便它可以在需要时调用您的侦听器类函数。您可以将它作为初始化的一部分，如下所示(细节将在后面解释)。**

**梅西博初始化**

**上面的代码不言自明。**

1.  **它创建了一个 mesibo API 的实例。**
2.  **通过调用函数`*addListener*()`，用我们的监听器初始化 mesibo。**
3.  **通过调用函数`*setAccessToken*()`初始化 API 凭证，这将在下一节中解释。**
4.  **通过调用函数`*setDatabase*()`设置数据库以存储收到的消息**
5.  **启动 mesibo，通过调用函数`*start*()`开始发送和接收实时消息**

**一旦你启动了 mesibo，你不需要做任何事情就可以获得你的实时数据或消息。 ***您不会像使用 REST API***时那样轮询或持续检查新消息。相反，一旦接收到新的实时数据，mesibo 将自动调用监听器函数，没有任何延迟。**

**但是，您的脚本如何知道谁发送了您刚刚收到的数据，或者如何将数据发送到特定的目的地或组？这就带来了实时端点的概念。**

# **实时端点和地址**

**当你给你的朋友发电子邮件时，你使用他们的电子邮件地址。同样，当你的朋友收到一封电子邮件时，他们知道这是你发来的，因为邮件中包含了你的电子邮件地址。类似地，在实时系统中，每个端点都有一个地址。端点可以是任何东西，您的 Python 脚本、聊天用户或群组。在 mesibo 中，地址可以是任何唯一的字符串，无论是电子邮件地址、电话号码还是任何随机的唯一字符串。**

****创建端点
然后，端点使用这些地址相互进行实时通信。当您创建一个端点时，mesibo 会生成一个令牌，您可以在`*setAccessToken*()`中初始化时使用这个令牌。****

**例如，您可以通过调用 mesibo 后端 API 创建一个地址为`123`的端点，**

**curl 请求调用 mesibo 后端 API**

**上面请求中的`token`是 mesibo API 密钥(也称为 App token)。强烈建议您阅读 [mesibo 教程](https://mesibo.com/documentation/tutorials/get-started/)以了解如何将 mesibo 后端 API 与您自己的 App token 一起使用。**

**上面的 API 将返回一个 JSON 响应，**

**来自 mesibo 后端 API 的 JSON 响应**

**然后，您可以在 Python `*setAccessToken*()` API 中使用上述响应中返回的用户令牌。**

**在初始化 mesibo 和设置 listener 之后，您现在已经设置好了。我们现在将学习如何发送实时数据**

# **发送实时数据**

**向另一个端点发送实时数据很简单。你只需要指定地址，消息，并调用`*api.sendMessage*()`函数，**

**只要发送一条消息，接收端就会立即调用`*Mesibo_OnMessage*`功能。参考上面的清单，我们已经定义了监听器函数`*Mesibo_OnMessage*`**

**同样的，你可以给群发消息，参考[梅斯博教程](https://mesibo.com/documentation/tutorials/get-started/)了解更多关于创建群的知识。一旦您向群组发送消息，所有群组成员将立即调用`*Mesibo_OnMessage*`功能。**

# **运行和测试您的脚本**

**我们现在准备运行我们的脚本。为了方便起见，完整的脚本在这里，它是从 [mesibo Python 库](https://github.com/mesibo/python/)下载的。**

**要使用您的脚本运行和测试实时通信，如上所述创建两个端点，比如说`123`和`456`，并为每个端点生成令牌。然后创建脚本的两个副本，并替换每个端点的令牌值。此外，替换另一个端点的目的地地址，例如，如果您使用端点的令牌`123`，则在 sendMessage 中使用目的地`456`，反之亦然。**

**现在运行脚本，您将看到两者都能够向对方发送实时数据。您还会看到连接状态。一旦成功执行了脚本，就可以探索更多的 mesibo APIs 来发送各种数据。**

# **关于第二部分的结论和信息**

**在第一部分中，我们探索了如何发送和接收实时数据。对于第一部分，我们使用了 mesibo 托管的 API。在第二部分中，我们将学习如何[将整个 mesibo 平台](https://mesibo.com/documentation/on-premise)下载到您的服务器，将其与您的数据库连接，然后添加 Tensorflow。同时，我建议浏览一下 [mesibo 教程](https://mesibo.com/documentation/tutorials/get-started/)，它更详细地描述了本文中显示的步骤。你也可以尝试 mesibo 支持的其他平台(Android、iOS、Javascript、C++)，并把它们与你的 Python 脚本接口。**

**我希望您喜欢阅读第 1 部分，并且能够通过实时通信运行您的脚本。如果您有任何问题，或者您希望我在第二部分中解决一些具体的问题，请发表评论。**