# 偏差-方差误差的简单数学推导

> 原文：<https://towardsdatascience.com/simple-mathematical-derivation-of-bias-variance-error-4ab223f28791?source=collection_archive---------18----------------------->

## [思想和理论](https://towardsdatascience.com/tagged/thoughts-and-theory)

![](img/e5c70551cba9efc16b2ec4c1516a1671.png)

一个简单直观的图形，表示作为模型复杂性函数的预测(测试数据误差)误差。偏倚误差随着模型复杂度的增加而减小，而方差误差随着模型复杂度的增加而增加(图片来源于知识共享署名 4.0 国际许可条款下的书籍“ [**【临床数据科学基础】**](https://www.ncbi.nlm.nih.gov/books/NBK543527/) ”。)

# **1。简介**

统计建模、数据科学和机器学习中最重要的概念之一是 ***偏差-方差误差*** 。这个概念非常重要，因为它有助于我们理解当我们试图拟合数据来预测和做出推断时，在我们的数学建模中出现的不同错误。然而，与这个概念相关的一个问题是，通常，从事数据科学/机器学习的学生/研究人员不太清楚如何推导偏差-方差误差关系。

主要原因与以下事实有关:在大多数学习材料和课程中，很多时候偏差-方差误差(BV 误差)概念*的讲授非常肤浅*。通常，术语 ***偏差误差*** 是指由于我们选择的拟合模型函数与真实模型函数之间的差异而在我们的统计建模中出现的误差。这意味着，如果我们选择一个简单的拟合函数用于我们的统计建模，而真实的函数是更复杂的，那么我们在选择拟合函数时会引入偏差。另一方面， ***方差误差*** 被引入作为在估计对我们的建模中使用的不同样本数据集的拟合函数时的误差。这意味着，如果我们使用一个特定的数据集来拟合我们所选择的模型函数，那么如果我们使用不同的数据集，我们针对新数据集的新拟合函数可能会与之前发现的函数有很大的不同，这取决于样本数据集及其*大小*。

上面给出的偏差和方差误差的两个简单定义在某种程度上是准确的，但没有给学生/研究者一个解释，说明这些误差是如何在统计建模中出现的。在这篇文章中，我用统计理论推导了 BV 误差关系，希望能帮助你更好地理解 BV 误差。这里我假设读者了解数学分析和统计理论。事实上，本文的目的是给出一个严格的推导，同时尽量保持数学符号的简单性。

# **2。符号和定义**

让我首先介绍一些符号，这些符号在接下来的内容中会很有用。这里， ***X*** 为*因变量*或*预测器*或*特征*矩阵，*为*自变量*或*输出变量*向量。其他重要的表示法有数据集、*D*=(***X***、 ***y*** )，模型函数*f*(***X***； ***θ*** )其中 ***θ*** 是我们所选模型的参数向量。例如，在我们试图拟合线性函数的简单线性回归中，模型参数可以是最小二乘法直线的截距和斜率。下面将使用的最后一个符号是*损失函数*或*成本函数**C*(***y***，*f*(***X***； ***θ*** ))这是对观察值的模型性能的度量 ***y.*** 统计/机器学习的整个目标是*简单来说就是*以下:给定数据集*D*=(***X***， ***y* ***θ*** )。这是统计/机器学习最简洁、最简单的定义。在实践中，数据集被分为*训练*和*测试*数据，用于模型性能，但我不会详细介绍，因为我假设读者熟悉这些概念。***

*我稍后将广泛使用的另一个重要概念是通用随机变量 *X.* 的*数学期望值*或*期望值*或*T5*期望值*这里的 *X* 是通用随机变量，以免与上述特征矩阵****X .****混淆。为简单起见，这里我考虑随机变量*的情况所以，让 *X* 有 *N* 个离散值*****

![](img/5e738377b4e2538fa5eb030f45626f54.png)

那么随机变量 *X* 的期望值定义为

![](img/b8a063b3288983b0ff4614bbb3cade2e.png)

其中 *P(X=x)* 是随机变量 *X.* 的*离散概率分布函数*期望值 *E* 具有不同的性质如 *: E(X+Y) = E(X) + E(Y)，E(aX) = aE(X)，E(XY)= E(X)E(Y)*if*X*和 *Y 【T41*另一个重要的量是随机变量 *X* 的方差，定义为:Var(*X*)=*E(【X-E(X)】)*，这里通常将 *E(X)* 称为 *X* 的*均值*。如果随机变量 *X* 是连续的，那么需要用一个积分代替等式(1)中的和，用一个连续的概率分布函数代替 *P(X)* 。下面推导的 BV 关系对离散和连续定量变量都有效。

# **3。** **模型分解和成本函数**

现在假设我们有一个给定的数据集，其中生成数据的真函数*y*(***x***)由下式给出

![](img/22188f3c0f73cfd19e030e48668d42ac.png)

其中𝜖是对真函数*y*(***x***)有贡献的随机误差或随机噪声。假设误差𝜖正态分布，均值为零，标准差为𝜎，如等式(2)所示。误差变量𝜖的不同分量也被认为是不相关的。

假设我们有一个给定的数据集， *D* =( ***X*** ， ***y*** )，我们要对离散的定量输入输出变量进行典型回归。原则上，数据集 *D* 可以是任何类型的数据集，例如训练数据或测试数据的数据集，但这里我对*测试数据集*感兴趣，因为这是统计/机器学习的主要分析目标。如统计学/机器学习中常见的，需要评估代价函数*C*(***y***，*f*(***X***； ***θ*** ))对于给定的数据集*。*

成本函数取决于所使用的距离测量方法的类型，这里我将使用典型的*欧几里德距离测量(欧几里德度量)，*其中成本函数可以写成:

![](img/8bef0ab541d308e1e54cd8769d51d991.png)

统计/机器学习的主要目标是:给定一个固定的数据集，找到使成本函数 *C* 或等价的 *:* 最小的参数向量 ***θ***

![](img/377b076a4b6107c4389a932359702cf0.png)

例如，如果使用不同的数据集，成本函数*C*(***y***，*f*(***X***； ***θ*** ))会不同，并且最小化成本函数的参数向量 ***θ*** 也会不同 ***。因此，需要记住的一件重要事情是，成本函数和参数向量值取决于数据集。***

假设现在我们已经从*训练数据集*中“学习”了参数向量 ***θ*** ，并且想要为*测试数据集* ***计算成本函数。*** 在这种情况下，通过使用等式(3)中的一般定义，*测试数据集*的成本函数由下式给出

![](img/ff6f2435519c4d322300901a70bf3c43.png)

可以观察到，在等式(4)中，*测试数据集*的成本函数明确地依赖于先前学习的参数向量***【θ***，其中下标 *D* 。

如果你已经注意到了所有的定义和等式(4 ),那么我必须祝贺你的耐心和毅力。然而，还有更多的要补充，因为我还没有得到 BV 误差表达式，所以，请耐心等待，继续跟进。

# **4。偏差-方差误差推导**

为了得出 BV 误差，我必须注意它取决于特定的测试数据集和随机误差 *𝜖* 实例*。*记住这些信息，现在我计算(4)中的*测试成本函数*的*期望值* *E(C)* ，用于*可能从总体和不同错误实例*中采样的不同可能测试数据集。在这种情况下，(4)中的成本函数是随机变量，因为它隐含地依赖于本身是随机变量的误差 *𝜖* (由于(2)中的分解)。通过在等式(2)中使用等式(4)，我得到:

![](img/e71f6eff7f0052ddf82fa06163bfb3ee.png)

作者出于教育目的明确进行的计算。

现在让我解释等式(5)中每一行的含义。在第一行中，我计算了测试数据集 *D，*的成本函数的期望值，在第一个等式中，我明确地写了成本函数。在第二行，在等式(5)中，我在给定的值***x*** 处加减函数*f(****x****)*，并使用等式(2)，其中我在第四个等式行中写下了**【𝜖= y-f .*，首先我扩展了二次表达式，然后我使用了之后，我仍然使用等式(2)来计算误差 *𝜖、*分量的方差和均值，其中对于随机、正态分布且不相关的误差分量*，其均值为零。*在等式(5)的最后一行，我使用了每个误差方差分量的总和给出了*【var】*【𝜖】*或者仅仅是 ***噪声*** 的事实。然而，仍然需要计算等式(5)中最后一行的最后一项。**

**如果你在方程(5)的所有步骤中设法跟随我，那么我必须再次祝贺你。现在，正如我上面提到的，仍然需要计算等式(5)中最后一行的最后一项，即:**

**![](img/adcac2fb46bf051e0155b032cdd65a96.png)**

**在上面的表达式中需要注意的一件重要事情是，我在可能的不同数据集 *D* 和错误实例 *𝜖.上取期望值*事实上，正如我在推导等式(5)时提到的，这里给出的 BV 误差的计算是最通用的，因为它考虑了不同的误差实例和不同的数据集，因此它是一个*广义 BV 误差*。现在，我可以将等式(5)中最后一行的最后一项写为:**

**![](img/53bccde4bfcc75d65e54a1449d9e7495.png)**

**作者出于教育目的明确进行的计算。**

**在等式(6)的第一行，我增加和减去了一个和等于零的项。在(6)的第二行，我展开了二次型，然后在每一项*上使用了期望值 *E* 的线性特性。*在(6)的第三行中，第一项只是一个数，它的期望值就是数本身，并且独立于 *D，*第二项依赖于 *D，*而第三项等于零，因为一般随机变量*【6】*的第四行中 *E(X-E(X))=E(X)-E(X)=0***

*现在我用等式(6)的最后一行代入等式(5)的最后一行，得到最终结果:*

*![](img/f1bda5e854a363c34414460458ae9a1a.png)*

*作者出于教育目的明确进行的计算。*

# ***5。结论和意见***

*等式(7)是我们旅程的最终表达式，其中测试数据集成本函数的期望值 *C* 等于不可约(或固有)误差*的**总方差***总方差𝜖、总偏差***总偏差*** 的平方和***总方差之和****

*既然我推导了等式(7)，有人可能会问:它意味着什么？方程式(7)的解释是什么？ ***第一点*** 要注意的是，测试数据集的输出误差总是大于不可约噪声(var(*【𝜖】)，*所以学习过程后的总噪声总是大于初始噪声*。**

****第二点*** 要注意的是(7)中偏差的定义，其中偏差考虑了在给定点的真实函数*f(****x****)**到依赖于在同一点的学习参数向量的学习函数之间的差异。如果我们善于选择学习函数的正确形式，那么它与真实模型函数的差异将是最小的并且接近于零，偏差误差也将接近于零。因此，这意味着偏差考虑了我们在选择正确的函数来建模数据时的准确性。如果我们选择一个更简单的线性函数来模拟一个给定的数据集，其中真正的函数是一个指数函数，那么我们的偏差误差将会很大，因为我们的猜测非常差。**

*****第三点*** 要注意的是(7)中所学函数的方差的定义。可以观察到，在方差的定义中，在给定点的学习函数与在同一点的学习函数的期望值之间存在差异 *D* *。*然而，期望值取决于数据集及其*大小。*因此，学习函数的方差给出了由于在我们的模型中使用不同数据集而产生的误差，并给出了学习函数与其在不同可能数据集上计算的平均值之间的差异。**

*****要注意的第四点和最后一点*** 是，等式(7)中的 BV 误差关系是通过使用测试数据集成本函数 *C 的欧几里德度量获得的。如果我使用了不同的度量，例如曼哈顿距离度量，则 BV 误差关系不一定与等式(7)中获得的相同。因此，BV 误差关系取决于用于计算距离的度量。***