# ç”¨ PyCaret ä»‹ç» Python ä¸­çš„å¼‚å¸¸æ£€æµ‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/introduction-to-anomaly-detection-in-python-with-pycaret-2fecd7144f87?source=collection_archive---------3----------------------->

## ä¸€æ­¥ä¸€æ­¥ï¼Œåˆå­¦è€…å‹å¥½çš„æ•™ç¨‹ï¼Œç”¨äºä½¿ç”¨ PyCaret çš„æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ä»»åŠ¡

![](img/9d208a38055ec93a864b82ee499c6800.png)

å¢å¡Â·æ–¯æ‹‰æ™®å°¼å¡åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

# 1.ä»‹ç»

[PyCaret](https://www.pycaret.org/) æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„å¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚è¿™æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ å’Œæ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æˆå€åœ°åŠ å¿«å®éªŒå‘¨æœŸï¼Œæé«˜æ‚¨çš„å·¥ä½œæ•ˆç‡ã€‚

ä¸å…¶ä»–å¼€æºæœºå™¨å­¦ä¹ åº“ç›¸æ¯”ï¼ŒPyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨æ¥ç”¨å‡ è¡Œä»£ç æ›¿æ¢æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå¿«é€Ÿæœ‰æ•ˆã€‚PyCaret æœ¬è´¨ä¸Šæ˜¯å‡ ä¸ªæœºå™¨å­¦ä¹ åº“å’Œæ¡†æ¶çš„ Python åŒ…è£…å™¨ï¼Œæ¯”å¦‚ scikit-learnã€XGBoostã€LightGBMã€CatBoostã€spaCyã€Optunaã€Hyperoptã€Ray ç­‰ç­‰ã€‚

PyCaret çš„è®¾è®¡å’Œç®€å•æ€§å—åˆ°äº†å…¬æ°‘æ•°æ®ç§‘å­¦å®¶è¿™ä¸€æ–°å…´è§’è‰²çš„å¯å‘ï¼Œè¿™æ˜¯ Gartner é¦–å…ˆä½¿ç”¨çš„æœ¯è¯­ã€‚å…¬æ°‘æ•°æ®ç§‘å­¦å®¶æ˜¯è¶…çº§ç”¨æˆ·ï¼Œä»–ä»¬å¯ä»¥æ‰§è¡Œç®€å•å’Œä¸­ç­‰å¤æ‚çš„åˆ†æä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡åœ¨ä»¥å‰éœ€è¦æ›´å¤šçš„æŠ€æœ¯ä¸“ä¸šçŸ¥è¯†ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹[ç½‘ç«™](https://www.pycaret.org/)æˆ–è€… [GitHub](https://www.github.com/pycaret/pycaret) ã€‚

# 2.è¾…å¯¼çš„ç›®çš„

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ :

*   **è·å–æ•°æ®:**å¦‚ä½•ä» PyCaret èµ„æºåº“å¯¼å…¥æ•°æ®ã€‚
*   **è®¾ç½®ç¯å¢ƒ:**å¦‚ä½•åœ¨ PyCaret ä¸­è®¾ç½®æ— ç›‘ç£çš„å¼‚å¸¸æ£€æµ‹å®éªŒã€‚
*   **åˆ›å»ºæ¨¡å‹:**å¦‚ä½•åˆ›å»ºæ¨¡å‹å¹¶å°†å¼‚å¸¸æ ‡ç­¾åˆ†é…ç»™æ•°æ®é›†è¿›è¡Œåˆ†æã€‚
*   **å›¾æ¨¡å‹:**å¦‚ä½•ä½¿ç”¨å„ç§å›¾åˆ†ææ¨¡å‹æ€§èƒ½ã€‚
*   **é¢„æµ‹æ¨¡å‹:**å¦‚ä½•æ ¹æ®è®­ç»ƒå¥½çš„æ¨¡å‹ç»™æ–°çš„/çœ‹ä¸è§çš„æ•°æ®é›†åˆ†é…å¼‚å¸¸æ ‡ç­¾ï¼Ÿ
*   **ä¿å­˜/åŠ è½½æ¨¡å‹:**å¦‚ä½•ä¿å­˜/åŠ è½½æ¨¡å‹ä»¥å¤‡å°†æ¥ä½¿ç”¨ï¼Ÿ

# 3.æ­£åœ¨å®‰è£… PyCaret

å®‰è£…å¾ˆå®¹æ˜“ï¼Œåªéœ€å‡ åˆ†é’Ÿã€‚PyCaret ä» pip çš„é»˜è®¤å®‰è£…åªå®‰è£…åœ¨ [requirements.txt](https://github.com/pycaret/pycaret/blob/master/requirements.txt) æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç¡¬ä¾èµ–é¡¹ã€‚

```
pip install pycaret
```

è¦å®‰è£…å®Œæ•´ç‰ˆ:

```
pip install pycaret[full]
```

# 4.ä»€ä¹ˆæ˜¯å¼‚å¸¸æ£€æµ‹ï¼Ÿ

å¼‚å¸¸æ£€æµ‹æ˜¯é€šè¿‡ä¸å¤§å¤šæ•°æ•°æ®æ˜¾è‘—ä¸åŒæ¥è¯†åˆ«å¼•èµ·æ€€ç–‘çš„ç½•è§é¡¹ç›®ã€äº‹ä»¶æˆ–è§‚å¯Ÿç»“æœçš„ä»»åŠ¡ã€‚é€šå¸¸ï¼Œå¼‚å¸¸é¡¹ç›®ä¼šè½¬åŒ–ä¸ºæŸç§é—®é¢˜ï¼Œå¦‚é“¶è¡Œæ¬ºè¯ˆã€ç»“æ„ç¼ºé™·ã€åŒ»ç–—é—®é¢˜æˆ–æ–‡æœ¬ä¸­çš„é”™è¯¯ã€‚å­˜åœ¨ä¸‰å¤§ç±»å¼‚å¸¸æ£€æµ‹æŠ€æœ¯:

*   **æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹:**æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æŠ€æœ¯åœ¨å‡è®¾æ•°æ®é›†ä¸­çš„å¤§å¤šæ•°å®ä¾‹æ˜¯æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å¯»æ‰¾ä¼¼ä¹æœ€ä¸é€‚åˆæ•°æ®é›†å‰©ä½™éƒ¨åˆ†çš„å®ä¾‹æ¥æ£€æµ‹æœªæ ‡è®°æµ‹è¯•æ•°æ®é›†ä¸­çš„å¼‚å¸¸ã€‚
*   **ç›‘ç£å¼‚å¸¸æ£€æµ‹:**è¿™ç§æŠ€æœ¯éœ€è¦ä¸€ä¸ªå·²ç»è¢«æ ‡è®°ä¸ºâ€œæ­£å¸¸â€å’Œâ€œå¼‚å¸¸â€çš„æ•°æ®é›†ï¼Œå¹¶ä¸”æ¶‰åŠè®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ã€‚
*   **åŠç›‘ç£å¼‚å¸¸æ£€æµ‹:**è¿™ç§æŠ€æœ¯ä»ç»™å®šçš„æ­£å¸¸è®­ç»ƒæ•°æ®é›†æ„å»ºä¸€ä¸ªä»£è¡¨æ­£å¸¸è¡Œä¸ºçš„æ¨¡å‹ï¼Œç„¶åæµ‹è¯•ç”±å­¦ä¹ çš„æ¨¡å‹ç”Ÿæˆæµ‹è¯•å®ä¾‹çš„å¯èƒ½æ€§ã€‚

# 5.PyCaret ä¸­å¼‚å¸¸æ£€æµ‹æ¨¡å—æ¦‚è¿°

[PyCaret çš„å¼‚å¸¸æ£€æµ‹æ¨¡å—](https://pycaret.readthedocs.io/en/latest/api/anomaly.html) ( `pycaret.anomaly`)æ˜¯ä¸€ä¸ªæ— ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å—ï¼Œå®ƒæ‰§è¡Œè¯†åˆ«ç½•è§é¡¹ç›®ã€äº‹ä»¶æˆ–è§‚å¯Ÿç»“æœçš„ä»»åŠ¡ï¼Œè¿™äº›é¡¹ç›®ã€äº‹ä»¶æˆ–è§‚å¯Ÿç»“æœé€šè¿‡ä¸å¤§å¤šæ•°æ•°æ®æ˜¾è‘—ä¸åŒè€Œå¼•èµ·æ€€ç–‘ã€‚

PyCaret å¼‚å¸¸æ£€æµ‹æ¨¡å—æä¾›äº†å‡ ä¸ªé¢„å¤„ç†åŠŸèƒ½ï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–è®¾ç½®æ—¶é€šè¿‡`setup`åŠŸèƒ½è¿›è¡Œé…ç½®ã€‚å®ƒæœ‰è¶…è¿‡ 12 ç§ç®—æ³•å’Œä¸€äº›å›¾è¡¨æ¥åˆ†æå¼‚å¸¸æ£€æµ‹çš„ç»“æœã€‚PyCaret çš„å¼‚å¸¸æ£€æµ‹æ¨¡å—è¿˜å®ç°äº†ä¸€ä¸ªç‹¬ç‰¹çš„åŠŸèƒ½`tune_model`ï¼Œå…è®¸æ‚¨è°ƒæ•´å¼‚å¸¸æ£€æµ‹æ¨¡å‹çš„è¶…å‚æ•°ï¼Œä»¥ä¼˜åŒ–ç›‘ç£å­¦ä¹ ç›®æ ‡ï¼Œä¾‹å¦‚ç”¨äºåˆ†ç±»çš„`AUC`æˆ–ç”¨äºå›å½’çš„`R2`ã€‚

# 6.æ•™ç¨‹çš„æ•°æ®é›†

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª UCI çš„åä¸º [**å°é¼ è›‹ç™½è´¨è¡¨è¾¾**](https://archive-beta.ics.uci.edu/ml/datasets/mice+protein+expression) çš„æ•°æ®é›†ã€‚æ•°æ®é›†ç”± 77 ç§è›‹ç™½è´¨çš„è¡¨è¾¾æ°´å¹³ç»„æˆï¼Œè¿™äº›è›‹ç™½è´¨åœ¨çš®è´¨çš„ç»†èƒæ ¸éƒ¨åˆ†äº§ç”Ÿå¯æ£€æµ‹çš„ä¿¡å·ã€‚è¯¥æ•°æ®é›†åŒ…å«æ¯ç§è›‹ç™½è´¨æ€»å…± 1080 æ¬¡æµ‹é‡ã€‚æ¯æ¬¡æµ‹é‡å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ ·æœ¬(é¼ æ ‡)ã€‚

## æ•°æ®é›†å¼•ç”¨:

Higuera Cï¼ŒGardiner KJï¼ŒCIO KJ(2015)è‡ªç»„ç»‡ç‰¹å¾å›¾ç¡®å®šäº†å”æ°ç»¼åˆå¾å°é¼ æ¨¡å‹ä¸­å¯¹å­¦ä¹ è‡³å…³é‡è¦çš„è›‹ç™½è´¨ã€‚PLoS ONE 10(6): e0129126ã€‚[ç½‘é¡µé“¾æ¥] journal.pone.0129126

æ‚¨å¯ä»¥ä»è¿™é‡Œæ‰¾åˆ°çš„åŸå§‹æ•°æ®æº[](https://archive.ics.uci.edu/ml/datasets/Mice+Protein+Expression)**ä¸‹è½½æ•°æ®ï¼Œå¹¶ä½¿ç”¨ pandas [**(äº†è§£å¦‚ä½•ä½¿ç”¨)**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html) åŠ è½½æ•°æ®ï¼Œæˆ–è€…æ‚¨å¯ä»¥ä½¿ç”¨ PyCaret çš„æ•°æ®å­˜å‚¨åº“ä½¿ç”¨`get_data()`å‡½æ•°åŠ è½½æ•°æ®(è¿™å°†éœ€è¦äº’è”ç½‘è¿æ¥)ã€‚**

## **è®¸å¯è¯:**

**è¿™ä¸ªæ•°æ®é›†æ˜¯åœ¨[çŸ¥è¯†å…±äº«ç½²å 4.0 å›½é™…](https://creativecommons.org/licenses/by/4.0/legalcode) (CC BY 4.0)è®¸å¯ä¸‹è®¸å¯çš„ã€‚**

**è¿™å…è®¸ä¸ºä»»ä½•ç›®çš„å…±äº«å’Œæ”¹ç¼–æ•°æ®é›†ï¼Œåªè¦ç»™äºˆé€‚å½“çš„ä¿¡ä»»ã€‚([æ¥æº](https://archive-beta.ics.uci.edu/ml/datasets/mice+protein+expression))**

```
from pycaret.datasets import get_data
dataset = get_data('mice')
```

**![](img/af382c548541ef715b29b6cd93646dd4.png)**

```
**# check the shape of data**
dataset.shape
>>> (1080, 82)
```

**ä¸ºäº†æ¼”ç¤ºå¯¹çœ‹ä¸è§çš„æ•°æ®ä½¿ç”¨`predict_model`å‡½æ•°ï¼Œä»åŸå§‹æ•°æ®é›†ä¸­ä¿ç•™äº† 5% (54 æ¡è®°å½•)çš„æ ·æœ¬ï¼Œç”¨äºå®éªŒç»“æŸæ—¶çš„é¢„æµ‹ã€‚**

```
data = dataset.sample(frac=0.95, random_state=786)
data_unseen = dataset.drop(data.index)

data.reset_index(drop=True, inplace=True)
data_unseen.reset_index(drop=True, inplace=True)

print('Data for Modeling: ' + str(data.shape))
print('Unseen Data For Predictions: ' + str(data_unseen.shape))**>>> Data for Modeling: (1026, 82)
>>> Unseen Data For Predictions: (54, 82)**
```

# **7.åœ¨ PyCaret ä¸­è®¾ç½®ç¯å¢ƒ**

**PyCaret ä¸­çš„`setup`å‡½æ•°åˆå§‹åŒ–ç¯å¢ƒï¼Œå¹¶ä¸ºå»ºæ¨¡å’Œéƒ¨ç½²åˆ›å»ºè½¬æ¢ç®¡é“ã€‚åœ¨ pycaret ä¸­æ‰§è¡Œä»»ä½•å…¶ä»–å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨`setup`ã€‚å®ƒåªéœ€è¦ä¸€ä¸ªå¼ºåˆ¶å‚æ•°:ç†ŠçŒ«æ•°æ®å¸§ã€‚æ‰€æœ‰å…¶ä»–å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå¯ç”¨äºå®šåˆ¶é¢„å¤„ç†ç®¡é“ã€‚**

**å½“æ‰§è¡Œ`setup`æ—¶ï¼ŒPyCaret çš„æ¨ç†ç®—æ³•å°†æ ¹æ®æŸäº›å±æ€§è‡ªåŠ¨æ¨æ–­å‡ºæ‰€æœ‰ç‰¹å¾çš„æ•°æ®ç±»å‹ã€‚åº”è¯¥å¯ä»¥æ­£ç¡®æ¨æ–­å‡ºæ•°æ®ç±»å‹ï¼Œä½†æƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚ä¸ºäº†å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä¸€æ—¦æ‰§è¡Œäº†`setup`ï¼ŒPyCaret å°±ä¼šæ˜¾ç¤ºä¸€ä¸ªæç¤ºï¼Œè¦æ±‚ç¡®è®¤æ•°æ®ç±»å‹ã€‚å¦‚æœæ‰€æœ‰æ•°æ®ç±»å‹éƒ½æ­£ç¡®ï¼Œæ‚¨å¯ä»¥æŒ‰ enter é”®æˆ–é”®å…¥`quit`é€€å‡ºè®¾ç½®ã€‚**

**ç¡®ä¿æ•°æ®ç±»å‹æ­£ç¡®åœ¨ PyCaret ä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨æ‰§è¡Œå¤šä¸ªç‰¹å®šäºç±»å‹çš„é¢„å¤„ç†ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡å¯¹äºæœºå™¨å­¦ä¹ æ¨¡å‹æ¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ã€‚**

**æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨`setup`ä¸­çš„`numeric_features`å’Œ`categorical_features`å‚æ•°æ¥é¢„å®šä¹‰æ•°æ®ç±»å‹ã€‚**

```
from pycaret.anomaly import *

exp_ano101 = setup(data, normalize = True, 
                   ignore_features = ['MouseID'],
                   session_id = 123)
```

**![](img/d6cb777e423dce8de91ffb3621ed427a.png)**

**è¾“å‡º**

**æˆåŠŸæ‰§è¡Œè®¾ç½®åï¼Œå®ƒä¼šæ˜¾ç¤ºä¿¡æ¯ç½‘æ ¼ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›å…³äºå®éªŒçš„é‡è¦ä¿¡æ¯ã€‚å¤§éƒ¨åˆ†ä¿¡æ¯ä¸æ‰§è¡Œ`setup`æ—¶æ„å»ºçš„é¢„å¤„ç†æµæ°´çº¿æœ‰å…³ã€‚è¿™äº›ç‰¹æ€§çš„å¤§éƒ¨åˆ†è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯ï¼Œæœ‰ä¸€äº›é‡è¦çš„äº‹æƒ…éœ€è¦æ³¨æ„:**

*   ****session_id:** ä¸€ä¸ªä¼ªéšæœºæ•°ï¼Œä½œä¸ºç§å­åˆ†å¸ƒåœ¨æ‰€æœ‰å‡½æ•°ä¸­ï¼Œä»¥ä¾¿ä»¥åå†ç°ã€‚å¦‚æœæ²¡æœ‰é€šè¿‡`session_id`ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œå¹¶åˆ†é…ç»™æ‰€æœ‰å‡½æ•°ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œsession_id è¢«è®¾ç½®ä¸º`123`,ä»¥ä¾¿ä»¥åå†ç°ã€‚**
*   ****ç¼ºå¤±å€¼:**å½“åŸå§‹æ•°æ®ä¸­å­˜åœ¨ç¼ºå¤±å€¼æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸º`True`ã€‚è¯·æ³¨æ„ï¼Œä¸Šé¢ä¿¡æ¯ç½‘æ ¼ä¸­çš„`Missing Values`æ˜¯`True`ï¼Œå› ä¸ºæ•°æ®åŒ…å«ç¼ºå¤±å€¼ï¼Œå¯¹äºæ•°å­—ç‰¹å¾ä½¿ç”¨`mean`è‡ªåŠ¨ä¼°ç®—ï¼Œå¯¹äºç±»åˆ«ç‰¹å¾ä½¿ç”¨`constant`è‡ªåŠ¨ä¼°ç®—ã€‚å¯ä»¥ä½¿ç”¨`setup`ä¸­çš„`numeric_imputation`å’Œ`categorical_imputation`å‚æ•°æ”¹å˜æ’è¡¥æ–¹æ³•ã€‚**
*   ****åŸå§‹æ•°æ®:**æ˜¾ç¤ºæ•°æ®é›†çš„åŸå§‹å½¢çŠ¶ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­,( 1026ï¼Œ82)æ„å‘³ç€ 1026 ä¸ªæ ·æœ¬å’Œ 82 ä¸ªç‰¹å¾ã€‚**
*   ****è½¬æ¢æ•°æ®:**æ˜¾ç¤ºè½¬æ¢æ•°æ®é›†çš„å½¢çŠ¶ã€‚è¯·æ³¨æ„ï¼ŒåŸå§‹æ•°æ®é›†çš„å½¢çŠ¶(1026ï¼Œ82)è¢«è½¬æ¢ä¸º(1026ï¼Œ91)ã€‚ç”±äºæ•°æ®é›†ä¸­åˆ†ç±»è¦ç´ çš„ç¼–ç ï¼Œè¦ç´ çš„æ•°é‡æœ‰æ‰€å¢åŠ ã€‚**
*   ****æ•°å­—ç‰¹å¾:**æ¨æ–­ä¸ºæ•°å­—çš„ç‰¹å¾æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ82 ä¸ªè¦ç´ ä¸­æœ‰ 77 ä¸ªè¢«æ¨æ–­ä¸ºæ•°å€¼å‹ã€‚**
*   ****åˆ†ç±»ç‰¹å¾:**æ¨æ–­ä¸ºåˆ†ç±»çš„ç‰¹å¾æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ82 ä¸ªè¦ç´ ä¸­æœ‰ 5 ä¸ªè¢«æ¨æ–­ä¸ºåˆ†ç±»è¦ç´ ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨`ignore_feature`å‚æ•°å¿½ç•¥äº†ä¸€ä¸ªåˆ†ç±»ç‰¹å¾ï¼Œå³`MouseID`ã€‚**

**è¯·æ³¨æ„æ‰§è¡Œå»ºæ¨¡æ‰€å¿…éœ€çš„ä¸€äº›ä»»åŠ¡æ˜¯å¦‚ä½•è‡ªåŠ¨å¤„ç†çš„ï¼Œä¾‹å¦‚ç¼ºå¤±å€¼æ’è¡¥ã€åˆ†ç±»ç¼–ç ç­‰ã€‚`setup`åŠŸèƒ½ä¸­çš„å¤§å¤šæ•°å‚æ•°æ˜¯å¯é€‰çš„ï¼Œç”¨äºå®šåˆ¶é¢„å¤„ç†æµæ°´çº¿ã€‚è¿™äº›å‚æ•°è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯æˆ‘å°†åœ¨åé¢å†™æ›´å¤šå…³äºå®ƒä»¬çš„å†…å®¹ã€‚**

# **8.åˆ›å»ºæ¨¡å‹**

**åœ¨ PyCaret ä¸­åˆ›å»ºå¼‚å¸¸æ£€æµ‹æ¨¡å‹å¾ˆç®€å•ï¼Œä¸åœ¨ PyCaret çš„ç›‘ç£æ¨¡å—ä¸­åˆ›å»ºæ¨¡å‹çš„æ–¹å¼ç±»ä¼¼ã€‚ä½¿ç”¨`create_model`å‡½æ•°åˆ›å»ºå¼‚å¸¸æ£€æµ‹æ¨¡å‹ï¼Œè¯¥å‡½æ•°é‡‡ç”¨ä¸€ä¸ªå¼ºåˆ¶å‚æ•°ï¼Œå³æ¨¡å‹åç§°ä½œä¸ºå­—ç¬¦ä¸²ã€‚è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªè®­ç»ƒå¥½çš„æ¨¡å‹å¯¹è±¡ã€‚è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹:**

```
iforest = create_model('iforest')
print(iforest)**>>> OUTPUT** IForest(behaviour='new', bootstrap=False, contamination=0.05, max_features=1.0, max_samples='auto', n_estimators=100, n_jobs=-1, random_state=123, verbose=0)
```

**æˆ‘ä»¬å·²ç»ä½¿ç”¨`create_model`åˆ›å»ºäº†ä¸€ä¸ªéš”ç¦»æ£®æ—æ¨¡å‹ã€‚è¯·æ³¨æ„ï¼Œ`contamination`å‚æ•°è¢«è®¾ç½®ä¸º`0.05`ï¼Œå½“æ‚¨æ²¡æœ‰ä¼ é€’`fraction`å‚æ•°æ—¶ï¼Œè¿™æ˜¯é»˜è®¤å€¼ã€‚`fraction`å‚æ•°å†³å®šäº†æ•°æ®é›†ä¸­ç¦»ç¾¤å€¼çš„æ¯”ä¾‹ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ç”¨`0.025`éƒ¨åˆ†åˆ›å»º`One Class Support Vector Machine`æ¨¡å‹ã€‚**

```
svm = create_model('svm', fraction = 0.025)
print(svm)**>>> OUTPUT** OCSVM(cache_size=200, coef0=0.0, contamination=0.025, degree=3, gamma='auto',kernel='rbf', max_iter=-1, nu=0.5, shrinking=True, tol=0.001, verbose=False)
```

**è¦æŸ¥çœ‹æ¨¡å‹åº“ä¸­å¯ç”¨æ¨¡å‹çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·æŸ¥é˜…æ–‡æ¡£æˆ–ä½¿ç”¨`models`åŠŸèƒ½ã€‚**

```
models()
```

**![](img/2862c16e18d3591df6ec03485bd59a12.png)**

# **9.æŒ‡å®šæ¨¡å‹**

**ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å¼‚å¸¸æ ‡ç­¾åˆ†é…ç»™æˆ‘ä»¬çš„æ•°æ®é›†(1080 ä¸ªæ ·æœ¬)æ¥åˆ†æç»“æœã€‚æˆ‘ä»¬å°†é€šè¿‡ä½¿ç”¨`assign_model`å‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ã€‚**

```
iforest_results = assign_model(iforest)
iforest_results.head()
```

**![](img/b73739dd9d6696393da205d024936245.png)**

**æ³¨æ„ï¼Œä¸¤åˆ—`Anomaly`å’Œ`Score`è¢«æ·»åŠ åˆ°æœ«å°¾ã€‚0 ä»£è¡¨å†…éƒ¨å› ç´ ï¼Œ1 ä»£è¡¨å¤–éƒ¨å› ç´ /å¼‚å¸¸æƒ…å†µã€‚`Anomaly_Score`æ˜¯ç®—æ³•è®¡ç®—å‡ºçš„å€¼ã€‚ç¦»ç¾¤å€¼è¢«èµ‹äºˆè¾ƒå¤§çš„å¼‚å¸¸åˆ†å€¼ã€‚è¯·æ³¨æ„ï¼Œ`iforest_results`è¿˜åŒ…æ‹¬æˆ‘ä»¬åœ¨`setup`ä¸­åˆ é™¤çš„`MouseID`ã€‚å®ƒä¸ç”¨äºæ¨¡å‹ï¼Œä»…åœ¨æ‚¨ä½¿ç”¨`assign_model`æ—¶é™„åŠ åˆ°æ•°æ®é›†ã€‚**

# **10.ç»˜åˆ¶æ¨¡å‹**

**`plot_model`å‡½æ•°å¯ç”¨äºåˆ†æä¸åŒæ–¹é¢çš„å¼‚å¸¸æ£€æµ‹æ¨¡å‹ã€‚æ­¤å‡½æ•°æ¥å—ä¸€ä¸ªç»è¿‡è®­ç»ƒçš„æ¨¡å‹å¯¹è±¡å¹¶è¿”å›ä¸€ä¸ªç»˜å›¾ã€‚**

## **10.1T-åˆ†å¸ƒå¼éšæœºé‚»å±…åµŒå…¥(t-SNE)**

```
plot_model(iforest, plot = 'tsne')
```

**![](img/3430ba8877e8985cd77454ff355ef9b5.png)**

## **10.2 å‡åŒ€æµå½¢è¿‘ä¼¼å’ŒæŠ•å½±**

```
plot_model(iforest, plot = 'umap')
```

**![](img/8902bee59d7b20e3e041c0321f83f82c.png)**

# **11.æ ¹æ®çœ‹ä¸è§çš„æ•°æ®é¢„æµ‹**

**`predict_model`å‡½æ•°ç”¨äºå°†å¼‚å¸¸æ ‡ç­¾åˆ†é…ç»™ä¸€ä¸ªæ–°çš„çœ‹ä¸è§çš„æ•°æ®é›†ã€‚æˆ‘ä»¬ç°åœ¨å°†ä½¿ç”¨æˆ‘ä»¬è®­ç»ƒå¥½çš„`iforest`æ¨¡å‹æ¥é¢„æµ‹å­˜å‚¨åœ¨`data_unseen`ä¸­çš„æ•°æ®ã€‚è¯¥å˜é‡æ˜¯åœ¨æœ¬æ•™ç¨‹å¼€å§‹æ—¶åˆ›å»ºçš„ï¼ŒåŒ…å«æ¥è‡ªåŸå§‹æ•°æ®é›†çš„ 54 ä¸ªæ ·æœ¬ï¼Œè¿™äº›æ ·æœ¬ä»æœªæš´éœ²ç»™ PyCaretã€‚**

```
unseen_predictions = predict_model(iforest, data=data_unseen)
unseen_predictions.head()
```

**![](img/828eb2b3c4f6c43474db7e4b90831d97.png)**

**`Anomaly`åˆ—è¡¨ç¤ºå¼‚å¸¸å€¼(1 =å¼‚å¸¸å€¼ï¼Œ0 =å†…éƒ¨å€¼)ã€‚`Anomaly_Score`æ˜¯ç®—æ³•è®¡ç®—å‡ºçš„å€¼ã€‚ç¦»ç¾¤å€¼è¢«èµ‹äºˆè¾ƒå¤§çš„å¼‚å¸¸åˆ†å€¼ã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨`predict_model`åŠŸèƒ½æ¥æ ‡è®°è®­ç»ƒæ•°æ®ã€‚**

```
data_predictions = predict_model(iforest, data = data)
data_predictions.head()
```

**![](img/ac3d3b102f5e36597ff838c2fedf1ca5.png)**

# **12.ä¿å­˜æ¨¡å‹**

**æˆ‘ä»¬ç°åœ¨å·²ç»å®Œæˆäº†å®éªŒï¼Œä½¿ç”¨æˆ‘ä»¬çš„`iforest`æ¨¡å‹æ¥é¢„æµ‹çœ‹ä¸è§çš„æ•°æ®ä¸Šçš„æ ‡ç­¾ã€‚**

**è¿™ä½¿æˆ‘ä»¬çš„å®éªŒæ¥è¿‘å°¾å£°ï¼Œä½†ä»æœ‰ä¸€ä¸ªé—®é¢˜è¦é—®:å½“ä½ æœ‰æ›´å¤šçš„æ–°æ•°æ®è¦é¢„æµ‹æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ å¿…é¡»å†æ¬¡ç»å†æ•´ä¸ªå®éªŒå—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼ŒPyCaret çš„å†…ç½®å‡½æ•°`save_model`å…è®¸æ‚¨ä¿å­˜æ¨¡å‹å’Œæ•´ä¸ªè½¬æ¢ç®¡é“ä»¥å¤‡åç”¨ã€‚**

```
save_model(iforest,â€™Final IForest Model 25Nov2020')
```

**![](img/9d507e707843420e93f8f4ddf492eae8.png)**

**ä¸ºäº†å°†æ¥åœ¨ç›¸åŒæˆ–ä¸åŒçš„ç¯å¢ƒä¸­åŠ è½½å·²ä¿å­˜çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyCaret çš„`load_model`å‡½æ•°ï¼Œç„¶åè½»æ¾åœ°å°†å·²ä¿å­˜çš„æ¨¡å‹åº”ç”¨äºæ–°çš„æœªçŸ¥æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚**

```
saved_iforest = load_model('Final IForest Model 25Nov2020')
new_prediction = predict_model(saved_iforest, data=data_unseen)
new_prediction.head()
```

**![](img/4e5a742c286ac143ed3f94a2b07fa279.png)**

# **12.æ€»ç»“/åç»­æ­¥éª¤ï¼Ÿ**

**æˆ‘ä»¬åªè®²è¿°äº† PyCaret çš„å¼‚å¸¸æ£€æµ‹æ¨¡å—çš„åŸºç¡€çŸ¥è¯†ã€‚åœ¨ä¸‹é¢çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°æ¢è®¨é«˜çº§é¢„å¤„ç†æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯å…è®¸æ‚¨å®Œå…¨å®šåˆ¶æ‚¨çš„æœºå™¨å­¦ä¹ ç®¡é“ï¼Œå¹¶ä¸”æ˜¯ä»»ä½•æ•°æ®ç§‘å­¦å®¶çš„å¿…å¤‡çŸ¥è¯†ã€‚**

**æ„Ÿè°¢æ‚¨é˜…è¯»[ğŸ™](https://emojipedia.org/folded-hands/)**

# **é‡è¦é“¾æ¥**

**â­ [æ•™ç¨‹](https://github.com/pycaret/pycaret/tree/master/tutorials)py caret æ–°æ‰‹ï¼ŸæŸ¥çœ‹æˆ‘ä»¬çš„å®˜æ–¹ç¬”è®°æœ¬ï¼
ğŸ“‹[ç¤¾åŒºåˆ›å»ºçš„ç¤ºä¾‹ç¬”è®°æœ¬](https://github.com/pycaret/pycaret/tree/master/examples)ã€‚
ğŸ“™[åšå®¢](https://github.com/pycaret/pycaret/tree/master/resources)æŠ•ç¨¿äººçš„æ•™ç¨‹å’Œæ–‡ç« ã€‚
ğŸ“š[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/index.html)py caret çš„è¯¦ç»† API æ–‡æ¡£
ğŸ“º[è§†é¢‘æ•™ç¨‹](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g)æˆ‘ä»¬çš„è§†é¢‘æ•™ç¨‹æ¥è‡ªå„ç§èµ›äº‹ã€‚
ğŸ“¢[è®¨è®º](https://github.com/pycaret/pycaret/discussions)æœ‰ç–‘é—®ï¼Ÿä¸ç¤¾åŒºå’Œè´¡çŒ®è€…äº’åŠ¨ã€‚
ğŸ› ï¸ [å˜æ›´æ—¥å¿—](https://github.com/pycaret/pycaret/blob/master/CHANGELOG.md)å˜æ›´å’Œç‰ˆæœ¬å†å²ã€‚
ğŸŒ³[è·¯çº¿å›¾](https://github.com/pycaret/pycaret/issues/1756) PyCaret çš„è½¯ä»¶å’Œç¤¾åŒºå¼€å‘è®¡åˆ’ã€‚**

# **ä½œè€…:**

**æˆ‘å†™çš„æ˜¯ PyCaret åŠå…¶åœ¨ç°å®ä¸–ç•Œä¸­çš„ç”¨ä¾‹ï¼Œå¦‚æœä½ æƒ³è‡ªåŠ¨å¾—åˆ°é€šçŸ¥ï¼Œä½ å¯ä»¥åœ¨[åª’ä½“](https://medium.com/@moez-62905)ã€ [LinkedIn](https://www.linkedin.com/in/profile-moez/) å’Œ [Twitter](https://twitter.com/moezpycaretorg1) ä¸Šå…³æ³¨æˆ‘ã€‚**