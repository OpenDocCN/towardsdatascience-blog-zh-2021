# ä½¿ç”¨ PyCaret ä»‹ç» Python ä¸­çš„é›†ç¾¤

> åŸæ–‡ï¼š<https://towardsdatascience.com/introduction-to-clustering-in-python-with-pycaret-5d869b9714a3?source=collection_archive---------4----------------------->

## ä¸€æ­¥ä¸€æ­¥ï¼Œåˆå­¦è€…å‹å¥½çš„æ•™ç¨‹ï¼Œä½¿ç”¨ PyCaret åœ¨ Python ä¸­è¿›è¡Œæ— ç›‘ç£èšç±»ä»»åŠ¡

![](img/f9c76c2a602220ccfdbe1b2e0d509898.png)

Paola Galimberti åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

# 1.ä»‹ç»

[PyCaret](https://www.pycaret.org/) æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„å¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚è¿™æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ å’Œæ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æˆå€åœ°åŠ å¿«å®éªŒå‘¨æœŸï¼Œæé«˜æ‚¨çš„å·¥ä½œæ•ˆç‡ã€‚

ä¸å…¶ä»–å¼€æºæœºå™¨å­¦ä¹ åº“ç›¸æ¯”ï¼ŒPyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨æ¥ç”¨å‡ è¡Œä»£ç æ›¿æ¢æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå¿«é€Ÿæœ‰æ•ˆã€‚PyCaret æœ¬è´¨ä¸Šæ˜¯å‡ ä¸ªæœºå™¨å­¦ä¹ åº“å’Œæ¡†æ¶çš„ Python åŒ…è£…å™¨ï¼Œæ¯”å¦‚ scikit-learnã€XGBoostã€LightGBMã€CatBoostã€spaCyã€Optunaã€Hyperoptã€Ray ç­‰ç­‰ã€‚

PyCaret çš„è®¾è®¡å’Œç®€å•æ€§å—åˆ°äº†å…¬æ°‘æ•°æ®ç§‘å­¦å®¶è¿™ä¸€æ–°å…´è§’è‰²çš„å¯å‘ï¼Œè¿™æ˜¯ Gartner é¦–å…ˆä½¿ç”¨çš„æœ¯è¯­ã€‚å…¬æ°‘æ•°æ®ç§‘å­¦å®¶æ˜¯è¶…çº§ç”¨æˆ·ï¼Œä»–ä»¬å¯ä»¥æ‰§è¡Œç®€å•å’Œä¸­ç­‰å¤æ‚çš„åˆ†æä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡åœ¨ä»¥å‰éœ€è¦æ›´å¤šçš„æŠ€æœ¯ä¸“ä¸šçŸ¥è¯†ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹[ç½‘ç«™](https://www.pycaret.org/)æˆ–è€… [GitHub](https://www.github.com/pycaret/pycaret) ã€‚

# 2.æ•™ç¨‹ç›®æ ‡

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ :

*   **è·å–æ•°æ®:**å¦‚ä½•ä» PyCaret èµ„æºåº“å¯¼å…¥æ•°æ®ã€‚
*   **è®¾ç½®ç¯å¢ƒ:**å¦‚ä½•åœ¨ PyCaret çš„æ— ç›‘ç£[èšç±»æ¨¡å—](https://pycaret.readthedocs.io/en/latest/api/clustering.html)ä¸­è®¾ç½®å®éªŒã€‚
*   **åˆ›å»ºæ¨¡å‹:**å¦‚ä½•è®­ç»ƒæ— ç›‘ç£èšç±»æ¨¡å‹ï¼Œå¹¶ä¸ºè®­ç»ƒæ•°æ®é›†åˆ†é…èšç±»æ ‡ç­¾ä»¥ä¾›è¿›ä¸€æ­¥åˆ†æã€‚
*   **å‡ºå›¾æ¨¡å‹:**å¦‚ä½•åˆ©ç”¨å„ç§å‡ºå›¾(è‚˜ã€å‰ªå½±ã€åˆ†å¸ƒç­‰)åˆ†ææ¨¡å‹è¡¨ç°ã€‚).
*   **é¢„æµ‹æ¨¡å‹:**å¦‚ä½•æ ¹æ®è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œç»™æ–°çš„ã€çœ‹ä¸è§çš„æ•°æ®é›†åˆ†é…èšç±»æ ‡ç­¾ã€‚
*   **ä¿å­˜/åŠ è½½æ¨¡å‹:**å¦‚ä½•ä¿å­˜/åŠ è½½æ¨¡å‹ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚

# 3.æ­£åœ¨å®‰è£… PyCaret

å®‰è£…å¾ˆå®¹æ˜“ï¼Œåªéœ€å‡ åˆ†é’Ÿã€‚PyCaret ä» pip çš„é»˜è®¤å®‰è£…åªå®‰è£…åœ¨ [requirements.txt](https://github.com/pycaret/pycaret/blob/master/requirements.txt) æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç¡¬ä¾èµ–é¡¹ã€‚

```
pip install pycaret
```

è¦å®‰è£…å®Œæ•´ç‰ˆ:

```
pip install pycaret[full]
```

# 4.ä»€ä¹ˆæ˜¯é›†ç¾¤ï¼Ÿ

èšç±»æ˜¯å¯¹ä¸€ç»„å¯¹è±¡è¿›è¡Œåˆ†ç»„çš„ä»»åŠ¡ï¼Œä½¿åŒä¸€ç»„(ç§°ä¸ºç°‡)ä¸­çš„å¯¹è±¡å½¼æ­¤ä¹‹é—´æ¯”å…¶ä»–ç»„ä¸­çš„å¯¹è±¡æ›´ç›¸ä¼¼ã€‚å®ƒæ˜¯ä¸€ç§æ¢ç´¢æ€§çš„æ•°æ®æŒ–æ˜æ´»åŠ¨ï¼Œæ˜¯ç»Ÿè®¡æ•°æ®åˆ†æçš„å¸¸ç”¨æŠ€æœ¯ï¼Œç”¨äºè®¸å¤šé¢†åŸŸï¼ŒåŒ…æ‹¬æœºå™¨å­¦ä¹ ã€æ¨¡å¼è¯†åˆ«ã€å›¾åƒåˆ†æã€ä¿¡æ¯æ£€ç´¢ã€ç”Ÿç‰©ä¿¡æ¯å­¦ã€æ•°æ®å‹ç¼©å’Œè®¡ç®—æœºå›¾å½¢å­¦ã€‚é›†ç¾¤çš„ä¸€äº›å¸¸è§å®é™…ä½¿ç”¨æ¡ˆä¾‹æœ‰:

*   æ ¹æ®è´­ä¹°å†å²æˆ–å…´è¶£è¿›è¡Œå®¢æˆ·ç»†åˆ†ï¼Œä»¥è®¾è®¡æœ‰é’ˆå¯¹æ€§çš„è¥é”€æ´»åŠ¨ã€‚
*   æ ¹æ®æ ‡ç­¾ã€ä¸»é¢˜å’Œæ–‡æ¡£å†…å®¹å°†æ–‡æ¡£åˆ†ä¸ºå¤šä¸ªç±»åˆ«ã€‚
*   åˆ†æç¤¾ä¼š/ç”Ÿå‘½ç§‘å­¦å®éªŒçš„ç»“æœï¼Œä»¥å‘ç°æ•°æ®ä¸­çš„è‡ªç„¶åˆ†ç»„å’Œæ¨¡å¼ã€‚

# 5.PyCaret ä¸­çš„èšç±»æ¨¡å—æ¦‚è¿°

[PyCaret çš„èšç±»æ¨¡å—](https://pycaret.readthedocs.io/en/latest/api/clustering.html) ( `pycaret.clustering`)æ˜¯ä¸€ä¸ªæ— ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å—ï¼Œå®ƒæ‰§è¡Œçš„ä»»åŠ¡æ˜¯ä»¥è¿™æ ·ä¸€ç§æ–¹å¼å¯¹ä¸€ç»„å¯¹è±¡è¿›è¡Œåˆ†ç»„ï¼Œå³åŒä¸€ç»„(ç§°ä¸ºä¸€ä¸ªèšç±»)ä¸­çš„å¯¹è±¡å½¼æ­¤ä¹‹é—´æ¯”å…¶ä»–ç»„ä¸­çš„å¯¹è±¡æ›´ç›¸ä¼¼ã€‚

PyCaret çš„é›†ç¾¤æ¨¡å—æä¾›äº†å‡ ä¸ªé¢„å¤„ç†ç‰¹æ€§ï¼Œå¯ä»¥åœ¨é€šè¿‡`setup`å‡½æ•°åˆå§‹åŒ–è®¾ç½®æ—¶è¿›è¡Œé…ç½®ã€‚å®ƒæœ‰è¶…è¿‡ 8 ä¸ªç®—æ³•å’Œå‡ ä¸ªå›¾æ¥åˆ†æç»“æœã€‚PyCaret çš„èšç±»æ¨¡å—è¿˜å®ç°äº†ä¸€ä¸ªåä¸º`tune_model`çš„ç‹¬ç‰¹åŠŸèƒ½ï¼Œå…è®¸æ‚¨è°ƒæ•´èšç±»æ¨¡å‹çš„è¶…å‚æ•°ï¼Œä»¥ä¼˜åŒ–ç›‘ç£å­¦ä¹ ç›®æ ‡ï¼Œå¦‚ç”¨äºåˆ†ç±»çš„`AUC`æˆ–ç”¨äºå›å½’çš„`R2`ã€‚

# 6.æ•™ç¨‹çš„æ•°æ®é›†

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª UCI çš„åä¸º [**å°é¼ è›‹ç™½è´¨è¡¨è¾¾**](https://archive.ics.uci.edu/ml/datasets/Mice+Protein+Expression) çš„æ•°æ®é›†ã€‚æ•°æ®é›†ç”± 77 ç§è›‹ç™½è´¨çš„è¡¨è¾¾æ°´å¹³ç»„æˆï¼Œè¿™äº›è›‹ç™½è´¨åœ¨çš®è´¨çš„ç»†èƒæ ¸éƒ¨åˆ†äº§ç”Ÿå¯æ£€æµ‹çš„ä¿¡å·ã€‚è¯¥æ•°æ®é›†åŒ…å«æ¯ç§è›‹ç™½è´¨æ€»å…± 1080 æ¬¡æµ‹é‡ã€‚æ¯æ¬¡æµ‹é‡å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ ·æœ¬(é¼ æ ‡)ã€‚

## æ•°æ®é›†å¼•ç”¨:

Higuera Cï¼ŒGardiner KJï¼ŒCIO KJ(2015)è‡ªç»„ç»‡ç‰¹å¾å›¾ç¡®å®šäº†å”æ°ç»¼åˆå¾å°é¼ æ¨¡å‹ä¸­å¯¹å­¦ä¹ è‡³å…³é‡è¦çš„è›‹ç™½è´¨ã€‚PLoS ONE 10(6): e0129126ã€‚[ç½‘é¡µé“¾æ¥] journal.pone.0129126

æ‚¨å¯ä»¥ä»è¿™é‡Œæ‰¾åˆ°çš„åŸå§‹æ•°æ®æº[](https://archive.ics.uci.edu/ml/datasets/Mice+Protein+Expression)**ä¸‹è½½æ•°æ®ï¼Œå¹¶ä½¿ç”¨ pandas [**(äº†è§£å¦‚ä½•ä½¿ç”¨)**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html) åŠ è½½æ•°æ®ï¼Œæˆ–è€…æ‚¨å¯ä»¥ä½¿ç”¨ PyCaret çš„æ•°æ®å­˜å‚¨åº“ä½¿ç”¨`get_data()`å‡½æ•°åŠ è½½æ•°æ®(è¿™å°†éœ€è¦äº’è”ç½‘è¿æ¥)ã€‚**

```
from pycaret.datasets import get_data
dataset = get_data('mice')
```

**![](img/a71c18a700cf731fe6c78a32ca5e823b.png)**

```
**# check the shape of data**
dataset.shape>>> (1080, 82)
```

**ä¸ºäº†æ¼”ç¤ºå¯¹çœ‹ä¸è§çš„æ•°æ®ä½¿ç”¨`predict_model`å‡½æ•°ï¼Œä»åŸå§‹æ•°æ®é›†ä¸­ä¿ç•™äº† 5% (54 æ¡è®°å½•)çš„æ ·æœ¬ï¼Œç”¨äºå®éªŒç»“æŸæ—¶çš„é¢„æµ‹ã€‚**

```
data = dataset.sample(frac=0.95, random_state=786)
data_unseen = dataset.drop(data.index)

data.reset_index(drop=True, inplace=True)
data_unseen.reset_index(drop=True, inplace=True)

print('Data for Modeling: ' + str(data.shape))
print('Unseen Data For Predictions: ' + str(data_unseen.shape))**>>> Data for Modeling: (1026, 82)
>>> Unseen Data For Predictions: (54, 82)**
```

# **8.åœ¨ PyCaret ä¸­è®¾ç½®ç¯å¢ƒ**

**PyCaret ä¸­çš„`setup`å‡½æ•°åˆå§‹åŒ–ç¯å¢ƒï¼Œå¹¶ä¸ºå»ºæ¨¡å’Œéƒ¨ç½²åˆ›å»ºè½¬æ¢ç®¡é“ã€‚åœ¨ pycaret ä¸­æ‰§è¡Œä»»ä½•å…¶ä»–å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨`setup`ã€‚å®ƒåªéœ€è¦ä¸€ä¸ªå¼ºåˆ¶å‚æ•°:ç†ŠçŒ«æ•°æ®å¸§ã€‚æ‰€æœ‰å…¶ä»–å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå¯ç”¨äºå®šåˆ¶é¢„å¤„ç†ç®¡é“ã€‚**

**å½“æ‰§è¡Œ`setup`æ—¶ï¼ŒPyCaret çš„æ¨ç†ç®—æ³•å°†æ ¹æ®æŸäº›å±æ€§è‡ªåŠ¨æ¨æ–­å‡ºæ‰€æœ‰ç‰¹å¾çš„æ•°æ®ç±»å‹ã€‚åº”è¯¥å¯ä»¥æ­£ç¡®æ¨æ–­å‡ºæ•°æ®ç±»å‹ï¼Œä½†æƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚ä¸ºäº†å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä¸€æ—¦æ‰§è¡Œäº†`setup`ï¼ŒPyCaret å°±ä¼šæ˜¾ç¤ºä¸€ä¸ªæç¤ºï¼Œè¦æ±‚ç¡®è®¤æ•°æ®ç±»å‹ã€‚å¦‚æœæ‰€æœ‰æ•°æ®ç±»å‹éƒ½æ­£ç¡®ï¼Œæ‚¨å¯ä»¥æŒ‰ enter é”®æˆ–é”®å…¥`quit`é€€å‡ºè®¾ç½®ã€‚**

**ç¡®ä¿æ•°æ®ç±»å‹æ­£ç¡®åœ¨ PyCaret ä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨æ‰§è¡Œå¤šä¸ªç‰¹å®šäºç±»å‹çš„é¢„å¤„ç†ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡å¯¹äºæœºå™¨å­¦ä¹ æ¨¡å‹æ¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ã€‚**

**æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨`setup`ä¸­çš„`numeric_features`å’Œ`categorical_features`å‚æ•°æ¥é¢„å®šä¹‰æ•°æ®ç±»å‹ã€‚**

```
from pycaret.clustering import *

exp_clu101 = setup(data, normalize = True, 
                   ignore_features = ['MouseID'],
                   session_id = 123)
```

**![](img/9201ad1030509a1213fc790f684b5070.png)**

**æˆåŠŸæ‰§è¡Œè®¾ç½®åï¼Œå®ƒä¼šæ˜¾ç¤ºä¿¡æ¯ç½‘æ ¼ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›å…³äºå®éªŒçš„é‡è¦ä¿¡æ¯ã€‚å¤§éƒ¨åˆ†ä¿¡æ¯ä¸æ‰§è¡Œ`setup`æ—¶æ„å»ºçš„é¢„å¤„ç†æµæ°´çº¿æœ‰å…³ã€‚è¿™äº›ç‰¹æ€§çš„å¤§éƒ¨åˆ†è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯ï¼Œæœ‰ä¸€äº›é‡è¦çš„äº‹æƒ…éœ€è¦æ³¨æ„:**

*   ****session_id:** ä¸€ä¸ªä¼ªéšæœºæ•°ï¼Œä½œä¸ºç§å­åˆ†å¸ƒåœ¨æ‰€æœ‰å‡½æ•°ä¸­ï¼Œä»¥ä¾¿ä»¥åå†ç°ã€‚å¦‚æœæ²¡æœ‰é€šè¿‡`session_id`ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œåˆ†é…ç»™æ‰€æœ‰å‡½æ•°ã€‚åœ¨æœ¬å®éªŒä¸­ï¼Œä¸ºäº†ä»¥åçš„å†ç°æ€§ï¼Œå°†`session_id`è®¾ç½®ä¸º`123`ã€‚**
*   ****ç¼ºå¤±å€¼:**å½“åŸå§‹æ•°æ®ä¸­å­˜åœ¨ç¼ºå¤±å€¼æ—¶ï¼Œæ˜¾ç¤ºä¸ºçœŸã€‚è¯·æ³¨æ„ï¼Œä¸Šé¢ä¿¡æ¯ç½‘æ ¼ä¸­çš„`Missing Values`æ˜¯`True`ï¼Œå› ä¸ºæ•°æ®ä¸­åŒ…å«ç¼ºå¤±å€¼ï¼Œå¯¹äºæ•°æ®é›†ä¸­çš„æ•°å­—ç‰¹å¾ï¼Œä½¿ç”¨`mean`è‡ªåŠ¨ä¼°ç®—ï¼Œå¯¹äºåˆ†ç±»ç‰¹å¾ï¼Œä½¿ç”¨`constant`è‡ªåŠ¨ä¼°ç®—ã€‚å¯ä½¿ç”¨`setup`åŠŸèƒ½ä¸­çš„`numeric_imputation`å’Œ`categorical_imputation`å‚æ•°æ”¹å˜æ’è¡¥æ–¹æ³•ã€‚**
*   ****åŸå§‹æ•°æ®:**æ˜¾ç¤ºæ•°æ®é›†çš„åŸå§‹å½¢çŠ¶ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­,( 1026ï¼Œ82)æ„å‘³ç€ 1026 ä¸ªæ ·æœ¬å’Œ 82 ä¸ªç‰¹å¾ã€‚**
*   ****è½¬æ¢æ•°æ®:**æ˜¾ç¤ºè½¬æ¢æ•°æ®é›†çš„å½¢çŠ¶ã€‚è¯·æ³¨æ„ï¼ŒåŸå§‹æ•°æ®é›†çš„å½¢çŠ¶(1026ï¼Œ82)è¢«è½¬æ¢ä¸º(1026ï¼Œ91)ã€‚ç”±äºæ•°æ®é›†ä¸­åˆ†ç±»è¦ç´ çš„ç¼–ç ï¼Œè¦ç´ çš„æ•°é‡æœ‰æ‰€å¢åŠ ã€‚**
*   ****æ•°å­—ç‰¹å¾:**æ¨æ–­ä¸ºæ•°å­—çš„ç‰¹å¾æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ82 ä¸ªè¦ç´ ä¸­æœ‰ 77 ä¸ªè¢«æ¨æ–­ä¸ºæ•°å€¼å‹ã€‚**
*   ****åˆ†ç±»ç‰¹å¾:**è¢«æ¨æ–­ä¸ºåˆ†ç±»çš„ç‰¹å¾çš„æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ82 ä¸ªè¦ç´ ä¸­æœ‰ 5 ä¸ªè¢«æ¨æ–­ä¸ºåˆ†ç±»è¦ç´ ã€‚è¿˜è¦æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨`ignore_feature`å‚æ•°å¿½ç•¥äº†ä¸€ä¸ªåˆ†ç±»ç‰¹å¾`MouseID`ï¼Œå› ä¸ºå®ƒæ˜¯æ¯ä¸ªæ ·æœ¬çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›åœ¨æ¨¡å‹è®­ç»ƒæœŸé—´è€ƒè™‘å®ƒã€‚**

**è¯·æ³¨æ„æ‰§è¡Œå»ºæ¨¡æ‰€å¿…éœ€çš„ä¸€äº›ä»»åŠ¡æ˜¯å¦‚ä½•è‡ªåŠ¨å¤„ç†çš„ï¼Œä¾‹å¦‚ç¼ºå¤±å€¼æ’è¡¥ã€åˆ†ç±»ç¼–ç ç­‰ã€‚`setup`åŠŸèƒ½ä¸­çš„å¤§å¤šæ•°å‚æ•°æ˜¯å¯é€‰çš„ï¼Œç”¨äºå®šåˆ¶é¢„å¤„ç†æµæ°´çº¿ã€‚è¿™äº›å‚æ•°è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯æˆ‘å°†åœ¨åé¢å†™æ›´å¤šå…³äºå®ƒä»¬çš„å†…å®¹ã€‚**

# **9.åˆ›å»ºæ¨¡å‹**

**åœ¨ PyCaret ä¸­è®­ç»ƒèšç±»æ¨¡å‹å¾ˆç®€å•ï¼Œç±»ä¼¼äºåœ¨ PyCaret çš„ç›‘ç£å­¦ä¹ æ¨¡å—ä¸­åˆ›å»ºæ¨¡å‹ã€‚ä½¿ç”¨`create_model`å‡½æ•°åˆ›å»ºèšç±»æ¨¡å‹ã€‚è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªç»è¿‡è®­ç»ƒçš„æ¨¡å‹å¯¹è±¡å’Œä¸€äº›éç›‘ç£çš„æŒ‡æ ‡ã€‚è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹:**

```
kmeans = create_model('kmeans')
```

**![](img/9fa18b0d9e410650c32745643ccf2f11.png)**

```
print(kmeans)**>>> OUTPUT** KMeans(algorithm='auto', copy_x=True, init='k-means++', max_iter=300,
       n_clusters=4, n_init=10, n_jobs=-1, precompute_distances='deprecated',
       random_state=123, tol=0.0001, verbose=0)
```

**æˆ‘ä»¬å·²ç»ä½¿ç”¨`create_model`è®­ç»ƒäº†ä¸€ä¸ªæ— ç›‘ç£çš„ K-Means æ¨¡å‹ã€‚è¯·æ³¨æ„ï¼Œ`n_clusters`å‚æ•°è¢«è®¾ç½®ä¸º`4`ï¼Œè¿™æ˜¯æ‚¨ä¸å‘`num_clusters`å‚æ•°ä¼ é€’å€¼æ—¶çš„é»˜è®¤å€¼ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæœ‰ 6 ä¸ªé›†ç¾¤çš„`kmodes`æ¨¡å‹ã€‚**

```
kmodes = create_model('kmodes', num_clusters = 6)
```

**![](img/2a39237fa4b9fbda49894f913a6bf090.png)**

```
print(kmodes)**>>> OUTPUT** KModes(cat_dissim=<function matching_dissim at 0x00000168B0B403A0>, init='Cao',
       max_iter=100, n_clusters=6, n_init=1, n_jobs=-1, random_state=123,
       verbose=0)
```

**è¦æŸ¥çœ‹æ¨¡å‹åº“ä¸­å¯ç”¨æ¨¡å‹çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·æŸ¥é˜…æ–‡æ¡£æˆ–ä½¿ç”¨`models`åŠŸèƒ½ã€‚**

```
models()
```

**![](img/d05ec67c21f89f6e5d9d18adc90e0429.png)**

# **10.æŒ‡å®šæ¨¡å‹**

**ç°åœ¨æˆ‘ä»¬å·²ç»è®­ç»ƒäº†ä¸€ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨`assign_model`å‡½æ•°å°†åˆ†ç±»æ ‡ç­¾åˆ†é…ç»™æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†(1026 ä¸ªæ ·æœ¬)ã€‚**

```
kmean_results = assign_model(kmeans)
kmean_results.head()
```

**![](img/cc6a6e713f25f3802e152ae3a74afe4b.png)**

**æ³¨æ„ï¼Œä¸€ä¸ªåä¸º`Cluster`çš„æ–°åˆ—è¢«æ·»åŠ åˆ°åŸå§‹æ•°æ®é›†ä¸­ã€‚**

**è¯·æ³¨æ„ï¼Œç»“æœè¿˜åŒ…æ‹¬æˆ‘ä»¬åœ¨`setup`æœŸé—´å®é™…åˆ é™¤çš„`MouseID`åˆ—ã€‚ä¸è¦æ‹…å¿ƒï¼Œå®ƒä¸ç”¨äºæ¨¡å‹è®­ç»ƒï¼Œè€Œæ˜¯ä»…åœ¨è°ƒç”¨`assign_model`æ—¶è¿½åŠ åˆ°æ•°æ®é›†ã€‚**

# **11.ç»˜åˆ¶æ¨¡å‹**

**`plot_model`å‡½æ•°ç”¨äºåˆ†æèšç±»æ¨¡å‹ã€‚æ­¤å‡½æ•°æ¥å—ä¸€ä¸ªç»è¿‡è®­ç»ƒçš„æ¨¡å‹å¯¹è±¡å¹¶è¿”å›ä¸€ä¸ªç»˜å›¾ã€‚**

## **11.1 èšç±» PCA å›¾**

```
plot_model(kmeans)
```

**![](img/44009870bbba387868625adf06336ac4.png)**

**åˆ†ç±»æ ‡ç­¾ä¼šè‡ªåŠ¨ç€è‰²å¹¶æ˜¾ç¤ºåœ¨å›¾ä¾‹ä¸­ã€‚å½“æ‚¨å°†é¼ æ ‡æ‚¬åœåœ¨æ•°æ®ç‚¹ä¸Šæ—¶ï¼Œæ‚¨å°†çœ‹åˆ°é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨æ•°æ®é›†ç¬¬ä¸€åˆ—(åœ¨æœ¬ä¾‹ä¸­ä¸º MouseID)çš„é™„åŠ è¦ç´ ã€‚æ‚¨å¯ä»¥é€šè¿‡ä¼ é€’å‚æ•°`feature`æ¥æ”¹å˜è¿™ä¸€ç‚¹ï¼Œå¦‚æœæ‚¨æƒ³åœ¨å›¾ä¸Šæ‰“å°æ ‡ç­¾ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°†`label`è®¾ç½®ä¸º`True`ã€‚**

## **11.2 å¼¯ç®¡å›¾**

```
plot_model(kmeans, plot = 'elbow')
```

**![](img/efd21d7d83db85311c6a6e6dc631b17d.png)**

**è‚˜æ–¹æ³•æ˜¯ä¸€ç§è§£é‡Šå’ŒéªŒè¯èšç±»å†…ä¸€è‡´æ€§åˆ†æçš„å¯å‘å¼æ–¹æ³•ï¼Œæ—¨åœ¨å¸®åŠ©åœ¨æ•°æ®é›†ä¸­æ‰¾åˆ°é€‚å½“æ•°é‡çš„èšç±»ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œä¸Šé¢çš„è‚˜å½¢å›¾è¡¨æ˜`5`æ˜¯æœ€ä½³çš„èšç±»æ•°ã€‚**

**[**äº†è§£æ›´å¤šå…³äºè‚˜å‡»å‰§æƒ…**](https://blog.cambridgespark.com/how-to-determine-the-optimal-number-of-clusters-for-k-means-clustering-14f27070048f)**

## **11.3 è½®å»“å›¾**

```
plot_model(kmeans, plot = 'silhouette')
```

**![](img/8b8f1b89b2fcdc1e42fd1119ab44b168.png)**

**å‰ªå½±æ˜¯ä¸€ç§è§£é‡Šå’ŒéªŒè¯æ•°æ®ç°‡ä¸€è‡´æ€§çš„æ–¹æ³•ã€‚è¯¥æŠ€æœ¯æä¾›äº†ä¸€ä¸ªç®€æ´çš„å›¾å½¢è¡¨ç¤ºï¼Œæ˜¾ç¤ºæ¯ä¸ªå¯¹è±¡çš„åˆ†ç±»æƒ…å†µã€‚æ¢å¥è¯è¯´ï¼Œè½®å»“å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ä¸å…¶è‡ªå·±çš„ç°‡(å†…èš)ç›¸æ¯”ä¸å…¶ä»–ç°‡(åˆ†ç¦»)æœ‰å¤šç›¸ä¼¼çš„åº¦é‡ã€‚**

**[**äº†è§£æ›´å¤šå‰ªå½±å‰§æƒ…**](https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html)**

## **11.4 åˆ†å¸ƒå›¾**

```
plot_model(kmeans, plot = 'distribution')
```

**![](img/026eee5e62de18c2eccee5a7d143c2b1.png)**

**åˆ†å¸ƒå›¾æ˜¾ç¤ºäº†æ¯ä¸ªç°‡çš„å¤§å°ã€‚å°†é¼ æ ‡æ‚¬åœåœ¨æ¡å½¢ä¸Šæ–¹æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°åˆ†é…ç»™æ¯ä¸ªèšç±»çš„æ ·æœ¬æ•°ã€‚ä»ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°èšç±» 3 å…·æœ‰æœ€é«˜æ•°é‡çš„æ ·æœ¬ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨`distribution`å›¾æ¥æŸ¥çœ‹ä¸ä»»ä½•å…¶ä»–æ•°å­—æˆ–åˆ†ç±»ç‰¹å¾ç›¸å…³çš„èšç±»æ ‡ç­¾çš„åˆ†å¸ƒã€‚**

```
plot_model(kmeans, plot = 'distribution', feature = 'class')
```

**![](img/4bfa0b92637be5f25d8e94bc140f9946.png)**

**åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`class`ä½œä¸ºä¸€ä¸ªç‰¹å¾ï¼Œæ‰€ä»¥æ¯ä¸ªæ¡ä»£è¡¨ä¸€ä¸ª`class`ï¼Œå®ƒç”¨ä¸€ä¸ªåˆ†ç±»æ ‡ç­¾(å³è¾¹çš„å›¾ä¾‹)ç€è‰²ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°`t-SC-m`ç±»å’Œ`c-SC-m`ç±»å¤§å¤šä»¥`Cluster 3`ç±»ä¸ºä¸»ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„å›¾æ¥çœ‹ä»»ä½•è¿ç»­ç‰¹å¾çš„åˆ†å¸ƒã€‚**

```
plot_model(kmeans, plot = 'distribution', feature = 'CaNA_N')
```

**![](img/81d5810a52072765f164c24351d93024.png)**

# **12.æ ¹æ®çœ‹ä¸è§çš„æ•°æ®é¢„æµ‹**

**`predict_model`å‡½æ•°ç”¨äºå°†èšç±»æ ‡ç­¾åˆ†é…ç»™ä¸€ä¸ªæ–°çš„çœ‹ä¸è§çš„æ•°æ®é›†ã€‚æˆ‘ä»¬ç°åœ¨å°†ä½¿ç”¨æˆ‘ä»¬è®­ç»ƒå¥½çš„`kmeans`æ¨¡å‹æ¥é¢„æµ‹å­˜å‚¨åœ¨`data_unseen`ä¸­çš„æ•°æ®ã€‚è¯¥å˜é‡æ˜¯åœ¨æœ¬æ•™ç¨‹å¼€å§‹æ—¶åˆ›å»ºçš„ï¼ŒåŒ…å«æ¥è‡ªåŸå§‹æ•°æ®é›†çš„ 54 ä¸ªæ ·æœ¬ï¼Œè¿™äº›æ ·æœ¬ä»æœªæš´éœ²ç»™ PyCaretã€‚**

```
unseen_predictions = predict_model(kmeans, data=data_unseen)
unseen_predictions.head()
```

**![](img/71e8c21f7cddcd57e210e3fc394e5c6d.png)**

# **13.ä¿å­˜æ¨¡å‹**

**æˆ‘ä»¬ç°åœ¨å·²ç»å®Œæˆäº†å®éªŒï¼Œä½¿ç”¨æˆ‘ä»¬çš„`kmeans`æ¨¡å‹æ¥é¢„æµ‹çœ‹ä¸è§çš„æ•°æ®ä¸Šçš„æ ‡ç­¾ã€‚**

**è¿™ä½¿æˆ‘ä»¬çš„å®éªŒæ¥è¿‘å°¾å£°ï¼Œä½†ä»æœ‰ä¸€ä¸ªé—®é¢˜è¦é—®:å½“ä½ æœ‰æ›´å¤šçš„æ–°æ•°æ®è¦é¢„æµ‹æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ å¿…é¡»å†æ¬¡ç»å†æ•´ä¸ªå®éªŒå—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼ŒPyCaret çš„å†…ç½®å‡½æ•°`save_model`å…è®¸æ‚¨ä¿å­˜æ¨¡å‹å’Œæ•´ä¸ªè½¬æ¢ç®¡é“ä»¥å¤‡åç”¨ã€‚**

```
save_model(kmeans,â€™Final KMeans Model 25Nov2020')
```

**![](img/c43e6b8badc1bf5966ac1ca0406dde53.png)**

**ä¸ºäº†åœ¨å°†æ¥çš„æŸä¸€å¤©åœ¨ç›¸åŒæˆ–ä¸åŒçš„ç¯å¢ƒä¸­åŠ è½½å·²ä¿å­˜çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyCaret çš„`load_model`å‡½æ•°ï¼Œç„¶åè½»æ¾åœ°å°†å·²ä¿å­˜çš„æ¨¡å‹åº”ç”¨äºæ–°çš„æœªçŸ¥æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚**

```
saved_kmeans = load_model('Final KMeans Model 25Nov2020')
new_prediction = predict_model(saved_kmeans, data=data_unseen)
new_prediction.head()
```

**![](img/6fde88de18f92d117c82c3db86861e37.png)**

# **14.æ€»ç»“/åç»­æ­¥éª¤ï¼Ÿ**

**æˆ‘ä»¬åªä»‹ç»äº† [PyCaret çš„é›†ç¾¤æ¨¡å—](https://pycaret.readthedocs.io/en/latest/api/clustering.html)çš„åŸºç¡€çŸ¥è¯†ã€‚åœ¨ä¸‹é¢çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°æ¢è®¨é«˜çº§é¢„å¤„ç†æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯å…è®¸æ‚¨å®Œå…¨å®šåˆ¶æ‚¨çš„æœºå™¨å­¦ä¹ ç®¡é“ï¼Œå¹¶ä¸”æ˜¯ä»»ä½•æ•°æ®ç§‘å­¦å®¶çš„å¿…å¤‡çŸ¥è¯†ã€‚**

**æ„Ÿè°¢æ‚¨é˜…è¯»[ğŸ™](https://emojipedia.org/folded-hands/)**

# **é‡è¦é“¾æ¥**

**â­ [æ•™ç¨‹](https://github.com/pycaret/pycaret/tree/master/tutorials)py caret æ–°æ‰‹ï¼ŸæŸ¥çœ‹æˆ‘ä»¬çš„å®˜æ–¹ç¬”è®°æœ¬ï¼
ğŸ“‹[ç¤¾åŒºåˆ›å»ºçš„ç¤ºä¾‹ç¬”è®°æœ¬](https://github.com/pycaret/pycaret/tree/master/examples)ã€‚
ğŸ“™[åšå®¢](https://github.com/pycaret/pycaret/tree/master/resources)æŠ•ç¨¿äººçš„æ•™ç¨‹å’Œæ–‡ç« ã€‚
ğŸ“š[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/index.html)py caret çš„è¯¦ç»† API æ–‡æ¡£
ğŸ“º[è§†é¢‘æ•™ç¨‹](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g)æˆ‘ä»¬çš„è§†é¢‘æ•™ç¨‹æ¥è‡ªå„ç§èµ›äº‹ã€‚
ğŸ“¢[è®¨è®º](https://github.com/pycaret/pycaret/discussions)æœ‰ç–‘é—®ï¼Ÿä¸ç¤¾åŒºå’Œè´¡çŒ®è€…äº’åŠ¨ã€‚
ğŸ› ï¸ [å˜æ›´æ—¥å¿—](https://github.com/pycaret/pycaret/blob/master/CHANGELOG.md)å˜æ›´å’Œç‰ˆæœ¬å†å²ã€‚
ğŸŒ³[è·¯çº¿å›¾](https://github.com/pycaret/pycaret/issues/1756) PyCaret çš„è½¯ä»¶å’Œç¤¾åŒºå¼€å‘è®¡åˆ’ã€‚**

# **ä½œè€…:**

**æˆ‘å†™çš„æ˜¯ PyCaret åŠå…¶åœ¨ç°å®ä¸–ç•Œä¸­çš„ç”¨ä¾‹ï¼Œå¦‚æœä½ æƒ³è‡ªåŠ¨å¾—åˆ°é€šçŸ¥ï¼Œä½ å¯ä»¥åœ¨[åª’ä½“](https://medium.com/@moez-62905)ã€ [LinkedIn](https://www.linkedin.com/in/profile-moez/) å’Œ [Twitter](https://twitter.com/moezpycaretorg1) ä¸Šå…³æ³¨æˆ‘ã€‚**