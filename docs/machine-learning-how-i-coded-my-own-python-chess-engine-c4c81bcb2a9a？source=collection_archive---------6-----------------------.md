# æœºå™¨å­¦ä¹ å’Œå›½é™…è±¡æ£‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/machine-learning-how-i-coded-my-own-python-chess-engine-c4c81bcb2a9a?source=collection_archive---------6----------------------->

## æˆ‘å¦‚ä½•ç¼–å†™è‡ªå·±çš„ python è±¡æ£‹å¼•æ“

![](img/4691ab8cbdd375906bb1c3e9b5a2e5cd.png)

ç”±[æ°æ–¯æ¸©Â·æ‰˜é©¬æ–¯](https://unsplash.com/@jeswinthomas?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

**æºä»£ç :** [Github](https://github.com/iAmEthanMai/chess-games-dataset) | [å¯¹æˆ˜ A.I](https://colab.research.google.com/github/iAmEthanMai/chess-engine-model/blob/main/python_chess_engine.ipynb#scrollTo=dsacAJ-5gkN0)

**å¿«é€Ÿä»‹ç»:**

2020 å¹´æœ«ï¼Œç½‘é£å‘å¸ƒäº†ã€Šå¥³ç‹çš„ç­–ç•¥ã€‹,è¿™æ˜¯ä¸€éƒ¨å‘ç”Ÿåœ¨ 20 ä¸–çºª 50 å¹´ä»£çš„ç”µè§†èŠ‚ç›®ï¼Œæˆ‘ä»¬è·Ÿéšä¸€ä¸ªå¹´è½»å¥³æ€§æˆé•¿ä¸ºæœ€å¥½çš„æ£‹æ‰‹çš„æ—…ç¨‹ã€‚

ç„¶è€Œï¼Œä¸ä¸»è§’è´ä¸Â·å“ˆè’™ä¸åŒï¼Œè±¡æ£‹å¹¶ä¸æ˜¯æˆ‘æœ€æ“…é•¿çš„ã€‚æ‰€ä»¥æˆ‘åšäº†é€€è€Œæ±‚å…¶æ¬¡çš„äº‹æƒ…ï¼Œæ„å»ºäº†è‡ªå·±çš„ python è±¡æ£‹å¼•æ“æ¥å¼¥è¡¥æˆ‘ç³Ÿç³•çš„è±¡æ£‹æŠ€å·§ã€‚

**ç¬¬ä¸€é›†:**ç­–ç•¥

å½“æ¶‰åŠåˆ°æ„å»ºä»»ä½•æ£‹ç›˜æ¸¸æˆå¼•æ“æ—¶ï¼Œæœ‰å¤šç§ç­–ç•¥:

*   å¼ºåŒ–å­¦ä¹ 
*   æå¤§æå°
*   åŸºäºäººç±»çŸ¥è¯†è®­ç»ƒçš„ ML æ¨¡å‹
*   â€¦

æˆ‘é€‰æ‹©äº†ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§ç­–ç•¥çš„æ··åˆ:ä½œä¸ºä¸€åæ•°æ®ç§‘å­¦å®¶ï¼Œæˆ‘å–œæ¬¢å¤„ç†å¤§å‹æ•°æ®é›†å’Œæœºå™¨å­¦ä¹ æ¨¡å‹ã€‚æ­¤å¤–ï¼Œå°½ç®¡æœ‰ç‚¹æ…¢ï¼Œæå¤§æå°ç®—æ³•æ˜¯ä¸€ä¸ªç›¸å½“å¯é çš„ç®—æ³•ï¼Œå¹¶åœ¨æ•æ‰æ•Œäººçš„ä½œå“åšå¾—å¾ˆå¥½ã€‚å¼ºåŒ–å­¦ä¹ ç®€ç›´å¤ªå¤æ‚äº†ã€‚

æˆ‘çš„ç­–ç•¥å¾ˆç®€å•:

*   é¦–å…ˆï¼Œä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå¼•æ“å°†é©³å›ç»™å®šæ£‹ç›˜çš„ 50%çš„å¯èƒ½èµ°æ³•ã€‚å®ƒé€šè¿‡æ‰¾åˆ°ä¸€æ­¥æ£‹æ˜¯â€œå¥½æ£‹â€çš„æ¦‚ç‡æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚æ‰€æœ‰çš„ç§»åŠ¨éƒ½æŒ‰ç…§è¿™ä¸ªæ¦‚ç‡æ’åºï¼Œåªå‰©ä¸‹ç¬¬ 50 ä¸ªç™¾åˆ†ä½æ•°ã€‚
*   å…¶æ¬¡ï¼Œå¼•æ“å°†å¯¹å‰©ä½™çš„ç§»åŠ¨æ‰§è¡Œæœ€å°æœ€å¤§ç®—æ³•ã€‚æ ¹æ®æ£‹ç›˜çš„å¤æ‚ç¨‹åº¦ï¼Œæœç´¢æ ‘ä¼šè¾¾åˆ°ä¸€å®šçš„æ·±åº¦ã€‚

**ç¬¬äºŒé›†:**æ•°æ®

ä¸ºäº†åšå‡ºå‡†ç¡®çš„é¢„æµ‹ï¼Œæˆ‘ä»¬éœ€è¦å¤§é‡çš„æ•°æ®ã€‚å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å°†ä½¿ç”¨æˆ‘åœ¨ [Kaggle](https://www.kaggle.com/liury123/chess-game-from-12-top-players) ä¸Šæ‰¾åˆ°çš„æ•°æ®é›†ã€‚è¿™ä¸ªæ•°æ®é›†æ˜¯å›½é™…è±¡æ£‹å¤§å¸ˆä»¥`.pgn`æ ¼å¼(å¯ç§»æ¤æ¸¸æˆç¬¦å·)è¿›è¡Œçš„æ•°åƒåœºæ¸¸æˆçš„é›†åˆã€‚

ä¸‹ä¸€æ­¥æ˜¯ä»æ‰€æœ‰çš„æ¸¸æˆä¸­æå–æ‰€æœ‰çš„æ‹›å¼ï¼Œå¹¶æ ‡è®°ä¸ºå¥½æˆ–åã€‚

> åœ¨æˆ‘çœ‹æ¥,â€˜å¥½æ£‹â€™æ˜¯èµ¢å®¶åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­çš„æŸä¸ªæ—¶åˆ»èµ°çš„ä¸€æ­¥æ£‹ã€‚â€œåæ£‹â€æ˜¯èµ¢å®¶é€‰æ‹©ä¸èµ°çš„åˆæ³•æ£‹ã€‚

[è¿™ä¸ª](https://github.com/iAmEthanMai/chess-games-dataset/blob/main/Script/process_data.py) python è„šæœ¬å®Œæˆäº†å·¥ä½œï¼Œç»™æˆ‘ç•™ä¸‹äº†ä¸€ä¸ªå…¨æ–°çš„`.csv`æ•°æ®é›†ã€‚

ä½ å¯ä»¥åœ¨ Kaggle å’Œ Github ä¸Šæ‰¾åˆ°æˆ‘çš„æ•°æ®é›†:

[](https://www.kaggle.com/ethanmai/chess-moves) [## è±¡æ£‹ç§»åŠ¨

### æ ‡è®°ä¸ºå¥½/åçš„ 160 ä¸‡æ­¥æ£‹çš„é›†åˆ

www.kaggle.com](https://www.kaggle.com/ethanmai/chess-moves) [](https://github.com/iAmEthanMai/chess-games-dataset) [## è®®ä¼š/è±¡æ£‹-æ¸¸æˆ-æ•°æ®é›†

### æ£‹æ­¥æ•°æ®é›†ğŸ”¢

github.com](https://github.com/iAmEthanMai/chess-games-dataset) 

ç„¶åï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®å¸§å¯¼å…¥æˆ‘ä»¬çš„ Jupyter ç¬”è®°æœ¬ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°åœ¨ç¬¬ä¸€ä¸ªä»£ç å•å…ƒä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
In[1]: import pandas as pd
       df = pd.read_csv('data.csv')
       print(df.shape)Out:   (1600000,193)
```

æ•°æ®æ¡†æ¶çš„åˆ—å¦‚ä¸‹:

*   å‰ 64 åˆ—ä»£è¡¨å½“å‰æ£‹ç›˜çš„ 64 ä¸ªæ–¹å—ã€‚
*   ä» 65 åˆ° 128 çš„åˆ—ä»£è¡¨ç§»åŠ¨çš„å¼€å§‹ä½ç½®:å¦‚æœä¸€ä¸ªæ£‹å­ä»é‚£ä¸ªæ–¹å—ç§»åŠ¨ï¼Œåˆ™ä¸º 1.0ï¼Œå¦åˆ™ä¸º 0.0ã€‚
*   ä» 130 åˆ° 192 çš„åˆ—ä»£è¡¨ç§»åŠ¨çš„ç»“æŸä½ç½®:å¦‚æœä¸€ä¸ªæ£‹å­ç§»åŠ¨åˆ°é‚£ä¸ªæ–¹å—ï¼Œåˆ™ä¸º 1.0ï¼Œå¦åˆ™ä¸º 0.0ã€‚
*   æœ€åä¸€åˆ—æ˜¯æ ‡ç­¾:å¦‚æœè¿™æ˜¯ä¸€æ­¥å¥½æ£‹ï¼Œåˆ™ä¸ºçœŸï¼Œå¦åˆ™ä¸ºå‡ã€‚

```
In[2]: df.head()
```

df.head()

**ç¬¬ä¸‰é›†:**æ¨¡ç‰¹

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ tensorflow çº¿æ€§åˆ†ç±»å™¨ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ¨¡å‹ï¼Œå› ä¸ºå®ƒè¢«å¾ˆå¥½åœ°[è®°å½•ä¸‹æ¥](https://www.tensorflow.org/api_docs/python/tf/estimator/LinearClassifier)å¹¶ä¸”éå¸¸æœ‰æ€§èƒ½ã€‚

```
In[3]: linear_est = tf.estimator.LinearClassifier(feature_columns)
```

**ç¬¬å››é›†:**è®­ç»ƒ

è¦è®­ç»ƒä¼°è®¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
In[4]: linear_est.train(input_function)
```

å…³äºè¿™ä¸ªé¡¹ç›®çš„æœºå™¨å­¦ä¹ éƒ¨åˆ†çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·ç¡®ä¿æŸ¥çœ‹æˆ‘çš„ [Colab ç¬”è®°æœ¬](https://colab.research.google.com/github/iAmEthanMai/chess-engine-model/blob/main/train_chess_engine.ipynb)ï¼Œåœ¨é‚£é‡Œä½ å¯ä»¥æ‰¾åˆ°æ‰€æœ‰çš„æºä»£ç ã€‚

**ç¬¬äº”é›†:** Minimax

æå¤§æå°ç®—æ³•å°†æ¢ç´¢åˆæ³•ç§»åŠ¨çš„é€’å½’æ ‘ç›´åˆ°æŸä¸€æ·±åº¦ï¼Œå¹¶ä½¿ç”¨è¯„ä¼°å‡½æ•°è¯„ä¼°å¶å­ã€‚

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å›åˆå°†æœ€å¤§æˆ–æœ€å°çš„å­èŠ‚ç‚¹å€¼è¿”å›ç»™çˆ¶èŠ‚ç‚¹ã€‚è¿™å…è®¸æˆ‘ä»¬æœ€å°åŒ–æˆ–æœ€å¤§åŒ–æ ‘çš„æ¯ä¸€å±‚çš„ç»“æœå€¼ã€‚ç‚¹å‡»äº†è§£æ›´å¤šå…³äº Minimax [çš„ä¿¡æ¯ã€‚](https://www.freecodecamp.org/news/simple-chess-ai-step-by-step-1d55a9266977/)

è¯„ä¼°åŠŸèƒ½å¯»æ‰¾ä¸¤ä¸ªæ ‡å‡†:

*   ä¸€å—çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œéª‘å£«æ¯”å’æ›´æœ‰ä»·å€¼ã€‚
*   æ£‹å­çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªéª‘å£«åœ¨æ£‹ç›˜ä¸­é—´å¾ˆå¼ºï¼Œè€Œå›½ç‹å¾ˆè„†å¼±ã€‚

è¯„ä»·å‡½æ•°ç®—æ³•

**ç¬¬å…­é›†:**æ¸¸æˆå¤„ç†

ä¸ºäº†è·å¾—åˆæ³•çš„ç§»åŠ¨å’Œæ˜¾ç¤ºæ£‹ç›˜ï¼Œæˆ‘ä½¿ç”¨äº† python-chess åº“ã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”¨ pip å®‰è£…å®ƒã€‚

```
!pip3 install python-chess
```

è¿™ä¸ªåº“è®©äº‹æƒ…å˜å¾—éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒæ¶ˆé™¤äº†ç¡¬ç¼–ç å›½é™…è±¡æ£‹è§„åˆ™å’Œå¾®å¦™ä¹‹å¤„çš„éº»çƒ¦ã€‚

**ç¬¬ä¸ƒé›†:**æ’­æ”¾

å‰©ä¸‹å”¯ä¸€çš„äº‹æƒ…å°±æ˜¯ç©æ¸¸æˆã€‚å¦‚æœä½ æƒ³è¯•ä¸€è¯•ï¼Œè¿è¡Œæ‰€æœ‰çš„ä»£ç å•å…ƒï¼Œä½ åº”è¯¥å¯ä»¥å¼€å§‹äº†â€¦ç¥ä½ å¥½è¿ï¼

[](https://colab.research.google.com/github/iAmEthanMai/chess-engine-model/blob/main/python_chess_engine.ipynb#scrollTo=dsacAJ-5gkN0) [## å’Œæˆ‘çš„äººå·¥æ™ºèƒ½æ¯”èµ›

python-chess-engine.ipynb](https://colab.research.google.com/github/iAmEthanMai/chess-engine-model/blob/main/python_chess_engine.ipynb#scrollTo=dsacAJ-5gkN0) 

**ç»“è®º:**

è°¢è°¢ä½ ç•™ä¸‹æ¥ï¼Œæˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªé¡¹ç›®ã€‚

æ¬¢è¿åœ¨ [Github](https://github.com/iAmEthanMai) ã€ [Kaggle](https://www.kaggle.com/ethanmai) å’Œ [Linkedin](http://www.linkedin.com/in/ethan-mai-0430a4198) ä¸Šä¸æˆ‘è”ç³»ã€‚