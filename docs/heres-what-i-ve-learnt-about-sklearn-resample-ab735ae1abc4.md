# ä»¥ä¸‹æ˜¯æˆ‘å¯¹ Sklearn.resample çš„äº†è§£

> åŸæ–‡ï¼š<https://towardsdatascience.com/heres-what-i-ve-learnt-about-sklearn-resample-ab735ae1abc4?source=collection_archive---------8----------------------->

## è§£é‡Šä¸Šé‡‡æ ·ã€ä¸‹é‡‡æ ·å’Œä¸€äº›è¦é¿å…çš„é”™è¯¯

![](img/1c016401d10af8c71819b19f337b803a.png)

å®‰å¾·é‡Œäºšæ–¯Â·å¸ƒé²æ©åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

å¯¹äºæ•°æ®ç§‘å­¦å®¶æ¥è¯´ï¼Œå¤„ç†ä¸å¹³è¡¡çš„æ•°æ®é›†å¯èƒ½æ˜¯ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ã€‚å¤„ç†ä¸å¹³è¡¡æ•°æ®é›†çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨ *sklearn.resample* è¿›è¡Œé‡é‡‡æ ·ï¼Œå³å‘ä¸Šé‡‡æ ·å°‘æ•°ç±»æˆ–å‘ä¸‹é‡‡æ ·å¤šæ•°ç±»ã€‚

> *Sklearn.resample* æ˜¯ Scikit learn ç”¨äºä¸Šé‡‡æ ·/ä¸‹é‡‡æ ·çš„å‡½æ•°ã€‚

æ ¹æ® sklearn æ–‡æ¡£ï¼Œå‡½æ•° sklearn.resampleï¼Œr *ä»¥ä¸€è‡´çš„æ–¹å¼å¯¹æ•°ç»„æˆ–ç¨€ç–çŸ©é˜µè¿›è¡Œé‡‡æ ·ï¼Œé»˜è®¤ç­–ç•¥å®ç°å¼•å¯¼ç¨‹åº*çš„ä¸€ä¸ªæ­¥éª¤ã€‚ç®€å•æ¥è¯´ï¼Œ *sklearn.resample* ä¸ä»…ä»…æ˜¯ç¥å¥‡åœ°ä¸ºæ•°æ®é›†ç”Ÿæˆé¢å¤–çš„æ•°æ®ç‚¹ï¼Œå®ƒåŸºæœ¬ä¸Šæ˜¯ä¸ºä½ çš„æ•°æ®é›†åˆ›å»ºä¸€ä¸ª*éšæœºé‡é‡‡æ ·(æœ‰/æ— æ›¿æ¢)ã€‚è¿™ç§å‡è¡¡è¿‡ç¨‹é˜²æ­¢æœºå™¨å­¦ä¹ æ¨¡å‹å€¾å‘äºæ•°æ®é›†ä¸­çš„å¤šæ•°ç±»ã€‚*

æ¥ä¸‹æ¥ï¼Œæˆ‘åœ¨ä¸€ä¸ªä¾‹å­ä¸­å±•ç¤ºäº†ä¸Šé‡‡æ ·ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å« 3 åˆ—çš„æ•°æ®æ¡†æ¶:**å¹´é¾„ã€æ€§åˆ«å’Œå•†åº—ã€‚**

```
#import libraries
import pandas as pd
from sklearn.utils import resample,shuffle#create a dataframe
df = {'age':['a','b','c','a','b'],'sex':['e','f','g','f','e'],'store':[1,2,3,3,2]}df = pd.DataFrame(df)df.head()
```

![](img/272efa8267c4853e2b4494278e4e1e30.png)

df.head()

æˆ‘ä»¬é¦–å…ˆåˆ†ç¦»å°‘æ•°æ°‘æ—é˜¶å±‚ï¼Œç„¶åå¯¹å°‘æ•°æ°‘æ—é˜¶å±‚è¿›è¡ŒæŠ½æ ·ã€‚å°‘æ•°æ°‘æ—ç­çº§çš„äººæ•°è¢«ä¸Šé‡‡æ ·åˆ°å…¶ä»–ç­çº§çš„äººæ•°ã€‚

```
#set the minority class to a seperate dataframedf_1 = df[df['store'] == 1]#set other classes to another dataframeother_df = df[df['store'] != 1] #upsample the minority class
df_1_upsampled = resample(df_1,random_state=42,n_samples=2,replace=True)#concatenate the upsampled dataframe
df_upsampled = pd.concat([df_1_upsampled,other_df])
df_upsampled
```

![](img/225d6d1338ddd77fa41a7cbbc79ffc68.png)

df _ ä¸Šé‡‡æ ·

å¤šé…·å•Šï¼ğŸ˜‰ ğŸ˜Šç°åœ¨æˆ‘ä»¬æœ‰æ›´å¤šçš„æ•°æ®æ¥è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚æ­¤å¤–ï¼Œå½“æˆ‘ä»¬è®­ç»ƒæ¨¡å‹æ—¶ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æ•°æ®ä¸­çš„ ***3 ä¸ªå•†åº—ç±»åˆ«(1ã€2 å’Œ 3)*** ä¸­çš„æ¯ä¸ªç±»åˆ«çš„æ•°é‡ç›¸ç­‰ã€‚

ç„¶è€Œï¼Œå½“æ‚¨è¿›è¡Œä¸Šé‡‡æ ·æˆ–ä¸‹é‡‡æ ·æ—¶ï¼Œè¯·é¿å…è¿™äº›é”™è¯¯ï¼

1.  åœ¨æœºå™¨å­¦ä¹ é—®é¢˜ä¸­ï¼Œç¡®ä¿åªæœ‰åœ¨åˆ†æˆè®­ç»ƒã€æµ‹è¯•(å¦‚æœä½ æ„¿æ„ï¼Œè¿˜å¯ä»¥éªŒè¯)ä¹‹åï¼Œæ‰è¿›è¡Œä¸Šé‡‡æ ·/ä¸‹é‡‡æ ·**ã€‚å¦‚æœæ‚¨åœ¨æ‹†åˆ†ä¸ºå®šå‹å’Œæµ‹è¯•ä¹‹å‰å¯¹æ•°æ®é›†è¿›è¡Œäº†å‘ä¸Šé‡‡æ ·ï¼Œé‚£ä¹ˆæ‚¨çš„æ¨¡å‹å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°æ•°æ®æ³„æ¼ã€‚å‚è§ä¸‹é¢çš„ç¤ºä¾‹ã€‚**

```
from sklearn.model_selection import train_test_splitX = df_upsampled.drop('store',axis=1)
y = df_upsampled.storeX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1,shuffle=True)X_train.head()
```

![](img/b1de8639d547aae88a9f46d9336890bb.png)

x _ ç«è½¦

```
X_test.head()
```

![](img/de92ce01b51de78de7525dd60ca05cc4.png)

x _ æµ‹è¯•

*æ³¨æ„æ•°æ®æ³„éœ²ï¼*æˆ‘ä»¬åœ¨ **X_train** å’Œ **X_test** ä¸­æœ‰å®Œå…¨ç›¸åŒçš„æ•°æ®ç‚¹ã€‚è¿™æ ·åšå¯èƒ½ä¼šè®©æˆ‘ä»¬å¯¹æˆ‘ä»¬çš„ ***æœºå™¨å­¦ä¹ *** æ¨¡å‹çš„å®é™…è¡¨ç°äº§ç”Ÿé”™è¯¯çš„è®¤è¯†ã€‚

![](img/99883b2fa841b5ad21315c969216afde.png)

Claudio Schwarz | @purzlbaum åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

2.åœ¨æ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹å»ºç«‹ä¹‹åï¼Œå»ºè®®åœ¨æ‚¨çš„**éä¸Šé‡‡æ ·**è®­ç»ƒæ•°æ®é›†ä¸Šæµ‹è¯•æ‚¨çš„æŒ‡æ ‡ã€‚åœ¨**éä¸Šé‡‡æ ·**æ•°æ®é›†ä¸Šæµ‹è¯•ä½ çš„æŒ‡æ ‡ï¼Œæ¯”åœ¨**ä¸Šé‡‡æ ·**æ•°æ®é›†ä¸Šæµ‹è¯•å®ƒï¼Œç»™ä½ ä¸€ä¸ªæ›´çœŸå®çš„æ¨¡å‹è¯„ä¼°ã€‚å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘æ€»æ˜¯å–œæ¬¢ä¿ç•™ä¸€ä¸ªæœªç»ä¸Šé‡‡æ ·çš„è®­ç»ƒæ•°æ®é›†ç‰ˆæœ¬ã€‚

**ç»“è®º:
ä¸Šé‡‡æ ·/ä¸‹é‡‡æ ·**æ˜¯å¤„ç†ä¸å¹³è¡¡æ•°æ®çš„éå¸¸å¥½çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œé‡è¦çš„æ˜¯è¦äº†è§£å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ­£ç¡®ä½¿ç”¨å®ƒä»¬ã€‚è¿˜è¦æ³¨æ„ï¼Œç”±äºé¢å¤–çš„ä¿¡æ¯ï¼Œä¸Šé‡‡æ ·æœºåˆ¶ä¼šåœ¨ç³»ç»Ÿä¸­å¼•å…¥åå·®ã€‚

è¿˜å¯ä»¥äº†è§£ä¸€ä¸‹ imbean åº“çš„ ***SMOTE*** æ“ä½œç¬¦ã€‚å®ƒåŸºäº***knarestneighbors***ç®—æ³•å·¥ä½œï¼Œç»¼åˆç”Ÿæˆè½åœ¨å·²ç»å­˜åœ¨çš„å¯¡ä¸æ•Œä¼—çš„ç»„é™„è¿‘çš„æ•°æ®ç‚¹ã€‚ç‚¹å‡»é˜…è¯»æ›´å¤šä¿¡æ¯[ã€‚](https://www.analyticsvidhya.com/blog/2020/11/handling-imbalanced-data-machine-learning-computer-vision-and-nlp/#:~:text=Upsampling%20is%20a%20procedure%20where,inclining%20towards%20the%20majority%20class.)

æˆ‘å¸Œæœ›è¿™å¯¹ä½ æœ‰å¸®åŠ©ã€‚æœŸå¾…æ‚¨çš„è¯„è®ºï¼ŒåŒæ—¶æ‚¨ä¹Ÿå¯ä»¥åœ¨ [twitter](https://twitter.com/samsonafo) å’Œ [Linkedin](https://www.linkedin.com/in/samson-afolabi/) ä¸Šå…³æ³¨æˆ‘ã€‚

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥è€ƒè™‘ç»™æˆ‘ä¹°æ¯â˜•ï¸.å’–å•¡

è°¢è°¢ğŸ˜Š