# DeepMind 的 EigenGame 不是游戏！

> 原文：<https://towardsdatascience.com/deepminds-eigengame-is-not-a-game-f580b3709316?source=collection_archive---------15----------------------->

## 一个分布式优化问题解决了，但是只有一个玩家

![](img/8203c2f966b6366f7692873c0c86588b.png)

图片由作者提供，是对[https://www.publicdomainpictures.net/en/view-image.php?的修改图像=28589 &图片=桌游](https://www.publicdomainpictures.net/en/view-image.php?image=28589&picture=board-games)。

来自 DeepMind 的研究人员最近在学习表征国际会议(ICLR)上获得了杰出论文奖，论文题为“特征游戏:作为纳什均衡的 PCA”。该论文对执行分散的和并行的主成分分析(PCA)做出了贡献，并且对将 PCA 的公式化视为寻找博弈的纳什均衡做出了表面上的贡献。虽然前者是杰出和值得称赞的工作，后者不是。代理之间没有战略互动，代理之间没有相互竞争，将 PCA 公式化为博弈论问题没有任何好处，但是，在我们开始之前，让我们关注积极的一面。

## 主成分分析

PCA 是机器学习管道中经常使用的技术，用于识别可解释的特征和用于数据压缩。这对于聚类和可视化以及识别回归和分类的低维表示非常有用。PCA 的工作原理是找到一组正交向量，使数据子空间的方差和子空间内方差的最大方向最大化。正如作者所指出的，只专注于压缩以最小化子空间误差的技术，不能识别可解释的特征。正交向量的任意组合将跨越该空间。最大方差的方向取决于协方差，向量必须与最大方差对齐才能成为主分量。

已故的 David MacKay 教授从事机器学习的基础研究，特别是贝叶斯机器学习，他曾经评论过他的书《信息论、推理和学习算法》的评论:

> 主成分分析是一种在维度上无效的方法，它给人们一种错觉，认为他们正在用他们的数据做一些有用的事情。如果你改变一个变量的测量单位，它将改变所有的“主成分”！正因如此，我在书中没有提到五氯苯甲醚。我不是一个盲从的墨守成规者，重复别人认为应该教的东西。我想在我教书之前。

也许麦凯说得有道理，但如果他真的认为 PCA 没有用，他应该发表一些类似的东西。数据的标准化当然很重要，因为方差被最大化了。也许是这样的情况，来自协方差矩阵的前 k 个正交特征向量的集合的向量通常不太容易解释。然而，EigenGame 论文的实验部分表明，在 ImageNet 数据集上预训练的 ResNet-200 的激活的主要成分是边缘过滤器。一般来说，能够计算非常大的数据集的特征值和特征向量在任何情况下都是一个有用的问题，并且将在应用数学和工程中有许多其他应用。

对于表示为矩阵 X 的数据集，X 的主分量由 X 的特征向量、转置 X 或 X 的右奇异向量给出。最优子空间的向量子集被选择为具有最大特征值的那些特征向量或具有最大奇异值的右奇异向量。在数值上，使用奇异值分解(SVD)比构建归一化协方差矩阵(X 转置 X)更好，因为这样做几乎总是会导致精度损失。完全奇异值分解的时间和空间复杂性使得计算非常大的数据集变得困难。因此，能够在非常大的数据集上执行分散和并行 PCA 打开了新的应用，并且非常有用。这篇论文的结束语引用了克里斯·雷的话:

> 专注地训练双向 LSTM 似乎比计算大矩阵的 SVD 更容易。

## 特征博弈中的优化

作者导出了向量的效用函数。第一个向量的效用针对最大方差的方向进行优化。后续向量的效用包括使向量方向的方差最大化的项和与先前选择的向量缺乏正交性的惩罚项。对向量进行分级。后续向量对其祖先的效用没有影响，并且它们的效用不受它们在链中的后代的向量方向的影响。这不像 Stackelberg 博弈，代理人有先发优势，但必须考虑跟随者的行动。作者声称向量的效用是不对称的，但更恰当的说法是它是有条件的。效用的梯度有直观的意义。它包括用于正交化的广义 Gram-Schmidt 程序的单个步骤，随后是在 Oja 的学习规则中找到的矩阵乘积。Oja 的学习规则是大脑中的神经元如何随时间改变连接强度的模型。

使用黎曼梯度上升来优化每个向量的梯度，并且作者证明了顺序情况下的收敛性，其中层级中第一个向量的效用最大化，接下来是第二个，等等。然而，顺序的情况过于严格，作者提出了一个分散的算法，虽然不能保证收敛，但在实践中效果很好。使用分散算法，向量的方向从祖先传播到后代，因为它们在算法的 for 循环的每次迭代中被优化。严格的向量层次不是最佳的，因为向量是随机初始化的。例如，层级中的最后一个向量最初可能更接近第一主分量的真实向量，反之亦然。

## 战略互动

要说明为什么把 PCA 公式化为博弈论问题是无益的，首先要定义博弈论。在《博弈论:冲突分析》一书中，迈尔森对博弈论的定义如下:

> 博弈论可以定义为研究智能理性决策者之间冲突与合作的数学模型。博弈论为分析两个或更多个人做出影响彼此福利的决策的情况提供了一般的数学技术。

将 PCA 公式化为一个博弈论问题，由代理选择向量的方向，其中的一个主要问题是没有战略互动。代理商的影响都是单向的。代理只是对链上的其他代理做出反应，而不受链下代理的影响。像那样的游戏玩起来不会很有趣。

作者声称这是一个竞争性的游戏，但也可以说代理人是合作的。要做到这一点，可以说代理有一个共同的目标，即在确保向量正交并与最大方差的方向对齐的同时，使子空间的误差最小化。在博弈论的意义上，效用函数彼此并不冲突。也就是说，代理的效用函数可以合并成一个单一的效用函数，即和，而 EigenGame 可以看作是一个单人游戏。当然，总和会考虑到等级或排序以及单个效用函数的条件性。博弈论对单人游戏不感兴趣。在论文和 blog⁴中，暗示了这在某种程度上不是一个优化问题。它仍然可以被视为一个优化问题，但一个正在解决使用并行或分布式系统。然而，声称代理人合作与声称他们竞争是同样无益的。实际上，代理人之间既不合作也不竞争。不是独立行动，但有条件。

有许多情况可以被模拟成游戏，但是这样做没有多大意义。例如，代理人完全独立行动并且对彼此的效用没有影响的情况可以被建模为独立的单人游戏的集合。在这种情况下，代理人只是做他们想做的事情，最大化他们自己的效用，而不管其他代理人在做什么。EigenGame 并不完全是这样，但是从求解纳什均衡的角度来考虑这个问题就很能说明问题。就代理交互而言，EigenGame 是易处理的，因为它是一个微不足道的问题。在 EigenGame 中，玩家真的只有一个。在单人博弈中，就其他参与者而言，代理人没有策略，纳什均衡也没有定义。代理人的决策不能影响任何其他代理人增加他们的福利。需要注意的是，在一个对抗未来自我的游戏中，有两个玩家。

## 游戏的复杂性

在博弈论中，纳什均衡要么是混合策略，要么是纯策略，参与者分别随机选择不同的策略。计算博弈的近似混合纳什均衡，一般来说，是在复杂类 PPAD-complete⁵.据称，PPAD⁶指的是有向图上的多项式奇偶性论点，但有人怀疑这实际上是对引入复杂性类的帕帕迪米特里乌的含蓄提及。Christos Papadimitriou 是将算法透镜应用于科学领域的领军人物之一。PPAD 完全问题属于 NP 类，但不太可能属于 NP 完全类。NP 不太可能足以解决这类问题。也就是说，PPAD 完全问题不太可能像 NP 完全问题那样困难，但是没有已知的多项式时间算法来解决它们。PPAD 完备类中的其他问题，可简化为计算近似混合纳什均衡，包括求解在经济学中有应用的近似 Brouwer 不动点，以及在 Sperner 着色中寻找三色三角形，这是一个组合问题，在拓扑学中有应用。Sperner 引理隐含 Brouwer 不动点定理，Brouwer 不动点定理隐含 Nash equilibria⁷.的存在性在计算不动点和混合纳什均衡时需要近似，以使解是可计算的，因为精确解可能是需要无限精度的无理数。

PPAD 是全函数 NP (TFNP)复杂度类的子类。函数 NP (FNP)问题是与搜索相关的 NP 问题。TFNP 问题是完全的 FNP 问题，换句话说，是至少有一种解决办法的问题。例如，众所周知，对于所有有有限数量代理人的博弈，总是至少有一个纳什均衡。TFNP 的子类由用于保证有解的论证类型来区分。PPAD 是 TFNP 的子类，这里使用了宇称参数。奇偶性论证非常简单，它指出每个有限图都有偶数个奇数度的节点。如果存在一个奇数度节点，则必定存在另一个奇数度节点。

PPAD 被正式定义为它的一个完整的问题，即所谓的终点问题。使用线端，使用两个函数或电路来定义可能是指数的图，这两个函数或电路定义了一个节点是否认为另一个节点是其唯一的父节点以及一个节点是否认为另一个节点是其唯一的子节点。如果一个节点 A 认为另一个节点 B 是它唯一的子节点，而 B 认为 A 是它唯一的父节点，则在一对节点之间存在链接。节点最多有一个入度和一个出度。因此，诱导图由一组有向链、一组有向圈和一组独立节点组成。问题的输入是节点 0 的 id，它是源节点。如果节点 0 具有偶数奇偶校验，则不是 PPAD 问题。如果它的奇偶性为 1，这意味着由于奇偶性参数，在该行的末尾一定有另一个节点，并且肯定存在解决方案。目标是在链的末端找到另一个节点，但不一定是节点 0 的链。如果局限于节点 0 的 chain⁶.，该问题在计算上更加困难生产线末端的计算复杂性增加，因为链可能是指数级长。在 Sperner 着色中寻找三色三角形或 n+1 个着色的 n 维单形可以通过将其表示为线端问题来完成，并且可以从寻找近似 Brouwer 不动点和计算近似 Nash 均衡的问题进行简化。

具有混合纳什均衡的有限博弈和超过两个玩家或矩阵秩大于 two⁸的两个玩家双矩阵一般和博弈属于 PPAD-hard 类。

## 结论

EigenGame 不属于有向图 hard⁹.上的复杂性类多项式奇偶参数如果你把它公式化为一个游戏，它可以被看作是一个单人游戏⁰，尽管它是在一个分散的系统上解决的。博弈论关注的是多个参与者的战略互动。作者提供了一个收敛性的证明，这是一个好结果，但它与博弈论无关。该论文的结论是，k 玩家一般和游戏还没有得到很好的理解，作者希望 EigenGame 将推动博弈论和 PCA 的技术。就使用分散系统执行 PCA 而言，这是一项出色的工作，但它不会推进博弈论。

**更新**(2021 年 14 月 7 日):EigenGame 的作者在论文中说，EigenGame 指的是游戏和计算纳什均衡的算法。游戏参考附录 M.2 中的分析，其中没有等级。作者没有这样说，但是一旦施加了层次结构，用于计算 PCA 解的算法可以被视为用于解决分布式优化问题的过程。

[1] I. Gemp，B. McWilliams，C. Vernade & T. Graepel，EigenGame: PCA 作为纳什均衡(2021)，学习表征国际会议。

[2]该评论可在 https://www.amazon.com/review/R16RJ2PT63DZ3Q 的[查看。亚马逊不再支持评论评论，也不显示旧评论。](https://www.amazon.com/review/R16RJ2PT63DZ3Q)

[3] R. B .迈尔森，游戏理论。《冲突分析》(2013)，哈佛大学出版社。

[4]博弈论作为大规模数据分析的引擎:【https://deepmind.com/blog/article/EigenGame】T4

[5] C. Daskalakis，P.W. Goldberg 和 C.H. Papadimitriou，计算纳什均衡的复杂性(2009 年)，SIAM 计算杂志。39 (3): 195–259.doi:10.1137/070699652。

[6] C. Papadimitriou,《论奇偶性论证和其他低效存在证明的复杂性》( 1994 年),《计算机和系统科学杂志》。48 (3): 498–532.doi:10.1016/s 0022–0000(05)80063–7。

[7]参见康斯坦丁诺斯·达斯卡拉基斯关于 PPAD 的讲座:[https://www.youtube.com/watch?v=TUbfCY_8Dzs&t = 3879s](https://www.youtube.com/watch?v=TUbfCY_8Dzs&t=3879s)

[8] R. Mehta,“恒秩双矩阵游戏是 PPAD-硬的”( 2014 年),载于第 46 届 ACM 计算理论年会论文集，第 545–554 页。

[9]它也不在请填写完整的课程中。PLS-complete 是 TFNP 的另一个子类，包括具有纯纳什均衡的游戏，但是没有已知的多项式时间算法来求解它们。

[10]线性规划问题没有得到解决，因此它不能被视为两个参与者的零和游戏，其中一个参与者优化原始目标函数，而另一个参与者优化对偶目标函数。