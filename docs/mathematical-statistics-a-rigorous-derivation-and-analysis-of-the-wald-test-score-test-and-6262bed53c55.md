# 数理统计——沃尔德检验、分数检验和似然比检验的严格推导和分析

> 原文：<https://towardsdatascience.com/mathematical-statistics-a-rigorous-derivation-and-analysis-of-the-wald-test-score-test-and-6262bed53c55?source=collection_archive---------10----------------------->

## [思想和理论](https://towardsdatascience.com/tagged/thoughts-and-theory)

## 经典三位一体推理测试的推导与全计算机模拟

![](img/a4660ba7f0ec46b07ef75a0ece0d399a.png)

[绿色变色龙](https://unsplash.com/@craftedbygc?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

# **1:简介&动机**

假设我们正在进行一项推断统计分析。假设我们是从常客的角度出发。我们收集了一些数据，愿意对这些数据所来自的分布族进行参数假设，并使用这些数据来恢复一个无限制的最大似然估计(MLE)估计量:

![](img/c0c22c9e8063cbd9d014ac3afcd040a2.png)

作者图片

假设我们已经指定了以下假设检验:

![](img/121f0429c98b30e94157379a59ab66a3.png)

作者图片

我们需要一些程序来评估上述假设检验。在这篇文章中，我们将涵盖三个经典推理测试程序的“三位一体”:Wald 测试、Score 测试和似然比(LR)测试。

该作品旨在:

*   深入研究单变量和多变量情况下的这三个过程
*   从数学上证明在零假设的条件下，所有三个检验都渐近收敛于相同的结果
*   探索每种测试相对于其他两种测试的独特设计优势
*   从头开始进行完整的计算模拟，探索这三种技术

这篇文章的目录如下:

![](img/09a58abfc08612b00357ac8947a60817.png)

作者图片

# **2:复习林德伯格-利维 CLT、多元正态随机变量的二次型和德尔塔法**

为了推导 Wald、Score 和似然比检验的检验统计量的极限分布，我们需要复习林德伯格-李维中心极限定理(CLT)、多元正态随机变量的二次型和 Delta 方法:

## 林德伯格-李维中心极限定理(CLT):

让我们假设我们有:

![](img/079d3247457ea7658ea088c94bedf101.png)

作者图片

![](img/7cabc61a11be345f41c4e7c42e20d699.png)

作者图片

根据林德伯格-利维 CLT，我们有:

![](img/deec03c89a617fefaacdbf48476e4a46.png)

作者图片

关于证明林德伯格-列维 CLT 定理的深入推导，请参见我之前的文章: [***中心极限定理:证明&实际上是通过数学运算***](/central-limit-theorem-proofs-actually-working-through-the-math-a994cd582b33)

## 多元正态随机变量的二次型；

![](img/524df5b2f5e66dc34c317ceeb4e87670.png)

作者图片

让我们证明上面的公式:

![](img/c7b5c6a37b17a0628836003cc4c16226.png)

作者图片

## 德尔塔法:

假设我们有一个抽样估计量，我们知道它(通常通过 CLT)有一个带均值和方差的正态分布的极限分布。如果我们将某个新的抽样估计量指定为一个相对于我们原来的抽样估计量连续且可微的函数***【g()***，那么我们知道这个新的抽样估计量也有一个正态分布的极限分布。我们能够恢复这种新的抽样估计量的极限分布的方法是用增量法:

![](img/fa93a47f328fd51c93d9bcaa22888679.png)

作者图片

让我们证明上面的公式:

![](img/8833b69f0a11fe82d18e67612e1db827.png)

作者图片

有了上面的概念刷新器，我们就可以处理推理测试的公式了。我们将从沃尔德试验开始。

# **3:瓦尔德测试**

现在让我们来看三个推理测试中的第一个，Wald 测试:

![](img/7910e39626bccc26fdafdfdb5d15c53c.png)

作者图片

沃尔德检验统计量 ***W*** 为:

![](img/c6dfc38bcadb2620c71d60e03428d539.png)

作者图片

让我们证明在零的情况下 Wald 检验的极限分布是卡方分布:

![](img/63cd791c0d7edfcbf0895fae2fa504fb.png)

作者图片

# 4:分数测试

接下来，我们定义分数测试:

![](img/54c0aa817c8c74db321833798eae6cbe.png)

作者图片

我们现在证明了在零检验下 Score 检验的极限分布与 Wald 检验的极限分布相同:

![](img/f406e4f1e008f355f4351c5b82e73497.png)

作者图片

![](img/f1db9d0448c46d8eff3e9408f2362535.png)

作者图片

![](img/bec3e9d9a328dc1f4eb212e330affe33.png)

作者图片

# 5:似然比检验(LR)

最后，我们定义了似然比检验(LR):

![](img/c3d4e6e4a6b3a458f27fa0566adead06.png)

作者图片

我们现在证明 LR 检验的极限分布与 Wald 检验的极限分布相同。

注意，以下证明取决于零模型“嵌套”在无限制模型*内(即零模型是无限制模型的参数空间的限制)*。在非嵌套模型的情况下，请参见本篇的 S ***第 7 节*** 进行简要概述。

继续证明:

![](img/a472f2e192120cee27e53d30b35d73a4.png)

作者图片

![](img/fe54acb26ebb40eaccc833fd0d64bb87.png)

作者图片

![](img/0d027c648c3648b62180063e56dfb646.png)

作者图片

# 6:三位一体的测试——每个测试的设计优势

作为本文最后几节的总结，我们有以下三个推论检验的统计数据(在单变量和多变量情况下):

![](img/fd4cceaffe5394dd9c3676e447366d25.png)

作者图片

下图形象地总结了与无限制抽样估计量的抽样分布相关的三种方法:

![](img/43fd9af5d12c0f264b423413aac30a68.png)

作者图片

![](img/2de4f9ece289a1a235ffeafe85c67afd.png)

作者图片

我们让这三个推理测试都收敛到同一个渐近结果。有人可能会问***“……为什么我们需要三种不同的技术来完成同样的任务？谁在乎呢。?"*** 。这三种方法中的每一种都有一个“设计优势”,而其他两种则没有。假设一个人正在进行真实世界的分析。考虑到分析中遇到的挑战，三个推理测试之一的特定“设计优势”可能非常便于利用。为了方便起见，这将导致选择三个测试中的一个，而另外两个测试计算起来不那么简单。

## Wald 测试的设计优势:

在上表中，我们注意到 Wald 检验是无限制抽样估计量和该抽样估计量的抽样方差的严格函数。与分数检验和似然比检验不同，Wald 检验不涉及用观察数据评估似然函数的经验估计。因此，如果已经有了抽样估计量及其抽样方差的经验估计，就有了进行 Wald 检验所需的全部信息。即使无法访问用于生成抽样估计量的原始观测数据，情况也是如此！这是其他两种方法所缺乏的属性。

## 分数测试的设计优势:

为了进行 score 检验，我们需要对零陷下的 Score 函数(即对数似然函数的梯度)进行经验评估，以及零陷下的 Fisher 信息。请注意，这些指标都不是无限制抽样估计量的函数。因此，与 Wald 检验和似然比检验不同，Score 检验不要求我们有观测数据下的无限制抽样估计量的公式。如果这个非限制抽样估计量，不管出于什么原因，很难恢复估计值，那么分数检验是一个很好的选择。

## 似然比检验的设计优势:

从上表中可以看出，似然比检验需要通过非限制模型和限制模型中的观察数据对似然函数进行经验评估。然而，与 Wald 检验和 Score 检验不同，似然比检验不需要构建我们的抽样估计量的协方差矩阵(受限或其他)。因此，如果由于某种原因构建协方差矩阵很困难，则似然比测试可能比其他两个测试更容易执行。

# 7:关于非嵌套模型的似然比检验的注记

在教学环境中，人们经常宣称:

> “为了执行似然比测试，**必须**是零模型嵌套在无限制模型中的情况。”

**以上说法并不完全正确。**实际上可以对非嵌套模型进行似然比检验；它只是需要更仔细的数学思考，最终需要更多的工作。

在两个模型嵌套的情况下，我们不需要自己执行任何繁重的数学提升或数学推导来恢复我们的似然比检验统计量在零假设条件下的极限分布。相反，我们已经知道这个极限分布是什么；这是一个卡方分布，自由度是两个嵌套模型之间的自由度差！这正是我们上面展示的证明。已知极限分布后，我们就有了使用标准统计软件和库立即计算 p 值所需的所有信息。

现在，在两个感兴趣的模型**没有**嵌套的情况下，这并不意味着我们不能进行似然比测试。相反，如果我们选择执行一个似然比测试，我们就有动力根据我们自己的具体用例问题，在我们的零假设下，数学推导出似然比测试统计量的极限分布是什么:

![](img/255b98d3cbad7c47263d78969e6211f5.png)

作者图片

假设模型不是嵌套的，这个极限分布可能不是卡方分布；相反，它会是别的什么东西，它可能不是一个正式名称的发行版。但是，如果我们能够设法恢复这个分布是什么*(或者通过导出一个封闭的分析形式，或者利用一种方法进行采样，并从数字上构建一个经验估计)*，然后利用这个分布来进行我们的推理测试，那么这个过程将是一个完全有效的似然比测试。同样，这只是需要我们更多的定制工作。我们可能还需要在我们选择的统计编程语言中构建我们自己的定制函数来实现这个似然比测试，而不是利用标准库。

有关非嵌套模型的似然比测试的更多信息，请参见以下参考资料。该参考文献是统计学领域著名的高影响力论文，在学术文献中被引用超过 3000 次。值得一读，以深入研究这一材料！

[***【王庆海】(1989)。模型选择和非嵌套假设的似然比检验。计量经济学，307–333。***](https://authors.library.caltech.edu/83161/1/sswp605%20-%20published.pdf)

# 8:计算模拟

python 中提供了计算模拟，用于利用模拟数据集从头开始计算 Wald 测试、分数测试和似然比测试。

我们从导入我们需要的库开始

…和一个模拟数据集的函数

接下来，实现 Wald、分数和似然比测试的函数:

现在我们准备进行分析。让我们打印 python 中内置的“statsmodels”函数的结果:

…现在我们从头开始计算 Wald、分数和可能性比率测试结果:

将“statsmodels”函数的推断结果与我们为三位一体的推断测试定制的函数进行比较，我们可以看到得出的 p 值非常相似。这支持了三个感兴趣的测试都渐近收敛于相同结果的性质。

以上计算模拟的完整代码/笔记本，请看下面的 [**github 链接**](https://github.com/atrothman/Wald-Score-LR-simulation) 。

# 9:总结和结论

希望以上有见地。正如我在以前的一些文章中提到的，我认为没有足够的人花时间去做这些类型的练习。对我来说，这种基于理论的洞察力让我在实践中更容易使用方法。我个人的目标是鼓励该领域的其他人采取类似的方法。以后我会继续写类似的作品。请 [**订阅并关注我在 Medium**](https://anr248.medium.com/) 和 LinkedIn[](http://www.linkedin.com/in/andrew-rothman-49739630)**上的更新！**