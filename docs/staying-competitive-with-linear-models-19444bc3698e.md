# é€šè¿‡çº¿æ€§æ¨¡å‹ä¿æŒç«äº‰åŠ›

> åŸæ–‡ï¼š<https://towardsdatascience.com/staying-competitive-with-linear-models-19444bc3698e?source=collection_archive---------16----------------------->

## [å¯äº¤ä»£çš„ AI](https://medium.com/tag/explainable-ai)

## æœ‰äº†æ­£ç¡®çš„ç‰¹å¾ï¼Œçº¿æ€§æ¨¡å‹å¯ä»¥å˜æˆé‡å…½

![](img/e895b29418e9d733167a5aca6aea6d32.png)

ç…§ç‰‡ç”± [Z S](https://unsplash.com/@kovacsz1?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„

ä½œä¸ºä¸€åæ•°æ®ç§‘å­¦å®¶ï¼Œä½ æœ‰è®¸å¤šä¸åŒç±»å‹çš„é—ªäº®çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¯ä¾›é€‰æ‹©ã€‚æœ‰ç¥ç»ç½‘ç»œæ¨¡å‹ã€æ¢¯åº¦å¢å¼ºæ¨¡å‹ã€bagging æ¨¡å‹ï¼Œä»…ä¸¾å‡ ä¸ªä¸»è¦ç±»åˆ«ã€‚

åœ¨è¿™äº›å®¶ä¼™çš„é˜´å½±ä¸‹ï¼Œä¹Ÿå­˜åœ¨ç€åƒçº¿æ€§å’Œé€»è¾‘å›å½’è¿™æ ·çš„æ¨¡å‹ã€‚çº¿æ€§æ¨¡å‹é€šå¸¸åœ¨æœ€å¥½çš„æƒ…å†µä¸‹ä»…ä»…è¢«ç”¨ä½œåŸºçº¿ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹è¢«å–ç¬‘ã€‚ç„¶è€Œï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸åˆç†çš„ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘çš„è¯·æ±‚å¦‚ä¸‹:

![](img/8865dbe3c3eed58f0408674fe392dba8.png)

ä½œè€…åœ¨ imgflip.com åˆ›ä½œçš„ã€‚

è®©æˆ‘é€šè¿‡è€ƒè™‘**å›å½’ä»»åŠ¡**æ¥è§£é‡Šæˆ‘çš„æ„æ€ï¼Œä½†æ˜¯è®°ä½è¿™åŒæ ·é€‚ç”¨äºåˆ†ç±»ä»»åŠ¡ã€‚

é¦–å…ˆï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¸¦æœ‰**å**ç‰¹å¾çš„çº¿æ€§å›å½’ä¼šå¯¼è‡´ä»€ä¹ˆï¼Œè¿™æ ·æ‚¨å°±ä¸ä¼šä¸Šå½“ã€‚ç„¶åï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºçº¿æ€§å›å½’æ˜¯éå¸¸é€šç”¨çš„ï¼Œå¦‚æœç»™äºˆ**è‰¯å¥½çš„**ç‰¹æ€§ï¼Œå®ƒå¯ä»¥ç”¨äº**æ¨¡æ‹Ÿå¤æ‚çš„æ¨¡å‹**ã€‚æœ€åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨çº¿æ€§å›å½’è¿›è¡Œç®€å•æœ‰æ•ˆçš„æ—¶é—´åºåˆ—é¢„æµ‹ã€‚

## æ·»åŠ å¤šé¡¹å¼ç‰¹å¾(ä¸å¥½ï¼)

æˆ‘ä»¬å¯èƒ½å·²ç»å…¨éƒ¨å®Œæˆäº†ã€‚åˆ›å»ºæ–°è¦ç´ çš„ä¸€ç§æœ€å¸¸è§ã€æœ€ç®€å•ä½†ä¹Ÿæœ€å¯æ€•çš„æ–¹æ³•æ˜¯æ·»åŠ åŸºç¡€è¦ç´ çš„å¤šé¡¹å¼å¹‚ã€‚é™¤äº†åªä½¿ç”¨ç‰¹å¾ *x* ä¹‹å¤–ï¼Œæ‚¨è¿˜å¯ä»¥æ·»åŠ  *x* *ï¼Œx* *ï¼Œâ€¦* ä½œä¸ºç‰¹å¾ï¼Œç„¶åè¿›è¡Œå¤šå…ƒçº¿æ€§å›å½’ã€‚è®©æˆ‘ä»¬åœ¨ *x* ä¸­åˆ›å»ºä¸€ä¸ªéçº¿æ€§çš„å°å‹ä¸€ç»´æ•°æ®é›†æ¥è¯´æ˜è¿™ä¸€ç‚¹ï¼Œè¿™æ ·æ¯ä¸ªäººéƒ½åœ¨åŒä¸€é¡µä¸Šã€‚

```
import numpy as np

np.random.seed(123)

x = np.random.uniform(0, 10, 10)
y = 3*np.sin(x) + x + np.random.randn(10)
```

ä»¥ *x* ä¸ºå”¯ä¸€ç‰¹å¾çš„ç®€å•çº¿æ€§å›å½’äº§ç”Ÿä¸€æ¡ä¸å¤ªç¬¦åˆæ•°æ®çš„ç›´çº¿ã€‚

![](img/5c3794a49db78e55fb82f7496771e0a4.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ ä¸€äº›å››æ¬¡å¹‚çš„å¤šé¡¹å¼é¡¹ã€‚

```
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import make_pipeline

lr = make_pipeline(
    PolynomialFeatures(degree=4),
    LinearRegression()
)

lr.fit(x.reshape(-1, 1), y)
```

æˆ‘ä»¬å¾—åˆ°äº†è¿™ç§å¥‘åˆ:

![](img/6e0ea6766f872938db2a44ee00b04ce6.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¥½å¤šäº†ï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®`degree=9`å˜å¾—æ›´ç–¯ç‹‚ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœ:

![](img/858c340b6809da18380beea46e8c2675.png)

å¾ˆéš¾çœ‹å‡ºï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå®Œç¾çš„æ‹Ÿåˆï¼Œå®ƒé€šè¿‡æ‰€æœ‰çš„ç‚¹ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ›²çº¿*å›´ç»•*æ‘†åŠ¨å¾ˆå¤§ã€‚è®­ç»ƒé›†ä¸­çš„æ‰€æœ‰æ ‡ç­¾ *y* éƒ½åœ¨ 0 åˆ° 12 ä¹‹é—´ï¼Œä½†æ˜¯è¯¥æ¨¡å‹ä»¥æŸç§æ–¹å¼é¢„æµ‹å¤§çº¦*x*1 çš„å€¼å¤§äº 10.000ã€‚ä¸ºä»€ä¹ˆï¼Ÿ**å› ä¸ºå¤šé¡¹å¼ç‰¹æ€§ä¸å¥½ã€‚å¯æ‚²çš„æ˜¯ï¼Œè¿™é€šå¸¸æ˜¯çº¿æ€§å›å½’æ—…ç¨‹çš„ç»ˆç‚¹ã€‚**

> â€œçº¿æ€§æ¨¡å‹æ˜¯ç»™å­©å­ä»¬çœ‹çš„ï¼Œè®©æˆ‘ä»¬ç»§ç»­çœ‹å¥½çš„ä¸œè¥¿ã€‚æ¶‰åŠæ ‘æˆ–è€…å‰é¦ˆè¿æ¥çš„æ¨¡å‹ï¼Œä½ æ‡‚çš„ï¼â€â€”ä¹Ÿè®¸æ˜¯ä½ ï¼Ÿ

ç„¶è€Œï¼Œè®©æˆ‘å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆè¿™æ ·æƒ³æ˜¯é”™è¯¯çš„ã€‚å¯ä»¥åˆ›å»ºè¡Œä¸ºå®Œå…¨ç±»ä¼¼äºç¥ç»ç½‘ç»œçš„çº¿æ€§æ¨¡å‹æˆ–åŸºäºå†³ç­–æ ‘çš„æ¨¡å‹ã€‚ä½ åªéœ€è¦*å¥½çš„*ç‰¹æ€§ï¼Œè€Œä¸æ˜¯å¤šé¡¹å¼ç‰¹æ€§ã€‚

# æ¨¡æ‹Ÿé«˜çº§æ¨¡å‹

## ç¥ç»ç½‘ç»œ

å¿«é€Ÿæé†’ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„å‰é¦ˆç¥ç»ç½‘ç»œçš„ä¾‹å­ï¼Œå®ƒæœ‰ä¸€ä¸ªå¤§å°ä¸º 3 çš„éšè—å±‚ï¼Œå°†ä¸€ä¸ªæ•°å­— *x* ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ªå€¼ *y* (æ²¡æœ‰åå·®):

![](img/0ae139d20565326255c862b4b0ebed9a.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¯ä»¥çœ‹åˆ° *x* è¿›å…¥ç¥ç»ç½‘ç»œã€‚ç„¶åä½¿ç”¨ä¸‰ç§ä¸åŒçš„å˜æ¢å¯¹å…¶è¿›è¡Œå˜æ¢ *T* â‚ã€ *T* â‚‚å’Œ *T* â‚ƒï¼Œç•™ç»™æˆ‘ä»¬ä¸‰ä¸ªæ–°å€¼*x*â‚=*t*â‚(*x*)ã€*x*â‚‚=*t*â‚‚(*x*å’Œ *x* â‚ƒ = ã€T36 è¿™äº›å˜æ¢é€šå¸¸æ¶‰åŠä¹˜æ³•ã€æ±‚å’Œä»¥åŠæŸç§éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå¦‚ [ReLU](https://en.wikipedia.org/wiki/Rectifier_(neural_networks)) æˆ– [Sigmoid](https://en.wikipedia.org/wiki/Sigmoid_function) ã€‚

ç„¶åï¼Œè¿™ä¸‰ä¸ªå¯¼å‡ºå€¼è¢«ç”¨ä½œç¥ç»ç½‘ç»œæœ€åä¸€æ­¥çš„è¾“å…¥:å°†å®ƒä»¬ä¹˜ä»¥ä¸€äº›å€¼ *Î±* ï¼Œç„¶åå°†æ‰€æœ‰å€¼ç›¸åŠ ã€‚å› æ­¤ï¼Œæœ€ç»ˆçš„è¾“å‡ºæ˜¯*y*=*Î±*â‚*x*â‚+*Î±*â‚‚*x*â‚‚+*Î±*â‚ƒ*x*â‚ƒ=*Î±*â‚*t*â‚(*x*+*Î±ã€t67*

> è§‚å¯Ÿæœ€åä¸€ä¸ªç­‰å¼æ˜¯å¦‚ä½•åœ¨ä¸‰ä¸ªæ–°ç‰¹æ€§ *x* â‚ã€ *x* â‚‚å’Œ *x* â‚ƒä¸­åªæ˜¯ä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼

è¿™å°±æ˜¯ç¥ç»ç½‘ç»œçš„ç¥å¥‡ä¹‹å¤„:ç‰¹å¾æ˜¯è‡ªåŠ¨ç»„è£…çš„ã€‚æˆ‘ä»¬ä¸å¿…åƒå¤„ç†å¤šé¡¹å¼ç‰¹å¾é‚£æ ·æ‰‹å·¥åˆ¶ä½œå®ƒä»¬ï¼Œè€Œæ˜¯ç”±ç½‘ç»œæ¥å­¦ä¹ å®ƒä»¬ã€‚ä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬å¾—åˆ°äº†è¿™äº›æ–°çš„ç‰¹å¾ï¼Œæœ€åä¸€æ­¥å°±æ˜¯è¿è¡Œä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä½¿ç”¨å°ç©å…·æ•°æ®é›†çš„å…·ä½“ä¾‹å­ã€‚

```
from sklearn.neural_network import MLPRegressor

mlpr = MLPRegressor(
    hidden_layer_sizes=(3,),
    random_state=142,
    max_iter=10000
)
mlpr.fit(x.reshape(-1, 1), y)
```

è¿™ä¼šäº§ç”Ÿä»¥ä¸‹è¾“å‡º:

![](img/556f603ef9331c2f16bbcfa1cd94da9f.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™ä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œä½†ç°åœ¨æˆ‘å£°ç§°ï¼Œå½“ä½¿ç”¨æ­£ç¡®çš„ç‰¹æ€§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„çº¿æ€§å›å½’æ¥é‡æ–°åˆ›å»ºè¿™ä¸ªè¾“å‡ºã€‚è€Œæˆ‘ä»¬å¯ä»¥ä»è®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œä¸­å¾—åˆ°è¿™äº›ç‰¹å¾ã€‚ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿäº†ç¥ç»ç½‘ç»œåœ¨ä¸­é—´éƒ¨åˆ†æ‰€åšçš„äº‹æƒ…:å®ƒå°†æˆ‘ä»¬çš„ 10 ä¸ªä¸€ç»´è¾“å…¥æ ·æœ¬è½¬æ¢ä¸º 10 ä¸ªä¸‰ç»´æ™ºèƒ½è¾“å…¥æ ·æœ¬ã€‚

```
transformation_coefs = mlpr.coefs_[0]
transformation_biases = mlpr.intercepts_[0]
x_linear_transformation = x.reshape(-1, 1) @ transformation_coefs + transformation_biases # linear transformation
x_clever = np.maximum(x_linear_transformation, 0) # ReLU
```

ä»å›¾å½¢ä¸Šçœ‹ï¼Œè¿™ç§æƒ…å†µä¼šå‘ç”Ÿ:

![](img/61b2854d9284bda33df1c55022a774a9.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æˆ‘ä»¬ç°åœ¨å¯ä»¥ç”¨`x_clever`ä»£æ›¿`x`æ¥è®­ç»ƒä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ã€‚ç»“æœå¦‚ä¸‹:

![](img/79993b80c41b5eea9a6dd7c760e2b3e9.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¯·æ³¨æ„ï¼Œçº¿æ€§å›å½’æ‹Ÿåˆç•¥æœ‰ä¸åŒã€‚äº‹å®è¯æ˜ï¼Œå®ƒå¯¹è®­ç»ƒæ•°æ®çš„è·Ÿè¸ªç”šè‡³æ¯”ç¥ç»ç½‘ç»œçš„è¾“å‡ºæ›´å¥½ï¼è¿™æ˜¯å› ä¸ºç¥ç»ç½‘ç»œå¿…é¡»ä¸€æ¬¡ä¼˜åŒ–è®¸å¤šå‚æ•°â€”â€”å®ƒå¿…é¡»ä¸“æ³¨äºç‰¹å¾åˆ›å»º**å’Œ**æœ€ç»ˆçš„å®é™…çº¿æ€§å›å½’ã€‚ç‰¹åˆ«æ˜¯ç¬¬ä¸€æ­¥è¦å¯¹éº»çƒ¦è´Ÿè´£ï¼Œå› ä¸ºå®ƒä½¿æ‹Ÿåˆè¿‡ç¨‹ä¼˜åŒ–éå‡¸å‡½æ•°ï¼Œè¿™æ˜¯å›°éš¾çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œæ‰¾åˆ°çº¿æ€§å›å½’çš„æœ€ä½³å‚æ•°å¾ˆå®¹æ˜“ã€‚

å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æé«˜ä¸€ç‚¹ç‚¹æ€§èƒ½ï¼Œè‡³å°‘åœ¨è®­ç»ƒé›†ä¸Šã€‚æˆ‘ä»¬ä»ç„¶è¦å°å¿ƒè¿‡åº¦æ‹Ÿåˆï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œçš„ä¸»é¢˜ã€‚**å…³é”®æ˜¯:æœ‰äº†æ­£ç¡®çš„ç‰¹å¾ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå»ºç«‹ä¸€ä¸ªåƒç¥ç»ç½‘ç»œä¸€æ ·å¥½çš„æ¨¡å‹ã€‚**

æˆ‘å·²ç»å¬ä½ è¯´è¿‡äº†:

> â€œå¥½å§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆè®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œã€‚ç„¶åï¼Œæˆ‘ä»¬ä»ä¸­æå–ç‰¹å¾æ¥è®­ç»ƒä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼Œå®ƒå’ŒåŸå§‹çš„ç¥ç»ç½‘ç»œä¸€æ ·å¥½ã€‚ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ç¥ç»ç½‘ç»œï¼Ÿâ€

ä½ æ˜¯å¯¹çš„ã€‚æˆ‘ä»¬æŠ•å…¥äº†æ›´å¤šçš„å·¥ä½œæ¥åˆ›å»ºä¸€ä¸ªä¸åŸå§‹ç¥ç»ç½‘ç»œä¸€æ ·å¥½çš„çº¿æ€§æ¨¡å‹ã€‚ä½†æ˜¯æˆ‘ä»æ¥æ²¡æœ‰è¯´è¿‡æ‰¾åˆ°å¥½çš„ç‰¹æ€§æ˜¯å®¹æ˜“çš„ã€‚è¿™å®é™…ä¸Šæ˜¯å»ºæ¨¡æœ€éš¾çš„éƒ¨åˆ†ã€‚

è‰ºæœ¯æ˜¯æƒ³å‡ºå¥½çš„ç‰¹å¾ï¼Œè€Œä¸å¿…çª¥è§†ä¸€äº›ç¥ç»ç½‘ç»œæ­£åœ¨åšä»€ä¹ˆã€‚è¿™äº›ç‰¹å¾ä¹Ÿå¯èƒ½çœ‹èµ·æ¥ä¸ç¥ç»ç½‘ç»œåˆ›å»ºçš„å®Œå…¨ä¸åŒã€‚æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨ ReLU å‡½æ•°æˆ–è€…ç±»ä¼¼çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œsin( *x* )å°†æˆä¸ºä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ï¼Œå› ä¸ºæˆ‘ä»¬ç”šè‡³åœ¨æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨äº†å®ƒã€‚

æ€»ä¹‹ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨çº¿æ€§å›å½’æ¥æ¨¡æ‹Ÿç¥ç»ç½‘ç»œçš„è¾“å‡ºã€‚ç°åœ¨è®©æˆ‘ä»¬è½¬å‘æ ‘æœ¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨é‚£é‡ŒåšåŒæ ·çš„äº‹æƒ…ï¼

## å†³ç­–æ ‘

æˆ‘ä¸ä¼šä»‹ç»å†³ç­–æ ‘æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå› ä¸ºæœ‰å¾ˆå¤šå¾ˆå¥½çš„èµ„æºå¯ä»¥è®©ä½ é‡æ¸©è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚ä½ åªéœ€è¦çŸ¥é“å†³ç­–æ ‘è¾“å‡ºåˆ†æ®µå¸¸æ•°å‡½æ•°ã€‚è®©æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªæ·±åº¦ä¸º 2 çš„å†³ç­–æ ‘ã€‚

```
from sklearn.tree import DecisionTreeRegressor

dt = DecisionTreeRegressor(max_depth=2)
dt.fit(x.reshape(-1, 1), y)
```

ç»“æœæ˜¯å…·æœ‰(æœ€å¤š)ä¸ª 2^max_depth ä¸åŒå€¼çš„åˆ†æ®µå¸¸æ•°å‡½æ•°ã€‚

![](img/00e972629111556b9a4d0724aa59c490.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä¸ºäº†æå–å…è®¸æˆ‘ä»¬æ¨¡æ‹Ÿè¿™ä¸ªå‡½æ•°çš„ç‰¹å¾ï¼Œå‡½æ•°å€¼å˜åŒ–çš„ç‚¹â€”â€”åˆ†è£‚ç‚¹*â€”*â€”æ˜¯å¾ˆé‡è¦çš„ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å¾—åˆ°å®ƒä»¬:

```
from sklearn.tree import plot_tree

plot_tree(dt)
```

![](img/81fb6bd2f9f29eeb43f736ec49f3bb82.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æ­¤å¤–ï¼Œè®©æˆ‘ä»¬åœ¨-âˆå’Œâˆå¤„å†å¢åŠ ä¸¤ç‚¹ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨(-âˆï¼Œ4.08ï¼Œ6.18ï¼Œ6.91ï¼Œâˆ)å¤„æœ‰åˆ†è£‚ç‚¹ï¼Œæˆ‘ä»¬åˆ›å»ºçš„ç‰¹å¾å°†å¦‚ä¸‹æ‰€ç¤º:

![](img/1fac3a693bba1213b94f1d1ab974c177.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å…¶ä¸­( *a* â‚=-âˆ *ï¼Œa* â‚‚ *ï¼Œa* â‚ƒ,â€¦ï¼Œâˆ)ä¸ºæ‹†åˆ†ç‚¹ï¼Œå‡åºæ’åˆ—ã€‚

> ***æ³¨:*** *è¿™åŸºæœ¬ä¸Šæ„å‘³ç€æˆ‘ä»¬ bin äº†æ ·æœ¬ï¼Œè§ä¸‹å›¾ã€‚*

å¯¹äºç†ŠçŒ«ï¼Œä½ å¯ä»¥è¿™æ ·åš:

```
import pandas as pd

split_points = [-np.inf, 4.076, 6.181, 6.906, np.inf]

x_clever = pd.get_dummies(
    pd.cut(
        x,
        bins=split_points),
    prefix='x'
)
```

![](img/e91454c9c99ea9aca1b14a0816e830ac.png)

ä½¿ç”¨è¿™äº›æ–°ç‰¹æ€§è¿›è¡Œçº¿æ€§å›å½’ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°:

![](img/b7b7b3c46bd9b073bfe6a4be46bfbeed.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æ— æ³•åŒºåˆ†åŸå§‹æ¨¡å‹å’Œçº¿æ€§æ¨¡å‹ï¼Œå®ƒä»¬å®Œå…¨ç›¸åŒã€‚è¿™æ˜¯å› ä¸ºå†³ç­–æ ‘ä¸åƒç¥ç»ç½‘ç»œé‚£æ ·æœ‰æ•°å­—ä¸Šçš„å›°éš¾ã€‚**äºæ˜¯ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•ç”¨çº¿æ€§å›å½’æ¨¡æ‹Ÿå•ä¸ªå†³ç­–æ ‘ï¼**

å†æ¬¡å¼ºè°ƒ:æƒ³å‡ºè¿™äº›ç‰¹æ€§å¹¶ä¸å®¹æ˜“ï¼Œä½†æ˜¯ä¸€æ—¦ä½ æ‹¥æœ‰äº†å®ƒä»¬ï¼Œä¸€åˆ‡éƒ½å˜å¾—ç®€å•äº†ã€‚

æˆ‘ä»¬ç”šè‡³å¯ä»¥ä»è¿™é‡Œç»§ç»­:éšæœºæ£®æ—ã€AdaBoostã€æ¢¯åº¦å¢å¼ºã€é¢å¤–çš„æ ‘â€¦â€¦éƒ½åªæ˜¯å…·æœ‰ç‰¹æ®Šæƒé‡çš„å†³ç­–æ ‘çš„æ€»å’Œã€‚åˆ†æ®µå¸¸æ•°å‡½æ•°çš„å’Œä¹Ÿæ˜¯åˆ†æ®µå¸¸æ•°å‡½æ•°ï¼Œåªæ˜¯å¯èƒ½æœ‰æ›´å¤šçš„åˆ†è£‚ç‚¹ã€‚**è¿™æ„å‘³ç€ï¼Œåªè¦æœ‰åˆé€‚çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨çº¿æ€§æ¨¡å‹æ¨¡æ‹Ÿè¿™äº›æ›´é«˜çº§çš„æ ‘æ¨¡å‹ï¼**

# æ—¶é—´æ•°åˆ—é¢„æµ‹æ³•

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å¤„ç†äº†å¾ˆå¤šæŠ½è±¡çš„ä¸œè¥¿ã€‚ç†è®ºä¸Šï¼Œçº¿æ€§æ¨¡å‹å’Œæ›´å¤æ‚çš„æ¨¡å‹ä¸€æ ·å¥½ï¼Œåªè¦æœ‰æ­£ç¡®çš„ç‰¹å¾ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œæˆ–åŸºäºæ ‘çš„æ¨¡å‹ï¼Œè¿™äº›æ­£ç¡®çš„ç‰¹å¾ä¼šæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ

æˆ‘è®¤ä¸ºä¸€ä¸ªç®€å•ä½†éå¸¸æœ‰ç”¨çš„é¢†åŸŸæ˜¯**æ—¶é—´åºåˆ—é¢„æµ‹**ï¼Œè¿™æ˜¯ä¸€é¡¹åœ¨ä½ çš„æ—¥å¸¸æ•°æ®ç§‘å­¦å·¥ä½œä¸­ç»å¸¸å‡ºç°çš„ç»ƒä¹ ã€‚

## æ•°æ®

ç°åœ¨è®©æˆ‘ä»¬ç”¨ä¸€äº›çœŸå®çš„æ•°æ®ã€‚é¦–å…ˆï¼Œé€šè¿‡`!pip install sktime`å®‰è£… sktimeï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„æ—¶é—´åºåˆ—é¢„æµ‹åº“ã€‚æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„èˆªç©ºä¹˜å®¢æ•°æ®é›†:

```
from sktime.datasets import load_airline

y = load_airline()
```

æ•°æ®çœ‹èµ·æ¥åƒè¿™æ ·:

![](img/272706e185ef629853d44c31910819f0.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æœ‰ä¸¤ä»¶äº‹åº”è¯¥å¼•èµ·ä½ çš„æ³¨æ„:

1.  æœ‰ä¸Šå‡è¶‹åŠ¿ï¼Œè€Œä¸”
2.  æ¯å¹´éƒ½æœ‰å­£èŠ‚æ€§ã€‚

å¦‚æœäººä»¬æƒ³åšä¸€ä¸ªé¢„æµ‹ï¼Œé€šå¸¸ä»–ä»¬ä¼šé€‰æ‹©ç»Ÿè®¡æ–¹æ³•ï¼Œæ¯”å¦‚ ARIMA T2ã€è¨é‡Œç›ã€è¨é‡Œç›â€¦â€¦ä½†æ˜¯æˆ‘ä¸å¤ªå–œæ¬¢è¿™äº›æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬å¤ªå¤æ‚äº†ã€‚è®©æˆ‘ä»¬åšä¸€äº›ç®€å•çš„äº‹æƒ…ï¼Œç”¨å¯è§£é‡Šçš„ç‰¹æ€§å’Œä¸€ä¸ªç®€å•çš„çº¿æ€§æ¨¡å‹ã€‚

## ç®€å•çš„çº¿æ€§æ¨¡å‹

ä¸ºäº†æ•æ‰ä¸Šå‡è¶‹åŠ¿ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‘ä¸Šè®¡æ•°çš„ç‰¹å¾ã€‚æœ€æ—©çš„è§‚å¯Ÿå€¼â€”åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ 1949 å¹´ 1 æœˆâ€”å¾—åˆ°å€¼ 0ï¼Œ1949 å¹´ 2 æœˆå¾—åˆ°å€¼ 1ï¼Œ1949 å¹´ 3 æœˆå¾—åˆ°å€¼ 3ï¼Œâ€¦åœ¨ä»£ç ä¸­:

```
import numpy as np
from sklearn.linear_model import LinearRegression

x = np.arange(len(y)).reshape(-1, 1)
lr = LinearRegression().fit(x, y)

y_forecast = pd.Series(lr.predict(x), index=y.index)
```

ç»“æœçœ‹èµ·æ¥åƒè¿™æ ·:

![](img/3f9828b4680559d8262a77f0610cac3c.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å®ƒçœ‹èµ·æ¥å¹¶ä¸å¯æ€•ï¼Œå°¤å…¶æ˜¯è€ƒè™‘åˆ°æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢åªæ·»åŠ äº†ä¸€ä¸ªå•ä¸€çš„åŠŸèƒ½ã€‚è¦æ¨¡æ‹Ÿæ¯å¹´çš„å­£èŠ‚æ€§ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªæœˆåˆ›å»ºä¸€ä¸ªçƒ­ç¼–ç å˜é‡ï¼Œä¸€ä¸ªä¾‹å­æ˜¯ç‰¹å¾â€œmonth_5 â€,å®ƒåœ¨ç¬¬ 5 ä¸ªæœˆ(5 æœˆ)çš„å€¼ä¸º 1ï¼Œåœ¨å…¶ä»–æœˆä»½çš„å€¼ä¸º 0ã€‚ä½ å¯ä»¥è¿™æ ·åš:

```
X = pd.get_dummies(y.index.month, prefix='month')
X['trend'] = range(len(y))
X.index = y.index
```

![](img/21440526d0a24183fc38efb82e2a015d.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™äº›éƒ½æ˜¯éå¸¸ä¾¿å®œçš„ç‰¹å¾ï¼Œä½†æ˜¯çœ‹çœ‹åŸºäºå®ƒä»¬è®­ç»ƒçš„çº¿æ€§æ¨¡å‹ç»™æˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆ:

![](img/e475ac049fefa046e6333f6918807625.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™ç›¸å½“ä¸é”™ã€‚æ¨¡å‹æ•æ‰åˆ°äº†è¶‹åŠ¿å’Œå­£èŠ‚æ€§ï¼Œå¾ˆå®¹æ˜“å°†è¿™æ¡æ›²çº¿å»¶ç»­åˆ°æœªæ¥ã€‚ç„¶è€Œï¼Œåªæœ‰æœ€åä¸€ä¸ªæŒ‘æˆ˜:å­£èŠ‚æ€§çš„å¼ºåº¦éšç€æ—¶é—´çš„æ¨ç§»è€Œå¢åŠ ã€‚æˆ‘ä»¬çš„æ¨¡å‹å°½äº†æœ€å¤§åŠªåŠ›ï¼Œä½†åœ¨å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬çš„æ¨¡å‹*åœ¨*é™„è¿‘æ‘†åŠ¨å¾—æ›´å¼ºï¼Œæœ€åæ¯”åŸå§‹æ—¶é—´åºåˆ—æ›´å¼±ã€‚è¿™æ˜¯æˆ‘ä»¬æ— æ³•ç”¨æ›´å¤šçš„åŠŸèƒ½æ¥è§£å†³çš„ã€‚ä½†æ˜¯å¤„ç†è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯

1.  ç”¨å¯¹æ•°å˜æ¢åŸå§‹æ ‡ç­¾`y`ï¼Œ
2.  å¯¹è¿™ä¸ªæ–°æ•°æ®é›†ä½¿ç”¨çº¿æ€§å›å½’ï¼Œç„¶å
3.  ä½¿ç”¨æ±‚å¹‚è¿ç®—å°†é¢„æµ‹å€¼è½¬æ¢å›æ¥ã€‚

åœ¨ scikit ä¸­æœ‰ä¸€ä¸ªç®€æ´çš„æ–¹æ³•â€”â€”å­¦ä¹ å®ç°è¿™ä¸‰ä¸ªæ­¥éª¤ï¼Œè€Œä¸éœ€è¦å¤ªå¤šçš„å¼€é”€å¹¶è·Ÿè¸ªè½¬æ¢:

```
from sklearn.compose import TransformedTargetRegressor
from sklearn.linear_model import LinearRegression

lr = TransformedTargetRegressor(
    regressor=LinearRegression(),
    func=np.log, # use logarithm on the no. of passengers
    inverse_func=np.exp # transform the data back with exp
)

lr.fit(X, y)
```

ç„¶è€Œï¼Œç»“æœæ˜¯æƒŠäººçš„ï¼Œåœ¨è®­ç»ƒé›†ä¸Š *r* ä¸º 0.98ï¼Œ**ã€‚**

![](img/98ac39ccee06fd92c2034c9a8bd985e8.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æˆ‘å¸Œæœ›ä½ èƒ½äº«å—è¿™æœ‰å¤šæ£’ï¼è¯¥æ¨¡å‹ä»ç„¶æ˜¯ä¸€ä¸ªç®€å•çš„çº¿æ€§æ¨¡å‹ï¼Œå³ä½¿è¿›è¡Œäº†å˜æ¢ã€‚æ­¤å¤–ï¼Œæ„å»ºç‰¹å¾æ˜¯çç¢çš„ï¼Œç„¶è€Œç»“æœæ˜¯æå…¶ç²¾ç¡®çš„ã€‚åƒè¿™æ ·çš„æ¨¡å‹æ˜¯é»„é‡‘ã€‚

![](img/146173e702a50f8f5170a195d72b89d8.png)

å®Œæ•´çš„æ¨¡å‹ï¼Œç®€åŒ–çš„ç¬¦å·ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä½ ç”šè‡³å¯ä»¥åˆ›å»ºä¸€ä¸ªæ›´é•¿çš„æ—¶é—´èŒƒå›´ï¼Œå¹¶è·å¾—é¢„æµ‹ã€‚

```
future = pd.date_range(
    start='1949-01-01',
    end='2021-12-31',
    freq='M'
)

X_future = pd.get_dummies(future.month, prefix='month')
X_future['trend'] = range(len(future))
X_future.index = future
```

å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ªè¾“å…¥æ¨¡å‹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ° 1949 å¹´ 1 æœˆåˆ° 2021 å¹´ 12 æœˆä¹‹é—´çš„é¢„æµ‹ã€‚

![](img/cba3a2e7bfe33f697477e14aff9bee06.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æ ¹æ®è¯¥æ¨¡å‹ï¼Œæˆ‘ä»¬ä»Šå¹´çš„èˆªç­ä¹˜å®¢äººæ•°å°†æ¥è¿‘ 100 ä¸‡ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæ¨¡å‹è¢«è¾“å…¥äº†éå¸¸æ—§çš„è®­ç»ƒæ•°æ®ï¼Œè€Œä¸”å®ƒä¹Ÿä¸äº†è§£æ–°å† è‚ºç‚ï¼Œæ‰€ä»¥å¯¹è¿™ä¸ªé¢„æµ‹æœ‰å¾ˆå¤§çš„æ€€ç–‘ã€‚æ ¹æ®æˆ‘æ‰¾åˆ°çš„æ•°å­—ï¼Œåœ¨ Covid ä¹‹å‰ï¼Œ2019 å¹´æ¯æœˆçº¦æœ‰ 40 ä¸‡åèˆªç©ºä¹˜å®¢ã€‚æˆ‘ä»¬çš„æ¨¡å‹è¯´çš„æ˜¯ 60 ä¸‡å·¦å³çš„ä¸œè¥¿ï¼Œè‡³å°‘å’ŒçœŸç›¸å·®ä¸å¤šä¸€ä¸ªé‡çº§ã€‚ä½†è¿™è¯´æ˜è¿‡å»çš„å¢é•¿æ¯”ç°åœ¨é«˜ï¼Œæ˜¯æœ‰é“ç†çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯¥æ¨¡å‹é«˜ä¼°äº†çœŸå®çš„èˆªç©ºä¹˜å®¢æ•°é‡ã€‚

# ç»“è®º

æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå°±æ€§èƒ½è€Œè¨€ï¼Œè¯´çº¿æ€§æ¨¡å‹ä¸å¥½è€Œå¤æ‚æ¨¡å‹å¥½é€šå¸¸æ˜¯é”™è¯¯çš„ã€‚é€šè¿‡æ­£ç¡®çš„åŠŸèƒ½ï¼Œçº¿æ€§æ¨¡å‹å¯ä»¥åƒç¥ç»ç½‘ç»œæˆ–æ¢¯åº¦æ¨è¿›ä¸€æ ·æ‰§è¡Œã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ‰¾åˆ°è¿™æ ·çš„ä¼˜ç‚¹å¾ˆéš¾ï¼Œä½†è¿™ä¹Ÿæ˜¯è¿™ä»½å·¥ä½œæœ‰è¶£çš„åœ°æ–¹ã€‚å¦‚æœå¯¹åŸå§‹æ•°æ®è¿›è¡Œç®€å•çš„*æ‹Ÿåˆ/é¢„æµ‹*å°±è¶³å¤Ÿäº†ï¼Œè®¸å¤šæ•°æ®ç§‘å­¦å®¶å¯èƒ½æ˜å¤©å°±ä¼šå¤±ä¸šã€‚

è™½ç„¶æœ‰æ—¶å€™æƒ³å‡ºå¥½çš„ç‰¹æ€§å¾ˆå®¹æ˜“ã€‚å½“å¤„ç†æ—¶é—´åºåˆ—æ•°æ®æ—¶ï¼Œä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹æ˜¯æ·»åŠ æœˆä»½ã€æ˜ŸæœŸå‡ ã€æ˜ŸæœŸå‡ ã€‚æˆ–è€…åƒåœ£è¯èŠ‚ã€å¤æ´»èŠ‚ã€é»‘è‰²æ˜ŸæœŸäº”è¿™æ ·çš„ç‰¹æ®Šæ—¥å­ã€‚åŒ…å«ä¸€ä¸ªè¶‹åŠ¿ç‰¹å¾ä¹Ÿæ˜¯å¾ˆå¥½çš„ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªä»é›¶åˆ°è§‚æµ‹å€¼å‡ä¸€çš„æ•°ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨é£æœºä¹˜å®¢çš„ä¾‹å­ä¸­æ‰€çœ‹åˆ°çš„ã€‚ä½†è¿™åªèƒ½è®©æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªçº¿æ€§è¶‹åŠ¿ã€‚æˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ ä¸€ä¸ªäºŒæ¬¡æˆ–æ ¹è¶‹åŠ¿ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯åº”ç”¨ä¸€äº›ç®€å•çš„å‡½æ•°ï¼Œä¾‹å¦‚ï¼Œ0ï¼Œ1ï¼Œ4ï¼Œ9ï¼Œâ€¦ï¼Œï¼Œ(#observations-1)ã€‚æ‰¾åˆ°æ­£ç¡®çš„æŒ‡æ•°ï¼Œè®©å®ƒæˆä¸º 1ã€2ã€0.5 æˆ–å…¶ä»–å€¼æ˜¯è¶…å‚æ•°è°ƒæ•´çš„å…¸å‹ç”¨ä¾‹ï¼Œæ‚¨ä¸å¿…æ‰‹åŠ¨å°è¯•æ‰€æœ‰ä¸œè¥¿ã€‚

å› æ­¤ï¼Œç²¾å¿ƒåˆ¶ä½œä¸€äº›æœ‰æ„ä¹‰çš„ç‰¹æ€§ï¼Œå°è¯•ä¸€ä¸‹çº¿æ€§æ¨¡å‹ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œè¯¥æ¨¡å‹æ˜“äºè§£é‡Šï¼Œå¿«é€Ÿä¸”å¥å£®ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥ç¡®ä¿çº¿æ€§å›å½’é€‚ç”¨äºæ¯ç§ç¼–ç¨‹è¯­è¨€ã€‚è¿™æ˜¯**è€Œä¸æ˜¯**åƒ [CatBoost](https://catboost.ai/) ç­‰é«˜çº§æ¨¡å‹çš„æƒ…å†µã€‚

æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„ã€æœ‰ç”¨çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼

**ä½œä¸ºæœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ **

1.  **æƒ³æ”¯æŒæˆ‘å¤šå†™ç‚¹æœºå™¨å­¦ä¹ å’Œ**
2.  **æ— è®ºå¦‚ä½•éƒ½è¦è®¡åˆ’è·å¾—ä¸­ç­‰è®¢é˜…é‡ï¼Œ**

**ä¸ºä»€ä¹ˆä¸åš** [**é€šè¿‡è¿™ä¸ªç¯èŠ‚**](https://dr-robert-kuebler.medium.com/membership) **ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š**

é€æ˜åœ°è¯´ï¼Œç»™ä½ çš„ä»·æ ¼ä¸å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç›´æ¥å½’æˆ‘ã€‚

éå¸¸æ„Ÿè°¢ï¼Œå¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘çš„è¯ï¼

> *å¦‚æœ‰é—®é¢˜ï¼Œè¯·åœ¨* [*LinkedIn*](https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/) *ä¸Šå†™æˆ‘ï¼*