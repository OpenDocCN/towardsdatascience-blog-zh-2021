# ğŸš€PyCaret äºŒå…ƒåˆ†ç±»ç®€ä»‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/introduction-to-binary-classification-with-pycaret-a37b3e89ad8d?source=collection_archive---------4----------------------->

## ä½¿ç”¨ PyCaret çš„ Python äºŒè¿›åˆ¶åˆ†ç±»çš„å¾ªåºæ¸è¿›çš„åˆå­¦è€…å‹å¥½æ•™ç¨‹

![](img/0578627aa4cdc48224703e13bd058e92.png)

åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šç”±[éº¦å…‹ U](https://unsplash.com/@roguewild?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„ç…§ç‰‡

# 1.0 ç®€ä»‹

[PyCaret](https://www.pycaret.org) æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„å¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚è¿™æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ å’Œæ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æˆå€åœ°åŠ å¿«å®éªŒå‘¨æœŸï¼Œæé«˜æ‚¨çš„å·¥ä½œæ•ˆç‡ã€‚

ä¸å…¶ä»–å¼€æºæœºå™¨å­¦ä¹ åº“ç›¸æ¯”ï¼ŒPyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨æ¥ç”¨å‡ è¡Œä»£ç æ›¿æ¢æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå¿«é€Ÿæœ‰æ•ˆã€‚PyCaret æœ¬è´¨ä¸Šæ˜¯å‡ ä¸ªæœºå™¨å­¦ä¹ åº“å’Œæ¡†æ¶çš„ Python åŒ…è£…å™¨ï¼Œæ¯”å¦‚ scikit-learnã€XGBoostã€LightGBMã€CatBoostã€spaCyã€Optunaã€Hyperoptã€Ray ç­‰ç­‰ã€‚

PyCaret çš„è®¾è®¡å’Œç®€å•æ€§å—åˆ°äº†å…¬æ°‘æ•°æ®ç§‘å­¦å®¶è¿™ä¸€æ–°å…´è§’è‰²çš„å¯å‘ï¼Œè¿™æ˜¯ Gartner é¦–å…ˆä½¿ç”¨çš„æœ¯è¯­ã€‚å…¬æ°‘æ•°æ®ç§‘å­¦å®¶æ˜¯è¶…çº§ç”¨æˆ·ï¼Œä»–ä»¬å¯ä»¥æ‰§è¡Œç®€å•å’Œä¸­ç­‰å¤æ‚çš„åˆ†æä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡åœ¨ä»¥å‰éœ€è¦æ›´å¤šçš„æŠ€æœ¯ä¸“ä¸šçŸ¥è¯†ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹[ç½‘ç«™](https://www.pycaret.org/)æˆ–è€… [GitHub](https://www.github.com/pycaret/pycaret) ã€‚

# 2.0 æ•™ç¨‹ç›®æ ‡

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ :

*   **è·å–æ•°æ®:**å¦‚ä½•ä» PyCaret å­˜å‚¨åº“ä¸­å¯¼å…¥æ•°æ®
*   **è®¾ç½®ç¯å¢ƒ:**å¦‚ä½•åœ¨ PyCaret ä¸­è®¾ç½®å®éªŒå¹¶å¼€å§‹æ„å»ºåˆ†ç±»æ¨¡å‹
*   **åˆ›å»ºæ¨¡å‹:**å¦‚ä½•åˆ›å»ºæ¨¡å‹ã€æ‰§è¡Œåˆ†å±‚äº¤å‰éªŒè¯å’Œè¯„ä¼°åˆ†ç±»æŒ‡æ ‡
*   **è°ƒæ•´æ¨¡å‹:**å¦‚ä½•è‡ªåŠ¨è°ƒæ•´åˆ†ç±»æ¨¡å‹çš„è¶…å‚æ•°
*   **ç»˜å›¾æ¨¡å‹:**å¦‚ä½•ä½¿ç”¨å„ç§ç»˜å›¾åˆ†ææ¨¡å‹æ€§èƒ½
*   **æ•²å®šæ¨¡å‹:**å¦‚ä½•åœ¨å®éªŒç»“æŸæ—¶æ•²å®šæœ€ä½³æ¨¡å‹
*   **é¢„æµ‹æ¨¡å‹:**å¦‚ä½•å¯¹çœ‹ä¸è§çš„æ•°æ®è¿›è¡Œé¢„æµ‹
*   **ä¿å­˜/åŠ è½½æ¨¡å‹:**å¦‚ä½•ä¿å­˜/åŠ è½½æ¨¡å‹ä»¥å¤‡å°†æ¥ä½¿ç”¨

# 3.0 å®‰è£… PyCaret

å®‰è£…å¾ˆå®¹æ˜“ï¼Œåªéœ€å‡ åˆ†é’Ÿã€‚PyCaret ä» pip çš„é»˜è®¤å®‰è£…åªå®‰è£…åœ¨ [requirements.txt](https://github.com/pycaret/pycaret/blob/master/requirements.txt) æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç¡¬ä¾èµ–é¡¹ã€‚

```
pip install pycaret
```

è¦å®‰è£…å®Œæ•´ç‰ˆ:

```
pip install pycaret[full] 
```

# 4.0 ä»€ä¹ˆæ˜¯äºŒè¿›åˆ¶åˆ†ç±»ï¼Ÿ

äºŒå…ƒåˆ†ç±»æ˜¯ä¸€ç§å—ç›‘ç£çš„æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œå…¶ç›®æ ‡æ˜¯é¢„æµ‹ç¦»æ•£ä¸”æ— åºçš„åˆ†ç±»æ ‡ç­¾ï¼Œä¾‹å¦‚é€šè¿‡/å¤±è´¥ã€è‚¯å®š/å¦å®šã€é»˜è®¤/éé»˜è®¤ç­‰ã€‚ä¸‹é¢åˆ—å‡ºäº†ä¸€äº›åˆ†ç±»çš„çœŸå®ä½¿ç”¨æ¡ˆä¾‹:

*   ç¡®å®šæ‚£è€…æ˜¯å¦æ‚£æœ‰æŸç§ç–¾ç—…çš„åŒ»å­¦æµ‹è¯•â€”â€”åˆ†ç±»å±æ€§æ˜¯ç–¾ç—…çš„å­˜åœ¨ã€‚
*   å·¥å‚ä¸­çš„â€œé€šè¿‡æˆ–å¤±è´¥â€æµ‹è¯•æ–¹æ³•æˆ–è´¨é‡æ§åˆ¶ï¼Œå³å†³å®šæ˜¯å¦ç¬¦åˆè§„æ ¼â€”â€”é€šè¿‡/ä¸é€šè¿‡åˆ†ç±»ã€‚
*   ä¿¡æ¯æ£€ç´¢ï¼Œå³å†³å®šä¸€ä¸ªé¡µé¢æˆ–ä¸€ç¯‡æ–‡ç« æ˜¯å¦åº”è¯¥å‡ºç°åœ¨æœç´¢ç»“æœé›†ä¸­â€”â€”åˆ†ç±»å±æ€§æ˜¯æ–‡ç« çš„ç›¸å…³æ€§æˆ–å¯¹ç”¨æˆ·çš„æœ‰ç”¨æ€§ã€‚

# 5.0 py caret ä¸­åˆ†ç±»æ¨¡å—çš„æ¦‚è¿°

PyCaret çš„[åˆ†ç±»æ¨¡å—](https://pycaret.readthedocs.io/en/latest/api/classification.html) ( `pycaret.classification`)æ˜¯ä¸€ä¸ªå—ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å—ï¼Œç”¨äºæ ¹æ®å„ç§æŠ€æœ¯å’Œç®—æ³•å°†å…ƒç´ åˆ†ç±»åˆ°äºŒè¿›åˆ¶ç»„ä¸­ã€‚åˆ†ç±»é—®é¢˜çš„ä¸€äº›å¸¸è§ç”¨ä¾‹åŒ…æ‹¬é¢„æµ‹å®¢æˆ·è¿çº¦(æ˜¯æˆ–å¦)ã€å®¢æˆ·æµå¤±(å®¢æˆ·å°†ç¦»å¼€æˆ–ç•™ä¸‹)ã€å‘ç°ç–¾ç—…(é˜³æ€§æˆ–é˜´æ€§)ã€‚

PyCaret åˆ†ç±»æ¨¡å—å¯ç”¨äºäºŒè¿›åˆ¶æˆ–å¤šç±»åˆ†ç±»é—®é¢˜ã€‚å®ƒæœ‰è¶…è¿‡ 18 ä¸ªç®—æ³•å’Œ 14 ä¸ªå›¾æ¥åˆ†ææ¨¡å‹çš„æ€§èƒ½ã€‚æ— è®ºæ˜¯è¶…å‚æ•°è°ƒæ•´ã€é›†æˆï¼Œè¿˜æ˜¯å †å ç­‰é«˜çº§æŠ€æœ¯ï¼ŒPyCaret çš„åˆ†ç±»æ¨¡å—éƒ½å…·å¤‡ã€‚

# æ•™ç¨‹çš„ 6.0 æ•°æ®é›†

å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªæ¥è‡ª UCI çš„æ•°æ®é›†ï¼Œåä¸º [**ä¿¡ç”¨å¡å®¢æˆ·æ•°æ®é›†**](https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients) çš„é»˜è®¤å€¼ã€‚æ­¤æ•°æ®é›†åŒ…å«ä» 2005 å¹´ 4 æœˆåˆ° 2005 å¹´ 9 æœˆå°æ¹¾ä¿¡ç”¨å¡å®¢æˆ·çš„è¿çº¦ä»˜æ¬¾ã€äººå£ç»Ÿè®¡å› ç´ ã€ä¿¡ç”¨æ•°æ®ã€ä»˜æ¬¾å†å²å’Œè´¦å•ç­‰ä¿¡æ¯ã€‚æœ‰ 24ï¼Œ000 ä¸ªæ ·æœ¬å’Œ 25 ä¸ªç‰¹å¾ã€‚æ¯åˆ—çš„ç®€çŸ­æè¿°å¦‚ä¸‹:

*   **ID:** æ¯ä¸ªå®¢æˆ·ç«¯çš„ ID
*   **LIMIT_BAL:** ä»¥æ–°å°å¸ä¸ºå•ä½çš„ç»™å®šé¢åº¦(åŒ…æ‹¬ä¸ªäººå’Œå®¶åº­/è¡¥å……é¢åº¦)
*   **æ€§åˆ«:**æ€§åˆ«(1 =ç”·æ€§ï¼Œ2 =å¥³æ€§)
*   **å­¦å†:**(1 =ç ”ç©¶ç”Ÿé™¢ï¼Œ2 =å¤§å­¦ï¼Œ3 =é«˜ä¸­ï¼Œ4 =å…¶ä»–ï¼Œ5 =æœªçŸ¥ï¼Œ6 =æœªçŸ¥)
*   **å©šå§»:**å©šå§»çŠ¶å†µ(1 =å·²å©šï¼Œ2 =å•èº«ï¼Œ3 =å…¶ä»–)
*   **å¹´é¾„:**ä»¥å¹´ä¸ºå•ä½çš„å¹´é¾„
*   **PAY_0 è‡³ PAY _ 6:**n ä¸ªæœˆå‰çš„è¿˜æ¬¾çŠ¶æ€(PAY_0 =ä¸Šæœˆâ€¦ PAY_6 = 6 ä¸ªæœˆå‰)(æ ‡ç­¾:-1 =æŒ‰æ—¶è¿˜æ¬¾ï¼Œ1 =å»¶è¿Ÿä¸€ä¸ªæœˆè¿˜æ¬¾ï¼Œ2 =å»¶è¿Ÿä¸¤ä¸ªæœˆè¿˜æ¬¾ï¼Œâ€¦8 =å»¶è¿Ÿå…«ä¸ªæœˆè¿˜æ¬¾ï¼Œ9 =å»¶è¿Ÿä¹ä¸ªæœˆåŠä»¥ä¸Šè¿˜æ¬¾)
*   **BILL_AMT1 è‡³ BILL _ AMT 6:**n ä¸ªæœˆå‰çš„å¯¹è´¦å•é‡‘é¢(BILL_AMT1 = last_month..BILL_AMT6 = 6 ä¸ªæœˆå‰)
*   **PAY _ am t1 to PAY _ AMT 6:**n ä¸ªæœˆå‰çš„ä»˜æ¬¾é‡‘é¢(BILL_AMT1 = last_month..BILL_AMT6 = 6 ä¸ªæœˆå‰)
*   **è¿çº¦:**è¿çº¦ä»˜æ¬¾(1 =æ˜¯ï¼Œ0 =å¦)`Target Column`

## æ•°æ®é›†ç¡®è®¤:

åˆ©å¥‡æ›¼(2013 å¹´)ã€‚UCI æœºå™¨å­¦ä¹ çŸ¥è¯†åº“ã€‚åŠ å·æ¬§æ–‡:åŠ å·å¤§å­¦ä¿¡æ¯ä¸è®¡ç®—æœºç§‘å­¦å­¦é™¢ã€‚

# 7.0 è·å–æ•°æ®

æ‚¨å¯ä»¥ä»è¿™é‡Œæ‰¾åˆ°çš„åŸå§‹æ•°æ®æº[](https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients)**ä¸‹è½½æ•°æ®ï¼Œå¹¶ä½¿ç”¨ pandas [**(äº†è§£å¦‚ä½•ä½¿ç”¨)**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html) åŠ è½½æ•°æ®ï¼Œæˆ–è€…æ‚¨å¯ä»¥ä½¿ç”¨ PyCaret çš„æ•°æ®å­˜å‚¨åº“ï¼Œä½¿ç”¨`get_data()`å‡½æ•°åŠ è½½æ•°æ®(è¿™å°†éœ€è¦äº’è”ç½‘è¿æ¥)ã€‚**

```
**# loading the dataset** from pycaret.datasets import get_data
dataset = get_data('credit')
```

**![](img/9ceb0701258161240a1eef6c4568ed3e.png)**

```
**# check the shape of data** dataset.shape>>> (24000, 24)
```

**ä¸ºäº†æ¼”ç¤ºå¯¹çœ‹ä¸è§çš„æ•°æ®ä½¿ç”¨`predict_model`å‡½æ•°ï¼Œä»åŸå§‹æ•°æ®é›†ä¸­ä¿ç•™äº† 1200 æ¡è®°å½•çš„æ ·æœ¬(çº¦ 5%)ï¼Œç”¨äºæœ€ç»ˆçš„é¢„æµ‹ã€‚è¿™ä¸åº”è¯¥ä¸è®­ç»ƒ-æµ‹è¯•-åˆ†å‰²ç›¸æ··æ·†ï¼Œå› ä¸ºè¿™ç§ç‰¹å®šçš„åˆ†å‰²æ˜¯ä¸ºäº†æ¨¡æ‹ŸçœŸå®åœºæ™¯è€Œæ‰§è¡Œçš„ã€‚å¦ä¸€ç§æ€è€ƒæ–¹å¼æ˜¯ï¼Œåœ¨è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ï¼Œè¿™ 1200 ä¸ªå®¢æˆ·æ˜¯ä¸å¯ç”¨çš„ã€‚**

```
**# sample 5% of data to be used as unseen data**
data = dataset.sample(frac=0.95, random_state=786)
data_unseen = dataset.drop(data.index)
data.reset_index(inplace=True, drop=True)
data_unseen.reset_index(inplace=True, drop=True)**# print the revised shape** print('Data for Modeling: ' + str(data.shape))
print('Unseen Data For Predictions: ' + str(data_unseen.shape))>>> Data for Modeling: (22800, 24)
>>> Unseen Data For Predictions: (1200, 24)
```

# **8.0 åœ¨ PyCaret ä¸­è®¾ç½®ç¯å¢ƒ**

**PyCaret ä¸­çš„`setup`å‡½æ•°åˆå§‹åŒ–ç¯å¢ƒï¼Œå¹¶ä¸ºå»ºæ¨¡å’Œéƒ¨ç½²åˆ›å»ºè½¬æ¢ç®¡é“ã€‚åœ¨ pycaret ä¸­æ‰§è¡Œä»»ä½•å…¶ä»–å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨`setup`ã€‚å®ƒæœ‰ä¸¤ä¸ªå¼ºåˆ¶å‚æ•°:ä¸€ä¸ª pandas dataframe å’Œç›®æ ‡åˆ—çš„åç§°ã€‚æ‰€æœ‰å…¶ä»–å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå¯ç”¨äºå®šåˆ¶é¢„å¤„ç†ç®¡é“ã€‚**

**å½“æ‰§è¡Œ`setup`æ—¶ï¼ŒPyCaret çš„æ¨ç†ç®—æ³•ä¼šæ ¹æ®æŸäº›å±æ€§è‡ªåŠ¨æ¨æ–­å‡ºæ‰€æœ‰ç‰¹æ€§çš„æ•°æ®ç±»å‹ã€‚åº”è¯¥å¯ä»¥æ­£ç¡®æ¨æ–­å‡ºæ•°æ®ç±»å‹ï¼Œä½†æƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚ä¸ºäº†å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä¸€æ—¦æ‰§è¡Œäº†`setup`ï¼ŒPyCaret å°±ä¼šæ˜¾ç¤ºä¸€ä¸ªæç¤ºï¼Œè¦æ±‚ç¡®è®¤æ•°æ®ç±»å‹ã€‚å¦‚æœæ‰€æœ‰æ•°æ®ç±»å‹éƒ½æ­£ç¡®ï¼Œæ‚¨å¯ä»¥æŒ‰ enter é”®ï¼Œæˆ–è€…é”®å…¥`quit`é€€å‡ºè®¾ç½®ã€‚**

**ç¡®ä¿æ•°æ®ç±»å‹æ­£ç¡®åœ¨ PyCaret ä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨æ‰§è¡Œå¤šä¸ªç‰¹å®šäºç±»å‹çš„é¢„å¤„ç†ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡å¯¹äºæœºå™¨å­¦ä¹ æ¨¡å‹æ¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ã€‚**

**æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨`setup`ä¸­çš„`numeric_features`å’Œ`categorical_features`å‚æ•°æ¥é¢„å®šä¹‰æ•°æ®ç±»å‹ã€‚**

```
**# init setup** from pycaret.classification import *
s = setup(data = data, target = 'default', session_id=123)
```

**![](img/c00234f1bb23556c3c5bce7556313b35.png)**

**æˆåŠŸæ‰§è¡Œè®¾ç½®åï¼Œå®ƒä¼šæ˜¾ç¤ºä¿¡æ¯ç½‘æ ¼ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›å…³äºå®éªŒçš„é‡è¦ä¿¡æ¯ã€‚å¤§éƒ¨åˆ†ä¿¡æ¯ä¸æ‰§è¡Œ`setup`æ—¶æ„å»ºçš„é¢„å¤„ç†æµæ°´çº¿æœ‰å…³ã€‚è¿™äº›ç‰¹æ€§çš„å¤§éƒ¨åˆ†è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯ï¼Œæœ‰ä¸€äº›é‡è¦çš„äº‹æƒ…éœ€è¦æ³¨æ„:**

*   ****session_id:** åœ¨æ‰€æœ‰å‡½æ•°ä¸­ä½œä¸ºç§å­åˆ†å‘çš„ä¼ªéšæœºæ•°ï¼Œç”¨äºä»¥åçš„å¯å†ç°æ€§ã€‚å¦‚æœæ²¡æœ‰é€šè¿‡`session_id`ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œåˆ†é…ç»™æ‰€æœ‰å‡½æ•°ã€‚åœ¨æœ¬å®éªŒä¸­ï¼Œä¸ºäº†ä»¥åçš„å†ç°æ€§ï¼Œå°†`session_id`è®¾ç½®ä¸º`123`ã€‚**
*   ****ç›®æ ‡ç±»å‹:**äºŒè¿›åˆ¶æˆ–å¤šç±»ã€‚è‡ªåŠ¨æ£€æµ‹å¹¶æ˜¾ç¤ºç›®æ ‡ç±»å‹ã€‚äºŒå…ƒæˆ–å¤šç±»é—®é¢˜çš„å®éªŒæ–¹å¼æ²¡æœ‰åŒºåˆ«ã€‚æ‰€æœ‰åŠŸèƒ½éƒ½æ˜¯ç›¸åŒçš„ã€‚**
*   ****æ ‡ç­¾ç¼–ç :**å½“ç›®æ ‡å˜é‡ä¸ºå­—ç¬¦ä¸²ç±»å‹(å³â€œæ˜¯â€æˆ–â€œå¦â€)è€Œä¸æ˜¯ 1 æˆ– 0 æ—¶ï¼Œè‡ªåŠ¨å°†æ ‡ç­¾ç¼–ç ä¸º 1 å’Œ 0ï¼Œå¹¶æ˜¾ç¤ºæ˜ å°„(0:å¦ï¼Œ1:æ˜¯)ä»¥ä¾›å‚è€ƒã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä¸éœ€è¦æ ‡ç­¾ç¼–ç ï¼Œå› ä¸ºç›®æ ‡å˜é‡æ˜¯ numeric ç±»å‹ã€‚**
*   ****åŸå§‹æ•°æ®:**æ˜¾ç¤ºæ•°æ®é›†çš„åŸå§‹å½¢çŠ¶ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­(22800ï¼Œ24)æ„å‘³ç€åŒ…æ‹¬ç›®æ ‡åˆ—åœ¨å†…çš„ 22800 ä¸ªæ ·æœ¬å’Œ 24 ä¸ªç‰¹å¾ã€‚**
*   ****ç¼ºå¤±å€¼:**å½“åŸå§‹æ•°æ®ä¸­å­˜åœ¨ç¼ºå¤±å€¼æ—¶ï¼Œå°†æ˜¾ç¤ºä¸ºçœŸã€‚å¯¹äºè¿™ä¸ªå®éªŒï¼Œæ•°æ®é›†ä¸­æ²¡æœ‰ç¼ºå¤±å€¼ã€‚**
*   ****æ•°å­—ç‰¹å¾:**æ¨æ–­ä¸ºæ•°å­—çš„ç‰¹å¾æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ24 ä¸ªè¦ç´ ä¸­æœ‰ 14 ä¸ªè¢«æ¨æ–­ä¸ºæ•°å­—ã€‚**
*   ****åˆ†ç±»ç‰¹å¾:**è¢«æ¨æ–­ä¸ºåˆ†ç±»çš„ç‰¹å¾çš„æ•°é‡ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œ24 ä¸ªç‰¹å¾ä¸­æœ‰ 9 ä¸ªè¢«æ¨æ–­ä¸ºåˆ†ç±»ç‰¹å¾ã€‚**
*   ****å˜æ¢åçš„è®­ç»ƒé›†:**æ˜¾ç¤ºå˜æ¢åçš„è®­ç»ƒé›†çš„å½¢çŠ¶ã€‚æ³¨æ„ï¼Œå¯¹äºå˜æ¢åçš„è®­ç»ƒé›†,( 22800ï¼Œ24)çš„åŸå§‹å½¢çŠ¶è¢«å˜æ¢ä¸º(15959ï¼Œ91 ),å¹¶ä¸”ç”±äºä¸€æ¬¡çƒ­ç¼–ç ï¼Œç‰¹å¾çš„æ•°é‡ä» 24 å¢åŠ åˆ° 91ã€‚**
*   ****è½¬æ¢åçš„æµ‹è¯•é›†:**æ˜¾ç¤ºè½¬æ¢åçš„æµ‹è¯•/ä¿æŒé›†çš„å½¢çŠ¶ã€‚æµ‹è¯•/ä¿ç•™ç»„ä¸­æœ‰ 6841 ä¸ªæ ·æœ¬ã€‚è¯¥åˆ†å‰²åŸºäºé»˜è®¤å€¼ 70/30ï¼Œå¯ä½¿ç”¨è®¾ç½®ä¸­çš„`train_size`å‚æ•°è¿›è¡Œæ›´æ”¹ã€‚**

**è¯·æ³¨æ„ï¼Œæ‰§è¡Œå»ºæ¨¡æ‰€å¿…éœ€çš„ä¸€äº›ä»»åŠ¡æ˜¯å¦‚ä½•è‡ªåŠ¨å¤„ç†çš„ï¼Œä¾‹å¦‚ç¼ºå¤±å€¼æ’è¡¥(åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ•°æ®ä¸­æ²¡æœ‰ç¼ºå¤±å€¼ï¼Œä½†æˆ‘ä»¬ä»ç„¶éœ€è¦ç”¨äºæœªçŸ¥æ•°æ®çš„æ’è¡¥å™¨)ã€åˆ†ç±»ç¼–ç ç­‰ã€‚`setup`ä¸­çš„å¤§å¤šæ•°å‚æ•°æ˜¯å¯é€‰çš„ï¼Œç”¨äºå®šåˆ¶é¢„å¤„ç†æµæ°´çº¿ã€‚è¿™äº›å‚æ•°è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯æˆ‘ä»¬å°†åœ¨ä»¥åçš„æ•™ç¨‹ä¸­ä»‹ç»å®ƒä»¬ã€‚**

# **9.0 æ¯”è¾ƒæ‰€æœ‰æ¨¡å‹**

**ä¸€æ—¦è®¾ç½®å®Œæˆï¼Œæ¯”è¾ƒæ‰€æœ‰æ¨¡å‹ä»¥è¯„ä¼°æ€§èƒ½æ˜¯å»ºæ¨¡çš„æ¨èèµ·ç‚¹(é™¤éæ‚¨ç¡®åˆ‡åœ°çŸ¥é“æ‚¨éœ€è¦å“ªç§æ¨¡å‹ï¼Œè€Œäº‹å®å¾€å¾€å¹¶éå¦‚æ­¤)ã€‚è¯¥å‡½æ•°è®­ç»ƒæ¨¡å‹åº“ä¸­çš„æ‰€æœ‰æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨åˆ†å±‚äº¤å‰éªŒè¯å¯¹å®ƒä»¬è¿›è¡Œè¯„åˆ†ä»¥è¿›è¡ŒæŒ‡æ ‡è¯„ä¼°ã€‚è¾“å‡ºæ‰“å°ä¸€ä¸ªè¯„åˆ†ç½‘æ ¼ï¼Œæ˜¾ç¤ºå¹³å‡å‡†ç¡®åº¦ã€AUCã€å¬å›ç‡ã€ç²¾ç¡®åº¦ã€F1ã€Kappa å’Œ MCC(é»˜è®¤ä¸º 10)ä»¥åŠè®­ç»ƒæ—¶é—´ã€‚**

```
best_model = compare_models()
```

**![](img/c6522af9cbe20af3d23e86c74ccb2e17.png)**

**ä¸Šé¢æ‰“å°çš„è¯„åˆ†ç½‘æ ¼çªå‡ºæ˜¾ç¤ºäº†æœ€é«˜ç»©æ•ˆæŒ‡æ ‡ï¼Œä»…ä¾›æ¯”è¾ƒä¹‹ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç½‘æ ¼ä½¿ç”¨`Accuracy` (ä»æœ€é«˜åˆ°æœ€ä½)æ’åºï¼Œè¿™å¯ä»¥é€šè¿‡ä¼ é€’`sort`å‚æ•°æ¥æ›´æ”¹ã€‚ä¾‹å¦‚,`compare_models(sort = 'Recall')`å°†é€šè¿‡å›å¿†è€Œä¸æ˜¯å‡†ç¡®æ€§æ¥å¯¹ç½‘æ ¼è¿›è¡Œæ’åºã€‚**

**å¦‚æœæ‚¨æƒ³å°†æŠ˜å å‚æ•°ä»é»˜è®¤å€¼`10`æ›´æ”¹ä¸ºä¸åŒçš„å€¼ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨`fold`å‚æ•°ã€‚ä¾‹å¦‚`compare_models(fold = 5)`å°†å¯¹æ‰€æœ‰æ¨¡å‹è¿›è¡Œ 5 é‡äº¤å‰éªŒè¯æ¯”è¾ƒã€‚å‡å°‘æŠ˜å æ¬¡æ•°å°†æ”¹å–„è®­ç»ƒæ—¶é—´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ`compare_models`æ ¹æ®é»˜è®¤çš„æ’åºé¡ºåºè¿”å›æ€§èƒ½æœ€å¥½çš„æ¨¡å‹ï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨`n_select`å‚æ•°è¿”å›å‰ N ä¸ªæ¨¡å‹çš„åˆ—è¡¨ã€‚**

```
print(best_model)**>>> OUTPUT**RidgeClassifier(alpha=1.0, class_weight=None, copy_X=True, fit_intercept=True,
                max_iter=None, normalize=False, random_state=123, solver='auto',
                tol=0.001)
```

# **10.0 åˆ›å»ºæ¨¡å‹**

**`create_model`æ˜¯ PyCaret ä¸­ç²’åº¦æœ€ç»†çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯å¤§å¤šæ•° PyCaret åŠŸèƒ½çš„åŸºç¡€ã€‚é¡¾åæ€ä¹‰ï¼Œè¯¥å‡½æ•°ä½¿ç”¨äº¤å‰éªŒè¯æ¥è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹ï¼Œäº¤å‰éªŒè¯å¯ä»¥ç”¨`fold`å‚æ•°æ¥è®¾ç½®ã€‚è¾“å‡ºæ‰“å°å‡ºä¸€ä¸ªå¾—åˆ†ç½‘æ ¼ï¼ŒæŒ‰å€æ•°æ˜¾ç¤ºå‡†ç¡®æ€§ã€AUCã€å¬å›ç‡ã€ç²¾ç¡®åº¦ã€F1ã€Kappa å’Œ MCCã€‚**

**å¯¹äºæœ¬æ•™ç¨‹çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸‹é¢çš„æ¨¡å‹ä½œä¸ºæˆ‘ä»¬çš„å€™é€‰æ¨¡å‹ã€‚è¿™äº›é€‰æ‹©ä»…ç”¨äºè¯´æ˜ç›®çš„ï¼Œå¹¶ä¸æ„å‘³ç€å®ƒä»¬æ˜¯æ­¤ç±»æ•°æ®çš„æœ€ä½³é€‰æ‹©æˆ–ç†æƒ³é€‰æ‹©ã€‚**

*   **å†³ç­–æ ‘åˆ†ç±»å™¨**
*   **k é‚»å±…åˆ†ç±»å™¨(â€œknnâ€)**
*   **éšæœºæ£®æ—åˆ†ç±»å™¨(â€œrfâ€)**

**PyCaret çš„æ¨¡å‹åº“ä¸­æœ‰ 18 ä¸ªå¯ç”¨çš„åˆ†ç±»å™¨ã€‚è¦æŸ¥çœ‹æ‰€æœ‰åˆ†ç±»å™¨çš„åˆ—è¡¨ï¼Œè¦ä¹ˆæŸ¥çœ‹æ–‡æ¡£ï¼Œè¦ä¹ˆä½¿ç”¨`models`åŠŸèƒ½æŸ¥çœ‹åº“ã€‚**

```
**# check available models** models()
```

**![](img/26c8c6cf54eb6e93d5845de4c18c82df.png)**

## **10.1 å†³ç­–æ ‘åˆ†ç±»å™¨**

```
dt = create_model('dt')
```

**![](img/ffe5540a02f5a72f879fd8864be9ace3.png)**

```
**# trained model object is stored in the variable 'dt'.** 
print(dt)**>>> OUTPUT**DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',
                       max_depth=None, max_features=None, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort='deprecated',
                       random_state=123, splitter='best')
```

## **10.2 K é‚»å±…åˆ†ç±»å™¨**

```
knn = create_model('knn')
```

**![](img/ac55509c03c49234ab12db323c045acd.png)**

## **10.3 éšæœºæ£®æ—åˆ†ç±»å™¨**

```
rf = create_model('rf')
```

**![](img/f340b1541214865156eb30b69aec4ffa.png)**

**è¯·æ³¨æ„ï¼Œæ‰€æœ‰å‹å·çš„å¹³å‡åˆ†æ•°ä¸`compare_models`ä¸­æ‰“å°çš„åˆ†æ•°ç›¸åŒ¹é…ã€‚è¿™æ˜¯å› ä¸ºæ‰“å°åœ¨`compare_models`åˆ†æ•°ç½‘æ ¼ä¸­çš„æŒ‡æ ‡æ˜¯æ‰€æœ‰ç®€å†æŠ˜å çš„å¹³å‡åˆ†æ•°ã€‚ä¸`compare_models`ç±»ä¼¼ï¼Œå¦‚æœæ‚¨æƒ³å°†æŠ˜å å‚æ•°ä»é»˜è®¤å€¼ 10 æ›´æ”¹ä¸ºä¸åŒçš„å€¼ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨`fold`å‚æ•°ã€‚ä¾‹å¦‚:`create_model('dt', fold = 5)`å°†ä½¿ç”¨ 5 é‡åˆ†å±‚ CV åˆ›å»ºä¸€ä¸ªå†³ç­–æ ‘åˆ†ç±»å™¨ã€‚**

# **11.0 è°ƒæ•´æ¨¡å‹**

**å½“ä½¿ç”¨`create_model`åŠŸèƒ½åˆ›å»ºæ¨¡å‹æ—¶ï¼Œå®ƒä½¿ç”¨é»˜è®¤è¶…å‚æ•°æ¥è®­ç»ƒæ¨¡å‹ã€‚ä¸ºäº†è°ƒæ•´è¶…å‚æ•°ï¼Œä½¿ç”¨`tune_model`åŠŸèƒ½ã€‚è¯¥åŠŸèƒ½ä½¿ç”¨é¢„å®šä¹‰æœç´¢ç©ºé—´ä¸Šçš„éšæœºç½‘æ ¼æœç´¢è‡ªåŠ¨è°ƒæ•´æ¨¡å‹çš„è¶…å‚æ•°ã€‚è¾“å‡ºæ‰“å°ä¸€ä¸ªå¾—åˆ†ç½‘æ ¼ï¼Œæ˜¾ç¤ºæœ€ä½³æ¨¡å‹çš„å‡†ç¡®åº¦ã€AUCã€å¬å›ç‡ã€ç²¾ç¡®åº¦ã€F1ã€Kappa å’Œ MCCã€‚è¦ä½¿ç”¨è‡ªå®šä¹‰æœç´¢ç½‘æ ¼ï¼Œæ‚¨å¯ä»¥åœ¨`tune_model`å‡½æ•°ä¸­ä¼ é€’`custom_grid`å‚æ•°(å‚è§ä¸‹é¢çš„ 11.2 KNN è°ƒè°)ã€‚**

## **11.1 å†³ç­–æ ‘åˆ†ç±»å™¨**

```
tuned_dt = tune_model(dt)
```

**![](img/9968c70243dbc625d76a84207542dd2d.png)**

```
**# tuned model object is stored in the variable 'tuned_dt'.** print(tuned_dt)**>>> OUTPUT**DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='entropy',
                       max_depth=6, max_features=1.0, max_leaf_nodes=None,
                       min_impurity_decrease=0.002, min_impurity_split=None,
                       min_samples_leaf=5, min_samples_split=5,
                       min_weight_fraction_leaf=0.0, presort='deprecated',
                       random_state=123, splitter='best')
```

## **11.2 K é‚»å±…åˆ†ç±»å™¨**

```
import numpy as np
tuned_knn = tune_model(knn, custom_grid = {'n_neighbors' : np.arange(0,50,1)})
```

**![](img/b37c57df4388a30879f86e6a6ba2a502.png)**

```
print(tuned_knn)**>>> OUTPUT**KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',
                     metric_params=None, n_jobs=-1, n_neighbors=42, p=2,
                     weights='uniform')
```

## **11.3 éšæœºæ£®æ—åˆ†ç±»å™¨**

```
tuned_rf = tune_model(rf)
```

**![](img/a86e020869cedd06e003b01520b3416e.png)**

**é»˜è®¤æƒ…å†µä¸‹ï¼Œ`tune_model`ä¼šä¼˜åŒ–`Accuracy`ï¼Œä½†è¿™å¯ä»¥ä½¿ç”¨`optimize`å‚æ•°è¿›è¡Œæ›´æ”¹ã€‚ä¾‹å¦‚:`tune_model(dt, optimize = 'AUC')`å°†æœç´¢äº§ç”Ÿæœ€é«˜`AUC`è€Œä¸æ˜¯`Accuracy`çš„å†³ç­–æ ‘åˆ†ç±»å™¨çš„è¶…å‚æ•°ã€‚å‡ºäºæœ¬ä¾‹çš„ç›®çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨é»˜è®¤æŒ‡æ ‡`Accuracy`åªæ˜¯ä¸ºäº†ç®€å•èµ·è§ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå½“æ•°æ®é›†ä¸å¹³è¡¡æ—¶(æ¯”å¦‚æˆ‘ä»¬æ­£åœ¨å¤„ç†çš„ä¿¡ç”¨æ•°æ®é›†)ï¼Œ`Accuracy`ä¸æ˜¯ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„å¥½æŒ‡æ ‡ã€‚é€‰æ‹©æ­£ç¡®çš„åº¦é‡æ¥è¯„ä¼°åˆ†ç±»å™¨çš„æ–¹æ³•è¶…å‡ºäº†æœ¬æ•™ç¨‹çš„èŒƒå›´ï¼Œä½†æ˜¯å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šï¼Œæ‚¨å¯ä»¥ [**å•å‡»æ­¤å¤„**](https://medium.com/@MohammedS/performance-metrics-for-classification-problems-in-machine-learning-part-i-b085d432082b) é˜…è¯»å…³äºå¦‚ä½•é€‰æ‹©æ­£ç¡®çš„è¯„ä¼°åº¦é‡çš„æ–‡ç« ã€‚**

**åœ¨æœ€ç»ˆç¡®å®šç”Ÿäº§çš„æœ€ä½³æ¨¡å‹æ—¶ï¼Œåº¦é‡å¹¶ä¸æ˜¯æ‚¨åº”è¯¥è€ƒè™‘çš„å”¯ä¸€æ ‡å‡†ã€‚å…¶ä»–è¦è€ƒè™‘çš„å› ç´ åŒ…æ‹¬è®­ç»ƒæ—¶é—´ã€kfolds çš„æ ‡å‡†åå·®ç­‰ã€‚éšç€æ•™ç¨‹ç³»åˆ—çš„è¿›å±•ï¼Œæˆ‘ä»¬å°†åœ¨ä¸­çº§å’Œä¸“å®¶çº§åˆ«è¯¦ç»†è®¨è®ºè¿™äº›å› ç´ ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»§ç»­è€ƒè™‘è°ƒä¼˜çš„éšæœºæ£®æ—åˆ†ç±»å™¨`tuned_rf`ï¼Œä½œä¸ºæœ¬æ•™ç¨‹å‰©ä½™éƒ¨åˆ†çš„æœ€ä½³æ¨¡å‹ã€‚**

# **12.0 ç»˜åˆ¶æ¨¡å‹**

**åœ¨æ¨¡å‹æœ€ç»ˆç¡®å®šä¹‹å‰ï¼Œ`plot_model`å‡½æ•°å¯ç”¨äºåˆ†æä¸åŒæ–¹é¢çš„æ€§èƒ½ï¼Œå¦‚ AUCã€æ··æ·†çŸ©é˜µã€å†³ç­–è¾¹ç•Œç­‰ã€‚è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»è¿‡è®­ç»ƒçš„æ¨¡å‹å¯¹è±¡ï¼Œå¹¶æ ¹æ®æµ‹è¯•é›†è¿”å›ä¸€ä¸ªå›¾ã€‚**

**æœ‰ 15 ç§ä¸åŒçš„å›¾å¯ç”¨ï¼Œè¯·å‚è§`plot_model`æ–‡æ¡£ä¸­çš„å¯ç”¨å›¾åˆ—è¡¨ã€‚**

## **12.1 AUC å›¾**

```
plot_model(tuned_rf, plot = 'auc')
```

**![](img/80d6188642791975930410f0b2624a4d.png)**

## **12.2 ç²¾ç¡®å¬å›æ›²çº¿**

```
plot_model(tuned_rf, plot = 'pr')
```

**![](img/62c533e0773b89926e0dddc876f55058.png)**

## **12.3 ç‰¹å¾é‡è¦æ€§å›¾**

```
plot_model(tuned_rf, plot='feature')
```

**![](img/d237df239d92780cbf78d015bee708e2.png)**

## **12.4 æ··æ·†çŸ©é˜µ**

```
plot_model(tuned_rf, plot = 'confusion_matrix')
```

**![](img/17a92b3a098a54153458857d5a7a8944.png)**

***åˆ†ææ¨¡å‹æ€§èƒ½çš„å¦ä¸€ç§*æ–¹æ³•æ˜¯ä½¿ç”¨`evaluate_model()`åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½æ˜¾ç¤ºç»™å®šæ¨¡å‹æ‰€æœ‰å¯ç”¨å›¾çš„ç”¨æˆ·ç•Œé¢ã€‚å®ƒåœ¨å†…éƒ¨ä½¿ç”¨`plot_model()`åŠŸèƒ½ã€‚**

```
evaluate_model(tuned_rf)
```

**![](img/f61449faca03752e56727ad583392c58.png)**

# **13.0 é¢„æµ‹æµ‹è¯•/ä¿ç•™æ ·å“**

**åœ¨æœ€ç»ˆç¡®å®šæ¨¡å‹ä¹‹å‰ï¼Œå»ºè®®é€šè¿‡é¢„æµ‹æµ‹è¯•/åšæŒé›†å’Œå®¡æŸ¥è¯„ä¼°æŒ‡æ ‡æ¥æ‰§è¡Œæœ€åçš„æ£€æŸ¥ã€‚å¦‚æœæ‚¨æŸ¥çœ‹ä¸Šé¢ç¬¬ 8 èŠ‚ä¸­çš„ä¿¡æ¯ç½‘æ ¼ï¼Œæ‚¨å°†ä¼šçœ‹åˆ° 30% (6ï¼Œ841 ä¸ªæ ·æœ¬)çš„æ•°æ®è¢«åˆ†ç¦»å‡ºæ¥ä½œä¸ºæµ‹è¯•/ä¿ç•™æ ·æœ¬ã€‚æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„æ‰€æœ‰è¯„ä¼°æŒ‡æ ‡éƒ½æ˜¯åŸºäºè®­ç»ƒé›†(70%)çš„äº¤å‰éªŒè¯ç»“æœã€‚ç°åœ¨ï¼Œä½¿ç”¨æˆ‘ä»¬å­˜å‚¨åœ¨`tuned_rf`ä¸­çš„æœ€ç»ˆè®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬å°†é¢„æµ‹æµ‹è¯•/ä¿ç•™æ ·æœ¬å¹¶è¯„ä¼°æŒ‡æ ‡ï¼Œä»¥æŸ¥çœ‹å®ƒä»¬æ˜¯å¦ä¸ CV ç»“æœæœ‰å®è´¨æ€§å·®å¼‚ã€‚**

```
predict_model(tuned_rf);
```

**![](img/992aa600f7f81ebe0bf644d554984f0f.png)**

**ä¸åœ¨`tuned_rf` CV ç»“æœ(è§ä¸Šæ–‡ç¬¬ 11.3 èŠ‚)ä¸Šè·å¾—çš„`**0.8203**`ç›¸æ¯”ï¼Œæµ‹è¯•/ä¿æŒè®¾ç½®çš„ç²¾åº¦ä¸º`**0.8116**`ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªæ˜¾è‘—çš„å·®å¼‚ã€‚å¦‚æœæµ‹è¯•/ä¿æŒå’Œ CV ç»“æœä¹‹é—´å­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œåˆ™è¿™é€šå¸¸è¡¨æ˜è¿‡åº¦æ‹Ÿåˆï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯ç”±äºå…¶ä»–å‡ ä¸ªå› ç´ ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒæŸ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ç»§ç»­æœ€ç»ˆç¡®å®šæ¨¡å‹ï¼Œå¹¶æ ¹æ®çœ‹ä¸è§çš„æ•°æ®è¿›è¡Œé¢„æµ‹(æˆ‘ä»¬åœ¨å¼€å§‹æ—¶å·²ç»åˆ†ç¦»å‡ºæ¥çš„ã€ä»æœªå‘ PyCaret å…¬å¼€çš„ 5%)ã€‚**

**(æç¤º:ä½¿ç”¨`create_model`æ—¶ï¼Œçœ‹çœ‹ CV ç»“æœçš„æ ‡å‡†å·®æ€»æ˜¯å¥½çš„)**

# **14.0 æœ€ç»ˆç¡®å®šéƒ¨ç½²æ¨¡å‹**

**æ¨¡å‹å®šå‹æ˜¯å®éªŒçš„æœ€åä¸€æ­¥ã€‚PyCaret ä¸­æ­£å¸¸çš„æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹ä»`setup`å¼€å§‹ï¼Œç„¶åä½¿ç”¨`compare_models`æ¯”è¾ƒæ‰€æœ‰æ¨¡å‹ï¼Œå¹¶åˆ—å‡ºå‡ ä¸ªå€™é€‰æ¨¡å‹(åŸºäºæ„Ÿå…´è¶£çš„åº¦é‡)æ¥æ‰§è¡Œå‡ ç§å»ºæ¨¡æŠ€æœ¯ï¼Œå¦‚è¶…å‚æ•°è°ƒæ•´ã€é›†æˆã€å †å ç­‰ã€‚è¿™ä¸€å·¥ä½œæµç¨‹æœ€ç»ˆå°†å¼•å¯¼æ‚¨æ‰¾åˆ°ç”¨äºå¯¹æ–°çš„å’ŒæœªçŸ¥çš„æ•°æ®è¿›è¡Œé¢„æµ‹çš„æœ€ä½³æ¨¡å‹ã€‚`finalize_model`å‡½æ•°å°†æ¨¡å‹æ‹Ÿåˆåˆ°å®Œæ•´çš„æ•°æ®é›†ä¸Šï¼ŒåŒ…æ‹¬æµ‹è¯•/ä¿ç•™æ ·æœ¬(æœ¬ä¾‹ä¸­ä¸º 30%)ã€‚æ­¤å‡½æ•°çš„ç›®çš„æ˜¯åœ¨å°†æœ€ç»ˆæ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ä¹‹å‰ï¼Œåœ¨å®Œæ•´çš„æ•°æ®é›†ä¸Šå¯¹å…¶è¿›è¡Œè®­ç»ƒã€‚(è¿™æ˜¯å¯é€‰çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ finalize_modelï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨)ã€‚**

```
**# finalize rf model**
final_rf = finalize_model(tuned_rf)**# print final model parameters**
print(final_rf)**>>> OUTPUT**RandomForestClassifier(bootstrap=False, ccp_alpha=0.0, class_weight={},
                       criterion='entropy', max_depth=5, max_features=1.0,
                       max_leaf_nodes=None, max_samples=None,
                       min_impurity_decrease=0.0002, min_impurity_split=None,
                       min_samples_leaf=5, min_samples_split=10,
                       min_weight_fraction_leaf=0.0, n_estimators=150,
                       n_jobs=-1, oob_score=False, random_state=123, verbose=0,
                       warm_start=False)
```

**è­¦å‘Š:æœ€åä¸€å¥è­¦å‘Šã€‚ä¸€æ—¦æ¨¡å‹æœ€ç»ˆç¡®å®šï¼ŒåŒ…æ‹¬æµ‹è¯•/æ‹’ç»é›†çš„æ•´ä¸ªæ•°æ®é›†ç”¨äºè®­ç»ƒã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ä½¿ç”¨`finalize_model`åï¼Œè¯¥æ¨¡å‹ç”¨äºå¯¹æ‹’ç»é›†è¿›è¡Œé¢„æµ‹ï¼Œæ‰“å°çš„ä¿¡æ¯ç½‘æ ¼å°†ä¼šäº§ç”Ÿè¯¯å¯¼ï¼Œå› ä¸ºæ‚¨æ­£è¯•å›¾å¯¹ç”¨äºå»ºæ¨¡çš„ç›¸åŒæ•°æ®è¿›è¡Œé¢„æµ‹ã€‚ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`predict_model`ä¸‹çš„`final_rf`æ¥æ¯”è¾ƒä¿¡æ¯ç½‘æ ¼å’Œä¸Šé¢ç¬¬ 13 èŠ‚ä¸­çš„ä¿¡æ¯ç½‘æ ¼ã€‚**

```
predict_model(final_rf);
```

**![](img/07007349f939befd74bf187acb311cb0.png)**

**è¯·æ³¨æ„`final_rf`ä¸­çš„ AUC æ˜¯å¦‚ä½•ä»`**0.7407**`å¢åŠ åˆ°`**0.7526**`çš„ï¼Œå°½ç®¡æ¨¡å‹æ˜¯ç›¸åŒçš„ã€‚è¿™æ˜¯å› ä¸º`final_rf`å˜é‡å·²ç»åœ¨åŒ…æ‹¬æµ‹è¯•/æ‹’ç»é›†çš„å®Œæ•´æ•°æ®é›†ä¸Šè¿›è¡Œäº†è®­ç»ƒã€‚**

# **15.0 æ ¹æ®çœ‹ä¸è§çš„æ•°æ®è¿›è¡Œé¢„æµ‹**

**`predict_model`å‡½æ•°ä¹Ÿç”¨äºå¯¹æœªçŸ¥æ•°æ®é›†è¿›è¡Œé¢„æµ‹ã€‚ä¸ä¸Šé¢ç¬¬ 13 èŠ‚å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œè¿™æ¬¡æˆ‘ä»¬å°†é€šè¿‡`data_unseen`ã€‚å®ƒæ˜¯åœ¨æœ¬æ•™ç¨‹å¼€å§‹æ—¶åˆ›å»ºçš„å˜é‡ï¼ŒåŒ…å«åŸå§‹æ•°æ®é›†çš„ 5% (1200 ä¸ªæ ·æœ¬)ï¼Œè¯¥æ•°æ®é›†ä»æœªæš´éœ²ç»™ PyCaretã€‚(å‚è§ç¬¬ 7 èŠ‚çš„è§£é‡Š)**

```
unseen_predictions = predict_model(final_rf, data=data_unseen)
unseen_predictions.head()
```

**![](img/0d9497bbf61a5ebed2f572bd55bd41b9.png)**

**`Label`å’Œ`Score`åˆ—è¢«æ·»åŠ åˆ°`data_unseen`ç»„ä¸­ã€‚æ ‡ç­¾æ˜¯é¢„æµ‹ï¼Œåˆ†æ•°æ˜¯é¢„æµ‹çš„æ¦‚ç‡ã€‚è¯·æ³¨æ„ï¼Œå½“æ‰€æœ‰è½¬æ¢éƒ½åœ¨åå°è‡ªåŠ¨æ‰§è¡Œæ—¶ï¼Œé¢„æµ‹ç»“æœä¼šè¿æ¥åˆ°åŸå§‹æ•°æ®é›†ã€‚æ‚¨è¿˜å¯ä»¥æ£€æŸ¥è¿™æ–¹é¢çš„æŒ‡æ ‡ï¼Œå› ä¸ºæ‚¨æœ‰ä¸€ä¸ªå®é™…çš„ç›®æ ‡åˆ—`default`å¯ç”¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`pycaret.utils`æ¨¡å—ã€‚è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹:**

```
**# check metric on unseen data** from pycaret.utils import check_metric
check_metric(unseen_predictions['default'], unseen_predictions['Label'], metric = 'Accuracy')**>>> OUTPUT** 0.8167
```

# **16.0 ä¿å­˜æ¨¡å‹**

**æˆ‘ä»¬ç°åœ¨å·²ç»é€šè¿‡æœ€ç»ˆç¡®å®š`tuned_rf`æ¨¡å‹å®Œæˆäº†å®éªŒï¼Œè¯¥æ¨¡å‹ç°åœ¨å­˜å‚¨åœ¨`final_rf`å˜é‡ä¸­ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨å­˜å‚¨åœ¨`final_rf`ä¸­çš„æ¨¡å‹æ¥é¢„æµ‹`data_unseen`ã€‚è¿™ä½¿æˆ‘ä»¬çš„å®éªŒæ¥è¿‘å°¾å£°ï¼Œä½†ä»æœ‰ä¸€ä¸ªé—®é¢˜è¦é—®:å½“ä½ æœ‰æ›´å¤šçš„æ–°æ•°æ®è¦é¢„æµ‹æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ å¿…é¡»å†æ¬¡ç»å†æ•´ä¸ªå®éªŒå—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼ŒPyCaret çš„å†…ç½®å‡½æ•°`save_model()`å…è®¸æ‚¨ä¿å­˜æ¨¡å‹å’Œæ•´ä¸ªè½¬æ¢ç®¡é“ä»¥å¤‡åç”¨ã€‚**

```
**# saving the final model** save_model(final_rf,'Final RF Model 11Nov2020')>>> Transformation Pipeline and Model Successfully Saved
```

# **17.0 åŠ è½½ä¿å­˜çš„æ¨¡å‹**

**ä¸ºäº†åœ¨å°†æ¥çš„æŸä¸€å¤©åœ¨ç›¸åŒæˆ–ä¸åŒçš„ç¯å¢ƒä¸­åŠ è½½å·²ä¿å­˜çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyCaret çš„`load_model()`å‡½æ•°ï¼Œç„¶åè½»æ¾åœ°å°†å·²ä¿å­˜çš„æ¨¡å‹åº”ç”¨äºæ–°çš„æœªçŸ¥æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚**

```
**# loading the saved model**
saved_final_rf = load_model('Final RF Model 11Nov2020')>>> Transformation Pipeline and Model Successfully Loaded
```

**ä¸€æ—¦æ¨¡å‹åŠ è½½åˆ°ç¯å¢ƒä¸­ï¼Œæ‚¨å°±å¯ä»¥ä½¿ç”¨ç›¸åŒçš„`predict_model()`å‡½æ•°ç®€å•åœ°ä½¿ç”¨å®ƒæ¥é¢„æµ‹ä»»ä½•æ–°æ•°æ®ã€‚ä¸‹é¢æˆ‘ä»¬åº”ç”¨åŠ è½½æ¨¡å‹æ¥é¢„æµ‹æˆ‘ä»¬åœ¨ä¸Šé¢ç¬¬ 13 èŠ‚ä¸­ä½¿ç”¨çš„ç›¸åŒçš„`data_unseen`ã€‚**

```
**# predict on new data** new_prediction = predict_model(saved_final_rf, data=data_unseen)
new_prediction.head()
```

**![](img/0d9497bbf61a5ebed2f572bd55bd41b9.png)**

**æ³¨æ„`unseen_predictions`å’Œ`new_prediction`çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚**

```
from pycaret.utils import check_metric
check_metric(new_prediction['default'], new_prediction['Label'], metric = 'Accuracy')>>> 0.8167
```

# **18.0 æ€»ç»“/åç»­æ­¥éª¤ï¼Ÿ**

**æœ¬æ•™ç¨‹æ¶µç›–äº†ä»æ•°æ®æ‘„å–ã€é¢„å¤„ç†ã€è®­ç»ƒæ¨¡å‹ã€è¶…å‚æ•°è°ƒæ•´ã€é¢„æµ‹å’Œä¿å­˜æ¨¡å‹ä»¥å¤‡åç”¨çš„æ•´ä¸ªæœºå™¨å­¦ä¹ ç®¡é“ã€‚æˆ‘ä»¬å·²ç»åœ¨ä¸åˆ° 10 ä¸ªå‘½ä»¤ä¸­å®Œæˆäº†æ‰€æœ‰è¿™äº›æ­¥éª¤ï¼Œè¿™äº›å‘½ä»¤æ˜¯è‡ªç„¶æ„å»ºçš„ï¼Œè®°å¿†èµ·æ¥éå¸¸ç›´è§‚ï¼Œä¾‹å¦‚`create_model()`ã€`tune_model()`ã€`compare_models()`ã€‚åœ¨æ²¡æœ‰ PyCaret çš„æƒ…å†µä¸‹ï¼Œé‡æ–°åˆ›å»ºæ•´ä¸ªå®éªŒåœ¨å¤§å¤šæ•°åº“ä¸­éœ€è¦ 100 å¤šè¡Œä»£ç ã€‚**

**æˆ‘ä»¬åªè®²è¿°äº†`pycaret.classification`çš„åŸºç¡€çŸ¥è¯†ã€‚åœ¨æœªæ¥çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°ç ”ç©¶é«˜çº§é¢„å¤„ç†ã€é›†æˆã€å¹¿ä¹‰å †å å’Œå…¶ä»–æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯å…è®¸æ‚¨å®Œå…¨å®šåˆ¶æ‚¨çš„æœºå™¨å­¦ä¹ ç®¡é“ï¼Œå¹¶ä¸”æ˜¯ä»»ä½•æ•°æ®ç§‘å­¦å®¶éƒ½å¿…é¡»çŸ¥é“çš„ã€‚**

**æ„Ÿè°¢æ‚¨é˜…è¯»[ğŸ™](https://emojipedia.org/folded-hands/)**

# **é‡è¦é“¾æ¥**

**â­ [æ•™ç¨‹](https://github.com/pycaret/pycaret/tree/master/tutorials)py caret æ–°æ‰‹ï¼ŸæŸ¥çœ‹æˆ‘ä»¬çš„å®˜æ–¹ç¬”è®°æœ¬ï¼
ğŸ“‹[ç¤¾åŒºåˆ›å»ºçš„ç¤ºä¾‹ç¬”è®°æœ¬](https://github.com/pycaret/pycaret/tree/master/examples)ã€‚
ğŸ“™[åšå®¢](https://github.com/pycaret/pycaret/tree/master/resources)æŠ•ç¨¿äººçš„æ•™ç¨‹å’Œæ–‡ç« ã€‚
ğŸ“š[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/index.html)py caret çš„è¯¦ç»† API æ–‡æ¡£
ğŸ“º[è§†é¢‘æ•™ç¨‹](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g)æˆ‘ä»¬çš„è§†é¢‘æ•™ç¨‹æ¥è‡ªå„ç§èµ›äº‹ã€‚
ğŸ“¢[è®¨è®º](https://github.com/pycaret/pycaret/discussions)æœ‰ç–‘é—®ï¼Ÿä¸ç¤¾åŒºå’Œè´¡çŒ®è€…äº’åŠ¨ã€‚
ğŸ› ï¸ [å˜æ›´æ—¥å¿—](https://github.com/pycaret/pycaret/blob/master/CHANGELOG.md)å˜æ›´å’Œç‰ˆæœ¬å†å²ã€‚
ğŸŒ³[è·¯çº¿å›¾](https://github.com/pycaret/pycaret/issues/1756) PyCaret çš„è½¯ä»¶å’Œç¤¾åŒºå¼€å‘è®¡åˆ’ã€‚**

# **ä½œè€…:**

**æˆ‘å†™çš„æ˜¯ PyCaret åŠå…¶åœ¨ç°å®ä¸–ç•Œä¸­çš„ç”¨ä¾‹ï¼Œå¦‚æœä½ æƒ³è‡ªåŠ¨å¾—åˆ°é€šçŸ¥ï¼Œä½ å¯ä»¥åœ¨[åª’ä½“](https://medium.com/@moez-62905)ã€ [LinkedIn](https://www.linkedin.com/in/profile-moez/) å’Œ [Twitter](https://twitter.com/moezpycaretorg1) ä¸Šå…³æ³¨æˆ‘ã€‚**