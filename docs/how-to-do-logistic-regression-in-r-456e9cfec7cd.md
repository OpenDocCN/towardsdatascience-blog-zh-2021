# å¦‚ä½•åœ¨ R ä¸­è¿›è¡Œé€»è¾‘å›å½’

> åŸæ–‡ï¼š<https://towardsdatascience.com/how-to-do-logistic-regression-in-r-456e9cfec7cd?source=collection_archive---------11----------------------->

## è§£é‡Šã€é¢„æµ‹å’Œè¯„ä¼°å¸¦æœ‰ä¸å¿ æ•°æ®çš„é€»è¾‘å›å½’ç¤ºä¾‹

![](img/b7f059d3f3f9e957cc320bc7b875f5a6.png)

ç…§ç‰‡ç”± [Pexels](https://www.pexels.com/photo/magnifying-glass-on-white-paper-6120207/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels) çš„ Nataliya Vaitkevich æ‹æ‘„

> **ç®€ä»‹**

[**é€»è¾‘å›å½’**](https://en.wikipedia.org/wiki/Logistic_regression) æ˜¯å¹¿ä¹‰çº¿æ€§æ¨¡å‹æœ€æµè¡Œçš„å½¢å¼ä¹‹ä¸€ã€‚å¦‚æœæ‚¨æƒ³ä»ä¸€ç»„è¿ç»­å’Œ/æˆ–åˆ†ç±»é¢„æµ‹å˜é‡ä¸­é¢„æµ‹äºŒå…ƒç»“æœï¼Œå®ƒä¼šå¾ˆæ–¹ä¾¿ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ•°æ®é›†è®¨è®ºå¦‚ä½•åœ¨ R ä¸­ä½¿ç”¨é€»è¾‘å›å½’çš„æ¦‚è¿°ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨[ä¸å¿ æ•°æ®](https://rdrr.io/cran/AER/man/Affairs.html)ä½œä¸ºæˆ‘ä»¬çš„ç¤ºä¾‹æ•°æ®é›†ï¼Œç§°ä¸º Fair's Affairsï¼Œå®ƒåŸºäºã€Šä»Šæ—¥å¿ƒç†å­¦ã€‹åœ¨ 1969 å¹´è¿›è¡Œçš„ä¸€é¡¹æ¨ªæˆªé¢è°ƒæŸ¥ï¼Œå¹¶åœ¨ Greene (2003)å’Œ Fair (1978)ä¸­è¿›è¡Œäº†æè¿°ã€‚è¯¥æ•°æ®åŒ…å«ä» 601 åå—è®¿è€…ä¸­æ”¶é›†çš„ 9 ä¸ªå˜é‡ï¼Œè¿™äº›å˜é‡åŒ…å«çš„ä¿¡æ¯åŒ…æ‹¬ä»–ä»¬åœ¨è¿‡å»å‡ å¹´ä¸­å‘ç”Ÿå©šå¤–æƒ…çš„é¢‘ç‡ï¼Œä»¥åŠä»–ä»¬çš„å¹´é¾„ã€æ€§åˆ«ã€æ•™è‚²ç¨‹åº¦ã€ç»“å©šå¹´é™ã€æœ‰æ— å­å¥³(æ˜¯/å¦)ã€å®—æ•™ä¿¡ä»°ç¨‹åº¦(ä» 1 =åå¯¹åˆ° 5 =éå¸¸)ã€èŒä¸š(7 åˆ†åˆ¶)ä»¥åŠå¯¹å©šå§»å¹¸ç¦åº¦çš„è‡ªæˆ‘è¯„çº§(ä» 1 =éå¸¸ä¸å¹¸ç¦åˆ° 5 =éå¸¸å¹¸ç¦)ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€äº›è§‚å¯Ÿç»“æœï¼Œè®©æ‚¨å¯¹æ•°æ®æœ‰ä¸€ä¸ªæ€»ä½“çš„äº†è§£ã€‚

![](img/47b86ee83478255ff7ffdf582a2e0baf.png)

AER åŒ…ä¸­çš„ä¸å¿ æ•°æ®æ ·æœ¬

è¿ç”¨é€»è¾‘å›å½’ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å“ªäº›å› ç´ å¯¹ä¸å¿ è´¡çŒ®æœ€å¤§ã€‚ç„¶åï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªæ¨¡å‹æ¥æ£€æŸ¥ä½ å’Œä½ çš„ä¼´ä¾£ä¹‹é—´å“ªä¸€ä¸ªæ›´æœ‰å¯èƒ½æœ‰å¤–é‡ğŸ˜œ

ä½†æ˜¯ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸‹é¢çš„ä»£ç è¿è¡Œä¸€äº›æè¿°æ€§çš„ç»Ÿè®¡æ•°æ®ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£æˆ‘ä»¬çš„æ•°æ®ã€‚

```
# How to do Logistic Regression in R
# Created by Michaelino Mervisiano> install.packages("AER")
> library("AER")> data(Affairs, package="AER")
> View(Affairs)
> summary(Affairs)
 affairs        **gender**      **age**            yearsmarried    **children**
 Min.  : 0.0    female:315  Min. :17.50    Min. : 0.125     no :171
 1st Qu: 0.0    male :**286**   1st Qu:27.00   1st Qu: 4.000    yes:**430**
 Median : 0.0               Median :32.00  Median : 7.000
 Mean : 1.456               Mean :**32.49**    Mean : 8.178
 3rd Qu.: 0.0               3rd Qu.:37.00  3rd Qu.:15.000
 Max. :12.0                 Max. :57.00    Max. :15.000 religiousness  education     occupation   rating
 Min. :1        Min. : 9.0    Min. :1.0    Min. :1.000
 1st Qu:2       1st Qu:14.0   1st Qu:3.0   1st Qu:3.000
 Median :3      Median :16.0  Median :5.0  Median :4.000
 Mean :3.116    Mean :16.17   Mean :4.195  Mean :3.932
 3rd Qu.:4      3rd Qu.:18.0  3rd Qu.:6.0  3rd Qu.:5.000
 Max. :5        Max. :20.0    Max. :7.0    Max. :5.000>table(Affairs$**affairs**) 
 0   1  2  3  7   12 
451 34 17 19  42  38
```

ä»ä¸Šé¢çš„æ€»ç»“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ 286 åç”·æ€§å—è®¿è€…(å æ•´ä½“å—è®¿è€…çš„ 48%)ï¼Œ430 åå—è®¿è€…æœ‰å­©å­(å æ•´ä½“å—è®¿è€…çš„ 72%)ï¼Œæˆ‘ä»¬çš„å—è®¿è€…çš„å¹³å‡å¹´é¾„ä¸º 32.5 å²ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å‘ç° 451 åå—è®¿è€…å£°ç§°åœ¨è¿‡å»çš„ä¸€å¹´ä¸­æ²¡æœ‰å¤–é‡ã€‚è¿™æ„å‘³ç€ 25%çš„å—è®¿è€…æœ‰å©šå¤–æƒ…ï¼Œæœ€å¤šçš„æ˜¯ 12 äººã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ 6%çš„å—è®¿è€…æ¯æœˆæœ‰ä¸€æ¬¡å©šå¤–æƒ…ğŸ˜ã€‚

å› ä¸ºæˆ‘ä»¬å¯¹å›åº”å˜é‡çš„äºŒå…ƒç»“æœæ„Ÿå…´è¶£(æœ‰å¤–é‡/æ²¡å¤–é‡)ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç å°†äº‹åŠ¡è½¬æ¢æˆä¸€ä¸ªåä¸º ***ynaffair*** çš„
äºŒå…ƒå˜é‡ã€‚

```
> Affairs$**ynaffair**[Affairs$affairs >  0] <- 1
> Affairs$**ynaffair**[Affairs$affairs == 0] <- 0> Affairs$ynaffair <- factor(Affairs$ynaffair,levels=c(0,1), labels=c("No","Yes"))> table(Affairs$ynaffair)
No   Yes
451  150
```

> **ç”¨é€»è¾‘å›å½’æ‹Ÿåˆæ¨¡å‹**

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œé€»è¾‘å›å½’æ¥æµ‹é‡ååº”å˜é‡(äº‹ä»¶)å’Œè§£é‡Šå˜é‡(å¹´é¾„ã€æ€§åˆ«ã€æ•™è‚²ã€èŒä¸šã€å­å¥³ã€è‡ªæˆ‘è¯„ä»·ç­‰)ä¹‹é—´çš„å…³ç³»ã€‚

```
> **fit.full** <- glm(ynaffair ~ gender + age + yearsmarried + children 
              + religiousness + education + occupation +rating,
              data=Affairs, family=binomial())> summary(fit.full)
Deviance Residuals:
 Min        1Q    Median     3Q      Max
-1.571   -0.750   -0.569   -0.254   2.519Coefficients:
              Estimate  Std. Error  z value  **Pr(>|z|)**
(Intercept)    1.3773    0.8878     1.55     0.12081
gendermale     0.2803    0.2391     1.17     0.24108
age           -0.0443    0.0182    -2.43     0.01530 *
yearsmarried   0.0948    0.0322     2.94     0.00326 **
childrenyes    0.3977    0.2915     1.36     0.17251
religiousness -0.3247    0.0898    -3.62     0.00030 ***
education      0.0211    0.0505     0.42     0.67685
occupation     0.0309    0.0718     0.43     0.66663
rating        -0.4685    0.0909    -5.15     2.6e-07 ***
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Dispersion parameter for binomial family taken to be 1)
 Null deviance: 675.38 on 600 degrees of freedom
Residual deviance: 609.51 on 592 degrees of freedom
AIC: 627.5
Number of Fisher Scoring iterations: 4
```

å¦‚æœæˆ‘ä»¬è§‚å¯Ÿå›å½’ç³»æ•°çš„ ***Pr( > |z|)*** æˆ– p å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç°æ€§åˆ«ã€æœ‰æ— å­å¥³ã€æ•™è‚²å’ŒèŒä¸šå¯¹æˆ‘ä»¬çš„ååº”å˜é‡æ²¡æœ‰æ˜¾è‘—è´¡çŒ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ‹Ÿåˆç¬¬äºŒä¸ªæ¨¡å‹ï¼ŒåªåŒ…æ‹¬å¹´é¾„ã€ç»“å©šå¹´æ•°ã€å®—æ•™ä¿¡ä»°å’Œè¯„çº§ç­‰é‡è¦å˜é‡æ¥æ‹Ÿåˆæ•°æ®ã€‚

```
> **fit.reduced**  <- glm(ynaffair ~ age + yearsmarried + religiousness
                   + rating, data=Affairs, family=binomial())
> summary(fit.reduced)
Deviance Residuals:
 Min      1Q      Median   3Q       Max
-1.628   -0.755   -0.570   -0.262   2.400Coefficients:
              Estimate  Std. Error  z value  **Pr(>|z|)**
(Intercept)     1.9308  0.6103      3.16     0.00156 **
age            -0.0353  0.0174     -2.03     0.04213 *
yearsmarried    0.1006  0.0292      3.44     0.00057 ***
religiousness  -0.3290  0.0895     -3.68     0.00023 ***
rating         -0.4614  0.0888     -5.19     2.1e-07 ***
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Dispersion parameter for binomial family taken to be 1)
 Null deviance: 675.38 on 600 degrees of freedom
Residual deviance: 615.36 on 596 degrees of freedom
AIC: 625.4
Number of Fisher Scoring iterations: 4
```

å¯¹äºç¬¬äºŒä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªå›å½’ç³»æ•°çš„ p å€¼åœ¨ç»Ÿè®¡ä¸Šæ˜¯æ˜¾è‘—çš„ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ R ä¸­çš„ anova å‡½æ•°è¿›è¡Œå¡æ–¹æ£€éªŒï¼Œä»¥æ¯”è¾ƒç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ¨¡å‹ã€‚æˆ‘ä»¬å°†çœ‹åˆ°å“ªä¸ªæ¨¡å‹èƒ½æ›´å¥½åœ°è§£é‡Šæˆ‘ä»¬çš„ååº”å˜é‡ã€‚

```
> anova(**fit.reduced**, **fit.full**, test="Chisq") 
Analysis of Deviance Table 
Model 1: ynaffair ~ age + yearsmarried + religiousness + rating Model 2: ynaffair ~ gender + age + yearsmarried + children +
                    religiousness + education + occupation + rating
   Resid.Df  Resid.Dev  Df  Deviance  P(>|Chi|) 
1  596       615 
2  592       610        4    5.85      **0.21**
```

ä¸Šé¢çš„è¾“å‡ºæ˜¾ç¤ºäº† p å€¼= 0.21 çš„éæ˜¾è‘—æ€§å¡æ–¹å€¼ã€‚è¿™æ„å‘³ç€åªæœ‰å››ä¸ªé¢„æµ‹å€¼çš„ç¬¬äºŒä¸ªæ¨¡å‹ä¸æœ‰ä¹ä¸ªé¢„æµ‹å€¼çš„å®Œæ•´æ¨¡å‹ä¸€æ ·é€‚åˆã€‚å®ƒæ”¯æŒäº†æˆ‘ä»¬æœ€åˆçš„ä¿¡å¿µï¼Œå³æ€§åˆ«ã€å­©å­ã€æ•™è‚²å’ŒèŒä¸šå¯¹é¢„æµ‹ä¸å¿ æ²¡æœ‰ä»»ä½•è´¡çŒ®(æˆ‘ä»¬çš„ååº”å˜é‡)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ç»§ç»­åˆ†æç¬¬äºŒä¸ªæ¨¡å‹ï¼Œå› ä¸ºåœ¨æ›´ç®€å•çš„æ¨¡å‹ä¸Šæ›´å®¹æ˜“è¿›è¡Œæˆ‘ä»¬çš„è§£é‡Šã€‚

> **è§£é‡Šæ¨¡å‹å‚æ•°**

åŸºäºç¬¬äºŒä¸ªæ¨¡å‹çš„å›å½’ç³»æ•°ï¼Œæˆ‘ä»¬çœ‹åˆ°å©šå¤–æƒ…çš„å‡ ç‡éšç€ç»“å©šå¹´é™çš„å¢åŠ è€Œå¢åŠ ï¼Œéšç€å¹´é¾„ã€å®—æ•™ä¿¡ä»°å’Œå¹¸ç¦è‡ªæˆ‘è¯„ä¼°è€Œå‡å°‘ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®æ¯ä¸ªå›å½’ç³»æ•°çš„æ­£è´Ÿç¬¦å·æ¥è§‚å¯Ÿå®ƒã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ä½ ç»“å©šçš„æ—¶é—´è¶Šé•¿ï¼Œä½ å°±è¶Šæœ‰å¯èƒ½æœ‰å¤–é‡ã€‚å¦ä¸€æ–¹é¢ï¼Œä½ åœ¨å©šå§»ä¸­è¶Šå¿«ä¹ï¼Œä½ å°±è¶Šä¸å¯èƒ½æœ‰å¤–é‡ã€‚

```
> coef(fit.reduced) 
(Intercept)   age  yearsmarried  religiousness   rating 
   1.931    -0.035     0.101        -0.329        -0.461
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“è¿™äº›å˜é‡å¯¹*äº‹ä»¶*çš„å½±å“å€¼ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®°ä½ï¼Œé€»è¾‘å›å½’æ¨¡å‹çš„ååº”å˜é‡å¯¹æ•°(èµ”ç‡)Y = 1ã€‚è¿™æ„å‘³ç€å›å½’ç³»æ•°å…è®¸é¢„æµ‹å˜é‡å•ä½å˜åŒ–å›æŠ¥çš„å¯¹æ•°å˜åŒ–(ä¼˜åŠ¿)ï¼Œä¿æŒæ‰€æœ‰å…¶ä»–é¢„æµ‹å˜é‡ä¸å˜ã€‚

ç”±äº log(odds)å¾ˆéš¾è§£é‡Šï¼Œæˆ‘ä»¬å°†é€šè¿‡å¯¹ç»“æœæ±‚å¹‚æ¥è½¬æ¢å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤º

```
> exp(coef(fit.reduced))  
(Intercept)  age    yearsmarried  religiousness   rating  
   6.895    0.965     1.106         0.720          0.630
```

æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œç»“å©šå¹´æ•°æ¯å¢åŠ ä¸€å¹´ï¼Œå‡ºè½¨çš„å‡ ç‡å°±ä¼šå¢åŠ  1.106 å€(å¹´é¾„ã€å®—æ•™ä¿¡ä»°å’Œå¹¸ç¦æŒ‡æ•°ä¿æŒä¸å˜)ã€‚ç›¸åï¼Œå¹´é¾„æ¯å¢åŠ ä¸€å²ï¼Œå‡ºè½¨çš„å‡ ç‡å°±ä¼šå¢åŠ  0.965 å€ã€‚è¿™æ„å‘³ç€éšç€å¹´é¾„çš„å¢é•¿ï¼Œå‡ºè½¨çš„å‡ ç‡ä¼šä¸‹é™ 3.5%ã€‚

æ­¤å¤–ï¼Œå¯¹äºé¢„æµ‹å˜é‡ä¸­çš„ *n* å•ä½å˜åŒ–ï¼Œå“åº”å˜é‡ä¸Šçš„è¾ƒé«˜å€¼çš„æ¦‚ç‡å˜åŒ–æ˜¯*exp*(*Î²j*)^*n*ã€‚é‚£ä¹ˆï¼Œåœ¨ä¿æŒå…¶ä»–é¢„æµ‹å˜é‡ä¸å˜çš„æƒ…å†µä¸‹ï¼Œ15 å¹´çš„å¢é•¿å°†ä½¿å‡ ç‡å¢åŠ  1.106 âµâ‰ˆ4.5ã€‚

> **ä½¿ç”¨æ–°æ•°æ®é¢„æµ‹ç»“æœ**

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬æ„å»ºçš„æ¨¡å‹æ¥é¢„æµ‹æ–°æ•°æ®çš„ç»“æœã€‚ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŒ…å«æˆ‘ä»¬æ„Ÿå…´è¶£çš„é¢„æµ‹å˜é‡çš„å€¼çš„æ–°æ•°æ®ã€‚ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬å°†åº”ç”¨ R ä¸­çš„ *predict()* å‡½æ•°ï¼Œæ ¹æ®æ–°æ•°æ®ä¸­çš„å€¼æ¥ä¼°è®¡ç»“æœäº‹ä»¶çš„æ¦‚ç‡ã€‚

è€ƒè™‘ä¸‹é¢çš„æ–°æ•°æ®ï¼Œæˆ‘ä»¬æœ‰ 5 ä¸ªä¸åŒè‡ªæˆ‘è¯„ä»·çš„æ–°å—è®¿è€…ï¼Œå°†å…¶ä»–å˜é‡è®¾ä¸ºæ•´ä½“æ•°æ®çš„å¹³å‡å€¼ã€‚ç„¶åï¼Œæˆ‘ä»¬åº”ç”¨é¢„æµ‹å‡½æ•°æ¥è·å¾—è¿™äº›æ–°å—è®¿è€…çš„å¤–é‡æ¦‚ç‡ã€‚

```
> newdata1 <- data.frame(rating=c(1,2,3,4,5),age=mean(Affairs$age),
                         yearsmarried=mean(Affairs$yearsmarried),
                         religiousness=mean(Affairs$religiousness))
> newdata1
   **rating**  age    yearsmarried  religiousness
1  **1**       32.5     8.18           3.12
2  **2**       32.5     8.18           3.12
3  **3**       32.5     8.18           3.12
4  **4**       32.5     8.18           3.12
5  **5**       32.5     8.18           3.12> newdata1$prob <- **predict**(fit.reduced, newdata=newdata1,
                           type="response")
> newdata1
   **rating**  age    yearsmarried   religiousness  ***prob***
1  **1**       32.5     8.18            3.12        **0.530**
2  **2**       32.5     8.18            3.12        **0.416**
3  **3**       32.5     8.18            3.12        **0.310**
4  **4**       32.5     8.18            3.12        **0.220**
5  **5**       32.5     8.18            3.12        **0.151**
```

æ˜¾ç„¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å©šå¤–æƒ…å‡ ç‡ä»å©šå§»è¢«è¯„ä¸º 1 åˆ†â€œéå¸¸ä¸å¹¸ç¦â€æ—¶çš„ 0.53 ä¸‹é™åˆ°å©šå§»è¢«è¯„ä¸º 5 åˆ†â€œéå¸¸å¹¸ç¦â€æ—¶çš„ 0.15(ä¿æŒå…¶ä»–é¢„æµ‹å˜é‡ä¸å˜)ã€‚è¿™è¡¨æ˜ä¸å¹¸ç¦çš„å¤«å¦‡æ¯”å¹¸ç¦çš„å¤«å¦‡æœ‰ä¸‰å€çš„å¯èƒ½å‡ºè½¨ã€‚

è®©æˆ‘ä»¬åˆ›å»ºå¦ä¸€ä¸ªæ–°æ•°æ®æ¥è§‚å¯Ÿå¹´é¾„å¯¹ä¸å¿ çš„å½±å“

```
> newdata2 <- data.frame(rating=mean(Affairs$rating),
                         age=(17,27,37,47, 57),
                         yearsmarried=mean(Affairs$yearsmarried),
                         religiousness=mean(Affairs$religiousness))
> newdata2
  rating  **age ** yearsmarried  religiousness
1  3.93   **17**     8.18           3.12
2  3.93   **27 **    8.18           3.12
3  3.93   **37 **    8.18           3.12
4  3.93   **47 **    8.18           3.12
5  3.93   **57**     8.18           3.12
> newdata2$prob <- **predict**(fit.reduced, newdata=newdata2, 
                           type="response")
> newdata2
  rating  **age**  yearsmarried  religiousness  **prob**
1  3.93   **17**     8.18           3.12        **0.335**
2  3.93   **27 **    8.18           3.12        **0.262**
3  3.93   **37 **    8.18           3.12        **0.199**
4  3.93   **47 **    8.18           3.12        **0.149**
5  3.93  ** 57**     8.18           3.12        **0.109**
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°éšç€å¹´é¾„ä» 17 å²å¢åŠ åˆ° 57 å²ï¼Œåœ¨ä¿æŒå…¶ä»–å˜é‡ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå‡ºè½¨çš„æ¦‚ç‡ä» 0.34 ä¸‹é™åˆ° 0.11ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£æ¢ç´¢å…¶ä»–é¢„æµ‹å˜é‡çš„å½±å“æˆ–é¢„æµ‹å…¶ä»–æ–°æ•°æ®ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥è¿›ä¸€æ­¥åˆ†æå®ƒã€‚

> **è¯„ä¼°è¿‡åº¦åˆ†æ•£**

åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥ä»äºŒé¡¹å¼åˆ†å¸ƒä¸­æå–çš„æ•°æ®çš„æœŸæœ›æ–¹å·®*Ïƒ2 = n*Ï€*(1*Ï€*)*ï¼Œå…¶ä¸­ *n* æ˜¯è§‚å¯Ÿæ¬¡æ•°ï¼ŒÏ€æ˜¯å±äº Y = 1 ç»„çš„æ¦‚ç‡ã€‚

[è¿‡åº¦åˆ†æ•£](https://online.stat.psu.edu/stat504/node/162/)å‘ç”Ÿåœ¨å‡è®¾çš„åˆ†å¸ƒä¸‹ï¼Œå½“æ•°æ®å…è®¸æ¯”é¢„æœŸæ›´å¤šçš„å¯å˜æ€§æ—¶ã€‚å¦‚æœ**æ•°æ®é›†ä¸­å­˜åœ¨**è¿‡åº¦åˆ†æ•£ï¼Œä¼°è®¡çš„æ ‡å‡†è¯¯å·®å’Œæµ‹è¯•ç»Ÿè®¡çš„æ€»ä½“æ‹Ÿåˆä¼˜åº¦å°†ä¼šå¤±çœŸï¼Œå¿…é¡»è¿›è¡Œè°ƒæ•´ã€‚è§£å†³æ–¹æ¡ˆä¹‹ä¸€ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ r ä¸­çš„ glm()å‡½æ•°ä½¿ç”¨æ‹ŸäºŒé¡¹åˆ†å¸ƒè€Œä¸æ˜¯äºŒé¡¹åˆ†å¸ƒã€‚

æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥éªŒè¯æˆ‘ä»¬æ˜¯å¦å­˜åœ¨è¿‡åº¦åˆ†æ•£é—®é¢˜:

ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å‰©ä½™åå·®é™¤ä»¥äºŒé¡¹å¼æ¨¡å‹çš„å‰©ä½™è‡ªç”±åº¦æ¥æ£€æŸ¥è¿‡åº¦ç¦»å·®ã€‚

![](img/0fd283ee9f3aa72fbfcb49fe9db3bd3a.png)

è¿‡åº¦ç¦»å·®ç‡

å¦‚æœè¯¥æ¯”ç‡æ˜æ˜¾å¤§äº 1ï¼Œåˆ™è¡¨æ˜æˆ‘ä»¬å­˜åœ¨è¿‡åº¦åˆ†æ•£é—®é¢˜ã€‚ä½¿ç”¨æˆ‘ä»¬çš„æ•°æ®ç¤ºä¾‹è®¡ç®—è¯¥æ¯”ç‡ï¼Œæˆ‘ä»¬å‘ç°è¯¥æ¯”ç‡æ¥è¿‘ 1ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„æ¨¡å‹æ²¡æœ‰è¿‡åº¦åˆ†æ•£çš„é—®é¢˜ã€‚

```
> deviance(fit.reduced)/df.residual(fit.reduced) 
[1]  1.032
```

ç¬¬äºŒç§æ–¹æ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæ¨¡å‹æ¥æ£€éªŒè¿‡åº¦ç¦»å·®ã€‚åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸¤ç§ä¸åŒçš„æ¨¡å‹å’Œä¸åŒçš„åˆ†å¸ƒæ¥æ‹Ÿåˆé€»è¾‘å›å½’ã€‚ç„¶åï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æœ‰ç»Ÿè®¡è¯æ®è¡¨æ˜ä¸¤ä¸ªæ¨¡å‹çš„æœŸæœ›æ–¹å·®æ˜¾è‘—ä¸åŒã€‚

```
> fit    <- glm(ynaffair ~ age + yearsmarried + religiousness +
             rating, family = **binomial()**, data = Affairs)
> fit.od <- glm(ynaffair ~ age + yearsmarried + religiousness +
             rating, family = **quasibinomial()**, data = Affairs)> pchisq(summary(fit.od)$dispersion * fit$df.residual,
 fit$df.residual, lower = F)
[1]  **0.34**
```

æˆ‘ä»¬å‘ç° p å€¼=0.34 æ˜¾ç„¶ä¸æ˜¾è‘—(p > 0.05)ï¼Œè¿™åŠ å¼ºäº†æˆ‘ä»¬çš„ä¿¡å¿µï¼Œå³è¿‡åº¦åˆ†æ•£åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­ä¸æ˜¯é—®é¢˜

æˆ‘å¸Œæœ›ä½ å‘ç°è¿™ç¯‡æ–‡ç« æ˜¯æœ‰ç”¨çš„ï¼Œå¹¶ä¸ä»–äººåˆ†äº«

å¹²æ¯ï¼Œ

ç±³å¤é‡Œè¯ºÂ·æ¢…å°”ç»´è¥¿äºšè¯º