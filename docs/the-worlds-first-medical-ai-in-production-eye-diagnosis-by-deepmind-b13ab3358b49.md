# 世界上第一个量产的大规模医疗 AI——deep mind 的眼部诊断

> 原文：<https://towardsdatascience.com/the-worlds-first-medical-ai-in-production-eye-diagnosis-by-deepmind-b13ab3358b49?source=collection_archive---------28----------------------->

## 将人工智能系统引入世界上最古老的眼科医院，也是欧洲和北美最大的眼科医院——摩尔菲尔德眼科医院

![](img/be7d3f14aa4218de868be75ccf6d1344.png)

由 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的 [v2osk](https://unsplash.com/@v2osk?utm_source=medium&utm_medium=referral) 拍摄的照片

如果你已经关注我一段时间了，你就知道我在医学人工智能方面有很大进展。在过去的几个月/几年里，我一直在阅读大量令人惊叹的论文，这些论文取得了巨大的成就，我还写了一些关于它们的评论。不过，我前几天还在想，那些纸真的用了吗？还是它们已经成为历史了？这就是我决定回顾这篇论文的原因，这篇论文实际上已经从研究实验室进入生产阶段。

不久前，Deepmind 发布了一个 AI 系统，该系统可以在英国 Moorefield's hospital 自动诊断特定的眼疾。我想我们现在都知道，你可以在任何监督的图像分类任务上获得 0.95+ AUC(使用像 ResNet/EfficientNet 这样的 SOTA 模型)，这很棒。但就这样吗？比如这是否意味着这款车型可以投产？嗯，没有。

最近我被投入了一段独特的经历。我被要求在一家真实的医院实现一个诊断青光眼(一种眼病)的人工智能系统。我在想，如果你有一个带标签的数据集和一个 ResNet 模型，这将会很容易。然而，我发现我只是这么想，因为我只是在考虑优化一个性能指标，这通常是你在像 Kaggle 竞赛这样的项目中所做的。

我想在这里重点关注 Deepmind 在将人工智能系统投入生产时必须克服的现实世界的挑战，特别是在医疗保健领域，误报不会太多。因为我觉得 AI 研究处于一个非常好的位置，而生产 AI 就是不行。

> 我们不仅仅希望这是一个学术上有趣的结果——我们希望它能用于真正的治疗。因此，我们的论文也承担了人工智能在临床实践中的关键障碍之一

来源: [Deepmind](https://deepmind.com/blog/article/moorfields-major-milestone)

Deepmind 的系统正被 Moorefield 的眼科医院用于诊断 50 多种威胁视力的眼病。其诊断结果主要为医生提供分割图(可解释性)以及该患者是否需要紧急护理。我不希望这篇文章只是另一篇解释他们在模型中使用了什么技巧来达到良好性能的文章，我希望这篇文章主要强调他们面临的独特问题。

> 我们开发的系统旨在应对这一挑战。它不仅可以在几秒钟内自动检测眼部疾病的特征，还可以通过建议是否应该转诊治疗来优先考虑最需要紧急护理的患者。这种即时分类过程应该可以大大缩短扫描和治疗之间的时间，帮助糖尿病眼病和年龄相关性黄斑变性的患者避免失明。

来源: [Deepmind](https://deepmind.com/blog/article/moorfields-major-milestone)

## Deepmind 面临的最大挑战:

## 1.你得小心数据集，我不是指它的质量！—超越交叉验证的概括

我很确定这不是第一次有人试图将医疗人工智能系统投入生产。事实上，我以前读过一篇文章，关于谷歌试图在印度将糖尿病视网膜病变人工智能检测系统投入生产，但失败了，你可以在这里阅读更多关于[的内容。但主要的要点是，即使他们有一个包含高质量图像和标签的巨大数据集，主要问题是这个数据集**不是真实世界数据集的良好表示，因此人工智能无法正确地概括。**](https://www.healthcareitnews.com/news/google-verily-using-ai-screen-diabetic-retinopathy-india)

通常，在人工智能项目的开始，你只需要寻找高质量的数据集，然后建立模型并进行优化。你必须考虑这个数据集实际上是否会与真实世界的数据集相似。我想，除非您尝试将您的系统投入生产，否则您通常无法判断，但是记住这一原则会有所帮助。

我在这里的意思是，他们的数据集没有任何质量不清楚的图像，那里有一些伪像或噪声，这是不现实的！一个可能的解决方案是使用预处理技术来消除这些问题。

好吧，那么 Deepmind 在这里做了什么不同的事情来解决这个问题呢？最初他们犯了一个类似的错误，他们只在一种 OCT 扫描上训练他们的模型。但是当他们测试不同类型的扫描(由不同品牌的 OCT 扫描仪提供)时，他们的模型失败了。好消息是，大多数 OCT 扫描只有两种类型，所以他们只是在这两种类型上训练他们的模型。然而，他们增加了另一个部分来提高他们的概括能力，这是我将要谈到的。

**2。AI 系统的用户不仅仅需要预测，他们还需要了解** [**系统如何达到这个预测**](https://www.kdnuggets.com/2018/12/machine-learning-explainability-interpretability-ai.html)

![](img/3d08ceeea74f9d06b13eda538f99dcec.png)

莫里茨·金德勒在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

这听起来可能很明显，但是相信我，这并不明显。当我展示我为客户构建的深度学习模型，并向他们提供所有指标来证明其性能时，这对他们来说还不够。他们需要系统给出某种解释。我能理解为什么在医疗环境中需要这个。

为此，deepmind 在他们的监督网络中增加了一个预处理阶段。他们增加了一个由 **5 个不同的 U 型网络**组成的整体，在将 OCT 扫描的热图传递给监管网络之前，这些网络会发出热图。医生可以在人工智能系统中查看这些热图，作为人工智能系统真正理解 OCT 扫描的不同部分的指示。

实际上，当他们在不同类型的扫描上测试他们的模型时，他们失败了，热图也显示了这一点。OCT 扫描的不同部分没有被正确分割。

我还想强调 5 个不同网络的组合，因为我认为这是提高你的人工智能系统通用性的一个很好的方法(因为其中一个网络可能会失败，但不是所有的网络)。

在神经网络中提供可解释性的另一个好主意是显著图。显著图提供了一种 CNN 激活的热图。这基本上显示了图像中有助于分类的部分和无助于最终预测的部分。

[](https://medium.com/@ODSC/visualizing-your-convolutional-neural-network-predictions-with-saliency-maps-9604eb03d766) [## 使用显著图可视化您的卷积神经网络预测

### 在许多情况下，理解为什么模型预测一个给定的结果是一个关键的细节，模型用户和必要的…

medium.com](https://medium.com/@ODSC/visualizing-your-convolutional-neural-network-predictions-with-saliency-maps-9604eb03d766) 

**3。即使你的模型表现出色，你也必须满足某些标准**

我原本以为 ML 都是优化某个度量，其实不是，你要考虑很多其他因素。在临床环境中，假阳性比假阴性更糟糕。为了生产一个成功的医学人工智能模型，你必须有一个低的假阳性率。因为想想看，如果一个病人真的患有疾病，而你没有预测到，那么后果将是有害的(但反过来就不是这样了)。

这项研究的一个重要部分是研究:

1.  当这些假阳性发生时
2.  为什么
3.  以及如何减少它们

这种方法的一个很好的例子是这篇[论文](https://bjo.bmj.com/content/early/2020/10/01/bjophthalmol-2020-317327)，其中他们试图做一个与这里非常相似的任务(诊断眼病的人工智能系统)。他们有一个完整的部分叫做“假阴性和假阳性结果”，我不想进入细节，因为它非常具体。然而，我认为我想强调的主要观点是，即使你有很少的假阳性或假阴性，**查看这些数据点，评估和检查它们将极大地提高性能和你对你试图建立的 ML 系统的理解。**

基本上我认为其他的标准是:

*   **一般化证明**
*   **解释模型**的方法，例如分割图、热图、激活模型、显著图。(如果感兴趣，请查看 [Deepdream](https://www.tensorflow.org/tutorials/generative/deepdream)

这两个标准需要大量的工作，在某些情况下甚至比优化性能还要多。我还认为，当将模型投入生产时，您将不得不考虑测试泛化的其他方法(在交叉验证指标之上)，这可能相当具有挑战性。我能想到的唯一方法就是在生产场景中测试模型！但是，我知道这不太可能。请在评论中告诉我你的想法。

## 最后的想法和收获

总而言之，我只想强调我在试图构建一个生产医疗人工智能系统时得到的一些最重要的结论。无论如何，我很确定，即使这份报纸没有变成一种产品，它也可能帮助了其他报纸。