# çˆ±å› æ–¯å¦æŒ‡æ•°ç¬¦å·

> åŸæ–‡ï¼š<https://towardsdatascience.com/einstein-index-notation-d62d48795378?source=collection_archive---------11----------------------->

## çˆ±å› æ–¯å¦æ±‚å’Œã€æŒ‡æ•°ç¬¦å·å’Œæ•°å€¼

![](img/bf7111caf64e8682e4694949100c7bd3.png)

ç…§ç‰‡ç”±[æ±‰å°¼æ–¯Â·é‡Œå…‹ç‰¹](https://unsplash.com/@weristhari?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

# çˆ±å› æ–¯å¦ç¬¦å·ä¸çŸ©é˜µ

ä½œä¸ºä¸€ä¸ªçº¿æ€§ä»£æ•°è¿·ï¼Œå‘é‡å’ŒçŸ©é˜µè¿·ï¼Œæˆ‘å¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½ä¸æ¸…æ¥šä¸ºä»€ä¹ˆæˆ‘åº”è¯¥ä½¿ç”¨çˆ±å› æ–¯å¦ç¬¦å·ã€‚ä½†æ˜¯å½“æˆ‘å¯¹åå‘ä¼ æ’­å¾®ç§¯åˆ†æ„Ÿå…´è¶£çš„æ—¶å€™ï¼Œæˆ‘åˆ°äº†ä¸€ä¸ªç‚¹ï¼Œå¼ é‡å‚ä¸å…¶ä¸­ï¼Œç„¶åæˆ‘æ„è¯†åˆ°ç”¨çŸ©é˜µçš„æ–¹å¼æ€è€ƒå°†æˆ‘çš„æ€ç»´é™åˆ¶åœ¨äºŒç»´ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»ç„¶ä¼šä½¿ç”¨è®¸å¤šçŸ©é˜µå’Œå‘é‡çš„ç±»æ¯”ï¼Œä»¥ä¾¿è¿™ä¸ªä¸»é¢˜å˜å¾—æ›´å®¹æ˜“ç†è§£ã€‚

# è‡ªç”±æŒ‡æ•°

è‡ªç”±æŒ‡æ•°æ˜¯å‡ºç°åœ¨ç­‰å¼ä¸¤è¾¹çš„æŒ‡æ•°ã€‚ä¾‹å¦‚:

![](img/f7d998d4fb727b6b4a63a6a68b16a067.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ğ‘£ç°åœ¨å¯ä»¥è¡¨ç¤ºä¸€è¡Œæˆ–ä¸€åˆ—å‘é‡ã€‚

![](img/e462245390ebc447661ed8c3b5be6699.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

è¿™å¹¶ä¸æ˜¯ç´¢å¼•ç¬¦å·çš„è¦ç‚¹ã€‚ä½ æŠŠè‡ªå·±ä»ä»»ä½•çŸ¢é‡çš„å…·ä½“è¡¨ç¤ºä¸­è§£æ”¾å‡ºæ¥ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥æœ‰ä¸¤ä¸ªè‡ªç”±æŒ‡æ•°:

![](img/62e98eeaf4179509af949b89184cc517.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

æˆ‘ä»¬å¯ä»¥æƒ³è±¡è¿™ä¸ªæ–¹ç¨‹æè¿°äº†çŸ©é˜µçš„è¡Œå’Œåˆ— **ğ´** ã€‚

![](img/7904f8ddbf9e06ce98b46b2ed7471433.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ç»§ç»­å¢åŠ è‡ªç”±æŒ‡æ•°çš„æ•°é‡ï¼Œå°±è¶Šæ¥è¶Šéš¾ä»¥æƒ³è±¡ä¸€ä¸ªå…·ä½“çš„è¡¨ç¤ºã€‚

![](img/05bca8289cb602828485439ef758c848.png)

å¦‚æœæœ‰ 3 ä¸ªè‡ªç”±æŒ‡æ•°ï¼Œå®ƒå°†æ˜¯ä¸€ä¸ªå¼ é‡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªçŸ©é˜µå‘é‡ã€‚

![](img/a14811eda82343df457a1e9e1c795764.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# è™šæ‹ŸæŒ‡æ•°

å“‘å…ƒå¯ä»¥å‡ºç°åœ¨ç­‰å¼çš„ä¸€è¾¹ï¼Œä½œä¸ºæŒ‡æ•°ï¼Œå®ƒä»¬åœ¨æ¯ä¸ªäº§å“ä¸­å‡ºç°çš„æ¬¡æ•°æ˜¯å¶æ•°ã€‚

ä¸€ä¸ªä¾‹å­æ˜¯:

![](img/60b70acf58b21060f6c43d71278e05c5.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

è¿™ä¸ªç­‰å¼ä¹Ÿå¯ä»¥å†™æˆä¸€ä¸ªè¡Œå‘é‡å’Œä¸€ä¸ªåˆ—å‘é‡çš„å†…ç§¯ã€‚

![](img/8711470cd4cd4370ebb803995a305b15.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# çˆ±å› æ–¯å¦æ±‚å’Œçº¦å®š

å½“æˆ‘ä»¬ä½¿ç”¨åº”ç”¨è¿™ä¸€æƒ¯ä¾‹æ—¶ï¼Œå³ä½¿æ²¡æœ‰æ±‚å’Œç¬¦å·ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå¯¹è™šæ‹Ÿç´¢å¼•æ±‚å’Œã€‚è¿™ä¸ªçº¦å®šæ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºè™šæ‹ŸæŒ‡æ•°çš„æ±‚å’Œåœ¨çº¿æ€§ä»£æ•°ä¸­ç»å¸¸å‘ç”Ÿã€‚

åº”ç”¨è¿™ä¸€çº¦å®šï¼Œæœ€åä¸€ä¸ªç­‰å¼å¯ä»¥æ”¹å†™å¦‚ä¸‹:

![](img/4bb4fca71b5bd4d4ae51a13954810cad.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# ä¸Šé™å’Œä¸‹é™æŒ‡æ•°

æœ‰äº›äººé€‚ç”¨ä»¥ä¸‹çº¦å®šï¼Œæœ‰äº›äººä¸é€‚ç”¨ã€‚å¦‚æœæˆ‘å¿…é¡»åœ¨ç´¢å¼•ç¬¦å·å’ŒçŸ¢é‡åŒ–å½¢å¼ä¹‹é—´å¿«é€Ÿè½¬æ¢ï¼Œæˆ‘è‡ªå·±ä¹Ÿä¼šä½¿ç”¨å®ƒã€‚

ä½¿ç”¨è¿™ä¸ªæƒ¯ä¾‹ï¼Œæˆ‘ä»¬å†™ä¸‹å’Œä¸Šç´¢å¼•ã€‚è¯·ä¸è¦å°†ä¸Šé¢çš„æŒ‡æ•°ä¸â€œçš„å¹‚â€ç›¸æ··æ·†ã€‚

é‚£ä¹ˆåªæœ‰å½¼æ­¤å¯¹è§’çš„ç›¸åŒæŒ‡æ•°è¢«æ±‚å’Œã€‚

é‡å¤ç´¢å¼•çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯¹å…¶æ±‚å’Œ:

![](img/2736ef3a2ce90f617603dd01b670550a.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

å¦ä¸€ä¸ªä¾‹å­:

![](img/5765896b8e52a077b3ea6197d31199d4.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

é‡å¤ç´¢å¼•çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬**ä¸å¯¹å…¶è¿›è¡Œ**æ±‚å’Œ:

![](img/8c7c31894539bd11f9b63fdfb5ca4acf.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# ç»„åˆè‡ªç”±å’Œè™šæ‹Ÿç´¢å¼•

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåœ¨åŒä¸€ä¸ªç­‰å¼ä¸­æ‰¾åˆ°ç©ºé—²å’Œè™šæ‹Ÿç´¢å¼•ã€‚å¯¹äºä¸€äº›è¯»è€…æ¥è¯´ï¼Œè¿™å¯èƒ½ä¸€å¼€å§‹å¬èµ·æ¥å¾ˆå¯æ€•ï¼Œä½†æ˜¯çœ‹è¿‡å‡ æ¬¡ä¹‹åï¼Œæˆ‘ç›¸ä¿¡ä½ ä¼šæ¬£èµå®ƒçš„æŠ½è±¡æ€§ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ç­‰å¼:

![](img/da457da2a9705387a296385c34b7294c.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

æˆ‘ä»¬å°†ç”¨ç´¢å¼•ç¬¦å·é‡å†™å®ƒ:

![](img/14fc5c2b23b7c59073d4643ce6e0551a.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œç´¢å¼• I æ˜¯ä¸€ä¸ªè‡ªç”±ç´¢å¼•ï¼Œç´¢å¼• j æ˜¯ä¸€ä¸ªä¼ªç´¢å¼•ï¼Œget è¢«æ±‚å’Œã€‚

å¦‚æœä½ æƒ³åªä½¿ç”¨ä¸‹æ ‡ï¼Œä½ å¯ä»¥è¿™æ ·å†™:

![](img/5d9055a982ad3b46d7b5a5963021bbb8.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# np.einsum

åœ¨ numpy ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨çˆ±å› æ–¯å¦ç¬¦å·æ¥ä¹˜æ•°ç»„ã€‚è¿™ä¸º np.dot()å‡½æ•°æä¾›äº†ä¸€ä¸ªæ›¿ä»£æ–¹æ³•ï¼Œå®ƒæ˜¯çº¿æ€§ä»£æ•°ç‚¹ç§¯çš„ numpys å®ç°ã€‚

ä½†æ˜¯ np.einsum èƒ½åšçš„æ¯” np.dot å¤šã€‚

np.einsum å¯ä»¥ä»¥ä»»ä½•å¯èƒ½çš„æ–¹å¼å°†æ•°ç»„ç›¸ä¹˜ï¼Œæ­¤å¤–:

*   æ²¿è½´æ±‚å’Œ
*   è½¬ç½®è¾“å…¥å’Œè¾“å‡ºæ•°ç»„

ä»¥åŠè¿™äº›æ“ä½œä»¥ä»»ä½•é¡ºåºçš„ä»»ä½•å¯èƒ½çš„ç»„åˆã€‚

## np.einsum çš„ç¬¬ä¸€ä¸ªä¾‹å­

æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ª 2D æ•°ç»„: **A** å’Œ **B** ã€‚

(ä½œè€…ä»£ç )

å½“ç°åœ¨è®¡ç®— A ä¸ B çš„ç‚¹ç§¯æ—¶:

(ä½œè€…ä»£ç )

è¾“å‡ºæ˜¯:

```
[[ 6 12 18]
 [ 9 18 27]
 [12 24 36]]
```

æˆ‘ä»¬ç°åœ¨æƒ³å¯¹ np.einsum åšåŒæ ·çš„äº‹æƒ…:

(ä½œè€…ä»£ç )

ç»“æœæ˜¯ä¸€æ ·çš„:

```
[[ 6 12 18]
 [ 9 18 27]
 [12 24 36]]
```

ä½†æ˜¯è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿæˆ‘ä»¬å¿…é¡»ç†è§£æ‰€è°“çš„ç­¾åå­—ç¬¦ä¸²:â€œikï¼Œkj->ijâ€ã€‚

ç®­å¤´çš„å·¦è¾¹æ˜¯:ikï¼Œkjã€‚è¿™éƒ¨åˆ†æŒ‡å®šäº†è¾“å…¥æ•°ç»„çš„ç´¢å¼•ã€‚

ç®­å¤´çš„å³è¾¹æ˜¯:ijã€‚è¿™éƒ¨åˆ†æŒ‡å®šäº†ç»“æœæ•°ç»„çš„ç´¢å¼•ã€‚

æ•´ä¸ªç­¾åä¸²å°†æ„å‘³ç€:â€œç¬¬ä¸€è¾“å…¥æ•°ç»„å…·æœ‰ç´¢å¼• ikï¼Œç¬¬äºŒè¾“å…¥ä¸²å…·æœ‰ç´¢å¼• kjã€‚è¿™äº›ç´¢å¼•è¢«è½¬æ¢æˆè¾“å‡ºæ•°ç»„ä¸­çš„ç´¢å¼• ijâ€ã€‚

![](img/043eec12f140d87269ae7fda9a0c50b6.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ç›¸åº”çš„æ•°å­¦ç­‰å¼å¦‚ä¸‹æ‰€ç¤º:

![](img/6fce2458eafb3c8b674ef730fe816e52.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

**NP . einsum çš„ç¬¬äºŒä¸ªä¾‹å­**

å‡è®¾æˆ‘ä»¬æœ‰ç›¸åŒçš„ä¸¤ä¸ªæ•°ç»„ **A** å’Œ **B** ã€‚

(ä½œè€…ä»£ç )

æˆ‘ä»¬æƒ³åœ¨å…ƒç´ æ–¹é¢å¢åŠ å®ƒä»¬ã€‚åœ¨ numpy ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš:

ç»“æœå°†æ˜¯:

```
[[ 1 4 9 ]
 [ 2 6 12]
 [ 3 8 15]]
```

æˆ‘ä»¬å¯¹ np.einsum åšåŒæ ·çš„äº‹æƒ…:

(ä½œè€…ä»£ç )

å¾—åˆ°çš„æ•°ç»„æ˜¯ç›¸åŒçš„ã€‚

```
[[ 1 4 9 ]
 [ 2 6 12]
 [ 3 8 15]]
```

é˜µåˆ—ä¹˜æ³•ä»¥å¦‚ä¸‹æ–¹å¼æ‰§è¡Œ:

![](img/757c4a5e7d3a9c8e38f87259e2078251.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

**NP . einsum çš„ç¬¬ä¸‰ä¸ªä¾‹å­**

æˆ‘ä»¬ç°åœ¨æƒ³è¦ A å’Œ b çš„è½¬ç½®çš„ç‚¹ç§¯ã€‚

æˆ‘ä»¬ç¼–å†™äº†ä¸ A å’Œ B çš„ç‚¹ç§¯ç›¸åŒçš„ä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬äº¤æ¢äº† B çš„ç´¢å¼•ã€‚

é˜µåˆ—ä¹˜æ³•ä»¥å¦‚ä¸‹æ–¹å¼æ‰§è¡Œ:

![](img/f4967bdad23844d926906a40fbcd2171.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

**NP . einsum çš„ç¬¬å››ä¸ªä¾‹å­**

å¥½å§ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦æ‰§è¡Œç›¸åŒçš„å…ƒç´ ä¹˜æ³•ï¼Œä½†æ˜¯æƒ³è¦åœ¨åˆ—è½´(è½´ 1)ä¸Šæ±‚å’Œã€‚

np.einsum å¯ä»¥åšåˆ°:

ç»“æœå¦‚ä¸‹æ‰€ç¤º:

```
[14 20 26]
```

è¯·æ³¨æ„ï¼Œnumpy å‡å°‘äº†è¾“å‡ºç»“æœä¸­çš„ä¸€ä¸ªç»´åº¦ï¼Œå¾—åˆ°çš„å‘é‡åªæ˜¯ 1Dã€‚

æ•°ç»„ä¹˜æ³•æ˜¯è¿™æ ·æ‰§è¡Œçš„:

![](img/5fbdd6b231e6e3d90823a62f1f1ac070.png)

(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# ç»“è®º

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨åº”è¯¥å¯¹çˆ±å› æ–¯å¦ç¬¦å·å’Œ np.einsum çš„å·¥ä½œåŸç†æœ‰äº†åŸºæœ¬çš„äº†è§£ã€‚å¦‚æœå¯¹ä½ æ¥è¯´è¿™æ˜¯ä¸€ä¸ªæ–°çš„è¯é¢˜ï¼Œé‚£ä¹ˆæˆ‘å¼ºçƒˆå»ºè®®ä½ ç”¨ np.einsum åšå®éªŒï¼Œæ”¹å˜è™šæ‹Ÿç´¢å¼•å’Œè‡ªç”±ç´¢å¼•ï¼Œçœ‹çœ‹ç»“æœå¦‚ä½•å˜åŒ–ã€‚

# ç›¸å…³æ–‡ç« 

[https://towards data science . com/back propagation-in-neural-networks-6561 e 1268 da 8](/backpropagation-in-neural-networks-6561e1268da8)

[https://towards data science . com/back propagation-in-neural-networks-6561 e 1268 da 8](/backpropagation-in-neural-networks-6561e1268da8)

## æƒ³è”ç³»æ”¯æŒæˆ‘ï¼Ÿ

LinkedIn
[https://www.linkedin.com/in/vincent-m%C3%BCller-6b3542214/](https://www.linkedin.com/in/vincent-m%C3%BCller-6b3542214/)
è„¸ä¹¦
[https://www.facebook.com/profile.php?id=100072095823739](https://www.facebook.com/profile.php?id=100072095823739)
Twitter
[https://twitter.com/Vincent02770108](https://twitter.com/Vincent02770108)
Medium
[https://medium.com/@Vincent.Mueller](https://medium.com/@Vincent.Mueller)
æˆä¸º Medium ä¼šå‘˜å¹¶æ”¯æŒæˆ‘(ä½ çš„éƒ¨åˆ†ä¼šè´¹ç›´æ¥å½’æˆ‘)
[https://medium.com/@Vincent.Mueller/membership](https://medium.com/@Vincent.Mueller/membership)