# é€»è¾‘å›å½’è§£é‡Š

> åŸæ–‡ï¼š<https://towardsdatascience.com/logistic-regression-explained-7695f15d1b8b?source=collection_archive---------19----------------------->

![](img/a587164a30e0847342bfa043d6833008.png)

Pawel Czerwinski åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

## æ•°æ®ç§‘å­¦åŸºç¡€

## äº†è§£è¿™ç§å—ç›‘ç£çš„æœºå™¨å­¦ä¹ ç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„

*é€»è¾‘å›å½’*ç”±äºå…¶ç®€å•æ€§å’Œå¯è§£é‡Šæ€§ï¼Œæ˜¯ä¸€ç§æµè¡Œçš„åˆ†ç±»ç®—æ³•ã€‚å¦‚æœä½ æ­£åœ¨å­¦ä¹ æˆ–å®è·µæ•°æ®ç§‘å­¦ï¼Œå¾ˆå¯èƒ½ä½ å·²ç»å¬è¯´è¿‡è¿™ä¸ªç®—æ³•ï¼Œç”šè‡³ä½¿ç”¨è¿‡å®ƒã€‚å¦‚æœä½ æƒ³åŠ æ·±å¯¹é€»è¾‘å›å½’çš„ç†è§£ï¼Œå­¦ä¹ å®ƒèƒŒåçš„æ•°å­¦çŸ¥è¯†ï¼Œè¿™ç¯‡æ–‡ç« æä¾›äº†å¯¹é€»è¾‘å›å½’çš„ç®€å•ä»‹ç»ã€‚

![](img/71f7c33aee4aa15dc00737d2835c44ff.png)

Pawel Czerwinski åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

*æœ¬å¸–å‡è®¾è¯»è€…å¯¹çº¿æ€§å›å½’æœ‰æ‰€äº†è§£ã€‚å¦‚æœä½ å¯¹çº¿æ€§å›å½’ä¸å¤ªé€‚åº”ï¼Œ* [*è¿™ç¯‡æ–‡ç« *](/linear-regression-explained-89cc3886ab48) *å¯èƒ½æœ‰åŠ©äºè·å¾—çº¿æ€§å›å½’çš„åŸºç¡€çŸ¥è¯†ã€‚æˆ‘ä»¬å°†çœ‹åˆ°ä¸€äº›ç”¨ Python ç¼–å†™çš„ä»£ç ç¤ºä¾‹ï¼Œç„¶è€Œï¼Œè¯»è€…å¯ä»¥åœ¨ä¸äº†è§£ä»»ä½• Python çš„æƒ…å†µä¸‹å¸æ”¶æ¦‚å¿µæ€§çŸ¥è¯†ã€‚*

# æ¦‚è§‚ğŸ“œ

ç†è§£*é€»è¾‘å‡½æ•°*æ˜¯ç†è§£*é€»è¾‘å›å½’*çš„é‡è¦å‰æã€‚æ‰€ä»¥è®©æˆ‘ä»¬ä»ç†è§£ä»€ä¹ˆæ˜¯é€»è¾‘å‡½æ•°å¼€å§‹ã€‚

## ğŸ“ç‰©æµåŠŸèƒ½

> é€»è¾‘å‡½æ•°æ˜¯ä¸€ç§ç±»å‹çš„ [sigmoid å‡½æ•°](https://deepai.org/machine-learning-glossary-and-terms/sigmoid-function),ç”¨äºå‹ç¼© 0 å’Œ 1 ä¹‹é—´çš„å€¼ã€‚

è™½ç„¶*ä¹™çŠ¶ç»“è‚ åŠŸèƒ½*æ˜¯*ç‰©æµå’Œå…¶ä»–åŠŸèƒ½*çš„æ€»ç§°ï¼Œä½†è¯¥æœ¯è¯­é€šå¸¸ç”¨äºæŒ‡ä»£*ç‰©æµåŠŸèƒ½*ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¥ç»ç½‘ç»œçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œé€»è¾‘å‡½æ•°é€šå¸¸è¢«ç§°ä¸º *sigmoid æ¿€æ´»å‡½æ•°*ã€‚æ•°å­¦ä¸Šï¼Œè¯¥å‡½æ•°å¦‚ä¸‹æ‰€ç¤º:

![](img/bdddf07cdcbb107c2a31f3cc136faf76.png)

å‡½æ•°é€šå¸¸ç”¨è¿™ä¸¤ç§å½¢å¼ä¸­çš„ä¸€ç§æ¥è¡¨ç¤ºã€‚è¿™äº›å½¢å¼æ˜¯ç­‰ä»·çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥é‡æ–°æ’åˆ—ä¸€ç§å½¢å¼æ¥å¾—åˆ°å¦ä¸€ç§å½¢å¼:

![](img/5536e1226819e0d3e3bfe797b99bea41.png)

æˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ç¬¬ä¸€ç§å½¢å¼ï¼Œå› ä¸ºå®ƒæ›´ç®€æ´ã€‚é€»è¾‘å‡½æ•°çš„ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯å®ƒåœ¨ 0 å’Œ 1 å¤„æœ‰ä¸¤æ¡æ°´å¹³æ¸è¿‘çº¿:

![](img/d2621a141bf8d4e0c719f2c246aed184.png)

å¦‚æœæˆ‘ä»¬æŠŠé€»è¾‘å‡½æ•°å½¢è±¡åŒ–ï¼Œè¿™ä¸ªç‰¹å¾ä¼šå˜å¾—æ›´æ¸…æ¥š:

```
import numpy as np
import pandas as pd
pd.options.display.precision = 4import matplotlib.pyplot as plt
import seaborn as sns
sns.set(style='darkgrid', context='talk', palette='rainbow')from sklearn.linear_model import LogisticRegression# Create integers between -10 to 10 (both inclusive)
z = np.arange(-10,11)# Create logistic function
def logistic(x):
    return 1 / (1+np.exp(-x))# Plot x: z and y: logistic(z)
plt.figure(figsize=(10,4))
sns.lineplot(x=z, y=logistic(z))
plt.xlabel('z')
plt.ylabel('logistic(z)')
plt.title('Logistic function');
```

![](img/2808d769c38eaea8e0a4fb1fdfab4d42.png)

æˆ‘ä»¬çœ‹åˆ°ä¸€æ¡ç±»ä¼¼æ‹‰ä¼¸ S çš„æ›²çº¿ï¼Œå‚ç›´è½´ä¸Šçš„å‡½æ•°è¾“å‡ºèŒƒå›´ä» 0 åˆ° 1ã€‚å½“`z=0`æ—¶ï¼Œé€»è¾‘å‡½æ•°è¿”å› 0.5ã€‚è¿™æ„å‘³ç€`logistic(z)>0.5`æ„å‘³ç€`z`æ˜¯æ­£çš„ï¼Œè€Œ`logistic(z)<0.5`æ„å‘³ç€`z`æ˜¯è´Ÿçš„ã€‚

å› ä¸ºé€»è¾‘å‡½æ•°å°†ä»»ä½•å®æ•°è½¬æ¢ä¸º 0 åˆ° 1 ä¹‹é—´çš„å€¼ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æƒ³å°†æ•°å€¼è½¬æ¢ä¸ºæ¦‚ç‡æ—¶ï¼Œå®ƒéå¸¸æœ‰ç”¨ã€‚

## ğŸ“é€»è¾‘å›å½’

é€»è¾‘å›å½’æ˜¯ä¸€ç§äºŒå…ƒåˆ†ç±»ç®—æ³•ï¼Œå°½ç®¡å…¶åç§°åŒ…å«â€œå›å½’â€ä¸€è¯ã€‚å¯¹äºäºŒå…ƒåˆ†ç±»ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæƒ³è¦é¢„æµ‹çš„ç›®æ ‡ç±»ã€‚è®©æˆ‘ä»¬ç§°å®ƒä»¬ä¸º*æ­£* (y=1)å’Œ*è´Ÿ* (y=0)ç±»ã€‚å½“æˆ‘ä»¬å°† [*çº¿æ€§å›å½’*](/linear-regression-explained-89cc3886ab48) å’Œ*é€»è¾‘å‡½æ•°*ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬å¾—åˆ°é€»è¾‘å›å½’æ–¹ç¨‹:

![](img/2b9548b3dddba4c733bc4888bc1cd577.png)

è¿™ä¸ä»¥ä¸‹å†…å®¹ç›¸åŒ:

![](img/9a6833987d42433dc279e0f45833841a.png)

> é€»è¾‘å›å½’é¢„æµ‹è®°å½•å±äºç»™å®šç‰¹å¾çš„æ­£ç±»çš„æ¦‚ç‡ã€‚

å› ä¸ºæˆ‘ä»¬æœ‰ä¸¤ä¸ªç±»ï¼Œæ‰€ä»¥æ‰¾åˆ°å±äºè´Ÿç±»çš„æ¦‚ç‡å¾ˆç®€å•:

![](img/3b477f9b7b70fb5d41eff2ebf0d77614.png)

ä¸€æ—¦æˆ‘ä»¬æœ‰äº†æ¦‚ç‡å€¼ï¼Œå°±å¾ˆå®¹æ˜“å°†å®ƒä»¬è½¬æ¢æˆé¢„æµ‹ç±»ã€‚ä½¿ç”¨é˜ˆå€¼ 0.5(å³æ¦‚ç‡ä¸º 50%)ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¦‚ç‡å€¼è½¬æ¢ä¸ºç±»åˆ«:

![](img/7297870b4c5c11ba3877fbff315d89da.png)

è¿™ç›¸å½“äº(å¦‚æœä¸æ¸…æ¥šä¸ºä»€ä¹ˆå®ƒä»¬æ˜¯ç›¸åŒçš„ï¼Œå†çœ‹ä¸€ä¸‹ä¸Šé¢çš„*ç‰©æµåŠŸèƒ½éƒ¨åˆ†*ğŸ‘€):

![](img/909fcd1892aa9a54c846fd48755f90aa.png)

å¦‚æœæˆ‘ä»¬ä½¿ç”¨æœ¯è¯­`z`æ¥è¡¨ç¤ºç³»æ•°å’Œç‰¹å¾çš„æˆªè·å’Œç‚¹ç§¯ä¹‹å’Œ:

![](img/facd248178e055f88f5861211351bed2.png)

é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯´å¯¹äº`z`çš„è´Ÿå€¼ï¼Œé¢„æµ‹ç±»ä¸º 0ï¼Œå¦åˆ™ï¼Œé¢„æµ‹ç±»ä¸º 1ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°ç©å…·æ•°æ®é›†çš„ç®€å•ç¤ºä¾‹ï¼Œå®ƒæœ‰ä¸€ä¸ªäºŒå…ƒç›®æ ‡å’Œä¸¤ä¸ªç‰¹å¾:

```
# Create sample data
train = pd.DataFrame({'x1': [1, 2, 2, 3, 2, 4, 3, 4, 3, 4], 
                      'x2': [2, 3, 4, 2, 1, 3, 5, 2, 3, 6], 
                      'y': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1]})# Train a logistic regression
target = 'y'
features = ['x1', 'x2']
model = LogisticRegression()
model.fit(train[features], train[target])# Predict
for i, row in train.iterrows():
    train.loc[i, 'z'] = model.intercept_[0] + np.dot(model.coef_[0], 
                                                  row[:2])
train['p_hat'] = model.predict_proba(train[features])[:,1]
train['y_hat'] = model.predict(train[features]) # default threshold is 0.5def highlight(data):
    n = len(data)
    if data['z']<0:
        return n*['background-color: #FF9A98']
    else:
        return n*['background-color: lightgreen']
(train.style.apply(highlight, axis=1)
  .format('{:.2%}', subset='p_hat').hide_index())
```

![](img/d5ff8a9c1df3abc0df93454b8bc2eca6.png)

å¦‚æœä½ æƒ³å­¦ç€åƒè¿™æ ·ç¾åŒ–ç†ŠçŒ«çš„æ•°æ®å¸§ï¼Œä½ å¯èƒ½ä¼šå–œæ¬¢é˜…è¯»è¿™ä¸ªå¸–å­ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºè´Ÿå€¼çš„`z`ï¼Œæ¦‚ç‡å€¼å°äº 0.5ï¼Œå¯¹äºæ­£å€¼çš„`z`ï¼Œæ¦‚ç‡å€¼å¤§äº 0.5ã€‚ç°åœ¨æ˜¯å­¦ä¹ é€»è¾‘å›å½’çš„å†³ç­–è¾¹ç•Œçš„å¥½æ—¶æœºï¼Œå®ƒåŸºæœ¬ä¸ŠåŒ…å«äº†æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­è®¨è®ºçš„å†…å®¹ã€‚

## ğŸ“åˆ¤åˆ«è¾¹ç•Œ

[é€»è¾‘å›å½’çš„å†³ç­–è¾¹ç•Œ](https://www.cs.princeton.edu/courses/archive/fall08/cos436/Duda/PR_simp/bndrys.htm)ç”±ä¸‹å¼ç»™å‡º:

![](img/26c2cc2932470b915b4eb4488457bd71.png)

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç”±äºæˆ‘ä»¬åªæœ‰ä¸¤ä¸ªç‰¹å¾ï¼Œç­‰å¼å˜æˆ:

![](img/080f0c6659afec0d6c02979bc14fd87b.png)

è®©æˆ‘ä»¬æ²¿ç€å†³ç­–è¾¹ç•Œåœ¨æ¨ªè½´ä¸Šç»˜åˆ¶`x1`ï¼Œåœ¨çºµè½´ä¸Šç»˜åˆ¶`x2`ã€‚å¦‚æœæˆ‘ä»¬é‡æ–°æ’åˆ—ä¸Šè¿°ç­‰å¼ï¼Œä½¿`x2`ç”¨`x1`è¡¨ç¤ºï¼Œç»˜åˆ¶å†³ç­–è¾¹ç•Œå˜å¾—æ›´å®¹æ˜“:

![](img/f87ee47ac0fca5b669ac0aa02624bc96.png)

```
def decision_boundary(x1):
    intercept = model.intercept_[0]
    coefficients = model.coef_[0]
    x2 = -(intercept+coefficients[0]*x1)/coefficients[1]
    return x2# Plot decision boundary
plt.figure(figsize=(6,4))
sns.scatterplot(data=train, x='x1', y='x2', hue='y', 
                palette=['red', 'green'])
sns.lineplot(x=train['x1'], y=train['x1'].apply(decision_boundary), 
             color='red')
plt.fill_between(train['x1'], train['x1'].apply(decision_boundary), 
                 color='red', alpha=0.4)
plt.legend(loc='upper right', bbox_to_anchor=(1.3, 1))
plt.title('Decision boundary');
```

![](img/f89d7a9c19cbebb21e75106efc1e757e.png)

ä»è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹åˆ°ï¼Œé€»è¾‘å›å½’çš„å†³ç­–è¾¹ç•Œæ˜¯çº¿æ€§çš„ã€‚ä½¿ç”¨è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šç»™å®šè®°å½•çš„é¢„æµ‹ç±»:å¦‚æœä¸€ä¸ªè®°å½•è½åœ¨å·¦ä¸‹è§’é˜´å½±ä¸‰è§’å½¢ä¸­(å³`z<0`ï¼Œé‚£ä¹ˆé¢„æµ‹ç±»æ˜¯ 0ï¼Œå¦åˆ™(å³`zâ‰¥0`)ï¼Œé¢„æµ‹ç±»æ˜¯ 1ã€‚

# è®­ç»ƒé€»è¾‘å›å½’ğŸ”§

ç†Ÿæ‚‰äº†é€»è¾‘å›å½’èƒŒåçš„ç›´è§‰ä¹‹åï¼Œç°åœ¨è®©æˆ‘ä»¬å­¦ä¹ æ¨¡å‹å¦‚ä½•å­¦ä¹ æœ€ä¼˜çš„[æ¨¡å‹å‚æ•°](https://machinelearningmastery.com/difference-between-a-parameter-and-a-hyperparameter/)(å³æˆªè·å’Œç³»æ•°)ã€‚åœ¨è®­ç»ƒé€»è¾‘å›å½’æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°æœ€ä½³çš„å‚æ•°ç»„åˆï¼Œä»¥ä¾¿ä¸ä»»ä½•å…¶ä»–ç»„åˆç›¸æ¯”ï¼Œå®ƒä»¬åœ¨æ‰€æœ‰è®­ç»ƒç¤ºä¾‹ä¸­äº§ç”Ÿæœ€ä½çš„è¯¯å·®ã€‚å¯¹äºç»™å®šçš„ä¸€ç»„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨*å¯¹æ•°æŸå¤±(åˆåäº¤å‰ç†µæŸå¤±)å‡½æ•°*æ¥æµ‹é‡è¯¯å·®ï¼Œä½œä¸ºè®­ç»ƒç¤ºä¾‹:

![](img/547b4b9e10f78a9a9b95b1fc78801299.png)

è™½ç„¶[å¯¹æ•°çš„åº•æ•°å¹¶ä¸é‡è¦](https://datascience.stackexchange.com/questions/57009/why-doesnt-the-binary-classification-log-loss-formula-make-it-explicit-that-nat)ï¼Œä½†ä½¿ç”¨è‡ªç„¶å¯¹æ•°æ˜¯å¾ˆå¸¸è§çš„:

![](img/ee429c422ecbc50bfacf999eaaf7d98b.png)

è¿™å¯ä»¥ç®€åŒ–ä¸º:

![](img/046f9563cf248bb1008e53caa3f77feb.png)

ä½ ä¼šæ³¨æ„åˆ°ï¼Œå½“`y=0`æ—¶ï¼Œç­‰å¼çš„å‰åŠéƒ¨åˆ†ä¸º 0ï¼Œè€Œå½“`y=1`æ—¶ï¼Œç­‰å¼çš„ååŠéƒ¨åˆ†ä¸º 0ã€‚è¿™ä¸ªå‡½æ•°ä¸€å¼€å§‹å¯èƒ½çœ‹èµ·æ¥ä¸ç›´è§‚ï¼Œä½†æ˜¯åœ¨ä¸€ä¸ªå°ä¾‹å­ä¸­åº”ç”¨å®ƒå¯ä»¥é˜æ˜å‡½æ•°èƒŒåçš„ç›´è§‚æ€§ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸¤ä¸ªç±»åˆ«ä¸åŒæ¦‚ç‡çš„å¯¹æ•°æŸå¤±:

![](img/6a347706e9c8d8897bef267764a330ce.png)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºè´Ÿè®°å½•ï¼Œè¯¯å·®éšç€æ¦‚ç‡è¶Šæ¥è¶Šæ¥è¿‘ 0 è€Œå‡å°ï¼Œå¯¹äºæ­£è®°å½•ï¼Œè¯¯å·®éšç€æ¦‚ç‡è¶Šæ¥è¶Šæ¥è¿‘ 1 è€Œå‡å°ã€‚æ¢å¥è¯è¯´ï¼Œæ­£é¢è®°å½•çš„æ¦‚ç‡è¶Šé«˜æˆ–è´Ÿé¢è®°å½•çš„æ¦‚ç‡è¶Šä½ï¼Œè¯¯å·®å°±è¶Šå°ã€‚ç°åœ¨ï¼Œè¿™æ˜¯ç›´è§‰ï¼

å› ä¸ºæˆ‘ä»¬å¸Œæœ›æœ€å°åŒ–æ‰€æœ‰è®­ç»ƒæ ·æœ¬çš„è¯¯å·®ï¼Œæ‰€ä»¥é›†ä½“è¯¯å·®ç”±å¹³å‡æµ‹äº•æŸå¤±ç»™å‡º:

![](img/0e74acf513f04247d39029fa34c2afd9.png)

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•æµ‹é‡ä¸€ç»„ç»™å®šå‚æ•°çš„è¯¯å·®ï¼Œä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ‰¾åˆ°ä½¿è¯¯å·®æœ€å°çš„æœ€ä½³å‚æ•°ã€‚è¿™å°±æ˜¯ä¼˜åŒ–ç®—æ³•å¦‚[æ¢¯åº¦ä¸‹é™](https://ml-cheatsheet.readthedocs.io/en/latest/gradient_descent.html)å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚ä¼˜åŒ–ç®—æ³•æ±‚è§£å‚æ•°çš„æœ€ä½³ç»„åˆï¼Œä½¿æµ‹äº•æ›²çº¿æŸå¤±æœ€å°åŒ–ã€‚å®é™…ä¸Šï¼Œä¼˜åŒ–ç®—æ³•çš„é€‰æ‹©å–å†³äºå®ç°ã€‚ä¾‹å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒScikit-learn å¯¹`[LogisticRegression()](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html)`ä½¿ç”¨ [LBFGS](https://stats.stackexchange.com/a/285106/249142) ä¼˜åŒ–ç®—æ³•ã€‚

# è§£é‡Šé€»è¾‘å›å½’å‚æ•°ğŸ”

ä¸ºäº†è§£é‡Šé€»è¾‘å›å½’å‚æ•°ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†Ÿæ‚‰ä¼˜åŠ¿ã€ä¼˜åŠ¿æ¯”å’Œ logit å‡½æ•°ã€‚

## ğŸ“å¯èƒ½æ€§

èµ”ç‡æ˜¯äº‹ä»¶çš„æ¦‚ç‡ä¸å…¶äº’è¡¥äº‹ä»¶çš„æ¦‚ç‡(å³äº‹ä»¶ä¸å‘ç”Ÿçš„æ¦‚ç‡)ä¹‹æ¯”:

![](img/0018761b930c85ece0e64647d0e94051.png)

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ·ä¸€æšå…¬å¹³ç¡¬å¸ï¼Œå¾—åˆ°æ­£é¢çš„å‡ ç‡æ˜¯ 1 (1:1):

![](img/d4cc8372e8eb7eb30c5e97b0813c93dc.png)

æŒ‘ä¸€å¼ é»‘æ¡ƒç‰Œçš„èµ”ç‡æ˜¯ 0.33 (1:3):

![](img/25b48c88ecc0f3bdbc0351cc376111c7.png)

é»‘æ¡ƒç‰Œçš„èƒœç®—ä¸å¤§ã€‚æ¢å¥è¯è¯´ï¼Œæ‹¿åˆ°é»‘ç‰Œçš„å¯èƒ½æ€§æ¯”æ‹¿åˆ°éé»‘ç‰Œçš„å¯èƒ½æ€§ä½ä¸‰å€ã€‚

èµ”ç‡ä¸èƒ½æ˜¯è´Ÿæ•°ï¼Œå› ä¸ºå®ƒæ˜¯æ¦‚ç‡çš„æ¯”ç‡ï¼Œå¹¶å…·æœ‰ä»¥ä¸‹å«ä¹‰:
â—¼ï¸èµ”ç‡ä½äº 1 æ„å‘³ç€èµ”ç‡ä¸åˆ©äºè¯¥äº‹ä»¶(ä¾‹å¦‚ 0.25 æˆ– 20:80 æˆ– 1:4)
â—¼ï¸èµ”ç‡ä¸º 1 æ„å‘³ç€èµ”ç‡ç›¸ç­‰(å³ 50:50 æˆ– 1:1)â€¦â€¦(*èµ”ç‡*ç­‰äº*å¶æ•°*ğŸ˜…)
â—¼èµ”ç‡é«˜äº 1 è¡¨ç¤ºèµ”ç‡å¯¹èµ›äº‹æœ‰åˆ©(ä¾‹å¦‚ 4 æˆ– 80:20 æˆ– 4:1)

## ğŸ“è®©æ­¥æ¯”

æ¯”å€¼æ¯”æ˜¯ä¸¤ä¸ªæ¯”å€¼ä¹‹é—´çš„æ¯”å€¼ã€‚

![](img/a392c7fcd172a1bd2bd1ae3dbedbcd51.png)

å‡è®¾ä¸€ä¸ªäº‹ä»¶æœ€åˆçš„èµ”ç‡æ˜¯ 0.25 (1:4)ï¼Œä½†ç°åœ¨æ–°çš„èµ”ç‡æ˜¯ 1.5 (3:2)ã€‚

![](img/6be765d9cc2e955246138e8986ee17a1.png)

èµ”ç‡æ˜¯ 6ã€‚è¿™æ„å‘³ç€å½“å‰èµ”ç‡æ¯”åˆå§‹èµ”ç‡å¤§ 6 å€ã€‚

![](img/42bac83fae59ef693355e030919d2d2d.png)

æ¯”å€¼æ¯”ä¹Ÿä¸èƒ½ä¸ºè´Ÿï¼Œå› ä¸ºå®ƒæ˜¯ä¸¤ä¸ªæ¯”å€¼ä¹‹é—´çš„æ¯”å€¼ã€‚èµ”ç‡å‘Šè¯‰æˆ‘ä»¬èµ”ç‡ç›¸å¯¹äºåŸºç¡€èµ”ç‡çš„å˜åŒ–:
â—¼ï¸èµ”ç‡ä½äº 1 æ„å‘³ç€èµ”ç‡ä¸‹é™(èµ”ç‡æ¯”ä»¥å‰ä½)
â—¼ï¸èµ”ç‡ä¸º 1 æ„å‘³ç€èµ”ç‡æ²¡æœ‰å˜åŒ–(èµ”ç‡ä¸ä»¥å‰ç›¸åŒ)
â—¼ï¸èµ”ç‡é«˜äº 1 æ„å‘³ç€èµ”ç‡å¢åŠ (èµ”ç‡æ¯”ä»¥å‰é«˜)

ä¼˜åŠ¿æ¯”å¯¹ä¼˜åŠ¿çš„å¤§å°ä¸æ•æ„Ÿã€‚ä¾‹å¦‚ï¼Œä» 0.01 åˆ° 0.04 å’Œä» 2 åˆ° 8 çš„æ¯”å€¼éƒ½å°†å¯¼è‡´æ¯”å€¼æ¯”ä¸º 4ã€‚

## ğŸ“Logit å‡½æ•°

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹ *logit å‡½æ•°*ã€‚

> Logit å‡½æ•°çš„ä½œç”¨ä¸ logistic å‡½æ•°ç›¸å:å®ƒå°†æ¦‚ç‡è½¬æ¢ä¸ºå®æ•°ã€‚

å¦‚æœæˆ‘ä»¬é‡æ–°æ’åˆ—é€»è¾‘å›å½’æ–¹ç¨‹ï¼Œä½¿å¾—å³è¾¹ç±»ä¼¼äºçº¿æ€§å›å½’æ–¹ç¨‹ï¼Œæˆ‘ä»¬åœ¨å·¦è¾¹å¾—åˆ° logit å‡½æ•°:

![](img/da5366c259fb261d52e2137372877e26.png)

è¿™ç§åˆ° logit å‡½æ•°çš„è½¬æ¢æœ‰åŠ©äºè§£é‡Šæ¨¡å‹å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼äº[çº¿æ€§å›å½’](/linear-regression-explained-89cc3886ab48)çš„æ–¹å¼è§£é‡Šå‚æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬ç›¸å¯¹äºå¯¹æ•°æ¦‚ç‡æˆ–å±äºæ­£ç±»çš„æ¦‚ç‡è€Œä¸æ˜¯è¿ç»­çš„ç›®æ ‡å˜é‡æ¥è§£é‡Šå®ƒã€‚

## ğŸ“è§£é‡Šé€»è¾‘å›å½’å‚æ•°

å¯¹äºå¤§å¤šæ•°äººæ¥è¯´ï¼Œå¼€å§‹æ—¶è§£é‡Šé€»è¾‘å›å½’å‚æ•°å¹¶ä¸ç›´è§‚ã€‚å¦‚æœä½ ç¬¬ä¸€æ¬¡å°±æ˜ç™½äº†ï¼Œå¹²å¾—å¥½ï¼å¦åˆ™ï¼Œä¸è¦æ‹…å¿ƒï¼Œéšç€ç»ƒä¹ ï¼Œå®ƒä¼šå˜å¾—æ›´åŠ ç›´è§‚ï¼Œæ‰€ä»¥è¦èŠ±æ—¶é—´æ¥å¸æ”¶è¿™äº›çŸ¥è¯†ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å°æ¨¡å‹çš„å‚æ•°æ±‡æ€»:

```
summary = pd.DataFrame(np.concatenate([model.intercept_,
                                       model.coef_[0]]), 
                       index=[f'Î¸_{i}' for i in range(3)], 
                       columns=['values'])
summary['exp(values)'] = np.exp(summary['values'])
summary
```

![](img/822a83d5df054ebdd7a7e4dabeb76cb8.png)

æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼è§£é‡Šè¿™äº›å‚æ•°:

â—¼ï¸:å¦‚æœæˆ‘ä»¬ä½¿ç”¨`exp(values)`ï¼Œæˆ‘ä»¬ç›¸å¯¹äº**å‡ ç‡*æ¥è§£é‡Šå®ƒï¼Œå¸Œæœ›è¿™æ ·æ›´å®¹æ˜“ç†è§£ã€‚æˆ‘å»ºè®®ä½¿ç”¨è¿™ç§æ–¹æ³•:*

*![](img/7c015b5cb8842b8e3d7d2014afacba1d.png)*

*â—¼ï¸å¦‚æœæˆ‘ä»¬ä½¿ç”¨`values`ï¼Œæˆ‘ä»¬å°†éœ€è¦ç›¸å¯¹äº*æ¥è§£é‡Šå®ƒçš„å¯¹æ•°å‡ ç‡:**

*![](img/1f938edf9961a65108488e72dcea2214.png)*

*è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æ„å»ºçš„æ ·æœ¬æ¨¡å‹çš„ä¸€äº›ç¤ºä¾‹è§£é‡Š:*

***æˆªè·:**å½“æ‰€æœ‰ç‰¹å¾éƒ½ä¸º 0 æ—¶ï¼Œ*æˆä¸ºæ­£ç±»çš„å‡ ç‡*é¢„è®¡ä¸º 0.0045ã€‚*

*![](img/28b75b870d0dd7d133cd5e1994e0b574.png)*

*æˆ–è€…ï¼Œå½“æ‰€æœ‰ç‰¹å¾å–å€¼ä¸º 0 æ—¶ï¼Œ*æ­£ç±»çš„å¯¹æ•°æ¦‚ç‡*é¢„è®¡ä¸º-5.3994ã€‚*

*![](img/64494919a52ed1eeec82f3d29cc7ccc4.png)*

***ç³»æ•°:**ä¿æŒå…¶ä»–å˜é‡ä¸å˜ï¼Œå¦‚æœ`x1`å¢åŠ ä¸€ä¸ªå•ä½ï¼Œ*å±äºæ­£ç±»çš„å‡ ç‡*é¢„è®¡å˜åŒ– 3.6982ã€‚*

*![](img/fff7874bbb12e9a179fe774977ea7b19.png)*

*æˆ–è€…ï¼Œä¿æŒ`x2`ä¸å˜ï¼Œå¦‚æœ`x1`å¢åŠ ä¸€ä¸ªå•ä½ï¼Œ*å±äºé˜³æ€§ç±»åˆ«çš„å¯¹æ•°æ¦‚ç‡*é¢„è®¡å°†æ”¹å˜ 1.3078ã€‚*

*![](img/b7d70d470a795b33e32097468123a0cd.png)*

*æˆ‘ä»¬ç°åœ¨å¯ä»¥çœ‹åˆ°ï¼Œé€»è¾‘å›å½’ç³»æ•°æ˜¾ç¤ºå¯¹æ•°ä¼˜åŠ¿æ¯”ã€‚*

*![](img/2bd0a2d5a53d8d318033cf797253cc9f.png)*

*ä¸¹-å…‹é‡Œæ–¯è’‚å®‰Â·pÄƒdureÈ›åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡*

*è¿™å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„å…¨éƒ¨å†…å®¹ï¼å¸Œæœ›ä½ å–œæ¬¢å­¦ä¹ é€»è¾‘å›å½’èƒŒåçš„ç›´è§‰å’Œæ•°å­¦ã€‚ä¸€è·¯ä¸Šï¼Œæˆ‘ä»¬è¿˜å­¦ä¹ äº†å…¶ä»–ç›¸å…³çš„æ¦‚å¿µï¼Œå¦‚èµ”ç‡ã€èµ”ç‡æ¯”å’Œå¤šä¸ªæœ‰ç”¨çš„å‡½æ•°ã€‚å¦‚æœä½ ä¹Ÿæƒ³å­¦ä¹ ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬ä»Šå¤©å­¦ä¹ çš„ä¸€äº›æ¦‚å¿µå¦‚é€»è¾‘å‡½æ•°å’Œå¯¹æ•°æŸå¤±å‡½æ•°å°†ä¼šæ´¾ä¸Šç”¨åœºã€‚æœ€åï¼Œå½“å‘æ¶‰ä¼—è§£é‡Šæ¨¡å‹çš„é©±åŠ¨å› ç´ æ—¶ï¼Œèƒ½å¤Ÿè§£é‡Šå¦‚ä½•è§£é‡Šé€»è¾‘å›å½’ç»“æœæ˜¯æœ‰å¸®åŠ©çš„ã€‚å¦‚æœä½ æ¸´æœ›äº†è§£æ›´å¤šå…³äºé€»è¾‘å›å½’çš„çŸ¥è¯†ï¼Œè¯·æŸ¥çœ‹è¿™ä¸ªèµ„æºã€‚*

**æ‚¨æƒ³è®¿é—®æ›´å¤šè¿™æ ·çš„å†…å®¹å—ï¼Ÿåª’ä½“ä¼šå‘˜å¯ä»¥æ— é™åˆ¶åœ°è®¿é—®åª’ä½“ä¸Šçš„ä»»ä½•æ–‡ç« ã€‚å¦‚æœæ‚¨ä½¿ç”¨* [*æˆ‘çš„æ¨èé“¾æ¥*](https://zluvsand.medium.com/membership)*æˆä¸ºä¼šå‘˜ï¼Œæ‚¨çš„ä¸€éƒ¨åˆ†ä¼šè´¹å°†ç›´æ¥ç”¨äºæ”¯æŒæˆ‘ã€‚**

*æ„Ÿè°¢æ‚¨é˜…è¯»æˆ‘çš„æ–‡ç« ã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œè¿™é‡Œæœ‰æˆ‘å…¶ä»–ä¸€äº›å¸–å­çš„é“¾æ¥:*

*â—¼ï¸ï¸ [K è¿‘é‚»è®²è§£](/k-nearest-neighbours-explained-52c910c035c5)
â—¼ï¸ï¸ [æ¯”è¾ƒéšæœºæ£®æ—å’Œæ¢¯åº¦æ¨è¿›](/comparing-random-forest-and-gradient-boosting-d7236b429c15)
â—¼ï¸ï¸ [å†³ç­–æ ‘æ˜¯å¦‚ä½•å»ºç«‹çš„ï¼Ÿ](/how-are-decision-trees-built-a8e5af57ce8?source=your_stories_page-------------------------------------)
â—¼ï¸ï¸ [ç®¡é“ã€ColumnTransformer å’Œ FeatureUnion è¯´æ˜](/pipeline-columntransformer-and-featureunion-explained-f5491f815f?source=your_stories_page-------------------------------------)t21ã€‘â—¼ï¸ï¸[feature unionã€ColumnTransformer &ç®¡é“ç”¨äºé¢„å¤„ç†æ–‡æœ¬æ•°æ®](/featureunion-columntransformer-pipeline-for-preprocessing-text-data-9dcb233dbcb6)*

*å†è§ğŸƒ ğŸ’¨*

# *å‚è€ƒğŸ“*

*   *Aurelien Geronï¼Œ*ä½¿ç”¨ Scikit-Learnã€Keras å’Œ TensorFlow è¿›è¡ŒåŠ¨æ‰‹æœºå™¨å­¦ä¹ ï¼Œ2017 å¹´* â€”ç¬¬ 4 ç« *