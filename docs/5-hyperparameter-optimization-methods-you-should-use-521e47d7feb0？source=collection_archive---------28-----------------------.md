# æ¯ä¸ªæ•°æ®ç§‘å­¦å®¶éƒ½åº”è¯¥ä½¿ç”¨çš„ 5 ç§è¶…å‚æ•°ä¼˜åŒ–æ–¹æ³•

> åŸæ–‡ï¼š<https://towardsdatascience.com/5-hyperparameter-optimization-methods-you-should-use-521e47d7feb0?source=collection_archive---------28----------------------->

## [å…¥é—¨](https://towardsdatascience.com/tagged/getting-started)

## ç½‘æ ¼æœç´¢ï¼Œè¿ç»­å‡åŠå’Œè´å¶æ–¯ç½‘æ ¼æœç´¢â€¦

![](img/aedbd0cd3b232d1d3151cd0eabfb68ba.png)

ç…§ç‰‡ç”±[é©¬åº“æ–¯Â·æ¸©å…‹å‹’](https://unsplash.com/@markuswinkler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šæ‹æ‘„

åœ¨æ¯ä¸ªæ•°æ®ç§‘å­¦é¡¹ç›®ä¸­ï¼Œæœç´¢è¶…å‚æ•°ç©ºé—´ä»¥è·å¾—æœ€ä½³æ€§èƒ½æŒ‡æ ‡æ˜¯å¯èƒ½çš„ï¼Œä¹Ÿæ˜¯æ¨èçš„ã€‚å¯»æ‰¾æœ€ä½³è¶…å‚æ•°ç»„åˆæ˜¯ä½ ä¸æƒ³é”™è¿‡çš„ä¸€æ­¥ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šç»™ä½ ç²¾å¿ƒæ„æ€çš„æ¨¡å‹å¸¦æ¥å®ƒæ‰€éœ€è¦çš„æœ€ç»ˆæå‡ã€‚

æˆ‘ä»¬ä¸­çš„è®¸å¤šäººé»˜è®¤ä½¿ç”¨ Scikit-learn ä¸­å®ç°çš„å®Œå–„çš„ GridSearchCVã€‚ç„¶è€Œï¼Œäº‹å®æ˜¯ï¼Œæ ¹æ®å…·ä½“æƒ…å†µï¼Œæ›¿ä»£çš„ä¼˜åŒ–æ–¹æ³•å¯èƒ½æ›´åˆé€‚ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºäº”ä¸ªé€‰é¡¹ï¼Œå¹¶å¯¹æ¯ä¸ªé€‰é¡¹è¿›è¡Œæ·±å…¥çš„è§£é‡Šï¼Œä»¥åŠå¦‚ä½•åœ¨å®è·µä¸­ä½¿ç”¨å®ƒä»¬çš„æŒ‡å—ã€‚

```
**Table Of Contents**
Â· [How to find my modelsâ€™ hyperparameters](#20eb)
Â· [Grid Search](#ec67)
Â· [Successive Halving](#3163)
Â· [Bayesian Grid Search](#e190) 
Â· [Visualizing hyperparameter optimization results](#82f5)
```

# é¢„çƒ­

åœ¨å¼€å§‹å¯»æ‰¾æˆ‘ä»¬çš„æœ€ä½³æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬æƒ³å…ˆæ‰¾åˆ°ä¸€ä¸ªæ•°æ®é›†å’Œä¸€ä¸ªæ¨¡å‹ã€‚

å¯¹äºæ•°æ®é›†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º `datasets`çš„åŒ…ï¼Œå®ƒå…è®¸æˆ‘ä»¬è½»æ¾ä¸‹è½½ 500 å¤šä¸ªæ•°æ®é›†:

æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨[äºšé©¬é€Šç¾å›½è¯„è®º](https://huggingface.co/datasets/viewer/?dataset=amazon_us_reviews&config=Video_Games_v1_00)ã€‚ç›®æ ‡æ˜¯ä½¿ç”¨å®¢æˆ·è¯„è®ºæ¥é¢„æµ‹å…¶ç›®æ ‡ç‰¹å¾(å½’å› çš„æ˜Ÿçº§æ•°)ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬å°†å®šä¹‰æ¨¡å‹ï¼Œå¹¶å°è¯•ä¼˜åŒ–å…¶è¶…å‚æ•°:

å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰[ç®¡é“](/4-scikit-learn-tools-every-data-scientist-should-use-4ee942958d9e)ï¼Œè¯·ä¸è¦çŠ¹è±«ï¼Œçœ‹çœ‹æˆ‘ä»¬ä»¥å‰çš„æ–‡ç« ï¼

# å¦‚ä½•æ‰¾åˆ°æˆ‘çš„æ¨¡å‹çš„è¶…å‚æ•°

åœ¨æˆ‘ä»¬è¿›å…¥ä¼˜åŒ–éƒ¨åˆ†ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“æˆ‘ä»¬çš„æ¨¡å‹çš„è¶…å‚æ•°æ˜¯ä»€ä¹ˆï¼Œå¯¹å—ï¼Ÿä¸ºæ­¤ï¼Œæœ‰ä¸¤ç§ç®€å•çš„æ–¹æ³•:

1.  ç‰¹å®šå‹å·çš„ Scikit-learn æ–‡æ¡£æ‚¨å¯ä»¥ç®€å•åœ°æŸ¥æ‰¾æ‚¨çš„ Scikit-learn å‹å·çš„æ–‡æ¡£ã€‚æ‚¨å°†çœ‹åˆ°è¶…å‚æ•°çš„å®Œæ•´åˆ—è¡¨ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„åç§°å’Œå¯èƒ½çš„å€¼ã€‚
2.  ä½¿ç”¨ä¸€è¡Œä»£ç ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ `get_params`æ–¹æ³•æ¥æŸ¥æ‰¾ç»™å®šä¼°è®¡å™¨çš„æ‰€æœ‰å‚æ•°çš„åç§°å’Œå½“å‰å€¼:

```
model.get_params()
```

æ—¢ç„¶æˆ‘ä»¬çŸ¥é“å¦‚ä½•æ‰¾åˆ°æˆ‘ä»¬çš„è¶…å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æˆ‘ä»¬ä¸åŒçš„ä¼˜åŒ–é€‰é¡¹ğŸ˜‰

# ç½‘æ ¼æœç´¢

## è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

ç½‘æ ¼æœç´¢æ˜¯ä¸€ç§åŸºäºå°è¯•æœ‰é™æ•°é‡çš„è¶…å‚æ•°å€¼çš„æ¯ä¸ªå¯èƒ½ç»„åˆçš„ä¼˜åŒ–æ–¹æ³•ã€‚æ¢å¥è¯è¯´ï¼Œä¸ºäº†å†³å®šå“ªç§å€¼çš„ç»„åˆèƒ½ç»™å‡ºæœ€ä½³ç»“æœï¼Œæˆ‘ä»¬è¦è€ƒè™‘æ‰€æœ‰çš„å¯èƒ½æ€§ï¼Œå¹¶ä½¿ç”¨ç‰¹å®šçš„æ€§èƒ½æŒ‡æ ‡æ¥è¡¡é‡æ¯ä¸ªç»“æœæ¨¡å‹çš„æ€§èƒ½ã€‚åœ¨å®è·µä¸­ï¼Œç½‘æ ¼æœç´¢é€šå¸¸ä¸è®­ç»ƒé›†ä¸Šçš„äº¤å‰éªŒè¯ç›¸ç»“åˆã€‚

è¯´åˆ°ç½‘æ ¼æœç´¢ï¼ŒScikit-learn ç»™äº†æˆ‘ä»¬ä¸¤ç§é€‰æ‹©:

## ç©·ä¸¾ç½‘æ ¼æœç´¢( [GridSearchCV](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html)

ç¬¬ä¸€ä¸ªç‰ˆæœ¬æ˜¯ä¸€ä¸ªç»å…¸ç‰ˆæœ¬ï¼Œå®ƒè¯¦å°½åœ°éå†äº†è¶…å‚æ•°å€¼çš„æ‰€æœ‰å¯èƒ½ç»„åˆã€‚å¾—åˆ°çš„æ¨¡å‹è¢«é€ä¸€è¯„ä¼°ï¼Œå¹¶æŒ‘é€‰å‡ºè¡¨ç°æœ€å¥½çš„ç»„åˆã€‚

ä¸ºäº†å¯è§†åŒ–ä½ çš„ç½‘æ ¼æœç´¢çš„ç»“æœå¹¶è·å¾—æœ€ä½³çš„è¶…å‚æ•°ï¼Œè¯·å‚è€ƒæ–‡ç« ç»“å°¾çš„[æ®µè½](https://medium.com/p/521e47d7feb0/edit)ã€‚

## éšæœºç½‘æ ¼æœç´¢( [RandomizedSearchCV](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html#sklearn.model_selection.RandomizedSearchCV) )

ç½‘æ ¼æœç´¢çš„ç¬¬äºŒç§å˜ä½“æ›´å…·é€‰æ‹©æ€§ã€‚ä¸æ˜¯éå†è¶…å‚æ•°çš„æ¯ä¸ªå¯èƒ½çš„ç»„åˆï¼Œè€Œæ˜¯åœ¨å¯èƒ½çš„ä¼°è®¡é‡ä¸­è¿›è¡Œé€‰æ‹©ã€‚äº‹å®ä¸Šï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å‚æ•°å€¼éƒ½è¢«å°è¯•è¿‡ã€‚ä»ä½œä¸ºè‡ªå˜é‡ç»™å‡ºçš„æŸä¸ªç»Ÿè®¡åˆ†å¸ƒä¸­æŠ½å–é€‰å®šçš„å›ºå®šæ•°é‡çš„å‚æ•°ç»„åˆã€‚

è¿™ç§æ–¹æ³•æä¾›äº†é€‰æ‹©æˆ‘ä»¬èƒ½å¤Ÿæ‰¿å—çš„è®¡ç®—æˆæœ¬çš„çµæ´»æ€§ã€‚è¿™æ˜¯é€šè¿‡è‡ªå˜é‡ `n_iter`å›ºå®šé‡‡æ ·å€™é€‰æ•°æˆ–é‡‡æ ·è¿­ä»£æ•°æ¥å®ç°çš„ã€‚

è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æåŠ:

*   **åˆ—è¡¨**è¢«**ç»Ÿä¸€é‡‡æ ·**
*   å¦‚æ–‡æ¡£ä¸­æ‰€è¿°:

å¦‚æœæ‰€æœ‰å‚æ•°éƒ½ä»¥**åˆ—è¡¨**ï¼Œ**æ˜¾ç¤ºï¼Œåˆ™æ‰§è¡Œæ— æ›¿æ¢**é‡‡æ ·ã€‚å¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ä½œä¸º**åˆ†å¸ƒ**ç»™å‡ºï¼Œåˆ™ä½¿ç”¨**æ›¿æ¢é‡‡æ ·**ã€‚

*   å»ºè®®**å¯¹è¿ç»­å‚æ•°**ä½¿ç”¨è¿ç»­åˆ†å¸ƒï¼Œä»¥å……åˆ†åˆ©ç”¨éšæœºåŒ–ã€‚è¿™æ–¹é¢çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ä¸Šé¢ä½¿ç”¨çš„å‡åŒ€åˆ†å¸ƒï¼Œç”¨äºå¯¹ TF-IDF çŸ¢é‡å™¨é€‰æ‹©çš„æœ€å¤§æ–‡æ¡£é¢‘ç‡è¿›è¡Œé‡‡æ ·ã€‚
*   ä½¿ç”¨ n_iter æ§åˆ¶ç»“æœå’Œè®¡ç®—æ•ˆç‡ä¹‹é—´çš„æƒè¡¡ã€‚å¢åŠ  n_iter æ€»æ˜¯ä¼šå¾—åˆ°æ›´å¥½çš„ç»“æœï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠè¿ç»­åˆ†å¸ƒçš„æƒ…å†µä¸‹ã€‚
*   ä»»ä½•å‡½æ•°éƒ½å¯ä»¥ä½œä¸ºåˆ†å¸ƒä¼ é€’ï¼Œåªè¦å®ƒå®ç°äº†ç”¨äºå€¼é‡‡æ ·çš„ `rvs`æ–¹æ³•(éšæœºå˜é‡æ ·æœ¬)ã€‚

# è¿ç»­å‡åŠ

## è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

scikit-learn æä¾›çš„ç¬¬äºŒç§è¶…å‚æ•°è°ƒæ•´æ–¹æ³•æ˜¯è¿ç»­å‡åŠã€‚è¿™ç§æ–¹æ³•åŒ…æ‹¬åœ¨è¶Šæ¥è¶Šå¤šçš„èµ„æºä¸Šè¿­ä»£åœ°é€‰æ‹©æ€§èƒ½æœ€ä½³çš„å€™é€‰è€…ã€‚

äº‹å®ä¸Šï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œåœ¨å°‘é‡èµ„æºä¸Šæµ‹è¯•äº†æœ€å¤§æ•°é‡çš„å‚æ•°ç»„åˆã€‚éšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ ï¼Œåªæœ‰è¡¨ç°æœ€å¥½çš„å€™é€‰é¡¹è¢«ä¿ç•™ã€‚åŸºäºå®ƒä»¬åœ¨å¤§é‡èµ„æºä¸Šçš„æ€§èƒ½æ¥æ¯”è¾ƒå®ƒä»¬ã€‚

ğŸ’¡**åœ¨å®è·µä¸­ï¼Œèµ„æºå¯ä»¥æ˜¯ä»€ä¹ˆï¼Ÿ**å¤§å¤šæ•°æ—¶å€™ï¼Œèµ„æºæ˜¯è®­ç»ƒé›†ä¸­çš„*ä¸ªæ ·æœ¬*ã€‚ç„¶è€Œï¼Œå¯ä»¥é€‰æ‹©å¦ä¸€ä¸ªè‡ªå®šä¹‰æ•°å­—å‚æ•°ï¼Œå¦‚éšæœºæ£®æ—ç®—æ³•ä¸­çš„æ ‘çš„æ•°é‡ï¼Œå°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ã€‚

ä¸ç¬¬ä¸€ç§ç½‘æ ¼æœç´¢ç±»ä¼¼ï¼Œæœ‰ä¸¤ç§å˜ä½“:**halvinggridsearccv**å’Œ **HalvingRandomSearchCV** ã€‚

## è¿ç»­ç­‰åˆ†ç½‘æ ¼æœç´¢([halvinggridsearccv](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.HalvingGridSearchCV.html#sklearn.model_selection.HalvingGridSearchCV))

scikit-learn ä¸Šçš„è¿ç»­å‡åŠä¼°è®¡å™¨ä»å¤„äºè¯•éªŒé˜¶æ®µã€‚å› æ­¤ï¼Œä¸ºäº†ä½¿ç”¨å®ƒä»¬ï¼Œæ‚¨éœ€è¦æœ‰æœ€æ–°ç‰ˆæœ¬çš„ sci kit-learnâ€œ0 . 24 . 0â€å¹¶éœ€è¦å®éªŒåŠŸèƒ½:

```
from sklearn.experimental import enable_halving_search_cv
```

ä¸€æ—¦å®Œæˆï¼Œä»£ç ä¸ GridSearchCV çš„å®Œå…¨ç›¸ä¼¼:

ä¸ºäº†æœ€å¤§é™åº¦åœ°åˆ©ç”¨è¿ç»­å‡åŠå¹¶æ ¹æ®æ‚¨çš„éœ€æ±‚å®šåˆ¶è®¡ç®—æˆæœ¬ï¼Œæœ‰è®¸å¤šç›¸å…³çš„è®ºæ®å¯ä¾›å‚è€ƒ:

*   **èµ„æº**:æ‚¨å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‚æ•°æ¥å®šåˆ¶æ¯æ¬¡è¿­ä»£å¢åŠ çš„èµ„æºç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å®šä¹‰ä¸ºéšæœºæ£®æ—ä¸­çš„æ ‘çš„æ•°é‡:

ç”šè‡³æ˜¯ TFIDF çŸ¢é‡åŒ–ä¸­çš„è¦ç´ æ•°é‡:

ä½†æ˜¯ï¼Œè¯·ç¡®ä¿ä» param_grid å­—å…¸ä¸­åˆ é™¤èµ„æºç±»å‹ã€‚

*   **å› å­**:æ­¤å‚æ•°ä¸º**å‡åŠ**å‚æ•°ã€‚é€šè¿‡ä¸ºæ­¤å‚æ•°é€‰æ‹©æŸä¸ªå€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è¢«é€‰ä¸­çš„å€™é€‰é¡¹çš„æ¯”ä¾‹ä»¥åŠæ¯æ¬¡è¿­ä»£æ‰€ä½¿ç”¨çš„èµ„æºæ•°é‡:

> n _ èµ„æº _ { I+1 } = n _ èµ„æº _i *å› å­
> 
> n _ å€™é€‰äºº _ { I+1 } = n _ å€™é€‰äºº _i /å› å­

*   **ç§¯ææ¶ˆé™¤**:ç”±äºåœ¨æ¯æ¬¡è¿­ä»£ä¸­ä½¿ç”¨çš„èµ„æºé‡éƒ½è¦ä¹˜ä»¥**å› å­**ï¼Œå› æ­¤æœ€å¤šåªèƒ½æœ‰ **i_max** æ¬¡è¿­ä»£

> (n _ èµ„æº _ { i _ max } = n _ èµ„æº _ { 0 } * factor^{i_max})â‰¤max _ n _ èµ„æº

å¦‚æœèµ„æºçš„æ•°é‡ä¸å¤Ÿå¤šï¼Œé‚£ä¹ˆåœ¨æœ€åä¸€æ¬¡è¿­ä»£ä¸­å‰©ä½™çš„å€™é€‰æ•°é‡å°±ä¸å¤Ÿå°‘ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»æ€§æ·˜æ±°è®ºæ˜¯æœ‰æ„ä¹‰çš„ã€‚äº‹å®ä¸Šï¼Œå¦‚æœè®¾ç½®ä¸º Trueï¼Œç¬¬ä¸€æ¬¡è¿­ä»£ä¼šæ‰§è¡Œå¤šæ¬¡ï¼Œç›´åˆ°å€™é€‰é¡¹çš„æ•°é‡è¶³å¤Ÿå°‘ã€‚

## éšæœºè¿ç»­å‡åŠ( [HalvingRandomSearchCV](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.HalvingRandomSearchCV.html)

å°±åƒéšæœºç½‘æ ¼æœç´¢ä¸€æ ·ï¼Œéšæœºè¿ç»­å‡åŠç±»ä¼¼äºå¸¸è§„è¿ç»­å‡åŠï¼Œåªæœ‰ä¸€ä¸ªä¾‹å¤–ã€‚åœ¨è¿™ç§å˜å‹ä¸­ï¼Œä»å‚æ•°ç©ºé—´ä¸­éšæœºé‡‡æ ·å›ºå®šé€‰æ‹©æ•°é‡çš„å€™é€‰è€…ã€‚è¿™ä¸ªæ•°å­—ä½œä¸ºä¸€ä¸ªåä¸º **n_candidates** çš„å‚æ•°ç»™å‡ºã€‚è®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„ä»£ç ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›åº”ç”¨éšæœºè¿ç»­å‡åŠï¼Œç›¸åº”çš„ä»£ç å°†æ˜¯:

# è´å¶æ–¯ç½‘æ ¼æœç´¢

æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­è®¨è®ºçš„ç¬¬ä¸‰ä¸ªä¹Ÿæ˜¯æœ€åä¸€ä¸ªæ–¹æ³•æ˜¯**è¶…å‚æ•°è´å¶æ–¯ä¼˜åŒ–**ã€‚ä¸ºäº†åœ¨ Python ä¸­ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªåä¸º scikit-optimize çš„åº“ã€‚è¯¥æ–¹æ³•è¢«ç§°ä¸º[**BayesSearchCV**](https://scikit-optimize.github.io/stable/modules/generated/skopt.BayesSearchCV.html#skopt.BayesSearchCV)**ï¼Œå¦‚[æ–‡æ¡£](https://scikit-optimize.github.io/stable/auto_examples/sklearn-gridsearchcv-replacement.html)ä¸­æ‰€è¿°ï¼Œå®ƒ*åˆ©ç”¨è´å¶æ–¯ä¼˜åŒ–ï¼Œå…¶ä¸­è¢«ç§°ä¸ºâ€œä»£ç†â€çš„é¢„æµ‹æ¨¡å‹è¢«ç”¨äºå¯¹æœç´¢ç©ºé—´å»ºæ¨¡ï¼Œå¹¶è¢«ç”¨äºå°½å¿«è¾¾åˆ°è‰¯å¥½çš„å‚æ•°å€¼ç»„åˆ*ã€‚**

****éšæœºç½‘æ ¼æœç´¢å’Œè´å¶æ–¯ç½‘æ ¼æœç´¢æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ****

**ä¸éšæœºç½‘æ ¼æœç´¢ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯è€ƒè™‘äº†æœç´¢ç©ºé—´çš„ç»“æ„ä»¥ä¼˜åŒ–æœç´¢æ—¶é—´ã€‚è¿™æ˜¯é€šè¿‡åœ¨è®°å¿†ä¸­ä¿ç•™è¿‡å»çš„è¯„ä¼°ï¼Œå¹¶ä½¿ç”¨è¯¥çŸ¥è¯†æ¥é‡‡æ ·æœ€æœ‰å¯èƒ½ç»™å‡ºæ›´å¥½ç»“æœçš„æ–°å€™é€‰äººæ¥å®ç°çš„ã€‚**

**ç°åœ¨æˆ‘ä»¬å¯¹è¿™ä¸ªæ–¹æ³•æœ‰äº†ä¸€ä¸ªæ¸…æ™°çš„æ•´ä½“æ¦‚å¿µï¼Œè®©æˆ‘ä»¬ç»§ç»­å…·ä½“çš„éƒ¨åˆ†ï¼Œç¼–ç éƒ¨åˆ†ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º [scikit-optimize](https://pypi.org/project/scikit-optimize/) çš„åº“ã€‚**

**æˆ‘åº”è¯¥æä¸€ä¸‹:**

**1-å¦‚æœæ‚¨ä½¿ç”¨ scikit-optimize çš„æœ€æ–°ç‰ˆæœ¬æ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œæ‚¨å¯èƒ½éœ€è¦å°† scikit-learn ç‰ˆæœ¬é™çº§ä¸ºâ€œ0.23.2â€(æˆ‘å»ºè®®æ‚¨åœ¨æ–°ç¯å¢ƒä¸­è¿™æ ·åš):**

```
pip install scikit-learn==0.23.2
```

**2-æ­¤å¤–ï¼Œä¸ºäº†é¿å…ä»»ä½•è¿›ä¸€æ­¥çš„é”™è¯¯ï¼Œè¯·ç¡®ä¿é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…æœ€æ–°çš„å¼€å‘ç‰ˆæœ¬:**

```
pip install git+https://github.com/scikit-optimize/scikit-optimize.git
```

**ç°åœ¨æˆ‘ä»¬æ¨¡å‹çš„å®é™…ä»£ç åº”è¯¥æ˜¯:**

# **å¯è§†åŒ–è¶…å‚æ•°ä¼˜åŒ–ç»“æœ**

**ä¸ºäº†è·å¾—æ‰€æœ‰å€™é€‰äººè¡¨ç°çš„å®Œæ•´æŠ¥å‘Šï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹ä¸Šé¢åˆ—å‡ºçš„æ‰€æœ‰æ–¹æ³•ä½¿ç”¨å±æ€§ cv_results_ å³å¯ã€‚ç”Ÿæˆçš„å­—å…¸å¯è½¬æ¢ä¸ºæ•°æ®æ¡†ä»¥æé«˜å¯è¯»æ€§:**

```
import pandas as pd
results = pd.DataFrame(grid_search.cv_results_)
```

**è¦è·å¾—å…¶ä»–ç»“æœé¡¹ï¼Œæ‚¨åªéœ€è¦ä»¥ä¸‹å‡ è¡Œä»£ç :**

## **è·èƒœçš„å€™é€‰äºº:**

```
best_model = grid_search.best_estimator_
```

## **è¶…å‚æ•°çš„æœ€ä½³ç»„åˆ:**

```
params = grid_search.best_params_
```

## **åœ¨æµ‹è¯•é›†ä¸Šå°è¯•æœ€ä½³å€™é€‰é¡¹åçš„æœ€ä½³å¾—åˆ†:**

```
score = grid_search.best_score
```

## **ç½‘æ ¼æœç´¢æŠ¥å‘Š**

**å¦‚æœä½ å¸Œæœ›åœ¨æœç´¢è¿‡ç¨‹ä¸­å¾—åˆ°å®æ—¶æŠ¥å‘Šï¼Œscikit-learn çš„å¼€å‘äººå‘˜ä¼šå¥½å¿ƒåœ°å‘å¸ƒä¸€æ®µç°æˆçš„ä»£ç æ¥åšè¿™ä»¶äº‹ã€‚ç»“æœçœ‹èµ·æ¥åƒè¿™æ ·:**

**![](img/3d658bdce8f9e10503260aecacf64cc4.png)**

**ä½œè€…æˆªå›¾**

# **æœ€åçš„æƒ³æ³•**

**å½“è°ˆåˆ°è¶…å‚æ•°ä¼˜åŒ–æ—¶ï¼ŒPython æä¾›äº†å¤§é‡ç°æˆçš„å·¥å…·ä¾›æ‚¨é€‰æ‹©ã€‚ä½ å¯ä»¥é€‰æ‹©é€‚åˆä½ çš„æ–¹æ³•ï¼Œå¹¶æ ¹æ®ä½ çš„éœ€è¦è¿›è¡Œå®éªŒã€‚æœ€ä½³æ¨¡å‹æ€§èƒ½å’Œæœ€ä½³æœç´¢æ—¶é—´ä¹‹é—´çš„æƒè¡¡é€šå¸¸æ˜¯å¯¹é€‰æ‹©å½±å“æœ€å¤§çš„å› ç´ ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œé‡è¦çš„æ˜¯ä¸è¦å¿˜è®°è¿™ä¸€æ­¥ï¼Œè®©æ‚¨çš„æ¨¡å‹æœ‰æœ€å¥½çš„æœºä¼šè¡¨ç°è‰¯å¥½ã€‚**

**ä½ å¯ä»¥åœ¨è¿™ä¸ª [**Github åº“**](https://github.com/amal-hasni/hyperparameter_optimization) ä¸­æ‰¾åˆ°æ‰€æœ‰èšé›†åœ¨ä¸€ä¸ªåœ°æ–¹çš„ Python è„šæœ¬ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·ä¸è¦çŠ¹è±«ï¼Œåœ¨å›å¤éƒ¨åˆ†ç•™è¨€ï¼Œæˆ‘ä»¬å°†éå¸¸ä¹æ„å›ç­”ã€‚**

**æ„Ÿè°¢æ‚¨åšæŒåˆ°ç°åœ¨ï¼Œæ³¨æ„å®‰å…¨ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å†è§ï¼ğŸ˜Š**

# **æ›´å¤šæ–‡ç« é˜…è¯»**

**[](/4-scikit-learn-tools-every-data-scientist-should-use-4ee942958d9e) [## 4 sci kitâ€”â€”æ¯ä¸ªæ•°æ®ç§‘å­¦å®¶éƒ½åº”è¯¥ä½¿ç”¨çš„å­¦ä¹ å·¥å…·

### å¤åˆä¼°ç®—å™¨å’Œå˜å‹å™¨

towardsdatascience.com](/4-scikit-learn-tools-every-data-scientist-should-use-4ee942958d9e) [](/classification-model-for-source-code-programming-languages-40d1ab7243c2) [## æºä»£ç è¯­è¨€çš„åˆ†ç±»æ¨¡å‹

### å¤§çº¦ 97%çš„å‡†ç¡®ç‡

towardsdatascience.com](/classification-model-for-source-code-programming-languages-40d1ab7243c2) 

# å‚è€ƒ

*   [sci kit-learn . org/stable/auto _ examples/model _ selection/plot _ grid _ search _ digits . html](https://scikit-learn.org/stable/auto_examples/model_selection/plot_grid_search_digits.html)
*   [sci kit-learn . org/stable/modules/generated/sk learn . model _ selectionã€‚GridSearchCV.html](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html)
*   [scikit-learn.org/stable/modules/grid_search.html](https://scikit-learn.org/stable/modules/grid_search.html)
*   [scikit-learn . org/stable/auto _ examples/model _ selection/plot _ successful _ halving _ heat map . html # sphx-glr-auto-examples-model-selection-plot-successful-halving-heat map-py](https://scikit-learn.org/stable/auto_examples/model_selection/plot_successive_halving_heatmap.html#sphx-glr-auto-examples-model-selection-plot-successive-halving-heatmap-py)
*   [scikit-learn . org/stable/modules/grid _ search . html # aggressive-elimination](https://scikit-learn.org/stable/modules/grid_search.html#aggressive-elimination)**