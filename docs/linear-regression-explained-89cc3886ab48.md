# çº¿æ€§å›å½’è§£é‡Š

> åŸæ–‡ï¼š<https://towardsdatascience.com/linear-regression-explained-89cc3886ab48?source=collection_archive---------25----------------------->

![](img/19f5dc803ea2516a13c6802720c8630e.png)

ç”± [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Š [Lea Kobal](https://unsplash.com/@leyko?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„ç…§ç‰‡

## æ•°æ®ç§‘å­¦åŸºç¡€

## äº†è§£è¿™ç§å—ç›‘ç£çš„æœºå™¨å­¦ä¹ ç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„

*çº¿æ€§å›å½’*å¯èƒ½æ˜¯æœ€çŸ¥åçš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ç”±äºå®ƒçš„ç®€å•æ€§ã€é€Ÿåº¦å’Œå¯è§£é‡Šæ€§ï¼Œå®ƒé€šå¸¸æ˜¯å­¦ä¹ æˆ–å®è·µæ•°æ®ç§‘å­¦æ—¶é‡åˆ°çš„ç¬¬ä¸€ä¸ªç®—æ³•ã€‚å¦‚æœä½ æƒ³åŠ æ·±å¯¹çº¿æ€§å›å½’çš„ç†è§£ï¼Œè¿™ç¯‡æ–‡ç« å±•ç¤ºäº†ç®—æ³•èƒŒåçš„æ•°å­¦ï¼Œé‡ç‚¹æ˜¯*æ­£è§„æ–¹ç¨‹*ä»¥åŠå¦‚ä½•è§£é‡Šçº¿æ€§å›å½’çš„å‚æ•°ã€‚

![](img/e58e7f33e481e7ec75c90a1004ef0845.png)

ç…§ç‰‡ç”± [Tim Swaan](https://unsplash.com/@timswaanphotography?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

*æˆ‘ä»¬å°†çœ‹åˆ°ä¸€äº›ç”¨ Python ç¼–å†™çš„ä»£ç ç¤ºä¾‹ï¼Œç„¶è€Œï¼Œè¯»è€…å¯ä»¥åœ¨ä¸äº†è§£ Python çš„æƒ…å†µä¸‹å¸æ”¶æ¦‚å¿µæ€§çŸ¥è¯†ã€‚*

# æ¦‚è§‚ğŸ“œ

> çº¿æ€§å›å½’æ˜¯ä¸€ç§é¢„æµ‹è¿ç»­ç›®æ ‡çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚

çº¿æ€§å›å½’æ–¹ç¨‹ç”±ä¸‹å¼è¡¨ç¤º:

![](img/26597acc9317c8ddef3a3f5f71e8b880.png)

æ ¹æ®æ‰€ç”¨ç‰¹å¾çš„æ•°é‡ï¼Œçº¿æ€§å›å½’å¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºä¸¤ç±»ã€‚å¦‚æœä½¿ç”¨å•ä¸€ç‰¹å¾æ¥é¢„æµ‹ç›®æ ‡ï¼Œåˆ™ç§°ä¸º*ç®€å•çº¿æ€§å›å½’*ã€‚å¦‚æœä½¿ç”¨äº†å¤šä¸ª(å³ä¸¤ä¸ªæˆ–æ›´å¤š)ç‰¹å¾ï¼Œåˆ™ç§°ä¸º*å¤šå…ƒ*æˆ–*å¤šå…ƒå›å½’*ã€‚

# è®­ç»ƒçº¿æ€§å›å½’ğŸ”§

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å­¦ä¹ æ¨¡å‹å¦‚ä½•å­¦ä¹ æœ€ä¼˜çš„[æ¨¡å‹å‚æ•°](https://machinelearningmastery.com/difference-between-a-parameter-and-a-hyperparameter/)(å³æˆªè·å’Œç³»æ•°)ã€‚åœ¨è®­ç»ƒçº¿æ€§å›å½’æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°æœ€ä½³çš„å‚æ•°ç»„åˆï¼Œä»¥ä¾¿ä¸ä»»ä½•å…¶ä»–ç»„åˆç›¸æ¯”ï¼Œå®ƒä»¬åœ¨æ‰€æœ‰è®­ç»ƒç¤ºä¾‹ä¸­äº§ç”Ÿæœ€ä½çš„è¯¯å·®ã€‚å¯¹äºç»™å®šçš„ä¸€ç»„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨*å‡æ–¹è¯¯å·®(åˆå MSE)* æ¥æµ‹é‡æ€»è¯¯å·®:

![](img/0c701a3da662b3f1853134afe52232fe.png)

è¯¯å·®æ˜¯å¹³æ–¹çš„ï¼Œå› æ­¤æ­£è´Ÿè¯¯å·®ä¸ä¼šç›¸äº’æŠµæ¶ˆã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ‰¾åˆ°æœ€ä½³çš„å‚æ•°è®¾ç½®:
â—¼ä½¿ç”¨æ ‡å‡†æ–¹ç¨‹
â—¼ä½¿ç”¨ä¼˜åŒ–ç®—æ³•

## ğŸ“ä½¿ç”¨æ­£å¸¸æ–¹ç¨‹

æˆ‘ä»¬å°†éœ€è¦äº†è§£*çŸ©é˜µè½¬ç½®*ã€*çŸ©é˜µä¹˜æ³•ã€*å’Œ*çŸ©é˜µæ±‚é€†*çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥éµå¾ªå³å°†åˆ°æ¥çš„æ­£è§„æ–¹ç¨‹ç¤ºä¾‹ã€‚åœ¨æˆ‘ä»¬æ·±å…¥è®¨è®ºä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå¿«é€Ÿå›é¡¾ä¸€ä¸‹è¿™äº›ä¸»é¢˜ã€‚

**çŸ©é˜µè½¬ç½®:**ä¸‹é¢æ˜¯è½¬ç½®ä¸€ä¸ª 2x2 çŸ©é˜µçš„å…¬å¼:

![](img/dfce63fb6b97861909360d1aaafb8db8.png)

æ‚¨å¯ä»¥æƒ³è±¡æ‚¨æ­£åœ¨æ²¿ç€ä»å·¦ä¸Šå»¶ä¼¸åˆ°å³ä¸‹çš„å¯¹è§’çº¿ç¿»è½¬å€¼ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:

![](img/53ad1e78471de386acda2999d2f3d3d5.png)

**çŸ©é˜µä¹˜æ³•:**ä¸‹é¢æ˜¯ä¸¤ä¸ª 2x2 çŸ©é˜µç›¸ä¹˜çš„å…¬å¼:

![](img/c3b4cd1d7ef943358498b3adf12fed15.png)

è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:

![](img/28795a68fd287ee8a83d32634ed0adb5.png)

**é€†çŸ©é˜µ:**çŸ©é˜µè¦æœ‰é€†çŸ©é˜µï¼ŒçŸ©é˜µå¿…é¡»æ˜¯æ–¹é˜µ(å³è¡Œæ•°=åˆ—æ•°)ã€‚ä¸‹é¢æ˜¯è®¡ç®— 2x2 çŸ©é˜µçš„é€†çŸ©é˜µçš„å…¬å¼:

![](img/02c2af1744607371c8e515188fddc957.png)

å¦‚æœä¸€ä¸ªçŸ©é˜µçš„è¡Œåˆ—å¼(å³`ad-bc`)ä¸ºé›¶ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µå°±ä¸ä¼šæœ‰é€†çŸ©é˜µã€‚è¿™æ ·çš„çŸ©é˜µç§°ä¸ºå¥‡å¼‚çŸ©é˜µã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªæ±‚é€†çŸ©é˜µçš„ä¾‹å­:

![](img/c977aeb977799b82293c40220a5b78ef.png)![](img/7503592da1e80c28bc32f530a6550738.png)

ç…§ç‰‡ç”± [v2osk](https://unsplash.com/@v2osk?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½ç†Ÿæ‚‰*æ­£è§„æ–¹ç¨‹*:

![](img/aa25b94c993a1deeaaa25a81a857c63c.png)

è®©æˆ‘ä»¬é‡å†™æˆ‘ä»¬çš„çº¿æ€§æ–¹ç¨‹ï¼Œä½¿å¾—æˆªè·æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç³»æ•°ï¼Œå…¶ä¸­å¯¹åº”çš„ç‰¹å¾`x0`å–å¸¸æ•°å€¼ 1:

![](img/e4e0ac3eae21b8b318dff10d6f65e9fd.png)

è®©æˆ‘ä»¬ä½¿ç”¨ç©å…·æ•°æ®é›†ä¸Šçš„æ­£æ€æ–¹ç¨‹æ¥å¯»æ‰¾ç®€å•çº¿æ€§å›å½’çš„å‚æ•°ï¼Œè¯¥æ•°æ®é›†å…·æœ‰ä¸€ä¸ªè§£é‡Šç‰¹å¾`x1`å’Œä¸€ä¸ªç›®æ ‡`y`ï¼Œä»¥ä¾¿æˆ‘ä»¬è‡ªå·±å¯ä»¥ç®¡ç†è®¡ç®—ã€‚

![](img/db7c65016acd626fcb942d9dbf89afb4.png)

ä»ä¸‹é¢ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†`X`ï¼Œä¸€ä¸ª 5x2 çš„ç‰¹å¾çŸ©é˜µã€‚ç¬¬ä¸€åˆ—æ˜¾ç¤ºäº† 5 ä¸ªè®­ç»ƒç¤ºä¾‹çš„`x0`ï¼Œç¬¬äºŒåˆ—æ˜¾ç¤ºäº†`x1`ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†`X^T`ä¹˜ä»¥`X`:

![](img/2b534a57a4bca056c439b5918bafd38c.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ‰¾åˆ°å®ƒçš„é€†:

![](img/4c87b6d936c655020c26733c0ec14319.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®ƒä¹˜ä»¥`X_T`:

![](img/24108154b59be9bf092438d55bff6d01.png)

æœ€åï¼Œæˆ‘ä»¬å°†å®ƒä¹˜ä»¥å®é™…ç›®æ ‡å€¼ï¼Œä»¥æ‰¾åˆ°æœ€ä½³å‚æ•°:

![](img/148154116f8289fc2cf5950008379fc3.png)

å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬å‘ç°æˆªè·æ˜¯ 0.3588ï¼Œç³»æ•°æ˜¯ 0.2647ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ Python ä¸­è¿›è¡ŒåŒæ ·çš„è®¡ç®—æ¥è®¡ç®—å‚æ•°:

```
import numpy as np
import pandas as pd
pd.options.display.precision = 4from sklearn.linear_model import LinearRegression# Create sample data
train = pd.DataFrame({'x1': [8, 15, 6, 16, 20], 
                      'y': [4, 3, 1, 5, 6]})
train
```

![](img/76a2df594b97301ce73759de30c6c130.png)

```
# Add x0=[1, 1, .., 1] for the intercept such that X is 5x2 matrix
x0 = np.ones(train.shape[0])[:, np.newaxis]
X = np.concatenate((x0, train.drop(columns='y')), axis=1)# Reshape y from 1D to 2D such that Y is 5x1 matrix
Y = train['y'].values.reshape(-1,1)# Find best parameters for the model
theta = np.linalg.inv(X.T.dot(X)).dot(X.T).dot(Y)
print(f"Intercept: {theta[0][0]:.4f}")
print(f"Coefficient for x1: {theta[1][0]:.4f}")# Predict
train['y_hat_manual'] = X.dot(theta)
train['residual'] = train['y'] - train['y_hat_manual']
train
```

![](img/cfa6827acde02f8d1506aa4d8c67d337.png)

è®©æˆ‘ä»¬å¯¹ç…§ Scikit-learn çš„è¾“å‡ºå¿«é€Ÿæ£€æŸ¥ä¸€ä¸‹:

```
# Check parameters against sklearn
model = LinearRegression()
model.fit(train[['x1']], train['y'])
print(f"Intercept: {model.intercept_:.4f}")
print(f"Coefficient for x1: {model.coef_[0]:.4f}")# Check predictions against sklearn
train['y_hat_sklearn'] = model.predict(train[['x1']])
train
```

![](img/a5bfb6762541aa029aafa69924f26000.png)

å®Œç¾ï¼Œç»“æœåŒ¹é…ï¼

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœ`X^T â‹… X`æ˜¯å¥‡å¼‚çš„(å³è¡Œåˆ—å¼æ˜¯é›¶)ï¼Œé‚£ä¹ˆæœ‰äº›æ—¶å€™æ­£è§„æ–¹ç¨‹ä¸èµ·ä½œç”¨ã€‚

## ğŸ“ä½¿ç”¨ä¼˜åŒ–ç®—æ³•

è®­ç»ƒæ¨¡å‹çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ä¼˜åŒ–ç®—æ³•ï¼Œå¦‚[æ¢¯åº¦ä¸‹é™](https://ml-cheatsheet.readthedocs.io/en/latest/gradient_descent.html)ï¼Œä»¥æ‰¾åˆ°ä½¿æ€»è¯¯å·®æœ€å°åŒ–çš„æœ€ä½³å‚æ•°ã€‚ä¼˜åŒ–ç®—æ³•è¿­ä»£æ±‚è§£å‚æ•°çš„æœ€ä½³ç»„åˆã€‚ä½¿ç”¨ä¼˜åŒ–ç®—æ³•è®­ç»ƒçº¿æ€§å›å½’æ—¶ï¼Œå…·æœ‰ç›¸åŒæ¯”ä¾‹çš„è¦ç´ æœ‰åŠ©äºæ›´å¿«åœ°æ”¶æ•›åˆ°å…¨å±€æœ€å°å€¼ã€‚å®é™…ä¸Šï¼Œä¼˜åŒ–ç®—æ³•çš„é€‰æ‹©å–å†³äºå®ç°ã€‚

# è§£é‡Šçº¿æ€§å›å½’å‚æ•°ğŸ”

> **æˆªè·**å‘Šè¯‰æˆ‘ä»¬æ‰€æœ‰ç‰¹å¾éƒ½ä¸º 0 æ—¶çš„é¢„æœŸç›®æ ‡å€¼ã€‚

![](img/b1ce8fef1cf355e6a3c33c31e185f12e.png)

åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå½“ç‰¹å¾`x1`ä¸ºé›¶æ—¶ï¼Œç›®æ ‡é¢„è®¡ä¸º 0.2647:

![](img/dc32c66c80ad78b22f29f94e7d7b611c.png)

> **ç³»æ•°**å‘Šè¯‰æˆ‘ä»¬ï¼Œå½“æ„Ÿå…´è¶£çš„ç‰¹æ€§å¢åŠ ä¸€ä¸ªå•ä½ï¼Œè€Œæ‰€æœ‰å…¶ä»–ç‰¹æ€§ä¿æŒä¸å˜æ—¶ï¼Œç›®æ ‡å€¼çš„é¢„æœŸå˜åŒ–ã€‚ç³»æ•°çš„ç¬¦å·å‘Šè¯‰æˆ‘ä»¬ç‰¹å¾å’Œç›®æ ‡ä¹‹é—´çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼Œæ­£ç³»æ•°è¡¨ç¤ºæ­£å…³ç³»ã€‚

![](img/cf46e20db20cfd7dff13d0e0e7f1282d.png)

å½“ç‰¹æ€§`x1`å¢åŠ ä¸€ä¸ªå•ä½æ—¶ï¼Œç›®æ ‡é¢„è®¡å¢åŠ  0.3588:

![](img/c043fff1cf5911b346f4cbe4c808d80b.png)![](img/f3c3a2f91fb38e22cd91e57ee6c868a6.png)

[David Marcu](https://unsplash.com/@davidmarcu?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

è¿™å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„å…¨éƒ¨å†…å®¹ï¼å¸Œæœ›æ‚¨å–œæ¬¢åŠ æ·±å¯¹çº¿æ€§å›å½’çš„äº†è§£ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å¤ä¹ äº†åŸºæœ¬çš„çº¿æ€§ä»£æ•°(å¦‚çŸ©é˜µä¹˜æ³•å’ŒçŸ©é˜µæ±‚é€†)ã€‚æœ€åï¼Œåœ¨å‘ä»–äººè§£é‡Šæ¨¡å‹çš„é©±åŠ¨å› ç´ æ—¶ï¼Œèƒ½å¤Ÿè§£é‡Šå¦‚ä½•è§£é‡Šçº¿æ€§å›å½’ç»“æœæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚å¦‚æœä½ æ¸´æœ›äº†è§£æ›´å¤šï¼Œè¯·æŸ¥çœ‹å…³äºçº¿æ€§å›å½’å‡è®¾çš„èµ„æº[ã€‚](https://blog.uwgb.edu/bansalg/statistics-data-analytics/linear-regression/what-are-the-four-assumptions-of-linear-regression/)

*æ‚¨æƒ³è¦è®¿é—®æ›´å¤šè¿™æ ·çš„å†…å®¹å—ï¼Ÿåª’ä½“ä¼šå‘˜å¯ä»¥æ— é™åˆ¶åœ°è®¿é—®åª’ä½“ä¸Šçš„ä»»ä½•æ–‡ç« ã€‚å¦‚æœæ‚¨ä½¿ç”¨* [*æˆ‘çš„æ¨èé“¾æ¥*](https://zluvsand.medium.com/membership) ï¼Œ*æˆä¸ºä¼šå‘˜ï¼Œæ‚¨çš„ä¸€éƒ¨åˆ†ä¼šè´¹å°†ç›´æ¥ç”¨äºæ”¯æŒæˆ‘ã€‚*

æ„Ÿè°¢æ‚¨é˜…è¯»æˆ‘çš„æ–‡ç« ã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œè¿™é‡Œæœ‰æˆ‘å…¶ä»–ä¸€äº›å¸–å­çš„é“¾æ¥:

â—¼ï¸ï¸ [K è¿‘é‚»è®²è§£](/k-nearest-neighbours-explained-52c910c035c5)
â—¼ï¸ï¸ [æ¯”è¾ƒéšæœºæ£®æ—å’Œæ¢¯åº¦æ¨è¿›](/comparing-random-forest-and-gradient-boosting-d7236b429c15)
â—¼ï¸ï¸ [å†³ç­–æ ‘æ˜¯å¦‚ä½•å»ºç«‹çš„ï¼Ÿ](/how-are-decision-trees-built-a8e5af57ce8?source=your_stories_page-------------------------------------)
â—¼ï¸ï¸ [ç®¡é“ã€ColumnTransformer å’Œ FeatureUnion è¯´æ˜](/pipeline-columntransformer-and-featureunion-explained-f5491f815f?source=your_stories_page-------------------------------------)
â—¼ï¸ï¸ [FeatureUnionã€ColumnTransformer &ç®¡é“ç”¨äºé¢„å¤„ç†æ–‡æœ¬æ•°æ®](/featureunion-columntransformer-pipeline-for-preprocessing-text-data-9dcb233dbcb6)

å†è§ğŸƒ ğŸ’¨

# å‚è€ƒğŸ“

*   Aurelien Geronï¼Œ*ä½¿ç”¨ Scikit-Learnã€Keras å’Œ TensorFlow è¿›è¡ŒåŠ¨æ‰‹æœºå™¨å­¦ä¹ ï¼Œ2017 å¹´* -ç¬¬ 4 ç« 