# 如何用 Python 将数据集分割成训练集和测试集

> 原文：<https://towardsdatascience.com/how-to-split-a-dataset-into-training-and-testing-sets-b146b1649830?source=collection_archive---------1----------------------->

## 探索从建模数据集创建训练和测试样本的三种方法

![](img/8aaeb3341f6dd6f10dd5d75d1bd77d20.png)

照片由 [Siora 摄影](https://unsplash.com/@siora18)在 [Unsplash](https://unsplash.com/photos/bvfLgWu31t8) 上拍摄

在机器学习的背景下，将我们的建模数据集分成训练和测试样本可能是我们需要进行的最早的预处理步骤之一。为训练和测试创建不同的样本有助于我们评估模型性能。

在本文中，我们将在建模和模型训练的上下文中讨论训练和测试样本的目的。另外。我们将探索使用 Python 和 pandas 创建此类样本的三种简单方法。更具体地说，我们将展示如何创建训练和测试样本:

*   使用`scikit-learn`(又名`sklearn` ) `train_test_split()`
*   使用`numpy`的`randn()`功能
*   或者用内置的`pandas`方法称为`sample()`

# 为什么我们需要训练和测试样本

训练模型时一个非常常见的问题是**过度拟合**。当一个模型在我们用来训练它的数据上表现很好，但它不能很好地推广到新的、看不见的数据点时，就会出现这种现象。发生这种情况的原因有很多，可能是由于数据中的噪声，也可能是模型学会了预测特定的输入，而不是帮助它做出正确预测的预测参数。通常，模型越复杂，过度拟合的可能性就越大。

另一方面，**欠拟合**发生在模型表现不佳时，即使是在用于训练它的数据上。在大多数情况下，出现拟合不足是因为模型不适合您试图解决的问题。通常，这意味着模型没有学习那些可以被证明是可预测的参数所需的复杂。

为训练和测试模型创建不同的数据样本是可以用来识别这类问题的最常见的方法。通过这种方式，我们可以使用训练集来训练我们的模型，然后将测试集视为数据点的集合，这将帮助我们评估模型是否可以很好地推广到新的、未知的数据。

将建模数据集分为训练集和测试集的最简单方法是将 2/3 的数据点分配给前者，将剩余的三分之一分配给后者。因此，我们使用训练集训练模型，然后将模型应用于测试集。这样，我们可以评估我们的模型的性能。例如，如果训练精度非常高，而测试精度很差，那么这是模型可能过度拟合的良好指示。

请注意，将数据集分成训练集和测试集并不是避免过度拟合等现象所需的唯一操作。例如，如果训练集和测试集都包含现实世界数据中不存在的模式，那么模型的性能仍然会很差，即使我们无法从性能评估中观察到它。

第二点，你应该意识到在某些情况下你应该考虑创建一个额外的集合叫做**验证**集合。当除了模型性能之外，我们还需要在许多模型中进行选择并评估哪个模型性能更好时，通常需要验证集。

# 如何将数据集分成训练集和测试集

在这一节中，我们将探索创建训练集和测试集的三种不同方法。在开始这些方法之前，让我们创建一个虚拟数据集，用于演示目的。在下面的例子中，我们将假设我们有一个数据集作为 pandas 数据帧存储在内存中。虹膜数据集包含 150 个数据点，每个数据点有四个特征。

在下面的例子中，我们将假设我们需要 80:20 的训练:测试集比率。

## 使用熊猫

第一种选择是使用 pandas DataFrames 的方法`[sample()](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sample.html)`:

> 从一个对象轴中返回一个随机的项目样本。
> 
> 您可以使用 random_state 来获得再现性

我们最初通过从 pandas 数据帧的所有行中抽取分数为 0.8 的样本来创建训练集。注意，我们还定义了与种子相对应的`random_state`,这样结果是可重复的。随后，我们通过简单地从现在包含在训练集中的原始数据帧中删除相应的索引来创建测试集。

正如我们所看到的，训练集包含 120 个示例，这与我们在对原始建模数据帧进行采样时所要求的分数一致。剩余的 30 个例子被打包到测试集中。

## 使用 scikit-learn

第二种选择——也可能是最常用的——是使用`sklearn`的方法`[train_test_split()](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)`:

> 将阵列或矩阵拆分为随机训练和测试子集

我们可以通过将建模数据帧以及应该包括在测试集中的部分示例传递给`train_test_split()`，在一行中创建训练集和测试集。如前所述，我们还设置了一个`random_state`，以便结果是可再现的，也就是说，每次我们运行代码时，相同的实例将分别包括在训练集和测试集中。方法会传回包含两个资料框的 tuple，其中包含训练和测试范例。

## 使用 numpy

最后，一种不太常用的创建测试和训练样本的方法是使用`numpy`的方法`[randn()](https://numpy.org/doc/stable/reference/random/generated/numpy.random.randn.html)`:

> 从“标准正态”分布返回一个或多个样本。

我们首先创建`mask`，这是一个 numpy 数组，其中包含通过比较介于 0 和 1 之间的随机浮点数字与我们希望为训练集保留的分数计算的布尔值。随后，我们通过相应地过滤 DataFrame 来创建训练和测试样本。但是，请注意，这种方法将**近似为**给出 80:20 的比率，这意味着训练和测试样本中包含的示例数量不一定像本文前面讨论的两种方法那样准确。

## 下一步是什么？

现在，您已经从原始建模数据集创建了训练和测试集，您可能还需要执行进一步的预处理步骤，如缩放或归一化。这样做时必须小心，因为您需要避免将未来的信息引入到培训集中。这意味着某些动作需要首先应用于训练集，然后使用从该步骤中学习的参数，以便也将它们应用于测试集。有关此主题的更全面解释，请阅读下面的文章。

[](/feature-scaling-and-normalisation-in-a-nutshell-5319af86f89b) [## 简单地说，就是特征缩放和归一化

### 为什么、如何以及何时重新扩展功能

towardsdatascience.com](/feature-scaling-and-normalisation-in-a-nutshell-5319af86f89b) 

# 结论

在本文中，我们探讨了将初始建模数据集分成训练和测试样本的重要性。此外，我们讨论了这些集合如何帮助我们识别我们的模型是过拟合还是欠拟合。最后，我们已经看到了如何用 Python 和 pandas 以三种不同的方式实现这种分离；使用`pandas.sample()`、`sklearn.traing_test_split()`和`numpy.randn()`。