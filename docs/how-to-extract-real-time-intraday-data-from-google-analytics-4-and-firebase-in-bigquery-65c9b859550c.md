# å¦‚ä½•åœ¨ BigQuery ä¸­ä» Google Analytics 4 å’Œ Firebase ä¸­æå–å®æ—¶æ—¥å†…æ•°æ®

> åŸæ–‡ï¼š<https://towardsdatascience.com/how-to-extract-real-time-intraday-data-from-google-analytics-4-and-firebase-in-bigquery-65c9b859550c?source=collection_archive---------11----------------------->

## å¹¶å§‹ç»ˆä¸ºæ‚¨çš„è‡ªå®šä¹‰æŠ¥å‘Šæä¾›æœ€æ–°æ•°æ®

![](img/27309863c09318c15223f7748746ae50.png)

æ°è¥¿å¡Â·è·¯æ˜“æ–¯åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

å¦‚æœæ‚¨æ˜¯ä¸€å **Firebase** æˆ– **Google Analytics 4** ç”¨æˆ·ï¼Œå¹¶ä¸”æ‚¨å·²ç»å°†æ•°æ®å¯¼å…¥åˆ°æ‚¨çš„ [**BigQuery**](https://https://console.cloud.google.com/bigquery) æ•°æ®ä»“åº“ä¸­ï¼Œé‚£ä¹ˆæ‚¨å¯èƒ½æƒ³è¦åˆ›å»º*å®æ—¶*å®šåˆ¶æŠ¥å‘Šï¼Œå…¶ä¸­åŒ…å«æ‚¨åœ¨*æ—¥å†…*æ¨¡å¼ä¸­çš„æ•°æ®ã€‚é—®é¢˜æ˜¯ï¼Œè¿™ä¸ªæ•´åˆçš„æ•°æ®é›†æ¯å¤©éƒ½åœ¨è¢«è°·æ­Œè‡ªåŠ¨åˆ é™¤ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨é€‰æ‹©å°†å®ƒä½œä¸ºæ•°æ®æºè¿æ¥åˆ°æ‚¨åœ¨[**Google Data Studio**](https://datastudio.google.com)ä¸­çš„æŠ¥å‘Šï¼Œç¬¬äºŒå¤©æ‚¨å°†æ‰¾ä¸åˆ°å®ƒã€‚

![](img/875d81ff981d613e4293678714e00c10.png)

ä½œè€…å›¾ç‰‡[ğŸ’¡è¿ˆå…‹Â·æ²™å…‹éœç±³ç½—å¤«](https://medium.com/u/e06a48b3dd48?source=post_page-----65c9b859550c--------------------------------)

ä¾‹å¦‚ï¼Œæˆ‘æƒ³åœ¨æˆ‘ä»¬ç”¨ **Data Studio** æ„å»ºçš„ BI è§£å†³æ–¹æ¡ˆä¸­å¯¹*æ—¥å†…*è¡¨è¿›è¡Œå®æ—¶åˆ†æã€‚ç”±äºå®ƒç»å¸¸è¢«åˆ é™¤ï¼Œæˆ‘æ— æ³•å°†å®ƒä½œä¸ºæ•°æ®é›†è¿æ¥åˆ°è°·æ­Œæ•°æ®å·¥ä½œå®¤ã€‚æ­¤å¤–ï¼Œå½“å®ƒè¢«åˆ é™¤æ—¶ï¼Œå®ƒä¸å†æ˜¯ä¸€ä¸ªåˆ†åŒºè¡¨ï¼Œæ‚¨ä¸èƒ½ä½¿ç”¨*é€šé…ç¬¦*åç¼€è¿›è¡Œæ—¥æœŸæŸ¥è¯¢ã€‚

è¯´åˆ°è¿™é‡Œï¼Œæˆ‘éœ€è¦ä»¥ä¸‹å†…å®¹:

1.  **æ—¥å†…**è¡¨ä¸åº”è¯¥è‡ªåŠ¨åˆ é™¤ã€‚æˆ‘æƒ³æ‰‹åŠ¨æ“ä½œã€‚
2.  ç”±äºæ­¤ **Firebase** æ—¥å¸¸æ•°æ®å¯¼å‡º/é›†æˆåŠŸèƒ½çš„å­˜åœ¨ã€‚æˆ‘æƒ³é›†æˆæ•°æ®ä¼ è¾“å°†åœ¨ä¸€ä¸ªå°æ—¶å†…ä¿è¯ç¬¬äºŒå¤©äº¤ä»˜ã€‚

æˆ‘ç›¸ä¿¡è¿™æ˜¯ä¸€ä¸ªå¾ˆæ™®éçš„é—®é¢˜ã€‚

![](img/a47a78d02b7770c2b2b5148d8f348418.png)

ä½œè€…å›¾ç‰‡[ğŸ’¡è¿ˆå…‹Â·æ²™å…‹éœç±³ç½—å¤«](https://medium.com/u/e06a48b3dd48?source=post_page-----65c9b859550c--------------------------------)

æˆ‘å·²ç»å‘è°·æ­Œå·¥ç¨‹æå‡ºäº†[ä¸€ä¸ªåŠŸèƒ½è¯·æ±‚](https://issuetracker.google.com/issues/204248504)ï¼Œä»¥åœ¨éœ€è¦æ—¶å¯ç”¨æ‰‹åŠ¨åˆ é™¤ï¼Œä½†åœ¨å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼Œå®ƒä»åœ¨è¿›è¡Œä¸­*ã€‚*

> **â€œæ—¥å†…è¡¨ä¸åº”è¯¥è‡ªåŠ¨åˆ é™¤ã€‚æˆ‘ä»¬å¸Œæœ›æ‰‹åŠ¨æ“ä½œã€‚â€**

**è™½ç„¶è¿™å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ã€‚å› æ­¤ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥å…‹æœè¿™ä¸ªé—®é¢˜ã€‚**

# *å¦‚ä½•ä»æ—¥å†…è¡¨ä¸­æå–æ•°æ®*

> **ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨ä¼šå¸Œæœ›è¿è¡Œä¸€ä¸ªè°ƒåº¦è„šæœ¬ï¼Œå…¶ä¸­å‚æ•°æ˜¯å½“å¤©è¡¨æ ¼çš„æ—¥æœŸåç¼€ã€‚**

> **ç„¶è€Œäº‹æƒ…æ²¡é‚£ä¹ˆç®€å•â€¦â€¦**

# *æ—¥å†…è¡¨è¢«è‡ªåŠ¨åˆ é™¤*

*æ‰€ä»¥ä½ ä¸çŸ¥é“å®‰æ’å‰§æœ¬çš„ç¡®åˆ‡æ—¶é—´ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ **daily** export è¡¨ï¼Œä½†æ˜¯åŒæ ·ï¼Œæ‚¨å¿…é¡»ç­‰åˆ°æå–å‡†å¤‡å°±ç»ªã€‚æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾å…³äºæ—¥å†…è¡¨åˆ é™¤æ—¶é—´çš„ä¿¡æ¯ï¼Œæˆ‘å‘ç°è¿‡å»ä¸€å¤©çš„æ—¥å†…è¡¨å¯èƒ½è¿˜å­˜åœ¨å‡ ä¸ªå°æ—¶ã€‚åŸå› ä¹‹ä¸€æ˜¯å¤„ç†å¤§é‡æ•°æ®éœ€è¦æ›´å¤šæ—¶é—´ [Stackoverflow](https://stackoverflow.com/questions/60796741/intraday-table-for-firebase-analytics-in-bigquery) ã€‚å› æ­¤ï¼Œåˆ é™¤è¿‡å»çš„è¡¨æ²¡æœ‰å›ºå®šçš„æ—¶é—´ï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼Œå®ƒåœ¨æ–°çš„ä¸€å¤©ä¹‹åçš„å‡ ä¸ªå°æ—¶å†…ä»ç„¶å­˜åœ¨ã€‚æ‚¨åœ¨ GA ä¸­è®¾ç½®çš„æ—¶åŒºä¹Ÿä¼šå¯¹æ­¤äº§ç”Ÿå½±å“ã€‚*

# *æ— æ³•åœ¨ BigQuery è„šæœ¬ä¸­ä½¿ç”¨è¡¨åå‚æ•°ã€‚*

***BigQuery è„šæœ¬**æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†ç›®å‰(2021â€“11â€“20)è°·æ­Œçš„ **BigQuery** è„šæœ¬ä¸èƒ½ä½¿ç”¨è¡¨åå‚æ•°ã€‚æ ¹æ® BigQuery æ–‡æ¡£ä¸­çš„å‚æ•°åŒ–æŸ¥è¯¢]5ï¼ŒæŸ¥è¯¢å‚æ•°ä¸èƒ½ç”¨äº SQL å¯¹è±¡æ ‡è¯†ç¬¦*

> **å‚æ•°ä¸èƒ½æ›¿ä»£æ ‡è¯†ç¬¦ã€åˆ—åã€è¡¨åæˆ–æŸ¥è¯¢çš„å…¶ä»–éƒ¨åˆ†ã€‚**

# *ç¬¬ä¸€æ­¥ã€‚æ£€æŸ¥åŸå§‹æ—¥å†…è¡¨æ˜¯å¦å­˜åœ¨*

*å¦‚æœæ•°æ®å­˜åœ¨ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä½¿ç”¨æ­¤è„šæœ¬è¿”å›`true`:*

# *ç¬¬äºŒæ­¥ã€‚åˆ›å»ºä¸€ä¸ª BigQuery SQL è„šæœ¬(å¦‚æœå­˜åœ¨ï¼Œæ‰§è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚æ’å…¥)*

*ç„¶åï¼Œå°†æ‰§è¡Œæ›´æ–°çš„è„šæœ¬æ·»åŠ åˆ°æ‚¨çš„ç¨‹åºä¸­:*

# *ç¬¬ä¸‰æ­¥ã€‚å†³å®šå¦‚ä½•å¤„ç†æ–°çš„æ—¥å†…è¡¨å‰¯æœ¬çš„ INSERT è¯­å¥*

*æ‚¨å¯ä»¥:*

*   *ç”¨æ–°æ•°æ®æ›¿æ¢æ•´ä¸ªè¡¨*
*   *ä»…ä¸ºæ‰€é€‰åˆ—æ·»åŠ æ–°è®°å½•*

# *å¤åˆ¶å’Œæ›¿æ¢å½“å¤©äº‹ä»¶è¡¨*

*è¿™ä¸ªè„šæœ¬å°†å¤åˆ¶æ•´ä¸ªè¡¨:*

*æ‚¨å¯èƒ½å¸Œæœ›ä½¿ç”¨ä¸**å¤åˆ¶å’Œæ›¿æ¢æ—¥å†…äº‹ä»¶è¡¨**ç›¸åŒçš„ SQL è„šæœ¬ï¼Œä½†æ˜¯å°†**å¤åˆ¶å’Œæ›¿æ¢æŸ¥è¯¢**æ›´æ”¹ä¸º**é€‰æ‹©å’Œæ’å…¥æŸ¥è¯¢**ã€‚è®©æˆ‘ä»¬åˆ›å»ºè¿™ä¸ªè„šæœ¬æ¥å®Œæˆä»¥ä¸‹ä»»åŠ¡:*

## ***è§£å†³æ–¹æ¡ˆ:***

# *ç»“è®º*

****æ—¥å†…*** è¡¨ä¸ ***æ—¥å†…*** ä¼šè¯è¡¨ç›¸æ¯”å¯èƒ½ä¼šæœ‰ç»†å¾®çš„å·®å¼‚ï¼Œä½†æ‚¨æ— éœ€ç­‰å¾…ã€‚è¿™äº›å·®å¼‚æ˜¯ç”±ä»¥ä¸‹åŸå› é€ æˆçš„:*

*   *Google Analytics å…è®¸æœ€å¤šæ™šå‘é€å››ä¸ªå°æ—¶çš„ç‚¹å‡»ï¼Œåœ¨è¯·æ±‚æ•°æ®æ—¶ï¼Œè¿™äº›ç‚¹å‡»å¯èƒ½åœ¨å½“å¤©çš„è¡¨ä¸­ä¸å¯ç”¨ã€‚*
*   *Google åœ¨æ”¶é›†ç‚¹å‡»é‡ä¹‹åå’Œå°†æ•°æ®å¯¼å‡ºåˆ° BigQuery ä¹‹å‰æ‰§è¡Œä¸€äº›æ•°æ®å¤„ç†ã€‚ä¸€èˆ¬å—å½±å“çš„é¢†åŸŸæ˜¯æµé‡æ¥æºå’Œé“¾æ¥çš„è¥é”€äº§å“(AdWordsï¼ŒCampaign Manager ç­‰ã€‚)*

*ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœè¿™äº›å­—æ®µå¯¹æ‚¨çš„æ•°æ®å †æ ˆæ²¡æœ‰ä»»ä½•å½±å“ï¼Œè¿™æ˜¯é€šè¿‡ä¸ **Firebase** æˆ– ***Google Analytics 4*** é›†æˆæ¥æé«˜**æ•°æ®*å¯ç”¨æ€§*** çš„è§£å†³æ–¹æ¡ˆã€‚*

# *èµ„æº*

*[1]:[https://stack overflow . com/questions/60796741/intraday-table-for-firebase-analytics-in-big query](https://stackoverflow.com/questions/60796741/intraday-table-for-firebase-analytics-in-bigquery)*

*[2]:[https://https://console . cloud . Google . com/big query](https://https://console.cloud.google.com/bigquery)*

*[3]:[https://datastudio.google.com](https://datastudio.google.com)*

*[4]:[https://stack overflow . com/questions/59372469/create-table-using-a-variable-name-in-the-big query-ui](https://stackoverflow.com/questions/59372469/create-table-using-a-variable-name-in-the-bigquery-ui)*

*[5]:[https://cloud . Google . com/big query/docs/parameterized-queries # big query _ query _ params _ named-web](https://cloud.google.com/bigquery/docs/parameterized-queries#bigquery_query_params_named-web)*

**åŸè½½äºã€https://mydataschool.comã€‘[](https://mydataschool.com/blog/how-to-extract-real-time-intraday-data-in-firebase-and-bigquery/)**ã€‚****