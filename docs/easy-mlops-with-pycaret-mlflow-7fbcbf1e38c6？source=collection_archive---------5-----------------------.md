# ä½¿ç”¨ PyCaret + MLflow è½»æ¾å®ç° MLOps

> åŸæ–‡ï¼š<https://towardsdatascience.com/easy-mlops-with-pycaret-mlflow-7fbcbf1e38c6?source=collection_archive---------5----------------------->

## ä¸€ä¸ªåˆå­¦è€…å‹å¥½çš„ï¼Œä¸€æ­¥ä¸€æ­¥çš„æ•™ç¨‹ï¼Œä½¿ç”¨ PyCaret åœ¨ä½ çš„æœºå™¨å­¦ä¹ å®éªŒä¸­é›†æˆ MLOps

![](img/b59ab9fb0c0082f4edff78fac49d6734.png)

é˜¿è¿ªÂ·æˆˆå°”èŒ¨å¦åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

# PyCaret

PyCaret æ˜¯ä¸€ä¸ªå¼€æºçš„ä½ä»£ç æœºå™¨å­¦ä¹ åº“å’Œç«¯åˆ°ç«¯çš„æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå†…ç½®äº Python ä¸­ï¼Œç”¨äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚å®ƒä»¥å…¶æ˜“ç”¨æ€§ã€ç®€å•æ€§ä»¥åŠå¿«é€Ÿé«˜æ•ˆåœ°æ„å»ºå’Œéƒ¨ç½²ç«¯åˆ°ç«¯ ML åŸå‹çš„èƒ½åŠ›è€Œé—»åã€‚

PyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨å‡ è¡Œä»£ç ä»£æ›¿æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå‘¨æœŸæˆå€åœ°å¿«é€Ÿå’Œæœ‰æ•ˆã€‚

![](img/206f6e936ee58e81e11036edcf925ea7.png)

py caretâ€”â€”Python ä¸­çš„å¼€æºã€ä½ä»£ç æœºå™¨å­¦ä¹ åº“

è¦äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹ä»–ä»¬çš„ [GitHub](https://www.github.com/pycaret/pycaret) ã€‚

# MLflow

MLflow æ˜¯ä¸€ä¸ªç®¡ç† ML ç”Ÿå‘½å‘¨æœŸçš„å¼€æºå¹³å°ï¼ŒåŒ…æ‹¬å®éªŒã€å¯å¤åˆ¶æ€§ã€éƒ¨ç½²å’Œä¸­å¤®æ¨¡å‹æ³¨å†Œã€‚MLflow ç›®å‰æä¾›å››ä¸ªç»„ä»¶:

![](img/868ee3a08bb659a0034a04c4d1b945d6.png)

MLflow æ˜¯ä¸€ä¸ªç®¡ç† ML ç”Ÿå‘½å‘¨æœŸçš„å¼€æºå¹³å°

è¦äº†è§£æ›´å¤šå…³äº MLflow çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹ [GitHub](https://github.com/mlflow/mlflow) ã€‚

# æ­£åœ¨å®‰è£… PyCaret

å®‰è£… PyCaret éå¸¸å®¹æ˜“ï¼Œåªéœ€è¦å‡ åˆ†é’Ÿã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒæ¥é¿å…ä¸å…¶ä»–åº“çš„æ½œåœ¨å†²çªã€‚

PyCaret çš„é»˜è®¤å®‰è£…æ˜¯ pycaret çš„ç²¾ç®€ç‰ˆæœ¬ï¼Œåªå®‰è£…è¿™é‡Œåˆ—å‡ºçš„ç¡¬ä¾èµ–é¡¹ã€‚

```
**# install slim version (default)** pip install pycaret**# install the full version**
pip install pycaret[full]
```

å½“æ‚¨å®‰è£… pycaret çš„å®Œæ•´ç‰ˆæœ¬æ—¶ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ‰€æœ‰å¯é€‰ä¾èµ–é¡¹[ä¹Ÿä¼šè¢«å®‰è£…ã€‚MLflow æ˜¯ PyCaret ä¾èµ–é¡¹çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ä¸éœ€è¦å•ç‹¬å®‰è£…ã€‚](https://github.com/pycaret/pycaret/blob/master/requirements-optional.txt)

# ğŸ‘‰æˆ‘ä»¬å¼€å§‹å§

åœ¨æˆ‘è°ˆè®º MLOps ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä»è¾ƒé«˜çš„å±‚é¢æ¥è°ˆä¸€è°ˆæœºå™¨å­¦ä¹ ç”Ÿå‘½å‘¨æœŸ:

![](img/872b1027e874732992b79446404c702f.png)

æœºå™¨å­¦ä¹ ç”Ÿå‘½å‘¨æœŸ-æŒ‰ä½œè€…åˆ†ç±»çš„å›¾ç‰‡(ä»å·¦è‡³å³é˜…è¯»)

*   **ä¸šåŠ¡é—®é¢˜â€”** è¿™æ˜¯æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹çš„ç¬¬ä¸€æ­¥ã€‚è¿™å¯èƒ½éœ€è¦å‡ å¤©åˆ°å‡ å‘¨çš„æ—¶é—´æ¥å®Œæˆï¼Œè¿™å–å†³äºç”¨ä¾‹ä»¥åŠé—®é¢˜çš„å¤æ‚æ€§ã€‚æ­£æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ•°æ®ç§‘å­¦å®¶ä¸ä¸»é¢˜ä¸“å®¶(SME)ä¼šé¢ï¼Œä»¥äº†è§£é—®é¢˜ï¼Œé‡‡è®¿å…³é”®åˆ©ç›Šç›¸å…³è€…ï¼Œæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è®¾å®šé¡¹ç›®çš„æ€»ä½“é¢„æœŸã€‚
*   **æ•°æ®æ¥æº& ETL â€”** ä¸€æ—¦ç†è§£äº†é—®é¢˜ï¼Œæ¥ä¸‹æ¥å°±è¦ä½¿ç”¨è®¿è°ˆä¸­è·å¾—çš„ä¿¡æ¯ä»ä¼ä¸šæ•°æ®åº“ä¸­è·å–æ•°æ®ã€‚
*   **æ¢ç´¢æ€§æ•°æ®åˆ†æ(EDA)â€”â€”**å»ºæ¨¡è¿˜æ²¡å¼€å§‹ã€‚EDA æ˜¯åˆ†æåŸå§‹æ•°æ®çš„åœ°æ–¹ã€‚æ‚¨çš„ç›®æ ‡æ˜¯æ¢ç´¢æ•°æ®å¹¶è¯„ä¼°æ•°æ®è´¨é‡ã€ç¼ºå¤±å€¼ã€ç‰¹å¾åˆ†å¸ƒã€ç›¸å…³æ€§ç­‰ã€‚
*   **æ•°æ®å‡†å¤‡â€”** ç°åœ¨è¯¥å‡†å¤‡æ•°æ®æ¨¡å‹åŸ¹è®­äº†ã€‚è¿™åŒ…æ‹¬å°†æ•°æ®åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€è¾“å…¥ç¼ºå¤±å€¼ã€ä¸€é”®ç¼–ç ã€ç›®æ ‡ç¼–ç ã€ç‰¹å¾å·¥ç¨‹ã€ç‰¹å¾é€‰æ‹©ç­‰ã€‚
*   **æ¨¡ç‰¹åŸ¹è®­&é€‰æ‹”â€”** è¿™æ˜¯æ¯ä¸ªäººéƒ½ä¸ºä¹‹å…´å¥‹çš„ä¸€æ­¥ã€‚è¿™åŒ…æ‹¬è®­ç»ƒä¸€ç³»åˆ—æ¨¡å‹ã€è°ƒæ•´è¶…å‚æ•°ã€æ¨¡å‹é›†åˆã€è¯„ä¼°æ€§èƒ½æŒ‡æ ‡ã€æ¨¡å‹åˆ†æ(å¦‚ AUCã€æ··æ·†çŸ©é˜µã€æ®‹å·®ç­‰),ä»¥åŠæœ€ç»ˆé€‰æ‹©ä¸€ä¸ªæœ€ä½³æ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ä»¥ä¾›ä¸šåŠ¡ä½¿ç”¨ã€‚
*   **éƒ¨ç½²&ç›‘æ§â€”** è¿™æ˜¯æœ€åä¸€æ­¥ï¼Œä¸»è¦æ˜¯å…³äº MLOpsã€‚è¿™åŒ…æ‹¬æ‰“åŒ…æ‚¨çš„æœ€ç»ˆæ¨¡å‹ã€åˆ›å»º docker æ˜ åƒã€ç¼–å†™è¯„åˆ†è„šæœ¬ï¼Œç„¶åè®©å®ƒä»¬ä¸€èµ·å·¥ä½œï¼Œæœ€åå°†å…¶å‘å¸ƒä¸º APIï¼Œå¯ç”¨äºè·å¾—å¯¹é€šè¿‡ç®¡é“ä¼ è¾“çš„æ–°æ•°æ®çš„é¢„æµ‹ã€‚

æ—§çš„æ–¹æ³•éå¸¸éº»çƒ¦ã€å†—é•¿ï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„æŠ€æœ¯çŸ¥è¯†ï¼Œæˆ‘å¯èƒ½æ— æ³•åœ¨ä¸€ä¸ªæ•™ç¨‹ä¸­æ¶µç›–å®ƒã€‚ç„¶è€Œï¼Œåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ PyCaret æ¥æ¼”ç¤ºå¯¹äºä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶æ¥è¯´ï¼Œéå¸¸é«˜æ•ˆåœ°å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œæ˜¯å¤šä¹ˆå®¹æ˜“ã€‚åœ¨æˆ‘ä»¬è¿›å…¥å®é™…éƒ¨åˆ†ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å†å¤šè°ˆä¸€ç‚¹å…³äº MLOps çš„å†…å®¹ã€‚

# ğŸ‘‰**ä»€ä¹ˆæ˜¯ MLOpsï¼Ÿ**

MLOps æ˜¯ä¸€é—¨å·¥ç¨‹å­¦ç§‘ï¼Œæ—¨åœ¨ç»“åˆæœºå™¨å­¦ä¹ å¼€å‘ï¼Œå³å®éªŒ(æ¨¡å‹è®­ç»ƒã€è¶…å‚æ•°è°ƒæ•´ã€æ¨¡å‹é›†æˆã€æ¨¡å‹é€‰æ‹©ç­‰)ã€‚)ï¼Œé€šå¸¸ç”± ML å·¥ç¨‹å’Œè¿è¥éƒ¨é—¨çš„æ•°æ®ç§‘å­¦å®¶æ‰§è¡Œï¼Œä»¥ä¾¿æ ‡å‡†åŒ–å’Œç®€åŒ–ç”Ÿäº§ä¸­æœºå™¨å­¦ä¹ æ¨¡å‹çš„æŒç»­äº¤ä»˜ã€‚

å¦‚æœä½ æ˜¯ä¸€ä¸ªç»å¯¹çš„åˆå­¦è€…ï¼Œä½ å¯èƒ½ä¸çŸ¥é“æˆ‘åœ¨è¯´ä»€ä¹ˆã€‚åˆ«æ‹…å¿ƒã€‚è®©æˆ‘ç»™ä½ ä¸€ä¸ªç®€å•çš„ã€éæŠ€æœ¯æ€§çš„å®šä¹‰:

> *mlop æ˜¯ä¸€ç³»åˆ—æŠ€æœ¯å·¥ç¨‹å’Œè¿è¥ä»»åŠ¡ï¼Œå…è®¸æ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹è¢«ç»„ç»‡ä¸­çš„å…¶ä»–ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºä½¿ç”¨ã€‚åŸºæœ¬ä¸Šï¼Œè¿™æ˜¯ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ çš„å·¥ä½œï¼Œå³*æœºå™¨å­¦ä¹ æ¨¡å‹*è¢«åœ¨çº¿å‘å¸ƒï¼Œå› æ­¤å…¶ä»–äººå¯ä»¥ä½¿ç”¨å®ƒä»¬å¹¶æ»¡è¶³ä¸€äº›å•†ä¸šç›®æ ‡ã€‚*

è¿™æ˜¯ä¸€ä¸ªéå¸¸ä½è°ƒçš„å®šä¹‰ã€‚å®é™…ä¸Šï¼Œå®ƒæ¶‰åŠçš„å·¥ä½œå’Œåˆ©ç›Šæ¯”è¿™å¤šä¸€ç‚¹ï¼Œä½†å¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ã€‚

ç°åœ¨è®©æˆ‘ä»¬æŒ‰ç…§ä¸Šå›¾æ‰€ç¤ºçš„å·¥ä½œæµç¨‹åšä¸€ä¸ªå®é™…çš„æ¼”ç¤ºï¼Œç¡®ä¿ä½ å·²ç»å®‰è£…äº† pycaretã€‚

# ğŸ‘‰å•†ä¸šé—®é¢˜

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨è¾¾é¡¿å•†å­¦é™¢å‘è¡¨åœ¨[å“ˆä½›å•†ä¸š](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ä¸Šçš„ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„æ¡ˆä¾‹ç ”ç©¶ã€‚è¿™ä¸ªæ¡ˆå­æ˜¯å…³äºä¸¤ä¸ªæœªæ¥å°†è¦ç»“å©šçš„äººçš„æ•…äº‹ã€‚åå«*æ ¼é›·æ ¼*çš„å®¶ä¼™æƒ³ä¹°ä¸€æšæˆ’æŒ‡å‘åå«*èæ‹‰*çš„å¥³å­©æ±‚å©šã€‚é—®é¢˜æ˜¯æ‰¾åˆ°èæ‹‰ä¼šå–œæ¬¢çš„æˆ’æŒ‡ï¼Œä½†åœ¨ä»–çš„å¯†å‹å»ºè®®åï¼Œæ ¼é›·æ ¼å†³å®šä¹°ä¸€é¢—é’»çŸ³ï¼Œè¿™æ ·èæ‹‰å°±å¯ä»¥å†³å®šå¥¹çš„é€‰æ‹©ã€‚ç„¶åï¼Œæ ¼é›·æ ¼æ”¶é›†äº† 6000 é¢—é’»çŸ³çš„ä»·æ ¼å’Œåˆ‡å‰²ã€é¢œè‰²ã€å½¢çŠ¶ç­‰å±æ€§æ•°æ®ã€‚

# ğŸ‘‰æ•°æ®

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€ä¸ªæ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†æ¥è‡ªè¾¾é¡¿å•†å­¦é™¢çš„ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„æ¡ˆä¾‹ç ”ç©¶ï¼Œå‘è¡¨åœ¨[å“ˆä½›å•†ä¸š](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ä¸Šã€‚æœ¬æ•™ç¨‹çš„ç›®æ ‡æ˜¯æ ¹æ®é’»çŸ³çš„é‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ç­‰å±æ€§æ¥é¢„æµ‹é’»çŸ³çš„ä»·æ ¼ã€‚æ‚¨å¯ä»¥ä» [PyCaret çš„å­˜å‚¨åº“](https://github.com/pycaret/pycaret/tree/master/datasets)ä¸‹è½½æ•°æ®é›†ã€‚

```
**# load the dataset from pycaret** from pycaret.datasets import get_data
data = get_data('diamond')
```

![](img/069a134f69d768fe9f2ee1bafb93ab5b.png)

æ•°æ®ä¸­çš„æ ·æœ¬è¡Œ

# ğŸ‘‰æ¢ç´¢æ€§æ•°æ®åˆ†æ

è®©æˆ‘ä»¬åšä¸€äº›å¿«é€Ÿå¯è§†åŒ–æ¥è¯„ä¼°ç‹¬ç«‹ç‰¹å¾(é‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ã€å‡€åº¦ç­‰)ä¹‹é—´çš„å…³ç³»ã€‚)ä¸ç›®æ ‡å˜é‡å³`Price`

```
**# plot scatter carat_weight and Price**
import plotly.express as px
fig = px.scatter(x=data['Carat Weight'], y=data['Price'], 
                 facet_col = data['Cut'], opacity = 0.25, template = 'plotly_dark', trendline='ols',
                 trendline_color_override = 'red', title = 'SARAH GETS A DIAMOND - A CASE STUDY')
fig.show()
```

![](img/5804ec6c03d897edfdd4134dd14edf41.png)

èæ‹‰å¾—åˆ°äº†ä¸€ä»½é’»çŸ³æ¡ˆä¾‹ç ”ç©¶

è®©æˆ‘ä»¬æ£€æŸ¥ç›®æ ‡å˜é‡çš„åˆ†å¸ƒã€‚

```
**# plot histogram**
fig = px.histogram(data, x=["Price"], template = 'plotly_dark', title = 'Histogram of Price')
fig.show()
```

![](img/f08030a9182c918e839238d3917f8105.png)

è¯·æ³¨æ„ï¼Œ`Price`çš„åˆ†å¸ƒæ˜¯å³åçš„ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€ŸæŸ¥çœ‹å¯¹æ•°å˜æ¢æ˜¯å¦å¯ä»¥ä½¿`Price`æ¥è¿‘æ­£æ€ï¼Œä»è€Œç»™å‡è®¾æ­£æ€çš„ç®—æ³•ä¸€ä¸ªæœºä¼šã€‚

```
import numpy as np**# create a copy of data**
data_copy = data.copy()**# create a new feature Log_Price**
data_copy['Log_Price'] = np.log(data['Price'])**# plot histogram**
fig = px.histogram(data_copy, x=["Log_Price"], title = 'Histgram of Log Price', template = 'plotly_dark')
fig.show()
```

![](img/2dc0dec4c8c13e307328cee992a1163d.png)

è¿™è¯å®äº†æˆ‘ä»¬çš„å‡è®¾ã€‚è¿™ç§è½¬æ¢å°†å¸®åŠ©æˆ‘ä»¬æ‘†è„±åæ€ï¼Œä½¿ç›®æ ‡å˜é‡æ¥è¿‘æ­£æ€ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬å°†åœ¨è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ä¹‹å‰è½¬æ¢`Price`å˜é‡ã€‚

# ğŸ‘‰æ•°æ®å‡†å¤‡

å¯¹äº PyCaret ä¸­çš„æ‰€æœ‰æ¨¡å—æ¥è¯´ï¼Œ`setup`æ˜¯ä»»ä½•ä½¿ç”¨ PyCaret çš„æœºå™¨å­¦ä¹ å®éªŒä¸­çš„ç¬¬ä¸€æ­¥ï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¸€æ­¥ã€‚è¯¥åŠŸèƒ½è´Ÿè´£è®­ç»ƒæ¨¡å‹ä¹‹å‰æ‰€éœ€çš„æ‰€æœ‰æ•°æ®å‡†å¤‡ã€‚é™¤äº†æ‰§è¡Œä¸€äº›åŸºæœ¬çš„é»˜è®¤å¤„ç†ä»»åŠ¡ï¼ŒPyCaret è¿˜æä¾›äº†ä¸€ç³»åˆ—é¢„å¤„ç†åŠŸèƒ½ã€‚è¦äº†è§£ PyCaret ä¸­æ‰€æœ‰é¢„å¤„ç†åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¿™ä¸ª[é“¾æ¥](https://pycaret.org/preprocessing/)ã€‚

```
**# initialize setup**
from pycaret.regression import *
s = setup(data, target = 'Price', transform_target = True, log_experiment = True, experiment_name = 'diamond')
```

![](img/b931e3f6e626893b6189f6920afb3340.png)

pycaret.regression æ¨¡å—ä¸­çš„è®¾ç½®å‡½æ•°

å½“æ‚¨åœ¨ PyCaret ä¸­åˆå§‹åŒ–`setup`å‡½æ•°æ—¶ï¼Œå®ƒä¼šåˆ†ææ•°æ®é›†å¹¶æ¨æ–­æ‰€æœ‰è¾“å…¥è¦ç´ çš„æ•°æ®ç±»å‹ã€‚å¦‚æœæ‰€æœ‰æ•°æ®ç±»å‹éƒ½æ¨æ–­æ­£ç¡®ï¼Œæ‚¨å¯ä»¥æŒ‰ enter é”®ç»§ç»­ã€‚

è¯·æ³¨æ„:

*   æˆ‘å·²ç»é€šè¿‡äº†`log_experiment = True`å’Œ`experiment_name = 'diamond'`ï¼Œè¿™å°†å‘Šè¯‰ PyCaret åœ¨å»ºæ¨¡é˜¶æ®µè‡ªåŠ¨è®°å½•æ‰€æœ‰çš„åº¦é‡ã€è¶…å‚æ•°å’Œæ¨¡å‹å·¥ä»¶ã€‚ç”±äºä¸ [MLflow](https://www.mlflow.org) çš„é›†æˆï¼Œè¿™æ˜¯å¯èƒ½çš„ã€‚
*   è¿˜æœ‰ï¼Œæˆ‘åœ¨`setup`é‡Œé¢ç”¨è¿‡`transform_target = True`ã€‚PyCaret å°†ä½¿ç”¨ box-cox å˜æ¢åœ¨åå°è½¬æ¢`Price`å˜é‡ã€‚å®ƒä»¥ç±»ä¼¼äºæ—¥å¿—è½¬æ¢*(æŠ€æœ¯ä¸Šä¸åŒ)*çš„æ–¹å¼å½±å“æ•°æ®çš„åˆ†å¸ƒã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº box-cox å˜æ¢çš„çŸ¥è¯†ï¼Œä½ å¯ä»¥å‚è€ƒè¿™ä¸ª[é“¾æ¥](https://onlinestatbook.com/2/transformations/box-cox.html)ã€‚

![](img/a0316354dc30940eae55deda6972a555.png)

è®¾ç½®çš„è¾“å‡ºâ€”ä¸ºæ˜¾ç¤ºè€Œæˆªæ–­

# ğŸ‘‰æ¨¡å‹è®­ç»ƒå’Œé€‰æ‹©

ç°åœ¨æ•°æ®å·²ç»å‡†å¤‡å¥½è¿›è¡Œå»ºæ¨¡ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`compare_models`å‡½æ•°å¼€å§‹è®­ç»ƒè¿‡ç¨‹ã€‚å®ƒå°†è®­ç»ƒæ¨¡å‹åº“ä¸­æ‰€æœ‰å¯ç”¨çš„ç®—æ³•ï¼Œå¹¶ä½¿ç”¨ k-fold äº¤å‰éªŒè¯è¯„ä¼°å¤šä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚

```
**# compare all models**
best = compare_models()
```

![](img/94ba47b57a471acde990033d3d742460.png)

compare_models çš„è¾“å‡º

```
**# check the residuals of trained model**
plot_model(best, plot = 'residuals_interactive')
```

![](img/cb577612be227f11ba1f9a152aa377e2.png)

æœ€ä½³æ¨¡å‹çš„æ®‹å·®å’Œ QQ å›¾

```
**# check feature importance**
plot_model(best, plot = 'feature')
```

![](img/0207b7dc96aebe32cd5f3545191692bd.png)

## å®Œæˆå¹¶ä¿å­˜ç®¡é“

ç°åœ¨è®©æˆ‘ä»¬æœ€ç»ˆç¡®å®šæœ€ä½³æ¨¡å‹ï¼Œå³åœ¨åŒ…æ‹¬æµ‹è¯•é›†åœ¨å†…çš„æ•´ä¸ªæ•°æ®é›†ä¸Šè®­ç»ƒæœ€ä½³æ¨¡å‹ï¼Œç„¶åå°†ç®¡é“ä¿å­˜ä¸º pickle æ–‡ä»¶ã€‚

```
**# finalize the model**
final_best = finalize_model(best)**# save model to disk** save_model(final_best, 'diamond-pipeline')
```

`save_model`å‡½æ•°å°†æŠŠæ•´ä¸ªç®¡é“(åŒ…æ‹¬æ¨¡å‹)ä¿å­˜ä¸ºæœ¬åœ°ç£ç›˜ä¸Šçš„ pickle æ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼šå°†æ–‡ä»¶ä¿å­˜åœ¨ç¬”è®°æœ¬æˆ–è„šæœ¬æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­ï¼Œä½†æ˜¯å¦‚æœæ‚¨æ„¿æ„ï¼Œä¹Ÿå¯ä»¥ä¼ é€’å®Œæ•´çš„è·¯å¾„:

```
save_model(final_best, 'c:/users/moez/models/diamond-pipeline'
```

# ğŸ‘‰éƒ¨ç½²

è®°å¾—æˆ‘ä»¬åœ¨è®¾ç½®å‡½æ•°ä¸­é€šè¿‡äº†`log_experiment = True`å’Œ`experiment_name = 'diamond'`ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ PyCaret åœ¨ MLflow çš„å¸®åŠ©ä¸‹åœ¨å¹•åå®ç°äº†ä»€ä¹ˆã€‚è®©æˆ‘ä»¬å¯åŠ¨ MLflow æœåŠ¡å™¨æ¥çœ‹çœ‹è¿™ä¸ªç¥å¥‡çš„è¿‡ç¨‹:

```
**# within notebook (notice ! sign infront)** !mlflow ui**# on command line in the same folder** mlflow ui
```

ç°åœ¨æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥â€œlocalhost:5000â€ã€‚å®ƒå°†æ‰“å¼€è¿™æ ·ä¸€ä¸ªç”¨æˆ·ç•Œé¢:

![](img/99da29b10c4dd93f69b2d9f5bd3442d5.png)

https://æœ¬åœ°ä¸»æœº:5000

ä¸Šè¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®ä»£è¡¨ä¸€ä¸ªè®­ç»ƒè¿è¡Œï¼Œè¯¥è¿è¡Œäº§ç”Ÿä¸€ä¸ªè®­ç»ƒç®¡é“å’Œä¸€å †å…ƒæ•°æ®ï¼Œä¾‹å¦‚è¿è¡Œçš„æ—¥æœŸæ—¶é—´ã€æ€§èƒ½åº¦é‡ã€æ¨¡å‹è¶…å‚æ•°ã€æ ‡ç­¾ç­‰ã€‚è®©æˆ‘ä»¬ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªæ¨¡å‹:

![](img/cd218c01aadd20b5841b68a0d620e972.png)

ç¬¬ä¸€éƒ¨åˆ†â€” CatBoost å›å½’å™¨

![](img/7acc1b4af046ae6133a998b743f3b842.png)

ç¬¬äºŒéƒ¨åˆ†â€” CatBoost å›å½’å™¨(ç»­)

![](img/cab67d822585402ab3197f20aad21619.png)

ç¬¬äºŒéƒ¨åˆ†â€” CatBoost å›å½’å™¨(ç»­)

æ³¨æ„ï¼Œæ‚¨æœ‰ä¸€ä¸ª`logged_model`çš„åœ°å€è·¯å¾„ã€‚è¿™æ˜¯å¸¦æœ‰ Catboost å›å½’å™¨çš„è®­ç»ƒç®¡é“ã€‚æ‚¨å¯ä»¥ä½¿ç”¨`load_model`å‡½æ•°è¯»å–è¿™ä¸ªç®¡é“ã€‚

```
**# load model**
from pycaret.regression import load_model
pipeline = load_model('C:/Users/moezs/mlruns/1/b8c10d259b294b28a3e233a9d2c209c0/artifacts/model/model')**# print pipeline** print(pipeline)
```

![](img/0c51286b76fd7a7e9b939f2854762c45.png)

æ‰“å°è¾“å‡º(ç®¡é“)

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç®¡é“æ¥ç”Ÿæˆå¯¹æ–°æ•°æ®çš„é¢„æµ‹

```
**# create a copy of data and drop Price** data2 = data.copy()
data2.drop('Price', axis=1, inplace=True)**# generate predictions** from pycaret.regression import predict_model
predictions = predict_model(pipeline, data=data2)
predictions.head()
```

![](img/99c5391494e00f418432d8640d6d5896.png)

ä»ç®¡é“ç”Ÿæˆçš„é¢„æµ‹

å‘œå“‡ï¼æˆ‘ä»¬ç°åœ¨ä»è®­ç»ƒæœ‰ç´ çš„ç®¡é“ä¸­å¾—åˆ°æ¨è®ºã€‚æ­å–œï¼Œå¦‚æœè¿™æ˜¯ä½ çš„ç¬¬ä¸€æ¬¡ã€‚è¯·æ³¨æ„ï¼Œæ‰€æœ‰è½¬æ¢ï¼Œå¦‚ç›®æ ‡è½¬æ¢ã€ä¸€é”®ç¼–ç ã€ç¼ºå¤±å€¼æ’è¡¥ç­‰ã€‚è‡ªåŠ¨åœ¨å¹•åå‘ç”Ÿã€‚ä½ å¾—åˆ°ä¸€ä¸ªå®é™…è§„æ¨¡çš„é¢„æµ‹æ•°æ®æ¡†æ¶ï¼Œè¿™å°±æ˜¯ä½ æ‰€å…³å¿ƒçš„ã€‚

# å³å°†æ¨å‡ºï¼

æˆ‘ä»Šå¤©å±•ç¤ºçš„æ˜¯åœ¨ MLflow çš„å¸®åŠ©ä¸‹ï¼Œæ‚¨å¯ä»¥åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ PyCaret æä¾›çš„ç»è¿‡åŸ¹è®­çš„ç®¡é“çš„è®¸å¤šæ–¹æ³•ä¹‹ä¸€ã€‚åœ¨ä¸‹ä¸€ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘è®¡åˆ’å±•ç¤ºå¦‚ä½•ä½¿ç”¨ MLflow åŸç”ŸæœåŠ¡åŠŸèƒ½æ¥æ³¨å†Œæ‚¨çš„æ¨¡å‹ï¼Œå¯¹å®ƒä»¬è¿›è¡Œç‰ˆæœ¬åŒ–å¹¶ä½œä¸º API ä½¿ç”¨ã€‚

ä½¿ç”¨ Python ä¸­çš„è¿™ä¸ªè½»é‡çº§å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°çš„ç›®æ ‡æ˜¯æ— é™çš„ã€‚å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°ç»™æˆ‘ä»¬ GitHub åº“ä¸Šçš„â­ï¸ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·åœ¨ [LinkedIn](https://www.linkedin.com/company/pycaret/) å’Œ [Youtube](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g) ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚

åŠ å…¥æˆ‘ä»¬çš„ä¼‘é—²é¢‘é“ã€‚æ­¤å¤„é‚€è¯·é“¾æ¥[ã€‚](https://join.slack.com/t/pycaret/shared_invite/zt-p7aaexnl-EqdTfZ9U~mF0CwNcltffHg)

# æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£:

[ä½¿ç”¨ PyCaret 2.0](/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d)
[åœ¨ Power BI ä¸­æ„å»ºæ‚¨è‡ªå·±çš„ AutoML ä½¿ç”¨ Docker](/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01)
[åœ¨ Azure ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“åœ¨ Google Kubernetes å¼•æ“ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“](/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b)
[åœ¨ AWS Fargate ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“](/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507)
[æ„å»ºå’Œéƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹  web åº”ç”¨](/build-and-deploy-your-first-machine-learning-web-app-e020db344a99)
[ä½¿ç”¨ AWS Fargate æ— æœåŠ¡å™¨](/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2)
[æ„å»ºå’Œéƒ¨ç½²æœºå™¨](/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104)

# é‡è¦é“¾æ¥

[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/installation.html)
[åšå®¢](https://medium.com/@moez_62905)
[GitHub](http://www.github.com/pycaret/pycaret)
[stack overflow](https://stackoverflow.com/questions/tagged/pycaret)
[å®‰è£… PyCaret](https://pycaret.readthedocs.io/en/latest/installation.html) [ç¬”è®°æœ¬æ•™ç¨‹](https://pycaret.readthedocs.io/en/latest/tutorials.html) [æŠ•ç¨¿äº PyCaret](https://pycaret.readthedocs.io/en/latest/contribute.html)

# æƒ³äº†è§£æŸä¸ªç‰¹å®šæ¨¡å—ï¼Ÿ

å•å‡»ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ–‡æ¡£å’Œå·¥ä½œç¤ºä¾‹ã€‚

[åˆ†ç±»](https://pycaret.readthedocs.io/en/latest/api/classification.html) å›å½’ èšç±»
[å¼‚å¸¸æ£€æµ‹](https://pycaret.readthedocs.io/en/latest/api/anomaly.html)
[è‡ªç„¶è¯­è¨€å¤„ç†](https://pycaret.readthedocs.io/en/latest/api/nlp.html) [å…³è”è§„åˆ™æŒ–æ˜](https://pycaret.readthedocs.io/en/latest/api/arules.html)