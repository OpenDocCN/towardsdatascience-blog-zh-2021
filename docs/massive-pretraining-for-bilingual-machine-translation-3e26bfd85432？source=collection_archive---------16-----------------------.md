# 双语机器翻译的大量预训练

> 原文：<https://towardsdatascience.com/massive-pretraining-for-bilingual-machine-translation-3e26bfd85432?source=collection_archive---------16----------------------->

## [思想和理论](https://towardsdatascience.com/tagged/thoughts-and-theory)

## mBART 的引导之旅，这是一个编码器-解码器语言模型，打开了多语言序列到序列任务的有趣视角。

![](img/020129bb75725770865c575efb21e86a.png)

我不知道你怎么想，但这是我在阅读这些非常大的预训练模型时得到的感觉。[阿琼肯](https://unsplash.com/@arjunken?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

注意:这是三篇系列文章中的第一篇。
第一部分:**面向双语机器翻译的海量预训练**
第二部分: [mBART50:可扩展多语言预训练的多语言微调](/mbart50-multilingual-fine-tuning-of-extensible-multilingual-pretraining-70a7305d4838)
第三部分:[多阶段预训练的多语言语音翻译](/multilingual-speech-translation-with-multi-phase-pretraining-305d642b8a66)

如果您在过去三年中从事过任何自然语言处理(NLP)任务，您肯定会注意到 BERT 或类似的大型预训练模型的广泛使用，作为对感兴趣的任务进行微调以实现出色结果的基础。

预先训练的模型允许人们用相对少的数据和训练时间在下游任务上实现高精度。通过大量的预训练，他们已经了解了自然语言的统计结构，并需要学习如何回答特定的任务。然而，由于它们庞大的体积，大多数人没有所需的资源来训练它们中的一个，并且不得不依赖于公开存在的模型。

尽管它们在 NLP 中广泛使用，但迄今为止，大量预训练的模型对机器翻译的影响相对较低。当然，也有过一些尝试，如[【1】](https://aclanthology.org/D19-5611.pdf)[【2】](https://arxiv.org/abs/1901.07291)[【3】](https://aclanthology.org/N19-1409.pdf)或[【4】](https://aclanthology.org/2020.aacl-srw.15.pdf)(针对文档级翻译)，但其影响有限，在实践中并未得到广泛部署。

我认为，这种有限影响的原因有三:

1.  对于研究最多的语言对来说，机器翻译是一项资源非常丰富的任务。
2.  机器翻译模型遵循编码器-解码器结构，而预训练模型仅由编码器组成，因此需要一些适应来将它们用于机器翻译。
3.  这些模型非常大，并且它们在推断期间的计算时间对于编码器-解码器架构来说是不可行的。

mBART 是一个针对大量多语言数据进行预处理的编码器-解码器模型，其目标是改变机器翻译和相关任务的游戏。

# 姆巴特:它是什么，怎么训练的？

mBART [5]是一个基于 Transformer[6]的编码器-解码器模型，它根据来自多种语言的单语数据进行预训练，以便在机器翻译任务中进行微调。在这篇论文中，我们正在研究[5]它在来自不同语系的 25 种欧洲和亚洲语言上进行训练，这些语言是从 [common crawl](https://commoncrawl.org) (CC25)中收集的。

训练目标是去噪损失。给定输入序列 ***X，****模型在源端接收由噪声函数 g( ***X*** )生成的 ***X*** 的讹误版本作为输入。在目标端，目标是用自回归解码来重建原始序列。*

*噪声函数随机屏蔽连续区间中 35%的输入标记。而且多个句子同时馈入输入，噪声函数也会对它们的顺序进行置换。多输入句子的预训练允许模型在文档级机器翻译上进行微调。*

*模型本身具有庞大的规模:编码器和解码器中有 12 层，模型维度为 1024 个单元和 16 个注意头，总共约 680M 个参数。与 GPT-3 相比不算什么，但它仍然需要大量的计算资源来训练！*

*训练使用 256 个 Nvidia V100 GPUs 进行 500K 步，这相当于 2.5 周的训练，尽管有巨大的计算能力和使用 float16 precision 进行更快的训练。不要在家里尝试这个！*

# *微调*

*作者在所有 25 种预训练语言的双语环境中微调了这个模型。英语总是这两种语言中的一种。此外，对句子级和文档级机器翻译都执行微调。这些模型与不同的基线进行比较，包括在较少语言(2 或 6)上预训练的 mBART、单语 BART 和随机初始化。*

*语言对分为以下几类:*

*   *●资源:< 1M sentence pairs*
*   *medium resources: < 10M sentence pairs*
*   *high resources: > 10M 句对*

*结果可以总结如下:*

*   *在低和中等资源语言对的 BLEU 分数方面有显著的提高。它区分了可用和不可用的系统，因为许多结果提高了 10 个以上的 BLEU 点。*
*   *mBART 对极低资源的语言对没有帮助(<10k sentence pairs), but read the section about unsupervised learning to see how this was overcome.*
*   *Marginal gains for high-resourced language pairs with little more than 10M sentence pairs. For the highest-resourced languages a decrement in BLEU score is observed.*
*   *[回译](https://paperswithcode.com/method/bpe) [7]提供了对 mBart 预训练的进一步改进。然而，在预训练期间，可能需要更大的目标语言单语数据才真正有益。*
*   *当目标语言资源不足时，对多种语言进行预训练会更有帮助。当高资源可用时，更多的语言会降低性能。也许在这种情况下，模型达到了它的容量极限。*

*对于资源非常丰富的语言对来说，预训练仍然没有用，但是对于其他语言来说，一些结果的改善是巨大的。并且单个预训练模型可以产生所有这些。*

*此外，我知道所有的目标语言对都使用相同的超参数集，所以仔细调优可能会得到更好的结果。显然，基线也是如此，但我不认为差距可以明显缩小。*

*然后，作者让我们高兴地研究了 mBART 在微调过程中对不可见语言的影响。*

# ***对看不见的语言进行微调***

*在另一项实验中，作者在 2 或 6 种语言上训练 mBART，然后在至少有一种语言在预训练中没有出现的语言对上进行微调。结果如下:*

*   *mBART 预训练对看不见的语言也很有帮助**。**在预训练中有相似的语言是有益的，但不是必需的，并且在原始模型词汇中也没有必要有新语言的字母表。*
*   *对两种看不见的语言进行微调会导致比一种看不见的语言更糟糕的结果。始终使用所有可用的数据！*
*   *当看不见的语言在源端时，结果更糟。在源端进行归纳似乎比在目标端更困难。*

*一般来说，编码器-解码器模型在编码器中学习目标侧的特征，而解码器的工作更容易(例如在[【8】](https://arxiv.org/abs/2006.10369)处)。这可以解释为什么看不见的源语言更难获得更好的结果。对于不同的任务和不同的输入方式，都观察到了这种行为。我个人认为，这是由于注意力模型使得编码器在反向传播过程中可以从目标端接收到很多信息。然而，我不能在这里形成一个理论，我不知道这种现象是否被详细研究过。如果不是，它代表了一个有趣的研究课题。*

*尽管到目前为止信息量很大，但仍然缺少两个实验:文档级机器翻译的微调和无监督学习的微调。*

# *文档级 MT*

*通过在 WMT 19 恩-德和特德 15 恩-ZH 两个方向上微调模型来进行实验。基线是一个模型([韩](https://github.com/idiap/HAN_NMT)【9】)，它是利用文档的层次结构，专门为文档级任务设计的。然而，[9]发表于 2018 年，我不确定是否能找到更好的基线。*

*结果表明，当在句子级工作时，在 mBART 上预训练的模型比随机初始化的相同模型的性能好得多。此外，只有经过微调的版本才能在文档级别产生任何有意义的结果。[之前的工作](https://arxiv.org/pdf/1907.06170.pdf) [10]应用了 BERT 损失，包括识别两个句子是否属于同一个文档，并且能够在没有预训练的情况下训练文档级模型。显然，需要特定于文档级别的损失，但可以在不同的培训阶段使用。如果在预训练期间完成，微调阶段会变得更容易。*

*最终结果是，预训练的模型优于韩的模型，也优于在句子层次上微调的模型。这也与[10]一致，并不令人惊讶，因为句子级机器翻译可以接收脱离上下文时有歧义的句子，但在更广泛的上下文中却可以准确翻译。*

*最后，作者还表明，mBART 是一个伟大的初始化无监督机器翻译。*

# *无人监管的 MT*

*最后一个实验的目的是在无监督的学习环境下评估 mBART。作者提出了两种无监督的双语机器翻译场景:*

1.  *通过回译学习:
    用 mBART 初始化的模型用于生成从目标语言到源语言的即时回译，并通过这种方式学习双语任务。当没有给出平行文本时，这是唯一可能的情况。*
2.  *通过语言迁移学习:
    用 mBART 初始化的模型在一个语言对上进行微调，在另一个具有相同目标端语言的语言对上进行评估。当目标语言存在平行数据，而源-目标对不存在平行数据时，这种训练是有用的。*

*这里的结果是复杂的，但可以找到一些模式。*

*   *对于基于回译的无监督机器翻译:
    mBART 在对**相似语言、**进行微调时类似于更传统的方法，而它为**不相似语言**提供了第一个非退化结果。我们仍然在谈论不能在实践中使用的模型，但这是重要的第一步。*
*   *对于语言迁移:
    当在高资源语言上进行微调时，结果通常令人惊讶地好，在某些情况下，如果源端测试语言与微调语言非常不同，结果也是如此。然而，使用相似的语言通常会得到最好的结果。值得注意的是古吉拉特语的情况，这是一种资源非常匮乏的印度语言，它通过对其他印度语言进行微调而受益匪浅，而它自己的数据导致随机翻译(使用印地语-英语的 13.8 BLEU，而使用古吉拉特语-英语的 13.8 BLEU)。*
*   *这两种方法也可以结合起来:从语言迁移开始，应用迭代回译。这些改进确实值得付出额外的努力。*

*我邀请读者深入到论文中去研究所有的结果，它们很多而且非常详细。因此，可能有适合您的用例的东西。值得注意的是，在无监督学习实验中，英语总是两种语言中的一种，在语言迁移实验中，英语总是目标语言。此外，在预训练期间观察到了两种微调语言，尽管是单语数据。*

# *结束语*

*mBART 在机器翻译和其他基于一个文本到另一个文本的自然语言处理任务领域开辟了新的机会，例如参见[11][12][13]。*

*我发现更有趣的是，模型在预训练期间学习了语言的一些结构，这种结构似乎超越了语言的边界，允许语言之间的内在知识转移。特别是，看到语言转换可以明显优于对目标语言对的微调，对于某些应用程序来说，这确实是改变游戏规则的。*

*现在，我邀请你通过检查结果来批判性地阅读这篇论文，如果你想尝试 mBART，你可以在[拥抱脸变形金刚](https://huggingface.co/transformers/model_doc/mbart.html)或[公平序列](https://github.com/pytorch/fairseq/tree/main/examples/mbart)中找到它。*

*你觉得多语预训后双语微调太局限？在本系列的下一篇文章中，我们将介绍 mBART50 (50 种预训练语言),它提出了一种通过多语言微调来改善结果的方法。*

*[](/tips-for-reading-and-writing-an-ml-research-paper-a505863055cf) [## 阅读和撰写 ML 研究论文的技巧

### 从几十次同行评审中获得的经验教训

towardsdatascience.com](/tips-for-reading-and-writing-an-ml-research-paper-a505863055cf) 

# 参考

[1] Clinchant、Stéphane、Kweon Woo Jung 和 Vassilina Nikoulina。"使用 BERT 进行神经机器翻译."*第三届神经生成和翻译研讨会会议录*。2019

[2]兰普勒，纪尧姆和亚历克西斯·康诺。"跨语言语言模型预训练." *arXiv 预印本 arXiv:1901.07291* (2019)。

[3] Edunov、Sergey、Alexei Baevski 和 Michael Auli。"用于语言生成的预训练语言模型表示."*计算语言学协会北美分会 2019 年会议论文集:人类语言技术，第 1 卷(长短论文)*。2019

[4]郭、智宇和阮明乐。"使用 BERT 作为上下文编码器的文档级神经机器翻译."*计算语言学协会亚太分会第一届会议暨第十届国际自然语言处理联合会议论文集:学生研究工作坊*。2020.

[5]刘，，等.“面向神经机器翻译的多语种去噪预训练”计算语言学协会汇刊 8(2020):726–742。

[6]瓦斯瓦尼、阿希什等人，“你所需要的只是关注。”*神经信息处理系统的进展*。2017.

[7]森里奇、里科、巴里·哈多和亚历山德拉·伯奇。"具有子词单元的稀有词的神经机器翻译."*计算语言学协会第 54 届年会论文集(第 1 卷:长篇论文)*。2016.

[8] Kasai，Jungo 等,《深层编码器，浅层解码器:重新评估非自回归机器翻译》

[9] Werlen，Lesly Miculicich，等，“使用分层注意网络的文档级神经机器翻译”*2018 自然语言处理经验方法会议论文集*。2018.

[10]马钦·容奇斯-道蒙。“WMT 2019 微软翻译机:走向大规模文档级神经机器翻译。”

[11]马丁、路易斯等，“多语言无监督句子简化”arXiv 预印本 arXiv:2005.00352 (2020)。

[12]胜俣、仓知和住井护·小町。"使用预训练的编码器-解码器模型的更强的语法错误校正基线."*计算语言学协会亚太分会第一届会议暨第十届国际自然语言处理联合会议论文集*。2020.

[13]李，冼，等.“ *arXiv 预印本 arXiv:2010.12829* (2020)。

# 中等会员

你喜欢我的文章吗？你是否正在考虑申请一个中级会员来无限制地阅读我的文章？

如果您通过此链接订阅，您将通过您的订阅支持我，无需为您支付额外费用【https://medium.com/@mattiadigangi/membership*