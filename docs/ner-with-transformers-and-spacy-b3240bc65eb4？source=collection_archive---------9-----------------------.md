# NER ä¸å˜å½¢é‡‘åˆšå’Œå¤ªç©º

> åŸæ–‡ï¼š<https://towardsdatascience.com/ner-with-transformers-and-spacy-b3240bc65eb4?source=collection_archive---------9----------------------->

## ä½¿ç”¨ roBERTa æå–è¿‡å¼ºçš„å®ä½“

![](img/db1c07c069a523366bee41cc0319f3ad.png)

ä½œè€…å›¾ç‰‡

N å‘½åå®ä½“è¯†åˆ«(NER)åŒ…æ‹¬ä»æ–‡æœ¬ä¸­æå–â€œå®ä½“â€â€”â€”æˆ‘ä»¬çš„æ„æ€åœ¨å¥å­ä¸­ç»™å‡ºäº†:

> "ä»Šå¹´ 1 æœˆï¼Œè‹¹æœå…¬å¸çš„è‚¡ä»·è¾¾åˆ°äº† 143 ç¾å…ƒçš„å†å²æ–°é«˜ã€‚"

æˆ‘ä»¬å¯èƒ½æƒ³è¦æå–å…³é”®çš„ä¿¡æ¯ç‰‡æ®µâ€”â€”æˆ–â€œå®ä½“â€â€”â€”å¹¶å¯¹è¿™äº›å®ä½“è¿›è¡Œåˆ†ç±»ã€‚åƒè¿™æ ·:

**è‹¹æœâ€”ç»„ç»‡**

**143 ç¾å…ƒâ€”â€”è´§å¸ä»·å€¼**

**ä»Šå¹´ 1 æœˆâ€”æ—¥æœŸ**

å¯¹äºæˆ‘ä»¬äººç±»æ¥è¯´ï¼Œè¿™å¾ˆå®¹æ˜“ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•æ•™ä¼šä¸€å°æœºå™¨åŒºåˆ†ä¸€ä¸ªå²å¯†æ–¯å¥¶å¥¶è‹¹æœå’Œæˆ‘ä»¬åœ¨çº³æ–¯è¾¾å…‹äº¤æ˜“çš„è‹¹æœå‘¢ï¼Ÿ

*(ä¸ï¼Œæˆ‘ä»¬ä¸èƒ½æŒ‡æœ›â€˜Aâ€™å¤§å†™â€¦â€¦)*

è¿™å°±æ˜¯ NER çš„ç”¨æ­¦ä¹‹åœ°â€”â€”ä½¿ç”¨ NERï¼Œæˆ‘ä»¬å¯ä»¥æå–åƒè‹¹æœè¿™æ ·çš„å…³é”®è¯ï¼Œå¹¶ç¡®å®šå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª*ç»„ç»‡*â€”â€”è€Œä¸æ˜¯ä¸€ç§æ°´æœã€‚

Python ä¸­ NER çš„é¦–é€‰æ˜¯ spaCy åº“â€”â€”è¿™çœŸçš„å¾ˆç¥å¥‡ã€‚ä¾‹å¦‚ï¼Œæˆ‘åœ¨ç¼–å†™ä»»ä½•ä»£ç ä¹‹å‰ç¼–å†™äº†ä¸Šé¢çš„ NER ç¤ºä¾‹ï¼ŒspaCy å®Œç¾åœ°åŒ¹é…äº†è¯¥ç¤ºä¾‹:

![](img/dfe6ecd4c0bc7355ef8edae269a9f75e.png)

å˜å‹å™¨ NER æ¨¡å‹çš„è¾“å‡ºã€‚

å¾ˆé…·çš„ä¸œè¥¿â€¦ä½†æ˜¯ï¼Œè¿™åªæ˜¯é¦™è‰ç©ºé—´â€”â€”å¦‚æœæˆ‘ä»¬åŠ å…¥å˜å½¢é‡‘åˆšä¼šæ€ä¹ˆæ ·ï¼Ÿ

# ç©ºé—´å˜å‹å™¨

å˜å½¢é‡‘åˆšæ˜¯è‡ª NLP ä¸­çš„é¢åŒ…ç‰‡ä»¥æ¥æœ€çƒ­é—¨çš„ä¸œè¥¿ã€‚è‡ª 2017-18 å¹´æ¨å‡ºä»¥æ¥ï¼Œå®ƒä»¬å·²ç»ä¸»å¯¼äº† NLP åŸºå‡†ï¼Œæˆä¸ºäº‹å®ä¸Šçš„è¯­è¨€æ ‡å‡†(æŠ±æ­‰ï¼ŒLSTM)ã€‚

SpaCy åœ¨ 2019 å¹´æ¨å‡ºäº†`spacy-transformers`åº“[1]ã€‚å®ƒå°† spaCy è¿æ¥åˆ° HuggingFace çš„å˜å½¢é‡‘åˆšåº“â€”â€”å…è®¸æˆ‘ä»¬åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨ NERâ€”â€”ä½†ç”±å°–ç«¯çš„å˜å½¢é‡‘åˆšæ¨¡å‹é©±åŠ¨ã€‚

NER ä¸å˜å½¢é‡‘åˆšå’Œç©ºé—´çš„è§†é¢‘æ¼«æ¸¸ã€‚

## è£…ç½®

æˆ‘ä»¬é¦–å…ˆå®‰è£…`spacy-transformers`,ä½¿ç”¨:

```
pip install spacy[transformers]
```

å¦‚æœä½ ä½¿ç”¨ CUDAï¼Œç”¨`nvcc --version`æ£€æŸ¥ä½ çš„ç‰ˆæœ¬ï¼ŒæŠŠ CUDA ç‰ˆæœ¬æ·»åŠ åˆ°å®‰è£…ä¸­â€”â€”æˆ‘æœ‰ CUDA 11.1ï¼Œæ‰€ä»¥æˆ‘çš„å®‰è£…å‘½ä»¤æ˜¯:

```
pip install spacy[transformers,cuda111]
```

## åˆå§‹åŒ–ç©ºé—´è½¬æ¢å™¨

ç°åœ¨æˆ‘ä»¬å·²ç»å®‰è£…äº†`spacy-transformers`ï¼Œæˆ‘ä»¬å¯ä»¥åƒé€šå¸¸ä½¿ç”¨ spaCy æ¨¡å‹ä¸€æ ·å¼€å§‹ä½¿ç”¨ transformer æ¨¡å‹ã€‚

è¿™é‡Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯æˆ‘ä»¬ä¸‹è½½å¹¶åˆå§‹åŒ–ä¸€ä¸ª spaCy transformer æ¨¡å‹â€”â€”è€Œä¸æ˜¯é€šå¸¸çš„æ¨¡å‹ã€‚

æˆ‘ä»¬ä¸‹è½½äº† [roBERTa-base æ¨¡å‹](https://spacy.io/models/en#en_core_web_trf),å…¶ä¸­åŒ…å«:

```
python -m spacy download en_core_web_trf
```

ç„¶åç”¨ Python åˆå§‹åŒ–å®ƒ:

å¯¹äºä»¥å‰ä½¿ç”¨è¿‡ spaCy çš„äººæ¥è¯´ï¼Œè¿™åº”è¯¥çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰ã€‚

## NER

æˆ‘ä»¬ç°åœ¨å‡†å¤‡ç”¨æˆ‘ä»¬çš„ transformer æ¨¡å‹å¤„ç†ä¸€äº›æ–‡æœ¬ï¼Œå¹¶å¼€å§‹æå–å®ä½“ã€‚åŒæ ·ï¼Œè¿™é‡Œä¸é€šå¸¸çš„ç©ºé—´è¯­æ³•æ²¡æœ‰åŒºåˆ«:

![](img/dfe6ecd4c0bc7355ef8edae269a9f75e.png)

å˜å‹å™¨ NER æ¨¡å‹çš„è¾“å‡ºã€‚

## å˜å½¢é‡‘åˆš v ä¼ ç»Ÿç©ºé—´

å¾ˆå¥½ï¼Œä½†æ˜¯ä¸ä¼ ç»Ÿçš„ç©ºé—´æ¨¡å‹ç›¸æ¯”ï¼Œè¿™ç§æ¨¡å‹è¡¨ç°å¦‚ä½•ï¼Ÿæˆ‘ä»¬å°†ä½¿ç”¨`en_core_web_lg`æ¨¡å‹ï¼Œå¹¶æ¯”è¾ƒæ¥è‡ª[*r/æŠ•èµ„*](https://www.reddit.com/r/investing/) å­ç¼–è¾‘çš„ä¸€äº›å¸–å­ã€‚

![](img/dff79bd0dac9070529e05b0f57ba054a.png)![](img/cdf8c91b1f6bbebea92a75dbc1d48ddb.png)

ä¼ ç»Ÿ **en_core_web_lg** å‹å·(å·¦)ï¼Œå˜å½¢é‡‘åˆš **en_core_web_trf** å‹å·(å³)ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´æ²¡æœ‰ä»»ä½•å·®å¼‚â€”â€”æˆ‘ä»¬åº”è¯¥æœŸå¾…æœ‰ç›¸å½“æ•°é‡çš„æ ·æœ¬ï¼Œå› ä¸ºä¼ ç»Ÿæ¨¡å‹`en_core_web_lg`ä»ç„¶æ˜¯ä¸€ä¸ªéå¸¸é«˜æ€§èƒ½çš„æ¨¡å‹ã€‚

ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬ä»[è¿™é‡Œ](https://www.reddit.com/r/investing/comments/n6uka6/fastly_drops_27_after_release_of_q121_results/)å°è¯•ä¸€ä¸ªç¨å¾®é•¿ä¸€ç‚¹ã€æ›´å¤æ‚çš„ä¾‹å­:

```
Fastly released its Q1-21 performance on Thursday, after which the stock price dropped a whopping 27%. The company generated revenues of $84.9 million (35% YoY) vs. $85.1 million market consensus. Net loss per share was $0.12 vs. an expected $0.11.These are not big misses but make the company one of the few high-growth cloud players that underperformed market expectations.However, the company also lowered its guidance for Q2: Fastly forecasts revenues of $84 - $87 million and a net loss of $0.16 - $0.19 per share, compared to the market consensus of $92 million in revenue and a net loss of $0.08 per share, thereby disappointing investors.Lastly, Adriel Lares will step down as CFO of the company after 5 years.
```

![](img/96e28f50191914b899dadd31e457ff28.png)![](img/509c556282e576f0651207a04e539db1.png)

ä¼ ç»Ÿ **en_core_web_lg** å‹å·(å·¦)ï¼Œå˜å½¢é‡‘åˆš **en_core_web_trf** å‹å·(å³)ã€‚

ç°åœ¨æˆ‘ä»¬çœ‹åˆ°äº†ä¸åŒä¹‹å¤„:

é™¤äº†åœ¨ç™¾åˆ†æ¯”æ ‡ç­¾ä¸­åŒ…å«*â€œå·¨å¤§çš„â€*â€”â€”transformer æ¨¡å‹æ˜æ˜¾ä¼˜äºä¼ ç»Ÿæ¨¡å‹ã€‚

å…³äºåœ¨ç©ºé—´ä¸­ä½¿ç”¨è½¬æ¢å™¨*è¿›è¡Œå‘½åå®ä½“è¯†åˆ«çš„æ–‡ç« åˆ°æ­¤ç»“æŸï¼ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®Œæ•´çš„ç¬”è®°æœ¬ã€‚*

æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·é€šè¿‡ [Twitter](https://twitter.com/jamescalam) æˆ–åœ¨ä¸‹é¢çš„è¯„è®ºä¸­å‘Šè¯‰æˆ‘ã€‚å¦‚æœä½ æƒ³è¦æ›´å¤šè¿™æ ·çš„å†…å®¹ï¼Œæˆ‘ä¹Ÿä¼šåœ¨ YouTube ä¸Šå‘å¸ƒã€‚

æ„Ÿè°¢é˜…è¯»ï¼

# å‚è€ƒ

[1] M. Honnibal & I. Montaniï¼Œ [spaCy é‡ä¸Šå˜å½¢é‡‘åˆš:å¾®è°ƒä¼¯ç‰¹ã€XLNet å’Œ GPT-2](https://explosion.ai/blog/spacy-transformers) (2019)ï¼Œçˆ†ç‚¸ AI

[ğŸ¤–å¸¦å˜å‹å™¨çš„ NLP è¯¾ç¨‹](https://bit.ly/nlp-transformers)

å¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£æ›´å¤šå…³äºä½¿ç”¨ NER ç©ºé—´åº“çš„ä¿¡æ¯ï¼Œæˆ‘ä¼šåœ¨è¿™é‡Œåšæ›´æ·±å…¥çš„ä»‹ç»:

[](/ner-for-extracting-stock-mentions-on-reddit-aa604e577be) [## NER åœ¨ Reddit ä¸Šæå–è‚¡ç¥¨æåŠ

### å¦‚ä½•ä½¿ç”¨å‘½åå®ä½“è¯†åˆ«è¿›è¡Œæœ‰æ„ä¹‰çš„åˆ†ç±»

towardsdatascience.com](/ner-for-extracting-stock-mentions-on-reddit-aa604e577be) 

**æ‰€æœ‰å›¾ç‰‡å‡ç”±ä½œè€…æä¾›ï¼Œé™¤éå¦æœ‰è¯´æ˜*