# 机器学习中缺失数据的处理

> 原文：<https://towardsdatascience.com/handling-missing-data-in-machine-learning-d7acac44bef9?source=collection_archive---------24----------------------->

## 构建 ML 模型时如何处理缺失数据

![](img/b21e247eabddec0ed9d4bb37b7ef76f8.png)

凯利·西克玛在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

在真实的(表格)数据集中，您通常会意识到并非所有的特性都适用于您的所有行。学习处理这种现象将允许你仍然利用你的数据集，甚至当一些数据丢失的时候。

## 缺失数据的类型

有多种原因可能导致数据丢失，例如数据损坏、在特定时间段内缺乏数据可用性或数据收集过程中的偏差(例如，调查中特定类别的受访者将答案留空)。

这里要做的重要区分是你丢失的数据是否是随机发生的*。*

*缺失数据有三种情况:*

*   ***完全随意失踪(MCAR)。**对于所有可能的数据点，数据缺失的概率是相等的。*
*   ***随机失踪(MAR)。**数据丢失的概率在所有数据点上并不相等，但是*在*已知的数据类别中，丢失数据的概率是相等的。例如，只有在特定国家的答复中，数据缺失的概率可能是相等的。*
*   ***不随意遗漏(MNAR)。**数据丢失的概率在所有数据点上并不相等，并且不存在已知的数据分组，其中丢失数据的概率相等。*

## *删除方法*

*处理缺失数据的第一类方法是从数据集中删除数据。这些通常都是简单的方法，旨在删除因损坏太严重而无法使用的数据点或列。*

1.  ***删除缺少太多列值的行。**在 MCAR 和火星方案中，这可能在不显著改变整个数据集分布的情况下完成。但是，在 MNAR 场景中，这可能会使您的数据集产生偏差，因为数据移除过程会偏向于导致较高数据丢失率的过程所生成的点。这并不一定是坏事，尤其是在丢失了太多可用数据的情况下，但这是需要注意的。*
2.  ***删除缺少太多值的列。**一些特征可能仅仅是低质量的，并且具有过高的空率以至于不能用它们来建立模型。特别是在生产机器学习设置中，删除通常不可用或低质量的功能通常是一个好主意。*

## *插补方法*

*另一类处理缺失数据的方法包括尝试填充或估算缺失数据。这通常包括学习对数据集进行建模，以便推断出缺失的值应该是什么。*

1.  *常数/平均值/中位数插补。这些是最简单的插补方法，最多只是计算一些简单的列统计数据。对于每一列，以及在 MAR 方案中的每一组中，您可以用常数值或可用特征值的某一列统计数据(例如，平均值或中值)来替换缺失值。*
2.  ***回归插补。**一种更复杂的数据输入方法包括建立一个预测模型，该模型可以推断缺失数据的值。这些方法更强大，能够理解数据的底层结构，以便为缺失数据提供更智能的猜测。因此，例如，如果我们有 5 个特征和 1 个缺失，我们建立一个模型，在给定其他 5 个特征的情况下预测缺失的 1 个。这种方法的一个警告是，它可以人为地加强数据中的关系，并产生“好得难以置信”的估计，这只会加强数据集中的偏差和相关性。因此，这些估算值可能低估了数据集中的方差。*
3.  ***多重插补。**该方法是为估算值创建更稳健估计的一种方式，可以利用上述两种方法。在多重插补中，您创建 N 个不同版本的插补数据集，然后将 N 个值汇集在一起，以产生一个最终数据集(通过简单的方法，如平均，或一些更复杂的统计方法)。多重插补的结果比单一插补的结果偏差更小，更能代表数据集的方差。*