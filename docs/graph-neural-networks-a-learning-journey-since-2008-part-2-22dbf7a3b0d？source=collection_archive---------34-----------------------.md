# å›¾å½¢ç¥ç»ç½‘ç»œ:2008 å¹´ä»¥æ¥çš„å­¦ä¹ ä¹‹æ—…â€”â€”ç¬¬äºŒéƒ¨åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/graph-neural-networks-a-learning-journey-since-2008-part-2-22dbf7a3b0d?source=collection_archive---------34----------------------->

## å…³äºæ–¯å¡å¡åˆ©å›¾å½¢ç¥ç»ç½‘ç»œçš„ç¬¬äºŒä¸ªæ•…äº‹ã€‚ä»Šå¤©ï¼Œè®©æˆ‘ä»¬æ¥å®ç°æˆ‘ä»¬æ‰€å­¦çš„:Python ä¸­çš„ GNN

![](img/b6868d69524fb205460b24bf9074a398.png)

å¸ƒé›·è¿ªÂ·è´é‡Œå°¼åœ¨ [Unsplash](https://unsplash.com/photos/WEQbe2jBg40) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

[](https://medium.com/@stefanobosisio1/membership) [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium-Stefano Bosisio

### ä½œä¸ºä¸€ä¸ªåª’ä½“ä¼šå‘˜ï¼Œä½ çš„ä¼šå‘˜è´¹çš„ä¸€éƒ¨åˆ†ä¼šç»™ä½ é˜…è¯»çš„ä½œå®¶ï¼Œä½ å¯ä»¥å®Œå…¨æ¥è§¦åˆ°æ¯ä¸€ä¸ªæ•…äº‹â€¦

medium.com](https://medium.com/@stefanobosisio1/membership) 

æˆ‘ä»¬åœ¨æœ¬ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†[ä¸­å­¦ä¹ äº†æ–¯å¡å¡åˆ©å›¾å½¢ç¥ç»ç½‘ç»œçš„ç†è®ºèƒŒæ™¯ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬äº†è§£åˆ°:](/graph-neural-networks-a-learning-journey-since-2008-part-1-7df897834df9)

*   GNN æ—¢é€‚åˆåŸºäºèŠ‚ç‚¹çš„é¢„æµ‹ï¼Œä¹Ÿé€‚åˆåŸºäºå›¾çš„é¢„æµ‹ã€‚åœ¨å‰ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›é¢„æµ‹å›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œåœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›é¢„æµ‹æ•´ä¸ªå›¾
*   æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ç”¨ä¸€ä¸ªè½¬ç§»å‡½æ•° *fğ“Œ* å’Œä¸€ä¸ªè¾“å‡ºå‡½æ•° *gğ“Œ* æ¥è¡¨ç¤ºã€‚
*   ä¸ºäº†æ”¶æ•›åˆ°ä¸€ä¸ªè§£ï¼Œè½¬ç§»å‡½æ•°å’Œè¾“å‡ºå‡½æ•°éƒ½å¿…é¡»æ»¡è¶³ Banach çš„ä¸åŠ¨ç‚¹è§£
*   å¤šå±‚æ„ŸçŸ¥å™¨(MLP)ç¡®å®æ»¡è¶³å·´æ‹¿èµ«çš„è¦æ±‚ï¼Œå› æ­¤ *fğ“Œ* å’Œ *gğ“Œ* å¯ä»¥å®ç°ä¸ºç®€å•çš„ç¥ç»ç½‘ç»œå±‚

è®°ä½è¿™å‡ ç‚¹ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°çœ‹çœ‹å¦‚ä½•ç”¨ Python å®ç°è¿™ä¸ªæ¡†æ¶ï¼Œå¹¶æŠŠå®ƒåº”ç”¨åˆ°ä¸€ä¸ªç®€å•çš„é—®é¢˜ä¸Šï¼Œè¿™ä¸ªé—®é¢˜å«åšâ€œç©ºæ‰‹é“ä¿±ä¹éƒ¨â€ã€‚

# ç©ºæ‰‹é“ä¿±ä¹éƒ¨

æˆ‘ä»¬ä»¥æ‰å¡é‡Œçš„ç©ºæ‰‹é“ä¿±ä¹éƒ¨é—®é¢˜ä¸ºä¾‹ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥è¿½æº¯åˆ° Zachary çš„è®ºæ–‡â€œå°ç¾¤ä½“ä¸­å†²çªå’Œè£‚å˜çš„ä¿¡æ¯æµæ¨¡å‹â€[29]ï¼Œå…¶ä¸­å¯¹ä¸€ä¸ªç©ºæ‰‹é“ä¿±ä¹éƒ¨ç½‘ç»œè¿›è¡Œäº†ä¸‰å¹´(1970â€“1972)çš„ç ”ç©¶ã€‚è¯¥ç½‘ç»œç”± 34 åæˆå‘˜ç»„æˆï¼ŒåŒ…æ‹¬ç©ºæ‰‹é“ä¿±ä¹éƒ¨ç®¡ç†å‘˜â€œçº¦ç¿° Aâ€å’Œæ•™ç»ƒâ€œå—¨å…ˆç”Ÿâ€ï¼Œä»¥åŠåœ¨ä¿±ä¹éƒ¨å¤–äº’åŠ¨çš„æˆå¯¹æˆå‘˜ä¹‹é—´çš„è”ç³»(ä»–ä»¬èšåœ¨ä¸€èµ·å–å•¤é…’ï¼Œæ•£æ­¥â€¦â€¦)ã€‚åœ¨ç®¡ç†è€…å’ŒæŒ‡å¯¼è€…ä¹‹é—´çš„ä¸€åœºäº‰è®ºä¹‹åï¼Œä¿±ä¹éƒ¨åˆ†è£‚æˆä¸¤åŠï¼Œå› æ­¤ä¸¤ä¸ªæ–°çš„ç»„è¢«åˆ›å»ºã€‚æ‰å¡é‡Œç”¨ç¦ç‰¹-å¯Œå°”å…‹æ£®ç®—æ³•æ­£ç¡®é¢„æµ‹äº†æˆå‘˜å¦‚ä½•é‡æ–°å®‰æ’ä»–ä»¬çš„ç¤¾äº¤ç½‘ç»œ/æ¯ä¸ªæˆå‘˜çš„å†³å®šã€‚è¿™ä¸ªé—®é¢˜å¼•èµ·äº†å›¾å½¢çˆ±å¥½è€…ç¤¾åŒºçš„æ³¨æ„ï¼Œå®ƒè¢«å¹¿æ³›ç”¨äºæµ‹è¯• GraphNNã€‚æ–¯å¡å¡åˆ© 2009 å¹´çš„è®ºæ–‡åº”ç”¨å›¾å½¢ç¥ç»ç½‘ç»œæ­£ç¡®é¢„æµ‹äº†ç©ºæ‰‹é“ä¿±ä¹éƒ¨æˆå‘˜åœ¨åˆ†è£‚åçš„å†³ç­–ã€‚

## Github å›è´­å’Œå®‰è£…

ä¸»è¦è„šæœ¬å­˜å‚¨åœ¨æ­¤å­˜å‚¨åº“ä¸­:

[](https://github.com/Steboss/learn_graph_ml/tree/master/Scarselli_GNN) [## å¤§å¸ˆ ste boss/learn _ graph _ ml/æ–¯å¡å¡åˆ© _GNN

### ä» 2009 å¹´åˆ°ç°åœ¨çš„ä¸€æ¬¡é•¿é€”æ—…è¡Œï¼Œåœ¨ ste boss/learn _ graph _ ml/Scarselli _ GNN å¤§å¸ˆè¯¾ä¸Šå­¦ä¹ å›¾è¡¨

github.com](https://github.com/Steboss/learn_graph_ml/tree/master/Scarselli_GNN) 

åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘å»ºè®®æ‚¨åœ¨ä¸€ä¸ªå·¥ä½œç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒ(åªéœ€è¾“å…¥æ‚¨çš„ç»ˆç«¯`python -m venv venv`ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ª`venv`æ–‡ä»¶å¤¹)ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥å®‰è£…è¿™äº›è½¯ä»¶åŒ…:

*   `dgl`æ˜¯ Deep Graph Libraryï¼Œä¸€ä¸ªä¸“é—¨ä»äº‹å›¾å½¢è®¡ç®—çš„åº“ã€‚åœ¨åŸ¹è®­æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥å¯è§†åŒ–æˆ‘ä»¬çš„å›¾è¡¨ã€‚è¦å®‰è£…`dgl`ï¼Œè¯·åœ¨æ­¤é¡µé¢æ’å…¥æ‚¨çš„ç¡¬ä»¶ä¿¡æ¯:[https://www.dgl.ai/pages/start.html](https://www.dgl.ai/pages/start.html)(ä¾‹å¦‚`None` CUDAã€`Pip(stable)`åŒ…ã€`Mac` Os å’Œ`Python 3.8`ç‰ˆæœ¬ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤`pip install dgl -f https://data.dgl.ai/wheels/repo.html)`å®‰è£…`dgl`ã€‚å¦‚æœæ‚¨åœ¨ä½¿ç”¨`pip`æ—¶é‡åˆ°é—®é¢˜ï¼Œåªéœ€ä½¿ç”¨`pip install --upgrade pip`è¿›è¡Œå‡çº§ï¼Œä¸€åˆ‡éƒ½ä¼šæ­£å¸¸å·¥ä½œã€‚
*   `pip install torch`
*   `pip install tensorflow`
*   `pip install matplotlib`
*   `pip install seaborn`

## è„šæœ¬å’Œå›¾å½¢ä»‹ç»

æ­£å¦‚ä½ åœ¨ Github repo ä¸­çœ‹åˆ°çš„ï¼Œæœ‰å‡ ä¸ªè„šæœ¬ã€‚ä»¥ä¸‹æ˜¯å¯¹å®ƒä»¬çš„ç®€å•æè¿°:

*   `create_and_visualize.py`å…è®¸åˆ›å»ºåˆå§‹å›¾å½¢å¹¶åœ¨è®­ç»ƒæœŸé—´ç»˜åˆ¶å›¾å½¢
*   `prepare_edge_nodes_mat.py`æä¾›äº†è¾¹ã€æ ‡ç­¾å’ŒèŠ‚ç‚¹çš„ç‰¹å¾ã€‚åˆ›å»ºä¸¤ä¸ªçŸ©é˜µ:`E`è¾¹çŸ©é˜µå’Œå›¾å½¢ idï¼Œ`N`èŠ‚ç‚¹ç‰¹å¾çŸ©é˜µå’Œå›¾å½¢ id
*   `prepare_GNN.py`å˜æ¢`E`å’Œ`N`çŸ©é˜µä½œä¸ºå›¾å½¢ç¥ç»ç½‘ç»œçš„è¾“å…¥ã€‚è¾“å‡ºæ˜¯ä¸€ä¸ª`inp`çŸ©é˜µï¼Œå…¶å½¢å¼ä¸º`[source_node, destination_node, features of the source node, features of the destination node]`å’Œ`arcnode`çŸ©é˜µï¼Œä¸€ä¸ªç¨€ç–çŸ©é˜µï¼ŒèŠ‚ç‚¹ä¹‹é—´æœ‰è¾¹è¿æ¥ï¼Œä¾‹å¦‚`[source_node, destination_node, 1 at source index position 0 otherwise]`
*   `input_and_output_funcitons.py`å®šä¹‰äº† *fğ“Œ* å’Œ *gğ“Œ* ç¥ç»ç½‘ç»œï¼Œä»¥åŠéªŒè¯æŒ‡æ ‡å’ŒæŸå¤±
*   `GNN.py`ä¸»å›¾å½¢ç¥ç»ç½‘ç»œç±»ï¼Œå…¶ä¸­å®šä¹‰äº†è®­ç»ƒæ¡ä»¶ï¼Œä»¥åŠæ”¶æ•›æ€§æ£€æŸ¥ã€‚æœ€ç»ˆè¾“å‡ºæ˜¯è®­ç»ƒæŸå¤±ã€èŠ‚ç‚¹é¢„æµ‹ã€èŠ‚ç‚¹åœ¨è®­ç»ƒæœŸé—´çš„ä½ç½®ä»¥åŠæ”¶æ•›çš„è¿­ä»£æ¬¡æ•°ã€‚
*   `karate.py`æ˜¯ä¸»è„šæœ¬ï¼Œåˆ›å»ºç©ºæ‰‹é“æ•°æ®é›†å¹¶è®­ç»ƒ GNNã€‚

ä½œä¸ºç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ`create_and_visualize.py`æ¥å¯è§†åŒ–ç©ºæ‰‹é“ä¿±ä¹éƒ¨å›¾ã€‚æ‚¨å¯ä»¥åœ¨ä¸€ä¸ª`ipyhton` shell ä¸­è¿è¡Œè¿™ä¸ªè„šæœ¬:

å›¾ 1:åœ¨ Python shell ä¸­ï¼Œåªéœ€è¾“å…¥ä¸Šé¢çš„å‘½ä»¤å°±å¯ä»¥æ˜¾ç¤ºè¾“å…¥çš„ç©ºæ‰‹é“ä¿±ä¹éƒ¨å›¾

è¯¥å›¾æ˜¯é€šè¿‡`build_karate_club_graph()`å‡½æ•°ä¸­çš„`dgl.DGLGraph()`åˆ›å»ºçš„ã€‚`visualize_karate_club()`é€šè¿‡è½¬æ¢è¾“å…¥å›¾`to_networkx()`äº§ç”Ÿè¾“å‡º(å›¾ 2)

![](img/ec6d89e57e5f9411c11b7dc98b6cf04b.png)

å›¾ 2:ä½œä¸ºå›¾è¡¨çš„ç©ºæ‰‹é“ä¿±ä¹éƒ¨ã€‚è¯¥ä¿±ä¹éƒ¨ç”± 34 ä¸ªäººç»„æˆï¼Œåœ¨åˆ†è£‚åï¼Œä»–ä»¬å†³å®šæ ¹æ®è‡ªå·±çš„ç‰¹ç‚¹åˆ†æˆä¸¤ç»„ã€‚

## å›¾è§£è¯´æ˜

å›¾ 3 ç¤ºå‡ºäº†è®¡ç®—æ­¥éª¤çš„å›¾å½¢ç ”ç©¶ã€‚ä»åˆå§‹å›¾åˆ›å»ºä¸¤ä¸ªçŸ©é˜µ:èŠ‚ç‚¹ç‰¹å¾ N çŸ©é˜µå’Œè¾¹çŸ©é˜µ eã€‚ç„¶åè¿™ä¸¤ä¸ªçŸ©é˜µè¢«è½¬æ¢ä¸ºå›¾ç¥ç»ç½‘ç»œçš„è¾“å…¥ã€‚ç‰¹åˆ«åœ°ï¼ŒçŸ©é˜µ e å’Œæ¥è‡ªçŸ©é˜µ n çš„ç‰¹å¾è¢«ç”¨ä½œè½¬ç§»å‡½æ•° *fğ“Œ* çš„è¾“å…¥ã€‚è¿™ä¸ªç¥ç»ç½‘ç»œè¾“å‡ºä¸ arcnode one-hot ç¼–ç çŸ©é˜µç›¸ä¹˜ï¼Œä»¥æ›´æ–°èŠ‚ç‚¹çš„çŠ¶æ€ã€‚æœ€ç»ˆè¾“å‡ºç”¨ä½œå‡½æ•° *gğ“Œ* çš„è¾“å…¥ï¼Œä»¥äº§ç”Ÿæœ€ç»ˆé¢„æµ‹

![](img/2c59db193170bbdc320d8091321d043e.png)

å›¾ 3:è®¡ç®—æ–¹æ³•çš„å›¾ç¤ºã€‚è¾“å…¥å›¾è¢«ç»†åˆ†ä¸ºçŸ©é˜µ N å’Œ eã€‚ä»é‚£é‡Œï¼ŒGraphNN çš„è¾“å…¥çŸ©é˜µè¢«åˆ›å»ºã€‚çŸ©é˜µ inp æ˜¯è¾¹çŸ©é˜µå’Œç‰¹å¾çš„ç»„åˆï¼Œè€Œ arcnode å°†è¾¹è¿æ¥å®šä¹‰ä¸ºä¸€ä¸ªä¸€é”®ç¼–ç çŸ©é˜µã€‚ç„¶åï¼Œinp çŸ©é˜µè¢«ç”¨ä½œ NN fw çš„è¾“å…¥ã€‚èŠ‚ç‚¹çŠ¶æ€ç”± matmul ç”¨ arcnode çŸ©é˜µæ›´æ–°ã€‚é€šè¿‡è¾“å‡ºå‡½æ•° gw äº§ç”Ÿæœ€ç»ˆè¾“å‡º

## 1.è¾“å…¥é¢„å¤„ç†:è¾¹ã€æ ‡ç­¾å’Œè¦ç´ 

[](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/prepare_edge_nodes_mat.py) [## ä¸» Steboss ä¸Šçš„ learn _ graph _ ml/prepare _ edge _ nodes _ mat . py/learn _ graph _ ml

### ä» 2009 å¹´åˆ°ç°åœ¨çš„ä¸€æ¬¡é•¿é€”æ—…è¡Œï¼Œå¸¦ç€ graphs-learn _ graph _ ml/prepare _ edge _ nodes _ mat . py åœ¨ä¸»â€¦

github.com](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/prepare_edge_nodes_mat.py) 

`prepare_edge_nodes_mat.py`å…è®¸åˆ›å»ºä¸¤ä¸ªçŸ©é˜µ:è¾¹çŸ©é˜µ`E`å’ŒèŠ‚ç‚¹ç‰¹å¾çŸ©é˜µ`N`ã€‚

ä¸ºäº†åˆ›å»ºè¾¹ï¼Œæˆ‘åœ¨`data/edges.txt`ä¸­æä¾›äº†ä¸€ä¸ªè¾“å…¥æ–‡ä»¶:

å›¾ edges.txt æ–‡ä»¶çš„å‰ 8 è¡Œï¼ŒèŠ‚ç‚¹ 1 çš„è¾¹

è¾¹çš„çŸ©é˜µ`E`æ˜¯ä»è¾¹è¾“å…¥åŠ ä¸Šå®šä¹‰äº†`graph_id`çš„æœ€åä¸€åˆ—åˆ›å»ºçš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹`graph_id`æ˜¯ 0ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦èŠ‚ç‚¹èšç„¦çš„é¢„æµ‹ã€‚å¦‚æœæ‚¨æ­£åœ¨æ‰§è¡ŒåŸºäºå›¾å½¢çš„é¢„æµ‹ï¼Œæ‚¨å°†æ·»åŠ ä¸€ä¸ª`graph_id`ã€‚

çŸ©é˜µ`E`çš„æœ€ç»ˆå†…å®¹æ˜¯`[source_node, destination_node, graph_id]`:

å›¾ 5:ä»è¾“å…¥è¾¹åˆ›å»º E çŸ©é˜µå¹¶ä¸å›¾ id å€¼è¿æ¥

ä½¿ç”¨`sp.eye(np.max(edges+1), dtype=np.float32).tocsr()`å°†èŠ‚ç‚¹çš„ç‰¹å¾åˆ›å»ºä¸ºä¸€ä¸ªçƒ­ç¼–ç çŸ©é˜µ:

*   `sp.eye`æ˜¯`scipy.sparse`çŸ©é˜µï¼Œ
*   `np.max(edges+1)`å®šä¹‰äº†æˆ‘ä»¬æƒ³è¦çš„ç´¢å¼•çš„å€¼ä¸º 1ã€
*   `tocsr()`æ˜¯å‹ç¼©ç¨€ç–è¡Œæ ¼å¼

å°†ç‰¹å¾ä¸`graph_id`è¿æ¥ï¼Œä»¥åˆ›å»ºæœ€ç»ˆèŠ‚ç‚¹çš„ç‰¹å¾çŸ©é˜µ`N`ï¼Œå…¶å†…å®¹ä¸º`[ node's features, graph_id]`ï¼Œç»´åº¦ä¸º`[number_of_nodes, number_of_nodes+1]`:

å›¾ 6:å‰ 3 ä¸ªèŠ‚ç‚¹çš„çŸ©é˜µ N å†…å®¹

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ‡ç­¾(0 æˆ– 1)è¢«åˆ†é…ä¸º:

å›¾ 7:ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…æ ‡ç­¾çš„ä»£ç 

æœ€åï¼Œè„šæœ¬éšæœºé€‰å– 4 ä¸ªèŠ‚ç‚¹ä½œä¸ºç›‘ç£è®­ç»ƒçš„æ ‡è®°èŠ‚ç‚¹ã€‚

## 2.ä»çŸ©é˜µåˆ° GNN è¾“å…¥

[](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/prepare_GNN.py) [## ä¸» ste boss/learn_graph_ml/prepare _ gnn . py ä¸Šçš„ learn _ graph _ ml

### ä» 2009 å¹´åˆ°ç°åœ¨çš„ä¸€æ¬¡é•¿é€”æ—…è¡Œï¼Œå¸¦ç€å›¾è¡¨- learn_graph_ml/prepare_GNN.py åœ¨ Steboss å¤§å¸ˆ/learn_graph_ml

github.com](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/prepare_GNN.py) 

`prepare_GNN.py`å¸®åŠ©ä»`E`å’Œ`N`çŸ©é˜µåˆ›å»ºç¥ç»ç½‘ç»œçš„è¾“å…¥ã€‚

ç¬¬ä¸€ä¸ªè¾“å‡ºæ˜¯`inp`çŸ©é˜µã€‚[ç¬¬ 22â€“36 è¡Œæ˜¾ç¤ºäº†å¦‚ä½•åˆ›å»ºè¾“å…¥](https://github.com/Steboss/learn_graph_ml/blob/9f4868264d41f44495f0acf7e8a8d6d890d4e2c4/Scarselli_GNN/prepare_GNN.py#L22)çŸ©é˜µï¼Œå®ƒæ˜¯è¾¹çŸ©é˜µ`E`å’ŒèŠ‚ç‚¹ç‰¹å¾`N.`çš„ä¸²è”ï¼Œæœ€ç»ˆå†…å®¹æ˜¯`[source_node, destination_node, source_features, destination_features]`ã€‚ä¾‹å¦‚ï¼Œå¯¹äºç¬¬ä¸€æ¡è¾¹ï¼Œåœ¨èŠ‚ç‚¹ 0 å’Œ 1 ä¹‹é—´ï¼Œ`inp`çš„å†…å®¹æ˜¯:

å›¾ 8:èŠ‚ç‚¹ 0 å’Œ 1 çš„ GNN çš„è¾“å…¥çŸ©é˜µã€‚å‰ä¸¤ä¸ªæ•°å­—æŒ‡çš„æ˜¯èŠ‚ç‚¹ 0 å’Œ 1ï¼Œæ¥ç€æ˜¯èŠ‚ç‚¹ 0 çš„åŠŸèƒ½[1ï¼Œ0ï¼Œ0ï¼Œâ€¦]å’ŒèŠ‚ç‚¹ 1 çš„åŠŸèƒ½[0ï¼Œ1ï¼Œ0ï¼Œâ€¦]

[ç¬¬äºŒä¸ªè¾“å‡ºæ˜¯](https://github.com/Steboss/learn_graph_ml/blob/9f4868264d41f44495f0acf7e8a8d6d890d4e2c4/Scarselli_GNN/prepare_GNN.py#L46) `[arcnode](https://github.com/Steboss/learn_graph_ml/blob/9f4868264d41f44495f0acf7e8a8d6d890d4e2c4/Scarselli_GNN/prepare_GNN.py#L46)`ï¼Œä»¥`SparseMatrix`æ ¼å¼å¯¹è¾¹ç¼˜ä¿¡æ¯è¿›è¡Œç¼–ç ï¼Œå…¶å°ºå¯¸ä¸º`[number_of_nodes, number_of_edges]`(æœ¬ä¾‹ä¸­ä¸º 34x78)ã€‚ç¨€ç–æ ¼å¼å…è®¸èŠ‚çœå†…å­˜ï¼Œå¹¶ä¸”åªæ ‡è¯†å€¼ä¸º 1 çš„è¡Œåˆ—ç´¢å¼•å¯¹ï¼Œå¦åˆ™ä¸º 0ã€‚

## 3.å®šä¹‰è¾“å…¥å’Œè¾“å‡ºå‡½æ•°

[](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/input_and_output_functions.py) [## ä¸» ste boss/learn _ graph _ ml/input _ and _ output _ functions . py

### ä» 2009 å¹´åˆ°ç°åœ¨çš„ä¸€ä¸ªæ¼«é•¿çš„æ—…ç¨‹ï¼Œæœ‰å›¾-learn _ graph _ ml/input _ and _ output _ functions . py åœ¨ä¸»â€¦

github.com](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/input_and_output_functions.py) 

`input_and_output_functions.py`å°†åº•å±‚è½¬æ¢å’Œè¾“å‡ºå‡½æ•°å®šä¹‰ä¸º MLPã€‚`class Net`çš„æ ¸å¿ƒå‡½æ•°æ˜¯`netSt`å’Œ`netOut`ï¼Œåˆ†åˆ«ä¸º *fğ“Œ* å’Œ *gğ“Œ* åˆ›å»ºç¥ç»ç½‘ç»œï¼Œå®šä¹‰äº†ä¸€ä¸ª 2 å±‚ç¥ç»ç½‘ç»œã€‚`netSt`æ¥æ”¶ç»´æ•°ä¸º 70 çš„èŠ‚ç‚¹ç‰¹å¾ï¼Œå¹¶ä½¿ç”¨`tanh`æ¿€æ´»å‡½æ•°ï¼Œç”¨ 3 ä¸ªéšè—èŠ‚ç‚¹é‡æ–°æ˜ å°„è¿™äº›ç‰¹å¾ã€‚`netOut`å…·æœ‰ç±»ä¼¼çš„æ¶æ„ï¼Œå®ƒæ¥æ”¶ 2 ç»´è¾“å…¥ï¼Œé€šè¿‡ 3 ä¸ªèŠ‚ç‚¹é‡æ–°æ˜ å°„ï¼Œå¹¶åœ¨`softmax`åº”ç”¨åè¿”å›æœ€ç»ˆé¢„æµ‹è¾“å‡º:

å›¾ 9:å›¾å½¢ NN çš„è½¬æ¢å’Œè¾“å‡ºå‡½æ•°ã€‚

## 4.å‡ ä¹å‡†å¤‡å¥½äº†:ä¸» GNN

[](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/GNN.py) [## ä¸» ste boss/learn_graph_ml/gnn . py ä¸Šçš„ learn _ graph _ ml

### ä» 2009 å¹´åˆ°ç°åœ¨çš„æ¼«é•¿æ—…ç¨‹ï¼Œåœ¨ Steboss å¤§å¸ˆ/learn _ graph _ ml/gnn . py

github.com](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/GNN.py) 

æœ€åä¸€æ­¥æ˜¯`GNN.py`ï¼Œæˆ‘ä»¬å°†å®šä¹‰ç¥ç»ç½‘ç»œæ¶æ„åº”è¯¥å¦‚ä½•å·¥ä½œã€‚åŠŸèƒ½`convergence`ã€`condition`å’Œ`Loop`æ˜¯æ•´ä¸ªæ¶æ„çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œåœ¨è¿™é‡Œæ›´æ–°èŠ‚ç‚¹çš„çŠ¶æ€

è®­ç»ƒç¯èŠ‚ä»[è¡Œ 293](https://github.com/Steboss/learn_graph_ml/blob/9f4868264d41f44495f0acf7e8a8d6d890d4e2c4/Scarselli_GNN/GNN.py#L293) å¼€å§‹ï¼Œ`Loop`åŠŸèƒ½å°è£…åœ¨`self.loss_op`ä¸­ã€‚åœ¨ã€T23ã€[çº¿ 221](https://github.com/Steboss/learn_graph_ml/blob/9f4868264d41f44495f0acf7e8a8d6d890d4e2c4/Scarselli_GNN/GNN.py#L221) ï¼Œè¢«ç§°ä¸ºè¿è¡Œ`condition`å’Œ`convergence`ã€‚æœ€åä¸€ä¸ªå‡½æ•°æ›´æ–°å½“å‰èŠ‚ç‚¹çš„çŠ¶æ€:

å›¾ 10:æ›´æ–°èŠ‚ç‚¹çŠ¶æ€çš„å‡½æ•°æ”¶æ•›

å›¾ 10 ä¸­çš„`a[:,1]`æ˜¯è¾“å…¥çŸ©é˜µ`inp[:,1]`ï¼Œå³æ‰€æœ‰çš„`destination_node`ç´¢å¼•ã€‚`tf.gather`è¿”å›æ¯ä¸ªç›®çš„èŠ‚ç‚¹çš„æ‰€æœ‰`old_state`å€¼ï¼Œå¾—åˆ°ä¸€ä¸ª 78x2 çš„çŸ©é˜µï¼Œå…¶å€¼åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶ä¸ºé›¶â€”â€”å› ä¸º`old_state`æœ€åˆè¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªé›¶çŸ©é˜µï¼Œ`np.zeros((ArcNode.dense_shape[0], self.state_dim))` ( [è¡Œ 261](http://self.state: np.zeros((ArcNode.dense_shape[0], self.state_dim)),) )ã€‚

`sl = a[:, 2:]`è¿”å›æ‰€æœ‰çš„`source_node`å’Œ`destination_node`ç‰¹å¾(å°ºå¯¸ 78x68)ï¼Œç„¶åè¿æ¥ä¸º`inp`ç”¨äºè½¬æ¢ç¥ç»ç½‘ç»œåŠŸèƒ½ã€‚é€šè¿‡çŸ©é˜µä¹˜æ³•`sparse_tensor_dense_matmul`ç”¨è¾¹ç¼˜è¿æ¥æ›´æ–°æ¥è‡ª *fğ“Œ* çš„è¾“å‡ºçŠ¶æ€ã€‚æ–°çŠ¶æ€è¢«ä¼ å›`Loop`åŠŸèƒ½([è¡Œ 237](https://github.com/Steboss/learn_graph_ml/blob/9f4868264d41f44495f0acf7e8a8d6d890d4e2c4/Scarselli_GNN/GNN.py#L237) )ï¼Œç„¶åè¢«ç”¨ä½œ *gğ“Œ* è¾“å‡ºåŠŸèƒ½çš„è¾“å…¥:`out=self.net.netOut(stf)`

# ç©ºæ‰‹é“ä¿±ä¹éƒ¨åœ¨è¡ŒåŠ¨

æ‚¨ç°åœ¨å¯ä»¥è¿è¡Œ`karate.py`äº†ï¼ï¼ï¼

[](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/karate.py) [## å¸ˆçˆ¶ ste boss/learn _ graph _ ml/ç©ºæ‰‹é“. py

### ä» 2009 å¹´åˆ°ç°åœ¨çš„ä¸€æ¬¡é•¿é€”æ—…è¡Œï¼Œæœ‰å›¾è¡¨-learn _ graph _ ml/ç©ºæ‰‹é“. py åœ¨ Steboss å¤§å¸ˆ/learn_graph_ml

github.com](https://github.com/Steboss/learn_graph_ml/blob/master/Scarselli_GNN/karate.py) 

æœ€ç»ˆçš„è¾“å‡ºæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªæ˜¾è‘—çš„ä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°å›¾å½¢ç¥ç»ç½‘ç»œçš„åŠ›é‡ä»¥åŠå›¾å½¢å¦‚ä½•è¢«ç”¨ä½œæˆ‘ä»¬é¢„æµ‹çš„è¾“å…¥ã€‚

`karate.py`è„šæœ¬çš„ä¸»è¦éƒ¨åˆ†åœ¨[ç¬¬ 61 è¡Œ](https://github.com/Steboss/learn_graph_ml/blob/9f4868264d41f44495f0acf7e8a8d6d890d4e2c4/Scarselli_GNN/karate.py#L61)ï¼Œåœ¨æ­¤æ‰§è¡Œè®­ç»ƒæ­¥éª¤ã€‚å¦‚æœæ‚¨æƒ³å°†æœ€ç»ˆç»“æœä¿å­˜ä¸º`gif`ï¼Œå¦‚æœæ‚¨æƒ³åœ¨`tensorboard`ä¸­å¯è§†åŒ–ç¥ç»ç½‘ç»œç»“æœï¼Œè¿™æ˜¯æ‰“å¼€`tensorboard`çš„å‘½ä»¤ï¼Œå¸¦æœ‰æœ€ç»ˆè¾“å‡º:

```
venv/bin/tensorboard --logdir tmp/path/to/folder_with_out.tfevents
```

å°†æ‚¨çš„æµè§ˆå™¨è¿æ¥åˆ°`http://localhost:PORT`ï¼Œè¿™é‡Œç«¯å£è¢«å®šä¹‰ä¸ºç»ˆç«¯ä¸­çš„è¾“å‡ºï¼Œä»¥å……åˆ†å·¥ä½œ`tensorboard`

ä¸»è¾“å‡ºå½¢å¼`g.Train`æ˜¯`loop_val`ã€‚æ­¤å˜é‡æŠ¥å‘Š:

*   `loop_val[0]`èŠ‚ç‚¹çš„é¢„æµ‹å€¼
*   `loop_val[1]`ä¸ºæ›´æ–°çŠ¶æ€è€Œæ‰§è¡Œçš„è¿­ä»£æ¬¡æ•°
*   `loop_val[2]`å½“å‰èŠ‚ç‚¹çš„ä½ç½®
*   `loop_val[3]`èŠ‚ç‚¹çš„ç‰¹æ€§

å›¾ 11 å°†è®­ç»ƒè¿è¡ŒåŠ¨ç”»åŒ–ï¼Œä»æ²¡æœ‰èŠ‚ç‚¹é¢„æµ‹çš„åˆå§‹çŒœæµ‹ï¼Œç›´åˆ°èŠ‚ç‚¹ä¹‹é—´æœ‰çº¿æ€§é—´éš”çš„ç»“æŸã€‚

![](img/9b504b57ce152ad7ed84909542754de1.png)

å›¾ 11:åŸºäºæ¥è‡ª GraphNN çš„é¢„æµ‹ï¼Œé€šè¿‡æ—¶æœŸçš„èŠ‚ç‚¹ç»†åˆ†

ä»Šå¤©å°±åˆ°è¿™é‡Œå§ï¼è¯·ç»§ç»­å…³æ³¨å…³äºå›¾å½¢å’Œ ML çš„æ–°å¸–å­ï¼ï¼ï¼ï¼

*å¦‚æœæœ‰ä»»ä½•é—®é¢˜æˆ–æ„è§ï¼Œè¯·éšæ—¶å‘é€ç”µå­é‚®ä»¶è‡³:stefanobosisio1@gmail.com æˆ–ç›´æ¥å‘é€è‡³ Mediumã€‚*