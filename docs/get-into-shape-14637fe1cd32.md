# è¿›å…¥çŠ¶æ€ï¼ğŸ

> åŸæ–‡ï¼š<https://towardsdatascience.com/get-into-shape-14637fe1cd32?source=collection_archive---------0----------------------->

## å¡‘é€ å’Œé‡æ–°å¡‘é€  NumPy å’Œ pandas å¯¹è±¡ä»¥é¿å…é”™è¯¯

å½¢çŠ¶è¯¯å·®æ˜¯è®¸å¤šå­¦ä¹ æ•°æ®ç§‘å­¦çš„äººçš„ç¥¸æ ¹ã€‚æˆ‘æ•¢æ‰“èµŒï¼Œäººä»¬å·²ç»æ”¾å¼ƒäº†ä»–ä»¬çš„æ•°æ®ç§‘å­¦å­¦ä¹ ä¹‹æ—…ï¼Œå› ä¸ºæ— æ³•å°†æ•°æ®æ•´ç†æˆæœºå™¨å­¦ä¹ ç®—æ³•æ‰€éœ€çš„å½¢çŠ¶ã€‚

æ›´å¥½åœ°äº†è§£å¦‚ä½•é‡å¡‘æ‚¨çš„æ•°æ®å°†ä½¿æ‚¨ä¸å†æµæ³ªï¼ŒèŠ‚çœæ‚¨çš„æ—¶é—´ï¼Œå¹¶å¸®åŠ©æ‚¨æˆé•¿ä¸ºä¸€åæ•°æ®ç§‘å­¦å®¶ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°å¦‚ä½•ä»¥æ‚¨éœ€è¦çš„æ–¹å¼è·å–æ•°æ®ã€‚ğŸ‰

![](img/4e977ea290deaaf6bfb901eec6e40bf7.png)

é›…å…¸æœ‰è®¸å¤šè¡Œå’Œåˆ—ã€‚èµ„æ–™æ¥æº:pixabay.com

# æ­£åœ¨åš

é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç¡®ä¿ä½¿ç”¨ç›¸ä¼¼çš„åŒ…ç‰ˆæœ¬ã€‚è®©æˆ‘ä»¬ç”¨å®ƒä»¬é€šå¸¸çš„åˆ«åå¯¼å…¥æˆ‘ä»¬éœ€è¦çš„åº“ã€‚æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/discdiver/reshape)è·å¾—ã€‚

```
import sys
import numpy as np
import pandas as pd
import sklearn
from sklearn.preprocessing import OneHotEncoder
from sklearn.linear_model import LogisticRegression
```

å¦‚æœæ‚¨æ²¡æœ‰å®‰è£…æ‰€éœ€çš„åº“ï¼Œè¯·å–æ¶ˆå¯¹ä»¥ä¸‹å•å…ƒæ ¼çš„æ³¨é‡Šå¹¶è¿è¡Œå®ƒã€‚ç„¶åå†æ¬¡è¿è¡Œå•å…ƒæ ¼å¯¼å…¥ã€‚æ‚¨å¯èƒ½éœ€è¦é‡å¯æ‚¨çš„å†…æ ¸ã€‚

```
# !pip install -U numpy pandas scikit-learn
```

è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æˆ‘ä»¬çš„è½¯ä»¶åŒ…ç‰ˆæœ¬ã€‚

```
print(f"Python: {sys.version}")
print(f'NumPy: {np.__version__}')
print(f'pandas: {pd.__version__}')
print(f'scikit-learn: {sklearn.__version__}')Python: 3.8.5 (default, Sep  4 2020, 02:22:02) 
[Clang 10.0.0 ]
NumPy: 1.19.2
pandas: 1.2.0
scikit-learn: 0.24.0
```

# è§„æ¨¡

ç†ŠçŒ«[æ•°æ®å¸§](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html)æœ‰ä¸¤ä¸ªç»´åº¦:è¡Œå’Œåˆ—ã€‚

è®©æˆ‘ä»¬ç”¨ä¸€äº›é£“é£æ•°æ®åšä¸€ä¸ªå°å°çš„æ•°æ®æ¡†æ¶ã€‚

```
df_hurricanes = pd.DataFrame(dict(
    name=['Zeta', 'Andrew', 'Agnes'], 
    year=[2020, 1992, 1972 ]
))
df_hurricanes
```

![](img/17eae2cef4a25d534948632c6c869b6d.png)

æ‚¨å¯ä»¥ä½¿ç”¨ [*ndim*](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.ndim.html) å±æ€§æŸ¥çœ‹ç†ŠçŒ«æ•°æ®ç»“æ„çš„ç»´æ•°ã€‚

```
df_hurricanes.ndim2
```

ä¸€ä¸ªæ•°æ®å¸§æ—¢æœ‰è¡Œåˆæœ‰åˆ—ï¼Œæ‰€ä»¥å®ƒæœ‰ä¸¤ä¸ªç»´åº¦ã€‚

# å½¢çŠ¶

*å½¢çŠ¶*å±æ€§æ˜¾ç¤ºæ¯ä¸ªç»´åº¦ä¸­çš„é¡¹ç›®æ•°ã€‚æ£€æŸ¥æ•°æ®å¸§çš„[å½¢çŠ¶](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.shape.html)ä¼šè¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ•´æ•°çš„å…ƒç»„ã€‚ç¬¬ä¸€ä¸ªæ˜¯è¡Œæ•°ï¼Œç¬¬äºŒä¸ªæ˜¯åˆ—æ•°ã€‚ğŸ‘

```
df_hurricanes.shape(3, 2)
```

æˆ‘ä»¬æœ‰ä¸‰è¡Œä¸¤åˆ—ã€‚é…·æ¯™äº†ã€‚ğŸ˜

[*å¤§å°*](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.size.html#pandas.DataFrame.size) å±æ€§æ˜¾ç¤ºæˆ‘ä»¬æœ‰å¤šå°‘å•å…ƒæ ¼ã€‚

```
df_hurricanes.size6
```

3 * 2 = 6

ä» *shape* å±æ€§ä¸­å¾ˆå®¹æ˜“å¾—åˆ°ç»´åº¦å’Œå¤§å°çš„æ•°é‡ï¼Œæ‰€ä»¥è¿™æ˜¯æˆ‘ä»¬è¦è®°ä½å’Œä½¿ç”¨çš„ä¸€ä¸ªå±æ€§ã€‚ğŸš€

è®©æˆ‘ä»¬ä»æˆ‘ä»¬çš„æ•°æ®æ¡†æ¶åˆ¶ä½œä¸€ä¸ªç†ŠçŒ«ç³»åˆ—ã€‚ä½¿ç”¨*ä»…æ–¹æ‹¬å·*è¯­æ³•é€šè¿‡å°†åˆ—åä½œä¸ºå­—ç¬¦ä¸²ä¼ é€’æ¥é€‰æ‹©åˆ—ã€‚ä½ ä¼šå¾—åˆ°ä¸€ç³»åˆ—ã€‚

```
years_series = df_hurricanes['year']
years_series0    2020
1    1992
2    1972
Name: year, dtype: int64type(years_series)pandas.core.series.Series
```

ç†ŠçŒ«[ç³»åˆ—](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html)çš„å¤–å½¢æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨ç³»åˆ— [*å½¢çŠ¶*](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.shape.html) å±æ€§æ¥äº†è§£ä¸€ä¸‹ã€‚

```
years_series.shape(3,)
```

æˆ‘ä»¬æœ‰ä¸€ä¸ªåªæœ‰ä¸€ä¸ªå€¼çš„å…ƒç»„ï¼Œå³è¡Œæ•°ã€‚è¯·è®°ä½ï¼Œç´¢å¼•ä¸èƒ½ç®—ä½œä¸€åˆ—ã€‚â˜ï¸

å¦‚æœæˆ‘ä»¬å†æ¬¡åªä½¿ç”¨æ–¹æ‹¬å·ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œé™¤äº†è¿™æ¬¡æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªåŒ…å«å•ä¸ªåˆ—åçš„åˆ—è¡¨ï¼Ÿ

```
years_df = df_hurricanes[['year']]
years_df
```

![](img/6d65f8766c922c4b09532dbd157d018f.png)

```
type(years_df)pandas.core.frame.DataFrame
```

æˆ‘çš„å˜é‡åå¯èƒ½æ³„éœ²äº†ç­”æ¡ˆã€‚ğŸ˜‰å¦‚æœä½ ä¼ é€’ä¸€ä¸ªåˆ—ååˆ—è¡¨ï¼Œä½ æ€»æ˜¯å¾—åˆ°ä¸€ä¸ªæ•°æ®å¸§ã€‚

```
years_df.shape(3, 1)
```

**æ‹¿èµ°**:ç†ŠçŒ«ç³»åˆ—çš„é€ å‹å’Œä¸€æ ç†ŠçŒ«æ•°æ®æ¡†çš„é€ å‹æ˜¯ä¸ä¸€æ ·çš„ï¼æ•°æ®å¸§çš„å½¢çŠ¶ä¸º*è¡Œ*ä¹˜*åˆ—*ï¼Œç³»åˆ—çš„å½¢çŠ¶ä¸º*è¡Œ*ã€‚è¿™æ˜¯è®©äººçŠ¯é”™çš„å…³é”®ç‚¹ã€‚

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•åœ¨ç†ŠçŒ«èº«ä¸Šæ‰¾åˆ°*å½¢çŠ¶*ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ NumPyã€‚ç†ŠçŒ«æ‰©å±• NumPyã€‚

![](img/cdf56e85caa4d1e5fee534296d073798.png)

åˆ—ã€‚èµ„æ–™æ¥æº:pixabay.com

# NumPy

NumPy çš„ ndarray æ˜¯å®ƒçš„æ ¸å¿ƒæ•°æ®ç»“æ„â€”â€”ä»ç°åœ¨å¼€å§‹æˆ‘ä»¬å°±æŠŠå®ƒç§°ä¸ºæ•°ç»„ã€‚æ ¹æ®æ‚¨çš„ç›®æ ‡ï¼Œæœ‰è®¸å¤šæ–¹æ³•å¯ä»¥åˆ›å»º NumPy æ•°ç»„ã€‚ç‚¹å‡»æŸ¥çœ‹æˆ‘çš„ä¸»é¢˜[æŒ‡å—ã€‚](/the-ten-best-ways-to-create-numpy-arrays-8b1029a972a7)

è®©æˆ‘ä»¬ä»æ•°æ®å¸§ä¸­åˆ›å»ºä¸€ä¸ª NumPy æ•°ç»„ï¼Œå¹¶æ£€æŸ¥å®ƒçš„å½¢çŠ¶ã€‚

```
two_d_arr = df_hurricanes.to_numpy()
two_d_arrarray([['Zeta', 2020],
       ['Andrew', 1992],
       ['Agnes', 1972]], dtype=object)type(two_d_arr)numpy.ndarraytwo_d_arr.shape(3, 2)
```

è¿”å›çš„å½¢çŠ¶ä¸æˆ‘ä»¬ä½¿ç”¨ç†ŠçŒ«æ—¶çœ‹åˆ°çš„å½¢çŠ¶ç›¸åŒ¹é…ã€‚ç†ŠçŒ«å’Œ NumPy å…±äº«ä¸€äº›å±æ€§å’Œæ–¹æ³•ï¼ŒåŒ…æ‹¬*å½¢çŠ¶*å±æ€§ã€‚

è®©æˆ‘ä»¬å°†ä¹‹å‰åˆ¶ä½œçš„ç†ŠçŒ«ç³»åˆ—è½¬æ¢æˆ NumPy æ•°ç»„ï¼Œå¹¶æ£€æŸ¥å…¶å½¢çŠ¶ã€‚

```
one_d_arr = years_series.to_numpy()
one_d_arrarray([2020, 1992, 1972])type(one_d_arr)numpy.ndarrayone_d_arr.shape(3,)
```

åŒæ ·ï¼Œæˆ‘ä»¬åœ¨ç†ŠçŒ«å’Œç†ŠçŒ«èº«ä¸Šçœ‹åˆ°äº†åŒæ ·çš„ç»“æœã€‚é…·ï¼

![](img/a21fc450dd56f650840a472dc71a617d.png)

è¡Œå’Œåˆ—ã€‚èµ„æ–™æ¥æº:pixabay.com

# é—®é¢˜æ˜¯

å½“ä¸€ä¸ªå¯¹è±¡æœŸæœ›æ•°æ®ä»¥æŸç§å½¢å¼åˆ°è¾¾æ—¶ï¼Œäº‹æƒ…å°±å˜å¾—æ£˜æ‰‹äº†ã€‚ä¾‹å¦‚ï¼Œå¤§å¤šæ•° scikit-learn å˜å‹å™¨å’Œä¼°ç®—å™¨éƒ½å¸Œæœ›è·å¾—äºŒç»´å½¢å¼çš„é¢„æµ‹ X æ•°æ®ã€‚ç›®æ ‡å˜é‡ y åº”è¯¥æ˜¯ä¸€ç»´çš„ã€‚è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªæ„šè ¢çš„ä¾‹å­æ¥æ¼”ç¤ºå¦‚ä½•æ”¹å˜å½¢çŠ¶ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨*å¹´*æ¥é¢„æµ‹é£“é£åç§°ã€‚

æˆ‘ä»¬å°†ä½¿ *x* å°å†™ï¼Œå› ä¸ºå®ƒåªæœ‰ä¸€ç»´ã€‚

```
x = df_hurricanes['year']
x0    2020
1    1992
2    1972
Name: year, dtype: int64type(x)pandas.core.series.Seriesx.shape(3,)
```

æˆ‘ä»¬çš„è¾“å‡ºå˜é‡ *y* ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

```
y = df_hurricanes['name']
y0      Zeta
1    Andrew
2     Agnes
Name: name, dtype: objecttype(y)pandas.core.series.Seriesy.shape(3,)
```

è®©æˆ‘ä»¬å®ä¾‹åŒ–å¹¶æ‹Ÿåˆä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹ã€‚

```
lr = LogisticRegression()
lr.fit(x, y)
```

ä½ ä¼šå¾—åˆ°ä¸€ä¸ªå€¼é”™è¯¯ã€‚æœ€åå‡ è¡Œå†™é“:

```
ValueError: Expected 2D array, got 1D array instead:
array=[2020\. 1992\. 1972.].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
```

è®©æˆ‘ä»¬è¯•ç€æŒ‰ç…§é”™è¯¯æ¶ˆæ¯çš„æŒ‡ç¤ºå»åš:

```
x.reshape(-1, 1)
```

å¦‚æœä½ é€šè¿‡ä¸€ä¸ª NumPy æ•°ç»„ï¼Œæ•´å½¢æ˜¯å¾ˆæ£’çš„ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡äº†ä¸€ä¸ª pandas ç³»åˆ—ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†å¦ä¸€ä¸ªé”™è¯¯:

```
AttributeError: 'Series' object has no attribute 'reshape'
```

æˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬çš„ç³»åˆ—å˜æˆä¸€ä¸ª NumPy æ•°ç»„ï¼Œç„¶åæŠŠå®ƒé‡æ–°åšæˆäºŒç»´çš„ã€‚ç„¶è€Œï¼Œæ­£å¦‚ä½ åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•å¯ä»¥è®© *x* æˆä¸º 2D å¯¹è±¡ã€‚åªéœ€ä½¿ç”¨*æ–¹æ‹¬å·*è¯­æ³•å°†åˆ—ä½œä¸ºåˆ—è¡¨ä¼ é€’ã€‚

æˆ‘å°†ç»“æœè®¾ä¸ºå¤§å†™ *X* ï¼Œå› ä¸ºè¿™å°†æ˜¯ä¸€ä¸ª 2D æ•°ç»„â€”â€”å¤§å†™å­—æ¯æ˜¯ 2D æ•°ç»„(ä¹Ÿç§°ä¸º*çŸ©é˜µ*)çš„ç»Ÿè®¡å‘½åçº¦å®šã€‚

æˆ‘ä»¬å¼€å§‹å§ï¼

```
X = df_hurricanes[['year']]
X
```

![](img/6d65f8766c922c4b09532dbd157d018f.png)

```
type(X)pandas.core.frame.DataFrameX.shape(3, 1)
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥å‡†ç¡®æ— è¯¯åœ°æ‹Ÿåˆæˆ‘ä»¬çš„æ¨¡å‹äº†ï¼ğŸ˜

```
lr.fit(X, y)LogisticRegression()
```

# é‡å¡‘ NumPy æ•°ç»„

å¦‚æœæˆ‘ä»¬çš„æ•°æ®å­˜å‚¨åœ¨ 1D NumPy æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŒ‰ç…§é”™è¯¯æ¶ˆæ¯çš„å»ºè®®ï¼Œç”¨`reshape`å°†å®ƒè½¬æ¢æˆ 2D æ•°ç»„ã€‚è®©æˆ‘ä»¬ç”¨ä¹‹å‰ä¿å­˜ä¸º 1D NumPy æ•°ç»„çš„æ•°æ®æ¥å°è¯•ä¸€ä¸‹ã€‚

```
one_d_arrarray([2020, 1992, 1972])one_d_arr.shape(3,)
```

è®©æˆ‘ä»¬é‡å¡‘å®ƒï¼

```
hard_coded_arr_shape = one_d_arr.reshape(3, 1)
hard_coded_arr_shapearray([[2020],
       [1992],
       [1972]])hard_coded_arr_shape.shape(3, 1)
```

ä¼ é€’ä¸€ä¸ªæ­£æ•´æ•°æ„å‘³ç€*ç»™å‡ºé‚£ä¸ªç»´åº¦çš„å½¢çŠ¶*ã€‚æ‰€ä»¥ç°åœ¨æˆ‘ä»¬çš„æ•°ç»„æœ‰äº†å½¢çŠ¶ *3ï¼Œ1* ã€‚

ç„¶è€Œï¼Œä½¿ç”¨çµæ´»ã€åŠ¨æ€çš„é€‰é¡¹æ˜¯æ›´å¥½çš„ç¼–ç å®è·µã€‚æ‰€ä»¥è¿˜æ˜¯ç”¨ *-1* æ­é…*å§ã€‚shape()* ã€‚

```
two_d_arr_from_reshape = one_d_arr.reshape(-1, 1)
two_d_arr_from_reshapearray([[2020],
       [1992],
       [1972]])two_d_arr_from_reshape.shape(3, 1)
```

è®©æˆ‘ä»¬è§£å¼€ä»£ç ã€‚æˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ª *1* ï¼Œæ‰€ä»¥ç¬¬äºŒç»´åº¦â€”â€”åˆ—â€”â€”å¾—åˆ°äº† 1ã€‚

æˆ‘ä»¬ä¸ºå¦ä¸€ä¸ªç»´åº¦ä¼ é€’äº†ä¸€ä¸ªè´Ÿæ•´æ•°ã€‚è¿™æ„å‘³ç€å‰©ä½™çš„ç»´åº¦å˜æˆäº†ä¿å­˜æ‰€æœ‰åŸå§‹æ•°æ®æ‰€éœ€çš„ä»»ä½•å½¢çŠ¶ã€‚

æŠŠ *-1* æƒ³è±¡æˆ*å¡«ç©ºåšä¸€ä¸ªç»´åº¦è®©æ‰€æœ‰çš„æ•°æ®éƒ½æœ‰ä¸ªå®¶*ã€‚ğŸ 

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æœ€ç»ˆå¾—åˆ°ä¸€ä¸ª 3 è¡Œ 1 åˆ—çš„ 2D æ•°ç»„ã€‚ *-1* å–å€¼ *3* ã€‚

è®©æˆ‘ä»¬çš„ä»£ç å˜å¾—çµæ´»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µï¼Œè¿™æ ·å®ƒå°±å¯ä»¥å¤„ç†æˆ‘ä»¬å‘å®ƒæŠ›å‡ºçš„ä»»ä½•è§‚å¯Ÿã€‚æ‰€ä»¥ä¸è¦ç¡¬ç¼–ç ä¸¤ä¸ªç»´åº¦ï¼Œä½¿ç”¨`-1`ã€‚ğŸ™‚

![](img/a98bcc46e34fa2d824ff0092217acfdf.png)

èµ„æ–™æ¥æº:pixabay.com

# é«˜ç»´æ•°ç»„

åŒæ ·çš„åŸç†å¯ä»¥ç”¨äºæ•´å½¢æ›´é«˜ç»´çš„é˜µåˆ—ã€‚æˆ‘ä»¬å…ˆåšä¸€ä¸ªä¸‰ç»´æ•°ç»„ï¼Œç„¶åå†æŠŠå®ƒé‡å¡‘æˆå››ç»´æ•°ç»„ã€‚

```
two_d_arrarray([['Zeta', 2020],
       ['Andrew', 1992],
       ['Agnes', 1972]], dtype=object)two_d_arr.shape(3, 2)three_d_arr = two_d_arr.reshape(2, 1, 3)
three_d_arrarray([[['Zeta', 2020, 'Andrew']],

       [[1992, 'Agnes', 1972]]], dtype=object)
```

ä½¿ç”¨ *-1* ï¼ŒæŒ‡ç¤ºåº”è¯¥è®¡ç®—å“ªä¸ªå°ºå¯¸ï¼Œä»¥å‡†ç¡®åœ°ç»™å‡ºæ‰€æœ‰æ•°æ®çš„ä½ç½®ã€‚

```
arr = two_d_arr.reshape(1, 2, -1, 1)
arrarray([[[['Zeta'],
         [2020],
         ['Andrew']],

        [[1992],
         ['Agnes'],
         [1972]]]], dtype=object)
```

æ³¨æ„ï¼Œå¦‚æœ*æ•´å½¢*å°ºå¯¸æ²¡æœ‰æ„ä¹‰ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚åƒè¿™æ ·:

```
two_d_arr.reshape(4, -1)
two_d_arr--------------------------------------------------------------------

ValueError: cannot reshape array of size 6 into shape (4,newaxis)
```

æˆ‘ä»¬æœ‰å…­ä¸ªå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å°†æ•°ç»„è°ƒæ•´ä¸ºæ°å¥½èƒ½å®¹çº³å…­ä¸ªå€¼çš„ç»´æ•°ã€‚

æ¢å¥è¯è¯´ï¼Œç»´æ•°å¿…é¡»å½¢æˆä¹˜ç§¯*çš„å…­ä¸ª*ã€‚è®°ä½ *-1* å°±åƒä¸€ä¸ªå¯ä»¥å˜æˆä»»æ„æ•´æ•°å€¼çš„é€šé…ç¬¦ã€‚

# é¢„æµ‹

Scikit-learn å¸Œæœ›å¤§å¤šæ•°é¢„æµ‹éƒ½ä½¿ç”¨ 2D é˜µåˆ—ã€‚

å‡è®¾åˆ—è¡¨ä¸­æœ‰ä¸€ä¸ªæ ·æœ¬ï¼Œæ‚¨æƒ³ç”¨å®ƒæ¥è¿›è¡Œé¢„æµ‹ã€‚æ‚¨å¯èƒ½ä¼šå¤©çœŸåœ°è®¤ä¸ºä¸‹é¢çš„ä»£ç å¯ä»¥å·¥ä½œã€‚

```
lr.predict(np.array([2012]))
```

å¹¶æ²¡æœ‰ã€‚â˜¹ï¸

```
ValueError: Expected 2D array, got 1D array instead:
array=[2012].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
```

ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æœ‰å¸®åŠ©çš„é”™è¯¯å»ºè®®ï¼Œç”¨`reshape(1, -1)`åšä¸€ä¸ªäºŒç»´æ•°ç»„ã€‚

```
lr.predict(np.array([2012]).reshape(1, -1))array(['Zeta'], dtype=object)np.array([2012]).reshape(1, -1).shape(1, 1)
```

æ‚¨å·²ç»ä½¿ç¬¬ä¸€ä¸ªç»´åº¦(è¡Œ) *1* å’Œç¬¬äºŒä¸ªç»´åº¦(åˆ—)ä¸ç‰¹å¾æ•°é‡ *1* ç›¸åŒ¹é…ã€‚é…·ï¼

ä¸è¦å®³æ€•æ£€æŸ¥ä¸€ä¸ªç‰©ä½“çš„å½¢çŠ¶â€”â€”å³ä½¿åªæ˜¯ç¡®è®¤å®ƒæ˜¯ä½ æ‰€æƒ³çš„é‚£æ ·ã€‚ğŸ™‚

å½“æˆ‘ä»¬è®¨è®º scikit-learn çš„æ•´å½¢ä¸»é¢˜æ—¶ï¼Œè¯·æ³¨æ„æ–‡æœ¬çŸ¢é‡åŒ–è½¬æ¢å™¨ï¼Œå¦‚ [CountVectorizer](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html) çš„è¡Œä¸ºä¸å…¶ä»– scikit-learn è½¬æ¢å™¨ä¸åŒã€‚ä»–ä»¬å‡è®¾ä½ åªæœ‰ä¸€åˆ—æ–‡æœ¬ï¼Œæ‰€ä»¥ä»–ä»¬æœŸæœ›ä¸€ä¸ª 1D æ•°ç»„è€Œä¸æ˜¯ 2D æ•°ç»„ã€‚ä½ å¯èƒ½éœ€è¦é‡å¡‘ã€‚âš ï¸

# åˆ¶ä½œ 1D é˜µåˆ—çš„å…¶ä»–æ–¹æ³•

é™¤äº†ç”¨`reshape`æ•´å½¢ï¼ŒNumPy çš„`flatten`å’Œ`ravel`éƒ½è¿”å›ä¸€ä¸ª 1D æ•°ç»„ã€‚åŒºåˆ«åœ¨äºå®ƒä»¬æ˜¯åˆ›å»ºåŸå§‹é˜µåˆ—çš„æ‹·è´è¿˜æ˜¯è§†å›¾ï¼Œä»¥åŠæ•°æ®æ˜¯å¦è¿ç»­å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚æŸ¥çœ‹[è¿™ä¸ª](https://stackoverflow.com/a/28930580/4590385)ä¸é”™çš„å †æ ˆæº¢å‡ºç­”æ¡ˆäº†è§£æ›´å¤šä¿¡æ¯ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å°† 2D æ•°ç»„å‹ç¼©æˆ 1D æ•°ç»„çš„å¦ä¸€ç§æ–¹æ³•ã€‚

![](img/1e9d13d21a7a48f6be2e180b9d4f78e2.png)

æŒ¤å‹é‡å¡‘ã€‚èµ„æ–™æ¥æº:pixabay.com

# æŒ¤å‡ºä¸éœ€è¦çš„ç»´åº¦

å½“ä½ æœ‰ä¸€ä¸ªå¤šç»´æ•°ç»„ï¼Œä½†å…¶ä¸­ä¸€ä¸ªç»´åº¦ä¸åŒ…å«ä»»ä½•æ–°ä¿¡æ¯æ—¶ï¼Œä½ å¯ä»¥ç”¨`.squeeze()`å°†*æŒ¤å‡ºä¸å¿…è¦çš„ç»´åº¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç”¨ä¹‹å‰åšçš„æ•°ç»„ã€‚*

```
two_d_arr_from_reshapearray([[2020],
       [1992],
       [1972]])two_d_arr_from_reshape.shape(3, 1)squeezed = np.squeeze(two_d_arr_from_reshape)squeezed.shape(3,)
```

å“’å“’ï¼

è¯·æ³¨æ„ï¼ŒTensorFlow å’Œ PyTorch åº“ä¸ NumPy é…åˆå¾—å¾ˆå¥½ï¼Œå¯ä»¥å¤„ç†è¡¨ç¤ºè§†é¢‘æ•°æ®ç­‰å†…å®¹çš„é«˜ç»´æ•°ç»„ã€‚å°†æ•°æ®è½¬æ¢æˆç¥ç»ç½‘ç»œè¾“å…¥å±‚æ‰€éœ€çš„å½¢çŠ¶æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ¥æºã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„å·¥å…·å°†æ•°æ®è°ƒæ•´åˆ°æ‰€éœ€çš„ç»´åº¦ã€‚ğŸš€

# åŒ…è£…

æ‚¨å·²ç»çœ‹åˆ°äº†å¦‚ä½•é‡å¡‘ NumPy æ•°ç»„ã€‚å¸Œæœ›æ‚¨çœ‹åˆ°çš„æœªæ¥ä»£ç ä¼šæ›´æœ‰æ„ä¹‰ï¼Œæ‚¨å°†èƒ½å¤Ÿå¿«é€Ÿåœ°å°† NumPy æ•°ç»„å¤„ç†æˆæ‚¨éœ€è¦çš„å½¢çŠ¶ã€‚

å¦‚æœä½ è§‰å¾—è¿™ç¯‡å…³äºé‡å¡‘ NumPy æ•°ç»„çš„æ–‡ç« å¾ˆæœ‰å¸®åŠ©ï¼Œè¯·åœ¨ä½ æœ€å–œæ¬¢çš„ç¤¾äº¤åª’ä½“ä¸Šåˆ†äº«ã€‚ğŸ˜€

æˆ‘å¸®åŠ©äººä»¬å­¦ä¹ å¦‚ä½•ç”¨ Pythonã€ç†ŠçŒ«å’Œå…¶ä»–å·¥å…·æ¥å¤„ç†æ•°æ®ã€‚å¦‚æœä½ è§‰å¾—è¿™å¬èµ·æ¥å¾ˆé…·ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„å…¶ä»–[æŒ‡å—](https://medium.com/@jeffhale)å¹¶åŠ å…¥æˆ‘åœ¨ Medium ä¸Šçš„ 15ï¼Œ000 å¤šåç²‰ä¸ï¼Œè·å–æœ€æ–°å†…å®¹ã€‚

![](img/7a977a980f2cb93d7c796fd794225721.png)

å¿«ä¹é‡å¡‘ï¼ğŸ”µğŸ”·