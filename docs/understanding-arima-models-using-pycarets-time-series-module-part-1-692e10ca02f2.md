# ä½¿ç”¨ PyCaret çš„ ARIMA æ¨¡å‹å®ç”¨æŒ‡å—â€”ç¬¬ 1 éƒ¨åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/understanding-arima-models-using-pycarets-time-series-module-part-1-692e10ca02f2?source=collection_archive---------8----------------------->

## å¥ å®šç»Ÿè®¡åŸºç¡€

![](img/1fffa640eff2567fe7b4b928c63ee2ca.png)

ç”±[é˜¿æ ¼å·´æ´›æ–¯](https://unsplash.com/@agebarros?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

# ğŸ“š**ç®€ä»‹**

PyCaret æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„å¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚è¿™æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ å’Œæ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æˆå€åœ°åŠ å¿«å®éªŒå‘¨æœŸï¼Œæé«˜æ‚¨çš„å·¥ä½œæ•ˆç‡ã€‚

PyCaret æœ€è¿‘å‘å¸ƒäº†ä¸€ä¸ªæ—¶é—´åºåˆ—æ¨¡å—ï¼Œå®ƒé™„å¸¦äº†è®¸å¤šæ–¹ä¾¿çš„ç‰¹æ€§ï¼Œä½¿å¾—æ—¶é—´åºåˆ—å»ºæ¨¡å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚ä½ å¯ä»¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­äº†è§£æ›´å¤šã€‚

</announcing-pycarets-new-time-series-module-b6e724d4636c>  

åœ¨è¿™ä¸ªç”±å¤šä¸ªéƒ¨åˆ†ç»„æˆçš„ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹è®¨è®ºå¦‚ä½•ä½¿ç”¨ PyCaret è¿™æ ·çš„â€œä½ä»£ç â€åº“æ¥æ›´æ·±å…¥åœ°ç†è§£ ARIMA æ¨¡å‹çš„å·¥ä½œåŸç†ã€‚åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹ ARIMA æ¨¡å‹åŠå…¶å‚æ•°è¿›è¡Œæ¦‚è¿°ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä»ä¸€ä¸ªç®€å•çš„ ARIMA æ¨¡å‹å¼€å§‹ï¼Œä¸ºè¿™ä¸ªæ¨¡å‹çš„é¢„æµ‹å’Œé¢„æµ‹åŒºé—´åˆ›å»ºä¸€ä¸ªç†è®ºæ¡†æ¶ï¼Œä»¥å‘å±•å¯¹å…¶å·¥ä½œçš„ç›´è§‰ã€‚æœ€åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyCaret æ„å»ºè¿™ä¸ª ARIMA æ¨¡å‹ï¼Œå¹¶å°†ç†è®ºè®¡ç®—ä¸æ¨¡å‹è¾“å‡ºè¿›è¡Œæ¯”è¾ƒã€‚å°†æ¨¡å‹çš„è¾“å‡ºä¸æˆ‘ä»¬çš„ç†è®ºæ¡†æ¶è”ç³»èµ·æ¥ï¼Œæœ‰æœ›åŠ æ·±æˆ‘ä»¬å¯¹æ¨¡å‹çš„ç†è§£ï¼Œå¹¶ä¸ºåç»­æ–‡ç« ä¸­æ›´è¯¦ç»†çš„åˆ†æå¥ å®šåŸºç¡€ã€‚

# ğŸ“–å»ºè®®çš„å…ˆå‰é˜…è¯»

æœ¬æ–‡æ¨èç»™é‚£äº›å¯¹æ—¶é—´åºåˆ—æœ‰åŸºæœ¬äº†è§£(ä¾‹å¦‚ï¼Œå­£èŠ‚æ€§ã€è‡ªç›¸å…³ ACFã€ç™½å™ªå£°ã€è®­ç»ƒ-æµ‹è¯•-åˆ†å‰²ç­‰æ¦‚å¿µ)ä½†æœ‰å…´è¶£äº†è§£æ›´å¤š ARIMA æ¨¡å‹çš„äººã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™äº›æ¦‚å¿µï¼Œæˆ‘å»ºè®®ä½ å…ˆé˜…è¯»è¿™äº›çŸ­æ–‡ã€‚è¿™å°†æœ‰åŠ©äºç†è§£è¿™ç¯‡æ–‡ç« ã€‚

ğŸ‘‰[æ—¶é—´åºåˆ—ä¸­çš„å­£èŠ‚æ€§å’Œè‡ªç›¸å…³æ€§](https://github.com/pycaret/pycaret/discussions/1765)

ğŸ‘‰[ä»€ä¹ˆæ˜¯ã€Œç™½å™ªéŸ³ã€](https://github.com/pycaret/pycaret/discussions/1800)ï¼Ÿ

ğŸ‘‰[æ—¶é—´åºåˆ—äº¤å‰éªŒè¯](https://github.com/pycaret/pycaret/discussions/1761)

# **1ï¸âƒ£ ARIMA æ¨¡å‹æ¦‚è¿°**

ARIMA æ˜¯ä¸€ä¸ªç»å…¸çš„æ—¶é—´åºåˆ—æ¨¡å‹ï¼Œç”¨äºæ¨¡æ‹Ÿæ—¶æ€æ•°æ®çš„è‡ªå›å½’ç‰¹æ€§ã€‚è‡ªå›å½’æ„å‘³ç€ä¾èµ–äºè‡ªèº«è¿‡å»çš„å€¼ã€‚æ—¶é—´åºåˆ—å¯èƒ½ä¾èµ–äº(1)å…¶æœ€è¿‘çš„è¿‡å»å€¼ï¼Œæˆ–è€…(2)å¯èƒ½è¡¨ç°å‡ºå­£èŠ‚æ€§è¡Œä¸ºï¼Œå¹¶åœ¨ä¸€å®šæ•°é‡çš„æ—¶é—´ç‚¹è¿‡å»åé‡å¤è‡ªèº«ã€‚

ç›´è§‚ä¸Šï¼Œ(1)çš„ä¸€ä¸ªä¾‹å­æ˜¯è‚¡ç¥¨æ•°æ®ã€‚è¿™æ˜¯æ—¶é—´æ•°æ®ï¼Œæ˜å¤©çš„ä»·æ ¼å—ä»Šå¤©(æˆ–æœ€è¿‘çš„è¿‡å»)ä»·æ ¼çš„å½±å“å¾ˆå¤§ï¼Œè€Œä¸ä¸€ä¸ªæœˆæˆ–ä¸€å¹´å‰å‘ç”Ÿçš„äº‹æƒ…æ²¡æœ‰å¤ªå¤§å…³ç³»ã€‚ç±»ä¼¼åœ°,( 2)çš„ä¸€ä¸ªä¾‹å­å¯ä»¥æ˜¯åœ¨é›¶å”®åº—é”€å”®å†¬è£…ã€‚è¿™é€šå¸¸åœ¨å†¬å­£å‰è¾¾åˆ°é«˜å³°ï¼Œåœ¨å¤å­£é€æ¸å‡å¼±ã€‚å› æ­¤ï¼Œå®ƒè¡¨ç°å‡ºå­£èŠ‚æ€§æ¨¡å¼ã€‚ä»Šå¹´å†¬å¤©çš„é”€å”®é¢å°†ä¸å»å¹´å†¬å¤©çš„é”€å”®é¢é«˜åº¦ç›¸å…³ã€‚

ç°åœ¨æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä¸€äº›åŸºæœ¬çš„ä¾‹å­ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯å¦‚ä½•åœ¨æ¨¡å‹ä¸­è¡¨ç¤ºçš„ã€‚ç»å…¸çš„ ARIMA æ¨¡å‹æœ‰å‡ ä¸ªè¶…å‚æ•°ï¼Œä½†æˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨å…¶ä¸­çš„ä¸¤ä¸ªä¸»è¦å‚æ•°â€” `order`å’Œ`seasonal_order`ã€‚

```
**order:** iterable or array-like, shape=(3,), optional (default=(1, 0, 0))
The (p,d,q) order of the model for the number of AR parameters,     differences, and MA parameters to use.**seasonal_order:** array-like, shape=(4,), optional (default=(0, 0, 0, 0))
The (P,D,Q,s) order of the seasonal component of the model for the     AR parameters, differences, MA parameters, and periodicity.
```

ç°åœ¨ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“è¿™äº›æœ¯è¯­ä¸æˆ‘ä»¬ä¸Šé¢å¼ºè°ƒçš„ä¾‹å­æœ‰ä»€ä¹ˆè”ç³»ï¼Œä»¥åŠ`order`å’Œ`seasonal_order`ä¸­çš„ä¸‰ä¸ªå’Œå››ä¸ªæœ¯è¯­åˆ†åˆ«æ˜¯ä»€ä¹ˆæ„æ€ã€‚åœ¨éå¸¸é«˜çš„å±‚æ¬¡ä¸Šï¼Œ`order`ä¸ä¸Šé¢çš„ä¾‹å­(1)ç›¸å…³ï¼Œå…¶ä¸­ä¸‹ä¸€ä¸ªå€¼ä¸ç´§æ¥çš„å‰ä¸€ä¸ªå€¼å¼ºç›¸å…³ã€‚`seasonal_order`ä¸ä¸Šé¢çš„ç¤ºä¾‹(2)ç›¸å…³ï¼Œå…¶ä¸­ä¸‹ä¸€ä¸ªå€¼ä¸è¿‡å»ä¸€ä¸ªæˆ–å¤šä¸ªå­£èŠ‚çš„æ•°æ®ç›¸å…³ã€‚

ä½†è¿™ä»ç„¶æ²¡æœ‰å›ç­”ä»€ä¹ˆæ˜¯`(p, d, q)`å’Œ`(P, D, Q, s)`çš„é—®é¢˜ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬å°†åœ¨è¿™ä¸€ç³»åˆ—æ–‡ç« ä¸­è¯•å›¾å›ç­”çš„é—®é¢˜ã€‚

æ³¨æ„:æœ¬ç³»åˆ—æ–‡ç« é‡‡ç”¨â€œä»£ç ä¼˜å…ˆâ€çš„æ–¹æ³•æ¥ç†è§£ ARIMA æ¨¡å‹ã€‚æˆ‘å¼ºçƒˆå»ºè®®è¯»è€…ä¹Ÿå‚è€ƒ[5]ï¼Œä»¥ä¾¿ä»ç†è®ºè§’åº¦æ›´å¥½åœ°ç†è§£ã€‚

# 2ï¸âƒ£åŸºçº¿ ARIMA æ¨¡å‹

ä¸ºäº†æ›´å¥½åœ°ç†è§£ ARIMA æ¨¡å‹çš„å„ç§è¶…å‚æ•°ï¼Œè®©æˆ‘ä»¬ä»ä¸€ä¸ªéå¸¸ç®€å•çš„ ARIMA æ¨¡å‹å¼€å§‹â€”â€”ä¸€ä¸ªæ²¡æœ‰ä»»ä½•è‡ªå›å½’å±æ€§çš„æ¨¡å‹ã€‚è¿™é€šå¸¸ç”¨äºè¡¨ç¤ºç™½å™ªå£°(å³æ•°æ®ä¸­æ²¡æœ‰ä»»ä½•ä¿¡å·)ã€‚ä½ å¯ä»¥åœ¨[1]å’Œ[2]ä¸­æ‰¾åˆ°æ›´å¤šå…³äºå®ƒçš„ä¿¡æ¯ã€‚è¯¥æ¨¡å‹ç”±ä»¥ä¸‹è¶…å‚æ•°è¡¨ç¤º:

```
##############################################
#### Baseline ARIMA Model Hyperparameters ####
##############################################(p, d, q)    = (0, 0, 0)
(P, D, Q, s) = (0, 0, 0, 0)
```

ç†è®ºä¸Šï¼Œç”±äºæ—¶é—´åºåˆ—æ•°æ®æ²¡æœ‰ä»»ä½•ä¿¡å·ï¼Œæœªæ¥é¢„æµ‹(æ ·æœ¬å¤–)çš„æœ€ä½³è¡¨ç¤ºæ˜¯ç”¨äºè®­ç»ƒæ¨¡å‹çš„æ•°æ®çš„å¹³å‡å€¼(è¯¦ç»†ä¿¡æ¯è¯·å‚è§[2])ã€‚åŒæ ·ï¼Œæ ·æœ¬å†…é¢„æµ‹çš„æœ€ä½³ä¼°è®¡ä¹Ÿæ˜¯ç”¨äºè®­ç»ƒæ¨¡å‹çš„æ•°æ®çš„å¹³å‡å€¼ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—æ ·æœ¬å†…æ‹Ÿåˆçš„æ®‹å·®æ¥è·å¾—è¿™äº›é¢„æµ‹çš„é¢„æµ‹åŒºé—´ã€‚æ®‹å·®è¡¨ç¤ºå®é™…æ ·æœ¬å†…æ•°æ®(å³ç”¨äºè®­ç»ƒçš„æ•°æ®)å’Œç”±è¯¥æ¨¡å‹äº§ç”Ÿçš„æ ·æœ¬å†…ä¼°è®¡(åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼)ä¹‹é—´çš„å·®å¼‚ã€‚

å¥½å§ï¼Œç†è®ºæ˜¯ä¸€å›äº‹ï¼Œä½†ä¸€å¼ å›¾èƒœè¿‡åƒè¨€ä¸‡è¯­ã€‚æ‰€ä»¥è®©æˆ‘ä»¬æ¥å®è·µä¸€ä¸‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ PyCaret çš„æ—¶é—´åºåˆ—æ¨¡å—æ¥æ›´æ·±å…¥åœ°äº†è§£è¿™ä¸ªæ¨¡å‹ã€‚æ³¨æ„ï¼Œå¯ä»¥åœ¨è¿™é‡Œçš„ å’Œå‚è€ƒèµ„æ–™éƒ¨åˆ†æ‰¾åˆ°ä»£ç çš„ç¬”è®°æœ¬ [**ã€‚**](https://nbviewer.org/github/ngupta23/medium_articles/blob/main/time_series/pycaret/pycaret_ts_arima_000_0000.ipynb)

# 3ï¸âƒ£ä½¿ç”¨ PyCaret äº†è§£ ARIMA æ¨¡å‹

PyCaret çš„æ—¶é—´åºåˆ—æ¨¡å—æä¾›äº†è¶…è¿‡ 2000 ä¸ªå·²çŸ¥å±æ€§çš„æ—¶é—´åºåˆ—çš„æ•°æ®æ¸¸ä¹åœºã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªè¿™ä¸ªæ“åœºçš„â€œç™½å™ªå£°â€æ•°æ®é›†æ¥è§£é‡Šè¿™ä¸ªä¾‹å­ã€‚

ğŸ‘‰**æ­¥éª¤ 1:è®¾ç½® PyCaret æ—¶é—´åºåˆ—å®éªŒ**

```
#### Get data from data playground ----
y = get_data("1", folder="time_series/white_noise")
```

![](img/205bdc5d07ba3136527617fb48e422b5.png)

å®éªŒçš„ç™½å™ªå£°æ•°æ®(ä»…å‰ 5 è¡Œ)[å›¾ç‰‡ç”±ä½œè€…æä¾›]

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªæ—¶é—´åºåˆ—å®éªŒæ¥æ¢ç´¢å’Œå»ºæ¨¡è¿™ä¸ªæ•°æ®é›†ã€‚â€œæ—¶é—´åºåˆ—å®éªŒâ€æ˜¯ä¸€ä¸ªä¸€ç«™å¼å•†åº—ï¼Œç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œ**æ¢ç´¢æ€§åˆ†æ(EDA)** ã€**æ¨¡å‹æ„å»º**ã€æ¨¡å‹**é€‚åˆåº¦è¯„ä¼°**ä»¥åŠ**éƒ¨ç½²**â€”â€”åŒæ—¶éµå¾ªå¼•æ“ç›–ä¸‹çš„æœ€ä½³å»ºæ¨¡å®è·µã€‚

åœ¨è¿™ä¸ªè®¾ç½®ä¸­ï¼Œæˆ‘å°†é¢„æµ‹èŒƒå›´`fh`è®¾ç½®ä¸º 30(å³æˆ‘ä»¬æ‰“ç®—é¢„æµ‹æ¥ä¸‹æ¥çš„ 30 ä¸ªæ—¶é—´ç‚¹)ã€‚æˆ‘è¿˜æš‚æ—¶å°†`seasonal_period`è®¾ç½®ä¸º 1ã€‚æ³¨æ„ï¼Œå¦‚æœæ‚¨çš„æ•°æ®æœ‰ä¸€ä¸ª`DatetimeIndex`æˆ–`PeriodIndex`æŒ‡æ•°(è¿™é‡Œä¸æ˜¯è¿™ç§æƒ…å†µ)ï¼Œé‚£ä¹ˆå­£èŠ‚å‘¨æœŸæ˜¯è‡ªåŠ¨æ¨æ–­çš„ã€‚å¦‚æœæ˜¯åˆ«çš„ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦åº¦è¿‡å­£èŠ‚æœŸã€‚æˆ‘è¿˜ä¼ é€’äº†ä¸€ä¸ªä¼šè¯ IDï¼Œå®ƒå……å½“ç§å­å¹¶ä½¿å®éªŒå¯é‡å¤ã€‚

```
#### Setup experiment ----
exp = TimeSeriesExperiment()
exp.setup(data=y, seasonal_period=1, fh=30, session_id=42)
```

![](img/177a1028bd620ebf27e2a5a93a5dd9df.png)

[å›¾ç‰‡ç”±ä½œè€…æä¾›]

è¯¥è®¾ç½®ä»ä¸€å¼€å§‹å°±ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›æ–¹ä¾¿çš„ä¿¡æ¯ã€‚

(1)æˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬çš„æ•°æ®æœ‰ 340 ä¸ªæ•°æ®ç‚¹ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œpycaret ä¿ç•™äº†æœ€å 30 ä¸ªæ•°æ®ç‚¹(ä¸é¢„æµ‹æ—¶é—´èŒƒå›´ç›¸åŒ)ä½œä¸ºâ€œæµ‹è¯•é›†â€ï¼Œå‰©ä½™çš„ 310 ä¸ªæ•°æ®ç‚¹ç”¨äºè®­ç»ƒã€‚

(2)æˆ‘ä»¬é€šè¿‡äº†å­£èŠ‚æ€§å‘¨æœŸ 1ï¼Œä½†æ˜¯åœ¨å†…éƒ¨æµ‹è¯•å­£èŠ‚æ€§ä¹‹åï¼Œæ²¡æœ‰æ£€æµ‹åˆ°å®ƒã€‚è¿™æ˜¯æ„æ–™ä¹‹ä¸­çš„ï¼Œå› ä¸ºè¿™æ˜¯æ²¡æœ‰å­£èŠ‚æ€§çš„ç™½å™ªå£°æ•°æ®ã€‚

(3)å†…éƒ¨è¿›è¡Œäº†ç™½å™ªéŸ³çš„æ°¸ç›’æµ‹è¯•(è§å‰é¢çš„è¯»æ•°),ç¡®å®šæ•°æ®ä¸ç™½å™ªéŸ³ä¸€è‡´ã€‚åŒæ ·ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä»ç™½å™ªéŸ³é¢†åŸŸä¸­æŒ‘é€‰æ•°æ®çš„ã€‚

ğŸ‘‰**æ­¥éª¤ 2:æ‰§è¡Œ EDA**

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›æ•°æ®è¿›è¡Œå¿«é€Ÿ EDA:

```
# `plot_model` without any estimator works on the original 
exp.plot_model()
```

![](img/36552ecdbc30991d9a2f940114d64a2d.png)

ç»˜åˆ¶æ•°æ®[å›¾ç‰‡ç”±ä½œè€…æä¾›]

```
# Plot ACF ----
exp.plot_model(plot="acf")
```

![](img/2bdadae78cde2f2671d6cc0bae05b151.png)

ACF å›¾æ˜¾ç¤ºæ²¡æœ‰æ˜¾è‘—çš„è‡ªç›¸å…³[å›¾ç‰‡ç”±ä½œè€…æä¾›]

ACF æ•°æ®æ˜¾ç¤ºæ²¡æœ‰æ˜¾è‘—çš„è‡ªç›¸å…³ï¼Œå¹¶ä¸”ä¸ç™½å™ªå£°ä¸€è‡´ã€‚è¿™ä¹Ÿæ˜¯æ„æ–™ä¸­çš„äº‹(è¯¦è§å‰é¢çš„å†…å®¹)ã€‚

## ğŸ‘‰ç¬¬ä¸‰æ­¥:ç†è®ºè®¡ç®—

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä»å®éªŒä¸­è·å¾—ä¸€äº›æ•°æ®ç»Ÿè®¡ï¼Œå¹¶æ·»åŠ ä¸Šé¢æˆ‘ä»¬æ¡†æ¶ä¸­çš„ç†è®ºè®¡ç®—ã€‚

æ³¨æ„:è®­ç»ƒå’Œæµ‹è¯•æ•°æ®åˆ†å‰²å¯ä»¥ä½¿ç”¨å®éªŒå¯¹è±¡çš„â€œget_configâ€æ–¹æ³•è·å¾—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```
# Get Train Data
y_train = exp.get_config("y_train")# Get Test Data
y_test = exp.get_config("y_test")#########################################################
# Convert into dataframe & add residual calculations ----
#########################################################train_data = pd.DataFrame({"y":y_train})
train_data['preds'] = y_train.mean()
train_data['split'] = "Train"test_data = pd.DataFrame({'y': y_test})
test_data['preds'] = y_train.mean()
test_data['split'] = "Test"data = pd.concat([train_data, test_data])data['residuals'] = data['y'] - data['preds']
data.reset_index(inplace=True)
```

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è®¡ç®—è¿›è¡Œç†è®ºé¢„æµ‹å’Œè®¡ç®—é¢„æµ‹åŒºé—´æ‰€éœ€çš„è®¡ç®—ã€‚

```
#######################################################
#### Compute values based on theoretical equations ----
#######################################################y_train_mean **=** data**.**query("split=='Train'")['y']**.**mean()
resid **=** data**.**query("split=='Train'")['residuals']
resid_sigma2 **=** (resid******2)**.**sum()**/**len(resid)

print(f"Mean of Training Data: {y_train_mean}")
print(f"Residuals Sigma2: {resid_sigma2}")***>>> Mean of Training Data: 176.01810663414085
>>> Residuals Sigma2: 0.9769567915901368***######################################
#### Compute Prediction Intervals ----
######################################import scipy.stats as st
alpha = 0.05# 2 sided multiplier
multiplier = st.norm.ppf(1-alpha/2)lower_interval **=** np**.**round(y_train_mean **-** multiplier ***** resid_sigma2******0.5, 2)
upper_interval **=** np**.**round(y_train_mean **+** multiplier ***** resid_sigma2******0.5, 2)
print(f"Prediction Interval: {lower_interval} - {upper_interval}")***>>> Prediction Interval: 174.08 - 177.96***
```

## ğŸ‘‰æ­¥éª¤ 4:æ„å»ºæ¨¡å‹

æ—¢ç„¶æˆ‘ä»¬å·²ç»å®Œæˆäº†ç†è®ºè®¡ç®—ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ PyCaret æ„å»ºè¿™ä¸ªæ¨¡å‹å¹¶æ£€æŸ¥ç»“æœã€‚æ¨¡å‹åˆ›å»ºå°±åƒä»å®éªŒå¯¹è±¡è°ƒç”¨`create_model`æ–¹æ³•ä¸€æ ·ç®€å•ã€‚æ­¤å¤–ï¼Œæ­¤æ—¶æ‚¨è¿˜å¯ä»¥å°†ç‰¹å®šçš„è¶…å‚æ•°ä¼ é€’ç»™æ¨¡å‹ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨å»ºæ¨¡æ²¡æœ‰ä»»ä½•è‡ªå›å½’å±æ€§çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¸º`order`å’Œ`seasonal_order`ä¼ é€’å…¨é›¶ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå¦‚ä½•ç”¨ PyCaret åˆ›å»ºæ—¶é—´åºåˆ—æ¨¡å‹ï¼Œä»¥åŠå¦‚ä½•å®šåˆ¶å®ƒä»¬ï¼Œè¯·å‚è€ƒ[3]ã€‚

```
model1 = exp.create_model(
    "arima",
    order=(0, 0, 0),
    seasonal_order=(0, 0, 0, 0)
)
```

## ğŸ‘‰ç¬¬äº”æ­¥:åˆ†æç»“æœ

æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨ PyCaret ä¸€è¡Œç¨‹åºç¼–å†™äº†ä¸€äº›å°çš„åŒ…è£…å™¨å‡½æ•°æ¥å¸®åŠ©è¿›è¡Œæ¨¡å‹è¯„ä¼°(å‚è§é™„å½•ä¸­çš„å®šä¹‰)ã€‚è¿™äº›æ˜¯

(1) `summarize_model`:ç”Ÿæˆæ¨¡å‹çš„ç»Ÿè®¡æ¦‚è¦

(2) `get_residual_properties`:ç»˜åˆ¶å¹¶æ˜¾ç¤ºæ®‹å·®çš„æ–¹å·®

(3) `plot_predictions`:ç»˜åˆ¶æ ·æœ¬å¤–å’Œæ ·æœ¬å†…é¢„æµ‹

å¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šå…³äºè¿™äº›åŠŸèƒ½æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œç‰¹åˆ«æ˜¯`summarize_model`ï¼Œè¯·å‚è€ƒã€4ã€‘ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬é€šè¿‡è¿™äº›åŠ©æ‰‹å‡½æ•°è¿è¡Œæ¨¡å‹æ—¶ä¼šå¾—åˆ°ä»€ä¹ˆ

```
summarize_model(model1)
get_residual_properties(model1)
```

![](img/a6850319f0d8a14407d0d9a07a181019.png)

ARIMA æ¨¡å‹çš„ç»Ÿè®¡æ‘˜è¦[å›¾ç‰‡ç”±ä½œè€…æä¾›]

![](img/755191a079e17080692d7363acaa14da.png)

æ¨¡å‹æ®‹å·®å’Œæ®‹å·®æ–¹å·®[å›¾ç‰‡ç”±ä½œè€…æä¾›]

ä¸Šé¢æ˜¾ç¤ºäº†æ¨¡å‹çš„ç»Ÿè®¡æ‘˜è¦ã€‚æˆªè·æ˜¯è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼ã€‚å®ƒä¸æˆ‘ä»¬ä¸Šé¢çš„ç†è®ºæ¡†æ¶ä¸­çš„è®¡ç®—ç›¸å»åˆï¼

sigma2 æ˜¯æ®‹å·®çš„æ–¹å·®ã€‚æˆ‘ä»¬æ€ä¹ˆçŸ¥é“ï¼Ÿæ£€æŸ¥`get_residual_properties`åŠŸèƒ½çš„è¾“å‡ºã€‚å®ƒæ˜¾ç¤ºäº†æ®‹å·®çš„æ–¹å·®ã€‚è¿™ä¸ªå€¼ä¸ç»Ÿè®¡æ¦‚è¦å®Œå…¨åŒ¹é…ï¼Œä¹Ÿä¸æˆ‘ä»¬çš„ç†è®ºæ¡†æ¶çš„è®¡ç®—å®Œå…¨åŒ¹é…ï¼

ä½†æ˜¯é¢„æµ‹å‘¢ï¼Ÿæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ã€‚

```
plot_predictions(model1)
```

![](img/8fee9b4e1cea46760f6b7c48468e1b40.png)

æ ·æœ¬å¤–é¢„æµ‹å’Œé¢„æµ‹åŒºé—´[å›¾ç‰‡ç”±ä½œè€…æä¾›]

![](img/06c2d1b3bd73ba4a94b6dcf90ff5ec1b.png)

åœ¨æ ·æœ¬é¢„æµ‹ä¸­[å›¾ç‰‡ç”±ä½œè€…æä¾›]

é»˜è®¤æƒ…å†µä¸‹ï¼ŒPyCaret ä½¿ç”¨`plotly`åº“æä¾›äº¤äº’å¼ç»˜å›¾ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‚¬åœåœ¨ç»˜å›¾ä¸Šæ¥å¿«é€ŸéªŒè¯å€¼ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå¿«çœ‹åˆ°ï¼Œæ ·æœ¬å¤–å’Œæ ·æœ¬å†…é¢„æµ‹å€¼éƒ½ç­‰äº 176.02ï¼Œè¿™ä¸æˆ‘ä»¬ç†è®ºæ¡†æ¶çš„è®¡ç®—ç»“æœç›¸åŒ¹é…ã€‚é¢„æµ‹åŒºé—´ä¹Ÿä¸æˆ‘ä»¬ç†è®ºæ¡†æ¶ä¸­çš„å€¼ç›¸åŒ¹é…ï¼

# ğŸš€ç»“è®º

å¸Œæœ›è¿™ä¸ªç®€å•çš„æ¨¡å‹ä¸ºæˆ‘ä»¬ç†è§£ ARIMA æ¨¡å‹çš„å†…éƒ¨è¿ä½œæ‰“ä¸‹äº†è‰¯å¥½çš„åŸºç¡€ã€‚åœ¨ä¸‹ä¸€ç»„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¼€å§‹é€ä¸€ä»‹ç»å…¶ä»–å‚æ•°ï¼Œå¹¶æŸ¥çœ‹å®ƒä»¬å¯¹æ¨¡å‹è¡Œä¸ºçš„å½±å“ã€‚åœ¨é‚£ä¹‹å‰ï¼Œå¦‚æœä½ æ„¿æ„åœ¨æˆ‘çš„ç¤¾äº¤æ¸ é“ä¸Šä¸æˆ‘è”ç³»(æˆ‘ç»å¸¸å‘å¸ƒå…³äºæ—¶é—´åºåˆ—åˆ†æçš„æ–‡ç« )ï¼Œä½ å¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ°æˆ‘ã€‚æš‚æ—¶å°±è¿™æ ·äº†ã€‚é¢„æµ‹å¿«ä¹ï¼

ğŸ”— [LinkedIn](https://www.linkedin.com/in/guptanick/)

ğŸ¦[æ¨ç‰¹](https://twitter.com/guptanick13)

ğŸ“˜ [GitHub](https://github.com/ngupta23)

*å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿæˆä¸º* [***ä¸­ç­‰ä¼šå‘˜***](https://ngupta13.medium.com/membership) *ç»§ç»­* ***æ— é™åˆ¶å­¦ä¹ *** *ã€‚å¦‚æœä½ ä½¿ç”¨ä¸‹é¢çš„é“¾æ¥ï¼Œ* ***ï¼Œæˆ‘ä¼šæ”¶åˆ°ä½ çš„ä¸€éƒ¨åˆ†ä¼šå‘˜è´¹ï¼Œè€Œä¸ä¼šç»™ä½ å¸¦æ¥é¢å¤–çš„è´¹ç”¨*** *ã€‚*

<https://ngupta13.medium.com/membership>  

# ğŸ”–å»ºè®®ä¸‹æ¬¡é˜…è¯»

[ä½¿ç”¨ PyCaret çš„æ—¶é—´åºåˆ—æ¨¡å—ç†è§£ ARIMA æ¨¡å‹â€”ç¬¬äºŒéƒ¨åˆ†](/understanding-arima-models-using-pycarets-time-series-module-part2-308ea7bfecf6)

# ğŸ“—èµ„æº

1.  [**Jupyter ç¬”è®°æœ¬**](https://nbviewer.org/github/ngupta23/medium_articles/blob/main/time_series/pycaret/pycaret_ts_arima_000_0000.ipynb) åŒ…å«è¿™ç¯‡æ–‡ç« çš„ä»£ç 

# ğŸ“šå‚è€ƒ

[1] [è¯Šæ–­ PyCaret](https://github.com/pycaret/pycaret/discussions/1800) ä¸­çš„â€œç™½å™ªå£°â€

[2] [åœ¨ PyCaret ä¸­å»ºæ¨¡â€œç™½å™ªå£°â€](https://github.com/pycaret/pycaret/discussions/1837)

[3] [åˆ›å»ºå’Œå®šåˆ¶æ—¶é—´åºåˆ—æ¨¡å‹](https://github.com/pycaret/pycaret/discussions/1757)

[4] [äº†è§£ PyCaret æ—¶é—´åºåˆ—æ¨¡å—çš„åº•å±‚æ¶æ„](https://medium.com/p/57336a2f39c7)

[5] [ç¬¬å…«ç«  ARIMA æ¨¡å‹](https://otexts.com/fpp2/arima.html)ï¼Œã€Šé¢„æµ‹:åŸç†ä¸å®è·µã€‹ï¼Œç½—ä¼¯ J æµ·æ›¼å’Œä¹”æ²»é˜¿è¨çº³ç´¢æ™®æ´›æ–¯

# **ğŸ“˜é™„å½•**

1.  åŠ©æ‰‹åŠŸèƒ½

```
**def summarize_model(model):**
    """
    Provides statistical summary for some statistical models
    """
    # Statistical Summary Table
    try:
        print(model.summary())
    except:
        print("Summary does not exist for this model.")**def get_residual_properties(model):**
    """
    Plots and displays variance of residuals
    """
    *#### Residuals ----*
    try:
        plot_data = exp.plot_model(
            model,
            plot="residuals",
            return_data=True
        )
        resid = plot_data['data']
        resid_sigma2 = (resid**2).sum()/(len(resid))
        print(f"Residual Sigma2: {resid_sigma2}")
    except:
        print("Residuals can not be extracted for this model.")**def plot_predictions(model):**
    """
    Plots out-of-sample and in-sample predictions
    """
    # Out-of-Sample Forecast
    exp.plot_model(model) # In-Sample Forecast
    exp.plot_model(model, plot="insample")
```