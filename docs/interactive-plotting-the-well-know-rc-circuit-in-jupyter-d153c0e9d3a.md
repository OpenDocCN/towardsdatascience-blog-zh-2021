# 在 Jupyter 中交互绘制著名的 RC 电路

> 原文：<https://towardsdatascience.com/interactive-plotting-the-well-know-rc-circuit-in-jupyter-d153c0e9d3a?source=collection_archive---------22----------------------->

## ipywidgets 和 matplotlib 的又一步

![](img/03d75d62b796e8aae4c8e83c65df2816.png)

作者图片

***记得使用右边的“关注”按钮来关注我→:你会收到新文章的通知，并帮助我达到 100 个关注者的目标:)***

一阶微分方程最广为人知的例子之一是 [RC 电路](https://en.wikipedia.org/wiki/RC_circuit)的例子。虽然这可能会让我们想起高中时的糟糕回忆，但这个微分方程有一个并不复杂的解析解，我们可以通过使用交互式小部件和 matplotlib 轻松探索它。

> 自本月(4 月 22 日)起，Medium 决定你的作品必须拥有至少 100 名追随者才能获得奖励。 ***如果你喜欢这篇文章，只要你按下那个“关注”按钮就对我意义重大*** *:)非常感谢，希望你喜欢这篇文章！*

![](img/b2c0229382e685a7883460bc39c218f7.png)

照片由[哈里森·布罗德本特](https://unsplash.com/@harrisonbroadbent?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

是的，即使是不太复杂的数学表达式也常常难以理解:如果我增加它，会发生什么？如果我降低这个值会怎么样？**这篇文章是关于帮助我们的大脑理解解析方程和数值应用的。**

Ipywidgets 允许您通过像滑块和按钮这样的小部件来交互式地控制值，这使得理解您的分析模型相对于其参数的行为变得非常容易。

我们将看到如何为一个`InteractiveRC`写一个类，它公开了一个漂亮的交互界面，有一个图和它的滑块。

如果你对方程及其解的物理发展不感兴趣，你可以跳过下一部分。

此外，这篇文章是在 ipywidgets 上的一篇文章之后发表的，在这篇文章中，我展示了如何使用 3D 矢量来可视化噪声分解， ***检查嵌入的 gif 以获得剧透*** :

</use-ipywidgets-and-matplotlib-to-visualize-noise-decomposition-in-3d-this-is-pythagorean-371ac9769aea>  

# RC 电路:建立方程及其解

用维基百科的话说:“RC 电路就是由[电阻](https://en.wikipedia.org/wiki/Resistor)和[电容](https://en.wikipedia.org/wiki/Capacitor)组成的[电路](https://en.wikipedia.org/wiki/Electric_circuit)。它可以由一个[电压](https://en.wikipedia.org/wiki/Voltage_source)或[电流源](https://en.wikipedia.org/wiki/Current_source) […]”驱动。在我们的例子中，我们将考虑一个理想电压源 e。

电路看起来像这样:

![](img/fa01f93101ea7436496093d423cc3de1.png)

作者图片

我们现在回忆一下基本的电子方程，它让我们建立起 RC 微分方程。假设流过电容器的电流为

![](img/4cb4c0ca898838d675ab679ec108b641.png)

作者图片

其中 q 是电容器中的电荷。
另一方面，电容器边界内的电荷由下式给出:

![](img/996f91a11f00de04d3e83d182658fcc5.png)

作者图片

应用[基尔霍夫电压定律](https://en.wikipedia.org/wiki/Kirchhoff%27s_circuit_laws#Kirchhoff's_voltage_law)，我们得到:

![](img/4cbb7fddd934a8d2ef48747c7cb16a25.png)

作者图片

假设电阻器的张力为

![](img/627262ba087ac5f71f668ef60878d4cd.png)

作者图片

我们可以替换基尔霍夫定律中的这个表达式:

![](img/8d7a88570c569da8af9b491e5fde2fef.png)

作者图片

设时间常数τ= RC，我们得到微分方程的标准形式:

![](img/cfd064cbb217b1dc1c59b026b16bc794.png)

作者图片

**现在这是我们的一阶线性非齐次常数第二成员方程。解决方案的形式如下:**

![](img/7b8abae5f88578a7080140de6e012863.png)

作者图片

其中 A 和 B 是常数。当初始张力为 u_0 时，通过评估时间为 0 时的解方程，我们得到:

![](img/eedeacc5661ca686029d645f03a9990a.png)

作者图片

并且在时间“无穷大”评估，电容器的张力趋向于源张力 E，所以:

![](img/37d142a40067fa3ef6f4476742a45aa5.png)

作者图片

最后，我们将绘制的解决方案是:

![](img/b5953a4bcca899ab6ffe0fdf60ad8e66.png)

作者图片

关于这个等式只有几句话:

*   在 t=0 时，张力等于 u0
*   在 t=oo 时，张力趋向于 E
*   t=0 时，斜率等于-(u0-E)/τ，斜率在τ时刻与 E 相交(取导数，在 t=0 时求值，说服自己)。

这些是关于解决方案的重要事实，我们将在我们的情节中强调，再次帮助我们的大脑确信那些有用的事实。

# 解决方案的互动探索

现在有趣的部分来了,“感觉”溶液如何基于 3 个参数表现:源张力 E，初始张力 u0，和时间常数τ。

我们将使用 ipywidgets 滑块来控制每个参数的值，并使用 matplotlib 行来相应地更新绘图。我们将使用一个类结构来很好地组织我们的代码。

我们首先创建一个“输出”小部件，它包含数字和轴，以及 3 个滑块来控制我们的参数值。我们还添加了一个滑块来控制我们想要绘制解决方案的“时间跨度”,以时间常数的数量来表示。然后，我们用“init_plot”设置绘图，并设置限制和轴标签。

然后，我们将编写一个` _update '回调函数，该函数将在每次滑块改变时被调用，以更新绘图。我们一会儿将回到这个函数。然后我们把所有东西都放在一个 ipyw.Hbox 中:滑块和情节。我们还定义了一个` __repr__ `辅助函数来轻松显示我们的绘图和小部件。

我们在类中添加了一些属性，用一种很好的语法直接访问 sliders 值:` self.u0 '将返回` u0 _ w` slider 值——对于` e `、` tau '和` n_tau '也是如此。我们还添加了一个“t_sample”属性，它依赖于“n_tau”滑块值来创建绘制解函数所需的时间样本。

现在我们要绘制 4 样东西:

*   解函数张力，u(t)=(u0-E)e^(-t/tau)+E
*   界定初始张力 u0 的水平线
*   限定会聚张力 E 的水平线
*   强调原点斜率和相应τ值(秒)的分段线

因此，我们添加了 4 种方法来生成绘制这些线所需的数据。

是时候填充我们之前使用的“init_plot”函数了。我们将做三件事:

*   绘制直线:u、u0、E 和原点处的斜率
*   添加一些文本对象，使我们的情节更加明确
*   向轴添加网格和紧凑布局

注意，在绘图时，我们使用刚刚创建的数据方法将 x 和 y 发送给绘图函数。存储返回的“Line”对象引用，以便我们可以在以后更新它们的数据。“文本”对象也是如此。

最后，我们必须回到构造函数方法中定义的回调函数` _update`。记住，这个函数将在每次滑块改变它的值时被调用，所以我们必须相应地更新绘图。

对于每一行，我们需要更新行数据、文本位置和文本的文本。同样，我们很好地利用了数据助手和滑块包装属性。

# 秀场

现在我们创建一个实例，让魔法休息一下:

你应该得到一个这样的界面

![](img/8850eaaba33fc163592c958b16e12114.png)

作者图片

玩滑块会更新情节:

![](img/03d75d62b796e8aae4c8e83c65df2816.png)

作者图片

我们现在可以玩我们的模型，更好地“感受”每个参数在每个时间如何影响张力。

我们可以形象化地描述一些事情:

*   增加初始张力 u0 会使曲线垂直“收缩”,使 E 处的收敛张力保持不变。当我们使 u0 更接近 E 时，张力达到 E 的“速度”(由原点处斜率的陡度表示)也会降低。
*   增加源张力 E 垂直“扩展”曲线。初始张力不变，所以张力从 u0 达到 E 的斜率增大。
*   增加时间常数τ水平地“扩展”曲线:曲线具有相同的形状，但是在时间上被“拉伸”。初始张力和收敛张力保持不变。
*   关于时间常数的数量，绘制了张力:我们可以看到，在时间常数的五或六倍之后，张力非常接近于收敛张力 e。例如，这可以通过评估时间 t=5tau 时的解方程来分析证明。

同样，你将以图形方式看到的一切都是基于解方程，所以它可以通过分析来证明，这是一个很好的练习，可以让你的数学技能保持活力。

但是能够可视化这些变化也是非常有益的，有助于你的大脑直观地把握每个参数的影响。

如果你喜欢这篇文章，记得鼓掌并订阅！更多互动帖子来了。

PS:如果你不想处理 matplotlib 对象，直接进入交互式绘图，请查看 [mpl_interactions](https://mpl-interactions.readthedocs.io/en/stable/#basic-example) 。

# 完整代码