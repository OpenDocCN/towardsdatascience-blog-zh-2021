<html>
<head>
<title>Automated Machine Learning using PyCaret</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyCaret的自动机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automated-machine-learning-using-pycaret-4bb90ab3e2c7?source=collection_archive---------11-----------------------#2021-06-08">https://towardsdatascience.com/automated-machine-learning-using-pycaret-4bb90ab3e2c7?source=collection_archive---------11-----------------------#2021-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e43b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用不到十行代码自动化您的机器学习工作流程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a9678bac793827a6397dad964d2113d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60u4gOXkDzBLRnDj5rWgtQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亨特·哈里特在<a class="ae ky" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="6199" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="ac3f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您是否希望为您的企业实施机器学习，但没有太多时间来构建它？PyCaret可以帮助你！</p><p id="5b78" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">PyCaret是一个用于Python的开源机器学习库，可以减少您准备数据集来测试模型的时间。PyCaret很容易使用，所以您不必花时间编写代码，直到过程结束。</p><p id="7811" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">更有趣的是，不到十行代码就可以拥有最好的机器学习模型！多酷啊。！</p><p id="0abd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文将向您介绍如何使用PyCaret，从准备数据到部署模型。没有进一步，让我们开始吧！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="8cbf" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">实施</h1><h2 id="a70a" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">数据源</h2><p id="c3a5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这种情况下，我们将使用一个名为丙型肝炎预测数据集的数据集。这个数据集是fedesoriano在Kaggle上创建的。它由几个变量组成，从年龄和性别等人口统计学变量到类似生物标记的变量。您可以在这里  <strong class="lt iu">访问数据集<a class="ae ky" href="https://www.kaggle.com/fedesoriano/hepatitis-c-dataset" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">。</strong></a></strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/2b32502dc526dc0117d8ed1fdb292b95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a_wLUAkjsD75L9OR"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者捕捉到的。</p></figure><p id="10af" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是加载数据集的代码，以及从中进行的预览:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="c205" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上面可以看到，有一个名为“未命名:0”的列。我们需要从数据集中丢弃该列，因为它是每一行的标识符。为了删除该列，我们运行如下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="87e7" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">准备数据</h2><p id="8419" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">加载数据后，下一步是准备数据。使用PyCaret，准备数据很简单。我们可以使用pycaret.classification库中的一个名为setup的函数。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="976a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是我们运行代码时的流程预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/6ccb5c964b1a9b42ea71ab1a3f04cd3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1DkfnR9BSNdZN1fI"/></div></div></figure><p id="78c3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上图可以看出，这说明setup函数只用一个函数就完成了所有的预处理步骤。我们可以填充缺失的值，转换数据集，删除异常值，等等。</p><p id="f70a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们想设置自定义预处理步骤，我们可以在设置功能上设置参数。对于这种情况，让我们填充数据集上缺失的值。我们可以给出一个称为numeric _ attraction的参数，用于填充数字列上的缺失值。我们将用该列的中值来填充缺失值。</p><p id="0cc4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="d980" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们设置参数之前，数值插补行看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/53b2c4f58069d65bd7974471dbf9304a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S7omPkZkKnrwdJwr"/></div></div></figure><p id="93e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是我们设置数值插补行后的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/5f70f43f81bb3d608c67246b794fa4a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AA7_sXGQ0Mg32wvW"/></div></div></figure><p id="8f9f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们已经将数值估算器设置为中值。除了数值插补参数，您还可以在设置功能中给出其他参数。更多详情，可以在这里 阅读PyCaret的文档<a class="ae ky" href="https://pycaret.org/preprocessing/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">。</strong></a></p><h2 id="857e" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">比较模型</h2><p id="20e3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">PyCaret库的一个主要特性是，你可以同时运行任何机器学习模型，从逻辑回归、决策树、XGBoost等等！</p><p id="9b7b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要运行模型比较，我们可以使用pycaret.classification库中的compare_model函数。下面是代码及其结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="61f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从结果中，我们可以看到该模型及其度量性能。如上所述，梯度推进分类器模型在几乎所有指标上都有很好的性能。</p><p id="1fff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">仅在精度指标上，该模型并没有获得很好的性能。线性判别分析模型取得了较好的精度结果。</p><p id="d588" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">想象一下，只要一个函数，你就可以同时得到所有的模型结果！多酷啊。</p><p id="3b22" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，我们将在下一步使用梯度提升分类器。</p><h2 id="3c14" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">再现最佳模式</h2><p id="d8a2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在让我们再现最佳模型，其中我们将使用梯度推进分类器作为模型。下面是代码及其结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="4476" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">超参数调谐</h2><p id="7cba" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">虽然该模型得到了最好的结果，但我们可以通过超参数调整来改进它。超参数调整是一个从所有超参数组合中挑选最佳超参数的过程。简单来说，超参数是一个我们可以在数据集上训练模型之前在模型上设置的参数。</p><p id="b951" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在PyCaret中，我们可以使用tune_model函数来调整模型的超参数。代码及其结果如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="7428" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">模型评估</h2><p id="fedf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们得到最佳超参数组合的模型后，我们再通过看几个图表来评价模型。</p><p id="e3d8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在PyCaret中，我们可以通过使用一个函数来可视化许多图表。例如，让我们使用plot_model函数绘制ROC曲线，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="c78c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了可视化混淆矩阵，您可以使用如下相同的函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="1bfe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在PyCaret中，我们还可以可视化我们的模型对数据的决策边界。代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="3931" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除此之外，该函数还可以从数据中可视化特征的重要性。所以我们知道模型如何预测数据，哪些变量决定最终结果。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="efd7" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">模型检验</h2><p id="862c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们知道我们的模型已经达到了很好的效果。现在让我们在看不见的数据上测试这个模型。我们可以使用名为predict_model的函数进行预测，并显示每个指标的性能。下面是代码及其结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="5db1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上面的结果可以看出，该模型的性能比我们在超参数调整阶段的性能要低。但是记住，这个数据之前没有训练过，所以结果是好的。现在让我们保存最终的模型。</p><h2 id="8abe" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">保存模型</h2><p id="c7ae" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在保存模型之前，我们需要重新训练模型。在PyCaret中，我们可以使用finalize_model函数来做到这一点。训练过程将采用完整的数据集，包括测试数据。因此，我们可以在以后的实际测试数据上使用该模型。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="e90c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在让我们保存模型。在PyCaret中，我们可以使用save_model函数来做到这一点。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="e348" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您想在另一个项目中加载模型，您可以像这样使用load_model函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="7d52" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">结束语</h1><p id="2658" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">干得好！现在你已经学会了如何使用PyCaret来自动化你的机器学习管道。希望能帮助你缩短开发机器学习模型的过程。通过这样做，你可以更专注于问题，而不是解决技术问题。</p><p id="1268" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你对我的文章感兴趣，你可以关注我的媒体以获得更多类似的文章。如果你有任何问题或者想打个招呼，你可以在<a class="ae ky" href="https://www.linkedin.com/in/alghaniirfan/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> LinkedIn </strong> </a>上联系我。</p><p id="ae0e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">谢谢你看我的文章！</p></div></div>    
</body>
</html>