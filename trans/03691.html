<html>
<head>
<title>Automate Your Excel Report By Creating A Summary Sheet Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过使用Python创建摘要表来自动化您的Excel报表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-your-excel-report-by-creating-a-summary-sheet-using-python-6fdb26480c3b?source=collection_archive---------2-----------------------#2021-03-26">https://towardsdatascience.com/automate-your-excel-report-by-creating-a-summary-sheet-using-python-6fdb26480c3b?source=collection_archive---------2-----------------------#2021-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4d89" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Python + Excel</h2><div class=""/><div class=""><h2 id="1b35" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">如何协调Python和Excel，用一种像样的、专业的格式来总结你的数据？改进Excel报表的一种方法。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/f418f3148d753f50fef65e0252cf5908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LBvvACVkmCQJbBTF"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">卢卡·布拉沃在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="61a5" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">简介</strong></h1><p id="436c" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">创建一个独特的和可展示的摘要页面是任何基于Excel的报告工作的最后一步。没有这些，你只能得到一张张的数字和公式，很难从你的基础数据中得出结论。通过创建摘要表，工作簿的查看者将能够立即以美观的格式理解数据。</p><p id="5732" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在这个Python + Excel系列的前面，您学习了如何使用Python格式化Excel电子表格。这次我们将看看如何使用格式化代码在Excel中制作一个汇总表/仪表板。</p><p id="64f2" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在我的上一篇文章中，我写了一些推理，解释了为什么你想将Excel与python一起使用，python与pandas和xlwings如何能极大地改善你的Excel繁重的工作流程，并包括一个简短的教程，其中有一些例子，让你开始对你的Excel电子表格进行样式化。</p><p id="1cf5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">您可以在下面的链接中找到所有这些信息；这可能是一个很好的起点，因为本文不会详细讨论相同的主题。</p><div class="nb nc gp gr nd ne"><a rel="noopener follow" target="_blank" href="/stylize-and-automate-your-excel-files-with-python-cab49b57b25a"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jd gy z fp nj fr fs nk fu fw jc bi translated">使用Python风格化和自动化您的Excel文件</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">如何利用Python创建风格化的Excel报表使用xlwings，初学者入门Python的一种方式。</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">towardsdatascience.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns lb ne"/></div></div></a></div><p id="101f" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我这篇文章的目标是帮助你在使用我上一篇文章中学到的Excel/python格式化技巧的同时总结你的数据。我们将对数据进行旋转、分组和排序。然后制作图表、设计风格并向摘要页面添加徽标。这些技能相结合将使您能够在一个简单的python脚本中对数据进行汇总和格式化。希望这篇文章和上一篇一样有用！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="f865" class="li lj it bd lk ll oa ln lo lp ob lr ls ki oc kj lu kl od km lw ko oe kp ly lz bi translated"><strong class="ak">汇总数据</strong></h1><p id="d631" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">如果您的工作流程是Excel繁重的，我敢肯定您有跨越多个选项卡的工作簿、许多数据透视表和更多交叉引用每张工作表的公式。这很好…如果你的目标是迷惑所有试图理解你的电子表格的人。</p><p id="521d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">使用Python汇总数据的一个好处是能够将数据透视表和其他数据存储为单个变量中的数据帧。以这种方式引用更容易调试，而不是试图通过电子表格中的多个选项卡来跟踪数字。</p><p id="1d91" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd"> pandas </strong> —本模块对于成功总结您的数据至关重要。</p><p id="2b2f" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">根据熊猫网站:</p><p id="c997" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">pandas是一个快速、强大、灵活且易于使用的开源数据分析和处理工具</p><p id="8a99" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">简而言之，pandas包含的功能可以完成你通常在Excel中所做的所有数据分析。以下是一些您会对基于Excel的背景感兴趣的函数，如果您想了解更多信息，每个函数的文档都有超链接:</p><ul class=""><li id="1367" class="of og it mc b md mw mg mx mj oh mn oi mr oj mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.value_counts.html?highlight=value_counts#pandas.DataFrame.value_counts" rel="noopener ugc nofollow" target="_blank"> value_counts() </a></li><li id="e2ce" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop_duplicates.html" rel="noopener ugc nofollow" target="_blank"> drop_duplicates() </a></li><li id="fd29" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html#pandas.DataFrame.groupby" rel="noopener ugc nofollow" target="_blank"> groupby() </a></li><li id="d0c9" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html" rel="noopener ugc nofollow" target="_blank">形容()</a></li><li id="1e87" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html" rel="noopener ugc nofollow" target="_blank"><strong class="mc jd">【pivot _ table()</strong></a><strong class="mc jd"/>(每个Excel用户的最爱)</li><li id="886a" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.html" rel="noopener ugc nofollow" target="_blank">剧情()</a></li><li id="8264" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dtypes.html" rel="noopener ugc nofollow" target="_blank">数据类型</a></li><li id="04c2" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html" rel="noopener ugc nofollow" target="_blank"> loc </a></li><li id="4eba" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated">国际劳工组织理事会</li></ul><p id="f1c4" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这些是pandas众多功能中的几个例子，可以用来操作或快速总结你的数据。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="f448" class="li lj it bd lk ll oa ln lo lp ob lr ls ki oc kj lu kl od km lw ko oe kp ly lz bi translated"><strong class="ak">创建汇总表的步骤</strong></h1><p id="22cb" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">如前所述，本教程中格式化电子表格的代码已经在我的上一篇文章“<a class="ae lh" rel="noopener" target="_blank" href="/stylize-and-automate-your-excel-files-with-python-cab49b57b25a">用Python </a>格式化和自动化Excel文件”中详细解释过了。本教程将在前面的基础上增加一些新的功能来创建一个快速、美观和全面的汇总表。</p><p id="20ed" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我创建了一个csv格式的水果和蔬菜销售测试数据集，用于本教程和上一教程。</p><p id="b1b8" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">可以从Github下载数据:<a class="ae lh" href="https://github.com/Nishan-Pradhan/xlwings_dashboard" rel="noopener ugc nofollow" target="_blank">链接</a></p><ol class=""><li id="3334" class="of og it mc b md mw mg mx mj oh mn oi mr oj mv ot ol om on bi translated">第一步是导入我们将使用的模块。几乎所有的教程都将使用熊猫和xlwings来完成。</li></ol><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="5fa3" class="oz lj it ov b gy pa pb l pc pd">import pandas as pd<br/>import numpy as np<br/>import xlwings as xw<br/>import matplotlib.pyplot as plt</span></pre><p id="3ce2" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">2.使用Pandas将csv数据导入数据框架。有两种方法可以做到这一点，直接从Github读取或下载到您的本地驱动器并引用。两者在完整的剧本中都有提及。下面的片段将直接从Github中读取。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="31d5" class="oz lj it ov b gy pa pb l pc pd">df = pd.read_csv(r”<a class="ae lh" href="https://raw.githubusercontent.com/Nishan-Pradhan/xlwings_dashboard/master/fruit_and_veg_sales.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/Nishan-Pradhan/xlwings_dashboard/master/fruit_and_veg_sales.csv</a>")</span></pre><p id="edc7" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">3.下面的步骤初始化一个Excel工作簿，重命名Sheet1并将我们的DataFrame复制到Excel。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="a572" class="oz lj it ov b gy pa pb l pc pd">wb = xw.Book()<br/>sht = wb.sheets["Sheet1"]<br/>sht.name = "fruit_and_veg_sales"<br/>sht.range("A1").options(index=False).value = df</span></pre><p id="6d11" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">4.接下来，我们想创建一个名为“Dashboard”的新工作表，并引用该工作表。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="6d49" class="oz lj it ov b gy pa pb l pc pd">wb.sheets.add('Dashboard')<br/>sht_dashboard = wb.sheets('Dashboard')</span></pre><p id="ca23" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们现在有一个包含两张工作表的Excel工作簿。“水果蔬菜销售”有我们的数据，而“仪表板”是空白的。</p><p id="0d8f" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">5.我们现在将开始使用pandas来处理我们的数据，并生成我们的数据摘要，以包括在我们的空白表上。第一步是检查数据集中的列名。在Python中查看所有列名的快捷方式是运行下面一行:<code class="fe pe pf pg ov b">print(df.columns)</code></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/fa37c07f6d2c399af9aa136e640f1296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*YAjZUUZZgAzegjaqijHmQQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">df.columns |作者图片</p></figure><p id="cce1" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">从这里我们可以看到，许多列名包含空格、括号、美元符号、大写字母和括号，很不方便。</p><p id="dcc9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">为了防止我们犯小错误并节省大量调试时间，在用pandas引用这些列名时，复制并粘贴它们是明智的。(在较大规模的项目中，重命名列可能更好)</p><p id="4fe8" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">6.我们将为仪表板表创建的第一个摘要将是显示每件售出商品的总利润的数据的枢纽。为此，我们将利用pandas的<code class="fe pe pf pg ov b">pd.pivot_table()</code>功能。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="7149" class="oz lj it ov b gy pa pb l pc pd">pv_total_profit = pd.pivot_table(df, index='Item', values='Total Profit ($)', aggfunc='sum')</span></pre><p id="fddd" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这里我们创建了一个新的数据帧，名为<code class="fe pe pf pg ov b">pv_total_profit</code>。这个数据帧有一个索引，包含我们的Item列中的每个值。显示的值来自我们数据中的“总利润($)”列，我们指定的函数的最终输入是<code class="fe pe pf pg ov b">aggfunc='sum'</code>，这告诉Pandas我们希望通过对<code class="fe pe pf pg ov b">values</code>列求和来汇总我们的数据，在本例中是“总利润($)”。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/9465942c83a19d373aeea4c4342f8b83.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*1uGnUIOKqyZRZ2kmIHn12A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">pv_total_profit数据框架透视|作者图片</p></figure><p id="5460" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">7.我们现在再次执行相同的步骤，只是这一次我们希望透视我们的数据，以显示每件售出商品的数量。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="fcab" class="oz lj it ov b gy pa pb l pc pd">pv_quantity_sold = pd.pivot_table(df,index='Item',values='Quantity Sold',aggfunc='sum')</span></pre><p id="4b48" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">8.你可以制作一个简单枢纽的整个仪表板或报告，这将看起来很棒，然而，为了使本教程更有趣，我们将使用一个分组函数:<code class="fe pe pf pg ov b">df.groupby()</code>将你的数据按你指定的方式分组。</p><p id="6817" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">由于我们的数据与过去一年的销售数字有关，因此查看按月而不是按天分组的<strong class="mc jd">数据可能会有用。我们会做到这一点，但首先我们需要确保我们的“售出日期”栏确实被熊猫作为日期读取。</strong></p><p id="291b" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">检查该运行<code class="fe pe pf pg ov b">print(df.dtypes)</code></p><p id="9153" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">您应该能够从这里看到，我们的“售出日期”列被作为一个对象读取，而不是日期时间格式。这意味着我们还不能很容易地按月对数据帧进行分组。</p><p id="feb9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们可以将该列的数据类型更改为datetime，如下所示:</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="e21d" class="oz lj it ov b gy pa pb l pc pd">df[“Date Sold”] = pd.to_datetime(df[“Date Sold”], format=’%d/%m/%Y’)</span></pre><p id="a792" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这里，<code class="fe pe pf pg ov b">pd.to_datetime()</code>格式化我们的列，我们指定原始数据的格式，以确保它被正确地从对象转换成日期时间。如果你再次运行<code class="fe pe pf pg ov b">df.dtypes</code>，你会看到“销售日期”是<code class="fe pe pf pg ov b">datetime64[ns]</code>的格式，这是我们分组工作所需要的。</p><div class="ks kt ku kv gt ab cb"><figure class="pj kw pk pl pm pn po paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><img src="../Images/aa9d366e3982ae45c4f8272a47e29a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*71GlI_tQa1KpDuB3sDu5hg.png"/></div></figure><figure class="pj kw pp pl pm pn po paragraph-image"><img src="../Images/81185939446ec7cf1d26ffbbb242804c.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*hXUvT9PLPeYESwKVPXtD2g.png"/><p class="ld le gj gh gi lf lg bd b be z dk pq di pr ps translated">数据类型:转换前(左)、转换后(右)|按作者分类的图像</p></figure></div><p id="0295" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">9.现在我们的数据有了正确的格式，我们可以使用下面的代码行来合计和聚合我们的数据，并显示相关的列。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="75c6" class="oz lj it ov b gy pa pb l pc pd">gb_date_sold = df.groupby(df["Date Sold"].dt.to_period('m')).sum()[["Quantity Sold",'Total Revenue ($)',  'Total Cost ($)',"Total Profit ($)"]]</span></pre><p id="b6ee" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们按月分组的数据现在看起来像这样:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/c5a70a04ecd14a7d51f70e3c6919ec4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*aTjw010hIFf-U7t7M7qwgw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">gb_date_sold |作者图片</p></figure><p id="710b" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">10.最后一个groupby将为我们的仪表板提供第四个数据集。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="2c90" class="oz lj it ov b gy pa pb l pc pd">gb_top_revenue = (df.groupby(df["Date Sold"]).sum().sort_values('Total Revenue ($)',ascending=False).head(8))[["Quantity Sold",'Total Revenue ($)','Total Cost ($)',"Total Profit ($)"]]</span></pre><p id="4132" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这个groupby向我们展示了总收入排名前8位的<strong class="mc jd"/>。我们通过按“总收入”降序(最高收入在顶部)对数据框架进行排序来实现这一点，然后我们使用<code class="fe pe pf pg ov b">head(8)</code>给出排序后数据的前8行。</p><p id="acf9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">11.现在我们已经有了4个数据摘要，我们可以继续创建报告了。首先，我们从一些静态格式开始。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="4121" class="oz lj it ov b gy pa pb l pc pd"># Background<br/>sht_dashboard.range('A1:Z1000').color = (198,224,180)</span><span id="0f08" class="oz lj it ov b gy pu pb l pc pd"># A:B column width<br/>sht_dashboard.range('A:B').column_width = 2.22</span><span id="2294" class="oz lj it ov b gy pu pb l pc pd"># Title<br/>sht_dashboard.range('B2').value = 'Sales Dashboard'<br/>sht_dashboard.range('B2').api.Font.Name = 'Arial'<br/>sht_dashboard.range('B2').api.Font.Size = 48<br/>sht_dashboard.range('B2').api.Font.Bold = True<br/>sht_dashboard.range('B2').api.Font.Color = 0x000000<br/>sht_dashboard.range('B2').row_height = 61.2</span><span id="70d1" class="oz lj it ov b gy pu pb l pc pd"># Underline Title<br/>sht_dashboard.range('B2:W2').api.Borders(9).Weight = 4<br/>sht_dashboard.range('B2:W2').api.Borders(9).Color = 0x00B050</span><span id="5898" class="oz lj it ov b gy pu pb l pc pd"># Subtitle<br/>sht_dashboard.range('M2').value = 'Total Profit Per Item Chart'<br/>sht_dashboard.range('M2').api.Font.Name = 'Arial'<br/>sht_dashboard.range('M2').api.Font.Size = 20<br/>sht_dashboard.range('M2').api.Font.Bold = True<br/>sht_dashboard.range('M2').api.Font.Color = 0x000000</span><span id="332a" class="oz lj it ov b gy pu pb l pc pd"># Line dividing Title and Subtitle<br/>sht_dashboard.range('L2').api.Borders(7).Weight = 3<br/>sht_dashboard.range('L2').api.Borders(7).Color = 0x00B050<br/>sht_dashboard.range('L2').api.Borders(7).LineStyle = -4115</span></pre><p id="11a7" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">上面代码片段中的副标题应该解释代码的每一部分是做什么的。</p><p id="c7f5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">12.我创建了以下函数来手动创建特定的表格格式。这是相当长的，所以我将打破它在这一步做什么。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pv pw l"/></div></figure><p id="8cea" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">上面的函数有4个输入，<code class="fe pe pf pg ov b">header_cell, title, df_summary, color</code>。</p><ul class=""><li id="a0fb" class="of og it mc b md mw mg mx mj oh mn oi mr oj mv ok ol om on bi translated">header_cell是一个字符串，表示您要放置数据帧摘要的右上角单元格(例如“B5”)。</li><li id="5a54" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated">标题是您希望为摘要命名的字符串(例如，“前8天的收入”)。</li><li id="9a59" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated">df_summary是您希望格式化并放在Excel仪表板页面上的Pandas数据框架。</li><li id="0153" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated">color是引用函数中预定义颜色的字符串(例如“蓝色”)。</li></ul><p id="c8c0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在函数中，我们首先定义一个颜色字典。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="229c" class="oz lj it ov b gy pa pb l pc pd">colors = {“purple”:[(112,48,160),(161,98,208)],<br/>“blue”:[(0,112,192),(155,194,230)],<br/>“green”:[(0,176,80),(169,208,142)],<br/>“yellow”:[(255,192,0),(255,217,102)]}</span></pre><p id="06a4" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这里我们命名了4种颜色，紫色、蓝色、绿色和黄色。对于每种颜色，在元组中有两种色调，一种较暗的色调和一种较亮的色调，两者都是RGB格式。任何颜色都可以添加到这里，如果你想扩大这个范围！</p><p id="78e1" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">其余的格式化是动态引用我们在函数输入中指定的header_cell，并自动为您格式化表格的其余部分。</p><p id="4b50" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">13.接下来，我们调用该函数4次，为我们创建的每个数据帧摘要调用一次。</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="a0db" class="oz lj it ov b gy pa pb l pc pd">create_formatted_summary('B5','Total Profit per Item', pv_total_profit, 'green')</span><span id="9cd3" class="oz lj it ov b gy pu pb l pc pd">create_formatted_summary('B17','Total Iteams Sold', pv_quantity_sold, 'purple')</span><span id="1432" class="oz lj it ov b gy pu pb l pc pd">create_formatted_summary('F17','Sales by Month', gb_date_sold, 'blue')</span><span id="836d" class="oz lj it ov b gy pu pb l pc pd">create_formatted_summary('F5','Top 5 Days by Revenue ', gb_top_revenue, 'yellow')</span></pre><p id="d0aa" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">14.最后，我们使用Matplotlib和pandas <code class="fe pe pf pg ov b">.plot()</code>函数(调用Matplotlib)制作一个图表</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="9e19" class="oz lj it ov b gy pa pb l pc pd"># Makes a chart using Matplotlib<br/>fig, ax = plt.subplots(figsize=(6,3))<br/>pv_total_profit.plot(color='g',kind='bar',ax=ax)</span><span id="381c" class="oz lj it ov b gy pu pb l pc pd"># Add Chart to Dashboard Sheet<br/>sht_dashboard.pictures.add(fig,name='ItemsChart',<br/>    left=sht_dashboard.range("M5").left,<br/>    top=sht_dashboard.range("M5").top,<br/>    update = True)</span></pre><p id="76e1" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">上面的第一部分创建了一个条形图，带有绿色的条形颜色。</p><p id="7092" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">然后<code class="fe pe pf pg ov b">sht_dashboard.pictures.add()</code> xlwings函数允许我们在Excel仪表板上放置该图表的图像。我们用<code class="fe pe pf pg ov b">left</code>和<code class="fe pe pf pg ov b">top</code>参数指定我们想把它放在哪里。<code class="fe pe pf pg ov b">name</code>也会在Excel中给我们的形象起一个名字。</p><h2 id="231c" class="oz lj it bd lk px py dn lo pz qa dp ls mj qb qc lu mn qd qe lw mr qf qg ly iz bi translated"><strong class="ak">奖金</strong></h2><p id="3b09" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">为了让你的Excel仪表盘看起来更专业，我们甚至可以<strong class="mc jd">添加一个logo </strong>。下面的代码将从Github资源库下载一个png格式的小示例徽标，保存它，将其添加到我们的Excel仪表板，然后调整其大小。<strong class="mc jd">确保你已经在</strong> <code class="fe pe pf pg ov b">FOLDER_PATH</code> <strong class="mc jd">变量中指定了保存png图像的位置。</strong>(Github上的脚本顶部)</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="a317" class="oz lj it ov b gy pa pb l pc pd">import requests</span><span id="601f" class="oz lj it ov b gy pu pb l pc pd">FOLDER_PATH = r"path_to_save_folder" # r"C:\Users\Name\Downloads"</span><span id="d038" class="oz lj it ov b gy pu pb l pc pd">image_url = r”<a class="ae lh" href="https://github.com/Nishan-Pradhan/xlwings_dashboard/blob/master/pie_logo.png?raw=true" rel="noopener ugc nofollow" target="_blank">https://github.com/Nishan-Pradhan/xlwings_dashboard/blob/master/pie_logo.png?raw=true</a>”</span><span id="d4e9" class="oz lj it ov b gy pu pb l pc pd">r = requests.get(image_url, stream = True)<br/>image_path = rf"{FOLDER_PATH}\logo.png"</span><span id="b6a3" class="oz lj it ov b gy pu pb l pc pd"># Saves image to image_path above<br/>file = open(image_path, "wb")<br/>file.write(r.content)<br/>file.close()</span><span id="25b7" class="oz lj it ov b gy pu pb l pc pd"># Adds image to Excel Dashboard<br/>logo = sht_dashboard.pictures.add(image=image_path,<br/>    name='PC_3',<br/>    left=sht_dashboard.range("J2").left,<br/>    top=sht_dashboard.range("J2").top+5,<br/>    update=True)</span><span id="3ddd" class="oz lj it ov b gy pu pb l pc pd"># Resizes image<br/>logo.width = 54<br/>logo.height = 54</span></pre><p id="5c79" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们现在已经为数据集创建了仪表板摘要！不要忘记通过运行以下命令来保存它:</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="00df" class="oz lj it ov b gy pa pb l pc pd">wb.save(rf”{FOLDER_PATH}\fruit_and_veg_dashboard.xlsx”)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qh"><img src="../Images/1f6d304901ea995ca47f180f40da7d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9w0oAqIIwJCpGDWtfvPkKQ.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者使用xlwings | GIF格式的摘要表</p></figure><h1 id="043c" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">结论</strong></h1><p id="4971" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">用不多的代码，我们创建了一个美观的仪表板，可以快速汇总我们的数据。用Python来做这件事的优点是易于阅读的语法、相对较少的代码行和使用第三方模块的组合，这可以节省我们总结数据的大量时间。</p><p id="d447" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">使用Python格式化Excel报表可以是手动创建Excel报表(或使用VBA)和用替代报表软件完全替换Excel之间的中间步骤。能够以这种粒度级别与Excel进行交互使您能够加快工作流程、自动化报告并提高Python编码技能，同时为最终用户提供熟悉的输出。</p><p id="ece7" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这段代码应该足以让您入门；你可以随意定制。尝试改变颜色，边框，标题，背景色，标志，这里提到的几乎任何东西都可以改变，以符合你想要的风格。</p><p id="f634" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">任何创建函数以编程方式排列这些格式化摘要的人都会得到加分！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><p id="d369" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">本教程中使用的代码可从Github <a class="ae lh" href="https://github.com/Nishan-Pradhan/xlwings_dashboard" rel="noopener ugc nofollow" target="_blank"> <em class="qi">这里</em> </a>获得</p><p id="edfa" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果你被卡住了，检查xlwings文档<a class="ae lh" href="https://www.xlwings.org/" rel="noopener ugc nofollow" target="_blank"> <em class="qi">这里</em> </a></p><p id="9fc2" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果你还有任何问题，请在下面的评论区留言。</p><p id="d579" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="qi">注:本文仅代表个人观点和经验。</em></p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><div class="ks kt ku kv gt ne"><a rel="noopener follow" target="_blank" href="/one-useful-way-to-track-the-end-of-lockdown-using-python-936809116a0a"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jd gy z fp nj fr fs nk fu fw jc bi translated">使用Python跟踪锁定结束的一种有用方法</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">使用Python和OpenTable的行业公开可用数据来跟踪全球从封锁和…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">towardsdatascience.com</p></div></div><div class="nn l"><div class="qj l np nq nr nn ns lb ne"/></div></div></a></div></div></div>    
</body>
</html>