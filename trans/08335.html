<html>
<head>
<title>Python Project’s Structure P2C</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python项目的结构P2C</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-projets-structure-p2c-b2f92ab15c55?source=collection_archive---------31-----------------------#2021-07-31">https://towardsdatascience.com/python-projets-structure-p2c-b2f92ab15c55?source=collection_archive---------31-----------------------#2021-07-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/d0a2167bad247a7baab2a54f4fc2b563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uogTxM0a-lVa__VkjFBjew.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">在<a class="ae jg" href="https://unsplash.com/s/photos/python?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jg" href="https://unsplash.com/@hiteshchoudhary?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Hitesh Choudhary </a>拍摄的照片</p></figure><div class=""/><div class=""><h2 id="94dc" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">从管道到代码</h2></div><p id="49e0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为一名程序员，我发现编码是一门艺术。当从事一个复杂的项目时，为了开发一个连贯、可靠和可持续的代码，需要遵循许多步骤，这些代码可以被其他贡献者阅读和恢复:</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lu"><img src="../Images/fad8ffcf87584c9bb9601197dd5ff946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoLPMkfyqAXueUd1nYEJ0A.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><ul class=""><li id="ec70" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">首先，为了满足正确的需求，理解问题是至关重要的</li><li id="47c3" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">这个项目可以被分割成多个子项目，这些子项目有助于完成任务，尤其是协作</li><li id="e818" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">您的管道是您的子项目的直接结果</li><li id="7206" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">代码的结构应该遵循相同的分段，这样您就可以拥有相同的管道和技术逻辑</li><li id="0772" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">为了有效地开发您的代码，可以在每个片段中遵循循序渐进的步骤</li></ul><p id="a973" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我们将看到如何从一个业务需求到一个简单易懂的全功能<strong class="la jk"> python </strong>代码。</p><h1 id="4f22" class="mn mo jj bd mp mq mr ms mt mu mv mw mx kp my kq mz ks na kt nb kv nc kw nd ne bi translated">目录</h1><p id="07cd" class="pw-post-body-paragraph ky kz jj la b lb nf kk ld le ng kn lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">摘要如下:</p><ol class=""><li id="cbe1" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt nk mf mg mh bi translated">项目示例</li><li id="9d36" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt nk mf mg mh bi translated">设计机构</li><li id="2433" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt nk mf mg mh bi translated">Python中的导入</li></ol></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="6107" class="mn mo jj bd mp mq ns ms mt mu nt mw mx kp nu kq mz ks nv kt nb kv nw kw nd ne bi translated">项目示例</h1><p id="af60" class="pw-post-body-paragraph ky kz jj la b lb nf kk ld le ng kn lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">为了便于说明，我们将考虑以下业务需求:</p><blockquote class="nx ny nz"><p id="5195" class="ky kz oa la b lb lc kk ld le lf kn lg ob li lj lk oc lm ln lo od lq lr ls lt im bi translated">作为一名<strong class="la jk">高速公路经理</strong>，我希望使用给定的路线对车辆进行<strong class="la jk">每日计数。为了回答这一需求，一个数据科学团队被投入到该项目中，并决定使用一个固定的摄像头，并计数<strong class="la jk">车牌的唯一编号。<br/> </strong>(其中一个建议)</strong></p></blockquote><p id="0d92" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个想法可以看作是几个步骤的顺序<em class="oa">(其中一个简化的分解)</em>:</p><ul class=""><li id="f6d3" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">车辆检测</li><li id="ba1c" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">车牌检测</li><li id="b18b" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">车牌的光学字符识别</li></ul><p id="7f03" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，下面的管道:</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/dad3830965f9def64a47c11ee1032d06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8HDpcthlm_YYMuq7U6KV1w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="122a" class="mn mo jj bd mp mq ns ms mt mu nt mw mx kp nu kq mz ks nv kt nb kv nw kw nd ne bi translated">项目的组织</h1><p id="8b3f" class="pw-post-body-paragraph ky kz jj la b lb nf kk ld le ng kn lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">给定上面的管道，可以如下组织代码:</p><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="de2e" class="ok mo jj og b gy ol om l on oo">|--<strong class="og jk">data/ </strong><em class="oa">#useful to store temporary files for instance</em><br/>|--<strong class="og jk">Tests/ </strong><em class="oa">#hosts the functional unit testings of your code/api</em><br/>|--<strong class="og jk">notebooks/ </strong><em class="oa">#helpful for testing and developping and debugging</em><br/>|--|--develop.ipynb<br/>|--<strong class="og jk">weights/ </strong>#weights are kept a part for easier manipulation</span><span id="685a" class="ok mo jj og b gy op om l on oo">|--<strong class="og jk">counthighwaypy/ </strong><em class="oa">#folder hosting your entire code<br/></em>|--|--<strong class="og jk"><em class="oa">detectvehicle/ </em></strong><em class="oa">#1st brick of your pipeline</em><br/>|--|--|--detect_vehicle_main.py<br/>|--|--|--detect_vehicle_utils.py<br/>|--|--|--detect_vehicle_conf.py<br/>|--|--|--Tests/ #independant unit testings relative to 1st brick<br/>|--|--<strong class="og jk"><em class="oa">detectlicenseplate/ </em></strong><em class="oa">#2nd brick of your pipeline</em><br/>|--|--|--licence_plate_main.py<br/>|--|--|--licence_plate_utils.py<br/>|--|--|--licence_plate_conf.py<br/>|--|--|--Tests/ #independant unit testings relative to 1st brick<br/>|--|--<strong class="og jk"><em class="oa">ocrlicenseplate/ </em></strong><em class="oa">#3rd brick of your pipeline</em><br/>|--|--|--ocr_license_main.py<br/>|--|--|--ocr_license_utils.py<br/>|--|--|--ocr_license_conf.py<br/>|--|--|--Tests/ #independant unit testings relative to 1st brick<br/><br/>|--|--utils.py<br/>|--|--conf.py <em class="oa">#! very  important file (see below)</em><br/>|--|--main.py <em class="oa"># </em>orchestrator of the different bricks<br/>|--|--Tests/ <em class="oa">#E2E technical unit testings</em></span><span id="b26f" class="ok mo jj og b gy op om l on oo">+--README.md<br/>+--app.py <em class="oa">#hosts your API and calls the main.py</em><br/>+--packages.txt <em class="oa">#python environment</em><br/>+--launch_tests.sh <em class="oa">#functional unit testings</em><br/>+--pytest.ini<br/>+--Dockerfile</span></pre><p id="b64a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如前一节所述，存储库的结构遵循管道中相同的逻辑。</p><ul class=""><li id="9aec" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">每个<strong class="la jk">brick</strong>hosts:<br/><strong class="la jk">+utils</strong>文件:包含您的brick <br/> <strong class="la jk"> + conf </strong>文件的所有辅助函数:包含所有常量参数(变量名称、目录、超参数值……)<br/>+T9】+main文件:通常包含一个函数，该函数集合了<em class="oa"> utils </em>文件<br/> <strong class="la jk"> + Tests </strong>文件夹:包含<a class="ae jg" rel="noopener" target="_blank" href="/data-scientists-starter-pack-32ef08f7829c">单元测试</a><a class="ae jg" rel="noopener" target="_blank" href="/data-scientists-starter-pack-32ef08f7829c">这是实现更快、更有效调试的基本原则。</a></li><li id="af98" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">当处理机器学习算法时，最好将潜在的<strong class="la jk">权重</strong>存储在项目的根，因为在开发过程中它们可能会经常被替换。</li><li id="55a4" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">使用<strong class="la jk">笔记本可以轻松尝试新功能。</strong>根据给定的结构，每个都应该包含以下python代码，以便能够“看到”和导入模块<strong class="la jk"> counthighwaypy: </strong></li></ul><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="f4fe" class="ok mo jj og b gy ol om l on oo">import os<br/>import sys<br/>sys.path.insert(0, os.path.abspath("../")) #visible parents folders<br/>from counthighwaypy import ...</span><span id="68b1" class="ok mo jj og b gy op om l on oo">### your code</span></pre><ul class=""><li id="a7ef" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">在模块<strong class="la jk"> counthighwaypy </strong>中，重要的是要有一个<strong class="la jk"> utils </strong>文件、<strong class="la jk"> conf </strong>和<strong class="la jk"> main </strong>文件，<strong class="la jk">在不忘记E2E <strong class="la jk">测试</strong>的情况下协调</strong>不同的砖块</li><li id="4c75" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated"><strong class="la jk"> conf </strong>文件非常重要，因为它设置了项目的<strong class="la jk">根目录及其不同的<strong class="la jk">子模块</strong>和<strong class="la jk">目录</strong>。可以这样写:</strong></li></ul><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="6cb3" class="ok mo jj og b gy ol om l on oo">import os<br/>PROJECT_ROOT = os.path.realpath(os.path.join(os.path.realpath(__file__), "../.."))</span><span id="a3cc" class="ok mo jj og b gy op om l on oo">##### directories<br/>DATA = os.path.join(PROJECT_ROOT, "data/")<br/>NOTEBOOK= os.path.join(PROJECT_ROOT, "notebooks")</span><span id="3547" class="ok mo jj og b gy op om l on oo">SRC = os.path.join(PROJECT_ROOT, "counthighwaypy/")<br/>WEIGHTS = os.path.join(PROJECT_ROOT, "weights/")</span><span id="94e5" class="ok mo jj og b gy op om l on oo">MODULE_DETECT_VEHICLE = os.path.join(SRC, "detectvehicle/")<br/>MODULE_DETECT_LICENCE_PLATE = os.path.join(SRC, "detectlicenseplate/")<br/>MODULE_OCR_LICENSE_PLATE = os.path.join(SRC, "ocrlicenseplate/")</span></pre><ul class=""><li id="a85c" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated"><strong class="la jk"> app </strong>文件将您的项目封装到一个<a class="ae jg" rel="noopener" target="_blank" href="/api-flask-fastapi-http-postman-e1673d672596"> API </a>中，该API可供其他用户和服务使用</li><li id="aff1" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">附加文件如<strong class="la jk"> packages.txt </strong>、<strong class="la jk"> pytest.ini、</strong>和<strong class="la jk"> Dockerfile </strong>放在项目的根目录下</li></ul><p id="0006" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦代码的结构设置好了，最好以独立于其他模块的<strong class="la jk">独立格式</strong>开发<strong class="la jk">每个模块</strong>。也就是说，这里有一些你可以遵循的指导方针:</p><ul class=""><li id="8ec3" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">设置<strong class="la jk">格式</strong>的<strong class="la jk">输入&amp;输出</strong>每块砖，其中输出的砖<strong class="la jk">IT71】是输入的砖<strong class="la jk">I+1T75】</strong></strong></li><li id="a1a5" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">用简单的方式编写<strong class="la jk">代码的画布</strong>(空函数)当你阅读它的时候，你会立刻明白这个脚本是做什么的</li><li id="c28c" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">不要忘记<strong class="la jk">的签名</strong>和<strong class="la jk">的评论</strong></li><li id="853c" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">使用code v <strong class="la jk">版本工具</strong>，<a class="ae jg" rel="noopener" target="_blank" href="/all-you-need-to-know-about-git-github-gitlab-24a853422ff3"> git </a>进行更有效的协作</li><li id="8af9" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">使用<a class="ae jg" rel="noopener" target="_blank" href="/keep-your-code-clean-using-black-pylint-git-hooks-pre-commit-baf6991f7376"> <strong class="la jk">代码格式器</strong>和<strong class="la jk">代码转换器</strong> </a>保持代码整洁</li><li id="e8e9" class="lz ma jj la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">对于跨团队协作，将您的代码/包公开为可消费的<a class="ae jg" rel="noopener" target="_blank" href="/api-flask-fastapi-http-postman-e1673d672596"> API </a></li></ul></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="e93f" class="mn mo jj bd mp mq ns ms mt mu nt mw mx kp nu kq mz ks nv kt nb kv nw kw nd ne bi translated">Python中的导入</h1><p id="7e28" class="pw-post-body-paragraph ky kz jj la b lb nf kk ld le ng kn lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">从Python 3.3开始，文件夹<strong class="la jk"> folderame </strong>被认为是一个模块(<strong class="la jk">，不需要</strong><strong class="la jk">_ _ init _ _。py </strong>文件)并且可以简单地<strong class="la jk">导入</strong>到python文件中，只要它是可见的，即在<strong class="la jk">相同的树级</strong>上，通过使用:</p><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="80d9" class="ok mo jj og b gy ol om l on oo">import foldername</span></pre><p id="88ce" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们有以下结构:</p><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="4047" class="ok mo jj og b gy ol om l on oo">|--<strong class="og jk">FOLDER1/ </strong><br/>|--|--file1.py<br/>|--<strong class="og jk">FOLDER2/ </strong><br/>|--|--file2.py<br/>|--main.py</span></pre><ul class=""><li id="1deb" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">在main.py中，我们可以</li></ul><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="5a6a" class="ok mo jj og b gy ol om l on oo">import FOLDER1.file1<br/>import FOLDER2.file2</span></pre><ul class=""><li id="5882" class="lz ma jj la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">要在文件1中导入文件2:</li></ul><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="1607" class="ok mo jj og b gy ol om l on oo">import os<br/>import sys</span><span id="c0a0" class="ok mo jj og b gy op om l on oo">#make FOLDER2 visible to file1 (one step up in the tree)<br/>sys.path.insert(0, os.path.abspath("../"))</span><span id="ab20" class="ok mo jj og b gy op om l on oo">from FOLDER2 import file2</span></pre><p id="e55c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在一个复杂的python项目中，为了保持你的<strong class="la jk">导入</strong> <strong class="la jk">的一致性，</strong>建议从你代码的源<strong class="la jk">开始<strong class="la jk">所有的</strong>。在我们的例子中，在任何。包含以下内容的py文件:</strong></p><pre class="lv lw lx ly gt of og oh oi aw oj bi"><span id="f34d" class="ok mo jj og b gy ol om l on oo">from counthighwaypy.xxx.xxx import xxx</span></pre></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="c06b" class="mn mo jj bd mp mq ns ms mt mu nt mw mx kp nu kq mz ks nv kt nb kv nw kw nd ne bi translated">结论</h1><p id="4107" class="pw-post-body-paragraph ky kz jj la b lb nf kk ld le ng kn lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">还有其他方法来构建您的python项目，但是我发现本文中描述的方法简单易懂，易于掌握。也可以应用于Python以外的语言。</p><p id="aecf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望你喜欢阅读这篇文章，它将帮助你在未来更好地组织你的工作。欢迎所有的评论和建议！</p></div></div>    
</body>
</html>