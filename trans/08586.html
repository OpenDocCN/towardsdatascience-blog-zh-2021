<html>
<head>
<title>Deep Learning for Object Detection: Beginners Friendly Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">物体检测的深度学习:初学者友好指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-for-object-detection-beginners-friendly-guide-ae1180b34042?source=collection_archive---------16-----------------------#2021-08-08">https://towardsdatascience.com/deep-learning-for-object-detection-beginners-friendly-guide-ae1180b34042?source=collection_archive---------16-----------------------#2021-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8837" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">人工智能工程师的研究和行业趋势</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3ec75331355bb7d6a5104e10e6e7f764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kPBjcWxafv95KCtjXGL2uQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><h1 id="03e2" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">背景</h1><p id="58b9" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">当我在2018年实习时，我开始研究物体检测技术，因为我需要解决一个视觉检查问题。这个问题需要在来自工业相机的图像流中检测许多不同的对象。</p><p id="9808" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">为了应对这个挑战，我首先尝试将分类与滑动窗口结合使用！自然，这个系统非常慢，不适合生产。</p><p id="1ae2" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在这之后，我开始研究执行对象检测的端到端深度学习模型。我偶然发现了google research的一篇著名论文，题目是:</p><blockquote class="mr"><p id="a46c" class="ms mt it bd mu mv mw mx my mz na ml dk translated">现代卷积目标探测器的速度/精度权衡</p></blockquote><p id="77c6" class="pw-post-body-paragraph lq lr it ls b lt nb ju lv lw nc jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">这篇论文是我对使用深度学习的对象检测领域的介绍。</p><h1 id="d58a" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">物体检测是一个古老的任务，深度学习给它带来了什么？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/7816afe9fda9260a80c0acb72afc41b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fw_TNb2-zG19LX9EWIKupA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><p id="bf95" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">目前，目标检测是计算机视觉领域中一个比较古老的课题。在深度学习成为主流之前，许多研究人员和工程师都在研究这个问题。他们主要使用经典的图像处理技术，他们可能经常使用滑动窗口方法。那么深度学习对物体检测的附加值是什么呢？</p><p id="77ae" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">事实上，深度学习从根本上改变了我们进行物体检测的方式。随着YOLO和R-CNN系列的引入，对象检测的性能显著提高。大多数用于图像相关任务的神经网络使用卷积层。这些神经网络被称为CNN(卷积神经网络)。这些CNN实际上自然而有效地执行了一种滑动窗口方法。这是神经网络学习图像表现方式的一部分。</p><h1 id="9fc9" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">目标检测的研究现状</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/16cefc7292ed172b1f3098c2c435093f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UaqCFVcI1b1RzvW4_AEHDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><p id="093b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在我写这篇文章的时候，谈论最多的对象检测模型是YOLOR(你只学习一种表示)。设计该模型架构的研究人员正在寻找整合“隐性知识”的方法。这种隐性知识应该代表神经网络中的潜意识。作者希望建立一个架构，模仿我们人类在现实生活中如何解决对象检测任务。这种架构可能是未来工作的一个种子，该工作集成了隐式知识的概念，不仅用于对象检测，还用于各种计算机视觉任务。</p><p id="31b2" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">还有另一种建筑可以成为未来许多作品的种子，那就是DETR建筑。DETR代表检测变压器。</p><p id="8fb2" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">变压器是一种新型的神经层，它们正在与卷积层竞争大量的计算机视觉任务。</p><p id="5886" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">变形金刚已经在NLP(自然语言处理)任务中显示出巨大的成果，并且他们正在稳步进入计算机视觉任务。</p><h1 id="a835" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">工业中物体检测的现状</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/6b985fc3e4a3e93a774893d92ad9694d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tVKbUwJANfQ3bgOFcDLdDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><p id="5916" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在过去的几年里，我一直是一名机器学习工程师，专注于计算机视觉应用。通过在这个领域工作，也通过对需要机器学习和计算机视觉知识的职位进行几次面试，我实际上注意到了这个行业中物体检测的一些趋势。</p><p id="cce1" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果你在这个行业工作，那么你肯定知道一项任务的最重要的指标可能与研究中使用的指标非常不同，对于同样的任务！</p><p id="03eb" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在对象检测任务的情况下，同样的事情适用。据我所知，在工业环境中实现目标检测模型时，有两个指标是最重要的:速度和鲁棒性。并不总是两者都有，但两者中至少有一个总是有的。</p><p id="4a7e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">基于这些原因，<strong class="ls iu"><em class="nh">【v3，v4，V5】</em></strong><strong class="ls iu"><em class="nh">更快——RCNN</em></strong>在业界得到了广泛的应用。通常，当速度是第一优先考虑的因素时，使用YOLO，当鲁棒性是第一要求时，使用更快的RCNN。</p><p id="9277" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我亲自和<strong class="ls iu"> <em class="nh"> YOLOv3，SSD </em> </strong>和<strong class="ls iu"><em class="nh">fast合作过——RCNN</em></strong>。</p><p id="8c12" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">虽然很多在这个行业工作的人直接去了YOLO——我猜是因为它的好名声——但我不认为这是一个万能的解决方案。</p><p id="f217" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">谈到推理速度，YOLO和SSD都显示出了巨大的潜力。但是在某些情况下，他们仍然可能失败，特别是在工业领域。</p><p id="f39d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我记得我曾尝试使用带有InceptionV2  后端的<strong class="ls iu"> <em class="nh"> SSD来执行一项高难度的物体检测任务。这是一项视觉检查任务，我们需要检测大型发动机(飞机或直升机，我不记得了)内部的机械部件。无论我如何调整我的神经网络的参数，我都不能让损失减少，它只是不停地振荡！</em></strong></p><p id="d67e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我以前使用过同样的架构，用同样的主干，来执行一些其他的对象检测任务，效果非常好！所以当我从事这项任务时，这无疑是更具挑战性的，SSD失败了。因为发动机看起来体积庞大，因为有许多零件连接在一起，而且许多零件看起来非常相似。即使是人眼，也很难发现我们想要检测的特定机械部件！这应该告诉你注释我们的数据集有多困难！</p><p id="22be" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">此时，我记得当时认为这只是深度学习的极限。但在完全放弃之前，我决定尝试一种不同的架构，并试图避免YOLO和SSD等一级检波器。</p><p id="1fac" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我选择了fast-RCNN，因为它是一个两阶段的对象检测模型。你瞧，这个模型工作得非常好！损失函数的收敛比保龄球还要平滑！</p><p id="3d2b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">所以下次你在做物体检测任务的时候，在你下定决心之前，尝试一些不同的架构！</p><h1 id="a3fd" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">需要云计算来提高对象检测任务的性能</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/b8f2123f7ac2bc099590b72cda9dff8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGv1mESWN5Nf3ds2tEYo6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><p id="9c0c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在训练深度学习模型的时候，尤其是大型模型的时候，你需要一些非常好的设备。说到训练，GPU可能是你的深度学习机器最重要的方面。许多公司购买这些设备，但也有许多公司选择云计算服务。</p><p id="fc14" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">谷歌云平台(GCP)、亚马逊网络服务(AWS)和微软Azure是一些广泛使用的云计算服务。</p><p id="9f44" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">对于物体检测和大型模型，如fast-RCNN，这些云计算解决方案可能正是您正在寻找的训练模型。但是应该用哪一个呢？</p><p id="d7ab" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">答案真的取决于你公司的选择。对于许多公司来说，他们已经有了云基础设施，在上述云提供商之一，所以他们可能只是想继续使用同一提供商来保持标准化。但是，如果你刚刚开始，并试图选择其中一个作为你的目标探测任务，那么请继续阅读！</p><p id="748c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">有多种方法可以训练你的物体检测模型，稍后我会详细介绍一些开源工具。但是如果你正在使用Tensorflow (1或2)，那么你可能正在使用<em class="nh"> Tensorflow对象检测API </em>。</p><p id="f0a0" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果你是，那么当谈到在云上训练对象检测模型时，Google Cloud应该是你的选择。你可能会问为什么？</p><p id="0517" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">嗯，由于Tensorflow是谷歌的产品，对象检测API也属于谷歌，谷歌云团队已经使在GCP上训练你选择的模型(从对象检测API)变得极其容易。</p><p id="d81c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">具体来说，google有2种产品可以轻松集成到您的管道中，用于训练对象检测模型。这两款产品分别是:AI平台和Vertex AI。</p><p id="6cc3" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">通过在你的机器上安装谷歌云帐户和谷歌云SDK，训练来自<a class="ae ni" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md" rel="noopener ugc nofollow" target="_blank"> <em class="nh">模型动物园</em> </a>的任何物体检测模型，变得简单明了。</p><p id="53ad" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果你想训练一个不属于模型动物园的模型(比如YOLO)，那么按照我在另一篇文章<a class="ae ni" href="https://pub.towardsai.net/beginners-helpful-guide-to-training-deep-learning-models-on-the-cloud-3202f29afd1b" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu"><em class="nh"/></strong></a>中描述的一系列步骤，在谷歌云上也是可行的。</p><h1 id="55ec" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">用于执行对象检测任务的开源深度学习工具</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/648df5685e2bf1b6b6a474e73d65cba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lE4ff9xBuFRc8r1d2Dj4RA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><p id="ef0d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">为了使用深度学习来执行对象检测，主要有三种广泛使用的工具:</p><ol class=""><li id="5189" class="nj nk it ls b lt mm lw mn lz nl md nm mh nn ml no np nq nr bi translated">Tensorflow对象检测API。</li><li id="7daf" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">探测器2。</li><li id="09d6" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">mm检测。</li></ol><p id="1573" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果你是Tensorflow开发者，那么<strong class="ls iu"> <em class="nh"> Tensorflow对象检测API </em> </strong>最适合你。如果你是PyTorch开发者，那么<strong class="ls iu"> <em class="nh"> Detectron2 </em> </strong>和<strong class="ls iu"> <em class="nh"> MMDetection </em> </strong>更适合你。</p><p id="348d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果你更关心选择的多样性，那么MMDetection是最好的选择，因为它有大量的对象检测深度学习模型。</p><p id="6c25" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这并不意味着仅仅因为一个架构不是这些工具的一部分，你就不能在其他地方找到它。例如，Tensorflow对象检测API中没有YOLO模型，但您可以使用Tensorflow从社区中轻松找到一个开源实现。</p><h1 id="427f" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="c7ba" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">总结一下，下面是这篇文章的要点:</p><ol class=""><li id="8740" class="nj nk it ls b lt mm lw mn lz nl md nm mh nn ml no np nq nr bi translated">物体检测是计算机视觉中一项相对古老的任务，但深度学习已经将物体检测任务的性能大幅提升。</li><li id="7e08" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">当涉及到用于对象检测的深度学习时，研究中推的指标可能不一定与行业中推的指标相同。</li><li id="9df1" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">云计算可以成为深度学习模型训练性能的主要助推器，明智地选择云提供商。</li><li id="03e1" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">使用深度学习进行物体检测的开源工具有几个，主要的三个是:Tensorflow物体检测API、Detectron2和MMDetection。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/22c15dab4641c5fe5b5d39b45277eca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aKXEsx4WshKq241g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><p id="7411" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我是一名机器学习工程师，致力于解决具有挑战性的计算机视觉问题。我想帮助你学习应用于计算机视觉问题的机器学习。以下是方法。</p><ol class=""><li id="80bf" class="nj nk it ls b lt mm lw mn lz nl md nm mh nn ml no np nq nr bi translated">通过帮助您了解该领域的最新动态。我几乎每天都在<a class="ae ni" href="https://www.linkedin.com/in/nour-islam-mokhtari-07b521a5/" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">【LinkedIn】</strong></a>和<a class="ae ni" href="https://twitter.com/NourIslamMo" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">Twitter</strong></a><strong class="ls iu"/>上分享小型博客帖子。那就跟我去吧！</li><li id="31cc" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">每周给你一份我的<a class="ae ni" href="https://nourislam.ck.page/dc3e8b7e12" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">时事通讯</strong> </a>上那些小帖子的摘要。所以订阅吧！</li><li id="5e51" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">通过在Medium上写关于机器学习不同主题的文章。所以跟我来吧！</li><li id="c56d" class="nj nk it ls b lt ns lw nt lz nu md nv mh nw ml no np nq nr bi translated">给你一份免费的机器学习工作清单，帮助你检查你需要学习的所有要点，如果你计划在ML，特别是在计算机视觉方面的职业生涯。你可以在这里获得核对表<a class="ae ni" href="https://www.aifee.co/free-resources" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">。</strong></a></li></ol><p id="ff29" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">5.最后但同样重要的是，通过与你分享我的<a class="ae ni" href="https://aifee.teachable.com/p/introduction-to-tensorflow-2-for-computer-vision" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">免费入门Tensorflow课程</strong> </a>，它有超过<strong class="ls iu"> <em class="nh"> 4小时</em>的视频内容</strong>，你可以在那里问我任何问题。</p><p id="5c88" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">此外，如果您有任何问题或者您只是想聊聊ML，请随时在LinkedIn或Twitter上联系我！</p></div></div>    
</body>
</html>