<html>
<head>
<title>Q&amp;A Models for specific information extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特定信息抽取的问答模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/q-a-models-for-specific-information-extraction-2a204f7f3521?source=collection_archive---------35-----------------------#2021-07-21">https://towardsdatascience.com/q-a-models-for-specific-information-extraction-2a204f7f3521?source=collection_archive---------35-----------------------#2021-07-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="829e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从非结构化文本中获取相关实体提取的转换器的能力</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2f155d1081b46ddf28e67954e603133a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3miu27UYjpLucoadBkGfg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="a992" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一天121，一个月3751，一年44165。据<a class="ae lr" href="https://www.campaignmonitor.com/resources/knowledge-base/how-many-emails-does-the-average-person-receive-per-day/#:~:text=Keeping%20all%20this%20in%20mind,will%20be%20closer%20to%20126." rel="noopener ugc nofollow" target="_blank">有人计算</a>，那是一般人收到的邮件数量。我不知道你怎么想，但对我来说，有很多邮件需要我花时间去处理…</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/9c4b0887ed18b9449e32122502f09a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*OC84u7HFC9Pan6nuVD8Wnw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="5f94" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你能根据邮件的内容、他们是否想卖东西、你是否必须回覆某人等等，立即将他们分类，那不是很好吗？？我测试了一些传统的信息提取技术以及一种更具创新性(并且相当强大)的技术。下面是它们的工作原理和不同结果的总结。</p><h1 id="ab00" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">示例电子邮件</h1><p id="8d1d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">为了保持一致，我们将使用以下示例电子邮件(主要使用GPT-3生成)来比较和观察当前针对此问题的不同解决方案:</p><blockquote class="mq mr ms"><p id="382e" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">嗨，杰克，</p><p id="8d28" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">对不起，我被我新的特斯拉汽车公司分散了注意力，恐怕我要把比特币项目的领导权交给别人了。</p><p id="128b" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">我需要一个非常非常熟练的人。你能建议我任命谁吗？埃隆·马斯克已经忙得不可开交了！</p><p id="64a3" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">非常感谢，</p><p id="0090" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">Sat。</p><p id="15a8" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">附注:我也有一辆特斯拉跑车！</p><p id="1f74" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi">—</p><p id="99a8" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">中本聪</p><p id="5b3c" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">电话号码:+1(650)566–1191</p><p id="add5" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">比特币:1 gttzecjym 19 Xu 3 IC 8 neum 7 MB 5 uzqbkd</p></blockquote><p id="797d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你很好奇，给GPT-3的输入是:“<em class="mt">这是中本聪给杰克的一封电子邮件，解释比特币网络似乎已经断开。邮件:“。</em>结果并不真正相关，但作为一个例子，效果很好。</p><h1 id="8a69" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">技术</h1><h2 id="c4bd" class="mx lu iq bd lv my mz dn lz na nb dp md le nc nd mf li ne nf mh lm ng nh mj ni bi translated">选项1:正则表达式</h2><p id="475c" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">信息提取问题最古老的解决方案是正则表达式。我们可以使用这些来从文本中提取匹配特定模式的字符串。为简单起见，我们将只提取我们应该联系的人的姓名(在许多情况下，不是发送电子邮件的人的姓名)。</p><p id="2e34" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们首先假设全名可以遵循以下格式:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="abc5" class="mx lu iq nk b gy no np l nq nr">Satoshi Nakamoto</span><span id="225a" class="mx lu iq nk b gy ns np l nq nr">Satoshi K. Nakamoto</span><span id="c08d" class="mx lu iq nk b gy ns np l nq nr">Satoshi K Nakamoto</span><span id="cb4d" class="mx lu iq nk b gy ns np l nq nr">Satoshi Nakamoto-Koa</span><span id="aad4" class="mx lu iq nk b gy ns np l nq nr">Satoshi Nakamoto Koa</span></pre><p id="4302" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，一个可能的正则表达式可能是:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="e80a" class="mx lu iq nk b gy no np l nq nr">(?:[A-Z][a-z]+)+(?:[\- ][A-Z](?:[a-z\.]+)?)+</span></pre><p id="cd74" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用regex从电子邮件中获取所有匹配项，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="8830" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它将从我们的电子邮件中选择以下字符串:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e6d0d184371bf696a1d3845a115f08ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*_GSEcHS1VzL1-CvWz7Td6w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">正则表达式提取:按作者排序的图像</p></figure><p id="4b83" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如你所看到的，这种方法有利于减少可供选择的选项数量，但是我们仍然会得到不是名字的<strong class="kx ir">字符串，并且我们没有一种有效的方法来识别重要的那个(我们不能总是选择最后一个)。</strong></p><h2 id="be9b" class="mx lu iq bd lv my mz dn lz na nb dp md le nc nd mf li ne nf mh lm ng nh mj ni bi translated">选项2:使用实体检测</h2><p id="ab1d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">解决前一个问题(检测不是名字的字符串)的常见方法是使用<a class="ae lr" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank"> spaCy </a>。</p><blockquote class="mq mr ms"><p id="7c33" class="kv kw mt kx b ky kz jr la lb lc ju ld mu lf lg lh mv lj lk ll mw ln lo lp lq ij bi translated">spaCy是一个用于高级自然语言处理的开源软件库，用编程语言Python和Cython编写。</p></blockquote><p id="3099" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">spaCy将允许我们快速建立一个实体检测器模型，这将有望帮助我们从电子邮件中提取我们想要的信息。要下载您喜欢的型号，您需要运行:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="4aad" class="mx lu iq nk b gy no np l nq nr">python -m spacy download &lt;MODELNAME&gt;</span></pre><p id="0339" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于我们将使用spaCy 3.1的transformer模型，我们需要运行:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="6972" class="mx lu iq nk b gy no np l nq nr">python -m spacy download en_core_web_trf</span></pre><p id="2efb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完整的代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="0a8b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将从我们的电子邮件中选择以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/72332d5e20b9a64aaa213e3bfb962756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*BUlrrbbj2Y57vBJgyXCXDg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">空间提取:作者提供的图像</p></figure><p id="9183" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如您所见，这个模型比regex做得好得多。它忽略了类似“<em class="mt">特斯拉Roadster </em>”或者“<em class="mt">嗨Jack </em>”这样的案例，却没有得到正确的称呼:<em class="mt">【中本聪】</em>！这可能是因为spaCy在其训练数据中从未遇到过此名称。</p><p id="cc4d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然这并没有真正改变结果…即使空间探测到了<em class="mt">“中本聪”</em>，我们仍然不知道哪个人实体是重要的。</p><p id="c7cb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">怎么才能做到呢？这可能吗？这么多问题！嗯……问题。如果我们只问计算机哪个名字是重要的呢？！让我们试试那个。</p><p id="6366" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">选项3A: Q &amp;变压器型号</strong></p><p id="11b0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用一个已经通过像<a class="ae lr" href="https://rajpurkar.github.io/SQuAD-explorer/" rel="noopener ugc nofollow" target="_blank"> SQuAD </a>这样的问答数据集进行了微调的转换器，将允许我们向它询问任何关于它接收的上下文(在这种情况下是电子邮件)的问题。</p><p id="53d2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">令人欣慰的是，HuggingFace库包含了许多预先训练好的模型，可以开箱即用。为简单起见，我们将使用其中的一个，因为不是每个人都能负担得起像伯特那样大的TPU现成模型。你可以随意看看他们的型号目录，选择你最喜欢的型号。我将使用<em class="mt">"</em><a class="ae lr" href="https://huggingface.co/bert-large-uncased-whole-word-masking-finetuned-squad" rel="noopener ugc nofollow" target="_blank">Bert-large-un cased-whole-word-masking-fine tuned-squad</a><em class="mt">"</em>模型，根据他们的说法，该模型实现了93.15的F1分数。</p><p id="5b13" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">像spaCy一样，HuggingFace也有一个API，允许用户快速与预先训练好的模型进行互动，以完成特定任务:<a class="ae lr" href="https://huggingface.co/transformers/main_classes/pipelines.html" rel="noopener ugc nofollow" target="_blank">管道</a>。</p><p id="7f35" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在此之前，我们首先需要知道要问哪些问题。以下是我能想到的问模特的五个问题:</p><ul class=""><li id="0eb8" class="nx ny iq kx b ky kz lb lc le nz li oa lm ob lq oc od oe of bi translated">他叫什么名字？</li><li id="e6d4" class="nx ny iq kx b ky og lb oh le oi li oj lm ok lq oc od oe of bi translated">她叫什么名字？</li><li id="2964" class="nx ny iq kx b ky og lb oh le oi li oj lm ok lq oc od oe of bi translated">他们叫什么名字？</li><li id="aff6" class="nx ny iq kx b ky og lb oh le oi li oj lm ok lq oc od oe of bi translated">这是谁送的？</li><li id="2aea" class="nx ny iq kx b ky og lb oh le oi li oj lm ok lq oc od oe of bi translated">寄这个的人叫什么名字？</li></ul><p id="d298" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们有了问题，我们的代码看起来像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="4aa6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它为每个答案输出以下概率:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/b22aafbf012b08beb7c83f72ce7d258b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*vNeUffP4dDsUhcyglAZ41w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">问答模型提取:作者图片</p></figure><p id="cc3d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mt">【特斯拉汽车公司】</em><em class="mt">【聪】</em><em class="mt">【特斯拉】</em>？这里我们有一个类似于正则表达式提取(选项1)的问题:我们得到的格式看起来不像我们想要的格式，并且实体不是一个名称。</p><p id="ea36" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要解决这个问题，我们有三个选择:我们可以使用regex、spaCy，或者两者都用。因为我们已经看到spaCy不能检测名字<em class="mt">“中本聪”</em>作为一个人，我们将使用正则表达式。您应该尝试使用spaCy，因为它在其他情况下也很有用。如果你想冒险，两者同时尝试。</p><p id="8968" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">选项3B: Q &amp;变压器型号+正则表达式过滤</strong></p><p id="a28c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">加上我们在选项1中看到的过滤步骤，我们得到:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="8080" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们运行这个代码，我们会得到这些新的概率:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/dab58216f024a63b1fc989bb2bcf78ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*qNprZntDK8nrxFQdNHsr-A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">问答模型提取+正则表达式:作者图片</p></figure><h1 id="6148" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结果</h1><p id="3cc2" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我们走吧！跳出思维定势，我们能够从文本中提取相关信息。想想看:如果你有关于邮件的问题，直接问电脑！；)</p><p id="00fa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是我问这位模特的其他问题，我觉得很有趣。尝试你自己的问题，看看模型给你什么答案，但是如果不是关于名字的话，记得移除/改变正则表达式检查！</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="b473" class="mx lu iq nk b gy no np l nq nr">Q: What is his phone number?<br/>A: +1 (650) 566–1191 -- 91.74% Sure</span><span id="4c66" class="mx lu iq nk b gy ns np l nq nr">Q: What does he need?<br/>A: someone really really skilled -- 42.43% Sure</span><span id="5c50" class="mx lu iq nk b gy ns np l nq nr">Q: What is his bitcoin wallet address?<br/>A: 1GttzecjYm19xu3iC8i8NEuM7mB5uZQbKD -- 1.72% Sure</span><span id="864e" class="mx lu iq nk b gy ns np l nq nr">Q: What car does he have?<br/>A: Tesla Roadster -- 75.22% Sure</span><span id="39e6" class="mx lu iq nk b gy ns np l nq nr">Q: Who doesn't have time?<br/>A: Elon Musk -- 95.99% Sure</span></pre><h1 id="337f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="394d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">尝试非传统的方法有时能给你更好的效果！即使有数据集可以提取相关信息，如<a class="ae lr" href="https://www.cs.cmu.edu/~einat/datasets.html" rel="noopener ugc nofollow" target="_blank">安然人名注释数据集</a>，但它们都没有包含足够的信息用于此目的。</p><p id="5510" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我很高兴看到机器学习社区的未来，以及这些超级强大的模型如何用于日常目的。</p><p id="38b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">全Colab笔记本</strong>:<a class="ae lr" href="https://colab.research.google.com/drive/1nCTYA2QWxov77GzBFuA9nndv3QUZInns?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1 nctya 2 qwxov 77 gzbfua 9 nndv 3 quzinns？usp =共享</a></p></div></div>    
</body>
</html>