<html>
<head>
<title>Effect of Unbalanced and Mixed Dataset on ML Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不平衡和混合数据集对ML模型的影响</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/effect-of-unbalanced-and-mixed-dataset-on-ml-model-3f0b9190baa7?source=collection_archive---------23-----------------------#2021-07-16">https://towardsdatascience.com/effect-of-unbalanced-and-mixed-dataset-on-ml-model-3f0b9190baa7?source=collection_archive---------23-----------------------#2021-07-16</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="6dd9" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">基于精确度、召回率和F1分数评估ML模型</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/5f035bfaf77a61cb57cc42e2c77fe222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76brkLd-fGEfQ70ZEvaLzQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://unsplash.com/photos/SgelGkaMdM0" rel="noopener ugc nofollow" target="_blank"> unsplash </a></p></figure><blockquote class="la lb lc"><p id="7c1b" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">简介</strong></p></blockquote><p id="4bde" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">机器学习需要创建强大的训练数据集，因为训练是后续模型评估的种子。如果训练数据被破坏，模型将表现不佳，因为其准确性将下降。图像分类是机器学习的一个蓬勃发展的领域，其中平衡和正确的训练数据集极其重要。人工智能经理和数据科学家需要确保在管道中加载平衡和干净的数据。</p><blockquote class="la lb lc"><p id="f88f" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">分类指标</strong></p></blockquote><p id="fdc0" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">评估一个模型有几个指标。对于图像分类，我们可以采用测试目录来应用训练好的模型的预测行为。Scikit-Learn提供了一些简单的包来评估模型在准确性、精确度、召回率和F1分数方面的性能。分类报告是所有这些指标的组合。我将简要介绍一下这些指标。</p><blockquote class="la lb lc"><p id="837f" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">精度</strong></p></blockquote><p id="839c" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">当我们试图猜测两件事之间的某件事时，我们有50%的可能出错。这就是我们正确识别某物的精确度。机器也是如此。机器被训练来创建模型，并且基于训练数据，它可能正确地识别所有的测试数据，或者一些可能出错。比方说，我们希望模型能够识别猫和狗之间的图像。我们已经用猫和狗的图像训练了模型。该模型可以正确地识别所有图像，或者一些图像可能被错误地标记。相关术语如下</p><ul class=""><li id="6e4d" class="md me iu lg b lh li lk ll ma mf mb mg mc mh lz mi mj mk ml bi translated">真阳性(TP):被识别为猫的猫</li><li id="8c6a" class="md me iu lg b lh mm lk mn ma mo mb mp mc mq lz mi mj mk ml bi translated">假阳性(FP):被识别为猫的狗</li><li id="bdc4" class="md me iu lg b lh mm lk mn ma mo mb mp mc mq lz mi mj mk ml bi translated">真阴性(TN):被识别为狗的狗</li><li id="df03" class="md me iu lg b lh mm lk mn ma mo mb mp mc mq lz mi mj mk ml bi translated">假阴性(FN):被识别为狗的猫</li></ul><p id="4a44" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">很明显，当一个模型不能正确地标记某些东西时，它会增加假阳性或假阴性的数量。我们希望模型具有最高数量的真阳性和真阴性。根据这些结果来更好地评估一个模型，精确度和召回率是很方便的。简而言之，<em class="lf">精度</em>衡量一个模型正确检测元素的精度。当一个猫狗检测模型的精度较高时，表明它能够正确识别出大多数的猫是猫，极少数的狗是猫。该模型也可能错误地将一些猫识别为狗图像，但是该信息不在<em class="lf">精度</em>值中。为此我们需要<em class="lf">召回</em>。</p><blockquote class="mr"><p id="416a" class="ms mt iu bd mu mv mw mx my mz na lz dk translated">精度= TP/(TP+FP)</p></blockquote><figure class="nc nd ne nf ng ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nb"><img src="../Images/dd9dae393d4997524461af38e55247cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1d3KIprFRBH1dZ8J.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">来自<a class="ae kz" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">维基百科</a>的精确度和召回率</p></figure><blockquote class="la lb lc"><p id="1626" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">召回</strong></p></blockquote><p id="f557" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">召回是模型评估的另一个度量。它衡量模型检测所有事件的能力。</p><blockquote class="mr"><p id="e8ed" class="ms mt iu bd mu mv mw mx my mz na lz dk translated">召回= TP/(TP+FN)</p></blockquote><p id="f677" class="pw-post-body-paragraph ld le iu lg b lh nh jv lj lk ni jy lm ma nj lp lq mb nk lt lu mc nl lx ly lz in bi translated">当上述模型的召回值高时，表明它能够正确地将大多数猫的图像识别为猫，而将极少数猫识别为狗。</p><p id="e20d" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在这个模型中我们有两个类，即猫和狗。对于一个类，如果召回率高而准确率低，就意味着模型偏向于那个特定的类。例如，如果猫的召回率高但精确度低，则该模型能够正确地将大多数猫图像识别为猫，但是它也错误地将许多狗图像识别为猫。另一方面，如果猫的召回率低但精确度高，则表明该模型能够正确地将大多数猫的图像识别为猫，但同时，它也将许多猫的图像错误地识别为狗。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nm"><img src="../Images/4f64268da2ef0b1ac6bdaa7c5c108385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rn6ze8GcSmP6eF-cDOVeDQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><blockquote class="la lb lc"><p id="abc5" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv"> X射线图像数据集</strong></p></blockquote><p id="c15a" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我写了一篇关于正常型和肺炎型X线影像分类的博客。在这里，我演示了识别模型的训练和评估步骤。</p><div class="nn no gq gs np nq"><a rel="noopener follow" target="_blank" href="/x-ray-image-classification-and-model-evaluation-7810044c0ff5"><div class="nr ab fp"><div class="ns ab nt cl cj nu"><h2 class="bd iv gz z fq nv fs ft nw fv fx it bi translated">x射线图像分类和模型评估</h2><div class="nx l"><h3 class="bd b gz z fq nv fs ft nw fv fx dk translated">基于张量流的胸部x光图像肺炎检测</h3></div><div class="ny l"><p class="bd b dl z fq nv fs ft nw fv fx dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe kt nq"/></div></div></a></div><p id="f336" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在本文中，我将使用相同的数据集，但做了一些修改以反映现实世界中的问题。我已经为训练、验证和测试创建了三个独立的数据集。</p><ul class=""><li id="9ff6" class="md me iu lg b lh li lk ll ma mf mb mg mc mh lz mi mj mk ml bi translated">第一数据集:在训练中，它是具有500个正常图像和500个肺炎图像的平衡数据集</li><li id="b492" class="md me iu lg b lh mm lk mn ma mo mb mp mc mq lz mi mj mk ml bi translated">第二数据集:它是在训练中具有500个正常图像和250个肺炎图像的不平衡数据集</li><li id="cac7" class="md me iu lg b lh mm lk mn ma mo mb mp mc mq lz mi mj mk ml bi translated">第三个数据集:它是一个混合但平衡的数据集。250个正常图像被有意标记为肺炎，250个肺炎图像被有意标记为正常。</li></ul><p id="e7af" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">这个<a class="ae kz" href="https://mdsohelmahmood.github.io/2021/06/21/X-ray-image-classification.html" rel="noopener ugc nofollow" target="_blank"> Github页面</a>提供了训练和评估模型的代码块。当使用第一个数据集时，我们在50个历元后得到以下损失和准确度。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj of"><img src="../Images/2932097e6b7ad1408aae641d2b039ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*qu14OvJhbKJFkImW9a056Q.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">平衡数据集的损失</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj og"><img src="../Images/c37db70bdcaa50c7b1a89cb3bc949c2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*aSAjwFSA0thoRNsZdqZ37A.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">平衡数据集的准确性</p></figure><p id="2544" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">显然，我们用训练数据过度拟合了模型。我们可以用其他技术来改进模型，以减少过度拟合，但这里我们关注的是平衡和不平衡数据报告之间的比较。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oh oi l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/68d1e3de1a6a077df67bf065a8cd5333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3PSvdSTRaNDRHEE0S1qLQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图像识别</p></figure><p id="f248" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">第二个和第三个数据集的损失和精度如下所示</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/b34945dfcc9f908f4682473656756dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*sGTGS-iAkTyBXYliHIBwvA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">不平衡数据集的损失</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/96ed198b0239047ab7150c489e6a1f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*rt0kO_KxpOEORWHEZP3vjQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">不平衡数据集的准确性</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/de23c61ebc11b30875c55c5911c8b988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*8lxz2IWeW2pUmWYx6YRYYg.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">混合数据集的损失</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/4b000d13aab1a7335eb1615585e2930f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*vRiQLpFWUiUWE_diAyC3HA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">混合数据集的准确性</p></figure><p id="e42a" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">混合数据集非常脏，最终精度非常低。一旦代码被执行，地面真相连同被识别为正常的概率以及被识别为肺炎的概率被显示在每个图像的顶部。我们需要将预测转换为二进制，以获得分类报告。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oh oi l"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oh oi l"/></div></figure><p id="09de" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">通常，当没有提到平均值时，分数作为加权平均值给出，以得到单个指标。当平均值为零时，给出两个班级的分数。对前面提到的所有三个数据集执行相同的代码块。数据集的分类报告摘要如下</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ol"><img src="../Images/03cb8a385d85b63032da6bd34ae7a376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g4kNTsrMFsIi5UfR-R5Xhw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ol"><img src="../Images/302ec3878fbf18743c3d36c34fe496ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qxbSTglmeY3nNJuVjZMDNg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj om"><img src="../Images/abfffccc4789425fd85d1283bb67f5cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dbkTN-uJpg-Hp-wQNn1NIw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><blockquote class="la lb lc"><p id="1d2f" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">讨论</strong></p></blockquote><p id="1901" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在第一个数据集上，类0的精度较高，而召回率较低，表明存在大量的假阴性。总体准确率为58%。在第二个数据集中，训练数据中有更多的0样本，使得类0的召回值非常高，但精度下降。本质上，它指的是模型变得偏向那个阶级的事实。第三个数据集只是一个混合数据，以一个非常弱的模型结束。因此，为了更好的模型性能，我们需要更高的精度和召回率。有些人更喜欢通过F1分数来评估模型，F1分数结合了这两个指标。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj on"><img src="../Images/5a40f3c888564487019115adb0390c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/0*Htv23vMjZl7jMath.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">F1分数定义</p></figure><p id="4003" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">对于平衡和不平衡数据集，混淆矩阵在非对角线位置显示一些高值，但是对于混合数据集，它相当混乱。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oo"><img src="../Images/550172741a7d6980c71ee5725ef4ca66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7PXemmqM78ySpu9aAnRQIQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">混淆矩阵</p></figure><blockquote class="la lb lc"><p id="4751" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">结论</strong></p></blockquote><p id="9353" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在本文中，我描述了图像分类的模型评估指标及其在python中的实现。三种不同的数据集用于反映现实世界的问题，如不平衡数据集和脏数据集。数据科学家和人工智能经理需要确保训练数据对于每个分类都应该足够干净和平衡。在所有冗长的模型训练之后，混合数据可能以弱模型结束。</p><p id="a8fb" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/06/21/X-ray_image_classification-balanced_data.html" rel="noopener ugc nofollow" target="_blank">平衡数据Github页面</a></p><p id="9375" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/06/21/X-ray_image_classification-unbalanced_data.html" rel="noopener ugc nofollow" target="_blank">不平衡数据Github页面</a></p><p id="1b50" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/06/21/X-ray_image_classification-balanced_dirty_data.html" rel="noopener ugc nofollow" target="_blank">混合数据的Github页面</a></p></div></div>    
</body>
</html>