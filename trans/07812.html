<html>
<head>
<title>4 Pandas Functions For Index Manipulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">4 Pandas用于索引操作的函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-pandas-functions-for-index-manipulation-5b8c7bd6ab12?source=collection_archive---------22-----------------------#2021-07-17">https://towardsdatascience.com/4-pandas-functions-for-index-manipulation-5b8c7bd6ab12?source=collection_archive---------22-----------------------#2021-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="26b1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">实用熊猫教程。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ff959dd6f2d423bdf2e348ffc607fc78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T3cWrQexYDgwjDMPs2EIOw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安德烈·泰森在<a class="ae ky" href="https://unsplash.com/s/photos/order?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9782" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas为高效的数据分析和操作提供了大量的功能。在本文中，我们将重点关注关于特定数据操作的Pandas函数。</p><p id="2b92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas的核心数据结构是由带标签的行和列组成的数据帧。行或列的索引可以被认为是它的地址。</p><p id="a6dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用索引来访问数据框中的行。尽管大多数情况下通过列名来访问列，但是也可以使用列索引。列索引和行索引都从0开始。</p><p id="4bdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将讨论4个Pandas函数，它们允许你更新或操作数据框中的索引。让我们从导入库开始，并创建一个样本数据框。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5687" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="29f7" class="ma mb it lw b gy mg md l me mf">df = pd.DataFrame({<br/>   "Date": pd.date_range(start="2021-05-01", end="2021-05-8", <br/>                         freq="D"),<br/>   "A": np.random.randint(10, size=8),<br/>   "B": np.random.randint(20, size=8),<br/>   "C": np.random.randint(30, size=8)<br/>})</span><span id="e4cf" class="ma mb it lw b gy mg md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/fc0a93903638764c31d7743d8fa1b939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*8Z30alBZuIOu6GAUzPKV-Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f8d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一个8行4列的数据框。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="0bc5" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">集合_索引</h2><p id="1e15" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">第一个是set_index函数，它可以用来将特定的列指定为行索引。</p><p id="dbaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理时间序列时，您可能需要将日期用作行索引。我们可以使用下面的set_index函数来执行这个任务。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="594a" class="ma mb it lw b gy mc md l me mf">df.set_index("Date", inplace=True)</span><span id="9e04" class="ma mb it lw b gy mg md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/0cb461c28d1bee886db6ff5806880dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*I7UDF87iKdW5X0HFkHu--w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="82c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要将inplace参数设置为true以保存更改。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="d574" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">重置_索引</h2><p id="b1d9" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">reset_index函数的作用是不言自明的。它用整数索引重置当前行索引。</p><p id="3d2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要注意drop参数。如果不需要当前索引，请将drop参数设置为true。否则，当前索引将作为数据框中的新列保存。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ea4b" class="ma mb it lw b gy mc md l me mf">df.reset_index(drop=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/548e928e289d8f31016eaa801da65816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*9c7t01yENrf0ztOQYKWRlg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="126f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想保留日期列，所以不使用drop参数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="80f9" class="ma mb it lw b gy mc md l me mf">df.reset_index(inplace=True)</span><span id="9913" class="ma mb it lw b gy mg md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d8dcf08c065c3b63e7aea26260497d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*d9zrJclIha3-Rfz-9Wwt4A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="d8e1" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">排序值</h2><p id="df65" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">sort_values与索引操作没有直接关系。然而，当我们根据列中的值对数据点(即行)进行排序时，数据框的索引也会发生变化。</p><p id="a060" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们来做一个例子来演示这个案例。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0047" class="ma mb it lw b gy mc md l me mf">df.sort_values("A")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e57c66dd802ccda4038b4216c638e07b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*TqRwWas3fE7gCZDGE-QcKQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="907d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些行根据a列中的值按升序排序。索引值也相应地更改。为了防止索引被更新，我们可以使用ignore_index参数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a98b" class="ma mb it lw b gy mc md l me mf">df.sort_values("A", ignore_index=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/84f6b30497c269e4aa397e25d767b192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*1ULjjsTOX9oA0m24VOseQw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="03b7" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">重新索引</h2><p id="1f4c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">reindex函数可用于为数据框分配新的列或行索引。我们可以使用reindex函数改变列的顺序，如下所示。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1761" class="ma mb it lw b gy mc md l me mf">df.reindex(columns=["C","A","B","Date"])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/c0658dfb51261d329edc0b77b0e22c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*n8FecSvCzMW1_eXaA_woKw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="69c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果当前数据框中不存在新索引中的项目，则默认情况下会用NA值填充该项目。我们也可以选择一个值来代替NA值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3048" class="ma mb it lw b gy mc md l me mf">df.reindex(columns=["C","A","New","Date"], fill_value=0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/aa3a3615d2451d309bf2b9ccc5e28a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*IPwwgqldQ_XxoYCujYur3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="e1bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">reindex函数也可以与行索引一起使用。让我们首先将日期列指定为行索引。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9bf3" class="ma mb it lw b gy mc md l me mf">df.set_index("Date", inplace=True)</span><span id="23fb" class="ma mb it lw b gy mg md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/f6b28c448eed1ac5f90b9ee2e4552305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*62fRr-TzrNHnNAh5-bm5pA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="2a85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将创建一个新的日期索引，比原来的索引多包含2天。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ab26" class="ma mb it lw b gy mc md l me mf">newindex = pd.date_range(start="2021-05-01", freq="D", periods=10)</span><span id="aa28" class="ma mb it lw b gy mg md l me mf">newindex</span><span id="66fe" class="ma mb it lw b gy mg md l me mf">DatetimeIndex(['2021-05-01', '2021-05-02', '2021-05-03', <br/>'2021-05-04', '2021-05-05', '2021-05-06', '2021-05-07', <br/>'2021-05-08', '2021-05-09', '2021-05-10'],               dtype='datetime64[ns]', freq='D')</span></pre><p id="9509" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果将这个新索引分配给我们的数据框，最后两行将填充NA值。可以选择一个常数值来填充它们。然而，Pandas提供了一个更实用的方法。</p><p id="8384" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">方法参数可用于选择更智能的方式来处理缺失值。例如，我们可以用前一天的值填充它们。“ffill”选项执行此操作。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fb94" class="ma mb it lw b gy mc md l me mf">df = df.reindex(newindex, method="ffill")</span><span id="110a" class="ma mb it lw b gy mg md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/043165fbbe097eba182af06f1d4a23a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*az87vt1C-yQ0pYcB5FPymw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="b327" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">结论</h2><p id="570c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">我们已经讨论了4个函数，它们提供了许多选项来处理数据帧的行或列索引。当然，这不是你仅有的选择。我坚信这4个足以处理你可能遇到的典型案例。</p><p id="72c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>