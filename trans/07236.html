<html>
<head>
<title>Installing Ubuntu 20.04 LTS and running YOLOv4 and YOLOv5 on it.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">安装Ubuntu 20.04 LTS并在其上运行YOLOv4和YOLOv5。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/installing-ubuntu-20-04-lts-and-running-yolov4-and-yolov5-on-it-2ca0c93e244a?source=collection_archive---------11-----------------------#2021-07-01">https://towardsdatascience.com/installing-ubuntu-20-04-lts-and-running-yolov4-and-yolov5-on-it-2ca0c93e244a?source=collection_archive---------11-----------------------#2021-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="fd9c" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="de62" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">运行对象检测模型的初学者指南</h2></div><blockquote class="ko kp kq"><p id="1c9a" class="kr ks kt ku b kv kw ka kx ky kz kd la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我最近有了一台游戏笔记本电脑，联想Ideapad Gaming 3，并决定用它来进行一些计算机视觉工作。我一点也不知道我将要经历的麻烦。我决定写这篇文章，以便让这个过程对其他人来说更容易、更直接。</p></blockquote><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/be399d4660c065a0faa932f26c9c1d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VNsBLmsLrR7RKOVTojmoIA.jpeg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">由<a class="ae me" href="https://unsplash.com/@joshuaryanphoto?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">约书亚·雷德科普</a>在<a class="ae me" href="https://unsplash.com/s/photos/coding?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="81a5" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">联想Ideapad Gaming 3锐龙5 4600H于2021年1月上市。我最初尝试在上面安装Ubuntu 18.04 LTS，因为我已经在上面工作了很长时间，但由于它的旧内核，我遇到了wifi适配器，触摸板，功能键等几个问题。而不是更新它的内核，我认为是时候转移到新的。18.04 LTS支持将于2023年结束，在技术领域，你需要不断更新自己。</p><p id="d00e" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">我的目标是在对象检测模型<strong class="ku ja"> YOLO </strong>(你只看一次)上运行推理，并在其上训练一个定制数据集。我以前在Ubuntu 18.04 LTS上使用过YOLOv4，所以我选择在新的操作系统上尝试，同时也探索新的，所谓的YOLOv5。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="371d" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">安装Ubuntu 20.04 LTS</h1><p id="3752" class="pw-post-body-paragraph kr ks iq ku b kv nh ka kx ky ni kd la mf nj ld le mg nk lh li mh nl ll lm ln ij bi translated">推荐的最低系统要求:</p><ol class=""><li id="e80b" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln nr ns nt nu bi translated">2 GHz双核处理器</li><li id="7534" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln nr ns nt nu bi translated">4 GiB Ram (1 GiB也可以工作)</li><li id="cf5e" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln nr ns nt nu bi translated">25 GB硬盘空间</li><li id="5a9a" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln nr ns nt nu bi translated">支持1024x768屏幕分辨率的VGA</li><li id="dbfc" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln nr ns nt nu bi translated">用于安装程序介质的CD/DVD驱动器或USB端口</li><li id="76e9" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln nr ns nt nu bi translated">建议上网</li></ol><p id="5e38" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">我有一个Windows 10的双启动配置。我用<a class="ae me" href="https://rufus.ie/en/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ja"> Rufus </strong> </a>创建了一个可引导设备。保持分区方案与您的硬盘配置相同。我的是GPT。保持文件系统为FAT32。你可以从它的<a class="ae me" href="https://ubuntu.com/download/desktop" rel="noopener ugc nofollow" target="_blank"> <em class="kt">官网</em> </a>下载Ubuntu 20.04 LTS的ISO镜像。</p><p id="43b8" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">创建可引导设备后，重新启动系统并从该设备引导。通常打开启动选项的键是esc+F5或esc+F12，但是您可以在网上搜索您的系统的组合键。启动后，继续使用Ubuntu(第一个选项)。</p><p id="436d" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">您可以从<a class="ae me" href="https://www.tecmint.com/install-ubuntu-20-04-desktop/" rel="noopener ugc nofollow" target="_blank"> <em class="kt">到</em> </a>按照其余步骤进行安装。我强烈建议您连接互联网，并在安装过程中选择安装第三方软件的选项。</p><p id="d3a2" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">如果使用GPT分区方案，那么创建主分区还是逻辑分区就无关紧要了。如果是MBR你可以参考<a class="ae me" href="https://askubuntu.com/questions/121197/ubuntu-installation-partitioning-logical-or-primary" rel="noopener ugc nofollow" target="_blank"> <em class="kt">这个网页</em> </a>更好的理解。对于给分区分配磁盘空间，我建议给<em class="kt">根</em>分配100–150 GB的空间(尽管50 GB也可以)。通常两倍于当前RAM的内存被分配给交换区。我建议至少要有和你现在的RAM容量一样多的内存。其余的你可以设置到你的<em class="kt"> home </em>目录下。只保留根目录和主目录可以使系统简单有效地使用。要了解更多选项，请参考<a class="ae me" href="https://askubuntu.com/questions/343268/how-to-use-manual-partitioning-during-installation" rel="noopener ugc nofollow" target="_blank"> <em class="kt">本网页</em> </a> <em class="kt">。</em></p><p id="7c06" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">安装完成后，如果您的笔记本电脑型号是最近发布的，您可能会面临一些硬件问题。在我的情况下，我的触摸板不工作。它需要一个HID兼容的设备驱动程序。除了windows之外，联想没有提供太多的操作系统支持，所以新的驱动程序可能会包含在未来的Ubuntu内核版本中。您可以尝试更新您的内核来解决这些问题，或者在web上寻找特定的解决方案。对我来说，<a class="ae me" href="https://askubuntu.com/a/1276453" rel="noopener ugc nofollow" target="_blank"> <em class="kt">这个</em> </a>在一定程度上解决了我的问题。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="39fa" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">为YOLO配置系统</h1><p id="46fa" class="pw-post-body-paragraph kr ks iq ku b kv nh ka kx ky ni kd la mf nj ld le mg nk lh li mh nl ll lm ln ij bi translated">要用GPU运行YOLO，我们需要合适的驱动程序。转到“软件和更新”并在“附加驱动程序”中安装驱动程序。</p><p id="007a" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">如果你遇到任何问题，你也可以从命令行安装驱动程序。在和处，按照<a class="ae me" href="https://linuxize.com/post/how-to-nvidia-drivers-on-ubuntu-20-04/" rel="noopener ugc nofollow" target="_blank">和<em class="kt">的指示进行操作。</em></a></p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oa"><img src="../Images/d8244808dee53ffeba5c94017d3827fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GwzYozCwECSrc7qNT3baKg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">如果从这里安装，然后，如果任何驱动程序显示(专有的，测试)选择它。否则，如果通过cmd安装，选择显示<strong class="bd ob">推荐</strong>的一个。<em class="oc">图片作者。</em></p></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi od"><img src="../Images/17cde7eaa3c5cf3385cf6eaf8a21a2a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NisyoOqABCdGZBg1_fq9QA.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">我的MoK菜单截图。<em class="oc">图片作者。</em></p></figure><p id="e8cb" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">在安装nvidia驱动程序的过程中，您将被要求设置安全启动的密码，这将是在更新MoK设置时需要的。设置密码，并在重新启动时，从MoK菜单中选择第二个选项(登记|MoK ),如图所示。重启后，在终端运行命令<code class="fe oe of og oh b">$ nvidia-smi</code>来验证驱动安装。</p><p id="de34" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">为了以最佳方式运行YOLO，我们需要在系统中包含以下内容:</p><ul class=""><li id="c3d4" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">图形处理单元</li><li id="cb8f" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">Cuda工具包</li><li id="5f68" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">cuDNN (Cuda神经网络库)</li><li id="2421" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">OpenCV</li></ul><p id="d7f3" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">我们已经为GPU安装了驱动程序。接下来我们需要安装CUDA工具包。我的驱动版本是465.19.01，CUDA版本是11.3。因此，我很自然地安装了cuda toolkit的最新版本11.3和相应的cuDNN，并尝试使用它们运行YOLOv4，但令我沮丧的是，我遇到了以下错误:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oj"><img src="../Images/37eaee742e7ab99aa1fe20fe37ab87b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17rAqq8OO50-Z_WSJvfgwA.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">我在使用cuda toolkit 11.3运行YOLOv4时遇到的错误截图。<em class="oc">作者图片。</em></p></figure><p id="9646" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">该错误的一个解决方法是在训练时移除<code class="fe oe of og oh b">-map</code>，修改<code class="fe oe of og oh b">src/detector.c</code>以每1000或2000次迭代保存权重，并使用<code class="fe oe of og oh b">./darknet detector map.</code>测试权重，但这不应该是这种情况，如果忽略，该错误的原因可能会导致未来更多的错误。所以经过一些研究，我知道<strong class="ku ja"> darknet </strong>不支持CUDA Toolkit 11，正如YOLOv4的作者之一Alexey Bochkovskiy所说，他本人<a class="ae me" href="https://github.com/AlexeyAB/darknet/issues/7153#issuecomment-809022501" rel="noopener ugc nofollow" target="_blank"> <em class="kt">在这里</em> </a>。它与cuda工具包10一起工作。1和cuDNN 7。6 .5.</p><p id="d344" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">于是我下载安装了CUDA 10。1 update2和cuDNN v7.6.5来自官方<a class="ae me" href="https://developer.nvidia.com/" rel="noopener ugc nofollow" target="_blank"> <em class="kt"> nvidia网站</em> </a>。我不能直接发布这些库的链接，因为nvidia不允许。您需要创建一个开发人员帐户，然后能够访问和下载文件来安装它们。选择要安装cuda的系统配置后，安装说明会在网页上给出。如果你在安装过程中遇到任何问题，像我曾经遇到的这个错误<code class="fe oe of og oh b">E: Unable to correct problems, you have held broken packages</code>可能是由于以前的CUDA安装，你应该尝试使用<strong class="ku ja"> aptitude </strong>而不是apt-get来安装，如这里的<a class="ae me" href="https://askubuntu.com/a/451078" rel="noopener ugc nofollow" target="_blank"><em class="kt"/></a>所示。它不仅为您处理降级冲突包，还会提出一系列建议，询问您在众多可能的建议工作场景中，您愿意选择哪一个。一旦安装完毕，您需要将路径添加到<strong class="ku ja"> PATH </strong>变量中。阅读安装说明末尾的cuda安装指南，并遵循安装后的操作。完成后，使用<code class="fe oe of og oh b">$ source ~/.bashrc</code>重新加载bash文件。您可以使用<code class="fe oe of og oh b">$ nvcc --version</code>从终端验证安装。</p><p id="b19b" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">对于cuDNN安装，请从nvidia官方网站下载cuDNN v7.6.5 for CUDA 10.1，cuDNN Library for Linux，这是一个tar文件，并遵循nvidia cudnn安装指南网页上针对7.6.5版给出的说明。要验证和检查其版本，打开终端并运行<code class="fe oe of og oh b">$ which nvcc</code>。它将向您展示CUDA工具包的安装路径。使用*path*并运行命令<code class="fe oe of og oh b">$ cat *path*/include/cudnn.h | grep CUDNN_MAJOR -A 2</code>。结果将描述版本。我的情况是:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ok"><img src="../Images/8a84fa0e684189e49a76e85ba6a631dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BuWDYUXtTL3qwwq3VOKceg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">也就是说版本是7.6.5。<em class="oc">图片作者。</em></p></figure><p id="4902" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">现在你还必须检查你安装的<strong class="ku ja"> gcc </strong> (GNU编译器集合)与你的CUDA工具包版本的兼容性。使用<code class="fe oe of og oh b">$ gcc --version</code>从终端检查您的gcc版本。要查看它是否兼容，如果不兼容，如何安装max支持的版本，请遵循此处 提供的<a class="ae me" href="https://stackoverflow.com/a/46380601" rel="noopener ugc nofollow" target="_blank"> <em class="kt">步骤。</em></a></p><p id="0ec9" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">所有这些过程完成后，设置应该如下所示:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ol"><img src="../Images/7218f69381fc8c3fe36b47cd95eb66d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5ScoKnp1VoaeF5HCjBHXg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">NVIDIA驱动465，CUDA工具包10.1，cuDNN v7.6.5，gcc 8.4。<em class="oc">图片作者。</em></p></figure><p id="a108" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">现在，要安装OpenCV(开源计算机视觉库)，按照<a class="ae me" href="https://linuxize.com/post/how-to-install-opencv-on-ubuntu-20-04/" rel="noopener ugc nofollow" target="_blank"> <em class="kt">本文</em> </a>中提供的步骤操作。从源代码构建OpenCV，并通过打印版本来验证安装。现在我们都设置好运行<strong class="ku ja"> <em class="kt">了，你只需要在我们的机器上看一次</em> </strong>。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="7461" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">YOLOv4</h1><p id="f10e" class="pw-post-body-paragraph kr ks iq ku b kv nh ka kx ky ni kd la mf nj ld le mg nk lh li mh nl ll lm ln ij bi translated">YOLOv4是一个实时的物体检测系统，它可以识别单个外壳中的各种物体。该实时识别系统可以从特定图像中识别几个对象，在对象附近框出一个边界有限的框，并在生产系统中快速训练和实现。</p><p id="f4f4" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">网上很少有YOLO算法的实现。Darknet就是这样一个用C和CUDA编写的开源神经网络框架，它是YOLO的基础。暗网被用作训练YOLO的框架，这意味着它设置了网络的架构。Darknet的第一作者是YOLO本身的作者，<a class="ae me" href="https://pjreddie.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ku ja"/></a>。</p><h1 id="d7d1" class="mp mq iq bd mr ms om mu mv mw on my mz kf oo kg nb ki op kj nd kl oq km nf ng bi translated">要在您的系统上运行YOLOv4，请按照下列步骤操作:</h1><ul class=""><li id="ee2d" class="nm nn iq ku b kv nh ky ni mf or mg os mh ot ln oi ns nt nu bi translated">为yolov4创建一个目录，并在其中克隆<a class="ae me" href="https://github.com/AlexeyAB/darknet.git" rel="noopener ugc nofollow" target="_blank"> <em class="kt"> github仓库</em> </a>。为此，在目录中打开一个终端并运行<code class="fe oe of og oh b">$ git clone <a class="ae me" href="https://github.com/AlexeyAB/darknet.git" rel="noopener ugc nofollow" target="_blank">https://github.com/AlexeyAB/darknet.git</a></code>。</li><li id="ea67" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">通过终端访问darknet文件夹，并使用命令<code class="fe oe of og oh b">$ gedit Makefile</code>编辑Makefile。将<strong class="ku ja"> GPU </strong>、<strong class="ku ja"> CUDNN </strong>和<strong class="ku ja"> OPENCV </strong>的值改为1。向下滚动并注释默认的<strong class="ku ja"> ARCH </strong>值，取消注释与您的GPU配置匹配的ARCH值。我的情况是这样的:</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ou"><img src="../Images/a6afa3877d6159ea382b6a048e479fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PfltJiggZajbRmyts_47dw.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">使用GTX 1650 GPU在我的本地系统上运行YOLOv4推理的Makefile配置。你可以去掉通用的ARCH=(第一个)，只为你的显卡取消注释ARCH=。<em class="oc">图片作者。</em></p></figure><ul class=""><li id="327b" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">在Makefile中进行所需的更改后，在终端中运行命令<code class="fe oe of og oh b">$ make</code>。它会在你的系统中建立暗网。你可能会遇到一些关于库的问题，比如，在我的例子中，我遇到了这个错误:<code class="fe oe of og oh b">Error while loading shared libraries: lcublas: cannot open shared object file: No such file or directory</code>。要解决此类与库相关的问题，请从新的终端运行<code class="fe oe of og oh b">$ sudo nautilus</code>，以root身份打开文件资源管理器，并导航到<em class="kt"> /usr/local </em>。你会看到两个文件夹<em class="kt"> cuda-10.1 </em>和<em class="kt"> cuda-10.2。</em>导航到<em class="kt">cuda-10.2/targets/x86 _ 64-Linux</em>，将其中存在的两个文件夹'<em class="kt"> include' </em>和'<em class="kt"> lib' </em>的内容复制到<em class="kt">cuda-10.1/targets/x86 _ 64-Linux</em>中对应的同名文件夹中。<code class="fe oe of og oh b">$ make</code>现在应该跑了。</li><li id="62fa" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">一旦构建了darknet，下一步就是下载YOLOv4预训练的权重来运行推理。你会在<a class="ae me" href="https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.weights" rel="noopener ugc nofollow" target="_blank"> <em class="kt"> AlexeyAB的github </em> </a>里找到。在你的终端的暗网目录下，运行命令<code class="fe oe of og oh b">$ wget <a class="ae me" href="https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.weights" rel="noopener ugc nofollow" target="_blank">https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.weights</a></code>。它会将重量文件下载到您的暗网目录中。</li><li id="09cc" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">现在，您可以使用命令<code class="fe oe of og oh b">$ ./darknet detector test cfg/coco.data cfg/yolov4.cfg yolov4.weights data/dog.jpg</code>对测试图像进行物体检测推断。您应该记得，在配置<strong class="ku ja"> Makefile </strong>时，我们没有将‘cud nn _ HALF’的值更改为1。你最初可以将<code class="fe oe of og oh b">$ make</code> darknet设置为1，如果出现了一些问题，比如我的输出中没有边界框，你可以将它重新设置为0，<code class="fe oe of og oh b">$ make</code> darknet并运行推理。</li><li id="0884" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">您可以在名为“predictions.jpg”的darknet目录中查看不同类上的边界框的结果输出。</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ov"><img src="../Images/61dc17a3ff8d099e8e48a22bb638c385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5bCz26mHuIdzhZRRhrWdag.jpeg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">predictions.jpg . Original是YOLOv4存储库中提供的一个示例图像。</p></figure><h1 id="d4a4" class="mp mq iq bd mr ms om mu mv mw on my mz kf oo kg nb ki op kj nd kl oq km nf ng bi translated">要在您的系统中训练YOLOv4上的自定义数据集，请按照下列步骤操作:</h1><ul class=""><li id="d013" class="nm nn iq ku b kv nh ky ni mf or mg os mh ot ln oi ns nt nu bi translated">据了解，到目前为止你已经完成了所有的步骤。现在，为了训练自定义数据集，您首先需要一个数据集。计算机视觉领域中的数据集主要指带注释的图像，即具有相应文本文件的一系列图像，该文本文件包含关于检测到的对象类别和以像素为单位的边界框坐标的信息。</li><li id="f669" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">YOLO为检测到的对象遵循的注释格式为</li></ul><p id="d02f" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated"><code class="fe oe of og oh b">&lt;object-class&gt; &lt;x_center&gt; &lt;y_center&gt; &lt;width&gt; &lt;height&gt;</code>，其中:</p><p id="bd1f" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <code class="fe oe of og oh b">&lt;object-class&gt;</code>是一个从0到(类的数量-1)的整数类id。</p><p id="552d" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <code class="fe oe of og oh b">&lt;x_center&gt; &lt;y_center&gt; &lt;width&gt; &lt;height&gt;</code> —是相对于图像的宽度和高度的浮点值<strong class="ku ja">，可以在[0，1]之间变化。</strong></p><p id="4171" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">比如:<code class="fe oe of og oh b">&lt;x&gt; = &lt;absolute_x&gt; / &lt;image_width&gt;</code>或者<code class="fe oe of og oh b">&lt;height&gt; = &lt;absolute_height&gt; / &lt;image_height&gt;</code></p><p id="3ef3" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹需要注意的是，<code class="fe oe of og oh b">&lt;x_center&gt; &lt;y_center&gt;</code> -是矩形的中心(不是包围盒的左上角)。</p><ul class=""><li id="d276" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">一个例子就是，<code class="fe oe of og oh b">1 0.716797 0.395833 0.216406 0.147222</code>。</li><li id="31e4" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">您可以按照<a class="ae me" href="https://youtu.be/_4A9inxGqRM" rel="noopener ugc nofollow" target="_blank"> <em class="kt">中的步骤来创建一个自定义数据集。YOLOv3和YOLOv4的图像和标签格式相同，因此这些步骤都是有效的。</em></a></li><li id="531d" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">一旦完成，你应该有两个文件夹的图像和相应的注释。一个包含训练数据，另一个包含验证数据。</li><li id="f311" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">将训练数据集文件夹重命名为<strong class="ku ja"> obj </strong>(包含所有训练图像的文件夹)<strong class="ku ja"> </strong>，将验证数据集文件夹重命名为<strong class="ku ja"> test </strong>。</li><li id="fe34" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">接下来，我们修改我们的配置文件。您可以修改darknet文件夹内cfg文件夹中的<strong class="ku ja"> yolov4-custom.cfg </strong>文件，或者新建一个。cfg文件。AlexeyAB给出的指令是<a class="ae me" href="https://github.com/AlexeyAB/darknet#how-to-train-to-detect-your-custom-objects" rel="noopener ugc nofollow" target="_blank"> <em class="kt">这里是</em> </a>。注意事项:</li></ul><p id="cb7e" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹建议有<strong class="ku ja">批次= 64 </strong>和<strong class="ku ja">细分= 16 </strong>但是如果你面临问题，那么增加细分到32。这意味着训练将在批量大小的批次中进行，即模型将一次加载用于训练的批量图像，并且这将进一步细分为子部分以进行最佳处理。</p><p id="b2eb" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja"> max_batches </strong>最小应为6000。</p><p id="eddd" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹在三个YOLO层中更改参数为<strong class="ku ja"> classes = 1 </strong>(或者在您的情况下为类的数量)，在YOLO层之前的三个卷积层中更改参数为<strong class="ku ja"> filters = 18 </strong>(根据您的使用情况更改)。</p><p id="b111" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹:如果你面临内存问题或者发现训练时间太长，你可以在三个YOLO层中的每一层设置<strong class="ku ja"> random = 0 </strong>。它用于缩放不同大小的图像，因此会占用内存空间。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ow"><img src="../Images/e421656f5b1b682b643b69cec0ef9e41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ltTP5kISyH7lIfxQC8zvOQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">的配置。在我的系统上试运行的cfg文件(因此max_batches = 200)。<em class="oc">图片作者。</em></p></figure><ul class=""><li id="c9cb" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">接下来，您创建一个文本文件，在新的一行中包含您的类名，将其命名为<strong class="ku ja"> obj.names </strong>，并将其放在<strong class="ku ja"> data </strong>文件夹中。您可以根据自己的意愿重命名这些类，但是名称的顺序必须与您为下载图像的工具包创建的<strong class="ku ja"> classes.txt </strong>的顺序相同，因为该顺序是我们的标签将保持的。</li><li id="9726" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">现在我们需要创建两个文本文件，包含所有训练图像和测试图像的位置。您可以使用<a class="ae me" href="https://github.com/theAIGuysCode/YOLOv4-Cloud-Tutorial/tree/master/yolov4" rel="noopener ugc nofollow" target="_blank"> <em class="kt">这个库</em> </a>中的generate_train.py和generate_test.py python代码来轻松完成这项任务。只需将它们下载到您的darknet文件夹中并运行它们。将train和validation文件夹命名为obj并测试这些代码是否工作是很重要的，因为它们是硬编码的。</li><li id="f4ae" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">一旦上述步骤完成，您将拥有两个文本文件<strong class="ku ja"> test.txt </strong>和<strong class="ku ja"> train.txt </strong>，它们分别包含test和obj的每个图像的目录，在一个新行中。现在，我们创建我们的<strong class="ku ja"> obj.data </strong>文件，该文件将包含关于类的数量、训练集、验证集、类名和保存我们的模型数据(权重文件)的备份文件夹的信息。备份文件夹很重要，因为在我们的训练期间，每100次迭代(作为yolov4_last.weights)更新的权重会保存在这里，每1000次、最佳和最终权重也是如此。因此，即使经过几个小时的训练，如果我们的计划突然终止，所有的进展并没有失去。该文件的一个示例是:</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/520be2f21e5819ba74774f7a5811f340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*5ttrzo4tzr_1qroSx_YMwg.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">obj.data文件示例。<em class="oc">图片作者。</em></p></figure><ul class=""><li id="7f49" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">在我们开始训练我们的模型之前，最后一步是下载卷积层的预训练权重，您可以在这里找到<a class="ae me" href="https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137" rel="noopener ugc nofollow" target="_blank"><em class="kt"/></a>。即使类别变化很大，预先训练的权重也被证明比随机权重更好。</li><li id="cb61" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">我们现在准备将我们的模型用于训练。其语法是:<code class="fe oe of og oh b">./darknet detector train &lt;path to obj.data&gt; &lt;path to custom config&gt; &lt;weight file&gt; -map</code>。比如:<code class="fe oe of og oh b">./darknet detector train data/obj.data cfg/yolov4_custom.cfg yolov4.conv.137 -map</code>。</li><li id="bcb7" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">如果您没有验证集，请不要使用<code class="fe oe of og oh b">-map</code>，因为它会使用迄今为止训练的模型的验证集来计算平均精度。</li><li id="006d" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">训练完成后，使用备份文件夹中的最佳权重进行进一步的工作，因为它们对应于产生最小验证误差或最大map的权重，以避免数据过度拟合。</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oy"><img src="../Images/6ebee284ccf709547763e07a76a78885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Muo5BiTCcWN1X_reBL8htw.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">针对单个班级人员的训练YOLOv4的示例输出。<em class="oc">图片作者。</em></p></figure><ul class=""><li id="79f7" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">如果训练由于任何系统故障或电源问题或任何其他问题而停止，您可以使用命令开始训练并将yolov4_last.weights作为权重文件，从停止的地方继续训练。它将从停止的地方开始。</li><li id="4835" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">如果您想在指定的迭代结束后进行更多的训练，您需要指定更多的历元来恢复。例如，如果你训练300/300，那么恢复也将训练到300(从300开始)，除非你指定更多的纪元。</li><li id="fa79" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">运行<code class="fe oe of og oh b">$ ./darknet detector train data/obj.data cfg/yolov4_custom.cfg yolov4_weights_last.weights -clear -map</code>再次训练。<code class="fe oe of og oh b">clear</code>标志将重置保存在权重中的迭代，这也适用于数据集变化的情况。</li></ul><h1 id="c164" class="mp mq iq bd mr ms om mu mv mw on my mz kf oo kg nb ki op kj nd kl oq km nf ng bi translated">要立即运行YOLOv4自定义对象检测器:</h1><ul class=""><li id="d8df" class="nm nn iq ku b kv nh ky ni mf or mg os mh ot ln oi ns nt nu bi translated">打开配置文件(yolov4_custom.cfg)并注释掉<em class="kt"> # Training </em>(批处理和细分)下面的两行，取消注释掉<em class="kt"> # Testing </em>(批处理=1，细分= 1)下面的两行。</li><li id="ace1" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">对于图像文件image，运行命令<code class="fe oe of og oh b">./darknet detector test &lt;path to obj.data&gt; &lt;path to custom config&gt; &lt;weight file&gt; &lt;path to image.jpg&gt;</code>。</li><li id="68ba" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">对于视频文件video，运行命令。<code class="fe oe of og oh b">/darknet detector demo &lt;path to obj.data&gt; &lt;path to custom config&gt; &lt;weight file&gt; &lt;path to video.mp4&gt;</code>。</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oz"><img src="../Images/6181fbf5bcc5820e07bca927904482e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yIWG0TGWoDqzXhvyFEfX_Q.jpeg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">使用我的定制YOLOv4模型运行推理的示例输出，我训练该模型来检测人类。<a class="ae me" href="https://www.shutterstock.com/image-photo/horizontal-shot-three-mixed-race-teenagers-1238409808" rel="noopener ugc nofollow" target="_blank">来源</a>原始图片由<a class="ae me" href="https://www.shutterstock.com/g/wayhome" rel="noopener ugc nofollow" target="_blank"> WAYHOME工作室</a>提供。</p></figure></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="653e" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">YOLOv5</h1><p id="457f" class="pw-post-body-paragraph kr ks iq ku b kv nh ka kx ky ni kd la mf nj ld le mg nk lh li mh nl ll lm ln ij bi translated">YOLOv5的起源有些争议，命名仍然在计算机视觉社区中争论不休。2020年5月29日，<strong class="ku ja"> Glenn Jocher </strong> <a class="ae me" href="https://github.com/ultralytics/yolov3/commit/0671f04e1f283aea6f059d066130d4543a320b47" rel="noopener ugc nofollow" target="_blank">创建了一个名为YOLOv5的存储库</a>，其中不包含任何模型代码，2020年6月9日，他在他的YOLOv3实现中添加了<a class="ae me" href="https://github.com/ultralytics/yolov3/commit/0671f04e1f283aea6f059d066130d4543a320b47" rel="noopener ugc nofollow" target="_blank">一个名为“YOLOv5问候”的提交消息</a>Jocher的YOLOv5实现在几个值得注意的方面不同于以前的YOLO版本。首先，Jocher还没有发表论文来支持他的释放。他在一个<a class="ae me" href="https://github.com/ultralytics/yolov5" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ja"> GitHub资源库</strong> </a>中发布了YOLOv5。其次，Jocher在PyTorch中本地实现了YOLOv5，而YOLO家族之前的所有型号都利用了Darknet。</p><p id="9ab9" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">虽然我没有足够的经验来评论它的真实性，但我想感谢在PyTorch中实现YOLO的努力。因为YOLOv5最初是在PyTorch中实现的，所以它受益于已建立的PyTorch生态系统:支持更简单，部署更容易。因此，出于本文的目的，我将继续使用YOLOv5这个名称。</p><h1 id="9734" class="mp mq iq bd mr ms om mu mv mw on my mz kf oo kg nb ki op kj nd kl oq km nf ng bi translated">要在您的系统上运行YOLOv5，请按照下列步骤操作:</h1><ul class=""><li id="736a" class="nm nn iq ku b kv nh ky ni mf or mg os mh ot ln oi ns nt nu bi translated">为yolov5创建一个目录，并在其中克隆<a class="ae me" href="https://github.com/ultralytics/yolov5.git" rel="noopener ugc nofollow" target="_blank"> <em class="kt"> github仓库</em> </a>。为此，在目录中打开一个终端并运行git <code class="fe oe of og oh b">$ git clone https://guthub.com/ultralytics/yolov5.git</code>。</li><li id="92c8" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">下载完成后，我们现在需要安装所有必需的依赖项。为此，打开一个终端并运行<code class="fe oe of og oh b">$pip install -U -r yolov5/requirements.txt</code></li><li id="ca5c" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">现在，您可以直接对样本图像进行推理，以进行对象检测。在数据/图像文件夹中的图像zidane.jpg上试试。跑<code class="fe oe of og oh b">$ python3 detect.py --source ./data/images/zidane.jpg --weights yolov5s.pt --conf 0.4</code>。输出应该是:</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pa"><img src="../Images/ebc34a85637a4d47d6fe6fa72f95d1e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yOc1hjpVgv4noCh8KJLtLw.jpeg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">通过YOLOv5进行样品检测。Original是YOLOv5存储库中提供的一个示例图像。</p></figure><h1 id="2585" class="mp mq iq bd mr ms om mu mv mw on my mz kf oo kg nb ki op kj nd kl oq km nf ng bi translated">要在您的系统中训练YOLOv5上的自定义数据集，请按照下列步骤操作:</h1><ul class=""><li id="822e" class="nm nn iq ku b kv nh ky ni mf or mg os mh ot ln oi ns nt nu bi translated">我们也可以使用在YOLOv4中用于训练的相同数据集，因为两者中注释的格式是相同的。在YOLOv4的情况下，我们将图像和标签放在同一个文件夹中，但在YOLOv5的情况下，我们需要将它们放在不同的文件夹中。</li><li id="85a6" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">创建一个名为<strong class="ku ja"> train_data </strong>的文件夹，在里面创建两个文件夹，<strong class="ku ja">images</strong>&amp;<strong class="ku ja">labels</strong>。在每个文件夹中创建两个名为<strong class="ku ja"> train </strong>和<strong class="ku ja"> val </strong>的文件夹。现在在<em class="kt">images/train</em>&amp;<em class="kt">images/val</em>里面分别放所有的训练和验证图像。并且在<em class="kt">labels/train</em>&amp;<em class="kt">labels/val</em>里面放了所有标注的训练和验证文本文件。</li><li id="0541" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">接下来我们需要创建一个<strong class="ku ja">数据文件</strong>和一个<strong class="ku ja">配置文件</strong>。数据文件是一个<strong class="ku ja">。yaml </strong>文件，包含训练所需的信息，包括训练和图像验证集的目录路径、类别数量和类别名称。您可以编辑<em class="kt">数据</em>文件夹中的coco128.yaml文件，创建自定义数据文件。</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pb"><img src="../Images/db919bfe192cf142eacb943c66ff50d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqroADgKr0UTrxeb_57TZw.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">YOLOv5的示例数据文件。<em class="oc">图片作者。</em></p></figure><ul class=""><li id="be0c" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">配置文件包含关于YOLOv5模型架构的信息。您可以编辑。从<strong class="ku ja"> <em class="kt">型号</em> </strong>文件夹中选择型号的yaml文件。您所要做的就是将变量<strong class="ku ja"> nc </strong>的值更改为自定义数据集中的类的数量。我只检测人，所以我把它改为1，并使用yolov5s模型(<strong class="ku ja"> yolov5s.yaml </strong>)。</li><li id="4450" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">现在您已经准备好训练您的模型了。在训练命令中，为选定的模型提供以下参数:</li></ul><p id="1dc6" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja"> img: </strong>输入图像尺寸</p><p id="cdea" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja">批次:</strong>批量大小</p><p id="583a" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja">时期:</strong>训练时期的数量</p><p id="44b5" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja">数据:</strong>我们之前创建的yaml文件</p><p id="5a64" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹:这里选的型号我用的是小的</p><p id="e394" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja">权重:</strong>一个自定义的权重路径如果为空，它将被保存在yolov 5/runs/train/yolov 5 _ results/weights中</p><p id="88c5" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja">名称:</strong>结果名称</p><p id="57b2" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja">设备:</strong> 0使用GPU</p><p id="28db" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">▹ <strong class="ku ja">缓存:</strong>缓存图像以加快训练速度</p><p id="0ac4" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated"><code class="fe oe of og oh b">For example: $ python3 train.py --img 416 --batch 64 --epochs 200 --data ./data/person.yaml --cfg ./models/yolov5s_person.yaml --weights ‘’ --name yolov5s_results --cache --device 0.</code></p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pc"><img src="../Images/548041dcd6e491c4dc9d043e8f8c9b11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0oIi7VGfDxkkHcFJZxyd9A.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">YOLOv5s模型经过200个时期的训练后的样本输出。<em class="oc">图片作者。</em></p></figure><ul class=""><li id="5326" class="nm nn iq ku b kv kw ky kz mf no mg np mh nq ln oi ns nt nu bi translated">一旦训练结束，就会保存两个重量，分别命名为<strong class="ku ja">最佳</strong>和<strong class="ku ja">最后</strong>。“最后”指的是200个时期结束时的权重，“最佳”指的是给出最小验证误差的权重。</li><li id="231d" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">你会在<em class="kt">yolov 5/runs/train/yolov 5s _ results</em>目录下的<strong class="ku ja">results.png</strong>文件中找到<strong class="ku ja">重量</strong>和关于你的训练过程的报告，如精度、召回等。</li></ul><h1 id="c0a2" class="mp mq iq bd mr ms om mu mv mw on my mz kf oo kg nb ki op kj nd kl oq km nf ng bi translated">您现在可以运行YOLOv5自定义对象检测器:</h1><ul class=""><li id="e1d6" class="nm nn iq ku b kv nh ky ni mf or mg os mh ot ln oi ns nt nu bi translated">您可以使用训练好的权重来预测图像中的对象。命令语法是<code class="fe oe of og oh b">$ python3 detect.py --source &lt;location of image&gt; &lt;location of weight file&gt;</code>，例如，测试图像文件image的代码是:<code class="fe oe of og oh b">$ python3 detect.py --source ./data/images/image.jpg --weights yolov5/runs/train/yolov5s_results/weights/best.pt</code>。</li><li id="8612" class="nm nn iq ku b kv nv ky nw mf nx mg ny mh nz ln oi ns nt nu bi translated">运行对象检测视频文件的命令是相同的，只是将图像的位置替换为数据文件夹中视频的位置(是的，就是这么简单！).<code class="fe oe of og oh b">$ python3 detect.py --source ./data/videos/test_video.mp4 --weights yolov5/runs/train/yolov5s_results/weights/best.pt</code>举个例子。结果的位置将显示在图像和视频代码输出的末尾。</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/fe2348b79e297276affe076ff5bb7e82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDAdYD6q0AhaKOJHOqzCbQ.jpeg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">运行YOLOv5定制模型的示例结果。原始照片<a class="ae me" href="https://images.unsplash.com/photo-1622183526757-7aac23115ffb?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1081&amp;q=80" rel="noopener ugc nofollow" target="_blank">来源</a>，由<a class="ae me" href="https://unsplash.com/@story_from_slowman" rel="noopener ugc nofollow" target="_blank">迪帕克·库马尔</a>在<a class="ae me" href="https://unsplash.com/photos/_ssmNHkymiA" rel="noopener ugc nofollow" target="_blank"> unsplash </a>上拍摄。</p></figure><p id="2982" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">虽然YOLOv5比YOLOv4使用起来简单得多，但它的效率和准确性还没有以正式研究的形式与其他常见的对象检测算法进行比较。它缺乏同行评审的研究论文来支持其性能和架构使用。然而，它的兼容性允许它在各种应用程序中使用，甚至在android应用程序中。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="9cd9" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">本文的主要目的不是给出运行YOLO模型的详细说明，而是展示安装操作系统的端到端过程，针对计算机视觉工作优化操作系统，并在其上运行和训练最先进的对象检测模型。我想强调在这个过程中可能会遇到的问题和疑问以及它们的解决方案。</p><p id="1281" class="pw-post-body-paragraph kr ks iq ku b kv kw ka kx ky kz kd la mf lc ld le mg lg lh li mh lk ll lm ln ij bi translated">我希望我能帮上忙！</p></div></div>    
</body>
</html>