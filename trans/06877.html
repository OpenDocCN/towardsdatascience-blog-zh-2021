<html>
<head>
<title>Polynomial Interpolation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多项式内插法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/polynomial-interpolation-3463ea4b63dd?source=collection_archive---------0-----------------------#2021-06-22">https://towardsdatascience.com/polynomial-interpolation-3463ea4b63dd?source=collection_archive---------0-----------------------#2021-06-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ce0d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="8f86" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">涵盖拉格朗日多项式插值、牛顿多项式插值和样条插值</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/36a6124231ad84aa6882f2d8c341a50c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wswi6ENYznaupKx17m19tg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">多项式插值——照片由<a class="ae lh" href="https://unsplash.com/@edgarraw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Edgar Castrejon </a>在<a class="ae lh" href="https://unsplash.com/s/photos/color?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="e96d" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">插入文字</h1><p id="f571" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">假设您对跟踪菜园全天的温度感兴趣。您每小时精确测量一次温度，最终得到以下24个温度测量值:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">在Python中准备数据集以便跟进</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi my"><img src="../Images/387605a2d120a4206775bc8e77c1ec9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/format:webp/1*VrL6UvSo4bz-hQZ6-_AEBQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">多项式插值每小时的温度</p></figure><p id="1c16" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">您可以使用任何工具将这些数据绘制在图表上，以获得所谓的散点图:每个测量值都有一个点。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ne"><img src="../Images/ad613f897d6bf06cc75badfd34b8db65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvhTvpV7h92W82hUW35Oww.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">散点图包含没有插值的测量值(每小时一次)</p></figure><p id="96b1" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">您可能感兴趣的下一步是将散点图转换成线形图。然而，您在数据点之间没有任何数据，因此您没有关于如何绘制线条的确切信息。</p><p id="8231" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">您可以使用插值来实现这一点。<strong class="mc jd">插值是智能估计数据点之间的值的任务。</strong></p><h1 id="697c" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">插值方法</h1><p id="3896" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">您可以使用许多不同的方法进行插值。最简单的方法是<strong class="mc jd">线性插值</strong>，你从每个数据点到下一个数据点画一条直线。虽然简单，但这种方法通常是错误的，因为它创建了一个有很多“角度”的图:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">线性内插法</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ne"><img src="../Images/049471570e59b9935647696fc4686699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mAJKXFKi0d5CAfm6BljA4Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">线性插值从每个点到下一个点绘制直线</p></figure><p id="bfac" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">另一种基本的插值方法是<strong class="mc jd">最近邻插值</strong>，其中使用最近邻来估计每个值。例如，您可以使用11点的测量值作为10:30到11:30的估计值，然后使用12点的测量值作为11:30到12:30的估计值，依此类推。你会得到这样一个图表:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">最近邻插值</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nf"><img src="../Images/4ec8e679b396a324f002666df3842636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UyTiSLMj_CMcWwUQ8ldOmA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">最近邻插值法使用最近的测量温度值来估计某个时间点的温度</p></figure><p id="5244" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">这个图看起来可能很奇怪:它被称为分段图。线中没有连续性，因为一旦达到阈值，估计值就从一个邻居“跳到”另一个邻居。在我们的示例中，阈值是半小时，但是这当然会根据您正在处理的示例而有所不同。</p><h1 id="bedd" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">多项式内插法</h1><p id="6607" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated"><strong class="mc jd">多项式插值</strong>是一种改进的插值方法，试图找到最适合您的数据的多项式函数。如果你不擅长数学，就把多项式函数想象成一个由许多函数组成的数学家族。</p><p id="69ac" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">让我们来看看多项式的定义:</p><blockquote class="ng nh ni"><p id="49f3" class="ma mb nj mc b md mz kd mf mg na kg mi nk nb ml mm nl nc mp mq nm nd mt mu mv im bi translated">多项式被定义为由变量和系数组成的表达式，只涉及变量的加、减、乘和非负整数幂运算。</p></blockquote><p id="de2e" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">然而，这是一个非常宽泛的定义:仍然有许多不同的功能遵守这一规则。多项式家族中有如此多不同的多项式，您总能找到适合您的数据的多项式。</p><p id="a3c8" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">多项式的次数由公式中的最大幂来定义。例如，一个2次多项式中有一个x的平方，一个3次多项式中有一个3次方，等等。让我们看一些多项式的例子来理解多项式函数的各种可能性。</p><h2 id="1b7c" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">二次多项式的一个例子</h2><p id="62e2" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">二次多项式是抛物线。下面的函数就是一个例子:</p><p id="7bfe" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><code class="fe ny nz oa ob b">y = 1 + x + x**2</code></p><p id="3953" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">它看起来如下:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">二次多项式</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/62f18f75720c693553ae255f73a96e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*iPQi4AyjqcMszxLVfx88Yw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">二次多项式的一个例子:抛物线</p></figure><h2 id="351d" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">三次多项式的一个例子</h2><p id="f2cb" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">三次多项式是三次多项式。下面的函数就是一个例子:</p><p id="547f" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><code class="fe ny nz oa ob b">y = 1 + x + x**2 + x**3</code></p><p id="503b" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">它看起来如下:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">三次多项式</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/053243ceba7c3f3c8181323416808e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*oWU4Ff5liItDViaQgT9hSQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">三次多项式的一个例子:三次多项式</p></figure><h2 id="fff3" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">6次多项式的一个例子</h2><p id="4d6a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">高次多项式可以采用非常复杂的形式。下面的函数就是一个例子:</p><p id="1e04" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><code class="fe ny nz oa ob b">y = 1/100 * (x**6 — 2x**5-26x**4+28x**3+145x**2-26x-80 )</code></p><p id="5c79" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">它看起来如下:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">六次多项式</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/2463bbfc2538475d090297c2e3997324.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*1SurXvtTuA5sWSdsQx6ksg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">六次多项式的一个例子</p></figure><p id="bde2" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">正如你在图表中看到的，多项式允许你定义非常复杂的形状。同时，<strong class="mc jd">曲线保持比通过线性插值或最近邻插值获得的曲线更加平滑</strong>。这是多项式插值如今成为大多数用例的首选插值方法的主要原因。</p><h1 id="1c93" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">多项式插值方法</h1><p id="501c" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">多项式插值的确切目标是找到到达数据集各点的最低可能次数的多项式。最低次可归结为多项式的最简单形式。</p><p id="8919" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">每个数据集只有一个最简单的多项式:有且只有一个正确的多项式，目标是找到它。然而，在本文中，我们将讨论多项式插值的三种常用方法:</p><ul class=""><li id="df05" class="of og it mc b md mz mg na mj oh mn oi mr oj mv ok ol om on bi translated"><strong class="mc jd">拉格朗日</strong>多项式插值</li><li id="601e" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><strong class="mc jd">牛顿</strong>多项式插值，也叫<strong class="mc jd">牛顿整除差插值多项式</strong></li><li id="97dc" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><strong class="mc jd">样条</strong>插值，更具体地说是<strong class="mc jd">三次样条</strong>插值</li></ul><p id="e229" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><strong class="mc jd">拉格朗日多项式</strong>和<strong class="mc jd">牛顿多项式</strong>给出完全相同的结果，然而它们通过不同的计算得出结果。拉格朗日和牛顿方法产生穿过数据点的最小阶的<strong class="mc jd">多项式函数。</strong></p><p id="26a7" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><strong class="mc jd">样条插值</strong>略有不同，因为它不是估算一个多项式，而是估算一个<strong class="mc jd">分段多项式</strong>。“真正的”多项式插值可能需要一个非常复杂的多项式来精确地遍历所有数据点。当复杂度变得太高时，多项式可能呈现出<em class="nj">极不稳定的曲线</em>，在数据点之间包含许多不需要的尖峰。</p><p id="e922" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><strong class="mc jd">样条插值</strong>是这个问题的解决方案，因为它在数据子集上定义了<em class="nj">多个更简单的多项式</em>。这在流畅和简单之间取得了巨大的平衡。样条插值是许多插值问题的首选解决方案。</p><p id="a86d" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">现在让我们更深入地讨论一下这三种插值方法。</p><h1 id="bf8f" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">拉格朗日多项式插值</h1><p id="4612" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我们要看的第一种多项式插值方法是拉格朗日多项式插值。这是一种方法，允许您找到通过数据集所有点的最低阶多项式。</p><h1 id="1878" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">拉格朗日插值公式</h1><p id="f0fe" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在这篇文章中，我们不去探究拉格朗日插值公式为什么起作用的数学证明，但是我们将看看如何手动使用它。</p><p id="f16a" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">下面是<strong class="mc jd">拉格朗日插值公式</strong>:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/20b531be6e9b111d09cfc39ec5fe5fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*NR90JleTCE_P2NOuF3GewA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">拉格朗日插值公式(第一部分)</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a5b877a098fcace5db310c242e270720.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*jB4mwP6btY5XpyLVBuLtyw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">拉格朗日插值公式(下)</p></figure><p id="4976" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">从第2部分开始理解更容易。第2部分基本上是说，对于数据集中的每组x和y值，将y值乘以x值的“第1部分计算”。</p><p id="6af7" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">必须为每个x值单独进行第1部分的计算。计算可以理解如下。对于除了问题中的x值之外的每个x值(调用问题j中的x值和所有其他的m)，将获得<code class="fe ny nz oa ob b">(x — m) / (j-m)</code>。然后你把它们的乘积。</p><h2 id="4d28" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">关于拉格朗日多项式插值的一个手工小例子</h2><p id="12a6" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">假设您有三个数据点:</p><p id="c214" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">(x = 2，y = 4) <br/> (x = 4，y = 16) <br/> (x = 6，y = 36)</p><p id="e47a" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">首先计算每个数据点的拉格朗日插值公式的第1部分:</p><ul class=""><li id="0f43" class="of og it mc b md mz mg na mj oh mn oi mr oj mv ok ol om on bi translated">对于第一个数据点:</li></ul><p id="3b2f" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><em class="nj">[(x—4)/(2—4)]*[(x—6)/(2—6)]</em></p><ul class=""><li id="9ad5" class="of og it mc b md mz mg na mj oh mn oi mr oj mv ok ol om on bi translated">对于第二个数据点</li></ul><p id="1bfb" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><em class="nj">[(x-2)/(4-2)]*[(x-6)/(4-6)]</em></p><ul class=""><li id="fa60" class="of og it mc b md mz mg na mj oh mn oi mr oj mv ok ol om on bi translated">对于第三个数据点</li></ul><p id="8161" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated"><em class="nj">[(x-2)/(6–2)]*[(x-4)/(6–4)]</em></p><p id="d0ea" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">然后，对每个数据点组合，取y和x的第一部分解的乘积之和:</p><p id="466a" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">4 *<em class="nj">[(x-4)/(2–4)]*[(x-6)/(2–6)]<br/>+16 *[(x-2)/(4–2)]*[(x-6)/(4–6)]<br/>+36 *[(x-2)/(6–2)]*[(x-4)/(6–4)]</em></p><p id="26a3" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">之后，你可以简化公式，你应该得到x**2。</p><h2 id="64cc" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">用Python求拉格朗日多项式插值</h2><p id="400a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">很高兴看到如何手动解决拉格朗日多项式插值，但这是一个很大的工作。现在让我们看看如何利用Python工具自动寻找最佳多项式。当然，大多数科学计算程序中都存在替代方案。</p><p id="8a62" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">让我们从刚才手动做的同一个例子开始</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的拉格朗日多项式插值</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/516db189f35dae8cf06eb79e6c8a09e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hC_SnVHxBuWPdTATxSBh7g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用Python的Scipy实现拉格朗日多项式插值是成功的小例子</p></figure><p id="9d77" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">在本例中，拉格朗日多项式插值的快速实现是成功的:x的平方已经被正确识别。</p><p id="c9db" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">现在，最大的问题是:我们能使用拉格朗日多项式插值来为我们的菜园例子的温度找到一个多项式吗？这个例子显然要复杂得多，需要一个非常复杂的多项式。让我们看看当我们将Scipy工具应用于这个问题时会发生什么:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的拉格朗日多项式插值</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/db21d4f0466b928a862ff5acd31fcda0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xS0zycG_rz_t-VzlWICzUA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用Python的拉格朗日插值的Scipy实现在大型示例中失败</p></figure><p id="611b" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">很明显，拉格朗日方法<strong class="mc jd">明显没有</strong>找到这个美国案例的多项式。这不是问题，甚至是意料之中的行为。Scipy文档声明:</p><blockquote class="ng nh ni"><p id="d169" class="ma mb nj mc b md mz kd mf mg na kg mi nk nb ml mm nl nc mp mq nm nd mt mu mv im bi translated"><strong class="mc jd">警告</strong>:该实现在数值上不稳定。不要期望能够使用超过20个点，即使它们是最佳选择。</p></blockquote><p id="070e" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">既然我们知道拉格朗日多项式插值无法处理如此大的插值示例，那么让我们继续研究牛顿多项式插值方法，看看它是否能给出更好的结果。</p><h1 id="d142" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">牛顿多项式插值</h1><p id="a393" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在让我们看看牛顿求最低阶多项式的方法。这种方法应该给出与拉格朗日多项式插值完全相同的答案，但是它使用不同的计算方法。</p><h2 id="5fdc" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">牛顿差分插值多项式</h2><p id="ace7" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">牛顿多项式法有时也被称为<strong class="mc jd">牛顿差分插值多项式。</strong>这是因为多项式的系数是用一种叫做除法的方法计算的，这种方法是由艾萨克·牛顿发明的。</p><p id="c779" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">您的x点必须等间距排列，以使用正向Netwon多项式方法。公式如下</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/e082f46b4556c839da41b056db05b5c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4sVu4zBDrWkc72vdz7Vrw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">牛顿差分插值多项式</p></figure><h2 id="7fa8" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">拉格朗日多项式与牛顿多项式</h2><p id="f5c1" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">牛顿多项式比拉格朗日多项式有一些实际的优点。它允许向计算中添加更多的数据点，而无需重新进行整个计算。</p><h2 id="1f81" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">Python中的牛顿多项式插值</h2><p id="4963" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">要进行牛顿多项式插值，我们需要找到一个实现，因为它在Scipy中没有实现。您可以使用以下Python代码进行牛顿多项式插值(归功于StackOverflow):</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的牛顿多项式插值</p></figure><p id="61cb" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">让我们首先在带有x平方函数的小数据示例上测试牛顿多项式插值代码:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的牛顿多项式插值</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/3344fcca80f798fb631166ee422ac2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9zK8UCWWf-b-FhTYvFUkA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">牛顿多项式插值成功的小例子</p></figure><p id="7df8" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">如图所示，牛顿多项式插值已成功找到基于三个数据点的函数x平方。目前是好消息。现在，让我们看看是否可以对我们菜园的温度数据使用同样的技术！</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的牛顿多项式插值</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/6f190a8005a086b77e24cdb8fb7df9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikHnk9VfSOlXNpMFsKOpaw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">牛顿多项式插值找到了一个关于大数据量多项式过于复杂的例子</p></figure><p id="0496" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">当看这个图时，你会看到，在某种程度上，牛顿实现比拉格朗日实现更好:至少牛顿遍历了所有的数据点。</p><p id="9295" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">然而，这个解决方案有一个严重的问题:这个多项式太复杂了，因此，它估计了从午夜到凌晨5点和从晚上8点到午夜的极端温度峰值。</p><p id="544d" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">这清楚地表明了<strong class="mc jd">多项式插值在其官方定义</strong>中的劣势。您强制模型找到一个且仅一个多项式来拟合您的所有数据点，但您的数据实际上并不遵循完美的多项式。<strong class="mc jd">因此，解决方案通常是一个强制的、过于复杂的多项式，在某些位置会有一些极端的误差。</strong></p><p id="5dbb" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">让我们来发现这个问题的解决方案:<strong class="mc jd">样条插值</strong>。</p><h1 id="6f94" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">样条插值</h1><p id="c940" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">样条插值与前两种插值方法有很大不同。你可以认为拉格朗日法和牛顿法是纯多项式插值:它们实际上只使用一个多项式函数进行插值。</p><p id="b014" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">样条插值是多项式插值的一种变体，它不仅仅适合一个复杂的多项式，而是适合许多较小次数的多项式。这样，你可以避免拟合太复杂的多项式，最终得到一条更平滑的曲线，插值误差更小。</p><h2 id="e187" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">三次样条插值</h2><p id="e094" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">要进行样条插值，您需要从每个点到下一个点拟合一个多项式。当你把它们放在一起时，你会得到许多组成完整插值函数的子函数。</p><p id="926c" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">当然，线的每一段的开始和结束值必须与前一段或后一段相对应。只有当<strong class="mc jd">使用三次或更复杂的多项式</strong>时，才能做到这一点。</p><p id="dc71" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">使用三次样条还有一个好处，你<strong class="mc jd">可以避免拟合过于复杂的曲线</strong>，就像我们在牛顿法中看到的那样。因此，样条插值的标准方法是<strong class="mc jd">只使用三次样条。</strong></p><h2 id="6c5d" class="nn lj it bd lk no np dn lo nq nr dp ls mj ns nt lu mn nu nv lw mr nw nx ly iz bi translated">Python中的三次样条插值</h2><p id="5eea" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">大多数科学软件提出了三次样条插值的方法。让我们看看如何在Python中使用Scipy实现三次样条插值。我们将从三个数据点的小例子开始。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的三次样条插值</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/04d29cb41a7acf7ccb69bf7d7647af51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMJt_862_KAEIcjaFACbcg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">三次样条插值成功的小例子</p></figure><p id="633c" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">毫不奇怪:就像拉格朗日和牛顿一样，三次样条也找到了x平方函数。让我们看看它在菜园温度数据上的表现。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mw mx l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的三次样条插值</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ne"><img src="../Images/0be99e5d468c63b1ecbd0e0f4d1fd222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wNd_ceOGweTdy_yfTv9WUw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">三次样条插值在大数据集上是成功的</p></figure><p id="d805" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">正如你所看到的，三次样条提出了一个非常“自然”的插值。它比您之前看到的线性插值或最近邻插值平滑得多。同时，它比拉格朗日和牛顿提出的“纯”多项式方法要简单得多。</p><p id="095d" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">线性和最近邻插值可能仍然发现其理论简单性的优势，并且拉格朗日和牛顿插值在非常简单的数据上仍然具有优势，该数据完美地表示低阶多项式。然而，样条插值的平滑性和简单性使其成为当今许多插值挑战的首选方法。</p><h1 id="dd32" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">关键要点</h1><ul class=""><li id="5ca0" class="of og it mc b md me mg mh mj pa mn pb mr pc mv ok ol om on bi translated">在本文中，您已经发现了<strong class="mc jd">五种插值方法</strong>，其中三种方法为<strong class="mc jd">多项式插值</strong>。</li><li id="4bc4" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><strong class="mc jd">线性插值</strong>是最简单的插值方法，因为它包括在每个数据点和下一个数据点之间绘制直线。<strong class="mc jd">最近邻插值</strong>使用最近的测量值作为中间值的估计值。</li><li id="e247" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><strong class="mc jd">拉格朗日多项式插值</strong>和<strong class="mc jd">牛顿多项式插值</strong>(或牛顿差分插值多项式)是两种确定性地找到穿过所有数据点的最低阶多项式的方法。</li><li id="63ce" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated"><strong class="mc jd">样条插值</strong>，尤其是<strong class="mc jd">三次样条插值</strong>，是一种更灵活的替代方法，可以找到分段多项式。这允许降低所用多项式的阶数，具有更简单和更接近实际的优点。这是以在分段函数中使用许多多项式而不是定义一个整体多项式为代价的。</li></ul><p id="ae5e" class="pw-post-body-paragraph ma mb it mc b md mz kd mf mg na kg mi mj nb ml mm mn nc mp mq mr nd mt mu mv im bi translated">我希望这篇文章对你有用。不要犹豫，继续关注更多的数学、统计和数据内容！</p></div></div>    
</body>
</html>