<html>
<head>
<title>Building memory-efficient meta-hybrid recommender engine: back to front (part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建内存高效的元混合推荐引擎:从后到前(第1部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-memory-efficient-meta-hybrid-recommender-engine-back-to-front-part-1-7be279ca92a6?source=collection_archive---------22-----------------------#2021-07-23">https://towardsdatascience.com/building-memory-efficient-meta-hybrid-recommender-engine-back-to-front-part-1-7be279ca92a6?source=collection_archive---------22-----------------------#2021-07-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a0cd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何从头开始构建一个推荐器，在保持简单的同时提高其准确性</h2></div><h1 id="2704" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">你会推荐什么？</h1><p id="ccae" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">2020年至2021年的环境使得越来越多的企业主考虑将与客户的主要通信转移到网上。你可能已经注意到，预测、引导和购买的在线活动(甚至是线下活动)的数量最近发生了多么大的变化？似乎任何互联网企业都尽最大努力与客户保持无休止的对话。在这样的对话中，客户期望从卖家那里接收至少相关的个人报价，以便更快地做出选择。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="759f" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">面向客户的个人报价是由所谓的推荐系统(recsys)产生的。Recsys 是机器学习算法的一个子类，用于获得用户可能偏好的物品的排序列表。</p><p id="ce62" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">整个recsys的种类可以分为几类(由<a class="ae mf" rel="noopener" target="_blank" href="/introduction-to-recommender-systems-6c66cf15ada"> Rocca，2019 </a>):</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mg"><img src="../Images/12aadd5e41f126a2b9e3ef331dee04a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zFygHnltTA6nCMYsw8kEsw@2x.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">图片作者:Baptiste Rocca</p></figure><p id="917f" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">在这一系列出版物中，我们将浏览:</p><ul class=""><li id="a911" class="mr ms iq kz b la ma ld mb lg mt lk mu lo mv ls mw mx my mz bi translated">基于记忆的推荐系统的机制</li><li id="015c" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">构建你自己的基于用户的协同过滤推荐器</li><li id="9a59" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">应用来自流行python模块的“开箱即用”推荐器</li><li id="4629" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">评价推荐者效率和准确性的技巧</li></ul><p id="96cb" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">沿着这条路，我们将分享我们在设计所谓的元混合推荐引擎以解决实际业务问题方面的经验。</p><h1 id="99b0" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">推荐引擎是如何工作的？</h1><h2 id="7007" class="nf kg iq bd kh ng nh dn kl ni nj dp kp lg nk nl kr lk nm nn kt lo no np kv nq bi translated">数据介绍</h2><p id="cfbd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在该出版物中，我们将使用<a class="ae mf" href="https://grouplens.org/datasets/movielens/latest/" rel="noopener ugc nofollow" target="_blank">数据集</a>。</p><p id="bcb9" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">除了用户的评级，数据集还包含关于电影本身的描述性信息(如上映年份、类型、内容标签)，我们将在第二部分使用这些信息来提高推荐者预测的准确性。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="2166" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">为了理解推荐器是如何工作的，让我们通过几个步骤来创建一个微数据集:</p><ul class=""><li id="2958" class="mr ms iq kz b la ma ld mb lg mt lk mu lo mv ls mw mx my mz bi translated">从主数据集中随机选择几个用户</li><li id="9998" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">编辑一个电影列表，上面列表中的每部电影都有3个或更多的用户看过</li><li id="b992" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">从前面的列表中随机选择几部电影</li><li id="051b" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">从随机选择的用户和电影的交集上的所有用户-电影对构建评级矩阵。</li></ul><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><h2 id="c935" class="nf kg iq bd kh ng nh dn kl ni nj dp kp lg nk nl kr lk nm nn kt lo no np kv nq bi translated">设计定制推荐引擎</h2><p id="00c5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">由此产生的评级矩阵代表了recsys表现的典型背景:一些用户可以从我们的微库中收到他们以前没有看过的电影的推荐；推荐者必须对个人推荐进行排名，以保持用户对未看过电影的喜爱。</p><p id="a492" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">解决这些任务所需的最少信息在评级的微矩阵本身中，即用户与所看电影的交互历史(即除了我们的协同过滤推荐器的“记忆”之外的所有信息)。</p><p id="39a7" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">基于记忆的推荐器简单地基于由另一组{A…X}用户分配给那个Z电影的评级来预测Y用户对一部未看过的Z电影的评级，所述另一组用户的电影偏好与Y用户的相似。</p><p id="ef5e" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">在最简单的情况下，Y-Z对的评级预测被计算为Z-movie的一组可用评级的加权平均值，取决于Y-user与每个{A…X}用户的“相似度”。</p><p id="0dd2" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">“相似度”是两个用户的评级向量之间的距离，通过减去平均值来标准化(缩放)。因此，分级评级向量的平均值为零，这允许我们用零安全地填充所有缺失的值(即特定用户对未看过的电影的评级)。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="3062" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">用户评级的标准化向量之间的余弦距离矩阵。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="e1a9" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">正如所料，矩阵主对角线的所有元素都等于零(用户到自己的距离)。</p><p id="37b7" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">去掉主对角线后，我们将得到每个用户到系统中所有其他用户的距离向量。此外，在推荐引擎中，这些距离将被转换为“逆”权重，以加权平均值的形式计算评级。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="3070" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">换句话说，我们的定制推荐器迭代地预测每个用户电影对(包括用户未看过的电影！成对)作为特定电影的可用评级的向量和与从特定用户到其评级被考虑的其他用户的距离成反比的权重向量的乘积。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="2749" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">尽管很简单，但我们的定制推荐器可以处理缺少实际用户评级的情况(即评级矩阵中缺少单元)以及用户“相反”电影偏好的情况(即双向分级评级向量)。</p><p id="d76b" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">我们的客户推荐器的平均绝对百分比误差(MAPE)大约是15.5%</p><h1 id="3593" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">生产就绪型推荐器</h1><p id="68bd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们已经建立了一个推荐器，它可以预测评分，并可以产生一个排名推荐列表——这太棒了，哇！</p><p id="3fe8" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">然而，我们的“原样”推荐器有相当多的缺点:</p><ul class=""><li id="8e41" class="mr ms iq kz b la ma ld mb lg mt lk mu lo mv ls mw mx my mz bi translated">它不允许从基于用户的协同过滤切换到基于项目的协同过滤</li><li id="92b6" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">它不允许在计算向量乘积时微调要考虑的用户数量</li><li id="b350" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">它不适用于具有高级预测算法的实验</li><li id="fcca" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">最后，它需要优化来处理大型数据集</li></ul><p id="af1b" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">所有这些缺点，对于用<a class="ae mf" href="https://surprise.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir">惊喜</strong> </a>这样的python模块搭建的推荐器来说，都是无关紧要的。</p><p id="d9b4" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">例如，将来自<strong class="kz ir"> surprise </strong>家族(即<a class="ae mf" href="https://surprise.readthedocs.io/en/stable/knn_inspired.html# surprise.prediction_algorithms.knns.KNNWithMeans" rel="noopener ugc nofollow" target="_blank"> KNNWithMeans </a>)的稍微更高级(但大体上接近于上面描述的那个)的预测算法应用于相同的“非常评级”微矩阵“开箱即用”推荐器，您会立即将MAPE从15.5%降低到11.4%:</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="8eb6" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">两个演示推荐器的预测结果显示在可视化界面上:</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><h2 id="0d60" class="nf kg iq bd kh ng nh dn kl ni nj dp kp lg nk nl kr lk nm nn kt lo no np kv nq bi translated">有价值的推荐:小心对推荐人的评价</h2><p id="d342" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们通常不使用MAPE /梅/ RMSE来比较推荐者的准确性，而是使用高于指定阈值的估计评分的项目列表的准确性和召回率。</p><p id="6032" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">请注意，如果我们决定将我们的电影微库中推荐的电影的最低评级设置为3.5或4.0，对相同用户的推荐将如何变化？</p><p id="1962" class="pw-post-body-paragraph kx ky iq kz b la ma jr lc ld mb ju lf lg mc li lj lk md lm ln lo me lq lr ls ij bi translated">在本出版物的下一部分，我们将展示如何使用适当的指标并提高“开箱即用”<strong class="kz ir"> SVD </strong>预测算法(来自惊喜模块)的效率，该算法被称为<a class="ae mf" href="https://pantelis.github.io/cs301/docs/common/lectures/recommenders/netflix/" rel="noopener ugc nofollow" target="_blank">网飞奖获得者</a>。</p></div></div>    
</body>
</html>