<html>
<head>
<title>Remove personal information from a text with Python — Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从文本中移除个人信息—第二部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/remove-personal-information-from-a-text-with-python-part-ii-ner-2e6529d409a6?source=collection_archive---------8-----------------------#2021-08-12">https://towardsdatascience.com/remove-personal-information-from-a-text-with-python-part-ii-ner-2e6529d409a6?source=collection_archive---------8-----------------------#2021-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="05ed" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Python中实现隐私过滤器，通过命名实体识别(NER)移除个人可识别信息(PII)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/470be41e12c5afb7f957bf2c3a10a9aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*34uAb5R50Kp1AFTJ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片来自<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@lazycreekimages" rel="noopener ugc nofollow" target="_blank"> Michael Dziedciz </a></p></figure><p id="fc0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我的<a class="ae ky" rel="noopener" target="_blank" href="/remove-personal-information-from-text-with-python-232cb69cf074">上一篇关于从短信中删除个人信息的文章</a>的后续。</p><p id="5c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GDPR是欧盟的<em class="lv">通用数据保护法规</em>。其目的是保护所有欧洲居民的数据。保护数据也是开发人员的内在价值。通过控制对列和行的访问，保护行/列数据结构中的数据相对容易。但是自由文本呢？</p><p id="a568" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的上一篇文章中，我描述了一个基于正则表达式和禁用词列表的解决方案。在本文中，我们添加了一个基于<em class="lv">命名实体识别(NER) </em>的实现。完整的实现可以在github PrivacyFilter项目中找到。</p><h2 id="cd97" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">什么是命名实体识别？</h2><p id="c2ff" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">据<a class="ae ky" href="https://en.wikipedia.org/wiki/Named-entity_recognition" rel="noopener ugc nofollow" target="_blank">维基百科</a> NER是:</p><blockquote class="mu"><p id="442c" class="mv mw it bd mx my mz na nb nc nd lu dk translated">命名实体识别(NER)(也称为(命名)实体识别、实体分块和实体提取)是信息提取的一个子任务，它试图定位非结构化文本中提到的命名实体并将其分类到预定义的类别中，例如人名、组织、位置、医疗代码、时间表达式、数量、货币值、百分比等。</p></blockquote><p id="56a6" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">因此，这是所有关于寻找和识别文本中的实体。一个实体可以是一个单词，也可以是一系列连续的单词。实体被分类到预定义的类别中。例如，在下面的句子中，找到了三个实体:实体<strong class="lb iu">个人</strong>“巴斯蒂安·特龙】，实体<strong class="lb iu">组织</strong>“谷歌”，实体<strong class="lb iu">日期</strong>“2007”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/f947ea62be965fa9d7eff76bcafa79d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EoKX2FATkjQAngXVLP83Gw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实体识别示例(来源:<a class="ae ky" href="https://spacy.io/usage/visualizers" rel="noopener ugc nofollow" target="_blank"> Spacy.io </a></p></figure><p id="4a80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">NER是人工智能领域<em class="lv">自然语言处理</em> (NLP)的子集。这个领域包含处理和分析自然语言的算法。当NER能够识别自然语言中的实体时，如果这些实体是隐私相关的实体，如<strong class="lb iu">人</strong>、<strong class="lb iu">组织</strong>、<strong class="lb iu">日期</strong>或<strong class="lb iu">位置</strong>，则可以从文本中删除这些实体。</p><h2 id="50a2" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">用NER过滤PII</h2><p id="09d8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">首先，我们需要一个NLP处理包。因为所有语言都有自己的语法，所以NLP包是按语言进行训练的。我们正在与荷兰，所以我们需要一个理解这一点。我们将使用Spacy作为我们的隐私过滤器。</p><p id="64f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Spacy网站上可以找到一个<a class="ae ky" href="https://spacy.io/usage" rel="noopener ugc nofollow" target="_blank">工具</a>来帮助安装Spacy。在选择Python环境和语言之后，它会给出适当的命令来安装Spacy:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/c302c37e3733d3c25e14a41432fa5f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNRf1wVnrxrufkEfjOFR8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Spacy安装工具(来源:<a class="ae ky" href="https://spacy.io/usage" rel="noopener ugc nofollow" target="_blank"> Spacy.io </a></p></figure><p id="fc11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选定的管道(效率或准确性)决定了NER模型的准确性与规模和速度。选择“效率”会产生更小、更快的模型，但与“准确度”相比，准确度较低。这取决于您的用例，哪个模型更合适。对于开发，我们选择使用效率模型。运行第一次NER分析:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="da58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第2行导入Spacy包之后，使用<em class="lv"> spacy.load() </em>方法加载一个模型。在这种情况下，加载荷兰的有效模型。模型由其名称指定，该名称与上一步中用于下载模型的名称相同。要切换到准确的荷兰语模型，请将“nl_core_news_sm”替换为“nl_core_news_lg”。对于上面的例子，这导致相同的输出。</p><p id="cb44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个快速、简单的性能测试表明，加载小模型需要大约2.0秒，而加载大模型需要大约4.5秒。分析一个句子需要5.5毫秒，而不是6.0毫秒。大型号似乎需要大约500 MB的额外内存。</p><p id="da45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">词性(POS)标签的含义可以在<a class="ae ky" href="https://universaldependencies.org/docs/u/pos/" rel="noopener ugc nofollow" target="_blank">这个网站</a>上找到。对于我们的示例，它们是:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="1d58" class="lw lx it no b gy ns nt l nu nv">Geert PROPN PERSON     Proper noun, person<br/>werkt VERB             Verb<br/>sinds ADP              Adposition, case marking<br/>2010  NUM DATE         Numeral, date<br/>voor  ADB              Adposition<br/>HAL   PROPN ORG        Proper noun, organisation<br/>.     PUNCT            Punctuation</span></pre><p id="dc55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了过滤PII，我们对POS类型NUM和PROPN感兴趣。我们将用描述实体类型的标签来替换POS文本元素。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="3d38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码的第一部分加载语言模型，并将输入字符串解析为一个标记列表(<em class="lv"> doc </em>)。第8–16行的循环通过遍历文档中的所有标记来构建过滤后的文本。如果令牌的类型是PROPN、NOUN或NUMBER，则用标签&lt; … &gt;替换，其中标签等于Spacy识别的实体类型。所有标记都用前缀空格连接到新字符串。前缀是必需的，因为对字符串进行标记会移除这些前缀。对于标点符号，不添加前缀空格(第12–13行)。</p><p id="4934" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在循环之后，新字符串的第一个字符是一个空格，因为第11或13行，所以我们需要删除这个空格(第17行)。这导致字符串中没有隐私信息。</p><p id="1efb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">有多好？</strong></p><p id="5c96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上一篇文章中，我们已经建立了一个基于禁用单词列表的隐私过滤器。与NER相比，这种方法需要更多的代码和工作。但是他们如何比较呢？</p><ul class=""><li id="c4ed" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ob oc od oe bi translated">NER要求语法正确的句子。在这种情况下，隐私信息的替换很有效，即使名字拼错了。NER优于禁语列表。</li><li id="31b4" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">无论上下文如何，禁用词过滤器都会替换禁用词。尤其是街道名称和城市名称的列表，导致大量不必要的删除单词。例如，像植物名称、动物或像城堡这样的物体这样的词作为街道名称是常见的，并且将从文本中移除。这可能会删除许多不必要的单词，降低结果文本的可用性。NER会表现得更好。</li><li id="6fed" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">如果文本语法不正确(例如，问题“你叫什么名字？”的答案“Peter”不会被NER过滤掉。这些句子在聊天信息和谈话记录中很常见。NER方法在这些情况下会失败，因为NER算法不能用一个或几个词来确定这些答案的性质。</li></ul><p id="adc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，这完全取决于您的使用案例和所需的过滤级别。这种组合决定了最佳方法是使用禁用列表版本、NER版本还是两者的组合。后者将结合两种方法的优点(但也是它们的部分缺点)。为了找到最佳的方法，请选取数据的一个子集来过滤和测试不同的算法和/或组合，以找到最合适的方法。</p><p id="3c0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些例子来比较NER和被禁词列表(FWL):</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d2ac" class="lw lx it no b gy ns nt l nu nv">INPUT: Geert werkt sinds 2010 voor HAL.<br/>NER  : &lt;FILTERED&gt; werkt sinds &lt;FILTERED&gt; voor &lt;FILTERED&gt;.<br/>FWL  : &lt;FILTERED&gt; werkt sinds &lt;FILTERED&gt; voor HAL.</span><span id="abd3" class="lw lx it no b gy ok nt l nu nv">INPUT: Heert werkt sinds 2010 voor HAL.<br/>NER  : &lt;FILTERED&gt; werkt sinds &lt;FILTERED&gt; voor &lt;FILTERED&gt;.<br/>FWL  : Heert werkt sinds &lt;FILTERED&gt; voor HAL.</span><span id="f5f6" class="lw lx it no b gy ok nt l nu nv">INPUT: Wat is je naam? Geert.<br/>NER  : Wat is je naam? Geert.<br/>FWL  : Wat is je naam? FILTERED.</span><span id="34f1" class="lw lx it no b gy ok nt l nu nv">INPUT: Geert kijkt naar de duiven op het dak.<br/>NER  : &lt;FILTERED&gt; kijkt naar de duiven op het dak.<br/>FWL  : &lt;FILTERED&gt; kijkt naar de &lt;FILTERED&gt; op het dak.</span></pre><p id="c3da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">(为了便于比较，所有像<person>这样的标签都被替换为通用标签<filtered/></person></p><p id="43b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个例子显示tat FWL不能删除公司名称，因为它没有公司名称列表。NER算法已经在句子中确定“HAL”是一个名词，更具体地说是一个组织。</p><p id="dbc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个例子表明，NER可以处理名称中的类型错误，因为它查看句子的结构，而FWL不识别“Heert”作为名称。名称列表只包含正确拼写的版本。</p><p id="ea13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第三个例子表明，NER需要语法正确的句子来识别“Geert”是一个名字。这可能是对话的文字记录，也可能是聊天中的互动。它展示了NER如何很好地运用书面语，但却难以理解口语。</p><p id="5fe7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在最后一个例子中，FWL去掉了单词“duiven ”,因为它不仅描述动物(duiven在荷兰语中是鸽子的意思),而且还是一个城市的名称。</p><p id="5a7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Github 上的<a class="ae ky" href="https://github.com/lmeulen/PrivacyFilter" rel="noopener ugc nofollow" target="_blank">隐私过滤器代码包含两种方法，在初始化期间，可以选择NER方法或FWL方法。在本文中，我们没有涉及正则表达式，但是选择NER方法也将执行正则表达式(NER不能识别和替换URL等)。它还包含一些使用和过滤的示例文本，以查看现实生活中美国案例中两种方法之间的差异。</a></p><h1 id="1449" class="ol lx it bd ly om on oo mb op oq or me jz os ka mh kc ot kd mk kf ou kg mn ov bi translated">最后的话</h1><p id="dd74" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">本文和上一篇文章描述了两种删除文本中个人信息的方法。这两种方法各有优缺点，不可能为所有用例选择一种方法。删除更多的隐私信息也会导致删除更多的非隐私信息，从而降低过滤文本的价值。NER在删除已识别的隐私信息方面更准确，但需要结构良好的句子才能操作。为了获得最大的安全性，甚至可以将两种方法结合起来。请随意在Github 上试验<a class="ae ky" href="https://github.com/lmeulen/PrivacyFilter" rel="noopener ugc nofollow" target="_blank">的实现。</a></p><p id="b7a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章。要获得更多灵感，请查看我的其他文章:</p><ul class=""><li id="9a70" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ob oc od oe bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/remove-personal-information-from-text-with-python-232cb69cf074">用Python删除文本中的个人信息</a></li><li id="63c7" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/side-by-side-comparison-of-strings-in-python-b9491">Python中字符串的并排比较</a></li><li id="9491" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/parallel-web-requests-in-python-4d30cc7b8989">使用Python实现并行web请求</a></li><li id="0e70" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/all-public-transport-leads-to-utrecht-not-rome-bb9674600e81">所有公共交通工具都通向乌得勒支，而不是罗马</a></li><li id="ab0b" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/visualization-of-travel-times-with-otp-and-qgis-3947d3698042">使用OTP和QGIS可视化行程时间</a></li></ul><p id="2f32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">免责声明:本文包含的观点和看法仅归作者所有。</em></p></div></div>    
</body>
</html>