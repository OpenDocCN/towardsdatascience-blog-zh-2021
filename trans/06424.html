<html>
<head>
<title>Functional Principal Component Analysis and Functional Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">函数主成分分析和函数数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/functional-principal-component-analysis-and-functional-data-91d21261ab7f?source=collection_archive---------7-----------------------#2021-06-09">https://towardsdatascience.com/functional-principal-component-analysis-and-functional-data-91d21261ab7f?source=collection_archive---------7-----------------------#2021-06-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6212" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="c0a4" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">简要介绍函数数据，尤其是函数主成分分析。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/839edd2e7f92c2056cd143b023d9e4a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*AKwrh0GkjURrmSNxv8W07Q.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">功能数据的典型示例(图片由作者提供)</p></figure><h1 id="a875" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">功能数据</h1><p id="03fa" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">功能数据到底是什么？</p><p id="e8cf" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">假设您连续多年每天都在测量家乡的温度。如果你接着查看累积的数据，你可能会得出结论，温度在一年内的表现有些相似。嗯，这很明显，我们毕竟是按照这种模式生活的。天气受时间控制。事实上，有人可以说，有一个潜在的时间函数，导致了你的测量。现在在函数数据分析中，我们不把我们的测量数据解释为一个观察序列，而是一个单一的函数或曲线。这比传统的时间序列视图有多方面的优势。</p><ol class=""><li id="48a1" class="mt mu iq lu b lv mo ly mp mb mv mf mw mj mx mn my mz na nb bi translated">一个函数通常可以在任何时间点进行求值。</li><li id="a3da" class="mt mu iq lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">我们可以分析函数的导数。</li><li id="b36a" class="mt mu iq lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">功能可以很容易地注册到一个共同的时间表。</li><li id="7079" class="mt mu iq lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">函数可以为我们的数据提供更加自然和直观的视图。</li><li id="c374" class="mt mu iq lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">不必在相同的时间点进行测量才能进行比较。</li></ol><p id="7817" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">第五点其实是一个普遍的问题。经常发生的情况是，您想要比较时间序列，但是它们的测量值不是同时进行的，或者一个测量值比另一个测量值多。比较这些会有问题。如果我们把数据看作函数，比较就容易多了。</p><h1 id="bda1" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">我们是不是忘了什么？</h1><p id="dcbe" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">函数是连续的，测量是不连续的。</p><p id="c585" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">是的，事实上测量是不连续的。但是我们可以估计数据的基本函数。通过这种方式，我们还能够进行平滑处理，这对于降低噪声来说是理想的。你可能会问，如何做到这一点？一种常见的方法是使用基展开。这里，我们将通过基函数的线性组合来表示我们的测量值。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/4047bf84d62f97b0f87068d415ddd521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*bUHRwsWf0B4DGvMuLWRfkg.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">(图片由作者提供)</p></figure><p id="c074" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">常见的基函数是B样条、小波或傅立叶基。我们使用的基函数越多，我们得到的平滑就越多。这可能是为了减少噪音。在上面的图中，我使用了20个B样条来估计我的数据的基本函数。</p><p id="6111" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">现在你知道了什么是函数数据，以及我们如何从我们的离散测量中估计出潜在的函数。你现在是某种专家了。</p><h1 id="4f94" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">功能主成分分析</h1><p id="cdfd" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">主成分分析的老大哥。</p><p id="5a1e" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">有大量的技术来分析功能数据。其中许多都有一个非功能性的对应物，您可能已经使用过了。FPCA是基于主成分分析，一种著名的降维技术。为了理解FPCA，我们至少应该简要地谈谈PCA。</p><h2 id="4d97" class="nh lb iq bd lc ni nj dn lg nk nl dp lk mb nm nn lm mf no np lo mj nq nr lq iw bi translated">主成分分析</h2><p id="1266" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">函数主成分分析的小兄弟。</p><p id="714d" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">PCA解决了数据分析中的一个常见问题。很多时候，我们必须降低大型数据集的维度。这是很有问题的，因为每个维度都存储着信息，如果我们忽视它们，我们就会丢失这些信息。也就是说，我们需要在降低维度的同时测量信息。在PCA的情况下，这个度量是我们的数据内的变化。哪里有变异，哪里就有信息。</p><p id="e175" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">PCA找到所谓的主成分(向量)，其沿着它们的方向最大化数据的方差。每个主成分解释了数据中总方差的一部分。他们建立了一个标准正交基，这意味着每个数据点是我们的主成分的线性组合。现在，我们可以通过使用PC的子集来表示数据点，从而降低数据的维数。例如，我们将选择最小数量的PC，它们的总方差超过95%。这样，我们减少了数据集的维度，但仍然保留了大部分信息。</p><p id="741f" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">如果您不熟悉PCA，我鼓励您阅读这篇文章，以便更好地了解这项技术。</p><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd ja gy z fp oa fr fs ob fu fw iz bi translated">主成分分析的一站式商店</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">在我用于研究生统计理论课的教科书的开始，作者(乔治·卡塞拉和罗杰…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ku nv"/></div></div></a></div><h2 id="f255" class="nh lb iq bd lc ni nj dn lg nk nl dp lk mb nm nn lm mf no np lo mj nq nr lq iw bi translated">真正的交易</h2><p id="ed38" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">FPCA本质上与PCA做完全相同的事情，但是有一些小的不同。在PCA中，我们处理向量，而在FPCA中，我们处理函数。这意味着我们的主要组成部分也是函数，或曲线。在下文中，我们称它们为功能主成分(fPC)。现在我们如何找到这些fPC？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/06820077f48a8887f4fafd1d62fe096c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*T9HEifpptR-JosG3LRGQxQ.png"/></div></figure><p id="8b7d" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">给定n条曲线，通过最大化第一个fPC分数的方差来找到第一个fPC。我们将第一个fPC限制为一个，因为我们可以通过增加第一个fPC来无限地最大化。这样我们可以找到最大化的明确答案。第一个fPC是我们数据变化的主要来源。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/4bbbed6d70a11fc0432a28bb19bae7ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*-jwJP7DWFfmmS55eh89ShQ.png"/></div></figure><p id="c998" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">现在，与第一个fPC相同的过程适用于第二个fPC(以及以下所有fPC)。只是这次我们有了一个额外的约束。也就是说，第二fPC与第一fPC正交。事实上，所有fPC都必须相互垂直。现在，每条曲线都可以表示为fPC的线性组合。fPC分数告诉我们一条曲线在多大程度上由它各自的函数主成分组成。</p><p id="ca3c" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">现在你也知道了功能主成分背后的理论，但是如何应用这种技术呢？</p><h1 id="4c1a" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">一个典型的用例</h1><p id="c348" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">也是一个相当温和的人。</p><p id="b0d0" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">可以探索性地使用FPCA来更深入地了解您的数据。现在我想给你们举个例子。我们想要分析的数据是过去200年来法国男性的对数死亡率。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/7fe7cd53d12f2826c1f172985b25a02f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*opZ_3uyM-2VXsl-M7XwLfg.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">(图片由作者提供)</p></figure><p id="ea0e" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">首先，我们估计数据的基本函数。如前所述，我们使用B样条基展开来实现这一点。这额外导致平滑，这是伟大的，因为我们减少噪音。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/4c4aa29eae4bc37f6b69ff7a21104a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*7ejHTk5SqUq3ozqaTR2-fQ.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">(图片由作者提供)</p></figure><p id="a6ff" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">现在我们运行功能主成分分析，看看前两个功能主成分。这两个解释了我们数据中大约97%的变化。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/523682a53c75c6e42e06a8c5fb8b0ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Uu0bOPGjbHhequoMPDP43g.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">(图片由作者提供)</p></figure><p id="dcf3" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">这些功能性主成分的解释可能相当困难，因为在数据中可能没有明显的对应物。在我们的例子中，这种解释幸运地非常直观。</p><p id="259e" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">第一个fPC似乎是我们数据的均值函数的变化。这种变化会随着时间的推移而减少。也可以说，我们越老，我们的死亡就越确定。这个fPC解释了我们数据中94%的变化。</p><p id="4c96" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">第二个fPC似乎与20-40岁的人有关。这暗示了在我们的数据中，这个年龄组的死亡率与其他年龄组有很大的不同。我立即想到的是两次大战，它们造成了如此多年轻人不必要的死亡。</p><p id="ae14" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">还记得我们说过如何找到函数的主成分吗？当时，我们了解到数据中的每条曲线都可以表示为fPC的线性组合，其中每个fPC分数决定了曲线在多大程度上由哪个成分解释。我们现在可以做的是将每条曲线缩减为一个二维点，由前两个fPC分数组成。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/adc1735d31db318065acaee577a2d12a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*jsdzhKoNWILgvQ8OWGOpTQ.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">(图片由作者提供)</p></figure><p id="bfc1" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">这很有趣。通过颜色编码，我们可以看到战争年代的曲线在很大程度上是由第二fPC解释的。这是一个好消息，因为我们的解释是正确的。我们也可以很清楚地看到，死亡率在1950年左右有一个很大的转变。这在原始数据中并不清楚。我们不仅深入了解了数据，还在不丢失太多信息的情况下降低了数据的(高维)维度。我们现在能够进一步使用这种表示并应用传统的聚类算法。</p></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><p id="f85f" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">最后我想提一下，我从[2]中获得了这个分析的灵感。如果你对FPCA更深入的解释和示范性的使用感兴趣，我鼓励你去看看。</p><p id="10da" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">在[3]中还可以找到scikit-fda python包的文档。它为多功能分析工具提供了许多易于理解的例子。</p></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><p id="620d" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">[1] <em class="ot">人类死亡率数据库</em>。加州大学伯克利分校(美国)和马克斯·普朗克人口研究所(德国)。可在www.mortality.org的<a class="ae ou" href="http://www.mortality.org" rel="noopener ugc nofollow" target="_blank">或</a><a class="ae ou" href="http://www.humanmortality.de" rel="noopener ugc nofollow" target="_blank"> www.humanmortality.de </a>获得(数据于【01.06.2021】下载)。</p><p id="6f1d" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated">[2]尚，H.."功能主成分分析综述."AStA统计分析进展98(2014):121–142。</p><p id="25dd" class="pw-post-body-paragraph ls lt iq lu b lv mo ka lx ly mp kd ma mb mq md me mf mr mh mi mj ms ml mm mn ij bi translated"><a class="ae ou" href="https://fda.readthedocs.io/en/latest/auto_examples/index.html" rel="noopener ugc nofollow" target="_blank">[3]https://FDA . readthe docs . io/en/latest/auto _ examples/index . html</a></p></div></div>    
</body>
</html>