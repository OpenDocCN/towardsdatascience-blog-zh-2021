<html>
<head>
<title>Solve linear programming in Python with FICO Xpress</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 FICO Xpress 在 Python 中求解线性规划</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/solve-linear-programming-in-python-with-fico-xpress-599f204fb34a?source=collection_archive---------13-----------------------#2021-12-05">https://towardsdatascience.com/solve-linear-programming-in-python-with-fico-xpress-599f204fb34a?source=collection_archive---------13-----------------------#2021-12-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="29c3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么我们有 LP？因为我们希望利用手头的资源每次都做到最好</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/27f7e940bd2670d9e3f9e7e48b42a043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KgpT6FJJrWNjMFJX"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安妮·斯普拉特在<a class="ae ky" href="https://unsplash.com/s/photos/resources?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="361d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="62a5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数学优化是应用数学的一个分支。拥有这个分支的最简单的原因是我们需要在标准下找到最优解。在现实生活中，这个最优解往往是利润最大化或成本最小化。标准涉及限制当前情况的有限资源和约束。给定这些标准，我们应该做什么来实现最佳解决方案？我们使用公式和不等式来描述情况，并定义一个函数来衡量结果。这样就建立了一个数学模型。</p><p id="465d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数学优化的一个特例是线性规划(LP)。“线性”表示数学模型中的所有公式都是线性形式，即没有平方函数、平方根函数等。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="edb2" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">例子</h1><p id="da67" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一家公司使用两种原材料生产两种油漆，一种用于室内，一种用于室外。下表显示了每种原材料中每种油漆的成分，以及每种原材料每天的供应情况。两种油漆的利润也列了出来。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/a2833eeb5f6ff845116eb3a9513c95a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*i2iHIVwkxmG1vx_CJoYhaA.png"/></div></figure><p id="e6bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">而且因为市场的原因，每天室内涂料的需求量不能超过室外涂料 1 吨以上。该公司还知道，室内涂料的最大需求量是每天 2 吨。</p><p id="fe30" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">问题是，在所有这些限制下，我们如何能使利润最大化。因此，我们需要知道每天生产多少吨室外涂料和室内涂料。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="796e" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">LP 中的 4 个常见要求</h1><p id="0dbc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于每个 LP 问题，有 4 个共同的要求。下面我将使用上面的例子展示所有 4 个。</p><ol class=""><li id="3e9a" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated">如前所述，LP 问题寻求实现最优解，最大化或最小化某个数量，也就是<strong class="lt iu">目标函数。</strong>在示例中，我们希望实现利润最大化。换句话说，我们想知道外部和内部油漆的日产量，以便 5*(外部油漆的日产量，以吨计)+ 4*(内部油漆的日产量，以吨计)最大化。如果我们将 X1 定义为室外油漆的日产量(以吨计),将 X2 定义为室内油漆的日产量(以吨计),那么目标函数就是 5X1+4X2，我们希望最大化这个函数。</li><li id="f531" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">必须有一个或多个约束来限制追求目标的程度。我们称之为<strong class="lt iu">约束</strong>。在这个例子中，有四个约束。第一个和第二个是原材料 M1 和 M2 的最大日供应量。第三个是内外墙涂料的市场界限。最后一个是室内涂料的最大需求。我们可以将这些限制转化为不平等。</li><li id="1322" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">在 LP 问题中，必须有可供选择的行动方案。这意味着我们可以选择任何可变结果的组合来获得最优解。在这个例子中，没有限制生产室外或室内油漆需要多少吨 M1 或 M2。</li><li id="5055" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">目标和约束必须用线性方程或不等式来表示。在上面的例子中，它们都是线性的。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c473f3aa334f9fac650b0dcd87e9e792.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*ewmJqihd9AlH4GytkGbxEg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">4 个限制因素</p></figure><p id="da0c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在大多数 LP 问题中，也有一个常见的假设，即变量不能是负的。这个假设甚至经常被认为是 LP 问题的第五个要求。在这个例子中，我们还将两个变量限制为非负。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="f930" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">用 FICO Xpress 求解线性规划</h1><p id="d3aa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们在 python 中需要做的事情和我们刚刚做的事情类似。我们首先定义变量。然后我们定义目标函数和这 4 个约束。最后，我们请求 Xpress 解决 LP 问题并提供解决方案。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="0b44" class="nz la it nv b gy oa ob l oc od">import xpress as xp</span></pre><p id="c3cd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">FICO Xpress 提供了一个社区许可证，对于这个演示来说已经足够了。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="669c" class="nz la it nv b gy oa ob l oc od"># Define the LP problem<br/>model = xp.problem(name='Paints')</span></pre><p id="af50" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这一步创建了一个名为<strong class="lt iu"> Paints </strong>的空问题。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="45e7" class="nz la it nv b gy oa ob l oc od"># Define variables<br/>x1 = xp.var(name='exterior')<br/>x2 = xp.var(name='interior')<br/>model.addVariable(x1,x2)</span></pre><p id="8479" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在帮助文档中，<code class="fe oe of og nv b">var</code>有多个参数，如下所示</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="1000" class="nz la it nv b gy oa ob l oc od">xpress.var(name='', lb=0, ub=xpress.infinity, threshold=-xpress.infinity, vartype=xpress.continuous)</span></pre><p id="3886" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以为每个变量指定一个名称，以便清楚地展示。<code class="fe oe of og nv b">lb</code>和<code class="fe oe of og nv b">ub</code>用于设定下限和上限。如前所述，非负性经常需要 Xpress 将缺省值<code class="fe oe of og nv b">lb</code>指定为 0。另一个重要的论点是<code class="fe oe of og nv b">vartype</code>。这可以进一步将变量限制为不同的变量类型，包括二进制、整数等。此<a class="ae ky" href="https://www.fico.com/fico-xpress-optimization/docs/latest/solver/optimizer/python/HTML/chModeling_sec_secModelingVar.html" rel="noopener ugc nofollow" target="_blank">链接</a>进一步解释了<code class="fe oe of og nv b">var</code> Xpress 类型。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="3e33" class="nz la it nv b gy oa ob l oc od"># Define constraints <br/>constr1 = 6*x1+ 4*x2 &lt;= 24<br/>constr2 = x1+x2 &lt;=6 <br/>constr3 = x2-x1 &lt;=1 <br/>constr4 = x2&lt;=2</span></pre><p id="44d4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们可以直接构建这 4 个约束。你所需要做的就是像在公式表单中那样键入它们。每个变量的类型都是<code class="fe oe of og nv b">xpress.constraint</code>。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="b9f7" class="nz la it nv b gy oa ob l oc od">xpress.constraint (constraint=None, body=None, lb=-xpress.infinity, ub=xpress.infinity, sense=None, rhs=None, name='')</span></pre><p id="38a0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在上面，我们包括了约束的完整形式。另一种方法是把它分解成<code class="fe oe of og nv b">body</code>、<code class="fe oe of og nv b">lb</code>、<code class="fe oe of og nv b">ub</code>。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="1f61" class="nz la it nv b gy oa ob l oc od"># Same as constr1<br/>xp.constraint(body = 6*x1+ 4*x2,ub = 24)</span></pre><p id="d428" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们定义了所有的约束，我们就可以将所有的变量和约束输入到模型中。您可以逐个添加约束，也可以使用约束列表/元组/数组一起输入它们。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="f521" class="nz la it nv b gy oa ob l oc od">problem.addVariable(v1, v2, ...)<br/><br/>Argument:<br/>v1,v2...: <br/><br/>  Variables or list/tuples/array of variables created with the<br/>  xpress.var constructor or the<br/>  xpress.vars function.b</span><span id="a034" class="nz la it nv b gy oh ob l oc od">problem.addConstraint(c1, c2, ...)<br/><br/>Argument:<br/>c1,c2...: <br/><br/>  Constraints or list/tuples/array of constraints created with the xpress.constraint() call.</span></pre><p id="065c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以我们现在将它们添加到模型中。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="4c30" class="nz la it nv b gy oa ob l oc od"># Add variables<br/>model.addVariable([x1,x2])</span><span id="cdd9" class="nz la it nv b gy oh ob l oc od"># Add constraints <br/>model.addConstraint([constr1,constr2,constr3,constr4])</span></pre><p id="da30" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后一部分是目标函数。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="bc82" class="nz la it nv b gy oa ob l oc od">model.setObjective(5*x1+4*x2,sense=xp.maximize)</span></pre><p id="893b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以看到<code class="fe oe of og nv b">setObjective</code>只有两个参数。一个是<code class="fe oe of og nv b">expr</code>，一个是<code class="fe oe of og nv b">sense.</code></p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="abf7" class="nz la it nv b gy oa ob l oc od">problem.setObjective(expr, sense=xpress.minimize)<br/><br/>Arguments:<br/>expr: <br/> A linear or quadratic function of the variables<br/>that were added to the problem prior to this call. An error will be<br/>returned if any variable in the linear or quadratic part of the<br/>objective was not added to the problem via<br/>addVariable.<br/>sense: <br/> Either xpress.minimize or xpress.maximize.</span></pre><p id="3803" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe oe of og nv b">sense</code>用来定义我们是否要最大化或最小化目标函数。</p><p id="9099" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后可以请 Xpress 来求解模型。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="5344" class="nz la it nv b gy oa ob l oc od">model.solve()</span><span id="526d" class="nz la it nv b gy oh ob l oc od">FICO Xpress v8.13.1, Community, solve started 18:15:59, Dec 5, 2021<br/>Heap usage: 331KB (peak 331KB, 285KB system)<br/>Maximizing LP Paints using up to 4 threads, with these control settings:<br/>OUTPUTLOG = 1<br/>Original problem has:<br/>         4 rows            2 cols            7 elements<br/>Presolved problem has:<br/>         3 rows            2 cols            6 elements<br/>Presolve finished in 0 seconds<br/>Heap usage: 332KB (peak 344KB, 287KB system)<br/><br/>Coefficient range                    original                 solved        <br/>  Coefficients   [min,max] : [ 1.00e+00,  6.00e+00] / [ 5.00e-01,  1.50e+00]<br/>  RHS and bounds [min,max] : [ 1.00e+00,  2.40e+01] / [ 1.00e+00,  6.00e+00]<br/>  Objective      [min,max] : [ 4.00e+00,  5.00e+00] / [ 4.00e+00,  5.00e+00]<br/>Autoscaling applied standard scaling<br/><br/> <br/>   Its         Obj Value      S   Ninf  Nneg   Sum Dual Inf  Time<br/>     0         28.000053      D      2     0        .000000     0<br/>     2         21.000000      D      0     0        .000000     0<br/>Uncrunching matrix<br/>Optimal solution found<br/>Dual solved problem<br/>  2 simplex iterations in 0.00 seconds at time 0<br/><br/>Final objective                       : 2.100000000000000e+01<br/>  Max primal violation      (abs/rel) :       0.0 /       0.0<br/>  Max dual violation        (abs/rel) :       0.0 /       0.0<br/>  Max complementarity viol. (abs/rel) :       0.0 /       0.0</span></pre><p id="a8ce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">发现 obj 值= 21 的最优解！</strong></p><p id="5572" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以我们可以看到最优解。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="c078" class="nz la it nv b gy oa ob l oc od">model.getSolution()<br/>[3.0, 1.5]</span></pre><p id="8da0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以我们每天应该生产 3 吨外部油漆和 1.5 吨内部油漆。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="1a27" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">结论</h1><p id="43f0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">线性规划常用于资源分配，求解线性规划的方法很多。在这里我向你展示使用 Python 来解决。希望你喜欢这篇文章，下次再见。</p></div></div>    
</body>
</html>