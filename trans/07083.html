<html>
<head>
<title>11 Essential Tricks To Demystify Dates in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">揭开熊猫约会神秘面纱的11个基本技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/11-essential-tricks-to-demystify-dates-in-pandas-8644ec591cf1?source=collection_archive---------19-----------------------#2021-06-27">https://towardsdatascience.com/11-essential-tricks-to-demystify-dates-in-pandas-8644ec591cf1?source=collection_archive---------19-----------------------#2021-06-27</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="982d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用Python简化日期处理的简易指南，包括csv文件内外。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/63e5edc9e61217b701471c98837e1013.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5JVGFzHyG9xisnSz"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">双关:p .照片由<a class="ae kz" href="https://unsplash.com/@etvoilaraissa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Raissa Lara Lütolf (-Fasel) </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ccd2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">管理日期时间特性在几乎所有的数据科学中都很常见。幸运的是，熊猫通过无数有用的功能广泛地支持它。</p><p id="53f5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在从我们的csv文件导入数据时解析和驯服日期列是一项有趣而又令人畏惧的任务，我打算在一个简单易懂的教程中向您介绍这个解决方案。</p><p id="cec7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">那就别磨蹭了。我们开始吧👇</p><h1 id="4edd" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">日期格式基础</h1><p id="ebe8" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">日期和时间的表示法是国际标准中被表示为<strong class="lc iv"><em class="mt"/></strong>格式的ISO 8601。在这里，日期，例如2021年12月25日，将被写成:<code class="fe mu mv mw mx b">“2021–12–25”</code>。</p><p id="d4ce" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一般来说，用pandas解析日期列的最简单和最普通的方法是在读取文件时通过<strong class="lc iv">指定它。</strong></p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="c074" class="nc lx iu mx b gz nd ne l nf ng">df = pd.read_csv('sample_data.csv')<br/>df.head()</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nh"><img src="../Images/3bc4273c12f7fa102f75bbf7f713ed7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*xdFkWKQZYq2vaXBVeNXgpQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">样本数据的前五行</p></figure><p id="9bc2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用默认的<code class="fe mu mv mw mx b">read_csv()</code>函数将<strong class="lc iv"> <em class="mt">日期</em> </strong>列读取为<strong class="lc iv">对象</strong>数据类型:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ni"><img src="../Images/955a1466d306b4c38aa60246dda59b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JBtiCDdaMHfQ4_I6cR8Hpg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">日期的对象数据类型，不是我们想要的，是吗？</p></figure><p id="5d1a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">指定<code class="fe mu mv mw mx b"><strong class="lc iv">parse_dates</strong></code>参数有助于我们对所需的列进行日期解析:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="f5d5" class="nc lx iu mx b gz nd ne l nf ng">df = pd.read_csv('sample_data.csv', parse_dates=['date'])</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nj"><img src="../Images/67850ff2f42e7d1dffb2b60f4f6862cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1p_lQeIUz265xfV3JRiJAw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">解析日期！</p></figure><p id="a9f3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们感受一下日期是如何被解析的，好吗？</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nk"><img src="../Images/aee5b8cfd4ec720c0058de32b2dbf050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*gZdVjpdRkk0lbMhbnaiAAg.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">看看现在ISO格式的日期！</p></figure><p id="5602" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这是非常方便的！</p><p id="dce3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是直接这么做也有不好的一面。</p><p id="cc63" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">请记住，只有当日期已经以ISO格式显示时，这才有效，</strong></p><p id="58e1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">或</strong></p><p id="159f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">如果日期格式为:年/月/日或年/月/日。</strong></p><p id="fc94" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然而，在某个特定国家以外的地方，情况并不总是如此。因此，我们在这里需要更加小心。</p><p id="2f98" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们继续下一节，了解更多其他情况。</p><h1 id="4ae5" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">用指定格式解析日期</h1><p id="c914" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">大多数时候，我们从数据中导入的日期与熊猫的首选格式有很大不同。所以我们强制它在解析日期列时遵守一个规则。</p><p id="915a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">首先导入数据:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nl"><img src="../Images/f34805e2489454a21c3e4523f8526fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zt45bz5O59IPTuuaZMPJ0w.png"/></div></div></figure><p id="2fe5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后，给出您知道的数据格式:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nm"><img src="../Images/f1b75c743d65d83668f81f1ce162c4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oyV8H1hLgrkHI2fSB98XFQ.png"/></div></div></figure><p id="9ea0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这里，我指定了格式:<code class="fe mu mv mw mx b"> “%d/%m/%Y”</code>，因为我知道文件中的日期是这种格式。<code class="fe mu mv mw mx b">“%m/%d/%Y”</code>月初将去，以此类推。</p><p id="101d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以在Python网站的这里阅读所有类型的格式符号<a class="ae kz" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="7b00" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">使用dayfirst符号快捷方式</h1><p id="ffb7" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我认为这是一种捷径，因为它是前一种方法的简化版本。</p><p id="077d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果我们想让熊猫先考虑<strong class="lc iv">天而不是</strong>，我们可以将参数<code class="fe mu mv mw mx b">dayfirst</code>设置为<code class="fe mu mv mw mx b">True</code>。这通常在那个国家之外是有效的，但是确保首先检查你的数据。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nn"><img src="../Images/968013e36bcd04559c08606142c8a2ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdZcl47zzcItEvRod08BwQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">世界其他地方的dayfirst通常是正确的。</p></figure><h1 id="1872" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">使用日期作为更好的选择、聚合和分组的索引</h1><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="cc2e" class="nc lx iu mx b gz nd ne l nf ng">df = df.set_index(['date'])</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj no"><img src="../Images/0584c57642b789357d3549af60361da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qA1cgxOQrS9r9T5teOeejQ.png"/></div></div></figure><h2 id="304e" class="nc lx iu bd ly np nq dn mc nr ns dp mg lj nt nu mi ln nv nw mk lr nx ny mm nz bi translated">从今以后，选择一个日期范围将会非常方便。</h2><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="bbfe" class="nc lx iu mx b gz nd ne l nf ng">df.loc[start_date:end_date]</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/bbc0daf9101c6bc225fd6ba52092f79b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QGXGevNVYNpFsTcTVfJFTQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">通过索引选择日期比使用列更容易</p></figure><p id="601a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">比较函数也以同样的方式运行:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="93f1" class="nc lx iu mx b gz nd ne l nf ng">df.loc[df.index &lt; '03-05-2019']</span></pre><p id="edc9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">选择一年并获取汇总:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="b910" class="nc lx iu mx b gz nd ne l nf ng">df.loc['2019'].sum()</span></pre><p id="d970" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您的索引没有排序，请使用以下方法进行排序:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="0272" class="nc lx iu mx b gz nd ne l nf ng">df.sort_index()</span></pre><p id="6e7f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">诸如此类。应用函数的可能性只和你的想象力一样有限(当然还有熊猫文档:)！</p><h1 id="d337" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">分解日期，反之亦然</h1><p id="40f0" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">到目前为止，我们已经看到了如何使用日期来选择行，将它们用作索引，并以特定的格式解析它。现在，我们可以看到如何从一个日期以及相反的日期获得年、月和日的信息。</p><p id="01a1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">例如，</strong>如果你有这样一个数据:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="b1fe" class="nc lx iu mx b gz nd ne l nf ng">    year month day</span><span id="b226" class="nc lx iu mx b gz ob ne l nf ng">0<!-- -->   <!-- -->2019<!-- -->    <!-- -->1<!-- -->   <!-- -->1</span><span id="e14b" class="nc lx iu mx b gz ob ne l nf ng">1<!-- -->   <!-- -->2019<!-- -->    <!-- -->1<!-- -->   <!-- -->2</span><span id="578e" class="nc lx iu mx b gz ob ne l nf ng">2<!-- -->   <!-- -->2019<!-- -->    <!-- -->1<!-- -->   <!-- -->3</span></pre><p id="830c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以轻松地将这三列合并为一列:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="f967" class="nc lx iu mx b gz nd ne l nf ng">df = pd.read_csv('sample_data.csv', parse_dates= {"date" : ["year","month","day"]}, keep_date_col=True)</span></pre><p id="6873" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">其中，年、月和日是文件中单独的列名。如果您想要一个自定义名称，而不仅仅是'<em class="mt"> date </em>'，您可以在这里指定它。</p><p id="1012" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">因此，作为反例</strong>，如果我们想获得<em class="mt">日、月、年</em>的单独列，我们可以这样做:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="e9d3" class="nc lx iu mx b gz nd ne l nf ng">df['year']= df['date'].dt.year<br/>df['month']= df['date'].dt.month<br/>df['day']= df['date'].dt.day</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oc"><img src="../Images/a90329e6c351ee16581b3f6eb619ce16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tB4cNxIZdLSl-ej_zURpA.png"/></div></div></figure><h1 id="2c2b" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">使用日期范围</h1><p id="2eff" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">通常，您需要生成一组新的日期，以便以后制作系列或数据帧。使用<code class="fe mu mv mw mx b"><strong class="lc iv">pd.date_range()</strong></code>功能可以轻松实现:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj od"><img src="../Images/d1626e1080e33997c63cc46dbc774977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VvXVWB5LD3CiiHXhX0TLUQ.png"/></div></div></figure><p id="2cae" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您还可以指定<strong class="lc iv">周期</strong>，这意味着要生成的实例数量以及生成日期的<strong class="lc iv">频率</strong>。</p><p id="b31f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">举个例子，</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="9a31" class="nc lx iu mx b gz nd ne l nf ng">pd.date_range(start='1/1/2019', end='2/01/2019', freq='W')</span></pre><p id="463b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">将生成从开始日期到结束日期的每周日期:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oe"><img src="../Images/1ad86e74df4db5c021e08b4a298b3ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WINylckGhOUYcsnnjFsww.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">每周日期生成</p></figure><h1 id="6408" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">进行日期偏移</h1><p id="8db0" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">你曾经需要给日期加上或减去几周/几天/几个月来得到新的日期吗？</p><p id="0cf2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">嗯，熊猫也有这样的功能。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj of"><img src="../Images/c6646e3722a56dd0eb2ffded94760531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2SNsvzTivXQibYbBV4GqQ.png"/></div></div></figure><p id="75e5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你也可以在那里使用<strong class="lc iv">天、周或年</strong>，还有许多其他的。完整列表见文档。</p><h1 id="df12" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">日期转换</h1><p id="4ff4" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">您可能希望<em class="mt">移动</em>或<em class="mt">滞后</em>时间序列中的值。这个用例的功能是<code class="fe mu mv mw mx b"><strong class="lc iv">shift()</strong></code>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nl"><img src="../Images/591fd143984388d75862c987ec2d7ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P00Z161qvI-Ji9AcfbkP0w.png"/></div></div></figure><p id="7ab5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以看到，正如我们所希望的那样，日期推迟了两周。</p><p id="6275" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以很好地结合使用<strong class="lc iv">偏移</strong>和<strong class="lc iv">移位</strong>函数，用你的时间序列做一些巧妙的事情！</p><h1 id="eb22" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">日期重采样</h1><p id="4261" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">数据科学中最重要的数据操作之一是不同日期频率之间的转换。</p><p id="5a49" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">让我们举一个例子。</strong>假设我们有一个商店的<em class="mt">日期索引</em><strong class="lc iv"><em class="mt"/></strong>日销售额的时间序列数据:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="094e" class="nc lx iu mx b gz nd ne l nf ng">range = pd.date_range("1/1/2019", periods=28, freq="D")</span><span id="d096" class="nc lx iu mx b gz ob ne l nf ng">df = pd.Series(np.random.randint(0, 500, len(range)), index=range)</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj og"><img src="../Images/9927e0b283f4c1a0949bf538c39627ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SZYrJIr2SFMus3keNTsyjQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">我们的日常时间序列是这样的！</p></figure><p id="b42e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，我们想对此进行重新采样，以获得每周的总销售数据。这可以通过<strong class="lc iv">重采样</strong>功能轻松实现。</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="2d64" class="nc lx iu mx b gz nd ne l nf ng">df.resample('W').sum()</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oh"><img src="../Images/0bdd68641e28b3e4dccd687748857084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4HERg1nP69wBKIo_zuNhfQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">重新取样为每周</p></figure><p id="64d0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们已经成功地将每日数据转换为每周数据！</p><p id="850e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是，请注意它是如何通过将一周的第一天作为周日来自动重新采样的？您可能希望今天是<strong class="lc iv">星期一</strong>(这在大多数真实世界的数据中是正常的)，所以执行这个小修正:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="90ce" class="nc lx iu mx b gz nd ne l nf ng">df.resample('W-MON').sum()</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oi"><img src="../Images/0f3d0aea0954b54874bf0e76ae44b0ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvshwVjC1HgQ3_9ebiVsdQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">以星期一为一周的开始！</p></figure><p id="7ff2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">类似地，你也可以根据需要使用一周中的其他日子——W-TUE、W-星期五等等。</p><p id="35de" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">唷。有太多要理解的了。</p><p id="f0b6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我希望你仍然和我在一起。:)我保证我们快到终点了。</p><h1 id="2e77" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">寻找丢失的日期</h1><p id="7881" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">通常，我们需要在表中找到缺失的数据行。即使对于日期索引，这也很简单:</p><p id="3496" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果我们的数据帧看起来像这样:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj oj"><img src="../Images/fe9c1a7958fbb54e20e6490f57c4a9a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*lj-OK95B-6kLm14DTWszKg.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">正常df</p></figure><p id="65a4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们可以像这样搜索丢失的日期:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="72da" class="nc lx iu mx b gz nd ne l nf ng">missing_dates = df.index[~df.index.isin(range)]<br/>missing_dates</span></pre><p id="3476" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">其中，我们的<strong class="lc iv">范围</strong> =开始日期和结束日期之间的索引的日期范围。例如，它可以这样定义，考虑到您的数据在您自己的用例中的表现:</p><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="15f1" class="nc lx iu mx b gz nd ne l nf ng">range = pd.date_range("1/4/2019", "4/1/2019", freq="W")</span></pre><h1 id="ad2a" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">最后——找到最近的日期</h1><pre class="kk kl km kn gu my mx mz na aw nb bi"><span id="ac59" class="nc lx iu mx b gz nd ne l nf ng">df.index.get_loc(dt, method=“nearest”)</span></pre><p id="e5b8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">它返回最近日期的索引号到<strong class="lc iv"> dt: </strong></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ok"><img src="../Images/0a3f589090ae18c7ddbd11ede5ceee41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bz7uHxGEOACNtK-Sw0vScg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">离“dt”最近的日期</p></figure><p id="2840" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你也可以这样得到确切的日期:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ol"><img src="../Images/7b02620841c76789b456c0c350635a4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EOXrxpIMVyIBl84eCD5N4g.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">返回准确的最近日期</p></figure><h1 id="28ae" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">结束…</h1><p id="8077" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">这些是熊猫的日期/时间序列操作，我总是觉得有用，并在工作中不断查找。我希望这篇文章对你也有用。</p><blockquote class="om on oo"><p id="8ebf" class="la lb mt lc b ld le jv lf lg lh jy li op lk ll lm oq lo lp lq or ls lt lu lv in bi translated">你可以把它作为参考，或者像我一样，作为处理熊猫日期的一个小备忘单。</p></blockquote><p id="2c8a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">接下来，这里是了解熊猫日期时间功能的最佳来源。这是最全面的指南，也是最好的，因为它直接来自原始资料。</p></div><div class="ab cl os ot hy ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="in io ip iq ir"><p id="993d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我每周都写关于数据科学的文章，并努力让我的读者也觉得有趣！<a class="ae kz" href="https://medium.com/@ipom" rel="noopener">在Medium上关注我</a>,在你的feed中直接获得新文章。:)</p><p id="1d6f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mt">或者更好的是，你还可以订阅</em> <a class="ae kz" href="https://yashprakash.substack.com" rel="noopener ugc nofollow" target="_blank"> <em class="mt">我的每月/双周简讯</em> </a> <em class="mt">让自己随时掌握最新动态！</em></p><p id="03aa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本文中的代码都打包在一个Jupyter笔记本中。这里是我所有文章的代码和资源。快乐学习！⭐️</p></div><div class="ab cl os ot hy ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="in io ip iq ir"><p id="a008" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我的其他文章也可能对你有用:</p><div class="oz pa gq gs pb pc"><a rel="noopener follow" target="_blank" href="/26-datasets-for-your-data-science-projects-658601590a4c"><div class="pd ab fp"><div class="pe ab pf cl cj pg"><h2 class="bd iv gz z fq ph fs ft pi fv fx it bi translated">为您的数据科学项目提供26个数据集</h2><div class="pj l"><h3 class="bd b gz z fq ph fs ft pi fv fx dk translated">众多基于任务的数据集的汇编，可用于构建您的下一个数据科学项目。</h3></div><div class="pk l"><p class="bd b dl z fq ph fs ft pi fv fx dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq kt pc"/></div></div></a></div><div class="oz pa gq gs pb pc"><a rel="noopener follow" target="_blank" href="/how-to-use-bash-to-automate-the-boring-stuff-for-data-science-d447cd23fffe"><div class="pd ab fp"><div class="pe ab pf cl cj pg"><h2 class="bd iv gz z fq ph fs ft pi fv fx it bi translated">如何使用Bash来自动化数据科学的枯燥工作</h2><div class="pj l"><h3 class="bd b gz z fq ph fs ft pi fv fx dk translated">使用命令行为您的数据科学项目编写一些可重用代码的指南</h3></div><div class="pk l"><p class="bd b dl z fq ph fs ft pi fv fx dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pr l pn po pp pl pq kt pc"/></div></div></a></div></div></div>    
</body>
</html>