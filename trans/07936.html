<html>
<head>
<title>Have a SQL Interview Coming Up? Ace It Using Google Colab!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有SQL面试吗？使用谷歌Colab！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/have-a-sql-interview-coming-up-ace-it-using-google-colab-6d3c0ffb29dc?source=collection_archive---------8-----------------------#2021-07-21">https://towardsdatascience.com/have-a-sql-interview-coming-up-ace-it-using-google-colab-6d3c0ffb29dc?source=collection_archive---------8-----------------------#2021-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7fbf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">只需2个辅助函数，即可在Google Colab中设置和运行SQL！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8ba64a83aed07fdfde1825543bd9c507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*31jlrdyWxf3nyS2L"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4c97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如今，编码测试几乎是数据科学面试过程中的标准。作为一名数据科学招聘经理，我发现一个20-30分钟的现场编码测试，加上一些准备好的任务，可以有效地识别出能够成功胜任我通常招聘的职位的候选人。</p><p id="0c3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google Colab [ <a class="ae ky" href="https://colab.research.google.com/notebooks/intro.ipynb?utm_source=scs-index" rel="noopener ugc nofollow" target="_blank">链接</a> ]由于其熟悉的笔记本环境和方便的分享选项，是各种离线和现场数据科学编码面试的优秀工具。但是Colab很大程度上局限于Python(和一些黑客的R)。</p><p id="1c2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以我个人的经验，SQL是成为一名成功的数据科学家的重要技能。深度学习很棒，但是如果你不能编写SQL查询，你可能会永远停留在你的猫和狗的分类器上😜(如果你想学习如何做，可以查看这个<a class="ae ky" rel="noopener" target="_blank" href="/how-to-choose-the-best-keras-pre-trained-model-for-image-classification-b850ca4428d4">链接</a>)。</p><p id="5b91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我开始寻找进行实时SQL编码测试的方法，瞧！我偶然发现了这种在Colab(或任何Python环境)中运行SQL的简单方法，只需要两个助手函数。</p><p id="322c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将介绍我们可以用来在Google Colab中设置和运行SQL的两个Python函数，具体来说就是:</p><ol class=""><li id="4f6a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">创建一个数据库，并上传一个熊猫数据帧到谷歌Colab的数据库表中</li><li id="5384" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在Google Colab中对数据库和表编写和执行SQL查询。</li></ol><p id="659d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有代码都可以在我的<a class="ae ky" href="https://gist.github.com/stephenleo/492469c191d56a53ace718e9d6d443f1" rel="noopener ugc nofollow" target="_blank"> Github账户</a>上获得。也可以直接在Google Colab上打开代码(下次面试不要多此一举了😎)点击此链接:[ <a class="ae ky" href="https://colab.research.google.com/github/stephenleo/medium-python-hacks/blob/main/02_sql_on_colab/main.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a></p><div class="mj mk gp gr ml mm"><a href="https://colab.research.google.com/github/stephenleo/medium-python-hacks/blob/main/02_sql_on_colab/main.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">谷歌联合实验室</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">编辑描述</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">colab.research.google.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ks mm"/></div></div></a></div><h1 id="2edd" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">SQLite</h1><blockquote class="nt"><p id="6165" class="nu nv it bd nw nx ny nz oa ob oc lu dk translated">需要是i̶n̶v̶e̶n̶t̶i̶o̶n̶发现之母</p></blockquote><p id="9406" class="pw-post-body-paragraph kz la it lb b lc od ju le lf oe jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">当我对SQLite有了更多的了解后，我的灵光一现。剩下的就是简单的Python编码来创建2个辅助函数。在这次搜索之前，我只是模糊地听说过SQLite，但从未需要更深入地研究它。根据SQLite官方网页[ <a class="ae ky" href="https://www.sqlite.org/index.html" rel="noopener ugc nofollow" target="_blank">链接</a> ]</p><blockquote class="oi oj ok"><p id="8111" class="kz la ol lb b lc ld ju le lf lg jx lh om lj lk ll on ln lo lp oo lr ls lt lu im bi translated">SQLite…实现了一个<a class="ae ky" href="https://www.sqlite.org/footprint.html" rel="noopener ugc nofollow" target="_blank">小</a>，<a class="ae ky" href="https://www.sqlite.org/fasterthanfs.html" rel="noopener ugc nofollow" target="_blank">快</a>，<a class="ae ky" href="https://www.sqlite.org/selfcontained.html" rel="noopener ugc nofollow" target="_blank">完备</a>，<a class="ae ky" href="https://www.sqlite.org/hirely.html" rel="noopener ugc nofollow" target="_blank">高可靠</a>，<a class="ae ky" href="https://www.sqlite.org/fullsql.html" rel="noopener ugc nofollow" target="_blank">全功能</a>，SQL数据库引擎。SQLite是世界上最常用的数据库引擎。SQLite内置于所有手机和大多数计算机中，并捆绑在人们每天使用的无数其他应用程序中。</p></blockquote><p id="0196" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">听起来很有希望！SQLite的工作原理是创建一个本地<code class="fe op oq or os b">.db</code>文件，我们可以像连接一个普通的SQL数据库一样连接它。然后，我们可以在这个<code class="fe op oq or os b">.db</code>文件上创建表格、上传数据和查询数据。很简单！</p><p id="1db1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实证明，创建SQLite并与之交互的Python模块(<code class="fe op oq or os b">sqlite3</code>)是Python标准库的一部分。所以它在Colab上开箱即用。多方便啊！</p><p id="ef9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们导入<code class="fe op oq or os b">sqlite3</code>和<code class="fe op oq or os b">pandas</code>模块，这是我们任务的唯一需求</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入需求</p></figure><h2 id="2543" class="ov nc it bd nd ow ox dn nh oy oz dp nl li pa pb nn lm pc pd np lq pe pf nr pg bi translated">功能1: Pandas数据帧到SQL数据库表</h2><p id="dd3e" class="pw-post-body-paragraph kz la it lb b lc ph ju le lf pi jx lh li pj lk ll lm pk lo lp lq pl ls lt lu im bi translated">我们的第一个任务是创建一个数据库，并将熊猫数据帧上传到数据库中的一个表中。</p><p id="625a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码将它实现为一个函数，我将一步一步地介绍它。该函数将一个<code class="fe op oq or os b">input_df</code>数据帧、<code class="fe op oq or os b">table_name</code>和<code class="fe op oq or os b">db_name</code> ( <code class="fe op oq or os b">.db</code>文件名)作为输入，并运行以下步骤。</p><ol class=""><li id="2120" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">设置一些日志来跟踪函数的执行</li><li id="0a19" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">找到数据框中的所有列。这是必要的，因为我们需要在创建表和向表上传数据时提供这些信息。</li><li id="4e3f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如果存在，连接到一个<code class="fe op oq or os b">.db</code>文件。如果该文件不存在，请在本地创建一个新文件。</li><li id="329a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在我们在上一步中连接到(或刚刚创建)的<code class="fe op oq or os b">.db</code>文件中创建一个表</li><li id="3c44" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将数据行从<code class="fe op oq or os b">input_df</code>上传到我们在上一步刚刚创建的表中</li><li id="a50a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">提交更改并关闭与数据库的连接</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">功能1:创建一个数据库，并上传一个熊猫数据帧到数据库中的一个表中</p></figure><h2 id="237a" class="ov nc it bd nd ow ox dn nh oy oz dp nl li pa pb nn lm pc pd np lq pe pf nr pg bi translated">功能2:对熊猫数据框架的SQL查询</h2><p id="8fe3" class="pw-post-body-paragraph kz la it lb b lc ph ju le lf pi jx lh li pj lk ll lm pk lo lp lq pl ls lt lu im bi translated">我们的第二个任务是在第一个任务中创建的数据库和表上编写和执行SQL查询。</p><p id="c844" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码将它实现为另一个函数，我也将一步一步地介绍这个函数。该函数将一个<code class="fe op oq or os b">sql_query_string</code>和<code class="fe op oq or os b">db_name</code> ( <code class="fe op oq or os b">.db</code>文件)作为输入，运行以下步骤，并返回一个熊猫数据帧作为输出。</p><ol class=""><li id="8907" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">连接到<code class="fe op oq or os b">.db</code>文件中的SQL DB</li><li id="06f9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">执行<code class="fe op oq or os b">sql_query_string</code>中的SQL查询</li><li id="ee6d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">运行SQL查询后，获取结果数据和输出的列名</li><li id="def8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">关闭与数据库的连接</li><li id="6996" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">以熊猫数据帧的形式返回结果</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">功能2:在数据库和表上编写和执行SQL查询</p></figure><p id="9ca2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">差不多就是这样！我们现在有两个功能，可以粘贴到任何Colab笔记本上来解决我们的两个任务。让我们通过一个例子来看看如何使用这两个函数</p><h1 id="e195" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">使用2个函数在Colab中运行SQL</h1><p id="7a65" class="pw-post-body-paragraph kz la it lb b lc ph ju le lf pi jx lh li pj lk ll lm pk lo lp lq pl ls lt lu im bi translated">由于COVID基本上是我们这些天谈论的唯一话题，我从Kaggle [ <a class="ae ky" href="https://www.kaggle.com/gpreda/covid-world-vaccination-progress" rel="noopener ugc nofollow" target="_blank"> Link </a> ]下载了一个样本COVID19疫苗接种数据集，以测试我们的两个令人敬畏的函数。这些函数的用法非常简单，如下所示</p><ol class=""><li id="5d45" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">将下载的csv文件加载到熊猫数据框架中</li><li id="8ec1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用我们的第一个函数<code class="fe op oq or os b">pd_to_sqlDB</code>将我们在上一步中加载的数据帧上传到一个名为<code class="fe op oq or os b">default.db</code>的DB中的一个名为<code class="fe op oq or os b">country_vaccinations</code>的表中</li><li id="6a78" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在名为<code class="fe op oq or os b">sql_query_string</code>的字符串变量中编写一个SQL查询。正如您在下面的代码片段中看到的，我们可以编写任何我们能想到的复杂SQL查询。</li><li id="ab15" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用我们的第二个函数<code class="fe op oq or os b">sql_query_to_pd</code>在<code class="fe op oq or os b">default.db</code>上执行上一步的SQL查询，并将结果保存在<code class="fe op oq or os b">result_df</code>数据帧中</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试两个功能</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/d121597f6b8068c6acb3e20998a7763a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*tSrUpI_aE90EUpZpYrhWgw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“测试两个函数”代码片段的输出。图片作者。</p></figure><p id="f3e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从结果中，我们可以看到(在撰写本文时)，中国在接种疫苗的人数方面领先世界，其次是印度和美国。我们通过在Google Colab中对一个数据库执行SQL查询得到了这些结果！</p><p id="c335" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是了。你现在可以在下一次面试中展示你高超的Python和SQL知识了！此外，节省一些时间，直接使用我在本文开头链接的Google Colab笔记本，它包含了上面的函数和示例查询。</p><p id="5373" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对你有用。感谢您的阅读！</p></div></div>    
</body>
</html>