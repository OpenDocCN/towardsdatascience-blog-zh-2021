<html>
<head>
<title>How Much Do You Really Spend On Coffee?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你在咖啡上真正花了多少钱？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-much-do-you-really-spend-on-coffee-9f1edebc8ef8?source=collection_archive---------27-----------------------#2021-11-18">https://towardsdatascience.com/how-much-do-you-really-spend-on-coffee-9f1edebc8ef8?source=collection_archive---------27-----------------------#2021-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="732f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这是我的故事，关于使用数据分析和可视化来证明我丈夫是错的</h2></div><p id="81fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自从我们结婚以来，我丈夫和我就一直在为他在菲尔茨咖啡的开销争论不休。不要误解我，<a class="lb lc ep" href="https://medium.com/u/1ac5a4cdd91d?source=post_page-----9f1edebc8ef8--------------------------------" rel="noopener" target="_blank">菲尔茨咖啡</a>非常棒，但我们正在进行的辩论需要解决。为了解决这场争论，我求助于数据。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/a957833477f154d3b300cc2c0af62218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YSRxDlc3L_qtFOHA14obNg.jpeg"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure><p id="7885" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我必须通过<a class="ae lt" href="https://www.philzcoffee.com/app" rel="noopener ugc nofollow" target="_blank">菲尔兹咖啡应用</a>获取我丈夫的菲尔兹咖啡应用使用数据(当然要经过他的允许！).根据《加州消费者隐私法》<a class="ae lt" href="https://oag.ca.gov/privacy/ccpa" rel="noopener ugc nofollow" target="_blank"/>,加州人可以在使用移动应用程序时要求收集数据。请求数据后，大约需要30天才能返回带有数据集的请求。返回的数据集包含2018年5月至2021年10月的用户数据。</p><p id="3f66" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我将数据集加载到<a class="ae lt" href="https://www.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> R-studio </a>中，看看当用户通过应用程序点咖啡时，应用程序会收集什么样的信息。通过应用程序收集的信息类型包括商店位置、订单时间/日期、提货时间/日期和总交易金额。数据集还包括两个单独的税和小费列，但这些列返回0，并且税和小费值已经包含在总交易金额中。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lu"><img src="../Images/700d92f885a17bbbccdfd76f0bc28a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hh5cTCKuyy8WH7BxtHzWUw.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">原始数据集格式和列标题</p></figure><p id="fb90" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我还想使用订单时间/日期和提货时间/日期列，按商店位置分析我丈夫等待咖啡的平均时间。然而，这被证明是困难的，因为该应用程序允许将提货时间设置为未来更晚的时间。例如，可以在上午8:00下订单，在上午10:00提货。这将显示为订单时间和提货时间之间的两小时“等待时间”，并不一定反映订单的准确“等待时间”。因此，我决定从这个分析中排除这些列。</p><p id="6809" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我首先通过安装几个包来执行数据清理，包括' tidyr '，' dyplr '和' tidyverse '。</p><pre class="le lf lg lh gt lv lw lx ly aw lz bi"><span id="0fcb" class="ma mb iq lw b gy mc md l me mf">### INSTALL PACKAGES AND LOAD LIBRARIES<br/>install.packages("readr")<br/>library(readr)<br/>install.packages("tidyverse")<br/>library(tidyverse)<br/>install.packages("dplyr")<br/>library(dplyr)<br/>install.packages("tidyr")<br/>library(tidyr)</span></pre><p id="076e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我删除了与分析计划无关或为空的行，重命名了列标题以更好地描述列中的内容，并删除了任何包含缺失值的行。我还将包含数值的字符列重新格式化为数字列。</p><pre class="le lf lg lh gt lv lw lx ly aw lz bi"><span id="ffed" class="ma mb iq lw b gy mc md l me mf"># Drop row 1 through 6 and 116<br/>df &lt;- (df %&gt;% slice(-c(0:6,121)))</span><span id="ca66" class="ma mb iq lw b gy mg md l me mf"># Rename column headers<br/>colnames(df) &lt;- (c("Store", "OrderCreationDate", "ReservedPickUpTime","Status","Subtotal", "Tip", "Taxes"))</span><span id="6848" class="ma mb iq lw b gy mg md l me mf"># Drop first row with column names and relabel column headers with column names<br/>df &lt;- (df %&gt;% slice(-c(1))) </span><span id="7e6f" class="ma mb iq lw b gy mg md l me mf"># Remove rows with missing values <br/>df &lt;- na.omit(df) </span><span id="9247" class="ma mb iq lw b gy mg md l me mf"># Change variable from character to numeric<br/>df$Subtotal &lt;- as.numeric(df$Subtotal)</span></pre><p id="a14c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">出于这个项目的目的，我非常依赖于商店位置列、总支出列和订单日期列。在原始数据集中，日期和时间信息存储在一个单元格中。我将这些数据分成两个单独的列，一列是日期，另一列是时间戳。我这样做是因为出于前面提到的原因，我不会依赖时间信息来进行分析。</p><pre class="le lf lg lh gt lv lw lx ly aw lz bi"><span id="3944" class="ma mb iq lw b gy mc md l me mf"># Split date and time into two columns<br/>df$OrderCreationDate &lt;- data.frame(do.call("rbind", strsplit(as.character(df$OrderCreationDate),' ', 2)))</span></pre><p id="5b40" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我还创建了一个新列，将每个商店位置与其各自的邮政编码关联起来。这个额外的列将有助于在地理上映射商店位置，以便在地图上可视化数据。</p><p id="6aac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我将清理后的数据集放入Google Data Studio，创建一个仪表板来可视化数据。该控制面板具有向下钻取功能，允许用户按位置或日期对数据进行切片和切块。完整的交互式仪表盘可在<a class="ae lt" href="https://datastudio.google.com/u/0/reporting/b2b8bf63-c7ab-4327-963f-c09715bc1a11/page/p_ozvdr92fpc" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mh mi l"/></div><p class="lp lq gj gh gi lr ls bd b be z dk translated"><a class="ae lt" href="https://datastudio.google.com/reporting/b2b8bf63-c7ab-4327-963f-c09715bc1a11" rel="noopener ugc nofollow" target="_blank">点击此处</a>通过Google Data Studio访问完整的交互式仪表盘。Dashboard是实时的，可能不会反映这篇静态博客文章中的内容。</p></figure><p id="0796" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个项目的一个关键发现是，从2021年1月1日到2021年10月26日，我丈夫在菲尔茨咖啡消费了523.95美元。数据证实，菲尔茨库比蒂诺大街是和菲尔茨一起放松的首选地点。</p><p id="ff66" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这开始于一场关于我丈夫的Philz支出和我证明他是错的动机的辩论。而是变成了一个有趣的数据分析和可视化项目。由于他将继续成为菲尔茨的常客，我希望收集足够的数据点来建立对他未来行为的预测模型。那段未完待续…</p><p id="042b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要查看我的原始数据集、Rstudio代码和清理后的数据集，请查看我在GitHub上的<a class="ae lt" href="https://github.com/isRadata/PhilzCoffeeData" rel="noopener ugc nofollow" target="_blank"> Philz Coffee数据报告</a>。</p></div></div>    
</body>
</html>