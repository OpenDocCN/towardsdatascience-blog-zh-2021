<html>
<head>
<title>Powering Google Forms and Google Sheets Application Data with TigerGraph</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用TigerGraph支持Google Forms和Google Sheets应用程序数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/powering-google-forms-and-google-sheets-application-data-with-tigergraph-7f8784335aae?source=collection_archive---------36-----------------------#2021-07-27">https://towardsdatascience.com/powering-google-forms-and-google-sheets-application-data-with-tigergraph-7f8784335aae?source=collection_archive---------36-----------------------#2021-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0549" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用TigerGraph构建应用程序图</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9037e3e50e438509988479a2c24139cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*um16Nsdmu0ulH8Zy.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/photos/application-request-ipad-tablet-1883453/" rel="noopener ugc nofollow" target="_blank">图片来自Pixabay </a></p></figure><h1 id="b844" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">目标</h1><p id="99f9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">欢迎光临！在这篇博客中，我们将学习如何使用Google Sheets API来捕获申请数据，并将其放入TigerGraph中，以便轻松地查询和筛选申请人。随着学年的开始，我最终需要为我领导的俱乐部打开申请，虽然只有少数人会申请这些职位，但如果我有大量的申请，TigerGraph和Graph数据库可以帮助我轻松快速地找到并筛选各种职位的申请人。在这里，我们将集成Google Sheets API来从表单中获取结果，并将其插入到图形数据库中。我们开始吧！</p><h1 id="084a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第一部分:创建Google表单和Google工作表</h1><h2 id="34cf" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第一步:创建Google表单</h2><p id="cd09" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，转到https://docs.google.com/forms/的<a class="ae kv" href="https://docs.google.com/forms/" rel="noopener ugc nofollow" target="_blank"/>并创建一个包含您想要采样的适当字段的表单。对于这个例子，我将询问申请人的姓名、电子邮件、职位、技能以及申请人应该获得该职位的原因。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/7c151982f632661e4ed6f67c63084e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FAWTqOV27Zb3E14vDFQiQg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">示例Google表单</p></figure><p id="c663" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">接下来，我将用假数据填充表单。</p><h2 id="6c08" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第二步:创建Google工作表</h2><p id="f664" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果你点击表格中的“回复”标签，并按下按钮，它会带你到一个谷歌电子表格中的数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/55fe5206fa35142dd80714c905fa6ef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-GI8fGoY3WRxdQbvcZtepw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">点击“回复”,然后点击绿色按钮。</p></figure><p id="c450" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">在提示中，给电子表格起一个你喜欢的名字，然后点击“创建”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/b5f2c111dde40de553f161bf0d8dfc2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHxZvtR8P4gp_PgFiwuGOw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">重命名并按“创建”</p></figure><p id="ff52" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">该电子表格是一个动态电子表格，包含来自您的表单的结果。随着越来越多的用户申请该职位，它将继续被填充。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/52174874ad1798407edd8b3804ee64f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnbcdtzltPorSzVKTMJz1w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">带有虚假数据的实时电子表格</p></figure><p id="5ebf" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">这里最重要的部分是工作表的id。您可以从d/之后/edit之前的链接中获得此信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/3f0bda965bec1aebbadad7850be95e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*802jybTxBQ6UV_jCtdOAqQ.png"/></div></div></figure><p id="b5f0" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">上例中我的id是19 fcj-0 d056 L9 C5 ksotzuazft-mfkjcuyqoz 2 BD 8 yx 4y。稍后我们将在Python脚本中使用它。</p><blockquote class="ng nh ni"><p id="1ca5" class="lo lp nj lq b lr mx jr lt lu my ju lw nk mz lz ma nl na md me nm nb mh mi mj ij bi translated">注意:为Python脚本准备好您的电子表格ID！</p></blockquote><h1 id="9244" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第二部分:创建一个项目并启用Sheets API</h1><h2 id="3785" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第一步:创建一个谷歌云项目</h2><p id="7d14" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，你需要使用你的谷歌账户，导航到https://console.cloud.google.com/的<a class="ae kv" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank"/>。在顶部，按“选择一个项目”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/faf5508d3fc31c5e4d8c8516198282a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smeicN-R1drelKZWX4VafQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按选择一个项目</p></figure><p id="2b76" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">接下来，选择一个现有的项目(如果有的话)。如果没有，请按“新建项目”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/ec67cb544d10036fcebb3589c5d0d4bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35ep7IlMMhdP-trAh80Uvw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按“新项目”</p></figure><p id="187d" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">命名您的项目，然后按“创建”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/efcd790584fdd7ae962b84919abf5f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Di6Gmo7T5Uzdwh7V_AKR8A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">输入详细信息，然后按“创建”</p></figure><h2 id="3859" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第二步:启用Google Sheets API</h2><p id="b70a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">创建项目后，您将被导航到一个仪表板。按左上方的三行，然后选择“APIs &amp; Services”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/340e3c2ed8711bf6ff3a043d5d281353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EFT3bGMkELqgtEUrhrP1dA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">单击API和服务</p></figure><p id="20b1" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">然后，按“+启用API和服务”我们将启用Google Sheets API。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/65b3ca21c318d5d5af2fb59a46ccf6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BQImnYhkW2Pse91XtKB3zg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按启用API和服务</p></figure><p id="30f4" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">搜索“Google Sheets API”，点击第一个选项，然后按“启用”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/c7ae6ad97443acb69b5e493b4eafdf6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PRo7wPxJh9VHvWfIeLfPQg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按“启用”</p></figure><p id="1abd" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">完美！现在我们可以使用Google Sheets API了。</p><h2 id="b617" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第三步:创建您的凭证</h2><p id="1a02" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在，我们将创建凭证来使用Google Sheets API。在控制面板中，单击“凭据”并选择“创建凭据”从下拉列表中，选择“OAuth客户端ID”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/911f22b5c5f0cfb2520df076248e426a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HxmMyhHMsZtOsLSZYafCHg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">点按“凭证”，按“创建凭证”，然后按“OAuth客户端ID”</p></figure><p id="1573" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">在选项中，按“桌面应用程序”，然后命名您的应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/e202703660033b17e6dead0bf3e8f073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dOKwXc-I9VY6L6B76rN6Pw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">选取“桌面应用程序”,然后输入名称</p></figure><p id="1fbf" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">下载JSON，其中包含您的客户端ID和密码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/ffae747deb4f1d65daf3ddf270d89aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbT3IjSqRCSex0wRuPBTfQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按“下载JSON”</p></figure><p id="20f3" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">太棒了。现在，在“OAuth同意屏幕”中，确保添加您将用来访问表单的每个Google帐户的测试用户(包含表单的帐户)。</p><blockquote class="ng nh ni"><p id="aac8" class="lo lp nj lq b lr mx jr lt lu my ju lw nk mz lz ma nl na md me nm nb mh mi mj ij bi translated">注意:当我们把所有东西放在一起时，您将使用下载的JSON文件！确保它易于下载。</p></blockquote><h1 id="9652" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第三部分:准备TG云解决方案</h1><h2 id="89d8" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第一步:在TG Cloud上建立解决方案</h2><p id="b760" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">接下来，我们将准备我们的图形解决方案。为此，请前往<a class="ae kv" href="https://tgcloud.io/" rel="noopener ugc nofollow" target="_blank">https://tgcloud.io/</a>。导航至“我的解决方案”选项卡，然后单击“创建解决方案”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/c6a0a24a559ce60379a15c209846af24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzfv9RlLCqna0Vdaozkovw.png"/></div></div></figure><p id="2f9f" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">在第一页上，按“Blank”(因为我们将创建自己的模式)，然后按“Next”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/dac00b5bace888ed64562b0551a9ae8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJ7snMRqnWm7Fw_hsK2gHA.png"/></div></div></figure><p id="45fb" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">不要更改第二页上的任何内容，然后按“下一步”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/60119ab3b36ed213d25ce85f33c3751a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rgn7-Ja_zkBMfFWc4OA74g.png"/></div></div></figure><p id="7b53" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">在第三页，自定义您的图表详细信息。</p><blockquote class="ng nh ni"><p id="0f6d" class="lo lp nj lq b lr mx jr lt lu my ju lw nk mz lz ma nl na md me nm nb mh mi mj ij bi translated">注意:记住你的子域和密码！我们将在脚本文件中使用这些。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/e7c4db8ef0d2485f127f098eda8fc7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BvpB1tYp17lSW0MaZQXxDQ.png"/></div></div></figure><p id="4759" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">最后，确认一切正常，然后点击“提交”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/a613cc8095eeb0d9c43448a7b7a1d0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*08a_OlFQT4Ah4om5XSzOMg.png"/></div></div></figure><p id="5ab5" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">您的图表可能需要几分钟才能启动。当图表状态显示带有绿点的“就绪”时，它将就绪。</p><h2 id="a47f" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第二步:创建一个图表(可视化)</h2><blockquote class="ng nh ni"><p id="38f8" class="lo lp nj lq b lr mx jr lt lu my ju lw nk mz lz ma nl na md me nm nb mh mi mj ij bi translated">注意:如果您更愿意通过脚本创建图表，请跳到步骤IV。</p></blockquote><p id="6ac8" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">在TG Cloud中，在您刚刚创建的解决方案旁边，点击Actions下的下拉菜单，然后点击“GraphStudio”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/5a48ea286c6f73cb53928cc931e1eaaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*4MPizZScUf2SLX7ceFzMTQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">选择GraphStudio</p></figure><p id="5146" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">您将被重定向到GraphStudio。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/829c9d8bbfb5077ddb324072a22d670f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6c0wM1o_vIbvVBpq3bwV0g.png"/></div></div></figure><p id="af4b" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">按“全局视图”，然后选择“创建图表”</p><div class="kg kh ki kj gt ab cb"><figure class="oa kk ob oc od oe of paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/4c4ef5a75559973be0fa2e4e179e5f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*lD3f6s7mLz2574QgbTxTig.png"/></div></figure><figure class="oa kk og oc od oe of paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/ce79ae324a4a23093df228c47b8e8d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*e6SS-2-j9dWVXo3Nb4fEoA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk oh di oi oj translated">创建图表</p></figure></div><p id="b65b" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">你想给这个图起什么名字都行。对于这个例子，我正在创建一个名为“应用程序图”的图表</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/4dc0cbe8a8a381dbf7f3604ac2adee5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-8QYUBh33rp8MjeDeMEw2A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">给图表命名</p></figure><p id="270f" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">完美！你的图表现在准备好了。接下来，我们将创建我们的模式，这有点像我们如何增加数据的地图。</p><h2 id="c426" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">步骤三:创建一个模式(可视化)</h2><p id="b745" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，点击进入“设计模式”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/ec93528e1157a8656e6bce13f34c91f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jtbMSd_Y6k4mVYBULpsp0A.png"/></div></div></figure><p id="93ba" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">按顶栏上的加号按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/8dc60e5ca038228b36dcc736745d399e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*U-ONT9ObpIXyr-l_RveJew.png"/></div></figure><p id="514f" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">在出现的边栏中，自定义顶点细节。该顶点将是“申请人”类型主要ID将是电子邮件。它有一个名为“name”的STRING类型的属性。自定义后按下复选标记。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/23c57688567abbc0e333bfcfc412385d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiJ5PLZ1Mptxzy2N3N_XAw.png"/></div></div></figure><p id="45f5" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">顶点将会出现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/4fe831fe31b9508879a79eeb682afeda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*b_dS8fpIoWxLcyHoxGhgJw.png"/></div></figure><p id="83ae" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">接下来，让我们创建一个位置顶点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/f6b596042cc59d5501598b329fbfa40d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*elXNnSylC6OUSD-s3HPrig.png"/></div></div></figure><p id="9f99" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">按下“添加局部边类型”,然后单击“申请人”顶点和“位置”顶点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/489d09b550079b6485f0e7cee7e04116.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*WtQ1hIw8Qw9k6orvvwI45Q.png"/></div></figure><p id="8a1f" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">编辑边描述，然后按检查键。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/d885907e94b7b785e257a0828cab4460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkSG3-Orq6Ju8iOSeJAP_w.png"/></div></div></figure><p id="444c" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">完美！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/53afa59466dc993a72fa2e793e470681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bjMCBwTK-FdM2Ex9Kdc0A.png"/></div></div></figure><p id="480a" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">让我们继续构建图表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/f476c66c50a899e7eac5a7c020bdf166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSTZLXaftdAjXu-o90bUag.png"/></div></div></figure><p id="0f9b" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">完成后，点击“发布模式”按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/81a566434400926df5c4e1ff47ee584f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*faM8vKdJdbol8qo0lQ5Oqg.png"/></div></figure><p id="f0da" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">加载完成后，你就可以开始了。</p><h2 id="2d1d" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">步骤四:(可选)创建一个图表(脚本)</h2><p id="eb97" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">或者，您可以使用以下脚本通过Python创建模式，用您的子域替换子域，用您的密码替换密码。</p><pre class="kg kh ki kj gt ou ov ow ox aw oy bi"><span id="c9ca" class="mk kx iq ov b gy oz pa l pb pc">import pyTigerGraph as tg </span><span id="c14d" class="mk kx iq ov b gy pd pa l pb pc">conn = tg.TigerGraphConnection(host="<a class="ae kv" href="https://tigergraphnlp.i.tgcloud.io/" rel="noopener ugc nofollow" target="_blank">https://SUBDOMAIN.i.tgcloud.io/</a>", password="PASSWORD")</span><span id="105b" class="mk kx iq ov b gy pd pa l pb pc">conn.gsql('''</span><span id="68ce" class="mk kx iq ov b gy pd pa l pb pc">CREATE VERTEX Applicant(PRIMARY_ID email STRING, name STRING) WITH_PRIMARY_AS_ATTRIBUTE="true"<br/>CREATE VERTEX Position(PRIMARY_ID position_name STRING) WITH_PRIMARY_AS_ATTRIBUTE="true"<br/>CREATE VERTEX Skill(PRIMARY_ID skill STRING) WITH_PRIMARY_AS_ATTRIBUTE="true"<br/>CREATE VERTEX Reason_Applying(PRIMARY_ID response STRING) WITH_PRIMARY_AS_ATTRIBUTE="true"<br/>CREATE VERTEX Keywords(PRIMARY_ID word STRING) WITH_PRIMARY_AS_ATTRIBUTE="true"</span><span id="403c" class="mk kx iq ov b gy pd pa l pb pc">CREATE UNDIRECTED EDGE APPLIED_FOR(FROM Applicant, TO Position)<br/>CREATE UNDIRECTED EDGE APPLICANT_SKILL(FROM Applicant, TO Skill)<br/>CREATE UNDIRECTED EDGE APPLICANT_REASON_APPLYING(FROM Applicant, TO Reason_Applying)<br/>CREATE UNDIRECTED EDGE APPLICANT_KEYWORDS(FROM Applicant, TO Keywords)</span><span id="2730" class="mk kx iq ov b gy pd pa l pb pc">CREATE GRAPH ApplicationGraph(Applicant, Position, Skill, Reason_Applying, Keywords, APPLIED_FOR, APPLICANT_SKILL, APPLICANT_REASON_APPLYING, APPLICANT_KEYWORDS)</span><span id="7271" class="mk kx iq ov b gy pd pa l pb pc">''')</span></pre><p id="713f" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">太棒了。现在我们可以开始加载数据了。</p><h1 id="0740" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第四部分:创建目录并提取数据</h1><h2 id="3dd1" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第一步:创建目录</h2><p id="6711" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在你的机器上，在你喜欢的地方创建一个新文件夹。在那里，您需要创建两个文件:一个Python文件，其中包含了大部分内容，另一个是您在第二步中下载的JSON文件。将JSON文件重命名为credentials.json。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/605f61542bfea72f3bd4704a5e82e28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*itwhuxrvMAY8CxCc6Ds-FQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">目录文件</p></figure><h2 id="ed90" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第二步:安装库</h2><p id="9ab7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，pip安装Google Cloud和pyTigerGraph。</p><pre class="kg kh ki kj gt ou ov ow ox aw oy bi"><span id="4e2b" class="mk kx iq ov b gy oz pa l pb pc">pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib</span><span id="3561" class="mk kx iq ov b gy pd pa l pb pc">pip install pyTigerGraph</span></pre><h2 id="55ad" class="mk kx iq bd ky ml mm dn lc mn mo dp lg lx mp mq li mb mr ms lk mf mt mu lm mv bi translated">第三步:读这些行</h2><p id="384a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，我们将导入刚刚安装的库。</p><pre class="kg kh ki kj gt ou ov ow ox aw oy bi"><span id="0471" class="mk kx iq ov b gy oz pa l pb pc">import os.path</span><span id="a962" class="mk kx iq ov b gy pd pa l pb pc">from googleapiclient.discovery import build</span><span id="0b7c" class="mk kx iq ov b gy pd pa l pb pc">from google_auth_oauthlib.flow import InstalledAppFlow</span><span id="6697" class="mk kx iq ov b gy pd pa l pb pc">from google.auth.transport.requests import Request</span><span id="15b9" class="mk kx iq ov b gy pd pa l pb pc">from google.oauth2.credentials import Credentials</span></pre><p id="5877" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">接下来，我们将设置范围、电子表格ID和范围。这里，确保用第一部分的ID替换电子表格id from Part I。</p><blockquote class="ng nh ni"><p id="073e" class="lo lp nj lq b lr mx jr lt lu my ju lw nk mz lz ma nl na md me nm nb mh mi mj ij bi translated">注:用第一部分中的电子表格标识替换电子表格标识from Part I。</p></blockquote><pre class="kg kh ki kj gt ou ov ow ox aw oy bi"><span id="80e0" class="mk kx iq ov b gy oz pa l pb pc">SCOPES = ['https://www.googleapis.com/auth/spreadsheets']</span><span id="0492" class="mk kx iq ov b gy pd pa l pb pc">SPREADSHEET_ID = SPREADSHEET_ID_FROM_PART_I</span><span id="30a0" class="mk kx iq ov b gy pd pa l pb pc">RANGE_NAME = 'Sheet1!A1:G'</span></pre><p id="aabe" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">然后，我们将编写一个小脚本来更新凭证。</p><pre class="kg kh ki kj gt ou ov ow ox aw oy bi"><span id="78e8" class="mk kx iq ov b gy oz pa l pb pc">creds = None</span><span id="75c3" class="mk kx iq ov b gy pd pa l pb pc">if os.path.exists('token.json'):<br/>   creds = Credentials.from_authorized_user_file('token.json', SCOPES)</span><span id="b1b4" class="mk kx iq ov b gy pd pa l pb pc">   if not creds or not creds.valid:<br/>      if creds and creds.expired and creds.refresh_token:<br/>         creds.refresh(Request())</span><span id="d796" class="mk kx iq ov b gy pd pa l pb pc">      else:<br/>         flow = InstalledAppFlow.from_client_secrets_file('credentials.json', SCOPES)<br/>         creds = flow.run_local_server(port=0)</span><span id="547a" class="mk kx iq ov b gy pd pa l pb pc">      with open('token.json', 'w') as token:<br/>         token.write(creds.to_json())</span><span id="d90b" class="mk kx iq ov b gy pd pa l pb pc">service = build('sheets', 'v4', credentials=creds)</span></pre><p id="3bd5" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">当您运行这个时，您可能需要第一次输入您的凭据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/7d436f916551a6d241380882dc637905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iiJDgaBg0X62iSGguWZJtQ.png"/></div></div></figure><p id="fa11" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">之后，我们可以读取Google Sheets数据并向上插入顶点。</p><pre class="kg kh ki kj gt ou ov ow ox aw oy bi"><span id="a474" class="mk kx iq ov b gy oz pa l pb pc">service = build('sheets', 'v4', credentials=creds)</span><span id="4025" class="mk kx iq ov b gy pd pa l pb pc">sheet = service.spreadsheets()</span><span id="e34a" class="mk kx iq ov b gy pd pa l pb pc">result = sheet.values().get(spreadsheetId=SPREADSHEET_ID,</span><span id="7cae" class="mk kx iq ov b gy pd pa l pb pc">range=RANGE_NAME).execute()</span><span id="1da9" class="mk kx iq ov b gy pd pa l pb pc">values = result.get('values', [])</span><span id="78a4" class="mk kx iq ov b gy pd pa l pb pc">import pyTigerGraph as tg</span><span id="517f" class="mk kx iq ov b gy pd pa l pb pc">conn = tg.TigerGraphConnection(host="https://SUBDOMAIN.i.tgcloud.io/", password="PASSWORD", graphname="ApplicationGraph")</span><span id="2856" class="mk kx iq ov b gy pd pa l pb pc">conn.apiToken = conn.getToken(conn.createSecret())</span><span id="0f09" class="mk kx iq ov b gy pd pa l pb pc">if not values:</span><span id="6cfe" class="mk kx iq ov b gy pd pa l pb pc">   print('No data found.')</span><span id="e567" class="mk kx iq ov b gy pd pa l pb pc">else:</span><span id="e759" class="mk kx iq ov b gy pd pa l pb pc">   for row in values:</span><span id="cb83" class="mk kx iq ov b gy pd pa l pb pc">      conn.upsertVertex("Applicant", row[2], attributes={"email": row[2], "name": row[1]})</span><span id="7245" class="mk kx iq ov b gy pd pa l pb pc">      conn.upsertVertex("Reason_Applying", row[4], attributes={"response": row[4]})</span><span id="a37d" class="mk kx iq ov b gy pd pa l pb pc">      conn.upsertVertex("Skill", row[5], attributes={"skill": row[5]})</span><span id="50d2" class="mk kx iq ov b gy pd pa l pb pc">      conn.upsertVertex("Position", row[3], attributes={"position_name": row[3]})</span><span id="50ce" class="mk kx iq ov b gy pd pa l pb pc">      conn.upsertEdge("Applicant", row[2], "APPLICANT_REASON_APPLYING", "Reason_Applying", row[4])</span><span id="1aa8" class="mk kx iq ov b gy pd pa l pb pc">      conn.upsertEdge("Applicant", row[2], "APPLICANT_SKILL", "Skill", row[5])</span><span id="98e9" class="mk kx iq ov b gy pd pa l pb pc">      conn.upsertEdge("Applicant", row[2], "APPLIED_FOR", "Position", row[3])</span><span id="ec1b" class="mk kx iq ov b gy pd pa l pb pc">      print("Row Upserted")</span></pre><p id="030c" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">就这样，完美！现在，您可以使用TigerGraph与您的Google Sheets进行交互。</p><h1 id="3700" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第五部分:祝贺你！</h1><p id="cd60" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">恭喜你。你现在可以正式将Google Sheets数据导入TigerGraph了！如果您遇到任何问题，请随时在TigerGraph社区论坛或TigerGraph Discord中提问。</p><div class="pg ph gp gr pi pj"><a href="https://community.tigergraph.com" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ir gy z fp po fr fs pp fu fw ip bi translated">老虎图</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">一个学习、提问、展示酷项目以及与其他TigerGraph开发人员交流的地方！</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">community.tigergraph.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px kp pj"/></div></div></a></div><div class="pg ph gp gr pi pj"><a href="https://discord.gg/gRHWBZNpxW" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ir gy z fp po fr fs pp fu fw ip bi translated">加入TigerGraph Discord服务器！</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">查看Discord上的TigerGraph社区-与607名其他成员一起玩，享受免费的语音和文本聊天。</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">不和谐. gg</p></div></div><div class="ps l"><div class="py l pu pv pw ps px kp pj"/></div></div></a></div><p id="09aa" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">最后，如果你想创建像这样的酷项目，并计划加入TigerGraph社区，了解社区贡献计划以获得奖励！</p><div class="pg ph gp gr pi pj"><a href="https://www.tigergraph.com/community-contribution/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ir gy z fp po fr fs pp fu fw ip bi translated">图表分析用例|图表数据库解决方案</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">使用TigerGraph的图形数据库解决方案连接、分析和学习数据。探索图表分析使用…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">www.tigergraph.com</p></div></div><div class="ps l"><div class="pz l pu pv pw ps px kp pj"/></div></div></a></div><p id="6ef3" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">感谢你阅读这篇博客，我希望你加入TigerGraph社区，开始获得你的条纹！</p></div></div>    
</body>
</html>