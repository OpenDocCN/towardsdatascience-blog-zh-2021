<html>
<head>
<title>Time-series ETL with Meerschaum</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">海泡石时序ETL</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/easy-time-series-etl-for-data-scientists-with-meerschaum-5aade339b398?source=collection_archive---------18-----------------------#2021-10-21">https://towardsdatascience.com/easy-time-series-etl-for-data-scientists-with-meerschaum-5aade339b398?source=collection_archive---------18-----------------------#2021-10-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="aa88" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">业内笔记</a></h2><div class=""/><div class=""><h2 id="1270" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">数据工程不需要这么复杂</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/095c990df5897409e5572746bb7fc008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1LkqKJE_xWrGOs_vt2ULGw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">通过noaa插件同步海泡石中的天气数据。(图片由作者提供)</p></figure><blockquote class="le lf lg"><p id="3987" class="lh li lj lk b ll lm ka ln lo lp kd lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">我是Bennett Meares，<a class="ae me" href="https://meerschaum.io" rel="noopener ugc nofollow" target="_blank">海泡石</a>的作者。我构建并开源了海泡石以使数据工程更容易理解，今年我完成了关于在现实世界中使用海泡石的同步策略的硕士论文。</p><p id="a536" class="lh li lj lk b ll lm ka ln lo lp kd lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">如果海泡石对你的项目有帮助，或者如果你有问题，请在<a class="ae me" href="https://github.com/bmeares/Meerschaum/discussions" rel="noopener ugc nofollow" target="_blank">项目讨论版</a>上告诉我！</p></blockquote><p id="4a8e" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi mi translated">似乎每天都有新的ETL / ELT框架向世界承诺。事实是，数据工程兔子洞跑<em class="lj">深</em>。对于数据科学家和BI分析师来说，花在粗制滥造的脚本或学习庞大框架上的时间比花在实际分析上的时间要少。通常，真正需要做的只是更新表格、获取<code class="fe mr ms mt mu b">pandas</code>数据帧和构建仪表板。</p><h1 id="23c3" class="mv mw iq bd mx my mz na nb nc nd ne nf kf ng kg nh ki ni kj nj kl nk km nl nm bi translated">其他ETL系统</h1><p id="10a5" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">有一些ETL管理系统，例如<a class="ae me" href="https://aws.amazon.com/glue/" rel="noopener ugc nofollow" target="_blank"> AWS Glue </a>、<a class="ae me" href="https://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Airflow </a>和<a class="ae me" href="https://www.getdbt.com/" rel="noopener ugc nofollow" target="_blank"> dbt </a>，每个系统都有自己对ETL过程的观点。例如，Airflow让数据工程师将他们的脚本安排为<a class="ae me" href="https://airflow.apache.org/docs/apache-airflow/stable/concepts/dags.html" rel="noopener ugc nofollow" target="_blank">有向无环图</a>(Dag)，其行为有点像具有更多上下文的<code class="fe mr ms mt mu b">crontab</code>。Dbt倾向于ETL的转换方面，并为管理许多SQL模型提供Jinja风格的模板。AWS Glue充当亚马逊各种数据存储选项(RDS、红移、S3等)之间更全面的数据集成服务。).</p><p id="0c75" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">这些工具对于大规模工作负载来说很有前途，但是在许多项目中，它们可能有点大材小用。在许多情况下，这些行业工具所涉及的设置和模板会导致笨拙的用户体验。您需要使您的ETL工作符合您选择的框架，并且需要大量的背景知识来有效地使用这些工具。</p><p id="7bc5" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">这就是<a class="ae me" href="https://meerschaum.io" rel="noopener ugc nofollow" target="_blank">海泡石</a>的用武之地――它是一个轻量级的时间序列ETL管理系统，构建时考虑到了生活质量。</p><blockquote class="le lf lg"><p id="ab36" class="lh li lj lk b ll lm ka ln lo lp kd lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">你仍然可以在更大的框架中使用海泡石作为组件。海泡石给你工具来建造你喜欢的建筑。</p></blockquote></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="d698" class="mv mw iq bd mx my nz na nb nc oa ne nf kf ob kg nh ki oc kj nj kl od km nl nm bi translated">介绍海泡石</h1><p id="49ba" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">对于数据科学家来说，海泡石是一个轻量级的通用ETL框架。对于大多数项目来说，它在一个<a class="ae me" href="https://meerschaum.io/reference/stack/" rel="noopener ugc nofollow" target="_blank">预配置堆栈</a>(包括一个时间序列数据库和Grafana)中带有合理的默认值，这样你就可以快速开始同步和分析数据。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/2b1cc644af8e3939e5136460fe7d795a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZEUiEC6w4_8FQY7niIG5g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">海泡石项目的主页。(图片由作者提供)</p></figure><h2 id="5a63" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">我如何开始使用海泡石？</h2><p id="a6bf" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated"><a class="ae me" href="https://meerschaum.io/get-started/" rel="noopener ugc nofollow" target="_blank">入门</a>指南更全面地介绍了基础知识，但是TL；DR从<a class="ae me" href="https://pypi.org/project/meerschaum/" rel="noopener ugc nofollow" target="_blank"> PyPI </a>安装并运行<code class="fe mr ms mt mu b">mrsm</code>命令(或者<code class="fe mr ms mt mu b">python -m meerschaum</code>如果<code class="fe mr ms mt mu b">mrsm</code>不在你的<code class="fe mr ms mt mu b">PATH</code>中)。</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="9868" class="of mw iq mu b gy ou ov l ow ox">pip install --user meerschaum<br/>mrsm stack up -d db grafana<br/>mrsm</span></pre><p id="cc9b" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">这将使你进入<code class="fe mr ms mt mu b">mrsm</code>外壳，在那里你可以开始构建你的管道。<code class="fe mr ms mt mu b">help</code>命令可以洞察可用的操作(例如<code class="fe mr ms mt mu b">help show pipes</code>)，自动完成建议将在运行命令时指导您。</p><h2 id="9e03" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">等等，什么是管道？</h2><p id="3198" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">海泡石的核心概念是<a class="ae me" href="https://meerschaum.io/reference/pipes/" rel="noopener ugc nofollow" target="_blank">管道</a>，它基本上是数据库上的一个表，带有一些关于如何更新它的元数据。例如，因为海泡石关注时间序列，所以所有管道都需要主<code class="fe mr ms mt mu b">datetime</code>列的名称。</p><p id="e943" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">通过管道，您可以接入数据流进行分析:</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="606f" class="of mw iq mu b gy ou ov l ow ox">&gt;&gt;&gt; from meerschaum import Pipe<br/>&gt;&gt;&gt; pipe = Pipe('plugin:noaa', 'weather')<br/>&gt;&gt;&gt; df = pipe.get_data(<br/>...   begin  = '2021-10-01',<br/>...   end    = '2021-11-01',<br/>...   params = {'station': ['KATL', 'KCEU']},<br/>... )<br/>&gt;&gt;&gt; </span></pre><h2 id="3e01" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">没有时序数据流可以用海泡石吗？</h2><p id="5020" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">当然，您不需要符合包含的时间序列模型。例如，您可以使用<a class="ae me" href="https://meerschaum.io/reference/connectors/" rel="noopener ugc nofollow" target="_blank">连接器</a>作为创建和组织数据库连接的便捷方式:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h2 id="0dc0" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">数据如何同步到管道中？</h2><p id="b2fd" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">ETL过程发生在<code class="fe mr ms mt mu b">sync</code>命令中。对于<code class="fe mr ms mt mu b">sql</code>管道，<a class="ae me" href="https://meerschaum.io/reference/pipes/syncing/" rel="noopener ugc nofollow" target="_blank">同步包括执行一个生成的SQL查询</a>来获取、过滤和插入最新的数据(我在我的<a class="ae me" href="https://meerschaum.io/files/pdf/thesis.pdf" rel="noopener ugc nofollow" target="_blank">硕士论文</a>中探索了各种策略)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pa"><img src="../Images/21346304b6f581eafaa3f2cbeae01b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_QAjRdcxjYQ3Kfea8Tz_xA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">使用“同步管道”命令同步管道。(图片由作者提供)</p></figure><p id="61a0" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">对于<code class="fe mr ms mt mu b">plugin</code>管道，<code class="fe mr ms mt mu b">begin</code>和<code class="fe mr ms mt mu b">end</code>日期时间界限被传递给<code class="fe mr ms mt mu b">fetch()</code>函数，结果数据帧被过滤和插入。这里有更多关于写一个获取插件的信息，但是下面是一个基本的例子:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h2 id="f22b" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">闲聊够了，让我们让一些数据流动起来！</h2><p id="9e48" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">在我们深入细节之前，让我们同步一些数据。<a class="ae me" href="https://meerschaum.io/get-started/" rel="noopener ugc nofollow" target="_blank">入门指南</a>对事情的解释比我在这里所能解决的更透彻，但是如果你想了解这个过程是如何工作的，运行下面的命令让数据流动起来(如果你在交互式shell中，你可以省略<code class="fe mr ms mt mu b">mrsm</code>):</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="03fa" class="of mw iq mu b gy ou ov l ow ox">### Start the database.</span><span id="30c5" class="of mw iq mu b gy pb ov l ow ox">mrsm stack up -d db grafana</span><span id="3acd" class="of mw iq mu b gy pb ov l ow ox"><br/>### Install the NOAA plugin.</span><span id="abf5" class="of mw iq mu b gy pb ov l ow ox">mrsm install plugin noaa</span><span id="9231" class="of mw iq mu b gy pb ov l ow ox"><br/>### Register the pipe (or run `bootstrap` for a wizard).<br/>### The -c stands for 'connector' and -m for 'metric'.</span><span id="c960" class="of mw iq mu b gy pb ov l ow ox">mrsm register pipe -c plugin:noaa -m weather</span><span id="fef4" class="of mw iq mu b gy pb ov l ow ox"><br/>### The 'noaa' plugin will ask you for a station. Enter 'KCLT'.<br/>### It also handles the datetime column name.</span><span id="abdb" class="of mw iq mu b gy pb ov l ow ox">mrsm sync pipes</span><span id="ae7a" class="of mw iq mu b gy pb ov l ow ox"><br/>### Demonstrate that we've successfully synced our data.</span><span id="0b90" class="of mw iq mu b gy pb ov l ow ox">mrsm show data</span></pre><p id="1cae" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">访问<a class="ae me" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>在Grafana中查看您的数据(默认用户名和密码为<code class="fe mr ms mt mu b">admin</code>和<code class="fe mr ms mt mu b">admin</code>)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/c1f6e93b8087e728f459a04d53513d26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cq8sooeYTbO7e8B0fUT_Ew.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Grafana预先配置在海泡石堆栈中。(图片由作者提供)</p></figure><p id="1268" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated"><code class="fe mr ms mt mu b">mrsm</code> shell附带有用的命令，比如<code class="fe mr ms mt mu b">show</code>动作(例如<code class="fe mr ms mt mu b">show pipes</code>、<code class="fe mr ms mt mu b">show rowcounts</code>、<code class="fe mr ms mt mu b">show columns</code>等)。).</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/7da125dcba2ad093c24a657c6f48d67d.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*LEZgnj_xz7KBIHVAbd3tUw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">海泡石外壳在键入命令时提供建议。(图片由作者提供)</p></figure><p id="9e80" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">对于数据科学家来说，另一个有用的动作是<code class="fe mr ms mt mu b">sql</code>命令。Meerschaum <code class="fe mr ms mt mu b">sql</code>连接器与来自<a class="ae me" href="https://www.dbcli.com/" rel="noopener ugc nofollow" target="_blank"> dbcli </a>项目的工具集成在一起，所以你可以直接进入你的数据库，而不需要启动整个IDE。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pe"><img src="../Images/a274d501d689648c6b4f45703538aa87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgJlbMsBsdUZ9lKPZeUfog.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">海泡石与dbcli集成在一起，可以让你直接进入你的数据库。(图片由作者提供)</p></figure></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="2369" class="mv mw iq bd mx my nz na nb nc oa ne nf kf ob kg nh ki oc kj nj kl od km nl nm bi translated">建筑管道</h1><p id="581d" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">如果您想从关系数据库中提取数据，用<code class="fe mr ms mt mu b">bootstrap connector</code>添加连接，然后用<code class="fe mr ms mt mu b">bootstrap pipe</code>构建管道。<code class="fe mr ms mt mu b">bootstrap</code>命令启动一个向导来引导你添加连接器和管道。</p><p id="04ff" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">当使用<code class="fe mr ms mt mu b">sql</code>连接器引导管道时，向导将提示您输入SQL定义，就好像管道是一个视图一样(您可以稍后使用<code class="fe mr ms mt mu b">edit pipe definition</code>编辑定义)。当获取新数据时，该定义稍后用于更大的查询中，以绑定到日期时间轴上。</p><h2 id="d55f" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">同步管道</h2><p id="dea0" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">如上所述，<code class="fe mr ms mt mu b">sync pipes</code>命令获取、过滤和插入新数据到管道中。各种标志会影响行为或同步过程，例如:</p><ol class=""><li id="beff" class="pf pg iq lk b ll lm lo lp mf ph mg pi mh pj md pk pl pm pn bi translated"><code class="fe mr ms mt mu b">--loop</code>标志持续同步管道，在两圈之间休眠1秒。</li><li id="001b" class="pf pg iq lk b ll po lo pp mf pq mg pr mh ps md pk pl pm pn bi translated"><code class="fe mr ms mt mu b">--min-seconds</code>标志改变两圈之间的秒数。</li><li id="04bf" class="pf pg iq lk b ll po lo pp mf pq mg pr mh ps md pk pl pm pn bi translated"><code class="fe mr ms mt mu b">-d</code>或<code class="fe mr ms mt mu b">--daemon</code>标志将命令作为后台作业运行，并可应用于任何海泡石命令。</li><li id="168a" class="pf pg iq lk b ll po lo pp mf pq mg pr mh ps md pk pl pm pn bi translated">标准的<code class="fe mr ms mt mu b">-c</code>、<code class="fe mr ms mt mu b">-m</code>和<code class="fe mr ms mt mu b">-l</code>管道过滤器标志指定哪些管道可以被同步。每个标志接受多个值。</li></ol><p id="2697" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">例如，以下命令将持续同步带有连接器键<code class="fe mr ms mt mu b">plugin:noaa</code>的管道，并在批处理之间等待一个小时，所有这些都在后台作业中完成。</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="5f35" class="of mw iq mu b gy ou ov l ow ox">sync pipes -c plugin:noaa --loop --min-seconds 3600 -d</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pt"><img src="../Images/fd7740cf1eabdce778742c37a8413b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_4-_AyCCOw93U3z6BcnNA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">使用-d标志生成一个后台作业。(图片由作者提供)</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pu"><img src="../Images/cf37ea96daf67a686d2f0efe0315bd20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6rijLlmxxbTkv6vYoYw-IA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">可以使用“显示日志”查看作业的输出。(图片由作者提供)</p></figure></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="81e7" class="mv mw iq bd mx my nz na nb nc oa ne nf kf ob kg nh ki oc kj nj kl od km nl nm bi translated">在你的项目中使用海泡石</h1><p id="937c" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">以下是海泡石可以帮助你完成项目的例子。你可以遵循框架的模型，但是海泡石给了你所需的灵活性，让你可以按照自己喜欢的方式来构建你的架构。</p><h2 id="1395" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">插件</h2><p id="8f98" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">你可以通过<a class="ae me" href="https://meerschaum.io/reference/plugins/types-of-plugins/" rel="noopener ugc nofollow" target="_blank">插件</a>将你的脚本包含在你的海泡石实例中，这些插件是简单的Python脚本。插件可以获取数据，定义定制的<code class="fe mr ms mt mu b">sync</code>行为，扩展内置的<a class="ae me" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI应用</a>，以及添加或覆盖动作和标志。</p><p id="f352" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">为了分享你的插件，你可以上传到默认的<a class="ae me" href="https://api.mrsm.io/dash/plugins" rel="noopener ugc nofollow" target="_blank">公共海泡石库</a>或者你自己的私有海泡石API实例<code class="fe mr ms mt mu b">-r</code>。</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="b912" class="of mw iq mu b gy ou ov l ow ox">register plugin myplugin -r api:myinstance</span></pre><blockquote class="le lf lg"><p id="f27d" class="lh li lj lk b ll lm ka ln lo lp kd lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated"><a class="ae me" href="https://bmeares.medium.com/how-i-automatically-extract-my-m1-finance-transactions-b43cef857bc7" rel="noopener">在我今年早些时候写的一篇文章中</a>，我展示了一个我写的从Apex清算API获取财务数据的海泡石插件。</p></blockquote><h2 id="3da3" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">Web API</h2><p id="885d" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">你可以连接到你的海泡石实例，通过运行Web API来保护防火墙后面的数据库。</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="21b0" class="of mw iq mu b gy ou ov l ow ox">start api -d</span></pre><p id="93ff" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">在另一台机器上，将您的API添加为连接器，并使用它来访问您的实例(在shell中使用<code class="fe mr ms mt mu b">instance</code>命令或在命令上使用<code class="fe mr ms mt mu b">-i</code>标志)。web仪表板可用于通过浏览器控制海泡石。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pv"><img src="../Images/ce849bde4aee3a1961e0a59c2fde0927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0O3S_g85KRdANr8_1_Q8cQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">web dashboard可用于随时随地控制海泡石。(图片由作者提供)</p></figure><p id="e07b" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">该API允许你与团队协作，托管私有插件并允许独立的Meerschaum用户登录。注意，到目前为止，用户共享数据库，所以用户系统是为每个特定实例的较小团队设计的。也就是说，插件归用户所有，管道由团队共享。</p><blockquote class="le lf lg"><p id="114e" class="lh li lj lk b ll lm ka ln lo lp kd lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">一个完整的建筑可能包括许多海泡石实例。</p></blockquote><h2 id="e640" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">Shell命令</h2><p id="3d46" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">你可以在shell脚本中使用海泡石，或者在crontab中使用<code class="fe mr ms mt mu b">mrsm</code>或<code class="fe mr ms mt mu b">python -m meerschaum</code>。请注意，您需要通过<code class="fe mr ms mt mu b">-y</code>或<code class="fe mr ms mt mu b">-f</code>，这样您的脚本就不会被交互式问题卡住。</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="662f" class="of mw iq mu b gy ou ov l ow ox">### Sync pipes once per hour.<br/>0 * * * * python -m meerschaum sync pipes</span><span id="06df" class="of mw iq mu b gy pb ov l ow ox">### Start jobs on reboot<br/>@reboot python -m meerschaum start jobs -y</span></pre><h2 id="848e" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">后台作业</h2><p id="ad72" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">对于持续的操作(比如运行API)，<a class="ae me" href="https://meerschaum.io/reference/background-jobs/" rel="noopener ugc nofollow" target="_blank">海泡石后台作业</a>是一种管理流程的简单方法。添加<code class="fe mr ms mt mu b">-d</code>标志来告诉Meerschaum运行您指定为后台作业的命令。除非您指定了<code class="fe mr ms mt mu b">--name</code>标志，否则作业会被随机命名。</p><pre class="kp kq kr ks gt oq mu or os aw ot bi"><span id="6c4c" class="of mw iq mu b gy ou ov l ow ox">mrsm start api -d --name api_job</span></pre><p id="63f8" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">您可以使用<code class="fe mr ms mt mu b">start</code>、<code class="fe mr ms mt mu b">stop</code>和<code class="fe mr ms mt mu b">delete</code>命令管理您的作业。命令<code class="fe mr ms mt mu b">show logs</code>将显示正在运行的后台作业的输出(如<code class="fe mr ms mt mu b">docker-compose</code>)。</p><h2 id="85e0" class="of mw iq bd mx og oh dn nb oi oj dp nf mf ok ol nh mg om on nj mh oo op nl iw bi translated">Python包</h2><p id="6c69" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">Python包可以很容易地导入到您现有的脚本中。完整的软件包文档更详细，尽管下面是几个有用的例子。</p><p id="869d" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">一个<code class="fe mr ms mt mu b">Pipe</code>对象可以让你直接访问你的数据流。<code class="fe mr ms mt mu b">sync()</code>方法允许我们向管道中添加新数据(过滤掉重复的数据)，而<code class="fe mr ms mt mu b">get_data()</code>方法允许我们根据特定的参数轻松地检索历史数据。这里是关于<code class="fe mr ms mt mu b">Pipe</code>对象所能做的事情的文档。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oy oz l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">新管道很容易注册和同步。</p></figure><p id="601a" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated"><code class="fe mr ms mt mu b">get_pipes()</code>函数允许您检索一个实例上所有注册的管道。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oy oz l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">管道的键结构允许更容易的分组和管理。</p></figure></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="d09b" class="mv mw iq bd mx my nz na nb nc oa ne nf kf ob kg nh ki oc kj nj kl od km nl nm bi translated">结论</h1><p id="d2db" class="pw-post-body-paragraph lh li iq lk b ll nn ka ln lo no kd lq mf np lt lu mg nq lx ly mh nr mb mc md ij bi translated">这篇文章展示了几种可以开始同步时间序列数据的方法，尽管海泡石还可以提供更多。记住，海泡石的主要焦点是<a class="ae me" href="https://meerschaum.io/reference/data-analysis-tools/" rel="noopener ugc nofollow" target="_blank">生活质量，这样你就可以回到数据分析</a>。对于没有时间研究数据工程的数据科学家来说:海泡石可能适合你！</p><p id="6f54" class="pw-post-body-paragraph lh li iq lk b ll lm ka ln lo lp kd lq mf ls lt lu mg lw lx ly mh ma mb mc md ij bi translated">那么，你还在等什么？试试看！尝试使用内置的SQLite实例<code class="fe mr ms mt mu b">sql:local</code>并同步一些数据。</p><blockquote class="le lf lg"><p id="a7bb" class="lh li lj lk b ll lm ka ln lo lp kd lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">我创建海泡石是为了让每个人都能接触到数据工程，所以如果你需要帮助、有想法或者想展示你的成果，我可以在GitHub 上的<a class="ae me" href="https://github.com/bmeares/Meerschaum/discussions" rel="noopener ugc nofollow" target="_blank">项目讨论页面找到你！</a></p></blockquote></div></div>    
</body>
</html>