<html>
<head>
<title>Sampling Distributions with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python对分布进行采样</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sampling-distributions-with-python-f5a5f268f636?source=collection_archive---------2-----------------------#2021-06-16">https://towardsdatascience.com/sampling-distributions-with-python-f5a5f268f636?source=collection_archive---------2-----------------------#2021-06-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0c56" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python实现大学统计</h2></div><h1 id="f3b8" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="b0fe" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在一系列的每周文章中，我将涉及一些重要的统计学主题。</p><p id="477e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">目标是使用Python来帮助我们获得对复杂概念的直觉，从经验上测试理论证明，或者从零开始构建算法。在本系列中，您将会看到涵盖随机变量、抽样分布、置信区间、显著性检验等主题的文章。</p><p id="a7ce" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在每篇文章的最后，你可以找到练习来测试你的知识。解决方案将在下周的文章中分享。</p><p id="c60a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">迄今发表的文章:</p><ul class=""><li id="fbec" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/bernoulli-and-binomial-random-variables-d0698288dd36">伯努利和二项随机变量与Python </a></li><li id="a180" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55">用Python从二项式到几何和泊松随机变量</a></li><li id="b1df" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/sampling-distributions-with-python-f5a5f268f636">用Python实现样本比例的抽样分布</a></li><li id="83d3" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/confidence-intervals-with-python-bfa28ebb81c">Python的置信区间</a></li><li id="5eab" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6">使用Python进行显著性测试</a></li><li id="b25d" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9">用Python进行组间差异的双样本推断</a></li><li id="b3e9" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/inference-for-categorical-data-9f3c6034aa57">分类数据的推断</a></li><li id="5520" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/advanced-regression-f74090014f3">高级回归</a></li><li id="4db6" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/analysis-of-variance-anova-8dc889d2fc3a">方差分析— ANOVA </a></li></ul><p id="cc22" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">像往常一样，代码可以在我的<a class="ae mk" href="https://github.com/luisroque/College_Statistics_with_Python" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h1 id="37d4" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">抽样分布</h1><p id="dadb" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们经常发现自己想要估计一个总体的参数，例如，它的均值或标准差。通常，我们无法从总体人群中收集数据。在这种情况下，我们估计总体参数的唯一方法是从总体中随机抽样。我们定义样本的大小<em class="mq"> n </em>并计算每个样本的统计量。这个统计量是我们用来计算总体参数的。请注意，我们为每个随机样本计算的统计数据可能与总体值相差很远，因为它是一个随机样本。这就是为什么我们要多次执行这个过程，我们称之为试验。</p><p id="db8b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们定义一个简单的例子。我们有100名运动员，他们的球衣号码从0到99不等。首先，我们计算总体、和σ的参数。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="adc1" class="na kj it mw b gy nb nc l nd ne">import numpy as np<br/>import matplotlib.pyplot as plt<br/>from scipy.stats import bernoulli, norm, poisson<br/>from scipy import stats<br/>from scipy.stats import kurtosis, skew<br/>import seaborn as sns</span><span id="57b0" class="na kj it mw b gy nf nc l nd ne">X = np.random.choice(np.arange(0, 100), 100, replace=False)<br/>print(f'μ={X.mean()}')<br/>print(f'σ={X.std()}')</span><span id="89b0" class="na kj it mw b gy nf nc l nd ne">μ=49.5<br/>σ=28.86607004772212</span></pre><p id="12db" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们随机抽取100个大小为5的样本。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="2a03" class="na kj it mw b gy nb nc l nd ne">rs = []<br/>for i in range(100):<br/>    rs.append(np.random.choice(X, 5))<br/>rs = np.array(rs)</span><span id="e58f" class="na kj it mw b gy nf nc l nd ne"># 5 examples of our random samples<br/><br/>rs[:5]</span><span id="88ae" class="na kj it mw b gy nf nc l nd ne">array([[87, 73, 61, 91, 99],<br/>       [10,  5, 46, 72, 92],<br/>       [ 1,  3,  7, 59, 88],<br/>       [ 1, 42, 87, 21, 42],<br/>       [65,  9, 54, 88, 67]])</span></pre><p id="a851" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">对于每一个，我们计算一些统计数据；在这种情况下，样本意味着x̄.因此，x̄是100个值的数组(每个样本的平均值)。让我们打印前5个值，然后绘制一个直方图，以便更好地理解抽样分布的形状。事实上，这是样本量等于5 时样本均值的<strong class="lc iu">采样分布。</strong></p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="21e8" class="na kj it mw b gy nb nc l nd ne">x_bar = rs.mean(axis=1)<br/>print(x_bar[:5])<br/>plt.hist(x_bar, bins=100);</span><span id="00dc" class="na kj it mw b gy nf nc l nd ne">[82.2 45.  31.6 38.6 56.6]</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/581ce63d12a0607363f8aa32a815a496.png" data-original-src="https://miro.medium.com/v2/format:webp/1*aZyS6Cwc9TbyLZZAM7PVtg.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图1:样本大小为5时样本均值的抽样分布直方图。</p></figure><h1 id="548e" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">样本比例的抽样分布</h1><p id="b601" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们将通过创建两个随机变量(RV)来开始这一部分，一个伯努利RV和一个二项式RV(如果您不熟悉细节，请参见本系列中我以前的文章)。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi no"><img src="../Images/69ba82ad828d29897ed041cfd8a8b8dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVhw4rMC7qefP0GKHMgcYw.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图2:《瑞克和莫蒂》是一部动画系列片，讲述了一位超级科学家和他不太聪明的孙子<a class="ae mk" href="https://commons.wikimedia.org/wiki/File:Rick_and_Morty.svg" rel="noopener ugc nofollow" target="_blank">的故事。</a></p></figure><p id="be13" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">手头的问题如下，有20，000个不同的宇宙，里克和莫蒂生活在其中，我们想计算如果我们访问一个随机的宇宙，我们可以找到莫蒂的比例。设<em class="mq"> X </em>为如下伯努利RV:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/94ab5d0fcd78c81f66ea394e0d833d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*X2Y7ubK2LO3QzEgogjPwkA.png"/></div></figure><p id="638d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们已经在过去的文章中看到</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f9d98a1b96b60520a4fc79073a7a33e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/1*WMPPD7rDK1lqPWrMGqquRw.png"/></div></figure><p id="4a59" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">和</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/c6d4eb71297e5ff46c324d4db4c3e686.png" data-original-src="https://miro.medium.com/v2/resize:fit:352/format:webp/1*1KpQ8xPPXoEk2mhBEaGvQg.png"/></div></figure><p id="ff7b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，我们定义一个新的RV，它等于<em class="mq"> X </em>的10次独立试验的总和。这是一个二项式RV</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/705c8448f1949a5585c7c6046ba14d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*wTj3CUOlLm1yl0noBF6suw.png"/></div></figure><p id="5685" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在是时候访问一些宇宙，并在那里随机寻找莫迪了。想象一下，我们每次访问10个宇宙，这确实是我们从宇宙总体中抽取的样本。请注意，我们可以认为这些样本是独立的，即使我们为10个样本选择了不同的宇宙。这是因为与总体相比，样本数量非常少。事实上，有一个10%的规则，假设在没有从一定规模的人口中替换的随机抽样中的独立性。</p><p id="0527" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">该去找莫蒂了。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="d0ab" class="na kj it mw b gy nb nc l nd ne">p = 0.6<br/>n = 10<br/>X = bernoulli(p)<br/>Y = [X.rvs(n) for i in range(10000)]</span><span id="7b41" class="na kj it mw b gy nf nc l nd ne">plt.hist(np.sum(Y, axis=1));</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/bae7b98ab68d28f6f8940683e450ea50.png" data-original-src="https://miro.medium.com/v2/format:webp/1*X754rzR3Y-7734NuHPzW5A.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图Morty搜索的抽样比例的抽样分布直方图。</p></figure><p id="91f4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这就是抽样比例的抽样分布。如何计算它的均值和标准差？您的样本比例的期望值是我们在访问中发现的死亡比例，显示了总体参数的无偏估计。同理，样本比例的标准差就是我们的二项随机变量<em class="mq"> Y </em>除以<em class="mq"> n </em>的标准差。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/d23f382447934d6c6518537985bab47a.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*F5iaFuu1w7qPMyPJ0bGlbg.png"/></div></figure><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="ed2a" class="na kj it mw b gy nb nc l nd ne">print('Empirically calculated expected value: {}'.format(np.mean(np.mean(Y, axis=1))))<br/>print('Theoretical expected value: {}'.format(p))</span><span id="d4de" class="na kj it mw b gy nf nc l nd ne">Empirically calculated expected value: 0.5977399999999999<br/>Theoretical expected value: 0.6</span><span id="5cfb" class="na kj it mw b gy nf nc l nd ne">print('Empirically calculated standard deviation: {}'.format(np.std(np.mean(Y, axis=1))))<br/>print('Theoretical standard deviation: {}'.format(np.sqrt(p*(1-p)/n)))</span><span id="330e" class="na kj it mw b gy nf nc l nd ne">Empirically calculated standard deviation: 0.15472844728749785<br/>Theoretical standard deviation: 0.15491933384829668</span></pre><p id="c56a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">给你。我们得出了非常相似的值。首先，通过对随机宇宙进行10次参观旅行的大量试验。其次，通过计算这个采样分布的理论值。在本文中，我们将确切地理解为什么这两种方法会产生相似的结果。</p><h1 id="d82f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">样本比例抽样分布的正态性</h1><p id="2952" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">有两种情况可以认为抽样分布的形状近似正态。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/39e938253200905002b39d01909aaced.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*wolJXxNlknx0VbyjrdMGHg.png"/></div></figure><p id="2502" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们试一个例子。你经营一家音乐商店，每周收到100张新CD(把这些看作是随机样本)。您的供应商表示，他们交付了大约10%的摇滚CD。你计算每周样本中摇滚CD的每周比例。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="4934" class="na kj it mw b gy nb nc l nd ne">n = 100<br/>p = 0.1<br/>print(n*p)<br/>print(n*(1-p))</span><span id="1db8" class="na kj it mw b gy nf nc l nd ne">10.0<br/>90.0</span></pre><p id="700c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">条件满足。让我们画出来，看看最终的分布。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9ebd" class="na kj it mw b gy nb nc l nd ne">X = bernoulli(p)<br/>Y = [X.rvs(100) for i in range(10000)]</span><span id="7c20" class="na kj it mw b gy nf nc l nd ne">normal = np.random.normal(p*n, np.sqrt(n*p*(1-p)), (1000, ))<br/>density = stats.gaussian_kde(normal)<br/>n_, x, _ = plt.hist(normal, bins=np.linspace(0, 20, 50), <br/>                   histtype=u'step', density=True) <br/>plt.close()<br/><br/>plt.hist(np.sum(Y, axis=1), density=True)<br/>plt.plot(x, density(x));</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/fd178ed9fde87a14f05b03d95b609684.png" data-original-src="https://miro.medium.com/v2/format:webp/1*qTMD3_MY_mwkhqbex0CCLQ.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图4:摇滚CD每周抽样比例的抽样分布。</p></figure><p id="ec97" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">看起来不错，基本正常。如果收到摇滚CD的概率不是10%，而是变成了3%，会怎么样？</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="91d5" class="na kj it mw b gy nb nc l nd ne">n = 100<br/>p_ = 0.03<br/>print(n*p_)<br/>print(n*(1-p_))</span><span id="14aa" class="na kj it mw b gy nf nc l nd ne">3.0<br/>97.0</span></pre><p id="e19c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">第一个条件不满足。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7521" class="na kj it mw b gy nb nc l nd ne">X = bernoulli(p_)<br/>Y_ = [X.rvs(100) for i in range(10000)]</span><span id="456c" class="na kj it mw b gy nf nc l nd ne">normal = np.random.normal(p_*n, np.sqrt(n*p_*(1-p_)), (1000, ))<br/>density = stats.gaussian_kde(normal)<br/>n_, x, _ = plt.hist(normal, bins=np.linspace(0, 20, 50), <br/>                   histtype=u'step', density=True) <br/>plt.close()<br/><br/>plt.hist(np.sum(Y_, axis=1), density=True)<br/>plt.plot(x, density(x));</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/eb70d7aa32c8332bc04ddb6cfd99eb38.png" data-original-src="https://miro.medium.com/v2/format:webp/1*sYVvV9q7oBieYPdYddX9IA.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图5:概率为3%的Rock CDs每周抽样比例的抽样分布。</p></figure><p id="536a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">事实上，我们的分布是向右倾斜的。</p><p id="e533" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为什么这些条件很重要？当我们需要回答关于抽样比例概率的问题时，这些是相关的。比如回到我们的例子，考虑10%概率收到摇滚CD的初始信息。假设您在第一次试用时发现12%的CD是摇滚CD。假设真实比例是由您的供应商提供的，您搜索的样本中超过12%是摇滚CD的概率是多少？</p><p id="9f28" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们已经知道抽样分布是近似正态的。所以我们需要建立我们的正态分布，计算P(p&gt;0.12)。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="74fe" class="na kj it mw b gy nb nc l nd ne">print('Empirically calculated expected value: {}'.format(np.mean(np.mean(Y, axis=1))))<br/>print('Theoretical expected value: {}'.format(p))</span><span id="8c1d" class="na kj it mw b gy nf nc l nd ne">Empirically calculated expected value: 0.09973800000000001<br/>Theoretical expected value: 0.1</span><span id="e9af" class="na kj it mw b gy nf nc l nd ne">print('Empirically calculated standard deviation: {}'.format(np.std(np.mean(Y, axis=1))))<br/>print('Theoretical standard deviation: {}'.format(np.sqrt(p*(1-p)/n)))</span><span id="ebff" class="na kj it mw b gy nf nc l nd ne">Empirically calculated standard deviation: 0.029996189024607777<br/>Theoretical standard deviation: 0.030000000000000002</span><span id="ee05" class="na kj it mw b gy nf nc l nd ne">n = 100<br/>p = 0.10<br/>p_ = 0.12<br/>print(f'P(p&gt;0.12)={1-norm.cdf(p_, p, np.sqrt(p*(1-p)/n))}')</span><span id="e72f" class="na kj it mw b gy nf nc l nd ne">P(p&gt;0.12)=0.252492537546923</span></pre><h1 id="f047" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">推断人口平均数</h1><p id="3e97" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在第一部分中，我们用两种不同的方法计算了在宇宙样本中发现的死亡数。第一种方法是推导出抽样比例的抽样分布的理论性质。第二种是通过使用抽样分布的统计来估计参数。在本节中，我们将更好地理解第二种方法。</p><p id="4406" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们从定义总体均值开始:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/7503dc16cbf927a69fb75eae8fb5b599.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/format:webp/1*s3XAyCG6EOySX-ya9gxeeA.png"/></div></figure><p id="44e6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">其中<em class="mq"> N </em>代表20，000个宇宙的人口规模。样本均值ȳ可以定义为，</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/2e68b7e168bd0d86ed6aff59c9ee3fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*K5d34lK60a4-56tN42WL7w.png"/></div></figure><p id="32ad" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">其中<em class="mq"> n </em>代表样本大小，或者我们从总体中抽取的一个简单随机样本，大小为10。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="c4d2" class="na kj it mw b gy nb nc l nd ne">p = 0.6<br/>n = 10<br/>X = bernoulli(p)<br/>Y = [X.rvs(n) for i in range(10000)]</span><span id="8efb" class="na kj it mw b gy nf nc l nd ne"># One random sample<br/><br/>y_bar = np.mean(Y[0])<br/>y_bar</span><span id="6e19" class="na kj it mw b gy nf nc l nd ne">0.9</span></pre><p id="62bc" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">请注意，ȳ是我们用来推断总体参数的统计数据。然而，这些可能是不同的，因为我们是从人群中随机抽取样本。</p><h1 id="f10c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">中心极限定理</h1><p id="a18c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们想得到关于中心极限定理(CLT)的直觉，然后我们将得到它的兴趣和应用。但是，首先，让我们定义一个明显的非正态分布。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="cbee" class="na kj it mw b gy nb nc l nd ne">elements = np.arange(6)<br/>probabilities = [0.3, 0., 0.05, 0.05, 0.2, 0.4]<br/>X = np.random.choice(elements, 100, p=probabilities)</span><span id="855b" class="na kj it mw b gy nf nc l nd ne">sns.histplot(X, stat='probability');</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/b5c0865772dee39a104bf036de6e97e6.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ECc6HAdwDVH-7aw8udKvlw.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图6:样本的非正态原始分布。</p></figure><p id="ee0d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，我们可以从中提取样本。我们将抽取大小为4的样本，并计算其平均值。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9e55" class="na kj it mw b gy nb nc l nd ne">s_1 = np.random.choice(elements, 4, p=probabilities)<br/>print(s_1)<br/>x_bar_1 = np.mean(s_1)<br/>print(x_bar_1)</span><span id="d90e" class="na kj it mw b gy nf nc l nd ne">[0 5 4 0]<br/>2.25</span></pre><p id="a39d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们做同样的程序一万次。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="86b0" class="na kj it mw b gy nb nc l nd ne">s = []<br/>n=4<br/>for i in range(10000):<br/>    s.append(np.random.choice(elements, n, p=probabilities))<br/>s = np.mean(np.asarray(s), axis=1)</span><span id="4d27" class="na kj it mw b gy nf nc l nd ne">print('Kurtosis: ' + str(np.round(kurtosis(s),2)))<br/>print('Skew: ' + str(np.round(skew(s),2)))<br/>print('---')<br/>print('μ=' + str(np.round(np.mean(s), 2)))<br/>print('σ=' + str(np.round(np.std(s), 2)))<br/>sns.histplot(s, stat='probability');</span><span id="890e" class="na kj it mw b gy nf nc l nd ne">Kurtosis: -0.36<br/>Skew: -0.27<br/>---<br/>μ=3.06<br/>σ=1.06</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/401d6925b62895232e03810a655de5c0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xflnTR8MKZxbU1jZrjUYHA.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图7:样本大小为4的样本均值的抽样分布。</p></figure><p id="6b0f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">上面的发行版看起来不再像我们最初的发行版了。CTL告诉我们，当你取更多的样本并计算它们的平均值时，得到的分布将接近正态分布。我们可以通过偏度和峰度的值来衡量它，对于正态分布来说，这个值应该为零。正偏态分布的尾巴在右边，而负偏态分布的尾巴在左边。如果分布有正峰度，它比正态分布有更厚的尾部；相反，在消极的情况下，尾巴会更细。</p><p id="109f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">CLT还告诉我们，随着样本量的增加，近似值会变得更好。因此，让我们通过将样本量从4增加到20，然后增加到100来测试它。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="dc31" class="na kj it mw b gy nb nc l nd ne">s = []<br/>n=20<br/>for i in range(10000):<br/>    s.append(np.random.choice(elements, n, p=probabilities))<br/>s = np.mean(np.asarray(s), axis=1)</span><span id="4017" class="na kj it mw b gy nf nc l nd ne">print('Kurtosis: ' + str(np.round(kurtosis(s),2)))<br/>print('Skew: ' + str(np.round(skew(s),2)))<br/>print('---')<br/>print('μ=' + str(np.round(np.mean(s), 2)))<br/>print('σ=' + str(np.round(np.std(s), 2)))<br/>sns.histplot(s, stat='probability');</span><span id="8ae7" class="na kj it mw b gy nf nc l nd ne">Kurtosis: -0.1<br/>Skew: -0.09<br/>---<br/>μ=3.06<br/>σ=0.47</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/13f1dda5eee6ee724c0e19f2864a34eb.png" data-original-src="https://miro.medium.com/v2/format:webp/1*jsk7MPaWDdWymjukRzqmyg.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图8:样本大小为20的样本均值的抽样分布。</p></figure><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="e123" class="na kj it mw b gy nb nc l nd ne">s = []<br/>n=100<br/>for i in range(10000):<br/>    s.append(np.random.choice(elements, n, p=probabilities))<br/>s = np.mean(np.asarray(s), axis=1)</span><span id="685e" class="na kj it mw b gy nf nc l nd ne">print('Kurtosis: ' + str(np.round(kurtosis(s),2)))<br/>print('Skew: ' + str(np.round(skew(s),2)))<br/>print('---')<br/>print('μ=' + str(np.round(np.mean(s), 2)))<br/>print('σ=' + str(np.round(np.std(s), 2)))<br/>sns.histplot(s, stat='probability');</span><span id="f238" class="na kj it mw b gy nf nc l nd ne">Kurtosis: -0.08<br/>Skew: -0.03<br/>---<br/>μ=3.05<br/>σ=0.22</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/db8c728041e86878ef870437aa8d0f8d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*5F6ooW2h3J-7ExZE3kQp5w.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图9:样本量为100的样本均值的抽样分布。</p></figure><p id="ff90" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">注意最后一个图是如何类似于正态分布的。有一个惯例，即大于30的样本量足以近似正态分布。此外，请注意我们为不同样本量绘制的抽样分布的平均值和标准偏差值。毫不奇怪，均值与原始分布相同。但是标准差的值确实很奇怪，因为它一直在缩小。事实上，这是一个需要注意的重要性质:我们对样本均值的抽样分布的标准差是原始总体标准差除以样本容量的平方根。因此，我们可以把它写成:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/5e706280bdf0dca42feb4499f7e1c43a.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/1*shefJUfyWSjXJ1GcG7LXKg.png"/></div></figure><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="bb11" class="na kj it mw b gy nb nc l nd ne">print("Theoretical value: " + str(np.sqrt(X.var()/n)))<br/>print("Empirically computed: " + str(s.std()))</span><span id="8ff8" class="na kj it mw b gy nf nc l nd ne">Theoretical value: 0.20789179878003847<br/>Empirically computed: 0.2151977077573086</span></pre><p id="8761" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这个过程并不特定于样本均值；例如，我们可以计算样本和。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="4f70" class="na kj it mw b gy nb nc l nd ne">s = []<br/>for i in range(10000):<br/>    s.append(np.random.choice(elements, 100, p=probabilities))<br/>s = np.sum(np.asarray(s), axis=1)</span><span id="ed96" class="na kj it mw b gy nf nc l nd ne">print('Kurtosis: ' + str(np.round(kurtosis(s),2)))<br/>print('Skew: ' + str(np.round(skew(s),2)))<br/>sns.histplot(s, stat='probability');</span><span id="d69a" class="na kj it mw b gy nf nc l nd ne">Kurtosis: -0.04<br/>Skew: -0.02</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/0b8aee0d7a4e7ef07d052b53824a9c14.png" data-original-src="https://miro.medium.com/v2/format:webp/1*5HslEZxygVqxHM6AK4hmfA.png"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">图9:样本总数为100的样本的抽样分布。</p></figure><p id="c3ea" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我希望现在你明白为什么正态分布经常被用来模拟不同的过程。即使您不知道您想要以统计方式描述的过程的分布，如果您添加或取您的测量值的平均值(假设它们都具有相同的分布)，您会突然得到一个正态分布。</p><h1 id="bf5d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="8d72" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们在这篇文章中面临的问题是总体参数的估计。通常我们不能收集足够的数据来代表整个人口，因此，我们需要找到另一种方法来估计其参数。我们探索的方法是从人群中随机抽取样本。从随机样本中，我们计算统计量，然后用它来推断总体的参数。我们研究了抽样比例的抽样分布和样本均值的抽样分布。</p><p id="180a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们还探索了CLT。它告诉我们，独立于我们想要统计描述的过程的原始分布的形状，对于大于30的样本大小，从该原始分布获得的样本的平均值或总和将接近正态分布。</p><p id="3951" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">保持联系:<a class="ae mk" href="https://www.linkedin.com/in/luisbrasroque/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><h1 id="668f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">练习</h1><p id="a9ea" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">你将在下周的文章中找到答案。</p><ol class=""><li id="340a" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv oc mh mi mj bi translated">里克在一个遥远的星球上对75名公民进行了SRS调查，以了解抽样调查的公民中有多少人对自己的生活水平感到满意。假设生活在这个星球上的10亿公民中有60%对自己的生活水平感到满意。对自己的生活水平感到满意的公民比例的抽样分布的均值和标准差是多少？</li><li id="e227" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv oc mh mi mj bi translated">某个拥有超过1，000，000个家庭的星球的平均家庭收入为1，000，000美元，标准差为150，000美元。Rick计划随机抽取700个家庭样本，计算样本平均收入。然后，计算样本均值的抽样分布的均值和标准差。</li><li id="510b" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv oc mh mi mj bi translated">Rick正在对不同的入口枪进行质量控制测试，因为在制造过程中存在一些可变性。比如某枪，目标厚度5mm。厚度分布向右倾斜，平均值为5毫米，标准偏差为1毫米。该零件的质量控制检查包括随机抽取35个点，并计算这些点的平均厚度。样本平均厚度的抽样分布是什么形状？样品中的平均厚度在目标值0.2毫米以内的概率是多少？</li></ol><h2 id="274f" class="na kj it bd kk od oe dn ko of og dp ks lj oh oi ku ln oj ok kw lr ol om ky on bi translated">上周的答案</h2><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="cbc5" class="na kj it mw b gy nb nc l nd ne">def geomcdf_1(p, x):<br/>    # implementing first approach<br/>    prob = 0<br/>    for i in range(x-1):<br/>        prob+=p*(1-p)**i<br/>    return prob</span><span id="eadb" class="na kj it mw b gy nf nc l nd ne">def geomcdf_2(p, x):<br/>    # implementing second approach<br/>    prob = 1-(1-p)**(x-1)<br/>    return prob</span></pre><ol class=""><li id="f064" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv oc mh mi mj bi translated">你有一副标准的牌，你在挑选牌，直到你得到一张女王(如果他们不是女王，你替换他们)。你需要挑5张牌的概率是多少？而不到10？而且超过12个？</li></ol><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7daa" class="na kj it mw b gy nb nc l nd ne"># Exactly 5<br/><br/>p = 4/52<br/><br/>p**1*(1-p)**4</span><span id="b5ab" class="na kj it mw b gy nf nc l nd ne">0.055848076855744666</span><span id="8dd2" class="na kj it mw b gy nf nc l nd ne"># Less than 10<br/><br/>geomcdf_2(p, 10)</span><span id="9d19" class="na kj it mw b gy nf nc l nd ne">0.5134348005963145</span><span id="6799" class="na kj it mw b gy nf nc l nd ne"># More than 12<br/><br/>1 - geomcdf_2(p, 13)</span><span id="1cdb" class="na kj it mw b gy nf nc l nd ne">0.3826967066770909</span></pre><p id="cadf" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">2.Jorge对冰柜进行检查。他发现94%的冰柜成功通过了检查。设C为Jorge检查的冷冻箱数量，直到一个冷冻箱未通过检查。假设每次检查的结果都是独立的。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="8125" class="na kj it mw b gy nb nc l nd ne"># Our probability of success is actually the probability of failing the inspection<br/><br/>p=1-0.94<br/>p**1*(1-p)**4</span><span id="2b56" class="na kj it mw b gy nf nc l nd ne">0.04684493760000003</span></pre><p id="4ee7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">3.佩德罗罚球命中率为25%。作为热身，佩德罗喜欢罚任意球，直到他罚进为止。设M为佩德罗第一次任意球射门的次数。假设每个镜头的结果是独立的。找出佩德罗第一次投篮不到4次的概率。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="096a" class="na kj it mw b gy nb nc l nd ne">p=0.25<br/><br/># We can use our two functions<br/><br/>geomcdf_2(p, 4)</span><span id="35d1" class="na kj it mw b gy nf nc l nd ne">0.578125</span><span id="aa6b" class="na kj it mw b gy nf nc l nd ne">geomcdf_1(p, 4)</span><span id="28be" class="na kj it mw b gy nf nc l nd ne">0.578125</span><span id="c54c" class="na kj it mw b gy nf nc l nd ne"># which are computing<br/><br/>1-0.75**3</span><span id="ae81" class="na kj it mw b gy nf nc l nd ne">0.578125</span><span id="fbbb" class="na kj it mw b gy nf nc l nd ne"># and<br/><br/>0.25+0.25*0.75+0.25*0.75**2</span><span id="bdab" class="na kj it mw b gy nf nc l nd ne">0.578125</span></pre><p id="d150" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">4.构建一个计算泊松PMF的函数，除了使用来自<code class="fe oo op oq mw b">numpy</code>的<code class="fe oo op oq mw b">np.exp</code>之外，不使用任何来自外部包的函数。选择一些参数，并将您的结果与<code class="fe oo op oq mw b">scipy</code>中的<code class="fe oo op oq mw b">pmf</code>函数进行比较。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="11bb" class="na kj it mw b gy nb nc l nd ne">def fact(k):<br/>    k_ = 1<br/>    for i in range(1, k+1):<br/>        k_ *= i<br/>    return k_</span><span id="ebe8" class="na kj it mw b gy nf nc l nd ne">def poisson_pmf(k, λ):<br/>    return np.exp(-λ)*λ**k/fact(k)</span><span id="d7c0" class="na kj it mw b gy nf nc l nd ne">poisson_pmf(1, 2)</span><span id="de29" class="na kj it mw b gy nf nc l nd ne">0.2706705664732254</span><span id="3346" class="na kj it mw b gy nf nc l nd ne">poisson.pmf(1, 2)</span><span id="d38b" class="na kj it mw b gy nf nc l nd ne">0.2706705664732254</span></pre><p id="538f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">5.构建一个计算泊松CDF的函数，而不使用任何外部包。选择一些参数，并将您的结果与<code class="fe oo op oq mw b">scipy</code>中的<code class="fe oo op oq mw b">cdf</code>函数进行比较。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="17da" class="na kj it mw b gy nb nc l nd ne">def poisson_cdf(x, λ):<br/>    p = []<br/>    for i in range(x+1):<br/>        p.append(poisson_pmf(i, λ))<br/>    return sum(p)</span><span id="c642" class="na kj it mw b gy nf nc l nd ne">poisson_cdf(2, 2)</span><span id="c3c1" class="na kj it mw b gy nf nc l nd ne">0.6766764161830635</span><span id="805d" class="na kj it mw b gy nf nc l nd ne">poisson.cdf(2, 2)</span><span id="5731" class="na kj it mw b gy nf nc l nd ne">0.6766764161830634</span></pre></div></div>    
</body>
</html>