<html>
<head>
<title>Neural Network Collaborative Filtering with Amazon Book Reviews</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊书评的神经网络协同过滤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/neural-network-collaborative-filtering-with-amazon-book-reviews-c50a919a84a7?source=collection_archive---------21-----------------------#2021-12-15">https://towardsdatascience.com/neural-network-collaborative-filtering-with-amazon-book-reviews-c50a919a84a7?source=collection_archive---------21-----------------------#2021-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ec08" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在我的项目中，我用亚马逊评论数据构建了一个图书推荐系统。</h2></div><p id="1a7d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个项目的目的是通过分析亚马逊评论并使用 Tensorflow 和 Keras 开发神经网络模型来创建一个<strong class="kh ir">协同过滤图书推荐系统。</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/e96d7b36ca56c070d4b51ba743d50f46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1A49yhi2IptNZd-BRzigQ.jpeg"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图片由<a class="ae lr" href="https://unsplash.com/@readerpreneur" rel="noopener ugc nofollow" target="_blank"> Shiromani Kant </a>在<a class="ae lr" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="6a6a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">TL；博士:</strong></p><ul class=""><li id="f6e6" class="ls lt iq kh b ki kj kl km ko lu ks lv kw lw la lx ly lz ma bi translated">从亚马逊评论数据集<strong class="kh ir"> </strong> <a class="ae lr" href="https://nijianmo.github.io/amazon/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">中检索亚马逊评论数据(2018) </strong> </a></li><li id="3e58" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">在图书上应用<strong class="kh ir">情感分析</strong></li><li id="b516" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated">已创建<strong class="kh ir"> SVD 嵌入</strong></li><li id="42ff" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated"><strong class="kh ir">tensor flow/Keras 构建的神经网络</strong>协同过滤</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="0ec3" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">一.背景</h1><p id="dc9f" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">推荐系统是企业用来帮助客户匹配他们可能接触的产品的有用工具。如果开发得当，这些系统非常强大，可以直接提高公司吸引用户的能力。协同过滤是一种通过分析具有相似品味的其他用户的偏好来预测用户偏好的方法。有不同类型的协同过滤系统，这个<a class="ae lr" rel="noopener" target="_blank" href="/various-implementations-of-collaborative-filtering-100385c6dfe0">参考</a>解释得很好。</p><p id="b1b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">传统的协同过滤模型容易出现欠拟合，这导致它们在向用户推荐时有较高的误差。随着神经网络变得越来越流行，它们非常适合为推荐系统创建高度自适应的模型。构建神经网络协同过滤模型的指南并不多，因此我在本文中着手帮助演示这一点。</p><h1 id="0418" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">二。数据集</h1><p id="6d83" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">我们的数据集是从 UCSD【1】收集的<a class="ae lr" href="https://nijianmo.github.io/amazon/index.html" rel="noopener ugc nofollow" target="_blank">存储库中加载的。该知识库是通过抓取数百万亚马逊页面创建的，因此它是亚马逊评论和产品评级的非常全面的集合。这些数据在很多方面都很有用，非常适合构建一个推荐系统。原始文件非常大，所以我选择只选择有 5 个或更多评论的</a><a class="ae lr" href="http://deepyeti.ucsd.edu/jianmo/amazon/categoryFilesSmall/Books_5.json.gz" rel="noopener ugc nofollow" target="_blank">书</a>(仍然是一个非常大的文件— 27，164，983 个评论)。</p><p id="816b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">理论上，我们可以创建一个适合所有 27，164，983 条评论的协同过滤模型，但这将导致长时间的训练和低质量的嵌入，因为用户-图书矩阵非常稀疏。所以为了克服这一点，模型只选择了评论超过 100 的书籍和用户。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi np"><img src="../Images/2f9cec9b913680f89f9d9cc5e48ba509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*t2_TwFVZWgptSk4lGOoIkw.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">来自亚马逊评论数据集的评论数据</p></figure><p id="0e3d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据集包含. json 格式的上述信息。Pandas 可用于加载和结构化数据，但它需要成块加载，如下所示:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h1 id="846f" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">三。情感分析</h1><p id="342b" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">情感分析是一个复杂的过程。NLTK (Vader)和 Textblob 等很多包都是基于规则的情感分析包，速度快，简单明了，但是不分析数据中任何更深层次的模式。当涉及到持续分析我们数据集中评论的情绪时，他们很难做到。</p><p id="d1ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Flair 是一个强大的自然语言处理工具包，它使用预先训练的模型来预测文本情感。它在亚马逊评论数据上工作得非常好，所以 Flair 是获得所有用户图书评论的情感值的明确选择。唯一的缺点是运行时间，因为 Flair 的运行时间要长得多。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="36df" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为 Flair 包更像是一个逻辑分类器，所以我必须使用一些 QuantileTransformers 来转换变量，以便为我们的模型正确地缩放目标变量。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h1 id="37c3" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">四。模型</h1><p id="e195" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">我们模型的起点是用户手册矩阵。它是我们原始数据集的数据透视表，每行代表一个唯一的用户，每列代表一本书。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ns"><img src="../Images/fbbfba46360f2e0cb418c266e35bf5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gaolOdAU4z-i6jbCppNvMg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">从用户手册矩阵到嵌入(图片由作者提供)</p></figure><p id="f5ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从用户手册矩阵中，可以创建嵌入，这是我们建模的基础。<strong class="kh ir">嵌入是表示数据集中要素的矢量。例如，在我们的例子中，嵌入可以代表书籍的流派、主题、长度、风格或者两者的某种组合</strong>。嵌入不能被明确地定义，所以我们永远无法确切地知道它们是什么，但是这是一个思考它们的好方法。</p><p id="ec3b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里了解更多关于嵌入的信息:<a class="ae lr" rel="noopener" target="_blank" href="/structured-deep-learning-b8ca4138b848">Kerem Turgutlu 的结构化深度学习</a></p><h2 id="8407" class="nt mo iq bd mp nu nv dn mt nw nx dp mx ko ny nz mz ks oa ob nb kw oc od nd oe bi translated">一.矩阵分解方法</h2><p id="d2f3" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">简单的矩阵分解包括两个步骤:</p><ul class=""><li id="0097" class="ls lt iq kh b ki kj kl km ko lu ks lv kw lw la lx ly lz ma bi translated">将初始用户手册矩阵分解成嵌入(在我们的例子中，我们将使用 64 个单元嵌入)</li><li id="7352" class="ls lt iq kh b ki mb kl mc ko md ks me kw mf la lx ly lz ma bi translated"><em class="of">用户嵌入向量</em>和<em class="of">图书嵌入向量</em>的加权点积，得到预测的情感得分。</li></ul><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi og"><img src="../Images/0dff3a523eb5cb67bdce7a9d355b5b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YReGyZ8qIbg5sOu4dT-qmQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">矩阵分解法(图片由作者提供)</p></figure><p id="4787" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">矩阵分解方法的实现如下所示。我用 scipy 将<code class="fe oh oi oj ok b">user_book_matrix</code>分解成两个嵌入矩阵，<code class="fe oh oi oj ok b">user_embed_df</code>和<code class="fe oh oi oj ok b">book_embed_df</code>。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="7cee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然这种方法快速而直接，但它在用户嵌入向量和书籍嵌入向量可以预测评论情感的程度方面有所限制。我们得到的 RMSE 是 0.131，这是可以改进的。</p><h2 id="8073" class="nt mo iq bd mp nu nv dn mt nw nx dp mx ko ny nz mz ks oa ob nb kw oc od nd oe bi translated">二。神经网络方法</h2><p id="921d" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">为了改进我们模型的拟合，需要额外的建模来改进简单矩阵分解的局限性。矩阵分解很快，但是它的适应性不足以解释用户嵌入和图书嵌入如何相互作用的复杂性。</p><p id="17ec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于神经网络来说，这是一个完美的问题，我使用 Tensorflow 和 Keras 建立了一个模型来完成这一任务。如下图所示的神经网络有 3，050，337 个可训练的权重，这些权重中的每一个都可以被训练，这样神经网络就可以充分地考虑任何可能与我们的嵌入发生的复杂交互。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ol"><img src="../Images/ea5dd83ea4da1772089746d6dfd1b7f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rb6BZcQYS7ekq76jvNsjgQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">神经网络方法(图片由作者提供)</p></figure><p id="31f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的神经网络结构包含 2048、1024、512、256、64 和 16 个单元的密集层。我们为<code class="fe oh oi oj ok b">epochs = 100</code>训练模型，使用<code class="fe oh oi oj ok b">batch_size = 64</code>。使用 RTX 2060 图形处理器，训练只花了大约 5 分钟。大多数 CPU 应该能够相当容易地处理这个问题。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="35e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型有脱落层和批量标准化层，以防止过拟合。我还使用了 optimizer = 'adam '，loss = 'mean_squared_error '，并添加了' mean_absolute_error '作为要跟踪的附加损失变量。我们在验证数据集上的 MSE 是 0.07，这是对矩阵分解模型的显著改进。</p><h2 id="38b3" class="nt mo iq bd mp nu nv dn mt nw nx dp mx ko ny nz mz ks oa ob nb kw oc od nd oe bi translated">三。比较</h2><p id="069f" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">让我们在用户身上尝试我们的神经网络模型，看看他们的表现如何:</p><h2 id="2f06" class="nt mo iq bd mp nu nv dn mt nw nx dp mx ko ny nz mz ks oa ob nb kw oc od nd oe bi translated">约翰·史密斯(阅读数据集中的 53 本书)</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi om"><img src="../Images/7b6bdb080e79cc188b34b79ef11384e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEMwqCGUJP0oIU5ZkOc-Nw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><p id="b6c4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对约翰·史密斯来说，他最好的书是关于历史、战争和政治的书籍。根据我们的情感分析，这些书是约翰留下最积极评价的。推荐的书籍似乎符合他的口味，符合历史、传教士故事和移民的体裁。这些书是我们的神经网络模型预测得分最高的书。</p><p id="4d71" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">推荐者推荐了丹尼尔·席尔瓦的《黑寡妇》,这部小说更像是一部惊悚小说。这似乎有点超出了约翰所习惯的范围，但是，嘿，也许他会喜欢的！</p><p id="db63" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">似乎我们的模型工作得相当好！仍有改进的空间，如进一步开发模型，或调整数据准备过程。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="2266" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有代码和笔记都可以在我的<a class="ae lr" href="https://github.com/kenhua15/Metis-Projects/tree/master/5%20-%20amazon_recommendation_system" rel="noopener ugc nofollow" target="_blank"> github 页面这里</a>找到。感谢您的阅读，希望对您有所帮助！任何反馈也非常感谢。</p><h2 id="730f" class="nt mo iq bd mp nu nv dn mt nw nx dp mx ko ny nz mz ks oa ob nb kw oc od nd oe bi translated">引用:</h2><p id="ed25" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">[1]简墨倪，，朱利安·麦考利，<a class="ae lr" href="https://cseweb.ucsd.edu//~jmcauley/pdfs/emnlp19a.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"/></a>【2019】<em class="of">【自然语言处理中的经验方法】</em></p></div></div>    
</body>
</html>