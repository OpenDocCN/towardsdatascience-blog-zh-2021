<html>
<head>
<title>How To Apply a Function To Columns in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对Pandas中的列应用函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/apply-function-to-columns-in-pandas-60b01c41c485?source=collection_archive---------7-----------------------#2021-09-25">https://towardsdatascience.com/apply-function-to-columns-in-pandas-60b01c41c485?source=collection_archive---------7-----------------------#2021-09-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="8c94" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">讨论在对pandas列应用函数时何时使用apply()或map()，以及如何更有效地执行</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e00200f6dc4ea32bcb33726d85b54fe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8sgNI7FjXbejvo1OK2PYQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@mcarsience_photography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Meagan car science</a>在<a class="ae kz" href="https://unsplash.com/s/photos/transform?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="56a7" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="72b7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当涉及到数据转换时，对pandas列应用特定的函数是一种非常常见的方法。在今天的简短指南中，我们将讨论如何对pandas数据帧中的一列或多列应用预定义函数或lambda函数。</p><p id="971c" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，我们将讨论如何实现最佳性能，以及为什么在对多个列应用一个方法时使用<code class="fe mu mv mw mx b">apply() </code>方法更好，而在只处理一个列时使用<code class="fe mu mv mw mx b">map()</code>方法更好。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="6b66" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们创建一个示例数据框架，我们将在本文中引用它来演示一些概念。</p><pre class="kk kl km kn gu nf mx ng nh aw ni bi"><span id="498a" class="la lb iu mx b gz nj nk l nl nm">import pandas as pd</span><span id="2cf7" class="la lb iu mx b gz nn nk l nl nm">df = pd.DataFrame({<br/>    'colA': [1, 2, 3, 4, 5],<br/>    'colB': [True, False, None, False, True],<br/>    'colC': ['a', 'b', 'c', 'd', 'e'],<br/>    'colD': [1.0, 2.0, 3.0, 4.0, 5.0]<br/>})</span><span id="e95d" class="la lb iu mx b gz nn nk l nl nm">print(df)<br/>   <em class="no">colA   colB colC  colD<br/>0     1   True    a   1.0<br/>1     2  False    b   2.0<br/>2     3   None    c   3.0<br/>3     4  False    d   4.0<br/>4     5   True    e   5.0</em></span></pre><p id="5e5b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，让我们假设我们想给列<code class="fe mu mv mw mx b">colA</code>下的每个值加1。这可以使用lambda表达式轻松完成</p><pre class="kk kl km kn gu nf mx ng nh aw ni bi"><span id="5e01" class="la lb iu mx b gz nj nk l nl nm">lambda x: x + 1</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="1e0b" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">对单个列应用函数</h2><p id="39e0" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">如果您想只对一列应用函数，那么<code class="fe mu mv mw mx b">map()</code>是最好的选择。</p><pre class="kk kl km kn gu nf mx ng nh aw ni bi"><span id="d30d" class="la lb iu mx b gz nj nk l nl nm"><strong class="mx iv">df['colA'] = df['colA'].map(</strong><strong class="mx iv">lambda x: x + 1</strong><strong class="mx iv">)</strong></span><span id="d5c4" class="la lb iu mx b gz nn nk l nl nm">print(df)<br/><em class="no">   </em><strong class="mx iv"><em class="no">colA</em></strong><em class="no">   colB colC  colD<br/>0     </em><strong class="mx iv"><em class="no">2</em></strong><em class="no">   True    a   1.0<br/>1     </em><strong class="mx iv"><em class="no">3</em></strong><em class="no">  False    b   2.0<br/>2     </em><strong class="mx iv"><em class="no">4</em></strong><em class="no">   None    c   3.0<br/>3     </em><strong class="mx iv"><em class="no">5</em></strong><em class="no">  False    d   4.0<br/>4     </em><strong class="mx iv"><em class="no">6</em></strong><em class="no">   True    e   5.0</em></span></pre><p id="20ed" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">您也可以使用<code class="fe mu mv mw mx b">apply()</code>方法，但是在对单个列应用方法时，<code class="fe mu mv mw mx b"><strong class="ly iv">map()</strong></code> <strong class="ly iv">更有效。</strong> <code class="fe mu mv mw mx b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.map.html" rel="noopener ugc nofollow" target="_blank"><strong class="ly iv">pandas.Series.map(</strong></a><strong class="ly iv">)</strong></code> <strong class="ly iv">方法对</strong> <code class="fe mu mv mw mx b"><strong class="ly iv">Series</strong></code> <strong class="ly iv">(即数据帧的单列)进行操作，一次操作一个单元格</strong>。另一方面，<code class="fe mu mv mw mx b">pandas.DataFrame.apply()</code>一次对整行进行操作。因此，使用<code class="fe mu mv mw mx b">map()</code>会更有效，因为您只需要访问特定列的值(而不是整行的值)。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="1ebf" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">将函数应用于多列</h2><p id="983f" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">另一方面，在需要对多个列应用某个函数的场合，那么您可能应该使用<code class="fe mu mv mw mx b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html" rel="noopener ugc nofollow" target="_blank">pandas.DataFrame.apply()</a></code>方法。例如，假设我们需要对列<code class="fe mu mv mw mx b">colA</code>和<code class="fe mu mv mw mx b">colD</code>应用lambda函数<code class="fe mu mv mw mx b">lambda x: x + 1</code>。以下内容应该可以解决问题:</p><pre class="kk kl km kn gu nf mx ng nh aw ni bi"><span id="3518" class="la lb iu mx b gz nj nk l nl nm"><strong class="mx iv">df[['colA', 'colD']] = df[['colA', 'colD']].apply(</strong><strong class="mx iv">lambda x: x + 1</strong><strong class="mx iv">)</strong></span><span id="5422" class="la lb iu mx b gz nn nk l nl nm">print(df)<br/><em class="no">   </em><strong class="mx iv"><em class="no">colA</em></strong><em class="no">   colB colC  </em><strong class="mx iv"><em class="no">colD</em></strong><em class="no"><br/>0     </em><strong class="mx iv"><em class="no">2</em></strong><em class="no">   True    a   </em><strong class="mx iv"><em class="no">2.0</em></strong><em class="no"><br/>1     </em><strong class="mx iv"><em class="no">3</em></strong><em class="no">  False    b   </em><strong class="mx iv"><em class="no">3.0</em></strong><em class="no"><br/>2     </em><strong class="mx iv"><em class="no">4</em></strong><em class="no">   None    c   </em><strong class="mx iv"><em class="no">4.0</em></strong><em class="no"><br/>3     </em><strong class="mx iv"><em class="no">5</em></strong><em class="no">  False    d   </em><strong class="mx iv"><em class="no">5.0</em></strong><em class="no"><br/>4     </em><strong class="mx iv"><em class="no">6</em></strong><em class="no">   True    e   </em><strong class="mx iv"><em class="no">6.0</em></strong></span></pre><p id="a94c" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在这种情况下，<code class="fe mu mv mw mx b">map()</code>方法不能使用，因为它应该只在<code class="fe mu mv mw mx b">Series</code>对象上操作(即在单个列上)。<code class="fe mu mv mw mx b">apply()</code>方法将对整行应用指定的lambda函数，在本例中，整行由列<code class="fe mu mv mw mx b">colA</code>和<code class="fe mu mv mw mx b">colD</code>中的值组成。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短指南中，我们讨论了如何在pandas中对列应用特定的函数。此外，我们探讨了为什么在将一个方法应用于单个列时使用<code class="fe mu mv mw mx b">map()</code>方法很重要，而<code class="fe mu mv mw mx b">apply()</code>应该只在处理多个列时使用。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。</strong></p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="np nq gq gs nr ns"><a rel="noopener follow" target="_blank" href="/how-to-efficiently-convert-a-pyspark-dataframe-to-pandas-8bda2c3875c3"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">加快PySpark和Pandas数据帧之间的转换</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">将大火花数据帧转换为熊猫时节省时间</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/dynamic-typing-in-python-307f7c22b24e"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">Python中的动态类型</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">探索Python中对象引用的工作方式</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/mastering-indexing-and-slicing-in-python-443e23457125"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">掌握Python中的索引和切片</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">深入研究有序集合的索引和切片</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og kt ns"/></div></div></a></div></div></div>    
</body>
</html>