<html>
<head>
<title>Gradsflow — Democratizing AI with AutoML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">grads flow——用AutoML使人工智能民主化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gradsflow-democratizing-ai-with-automl-9a8a75d6b7ea?source=collection_archive---------19-----------------------#2021-10-06">https://towardsdatascience.com/gradsflow-democratizing-ai-with-automl-9a8a75d6b7ea?source=collection_archive---------19-----------------------#2021-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2cac" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">GradsFlow是一个基于PyTorch的开源AutoML &amp; Model训练库。我们的目标是使人工智能民主化，让每个人都可以使用它。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f31b8d906954c6c3b58e359b15b1e71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oTsNi8sBEOsOlIkTaJdFA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="bfbf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Gradsflow可以在你的笔记本电脑上自动训练不同任务的深度学习模型，或者直接从你的笔记本电脑上训练到远程集群。它提供了一个强大且易于扩展的<a class="ae lr" href="https://docs.gradsflow.com/en/latest/gradsflow/models/model/" rel="noopener ugc nofollow" target="_blank">模型训练API </a>，可以用来训练几乎任何PyTorch模型。</p><h1 id="9a97" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">谁应该使用Gradsflow</h1><h2 id="605c" class="mk lt iq bd lu ml mm dn ly mn mo dp mc le mp mq me li mr ms mg lm mt mu mi mv bi translated">你是没有机器学习经验的人吗？</h2><p id="17d8" class="pw-post-body-paragraph kv kw iq kx b ky mw jr la lb mx ju ld le my lg lh li mz lk ll lm na lo lp lq ij bi translated">你可以使用<a class="ae lr" href="https://docs.gradsflow.com/en/latest/gradsflow/tasks/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">自动任务</strong> </a>功能来自动构建和训练模型，而无需编写任何跨包括视觉和文本在内的各个领域的机器学习代码。目前，它支持图像分类、文本分类、情感分析和文本摘要。只需转储数据，就可以开始训练模型了。</p><h2 id="06b6" class="mk lt iq bd lu ml mm dn ly mn mo dp mc le mp mq me li mr ms mg lm mt mu mi mv bi translated">你是ML专家吗？</h2><p id="ea99" class="pw-post-body-paragraph kv kw iq kx b ky mw jr la lb mx ju ld le my lg lh li mz lk ll lm na lo lp lq ij bi translated">使用Gradsflow，您不仅可以自动构建和训练模型，还可以编写和训练自定义PyTorch模型。它提供了一个功能强大、易于使用且易于扩展的<a class="ae lr" href="https://docs.gradsflow.com/en/latest/gradsflow/models/model/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">模型</strong> </a> <strong class="kx ir"> </strong>类，可用于训练任何自定义PyTorch模型。你不需要写一个训练循环，但是如果有必要，你可以定制训练过程的任何部分。继续阅读，了解更多关于模型API的知识。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><blockquote class="ni"><p id="8a2f" class="nj nk iq bd nl nm nn no np nq nr lq dk translated">让我们不要浪费时间去看神奇的🪄✨吧</p></blockquote><h1 id="6420" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw ns jx me jz nt ka mg kc nu kd mi mj bi translated">模型训练API</h1><p id="f822" class="pw-post-body-paragraph kv kw iq kx b ky mw jr la lb mx ju ld le my lg lh li mz lk ll lm na lo lp lq ij bi translated">Gradsflow为模型训练提供了一个类似Keras的API接口。您可以将PyTorch模型传递给<a class="ae lr" href="https://docs.gradsflow.com/en/latest/gradsflow/models/model/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="nv">Model</em></strong></a>类，该类会自动准备您的模型，以便将其移动到适当的设备(CPU/CUDA)，启用浮点精度或分布式训练。一旦从模型类中创建了一个对象，就可以编译模型来实例化优化器、学习率、损失函数和准确性或F1分数等指标。现在，要训练你的模型，只需运行<em class="nv"> model.fit(data_loader)。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/3064fd62e7ec26ab0e2d2beb9ebdc470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AlLBeY_GeCbxAh-k"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e5dd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">模型API不仅简单，而且完全可定制。为了训练Pix2Pix GAN，你可能需要定制<strong class="kx ir">训练步骤</strong>和模型初始化。这很容易做到，也很简单。在下面的例子中，为了保持简单，大部分代码都被抽象了，但是如果你想更深入地研究，那么请到我们的<a class="ae lr" href="https://docs.gradsflow.com" rel="noopener ugc nofollow" target="_blank">文档</a>页面的示例部分，学习使用Gradsflow进行Pix2Pix训练的全部代码。</p><p id="a8c1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，您可以定制<em class="nv"> __init__ </em>方法来覆盖模型初始化。这里创建了两个模型——一个<a class="ae lr" href="https://developers.google.com/machine-learning/gan/generator" rel="noopener ugc nofollow" target="_blank">生成器</a>和一个<a class="ae lr" href="https://developers.google.com/machine-learning/gan/discriminator" rel="noopener ugc nofollow" target="_blank">鉴别器</a>，然后使用super关键字将模型传递给父<em class="nv"> __init__ </em>方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/5b8669d12c9e1a8fa2b931f192b17811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5_S_6IZ2r1PtxEAl1VmoQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="43ac" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，您可以定义自己的<em class="nv">编译</em>方法来加载优化器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/51d396c2e73c0486911919105351cdd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2pCH9UhyxBx-mk-aSge8Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="ed5e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，覆盖<em class="nv"> train_step </em>方法。这是数据通过模型的方法，您可以计算反向传播的损失。在这里，您可以看到生成器和鉴别器都经过了训练和反向传播。要跟踪和打印指标，您可以使用<a class="ae lr" href="https://docs.gradsflow.com/en/latest/gradsflow/models/tracker/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">跟踪器</strong> </a>，它保存打印到进度条的值，或在任何其他时间点使用它，如提前停止回调。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/9441053bd467f4c7fbbb4526511720c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6dbTqpClcw-DeKXGROjJdQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="88d7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，像往常一样，初始化模型，编译它，然后调用<strong class="kx ir"> model.fit </strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/252d0c70768741154cc58f3f1b133a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_hcb971KJSa7lR6VZtybg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="e4dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如需更多定制示例，请访问文档页面。</p><h1 id="3123" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">AutoML或超参数优化在哪里？</h1><p id="b676" class="pw-post-body-paragraph kv kw iq kx b ky mw jr la lb mx ju ld le my lg lh li mz lk ll lm na lo lp lq ij bi translated">有两种方法可以在Gradsflow中构建和调整您的模型超参数。</p><p id="f6d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Gradsflow提供了一个<a class="ae lr" href="https://docs.gradsflow.com/en/latest/gradsflow/tuner/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> AutoModel </strong> </a>类(实验性的🚨)这和你刚才看到的<em class="nv">型</em>级很像。您可以使用<em class="nv"> Tuner </em>类注册想要调整的超参数，只需对代码进行最少的更改，您就可以使用超参数优化模式训练您的模型。</p><p id="ff5d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本例中，调谐器将针对<em class="nv"> cnn1 </em>和<em class="nv"> cnn2 </em>架构以及<em class="nv"> adam </em>和<em class="nv"> SGD </em>优化器进行优化。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/33c7edf3a51942e7578725852a66239a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZnMwyjK43z256bRYbuJvA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1068" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是如何使用Model和AutoModel类进行超参数调优。</p><p id="503d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">另一种自动建立和训练模型的方法是<a class="ae lr" href="https://docs.gradsflow.com/en/latest/gradsflow/tasks/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"/></a>。Autotask为图像分类、文本分类&amp;文本摘要等各种任务提供低代码模型构建和训练类。它由<a class="ae lr" href="https://lightning-flash.readthedocs.io/en/latest/#lightning-flash" rel="noopener ugc nofollow" target="_blank"> PyTorch闪电</a>供电。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/8add6a164cb50e32d34ebb20397c36f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fd9voOh8VBIPmn7lCUYmmA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="4f0f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">奖金</h1><p id="6c5a" class="pw-post-body-paragraph kv kw iq kx b ky mw jr la lb mx ju ld le my lg lh li mz lk ll lm na lo lp lq ij bi translated">在2021年的黑客啤酒节上找到我的演讲🎉</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="4f19" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">📚要了解更多关于Gradsflow的信息，您可以访问文档页面<a class="ae lr" href="https://docs.gradsflow.com/en/latest/" rel="noopener ugc nofollow" target="_blank">https://docs.gradsflow.com/en/latest</a>。你可以找到用于训练自动图像分类、自动文本摘要、Pix2Pix GAN训练和HuggingFace模型训练的例子。</p><p id="0c46" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">🙏🏻Gradsflow从API中获得灵感，并利用一些优秀的开源软件库，包括Ray️、HuggingFace Accelerate、PyTorch Lightning TorchMetrics、Keras &amp; fast.ai</p><p id="28be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">🌟喜欢这个项目？在<a class="ae lr" href="https://github.com/gradsflow/gradsflow/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上给我们一颗星</p><p id="4012" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有问题吗？加入我们的松弛社区<a class="ae lr" href="https://join.slack.com/t/gradsflow/shared_invite/zt-ulc0m0ef-xstzyowuTgYceVmFbJlBmg" rel="noopener ugc nofollow" target="_blank">🧡和我们一起聊天。</a></p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="8bc0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<a class="ae lr" href="https://twitter.com/aniketmaurya" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae lr" href="https://linkedin.com/in/aniketmaurya" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我。</p></div></div>    
</body>
</html>