<html>
<head>
<title>Fraud Detection with Graph Analytics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用图形分析进行欺诈检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fraud-detection-with-graph-analytics-2678e817b69e?source=collection_archive---------5-----------------------#2021-07-11">https://towardsdatascience.com/fraud-detection-with-graph-analytics-2678e817b69e?source=collection_archive---------5-----------------------#2021-07-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/4671400e19219c54807ce14fecaacec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m2x3opnWVVHWCizFhoLo8A.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="332e" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">利用用例的网络结构提高预测性能</h2></div><p id="c056" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi lp translated"><span class="l lq lr ls bm lt lu lv lw lx di"> C </span>如今，用当今所有强大的机器学习算法来解决数据科学问题似乎轻而易举。如果经过正确调整和训练，这些算法能够有效地从数据中提取关键特征，学习常见模式，并最终提供准确的预测。</p><p id="10f4" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">但当问题不在于数量而在于网络时，会发生什么呢？</strong></p><blockquote class="ly lz ma"><p id="68df" class="kt ku mb kv b kw kx kf ky kz la ki lb mc ld le lf md lh li lj me ll lm ln lo im bi translated">通常在<strong class="kv jf">银行业</strong>中，仅依靠交易金额或其他特征很难发现隐藏欺诈性金融交易的空壳公司。然而，交易路径是模型可以用来提高其性能的关键信息。</p><p id="6c3a" class="kt ku mb kv b kw kx kf ky kz la ki lb mc ld le lf md lh li lj me ll lm ln lo im bi translated">同样，在<strong class="kv jf">医疗保健</strong>中，检测欺诈也很困难，因为它涉及到医疗服务提供者、医生、受益人的同行共同提供虚假理赔。</p></blockquote><p id="86f1" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">在这种情况下，还有哪些选择？</strong></p><p id="a49a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">面对这类问题，人们通常会在两个必要条件之间摇摆不定:<strong class="kv jf">性能和可解释性。</strong></p><ul class=""><li id="e326" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mk ml mm mn bi translated"><strong class="kv jf">性能:</strong>使用<strong class="kv jf"> <em class="mb">图形神经网络</em> ( <em class="mb"> GNNs </em> ) </strong>模型或其变体如<em class="mb">图形卷积网络(GCN) </em>、<em class="mb">图形注意力网络(GAT) </em>等，图形可以产生优异的效果。为什么？主要原因是它们<strong class="kv jf">能够用向量表示图的节点、边或子图，并从中学习</strong>。[ <a class="ae mo" href="https://www.sciencedirect.com/science/article/pii/S2666651021000012?via%3Dihub" rel="noopener ugc nofollow" target="_blank"> 1 </a> ]但是，它们会导致模型过于复杂且难以解释。</li><li id="0d00" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mk ml mm mn bi translated"><strong class="kv jf">可解释性:</strong>通过从一组机器学习算法中进行选择，可以获得可解释性模型，但有时会牺牲性能。</li></ul><p id="9b50" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">幸运的是，还有另一种选择:<strong class="kv jf">结合了机器学习和图形分析。</strong></p><p id="2423" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">该方法包括以图形形式表示问题，计算网络特征，并使用该信息丰富ML算法学习的数据集。因此，这种方法有可能<strong class="kv jf">提高模型性能，而不损害可解释性。</strong></p><p id="661f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">本文的目标是通过一个具体的用例来解释和说明这种方法:<strong class="kv jf">医疗行业的欺诈检测。</strong></p><p id="6e58" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">阅读本文后，您将了解:</strong></p><ol class=""><li id="6edd" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mu ml mm mn bi translated">如何<strong class="kv jf">以图形方式可视化您的数据</strong>并计算图形<strong class="kv jf">主要特征</strong></li><li id="b8a9" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">如何对你的数据进行<strong class="kv jf">图聚类</strong>？</li><li id="29d2" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">如何利用这些特性<strong class="kv jf">提升你的模型性能</strong>？</li></ol><h1 id="cfda" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">1.数据集丰富</h1><h1 id="0ae4" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">1.1.关于数据集</h1><h2 id="8947" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">数据由什么组成？</strong></h2><p id="d265" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">该数据集来自Medicare，由提供者提交的索赔以及每项索赔的受益人信息组成。</p><p id="27d7" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">更具体地说，它包含以下信息:</p><ul class=""><li id="3112" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mk ml mm mn bi translated">关于索赔:开始和结束日期、状态、涉及的医生(提供者、主治医生、手术医生)、诊断等。</li><li id="a525" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mk ml mm mn bi translated">关于患者:年龄、性别、所在地、健康状况等。</li></ul><p id="a36d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">有关数据集的更多信息可在此处获得[ <a class="ae mo" href="https://www.kaggle.com/rohitrox/healthcare-provider-fraud-detection-analysis" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]。</p><p id="0f8f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">目标是预测索赔是否具有欺诈性。</strong></p><h2 id="6ebf" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">我们希望发现哪些欺诈案件？</strong></h2><p id="a71d" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">它们主要是<strong class="kv jf"> 4个欺诈使用案例</strong>，通常在医疗保健行业占主导地位:</p><ol class=""><li id="b427" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mu ml mm mn bi translated">对未实际提供的服务计费</li><li id="b669" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">重复同一服务的索赔</li><li id="afb5" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">歪曲提供的服务</li><li id="a849" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">收取比实际提供的服务更贵的费用</li></ol><p id="6a36" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这些用例，尤其是前三个用例，在仅使用索赔、诊断或患者的可用信息时很难发现。</p><p id="9e72" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">然而，提供者在医师网络中的位置带来了有价值的信息。</strong>例如:</p><ul class=""><li id="a646" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mk ml mm mn bi translated">对未实际提供的服务收费的从业者将倾向于具有更高数量的索赔，因此代表与其他节点紧密链接的中心节点。</li><li id="3b10" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mk ml mm mn bi translated">重复索赔的医生将倾向于对相同的主刀医生和主治医生提出大量索赔，因此代表与相同节点紧密链接的节点，等等。</li></ul><h1 id="06d7" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">1.2.如何从表格到图形？</h1><p id="96af" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">第一步是<strong class="kv jf">通过图形化表示和可视化来探索数据。</strong></p><p id="43b6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但是首先，图是由什么组成的？一个图形本质上包括:</p><ol class=""><li id="8dec" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mu ml mm mn bi translated"><strong class="kv jf">节点(或顶点)</strong>:表示数据中的实体。在我们的例子中，他们可以代表医生或病人。</li><li id="31ad" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated"><strong class="kv jf">边:</strong>它们象征着实体之间的一种联系，可以按照一定的准则进行加权。</li></ol><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/60462fa48edf83f2a98bae3d6254c0f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cI2O_F1bSvCzG0FnUBMbiQ.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图1 — <em class="on">图形组件，i </em>作者演示</p></figure><p id="4a9a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在本文的其余部分，图表将由代表医生的节点和代表索赔的边组成。</p><p id="d746" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用库<em class="mb"> Networkx </em> [ <a class="ae mo" href="https://networkx.org/" rel="noopener ugc nofollow" target="_blank"> 3 </a> ]可以很容易地将数据集转换成图形，如下例所示。</p><figure class="of og oh oi gt iv"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="b609" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">图形的可视化可以使用库<em class="mb"> Plotly </em> [ <a class="ae mo" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> 4 </a>来完成。代码示例可以在<a class="ae mo" href="https://plotly.com/python/network-graphs/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/dc93631de487b530c97d08bdbdf1b9dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*UmdVR4SFnr7rvlJoPZx00A.gif"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图2—图表探索，作者提供的图片</p></figure><h1 id="1561" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">1.3.从图表中可以提取出什么有用的信息？</h1><p id="b182" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">一旦数据集被转换成图形，我们可以从中获得什么信息？可以为代表医生的每个节点计算各种各样的指标。给定我们的用例，我们将只关注4个:节点的度、紧密度中心系数、特征向量中心性和PageRank。<strong class="kv jf">它们主要捕捉一个节点在图中的中心位置和影响力。</strong></p><h2 id="a55c" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">度</strong></h2><p id="cfc3" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">它表示与顶点关联的边的数量</p><h2 id="b1a5" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">接近中心性</strong></h2><p id="785e" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">顾名思义，接近中心性度量一个节点与其他节点的接近程度和中心程度。对于给定的节点<em class="mb"> u，</em>它表示从<em class="mb"> u </em>到所有<em class="mb"> n-1 </em>其他节点的最短路径距离之和的倒数，如下式所示:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/fd2109be4ada6733a8dcf41785af4282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*GLaNSFjBsckIZI3NNm7wJg.png"/></div></figure><p id="0be9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">其中<em class="mb"> d(u，v) </em>是<em class="mb"> v </em>和<em class="mb"> u </em>和<em class="mb"> n </em>之间的最短路径距离，是图中的节点数。</p><p id="f32f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">为了说明这一指标背后的概念，让我们举一个简单的例子:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/97ddddb57453dbb137bacbd32d9f76fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xsYURj6NtcYeVM0Ue8wC0Q.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图3——作者展示的接近中心性</p></figure><h2 id="e2fe" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">特征向量中心性</strong></h2><p id="73c4" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated"><strong class="kv jf">特征向量中心性基于其邻居的中心性捕获节点的中心性。</strong>这意味着具有高得分的节点是连接到同样具有高得分的其他有影响力的节点的节点。</p><p id="c891" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">它由什么组成？数学上，计算如下。对于给定的图<em class="mb"> G(V，E) </em>具有|V|个顶点<em class="mb"> A </em>是邻接矩阵，即如果顶点<em class="mb"> u </em>链接到顶点<em class="mb"> v，则ᵤᵥ =1，否则为0 </em>。</p><p id="2210" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">顶点<em class="mb"> v </em>的相对中心度<em class="mb"> x </em>可以定义为:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/e12ec4207ed32adab59cec36680ac0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*4YE8MWZfOkJadyDsPwMHoA.png"/></div></figure><p id="cc26" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">可以用向量表示法改写为特征向量方程:<em class="mb">Ax =</em>λ<em class="mb">x .</em><em class="mb">x</em>的vth分量给出了顶点<em class="mb"> v </em>在网络中的相对中心性得分。</p><p id="8ad5" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">关于分数及其计算的更多信息可以在这里找到[ <a class="ae mo" href="https://en.wikipedia.org/wiki/Eigenvector_centrality" rel="noopener ugc nofollow" target="_blank"> 6 </a> ]。</p><h2 id="913d" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak"> PageRank </strong></h2><p id="2faf" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">关于PageRank分数，它依赖于归一化的特征向量中心性或归一化的<strong class="kv jf">声望p. </strong></p><p id="f850" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">它由什么组成？使用标准化邻接矩阵<em class="mb"> N </em>进行计算，定义如下:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ou"><img src="../Images/1c6b451bde8c66cff6a3f995608de7ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0KBuphRlkFTA5qx1yhXYg.png"/></div></div></figure><p id="69b7" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">其中<em class="mb"> od(u) </em>为节点<em class="mb"> u. </em>的出度</p><p id="d6d1" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">节点<em class="mb"> v </em>的<strong class="kv jf">归一化特征向量声望分数</strong> <em class="mb"> p(v) </em>通过求解以下等式来计算:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2ef2b756616fe9c4ffc712ef096580a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*zZ18JK_n30rx0jjFWL79bQ.png"/></div></figure><p id="3bee" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">更多信息可以在这里找到。</p><p id="9dc4" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">page rank与特征向量中心性相比如何？</strong>由于两个指标都使用其邻居的中心性来测量节点的中心性，因此让我们来研究两个具体示例的结果。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ow"><img src="../Images/be4860e8b04aed231782c721cb00d025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tP_ag8YX6HvBtQ3S1asgWA.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图4-特征向量中心性和PageRank，<em class="on"> i </em>作者举例说明</p></figure><p id="255b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">计算这些指标可以使用库<em class="mb"> Networkx </em> [ <a class="ae mo" href="https://networkx.org/" rel="noopener ugc nofollow" target="_blank"> 3 </a> ]来实现，如下面的代码所示。</p><figure class="of og oh oi gt iv"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="3c04" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下面是生成的数据帧的摘录。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/9808940d47b032d041679623cdf595e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YxW1FI7p9qz12ejioaOaWA.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图5—提取具有图形特征的数据集</p></figure><p id="af72" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下图显示了目标<em class="mb">潜在流量</em>和图表特征之间的相关性。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/e8722634b7d061dc00936fb9b6a64cdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1kGw11XwT-QFw7k3fQ7Bw.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图6—目标电势分布<em class="on">与图形特征</em>的相关性</p></figure><h1 id="6e41" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">2.使聚集</h1><p id="5ae9" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">一旦计算出图表的特征，<strong class="kv jf">就可以更进一步，将医生分组。</strong>如何？这可以通过使用<strong class="kv jf">社区检测算法来实现。让我们探索一下最常见的方法:鲁文方法、信息图和随机漫步。</strong></p><h1 id="e913" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">2.1.勒芬</h1><p id="8039" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">Louvain方法通过最大化每个社区的模块性得分来检测大型网络<strong class="kv jf">中的社区。</strong></p><h2 id="8aa9" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">什么是模块化得分？</strong></h2><p id="9045" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">模块性得分测量<strong class="kv jf">一个图到几个社区的给定聚类的强度。</strong>为此，它依赖于<strong class="kv jf">社区内边的集中与所有节点之间链接的随机分布的比较，而不管社区。</strong></p><p id="6281" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">更特别的是，它比较了:</p><ol class=""><li id="1881" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mu ml mm mn bi translated">一个簇内的边数</li><li id="ea0a" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">如果网络是一个随机网络，具有相同的节点数和每个节点的相同度，但边是随机连接的，则可以在集群中找到的预期边数</li></ol><p id="dfd4" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">模块化得分的数学定义如下:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oz"><img src="../Images/06b3a6ae1564974e7117a1b7825826db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*taqpCr0iGWQ6J7_8BuYTjA.png"/></div></div></figure><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pa"><img src="../Images/f907eaa88638933eaf8f02e456f70fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZyFqoulHiClhvISaaUnGQ.png"/></div></div></figure><p id="8ac3" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">关于模块化得分的更多信息可以在这里找到[ <a class="ae mo" href="https://en.wikipedia.org/wiki/Modularity" rel="noopener ugc nofollow" target="_blank"> 8 </a> ]。</p><h2 id="281e" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">鲁汶算法如何最大化分数？</strong></h2><p id="43cd" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">Louvain方法使用了一种<strong class="kv jf">层次聚类算法:</strong></p><ol class=""><li id="e1ab" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mu ml mm mn bi translated">一开始，每个顶点代表一个社区。然后，在每一步，顶点被局部地重新分配给对模块性分数增加的贡献最高的社区。</li><li id="5177" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">一旦没有顶点可以重新分配，每个社区就变成一个独立的顶点，这个过程重新开始。</li><li id="de2d" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mu ml mm mn bi translated">当一个步骤中只剩下一个顶点或者模块性不能再增加时，算法停止。</li></ol><p id="1e3f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">关于算法的更多信息可以在这里找到。</p><h1 id="faed" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">2.2.信息图</h1><p id="2bdb" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">Infomap过程类似于上面描述的过程，但是具有另一个目标函数:它不是最大化模块性得分，<strong class="kv jf">而是最小化所谓的map等式。</strong></p><h2 id="df3f" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated"><strong class="ak">地图方程代表什么？</strong></h2><p id="6116" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">在不深入数学细节的情况下，map方程的基本思想是测量聚类的效果，当用作Huffman代码时，<strong class="kv jf">压缩关于探索你的图的随机漫步机的信息。</strong></p><blockquote class="ly lz ma"><p id="cb31" class="kt ku mb kv b kw kx kf ky kz la ki lb mc ld le lf md lh li lj me ll lm ln lo im bi translated">为了说明这个概念，让我们想象一个<strong class="kv jf">随机漫步人</strong>在探索网络。walker在两个节点之间进行转换的概率由网络的结构和权重给出。</p><p id="26a5" class="kt ku mb kv b kw kx kf ky kz la ki lb mc ld le lf md lh li lj me ll lm ln lo im bi translated">到目前为止，网络的每个节点都被编码成一个单独的码字。<strong class="kv jf">但是，如果您能够利用网络结构(即社区的存在)来最大限度地减少唯一代码字的数量，会怎么样呢？</strong></p><p id="f05e" class="kt ku mb kv b kw kx kf ky kz la ki lb mc ld le lf md lh li lj me ll lm ln lo im bi translated">事实上，考虑到网络中有一些区域，一旦进入，随机漫步机往往会无限期地停留，因此有优化的空间:我们可以为每个区域使用前缀代码，然后为模块内的每个节点使用唯一的码字。这些码字可以被其他区域的节点重新使用。</p></blockquote><p id="722a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">更多信息可以在<a class="ae mo" href="https://stackoverflow.com/questions/48528648/infomap-community-detection-understanding/54292999" rel="noopener ugc nofollow" target="_blank">这里</a>或者在这些论文<a class="ae mo" href="https://arxiv.org/abs/cond-mat/0408187" rel="noopener ugc nofollow" target="_blank"> 10 </a>、<a class="ae mo" href="https://www.biorxiv.org/content/10.1101/2020.04.14.040519v2.full" rel="noopener ugc nofollow" target="_blank"> 11 </a>、<a class="ae mo" href="https://www.statworx.com/at/blog/community-detection-with-louvain-and-infomap/" rel="noopener ugc nofollow" target="_blank"> 12 </a>中找到。</p><h1 id="1a5e" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">2.3.步行陷阱</h1><p id="2141" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">Walktrap算法也是基于随机行走的<strong class="kv jf">。</strong>它通过运行短距离随机行走，在一个图中找到密集连接的子图，即社区。</p><p id="c6f9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这种方法背后的想法是，散步更有可能留在一个特定的社区建设。</p><p id="9bff" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">更多信息可以在这里找到[ <a class="ae mo" href="https://medium.com/r?url=http%3A%2F%2Fjgaa.info%2Faccepted%2F2006%2FPonsLatapy2006.10.2.pdf%2F" rel="noopener"> 13 </a> ]。</p><p id="b011" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">运行这些社区检测算法可以使用库<em class="mb"> igraph </em> [ <a class="ae mo" href="https://igraph.org/" rel="noopener ugc nofollow" target="_blank"> 5 </a>来实现，如下面的代码所示。</p><figure class="of og oh oi gt iv"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="04be" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这样就可以图形化地显示聚类的结果，如下图所示。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/903ceb83f1f00ffec3f86b4bcd12839f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqY3mxZ-vroP3dbw0ZFhvw.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图7—社区检测结果，作者提供的图片</p></figure><h1 id="3f11" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">3.系统模型化</h1><p id="6469" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">现在，最终的问题来了:底层业务用例的网络表示为模型带来了真正强大和健壮的价值吗？让我们通过我们的用例来探索答案。</p><h1 id="8c4d" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">3.1.性能提升到了什么程度？</h1><h2 id="8f6c" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated">关于培训设置</h2><p id="3ada" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">我测试了<strong class="kv jf"> 3个场景</strong>，这些场景在用于模型训练的特性方面有所不同:</p><ul class=""><li id="cb99" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mk ml mm mn bi translated"><strong class="kv jf">场景1 —基线:</strong>关于索赔和患者的信息(参见第1.2节。)</li><li id="f7bf" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mk ml mm mn bi translated"><strong class="kv jf">场景2 —基线和图表的特征:</strong>这些特征包括上述4个指标(参见第1.3节。):代表医生的节点的度、他们的接近度中心系数、特征向量中心性和PageRank。</li><li id="1a96" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mk ml mm mn bi translated"><strong class="kv jf">场景3——基线、图的特征和检测到的社区:</strong>测试的算法是上面解释的算法(参见第2节。):Louvain方法、InfoMap和RandomWalk。</li></ul><p id="95be" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">关于训练设置，我将数据集分成两部分:一个训练集，代表初始数据集的80%,和一个验证集。对于每个场景，我测试了多种分类算法，并使用三重交叉验证方法根据训练集的AUC选择了最佳算法。</p><h2 id="dcc8" class="nn mw je bd mx no np dn nb nq nr dp nf lc ns nt nh lg nu nv nj lk nw nx nl ny bi translated">结果</h2><p id="edb2" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">下表包含使用验证集上最佳模型的每个场景的AUC分数。它还包含3个最重要的变量。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pc"><img src="../Images/e9dcadd4daa9fcb5e9d8198d505385aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RW4Vr_336Z0KjaQLSdV36g.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图8—结果表</p></figure><p id="dd6e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">到目前为止，最后一种情况优于第一种情况。下图中的ROC曲线证实了这一观察结果。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pd"><img src="../Images/e6fec8306d7916a7b6ba0635ac633fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fn9Rhp0yxPr_k8mGQBDOvQ.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图9-ROC曲线</p></figure><h1 id="973e" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">3.2.可变重要性呢？</h1><p id="4fe8" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">场景3中的最佳模型是随机森林。因此，通过计算每个树中杂质减少累积的平均值和标准偏差，可以洞察每个变量的重要性。</p><p id="5ef2" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下图显示了场景3最佳模型的最重要变量。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pe"><img src="../Images/e873c4e624d814e9c4bce57517159385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6zeacYflYl_JGXlQspiaA.png"/></div></div><p class="oj ok gj gh gi ol om bd b be z dk translated">图10—特征重要性(场景3)</p></figure><p id="3273" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">与图形相关的特征在模型预测中具有更高的重要性。这种重要性可能有较大或较小的可变性，这取决于它们在构造中包含的随机性的大小。</p><h1 id="aaaf" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">关键要点</h1><p id="e223" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated"><strong class="kv jf">从这个用例中可以得到什么启示？</strong></p><ul class=""><li id="663d" class="mf mg je kv b kw kx kz la lc mh lg mi lk mj lo mk ml mm mn bi translated"><strong class="kv jf">使用图形分析可以显著提高模型的预测能力。</strong>为什么？常规的ML方法包括从单个观察中学习，而<strong class="kv jf">带图ML使用现有的网络结构来检测新模式，并添加关于实体如何相互连接以及它们的关系性质的有价值信息</strong>。由于初始特征集没有捕捉到这些信息，带图的ML可能会提高模型性能。</li><li id="a88f" class="mf mg je kv b kw mp kz mq lc mr lg ms lk mt lo mk ml mm mn bi translated"><strong class="kv jf">使用图形分析会导致很高的计算成本。</strong>根据所使用的算法，这可能比在特征工程步骤中添加一些根据手工挑选的信息手动构建的特征成本更高。</li></ul><h1 id="8e9a" class="mv mw je bd mx my mz na nb nc nd ne nf kk ng kl nh kn ni ko nj kq nk kr nl nm bi translated">资源</h1><p id="cc59" class="pw-post-body-paragraph kt ku je kv b kw nz kf ky kz oa ki lb lc ob le lf lg oc li lj lk od lm ln lo im bi translated">[1]周杰，甘渠翠，，胡，张正彦，，程阳，，王，，孙茂松，<a class="ae mo" href="https://www.sciencedirect.com/science/article/pii/S2666651021000012?via%3Dihub" rel="noopener ugc nofollow" target="_blank">图神经网络:方法与应用综述</a>，艾开</p><p id="d979" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[2] Kaggle，<a class="ae mo" href="https://www.kaggle.com/rohitrox/healthcare-provider-fraud-detection-analysis" rel="noopener ugc nofollow" target="_blank">医疗保健提供商欺诈检测分析</a></p><p id="4904" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[3] <a class="ae mo" href="https://networkx.org/" rel="noopener ugc nofollow" target="_blank"> Networkx库</a></p><p id="85eb" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[4] <a class="ae mo" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> Plotly库</a></p><p id="6e8c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[5] <a class="ae mo" href="https://igraph.org/" rel="noopener ugc nofollow" target="_blank"> iGraph库</a></p><p id="f64c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[6]维基百科，<a class="ae mo" href="https://en.wikipedia.org/wiki/Eigenvector_centrality" rel="noopener ugc nofollow" target="_blank">特征向量中心性</a></p><p id="5140" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[7] Günce Keziban Orman，Vincent Labatut。<a class="ae mo" href="https://www.nature.com/articles/srep30750" rel="noopener ugc nofollow" target="_blank">人工网络社区发现算法的比较</a>。发现科学国际会议，2009年10月，葡萄牙波尔图</p><p id="ef71" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[8]维基百科，<a class="ae mo" href="https://en.wikipedia.org/wiki/Modularity" rel="noopener ugc nofollow" target="_blank">模块化</a></p><p id="e3ef" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[9]维基百科，<a class="ae mo" href="https://en.wikipedia.org/wiki/Louvain_method" rel="noopener ugc nofollow" target="_blank">卢万法</a></p><p id="a6b8" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[10] Aaron Clauset，M. E. J. Newman，Cristopher Moore，<a class="ae mo" href="https://arxiv.org/abs/cond-mat/0408187" rel="noopener ugc nofollow" target="_blank">在非常大的网络中发现社区结构</a>，2004年8月</p><p id="78e0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[11] Carmel Farage，Daniel Edler，Anna Eklö，Martin Rosvall，Shai Pilosof，<a class="ae mo" href="https://www.biorxiv.org/content/10.1101/2020.04.14.040519v2.full" rel="noopener ugc nofollow" target="_blank">使用信息图确定生态网络中的流量模块</a></p><p id="ab5f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[12]尼克拉斯·勇克，<a class="ae mo" href="https://www.statworx.com/at/blog/community-detection-with-louvain-and-infomap/" rel="noopener ugc nofollow" target="_blank">利用卢万和信息地图进行社区探测</a>，2020年火星</p><p id="2f67" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[13] Pons、Pascal和Matthieu Latapy，<a class="ae mo" href="https://arxiv.org/abs/physics/0512106" rel="noopener ugc nofollow" target="_blank">使用随机行走的大型网络中的计算社区</a></p></div></div>    
</body>
</html>