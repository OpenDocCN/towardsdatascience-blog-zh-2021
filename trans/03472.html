<html>
<head>
<title>Two outlier detection techniques you should know in 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2021年你应该知道的两种离群点检测技术</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/two-outlier-detection-techniques-you-should-know-in-2021-1454bef89331?source=collection_archive---------2-----------------------#2021-03-20">https://towardsdatascience.com/two-outlier-detection-techniques-you-should-know-in-2021-1454bef89331?source=collection_archive---------2-----------------------#2021-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e3d5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基于椭圆包络和IQR的检测</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c42b92d171a9573c21ed236a8a135d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gr-Vnn54SY4tISymtylHtg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历山大·安德鲁斯在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8fc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">离群值是与其他数据点显著不同的异常数据点。离群点检测是一件棘手的事情，应该小心进行。<strong class="lb iu">椭圆包络</strong>和<strong class="lb iu"> IQR </strong>是常用的离群点检测技术。椭圆包络是基于机器学习的方法，而基于IQR的检测是统计方法。它们各有利弊。因此，我们不能说哪一个是最好的。最好的策略是将这两种技术结合起来，看看整体结果。</p><p id="1f29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论椭圆包络和IQR技术背后的直觉，并将它们结合在一起以获得更好的结果。还将使用Python和Scikit-learn讨论这些技术的实现。不要忘记阅读本文末尾的“要点”部分。在那里，你会学到一些特殊的概念和策略时，使用椭圆包络和IQR技术。</p><p id="5110" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[这篇文章包括所有的东西:理论，代码，可视化和想法！]</p><p id="5b68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><h1 id="c597" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">椭圆形信封</h1><p id="fe8a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这种方法的主要假设是数据应该是<strong class="lb iu"><em class="ms"/></strong>(<strong class="lb iu"><em class="ms">高斯分布</em> </strong>数据集)。椭圆形信封背后的直觉非常简单。我们根据一些标准在数据点周围画一个椭圆，并将椭圆内的任何数据点分类为内点(绿色的)，将椭圆外的任何观察结果分类为外点(红色的)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/185350382f61d28a21e2829b5017e297.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*7fMsQL3wsLkIRCWpYrenvw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">椭圆形信封背后的直觉(图片由作者提供)</p></figure><p id="c9f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">椭圆包络线方法将所有观测视为一个整体，而不是单个特征。虽然这种方法背后的直觉非常简单，但实现起来有些棘手。在Scikit-learn中，椭圆包络方法是通过<strong class="lb iu">椭圆包络()</strong>函数实现的。这里，我们需要指定<strong class="lb iu">污染</strong>超参数——一个我们不知道的值。它表示数据集中异常值的比例。这个超参数的值的范围是从0到0.5(默认值是0.1)。如果我们认为数据中会有很多异常值，我们可以将<strong class="lb iu">污染</strong>设置为一个更大的值。不知道数据集中异常值的确切比例是使用这种方法的主要限制。</p><h2 id="aafe" class="mu lw it bd lx mv mw dn mb mx my dp mf li mz na mh lm nb nc mj lq nd ne ml nf bi translated">履行</h2><p id="25d5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了实现椭圆包络方法，我们将首先使用sci kit-learn<strong class="lb iu">make _ blobs()</strong>函数创建一个模拟数据集。然后我们将数据可视化，并检查正态性假设。</p><p id="3349" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们写代码吧！</p><p id="8b06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第一步:制作模拟数据集</strong></p><p id="3caf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们使用Scikit-learn<strong class="lb iu">make _ blobs()</strong>函数来创建一个模拟数据集。该函数创建高斯分布数据集。这里，出于可视化的目的，我们只为<strong class="lb iu"> X </strong>选择两个特征。没有<strong class="lb iu"> y </strong>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段1)</p></figure><p id="bda0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第二步:可视化数据</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段2)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/055a15a9160805943f96339e3855a556.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*JjCUVp2Ny3DmLsyHuhcggw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">两个特征之间的散点图(图片由作者提供)</p></figure><p id="50f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据中似乎有一些异常值。</p><p id="f27b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第三步:检查数据的正态性</strong></p><p id="ef3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以为每个特征创建直方图来检查正态性假设。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段3)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/298643faa85aa9365613ec80b76b42bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXhXnqOvjzu3IKpNMmceog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">两个特征的直方图(图片由作者提供)</p></figure><p id="4726" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的数据是正态分布的。因此我们可以应用<strong class="lb iu"> EllipticEnvelope() </strong>函数来检测异常值。</p><p id="6896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤4:应用椭圆包络来检测异常值</strong></p><p id="2396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的数据集中似乎只有很小一部分异常值。因此，我们可以将<strong class="lb iu">污染</strong>设置为较小的值，如0.025。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段4)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/e670beca12bc7e7fbc17328e738b9eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*CP7-5PV7k_3QyX4Qo3201g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检测到异常值的散点图(图片由作者提供)</p></figure><p id="823f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">椭圆信封对象的<strong class="lb iu"> fit_predict() </strong>方法(<strong class="lb iu"> <em class="ms"> elpenv </em> </strong>)对于内点返回1，对于离群点返回-1。我们可以使用<strong class="lb iu"> np.where() </strong>函数提取异常值。红色的数据点是异常值。以下指数值的观察值是异常值。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="9f26" class="mu lw it nl b gy np nq l nr ns">outlier_index</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/474507aa9ac4fc63e0c7f4631c84bab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*-g1kGzCsIoEQmSTWMzrT3Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1aa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第五步:获取没有异常值的数据集</strong></p><p id="0b2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们创建一个不包含异常值的熊猫数据框。我们可以使用该数据集进行进一步分析。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段5)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/ddf547a636fd969c1c88898584f245e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*QLSkIIwrI2Ii6JjfhM2CFg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="5ee7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">基于IQR的检测</h1><p id="9fff" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">基于IQR的检测是一种统计方法。这种技术适用于单个特征，而不是像在椭圆包络中那样适用于整个观测。基于IQR的检测背后的直觉也很简单。首先，我们计算数据的第一个四分位数(Q1)和第三个四分位数(Q3)。然后我们得到这两个四分位数的差值。这种差异被称为IQR(四分位数间距)。</p><ul class=""><li id="6376" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">IQR = Q3-Q1</li><li id="e661" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">下限= Q1–1.5(IQR)</li><li id="6745" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">上限= Q3+1.5(IQR)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/10186680124919e318ab26673c457068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*GVnQHnOmPVzNZid_KX--hQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d890" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何小于下限或大于上限的值都是异常值。</p><h2 id="c14f" class="mu lw it bd lx mv mw dn mb mx my dp mf li mz na mh lm nb nc mj lq nd ne ml nf bi translated">履行</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段6)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/60fe8733704a13c61cb4d5f10d552649.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*4Yx5R7eKGTeZO04aBuhfYw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个特征的异常值指数非常有用。我们可以使用所有要素的异常值索引的联合来从数据集中提取和移除异常值。我们可以得到如下的联合。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段7)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/23f33fb39ee4631917de4730cd45f3ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*-u-TjfRmtXtvMVrmFOLAsQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="887c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将数据可视化在散点图上，并将基于IQR的检测与椭圆包络进行比较。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段8)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/9da3fed40ac0e5b87950fbdf83dc7200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nvzd3EsneJrWgh_zmhARg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于IQR的检测和椭圆包络的比较(图片由作者提供)</p></figure><p id="6e04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到两种方法在检测异常值时的一些差异。</p><p id="93d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以使用<strong class="lb iu"> <em class="ms"> index_union </em> </strong>从数据集中移除离群值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段9)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/fe9e4aab65a8e80c7238444d57aec394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wBX-kNyL3GaRsm7yGzLnKw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">有异常值和无异常值的数据(图片由作者提供)</p></figure><p id="baf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以制作箱线图来显示有无异常值的数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等待加载Python代码(代码片段10)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/44fae276b5ae205b1f818b8800b02523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n5bhdDZf_iZT6T9RwMEV4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">包含和不包含异常值的每个要素的箱线图(图片由作者提供)</p></figure><h1 id="45a4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">关键要点</h1><p id="9508" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">今天，我们在检测异常值方面做得很好。我们已经讨论了两种流行的技术，<strong class="lb iu">椭圆包络</strong>和<strong class="lb iu">基于IQR的检测</strong>。它们各有利弊。这两种技术背后的直觉很容易理解。椭圆包络基于机器学习，IQR基于统计。椭圆包络很容易用Scikit-learn <strong class="lb iu">椭圆包络()</strong>函数实现，但要满足正态性假设。椭圆包络线方法将所有观测视为一个整体，而不是单个特征。椭圆包络的主要缺点是我们不知道<strong class="lb iu">污染</strong>超参数的精确值。猜测该值的最佳方法是首先进行基于IQR的检测，并计算数据集中异常值的数量。由于您知道观察值的总数，因此您可以获得异常值比例的近似值。这是<strong class="lb iu">污染</strong>超参数的值。这就是我们如何将两种技术结合在一起！</p><p id="ccf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">顺便说一下，基于IQR的检测不容易实现。你必须写一些高级的Python代码。但是在基于IQR的检测中，我们不需要检查正态性的假设，也不需要知道数据集中异常值的比例。所以，它们是这种技术的优点。这种技术适用于单个特征，而不是像在椭圆包络中那样适用于整个观测。我们可以使用返回的异常值索引的联合来从数据集中提取和移除异常值</p><p id="68c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是检测异常值背后的故事。但是，我们还没有完成。如何处理异常值？这和检测异常值是一样的吗？不。如果我们检测到异常值，我们下一步应该做什么？我们应该移除它吗？我们应该保留它吗？或者我们应该用一个相关的值来代替它？这取决于特定分析问题的领域知识。一个离群值背后可能有一个有趣的故事。所以，如果你发现了，试着说出这个故事。由于人为错误，可能存在一些异常值。在这种情况下，您可以将它们从数据中删除。</p><p id="50df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于离群值的最后几句话— <strong class="lb iu">“处理离群值时要格外小心，除非你知道它们背后的故事！总是将多种技术结合起来检测异常值，因为没有单一的最佳技术。如果可能，始终绘制数据以检查假设和最终输出。”</strong></p></div><div class="ab cl oo op hx oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="im in io ip iq"><p id="f793" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天的帖子到此结束。我的读者可以通过下面的链接注册成为会员，以获得我写的每个故事的全部信息，我将收到你的一部分会员费。</p><p id="a001" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【https://rukshanpramoditha.medium.com/membership】报名链接:<a class="ae ky" href="https://rukshanpramoditha.medium.com/membership" rel="noopener"/></p><p id="b296" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢你一直以来的支持！下一个故事再见。祝大家学习愉快！</p><p id="b41d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特别感谢Unsplash上的<strong class="lb iu"> Alexander Andrews </strong>，<strong class="lb iu"> </strong>为我提供了这篇文章的封面图片。</p><p id="21c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ov ow ep" href="https://medium.com/u/f90a3bb1d400?source=post_page-----1454bef89331--------------------------------" rel="noopener" target="_blank">鲁克山普拉莫迪塔</a><br/><strong class="lb iu">2021–03–20</strong></p></div></div>    
</body>
</html>