<html>
<head>
<title>Unlimited scientific libraries and applications in Kubernetes, instantly!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes中无限的科学图书馆和应用程序，即刻！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/unlimited-scientific-libraries-and-applications-in-kubernetes-instantly-b69b192ec5e5?source=collection_archive---------24-----------------------#2021-09-27">https://towardsdatascience.com/unlimited-scientific-libraries-and-applications-in-kubernetes-instantly-b69b192ec5e5?source=collection_archive---------24-----------------------#2021-09-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="87e5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">建立一个包和应用程序的共享库，可以动态地加载到您的Kubernetes数据科学环境中。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2cc9fdd44c96b68473528ea960ed5bd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z3ZRKZYuPjiYGcWFjhR-nQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">迈克尔·D·贝克与在<a class="ae kv" href="https://unsplash.com/s/photos/scientific-libraries?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的合影</p></figure><p id="e4c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">TL；DR: </strong> <br/>在Kubernetes上提供Jupyter-as-a-Service在规模上是很棘手的，当你需要提供许多不同版本的不同库或应用程序来满足每个用户的需求时。</p><p id="7891" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">而不是创建超重的容器图像，或者必须管理(并从中选择！)数百个，或者让人们每次打开笔记本时从头重新安装所有东西，您可以建立一个共享的库和应用程序库，并让用户动态和即时地加载它们。</p><p id="9bc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为<a class="ae kv" href="https://opendatahub.io/" rel="noopener ugc nofollow" target="_blank">开放数据中心</a>提供的完整代码和部署说明！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/febfd108b1e903e152d4d3590c320ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*SXb6YBWGppOSy6MHVxaPuQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(作者截图)</p></figure><p id="7a5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lt">免责声明:</em>我在Red Hat工作，帮助组织开发数据科学/数据工程平台和解决方案。因此，这里描述的实现使用不同的Red Hat产品，如<a class="ae kv" href="https://www.redhat.com/fr/technologies/cloud-computing/openshift" rel="noopener ugc nofollow" target="_blank"> Red Hat OpenShift </a>(我们的Kubernetes企业发行版)，或<a class="ae kv" href="http://Red Hat OpenShift Data Foundation" rel="noopener ugc nofollow" target="_blank">Red Hat open shift Data Foundation</a>(我们基于Ceph的open shift-原生存储解决方案)。然而，整体架构和方法可以适用于其他平台。</p><p id="d29a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们开始长篇大论吧！</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="7a0a" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">第一章:麻烦是如何开始的</h1><p id="7a4b" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">Kubernetes是数据科学和数据工程平台的流行选择。敏捷性、多功能性、资源可扩展性……使其成为这些工作负载类型的首选平台。尤其是在拥有共享环境的大型组织中:将您的应用程序、库和依赖项打包到轻量级容器映像中，使它们可复制、一致且安全，这似乎是解决您所有问题的完美答案！</p><p id="c168" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您最近读到的这些内容让您激动不已，您以这种方式打包了一个Jupyter容器图像:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/7b1ed08ea972a3a22f2a202d4d5ec020.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*EF9zWtJ6Nee5CGqR8xp1PQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(作者图文)</p></figure><p id="ead0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为你很聪明，想要预测需求(翻译:你不想一次又一次地回到这个话题)，所以你甚至创造了一些不同的“味道”来涵盖你能想到的不同用例:仅带Scipy的基本笔记本，一个带Tensorflow的，一个带Pytorch的，……完美，那些容器图像都可以使用。</p><p id="85f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，您在Kubernetes环境中设置了JupyterHub或Kubeflow，并为所有用户创建了一个Jupyter即服务环境！任务完成了，问题解决了，你就可以回去做其他(总是)迫切的事情了。</p><p id="8c20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几个星期过去了…</p><p id="5bc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后是Alice、Bob和数据科学家团队的其他成员。他们甚至带来了一些BI人员，以通过该组织正在经历的数字化转型来展示他们的善意，还带来了一些数据工程师(谁也不知道，可能会有数据管道的漏洞需要修复)。但是没有统计学家，你们都知道为什么…</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/19b9fdfd86d639bf5c4cf8161aa17159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Cj9B7osELBjJP9rFgbux1w.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片作者来自imgflip.com)</p></figure><p id="c627" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">爱丽丝开始说，“听着，Jupyter即服务这个东西太棒了！过去几周我们一直在玩它，我们看到它如何取代我们的个人环境:在我们的笔记本电脑上不再需要安装和管理任何东西，因为笔记本电脑缺乏处理能力和内存。任何地方都可以访问任何东西！”。</p><p id="c4b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“是的，这绝对是一个巨大的进步。”，鲍勃继续说道。“我们现在能够轻松地交换我们的笔记本电脑，因为它们都基于相同的容器映像，并使用中央数据湖。这个库或这个应用程序不会再丢失了！”</p><p id="a4cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有些困惑，因为这以前从未发生过，你问，“好吧，那么，完美。但你为什么在这里，不仅仅是为了感谢我吗？”</p><p id="eba4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“哦，几乎没有什么，对你来说，这很容易！”查理大声说道。“你知道，你为我们创造的不同风格的环境非常棒。它只是缺少这个我经常使用的库，你知道我的avLib吗？当然是在3.2.4或更高版本，因为在3.2.3之前有一些坏的东西。但不是来自新的4.x分支，我真的不喜欢他们用它做的事情。”</p><p id="4953" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“是的，如果你还能加上巴丽、LibB和LibC，那就太好了。哦，顺便说一下，对于LibC，我需要最近的3个版本，以便能够比较一些东西”，Debbie补充道。</p><p id="6688" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鲍勃以他一贯的方式插话道，“既然我们在讨论这个问题……当然，所有旧版本的图像和库总是可用的，对吗？因为这是我们审计流程的一部分，可以在任何时候重新计算，你知道，为了负债的目的。因此，当然必须总是使用完全相同的工具。另外，我也不想为了适应新版本而修改代码。”</p><p id="48da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看到你的脸有点腐烂，爱丽丝打断了它，“好吧，我猜你已经明白了，所以我们会离开你，再次感谢！”</p><p id="2a32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于你是一个经验丰富的专业人士，你设法隐藏恐慌上升，并迅速切换到解决方案模式…</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="9337" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">第二章:几个选择，没有真正的解决方案…</h1><p id="d450" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">几天后，你会思考你绞尽脑汁的结果…</p><p id="fd25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">选项A </strong>:臃肿的形象。</p><p id="96fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，让我们把他们问的所有东西放到同一个容器图像里！这很简单:只需在requirements.txt中添加几行，或者在docker文件、docker build中添加一些东西，就完成了！现在让我们把图像上传到回购。什么，预计到达时间2:34:12？！哦…这个图像是38.2GB…肯定是不可管理或不可行的:“起始容器。拉图，请明天再来……”。无论如何，我不能适应同一个库的多个版本。</p><p id="17ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">选项B </strong>:永无止境的图像流。</p><p id="b21f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">嗯，在现有图像的基础上，我总是可以创建定制的图像来满足各种需求。但是让我们看看，……只有15个库，每个库有2个可能的版本，理论上有2个⁵组合，32 768个！即使他们只要求百分之一，仍然有300多个容器图像可供选择。我很确定哪个图像的下拉选择器不会允许这么多。无论如何，即使用户因为没有选择而应付，从长远来看，整个事情将是不可收拾的。</p><p id="9dde" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">选项C </strong>:让他们自己处理。</p><p id="b0c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">毕竟，做一个pip安装并没有那么难！如果有requirements.txt，我甚至可以通过一些巧妙的机制让一个进程查看笔记本的文件夹，并安装后台列出的所有内容。当然，每次笔记本启动时都会出现这种情况，这会导致延迟和投诉…而且无论如何，它不会解决使用不同集/版本的基础库来维护许多图像的问题。除非我希望用户每次都从头开始重新安装整个堆栈…</p><p id="e07e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种方法也不能解决无法使用pip或conda安装应用程序的问题。而且在一个安全的企业环境中，容器不作为root运行(这是一个最佳实践)，所以人们无论如何也不能安装任何东西。</p><p id="9e90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么该怎么办呢…？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/ae330e8be5fae76b45ab10820de747e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*ZDI_mFcV-TC-nB8NaBueQg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">你不太好的选择…(作者提供图片)</p></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="e9ba" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">第三章:绝望的深渊</h1><blockquote class="na nb nc"><p id="5df3" class="kw kx lt ky b kz la jr lb lc ld ju le nd lg lh li ne lk ll lm nf lo lp lq lr ij bi translated">作者注:本章已被自愿过滤为1)没有必要让每个人都过这种生活，即使是通过代理。2)它与It或数据科学没有任何联系。</p></blockquote></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="f6b3" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">第四章:这就是方法</h1><p id="f8f4" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">在过去，我有机会了解加拿大计算机公司(Compute Canada)和HPC世界的许多人，至少是学术界的人，特别是神奇的T2 easy build(T3)社区，正在做什么来解决这个相同的问题:如何在一个共享的环境中以有效和可重复的方式为您的用户带来应用程序和库，使数据科学家轻松地完成他们的工作，而不是笨拙地安装、打包或编译…？</p><p id="599e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">他们的答案是使用环境模块来动态“加载”预打包的库或应用程序。将其简化到极致，假设您可以访问安装在文件系统中某处的一些共享文件夹，模块引擎将简单地修改您的$PATH、$PYTHONPATH或类似的其他环境变量，以使这些文件夹在您的环境中“可见”。不再有Python抱怨当你做“导入pytorch”时找不到库，因为现在它知道在哪里可以找到它！</p><p id="5191" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，所有这些都更加精确，因为它可以跟踪依赖性，加载或不加载什么，卸载什么，以及在交叉依赖性的情况下何时卸载…</p><p id="1886" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但基本上，我们问题的解决方案包括两件事:</p><ol class=""><li id="bfca" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nl nm nn no bi translated">提供对“模块”库的访问，这些模块可以是Python库、Linux库或成熟的应用程序。这个库可以在繁殖时挂载到您的环境中。</li></ol><p id="6069" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.有办法在环境中轻松加载这些模块。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/851704af521949edb5cba7095d44eeef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*7CCdUEEXcvnRk4A1XadnpA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Kubernetes中的实现概念(图片由作者提供)</p></figure><p id="204a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以这是我在开放数据中心(<a class="ae kv" href="http://opendatahub.io/" rel="noopener ugc nofollow" target="_blank">开放数据中心</a>，ODH，是一个基于Kubeflow的开源项目，提供开源AI工具，用于在OpenShift容器平台上运行大型分布式AI工作负载)内实现的概念验证解决方案:</p><ul class=""><li id="ec61" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nq nm nn no bi translated">共享库安装在OpenShift Data Foundation提供的RWX卷上(后台有CephFS)。</li><li id="eaf1" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">ODH正在提供Jypyter-as-a-Service环境，在这种情况下，它有一个稍微定制的镜像，可以加载模块，还有一个JupyterLab扩展，可以轻松地完成加载/卸载部分。</li><li id="ff77" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">当产生Jupyter时，共享库以只读方式安装在pod中。</li><li id="5538" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">然后，您只需在需要时加载您需要的内容！</li></ul><p id="5da5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是它看起来的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/c5b3c1b4ea5e6e9e2d9cb87edb75bb88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fI_n_0w5zAxGKAIdPJ9Bnw.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">环境快速演示(作者截图)</p></figure><p id="f18d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是在这个快速概述中发生的事情:</p><ul class=""><li id="943b" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nq nm nn no bi translated">我启动了一个基本的笔记本示例，它使用<strong class="ky ir"> Torchvision </strong>从一张图片中推断出一只狗的品种(不是任何一只狗，我的！).</li><li id="b754" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">当我尝试运行笔记本时，出现了ModuleNotFound错误，因为我的环境中没有可用的<strong class="ky ir"> torchvision </strong>库。</li><li id="f138" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">所以在左边的面板上，在我的<strong class="ky ir">软件的</strong>扩展菜单中，我通过输入几个字母来查找这个包，然后我只需点击Load。</li><li id="015b" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">由于笔记本已经启动，我必须快速重启我的内核以使更改生效。我可以运行整个笔记本。</li></ul><p id="0f9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一点上，你可能会说:“这很有趣，但你可以只做一个pip安装”。</p><p id="8ef6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，特别是这个基本的例子，这也是我们习惯做的，特别是在本地环境中(相对于共享环境)。但是这种替代方法带来了有趣的功能，所有这些功能都不需要创建特定的容器映像:</p><ul class=""><li id="ca9e" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nq nm nn no bi translated">提供人们无法安装的应用程序，因为它们可能没有Conda或Pip包。在这种共享环境中，人们不应该能够yum/apt-get安装任何东西，因为他们不应该有root访问权限。我希望您的环境也是如此…</li><li id="b15a" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">测试不同版本的包/应用程序变得非常容易。只需加载/卸载相关的模块，不需要做长时间或复杂的安装/卸载或玩弄依赖关系。</li><li id="22d1" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">您可以提供许多不同版本的包或应用程序，用户可以根据自己的需要选择他们想要的。即使几年后，这些模块仍然可用，不需要删除它们，因为环境已经升级。相反，您可以提供最先进的模块alpha版本，而不会将整个环境置于危险之中。</li><li id="972e" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">用户的环境保持整洁，不会因为安装的库而变得杂乱。此外，他们不必在每次想要运行特定笔记本电脑时都进行所有这些安装。模块加载/卸载速度更快，因为事实上所有内容都已经装载到pod中。</li><li id="8258" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">对于系统管理员来说，生活变得简单多了。只有一个容器映像需要管理。这就是为什么这个项目被称为开放数据中心-汉兰达，“只能有一个！”。</li></ul></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="a91a" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">但是等等，还有更多！</h1><p id="dc19" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">在第一个基本示例中，我加载了一个Python包。但正如我之前所说，它也可以是一个完整的应用程序，甚至是一个拥有自己的Web UI的应用程序，如RStudio-Server。为了实现这一点，我将使用jupyter-server-proxy和一些特殊的配置，使它在模块加载时出现在启动器中。</p><p id="794c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">加载模块:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/f4149700b74d28673b32a39421de4562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mi1fMbJFh5mm67OjokIcQA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">加载模块(作者截图)</p></figure><p id="6bd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">RStudio会出现一个新的单幅图块:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/5c61dd90033ef8d69aeb45a5cbaadf7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*TgjZ0m0KrorMAhzgogkHdA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">新RStudio磁贴(作者截图)</p></figure><p id="4abb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你点击磁贴时，浏览器会打开一个新标签，RStudio会在几秒钟内启动。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/fd645b45a8f38755f2c8762d3fbca50a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2lunDWQXH9QqpVFSQM_kZw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">RStudio(作者截图)</p></figure><p id="77db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是与以前相同的容器环境，这意味着您可以访问相同的文件、相同的工具……这在您想要混合使用R和Python脚本时非常有用，反之亦然！</p><h1 id="73b2" class="mb mc iq bd md me oa mg mh mi ob mk ml jw oc jx mn jz od ka mp kc oe kd mr ms bi translated">更多关于如何使用它的细节</h1><p id="028d" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">在下面的报告中，您将找到完整的部署说明和代码，包括一个预编译的模块库，该库易于在您的开放式数据中心环境中部署:<a class="ae kv" href="https://github.com/guimou/odh-highlander" rel="noopener ugc nofollow" target="_blank">https://github.com/guimou/odh-highlander</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/ca31b605fb39b77f7d723aa24052925b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yIYnkr8Xcsn2hT9h98lP-w.png"/></div></div></figure><p id="c070" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦部署好一切，您就可以这样做了…</p><p id="8b93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在您的JupyterLab实例中，您可以访问一个新的扩展“软件”。可用模块列表分为两部分。“特色”模块和完整列表(这只是我在这个演示环境中选择提供的模块):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/773db2012df1675f101417ffb722f715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-fkaLTpQC2cG9sTO.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模块列表(作者截图)</p></figure><p id="8929" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用过滤器框来搜索特定的模块(只需输入几个字母)。过滤同时发生在两个列表上:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/c234e6d654750107e341fe507bc75690.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/0*Dqt1x71LF77Koll7.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">过滤列表(作者截图)</p></figure><p id="05ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你点击一个模块名，一个弹出窗口会给你更多的信息:描述，依赖关系，…</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/9e6d52d98b7d8f991a88b00141be4a7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZSpeDlsxF1NNpSQW.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模块信息(作者截图)</p></figure><p id="9f76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要加载模块，请将鼠标悬停在模块上，然后单击“加载”按钮:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5e0980313e68c54ad16123c2784ba24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/0*QYj-brX43fFJhJKe.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模块加载(作者截图)</p></figure><p id="87cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">模块及其所有依赖项被自动加载(本例中为torchvision):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/1aa1e3f2158ce4c331dd5421c6680718.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/0*8oqpPgvA4iHM9VHo.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模块已加载(作者截图)</p></figure><p id="12aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要卸载模块，请将鼠标悬停在“已加载”列表上，然后单击“卸载”:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/ca0656c17e6dde2ba915c53f86b6760c.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/0*3dUKqe3BcS90767B.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">卸载模块(作者截图)</p></figure><p id="1f85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">模块及其依赖项将被自动卸载。</p><p id="a07d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lt">注意</em> : <a class="ae kv" href="https://lmod.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Lmod </a>，模块管理器引擎，跟踪每个模块加载的依赖关系。如果两个不同的模块共享依赖关系，一个模块卸载不会影响另一个模块，它的依赖关系仍然存在。只有当模块不再需要它们时，它们才会被卸载！</p><h1 id="bcfe" class="mb mc iq bd md me oa mg mh mi ob mk ml jw oc jx mn jz od ka mp kc oe kd mr ms bi translated">高级功能</h1><h2 id="4e4e" class="ok mc iq bd md ol om dn mh on oo dp ml lf op oq mn lj or os mp ln ot ou mr ov bi translated">收集</h2><p id="25e3" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">如果您想要创建一个特定的环境，其中包含一组您想要使用的不同模块，那么不需要每次都从scracth重新创建它！您可以简单地加载这些模块，然后创建一个“集合”。下一次，只需双击即可恢复此收藏。</p><p id="d6fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要创建一个集合，请加载您想要的模块，单击图标并为集合命名。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/f7362fd40544c78d7666789fdd6c6c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/0*2v6eQNEM_0Pihf5y.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建收藏(作者截图)</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/8e7814d0b12bee3e8b3da8c369f73fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/0*0yFRDEsJ7MviACA7.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">命名并保存收藏(作者截图)</p></figure><p id="6d72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您想要恢复这个环境时，只需单击恢复图标，然后选择并加载您的集合。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/f364d89f46a6c425234a28efc1dd65ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/0*ag33VfKCxUkT3RmQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">还原收藏(作者截图)</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/1f2b45b666e91193db3a96c15571065f.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/0*OmTs20o9YYp3vWl2.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">还原收藏(作者截图)</p></figure><h2 id="b38c" class="ok mc iq bd md ol om dn mh on oo dp ml lf op oq mn lj or os mp ln ot ou mr ov bi translated">进口</h2><p id="f54f" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">您也可以直接从笔记本和脚本加载您需要的模块。要知道要用到哪些模块，可以直接导出相关的Python代码！</p><p id="3527" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击“生成Python代码”图标:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/47c494c79757ec436d4665e4041a4102.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/0*UHmmodJDp8MUUmxe.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成代码(作者截图)</p></figure><p id="d5e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，您可以将完整的代码复制粘贴到您的第一个笔记本单元格或脚本中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/955345ca8938d42830a778fe66d7a64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YFhrdBBqX8thnUKF.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Python代码(作者截图)</p></figure><p id="d3a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lt">注意</em>:当然，为了在您的笔记本或脚本中工作，您正在使用的容器映像或环境必须是“支持lmod的”，并且具有相关模块的库必须可访问/安装到该环境中。</p><h1 id="81af" class="mb mc iq bd md me oa mg mh mi ob mk ml jw oc jx mn jz od ka mp kc oe kd mr ms bi translated">下一步是什么？</h1><p id="9e40" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">如前所述，您将在此回购中找到部署此解决方案的所有资源和说明。在接下来的文章中，我将详细介绍技术实现，尤其是:</p><ul class=""><li id="0ccd" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nq nm nn no bi translated">如何创建一个环境来创建你自己的模块。</li><li id="6f43" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">关于如何使用<a class="ae kv" href="https://easybuild.io/" rel="noopener ugc nofollow" target="_blank"> EasyBuild </a>创建模块的说明和示例。</li><li id="426f" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">如何创建一个<a class="ae kv" href="https://lmod.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Lmod </a>增强的JupyerLab容器映像来使用模块库。</li><li id="f180" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">如何创建特定于硬件的模块(比如支持cuda，需要GPU)，并使它们只在相关的基础设施上可用。</li></ul><h1 id="e536" class="mb mc iq bd md me oa mg mh mi ob mk ml jw oc jx mn jz od ka mp kc oe kd mr ms bi translated">多谢</h1><p id="29f6" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我必须感谢许多人和组织，因为我在这里没有发明任何东西。我只是把一些项目组合起来，把一些解决方案从一个世界移植到另一个世界，瞧！</p><ul class=""><li id="3e27" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nq nm nn no bi translated"><a class="ae kv" href="https://opendatahub.io/" rel="noopener ugc nofollow" target="_blank"> Open Data Hub </a>团队，感谢他们创建了这个奇妙的数据科学环境，它非常容易在OpenShift上部署。</li><li id="ff8a" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">EasyBuild社区当然感谢他们创造的伟大工具，但也感谢他们的热烈欢迎(感谢Kenneth！)，以及愿意回答我的dum新手问题(谢谢马克西姆！).</li><li id="c845" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated"><a class="ae kv" href="https://www.computecanada.ca/" rel="noopener ugc nofollow" target="_blank"> Compute Canada </a>，是谁让我发现了这种解决方案。他们的设置是病态的，尤其是他们在整个组织中分配模块的方式，真了不起！</li><li id="bce2" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated"><a class="ae kv" href="https://github.com/cmd-ntrf" rel="noopener ugc nofollow" target="_blank"> CMD-NTRF </a>、费利克斯-安托万·福廷，出色的Jupyter-Lmod扩展，通过Jupyter中流畅的用户界面将解决方案提升到另一个层次。</li></ul><h1 id="9baf" class="mb mc iq bd md me oa mg mh mi ob mk ml jw oc jx mn jz od ka mp kc oe kd mr ms bi translated">参考和链接</h1><ul class=""><li id="bf65" class="ng nh iq ky b kz mt lc mu lf pc lj pd ln pe lr nq nm nn no bi translated">回购与指令:<a class="ae kv" href="https://github.com/guimou/odh-highlander" rel="noopener ugc nofollow" target="_blank">https://github.com/guimou/odh-highlander</a></li><li id="7d94" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">启用Lmod的JupyterLab:<a class="ae kv" href="https://github.com/guimou/s2i-lmod-notebook" rel="noopener ugc nofollow" target="_blank">https://github.com/guimou/s2i-lmod-notebook</a></li><li id="55ec" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">各种EasyConfigs(如果你想看看哪些模块已经可用):<a class="ae kv" href="https://github.com/easybuilders/easybuild-easyconfigs" rel="noopener ugc nofollow" target="_blank">https://github.com/easybuilders/easybuild-easyconfigs</a></li><li id="93ac" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">各种定制简易配置:<a class="ae kv" href="https://github.com/guimou/odh-easyconfigs" rel="noopener ugc nofollow" target="_blank">https://github.com/guimou/odh-easyconfigs</a></li><li id="3bff" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">开放数据中心文档:【http://opendatahub.io/docs.html T2】</li><li id="e26d" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">EasyBuild文档:【https://docs.easybuild.io/en/latest/ T4】</li><li id="08e9" class="ng nh iq ky b kz nr lc ns lf nt lj nu ln nv lr nq nm nn no bi translated">加拿大计算机展上的EasyBuild展示:<a class="ae kv" href="https://www.youtube.com/watch?v=eQ1_iWSnJaI" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=eQ1_iWSnJaI</a></li></ul></div></div>    
</body>
</html>