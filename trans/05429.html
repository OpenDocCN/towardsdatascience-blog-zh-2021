<html>
<head>
<title>Gacha Simulation using Monte Carlo Method in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中用蒙特卡罗方法模拟Gacha</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gacha-simulation-using-monte-carlo-method-in-r-3897ce611458?source=collection_archive---------28-----------------------#2021-05-13">https://towardsdatascience.com/gacha-simulation-using-monte-carlo-method-in-r-3897ce611458?source=collection_archive---------28-----------------------#2021-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/2c3b7f78a421cacbf37b9ce4583c3826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L2CJ03nHkuv4242l"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://unsplash.com/@ubahnverleih?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> C M </a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><div class=""/><div class=""><h2 id="5605" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">不是运气。概率就是这样的。</h2></div><h2 id="50c7" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">动机</h2><p id="3692" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">蒙特卡罗模拟方法是模拟理论中最流行的方法之一，它依靠重复随机抽样来获得期望的数值结果。这种方法有很多应用，如A/B检验、从贝叶斯推断的后验分布中模拟随机样本、期权定价、风险分析等等。</p><p id="7fb0" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">另一方面，手机游戏近年来变得越来越受欢迎，其中一个主要功能是向玩家提供兑换某种稀有物品或角色的能力。这个特征通常被称为<em class="mp">嘎查</em>。</p><p id="9d14" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">在这篇文章中，我将解释如何应用蒙特卡罗方法来模拟你将使用r得到的gacha。</p><h2 id="c5ea" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">概念:蒙特卡罗模拟法</h2><p id="cf8b" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">蒙特卡洛方法的思想是利用随机性来解决通常(原则上)是确定性的问题。具体来说，在进行模拟时，蒙特卡罗方法的过程可以解释如下。</p><ol class=""><li id="c1d3" class="mq mr jg lt b lu mk lx ml le ms li mt lm mu mj mv mw mx my bi translated">定义可能输入的域和每个输入的频率，</li><li id="414c" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">根据输入计算概率密度函数(PDF ),</li><li id="154f" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">从pdf中计算累积密度函数(CDF)，</li><li id="9f3d" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">生成均匀分布在(0，1)中的随机数，</li><li id="b915" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">基于CDF将随机数值指定为输入之一，</li><li id="9f2f" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">重复步骤4和5，直到达到所需数量的模拟结果。</li></ol><p id="f3de" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">为了在实践中更好地理解这种方法，这里我将实现蒙特卡罗方法来模拟您将得到的gacha。我将在这里使用的编程语言是r。</p><h2 id="3846" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">履行</h2><p id="65c3" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">假设我们想要模拟的gacha系统遵循这些规则:</p><ol class=""><li id="b305" class="mq mr jg lt b lu mk lx ml le ms li mt lm mu mj mv mw mx my bi translated">可用物品稀有度为3、4和5级(通常分别表示为3星、4星和5星)。我们将使用它们作为我们可能输入的域。</li><li id="a050" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">对于3级、4级和5级稀有物品，该物品在一次投掷中获得的概率分别为0.945、0.05和0.005。</li><li id="efeb" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">如果在连续9次掷骰中，玩家还没有获得4级稀有物品，那么第10次掷骰将保证玩家获得4级稀有物品。这个卷通常被称为<strong class="lt jh">怜悯卷</strong>。</li><li id="0ce7" class="mq mr jg lt b lu mz lx na le nb li nc lm nd mj mv mw mx my bi translated">如果在连续89次掷骰中，玩家还没有获得5级稀有物品，那么第90次掷骰将保证玩家获得5级稀有物品。</li></ol><p id="3ed5" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">根据上面的规则，我们可以如下创建每个卷的PDF。</p><figure class="nf ng nh ni gt is gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/330e665beecb95fe789f7fe16987f67e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*y2KDSwHSap1fDJTi_ILNfg@2x.png"/></div></figure><p id="e738" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">其中x表示该物品的稀有程度。从上面的PDF中，我们可以创建逆CDF来将均匀分布在(0，1)中的随机数分配给每个稀有级别，如下所示。</p><figure class="nf ng nh ni gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/87d6d9c2cdc6f6c47aee71af920e6d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R5kC_BKSxds3Fb4FvEiQZg@2x.png"/></div></div></figure><p id="91af" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">其中u表示均匀分布在(0，1)中的生成的随机数。请记住，上面的逆CDF不包括4级和5级稀有物品的同情骰，因为它只计算一次。</p><p id="ed18" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">然后，我们用这几行代码编写函数来模拟gacha过程。</p><figure class="nf ng nh ni gt is"><div class="bz fp l di"><div class="nk nl l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">蒙特卡洛模拟嘎查，代码由作者编写</p></figure><p id="84bc" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">让我们通过运行50次gacha roll模拟来尝试上面的代码。结果如下(<strong class="lt jh">注意，每次运行模拟</strong>的结果可能不同)。</p><pre class="nf ng nh ni gt nm nn no np aw nq bi"><span id="03ae" class="kv kw jg nn b gy nr ns l nt nu">&gt; x=runif(50)<br/>&gt; rarity=3:5<br/>&gt; PDF=c(0.945,0.05,0.005)<br/>&gt; sim=mc.sim(x,rarity,PDF)<br/>Gacha Simulation Table<br/>  rarity   PDF   CDF<br/>1      3 0.945 0.945<br/>2      4 0.050 0.995<br/>3      5 0.005 1.000</span><span id="b6ed" class="kv kw jg nn b gy nv ns l nt nu">The 1 th roll produces : 3 star rarity item. <br/>The 2 th roll produces : 3 star rarity item. <br/>The 3 th roll produces : 3 star rarity item. <br/>The 4 th roll produces : 3 star rarity item. <br/>The 5 th roll produces : 3 star rarity item.<br/>...<br/>The 46 th roll produces : 3 star rarity item. <br/>The 47 th roll produces : 3 star rarity item. <br/>The 48 th roll produces : 3 star rarity item. <br/>The 49 th roll produces : 4 star rarity item. <br/>The 50 th roll produces : 3 star rarity item.<br/>&gt; table(sim)<br/>sim<br/> 3  4 <br/>44  6</span></pre><p id="66bb" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">从上面的模拟中我们可以看到，我们获得了6个4星稀有项目，对于gacha游戏的初学者来说还不错！让我们把它增加到70次模拟，看看有什么不同。</p><pre class="nf ng nh ni gt nm nn no np aw nq bi"><span id="67ad" class="kv kw jg nn b gy nr ns l nt nu">&gt; x=runif(70)<br/>&gt; rarity=3:5<br/>&gt; PDF=c(0.945,0.05,0.005)<br/>&gt; sim=mc.sim(x,rarity,PDF)<br/>Gacha Simulation Table<br/>  rarity   PDF   CDF<br/>1      3 0.945 0.945<br/>2      4 0.050 0.995<br/>3      5 0.005 1.000</span><span id="15bb" class="kv kw jg nn b gy nv ns l nt nu">The 1 th roll produces : 4 star rarity item. <br/>The 2 th roll produces : 3 star rarity item. <br/>The 3 th roll produces : 3 star rarity item. <br/>The 4 th roll produces : 3 star rarity item. <br/>The 5 th roll produces : 3 star rarity item.<br/>...<br/>The 16 th roll produces : 3 star rarity item. <br/>The 17 th roll produces : 5 star rarity item. <br/>The 18 th roll produces : 3 star rarity item.<br/>...<br/>The 66 th roll produces : 3 star rarity item. <br/>The 67 th roll produces : 3 star rarity item. <br/>The 68 th roll produces : 3 star rarity item. <br/>The 69 th roll produces : 3 star rarity item. <br/>The 70 th roll produces : 3 star rarity item.<br/>&gt; table(sim)<br/>sim<br/> 3  4  5 <br/>61  8  1</span></pre><p id="93af" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">伟大的结果！1件五星级稀有品和8件四星级稀有品，这就是我们所说的好嘎查！</p><h2 id="a877" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h2><p id="e8a6" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们到了。本文解释了蒙特卡罗方法在模拟理论中的许多实现之一，您可以在其他领域中实现它，如风险度量、期权定价等等。</p><p id="4efe" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">像往常一样，如果您有任何问题，请随时提问和/或讨论！我的下一篇文章再见！保持安全，保持健康！</p><figure class="nf ng nh ni gt is gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/5bc2c59b4facde9bbd852fc56a1a2df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*t35UHxspGN0TGa226tRGfg.jpeg"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">可能发生在你读完这篇文章之后(图片来自<a class="ae jd" href="https://imgflip.com/i/59fhrf" rel="noopener ugc nofollow" target="_blank"> Imgflip </a></p></figure><h2 id="ff2a" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">作者的联系人</h2><p id="8d15" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">领英:<a class="ae jd" href="https://www.linkedin.com/in/raden-aurelius-andhika-viadinugroho-b84b19163/" rel="noopener ugc nofollow" target="_blank">拉登·奥勒留和希卡·维亚迪努格罗霍</a></p><p id="d0bd" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">中:<a class="ae jd" href="https://medium.com/@radenaurelius" rel="noopener">https://medium.com/@radenaurelius</a></p><h2 id="5eb6" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">参考</h2><p id="174e" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">[1] Enrico，Z. (2013年)。<a class="ae jd" href="https://link.springer.com/book/10.1007/978-1-4471-4588-2" rel="noopener ugc nofollow" target="_blank"> <em class="mp">系统可靠性与风险分析的蒙特卡罗模拟方法</em> </a>。可靠性工程中的斯普林格级数。伦敦:斯普林格。</p><p id="9efe" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">[2]<a class="ae jd" href="https://bookdown.org/s3dabeck1984/bookdown-demo-master/monte-carlo-simulations.html" rel="noopener ugc nofollow" target="_blank">https://book down . org/S3 dabeck 1984/book down-demo-master/Monte-Carlo-simulations . html</a></p><p id="7932" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">[3]罗伯特，C. P .和卡塞拉，G. (2010年)。<a class="ae jd" href="https://link.springer.com/book/10.1007/978-1-4419-1576-4" rel="noopener ugc nofollow" target="_blank"> <em class="mp">用R介绍蒙特卡罗方法</em> </a>。用R！。伦敦:斯普林格。</p><p id="2563" class="pw-post-body-paragraph lr ls jg lt b lu mk kh lw lx ml kk lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">[4]s . m .罗斯(2013年)。<a class="ae jd" href="https://www.sciencedirect.com/book/9780124158252/simulation" rel="noopener ugc nofollow" target="_blank"> <em class="mp">模拟，第五版</em> </a>。爱思唯尔。</p></div></div>    
</body>
</html>