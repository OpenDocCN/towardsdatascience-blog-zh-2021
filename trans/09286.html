<html>
<head>
<title>From Bayes’ Theorem to Bayesian Inference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从贝叶斯定理到贝叶斯推理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-bayes-theorem-to-bayesian-inference-b261124633a6?source=collection_archive---------18-----------------------#2021-08-28">https://towardsdatascience.com/from-bayes-theorem-to-bayesian-inference-b261124633a6?source=collection_archive---------18-----------------------#2021-08-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2d50" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过概率分布而不仅仅是点概率来理解定理</h2></div><p id="d04d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">贝叶斯定理是概率论中的一个重要定律。它适用于频率主义者，以及贝叶斯统计。然而，使用贝叶斯定理本身并不等于我们所认为的“贝叶斯统计”。在本文中，我们将回顾贝叶斯定理，并仔细展示它如何推广到贝叶斯推理。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/c8f182b03b3e8e87277a8201ac1ea461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ymYrFyFrYUDn4lHu"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated"><a class="ae lu" href="https://unsplash.com/@tingeyinjurylawfirm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">廷杰伤害律师事务所</a>在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8ac8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">贝叶斯定理</h1><p id="d53d" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">贝叶斯定理给了我们一个解决<strong class="kk iu">条件概率</strong>的方法。例如，假设(或有条件的)检测结果为阳性，患者患病的概率有多大？这是教科书上的典型例子。公式如下:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi na"><img src="../Images/e66dbc23157be99c3f439963e9b824cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3LjYXk9Z7TtjB2JiSoSpxg.png"/></div></div></figure><p id="4654" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们知道测试有多好(即给定患者有或没有疾病的阳性测试的概率，P(T=pos|D=true)或P(T=pos|D=false))和疾病的基线概率P(D)，那么我们可以获得给定阳性测试的疾病的更新概率。</p><p id="85f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们如何获得P(T=pos)，一个阳性测试的基线概率？</p><p id="b46b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它只是两种可能性的总和:患者测试呈阳性并患有疾病，以及患者测试呈阳性但未患病。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nb"><img src="../Images/11ef8e13570dc960583cdd7167b6d375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVphVFWkouuRW9_9AfnSoA.png"/></div></div></figure><h1 id="e3bf" class="mc md it bd me mf nc mh mi mj nd ml mm jz ne ka mo kc nf kd mq kf ng kg ms mt bi translated">简单的例子</h1><p id="ed10" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">一项测试的真阳性率为0.9，假阳性率为0.05。在人群中，有0.5%的患者患有这种疾病。假设患者检测呈阳性，那么患者患病的概率有多大？</p><p id="0894" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以将这些值代入贝叶斯定理得到我们的答案</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nh"><img src="../Images/30a011adc4ded641cdadcd63ccf8ae7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Sd9sdexlPQckSwVbDJufw.png"/></div></div></figure><p id="f5a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以给定一个阳性测试，病人得这种病的概率只有8.3%。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="07c3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">概率分布</h1><p id="472d" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">为了理解贝叶斯定理与贝叶斯推理的关系，我们必须通过<strong class="kk iu">概率</strong> <strong class="kk iu">分布</strong>来理解该定理，而不仅仅是点概率。概率分布只是给出了任何情况下所有可能结果的概率，而不仅仅是最可能的结果。</p><p id="93fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">概率分布可以是连续的，如随机选择的人的预期智商(正态分布，均值=100，标准差=10):</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/318603c75c28a26507c7a098462ffe95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*wi9Ap9XeyHY7LplnAL_wLg.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="0b17" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者像我们前面的例子那样是离散的。我们将展示给定疾病P(T=1|D)的阳性测试结果的概率。这只是一个伯努利概率分布:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/9eaca77467386c4ffb579a8d567b2c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*YQbbtpY97iQ5YRMQy3rGzg.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><h1 id="e048" class="mc md it bd me mf nc mh mi mj nd ml mm jz ne ka mo kc nf kd mq kf ng kg ms mt bi translated">离散推理</h1><p id="9f0d" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在贝叶斯推理中，我们希望在给定一些数据和关于这些参数的先验信念的情况下，学习模型参数的一些概率分布。我们使用贝叶斯定理来做这个推论:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nk"><img src="../Images/d9cbdd2c8deabff6e2cbfb4dd6755f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kgbf_atXvz9LbCZhJpKUwA.png"/></div></div></figure><p id="b440" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这似乎有点抽象，我们再举一个例子来说明这个推论。</p><p id="1b57" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设我在地板上发现一枚25美分的硬币。当我把两角五分的硬币留在口袋里，不小心碰到要洗的衣服时，奇怪的事情发生了:硬币弯曲了，变得有偏差，翻转了90%的正面和10%的反面。不幸的是，我不知道我刚刚发现的这枚硬币是装的还是公平的。我相信硬币有50%的机会被装上。幸运的是，我可以通过抛硬币来判断我的硬币是否公平。</p><p id="dd83" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个场景中，我们只有1个参数:<em class="mz"> p </em>，翻头的概率。我们为p=0.5(无偏)分配50%的先验置信，为p=0.9(有偏)分配50%的置信。</p><p id="58a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们的P(参数)先验如下:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nl"><img src="../Images/b978da938eb3fcbf4f3e761fe127856e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*SnR83NJu6RHy6SnWJcm-Vg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="eb1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这有点主观，因为选择先验可能是。</p><p id="029b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设我们掷一次硬币。我们有人头了！</p><p id="4063" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们想知道<em class="mz">更新后的</em>我们的硬币被装载的概率:P(p=0.9 |头)。</p><p id="2ce5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们用贝叶斯定理来解决这个问题。注意:按照惯例，我们现在将使用<em class="mz"> θ </em>来表示参数，使用<em class="mz"> X </em>来表示数据。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/31d7ce8b3f849e21af26b8ebc6396193.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*pOOk03ZpUJ2czoJC1RFC8w.png"/></div></figure><p id="bf19" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在有64%的把握硬币已经装好了！为了找到公平的概率，我们可以用p=0.5重做那个等式。或者，我们可以利用我们只处理2种可能性的事实，认识到p(公平|数据)= 1-p(加载|数据)= 0.36。</p><p id="12af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">重要的是，我们也可以忘记分母，计算两个P值的P(X|p)P(p ),然后我们就有了相对后验概率。这是因为P(X)对于两种计算是相同的。如果你更深入地阅读贝叶斯统计，你会发现贝叶斯定理被写成一种比例关系，比如:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/3c8d9406a7ece7a2396fef2588828f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*7eLDXKAWj6k003B0Ibmy-g.png"/></div></figure><p id="80e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中∝表示“成比例”。</p><p id="9ccc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的<strong class="kk iu">后验</strong>概率现在看起来是这样的:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi no"><img src="../Images/97a1b935a8c92bd11d642b092b29fbde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*MnrL7Kac82ZslsOr8tbWOQ.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="aa99" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们再次抛硬币，我们现在可以<strong class="kk iu">使用我们之前的后验概率(P(loaded) = 0.64)作为我们下一次迭代</strong>的先验。所以我们第二次抛硬币，又是正面！让我们更新一下我们的后路。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi np"><img src="../Images/ce543f1ecf9e202312994a9f71d2a233.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*HFhf6dQJKsltKpbCXz2ehw.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">注意，这里的先验P(p)是前一次迭代的后验</p></figure><p id="20fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们更加确信(76%确定)我们的硬币已经装满了。这是我们更新后的后验概率分布:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nq"><img src="../Images/906dd95a3dc9ae3b6e2b8678393d0e3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*XDrfjW3b0GGccr8M-uJzaQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="c5b5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是贝叶斯统计的一个有趣的方面:随着越来越多的数据进来，我们可以不断更新我们的信念。</p><p id="277a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们先抛硬币两次，然后我们想用所有的数据计算一次后验概率，会怎么样呢？别担心！通过一次使用所有数据，而不是对每个数据点重复计算，可以得到相同的结果。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/cfe459997d1678b723ba4fb2106ba873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*mWQYJsvbTY2x76ygGq7fLQ.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">注意:用装载的硬币翻转正面然后正面的概率是0.9 * 0.9；公平硬币是0.5*0.5</p></figure><h1 id="7ae7" class="mc md it bd me mf nc mh mi mj nd ml mm jz ne ka mo kc nf kd mq kf ng kg ms mt bi translated">连续推理</h1><p id="30d0" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">让我们介绍一个稍微真实一点的场景。一个季度的公平性不是只有两个不同的值，而是连续的。我们知道大多数硬币是非常公平的(接近p = 0.5)，但是一些铸造的硬币更不公平。我们认为公平值的标准偏差(也就是我们的正面概率的p参数)大约是0.1。所以如果我们找到一个25美分的硬币，我们对它的公平性的先验信念是这样的:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/a0d87420af7beea7d11e073f9934a464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*xH4bWHRCyP-la9in-rH_lA.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="8254" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个连续的概率密度函数。虽然我们没有得到离散值的点概率(即p = 0.6的概率是多少)，但我们可以解释相对概率(即p=0.5的概率是p=0.4的两倍)或p在给定区间内的概率(即p在0.4和0.6之间的概率为68%)。</p><p id="7aa1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有了先验信念，让我们抛硬币，找出后验概率分布。</p><p id="60aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们抛硬币，我们得到反面。回到比例贝叶斯定理:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/de0b5f372dc0ad4f6d42cbb6335b0bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*FW3WKUNIhHyCHmWwlQLc4Q.png"/></div></figure><p id="ee98" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们知道P(P)；这是我们刚刚定义的先验概率分布。但是当P的可能值是无穷大时，我们如何选择P的哪些可能值来计算P(X | p)？我们如何将这两个分布相乘呢？如果我们有一个有几个参数(而不是只有一个)的模型，我们如何考虑所有可能的参数组合？</p><p id="63c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些问题比较难。</p><p id="984b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于我们假设先验和后验来自同一概率分布“族”的情况，我们可以利用<strong class="kk iu">共轭</strong>先验来解析求解我们的后验。如果我们不能对我们的后验分布做出这些严格的假设，我们可以使用蒙特卡罗技术来采样并慢慢建立我们的后验分布。</p><p id="1525" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我不会深入研究这些技术。目的是建立一种直觉，关于贝叶斯定理如何应用于推理。我们从一个简单的模型开始，以了解先验、后验，以及我们如何不断增加数据和更新我们的模型。然后我们看了一个稍微复杂一点的模型，以理解为什么应用贝叶斯需要更多的工作。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="d8c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于进一步的阅读，我推荐Richard McElreath的《统计学再思考》,尤其是他关于蒙特卡罗方法的章节。为什么有偏见的硬币实际上是不现实的，看看这篇<a class="ae lu" href="http://www.stat.columbia.edu/~gelman/research/published/diceRev2.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>。</p></div></div>    
</body>
</html>