<html>
<head>
<title>Automating Machine Learning Modelling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化机器学习建模</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-machine-learning-modelling-62aac2081e3f?source=collection_archive---------28-----------------------#2021-07-27">https://towardsdatascience.com/automating-machine-learning-modelling-62aac2081e3f?source=collection_archive---------28-----------------------#2021-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2982" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用MLBox创建高度优化的机器学习模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/62e23f1bc54429831195dc4af3812e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SQiGcEgtLg_Z7dAl"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·温克勒在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="06de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建机器学习模型并不是一项困难的任务，因为Python提供了大量的库，可以帮助创建与回归、分类等问题相关的模型。像Sklearn Statsmodel这样的Python包可以用来创建这些模型，但困难的部分是优化和概括这些模型，以便它们也可以处理看不见的数据。</p><p id="e711" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，单独创建一个机器学习模型并不能解决问题，我们还应该能够调整这些模型的超参数，使其通用化，并实现更高的性能和精度。有大量的机器学习模型，我们可以从中选择最适合我们数据集的模型，但这是一个耗时的过程，因为我们需要为每个算法编写代码和训练模型。类似地，如果我们能够选择模型，那么我们需要选择模型的最佳超参数，这也是一个耗时的过程。</p><p id="8efd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，为了减少这些过程中花费的精力和时间，我们可以使用MLBox实现自动化。它是一个开源python库，用于自动化机器学习过程，包括特征选择、超参数优化、创建模型以及使用该模型生成预测。</p><p id="2870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将探索MLBox提供的一些功能。</p><p id="5cfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧…</p><h1 id="10b5" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装所需的库</h1><p id="b8e7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将从使用pip安装MLBox开始。下面给出的命令可以做到这一点。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7ce2" class="mx lw it mt b gy my mz l na nb">!pip install mlbox</span></pre><h1 id="e3f8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">导入所需的库</h1><p id="e19b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这一步，我们将导入自动化机器学习过程所需的库。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8052" class="mx lw it mt b gy my mz l na nb">from mlbox.preprocessing import *<br/>from mlbox.optimisation import *<br/>from mlbox.prediction import *</span></pre><h1 id="3872" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">正在加载数据集</h1><p id="b7b3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对于本文，我们将使用著名的糖尿病数据集，这是一个分类问题。我已经将数据分为测试和训练两个不同的电子表格。这个数据集的目标变量是“结果”。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="e0b8" class="mx lw it mt b gy my mz l na nb">paths = ["/content/train.csv","/content/test.csv"]<br/>target_name = "Outcome"</span></pre><p id="e1c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此之后，我们将使用读取器读取数据，并测试火车分割数据。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="fc75" class="mx lw it mt b gy my mz l na nb">rd = Reader(sep = ",")<br/>df = rd.train_test_split(paths, target_name)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/4bb37cef13dc413d4d15ca50f30dc704.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*fJBuNnbi-MXgySHK_m6oaw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="ca44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里您可以看到，在拆分数据的同时，它还对数据进行了清理和预处理。</p><h1 id="5c2c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建模型</h1><p id="5a21" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">接下来，我们将定义优化器以及我们将为此数据集考虑的模型。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="abcb" class="mx lw it mt b gy my mz l na nb">#Defining Optimiser<br/>opt = Optimiser(scoring = "accuracy", n_folds = 5)</span><span id="fdcd" class="mx lw it mt b gy nd mz l na nb">#Defining the model<br/>space = {<br/>'est__strategy':{"search":"choice",</span><span id="fc30" class="mx lw it mt b gy nd mz l na nb">"space":["LightGBM"]},</span><span id="64d7" class="mx lw it mt b gy nd mz l na nb">'est__n_estimators':{"search":"choice",</span><span id="215d" class="mx lw it mt b gy nd mz l na nb">"space":[150]},</span><span id="51f7" class="mx lw it mt b gy nd mz l na nb">'est__colsample_bytree':{"search":"uniform",</span><span id="db73" class="mx lw it mt b gy nd mz l na nb">"space":[0.8,0.95]},</span><span id="9ee4" class="mx lw it mt b gy nd mz l na nb">'est__subsample':{"search":"uniform",</span><span id="abe0" class="mx lw it mt b gy nd mz l na nb">"space":[0.8,0.95]},</span><span id="e16b" class="mx lw it mt b gy nd mz l na nb">'est__max_depth':{"search":"choice",</span><span id="a4ba" class="mx lw it mt b gy nd mz l na nb">"space":[5,6,7,8,9]},</span><span id="f062" class="mx lw it mt b gy nd mz l na nb">'est__learning_rate':{"search":"choice",</span><span id="6a2c" class="mx lw it mt b gy nd mz l na nb">"space":[0.07]}<br/>}<br/>params = opt.optimise(space, df,15)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/4cb5bf4b394ae28926a28313cac85787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ci0-e5GHZlDOXPWKteiDCw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="07d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，您可以清楚地看到MLBox使用LightGBM模型为此数据集导出的最佳超参数。</p><h1 id="9d9f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">特征重要性</h1><p id="4eb1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这一步中，我们将根据我们创建的模型找出该数据集最重要的特征。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="dcfe" class="mx lw it mt b gy my mz l na nb">prd = Predictor()<br/>prd.fit_predict(params, df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/6b1cf2c37abdc4545d6443e9235f9c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rSlbH5R61nNdErAHyj0n2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="47db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，您可以清楚地看到数据集最重要的特征。</p><p id="2012" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">继续用不同的数据集尝试这种方法，并自动化机器学习的过程。如果您发现任何困难，请在回复部分告诉我。</p><p id="1954" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文是与<a class="ng nh ep" href="https://medium.com/u/40808d551f5a?source=post_page-----62aac2081e3f--------------------------------" rel="noopener" target="_blank"> Piyush Ingale </a>合作完成的。</p><h1 id="c870" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在你走之前</h1><p id="ea89" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu"> <em class="ni">感谢</em> </strong> <em class="ni">的阅读！如果你想与我取得联系，请随时联系我在hmix13@gmail.com或我的</em> <a class="ae ky" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="ni"> LinkedIn简介</em> </strong> </a> <em class="ni">。可以查看我的</em><a class="ae ky" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="ni">Github</em></strong><em class="ni"/></a><em class="ni">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae ky" href="https://medium.com/@hmix13" rel="noopener"> <strong class="lb iu"> <em class="ni">我的简介</em> </strong> </a> <em class="ni">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>