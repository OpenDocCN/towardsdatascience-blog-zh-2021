<html>
<head>
<title>Building an Image Classifier to Filter Out Unused Images From Your Photo Album with Python and Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和机器学习构建图像分类器，从相册中过滤掉未使用的图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-an-image-classifier-to-filter-out-unused-images-from-your-photo-album-with-python-and-6bc574ae57de?source=collection_archive---------22-----------------------#2021-12-27">https://towardsdatascience.com/building-an-image-classifier-to-filter-out-unused-images-from-your-photo-album-with-python-and-6bc574ae57de?source=collection_archive---------22-----------------------#2021-12-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/9baf24771bf13ea7656c729c2943b061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TGvCI57rmvq5oJoT"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@invictar1997?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Soragrit Wongsa </a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><div class=""/><div class=""><h2 id="1e68" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使用 Keras 将我的相册图像分类为“保留”或“不保留”</h2></div><p id="850d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">浏览文件夹中的一堆图片，试图找出哪些应该保留，可能会很麻烦。为了解决这个问题，我决定通过构建一个图像分类器来自动化这个过程，该分类器根据我是否想要保留照片来对照片进行分类。</p><p id="3eaa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu">在本文中，我们将使用 Keras 实现一个简单的二进制分类器，将照片分类为“保留”或“不保留”，以自动过滤掉您的个人相册。</em>T12】</strong></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="352a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你愿意，你可以在这里查看我的 Youtube 视频:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="mg mh l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="19ae" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">台阶</h1><p id="f346" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">做到这一点的步骤将是:</p><ul class=""><li id="6767" class="nf ng jj la b lb lc le lf lh nh ll ni lp nj lt nk nl nm nn bi translated"><strong class="la jk">设置和安装</strong></li><li id="29ac" class="nf ng jj la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated"><strong class="la jk">创建数据集</strong></li><li id="120f" class="nf ng jj la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated"><strong class="la jk">创建训练/测试文件夹</strong></li><li id="7c6f" class="nf ng jj la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated"><strong class="la jk">训练模型</strong></li><li id="443c" class="nf ng jj la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated"><strong class="la jk">运行 app </strong></li></ul><p id="d2d0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想跳过这篇文章直接看代码，可以在这里找到<a class="ae jg" href="https://github.com/EnkrateiaLucca/photo_album_filter_ml#readme" rel="noopener ugc nofollow" target="_blank">。现在，让我们来看一下这些步骤。</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="b6bf" class="nt mj jj bd mk nu nv dn mo nw nx dp ms lh ny nz mu ll oa ob mw lp oc od my oe bi translated"><strong class="ak">设置和安装</strong></h2><p id="01e6" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">首先，我们将使用 conda 创建一个环境，并安装必要的包(<code class="fe of og oh oi b">keras</code>、<code class="fe of og oh oi b">matplotlib</code>和<code class="fe of og oh oi b">streamlit</code>):</p><pre class="mc md me mf gt oj oi ok ol aw om bi"><span id="d277" class="nt mj jj oi b gy on oo l op oq">conda create -n photo_album_sorter_ml</span><span id="e3b6" class="nt mj jj oi b gy or oo l op oq">pip install -r requirements.txt</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="fc3c" class="nt mj jj bd mk nu nv dn mo nw nx dp ms lh ny nz mu ll oa ob mw lp oc od my oe bi translated"><strong class="ak">创建数据集</strong></h2><p id="57da" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">我们将采取的第一步是按照创建时间对图像进行分类，并将它们移动到一个名为<code class="fe of og oh oi b">files_with_dates,</code>的文件夹中，以保持图像相对有序:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="os mh l"/></div></figure><p id="2e88" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个脚本中，我们简单地遍历用户提供的文件夹，将图像移动到<code class="fe of og oh oi b">files_with_dates</code>文件夹，同时在文件名中添加创建时间。</p><p id="79da" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要运行此命令，请在终端中键入:</p><pre class="mc md me mf gt oj oi ok ol aw om bi"><span id="d825" class="nt mj jj oi b gy on oo l op oq">python sort_creation_time.py — path ./path/to/your/images/folder</span></pre><p id="b69a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们可以为数据集创建文件夹，我们将标记图像来训练分类器。</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="os mh l"/></div></figure><p id="a662" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，我们只是为数据集创建数据文件夹，并使用 matplotlib 建立一个简单的循环，将图像分类为“保留”或“不保留”。要运行此程序，请执行以下操作:</p><pre class="mc md me mf gt oj oi ok ol aw om bi"><span id="9165" class="nt mj jj oi b gy on oo l op oq">python create_dataset.py</span></pre><p id="ea87" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们将文件拆分到 train 和 test 文件夹中。</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="os mh l"/></div></figure><p id="4925" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我们只是将图像分割为 80%用于训练，20%用于测试。要运行 do:</p><pre class="mc md me mf gt oj oi ok ol aw om bi"><span id="8d5e" class="nt mj jj oi b gy on oo l op oq">python create_train_test.py</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="6d78" class="nt mj jj bd mk nu nv dn mo nw nx dp ms lh ny nz mu ll oa ob mw lp oc od my oe bi translated"><strong class="ak">训练模型</strong></h2><p id="8e40" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">我们将训练两种类型的分类器，从一个经典 CNN 的简单 Keras 实现开始，它是从 Fran ois Chollet 的博客文章<a class="ae jg" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank">中借来的。</a></p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="os mh l"/></div></figure><p id="5d8c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要运行:</p><pre class="mc md me mf gt oj oi ok ol aw om bi"><span id="e446" class="nt mj jj oi b gy on oo l op oq">python train.py — epochs 10 — batch_size 16</span></pre><p id="7671" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意你的图片的大小，在这个实现中，我们根据博客文章中关于猫和狗的例子将所有图片的大小调整为 150x150。</p><p id="8c87" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尽管这个模型的性能不是很好(在我的示例数据集上大约是 58%)，我还是把它作为问题的基线。</p><p id="1999" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还使用取自<a class="ae jg" href="https://keras.io/api/applications/" rel="noopener ugc nofollow" target="_blank"> Keras 文档</a>的模板代码来训练预训练的 inception v3 模型。</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="os mh l"/></div></figure><p id="9e1a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我们只是按照一个基本的设置来微调一个 inception v3 模型，并添加一个小的 CLI 工具来使它易于运行:</p><pre class="mc md me mf gt oj oi ok ol aw om bi"><span id="643d" class="nt mj jj oi b gy on oo l op oq">python train_pretrained.py — epochs 10 — batch_size 16</span></pre><p id="1297" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个模型产生了一些非常令人印象深刻的结果，没有过度拟合，在测试集上达到了 93%的性能！</p><p id="f934" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个好消息，但由于每个人都将使用自己的数据集，因此应该会有不同的表现，这取决于一系列因素，如图像的性质或您想从相册中排除的照片类型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="ac3d" class="nt mj jj bd mk nu nv dn mo nw nx dp ms lh ny nz mu ll oa ob mw lp oc od my oe bi translated"><strong class="ak">运行 app </strong></h2><p id="8d82" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">现在，在训练之后，为了查看分类器的运行情况，我们将编写一个简单的 streamlit 应用程序来包装我们的模型:</p><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="os mh l"/></div></figure><p id="41ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要运行，请键入:</p><pre class="mc md me mf gt oj oi ok ol aw om bi"><span id="0cf7" class="nt mj jj oi b gy on oo l op oq">streamlit run app.py</span></pre><p id="235c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以使用 streamlit 的文件上传程序加载图像，分类将写在图像下方。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="674c" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">关于使用 ML 过滤个人照片的最终想法</h1><p id="a88e" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">鉴于机器学习模型的插值性质，我们总是冒着模型将图像错误分类的风险，这可能最终导致我们丢失我们关心的重要照片，所以我的想法是将这作为一种清除杂乱图像的第一种方法，但在完全删除图像之前，总是先进行粗略的查看。</p><p id="82ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="https://github.com/EnkrateiaLucca/photo_album_filter_ml" rel="noopener ugc nofollow" target="_blank">本文的源代码</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="dff2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢这篇文章，<a class="ae jg" href="https://lucas-soares.medium.com/membership" rel="noopener">加入媒体</a>，<a class="ae jg" href="https://lucas-soares.medium.com/" rel="noopener">关注</a>，<a class="ae jg" href="https://lucas-soares.medium.com/subscribe" rel="noopener">订阅我的简讯</a>。还有，订阅我的<a class="ae jg" href="https://www.youtube.com/channel/UCu8WF59Scx9f3H1N_FgZUwQ" rel="noopener ugc nofollow" target="_blank"> youtube 频道</a>在<a class="ae jg" href="https://www.tiktok.com/@enkrateialucca?lang=en" rel="noopener ugc nofollow" target="_blank"> Tiktok </a>、<a class="ae jg" href="https://twitter.com/LucasEnkrateia" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae jg" href="https://www.linkedin.com/in/lucas-soares-969044167/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae jg" href="https://www.instagram.com/theaugmentedself/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上和我联系！谢谢，下次再见！:)</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="c27c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你对机器学习设备感兴趣，这里有一个来自 MSI 的 3070 GPU 的附属链接:</p><div class="is it gp gr iu ot"><a href="https://www.amazon.com/gp/product/B097MYTZMW/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B097MYTZMW&amp;linkCode=as2&amp;tag=lucassoare079-20&amp;linkId=1fd3f206c6077e5372d08c4518764124" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">微星游戏 GeForce RTX 3070 LHR 8GB GDRR6 256 位 HDMI/DP Nvlink Torx 风扇 4 RGB 安培架构…</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">微星标志性游戏系列的最新版本再次带来了高性能、低噪音效率和美学…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">www.amazon.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ja ot"/></div></div></a></div><blockquote class="pi pj pk"><p id="8ab9" class="ky kz lu la b lb lc kk ld le lf kn lg pl li lj lk pm lm ln lo pn lq lr ls lt im bi translated">这是一个附属链接，如果你购买的产品，我得到一小笔佣金，干杯！:)</p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="bb31" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">参考</h1><ul class=""><li id="39ce" class="nf ng jj la b lb na le nb lh po ll pp lp pq lt nk nl nm nn bi translated"><a class="ae jg" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank">https://blog . keras . io/building-powerful-image-class ification-models-using-very-little-data . html</a></li><li id="9559" class="nf ng jj la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated"><a class="ae jg" href="https://keras.io/api/applications/" rel="noopener ugc nofollow" target="_blank">https://keras.io/api/applications/</a></li></ul></div></div>    
</body>
</html>