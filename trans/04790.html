<html>
<head>
<title>Predict Customer Churn With Precision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">精确预测客户流失</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predict-customer-churn-with-precision-56932ae0e5e3?source=collection_archive---------15-----------------------#2021-04-26">https://towardsdatascience.com/predict-customer-churn-with-precision-56932ae0e5e3?source=collection_archive---------15-----------------------#2021-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dfc7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">平衡精确度和召回率，实现可操作的保留策略</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c8505827f4641b4110773b3ca6863243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdAu9cUEFULpgVX-6qKM8w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://stock.adobe.com/contributor/393/olivier-le-moal?load_type=author&amp;prev_url=detail" rel="noopener ugc nofollow" target="_blank">奥利维尔·勒莫阿尔</a>使用<a class="ae ky" href="https://stock.adobe.com/images/customer-churn-rate-concept-client-or-employee-attrition/298817415?prev_url=detail" rel="noopener ugc nofollow" target="_blank">土坯股票</a>许可证</p></figure><p id="97e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">准确性，请退居二线。我们今天将推广精确和召回。</p><blockquote class="lv lw lx"><p id="c349" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">“客户流失</strong>，又称<strong class="lb iu">客户流失</strong>、<strong class="lb iu">客户流失</strong>，或<strong class="lb iu">客户流失</strong>，是客户或顾客的损失”——维基百科</p></blockquote><p id="9673" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这篇文章，让我们就“客户流失是坏事”和“客户保留是好事”这一普遍假设达成一致。</p><p id="1021" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi mc translated"><span class="l md me mf bm mg mh mi mj mk di">A</span><strong class="lb iu">b摘要:</strong>本文从不同的角度分析了一个被广泛使用的客户流失数据集，该数据集没有合适的功能来盲目部署我们可以生成的最佳预测模型。下面我将分享问题陈述、数据准备步骤、特征分析、可视化，并从我尝试用于预测客户流失的Scikit-learn分类模型中选择Python代码。最重要的是，我将展示通过<strong class="lb iu">沿着精确召回曲线移动决策阈值概率，您可能会发现一些流失案例，在这些案例中，您有足够的信心部署真正的保留行动。</strong></p><p id="5025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简洁起见，我没有包括这个项目中使用的全部代码。详情请参考我在<a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> GitHub </strong> </a> <strong class="lb iu">上的Jupyter笔记本。</strong></p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="8a86" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">商业目标</h1><p id="9007" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">一家销售住宅语音和互联网服务的电信公司(以下简称“TelCo”)正经历着近27%的客户流失率。这种程度的流失可能足以让现实生活中的公司破产。鉴于缺乏公开可用的客户数据，我们使用了<a class="ae ky" href="https://www.kaggle.com/yeanzc/telco-customer-churn-ibm-dataset" rel="noopener ugc nofollow" target="_blank"> IBM Cognos Telco客户流失</a>模拟数据集，其中包含7，043个客户的标记流失。</p><p id="74ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">电信公司希望部署客户维系战略来减少客户流失。公司要求我们:</p><ul class=""><li id="6598" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">开发预测模型，对客户流失风险进行分类</li><li id="432b" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">解释每个预测因子对模型预测的相对影响</li><li id="ff33" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">提出减少客户流失的潜在方法</li></ul><p id="76a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们有一个二元分类问题要解决，所以我们将目标因变量设置为1(流失)或0(保留)。我们将使用度量ROC AUC来优化我们的估计量。ROC AUC是一个<strong class="lb iu">R</strong>OO<strong class="lb iu">C</strong>特性下的<strong class="lb iu">A</strong>rea<strong class="lb iu">U</strong>C曲线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/65eafd588424e0578bc99266d0ba3137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i1qsEY2qLL-REzudiCpYTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由CC0的马丁·托马斯通过<a class="ae ky" href="https://commons.wikimedia.org/wiki/File:Roc-draft-xkcd-style.svg" rel="noopener ugc nofollow" target="_blank">维基共享资源</a></p></figure><p id="7298" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于ROC AUC，随机分类器得分为0.5，而完美分类器得分为1.0。我喜欢ROC AUC，因为它推荐优化真阳性和假阳性率的模型，这些真阳性和假阳性率明显高于随机机会，这不能保证作为评估指标的准确性。这很重要，因为在采取保留措施时，我们需要对我们的正面类别预测(流失)有信心。</p><p id="a129" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于ROC AUC的更多细节，我推荐<a class="ae ky" rel="noopener" target="_blank" href="/understanding-auc-roc-curve-68b2303cc9c5">这篇文章</a>。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="6553" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">客户流失原始数据</h1><p id="dc50" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">让我们先来看看我们必须处理的33个列。将源文件转换为pandas数据框后，前5条记录显示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/938c86d7a52b8132f0c7c8e9d0fe6d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4gTAZtlZvR5v-c5iiICQlw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">截图</a>作者|前19列…</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/c31d44bc7269d6fd78aece345ff9e3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwFVY6fsqHQYDZsoXnqu8Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">作者截图</a>|…最后14栏</p></figure><p id="1ec1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当考虑列作为预测器的潜在用途时，按域对列进行分组是很有帮助的。GitHub笔记本中有一个数据字典，但我是这样看的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/92a0cd044516fb425e7d35d287880864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Z1_iifQ2VWCmvmVeyJAow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="4bf2" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">客户—唯一的customerID表示我们的样本中有7，043个唯一的客户，客户期限从0到72个月不等</li><li id="1f8f" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">人口统计—四个有用的客户人口统计字段</li><li id="6267" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">地理—精确到地理坐标的客户位置</li><li id="fda0" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">服务——八项收费服务(互联网分流到光纤、DSL或无)和两个流指示器</li><li id="736d" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">计费—包括合同类型、计费配置和计费费用</li><li id="85ea" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">流失—流失价值(我们的目标)、流失原因，以及流失分数和客户终身价值的两个内部电信指标。</li></ul><p id="00ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里要注意一点。该数据集仅使用来自不同的<a class="ae ky" href="https://www.kaggle.com/blastchar/telco-customer-churn" rel="noopener ugc nofollow" target="_blank"> Kaggle竞赛</a>的23列进行了广泛建模。我选择了这个有33个专栏的版本，希望额外的地理字段能够实现更深入的见解。最后，他们没有得到回报。当IBM将这些数据放在一起时，他们似乎只给1，653个加利福尼亚邮政编码中的每一个分配了4或5个客户。经过一番努力使地理字段变得有用后，我不再感觉收益递减。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="9430" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">数据准备</h1><p id="3a77" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">我为数据准备和特征创建编写了六个函数。我使用scikit-learn库通过管道中的FunctionTransformer公开了这些函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="6202" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我创建的最有趣的3个功能是:</p><ul class=""><li id="4e4b" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">将4种付款方式映射到“自动付款方式”(1 =是)。</li><li id="0e33" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">将8项服务映射到描述核心服务(电话、光纤/DSL或捆绑语音和互联网)的“产品概况”列，同时还指示分层的“附加”服务，如多线路、技术支持等。</li><li id="24aa" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">创建了“客户收费指数”，衡量每个客户相对于标准价格的相对定价。我使用所有培训数据中的服务组合和增量平均定价来得出每项服务的标准独立价格。在那里，我将每个客户每月的费用与他们一揽子服务的标准价格进行了对比。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/c696da1f9e7897ade2ae5a01acbdc977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YnWmaOsBoz2sWMXHv4X5uQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d415" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在数据剖析和特征分析之前，我将数据分成80%的训练和20%的测试。所有分析仅在训练数据上执行，以避免数据泄漏到任何预测模型中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="af82" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">客户流失特征分析</h1><p id="74cf" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">现在谈谈一些基本的见解。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/eb200f9bb07c410db8f54a0a1a76ae55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x-wTdbeGK8Hu0JwD9S2cPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco_Churn_Training_Analysis.twb" rel="noopener ugc nofollow" target="_blank"> Tableau图</a>作者</p></figure><p id="af9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面可以看出，“有伴侣”、“有受抚养人”、“不是老年人”和“流媒体内容”的流失率较低。没有区分性别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/a31c3297fe4afac048bd571ba44f161a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJKKQsj2PcbDe39bXhC_1A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco_Churn_Training_Analysis.twb" rel="noopener ugc nofollow" target="_blank">作者Tableau图</a></p></figure><p id="c431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">逐月合同存在一个主要问题，相对于定期合同的客户(11%和3%)，逐月合同的客户流失率为43%。更高的客户任期会降低M-T-M接触的流失率，但直到4-5年的任期，流失率才会达到26.7%的总体平均水平。很明显，M-T-M合同以及相关的定价是有问题的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/69fdc69a91d967c717f3d7bbe213107f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCeGGeM-UoiXffyHCiHibg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco_Churn_Training_Analysis.twb" rel="noopener ugc nofollow" target="_blank">作者制作的Tableau图表</a></p></figure><p id="23e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从产品角度来看，M-T-M合同中的互联网光纤使客户流失率超过50%！请注意，电信公司总是要求将电话与互联网光纤捆绑在一起，最大的客户群是签订了M-T-M光纤合同的客户。为其M-T-M合同添加“附加”服务的客户流失率略低。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/d89fb8942c2c4baa9061a92f50bc30e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZmYR2mww776TZiCOT9qaA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco_Churn_Training_Analysis.twb" rel="noopener ugc nofollow" target="_blank">作者制作的Tableau图表</a></p></figure><p id="347a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">客户任期与较高的服务水平和月费正相关(具有统计显著性p值)。我在这里假设客户会随着时间的推移增加服务。我们还可以从上面的散点图中看到，任何互联网服务的M-T-M合同的平均月费用实际上比定期合同的<strong class="lb iu"><em class="ly"/></strong>要低。鉴于流失率更高，这并不直观。这可能表明，需要M-T-M合约的客户比那些愿意签署条款的客户对价格更敏感。</p><p id="b8bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python中运行Pearson相关性在很大程度上证实了我们在之前的图中看到的关联。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/93abe7cc3016179fa38a6a9b4b3b7408.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*6y6ADfINdjkE3Jzr4RNFkg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">作者截图</a></p></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="2f0d" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">预测客户流失</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/cf83e6a6c4d5d5d302b8264467f5ae2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*4rLKcZz7MQLyOv9w9WAfGQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco_Model_Scores.twb" rel="noopener ugc nofollow" target="_blank">作者制作的Tableau图表</a></p></figure><p id="d4c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在80%的训练分裂上训练了四个分类模型:决策树、逻辑回归、随机森林和XGBoost。</p><p id="e982" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于后3个模型，我使用GridSearchCV迭代相关参数，并根据来自5重交叉验证的最高平均ROC AUC重新调整最佳估计值。后三种型号的性能相似。</p><p id="9976" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我选择XGBoost ensemble模型，因为它具有最高的AUC 0.79、0.83的强召回率和0.54的更高精度。</p><p id="e644" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我对16个特性应用了标准缩放，目标设置为“二进制:逻辑”,以预测XGBoost模型中的二进制流失结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="797c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">instantiate_grid函数接受模型和网格参数，并建立标准评分标准来实例化GridSearchCV对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="d3cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过反复试验，我迭代了XGBoost的特性组合和关键参数，以优化模型的评分。对于所有的迭代，我包含了一个正的类权重2.8，以纠正发生率为26.7%的适度的类失衡。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="766a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最佳估计器的最终参数只选择了4个最大深度级别，100个估计器，以及更保守的L2正则化2。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/573367a237a0f1e7f0aa228a3d9ff53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U59WUEKrL5zRkcyR9RUMMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">作者截图</a></p></figure><p id="4c5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用模型的系数作为特征重要性的代理，我们看到我们的1年和2年合同(超过基线M-T-M)是迄今为止最强的影响。互联网光纤产品和有家属的客户具有中等重要性，其余特征影响较小。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/31b7542940115052cd1281b58804ae45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iLmBOdEcRwtEVzXCZNB40w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Feature_Importances.twb" rel="noopener ugc nofollow" target="_blank"> Tableau图</a>作者</p></figure><p id="dd12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">交叉验证和其他参数有助于模型避免过度拟合，因为测试分数与训练一致。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/3272d9d3082a3d7d2314303df500dcf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BFmHe3yiXCgMaU-L45LP-g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">截图</a>作者</p></figure><p id="0095" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们来看看测试预测的混乱矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/9ec8d0a79dd8a26c243e5278c2b296f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*9yIRyzByMZNEF1YQC3fdPQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">作者截图</a></p></figure><p id="c612" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我对83% (311/374)的测试预测召回率感到满意。我们的XGBoost模型可以正确预测6个真实客户流失案例中的5个，这非常好。</p><p id="3e89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，最佳模型的精度为54% (311/571)，这是不可接受的。我们的模型中有近1/2的流失预测是不正确的(误报)。为了放心地部署模型，我们需要更高的精度。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="0f52" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">移动决策阈值</h1><p id="0d99" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">有了这个模型，我不建议电信公司盲目地使用0.5%流失概率的决策阈值(DT)来应用默认预测。假设所有客户有超过50%的可能性会流失，我们可能会经历过多的成本、客户困惑和可能不必要的流失。我们希望将决策阈值提高到客户流失概率，使我们的准确率超过80%。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a35bfbcb11ce108d22ff7b4d38c87f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*6afR6LvXRQh-t3BD3pIHIQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">作者截图</a></p></figure><p id="8678" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过绘制作为决策阈值函数的精确度和回忆分数，我们可以看到达到我们想要的精确度所需的概率。虽然我们会将流失客户的比例限制在召回的20%以下，但我们会更有信心采取更精确的行动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/01bcb2e20292c8f2748456e0cd9fd2bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*WBA2IdH_BMxUEMLu4-vP3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/cutterback/p03-telco-churn-model/blob/75ef99ec1c143279752d24ba08dd7b40ebcd7a0d/Telco-Churn-Classification-Model.ipynb" rel="noopener ugc nofollow" target="_blank">作者截图</a></p></figure><p id="90d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用方法predict_proba对我们的最佳估计，我重新分配了各种决策阈值的预测类。我建议将模型分为三层方法，涵盖以下增量流失案例:</p><ol class=""><li id="4436" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu ow nv nw nx bi translated"><strong class="lb iu">高精度</strong>:DT = 0.9–1.0/84%精度/ 18%召回率(67个真位置，13个假位置)</li><li id="7c3c" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu ow nv nw nx bi translated"><strong class="lb iu">中等精度</strong>:DT = 0.8–0.9/71%精度/ 26%召回率(98个真位置，40个假位置)</li><li id="801b" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu ow nv nw nx bi translated"><strong class="lb iu">低精度</strong>:DT = 0.7–0.8/49%精度/ 19%召回率(70个真位置，72个假位置)</li></ol><p id="7141" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">电信公司可以根据precision groups确定其保留行动的目标，涵盖以下3种情况下所有流失案例的63%:</p><ol class=""><li id="0131" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu ow nv nw nx bi translated"><strong class="lb iu">高精度</strong> —以最积极的保留为目标，如通过折扣或增加免费服务的主动推广来保留最有可能流失的客户。</li><li id="3c4d" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu ow nv nw nx bi translated"><strong class="lb iu">中等精度</strong> —以更通用、更低成本的方法为目标，如授权客户服务代理在某些情况下拯救客户。</li><li id="321e" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu ow nv nw nx bi translated"><strong class="lb iu">低精度</strong> —将这些客户添加到观察名单，或一般的挽留沟通工作。</li></ol></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="afc7" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">扩展数据收集</h1><p id="4396" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">我们已经看到，一些基本数据可能足以预测客户流失，并足以采取行动。虽然这是一个好的开始，但我强烈建议电信公司投资这些领域的数据收集，以提高客户流失预测。</p><ul class=""><li id="eefd" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">产品—服务利用率、质量水平和SLA、设备、竞争对手覆盖范围</li><li id="8cdf" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">客户服务—联系人/电话/电子邮件、票证、门户/应用程序使用、情感分析</li><li id="8994" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">营销—相对价格点、获得的价值、待定合同续签、营销参与、终身客户价值</li><li id="7e73" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">人口统计—信用评分、收入、房屋所有权、家庭规模、角色/生命周期、居住时间</li><li id="5246" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">地理-街区/社区联系</li></ul><p id="21bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly">感谢阅读本帖，并请留下评论。</em></p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><div class="kj kk kl km gt ox"><a href="https://chuckutterback.medium.com/membership" rel="noopener follow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd iu gy z fp pc fr fs pd fu fw is bi translated">通过我的推荐链接加入媒体-查克·厄特巴克</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">加入我的推荐链接- Chuck Utterback，从我自己和所有的人那里获得高质量的文章</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">chuckutterback.medium.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl ks ox"/></div></div></a></div></div></div>    
</body>
</html>