<html>
<head>
<title>Analyzing Financial Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python分析金融数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-financial-data-in-python-ccf5c99f55e8?source=collection_archive---------10-----------------------#2021-07-19">https://towardsdatascience.com/analyzing-financial-data-in-python-ccf5c99f55e8?source=collection_archive---------10-----------------------#2021-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1b72" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索Python中的金融数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4a82baca4391bf224a3fb51f35653048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrpyB4mf16KRM7lUPdia9Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@energepic-com-27411" rel="noopener ugc nofollow" target="_blank">energepic.com</a>在<a class="ae ky" href="https://www.pexels.com/photo/blue-and-yellow-graph-on-stock-market-monitor-159888/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><p id="724d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">探索性数据分析(EDA)是每个数据科学家工作流程的重要组成部分。EDA允许数据科学家总结他们正在处理的数据的最重要的特征。在金融数据分析中，这包括生成简单的汇总统计数据，如回报率和平均回报率的标准差，通过关联热图可视化股票之间的关系，生成股票价格时间序列图、箱线图等。</p><p id="5c3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来分析一下三只股票:亚马逊(Amazon)、谷歌(Google)和苹果(Apple)。我们将看到如何对这些股票进行简单的探索性数据分析，方法是生成汇总统计数据和可视化数据、风险和回报分析，以及生成滞后指标以了解股价趋势。对于想开始学习如何用Python分析金融数据的初学者来说，这应该是一个坚实的基础。在我们开始之前，这里有一些我们将使用的工具。</p><p id="a313" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">pandas-datareader是一个Python库，允许用户轻松访问股票价格数据并执行统计分析任务，如计算回报、风险、移动平均线等。此外，matplotlib和seaborn是Python中的库，进一步允许您创建数据可视化，如箱线图和时间序列图。这些库的组合使数据科学家能够用相对较少的代码行从金融数据中获得强大的洞察力。</p><p id="193b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">股票风险分析对于理解股票价格波动的不确定性非常重要。这可以帮助投资者根据他们的风险承受能力选择他们想要投资的股票。我们可以使用移动平均线计算，通过描述股票价格运动的方向趋势，进一步为投资决策提供信息。</p><p id="43d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，布林线图是可视化价格波动的有用方法。布林线图和均线就是我们所说的滞后指标。这意味着它们基于长期变化，有助于我们理解长期趋势。这与用来预测未来价格变动的领先指标形成对比。</p><p id="e3de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">使用Pandas-Datareader访问财务数据</strong></p><p id="9aac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要在终端中使用以下命令安装pandas-datareader库:</p><p id="f1dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">pip安装熊猫-datareader</p><p id="d794" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们打开一个新的Python脚本。在脚本的顶部，让我们从pandas_datareader.data模块导入web对象。让我们也导入内置的datetime包，它将允许我们创建Python datetime对象:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d788" class="ma mb it lw b gy mc md l me mf">import pandas_datareader.data as web</span><span id="ebe4" class="ma mb it lw b gy mg md l me mf">import datetime</span></pre><p id="2119" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们提取Amazon的股票价格数据，将其存储在一个名为amzn的变量中，并显示前五行数据:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="492c" class="ma mb it lw b gy mc md l me mf">amzn = web.DataReader(‘AMZN’,’yahoo’,start,end)</span><span id="95b5" class="ma mb it lw b gy mg md l me mf">print(amzn.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/d9697b88fe8d9dfe4fc17885e874a1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P7CDdyFvlgtK_UM-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7690" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到数据框有高、低、开仓、收盘、成交量和调整收盘等列。这些值基于交易时段(通常是上午9:30到下午4:00)的股票价格。让我们考虑一下这些列的含义:</p><ul class=""><li id="3a2d" class="mi mj it lb b lc ld lf lg li mk lm ml lq mm lu mn mo mp mq bi translated">高价:股票在交易过程中的最高价格</li><li id="2fae" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">低价:股票在交易过程中的最低价格</li><li id="ef0f" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">收盘价:股票在交易时段结束时的价格</li><li id="a243" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">开盘价:股票在交易时段开始时的价格</li><li id="8ee1" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">调整后收盘价:对股票分割和股息进行调整后的收盘价</li></ul><p id="dc7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们应该使用pandas to_csv方法将这些数据保存到一个. csv文件中:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="02e0" class="ma mb it lw b gy mc md l me mf">amzn.to_csv(f’amzn_{start}_{end}.csv’, index=False)</span></pre><p id="3e31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经有了AMZN的数据，让我们提取GOOGL和AAPL的数据。我们将从谷歌开始，然后转移到AAPL。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="65c7" class="ma mb it lw b gy mc md l me mf">googl = web.DataReader(‘GOOGL’,’yahoo’,start,end)</span><span id="f34d" class="ma mb it lw b gy mg md l me mf">print(googl.head())</span><span id="6fd3" class="ma mb it lw b gy mg md l me mf">googl.to_csv(f”googl_{start}_{end}.csv”, index=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/41a491ede37db241798a5f08645d7940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*koR1U2B4arquvj3s"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a5c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们来拉一下AAPL:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="997d" class="ma mb it lw b gy mc md l me mf">aapl = web.DataReader(‘AAPL’,’yahoo’,start,end)</span><span id="a89e" class="ma mb it lw b gy mg md l me mf">print(aapl.head())</span><span id="2b7d" class="ma mb it lw b gy mg md l me mf">aapl.to_csv(f”aapl_{start}_{end}.csv”, index=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/433e504bab61677b4076739518bd6262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i8qYBKC01RRjVvkF"/></div></div></figure><p id="37d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在应该有三个文件，包含AMZN、GOOGL和AAPL两年的股票价格数据。让我们把这些文件读入新的熊猫数据帧:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d6b2" class="ma mb it lw b gy mc md l me mf">import pandas as pd</span><span id="17ea" class="ma mb it lw b gy mg md l me mf">amzn_df = pd.read_csv(f’amzn_{start}_{end}.csv’)</span><span id="1ab0" class="ma mb it lw b gy mg md l me mf">googl_df = pd.read_csv(f’googl_{start}_{end}.csv’)</span><span id="4ff4" class="ma mb it lw b gy mg md l me mf">aapl_df = pd.read_csv(f’aapl_{start}_{end}.csv’)</span></pre><p id="7a8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">探索和可视化财务数据</strong></p><p id="bef6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们可以生成一些简单的统计数据。理解股票价格变动的一个重要指标是回报率。回报的定义是开盘价减去收盘价除以开盘价(R =[开盘价-收盘价]/开盘价)。让我们计算每个股票的收益。让我们从计算AMZN的日回报率开始:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f7da" class="ma mb it lw b gy mc md l me mf">amzn_df[‘Returns’] = (amzn_df[‘Close’] — amzn_df[‘Open’])/amzn_df[‘Open’]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/039341d3d73ae9ff16b830751cf88150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j3tnX2kl6Mb_mM2Z"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="107c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以创建一个简单的可视化图形，即AMZN股票价格的每日回报直方图。我们可以使用seaborn进行样式设计，使用matplotlib生成直方图:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="574a" class="ma mb it lw b gy mc md l me mf">import matplotlib.pyplot as plt</span><span id="e44f" class="ma mb it lw b gy mg md l me mf">import seaborn as sns</span><span id="a71e" class="ma mb it lw b gy mg md l me mf">amzn_df[‘Returns’] = (amzn_df[‘Close’] — amzn_df[‘Open’])/amzn_df[‘Open’]</span><span id="e0d5" class="ma mb it lw b gy mg md l me mf">amzn_df[‘Returns’].hist()</span><span id="c52a" class="ma mb it lw b gy mg md l me mf">plt.title(‘AMZN Stock Price Returns Distribution’)</span><span id="4779" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/eb51d6053391fffc9c5dd8aed565ce7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g0ggVIf9HTUWnWrY"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7d0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以对谷歌重复这一点:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8c79" class="ma mb it lw b gy mc md l me mf">googl_df[‘Returns’] = (googl_df[‘Close’] — googl_df[‘Open’])/googl_df[‘Open’]</span><span id="4ff1" class="ma mb it lw b gy mg md l me mf">googl_df[‘Returns’].hist()</span><span id="e420" class="ma mb it lw b gy mg md l me mf">plt.title(‘GOOGL Stock Price Returns Distribution’)</span><span id="7f61" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/0394cf2e47f091be4f97a4c84f1cbb7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BOOg4BW4ySeaonDf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fbf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和AAPL:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1d2b" class="ma mb it lw b gy mc md l me mf">aapl_df[‘Returns’] = (aapl_df[‘Close’] — aapl_df[‘Open’])/aapl_df[‘Open’]</span><span id="bfe3" class="ma mb it lw b gy mg md l me mf">aapl_df[‘Returns’].hist()</span><span id="1050" class="ma mb it lw b gy mg md l me mf">plt.title(‘AAPL Stock Price Returns Distribution’)</span><span id="9eca" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/3a90934a663827e57ffea2fb28881585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VpKwRZofTo11FsR5"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cc15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以计算每只股票的平均回报率和回报率的标准差，并将它们显示在直方图的标题中。这些统计数据对投资者来说非常重要。平均回报率让我们了解股票投资的盈利能力。标准差是衡量回报波动程度的指标。在金融界，我们称之为风险。通常情况下，高风险伴随着高回报。让我们展示一个AMZN的例子。首先，我们将平均值和标准偏差存储在变量中，并使用f字符串来格式化标题:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8d3d" class="ma mb it lw b gy mc md l me mf">mean_amnz_returns = np.round(amzn_df[‘Returns’].mean(), 5)</span><span id="54bc" class="ma mb it lw b gy mg md l me mf">std_amnz_returns = np.round(amzn_df[‘Returns’].std(), 2)</span><span id="bbfe" class="ma mb it lw b gy mg md l me mf">plt.title(f’AMZN Stock Price Returns Distribution; Mean {mean_amnz_returns}, STD: {std_amnz_returns}’)</span><span id="5ef0" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/0b7a2fb5c9228f035a1b6dfb66a63edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7JW0OJkPdVoMZv_-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="16a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个有用的数据可视化是箱线图。类似于直方图，这是另一种可视化数据的均值、离散度和偏斜度的方法。在我们的财务数据的背景下，它可以帮助我们比较每只股票的平均回报、回报的离差和回报的偏度，这有助于为投资决策提供信息。首先，让我们将每只股票的回报合并到一个数据框架中:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="577b" class="ma mb it lw b gy mc md l me mf">amzn_df[‘Ticker’] = ‘AMZN’</span><span id="688c" class="ma mb it lw b gy mg md l me mf">googl_df[‘Ticker’] = ‘GOOGL’</span><span id="fb80" class="ma mb it lw b gy mg md l me mf">aapl_df[‘Ticker’] = ‘AAPL’</span><span id="7b34" class="ma mb it lw b gy mg md l me mf">df = pd.concat([amzn_df, googl_df, aapl_df])</span><span id="b7d1" class="ma mb it lw b gy mg md l me mf">df = df[[‘Ticker’, ‘Returns’]]</span><span id="8536" class="ma mb it lw b gy mg md l me mf">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/e646ca27cb43d6c98a57d0ee96d0a65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/0*sWvgyUykN6fuxQsL"/></div></figure><p id="8c04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了生成箱线图，我们使用以下代码:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8787" class="ma mb it lw b gy mc md l me mf">sns.boxplot(x= df[‘Ticker’], y = df[‘Returns’])</span><span id="2116" class="ma mb it lw b gy mg md l me mf">plt.title(‘Box Plot for AMZN, GOOGL and AAPL Returns’)</span><span id="a4c5" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/b745f934bd87dd52409f4ee720b162de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dmFoQq9k8bZuSsjq"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7a69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将讨论的最后一个可视化是退货的关联热图。这种可视化有助于我们理解股票价格回报之间是否存在线性关系。这很重要，因为它可以提供投资者投资组合中股票之间关系的见解，因此也有助于了解投资者如何构建投资组合。为了创建我们的热图，让我们首先创建一个新的数据框，其中包含每个ticker的一列:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d82d" class="ma mb it lw b gy mc md l me mf">df_corr = pd.DataFrame({‘AMZN’:amzn_df[‘Returns’], ‘GOOGL’:googl_df[‘Returns’], ‘AAPL’:aapl_df[‘Returns’]})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/8784d1e25acdb65b2a9c9c7a9dae836b.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/0*QuRno4v4VzaysEp0"/></div></figure><p id="8829" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来让我们计算每只股票收益之间的相关性:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/09e9ebe85c491aad04cae6763050f86a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*azBx6j7qkx73rAyN"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1274" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这张热图显示，每只股票都有正的线性关系。这意味着，当AMZN的日收益增加时，AAPL和谷歌也可能增加。反之亦然。如果AMZN收益减少，其他也可能减少。一个好的投资组合包含多样化的资产。在这种情况下，这意味着我们应该选择彼此相关性不强的股票，如AAPL、AMZN和GOOGL。这是因为如果一只股票的回报下降，你的整个投资组合的回报也会减少。在股票互不相关的多元化投资组合中，一只股票的价格不一定会随着其他股票的价格一起上涨或下跌。</p><p id="52b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">滞后指标</strong></p><p id="c14b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们接下来要做的计算是两种不同的滞后指标，移动平均线和布林线图。移动平均线是分析师用来消除股价短期波动以了解价格方向趋势的常用技术。在这里，我们将绘制AMZN、GOOGL和AAPL的移动平均线。先说AMZN。我们将绘制AMZN调整后收盘价的10天移动平均线，并考虑2021年1月23日之后的股价:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d02f" class="ma mb it lw b gy mc md l me mf">cutoff = datetime.datetime(2021,1,23)</span><span id="1f55" class="ma mb it lw b gy mg md l me mf">amzn_df[‘Date’] = pd.to_datetime(amzn_df[‘Date’], format=’%Y/%m/%d’)</span><span id="7427" class="ma mb it lw b gy mg md l me mf">amzn_df = amzn_df[amzn_df[‘Date’] &gt; cutoff]</span><span id="adad" class="ma mb it lw b gy mg md l me mf">amzn_df[‘SMA_10’] = amzn_df[‘Close’].rolling(window=10).mean()</span><span id="8ff1" class="ma mb it lw b gy mg md l me mf">print(amzn_df.head())</span><span id="8b0e" class="ma mb it lw b gy mg md l me mf">plt.plot(amzn_df[‘Date’], amzn_df[‘SMA_10’])</span><span id="5bc1" class="ma mb it lw b gy mg md l me mf">plt.plot(amzn_df[‘Date’], amzn_df[‘Adj Close’])</span><span id="4b92" class="ma mb it lw b gy mg md l me mf">plt.title(“Moving average and Adj Close price for AMZN”)</span><span id="e49d" class="ma mb it lw b gy mg md l me mf">plt.ylabel(‘Adj Close Price’)</span><span id="b03a" class="ma mb it lw b gy mg md l me mf">plt.xlabel(‘Date’)</span><span id="456c" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/ab2d94fa1c30aad34ca3990ad6fa0a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ndz84YohOKAl4WPE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="78c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上图中，蓝线是移动平均线，橙色是调整后的收盘价。我们可以为GOOGL做同样的事情:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ed1d" class="ma mb it lw b gy mc md l me mf">googl_df[‘Date’] = pd.to_datetime(googl_df[‘Date’], format=’%Y/%m/%d’)</span><span id="c2ec" class="ma mb it lw b gy mg md l me mf">googl_df = googl_df[googl_df[‘Date’] &gt; cutoff]</span><span id="a863" class="ma mb it lw b gy mg md l me mf">googl_df[‘SMA_10’] = googl_df[‘Close’].rolling(window=10).mean()</span><span id="89df" class="ma mb it lw b gy mg md l me mf">print(googl_df.head())</span><span id="7fba" class="ma mb it lw b gy mg md l me mf">plt.plot(googl_df[‘Date’], googl_df[‘SMA_10’])</span><span id="f0fc" class="ma mb it lw b gy mg md l me mf">plt.plot(googl_df[‘Date’], googl_df[‘Adj Close’])</span><span id="2afb" class="ma mb it lw b gy mg md l me mf">plt.title(“Moving average and Adj Close price for GOOGL”)</span><span id="d785" class="ma mb it lw b gy mg md l me mf">plt.ylabel(‘Adj Close Price’)</span><span id="0c8c" class="ma mb it lw b gy mg md l me mf">plt.xlabel(‘Date’)</span><span id="d354" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/e94625b4923f292a1caf4e85c796065b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wm4h8QtgvHfIAKLS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9334" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后是AAPL:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6165" class="ma mb it lw b gy mc md l me mf">aapl_df[‘Date’] = pd.to_datetime(aapl_df[‘Date’], format=’%Y/%m/%d’)</span><span id="b979" class="ma mb it lw b gy mg md l me mf">aapl_df = aapl_df[aapl_df[‘Date’] &gt; cutoff]</span><span id="16b5" class="ma mb it lw b gy mg md l me mf">aapl_df[‘SMA_10’] = aapl_df[‘Close’].rolling(window=10).mean()</span><span id="9e82" class="ma mb it lw b gy mg md l me mf">print(googl_df.head())</span><span id="2564" class="ma mb it lw b gy mg md l me mf">plt.plot(aapl_df[‘Date’], aapl_df[‘SMA_10’])</span><span id="f13c" class="ma mb it lw b gy mg md l me mf">plt.plot(aapl_df[‘Date’], aapl_df[‘Adj Close’])</span><span id="17e0" class="ma mb it lw b gy mg md l me mf">plt.title(“Moving average and Adj Close price for AAPL”)</span><span id="89b1" class="ma mb it lw b gy mg md l me mf">plt.ylabel(‘Adj Close Price’)</span><span id="ccc6" class="ma mb it lw b gy mg md l me mf">plt.xlabel(‘Date’)</span><span id="01df" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/50e43c35ff4d5f7a015b7e2a04ca9b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O_ZEq99vd-s-_-Y7"/></div></div></figure><p id="2ebf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我要讨论的最后一种图是布林线图，这是一种可视化移动平均线离差的方法。波段由上限和下限定义，上限和下限与简单移动平均线相差两个标准差。这对交易者很有用，因为这让他们可以利用价格波动的优势。让我们为AMZN生成一个布林线图:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fd47" class="ma mb it lw b gy mc md l me mf">amzn_df[‘SMA_10_STD’] = amzn_df[‘Adj Close’].rolling(window=20).std()</span><span id="4046" class="ma mb it lw b gy mg md l me mf">amzn_df[‘Upper Band’] = amzn_df[‘SMA_10’] + (amzn_df[‘SMA_10_STD’] * 2)</span><span id="80f1" class="ma mb it lw b gy mg md l me mf">amzn_df[‘Lower Band’] = amzn_df[‘SMA_10’] — (amzn_df[‘SMA_10_STD’] * 2)</span><span id="e08f" class="ma mb it lw b gy mg md l me mf">amzn_df.index = amzn_df[‘Date’]</span><span id="fd19" class="ma mb it lw b gy mg md l me mf">amzn_df[[‘Adj Close’, ‘SMA_10’, ‘Upper Band’, ‘Lower Band’]].plot(figsize=(12,6))</span><span id="2236" class="ma mb it lw b gy mg md l me mf">plt.title(’10 Day Bollinger Band for Amazon’)</span><span id="a2e9" class="ma mb it lw b gy mg md l me mf">plt.ylabel(‘Adjusted Close Price’)</span><span id="7c17" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/a417031b1c69a0d431b35ed166aa67e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6sw8l3ms0BaJH7bg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e936" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于谷歌来说:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4df9" class="ma mb it lw b gy mc md l me mf">googl_df[‘SMA_10_STD’] = googl_df[‘Adj Close’].rolling(window=10).std()</span><span id="05f8" class="ma mb it lw b gy mg md l me mf">googl_df[‘Upper Band’] = googl_df[‘SMA_10’] + (googl_df[‘SMA_10_STD’] * 2)</span><span id="7b8a" class="ma mb it lw b gy mg md l me mf">googl_df[‘Lower Band’] = googl_df[‘SMA_10’] — (googl_df[‘SMA_10_STD’] * 2)</span><span id="3715" class="ma mb it lw b gy mg md l me mf">googl_df.index = googl_df[‘Date’]</span><span id="1e75" class="ma mb it lw b gy mg md l me mf">googl_df[[‘Adj Close’, ‘SMA_10’, ‘Upper Band’, ‘Lower Band’]].plot(figsize=(12,6))</span><span id="8945" class="ma mb it lw b gy mg md l me mf">plt.title(’10 Day Bollinger Band for Google’)</span><span id="2b2b" class="ma mb it lw b gy mg md l me mf">plt.ylabel(‘Adjusted Close Price’)</span><span id="8b53" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/aceafc842d929da691e6a6e9c43fb1d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OZXaHdjQ0e9bDD13"/></div></div></figure><p id="f08b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后对AAPL来说:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1c76" class="ma mb it lw b gy mc md l me mf">aapl_df[‘SMA_10_STD’] = aapl_df[‘Adj Close’].rolling(window=10).std()</span><span id="ea56" class="ma mb it lw b gy mg md l me mf">aapl_df[‘Upper Band’] = aapl_df[‘SMA_10’] + (aapl_df[‘SMA_10_STD’] * 2)</span><span id="d12e" class="ma mb it lw b gy mg md l me mf">aapl_df[‘Lower Band’] = aapl_df[‘SMA_10’] — (aapl_df[‘SMA_10_STD’] * 2)</span><span id="d0b2" class="ma mb it lw b gy mg md l me mf">aapl_df.index = aapl_df[‘Date’]</span><span id="f9a7" class="ma mb it lw b gy mg md l me mf">aapl_df[[‘Adj Close’, ‘SMA_10’, ‘Upper Band’, ‘Lower Band’]].plot(figsize=(12,6))</span><span id="44bc" class="ma mb it lw b gy mg md l me mf">plt.title(’10 Day Bollinger Band for Apple’)</span><span id="6580" class="ma mb it lw b gy mg md l me mf">plt.ylabel(‘Adjusted Close Price’)</span><span id="0f69" class="ma mb it lw b gy mg md l me mf">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/036ed0328272f91594eb74fadd10c163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mSV5s1asuUgZwb5v"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0349" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣访问这篇博客中使用的代码，可以在<a class="ae ky" href="https://github.com/spierre91/builtiin/blob/main/financial_data_analysis.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><p id="c277" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有各种各样的有用工具可以从财务数据中提取、分析和生成见解。这些工具的组合使得初学者可以很容易地开始使用Python处理金融数据。这些技能可以用于个人投资、算法交易、投资组合构建等等。对于任何对金融感兴趣的分析师或数据科学家来说，能够快速生成统计见解、可视化关系并精确定位金融数据的趋势是非常宝贵的。</p><p id="7d28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣学习python编程的基础知识、Pandas的数据操作以及python中的机器学习，请查看<a class="ae ky" href="https://www.amazon.com/dp/B08N38XW2Q/ref=sr_1_1?dchild=1&amp;keywords=sadrach+python&amp;qid=1604966500&amp;s=books&amp;sr=1-1" rel="noopener ugc nofollow" target="_blank"><em class="nm">Python for Data Science and Machine Learning:Python编程、Pandas和sci kit-初学者学习教程</em> </a> <em class="nm">。我希望你觉得这篇文章有用/有趣。</em></p><p id="06e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="nm">本帖原载于</em> </strong> <a class="ae ky" href="https://builtin.com/data-science/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nm">内置博客</em> </strong> </a> <strong class="lb iu"> <em class="nm">。原片可以在这里找到</em></strong><a class="ae ky" href="https://builtin.com/data-science/financial-data-analysis" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="nm"/></strong></a><strong class="lb iu"><em class="nm">。</em>T29】</strong></p></div></div>    
</body>
</html>