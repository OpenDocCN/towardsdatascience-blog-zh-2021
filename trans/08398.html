<html>
<head>
<title>Ensemble Classification: A Brief Overview With Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">集成分类:简要概述及实例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ensemble-classification-a-brief-overview-with-examples-3dac25613073?source=collection_archive---------23-----------------------#2021-08-02">https://towardsdatascience.com/ensemble-classification-a-brief-overview-with-examples-3dac25613073?source=collection_archive---------23-----------------------#2021-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ab21" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用集合分类法将兴趣点分类为机场、火车站和公交车站</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/20aaeea726c29ceef13482524fe68bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gHXkTCs8TZ7xwMj2lbxJJQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">查尔斯·德鲁维奥在<a class="ae kv" href="https://unsplash.com/s/photos/rocket-pop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d9a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">注</em> </strong> <em class="ls">:本文是关于交通POI数据分类系列文章的最后一篇。</em> <a class="ae kv" rel="noopener" target="_blank" href="/poi-classification-using-visit-and-popularity-metrics-part-1-ae5e94f92077"> <em class="ls">第一篇文章</em> </a> <em class="ls">试图使用各种机器学习模型将记录分类为机场、公交车站和火车站。</em> <a class="ae kv" rel="noopener" target="_blank" href="/pca-lda-and-svd-model-tuning-through-feature-reduction-for-transportation-poi-classification-8d20501ee255"> <em class="ls">第二篇文章</em> </a> <em class="ls">的中心思想是使用特征约简算法来调整第一篇文章中的模型，以提供更高的精度。</em> <a class="ae kv" rel="noopener" target="_blank" href="/spark-multilayer-perceptron-classifier-for-poi-classification-99e5c68b4a77"> <em class="ls">第三篇</em> </a> <em class="ls">看起来使用了Spark多层感知器分类器来正确地分类这些记录。查看这些文章，了解该项目在寻找POI数据分类的最佳方法方面是如何发展的。</em></p><p id="f3d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文将使用集成分类，使用步行交通模式对来自<a class="ae kv" href="http://safegraph.com/" rel="noopener ugc nofollow" target="_blank">安全图</a>的POI记录进行正确分类。SafeGraph是一家数据提供商，为数百家企业和类别提供POI数据。它免费向学术界提供数据。对于这个项目，我选择使用SafeGraph模式数据将记录分类为不同的兴趣点。模式数据的模式可以在这里找到:<a class="ae kv" href="https://docs.safegraph.com/v4.0/docs/places-schema#section-patterns" rel="noopener ugc nofollow" target="_blank">模式信息</a></p><h1 id="0e22" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">什么是集合分类:</h1><p id="7eab" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">集成学习是多个“弱学习者”一起使用来创建一个机器学习模型的概念，该模型能够比他们每个人单独使用时表现得更好。大多数时候，这些弱学习者自己表现不好，因为他们要么有高偏差，要么有高方差。在集成模型中组合多个弱学习器的要点是减少这种偏差和方差。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/f5b5cd6c13bb04d26c78c921b263851f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WnN-YmKgFnkAG2c9VhKMJg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/s/photos/candy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@hocuspocusphotography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Aron L </a>拍摄</p></figure><h1 id="ee9c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">兴趣点数据的集成分类</h1><p id="3a3a" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在我们开始总体分类之前，我们必须首先加载数据。这个特殊的步骤在本系列的第一篇文章和第二篇文章中都有涉及。满足本文需求的数据加载和预处理的基本步骤是:</p><p id="cc51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们进入集合分类概念的第一步之前，我们必须首先加载我们将用于这个项目的数据:加载数据的过程可以在<a class="ae kv" href="https://colab.research.google.com/drive/1A6ZZ0WZX3v4N5sN4pU5Yz_gxx2gThVqd?usp=sharing" rel="noopener ugc nofollow" target="_blank">笔记本</a>中找到，并且已经在系列的第一部分<a class="ae kv" rel="noopener" target="_blank" href="/poi-classification-using-visit-and-popularity-metrics-part-1-ae5e94f92077">中详细解释。采取的步骤是:</a></p><ol class=""><li id="46f3" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">删除不必要的列- ['parent_safegraph_place_id '，' placekey '，' safegraph_place_id '，' parent_placekey '，' parent_placekey '，' safegraph_brand_ids '，' brands '，' poi_cbg']</li><li id="62cb" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">创建地面实况列，将每个记录建立为机场、汽车站、机场或未知</li><li id="ab2c" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">删除未知记录以清除无法识别的记录</li><li id="8bb8" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">使用pyspark水平分解JSON字符串的列</li><li id="9b5c" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">阵列的水平分解列</li><li id="142c" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">使用Sklearn LabelEncoder包转换类列</li></ol><p id="05c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为这些转换的结果，输出的数据如下所示，并具有以下各列:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/0f738c67d7e48160ad022ff8be2538a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9o1ZbnD1GxP5idDp.png"/></div></div></figure><p id="a714" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Raw_visit_counts: </strong>在日期范围内，我们的小组中对此兴趣点的访问次数。</p><p id="67a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Raw_visitor_counts: </strong>在日期范围内，来自我们面板的访问该兴趣点的独立访问者的数量。</p><p id="bf7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Distance_from_home: </strong>访客(我们已确定其住所的访客)离家的中值距离，以米为单位。</p><p id="1894" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">中值_停留时间:</strong>中值最小停留时间，以分钟为单位。</p><p id="ad74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">分时段停留(分解为&lt; 5，5–10，11–20，21–60，61–120，121–240):</strong>键是分钟的范围，值是在该持续时间内的访问次数</p><p id="0975" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Popularity_by_day(分解为周一至周日):</strong>一周中的某一天到日期范围内每天(当地时间)的访问次数的映射</p><p id="afbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Popularity_by_hour(分解为Popularity _ 1-Popularity _ 24):</strong>一天中的某个小时到当地时间日期范围内每小时的访问次数的映射。数组中的第一个元素对应于从午夜到凌晨1点的时间</p><p id="468d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Device_type(分解为ios和Android): </strong>使用Android和IOS的POI的访客数量。仅显示至少包含2个设备的设备类型，包含少于5个设备的任何类别都报告为</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="d5b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然数据已经准备好了，我们可以开始集成学习方面了。</p><p id="0d99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于本文的这一部分，我们将使用Sklearn投票分类器。这是Sklearn包中集成学习的内置模型。然而，在使用这种方法之前，我们需要首先训练我们在这个模型中使用的三个弱学习者。我们使用的模型与本系列文章第一部分中的模型相同，包括高斯朴素贝叶斯模型、决策树模型和K-最近邻模型。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="b8ff" class="ns lu iq no b gy nt nu l nv nw">#Training all three models</span><span id="404d" class="ns lu iq no b gy nx nu l nv nw">from sklearn.neighbors import KNeighborsClassifier</span><span id="6156" class="ns lu iq no b gy nx nu l nv nw">from sklearn.naive_bayes import GaussianNB</span><span id="5610" class="ns lu iq no b gy nx nu l nv nw">from sklearn.tree import DecisionTreeClassifier</span><span id="9ffc" class="ns lu iq no b gy nx nu l nv nw">dtree_model = DecisionTreeClassifier(max_depth = 3).fit(X_train, y_train)</span><span id="8e91" class="ns lu iq no b gy nx nu l nv nw">gnb = GaussianNB().fit(X_train, y_train)</span><span id="c15b" class="ns lu iq no b gy nx nu l nv nw">knn = KNeighborsClassifier(n_neighbors = 22).fit(X_train, y_train)</span></pre><p id="8b49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然已经训练了所有三个模型，我们可以使用这些模型来执行该过程的下一个步骤，即调用模型并将创建的模型聚合到字典中以供集合模型使用</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="785c" class="ns lu iq no b gy nt nu l nv nw">from sklearn.ensemble import VotingClassifier</span><span id="dce7" class="ns lu iq no b gy nx nu l nv nw">estimators=[(‘knn’, knn), (‘gnb’, gnb), (‘dtree_model’, dtree_model)]</span><span id="8a7f" class="ns lu iq no b gy nx nu l nv nw">ensemble = VotingClassifier(estimators, voting=’hard’)</span></pre><p id="0ed2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在训练和测试模型时，我们会收到以下输出:</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="0a64" class="ns lu iq no b gy nt nu l nv nw">ensemble.fit(X_train, y_train)</span><span id="9c7d" class="ns lu iq no b gy nx nu l nv nw">ensemble.score(X_test, y_test)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/8e2600662b84e842140b5528d4039c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*QYRO4lUP80asU0nwowHLhg.png"/></div></figure><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="049c" class="ns lu iq no b gy nt nu l nv nw">from sklearn.metrics import confusion_matrix</span><span id="58fe" class="ns lu iq no b gy nx nu l nv nw">prediction = ensemble.predict(X_test)</span><span id="3e0c" class="ns lu iq no b gy nx nu l nv nw">confusion_matrix(y_test, prediction)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/16ce222a9f35ffbd4a8fc64c8cbb0acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*5RFvB574U0KebSkhVKa9-g.png"/></div></figure><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="73d3" class="ns lu iq no b gy nt nu l nv nw">plot_confusion_matrix(ensemble, X_test, y_test, normalize=’true’, values_format = ‘.3f’, display_labels=[‘Airport’,’Bus’,’Train’])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/70572e7241439f230463267a56e9380e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*tbKdA1lM_2DLBmP-9gZE7A.png"/></div></figure><p id="b9a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型的精确度略低于用于创建集合分类模型的模型中最有效的模型的精确度(. 75 vs .68)。该模型的性能比高斯朴素贝叶斯模型(. 265)好得多，并且性能与K-最近邻分类器(. 679)相当。看到模型的表现优于这三个精度的平均值，可以说对这个特定数据集使用集成分类是提高预测精度的有效方法。和以前一样，模型缺陷的主要原因是数据集中的不平衡和缺少公交车站记录。正如我们在Spark Deep Learning文章中看到的那样，这个问题并没有通过手动重新平衡数据来解决，因此未来分类工作的最佳行动方针是不惜一切代价避免严重不平衡的数据，否则准确性会严重下降。</p><h1 id="cf80" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="78ac" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">通过这个项目，我们能够确定集成分类的重要性以及当使用几个弱学习者来创建模型时该技术可以具有的效率。从这个练习中，我们能够推导出一个比三个弱学习者的平均准确度更好的模型。这是POI分类系列文章的结论。通过我们在该系列的最后4部分所做的分析，我们可以看到使用机器学习对SafeGraph数据进行分类的效率，以及预测的准确性可以相当高。</p><p id="9479" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">提问？</em>T3】</strong></p><p id="c2c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我邀请你在<a class="ae kv" href="https://www.safegraph.com/academics" rel="noopener ugc nofollow" target="_blank"> SafeGraph社区</a>的<strong class="ky ir"> #safegraphdata </strong>频道问他们，这是一个面向数据爱好者的免费Slack社区。获得支持、共享您的工作或与GIS社区中的其他人联系。通过SafeGraph社区，学者们可以免费访问美国、英国和加拿大700多万家企业的数据。</p></div></div>    
</body>
</html>