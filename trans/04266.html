<html>
<head>
<title>How to Embed Your Data Visualizations in HTML Emails and Send them using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将数据可视化嵌入HTML电子邮件并使用Python发送</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-distribute-your-data-reports-via-mail-with-a-few-lines-of-code-8df395c72e55?source=collection_archive---------6-----------------------#2021-04-11">https://towardsdatascience.com/how-to-distribute-your-data-reports-via-mail-with-a-few-lines-of-code-8df395c72e55?source=collection_archive---------6-----------------------#2021-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc0b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何在HTML邮件中发送Python数据分析的指南和模板</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/35051712986f92a401ea739125632dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ozh3X_4TNtMs4pVHeL-OTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用于分发数据报告的电子邮件模板</p></figure><p id="8ae4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python提供了大量的可视化选项来准备数据，并以一种可理解的方式呈现数据。如果您希望将您的分析分发给更多的受众，您通常可以选择将绘图集成到web应用程序中。尽管如此，电子邮件仍然是一个合法的选择，以简单有效的方式发布你的结果。</p><p id="6269" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的文章解释了如何在HTML邮件中包含和发送Matplotlib图形。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="c066" class="mb mc it bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">1.创造情节</h2><p id="8e5b" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">无论您是想使用Matplotlib、Seaborn还是Plotly来可视化您的数据，对于下面的过程都无关紧要。我将使用Matplotlib构建一个简单的情节，并将其保存为图像。</p><p id="0da3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我创建了一个新项目，其中包含一个文件夹，用于存放保存的图(<code class="fe mz na nb nc b">./results</code>)和Python脚本<code class="fe mz na nb nc b">send_report.py</code>。下面的Python代码片段展示了脚本的第一部分，它创建了一个简单的情节并将其存储在<code class="fe mz na nb nc b">./results</code>文件夹中。为了能够在下面拾取存储的图像，该函数返回绘图的位置<code class="fe mz na nb nc b">path_plot</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="df6d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">执行完代码片段后，您应该会在<code class="fe mz na nb nc b">./results</code>中找到PNG文件形式的情节(如<code class="fe mz na nb nc b">2021-04-08.png</code>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/728aec26723298dae3e52d874624a600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WNA1USoG8jDVScgduju0jA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">绘制你的数据</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="eb1d" class="mb mc it bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">2.定义您的消息并发送邮件</h2><p id="25d5" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">现在，我想将可视化包含到邮件正文中并发送出去。</p><p id="e621" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了发送电子邮件，我使用我的Gmail帐户。要做到这一点，你必须首先确保Gmail帐户安全设置中的“访问安全性较低的应用程序”选项已启用。如果你不能马上找到它，网上有很多教程会解释在哪里可以找到设置。</p><p id="a1f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，您可以使用下面的代码来测试是否可以用Python发送简单的邮件。只需设置变量<code class="fe mz na nb nc b">from_mail</code>、<code class="fe mz na nb nc b">from_password</code>和<code class="fe mz na nb nc b">to_mail</code>并试用即可。这应该会从“from_mail”向收件人“to_mail”发送一封主题为“简单数据报告:时间分析”的空白电子邮件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="7a46" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我想填写电子邮件的信息，并附上创建的情节。然后我可以将图像合并到邮件消息中。为此，我设置了一个简单的HTML主体并包含了附加的PNG文件。作为图像的来源，我使用了已定义的<code class="fe mz na nb nc b">Content-ID</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4310" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该会收到这封简单的HTML电子邮件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/63e14ea8246cd93a7281cb88a3721b58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXRcX8wyFRAbY3Rv7RIu_g.png"/></div></div></figure><p id="0ef7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下面，你可以使用你的HTML技巧来设计你喜欢的电子邮件。如果你想从头开始创建自己的HTML电子邮件，你可以从妮可·梅林那里找到一个全面的指南。</p><p id="a3bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我还在<a class="ae nh" href="https://github.com/polzerdo55862/Python-Email-Template" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上将项目文件夹上传到了下面的例子中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/019a34f6a698e1409eabb87ada667cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Y3CphchWH1jo_uV4qe64w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">日期报告模板(图片由作者提供——灵感来自<a class="ae nh" href="https://webdesign.tutsplus.com/articles/build-an-html-email-template-from-scratch--webdesign-12770" rel="noopener ugc nofollow" target="_blank">妮可·梅林</a></p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="fb9e" class="mb mc it bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">摘要</h2><p id="789f" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">希望我可以向您展示一种简单的方法来结合</p><ol class=""><li id="509c" class="nj nk it la b lb lc le lf lh nl ll nm lp nn lt no np nq nr bi translated">构建数据可视化</li><li id="dbc5" class="nj nk it la b lb ns le nt lh nu ll nv lp nw lt no np nq nr bi translated">在HTML电子邮件中嵌入绘图</li><li id="55f7" class="nj nk it la b lb ns le nt lh nu ll nv lp nw lt no np nq nr bi translated">将邮件分发到您的收件人列表</li></ol><p id="de5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在一个Python脚本中。这使得通过预定任务自动分发变得容易。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="c85c" class="mb mc it bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">参考</h2><p id="b83e" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">[1]支持不太安全的应用程序访问Gmail，<a class="ae nh" href="https://hotter.io/docs/email-accounts/secure-app-gmail/" rel="noopener ugc nofollow" target="_blank">https://hotter.io/docs/email-accounts/secure-app-gmail/</a></p><p id="7182" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[2] Nicole Merlin，从头开始构建HTML电子邮件模板，<a class="ae nh" href="https://webdesign.tutsplus.com/articles/build-an-html-email-template-from-scratch--webdesign-12770" rel="noopener ugc nofollow" target="_blank">https://web design . tuts plus . com/articles/Build-an-HTML-Email-Template-From-Scratch-web design-12770</a></p></div></div>    
</body>
</html>