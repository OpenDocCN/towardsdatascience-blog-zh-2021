<html>
<head>
<title>How to Reduce A\B Testing Duration using Surrogate Metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用代理度量来减少测试持续时间</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-reduce-a-b-testing-duration-using-surrogate-metrics-3631c6295039?source=collection_archive---------13-----------------------#2021-07-20">https://towardsdatascience.com/how-to-reduce-a-b-testing-duration-using-surrogate-metrics-3631c6295039?source=collection_archive---------13-----------------------#2021-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="31fa" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">LinkedIn开发的一种近似长期指标的方法</h2></div><p id="de63" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当运行A/B测试时，我们经常试图改进长期指标。然而，要正确测量长期指标的影响，需要长时间的实验。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/832aeb3a6d07d0e8820a9b17223a569b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bluzDTglz5wI2FdUiIK1tA.png"/></div></div></figure><p id="5266" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这个问题，LinkedIn的研究人员发表了一篇<a class="ae ln" href="https://arxiv.org/pdf/2106.01421v1.pdf" rel="noopener ugc nofollow" target="_blank"> 2019论文</a>，概述了一种使用短期协变量的预测来取代长期指标的方法。</p><p id="079e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">预测方法留给用户，但是本文概述了确保统计有效性的要求。相对于本系列中涉及的其他方法，替代指标是相当劳动密集型的，因为您必须开发一个健壮的预测模型。也就是说，努力工作是有回报的——代理度量是使用长期度量运行A/B测试的最健壮的选项之一。</p><p id="1fc7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它是这样工作的…</p><h2 id="1bc2" class="lo lp iq bd lq lr ls dn lt lu lv dp lw ko lx ly lz ks ma mb mc kw md me mf mg bi translated">技术TLDR</h2><ol class=""><li id="9c54" class="mh mi iq kh b ki mj kl mk ko ml ks mm kw mn la mo mp mq mr bi translated"><strong class="kh ir">定义你的北极星度量标准。</strong>北极星指标定义了实验的成功/失败。</li><li id="4fd1" class="mh mi iq kh b ki ms kl mt ko mu ks mv kw mw la mo mp mq mr bi translated"><strong class="kh ir">通过预测我们的北极星来开发一个替代指标。</strong>我们预测的北极星的特征必须在我们的实验时间范围内可以观察到。</li><li id="f7af" class="mh mi iq kh b ki ms kl mt ko mu ks mv kw mw la mo mp mq mr bi translated">在我们的实验中使用我们的替代指标。请注意，在计算统计显著性时，我们必须调整方差，以说明模型中的预测误差。</li></ol><h1 id="2624" class="mx lp iq bd lq my mz na lt nb nc nd lw jw ne jx lz jz nf ka mc kc ng kd mf nh bi translated">但是，到底是怎么回事呢？</h1><p id="d113" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">让我们稍微慢下来，试着理解代理指标实际上是如何工作的。</p><h2 id="25bf" class="lo lp iq bd lq lr ls dn lt lu lv dp lw ko lx ly lz ks ma mb mc kw md me mf mg bi translated">我们什么时候应该使用替代指标？</h2><p id="8405" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">当我们的北极星度量是需要很长时间来测量的东西时，替代度量是非常有用的。例如，让我们看看终身价值(LTV)，这是我们期望从用户一生中获得的总收入。</p><p id="fb0c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，一些企业的用户生命周期非常短，但在大多数情况下，用户的生命周期是一个非常长的实验持续时间。因此，我们转向替代指标。</p><h2 id="e3fa" class="lo lp iq bd lq lr ls dn lt lu lv dp lw ko lx ly lz ks ma mb mc kw md me mf mg bi translated">如何计算替代指标？</h2><p id="86e8" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">如上所述，替代度量是使用在我们的实验中观察到的预测器对北极星度量的预测。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nl"><img src="../Images/032b5eb9f70e27c94bc6abf45f073b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdypP8Tm02_CZpinPMlmXA.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">图1:预测的替代指标和LTV总和之间时间需求差异的图示。图片作者。</p></figure><p id="d0db" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如图1所示，通过简单地使用左边的特征(蓝色)，我们可以预测LTV的近似值。预测方法取决于创建者，但是与大多数基本预测不同，小的预测间隔非常有用。</p><p id="bb75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嗯，在进行实验时，我们希望使用我们的度量方差来确定“可接受”的值范围。如果我们观察到的治疗超出了这个范围，我们拒绝零假设，并得出结论，我们的治疗有统计学意义的影响。</p><p id="a88e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的预测误差越大，我们的“可接受”范围就越大，从而导致低功效测试。简而言之，预测区间中的较小变化增加了我们检测统计显著变化的能力。</p><p id="d21c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">因此，在实现替代指标时，尽量使用预测方差置信区间低的特性集和算法。</strong></p><h1 id="0f72" class="mx lp iq bd lq my mz na lt nb nc nd lw jw ne jx lz jz nf ka mc kc ng kd mf nh bi translated">您应该如何创建代理指标？</h1><p id="ac20" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">简而言之，有代理指标，但是要讨论模型的需求以及一些最佳实践。</p><p id="90b0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了有一个静态“正确”的替代度量，该度量必须是确定北极星度量所需的唯一信息。换句话说，在我们的模型中不能有可以提高拟合度的缺失信息。</p><p id="3296" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一要求被称为普伦蒂斯标准，其数学定义如下:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/6301696ebfbfcb8489b14bb789334972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SjRlDLv2RMoLuP48Ow6Wdw.png"/></div><p class="nm nn gj gh gi no np bd b be z dk translated">图2: Prentice标准公式。图片作者。</p></figure><p id="1934" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里，<em class="nr"> Y </em>是我们的预测值，<em class="nr"> y </em>是真实值。左边的概率代表我们对y 的预测值是正确的可能性，取决于我们的替代指标S<em class="nr">S</em>和处理W 。右边的概率代表同样的情况，但排除了我们对治疗的条件。</p><p id="31b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果这个等式成立，<em class="nr"> y </em>与用户是在治疗还是在控制无关。如果是这种情况，代理度量是预测<em class="nr"> y </em>唯一需要的东西。</p><p id="e52e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在实践中，几乎不可能达到这个标准，然而，我们越接近平等，统计结果就越有效。</p><h2 id="71e1" class="lo lp iq bd lq lr ls dn lt lu lv dp lw ko lx ly lz ks ma mb mc kw md me mf mg bi translated">挑选指标的3个技巧</h2><p id="bbac" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">除了Prentice标准之外，还有其他三个关键概念可以产生有效的替代指标:</p><p id="76f5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，很好地预测代理指标很重要。LinkedIn的研究人员引用0.69的R值为有效，但好的预测的定义取决于你的用例。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ns"><img src="../Images/a0c084d834ec3b9fa35b24d54ee52790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o7VGRIrJSexMK7nIz_o7BA.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">图3:有效预测的图示。图片作者。</p></figure><p id="e7bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二，如上所述，精确的替代指标比不精确的更有效。因此，我们不仅关心高精度，还关心我们的估计有多精确。精确度可以通过我们预测区间的宽度来证明——越小越好。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nt"><img src="../Images/4a1181dd65093257545a3c6b6d5a3994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pgpo1xGkNE0CbnUQsL7nxQ.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">图4:宽预测区间与窄预测区间的对比图。图片作者。</p></figure><p id="e20d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三，我们的估计最好是可以解释的。实验是用来为商业决策提供信息的，所以如果我们不能理解某些东西为什么会起作用，就很难做出那个决定，也很难形成相关的想法。</p><p id="be78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你能够大致满足Prentice标准，并遵循以上三个提示，你应该能够开发一个有效的替代指标。</p><h2 id="a7d8" class="lo lp iq bd lq lr ls dn lt lu lv dp lw ko lx ly lz ks ma mb mc kw md me mf mg bi translated">改善结果的调整</h2><p id="f55e" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">现在我们知道了代理度量模型的需求，让我们理解如何使用这个度量。LinkedIn的研究人员建议进行两项调整。</p><p id="4099" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">第一次调整增加了我们统计显著性计算中使用的方差，以说明预测误差引起的方差:</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/bddc78547a1dcfeea8da2390f25506de.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*NQ-Ai0nCr5T7l2M1D942lg.png"/></div><p class="nm nn gj gh gi no np bd b be z dk translated">图5:使用替代度量标准的北极星调整方差公式。图片作者。</p></figure><p id="543f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在计算统计显著性时，这种调整后的方差会发挥作用。下面，我们使用t统计公式中的校正方差:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/01043631ef64cb3b8deac6f51f7e58c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*X84y1iSqvpI1ngrTEzS1Jg.png"/></div><p class="nm nn gj gh gi no np bd b be z dk translated">图6:使用代理度量的北极星度量的t统计公式。图片作者。</p></figure><p id="bd30" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在图6中，分子是我们的替代指标的平均提升，即我们的治疗和对照中的替代指标之间的差异。分母是调整后方差的平方根。<em class="nr">Var(μs)</em>是平均值的方差，<em class="nr">σe</em>是我们预测中误差的方差。注意下划线(_)表示下标。</p><p id="8f74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，如果我们使用的是完美的替代指标预测，即没有错误，则该等式简化为t统计公式。</p><p id="0063" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个调整是可选的，但是强烈推荐。在上面的调整中，我们通过增加度量的方差极大地增加了我们的“接受”范围。<strong class="kh ir">因此，为了获得统计优势并消除这种差异，建议您采用一种差异缩减技术。</strong></p><p id="75dd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">方差减少有多种形式，但本文引用的方法被称为<a class="ae ln" rel="noopener" target="_blank" href="/how-to-double-a-b-testing-speed-with-cuped-f80460825a90"> CUPED </a>。在一条线上，CUPED使用实验前数据来解释数据中的自然变化并消除它，从而减少我们的方差。</p><h2 id="79f9" class="lo lp iq bd lq lr ls dn lt lu lv dp lw ko lx ly lz ks ma mb mc kw md me mf mg bi translated">LinkedIn案例研究</h2><p id="819c" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">LinkedIn在预测一项功能是否有助于人们找到工作时也面临着类似的问题——工作渠道可能会持续数月。他们实现了一个替代指标，利用应用程序数据来预测用户是否会获得工作。预测值和真实值的相关系数为0.69。</p><p id="3f2c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在校正方差之前，他们发现203次实验中有30次具有统计学意义。校正方差后，只有2个是stat。签名。然而，使用CUPED方差减少技术，他们能够找到10个统计值。签名。实验。</p><h1 id="df2d" class="mx lp iq bd lq my mz na lt nb nc nd lw jw ne jx lz jz nf ka mc kc ng kd mf nh bi translated">实施说明</h1><ul class=""><li id="d795" class="mh mi iq kh b ki mj kl mk ko ml ks mm kw mn la nw mp mq mr bi translated">作者没有研究实验的长度如何提高预测的准确性/精确度。你会期望更多的数据带来更好的预测，但这些改进高度依赖于手头的主题。</li><li id="2659" class="mh mi iq kh b ki ms kl mt ko mu ks mv kw mw la nw mp mq mr bi translated">CUPED对于该方法之外的方差减少是有效的，并且被Google、网飞和Air BnB引用。</li><li id="5c71" class="mh mi iq kh b ki ms kl mt ko mu ks mv kw mw la nw mp mq mr bi translated">这种方法的有效性取决于你能否预测北极星度量。如果你能开发出一个准确而精确的模型，这种方法会很有效。如果没有，那就无效了。</li><li id="9aef" class="mh mi iq kh b ki ms kl mt ko mu ks mv kw mw la nw mp mq mr bi translated">作者指出，为不同的用户群和平台开发替代指标预测通常很有帮助。因为我们预测中的方差是特别有害的，所以有时最简单的方法是将我们的数据分组，然后分别查看</li></ul></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="4ecb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nr">感谢阅读！我将再写42篇文章，将“学术”研究引入DS行业。查看我对开发替代指标的链接/想法的评论。</em></p></div></div>    
</body>
</html>