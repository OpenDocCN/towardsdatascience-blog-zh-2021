<html>
<head>
<title>How to Upload and Embed Interactive Plotly Visualizations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何上传和嵌入交互式绘图可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-upload-and-embed-interactive-plotly-visualizations-f819d4ffecfb?source=collection_archive---------15-----------------------#2021-06-26">https://towardsdatascience.com/how-to-upload-and-embed-interactive-plotly-visualizations-f819d4ffecfb?source=collection_archive---------15-----------------------#2021-06-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9046" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Plotly是一个很好的交互式数据可视化工具，但是它的Chart-Studio服务仅限于500KB的上传。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d177559788065001c0bd7fbc0ea8b634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6bm47LeJYN4L2yrXC5j4cw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="5d2f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今年我分享了很多我用Plotly制作的互动情节。有一段时间，Plotly的chart-studio服务对我来说是一个很好的解决方案，我可以上传我的绘图，以便我可以将它们嵌入到文章或演示文稿中。然而，Chart-Studio在他们的自由层上有一个相当激进的500KB大小限制。除了昂贵的商业计划之外，chart-studio没有一个透明的选项来支付更大的上传量。</p><p id="3eea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我想一定有更好的方法来分享我制作的交互式网络地图，果然有！在这篇文章中，我将向你展示如何上传一个交互式Plotly地图到Datapane，并将其嵌入到任何网站上。</p><h1 id="9067" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">图表工作室</h1><p id="8e53" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">看看下面描绘阿拉斯加积雪变化的图。我用Matplotlib和Cartopy创建了它，它们可以很好地将数据投影到底图上。然而，静态地图不允许查看者查看数据值或缩小以获取位置的上下文。此外，虽然像这样的动画地图很有趣，但我认为网络地图上的滑块可以让读者更好地了解随着时间的推移而发生的变化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d5bea2723f19e21061ff8e5920267ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qkSVHDyId4f8cauHPwj1Mg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="75ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">制作一个互动版本将意味着我不必在数据可见和观众了解我们在地球上的位置之间做出选择。当我为博客帖子等设置创建地图时，我喜欢使用交互式地图，因为我不会在那里解释背景信息。我倾向于用静态地图来展示，因为我可以向观众提供任何需要的背景。</p><p id="8a1d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以很容易地使用Plotly重新创建这个交互的情节。但是，有很多数据点，远远超过了500KB的Chart-Studio限制。但是我们马上会处理这个问题。首先，下面是我用Plotly翻拍剧情的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mr ms l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/4ae49cf27f8bd1f2fa5d39ad7d4c508b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWFpjbF5wnfmjyh8Q10-Bg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Plotly剧情截图(作者创作)</p></figure><p id="af17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是这段代码创建的一个屏幕截图。看起来很好！然而，当我使用chart-studio上传它时，我得到了以下错误:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="ecef" class="mz lv it mv b gy na nb l nc nd">import chart_studio.plotly as py</span><span id="837e" class="mz lv it mv b gy ne nb l nc nd">py.plot(fig, filename = 'swe_map_test', auto_open=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/fcc0391a655947f718c5d072d0253cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bF1kprnEg_n8QOLjpsZjwA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Plotly图表工作室大小限制(由作者创建)</p></figure><p id="d25a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你有一个只有很少数据点的图，你也许可以摆脱500KB的限制。为了让我写的几篇文章的图表符合我的要求，我会随机挑选一些数据。然而，我最近发现了另一个工具Datapane，它的空闲层有一个更高的大小限制。</p><h1 id="51cb" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">数据面板</h1><p id="3110" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">Datapane是一种用于创建由数据帧、绘图和文件组成的报告的服务。您可以在Python中创建它们并将它们发布到Datapane。他们还提供了一个免费层，比Chart-Studio有更高的上传大小限制。太棒了。</p><p id="a714" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用Datapane创建报告非常有用，但是在这篇文章中，我们将重点介绍如何使用Datapane来嵌入用Plotly和Altair制作的交互式绘图。创建一个报告只需要几行代码。</p><p id="8f87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，使用pip安装Datapane:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="2c0f" class="mz lv it mv b gy na nb l nc nd">pip3 install datapane</span></pre><p id="9c43" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在您可以创建一个Datapane帐户，并通过终端/命令提示符登录:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="8265" class="mz lv it mv b gy na nb l nc nd">datapane login --token=[your_token]</span></pre><p id="3ce1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们都设置好了，我们可以继续发布我们的数字！</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="fde7" class="mz lv it mv b gy na nb l nc nd">import datapane as dp </span><span id="66bf" class="mz lv it mv b gy ne nb l nc nd">report = dp.Report(dp.Plot(fig))<br/>report.publish(name="SWE Study Area", open=True)</span></pre><p id="96f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦您运行这个代码，一个新的窗口将会打开，您的绘图将会上传到Datapane。我们可以通过粘贴“分享”按钮中的URL将情节直接嵌入到这篇文章中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng ms l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="ea61" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能需要进入设置，并将图“可见性”更改为“公共”。由于某些原因，在最新版本的Datapane上，在Python中设置可见性给我抛出了一个错误。</p><p id="df0c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们有了一个用Plotly构建的交互式网络地图，我们可以把它嵌入到任何地方。最棒的是，这个图比我能够通过Chart-Studio上传的要大得多，这意味着我可以开始上传更多的网络地图，而无需支付昂贵的订阅费。</p><h1 id="39a0" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">在GitHub页面上托管</h1><p id="28f6" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我尝试的Chart-Studio的第一个替代方案是用我的情节创建一个GitHub Pages repo，并通过iFrame嵌入它。我在几个地方读到过这种方法，我真的很喜欢它，因为GitHub Pages的限制很少。然而，许多网站，比如我们目前所在的网站，不支持手动插入iFrames。这意味着在GitHub页面上托管情节对我的用例不起作用，因为我不能将它们插入到我的文章中。不过，我将向您展示如何做到这一点，因为这是在您自己的网站上嵌入的一个很好的解决方案。</p><h2 id="ef99" class="mz lv it bd lw nh ni dn ma nj nk dp me lh nl nm mg ll nn no mi lp np nq mk nr bi translated">创建HTML文件</h2><p id="52d2" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">首先，我们需要使用Plotly来导出我们绘图的HTML文件。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="88fe" class="mz lv it mv b gy na nb l nc nd">import plotly.io as pio<br/>pio.write_html(fig, file='index.html', auto_open=True)</span></pre><p id="c030" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将使用生成的HTML文件在浏览器中打开绘图。</p><h2 id="0e9b" class="mz lv it bd lw nh ni dn ma nj nk dp me lh nl nm mg ll nn no mi lp np nq mk nr bi translated">设置GitHub页面</h2><p id="b9ad" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">使用GitHub页面托管您的绘图有三个步骤:</p><ol class=""><li id="5b98" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">使用自述文件创建新的存储库</li><li id="d50d" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">上传新的HTML文件</li><li id="ae0d" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">转到“设置”选项卡，向下导航到“页面”，在“源”下选择您的主/主分支</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/8fcc867ec6d7388ed7d746bbb6573db7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wn_3f1PzLX8h1oVwtr0aKw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="52ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在你可以去<a class="ae oh" href="https://wino6687.github.io/swe_viz_1/" rel="noopener ugc nofollow" target="_blank">https://wino6687.github.io/swe_viz_1/</a>看剧情，但是我不能把它放在这里。</p><h1 id="b17f" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">包扎</h1><p id="40a5" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">希望这能帮助你找到一个免费的Chart-Studio的替代品，它没有500KB的上传限制。Datapane使嵌入图变得非常简单，并且它们与许多网站接口良好。</p><h1 id="d64e" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">资源</h1><ul class=""><li id="c445" class="ns nt it la b lb mm le mn lh oi ll oj lp ok lt ol ny nz oa bi translated"><a class="ae oh" href="https://docs.datapane.com/" rel="noopener ugc nofollow" target="_blank">数据面板文档</a></li><li id="909f" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ol ny nz oa bi translated"><a class="ae oh" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank"> Plotly文档</a></li></ul></div></div>    
</body>
</html>