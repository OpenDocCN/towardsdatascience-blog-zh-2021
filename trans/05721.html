<html>
<head>
<title>Chi-Square Test, with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卡方检验，用Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/chi-square-test-with-python-d8ba98117626?source=collection_archive---------3-----------------------#2021-05-22">https://towardsdatascience.com/chi-square-test-with-python-d8ba98117626?source=collection_archive---------3-----------------------#2021-05-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b37a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">执行卡方检验的完全初学者指南(带代码！)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5a08676192dd879ee194ed97ffe8dcbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TbwCxAZlZYd0S83IjzSONA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卡伦·艾姆斯利在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2c97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将介绍卡方检验(χ2)的基本原理，卡方检验是一种统计方法，用于推断一个变量的分布或判断总体中两个变量之间是否存在关系。推论依赖于χ2分布曲线，取决于自由度的数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0d962d3870e5d11792ee09da9d96066e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-VtI50wyyTXzOdW2svxR4Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:不同自由度的卡方分布[1]</p></figure><p id="373f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">χ2分布曲线是右偏的，随着自由度的增加，χ2曲线将更接近正态分布。</p><h1 id="a6a1" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">答:独立性的χ2检验</h1><p id="b7bd" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">它用于确定总体中两个变量之间是否存在关系。在分析两个分类变量的调查结果时很有用。</p><ul class=""><li id="f78b" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">H₀:这两个分类变量有<strong class="lb iu">没有关系</strong> <br/> H₁:这两个分类变量之间有<strong class="lb iu">一种关系</strong></li><li id="3620" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">χ2独立性检验统计量的自由度:<br/> d.f. = (# rows -1) *(#columns-1)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/c805242d5efb47a1e3b8176a2d74f28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFFtBknV9CEZ3ioHBmyi-Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表1: <strong class="bd ni"> rxc </strong>两个分类变量的列联表</p></figure><ul class=""><li id="92cb" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">如果H₀为真，上表中值的每个单元格将包含理论或<strong class="lb iu">预期频率Eᵢⱼ </strong>，而不是每个单元格的<strong class="lb iu">观测值</strong> <strong class="lb iu"> Oᵢⱼ </strong>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/cb85237a6b68312fc4aa4ce2d8350c16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ujyHU_Kj_xLozEd6X-ZKTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:预期频率的推导</p></figure><ul class=""><li id="bea2" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">检验统计:比较<strong class="lb iu"> Oᵢⱼ &amp; Eᵢⱼ </strong>之间的差异得出χ2统计，自由度为[(r-1) x (c-1)]，其中</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/0ab86ae577f27f5a454d1fdab2d755ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*SG-NUDfemymJUoo_XyM--A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">超过rxc列联表中的所有单元格</p></figure></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><blockquote class="ns nt nu"><p id="7974" class="kz la nv lb b lc ld ju le lf lg jx lh nw lj lk ll nx ln lo lp ny lr ls lt lu im bi translated">下表是一项出口民调，显示了对两个分类变量的联合回应:18-29岁、30-44岁、45-64岁和65岁以上人群，以及他们的政治倾向，即“保守”、“社会主义”和“其他”。在5%的显著性水平上，年龄组和他们的政治倾向之间有关系吗？</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f1b54b00b0484517dc8af0dcd8cb0f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*RhRyvc_638pybH-dqiKRag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表2:投票后调查[2]</p></figure><p id="fd02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按照假设检验的五步过程:<br/> H₀:的年龄组与他们的政治倾向是否独立，即没有关系<br/> H₁:的年龄组与他们的政治倾向是否有依赖关系，即∃的a关系<br/> α = 0.05 <br/>遵循χ2独立性检验统计:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/ac4abe551fc234893b0988886bd06ed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8YoAJP6oXgmV5DlLuZ8IQ.png"/></div></div></figure><p id="902f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结论:我们有足够的证据表明，在5%的显著性水平上，年龄组和他们的政治倾向之间存在关联。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="eb82" class="lw lx it bd ly lz od mb mc md oe mf mg jz of ka mi kc og kd mk kf oh kg mm mn bi translated">B: χ2拟合优度检验</h1><p id="9f1d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">它用于推断变量的分布。</p><ul class=""><li id="2d67" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">H₀:变量有指定的分布，正态<br/> H₁:变量没有指定的分布，不正态</li><li id="aba0" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">χ2拟合优度检验统计的自由度数量:<br/> d.f. = (# categories -1)</li><li id="4a74" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">它将样品的<strong class="lb iu">观察频率O </strong>与<strong class="lb iu">预期频率E </strong>进行比较。<br/> <strong class="lb iu"> E =事件的概率*总样本量</strong></li></ul></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><blockquote class="ns nt nu"><p id="d040" class="kz la nv lb b lc ld ju le lf lg jx lh nw lj lk ll nx ln lo lp ny lr ls lt lu im bi translated">下表显示了2013年德国联邦大选超过4400万人的投票结果。41.5%的德国人投票给<em class="it">基督教民主联盟(CDU)</em>25.7%投给<em class="it">社会民主党</em>其余32.8%投给<em class="it">其他</em>。</p><p id="e2d2" class="kz la nv lb b lc ld ju le lf lg jx lh nw lj lk ll nx ln lo lp ny lr ls lt lu im bi translated">假设研究者采取随机抽样的方法，选取了123名傅柏林的学生进行调查。其中57人投票给CDU，26人投票给社民党，40人投票给其他人。这些数字对应于<strong class="lb iu">观察到的频率</strong>。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/4f2e5dcc82f8bc3c53c3d70f42190fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*PpwdP65Gd9TTC6TY-hByGQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表3: 2013年德国联邦大选[3]</p></figure><p id="5f7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按照假设检验的五步流程:<br/> H₀:变量具有规定的分布，即观测频率和期望频率大致相等<br/> H₁:变量不具有规定的分布，不正态<br/> α = 0.05 <br/>遵循χ2拟合优度检验统计量:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/d3246aa8fb817e7adb6c5922b7da02f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKNInN_MEZPkbjht_SOh0g.png"/></div></div></figure><p id="3398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结论:我们没有足够的证据证明观察到的和预期的频率在5%的显著性水平上不相等。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="5c68" class="lw lx it bd ly lz od mb mc md oe mf mg jz of ka mi kc og kd mk kf oh kg mm mn bi translated">推荐阅读</h1><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/anova-test-with-python-cfbf4013328b"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">用Python进行ANOVA测试</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">执行ANOVA测试的完全初学者指南(带代码！)</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ks on"/></div></div></a></div><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/two-way-anova-test-with-python-a112e2396d78"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">使用Python进行双向ANOVA测试</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">执行双向ANOVA检验的完全初学者指南(带代码！)</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pc l oy oz pa ow pb ks on"/></div></div></a></div><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/mcnemars-test-with-python-e1bab328d15c"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">McNemar的测试，使用Python</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">执行麦克纳玛测试的完整初学者指南(带代码！)</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pd l oy oz pa ow pb ks on"/></div></div></a></div><div class="ok ol gp gr om on"><a href="https://levelup.gitconnected.com/how-to-perform-one-sample-hypothesis-tests-with-python-308eae8789fc" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">使用Python进行单样本假设检验</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">执行单样本假设检验的完全初学者指南(带代码！)</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ow l"><div class="pe l oy oz pa ow pb ks on"/></div></div></a></div><div class="ok ol gp gr om on"><a href="https://levelup.gitconnected.com/two-sample-hypothesis-tests-with-python-43e1b8c52306" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">使用Python进行双样本假设检验</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">执行双样本假设检验的完全初学者指南(带代码！)</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ow l"><div class="pf l oy oz pa ow pb ks on"/></div></div></a></div></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="2af1" class="lw lx it bd ly lz od mb mc md oe mf mg jz of ka mi kc og kd mk kf oh kg mm mn bi translated">参考</h1><p id="ab4f" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">[1]《卡方检验SOGA地球科学系》【在线】。可用:<a class="ae ky" href="https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/Hypothesis-Tests/Chi-Square-Tests/index.html" rel="noopener ugc nofollow" target="_blank">https://www . geo . fu-Berlin . de/en/v/soga/Basics-of-statistics/Hypothesis-Tests/Chi-Square-Tests/index . html</a></p><p id="b267" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]《卡方独立性检验SOGA地球科学系》【在线】。可用:<a class="ae ky" href="https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/Hypothesis-Tests/Chi-Square-Tests/Chi-Square-Independence-Test/index.html" rel="noopener ugc nofollow" target="_blank">https://www . geo . fu-Berlin . de/en/v/soga/Basics-of-statistics/Hypothesis-Tests/Chi-Square-Tests/Chi-Square-Independence-Test/index . html</a></p><p id="4c86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3]《卡方拟合优度检验SOGA地球科学系》【在线】。可用:<a class="ae ky" href="https://www.geo.fu-berlin.de/en/v/soga/Basics-of-statistics/Hypothesis-Tests/Chi-Square-Tests/Chi-Square-Goodness-of-Fit-Test/index.html" rel="noopener ugc nofollow" target="_blank">https://www . geo . fu-Berlin . de/en/v/soga/Basics-of-statistics/Hypothesis-Tests/Chi-Square-Tests/Chi-Square-good-of-Fit-Test/index . html</a></p></div></div>    
</body>
</html>