<html>
<head>
<title>Bias-variance tradeoff in machine learning: an intuition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的偏差-方差权衡:一种直觉</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bias-variance-tradeoff-in-machine-learning-an-intuition-da85228c5074?source=collection_archive---------20-----------------------#2021-04-15">https://towardsdatascience.com/bias-variance-tradeoff-in-machine-learning-an-intuition-da85228c5074?source=collection_archive---------20-----------------------#2021-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/dadd3db1efddc8cc636a03340638d021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TenaZTVTku1Mi08-"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由古斯塔沃·托里斯在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="6946" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">在糟糕的和高度优化的模型之间进行选择</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="b6a6" class="lf lg jj bd lh li lj lk ll lm ln lo lp kp lq kq lr ks ls kt lt kv lu kw lv lw bi translated">一般直觉</h1><p id="741e" class="pw-post-body-paragraph lx ly jj lz b ma mb kk mc md me kn mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">如果我们口袋里有更多的钱，我们会花得更多——这几乎是每个人都知道的事实。但人们通常不知道收入和支出之间的确切关系，也就是说，在已知收入的情况下，人们会花多少钱。</p><p id="e512" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">一个近似的解决方法是，通过观察人们的收入和支出，建立一个统计模型。数据越多，模型越好。然后，我们可以把这个模型应用到一个未知的地方或人群，并有合理的把握。</p><p id="0346" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">但该模型无法做出100%准确的预测，因为人们的行为会随着时间和空间而变化(嗯，这就是为什么这被称为统计模型而不是确定性模型)。然而，即使这个模型不是通用的，我们也想让它具有足够的普遍性——一个<strong class="lz jk">“平均</strong> <strong class="lz jk">模型”</strong>，能够适应各种各样的变化和情况。</p><p id="6102" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">让我们考虑一个不同的背景，当我们真的想要为一个同质的群体建立一个模型时，他们的行为或多或少是可以预测的。在这种情况下，我们的目标是<strong class="lz jk">“优于平均水平的模式”</strong>适合特定人群。然而，我们知道，这种模式是为目标人群定制的，因此在异国环境中会失败。</p><p id="c568" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">我们构建的平均模型有偏差，但它具有很高的灵活性，可以在各种情况下工作，而优于平均水平的模型是定制的，偏差较小，但在接受训练的人群之外表现不佳。</p><p id="6da1" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">现在让我们把这两个模型都发挥到极致。在一个光谱中，我们将模型简化得太多，以至于它失去了所有的预测能力；随机猜测比模型表现更好。在另一个极端，让我们基于群体中的每个个体构建模型，并对模型进行调整，使其对该群体具有高预测能力。</p><p id="91be" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated"><strong class="lz jk">那么哪款更好呢？</strong></p><p id="7be0" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">取决于你想如何使用模型。一个坏的模型在任何地方都表现很差，一个普通的模型在大多数情况下表现一般，而一个微调的模型在一种情况下表现很好，但在其他情况下就不那么好了。</p><p id="1be1" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">建立模型的目的是解释现实世界的现象，我们使用模型是因为这些现象会在空间和时间上发生变化。但是我们能建立一个适用于任何地方和任何时间点的模型吗？</p><p id="b19e" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">答案是否定的。这就是偏差-方差权衡的概念有用的地方。</p><h1 id="9974" class="lf lg jj bd lh li mz lk ll lm na lo lp kp nb kq lr ks nc kt lt kv nd kw lv lw bi translated"><strong class="ak">偏差-方差权衡</strong></h1><p id="22dd" class="pw-post-body-paragraph lx ly jj lz b ma mb kk mc md me kn mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">现在让我们将这种直觉与<strong class="lz jk">偏差-方差权衡</strong>的正式概念联系起来。</p><p id="e787" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">在机器学习中，每个模型都被指定了许多决定模型性能的参数。一个好的模型在训练和样本外数据上都表现良好。</p><p id="790a" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">有些型号可以使用默认参数。但是，如果我们不调整参数，模型就有可能无法发挥最佳性能。这种情况被称为欠适配。</p><p id="00a4" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">因此，我们调整参数以适应训练数据，然后根据测试数据评估模型性能。重复该过程，直到模型达到期望的性能。但是这种定制模型如果放归野外会有怎样的表现呢？这种高度调整的模型很可能在样本外数据中表现不佳，这就是所谓的过拟合问题。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ne"><img src="../Images/4f269336c5bc2da59fe795855621d62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7zl6uB550YotkI4k0HZ7aA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">高调优模型与差模型和一般模型(来源:作者)</p></figure><p id="69b8" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">适应不足和适应过度同样不好——它们不擅长做出一般的预测。因此，偏差-方差权衡无非是维持欠拟合和过拟合之间的平衡，在高方差和高偏差之间进行选择。数据科学家找到了最佳点，因此他们相信该模型在样本外数据中表现良好。</p><h1 id="9f05" class="lf lg jj bd lh li mz lk ll lm na lo lp kp nb kq lr ks nc kt lt kv nd kw lv lw bi translated">一个例子</h1><p id="08af" class="pw-post-body-paragraph lx ly jj lz b ma mb kk mc md me kn mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">现在让我们用Python中的一个例子来扩展直觉和偏差-方差权衡的概念。为此，我将首先导入几个库(<code class="fe nj nk nl nm b">numpy </code>和<code class="fe nj nk nl nm b">seaborn</code>)并创建两个小数组——x和y——来演示。</p><pre class="nf ng nh ni gt nn nm no np aw nq bi"><span id="c799" class="nr lg jj nm b gy ns nt l nu nv">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="4fd1" class="nr lg jj nm b gy nw nt l nu nv">x = [0, 1, 2, 3, 4, 5, 6]<br/>y = [0, 1, 2, 14, 18, 32, 52]</span></pre><p id="a5bb" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">现在让我们画出x和y变量，并拟合一条线性回归线。</p><pre class="nf ng nh ni gt nn nm no np aw nq bi"><span id="5074" class="nr lg jj nm b gy ns nt l nu nv"># linear fit<br/>sns.regplot(x,y, ci=False);</span></pre><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/b49a7e7e38bcb8ec96813a3d961439db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*bJprqpyzgeiCEf1QNcgg8w.png"/></div></figure><p id="c93f" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">线性模型似乎不太适合数据，它显然看起来像一个坏模型，大多数数据点远离直线。它有很大的偏差，偏差很小。因此，显然有机会改进这一模式。</p><p id="e33f" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">现在让我们拟合一条高次多项式线，看看模型表现如何。</p><pre class="nf ng nh ni gt nn nm no np aw nq bi"><span id="00b1" class="nr lg jj nm b gy ns nt l nu nv"># polynomial fit<br/>poly_fit = np.poly1d(np.polyfit(x,y, 6))</span><span id="2951" class="nr lg jj nm b gy nw nt l nu nv">plt.plot(x, poly_fit(x), linestyle='-')<br/>plt.scatter(x, y);</span></pre><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/b48c44a329a7d5283ba9e90bb07130cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*OP8kUx4CYeV6wjxwzA_X2w.png"/></div></div></figure><p id="4932" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">多神奇啊！6次多项式完美地拟合了数据——实际上太完美了，没有误差。该模型捕捉数据中的每一点噪声。这个模型有很高的(完美的)方差，没有偏差。</p><p id="bc00" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">这是我们想要的型号吗？</p><p id="c1b4" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">大概不会。随着多项式阶数的增加，模型的复杂性增加。不能保证该模型在其他数据上的表现也是如此。</p><p id="fd50" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">那么更好的模型应该是什么样的呢？介于太坏和太好之间的东西？让我们尝试将多项式次数从6降低到2。</p><pre class="nf ng nh ni gt nn nm no np aw nq bi"><span id="ebff" class="nr lg jj nm b gy ns nt l nu nv"># polynomial fit<br/>poly_fit = np.poly1d(np.polyfit(x,y, 2))</span><span id="63cd" class="nr lg jj nm b gy nw nt l nu nv">plt.plot(x, poly_fit(x), linestyle='-')<br/>plt.scatter(x, y);</span></pre><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/1f4a3df9d67f80a2d22773848de9e94d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*dDbMV8IfyxNizmH1C1aoww.png"/></div></figure><p id="e14a" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">这个2次多项式模型有一些误差，当然没有6次模型好，但也没有简单的线性拟合差。因此，事实证明，高次多项式更适合数据，但它也使模型变得复杂。</p><h1 id="78ec" class="lf lg jj bd lh li mz lk ll lm na lo lp kp nb kq lr ks nc kt lt kv nd kw lv lw bi translated">有什么解决办法？</h1><p id="33a0" class="pw-post-body-paragraph lx ly jj lz b ma mb kk mc md me kn mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">复杂模型过度拟合训练数据，但无法在测试和样本外数据中做出高质量的预测。另一方面，一个简单的模型不符合训练数据，在测试数据中也表现不佳。</p><p id="4bc2" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">因此，数据科学家的目标是找到一个平衡点来平衡权衡。但是在实践中到底是怎么做的呢？</p><p id="dd4e" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">欠拟合很容易发现，因为它显示在模型性能中。然而，过拟合很难捕捉，因为模型在误差度量方面表现良好。对于数据科学家来说，扔掉一个非常适合的模型，选择一个性能较低的模型也是非常困难的。但是有一些工具可以让这个决定变得更容易。这里有几个选项:</p><p id="48f6" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">1)错误与复杂性的直观解释:通常，一个好的实践是通过绘图来选择模型:</p><ul class=""><li id="ce35" class="oa ob jj lz b ma mt md mu mg oc mk od mo oe ms of og oh oi bi translated">训练数据中的误差与复杂性</li><li id="3534" class="oa ob jj lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">测试数据中的误差与复杂性</li><li id="8323" class="oa ob jj lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">检查两条曲线的相交处，并相应地调整参数</li></ul><p id="7605" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">在回归中，偏差-方差权衡可以通过绘制均方误差(MSE)与模型复杂性的关系图来检查。在分类中，同样可以通过将错误分类的数量与复杂性相对比来检查。</p><p id="a973" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">2)正则化:这是一种通过在成本函数中添加小偏差来优化模型性能的技术。这种小偏差会缩小特征系数，降低其灵敏度。</p><p id="a1d9" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">如果数据集中有太多的要素，正则化<em class="my">会控制</em>它们的影响，并降低它们的敏感度。这是通过将模型系数向零收缩来实现的。通常使用两种类型的正则化-L1(套索回归)和L2(岭回归)，它们由超参数λ控制。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h2 id="7c3e" class="nr lg jj bd lh oo op dn ll oq or dp lp mg os ot lr mk ou ov lt mo ow ox lv oy bi translated">摘要</h2><p id="44d9" class="pw-post-body-paragraph lx ly jj lz b ma mb kk mc md me kn mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">总结偏差-方差权衡的概念:</p><ul class=""><li id="4550" class="oa ob jj lz b ma mt md mu mg oc mk od mo oe ms of og oh oi bi translated">如果模型过于简单且不符合训练数据，它在实际预测中的表现也会很差。</li><li id="943b" class="oa ob jj lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">根据训练数据高度调整的模型也可能表现不佳。</li><li id="5867" class="oa ob jj lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">偏差-方差权衡允许检查平衡以找到合适的模型。</li><li id="2f97" class="oa ob jj lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">有两种方法来检查权衡——a .错误与复杂性的直观解释，b .正则化。</li></ul><p id="e189" class="pw-post-body-paragraph lx ly jj lz b ma mt kk mc md mu kn mf mg mv mi mj mk mw mm mn mo mx mq mr ms im bi translated">希望这是对机器学习中这个重要概念的有益讨论，如果你有意见，请随时写在下面，或者通过<a class="ae jg" href="https://mab-datasc.medium.com/" rel="noopener">媒体</a>、<a class="ae jg" href="https://twitter.com/DataEnthus" rel="noopener ugc nofollow" target="_blank">推特</a>或<a class="ae jg" href="https://www.linkedin.com/in/mab-alam/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系。</p></div></div>    
</body>
</html>