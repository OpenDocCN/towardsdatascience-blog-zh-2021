<html>
<head>
<title>How to Detect, Handle and Visualize Outliers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何检测、处理和可视化异常值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-detect-handle-and-visualize-outliers-ad0b74af4af7?source=collection_archive---------15-----------------------#2021-06-06">https://towardsdatascience.com/how-to-detect-handle-and-visualize-outliers-ad0b74af4af7?source=collection_archive---------15-----------------------#2021-06-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6d32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我刚开始开发数据科学项目时，我不关心数据可视化或离群点检测，我只关心创建酷模型。但是，当我开始检查其他数据科学家的代码时，我意识到数据质量甚至比模型本身更重要，所以我开始更多地关注探索性数据分析(EDA)部分，我意识到我是多么愚蠢。</p><h1 id="6fa9" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">介绍</h1><p id="a475" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">几乎在任何数据科学项目中，我们都必须了解我们将要处理的数据。根据我们从事的项目，这些数据会有很大差异，但每个项目的流程几乎都是相同的:</p><ol class=""><li id="c225" class="lo lp iq jp b jq jr ju jv jy lq kc lr kg ls kk lt lu lv lw bi translated">从源(读取数据。csv，。xlsx，关系数据库…)</li><li id="a1b3" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">检查每一列的描述性统计数据(平均值、最大值、最小值、标准偏差、中位数……)</li><li id="0a4c" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">数据清理和数据争论(删除或填充NaN、inf和-inf值，删除无用的列，创建新列……)</li><li id="3ddd" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">使用不同类型的图(条形图、散点图、箱线图等)可视化数据</li><li id="c46f" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">处理异常值(如果可能，删除或转换它们)</li><li id="9aee" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">创建、训练和测试模型</li><li id="2552" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">迭代最佳模型，进行微调、特性选择和A/B测试</li><li id="2ee4" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">选择最佳模型并部署它</li></ol><p id="5e2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，详细解释这一过程需要很长时间，所以在这篇文章中，我将把重点放在异常检测、处理和可视化上。但是等一下…什么是离群值，为什么我应该关心它们？</p><p id="fb38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据<strong class="jp ir">维基百科</strong>，这是离群值的定义:</p><blockquote class="mc md me"><p id="8774" class="jn jo mf jp b jq jr js jt ju jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj kk ij bi translated">在统计学中，<strong class="jp ir">异常值</strong>是与其他观察值显著不同的数据点。异常值可能是由于测量中的可变性造成的，或者它可能表明实验误差；后者有时被排除在数据集之外。异常值会在统计分析中引起严重的问题。</p></blockquote><h1 id="b73b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">一些异常理论</h1><p id="c4ab" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">既然我们已经了解了什么是异常值以及为什么处理它们很重要，我们可以从一些理论开始。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mj"><img src="../Images/d2bda09501378aca9c56797ae5ea9ee8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCMZh7xGtjnSXwxyvuEzkg.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">正态分布和标准偏差[2]</p></figure><p id="4aab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上图显示了一个完美的正态分布数据集。如果我们仔细观察曲线的中心，我们会看到数据集的平均值的标准偏差为0，根据理论，正态分布数据集的99.7%的数据点距离平均值的标准偏差在3到-3之间。这意味着标准偏差大于3或小于-3的所有值都将被视为异常值。</p><h1 id="16b9" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">用Python可视化离群值</h1><p id="c2ef" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">检测异常值的一个非常有用的方法是可视化它们。显示异常值的最佳图表类型是箱线图。但是，在可视化之前，让我们加载一个数据集:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/92e8916a31598037f4f001d785adcf40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*j0EXZRRdWeMXujwoBNggqQ.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">Scikit-learn的加州住房数据集</p></figure><h2 id="6f43" class="nc km iq bd kn nd ne dn kr nf ng dp kv jy nh ni kz kc nj nk ld kg nl nm lh nn bi translated">箱形图</h2><p id="77ce" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">正如我之前所说的，当谈到离群值可视化时，盒状图是掌握关于数据离群值的有价值信息的最简单的方法。但是在可视化任何异常值之前，让我们理解什么是箱线图及其不同的组成部分:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi no"><img src="../Images/a3ef6e1cfdeac61c0fc3397d6ef2d98f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MPDTLn8KoLApoFvI0P2vQ.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">箱形图的组成部分[3]</p></figure><p id="e744" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们在上面的图像中看到的，箱线图有许多组成部分，每一部分都有助于我们表示和理解数据:</p><ul class=""><li id="349c" class="lo lp iq jp b jq jr ju jv jy lq kc lr kg ls kk np lu lv lw bi translated"><strong class="jp ir"> Q1。</strong> 25%的数据低于该数据点。</li><li id="f865" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk np lu lv lw bi translated"><strong class="jp ir">中位数。</strong>数据集的中心值。它也可以表示为Q2。50%的数据都在这个数据点以下。</li><li id="347c" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk np lu lv lw bi translated"><strong class="jp ir"> Q3。</strong> 75%的数据都在这个数据点以下。</li><li id="8c34" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk np lu lv lw bi translated"><strong class="jp ir">最小值。</strong>数据集中非异常值的最小值数据点。</li><li id="0fbe" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk np lu lv lw bi translated"><strong class="jp ir">最大。</strong>数据集中非离群值的最大值的数据点。</li><li id="3807" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk np lu lv lw bi translated"><strong class="jp ir"> IQR。</strong>代表Q1和Q3之间的所有值。</li></ul><p id="6846" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们理解了盒状图的所有组成部分，让我们针对数据集中的给定变量对其进行可视化:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/052f62922a1ebfcde77f070f238be513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*Z8UA-wghDHXnJYTpK672eQ.png"/></div></figure><p id="9a82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哇！看起来在我们的数据集的MedInc变量中有许多异常数据点。但是，如果我们想检查熊猫的数据框中的这些行呢？我们怎样才能只选择这些行呢？</p><p id="7d0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下面的段落中，我们将看到如何使用Python和scipy包来检测异常值。</p><h1 id="bb0e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">从头开始检测异常值</h1><p id="2ef5" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">正如我们在文章开头所说的，所有偏离平均值3或-3个标准差的数据点都是异常值。让我们为MedInc列(中等收入列)编码:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="cfd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些是异常值:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/547b94adf03335ebac87cb4e88a684a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*vOKj0ex5n6wdX5i0CeLx1A.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">中间异常行</p></figure><p id="f7d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们移除所有医学异常值，这将是数据集:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/44fe7e4599f982f5b76fac6ba9a24da9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*YG25KtJl__e5STieVrpJXQ.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">无医学异常值的数据集</p></figure><h1 id="8949" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">用Scipy检测异常值</h1><p id="2488" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">有一种更简单的方法来检测异常值。多亏了scipy包，我们可以计算任何给定变量的z值。z得分让您了解一个数据点离平均值有多少标准差。因此，如果z得分为-1.8，我们的数据点将偏离平均值-1.8个标准偏差。让我们检查代码:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="4e4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们显示数据框，结果将与我们之前从头开始的方法相同:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nt"><img src="../Images/f7f876e77fbfd84994c8a3f65e5e2541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YjnDwrwLV5kdOfUBnfjfbw.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">使用z-score对异常值行进行MedInc</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nu"><img src="../Images/4f8255550fb4cc5aec3f30c32f9a9023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQ0-fbtfYlmH6vr0rWVI7A.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">使用z-score的无医学异常值数据集</p></figure><h1 id="3185" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">处理异常值</h1><p id="4724" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们已经学会了如何检测和可视化异常值，但是我们如何处理它们呢？这个问题没有简单的答案，但我会尽量简短。答案是，这在很大程度上取决于你正在做的项目类型:</p><p id="cb6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您正在进行探索性数据分析(EDA)，您的一些见解可能是错误的，因为异常值可能会让您得出错误的结论。为了防止这种情况，您还应该从其余数据中单独分析您的异常值，并尝试重复分析以消除异常值。一旦你完成了这个迭代过程，你的洞察力将更加一致。</p><p id="a6e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在您创建机器学习模型的情况下，离群值可能会使您的模型表现不佳。为了防止这种情况发生，你可以尝试不同的方法。这里有两个例子:</p><ul class=""><li id="b88c" class="lo lp iq jp b jq jr ju jv jy lq kc lr kg ls kk np lu lv lw bi translated">如果您有大量数据，但离群值很少，您可以尝试删除它们，并用较少的数据训练您的模型。</li><li id="b06f" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk np lu lv lw bi translated">如果异常值是由错误的测量(如传感器收集的数据)引起的，您可以尝试使用平均值来更改异常值。</li></ul><h1 id="db81" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">摘要</h1><p id="1d47" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在这篇文章中，我们看到:</p><ol class=""><li id="5270" class="lo lp iq jp b jq jr ju jv jy lq kc lr kg ls kk lt lu lv lw bi translated">离群值的定义</li><li id="c4f2" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">关于异常值和数据分布的一些理论</li><li id="6f58" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">如何可视化离群值</li><li id="8b1d" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">如何检测异常值</li><li id="26be" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">如何处理异常值</li></ol><h1 id="ff14" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">参考</h1><ol class=""><li id="74ee" class="lo lp iq jp b jq lj ju lk jy nv kc nw kg nx kk lt lu lv lw bi translated"><a class="ae ny" href="https://es.wikipedia.org/wiki/Distribuci%C3%B3n_de_probabilidad" rel="noopener ugc nofollow" target="_blank">https://es . Wikipedia . org/wiki/Distribuci % C3 % B3n _ de _ probabilidad</a></li><li id="71df" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated"><a class="ae ny" rel="noopener" target="_blank" href="/understanding-boxplots-5e2df7bcbd51">https://towards data science . com/understanding-box plots-5e 2 df 7 bcbd 51</a></li></ol></div></div>    
</body>
</html>