<html>
<head>
<title>Top 4 Python libraries to build interactive timeseries plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建交互式时间序列图的4大Python库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/top-4-python-libraries-to-build-interactive-timeseries-plots-f2214cc9b1ea?source=collection_archive---------2-----------------------#2021-09-02">https://towardsdatascience.com/top-4-python-libraries-to-build-interactive-timeseries-plots-f2214cc9b1ea?source=collection_archive---------2-----------------------#2021-09-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="df1f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在本教程中，我们将使用Plotly，Bokeh，Altair和Matplotlib构建交互式时间序列图，并比较哪一个最好。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c9c1f388d37c75d4b5d5bf82f40e1057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3WzK4J0NDd7-5s3q"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">斯蒂芬·菲利普斯-Hostreviews.co.uk在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="02b9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="d29b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">分析数据时遇到的最普遍的数据类型之一是时间序列。从识别趋势到理解“因果”行为，时间序列分析是理解用户行为、购买模式等等最流行的方法之一。</p><p id="0fca" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在Python中，我们通常从使用Matplotlib或Seaborn绘制简单的直线曲线开始，如果您只处理一个随时间变化的分类变量，这两种工具是完美的。但是通常你需要一起显示多个分类变量，例如市场数据的股票列表，或者销售数据的地区/位置。</p><p id="2b3a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这种情况下，您可以在同一个图中显示所有系列，也可以为每个系列创建单独的图。然而，这些选项很难理解，而且会占用很多空间。</p><p id="16ae" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这就是Plotly、Bokeh和Altair等高级可视化库发挥作用的地方，因为它们允许您使用下拉菜单、滑块、按钮等功能创建交互式绘图和仪表板。，帮助您的用户探索复杂的数据。</p><p id="d636" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本文中，我们将探索时间序列可视化的两个交互元素</p><ul class=""><li id="bfdb" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated"><strong class="lq ir">下拉菜单</strong>让你在同一个情节的不同系列之间切换</li><li id="6a08" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir">日期范围滑块</strong>允许您观察特定时间段之间的趋势</li></ul><blockquote class="nd ne nf"><p id="7a3e" class="lo lp ng lq b lr mk jr lt lu ml ju lw nh mm lz ma ni mn md me nj mo mh mi mj ij bi translated">以下示例中使用的所有代码均可在<a class="ae kv" href="https://github.com/shoumikgoswami/Interactive-plots" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></blockquote><p id="285d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="ng">免责声明:本文是与Datapane合作撰写的，我是datapane团队的一名社区布道者。</em></p><h1 id="4a19" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">向线图添加下拉菜单</h1><p id="78a4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果数据中有很多类别，例如股票或国家，并且您想在同一个图或图形中使用折线图来观察趋势，下拉菜单非常方便。这样可以避免在一个循环中创建多个图。</p><p id="ab7e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">所有三个库，即Plotly，Bokeh和Altair允许你添加一个下拉菜单到图中，但每个都有其优点和缺点。</p><p id="b2b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">作为奖励，我还将向您展示使用Matplotlib或Seaborn实现这一点的方法，它们不支持开箱即用的交互式组件。</p><h1 id="6662" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">使用Plotly的下拉菜单</h1><p id="b850" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Plotly提供了一系列被称为<a class="ae kv" href="https://plotly.com/python/#controls" rel="noopener ugc nofollow" target="_blank">自定义控件</a>的交互选项。这些控件最好的地方在于，它们可以完全用pythonic代码添加到绘图中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/d9cadab580b5c00e0e81cf98f3e8c1d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z9pdyYe9eICPxNbM"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:Plotly文件(【https://plotly.com/python/#controls】T2)</p></figure><p id="ac2b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">出于本教程的目的，我们将使用Covid 19数据集，它可以在这里<a class="ae kv" href="https://www.kaggle.com/imdevskp/corona-virus-report" rel="noopener ugc nofollow" target="_blank">访问</a>。</p><p id="d4e5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们将创建一个图表来显示Covid 19在全球的分布情况，并添加一个下拉列表来更改同一图表中的国家。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4f21" class="nq kx iq nm b gy nr ns l nt nu">buttons = []<br/>i = 0</span><span id="8e96" class="nq kx iq nm b gy nv ns l nt nu">fig3 = go.Figure()</span><span id="4f7d" class="nq kx iq nm b gy nv ns l nt nu">country_list = list(df['country'].unique())</span><span id="1fe8" class="nq kx iq nm b gy nv ns l nt nu">for country in country_list:<br/>    fig3.add_trace(<br/>        go.Scatter(<br/>            x = df['date'][df['country']==country],<br/>            y = df['confirmed'][df['country']==country],<br/>            name = country, visible = (i==0)<br/>        )<br/>    )<br/>    <br/>for country in country_list:<br/>    args = [False] * len(country_list)<br/>    args[i] = True<br/>    <br/>    <em class="ng">#create a button object for the country we are on</em><br/>    button = dict(label = country,<br/>                  method = "update",<br/>                  args=[{"visible": args}])<br/>    <br/>    <em class="ng">#add the button to our list of buttons</em><br/>    buttons.append(button)<br/>    <br/>    <em class="ng">#i is an iterable used to tell our "args" list which value to set to True</em><br/>    i+=1<br/>    <br/>fig3.update_layout(updatemenus=[dict(active=0,<br/>                                    type="dropdown",<br/>                                    buttons=buttons,<br/>                                    x = 0,<br/>                                    y = 1.1,<br/>                                    xanchor = 'left',<br/>                                    yanchor = 'bottom'),<br/>                              ])</span><span id="8f11" class="nq kx iq nm b gy nv ns l nt nu">fig3.update_layout(<br/>    autosize=False,<br/>    width=1000,<br/>    height=800,)</span></pre><p id="502f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您将有一个漂亮的下拉菜单添加到时间序列图中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://datapane.com/u/shoumik/reports/0kz9Za7/dropdown-with-plotly/" rel="noopener ugc nofollow" target="_blank">https://data pane . com/u/shou mik/reports/0kz 9 za 7/drop-with-plotly/</a></p></figure><h1 id="54ab" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">使用散景的下拉菜单</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/3d4f3e5ef9afd40ec6113dcfa0327df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7fRedTz3r2_CNT-N"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:Bokeh文档(<a class="ae kv" href="https://docs.bokeh.org/en/latest/docs/user_guide/interaction/widgets.html" rel="noopener ugc nofollow" target="_blank">https://docs . Bokeh . org/en/latest/docs/user _ guide/interaction/widgets . html</a>)</p></figure><p id="cc4e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">散景有称为部件的组件，可用于将几个交互式组件添加到您的绘图中。小部件主要用于创建Bokeh服务器上的仪表板组件。你可以在这里阅读更多关于widgets <a class="ae kv" href="https://docs.bokeh.org/en/latest/docs/user_guide/interaction/widgets.html" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="6709" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">请记住，为了创建独立HTML文件的小部件，或者甚至在使用Jupyter notebook时，您将需要使用<strong class="lq ir"> CustomJS </strong>回调。这需要一点JavaScript知识来让下拉菜单正常工作。如果你想用纯pythonic的方式来做，你必须使用Bokeh服务器来让小部件工作。</p><p id="99d4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们将使用散景下拉来复制与上面相同的用例。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="c42b" class="nq kx iq nm b gy nr ns l nt nu">cols1=df.loc[:, ['country','date', 'confirmed']]<br/>cols2 = cols1[cols1['country'] == 'Afghanistan' ]</span><span id="b97d" class="nq kx iq nm b gy nv ns l nt nu">Overall = ColumnDataSource(data=cols1)<br/>Curr=ColumnDataSource(data=cols2)</span><span id="82da" class="nq kx iq nm b gy nv ns l nt nu"><em class="ng">#plot and the menu is linked with each other by this callback function</em></span><span id="7d73" class="nq kx iq nm b gy nv ns l nt nu">callback = CustomJS(args=dict(source=Overall, sc=Curr), code="""<br/>var f = cb_obj.value<br/>sc.data['date']=[]<br/>sc.data['confirmed']=[]<br/>for(var i = 0; i &lt;= source.get_length(); i++){<br/>	if (source.data['country'][i] == f){<br/>		sc.data['date'].push(source.data['date'][i])<br/>		sc.data['confirmed'].push(source.data['confirmed'][i])<br/>	 }<br/>}   <br/>   <br/>sc.change.emit();<br/>""")</span><span id="3415" class="nq kx iq nm b gy nv ns l nt nu">menu = Select(options=country_list,value='Afghanistan', title = 'Country')  <em class="ng"># drop down menu</em></span><span id="aebb" class="nq kx iq nm b gy nv ns l nt nu">bokeh_p=figure(x_axis_label ='date', y_axis_label = 'confirmed', y_axis_type="linear",x_axis_type="datetime") <em class="ng">#creating figure object</em></span><span id="e6ab" class="nq kx iq nm b gy nv ns l nt nu">bokeh_p.line(x='date', y='confirmed', color='green', source=Curr) <br/><em class="ng"># plotting the data using glyph circle</em></span><span id="6086" class="nq kx iq nm b gy nv ns l nt nu">menu.js_on_change('value', callback) <em class="ng"># calling the function on change of selection</em></span><span id="2af0" class="nq kx iq nm b gy nv ns l nt nu">layout=column(menu, bokeh_p) <em class="ng"># creating the layout</em><br/>show(layout)</span></pre><p id="ccba" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是剧情的样子-</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/c88210e4d3fddd1b2ebf492d27451612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y_Jgo484IKhjIbxVoIiDbA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者创作</p></figure><h1 id="800b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">使用Altair的下拉菜单</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/6fe40a77116c3e29fbcc193cc3631191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8yoYZOozFz1J_inz"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:Altair文档(<a class="ae kv" href="https://altair-viz.github.io/gallery/multiple_interactions.html" rel="noopener ugc nofollow" target="_blank">https://Altair-viz . github . io/gallery/multiple _ interactions . html</a>)</p></figure><p id="cb64" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在用纯pythonic方式构建可视化方面，Altair类似于Plotly。虽然Altair提供了许多交互式组件，但要以用户友好的布局来排列这些组件有点困难。你可以在这里阅读更多关于Altair <a class="ae kv" href="https://altair-viz.github.io/gallery/multiple_interactions.html" rel="noopener ugc nofollow" target="_blank">交互组件的信息。</a></p><p id="0f97" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们现在将使用Altair创建相同的绘图，并向绘图添加一个下拉菜单。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="6e16" class="nq kx iq nm b gy nr ns l nt nu">input_dropdown = alt.binding_select(options=country_list)<br/>selection = alt.selection_single(fields=['country'], bind=input_dropdown, name='Country')</span><span id="170f" class="nq kx iq nm b gy nv ns l nt nu">alt_plot = alt.Chart(df).mark_line().encode(<br/>    x='date',<br/>    y='confirmed',<br/>    tooltip='confirmed'<br/>).add_selection(<br/>    selection<br/>).transform_filter(<br/>    selection<br/>)</span><span id="b1df" class="nq kx iq nm b gy nv ns l nt nu">alt_plot</span></pre><p id="9e6a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是剧情的样子-</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://datapane.com/u/shoumik/reports/dkjVxgk/dropdown-with-altair/" rel="noopener ugc nofollow" target="_blank">https://data pane . com/u/shou mik/reports/dkjVxgk/drop down-with-Altair/</a></p></figure><h1 id="7284" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">使用Matplotlib和Datapane的下拉菜单</h1><p id="320c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果您想使用像Matplotlib或Seaborn这样的非交互式库，您可以使用Datapane添加交互性，data pane是一个用于创建和托管数据报告的库。Datapane提供了一些高级布局模块，如<strong class="lq ir"> dp。选择</strong>，让你模仿交互过滤能力，像这样:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="2f96" class="nq kx iq nm b gy nr ns l nt nu">plot_list = []</span><span id="f61c" class="nq kx iq nm b gy nv ns l nt nu">plt.figure(figsize=(10, 5), dpi=300)</span><span id="f999" class="nq kx iq nm b gy nv ns l nt nu">for country in country_list:<br/>    plot = dp.Plot(df[df['country']==country].plot.scatter(x='date', y='confirmed'), label=country)<br/>    plot_list.append(plot)</span><span id="19c8" class="nq kx iq nm b gy nv ns l nt nu">report = dp.Report(<br/>    dp.Text('''## Dropdown using Datapane'''),<br/>    dp.Select(blocks = plot_list)<br/>)</span><span id="ea0d" class="nq kx iq nm b gy nv ns l nt nu">report.preview()</span></pre><p id="d08d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这就是它看起来的样子-</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://datapane.com/u/shoumik/reports/R70pzg7/dropdown-with-datapane/" rel="noopener ugc nofollow" target="_blank">https://data pane . com/u/shou mik/reports/r 70 pzg 7/drop down-with-data pane/</a></p></figure><p id="845a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">请注意，您目前不能使用Datapane将日期范围滑块添加到您的图中。如果你是Datapane的新手，你可以在这里阅读更多关于不同块的内容。</p><h1 id="63d5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">向折线图添加日期范围滑块</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/cf84dbf6654994ce52df409e4f95cf88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7jlLQqLFlr7a9UOs"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:Plotly文档</p></figure><p id="2eba" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在处理时间序列图时，另一个非常方便的交互组件是日期范围滑块或通用滑块。</p><p id="e6e6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">由于大多数时间序列图都在X轴上有一个日期范围，因此滑块允许您动态更改时间段，并只查看图的一部分，以了解该特定时间段的趋势。</p><h1 id="8d98" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">使用Plotly的日期范围滑块</h1><p id="6f0f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Plotly有一个通用的滑块组件，可以用来改变对应于任何轴的数据。虽然它没有针对时间序列数据的特定滑块，但通用滑块可用于创建日期范围滑块。</p><p id="f1ad" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">你可以在这里阅读更多关于滑块<a class="ae kv" href="https://plotly.com/python/sliders/" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="1892" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了创建一个滑块，我们将使用之前用下拉菜单创建的相同的timeseries绘图，并在绘图下面添加一个滑块组件。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="e591" class="nq kx iq nm b gy nr ns l nt nu">buttons = []<br/>i = 0</span><span id="e637" class="nq kx iq nm b gy nv ns l nt nu">fig3 = go.Figure()</span><span id="57ae" class="nq kx iq nm b gy nv ns l nt nu">country_list = list(df['country'].unique())</span><span id="3a8e" class="nq kx iq nm b gy nv ns l nt nu">for country in country_list:<br/>    fig3.add_trace(<br/>        go.Scatter(<br/>            x = df['date'][df['country']==country],<br/>            y = df['confirmed'][df['country']==country],<br/>            name = country, visible = (i==0)<br/>        )<br/>    )<br/>    <br/>for country in country_list:<br/>    args = [False] * len(country_list)<br/>    args[i] = True<br/>    <br/>    <em class="ng">#create a button object for the country we are on</em><br/>    button = dict(label = country,<br/>                  method = "update",<br/>                  args=[{"visible": args}])<br/>    <br/>    <em class="ng">#add the button to our list of buttons</em><br/>    buttons.append(button)<br/>    <br/>    <em class="ng">#i is an iterable used to tell our "args" list which value to set to True</em><br/>    i+=1<br/>    <br/>fig3.update_layout(updatemenus=[dict(active=0,<br/>                                    type="dropdown",<br/>                                    buttons=buttons,<br/>                                    x = 0,<br/>                                    y = 1.1,<br/>                                    xanchor = 'left',<br/>                                    yanchor = 'bottom'),<br/>                              ])</span><span id="cd8a" class="nq kx iq nm b gy nv ns l nt nu">fig3.update_layout(<br/>    autosize=False,<br/>    width=1000,<br/>    height=800,)</span></pre><p id="1dc8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这会给你这样的东西-</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://datapane.com/u/shoumik/reports/43gPbv7/dropdown-and-slider-with-plotly/" rel="noopener ugc nofollow" target="_blank">https://data pane . com/u/shou mik/reports/43 gpbv 7/drop-and-slider-with-plotly/</a></p></figure><h1 id="ed26" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">使用散景的日期范围滑块</h1><p id="0dc0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">与Dropdown小部件类似，Bokeh也有一个日期范围滑块小部件，专门用于处理时间序列数据。这个小部件不同于一般的范围滑块小部件。为了让这个小部件工作，需要一个CustomJS回调。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="3163" class="nq kx iq nm b gy nr ns l nt nu">cols1=df.loc[:, ['country','date', 'confirmed']]<br/>cols2 = cols1[cols1['country'] == 'Afghanistan' ]</span><span id="e4a4" class="nq kx iq nm b gy nv ns l nt nu">Overall = ColumnDataSource(data=cols1)<br/>Curr=ColumnDataSource(data=cols2)</span><span id="9320" class="nq kx iq nm b gy nv ns l nt nu"><em class="ng">#plot and the menu is linked with each other by this callback function</em><br/>callback = CustomJS(args=dict(source=Overall, sc=Curr), code="""<br/>var f = cb_obj.value<br/>sc.data['date']=[]<br/>sc.data['confirmed']=[]<br/>for(var i = 0; i &lt;= source.get_length(); i++){<br/>	if (source.data['country'][i] == f){<br/>		sc.data['date'].push(source.data['date'][i])<br/>		sc.data['confirmed'].push(source.data['confirmed'][i])<br/>	 }<br/>}   <br/>   <br/>sc.change.emit();<br/>""")</span><span id="94b0" class="nq kx iq nm b gy nv ns l nt nu">menu = Select(options=country_list,value='Afghanistan', title = 'Country')  <em class="ng"># drop down menu</em><br/>bokeh_p=figure(x_axis_label ='date', y_axis_label = 'confirmed', y_axis_type="linear",x_axis_type="datetime") <em class="ng">#creating figure object </em><br/>bokeh_p.line(x='date', y='confirmed', color='green', source=Curr) <em class="ng"># plotting the data using glyph circle</em><br/>menu.js_on_change('value', callback) <em class="ng"># calling the function on change of selection</em></span><span id="486b" class="nq kx iq nm b gy nv ns l nt nu">date_range_slider = DateRangeSlider(value=(min(df['date']), max(df['date'])),<br/>                                    start=min(df['date']), end=max(df['date']))</span><span id="59dc" class="nq kx iq nm b gy nv ns l nt nu">date_range_slider.js_link("value", bokeh_p.x_range, "start", attr_selector=0)<br/>date_range_slider.js_link("value", bokeh_p.x_range, "end", attr_selector=1)</span><span id="b1ff" class="nq kx iq nm b gy nv ns l nt nu">layout = column(menu, date_range_slider, bokeh_p)<br/>show(layout) <em class="ng"># displaying the layout</em></span></pre><p id="c323" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这就是它看起来的样子-</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/5043afe17553c6d6a06fe28a58f9d168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oss5eDaeEaiZHWzEMaFU-g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者创作</p></figure><h1 id="4afb" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">使用Altair的日期范围滑块</h1><p id="fcb7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">与Plotly类似，Altair可以将通用滑块用作日期范围滑块。但是，请记住，Vega以毫秒为单位考虑时间序列数据，很难在滑块中显示日期信息。如果你有每年的数据，它可以工作，但是如果数据被分解成几天和几个月，就很难工作了。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="20c8" class="nq kx iq nm b gy nr ns l nt nu">input_dropdown = alt.binding_select(options=country_list)<br/>selection = alt.selection_single(fields=['country'], bind=input_dropdown, name='Country')</span><span id="940b" class="nq kx iq nm b gy nv ns l nt nu">def <strong class="nm ir">timestamp</strong>(t):<br/>  return pd.to_datetime(t).timestamp() * 1000</span><span id="5c06" class="nq kx iq nm b gy nv ns l nt nu">slider = alt.binding_range(<br/>    step=30 * 24 * 60 * 60 * 1000, <em class="ng"># 30 days in milliseconds</em><br/>    min=timestamp(min(df['date'])),<br/>    max=timestamp(max(df['date'])))</span><span id="124e" class="nq kx iq nm b gy nv ns l nt nu">select_date = alt.selection_single(<br/>    fields=['date'],<br/>    bind=slider,<br/>    init={'date': timestamp(min(df['date']))},<br/>    name='slider')</span><span id="b82a" class="nq kx iq nm b gy nv ns l nt nu">alt_plot = alt.Chart(df).mark_line().encode(<br/>    x='date',<br/>    y='confirmed',<br/>    tooltip='confirmed'<br/>).add_selection(<br/>    selection<br/>).transform_filter(<br/>    selection<br/>).add_selection(select_date).transform_filter(<br/>    "(year(datum.date) == year(slider.date[0])) &amp;&amp; "<br/>    "(month(datum.date) == month(slider.date[0]))"<br/>)</span><span id="13b4" class="nq kx iq nm b gy nv ns l nt nu">alt_plot</span></pre><p id="68ab" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这就是它看起来的样子-</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://datapane.com/u/shoumik/reports/VkGyaV3/dropdown-and-slider-with-altair/" rel="noopener ugc nofollow" target="_blank">https://data pane . com/u/shou mik/reports/VkGyaV3/drop-and-slider-with-Altair/</a></p></figure><h1 id="bffe" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">裁决</h1><p id="4f0e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在已经使用了所有三个库，我们可以对它们进行比较，并分享我们对哪一个是创建交互式可视化的最佳python库的看法。</p><h2 id="9c17" class="nq kx iq bd ky od oe dn lc of og dp lg lx oh oi li mb oj ok lk mf ol om lm on bi translated">Plotly</h2><p id="aed3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">优点- </strong></p><ul class=""><li id="7876" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">易于使用，并与Python无缝协作。</li><li id="e095" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">布局可以根据要求设计，以确保菜单出现在绘图的正确区域。</li><li id="51b0" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">易于查看和嵌入Plotly情节。</li></ul><p id="98b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">缺点- </strong></p><ul class=""><li id="e1ec" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">不提供许多交互式组件。</li><li id="bd9c" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">有一个陡峭的学习曲线来使交互组件工作。</li></ul><h2 id="e926" class="nq kx iq bd ky od oe dn lc of og dp lg lx oh oi li mb oj ok lk mf ol om lm on bi translated">散景</h2><p id="d7fd" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">优点- </strong></p><ul class=""><li id="fccb" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">用散景创建的情节和交互部件看起来很有美感。</li><li id="60e9" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">因为散景更倾向于创建仪表板，所以使用多个组件创建布局更容易。</li><li id="4b62" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">一些交互式部件可以添加到绘图中。</li></ul><p id="f5df" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">缺点- </strong></p><ul class=""><li id="b8cd" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">为了让小部件工作，您需要了解一点JavaScript，以便能够创建<strong class="lq ir"> CustomJS </strong>回调。</li><li id="a83b" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">在创建这些JavaScript回调函数时，缺乏适当的文档和示例代码。</li><li id="9f27" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">除非您使用散景服务器，否则很难嵌入这些图。</li></ul><h2 id="bb2d" class="nq kx iq bd ky od oe dn lc of og dp lg lx oh oi li mb oj ok lk mf ol om lm on bi translated">阿尔泰尔</h2><p id="1c79" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">优点- </strong></p><ul class=""><li id="34bf" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">与Plotly相比，Altair提供了更多的交互式组件选项。</li><li id="5ad4" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">使用纯Python很容易构建交互式组件。</li><li id="2e34" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">需要更少的代码行来使交互组件工作。</li></ul><p id="da65" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">缺点- </strong></p><ul class=""><li id="0b1d" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">使用Altair很难设计和创建视觉上吸引人的布局。</li><li id="e489" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">处理时间序列数据并不简单，因为Vega不支持现成的时间序列数据，需要进行一些转换才能使其工作。</li></ul><h1 id="e0be" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="f30d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">总的来说，如果您正在开始使用Python进行交互式绘图，那么使用有限的交互式组件创建简单的绘图时，<strong class="lq ir"> Plotly可能是一个不错的选择。</strong></p><p id="2e86" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">但是<strong class="lq ir">如果你想在你的剧情中加入一些互动元素，那么Altair是你应该真正尝试的东西。最好的部分是你可以用Python代码添加几个交互组件。</strong></p><p id="e3da" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果你想构建非常复杂的交互式仪表盘，你可以使用散景。但是请记住，您将需要一些JavaScript知识来使它们工作。</p><p id="b0d9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果您想坚持使用Matplotlib和Seaborn之类的非交互式可视化库，并且仍然想要某种形式的交互性，比如只有一个下拉菜单，那么Datapane可能是一个不错的选择。</p><p id="6b0c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我希望本教程和示例代码对您有所帮助。<br/>请在下面的评论中分享你的想法或反馈。</p></div></div>    
</body>
</html>