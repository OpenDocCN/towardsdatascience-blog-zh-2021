<html>
<head>
<title>Probabilistic Programming: Generalized Linear Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">概率规划:广义线性模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/probabilistic-programming-generalized-linear-models-b180ac8cfa7e?source=collection_archive---------17-----------------------#2021-09-05">https://towardsdatascience.com/probabilistic-programming-generalized-linear-models-b180ac8cfa7e?source=collection_archive---------17-----------------------#2021-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8f5b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一种替代的、分布优先的数据建模方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b1de22f37653a7fe20977939fa43d10a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*THaJz6Y3hITJ4NBo"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Carlos Muza </a>拍摄的照片</p></figure><h1 id="e08f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">什么是概率编程</strong></h1><p id="762e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">世界存在不确定性。数据科学家的目标是尝试使用过去的数据对世界进行建模，以有效地预测未来。这种策略在许多不同的领域和用例中相对有效。但是，这种不确定性还是存在的。预测未来的结果并理解该模型有多“好”将是有益的。</p><p id="031e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">概率编程已经存在了一段时间，超过十年了。然而，许多人可能以前没有见过、使用过，甚至没有听说过它。那是什么呢？基本上，这是一种根据概率建立模型的方法。然而，它显然不适合那些希望自己的结果是概率性的人。</p><p id="20d0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">概率编程是一种将编程框架与贝叶斯统计建模、推理算法和机器学习元素相结合的范式。此外，它基于贝叶斯推理方法。这与大多数模型遵循的常见频率主义方法形成对比。幸运的是，这个帖子不需要每个推理系统之间的细微差别。</p><h2 id="8926" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">结构</h2><p id="b973" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">概率规划有许多不同的选择。</p><ul class=""><li id="95ff" class="ne nf it lt b lu mn lx mo ma ng me nh mi ni mm nj nk nl nm bi translated">' STAN '在R中用' RStan '和Python中用' PyStan '得到了很好的支持。框架已经建立。</li><li id="635e" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">Pyro是深度概率模型，有PyTorch后端。它由优步工程部开发和维护。</li><li id="65c8" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">“TensorFlow Probability”是用TensorFlow构建的，由谷歌提供支持。</li><li id="e030" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">PyMC3是一个用于概率编程的python API。</li></ul><p id="22ea" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，利用概率规划，线性回归被转换成多个分布的组合。起初，这种改变似乎有些矫枉过正。</p><p id="6fd8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为什么一切都要用概率来表示？</p><p id="043e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，当术语被概率性地定义时，你就有了从统计学角度理解模型的工具。例如，线性回归的原始公式可以写成</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/8a74ca1f97631876bf5c71af184fc6f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*XwWegELE7ZtfzkuQj3-WNA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线性回归</p></figure><p id="3f64" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中Y是我们要预测的产量，X是我们的独立数据；系数用β定义，误差项用ϵ.定义对于标准线性回归，误差项被假定为正态分布。</p><p id="44a2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用概率方法，模型用概率分布来表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/68a6d85ccb8d42cb1e5ac222f24d9027.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*xoYWDzLonLmBRcn7lsXxjQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">概率线性回归</p></figure><p id="38e4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这意味着假设数据遵循正态分布。因此，模型的输出是具有分布σ方差的线性模型的平均值。</p><p id="b62a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在线性回归的第二个公式中，术语被定义为概率。这个公式意味着权重被表示为分布，并且您可以测量β的不同值的可能性。因此，例如，当数据较少时，这些权重更不确定。但值得注意的是，这种不确定性在模型中得到了体现。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="be9a" class="kz la it bd lb lc ob le lf lg oc li lj jz od ka ll kc oe kd ln kf of kg lp lq bi translated"><strong class="ak">广义线性模型</strong></h1><p id="4752" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">线性回归是几个变量和权重的总和，后跟一个误差项。假设该误差项来自高斯分布。</p><p id="a113" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，正如您可能已经考虑到的，误差项不需要遵循高斯分布。</p><p id="4c6b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在广义线性模型中，分布不必是高斯分布。此外，虽然这些模型中的项总是线性相加的，但是非线性函数也可以应用于线性项。这两个原因导致了“广义”线性模型的出现。</p><h2 id="0ea1" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">制定</h2><p id="f99a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当结果不是线性时，这些性质是有益的。例如，逻辑回归是一个线性模型。然而，对于逻辑回归，线性项通过逻辑函数传递。该模型还假设伯努利分布来产生最终的二元结果。</p><p id="781c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">GLMs的配方反映了这些特性:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/202d0a3ef04d0ad7c1cb369a9a0cdfdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V7EoFfYeZQSX6vlPdryW_Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">广义线性模型公式(作者照片)</p></figure><p id="b6a4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个公式中，g被认为是一个可以是非线性的“连接”函数。E项代表来自指数分布族的分布。这最后一个短语是为了确保公式是通用的。指数族由许多由一组参数定义的不同分布组成。例如，正态分布在指数族中。</p><p id="f7b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如您可能已经确定的那样，广义线性模型涉及到对底层数据分布的良好理解，非常适合概率编程。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="fd3c" class="kz la it bd lb lc ob le lf lg oc li lj jz od ka ll kc oe kd ln kf of kg lp lq bi translated"><strong class="ak">Python中的概率编程</strong></h1><p id="b46b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在Python中，一个名为PyMC3的概率编程包允许用户使用各种数值模型来拟合贝叶斯模型。用PyMC3进行概率编程适用于广泛的问题。重要的是，该功能包括汇总输出和模型诊断。</p><p id="8c66" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">PyMC3有许多不同的教程和所有可用功能的演练。这些例子为许多不同的概率定义的模型提供了一些快速的开始。PyMC3包括许多不同的模型、分析和方法，如自回归模型、生存分析、标准化流、马尔可夫链蒙特卡罗抽样、高斯过程和分层线性回归。仅举几个例子。</p><p id="2cab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这篇文章的重点是广义线性模型。</p><h2 id="a9d5" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">实验</h2><p id="5940" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这篇文章中，我将使用波士顿住房数据集。这个数据集由506条记录组成。该数据集旨在使用人均犯罪率、每个城镇的非零售商业用地比例和全价值财产税率等特征来预测房价。</p><p id="956f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要在PyMC3中生成glm，设置相对简单。但是，对于更复杂的模型(即自定义链接功能和交互术语)，结构会更复杂。</p><p id="4a16" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，将数据放入一个字典中，分别用键“x”和“y”表示输入和输出数据。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="3da4" class="ms la it oi b gy om on l oo op">import arviz as az<br/>import matplotlib.pyplot as plt<br/>import pymc3 as pm<br/>from pymc3 import *<br/>import pandas as pd<br/>import numpy as np<br/>from sklearn.datasets import load_boston</span><span id="bc92" class="ms la it oi b gy oq on l oo op">data = load_boston()<br/>df = pd.DataFrame(data.data, columns=data.feature_names)<br/>df['target'] = data.target<br/>X = df.drop(['target'], axis=1)<br/>y = df['target'].astype(float)<br/>data = {'x': X, 'y': y}</span></pre><p id="e247" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，使用PyMC3，每个模型规范都被包装在一个“with”语句中。然后指定GLM模型，并传入数据。此步骤确保所有参数都添加到模型中。最后，通过获取许多后验样本来产生模型。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="4455" class="ms la it oi b gy om on l oo op">with Model() as model:<br/>    glm.GLM.from_formula("y ~ x", data)<br/>    trace = sample(3000, cores=2)  # draw 3000 posterior samples </span></pre><h2 id="0da6" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated"><strong class="ak">模型分析</strong></h2><p id="0e9b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">模型生成后，我们就可以分析模型了。首先，用分布对参数建模，为我们提供可能参数的完整后验分布。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="c75d" class="ms la it oi b gy om on l oo op">plt.figure(figsize=(7, 7))<br/>traceplot(trace)<br/>plt.tight_layout();</span></pre><p id="89b1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">仅显示了波士顿住房数据集中的前三个要素以及截距。</p><ol class=""><li id="5914" class="ne nf it lt b lu mn lx mo ma ng me nh mi ni mm or nk nl nm bi translated">CRIM——城镇人均犯罪率</li><li id="9b6b" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm or nk nl nm bi translated">ZN——面积超过25，000平方英尺的住宅用地比例。制成</li><li id="89e0" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm or nk nl nm bi translated">印度河——每个城镇非零售商业用地的比例。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/9a0fa6a06dfc32f32130a56b59dec112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JZZfKchICfwDDFI8y4Gwg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自波士顿住房数据集的CRIM、ZN、INDUS和CHAS的边缘后部</p></figure><p id="04d6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">左侧显示了我们的边际后验概率——对于x轴上的每个参数值，我们在y轴上得到一个概率，它告诉我们该参数值的可能性有多大。</p><p id="cea2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里有一些需要注意的地方。单个参数的采样链(左侧)似乎很好地收敛且稳定。似乎没有任何大的漂移或其他异常现象。</p><h1 id="e2d7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">结论</strong></h1><p id="37c0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">概率编程是数据科学中令人兴奋的领域。</p><p id="af59" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当使用大型复杂模型时，可解释性和简单性可能会丧失。虽然线性回归肯定有其局限性，但广义线性模型提供了一种替代方法。</p><p id="47d1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当对这些模型使用概率规划时，可以有效地测量模型周围的不确定性。这一特性导致模型以可解释的线性方式进行预测，并提供关于模型本身的不确定性的度量。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="9945" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ot">如果你有兴趣阅读关于新颖的数据科学工具和理解机器学习算法的文章，可以考虑在Medium上关注我。</em></p><p id="4f22" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你对我的写作感兴趣，并想直接支持我，请通过以下链接订阅。这个链接确保我会收到你的会员费的一部分。</p><div class="ou ov gp gr ow ox"><a href="https://zjwarnes.medium.com/membership" rel="noopener follow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd iu gy z fp pc fr fs pd fu fw is bi translated">通过我的推荐链接加入Medium-Zachary Warnes</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">阅读扎卡里·沃恩斯(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">zjwarnes.medium.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl ks ox"/></div></div></a></div></div></div>    
</body>
</html>