<html>
<head>
<title>4 Easy Steps for Implementing CatBoost</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实施CatBoost的4个简单步骤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-easy-steps-for-implementing-catboost-c196fd82274b?source=collection_archive---------14-----------------------#2021-03-20">https://towardsdatascience.com/4-easy-steps-for-implementing-catboost-c196fd82274b?source=collection_archive---------14-----------------------#2021-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="792f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何应用新兴数据科学算法的端到端教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c43f8a349975cd8e719321efb4b8eb1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oRmOhY_vIxYlxeAfmOYU_w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/cat?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>【1】上由<a class="ae ky" href="https://unsplash.com/@madhatterzone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Manja Vitolic </a>拍摄的照片。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="a574" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">目录</h1><ol class=""><li id="d98d" class="ly lz it ma b mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">介绍</li><li id="4990" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">安装和导入</li><li id="7822" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">定义数据集</li><li id="fc26" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">应用模型</li><li id="de16" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">预测</li><li id="2d97" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">摘要</li><li id="1efb" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">参考</li></ol><h1 id="1642" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">介绍</h1><p id="23c7" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated"><a class="ae ky" href="https://catboost.ai/" rel="noopener ugc nofollow" target="_blank">CatBoost</a>【2】在以logloss为误差度量的基准数据集上击败了许多其他流行的机器学习算法。它主要击败了LightGBM和XGBoost，这两个工具最近不仅成为了数据科学竞赛的标准，也成为了专业设置的标准。现在是学习这个强大的库的时候了，下面是你如何通过四个简单的步骤来实现它。</p><h1 id="545b" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">安装和进口</h1><p id="f331" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">本教程将使用流行的数据科学工具，如Python和Jupyter Notebook。首先，我们将从三个简单的安装命令开始，然后转移到您的第一个基本CatBoost回归模型所需的所有必要导入，正如您将看到的，这可能是您的第一个也是最后一个，因为这就是CatBoost在没有太多调整或额外代码的情况下是多么令人印象深刻。</p><blockquote class="nn no np"><p id="c7c0" class="na nb nq ma b mb nr ju nc md ns jx nd nt nu nf ng nv nw ni nj nx ny nl nm ml im bi translated">以下是主要的安装命令:</p></blockquote><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="fc09" class="oe lh it oa b gy of og l oh oi">!pip install catboost</span><span id="4e36" class="oe lh it oa b gy oj og l oh oi">!pip install ipywidgets</span><span id="1ab2" class="oe lh it oa b gy oj og l oh oi">!jupyter nbextension enable  — py widgetsnbextension</span></pre><blockquote class="nn no np"><p id="df85" class="na nb nq ma b mb nr ju nc md ns jx nd nt nu nf ng nv nw ni nj nx ny nl nm ml im bi translated">以下是主要的导入命令:</p></blockquote><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="c108" class="oe lh it oa b gy of og l oh oi">from catboost import <!-- -->CatBoostRegressor</span><span id="d572" class="oe lh it oa b gy oj og l oh oi">from sklearn.model_selection import train_test_split</span><span id="ee5f" class="oe lh it oa b gy oj og l oh oi">import numpy as np</span><span id="e4ea" class="oe lh it oa b gy oj og l oh oi">import pandas as pd</span></pre><p id="c30e" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">如您所见，安装和导入只需要几行代码。我们还将导入其他常用的库，如numpy、pandas和sklearn。接下来，我们将讨论数据集过程。</p><h1 id="c286" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">定义数据集</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/917e9a2c5696d5ab7a2c78626255d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4TLlisFk7XvtREAsS7C7Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Christopher Gower 在<a class="ae ky" href="https://unsplash.com/s/photos/computer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>【3】上拍摄的照片。</p></figure><p id="044a" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">有几种方法可以导入数据集，但我最常用的方法是用pandas导入CSV文件。你将建立你的x属性和你的y变量，你试图预测的变量。对于训练和测试分割，您可以按照75:25的常见方式隔离数据集。这种随机状态是为了让你在未来或与他人合作时能够复制同样的分裂。</p><blockquote class="nn no np"><p id="865c" class="na nb nq ma b mb nr ju nc md ns jx nd nt nu nf ng nv nw ni nj nx ny nl nm ml im bi translated">以下是定义命令的主要数据集:</p></blockquote><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="907d" class="oe lh it oa b gy of og l oh oi">dataframe = pd.read_csv('file_path_to_your_dataset.csv')</span><span id="b001" class="oe lh it oa b gy oj og l oh oi">X = dataframe[['X_feature_1', 'X_feature_2', etc.,]]</span><span id="8109" class="oe lh it oa b gy oj og l oh oi">y = dataframe['target_variable']</span><span id="73d2" class="oe lh it oa b gy oj og l oh oi">X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.75, random_state=42)</span></pre><h1 id="c565" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">应用模型</h1><p id="0173" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">当应用CatBoost模型时，它的工作方式类似于其他sklearn方法。然而，最重要的部分是指定您的分类变量，这样您就可以从CatBoost模型中获得最大收益。此外，CatBoost有一些很棒的图形，可以可视化迭代过程中的错误度量改进，所以如果您想直观地看到训练集和测试集随着时间的推移是如何比较的，将图形设置为<code class="fe ol om on oa b">True</code>是一个很好的方法。我还为回归模型添加了一个常见的<code class="fe ol om on oa b">loss function</code>和<code class="fe ol om on oa b">RMSE</code>的<code class="fe ol om on oa b">evaluation metric</code>。默认的<code class="fe ol om on oa b">n_estimators</code>是100，这是一个很好的起点，如果你看到模型在最后一轮仍在改进，那么你可以增加迭代的次数。</p><blockquote class="nn no np"><p id="4371" class="na nb nq ma b mb nr ju nc md ns jx nd nt nu nf ng nv nw ni nj nx ny nl nm ml im bi translated">以下是主要的模型命令:</p></blockquote><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="d00f" class="oe lh it oa b gy of og l oh oi">CAT_FEATURES = [] #list of your categorical features</span><span id="d6cd" class="oe lh it oa b gy oj og l oh oi"># set up the model<br/>catboost_model = CatBoostRegressor(n_estimators=100,<br/>                                   loss_function = 'RMSE',<br/>                                   eval_metric = 'RMSE',<br/>                                   cat_features = CAT_FEATURES)</span><span id="39f1" class="oe lh it oa b gy oj og l oh oi"># fit model<br/>catboost_model.fit(X_train, y_trian, <br/>                   eval_set = (X_test, y_test),<br/>                   use_best_model = True,<br/>                   plot = True)</span></pre><h1 id="bc84" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">预测</h1><p id="a032" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">也许最简单也是最有收获的一步是看你的预测。您可以使用predict方法的一些其他有用的方式是，通过将两个索引都设置为<code class="fe ol om on oa b">true</code>的内部连接将原始数据帧与您的预测合并，以便您可以看到导致这些预测的特征。这个命令也遵循大多数数据科学家习惯的典型sklearn方法。</p><blockquote class="nn no np"><p id="4fab" class="na nb nq ma b mb nr ju nc md ns jx nd nt nu nf ng nv nw ni nj nx ny nl nm ml im bi translated">下面是主要的预测命令:</p></blockquote><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="8a76" class="oe lh it oa b gy of og l oh oi"># get your predictions<br/>preds = catboost_model.predict(X_test)</span></pre><h1 id="15aa" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">摘要</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/297411f1a84dbde2c57170ce36c2a39b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Na5TbCa-tT0U1h_8xWk5wA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@krakenimages?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> krakenimages </a>在<a class="ae ky" href="https://unsplash.com/s/photos/success?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>【4】上拍摄。</p></figure><p id="cd81" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">我希望你喜欢这个关于CatBoost的简短教程。这真的是一个强大的机器学习算法和库，任何人都可以实现。它的设计使得参数调整通常是不必要的，默认参数是最好的。此外，还有其他重要的可视化工具可供您使用，它们是由流行的SHAP库制作的。本文的目的是向您介绍CatBoost，接下来您所需要的就是这段代码和您的数据集，以开始进行您的第一次模型预测。</p><blockquote class="nn no np"><p id="59ce" class="na nb nq ma b mb nr ju nc md ns jx nd nt nu nf ng nv nw ni nj nx ny nl nm ml im bi translated">以下是所有步骤的总结:</p></blockquote><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="abd8" class="oe lh it oa b gy of og l oh oi">* Installation and Imports</span><span id="acb9" class="oe lh it oa b gy oj og l oh oi">* Define Dataset</span><span id="9782" class="oe lh it oa b gy oj og l oh oi">* Apply Model</span><span id="6d36" class="oe lh it oa b gy oj og l oh oi">* Predict</span></pre><p id="ff75" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">我希望你觉得我的文章既有趣又有用！如果您以前使用过CatBoost，请在下面随意评论。这对你现在的数据科学事业有帮助吗？你同意还是不同意，为什么？</p><p id="d129" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">请随时查看我的个人资料和其他文章，也可以通过LinkedIn联系我。我与这些提到的公司没有关系。</p><p id="c66d" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">感谢您的阅读！</p><h1 id="f251" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">参考</h1><p id="de1a" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">[1]照片由<a class="ae ky" href="https://unsplash.com/@madhatterzone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Manja Vitolic </a>在<a class="ae ky" href="https://unsplash.com/s/photos/cat?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>(2018)上拍摄</p><p id="92d3" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">[2] Yandex，<a class="ae ky" href="https://catboost.ai/" rel="noopener ugc nofollow" target="_blank"> CatBoost </a>，(2021)</p><p id="31c0" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">[3]Christopher Gower在<a class="ae ky" href="https://unsplash.com/s/photos/computer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片，(2017)</p><p id="7d5b" class="pw-post-body-paragraph na nb it ma b mb nr ju nc md ns jx nd mf nu nf ng mh nw ni nj mj ny nl nm ml im bi translated">[4]照片由<a class="ae ky" href="https://unsplash.com/@krakenimages?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> krakenimages </a>在<a class="ae ky" href="https://unsplash.com/s/photos/success?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>(2020)上拍摄</p></div></div>    
</body>
</html>