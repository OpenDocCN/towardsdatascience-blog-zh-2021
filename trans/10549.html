<html>
<head>
<title>How to Send and Receive Automated Emails Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python发送和接收自动电子邮件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-send-and-receive-automated-emails-using-python-a5c711c7a35c?source=collection_archive---------13-----------------------#2021-10-08">https://towardsdatascience.com/how-to-send-and-receive-automated-emails-using-python-a5c711c7a35c?source=collection_archive---------13-----------------------#2021-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ca32" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用令人眼花缭乱的仪表板创建自动化的电子邮件管道</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c72ca2e2ee855df19b54326010b60a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eAxNqUDtR9EjfFsj"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">斯蒂芬·菲利普斯-Hostreviews.co.uk在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="e77a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="b99e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们的公司和非公司生活中，我们每天都会收发大量的电子邮件。说实话，这些交易中的很大一部分确实可以自动化。也许我们都经历过人生中具有里程碑意义的时刻，那就是我们一天中的大部分时间都在给许多人发送差不多相同的电子邮件。嗯，不一定非要那样。使用Python，您实际上可以设置和部署一个自动化的电子邮件管道来接收电子邮件，然后根据前者的内容发送电子邮件。换句话说，当你在工作或家里处理更有影响力的任务时，你可以让自动化发挥作用。</p><p id="51d0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">完全没有必要精通技术，我们要做的事情很简单，我们每个人都可以在短时间内完成。在本教程之后，您将学习如何自动接收电子邮件，使用内容和附件生成图表，然后最终向许多收件人发送带有令人眼花缭乱的仪表板的电子邮件。</p><p id="901b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">具体来说，在本教程中，我们将自动执行以下操作:</p><ul class=""><li id="a8b6" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">接收电子邮件</li><li id="884b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">解析电子邮件内容和附件</li><li id="bd81" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">生成数据可视化</li><li id="58aa" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">向多个收件人发送电子邮件</li></ul></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="fbf5" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">接收电子邮件</h1><p id="d5e0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">虽然本教程中使用的技术可以应用于任何使用标准IMAP协议的电子邮件服务器，但一些服务器(如Gmail)的使用可能会有所不同。如果您确实在使用Gmail，请确保您在Google帐户中启用了不太安全的应用程序选项，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2b92dc7cf3e7ad20e72be5bbc8daf410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*AWVGAr-Cer2iwjwbyutAPg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gmail不太安全的应用程序授权-作者图片。</p></figure><p id="267c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">继续启动Anaconda或您选择的任何其他Python IDE，并运行下面的代码片段来连接到您的电子邮件帐户并下载您收件箱中的所有内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="2d67" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，请注意，存储您的用户凭证的更安全的方法是将它们保存在一个<a class="ae ky" href="https://medium.com/@t.rosen2101/how-to-create-a-gitignore-file-to-hide-your-api-keys-95b3e6692e41" rel="noopener">配置文件</a>中，然后在您的代码中将它们作为参数调用。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="2f45" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">解析电子邮件内容和附件</h1><p id="2e76" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在让我们假设您正在等待一封带有Microsoft Excel附件的电子邮件，其中包含许多学生的考试结果。您的目标是使用“考试结果”主题自动搜索该电子邮件。一旦找到它，您将需要提取文件并保存到您的本地目录。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="77bf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，如果您想要搜索特定的发件人而不是电子邮件主题，请将上面代码片段的第7行替换为以下内容:</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="9862" class="oa la it nw b gy ob oc l od oe">if 'sender_email@gmail.com' in email_content['From']:</span></pre></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="b64d" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">生成数据可视化</h1><p id="a411" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在您已经下载了电子邮件附件，您将希望根据附件的内容生成文本和图表。因为在我们的例子中，文件是一个Excel电子表格，我们将使用Pandas将其转换成一个数据框。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/914cd2068ca138fe91b87df3251ba014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*1uPep73UWP5gHPclLZo6Gw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">电子邮件附件数据框-作者图片。</p></figure><p id="b182" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们现在的目标是找到每次考试的班级平均分，然后创建一个图表，单独显示每个学生的分数。为此，我们将使用如下所示的Plotly来生成包含考试结果的自定义折线图、条形图和直方图。在继续下一步之前，请确保您可以通过在Anaconda提示符下键入以下命令，使用‘python-kaleido’库将图表保存为图像:</p><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="8838" class="oa la it nw b gy ob oc l od oe">conda install -c plotly python-kaleido</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="b604" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上面的片段将为每个学生创建以下三个图表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/a1a85fd81160a622792a2acb8a676b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwYqJMtDQ681PV-Dp__j-Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">考试成绩图表-作者图片。</p></figure></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="672e" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">向多个收件人发送电子邮件</h1><p id="9439" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们已经生成了定制的图表，下一步是将相应的图表和考试结果发送给每个学生。下面的代码片段是前面代码片段中for循环的延续。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="daa1" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">结果</h1><p id="2eda" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这就是你自己的电子邮件仪表板，通过自动化管道毫不费力地发送给许多收件人。这只是这种方法的扩展功能的一个小演示，实际上您可以通过发送更丰富的内容来扩展它，包括但不限于文本、图像、音频和其他HTML内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/20ed05b5c591a57a80f6241cba7a9af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TCHBoorXEGfEzBtul1_C7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">电子邮件仪表板—按作者分类的图像。</p></figure><p id="8887" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您想了解更多关于数据可视化和Python的知识，请随时查看以下(附属链接)课程:</p><h2 id="70da" class="oa la it bd lb oi oj dn lf ok ol dp lj ma om on ll me oo op ln mi oq or lp os bi translated">使用Streamlit开发Web应用程序:</h2><div class="ot ou gp gr ov ow"><a href="https://www.amazon.com/Web-Application-Development-Streamlit-Applications/dp/1484281101?&amp;linkCode=ll1&amp;tag=mkhorasani09-20&amp;linkId=a0cb2bc17df598006fd9029c58792a6b&amp;language=en_US&amp;ref_=as_li_ss_tl" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">使用Streamlit开发Web应用程序:开发和部署安全且可伸缩的Web应用程序…</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">使用Streamlit开发Web应用程序:使用……开发安全且可扩展的Web应用程序并将其部署到云中</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">www.amazon.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk ks ow"/></div></div></a></div><h2 id="7177" class="oa la it bd lb oi oj dn lf ok ol dp lj ma om on ll me oo op ln mi oq or lp os bi translated">使用Python实现数据可视化:</h2><div class="ot ou gp gr ov ow"><a href="https://www.coursera.org/learn/python-for-data-visualization?irclickid=xgMQ4KWb%3AxyIWO7Uo7Vva0OcUkGQgW2aEwvr1c0&amp;irgwc=1&amp;utm_medium=partners&amp;utm_source=impact&amp;utm_campaign=3308031&amp;utm_content=b2c" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">用Python实现数据可视化</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">“一图胜千言”。我们都熟悉这个表达。它尤其适用于试图…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">www.coursera.org</p></div></div><div class="pf l"><div class="pl l ph pi pj pf pk ks ow"/></div></div></a></div><h2 id="ac9e" class="oa la it bd lb oi oj dn lf ok ol dp lj ma om on ll me oo op ln mi oq or lp os bi translated">面向所有人的Python专业化:</h2><div class="ot ou gp gr ov ow"><a href="https://www.coursera.org/specializations/python?irclickid=xgMQ4KWb%3AxyIWO7Uo7Vva0OcUkGQgW16Ewvr1c0&amp;irgwc=1&amp;utm_medium=partners&amp;utm_source=impact&amp;utm_campaign=3308031&amp;utm_content=b2c" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">面向所有人的Python</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">学习用Python编程和分析数据。开发收集、清理、分析和可视化数据的程序…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">www.coursera.org</p></div></div><div class="pf l"><div class="pm l ph pi pj pf pk ks ow"/></div></div></a></div><h2 id="a899" class="oa la it bd lb oi oj dn lf ok ol dp lj ma om on ll me oo op ln mi oq or lp os bi translated">GitHub资源库:</h2><div class="ot ou gp gr ov ow"><a href="https://github.com/mkhorasani/python_automated_email" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">mkhorasani/python _ automated _ email</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">使用令人眼花缭乱的仪表板创建自动化的电子邮件管道</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">github.com</p></div></div><div class="pf l"><div class="pn l ph pi pj pf pk ks ow"/></div></div></a></div></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="c1e6" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">☕喜欢这个教程？这里<a class="ae ky" href="https://www.paypal.com/paypalme/dummylearn" rel="noopener ugc nofollow" target="_blank">有空给我捐一杯咖啡</a>。</h1><h1 id="7769" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">新到中？您可以在此订阅并解锁无限文章<a class="ae ky" href="https://khorasani.medium.com/membership" rel="noopener">。</a></h1></div></div>    
</body>
</html>