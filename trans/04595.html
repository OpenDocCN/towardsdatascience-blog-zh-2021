<html>
<head>
<title>The simplest way to train a Neural Network in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python训练神经网络的最简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-simplest-way-to-train-a-neural-network-in-python-17613fa97958?source=collection_archive---------15-----------------------#2021-04-20">https://towardsdatascience.com/the-simplest-way-to-train-a-neural-network-in-python-17613fa97958?source=collection_archive---------15-----------------------#2021-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="840a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">PyTorch和TensorFlow并不是Python中唯一的深度学习框架。还有另一个类似于scikit-learn的库。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ef3da9fa4683630e2d86c407b02dacd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-m7il6SD9_JNSbdJ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@urielsc26?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乌列尔SC </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="568c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说到Python中的经典机器学习算法，scikit-learn是我的首选。它有许多算法，支持稀疏数据集，速度快，有许多实用功能，如交叉验证，网格搜索等。</p><p id="031d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谈到高级建模，scikit-learn多次失败。如果你需要助推，神经网络或t-SNE，<strong class="lb iu"> </strong>最好避免scikit-learn。</p><p id="e66f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">scikit-learn有两个基本的神经网络实现。有用于分类的MLPClassifier和用于回归的MLPRegressor。</p><p id="8274" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然MLPClassifier和MLPRegressor有一组丰富的参数，但没有自定义神经网络层的选项(除了设置每层的隐藏单元数)，也没有GPU支持。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/5cc9d19a820393ec4cb21c6b67242e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*woCTAcvWEmW7VPVpPBW0VQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">sklearn中一个<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier" rel="noopener ugc nofollow" target="_blank">多层感知器</a>的一组丰富的论据(图片由作者制作)。</p></figure><h1 id="fa86" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">认识scikit-neuralnetwork</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gif来自<a class="ae ky" href="https://giphy.com/gifs/kitp-YknAouVrcbkiDvWUOR" rel="noopener ugc nofollow" target="_blank"> giphy </a></p></figure><p id="d7d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">scikit-neuralnetwork解决了上面提到的scikit-learn的问题。虽然已经有像PyTorch或Tensorflow这样的优秀库，但对于那些来自scikit-learn生态系统的人来说，scikit-neuralnetwork可能是一个不错的选择。</p><blockquote class="mq mr ms"><p id="531f" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">来自scikit-neuralnetwork的开发者:</p><p id="65ab" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">scikit-neuralnetwork是一个没有学习悬崖的深度神经网络实现！该库实现了多层感知器，作为强大的pylearn2库的包装器，该库与scikit-learn兼容，具有更加用户友好的Pythonic界面。</p></blockquote><h2 id="07c8" class="mx lx it bd ly my mz dn mc na nb dp mg li nc nd mi lm ne nf mk lq ng nh mm ni bi translated">安装scikit-neuralnetwork</h2><p id="2864" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">安装scikit-neuralnetwork (sknn)与安装任何其他Python包一样简单:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="e8a5" class="mx lx it np b gy nt nu l nv nw">pip install scikit-neuralnetwork</span></pre><h2 id="d139" class="mx lx it bd ly my mz dn mc na nb dp mg li nc nd mi lm ne nf mk lq ng nh mm ni bi translated">定制神经网络</h2><p id="7678" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">让我们从Iris数据集定义X_train和y_train来运行下面的示例:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="341c" class="mx lx it np b gy nt nu l nv nw">from sklearn.datasets import load_iris</span><span id="dc95" class="mx lx it np b gy nx nu l nv nw">data = load_iris()<br/>X_train = data['data']<br/>y_train = data["target"]</span></pre><p id="6b2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sknn提供了一种制作定制神经网络的简单方法。scikit-learn用户对熟悉的API会有宾至如归的感觉:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="6f3d" class="mx lx it np b gy nt nu l nv nw">from sknn.mlp import Classifier, Layer</span><span id="c7e4" class="mx lx it np b gy nx nu l nv nw">nn = Classifier(<br/>    layers=[<br/>        Layer("Maxout", units=100, pieces=2),<br/>        Layer("Softmax")],<br/>    learning_rate=0.001,<br/>    n_iter=25)<br/>nn.fit(X_train, y_train)</span></pre><p id="a932" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">X_train，y_train变量是numpy数组，所以你可以直接用sknn的神经网络代替你的scikit-learn模型。它甚至支持稀疏数据集。</p><h2 id="fdca" class="mx lx it bd ly my mz dn mc na nb dp mg li nc nd mi lm ne nf mk lq ng nh mm ni bi translated">卷积神经网络</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gif来自<a class="ae ky" href="https://giphy.com/gifs/blog-daniel-keypoints-i4NjAwytgIRDW" rel="noopener ugc nofollow" target="_blank"> giphy </a></p></figure><p id="6fbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sknn支持卷积神经网络。最后，你将能够在scikit-learn生态系统中的<a class="ae ky" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST </a>上获得最高水平的分数。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="e196" class="mx lx it np b gy nt nu l nv nw">from sknn.mlp import Classifier, Convolution, Layer</span><span id="aaa3" class="mx lx it np b gy nx nu l nv nw">nn = Classifier(<br/>    layers=[<br/>        Convolution("Rectifier", channels=8, kernel_shape=(3,3)),<br/>        Layer("Softmax")],<br/>    learning_rate=0.02,<br/>    n_iter=5)<br/>nn.fit(X_train, y_train)</span></pre><h2 id="81af" class="mx lx it bd ly my mz dn mc na nb dp mg li nc nd mi lm ne nf mk lq ng nh mm ni bi translated">递归神经网络</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/84884c73957bec60eed4512f4ffae7f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2sjOURfeAZBNNJZ5"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@bethewerewolf?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安德烈斯·坎钦</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="c8da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">RNNs呢，比如长短期记忆(LTSM)或者门控循环单元(GRU)？rnn通常用于建模序列，如时间序列或文本数据。</p><p id="02db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过阅读文档，似乎没有对RNNs的直接支持。它支持本地和定制层，这使得RNN的实现成为可能。</p><blockquote class="mq mr ms"><p id="2230" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">来自文档:</p><p id="14f6" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">你可以使用这个特性来实现循环层，比如LSTM或者GRU，以及任何其他不被直接支持的特性。请记住，这可能会影响未来版本的兼容性，也可能会暴露代码中的边缘情况(例如，序列化、确定性)。</p></blockquote><p id="f263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你打算和RNNs一起工作，我建议你学习PyTorch或者TensorFlow。如果你需要一个快速入门指南，我不久前写了一篇关于它的文章:</p><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/lstm-for-time-series-prediction-de8aeb26f2ca"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">时间序列预测的LSTM</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">用PyTorch训练长短期记忆神经网络并预测比特币交易数据</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq ks oc"/></div></div></a></div><h2 id="bf8f" class="mx lx it bd ly my mz dn mc na nb dp mg li nc nd mi lm ne nf mk lq ng nh mm ni bi translated">管道</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/726e55d811973a29762c420c6c930e2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TY8zG2Ic5EegNorf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@quinten149?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">昆腾·德格拉夫</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="f4c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">scikit-learn有管道，它将特征转换和建模打包到一个管道中。</p><p id="c84d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">管道减少了过度拟合的机会，并且通常减少了各种错误的机会。在进行交叉验证或网格搜索时，它们也非常有用。</p><p id="b6fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">许多机器学习库不支持scikit-learn管道，所以我们需要自己实现它。scikit-neuralnetwork的伟大之处在于它完全支持scikit-learn管道。</p><p id="69f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个管道示例，用于缩放特征和训练简单的神经网络。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="d8c3" class="mx lx it np b gy nt nu l nv nw">from sknn.mlp import Classifier, Layer</span><span id="bf32" class="mx lx it np b gy nx nu l nv nw">from sklearn.pipeline import Pipeline<br/>from sklearn.preprocessing import MinMaxScaler</span><span id="9188" class="mx lx it np b gy nx nu l nv nw">pipeline = Pipeline([<br/>        ('min/max scaler', MinMaxScaler(feature_range=(0.0, 1.0))),<br/>        ('neural network', Classifier(layers=[Layer("Softmax")], n_iter=25))])<br/>pipeline.fit(X_train, y_train)</span></pre><p id="9bbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看流失预测文章，了解管道的高级用法。我展示了如何分别处理分类特征和数字特征:</p><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/churn-prediction-770d6cb582a5"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">流失预测</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">了解如何为流失预测训练决策树模型。</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="os l on oo op ol oq ks oc"/></div></div></a></div><h2 id="372a" class="mx lx it bd ly my mz dn mc na nb dp mg li nc nd mi lm ne nf mk lq ng nh mm ni bi translated">GPU支持</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot mp l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gif来自<a class="ae ky" href="https://giphy.com/gifs/zotac-LO8XMhCkXYuSLu6LqX" rel="noopener ugc nofollow" target="_blank"> giphy </a></p></figure><p id="ccce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与scikit-learn不同，scikit-neuralnetwork支持GPU，因为它基于<a class="ae ky" href="https://lasagne.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">千层面</a>库。注意，GPU支持需要支持CUDA的NVIDIA GPU。如果你有一台MacBook，你很可能有一个不支持CUDA的镭龙GPU。</p><blockquote class="mq mr ms"><p id="304b" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">来自千层面文档:</p><p id="96ad" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">感谢Theano，Lasagne透明地支持在GPU上训练你的网络，这可能比在CPU上训练它们快10到50倍。目前，这需要一个支持CUDA的NVIDIA GPU，以及一些额外的软件供Theano使用。</p></blockquote><p id="7452" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用GPU后端，您只需导入:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="66f9" class="mx lx it np b gy nt nu l nv nw"># Use the GPU in 32-bit mode, falling back otherwise.</span><span id="9986" class="mx lx it np b gy nx nu l nv nw">from sknn.platform import gpu32</span></pre><blockquote class="mq mr ms"><p id="49bc" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">来自文档:</p><p id="b499" class="kz la mt lb b lc ld ju le lf lg jx lh mu lj lk ll mv ln lo lp mw lr ls lt lu im bi translated">警告:由于库的设计方式，这只有在你的程序还没有导入<code class="fe ou ov ow np b"><em class="it">theano</em></code>模块时才有效。如果在命令行上设置了<code class="fe ou ov ow np b"><em class="it">THEANO_FLAGS</em></code>，它们不会被覆盖。</p></blockquote><h1 id="5a04" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/2eb9c6f98bb3511c0f4f0273994e25ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wrV4aGZX3ez53zj4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@feeedderico?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">费德里科·朗塞洛蒂</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="5a90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你精通sklearn库，那么scikit-neuralnetwork可能是熟悉深度学习的一个很好的起点。</p><p id="9273" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们需要一个神经网络来替代sklearn算法时，scikit-neuralnetwork也很有用。</p><p id="aa83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你刚刚开始深度学习，或者你打算长期从事这个领域，我建议你学习PyTorch。</p><h1 id="ab39" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">在你走之前</h1><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="cd70" class="mx lx it np b gy nt nu l nv nw">- <a class="ae ky" href="https://gumroad.com/l/mjyDQ" rel="noopener ugc nofollow" target="_blank">Deploy Your 1st Machine Learning Model in the Cloud</a> [Ebook]</span><span id="e9d6" class="mx lx it np b gy nx nu l nv nw">- <a class="ae ky" href="https://dataanalysis.substack.com/p/how-to-create-date-series-in-sql" rel="noopener ugc nofollow" target="_blank">How To Create Date Series in SQL</a> [Article]</span><span id="c969" class="mx lx it np b gy nx nu l nv nw">- <a class="ae ky" href="https://aigents.co/skills" rel="noopener ugc nofollow" target="_blank">Free skill tests for Data Scientists &amp; Machine Learning Engineers</a></span><span id="854c" class="mx lx it np b gy nx nu l nv nw">- <a class="ae ky" href="https://imp.i115008.net/c/2402645/895504/11298" rel="noopener ugc nofollow" target="_blank">Become a Cloud Developer using Microsoft Azure [Course]</a></span><span id="b99c" class="mx lx it np b gy nx nu l nv nw">- <a class="ae ky" href="https://imp.i115008.net/c/2402645/828410/11298" rel="noopener ugc nofollow" target="_blank">Master SQL, the core language for Big Data analysis [Course]</a></span></pre><p id="3897" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mt">上面的一些链接是附属链接，如果你通过它们进行购买，我会赚取佣金。请记住，我链接课程是因为它们的质量，而不是因为我从你的购买中获得的佣金。</em></p><p id="dea3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://twitter.com/romanorac" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，在那里我定期<a class="ae ky" href="https://twitter.com/romanorac/status/1328952374447267843" rel="noopener ugc nofollow" target="_blank">发布关于数据科学和机器学习的</a>消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/b5d426b68cc5a21b1a35d0a157ebc4f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*69rP1pwjJi9mLSFE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@cmhedger?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Courtney hedge</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure></div></div>    
</body>
</html>