<html>
<head>
<title>How To Delete Rows From Pandas DataFrames Based on Column Values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何根据列值从Pandas数据帧中删除行</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/delete-row-from-pandas-dataframes-based-on-column-value-4b18bb1eb602?source=collection_archive---------8-----------------------#2021-09-18">https://towardsdatascience.com/delete-row-from-pandas-dataframes-based-on-column-value-4b18bb1eb602?source=collection_archive---------8-----------------------#2021-09-18</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="cadc" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">讨论如何根据列值从pandas数据帧中删除特定的行</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/fe5cdb4591014ca1b8418533d0b9df8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RhWYVMhPITizjEZnmaTfmA.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@melocokr?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Sam Pak </a>在<a class="ae kz" href="https://unsplash.com/s/photos/delete?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="4a22" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="9997" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">根据与列值相关的特定条件从pandas数据帧中删除行是最常执行的任务之一。在今天的简短指南中，我们将探讨如何在以下情况下执行行删除</p><ul class=""><li id="8140" class="mp mq iu ly b lz mr mc ms lj mt ln mu lr mv mo mw mx my mz bi translated">一行包含(即等于)特定的列值</li><li id="9c4f" class="mp mq iu ly b lz na mc nb lj nc ln nd lr ne mo mw mx my mz bi translated">行的特定列值不等于另一个值</li><li id="9b16" class="mp mq iu ly b lz na mc nb lj nc ln nd lr ne mo mw mx my mz bi translated">行的特定列中有空值</li><li id="2983" class="mp mq iu ly b lz na mc nb lj nc ln nd lr ne mo mw mx my mz bi translated">行具有非空的列值</li><li id="c84e" class="mp mq iu ly b lz na mc nb lj nc ln nd lr ne mo mw mx my mz bi translated">需要满足多个条件(以上条件的组合)</li></ul></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><p id="394b" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">首先，让我们创建一个示例数据帧，我们将在本文中引用它，以演示一些概念，帮助我们理解如何从pandas数据帧中删除行。</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="15e1" class="la lb iu nq b gz nu nv l nw nx">import pandas as pd</span><span id="1f4b" class="la lb iu nq b gz ny nv l nw nx">df = pd.DataFrame({<br/>    'colA': [1, 2, 3, 4, None],<br/>    'colB': [True, True, False, False, True],<br/>    'colC': ['a', None, 'c', None, 'e'],<br/>    'colD': [0.1, None, None, None, 0.5],<br/>})</span><span id="ce44" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA   colB  colC  colD<br/>0   1.0   True     a   0.1<br/>1   2.0   True  None   NaN<br/>2   3.0  False     c   NaN<br/>3   4.0  False  None   NaN<br/>4   NaN   True     e   0.5</em></span></pre></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><h2 id="0dea" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">删除包含特定列值的行</h2><p id="a555" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">如果希望删除基于特定列的值的行，可以通过对原始数据帧进行切片来实现。例如，为了删除所有<code class="fe oa ob oc nq b">colA</code>等于<code class="fe oa ob oc nq b">1.0</code>的行，可以如下所示:</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="496d" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df.drop(df.index[df['colA'] == 1.0])</strong></span><span id="cced" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA   colB  colC  colD<br/>1   2.0   True  None   NaN<br/>2   3.0  False     c   NaN<br/>3   4.0  False  None   NaN<br/>4   NaN   True     e   0.5</em></span></pre><p id="b94e" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">另一种方法是颠倒条件，这样就可以保留所有<code class="fe oa ob oc nq b">colA</code>不等于<code class="fe oa ob oc nq b">1.0</code>的行。举个例子，</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="e803" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df[df.colA != 1.0]</strong></span></pre></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><p id="25c2" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">或者，如果您想删除某列值与数字列表中出现的任何其他值相等的行，那么您可以使用<code class="fe oa ob oc nq b"><strong class="ly iv">isin()</strong></code>方法。例如，为了删除列值为<code class="fe oa ob oc nq b">1.0</code>、<code class="fe oa ob oc nq b">2.0</code>或<code class="fe oa ob oc nq b">3.0</code>的所有行，下面的方法可以实现:</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="78e0" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df.drop(df.index[df['colA'].isin([1.0, 2.0, 3.0])])</strong></span><span id="afd3" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA   colB  colC  colD<br/>3   4.0  False  None   NaN<br/>4   NaN   True     e   0.5</em></span></pre><p id="a392" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">同样，您可以恢复条件，以便只保留不满足条件的记录。举个例子，</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="03e7" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df[~df.colA.isin([1.0, 2.0, 3.0])]</strong></span></pre><p id="2334" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">这相当于前面的表达式。</p></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><h2 id="21f4" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">删除列值不等于另一个值的行</h2><p id="f919" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">同样，您可以简单地删除列值不等于特定值的行。例如，下面的表达式将删除所有不等于<code class="fe oa ob oc nq b">1.0</code>的记录:</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="1113" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df.drop(df.index[df['colA']!=1.0])</strong></span><span id="1479" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA  colB colC  colD<br/>0   1.0  True    a   0.1</em></span></pre></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><h2 id="d543" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">删除特定列中具有空值的行</h2><p id="3997" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在，如果您想删除特定列中具有空值的行，您可以使用<code class="fe oa ob oc nq b">isnull()</code>方法。例如，为了删除列<code class="fe oa ob oc nq b">colC</code>中所有空值的行，您可以执行以下操作:</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="9378" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df.drop(df.index[df['colC'].isnull()])</strong></span><span id="6bf6" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA   colB colC  colD<br/>0   1.0   True    a   0.1<br/>2   3.0  False    c   NaN<br/>4   NaN   True    e   0.5</em></span></pre><p id="1b54" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">或者，您可以反转条件并保留所有非空值:</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="8d06" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df[df.colC.notnull()]</strong></span><span id="5281" class="la lb iu nq b gz ny nv l nw nx">print(df)<strong class="nq iv"><br/></strong><em class="nz">   colA   colB colC  colD<br/>0   1.0   True    a   0.1<br/>2   3.0  False    c   NaN<br/>4   NaN   True    e   0.5</em></span></pre></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><h2 id="2433" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">删除特定列中具有非空值的行</h2><p id="359e" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">另一方面，如果希望删除特定列中具有非空值的行，可以使用<code class="fe oa ob oc nq b">notnull()</code>方法。例如，要删除列<code class="fe oa ob oc nq b">colC</code>中所有非空值的行，您需要运行</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="4d4d" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df.drop(df.index[df['colC'].notnull()])</strong></span><span id="b19e" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA   colB  colC  colD<br/>1   2.0   True  None   NaN<br/>3   4.0  False  None   NaN</em></span></pre><p id="049c" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">同样，您可以通过使用如下所示的<code class="fe oa ob oc nq b">isnull</code>方法反转条件，只保留空值:</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="6430" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df[df.colC.isnull()]</strong></span></pre></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><h2 id="7999" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">通过组合多个条件删除行</h2><p id="5052" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在让我们假设您想要通过组合多个条件来删除行。例如，假设您想要删除所有<code class="fe oa ob oc nq b">colC</code>和<code class="fe oa ob oc nq b">colD</code>都为空的行。您可以使用如下所示的<code class="fe oa ob oc nq b">&amp;</code>操作符组合多个表达式。</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="d944" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df.drop(df[df['colC'].isnull() &amp; df['colD'].isnull()].index)</strong></span><span id="4c61" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA   colB colC  colD<br/>0   1.0   True    a   0.1<br/>2   3.0  False    c   NaN<br/>4   NaN   True    e   0.5</em></span></pre><p id="f55e" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated">如果您希望满足其中一个条件，那么您可以使用<code class="fe oa ob oc nq b">|</code>操作符。在这种情况下，所有在<code class="fe oa ob oc nq b">colC</code>或<code class="fe oa ob oc nq b">colD</code>中具有空值的行将从返回的数据帧中删除。</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="0fb3" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">df = df.drop(df[df['colC'].isnull() | df['colD'].isnull()].index)</strong></span><span id="5fc3" class="la lb iu nq b gz ny nv l nw nx">print(df)<br/><em class="nz">   colA  colB colC  colD<br/>0   1.0  True    a   0.1<br/>4   NaN  True    e   0.5</em></span></pre></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><h2 id="6d51" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="7865" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的指南中，我们探讨了如何根据特定条件从pandas数据帧中删除行。具体来说，我们讨论了当行的特定列值等于(或不等于)其他值时，如何执行行删除。此外，我们讨论了如何删除特定列中包含空值或非空值的行。最后，我们探讨了从数据帧中删除行时如何组合多个条件。</p></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><p id="e21e" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。</strong></p></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mr jv mb mc ms jy me lj nm mg mh ln nn mj mk lr no mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="od oe gq gs of og"><a rel="noopener follow" target="_blank" href="/how-to-select-rows-from-pandas-dataframe-based-on-column-values-d3f5da421e93"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">如何根据列值从Pandas数据框架中选择行</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">探索如何根据pandas数据框架中的条件选择行</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="oq l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu og"><a href="https://medium.com/geekculture/how-to-refine-your-google-search-and-get-better-results-c774cde9901c" rel="noopener follow" target="_blank"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">如何优化你的谷歌搜索并获得更好的结果</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">更智能的谷歌搜索的12个技巧</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">medium.com</p></div></div><div class="op l"><div class="ov l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nf ng hy nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu og"><a rel="noopener follow" target="_blank" href="/dynamic-typing-in-python-307f7c22b24e"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">Python中的动态类型</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">探索Python中对象引用的工作方式</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ow l or os ot op ou kt og"/></div></div></a></div></div></div>    
</body>
</html>