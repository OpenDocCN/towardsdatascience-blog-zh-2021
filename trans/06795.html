<html>
<head>
<title>A Blueprint for Time Series Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测的蓝图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-blueprint-for-time-series-9f865609bfa2?source=collection_archive---------9-----------------------#2021-06-19">https://towardsdatascience.com/a-blueprint-for-time-series-9f865609bfa2?source=collection_archive---------9-----------------------#2021-06-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9c55" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak"> <em class="kf">指数平滑和ARIMA模型的探索</em> </strong></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/0f388750bbb0c281b26cfa20c3be83f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cMLrvsLVKpSNnfzk"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@dandimmock?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹·迪莫克</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ad58" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">正如我在<a class="ae kw" rel="noopener" target="_blank" href="/tableau-your-time-series-forecast-with-tabpy-5c09c151477f">之前的故事</a>中提到的，我讨论了如何“展示”你的预测，让我们开始时间序列预测吧。</p><p id="cda7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们从基础开始。什么是时间序列？</p><p id="fc9d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">时间序列表示的是一段时间内<strong class="kz ir"><em class="lt"/></strong>有序的数据，也就是说，我们在<strong class="kz ir"> <em class="lt">等时间间隔</em> </strong>观察到的数据。为什么<strong class="kz ir"> <em class="lt">顺序</em> </strong>很重要？这是因为我们假设今天发生的事情取决于昨天发生的事情等等。因为时序在这里很重要，所以把一个时间序列事件看作一个随机过程是不正确的。这意味着我们不能从时间序列数据中随机抽样分布。</p><p id="5676" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为什么要使用时间序列而不是回归技术之类的预测模型呢？嗯。</p><p id="9b6b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有时，我们可能没有足够的信息(预测因子)来预测未来(目标)。此外，我们可能无法在可用的预测因子和我们的目标变量之间建立显著的相关性。</p><p id="b26c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">因此，与预测建模不同，在预测建模中，您有预测器来解释您的目标变量，时间序列预测依赖于来自以前时间段的目标变量本身(也称为滞后)来进行预测。</p><blockquote class="lu lv lw"><p id="1ad4" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated">插图:</p><p id="c68c" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated"><strong class="kz ir">预测建模:收入= 1.78 *利润+ 2.5 </strong> <em class="iq"> ( </em>这是一个简单的线性回归方程，根据利润提供的信息预测收入)。假设我们没有利润信息。我们转向时间序列。</p><p id="cc24" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated"><strong class="kz ir">时间序列模型:收入(t+1)= a *收入(t)+a(a-1)*收入(t-1) +..</strong>(在此模型中，收入取决于之前时间段的收入，当我们通过使用平滑参数<strong class="kz ir">‘a’</strong>回到过去时，收入的权重逐渐衰减。)</p></blockquote><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ma"><img src="../Images/f9249bf6abf08caae3e2091906dac3d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X5IYKOyWiHkYDklf"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·温克勒</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8de1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们开始查看我们的数据。我们将点燃我们的Jupyter笔记本。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi md"><img src="../Images/84c5e7feaefdb1d1bec1887373b5d25d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0q8JxRiANM08oax1l89ueQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">我们超市数据集的前5条记录</p></figure><p id="5685" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们快速浏览一下我们的元数据。</p><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="4e0f" class="mj mk iq mf b gy ml mm l mn mo">superstore.info()</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mp"><img src="../Images/c71200232fd5a1a01ad4c059ac3a0dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q727r7wTfMp9IzGsb7jO1A.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">我们将处理时间序列的销售和订单日期</p></figure><p id="1dec" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以安全地使用订单日期和销售额，而不必进行任何缺失值处理。让我们建立我们的时间序列。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/8fe1d325b74dddb8b9365955f3751574.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3z5ISpjOhJcmU2XJjaQN0w.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">我们正在合计每个月的销售额</p></figure><p id="c3b8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">想象的时间到了。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mr mc l"/></div></figure><p id="073b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">python中有许多可视化数据的库，最广泛使用的是matplotlib和seaborn。在这里，我使用了plotly来呈现一个交互式的视觉效果。如果你有兴趣了解更多关于plotly的信息，请点击这里。您可以使用下面的代码:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="e25e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">好吧。让我们更深入地研究时间序列的组成部分。我们将探索样本地块以更好地理解概念。</p><p id="1537" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一个时间序列的主要成分有:<strong class="kz ir"><em class="lt"/></strong><strong class="kz ir"><em class="lt">季节性，周期性</em> </strong>和<strong class="kz ir"> <em class="lt">白噪声(误差)</em> </strong>成分。趋势、季节性和周期性是可以建模的系统成分，误差是随机成分。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ms"><img src="../Images/4c03f1f76351b1eaeaca39e13c83bea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RXc1WZwnRxTP1Ic58getQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">有明显的上升趋势</p></figure><p id="bb1e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="lt">趋势</em> </strong>量化序列的整体向上或向下移动。</p><p id="2ad7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="lt">季节性</em> </strong>量化每年重复的数据中的<strong class="kz ir"> <em class="lt">年内</em> </strong>波动。例如，雨伞的销量在一年中的每个雨季都会上升，冰淇淋的销量在夏季会上升，配送公司在一年中的每个季度都会开出更多的账单；这些很可能每年都会发生。<strong class="kz ir"> <em class="lt">问题</em> </strong>:每年的时间序列会有季节性吗？号码</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mt"><img src="../Images/2583c0f7ca2720fb24d8f94cd6d2f388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6MdV60pF3Py2mXdC_2XolA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">香槟销售的季节性</p></figure><p id="a762" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当数据显示上升和下降不是固定周期<strong class="kz ir"><em class="lt"/></strong>时，存在<strong class="kz ir">循环</strong>模式。因此，它不同于季节性，我们在后者中看到一个固定的模式。此外，一个周期的平均长度比季节长得多，通常跨越数年。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mu"><img src="../Images/acfdfad0d4f88d0981e424c806d82f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NNOrxTGvcvEHh_5iB4a_nQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">大多表现出多年来没有固定模式的周期性行为</p></figure><p id="b3e8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，<strong class="kz ir"> <em class="lt">白噪声</em> </strong>是随机误差分量，假设其具有均值<strong class="kz ir"> <em class="lt"> = 0 </em> </strong>和常数<strong class="kz ir"> </strong>方差<em class="lt"> 𝛔的正态分布。</em></p><p id="24a5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将关注趋势、季节性和白噪声。循环组件建模很复杂(至少就我目前所知)，我们将尝试使用其他三个组件来解释该模型。很多时候，周期成分是用趋势本身来解释的。</p><p id="4f38" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以通过两种方式组合这些组件:</p><p id="39f5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="lt">加法模型</em> </strong> : <em class="lt"> Y(t) =趋势(t) +季节性(t) +误差(t) </em></p><p id="f2cc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="lt">乘法模型</em> </strong> : <em class="lt"> Y(t) =趋势(t) *季节性(t) *误差(t) </em></p><p id="7378" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">加性模型将假设随时间推移或多或少的恒定季节性。另一方面，随着时间的推移，乘法模型将会看到季节性以及趋势的显著变化。乘法模型更真实。然而，为了使用乘法模型，我们将对数据进行对数转换，使其成为加法模型，然后我们可以轻松提取趋势和季节性成分。如果你熟悉对数，你应该能理解下面的等式:</p><p id="c6a8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">log( <em class="lt"> Y(t) </em> ) = log( <em class="lt">趋势(t) *季节性(t) *误差(t)) </em></p><p id="4bcd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">log( <em class="lt"> Y(t) </em> ) = log( <em class="lt">趋势(t)) + log(季节性(t)) + log(误差(t)) </em></p><p id="2796" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">可视化是理解我们时间序列本质的良好开端。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/0a78af2e88af767a386b1b8887e95850.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/1*zFjR-sYO7TjmQvSebc6kMA.gif"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">这看起来像一个乘法模型</p></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mw"><img src="../Images/5c6addf38c07182faac20a0d879c22ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jenMunf7G5byOmSJrX3qg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">附加模型的插图(你对循环模式有什么看法？是还是不是？)</p></figure><p id="b207" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">可视化有其自身的局限性。我们需要一种方法来量化和确认我们的发现——输入<strong class="kz ir">分解</strong>。</p><blockquote class="lu lv lw"><p id="4339" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated">分解有助于我们提取和量化时间序列的组成部分。这也有助于我们理解在解释时间序列时什么更重要。</p></blockquote><p id="289e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们回到我们的超市。看完系列，我就先来个加法模型。让我们来分解我们的系列:我已经说明了所使用的各种方法中的两种。</p><p id="7f61" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">经典分解</strong></p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mx"><img src="../Images/9a0300c7153a952f0596f818a1a6dea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PzVJmyCSVRiHmln84XzAg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">分解我们的时间序列</p></figure><p id="d2f7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">仔细观察趋势和季节性成分。随着时间的推移，我们可以看到一个上升的趋势和或多或少不变的季节性。同样残差以<strong class="kz ir"><em class="lt"/></strong><em class="lt">零点为中心。</em>这证实了我们对加法模型的假设。</p><p id="e3b5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> STL —稳健方法</strong></p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mx"><img src="../Images/0a7fcfeb0d9be60d14bbae624e235316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JQRlijVuzJOHC_juwedzsA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">STL只适用于附加模型；如果我们有乘法模型，我们使用对数变换。我们不会在这个故事中探讨这个问题。</p></figure><p id="1601" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我想特别强调另一种识别季节性的方法。我们可以利用<em class="lt"> month_plot </em>来查看这些年中是否有任何月份具有显著的重复模式。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">使用month_plot识别季节性</p></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mx"><img src="../Images/ac12cb2e3194fba5668df60968d693ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONVNuDCtd42wu4naUrDGrg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">在销售额最低的(1月、2月)和销售额最高的(9月、11月、12月)观察到的季节性行为</p></figure><p id="3e30" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们探索一下可以用于预测的各种模型。我们将通过<strong class="kz ir"> <em class="lt">指数平滑</em> </strong>方法和<strong class="kz ir"> <em class="lt"> ARIMA </em> </strong>方法来预测我们的时间序列。</p><p id="f074" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">指数平滑模型</strong></p><p id="3bba" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在指数平滑法中，我们根据过去观察值的加权平均值来预测值。这些重量随着我们回到过去而衰减。这意味着我们更加重视最近的观察。参数用于计算权重，其取值介于0和1之间。</p><p id="5b27" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">简单指数平滑</strong></p><p id="2d5b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当数据中既没有明显的趋势也没有季节性时，使用这种方法。我们只是试图通过使用参数<strong class="kz ir"><em class="lt">【⍺</em></strong>来平滑级数的电平。水平无非是局部的意思。数学上我们可以这样表示:</p><p id="461c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"><em class="lt">y(t+1)= ⍺*y(t)+⍺(⍺-1)*y(t-1)+⍺(⍺-1)* y(t-2)+………..</em> </strong>权重随着时间的推移而衰减，⍺是所使用的平滑参数，可以在<strong class="kz ir"> 0 </strong>和<strong class="kz ir"> 1 </strong>之间调整。</p><p id="8810" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们编码这个。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi my"><img src="../Images/a9af26199ca398abbe71c94b852993c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U96-sjbDHnvFHz9S4UVatA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">SES模型</p></figure><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="f5df" class="mj mk iq mf b gy ml mm l mn mo">#Let's check accuracy score by using RMSE<br/>Root mean squared error = 36203.014759074365</span></pre><p id="1a94" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以看到天气预报并不乐观。你可以试着调整⍺的<strong class="kz ir"><em class="lt"/></strong>看看你是否能得到更好的预测。简单的指数平滑总是给出一个平坦的预测，因此应该只用于预测下一个数据点。</p><p id="44dd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">霍尔特模型或双指数平滑</strong></p><p id="c79c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这里我们考虑两个属性:水平和趋势——这意味着我们将有两个平滑参数，分别是<strong class="kz ir"><em class="lt"/></strong>和<strong class="kz ir"> <em class="lt"> β </em> </strong>。当有趋势但没有季节性时，我们应用这种类型的模型。</p><p id="049e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们直接进入代码。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mz"><img src="../Images/1dc61e390cd2c5de142254e8c567a46b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6_xZCql4ib800w9cnb0xFQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">霍尔特线性趋势模型</p></figure><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="201e" class="mj mk iq mf b gy ml mm l mn mo">#Let's check accuracy score by using RMSE<br/>Root mean squared error = 19269.25908614305</span></pre><p id="4cd4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以看到，RMSE越低，预测越好。还有一个没有任何季节性的线性趋势成分。</p><p id="f0fa" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">除了不能捕捉季节性之外，这种方法也不能稳定或者“抑制”趋势。在未来的日子里，它只会越来越高。这是不可取的，尤其是当我们进行长期预测时。对此的一个解决方法是添加阻尼参数。这是霍尔特线性趋势模型的扩展。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi na"><img src="../Images/4d9ea3fc48f9479c8e2ea2c0d8703905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yU11sjDFnwdBTAYw6OCFfw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">带阻尼的霍尔特线性趋势</p></figure><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="6aaf" class="mj mk iq mf b gy ml mm l mn mo">#Let's check accuracy score by using RMSE<br/>Root mean squared error = 19646.815465033545</span><span id="e358" class="mj mk iq mf b gy nb mm l mn mo">#You can see our RMSE has suffered to some extent due to damping. #This is a trade off that we need to consider while selecting the #model.</span></pre><p id="ace0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">霍尔特-温特模型或三重指数平滑</strong></p><p id="0fbb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们找回我们的季节性。该模型考虑了序列中的水平、趋势和季节性。由于趋势和季节性的存在，霍尔特-温特的模型可以是加法或乘法。平滑参数有三个:<strong class="kz ir"><em class="lt">⍺</em></strong><strong class="kz ir"><em class="lt">β</em></strong>和<strong class="kz ir"> <em class="lt"> 𝜸 </em> </strong>分别用于水平、趋势和季节性。如果您还记得，我们的超市数据在分解图中同时包含趋势和季节成分，那么我们可以期待这个模型能给我们带来更好的准确性。我们还假设了一个加法模型。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi my"><img src="../Images/f49d37d008fd3f79697841c29839c257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrJgqJiuz_36iNOJuf3HGQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">霍尔特·温特模型</p></figure><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="8c81" class="mj mk iq mf b gy ml mm l mn mo">#Let's check accuracy score by using RMSE<br/>Root mean squared error = 17660.235617816732</span><span id="400a" class="mj mk iq mf b gy nb mm l mn mo">#Note that the model automatically applies smoothing parameters; you #can manually tune them by specifying smoothing_level, #smoothing_slope and smoothing_seasonal values.</span></pre><p id="e195" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您可以观察到，该模型捕捉到了图中的趋势和季节性。我们的RMSE分数也提高了。</p><blockquote class="lu lv lw"><p id="e85b" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated">简而言之，我们已经看到我们的模型既有趋势部分又有季节部分，它们是以一种“相加”的方式结合在一起的。因此，霍尔特-温特的模型给了我们最好的结果。接下来我们将看看更复杂的自回归模型。</p></blockquote></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="a685" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> ARIMA模式</strong></p><p id="6c8e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">ARIMA代表自回归综合移动平均线。我们来分解一下。</p><p id="78f2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一个<strong class="kz ir">自回归</strong>模型试图识别与其构成<strong class="kz ir"> AR(p) </strong>分量的滞后(以前的时间段)的显著相关性。例如，<strong class="kz ir"> AR(1) </strong>过程将意味着<strong class="kz ir"> </strong>时间t的值是时间T1的值的线性函数(换句话说，滞后1)。从数学上来说，AR(1)模型看起来像是:</p><blockquote class="lu lv lw"><p id="8514" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated"><strong class="kz ir"><em class="iq">y(t)=𝛿+ɸ*y(t-1)+w(t)</em></strong><em class="iq">，其中w(t)为时刻(t)的白噪声，正态分布为N(0，</em> 𝛔 <em class="iq"> ) </em></p></blockquote><p id="2ad5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但是什么是<a class="ae kw" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwilwc7ewKPxAhUGfisKHf5oBpcQFjAAegQIBBAD&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCorrelation_and_dependence&amp;usg=AOvVaw2d26feV-KieUEgGVjAy7pj" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir">相关性</strong> </a>又是如何计算出来的呢？让我们来看看公式。考虑两个变量x和y，相关性由下式给出:</p><blockquote class="lu lv lw"><p id="0e01" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="iq">关联= Cov(x,y)/(𝛔x * 𝛔y) </em> </strong></p></blockquote><p id="5e9c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">分子是x和y的<a class="ae kw" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwiStezGwKPxAhUPbn0KHbVQAEMQFjACegQIBhAD&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCovariance&amp;usg=AOvVaw35yB5Pbo71eFBEZ_fnRsCe" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir">协方差</strong> </a> <strong class="kz ir"> </strong>，分母是x和y的标准偏差的乘积。相关系数是此公式的结果，它给出了取值在-1和1之间的x和y的关联程度的估计。如果你熟悉皮尔逊的r，你会发现这里的相似之处。对于AR(p)过程，x和Y无非是Y(t)和Y(t-p)。</p><p id="49f5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">时间序列模型中的<strong class="kz ir">移动平均</strong>项<strong class="kz ir"> MA(q) </strong>是过去误差(乘以一个系数)。假设相应滞后的每个误差项具有方差恒定且均值为零的正态分布。从数学上讲，一个<strong class="kz ir"> MA(1) </strong>过程将看起来像:</p><blockquote class="lu lv lw"><p id="6af0" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated"><strong class="kz ir"><em class="iq">【y(t)=+w(t)+𝛉*w(t-1)</em></strong><em class="iq">，其中w(t)为时刻(t)的白噪声，正态分布为N(0，</em>【𝛔<em class="iq">】，</em> <strong class="kz ir"> <em class="iq"> </em> </strong> <em class="iq">为数列的均值</em></p></blockquote><p id="21bc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">积分</strong>代表数列求差的次数。差异是用前一个时间段减去当前时间段的值的过程。这将产生一阶的差异。我们可以做d次，这样我们的系列就是d阶差分系列。但是我们为什么要区分我们的系列呢— <strong class="kz ir">引入平稳性的概念，这是自回归模型的强制性标准。</strong></p><p id="daf7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">那么我们来理解一下平稳性。</p><p id="ae9b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一个数列是平稳的当且仅当:</p><p id="b391" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt"> a) </em> <strong class="kz ir"> <em class="lt">时间序列的均值是一个常数</em> </strong> —这意味着具有趋势性或季节性的时间序列是非平稳的。趋势或季节性成分会影响时间序列在不同时期的值。</p><p id="3e02" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt"> b) </em> <strong class="kz ir"> <em class="lt">方差/协方差随时间恒定</em> </strong></p><p id="ae4f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt"> c) </em> <strong class="kz ir"> <em class="lt">时间段(滞后)t与t + mth之间的相关性始终是一个常数</em> </strong> —这暗示着一月和十一月将具有与十二月和十月相同的相关性。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nj"><img src="../Images/9d7192f23bac80aae472666c714d704c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdblkZyg6YmmReAkZHUksw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">来源:<a class="ae kw" href="https://beingdatum.com/time-series-forecasting/" rel="noopener ugc nofollow" target="_blank">beingdatum.com</a></p></figure><blockquote class="lu lv lw"><p id="8869" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated">总的来说，平稳序列是统计特性不随时间变化的序列。</p></blockquote><p id="ad23" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有几种方法可以使非平稳序列平稳。这些是对数转换(用于平滑方差)，消除分解后的趋势和季节性，计算移动平均数和差分序列。在上述方法中，<strong class="kz ir">差分</strong>广泛用于使我们已经描述过的数列平稳。</p><p id="6f7e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们测试数据的平稳性。我们将使用扩展的Dickey-Fuller检验来检验我们的零假设，即我们的序列不是平稳的。如果我们得到一个显著的p值，我们将拒绝我们的零假设，并建立我们的序列是平稳的。相反，如果我们不能拒绝我们的零假设，我们将差分序列，并再次运行测试。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nk"><img src="../Images/29e3c5bc0669c51abc5417ee363ca87c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ystK9k7ydBnYKu4SnFLe0g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">以99%的置信度测试统计值大大超过临界值</p></figure><p id="2584" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">查看结果后，我们的零假设可以被拒绝。我们可以有99%的把握说我们的数据是稳定的。</p><blockquote class="lu lv lw"><p id="81ae" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated">如果我们用分解代替差分，我们可以用同样的方法测试残差的平稳性</p></blockquote><p id="b735" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们继续吧。下一步是探索ACF(自相关函数)和PACF(部分自相关函数)。还记得我们讨论过AR(p)和MA(q)过程吗？ACF和PACF图有助于我们识别订单p和q</p><p id="e13f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">ACF寻找与序列滞后的相关性。滞后为1的序列是偏移了一个时间周期的序列。下表显示了1、2、3等阶的滞后序列。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nl"><img src="../Images/1b40f6926dcbfa078f2370bacc715a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPGDfFw791nkRiINxMmL9w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">滞后的例证</p></figure><p id="70d1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> ACF </strong>绘制原始序列与滞后1、滞后2等之间的相关性。我们来看看用python怎么做。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/9da47e27ecbae5be19289dc043a839dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38L24d978mjJ6hpcM_xHYg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">我们可以看到滞后(1)是显著的</p></figure><p id="7e96" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">任何高于蓝色条纹的尖峰都是有意义的。我们可以看到滞后(1)和滞后(12)是显著的。此外，我们可以看到，随着相关性的逐渐衰减(每隔12个滞后观察一次)，滞后之间有升有降。比方说，滞后(1)和滞后(4)之间的相关性很可能受到中间滞后(滞后(2)和滞后(3)的影响。因此，重要的是消除这些并获得真实的画面— <strong class="kz ir"> PACF </strong>图用于相同的目的。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nn"><img src="../Images/3e7b6d945b5bc8072af1a23d921dc2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSQQnyfX8R_tkn5UvSa98A.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">我们可以看到滞后(1)在其他冲击中是显著的</p></figure><p id="eaa6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">上面的PACF图显示滞后(1)在其他信号或冲击中是显著的。滞后(12)在这里也很重要。</p><p id="88ae" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">我们如何解读ACF和PACF的阴谋？</strong></p><p id="8a16" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面的矩阵应该有助于我们选择最佳订单:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi no"><img src="../Images/29622aa662244d3446438bbb1f1720e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUYkmOs13YGxjysi8dkX3Q.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">这里的“m”是季节周期</p></figure><p id="9f07" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据我们的图，看起来有季节性和非季节性的成分。每个第12个滞后峰值表示季节性，我们可能需要区分它。我们可以迭代不同的组合，并检查AIC(赤池信息标准)和BIC(贝叶斯信息标准)的分数。我们的目标是最小化这些分数以获得更好的模型性能。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">构建ARMA、汇总统计数据和准确度分数</p></figure><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="286a" class="mj mk iq mf b gy ml mm l mn mo">#Call the function and fine tune parameters<br/># d=0 as we did not difference the series<br/>#Try with p=1, q=1 based on our ACF and PACF plots<br/>#Alternatively, start with (1,0,0) AR model and (0,0,1) MA model</span><span id="dbeb" class="mj mk iq mf b gy nb mm l mn mo">arima_model(1,0,1) #ARMA model</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi np"><img src="../Images/448750bd69f5795159840973799f6e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jK4_U9tTfTGCQP-PguKKNg.png"/></div></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nq"><img src="../Images/7aea1046cb5707245a5921c0e8465819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BQ8dZQQ6QKJif90k9q935g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">预测6个月的ARMA模型</p></figure><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="14a7" class="mj mk iq mf b gy ml mm l mn mo">#MAPE<br/>0.6571285433084803</span><span id="92f5" class="mj mk iq mf b gy nb mm l mn mo">#RMSE<br/>23037.553921953575</span></pre><p id="3677" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">精确度不是很高。我们可以尝试不同的组合，看看什么给我们最好的准确度分数。此外，MA(1)系数在统计上并不显著。我们可以放下它，再看看我们的结果。这个迭代可以继续下去，直到我们找到一个最佳的精度。请注意，我们还没有包括季节性。这为季节性ARIMA铺平了道路。</p><p id="1638" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们来看看季节性的ARIMA。我们将使用非季节性arima <strong class="kz ir"> (p，D，q) </strong>的参数，并添加相应的季节性订单<strong class="kz ir"> (P，D，Q)m </strong>，其中m是季节性周期；因为我们的数据是每月一次，并且模式每年重复，所以m=12。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="afb2" class="mj mk iq mf b gy ml mm l mn mo">#Since we saw significant spikes at 12th lag in our ACF and PACF #plots, we can try the following</span><span id="dc60" class="mj mk iq mf b gy nb mm l mn mo">sarimamodel(0,1,0,12)<br/>sarimamodel(1,0,0,12)<br/>sarimamodel(0,0,1,12)</span><span id="7c7f" class="mj mk iq mf b gy nb mm l mn mo">#We need to minimize our AIC and BIC values</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nr"><img src="../Images/242ff8c515e07e7fc10a4925e6c800c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7jIgAvVNdXHMb6aba-chg.png"/></div></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nq"><img src="../Images/ccd942ae04c0e3213effa6a1eac8a434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4hKFCUWIrFv4lwTnCRFW0w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">我们可以看到MAPE的显著改善</p></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi na"><img src="../Images/fc1157724ad48f68c2628ee26c91b88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*im65mvBrlitCyKQeuaN_DA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">分析残差以查看它们是否正态分布</p></figure><p id="d51a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以看到，在模型中引入季节性因素后，AIC、BIC和MAPE的得分有了显著提高。模型残差也几乎遵循正态分布，如下所示:</p><p id="9e3d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这是两组分位数的散点图。如果两组分位数来自相同的分布，我们应该看到这些点形成一条大致笔直的线。</p><p id="6c7e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">标准化残差</strong>-这表明我们的残差经过标准化后，以零为中心。</p><p id="c39e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">直方图和KDE </strong>绘制标准化残差的分布，并将其与正态分布进行比较。</p><p id="a2e6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">相关图</strong>用于查看残差之间是否有显著的自相关；我们没有。这意味着残差是稳定的，没有任何模式。</p><blockquote class="lu lv lw"><p id="bcda" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated">残差的平稳性是最终确定模型的必要条件</p></blockquote><p id="cd2e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，如果你观察结果，我们仍然没有重要的系数，我们应该迭代其他组合。</p><p id="3434" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">幸运的是，python提供了一个内置函数auto _ arima(pmdarima包的一部分),它节省了我们确定ARIMA最优顺序的时间。下面是一幅插图:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ns"><img src="../Images/ce5be68e8c471cdb2feb9107f85b980c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DT3br33bnrN3jMoDh5jPkA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">自动搜索最小化AIC的最佳模型</p></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi na"><img src="../Images/9024fb1623ba3518d141ebe9792ee351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ydw4HdrbXiVxIMNWH6b2w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">残差正态性</p></figure><p id="7033" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以看到auto_arima选择了ARIMA(1，0，1)(1，0，0)[12]作为最佳模型。残差看起来也是稳定的。如果你没有得到有统计学意义的参数，我们可以区分系列，并按照相同的步骤再次运行ARIMA模型。在快速运行auto_arima时，它给出了ARIMA(2，1，0)(1，0，0)[12]。我将把它留在那里，并鼓励你尝试差异和建模。</p><pre class="kh ki kj kk gt me mf mg mh aw mi bi"><span id="a09d" class="mj mk iq mf b gy ml mm l mn mo">#Differencing<br/>data_diff = data-data.shift()<br/>plt.plot(data_diff)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nt"><img src="../Images/ce718e1aaf62eaa2cbc520b5767688ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N7axvD7D-qWmO-8m6pgPcw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">差分序列</p></figure><blockquote class="lu lv lw"><p id="faa0" class="kx ky lt kz b la lb jr lc ld le ju lf lx lh li lj ly ll lm ln lz lp lq lr ls ij bi translated">注意，auto_arima在捕捉季节性方面做得不太好。因此，简单地依赖auto_arima不会产生最佳模型。我们必须仔细检查ACF和PACF图，了解季节效应(如果有的话)，绘制auto_arima以供进一步实验，并应用业务领域知识来最终确定模型参数。</p></blockquote><p id="6acd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我希望这为开始实现时间序列预测提供了一个思路。我想强调的是，我们没有在ARIMA模型中将数据分为训练和测试。这是因为我们没有太多的数据来建模。这是您根据可以处理的数据量做出的决定。</p></div></div>    
</body>
</html>