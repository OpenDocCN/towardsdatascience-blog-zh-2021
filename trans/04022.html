<html>
<head>
<title>Ordinary Differential Equation (ODE) in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的常微分方程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ordinal-differential-equation-ode-in-python-8dc1de21323b?source=collection_archive---------2-----------------------#2021-04-05">https://towardsdatascience.com/ordinal-differential-equation-ode-in-python-8dc1de21323b?source=collection_archive---------2-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="557c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">颂的用法是什么？如何用Python求解ODE？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a3987bc98f3fa4114f28e2fd102170d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Anm0acqqE06PiKON"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">约翰·莫塞斯·鲍恩在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="830a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">常微分方程</strong> (ODE)可以用来描述一个动态系统。在某种程度上，我们生活在一个动态系统中，窗外的天气从黎明到黄昏不断变化，我们体内的新陈代谢也是一个动态系统，因为随着时间的推移，成千上万的反应和分子被合成和降解。</p><p id="57b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更正式地说，如果我们定义一组<strong class="ky ir">变量</strong>，比如一天中的温度，或者某个时间点的分子X的量，它随着<strong class="ky ir">自变量</strong>而变化(在动态系统中，通常会是<strong class="ky ir">时间t </strong>)。ODE为我们提供了一种从数学上描绘定义变量的动态变化的方法。与之相对的系统叫做<strong class="ky ir">静态系统</strong>，想着拍一张外面的照片，这张快照不包含任何动态，换句话说就是静态的。</p><p id="b395" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">求解常微分方程意味着确定变量将如何随着时间的推移而变化，该解有时被称为<strong class="ky ir">解曲线</strong>(如下图所示)，为任何动态系统的默认行为提供信息性预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/c104ce0f9b2a568c94ef53f56c95f53a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKd9STZc_Weigpknb1Tjwg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">线性系统的示例解曲线</p></figure><p id="7d5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将介绍ODE，更重要的是，如何仅仅使用Python来解决ODE。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="9211" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">术语概述</h1><p id="eaa8" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在这里，我首先介绍一些术语，读者可能会从中受益。<strong class="ky ir">常微分方程</strong>看起来是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/83c02bbea80708fc54f7ec3289a4ad08.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*Z4jSt85ADmt7rcN6OEpgvw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">颂诗</p></figure><p id="f599" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个包含导数的方程，但方程本身没有偏导数。换句话说，我们只考虑<strong class="ky ir">一个自变量</strong>，那就是时间t，当我们有多个自变量进来时，就变成了<strong class="ky ir">偏微分方程(PDE) </strong>，不在本文讨论范围内。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/177857eef0081a45141cf717cbce9698.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*t6lIkdU7ffGX9OkssLf1Bg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">偏微分方程（Partial Differential Equation的缩写）</p></figure><p id="ee9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在ODE中，<em class="mz">如果包含因变量的项的系数(在上面的例子中，变量R，包含R的项包括dR/dt和k2R)与R </em>无关，则该ODE被视为<strong class="ky ir">线性ODE </strong>。为了说明这一点，让我给你看一首非线性颂歌作为比较:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/ee2b41780aa3c6511891d23e1bd4d096.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*rdm0yeerH2fSdyToXQc-TA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">非线性ODE</p></figure><p id="6201" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大家可以看到，现在dR/dt的系数是R，违反了线性ODE的定义，所以变成了一个<strong class="ky ir">非线性ODE </strong>。</p><p id="4e5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，最后一对术语，如果变量的导数独立于自变量(这里是时间t)，我们称它们为<strong class="ky ir">自治颂</strong>，否则，就变成了<strong class="ky ir">非自治颂</strong>。同样，非自治ODE如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/9cb6f919f38d7ff1c41f7c5915d634d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*dIAAysawa5SNgxcH5eHvsg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">非自治颂歌</p></figure><p id="8244" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以看到现在时间t在右边，所以这是一首非自治颂歌。</p><h1 id="e0d3" class="ma mb iq bd mc md nc mf mg mh nd mj mk jw ne jx mm jz nf ka mo kc ng kd mq mr bi translated">求解s形信号响应曲线</h1><p id="c286" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">首先，本文中使用的例子来自于<a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0955067403000176" rel="noopener ugc nofollow" target="_blank">泰森等人</a>的一篇精彩综述论文。如果你对此感兴趣，我强烈推荐你去看看。</p><p id="e2d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">s形信号响应曲线描述了如下所示的系统:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/1fc5a03fce63d91771c3e0f0c5cee828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q2uZut_TLK9qurq7i09EUw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">体内磷酸化过程(改编自<a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0955067403000176" rel="noopener ugc nofollow" target="_blank">泰森等人</a>)</p></figure><p id="6e2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它是在我们体内发生的磷酸化过程，R是一种物质，它将被转化为磷酸化形式Rp以发挥许多功能，这一过程由信号S催化，并伴随着ATP水解。为了描述这一过程，原始论文使用了以下ODE:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8202c3c58f68d9763b6b2a55d53ab662.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*BfikDFV4P9MAGOPX6xk2wQ.png"/></div></figure><p id="f80d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们首先要解这个方程，这意味着获得描述Rp如何随时间变化的<strong class="ky ir">解曲线</strong>。</p><p id="cfea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始编码:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="4bd8" class="no mb iq nk b gy np nq l nr ns">from scipy.integrate import odeint<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="8cb2" class="no mb iq nk b gy nt nq l nr ns">def model(Rp,t,S):<br/>    k1 = 1<br/>    k2 = 1<br/>    Rt = 1<br/>    km1 = 0.05<br/>    km2 = 0.05<br/>    dRpdt = (k1*S*(Rt-Rp)/(km1+Rt-Rp)) - k2*Rp/(km2+Rp)<br/>    return dRpdt</span></pre><p id="6ca3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的代码只是为了建立我们描述的使用数学方程的模型，这里的一些参数我只是使用了在<a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0955067403000176" rel="noopener ugc nofollow" target="_blank">原始论文</a>中提供的。</p><p id="c1f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将信号强度设置为1，但这只是为了说明，您可以随意将其更改为您喜欢的任何值。然后我们将Rp的初始值设置为三种不同的可能性:0，0.3，1。它可以向我们展示不同的初始化将如何最终收敛到稳态。为了简单起见，我们将模拟时间窗口设置为0到20。最后，我们用<code class="fe nu nv nw nk b">odeint</code>函数来求解这个ODE。</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="3241" class="no mb iq nk b gy np nq l nr ns">S = 1<br/>Rp0 = [0,0.3,1]<br/>t = np.linspace(0,20,200)<br/>result = odeint(model,Rp0,t,args=(S,))</span></pre><p id="10b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nu nv nw nk b">result</code>对象是形状为[200，3]的NumPy数组，3对应三个初始化条件。现在我们画出:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="8ec3" class="no mb iq nk b gy np nq l nr ns">fig,ax = plt.subplots()<br/>ax.plot(t,result[:,0],label='R0=0')<br/>ax.plot(t,result[:,1],label='R0=0.3')<br/>ax.plot(t,result[:,2],label='R0=1')<br/>ax.legend()<br/>ax.set_xlabel('t')<br/>ax.set_ylabel('Rp')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/76189aca6f94029d8979aab7fc9c443d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpPipfzdVwKZN79DyxA7Bg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">s形响应，溶液曲线</p></figure><p id="32c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们可以看到，无论Rp从哪里开始，它们都会收敛到0.5左右，这被称为<strong class="ky ir">稳态</strong>。稳态是ODE的要点，因为它定义了动态系统的默认行为。你可能想知道为什么我们称之为s形信号响应曲线？这是因为除了求解解曲线，我们还想知道信号强度将如何作用于整个系统，用ODE语言来说，信号强度将如何改变系统的稳态？现在我们要去探索它！</p><p id="f75d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数学上，当设置dRp/dt = 0时，系统的稳态基本上是公式的根。一个更好的例子如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/35b72d3f9fdd762df8713c4229919712.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*mapbfra3WzJHUB3VWyz9hw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">定态</p></figure><p id="b09a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以如果我们能解出关于Rp的最后一个方程，我们就能得到稳态时Rp的值。</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="ed99" class="no mb iq nk b gy np nq l nr ns">S_all = np.linspace(0,3,100)<br/>def equation(Rp,S):<br/>    k1 = 1<br/>    k2 = 1<br/>    Rt = 1<br/>    km1 = 0.05<br/>    km2 = 0.05<br/>    return k1*S*(Rt-Rp)/(km1+Rt-Rp) - k2*Rp/(km2+Rp)<br/><br/>from scipy.optimize import fsolve<br/>store = []<br/>for S in S_all:<br/>    Rp_ss = fsolve(equation,[1],args=(S,))[0]<br/>    store.append(Rp_ss)</span></pre><p id="6d8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们首先设置信号S的范围从0到3，然后我们使用来自<code class="fe nu nv nw nk b">scipy.optimize</code>的<code class="fe nu nv nw nk b">fsolve</code>函数来完成这项工作。当S等于0–3之间的不同值时，结果基本上就是Rp值。</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="d981" class="no mb iq nk b gy np nq l nr ns">fig,ax = plt.subplots()<br/>ax.plot(S_all,store,c='k')<br/>ax.set_xlim(0,3)<br/>ax.set_xlabel('Signal(S)')<br/>ax.set_ylim(0,1.1)<br/>ax.set_ylabel('Response(R_ss)')</span></pre><p id="2f3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们看看结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/5cc33c5343a8bd11485e679f0b37f2c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qWHMqw4RVO4YxoNHnyZe4g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">信号响应曲线(s形)</p></figure><p id="5c2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我希望大家能够清楚为什么称之为sigmoid信号响应曲线，因为随着信号强度的变化，系统的稳态将以sigmoid方式响应。</p><h1 id="75b1" class="ma mb iq bd mc md nc mf mg mh nd mj mk jw ne jx mm jz nf ka mo kc ng kd mq mr bi translated">进一步评论</h1><p id="0c71" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">上面的例子只是为了让你体会一下什么是ODE，以及如何用python只用几行代码就解决了ODE。当系统变得更复杂时，例如，涉及到不止一个组件(这里我们称之为<strong class="ky ir">一阶ODE </strong>，另一个名为<a class="ae kv" href="https://gekko.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> GEKKO </a>或scipy.integrate.solve_ivp的python包可能会帮你完成这项工作。</p><p id="2ac3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们对如何复制Tyson等人的其他图感兴趣，我建议你查看我的Github库，那里提供了所有代码。</p><p id="c3d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/frankligy/ScPyT/blob/main/ODE/submission/Frank_system_biology_hw.pdf" rel="noopener ugc nofollow" target="_blank">https://github . com/Frank ligy/ScPyT/blob/main/ODE/submission/Frank _ system _ biology _ HW . pdf</a></p><p id="0e4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你觉得这篇文章有趣和有用，感谢阅读！如果你喜欢这篇文章，请在medium上关注我，非常感谢你的支持。在我的<a class="ae kv" href="https://twitter.com/FrankLI55917967" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae kv" href="https://www.linkedin.com/in/guangyuan-li-399617173/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我，也请让我知道你是否有任何问题或你希望在未来看到什么样的教程！</p></div></div>    
</body>
</html>