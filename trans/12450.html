<html>
<head>
<title>Summarizing data with Pandas crosstab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫交叉表汇总数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/summarizing-data-with-pandas-crosstab-efc8b9abecf?source=collection_archive---------14-----------------------#2021-12-20">https://towardsdatascience.com/summarizing-data-with-pandas-crosstab-efc8b9abecf?source=collection_archive---------14-----------------------#2021-12-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="26c3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有效使用 Pandas 交叉表进行数据汇总的 7 个实用技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6afa1d505102253f5913b6ab03ceea1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rBUPbUegzllFWJsjJeo0g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@uxindo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">印尼 UX</a>在<a class="ae ky" href="https://unsplash.com/s/photos/data-analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><blockquote class="kz la lb"><p id="6129" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">汇总数据最直接的效果是获取大量的数据，并将其缩减为几个可以查看的关键汇总值，通常在表格或图表中。</p><p id="e2cc" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">来源于数据科学导论[1]</p></blockquote><p id="55c4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">数据汇总是以易于理解和信息丰富的方式呈现生成数据的汇总的过程。Pandas 提供了几个汇总数据的选项:<code class="fe mc md me mf b">groupby</code>、<code class="fe mc md me mf b">pivot_table</code>、<code class="fe mc md me mf b">crosstab</code>。</p><p id="af79" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们之前已经介绍了熊猫<code class="fe mc md me mf b"><a class="ae ky" rel="noopener" target="_blank" href="/a-practical-introduction-to-pandas-pivot-table-function-3e1002dcd4eb">pivot_table()</a></code>和<code class="fe mc md me mf b"><a class="ae ky" href="https://bindichen.medium.com/all-pandas-groupby-you-should-know-for-grouping-data-and-performing-operations-2a8ec1327b5" rel="noopener">groupby()</a></code>，本文将探讨熊猫<code class="fe mc md me mf b">crosstab()</code>以及如何使用它进行数据分析。这篇文章的结构如下:</p><ol class=""><li id="9587" class="mg mh it lf b lg lh lj lk lz mi ma mj mb mk ly ml mm mn mo bi translated">最简单的交叉表</li><li id="4bbf" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">显示多行和多列</li><li id="2ede" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">显示带边距的合计</li><li id="7bf0" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">使用 normalize 获取发生的百分比</li><li id="c589" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">指定值并执行聚合</li><li id="786c" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">处理缺失值</li><li id="39c6" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">Seaborn 热图的可视化</li></ol><blockquote class="mu"><p id="019f" class="mv mw it bd mx my mz na nb nc nd ly dk translated">请查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/045-pandas-crosstab/pandas-crosstab.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>获取源代码。更多教程可从<a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank"> Github Repo </a>获得。</p></blockquote><p id="121b" class="pw-post-body-paragraph lc ld it lf b lg ne ju li lj nf jx ll lz ng lo lp ma nh ls lt mb ni lw lx ly im bi translated">为了进行演示，我们将处理咖啡销售数据。让我们导入一些库并加载数据来开始:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="7744" class="nn no it mf b gy np nq l nr ns">import pandas as pd</span><span id="9052" class="nn no it mf b gy nt nq l nr ns"><strong class="mf iu">def load_data():<br/>    return pd.read_csv('coffee_sales.csv', parse_dates=['order_date'])</strong></span><span id="8539" class="nn no it mf b gy nt nq l nr ns">df = load_data()<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/bf4ba8b66e6a3010a819d649c12be820.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ro6WTJjLfCwEKhnscRpDpQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">咖啡销售数据集(图片由作者提供)</p></figure></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="b8b5" class="oc no it bd od oe of og oh oi oj ok ol jz om ka on kc oo kd op kf oq kg or os bi translated">1.最简单的交叉表</h1><p id="1e58" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">创建交叉表时，需要指定行的内容以及如何拆分列。默认情况下，它会计算每个组合中的观察次数。在我们的例子中，让我们使用<code class="fe mc md me mf b">region</code>作为我们的行索引，并用<code class="fe mc md me mf b">product_category</code>分割列。</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="1e07" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<strong class="mf iu">df['region']</strong>, <strong class="mf iu">df['product_category']</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/f42e1e45d1cc12784f9e91df96270c2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pn68_6pqE9A3oE79usBhvA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单的交叉表示例(图片由作者提供)</p></figure><p id="7f82" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">在某些情况下，出于显示目的，您可能更喜欢自定义标签。为此，我们可以包含特定的<code class="fe mc md me mf b">rownames</code>和<code class="fe mc md me mf b">colnames</code>:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="91fa" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    <strong class="mf iu">rownames=['US Region'],</strong> <br/>    <strong class="mf iu">colnames=['Product Category']</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/3de2778396c5fbf2d272a108c0dc3dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zk7-jQfHRG6VaAbFHJh3vQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有自定义名称的简单交叉表示例(图片由作者提供)</p></figure><h1 id="86d4" class="oc no it bd od oe pa og oh oi pb ok ol jz pc ka on kc pd kd op kf pe kg or os bi translated">2.显示多行和多列</h1><p id="73be" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">交叉表最有用的特性之一是可以传入多个索引和列，它为我们完成所有的分组工作。例如，如果我们想要查看数据是如何按<strong class="lf iu">市场</strong>分布的，我们可以通过将<strong class="lf iu">市场</strong>列包含在一个列表中来包含它:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="9fbf" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    <strong class="mf iu">[df['product_category'], df['market']]</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/f44c52ecab8b192fde3719213458ebe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xpzpuKtgha29a3FJ93VekQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多列交叉表示例(作者图片)</p></figure><p id="f960" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">类似地，我们可以指定一个自定义标签用于显示目的。<code class="fe mc md me mf b">rownames</code>和<code class="fe mc md me mf b">colnames</code>都接受一个标签列表，每个标签对应一行和一列。</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="8498" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    [df['product_category'], df['market']],<br/>    rownames=['US Region'], <br/>    colnames=<strong class="mf iu">['Product Category', 'Market']</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/cbf3f53887ab81c3de6436622346bacd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lyUrAvVvRtANLak_ew3_dg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多重交叉表示例(作者图片)</p></figure><h1 id="8184" class="oc no it bd od oe pa og oh oi pb ok ol jz pc ka on kc pd kd op kf pe kg or os bi translated">3.显示行/列小计</h1><p id="822e" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">交叉表中另一种常见的显示方式是显示每行和每列的小计。我们可以通过设置<code class="fe mc md me mf b">margins=True</code>参数来添加它们:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="cf16" class="nn no it mf b gy np nq l nr ns">pd.crosstab(df['region'], df['product_category'], <strong class="mf iu">margins = True</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/713751c6c02083fdfa481abbacc3ca54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ps8o8uBr2DI6y-7hz0yr9g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有分类汇总的交叉表示例(作者图片)</p></figure><p id="e8f5" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">默认情况下，分类汇总显示有标签“<strong class="lf iu">全部</strong>”。我们可以使用<code class="fe mc md me mf b">margins_name</code>参数指定一个自定义标签:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="81f8" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], df['product_category'], <br/>    margins = True, <br/>    <strong class="mf iu">margins_name = 'Subtotals'</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/4e3ac4ccb8a58d89372ff3c7bfdbad2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*moIKTohTWHn6f257FjrX7Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带小计的简单交叉表(作者图片)</p></figure><h1 id="1163" class="oc no it bd od oe pa og oh oi pb ok ol jz pc ka on kc pd kd op kf pe kg or os bi translated">4.使用 normalize 获取发生的百分比</h1><p id="25bb" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">数据分析中的一个常见任务是了解发生的百分比。这可以通过将<code class="fe mc md me mf b">normalize</code>参数设置为<code class="fe mc md me mf b">True</code>来实现:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="5003" class="nn no it mf b gy np nq l nr ns">pd.crosstab(df['region'], df['product_category'], <strong class="mf iu">normalize = True</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/cfb6469da3b7cdce692d2318d6af8bbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aDqAYDTCFrU3Ymsm5pGtMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带规格化的简单交叉表(作者图片)</p></figure><p id="ad27" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果我们希望结果用百分号(%)格式化，我们可以如下调用<code class="fe mc md me mf b">style.format('{:.2%}')</code>:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="6e8c" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    normalize = True<br/>)<strong class="mf iu">.style.format('{:.2%}')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/011425eeae7acc6a5219fdbfb415e736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m-0zeikGBjqucMq-b0BYCA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带规格化的简单交叉表(作者图片)</p></figure><p id="95ba" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">此外，当<code class="fe mc md me mf b">margins</code>为<code class="fe mc md me mf b">True</code>时，该计算适用于小计:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="e4c0" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    <strong class="mf iu">margins = True, <br/>    normalize = True</strong><br/>).style.format('{:.2%}')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/05b900531be6a961c6f404f8e9a77ebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ad0QoUUa3bTv_kdRG0pDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带规格化的交叉表(作者图片)</p></figure><p id="9c46" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><code class="fe mc md me mf b">normalize</code>参数接受另外两个值<code class="fe mc md me mf b">'index'</code>和<code class="fe mc md me mf b">'columns'</code>:</p><ul class=""><li id="4757" class="mg mh it lf b lg lh lj lk lz mi ma mj mb mk ly pm mm mn mo bi translated">如果给定了<code class="fe mc md me mf b">'index'</code>，它将对每行进行归一化。</li><li id="9f8b" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly pm mm mn mo bi translated">如果给定了<code class="fe mc md me mf b">'columns'</code>，它将对每一列进行归一化。</li></ul><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="8ad0" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    margins = True, <br/>    <strong class="mf iu">normalize = 'columns'</strong><br/>).style.format('{:.2%}')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/b5d7acc505bdf59ce58a0c4821a85a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k9HzRYBYcjRdeDoiDu5oMA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">normalize=columns 的交叉表(按作者分类的图片)</p></figure><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="4bc2" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    margins = True, <br/>    <strong class="mf iu">normalize = 'index'</strong><br/>).style.format('{:.2%}')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/e843e71709a52f54d9b28b71be770141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zOLDB4KdqwxEC0QHIbZR8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">normalize=index 的交叉表(作者图片)</p></figure><h1 id="d5a1" class="oc no it bd od oe pa og oh oi pb ok ol jz pc ka on kc pd kd op kf pe kg or os bi translated">5.指定值并执行聚合</h1><p id="c04d" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">默认情况下，<code class="fe mc md me mf b">crosstab</code>对所有数字列执行<code class="fe mc md me mf b">count</code>聚合函数，并返回结果。要显式指定我们关心的列并执行聚合，可以使用<code class="fe mc md me mf b">values</code>和<code class="fe mc md me mf b">aggfunc</code>参数。</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="7adc" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    <strong class="mf iu">values = df['cost'],</strong><br/>    <strong class="mf iu">aggfunc = 'mean'</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/3b8aa1695f75e915bac0985b29512775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*liz_vAI6XKl6cqmZp5zG6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带聚集的交叉表(按作者分类的图片)</p></figure><p id="ec21" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">通过指定<code class="fe mc md me mf b">values = df['cost']</code>和<code class="fe mc md me mf b">aggfunc = 'mean'</code>，我们告诉熊猫将<code class="fe mc md me mf b">mean</code>函数应用于所有数据组合的成本。</p><p id="915a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">默认情况下，结果将保留 6 位小数。为了舍入结果，我们可以调用<code class="fe mc md me mf b">round()</code>:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="d42c" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    values = df['cost'],<br/>    aggfunc = 'mean'<br/>)<strong class="mf iu">.round(2)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/77e5c45dc421fc0a791b0efbeb4d34a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eeoLBfPAtzRPCUwLYGmf4w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带聚集的交叉表(按作者分类的图片)</p></figure><h1 id="2b7a" class="oc no it bd od oe pa og oh oi pb ok ol jz pc ka on kc pd kd op kf pe kg or os bi translated">6.处理缺失值</h1><p id="1906" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">您可能会注意到前面输出中的一个<code class="fe mc md me mf b">NaN</code>值。我们之所以有这种产品，是因为在南方没有茶叶销售。</p><p id="c0ff" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">不像<code class="fe mc md me mf b">privot_table</code>有内置的<code class="fe mc md me mf b">fill_value</code>参数来替换任何丢失的值，<code class="fe mc md me mf b">crosstab</code>不支持它。我们必须使用其他方法来处理缺失值，例如:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="9b0f" class="nn no it mf b gy np nq l nr ns">pd.crosstab(<br/>    df['region'], <br/>    df['product_category'], <br/>    values = df['cost'],<br/>    aggfunc = 'mean',<br/>).<strong class="mf iu">fillna(0)</strong></span></pre><p id="7829" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">然而，如果<code class="fe mc md me mf b">crosstab</code>输出包含条目都是<code class="fe mc md me mf b">NaN</code>的行或列，我们可以使用参数<code class="fe mc md me mf b">drop_na=True</code>来删除它们。</p><h1 id="77f2" class="oc no it bd od oe pa og oh oi pb ok ol jz pc ka on kc pd kd op kf pe kg or os bi translated">7.Seaborn 热图的可视化</h1><p id="329c" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">老实说，我是看了<a class="ae ky" href="https://pbpython.com/pandas-crosstab.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">熊猫交叉表解说</strong> </a>文章[2]才知道这些的。有时候，一个图表胜过一千个单词，这是一个非常方便的功能，可以直观地总结交叉表的输出。我们需要做的只是将交叉表输出传递给 seaborn 热图:</p><pre class="kj kk kl km gt nj mf nk nl aw nm bi"><span id="917d" class="nn no it mf b gy np nq l nr ns">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="30df" class="nn no it mf b gy nt nq l nr ns">plt.figure(figsize=(8, 6))<br/>sns.heatmap(<br/><strong class="mf iu">    pd.crosstab(<br/>        df['region'], <br/>        [df['product_category'], df['market']],<br/>        rownames=['US Region'], <br/>        colnames=['Product Category', 'Market'],<br/>        values = df['cost'],<br/>        aggfunc = 'mean'<br/>    ), </strong><br/>    annot = True<br/>)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/ab10a950fc2a5bd9945b58a1df92c32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlECq3TnXgsWMnqr4_Pivw.png"/></div></div></figure><h1 id="e200" class="oc no it bd od oe pa og oh oi pb ok ol jz pc ka on kc pd kd op kf pe kg or os bi translated">结论</h1><p id="b5a6" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">在本文中，我们已经讨论了 7 个关于用 Pandas <code class="fe mc md me mf b">crosstab()</code>方法汇总数据的用例。这是一个非常有用的工具，也是探索性数据分析中最受欢迎的数据汇总方法之一。</p><p id="e8b6" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">读完这篇文章后，你应该能够将它纳入你自己的数据分析。我希望你喜欢这篇文章，并学到一些新的有用的东西。</p><p id="8d8c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">感谢阅读。请查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/045-pandas-crosstab/pandas-crosstab.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>获取源代码，如果您对机器学习的实用方面感兴趣，请继续关注。更多教程可从<a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank"> Github Repo </a>获得。</p><h2 id="fa5d" class="nn no it bd od ps pt dn oh pu pv dp ol lz pw px on ma py pz op mb qa qb or qc bi translated">参考</h2><ul class=""><li id="c303" class="mg mh it lf b lg ot lj ou lz qd ma qe mb qf ly pm mm mn mo bi translated">[1] <a class="ae ky" href="http://dept.stat.lsa.umich.edu/~kshedden/introds/topics/data_summaries/" rel="noopener ugc nofollow" target="_blank">数据科学简介</a>:数据汇总</li><li id="0eeb" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly pm mm mn mo bi translated">[2] <a class="ae ky" href="https://pbpython.com/pandas-crosstab.html" rel="noopener ugc nofollow" target="_blank">熊猫相声解说</a>来自 pbpython.com</li></ul></div></div>    
</body>
</html>