<html>
<head>
<title>Pattern Matching in Python 3.10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 3.10中的模式匹配</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pattern-matching-in-python-3-10-6124ff2079f0?source=collection_archive---------7-----------------------#2021-06-11">https://towardsdatascience.com/pattern-matching-in-python-3-10-6124ff2079f0?source=collection_archive---------7-----------------------#2021-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1e4c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">类固醇的转换声明</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/953174cf577b6320bc052b86f753f192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LUxYlTc0AOOuHE6Y"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@teowithacamera?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Teo Duldulao </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="1622" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.10实现了<em class="lv"> switch </em>语句——算是吧。C或Java等其他语言中的switch语句对变量进行简单的值匹配，并根据该值执行代码。</p><blockquote class="lw"><p id="8806" class="lx ly it bd lz ma mb mc md me mf lu dk translated">它可以作为一个简单的switch语句使用，但它的功能远不止于此。</p></blockquote><p id="ffe6" class="pw-post-body-paragraph kz la it lb b lc mg ju le lf mh jx lh li mi lk ll lm mj lo lp lq mk ls lt lu im bi translated">这对于C来说可能已经足够好了，但是这是Python，Python 3.10实现了一个更加强大和灵活的结构，叫做<em class="lv">结构模式匹配。</em>它可用作简单的switch语句，但功能远不止于此。</p><p id="69ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们以简单的开关为例。下面是对单个值进行切换的代码片段。我们通过用值1、2、3和4在一个循环中运行它来测试它。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="1fe1" class="mq mr it mm b gy ms mt l mu mv">for thing in [1,2,3,4]:<br/>    match thing:<br/>        case 1:<br/>            print("thing is 1")<br/>        case 2:<br/>            print("thing is 2")<br/>        case 3:<br/>            print("thing is 3")<br/>        case _:<br/>            print("thing is not 1, 2 or 3")</span></pre><p id="da75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先要注意的是语法的整洁。它以关键字<code class="fe mw mx my mm b">match</code>开始，后跟一个变量名。然后是一个以<code class="fe mw mx my mm b">case</code>开头的案例列表，后面是匹配的值。注意冒号和缩进的使用。</p><p id="61a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这与其他语言中的switch/case语句并不相似，但与C不同，例如，在执行了特定case的代码后，控制跳转到<code class="fe mw mx my mm b">match</code>语句的末尾。</p><p id="efaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果不匹配，则执行默认情况下的代码，由<code class="fe mw mx my mm b">-</code>表示。</p><p id="fa05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是结果。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="b7d0" class="mq mr it mm b gy ms mt l mu mv">thing is 1<br/>thing is 2<br/>thing is 3<br/>thing is not 1, 2 or 3</span></pre><p id="be16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没什么好惊讶的。</p><p id="12f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">switch语句是模式匹配的一个简单例子，但是Python做了进一步的发展。看一下这段代码:</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="d469" class="mq mr it mm b gy ms mt l mu mv">for thing in [[1,2],[9,10],[1,2,3],[1],[0,0,0,0,0]]:<br/>    match thing:<br/>        case [x]:<br/>            print(f"single value: {x}")<br/>        case [x,y]:<br/>            print(f"two values: {x} and {y}")<br/>        case [x,y,z]:<br/>            print(f"three values: {x}, {y} and {z}")       <br/>        case _:<br/>            print("too many values")</span></pre><p id="0ddd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这又是一个循环中的<code class="fe mw mx my mm b">match</code>语句，但这次循环将遍历的值列表是列表本身——第一个是<code class="fe mw mx my mm b">[1,2]</code>,然后是<code class="fe mw mx my mm b">[9,10] </code>,依此类推。</p><p id="413c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">case语句试图匹配这些列表。第一种情况匹配单个元素的列表，第二种情况匹配两个元素的列表，第三种情况匹配三个元素的列表。最后一种情况是默认的。</p><p id="14c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但它的作用不止于此。它还绑定与<code class="fe mw mx my mm b">case</code>语句中的标识符匹配的值。例如，第一个列表是<code class="fe mw mx my mm b">[1,2]</code>，它匹配第二个案例<code class="fe mw mx my mm b">[x,y]</code>。因此，在执行的代码中，标识符x和y分别取值1和2。很好，嗯！</p><p id="72d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，结果是这样的:</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="ed1e" class="mq mr it mm b gy ms mt l mu mv">two values: 1 and 2<br/>two values: 9 and 10<br/>three values: 1, 2 and 3<br/>single value: 1<br/>too many values</span></pre><p id="d75d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从第一个简单的程序中我们知道我们可以匹配值，从上面的程序中我们可以匹配更一般的模式。那么我们能匹配包含值的模式吗？当然啦！</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="57cc" class="mq mr it mm b gy ms mt l mu mv">for thing in [[1,2],[9,10],[3,4],[1,2,3],[1],[0,0,0,0,0]]:<br/>    match thing:<br/>        case [x]:<br/>            print(f"single value: {x}")<br/>        case [1,y]:<br/>            print(f"two values: 1 and {y}")<br/>        case [x,10]:<br/>            print(f"two values: {x} and 10")<br/>        case [x,y]:<br/>            print(f"two values: {x} and {y}")<br/>        case [x,y,z]:<br/>            print(f"three values: {x}, {y} and {z}")       <br/>        case _:<br/>            print("too many values")</span></pre><p id="b298" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可以看到，在第二种情况下，我们匹配一个包含两个元素的列表，其中第一个元素的值为1。</p><p id="3084" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下:</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="c6c3" class="mq mr it mm b gy ms mt l mu mv">two values: 1 and 2<br/>two values: 9 and 10<br/>two values: 3 and 4<br/>three values: 1, 2 and 3<br/>single value: 1<br/>too many values</span></pre><p id="0d6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是还有更多。</p><p id="50fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个匹配任意数量元素的列表的程序。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="1507" class="mq mr it mm b gy ms mt l mu mv">for thing in [[1,2,3,4],['a','b','c'],"this won't be matched"]:<br/>    match thing:<br/>        case [*y]:<br/>            for i in y:<br/>                print(i)<br/>        case _:<br/>            print("unknown")</span></pre><p id="67fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第一种情况下，标识符是带星号的，这意味着整个列表可以绑定到它，正如我们看到的，它可以在一个循环中迭代。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="00cf" class="mq mr it mm b gy ms mt l mu mv">1<br/>2<br/>3<br/>4<br/>a<br/>b<br/>c<br/>unknown</span></pre><p id="441f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有更多的内容，但是希望这篇文章已经让您体验了Python 3.10中的结构模式匹配。</p><p id="e884" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">更新:我在这里</em>  <em class="lv">写过更高级的模式匹配</em> <a class="ae ky" rel="noopener" target="_blank" href="/more-advanced-pattern-matching-in-python-3-10-2dbd8598302a"> <em class="lv">。</em></a></p><p id="0dc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="http://python.org" rel="noopener ugc nofollow" target="_blank">Python.org</a>网站上有关于结构模式匹配的完整描述，包括一个教程，在<a class="ae ky" href="https://www.python.org/dev/peps/pep-0636/" rel="noopener ugc nofollow" target="_blank"> PEP 636 </a>中。教程非常好，我鼓励你去读它。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><p id="d1a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了结构模式匹配，Python 3.10还有很多新的发展。几篇文章解释了它们，例如，参见<a class="ng nh ep" href="https://medium.com/u/b9d77a4ca1d1?source=post_page-----6124ff2079f0--------------------------------" rel="noopener" target="_blank">James Briggs</a><a class="ae ky" rel="noopener" target="_blank" href="/new-features-in-python-3-10-66ac05e62fc7">Python 3.10中的新特性</a>。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><p id="3bf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，请注意，3.10仍然只是一个测试版，虽然我上面展示的例子运行得非常好，但是在正式发布之前，你不应该愤怒地使用Python 3.10。</p></div></div>    
</body>
</html>