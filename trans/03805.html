<html>
<head>
<title>How to integrate Quickbooks with your SaaS platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Quickbooks与您的SaaS平台集成</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-integrate-quickbooks-with-your-saas-platform-50e79d997fa7?source=collection_archive---------38-----------------------#2021-03-29">https://towardsdatascience.com/how-to-integrate-quickbooks-with-your-saas-platform-50e79d997fa7?source=collection_archive---------38-----------------------#2021-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="45bb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我如何使用Python构建QBO集成来监控部门收入和成本</h2></div><p id="26a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最近，我的任务是构建一个<a class="ae le" href="https://quickbooks.intuit.com/" rel="noopener ugc nofollow" target="_blank"> Quickbooks Online </a> (QBO)集成来处理损益(P &amp; L)报告，并确定收入、销货成本(COGS)和部门费用——下面是我如何做的。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/a9cb2a7e0dd5deed5af627e46cad94c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lXGeBFMDksWhgHcjao4T1Q.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">来源:<a class="ae le" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank"> unDraw </a></p></figure><p id="662d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文<strong class="kk iu">不是</strong>关于构建OAuth流或使用cron作业从Quickbooks API提取数据。这个过程相对来说是样板，已经被<a class="ae le" href="https://medium.com/agileinsider/how-to-build-a-data-integration-pipeline-without-the-massive-tech-debt-e76d0be74ae0" rel="noopener">工具</a>解决了，比如我将要使用的这个。如果您对自己构建感兴趣，请查看我的文章<a class="ae le" rel="noopener" target="_blank" href="/how-to-integrate-quickbooks-with-python-8be2d69f96cb">中关于使用Singer实现这一点的文章</a>。</p><p id="f50d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相反，本文将带您完成更难的部分——如何理解数据。</p><h1 id="d418" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">获取数据</h1><p id="cdf9" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">正如我上面提到的，在这篇文章中，我将使用<a class="ae le" href="https://hotglue.xyz/" rel="noopener ugc nofollow" target="_blank"> hotglue </a>来处理为SaaS平台构建QBO集成的所有样板文件。这包括:</p><ul class=""><li id="61b0" class="ms mt it kk b kl km ko kp kr mu kv mv kz mw ld mx my mz na bi translated">创建OAuth授权流</li><li id="53c5" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated">允许用户在您的UI中连接Quickbooks并监控连接</li><li id="e1c8" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated">从Quickbooks API中提取必要的数据</li></ul><h2 id="7998" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">创建授权流</h2><p id="6ae9" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">在<a class="ae le" href="https://hotglue.xyz/" rel="noopener ugc nofollow" target="_blank"> hotglue </a>中，我将<a class="ae le" href="https://docs.hotglue.xyz/quickstart/create-a-flow" rel="noopener ugc nofollow" target="_blank">创建一个新的流</a>并添加Quickbooks sandbox作为源。为此，我只需提供我的OAuth凭证并登录到我的<a class="ae le" href="https://developer.intuit.com/app/developer/qbo/docs/develop/sandboxes" rel="noopener ugc nofollow" target="_blank"> Quickbooks沙盒帐户。</a>如果您还没有OAuth凭证，您可以选择“使用测试令牌”</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ns"><img src="../Images/7527be67cea9fb126280b159a8043101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UbBy-u0QoOsSqnr41cgoZw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">创建Quickbooks OAuth流</p></figure><h2 id="1538" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">选择我们需要的数据</h2><p id="849c" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">现在我们可以从Quickbooks中选择我们需要的数据。我们将选择帐户(会计科目表)、项目(产品和服务)、采购(费用)、发票和损益报告。</p><p id="e0fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将为我们提供准确分类交易所需的参考数据。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nt"><img src="../Images/757c2c4b9036caefcb521cc6ccb7dcc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gKb89j9fUwCmImN8Ul2T6Q.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">Quickbooks选定的数据</p></figure><h2 id="e1bc" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">将集成添加到您的UI中</h2><p id="86b4" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">通过一些基本的JavaScript，我能够嵌入<a class="ae le" href="https://docs.hotglue.xyz/quickstart/embed" rel="noopener ugc nofollow" target="_blank"> hotglue widget </a>，它使用户能够连接他们的Quickbooks帐户，刷新同步的数据，并监视它上次刷新的时间。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nu"><img src="../Images/80441f79a6e31c7bd5c720935b01de73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QJv7KWSEJQkEndWtxdSUbA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">嵌入式集成</p></figure><h2 id="4cdd" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">标记交易</h2><p id="8236" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">Quickbooks本身不支持在特定部门或项目下标记事务。为此，我使用Quickbooks类字段来标记部门/项目下的事务。例如，下面的发票被标记为<code class="fe nv nw nx ny b">Pest Control:Project X</code>,意思是害虫控制部门，项目x。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nz"><img src="../Images/64f1f2f192c0bd714b31980c17d31126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Jr8v92psOT5RJiRtxyXCQ.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">使用类别标记Quickbooks发票</p></figure><h1 id="78eb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">处理数据</h1><p id="75af" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">现在是有趣的部分。我们将使用Python脚本，使用<a class="ae le" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>和<a class="ae le" href="https://github.com/hotgluexyz/gluestick" rel="noopener ugc nofollow" target="_blank"> gluestick </a>将Quickbooks中的数据转换成JSON文件，如下所示。</p><h2 id="1d87" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">我们想要生产的东西</h2><p id="bc8c" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">正如您在下面看到的，JSON文件获取了我们P&amp;L报告中的每一笔交易，并将其归类到<code class="fe nv nw nx ny b">Pest Control</code>部门的<code class="fe nv nw nx ny b">Project X</code>下。此外，它将每笔交易分类为<code class="fe nv nw nx ny b">revenue</code>、<code class="fe nv nw nx ny b">cogs</code>(销售成本)、<code class="fe nv nw nx ny b">labor</code>和<code class="fe nv nw nx ny b">costs</code>(费用)。</p><pre class="lg lh li lj gt oa ny ob oc aw od bi"><span id="3c2d" class="ng lw it ny b gy oe of l og oh">{<br/>  "Pest Control": {<br/>    "Project X": {<br/>      "revenues": {<br/>        "2021-11": {<br/>          "Pest Control Services": {<br/>            "Pest Control Services": {<br/>              "Bed Bug Removal": {<br/>                "total": 350,<br/>                "qty": "10",<br/>                "rate": 35<br/>              }<br/>            }<br/>          }<br/>        }<br/>      },<br/>      "cogs": {<br/>        "2021-11": {<br/>          "Supplies &amp; Materials - COGS": {<br/>            "Pest Control Services": {<br/>              "Bed Bug Removal": {<br/>                "total": 100,<br/>                "qty": 1,<br/>                "rate": 100<br/>              }<br/>            }<br/>          }<br/>        }<br/>      },<br/>      "labor": {<br/>        "2021-11": {<br/>          "Employee": {<br/>            "Inspector": {<br/>              "Employee Benefits": 10.8,<br/>              "Payroll Tax": 61.2,<br/>              "Payroll Wage Expenses": 800<br/>            }<br/>          }<br/>        }<br/>      },<br/>      "costs": {<br/>        "2021-11": {<br/>          "Project Expenses": {<br/>            "Automobile": {<br/>              "Fuel": 100<br/>            }<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</span></pre><h2 id="f0cb" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">写剧本</h2><p id="4f67" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">hotglue具有内置功能，可以在每次从Quickbooks API同步新数据时运行Python脚本，并避免再次同步旧数据(增量同步)。</p><p id="1cd7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以浏览下面脚本的每个步骤。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="8190" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您正在使用hotglue创建您的集成，您可以学习如何在<a class="ae le" href="https://docs.hotglue.xyz/transformations-1/basic" rel="noopener ugc nofollow" target="_blank">文档</a>中编写和部署脚本。</p><h1 id="73f8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">一起运行</h1><h2 id="4dcd" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">选择数据应该放在哪里</h2><p id="7809" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">如果你正在使用hotglue，你需要指定一个最终数据交付的地方(一个<a class="ae le" href="https://docs.hotglue.xyz/quickstart/add-a-target" rel="noopener ugc nofollow" target="_blank">目标</a>)。默认情况下，hotglue会使用Mailgun将新数据通过电子邮件发送给您。我使用谷歌云存储来整合我们的Quickbooks。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ok"><img src="../Images/e61dec5733cc58c1bd3d82264b71161c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*es__JdQJCiGBxO4dTtpcHA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">配置Google云存储目标</p></figure><h2 id="a685" class="ng lw it bd lx nh ni dn mb nj nk dp mf kr nl nm mh kv nn no mj kz np nq ml nr bi translated">运行作业</h2><p id="2ad7" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">现在，我们可以运行同步作业了。这将连接到Quickbooks API，查询任何新数据，将其保存为CSV，运行我们的转换脚本，并将结果数据上传到我们的目标(Google云存储)。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/261f8733fe416acdb3d77ab5e7a13c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNsosWwudBttybIxqznZcA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">Quickbooks作业已完成</p></figure><p id="8898" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以在谷歌云存储中看到最终的<code class="fe nv nw nx ny b">actuals.json</code>文件了！</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi om"><img src="../Images/fddaffbc3e4140510ac97c235f5d3f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D0-Q-sGyKoVLuHGatTJHpA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">Google云存储桶中的结果数据</p></figure><h1 id="89f8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="1bff" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">在本文中，我们创建了一个Quickbooks集成，并将生成的CSV数据处理成可供SaaS应用程序使用的JSON有效负载。</p><p id="30c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">希望这有助于您考虑如何构建自己的SaaS集成。我强烈推荐使用像<a class="ae le" href="https://hotglue.xyz/" rel="noopener ugc nofollow" target="_blank"> hotglue </a>这样的工具来处理样板集成步骤，这样您就可以专注于提取您需要的数据，而不是授权和编排问题。</p><p id="92fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读！</p></div></div>    
</body>
</html>