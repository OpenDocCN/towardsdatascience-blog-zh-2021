<html>
<head>
<title>Learn SQL Server Management Studio — Part 8 Leverage The Views</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解SQL Server Management Studio —第8部分利用视图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-sql-server-management-studio-part-8-leverage-the-views-206fbcef3957?source=collection_archive---------18-----------------------#2021-05-01">https://towardsdatascience.com/learn-sql-server-management-studio-part-8-leverage-the-views-206fbcef3957?source=collection_archive---------18-----------------------#2021-05-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cda1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你在派对上开心的技能！循序渐进。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/42ebd0f52d225c81ff12a7c945638ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V08QdO1SH2Ws6qRn"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·泽兹奇在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="5c30" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在最后几集里…</h1><p id="6efc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你好。欢迎来到SQL和SQL Server Studio系列教程的第8期。有一个简单的目标:让你熟悉和适应这个工具和语言。“这有什么关系？”我知道你在问。事实证明，好奇心和副业往往是被新项目选中的关键，甚至是获得新工作的关键。事实上，您已经使用了一个重要的工具，比如SQL Server Studio，并且编写了一些SQL查询，这将会给您一个清晰的开端。</p><ul class=""><li id="b199" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><strong class="lt iu">在第1集</strong>中，我将向您展示<strong class="lt iu">如何设置我们的环境和本地服务器</strong> — <a class="ae ky" rel="noopener" target="_blank" href="/getting-started-with-sql-server-management-studio-part-1-step-by-step-setup-63428650a1e0">第1部分逐步设置SQL Server Studio </a></li><li id="8b5b" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第2集</strong>中，我们将讲述<strong class="lt iu">如何创建自己的数据库、表</strong>、<strong class="lt iu">和</strong>关于<strong class="lt iu">命名约定的重要注释— </strong>、<a class="ae ky" rel="noopener" target="_blank" href="/getting-started-with-sql-server-management-studio-5cd24bb1a87c">第二部分数据库、表&amp;命名约定</a></li><li id="363b" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第三集</strong>中，我们介绍了<strong class="lt iu"> CRUD操作</strong>和<strong class="lt iu">主键和外键</strong> — <a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-3-crud-operations-primary-foreign-keys-9d884b32ad70">第三部分CRUD操作，主键&amp;外键</a></li><li id="383e" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第4集</strong>中，我们讨论了<strong class="lt iu">模式&amp;的主要规范化步骤</strong> — <a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-4-schemas-normalization-80bcd6a5258">第4部分模式&amp;规范化</a></li><li id="2825" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第5集</strong>中，我们覆盖了<strong class="lt iu">存储过程&amp;调度</strong>，这是一个真正的野兽。我怎么强调这将如何促进和自动化你的日常(数据)生活都不为过。<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-5-stored-procedures-scheduling-88fd9788d314">第五部分存储过程&amp;调度</a></li><li id="40f8" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第6集</strong>中，我们介绍了用于ETL 的<strong class="lt iu"> SSIS包，并回顾了如何在两个数据库之间以及一个数据库与Excel之间导入和导出数据。<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-6-ssis-packages-9438dbc90437">第六部SSIS套餐简介</a></strong></li><li id="f9f5" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">在第7集中，我们<strong class="lt iu">将SQL Studio连接到PowerBI </strong>并构建我们的第一个视觉效果。<a class="ae ky" href="http://part%207%20connect%20to%20powerbi%20%26%20first%20visuals/" rel="noopener ugc nofollow" target="_blank">第7部分连接到PowerBI &amp;第一视觉效果</a>。</li></ul><p id="d8c5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">别忘了回来😉。</p><h1 id="e1a2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">期待什么？</h1><p id="7445" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">直到第7集，我们有一个线性的渐进的学习曲线。它从SQL Studio的设置开始，然后我们继续创建数据库、CRUD操作、对话模式、SSIS包、调度和自动化以及连接到PowerBI。现在我们有了一个坚实的基础，让我们看看另一个有趣的特性，视图。这是一个非常简单而强大的工具。在本教程结束时，您将会感到有能力利用视图的力量。让我们直接跳进来吧！</p><h1 id="03a8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是SQL视图？</h1><p id="e227" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">视图是存储在我们环境中的SQL查询。由于视图是一个SQL查询… * <em class="ng"> drumrolls </em> *…它可以被查询。让我们看一个假设的例子:</p><p id="3a5c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">假设您有一组表，并构建一个复杂的连接。留着以后用不是很好吗？我希望你会同意。虽然我们可以将这个连接的结果保存为一个新表，但这可能不是最佳方法。为什么不呢？</p><ul class=""><li id="09c9" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><strong class="lt iu">维护新表</strong> —需要维护连接产生的新表，以保持相关性。当然，我们可以在重新创建新表之前，通过调度一个作业来删除或截断新表。但是这对服务器来说是更多的工作。</li><li id="3071" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">空间是稀缺的，存储是黄金</strong> —作为连接结果的新表的创建也意味着存储现在将被该表占用。应该没问题吧？嗯，如果只是一次性的事情，那也没什么，虽然在野外，没有这样的事情，而且事情可能会很快升级。在一个月或六个月内，您可能会从类似的连接操作中得到10个以上的表。所有这些空间现在都已被占用，需要保持更新。</li></ul><p id="af3d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">相反，如果我们能够利用观点的力量，我们就可以摆脱上述担忧。为什么？</p><ul class=""><li id="9dc9" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">视图只是一个查询。每当更新底层表时，查询视图会自动为我们提供新数据。也就是说，视图提供一致的数据。</li><li id="71ca" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">一个视图本质上是轻量级的，因为它只有几行代码。也就是说，它们是高效的。</li></ul><h1 id="1d79" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">如何构建视图</h1><p id="fb9a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设您已经安装并启动了SQL Studio。</p><ol class=""><li id="76fc" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm nh mv mw mx bi translated">在数据库结构中，指向“表”下的“视图”。</li><li id="50ab" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm nh mv mw mx bi translated">右键单击并选择“新建视图”</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/cdc874dd747a46e61b23d09cc346127c.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*ouHRiRiMWeXtIZIaYybfqA.png"/></div></figure><p id="8f89" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">3.新窗口显示了视图环境，其中有一个弹出窗口提供表的初始选择。这些是我们在前几集创建的表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/c6824ef0993cb7f227f0a98f9fbe5f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_30hhsLhPSsU_WKeZ3mFQ.png"/></div></div></figure><p id="789e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">4.在这个例子中，我们将重点构建一个视图来收集包含部门和雇员的表。选择两者，然后添加，然后关闭。</p><p id="bb99" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">5.因为那些表有主键和外键，我们在<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-3-crud-operations-primary-foreign-keys-9d884b32ad70">第3部分</a>中讨论过，我们可以使用这些关系将它们匹配在一起。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ac7789cd17ba0baac9f65e8e45ae726c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*kVz1se72DPt_Bups6PC3EA.png"/></div></figure><p id="5ca5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">6.然后，我们可以从表中手工选择感兴趣的列，下面的查询会自动更新。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/e520da52fed71f90cd804d11913d757c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UyfTyHaz-mYKub3t6DB7BA.png"/></div></div></figure><p id="3310" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">该查询使用两个表中的Department_ID作为匹配键来构建内部连接。</p><p id="dae1" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">7.然后我们可以保存视图，并给它一个有意义的名字。下面是一个简短的题外话。</p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h2 id="0b4c" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">如何命名视图</h2><p id="9c26" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果您将SQL Server连接到另一个系统，该系统可以显示您存储的所有基础表、视图和存储过程，清楚地区分表和视图的命名约定可能会很有用。一种方法是以大写的V开始命名所有的视图，后面跟着一个下划线_。如果您需要一个视图来匹配用户和他们的购买，我们可以使用V_userspurchases，它与表Users和Purchases明显不同。</p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><p id="45ea" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们将选择V _ DepartmentsEmployees员工。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/c328e4d8ebb715bf1e50c97a1f322026.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*RDa5l9-YxM6BYfLXAM-3dA.png"/></div></figure><p id="0c4b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">8.接下来，让我们通过查询视图来检查它的外观。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="62af" class="nt la it oh b gy ol om l on oo">select * from V_DepartmentsEmployees</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/70dc506dc145b2256863de6f22a360ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2DhtCgBFqPq4X0e5PwYFQ.png"/></div></div></figure><p id="53ea" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">这将返回一个表，这是我们的视图的结果，它连接了两个表。如前所述，这个视图是轻量级的，让我们来看看到底有多轻。</p><h1 id="3d5b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">视图与表格比较</h1><p id="96df" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们之前讨论过，视图的优势在于只是查询，并不存储数据<em class="ng">本身</em>。下面是我们的数据表和SQL脚本的大小之间的一个快速的&amp;比较。对于这个例子，表的大小是7行x 163列。该查询是一行代码:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="8670" class="nt la it oh b gy ol om l on oo">select * from v_SalesQuota</span></pre><p id="32e1" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">在我们的快速和脏比较之后的SQL查询重约262字节。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/a50db38ace039719745f04a860db073c.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*mLb8LO3tjMqIONKPLIvw2w.png"/></div></figure><p id="5097" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">现在对于底层数据(7行x 163列，没有空值也没有空白)，导出为。CSV，我们的快速和肮脏的方法显示约9933字节。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/4bf58d67b00de1623c0d3defa73611be.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*BHVsP-lM2IwVRYTwhEY0_g.png"/></div></figure><p id="28a4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们可以采用另一种方法，找出SQL Server中某个元素占用的空间。为此:</p><ol class=""><li id="2fd4" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm nh mv mw mx bi translated">通过CTRL+N打开一个新的查询窗口</li><li id="1dc6" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm nh mv mw mx bi translated">键入以下命令</li></ol><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="2e2d" class="nt la it oh b gy ol om l on oo">sp_spaceused '[TableName]'</span></pre><p id="5dda" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">这将返回关于我们的表的一些信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/1db460c719531f61bf40063bf62ff586.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*amdbVuShJ9v0b-pzKz_3mA.png"/></div></figure><p id="1dd1" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们可以对我们的视图做同样的事情:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="0872" class="nt la it oh b gy ol om l on oo">sp_spaceused '[AW2019].[dbo].[v_SalesQuota]'</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/96dd3598a331bb89f0f3bde8599973b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*1SsjcgNcuK6r21PRlN4cwA.png"/></div></figure><p id="75fb" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">正如我们所见，视图不是表，它不包含任何数据，它只是一段轻量级代码。</p><h1 id="6d55" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">最后的话和接下来会发生什么</h1><p id="44a3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">暂时就这样吧！我希望您现在对在SQL Server中创建和利用视图更有信心了。</p><ul class=""><li id="8e25" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">视图是轻量级的，它们是存储在SQL Server上的查询，可以被查询。因此，它们不保存任何数据。</li><li id="4df6" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">与通过连接创建表相比，它们是更好的选择，</li><li id="c1e2" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">它们不需要像连接产生的表那样被“维护”。无论何时查询，视图都会从基础表中提取数据。请注意，如果基础表发生变化，视图使用的列被删除，视图将会中断。</li></ul><p id="e5ea" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">下一步是什么？我们将讨论临时表的主题。</p><p id="be3a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">感谢您的阅读，请告诉我您的想法，或者是否有我应该涉及的话题。下次见！</p><h1 id="4e64" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">编码快乐！</h1></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><p id="3234" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">感谢阅读！喜欢这个故事吗？<a class="ae ky" href="https://medium.com/@maximegodfroid/membership" rel="noopener"> <strong class="lt iu">加入媒介</strong> </a>获取完整的我的所有故事。</p></div></div>    
</body>
</html>