<html>
<head>
<title>Significance or Hypothesis Tests with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行显著性或假设检验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6?source=collection_archive---------22-----------------------#2021-07-01">https://towardsdatascience.com/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6?source=collection_archive---------22-----------------------#2021-07-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="22cd" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="44d8" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用Python实现大学统计</h2></div><h1 id="1ed6" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">介绍</h1><p id="4a02" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在一系列的每周文章中，我将会涉及一些重要的统计学主题。</p><p id="8ec8" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">目标是使用Python来帮助我们获得对复杂概念的直觉，从经验上测试理论证明，或者从零开始构建算法。在本系列中，您将会看到涵盖随机变量、抽样分布、置信区间、显著性检验等主题的文章。</p><p id="1db5" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">在每篇文章的最后，你可以找到练习来测试你的知识。解决方案将在下周的文章中分享。</p><p id="9821" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">迄今发表的文章:</p><ul class=""><li id="fbec" class="mk ml it ll b lm mf lp mg ls mm lw mn ma mo me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/bernoulli-and-binomial-random-variables-d0698288dd36">伯努利和二项随机变量用Python编写</a></li><li id="a180" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55">用Python从二项式到几何和泊松随机变量</a></li><li id="b1df" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/sampling-distributions-with-python-f5a5f268f636">用Python实现样本比例的抽样分布</a></li><li id="83d3" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/confidence-intervals-with-python-bfa28ebb81c">Python的置信区间</a></li><li id="5eab" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6">使用Python进行显著性测试</a></li><li id="b25d" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9">用Python进行组间差异的双样本推断</a></li><li id="b3e9" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/inference-for-categorical-data-9f3c6034aa57">分类数据的推断</a></li><li id="5520" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/advanced-regression-f74090014f3">高级回归</a></li><li id="8fc4" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/analysis-of-variance-anova-8dc889d2fc3a">方差分析— ANOVA </a></li></ul><p id="bbab" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">像往常一样，代码可以在我的<a class="ae mt" href="https://github.com/luisroque/College_Statistics_with_Python" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h1 id="51b9" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">假设检验简介</h1><p id="b18c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">安东尼奥和4个朋友一起度过了30天的假期，他们想决定每晚谁来做饭。安东尼奥提议他们可以写下自己的名字，并把它们储存在一个碗里。然后，他会从一个碗里随机抽取一个名字，上来的名字必须是当天晚上做晚饭的。现在，假设在4轮随机选择名字后，安东尼奥的名字再也没有出现。剩下的朋友开始怀疑发生了什么事。让我们来计算一下这个概率。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="993d" class="ni ks it ne b gy nj nk l nl nm">0.80**4</span><span id="a56f" class="ni ks it ne b gy nn nk l nl nm">0.4096000000000001</span></pre><p id="48e9" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">我们可以看到，这种情况有接近41%的概率发生。这是一个非常重要的概率，因此朋友小组可能应该信任安东尼奥。现在，想象一下15轮过后，安东尼奥仍然没有被选中。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="9101" class="ni ks it ne b gy nj nk l nl nm">0.8**15</span><span id="d502" class="ni ks it ne b gy nn nk l nl nm">0.03518437208883203</span></pre><p id="d684" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">假设这个过程是完全随机的，他连续15轮没被选中的概率大概是3.5%。如果他的朋友使用通常定义的5%的阈值，他们不会想到纯粹偶然发生的事件的概率小于5%。然后，他们可能会拒绝这是一个真正随机过程的假设，这意味着安东尼奥在作弊。</p><h1 id="9c38" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">关于总体比例的假设检验</h1><figure class="mz na nb nc gt np gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi no"><img src="../Images/a763eeb66a8e6f5f6c78e2cbdb5da320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sNu-59Hzn1eA8P8K"/></div></div><p class="nw nx gj gh gi ny nz bd b be z dk translated">图1:安东尼奥和他的朋友在海滩上思考统计数据；<a class="ae mt" href="https://unsplash.com/photos/OAnydGhhcxE" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="c946" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">一天，在海滩上，安东尼奥在一本杂志上读到一篇文章，文章称只有30%的人在海滩上使用防晒霜。安东尼奥认为这个数字对于他们度假的海滩地区来说太低了。他告诉了他的朋友，他们决定从附近的海滩随机抽取35人，他们估计当天至少有400人在享受海滩。这35人中，有14人使用了防晒霜。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="891c" class="ni ks it ne b gy nj nk l nl nm">14/35</span><span id="ff60" class="ni ks it ne b gy nn nk l nl nm">0.4</span></pre><p id="aff7" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">让我们更正式地定义我们的假设检验:</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/af163c96a69ed9b55f59e70a1bfc5089.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*AMxUDVSChl0kjqEvjpQqGQ.png"/></div></figure><p id="8b60" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">零假设显示了预期的结果，假设只有30%的人在海滩使用防晒霜。另一方面，另一个假设陈述了安东尼奥的怀疑:超过30%的人实际上在使用防晒霜。</p><p id="dc5a" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">让我们进行一次模拟，看看像上面这样的样本随机发生的可能性有多大。我们模拟了40个样本，样本量等于30，其中40%的人使用了防晒霜。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="fcab" class="ni ks it ne b gy nj nk l nl nm">from scipy.stats import bernoulli, norm, t<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>import seaborn as sns</span><span id="0cb0" class="ni ks it ne b gy nn nk l nl nm">x = np.zeros((40, 35))<br/>for i in range(40):    <br/>    x[i] = bernoulli.rvs(p=0.3, size=35)</span></pre><p id="e338" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">我们可以用柱状图来描绘我们的模拟。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="b874" class="ni ks it ne b gy nj nk l nl nm">sns.histplot(np.mean(x, axis=1));</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/df7a61b5621c3a8b63e1dc9fb0310027.png" data-original-src="https://miro.medium.com/v2/format:webp/1*vuv3zjRz4FKbio4hrhl16w.png"/></div><p class="nw nx gj gh gi ny nz bd b be z dk translated">图2:样本大小等于30的模拟样本(40)的直方图。</p></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="11a9" class="ni ks it ne b gy nj nk l nl nm">p = np.mean(x, axis=1)</span></pre><p id="3ee0" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">有了这些信息，我们就可以计算我们的p值。它可以定义为p̂大于或等于0.4的抽样比例的概率，以h0为真为条件:</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/695956a516d5a1305c45cffb0588ac09.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*roqut-KGwapAHpRyS1l7xQ.png"/></div></figure><p id="2e07" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">我们可以很容易地计算出p值。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="f310" class="ni ks it ne b gy nj nk l nl nm">p[p&gt;=0.40].shape[0]/p.shape[0]</span><span id="021e" class="ni ks it ne b gy nn nk l nl nm">0.125</span></pre><p id="3c7d" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">如果安东尼奥使用α=0.05的显著性水平，他不会拒绝H_0。这意味着，在p̂ = 0.4的情况下，他们没有足够的证据来否定只有30%的人使用防晒霜的可能性，而他们得到的40%的统计数据只是随机的结果。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="341a" class="ni ks it ne b gy nj nk l nl nm">if (p[p&gt;=0.4].shape[0]/p.shape[0]&lt;0.05):<br/>    print('Reject H_0')<br/>else:<br/>    print('Do not reject H_0')</span><span id="7198" class="ni ks it ne b gy nn nk l nl nm">Do not reject H_0</span></pre><h1 id="c887" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">关于比例的Z检验的条件</h1><p id="4d9d" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们在以前的文章中看到了执行z测试的条件。这三个条件是:</p><ul class=""><li id="03b4" class="mk ml it ll b lm mf lp mg ls mm lw mn ma mo me mp mq mr ms bi translated">样本必须是随机的。</li><li id="2ad0" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated">正态分布可以近似样本比例的抽样分布。经验法则是，你至少需要有10次成功和10次失败。</li><li id="2447" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated">要求样本是独立的。经验法则是，如果你是在没有替换的情况下抽样，你的样本量应该少于总体量的10%。</li></ul><p id="5e77" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">让我们完成前面的例子，并对每种情况进行测试。从随机抽样开始，我们被告知，朋友小组随机选择要问的人。有了这些信息，我们将假设他们的过程是真正随机的。正常情况告诉我们，预期的成功和失败次数至少需要等于10次。我们也能够满足该标准(参见下面的计算)。最后，我们有独立的条件。在我们的例子中，人口数量是海滩地区的人口，大约400人。使用的样本大小为35，因此我们也可以满足执行z检验的条件。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="09d0" class="ni ks it ne b gy nj nk l nl nm">n = 35<br/>p = 0.3<br/><br/>print('np = '+ str(n*p))<br/>print('n(1-p) = '+ str(n*(1-p)))</span><span id="3dae" class="ni ks it ne b gy nn nk l nl nm">np = 10.5<br/>n(1-p) = 24.5</span></pre><h1 id="6b6f" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">在关于比例的测试中计算z统计量</h1><p id="e70e" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们将继续使用我们的防晒霜问题。在上一节中，我们检查了推断的所有条件都得到了满足。在这种情况下，我们将执行z测试。</p><p id="cb0a" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">在继续之前，让我们回忆一下我们的目标。安东尼奥和他的朋友们从海滩地区的所有人口中抽取了35人作为样本，并计算出样本统计̂p= 40%。现在，假设零假设为真，得到一个离假设的人口比例p=30%这么远或者更远的结果的概率是多少。</p><p id="85c9" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">计算这种概率的一种方法是通过计算抽样比例与真实比例相差多少标准差(记住我们总是假设h0为真，所以我们认为是真实比例)。</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi od"><img src="../Images/9d699eeb304ce4965f474f611ab253e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*u9yu1HYlwOuuXW7bDEk45A.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="5aab" class="ni ks it ne b gy nj nk l nl nm">p_0 = 0.3<br/>p_hat = 0.4<br/><br/>Z = (0.4-0.3)/np.sqrt((0.3*(1-0.3)/n))<br/>Z</span><span id="a57f" class="ni ks it ne b gy nn nk l nl nm">1.290994448735806</span></pre><p id="c210" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">我们的p值可以定义为:</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/178ab9183aff22bb059c7a7e405f3435.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*XU01ifTmFhCDqXcXJku6dg.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="ef67" class="ni ks it ne b gy nj nk l nl nm">1-norm.cdf(Z)</span><span id="5ac7" class="ni ks it ne b gy nn nk l nl nm">0.09835280122947343</span></pre><p id="77f8" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">将我们得到的这个概率与α=0.05的显著性水平相比较，我们再次看到，我们不能拒绝H_0。</p><h1 id="9054" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">关于总体均值的假设检验</h1><p id="8b16" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">一天晚上，安东尼奥正在查看他的手机，并开始想知道他和他的朋友在WhatsApp群聊中交换了多少条消息，他们在度假前3个月就建立了这个群聊。他怀疑他们平均每天会互相发送180条信息，但他的一个朋友认为他们交换了超过180条信息。他们决定检验这个理论。</p><p id="0185" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">让我们定义我们的显著性测试:</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi of"><img src="../Images/c3f515cec4ee95f36494dc529ef449a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*OlBMlFIsTiVYTANT3pIxjw.png"/></div></figure><p id="1c76" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">他们从聊天记录中随机抽取了8天的样本，并记录了这些天发送了多少条消息。样本数据大致对称，平均值为215条消息，标准偏差约为36条消息。他们想用5%的显著性水平来检验他们的假设。</p><p id="f9b8" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">正如我们之前看到的，在这种情况下，我们将执行t检验，而不是z检验。原因是我们不知道样本均值的抽样分布的标准偏差</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi og"><img src="../Images/74c929f4cba6f4b2e067ffc38663303b.png" data-original-src="https://miro.medium.com/v2/resize:fit:64/format:webp/1*mY_n4RDkewHsV-df5JAnCg.png"/></div></figure><p id="3b4a" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">我们只能用抽样标准差来估计它</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/132be66022e653030f60ffaa479c5bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:62/format:webp/1*JblYQlOk93YTNzGDERv9pQ.png"/></div></figure><p id="28ba" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">然后，我们可以将测试写成:</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/c92947805c934b2f292ec861b15229ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/format:webp/1*GqWvh8YRTo81b8IN9U763A.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="fde8" class="ni ks it ne b gy nj nk l nl nm">x = [266, 190, 161, 191, 241, 180, 240, 251]<br/>x = np.asarray(x)<br/>sns.histplot(x, bins=10);</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/0ecaa0784f4c280a884f224b2d5576a1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*5wvhdKERgNf2ojLElNqSng.png"/></div><p class="nw nx gj gh gi ny nz bd b be z dk translated">图3:随机抽样的邮件数量直方图。</p></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="7f32" class="ni ks it ne b gy nj nk l nl nm">print(x.mean())<br/>print(x.std())</span><span id="c4e3" class="ni ks it ne b gy nn nk l nl nm">215.0<br/>36.29738282576307</span><span id="1ceb" class="ni ks it ne b gy nn nk l nl nm">μ = 180<br/>n = 8<br/><br/>t_star = (x.mean()-μ)/(x.std()/np.sqrt(n))<br/>t_star</span><span id="4508" class="ni ks it ne b gy nn nk l nl nm">2.727330227672841</span><span id="0d91" class="ni ks it ne b gy nn nk l nl nm">1-t.cdf(t_star, df=n-1)</span><span id="d9c1" class="ni ks it ne b gy nn nk l nl nm">0.01472601649385541</span></pre><p id="5dce" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">我们的p值约为0.015，小于我们的显著性水平。这意味着我们可以拒绝安东尼奥提出的H_0，而接受替代假说。有足够的证据接受安东尼奥的朋友的假设，即该小组每天发送超过180条消息。</p><h1 id="382e" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">关于总体均值的t检验的条件</h1><p id="843a" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们在以前的文章中看到了执行t检验的条件。这三个条件是:</p><ul class=""><li id="5e25" class="mk ml it ll b lm mf lp mg ls mm lw mn ma mo me mp mq mr ms bi translated">样本必须是随机的。</li><li id="3f9a" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated">样本均值的抽样分布可以近似为正态分布。有三种方法可以实现它:样本量大于30(中心极限定理适用)，原始分布是正态分布，或采样分布是对称的，不显示异常值。</li><li id="76bd" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated">要求样本是独立的。经验法则是，如果你是在没有替换的情况下抽样，你的样本量应该少于总体量的10%。</li></ul><p id="6f6d" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">让我们再一次针对每一种情况测试我们之前解决的问题。这将使我们更加确信结果在某种程度上不会有偏差。我们被告知安东尼奥和他的朋友随机选择日期，这符合第一个标准。其次，我们的样本分布大致对称，可以认为正态条件也满足。最后，安东尼奥和他的朋友使用了8的样本量。我们被告知，他们在度假前3个月就已经建立了WhatsApp群聊。样本量少于10%，因此可以安全地假设取样日之间的独立性，即使它们是在没有替换的情况下取样的。</p><h1 id="1124" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">第一类和第二类错误</h1><p id="f9c3" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们已经看到，如果p值小于显著性水平α，我们应该拒绝H_0。反之，如果p值大于α，我们就不能拒绝H_0。当我们进行这些比较时，总有可能出错。让我们画一个表，让它更清楚。</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/9c05127e0b1e0ba10d975cc16a4df9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*iMSWotdEpISl2RqHGr0WOA.png"/></div><p class="nw nx gj gh gi ny nz bd b be z dk translated">表1:与实际和预测结果相关的I型和II型误差。</p></figure><p id="fa06" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">请注意，出现I类错误的概率等于显著性水平。假设您定义了5%的显著性水平。这意味着，在5%的情况下，即使你的零假设是真的，你也会得到一个让你拒绝零假设的统计数据。</p><p id="bd51" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">在前面给出的例子中，第一类和第二类错误是什么？让我们再次写下使用防晒霜人群比例的假设检验:</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/3efaa7bf30f79af7c612992082bb5c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*t-FsxEKhSn5KgutaoQKJuA.png"/></div></figure><p id="6556" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">如果朋友们得出结论，使用防晒霜的人的比例不等于0.3，而实际上是0.3，那么就会发生第一类错误。另一方面，第二类错误是人们的比例不等于0.3，但他们没有拒绝它。</p><p id="0311" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">另一个需要定义的重要概念是显著性检验的功效。它是当假设不成立时，你拒绝零假设的概率。</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/a91ef1533e9b6a3506d607eee0990f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*S6tzEYawFGn1xkfy8grr0g.png"/></div></figure><p id="9c53" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">请注意</p><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="gh gi om"><img src="../Images/60e6166fce1bd79b162c4ad28c210741.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*C_0UocoNWMP7qRXpQakeLQ.png"/></div></figure><p id="05d6" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">实际上是犯第二类错误的概率，所以你可以把显著性检验的功效看作是<strong class="ll jd">而不是</strong>犯第二类错误的概率。</p><p id="34ea" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">让我们看看我们能做些什么来增强假设检验的能力:</p><ul class=""><li id="3a5f" class="mk ml it ll b lm mf lp mg ls mm lw mn ma mo me mp mq mr ms bi translated">提高显著性水平(但请注意，这也将增加I类错误的概率)。</li><li id="dc0a" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated">增加样本量。</li><li id="657c" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated">数据的可变性更小。</li><li id="a0ba" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me mp mq mr ms bi translated">如果真参数远离零假设。</li></ul><h1 id="51bd" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">结论</h1><p id="093b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在本文中，我们讨论了显著性或假设检验。这对于使用抽样数据来评估关于总体值的索赔的可能性非常有用。要测试的值可以是总体的比例或平均值。我们分别使用z检验和t检验计算了两种情况下的p值。</p><p id="a7cd" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">我们还解决了在执行这些测试时可能发生的错误。类型I错误的发生概率与定义的显著性水平相同，并转化为对实际为真的零假设的拒绝。当我们不能拒绝一个无效假设，并且它是错误的，我们就产生了第二类错误。最后，我们将显著性检验的功效定义为不犯第二类错误的概率，并找到了提高它的方法。</p><p id="3951" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">保持联系:<a class="ae mt" href="https://www.linkedin.com/in/luisbrasroque/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><h1 id="d90a" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">练习</h1><p id="cae9" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">你将在下周的文章中找到答案。</p><ol class=""><li id="0557" class="mk ml it ll b lm mf lp mg ls mm lw mn ma mo me on mq mr ms bi translated">根据去年的一项大型民意调查，波尔图大约85%的房屋都接入了高速互联网。Marco想知道这一比例是否发生了变化，他随机抽样调查了80栋房子，发现其中75栋可以接入高速互联网。他想用这个样本数据来检验这个比例是否真的发生了变化。假设推断条件满足，考虑到1%的显著性水平，您对拥有高速互联网的房屋比例会得出什么结论？</li><li id="9c30" class="mk ml it ll b lm mu lp mv ls mw lw mx ma my me on mq mr ms bi translated">玛尔塔拥有一家水果店，每周都会收到西瓜。供应商声称它们应该重1公斤。Marta决定对随机抽取的100个西瓜进行称重，发现平均重量为850克，标准偏差为200克。她想用这个样本数据来测试平均值是否小于供应商声称的平均值，如果是这样，就重新协商他们的合同。假设推断的条件满足，Marta应该怎么做(考虑5%的显著性水平)？</li></ol><h2 id="c438" class="ni ks it bd kt oo op dn kx oq or dp lb ls os ot ld lw ou ov lf ma ow ox lh iz bi translated">上周的答案</h2><ol class=""><li id="2228" class="mk ml it ll b lm ln lp lq ls oy lw oz ma pa me on mq mr ms bi translated">更改函数<code class="fe pb pc pd ne b">confidence_interval_mean_t</code>并构建5个不同的实验来计算样本均值的95%区间，其中3个不满足t区间的条件，2个满足。对于不满足条件的3，定义以下情况:抽样不随机，原始分布不近似正态，不满足独立性。对于满足条件的两种情况，定义一种情况下原始分布是正态分布，另一种情况下原始分布是偏斜的，但采样均值是正态分布。对于后两种情况，真正的总体均值应该包含在95%的计算置信区间内。</li></ol><p id="b9cb" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><em class="pe">提示:您可能会发现使用</em> <code class="fe pb pc pd ne b"><em class="pe">scipy</em></code> <em class="pe">中的</em> <code class="fe pb pc pd ne b"><em class="pe">skewnorm</em></code> <em class="pe">函数很有用。下面，您有一个正态分布的修改版本，由偏斜度参数、平均值和标准偏差来偏斜。</em></p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="5152" class="ni ks it ne b gy nj nk l nl nm"># code adapted from https://stackoverflow.com/questions/49367436/scipy-skewnorm-mean-not-matching-theory<br/><br/>skew = 4.0<br/>mean = 2<br/>stdev = 0.5<br/><br/>delta = skew / math.sqrt(1. + math.pow(skew, 2.))<br/>adjStdev = math.sqrt(math.pow(stdev, 2.) / (1. - 2. * math.pow(delta, 2.) / math.pi))<br/>adjMean = mean - adjStdev * math.sqrt(2. / math.pi) * delta<br/><br/>print('target mean={:.4f} actual mean={:.4f}'.format(mean, float(skewnorm.stats(skew, loc=adjMean, scale=adjStdev, moments='mvsk')[0])))<br/>print('target stdev={:.4f} actual stdev={:.4f}'.format(stdev, math.sqrt(float(skewnorm.stats(skew, loc=adjMean, scale=adjStdev, moments='mvsk')[1]))))</span><span id="4809" class="ni ks it ne b gy nn nk l nl nm">target mean=2.0000 actual mean=2.0000<br/>target stdev=0.5000 actual stdev=0.5000</span><span id="97ea" class="ni ks it ne b gy nn nk l nl nm"># Original skewed distribution<br/><br/>plt.hist(skewnorm.rvs(a = skew, loc=adjMean, scale=adjStdev, size=2000), bins=50);</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/03e5bacdb509828cf3e413b4d2c141b9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*l6oum0hE81WKHtpd_ml-VQ.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="adb6" class="ni ks it ne b gy nj nk l nl nm"># Approximately normal distribution of the sample mean because sample <br/># size is bigger than 30 (CTL applies)<br/><br/>plt.hist(np.mean([skewnorm.rvs(a = skew, loc=adjMean, scale=adjStdev, size=35) for _ in range(2000)], axis=1), bins=50);</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/55fa7aef7c9c05e262a35f64b1e4ed8b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*J2LT9oPOYNQQBj_bWyqqlg.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="c1a8" class="ni ks it ne b gy nj nk l nl nm">def confidence_interval_mean_t(μ, σ, n, number_trials, N, ci=0.95, sample='random', dist='normal'):<br/>    <br/>    skew = 4.0<br/>    mean = μ<br/>    stdev = σ<br/><br/>    delta = skew / math.sqrt(1. + math.pow(skew, 2.))<br/>    adjStdev = math.sqrt(math.pow(stdev, 2.) / (1. - 2. * math.pow(delta, 2.) / math.pi))<br/>    adjMean = mean - adjStdev * math.sqrt(2. / math.pi) * delta<br/>    <br/>    if dist!='normal':<br/>        x_ = skewnorm.rvs(a = 4, loc=adjMean, scale=adjStdev, size=N)<br/>    else:<br/>        x_ = norm.rvs(loc=μ, scale=σ, size=N)<br/><br/>    x_hat_list = []<br/>    SE_hat_x_list = []<br/>    <br/>    if sample!='random':<br/>        # Inducing bias on the sampling<br/>        x_.sort()<br/>        x_ = x_[:-int(0.2*N)]<br/>        np.random.shuffle(x_)<br/>    <br/>    for i in range(number_trials):<br/>        s_ = np.random.choice(x_, n, replace=False)<br/>        x_hat = np.mean(s_)<br/>        x_hat_list.append(x_hat)<br/>        SE_hat_x_list.append(t.ppf(ci+(1-ci)/2, df=n-1)*np.std(s_)/np.sqrt(n))<br/>    <br/>    plt.hist(x_hat_list, bins=50)<br/><br/>    j=0<br/>    _, ax = plt.subplots(1, 1, figsize=(6, 8))<br/>    for i in range(len(x_hat_list)):<br/>        if (μ&gt;x_hat_list[i]-SE_hat_x_list[i]) &amp; (μ&lt;x_hat_list[i]+SE_hat_x_list[i]):<br/>            # interval contains p<br/>            if i &gt; len(x_hat_list)-50:<br/>                ax.errorbar(x_hat_list[i], np.arange(len(x_hat_list))[i],lolims=True, xerr=SE_hat_x_list[i], yerr=0.0, linestyle='', c='black')<br/>            j +=1<br/>        else:<br/>            # interval does not contain p<br/>            if i &gt; len(x_hat_list)-50:    <br/>                ax.errorbar(x_hat_list[i], np.arange(len(x_hat_list))[i],lolims=True, xerr=SE_hat_x_list[i], yerr=0.0, linestyle='', c='red')<br/>    ax.axvline(μ, color='darkorange')<br/>    #plt.xlim(0,1)<br/>    plt.show()<br/>    print(f'{j}/{number_trials}={np.round(j/number_trials,2)}')</span><span id="21c2" class="ni ks it ne b gy nn nk l nl nm"># Not random sampling<br/>confidence_interval_mean_t(μ=2, σ=0.5, n=35, number_trials=1000, N=500, sample='not_random')</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/0a97b555efde5979d591e42338eee091.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dGJiYG6izOUdFB1yHkIiqA.png"/></div></figure><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/ea609e57cb1f20ac4cbe027c83e31533.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1BkizPyQecCthG7I-kIViw.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="6c5f" class="ni ks it ne b gy nj nk l nl nm">191/1000=0.19</span><span id="3c6a" class="ni ks it ne b gy nn nk l nl nm"># not approximately normal dist<br/>confidence_interval_mean_t(μ=2, σ=0.5, n=15, number_trials=1000, N=500, dist='not normal')</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/69c7134f82784d007340262804cec4c4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*k-AGP-G8ViNoZtZJDbdHtA.png"/></div></figure><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/d697a5bbb0ce8ac844489d49d2943a5a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*um3h8snpYVdYusIbbfsaHA.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="71ed" class="ni ks it ne b gy nj nk l nl nm">944/1000=0.94</span><span id="18b8" class="ni ks it ne b gy nn nk l nl nm"># not independent samples<br/>confidence_interval_mean_t(μ=2, σ=0.5, n=150, number_trials=1000, N=600, dist='not normal')</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/98c262fa6c2b14cb6ae08ce7df2c1911.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-jNl_F8S-CoQE1yAsiRE_w.png"/></div></figure><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/c9503b3f39f33fb628cce9027e24c913.png" data-original-src="https://miro.medium.com/v2/format:webp/1*DsRqOlEwDu6XgpzCyLPDdw.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="6aa6" class="ni ks it ne b gy nj nk l nl nm">973/1000=0.97</span><span id="5594" class="ni ks it ne b gy nn nk l nl nm"># Not normal distribution but n &gt;= 30, so CTL applies; all other conditions are met<br/>confidence_interval_mean_t(μ=2, σ=0.5, n=35, number_trials=1000, N=500, dist='not normal')</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/a29225a29994dc88d32f2ca39683c346.png" data-original-src="https://miro.medium.com/v2/format:webp/1*L7SwlO9N7S9y9f4P_KbVBg.png"/></div></figure><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/3075e507b1988390fb581bf25385d6ec.png" data-original-src="https://miro.medium.com/v2/format:webp/1*RMlN5jf5-bjhcyke1v9-2g.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="8239" class="ni ks it ne b gy nj nk l nl nm">947/1000=0.95</span><span id="299d" class="ni ks it ne b gy nn nk l nl nm"># Original distribution is normal; all other conditions are met<br/>confidence_interval_mean_t(μ=2, σ=0.5, n=35, number_trials=1000, N=500)</span></pre><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/8b0dddccd1f83d5e211cb8f2ba3745ad.png" data-original-src="https://miro.medium.com/v2/format:webp/1*bih6ocIjDA_h_ZrVpOBE9Q.png"/></div></figure><figure class="mz na nb nc gt np gh gi paragraph-image"><div class="ab gu cl ob"><img src="../Images/aaf7881fb6c0626d46e6b6a77d99ca0d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*WrftXkcmkHcT8-sPyFJxLQ.png"/></div></figure><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="2467" class="ni ks it ne b gy nj nk l nl nm">930/1000=0.93</span></pre></div></div>    
</body>
</html>