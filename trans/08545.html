<html>
<head>
<title>Multi Page Document Classification using Machine Learning and NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习和自然语言处理的多页文档分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/multi-page-document-classification-using-machine-learning-and-nlp-ba6151405c03?source=collection_archive---------0-----------------------#2021-08-07">https://towardsdatascience.com/multi-page-document-classification-using-machine-learning-and-nlp-ba6151405c03?source=collection_archive---------0-----------------------#2021-08-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="58cf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一种对具有不同变化形状、文本和页面大小的文档进行分类的方法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c1ba75fd730ac39f1474495d52c9c524.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhL_PYvVwg0K-mi2RYIa2g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:https://unsplash.com/photos/5cFwQ-WMcJU</p></figure><p id="ae7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文描述了一种新颖的<strong class="ky ir">多页文档分类</strong>解决方案，它利用高级机器学习和文本分析来解决抵押贷款行业的一个主要挑战。</p><h1 id="278a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">摘要</h1><p id="f3d2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">即使在今天的技术时代，大部分业务都是使用文档完成的，涉及的文书工作数量会因行业而异。这些行业中的许多需要通过<strong class="ky ir">扫描文档图像</strong> ( <em class="mp">通常包含不可选择的文本</em>)来获得关键索引字段的信息，以操作他们的日常任务。</p><p id="c1bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了实现这一点，第一个主要任务是索引不同类型的文档，这有助于从各种复杂的文档中提取信息和元数据。这篇博文将展示如何利用<em class="mp">高级机器学习和NLP技术</em>来解决这个难题的主要部分，正式名称为<strong class="ky ir">文档分类。</strong></p><h1 id="2967" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">介绍</h1><p id="91ee" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在<strong class="ky ir">抵押贷款行业</strong>，不同的公司执行<strong class="ky ir">数千人的抵押贷款审核</strong>。</p><p id="ceb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个单独的审计都是针对各种文件进行的，这些文件作为一个捆绑包提交，称为<strong class="ky ir">贷款包</strong>。一个包是扫描页面的组合，可以从<strong class="ky ir">(100–400 ~)页</strong>变化。包内有多个子组件，可能由<strong class="ky ir">(1–30 ~)页</strong>组成。这些子组件被称为<strong class="ky ir">文档</strong>或<strong class="ky ir">文档类别</strong>。下表直观地说明了这一点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/003b76e9f1114099d8389ab4875d4e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P6BghoNH9LglgNV3SiDTVg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">第二行代表一个包，数字显示该包中存在的有序页面。第三行显示包中不同种类文档的出现。</p></figure><h2 id="a1f3" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">背景和问题陈述</h2><p id="6bfb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">传统上，在评估贷款审计时，<strong class="ky ir">文档分类</strong>是人工工作的主要部分之一<strong class="ky ir">。</strong>抵押贷款公司大多将这项工作外包给第三方BPO公司，这些公司通过使用手动或部分自动化的分类技术(即规则引擎、模板匹配)来执行这项任务。当前实现所面临的根本问题是业务流程外包(<strong class="ky ir"> BPO </strong>)人员必须手动查找和分类包中存在的文档。</p><p id="aeb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管很少有第三方公司使用关键字搜索、正则表达式等来实现某种程度的自动化。这种解决方案的准确性和鲁棒性是有问题的，并且它们的人工工作量减少仍然不令人满意。<strong class="ky ir"> <em class="mp">关键字搜索和正则表达式</em> </strong>意味着这些解决方案需要考虑所呈现的每个新文档或文档变体，并且还需要为此添加规则。这本身就变成了手工操作，只能实现部分自动化。系统仍有可能将文档类标识为“<strong class="ky ir"> Doc </strong> <strong class="ky ir"> A </strong>”，但实际上它是“<strong class="ky ir"> Doc </strong> <strong class="ky ir"> B </strong>”，因为两者中存在共同的规则。此外，身份识别也没有确定性。通常情况下，仍然需要手动验证。</p><p id="351f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有几百种文档类型，BPO人员需要有一个“<strong class="ky ir"> <em class="mp">的知识库，知道某个文档是什么样子，同一文档有哪些不同的变体？”，</em> </strong>以便对文档进行分类。最重要的是，如果人工工作太多，人为错误往往会增加。</p><h2 id="19bd" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">目标</h2><blockquote class="nd"><p id="81c4" class="ne nf iq bd ng nh ni nj nk nl nm lr dk translated">文档分类解决方案应该能够显著减少人工工作量。它应该在最少人工干预的情况下实现更高水平的准确性和自动化</p></blockquote><p id="7a88" class="pw-post-body-paragraph kw kx iq ky b kz nn jr lb lc no ju le lf np lh li lj nq ll lm ln nr lp lq lr ij bi translated">我们将在这一系列博客中讨论的解决方法不仅限于<strong class="ky ir">抵押贷款</strong>行业，它可以应用于任何需要扫描文档图像并对此类文档进行分类的地方。几个可能的行业有<strong class="ky ir"> <em class="mp">金融机构、学术界、研究机构、零售店</em> </strong></p><h1 id="7594" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">文件的特点</h1><p id="a1de" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">为了做一个解决方案管道，第一步就是要知道什么是数据，它的不同特征是什么。由于我们一直在抵押贷款领域工作，我们将定义我们在抵押贷款行业中处理的数据的特征。</p><p id="3ee5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在一个<em class="mp">包中，</em>有许多类型的页面，但是一般来说，这些可以分为三种类型:</p><p id="5feb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">结构化| </strong>一致的表单和模板</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/1cf34f8a24b0bc8d94caec54a3d1d3d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*SP8euvbgCgx8k9FV4yzYlQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">例如:调查、问卷、测试、索赔表</p></figure><p id="2b9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">非结构化| </strong>文本化，无格式和表格</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/56588d5bd3a15d6bcbcfd10fe1f19681.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*fJP45M8G1fPDyPmtLH_AdA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">例如:合同、信件、文章、笔记</p></figure><p id="8bf4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">半结构| </strong>以上两者的杂交，可能有部分结构</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/cda3ba506474d5ad4ec7c96e558ecdc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*UjQto9sPDI2vJaXgNfgTRA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">例如:发票、采购订单、账单、eob</p></figure><p id="74e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就文件而言，以下是在数据中观察到的特征。</p><ul class=""><li id="ada8" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">包裹中的文件顺序不一致。例如，在一个包文档<strong class="ky ir">“A”</strong>可能在文档<strong class="ky ir">“B”</strong>之后，而在另一个包文档中则相反</li><li id="43bb" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated">同一个文档类有许多变体。一个文档类可以有不同的外观变化，例如，一个<strong class="ky ir">文档类“A”</strong>页面模板/格式可能因美国不同的州而异。在抵押贷款领域，这些表示相同的信息，但在格式和内容上有所不同。换句话说，如果“猫”是一个文件，不同品种的猫就是“变种”。</li><li id="53a6" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><strong class="ky ir">文件类型有不同种类的扫描变形</strong>，即噪声、2D和3D旋转、扫描质量差、页面方向，这些会扰乱这些文件的OCR。</li></ul><h1 id="d96f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">解决方法</h1><p id="51dc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这一节中，我们将抽象地解释我们的解决方案管道是如何工作的，以及每个组件或模块是如何组合在一起产生一个端到端的管道的。下面是解决方案的流程图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/78232ea32a391fd4f5a33840154994ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SbJcp4fhQMEmI2wj_IBx2A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">解决方案|流程图</p></figure><p id="a125" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然目标是识别包内的文档，我们就必须识别<strong class="ky ir"> <em class="mp">一个文档内的什么样的特征，使它不同于另一个？</em> </strong>。在我们的例子中，我们认为文档中的文本是关键，因为直觉上我们人类也是这样做的。下一个挑战是找出文档在包中的位置。在多页文档的情况下，边界页(开始、结束)最有意义。因为使用这些页面，可以识别一系列文档。</p><h2 id="1429" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">机器学习课程</h2><p id="5841" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在<strong class="ky ir">机器学习</strong>方面，我们把这个问题当成了<strong class="ky ir">分类问题。</strong>我们决定在这里标识出<strong class="ky ir"> <em class="mp">每个文档的第一页和最后一页</em> </strong>。我们将我们的<strong class="ky ir"> <em class="mp">机器学习类</em> </strong> (ML类)分为三种类型:</p><ul class=""><li id="7d1b" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated"><strong class="ky ir">首页类</strong>:这些类是每个文档类的首页，负责标识文档的开始。</li><li id="0ad6" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><strong class="ky ir">末页类</strong>:这些类是每个文档类的末页，负责标识文档的结尾。这些类仅适用于包含多页样本的文档类。</li><li id="4a1d" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><strong class="ky ir"> Other Class: </strong>这个类是一个单独的类，包含所有文档类的中间页面，合并成一个类。拥有这个类有助于后面阶段的管道，它减少了文档的中间页面被分类为同一文档的第一页或最后一页的情况，这在直觉上是可能的，因为在所有页面(如页眉、页脚和模板)之间可能存在相似性。这允许模型学习更健壮的特征。</li></ul><p id="a07e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图展示了这些不同类型的ML类在包和文档方面的表现</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/9e7e2fb7a5315298277cc32357ec01ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uygdewuYTwEe_oz_k1v8gg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这里A、B是文档A、B的第一个页面类。此外，A-last、B-last是相同文档的最后一个页面类。任何文档类的所有中间页面都被视为另一个类</p></figure><h2 id="0584" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">机器学习引擎</h2><p id="d12d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦定义了ML类，下一步就是准备用于训练机器学习引擎的数据集(<em class="mp">数据准备部分将在接下来的章节中详细讨论)</em>。下图解释了<strong class="ky ir">机器学习引擎</strong>的内部工作原理，是解决方案管道的一个更技术性的视图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/d5e06304e0395ded64f1a478546adcbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfoX7MYcqUK6IY4HhXZeCg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">端到端分类周期。</p></figure><p id="1a7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们一步一步地描述解决方案的不同阶段。</p><p id="3e4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第一步</strong></p><ul class=""><li id="d214" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">包(pdf格式)被分割成单独的页面(图像)</li></ul><p id="c7ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第二步</strong></p><ul class=""><li id="fe17" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">通过从图像中提取文本并生成文本文件的<strong class="ky ir"> OCR </strong>(光学字符识别)<strong class="ky ir">、</strong>处理各个页面。我们使用了最先进的OCR引擎来生成我们案例中的文本。有许多免费的在线OCR产品可以在这个步骤中使用。</li></ul><p id="700d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第三步</strong></p><ul class=""><li id="5bce" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">对应于每个页面的文本然后被传递到<strong class="ky ir">机器学习引擎</strong>，在那里<strong class="ky ir">文本矢量器(Doc2Vec) </strong>生成其特征向量表示，本质上是一个浮点列表。</li></ul><p id="28e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第四步</p><ul class=""><li id="ed86" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">然后将特征向量传递给分类器(<strong class="ky ir">逻辑回归</strong>)。分类器然后预测每个特征向量的类别。这些基本上是我们之前讨论过的<strong class="ky ir"> ML类别</strong>之一(<strong class="ky ir">第一、最后或其他</strong></li></ul><p id="2c62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，分类器返回所有<strong class="ky ir"> ML类</strong>(图表最右边的部分)<strong class="ky ir">的置信度得分。</strong>例如让(D1，D2..)是ML类，那么对于单个页面，结果可能如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/c7e40e31c7d97fb8cc7cfbc923558f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYSnrl-DczabEdEYzGCjVA.png"/></div></div></figure><h2 id="dc46" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">后加工</h2><p id="5405" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦整个包被处理，我们使用结果/预测来识别文档的边界。结果包含包中所有页面的预测类和预测的置信度得分。请参见下表</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/84e8c856be9e4f4d8ab943bc5045b840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aFveBtIs3W0O6hI4Bp--nA.png"/></div></div></figure><p id="5bf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是使用来自<strong class="ky ir">机器学习引擎</strong>的输出来识别<strong class="ky ir">文档边界</strong>的简单算法和步骤。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/f549c34bca11b4307d9379425b7f70fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iIXaNf5X3WWtWS-qVgh5Jg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">文档范围识别|后处理算法</p></figure><h1 id="7e73" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">解决方案详情(深度挖掘TL；博士)</h1><h2 id="bf1e" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">数据准备</h2><p id="8e07" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">致力于开发一个端到端的文档分类管道。第一步，也可以说是最重要的一步是数据准备，因为解决方案和它使用的数据一样好。我们用于实验的数据是来自抵押贷款领域的文档。我们采用的策略可以以类似的方式应用于任何形式的文档数据集。以下是执行的步骤。</p><blockquote class="op oq or"><p id="5942" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">定义:文档样本</em> </strong> <em class="iq">是一个特定文档的实例。通常它是一个(</em><strong class="ky ir"><em class="iq">pdf)</em></strong><em class="iq">文件，只包含该文档的页面。</em></p></blockquote><p id="4485" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第一步</strong></p><ul class=""><li id="293b" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">第一步是决定，<em class="mp">包中的哪些文档要被识别和分类？</em>。理想情况下，应该选择包中存在的所有文档。一旦决定了文档类，我们就进入提取部分。在我们的例子中，我们决定分类(44)文档类。</li></ul><p id="48cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二步</p><ul class=""><li id="81d5" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">为了获得数据集，我们收集了数百个包的pdf，并从这些包中手动提取所选文档。一旦文档在包中被识别，该文档的页面被分离并以pdf文件的形式连接在一起。例如，如果我们在包的第4页到第10页发现了“<strong class="ky ir"> Doc A </strong>”。我们将提取6页(第4-10页)并将其合并成一个6页的pdf。这个6页的pdf构成了一个<strong class="ky ir">文档样本。为特定文档类别提取的所有样本都放在单独的文件夹中。下图显示了文件夹结构。我们为每个文档类收集了300多个文档样本。每个文档类都有一个惟一的标识符，我们称之为"<strong class="ky ir"> DocumentIdentifierID </strong>"</strong></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/f1adb1ad23156ac983663b63e6f22536.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/0*Y7gDjQO6G2nABl3G.png"/></div></figure><p id="16d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第三步</strong></p><ul class=""><li id="cf8a" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">下一步是应用<strong class="ky ir"> OCR </strong>和<strong class="ky ir">T35】从文档样本中的所有页面提取文本。OCR遍历所有文件夹并生成excel文件，其中包含摘录文本和一些元数据。下面显示了excel文件的格式，每行代表一页</strong></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/138dfd980b1e2a682307f671f5ce135a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cWVW1Cc_14-qBCAW.png"/></div></figure><p id="f5a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">带有示例行的数据集表。</p><blockquote class="op oq or"><p id="42be" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">贷款号，文件名:</em> </strong> <em class="iq">这些都是唯一的样本(pdf)标识符。表格中有两个(绿色、黄色)样本。</em></p><p id="c01f" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">文档标识符ID，文档名:</em> </strong> <em class="iq">代表这些样本所属的文档类。</em></p><p id="0353" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">页数:</em> </strong> <em class="iq">一个特定样本中的总页数。(两个样本都有2页)</em></p><p id="3e08" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">页码:</em> </strong> <em class="iq">是样本内每一页的有序页码。</em></p><p id="c7cb" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"><em class="iq">IsLastPage:</em></strong><em class="iq">如果为1，则表示该页面是该特定样本的最后一页。</em></p><p id="ca21" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">页面文本:</em> </strong> <em class="iq">是从特定页面的OCR返回的文本。</em></p></blockquote><h2 id="e083" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">数据转换</h2><p id="c0ca" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦数据以上述格式生成，下一步就是转换它。在转换阶段，数据被转换/处理成对训练机器学习模型至关重要的格式。以下是应用于数据集的转换。</p><p id="ffd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">步骤1 | </strong>生成ML类</p><ul class=""><li id="8d0a" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">转换的第一步是生成<em class="mp">第一页、最后一页和其他页面类</em>。为此，使用了<em class="mp">页码</em>和<em class="mp">页面</em>列值。下面显示了所用逻辑的条件表示。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/34238f4ba19afa8c8be5314293af0b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kKfOJjFxa4QMKFWZ.png"/></div></figure><ul class=""><li id="d193" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">此外，下表代表各列。注意黄色栏，其中<strong class="ky ir"> 6853 </strong>表示第一个页面类，<strong class="ky ir">6853-最后一个</strong>表示最后一个页面类，而中间页面被视为<strong class="ky ir">其他</strong>类</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/b6244742789ae2f6e4afdfc930df07a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X3TtMcc4pwBvBDAG.png"/></div></figure><p id="44cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">步骤2 | </strong>数据分割用于训练和测试管道</p><ul class=""><li id="e853" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">一旦步骤1完成，从那时起我们只需要两列“<strong class="ky ir">页面文本</strong>和“<strong class="ky ir"> ML类</strong>”来创建培训管道。其他列用于测试评估。</li><li id="e66c" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated">下一步是拆分用于训练和测试管道的数据，数据的拆分方式是<strong class="ky ir"> 80% </strong>用于训练，<strong class="ky ir"> 20% </strong>用于测试。数据也是随机打乱的，但每一类都是分层的。更多信息请点击<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedShuffleSplit.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</li></ul><p id="0928" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第三步| </strong>数据清理和转换</p><ul class=""><li id="a947" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">包含每个页面的OCR文本的“<strong class="ky ir">页面文本</strong>”列被清理，该过程应用于训练和测试。以下是执行的过程。</li></ul><ol class=""><li id="68bd" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr ox ob oc od bi translated"><strong class="ky ir">大小写修正</strong>:所有文字转换成大写或小写。</li><li id="b927" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir">非字母数字字符的正则表达式</strong>:删除所有非字母数字的字符。</li><li id="f093" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir">单词标记化</strong>:所有单词都被标记化，这意味着一个<em class="mp">页面文本</em>字符串成为单词列表</li><li id="b982" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir">停用词移除</strong>:停用词是在英语中过于常见的词，可能对单个文档的分类没有帮助。例如像“这个”、“是”、“一个”这样的词。这些词也可以是特定领域的。它可以用来删除许多不同文档中常见的冗余单词。即就金融或抵押而言,“价格”一词可出现在许多文件中。</li></ol><p id="1968" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下表显示了转换前后的情况</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/81934ce8bb03e928d01db1e6670013cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FrZv9KQPqnhZ9r-X.png"/></div></figure><h2 id="fcf0" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">培训渠道</h2><p id="7c60" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在前面的<strong class="ky ir">机器学习引擎部分，</strong>我们抽象地讨论了机器学习引擎的内部工作原理。两个主要组成部分是。</p><ol class=""><li id="6592" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr ox ob oc od bi translated"><strong class="ky ir">文本矢量器:</strong>在我们的例子中，我们使用了<strong class="ky ir"> Doc2Vec </strong></li><li id="7058" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir">分类器模型:</strong>使用逻辑回归器进行分类。</li></ol><h2 id="9d67" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">文本矢量器(Doc2Vec)</h2><p id="414d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">自从自然语言处理 (NLP)开始以来，就有了将文本转换成机器可以理解的东西的需求。这意味着，将文本信息转换成有意义的表示，通常称为数字向量(或数组)。研究界一直在开发不同的方法来完成这项任务。在我们的研发中，我们尝试了不同的技术，发现<strong class="ky ir"> Doc2Vec </strong>是所有技术中最好的。</p><p id="59a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Doc2Vec基于<strong class="ky ir"> Word2Vec </strong>模型。Word2Vec模型是一个<strong class="ky ir">预测向量空间模型。</strong>为了理解Word2Vec，让我们从<strong class="ky ir">向量空间模型开始。</strong></p><blockquote class="op oq or"><p id="aafc" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">向量空间模型(VSM):</em></strong><em class="iq">将单词嵌入到连续的向量空间中，其中语义相似的单词被映射到附近的点</em></p></blockquote><p id="7b4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">VSM的两种做法:</strong></p><ol class=""><li id="d5f4" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr ox ob oc od bi translated"><strong class="ky ir"/></li><li id="e1f4" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir"> <em class="mp">预测方法:</em> </strong>根据学习到的小而密的嵌入向量(例如Skip-Gram，CBOW)从其邻居预测一个单词。Word2Vec和Doc2Vec就属于这一类机型</li></ol><p id="1bf7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Word2Vec型号</strong></p><p id="fcc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个<strong class="ky ir"> </strong>计算高效的预测模型，用于从原始文本中学习单词嵌入。<strong class="ky ir"> Word2Vec </strong>可使用以下两种模型创建:</p><ol class=""><li id="6e96" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr ox ob oc od bi translated"><strong class="ky ir"> Skip-Gram </strong>:围绕当前单词(目标单词)创建一个滑动窗口。然后使用当前单词来预测所有周围的单词(上下文单词)。(例如从<strong class="ky ir">“垫子”</strong>预测<strong class="ky ir">“猫坐在”</strong>)</li><li id="52fe" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir">连续词袋</strong> ( <strong class="ky ir"> CBOW </strong>):在当前词(目标词)周围创建一个滑动窗口。然后从周围的单词(上下文单词)中预测当前单词。(如从<strong class="ky ir">“猫坐在”</strong>上预测<strong class="ky ir">“垫子”</strong>)</li></ol><p id="8ae4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更多详情，请阅读这篇<a class="ae kv" rel="noopener" target="_blank" href="/introduction-to-word-embedding-and-word2vec-652d0c2060fa">文章</a>。它详细解释了它的不同方面。</p><p id="6c04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Doc2Vec型号</strong></p><p id="1be3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种文本矢量化技术在科研论文<a class="ae kv" href="https://cs.stanford.edu/~quocle/paragraph_vector.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">句子和文档的分布式表示</strong> </a> <strong class="ky ir">中有所介绍。</strong>此外，进一步的技术细节可在<a class="ae kv" href="http://linanqiu.github.io/2015/10/07/word2vec-sentiment/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="28d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">定义<em class="mp">|</em>|</strong><em class="mp">it</em><strong class="ky ir"><em class="mp"/></strong><em class="mp">是一种从变长文本块中学习</em> <strong class="ky ir"> <em class="mp">定长特征向量表示</em> </strong> <em class="mp">的</em> <strong class="ky ir"> <em class="mp">无监督算法</em> </strong> <em class="mp">。然后，这些向量可以在任何机器学习分类器中使用，以预测类别标签。</em></p><p id="8ce2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它类似于Word2Vec模型，只是它使用每个文本文件中的所有单词在一个矩阵中创建一个唯一的列(称为<strong class="ky ir">段落矩阵</strong>)。然后，将训练单层NN，如在Skip-Gram模型中看到的，其中输入数据都是当前单词的周围单词以及当前段落列，以预测当前单词。其余与Skip-Gram或CBOW模型相同。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/e1d69f6d3b9d9d23e75cc605f20bac38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/0*B8FiikVdaxkovksE.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Doc2Vec |分布式单词包|来源:<a class="ae kv" href="https://cs.stanford.edu/~quocle/paragraph_vector.pdf" rel="noopener ugc nofollow" target="_blank">句子和文档的分布式表示</a></p></figure><p id="9323" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Doc2Vec模型的优点:</p><ul class=""><li id="13e6" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">在<strong class="ky ir">情感分析任务</strong>上，Doc2Vec取得了新的最先进的结果，优于复杂的方法，在错误率方面产生了超过<strong class="ky ir"> 16% </strong>的相对改善。</li><li id="8a3a" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated">在<strong class="ky ir">文本分类任务</strong>上，Doc2Vec令人信服地击败了词袋模型，给出了大约<strong class="ky ir"> 30% </strong>的相对提升。</li></ul><h2 id="f97b" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">分类器模型(逻辑回归)</h2><p id="784e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦文本被转换成矢量格式。机器学习分类器已经准备好学习不同文档类型的向量中存在的模式，并识别正确的区别。因为有许多分类技术可以在这里使用，我们尝试了最好的分类技术并评估了它们的结果。即随机森林、SVM、多层感知器和逻辑回归器。为获得最佳结果，每个分类器尝试了许多不同的参数。<strong class="ky ir">逻辑回归器</strong>被发现是所有这些模型中最好的。</p><h2 id="4b18" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">培训程序</h2><ul class=""><li id="76d3" class="nv nw iq ky b kz mk lc ml lf oz lj pa ln pb lr oa ob oc od bi translated">一旦数据被转换。首先，我们在训练分割上训练Doc2Vec模型(如数据转换一节中所讨论的)。-</li><li id="924e" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated">训练完Doc2Vec模型后。训练数据再次通过它，但是这一次不训练模型，而是我们推断训练样本的向量。最后一步是将这些向量和实际的ML类标签传递给分类模型(逻辑回归)。</li><li id="91cf" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated">一旦根据训练数据对模型进行了训练，这两个模型都被保存到磁盘上，以便可以将它们加载到内存中，用于测试和最终的生产部署。下图显示了该协作方案的基本流程。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/ee9bd0c19b2743f40b23d1fb8b0a9f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/0*v7h985J7WxnsZyUN.png"/></div></figure><h2 id="03cf" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">测试和评估管道</h2><p id="3dfa" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦训练了管道(包括<strong class="ky ir"> Doc2Vec </strong>模型和<strong class="ky ir">分类器)，下面的流程图显示了如何使用它来预测测试数据分割的文档类。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/602057cac999f7e8e3a55dae8893a9c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*55l4kc4CBn64qwUQWdz8ag.png"/></div></div></figure><p id="472b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转换后的测试数据通过经过训练的Doc2Vec模型，在这里提取并推断出测试数据中所有页面的矢量表示。然后通过分类器对这些向量进行分类，该分类器返回所有ML类别的预测类别和置信度得分。</p><p id="93b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于机器学习引擎的详细评估，我们根据结果生成一个excel文件。下表显示了测试阶段生成的列和信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/3cb51aaae8a9d9d280aec7f6c0dbb2d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3cxXCbptmcQ5oprU3LOIvA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">测试阶段生成的评估excel文件。</p></figure><blockquote class="op oq or"><p id="a76c" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">页面文本、文件名、页码:</em> </strong> <em class="iq">这些</em> <strong class="ky ir"> <em class="iq"> </em> </strong> <em class="iq">都是我们在数据准备阶段就有的相同的列，这些只是从源数据集中照原样取来的。</em></p><p id="7665" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq"> ground，pred : </em> </strong> ground <em class="iq">显示该页面的实际ML类，而</em> pred <em class="iq">显示ML引擎预测的ML类。</em></p><p id="e55b" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">已训练类列</em> </strong> <em class="iq">:此部分中的列表示模型被训练的ML类以及这些类的置信度得分。</em></p><p id="34fb" class="kw kx mp ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq"> MaxProb，Range : </em> </strong> MaxProb <em class="iq">显示“已训练的类”部分中任何列达到的最大置信度得分。参见红色文本，</em>范围<em class="iq">显示MaxProb落入的范围。</em></p></blockquote><p id="571a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前有三个等级的结果评估。</p><ol class=""><li id="9318" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr ox ob oc od bi translated"><strong class="ky ir">累积误差</strong>T36】评价指标</li><li id="b42d" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir">混淆矩阵</strong></li><li id="f998" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr ox ob oc od bi translated"><strong class="ky ir">班级水平置信度分数分析</strong></li></ol><h2 id="102c" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">累积误差评估度量</h2><p id="afa2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">该评估计算两个指标，<strong class="ky ir">准确性</strong>和<strong class="ky ir">F1-分数</strong>。更多细节请看这个<a class="ae kv" rel="noopener" target="_blank" href="/accuracy-precision-recall-or-f1-331fb37c5cb9">博客</a>。这些让我们对管道的优点有了一个抽象的认识。分数可以在(1-100)之间。其中较高的数字表示管道在文档分类方面的好坏。在我们的实验中，我们得到了下面的准确度和f1值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/b74c375f1c832e0fa14d53c90c036ba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*ilQYe10yuVAz72BXptAcbw.png"/></div></figure><h2 id="3da2" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">混淆矩阵</h2><p id="21a6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">混淆矩阵是一个表格，通常用于描述一个分类模型(或“分类器”)对一组真实值已知的测试数据的性能。</p><p id="b36c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mp">本质上，它更容易理解:</em> </strong></p><ul class=""><li id="cd56" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated"><em class="mp">哪些班级表现不好？</em></li><li id="9d6f" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><em class="mp">个别班级的准确率分数是多少？</em></li><li id="86e1" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><em class="mp">哪些阶层互相混淆？</em></li></ul><p id="e04a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图代表了我们测试后生成的混淆矩阵。这是一个嵌入链接，所以点击查看混淆矩阵。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pg ph l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">混淆矩阵图</p></figure><p id="f549" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> X轴(真实标签)</strong>和<strong class="ky ir"> Y轴(预测标签)</strong>上的值代表我们训练的文档类别。单元格内的数字显示属于左边和底部的类的测试数据集的百分比。</p><p id="54a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">对角线上的值代表预测类别正确的数据百分比。</strong>百分比越高越好。即，如果0.99，则意味着该特定类别的99%的测试数据被正确预测。所有其他单元格显示错误的预测，百分比显示某个类被另一个类混淆的程度。</p><p id="2fb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以看出，该模型能够以超过<strong class="ky ir"> 90% </strong>的准确度正确地分类大多数ML类别。</p><h2 id="33f7" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">类别级置信度得分分析</h2><p id="0925" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">虽然混淆矩阵给出了关于类混淆的细节，但是它不代表预测的置信度分数。也就是说</p><ul class=""><li id="81b9" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated"><em class="mp">“在对一个文档类进行预测时，模型的可信度如何？”</em></li></ul><p id="fcec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">需要什么？</strong></p><p id="06bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在理想情况下，模型在预测正确的ML类时应该具有高置信度，而在预测错误的ML类时应该具有低置信度。但是这不是严格的行为，并且取决于许多因素，即特定类的性能、文档类之间的实际领域相似性等。为了评估这种行为是否存在以及置信度得分是否可以作为真实预测的有用指标，我们设计了一种额外的评估方法。</p><p id="49b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">接近</strong></p><p id="0db6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为任务是减少人工工作，所以决定只选择具有高置信度的预测。这样错误的预测就不会发生(因为那些人不会有很高的信心)。其余的文档和页面将由BPO手动验证。</p><p id="4b91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">阈值</strong></p><p id="164c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在该步骤中，计算类别的置信度得分并定义阈值，阈值是一个百分比，即<strong class="ky ir"> 80%，75% </strong>，其中<strong class="ky ir"> </strong>基于以下条件确定。</p><ul class=""><li id="c7f9" class="nv nw iq ky b kz la lc ld lf nx lj ny ln nz lr oa ob oc od bi translated">什么是置信分值，其中，错误的预测是无关紧要的数字，而正确的预测是较高的数字。换句话说，这是关于<strong class="ky ir"> <em class="mp">找到甜蜜点</em>。</strong></li></ul><p id="27a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图显示了真阳性(蓝线)和假阳性(红线)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pi"><img src="../Images/56ae7d555e7053db1500922d5153a0f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uyEfmGri2tWREy76cL8Ibg.png"/></div></div></figure><p id="5981" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> X轴</strong>显示了ML类，<strong class="ky ir"> Y轴</strong>显示了特定类的测试数据的百分比，其被真阳性或假阳性所覆盖。</p><p id="359d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如:在ML类<strong class="ky ir"> 1330的情况下，</strong>真实预测几乎覆盖了该类的整个测试数据集的70%。这意味着ML引擎能够正确预测<strong class="ky ir"> 70% </strong>的数据，置信度得分大于<strong class="ky ir"> 90%。</strong>此外，假阳性仅占测试数据集的1%，这意味着只有<strong class="ky ir"> 1% </strong>的测试数据被预测为错误，置信度高于<strong class="ky ir"> 90%。</strong></p><p id="693c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然，由于阈值的原因，有时我们会丢失真正的阳性(当置信度得分小于阈值时)。但这并不像高置信度的误报那样糟糕。此类页面/文档将被手动验证。</p><p id="d019" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">前面的图是用阈值(<strong class="ky ir"> 90%及以上)制作的。</strong>在<strong class="ky ir"> t </strong> he以下图中，阈值为(<strong class="ky ir"> 80%及以上)。</strong>注意，即使阈值降至<strong class="ky ir"> 80% </strong>假阳性也不会增加，而真阳性会显著增加。这意味着，在90%和80%阈值之间，<strong class="ky ir"> 80% </strong>是最佳的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pi"><img src="../Images/9263a818207b077de280171251efcf1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*stzIguJXeRQvlECrDALLVQ.png"/></div></div></figure><p id="7c6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">进行该分析时，检查所有水平，即50%、60%、70%。使用该评估度量来选择最佳阈值。</p><h1 id="78d9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">解决方案功能</h1><ul class=""><li id="43b6" class="nv nw iq ky b kz mk lc ml lf oz lj pa ln pb lr oa ob oc od bi translated"><strong class="ky ir">快速预测| </strong>一个页面的分类时间在(~ <strong class="ky ir"> 300ms </strong>)以下。如果算上OCR的时间，一页在<strong class="ky ir"> 1秒之内就可以很好的分类了。此外，如果采用多重处理，</strong></li><li id="3c7b" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><strong class="ky ir">高准确度| </strong>当前的解决方案管道能够以高准确度和高置信度识别和分类文档。在大多数类别中，我们获得了超过95%的准确率。</li><li id="8ff7" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><strong class="ky ir">标记数据需求| </strong>在我们的实验中，我们观察到管道可以很好地处理每个文档类的大多数<strong class="ky ir"> 300个样本</strong>。(就像我们在这些博客中讨论的实验一样)。但是这取决于文档类的变化和类型。此外，我们看到随着样本数的增加，准确度和置信度得分也在增加。</li><li id="3ded" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><strong class="ky ir">置信度得分阈值| </strong>管道提供预测置信度得分，这实现了调整方法，并允许在真阳性和假阳性之间进行调整。</li><li id="e266" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><strong class="ky ir">多处理|</strong>doc 2 vec实现允许多处理，而且我们的数据转换脚本是高度并行的。</li></ul><h1 id="3a5f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="3588" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">机器学习和自然语言处理已经在许多领域创造了奇迹，我们直接看到了它如何帮助减少人工劳动和自动化文档分类任务。求解不仅快，而且非常准确。</p><p id="4462" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为这一过程中使用的数据具有敏感性。代码库不可用。我会在一些虚拟数据的基础上重做代码，这将允许我把它上传到我的github。请在<a class="ae kv" href="https://github.com/QaisarRajput" rel="noopener ugc nofollow" target="_blank"> github </a>上关注我，了解更多更新。也看看我的一些其他项目；)</p></div></div>    
</body>
</html>