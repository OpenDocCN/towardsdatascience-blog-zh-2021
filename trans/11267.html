<html>
<head>
<title>Visualizing NYS COVID-19 Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化NYS新冠肺炎数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-nys-covid-19-data-ed97f539b921?source=collection_archive---------18-----------------------#2021-11-04">https://towardsdatascience.com/visualizing-nys-covid-19-data-ed97f539b921?source=collection_archive---------18-----------------------#2021-11-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3489" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python Matplotlib和Plotly</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0d46ea614e679c951310e8cc73d882bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RVPRxqz2VUuY7NGXSXzmtw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/healthcare-data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@kmuza?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Carlos Muza </a>拍摄的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="ac6d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">作为一名全职数据分析师，我每天花大量时间使用SQL来提取工作项目的相关数据。然而，另一方面，我也喜欢通过探索性研究和图形来磨练我的python技能。下面这个(简单的)项目着重于使用plotly绘制来自Health.Data.NY.Gov<a class="ae ky" href="https://health.data.ny.gov/" rel="noopener ugc nofollow" target="_blank">的纽约州新冠肺炎数据。</a></p><h1 id="618d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">目标</h1><p id="2700" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">这个项目的目标是从matplot库创建一个简单的可视化开始，然后使用plotly增强它并在它的基础上构建。</p><h1 id="25eb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">数据</strong></h1><p id="aebc" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">我使用两个数据集进行描述性分析和可视化:</p><ol class=""><li id="65ac" class="mz na it li b lj lk lm ln lp nb lt nc lx nd mb ne nf ng nh bi translated"><a class="ae ky" href="https://health.data.ny.gov/Health/New-York-State-Statewide-COVID-19-Testing/xdss-u53e" rel="noopener ugc nofollow" target="_blank">新冠肺炎测试数据</a></li><li id="91b7" class="mz na it li b lj ni lm nj lp nk lt nl lx nm mb ne nf ng nh bi translated"><a class="ae ky" href="https://health.data.ny.gov/Health/New-York-State-Statewide-COVID-19-Vaccination-Data/duk7-xrni" rel="noopener ugc nofollow" target="_blank">新冠肺炎疫苗接种数据</a></li></ol><p id="ea96" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这两个数据集都包含NYS各县的最新统计数据。</p><p id="aacc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在我导入数据后，我做了一个快速总结来理解结构。首先，我查看了COVID测试数据:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/d2c0e46a8aed512e20c870c236c04432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JtOcqA3n0HIfox0HPvGiiQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试数据.描述</p></figure><p id="21a1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">一个快速描述功能向我展示了基本知识。我的数据框有37882行和6列。我将关注的列是County、Test Date和已执行测试的累积数量。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/9ea51cb59fdca0252a3417e8d58ff0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sq5Zzxh6Eu5QCGLwgfheWg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">疫苗数据.描述</p></figure><p id="5647" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">对于疫苗数据，快速描述功能也向我展示了基础知识。有1980行和5列。我将关注的栏目是地区、县、报告日期和首剂。</p><h1 id="3a27" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Matplotlib可视化</h1><p id="b57e" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">我的第一个可视化是使用测试数据集的全部数据从matplotlib创建的。我使用了下面的代码块(如果您想要一个有意义的可视化，我不推荐使用它)。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="e895" class="nt md it np b gy nu nv l nw nx">plt.plot(df['Test Date'],df['Cumulative Number of Tests Performed'])<br/>plt.title('COVID Testing NYS')<br/>plt.xlabel('Test Date')<br/>plt.ylabel('Cumulative Count of Tests')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/70bcf95483b3b144f24ec5b881731932.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*9E5KX08c07GJOOqoqWux5Q.png"/></div></figure><p id="1d1c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如你所看到的，这个图表并没有很好地讲述一个故事，主要是因为所有的县数据都是一起绘制的。另外，你看不到考试日期，因为分数太多了。因此，我采取的第一步是清理数据。我将分析重点放在长岛，因此我选择了萨福克县和拿骚县。</p><p id="4c24" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">首先，我设置日期时间索引，按计数分组，并重新采样:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a66b" class="nt md it np b gy nu nv l nw nx">dftest=df</span><span id="c4c1" class="nt md it np b gy nz nv l nw nx">dftest['date']=pd.to_datetime(df['Test Date'])</span><span id="c909" class="nt md it np b gy nz nv l nw nx">dftest=df.set_index('date')</span><span id="7a44" class="nt md it np b gy nz nv l nw nx">dfcounty1=dftest.groupby(['County']).resample('D').mean().reset_index()</span></pre><p id="fdc9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我将萨福克郡的数据与拿骚郡的数据分开:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="c278" class="nt md it np b gy nu nv l nw nx">Suffolk=dfcounty1[dfcounty1['County']=='Suffolk']<br/>Nassau=dfcounty1[dfcounty1['County']=='Nassau']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/011205630c1119f683a993870ed3ff95.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*ala6dZVLEaUSVNMhMvaRtA.png"/></div></figure><p id="c8e8" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这个稍微好一点，但是还是很乱，没有给我想要的所有信息。至此，我认为我的目标无法用matplotlib实现，所以我转向了plotly。</p><h1 id="cf40" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">基本情节视觉</h1><p id="2768" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">这个简单的代码块允许我绘制出萨福克郡的数据:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="2011" class="nt md it np b gy nu nv l nw nx">fig = px.line(dfcounty2, x = 'date',<br/>y='Cumulative Number of Tests Performed', color='County',<br/>title = 'COVID Tests by County')<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="54db" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，这更多的是我在寻找的格式，但现在是时候结合我的数据了。下面的代码允许我将拿骚县和萨福克县的测试数据和疫苗数据绘制在一起。</p><p id="0ee2" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了分解它，首先我创建了支线剧情来考虑双y轴。然后我绘制了萨福克和拿骚的疫苗数据。我为我想要添加的每一行添加了跟踪。然后我格式化了标题并添加了注释。我想强调李身上的第一次COVID测试和李身上的第一次COVID疫苗的日期，所以我用文本注释添加了这一点。</p><p id="d669" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最后，我用updatemenus参数创建了下拉过滤器。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="b3d4" class="nt md it np b gy nu nv l nw nx">fig2 = make_subplots(specs=[[{"secondary_y": True}]])<br/>fig2.add_trace(go.Scatter(x=S['date'], y=S['First Dose'], name = 'Suffolk First Dose of Vaccine',<br/>                         line=dict(color='red', width=1, dash='dash')), secondary_y=True)<br/>fig2.add_trace(go.Scatter(x=N['date'], y=N['First Dose'], name = 'Nassau First Dose of Vaccine',<br/>                         line=dict(color='blue', width=1, dash='dash')), secondary_y=True)</span><span id="ea85" class="nt md it np b gy nz nv l nw nx">fig2.add_trace(go.Scatter(x=Suffolk['date'], y=Suffolk['Cumulative Number of Tests Performed'], name = 'Suffolk Tests',<br/>                         line=dict(color='red', width=1, dash='solid')), secondary_y=False)<br/>fig2.add_trace(go.Scatter(x=Nassau['date'], y=Nassau['Cumulative Number of Tests Performed'], name = 'Nassau Tests',<br/>                         line=dict(color='blue', width=1, dash='solid')),secondary_y=False)<br/>fig2.update_layout(title_text='COVID Test and Vaccines LI', title_x=0.4,<br/>                 xaxis_title='Date')<br/>fig2.update_yaxes(title_text="COVID Tests", secondary_y=False)<br/>fig2.update_yaxes(title_text="First Dose of Vaccine (Count)", secondary_y=True)</span><span id="a6f4" class="nt md it np b gy nz nv l nw nx">fig2.add_annotation(x='2020-03-05', y=100,<br/>                    xref="x",<br/>        yref="y",<br/>        text="First Test: 3/5/20",<br/>        showarrow=True,<br/>        font=dict(<br/>            family="Courier New, monospace",<br/>            size=10,<br/>            color="black"<br/>            ),<br/>        align="center",<br/>       <br/>        ax=20,<br/>        ay=-30,<br/>        bordercolor="black",<br/>        borderwidth=1,<br/>        borderpad=2,<br/>        bgcolor="#ffffff",<br/>        opacity=1<br/>        )<br/>fig2.add_annotation(x='2020-12-14', y=20,<br/>                    xref="x",<br/>        yref="y",<br/>        text="First Vaccine: 12/14/20",<br/>        showarrow=True,<br/>        font=dict(<br/>            family="Courier New, monospace",<br/>            size=10,<br/>            color="black"<br/>            ),<br/>        align="center",<br/>      <br/>        ax=20,<br/>        ay=-30,<br/>        bordercolor="black",<br/>        borderwidth=1,<br/>        borderpad=2,<br/>        bgcolor="#ffffff",<br/>        opacity=1<br/>        )</span><span id="371a" class="nt md it np b gy nz nv l nw nx">fig2.update_layout(<br/>    <br/>    updatemenus=[<br/>        dict(active=0,<br/>            buttons=list([<br/>            dict(label="All",<br/>                 method="update",<br/>                 args=[{"visible":[True,True,True, True]},<br/>                       {"title":"ALL"}]),<br/>            dict(label="Suffolk",<br/>                 method="update",<br/>                 args=[{"visible":[True, False, True, False]},<br/>                       {"title":"Suffolk"}]),<br/>            dict(label="Nassau",<br/>                 method="update",<br/>                 args=[{"visible":[False,True,False, True]},<br/>                       {"title":"Nassau"}]),<br/>            dict(label="First Dose",<br/>                 method="update",<br/>                 args=[{"visible":[True, True, False,False]},<br/>                       {"title":"First Dose"}]),<br/>                       <br/>            dict(label="Total Tests",<br/>                 method="update",<br/>                 args=[{"visible":[False,False, True, True]},<br/>                       {"title":"Total Tests"}])<br/>                       <br/>        ]),<br/>        )<br/>    ]<br/>)</span><span id="ff22" class="nt md it np b gy nz nv l nw nx">fig2.show()</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h1 id="4844" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">调查的结果</h1><p id="0756" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">总的来说，我发现拿骚县和萨福克县在COVID测试和疫苗方面遵循非常相似的趋势。然而，还是有一些不同之处:</p><ol class=""><li id="9820" class="mz na it li b lj lk lm ln lp nb lt nc lx nd mb ne nf ng nh bi translated">第一次检测是在拿骚县，结果呈阳性。因此，我不能准确地绘制疫情开始时的阳性率，因为纳索在测试的第一天显示为100%阳性，这是有道理的，因为人们没有被测试，除非他们相当确定他们是阳性的。</li><li id="c90c" class="mz na it li b lj ni lm nj lp nk lt nl lx nm mb ne nf ng nh bi translated">尽管在萨福克县进行了更多的测试，拿骚县还是更快地获得了第一剂疫苗。这也是有道理的，因为萨福克县(一般来说)更保守/共和党，拿骚县(一般来说)更自由，因为它更接近纽约市。</li></ol><p id="7e0b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">感谢您花时间阅读这篇文章。我知道这是相当基本的，但我希望这是对那些想使用plotly来可视化数据的人的一个很好的介绍。</p><p id="dbfe" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请随时留下与调查结果或视觉效果相关的评论，我一定会用新数据更新它们。</p><p id="468e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">互动公开图此处:<a class="ae ky" href="https://chart-studio.plotly.com/~meagvo/2/#/" rel="noopener ugc nofollow" target="_blank">https://chart-studio.plotly.com/~meagvo/2/#/</a></p><p id="78e5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">github上有完整的笔记本:<a class="ae ky" href="https://github.com/meagvo/TowardsDataScience/blob/main/HealthProject.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/meag VO/towards data science/blob/main/health project . ipynb</a></p></div></div>    
</body>
</html>