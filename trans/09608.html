<html>
<head>
<title>Prettifying pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">美化熊猫数据框</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/prettifying-pandas-dataframes-75c1a1a6877d?source=collection_archive---------6-----------------------#2021-09-07">https://towardsdatascience.com/prettifying-pandas-dataframes-75c1a1a6877d?source=collection_archive---------6-----------------------#2021-09-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/859a85002d08bab35ac7630918957ca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4G8bqGvzE_OykX7r"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@pawel_czerwinski?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">帕韦尔·切温斯基</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h2 id="809a" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="1cd1" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">通过颜色编码来增强你的数据框架</h2></div><p id="0b80" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你知道我们可以通过访问<code class="fe md me mf mg b">.style</code>属性来美化熊猫数据帧吗？这里有一个例子，我们设计了一个数据帧，使其类似于热图:</p><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/72f05e379e1764a541e709faefd1bdbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*Xanmvna2ds_vB68tmDnT4g.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片|造型前后的关联矩阵</p></figure><p id="7c58" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">造型后，看起来更加明显和直观，以看到积极和消极的相关性以及相关性的强度。通过颜色编码，我们可以更容易地解释和分析数据框架。在这篇文章中，我将展示4种美化数据框架的有用方法。</p><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mm"><img src="../Images/d0ed67cb600e9eebdcd51eef22976aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OlymL0qUIgTqG6tD"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Anna Kolosyuk 在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="b5b2" class="mu mv jj bd mw mx my mz na nb nc nd ne ky nf kz ng lb nh lc ni le nj lf nk nl bi translated">0.数据📦</h1><p id="ca8e" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">在这篇文章中，我们将使用<a class="ae jg" href="https://github.com/mwaskom/seaborn-data/blob/master/penguins.csv" rel="noopener ugc nofollow" target="_blank">企鹅数据集</a>。让我们导入库和数据:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="d1c0" class="nv mv jj mg b gy nw nx l ny nz">import numpy as np<br/>import pandas as pd<br/>pd.options.display.precision = 2<br/>from seaborn import load_dataset</span><span id="8b19" class="nv mv jj mg b gy oa nx l ny nz"># Load sample data<br/>columns = {'culmen_length_mm': 'length', <br/>           'culmen_depth_mm': 'depth',<br/>           'flipper_length_mm': 'flipper',<br/>           'body_mass_g': 'mass'}<br/>df = load_dataset('penguins').rename(columns=columns)<br/>df.head()</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/aa83658df075c9223ae21856d68f148f.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*lWptoyl72WwwD-3_Rrs8zw.png"/></div></figure><p id="ab56" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">加载数据时，为了简洁起见，列名被重命名。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="e7e6" class="mu mv jj bd mw mx my mz na nb nc nd ne ky nf kz ng lb nh lc ni le nj lf nk nl bi translated">1.美化✨的数据框架</h1><p id="ea31" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">为了样式化数据帧，我们需要访问返回Styler对象的<code class="fe md me mf mg b">.style</code>属性:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="d673" class="nv mv jj mg b gy nw nx l ny nz">type(df.style)</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/286fc3ff3a2c5a4ebc70288bb51a94bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*QBuK5AmAFfgUY87bs1oufA.png"/></div></figure><p id="3416" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><a class="ae jg" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html" rel="noopener ugc nofollow" target="_blank">这个Styler对象创建了一个HTML表格，可以使用CSS对其进行进一步的样式化</a>。在接下来的章节中，我们将使用Styler object的内置方法以及一点CSS语法来定制格式。我们不需要知道CSS来样式化数据帧，因为我们将只做一些CSS引用。为此，像<a class="ae jg" href="https://htmlcheatsheet.com/css/" rel="noopener ugc nofollow" target="_blank">和</a>这样的备忘单可以帮助我们获得基本信息。</p><p id="d57e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在下面的部分中，我们将一个接一个地链接多个方法。这使得代码非常长。为了以更易读的方式格式化代码，我们将把长代码分成几行，并使用 <code class="fe md me mf mg b"><em class="od">()</em></code> <em class="od">来包装代码。</em></p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="4eae" class="nv mv jj bd mw oe of dn na og oh dp ne lq oi oj ng lu ok ol ni ly om on nk jp bi translated">1.1.梯度🌈</h2><p id="7c5e" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">让我们先来看看前面的热图是如何创建的。我们将使用<code class="fe md me mf mg b">.background_gradient()</code>方法创建关联矩阵的热图。</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="d449" class="nv mv jj mg b gy nw nx l ny nz">correlation_matrix = df.corr()<br/>(correlation_matrix.style<br/>    .background_gradient(cmap='seismic_r', axis=None))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/35259ec1facab1ae1308bab5eda1b4ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*UmDTfPA_NCroeUwhrG_O3g.png"/></div></figure><p id="3eee" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">添加背景渐变只需要一行额外的代码。通过传递<code class="fe md me mf mg b">axis=None</code>，颜色渐变将应用于整个表格，而不是特定的轴。所需调色板的名称被传递给<code class="fe md me mf mg b">cmap</code>参数。对于这个参数，我们可以使用任何<a class="ae jg" href="https://matplotlib.org/tutorials/colors/colormaps.html" rel="noopener ugc nofollow" target="_blank"> Matplotlib colourmap </a>。这里有一个关于色彩映射表的有用提示:如果你需要翻转色标，在色彩映射表名称上加上<code class="fe md me mf mg b">_r</code>后缀就可以了。例如，如果我们用<code class="fe md me mf mg b">'seismic'</code>而不是<code class="fe md me mf mg b">'seismic_r'</code>，负相关将会是蓝色，正相关将会是红色。</p><p id="937d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">前面的例子看起来和本文开头的例子不太一样。它需要更多的定制才能看起来一样:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="6ed3" class="nv mv jj mg b gy nw nx l ny nz">(correlation_matrix.style<br/>     .background_gradient(cmap='seismic_r', axis=None)<br/>     .set_properties(**{'text-align': 'center', 'padding': '12px'})<br/>     .set_caption('CORRELATION MATRIX'))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/47888cfaa858786f49054e1ce0e2fee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*LwsAvNi3BHJ8Bu5tOKi_jw.png"/></div></figure><p id="d971" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们将值(<code class="fe md me mf mg b">{'text-align': 'center'}</code>)居中对齐，并用<code class="fe md me mf mg b">.set_properties()</code>增加了行高(<code class="fe md me mf mg b">{'padding': '12px' </code>)。然后，我们用<code class="fe md me mf mg b">.set_caption()</code>在桌子上方加了一个标题。在这个例子中，我们对背景应用了颜色渐变。我们也可以使用<code class="fe md me mf mg b">.text_gradient()</code>对文本应用颜色渐变:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="2724" class="nv mv jj mg b gy nw nx l ny nz">(correlation_matrix.style<br/>     .text_gradient(cmap='seismic_r', axis=None))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/752c439a9272782e8ff2460eb756b7dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*vBoLjuTiAsNsGqobNGoR7A.png"/></div></figure><p id="0f18" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果有用的话，我们也可以链接两种类型的渐变:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="4b35" class="nv mv jj mg b gy nw nx l ny nz">(correlation_matrix.style<br/>     .background_gradient(cmap='YlGn', axis=None)<br/>     .text_gradient(cmap='YlGn_r', axis=None))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/4edd02772517cff6bcf6050a9ca047a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*lvMyZDBfL9vS9LdsBJ4uAQ.png"/></div></figure><p id="7bba" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们结束这一部分之前，我想展示一个更有用的例子。假设我们有一个简单的混淆矩阵:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="83c4" class="nv mv jj mg b gy nw nx l ny nz"># Create made-up predictions<br/>df['predicted'] = df['species']<br/>df.loc[140:160, 'predicted'] = 'Gentoo'<br/>df.loc[210:250, 'predicted'] = 'Adelie'</span><span id="fb9a" class="nv mv jj mg b gy oa nx l ny nz"># Create confusion matrix<br/>confusion_matrix = pd.crosstab(df['species'], df['predicted'])<br/>confusion_matrix</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d3b73a05f719e430e6e9a37eee2a4ec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*QaZMxym90XnUXJa7IyCSug.png"/></div></figure><p id="0aa7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以做一些修饰，让它更有用、更漂亮:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="c394" class="nv mv jj mg b gy nw nx l ny nz">(confusion_matrix.style<br/>     .background_gradient('Greys')<br/>     .set_caption('CONFUSION MATRIX')<br/>     .set_properties(**{'text-align': 'center', <br/>                        'padding': '12px', <br/>                        'width': '80px'})<br/>     .set_table_styles([{'selector': 'th.col_heading', <br/>                         'props': 'text-align: center'},<br/>                        {'selector': 'caption', <br/>                         'props': [('text-align', 'center'),<br/>                                   ('font-size', '11pt'),<br/>                                   ('font-weight', 'bold')]}]))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/c95df37d290455630f7ec8bc04156113.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*4rrnadB8MzqsbnXDC-UXVQ.png"/></div></figure><p id="2fdd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这看起来漂亮，有用，简约。你不喜欢这个混乱矩阵的样子吗？</p><p id="cb18" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">既然我们已经熟悉了前几个例子中的前5行代码，那么让我们来看看剩下的代码在做什么:<br/> ◼️ <code class="fe md me mf mg b">.set_properties(**{'width': '80px'})</code>:增加列宽<br/> ◼️ <code class="fe md me mf mg b">.set_table_styles([{'selector': 'th.col_heading', 'props': 'text-align: center'}])</code>:居中对齐列标题<br/> ◼️ <code class="fe md me mf mg b">.set_table_styles([{'selector': 'caption', 'props': [('text-align', 'center' ), ('font-size', '11pt'), ('font-weight', 'bold')]}])</code>:居中对齐标题，增加其字体大小并加粗。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="1852" class="nv mv jj bd mw oe of dn na og oh dp ne lq oi oj ng lu ok ol ni ly om on nk jp bi translated">1.2.颜色条📊</h2><p id="1e46" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">现在，让我们看看如何将数据条添加到数据帧中。我们将首先创建一个数据透视表，然后使用<code class="fe md me mf mg b">.bar()</code>创建数据栏:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="32e1" class="nv mv jj mg b gy nw nx l ny nz"># Create a pivot table with missing data<br/>pivot = df.pivot_table('mass', ['species', 'island'], 'sex')<br/>pivot.iloc[(-2,0)] = np.nan</span><span id="b134" class="nv mv jj mg b gy oa nx l ny nz"># Style<br/>pivot.style.bar(color='aquamarine')</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/14d518f836d553062f462d7a492d747b.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*VsPCvWpbnEFLzo-cTiN9zA.png"/></div></figure><p id="575a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这可以像前面的例子一样进一步设计:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="deb3" class="nv mv jj mg b gy nw nx l ny nz">(pivot.style<br/>     .bar(color='aquamarine')<br/>     .set_properties(padding='8px', width='50'))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ov"><img src="../Images/d58a51f385de44e470ea6b3136087b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*d9r7eJHB7exKt1OpikJPoQ.png"/></div></div></figure><p id="a617" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">之前我们熟悉了这种格式:<code class="fe md me mf mg b">.set_properties(**{'padding': '8px', 'width': '50'})</code>。上面的代码显示了将参数传递给<code class="fe md me mf mg b">.set_properties()</code>的另一种方法。</p><p id="8a34" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果您有正值和负值，您可以通过传递两种颜色(<code class="fe md me mf mg b">color=['salmon', 'lightgreen']</code>)并在中间对齐条形(<code class="fe md me mf mg b">align='mid'</code>)将数据格式化如下:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="9540" class="nv mv jj mg b gy nw nx l ny nz"># Style on toy data<br/>(pd.DataFrame({'feature': ['a', 'b', 'c', 'd', 'e', 'f'],  <br/>               'coefficient': [30, 10, 1, -5, -10, -20]}).style<br/>   .bar(color=['salmon', 'lightgreen'], align='mid')<br/>   .set_properties(**{'text-align': 'center'})<br/>   .set_table_styles([{'selector': 'th.col_heading', <br/>                       'props': 'text-align: center'}]))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/d2a2f79f1563142dcb2a435996f69980.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*6yfZn-wZ6SxDU4gzs1XDSQ.png"/></div></figure><p id="b756" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里，我们还确保列标题和值居中对齐。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="39d8" class="nv mv jj bd mw oe of dn na og oh dp ne lq oi oj ng lu ok ol ni ly om on nk jp bi translated">1.3.突出🔆</h2><p id="e6a9" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">有时候，根据条件突出显示值会很有用。在本节中，我们将学习一些突出特殊值的函数。</p><p id="7d5b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先，我们可以突出显示每列的最小值，如下所示:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="efaa" class="nv mv jj mg b gy nw nx l ny nz">pivot.style.highlight_min(color='pink')</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/46f45232afe172053e2ef7e72cc45621.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*rqXl-S3l0uhXWTrwiFr43g.png"/></div></figure><p id="b52b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最大值有一个等价函数:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="b1cf" class="nv mv jj mg b gy nw nx l ny nz">pivot.style.highlight_max(color='lightgreen')</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/2370c9aff21c40aa1fe3d9ffd9389a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*qbg5ifvbSXN1BLltbDAYUA.png"/></div></figure><p id="5f91" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以像这样将这些高亮功能链接在一起:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="f18d" class="nv mv jj mg b gy nw nx l ny nz">(pivot.style<br/>     .highlight_min(color='pink')<br/>     .highlight_max(color='lightgreen'))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/5b55ec8dd8836fac594383dbd035fff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*Qs2LtJ_JBqTTIIdUIa_Fmw.png"/></div></figure><p id="9bc2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">还有一个突出显示缺失值的功能。让我们将它添加到前面的代码片段中:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="7ad8" class="nv mv jj mg b gy nw nx l ny nz">(pivot.style<br/>      .highlight_min(color='pink')<br/>      .highlight_max(color='lightgreen')<br/>      .highlight_null(null_color='grey'))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/5dee5f14362b85bda79ccc2c2ba81000.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*2vfkyP5WwGdhe9LM5MOGpQ.png"/></div></figure><p id="ba0b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这些内置函数很容易使用，不是吗？在结束本节之前，让我们再看两个函数。我们可以突出显示如下范围内的值:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="50e6" class="nv mv jj mg b gy nw nx l ny nz">pivot.style.highlight_between(left=3500, right=4500, color='gold')</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/75643a3bf71c6b16a692bbe40b518c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*Vi8DO0vEVXFzJ1t6_NySQw.png"/></div></figure><p id="ffbf" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们还可以突出分位数:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="3f85" class="nv mv jj mg b gy nw nx l ny nz">pivot.style.highlight_quantile(q_left=0.7, axis=None, <br/>                               color='#4ADBC8')</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/782754678df05973e3d3c3afa375debd.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*e-NWCDAsA0_Sa1Ze90Rwog.png"/></div></figure><p id="80ba" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里，我们突出显示了前30%。</p><p id="d235" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">到目前为止，我们已经使用了几种不同的颜色。如果你想知道你还可以使用什么颜色名称，请查看<a class="ae jg" href="https://matplotlib.org/3.1.0/gallery/color/named_colors.html" rel="noopener ugc nofollow" target="_blank">这个颜色名称资源</a>。如上例所示，您也可以使用十六进制颜色，这将使您获得更广泛的选择(超过1600万种颜色！).这里是我最喜欢的探索十六进制颜色代码的资源。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="b1a1" class="nv mv jj bd mw oe of dn na og oh dp ne lq oi oj ng lu ok ol ni ly om on nk jp bi translated">1.4.自定义颜色代码🎨</h2><p id="3bea" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">在这最后一节中，我们将看看其他一些使用自定义函数对数据帧进行颜色编码的方法。我们将使用以下两种方法来应用我们的自定义样式函数:<br/> ◼️ <code class="fe md me mf mg b">.applymap()</code>:元素式<br/> ◼️ <code class="fe md me mf mg b">.apply()</code>:列/行/表格式</p><h2 id="0d71" class="nv mv jj bd mw oe of dn na og oh dp ne lq oi oj ng lu ok ol ni ly om on nk jp bi translated"><strong class="ak">元素式应用:。applymap() </strong></h2><p id="e091" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">让我们通过从数字列中截取前8行来创建一个小的数字数据。我们将使用lambda函数将190以上的值着色为蓝色，其余部分为灰色:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="cc0c" class="nv mv jj mg b gy nw nx l ny nz">df_num = df.select_dtypes('number').head(8)<br/>(df_num.style<br/>    .applymap(lambda x: f"color: {'blue' if x&gt;190 else 'grey'}"))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/08a6482cd02c9257a1b5bc463f536013.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*_J5OXaV21D7sF4aexbG5gw.png"/></div></figure><p id="d04c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">让我们看另一个例子:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="d797" class="nv mv jj mg b gy nw nx l ny nz">green = 'background-color: lightgreen'<br/>pink = 'background-color: pink; color: white'<br/>(df_num.style<br/>       .applymap(lambda value: green if value&gt;190 else pink))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/d43d4590ef210304ee050992c4c28207.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*hBOdqZFgJONhIRFH0iT2_w.png"/></div></figure><p id="3dd1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以将lambda函数转换成常规函数，并将其传递给<code class="fe md me mf mg b">.applymap()</code>:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="0623" class="nv mv jj mg b gy nw nx l ny nz">def highlight_190(value):<br/>    green = 'background-color: lightgreen'<br/>    pink = 'background-color: pink; color: white'<br/>    return green if value &gt; 190 else pink</span><span id="1408" class="nv mv jj mg b gy oa nx l ny nz">df_num.style.applymap(highlight_190)</span></pre><h2 id="5656" class="nv mv jj bd mw oe of dn na og oh dp ne lq oi oj ng lu ok ol ni ly om on nk jp bi translated">行/列/表方式应用程序:。应用()</h2><p id="0a22" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">让我们看看如何使用<code class="fe md me mf mg b">.apply()</code>进行同样的格式化:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="f1d8" class="nv mv jj mg b gy nw nx l ny nz">def highlight_190(series):<br/>    green = 'background-color: lightgreen'<br/>    pink = 'background-color: pink; color: white'<br/>    return [green if value &gt; 190 else pink for value in series]</span><span id="5aaf" class="nv mv jj mg b gy oa nx l ny nz">df_num.style.apply(highlight_190)</span></pre><p id="1ca3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们也可以像前面的函数一样链接它们:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="7acf" class="nv mv jj mg b gy nw nx l ny nz">(df_num.style<br/>       .apply(highlight_190)<br/>       .applymap(lambda value: 'opacity: 40%' if value&lt;30 <br/>                 else None))</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/669895df9ca68e803e750e7991914f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*cvOw2yzw89kjPkJ6ksnB_Q.png"/></div></figure><p id="638c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">知道如何同时使用<code class="fe md me mf mg b">.apply()</code>和<code class="fe md me mf mg b">.applymap()</code>很有用。这里有一个例子，我们可以使用<code class="fe md me mf mg b">.apply()</code>，但不能使用<code class="fe md me mf mg b">.applymap()</code>:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="1e61" class="nv mv jj mg b gy nw nx l ny nz">def highlight_above_median(series):<br/>    is_above = series&gt;series.median()<br/>    above = 'background-color: lightgreen'<br/>    below = 'background-color: grey; color: white'<br/>    return [above if value else below for value in is_above]<br/>df_num.style.apply(highlight_above_median)</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/e366588ca0f503f171320cdaa3f54c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*coqGURbkXLnPTuKnt3gxBA.png"/></div></figure><p id="4415" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们找到每一列的中间值，用绿色突出显示高于中间值的值，用灰色突出显示其余的值。我们还可以使用<code class="fe md me mf mg b">.apply()</code>根据条件来设计整列的样式:</p><pre class="mi mj mk ml gt nr mg ns nt aw nu bi"><span id="22d9" class="nv mv jj mg b gy nw nx l ny nz">def highlight(data):<br/>    n = len(data)<br/>    if data['sex']=='Male':<br/>        return n*['background-color: lightblue']<br/>    if data['sex']=='Female':<br/>        return n*['background-color: lightpink']<br/>    else:<br/>        return n*['']</span><span id="73f6" class="nv mv jj mg b gy oa nx l ny nz">df.head(6).style.apply(highlight, axis=1).hide_index()</span></pre><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/9212b7bec9e048f0d93dc3ef5e488f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*4GhR3-zjEBwPIhvyJRKYSw.png"/></div></figure><p id="ddc3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里，我们用<code class="fe md me mf mg b">.hide_index()</code>隐藏了DataFrame的索引，以获得更清晰的外观。如果需要，您也可以使用<code class="fe md me mf mg b">.hide_columns()</code>隐藏列。</p><p id="786f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，我们在这篇文章中看到的大多数函数都采用可选参数来定制样式。下面两个参数是常见的，知道它们非常有用:<br/> ◼ ️ <code class="fe md me mf mg b">axis</code>用于沿哪个轴操作:列、行或整个表<br/> ◼️ <code class="fe md me mf mg b">subset</code>用于选择要样式化的列的子集。</p><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pg"><img src="../Images/b4371d71ca0b425f096e710eed1e0a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ac3ntYvAVsfMiiRV"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">卢卡斯·本杰明在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a145" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">希望你喜欢学习通过颜色编码美化数据帧的有用方法。样式化的数据框架有助于更轻松地探索和分析数据，并使您的分析更具可解释性和吸引力。如果你热衷于学习更多关于造型的知识，看看熊猫的这个有用的文档。</p><p id="e9fa" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="od">您想要访问更多这样的内容吗？媒体会员可以无限制地访问媒体上的任何文章。如果您使用</em> <a class="ae jg" href="https://zluvsand.medium.com/membership" rel="noopener"> <em class="od">我的推荐链接</em></a><em class="od">成为会员，您的一部分会费将直接用于支持我。</em></p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><p id="a67f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">感谢您阅读这篇文章。如果你感兴趣，这里有我关于熊猫的一些其他帖子的链接:<br/> ◼️️ <a class="ae jg" rel="noopener" target="_blank" href="/from-pandas-to-pyspark-fd3a908e55a0">从熊猫到PySpark </a> <br/> ◼️️ <a class="ae jg" rel="noopener" target="_blank" href="/writing-5-common-sql-queries-in-pandas-90b52f17ad76?source=your_stories_page-------------------------------------">在熊猫中编写5个常见的SQL查询</a> <br/> ◼️️ <a class="ae jg" rel="noopener" target="_blank" href="/writing-advanced-sql-queries-in-pandas-1dc494a17afe?source=your_stories_page-------------------------------------">在熊猫中编写高级SQL查询</a> <br/> ◼️️ <a class="ae jg" rel="noopener" target="_blank" href="/5-tips-for-pandas-users-e73681d16d17?source=your_stories_page-------------------------------------">给熊猫用户的5个提示</a> <br/> ◼️️ <a class="ae jg" rel="noopener" target="_blank" href="/5-tips-for-data-aggregation-in-pandas-7eaa8476dc75?source=your_stories_page-------------------------------------">在熊猫中进行数据聚合的5个提示</a> <br/> ◼️️ <a class="ae jg" rel="noopener" target="_blank" href="/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1?source=your_stories_page-------------------------------------">如何在熊猫数据框架中转换变量</a> <br/></p><p id="71cd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">再见🏃 💨</p></div></div>    
</body>
</html>