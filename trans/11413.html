<html>
<head>
<title>Understanding Surrogate Models and Their Benefits in Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解代理模型及其在数据科学中的优势</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-surrogate-models-and-their-benefits-in-data-science-5cdc81a0509a?source=collection_archive---------20-----------------------#2021-11-09">https://towardsdatascience.com/understanding-surrogate-models-and-their-benefits-in-data-science-5cdc81a0509a?source=collection_archive---------20-----------------------#2021-11-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5e56" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">R&amp;D使用的一些模型继承自基础理论，可能很难操作或转移。这个现实生活中的例子(带有代码)解释了为什么代理模型提供了一个有趣的替代方案。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/68fc8eb49628f496d5a7e73acbf20bed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-aFhUgF1jdcF60k3"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阿诺·塞纳尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="fc38" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">理论方法与替代方法</h1><p id="1a81" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，区分我们将在本文中讨论的两种模型之间的主要区别是很重要的:</p><ul class=""><li id="7a2d" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><strong class="lt iu">理论模型</strong>应该被认为是“现象学的”模型，继承自科学知识并以方程的形式表达，就像(很简单！)下面一个:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1305f10ca148592ca2e2884a1e7200e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*X8WpSwtuDJdv8ijiJc-PkQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">理论压力公式</strong> <br/>图片作者</p></figure><ul class=""><li id="a52f" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><strong class="lt iu">替代模型</strong>基于经验和/或模拟数据。它们只是理论模型的一种“接近的表示”,并且，通过延伸，是地面真相的一种“接近的表示”。它们通常不太准确，但也不太复杂。<strong class="lt iu">机器学习模型属于第二类，因为它们几乎总是只依赖于观察。</strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/6237a30dbb40275a7ac4302335144e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*RFZZ4vXkzLfcfKZ9EWr5Yg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">通过测量100种不同的力和面积组合</strong> <br/>下的压力<br/>推导出的替代公式图片由作者提供</p></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="f2c4" class="kz la it bd lb lc ni le lf lg nj li lj jz nk ka ll kc nl kd ln kf nm kg lp lq bi translated">那么，当我们已经有了理论模型，为什么还要对使用代理模型感兴趣呢？</h1><p id="6c43" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">想象一个研发部门正在设计一个新的流程。他们想要模拟每个分子的行为方式，或者至少，以最精确的方式模拟这个过程。</p><p id="9910" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">为了达到这样的精度，他们将使用模拟解决方案，其中嵌入了对过程及其相应的机械方程式的详细描述，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/38c84c9ed7adfa86a8f1f04f770a6f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/0*ZetWtj9T6poJa8mM.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">gPROMS的屏幕截图—包含在Process Systems Enterprise的kind授权中</p></figure><p id="65b0" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">这一步完成后，工程部门的同事们准备开始在新车间中集成该设备，他们渴望从R&amp;D的准备工作中受益…但他们面临一些限制:</p><ul class=""><li id="6107" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><strong class="lt iu">软件</strong>:模拟工具可能很贵，而且由于他们的公司想要限制可用许可证的数量，他们无法使用这些工具。此外，理论模型的格式不能用它们自己的工具来解释。</li><li id="3489" class="mn mo it lt b lu nr lx ns ma nt me nu mi nv mm mu mv mw mx bi translated"><strong class="lt iu">计算</strong>:模拟的计算量可能很大，即使工程部门可以访问理论模型，他们也无法在更大的范围内将所有局部和复杂的模型结合起来，以模拟整个车间或工厂的行为。<em class="nw">这就像试图通过整合每个引擎的工作方式来描述道路交通的变化……而每辆车的速度就足够了。</em></li><li id="425f" class="mn mo it lt b lu nr lx ns ma nt me nu mi nv mm mu mv mw mx bi translated"><strong class="lt iu">保密</strong> : R &amp; D确实同意在内部分享其工作成果，但也将这一新流程视为公司知识产权的一部分。由于工程部门可能会分包他们的一些研究，R &amp; D不愿意完全透露这个过程是如何设计的。他们宁愿把它表达成一个“黑匣子”，只有动态的输入和输出，对周围的环境作出反应。</li></ul><p id="8254" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated"><strong class="lt iu">出于上述所有原因，代理模型可以代表一种有趣的替代方案，以降低所需的计算能力，同时允许与标准工具更好的兼容性，并且不会泄露公司的知识产权。</strong></p><p id="447c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">如下所述，同样的过程动力学可以从纯理论的观点或从“接近”的观点来表达:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/848fb34693263cdcc6ff3b521baa388c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oAdyoWdnnn7hxeaQFa1aqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">理论模型Vs代理模型</strong>(图片由作者提供—图标来源:<a class="ae ky" href="http://flaticon.com" rel="noopener ugc nofollow" target="_blank">flaticon.com</a>)</p></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="c2dd" class="kz la it bd lb lc ni le lf lg nj li lj jz nk ka ll kc nl kd ln kf nm kg lp lq bi translated">现实生活中的应用呢？</h1><p id="00cc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">之后描述的工作是我和我的R&amp;D同事Baptiste Boit进行的第一个实验的净化版本，他一直在推动我(几个月来！)来开发代理模型…直到我明白这个概念有多关键！</p><p id="ccf8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated"><em class="nw">完整的源代码——代码和模拟数据——可以在GitHub(本文末尾的链接)上找到。</em></p><p id="5bc0" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">我们的目标是从具有以下特征的流程中创建一个代理模型:</p><p id="57b4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated"><strong class="lt iu">两个初始条件(X)定义了100个周期(时间)期间动态批处理的行为，通过2个输入变量和3个输出变量(Y)表示:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/c78d64fa91ddb73b86d413b80d21536f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YuFKNsBvL56VfOXOHXImLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">描述过程的“笨拙”公式=作者图片</p></figure><p id="a963" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">Baptiste模拟了200个不同的批次(“样本指数”从0到199)，每个批次都以不同的起始条件(“Init_Cond_1”和“Init_Cond_2”)开始，就像一个标准的“实验设计”。</p><p id="f0a4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">为了让它更容易理解，我将动态变量的数量从5个减少到了3个。这些动态变量(Dyn_Input_1、Dyn_Input_2和Dyn_Output_1)的值在每个批次的每个周期都会被记录，并已被归一化(MinMaxScaler()):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b10705b6a48ebaae8d7d23e91eb1791d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*RW3A5EIAWRTbzCVndvSFcg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">作者第一批</strong> <br/>模拟图像的前20行</p></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="bc78" class="kz la it bd lb lc ni le lf lg nj li lj jz nk ka ll kc nl kd ln kf nm kg lp lq bi translated">探索模拟数据</h1><p id="3589" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们首先绘制初始条件的分布，正如人们所预料的那样，它们在两个范围内以类似DoE的方式均匀随机分布:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/cfb286ab44ff808fa4897337828b45a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*6jUPyO-umwj6ez-QnnG9gg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">传播的初始条件</strong> <br/>图片作者</p></figure><p id="b28d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">为了便于进一步研究，让我们将这些数据整合到一个200行的数据框架中，该数据框架为每批数据编译三个动态变量的序列(100个数据点):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/6d7345438a14b8f69ead73a50c5a3e8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFDo-gbxpmWjNUDyKn3rTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">综合数据框</strong> <br/>图片作者</p></figure><p id="0f3e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">让我们随机选择20个批次，显示变量的动态，看看它们的轮廓是什么样的(每种颜色对应一个批次):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/47c13af1e3c0af696bb0eb7782fef163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3jKnt3ZJkzCgTu3KcSoiTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">20个不同批次的动态变量样本</strong> <br/>作者图片</p></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="9e4e" class="kz la it bd lb lc ni le lf lg nj li lj jz nk ka ll kc nl kd ln kf nm kg lp lq bi translated">从动态变量中提取功能特征</h1><p id="d6a5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以观察到“<strong class="lt iu"> Dyn_Input_1 </strong>”具有线性轮廓。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b3444ed8af4b4ae0eccc0c8a8bdad647.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*PgCnpNGF3JxoYhsJUx4BXA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">作者提供的20个不同批次</strong> <br/>图像的“Dyn_Input_1”样本</p></figure><p id="7e30" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">现在的问题是:“<strong class="lt iu">这些配置文件中的每一个与初始条件有什么关系？</strong></p><p id="8f4d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">由于我们不能直接比较初始条件(2个值)和“Dyn_Input_1”行为(100个连续事件)，我们需要找到一个代理！</p><p id="a94e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">在这种情况下，我们可以对每一批应用线性回归，并提取相应的系数。由于所有事件都从(0，0)坐标开始，因此只有斜率(a1，a2，…)会带来相关信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9fa57bc77366e92686a2362fbcedb211.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*7zQbWl6MZ3Lk_lDzzCVSHg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">动态变量的行为及其对应的线性方程</strong> <br/>作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/f3fa804eb166f419763072bc8b750d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6ZwtKz-Zy6zFub_RRfbrA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">作者使用Dyn_Input_1系列、系数和分数的合并数据框架</strong> <br/>图片</p></figure><p id="8fd5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">一旦提取了这两个特征(线性回归系数和相应的分数；上面最后两列)，我们高兴地看到系数和初始条件#2之间的相关性非常强:<strong class="lt iu"> 0.996 </strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7d34e20819e8408a364cbd71b8aca1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*2QcngRwMQu07ihE3yfSj3A.png"/></div></figure><p id="be66" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">这意味着，如果我们知道初始条件#2的值，我们就能够推断出动态输入#1的相应斜率(=系数)，并最终推断出100个连续事件的值。</p><p id="c9b7" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">到目前为止，一切顺利😀</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="b8a9" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated"><strong class="lt iu">动态输入#2 </strong>有一个稍微复杂一点的轮廓:<strong class="lt iu">第n根</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/5aab1c844066be57c36490f25c014f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*GZxBF6Jtdqi226U6cFXA2A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">作者提供的20个不同批次</strong> <br/>图像的“Dyn_Input_2”样本</p></figure><p id="f75e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">与动态输入#1一样，我们需要找到一个比100个数据点序列更简单的代理来表达每一批的行为。</p><p id="391b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">我们仍然可以依赖线性回归，但是首先，需要对序列进行转换:我的方法是对时间=0到值达到预定义阈值0.00003之间的部分进行“根转换”，如下例所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/6c2a044c8e3ace26e4ae50a8b6b799d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*HTExUvH4HpEmXXtRGa4Ppw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">n次根变换对原始Dyn_Input_2变量(双标度)的影响</strong> <br/>作者提供的图像</p></figure><p id="3207" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">为了定义这个阈值，我查看了200条曲线，并确定了大多数曲线(如果不是全部的话！)开始渐近。该“根部截面极限”范围在7(最小值)、14(中值)和43(最大值)之间:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/334b1d496b472170904aadd865344bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*ozakMuyg86QyMt-zzPXngg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">根节限上200批次</strong> <br/>图片作者</p></figure><p id="c3f6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">应用变换后，我们提取每个模拟的回归系数和截距，并检查这些特征和初始条件之间是否存在相关性:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/35f0714cc3991b403e6708b30b157e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JmQqEwAcxv0B-LaaQz9sww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">作者使用Dyn_Input_2系列、系数和分数</strong> <br/>图像合并数据框架</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/ee1c615b4b1afab9a9842b9af4036cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*Oc4ohZ94zbTYnbY_Z41E1w.png"/></div></figure><p id="3d31" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">我们可以观察到，动态输入#2的斜率也与初始条件#2高度相关(<strong class="lt iu"> 0.995 </strong>)，并且其截距与初始条件#1相关(<strong class="lt iu"> 0.84 </strong>)。至于动态输入#1，我们现在可以从唯一的初始条件值中推导出动态输入#2的行为。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="16a6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated"><strong class="lt iu">动态输出#1 </strong>具有第三种类型的曲线:在时间=0和时间=0.1001之间急剧增加之后，它是具有小负斜率的线性曲线:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/2a4ff4607a83f665af85d3e22a588193.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*XU6JnackScnANDv5WrwlkQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">20个不同批次的“Dyn_Output_1”样本</strong> <br/>作者提供的图片</p></figure><p id="0cfa" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">我们可以用同样的方法提取3个相关特征:</p><ul class=""><li id="c611" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><strong class="lt iu">初始值</strong>(时间=0时)</li><li id="dec1" class="mn mo it lt b lu nr lx ns ma nt me nu mi nv mm mu mv mw mx bi translated"><strong class="lt iu">系数</strong>和<strong class="lt iu">截距</strong>的线性行为从时间=0.1001</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/970cc2f75ed943fde44c2029a9b5fe38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ugwMQFra-vHe0SMWlTrmRg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz">作者使用Dyn_Input_1系列、系数和分数</strong> <br/>图像合并数据框架</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/c31b5edef68466659feccd267ab0ea5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*YqofZ5Kmkk6oJghOIebxIw.png"/></div></figure><p id="d61a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">同样，我们可以观察到初始条件#2和第三个动态变量之间的强相关性。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="9202" class="kz la it bd lb lc ni le lf lg nj li lj jz nk ka ll kc nl kd ln kf nm kg lp lq bi translated">动态变量与初始条件和模型建立的总体相关性</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/234c09d6baa47c940e070683d4e05ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*I_F6vxXQXzb1s07I20qcXA.png"/></div></figure><p id="47fa" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">既然提取了每个动态变量的特征，并且建立了与初始条件的相关性，我们可以为每个动态变量创建一个线性模型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/b37a94ee4065e2e4709289ba449da64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*up4j60xpgiqAvT9zN6eYcw.png"/></div></figure><p id="62ff" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">为了使这些代理模型更容易访问，我们可以创建一个“SurrogatePrediction”类，它有3种不同的方法，可以根据我们提供的初始条件生成预测的时间序列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/d34da987d57cd87b19bff41d9222f41a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*2MZ9cj-XVr6xY8ydki19hg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/37e152bfa84c59944aeb9375193b30e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*fjcFI9UH4cPekji2QACiXw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/e38f4db5e3003566a427174361eb91a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*POPB08hKBuRK0KCP_Yobsw.png"/></div></figure><p id="15fa" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">让我们选择两个随机初始条件，直观地比较替代模型预测和地面真实情况:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/69136177a83ed276549571190f8655b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*C57NDywb9aiqXmOpiXPSCg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz"> Dyn_Input_1(预测与真实)</strong> —作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/c4e11c58e05eaaf9c5b8525e76975695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*r9cbOT7PsB_ynI_qyVcGSA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz"> Dyn_Input_2(预测与真实)</strong> —作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/8e48ca204e0888619d3bc1d8d43bf771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*pJB7k4p13QgIDrxUkrKwaw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mz"> Dyn_Output_1(预测与真实)</strong> —作者图片</p></figure><h1 id="6bae" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="bfa8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们现在拥有三个代理函数，它们只能通过它们的系数/截距来表达，并且可以模拟原始进程的行为方式，而不会暴露其核心设计。</p><p id="5469" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">它们是用Python开发的，但可以很容易地转换成其他格式，因为它们只是简单数学方程的组合！</p><p id="b2fa" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">任务完成！😀</p><p id="f7eb" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">注意:有人可能会说，这种模型可以更容易地用随机森林或梯度增强树这样的算法来实现。这是真的，我自己测试过(包含在GitHub库中)。由于训练集和测试集之间良好的同质性，验证分数超过99%。然而，缺点是像系综树这样的“复杂”模型很难用另一种语言或仅通过方程来移植。</p><p id="3018" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">再次感谢巴蒂斯特·博伊特🙏早在我之前就理解了这种方法对于制造/加工行业以及其他行业来说是一个至关重要的话题！</p><p id="fff8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">相应的代码存储在这里:</p><div class="ow ox gp gr oy oz"><a href="https://github.com/pierrelouisbescond/surrogate_model_demo" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">GitHub-pierrelouisscond/surrogate _ model _ demo</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">github.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ks oz"/></div></div></a></div><p id="9fa6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nn mc md me no mg mh mi np mk ml mm im bi translated">请不要犹豫，浏览我在Medium上的其他文章:</p><div class="ow ox gp gr oy oz"><a href="https://pl-bescond.medium.com/pierre-louis-besconds-articles-on-medium-f6632a6895ad" rel="noopener follow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">皮埃尔-路易·贝斯康德关于媒介的文章</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">数据科学、机器学习和创新</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">pl-bescond.medium.com</p></div></div><div class="pi l"><div class="po l pk pl pm pi pn ks oz"/></div></div></a></div></div></div>    
</body>
</html>