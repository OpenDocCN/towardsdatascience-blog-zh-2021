<html>
<head>
<title>How to Reshape a Pandas DataFrame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何重塑熊猫数据框架</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-reshape-a-pandas-dataframe-98b42c428a8?source=collection_archive---------4-----------------------#2021-04-28">https://towardsdatascience.com/how-to-reshape-a-pandas-dataframe-98b42c428a8?source=collection_archive---------4-----------------------#2021-04-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5ba71679e33928c2514ae126d8800ba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEqyN2nTV3r4OeH91daJuQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@lara_corviello?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> ☀️Shine_拍摄</a>在<a class="ae jg" href="https://unsplash.com/s/photos/dough?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h2 id="8209" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">入门指南</h2><div class=""/><div class=""><h2 id="ba4c" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">了解操作数据的基本方法</h2></div></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="f3c0" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><em class="mk">我记得小时候经常玩黏土和砖块模型。</em></p><p id="1e6e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我最喜欢的不是玩具本身，而是用小零件建造和塑造东西的乐趣。</p><p id="081b" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">让我着迷的是，只有把两块砖放在正确的位置上，它们才能组合在一起。</p><p id="2ce6" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">从那里，你可以构建任何你想要的东西。</p><p id="2d6c" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><em class="mk">作为一名成年的数据科学家，我发现与数据打交道有某种魔力。</em></p><p id="92b1" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><em class="mk">你可以有很多特征供你分析。但是只有当你把它们放入正确的格式中时，你才会发现你正在寻找的模式。</em></p><p id="08d9" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi ml translated">andas是一个开源库，允许数据科学家使用高性能、易于使用的数据结构和Python中的数据分析工具。它的核心数据结构是<strong class="lq jt"> DataFrame </strong>，其中数据以表格形式表示，带有标记的行和列。</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mu"><img src="../Images/be055c112d6b6322d0541b698cdaf5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Irlnlv2foyvWWw6YRxnBjg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">数据帧的结构。作者图片</p></figure><p id="f648" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">数据可能以不同的格式组织，我们稍后会提到。并不是所有的都适合我们想要进行的分析。</p><p id="dd5e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">幸运的是，Pandas允许我们以多种方式改变数据帧的结构。但首先，在解释这些变化是如何发生的之前，我们需要理解形状的概念。</p><p id="a52b" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">形状是指数据集如何组织成行和列。</p><p id="285f" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">为了澄清这一点，让我们使用一个包含关于<a class="ae jg" href="https://www.kaggle.com/sidtwr/videogames-sales-dataset" rel="noopener ugc nofollow" target="_blank"> <em class="mk"> Playstation 4视频游戏销售</em> </a>的特征的数据集。</p><figure class="mv mw mx my gt iv"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nb"><img src="../Images/c5842878b2d1c52d0eba1b885f346afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5t1qBoPZ7ExoagWwvMzLJQ.png"/></div></div></figure><p id="024f" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">当我们检查它的形状时，我们可以看到它包含825行和9列。为什么知道数据帧的形状很重要？因为数据既可以是<em class="mk">长格式</em>，也可以是<em class="mk">宽格式</em>。</p><p id="1d3a" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">让我们仔细看看这个数据框架。</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/ab24065934336154bf99e990d9181bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lO9lrqwUwMriiYm5OMmrOw.png"/></div></div></figure><p id="ae7d" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我们可以观察到以下情况:</p><ul class=""><li id="b661" class="nd ne jj lq b lr ls lu lv lx nf mb ng mf nh mj ni nj nk nl bi translated">每个功能都在单独的列中</li><li id="b4de" class="nd ne jj lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated">每一行包含同一个玩家的许多特征</li><li id="9661" class="nd ne jj lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated">有缺失的值</li></ul><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nr"><img src="../Images/e433f022a503821b9d5bf7488ef73a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SrC3ZLMDX-ZaRmj4Jjj2Lg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">宽格式的特征。作者图片</p></figure><p id="df1d" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">这些是<strong class="lq jt">宽格式</strong>的显著特征。这种格式适用于简单的统计，如计算平均值、输入缺失值、演示列之间的关系或对变量进行时间序列运算。</p><p id="3d28" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">现在，我们来看看相同的数据集，但格式不同。</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ns"><img src="../Images/dedb53c2d7c6603fe1f19eee098d1d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dHV9spkDyLQ409xGgehbHw.png"/></div></div></figure><p id="efae" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我们可以看到:</p><ul class=""><li id="cb73" class="nd ne jj lq b lr ls lu lv lx nf mb ng mf nh mj ni nj nk nl bi translated">每行代表一个特征</li><li id="52b4" class="nd ne jj lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated">每个游戏多行。每个特性一个。</li><li id="1770" class="nd ne jj lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated">一列，即<code class="fe nt nu nv nw b">Game</code>列，通过记录识别相同的游戏。</li><li id="265b" class="nd ne jj lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated">没有缺失值。如果某个特定游戏的某个特性没有值，那么就没有对应的行。</li></ul><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/d5be5d7a0bad9a717030f3dd20370d78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qogxmNsmDFTdsZZej6jekA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">长格式的特征。作者图片</p></figure><p id="2a89" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">这些是通常被视为整齐数据集标准的<strong class="lq jt">长格式</strong>的典型特征。这通常是首选格式，因为它可以更好地汇总数据。它具有键-值对结构，许多高级图形和分析技术都需要这种格式的数据。</p><p id="a72b" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">作为一名数据科学家，您的分析的某些部分将需要长格式的数据，但其他部分将只处理宽数据。</p><p id="b558" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">要决定使用长格式还是宽格式，要考虑哪一种是分析的单位。对于长格式，你总是对一个游戏的每个特点感兴趣。对于宽格式，你对每个游戏都感兴趣。</p><blockquote class="ny"><p id="3d55" class="nz oa jj bd ob oc od oe of og oh mj dk translated">重塑数据可以定义为将数据从宽格式转换为长格式，反之亦然。</p></blockquote><p id="9309" class="pw-post-body-paragraph lo lp jj lq b lr oi kt lt lu oj kw lw lx ok lz ma mb ol md me mf om mh mi mj im bi translated"><em class="mk">那么，我们如何从宽格式转换到长格式，或者从长格式转换到宽格式呢？</em>让我们来看看熊猫中可用的一些工具。</p><p id="3e73" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi ml translated"><span class="l mm mn mo bm mp mq mr ms mt di"> 1 </span>获得一个数据帧是很有用的，其中一列或多列是标识符变量，而其他列不与行轴关联，只留下两个非标识符列，缺省情况下名为<code class="fe nt nu nv nw b">variable</code>和<code class="fe nt nu nv nw b">value</code>。</p><p id="53a5" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">让我们想象一下，我们想要在一个箱线图中绘制PS4游戏在不同地区的销售情况。此任务要求数据采用长格式。但是我们的数据是以一种广泛的格式存储的。那么我们如何使用<em class="mk">融化</em>来重塑它呢？</p><p id="8b43" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">该函数的语法如下所示:</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/d1a6114d629bf4209877448d8fec761f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WoyTp75ip2boPI74gDDuXw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">融化功能。作者图片</p></figure><p id="0612" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我们可以观察到，当使用<code class="fe nt nu nv nw b">.melt()</code>时，我们需要首先传递数据帧。要设置的下一个参数是<code class="fe nt nu nv nw b">id_vars</code>。该参数将列名用作标识符变量。在我们的例子中，我们希望用作标识符的值是列<em class="mk"> Game </em>。</p><p id="69cf" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><code class="fe nt nu nv nw b">value_vars </code>参数接受我们想要融合的列的名称。这可以只是一列，也可以是许多列的列表。我们希望将不同地区的销售数据列作为融化列(<em class="mk">北美</em>、<em class="mk">欧洲</em>、<em class="mk">日本</em>、<em class="mk">世界其他地区</em>)。</p><p id="96ff" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><code class="fe nt nu nv nw b">var_name</code>参数接受用于列<em class="mk">变量</em>的名称。在我们的例子中，我们将它命名为<em class="mk">区域</em>。最后，参数<code class="fe nt nu nv nw b">value_name</code>采用了用于列<em class="mk">值</em>的名称。我们希望它被命名为<em class="mk">销售</em>。</p><p id="25d7" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">现在，我们可以将<em class="mk">融化</em>应用到我们的数据帧上，然后绘制出我们想要的图形。</p><figure class="mv mw mx my gt iv"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/569a8b76bfce5e08ffc3f446241692b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w9vBvWryyVsd-2dms_3Hzg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="85a2" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi ml translated"><span class="l mm mn mo bm mp mq mr ms mt di"> 2 </span> <strong class="lq jt"> <em class="mk">宽转长</em> </strong> : <code class="fe nt nu nv nw b"><a class="ae jg" href="https://pandas.pydata.org/docs/reference/api/pandas.wide_to_long.html" rel="noopener ugc nofollow" target="_blank">.wide_to_long()</a></code>是另一个可以帮助我们将数据由宽转长的函数。该功能没有<em class="mk">熔化</em>灵活，但更加用户友好。</p><p id="5f0e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">这个函数有一个特点:它期望找到一组或多组格式为<em class="mk">A-后缀1，A-后缀2，B-后缀1，B-后缀2 </em>等的列。</p><p id="f4f4" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">所以让我们看看它的运行，这样我们可以更深入地分析它的语法。为了充分利用该功能，我们将重命名一些列。</p><figure class="mv mw mx my gt iv"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/47d2deafe48d3745ab4dace0ff85d774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*okl8LudqWmtmKlpHpuRNOg.png"/></div></div></figure><p id="8e69" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我们可以看到，现在有些栏目的名称以<em class="mk">销售</em>字样开头。这些是不同地区的销售数据。</p><p id="0064" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">所以我们准备应用<code class="fe nt nu nv nw b">wide_to_long()</code>功能。该函数有几个参数:</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/65842e588baa80cdd4785fec08084059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYOiUbrOMtx5bzQUSRGr2w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">宽到长函数。作者图片</p></figure><p id="d004" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">第一个参数是我们要转换的数据帧。<code class="fe nt nu nv nw b">stubnames</code>参数用于指定<strong class="lq jt"> <em class="mk">前缀</em> </strong>，这是宽列名称的开始。</p><p id="3120" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><code class="fe nt nu nv nw b">j</code>参数告诉pandas我们希望如何命名包含后缀或宽列末尾的列。然后，<code class="fe nt nu nv nw b">i</code>参数接受我们将用作唯一标识符的列或列列表。该列将是长数据帧的索引。</p><p id="659d" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">Pandas假设前缀后面紧跟一个数字后缀。为了克服这个问题，<code class="fe nt nu nv nw b">sep</code>参数用于指定哪个分隔符元素。</p><p id="175f" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">此外，<code class="fe nt nu nv nw b">suffix</code>参数接受一个正则表达式，向Pandas指示列如何结束，以防后缀不是数字。如果后缀以单词结尾，我们需要使用<code class="fe nt nu nv nw b"> \w+</code>。</p><p id="0e2b" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">现在，我们可以将<em class="mk">宽到长的</em>函数<em class="mk"> </em>应用于我们的数据帧，并查看结果。</p><figure class="mv mw mx my gt iv"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/ef84d4286b198135da5589e32bc4f3dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1eooGsel6SJ_44tOPM1pBA.png"/></div></div></figure><p id="5ca2" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">请注意数据帧中所有剩余的列(出版商和流派)是如何保持不变的。</p><p id="ad29" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi ml translated"><span class="l mm mn mo bm mp mq mr ms mt di">3</span><strong class="lq jt"><em class="mk">Pivot</em></strong>:<code class="fe nt nu nv nw b"><a class="ae jg" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pivot.html#pandas.DataFrame.pivot" rel="noopener ugc nofollow" target="_blank">.pivot()</a></code>方法允许我们将数据从长格式重塑为宽格式。它返回由给定的唯一索引或列值组织的整形数据帧。</p><p id="979a" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">为了应用这种方法，让我们使用一个长格式版本的PS4游戏销售数据集:</p><figure class="mv mw mx my gt iv"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/31c8ed7ac6efafafd252cd70ac91000a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5RKLCmtHr2Mrgp9YaeF1Yg.png"/></div></div></figure><p id="493e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><em class="mk"> pivot </em>方法有三个参数:</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/d2a809cc78a720ea8b3dc4881e2f8f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MFFL_yHwugqOkBjKczlfZw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">枢纽法。作者图片</p></figure><p id="0303" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">注意这是一个DataFrame方法，而不是Pandas函数。</p><p id="462e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><code class="fe nt nu nv nw b">index</code>参数将我们想要的列的名称作为新的透视数据帧中的索引。</p><p id="f041" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><code class="fe nt nu nv nw b">columns</code>参数将我们想要的列名作为新数据帧中的每一列。</p><p id="00bd" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">最后，<code class="fe nt nu nv nw b">values</code>参数采用我们想要填充到新的透视数据帧中的列的名称。这是一个可选参数。如果我们指定它，它将只旋转指定的列。如果没有通过，它将旋转所有列。</p><p id="d331" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">因此，pivot方法会将每个值从原始数据帧传输到新数据帧，其中它的行和列与原始数据帧的索引和列相匹配。</p><p id="f589" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">让我们旋转长数据框并查看输出:</p><figure class="mv mw mx my gt iv"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ou"><img src="../Images/02566bff2b4bff04b195102b1452c56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WptWN6_-9opwTxaXaOy1Yw.png"/></div></div></figure><p id="b509" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">请注意，这些列现在有了一个分层索引。</p><p id="fe7e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">因为该方法在原始数据帧中找不到与组合Call of Duty: Black Ops 3/europe匹配的行和列，所以它将该单元格值设置为缺失值。</p><p id="1261" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">pivot方法不支持数据聚合。当有任何索引/列组合具有多个值时，该方法将引发一个错误，如下例所示:</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ov"><img src="../Images/6e8f759c99d8444073e27b440224ace7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Aat_mAq8B9nE2SoVrrlIA.png"/></div></div></figure><figure class="mv mw mx my gt iv"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ow"><img src="../Images/e2d4f8fbbd568ab2bc6b0f842eb3d636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0kscSBlqDC3UNnqB70ZCEg.png"/></div></div></figure><p id="fda6" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我们在这里讨论的函数和方法只是Pandas中可用于重塑数据的一些工具。</p><p id="1eca" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">学习如何使用它们将在许多情况下为您提供帮助，因为对于任何数据科学项目来说，为您将要执行的每个分析准备适当的格式化和整洁的数据集都是关键的一步。</p><figure class="mv mw mx my gt iv gh gi paragraph-image"><a href="https://www.datacamp.com/courses/reshaping-data-with-pandas"><div class="gh gi ox"><img src="../Images/240f107d469152dc901a4907235398fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gbzAVaPsaMe_FrQQd_YJA.png"/></div></a></figure><p id="61cd" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">如果你想了解更多关于如何用熊猫重塑数据的知识，可以看看我的课程。</p></div></div>    
</body>
</html>