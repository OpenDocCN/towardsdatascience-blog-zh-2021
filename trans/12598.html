<html>
<head>
<title>Implementing PCA From Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始实施 PCA</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implementing-pca-from-scratch-fb434f1acbaa?source=collection_archive---------10-----------------------#2021-12-27">https://towardsdatascience.com/implementing-pca-from-scratch-fb434f1acbaa?source=collection_archive---------10-----------------------#2021-12-27</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="02ee" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">从头做起</h2><div class=""/><div class=""><h2 id="b19f" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">仅用 Python 和 NumPy 来提高您的线性代数技能</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/5c1b7b6e982b045574e1e71d63fe0662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UIu-swrOsNJTeGCh"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">Pawel Czerwinski 在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="f3df" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di">我</span>一直对简化数据的不同方式感到惊讶，这些方式使数据更容易获取和分析。这有时感觉像是巫术——简单地应用一个算法，它就以某种方式完成了工作。</p><p id="9d49" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">主成分分析(PCA)就是其中一种算法。这是一种无监督的学习算法，目的是通过将一大组特征转换为一个较小的特征来降低维度，同时保留尽可能多的信息。</p><p id="85c8" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在本文中，我们将通过从头开始实现 PCA 来揭开一些巫术的神秘面纱。我们将使用 Python 和 NumPy 一步一步地完成这项工作。</p></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h1 id="1501" class="mv mw iu bd mx my mz na nb nc nd ne nf kj ng kk nh km ni kn nj kp nk kq nl nm bi translated">概述</h1><p id="3aa0" class="pw-post-body-paragraph lj lk iu ll b lm nn ke lo lp no kh lr ls np lu lv lw nq ly lz ma nr mc md me in bi translated">在直接进入实现细节之前，让我们从高层次上了解一下算法实际上是如何工作的。</p><p id="0738" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">主成分分析主要包括三个步骤:</p><ol class=""><li id="7545" class="ns nt iu ll b lm ln lp lq ls nu lw nv ma nw me nx ny nz oa bi translated">首先，我们需要计算<em class="ob">协方差矩阵</em>。</li><li id="5fc9" class="ns nt iu ll b lm oc lp od ls oe lw of ma og me nx ny nz oa bi translated">一旦我们获得这个矩阵，我们需要使用<em class="ob">特征分解</em>来分解它。</li><li id="d2f1" class="ns nt iu ll b lm oc lp od ls oe lw of ma og me nx ny nz oa bi translated">接下来，我们可以基于特征值选择最重要的特征向量，以最终<em class="ob">将原始矩阵投影</em>到其降维的维度中。</li></ol><p id="c88f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在接下来的部分中，我们将仔细研究每个步骤，在一个单独的类中实现 PCA。下面我们已经可以看一下<em class="ob">骨架类</em>，它为我们提供了某种蓝图。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oh oi l"/></div></figure></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h1 id="1065" class="mv mw iu bd mx my mz na nb nc nd ne nf kj ng kk nh km ni kn nj kp nk kq nl nm bi translated">从头开始实施</h1><h2 id="57dd" class="oj mw iu bd mx ok ol dn nb om on dp nf ls oo op nh lw oq or nj ma os ot nl ja bi translated">计算协方差矩阵</h2><p id="5731" class="pw-post-body-paragraph lj lk iu ll b lm nn ke lo lp no kh lr ls np lu lv lw nq ly lz ma nr mc md me in bi translated">如概述中所述，我们的第一步主要涉及协方差矩阵的计算。那么我们为什么需要这样做呢？</p><p id="a0c6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">粗略地说，协方差矩阵告诉我们两个随机变量一起变化了多少。如果协方差为正，则两个变量相关，因此沿相同方向移动(<em class="ob">增加或减少</em>)。如果协方差是负的，那么变量是反向相关的，意味着它们向相反的方向移动<em class="ob">(例如，一个在增加，而另一个在减少)</em></p><p id="15f4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">假设我们有一个包含三个要素的数据集。如果我们计算协方差矩阵，我们将得到一个 3x3 的矩阵，包含每一列与所有其他列及其自身的协方差。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ou"><img src="../Images/4666d94db374fb557fddb12db6ce3a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*9pX3YLq7XUivD8wdGoaFRA.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">协方差矩阵的例子[图片由作者提供]</p></figure><p id="82ce" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">当应用特征分解时，协方差矩阵将是我们的核心，允许我们选择主向量或主方向，这解释了我们数据集中的大多数方差。</p><p id="40a4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">现在我们知道了什么是协方差矩阵，我们仍然需要知道如何计算它。计算矩阵的公式可以表述如下:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ov"><img src="../Images/795752135fa9aeb4a932a0c6f10300bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/0*t7HI34ECHFtMEDt0"/></div></figure><p id="1f3b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果我们预先将数据居中，我们可以分别省略<em class="ob">、【x-bar】、<em class="ob">、【y-bar】、</em>的减法。简化我们的方程，用线性代数符号表示，我们得到如下结果:</em></p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ow"><img src="../Images/35adc55e0be241e13655a63644140a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:206/0*1UN_DShhZF60EGov"/></div></figure><p id="a27e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">其简单地是以平均值为中心的数据矩阵本身除以样本数量的点积。</p><p id="5e70" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">有了这些新知识，我们就可以实现前两个类方法了。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oh oi l"/></div></figure><blockquote class="ox oy oz"><p id="d7fc" class="lj lk ob ll b lm ln ke lo lp lq kh lr pa lt lu lv pb lx ly lz pc mb mc md me in bi translated"><strong class="ll je">注</strong>:我们通过减去平均值并除以标准差来标准化数据。这会将所有要素转换到相同的比例，从而为分析提供同等的贡献。也可以使用 NumPy 函数 numpy.cov(x)计算协方差矩阵。</p></blockquote><h2 id="8420" class="oj mw iu bd mx ok ol dn nb om on dp nf ls oo op nh lw oq or nj ma os ot nl ja bi translated">分解协方差矩阵</h2><p id="6c4a" class="pw-post-body-paragraph lj lk iu ll b lm nn ke lo lp no kh lr ls np lu lv lw nq ly lz ma nr mc md me in bi translated">我们实现的下一步主要关注协方差矩阵的分解，或者更具体地说，是<em class="ob">特征分解</em>。</p><p id="0ba3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">特征分解描述了将矩阵分解为<em class="ob">个特征向量</em>和<em class="ob">个特征值</em>。特征向量为我们提供了关于数据方向的信息，而特征值可以解释为系数，告诉我们每个特征向量中包含多少方差。</p><p id="2c88" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">长话短说，如果我们分解我们的协方差矩阵，我们获得特征向量，它解释了我们数据集中的大部分方差。我们可以用这些向量将原始矩阵投影到一个更低的维度。</p><p id="5a53" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">那么我们如何分解协方差矩阵呢？</p><p id="30b4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">幸运的是，我们可以简单地依赖内置的 NumPy 函数，因为特征值和特征向量的<em class="ob">‘手动’</em>计算相当繁琐。我们唯一要做的事情，就是对特征值和特征向量进行相应的排序，允许我们根据指定的分量数选择最重要的特征向量。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oh oi l"/></div></figure><h2 id="69e9" class="oj mw iu bd mx ok ol dn nb om on dp nf ls oo op nh lw oq or nj ma os ot nl ja bi translated">投射并把它们放在一起</h2><p id="5c32" class="pw-post-body-paragraph lj lk iu ll b lm nn ke lo lp no kh lr ls np lu lv lw nq ly lz ma nr mc md me in bi translated">到现在为止，我们已经完成了大部分工作。</p><p id="7a8b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">通过选择最重要的特征向量，我们现在能够将原始矩阵投影到低维空间中。这是通过取矩阵和特征向量的点积来实现的，这也可以解释为简单的线性变换。</p><p id="acc4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在实现了剩下的两个方法之后，我们的最终类如下所示:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oh oi l"/></div></figure></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h1 id="6c9d" class="mv mw iu bd mx my mz na nb nc nd ne nf kj ng kk nh km ni kn nj kp nk kq nl nm bi translated">测试我们的实现</h1><p id="eac9" class="pw-post-body-paragraph lj lk iu ll b lm nn ke lo lp no kh lr ls np lu lv lw nq ly lz ma nr mc md me in bi translated">现在我们已经完成了我们的实现，只剩下一件事要做——我们需要测试它。</p><p id="678e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">出于测试目的，我们将使用虹膜数据集，该数据集由 150 个样本组成，具有 4 个不同的特征<em class="ob">(萼片长度、萼片宽度、花瓣长度、花瓣宽度)</em>。让我们通过绘制前两个特征来看看原始数据。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj pd"><img src="../Images/1d879236a5637980bb348abd20a0edf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*ucWGlFyRlgWMR3IcAxf8mA.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">通过绘制前两个特征对虹膜数据集进行概述[图片由作者提供]</p></figure><p id="8add" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们现在可以实例化我们自己的 PCA 类，并将其放在数据集上。当运行下面的代码时，我们得到下面的结果。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oh oi l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pe"><img src="../Images/02246ca0264caeffe7abc2bc309e3177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJTWDca72uNv9idy9Oy8MA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">投影到前两个主成分上的虹膜数据集[图片由作者提供]</p></figure><p id="e847" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">通过应用 PCA，我们清楚地解开了一些类关系，并且更清楚地分离了数据。这种低维数据结构应该使分类任务变得容易得多。</p><h1 id="8f27" class="mv mw iu bd mx my pf na nb nc pg ne nf kj ph kk nh km pi kn nj kp pj kq nl nm bi translated">结论</h1><p id="1de9" class="pw-post-body-paragraph lj lk iu ll b lm nn ke lo lp no kh lr ls np lu lv lw nq ly lz ma nr mc md me in bi translated">在本文中，我们从零开始用一种更加手动的方法实现了主成分分析。我们学习了主要的计算步骤，包括一些非常重要的线性代数概念。</p><p id="d606" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">主成分分析是一种简单而有效的方法来减少，压缩和解开高维数据。从零开始理解和实现该算法提供了一个很好的方法来构建强大的基础和修改我们的线性代数知识，因为它将许多重要的概念联系在一起。</p><p id="d5e3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">你可以在我的 GitHub 上的这里找到完整的代码。</p><div class="pk pl gq gs pm"><div role="button" tabindex="0" class="ab bv gw cb fq pn po bn pp lc ex"><div class="pq l"><div class="ab q"><div class="l di"><img alt="Marvin Lanhenke" class="l de bw pr ps fe" src="../Images/5b1b337a332bf18381aa650edc2190bd.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*iEJ9qn9i9dTw3uyXG2jsTA.jpeg"/><div class="fb bw l pr ps fc n aw fd"/></div><div class="hi l fp"><p class="bd b dl z fq fr fs ft fu fv fw fx dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@marvinlanhenke?source=post_page-----fb434f1acbaa--------------------------------" rel="noopener follow" target="_top">马文·兰亨克</a></p></div></div><div class="pv pw gx l"><h2 class="bd je vn ns fq vo fs ft qv fv fx jd bi translated">从零开始的 ML 算法</h2></div><div class="ab q"><div class="l fp"><a class="bd b be z bi vp au vq vr vs se vt an eh ei vu vv vw el em eo de bk ep" href="https://medium.com/@marvinlanhenke/list/ml-algorithms-from-scratch-7621d01922ad?source=post_page-----fb434f1acbaa--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vx l fp"><span class="bd b dl z dk">6 stories</span></div></div></div><div class="qi dh qj fq ab qk fp di"><div class="di qa bv qb qc"><div class="dh l"><img alt="" class="dh" src="../Images/230471643f4baf6e91fca0422ddfb56b.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*qT41zaPnyJHQeGKz0FvkQA.png"/></div></div><div class="di qa bv qd qe qf"><div class="dh l"><img alt="" class="dh" src="../Images/ca1fa6207e26d895ef8ba30bb66ef3a2.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*67IA2OsmsNXtckdF"/></div></div><div class="di bv qg qh qf"><div class="dh l"><img alt="" class="dh" src="../Images/33c295e3ac2a12346fba6df057ae448b.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*HXXyDFWGhV7pvo8E"/></div></div></div></div></div><blockquote class="ox oy oz"><p id="8032" class="lj lk ob ll b lm ln ke lo lp lq kh lr pa lt lu lv pb lx ly lz pc mb mc md me in bi translated">感谢您的阅读！确保保持联系&amp;在<a class="ae li" href="https://medium.com/@marvinlanhenke" rel="noopener"> Medium </a>、<a class="ae li" href="https://www.kaggle.com/mlanhenke" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上关注我，或者在<a class="ae li" href="https://www.linkedin.com/in/marvin-lanhenke-11b902211/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上说声“嗨”</p></blockquote></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><p id="97fc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><em class="ob">喜欢这篇文章吗？成为</em> <a class="ae li" href="https://medium.com/@marvinlanhenke/membership" rel="noopener"> <em class="ob">中级会员</em> </a> <em class="ob">继续无限学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="pk pl gq gs pm qp"><a href="https://medium.com/@marvinlanhenke/membership" rel="noopener follow" target="_blank"><div class="qq ab fp"><div class="qr ab qs cl cj qt"><h2 class="bd je gz z fq qu fs ft qv fv fx jd bi translated">通过我的推荐链接加入 Medium-Marvin Lanhenke</h2><div class="qw l"><h3 class="bd b gz z fq qu fs ft qv fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="qx l"><p class="bd b dl z fq qu fs ft qv fv fx dk translated">medium.com</p></div></div><div class="qy l"><div class="qz l ra rb rc qy rd lc qp"/></div></div></a></div></div></div>    
</body>
</html>