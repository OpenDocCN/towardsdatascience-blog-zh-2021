<html>
<head>
<title>Interpretable Machine Learning in 10 Minutes with RuleFit and Scikit Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RuleFit和Scikit Learn在10分钟内完成可解释的机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interpretable-machine-learning-in-10-minutes-with-rulefit-and-scikit-learn-da9ebb925795?source=collection_archive---------17-----------------------#2021-06-24">https://towardsdatascience.com/interpretable-machine-learning-in-10-minutes-with-rulefit-and-scikit-learn-da9ebb925795?source=collection_archive---------17-----------------------#2021-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4a8c" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">第一部 | <a class="ae ep" rel="noopener" target="_blank" href="/symbolic-vs-subsymbolic-ai-paradigms-for-ai-explainability-6e3982c6948a">第二部</a> | <a class="ae ep" rel="noopener" target="_blank" href="/black-box-and-white-box-models-towards-explainable-ai-172d45bfc512">第三部</a> |可解释的人工智能——第四部</h2><div class=""/><div class=""><h2 id="1796" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用RuleFit|可解释的人工智能从经过训练的机器学习模型中提取有意义的规则组合</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c6f019fc07a368e5039c3fc23ce8ae18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Eq4cRIOF6ZlVH7aS"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图一。照片由<a class="ae lh" href="https://unsplash.com/@nci?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">国家癌症研究所</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8bc2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当然，你一直在训练机器学习模型，并旨在通过数据预处理、相关性分析和特征提取工作来最大限度地提高你的准确性，至少如果你没有专门使用神经网络的话。但是，模型性能不仅仅是准确性或低RMSE分数。</p><p id="0803" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">随着人工智能的广泛采用，特别是在敏感领域，人工智能系统的一个期望属性是可解释性。虽然一些机器学习模型本质上是透明的，但其中一些是需要额外步骤来解释的黑盒。</p><p id="8e57" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">虽然神经网络或集成方法通常被视为黑盒模型，但更传统的算法，如线性回归、决策树或贝叶斯分类器，通常被视为透明端。</p><blockquote class="me mf mg"><p id="aedd" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">让我们快速比较一下透明模型和黑盒模型:</p></blockquote><h1 id="8fb5" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">透明模型和黑盒模型的快速比较</h1><h2 id="b3ca" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">越简单通常意味着性能越差</h2><p id="c9f3" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">透明最大似然算法通常产生更简单的模型，它们往往表现更差，而神经网络通常优于所有其他最大似然算法。</p><h2 id="1175" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">不太稳定的透明模型</h2><p id="4f18" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">一些透明模型相对不太稳定。例如，决策树被认为是不稳定的，因为用稍有不同的子样本训练树会导致树的结构发生剧烈变化。这导致了集合方法的发展。</p><h2 id="12d7" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">简单通常意味着潜在的假设</h2><p id="5d0e" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">一些机器学习算法依赖于强大的假设，这些假设可能与现实生活中的事实不符。例如，线性回归总是假设响应变量和解释变量之间的基本关系是线性的。一旦我们对多项式基础关系使用线性回归，该模型将无法收敛于真实关系。</p><h2 id="d6e8" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">简单通常意味着没有交互作用</h2><p id="adec" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">因为传统的ML算法更简单；它们需要先进的特征提取，研究人员需要采用方法来揭示相互作用的影响。例如，线性回归不能自动提取特征或检测交互影响，这可能导致模型性能差和显著性值不正确。</p><p id="2a29" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有一个模型可以解决上面提到的大部分问题:RuleFit。</p><blockquote class="me mf mg"><p id="f98e" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">让我们看看什么是RuleFit算法:</p></blockquote><h1 id="8380" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">规则匹配算法</h1><p id="d336" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated"><a class="ae lh" href="https://christophm.github.io/interpretable-ml-book/rulefit.html" rel="noopener ugc nofollow" target="_blank">由Friedman和Popescu在2008年开发的RuleFit算法学习稀疏线性模型，该模型以决策规则的形式包含自动检测的交互影响</a>。RuleFit模型以决策规则的形式创建新功能，并使用这些功能构建透明模型。</p><blockquote class="me mf mg"><p id="eff8" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">示例:如果房间数&gt; 2，房屋年龄&lt; 15 THEN 1 ELSE 0 (lower than medium)</p></blockquote><p id="82e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Here is how the RuleFit algorithm works:</p><p id="8a7f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第一步:</strong>算法训练一个基于树的模型来预测目标，并使用它来创建这些决策规则(结果:许多规则，并非都是信息性的)；</p><p id="ed9f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第二步:</strong>然后它训练一个稀疏线性模型，比如套索，从原始和新创建的特征中选择最好的。</p><blockquote class="me mf mg"><p id="0e78" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">让我们来看看运行中的RuleFit算法:</p></blockquote><h1 id="fcca" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">波士顿房价数据集</h1><p id="bacc" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">波士顿房价数据集是一个相对较小的数据集，有506个样本和13个解释变量。响应变量自然是房屋的价格，目标是开发一个具有重要变量的模型，该模型可以使用给定的解释变量预测房屋。数据库中的每条记录都描述了波士顿的一个郊区或城镇。这些数据是在70年代从波斯顿标准大都市统计区(SMSA)创建的。<a class="ae lh" href="https://www.kaggle.com/vikrishnan/boston-house-prices" rel="noopener ugc nofollow" target="_blank">属性定义如下</a>:</p><ul class=""><li id="38eb" class="nt nu it lk b ll lm lo lp lr nv lv nw lz nx md ny nz oa ob bi translated">各城镇的人均犯罪率</li><li id="afda" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> ZN </strong>:面积超过25，000平方英尺的住宅用地比例。制成</li><li id="7941" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> INDUS </strong>:各镇非零售营业亩数比例</li><li id="0b03" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> CHAS </strong>:查尔斯河虚拟变量(= 1，如果区域边界为河流；否则为0)</li><li id="8f08" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> NOX </strong>:氮氧化物浓度(百万分之一)</li><li id="ec12" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> RM </strong>:每个住宅的平均房间数</li><li id="e7b3" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd">年龄</strong>:1940年前建造的自住单位比例</li><li id="77fe" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> DIS </strong>:到五个波士顿就业中心的加权距离</li><li id="5dfc" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> RAD </strong>:放射状公路可达性指标</li><li id="14eb" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd">税</strong>:每万美元的全价值财产税</li><li id="7dca" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">比例:各城镇的师生比例</li><li id="025a" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd">B</strong>:1000(Bk 0.63)2其中Bk是城镇中黑人的比例</li><li id="b1f5" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">LSTAT  : %较低的人口地位</li><li id="abd3" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">MEDV:以千美元计的自有住房中值</li></ul><blockquote class="me mf mg"><p id="a1e0" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">让我们加载数据集:</p></blockquote><h2 id="44f6" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">加载数据集</h2><p id="7680" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">我们可以使用scikit-learn轻松加载波士顿房价数据集。以下代码下载数据集并创建一个pandas DataFrame对象:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点1。加载数据集</p></figure><p id="c5f7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是数据帧的头部()。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/227ab528cba44208ed5a6973caeef2f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-pkZXP8tnZnQobMb0UCEjQ.png"/></div></div></figure><p id="79c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">还有，我们用Plotly Express看看房价:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点2。绘制目标分布图</p></figure><p id="9277" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是房价分布的直方图:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/94b122575d67771c4b5ddabe58fdcca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vl-UWwEahGmLHNWS9GQsaQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图二。波士顿房价值的直方图</p></figure><blockquote class="me mf mg"><p id="2dc9" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">现在我们已经准备好了数据，我们可以构建和训练一个模型:</p></blockquote><h2 id="9a74" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">训练随机森林回归器</h2><p id="0ee1" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">在应用RuleFit模型之前，我们需要训练一个基于树的模型，如决策树、随机森林或梯度推进树模型。对于本教程，我将使用RandomForestRegressor:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点三。训练随机森林回归器</p></figure><p id="49cc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是我们简单随机森林模型的总结:</p><pre class="ks kt ku kv gt ol om on oo aw op bi"><span id="dd08" class="nd mm it om b gy oq or l os ot">RandomForestRegressor(bootstrap=True, ccp_alpha=0.0,   criterion='mse', max_depth=None, max_features='auto', max_leaf_nodes=None, max_samples=None, min_impurity_decrease=0.0,                       min_impurity_split=None, min_samples_leaf=1,                       min_samples_split=2, min_weight_fraction_leaf=0.0,                       n_estimators=50, n_jobs=-1, oob_score=False,                       random_state=42, verbose=0, warm_start=False)</span></pre><h2 id="93ab" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">评估随机森林</h2><p id="ddf1" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">训练模型将持续几秒钟，以下是我们的RMSE计算线:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点4。评估经过训练的随机森林回归器</p></figure><p id="bf4f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">输出是:</p><pre class="ks kt ku kv gt ol om on oo aw op bi"><span id="3bf3" class="nd mm it om b gy oq or l os ot">1.2328287822419268</span></pre><p id="a448" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">请注意，我们从未将数据集分为训练和测试。这样选择的原因是为了简化教程，因为我们现在不担心过度拟合。</p><h2 id="fa63" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">特征重要性</h2><p id="831a" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">既然我们已经有了一个训练好的模型，我们就可以通过使用随机森林模型的<code class="fe ou ov ow om b">feature_importances_()</code>函数对解释变量(即特征)进行排序和可视化，并绘图表示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点5。列出并画出重要特征</p></figure><p id="5312" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是输出图:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/604467adbd07b53a0ffadf4faaaa903d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DQCDasVwMSn27idkGaiAmA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图3。基于重要程度列出特性的条形图</p></figure><p id="3a66" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如您可以轻松识别的，LSTAT和RM是目前为止影响目标(即房价)的最重要的特征。现在我们已经有了一个训练好的模型，让我们创建我们的自定义规则来获得更多的可解释性和可解释性。</p><h2 id="5684" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">创建和培训规则匹配模型</h2><p id="d154" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">我们需要先安装<code class="fe ou ov ow om b">rulefit</code>库。然后，我们需要将RandomForestRegressor输入到RuleFit模型中。不管上面的代码是什么，你都可以选择梯度推进或者决策树。以下代码安装并导入<code class="fe ou ov ow om b">rulefit</code>，使用RandomForestRegressor创建一个RuleFit模型，并使用数据集训练该模型:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点6。安装、导入、创建和训练规则拟合模型</p></figure><p id="1da9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是该模型的总结:</p><pre class="ks kt ku kv gt ol om on oo aw op bi"><span id="45b1" class="nd mm it om b gy oq or l os ot"><strong class="om jd">RuleFit(Cs=None, cv=3, exp_rand_tree_size=True, lin_standardise=True, lin_trim_quantile=0.025, max_rules=2000, memory_par=0.01, model_type='rl', random_state=None, rfmode='regress', sample_fract='default', tree_generator=</strong><em class="mh">RandomForestRegressor(bootstrap=True, ccp_alpha=0.0, criterion='mse', max_depth=None, max_features='auto', max_leaf_nodes=6, max_samples=None, min_impurity_decrease=0.0, min_impurity_split=None, min_samples_leaf=1, min_samples_split=2, min_weight_fraction_leaf=0.0, n_estimators=563, n_jobs=None, oob_score=False, random_state=562, verbose=0, warm_start=False)</em><strong class="om jd">, tree_size=4)</strong></span></pre><p id="1bdf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">请注意，由于RuleFit模型正在生成数百个规则组合并对其进行测试，因此本培训将花费稍长的时间(仍不到一分钟)。</p><p id="7153" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们可以用下面的代码评估我们的模型:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点7。评估已训练的规则拟合模型</p></figure><p id="a28c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">输出:</p><pre class="ks kt ku kv gt ol om on oo aw op bi"><span id="ade5" class="nd mm it om b gy oq or l os ot">1.6828402423155089</span></pre><p id="f893" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">到目前为止，我们的RandomForestRegressor和RuleFit模型使用非常相似的代码工作。但是，在后台，我们的RuleFit模型生成了数百个潜在的规则组合。</p><blockquote class="me mf mg"><p id="682a" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">让我们来看看这些规则:</p></blockquote><h2 id="93f2" class="nd mm it bd mn ne nf dn mr ng nh dp mv lr ni nj mx lv nk nl mz lz nm nn nb iz bi translated">RuleFit规则</h2><p id="9413" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">为了得到规则，我们可以使用。规则适配模型的get_rules()函数。然后，我们可以使用下面的代码根据它们的支持值对它们进行排序:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点8。获取RuleFit模型创建的规则</p></figure><p id="e4e1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是输出:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/fcc0e59e727e2f0efab4e026682053b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ngsk7ljgcQyHvCWMz3N6Bw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图4。未过滤规则和功能数据框架的前15行</p></figure><p id="87ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们看看我们的列名并描述它们:</p><ul class=""><li id="b2b6" class="nt nu it lk b ll lm lo lp lr nv lv nw lz nx md ny nz oa ob bi translated"><strong class="lk jd">规则</strong>:特征名称或规则公式</li><li id="9254" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd">类型</strong>:现有特征线性，组合规则</li><li id="9192" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd"> coef </strong>:规则和特征的系数</li><li id="e5b5" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd">支持</strong>:规则/特性应用数据集的多大比例</li><li id="e847" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd">重要性</strong>:帮助识别对预测重要的线性项和规则。特征重要性是根据回归模型的权重计算的。</li></ul><p id="1ea7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了有更好的输出，我们应该</p><ul class=""><li id="c367" class="nt nu it lk b ll lm lo lp lr nv lv nw lz nx md ny nz oa ob bi translated">消除现有特征；</li><li id="3cbd" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">删除系数为0.00的规则，因为它们不重要；</li><li id="cee2" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">根据它们的支持值对它们进行排序；和</li><li id="a7b8" class="nt nu it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">消除最简单的规则以查看更复杂的规则(可选)。</li></ul><p id="4e28" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是完成所有这些任务的代码行:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要点9。过滤掉不太重要的规则和所有特征</p></figure><p id="050d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是显示一些规则的输出:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/4c47cc8d22774c1196b086b628bbb68e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KSSav6Pk6c31KNiy4RtUzQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图5。过滤规则数据框架的前5行</p></figure><p id="7f8d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如我们所确定的，LSTAT和RM是最重要的特征。因此，毫不奇怪，最重要的规则组合也大多包含这些特性。上面的第一个规则是一个虚拟变量。<code class="fe ou ov ow om b">IF LSTAT ≤ 15.62 and RM ≤ 6.84, THEN 1 ELSE 0</code>。如你所见，第二条规则与第一条非常相似。因此，合并/删除一些相似的规则以得到一组更易解释的规则可能是有意义的。因此，在理想情况下，我们需要应用一些NLP方法来对相似的规则进行分组，并创建一个更精简的模型，该模型将覆盖所有的交互作用，这将最终帮助我们理解我们训练的模型的工作机制。</p><h1 id="37bd" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">最终注释</h1><p id="c327" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">RuleFit算法是理解特征之间关系的一个很好的解决方案。RuleFit算法基于树模型和LASSO回归器的组合，它可以生成数百个候选规则，这些规则可以帮助我们更好地解释我们的预测。然而，它需要额外的过滤和组合来获得有意义的结果。</p><h1 id="c805" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">订阅邮件列表获取更多内容</h1><p id="49e3" class="pw-post-body-paragraph li lj it lk b ll no kd ln lo np kg lq lr nq lt lu lv nr lx ly lz ns mb mc md im bi translated">除了我的最新内容，我还与我的订户分享我的Google Colab笔记本，其中包含我发表的每篇文章的完整代码。如果你想获得我在Google Colab上的其他教程文章的代码，并尽早获得我的最新内容，可以考虑订阅:✉️的邮件列表</p><blockquote class="me mf mg"><p id="2df8" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated"><a class="ae lh" href="https://medium.us4.list-manage.com/subscribe?u=bf0e9524ea3d765ba10131675&amp;id=52221072de" rel="noopener ugc nofollow" target="_blank"> <em class="it">现在就订阅</em> </a></p></blockquote><p id="d4fc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你对深度学习感兴趣，也可以看看我的人工智能内容指南:</p><div class="pa pb gp gr pc pd"><a href="https://blog.orhangaziyalcin.com/a-guide-to-my-content-on-artificial-intelligence-c70c9b4a3b17" rel="noopener  ugc nofollow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">我的人工智能内容指南</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">帮助您轻松浏览我的内容的指南。</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">blog.orhangaziyalcin.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr lb pd"/></div></div></a></div><p id="03ee" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你正在阅读这篇文章，我确信我们有着相似的兴趣，并且正在/将要从事相似的行业。那么我们就通过<a class="ae lh" href="https://linkedin.com/in/orhangaziyalcin/" rel="noopener ugc nofollow" target="_blank"><em class="mh">Linkedin</em></a><em class="mh">来连线吧！请不要犹豫发送联系请求！</em><a class="ae lh" href="https://linkedin.com/in/orhangaziyalcin/" rel="noopener ugc nofollow" target="_blank"><em class="mh">Orhan g . Yal n—Linkedin</em></a></p></div></div>    
</body>
</html>