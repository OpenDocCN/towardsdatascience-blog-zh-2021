<html>
<head>
<title>Build your own Salesforce Dataloader</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建您自己的Salesforce数据加载器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-your-own-salesforce-dataloader-c39f291cfb32?source=collection_archive---------22-----------------------#2021-05-02">https://towardsdatascience.com/build-your-own-salesforce-dataloader-c39f291cfb32?source=collection_archive---------22-----------------------#2021-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="aec3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使您的用户能够使用Salesforce Dataloader的强大功能，但具有可定制的用户体验</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f5a949a0496cd43dca213be9577d0e9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zS0F9oeWVJaONiT-"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@apollo_y?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">莫兰</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="eb09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为全球领先的客户关系管理(CRM)平台，Salesforce是一款能够存储大量数据的出色工具。因此，管理这些数据是平台管理员的日常工作。其中一种方法是通过<a class="ae kv" href="https://help.salesforce.com/articleView?id=sf.data_loader.htm&amp;type=5" rel="noopener ugc nofollow" target="_blank"> <em class="ls">数据加载器</em> </a> <em class="ls">，</em>一个能够提取、插入、更新和删除Salesforce记录的客户端应用程序。</p><p id="a02e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我在2018年夏季实习期间第一次开始与Salesforce合作并使用Dataloader时，我记得我很害怕不小心做错事情。一打开它，所有我能接触到的物品就出现在我面前，即使我一开始并不知道它们的存在或对它们感兴趣。虽然可以限制哪些用户可以使用该工具，但我感兴趣的是能够在其中定制用户体验，并创建一个更可控和优化的环境。这样，我可以选择只向销售团队显示业务机会、销售线索和客户，或者向开发团队显示自定义元数据类型和自定义设置，而不是显示组织内的所有对象。选项是无限的，在本文中，我将介绍一个尝试完整模拟Salesforce数据加载器的应用程序，它可以作为构建更多定制体验的垫脚石。它的一些限制是，它在一个作业中最多只能插入、更新和删除10k条记录，输入Excel/Csv文件中的列名必须与您尝试写入的字段的“API名称”完全匹配，并且登录需要从您在Salesforce中的个人设置中获得的<a class="ae kv" href="https://help.salesforce.com/articleView?id=sf.user_security_token.htm&amp;type=5" rel="noopener ugc nofollow" target="_blank">安全令牌</a>。该解决方案使用simple_salesforce和salesforce_bulk Python包来处理数据，并使用Tkinter来构建用户界面。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="8217" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">应用程序</h1><p id="d5b0" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><em class="ls">我只在文章正文中包含了部分代码。要检查整个事情，导航到</em><a class="ae kv" href="https://github.com/soravassi/FauxSFDCDataloader" rel="noopener ugc nofollow" target="_blank"><em class="ls">https://github.com/soravassi/FauxSFDCDataloader</em></a></p><h2 id="ce53" class="mx mb iq bd mc my mz dn mg na nb dp mk lf nc nd mm lj ne nf mo ln ng nh mq ni bi translated">登录窗口</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/a6f7c69917439c0201fd2053da37147f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LnjbPNrY3aTuDhTRxlpbdg.png"/></div></div></figure><p id="3ca1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当用户第一次打开应用程序时，他们会发现一个简单的Tkinter窗口，必须在其中插入用户名、密码和安全令牌。按下“登录”后，将调用Login()函数并构建主菜单。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="12ad" class="mx mb iq bd mc my mz dn mg na nb dp mk lf nc nd mm lj ne nf mo ln ng nh mq ni bi translated">炙单</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/8744ec231805e870e2de7c0b0347a279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1DSY2oJe7gdEHSjCrau2aw.png"/></div></div></figure><p id="6c6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">认证后，将出现操作选项。</p><p id="1398" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">query按钮调用查询操作特有的顶层Tkinter窗口，因为它的用户体验与其他操作稍有不同。插入、更新和删除按钮都调用同一个窗口模板，通过函数“open_secondary(operation)”上的关键字参数指定动作</p><h2 id="88c2" class="mx mb iq bd mc my mz dn mg na nb dp mk lf nc nd mm lj ne nf mo ln ng nh mq ni bi translated">动作窗口</h2><p id="1f57" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">该应用程序有两个主要的操作窗口模板:一个用于查询，另一个用于写操作(插入、更新、删除):</p><p id="2096" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">查询窗口</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/4a4f4ebb3df1decba2fadbd0e94b1269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3OqcGrYJNYBf98LDS_kZqg.png"/></div></div></figure><p id="0cd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查询页面利用两个Tkinter列表框来帮助用户构建他们的<a class="ae kv" href="https://developer.salesforce.com/docs/atlas.en-us.soql_sosl.meta/soql_sosl/sforce_api_calls_soql.htm" rel="noopener ugc nofollow" target="_blank"> SOQL </a>查询。第一个列表框是SOQL查询的结果，它包含Salesforce中所有对象的名称，而第二个列表框是SOQL查询的结果，它包含第一个列表框中所选对象内的所有字段名称。在这里，用户可以按“创建查询”，这将根据他们的列表框选择编译查询，或者直接在文本框中编写查询，然后单击“提取”以生成包含所需数据的Excel文件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用于编译“open_query()”函数中的对象名的代码段，该函数打开查询顶层窗口</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">分别按下“显示字段”、“创建查询”和“提取”时运行的功能</p></figure><p id="3ec3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">更新/插入/删除窗口:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/14edfae7274b03ef0f4f82efbe573534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5AD-n7z4xuFtEC4RnO6pDg.png"/></div></div></figure><p id="dcf8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此窗口的行为类似于查询窗口，因为在打开它时，列表框将显示您可以在其中执行所需操作的对象。主要区别在于，对于写操作，应用程序利用salesforce_bulk包而不是simple_salesforce，并且用户必须输入从中选择字段的CSV/Excel文件，而不是在第二个列表框中选择受影响的字段。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">提示用户选择输入文件，并将其保存在数据帧上</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">“动作(操作)”功能的一部分，启动批量数据作业并编译结果。</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="87cd" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">将这一切结合在一起</h1><p id="6b36" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">使用Tkinter构建这样一个应用程序的好处在于，您可以快速推出它的不同版本。例如，您可以使应用程序的某些方面(如他们可以访问的对象列表)以用户的配置文件为条件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="1747" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其他选项可能只显示查询按钮，或者隐藏删除按钮。根据我自己的个人经验，我创建了该应用程序的多个版本，帮助产品所有者提取选项列表值及其依赖关系，并帮助质量保证用户更改他们自己的配置文件，以便从业务用户的角度测试新功能，而无需授予他们“管理用户”权限或“登录身份”功能。正如我说过的，天空是无限的，具体的应用将因Salesforce的实施而异。希望这有助于帮助用户以更加定制化和定制化的体验处理数据。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/10794a723ec6daca953cf513b1424e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5TdygvFMtagbYLF-"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">威廉·冈克尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2a08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">感谢您的阅读！这是我尝试分享一些代码和我试图解决的一个问题的解决方案的第一篇文章。我很感激你所有的建设性反馈，从文章的结构到代码本身。</em></p><p id="4a85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">更多项目，我邀请您参观</em><a class="ae kv" href="https://andrecarmo.com" rel="noopener ugc nofollow" target="_blank"><em class="ls">andrecarmo.com</em></a></p></div></div>    
</body>
</html>