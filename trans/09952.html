<html>
<head>
<title>Shuffling Rows in Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在熊猫数据帧中重排行</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/shuffling-rows-in-pandas-dataframes-eda052275635?source=collection_archive---------15-----------------------#2021-09-19">https://towardsdatascience.com/shuffling-rows-in-pandas-dataframes-eda052275635?source=collection_archive---------15-----------------------#2021-09-19</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5e8d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">讨论如何重排熊猫数据帧的行</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e34caf2d8b7403e0b8120e1063c74c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1UR9XubOdxm1pttmTzWNA.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">瑞安·昆塔尔在<a class="ae kz" href="https://unsplash.com/s/photos/shuffle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="62ff" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="72b7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">数据混洗是一项常见任务，通常在模型训练之前执行，以便创建更具代表性的训练和测试集。例如，假设您的原始数据集是基于特定列排序的。</p><p id="2dd1" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">如果分割数据，那么得到的集合将不会代表数据集的真实分布。因此，我们必须调整原始数据集，以最小化差异，并确保模型能够很好地推广到新的、看不见的数据点。</p><p id="c040" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的简短指南中，我们将讨论如何以各种方式重排熊猫数据帧的行。具体来说，我们将探索如何使用</p><ul class=""><li id="6d43" class="mu mv iu ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated"><code class="fe nd ne nf ng b">pandas</code>中的<code class="fe nd ne nf ng b">sample()</code>方法</li><li id="e436" class="mu mv iu ly b lz nh mc ni lj nj ln nk lr nl mo mz na nb nc bi translated"><code class="fe nd ne nf ng b">scikit-learn</code>中的<code class="fe nd ne nf ng b">shuffle()</code>方法</li><li id="36d4" class="mu mv iu ly b lz nh mc ni lj nj ln nk lr nl mo mz na nb nc bi translated"><code class="fe nd ne nf ng b">numpy</code>中的<code class="fe nd ne nf ng b">random.permutation()</code>方法</li></ul></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="2e91" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们创建一个示例pandas DataFrame，我们将在本文中引用它来演示如何以多种不同的方式重排行。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="2ae3" class="la lb iu ng b gz nx ny l nz oa">import pandas as pd</span><span id="1347" class="la lb iu ng b gz ob ny l nz oa"><br/>df = pd.DataFrame({<br/>    'colA': [10, 20, 30, 40, 50, 60],<br/>    'colB': ['a', 'b', 'c', 'd', 'e', 'f'],<br/>    'colC': [True, False, False, True, False, True],<br/>    'colD': [0.5, 1.2, 2.4, 3.3, 5.5, 8.9],<br/>})</span><span id="b209" class="la lb iu ng b gz ob ny l nz oa">print(df)<br/><em class="oc">   colA colB   colC  colD<br/>0    10    a   True   0.5<br/>1    20    b  False   1.2<br/>2    30    c  False   2.4<br/>3    40    d   True   3.3<br/>4    50    e  False   5.5<br/>5    60    f   True   8.9</em></span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="f827" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">在熊猫中使用sample()方法</h2><p id="b656" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">对pandas数据帧进行混排的第一个选择是<code class="fe nd ne nf ng b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sample.html" rel="noopener ugc nofollow" target="_blank">panads.DataFrame.sample</a></code>方法，它返回一个随机的项目样本。在这种方法中，您可以指定想要采样的记录的确切数量或部分。因为我们想要打乱整个数据帧，所以我们将使用<code class="fe nd ne nf ng b">frac=1</code>来返回所有记录。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="0695" class="la lb iu ng b gz nx ny l nz oa"><strong class="ng iv">df = df.sample(frac=1)</strong></span><span id="bfbb" class="la lb iu ng b gz ob ny l nz oa">print(df)<br/><em class="oc">   colA colB   colC  colD<br/>4    50    e  False   5.5<br/>0    10    a   True   0.5<br/>2    30    c  False   2.4<br/>1    20    b  False   1.2<br/>5    60    f   True   8.9<br/>3    40    d   True   3.3</em></span></pre><p id="2a33" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">如果你想让洗牌在重现<strong class="ly iv">，那么<strong class="ly iv">也要确保为</strong> <code class="fe nd ne nf ng b"><strong class="ly iv">random_state</strong></code> <strong class="ly iv">参数</strong>指定一个有效值。此外，有时您可能希望重置返回的数据帧的索引。在这种情况下，以下方法应该可以解决问题:</strong></p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="4965" class="la lb iu ng b gz nx ny l nz oa">df = df.sample(frac=1).reset_index(drop=True)</span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="7579" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用scikit-learn的shuffle()方法</h2><p id="1c86" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">另一个可以用来混洗数据帧的函数是如下所示的<code class="fe nd ne nf ng b"><a class="ae kz" href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.shuffle.html" rel="noopener ugc nofollow" target="_blank">sklearn.utils.shuffle()</a></code>:</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="cdfc" class="la lb iu ng b gz nx ny l nz oa"><strong class="ng iv">from sklearn.utils import shuffle</strong></span><span id="f611" class="la lb iu ng b gz ob ny l nz oa"><strong class="ng iv">df = shuffle(df)</strong></span><span id="693b" class="la lb iu ng b gz ob ny l nz oa">print(df)<br/><em class="oc">   colA colB   colC  colD<br/>4    50    e  False   5.5<br/>5    60    f   True   8.9<br/>1    20    b  False   1.2<br/>2    30    c  False   2.4<br/>0    10    a   True   0.5<br/>3    40    d   True   3.3</em></span></pre><p id="bf31" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">同样，如果您希望结果是可重复的，请确保配置<code class="fe nd ne nf ng b">random_state</code>参数。</p></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="c172" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">在numpy中使用random.permutations()</h2><p id="c24a" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">我们的另一个选择是随机排列序列的<code class="fe nd ne nf ng b"><a class="ae kz" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.permutation.html" rel="noopener ugc nofollow" target="_blank">numpy.random.permutation</a></code>方法。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="42e0" class="la lb iu ng b gz nx ny l nz oa">import numpy as np</span><span id="9be6" class="la lb iu ng b gz ob ny l nz oa"><strong class="ng iv">df = df.iloc[np.random.permutation(len(df))]</strong></span><span id="adb8" class="la lb iu ng b gz ob ny l nz oa">print(df)<br/><em class="oc">   colA colB   colC  colD<br/>3    40    d   True   3.3<br/>0    10    a   True   0.5<br/>5    60    f   True   8.9<br/>1    20    b  False   1.2<br/>2    30    c  False   2.4<br/>4    50    e  False   5.5</em></span></pre><p id="ac4e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">同样，如果你希望结果是可重复的，你必须设置<code class="fe nd ne nf ng b">numpy</code>的随机种子。举个例子，</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="e3a6" class="la lb iu ng b gz nx ny l nz oa">np.random.seed(100)</span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="ef36" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短指南中，我们讨论了数据洗牌在机器学习模型环境中的重要性。此外，我们还探索了如何使用<code class="fe nd ne nf ng b">sample()</code>方法、<code class="fe nd ne nf ng b">sklearn</code>中的<code class="fe nd ne nf ng b">shuffle()</code>方法和<code class="fe nd ne nf ng b">numpy</code>中的<code class="fe nd ne nf ng b">random.permutations()</code>方法来洗牌。</p></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">如果你想了解更多关于<strong class="ly iv">如何将数据分成训练集、测试集和验证集</strong>的信息，那么请务必阅读下面的文章。</p><div class="od oe gq gs of og"><a rel="noopener follow" target="_blank" href="/how-to-split-a-dataset-into-training-and-testing-sets-b146b1649830"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">如何用Python将数据集分割成训练集和测试集</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">探索从建模数据集创建训练和测试样本的三种方法</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="oq l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。</strong></p></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="edea" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="od oe gq gs of og"><a rel="noopener follow" target="_blank" href="/how-to-iterate-over-rows-in-a-pandas-dataframe-6aa173fc6c84"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">如何迭代熊猫数据框架中的行</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">讨论如何在pandas中迭代行，以及为什么最好避免(如果可能的话)</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ov l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu og"><a href="https://medium.com/geekculture/use-performance-visualization-to-monitor-your-python-code-f6470592a1cb" rel="noopener follow" target="_blank"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">使用性能可视化来监控Python代码</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">如何持续测量、可视化和提高Python代码在生产中的性能</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">medium.com</p></div></div><div class="op l"><div class="ow l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu og"><a rel="noopener follow" target="_blank" href="/how-to-suppress-settingwithcopywarning-in-pandas-c0c759bd0f10"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">如何抑制熊猫设定SettingWithCopyWarning</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">了解pandas中副本和视图之间的区别以及如何处理带有副本警告的设置</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ox l or os ot op ou kt og"/></div></div></a></div></div></div>    
</body>
</html>