<html>
<head>
<title>Complete Machine Learning pipeline for NLP tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NLP任务的完整机器学习管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/complete-machine-learning-pipeline-for-nlp-tasks-f39f8b395c0d?source=collection_archive---------11-----------------------#2021-09-19">https://towardsdatascience.com/complete-machine-learning-pipeline-for-nlp-tasks-f39f8b395c0d?source=collection_archive---------11-----------------------#2021-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="43f0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">具有基本实现的用于电子邮件中命名实体识别的端到端机器学习管道</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/ece0629ac41f9c5c5926496d524274bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*V1KTGXXXaXOEr6ZrearIiA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">管道架构</p></figure><h1 id="0107" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">放弃</h1><ol class=""><li id="12b7" class="lj lk iq ll b lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">这个项目的灵感来自于我在职业生涯中有机会解决的一个问题，然而，这里提出的问题是不同的，本文不包含该产品中使用的任何代码和/或解决方案。</li><li id="96f5" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">这里给出的解决方案是一个简化的解决方案。文章的最后讨论了使其更接近可靠的生产就绪服务所需的进一步步骤。</li><li id="65a5" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">给定的材料假设读者熟悉机器学习和软件工程的基础，但很想知道如何让它们一起工作。</li></ol><h1 id="6f46" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="611b" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">几年前，在生产中运行并带来真正价值的可靠ML系统是big tech的特权，其他公司无法获得实现此类产品的人才和技术。然而，时代已经变了，现在越来越多的非技术公司享受现实世界的ML应用的好处。</p><p id="0160" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">本文提供了将PoC转化为成熟的ML产品所需的一切，包括简化管道的参考实现以及下一步要做什么的提示。该系统解决的具体问题可以描述如下:从收到的电子邮件中提取公司名称并记录下来。这听起来像是一个表面问题，但应该能够证明如何将ML系统投入生产。</p><h1 id="e2bf" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">系统概况</h1><p id="7c0b" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">建议的体系结构显示在文章开头的图中。</p><p id="8d74" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">它有以下组件:</p><ol class=""><li id="63ea" class="lj lk iq ll b lm mt lo mu lq my ls mz lu na lw lx ly lz ma bi translated">要轮询新邮件的邮箱</li></ol><p id="2996" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">2.控制数据流的工作流协调器:</p><ul class=""><li id="a7cb" class="lj lk iq ll b lm mt lo mu lq my ls mz lu na lw nb ly lz ma bi translated">轮询邮箱(1)</li><li id="10b2" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">向预测工作者发出请求(3)</li><li id="cb1e" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">将电子邮件正文以及提取的实体保存到DB (4)</li></ul><p id="77ca" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">3.预测工作者实际上是通过提取实体将模型应用于给定的电子邮件正文来执行ML</p><p id="db45" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">4.存储电子邮件正文和提取实体的数据库</p><p id="e35c" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">5.(可选)模型训练器将:</p><ul class=""><li id="c20c" class="lj lk iq ll b lm mt lo mu lq my ls mz lu na lw nb ly lz ma bi translated">形成针对数据库查询的训练数据集(4)</li><li id="372e" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">需要时(重新)训练模型</li><li id="b0d8" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">根据测试数据集验证模型</li><li id="e59a" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">将模型存储在模型存储器(6)中</li><li id="19bb" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">如果验证成功，将生产模型指针更改为新模型</li></ul><p id="bc7d" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">6.(可选)对象存储形式的模型存储，如S3存储桶</p><h1 id="3cd7" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">履行</h1><p id="d93e" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">本文附有<a class="ae nc" href="https://github.com/isenilov/ml-pipeline" rel="noopener ugc nofollow" target="_blank">资源库</a>，里面有完整系统的代码和运行指令。</p><div class="nd ne gp gr nf ng"><a href="https://github.com/isenilov/ml-pipeline" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">GitHub - isenilov/ml-pipeline:用于NLP任务的基本但完整的机器学习管道</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">这篇文章(TODO: add link)介绍了如何构建基本而完整的ML管道来解决NLP…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">github.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu kl ng"/></div></div></a></div><p id="a277" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">让我们详细回顾一下组件。</p><h2 id="9ddb" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">邮筒</h2><p id="fb58" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">SMTP(发送电子邮件)/ IMAP(阅读电子邮件)邮件服务器使用<a class="ae nc" href="https://registry.hub.docker.com/r/greenmail/standalone" rel="noopener ugc nofollow" target="_blank"> GreenMail docker镜像</a>打开各自的端口进行模拟:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="c35c" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">工作流编排器</h2><p id="adb7" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">在我们的系统中，我们使用一个非常简单的脚本，该脚本定期轮询邮箱(1)，将电子邮件正文发送给预测工作者(3)，并将结果记录到数据库(4):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="590d" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">另一方面，在真实的生产系统中，工作流编排引擎之一，如<a class="ae nc" href="https://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Airflow </a>、<a class="ae nc" href="https://github.com/argoproj/argo-workflows" rel="noopener ugc nofollow" target="_blank"> Argo Workflows </a>等..可以使用(可以在<a class="ae nc" href="https://github.com/meirwah/awesome-workflow-engines" rel="noopener ugc nofollow" target="_blank">这里</a>找到此类工具的良好列表)以获得可靠性和更简单的工作流声明。</p><h2 id="5481" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">预测工作者</h2><p id="32e1" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">预测工作器是一个微服务，它提供了一个端点，用于根据传入的文本预测实体。在我们的示例中，我们将自己限制在一个非常简单的基于<a class="ae nc" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI </a>的web服务上，该服务从<a class="ae nc" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank"> SpaCy </a>加载一个预训练的模型，并将其应用于输入。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="131e" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">数据库ˌ资料库</h2><p id="9ea4" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">DB只是PostgreSQL DB的一个实例。同样，我们假设它对于合理的负载应该足够了，并且当您希望拥有一个群集或为分析创建一个只读副本以便分析师不能影响生产实例时，我们不考虑可靠性问题。</p><p id="1817" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">使用<a class="ae nc" href="https://hub.docker.com/_/postgres" rel="noopener ugc nofollow" target="_blank">官方PostgreSQL docker图像</a>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="261e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">运行管道</h1><p id="401a" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">本文附带了库,其中包含了运行端到端管道所需的所有代码。</p><h2 id="7772" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">要求</h2><p id="9a83" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">用于运行管道的PC应该安装了<a class="ae nc" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>和<a class="ae nc" href="https://www.unix.com/man-page/linux/1/telnet/" rel="noopener ugc nofollow" target="_blank"> telnet </a>。如果需要，请参考您系统的安装说明。</p><p id="163a" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">可以使用以下命令克隆存储库:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="6ca4" class="nv ks iq ok b gy oo op l oq or">git clone <a class="ae nc" href="https://github.com/isenilov/ml-pipeline.git" rel="noopener ugc nofollow" target="_blank">https://github.com/isenilov/ml-pipeline.git</a></span></pre><h2 id="47cc" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">运行它</h2><p id="dc5a" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">4个服务(邮件服务器、数据库、预测服务和orchestrator)的整个管道可以通过一个命令启动:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="f228" class="nv ks iq ok b gy oo op l oq or">docker-compose -f docker-compose.yaml up --build</span></pre><p id="5e9c" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">它应该开始打印来自服务的日志消息。</p><h2 id="3b64" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">发送电子邮件</h2><p id="9443" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">管道由邮箱中出现的未读邮件触发。为了发送一个，可以使用telnet util。</p><p id="c718" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">连接到IMAP邮件服务器:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="4f4e" class="nv ks iq ok b gy oo op l oq or">telnet localhost 3025</span></pre><p id="0f6b" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">使用telnet发送电子邮件:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="4337" class="nv ks iq ok b gy oo op l oq or">EHLO user<br/>MAIL FROM:&lt;example@some-domain.com&gt;<br/>RCPT TO:&lt;user&gt;<br/>DATA<br/>Subject: Hello World<br/> <br/>Hello!</span><span id="6104" class="nv ks iq ok b gy os op l oq or">She works at Apple now but before that she worked at Microsoft.<br/>.<br/>QUIT</span></pre><p id="a9e7" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">如果一切顺利，日志中应该会出现这样的内容:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="709f" class="nv ks iq ok b gy oo op l oq or">orchestrator_1 | Polling mailbox…<br/>prediction-worker_1 | INFO: 172.19.0.5:55294 — “POST /predict HTTP/1.1” 200 OK<br/>orchestrator_1 | Recoded to DB with id=34: [{‘entity_text’: ‘Apple’, ‘start’: 24, ‘end’: 29}, {‘entity_text’: ‘Microsoft’, ‘start’: 58, ‘end’: 67}]</span></pre><h2 id="65f7" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">检查结果</h2><p id="5f3f" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">数据也必须记录到数据库中。为了检查这一点，任何数据库客户机都可以使用以下连接参数:</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="fe19" class="nv ks iq ok b gy oo op l oq or">host: localhost<br/>port: 5432<br/>database: maildb<br/>username: pguser<br/>pasword: password</span></pre><p id="b1f7" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">和跑步</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="0542" class="nv ks iq ok b gy oo op l oq or">SELECT * FROM mail LIMIT 10</span></pre><p id="0ff0" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">查询。</p><h1 id="7b0d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">生产化</h1><p id="1b64" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">这个实现可以给读者一个真实ML系统是什么样子以及它的组件如何交互的概念。然而，为了使系统健壮、可靠和高性能，需要更多的步骤。</p><h2 id="a365" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">异步服务</h2><p id="8607" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">给定的实现包括由Orchestrator (2)和预测工作器(3)中的同步处理程序使用的同步版本的<a class="ae nc" href="https://docs.python-requests.org/en/latest/" rel="noopener ugc nofollow" target="_blank">请求</a>库，这意味着不能并行处理几个请求，即在下一个请求可以被发送之前必须完成一个预测。这可能是次优的，因为当预测工作者在做他们的工作时，编排器只是空转。</p><p id="69fd" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">要解决这个问题，可以采取以下措施:</p><ul class=""><li id="c48b" class="lj lk iq ll b lm mt lo mu lq my ls mz lu na lw nb ly lz ma bi translated">在客户端使用<a class="ae nc" href="https://github.com/aio-libs/aiohttp" rel="noopener ugc nofollow" target="_blank"> aiohttp </a></li><li id="73de" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">在服务器(预测工作器)端定义<a class="ae nc" href="https://fastapi.tiangolo.com/async/" rel="noopener ugc nofollow" target="_blank">异步处理器</a></li></ul><h2 id="a489" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">消息队列</h2><p id="4ff6" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">尽管定期的邮箱轮询可以作为一种队列，但是在Orchestrator(发布到主题的数据生产者)和预测工作者(订阅主题的数据消费者)之间以及数据源和Orchestrator之间放置一个真正的队列，如<a class="ae nc" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Kafka </a>主题，可能是一个好主意。如果预测工作者不能处理大量的请求，它将更多地分离服务，并可能平滑负载峰值和避免超时。</p><h2 id="2d27" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">部署和扩展</h2><p id="803d" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">拥有一个分布式微服务系统而不是一个可以做所有事情的整体系统的优势之一是易于扩展。出于可靠性以外的原因，合理的负载可能不需要将Workflow Orchestrator扩展到单个主机之外，但是，单个预测工作者很可能无法应对更高的负载。幸运的是，Prediction Worker是一个无状态服务，这意味着它不需要维护单个请求上下文之外的状态(即，服务实例之间没有<a class="ae nc" href="https://en.wikipedia.org/wiki/Race_condition" rel="noopener ugc nofollow" target="_blank">竞争条件</a>)，这反过来使其水平扩展变得简单，就像在工作机群前面添加一个<a class="ae nc" href="https://en.wikipedia.org/wiki/Load_balancing_(computing)" rel="noopener ugc nofollow" target="_blank">负载平衡</a>服务，如<a class="ae nc" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank"> nginx </a>。</p><p id="eeb9" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">本文附带的示例使用docker-compose来部署管道，主要是因为简单。然而，真正的生产系统很少依赖这个工具。我经历了在科技公司部署微服务的两种主要方式:</p><ul class=""><li id="7267" class="lj lk iq ll b lm mt lo mu lq my ls mz lu na lw nb ly lz ma bi translated">一个自行编写的系统，用于管理云中或本地的部署。</li><li id="98b4" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">不同口味的Kubernetes及其包装，例如kube flow为裸Kubernetes增添了许多ML特有的便利。</li></ul><p id="8c35" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">采用GitOps管理部署方式的后一种选择似乎是当今最流行的。</p><h2 id="ebc0" class="nv ks iq bd kt nw nx dn kx ny nz dp lb lq oa ob ld ls oc od lf lu oe of lh og bi translated">监视</h2><p id="022c" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">一些服务甚至可以在没有任何额外代码的情况下发出指标，比如Airflow <a class="ae nc" href="https://airflow.apache.org/docs/apache-airflow/stable/logging-monitoring/metrics.html" rel="noopener ugc nofollow" target="_blank"> integration </a>与<a class="ae nc" href="https://github.com/statsd/statsd" rel="noopener ugc nofollow" target="_blank"> statsd </a>或<a class="ae nc" href="https://docs.datadoghq.com/integrations/gunicorn/" rel="noopener ugc nofollow" target="_blank"> Datadog与gunicorn </a>的集成。虽然这些集成可以为我们提供基本的指标，如HTTP响应代码的速率或响应延迟，但ML pipeline需要的不仅仅是这些。让我们看看还可以/应该监控什么:</p><ul class=""><li id="d105" class="lj lk iq ll b lm mt lo mu lq my ls mz lu na lw nb ly lz ma bi translated">来自服务器(预测工作器(3)本身)和客户端(编制器(2))的预测时间</li><li id="961a" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">预测工作器返回HTTP代码的速率</li><li id="4e1e" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">模型预测漂移检测的不同预测标签和预测置信度/相似度的比率。某个实体的检测率的变化可以表明潜在的模型过时和需要重新训练/微调，这可以由编排器(2)基于例如某个漂移阈值来触发</li><li id="b32e" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">用于检测输入数据分布漂移的输入数据参数，例如，输入文本的长度、字数等…与上一点类似，但此处的变化可能表明数据的性质已经改变，模型可能需要适应它</li><li id="7d57" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw nb ly lz ma bi translated">与主机相关的标准指标，如CPU负载、内存/磁盘空间等…</li></ul><h1 id="cc66" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结论</h1><p id="2038" class="pw-post-body-paragraph mg mh iq ll b lm ln jr mi lo lp ju mj lq mk ml mm ls mn mo mp lu mq mr ms lw ij bi translated">这结束了生产就绪的机器学习解决方案世界的短暂旅程，并为读者提供了进一步探索的方向和关于所涵盖的每个主题的谷歌关键词。</p><p id="de49" class="pw-post-body-paragraph mg mh iq ll b lm mt jr mi lo mu ju mj lq mv ml mm ls mw mo mp lu mx mr ms lw ij bi translated">希望这篇文章和代码对您有用，如果您对这个主题有任何问题或对未来文章有任何建议，请随时通过<a class="ae nc" href="https://www.linkedin.com/in/isenilov/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div></div>    
</body>
</html>