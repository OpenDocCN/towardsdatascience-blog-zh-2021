<html>
<head>
<title>Time Series From Scratch — Introduction to Time Series with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从零开始的时间序列—熊猫时间序列简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-from-scratch-introduction-to-time-series-with-pandas-347ac9c6b451?source=collection_archive---------3-----------------------#2021-07-10">https://towardsdatascience.com/time-series-from-scratch-introduction-to-time-series-with-pandas-347ac9c6b451?source=collection_archive---------3-----------------------#2021-07-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0218" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/time-series-from-scratch" rel="noopener" target="_blank">时间序列从无到有</a></h2><div class=""/><div class=""><h2 id="ec27" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">时间序列从头开始系列的第2部分-了解如何使用日期时间、如何应用基本的时间序列操作以及可视化时间序列数据的详细信息。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c877fb9a5a83b35877c92d793b5e3301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Ytx_L2FKESEUuCPyclaMg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">科林·卡特在<a class="ae lh" href="https://unsplash.com/s/photos/abstract?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="9bfc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">处理时间序列数据比看起来更难。如果你是一个完全的初学者，这是开始的地方。唯一的假设是，你看到了时间序列分析的全貌，知道为什么它对企业有用。如果你对时间序列一无所知，<a class="ae lh" rel="noopener" target="_blank" href="/time-series-analysis-from-scratch-seeing-the-big-picture-2d0f9d837329">从这里开始</a>。</p><p id="b842" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们今天将涉及很多领域。阅读后，您将了解如何使用Python和Numpy DateTimes、Pandas DateTimeIndex，如何在所有库中创建日期范围，如何重采样、移位、差分以及创建时间序列的滚动平均值。此外，您将了解到可视化时间序列数据是多么容易。</p><p id="f9c5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们马上开始吧。这篇文章的结构如下:</p><ul class=""><li id="e78e" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">约会时间简介</li><li id="56b0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">使用日期范围</li><li id="2d80" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">时间序列重采样、移位、滚动和差分</li><li id="bae4" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">可视化时间序列数据</li><li id="9f08" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">结论</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="39ca" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">约会时间简介</h1><p id="e33a" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">所有时间序列数据集都有一个共同点——时间。这就是为什么知道日期和时间对象在Python中如何工作是非常重要的。好消息是——这比你想象的要容易。</p><p id="f925" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">内置库<code class="fe nw nx ny nz b">datetime</code>带有几个有用的子模块— <code class="fe nw nx ny nz b">datetime</code>和<code class="fe nw nx ny nz b">timedelta</code>。我们将使用它们来获得:</p><ul class=""><li id="360d" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">一个任意的日期——比如说2021年5月15日</li><li id="2683" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">任意日期和时间—假设2021年5月15日7小时23分44秒</li><li id="d5cb" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">当前日期和时间值</li><li id="b6a1" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">昨天的日期和时间值(当前—一天)</li></ul><p id="7e60" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是代码片段:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="f05c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是打印的结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/e55fc9bbb60969dddb669e52d9676caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*jrXMD_D17rgY8HUFSho11Q.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片Python的日期时间基础知识(图片由作者提供)</p></figure><p id="46df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">那很容易，不是吗？一旦日期时间被声明并存储到变量中，您还可以提取关于该日期时间的特定信息。以下是提取年、月、日、小时、分钟和秒的方法:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="5dcd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你所需要知道的，或多或少。处理单个日期是必须知道的，但是在时间序列分析中，您将主要处理日期范围。接下来我们来介绍一下。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="56b6" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">使用日期范围</h1><p id="0270" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">谈到日期范围，您可以使用纯Python、Numpy或Pandas。最后一个选项是最简单的，您很快就会看到。</p><h2 id="5a9b" class="od na it bd nb oe of dn nf og oh dp nj lr oi oj nl lv ok ol nn lz om on np iz bi translated">纯Python</h2><p id="41d7" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">没有理由在纯Python中处理日期范围。实现很草率，没有给你很多选择。例如，下面是如何创建一个包含每天三个日期的列表:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="a1f5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果看起来像这样:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/93ddd5b0625ab9cd41acd04a8d774642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ZjjpitTplBeIEArhGpchqw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片2-纯Python中的日期范围(图片由作者提供)</p></figure><p id="4a73" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">看起来像你期望的那样，但是熊猫和熊猫更适合这个任务。</p><h2 id="aab6" class="od na it bd nb oe of dn nf og oh dp nj lr oi oj nl lv ok ol nn lz om on np iz bi translated">Numpy</h2><p id="d2f3" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">Numpy允许您将日期范围指定为字符串数组，后跟数据类型规范— <code class="fe nw nx ny nz b">datetime64</code>。这里有一个例子:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="1d8c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这段代码产生的日期范围与纯Python相同，但是实现起来没有那么繁琐。下面是<code class="fe nw nx ny nz b">date_list</code>的样子:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/1355a064ee77d05c4f07e1ffd7258ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Cy4Fo8EVNf6oYCBN15sAQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图3-以Numpy (1)表示的日期范围(图片由作者提供)</p></figure><p id="ac94" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据类型规范中的大写字母<code class="fe nw nx ny nz b">D</code>表示日期是以日间隔(或日精度)存储的。你可以在声明时更改。以下代码片段将添加小时、分钟和秒的默认值:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="bca3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/e3f8b5539137fbdc19169f10ac90022e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tdv_ApADBuT8ICUnJ_tKw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图4-以Numpy (2)表示的日期范围(图片由作者提供)</p></figure><p id="98d4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另一方面，指定年精度会完全删除月和日的值:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="44c4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果是:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/6e77b9c7f48297e8c3a177d17df3f802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xo7l-VGxYnbjEwznxbxwkw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图5-以Numpy (3)表示的日期范围(图片由作者提供)</p></figure><p id="ea67" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但让Numpy眼前一亮的是<code class="fe nw nx ny nz b">arange()</code>功能。您可以使用它来指定日期范围。这里有一个例子:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="4073" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上述代码产生以下日期范围:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/57d0c29c9f6179826e09c21f8949e7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gacBCz3nh4GmwL3YfU8AXQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图6-以数字(4)表示的日期范围(图片由作者提供)</p></figure><p id="65d9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简而言之，您只需指定数据类型以及起点和终点。Numpy做剩下的。</p><p id="730d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个功能在Pandas中得到了扩展，所以我们接下来将讨论它。</p><h2 id="6f60" class="od na it bd nb oe of dn nf og oh dp nj lr oi oj nl lv ok ol nn lz om on np iz bi translated">熊猫</h2><p id="d763" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">熊猫有一个<code class="fe nw nx ny nz b">date_range()</code>功能，允许你以多种方式构建日期范围。</p><p id="0ffd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第一种，也是最常见的一种，是指定起止日期，让熊猫自己解决其他事情:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="e883" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/d3bfd9f4def6d6f2e4b5b6e66caf6b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mxAnidD6ZBD_qSH4J1CGdw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片7-熊猫的日期范围(1)(图片由作者提供)</p></figure><p id="df25" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另一种方法是只指定开始日期。这种方法需要两个附加参数:</p><ul class=""><li id="c682" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><code class="fe nw nx ny nz b">periods: int</code> —日期范围应该有多少个周期，包括起始值。</li><li id="43db" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><code class="fe nw nx ny nz b">freq: str</code> —指定间隔级别。</li></ul><p id="63eb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是如何声明10天的每日日期范围:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="5ab9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它看起来是这样的:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/1f8c9e78a44894a6257f0abfa99be0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fi-nMz7w-Fb6ch2f2MTm9A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片8-熊猫的日期范围(2)(图片由作者提供)</p></figure><p id="6181" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">熊猫的另一个很酷的地方是能够直接在日期范围上使用像<code class="fe nw nx ny nz b">min()</code>和<code class="fe nw nx ny nz b">max()</code>这样的函数。这里有一个例子:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="502d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果是:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/9be10d58b37ad67fce1e0b6a0cab19fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*1RxItNKTrlVzdMjGLcKGTQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片9-熊猫的日期范围(3)(图片由作者提供)</p></figure><p id="95d2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这对于基本的日期范围来说已经足够了。下一节将介绍几个基本的时间序列运算。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="fe95" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">时间序列重采样、移位、滚动和差分</h1><p id="362b" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">有时时间序列数据集不会是您需要的格式。也许数据是按每天的时间间隔存储的，但是您需要每月的总数来进行分析。或者数列不是平稳的(这个术语你以后会学到)，你想用差分使它平稳。所有这些以及更多的事情都可以通过熊猫轻松完成。</p><p id="3f7d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这一部分，我们将使用来自<a class="ae lh" href="https://fred.stlouisfed.org/series/LTOTALNSA" rel="noopener ugc nofollow" target="_blank">弗雷德</a>的轻型汽车销售数据集。以下是你如何装载熊猫的方法:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="c478" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是前几行的样子:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/0bc4cfe825a59b4e4806ff042f83df09.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*4x3vW2xZsYRK9cn2iZOUZQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图10 —轻型汽车销售数据集的前5行(图片由作者提供)</p></figure><p id="abaa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们从重采样开始。</p><h2 id="bf03" class="od na it bd nb oe of dn nf og oh dp nj lr oi oj nl lv ok ol nn lz om on np iz bi translated">重采样</h2><p id="6f3d" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">简而言之，重采样允许您更改时间序列的聚合级别。如果您每小时收集一次数据，但需要每天的总量来进行分析，那么重采样是一种不错的方法。</p><p id="eea7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下代码片段将我们的月度数据集重新采样为年度总数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="0863" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/4154108654810b1c6ed0b4cc29b641e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*m1olnNCWS1uvZHQNX39klg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片11-时间序列重采样(1)(图片由作者提供)</p></figure><p id="efda" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以自由使用Pandas提供的任何聚合函数。例如，您还可以汇总以显示季度平均值:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="242f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是数据集:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/9befe08a08dedb98a709c124eeed02a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*E1z4BAjS9NF1iC7jD0M6vg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片12-时间序列重采样(2)(图片由作者提供)</p></figure><p id="8dae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简而言之，这就是重采样。请记住，从月度数据到年度数据很容易，但反过来是不可能的。</p><h2 id="253b" class="od na it bd nb oe of dn nf og oh dp nj lr oi oj nl lv ok ol nn lz om on np iz bi translated">改变</h2><p id="0a00" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated"><code class="fe nw nx ny nz b">shift()</code>函数是Pandas，用于将整个系列上下移动所需的周期数。</p><p id="06fd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面的代码片段将整个系列下移一个又两个句点。移位后的版本存储为附加列:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="d719" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/35519e63d6f2bd90dd2fec9270e7de48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*nN_9TagvMv_yc3nAyJOpOA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图13-时间序列转换(1)(图片由作者提供)</p></figure><p id="f3e4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">请注意前一/两行是如何丢失的，因为没有1976年1月1日之前的记录。</p><p id="037c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在数据集的另一端也可以做同样的事情。没有<em class="pa"> unshift </em>函数，所以你必须将序列移动一个负值:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="2bba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集现在看起来像这样:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pb"><img src="../Images/b36ccdeacc4f36933300ca1ccc0f5e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*Q_KJeavUfwNV0rPwesQHJg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图14 —时间序列转换(2)(图片由作者提供)</p></figure><p id="9f04" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">注意同样的事情是如何发生的，但是是从相反的方面。</p><h2 id="3d67" class="od na it bd nb oe of dn nf og oh dp nj lr oi oj nl lv ok ol nn lz om on np iz bi translated">旋转</h2><p id="12c7" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">原始格式的时间序列数据可能非常不稳定，尤其是在较小的汇总级别上。<em class="pa">滚动</em>或<em class="pa">移动平均值</em>的概念是平滑时间序列数据的一种有用技术。实际上，你可以用移动平均线做预测，但是以后再做更多的预测。</p><p id="926f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是如何从原始序列计算季度和年度移动平均值:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="76dd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/83c4f86f96cfd90b8ffed4c896d98235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kql8Sw088NSi77-dO5T6UA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图15 —时间序列滚动(作者提供的图片)</p></figure><p id="38da" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如您所见，滚动操作会消耗一些数据，具体取决于窗口大小。但是在计算移动平均线后，您可以看到这些值是如何更加相似的。</p><h2 id="351b" class="od na it bd nb oe of dn nf og oh dp nj lr oi oj nl lv ok ol nn lz om on np iz bi translated">区别</h2><p id="32be" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">最后，让我们探讨一下差异的概念。这是处理金融数据(例如股票价格)时的一项基本技术，并且您希望计算回报率。</p><p id="1f45" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一般来说，差分是用来使序列<em class="pa">平稳</em>。这一术语将在后续文章中介绍，但对于构建预测模型是必不可少的。</p><p id="b77c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是如何计算一阶和二阶差，并在注释中给出了解释:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="8e6a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是差异数据集:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/18915612bd57d7d296c282d41680bb63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*7BwnxXZOHZhkUt8WjPujow.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图16-时间序列差异(图片由作者提供)</p></figure><p id="9ac2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您要绘制这些新列，它们可能看起来是固定的，这意味着它们具有恒定的均值、方差和协方差，但我们将在另一个时间讨论这个问题。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="b3b0" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">可视化时间序列数据</h1><p id="e89c" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">最后，让我们探索一下时间序列数据的可视化过程。这可以直接用Pandas或任何其他可视化库来完成。我们将使用Matplolib，但是您可以使用Seaborn、Plotly、Altair或其他任何软件。</p><p id="7edf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我们来写一些基本的导入和配置。这些将使图表更好看，而不需要投入太多的工作:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="2171" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">太好了！让我们用熊猫做一个基本的线图。这是可视化时间序列数据的最简单方法，因为它通常只需要一行代码:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="c6fe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/202ac1f711a74a7056eb42e12244d4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8sRDsho7OufJHf9ovx67qg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图17-熊猫基本折线图(图片由作者提供)</p></figure><p id="3080" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">只用熊猫做可视化没什么不好，但是我更习惯Matplotlib语法。以下是如何使用它来制作相同的可视化效果，但标题更大，并添加了轴标签:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="19ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是视觉效果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/7fcb631825c9cef5cadbd382d07984c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nuJ0VXxi_nEyvDKTNZf2ZQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图18-使用Matplotlib可视化时间序列(1)(图片由作者提供)</p></figure><p id="5783" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">厉害！但是如果您只想可视化一个特定的子集呢？好吧，既然您正在处理日期时间索引，那么您可以使用Python的切片符号。下面的代码片段将只显示1990年到2005年的数据:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="525d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/07295f592db6d64411c25c6808d62550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tozazgZhzVmvSn7B0EhxVQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图19-使用Matplotlib可视化时间序列(2)(图片由作者提供)</p></figure><p id="f458" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您不想使用切片符号，还有一个替代方法。您可以使用Matplilib的<code class="fe nw nx ny nz b">xlim()</code>和<code class="fe nw nx ny nz b">ylim()</code>函数来设置X轴和Y轴的范围:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="1c27" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是视觉效果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/92bbb6461ab9984cde9ce830327563be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4nZlIp5tNz8PWJdnC5fMnw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片20 —使用Matplotlib可视化时间序列(3)(图片由作者提供)</p></figure><p id="c126" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这就是时间序列的可视化。99%的情况下你不会做任何更复杂的事情。只要记住如何制作基本的折线图，就万事大吉了。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="dc25" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">结论</h1><p id="e1d6" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">今天走了很多路。好消息是——你已经学会了基本时间序列分析的所有先决条件！在你自己的数据集上练习今天学到的概念，让这些新概念变得牢固。</p><p id="f229" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下一篇文章中，您将学习一些更复杂的时间序列主题——白噪声和随机游走。请继续关注博客，因为整个时间序列分析系列即将推出。</p><p id="0353" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">感谢阅读。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="4ec9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">喜欢这篇文章吗？成为 <a class="ae lh" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="pa">中等会员</em> </a> <em class="pa">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="pf pg gp gr ph pi"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd jd gy z fp pn fr fs po fu fw jc bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">medium.com</p></div></div><div class="pr l"><div class="ps l pt pu pv pr pw lb pi"/></div></div></a></div></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="19b9" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">了解更多信息</h1><ul class=""><li id="55db" class="me mf it lk b ll nr lo ns lr px lv py lz pz md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/top-5-books-to-learn-data-science-in-2020-f43153851f14">2021年学习数据科学的前5本书</a></li><li id="0a90" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/how-to-schedule-python-scripts-with-cron-the-only-guide-youll-ever-need-deea2df63b4e">如何使用Cron调度Python脚本——您需要的唯一指南</a></li><li id="1307" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/dask-delayed-how-to-parallelize-your-python-code-with-ease-19382e159849"> Dask延迟—如何轻松并行化您的Python代码</a></li><li id="e5e2" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/how-to-create-pdf-reports-with-python-the-essential-guide-c08dd3ebf2ee">如何使用Python创建PDF报告—基本指南</a></li><li id="00e0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/become-a-data-scientist-in-2021-even-without-a-college-degree-e43fa934e55">即使没有大学文凭也要在2021年成为数据科学家</a></li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="787c" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">保持联系</h1><ul class=""><li id="4db7" class="me mf it lk b ll nr lo ns lr px lv py lz pz md mj mk ml mm bi translated">关注我的<a class="ae lh" href="https://medium.com/@radecicdario" rel="noopener"> Medium </a>了解更多类似的故事</li><li id="7e11" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">注册我的<a class="ae lh" href="https://mailchi.mp/46a3d2989d9b/bdssubscribe" rel="noopener ugc nofollow" target="_blank">简讯</a></li><li id="3388" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">在<a class="ae lh" href="https://www.linkedin.com/in/darioradecic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</li></ul></div></div>    
</body>
</html>