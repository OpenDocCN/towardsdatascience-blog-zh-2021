<html>
<head>
<title>How did I write an own OCR program using Keras and TensorFlow in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何用Python中的Keras和TensorFlow编写自己的OCR程序的</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-did-i-train-an-ocr-model-using-keras-and-tensorflow-7e10b241c22b?source=collection_archive---------9-----------------------#2021-06-01">https://towardsdatascience.com/how-did-i-train-an-ocr-model-using-keras-and-tensorflow-7e10b241c22b?source=collection_archive---------9-----------------------#2021-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0dca" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学家</h2><div class=""/><div class=""><h2 id="ff0a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">如今，OCR在数字劳动力的眼中</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/4b5f844d1e3d043cb6ba742259e7a17f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EGqoeHHhMoNN3JVbNMTvDg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="3177" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">光学字符识别(或光学字符阅读器，又名OCR)是过去二十年来用于识别和数字化图像中出现的字母和数字字符的技术。在行业中，这项技术可以帮助我们避免人工输入数据。</p><p id="a6cb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在这篇文章中，我想带你了解深度学习技术如何应用于OCR技术来分类手写的步骤。</p><ul class=""><li id="7c2a" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated">准备用于训练OCR模型的0–9和A-Z字母数据集。</li><li id="ff1e" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">从磁盘上加载字母的数据集。</li><li id="150b" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">在数据集上成功训练了Keras和TensorFlow模型。</li><li id="fdd5" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">绘制训练的结果，并可视化验证数据的输出。</li><li id="3085" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">预测某些图像中出现的文本。</li></ul><h1 id="df29" class="mr ms it bd mt mu mv mw mx my mz na nb ki nc kj nd kl ne km nf ko ng kp nh ni bi translated">准备数据集</h1><p id="0045" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">我们使用以下两个数据集来训练我们的Keras和TensorFlow模型。</p><ul class=""><li id="6d26" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated">0–9:MNIST</li><li id="1d43" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">A-Z: Kaggle</li></ul><h2 id="0fd9" class="no ms it bd mt np nq dn mx nr ns dp nb lq nt nu nd lu nv nw nf ly nx ny nh iz bi translated">标准的MNIST 0–9数据集</h2><p id="ed94" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">这个数据集是从NIST的特殊数据库3和特殊数据库1构建的，它们包含手写数字的二进制图像。</p><pre class="ks kt ku kv gt nz oa ob oc aw od bi"><span id="7faf" class="no ms it oa b gy oe of l og oh">It<strong class="oa jd"> </strong>is built into popular deep learning frameworks, including Keras, TensorFlow, PyTorch, etc. </span><span id="b644" class="no ms it oa b gy oi of l og oh">The MNIST dataset will allow us to recognize the digits 0–9<em class="oj">.</em></span><span id="024a" class="no ms it oa b gy oi of l og oh">Each of these digits is contained in a 28 x 28 grayscale image.</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/eaa0ee8c9c22f188b7c36038b0cb4d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ChfZdfVuEpSObUaYkr-Fhg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">MNIST 0比9</p></figure><h2 id="ab06" class="no ms it bd mt np nq dn mx nr ns dp nb lq nt nu nd lu nv nw nf ly nx ny nh iz bi translated">ka ggle A–Z数据集</h2><p id="843c" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">Kaggle用户Sachin Patel发布了一个简单的逗号分隔值(CSV)文件。</p><pre class="ks kt ku kv gt nz oa ob oc aw od bi"><span id="7e47" class="no ms it oa b gy oe of l og oh">This dataset takes the capital letters <em class="oj">A–Z </em>from NIST Special Database 19.</span><span id="747d" class="no ms it oa b gy oi of l og oh">Kaggle also rescales them from 28 x 28 grayscale pixels to the same format as our MNIST data.</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/e0547e21f066c200f63c41dc7dda271d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RjfslMLzdmOFyQ0eHqwEQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">卡格尔公司</p></figure><h1 id="116a" class="mr ms it bd mt mu mv mw mx my mz na nb ki nc kj nd kl ne km nf ko ng kp nh ni bi translated">从磁盘加载数据集</h1><p id="6aa8" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">由于我们有两个独立的数据集，首先我们必须加载两个数据集，并将它们合并成一个数据集。</p><ul class=""><li id="dc44" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated">加载Kaggle A-Z字母。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><ul class=""><li id="804c" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated">加载MNIST 0-9位数。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><ul class=""><li id="06db" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated">将它们合二为一。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><h1 id="ec44" class="mr ms it bd mt mu mv mw mx my mz na nb ki nc kj nd kl ne km nf ko ng kp nh ni bi translated">在数据集上训练模型</h1><p id="f6b1" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">我使用Keras、TensorFlow和ResNet architecture来训练我的模型。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="d137" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">使用以下命令训练该模型需要大约30-45分钟。</p><pre class="ks kt ku kv gt nz oa ob oc aw od bi"><span id="3f61" class="no ms it oa b gy oe of l og oh">python train_model.py --az dataset/a_z_handwritten_data.csv --model trained_ocr.model</span><span id="dcb9" class="no ms it oa b gy oi of l og oh">[INFO] loading datasets...<br/>[INFO] compiling model...<br/>[INFO] training network...<br/>Epoch 1/50<br/> 34/437 [=&gt;……………………….] — ETA: 7:40 — loss: 2.5050 — accuracy: 0.2989<br/>...</span></pre><h1 id="d5a5" class="mr ms it bd mt mu mv mw mx my mz na nb ki nc kj nd kl ne km nf ko ng kp nh ni bi translated">标绘结果</h1><p id="53c9" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">我们将绘制一个可视化图，以便我们可以确保它正常工作。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/0a8cbef36117b0b1184c4b20ddb1308a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lNHV1UMS5L4YOP30trbU5w.png"/></div></div></figure><h1 id="d6b7" class="mr ms it bd mt mu mv mw mx my mz na nb ki nc kj nd kl ne km nf ko ng kp nh ni bi translated">作出预测</h1><p id="aea7" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">一旦模型被训练。我们可以用它来做预测。</p><pre class="ks kt ku kv gt nz oa ob oc aw od bi"><span id="2c50" class="no ms it oa b gy oe of l og oh">python prediction.py — model trained_ocr.model — image images/hello_world.png</span><span id="59bf" class="no ms it oa b gy oi of l og oh">[INFO] H - 92.48%<br/>[INFO] W - 54.50%<br/>[INFO] E - 94.93%<br/>[INFO] L - 97.58%<br/>[INFO] 2 - 65.73%<br/>[INFO] L - 96.56%<br/>[INFO] R - 97.31%<br/>[INFO] 0 - 37.92%<br/>[INFO] L - 97.13%<br/>[INFO] D - 97.83%</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/5f924275bed4ecbd3872369ef02c6d92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZvoJtFuMXiWaYzqch9TZcA.png"/></div></div></figure><p id="9a1f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">完整的源代码可以在这里看到:<a class="ae oq" href="https://github.com/housecricket/how-to-train-OCR-with-Keras-and-TensorFlow" rel="noopener ugc nofollow" target="_blank">https://github . com/house cricket/how-to-train-OCR-with-Keras-and-tensor flow</a></p><pre class="ks kt ku kv gt nz oa ob oc aw od bi"><span id="3a1b" class="no ms it oa b gy oe of l og oh">├── __init__.py<br/>├── dataset<br/>│   └── a_z_handwritten_data.csv<br/>├── images<br/>│   ├── hello_world.png<br/>│   └── vietnamxinchao.png<br/>├── models<br/>│   ├── __init__.py<br/>│   └── resnet.py<br/>├── prediction.py<br/>├── requirements.txt<br/>├── train_model.py<br/>├── trained_ocr.model<br/>└── utils.py</span></pre><h1 id="7fde" class="mr ms it bd mt mu mv mw mx my mz na nb ki nc kj nd kl ne km nf ko ng kp nh ni bi translated">结论</h1><p id="0ca3" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">最后，总结本文，我们可以说使用Keras、TensorFlow和Python来训练OCR模型是很容易的。此外，我们可以通过使用更好的数据集来提高该OCR模型的准确性。</p><p id="2d0f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你有什么想法吗…？很简单，对吧？</p><h1 id="fd30" class="mr ms it bd mt mu mv mw mx my mz na nb ki nc kj nd kl ne km nf ko ng kp nh ni bi translated">参考</h1><p id="4c5b" class="pw-post-body-paragraph lh li it lj b lk nj kd lm ln nk kg lp lq nl ls lt lu nm lw lx ly nn ma mb mc im bi translated">[1]http://yann.lecun.com/exdb/mnist<a class="ae oq" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"/></p><p id="3b15" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[2]<a class="ae oq" href="https://www.kaggle.com/sachinpatel21/az-handwritten-alphabets-in-csv-format/metadata" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/sachin Patel 21/az-handled-alphabets-in-CSV-format/metadata</a></p></div></div>    
</body>
</html>