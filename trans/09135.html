<html>
<head>
<title>I Taught a Machine How to Play Connect 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我教了一台机器如何玩Connect 4</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/i-taught-a-machine-how-to-play-connect-4-df261da4e23f?source=collection_archive---------33-----------------------#2021-08-23">https://towardsdatascience.com/i-taught-a-machine-how-to-play-connect-4-df261da4e23f?source=collection_archive---------33-----------------------#2021-08-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c0f9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我是如何构建一个可以在Connect 4中击败你的MATLAB程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8c28b8c4c3131a2b2335555ac0d07729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4BtEUAPmjkxVVRXfQ8OsA.png"/></div></div></figure><h2 id="f237" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">简介:</h2><p id="6971" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">棋盘游戏提供了大量令人着迷的原始数据，对于对编程感兴趣的人来说非常有用。Connect 4有6行7列，在一场比赛中包含了大量不同的游戏场景和决策。这让我有兴趣为这个经典的棋盘游戏设计一个战略算法。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="eefb" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">工作原理:</h2><p id="daf9" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在过去，我使用神经网络来完成所有的学习(就像我的文章<a class="ae mq" rel="noopener" target="_blank" href="/the-disneyland-algorithm-a-supervised-machine-learning-program-67c730cd62d5">迪士尼乐园算法</a>)。这种棋盘游戏的性质使得神经网络更难选择，只是因为它需要学习大量不同的场景。这就是为什么我离开了神经网络，而更倾向于一个基于评分的系统。</p><p id="7a69" class="pw-post-body-paragraph lq lr it ls b lt mr ju lv lw ms jx ly ld mt ma mb lh mu md me ll mv mg mh mi im bi translated">用户迈出第一步，然后程序开始对接下来的7步棋打分，找出最好的一步。</p><div class="kj kk kl km gt ab cb"><figure class="mw kn mx my mz na nb paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/f47fda96c5a4dfd4119d82252ecb7695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*l1Pxemp1nj66pRFvAKsn-g.png"/></div></figure><figure class="mw kn nc my mz na nb paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/e792399a0af3d56c63083c504d623609.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*hUhg0MWLFbCPQLo54lXsXA.png"/></div></figure></div><p id="15b2" class="pw-post-body-paragraph lq lr it ls b lt mr ju lv lw ms jx ly ld mt ma mb lh mu md me ll mv mg mh mi im bi translated">接下来的7个动作都基于3个标准评分:</p><ul class=""><li id="876d" class="nd ne it ls b lt mr lw ms ld nf lh ng ll nh mi ni nj nk nl bi translated">进攻优势:这一步在水平、垂直和对角线方向对计算机有什么好处？如果该移动将使计算机连续三次移动，则该移动在该方向获得3分。</li><li id="dda5" class="nd ne it ls b lt nm lw nn ld no lh np ll nq mi ni nj nk nl bi translated">防守的好处:和进攻一样，但是权重更大，所以电脑对游戏采取了更保守的方法。</li><li id="d165" class="nd ne it ls b lt nm lw nn ld no lh np ll nq mi ni nj nk nl bi translated">关键移动:阻止用户连续获得4个的移动，使计算机赢得游戏的移动，避免设置用户获胜的移动。所有这些都在“关键行动”部分考虑到了。</li></ul><p id="67e2" class="pw-post-body-paragraph lq lr it ls b lt mr ju lv lw ms jx ly ld mt ma mb lh mu md me ll mv mg mh mi im bi translated">以下是计算所有7个动作在垂直方向上的进攻优势的一些代码:</p><pre class="kj kk kl km gt nr ns nt nu aw nv bi"><span id="eb1a" class="ku kv it ns b gy nw nx l ny nz">scores = zeros(1,7); % array for all 7 offensive scores</span><span id="7fc8" class="ku kv it ns b gy oa nx l ny nz">opp_scores = zeros(1,7); % array for all 7 defensive scores</span><span id="f66b" class="ku kv it ns b gy oa nx l ny nz">for j = 1:7 % repeats for all 7spots</span><span id="2d95" class="ku kv it ns b gy oa nx l ny nz">hori = 0; % sets all scoring to 0</span><span id="d95f" class="ku kv it ns b gy oa nx l ny nz">vert = 0;</span><span id="9616" class="ku kv it ns b gy oa nx l ny nz">diag1 = 0;</span><span id="efbf" class="ku kv it ns b gy oa nx l ny nz">diag2 = 0;</span><span id="ecfe" class="ku kv it ns b gy oa nx l ny nz">if row_choices(j) ~= 0 % if the row is available for play (not filled up)</span><span id="4cd9" class="ku kv it ns b gy oa nx l ny nz">if row_choices(j) ~= 6 % if the choice is not in the bottom row</span><span id="2d2b" class="ku kv it ns b gy oa nx l ny nz">for i = row_choices(i) + 1:6 % looks at all the spaces below potential move</span><span id="a1e3" class="ku kv it ns b gy oa nx l ny nz">if layout(i,j) == 2 % if computer already has moves below</span><span id="3fcb" class="ku kv it ns b gy oa nx l ny nz">vert = vert + 1; % calculates how many in a row this move would achieve</span><span id="8aa9" class="ku kv it ns b gy oa nx l ny nz">else</span><span id="3faf" class="ku kv it ns b gy oa nx l ny nz">break</span><span id="5b23" class="ku kv it ns b gy oa nx l ny nz">end</span><span id="a33d" class="ku kv it ns b gy oa nx l ny nz">end</span><span id="50ce" class="ku kv it ns b gy oa nx l ny nz">vert = vert + 1; % adds 1 vertical point regardless (one move is still a tower of 1 in a row)</span><span id="8350" class="ku kv it ns b gy oa nx l ny nz">else</span><span id="63f3" class="ku kv it ns b gy oa nx l ny nz">vert = vert + 1; % adds 1 vertical point regardless (one move is still a tower of 1 in a row)</span><span id="5208" class="ku kv it ns b gy oa nx l ny nz">end</span></pre><p id="f5ce" class="pw-post-body-paragraph lq lr it ls b lt mr ju lv lw ms jx ly ld mt ma mb lh mu md me ll mv mg mh mi im bi translated">防守效益占得分的70%，进攻效益占剩下的30%。在对之前的分数进行合计后，根据特殊情况增加关键移动点。该程序返回所有7个可能的移动的分数，然后选择最高分的一个。</p><p id="d5d3" class="pw-post-body-paragraph lq lr it ls b lt mr ju lv lw ms jx ly ld mt ma mb lh mu md me ll mv mg mh mi im bi translated">例如，下面显示的是用户和程序在一轮移动后的输出。第一行是7个动作中每个动作的得分，在最高得分点(或最高得分点之一)标上“2”。从左边数第三列是1.90分，所以它是被选择的移动。“1”是用户的移动，“2”是程序的移动。</p><pre class="kj kk kl km gt nr ns nt nu aw nv bi"><span id="5598" class="ku kv it ns b gy nw nx l ny nz">0.9000    1.2000    1.9000    1.9000    1.9000    1.2000    0.9000</span><span id="a562" class="ku kv it ns b gy oa nx l ny nz">     0     0     0     0     0     0     0<br/>     0     0     0     0     0     0     0<br/>     0     0     0     0     0     0     0<br/>     0     0     0     0     0     0     0<br/>     0     0     0     0     0     0     0<br/>     0     0     2     1     0     0     0</span></pre><p id="19ef" class="pw-post-body-paragraph lq lr it ls b lt mr ju lv lw ms jx ly ld mt ma mb lh mu md me ll mv mg mh mi im bi translated">这个过程一直持续到游戏结束。根据下面代码的结果，游戏结束，该代码检查可能存在顺子4的每个可能位置，并在满足该条件时中断游戏循环。</p><pre class="kj kk kl km gt nr ns nt nu aw nv bi"><span id="4115" class="ku kv it ns b gy nw nx l ny nz">iar = 0; % variable for same colors in a row</span><span id="a313" class="ku kv it ns b gy oa nx l ny nz">done = 0; % break for "for" loop</span><span id="db6f" class="ku kv it ns b gy oa nx l ny nz">all_done = 0; % break for larger "for" loop</span><span id="8bef" class="ku kv it ns b gy oa nx l ny nz">for i = 1:6 % for all rows</span><span id="d956" class="ku kv it ns b gy oa nx l ny nz">for j = 1:7 % for all columns</span><span id="8337" class="ku kv it ns b gy oa nx l ny nz">if layout(i,j) == 2 % if there is a "2" in that spot</span><span id="aee2" class="ku kv it ns b gy oa nx l ny nz">iar = iar + 1; % one more in a row</span><span id="7124" class="ku kv it ns b gy oa nx l ny nz">if iar == 4 % if 4 in a row</span><span id="0206" class="ku kv it ns b gy oa nx l ny nz">all_done = 1; % ends larger "for" loop</span><span id="e9b5" class="ku kv it ns b gy oa nx l ny nz">done = 1; % ends smaller "for" loop</span><span id="49b2" class="ku kv it ns b gy oa nx l ny nz">break % ends the search for horizontal 4 in a row</span><span id="8bdd" class="ku kv it ns b gy oa nx l ny nz">end</span><span id="6cfb" class="ku kv it ns b gy oa nx l ny nz">else</span><span id="56c3" class="ku kv it ns b gy oa nx l ny nz">iar = 0; % if not 4 in a row, sets back to 0</span><span id="6702" class="ku kv it ns b gy oa nx l ny nz">end</span><span id="45da" class="ku kv it ns b gy oa nx l ny nz">end</span><span id="5057" class="ku kv it ns b gy oa nx l ny nz">iar = 0; % sets back to 0</span><span id="8e46" class="ku kv it ns b gy oa nx l ny nz">if done == 1 % breaks a "for" loop</span><span id="38c4" class="ku kv it ns b gy oa nx l ny nz">break</span><span id="d11d" class="ku kv it ns b gy oa nx l ny nz">end</span><span id="9592" class="ku kv it ns b gy oa nx l ny nz">end</span><span id="aa0a" class="ku kv it ns b gy oa nx l ny nz">if all_done == 1 % ends game</span><span id="1329" class="ku kv it ns b gy oa nx l ny nz">disp("Loss") % displays that you lost</span><span id="8855" class="ku kv it ns b gy oa nx l ny nz">comp_win = 1; % indicates the computer won</span><span id="fdb8" class="ku kv it ns b gy oa nx l ny nz">break % ends game loop</span><span id="9529" class="ku kv it ns b gy oa nx l ny nz">end</span></pre><p id="4f99" class="pw-post-body-paragraph lq lr it ls b lt mr ju lv lw ms jx ly ld mt ma mb lh mu md me ll mv mg mh mi im bi translated">一场已结束的游戏在下面显示为赢(四个1在对角线上)，或输(四个2在对角线上)。</p><pre class="kj kk kl km gt nr ns nt nu aw nv bi"><span id="3c68" class="ku kv it ns b gy nw nx l ny nz">Win<br/>     0     0     0     0     2     2     2<br/>     0     0     0     1     1     1     2<br/>     1     0     2     2     1     2     1<br/>     2     0     1     2     2     1     2<br/>     1     2     2     1     2     1     1<br/>     1     1     2     1     1     1     2</span><span id="0bef" class="ku kv it ns b gy oa nx l ny nz">Loss<br/>     0     0     0     0     0     0     0<br/>     0     0     0     0     2     1     1<br/>     0     0     2     0     2     1     2<br/>     0     0     1     2     1     2     1<br/>     0     0     1     2     2     2     1<br/>     0     0     2     1     1     2     1</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="b7c5" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">结论:</h2><p id="c9b9" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">我在一台在线Connect 4计算机上测试了这个Connect 4算法，看看它有多有效。10场比赛后，我的Connect 4程序已经累积了3胜3平4负。虽然它不能100%地赢得与其他计算机的比赛，但它为普通的Connect 4玩家提供了一个有价值的对手。在为未来的成功做准备时，它被证明是一个不错的决策者，并且在开发棋盘游戏算法时是一个很好的挑战。</p></div></div>    
</body>
</html>