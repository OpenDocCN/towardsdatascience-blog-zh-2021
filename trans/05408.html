<html>
<head>
<title>Voice classification using Deep Learning, with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">语音分类使用深度学习，用Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/voice-classification-using-deep-learning-with-python-6eddb9580381?source=collection_archive---------7-----------------------#2021-05-13">https://towardsdatascience.com/voice-classification-using-deep-learning-with-python-6eddb9580381?source=collection_archive---------7-----------------------#2021-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/1a4b1cd106343c41ef4f7e6b2aefa4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sRSAETvn9Rfe3AQgOEQoTA.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Jukka Aalho 在<a class="ae jd" href="https://unsplash.com/s/photos/audio?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="845f" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">以下是如何使用深度学习对音轨的声音进行分类</h2></div><p id="5670" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有时人类能够非常容易地做某些事情，但是他们不能恰当地描述他们是如何做的。<strong class="kx jh">例如，当两个不同的声音说话时，我们能够清楚地区分它们，但很难描述我们用来区分它们的确切特征</strong>。由于任务很难描述，教计算机如何做就更难了。幸运的是，我们有数据，我们可以用这些例子来训练我们的机器。</p><p id="10c3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们开始吧！</p><h2 id="ce11" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">1.设置</h2><p id="ac07" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">如题，我用过<strong class="kx jh"> Python </strong>。特别是，我使用了这些库:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="b5ca" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将在此过程中使用它们。</p><h2 id="2e4c" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">2.数据集</h2><p id="133c" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我用了第一场美国2020年总统辩论的前30分钟。具体来说，任务是区分三种声音:</p><ul class=""><li id="7442" class="mv mw jg kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated"><strong class="kx jh">克里斯·华莱士(主持人)</strong></li><li id="a228" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx jh">(前任)总统唐纳德·特朗普</strong></li><li id="13ed" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx jh">(前任)副总统乔拜登</strong></li></ul><p id="9aff" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">音频可以在<a class="ae jd" href="https://www.kaggle.com/headsortails/us-election-2020-presidential-debates?select=us_election_2020_1st_presidential_debate.mp3" rel="noopener ugc nofollow" target="_blank">这里</a>找到。特别是，你有一个. csv文件，一步一步地描述所有的争论。然后，你有一个. mp3文件，这是辩论的音频。我对它进行了裁剪，得到了一个30分钟的音频(为了让过程更快)，并将其命名为“<strong class="kx jh"> trimmed.mp3 </strong>”。然后我做了音频的<strong class="kx jh">梅尔频谱图</strong>。很多人比我解释得更好(<a class="ae jd" href="https://medium.com/analytics-vidhya/understanding-the-mel-spectrogram-fca2afa2ce53" rel="noopener">例如</a>)，但是你可以认为<strong class="kx jh"> MEL频谱图是音频信号的频率表示，它被转换以更接近我们对声音的感知。</strong>最终结果如下:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1483" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，信号基本上有20个频率。采样率为22010 Hz，<strong class="kx jh">因此，可以使用代码</strong>提取时间向量</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="39ce" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，由于已经使用了<strong class="kx jh">监督学习方法，是时候使用。csv文件。</strong>特别是，它由三列组成:</p><ul class=""><li id="3e50" class="mv mw jg kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated">演讲者<strong class="kx jh">(华莱士、拜登或特朗普)</strong></li><li id="f88d" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">结束分钟<strong class="kx jh">(分:秒或小时:分:秒)</strong></li><li id="bb6c" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx jh">演讲</strong></li></ul><p id="43fe" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为我们有以秒为单位的时间，所以我们将结束分钟转换为秒:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9a40" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们完成了。</p><p id="a996" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尽管如此，它是关于整个演讲，而正如已经说过的，音频较短。<strong class="kx jh">由于这个原因，数据集的一部分也被取走了。</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="01a9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">让我们来看看:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="a47e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在可以轻松地将<strong class="kx jh">音频数据转换成熊猫数据帧:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="4159" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">开始了。所以现在我们有20列X 74200+行…非常大。<strong class="kx jh">为此，已执行</strong><strong class="kx jh"/>主成分分析(PCA)缩减:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="e06f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">现在，我们要合并。带有pca_data数据帧的csv文件。</strong>为了做到这一点，我们定义了另一个列，告诉你，对于那个特定的点，说话者:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1d13" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，<strong class="kx jh">我们来看看。</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="4305" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为这是可以预测的，所以有必要查看时间序列以了解正在发生的事情。为了简单起见，让我们使用<strong class="kx jh">互信息</strong>来选择最具信息性的特征，并从中提取出一个<strong class="kx jh">时间序列</strong>。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="3a5b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">信息量最大的是2组分。</strong></p><p id="c8f7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">事情是这样的:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="d167" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">使用LabelEncoder(): </strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="0303" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">定义字典:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="0abb" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><strong class="ak"> 3。深度学习</strong></h2><p id="910c" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">现在我们已经有了我们需要的一切，我们来谈谈深度学习。虽然众所周知，卷积神经网络对图像非常有效，但很少有人知道它们对时间序列也很有效。<strong class="kx jh">其实我们会用一个CNN来区分三种声音。</strong></p><p id="fadd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">让我们使用一个训练测试分割并混合数据:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="4d63" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">定义模型:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="0762" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">训练模型:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2595" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">评估模型:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="de51" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该模型以softmax结尾。这意味着我们基本上获得了特朗普、拜登或华莱士发言的概率。这里有一个例子:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8d05" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">让我们来探索一下测试集:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="82fa" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">结果如下:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/e7191b8ced1830839279129ff35f6a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bTLnEbKohWLQignW6ykXbA.png"/></div></div></figure><p id="e9cb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">正如可能看到的，当他们实际说话时，概率很高，这是一个好迹象！</strong>此外，如果我们直接评估准确性，我们是严格的，因为该算法在几分之一秒内工作，而人类语音不能变化如此之快(例如，强制预测不变，直到某个时间增量被验证，这可能是一个好主意)。</p><p id="1d78" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尽管如此，让我们严肃一会儿，让我们画出困惑矩阵:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="aebc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">和分类报告:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1425" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们有68%的准确率。</p><h1 id="59c0" class="nk ls jg bd lt nl nm nn lw no np nq lz km nr kn mc kp ns kq mf ks nt kt mi nu bi translated">摘要</h1><p id="b1f0" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">简而言之，已经开展的进程如下:</p><ul class=""><li id="10e9" class="mv mw jg kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated"><strong class="kx jh">获取音频数据，修整并应用MEL频谱图</strong></li><li id="1b22" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx jh">使用主成分分析降低维数</strong></li><li id="432f" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx jh">使用。标记音频数据的csv数据</strong></li><li id="678e" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx jh">定义深度学习CNN模型</strong></li><li id="0869" class="mv mw jg kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx jh">得到结果</strong></li></ul><p id="875b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="ce33" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.在<a class="ae jd" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Linkedin </strong> </a>上关注我，我在那里发布我所有的故事<br/> B .订阅我的<a class="ae jd" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="kx jh">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae jd" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="kx jh">推荐会员</strong> </a>，这样你就不会有任何“本月最大故事数”，你可以阅读我(以及数千名其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p></div></div>    
</body>
</html>