<html>
<head>
<title>Data Science For Cycling — How to Visualize GPX Strava Routes With Python and Folium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自行车运动的数据科学——如何使用Python和Folium可视化GPX斯特拉发路线</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-science-for-cycling-how-to-visualize-gpx-strava-routes-with-python-and-folium-21b96ade73c7?source=collection_archive---------32-----------------------#2021-12-13">https://towardsdatascience.com/data-science-for-cycling-how-to-visualize-gpx-strava-routes-with-python-and-folium-21b96ade73c7?source=collection_archive---------32-----------------------#2021-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b04c" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/data-science-for-cycling" rel="noopener" target="_blank">自行车运动的数据科学</a></h2><div class=""/><div class=""><h2 id="b1fc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated"><strong class="ak">第2/6部分——使用令人惊叹的Python库轻松可视化Strava路线</strong></h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/63db4b04e68ca3fbc84ff67f901235aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u5DP_Ka7a3sFLpw6"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@flo_karr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Flo吉田</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="0dc4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上周<a class="ae lh" href="https://betterdatascience.com/data-science-for-cycling-how-to-read-gpx-strava-routes-with-python/" rel="noopener ugc nofollow" target="_blank">你了解了所有关于GPX的数据。您还以GPX格式导出了Strava路径，用Python加载了它，并提取了关键数据点，如纬度、经度和海拔。今天你将使用这些点在地图上画出路线！</a></p><p id="d600" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将开始用Matplotlib可视化Strava路线，但是我们将很快过渡到一个更专业的库——follow。如果您还没有安装它，请使用Pip安装它(pip install folium)。我们开始吧。</p><p id="46dc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">不想看书？请观看我的视频:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="4065" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在<a class="ae lh" href="https://github.com/better-data-science/data-science-for-cycling" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上下载源代码。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="4cc8" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">如何读取Strava路径数据集</h1><p id="bd6c" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">我们今天不会为GPX文件费心，因为我们已经有提取到CSV文件的路线数据点。首先，我们必须导入几个库——主要是熊猫和叶子——还有Matplotlib，用于基本的路线可视化:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="704d" class="np mo it nl b gy nq nr l ns nt">import folium<br/>import pandas as pd</span><span id="211f" class="np mo it nl b gy nu nr l ns nt">import matplotlib.pyplot as plt<br/>plt.rcParams['axes.spines.top'] = False<br/>plt.rcParams['axes.spines.right'] = False<br/>from IPython.display import display</span></pre><p id="d7a0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，您可以加载路径数据集:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="db12" class="np mo it nl b gy nq nr l ns nt">route_df = pd.read_csv('../data/route_df.csv')<br/>route_df.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/098747b80a463a2f517316e62112376b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*GtgK0juOkqgpfN5ViM_ijw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片1-Strava路径数据集(图片由作者提供)</p></figure><p id="c148" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集中有835个数据点，这对于代表性的路线可视化来说绰绰有余。让我们从Matplotlib开始，讨论为什么这不是一个好主意。</p><h1 id="d069" class="mn mo it bd mp mq nw ms mt mu nx mw mx ki ny kj mz kl nz km nb ko oa kp nd ne bi translated">如何用Matplotlib可视化Strava路线</h1><p id="f1be" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">您可以使用Matplotlib将纬度和经度点可视化为散点图，X轴为经度，Y轴为纬度。这非常有限，因为您将只能看到路径本身，而没有基础地图:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="bf78" class="np mo it nl b gy nq nr l ns nt">plt.figure(figsize=(14, 8))<br/>plt.scatter(route_df['longitude'], route_df['latitude'], color='#101010')<br/>plt.title('Route latitude and longitude points', size=20);</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/d6fb13f37be9f1b7c669029021d80ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9LUFqcYWUbH7S8G4413ZQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图2-使用Matplotlib的Strava路线可视化(图片由作者提供)</p></figure><p id="3d1e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">出于这个原因，我不推荐Matplotlib或任何其他用于显示地图的非专业可视化包。有许多专门的解决方案，但我发现leav是最容易使用的一个。</p><h1 id="98c2" class="mn mo it bd mp mq nw ms mt mu nx mw mx ki ny kj mz kl nz km nb ko oa kp nd ne bi translated">如何使用leav可视化Strava路线</h1><p id="376c" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated"><a class="ae lh" href="https://python-visualization.github.io/folium/" rel="noopener ugc nofollow" target="_blank">follow</a>是一个用于可视化地理空间数据的Python库。它只是一个<a class="ae lh" href="https://leafletjs.com/" rel="noopener ugc nofollow" target="_blank">传单</a>的包装器，一个用于绘制交互式地图的开源JavaScript库。</p><p id="b07e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在显示地图之前，必须知道一些事情。它们是地理位置(纬度和经度)、缩放级别和切片(地图的外观)。我们还将添加高度和宽度，这样地图就不会太大:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="b7dd" class="np mo it nl b gy nq nr l ns nt">route_map = folium.Map(<br/>    location=[45.79757947, 15.9007929],<br/>    zoom_start=13,<br/>    tiles='OpenStreetMap',<br/>    width=1024,<br/>    height=600<br/>)<br/>display(route_map)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/fdd1ca7382ad09217a68e66404831f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUxxdl8OEKFAGxmLxGEN_g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图3 —克罗地亚萨格勒布的一张空白树叶地图(图片由作者提供)</p></figure><p id="52c0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简单吧？这是一张克罗地亚萨格勒布西部的空白地图，因为那是我的路线所在。向地图添加数据点非常简单，基本上就是迭代数据集，并在每个纬度和经度组合处添加一个圆形标记。我们将保留默认参数，唯一要改变的是圆的半径:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="5d5e" class="np mo it nl b gy nq nr l ns nt">route_map = folium.Map(<br/>    location=[45.79757947, 15.9007929],<br/>    zoom_start=13,<br/>    tiles='OpenStreetMap',<br/>    width=1024,<br/>    height=600<br/>)</span><span id="ef3f" class="np mo it nl b gy nu nr l ns nt">for _, row in route_df.iterrows():<br/>    folium.CircleMarker(<br/>        location=[row['latitude'], row['longitude']],<br/>        radius=3,<br/>    ).add_to(route_map)</span><span id="29be" class="np mo it nl b gy nu nr l ns nt">display(route_map)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/f3f18f60126a90ff3337bb2be8431026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mTwLm0DQwRhXf_K5TjOwOQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图4-用圆形标记可视化Strava路线(图片由作者提供)</p></figure><p id="7c77" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们有进展了。唯一的问题是——路径通常不会用圆圈标记来表示。这有点问题，因为我们只有数据点。我们可以将它们连接成一条多边形线，但这样做需要提取地理位置信息作为元组列表:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="1a29" class="np mo it nl b gy nq nr l ns nt">route_map = folium.Map(<br/>    location=[45.79757947, 15.9007929],<br/>    zoom_start=13,<br/>    tiles='OpenStreetMap',<br/>    width=1024,<br/>    height=600<br/>)</span><span id="c702" class="np mo it nl b gy nu nr l ns nt">coordinates = [tuple(x) for x in route_df[['latitude', 'longitude']].to_numpy()]<br/>folium.PolyLine(coordinates, weight=6).add_to(route_map)</span><span id="47bb" class="np mo it nl b gy nu nr l ns nt">display(route_map)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/1730dc89910c488725764d3da17928cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZLCeYOG34m9uor4jbXmJA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图5-用多边形线可视化Strava路线(图片由作者提供)</p></figure><p id="ada3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本质上，您需要编写的代码更少，地图最终看起来更好——双赢。</p><p id="7204" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是如果你对过于详细的地图不满意呢？好消息是，您可以根据自己的喜好调整平铺参数。这是一个卡通、轻盈、简约的瓷砖选项示例:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="95f8" class="np mo it nl b gy nq nr l ns nt">route_map = folium.Map(<br/>    location=[45.79757947, 15.9007929],<br/>    zoom_start=13,<br/>    tiles='CartoDBPositron',<br/>    width=1024,<br/>    height=600<br/>)</span><span id="ce1c" class="np mo it nl b gy nu nr l ns nt">coordinates = [tuple(x) for x in route_df[['latitude', 'longitude']].to_numpy()]<br/>folium.PolyLine(coordinates, weight=6).add_to(route_map)</span><span id="109f" class="np mo it nl b gy nu nr l ns nt">display(route_map)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/4c8f6bc422db7a514e8f2a91400bb741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5gaHYRAlIpFTuNECCUQTOg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图6-更改地图分块(1)(图片由作者提供)</p></figure><p id="5356" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你也可以反其道而行之，就是用一个黑暗的主题。为此，请将tiles参数更改为CartoDBDark_Matter:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="f4f3" class="np mo it nl b gy nq nr l ns nt">route_map = folium.Map(<br/>    location=[45.79757947, 15.9007929],<br/>    zoom_start=13,<br/>    tiles='CartoDBDark_Matter',<br/>    width=1024,<br/>    height=600<br/>)</span><span id="f597" class="np mo it nl b gy nu nr l ns nt">coordinates = [tuple(x) for x in route_df[['latitude', 'longitude']].to_numpy()]<br/>folium.PolyLine(coordinates, weight=6).add_to(route_map)</span><span id="a70f" class="np mo it nl b gy nu nr l ns nt">display(route_map)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/09ba78c1513d6e53c9c60eec61e4dde5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrIcdIZw8vHCw5OjnUBG8w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图7-更改地图分块(2)(图片由作者提供)</p></figure><p id="a551" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一开始看起来有点奇怪，但是你可以让它工作。例如，将多边形线条颜色更改为白色，会使其更加突出。</p><p id="ed6a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以通过检查文档字符串来浏览其他图块，以下是可用选项:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="c601" class="np mo it nl b gy nq nr l ns nt">folium.Map?</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/c7444d20df9baa10493efbdb69d619c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVL1xTz2ZMzbCd0u2xb_VQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图8-foylus中可用的地图切片(图片由作者提供)</p></figure><p id="0f5d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了Mapbox之外的一切都是可用的，因为Mapbox需要一个API键。我们将坚持免费选项，因为它们已经足够好了。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="2841" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">结论</h1><p id="9ff8" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">这就是你要做的——如何使用have轻松可视化GPX斯特拉发路线。我们不会用地图做任何更复杂的事情，因为这本身就非常适合我们的需求。在下一篇文章中，您将了解如何计算高程差和数据点之间的距离，并在后面的文章中了解更多内容。</p><p id="1323" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是整个系列的链接——我会在发布文章时添加网址:</p><ul class=""><li id="bd62" class="oe of it lk b ll lm lo lp lr og lv oh lz oi md oj ok ol om bi translated"><a class="ae lh" href="https://betterdatascience.com/data-science-for-cycling-how-to-read-gpx-strava-routes-with-python/" rel="noopener ugc nofollow" target="_blank">第1篇:从Strava加载并分析GPX文件</a></li><li id="fe38" class="oe of it lk b ll on lo oo lr op lv oq lz or md oj ok ol om bi translated"><a class="ae lh" href="https://betterdatascience.com/data-science-for-cycling-how-to-visualize-gpx-strava-routes-with-python-and-folium/" rel="noopener ugc nofollow" target="_blank">第二条:用圆形标记和多边形线可视化来自Strava的GPX文件</a></li><li id="d9c6" class="oe of it lk b ll on lo oo lr op lv oq lz or md oj ok ol om bi translated">第3条:计算点与点之间的高差和距离，可视化路线的高程剖面</li><li id="01ea" class="oe of it lk b ll on lo oo lr op lv oq lz or md oj ok ol om bi translated">第4条:根据点之间的高程差和距离计算路线坡度</li><li id="9555" class="oe of it lk b ll on lo oo lr op lv oq lz or md oj ok ol om bi translated">文章5:计算和可视化梯度剖面——在梯度范围内循环的距离</li><li id="f4a5" class="oe of it lk b ll on lo oo lr op lv oq lz or md oj ok ol om bi translated">文章6:创建一个web应用程序，分析并可视化用户从Strava上传的GPX文件</li></ul></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="f03f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">喜欢这篇文章吗？成为 <a class="ae lh" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="os">中等会员</em> </a> <em class="os">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ot ou gp gr ov ow"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd jd gy z fp pb fr fs pc fu fw jc bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">medium.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk lb ow"/></div></div></a></div></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="d28e" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">保持联系</h1><ul class=""><li id="65c1" class="oe of it lk b ll nf lo ng lr pl lv pm lz pn md oj ok ol om bi translated">注册我的<a class="ae lh" href="https://mailchi.mp/46a3d2989d9b/bdssubscribe" rel="noopener ugc nofollow" target="_blank">简讯</a></li><li id="aec8" class="oe of it lk b ll on lo oo lr op lv oq lz or md oj ok ol om bi translated">在YouTube<a class="ae lh" href="https://www.youtube.com/c/BetterDataScience" rel="noopener ugc nofollow" target="_blank">上订阅</a></li><li id="b0e6" class="oe of it lk b ll on lo oo lr op lv oq lz or md oj ok ol om bi translated">在<a class="ae lh" href="https://www.linkedin.com/in/darioradecic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</li></ul></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="442d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="os">原载于2021年12月13日https://betterdatascience.com</em><a class="ae lh" href="https://betterdatascience.com/data-science-for-cycling-how-to-visualize-gpx-strava-routes-with-python-and-folium/" rel="noopener ugc nofollow" target="_blank"><em class="os"/></a><em class="os">。</em></p></div></div>    
</body>
</html>