<html>
<head>
<title>Bayesian Linear Regression with Bambi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bambi 贝叶斯线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bayesian-linear-regression-with-bambi-a5e6570f167b?source=collection_archive---------4-----------------------#2021-12-30">https://towardsdatascience.com/bayesian-linear-regression-with-bambi-a5e6570f167b?source=collection_archive---------4-----------------------#2021-12-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="76ba" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用贝叶斯推理得到你的预测分布</h2></div><h1 id="10cb" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">动机</h1><p id="0629" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">用回归线拟合样本数据时，可能会得到如下的回归线:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/3da5fc4d2482d546cec7cf707d039ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*qRVagVIcnI4etEm8tMfyVg.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="56eb" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">如果你能得到一个预测的分布，而不是一条回归线，不是很好吗？</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/a779e0c2ba64041b958a4582a02dfe5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*Ys03YYiu94Z1fLsRoFpzkw.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="47bd" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">这就是贝叶斯线性回归派上用场的时候。在本文中，您将学习如何用 Python 构建贝叶斯线性回归。</p><h1 id="809b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">线性回归到底是什么？</h1><p id="5948" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">要了解贝叶斯线性回归和普通最小二乘线性回归(OLS)(我们都很熟悉的线性回归)的区别，我们先来了解一下什么是 OLS。</p><h2 id="267d" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">从一个例子开始</h2><p id="d61c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">理解算法最简单的方法是从一个例子开始。</p><p id="8f71" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">我们将在 Kaggle 上使用显示学生数学和葡萄牙语成绩的数据集。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/e317a4e62f6c6e9b9361eeb97a52f149.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*kg2Zrs3sQay3IeZvzfTrtg.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="376b" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">绘制数据:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/4ec45c74c42ca035096c81acfe46097b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*zoEVRK2lo7icSpQjd-a8og.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="d616" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">我们的目标是找到最能描述数学成绩和葡萄牙语成绩之间关系的线性回归线。</p><p id="e5cb" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">如果您有𝑛变量，您的线性回归方程将如下所示:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/c2de4b772c1da042d9a01a48d16b5930.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*bhth3TR0zdnzgmz7-FA_3Q.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="91ea" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">其中𝑦是响应变量，𝑥's 是解释变量，𝛽ᵢ是变量𝑥ᵢ的权重，<em class="nf"> ε </em>是误差项。</p><p id="9636" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">由于我们的数据中只有一个解释变量，我们的线性回归方程将如下所示:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c7a088bb5ce861cde74b2a00b2a0f4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*st6GQ9__Xr1LOpvbJqGsRQ.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="7872" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">其中，𝑦是预测的葡萄牙语分数，𝑥是观察到的数学分数。</p><p id="d233" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">在矩阵形式中，等式变为:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/d3d1b7c652a1e6dcbde9c10d04058d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*-ukOGx8ccZJVmULuRKpamw.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="411d" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">𝛽有几个可能的值，但我们将只选择最小化残差平方和(RSS)的𝛽值。RSS 是𝑦ᵢ和𝑦̂ᵢ之间的平方差之和，其中𝑦ᵢ是数据的第一个实际值，𝑦̂ᵢ是使用回归的第一个预测值。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9dd80a8b9c6f6513b826b7f25f2cb6da.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*2ze7n6EqH0CElh1ZvjqByw.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="78d0" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">最小化 RSS 将给出𝛽.的估计让我们尝试使用 scikit-learn 的线性回归模型来应用这个方法。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="d9cb" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">绘制回归线:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/1798a182cf1d46c9de48ca262e9592ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*FoQkN4DTnLD_hGWGCm6lhQ.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="54c6" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">求系数:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><pre class="lx ly lz ma gt nj nk nl nm aw nn bi"><span id="6beb" class="mn kj it nk b gy no np l nq nr">array([0.4335796])</span></pre><p id="d7d9" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">找到截距:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><pre class="lx ly lz ma gt nj nk nl nm aw nn bi"><span id="d11f" class="mn kj it nk b gy no np l nq nr">7.403346211071996</span></pre><p id="eff9" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">通过看系数和曲线图，我们可以说，如果数学成绩增加 1，葡萄牙语平均成绩增加 0.43。如果数学成绩为 0，葡萄牙语成绩的预测值为 7.403。</p><p id="5364" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">普通最小二乘法返回单点估计。但是如果我们想看到可能的估计值的分布呢？让我们试着用斑比来做这件事。</p><h1 id="38b6" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">使用 Bambi 构建贝叶斯线性回归模型</h1><h2 id="1bda" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">斑比是什么？</h2><p id="f918" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae mz" href="https://bambinos.github.io/bambi/main/index.html" rel="noopener ugc nofollow" target="_blank"> Bambi </a>是用 Python 编写的高级贝叶斯建模接口。它构建在编程框架 PyMC3 之上。因此，Bambi 类似于 PyMC3，但是更容易使用。</p><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/detect-change-points-with-bayesian-inference-and-pymc3-3b4f3ae6b9bb"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">用贝叶斯推理和 PyMC3 检测变化点</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">用观察到的数据更新你的信念</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj mc nv"/></div></div></a></div><p id="93eb" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">要安装 Bambi，请键入:</p><pre class="lx ly lz ma gt nj nk nl nm aw nn bi"><span id="d498" class="mn kj it nk b gy no np l nq nr">pip install bambi</span></pre><h2 id="0e55" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">建立线性回归模型</h2><p id="8f76" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用 Bambi 构建线性回归模型非常简单。既然我们要用<code class="fe ok ol om nk b">mat</code>(数学成绩)来预测<code class="fe ok ol om nk b">por</code>(葡萄牙成绩)，我们可以写:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="2b9b" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">使用 PyMC3 从 4 条链中各抽取 1000 个样本(单次运行<a class="ae mz" href="https://machinelearningmastery.com/markov-chain-monte-carlo-for-probability/" rel="noopener ugc nofollow" target="_blank"> MCMC </a>):</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="6159" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">默认情况下，Bambi 使用<code class="fe ok ol om nk b">family="gaussian"</code>，这意味着具有正常误差的线性回归。</p><h2 id="a93b" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">分析系数的分布</h2><p id="130f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用<a class="ae mz" href="https://arviz-devs.github.io/arviz/" rel="noopener ugc nofollow" target="_blank"> ArviZ </a>绘制结果:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="oo op di oq bf or"><div class="gh gi on"><img src="../Images/ca06aa9b34873d371495cb56d23c7f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1EVnHN8FXoO8VLxRml1HA.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="4b47" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">在上图中，<code class="fe ok ol om nk b">Intercept</code>和<code class="fe ok ol om nk b">mat</code>分别是来自方程𝑦 = 𝛽₀ + 𝛽₁𝑥 + <em class="nf"> ε的𝛽₀和𝛽₁。</em>左边的图显示了变量的分布。右边的图显示了每次迭代中每个变量的值。</p><p id="bf16" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">看左边的图，我们可以说:</p><ul class=""><li id="ba32" class="os ot it lc b ld mi lg mj lj ou ln ov lr ow lv ox oy oz pa bi translated">𝛽₀和𝛽₁的分布接近正态分布。</li><li id="cd76" class="os ot it lc b ld pb lg pc lj pd ln pe lr pf lv ox oy oz pa bi translated">𝛽₀的平均值从 7.2 到 7.5。</li><li id="019b" class="os ot it lc b ld pb lg pc lj pd ln pe lr pf lv ox oy oz pa bi translated">𝛽₁的平均值从 0.42 到 0.44。</li></ul><p id="ad36" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">这太酷了！我们得到的不是𝛽₀和𝛽₁的单点估计，而是𝛽₀和𝛽₁的分布。</p><p id="0140" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">分布的形状也有助于我们理解我们对𝛽₀或𝛽₁.的价值有多确定具体来说:</p><ul class=""><li id="da31" class="os ot it lc b ld mi lg mj lj ou ln ov lr ow lv ox oy oz pa bi translated">分布的扩散越大(越大<em class="nf">【σ】</em>)，我们对𝛽₀和𝛽₁.的价值就越不确定</li><li id="0856" class="os ot it lc b ld pb lg pc lj pd ln pe lr pf lv ox oy oz pa bi translated">分布的扩散越小(越小<em class="nf">【σ】</em>)，我们对𝛽₀和𝛽₁.的价值就越有把握</li></ul><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/93550e2b1d211ca975518430025a875c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*W4ur29aaAWDW4v1GA_Xilg.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><h2 id="efc4" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">比较贝叶斯线性回归和 OLS 的结果</h2><p id="64d8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">与 scikit-learn 的普通最小二乘线性回归生成的𝛽₀和𝛽₁的值相比，Bambi 的贝叶斯线性回归生成的𝛽₀和𝛽₁的平均值如何？从寻找斑比创造的𝛽₀和𝛽₁的意义开始。</p><p id="af87" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">𝛽₀:的意义</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><pre class="lx ly lz ma gt nj nk nl nm aw nn bi"><span id="edc8" class="mn kj it nk b gy no np l nq nr">0.43346411871369533</span></pre><p id="b580" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">𝛽₁:的意义</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><pre class="lx ly lz ma gt nj nk nl nm aw nn bi"><span id="edb6" class="mn kj it nk b gy no np l nq nr">7.403637994335104</span></pre><p id="43b7" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">它们非常接近 scikit-learn 生成的𝛽₀和𝛽₁的值！</p><h2 id="cf53" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">绘制回归线</h2><p id="db44" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">𝛽₀和𝛽₁.共有 4×1000 = 4000 个样本对于每一对𝛽₀和𝛽₁，我们可以得到𝑦.的一个估计</p><p id="0794" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">让我们用 10 对不同的𝛽₀和𝛽₁:来看 10 个预测</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/28030c53a5ff93bded20eafd54ee9913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*2Xl6KA_Ro2tXccabEyhVWw.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="1641" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">酷！现在让我们使用𝛽₀ 的<strong class="lc iu">平均值和𝛽₁ </strong>的<strong class="lc iu">平均值来得到𝑦(用黑线表示)的单一估计值。</strong></p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/40e39eca08e5316a9bcb42c49de0376d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*-lKqprJkPTXgHvg6zHVHnQ.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="c7d9" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">从上面的图中，我们可以看到黑线很好的呈现了所有的绿线。</p><h2 id="d4a8" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">所有预测的分布图</h2><p id="8b53" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">将单个预测分布与平均预测分布进行比较的另一种方法是将它们的分布相互重叠。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/e4ef7f3b3ed34221d5a6d516805651b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*JAPsG_3kjyENysKyvyFCLw.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="891d" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">从上面的图中我们可以看到，橙色线(平均预测分布)很好地代表了黑线(观察值)。</p><h2 id="ccf3" class="mn kj it bd kk mo mp dn ko mq mr dp ks lj ms mt ku ln mu mv kw lr mw mx ky my bi translated">绘制预测的最高密度区间</h2><p id="b69b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">对于𝑥 的特定值，最常见的<strong class="lc iu">预测是什么？让我们使用<code class="fe ok ol om nk b">az.plot_hdi</code> (HDI 代表最高密度区间)来解决这个问题。</strong></p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/a779e0c2ba64041b958a4582a02dfe5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*Ys03YYiu94Z1fLsRoFpzkw.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">作者图片</p></figure><p id="24a5" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">在上面的图中，</p><ul class=""><li id="758c" class="os ot it lc b ld mi lg mj lj ou ln ov lr ow lv ox oy oz pa bi translated">暗红色区间是给定𝑥值时 38%的预测值所在的区间</li><li id="f187" class="os ot it lc b ld pb lg pc lj pd ln pe lr pf lv ox oy oz pa bi translated">给定𝑥值，浅红色区间表示 68%的预测值</li></ul><p id="53dd" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">例如，如果数学成绩是 10，我们可以说葡萄牙语成绩的 38%的预测位于 10.5 到 12.8 之间。</p><p id="af6f" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">通过创建贝叶斯线性回归模型，我们能够在给定𝑥.值的情况下创建大多数预测所在的区间很酷，不是吗？</p><h1 id="0d1e" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="3a57" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">恭喜你！您刚刚学习了如何使用 Bambi 获得线性回归模型的系数分布，这使您能够获得可能预测的分布。</p><p id="b1b7" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">有一个分布将会给预测带来更多的洞察力。既然使用 Bambi 创建贝叶斯线性回归模型很容易，为什么不试一试呢？</p><p id="4f0a" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">本文的源代码可以在这里找到:</p><div class="ns nt gp gr nu nv"><a href="https://github.com/khuyentran1401/Data-science/blob/master/statistics/bayes_linear_regression/linear_regression.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">数据科学/linear _ regression . ipynb at master khuyentran 1401/数据科学</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">收集有用的数据科学主题以及代码和文章-Data-science/linear _ regression . ipynb at master…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="pi l og oh oi oe oj mc nv"/></div></div></a></div></div><div class="ab cl pj pk hx pl" role="separator"><span class="pm bw bk pn po pp"/><span class="pm bw bk pn po pp"/><span class="pm bw bk pn po"/></div><div class="im in io ip iq"><p id="38a0" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的算法和数据科学工具。你可以通过<a class="ae mz" href="https://www.linkedin.com/in/khuyen-tran-1ab926151/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae mz" href="https://twitter.com/KhuyenTran16" rel="noopener ugc nofollow" target="_blank"> Twitter </a>与我联系。</p><p id="97b6" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在 Medium 上关注我，了解我的最新数据科学文章，例如:</p><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/bayes-theorem-clearly-explained-with-visualization-5083ea5e9b14"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">贝叶斯定理，用可视化清晰地解释</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">如果您的 COVID 检测呈阳性，那么您实际上患有 COVID 的几率有多大？</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="pq l og oh oi oe oj mc nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/how-to-find-best-locations-for-your-restaurants-with-python-b2fadc91c4dd"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">如何使用 Python 找到餐馆的最佳位置</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">用 CVXPY 解决集合覆盖问题</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="pr l og oh oi oe oj mc nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/observe-the-friend-paradox-in-facebook-data-using-python-314c23fd49e4"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">使用 Python 观察脸书数据中的朋友悖论</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">平均来说，你的朋友比你的朋友多吗？</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="ps l og oh oi oe oj mc nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/introduction-to-yellowbrick-a-python-library-to-explain-the-prediction-of-your-machine-learning-d63ecee10ecc"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">Yellowbrick 简介:可视化机器学习预测的 Python 库…</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">您将 f1 分数提高到了 98%！但这是否意味着你的模型表现更好呢？</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="pt l og oh oi oe oj mc nv"/></div></div></a></div><h1 id="de11" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">参考</h1><p id="d9de" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">科尔森，W. (2018 年 4 月 20 日)。<em class="nf">贝叶斯线性回归简介</em>。中等。检索于 2021 年 12 月 29 日，来自<a class="ae mz" rel="noopener" target="_blank" href="/introduction-to-bayesian-linear-regression-e66e60791ea7">https://towards data science . com/introduction-to-Bayesian-linear-regression-e66e 60791 ea 7</a></p></div></div>    
</body>
</html>