<html>
<head>
<title>Coding Deep Learning with PyTorch — Image Recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 PyTorch 编码深度学习—图像识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implementing-deep-learning-with-pytorch-image-recognition-d403d5da98ea?source=collection_archive---------15-----------------------#2021-12-21">https://towardsdatascience.com/implementing-deep-learning-with-pytorch-image-recognition-d403d5da98ea?source=collection_archive---------15-----------------------#2021-12-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6d53" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过编写一个能够识别手写数字图像的简单神经网络，开始深度学习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1dbdaf7d8d75bfd5e92a6593f50a24f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbzvY92vTasUvCqZvh1-1A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乔治——【stock.adobe.com】T2。作者购买的<a class="ae ky" href="https://stock.adobe.com/ie/license-terms#standardLicenses" rel="noopener ugc nofollow" target="_blank">标准许可</a>。</p></figure><p id="4206" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我使用<a class="ae ky" href="https://pytorch.org/get-started/locally/" rel="noopener ugc nofollow" target="_blank"> PyTorch 框架</a>解释了一个简单的神经网络实现。我遍历了代码的每一步，最后，你应该从实用的角度学习深度学习的基本概念。</p><p id="4ab7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">神经网络在数据集(MNIST)上训练，该数据集包括数千个手写数字的 28×28 像素图像。每张图片都有各自的标签——是 1 吗？一个 7？等等。</p><p id="b5a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章分为，</p><ul class=""><li id="f568" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">先决条件和库</li><li id="2257" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">加载和转换数据</li><li id="49c3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">定义和初始化神经网络</li><li id="e6ef" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">培养</li><li id="953e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">验证培训</li><li id="f57f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">玩模型</li><li id="e81e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">全代码</strong></li><li id="b0f7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">最后的想法</li></ul><p id="cff5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们深入研究一下。</p><h1 id="fb52" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">先决条件和库</h1><p id="4b5e" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">首先必须安装 Python ( <a class="ae ky" href="https://medium.com/programming-for-beginners/python-for-beginners-install-and-run-your-first-code-50e51d6b8896" rel="noopener">指令</a>)、PyTorch ( <a class="ae ky" href="https://pytorch.org/get-started/locally/" rel="noopener ugc nofollow" target="_blank">指令</a>)和 torchvision 库(pip install torchvision)。总共需要八次导入。让我们逐一查看。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><ul class=""><li id="17e6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">火炬:</strong>py torch 的组件之一。这是一个<a class="ae ky" href="https://pypi.org/project/torch/" rel="noopener ugc nofollow" target="_blank">库</a>用来帮助<a class="ae ky" href="https://www.kdnuggets.com/2018/05/wtf-tensor.html" rel="noopener ugc nofollow" target="_blank">张量</a>工作。它类似于 NumPy，但它有强大的<a class="ae ky" href="https://www.intel.com/content/www/us/en/products/docs/processors/what-is-a-gpu.html" rel="noopener ugc nofollow" target="_blank"> GPU </a>支持。</li><li id="df6c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">火炬视觉:PyTorch 项目的计算机视觉库的一部分。您必须安装<a class="ae ky" href="https://pytorch.org/vision/stable/index.html" rel="noopener ugc nofollow" target="_blank"> torchvision </a>和 pip install torchvision。</li><li id="6a8b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> matplotlib.pyplot: </strong>一组用于以类似 MATLAB 的方式绘图的函数。</li><li id="1c92" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">PyTorch 模块有助于使用神经网络。</li><li id="c177" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> torch.nn.functional: </strong>它包含了处理神经网络时有用的函数。</li><li id="40f6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> torch.optim: </strong>各种优化算法的包。</li><li id="edc4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">转换:</strong>一个 torchvision 子包，用于帮助图像转换，比如转换为张量格式、裁剪、翻转等。</li><li id="b728" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">数据集:</strong>由图像和视频数据集组成的 torchvision 子包。</li></ul><h1 id="ce30" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">加载和转换数据</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="fdad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先要做的是将数据分成训练集和测试集。您可以通过设置 train=True/False 来实现这一点。</p><p id="252e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从用于训练的样本中定义测试集很重要。因为一种方法是只进行训练，然后在训练之后，使用部分训练数据进行验证。</p><p id="3167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是这样做有点像让开发人员也成为测试人员。测试肯定会有偏差。测试集必须包含机器以前没有遇到过的数据。</p><p id="d8a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">批量大小对应于一次传递给模型的数据量。使用批量的好处不多:</p><ul class=""><li id="0383" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">内存更少。在深度学习中，数据往往有数百万条记录。将所有内容一次性传递到模型可能不适合计算机内存。</li><li id="25e1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">权重更新更快。批处理越大，更新操作花费的时间就越长。</li></ul><p id="36eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Shuffle (shuffle=True)有助于数据的泛化。它增加了方差，因此减少了偏差和过度拟合。</p><p id="0b17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设数据按顺序有许多“1”值。假设机器将变得过于专业，只能识别 1。当另一个数字到来时，机器在识别特定类型的数据时过于“博学”(过度拟合)，发现自己陷入了困境。</p><h1 id="4b5c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">定义和初始化神经网络</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="e02d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们定义神经网络。它由四层组成。一个输入层、两个隐藏层和一个输出层。fc1 表示全连接网络 1，fc2 表示全连接网络 2，以此类推。</p><p id="5014" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类型是线性的，这意味着常规的神经网络。它不是递归的(RNN)，也不是卷积的(ConvNet)，而是一个简单的神经网络。</p><p id="b83c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于每一层，您必须定义输入和输出数。一层的输出数就是下一层的输入。</p><p id="9f5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入层有 784 个节点。784 是 28 乘以 28(图像像素)的结果。第一层定义为输出 86。因此，第一个隐藏层必须有 86 和输入值。同样的逻辑也适用于第二个隐藏层。</p><p id="6ca6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">86 是一个任意的数字。它可以是另一个值。</p><p id="eb0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出层包含 10 个节点，因为图像表示从 0 到 9 的数字。</p><p id="3587" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我声明数据经过的路径。每当数据通过一个层时，数据就被馈送给一个激活函数。</p><p id="797c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几个激活函数，本教程中使用的一个被称为<a class="ae ky" href="https://www.kaggle.com/dansbecker/rectified-linear-units-relu-in-deep-learning" rel="noopener ugc nofollow" target="_blank"> ReLU —整流激活函数</a>。如果值为负，函数返回 0，如果值为正，函数返回值。</p><p id="6315" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">激活函数是最后一层(输出)的 softmax。Softmax 将值规格化。最后，它给出了一个概率——例如，数字 1 的 80%，数字 5 的 30%，等等。选择最高的概率。</p><p id="e78d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更多关于激活功能<a class="ae ky" rel="noopener" target="_blank" href="/why-do-neural-networks-need-an-activation-function-3a5f6a5f00a">这里</a>。由<a class="ni nj ep" href="https://medium.com/u/56f7cdc8c678?source=post_page-----d403d5da98ea--------------------------------" rel="noopener" target="_blank">卢西亚诺·斯特里卡</a>分享的文章</p><h1 id="e40a" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">培养</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="bb18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是训练阶段。简而言之，优化器计算实际数据和预测数据之间的差异(损失)，调整权重，再次计算损失，并循环进行，直到损失最小。</p><p id="4c20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个历元相当于数据向前和向后传递一次。定义三个时期意味着数据将前进和后退三次。</p><p id="c451" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">zero_grad:由于数据是成批处理的，因此损失计算和累积是特定于正在处理的当前批的。目标是不要将损失从一批转移到另一批。</p><p id="35fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">optimizer.step 是更新权重的时间。</p><h1 id="f574" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">验证培训</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6add" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，它将基础事实与模型(模型=训练好的神经网络)做出的预测进行比较。在本教程中，它给出了很高的准确性，这意味着该模型非常善于识别每个数字。</p><p id="ec61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是现实世界的问题往往不是这样。高精度可能意味着过度拟合，应谨慎分析。</p><h1 id="aae2" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">玩模型</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="2a7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们通过显示某个数字的图像并将其传递给模型来测试它，看看它是否能正确识别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/89a72e3bdabfc8dac2bcb981724915b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*jRApINP7jJQyhH65qYYJqg.png"/></div></figure><p id="cdf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它确实认出了那是一个 9！</p><h1 id="c688" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">密码</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实现有很多资源作为参考，因为我也在学习深度学习。但是主要是来自<a class="ae ky" href="https://pythonprogramming.net/introduction-deep-learning-neural-network-pytorch/" rel="noopener ugc nofollow" target="_blank">pythonprogramming.net</a></p></figure><h1 id="1cbc" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">最后的想法</h1><p id="c144" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">浏览代码对我理解概念有很大帮助。我希望我在这篇教程中对你也有所帮助。我打算继续为其他神经网络类型撰写类似的帖子。</p><p id="76b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你觉得运行代码太慢，你可能想试试<a class="ae ky" rel="noopener" target="_blank" href="/4-reasons-why-you-should-use-google-colab-for-your-next-project-b0c4aaad39ed">谷歌合作实验室</a>(文章由<a class="ni nj ep" href="https://medium.com/u/ff47ab81282a?source=post_page-----d403d5da98ea--------------------------------" rel="noopener" target="_blank">Orhan g . Yal Zan</a>分享)，因为你可以使用<a class="ae ky" href="https://www.intel.com/content/www/us/en/products/docs/processors/what-is-a-gpu.html" rel="noopener ugc nofollow" target="_blank"> GPU </a>。Google Colab 允许你在浏览器中运行 Python 代码。这是谷歌云上的免费 Jupyter 笔记本。</p><p id="2dc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下次见。感谢阅读。</p></div></div>    
</body>
</html>