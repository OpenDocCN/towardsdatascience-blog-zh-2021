<html>
<head>
<title>Predicting the Next Best Fantasy Football Team using the Non-negative Matrix Factorization Machine Learning Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用非负矩阵分解机器学习算法预测下一个最佳梦幻足球队</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-the-next-best-fantasy-football-team-using-the-non-negative-matrix-factorization-machine-48bc5724931d?source=collection_archive---------17-----------------------#2021-11-23">https://towardsdatascience.com/predicting-the-next-best-fantasy-football-team-using-the-non-negative-matrix-factorization-machine-48bc5724931d?source=collection_archive---------17-----------------------#2021-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1305" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常隐藏在数字中的是未经训练的人看不到的模式和趋势。无论是在自然过程中还是在合成过程中，如果我们研究得足够深入，我们就可以在不收集新数据点的情况下发现新信息。这个博客是体育和机器学习系列的延续，这是第一个突出国家橄榄球联盟(NFL)的数据。</p><p id="3e93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">NFL在2021赛季有1696名球员，大约是国家篮球协会(NBA)510名球员的三倍。也有5倍左右的位置可以玩。</p><p id="9711" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我要带着这个去哪里？美式足球是一项复杂的运动。它也被广泛视为终极团队运动。许多不同角色的玩家执行一个任务:以比对手更多的分数结束一场比赛。传球者、阻挡者、踢球者、接球者、防守者和抢球者相互竞争，以显示彼此的优势。(如果你不熟悉美式足球，<a class="ae kl" href="https://en.wikipedia.org/wiki/American_football_positions" rel="noopener ugc nofollow" target="_blank">这个维基百科页面</a>有一个简短的定义列表——这里唯一重要的是四分卫和接球手)。</p><p id="d502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你猜对了，这样做会产生大量的数据。有数以千计的实验可以用来找出最佳的跑动阵型、最佳的进攻球员、最佳的踢球时间等等。这个博客将探索美式足球最基本的要素之一——完成传球。</p><p id="4572" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">橄榄球的规则将一次完整的传球定义为合格的接球手成功接住四分卫向前扔出的传球，而球没有触地。所以，我们想看看影响完整传球的因素之一:四分卫和接球手之间的“兼容性”。</p><p id="6fcd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">这个博客的实验是使用NFL的历史数据来确定哪些接球手会与给定的四分卫很好地配对。我们将使用非负矩阵分解(NMF)来探索这一点。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/a2e3aba14caa5b344d82077c3314ceb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Kxvh8k_SW9IdhVs0"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">照片由<a class="ae kl" href="https://unsplash.com/@cianleach?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">钱璐·利奇</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="6ae9" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">假设</h1><p id="d6d1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">为了透明和彻底，有许多因素可以决定<em class="mf">尝试</em>通过的结果。以下是一些例子:</p><ul class=""><li id="426c" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk ml mm mn mo bi translated">球在空中飞行的螺旋以及投掷的整体质量</li><li id="f33b" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">投掷的距离</li><li id="3712" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">接收器的运行速度</li><li id="c302" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">试图阻止接球的防守队员人数</li><li id="c54c" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">太阳的位置(遮挡接收者的视线)</li><li id="aded" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">天气(湿球更难接住)</li></ul><p id="2124" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中一些信息实际上是通过NFL的历史数据收集的。然而，这开启了一个麻烦的问题，我们可能有比<em class="mf">样本</em>更多的<em class="mf">特征</em>，从而使我们的机器学习模型受到<em class="mf">欠拟合</em>。如果我们在NFL中采用四分卫和接球手的任何组合，我们几乎肯定会<strong class="jp ir">而不是</strong>在每种可能的天气条件下找到完整的传球，对抗联盟中的每个防守队员，所有人都以不同的速度奔跑等等。正因为如此，我们必须做出一个重要的假设来继续这个实验:</p><p id="a889" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">假设:NFL已完成传球的历史数据在总传球码中“编码”了潜在信息(包括但不限于:天气、投掷质量、防守队员和距离)。</strong></p><p id="7157" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，这个假设得到了接球手和四分卫之间长期合作关系的支持。阿朵在一起玩的时间越长，他们经历的游戏场景就越多。这对我们来说是个好消息，因为我们实际上想了解四分卫和接球手之间的“兼容性”，并翻译任何一个接球手如何与另一个四分卫合作，反之亦然。</p><p id="76d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解决了这个问题，让我们简单谈谈我们将要关注的机器学习技术。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="2d5a" class="lc ld iq bd le lf nb lh li lj nc ll lm ln nd lp lq lr ne lt lu lv nf lx ly lz bi translated">非负矩阵分解(NMF)</h1><p id="4145" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">非负矩阵分解是一种无监督的机器学习技术。在这种情况下，无监督意味着我们没有预先存在的“分数”或我们的训练数据所属的“类”。因此，我们必须首先在训练数据集中自我发现任何自然出现的模式。开头是这样的:</p><ul class=""><li id="45d5" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk ml mm mn mo bi translated">给定我们的初始数据，我们执行任何特征提取和数据预处理，使我们的数据以二维表示。对于这个实验，我们有二维数据(一个矩阵),第一轴是NFL接收机，第二轴是NFL四分卫。实际数据点(四分卫和接球手的交叉点)是通过完成传球获得的总码数。我们称这个矩阵为<em class="mf"> X </em>。以下是这种情况的一个示例:</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ng"><img src="../Images/3dfacde635916ba802a0550b7d4a8a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHCoTy10buNmx4mq9HNHCQ.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">矩阵<em class="nh"> X </em>。沿着纵轴是NFL接收器，沿着横轴是NFL四分卫。包含的数据包括截至第11周的2021 NFL赛季的总接收码数。</p></figure><ul class=""><li id="a4a6" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk ml mm mn mo bi translated">我们的NMF算法是“秩k”的。这意味着我们手动选择一个值<em class="mf"> k </em>，它对应于我们想要发现的分组的数量。稍后我会详细说明这一点。</li><li id="fd73" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">矩阵(我们的初始数据)以类似于分解多项式方程的方式被分解。这产生了两个新的矩阵<em class="mf"> W </em>和<em class="mf"> H </em>，我们通过学习和分析来收集新的见解。</li></ul><p id="fe71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">概括一下:让接球手的数量用术语<em class="mf"> R </em>来表示，四分卫的数量用术语<em class="mf"> Q </em>来表示。我们给定的码数数据集由矩阵<em class="mf"> X </em>表示。也就是说:</p><p id="2bbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mf"> X </em>是一个大小为<em class="mf"> R </em> x <em class="mf"> Q </em>的矩阵。<em class="mf"> X </em>将被分解成矩阵<em class="mf"> W </em>和<em class="mf"> H </em>，其中<em class="mf"> W </em>是大小为<em class="mf"> R </em> x <em class="mf"> k </em>的矩阵，<em class="mf"> H </em>是大小为<em class="mf"> k </em> x <em class="mf"> Q </em>的矩阵。这很重要，因为在矩阵乘法中，两个矩阵之间的“中间”维度必须匹配，而生成的矩阵保持“外部”维度。因此:</p><p id="f456" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">给定X，我们学习<em class="mf"> W </em>和<em class="mf"> H </em>使得我们满足等式<em class="mf">X</em>≈<em class="mf">W</em>X<em class="mf">H .</em></strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ni"><img src="../Images/a5290bc93d78b27c26a5cec031261c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mgMPkGE1qJm16KjG"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ng"><img src="../Images/0482e7f7e31914c7cfa38b844e3bbd8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8PE4FDLUJZXZ4lZ9kHmuw.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">(从左至右)矩阵乘法为<strong class="bd nj"><em class="nh">X</em>≈<em class="nh">W</em>X<em class="nh">H</em></strong><em class="nh">展示了NMF期望的结果。</em></p></figure><p id="e61e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为此，我将使用<a class="ae kl" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn python包</a>中方便提供的NMF类。想了解更多关于NMF的信息，我推荐从这个博客开始，深入研究NMF的数学及其相关的训练算法。本实验中使用的NFL数据来自<a class="ae kl" href="https://github.com/cooperdff/nfl_data_py" rel="noopener ugc nofollow" target="_blank"> nfl_data_py </a> Python包。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="642b" class="lc ld iq bd le lf nb lh li lj nc ll lm ln nd lp lq lr ne lt lu lv nf lx ly lz bi translated">期望值和实验设置</h1><p id="1e49" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">这个实验的假设是，NMF算法可以在四分卫-接收器组合中找到模式，这样，我们就可以发现NFL中从未见过的新球员组合，这将成为一个伟大的双人组合。同样，NMF声明了秩k矩阵<em class="mf"> W </em>和<em class="mf"> H </em>，其中<em class="mf"> k </em>实际上是“习得的”组或类别的数量。</p><p id="85d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果这还不清楚，<em class="mf">主题建模</em>是NMF的另一个流行用例。当将NMF应用于新闻文章中的数据时，我们可以发现体育文章、商业文章或政治文章等主题。我们会选择k来代表我们想要学习的主题的数量。在NFL四分卫和接球手的背景下，我们将学习两个球员之间的比赛风格或一般兼容性。</p><p id="8b52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">矩阵<em class="mf"> W </em>和<em class="mf"> H </em>被随机初始化，并通过<a class="ae kl" href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization#Algorithms" rel="noopener ugc nofollow" target="_blank"> NMF算法</a>进行更新，使得<em class="mf"> W </em>和<em class="mf"> H </em>的矩阵乘法近似等于矩阵<em class="mf"> X </em>。结果，<em class="mf"> W </em>成为大小为<em class="mf"> R </em> x <em class="mf"> k </em>的矩阵，<em class="mf"> H </em>成为大小为<em class="mf"> k </em> x <em class="mf"> Q </em>的矩阵。</p><p id="45a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">翻译成英语，这意味着<em class="mf"> W </em>将会告诉我们一个接收者与我们所学的任何一个<em class="mf"> k </em>组有多接近。H会告诉我们每个组与某个四分卫的兼容性如何。例如，假设我们决定学习k=4组。让我们假设(在matrix <em class="mf"> W </em>中)接收者Rob Gronkowski、Tyreek Hill、DeAndre Hopkins和Davante Adams在第2组中得分很高(高意味着接近1)。当我们查看matrix <em class="mf"> H </em>时，我们可能会发现四分卫汤姆·布拉迪、帕特里克·马霍斯、凯勒·默里和亚伦·罗杰斯(在他们的职业生涯中，他们各自都是四分卫)在第二组也有很高的分数。这表明第二组四分卫和接球手的任何组合都应该很好地配合，即获得许多完成和传球码数。以下是矩阵<em class="mf"> W </em>和<em class="mf"> H </em>的示例:</p><div class="kn ko kp kq gt ab cb"><figure class="nk kr nl nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/64945482c5fa9b7d30f06a06aabc02d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*By6dehpcfHtCodH_Savn2g.png"/></div></figure><figure class="nk kr nl nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/815c7f39eb5b6e2bb8225c810104b9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*bfRMr9CW5k8GehOr9RYRuA.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk nq di nr ns translated">(左)矩阵W，其中每个接收者都有一个适合他们的分数。(右)矩阵H，其中每个四分卫都有一个分数，表示他们在给定团队中的表现。注意对于矩阵<em class="nh"> W </em>，行总和为一。对于矩阵<em class="nh"> H </em>，列总数为1。这种格式使得每个矩阵中的值可以被解释为良好匹配的概率。</p></figure></div><p id="231f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你决定查看代码(链接在本博客的末尾)，你会看到矩阵<em class="mf"> W </em>和<em class="mf"> H </em>在计算后被<em class="mf">规格化</em>，这意味着它们的值被按比例压缩到0和1之间。这只是让数字更容易解释；分数越接近零表示比赛越差，分数越接近一表示比赛越好。</p><h1 id="b375" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">超参数调谐</h1><p id="4a7c" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">为了从这个实验中找到最好的结果，我研究了与NMF相关的四个超参数。其中包括:</p><ol class=""><li id="c28d" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk nt mm mn mo bi translated">拟合前用于<em class="mf"> X </em>的数据量(即<em class="mf">学习</em> ) <em class="mf"> W </em>和<em class="mf"> H </em></li><li id="6678" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk nt mm mn mo bi translated"><em class="mf"> k </em> —学习到的分组数</li><li id="aa0c" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk nt mm mn mo bi translated"><em class="mf"> alpha </em> —用于学习<em class="mf"> W </em>和<em class="mf"> H </em>的正则化参数(正则化是一种可选技术，可用于对异常值如何影响算法进行更多控制)</li><li id="c138" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk nt mm mn mo bi translated"><em class="mf">公差</em>—NMF算法的停止条件。即近似值<em class="mf">X</em>≈<em class="mf">W</em>X<em class="mf">h</em>的接近程度。较低的容差意味着更多的训练迭代(在结果部分中有更多相关信息)。</li></ol><p id="5299" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我研究了一次hyper参数2到4，其中有少量数据用于<em class="mf"> X </em>(大约。两年的NFL数据)和大量的数据(大约。12年NFL数据)。我们先看少量数据。</p><p id="4a6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注:</strong>在以下情节中，使用了至少在<em class="mf">一次完成</em>中担任四分卫的所有球员，然而Y轴上的<em class="mf">平均QB分数</em>仅取自联盟中的32名首发四分卫——每队一名。</p><h2 id="e641" class="nu ld iq bd le nv nw dn li nx ny dp lm jy nz oa lq kc ob oc lu kg od oe ly of bi translated">调整<em class="nh"> k </em></h2><p id="63ae" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">组数<em class="mf"> k </em>在数值3和14之间变化。与较高的<em class="mf"> k </em>值相比，较低的<em class="mf"> k </em>值工作得非常好。这可能是早期假设的结果，即各种通过条件被编码在全部完成的通过码中。这种简化可以降低该NMF模型的最大复杂度，使得模型将在更高的<em class="mf"> k </em>值下填充。或者，有可能NFL中四分卫和接球手的组合更少，例如四分卫赢得了最有价值球员(MVP)奖，四分卫没有。应该注意的是，虽然曲线的形状基本相同，但k值较低时的峰值得分较高，使用的数据较少，左侧的图仅采用了最近两个NFL赛季的数据。</p><div class="kn ko kp kq gt ab cb"><figure class="nk kr og nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/bd8004314d224f04bef7c12e6f1a902b.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/0*TiifTa_6pQclGplS"/></div></figure><figure class="nk kr oh nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/976f9a01dfce32c955367f2c4d0abde8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/0*t_1l3wdlACOCSewH"/></div><p class="ky kz gj gh gi la lb bd b be z dk oi di oj ns translated">rank-k超参数的调整</p></figure></div><h2 id="deaf" class="nu ld iq bd le nv nw dn li nx ny dp lm jy nz oa lq kc ob oc lu kg od oe ly of bi translated">希腊字母的第一个字母</h2><p id="4686" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">当达到<em class="mf">平均QB分数</em>时，alpha或正则化参数显示了两年NFL数据的振荡行为。阿尔法值在0到1之间扫描，分数峰值在阿尔法=0.4、阿尔法=0.7和阿尔法=0.9附近。然而，对于12年的NFL数据，行为具有更细粒度的振荡，得分从alpha=0.25到alpha=0.4达到最小值，而在alpha=0.5达到峰值。这种差异可能是因为使用的数据越多，发现的异常值就越多，因此正则化的效果就越显著。这将产生一个更紧密的拟合曲线，如下图所示。</p><div class="kn ko kp kq gt ab cb"><figure class="nk kr nl nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/26ba8a3eb5daf17c7ecd029ec2868380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*sEDOGK6uazNf4ft7"/></div></figure><figure class="nk kr nl nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/b35aeec492e6c5d165416512358f0adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*9XVKzE8gbkkq8hWK"/></div><p class="ky kz gj gh gi la lb bd b be z dk nq di nr ns translated">阿尔法正则化超参数的调整</p></figure></div><h2 id="03e3" class="nu ld iq bd le nv nw dn li nx ny dp lm jy nz oa lq kc ob oc lu kg od oe ly of bi translated">容忍</h2><p id="b4ac" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">最后公差被扫到了0.001到0.01之间。下面我们看到短期和长期数据的阶梯状曲线。尽管形状有些相似，但请注意，短期NFL数据的峰值<em class="mf">平均QB得分</em>仍然更高(略低于0.3)，就像其他超级参数一样。峰值<em class="mf">平均QB分数</em>的位置也出现在不同的位置，对于长期数据出现在较早的位置，对于短期数据出现在中间位置。</p><p id="24ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">较低的容差值意味着算法要经历更多的训练迭代。这些图表告诉我们，在NMF算法的更多次迭代之后，长期数据(也有更多的T4信息)具有最高的精确度。短期数据(具有少于<em class="mf">的</em>信息)以较少的迭代次数达到最高精度。这将是有意义的，因为信息更丰富的矩阵<em class="mf"> X </em>应该花费<strong class="jp ir">更多的</strong>次迭代来学习适当的矩阵<em class="mf"> W </em>和<em class="mf"> H </em>。用短期数据学习<em class="mf"> X </em>的迭代次数少，所以不用把容忍度设得太低。事实上，将它设置得太低会略微降低平均QB分数<em class="mf">,如下图左侧所示。</em></p><div class="kn ko kp kq gt ab cb"><figure class="nk kr nl nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/77deec54313a457d3dbd056440e1cf71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*VWQoGdoT1fARXXXV"/></div></figure><figure class="nk kr nl nm nn no np paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/d3626269b34a07a97a53170db4fb9bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*AuTICS3GAyClUtTl"/></div><p class="ky kz gj gh gi la lb bd b be z dk nq di nr ns translated">公差超参数的调整</p></figure></div><h2 id="f5a2" class="nu ld iq bd le nv nw dn li nx ny dp lm jy nz oa lq kc ob oc lu kg od oe ly of bi translated">概述</h2><p id="d337" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">让我们回顾一下我们在这里学到的内容。我们已经观察到，在我们最初的<em class="mf"> X </em>矩阵中使用更多的长期数据通常会将四分卫和接收机之间的最大兼容性得分降低约25%。我对此的理论是，旧数据使模型偏向于历史上更成功和更长寿的球员(如汤姆·布拉迪、亚伦·罗杰斯、拉塞尔·威尔逊)。我们还发现，<em class="mf"> k </em>的较低值显著增加了<em class="mf">平均QB分数</em>，而与输入数据大小无关。然而，与<em class="mf"> k </em>不同的是，正则化参数α和容差都受输入数据量的影响，其峰值<em class="mf">平均QB得分</em>的位置也不同。</p><h1 id="cdee" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结果</h1><p id="78c6" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">随着超参数的调整，让我们来看看一些四分卫-接收器组合，使用以下标准来最大化我们的准确性指标— <em class="mf">平均QB得分:</em></p><ol class=""><li id="ba16" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk nt mm mn mo bi translated">仅2020和2021赛季的NFL短期数据</li><li id="7a52" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk nt mm mn mo bi translated"><em class="mf">k</em>:3</li><li id="aac5" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk nt mm mn mo bi translated">阿尔法=0.9</li><li id="0098" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk nt mm mn mo bi translated">公差=0.005</li></ol><p id="cb71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注:</strong>下面列出的只是每个NFL球队的首发四分卫。这些接收器是其组中兼容性得分最高的前10个接收器。</p><pre class="kn ko kp kq gt ok ol om on aw oo bi"><span id="98c0" class="nu ld iq ol b gy op oq l or os">GROUP 1 out of 3 k-rank group(s)</span><span id="7db8" class="nu ld iq ol b gy ot oq l or os">average quarterback score: 0.13548700559442842</span><span id="1b13" class="nu ld iq ol b gy ot oq l or os">Quarterbacks: [‘J.Burrow’, ‘C.McCoy’, ‘T.Brady’, ‘M.Rudolph’, ‘J.Hurts’]</span><span id="5390" class="nu ld iq ol b gy ot oq l or os">Receivers: [‘L.McCoy’, ‘R.Gronkowski’, ‘A.Brown’, ‘C.Brate’, ‘M.Evans’, ‘J.Mickens’, ‘C.Grayson’, ‘L.Fournette’, ‘O.Howard’, ‘C.Godwin’]</span><span id="4818" class="nu ld iq ol b gy ot oq l or os">— — — — — — — — — — — — — — — — — — -</span><span id="567e" class="nu ld iq ol b gy ot oq l or os">GROUP 2 out of 3 k-rank group(s)</span><span id="e185" class="nu ld iq ol b gy ot oq l or os">average quarterback score: 0.2006553965063584</span><span id="17fa" class="nu ld iq ol b gy ot oq l or os">Quarterbacks: [‘J.Garoppolo’, ‘P.Walker’, ‘L.Jackson’, ‘P.Mahomes’, ‘T.Bridgewater’, ‘D.Carr’, ‘D.Prescott’]</span><span id="6b13" class="nu ld iq ol b gy ot oq l or os">Receivers: [‘A.Sherman’, ‘J.Gordon’, ‘T.Kelce’, ‘E.Fisher’, ‘B.Bell’, ‘D.Robinson’, ‘T.Hill’, ‘G.Dieter’, ‘M.Kemp’, ‘N.Keizer’]</span><span id="8c89" class="nu ld iq ol b gy ot oq l or os">— — — — — — — — — — — — — — — — — — -</span><span id="0ac7" class="nu ld iq ol b gy ot oq l or os">GROUP 3 out of 3 k-rank group(s)</span><span id="181a" class="nu ld iq ol b gy ot oq l or os">average quarterback score: 0.5274625854006478</span><span id="6595" class="nu ld iq ol b gy ot oq l or os">Quarterbacks: [‘J.Herbert’, ‘T.Siemian’, ‘M.Jones’, ‘J.Brissett’, ‘B.Mayfield’, ‘Jos.Allen’, ‘Ty.Taylor’, ‘M.Ryan’, ‘C.Wentz’, ‘J.Fields’, ‘J.Goff’, ‘R.Tannehill’, ‘Aa.Rodgers’, ‘M.Stafford’, ‘M.White’, ‘T.Heinicke’, ‘R.Wilson’, ‘K.Cousins’, ‘T.Lawrence’]</span><span id="002e" class="nu ld iq ol b gy ot oq l or os">Receivers: [‘C.Beasley’, ‘J.Brown’, ‘S.Diggs’, ‘J.Kumerow’, ‘T.Yeldon’, ‘I.McKenzie’, ‘S.Neal’, ‘E.Turner’, ‘J.Allen’, ‘D.Singletary’]</span></pre><p id="9cf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以看到，第3组的平均分高于第1组或第2组，这表明第3组的化学反应更强，而第1组和第2组的化学反应不太自信。1.0分意味着近乎完美的匹配。不出所料，这往往会在k接近32时发生，在这种情况下，该算法几乎完美地学习了基于四分卫和接球手组合的32支NFL球队。此外，如果你查找2021-2022赛季中期的一些球员，你会注意到有许多组合，其中一个组的四分卫和接球手在同一支球队。这是意料之中的，因为联盟中先前存在的双人组已经经受住了时间的考验。换句话说，他们可以“互相担保”。除此之外，试着在你的梦幻足球队中交换队员，看看他们表现如何！</p><h1 id="b3e3" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="99ee" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我希望你能从这个博客中学到一些新的东西，也希望你能从这个博客中学到一些有用的东西。在这里，我们讨论了非负矩阵分解，以及如何将它应用于NFL的历史数据，这样我们就可以学习四分卫和接收器的组合，这些组合可能一起表现很好。</p><p id="c487" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想查看这个实验的源代码，可以查看这个github库:<a class="ae kl" href="https://github.com/ChristopheBrown/nfl-ml" rel="noopener ugc nofollow" target="_blank">https://github.com/ChristopheBrown/nfl-ml</a></p></div></div>    
</body>
</html>