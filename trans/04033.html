<html>
<head>
<title>Feature Engineering Examples: Binning Numerical Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特征工程示例:宁滨数字特征</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/feature-engineering-examples-binning-numerical-features-7627149093d?source=collection_archive---------13-----------------------#2021-04-05">https://towardsdatascience.com/feature-engineering-examples-binning-numerical-features-7627149093d?source=collection_archive---------13-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bae2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用NumPy或Pandas快速绑定数字特征</h2></div><p id="2aed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/what-is-feature-engineering-bfd25b2b26b2">特征工程</a>专注于使用数据集中已经存在的变量来创建额外的特征，这些特征能够(<em class="lc">希望</em>)更好地表示数据的底层结构。</p><p id="bb99" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，你的模型性能可能受益于<strong class="kh ir">宁滨数字特征</strong>。这实质上意味着将连续或其他数字特征分成不同的组。通过应用领域知识，您可以设计类别和功能，更好地强调数据中的重要趋势。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/be873f1000a52cda5d19d0e2a4b4f05e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*l-c-U6x2MATxgXIbvzKE9A.jpeg"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@paperbeard?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">纸胡子</a>在<a class="ae lb" href="https://unsplash.com/s/photos/tree-rings?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="c029" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本帖中，我们将通过使用NumPy和Pandas的具体示例，介绍宁滨数字特征的三种不同方法。我们将从一个<a class="ae lb" href="https://github.com/zero731/NC_Elections_Capstone/blob/main/blog_data/UC_gen_2020.gz" rel="noopener ugc nofollow" target="_blank">数据集</a>中设计特征，其中包含关于选民人口统计和参与的信息。我选择了两个数值变量:</p><ol class=""><li id="58fb" class="lp lq iq kh b ki kj kl km ko lr ks ls kw lt la lu lv lw lx bi translated">选举年结束时登记选民的年龄</li><li id="7e66" class="lp lq iq kh b ki mc kl md ko me ks mf kw mg la lu lv lw lx bi translated"><code class="fe ly lz ma mb b">birth_year</code>:登记选民出生的年份</li></ol><p id="704c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想开始将这些方法应用到您自己的项目中，您只需要确保您已经安装了NumPy和Pandas，然后导入它们。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h1 id="c081" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">使用np.where()表示阈值</h1><p id="0bd9" class="pw-post-body-paragraph kf kg iq kh b ki nb jr kk kl nc ju kn ko nd kq kr ks ne ku kv kw nf ky kz la ij bi translated">想想可能有点奇怪，但是指示每个实例(在本例中是每个注册投票者)是否达到某个阈值是一种宁滨。</p><p id="c64f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，假设我们试图预测每个注册选民是否在选举中投票。也许我们怀疑，如果这是年轻选民第一次有资格在总统选举中投票，他们更有可能参加投票。由于法定投票年龄为18岁，任何在本届总统选举期间不满22岁的人都不能在上届总统选举中投票。</p><p id="8795" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<code class="fe ly lz ma mb b">np.where()</code>为这个阈值创建一个指示变量，它有3个参数:</p><ol class=""><li id="1d75" class="lp lq iq kh b ki kj kl km ko lr ks ls kw lt la lu lv lw lx bi translated">一种状况</li><li id="77f7" class="lp lq iq kh b ki mc kl md ko me ks mf kw mg la lu lv lw lx bi translated">如果满足条件，返回什么</li><li id="fa5b" class="lp lq iq kh b ki mc kl md ko me ks mf kw mg la lu lv lw lx bi translated">如果不满足条件，返回什么</li></ol><p id="ae10" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下代码根据个人的年龄创建了一个新特性<code class="fe ly lz ma mb b">first_pres_elec</code>:</p><pre class="le lf lg lh gt ng mb nh ni aw nj bi"><span id="59d6" class="nk mk iq mb b gy nl nm l nn no">df['first_pres_elec'] = np.where(df['age']&lt;22, 1, 0)</span></pre><p id="0e27" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们检查的条件是个人是否小于22岁。如果他们低于这个阈值，<code class="fe ly lz ma mb b">np.where()</code>返回1，因为这是他们有资格投票的第一次总统选举。如果不是，则返回0。从我们的连续变量<code class="fe ly lz ma mb b">age</code>中，我们创建了一个新的二元分类变量。</p><p id="2446" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也许我们也有理由怀疑老年人或多或少会去投票。如果是这样的话，我们可能希望通过创建另一个阈值指示器来将我们的模型的注意力吸引到这个阈值上:</p><pre class="le lf lg lh gt ng mb nh ni aw nj bi"><span id="9688" class="nk mk iq mb b gy nl nm l nn no">df['senior'] = np.where(df['age']&gt;=65, 1, 0)</span></pre><p id="d2a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们已经创建了两个阈值指标来划分选民年龄的分布，如下所示。新近有资格在总统选举中投票的年轻人用红色突出显示，老年人用黄色突出显示。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi np"><img src="../Images/a85917563032147601c177a4f2c556ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*d4cISbVhYBUZHCzL7G4vPw.png"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">突出显示年轻和年长阈值的登记选民年龄分布-图片由作者提供</p></figure><h1 id="b3ee" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">使用apply()应用自定义函数</h1><p id="82f8" class="pw-post-body-paragraph kf kg iq kh b ki nb jr kk kl nc ju kn ko nd kq kr ks ne ku kv kw nf ky kz la ij bi translated">根据出生年份将我们的注册选民分成几代可能是有意义的，因为这似乎常常与一个人的政治密切相关。一种方法是编写我们自己的自定义函数来描述每一代的临界值。</p><p id="db99" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是我们编写这样一个自定义函数的一种方法:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="e7b8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后使用Pandas` <code class="fe ly lz ma mb b">apply()</code>创建一个基于原始<code class="fe ly lz ma mb b">birth_year</code>变量的新特性:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="ffd8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们的注册选民被分成5个独立而有意义的类别。我决定将最老的两代人(最伟大的一代和沉默的一代)结合起来，这样就不会产生两个罕见的类别，每个类别只占人口的很小一部分。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7345f2dc256acb67e9cded980549193d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*TCTf_EBbnS2PHmn-MHX57w.png"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">Seaborn countplot按代显示选民分布-按作者显示图像</p></figure><h1 id="c451" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">使用pd.cut()定义箱</h1><p id="a774" class="pw-post-body-paragraph kf kg iq kh b ki nb jr kk kl nc ju kn ko nd kq kr ks ne ku kv kw nf ky kz la ij bi translated">我们也可以使用<code class="fe ly lz ma mb b">pd.cut()</code>来创建相同的生成库，而不是编写我们自己的函数并应用它。我们仍然需要为每个组定义适当的标签，以及bin边缘(截止出生年份)。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="cdf3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在最后一行中，我们通过向<code class="fe ly lz ma mb b">pd.cut()</code>提供我们想要分类的列、我们想要的分类以及如何标记每个分类来创建我们的新特性。</p><p id="947c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以快速创建一个范围，并将其作为我们的bin边缘，而不是按代分组。例如，如果我们认为按十年对年龄进行分组是有意义的，我们可以通过以下方法来实现:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="71de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一行定义了一个范围，从10开始，一直到110，但不包括110，每步增加10。第二行使用该范围作为绑定边缘，按年龄将注册选民离散化为以下组:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/efa6e07e9d996f6b6a2b90c0c2f26ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*JGpowOipvY6BXg77U4r5Sg.png"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">几十年来根据年龄划分的原始计数和注册选民百分比——图片由作者提供</p></figure><p id="bbdc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一行显示33，349或19.84%的选民年龄在40岁左右。括号表示40岁包括在内，而方括号表示50岁不包括在内。为了更容易地跟踪每个bin的含义，我们可以向<code class="fe ly lz ma mb b">pd.cut()</code>输入以下标签:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mh mi l"/></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/be080d77f8a264417a8f2de8c359a635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*gvDYBHCCIQdViSF_eESTMA.png"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">Seaborn countplot显示了几十年来按年龄划分的选民分布情况-图片由作者提供</p></figure></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><h1 id="d232" class="mj mk iq bd ml mm oa mo mp mq ob ms mt jw oc jx mv jz od ka mx kc oe kd mz na bi translated">概括一下</h1><p id="a57b" class="pw-post-body-paragraph kf kg iq kh b ki nb jr kk kl nc ju kn ko nd kq kr ks ne ku kv kw nf ky kz la ij bi translated">我们涵盖了:</p><ul class=""><li id="5879" class="lp lq iq kh b ki kj kl km ko lr ks ls kw lt la of lv lw lx bi translated">对数字特征进行分类意味着什么</li><li id="6377" class="lp lq iq kh b ki mc kl md ko me ks mf kw mg la of lv lw lx bi translated">1创建阈值指示器的方法(<code class="fe ly lz ma mb b">np.where()</code>)</li><li id="8615" class="lp lq iq kh b ki mc kl md ko me ks mf kw mg la of lv lw lx bi translated">将宁滨数字特征分组的2种方法(用熊猫<code class="fe ly lz ma mb b">apply()</code>自定义函数，用<code class="fe ly lz ma mb b">pd.cut()</code>定义bin边缘)</li></ul><p id="8c5b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你能发现这些信息，并能把你学到的东西应用到你自己的工作中。感谢阅读！</p></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><p id="1766" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于特征工程的更多信息:</p><p id="25c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/what-is-feature-engineering-bfd25b2b26b2">什么是特征工程？</a></p><p id="43c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/feature-engineering-examples-binning-categorical-features-9f8d582455da">特征工程示例:宁滨分类特征</a></p></div></div>    
</body>
</html>