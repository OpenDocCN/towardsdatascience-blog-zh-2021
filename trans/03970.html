<html>
<head>
<title>Multiple Linear Regression Python 101</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元线性回归Python 101</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/multiple-linear-regression-python-101-af459110a8af?source=collection_archive---------3-----------------------#2021-04-03">https://towardsdatascience.com/multiple-linear-regression-python-101-af459110a8af?source=collection_archive---------3-----------------------#2021-04-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b0b4" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="f9c1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">数据准备和预测建模分步指南</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/66545d0b455a953349960f3deaebc6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYkij9OZoR8ZNaOcceoxRQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://stock.adobe.com/images/data-scientist-big-data-artificial-intelligence-machine-learning-technology-concept-silhouette-glasses-in-front-of-laptop-computer-screen-with-programming-coded/183306935?prev_url=detail" rel="noopener ugc nofollow" target="_blank">来源:Adobe股票许可</a></p></figure><p id="6226" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">开始使用Python构建您的第一个多元线性回归预测模型可能会令人生畏！这篇文章提供了一个基于CRISP-DM的实用工作流程、指南和示例代码。希望你会觉得有用，欢迎评论。</p><h1 id="0739" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">线性回归的概念性工作流程</h1><p id="dfce" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">数据挖掘的<a class="ae lh" href="https://www.datascience-pm.com/crisp-dm-2/" rel="noopener ugc nofollow" target="_blank">跨行业标准流程</a>是描述数据科学生命周期的领先流程模型。这个项目在建立线性回归模型时遵循以下战术工作流程。该流程图对CRISP-DM流程的四个子任务进行排序，涵盖数据理解、数据准备、建模和评估。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/ba4f237d95bf43b4dfdd15da17627eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*51xHEHLvhEVcCr8Zt1QBtw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:作者</p></figure><p id="5251" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">流程中固有的简单想法包括:</p><ul class=""><li id="6bef" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">在太多的概要分析和分析之前拆分您的数据</li><li id="9403" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">为每个特性迭代一组通用的数据准备任务</li><li id="9996" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">遍历包含不同特性的各种模型</li><li id="86a0" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">使用函数在整个项目中保持数据转换的一致性和代码效率</li></ul><p id="eea6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在让我们开始，一步一步地完成一个项目。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="2177" class="me mf it bd mg mh nx mj mk ml ny mn mo ki nz kj mq kl oa km ms ko ob kp mu mv bi translated"><strong class="ak">数据准备工作流程</strong></h1><p id="3b8c" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">我使用的是华盛顿金县的房屋销售数据集，它在Kaggle和数据科学训练营上很受欢迎。数据<strong class="lk jd">包含21列，横跨&gt;20000个在2014–2015</strong>之间跨越12个月完成的西雅图大都会房屋销售交易。多元线性回归模型将使用普通最小二乘法(OLS)并预测连续变量“房屋销售价格”。</p><p id="16cc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据、Jupyter笔记本和Python代码可在<a class="ae lh" href="https://github.com/cutterback/p02-home-sales-predictive-project" rel="noopener ugc nofollow" target="_blank"> my GitHub </a>获得。</p><h2 id="af09" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated"><strong class="ak">步骤1 —数据准备基础知识</strong></h2><p id="76b9" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">为了开始了解我们的数据，该流程包括以下基本任务:</p><ul class=""><li id="c50f" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">加载数据</li><li id="e0ac" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">组合和集成数据</li><li id="6c3e" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">转换数据类型</li><li id="69fc" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">修复数据质量问题</li><li id="c3d0" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">删除重复项</li><li id="52ee" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">使数据干净、格式化和可用的步骤</li></ul><p id="e35a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了方便访问，我将我所有的库导入捆绑在一个地方。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="a13a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下一步是加载我们的。csv数据转换成熊猫数据帧，并采取窥视。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/77cb0847692e8b91b4e9621559082d2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T45IJD22JA2rQApAAtQqLg.png"/></div></div></figure><p id="6716" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该文件包含住宅列表标准属性；我的笔记本里有一本数据字典。</p><p id="123b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">乍一看，注意浴室中的小数值和yr _ renovated和滨水区中的“nan”null。下面使用DataFrame.info()，我们注意到需要解决的数据类型和null问题。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/1d20a65a83b9eebc5a94b2f4ff8a58df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6h6ged913qhfXkeBQ1bNMw.png"/></div></div></figure><p id="d93b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，基于这一点和这里没有显示的几个Series.value_counts()，我们可以进行调整以清理我们的房屋销售数据。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="fcd8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在让我们使用Dataframe.describe()来看看基本的统计数据和范围。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/82f8d86f9f957e05e47f67690a66263b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xt4VgnWdNNaVR-eteyyY6Q.png"/></div></div></figure><p id="fca6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">回顾上表可以看出:</p><ul class=""><li id="b370" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">价格:偏正，平均值高于中值。异常值为770万美元</li><li id="a971" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">卧室:异常值在33</li><li id="7d36" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">Sqft_Lot:在1.6M处有明显的异常值，平均值接近中值的两倍。</li><li id="08ed" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">海滨:人口稀少，很少有1。</li><li id="38ef" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">yr _ revealed:75%的小部分房屋为0。</li></ul><p id="e491" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">经过一番考虑，我放弃了33间卧室的单个记录。除了这个记录，只有少数家庭有8或9间卧室，所以我只是把这个作为一个可能的数据输入错误。即使在几个属性上有其他异常值，我也没有过滤或删除任何其他记录。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="2ac3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">处理重复数据、合并其他数据或任何其他常规数据准备任务都可以包含在此数据准备基础流程中。现在，数据是一致的，并且准备好被分割用于数据剖析、相关性分析和特征工程。</p><h2 id="8e42" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated"><strong class="ak">步骤2——将数据分成训练集和测试集</strong></h2><p id="69ca" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">对于将在<em class="os">新数据上使用的预测模型来预测生产</em>，在分析和分析之前拆分数据有助于防止数据泄漏。</p><blockquote class="ot ou ov"><p id="9a25" class="li lj os lk b ll lm kd ln lo lp kg lq ow ls lt lu ox lw lx ly oy ma mb mc md im bi translated"><a class="ae lh" href="https://machinelearningmastery.com/data-leakage-machine-learning/" rel="noopener ugc nofollow" target="_blank">数据泄露</a>:当你用来训练机器学习算法的数据恰好拥有你试图预测的信息。</p></blockquote><p id="f82b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">鉴于这一分析是一次性的历史工作，我在做了相关分析后将数据分开。这意味着我使用整个样本开发特性。然而，我在第2步展示了分离逻辑，以与上面的最佳实践图保持一致。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="8f87" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的Python代码片段创建了X(预测值)和y(目标值)数据集。作为目标因变量，我包括价格，价格的对数和价格的box-cox变换。这三个目标选项是在模型开发过程中反复开发的。</p><h2 id="b125" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated">步骤3 —数据分析和转换</h2><p id="486d" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">剖析和可视化探索数据有助于评估潜在的特征和关系。虽然任何类型的探索都是公平的游戏，但我反复关注每个预测者X(例如卧室)的这些目标<em class="os">和目标y(例如价格日志)</em>。</p><ul class=""><li id="3427" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">检查一段时间内的变量趋势</li><li id="874a" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">确认线性关系(X-y)</li><li id="ecd9" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">调查异常值</li><li id="7523" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">评估变量分布、正态性和偏斜</li><li id="88e0" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">用一键编码转换变量类</li></ul><p id="f222" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">类别变量图</strong></p><p id="a228" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我创建了一个函数(称为distplots，在我的Jupyter笔记本中可用)来绘制任何X预测值，包括直方图、散点图、箱线图和前N个累积值。我假设我的模型中的一个变量是卧室，因为这通常是买卖房屋时的区分描述符。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/5eb48a6ebcef72fea7e55520e8ea22f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CcO_IHCfSAoIkWP_4k7Brw.png"/></div></div></figure><p id="540d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">回顾输出，有几个观察结果:</p><ul class=""><li id="09c4" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">剔除33间卧室的异常值后，只有0.3%的家庭拥有6间以上的卧室</li><li id="a0e5" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">中位数逻辑上落在3到4间卧室之间</li><li id="a8d3" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">箱线图显示了随着卧室数量的增加，中值价格在增加</li></ul><p id="887a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">…但最终卧室和价格之间的相关性很弱，只有0.32，没有影响我的模型性能，所以我没有考虑。</p><p id="989a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我还使用distplots函数来可视化其他变量。</p><p id="83d1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">平均居住面积趋势</strong></p><p id="e31b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你有基于时间的变量，分析趋势有助于看到方向或势头。例如，在过去的一个世纪里，家庭的平均居住面积增加了。由于一些老房子有更多的卧室，我绘制了第二个轴来查看每个卧室的居住面积。这里的代码是一个双轴条形图，带有使用Seaborn和Matplotlib库的趋势线。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pa"><img src="../Images/9b4364c3f3b7437f03346704dca7e94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tiCwEkqPWYokXBjshfw84g.png"/></div></div></figure><p id="4c36" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这张图表显示了20世纪70年代西雅图地区居住空间的“起飞”。对于自1970年以来建造的房屋，我们看到居住面积增加了32%，平均卧室增加了9%，每间卧室增加了21%。sqft_per_bedroom功能作为living_sqft的补充功能制作了最终模型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pb"><img src="../Images/e0f463d716ad8b975e1b9343f9b8a82e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RStZkkHXCuUSUfZ3iJZLKg.png"/></div></div></figure><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="5b67" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> Pairplot关联分析</strong></p><p id="6836" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另一种数据分析技术是直观地检查变量的交集以寻找关联。这里我使用了Seaborn的pairplot，它为每个组合创建了一个散点图，在对角线上留下了一个直方图。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/7d53b88b28dd5e8bc597291cb5b592bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Adf7tPHd2Ac-J3w9ru1KFg.png"/></div></div></figure><ul class=""><li id="f915" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">与价格成线性关系:等级、条件、浴室</li><li id="a610" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">价格不确定或非线性:建造年份、指标、卧室</li></ul><p id="9e7d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">一键编码</strong></p><p id="69d9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一种常见的方法是一键编码(OHE ),将分类变量转换为特征。我测试了几个OHE变量，如条件、等级、卧室和浴室，看看它们是否比连续变量表现得更好。我发现每一个都作为连续变量更好。</p><p id="99c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后我得到了两个OHE变量:zipcode和grade_grp(将住宅建筑群从3-13简化为4类)。我用了熊猫。get_dummies()方法将要素透视到OHE列，删除第一个类以最小化纯多重共线性风险。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pd"><img src="../Images/22ef60ee7387d3886509fb6d29c385af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0MbYm6tdfKFQTf2gizWyg.png"/></div></div></figure><h2 id="5a9c" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated">步骤4 —相关性分析</h2><p id="3568" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">下一步是查看与这些目标的相关性:</p><ul class=""><li id="46a0" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">验证哪些预测要素(X)与目标(y)相关</li><li id="ac88" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">检查多重共线性预测值之间的相关性</li></ul><p id="512d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">皮尔逊相关系数(r) —目标y </strong></p><p id="e382" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据预测值price_log (y)检查每个要素(X)的皮尔逊相关系数。相关性将提供对在线性回归模型中表现良好的特征的洞察。我使用这些结果以及相关矩阵热图作为包含哪些功能的指南。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/e15daf02de896fad81d85e27b4456478.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*GT1FrNHzMkv0PisAoBg6iA.png"/></div></figure><p id="63fc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这四个标有星号的特征具有中等或强相关性，并构成了最终的OLS模型。</p><ul class=""><li id="de3d" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">强相关性(0.6–0.8):sqft _ living，grade，sqft_above，zip_psf_median，sqft_living15</li><li id="adeb" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">中度相关(0.4–0.6):浴室，景观</li></ul><p id="90f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">检查多重共线性</strong></p><blockquote class="ot ou ov"><p id="1617" class="li lj os lk b ll lm kd ln lo lp kg lq ow ls lt lu ox lw lx ly oy ma mb mc md im bi translated">当自变量相关时，表明一个变量的变化与另一个变量的变化相关。相关性越强，改变一个变量而不改变另一个变量就越困难。—吉姆·弗罗斯特“回归分析”</p></blockquote><p id="6bb5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">查看预测值之间的相关性是避免选取具有可能导致模型无效的强多重共线性的要素的关键步骤。代码块创建变量对，并按照最高相关性对它们进行排序。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/beccb00a4a8e31faeb43b77413d68821.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*oNYA1iT6gVeIYyKtMf9IRw.png"/></div></figure><p id="ed46" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">突出显示两种不同的场景(上面标有星号):</p><ul class=""><li id="f001" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">sqft _ living with sqft_above 0.876 correlation-我尝试在我的模型#3中纳入sqft _ above，但由于多重共线性而放弃了这一点。</li><li id="4d91" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">Grade，Sqft_living的相关系数为0.76——即使高度相关，我也能够包含这两个特性，而不会出现重大问题。</li></ul><p id="c4e6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里的建议是高度重视使用皮尔逊或其他统计数据(如方差膨胀因子(VIF))的预测值相关性。</p><h2 id="839e" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated"><strong class="ak">第五步——设计新功能</strong></h2><p id="ee61" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">第一次通过数据集创建线性回归模型时，最初可能不需要任何新功能。但是在您的第一次模型迭代之后，潜在的转换包括:</p><ul class=""><li id="2685" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">添加一个混杂变量以减少模型偏差</li><li id="edd0" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">将要素转换为人均要素或表示为比率</li><li id="22e4" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">使用求逆、对数、平方根或box-cox对特征进行幂变换</li><li id="454b" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">添加多项式特征(例如X)以更好地拟合曲率</li><li id="9d12" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">添加一个交互项，梳理出两个预测值之间线性关系的变化</li></ul><p id="17d2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于金县房价销售预测，我研究了除多项式以外的所有上述方法。对于我的基线模型#1，让我们先看看简单的未转换数据是如何工作的。</p><ul class=""><li id="076a" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">目标变量:价格(未转换)</li><li id="2c60" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">预测变量(前6个相关性):sqft_living、sqft_above、sqft_living15、浴室、视图、等级(全部未转换)</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/c40d1dd1db4115a859991e45c15bfd68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m_Ou-lRCcsDO5fx1LGe7NQ.png"/></div></div></figure><p id="c542" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">呀！</p><p id="b34a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">虽然模型#1注册了0.577的调整后r平方值和显著的p值，但正如总体模型残差的QQ图所示，它具有巨大的偏斜和多重共线性。</p><p id="f509" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们显然需要观察预测值分布，并考虑其他特征。</p><p id="a1f1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">检查正常性并创建日志功能</strong></p><p id="3410" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">给定非正态残差和偏斜的价格分布，我创建了Python函数check_normality和create_log，它接受一个dataframe列，创建一个日志序列并显示双直方图进行比较。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="cd8d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用这些函数，我将King County价格序列转换为price_log。如下所示的对数序列更加标准化，偏斜度接近0，峰度略低于1。在转换之前，price的偏斜度超过4，峰度为35，有近200个观察值超过第4个标准差。作为一个指南，理想的正态性应该是偏斜接近0，峰度在0-6之间，3是理想的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/8d9b0a221023b3a65413d77c2bb854f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TVkifLfupANIjWxoCD2l_Q.png"/></div></div></figure><p id="b84b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">线性回归假设不要求因变量或自变量具有正态分布，只要求正态模型残差。我选定price_log作为模型迭代2号到8号的因变量，因为它提高了性能并消除了剩余曲线偏差。</p><p id="60c3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">创建指标特征—改造和地下室</strong></p><p id="3af1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在对数据进行分析并尝试将翻新年份作为一个特征之后，我决定包含分类指示器特征revenue _ ind和basement_ind，其中1表示“是”。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="e974" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">按邮编划分的每平方英尺价格中位数</strong></p><p id="f757" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将邮政编码纳入模型非常重要，因为不同地理区域的价格差异很大。在模型#6中，我首先使用70个邮政编码作为一次性编码的分类变量，但是由于残差非常差，所以放弃了这个模型。相反，我添加了一个特征“每平方英尺的中值价格”，我将它应用于zipcode的数据。该特征的box-cox变换版本最终是重要的，因此被包括在最终的模型#8中。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="c7bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">距离西雅图市中心几英里</strong></p><p id="4b1c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该功能使用每个家庭的纬度和经度来测量到西雅图中心的距离。该功能实际上是在上述邮政编码每平方英尺价格之前创建的，基于这样的想法，即城市人口中心附近的价格通常较高。最初，这一功能非常重要，但一旦与邮政编码每平方英尺的中位数价格一起纳入，它就失去了大部分影响力。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><h2 id="5225" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated"><strong class="ak">第6步——选择特征</strong></h2><p id="487a" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">数据准备的最后一步是选择在回归模型的下一次迭代中包含哪些要素。这个实验过程是由你完成的数据分析和先前的模型结果决定的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/2d65e94dbfdb9d737227af946cd34202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*o69uBbXsQ9ZdicC1vUCMNQ.png"/></div></figure><p id="698a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我的方法是制作一个仅包含所选特征的训练和测试数据的副本，这样我就有一组数据帧和模型结果专门用于每个模型迭代。</p><p id="fa2b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我在我的笔记本上保存了8个模型迭代，但是在特性、转换、缩放等方面至少运行了两倍多的实验。我认为我的四次迭代在统计上是有效的，而四次迭代由于性能、残差或多重共线性而被放弃。我停在了包含以下特征的8号模型上。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/0cb3fe5937dea3d2bf5d2b51ef154b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*46H1J7IlO_vJsumQy8VOQQ.png"/></div></div></figure></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="c30a" class="me mf it bd mg mh nx mj mk ml ny mn mo ki nz kj mq kl oa km ms ko ob kp mu mv bi translated"><strong class="ak">建模工作流</strong></h1><p id="e72d" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">选择特性决策是我们从数据准备到建模工作流的转换点。在这一部分，我将只关注最终的模型#8过程和结果。在下面的每个模型构建和模型预测部分，我都包含了相关的模型评估步骤。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/623c3950e7e2631672a876503af2ee89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P360oikd6dV8L0r66RZIvw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:作者</p></figure><h2 id="5c94" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated"><strong class="ak">步骤7——特征缩放</strong></h2><p id="c155" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在构建(拟合)线性回归模型之前，要素缩放步骤包括标准化(归一化)、居中或缩放要素所需的任何方法。您可能使用的常见sklearn函数包括StandardScaler、MinMaxScaler或RobustScaler。对于我的最终模型，我没有缩放任何功能。</p><h2 id="8672" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated"><strong class="ak">第8步——模型构建</strong></h2><p id="6bf6" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">函数calc_sm_ols接受X和y数据帧，并符合statsmodel普通最小二乘法(ols)回归模型。该函数打印模型摘要、均方根误差(RMSE)和平均绝对误差(MAE)，并将price_log转换回可解释的形式。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="0670" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们将模型8的特征与我们的训练数据相匹配，看看我们看起来如何。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/66bbd6c214e83fd007a5c362288f446b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h9ZtwcRkUetNTuk510e1fg.png"/></div></div></figure><p id="d6ed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">黄色框中的统计数据是关键的性能组件:</p><ul class=""><li id="6e74" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated"><strong class="lk jd">调整后的R平方:</strong> 0.745表示模型解释了74.5%的方差。这是我的模型中最好的，我对残差感到满意。</li><li id="5502" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">总体p值:</strong> 0.00表示我们可以拒绝零假设；在alpha为0.05的情况下，模型结果的p值非常显著。</li><li id="c3d1" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">赤池信息标准</strong> ( <strong class="lk jd"> AIC </strong> ): 3329是我认为统计有效的四个模型中最低的，表示最好。</li><li id="c251" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">特征p值:</strong>所有10个特征的p值都低于0.05，因此我们可以拒绝任何特征的结果是由于随机性的观点。</li><li id="ddfb" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">偏斜:</strong>模型在0.041处得分接近0，表明残差分布接近正态。</li><li id="9304" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">峰度:</strong>4.395分在0-6的理想范围内，接近正态分布峰度3。这表明残差分布尾部比正态分布稍重，但是可以接受。</li><li id="9f95" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd"> JB和Prob(JB): </strong>基于接近0的概率(JB)，这进一步支持了我们有回归误差的近正态分布。</li><li id="188f" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">条件编号:</strong> 629可能表示要素之间存在多重共线性，但不足以对OLS汇总发出警告。Statsmodel文档建议该值应低于20。</li><li id="7425" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">平均绝对误差(MAE): </strong> $107，812表示预测房价的平均误差。我把重点放在RMSE平均误差上，以减少对大的异常残差求平方的影响。请记住，房价从不到10万美元到超过700万美元不等。</li></ul><p id="40f7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，总的来说，整个模型结果看起来很可靠，不完美，但在给定的可用数据和我的时间分配下，这是我能想到的最好的结果。</p><p id="f1cd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">总体QQ图</strong></p><p id="86b1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们使用函数qqplot来直观地检查整体模型残差。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pk"><img src="../Images/16c08a179b758ceb0e7375862f64b6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-IPA25c9VoZXM2GwY4g8A.png"/></div></div></figure><p id="88ea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当查看QQ图时，完全标准化的残差将沿着红色对角线。我们的两条尾巴都掉了，尤其是每一端的最后一点。这些表示模型预测不正确的异常值，会生成较大的RMSE值。在未来的迭代中，我会努力改进这一点。</p><p id="fee1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">特征残差图</strong></p><p id="6828" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们还需要检查每个独立变量的残差分布，以确认每个变量都是<a class="ae lh" href="https://en.wikipedia.org/wiki/Homoscedasticity" rel="noopener ugc nofollow" target="_blank">同方差的</a>。如果我们在残差中看到模式而不是随机性，我们的假设可能不可信，我们可能高估了拟合优度。函数plot_residuals循环遍历每个要素以绘制残差。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="6dce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在10个特征中，9个看起来很棒，1个有趋势。让我们首先看一个例子，其中残差图在sqft_living_log特性上看起来很好。在右上方的框中，您可以看到残差的分布在0的上方和下方，几乎是随机的。这是我们希望看到的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pl"><img src="../Images/e353fa1e4dcee5affb38145c421bf778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hQT-_Jsvg72Jf13OOvyALQ.png"/></div></div></figure><p id="12c1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我们的zip_psf_median_box特征中，残差确实显示出轻微的下降趋势。这可能表明这个特性需要一些调整，或者我们有一个混杂变量，我们应该在未来的迭代中合并。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pm"><img src="../Images/a5f4751adb537fe40e76db43a82e7409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FYy5c71JJTyRZm7KSQfU9Q.png"/></div></div></figure><p id="5f1b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> K重交叉验证</strong></p><p id="5c5b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">熟悉模型的最后一步是使用sklearn.model_selection中的k-folds。我对我们的完整样本进行了5次分割，以确保原始数据集中的每个观察值都有机会反复出现在训练集和测试集中。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pn"><img src="../Images/015bef485d1a53b38160b1087d9a64c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrbZPe_7AYlKrIdyMpqqQg.png"/></div></div></figure><p id="c97e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用5 k倍的交叉验证导致平均MAE为0.2123，而我们的OLS模型总结为0.19907(在price_log上)。虽然6.6%的差异比我想要的略高，但我相信这个模型是合理的。</p><p id="49a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我既使用了训练测试分割(80/20 ),也将k倍应用于整个样本。</p><h2 id="1da2" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated">步骤9 —模型预测</h2><p id="e687" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">现在，在最后一段，让我们使用我们的X_test和y_test数据，这些数据还没有暴露给我们的模型。下面的函数“预测”接受测试和训练数据来应用模型。输出包括用于评价的RMSE和MAE比较摘要。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi po"><img src="../Images/7cfb800237cb7a3e8839801b405132ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4vM-e3ENrwoGHGnBBuimKQ.png"/></div></div></figure><p id="e63c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种比较看起来是可靠的，因为试验预测产生了108，268美元的平均寿命，与列车平均寿命相差不到1%。我们准备进入最后的选择环节。</p><h2 id="6fbf" class="oc mf it bd mg od oe dn mk of og dp mo lr oh oi mq lv oj ok ms lz ol om mu iz bi translated"><strong class="ak">步骤10 —型号比较&amp;选择</strong></h2><p id="a8bd" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">我开发的8个正式模型中只有4个被认为是有价值的。推荐的模型#8是迄今为止最好的，产生10.8万美元的MAE和0.745的调整R平方。与模型#2相比，模型#8代表了MAE中38K美元和调整后R平方中0.174美元的累积改善。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pp"><img src="../Images/bb82f96d0998d50ca4a5cee2b70b2037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B9Td6jTuA_cXG-jNTsdAcg.png"/></div></div></figure><p id="1fe4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">向企业描述这种多元线性回归模型的一个挑战是，我们有10个特征，并使用了几个对数转换。这使得可解释性变得困难。下面的可视化过滤了7个“平均”预测值，然后绘制了这个预测子集(244个测试观察值)以显示价格和居住平方英尺之间的关系。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pq"><img src="../Images/47fca7ecaccac269a892cf84cb9ce1d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2rUHrTnmfGiTWwBdZHtRng.png"/></div></div></figure><p id="32d8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">深入单个预测可以描述功能的相对影响。按照上面圈出的点来显示这个单独预测的组成。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pr"><img src="../Images/07e3008bd96104db49fea488aa02d7d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MYzOeU00owbG2hFs-yFjNQ.png"/></div></div></figure><p id="3b4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">给定对数性质和分类变量，特征的相对重要性将因每个家庭而异。但至少对于这个家，我们可以评估以下几点:</p><ul class=""><li id="bd08" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">他们的邮政编码中的模型常数、居住平方英尺和每平方英尺价格驱动了85%的预测价格。</li><li id="edb1" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">其他特征等级，每间卧室的面积，条件和距离西雅图市中心的英里数贡献了另外的15%。</li></ul><p id="b01c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个特别的住宅“雨天天堂”没有我们模型中的四个特征(根据这个住宅销售的数据，所有特征都是0)。</p><ul class=""><li id="8b7d" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">海滨:如果是真的，预计价格会增加18.9万美元以上</li><li id="a047" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">翻新:如果属实，预计价格将增加54，000美元</li><li id="edc9" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">地下室:如果是真的，将增加9K美元的预测价格</li><li id="d7c7" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">等级10(vs . 7):如果是真的，将会在预测价格上增加24万美元</li></ul><p id="ed48" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">希望这种分析能使模型更加真实，并告知相关的特性重要性和敏感性。</p><h1 id="e53b" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">最后的想法</h1><p id="955c" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">感谢你坚持看完这篇冗长的帖子！我想在一个地方布置一个端到端的多元线性回归工作流程。我推荐的型号8不错，但我对六位数的MAE感到失望。如果我有更多的时间，我会继续优化这些模型，首先从以下几个方面着手:</p><ul class=""><li id="2eb2" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">更深入地看看异常值，或者也许将豪华模型与核心模型分开。</li><li id="7495" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">使用纬度和经度来尝试隔离邻域，并在邻域级别生成相对于邮政编码的每平方英尺价格中值。</li><li id="c22d" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">更详细地看多项式和相互作用项。</li></ul><p id="5896" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">请留下你的评论或想法！</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><div class="ks kt ku kv gt ps"><a href="https://chuckutterback.medium.com/membership" rel="noopener follow" target="_blank"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd jd gy z fp px fr fs py fu fw jc bi translated">通过我的推荐链接加入媒体-查克·厄特巴克</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">加入我的推荐链接- Chuck Utterback，从我自己和所有的人那里获得高质量的文章</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">chuckutterback.medium.com</p></div></div><div class="qb l"><div class="qc l qd qe qf qb qg lb ps"/></div></div></a></div></div></div>    
</body>
</html>