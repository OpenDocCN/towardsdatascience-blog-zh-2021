<html>
<head>
<title>Deploy HuggingFace Models on Amazon SageMaker under 10 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">10分钟内在亚马逊SageMaker上部署HuggingFace模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploy-huggingface-models-on-amazon-sagemaker-under-10-minutes-d52ee8b2cd25?source=collection_archive---------23-----------------------#2021-10-06">https://towardsdatascience.com/deploy-huggingface-models-on-amazon-sagemaker-under-10-minutes-d52ee8b2cd25?source=collection_archive---------23-----------------------#2021-10-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dad0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用HuggingFace Hub大规模部署NLP模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/677e5ab1ca72fb73dddde98c3c55e971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nLByAve_FfnDlOh2"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://unsplash.com/photos/Oaqk7qqNh_c" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="a6d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我通常讨厌点击诱饵标题，所以我将保证这不是一个开始这篇文章。<a class="ae ky" href="https://huggingface.co/models" rel="noopener ugc nofollow" target="_blank">hugging face Hub</a>包含数千种不同的自然语言处理模型，适用于从摘要到文本生成的各种自然语言处理任务。今年早些时候，<a class="ae ky" href="https://huggingface.co/blog/the-partnership-amazon-sagemaker-and-hugging-face" rel="noopener ugc nofollow" target="_blank">亚马逊SageMaker </a>与HuggingFace合作发布了AWS管理的HuggingFace容器，使得将HF模型和脚本带到云上比以往任何时候都更容易。在本文中，我们将探索一个简单的例子，用几行简单的代码从AWS SageMaker上的<strong class="lb iu"> HF Hub </strong>部署<strong class="lb iu"> bert-base-uncased </strong> <strong class="lb iu">预训练模型</strong>。在继续这篇文章之前，AWS的一些<strong class="lb iu">先验知识</strong>和SageMaker是如何操作的，有望完全理解所有的内容。</p><h1 id="21d1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">目录</h1><ol class=""><li id="74a6" class="mn mo it lb b lc mp lf mq li mr lm ms lq mt lu mu mv mw mx bi translated">设置</li><li id="c8f5" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">SageMaker上的高频部署</li><li id="2fab" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">结论/额外资源</li></ol><h1 id="2fe0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置</h1><p id="4fae" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">对于这个例子，我们将使用传统的SageMaker笔记本实例。首先转到AWS控制台上的SageMaker，然后点击<strong class="lb iu">笔记本实例</strong>。在笔记本实例中，您可以选择创建笔记本实例。在这里，您可以选择一个具有适当计算能力的实例，这个例子并不太密集，所以我们可以使用更便宜的ml.t2.medium。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/820461c1cae67324991d4b17e2753ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvDkrA3Ab5m6wn6Qpk3KGQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="8f9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，您将被要求创建一个角色，该角色将在必要时授予您的实例使用其他服务的权限。<strong class="lb iu">对于这个用例，保留默认的执行角色</strong>和SageMaker完全访问权限，因为我们不会使用任何其他AWS服务。接下来创建Notebook实例，您应该可以选择访问Jupyter实验室环境，您可以在其中工作。在这里你可以创建一个合适内核的笔记本。Python3内核对于这个例子来说已经足够了。现在我们有了一台笔记本电脑，可以在上面部署我们的HF模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/05328d321d0579296bae3ea69f271811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ccqmEk95W0M_2iGn5GlXQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><h1 id="dfe4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">SageMaker上的高频部署</h1><p id="3728" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">要访问我们正在使用的模型，请转到下面的HF <a class="ae ky" href="https://huggingface.co/bert-base-uncased" rel="noopener ugc nofollow" target="_blank"> Hub link </a>。这个模型是预先训练好的，可以完成各种任务，我们将专门用它来进行<strong class="lb iu">文本分类</strong>。使用来自Hub的预训练模型的令人惊叹之处在于，当它们集成在一起时，它们已经为我们提供了在SageMaker上部署的指导。一旦进入高频集线器链接，在右上角的<strong class="lb iu">中</strong>你会注意到<strong class="lb iu">展开</strong>。如果你点击选项，你会看到亚马逊SageMaker。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/5e27deb158d60650107ce8d5a7398c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CgTW2Nf6R8nXNurg7RU6tQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="bc0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击SageMaker后，您可以选择任务类型(文本分类)并为<strong class="lb iu">配置</strong>选择<strong class="lb iu"> AWS </strong>。这将提供样板代码，您可以在您的笔记本实例中利用它来部署这个特定的模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入和集线器配置</p></figure><p id="098a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">HF模型ID和任务是HuggingFace容器如何理解我们正在处理的模型和它试图解决的问题。我们现在可以通过SageMaker定义内置的<a class="ae ky" href="https://sagemaker.readthedocs.io/en/stable/frameworks/huggingface/sagemaker.huggingface.html" rel="noopener ugc nofollow" target="_blank"> HuggingFace模型</a>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建HF SageMaker模型</p></figure><p id="0b3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建HuggingFace模型后，最后一步也是最简单的一步是使用<a class="ae ky" href="https://docs.aws.amazon.com/sagemaker/latest/dg/realtime-endpoints.html" rel="noopener ugc nofollow" target="_blank"> SageMaker实时</a>端点部署它以进行推理。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将HuggingFace模型部署到实时端点</p></figure><p id="db8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在端点成功部署后，我们可以快速测试一些示例推断。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">SageMaker推理</p></figure><p id="7fd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，我们应该可以看到文本分类结果与多数类一起显示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/c0ff4ed19356fd93f743fc23dc6b535f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWinxcJvaRNspelPKX4mTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="c2d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果当前不使用端点，请确保将其删除，以免产生任何额外费用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">删除端点</p></figure><h1 id="c3fe" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="c1dd" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">HuggingFace拥有大量的NLP资源，SageMaker有助于将这些模型扩展到令人难以置信的规模。从HuggingFace Hub部署只是SageMaker的一种部署方法。您还可以从S3的模型数据中部署HuggingFace模型。您还可以训练HuggingFace估计器，然后部署一个<a class="ae ky" href="https://github.com/aws/sagemaker-huggingface-inference-toolkit" rel="noopener ugc nofollow" target="_blank">定制推理脚本</a>，让您管理输入和输出。为了进一步探索，我在附加资源类别中附加了一些例子和文章。</p><p id="7a90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对使用Amazon SageMaker和HuggingFace的人有用。如果你对ML &amp; AWS感兴趣，欢迎在评论中留下任何反馈或在<a class="ae ky" href="https://www.linkedin.com/in/ram-vegiraju-81272b162/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上与我联系。如果对我的更多作品感兴趣，请务必关注我的<a class="ae ky" href="https://ram-vegiraju.medium.com/" rel="noopener">媒体</a>。感谢您的阅读。</p><h1 id="1877" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">额外资源</h1><p id="322b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated"><a class="ae ky" href="https://docs.aws.amazon.com/sagemaker/latest/dg/hugging-face.html" rel="noopener ugc nofollow" target="_blank"> SageMaker拥抱脸文档</a></p><p id="d8ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/huggingface/notebooks/tree/master/sagemaker" rel="noopener ugc nofollow" target="_blank">用SageMaker笔记本拥抱脸示例</a></p></div></div>    
</body>
</html>