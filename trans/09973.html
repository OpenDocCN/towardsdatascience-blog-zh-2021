<html>
<head>
<title>Create a fast auto-documented, maintainable and easy-to-use Python API in 5 lines of code with FastAPI (part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用FastAPI(第1部分)用5行代码创建一个快速自动记录、可维护且易于使用的Python API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-fast-auto-documented-maintainable-and-easy-to-use-python-api-in-5-lines-of-code-with-4e574c00f70e?source=collection_archive---------11-----------------------#2021-09-20">https://towardsdatascience.com/create-a-fast-auto-documented-maintainable-and-easy-to-use-python-api-in-5-lines-of-code-with-4e574c00f70e?source=collection_archive---------11-----------------------#2021-09-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0da6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">非常适合只需要一个完整、有效、快速和安全的API的(没有经验的)开发人员</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2db98e142d8d2b2e67d559fb97b6685c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_G2XZH5GewoNf70T"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">构建和使用我们的API就像使用这台自动售货机一样简单(图片由詹娜·哈姆拉在<a class="ae ky" href="https://www.pexels.com/photo/red-and-white-coca-cola-vending-machine-899786/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄)</p></figure><p id="7c07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有一个很棒的python程序，你想把它公之于众。使用FastAPI，您可以快速创建一个超快速的API，让其他用户可以使用您的Python代码。</p><p id="5ae2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将用<strong class="lb iu"> 5行代码</strong>创建一个API。什么？五行？！没错；FastAPI不叫FastAPI，因为它比Django或Flask之类的框架快很多倍；设置起来也超级简单快捷。</p><p id="828f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们创建了我们的初始API之后，我们将在下一部分扩展它，展示创建一个全功能、超快、生产就绪的API所需的所有必要知识。我们来编码吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="d41c" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">FastAPI简介</h2><p id="3702" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">让我们先快速浏览一下我们的框架。FastAPI是一个现代的、开源的、快速的、高性能的Python web框架，用于构建Web APIs。在uvicon下运行的应用程序被列为最快的Python框架之一，仅次于Starlette和uvicon本身(由FastAPI内部使用)。听起来不错吧？让我们不再浪费时间，看看如何使用它。</p><h2 id="bb41" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">装置</h2><p id="f0d0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">安装非常简单。我们将首先用PIP安装FastAPI。然后我们还需要安装Uvicorn。这是运行FastAPI的web服务器。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="ca03" class="mc md it nb b gy nf ng l nh ni">pip install fastapi uvicorn</span></pre><p id="2335" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">建议在虚拟环境中安装Python依赖项。这样你就可以让你的项目不再混乱。查看本文 了解如何使用虚拟环境的简单说明。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="ee2e" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">创建我们的API</h2><p id="c1fa" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">所有必要的工具都已安装，让我们在根处创建一个API，在<strong class="lb iu"> <em class="nj">的五个</em> </strong>行中。我们将创建一个名为<code class="fe nk nl nm nb b">main.py</code>的文件:这个文件将是我们应用程序的主要入口点，并将定义我们的API。插入下面的代码:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="deaa" class="mc md it nb b gy nf ng l nh ni">from fastapi import FastAPI<br/>app = FastAPI()<br/>@app.get("/")<br/>def simple_route():<br/>    return {"Hello": "There"}</span></pre><p id="8688" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看到这有多简单了吗？我们正在导入<code class="fe nk nl nm nb b">fastapi</code>，创建一个新的实例，我们将把它存储在<code class="fe nk nl nm nb b">app</code>变量中。这是我们已经定义的API！在最后三行中，我们定义了一条路线。API已创建！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/cb7cbc09e032d5ee624d381ba2093097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rJ6UhNoCIK8DVqRt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的API已经设置好，可以运行了。3, 2, 1..开始！(图片由<a class="ae ky" href="https://www.pexels.com/@olly" rel="noopener ugc nofollow" target="_blank"> Andrea Piacquadio </a>在<a class="ae ky" href="https://www.pexels.com/photo/strong-sportsmen-ready-for-running-on-stadium-3764011/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄)</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="27f5" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">启动我们的API</h2><p id="792e" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">是时候启动我们的API了。打开终端，导航到上一步中的<code class="fe nk nl nm nb b">main.py</code>文件所在的文件夹(如果您没有使用终端的经验，请查看本文<a class="ae ky" href="https://mikehuls.medium.com/terminals-consoles-command-line-for-absolute-beginners-de7853c7f5e8" rel="noopener"><strong class="lb iu"/></a>)。执行以下命令:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="398e" class="mc md it nb b gy nf ng l nh ni">uvicorn main:app --reload</span></pre><p id="c03e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将调用Uvicorn并告诉它运行位于<code class="fe nk nl nm nb b">main.py</code>文件中的<code class="fe nk nl nm nb b">app</code>(上一步中定义的变量)。如果我们为了加速开发而保存更改，那么<code class="fe nk nl nm nb b">--reload</code>标志会重新加载；我们不必为了看到变化而手动停止和启动API。</p><p id="8ce5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您使用虚拟环境，请确保首先激活它。另一种称呼乌维科恩的方式是<code class="fe nk nl nm nb b">python -m uvicorn main:app --reload</code>。这完全一样，只是你可以指定一个特定的python.exe，例如:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="8fe1" class="mc md it nb b gy nf ng l nh ni">c:/mike/myProj/venv/scripts/python.exe -m uvicorn main:app --reload</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="83fe" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">测试我们的路线</h2><p id="811a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果一切正常，您将看到“应用程序启动完成”。如果你没有另外指定，那么uvicorn运行在你的本地主机上，端口8000。于是打开浏览器，对着<code class="fe nk nl nm nb b">localhost:8000</code>。您应该看到以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/36233ff20a45743f7cdb4b7933545da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*oWll5Ng0ihxGt9V3Bq0u5g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">API上/ route的返回值(图片由作者提供)</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="61cf" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">自动文档</h2><p id="52ba" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">关于使用FastAPI，我最喜欢的一个特性是，它会自动生成如何使用该API的说明和概述；有哪些路线，如何调用的例子，你甚至可以测试路线，看看返回值！在<code class="fe nk nl nm nb b">localhost:8000/docs</code>或<code class="fe nk nl nm nb b">localhost:8000/redoc</code>检查一下。这些是相同文档的不同样式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/73bf3171fc7de5b431c9a6acc249ff75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kpx8e98u-tR8kuyp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">那是一场又短又快的比赛！(图片由<a class="ae ky" href="https://www.pexels.com/@runffwpu" rel="noopener ugc nofollow" target="_blank">在<a class="ae ky" href="https://www.pexels.com/photo/man-ripping-finish-line-strap-2524739/" rel="noopener ugc nofollow" target="_blank">像素</a>上运行4个FFWP </a></p></figure><h1 id="bbae" class="nq md it bd me nr ns nt mh nu nv nw mk jz nx ka mn kc ny kd mq kf nz kg mt oa bi translated">结论</h1><p id="d7d3" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在大约5分钟的时间里，我们已经完成了一个简单的API，在根上只有一条路由。但是还没有太多的互动性。我们想连接我们的API，这样它应该能够接收和发送一些消息！</p><p id="9156" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://mikehuls.medium.com/create-a-fast-auto-documented-maintainable-and-easy-to-use-python-api-crud-routes-and-routing-7e8f35ebda46" rel="noopener"> <strong class="lb iu">的下一部分</strong> </a>中，我们将了解如何接收查询参数和主体。此外，我们将在API中创建更多的路由，并以智能的方式组织这些路由。稍后，我们将关注使用Docker的数据验证、安全性和部署。</p><p id="43e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有建议/澄清，请评论，以便我可以改进这篇文章。同时，看看我的<a class="ae ky" href="https://mikehuls.medium.com/" rel="noopener">关于各种编程相关话题的其他文章</a>。</p><p id="e887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码快乐！</p><p id="961d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">—迈克</p><p id="5bc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">页（page的缩写）学生:比如我正在做的事情？<a class="ae ky" href="https://mikehuls.medium.com/membership" rel="noopener">跟我来</a>！</p></div></div>    
</body>
</html>