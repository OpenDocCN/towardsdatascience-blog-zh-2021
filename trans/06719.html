<html>
<head>
<title>Five Tips for Automatic Python Documentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化Python文档的五个技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/five-tips-for-automatic-python-documentation-7513825b760e?source=collection_archive---------7-----------------------#2021-06-17">https://towardsdatascience.com/five-tips-for-automatic-python-documentation-7513825b760e?source=collection_archive---------7-----------------------#2021-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f454" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用这五个自动化步骤和预提交Git挂钩在MkDocs &amp; Material中创建漂亮的Python文档</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a2fe366cb2be3c7ed445de96fdecfced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IfdEpaIcW-XMR8fV.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MkDocs中自动生成的带有Google风格docstring的函数文档</p></figure><p id="98a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个故事中，您将学习如何通过我们的定制函数、包<code class="fe lu lv lw lx b">mkgendocs</code>、预提交Git钩子和MkDocs中的一点魔法从Python模块自动生成文档。我们将涉及以下内容</p><ul class=""><li id="c8ac" class="ly lz it la b lb lc le lf lh ma ll mb lp mc lt md me mf mg bi translated">MkDocs &amp;材料安装</li><li id="941d" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt md me mf mg bi translated">将类型提示自动化到文档字符串</li><li id="9e9b" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt md me mf mg bi translated">使用<code class="fe lu lv lw lx b">mkgendocs</code>将文档字符串自动转换为MkDocs</li><li id="eefb" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt md me mf mg bi translated">自动记录新的Python函数</li><li id="268f" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt md me mf mg bi translated">在预提交Git钩子中将所有东西绑在一起</li></ul></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="691f" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">MkDocs &amp;材料安装</h1><p id="b0f8" class="pw-post-body-paragraph ky kz it la b lb nl ju ld le nm jx lg lh nn lj lk ll no ln lo lp np lr ls lt im bi translated">MkDocs是一个用于构建项目文档的静态站点生成器，加上Material框架，它看起来非常漂亮。首先，我们需要安装一堆包来使用MkDocs的所有功能。所有这些包都是pip可安装的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="fed2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">MkDocs使用一个配置文件<code class="fe lu lv lw lx b">mkdocs.yml</code>，在这里你可以启用上面安装的所有功能和软件包。请在这里找到我的<a class="ae ns" href="https://github.com/LouisdeBruijn/Medium/blob/master/mkdocs.yml" rel="noopener ugc nofollow" target="_blank">。它包括对主题的<code class="fe lu lv lw lx b">/docs</code>和<code class="fe lu lv lw lx b">/docs_assets</code>文件夹的引用。</a></p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="1763" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">将类型提示自动化到文档字符串</h1><p id="8446" class="pw-post-body-paragraph ky kz it la b lb nl ju ld le nm jx lg lh nn lj lk ll no ln lo lp np lr ls lt im bi translated">以前，我写过关于编写docstrings的重要性的文章，重点是Sphinx文档。</p><div class="nt nu gp gr nv nw"><a href="https://betterprogramming.pub/the-guide-to-python-docstrings-3d40340e824b" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">开始编写Python文档字符串</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">简化你的生活和任何试图阅读你的代码的人的生活</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">better编程. pub</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><p id="9ac2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">文档字符串是记录函数的重要工具。Python 3.5+引入了<a class="ae ns" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">类型提示</a>，这是一种直接在函数参数中将静态类型赋给变量的方法。</p><p id="cc0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几个ide如<a class="ae ns" href="https://www.jetbrains.com/help/pycharm/using-docstrings-to-specify-types.html" rel="noopener ugc nofollow" target="_blank"> Pycharm </a>、<a class="ae ns" href="https://marketplace.visualstudio.com/items?itemName=njpwerner.autodocstring" rel="noopener ugc nofollow" target="_blank"> Visual Studio </a>和<a class="ae ns" href="https://packagecontrol.io/packages/AutoDocstring" rel="noopener ugc nofollow" target="_blank"> Sublime Text </a>都支持自动生成docstring。然而，它们还不能从类型提示中推断变量类型，这意味着您必须在文档字符串中填写变量类型和描述。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/7f7135bc29a22e58df2b74ccdc21d5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1DAtUCbeWYMzFeLhhJ5yxg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pycharm(几乎)自动生成文档字符串</p></figure><p id="bc88" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面显示的是Pycharm中使用<a class="ae ns" href="https://google.github.io/styleguide/pyguide.html" rel="noopener ugc nofollow" target="_blank"> Google风格的文档字符串</a>的实现。您可以自由使用其他样式(例如reStructuredText/Sphinx或NumPy)，但是我发现了一个专门用于Google样式的docstrings的包，用于我们接下来的自动化步骤。</p><p id="f2de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对自动化文档字符串的类型提示感兴趣吗？阅读下面的故事👇</p><div class="nt nu gp gr nv nw"><a rel="noopener follow" target="_blank" href="/python-type-hints-docstrings-7ec7f6d3416b"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">Python类型提示和文档字符串</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">在Google风格的文档字符串中自动插入Python的类型提示(3.5+)中的变量类型。</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">towardsdatascience.com</p></div></div><div class="of l"><div class="om l oh oi oj of ok ks nw"/></div></div></a></div></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="23df" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">将文档字符串自动转换为MkDocs</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/e69a861ec807ac52fec333c915d07e3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2GXBH9B9RZZLc5BmYEExZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从函数docstring自动推断出的MkDocs页面</p></figure><p id="6568" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">包<code class="fe lu lv lw lx b">mkgendocs</code>自动将Google风格的docstrings翻译成带有Python函数描述的页面。它使用一个配置文件<code class="fe lu lv lw lx b">mkgendocs.yml</code>。配置文件如下所示</p><pre class="kj kk kl km gt oo lx op oq aw or bi"><span id="66ca" class="os mu it lx b gy ot ou l ov ow">sources_dir: docs<br/>templates_dir: docs/templates<br/>repo: <a class="ae ns" href="https://github.com/LouisdeBruijn/Medium" rel="noopener ugc nofollow" target="_blank">https://github.com/LouisdeBruijn/Medium</a><br/>version: master</span><span id="ba2e" class="os mu it lx b gy ox ou l ov ow">pages:<br/>  - page: "scripts/base/base.md"<br/>    source: "Python tips/base.py"<br/>    functions:<br/>      - parse_arguments<br/>      - print_df<br/>      - unescape_html<br/>      - equal_array_items</span></pre><p id="e557" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用该软件包的两个手动步骤是</p><ol class=""><li id="f0c0" class="ly lz it la b lb lc le lf lh ma ll mb lp mc lt oy me mf mg bi translated">将需要记录的页面、源代码和函数添加到这个<code class="fe lu lv lw lx b">mkgendocs.yml</code>文件中。</li><li id="a7ff" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt oy me mf mg bi translated">运行<code class="fe lu lv lw lx b"><strong class="la iu">$</strong> gendocs --config mkgendocs.yml</code>用这些函数的文档创建静态MkDocs页面。</li></ol><p id="af64" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将自动化这两个步骤，首先创建一个脚本来预填充我们的配置文件，然后将这两个步骤附加到一个预提交Git挂钩中。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="cad1" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">自动记录新功能</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/17b3fc651fd78481472141161ae71da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHvfOK8JT4MK0QESZP8IBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从文档字符串填充mkgendocs配置的函数</p></figure><p id="0808" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我编写了一个带有函数<code class="fe lu lv lw lx b">automate_mkdocs_from_docstring()</code>的模块<code class="fe lu lv lw lx b"><a class="ae ns" href="https://github.com/LouisdeBruijn/Medium/blob/master/Python%20tips/automate.py" rel="noopener ugc nofollow" target="_blank">automate.py</a></code>，用存储库中模块(脚本)中的所有Python函数填充<code class="fe lu lv lw lx b">mkgendocs.yml</code>配置文件。</p><p id="8c0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">automate_mkdocs_from_docstring()</code>使用Pathlib读取目录中的Python脚本并提取函数名。它将模块名和函数名保存在一个字典中，并用它来覆盖<code class="fe lu lv lw lx b">mkgendocs.yml</code>。这样我们可以自动填充<code class="fe lu lv lw lx b">mkgendocs</code>包的配置文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/a6b08f0758f3bb24392059c060da5f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m52MiaWM7WrWDLQ-uukoXg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从docstrings到MkDocs的自定义自动化步骤</p></figure><p id="a76a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其次，我们将在预提交Git挂钩中包含<code class="fe lu lv lw lx b">automate.py</code>和<code class="fe lu lv lw lx b"><strong class="la iu">$</strong> gendocs --config mkgendocs.yml</code>的执行。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="23c1" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">在预提交Git钩子中将所有东西绑在一起</h1><p id="eea4" class="pw-post-body-paragraph ky kz it la b lb nl ju ld le nm jx lg lh nn lj lk ll no ln lo lp np lr ls lt im bi translated">我们的最后一步是将每个自动化步骤添加到<code class="fe lu lv lw lx b">pre-commit-config.yaml</code>中的Git挂钩中。关于预提交Git钩子的更多信息，请见下面的文章👇</p><div class="nt nu gp gr nv nw"><a href="https://betterprogramming.pub/4-tips-to-automate-clean-code-in-python-527f59b5fe4e" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">在Python中自动化干净代码的4个技巧</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">通过这些林挺和格式化工具，使用预提交Git挂钩来自动化Python代码样式</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">better编程. pub</p></div></div><div class="of l"><div class="pb l oh oi oj of ok ks nw"/></div></div></a></div><p id="3525" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将自动生成MkDocs页面的两个强制步骤与预提交Git挂钩中的<code class="fe lu lv lw lx b">mkgendocs</code>包一起添加。这些钩子允许我们用一个<code class="fe lu lv lw lx b">entry</code> bash命令执行一个Python脚本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="ce83" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这样，当我们在存储库中的任何地方创建或删除Python函数时，它们将被自动添加到<code class="fe lu lv lw lx b">mkgendocs</code>配置文件中，自动创建静态MkDocs页面并构建文档网站。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/f44b23f8b9db17644fc2ce7728ede06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*77EnUG9WHLrJJVDI.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预提交Git挂钩中的自动文档</p></figure><p id="9a84" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">剩下唯一要做的就是用<code class="fe lu lv lw lx b"><strong class="la iu">$</strong> mkdocs serve</code>运行我们的MkDocs站点，并在<a class="ae ns" href="http://127.0.0.1:8000/." rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8000/找到我们的文档。</a></p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h1 id="f7ef" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">结论</h1><p id="c41b" class="pw-post-body-paragraph ky kz it la b lb nl ju ld le nm jx lg lh nn lj lk ll no ln lo lp np lr ls lt im bi translated">通过本文中介绍的自动化步骤，您可以在MkDocs中自动创建漂亮的Python文档。如果你有任何问题，随时联系我。编码快乐！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/35714e8a0785f8043026f1f4bcae9320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bElRYrHucn41MKaZcO7x-A.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">包含MkDocs和材料的文档站点，图片由作者提供。</p></figure></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="11cc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">寻找更多Python干净的编码技巧？在这里找到他们👇</p><div class="nt nu gp gr nv nw"><a href="https://medium.com/analytics-vidhya/seven-tips-to-clean-code-with-python-24930d35927f" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">用Python清理代码的七个技巧</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">以下是我作为数据科学家在工作中每天使用的七个技巧和代码片段。</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">medium.com</p></div></div><div class="of l"><div class="pd l oh oi oj of ok ks nw"/></div></div></a></div></div></div>    
</body>
</html>