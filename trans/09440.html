<html>
<head>
<title>Automated Machine Learning Model Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化机器学习模型测试</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automated-machine-learning-model-testing-d0f49a36a6ac?source=collection_archive---------38-----------------------#2021-09-01">https://towardsdatascience.com/automated-machine-learning-model-testing-d0f49a36a6ac?source=collection_archive---------38-----------------------#2021-09-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4c5a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用LazyPredict只用几行代码就尝试了20多个机器学习模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/67abc488f1a387a46e521164c1548ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qq99OCt8IZDzQ4e0.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="be90" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们都遇到过这种情况，我们不知道哪种模型最适合我们的ML项目，最有可能的是，我们正在尝试和评估许多ML模型，只是为了看看它们在我们的数据中的行为。然而，这不是一项简单的任务，需要时间和努力。</p><p id="2ffe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">幸运的是，我们可以使用<a class="ae lu" href="https://lazypredict.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> LazyPredict </a>只用几行代码就能做到这一点。它将运行20多个不同的ML模型，并返回它们的性能统计数据。</p><h1 id="38da" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">装置</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="307d" class="ms lw it mo b gy mt mu l mv mw">pip install lazypredict</span></pre><h1 id="761c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">例子</h1><p id="0122" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">让我们看一个使用来自Kaggle 的<a class="ae lu" href="https://www.kaggle.com/c/titanic/data?select=train.csv" rel="noopener ugc nofollow" target="_blank">泰坦尼克号数据集的例子。</a></p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="e23d" class="ms lw it mo b gy mt mu l mv mw">import pandas as pd<br/>import numpy as np<br/>from lazypredict.Supervised import LazyClassifier, LazyRegressor<br/>from sklearn.model_selection import train_test_split<br/> <br/>data=pd.read_csv(‘train.csv’)<br/> <br/>data.head()</span></pre><p id="f171" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我们将尝试预测是否有乘客在泰坦尼克号上幸存，因此我们有一个分类问题。</p><p id="c386" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Lazypredict还可以进行基本的数据预处理，如填充NA值、创建虚拟变量等。这意味着我们可以在读取数据后立即测试模型，而不会出现任何错误。然而，我们可以使用我们的预处理数据，这样模型测试将更加准确，因为它将更接近我们的最终模型。</p><p id="0ef8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个例子，我们不做任何预处理，让Lazypredict做所有的工作。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="7395" class="ms lw it mo b gy mt mu l mv mw">#we are selecting the following columns as features for our models<br/>X=data[['Pclass', 'Sex', 'Age', 'SibSp',<br/> 'Parch', 'Fare', 'Embarked']]<br/> <br/>y=data['Survived']</span><span id="9a79" class="ms lw it mo b gy nc mu l mv mw">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,random_state=7)</span><span id="eb48" class="ms lw it mo b gy nc mu l mv mw"># Fit LazyRegressor</span><span id="4bf3" class="ms lw it mo b gy nc mu l mv mw">reg = LazyClassifier(ignore_warnings=True, random_state=7, verbose=False)</span><span id="372b" class="ms lw it mo b gy nc mu l mv mw">#we have to pass the train and test dataset so it can evaluate the models</span><span id="fc6c" class="ms lw it mo b gy nc mu l mv mw">models, predictions = reg.fit(X_train, X_test, y_train, y_test)<br/>models</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c521bb9e1cb3191d06655a652bd71943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/0*4pr44pfGBcvSg56D.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bd45" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如您所见，它将返回一个包含模型及其统计数据的数据框。我们可以看到基于树的模型比其他模型表现得更好。知道了这一点，我们可以在我们的方法中使用基于树的模型。</p><p id="bdcc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以从Lazypredict获得完整的管道和使用的模型参数，如下所示。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="a4af" class="ms lw it mo b gy mt mu l mv mw">#we will get the pipeline of LGBMClassifier<br/>reg.models['LGBMClassifier']</span><span id="6272" class="ms lw it mo b gy nc mu l mv mw"><br/>Pipeline(steps=[('preprocessor',<br/>                 ColumnTransformer(transformers=[('numeric',<br/>                                                  Pipeline(steps=[('imputer',<br/>                                                                   SimpleImputer()),<br/>                                                                  ('scaler',<br/>                                                                   StandardScaler())]),<br/>                                                  Index(['Pclass', 'Age', 'SibSp', 'Parch', 'Fare'], dtype='object')),<br/>                                                 ('categorical_low',<br/>                                                  Pipeline(steps=[('imputer',<br/>                                                                   SimpleImputer(fill_value='missing',<br/>                                                                                 strategy='constant')),<br/>                                                                  ('encoding',<br/>                                                                   OneHotEncoder(handle_unknown='ignore',<br/>                                                                                 sparse=False))]),<br/>                                                  Index(['Sex', 'Embarked'], dtype='object')),<br/>                                                 ('categorical_high',<br/>                                                  Pipeline(steps=[('imputer',<br/>                                                                   SimpleImputer(fill_value='missing',<br/>                                                                                 strategy='constant')),<br/>                                                                  ('encoding',<br/>                                                                   OrdinalEncoder())]),<br/>                                                  Index([], dtype='object'))])),<br/>                ('classifier', LGBMClassifier(random_state=7))])</span></pre><p id="04af" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，您可以使用完整的模型管道进行预测。</p><p id="37c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe ne nf ng mo b">reg.models['LGBMClassifier'].predict(X_test)</code></p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="e5ed" class="ms lw it mo b gy mt mu l mv mw">array([0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0,<br/>       0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0,<br/>       0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0,<br/>       0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0,<br/>       0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0,<br/>       0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,<br/>       1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,<br/>       0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,<br/>       0, 0, 1], dtype=int64)</span></pre><p id="9624" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">和LazyClassifier一样，我们可以使用LazyRegressor来测试回归问题的模型。</p><h1 id="a69d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">总结一下</h1><p id="43a2" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">Lazypredict可以帮助我们对哪种模型在我们的数据中表现更好有一个基本的了解。它几乎不需要任何数据预处理就可以运行，因此我们可以在读取数据后立即测试模型。</p><p id="694a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">值得注意的是，有更多的方法来进行自动化机器学习模型测试，如使用<a class="ae lu" href="https://automl.github.io/auto-sklearn/master/" rel="noopener ugc nofollow" target="_blank"> auto-sklearn </a>但安装它非常复杂，尤其是在windows中。</p></div></div>    
</body>
</html>