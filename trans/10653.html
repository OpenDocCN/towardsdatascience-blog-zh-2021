<html>
<head>
<title>The Most for Your Money from Amazon S3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊S3最物有所值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-most-for-your-money-from-amazon-s3-6536c78189da?source=collection_archive---------24-----------------------#2021-10-12">https://towardsdatascience.com/the-most-for-your-money-from-amazon-s3-6536c78189da?source=collection_archive---------24-----------------------#2021-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6cd1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在节约的前提下利用云存储的强大功能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/48a79597bbaabd9f207799a3ed9f961a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Um71EDFL4CstytERv1HwA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">亚马逊S3的最物有所值——图片来自Shutterstock(标准许可)</p></figure><p id="6c45" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank">亚马逊S3 </a>是AWS旗下的文件基础云存储。它可以用于任何类型和大小的文件。它具有无限的可扩展性、持久性和行业标准安全性(正确配置时为*<em class="ls"/>)。它可以作为一个网站资产主机，一个实际的网站，或一个数据湖，它的即插即用与任何AWS服务。</p><p id="f027" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于大多数零件来说，亚马逊S3非常便宜。但是，当数据不断堆积时，这可能具有欺骗性，并且没有针对最佳预算进行监控。无论您是数据工程师、数据科学家还是网站管理员，您都可能会陷入不必要成本的陷阱。在这篇概述中，我将向你展示在亚马逊S3上超支最常犯的错误，以及如何从一开始就避免它们。</p><p id="b9a1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls"> *亚马逊S3是一个非常严格的系统，有许多用例。在我的概述中，我将介绍最常见的方法以及在其中需要寻找的内容。</em></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="9f3b" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak">存储类</strong></h1><p id="73d5" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">存储类是S3的核心，也是最容易被忽视的选项，因为人们会选择默认的——S3标准通用类。将数据放入(或移动到)正确的位置将是成本的一个驱动因素。在选择存储类别时，需要考虑的是数据的<strong class="kx ir">生命周期</strong>和更长时期的<strong class="kx ir">访问频率</strong>。</p><p id="61df" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">存储类别快速概述:</p><p id="1d63" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> S3标准—通用<br/> </strong>这是最常见的一种，也是您默认启动的一种。它用于经常使用的数据。</p><p id="f4fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> S3智能分层</strong> <br/>该层用于未知或不断变化的访问模式。它会自动确定哪些数据不经常被访问，并为您移动这些数据。您可能会为监控支付额外的费用，但是如果您真的不知道您的数据，并且没有设置生命周期规则，这是值得的。您还需要为每1000个生命周期事务请求付费，因此，如果您有大量数据，您不希望在存储类别之间来回移动太多，这样可能不是您的最佳选择。</p><p id="dbe8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> S3标准-IA-频繁访问:</strong>用于检索频率较低但需要快速传输的数据。这是一种较低的存储成本，但您需要为数据检索付费。</p><p id="ffce" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> S3一区-IA: </strong>数据访问不太频繁的地方。顾名思义，它不是由第二个区域备份的，所以它应该只用于可复制的数据，类似于第二个备份。</p><p id="80b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> S3冰川:</strong>不常用的访问层。可以在几分钟到几小时内检索数据。这是存储备份或旧版本的地方。存储很便宜，但是你要为数据传输付费。</p><p id="892e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> S3冰川深层档案馆:</strong>专为极不频繁的访问而设计，一年大约1-2次。数据检索可能需要几个小时。存储是所有选项中最便宜的，但你要为数据传输付费。</p><p id="c781" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> S3前哨:</strong>用于本地存储，与S3 API交互以获取数据。当您有内部数据存储需求时，这是理想之选。</p><p id="f0f2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">关于</em> <a class="ae lr" href="https://aws.amazon.com/s3/storage-classes/?nc=sn&amp;loc=3" rel="noopener ugc nofollow" target="_blank"> <em class="ls">存储类</em> </a> <em class="ls">和</em> <a class="ae lr" href="https://aws.amazon.com/s3/pricing/" rel="noopener ugc nofollow" target="_blank"> <em class="ls">存储类定价</em> </a>的更多信息</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="00d7" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">生命周期规则</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/0c5207c84f1df301e66d8599db4439e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-WkS_uzbM4EehutuYO2ZEg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">“创建生命周期规则”位于“管理”选项卡下(按作者分类的图像)</p></figure><p id="0eb0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">生命周期规则的主要思想是在存储类之间自动移动数据，删除旧数据或版本。功能非常强大，超级好用。从我的经验来看，它通常根本不被使用。生命周期规则是一劳永逸的，是一种“无服务器”的方式来抽象您的数据管理，并通过设计保持低成本。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="0645" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak">版本控制</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/13d9bdd3665866467658bf4732e1af26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_WlRo6ZBi95g24_eoP2DyQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">亚马逊S3版本设置(作者图片)</p></figure><p id="500a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是一个非常简洁的特性。适合审计需求。如果您需要使用此选项，您在这里可以做的最好的事情是将旧版本过渡到更便宜的长期存储类别，或者通过生命周期规则在几天内删除旧版本。</p><h2 id="5d7b" class="mz mb iq bd mc na nb dn mg nc nd dp mk le ne nf mm li ng nh mo lm ni nj mq nk bi translated">版本控制的生命周期规则示例</h2><p id="718d" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">您将为多次存储数据付出代价，这就是为什么我建议以生命周期规则为例:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/7cc84646cecbb79f1f52821c821499d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TNbmG1gSu0kSxCLkeQBZ9A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">版本控制的生命周期规则示例(按作者分类的图像)</p></figure><p id="a4f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">1.从S3标准(假设它是默认的)在1天内将旧版本移动到S3标准-IA。从S3斯坦达尔-IA在4天内将文件转移到S3冰川<br/>现在，请注意与转移到S3冰川相关的每个文件的转移成本。</p><p id="43d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html" rel="noopener ugc nofollow" target="_blank">关于版本控制的更多信息</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="affe" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak">加密类型&amp;成本</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/9a1ea2967b731d832f92a5f842929885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwVNWENIvyw4c0ay_MOyhg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">亚马逊S3加密设置(作者图片)</p></figure><p id="6822" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在S3，您可以选择加密静态数据。您可以加密整个桶或单个文件夹/后缀。您可以选择使用亚马逊S3密钥(SS3-S3)或AWS密钥管理服务密钥(SSE-LMS)。如果你使用一个自定义的(你自己的)KMS键，它的工作方式是每次你从S3读取一个对象时，它也会调用KMS API，这会产生成本。例如，如果您使用S3作为数据湖，或者使用Athena，那么每次读取文件都会增加不必要的成本。您确实可以选择Bucket Key，通过最大限度地减少对KMS的API调用来降低成本，但您最终还是要支付一笔竞价。</p><p id="8ff0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我建议你去SS3-S3，除非你有其他要求。</p><p id="a348" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">*加密可能是一个特定的项目要求，在这种情况下，您需要选择最佳架构，并向利益相关方说明成本。</em></p><p id="1596" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://aws.amazon.com/kms/" rel="noopener ugc nofollow" target="_blank">关于亚马逊密钥管理服务(KMS)的更多信息</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="a3ed" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak"> S3为数据湖</strong></h1><p id="047c" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">在S3上为数据湖存储数据时，p <strong class="kx ir"> artitioning </strong>和<strong class="kx ir">文件格式是这里的</strong>主要关键字。您希望以一种需要对更多文档进行更少扫描的结构来组织文件。会更快更便宜。这也是<strong class="kx ir">生命周期规则</strong>再次发挥作用的地方，它可以帮助您自动清除任何陈旧数据或将其归档到长期存储中。</p><p id="199b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，确保以尽可能小的格式存储数据。例如，<a class="ae lr" href="https://parquet.apache.org/" rel="noopener ugc nofollow" target="_blank"> Parquet </a>或<a class="ae lr" href="https://orc.apache.org/" rel="noopener ugc nofollow" target="_blank"> Orc </a>将是从<a class="ae lr" href="https://aws.amazon.com/athena/?whats-new-cards.sort-by=item.additionalFields.postDateTime&amp;whats-new-cards.sort-order=desc" rel="noopener ugc nofollow" target="_blank"> AWS Athena </a>查询数据和从<a class="ae lr" href="https://aws.amazon.com/glue/?whats-new-cards.sort-by=item.additionalFields.postDateTime&amp;whats-new-cards.sort-order=desc" rel="noopener ugc nofollow" target="_blank"> AWS Glue </a>爬行的理想选择。默认情况下，大多数AWS服务都支持这两种格式。这不仅是最佳实践，而且可以最小化存储大小。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="679f" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">网络服务的S3</h1><p id="4fea" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">这里最常见的用例是托管网站图像或其他资产，如javascript、样式表(CSS)、缩略图等。你甚至可以在S3上建立一个静态网站。在所有这些使用案例中，您将为数据传输到互联网付费。如果这是您的预期用例，您肯定应该使用<a class="ae lr" href="https://aws.amazon.com/cloudfront/" rel="noopener ugc nofollow" target="_blank"> Amazon CloudFront </a>来缓存任何长期永久资产，并从那里为它们提供服务。这还将大大提高资产加载的速度，并降低直接从S3读取数据的成本。是的，你需要为CloudFront付费，但这比直接使用S3要少得多。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="244a" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="e5e8" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">S3的大部分零件都非常便宜。前50 TB的标准存储仅为每GB 0.023美元<em class="ls">(*撰写本文时的价格)</em>如果您是一家大型或小型企业，这对您来说可能不是一个大数目。我个人不喜欢口袋漏水，为什么不从我的项目一开始就防止任何损失。对于基于AWS的构建，我总是遵循AWS良好架构框架的<a class="ae lr" href="https://aws.amazon.com/architecture/well-architected/?wa-lens-whitepapers.sort-by=item.additionalFields.sortDate&amp;wa-lens-whitepapers.sort-order=desc" rel="noopener ugc nofollow" target="_blank">5 Pillers</a>，成本在其中扮演了重要角色。希望我给了你一些好的见解，告诉你如何在亚马逊S3上从几块钱到几个猎人。</p><h1 id="45d8" class="ma mb iq bd mc md nn mf mg mh no mj mk jw np jx mm jz nq ka mo kc nr kd mq mr bi translated">另外，阅读</h1><p id="019f" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/the-most-for-your-money-from-amazon-rds-51784064da1f">亚马逊RDS </a>最划算</p><h1 id="14d2" class="ma mb iq bd mc md nn mf mg mh no mj mk jw np jx mm jz nq ka mo kc nr kd mq mr bi translated">联系人</h1><p id="6eec" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">我是一名软件、数据和机器学习顾问，通过了<a class="ae lr" href="https://www.credly.com/badges/58e38a3f-af0c-441c-be90-6ed99fc4a788/public_url" rel="noopener ugc nofollow" target="_blank"> AWS机器学习</a> &amp; <a class="ae lr" href="https://www.credly.com/badges/0db46f4c-3f60-413d-aa31-8d5e56982d2d/public_url" rel="noopener ugc nofollow" target="_blank"> AWS解决方案架构师认证——专业</a>。如果您的下一个机器学习项目需要帮助，请联系我们。<br/>关注我的最新文章和项目<a class="ae lr" href="https://vel-lesikov.medium.com/subscribe" rel="noopener">，关注我的媒体</a>。</p><ul class=""><li id="a86e" class="ns nt iq kx b ky kz lb lc le nu li nv lm nw lq nx ny nz oa bi translated"><a class="ae lr" href="https://www.linkedin.com/in/velimir-lesikov/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="d600" class="ns nt iq kx b ky ob lb oc le od li oe lm of lq nx ny nz oa bi translated"><a class="ae lr" href="https://vel-lesikov.medium.com/" rel="noopener">中等轮廓</a></li><li id="725f" class="ns nt iq kx b ky ob lb oc le od li oe lm of lq nx ny nz oa bi translated">GitHub </li></ul></div></div>    
</body>
</html>