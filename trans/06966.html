<html>
<head>
<title>A Single Number Metric for Evaluating Object Detection Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于评估对象检测模型的单个数字度量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-single-number-metric-for-evaluating-object-detection-models-c97f4a98616d?source=collection_archive---------15-----------------------#2021-06-24">https://towardsdatascience.com/a-single-number-metric-for-evaluating-object-detection-models-c97f4a98616d?source=collection_archive---------15-----------------------#2021-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7e0b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">F1分数以及它们如何帮助评估模特的表现</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fbc7d26bda60be13c13a27b8a0283ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dD591f9F8pPnH8Vk"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尼古拉斯·卡佩罗在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="3010" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="2e7e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">使用精度和召回率来评估对象检测模型可以提供对模型在各种置信度值下如何执行的有价值的洞察。类似地，F1分数尤其有助于确定平衡给定模型的精度和召回值的最佳置信度；然而，该值跨越了从0到1的置信值的范围。单值评估度量可以从给定模型的F1分数集合中导出，其可以是整体模型性能的良好指标。</p><h2 id="a5d3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">背景</h2><p id="00f6" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">F1分数、精确度和召回率可使用以下等式进行评估:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/0cc6b26779ecea4ccaa91815f21b4ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*2dfEH04P9wffwMYjKP5hUg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">F1分数、精确度和回忆方程式，作者图片</p></figure><p id="05bc" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">当在各种置信值下评估模型时，这些指标可以很好地协同工作，从而根据设计规范提供关于模型如何执行以及哪些值可以优化模型性能的有价值的见解。通常，随着置信度阈值的增加，精确度会上升，召回率会下降，如下面显示的自定义yolo v5模型的结果所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/342357ef95245a72e6bee47951276730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BSwrIdEfMiyES9AzPyk3ag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义yolo v5对象检测模型的单一类别精度分数，图片由作者提供</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/6906141ca84345c7c5a9a93e0a7253d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lO6hu1yaWapz4t6624XhLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义yolo v5对象检测模型的单一类别召回分数，图片由作者提供</p></figure><p id="1091" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">使用F1得分曲线，可以看到精确度和召回率之间的平衡，并且可以使用下面的图表确定设计点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/87ed1af92820cc880a9f1b853a9d622a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PaXDT5Q3FgebdXKIv-JrxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义yolo v5对象检测模型的F1得分曲线，图片由作者提供</p></figure><p id="adda" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">从F1曲线来看，优化精度和召回率的置信度值是0.352。在许多情况下，更高的置信度值是可取的。在该模型的情况下，选择置信度0.6可能是最佳的，因为F1值看起来大约为0.75，这与最大值0.81相差不远。观察置信度为0.6的精度和召回值也证实了这可能是一个合适的设计点。从0.6左右开始，召回值开始吃亏，精度值还是大致在最大值。</p><h2 id="daf8" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">理论</h2><p id="85b2" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">现在，通过提供具有相应置信度的最大值，可以用F1分数中的单个数字来评估模型；然而，这可能不能准确地代表模型的整体。从F1得分中得出的一个建议的单个数字指标如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/84d10c194baa0df3df6d5e24cfb6fc43.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*iSOKfjqGUtBkP2joAxXbQA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">建议度量的基本积分形式，作者提供的图像</p></figure><p id="aef2" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">该值通过对F1得分曲线进行积分来确定，积分的指数因子称为gamma。如果F1曲线的方程是已知的，可以使用这种形式。在大多数情况下，F1得分曲线由使用评估或测试数据集评估的值生成。在这种情况下，可以使用更一般形式的方程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/f72ae773da25e1c190bc513dc9e3d930.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*z6EvO7xWrJxSZhV_0jMpog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">建议指标的求和符号，作者提供的图像</p></figure><p id="b5e3" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">当应用矩形积分时，可以使用具有中点规则的公式的详细形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/0ac21893cabfa89d2e3d7ded7d502b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RePJBTdwvQH5IRf2aFtpDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">中点规则应用于矩形块，按作者排序的图像</p></figure><p id="4dcc" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">p是给定索引处的精度值，R是给定索引处的召回值。指数γ1/c已被给定指数的平均置信度值所取代。</p><p id="f298" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">在这个新的符号中，将计算每个数据点的F1得分曲线下的面积，并将其添加到累计总数中。指数因子gamma可用于惩罚和奖励F1曲线的各个区域。例如，对于gamma的标准值，置信值较低的1/c: F1分数由于被驱动到0而受到严重惩罚，并且对整体度量几乎没有贡献。类似地，对于高置信度值的F1分数，指数因子最低限度地惩罚总分数。此指标可获得的最大值为1，最小值为0。yolo v5模型F1得分曲线各点的建议指标值如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/5e3175963de9912707b23502b14e2a15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pScwjhnjopAC3QOet3215A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">衍生F1评分曲线与处罚，图片由作者</p></figure><p id="0a62" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">蓝线表示等式7在每个数据点的计算值。请注意，随着数据点数量的增加，该值会越来越小。浅橙色条代表所有计算的单个数据点得分的累计总数。</p><p id="65d4" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">由于伽马因子，在置信度为0.1或更低时评估的大多数F1分数点被驱为零，并且F1分数贡献被抑制直到置信度为0.4。F1分数值的惩罚程度可以使用gamma因子来控制。例如，如果需要更高的惩罚，将伽马因子中的分子从1/c增加到10/c。这将使置信度为0.4之前的所有值比以前受到更严重的惩罚，但不会改变惩罚开始改变的置信度值。</p><p id="6d69" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">类似地，如果想要更少的惩罚，减少分子或者甚至移除伽马指数将会有所帮助。用于评估度量标准的一种形式的方程，该度量标准考虑了控制惩罚程度和惩罚点的变量，可描述为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/2bd744284e481130057af2ba4183ba59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQbkonTz6rfyAPwrH3BEoQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有惩罚因子的度量评估，由作者提供的图像</p></figure><p id="a4d5" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">其中<em class="na"> f </em>用于控制上面讨论的惩罚量(默认值1)。请注意，将<em class="na"> f </em>增加到大于1的值将显著影响分数。</p><h2 id="c540" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">比较</h2><p id="d0fd" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们来比较三个模型:前面提到的基础模型，一个比基础模型差的模型，一个比基础模型好的模型。这些模型被指定为优于或劣于基本模型的方式可以总结为:</p><ul class=""><li id="d9c4" class="nb nc it lx b ly mp mb mq li nd lm ne lq nf mn ng nh ni nj bi translated">F1曲线、积分面积、罚积分面积</li><li id="61c0" class="nb nc it lx b ly nk mb nl li nm lm nn lq no mn ng nh ni nj bi translated">推理结果的人工评估</li><li id="3d3b" class="nb nc it lx b ly nk mb nl li nm lm nn lq no mn ng nh ni nj bi translated">通过较少的训练数据、不同的配置参数以及时期和批次变化，专门训练得更好或更差</li></ul><p id="3601" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">各种模型的F1曲线、非惩罚积分值和惩罚积分值曲线如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/00e0cecd13bbf9939af34358e4642139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ni3HuiB06as3g-IT5hM2lw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">各种度量得分曲线，图片由作者提供</p></figure><p id="e290" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">非惩罚曲线将遵循F1曲线的相同轮廓，因为它们是线性相关的。请注意，F1曲线和非惩罚积分曲线之间的幅度是不同的。这是由于等式9中的δ置信项。任何积分分数的最大可能值是用于积分F1曲线的增量。在这种情况下，使用0.05的增量，因此非惩罚和惩罚积分的最大值是0.05。当置信度接近约0.4时，惩罚曲线的低置信度部分随着衰落严重程度而明显降低。所有被罚曲线都是在<em class="na"> f </em>值为1的情况下计算的。</p><p id="3b43" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">上述曲线的最终得分总结如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/ed248835e186c253cca769ba501ea35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JaCaHQ3tsiPAZ_Qftt1bLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分数摘要，按作者分类的图像</p></figure><p id="bed2" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">最后一行是处罚分数与非处罚分数的比率。它代表综合F1分数中位于较高置信区域的部分。如果期望更高的置信度，当确定多少非惩罚分数实际上是相关的时，这可能是一个很好的指标。</p><p id="a900" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">一个GitHub知识库已经公开，可以很容易地计算出被罚和未被罚的综合分数。可以在以下位置找到它:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/plebbyd/integrated-F1" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">plebbyd/集成-F1</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">该库用于轻松计算被罚和未被罚的F1积分。为了使用，克隆…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ks nu"/></div></div></a></div><p id="1b3d" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">此外，对于任何给定的置信度和F1分数值的输入，该存储库中的函数返回惩罚与非惩罚的比率。</p><h2 id="067c" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">结论</strong></h2><p id="dec5" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">惩罚的和非惩罚的综合F1分数可以是用于评估对象检测模型的良好的单个数字度量。如果在多个模型的研究或训练过程中无法对F1曲线进行手动检查，那么评估这些新指标可能会有所帮助。</p><h2 id="5f54" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">参考</h2><p id="0157" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">[1]戴维·m·w·鲍尔斯(2011年)。<a class="ae ky" href="https://www.researchgate.net/publication/228529307" rel="noopener ugc nofollow" target="_blank">“评价:从精度、召回率、F-Measure到ROC、信息量、标记性&amp;相关性”</a>。<em class="na">机器学习技术杂志</em>。<strong class="lx iu">2</strong>(1):37–63。</p><p id="0c6b" class="pw-post-body-paragraph lv lw it lx b ly mp ju ma mb mq jx md li mr mf mg lm ms mi mj lq mt ml mm mn im bi translated">[2] Yolo v5 (2021)。In: GitHub。<a class="ae ky" href="https://github.com/ultralytics/yolov5" rel="noopener ugc nofollow" target="_blank">https://github.com/ultralytics/yolov5</a>。访问时间是2021年5月31日。</p></div></div>    
</body>
</html>