<html>
<head>
<title>Build a data app for cohort analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建群组分析的数据应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-a-data-app-for-cohort-analysis-5d4e3161a988?source=collection_archive---------19-----------------------#2021-07-20">https://towardsdatascience.com/build-a-data-app-for-cohort-analysis-5d4e3161a988?source=collection_archive---------19-----------------------#2021-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e1de" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">进行群组分析的分步指南，关注技术而不是代码</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9a76967e3652549c73716bae552a89b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QP-nve9PJDD3j2SOu35Edw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="8f87" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">群组分析是一个强大的工具，它使公司能够更好地了解客户的需求和习惯。我们可以通过将具有相似属性(例如，注册日期、首次购买日期、潜在客户来源等)的用户或客户分组来收集有价值的见解。)然后观察关键绩效指标(KPI例如，参与度、产生的收入、留存)。</p><p id="8994" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个消费者应用留存的群组分析热图示例。该应用程序的用户被分组到注册月的队列中，他们的保留率是按周观察的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lr"><img src="../Images/e76496f97bfcbd4f0b59bf10029f43e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xjs8-Z7wLuYGm2Ic8yqi0g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="035f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每一个水平行代表一个不同的用户群体，每一个方块代表该群体在注册后一周内的留存率。例如，我们可以看到，在注册4周后，该应用对2018年2月注册的用户有49%的保留率，而对2018年7月注册的用户来说，同样的4周保留率只有20%。</p><p id="a4e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">研究这种模式有助于发现与业务相关的系统问题，或者反过来，有助于验证随着时间的推移所做的更改。</p><p id="c1ab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然有许多文章谈到用python或R或FORTRAN执行群组分析，但没有一篇文章关注实际技术。</p><p id="688a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="ls">注意:在这里，虽然所有的分析都发生在</em> </strong> <a class="ae lt" href="https://intersectlabs.io" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="ls">【交集】</em> </strong> </a> <strong class="kx ir"> <em class="ls">(一个让你构建</em> </strong> <a class="ae lt" href="https://www.intersectlabs.io/post/what-is-a-data-app" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="ls">数据应用</em> </strong> </a> <strong class="kx ir"> <em class="ls">来自动化重复数据任务的平台)，你可以用你喜欢的工具或语言来重复这些步骤。</em> </strong></p><p id="4150" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">数据描述</strong></p><p id="8c70" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="ls">所用数据</em></strong><em class="ls">:</em><a class="ae lt" href="https://archive.ics.uci.edu/ml/datasets/Online+Retail+II" rel="noopener ugc nofollow" target="_blank"><em class="ls">https://archive.ics.uci.edu/ml/datasets/Online+Retail+II</em></a></p><p id="f752" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该零售数据集包含一家英国在线零售店在2009年12月1日至2012年12月9日之间的所有交易。该公司主要销售独特的、适合各种场合的礼品。</p><p id="91b3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">数据集中的每一行都是客户订购的单独行项目。具有相同发票号(第一列)的行项目是同一订单的一部分。InvoiceDate是购买的日期/时间，Customer ID是每个客户的唯一标识符。</p><p id="d22c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">数据快照:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lu"><img src="../Images/200403e2530347e52297aacdc9df275f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9MYj1HiQ52a35nyszkk-5A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="28c9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们主要感兴趣的是跟踪按月分组的客户保持率，换句话说，对于每个客户分组(按首次购买的月份分组)，在首次购买后的每个月中重复下单的百分比是多少？</p><h1 id="24b5" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">数据准备</h1><h2 id="614e" class="mn lw iq bd lx mo mp dn mb mq mr dp mf le ms mt mh li mu mv mj lm mw mx ml my bi translated"><strong class="ak">缺少客户id</strong></h2><p id="3027" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">数据集包含一些缺少客户ID的行。如果我们有办法知道它们代表什么，我们会<a class="ae lt" rel="noopener" target="_blank" href="/a-comprehensive-guide-to-data-imputation-e82eadc22609">估算值</a>，但不幸的是，在不了解更多业务的情况下，我们所能做的就是删除这些行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/a43149f82da0a10590c26910983d371f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDphbEkh0ZcmmLUdkW7FKA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="c179" class="mn lw iq bd lx mo mp dn mb mq mr dp mf le ms mt mh li mu mv mj lm mw mx ml my bi translated"><strong class="ak">负量</strong></h2><p id="2383" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">一些订单的数量为负；这样的订单最有可能是退货。返回并不是真正的约定，所以我们也删除了这些行。有人可能会说，我们还应该删除这些最终退货所附带的原始订单。然而:</p><ul class=""><li id="4724" class="nf ng iq kx b ky kz lb lc le nh li ni lm nj lq nk nl nm nn bi translated">我们不知道如何识别这些订单</li><li id="ac2d" class="nf ng iq kx b ky no lb np le nq li nr lm ns lq nk nl nm nn bi translated">即使我们这样做了，导致退货的订单仍然是客户的约定，因此对我们的目的有意义</li></ul><p id="4069" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了减轻这种情况，我们筛选数量&gt; 0的行的数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/3d558ad253eb089cad33548febfec7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_j-TwVxe2Fckev4Rpd-KQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="994f" class="mn lw iq bd lx mo mp dn mb mq mr dp mf le ms mt mh li mu mv mj lm mw mx ml my bi translated"><strong class="ak">汇总成订单</strong></h2><p id="5455" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">如上所述，每张发票可以有多行，因为每一行对应一个单独的项目。但是，对于合约，我们感兴趣的是分析订单，而不是订单中的单个项目。我们汇总这些项目来管理不同订单的列表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/4b3442198db4b42b7a700c479489062b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0J3oXDPipedcPEwhGIwOhQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="3d48" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">断代分析</h1><h2 id="099c" class="mn lw iq bd lx mo mp dn mb mq mr dp mf le ms mt mh li mu mv mj lm mw mx ml my bi translated">计算每个用户所属的群组</h2><p id="dd27" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">在这一部分中，我们确定了每位客户下第一笔订单的月份(即他们的群体)。</p><p id="7504" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们按发票日期的升序排序，并计算第一个订单的日期:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/8ec8a55e4f0016ba3754c1e612701a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xz2IoMFnVNnh9zxvlXC1EQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="43a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们从该日期中提取月份名称和年份，并连接这些列以形成“群组名称”列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/cab8aa61e1693873c30f75bcfad4cc0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*som2vrmwRJaZXgURZndiZQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7a6c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们将得到的数据集连接到上面的“Orders”数据集，以向其中添加“cohort name”列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/cab8aa61e1693873c30f75bcfad4cc0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*som2vrmwRJaZXgURZndiZQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="4407" class="mn lw iq bd lx mo mp dn mb mq mr dp mf le ms mt mh li mu mv mj lm mw mx ml my bi translated">生成群组分析表</h2><p id="bdea" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">接下来，对于每个订单，我们计算下订单的周期(订单月份—同期月份)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/d6a1d45b727145c71b45309512ce8676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUQdfUu4C58QtyNdFI0X5w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1c9c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">生成的输出如下所示(注意末尾的period列):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/77010f6d16dff77c36b2f92b168ecbbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHId767ocTRRXQTDWkyyAQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="c777" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们透视我们的表以生成群组分析报告，其中每行是一个单独的群组，每列显示随后几个月的保留情况。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/07843590672e3ecbe7f25b5dbf8f324a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VcWG-66u6ets873Ax4XR7w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="b303" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在对列和行进行快速排序后，我们得到了群组分析表</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/d8bc988f1623f439bc6ecfd4160c8726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WHdvnmUSiPGXZw6aZL2CLQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="77f0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这向我们展示了每个月每个群体中的回头客数量。但是，为了将这些值转换成百分比，我们将每一列除以第一列，然后乘以100。</p><h1 id="e74a" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">生成热图</h1><p id="7d5a" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">最后，我们将表格转换成热图，以快速识别模式。右边的图例告诉我们，盒子越接近红色，保留值越高(越热)，反之亦然，保留值越低的盒子越接近蓝色。</p><p id="4559" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">大约一半的方块是蓝色的，因为我们还没有这些群体的数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/ea0e3de5d78fa7acda94fd5f7e521299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bpyw5kO4wzlkvAk8AN7cMA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="705a" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">有趣的见解</h1><p id="421d" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">马上，我们注意到2010年12月的队列包含了第11个月的高回报(大概对应于第二年的假期)。我们在每个队列中都看到类似的峰值，但是没有一个像第一个队列那么高。这批人有什么特别之处吗？也许，这群人本质上由假日购物者组成，他们更倾向于在每个假日季节回来！</p><p id="a9ea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想让用户/顾客再次光顾你的生意，你必须定期研究他们的群体和习惯。</p></div></div>    
</body>
</html>