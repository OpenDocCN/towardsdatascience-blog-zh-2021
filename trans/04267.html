<html>
<head>
<title>Pandas Data Wrangling Cheat Sheet 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据争论备忘单2021</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-data-wrangling-cheat-sheet-2021-cf70f577bcdd?source=collection_archive---------7-----------------------#2021-04-11">https://towardsdatascience.com/pandas-data-wrangling-cheat-sheet-2021-cf70f577bcdd?source=collection_archive---------7-----------------------#2021-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a165684a89997a381011bdb38c999f7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wxRYfybq8pLPoe7PBTATA.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@kobuagency?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> KOBU机构</a>在<a class="ae kc" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2179" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要想超越<strong class="kf ir">数据分析</strong> / <strong class="kf ir">数据科学</strong> / <strong class="kf ir">机器学习</strong>在Python中，<strong class="kf ir">熊猫</strong>是你需要掌握的库。这里有一个<strong class="kf ir">备忘单</strong>是一些你可能不想错过的最常用的语法。</p><p id="36e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Pandas包是当今使用Python进行数据科学和分析的最必要的工具。强大的机器学习和迷人的可视化工具可能已经吸引了你的注意力，然而，如果你在<strong class="kf ir">熊猫</strong>中没有良好的技能，你将不会走得很远。</p><p id="2fd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以今天我收集了一些最常用的熊猫基本功能供你参考。我将从创建数据帧开始，然后是数据整形、字符串查找、值排序等。</p><h1 id="27a5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">内容</h1><ol class=""><li id="70cb" class="lz ma iq kf b kg mb kk mc ko md ks me kw mf la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#a90d" rel="noopener">数据帧创建</a></li><li id="a8dd" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#5ee8" rel="noopener">列重命名</a></li><li id="dc76" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#33e7" rel="noopener">数据插入</a></li><li id="c2b0" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#2f39" rel="noopener">数据删除</a></li><li id="643e" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#838c" rel="noopener">处理空值</a></li><li id="9a45" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#0f83" rel="noopener">整形</a></li><li id="da33" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#6e1a" rel="noopener">基础数据观察</a></li><li id="4ec2" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated"><a class="ae kc" href="https://medium.com/p/cf70f577bcdd#08ca" rel="noopener">查询/检索数据</a></li><li id="988a" class="lz ma iq kf b kg mk kk ml ko mm ks mn kw mo la mg mh mi mj bi translated">奖励:处理大数据:</li></ol></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="a90d" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">数据帧创建</h1><p id="79e3" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">我相信有必要提一下熊猫数据框架的基本结构。说到数据，在大多数情况下，你会有变量和变量的观察值。在Pandas中，每个变量存储为一列，而与该变量相关的所有观察值存储为行。例如，如果你对一个变量A有20个观察值，那么在Pandas中，它将被表示为包含20行数据的“A列”。</p><p id="096b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了，我们开始吧！</p><ul class=""><li id="334d" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">创建空数据框</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="2dde" class="nr lc iq nn b gy ns nt l nu nv">import pandas as pd<br/># These are the 3 basic territories in Hong Kong. They are Hong Kong, Kowloon, and the New Territories.</span><span id="53c3" class="nr lc iq nn b gy nw nt l nu nv">col=[‘香港’,’九龍’,’新界’]</span><span id="8662" class="nr lc iq nn b gy nw nt l nu nv">df = pd.DataFrame(columns=col)<br/>df</span></pre><p id="4bdf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">退货:</p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/e020202ae894873ea51fa02c65ddc2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Sp26FU6EREHpgUwfqVWp_Q.jpeg"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">一个空列表。</p></figure><ul class=""><li id="9c48" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated">使用列表创建数据框架。</li></ul><p id="408a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就个人而言，我更喜欢以这种方式创建数据框架。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="4791" class="nr lc iq nn b gy ns nt l nu nv">col=[‘香港’,’九龍’,’新界’]<br/>ind=[1990,2000,2010]<br/>Data= [[‘98731’,’34444',’99384'],[‘34323’,’44243',’88543'],[‘2222’,’4324',’3432']]</span><span id="d571" class="nr lc iq nn b gy nw nt l nu nv">df = pd.DataFrame(Data, columns=col, index=ind)<br/>df</span></pre><p id="421a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">退货:</p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/78f03ac0876fdd86809235dbaecc497e.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*W_ysmUsSrsB2IEkbAVfBqQ.jpeg"/></div></figure><ul class=""><li id="a423" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated">使用字典创建数据框架。</li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="e6e5" class="nr lc iq nn b gy ns nt l nu nv">Data= {‘A’:[98731,34444,99384],‘B’:[34323,44243,88543],‘C’:[2222,4324,None]}</span><span id="a2cd" class="nr lc iq nn b gy nw nt l nu nv">df = pd.DataFrame(Data)<br/>df</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/53a8e7143e681f4e984d3e083cc43d94.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*SdhFPpq4NE_mYGM3BUI-LQ.jpeg"/></div></figure><p id="2590" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">熊猫用“无”代表空值。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="5ee8" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">重命名列</h1><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="cac3" class="nr lc iq nn b gy ns nt l nu nv">df = df.rename(columns={“A”:”香港”})</span><span id="3032" class="nr lc iq nn b gy nw nt l nu nv">df</span></pre><p id="2d1b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">退货:</p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/bb27e4ee200cb82fe2c6f49e4052e181.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*TPMMwSNjeXcvDQ80jgX-ZA.jpeg"/></div></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="33e7" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">插入</h1><ul class=""><li id="0b46" class="lz ma iq kf b kg mb kk mc ko md ks me kw mf la nh mh mi mj bi translated"><strong class="kf ir">列插入</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="b5f2" class="nr lc iq nn b gy ns nt l nu nv"># inserting column D</span><span id="d858" class="nr lc iq nn b gy nw nt l nu nv">d = [“x”,”y”,”z”]</span><span id="99d8" class="nr lc iq nn b gy nw nt l nu nv">df[“D”] = d<br/>df</span></pre><p id="2e33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">退货:</p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7ad5e08cd79167af5b352e954440dc67.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*mi6N73pl_CaO51aXJmlvQQ.jpeg"/></div></figure><ul class=""><li id="c50e" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">行插入</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="2050" class="nr lc iq nn b gy ns nt l nu nv"># inserting the 4th row</span><span id="eebf" class="nr lc iq nn b gy nw nt l nu nv">new_row = {“A”:98989,”B”:77889, “C”:None, “D”:”z”}</span><span id="0224" class="nr lc iq nn b gy nw nt l nu nv">df = df.append(new_row, ignore_index=True)<br/>df</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/63d281fd7cd138b56f89801ae42366e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*wBHpHy5PfOwVEYj3NSinbQ.jpeg"/></div></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="2f39" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">删除</h1><ul class=""><li id="ff8f" class="lz ma iq kf b kg mb kk mc ko md ks me kw mf la nh mh mi mj bi translated"><strong class="kf ir">降一列</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="74cc" class="nr lc iq nn b gy ns nt l nu nv"># to drop several columns, you can use a list. <br/># E.g. df.drop(["C","B"],axis=1)<br/># to make permanent change, add inplace=True<br/># dropping column C only</span><span id="c059" class="nr lc iq nn b gy nw nt l nu nv">df.drop(“C”,axis=1)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/df5bcae2a295bd35f55455aacf736467.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*tNRyiK50kILbOXnNPstE1w.jpeg"/></div></figure><ul class=""><li id="32ab" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">降一排</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="9140" class="nr lc iq nn b gy ns nt l nu nv"># to make permanent change, inplace=True<br/># dropping a row with index "0"</span><span id="03fc" class="nr lc iq nn b gy nw nt l nu nv">df.drop(0)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/be133d69736f0cdff92d7f43078f2a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*dGY5Q1VIEgs60VN-sGsQAQ.jpeg"/></div></figure><ul class=""><li id="2269" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">删除重复项</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="1b78" class="nr lc iq nn b gy ns nt l nu nv">df.drop_duplicates()</span></pre><p id="e13d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的df数据帧保持不变，因为这里没有副本。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="838c" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">处理空值</h1><p id="f028" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">通常，我们的数据中有空值。通常，我们要么去掉那些空值，要么用一些其他有意义的值来代替，例如列的平均值。</p><ul class=""><li id="603a" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">检出空值</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="596e" class="nr lc iq nn b gy ns nt l nu nv">pd.isnull(df)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/95666a5afac55f2d79cd241f4dae4671.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*fiumUBgGhG5TfxEeR-35Yg.jpeg"/></div></figure><p id="ea95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到c列中有两个空值。</p><ul class=""><li id="2361" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">水平定位空值</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="0778" class="nr lc iq nn b gy ns nt l nu nv"># checking horizontally, from Col A to D</span><span id="aeee" class="nr lc iq nn b gy nw nt l nu nv">pd.isnull(df).any(axis=0)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/e031b72151fe5f7fd90549ef74bfa70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*fkLSmvKmnx_AnacRvMN9vA.jpeg"/></div></figure><ul class=""><li id="b3e5" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">垂直定位空值</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="c074" class="nr lc iq nn b gy ns nt l nu nv"># checking vertically, from index 1 to 4</span><span id="b029" class="nr lc iq nn b gy nw nt l nu nv">pd.isnull(df).any(axis=1)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/f77155b81aa2191d560d3ddc5e149506.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*Tj6mz5pSovTIBLNJW6OptQ.jpeg"/></div></figure><ul class=""><li id="099d" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">用一些有意义的值填充所有NaN</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="9972" class="nr lc iq nn b gy ns nt l nu nv">df2 = df.copy()</span><span id="a673" class="nr lc iq nn b gy nw nt l nu nv">df3 = df2<strong class="nn ir">.fillna(0)</strong> # fill with 0</span><span id="8781" class="nr lc iq nn b gy nw nt l nu nv">df4 = df2.fillna(df<strong class="nn ir">.mean()</strong>) # fill with the mean of the column</span><span id="f60f" class="nr lc iq nn b gy nw nt l nu nv">df5 = df2.fillna(df<strong class="nn ir">.B.max()</strong>) # fill with the max of colum B</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/8ef1aa2c1d4f08e39f0ec322e7a33c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*czL92vlDGkLeH1b4jbUkcg.jpeg"/></div></figure><p id="959e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，用自己列的平均值填充C列中的NaN值似乎是最合理的。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="0f83" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">重塑</h1><p id="05df" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">数据科学家必须处理的另一个常见问题是数据的形状。由于不同的机器学习模型有不同的数据形状要求，所以我们必须根据模型的要求对数据进行整形。例如，我最喜欢的LSTM模型接受三维数据，因此我们需要将大多数二维数据集转换为三维数据集。</p><ul class=""><li id="dbba" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">将所有列合并成一列</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="f44a" class="nr lc iq nn b gy ns nt l nu nv"># gather all columns, and all observations into one column</span><span id="65f0" class="nr lc iq nn b gy nw nt l nu nv">pd.melt(df2)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/7f73fd26db9d9d3d24656974489e3ac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*O7dFUbLXCK49_0FyJsL5mQ.jpeg"/></div></figure><ul class=""><li id="abd1" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">串联—堆叠</strong></li></ul><p id="394f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这类似于SQL语法中的UNION ALL。它堆叠具有相同列名的值。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="a9f0" class="nr lc iq nn b gy ns nt l nu nv"># similar to UNION ALL in SQL</span><span id="b707" class="nr lc iq nn b gy nw nt l nu nv">pd.concat([df,df]) # join vertically</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/cc742d6c33ba43bc822ee218e24c0883.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*dxWb1cPc79VVi3lWdMm_Ng.jpeg"/></div></figure><ul class=""><li id="1e3c" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">并排拼接</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="55d5" class="nr lc iq nn b gy ns nt l nu nv"># join horizontally</span><span id="6383" class="nr lc iq nn b gy nw nt l nu nv">pd.concat([df,df], axis=1)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/877bdeb3ffff63e3ff0d363a8d45a0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*KzHjioo6mgNOcPZclWQ7fg.jpeg"/></div></figure><ul class=""><li id="5656" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">分组依据</strong></li></ul><p id="16bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一种非常流行的技术，出现在许多计算机语言中。在下面的例子中，我们按照D列中的字母对数据进行分组，在b列中只显示每个数据的总和值。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="4ae7" class="nr lc iq nn b gy ns nt l nu nv"># SELECT B, SUM(B) FROM df GROUP BY D ORDER BY B</span><span id="646a" class="nr lc iq nn b gy nw nt l nu nv">df.groupby(“D”)[“B”].sum()</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/11c0e92b9af99efcaaf63352907a1da9.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*Vpe-XQuuuHwiyNbEdNt70A.jpeg"/></div></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="6e1a" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">基础数据观察</h1><p id="0e15" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">在所有的数据管理和转换之后，是时候检查我们做了什么。</p><ul class=""><li id="e329" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">打印前几行</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="9ae5" class="nr lc iq nn b gy ns nt l nu nv"># the default is 5 if you leave the bracket empty<br/># we are showing the first 3 rows only</span><span id="e445" class="nr lc iq nn b gy nw nt l nu nv">df.head(3)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/3ca08fe025b5b2af322459dae4935d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*3i3FB2rQQV3MWGIKSaRA7w.jpeg"/></div></figure><ul class=""><li id="d574" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">打印最后几行</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="b0bd" class="nr lc iq nn b gy ns nt l nu nv"># the default is 5 if you leave the bracket empty<br/># we are showing the last 2 rows only</span><span id="d238" class="nr lc iq nn b gy nw nt l nu nv">df.tail(2)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/bf8e049e4dab68a457d11ea3d92fbff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*DlLApl9Vv_XQ1QbE7P02Ow.jpeg"/></div></figure><ul class=""><li id="54de" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">随机打印几行</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="bf91" class="nr lc iq nn b gy ns nt l nu nv"># randomly sampling only 50% of the data set</span><span id="074d" class="nr lc iq nn b gy nw nt l nu nv">df.sample(frac=0.5)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/995d9e038ae9c04dff5226e4775bac88.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*L1CpuYAOfotIgKiSMwTKEw.jpeg"/></div></figure><ul class=""><li id="20af" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated">打印数据帧的简明摘要。</li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="76eb" class="nr lc iq nn b gy ns nt l nu nv">df.info()</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/aaf9520f9c7a2cf0c7954ed9d13d5cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*VSlbHy4hr0bwgLsCX6GrMw.jpeg"/></div></figure><ul class=""><li id="5098" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">生成描述性统计</strong></li></ul><p id="ac5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个方便而简单的方法，可以直观地定位哪些变量有异常值。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="a4be" class="nr lc iq nn b gy ns nt l nu nv"># only describing the numerical columns. Column D is a string column, so nothing is shown.</span><span id="8de3" class="nr lc iq nn b gy nw nt l nu nv">df.describe()</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/7ff34b519eaa3fc33f37fa20aa4cab61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*uhGaqV1mbLf6jpNmmz3v9w.jpeg"/></div></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="08ca" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">查询/检索数据</h1><p id="ad13" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">在得到我们需要的数据帧的形状/形式后，我们将希望从数据中检索信息。查询功能是Pandas中最常用的数据检索功能之一。</p><ul class=""><li id="2732" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">排序</strong></li></ul><p id="ca78" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">熊猫也有一些SQL的特征。在排序中，默认值是升序，这类似于SQL在中的顺序。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="b6c1" class="nr lc iq nn b gy ns nt l nu nv"># sort values according to Hong Kong<br/># default is ascending</span><span id="f4fd" class="nr lc iq nn b gy nw nt l nu nv">df.sort_values(“香港”, ascending=False)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oq"><img src="../Images/89f0622a3446dc27d033cc7ecfb930de.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*SQr1boIJ1wc4bdCeIsAJxQ.jpeg"/></div></div></figure><ul class=""><li id="3474" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">复位索引</strong></li></ul><p id="dca2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很多时候，在排序之后，我们必须将索引重置为行号。这是它的语法。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="1d23" class="nr lc iq nn b gy ns nt l nu nv">df.reset_index()</span></pre><ul class=""><li id="e2a4" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">一个条件</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="a16f" class="nr lc iq nn b gy ns nt l nu nv"># returns a dataframe with one condition, which is B has to be bigger than or equal 50000</span><span id="3f47" class="nr lc iq nn b gy nw nt l nu nv">df.query(“B &gt;= 50000”)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/c0f985c20826b244e5f7375d33049d1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*wfdVvgC41Kj3myTZVOvdiw.jpeg"/></div></figure><p id="f6e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的语法产生相同的结果，只是检索方式不同。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="44bd" class="nr lc iq nn b gy ns nt l nu nv">df[df[“B”]&gt;=50000]</span></pre><p id="d591" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的代码只检索列C，而不是打印整个数据帧。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="5e02" class="nr lc iq nn b gy ns nt l nu nv">df.C[df[“B”]&gt;=50000]</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/cc34a8ffbe4411b61fb583af65f6ce1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*wnkQLXvluq70HqMumlUsmA.jpeg"/></div></figure><p id="e829" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">只打印了C列的2行。</p><ul class=""><li id="0608" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">多个条件—“与”</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="4653" class="nr lc iq nn b gy ns nt l nu nv"># returns a dataframe with 2 conditions, which are B has to be bigger than or equal 50000, <strong class="nn ir">and</strong> “香港” has to be smaller than 99000.</span><span id="9ad8" class="nr lc iq nn b gy nw nt l nu nv">df[(df[“B”]&gt;=50000) &amp; (df[“香港”] &lt; 99000)] # no and</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/ba0d55bc3f394668dc47c3458c4b087b.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*lX5cDBKrCEBeUlcDDBTfeg.jpeg"/></div></figure><ul class=""><li id="9513" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">多个条件—“或”</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="6b14" class="nr lc iq nn b gy ns nt l nu nv"># returns a dataframe with 2 conditions, which are B has to be bigger than or equal 50000, <strong class="nn ir">or</strong> “香港” has to be smaller than 49000.</span><span id="c3bb" class="nr lc iq nn b gy nw nt l nu nv">df[(df["B"]&gt;=50000) | (df["香港"] &lt; 49000)] # no or</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/7044ba2256a09dd69929c109a9f98341.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*q9L_Tnqn9L8w3Nj68_M3Lg.jpeg"/></div></figure><ul class=""><li id="780b" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">串串</strong></li></ul><p id="a20c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要在数据集中查找字符串，我们可以使用“str.find()”或“str.contains()”。“str.find()”方法返回一个整数值。如果子字符串存在于字符串中，则返回子字符串第一个匹配项的索引。如果字符串中不存在substring，则返回-1。</p><p id="6922" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于str.contains，它返回布尔值True或False。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="5b2a" class="nr lc iq nn b gy ns nt l nu nv"># Within column D, check if "z" exits.</span><span id="dc33" class="nr lc iq nn b gy nw nt l nu nv">print(df[“D”].str.find(“z”))</span><span id="face" class="nr lc iq nn b gy nw nt l nu nv">print(df[“D”].str.contains(“z”,case=False))</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/c8742331898c138823d4b3713dc69677.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*sfSU5q_6-Hxpjylk3I6gqw.jpeg"/></div></figure><ul class=""><li id="47bf" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">用loc和iloc选择数据</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="e91a" class="nr lc iq nn b gy ns nt l nu nv"># return the entire roll<br/># with a conditional statement<br/>df.loc[df['D'] == 'z']</span><span id="2597" class="nr lc iq nn b gy nw nt l nu nv"># return the entire first roll<br/>df.loc[0]</span><span id="afc5" class="nr lc iq nn b gy nw nt l nu nv"># select one specific value row label and column label<br/>df.loc[0, "D"]</span><span id="9fff" class="nr lc iq nn b gy nw nt l nu nv"># select specific value row index and column index<br/>df.iloc[0,3]</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/ebd45c0dceee993c536a015287e00c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*3PLEqMB_FKxKIghDMjhYFQ.jpeg"/></div></figure><ul class=""><li id="199c" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">用正则表达式查询</strong></li></ul><p id="0cd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">熊猫中有很多支持regex的原生函数，分别是count()、replace()、contains()、extract()、findall()、match()、split()和rsplit()。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="2f46" class="nr lc iq nn b gy ns nt l nu nv"># searching for rows with single letter in D column.</span><span id="46c0" class="nr lc iq nn b gy nw nt l nu nv">df[df[‘D’].str.contains(r’[a-z]+’)] # \D</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/b4dc5075d20f46ef39423b177f562b03.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*BVb_1BfNsREomtKUtLfXxQ.jpeg"/></div></figure><p id="72fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回整个数据帧，因为D列中的所有变量都是字母。</p><ul class=""><li id="7db7" class="lz ma iq kf b kg kh kk kl ko ne ks nf kw ng la nh mh mi mj bi translated"><strong class="kf ir">最大和最小</strong></li></ul><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="0856" class="nr lc iq nn b gy ns nt l nu nv"># Return numbers of rows with the largest and smallest</span><span id="c4dc" class="nr lc iq nn b gy nw nt l nu nv">df.nlargest(2, “B”)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/6882a0d0b460053188d05858953bb0a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*QlGY0QevgQyHo4wFhbxZ8A.jpeg"/></div></figure><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="82b6" class="nr lc iq nn b gy ns nt l nu nv"># Return 2 rows with the smallest number in column B</span><span id="8ad0" class="nr lc iq nn b gy nw nt l nu nv">df.nsmallest(2, “C”)</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/b614e93d8bef194e978e89e2f157c843.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*R5RIh6iRMYqbia0GraEtZw.jpeg"/></div></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="786b" class="lb lc iq bd ld le mw lg lh li mx lk ll lm my lo lp lq mz ls lt lu na lw lx ly bi translated">奖励:处理大数据:</h1><p id="afb7" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">Microsoft Excel只能很好地处理1000行数据而不会滞后。但是，如果数据集超过10k行，它将经常冻结。对于Python熊猫来说，它处理100万行没有任何问题(至少我的经验是这么告诉我的，我的设备只是一台16GB ram的旧Macbook Pro)。大数据呢？数据大小大于1GB怎么办？或者数据文件太大，根本无法加载到内存中？当然你可以用Dask，或者Vaex，但是这次我们还是用熊猫。</p><p id="81bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于Pandas中的大数据，我们将使用<strong class="kf ir"> chunksize </strong>在任何给定时间只将文件的一部分加载到内存中。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="1c17" class="nr lc iq nn b gy ns nt l nu nv"><strong class="nn ir">df = pd.read_csv(’data.csv’, chunksize=10000)</strong></span></pre></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="5180" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太好了！现在我们刚刚快速复习了熊猫的基本操作，我希望这个小抄能让你在处理熊猫的数据帧时更有信心。</p><p id="f716" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了便于修改，我把上面提到的所有内容都放在了一个Jupyter笔记本文件中。请放心下载:<a class="ae kc" href="https://positivehk.com/wp-content/uploads/2021/04/Data-Wrangling.ipynb_.zip" rel="noopener ugc nofollow" target="_blank">熊猫数据扯皮小抄2021修订文件</a>。</p><p id="f524" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可能也会对这篇文章感兴趣:<a class="ae kc" rel="noopener" target="_blank" href="/fundamental-marketing-analytics-f875018391d5?source=your_stories_page-------------------------------------">基础营销分析</a></p><p id="de5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">非常感谢您阅读我的文章，我一直在为数字营销、数据分析、分析和Python写作。请点击下面的链接来看看。</p><p id="2b4c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://elartedm.com/marketing-blog/" rel="noopener ugc nofollow" target="_blank">数字营销</a>:<a class="ae kc" href="https://elartedm.com/marketing-blog/" rel="noopener ugc nofollow" target="_blank">https://elartedm.com/marketing-blog/</a></p><p id="982b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://positivehk.com/category/專欄/digital-marketing-blog/" rel="noopener ugc nofollow" target="_blank">另一个数字营销和机器学习</a>:【https://positivehk.com/category/%E5%B...】T2</p><p id="248d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据科学:【https://lorenzoyeung-io.medium.com/ T4】</p></div></div>    
</body>
</html>