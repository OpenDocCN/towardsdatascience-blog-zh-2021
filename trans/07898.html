<html>
<head>
<title>Studying up for the Tokyo 2021 Olympics with SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用SQL为2021年东京奥运会做准备</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/studying-up-for-the-tokyo-2021-olympics-with-sql-719a0ae3779b?source=collection_archive---------4-----------------------#2021-07-20">https://towardsdatascience.com/studying-up-for-the-tokyo-2021-olympics-with-sql-719a0ae3779b?source=collection_archive---------4-----------------------#2021-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="46dd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python查询PostgreSQL数据库，用Pandas显示结果，用Matplotlib可视化</h2></div><p id="db04" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我比以往任何时候都更希望自己是一名职业运动员，处于人生中最好的状态，为2021年东京奥运会做好准备。但是，当我用枕头、毯子和非蔬菜小吃在沙发上摆好位置时，我没有为自己感到难过，而是认为这将是一个应用我的一些SQL知识(对Udemy和Coursera大喊)并从历史奥运数据集中学习一两件事的合适时机。四年——嗯，现在是五年——是一段很长的时间。客观地说，在去年夏季奥运会的时候，我以前从未编写过代码，对数据科学几乎是零接触。在这段时间里，我们很难在观看奥运会的时候保持正确的心态。我知道我个人只是盯着屏幕，对展示的难以想象的运动能力感到敬畏。不过，这次不会了！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/df130f10f9859fbf4d5f7edf4b2230e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9dnyWfl-K4B4qb-7ch8P3Q.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">来源:<a class="ae lu" href="https://unsplash.com/photos/ZIoi-47zV88" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/ZIoi-47zV88</a>作者@kfdias</p></figure><p id="f325" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个项目的动机是询问和<em class="lv">回答</em>关于奥运会如何随着时间的推移而演变的问题，包括关于女性的参与和表现、不同运动项目和不同国家的运动员体格(即身高、体重、年龄)的差异，以及通过获得的奖牌数证明的不同国家在奥运会上的主导地位。</p><p id="9e06" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将使用现代奥运会的历史数据集，包括从1896年雅典到2016年里约的所有奥运会(夏季和冬季)。来源是从www.sports-reference.com<a class="ae lu" href="http://www.sports-reference.com/" rel="noopener ugc nofollow" target="_blank">刮来的</a>，并作为<a class="ae lu" href="https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results" rel="noopener ugc nofollow" target="_blank"> Kaggle数据集</a>发布(感谢Kaggle用户<a class="ae lu" href="https://www.kaggle.com/heesoo37" rel="noopener ugc nofollow" target="_blank"> rgriffin </a>)。如果您想继续，您将需要下载该数据集中的两个可用文件:athlete_events.csv和noc_regions.csv。大部分数据包含在前者中，但后者将有助于在我们的数据表上执行SQL连接，并获得国家/地区名称，而不是国家奥委会的3个字母代码。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lw"><img src="../Images/8f54ec8953899d1e5d824364937d24f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0wzqZnutt6p0gzGrQ3cdg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">Kaggle数据集的屏幕截图</p></figure><p id="d28d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用的数据属性包括:id、姓名、性别、年龄、身高、体重、团队、noc、比赛、年份、赛季、城市、运动、事件、奖牌。注意，有几个“NA”值代表缺失的数据，因此唯一包含纯整数的列是year列。还要注意的是，虽然奥运会现在每两年在夏季和冬季运动之间交替举行，但情况并不总是如此，这就是为什么季节栏会很有用。</p><p id="6adc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个循序渐进的教程中，我将带您了解不同类型的SQL查询，这些查询的难度和复杂性各不相同。至于在编码环境中进行设置，您需要确保在本地机器上安装了PostgreSQL和PgAdmin。如果您还没有安装这些工具，并且需要帮助，请参考本文末尾的参考资料部分。接下来，您将希望通过本地主机启动一个服务器。您可以通过psql命令行或通过PgAdmin来实现这一点。默认端口可能是5432。我将我的服务器命名为“playground ”,但是服务器的名称并不重要。请确保您记住了数据库的名称和用户名，因为我们稍后会用到它们。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lx"><img src="../Images/103119eade261bde1fe5d9bcf725c4de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*146Hfx_4bwA01L6H27vm9g.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">PostgreSQL服务器配置的屏幕截图</p></figure><p id="e078" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了编写Python代码，您还需要导航到您喜欢的代码编辑器。为了获得最愉快的体验，我建议跳到一个空白的Jupyter笔记本上。在您的Python环境中，确保您安装了以下包:<a class="ae lu" href="https://pypi.org/project/psycopg2/" rel="noopener ugc nofollow" target="_blank"> psycopg2 </a>、<a class="ae lu" href="https://pypi.org/project/pandas/" rel="noopener ugc nofollow" target="_blank">熊猫</a>和<a class="ae lu" href="https://pypi.org/project/matplotlib/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>。</p><p id="174b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在笔记本的第一个单元格中，粘贴以下导入内容:</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="3d47" class="md me it lz b gy mf mg l mh mi">import psycopg2<br/>import pandas.io.sql as sqlio<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns # optional<br/>plt.style.use('ggplot') # optional</span></pre><p id="2be9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们必须做的第一件事是使用psycopg2库建立到PostgreSQL数据库的连接。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mj mk l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">使用psycopg2方法创建到数据库的连接，创建表，并将数据复制到表中</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ml"><img src="../Images/7730e911804e45915f0086c8da689966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Yn1HRL2OfndWhtZ4mzuCg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">从执行的SQL查询中取出一个结果</p></figure><p id="11f0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">既然我们所有的数据都位于我们的两个关系数据库表中，我们应该能够用一个简单的select语句来访问它。然而，psycopg2库的一个不太理想的方面是，以可理解的格式查看结果集有点困难。</p><p id="363d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然cursor类允许我们通过迭代或使用<code class="fe mm mn mo lz b"><a class="ae lu" href="https://www.psycopg.org/docs/cursor.html#cursor.fetchone" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">fetchone()</strong></a></code>、<code class="fe mm mn mo lz b"><a class="ae lu" href="https://www.psycopg.org/docs/cursor.html#cursor.fetchmany" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">fetchmany()</strong></a></code>和<code class="fe mm mn mo lz b"><a class="ae lu" href="https://www.psycopg.org/docs/cursor.html#cursor.fetchall" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">fetchall()</strong></a></code>等方法从数据库中检索数据，但如果能够以表格格式查看数据，那就更好了。</p><p id="435b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">幸运的是，<code class="fe mm mn mo lz b">pandas.io.sqlio</code>类允许我们这样做。具体来说，<code class="fe mm mn mo lz b"><a class="ae lu" href="https://pandas.pydata.org/pandas-docs/version/0.16.0/generated/pandas.read_sql_query.html?highlight=read_sql_query#pandas.read_sql_query" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">read_sql_query()</strong></a></code>方法有两个参数:要执行的SQL查询和到数据库的连接。然后，它返回一个包含结果集的pandas DataFrame。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mp"><img src="../Images/9113823308d288c28e38041f67127a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phK09UufNAJjCXziTfthJA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">从olympics数据表中选择所有列，并使用sqlio.read_sql_query()显示结果</p></figure><p id="6ae9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好多了！现在我们知道了如何查询数据集和查看结果，让我们进入更高级的内容。在接下来的探索中，我将遵循以下每个子主题的结构:</p><ol class=""><li id="6b63" class="mq mr it kk b kl km ko kp kr ms kv mt kz mu ld mv mw mx my bi translated">研究问题</li><li id="4fca" class="mq mr it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">SQL查询</li><li id="87cb" class="mq mr it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">表格或可视化(如果适用)</li><li id="9310" class="mq mr it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">答案/结论/发现</li></ol></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="37b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们希望在处理数据时对数量级有一个高层次的理解时，<code class="fe mm mn mo lz b">COUNT</code>和<code class="fe mm mn mo lz b">DISTINCT</code>函数就派上了用场。<code class="fe mm mn mo lz b">COUNT()</code>是一个内置函数，用于检索符合查询条件的行数。<code class="fe mm mn mo lz b">DISTINCT</code>是用于从结果集中删除重复值的运算符。</p><h2 id="49d8" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">有几个队？</h2><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="b5dc" class="md me it lz b gy mf mg l mh mi">SELECT COUNT(DISTINCT noc) FROM olympics</span></pre><p id="9bc4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">甲:230英镑</p><h2 id="c487" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">有多少种运动？</h2><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="7e2d" class="md me it lz b gy mf mg l mh mi">SELECT COUNT(DISTINCT sport) FROM olympics</span></pre><p id="a9aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">甲:66</p><h2 id="e44c" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">有多少个项目？</h2><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="5249" class="md me it lz b gy mf mg l mh mi">SELECT COUNT(DISTINCT event) FROM olympics</span></pre><p id="51b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">甲:765</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="43f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面的查询使用了<code class="fe mm mn mo lz b">WHERE</code>谓词，它限制了结果集，评估为真、假或未知。您还将看到正在使用的<code class="fe mm mn mo lz b">ORDER BY</code>操作符，它根据列值对结果集中的行进行排序，可以是升序，也可以是降序(默认情况下SQL使用升序)。最后，<code class="fe mm mn mo lz b">LIMIT</code>操作符用于将我们的结果集限制在前N行。</p><h2 id="5e03" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">有史以来参加比赛的最年轻的前5名运动员是谁？</h2><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="649b" class="md me it lz b gy mf mg l mh mi">SELECT DISTINCT name, CAST(age AS INTEGER), sport, event, noc, games, city, medal FROM olympics<br/>WHERE age &lt;&gt; 'NA'<br/>ORDER BY age<br/>LIMIT 5</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oc"><img src="../Images/8e5c0f3c2c18043bb43a55aff3f40d60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f1OKEfex6Syd2_XMUhSftg.png"/></div></div></figure><p id="e88e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">哇哦。我不知道你是怎么想的，但是在我10岁的时候，我嚼着金鱼饼干，试图通过我五年级的拼写测试，却没有在雅典赢得体操铜牌。帮你自己一个忙，如果你想看有史以来参加比赛的最年轻运动员的漂亮的棕褐色照片，谷歌一下“迪米特里奥斯·伦德拉”。</p><h2 id="294b" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">参加过奥运会的年龄最大的前5名运动员是谁？</h2><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="708d" class="md me it lz b gy mf mg l mh mi">SELECT DISTINCT name, CAST(age AS INTEGER), sport, event,noc, games, city, medal FROM olympics<br/>WHERE age &lt;&gt; 'NA'<br/>ORDER BY age <strong class="lz iu">DESC</strong><br/>LIMIT 5</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi od"><img src="../Images/919da3a0e313d658862514450a855d92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FL2KAek04G2Tm5BuOrzRgw.png"/></div></div></figure><p id="e306" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">约翰·昆西·亚当斯·沃德以97岁高龄参加了1928年夏季奥运会。虽然在那个年龄还活着并且身体健康令人印象深刻，但在前面的陈述中有一个星号，因为这5名年龄最大的运动员都参加了“艺术比赛”，而不是更具竞争性、体力消耗大的运动。1912年至1948年间，艺术比赛是奥运会的一部分。建筑、文学、音乐、绘画和雕塑都获得了奖牌。</p><p id="28ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于它们不再是奥运会的一部分，让我们来完善我们的搜索。实际上有两种方法可以做到这一点:</p><ol class=""><li id="229e" class="mq mr it kk b kl km ko kp kr ms kv mt kz mu ld mv mw mx my bi translated">通过增加一个<code class="fe mm mn mo lz b">WHERE</code>条款，将“艺术比赛”排除在兴趣运动之外</li></ol><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="47f7" class="md me it lz b gy mf mg l mh mi">SELECT DISTINCT name, CAST(age AS INTEGER), sport, noc, games, city FROM olympics<br/>WHERE age &lt;&gt; 'NA' AND sport &lt;&gt; 'Art Competitions'<br/>ORDER BY age DESC<br/>LIMIT 5</span></pre><p id="8a5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.使用子查询来指定我们希望结果集包含截至2014年仍处于活动状态的sport</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="78dc" class="md me it lz b gy mf mg l mh mi">SELECT DISTINCT name, CAST(age AS INTEGER), sport, noc, games, city FROM olympics<br/>WHERE age &lt;&gt; 'NA' AND sport IN (SELECT DISTINCT sport FROM olympics WHERE year &gt;= 2014)<br/>ORDER BY age DESC<br/>LIMIT 5</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oe"><img src="../Images/c87a65b4f05656edd690a4b9debf173c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rTjgdVnjxIkLr27Wn-HCbA.png"/></div></div></figure><p id="cdb7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">两种方法产生相同的结果！原来我们新的最老的运动员是一位来自奥地利的72岁的马术运动员。尽管Aurthur von(插入非常长的姓氏)早在1936年就参加了比赛，但老年比赛似乎在马术比赛中仍然很常见(见第四行)。</p><h2 id="e950" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">有史以来参加比赛的最重的前5名运动员是谁？</h2><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="7a79" class="md me it lz b gy mf mg l mh mi">SELECT DISTINCT name, CAST(weight AS DECIMAL), sport, event, noc, games, city, medal FROM olympics<br/>WHERE weight &lt;&gt; 'NA'<br/>ORDER BY weight DESC<br/>LIMIT 5</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi of"><img src="../Images/694e1809c736119f074f29e7430012c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JWT6a-ayBHQHdRCPdmGX5A.png"/></div></div></figure><p id="ffb7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">重量级男子柔道和超重量级男子摔跤是最重运动员参加的运动，这并不奇怪。这里，重量以千克为单位。对于美国人来说，214公斤相当于472磅。你可能还想谷歌一下“小里卡多·布拉斯”来获得完整的效果！对身高和体重的研究让我想起了体育运动有许多不同的形式……而且围绕着即将到来的东京奥运会的纸板床的神话几乎肯定会被揭穿。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="0d52" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mm mn mo lz b">GROUP BY</code>允许我们根据某个类别聚合列。它们通常出现在<code class="fe mm mn mo lz b">FROM</code>或<code class="fe mm mn mo lz b">WHERE</code>语句之后。一个棘手的规定是，如果我们想在使用<code class="fe mm mn mo lz b">GROUP BY</code>后过滤我们的聚合结果，我们不能在其后放置一个<code class="fe mm mn mo lz b">WHERE</code>谓词。这样做的原因是因为一个<code class="fe mm mn mo lz b">WHERE</code>谓词在之前<em class="lv">被执行，结果集与<code class="fe mm mn mo lz b">GROUP BY</code>聚合。解决方法是在<code class="fe mm mn mo lz b">GROUP BY</code>语句后使用<code class="fe mm mn mo lz b">HAVING</code>条件，在</em>结果被聚合后过滤结果<em class="lv">。</em></p><h2 id="7250" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">随着时间的推移，可视化每个地区每个运动项目的运动员人数</h2><p id="cfa4" class="pw-post-body-paragraph ki kj it kk b kl og ju kn ko oh jx kq kr oi kt ku kv oj kx ky kz ok lb lc ld im bi translated">让我们利用<code class="fe mm mn mo lz b">GROUP BY</code>子句通过几种不同的分类分组方案来计算运动员的人数。由于<code class="fe mm mn mo lz b">sqlio</code>，我们一直将结果集视为pandas数据帧，因此我们可以轻松地制作matplotlib条形图，进行更强大的数量级比较。首先，我们可以执行一个简单的查询来了解一段时间内有多少运动员参加了夏季奥运会。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="834d" class="md me it lz b gy mf mg l mh mi">SELECT year, COUNT(*) AS num_athletes FROM olympics<br/>WHERE season = 'Summer'<br/>GROUP BY year</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ol"><img src="../Images/ffb03b88262acdc64f9d71abae66d60f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mUowCsNrcCx9ugErAmIQQA.png"/></div></div></figure><p id="0596" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">参加夏季奥运会的运动员数量似乎相对呈线性增长。自1896年第一届奥运会以来，当时只有不到1000名运动员参赛，现在运动员人数已经增加到将近14000人。不幸的是，我们很有可能在2021年看到一个明显的下降，因为许多运动员要么在新冠肺炎的测试中呈阳性，要么由于疫情经历了一些其他情况，使他们无法参加比赛。接下来我们来看看每个运动项目的运动员人数，按照运动员最多的运动项目排序。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="d12b" class="md me it lz b gy mf mg l mh mi">SELECT sport, COUNT(*) AS num_athletes FROM olympics<br/>GROUP BY sport<br/>HAVING COUNT(*) &gt; 5000<br/>ORDER BY COUNT(*) DESC</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ol"><img src="../Images/9e4edfa11023ff933846df890587e09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iVa0DZZP5xbffTxgNngvLw.png"/></div></div></figure><p id="5957" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，运动员人数最多的前三项运动是田径(也称为田径)、体操和游泳。这些运动的特点是项目众多，而且主要是个人运动。</p><p id="3557" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了查看哪些地区派出了最多的竞争对手，我们几乎可以复制相同的查询，只是将“noc”而不是“sport”作为分类列。这里的一个警告是，我们希望能够看到完整的国家/地区名称，而不是3个字母的国家奥委会缩写。因此，我们将使用较小的数据集<code class="fe mm mn mo lz b">ON</code>执行<code class="fe mm mn mo lz b">LEFT JOIN</code>操作，即“noc”列。A <code class="fe mm mn mo lz b">LEFT JOIN</code>返回左表中的所有行，即使右表中没有匹配的行。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="d8e6" class="md me it lz b gy mf mg l mh mi">SELECT region, COUNT(*) AS num_athletes FROM olympics<br/>LEFT JOIN noc_regions<br/>ON noc_regions.noc = olympics.noc<br/>GROUP BY region<br/>HAVING COUNT(*) &gt; 5000<br/>ORDER BY COUNT(*) DESC</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ol"><img src="../Images/07f784843e0875eed6a1d202a9ee9813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RMHl1pAUXDtKH_oSBcmmPg.png"/></div></div></figure><p id="062a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">派出最多运动员参加奥运会的前两个国家是美国和德国，每个国家总共有15，000多名运动员。法国、英国、俄罗斯和意大利各派出1万多名运动员。我个人对加拿大、日本和澳大利亚没有排在前列感到有点惊讶。众所周知，加拿大参加冬季奥运会的人数很多，但也许它参加夏季奥运会的运动员较少。我假设在这个结果集中，日本和澳大利亚没有其他大国那么多的田径运动员。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="1c37" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这一节中，我将在使用<code class="fe mm mn mo lz b">GROUP BY</code>和<code class="fe mm mn mo lz b">LEFT JOIN</code>的基础上引入一个新的主题:子查询！子查询允许您构造复杂的查询，实质上是对另一个查询的结果执行一个查询。该语法涉及两个SELECT语句；首先执行括号中的代码(子查询),其结果集用作主(外部)SELECT语句的筛选表。</p><h2 id="1be9" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">女篮的世界是怎么回事？</h2><p id="5095" class="pw-post-body-paragraph ki kj it kk b kl og ju kn ko oh jx kq kr oi kt ku kv oj kx ky kz ok lb lc ld im bi translated">这个问题是针对那些我个人认为没有得到足够认可的女球员的。我最近了解到，他们已经取得了相当大的连胜，所以我开始验证这一点，并在全球舞台上发现一些相关的背景。以下SQL查询确定了在过去10场比赛中哪个国家获得了女子篮球金牌。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="c1ee" class="md me it lz b gy mf mg l mh mi">SELECT year, region AS gold FROM olympics<br/>LEFT JOIN noc_regions<br/>ON olympics.noc = noc_regions.noc<br/>WHERE sport = 'Basketball' AND sex = 'F' AND medal = 'Gold'<br/>GROUP BY year, region<br/>ORDER BY year DESC</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi om"><img src="../Images/b3eecb1f13c11278088722f543b39ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:258/format:webp/1*Gf0UqRe9gprY4C9Fi4a7Zg.png"/></div></figure><p id="6727" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">美国女篮自1992年以来还没有尝过失败的滋味，那是连续6块金牌！客观地说，在我出生之前，他们就已经是卫冕冠军了。令人印象深刻，但我现在需要知道更多。让我们做一些调查，找出他们过去10场比赛的亚军是谁。这就是子查询发挥作用的地方。</p><p id="9db2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当<code class="fe mm mn mo lz b">FROM</code>子句中的表名被子查询替换时，子查询就形成了所谓的派生表。派生表可以被赋予别名，以使选择列不那么冗长。当从两个不同的(派生的)表中选择列时，我们必须指定一个<code class="fe mm mn mo lz b">WHERE</code>谓词，表明它们共享相同的索引列，否则将执行交叉连接，这将产生比我们预期的多得多的行。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="7504" class="md me it lz b gy mf mg l mh mi">SELECT G.year, G.gold, S.silver FROM<br/> (SELECT year, region AS gold FROM olympics<br/>  LEFT JOIN noc_regions<br/>  ON olympics.noc = noc_regions.noc<br/>  WHERE sport = 'Basketball' and sex = 'F' and medal = 'Gold'<br/>  GROUP BY year, region) G,<br/> (SELECT year, region AS silver FROM olympics<br/>  LEFT JOIN noc_regions<br/>  ON olympics.noc = noc_regions.noc<br/>  WHERE sport = 'Basketball' and sex = 'F' and medal = 'Silver'<br/>  GROUP BY year, region) S<br/>WHERE G.year = S.year<br/>ORDER BY year DESC</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi on"><img src="../Images/d6b23402f0f05ed1e79fd8ed8f7ef52c.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*Rah8bjWAZ0mVRrNu-lX67w.png"/></div></figure><p id="37df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有意思——西班牙和法国分别在最近两届夏季奥运会上获得银牌。在此之前，澳大利亚是美国女篮连续三场比赛的亚军。尽管从理论上讲，她们正处于几十年来的连胜状态，但美国女子篮球队最近在奥运会前的一场表演赛中以70比67输给了一个缺少明星球员的澳大利亚队，这可能是一个值得警惕的原因。</p><h2 id="1b93" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">谁是美国女子篮球队的关键球员？</h2><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="e01e" class="md me it lz b gy mf mg l mh mi">SELECT name, COUNT(*) FROM olympics<br/>WHERE sport = 'Basketball' and sex = 'F' and medal = 'Gold' and noc = 'USA'<br/>GROUP BY name<br/>HAVING COUNT(*) &gt;= 3<br/>ORDER BY count DESC</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/91877b43d349b62b53d0606b877b47be.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*_v2RLQ5l_74JW2iPGzDqkQ.png"/></div></figure><p id="4d33" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了让这个小小的探索更进一步，研究这些年来让球队背负重担的传奇人物的名字总是很重要的。丽萨·莱斯利、苏·伯德、戴安娜·陶乐斯、塔米卡·凯金斯和特蕾莎·爱德华兹各自为美国赢得了4次金牌，这对于任何一个精英运动员来说都是一个巨大的职业成就，性别除外。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="56ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本节将涉及一些由多个子查询组成的相对复杂的查询。如果您是SQL新手，请不要害怕。解释图表是这一分析中更重要的部分。</p><p id="c807" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也就是说，如果您是一名SQL专家或者正在努力成为一名SQL专家，本节将介绍聚合函数的使用，比如<code class="fe mm mn mo lz b">MIN()</code>、<code class="fe mm mn mo lz b">MAX()</code>和<code class="fe mm mn mo lz b">AVG()</code>，这些函数接受一个列名，并在执行数学运算后返回计算出的值。由于聚合函数只能应用于由数字数据组成的列，因此<code class="fe mm mn mo lz b">CAST</code>操作符在这里会派上用场，使我们能够从一种数据类型(字符串)转换为另一种数据类型(整数或小数)。</p><h2 id="5c06" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">按运动项目分析运动员体格(身高和体重)</h2><p id="0999" class="pw-post-body-paragraph ki kj it kk b kl og ju kn ko oh jx kq kr oi kt ku kv oj kx ky kz ok lb lc ld im bi translated">与过去的SQL查询不同，有时我们不一定知道我们希望突出显示数据中的哪些关系。在这些场景中，能够将我们的数据集过滤到一个可管理的大小，并将整个结果集放入一个探索性的<code class="fe mm mn mo lz b">seaborn</code>绘图函数中，比如<a class="ae lu" href="https://seaborn.pydata.org/generated/seaborn.swarmplot.html" rel="noopener ugc nofollow" target="_blank">蜂群绘图</a>，这很好。群体图能更好地表示值的分布，但它不能很好地适应大量的观察结果。在这里，SQL查询将我们的结果集缩小到参加了2012年或2016年夏季奥运会、参加了一项“流行”运动并获得了一枚奖牌的运动员。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="d4b4" class="md me it lz b gy mf mg l mh mi">SELECT sport, CAST(height AS INTEGER) FROM olympics<br/>WHERE sport IN (<br/>   SELECT sport FROM olympics<br/>   GROUP BY sport<br/>   HAVING COUNT(*) &gt; 3000<br/>) <br/>AND height &lt;&gt; 'NA' <br/>AND season = 'Summer' <br/>AND year &gt;= 2012 <br/>AND medal &lt;&gt; 'NA'<br/>ORDER BY sport</span></pre><div class="lf lg lh li gt ab cb"><figure class="op lj oq or os ot ou paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><img src="../Images/a64d6cbad7dc839a5e5846299047e596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vz3b_bW2OLsEcoldEhb5aA.png"/></div></figure><figure class="op lj oq or os ot ou paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><img src="../Images/60e9c9ff41c70823c82401053418d79e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*TWPMQt4UCGHGLlNI7bY_qA.png"/></div></figure></div><p id="1383" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的群体图描述了高水平运动员的身高和体重分布。凭直觉，运动员最高的项目似乎是篮球、手球和排球，而运动员最矮的项目似乎是体操、举重和摔跤。</p><p id="10e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就体重而言，我们看到摔跤、举重、柔道和拳击的分布更广，因为这些项目都有重量级别，运动员会有意识地训练他们的身体。田径运动描述了一点尾巴效应，这可能是因为许多投掷项目需要大量的力量。体操、曲棍球、足球、游泳分布最集中。</p><p id="54b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在分析这个数字时，我想到我没有按性别来区分数据。与其制作更多的群体图来解决这个问题，不如让我们应用一些集合函数，用两个系列的数据制作一个散点图，一个是雄性的，另一个是雌性的。完成这一任务的复杂SQL查询已经成为感兴趣者的要点:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ol"><img src="../Images/bddc93bdc181574dbbb33d983526ff9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8cqKyG_XwBcBfltFRim77A.png"/></div></div></figure><p id="2148" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看着上面的体重散点图，我们可以收集到一些有趣的发现。最引人注目的是，女性拳击手的平均体重非常接近男性拳击手的平均体重，我们在举重中也看到了类似的趋势。也许这和肌肉量或者重心低有关，但只能推测。对于花样滑冰来说，根据体重数据，普通的女运动员更娇小、更瘦，而普通的男运动员则更重。这具有直观的意义，因为男性花样滑冰运动员在运动中经常举起他们的女性伙伴，所以他们必须有更强壮的体格。最后，体操运动员是所有运动员中最轻量级的也就不足为奇了。</p><p id="0f2b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只是为了好玩，看看奖牌获得者按运动分类的年龄群图可能会很有趣。身体什么时候能发挥到巅峰？什么时候是退役的时候？</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ov"><img src="../Images/18d2dd1be2bb039f2e49e3aee9d5353f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5WF32QIylveEluvqTLz6OQ.png"/></div></div></figure><p id="4d66" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的“流行”运动中，从青少年到40岁出头似乎是奥运会奖牌获得者，更一般地说，是精英运动员的标准职业生涯。也就是说，如果你是马术或射击运动员，不要担心年龄！你可以经历中年危机，但仍然追求黄金。另一方面，如果你的运动是体操、柔道或举重，30岁出头似乎是放弃的好时机。也许重冲击运动对一个人的关节有“磨损”效应，使其多年难以高水平发挥。说到这里，让我们看看所有运动项目中奖牌获得者的年龄分布，不分性别。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="c3e4" class="md me it lz b gy mf mg l mh mi">SELECT CAST(age AS INTEGER), COUNT(*) AS num_medalists<br/>FROM olympics<br/>WHERE age &lt;&gt; 'NA' AND medal &lt;&gt; 'NA'<br/>GROUP BY age</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ov"><img src="../Images/823446c405d9df8be19c6914e46bb391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJWQxkNxtVPHZOLctXUhbw.png"/></div></div></figure><p id="d2a4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个漂亮的正态分布！23岁似乎是获得奥运奖牌的最佳年龄。这种分布有一个右偏——一个长右尾——意味着在20多岁时追逐奖牌的几率仍然相当高，然后随着一个人接近40岁或更高，它们缓慢但肯定会直线下降。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="7369" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将采用的最后一个SQL课程是<code class="fe mm mn mo lz b">CASE</code>语句，它本质上类似于其他编程语言中的“if-else”语句。它使我们能够对列应用条件逻辑，并将数据转换为对我们的任务更有意义或更方便的值。</p><h2 id="3ad6" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">谁收集了有史以来最多的硬件？</h2><p id="fa4f" class="pw-post-body-paragraph ki kj it kk b kl og ju kn ko oh jx kq kr oi kt ku kv oj kx ky kz ok lb lc ld im bi translated">最后，也许是最重要的，是时候看看谁在奥运会历史上收集了最多的奖牌。我们将在奖牌栏中应用<code class="fe mm mn mo lz b">CASE</code>语句，以计算加权和。我们希望考虑运动员获得的金牌、银牌和铜牌的数量，以一种符合逻辑的方式对它们进行缩放，而不是笼统地计算获得的奖牌数量。</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="8d18" class="md me it lz b gy mf mg l mh mi">SELECT name, sex, noc, sport, SUM(CASE medal<br/>  WHEN 'Gold' THEN 3<br/>  WHEN 'Silver' THEN 2<br/>  WHEN 'Bronze' THEN 1<br/>  ELSE 0<br/>  END)<br/>FROM olympics<br/>GROUP BY<br/>name, sex, noc, sport<br/>ORDER BY sum DESC<br/>LIMIT 10;</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ow"><img src="../Images/a78f2067890195145e117bbc43691aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGDKFABoVQhP9yAiuxjFpg.png"/></div></div></figure><p id="1955" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">迈克尔·菲尔普斯和帕沃·鲁米是我唯一认识的名字，但这很酷。在这十大奖牌获得者中，有十分之八是男性，并且有很多来自美国和俄罗斯的代表。还有很多代表来自三大运动:田径、体操和游泳！如果我们不列出有史以来前10名女奥运选手，这个项目会感觉不平衡，让我们继续下去，尽快完成。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ox"><img src="../Images/0669c277bdecee21b2934a33e729448d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9oMG1_7hwOh2mUMNIwOUag.png"/></div></div></figure><h2 id="f059" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">哪些国家在某项运动中表现出了奥运优势？</h2><p id="77f6" class="pw-post-body-paragraph ki kj it kk b kl og ju kn ko oh jx kq kr oi kt ku kv oj kx ky kz ok lb lc ld im bi translated">为了构建这个查询，我们将使用前面提到的相同的加权和列，以金牌、银牌和铜牌的组合来衡量成功。从结果集中，我们将能够识别出最值得记住的配对(国家→运动),然后才能进行为期3周的持续运动！</p><pre class="lf lg lh li gt ly lz ma mb aw mc bi"><span id="b176" class="md me it lz b gy mf mg l mh mi">SELECT region, sport, SUM(CASE medal<br/>  WHEN 'Gold' THEN 3<br/>  WHEN 'Silver' THEN 2<br/>  WHEN 'Bronze' THEN 1<br/>  ELSE 0<br/>  END)<br/>FROM olympics<br/>LEFT JOIN noc_regions<br/>ON noc_regions.noc = olympics.noc<br/>GROUP BY sport, region<br/>ORDER BY sum DESC<br/>LIMIT 8;</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/bf1ec8f3929f72103c7b97acc1952900.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*CKNl9fga0Jn_yilb3YFKJg.png"/></div></figure><p id="fe23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想在这个周末的客厅里听起来很聪明，只要记住美国队以其在游泳、田径、篮球和赛艇上的成功而闻名；德国以赛艇成功著称；俄罗斯在体操领域大放异彩；冰球场上的加拿大；游泳池里的澳大利亚。</p><h2 id="df7d" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">跟着走</h2><p id="c62d" class="pw-post-body-paragraph ki kj it kk b kl og ju kn ko oh jx kq kr oi kt ku kv oj kx ky kz ok lb lc ld im bi translated">这是一个总结！如果你能走到这一步，非常感谢。距离我的上一篇文章已经有一段时间了，但是我计划继续做一些项目，同时将我推出舒适区，并帮助我对感兴趣的领域有更多的了解。如果您有任何建议或反馈，请不要犹豫，通过电子邮件与我联系。</p><p id="d6d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于那些想要复制这项工作或按照自己的方向进行的人，这里是包含所有代码和数据的GitHub存储库:</p><div class="oz pa gp gr pb pc"><a href="https://github.com/sejaldua/sql-olympics" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">sejaldua/SQL-奥林匹克</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">通过对历史奥运数据进行SQL查询来宣传奥运会</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">github.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq lo pc"/></div></div></a></div><p id="56be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请随时在<a class="ae lu" href="https://www.linkedin.com/in/sejaldua/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上与我联系，或者查看我的<a class="ae lu" href="https://sejaldua.com" rel="noopener ugc nofollow" target="_blank">投资组合网站</a>！</p><h2 id="2548" class="md me it bd nl nm nn dn no np nq dp nr kr ns nt nu kv nv nw nx kz ny nz oa ob bi translated">参考</h2><div class="oz pa gp gr pb pc"><a href="https://www.postgresqltutorial.com/install-postgresql/" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">安装PostgreSQL</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">摘要:在本教程中，您将逐步学习如何在本地系统上安装PostgreSQL。PostgreSQL是…</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">www.postgresqltutorial.com</p></div></div><div class="pl l"><div class="pr l pn po pp pl pq lo pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a href="https://www.pgadmin.org" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">pgAdmin</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">pgAdmin开发团队很高兴宣布pgAdmin 4版本5.5。这个版本的pgAdmin 4包括18个错误…</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">www.pgadmin.org</p></div></div><div class="pl l"><div class="ps l pn po pp pl pq lo pc"/></div></div></a></div></div></div>    
</body>
</html>