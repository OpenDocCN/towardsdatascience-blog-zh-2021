<html>
<head>
<title>How To Fix ValueError: The truth value of a Series is ambiguous in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何修复值错误:熊猫系列的真值不明确</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fix-valueerror-truth-value-of-a-series-is-ambiguous-pandas-a683f0fd1b2f?source=collection_archive---------1-----------------------#2021-10-22">https://towardsdatascience.com/fix-valueerror-truth-value-of-a-series-is-ambiguous-pandas-a683f0fd1b2f?source=collection_archive---------1-----------------------#2021-10-22</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="8e34" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">了解如何处理熊猫最棘手和最常见的错误之一</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/1b45fcbc601fe7da5f92405bd5c41eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lrNFhjkRAUmflVvS1JSYg.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">马特·阿特兹在<a class="ae kz" href="https://unsplash.com/s/photos/fix?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="9a15" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="1bb7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">熊猫最常报告的错误之一是</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="a946" class="la lb iu mq b gz mu mv l mw mx"><strong class="mq iv">ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</strong></span></pre><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">而且有时处理起来可能相当棘手，尤其是如果你是熊猫库(甚至Python)的新手。</p><p id="7d90" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">在今天的文章中，我们将首先了解这个错误出现的原因和时间，并展示如何消除它。具体来说，我们将讨论如何通过使用</p><ul class=""><li id="93e1" class="ng nh iu ly b lz my mc mz lj ni ln nj lr nk mo nl nm nn no bi translated">Python的按位运算符，或</li><li id="4a56" class="ng nh iu ly b lz np mc nq lj nr ln ns lr nt mo nl nm nn no bi translated">NumPy的逻辑运算符方法</li></ul></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><h2 id="ebca" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">理解错误</h2><p id="1b8b" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在进入细节之前，让我们用一个例子重现这个错误，我们也将在本文中引用这个例子来演示一些概念，这些概念将最终帮助我们理解实际的错误以及如何消除它。</p><p id="083b" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">让我们开始在pandas中创建一个示例数据框架。</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="639a" class="la lb iu mq b gz mu mv l mw mx">import pandas as pd</span><span id="9e66" class="la lb iu mq b gz ob mv l mw mx">df = pd.DataFrame(<br/>    [<br/>        (1, 531, True, 12.8),<br/>        (2, 126, False, 74.2),<br/>        (3, 175, False, 1.1),<br/>        (4, 127, True, 45.8),<br/>        (5, 543, True, 21.1),<br/>        (6, 254, False, 98.1),<br/>    ],<br/>    columns=['colA', 'colB', 'colC', 'colD']<br/>)</span><span id="6394" class="la lb iu mq b gz ob mv l mw mx">print(df)<br/><em class="oc">   colA  colB   colC  colD<br/>0     1   531   True  12.8<br/>1     2   126  False  74.2<br/>2     3   175  False   1.1<br/>3     4   127   True  45.8<br/>4     5   543   True  21.1<br/>5     6   254  False  98.1</em></span></pre><p id="8ac4" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">现在让我们假设我们想要使用几个逻辑条件来过滤我们的熊猫数据帧。假设我们希望只保留列<code class="fe nd ne nf mq b">colB</code>中的值大于<code class="fe nd ne nf mq b">200</code>且列<code class="fe nd ne nf mq b">colD</code>中的值小于或等于<code class="fe nd ne nf mq b">50</code>的行。</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="5d91" class="la lb iu mq b gz mu mv l mw mx">df = df[(df['colB'] &gt; 200) and (df['colD'] &lt;= 50)]</span></pre><p id="44ef" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">上述表达式将失败，并出现以下错误:</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="e208" class="la lb iu mq b gz mu mv l mw mx">File "/usr/local/lib/python3.7/site-packages/pandas/core/generic.py", line 1555, in __nonzero__</span><span id="7bb5" class="la lb iu mq b gz ob mv l mw mx">  self.__class__.__name__</span><span id="0e25" class="la lb iu mq b gz ob mv l mw mx">ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().</span></pre></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><p id="9e51" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">出现该错误是因为您使用逻辑运算符(如<code class="fe nd ne nf mq b">and</code>、<code class="fe nd ne nf mq b">or</code>、<code class="fe nd ne nf mq b">not</code>)将多个条件链接在一起，导致了不明确的逻辑，因为对于每个指定的单独条件，返回的结果是基于列的。</p><p id="b9a9" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">换句话说，该错误告诉您，您正试图获取熊猫系列对象的布尔值。为了将它放入一个更简单的上下文中，考虑下面的表达式，它将再次引发这个特定的错误:</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="a3e0" class="la lb iu mq b gz mu mv l mw mx">&gt;&gt;&gt; import pandas as pd</span><span id="d6b2" class="la lb iu mq b gz ob mv l mw mx">&gt;&gt;&gt; s = pd.Series([1, 2, 3])<br/>&gt;&gt;&gt; s<br/>0    1<br/>1    2<br/>2    3<br/>dtype: int64</span><span id="b87d" class="la lb iu mq b gz ob mv l mw mx">&gt;&gt;&gt; bool(s)<br/>Traceback (most recent call last):<br/>  File "/usr/local/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3331, in run_code<br/>    exec(code_obj, self.user_global_ns, self.user_ns)<br/>  File "&lt;ipython-input-5-68e48e81da14&gt;", line 1, in &lt;module&gt;<br/>    bool(s)<br/>  File "/usr/local/lib/python3.7/site-packages/pandas/core/generic.py", line 1555, in __nonzero__<br/>    self.__class__.__name__<br/><strong class="mq iv">ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().</strong></span></pre><p id="1a3d" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">当多个条件被指定并使用逻辑操作符链接在一起时，每个单独的操作数被隐式地转换成一个<code class="fe nd ne nf mq b">bool</code>对象，从而导致问题中的错误。</p></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><h2 id="bf63" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用按位运算符</h2><p id="05a2" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在为了修复这个错误，你的第一个选择是使用Python <strong class="ly iv">位操作符</strong>。</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="45cf" class="la lb iu mq b gz mu mv l mw mx"><strong class="mq iv">Operator</strong> |   <strong class="mq iv">Meaning</strong><br/>----------------------<br/>   &amp;     | Bitwise AND<br/>   |     | Bitwise OR<br/>   ~     | Bitwise NOT<br/>   ^     | Bitwise XOR</span></pre><p id="dfa0" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">现在，表达式应该像预期的那样工作，不会出现<code class="fe nd ne nf mq b">ValueError</code>:</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="f337" class="la lb iu mq b gz mu mv l mw mx"><strong class="mq iv">df = df[(df['colB'] &gt; 200) &amp; (df['colD'] &lt;= 50)]</strong></span><span id="bcfd" class="la lb iu mq b gz ob mv l mw mx">print(df)<br/><em class="oc">   colA  colB  colC  colD<br/>0     1   531  True  12.8<br/>4     5   543  True  21.1</em></span></pre></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><h2 id="2229" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用NumPy的逻辑运算符</h2><p id="3e0c" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">或者，您可以使用NumPy的逻辑运算符方法，即<strong class="ly iv">按元素计算真值</strong>，这样真值就不会有歧义。</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="340b" class="la lb iu mq b gz mu mv l mw mx">Operator | Method<br/>-----------------<br/>AND      | <a class="ae kz" href="https://numpy.org/doc/stable/reference/generated/numpy.logical_and.html" rel="noopener ugc nofollow" target="_blank">numpy.logical_and</a><br/>OR       | <a class="ae kz" href="https://numpy.org/doc/stable/reference/generated/numpy.logical_or.html" rel="noopener ugc nofollow" target="_blank">numpy.logical_or</a><br/>NOT      | <a class="ae kz" href="https://numpy.org/doc/stable/reference/generated/numpy.logical_not.html" rel="noopener ugc nofollow" target="_blank">numpy.logical_not</a> <br/>XOR      | <a class="ae kz" href="https://numpy.org/doc/stable/reference/generated/numpy.logical_xor.html" rel="noopener ugc nofollow" target="_blank">numpy.logical_xor</a></span></pre><p id="46e6" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">在我们的例子中，<code class="fe nd ne nf mq b">numpy.logical_and</code>方法应该可以达到目的:</p><pre class="kk kl km kn gu mp mq mr ms aw mt bi"><span id="2527" class="la lb iu mq b gz mu mv l mw mx">import numpy as np</span><span id="c819" class="la lb iu mq b gz ob mv l mw mx"><strong class="mq iv">df = df[np.logical_and(df['colB'] &gt; 200, df['colD'] &lt;= 50)]</strong></span><span id="1c00" class="la lb iu mq b gz ob mv l mw mx">print(df)<br/>   colA  colB  colC  colD<br/><em class="oc">0     1   531  True  12.8<br/>4     5   543  True  21.1</em></span></pre></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的指南中，我们讨论了pandas和Python中最常报告的错误之一，即<code class="fe nd ne nf mq b">ValueError: The truth value of a Series is ambiguous</code>。</p><p id="729d" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated">我们重现了这个错误，试图更好地理解为什么首先会出现这个错误，此外，我们还讨论了如何使用Python的按位运算符或NumPy的逻辑运算符方法来处理它。</p></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读媒介上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz my jv mb mc mz jy me lj na mg mh ln nb mj mk lr nc mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="od oe gq gs of og"><a rel="noopener follow" target="_blank" href="/how-to-efficiently-convert-a-pyspark-dataframe-to-pandas-8bda2c3875c3"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">加快PySpark和Pandas数据帧之间的转换</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">将大火花数据帧转换为熊猫时节省时间</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="oq l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu og"><a rel="noopener follow" target="_blank" href="/whats-the-difference-between-static-and-class-methods-in-python-1ef581de4351"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">Python中静态方法和类方法有什么区别？</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">关于classmethod和staticmethod，您只需要知道</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ov l or os ot op ou kt og"/></div></div></a></div></div><div class="ab cl nu nv hy nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu og"><a rel="noopener follow" target="_blank" href="/automating-python-workflows-with-pre-commit-hooks-e5ef8e8d50bb"><div class="oh ab fp"><div class="oi ab oj cl cj ok"><h2 class="bd iv gz z fq ol fs ft om fv fx it bi translated">使用预提交挂钩自动化Python工作流</h2><div class="on l"><h3 class="bd b gz z fq ol fs ft om fv fx dk translated">什么是预提交钩子，它们如何给你的Python项目带来好处</h3></div><div class="oo l"><p class="bd b dl z fq ol fs ft om fv fx dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ow l or os ot op ou kt og"/></div></div></a></div></div></div>    
</body>
</html>