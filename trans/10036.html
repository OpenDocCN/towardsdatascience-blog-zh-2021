<html>
<head>
<title>How to Generate Automated PDF Documents with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python生成自动化的PDF文档</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-generate-automated-pdf-documents-with-python-55981f4d9e3?source=collection_archive---------2-----------------------#2021-09-22">https://towardsdatascience.com/how-to-generate-automated-pdf-documents-with-python-55981f4d9e3?source=collection_archive---------2-----------------------#2021-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="083b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用自动化轻松创建令人眼花缭乱的PDF文档</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/75038fb415b4cdddb349ee3fc2c059aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sdrUaK1sG1fKrJHk"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</p></figure><p id="2b81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你上一次处理PDF文档是什么时候？你可能不需要回顾太久就能找到这个问题的答案。我们每天都要处理大量的文档，其中绝大多数都是PDF文档。公平地说，这些文件中有很多都是重复的，而且编写起来非常痛苦。是时候考虑利用Python的自动化功能来机械化繁琐的工作了，这样我们就可以将宝贵的时间重新分配给生活中更紧迫的任务。</p><p id="6410" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，完全没有必要精通技术，我们在这里要做的事情应该是足够琐碎的，我们内心不喜欢的门外汉可以在短时间内解决。阅读完本教程后，你将学习如何自动生成PDF文档，将你自己的数据、图表和图像打包在一起，呈现出令人眼花缭乱的外观和结构。</p><p id="70ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">具体来说，在本教程中，我们将自动执行以下操作:</p><ul class=""><li id="d483" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">创建PDF文档</li><li id="7798" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">插入图像</li><li id="09f8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">插入文本和数字</li><li id="8f45" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">可视化数据</li></ul><h2 id="6146" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">创建PDF文档</h2><p id="ad04" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">在本教程中，我们将使用<a class="ae ky" href="https://pyfpdf.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> FPDF </a>，它是Python中用来生成PDF的最通用、最直观的包之一。在我们继续下一步之前，启动Anaconda提示符或您选择的任何其他Python IDE，并安装FPDF:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="dbcd" class="mj mk it ni b gy nm nn l no np">pip install FPDF</span></pre><p id="b6f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后导入我们将用来呈现文档的库栈:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="035d" class="mj mk it ni b gy nm nn l no np">import numpy as np<br/>import pandas as pd<br/>from fpdf import FPDF<br/>import matplotlib as mpl<br/>import matplotlib.pyplot as plt<br/>from matplotlib.ticker import ScalarFormatter</span></pre><p id="d5fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随后，继续创建PDF文档的第一页，并设置字体的大小和颜色:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a257" class="mj mk it ni b gy nm nn l no np">pdf = FPDF(orientation = 'P', unit = 'mm', format = 'A4')<br/>pdf.add_page()<br/>pdf.set_font('helvetica', 'bold', 10)<br/>pdf.set_text_color(255, 255, 255)</span></pre><p id="0edb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，如果你需要不同的字体，你可以随时改变字体。</p><h2 id="b408" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">插入图像</h2><p id="96d9" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">下一个合乎逻辑的步骤是给我们的文档一个背景图像，为页面的其余部分设置结构。对于本教程，我使用Microsoft PowerPoint来呈现我的背景图像的格式。我只是使用文本框和其他视觉效果来创建所需的格式，完成后，我通过选择所有元素并按Ctrl-G将所有内容分组在一起。最后，我通过右键单击它们并选择“另存为图片”将分组的元素保存为PNG图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/1cd16d509bb04ee5c41b1166f48c57cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Y_0EMtlOEx8GYeIabSW2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">背景图像。图片作者。</p></figure><p id="0fe1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您在上面看到的，背景图像为我们的页面设置了结构，并为稍后将生成的图表、图形、文本和数字留出了空间。用于生成该图像的特定PowerPoint文件可以从<a class="ae ky" href="https://github.com/mkhorasani/Bank_Scan/blob/master/background.pptx" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="368e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随后将背景图像插入到您的PDF文档中，并使用以下内容配置其位置:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="3130" class="mj mk it ni b gy nm nn l no np">pdf.image('C:/Users/.../image.png', x = 0, y = 0, w = 210, h = 297)</span></pre><p id="1500" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，您可以通过扩展上面显示的方法插入任意数量的图像。</p><h2 id="771c" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">插入文本和数字</h2><p id="62b5" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">添加文本和数字有两种方法。我们可以指定要放置文本的确切位置:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="4d42" class="mj mk it ni b gy nm nn l no np">pdf.text(x, y, txt)</span></pre><p id="03f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，我们可以创建一个单元格，然后将文本放入其中。这种方法更适合于对齐或居中可变或动态文本:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="4d71" class="mj mk it ni b gy nm nn l no np">pdf.set_xy(x, y)<br/>pdf.cell(w, h, txt, border, align, fill)</span></pre><p id="3dbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在上述方法中:</p><ul class=""><li id="4d69" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">“x”和“y”是指我们页面上的指定位置</li><li id="0db9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">“w”和“h”指的是我们细胞的大小</li><li id="93d6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">“txt”是要显示的字符串或数字</li><li id="54c2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">“边框”表示是否必须在单元格周围画一条线(0:否，1:是或L:左，T:上，R:右，B:下)</li><li id="871c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">“对齐”表示文本的对齐方式(左:左，中:右)</li><li id="3103" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">“填充”指示单元格背景是否应该填充(真，假)。</li></ul><h2 id="d9a0" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">可视化数据</h2><p id="95aa" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">在这一部分中，我们将创建一个条形图，显示我们的贷方、借方和余额值随时间变化的时间序列数据集。为此，我们将使用Matplotlib来呈现我们的图形，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4a86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码片段中，credit、debit和balance是二维列表，分别包含日期和交易金额的值。一旦生成并保存了图表，就可以使用前面几节中介绍的方法将它插入到我们的PDF文档中。</p><p id="08ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，我们可以用下面的代码片段生成圆环图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="571a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，您可以通过生成自动化的PDF文档来完成它:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a56a" class="mj mk it ni b gy nm nn l no np">pdf.output('Automated PDF Report.pdf')</span></pre><h2 id="6f92" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">结论</h2><p id="01ff" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">这就是你自己的自动生成的PDF报告！现在，您已经学会了如何创建PDF文档，将文本和图像插入其中，还学会了如何生成和嵌入图表和图形。但是您决不仅限于此，事实上，您还可以扩展这些技术，使之包括多页文档的其他视觉效果。天空才是真正的极限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/e85060dc2bd43893e06b0e202e6ff206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dp0DYSbGRJgv-NRe7QfjKg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="1efb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想了解更多关于数据可视化和Python的知识，请随时查看以下(附属链接)课程:</p><h2 id="6a1d" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">使用Streamlit开发Web应用程序:</h2><div class="nu nv gp gr nw nx"><a href="https://www.amazon.com/Web-Application-Development-Streamlit-Applications/dp/1484281101?&amp;linkCode=ll1&amp;tag=mkhorasani09-20&amp;linkId=a0cb2bc17df598006fd9029c58792a6b&amp;language=en_US&amp;ref_=as_li_ss_tl" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">使用Streamlit开发Web应用程序:开发和部署安全且可伸缩的Web应用程序…</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">使用Streamlit开发Web应用程序:使用……开发安全且可扩展的Web应用程序并将其部署到云中</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">www.amazon.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div><h2 id="7177" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">使用Python实现数据可视化:</h2><div class="nu nv gp gr nw nx"><a href="https://www.coursera.org/learn/python-for-data-visualization?irclickid=xgMQ4KWb%3AxyIWO7Uo7Vva0OcUkGQgW2aEwvr1c0&amp;irgwc=1&amp;utm_medium=partners&amp;utm_source=impact&amp;utm_campaign=3308031&amp;utm_content=b2c" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">用Python实现数据可视化</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">“一图胜千言”。我们都熟悉这个表达。它尤其适用于试图…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">www.coursera.org</p></div></div><div class="og l"><div class="om l oi oj ok og ol ks nx"/></div></div></a></div><h2 id="ac9e" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">面向所有人的Python专业化:</h2><div class="nu nv gp gr nw nx"><a href="https://www.coursera.org/specializations/python?irclickid=xgMQ4KWb%3AxyIWO7Uo7Vva0OcUkGQgW16Ewvr1c0&amp;irgwc=1&amp;utm_medium=partners&amp;utm_source=impact&amp;utm_campaign=3308031&amp;utm_content=b2c" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">面向所有人的Python</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">学习用Python编程和分析数据。开发收集、清理、分析和可视化数据的程序…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">www.coursera.org</p></div></div><div class="og l"><div class="on l oi oj ok og ol ks nx"/></div></div></a></div></div><div class="ab cl oo op hx oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="im in io ip iq"><h1 id="334e" class="ov mk it bd ml ow ox oy mo oz pa pb mr jz pc ka mu kc pd kd mx kf pe kg na pf bi translated">新到中？您可以在此订阅和解锁无限文章<a class="ae ky" href="https://khorasani.medium.com/membership" rel="noopener">。</a></h1></div></div>    
</body>
</html>