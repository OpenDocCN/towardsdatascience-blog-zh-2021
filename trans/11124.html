<html>
<head>
<title>Building a Python CLI Tool to Extract the TOC from Markdown Files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建 Python CLI 工具从 Markdown 文件中提取 TOC</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-python-cli-tool-to-extract-the-toc-from-markdown-files-ab5a7b9d07f2?source=collection_archive---------12-----------------------#2021-10-30">https://towardsdatascience.com/building-a-python-cli-tool-to-extract-the-toc-from-markdown-files-ab5a7b9d07f2?source=collection_archive---------12-----------------------#2021-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1205" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过自动化枯燥的任务来学习—第 1 部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/b47b62d2b35b1cb3836478f4f738c90f.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*fqibp67xyl4afeXYWwHmcQ.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">为降价文件创建目录—由作者创建的图像。</p></figure><p id="7a0f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不久前，我在 markdown 上为我公司的 DevGuide 写了很多文章——我们用 Hugo 来构建它作为一个内部网站——并对创建和修改目录(TOC)这一非常重复、非常无聊的任务感到恼火。每当我更改标题、引入新的子章节或删除其他章节时，我都必须一次又一次地手动编辑目录。在回顾和编辑了几篇文章之后，我终于厌倦了寻找工具和“易于使用”但可配置的选项。我对它的缺乏感到惊讶。</p><p id="0130" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以我决定编写自己的最小 CLI 工具，从 markdown 文件中自动提取目录(TOC)。在本文中，我将介绍实现所需的需求、设计决策和核心功能。当然，这个项目是开源的，任何人都可以扩展它。</p><h1 id="a2a6" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">需求和初步想法</strong></h1><p id="838e" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">由于 TOC 通常被放在减价文件的不同位置，所以默认情况下没有必要将其插入文件的第一行。例如<a class="ae ln" href="https://jekyllrb.com/docs/front-matter/" rel="noopener ugc nofollow" target="_blank">杰基尔</a>和<a class="ae ln" href="https://gohugo.io/content-management/front-matter/" rel="noopener ugc nofollow" target="_blank">雨果</a>都要求降价文件的前几行包含他们各自的封面。</p><p id="4511" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一般来说，编辑文件本身并不是一个好主意。事情偶尔会出错。理想情况下，我们希望最终决定权(插入 TOC)掌握在自己手中。只有当我们能够准确地定义决策参数和最佳结果时，我们才能够自动化决策——在这种情况下，这将是章节标题的语法内容和“感觉”。难以自动化。</p><p id="b749" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">总之，这意味着 TOC 应该</p><ul class=""><li id="7cf2" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">返回到控制台检查结果并启用复制粘贴(这需要是默认设置)，</li><li id="2337" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">可选地放置在剪贴板中，</li><li id="428e" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">可选地被复制到文件的第一行，</li><li id="de10" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">可选地放置在单独的文件中。</li></ul><p id="9534" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此外，我们应该允许用户通过对包含的标题级别设置自定义限制来限制 TOC 的深度。有些人喜欢三个标题层次的目录，有些人只喜欢看主要的。</p><h1 id="9463" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">格式注意事项</strong></h1><p id="ed40" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">关于 TOC 本身列举的实际格式，章节的可点击链接应该是首选。也许这只是我的懒惰，但是如果 TOC 不能被点击，我不能跳转到我感兴趣的章节，那么创建一个表格 OC 内容又有什么意义呢？这意味着我们需要以下输出格式之一:</p><p id="1804" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第一个选项更常用:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">GitLab 风格的目录链接降价。</p></figure><p id="52b1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">或者 HTML 锚的第二个选项:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">目录链接的 HTML 锚。</p></figure><p id="eab7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第二种选择需要在现有的降价文件中插入和格式化锚点，并在降价文件中引入 HTML。这两件事都很难论证——我也不是特别喜欢。</p><p id="b9e6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它们也与上面的需求相冲突，因为我们不需要将 TOC 直接插入到文件中，尤其是不需要到处都有多个分离的锚线。请记住，我们的目标是一个小而易用的解决方案，这个决定显然有利于第一种格式。</p><h1 id="05bf" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">核心功能</strong></h1><p id="88c1" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在明确了最初的设计决策和我们自己设定的需求之后，让我们来看看需要的功能。一般来说，我们有以下步骤:</p><ol class=""><li id="4dad" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm nb mr ms mt bi translated">读取文件</li><li id="2fa9" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">清理文件</li><li id="8853" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">识别标题</li><li id="c33a" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">格式化标题</li><li id="6cad" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">创建目录</li><li id="e27a" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">输出目录</li></ol><p id="d1d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们开始吧。</p><h2 id="d2c2" class="nc lp iq bd lq nd ne dn lu nf ng dp ly la nh ni ma le nj nk mc li nl nm me nn bi translated">读取文件</h2><p id="693d" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我们在这里不需要做什么特别的事情，我们只需要读取文件并根据换行符将它分成单独的行。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">正在读取文件。</p></figure><p id="81ca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">旁注:与使用<code class="fe no np nq nr b">readlines()</code>相比，我更喜欢上面的语法，因为<code class="fe no np nq nr b">readlines()</code>返回的行带有一个结束换行符，稍后必须对其进行清理。我们也可以一次将整个文件加载到内存中，因为降价文件很少有千兆字节的数据。</p><h2 id="badd" class="nc lp iq bd lq nd ne dn lu nf ng dp ly la nh ni ma le nj nk mc li nl nm me nn bi translated">清理文件</h2><p id="1a0a" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在提取文件头之前，我们需要从文件内容中删除所有代码块及其内容。Python(以及其他编程语言)可以将有效的 hashtags 作为一行中的前导字符(例如，作为注释)，这将与我们的头检测相冲突。由于这是一个简单的转换步骤，我们可以为它编写一个快速函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">该函数接收一个行列表，过滤掉所有代码块并返回过滤后的列表。</p></figure><h2 id="7f7f" class="nc lp iq bd lq nd ne dn lu nf ng dp ly la nh ni ma le nj nk mc li nl nm me nn bi translated"><strong class="ak">识别标题行</strong></h2><p id="c44b" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在 markdown 中有两种创建标题的方法</p><ul class=""><li id="6c83" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">在标题标题前面的同一行中使用一定数量的标签(<code class="fe no np nq nr b">#</code> ) <em class="ns">的常见选项</em></li><li id="1c0a" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">或者，<em class="ns">在下面的下一行中，</em>为 1 级标题添加任意数量的等号(<code class="fe no np nq nr b">=</code>)或连字符(<code class="fe no np nq nr b">-</code>)作为 2 级标题。</li></ul><p id="bca6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第二种选择的明显缺点(除了难看之外)是语法将我们限制在两个级别的头。到目前为止，我也很幸运地在我参与的项目中没有看到第二种形式。然而，为了确保完整的功能，让我们包括两种格式的识别方法。</p><p id="f3af" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">检测标题行的常见类型的逻辑非常简单:我们可以使用 regex 模式将一行标识为标题行:<code class="fe no np nq nr b">r"^#+\ .*$"</code>(前导标签，后跟空格，然后是任何可能的字符)。</p><p id="40d2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于其他类型的标题，我们只需检查该行是否以等号(regex: <code class="fe no np nq nr b">r"^=+ *$"</code>)或连字符(regex: <code class="fe no np nq nr b">r"^-+ *$"</code>)开头，并且直到行尾除了空格之外没有任何其他字符。如果是这样，我们添加<em class="ns">前面的</em>行作为标题。为了下一步省事，我们还会统一头格式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">识别标题行并过滤掉其他行。</p></figure><p id="a20b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">示例转换:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">过滤非标题行的转换示例。</p></figure><h2 id="a19d" class="nc lp iq bd lq nd ne dn lu nf ng dp ly la nh ni ma le nj nk mc li nl nm me nn bi translated"><strong class="ak">格式化标题</strong></h2><p id="ff28" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">识别标题后，我们需要确定它们的级别，并为目录本身创建格式化的行。</p><p id="c044" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从<a class="ae ln" href="https://docs.gitlab.com/ee/user/markdown.html#header-ids-and-links" rel="noopener ugc nofollow" target="_blank"> GitLab 文档</a>中，我们可以了解如何格式化 TOC 中常用的 markdown 链接:</p><ol class=""><li id="cf1f" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm nb mr ms mt bi translated">所有文本都转换成小写。</li><li id="e812" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">所有非单词文本(如标点符号或 HTML)都将被删除。</li><li id="23fe" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">所有空格都转换为连字符。</li><li id="9dba" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">一行中的两个或更多连字符被转换为一个。</li><li id="b612" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nb mr ms mt bi translated">如果已经生成了具有相同 ID 的报头，则附加一个唯一的递增数字，从 1 开始。</li></ol><p id="6da9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面的函数将涵盖这些规则中的大部分——无可否认，在一些边缘情况下，链接会失败，但对于 95%的情况，我们是好的。完美是令人钦佩的，但寻找边缘案例和实现解决方案所需的时间在目前是不值得的。当我们(或其他潜在的未来用户)确实遇到需要考虑的边缘情况时，我们总是可以轻松地扩展我的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">格式化标题和创建可点击的链接。</p></figure><p id="7b0f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">示例转换:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">示例转换。</p></figure><h2 id="ddc1" class="nc lp iq bd lq nd ne dn lu nf ng dp ly la nh ni ma le nj nk mc li nl nm me nn bi translated">创建目录</h2><p id="2d19" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">对于目录本身，我们必须对标题和子标题进行格式化和编号。如果下一个标题的级别高于前一个，我们还需要重置编号。</p><p id="6e8a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将 TOC 中的每一行组装成一个字符串包括(按顺序):</p><ul class=""><li id="bb08" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">副标题可能的缩进，</li><li id="dd91" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">标题编号，</li><li id="a83a" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">标题文本和</li><li id="03d6" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">标题的链接。</li></ul><p id="04b8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们还可以引入一个名为<code class="fe no np nq nr b">level_limit</code>的变量来限制 TOC 的深度。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">创建内容行的实际表格。</p></figure><p id="5e43" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">示例转换:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">从准备好的数据创建 TOC 行的示例。</p></figure><h2 id="ffb5" class="nc lp iq bd lq nd ne dn lu nf ng dp ly la nh ni ma le nj nk mc li nl nm me nn bi translated">结合目前为止的工作</h2><p id="2b4e" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我们现在已经实现了核心功能，很快就可以开始研究将它转换成 CLI 包的必要条件以及如何输出结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">核心功能。</p></figure><h2 id="3dc7" class="nc lp iq bd lq nd ne dn lu nf ng dp ly la nh ni ma le nj nk mc li nl nm me nn bi translated">输出目录</h2><p id="f794" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">根据所需的结果，我们将 TOC 复制到剪贴板，将其插入 md 文件或写入一个新文件。这主要是标准实践的东西，也许除了为我们的新 TOC 文件找到一个合适的文件名。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">将目录写入不同的通道。</p></figure><h1 id="657a" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">创建 CLI 功能</h1><p id="9907" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">为了能够从命令行调用带有可配置参数的包，我们使用了<a class="ae ln" href="https://docs.python.org/3/library/argparse.html" rel="noopener ugc nofollow" target="_blank"> argparse </a>模块。</p><p id="23bb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">记住我们的要求，我们希望用户:</p><ul class=""><li id="9e59" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">指定文件名(必需的参数)</li><li id="2208" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">能够将目录复制到剪贴板(可选参数<code class="fe no np nq nr b">--copy</code>)</li><li id="5baa" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">能够将目录插入文件(可选参数<code class="fe no np nq nr b">--insert</code>)</li><li id="fe4a" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">能够将目录保存到一个单独的文件中(可选参数<code class="fe no np nq nr b">--save</code>)</li><li id="fd7c" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">能够限制 TOC 的深度(可选参数<code class="fe no np nq nr b">--levels &lt;number-of-levels&gt;</code>)</li></ul><p id="ab9e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在创建了带有名称和描述的<code class="fe no np nq nr b">ArgumentParser</code>之后，我们必须单独添加每个参数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">为 CLI 创建参数。</p></figure><p id="0d73" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">查看存储库文件中的全部参数<a class="ae ln" href="https://github.com/CribberSix/markdown-toc-extract/blob/main/extracttoc/extracttoc.py" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="3a88" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">之后，访问参数/变量就像下面这样简单:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1056" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最棒的是，我们自动包含了<code class="fe no np nq nr b">--help</code>参数背后的功能。这里的输出是:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="5691" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">打包、发布和访问</strong></h1><p id="a856" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">因为我们也希望能够在我们曾经接触过的任何其他计算机上安装它(并且也让其他用户可以使用它)，我们可以创建一个简单的<code class="fe no np nq nr b">setup.py</code>文件，打包代码并将其发布在<a class="ae ln" href="https://pypi.org/project/extracttoc/" rel="noopener ugc nofollow" target="_blank"> pypi </a>上。打包 CLI 工具与任何其他 python 打包过程并无不同。</p><p id="0b50" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你对<code class="fe no np nq nr b">setup.py</code>和如何打包代码感兴趣，看看吧</p><ul class=""><li id="60b1" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated"><a class="ae ln" href="https://github.com/CribberSix/markdown-toc-extract" rel="noopener ugc nofollow" target="_blank">存储库中的文件</a>，或</li><li id="28eb" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://packaging.python.org/tutorials/packaging-projects/" rel="noopener ugc nofollow" target="_blank">在官方文件</a>中，或</li><li id="28ed" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://www.geeksforgeeks.org/packaging-and-publishing-python-code" rel="noopener ugc nofollow" target="_blank">在像 geeksforgeeks </a>这样的教程上，或者</li><li id="d7c8" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">像詹姆斯·布里格斯在<a class="ae ln" rel="noopener" target="_blank" href="/how-to-package-your-python-code-df5a7739ab2e">媒体上发表的文章。</a></li></ul><p id="90f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">快速旁注:为了测试你的打包软件，而不必把它上传到 pypi，然后通过 pip 安装，你可以简单地使用<code class="fe no np nq nr b">pip install .</code>直接从你的<code class="fe no np nq nr b">setup.py</code>文件所在的本地目录安装它(是的，这是一个点——表示当前目录)。</p><p id="4ec4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完成这一步后，世界各地的每个人都可以使用<code class="fe no np nq nr b">pip install extracttoc</code>安装 CLI 工具了！</p><h1 id="121a" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">用途</strong></h1><p id="a0c2" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">下面是该工具如何从命令行工作的几个具体使用示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="2d5c" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak"> <em class="nv">关闭思想</em> </strong></h1><p id="947b" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">一般来说，编写软件使自己的生活变得更容易是很好的编码实践。然而，创建开源包(帮助其他人解决同样的问题)会迫使你写出高质量的好代码，这些代码可以被其他人理解并在 T21 的基础上扩展。在你认为没有人会阅读的代码中，你可能没有考虑高优先级的事情(比如不仅仅命名你的迭代变量<code class="fe no np nq nr b">x</code>...)在考虑其他人将如何与代码交互时，突然变得更加重要。编写开源代码无疑会受到其他人的批评，这让我们关注风格和开发最佳实践——这让我们成为更好的程序员。</p><p id="3ac4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你觉得有空的话——试试<a class="ae ln" href="https://pypi.org/project/extracttoc/" rel="noopener ugc nofollow" target="_blank">包</a>,或者看看<a class="ae ln" href="https://github.com/CribberSix/markdown-toc-extract" rel="noopener ugc nofollow" target="_blank"> github </a>上的源代码，如果你想看完整的话！</p><p id="f20d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建一个 CLI 工具对我来说是新的，但在我的工具箱里是一个非常方便的技能。我确信我将来会再次使用它。</p><p id="b780" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一如既往，我们永远学不完。了解有关…的更多信息</p><ul class=""><li id="532d" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated"><a class="ae ln" href="https://www.markdownguide.org/basic-syntax" rel="noopener ugc nofollow" target="_blank"> Markdown 基本语法</a></li><li id="9c0b" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://docs.gitlab.com/ee/user/markdown.html" rel="noopener ugc nofollow" target="_blank">降价 GitLab 口味</a></li><li id="0a7d" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://docs.python.org/3/library/argparse.html" rel="noopener ugc nofollow" target="_blank"> Python 的 argparse 模块</a></li><li id="2e5c" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://stackoverflow.blog/2021/10/18/code-quality-a-concern-for-businesses-bottom-lines-and-empathetic-programmers/" rel="noopener ugc nofollow" target="_blank"> Stackoverflow 关于代码质量的想法</a></li><li id="06bd" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://packaging.python.org/tutorials/packaging-projects/" rel="noopener ugc nofollow" target="_blank">包装项目的 Python 文档</a></li><li id="08e7" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://www.geeksforgeeks.org/packaging-and-publishing-python-code/" rel="noopener ugc nofollow" target="_blank"> geeksforgeeks 的打包教程</a></li><li id="e561" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" rel="noopener" target="_blank" href="/how-to-package-your-python-code-df5a7739ab2e">詹姆斯·布里格斯关于包装的文章</a></li><li id="0354" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://jekyllrb.com/" rel="noopener ugc nofollow" target="_blank">用 jekyll 建立网站</a></li><li id="925b" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" href="https://gohugo.io/" rel="noopener ugc nofollow" target="_blank">用 hugo 建网站</a></li></ul><p id="7885" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<a class="ae ln" href="https://medium.com/@cribbersix" rel="noopener"> Medium </a>上关注我，获取更多关于数据工程工具以及软件和个人发展的文章！</p></div></div>    
</body>
</html>