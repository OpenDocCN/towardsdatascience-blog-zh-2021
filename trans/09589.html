<html>
<head>
<title>Kaggle Competition — Finding Donors for a Charity with an AUC of 0.94</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kaggle竞赛-为AUC为0.94的慈善机构寻找捐赠者</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/kaggle-competition-finding-donors-for-a-charity-with-an-auc-of-0-94-491202a77638?source=collection_archive---------24-----------------------#2021-09-06">https://towardsdatascience.com/kaggle-competition-finding-donors-for-a-charity-with-an-auc-of-0-94-491202a77638?source=collection_archive---------24-----------------------#2021-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="f903" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">使用Python来验证随机森林、梯度增强和XGBoost(使用AUC)的性能，并构建最终模型来预测慈善机构的潜在捐赠者。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/c89c53561cb17079366d97aab4fd5b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xhIgYUhwnpm44VKk"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">马库斯·温克勒在<a class="ae lf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="18f1" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">项目概述</h1><p id="a360" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">该项目将采用3种监督算法，包括<strong class="jt ir">随机森林、梯度推进和XGBoost，</strong>使用1994年美国人口普查数据准确模拟个人收入。然后，我将从初步结果中选择最佳候选算法，并进一步优化该算法以最佳地模拟数据。这个实现的目标是构建一个模型，准确预测一个人的收入是否超过50，000美元。这种任务可能出现在非营利机构中，这些机构依靠捐赠生存。了解个人的收入可以帮助非营利组织更好地了解需要多少捐赠，或者他们是否应该伸出援手。虽然很难直接从公共来源确定一个人的一般收入等级，但我们可以从其他公开的特征中推断出这个值。Kaggle竞赛链接在这里。</p><div class="mm mn gp gr mo mp"><a href="https://www.kaggle.com/c/udacity-mlcharity-competition/overview" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">Udacity ML慈善比赛</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">寻找慈善捐助者</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">www.kaggle.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd kz mp"/></div></div></a></div><h1 id="230d" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">数据集概述</h1><p id="5643" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">这个项目的数据集来自<a class="ae lf" href="https://archive.ics.uci.edu/ml/datasets/Census+Income" rel="noopener ugc nofollow" target="_blank"> UCI机器学习库</a>。Ron Kohavi和Barry Becker在发表文章“提高朴素贝叶斯分类器的准确性:决策树混合”后捐赠了数据集。你可以在网上找到罗恩·科哈维的文章。</p><h1 id="aa24" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">问题陈述</h1><p id="2b58" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">一家慈善机构想知道谁有可能捐款。作为一名数据科学家，我可以利用这个数据集和受监督的机器学习算法来预测慈善机构的潜在捐赠者。</p><h1 id="7850" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">过程</h1><p id="84b5" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">(在此查看<a class="ae lf" href="https://github.com/YuehHanChen/Finding_donors_for_a_charity/blob/main/Finding_Donors_For_A_Charity.ipynb" rel="noopener ugc nofollow" target="_blank">完整代码</a>)</p><blockquote class="jn jo jp"><p id="5c83" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">第一步。评估</em></p><p id="6ab8" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">第二步。预处理</em></p><p id="5edc" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">第三步。计算简单预测器的性能</em></p><p id="5b01" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">第四步。选择3个合适的候选模型</em></p><p id="6683" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">第五步。创建训练和预测管道</em></p><p id="c22a" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">步骤六。初始模型评估和挑选最佳模型</em></p><p id="f9f2" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">第七步。模型调谐</em></p><p id="058b" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">第八步。预处理来自Kaggle </em>的测试数据</p><p id="639c" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">比赛结果</p></blockquote><p id="474c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">注意:这篇文章并不是要解释每一行代码，而是项目中最重要的部分。因此，您可能会发现一些部分只是结果的描述。如果你对代码本身感兴趣，请在这里勾选<a class="ae lf" href="https://github.com/YuehHanChen/Finding_donors_for_a_charity/blob/main/Finding_Donors_For_A_Charity.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="jt ir"/></a><strong class="jt ir">。</strong></p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="e00b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">现在，让我们开始吧！</p><h1 id="8b9b" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第一步。评估</em></h1><p id="5392" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">在使用一些基本的评估函数后，我得到了这样的信息:这个数据集有14列，45222行，0个缺失值。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nm"><img src="../Images/434d7e71d27da43ff5ca1a7fe8fdb34f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t2sCn2c0aRbCQi4XxQ6dFQ.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated"><strong class="bd nn">最后一列，收入，是目标变量。</strong>作者照片</p></figure><p id="89f8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">功能说明:</p><ul class=""><li id="080b" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated"><strong class="jt ir">年龄</strong>:连续。</li><li id="f563" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">工作类别</strong>:私人，自我雇佣非公司，自我雇佣公司，联邦政府，地方政府，州政府，无薪，从未工作。</li><li id="e232" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">教育</strong>:学士、部分大学、11年级、HS-grad、Prof-school、Assoc-acdm、Assoc-voc、9年级、7-8年级、12年级、硕士、1-4年级、10年级、博士、5-6年级、学前教育。</li><li id="1a39" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">教育编号</strong>:连续。</li><li id="1e7a" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">婚姻状况:已婚配偶、离婚、未婚、分居、丧偶、无配偶、无配偶。</li><li id="ee6e" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">职业:技术支持、工艺修理、其他服务、销售、行政管理、专业教授、清洁工、机器操作员、行政文员、农业渔业、运输搬运、私人服务、保安服务、武装部队。</li><li id="8e7d" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">关系</strong>:妻子、亲生子女、丈夫、非家庭成员、其他亲属、未婚。</li><li id="5484" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">种族:黑人、白人、亚洲太平洋岛民、美洲印第安人、爱斯基摩人、其他。</li><li id="33c5" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">性别</strong>:女，男。</li><li id="3cbb" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">资本收益</strong>:持续。</li><li id="f5fd" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">资本损失</strong>:持续。</li><li id="3d9c" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">每周小时数</strong>:连续。</li><li id="3821" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir"/>:美国、柬埔寨、英国、波多黎各、加拿大、德国、美国外围地区(关岛-USVI等)、印度、日本、希腊、韩国、中国、古巴、伊朗、洪都拉斯、菲律宾、意大利、波兰、牙买加、越南、墨西哥、葡萄牙、爱尔兰、法国、多米尼加共和国、老挝、厄瓜多尔、台湾、海地、哥伦比亚、匈牙利、危地马拉、尼加拉瓜、苏格兰、泰国、南斯拉夫、萨尔瓦多、特立尼达和多巴哥&amp;多巴哥、秘鲁、香港、荷兰。</li></ul><h2 id="9c51" class="oc lh iq bd li od oe dn lm of og dp lq mg oh oi lu mi oj ok ly mk ol om mc on bi translated">参见分布</h2><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oo"><img src="../Images/744b423e0e6a4b5d243047dd617285fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmHzU0bv1Yo29oh9tqHUsw.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><p id="fad9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">正如我们所看到的，年龄、资本收益和资本损失的分布是向右倾斜的，所以稍后，我将使用<a class="ae lf" href="https://en.wikipedia.org/wiki/Data_transformation_(statistics)" rel="noopener ugc nofollow" target="_blank">对数</a>变换对它们进行变换。</p><p id="3148" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">评估报告:</p><ul class=""><li id="df9c" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated"><strong class="jt ir">年龄、资本损失、资本收益向右倾斜</strong></li><li id="68be" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">所有数字特征都应被标准化</strong></li><li id="3c63" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">目标变量应该映射到1和0 </strong></li><li id="fd40" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated"><strong class="jt ir">所有分类特征都应该被一次性编码</strong></li></ul><h1 id="1242" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第二步。预处理</em></h1><blockquote class="jn jo jp"><p id="ee68" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">预处理1: <strong class="jt ir">年龄，资本损失，资本收益偏右。</strong></p></blockquote><p id="e0b2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">在进行对数变换后，它们变成了</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi op"><img src="../Images/ef341b35a630554886f33a63149dc5fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dw48Hlw07dxfQzTy2GLUfA.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><p id="931d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">我们可以看到，他们变得更加集中，现在的时代更好，资本收益和资本损失稍微好一些。</p><blockquote class="jn jo jp"><p id="ee55" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">预处理2: <strong class="jt ir">所有数字特征都应该被规范化</strong></p></blockquote><p id="a551" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">使用Sklearn的MinMaxScaler对所有数值特征进行归一化后，数据范围将在1到0之间。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oq"><img src="../Images/884b76fa5129fdb3b52506978a9f17c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Te8ldbD9SPreau5XuVZXog.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><blockquote class="jn jo jp"><p id="0aa5" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">预处理3: <strong class="jt ir">目标变量应该映射成1和0 </strong></p></blockquote><p id="a82f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">对于目标变量收入，我使用了。映射函数将' &gt; 50K '映射到1和'&lt;=50K’ to 0. And the result looks like this</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi or"><img src="../Images/e2f837d1ff62ca5b3e919e6b1163aebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*S08LkhGfmAUf9EQW-xSVMw.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">All the values become either 1 or 0. Photo by author</p></figure><blockquote class="jn jo jp"><p id="97cb" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">Preprocessing 4: <strong class="jt ir">,所有分类特征都应该一键编码。</strong></p></blockquote><p id="efc1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">在最后一个数据预处理步骤中，我使用pd.get_dummies()对分类变量进行一次性编码。</p><p id="0947" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">比如说。最初，“工作类别”变量有几个类别，包括<strong class="jt ir"> </strong>私有、自雇员非公司、自雇员公司、联邦政府、地方政府、州政府、无薪和从未工作。这是“工作类”被一键编码后的样子。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi os"><img src="../Images/ae6f0bfcfb3c53ff2669f7a4a991a84d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KjVjUmR3-l_ySWpCvb2v7w.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">One-hot编码将一个列分成多个列，其中每个类别都有自己的列。如果那一行是state_gov，就像第1行一样，那么state_gov的单元格中就会有1—作者的照片。</p></figure><h1 id="ec75" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第三步。计算简单预测器的性能</em></h1><p id="538f" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">生成一个简单的预测器旨在显示一个没有任何智能的基础模型会是什么样子。因此，当你把你的报告提交给经理时，他们会把它与你的模型进行比较，看看它们是否真的增加了价值。</p><p id="21f4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">在现实世界中，理想情况下，你的基本模型要么是前一个模型的结果，要么是基于你希望改进的研究论文。当没有基准模型集时，你可以从获得比随机选择更好的结果开始。</p><p id="8ec5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">这里，我设置了一个简单的预测器，它总是预测‘1’(也就是说，这个个体赚了超过50k)。该模型将没有真否定(TN)或假否定(FN)，因为我没有做出任何否定(“0”值)预测。因此，在这种情况下，我们的准确性变得与我们的精度相同(真阳性/(真阳性+假阳性))，因为我们用值“1”做出的每个预测都应该为“0”，但都变成了假阳性；因此，在这种情况下，我们的分母是我们拥有的记录总数。</p><p id="cf89" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">在这场比赛中，我们将通过ROC曲线下的面积<strong class="jt ir"> AUC </strong>来判断。因此，我将计算AUC和准确性，以在整个项目中验证模型。</p><p id="ec8c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">对于天真预测者的准确性，由于我们有11001个真阳性和44445个全阳性，我们将得到0.24<strong class="jt ir">的准确性</strong>。</p><p id="63e2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">AUC是通过将所有预测结果(每个点属于阳性和阴性的概率)投影到一维线中来计算的。然后我们计算那条线上几个点的真阳性率和假阳性率。然后，它将所有这些点绘制成2D图表，你可以计算曲线下的面积。</p><p id="9089" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">所以，在这种情况下，由于所有的点都被预测为正，所以它们都聚集在线的右侧。当它计算中间或左侧的任何点时，它将获得1的真阳性率，因为所有真阳性都被正确分类，而假阳性率为1，因为所有阴性点都被错误分类。并且很少有点具有(真阳性率，假阳性率)= (0，0)，因为它在线的左侧。</p><p id="2813" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">所以当我们把许多(1，1)和(0，0)绘制成2D图时，我们会发现三角形面积等于1/2，因为1*1*1/2 = <strong class="jt ir"> 1/2 </strong>。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ot"><img src="../Images/7291363aaea0425caac504395c96488c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmWJA0QrIiRdeKsgF0E3xw.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><p id="9013" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">简单预测的总结:</p><blockquote class="jn jo jp"><p id="20a4" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><strong class="jt ir">精度= 0.2475 </strong></p><p id="fedc" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><strong class="jt ir">曲线下面积= 0.5 </strong></p></blockquote><p id="cb91" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">稍后，我们可以将这些数字与我们将采用的模型的AUC和准确性进行比较，以查看这些模型是否真的增加了价值。</p><h1 id="94ab" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第四步。选择3个合适的候选模型</em></h1><p id="f864" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">我列出了三种监督学习模型，包括随机森林、梯度推进和XGBoost。对于每个选择的模型，我将回答以下问题:</p><blockquote class="jn jo jp"><p id="0aae" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">该模型的优点是什么？</p><p id="a9e3" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">模型的弱点是什么？</p></blockquote><h2 id="7e26" class="oc lh iq bd li od oe dn lm of og dp lq mg oh oi lu mi oj ok ly mk ol om mc on bi translated"><strong class="ak">随机森林</strong></h2><ol class=""><li id="b2a6" class="no np iq jt b ju me jy mf mg ou mi ov mk ow ko ox nu nv nw bi translated">模型的优势是什么；什么时候表现好？</li></ol><ul class=""><li id="a84e" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated">随机森林被认为是一种高度准确和稳健的方法，因为有大量的决策树参与了这一过程。</li><li id="ab21" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">它不会遭受过拟合问题。主要原因是它采用了所有预测的平均值，这抵消了偏差。</li><li id="0ad7" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">该算法可用于分类和回归问题。</li><li id="e5f7" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">资源:(<a class="ae lf" href="https://www.datacamp.com/community/tutorials/random-forests-classifier-python" rel="noopener ugc nofollow" target="_blank">https://www . data camp . com/community/tutorials/random-forests-classifier-python</a>)</li></ul><p id="205f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">2.模型的弱点是什么；什么时候表现差？</p><ul class=""><li id="64ce" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated">随机森林生成预测很慢，因为它有多个决策树。每当它做出预测时，森林中的所有树都必须预测相同的给定输入，然后对其进行投票。整个过程非常耗时。</li><li id="506c" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">与决策树相比，该模型很难解释，在决策树中，您可以通过遵循树中的路径来轻松做出决定。</li><li id="7f0f" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">资源:(<a class="ae lf" href="https://www.datacamp.com/community/tutorials/random-forests-classifier-python" rel="noopener ugc nofollow" target="_blank">https://www . data camp . com/community/tutorials/random-forests-classifier-python</a>)</li></ul><h2 id="b507" class="oc lh iq bd li od oe dn lm of og dp lq mg oh oi lu mi oj ok ly mk ol om mc on bi translated">梯度推进树</h2><ol class=""><li id="6ade" class="no np iq jt b ju me jy mf mg ou mi ov mk ow ko ox nu nv nw bi translated">模型的优势是什么；什么时候表现好？</li></ol><ul class=""><li id="70c1" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated">分类和回归任务都非常高效</li><li id="df69" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">可以处理混合类型的特征，并且不需要预处理(<a class="ae lf" rel="noopener" target="_blank" href="/gradient-boosted-decision-trees-explained-9259bd8205af">https://towardsdatascience . com/gradient-boosted-decision-trees-explained-9259 BD 8205 af</a></li></ul><p id="78c3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">2.模型的弱点是什么；什么时候表现差？</p><ul class=""><li id="18e3" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated">GBDT训练通常需要更长的时间，因为树是按顺序建立的。(<a class="ae lf" href="https://corporatefinanceinstitute.com/resources/knowledge/other/boosting/" rel="noopener ugc nofollow" target="_blank">https://corporatefinanciinstitute . com/resources/knowledge/other/boosting/</a>)</li><li id="90b9" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">需要仔细调整超参数</li><li id="6d8f" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">如果使用太多的树，可能会过拟合(n_estimators)</li><li id="9681" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">对异常值敏感(<a class="ae lf" rel="noopener" target="_blank" href="/gradient-boosted-decision-trees-explained-9259bd8205af">https://towards data science . com/gradient-boosted-decision-trees-explained-9259 BD 8205 af</a>)</li></ul><h2 id="ff67" class="oc lh iq bd li od oe dn lm of og dp lq mg oh oi lu mi oj ok ly mk ol om mc on bi translated">XGBoost</h2><ol class=""><li id="6d93" class="no np iq jt b ju me jy mf mg ou mi ov mk ow ko ox nu nv nw bi translated">模型的优势是什么；什么时候表现好？</li></ol><ul class=""><li id="72cc" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated">速度和性能:它最初是用C++编写的，比其他集成分类器要快得多。</li><li id="291f" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">适用于大型数据集:因为核心XGBoost算法是可并行化的，所以它可以利用多核计算机的能力。它还可以在GPU上和计算机网络上并行化，这使得在大型数据集上进行训练变得可行。</li><li id="c8fe" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">它可以用于选择重要的特征。</li><li id="f0a7" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">需要较少的特征工程(不需要标准化数据，也可以很好地处理缺失值)</li><li id="e079" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">始终优于其他算法方法:它在各种机器学习基准数据集上表现出更好的性能。</li><li id="7355" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">各种各样的调优参数:XGBoost内部有用于交叉验证、正则化、用户定义的目标函数、缺失值、树参数、Sklearn兼容API等的参数。</li><li id="39fc" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">离群值影响最小。</li><li id="0e21" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">当数据混合了数字和分类特征或者只有数字特征时，它表现良好。</li></ul><p id="5bef" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">2.模型的弱点是什么；什么时候表现差？</p><ul class=""><li id="a169" class="no np iq jt b ju jv jy jz mg nq mi nr mk ns ko nt nu nv nw bi translated">如果参数调整不当，可能会过度拟合。</li><li id="ce4c" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">因为有太多的超参数，所以更难调整。</li><li id="8739" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">不适合用XGBoost的时候:图像识别，计算机视觉，自然语言处理，理解问题。</li><li id="8b25" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">根据你对数据的了解，是什么让这个模型成为这个问题的一个很好的候选？</li><li id="a085" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">XGBoost是Kaggle比赛中的常胜将军。</li><li id="4cf1" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko nt nu nv nw bi translated">它支持分类和回归问题。</li></ul><h1 id="2beb" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第五步。创建训练和预测管道</em></h1><p id="19e9" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">这条管道将做五件事:训练<strong class="jt ir">，预测，记录训练/预测时间，计算准确性，以及计算AUC。</strong></p><p id="df16" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">代码如下:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h1 id="adec" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第六步。初始模型评估和挑选最佳模型</em></h1><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi pa"><img src="../Images/00959de56fa642923f45d239bd385213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwJC-5cOhFZMuBD4iJs6tw.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><h2 id="e430" class="oc lh iq bd li od oe dn lm of og dp lq mg oh oi lu mi oj ok ly mk ol om mc on bi translated">XGBoost是最好的模型</h2><ol class=""><li id="cbc6" class="no np iq jt b ju me jy mf mg ou mi ov mk ow ko ox nu nv nw bi translated">我们可以看到，随机森林有点过拟合，因为它有一个高训练分数，但相对较低的测试分数。相比之下，XGBoost表现最好，因为它获得了最高的测试分数，而且训练分数和测试分数几乎相同，这意味着它既没有欠拟合也没有过拟合。</li><li id="f835" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko ox nu nv nw bi translated">虽然XGBoost在训练时间上花费了最多的时间，但它只需要12秒，所以在这个数据集中是可以接受的。</li><li id="bf69" class="no np iq jt b ju nx jy ny mg nz mi oa mk ob ko ox nu nv nw bi translated">XGBoost比朴素预测器表现得更好，精确度为0.2475，AUC为0.5。未经优化的XGBoost已经达到了0.85的精确度和0.8的AUC。</li></ol><h2 id="4164" class="oc lh iq bd li od oe dn lm of og dp lq mg oh oi lu mi oj ok ly mk ol om mc on bi translated">用通俗的语言描述XGBoost</h2><p id="20d1" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">想象一下，让一群高中生解决一组大学水平的数学问题。每个高中生都有一定程度的数学知识，但没有一个人在数学方面有惊人的天赋或糟糕的表现。学生轮流做题，老师做完题会给他们打分。此外，老师会告诉下一个学生前一个学生做错了什么问题，这样他们就会更注意那些问题。重复这个过程，直到每个学生都回答了问题。最后，老师更相信高分学生给出的答案，不太相信低分学生给出的答案，她自己回答问题。XGBoost是老师。XGBoost就是这么训练的。<br/>下次其他大学水平的题给老师的时候，她就用这套记忆来答题，XGBoost就是这么预测的。</p><h1 id="61c7" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第七步。模型调整</em></h1><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/d7797a5d297257796367e0ab5935d311.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*EMBNnoULkBYcxsS-nysWgA.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><p id="1171" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">这里，所有可能的参数集是2⁵ = 32。所以，如果我使用网格搜索，它会运行32次来找到最好的一个。由于它将使用300或400个估值器进行测试，所以运行32次可能需要很长时间。</p><p id="db75" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">因此，我使用了<a class="ae lf" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html" rel="noopener ugc nofollow" target="_blank">随机搜索</a>来寻找最佳的一组超参数，这将随机选择一组超参数进行测试。因此，它不能保证找到最好的，但它运行得更快。这是结果:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/e2a9a694ef29573a40cfbb7e5e0186b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*ushrldmWaLz9K_j8WcA36A.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><p id="85ca" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">我们可以看到准确性和AUC都有所增加。</p><h1 id="716b" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><em class="nl">第八步。预处理来自Kaggle </em>的测试数据</h1><p id="7c63" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">为了正确地预处理测试集，我们必须遵循我们用于预处理训练集的相同过程，包括<strong class="jt ir">转换</strong> <strong class="jt ir">年龄、资本损失、资本收益、归一化所有数字特征，以及一次性编码所有分类特征。</strong></p><p id="8cfa" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">但是在这之前，我们必须先看看这个测试集是否有缺失值。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi pd"><img src="../Images/238696898479603a6559d726631694db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3JMhvqbYI7ub-iIXxAL5mg.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><p id="fd24" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">正如我们所看到的，几乎每一列都有自己缺失的值，所以这里我考虑三种情况。首先，如果数字数据是倾斜的，那么我将使用来自训练集的同一列的中值来填充缺失的值。其次，如果数值数据大致呈正态分布，那么我将使用训练集中同一列的平均值来填充缺失值。最后一种情况是分类值。然后，我将使用在训练集中的相同列中出现最多的模式或类别来填充缺少的值。在填充缺失值后，我进行了与训练集相同的预处理过程。</p><p id="0294" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">在对数据进行预处理后，我将它们放入优化的XGBoost模型中，这是比赛结果。</p><h1 id="405f" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated"><strong class="ak"> Kaggle比赛结果</strong></h1><p id="d07d" class="pw-post-body-paragraph jq jr iq jt b ju me jw jx jy mf ka kb mg mh ke kf mi mj ki kj mk ml km kn ko ij bi translated">在212支队伍中，我排在第30位！</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi pe"><img src="../Images/879defc8e8ab42cf8006461dcef596fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-MkaAe-l5aHz7ePfhhm5Rg.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">作者照片</p></figure><p id="eb5a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb mg kd ke kf mi kh ki kj mk kl km kn ko ij bi translated">谢谢你看完！如果你对这个项目的完整代码感兴趣，请查看<a class="ae lf" href="https://github.com/YuehHanChen/Finding_donors_for_a_charity/blob/main/Finding_Donors_For_A_Charity.ipynb" rel="noopener ugc nofollow" target="_blank"> my Github </a>。另外，我喜欢反馈。如果有什么不清楚的地方或者应该做得更好的地方，请联系我。下面是我的<a class="ae lf" href="https://www.linkedin.com/in/yueh-han-chen/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p></div></div>    
</body>
</html>