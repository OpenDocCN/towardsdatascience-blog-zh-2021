<html>
<head>
<title>How to Migrate Your Data from Redshift to Snowflake</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将您的数据从红移迁移到雪花</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-migrate-your-data-from-redshift-to-snowflake-81208ebb2686?source=collection_archive---------28-----------------------#2021-10-19">https://towardsdatascience.com/how-to-migrate-your-data-from-redshift-to-snowflake-81208ebb2686?source=collection_archive---------28-----------------------#2021-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="740b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">借助开源数据集成，轻松将您的数据从Redshift中取出并放入雪花中</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b16c259fc6077fa722b069cf439084a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUOtvAWHpLFqGuI6H2fHhQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="fa88" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">几十年来，数据仓库解决方案一直是企业报告和商业智能的支柱。但是，近年来，像亚马逊红移和雪花这样的基于云的数据仓库变得非常流行。那么，为什么有人想要从一个基于云的数据仓库迁移到另一个呢？</p><p id="571f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">答案很简单:</strong>更多<em class="lr">规模和灵活性</em>。<strong class="kx ir"> </strong>借助雪花，用户可以通过自动添加节点，快速独立地横向扩展数据和计算资源。使用VARIANT数据类型，雪花还支持存储更丰富的数据，如对象、数组和JSON数据。正如红移用户所知，调试红移并不总是那么简单。有时，它超越了可能引发迁移欲望的特性差异。也许你的团队只是知道如何比红移更好地使用雪花，或者也许你的组织想要在一个特定的技术上标准化。</p><p id="d19a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本食谱将解释使用<a class="ae ls" href="https://airbyte.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> Airbyte </strong> </a>从红移迁移到雪花以最大化您的业务价值所需采取的步骤。‍</p><h1 id="a37a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">先决条件</h1><p id="8ea0" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated"><strong class="kx ir"> 1。你需要Airbyte来移动你的数据。要部署Airbyte，请遵循我们文档中的简单说明<a class="ae ls" href="https://docs.airbyte.io/quickstart/deploy-airbyte" rel="noopener ugc nofollow" target="_blank">这里</a>。</strong></p><p id="770e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 2。</strong>红移和雪花都是SaaS的服务，你需要在这些平台上有一个账户才能开始。</p><p id="2c61" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 3。</strong>当您使用Redshift创建数据仓库集群时，默认情况下，它会在其中添加样本数据。我们的数据存储在我们在<em class="lr">‘开发’</em>数据库中创建的“<em class="lr">红移-星团”</em>中。创建的集群可以在仪表板上的'<em class="lr"> Amazon红移&gt;集群'</em>下看到。要创建一个新的集群，请单击下面突出显示的图标，然后继续操作。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/d2a4e735e9da45892db744afadb0bd2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lf6hXCFUX4SyOYUG.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="9854" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 4a) </strong>对于目的地，您需要在Snowflake中创建一个空的数据库和仓库来托管您的数据。为此，单击导航栏中显示的数据库图标，点击<em class="lr">“创建…”。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/b2fb94a343d99de0c59777dcea975907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qqIHnx2TlMlrLu84.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3033" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">为您的数据库提供一个名称</em>。在下面的例子中，我们将数据库命名为“雪花_目的地”。‍</p><p id="d67b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 4b) </strong>建立数据库后，点击仓库图标<em class="lr">‘创建’</em>一个名为<em class="lr">‘计算_ WH’的仓库。在我们的例子中，我们使用了一个X-Small计算实例。但是，您可以使用更大的实例类型或添加更多实例来扩展计算实例。这可以通过几次简单的点击来实现，并将在后面的部分中演示，以说明迁移的商业价值。现在，您已经具备了开始迁移的所有先决条件。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/dfbd5edda905c9157ac2ac7cf52cd6ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pdc3mqErCHLC1hIf.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="cac5" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤1:在Airbyte中设置红移源</h1><p id="c4d9" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">在网络浏览器中导航到<a class="ae ls" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8000 </a>，打开Airbyte。<strong class="kx ir"> 1b) </strong>填写以下详细信息，继续设置信号源-</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/d2d7efbe50fd86c361ddcf721015553e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/0*7-ZoMTIAlMINCDRP.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="42dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<em class="lr">‘设置源’‘</em>airbyte屏幕中，我们在本例中将源命名为<em class="lr">‘红移_源’</em>，但是如果您愿意，您可以将其更改为其他名称。我们选择的源类型为'<em class="lr">红移'</em>。其余的信息可以从红移星团仪表盘中获得，如下图突出显示的部分所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/ca0ac28d844a23c3b5db12e658d002a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NbucV3I5J6WmhoAE.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="05e8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">除此之外，还有一些设置需要在你的红移控制台中进行调整。例如，假设您在本地机器上运行Airbyte并连接到Redshift。在这种情况下，您需要使您的集群能够通过互联网公开访问，以便Airbyte可以连接到它。您可以通过导航到红移控制台上的<em class="lr">“操作”</em>下拉菜单，单击<em class="lr">“修改公共可访问设置”</em>并将其更改为“启用”(如果尚未启用)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/4e787efe942f7363c3045ab4f1a4bdbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z7OjJYhLHwBtniZ3.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/312654215450e87b6d71676f32453906.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/0*tJkBQKA3txUUCk42.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="5d14" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，转到AWS提供的VPC服务。您可以在搜索栏中搜索它，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/954de4babaa1467fef060128c994afcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MCTEOC3EayT8rw5X.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1376" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后导航到左侧的<em class="lr">“安全组”</em>选项卡，进入如下所示的页面，创建一个自定义的入站和出站规则。例如，您需要在端口5439上创建一个自定义TCP规则，允许来自本地IP地址的传入连接。保存规则后，它将在控制面板上以蓝色突出显示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/70b15fdb9fba515ea3eb9cb5272c4984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sr0BCNDGqNrV9AU4.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="8c0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">自定义入站规则需要具有如下图所示的规范。<strong class="kx ir"> <em class="lr">注意，出站规则也需要做同样的步骤，然后您的红移源将准备好与Airbyte连接。</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/aebe899cd590ff28be667bbf87c8fd82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WkO2sRN8du8-0DYS.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="b554" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤2:在Airbyte中设置雪花的目的地</h1><p id="8ac9" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">配置源之后，进入Airbyte中的“设置目标”页面来配置目标。</p><p id="b8c3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与上一步类似，目的地名称是可定制的。在本例中，我们使用了“<em class="lr">雪花_目的地</em>”。然后，我们选择目的地类型为雪花。有关其他必填字段的详细信息，请参考下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/f6839ef11b49ffe2bff3fa34530491aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ppsc1fScd-52vnWa.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e348" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">可以从雪花仪表板中检索主机值。</p><p id="7582" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:在这个例子中，我们在雪花中使用SYSADMIN角色，但是强烈建议在雪花中创建一个定制角色<a class="ae ls" href="https://docs.snowflake.com/en/user-guide/security-access-control-considerations.html" rel="noopener ugc nofollow" target="_blank">，并减少使用Airbyte的权限。默认情况下，Airbyte使用Snowflake的默认模式来写数据，但是如果您愿意，可以将数据放在另一个模式中(就像我们的例子中的REDSHIFT_SCHEMA)。当您希望将正在迁移的数据与现有数据分开时，拥有单独的模式会很有帮助。最后，用户名和密码应该与创建雪花帐户时设置的凭证一致。</a></p><p id="710f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击“Setup the destination”按钮，如果一切顺利，您应该会看到一条消息，告诉您所有的连接测试都已通过。</p><h1 id="332f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤3:建立连接</h1><p id="bcaa" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">一旦设置了目的地，您将被引导至Airbyte中的<em class="lr">“设置连接”</em>屏幕。在这一步中，您会注意到Airbyte已经检测到了要迁移的表和模式。默认情况下，选择所有表进行迁移。但是，如果您只想迁移数据的子集，可以取消选择要跳过的表。在此步骤中，您还可以指定详细信息，例如源和目标之间的同步频率。如图所示，有几个时间间隔选项，从5分钟到每小时。同步操作的粒度也可以通过为您的使用案例选择正确的同步模式来设置。阅读Airbyte文档中的<a class="ae ls" href="https://docs.airbyte.io/understanding-airbyte/connections" rel="noopener ugc nofollow" target="_blank">同步模式了解更多详情。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/f99fbda63f7d8b3f9f5e25b306e47114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IzjWZW1wnzmgVmVq.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e455" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">指定所有定制后，我们可以单击'<em class="lr">设置连接'</em>,开始从红移到雪花的数据迁移。一目了然，您将能够看到连接的上次同步状态以及上次同步发生的时间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/42700ff0fbfa28479396fa31359b4fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*A1rH5fNxNQopI3A0.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="837c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是使用Airbyte将您的数据从红移移动到雪花有多容易。但是，如果您想验证迁移是否已经发生，请查看雪花中的目标数据库，您会注意到还存在额外的数据表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/81892c18f2ce34f8af1ebda2a7a5ce20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2LlFnIT1-Hb9AqEr.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="864b" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤4:评估结果</h1><p id="a550" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">成功迁移数据后，让我们来评估激发迁移的雪花的关键特性。在雪花中，计算能力和存储是解耦的，使得雪花的存储容量不依赖于集群大小。<strong class="kx ir"> </strong>此外，与Redshift繁琐的过程相比，Snowflake只需简单的三次点击就能扩展数据。‍</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/b526eec5a22395da71ee7f26cb1b62c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qGJ7ksn8adQhMNod.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="5762" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如下图所示，Airbyte使用VARIANT数据类型将JSON数据加载到雪花表中。使用Snowflake强大的JSON查询工具，您可以处理存储在表中的JSON数据和非JSON数据。另一方面，Redshift对半结构化数据类型的支持有限，需要多个复杂的子表连接来生成报告视图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/b8fd9d0f097c27dbc01b880f3f5ddebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HAXIbPpcgRukk1P7.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="d0a8" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结束了。</h1><p id="141f" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">总结一下，我们在这个食谱中做了以下工作:</p><p id="365a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">1.配置了一个红移气源</p><p id="a8ed" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.配置了一个雪花Airbyte目的地</p><p id="46d1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.创建了一个Airbyte连接，可自动将数据从红移迁移到雪花</p><p id="c23a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.使用VARIANT数据类型探索了易于使用的伸缩特性和对雪花中JSON数据的支持</p><p id="aef9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们知道，在时间紧迫的快速发展项目中工作的开发和运营团队需要积极开发Airbyte的开发人员快速回答他们的问题。他们还希望与“亲身经历过”的有经验的社区成员分享他们的经验</p><p id="24ca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae ls" href="https://airbyte.io/community" rel="noopener ugc nofollow" target="_blank">加入Airbyte社区Slack频道的对话</a>，与1000多名数据工程师分享您的想法，帮助每个人的项目取得成功。</p><p id="a53a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有了Airbyte，集成的可能性是无限的，我们迫不及待地想看看你要构建什么！</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><p id="ec4d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">原载于</em> <a class="ae ls" href="https://airbyte.io/recipes/redshift-to-snowflake" rel="noopener ugc nofollow" target="_blank"> <em class="lr"> Airbyte </em> </a></p></div></div>    
</body>
</html>