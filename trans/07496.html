<html>
<head>
<title>Analyzing Hindu Verses with NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用自然语言处理分析印度诗歌</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-hindu-verses-with-nlp-25d72986703b?source=collection_archive---------30-----------------------#2021-07-08">https://towardsdatascience.com/analyzing-hindu-verses-with-nlp-25d72986703b?source=collection_archive---------30-----------------------#2021-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="682e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python对“毗湿奴”和“魔鬼”斯洛卡进行分类</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/324fa1215540711a1aa4a43668b324c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f7pNgOJ7anlgPPA6"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">布达扬·巴德汉在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6ac8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“文本分类”是一种机器学习技术，用于分析文本，然后根据模式或结构对其进行组织或分类。文本分类在人工智能领域有很多<a class="ae ky" rel="noopener" target="_blank" href="/text-classification-applications-and-use-cases-beab4bfe2e62"> <em class="lv">应用</em> </a>比如新闻文章分析、仇恨言论识别、性别分类等。在这篇文章中，我使用“文本分类”和使用Python的自然语言处理(NLP)来分析印度教经文并对它们进行分类。在我们更深入地研究Python的技术方面之前，让我们快速地看看我们将处理哪些数据。</p><p id="e215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“<a class="ae ky" href="https://en.wikipedia.org/wiki/Sahasranama" rel="noopener ugc nofollow" target="_blank">Sahasranama</a>”——字面上有1000个名字(其中“<em class="lv"> sahasra </em>”的意思是1000，而“<em class="lv"> nama </em>”的意思是名字)——是一首赞美印度教神的圣歌。<a class="ae ky" href="https://en.wikipedia.org/wiki/Lalita_Sahasranama" rel="noopener ugc nofollow" target="_blank"><em class="lv"/></a>【颂难近母女神】和<a class="ae ky" href="https://en.wikipedia.org/wiki/Vishnu_Sahasran%C4%81ma" rel="noopener ugc nofollow" target="_blank"> <em class="lv">毗湿奴</em> </a>【颂摩诃毗湿奴】就是这样两个颂难近母女神和摩诃毗湿奴的诗句，各有1000个不同的名字。我从以下链接中获得了用于我们分析的数据:'<a class="ae ky" href="https://vignanam.org/english/sree-lalita-sahasra-namavali.html" rel="noopener ugc nofollow" target="_blank"><em class="lv">Lalitha Sahasranama</em></a>'和'<a class="ae ky" href="https://stotranidhi.com/en/sri-vishnu-sahasra-namavali-in-english/" rel="noopener ugc nofollow" target="_blank"><em class="lv">Vishnu Sahasranama</em></a>'，并对其进行了清理，删除了“om”和“namah”，并将数据保存为<a class="ae ky" href="https://github.com/dpakapd/sahasranama_analysis" rel="noopener ugc nofollow" target="_blank"> <em class="lv">文本文件</em> </a>。</p><h2 id="03af" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">导入库:</h2><p id="efc6" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">第一步是导入我们分析所需的库。从下面的代码中可以看出，我们使用了3个不同的库。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="b011" class="lw lx it mv b gy mz na l nb nc">#Import required libraries</span><span id="9e48" class="lw lx it mv b gy nd na l nb nc">from nltk.classify import accuracy #For accuracy predictor<br/>import random #For randomly shuffling the names<br/>import nltk #Natural Language toolkit</span></pre><p id="5e62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">NLTK —自然语言工具包</p><p id="cb7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">NLTK准确性——用于显示我们预测的准确性</p><p id="590d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Random —用于为我们的训练集和测试集随机排列名称</p><h2 id="eed6" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">加载数据和标记:</h2><p id="5190" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在“读取”模式下使用<a class="ae ky" href="https://docs.python.org/3/tutorial/inputoutput.html" rel="noopener ugc nofollow" target="_blank"> <em class="lv"> open() </em> </a>功能，然后使用<a class="ae ky" href="https://www.w3schools.com/python/ref_file_readlines.asp" rel="noopener ugc nofollow" target="_blank"> <em class="lv"> readlines() </em> </a>功能将文件的内容分配给一个列表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">读取数据并标记它</p></figure><p id="3fb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是将标签'<em class="lv"> Devi </em>'和'<em class="lv"> Vishnu </em>'分配给被读取的相应诗句。这个标签后面会用来给诗句分类。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/d925020159c05459aeffdb0b9e0961f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CBveZMcjKQ-F6Xex4OfKtg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标签分配的输出Jupyter笔记本的屏幕截图</p></figure><p id="5c15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://docs.python.org/3/library/random.html" rel="noopener ugc nofollow" target="_blank"><em class="lv">random . shuffle()</em></a>函数用于随机打乱列表，使数据均匀分布在两个列表中。</p><h2 id="e081" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">特征提取:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">定义特征提取的函数</p></figure><p id="f7ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们定义一个函数来从列表中传递的诗句中提取特征。定义的函数提取最后2个字符来开发模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/4776a61fe6707c98410074291820f9d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oFZtEtACocsCK-Bgu4QQcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从诗歌列表中提取特征Jupyter笔记本截图</p></figure><h2 id="c696" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">使用朴素贝叶斯分类器创建模型:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8f4fda0dcc5fe3f78f69ad10ac472203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*ixNG1M8eXb9C27SVIOfeLw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图像专家:走向数据科学— <a class="ae ky" rel="noopener" target="_blank" href="/naive-bayes-classifier-81d512f50a7c">朴素贝叶斯分类器。什么是量词？|作者Rohith Gandhi |走向数据科学</a></p></figure><p id="477e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">朴素贝叶斯分类器基于贝叶斯定理，该定理用于通过假设第二个事件B已经发生来找出事件A发生的概率。</p><p id="aade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步是将数据分为训练集(前1000节)和测试集(后1000节)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查最具信息性的特征和模型准确性</p></figure><p id="6112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.nltk.org/api/nltk.classify.html" rel="noopener ugc nofollow" target="_blank">nltk . classify . accuracy()</a>函数用于显示使用训练集或测试集作为参数的预测结果的准确性。</p><p id="ffcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.nltk.org/api/nltk.classify.html#nltk.classify.naivebayes.NaiveBayesClassifier.show_most_informative_features" rel="noopener ugc nofollow" target="_blank">show _ most _ informational _ features</a>(n)函数基于特征提取突出显示可用诗句的最具信息性的n个特征。</p><p id="6dfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类器精度和“显示大多数信息特征”的输出如下所示。这个分类器有将近97%的准确率。我们也看到，与神摩诃毗瑟奴相对应的诗句通常以“ya”结尾，而与女神难近母相对应的诗句通常以“ai”作为最后两个字符。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/a1ad1c9da8c8324202047c33d395b98c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pteeIhtNI7DRgpqb-7L_WA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的数据集最具信息性的特征Jupyter笔记本截图</p></figure><h2 id="8e81" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">检查分类输出:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/9651ade6f140c49e97593616c41dfec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*fWB4eQl8rpst2XbByLG2vg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查分类输出Jupyter笔记本的屏幕截图</p></figure><p id="b08b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们检查分类输出，并将其与之前分配给诗句的原始标签进行比较。为此，我们创建一个空列表，然后使用(classifier . classify(name _ features(name)))函数比较模型的输出，并将其与之前最初分配的标签进行比较。如果我们有兴趣查看那些不匹配的，我们可以简单地替换“If”条件来查找输出，其中model_output！=神。这里显示了一个正确分类输出的示例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查模型输出与标签</p></figure><p id="ac4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">整个代码可以通过<a class="ae ky" href="https://github.com/dpakapd/sahasranama_analysis.git" rel="noopener ugc nofollow" target="_blank"> <em class="lv"> Github库</em> </a>下载。</p><h2 id="4225" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">参考资料:</h2><ol class=""><li id="15be" class="nl nm it lb b lc mp lf mq li nn lm no lq np lu nq nr ns nt bi translated"><a class="ae ky" href="https://www.cs.bgu.ac.il/~elhadad/nlp16/Classification.html" rel="noopener ugc nofollow" target="_blank">分类(bgu.ac.il) </a> —使用NLTK进行性别分类的优秀范例</li><li id="0e5a" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://www.geeksforgeeks.org/python-gender-identification-by-name-using-nltk/" rel="noopener ugc nofollow" target="_blank"> Python |使用NLTK的性别识别— GeeksforGeeks </a></li><li id="5d64" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/naive-bayes-classifier-81d512f50a7c">朴素贝叶斯分类器。什么是量词？|作者Rohith Gandhi |走向数据科学</a></li><li id="bcfd" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://www.nltk.org/api/nltk.classify.html" rel="noopener ugc nofollow" target="_blank"> nltk.classify包— NLTK 3.6.2文档</a></li><li id="d66c" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://pythonprogramming.net/naive-bayes-classifier-nltk-tutorial/" rel="noopener ugc nofollow" target="_blank"> Python编程教程</a></li><li id="0e9a" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://medium.com/@ishan.cdixit/pythons-natural-language-tool-kit-nltk-tutorial-part-3-84a8bcb089bd" rel="noopener"> Python的自然语言工具包(NLTK)教程第3部分|作者:Ishan Dixit | Medium </a></li></ol></div></div>    
</body>
</html>