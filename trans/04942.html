<html>
<head>
<title>Customer Satisfaction Prediction Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习的顾客满意度预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/customer-satisfaction-prediction-using-machine-learning-66240e032962?source=collection_archive---------3-----------------------#2021-04-30">https://towardsdatascience.com/customer-satisfaction-prediction-using-machine-learning-66240e032962?source=collection_archive---------3-----------------------#2021-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="df01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">预测客户对从巴西电子商务网站Olist购物的满意度。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/f6ff95a72e2e37026fcb5aad385fbaa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4gnQD5MrEWDXgNEzquluQ.jpeg"/></div></div></figure><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="0774" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">This Article Includes:<br/>1.Introduction<br/>2.Business Problem<br/>3.Problem Statement<br/>4.Bussiness objectives and constraints<br/>5.Machine Learning Formulation<br/>   i Data Overview<br/>   ii.Data Description<br/>  iii.Machine Learning Problem<br/>   iv.Performance Metrics<br/>6.Exploratory Data Analysis(EDA)<br/>      a.Data Cleaning and Deduplication<br/>      b.High Level Statistics<br/>      c.Univariate Analysis<br/>      d.Bivariate Analysis<br/>      e.Multivariate Analysis<br/>      f.RFM Analysis<br/>      g.Conclusion<br/>7.Data Preprocessing and Feature Engineering<br/>8.Model Selection <br/>9.Summary<br/>10.Deployment<br/>11.Improvements to Existing Approach<br/>12.Future Work<br/>13.Reference</strong></span></pre><h2 id="e0c9" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated"><strong class="ak"> 1。简介</strong></h2><p id="b1f8" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">近年来，随着互联网在世界不同地区的普及，电子商务领域正在迅速发展。这一行业正在重新定义全球商业活动，并在当今的日常生活中发挥着至关重要的作用。还观察到，消费者经常订购的主要商品类别是服装、杂货、家庭装修材料等，这些产品的比例在未来可能会显著增加。</p><p id="393c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总的来说，我们可以说电子商务是一种由互联网驱动的媒介，客户可以通过自己的设备(电脑、平板电脑或智能手机)访问在线商店进行浏览，并订购产品或服务。</p><p id="eab2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例子-电子商务交易，包括书籍、杂货、音乐、飞机票和金融服务，如股票投资和网上银行。</p><p id="7632" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">电子商务主要有四种类型；这些如图1所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/0b4ad36c3d82fa8fff0cfad3c48b896c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fyQ-q1E5HfB72uMYjWNvSw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图1 pari tosh Mahto的电子商务图像类型</p></figure><p id="b8a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">电子商务的主要优势是它每周7天、每天24小时都可以使用，在一个平台上可以买到更广泛的产品。缺点是有限的消费者服务，因为很难在线向消费者展示每个产品，交付产品需要时间。</p><p id="fd8d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">机器学习可以在电子商务中发挥重要作用，如销售预测、预测消费者的下一个订单、评论预测、情感分析、产品推荐等。它还可以通过电子商务提供服务，如语音搜索、图像搜索、聊天机器人、店内体验(增强现实)等</p><h2 id="a0ec" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated"><strong class="ak"> 2。业务问题</strong></h2><p id="2175" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">Olist是巴西的一个电子商务网站，它提供了一个更好的平台，将商家及其产品与巴西的主要市场联系起来。Olist于2018年11月在Kaggle上发布了这个数据集。</p><p id="6fbb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该数据集包含巴西多个市场2016年至2018年的10万份订单信息。其功能允许从多个维度查看订单:从订单状态、价格、付款和货运表现到客户位置、产品属性，最后是客户撰写的评论。还发布了将巴西邮政编码与经纬度坐标联系起来的地理位置数据集。</p><ul class=""><li id="075e" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">这项业务是基于消费者、网店和卖家之间的互动。</li><li id="2fb4" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">首先，消费者在Olist网站上下订单。Olist store收到该订单后，会根据订单信息(如产品类别、地理位置、付款方式等)向卖家发送通知。</li><li id="0143" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">在从卖方收到产品并在预计交付时间内交付给消费者之后。</li><li id="33a0" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">一旦客户收到产品，或者如果预计交付日期到期，客户将通过电子邮件获得一份满意度调查，他可以在其中给出购买体验的注释并写下一些评论。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mz"><img src="../Images/972d71a6aba3e6e5121d7582c6f14421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RdQnwwab4Z1HyK1P"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">Andre Sionek的工作流程图，图片来源[<a class="ae na" href="https://www.kaggle.com/andresionek/predicting-customer-satisfaction" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/andresionek/predicting-customer-satisfaction</a>]</p></figure><h2 id="aa43" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated"><strong class="ak"> 3。问题陈述</strong></h2><ul class=""><li id="0c1c" class="ml mm it js b jt mc jx md kb nb kf nc kj nd kn mq mr ms mt bi translated">对于给定的客户历史数据，预测下一个订单或购买的评论分数。</li><li id="24e3" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">这个问题陈述可以进一步修改，以预测从巴西电子商务网站Olist购买的客户满意度(正面或负面)。</li></ul><h2 id="9171" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated"><strong class="ak"> 4。业务目标和约束</strong></h2><ul class=""><li id="3b62" class="ml mm it js b jt mc jx md kb nb kf nc kj nd kn mq mr ms mt bi translated">无延迟-延迟要求。</li><li id="7ebf" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">模型的可解释性有助于理解客户的行为。</li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="1d7a" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated"><strong class="ak"> 5。机器学习公式</strong></h2><p id="e9d9" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">这里，目标是根据给定的特征，如价格、商品描述、准时交付、交付状态等，预测给定订单的客户满意度得分。</p><p id="9c57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">给定的问题可以通过多类分类问题(预测分数[1，2，3，4，5])、二进制分类问题(0为负1为正)或回归问题(用于预测分数)来解决</p><p id="f07e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 5.i数据概述</strong></p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="8d3e" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Source:-</strong> https://www.kaggle.com/olistbr/brazilian-ecommerce<strong class="lb iu"><br/>Uploaded In the Year : 2018<br/>provided by : Olist Store</strong></span></pre><p id="38c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了更好地理解和组织，数据被分成多个数据集。</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="8a55" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Data is available in 9 csv files:<br/>1. olist_customers_dataset.csv (data)<br/>2. olist_geolocation_dataset.csv(geo_data)<br/>3. olist_order_items_dataset.csv(order_itemdata)<br/>4. olist_order_payments_dataset.csv(pay_data)<br/>5. olist_order_reviews_dataset.csv(rev_data)<br/>6. olist_orders_dataset.csv(orders)<br/>7. olist_products_dataset.csv(order_prddata)<br/>8. olist_sellers_dataset.csv(order_selldata)<br/>9. product_category_name_translation.csv(order_prd_catdata)</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nl"><img src="../Images/9f6e91ea7bc7f3ee246c8f3d5a346bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FSXB0fBplpA1tTdq"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">Olist商店的数据模式，图像源[<a class="ae na" href="https://www.kaggle.com/olistbr/brazilian-ecommerce" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/olistbr/brazilian-ecommerce</a></p></figure><ul class=""><li id="17b3" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">olist_orders_dataset使用order_id和customer_id将每次购买的订单数据与其他数据关联起来。</li><li id="5521" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">olist_order_reviews_dataset将订单数据表中每个订单的已标记审核数据标记为[1，2，3，4，5]，其中5为最高，1为最低。</li><li id="545a" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">我们将使用大于3的评价作为正面评价，小于等于3的评价作为负面评价。</li><li id="6b90" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">数据将被相应地合并，以获得分析、特征选择和模型训练所需的最终数据。</li></ul><p id="0348" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 5 .二、数据描述</strong></p><p id="6434" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">列数和行数，每个列的名称为。csv文件显示在此数据框中:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="4aa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">关于所有列/特征的描述如下所示:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="a170" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">5.3 .机器学习问题</strong></p><p id="b178" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上述问题可以公式化为二元分类问题，即对于给定的订单和消费者的购买数据，预测评论将是正面的还是负面的。</p><p id="c9ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 5 .四、绩效指标</strong></p><ul class=""><li id="7fab" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">宏f1-分数-</li><li id="cfb6" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">混淆矩阵</li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="a79a" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">6.探索性数据分析</h2><p id="5a01" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">就我们对业务问题的理解和对机器学习问题陈述的表述而言。我们还了解了数据集和大多数功能。现在，我们将对该数据集进行探索性数据分析，以获得对特征的更多了解。</p><p id="91fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我遵循的第一步是阅读所有。并检查了每个csv文件中的列及其数据类型。在这之后，所有的数据根据给定的数据模式被合并。此外，我执行了数据清理，并对数据集进行了不同的分析。</p><p id="4756" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 6.a数据清理</strong></p><ul class=""><li id="e4e8" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">处理缺失值</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="34d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">合并后的最终数据有许多空值。最大数量的空值出现在对象数据类型的列<code class="fe no np nq lb b"><strong class="js iu">review_comment_message</strong></code>中。类似于<code class="fe no np nq lb b"><strong class="js iu">order_approved_at</strong></code> <strong class="js iu">、</strong> <code class="fe no np nq lb b"><strong class="js iu">order_delivered_carrier_date</strong></code>和<code class="fe no np nq lb b"><strong class="js iu">order_delivered_customer_date</strong></code>的列也是空值。这些丢失的值要么被替换，要么被丢弃。代码如下所示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><ul class=""><li id="76d0" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">重复数据删除</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3ba4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如您可以观察到的重复行，如order_id为<code class="fe no np nq lb b"><strong class="js iu">82bce245b1c9148f8d19a55b9ff70644</strong></code> <strong class="js iu"> </strong>的行，所有的列都是相同的。我们可以去掉这几行，保留第一行。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0461" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 5.b高标签统计</strong></p><p id="7078" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">合并、清理和重复数据删除后的最终数据具有以下特征-</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="f06c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">合并后的数据有32列，并且具有诸如order_status、payment_type、customer_state和product_ category _name_english之类的分类特征。一个名为review_comment_message的列包含葡萄牙语文本数据。数字特征也很少。数字特征的描述如下所示-</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="63d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以从上表中观察到-</p><ul class=""><li id="232a" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">订单的价格和运费。订单的最高价格为6735，而最高运费约为410巴西雷亚尔。订单的平均价格约为125巴西雷亚尔，运费价值约为20巴西雷亚尔。最低价格为0.85巴西雷亚尔的订单已经完成。</li><li id="3c35" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">对于payment_value，订单的最大支付值为13664巴西雷亚尔。此外，我们可以观察统计数据，如百分位值、平均值和标准偏差值、计数、最小值和其他数字特征的最大值。</li></ul><p id="bfd9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">相关矩阵-</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/24057c4784ada95d28b850a8e225fbc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CkFeq1cl17MvGXD96w1VZA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="2141" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们观察目标变量，即审查分数，大于或等于3的分数被认为是1(正)，否则为0(负)。从目标变量的分布来看，我们可以观察到85.5%的评论是正面的，14.5%是负面的。由此，我们可以得出结论，给定的数据集是偏斜的或不平衡的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/8c6aea67617f8a6a761ca8db68fadbb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QFush57lIPaYQ-jhT3vI8w.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="6810" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 5.c单变量分析</strong></p><p id="e02c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个电子商务数据集中，主要使用四种类型的支付方式，即信用卡、baleto、凭单和借记卡。</p><blockquote class="nt nu nv"><p id="c6b5" class="jq jr nw js b jt ju jv jw jx jy jz ka nx kc kd ke ny kg kh ki nz kk kl km kn im bi translated">注:<strong class="js iu">Baleto</strong>= =&gt;Boleto bancáRio，简称Boleto(英文:Ticket)是在巴西由FEBRABAN监管的一种支付方式，是<a class="ae na" href="https://jovian.ai/outlink?url=http%3A%2F%2FBanks.It" rel="noopener ugc nofollow" target="_blank">银行巴西联合会的简称。它</a>可以在任何银行、邮局、彩票代理和一些超市的自动柜员机、分支机构和网上银行支付，直到到期日。</p></blockquote><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/db60d1257cd5cf9375464f97b51b3a57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4N_SsTsg4Pa5bPxHDgLKQ.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="e733" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">从上面的图中，我们可以观察到大多数订单是使用信用卡支付的，第二常用的支付方式是boleto。</li><li id="b31c" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">每种支付方式的百分比显示在饼状图中，该图显示在用户进行的所有支付中，75.9%的用户使用信用卡，19.9%的用户使用baleto，3.2%的用户使用凭单和借记卡。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/1b22f43c297ebf3ea13137c19e70fe01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FWqc8NRQZCLrAz4xB1X0hQ.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="6acc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以从上面的帕累托图中观察到，96%的顾客使用了信用卡和baleto。让我们看看这个特性是如何与我们的目标变量相关联的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/15c72b352bd712bc5e32d358817ddef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LjYZtyVsSYtjH3s27VWIUg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="3ee8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以从上面的叠加图中观察到，大多数使用信用卡的客户都给予了积极的评价。此外，对于boleto、凭证和借记卡用户来说，也是一样的。由此，我们可以得出结论，这可能是我们对这个问题的重要的分类特征。</p><p id="8993" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们对customer_state列进行单变量分析。该列包含相应customer_id的州代码。巴西地图上的州名和州代码如下所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/de6ca3ac325fbca33165540506bdfd54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ab3zvmIx3k0IZNG2.jpg"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">巴西地图，图片来源[<a class="ae na" href="https://st4.depositphotos.com/1374738/23094/v/950/depositphotos_230940566-stock-illustration-map-brazil-divisions-states.jpg" rel="noopener ugc nofollow" target="_blank">https://st4 . deposit photos . com/1374738/23094/v/950/deposit photos _ 230940566-stock-illustration-map-Brazil-divisions-States . jpg</a></p></figure><p id="bcf4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">巴西人口最多的三个州是圣保罗、米纳斯吉拉斯和里约热内卢，我们还可以从下图中观察到，66.6 %的订单来自这些州，这意味着大多数客户来自这些州。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/83dbd841286f4b371b4c4f359dce4fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSlJF6BJ0CK7Feur9D5Kbw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="6f7b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，从下面显示的每个州的评论堆积图中，我们可以得出结论，每个州的大多数消费者都给予了积极的评价。在<strong class="js iu"> SP </strong>州的40800条评论中，35791条评论是正面的，而对于<strong class="js iu"> RJ </strong>州的9968条评论是正面的，评论总数为12569条。对于这个问题，消费者状态可能是我们的重要特征。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/2cd3ef0f588eeb6c78f9089247313bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ju8DRG71YdyD4b2F4xsU8w.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="0bd4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">众所周知，产品类别是这个行业的重要特征之一。为了了解最畅销的产品类别，我绘制了一个柱状图，如下所示</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/2a47c299cec21fe892b9d12563b191af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m78MJBoykkweuiZdlDxjIA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="2a3e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以观察到，2016-2018年间，订购最多的产品分别来自床_浴_桌品类、健康美容、运动_休闲。</p><p id="b7cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个数据集中也有一些时间戳特征，如<code class="fe no np nq lb b"><strong class="js iu">order_purchase_timestamp</strong></code>、<code class="fe no np nq lb b"><strong class="js iu">order_purchase_timestamp</strong></code>、<code class="fe no np nq lb b"><strong class="js iu">order_approved_a</strong>t</code>、<code class="fe no np nq lb b"><strong class="js iu">order_delivered_customer_date</strong></code>、<code class="fe no np nq lb b"><strong class="js iu">order_estimated_delivery_date</strong></code>等等。在提取了月、年、日、星期几等属性后，我对时间戳进行了单变量分析。给出的数据是699天的数据，收集数据的时间戳是<code class="fe no np nq lb b"><strong class="js iu">2016–10–04 09:43:32</strong></code> <strong class="js iu"> - </strong> <code class="fe no np nq lb b"><strong class="js iu">2018–09–03 17:40:06</strong></code> <strong class="js iu"> </strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/19f5377c6183b01213e3a08aa4181bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZVqVyJ1Csb-n_9Jeq6ixg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="54d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">收到的订单总数的变化如上所示，2017年收到的订单数达到最大值11。还有，我们可以观察Olist从201609年到201808年的成长。基于从<code class="fe no np nq lb b"><strong class="js iu">order_purchase_timestamp</strong></code> <strong class="js iu"> </strong>中提取的属性对订单和评论的分析已经在<strong class="js iu"> </strong>中结束。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/f0f468d26be64a2e66ea33bd3396ed8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6eX23NZL2hBDg7EW6TzCjg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="6da1" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">从标题为“每月总评论”的子图中，我们可以观察到，2016年至2018年期间总评论中正面评论比例最高的是2月，即9.8%。在5月和7月的总评论中，有超过9.0%的评论是正面的。</li><li id="ed63" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">从标题为“按一天中的时间划分的总评论”的第二个子图中，我们可以得出这样的结论:在下午收到的订单数量最多，并且在那个时间给出的正面评论的百分比最高，即32.8%。</li><li id="eb4c" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">从标题为“一周中每一天的总评论数”的第三个子图中，我们可以得出这样的结论:周一收到的订单数量最多，当天和周二给出的正面评论百分比最高，即13.9%。</li></ul><p id="ba27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">对数字特征的单变量分析- </strong></p><ul class=""><li id="881d" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">每类产品价格分布</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oi"><img src="../Images/a1423cd612e84114ce16deaccc7b4b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4R5ClsIVuTDNw7vjrvbBA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="0d95" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">每类frieght_value的分布</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oj"><img src="../Images/e9b58e653c4e89bada0420ed53a70bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uMgeY2y-V8f4sCWM9UNVqw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="2cd2" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">每类产品高度的分布</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oj"><img src="../Images/c2d06e1fbd3dbbb74ed63de827b93ea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9neKTclXNMUc6Fp2DGkSdw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="8d0e" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">每类产品的重量分布</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/bf0e5ee17f3153e1b390c28a24e5afca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nofljl3ucnnWeT5Gp3UckQ.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="5ee9" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">上面的分布图显示了正类和负类的每个数字特征的分布。我们可以观察到，阳性和阴性类别的分布几乎完全重叠，这表明不可能仅根据这些特征对它们进行分类。</li></ul><p id="c0a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 6.d双变量分析</strong></p><p id="2419" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该数据集中有超过10个数值特征，但是从上面显示的相关矩阵中，我们可以观察到大多数特征是线性相关的。对于双变量分析，仅选择四个特征并绘制在散点图中。</p><ul class=""><li id="8d29" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">从标题分别为<code class="fe no np nq lb b"><strong class="js iu">Distribution of price vs freight_value per class</strong></code>和<code class="fe no np nq lb b"><strong class="js iu">Distribution of price vs freight_value per class</strong></code>的两个散点图中，我们可以观察到，很难根据这些散点图对评论做出任何评价，因为根据评论，数据点是不可分离的，这些是完全混合的数据。</li><li id="0b60" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">每类价格与运费价值的分布</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ol"><img src="../Images/f50323cf85f83197dac74325268bf308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZtixaIRqU6yhf3gsFpUJw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="b44f" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">每类价格与产品重量的分布</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi om"><img src="../Images/d9759f3b0fb5a1999c321d021d0fd4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5atXFXXHZa4393EFr73G2Q.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="54f8" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">配对图</li></ul><p id="6e1f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于功能产品照片数量、产品名称长度、产品描述长度绘制了一个配对图，如下所示，因为这些功能与review_score列具有负相关值。基于评论，所有特征之间的散点图是完全混淆不可分的。我们可以说，这些特征没有一个对分类有帮助。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi on"><img src="../Images/e5752c619e419ca947d53354d660d3ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*PMLp_irhEnLoiot-1uytmg.png"/></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="a108" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 6.e多元分析</strong></p><p id="f764" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在多变量分析中，绘制了2016年至2108年之间的销售和订单演变。从图中我们可以观察到，2016年和2018年之间的总销售额和每月订单总量存在相同的模式。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/43f368c159fb0249a3c8395537b96f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_F7iv2wiVSmnxP0R4NcYOg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="cc85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 6.f RFM分析</strong></p><p id="7dd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于给定的客户数据，我对这些数据进行了RFM分析。RFM分析基本上是一种数据驱动的客户行为细分技术。RFM代表近期、频率和货币价值。</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="2819" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">RFM stands for-<br/>Recency — number of days since the last purchase</strong></span><span id="13b4" class="lf lg it lb b gy op li l lj lk"><strong class="lb iu">Frequency — number of transactions made over a given period</strong></span><span id="af33" class="lf lg it lb b gy op li l lj lk"><strong class="lb iu">Monetary — the amount spent over a given period of time</strong></span></pre><p id="43fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Python代码计算最近，频率和货币-</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="75b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建RFM后的输出如下所示</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="286b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要了解更多关于这种行为细分技术的信息，你可以访问这里</p><div class="oq or gp gr os ot"><a href="https://www.barilliance.com/rfm-analysis/#:~:text=RFM%20analysis%20is%20a%20data,much%20they%27ve%20spent%20overall." rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">RFM分析指南:RFM营销的6个关键部分</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">RFM分析增加电子商务销售。公司能够利用数据更好地了解客户的想法、感受和…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">www.barilliance.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ky ot"/></div></div></a></div><p id="1e68" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有客户的分布最近、频率和货币如下所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pi"><img src="../Images/8381dc7e9547189711b459c12188fdd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n3XLKa_Snk-vVp82c2M9wA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="816e" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">从最近的第一张图中，我们可以观察到大多数用户在Olist上停留了很长时间，这是一件积极的事情，但订购频率较少。</li><li id="a74b" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">从第二个频率图来看，最多的交易或订单数小于5。从第三张图中可以看出，在特定时期花费的最大金额似乎不到1500英镑左右。</li></ul><p id="b8f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">客户行为细分的方形图如下所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pj"><img src="../Images/8dd2ff11d486748f893ae00e9a5dc68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ue98nC1Rk3pKX0RZHRP-rw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="4c73" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">根据为所有客户计算的RFM分数，我将客户分为7类:</li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="719c" class="lf lg it lb b gy lh li l lj lk">'Can\'t Loose Them' ====  RMF_Score_s  ≥  9<br/>'Champions' ==== 8 ≤ RMF_Score_s &lt; 9<br/>'Loyal' ==== 7 ≤ RMF_Score_s &lt;8<br/>'Needs Attention' ==== 6 ≤ RMF_Score_s &lt;7<br/>'Potential' ==== 5 ≤ RMF_Score_s &lt; 6<br/>'Promising' ==== 4 ≤ RMF_Score_s &lt; 5 <br/>'Require Activation' RMF_Score_s &lt;4</span></pre><ul class=""><li id="0522" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">从上面的正方形图来看，最高百分比的客户位于类别潜力区域内。少数区域还标有蓝色刻度，显示需要更多关注的消费者的百分比，以便他们能够保留在列表中。</li><li id="4a96" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">我们可以使用RMF分数或RMF等级作为解决这个问题的特征。</li></ul><p id="31a1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在对数据进行合并、数据清洗和数据分析之后，我们将得到最终的数据，这些数据可以进一步用于预处理和特征提取。</p><p id="0704" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 6.g结论</strong></p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="f2c0" class="lf lg it lb b gy lh li l lj lk">* The target variable/class-label is imbalanced.We should be carefull while choosing the performance metric of the models.</span><span id="1f2c" class="lf lg it lb b gy op li l lj lk">* From the univariate analysis of payment_type we observed that 96 % of the user used credit card and boleto and concluded that this can be our important feature.</span><span id="4ecc" class="lf lg it lb b gy op li l lj lk">* Also,from the univariate analysis of consumer_state we found that 42% of total consumers are from the SP(São Paulo), 12.9 % are from RJ(Rio de Janeiro) and 11.7 % are from MG(Minas Gerais).</span><span id="219c" class="lf lg it lb b gy op li l lj lk">* After analyzing the product_category feature we observed that the most ordered products are from the bed_bath_table category, health beauty, and sports_leisure between 2016 and 2018. The least ordered products are from security_and_services.</span><span id="debc" class="lf lg it lb b gy op li l lj lk">* The different timestamps seem to be important features as many new features can be explored from these. we observed within 2016–18 the total number of orders received is increasing till 2017–11 and after that their a small decrement. from the month, day and time we observed the most number of orders are received in the month of Feb, on Monday and afternoon time.</span><span id="9595" class="lf lg it lb b gy op li l lj lk">* The numerical features like price, payment_value, freight_value,product_height_cm,product_length_cm doesnot seems to be helpful for this classification problem as observed from univariate and bivarate analysis.Also we can say linear model like KNN, Naive Bayes might not work well.</span><span id="5ade" class="lf lg it lb b gy op li l lj lk">* RMF Analysis is also done to understand whether new features can be created from this or not and we found that one numerical feature or categorical feature can be extracted from this.</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="2fb6" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">7.数据预处理和特征工程</h2><p id="3eb4" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">在数据分析之后，我们开始了解不同的分类和数字特征。所有的分类特征似乎都经过了预处理，我们不需要对这些特征进行预处理。但是，还有一个名为review_comment_message的列包含文本数据。在这些数据特征化之前，我们必须进行文本预处理。</p><p id="e1ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">评论文本的预处理</strong></p><p id="dae0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为我们有葡萄牙语的文本数据，所以在选择词干分析器、停用词以及替换和删除任何特殊字符或单词时，我们必须小心。我为此选择了<code class="fe no np nq lb b"><strong class="js iu">nltk</strong></code>库，并使用<code class="fe no np nq lb b"><strong class="js iu">from nltk.corpus import stopwords</strong></code> <strong class="js iu"> </strong>导入了停用词，使用<code class="fe no np nq lb b"><strong class="js iu">RSLPStemmer()</strong></code> <strong class="js iu"> </strong>导入了RSLP蒸笼。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1358" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我们用<code class="fe no np nq lb b">'nao_reveja'</code>替换评论数据中的空值时，我们必须从停用词中删除像<code class="fe no np nq lb b">'não'</code> &amp; <code class="fe no np nq lb b">'nem'</code>这样的词。在此之后，我们必须删除或替换链接、货币符号、日期、数字、额外空格和制表符。预处理函数如下所示-</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b496" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">预处理前后的审查文本列如下所示-</p><ul class=""><li id="aba9" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">以前</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><ul class=""><li id="5817" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">在...之后</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="e5ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">文本数据的矢量化</strong></p><p id="6c0b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们已经预处理了文本，为了转换这些文本数据，我使用gensim库中的FastText，通过TF-IDF矢量器()将单词转换为矢量。tfidf值给予最频繁出现的单词更大的权重。</p><p id="fd74" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">代码片段如下所示-</p><p id="2f21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用于加载快速文本模型(适用于300 dim)</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="8a93" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">矢量函数:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="9729" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在此之后，无用的特征将从最终数据中删除。被删除的列如下所示。</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="ce4c" class="lf lg it lb b gy lh li l lj lk">col= ['order_id',<br/> 'customer_id',<br/> 'order_purchase_timestamp',<br/> 'order_approved_at',<br/> 'order_delivered_customer_date',<br/> 'order_estimated_delivery_date',<br/>  'customer_unique_id',<br/> 'order_item_id',<br/> 'product_id',<br/> 'seller_id',<br/> 'shipping_limit_date',<br/> 'order_purchase_month_name',<br/> 'order_purchase_year_month',<br/> 'order_purchase_date',<br/> 'order_purchase_month_yr',<br/> 'order_purchase_day',<br/> 'order_purchase_dayofweek',<br/> 'order_purchase_dayofweek_name',<br/> 'order_purchase_hour',<br/>'order_purchase_time_day','customer_city','customer_zip_code_prefix','product_category_name']</span></pre><p id="e5ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们有了经过预处理的文本数据、分类和数字特征的最终数据。我们可以使用<code class="fe no np nq lb b">from sklearn.model_selection import train_test_split</code>和<code class="fe no np nq lb b">stratify=y</code>分割数据，因为我们有不平衡的数据。我们还有尚未编码的分类特征。为了对分类特征进行编码，我使用了<code class="fe no np nq lb b">CountVectorizer(binary= True)</code>函数，order_status特征的编码如下所示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0022" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">数字特征也使用<code class="fe no np nq lb b">from sklearn.preprocessing import Normalizer</code>进行缩放。使用<code class="fe no np nq lb b">from scipy.sparse import hstack</code>堆叠所有矢量化的特征，以形成X_train和X_test。</p><p id="254b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">基线模型选择</strong></p><p id="20bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们有现有的矢量化特征，现在我们将构建几个基本模型，我们将选择一个作为基线模型。在此之后，我们将尝试通过添加新功能来改善基线，为了添加新功能，我将再次进行一些EDA。使用的模型有随机模型、朴素贝叶斯模型和逻辑回归模型。输出分数和混淆矩阵如下所示。</p><ul class=""><li id="4ebf" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">随机模型</li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="b8d2" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1-score 0.42757018716907186<br/>Test f1-score 0.4261466361217526</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pk"><img src="../Images/151c6126a7d4b164df420760e1a1ddd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*52WK0sCgnGO8hzAUn6095w.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="9bf2" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">朴素贝叶斯</li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="f420" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1 score:  0.7424119484527338<br/>Test f1 score:  0.7472580717762947</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/a62a80e24fe2b91241a9c2d1ada51aba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gU7KBEy9JqeLuTK5SiqOqw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="0c6e" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">逻辑回归</li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="e489" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1 score:  0.8165306456031154<br/>Test f1 score:  0.8062989397776499</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/7667b9c453ffb21609cfc4c0c39d8e81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iWodLiFMHeC9s2-YLgtkYg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="b46b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">逻辑回归模型的表现优于其他模型。选择逻辑回归模型作为基线模型。从训练和测试混淆矩阵中，我们可以观察到假阳性和假阴性值仍然很大。让我们尝试通过添加一些特征和通过特征选择方法来减少这些值。</p><p id="a746" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">特征工程</strong></p><p id="7100" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">除了现有要素，数据中还添加了16个新要素。这些功能的详细信息如下所示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="6c86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">添加新特征后，我们总共有29个数字特征和5个分类特征，以及文本数据(300 dim)。我们将再次运行选定的基线模型，即逻辑回归模型，并检查其输出。输出如下所示。</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="0ad4" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1 score:  0.8258929671475947<br/>Test f1 score:  0.8167104393178897</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/51ba6fbb73cadc6f25939ad3870490a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yubIJQoaSl_coC5gd4QWBg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="3825" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们得到了更好的训练和测试f1分数，但我们仍然有很高的FP和FN值。为了减少这些值并增加分数，我尝试使用<code class="fe no np nq lb b">Autoencoder Model </code>进行特征选择。</p><p id="9ac2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">使用自动编码器模型的特征提取/选择</strong></p><blockquote class="nt nu nv"><p id="5d75" class="jq jr nw js b jt ju jv jw jx jy jz ka nx kc kd ke ny kg kh ki nz kk kl km kn im bi translated"><code class="fe no np nq lb b"><strong class="js iu">Autoencoder</strong></code>是一种神经网络，可用于学习原始数据的压缩(降维)表示。自动编码器由编码器和解码器子模型组成。编码器压缩输入，解码器试图从编码器提供的压缩版本中重建输入。训练后，保存编码器模型，丢弃解码器。</p><p id="e457" class="jq jr nw js b jt ju jv jw jx jy jz ka nx kc kd ke ny kg kh ki nz kk kl km kn im bi translated">然后，编码器可以用作数据准备技术，以对原始数据执行特征提取，该原始数据可以用于训练不同的机器学习模型。来源-<a class="ae na" href="https://machinelearningmastery.com/autoencoder-for-classification/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/auto encoder-for-class ification/</a></p></blockquote><p id="4019" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该模型的架构如下所示。我使用了一个致密层，BatchNormalisation层，leakyRelu作为激活层。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/d4cea67b1219f97a1e4e8e757be6beed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*gswMtJvfCrj_berIygLG8g.png"/></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="d489" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我运行了这个模型10个时期，在运行模型之后，我保存了编码器部分。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="e38f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">损失与时期图</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/6797f1adb7ad65add23c003b7204b86c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MDsxOzTHS_nF7IkpJ0OaaA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="45a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，从编码器模型中提取重要特征。</p><p id="cf33" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">代码片段:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="04eb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用提取的特征再次运行基线模型。输出如下所示。</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="1812" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1 score:  0.8457608492913875<br/>Test f1 score:  0.8117963347711852</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/3044086f0e816fb1012d3659d66fc13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TFvcWKyQFxLdAqJYXI3myg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="fbac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">f1分数增加了，我们的FP和FN值也降低了。我们现在将运行不同的机器学习和深度学习模型，并为我们的问题选择最佳模型。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="99bc" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">8.型号选择</h2><p id="d2fa" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated"><strong class="js iu">模型选择</strong>是选择一个模型作为解决问题的最终模型的过程。正如我们已经看到的基线模型性能，现在为了提高分数，我们将尝试两种不同类型模型的模型选择过程(例如，逻辑回归、SVM、KNN、决策树、集成等)。)和配置有不同模型超参数(例如，SVM中的不同内核)的相同类型的模型。</p><p id="984f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">机器学习模型</strong></p><p id="87b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们从神经网络模型的不同分类模型开始。我们在本案例研究中试验的模型如下</p><ol class=""><li id="8b45" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn po mr ms mt bi translated">逻辑回归</li><li id="9b9d" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn po mr ms mt bi translated">线性支持向量机</li><li id="ad24" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn po mr ms mt bi translated">决策树分类器</li><li id="c616" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn po mr ms mt bi translated">随机森林分类器</li><li id="d6cb" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn po mr ms mt bi translated">增强分类器(XGBoost/light GBM/AdaBoost/CATBoost)</li><li id="de28" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn po mr ms mt bi translated">堆叠/投票集成技术</li></ol><p id="047b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于每个模型，我使用<code class="fe no np nq lb b">RandomizedSearchCV</code>进行超参数调整。所有模型的最佳超参数输出汇总如下所示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="2fc7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以观察到基于测试f1的最佳模型——分数是vot_hard代码片段，输出如下所示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="9128" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有模型的代码片段都可以在这里找到-</p><div class="oq or gp gr os ot"><a href="https://jovian.ai/paritosh/ml-models" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">帕里托什/ml-模型-木星</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">与Paritosh合作开发ml-models笔记本电脑。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">jovian.ai</p></div></div><div class="pc l"><div class="pp l pe pf pg pc ph ky ot"/></div></div></a></div><p id="24c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">深度学习模型</strong></p><p id="aab2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于我们已经看到了不同的机器学习模型，现在我们将尝试不同的神经网络模型。我尝试了5种不同的模型，并使用这些模型形成深度学习堆叠模型。</p><p id="f6cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">模型-1 </strong></p><p id="67b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在模型-1中，我建立了一个简单的模型，其中5个密集层作为隐藏层，1个密集层作为输出层。在输出层，使用sigmoid作为激活函数。给定的输入是从编码器模型中提取的特征。我使用定制的f1分数指标来评估这些模型。</p><ul class=""><li id="c8f2" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">模型建筑</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/85c777037697ca854e831a29d1d9cf86.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*ru1sra3jUXXgRQwS8TjxWg.png"/></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="0f10" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">纪元Vs损失图</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pr"><img src="../Images/1f5bf8585946f66f0944d2d02e6bf4c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mcFXzdVmzvoh0eqRZ058RA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="ed74" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">输出</li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="c2b1" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1_score: 0.8632763852422476<br/>Test f1_score: 0.8218909906703276</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/53716e1b85bd0c98bc069de5a026fc6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SoyM81V_obE0QmKi4Lb6rA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="2961" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">型号2 </strong></p><p id="fa6c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Model- 2中，我使用了4个CONV1D层，2个MaxPooling1D层，一个dropout层和一个flatten层作为隐藏层，1个dense层作为输出层。在输出层，使用sigmoid作为激活函数。给定的输入是从编码器模型中提取的特征，但是具有重新成形的阵列。</p><ul class=""><li id="7460" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">模型架构</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/acf546d7e22b9266cc940ee7f3a295dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*5dwL6QDzslzLs7hmqn978Q.png"/></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="1b1c" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">时代Vs损失</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pr"><img src="../Images/fe2e1b6eba795258513340600d69bcd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXgjvrRwX1yLjLJPNpKxCw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="8ed6" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">输出</li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="d80d" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1_score: 0.8610270746182962 <br/>Test f1_score: 0.8253479131333611</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/03ff3594e00eadaa5e3507875b5289c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9Px-DDXIFZIotrgkVEGkg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="815b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">型号-3 </strong></p><p id="d518" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Model -3中，我使用了LSTM层、嵌入层、批处理标准化层、密集层、下降层和展平层来构建具有多个输入和一个输出的模型。输入数据解释如下。</p><ul class=""><li id="ec35" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">Input _ seq _ total _ text _ data-</strong>我使用<strong class="js iu"> </strong>嵌入层为<strong class="js iu"> </strong>文本数据列获取单词向量。我还使用预定义的fasttext单词向量来创建嵌入矩阵。之后使用LSTM，得到LSTM输出，并使输出变平。</li><li id="7501" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu"> Input_order_status- </strong>给定order_status列作为嵌入层的输入，然后训练Keras嵌入层。</li><li id="fa3f" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">付款类型- </strong>给定付款类型列作为嵌入层的输入，并训练Keras嵌入层。</li><li id="ac87" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">输入客户状态- </strong>给定客户状态列作为嵌入层的输入，并训练Keras嵌入层。</li><li id="ac04" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">输入产品类别- </strong>给定产品类别列作为嵌入层的输入，并训练Keras嵌入层。</li><li id="ad75" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">输入_rfm - </strong>给定RFM_Level列作为嵌入层的输入，并训练Keras嵌入层。</li><li id="08c8" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">输入_数字- </strong>连接剩余的列，即数字特征，然后添加一个密集层。</li></ul><p id="b7ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有这些都在最后连接起来，并通过不同的密集层。</p><ul class=""><li id="231c" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">模型架构</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pt"><img src="../Images/8669d3c6d3ddc1ebd91b169b35c9fcc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QVhoCbyeA1x1VE0h61i3XQ.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="969c" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">历元Vs损失</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pr"><img src="../Images/63ca6bc988842e54408e4d7619737ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bCoy3vILPXamgf6Ip1PfXw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="a2e2" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">输出</strong></li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="15f6" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1_score: 0.860330602322043 <br/>Test f1_score: 0.8327277576694923</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/c5b03141e61d38d9796a48e866dce4e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UfpsEUPtoT6e10sIbI9NOw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="55f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">型号4 </strong></p><p id="fa89" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Model -4也使用LSTM层、Conv1D、嵌入层、批处理标准化层、密集层、下降层和展平层来构建模型，但具有两个输入和一个输出。输入数据解释如下。</p><ul class=""><li id="c8c1" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">Input _ seq _ total _ text _ data-</strong>我使用<strong class="js iu"> </strong>嵌入层为<strong class="js iu"> </strong>文本数据列获取单词向量。我还使用预定义的快速文本单词向量来创建嵌入矩阵。之后使用LSTM，得到LSTM输出，并使输出变平。</li><li id="2256" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu"> Other_than_text_data- </strong>所有分类特征都被转换为一个独热编码向量，然后使用np与数字特征连接在一起。hstack</li><li id="2fa6" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">模型架构</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pu"><img src="../Images/27154357b7407074e2541c1534f7a5f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lbAe4QwN946nvr0AEMSKAA.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="8fb5" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">历元对损失</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pr"><img src="../Images/8dbf7f9273bf5d97ab84ed03fe488b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8sY5A50kwTd879J-zQg5uw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="75a1" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">输出</strong></li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="6ef4" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1_score: 0.8815188513597205 <br/>Test f1_score: 0.8218441232242646</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/f3aa47b499b25f77e0276499ecc8b61d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*31DpnEcOtCrdJDxdcFlT5w.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="83df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">型号-5 </strong></p><p id="52ee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Model -5还使用了LSTM层、Conv1D、嵌入层、批处理标准化层、密集层、下降层和展平层来构建模型，但具有两个输入和一个输出。输入数据与模型4相同。</p><ul class=""><li id="14a5" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">模型架构</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pv"><img src="../Images/a503f01b619500cc679c3856d0fca7b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EiQSidboD1tI-_MveR4xrg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="e5d9" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">历元Vs损失</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pr"><img src="../Images/169f7672c9577a1a811e49a9c5e10c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nbk8fKyrzSQSWLk_Y_t3wQ.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="8521" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu">输出</strong></li></ul><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="6c6a" class="lf lg it lb b gy lh li l lj lk"><strong class="lb iu">Train f1_score: 0.8508463263785984<br/>Test f1_score: 0.8287339894123904</strong></span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/29bda8637473e6efa6c1aeccfb8049a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mMkxmvnrxucmWRxyt59pIw.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="0694" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">深度学习堆叠模型</strong></p><p id="fa51" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我们已经看到的5个深度学习模型，现在我们将使用一种集成方法，其中上述5个模型用作子模型，每个模型对组合预测的贡献相等，XGBClassifier用作最终模型，即元模型。我们将构建两个堆叠模型，一个使用硬堆叠，另一个使用软堆叠，并将输出与上述模型的输出进行比较。构建硬件和堆栈的每个步骤的代码片段如下所示。</p><p id="f576" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">步骤1加载五个子模型</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="e1a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每个模型的第2步预测</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="51f4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">步骤3堆叠预测并通过元分类器</p><ul class=""><li id="68db" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">硬堆叠</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="754e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">输出:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/21207e0d5cf55c5a262a6473a3711164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVYlkKxcOi9ro-QGLENDFg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><ul class=""><li id="c479" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">软堆叠</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0c55" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/5592ed6b6cd8626b2e2eabc46a9673c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAOY-GIxKWhYt98On1Ppwg.png"/></div></div><p class="mh mi gj gh gi mj mk bd b be z dk translated">图片由Paritosh Mahto提供</p></figure><p id="23cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我们可以观察到的，两种堆叠模型的输出都比上述深度学习模型表现得更好。所有深度学习模型的代码片段都可以在这里找到—</p><div class="oq or gp gr os ot"><a href="https://jovian.ai/paritosh/dl-models-2" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">Paritosh/dl-models-2 - Jovian</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">与Paritosh合作开发dl-models-2笔记本电脑。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">jovian.ai</p></div></div><div class="pc l"><div class="pw l pe pf pg pc ph ky ot"/></div></div></a></div></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="d8ac" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">9.摘要</h2><ul class=""><li id="bc61" class="ml mm it js b jt mc jx md kb nb kf nc kj nd kn mq mr ms mt bi translated">从EDA中，我们得出结论，给定的数据集是偏斜的，并且具有相关值，我们已经看到大多数数字特征不是线性相关的，这意味着简单的ml分类可能不会很好地工作。</li><li id="c87d" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">评论数据是文本形式的，我们对这些数据进行了预处理，并且增加了新的功能，有助于提高分数。autoencoder模型在特性选择和性能增强方面帮助更大。</li><li id="d0ba" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">在模型选择部分，我们经历了不同的ml模型和dl模型性能。比较所有结果后，我们可以得出结论，该模型是一个深度学习堆叠模型，即软堆叠模型。现在我们将在部署过程中使用这个模型。</li></ul><h2 id="3da2" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">10.部署</h2><p id="bc12" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">使用streamlit和Github部署了最好的堆叠式深度学习模型。使用streamlit uploader函数，我创建了一个CSV文件输入部分，您可以在其中提供原始数据。之后，您必须选择唯一的客户id和相应的订单id，预测将显示为图像。</p><p id="2c51" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">网页链接-</p><p id="c063" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae na" href="https://share.streamlit.io/paritoshmahto07/customer-satisfaction-prediction/main/app.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/paritoshmahto 07/customer-satisfaction-prediction/main/app . py</a></p><p id="85a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">部署视频-</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="px nn l"/></div></figure><h2 id="806c" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">11.对现有方法的改进</h2><p id="15d0" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">在现有方法中，使用两个回归模型和九个新特征来预测评论分数，得到0.58的RMSE。在现有方法中，也不使用不同的模型，并且也使用有限的特征。在我们的方法中，我们采用了比现有方法更好的结果，并且我们使用了新的文本特征化方法以及用于特征选择的自动编码器模型，因此模型的性能得到了提高。</p><h2 id="2fab" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">12.未来的工作</h2><p id="60b0" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">用不同的方法对葡萄牙文本数据进行矢量化可以改善结果。此外，可以添加新功能和调整DL模型的参数，以获得更好的结果。</p><p id="b5e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">我的LinkedIn个人资料</strong></p><p id="7808" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">【https://www.linkedin.com/in/paritosh07/ T4】</p><p id="5ba1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">我的Github个人资料</strong></p><div class="oq or gp gr os ot"><a href="https://github.com/paritoshMahto07" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">paritoshMahto07 -概述</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">paritoshMahto07有一个可用的存储库。在GitHub上关注他们的代码。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">github.com</p></div></div><div class="pc l"><div class="py l pe pf pg pc ph ky ot"/></div></div></a></div><h2 id="53f6" class="lf lg it bd ll lm ln dn lo lp lq dp lr kb ls lt lu kf lv lw lx kj ly lz ma mb bi translated">13.参考</h2><p id="b49d" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">一、现有解决方案-</p><div class="oq or gp gr os ot"><a href="https://www.kaggle.com/andresionek/predicting-customer-satisfaction" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">预测客户满意度</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自巴西电子商务公共数据集的数据…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">www.kaggle.com</p></div></div><div class="pc l"><div class="pz l pe pf pg pc ph ky ot"/></div></div></a></div><p id="e50d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">二。数据分析和可视化-</p><div class="oq or gp gr os ot"><a href="https://www.kaggle.com/thiagopanini/e-commerce-sentiment-analysis-eda-viz-nlp" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">电子商务情感分析:EDA + Viz + NLP ✍</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">www.kaggle.com</p></div></div><div class="pc l"><div class="qa l pe pf pg pc ph ky ot"/></div></div></a></div><p id="1767" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">三。RFM分析-</p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/recency-frequency-monetary-model-with-python-and-how-sephora-uses-it-to-optimize-their-google-d6a0707c5f17"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">Python的新近性、频率、货币模型——以及丝芙兰如何使用它来优化他们的谷歌…</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">上次我们使用群组分析方法分析了我们的在线购物者数据集。我们发现了一些有趣的…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="qb l pe pf pg pc ph ky ot"/></div></div></a></div><p id="4f45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">四。自动编码器模型</p><div class="oq or gp gr os ot"><a href="https://machinelearningmastery.com/autoencoder-for-classification/" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">用于分类机器学习掌握的自动编码器特征提取</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">Autoencoder是一种神经网络，可用于学习原始数据的压缩表示。安…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">machinelearningmastery.com</p></div></div><div class="pc l"><div class="qc l pe pf pg pc ph ky ot"/></div></div></a></div><p id="e27b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">动词 （verb的缩写）堆叠ML模型</p><div class="oq or gp gr os ot"><a href="https://machinelearningmastery.com/stacking-ensemble-machine-learning-with-python/" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">堆叠集成机器学习与Python -机器学习掌握</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">堆叠或堆叠概括是一种集成机器学习算法。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">machinelearningmastery.com</p></div></div><div class="pc l"><div class="qd l pe pf pg pc ph ky ot"/></div></div></a></div><p id="ac6c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不及物动词堆叠DL模型</p><div class="oq or gp gr os ot"><a href="https://machinelearningmastery.com/stacking-ensemble-for-deep-learning-neural-networks/" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">Python -机器学习掌握中深度学习神经网络的堆叠集成</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">模型平均是一种集成技术，其中多个子模型对组合预测的贡献相等。型号…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">machinelearningmastery.com</p></div></div><div class="pc l"><div class="qe l pe pf pg pc ph ky ot"/></div></div></a></div><p id="000b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">七。师徒制</p><div class="oq or gp gr os ot"><a href="https://www.appliedaicourse.com/" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">应用课程</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">我们知道转行是多么具有挑战性。我们的应用人工智能/机器学习课程被设计为整体学习…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">www.appliedaicourse.com</p></div></div><div class="pc l"><div class="qf l pe pf pg pc ph ky ot"/></div></div></a></div><p id="0bf2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nw">感谢阅读，祝你有美好的一天！</em>🙂</p></div></div>    
</body>
</html>