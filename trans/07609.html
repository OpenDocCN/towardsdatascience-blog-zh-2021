<html>
<head>
<title>Create GitHub’s style contributions plot for your Time Series data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的时间序列数据创建GitHub的风格贡献图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-githubs-style-contributions-plot-for-your-time-series-data-79df84ec93da?source=collection_archive---------18-----------------------#2021-07-12">https://towardsdatascience.com/create-githubs-style-contributions-plot-for-your-time-series-data-79df84ec93da?source=collection_archive---------18-----------------------#2021-07-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c2eb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让您的热图脱颖而出</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/72bc4e60a908c263ad0a605a7a855d00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1HsXYr7LDGI5D_aQGNnydQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">墙上的另一块砖|作者图片</p></figure><p id="4096" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Github贡献图显示了您在过去一年中对存储库的贡献。一张填满的贡献图不仅看起来赏心悦目，还表明了你的努力工作(除非你已经黑了它)。图表虽然漂亮，但也显示了关于你的表现的大量信息。然而，如果你仔细观察，它只是一个显示一些时间序列数据的热图。因此，作为一项周末活动，我试图复制一些基本时间序列数据的图表，通过本文与您分享这一过程。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="cfb6" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">数据集和一些预处理</h1><p id="cb9b" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我将在本文中使用的数据集来自Kaggle上的表格游乐场系列(TPS)竞赛。TPS竞赛为期一个月，于每月1日开始。我将使用TPS — <a class="ae my" href="https://www.kaggle.com/c/tabular-playground-series-jul-2021/data" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">七月版竞赛</strong> </a>中的数据集。</p><blockquote class="mz na nb"><p id="d845" class="ky kz nc la b lb lc ju ld le lf jx lg nd li lj lk ne lm ln lo nf lq lr ls lt im bi translated">数据集是基于时间序列的数据，其任务是根据基本天气信息(温度和湿度)和5个传感器的输入值，预测空气污染测量值随时间的变化。</p></blockquote><p id="ee8d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们导入基本库并在pandas中解析数据集。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="edc6" class="nl mc it nh b gy nm nn l no np">import pandas as pd<br/>import numpy as np<br/>import datetime as dt<br/>from datetime import datetime</span><span id="74c0" class="nl mc it nh b gy nq nn l no np">data = pd.read_csv(‘train.csv’, parse_dates=[‘date_time’])<br/>data.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/a25ffecce4ba8300bc396d11c872a3d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oB97nspYpwJfiRRDoVRdbQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间序列数据集</p></figure><p id="3321" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于我们的目的来说，这是一个相当不错的数据集。我们开始工作吧。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="a7dd" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">使用Seaborn库创建基本热图</h1><p id="d3d1" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><a class="ae my" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>是Python中的统计数据可视化库。它基于matplotlib，但是有一些很棒的默认主题和绘图选项。从技术上讲，创建热图本质上是用颜色替换数字。更准确地说，这意味着将数据绘制成颜色编码的矩阵。让我们看看如何通过代码实现这一点。但在此之前，我们必须将数据转换成所需的格式</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="ed86" class="nl mc it nh b gy nm nn l no np">#Importing the seaborn library along with other dependencies</span><span id="11c3" class="nl mc it nh b gy nq nn l no np">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>import datetime as dt<br/>from datetime import datetime</span><span id="2364" class="nl mc it nh b gy nq nn l no np"># Creating new features from the data</span><span id="d1a3" class="nl mc it nh b gy nq nn l no np">data['year'] = data.date_time.dt.year<br/>data['month'] = data.date_time.dt.month<br/>data['Weekday'] = data.date_time.dt.day_name()</span></pre><p id="1c01" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对数据进行子集化，只包含<code class="fe ns nt nu nh b">year 2010 </code>，然后丢弃除了<code class="fe ns nt nu nh b">month</code>、<code class="fe ns nt nu nh b">weekday</code>、<code class="fe ns nt nu nh b">and</code>、<code class="fe ns nt nu nh b">deg_C.</code>之外的所有列，然后我们将旋转数据集，得到一个类似矩阵的结构</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="197c" class="nl mc it nh b gy nm nn l no np">data_2010 = data[data['year'] == 2010]<br/>data_2010 = data_2010[['month','Weekday','deg_C']]</span><span id="60ce" class="nl mc it nh b gy nq nn l no np">pivoted_data = pd.pivot_table(train_2010, values='deg_C', index=['Weekday'] , columns=['month'], aggfunc=np.mean)<br/></span></pre><p id="c7be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于我们的数据集已经以矩阵的形式存在，现在用seaborn绘制热图只是小菜一碟。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="7174" class="nl mc it nh b gy nm nn l no np">plt.figure(figsize = (16,6))<br/>sns.heatmap(pivoted_data, linewidths=5, cmap='YlGn',linecolor='white', square=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3a943e372fe36449756300ac8964eb23.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*T13ubQPxkG5j3qCuWvvn9w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用Seaborn库创建的热图|图片由作者提供</p></figure><p id="30db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">热图显示了2010年的平均温度(摄氏度)。我们可以清楚地看到，7月是当年最热的一个月。为了模拟Github的贡献图，使用了一些参数:</p><ul class=""><li id="2482" class="nw nx it la b lb lc le lf lh ny ll nz lp oa lt ob oc od oe bi translated">pivoted_data:使用的数据集</li><li id="d8c6" class="nw nx it la b lb of le og lh oh ll oi lp oj lt ob oc od oe bi translated">线宽:分隔每个单元格的线的宽度。</li><li id="a118" class="nw nx it la b lb of le og lh oh ll oi lp oj lt ob oc od oe bi translated">线条颜色:划分单元格的线条的颜色</li><li id="3291" class="nw nx it la b lb of le og lh oh ll oi lp oj lt ob oc od oe bi translated">方形:确保每个单元格都是方形的</li></ul><p id="fbef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个很好的尝试，但仍有改进的余地。我们还没有接近Github的贡献图。让我们用另一个库再试一次。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="5a47" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">使用calmap创建日历热图</h1><p id="4377" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">Python中有一个名为<a class="ae my" href="https://pythonhosted.org/calmap/" rel="noopener ugc nofollow" target="_blank"> calmap </a>的专用库，而不是对seaborn进行修补。它根据Github贡献图中的时间序列数据创建了漂亮的日历热图，而且只用了一行代码。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="1e79" class="nl mc it nh b gy nm nn l no np">#Installing and importing the calmap library<br/>pip install calmap</span><span id="00ed" class="nl mc it nh b gy nq nn l no np">#import the library<br/>import calmap</span></pre><p id="b28b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用与上一节相同的数据集，并使用<code class="fe ns nt nu nh b">yearplot()</code>方法来绘制。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="d105" class="nl mc it nh b gy nm nn l no np">#Setting the <!-- -->date_time<!-- --> column as the index<br/>data = data.set_index('date_time')</span><span id="5ece" class="nl mc it nh b gy nq nn l no np">#plotting the calender heatmap for the year 2010<br/>plt.figure(figsize=(20,10))<br/>calmap.<strong class="nh iu">yearplot</strong>(data['deg_C'], cmap='YlGn', fillcolor='lightgrey',daylabels='MTWTFSS',dayticks=[0, 2, 4, 6],<br/>                linewidth=2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/3c9ea0e689707d8173af061679842ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hX2P84J3jckaiLHRy4HVkQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用calmap库创建的热图|图片由作者提供</p></figure><p id="db1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面，我们已经定制了<code class="fe ns nt nu nh b">color</code>、<code class="fe ns nt nu nh b">linewidth</code>和<code class="fe ns nt nu nh b">fillcolor</code>，即在没有数据的日子里使用的颜色。您可以根据需要设置这些值。更多信息可从<a class="ae my" href="https://pythonhosted.org/calmap/#module-calmap" rel="noopener ugc nofollow" target="_blank">文档</a>中获得。</p><p id="59c9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也可以使用<code class="fe ns nt nu nh b"><a class="ae my" href="https://pythonhosted.org/calmap/#calmap.calendarplot" rel="noopener ugc nofollow" target="_blank"><strong class="la iu">calendarplot()</strong></a> method.</code>将所有年份作为支线剧情绘制成一个图形</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="1a70" class="nl mc it nh b gy nm nn l no np">fig_kws=dict(figsize=(20, 10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/34d8c75c5bc2d2bc7b0fb279678cdf7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytiF71AMK8b8I4gX6RXsyQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有calmap库的Calenderplots按作者分类的图像</p></figure><p id="d1ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见，2011年的数据并不多，但我相信你已经有了想法。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="f08b" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">包裹</h1><p id="174e" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">热图是有用的可视化工具，通过使用颜色提供深度透视来帮助传达模式。它有助于可视化矩阵的两个维度之间的值的集中，这对人眼来说比单纯的数字更明显。这篇文章向你展示了如何让你的热图变得更明亮、更生动，并在创建热图时获得乐趣。</p></div></div>    
</body>
</html>