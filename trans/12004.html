<html>
<head>
<title>Augmented Assignments in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的扩充赋值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/augmented-assignments-python-caa4990811a0?source=collection_archive---------25-----------------------#2021-12-02">https://towardsdatascience.com/augmented-assignments-python-caa4990811a0?source=collection_archive---------25-----------------------#2021-12-02</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="4d1b" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">理解增强赋值表达式在 Python 中是如何工作的，以及为什么在可变对象中使用它们时要小心</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/cc762922bb700073f3ed2be19318a850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3dCVTr_0G3HX7tZc0cBxg.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@kellysikkema?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae kz" href="https://unsplash.com/s/photos/add?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="4c67" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="05c3" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">Python 从 C 语言中借用的一个概念是<strong class="ly iv">扩充赋值</strong>，本质上是标准赋值的简称。</p><p id="231f" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的简短指南中，我们将讨论什么是扩充赋值，以及为什么在对可变数据类型使用它们时要格外小心。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="9aa1" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">Python 中的扩充赋值</h2><p id="bbea" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">扩充赋值创建了一种速记法，将二进制表达式合并到实际的赋值中。例如，以下两个语句是等效的:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="27ca" class="la lb iu nc b gz ng nh l ni nj">a = a + b<br/>a +=  b  # augmented assignment</span></pre><p id="d79b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在下面的代码片段中，我们展示了 Python 语言中允许的所有扩充赋值</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="a625" class="la lb iu nc b gz ng nh l ni nj">a += b<br/>a -= b<br/>a *= b<br/>a /= b<br/>a //= b</span><span id="93f9" class="la lb iu nc b gz nk nh l ni nj">a &amp;= b<br/>a |= b<br/>a ^= b</span><span id="dc67" class="la lb iu nc b gz nk nh l ni nj">a &gt;&gt;= b<br/>a &lt;&lt;= b<br/>a %= b<br/>a **= b</span></pre><p id="27ba" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">扩充赋值适用于任何支持隐含二进制表达式的数据类型。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="1263" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; a = 1<br/>&gt;&gt;&gt; a = a + 2<br/>&gt;&gt;&gt; a<br/>3<br/>&gt;&gt;&gt; a += 1<br/>&gt;&gt;&gt; a<br/>4</span><span id="d846" class="la lb iu nc b gz nk nh l ni nj">&gt;&gt;&gt; s = 'Hello'<br/>&gt;&gt;&gt; s = s + ' '<br/>&gt;&gt;&gt; s <br/>'Hello '<br/>&gt;&gt;&gt; s += 'World'<br/>&gt;&gt;&gt; s<br/>'Hello World'</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="e7b4" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">扩充赋值如何处理可变对象</h2><p id="3202" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当使用扩充赋值表达式时，将自动选取最佳操作。这意味着对于支持就地修改的特定对象类型，将应用就地操作，因为它比先创建副本再进行分配要快。如果你想添加一个条目到一个列表中，通常使用<code class="fe nl nm nn nc b">append()</code>方法比使用连接更快:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="f2df" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; my_lst = [1, 2, 3]<br/>&gt;&gt;&gt; my_lst.append(4)  # This is faster <br/>&gt;&gt;&gt; my_lst = my_lst + [4]  # This is slower</span></pre><p id="386d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">由于就地操作速度更快，它们将被自动选择用于扩充任务。为了弄清楚这些表达式是如何处理可变对象类型的，让我们考虑下面的例子。</p><p id="816c" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">如果我们使用串联，那么将会创建一个新的列表对象。这意味着，如果另一个名称共享同一引用，它将不受新对象列表中任何未来更新的影响:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="8abd" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; lst_1 = [1, 2, 3]<br/>&gt;&gt;&gt; lst_2 = lst_1<br/>&gt;&gt;&gt; lst_1 = lst_1 + [4, 5]<br/>&gt;&gt;&gt; lst_1<br/>[1, 2, 3, 4, 5]<br/>&gt;&gt;&gt; lst_2<br/>[1, 2, 3]</span></pre><p id="537f" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在，如果我们使用增强赋值表达式，这意味着表达式将使用<code class="fe nl nm nn nc b">extend()</code>方法来执行更新，而不是连接，那么我们也将影响所有其他拥有共享引用的名称:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="c8b7" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; lst_1 = [1, 2, 3]<br/>&gt;&gt;&gt; lst_2 = lst_1<br/>&gt;&gt;&gt; lst2 += [4, 5]<br/>&gt;&gt;&gt; lst_1<br/>[1, 2, 3, 4, 5]<br/>&gt;&gt;&gt; lst_2<br/>[1, 2, 3, 4, 5]</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="5467" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">扩充赋值的三个优点</h2><p id="802d" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">总而言之，扩充赋值表达式提供了以下三个优点:</p><ol class=""><li id="831f" class="no np iu ly b lz mp mc mq lj nq ln nr lr ns mo nt nu nv nw bi translated">它们需要更少的击键，而且更干净</li><li id="1b53" class="no np iu ly b lz nx mc ny lj nz ln oa lr ob mo nt nu nv nw bi translated">它们速度更快，因为表达式的左边只需要计算一次。在大多数情况下，这可能不是一个巨大的优势，但当左侧是一个复杂的表达式时，它肯定是。</li></ol><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="72f9" class="la lb iu nc b gz ng nh l ni nj">x += y  # x is evaluated only once<br/>x = x + y  # x is evaluated twice</span></pre><p id="6a10" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">3.将选择最佳操作，这意味着如果对象支持就地更改，则就地操作将应用于串联。但是，您应该非常小心，因为有时这可能不是您想要的，因为在应用就地操作区域时，名称共享引用可能会相互影响。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="eb4c" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="354a" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的文章中，我们讨论了 Python 中的增强赋值表达式，以及它们如何帮助您编写更 Python 化、更清晰甚至更快的代码。</p><p id="e922" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，我们强调了这种类型的表达式如何应用于可变数据类型，这可能会给我们带来共享引用的麻烦。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="9d1a" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="oc od gq gs oe of"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="og ab fp"><div class="oh ab oi cl cj oj"><h2 class="bd iv gz z fq ok fs ft ol fv fx it bi translated">通过我的推荐链接加入 Medium-Giorgos Myrianthous</h2><div class="om l"><h3 class="bd b gz z fq ok fs ft ol fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="on l"><p class="bd b dl z fq ok fs ft ol fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot kt of"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="oc od gq gs oe of"><a href="https://codecrunch.org/what-does-if-name-main-do-e357dd61be1a" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fp"><div class="oh ab oi cl cj oj"><h2 class="bd iv gz z fq ok fs ft ol fv fx it bi translated">Python 中 if __name__ == "__main__ "是做什么的？</h2><div class="om l"><h3 class="bd b gz z fq ok fs ft ol fv fx dk translated">Python 中主方法的执行时间和方式</h3></div><div class="on l"><p class="bd b dl z fq ok fs ft ol fv fx dk translated">codecrunch.org</p></div></div><div class="oo l"><div class="ou l oq or os oo ot kt of"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu of"><a rel="noopener follow" target="_blank" href="/dynamic-typing-in-python-307f7c22b24e"><div class="og ab fp"><div class="oh ab oi cl cj oj"><h2 class="bd iv gz z fq ok fs ft ol fv fx it bi translated">Python 中的动态类型</h2><div class="om l"><h3 class="bd b gz z fq ok fs ft ol fv fx dk translated">探索 Python 中对象引用的工作方式</h3></div><div class="on l"><p class="bd b dl z fq ok fs ft ol fv fx dk translated">towardsdatascience.com</p></div></div><div class="oo l"><div class="ov l oq or os oo ot kt of"/></div></div></a></div></div></div>    
</body>
</html>