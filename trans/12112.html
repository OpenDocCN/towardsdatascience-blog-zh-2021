<html>
<head>
<title>5 Python open-source tools to extract text and tabular data from PDF Files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个Python开源工具，用于从PDF文件中提取文本和表格数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-python-open-source-tools-to-extract-text-and-tabular-data-from-pdf-files-9359cdde6b56?source=collection_archive---------1-----------------------#2021-12-07">https://towardsdatascience.com/5-python-open-source-tools-to-extract-text-and-tabular-data-from-pdf-files-9359cdde6b56?source=collection_archive---------1-----------------------#2021-12-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c39d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">本文全面概述了从PDF文件中提取文本和表格数据的各种开源工具</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/70c0672a4f9eca400b9cfb707accc8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uS1g4tB20sxkl1HK6HaNvw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">里沙卜·夏尔马在<a class="ae ky" href="https://unsplash.com/photos/R-js25Pv1LQ" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="d404" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="d0d7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">作为数据科学家，我们必须尽可能多地利用组织内部或外部的可用数据源，以便以最相关的方式应对他们的问题。这些数据可能有不同的格式，有时很难处理。本文主要关注两个主要方面:文本数据抽取和表格数据抽取。</p><p id="70f4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">库的列表并不详尽，目标是集中于其中的5个，其中3个用于文本数据提取，2个用于表格数据提取。在文章的结尾可以找到更多的信息。</p><h1 id="1377" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">文本数据提取</h1><p id="3121" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于这一部分，测试数据是基于<a class="ae ky" href="https://www.bl.uk/learning/resources/pdf/makeanimpact/sw-transcripts.pdf" rel="noopener ugc nofollow" target="_blank">奥巴马的演讲词matter </a>。</p><p id="864e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是第一行和最后一行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/f46669f8d28344390554b0f7156dca35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*-HyNW7Xl_d_GnXe_6mW3Xw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文件的前两段</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/73498346412e55db1f1232e297e6b578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*6gBaJ3JHR8PUWtfMM_ndLA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文件的最后两段</p></figure><h2 id="ccb8" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">石板</h2><p id="ff60" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">由于与使用PDFMiner相关的困难，这个包被创建为PDFMiner的包装器，以使文本提取更加容易。</p><p id="56a6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ng">先决条件和实现</em> </strong></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="845b" class="mu la it ni b gy nm nn l no np">pip install slate3k</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/c360c48580157b08f95197399b54945b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vOFhsh5blyfe52iQ2ofxWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从板岩中提取的第一行</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/a201b66d916b7d857f5e724529152ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2y8IvmxicAet96H9iHbcog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从板岩中提取的第一行</p></figure><p id="4c98" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从slate3k的结果中，我们可以注意到pdf文档的所有内容都被检索到了，但是在这个过程中没有考虑回车。</p><h2 id="a963" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/26494211/extracting-text-from-a-pdf-file-using-pdfminer-in-python" rel="noopener ugc nofollow" target="_blank"> PdfMiner.six </a></h2><p id="c3fa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是社区维护的原始<a class="ae ky" href="https://pypi.org/project/pdfminer/" rel="noopener ugc nofollow" target="_blank"> PDFMiner </a>的分支，目的是让这个库能够与python 3一起工作。它用于信息提取，侧重于获取和分析文本数据，也可用于获取文本的确切位置、字体或颜色。</p><p id="512d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ng">先决条件及实现</em> </strong></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="9c20" class="mu la it ni b gy nm nn l no np">pip install pdfminer.six</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/b1eabc7fcf709be8e9b04e24b1c0e808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TeIThq1U__fuHByTtsLAyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">pdfminer摘录的前几行/段落。六</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/008a596d0debf1ff177258c121c8558d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*mLrrG1GSmzByE72n4fQVVg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">pdfminer.six中摘录的最后几行/段落</p></figure><p id="d993" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">考虑到所有回车，PdfMiner.six按原样获取PDF文件的内容</p><h2 id="3f69" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">PyPDF2</h2><p id="08f4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该库用于多种任务，如文本提取、合并PDF文件、分割特定PDF文件的页面、加密PDF文件等。在本文中，我们只关注文本提取特性。</p><p id="02cf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ng">先决条件和实现</em> </strong></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a05d" class="mu la it ni b gy nm nn l no np">pip install PyPDF2</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h1 id="cf99" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">表格数据提取</h1><p id="4798" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">大多数时候，企业都在寻找将PDF文件的数据转换成可编辑格式的解决方案。这样的任务可以使用以下python库来执行:<strong class="lt iu"> <em class="ng"> tabula-py </em> </strong>和<strong class="lt iu"> <em class="ng"> Camelot。</em> </strong>我们用这个<a class="ae ky" href="http://www.uncledavesenterprise.com/file/health/Food%20Calories%20List.pdf" rel="noopener ugc nofollow" target="_blank">食物卡路里列表</a>来突出场景。</p><h2 id="aed0" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">白板</h2><p id="f232" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个库是<a class="ae ky" href="https://github.com/tabulapdf/tabula-java" rel="noopener ugc nofollow" target="_blank"> tabula-java </a>的python包装器，用于从PDF文件中读取表格，并将这些表格转换成xlsx、csv、tsv和JSON文件。</p><p id="f815" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ng">先决条件及实现</em> </strong></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="907a" class="mu la it ni b gy nm nn l no np">pip install tabula-py<br/>pip install tabulate</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="dc3f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是第6页摘录的结果</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/166a130bfb76d739d042e2490e363aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1YUxRJXJHUHdQqUI84OSg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PDF文件摘录，第6页</p></figure><ul class=""><li id="6ff5" class="nx ny it lt b lu mn lx mo ma nz me oa mi ob mm oc od oe of bi translated">在<strong class="lt iu"> <em class="ng">第7行</em> </strong>上，我们可以通过使用选项<strong class="lt iu"> <em class="ng"> pages="all" </em> </strong>提取所有的表格</li><li id="3350" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated">在<strong class="lt iu"> <em class="ng">第17行</em> </strong>上，我们将结果转换成一个excel文件。相反，它可以被转换成CSV文件，tsv等。</li></ul><p id="9317" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是使用tabula的另一种方法。我们可以使用一条指令提取信息，而不是分解步骤，这次将数据存储为CSV文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="37fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">结果在内容上是一样的。唯一的区别在于文件的格式。</p><h2 id="1ea5" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">卡默洛特</h2><p id="482a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">可以使用Camelot，类似于Tabula-py，从PDF文件中提取表格。与tabula-py不同，Camelot依赖于同样需要安装的<strong class="lt iu"> <em class="ng"> ghostscript </em> </strong>库</p><p id="b1e2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ng">先决条件和实现</em> </strong></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="f87c" class="mu la it ni b gy nm nn l no np">pip install ghostscript</span><span id="795c" class="mu la it ni b gy ol nn l no np">pip install camelot-py</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="b769" class="nx ny it lt b lu mn lx mo ma nz me oa mi ob mm oc od oe of bi translated">第4行得到一个<strong class="lt iu"> <em class="ng">表格列表</em> </strong>类型，包含PDF中存在的所有表格。</li><li id="f33d" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated">第7行将显示11，对应于文件中表的数量。</li><li id="bb42" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated">从第10行到第12行，我们转换每个表并显示它们的前5个观察值。我们还可以保存每个数据帧。我们可以使用<strong class="lt iu"> <em class="ng">直接将每个表格保存为. csv文件。</em>to _ CSV(output . CSV)</strong>如下图</li></ul><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="eb71" class="mu la it ni b gy nm nn l no np">"""<br/>Let convert for instance the 6th (index starts at 0) table into .csv file</span><span id="aeb7" class="mu la it ni b gy ol nn l no np">"""</span><span id="d5f5" class="mu la it ni b gy ol nn l no np">all_tables[5].to_csv<strong class="ni iu">(</strong>'table_6.csv'<strong class="ni iu">)</strong></span></pre><h1 id="f4d6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">文章结尾</h1><p id="c2b6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">恭喜你！您刚刚学习了如何使用<strong class="lt iu"> <em class="ng"> slate </em> </strong>、<strong class="lt iu"> <em class="ng"> pdfminer.six、PyPDF tabula-py </em> </strong>和<em class="ng"> Camelot </em> 从PDF文件中提取文本和表格数据。现在，您可以通过使用您浏览过的库来收集更多数据，从而为您的业务带来价值。您可以在下面找到更多资源。</p><p id="7643" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在YouTube<a class="ae ky" href="https://www.youtube.com/channel/UC9xKdy8cz6ZuJU5FTNtM_pQ" rel="noopener ugc nofollow" target="_blank">上关注我</a>获得更多互动会话！</p><h1 id="d2f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">额外资源</h1><p id="2bc2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://www.geeksforgeeks.org/working-with-pdf-files-in-python/" rel="noopener ugc nofollow" target="_blank">使用Python处理PDF文件</a></p><p id="7e4c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://nanonets.com/blog/extract-tables-from-pdf/" rel="noopener ugc nofollow" target="_blank">如何从PDF中提取表格</a></p><p id="7e5c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/user/quickstart.html" rel="noopener ugc nofollow" target="_blank">卡梅洛特快速入门</a></p><p id="2030" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">再见🏃🏾</p></div></div>    
</body>
</html>