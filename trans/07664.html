<html>
<head>
<title>Inference for Categorical Data with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python对分类数据进行推理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/inference-for-categorical-data-9f3c6034aa57?source=collection_archive---------28-----------------------#2021-07-13">https://towardsdatascience.com/inference-for-categorical-data-9f3c6034aa57?source=collection_archive---------28-----------------------#2021-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4e83" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python实现大学统计</h2></div><h1 id="e605" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="d9c8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在一系列的每周文章中，我将会涉及一些重要的统计学主题。</p><p id="236b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">目标是使用Python来帮助我们获得对复杂概念的直觉，从经验上测试理论证明，或者从零开始构建算法。在本系列中，您将会看到涵盖随机变量、抽样分布、置信区间、显著性检验等主题的文章。</p><p id="62a3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在每篇文章的最后，你可以找到练习来测试你的知识。解决方案将在下周的文章中分享。</p><p id="a405" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">迄今发表的文章:</p><ul class=""><li id="fbec" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/bernoulli-and-binomial-random-variables-d0698288dd36">伯努利和二项随机变量与Python </a></li><li id="a180" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55">用Python从二项式到几何和泊松随机变量</a></li><li id="b1df" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/sampling-distributions-with-python-f5a5f268f636">用Python实现样本比例的抽样分布</a></li><li id="83d3" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/confidence-intervals-with-python-bfa28ebb81c">Python的置信区间</a></li><li id="5eab" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6">使用Python进行显著性测试</a></li><li id="b25d" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9">用Python进行组间差异的双样本推断</a></li><li id="b3e9" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/inference-for-categorical-data-9f3c6034aa57">分类数据的推断</a></li><li id="5520" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/advanced-regression-f74090014f3">高级回归</a></li><li id="8f6f" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/analysis-of-variance-anova-8dc889d2fc3a">方差分析— ANOVA </a></li></ul><p id="b68d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">像往常一样，代码可以在我的<a class="ae mk" href="https://github.com/luisroque/College_Statistics_with_Python" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h1 id="0d54" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">卡方分布</h1><p id="6f16" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们从定义一个标准的正态分布随机变量(RV) X_1开始。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/7e13c3e209575ba3e48ffd141437b8df.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/1*cli27W6Tj_g0ROAc5qhL6w.png"/></div></figure><p id="447d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为了定义我们的第一个卡方RV，我们从我们的标准正态分布X_1中取样并对结果求平方。因为我们取一个标准正态分布变量的和，所以我们将卡方分布的自由度定义为1。为了定义具有2个自由度的卡方RV，我们遵循相同的想法。这次我们从两个独立的标准正态分布RVs中取样，取各自样本的平方，最后对结果求和。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b01a3d7b084af34bd1ac7d01412679cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*UgFHj1BGZA--jGBbz4Dc5g.png"/></div></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="1c37" class="ne kj it na b gy nf ng l nh ni">from scipy.stats import norm, chi2<br/>import matplotlib.pyplot as plt<br/>import math<br/>import numpy as np<br/>import seaborn as sns<br/>from scipy import stats<br/>import tabulate<br/>import pandas as pd<br/>from IPython.display import HTML, display<br/>import tabulate</span><span id="67f7" class="ne kj it na b gy nj ng l nh ni">mu = 0<br/>variance = 1<br/>sigma = math.sqrt(variance)<br/>x = np.linspace(mu - 3*sigma, mu + 3*sigma, 100)<br/>sns.lineplot(x = x, y = norm.pdf(x, loc=mu, scale=sigma));</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl nk"><img src="../Images/5c155cafad20a78dc6954a5fed53736e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*AJht0rZWIGJN_OGVzwQSuA.png"/></div><p class="nl nm gj gh gi nn no bd b be z dk translated">图1:标准正态分布的概率密度函数。</p></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="0b9d" class="ne kj it na b gy nf ng l nh ni">norm_dist = stats.norm(0, 1)<br/><br/>x1 = norm_dist.rvs(size=100000)**2<br/>x2 = norm_dist.rvs(size=100000)**2<br/>x3 = norm_dist.rvs(size=100000)**2<br/><br/>x = [x1, x2, x3]<br/><br/>_, ax = plt.subplots(1, 3, figsize=(18, 7))<br/><br/>f = np.zeros(100000)<br/>for i in range(3):<br/>    x_ = x[i]<br/>    f += x_<br/>    <br/>    ax[i].hist(f, 60, density=True, label=f'Sum of {i+1} standard Gaussian RV')<br/><br/>    d = np.arange(0, 10, .05)<br/>    ax[i].plot(d, stats.chi2.pdf(d, df=i+1), color='r', lw=2, label='Chi-Square dist.')<br/>    ax[i].set_xlim(0, 10)<br/>    ax[i].set_title(f'Chi-Square dist. with df={i+1}')<br/>    ax[i].legend()</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl nk"><img src="../Images/672bd19f8851c8b2bab2abcc40eef4f4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*XtEMYZ0tYBqGDmKQwzTR1Q.png"/></div><p class="nl nm gj gh gi nn no bd b be z dk translated">图2:来自平方标准正态分布(正态分布的总和等于自由度的数量)的样本直方图与卡方分布的概率密度函数之间的比较。</p></figure><h1 id="c26d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">适合度</h1><p id="419e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">芮在一家科技公司远程工作。如果人不太多的话，他喜欢在咖啡店工作。最近新开了一家咖啡店，他想了解一周中每天的顾客分布情况。这样，他会选择百分比较小的日子在那里工作。根据他在类似地方的经验，他画出了一周中每天顾客数量的分布。为了测试这一假设，在接下来的3个月里，他随机选择了一周中每天的一个样本，并记录了观察到的顾客数量。</p><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="ad9f" class="ne kj it na b gy nf ng l nh ni">table = [["Day",'M','T', 'W', 'T', 'F', 'S', 'S'],<br/>         ["Expected (%)",10,10, 10, 20, 30, 15, 5],<br/>         ["Observed",30, 14, 34, 45, 57, 20, 10]]<br/>display(HTML(tabulate.tabulate(table, tablefmt='html')))</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/e5a55802f52b9024c9f6f4112638cff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*LkSSCWhBwtBQt_djy1VhTA.png"/></div><p class="nl nm gj gh gi nn no bd b be z dk translated">表1:一周中每天新咖啡店的顾客分布。</p></figure><p id="ead7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在进一步讨论之前，我们需要确保满足卡方拟合优度测试条件。我们先来列举一下:</p><ul class=""><li id="a2ae" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">样本必须是随机的</li><li id="a0d0" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">每类结果的预期数量必须大于或等于5(也称为大计数条件)</li><li id="6d14" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">要求样本是独立的。经验法则是，如果你是在没有替换的情况下抽样，你的样本量应该少于总体量的10%</li></ul><p id="07d3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们被告知，芮随机选择了一周中的每一天，所以第一个标准得到了满足。对于大计数的条件，让我们计算一周中每天的预期客户数。</p><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="4af1" class="ne kj it na b gy nf ng l nh ni">n = 7 # number of days in a week<br/>alpha = 0.05<br/><br/>table = np.asarray(table)[1:,1:]<br/>table = table.astype(np.float32)<br/>table[0] = table[0]/100</span><span id="9f0b" class="ne kj it na b gy nj ng l nh ni">total_number_customers = np.sum(table[1])<br/>expected_num = table[0]*total_number_customers</span><span id="eef1" class="ne kj it na b gy nj ng l nh ni">table = np.concatenate((table, expected_num.reshape(1,-1)))<br/>table[2]</span><span id="1957" class="ne kj it na b gy nj ng l nh ni">array([ 26.460001,  64.26    ,  85.049995, 107.729996,  37.8     ,<br/>        18.9     ], dtype=float32)</span></pre><p id="afc9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">请注意，我们没有任何小于5的值。最后，我们有独立的条件。Rui从3个月的人口中选择了每一天，这给了我们每一类12个可能的值。这意味着芮抽样的样本不到总人口的10%,即使他的样本没有替换，我们也可以假设它是独立的。</p><p id="1f93" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">根据这些数据，Rui定义了以下假设检验:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/77eddea99c173a4480e80cadbb420cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*S-knHcK_kaPLLAd4MNpkFA.png"/></div></figure><p id="a6a9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">首先，他必须计算一个统计数据，比较估计的和观察到的客户数量。它近似遵循卡方分布。如果基于相似位置的分布是正确的，他可以使用这个统计量来计算观察到特定值或更极端值的概率。如果这个概率小于显著性水平(让我们使用α=0.05)，我们可以拒绝H_0，从而接受另一个假设，即新咖啡店每天的顾客分布不同于芮考虑的类似场所。</p><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="ed98" class="ne kj it na b gy nf ng l nh ni">chi_sq_statistic = np.sum((table[2]-table[1])**2/table[2])<br/>chi_sq_statistic</span><span id="306e" class="ne kj it na b gy nj ng l nh ni">19.246035</span><span id="cb07" class="ne kj it na b gy nj ng l nh ni">(1-chi2.cdf(chi_sq_statistic, df=n-1))&lt;alpha</span><span id="4b70" class="ne kj it na b gy nj ng l nh ni">True</span><span id="fdb7" class="ne kj it na b gy nj ng l nh ni">if (1-chi2.cdf(chi_sq_statistic, df=n-1))&lt;alpha:<br/>    print('Reject H_0')</span><span id="b875" class="ne kj it na b gy nj ng l nh ni">Reject H_0</span></pre><p id="7990" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们根据Rui收集的观察结果拒绝了h0，这些观察结果包括新咖啡店每天的顾客数量。事实上，我们拒绝了h0意味着新的地方不遵循假设的分布定义的芮根据他的经验在类似的地方。</p><h1 id="2c56" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">列联表卡方检验</h1><p id="2788" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">一个政府机构想知道目前正在使用的针对新冠肺炎病毒的疫苗是否对新的Delta变种有任何效果。他们将样本分成3组:第一组服用辉瑞的疫苗，第二组服用让桑，第三组服用安慰剂。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nr"><img src="../Images/581b81a3c356317c22192711d90956f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3D4J5B8vIVLmUqrg"/></div></div><p class="nl nm gj gh gi nn no bd b be z dk translated">图3:新冠肺炎疫苗；<a class="ae mk" href="https://unsplash.com/photos/mAGZNECMcUg" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="96cc" class="ne kj it na b gy nf ng l nh ni">table = [['Sick', 15, 10, 30],['Not sick', 100, 110, 90]]<br/>alpha = 0.05<br/>df = pd.DataFrame(table)<br/>df.columns = ['Effect', 'Pfizer', 'Janssen', 'Placebo']<br/>df = df.set_index('Effect')<br/>df</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl nk"><img src="../Images/788f1d74418896bad29ad326d15c6419.png" data-original-src="https://miro.medium.com/v2/format:webp/1*IPKZQtrzHKQu5yoIvIHoQw.png"/></div><p class="nl nm gj gh gi nn no bd b be z dk translated">表2:服用疫苗(辉瑞和让桑之间)或安慰剂的患病或未患病人群的样本数量。</p></figure><p id="c099" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们定义我们的假设检验:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/2404c04db6f9865faf32a3e1cc9a6235.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*nvAGjYrEnsRUCPxqOInJiw.png"/></div></figure><p id="e078" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">像在任何假设检验中一样，我们将假设零假设为真，并计算得到上面收集的数据的可能性。如果它低于显著性水平，我们拒绝零假设。</p><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="1e5b" class="ne kj it na b gy nf ng l nh ni">arr = df.to_numpy()<br/>arr = np.concatenate((arr, (arr.sum(axis=1)[0]/arr.sum() * arr.sum(axis=0)).reshape(1,-1)))<br/>arr = np.concatenate((arr, (arr.sum(axis=1)[1]/arr.sum() * arr.sum(axis=0)).reshape(1,-1)))<br/>arr</span><span id="54f3" class="ne kj it na b gy nj ng l nh ni">array([[ 15.        ,  10.        ,  30.        ],<br/>       [100.        , 110.        ,  90.        ],<br/>       [ 17.81690141,  18.5915493 ,  18.5915493 ],<br/>       [ 97.18309859, 101.4084507 , 101.4084507 ]])</span><span id="f88c" class="ne kj it na b gy nj ng l nh ni">chi_sq_statistic = np.sum((arr[2] - arr[0])**2/arr[2]) + np.sum((arr[3] - arr[1])**2/arr[3])</span></pre><p id="4c67" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们应该使用的自由度数等于表的行数减1乘以列数减1。</p><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="3cdf" class="ne kj it na b gy nf ng l nh ni">print('P-value = ' + str(np.round(1-chi2.cdf(chi_sq_statistic, df =2*1), 4)))</span><span id="712c" class="ne kj it na b gy nj ng l nh ni">P-value = 0.0012</span><span id="abb4" class="ne kj it na b gy nj ng l nh ni">if 1-chi2.cdf(chi_sq_statistic, df =2*1) &lt; alpha:<br/>    print('Reject H_0')</span><span id="4aa0" class="ne kj it na b gy nj ng l nh ni">Reject H_0</span></pre><p id="743d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们拒绝了h0，这意味着疫苗产生了一些效果，并影响了我们实验中的患病人数。</p><h1 id="1909" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">同质性卡方检验</h1><p id="ae8f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">同一家机构决定测试辉瑞的疫苗，但这次的目标是测试对男性和女性的效果。</p><p id="8140" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这是一个同质性检验，可以转化为以下假设:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/50eaaeccd380149fe07635b3dd28e096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*XE4LPmde4nFu6YKPcDrS1w.png"/></div></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="5615" class="ne kj it na b gy nf ng l nh ni">table = [['Sick', 25, 12],['Not sick', 92, 88]]<br/>alpha = 0.05<br/>df = pd.DataFrame(table)<br/>df.columns = ['Effect', 'Men', 'Women']<br/>df = df.set_index('Effect')<br/>df</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl nk"><img src="../Images/693a3ab82a58519970fa4673ff947204.png" data-original-src="https://miro.medium.com/v2/format:webp/1*LmJkXXElp_5H5IgxNYqGWQ.png"/></div><p class="nl nm gj gh gi nn no bd b be z dk translated">表3:服用辉瑞疫苗的患病或未患病的男女样本数量。</p></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="99bf" class="ne kj it na b gy nf ng l nh ni">arr = df.to_numpy()<br/>arr = np.concatenate((arr, (arr.sum(axis=1)[0]/arr.sum() * arr.sum(axis=0)).reshape(1,-1)))<br/>arr = np.concatenate((arr, (arr.sum(axis=1)[1]/arr.sum() * arr.sum(axis=0)).reshape(1,-1)))<br/>arr</span><span id="0f02" class="ne kj it na b gy nj ng l nh ni">array([[25.        , 12.        ],<br/>       [92.        , 88.        ],<br/>       [19.94930876, 17.05069124],<br/>       [97.05069124, 82.94930876]])</span><span id="4559" class="ne kj it na b gy nj ng l nh ni">chi_sq_statistic = np.sum((arr[2] - arr[0])**2/arr[2]) + np.sum((arr[3] - arr[1])**2/arr[3])</span><span id="9247" class="ne kj it na b gy nj ng l nh ni">print('P-value = ' + str(np.round(1-chi2.cdf(chi_sq_statistic, df =1*1), 4)))</span><span id="3a36" class="ne kj it na b gy nj ng l nh ni">P-value = 0.0674</span><span id="ad2e" class="ne kj it na b gy nj ng l nh ni">if 1-chi2.cdf(chi_sq_statistic, df =1*1) &lt; alpha:<br/>    print('Reject H_0')<br/>else:<br/>    print('Fail to reject H_0')</span><span id="6534" class="ne kj it na b gy nj ng l nh ni">Fail to reject H_0</span></pre><p id="b1bf" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">请注意，尽管观察到这些值或甚至更极端值的概率相当低(约6.7%)，但我们未能拒绝H_0。这意味着我们没有足够的证据表明疫苗对男性和女性的效果有差异。</p><h1 id="bebd" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">关联的卡方检验</h1><p id="cd4a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">最后，让我们为两个变量之间的关联建立一个卡方检验。在这种情况下，我们想要测试冲浪者的身高X和他曾经冲浪的最大浪高y之间是否存在关联。请注意，这个特定的测试使用了单一人群的随机样本。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/44755772c2d0ae773fa179da49154ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*83BukOU2qbObM6LO5EAUwA.png"/></div></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="2378" class="ne kj it na b gy nf ng l nh ni">table = [['x&lt;1.6m', 25, 22, 28],['1.6m&lt;=x&lt;1.9m', 10, 21, 35], ['x&gt;=1.9m', 5, 10, 34]]<br/>alpha = 0.05<br/>df = pd.DataFrame(table)<br/>df.columns = ['height', 'y&lt;2m', '2m&lt;=y&lt;4m', 'y&gt;=4m']<br/>df = df.set_index('height')<br/>df</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl nk"><img src="../Images/1c4f0b004ffa42e501c94f9309aa96cb.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TQfKJ2Z64DMKoC1pb9pC2Q.png"/></div><p class="nl nm gj gh gi nn no bd b be z dk translated">表4:不同冲浪者高度的样本数量X/曾经冲浪的最大波浪尺寸y。</p></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="4755" class="ne kj it na b gy nf ng l nh ni">arr = df.to_numpy()<br/><br/>for i in range(arr.shape[0]):<br/>    arr = np.concatenate((arr, (arr.sum(axis=1)[i]/arr.sum() * arr.sum(axis=0)).reshape(1,-1)))<br/>arr</span><span id="8f5c" class="ne kj it na b gy nj ng l nh ni">array([[25.        , 22.        , 28.        ],<br/>       [10.        , 21.        , 35.        ],<br/>       [ 5.        , 10.        , 34.        ],<br/>       [15.78947368, 20.92105263, 38.28947368],<br/>       [13.89473684, 18.41052632, 33.69473684],<br/>       [10.31578947, 13.66842105, 25.01578947]])</span><span id="66a4" class="ne kj it na b gy nj ng l nh ni">chi_sq_statistic = np.sum((arr[3] - arr[0])**2/arr[3]) + np.sum((arr[4] - arr[1])**2/arr[4]) + np.sum((arr[5] - arr[2])**2/arr[5])</span><span id="1ce5" class="ne kj it na b gy nj ng l nh ni">print('P-value = ' + str(np.round(1-chi2.cdf(chi_sq_statistic, df =2*2), 4)))</span><span id="5b35" class="ne kj it na b gy nj ng l nh ni">P-value = 0.0023</span><span id="5bc8" class="ne kj it na b gy nj ng l nh ni">if 1-chi2.cdf(chi_sq_statistic, df =2*2) &lt; alpha:<br/>    print('Reject H_0')<br/>else:<br/>    print('Fail to reject H_0')</span><span id="2546" class="ne kj it na b gy nj ng l nh ni">Reject H_0</span></pre><p id="d362" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们拒绝H_0，也就是说，有证据表明冲浪者的高度和最大浪高有关联。</p><h1 id="d42e" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="16ca" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">本文涵盖了卡方检验家族的一部分。它们有助于检验关于分类数据分布的假设。我们评估了适合度检验，即检验样本数据是否符合假设分布。我们还看到了两个变量之间不同类型的独立性检验。当我们从两个不同的人群中抽取样本时，我们检验同质性。如果我们从一个总体中取样，我们测试变量之间的关联。</p><p id="3951" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">保持联系:<a class="ae mk" href="https://www.linkedin.com/in/luisbrasroque/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><h1 id="79b1" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">练习</h1><p id="f7f8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">你将在下周的文章中找到答案。</p><ol class=""><li id="9074" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv nz mh mi mj bi translated">根据冲浪板经销商的说法，66%的冲浪板是常见的，25%是不常见的，9%是罕见的。José想知道他和他的朋友拥有的板子的稀有程度是否遵循这种分布，所以他随机抽取了500块板子并记录了它们的稀有程度。结果如下表所示。进行拟合优度测试，以确定José和他的朋友拥有的冲浪板的稀有程度分布是否与声称的百分比不一致。</li></ol><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="4049" class="ne kj it na b gy nf ng l nh ni">table = [['Cards', 345, 125, 30]]<br/>alpha = 0.05<br/>df = pd.DataFrame(table)<br/>df.columns = ['Rarity level', 'Common', 'Uncommon', 'Rare']<br/>df = df.set_index('Rarity level')<br/>df</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl nk"><img src="../Images/7f6c43cc7bc7ec7774b3b15a137d71e0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HCXgmzZ6QJlEf68jxkhZPw.png"/></div></figure><h2 id="50cb" class="ne kj it bd kk oa ob dn ko oc od dp ks lj oe of ku ln og oh kw lr oi oj ky ok bi translated">上周的答案</h2><ol class=""><li id="7f98" class="mb mc it lc b ld le lg lh lj ol ln om lr on lv nz mh mi mj bi translated">医生假设，疫苗接种前后因新冠肺炎而住院的平均时间发生了变化。将1000名患者随机分为治疗组和对照组。治疗组已经注射了疫苗，而对照组没有注射。结果显示，治疗组的平均住院时间比对照组少10天。下表总结了1000次数据重新随机化的结果。根据数据，治疗组的平均值比对照组的平均值小10天或更多的概率是多少？从实验结果中你能得出什么结论(假设5%的显著性水平)？</li></ol><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="105b" class="ne kj it na b gy nf ng l nh ni">diff = [[-17.5,1],<br/>[-15.0, 6],<br/>[-12.5, 15],<br/>[-10.0, 41],<br/>[-7.5, 82],<br/>[-5.0, 43],<br/>[-2.5, 150],<br/>[0., 167],<br/>[2.5, 132],<br/>[5.0, 127],<br/>[7.5, 173],<br/>[10.0, 38],<br/>[12.5, 18],<br/>[15.0, 6],<br/>[17.5, 1]]</span><span id="9059" class="ne kj it na b gy nj ng l nh ni">plt.bar(x = np.asarray(diff)[:,0], height = np.asarray(diff)[:,1], width=2, color='C0')<br/>plt.bar(x = np.asarray(diff)[:4,0], height = np.asarray(diff)[:4,1], width=2, color='C1');</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl nk"><img src="../Images/d9fbd40c1be47a7dcb4e8a229c11b5d2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*kV3vlMOwmVui7obDVjgKsQ.png"/></div></figure><pre class="mr ms mt mu gt mz na nb nc aw nd bi"><span id="dde0" class="ne kj it na b gy nf ng l nh ni">diff = np.asarray(diff)</span><span id="0efc" class="ne kj it na b gy nj ng l nh ni">np.sum(diff[diff[:,0]&lt;=-10][:,1])/np.sum(diff[:,1]) &lt; 0.05</span><span id="efa7" class="ne kj it na b gy nj ng l nh ni">False</span></pre><p id="74e5" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">基于5%的显著性水平，结果不显著。实验中测量到的差异可能仅仅是随机因素造成的。</p></div></div>    
</body>
</html>