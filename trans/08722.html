<html>
<head>
<title>Synthetic Data Generation Using Conditional-GAN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用条件GAN的合成数据生成</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/synthetic-data-generation-using-conditional-gan-45f91542ec6b?source=collection_archive---------1-----------------------#2021-08-12">https://towardsdatascience.com/synthetic-data-generation-using-conditional-gan-45f91542ec6b?source=collection_archive---------1-----------------------#2021-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c927" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">修改GAN架构，以便更好地控制生成的数据类型</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cde10021b243dd0e62dc75187adcd680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TVtTbqVA2_NxT3-j"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的西提·拉赫马纳·马特·达乌德拍摄</p></figure><h1 id="af83" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为什么需要生成数据？</h1><p id="94ec" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在信息技术领域，公司使用数据来改善客户体验，并为客户提供更好的服务。有时候，收集数据可能会很繁琐，而且成本很高。</p><p id="012e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本文中，我们将讨论GAN和特殊条件GAN，一种我们在<a class="ae kv" href="https://syntheticdata.community/" rel="noopener ugc nofollow" target="_blank"> Y-Data </a>用于合成数据生成的方法。以及如何利用它们生成合成数据集。</p><h1 id="c2c1" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">甘</strong></h1><p id="ab5c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">GAN是由Ian Goodfellow等人提出的。在2014年本文中。GAN架构由两个组件组成，称为发生器和鉴别器。简单来说，生成器的作用是生成新的数据(数字、图像等。)与作为输入提供的数据集一样接近/相似，鉴别器的作用是区分生成的数据和真实的输入数据。</p><p id="09de" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">下面我们就来详细参观一下甘的算法工作原理:</p><p id="fe3d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">o生成器将一个随机数向量作为输入，并返回由其生成的图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/c75529ee8ebb83a01da207363d91e552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8n-Hf2kbrtm0XR5Nz6oBA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd mr">发电机输入(来源:</strong> <a class="ae kv" href="https://developers.google.com/machine-learning/gan/discriminator" rel="noopener ugc nofollow" target="_blank"> <strong class="bd mr">此处</strong> </a> <strong class="bd mr"> ) </strong></p></figure><p id="8c41" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">o发生器生成的图像与实像样本一起作为输入传递给鉴别器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/5793da48d832a671980d703dad40ef67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4PfhleebaaCu_k6Qeqdug.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd mr">鉴别器输入(来源:</strong> <a class="ae kv" href="https://developers.google.com/machine-learning/gan/discriminator" rel="noopener ugc nofollow" target="_blank"> <strong class="bd mr">此处</strong> </a> <strong class="bd mr"> ) </strong></p></figure><p id="dc24" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">o鉴别器采集两种类型的样本，来自真实数据集的图像和生成图像的样本。它返回一个介于0和1之间的概率值，其中越接近1的值表示属于真实数据集的图像变化越大，否则图像属于生成的图像样本的可能性越大。</p><p id="d4b4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">o当我们计算鉴频器损耗时，鉴频器的错误分类会受到惩罚。该<em class="mp">鉴别器损失</em>然后反向传播并更新鉴别器权重，这反过来改善了鉴别器预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/94aa7a9287ab0999f8f32492e121d0e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQgh3OckYH1aAHaPFQJ7QA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd mr">甘鉴别仪训练(来源:</strong> <a class="ae kv" href="https://developers.google.com/machine-learning/gan/discriminator" rel="noopener ugc nofollow" target="_blank"> <strong class="bd mr">此处</strong> </a> <strong class="bd mr"> ) </strong></p></figure><p id="5b7a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">o发电机然后在鉴别器分类的帮助下计算<em class="mp">发电机损耗</em>，并通过鉴别器和发电机反向传播以计算梯度。然后，它仅使用这些梯度更新发生器权重。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/52fbeb0d35a13888b1bd25bd9dbcac10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mh6-Y7x2FSkD4EVFniQSTg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd mr">甘发电机培训(来源:</strong> <a class="ae kv" href="https://developers.google.com/machine-learning/gan/generator" rel="noopener ugc nofollow" target="_blank"> <strong class="bd mr">此处</strong> </a> <strong class="bd mr"> ) </strong></p></figure><h1 id="a5aa" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">有条件——甘</strong></h1><p id="da7a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">尽管GAN能够生成一些好的数据点示例，但是它不能生成具有目标标签的数据点，并且从其生成的数据集缺乏多样性。</p><p id="3e60" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">有条件GAN是由<em class="mp"> M. Mirza </em>在2014年末提出的。他修改了架构，将标签<strong class="lq ir"> <em class="mp"> y </em> </strong>作为参数添加到生成器的输入中，并尝试生成相应的数据点。它还向鉴别器输入添加标签，以便更好地区分真实数据。</p><p id="c0b2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以下是有条件GAN的架构:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/44a650b8dfbf1aee354377834296c0d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jep3VTyXtrFIHZ-oQdbuEQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd mr"> C-GAN架构</strong></p></figure><p id="7595" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这种架构中，随机输入噪声<strong class="lq ir"> <em class="mp"> Z </em> </strong>在联合隐藏表示中与标签<strong class="lq ir"> <em class="mp"> Y </em> </strong>相结合，GAN训练框架允许在如何接收输入方面有很大的灵活性。</p><p id="0d0f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">数据点<strong class="lq ir"> <em class="mp"> X </em> </strong>和<strong class="lq ir"> <em class="mp"> Y </em> </strong>连同生成输出<strong class="lq ir"><em class="mp">【G(z)</em></strong>一起被传入鉴别器的输入，这与普通GAN架构中的情况相同</p><p id="bc96" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">条件GAN的损失函数类似于GAN:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/012c260dba1bb6f27fb12379d00dad02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*r23VaxS47kq8A6hdcH65cg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd mr">条件GAN损失功能</strong></p></figure></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="204b" class="kw kx iq bd ky kz ne lb lc ld nf lf lg jw ng jx li jz nh ka lk kc ni kd lm ln bi translated">Python实现</h1><p id="6cf3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在这个实现中，我们将在时装-MNIST数据集上应用条件GAN来生成不同服装的图像。该数据集包含70，000幅(60k训练和10k测试)大小为(28，28)的灰度格式图像，像素值为b/w 1和255。</p><p id="6b24" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">数据集中有10个分类标签。它们中的每一个都用数字b/w 0–9来表示。下表列出了相应的标签:</p><p id="1945" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">0: T恤/上衣</p><p id="095b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">1:裤子</p><p id="94b2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2:套头衫</p><p id="e5bc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">3:着装</p><p id="8a42" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">4:外套</p><p id="077e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">5:凉鞋</p><p id="6139" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">6:衬衫</p><p id="ee96" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">7:运动鞋</p><p id="d410" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">8:袋子</p><p id="b4ff" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">9:踝靴。</p><p id="6ecd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，让我们开始编写代码。首先，我们导入所需的模块，我们将TensorFlow Keras API来设计我们的架构。一些代码取自这个book⁴:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="43da" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，我们定义生成器架构，该生成器架构采用随机潜在向量和标签的组合作为输入，并生成该标签的图像。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/17b33613af65f3ae524dc2d31191682a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lR6i3qFbSxgczQq_S-wNDQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成器架构(源代码)</p></figure><p id="7634" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，我们定义鉴别器架构，该鉴别器架构将图像和标签作为输入，并输出它是真实的或生成的概率。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/c8924af08f24fb39b1a7b314e2fe3b5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoZWZSYgxkrTAXDHlFOaAg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">鉴别器架构(源代码)</p></figure><p id="c44a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">下一步，我们将结合这两种架构，形成完整的C-GAN架构:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="5b1a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，是时候训练模型了，首先，我们定义采样函数，然后，我们训练模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="3979" class="ns kx iq no b gy nt nu l nv nw">2000 [D loss: 0.097897, acc.: 96.88%] [G loss: 4.837958]<br/>4000 [D loss: 0.084203, acc.: 98.05%] [G loss: 5.004930]<br/>6000 [D loss: 0.111222, acc.: 97.66%] [G loss: 4.664765]<br/>8000 [D loss: 0.091828, acc.: 97.27%] [G loss: 5.158591]<br/>10000 [D loss: 0.110758, acc.: 98.44%] [G loss: 5.750035]<br/>12000 [D loss: 0.152362, acc.: 92.58%] [G loss: 4.261237]<br/>14000 [D loss: 0.075084, acc.: 96.48%] [G loss: 5.566125]<br/>16000 [D loss: 0.108527, acc.: 96.88%] [G loss: 9.546798]<br/>18000 [D loss: 0.043660, acc.: 99.61%] [G loss: 6.730018]<br/>20000 [D loss: 0.075157, acc.: 97.66%] [G loss: 6.238955]</span></pre><p id="2cf7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，我们把生成的图片生成GIF，他的一些代码是从<a class="ae kv" href="https://www.tensorflow.org/tutorials/generative/dcgan" rel="noopener ugc nofollow" target="_blank">这里</a>截取的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/3ad8feb984fcb54ea995e2cb9030e4be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wNXttbMMMStcLitH09AuAA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Generated_Images(来源:代码)</p></figure><h1 id="083c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="9101" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本文中，我们讨论了用于合成数据生成的GAN和条件GAN。而GAN则是合成数据生成领域的一个新发现。不同的研究者根据他们的需要修改了GAN背后的想法。一个这样的想法是Conditional-GAN，它允许我们根据所需的标签生成数据。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="99cd" class="kw kx iq bd ky kz ne lb lc ld nf lf lg jw ng jx li jz nh ka lk kc ni kd lm ln bi translated"><strong class="ak">参考文献</strong></h1><p id="93fb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">[1]: Ian J. Goodfellow，J. Pouget-Abadie，M. Mirza等人，<a class="ae kv" href="https://arxiv.org/abs/1406.2661" rel="noopener ugc nofollow" target="_blank"/>(2014)。</p><p id="4791" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[2]: M. Mirza，S. Osindero，<a class="ae kv" href="https://arxiv.org/abs/1411.1784" rel="noopener ugc nofollow" target="_blank">条件生成对抗网</a> (2014)。</p><p id="3d72" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[3]: H. Xiao，K. Rasul，R. Vollgraf，<a class="ae kv" href="https://arxiv.org/abs/1708.07747" rel="noopener ugc nofollow" target="_blank"> Fashion-MNIST:一个新的图像数据集，用于对机器学习算法进行基准测试。</a></p><p id="395f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[4]: J. Langr，V.Bok，<a class="ae kv" href="https://www.amazon.com/GANs-Action-Learning-Generative-Adversarial/dp/B09237G4TH/" rel="noopener ugc nofollow" target="_blank"> GANs in Action:深度学习与生成性对抗网络</a> (2019)，Manning Publications</p><p id="1ed7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="mp">本页面的部分内容是基于Google </em>  <em class="mp">创建和共享的</em> <a class="ae kv" href="https://developers.google.com/readme/policies" rel="noopener ugc nofollow" target="_blank"> <em class="mp">作品的修改，并根据</em> </a><a class="ae kv" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank"> <em class="mp">知识共享4.0归属许可</em> </a> <em class="mp">中描述的条款使用。</em></p></div></div>    
</body>
</html>