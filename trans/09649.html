<html>
<head>
<title>Are Zero-Shot Text Classification Transformer Models the Key to Better Chatbots?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">零镜头文本分类变压器模型是更好的聊天机器人的关键吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/are-zero-shot-text-classification-transformer-models-the-key-to-better-chatbots-dd91dac3854a?source=collection_archive---------18-----------------------#2021-09-08">https://towardsdatascience.com/are-zero-shot-text-classification-transformer-models-the-key-to-better-chatbots-dd91dac3854a?source=collection_archive---------18-----------------------#2021-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ed75" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">为您的下一个聊天机器人项目</em>使用零镜头文本分类转换器模型克服对训练数据的需求</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/454107d53f665662c66eb1ae8354d096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HF1T7kQT2HG4z39wosk9tw.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="c4b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于许多自然语言处理(NLP)项目来说，最麻烦的任务之一是收集和标记训练数据。但是，对于聊天机器人的意图分类，有一个潜在的解决方案，那就是使用零镜头文本分类转换器模型。如果成功，这种方法将降低开发聊天机器人所需的复杂性，同时潜在地提高它们的性能。我鼓励你扩展这些想法，并可能将它们集成到你的聊天机器人系统中。</p><p id="3e28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">意图分类是聊天机器人执行的基本任务。意图分类是确定用户希望执行哪个动作的动作。例如，假设你问一个聊天机器人，“请播放U2的最新歌曲”，那么机器人必须确定用户希望“播放一首歌曲”。从那里，该模型将典型地使用实体识别来确定播放哪首歌曲。本文提出了一种在没有任何训练数据的情况下利用新技术执行意图分类的可能方法。</p><h1 id="117e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">零镜头文本分类</h1><p id="5a7d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">零镜头文本分类转换器模型于2019年在论文“基准零镜头文本分类:数据集、评估和蕴涵方法”[1]中提出。模型的输入被表述为每个标签的蕴涵问题。因此，给定文本“我想买一个苹果”和标签“食物”，前提将是文本，假设将类似于“这篇文本是关于食物的。”然后，模型确定假设是否需要前提。有了这项技术，NLP实践者可以在单个文本蕴涵数据集上训练他们的模型，然后使用该模型对任意标签执行文本分类。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/bce3a71eca64d40aec96d63ce5d1f9a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*D7TGYtG3_35iwnJi.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="5b97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用在拥抱脸的模型分发网络上下载量第二多的零镜头文本分类<a class="ae ms" href="https://huggingface.co/facebook/bart-large-mnli" rel="noopener ugc nofollow" target="_blank">模型</a>，它是由脸书·艾创建的。它是在麻省理工学院许可下发布的，这是一个许可许可你可以在这里阅读更多关于<a class="ae ms" href="https://opensource.org/licenses/MIT" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><h1 id="f096" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">体系结构</h1><p id="6b4f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">本文提出了一个基于树的意图分类系统，该系统利用零镜头文本分类模型。有些意图可能会被归类在一起，因此，我认为最好先确定意图的类别，然后再确定要执行的具体行动。例如，一个类别可以是“播放音乐”，然后该类别的意图可以是“播放艺术家”或“播放专辑”</p><p id="db31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在不应用零射击模型的情况下，使用类似的基于树的系统可能是遥不可及的，原因有两个。首先，您可能需要一个模型来对类别进行分类，然后为每个类别建立一个模型。所以，如果你在处理一个有很多可能动作的系统，这可能会有很多模型。然后，由于型号和类别数量的增加，需要更多的培训。因此，通过使用这个提出的系统，对于这个整个基于树的分类系统，只需要一个<strong class="lb iu">单一模型</strong>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/0139cd637977ca4c9cb340325931aec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/0*qq91JKgkisHBiV5r.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h1 id="1c9f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">模型创建</h1><p id="c1cc" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">目前，拥抱脸的变形金刚库是实现零镜头文本分类变形金刚模型的首选方式。因此，我们可以用下面一行代码从PyPI下载这个包。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="df7d" class="mz lw it mv b gy na nb l nc nd">pip install transformers</span></pre><p id="867f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拥抱脸创建了一个名为“管道”的功能，它抽象了使用变压器模型进行推理通常涉及的复杂性。还是导入吧。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="1997" class="mz lw it mv b gy na nb l nc nd">from transformers import pipeline</span></pre><p id="8c69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要向管道类提供我们希望执行的任务和模型名称。然后，它将输出一个我们可以用来开始分类文本的对象。任务id为“零镜头分类”，模型名称为“<a class="ae ms" href="https://huggingface.co/facebook/bart-large-mnli" rel="noopener ugc nofollow" target="_blank"> facebook/bart-large-mnli </a>”。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="774e" class="mz lw it mv b gy na nb l nc nd">task = "zero-shot-classification"<br/>model = "facebook/bart-large-mnli" </span><span id="1c7e" class="mz lw it mv b gy ne nb l nc nd">classifier = pipeline(task, model)</span></pre><h1 id="f6fe" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">主要意图分类</h1><p id="bd7b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">让我们为模型定义一个任意的标签列表来对文本进行分类。对于这个例子，我将为虚拟电话助理将要执行的常见任务添加标签。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="292f" class="mz lw it mv b gy na nb l nc nd">primary_labels = ["take note", "play music", "search internet ", "send email", "create reminder"]</span></pre><p id="6e37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以将文本归入这些标签之一。首先，让我们定义与这些标签之一相关的文本。我们将使用一个属于“播放音乐”类别的例子。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="d100" class="mz lw it mv b gy na nb l nc nd">input_text = "Put on Drake's new album"</span></pre><p id="f299" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了生成预测，我们可以向我们的分类器提供文本和标签，如下所示。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="1f55" class="mz lw it mv b gy na nb l nc nd">classifier_output = classifier(input_text, primary_labels)</span></pre><p id="160f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以打印结果了。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="d5d2" class="mz lw it mv b gy na nb l nc nd">print(classifier_output["labels"]) print(classifier_output["scores"])</span></pre><p id="9e63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nf">结果:</em></p><p id="7a39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nf"> ['播放音乐'，'做笔记'，'创建提醒'，'搜索互联网'，'发送电子邮件'][0.8064008355140686，0.1329479217529297，0.04738568142056465，0.010709572583436966，0.00255559617206454277]</em></p><p id="bdd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标签和分数都按最高分排序。因此，在这里我们看到“播放音乐”是最高的结果，得分为80.64%，这是有道理的。</p><h1 id="c6a3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">次要意图分类</h1><p id="f4f8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对于每个主要标签，我们必须创建一个次要标签列表，以进一步细化用户的意图。继续上面的例子，因为主要标签是“播放音乐”,下面是潜在动作的列表。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="b90c" class="mz lw it mv b gy na nb l nc nd">secondary_labels = ["play artist", "play song", "play album", "play popular", "play new", "play old"]</span></pre><p id="0fcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，我们可以使用零镜头文本分类模型来确定预期的动作。我们将向模型提供原始文本和二级标签。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="21d4" class="mz lw it mv b gy na nb l nc nd">secondary_classifier_output = classifier(input_text, secondary_labels) </span><span id="94e4" class="mz lw it mv b gy ne nb l nc nd">print(secondary_classifier_output["labels"]) print(secondary_classifier_output["scores"])</span></pre><p id="2ac8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nf"> ['播放专辑'，'播放艺人'，'播放新'，'播放流行'，'播放歌曲'，'播放旧']<br/>0.2994290888309479，0.23053139448165894，0.209768395962143，0.136963962316513，0.1226228971113205</em></p><p id="123d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们走吧！我们只是决定执行哪些操作。我们看到“播放艺术家”、“播放专辑”和“播放新闻”得分都很高。因此，现在我们可以使用实体识别来检测文本中的艺术家，然后查询该艺术家的最新专辑。</p><h1 id="bae6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="6c0b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这篇文章中，我提出了一种利用零触发文本分类模型来消除意图识别对训练数据的需求的方法。我还讨论了如何使用这种方法来创建一个树状搜索算法，以细化用户希望执行的确切操作。我希望这篇文章能启发你创建更强大的聊天机器人！</p><p id="ff52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您成功地为一个项目实施了这一建议方法，请发送电子邮件至eric@vennify.ca。我很想听听。</p><h1 id="3611" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><p id="5ca0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">[1] W. Yin，J. Hay，D. Roth，<a class="ae ms" href="https://arxiv.org/abs/1909.00161" rel="noopener ugc nofollow" target="_blank">基准测试零镜头文本分类:数据集、评估和蕴涵方法</a> (2019)，EMNLP 2019</p><p id="dced" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] A.Williams，N. Nangia，S. Bowman，<a class="ae ms" href="https://aclanthology.org/N18-1101/" rel="noopener ugc nofollow" target="_blank">通过推理进行句子理解的广泛覆盖挑战语料库</a> (2018)，计算语言学协会</p><h1 id="fc11" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">资源:</h1><p id="7fab" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><a class="ae ms" href="https://colab.research.google.com/drive/1nfmdmIaCCkfKLjwGmlxps9gU6Jfxx-Fa?usp=sharing" rel="noopener ugc nofollow" target="_blank">本教程中使用的代码</a></p><h1 id="ddfd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">类似文章</h1><p id="2d84" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果你喜欢这篇文章，那么你可能也会喜欢下面这篇文章，它涵盖了我的一个原创研究项目，涉及零镜头文本分类转换器模型。</p><p id="ef43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nf">题目:如何标注文本分类训练数据—用AI </em> <em class="nf">总结:用一个零镜头的文本分类模型来标注训练数据。然后，使用带标签的训练数据来微调更容易在生产中使用的小型监督模型。</em></p><p id="698c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ms" rel="noopener" target="_blank" href="/how-to-label-text-classification-training-data-with-ai-11ed11a5e893?sk=2340bbfb3befa376bfa3b83da88f4fa4"> <strong class="lb iu"> <em class="nf">条</em> </strong> </a></p><p id="a3e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ms" href="https://youtu.be/2BkMrra3F9s" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nf">视频</em> </strong> </a></p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="aa2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nf">原载于2021年9月8日</em><a class="ae ms" href="https://www.vennify.ai/zero-shot-transformer-models-chatbots/" rel="noopener ugc nofollow" target="_blank"><em class="nf">https://www . vennify . ai</em></a><em class="nf">。</em></p></div></div>    
</body>
</html>