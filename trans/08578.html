<html>
<head>
<title>How to Easily Perform Pandas Operations on S3 With AWS Data Wrangler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用AWS Data Wrangler在S3上轻松执行Pandas操作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-perform-pandas-operations-on-s3-with-aws-data-wrangler-875672289aae?source=collection_archive---------8-----------------------#2021-08-08">https://towardsdatascience.com/how-to-easily-perform-pandas-operations-on-s3-with-aws-data-wrangler-875672289aae?source=collection_archive---------8-----------------------#2021-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e59f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">与S3交互，就像它是您的本地文件系统一样</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b906d4e442c46d2013affd45c0de5576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GA2zO2O3EfibBL7J"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jjying?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> JJ英</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="be9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我一直觉得通过编程与S3交互来执行简单的任务有点复杂和不直观，比如文件读取或写入、批量下载或上传，甚至大规模文件删除(使用通配符等)。</p><p id="36fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的典型用例是处理我从S3下载(或保存到那里)的熊猫数据帧，数据格式有三种:CSV、JSON和Parquet，用于分析和处理。</p><p id="b396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在寻找<a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" rel="noopener ugc nofollow" target="_blank"> boto3 </a>(不要误会，这是一个很好的与AWS进行编程接口的包)的替代品时，我遇到了<a class="ae ky" href="https://github.com/awslabs/aws-data-wrangler" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> AWS Data Wrangler </strong> </a>，这是一个python库，它通过将数据帧连接到AWS数据相关的服务，如Athena、Glue、Redshift、DynamoDB、EMR……以及最重要的(至少对我来说)S3，将Pandas的功能扩展到AWS。</p><blockquote class="lv lw lx"><p id="25f8" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">在本帖中，我将回顾AWS Data Wrangler轻松连接熊猫和S3的功能。</strong></p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/f7c5ccbbc918a2ec6a71b83c86389ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wvb0QI862jem5Z7vaEmGTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="d636" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">什么是S3？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/412b44d115b70eb6da4be2976bf4181e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-yDK1s_U1kWNiyTz"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户修改的图像</p></figure><p id="9843" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你不是AWS用户，S3代表亚马逊简单存储服务。这是一套网络服务，你可以用它在任何时间，从网络上的任何地方存储任何数量的数据。</p><p id="a483" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它为任何开发人员提供了对高度可伸缩、可靠、快速和廉价的数据存储的访问。</p><p id="bc36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→要全面了解S3，请查看官方<a class="ae ky" href="https://aws.amazon.com/s3/?nc1=h_ls" rel="noopener ugc nofollow" target="_blank">文档。</a></p><p id="3110" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> → </strong>为了能够使用S3并复制以下代码片段，您需要设置一个AWS帐户。</p><h1 id="c317" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">创建IAM用户</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a31962183c9a1c2f559e4428c2654a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*NQJgZ0Bm7jJ9_O3p"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户修改的图像</p></figure><p id="bc46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在使用AWS Data Wrangler之前，您必须创建一个<strong class="lb iu"> IAM用户</strong>。</p><p id="0f70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">IAM代表<strong class="lb iu">身份和访问管理</strong>:这是一种让你能够安全管理AWS服务和资源访问的服务。IAM允许您创建用户和组，并使用权限来允许或拒绝对AWS资源的访问。</p><p id="f9e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦创建了IAM用户，AWS将为您提供两个凭证:<code class="fe mx my mz na b"><strong class="lb iu">Access key ID</strong></code>和<code class="fe mx my mz na b"><strong class="lb iu">Secret access key</strong></code>。您必须使用它们在您的机器上配置AWS概要文件。</p><p id="7262" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，AWS Data Wrangler将使用该配置文件代表您以编程方式访问AWS服务。</p><p id="4400" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建IAM用户，请转到AWS控制台并搜索IAM。在左上角的工具条上，点击<code class="fe mx my mz na b">Users</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/09bee08dd8ebb528d467563e4e3d27cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lafLDI498x61jJnohYrmlw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户截图</p></figure><p id="66a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将列出您已经创建的用户。要添加新的，点击<code class="fe mx my mz na b">Add users</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/6c52090cf5e175657fa25184585e48f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5iIJ7WwZ6S2EjJRLJlxVgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户截图</p></figure><p id="0a9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此用户输入一个名称，并分配给它<code class="fe mx my mz na b"><strong class="lb iu">Programmatic access</strong></code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/5a9a408dfd87cc90224fa47d67d69b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t2Z4enrtwXZUYcWFiJ1sOA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户截图</p></figure><p id="564e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，将其添加到一个组中，以定义其权限集。为简单起见，授予it管理员访问权限，但是您可能希望将其限制为一组有限的权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/4ce3d7465524462342571cd513f31bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LKLwjrjLgP6uJhx82X5UAg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户截图</p></figure><p id="56d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">跳过标记步骤并验证用户创建。</p><p id="e222" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建用户后，屏幕上会出现凭证:<code class="fe mx my mz na b"><strong class="lb iu">Access key ID</strong></code>和<code class="fe mx my mz na b"><strong class="lb iu">Secret access key</strong></code>。我们将使用它们来配置AWS概要文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/551e0aeb3c8480b26d6c07a538c10752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLipjTIGb5voMwV03lRJLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户截图</p></figure><h1 id="656f" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">配置AWS配置文件</h1><p id="d55c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">要配置AWS概要文件，您必须首先按照本<a class="ae ky" href="https://docs.aws.amazon.com/cli/latest/userguide/install-windows.html" rel="noopener ugc nofollow" target="_blank">指南</a>安装AWS CLI，然后输入以下命令</p><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="d074" class="np me it na b gy nq nr l ns nt"><strong class="na iu">aws configure --profile ahmed</strong></span></pre><p id="226c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">系统会提示您输入以前的凭据。只需这样做，并将区域名称和输出格式保留为默认值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/1dc8c97719c255d9f151504d0e299a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eI3_9ZhTnjGotnJpliP_bw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户截图</p></figure><p id="9a11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，AWS概要文件已经正确配置了。</p><p id="4a6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了让AWS Data Wrangler使用它，我们必须在实验开始时设置一个与boto3的默认会话:只需在脚本或笔记本的开头留下这些行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3483" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">后续命令将使用为此配置文件提供的权限。</p><h1 id="4c61" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">使用AWS Data Wrangler与s3对象交互</h1><p id="9811" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">首先，让我们安装AWS数据牧马人。</p><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="310d" class="np me it na b gy nq nr l ns nt"><strong class="na iu">pip install awswrangler</strong></span></pre><p id="80e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在运行任何命令与S3交互之前，让我们看看我的buckets的当前结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/8e93937a68f5c44026c35a3a5a6e2550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1mms3eYFjHEvnmd8qtxKCQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户截图</p></figure><p id="3a94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没什么特别的，只是一堆我用于个人项目的水桶。</p><p id="fc90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS Data Wrangler可以对这些桶执行基本操作:</p><ul class=""><li id="e066" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">检查物体是否存在:</strong></li></ul><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="4a21" class="np me it na b gy nq nr l ns nt"><strong class="na iu">&gt;&gt;&gt; wr.s3.does_object_exist("s3://ahmedbesbes.com/plot.html")<br/>True</strong></span></pre><ul class=""><li id="d0da" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">递归列出桶内的对象:</strong></li></ul><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="8f88" class="np me it na b gy nq nr l ns nt"><strong class="na iu">&gt;&gt;&gt; wr.s3.list_objects("s3://ahmedbesbes.com")<br/>['s3://ahmedbesbes.com/app.mp4',<br/> 's3://ahmedbesbes.com/plot.html',<br/> 's3://ahmedbesbes.com/pyldavis.html']</strong></span></pre><ul class=""><li id="3ca6" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">列出存储桶内的目录</strong></li></ul><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="e607" class="np me it na b gy nq nr l ns nt"><strong class="na iu">&gt;&gt;&gt; wr.s3.list_directories("s3://sozy")<br/>['s3://sozy/assets/',<br/> 's3://sozy/images/',<br/> 's3://sozy/saved_images/']</strong></span></pre><ul class=""><li id="ff38" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">显示每个桶的区域名称</strong></li></ul><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="616a" class="np me it na b gy nq nr l ns nt"><strong class="na iu">&gt;&gt;&gt; wr.s3.get_bucket_region("ahmedbesbes.com")<br/>'eu-west-3'</strong></span></pre><ul class=""><li id="8dc2" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">获取每个对象的信息</strong></li></ul><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="6a96" class="np me it na b gy nq nr l ns nt"><strong class="na iu">&gt;&gt;&gt; wr.s3.describe_objects("s3://ahmedbesbes.com/plot.html")</strong></span></pre><p id="8bd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将输出一个描述文件的JSON对象。它包括内容类型、大小以及权限元数据等属性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/c6cf623be85d46c3d6442e0139bc90be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IY81PyB2gAVVu-W1uzyQDg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="2d4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mx my mz na b">describe_objects</code>方法也可以接受一个文件夹作为输入。在这种情况下，它将返回一个JSON对象列表，每个对象描述文件夹中的每个文件。</p><h1 id="7612" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">读取、写入和删除操作</h1><p id="fc30" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">现在有趣的部分来了，我们让熊猫在S3上做手术。</p><ul class=""><li id="65bb" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">读取文件</strong></li></ul><p id="f411" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从在bucket中保存一个虚拟数据帧作为CSV文件开始。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="9def" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就像与本地文件系统交互一样简单。这里有一件很酷的事情:如果<code class="fe mx my mz na b">/csv/sub-folder/</code>还不存在，AWS Data Wrangler会自动创建它。</p><ul class=""><li id="c23b" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">一次读取多个CSV文件:</strong></li></ul><p id="66da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个其实挺简单的。您所要做的就是传递一个远程路径列表。在幕后，AWS Data Wrangler将沿着行轴(轴=0)连接四个数据帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><ul class=""><li id="723a" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">使用前缀</strong></li></ul><p id="8ef7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您在一个文件夹中有1000个CSV文件，并且您想在一个数据帧中一次性读取它们。为此，您可以将文件夹的路径传递给<code class="fe mx my mz na b">read_csv</code>方法。AWS Data Wrangler将在其中查找所有CSV文件。</p><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="7fd2" class="np me it na b gy nq nr l ns nt"><strong class="na iu">wr.s3.read_csv(f"s3://{bucket}/csv/")</strong></span></pre><ul class=""><li id="09df" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">删除对象</strong></li></ul><p id="cbb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe mx my mz na b">delete_objects</code>方法删除对象</p><p id="8a32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该方法在path参数中接受Unix shell样式的通配符。</p><p id="9b0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，假设您想要删除特定文件夹中的所有1000个CSV文件。</p><p id="f508" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你应该这么做:</p><pre class="kj kk kl km gt nl na nm nn aw no bi"><span id="a929" class="np me it na b gy nq nr l ns nt"><strong class="na iu">wr.s3.delete_objects(f"s3://{bucket}/folder/*.csv")</strong></span></pre><h1 id="fb16" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">JSON和Parquet文件也是如此</h1><p id="2427" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">您也可以对JSON和Parquet文件执行同样的操作</p><p id="b692" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只需替换为:</p><ul class=""><li id="079c" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><code class="fe mx my mz na b">wr.s3.read_csv</code>带<code class="fe mx my mz na b">wr.s3.read_json</code>或<code class="fe mx my mz na b">wr.s3.read_parquet</code></li><li id="fc53" class="ny nz it lb b lc oi lf oj li ok lm ol lq om lu od oe of og bi translated"><code class="fe mx my mz na b">wr.s3.to_csv</code>同<code class="fe mx my mz na b">wr.s3.to_json</code>或<code class="fe mx my mz na b">wr.s3.to_parquet</code></li></ul><h1 id="139f" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">下载和上传对象</h1><ul class=""><li id="480f" class="ny nz it lb b lc ng lf nh li on lm oo lq op lu od oe of og bi translated"><strong class="lb iu">下载对象</strong></li></ul><p id="20e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS Data Wrangler使从S3下载对象变得非常容易。这是我开始使用它的主要原因。</p><p id="3c7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要下载远程对象，只需使用download方法。该方法将对象的远程路径作为第一个参数，将保存对象的本地路径作为第二个参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3bb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，您可以以二进制模式下载对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><ul class=""><li id="1810" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">上传对象</strong></li></ul><p id="377f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上传对象遵循相同的逻辑。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="e893" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">感谢阅读！</h1><p id="f8cf" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">这篇文章收集了我在使用AWS Data Wrangler进行per时所做的笔记。我希望你觉得它们有用。</p><p id="633b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在后面的文章中，我将回顾其他AWS服务，如DynamoDB和EMR，以及如何使用AWS Data Wrangler与它们进行交互。</p><p id="6255" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就目前而言，如果你想深入了解，这里有一些值得一读的资源。</p><ul class=""><li id="a1d1" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu">AWS S3:</strong><a class="ae ky" href="https://aws.amazon.com/s3/?nc1=h_ls" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">https://aws.amazon.com/s3/?nc1=h_ls</strong></a></li><li id="9646" class="ny nz it lb b lc oi lf oj li ok lm ol lq om lu od oe of og bi translated"><strong class="lb iu">AWS IAM:</strong><a class="ae ky" href="https://aws.amazon.com/iam/?nc2=type_a" rel="noopener ugc nofollow" target="_blank">T9】https://aws.amazon.com/iam/?nc2=type_a</a></li><li id="4be6" class="ny nz it lb b lc oi lf oj li ok lm ol lq om lu od oe of og bi translated"><strong class="lb iu"> AWS数据牧马人文档:</strong><a class="ae ky" href="https://aws-data-wrangler.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">https://aws-data-wrangler.readthedocs.io/</strong></a></li><li id="431c" class="ny nz it lb b lc oi lf oj li ok lm ol lq om lu od oe of og bi translated"><strong class="lb iu">Github:</strong>https://github.com/awslabs/aws-data-wrangler<a class="ae ky" href="https://github.com/awslabs/aws-data-wrangler" rel="noopener ugc nofollow" target="_blank">T21T23】</a></li></ul><p id="c84e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下次见！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/b89d974784558adbabad461dc528bb6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QemEUh4WIrXbAPVR"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@karsten116?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡斯滕·怀恩吉尔特</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="bc55" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">新到中？您可以每月订阅5美元，并解锁无限的文章— <a class="ae ky" href="https://ahmedbesbes.medium.com/membership" rel="noopener">单击此处。</a></h1></div></div>    
</body>
</html>