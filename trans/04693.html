<html>
<head>
<title>The Art of Writing Efficient Code Comments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写高效代码注释的艺术</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-art-of-writing-efficient-code-comments-692213ed71b1?source=collection_archive---------10-----------------------#2021-04-23">https://towardsdatascience.com/the-art-of-writing-efficient-code-comments-692213ed71b1?source=collection_archive---------10-----------------------#2021-04-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6f5d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数据科学任务代码注释的最佳实践</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b8769b95210ea402770748afb2f7587f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GmZJNotyzYihNAggZks5xg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/PT_9ux0j-x4" rel="noopener ugc nofollow" target="_blank">来自Unsplash </a></p></figure><p id="0c26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们在Jupyter笔记本上运行<code class="fe lv lw lx ly b">import this</code>，或者简单地打开<a class="ae ky" href="https://www.python.org/dev/peps/pep-0020/" rel="noopener ugc nofollow" target="_blank">这个链接</a>，我们将得到<em class="lz">Python的禅</em>，这是Tim Peters收集的19条Python设计指南的集合。其中一条说:“可读性很重要”，在这篇文章中，我们将讨论这个原则的一个方面:代码注释，它是包含在代码中的自然语言文本片段，用于它的文档。事实上，代码注释，加上干净的代码，变量和函数的正确命名，以及使代码尽可能清晰，对我们项目的可读性有很大的贡献。这不仅对将来阅读我们作品的人很有帮助，而且对我们自己也很有帮助。</p><p id="63ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将关注注释应用于数据科学任务的Python代码的最佳实践。然而，这些准则中的大部分也适用于任何其他编程语言或领域。</p><h1 id="036a" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">语法和样式</h1><p id="489a" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">在Python中，有两种类型的代码注释:块注释和内联注释。</p><p id="f527" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据<a class="ae ky" href="https://www.python.org/dev/peps/pep-0008/#comments" rel="noopener ugc nofollow" target="_blank"> PEP 8 </a>，<strong class="lb iu">块注释</strong>以一个hash ( <code class="fe lv lw lx ly b">#</code>)开头，后跟一个空格，由一个或多个句子组成，第一个单词大写，每句话尾加一个句号。如果有几个句子，用两个空格隔开。块注释通过一个空行与上面的代码分开。它们适用于直接跟在它们后面的代码(没有空行)，并且具有相同的缩进。</p><p id="bf18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一长行块注释应该分散在几行中，每一行都以一个散列开头，后跟一个空格。用Python编写多行注释的另一种方式是使用<strong class="lb iu">多行字符串</strong>——那些嵌入在三个单引号或双引号中的字符串。从技术上讲，它们最初是为另一个目的而设计的:将文档分配给函数、方法或类。然而，如果不在这种质量中使用或不赋给变量，多行字符串不会生成代码，因此它可以作为Python中代码注释的一种非常规方式。这种方法得到了Python创始人吉多·范·罗苏姆在他的推特上的认可。</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="0461" class="nb mb it ly b gy nc nd l ne nf">✔️<br/># Isolate the outliers with at least $3,500 spent per month except <br/># for the cases when the respondent hadn't attended any bootcamp or <br/># had been learning programming for a maximum 3 months before the <br/># survey.<br/>above_3500 = usa[(usa['MoneyPerMonth']&gt;=3500)\<br/>                &amp;(usa['AttendedBootcamp']!=0.0)\<br/>                &amp;(usa['MonthsProgramming']&gt;3.0)]</span><span id="e7ea" class="nb mb it ly b gy ng nd l ne nf">✔️<br/>'''Isolate the outliers with at least $3,500 spent per month except for the cases when the respondent hadn't attended any bootcamp or had been learning programming for a maximum 3 months before the survey.<br/>'''<br/>above_3500 = usa[(usa['MoneyPerMonth']&gt;=3500)\<br/>                &amp;(usa['AttendedBootcamp']!=0.0)\<br/>                &amp;(usa['MonthsProgramming']&gt;3.0)]</span><span id="ba57" class="nb mb it ly b gy ng nd l ne nf">✔️<br/>"""Isolate the outliers with at least $3,500 spent per month except for the cases when the respondent hadn't attended any bootcamp or had been learning programming for a maximum 3 months before the survey.<br/>"""<br/>above_3500 = usa[(usa['MoneyPerMonth']&gt;=3500)\<br/>                &amp;(usa['AttendedBootcamp']!=0.0)\<br/>                &amp;(usa['MonthsProgramming']&gt;3.0)]</span></pre><p id="e84f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个<strong class="lb iu">行内注释</strong>被放置在它所注释的代码段的同一行上，用至少两个空格、一个散列和一个空格隔开。行内注释通常较短，应谨慎使用，因为它们往往会在视觉上与上下的代码行混在一起，因此变得不可读，如下面这段代码所示:</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="5ecf" class="nb mb it ly b gy nc nd l ne nf">❌<br/>ax.set_title('Book Rating Comparison', fontsize=20)<br/>ax.set_xlabel(None)  # remove x label<br/>ax.tick_params(axis='both', labelsize=15)<br/>plt.show()</span></pre><p id="8573" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不过，有时行内注释可能是不可或缺的:</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="9284" class="nb mb it ly b gy nc nd l ne nf">✔️<br/>colors = [[213/255,94/255,0],         # vermillion<br/>          [86/255,180/255,233/255],   # sky blue<br/>          [230/255,159/255,0],        # orange<br/>          [204/255,121/255,167/255]]  # reddish purple</span></pre><p id="3d29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在上面的代码中，行内注释的对齐有助于提高它们的可读性。</p><p id="49d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管代码注释语法的指导方针是为了使代码更具可读性和一致性，但我们应该记住，语言本身是不断发展的，样式约定也是如此。此外，一个公司(或一个特定的项目)可以有自己的编码风格方法，如果与PEP 8不同，那么优先考虑那些特定情况的建议。因此，有时官方的指导方针可以被忽略。但是，有些做法几乎总是应该避免的:</p><ul class=""><li id="2f44" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">在注释前使用多个哈希</li><li id="0e48" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">在注释的结尾也使用一个或多个散列</li><li id="20cd" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">省略哈希和注释之间的空格</li><li id="ec25" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">使用全部大写字母(我们稍后会看到一个例外)</li><li id="a97f" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">在注释上方的一段代码后省略一个空行</li><li id="6354" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">在注释及其相关代码之间插入空行</li><li id="26a2" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">忽略注释代码的缩进</li></ul><p id="0e31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些方法是不可取的，因为它们用不必要的元素使代码变得混乱，降低了代码的可读性，并使区分不同的代码块变得困难。比较这些注释样式不同的相同代码:</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="23ef" class="nb mb it ly b gy nc nd l ne nf">❌<br/>###REMOVE ALL THE ENTRIES RELATED TO 2021###</span><span id="f6ae" class="nb mb it ly b gy ng nd l ne nf">questions = questions[questions['Date'].dt.year &lt; 2021]<br/>###CREATE A LIST OF TAGS###</span><span id="9977" class="nb mb it ly b gy ng nd l ne nf">tags_list = list(tags.keys())</span><span id="85ff" class="nb mb it ly b gy ng nd l ne nf">✔️<br/># Remove all the entries related to 2021.<br/>questions = questions[questions['Date'].dt.year &lt; 2021]</span><span id="fecb" class="nb mb it ly b gy ng nd l ne nf"># Create a list of tags.<br/>tags_list = list(tags.keys())</span></pre><h1 id="270c" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">写有意义的评论</h1><p id="9620" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">如果代码本身告诉计算机要做什么，那么代码注释是写给人类的，向他们解释这段代码到底是做什么的，特别是为什么我们需要它。关于“什么”,有一种普遍的观点认为，如果我们的代码尽可能显式和简单，如果我们对变量和函数使用自解释的名称，那么我们几乎根本不需要代码注释。尽管我同意编写易于理解的代码和仔细选择变量/函数名非常重要，但我认为代码注释也相当有用。</p><ul class=""><li id="5be2" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">它们有助于将代码分成几个逻辑部分，使其更容易导航。</li><li id="826f" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">它们有助于解释很少使用的或新的方法/功能的功能。此外，如果我们必须应用不寻常/不明显的方法来编码，添加代码注释是一个好主意，因为当试图遵循更明确的方法时，可能会检测到一些bugs技术问题/版本冲突。</li><li id="d9a9" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">编写代码时，我们应该记住将来可能会阅读我们代码的人(例如我们的同事)。对一个人来说很清楚的事，对另一个人来说可能一点也不明显。因此，我们应该考虑到不同人在经验、技术和背景知识方面的潜在差距，并通过使用注释来促进他们的任务。</li><li id="5a6c" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">代码注释对于添加关于作者、日期和修改状态的信息很有价值(例如<code class="fe lv lw lx ly b"># Updated by Elena Kosourova, 22.04.2021. Added an annotation of the current year on the graph.</code>)。</li></ul><p id="bbbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，代码注释是提高代码可读性和可访问性的快速而强大的方法，对于编写清晰而有意义的注释来说，仅仅成为一个好的编码员是不够的，成为一个好的作者也很重要，这本身几乎是一项需要学习的技能。</p><p id="6f5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们考虑一些我们应该遵循的建议，以便有效地应用代码注释并防止过度使用。</p><h2 id="366c" class="nb mb it bd mc nv nw dn mg nx ny dp mk li nz oa mm lm ob oc mo lq od oe mq of bi translated">避免明显的代码注释</h2><p id="2524" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">我们的评论不应该脱离上下文陈述明显或清楚的事情。让我们再次记住，“证据”可能因人而异，我们工作的范围和目标受众也很重要(例如，如果我们正在编写一个关于数据科学的真实数据项目或一本学生手册)。我们的任务是找到平衡。</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="81eb" class="nb mb it ly b gy nc nd l ne nf">❌<br/># Import libraries.<br/>import pandas as pd<br/>import numpy as np</span></pre><h2 id="1b7f" class="nb mb it bd mc nv nw dn mg nx ny dp mk li nz oa mm lm ob oc mo lq od oe mq of bi translated">避免低效的代码注释</h2><p id="e8a1" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">为了最大限度地发挥作用，我们的代码注释应该尽可能地精确和简洁，给出关于代码的所有必要细节，并排除任何不相关的信息，如对以前代码的观察、对未来的打算或括号。此外，由于代码通常暗示了一些动态(它<em class="lz">做了</em>，<em class="lz">创建了</em>，<em class="lz">移除了</em>，等等)。)，一个好的做法是使用动词而不是名词:</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="fa67" class="nb mb it ly b gy nc nd l ne nf">❌ <strong class="ly iu">Too vague</strong><br/># Select a specific type of columns.<br/>characters = star_wars.iloc[:, 15:29]</span><span id="d9d0" class="nb mb it ly b gy ng nd l ne nf">❌ <strong class="ly iu">Too wordy</strong><br/># Now, let's select all the columns of a radio-button type from our dataframe.<br/>characters = star_wars.iloc[:, 15:29]</span><span id="f44e" class="nb mb it ly b gy ng nd l ne nf">❌ <strong class="ly iu">Observations from the previous code</strong><br/># Select radio-button type columns, as done earlier for checkbox type ones.<br/>characters = star_wars.iloc[:, 15:29]</span><span id="c9a0" class="nb mb it ly b gy ng nd l ne nf">❌ <strong class="ly iu">Using a noun instead of a verb</strong><br/># Selection of radio-button type columns.<br/>characters = star_wars.iloc[:, 15:29]</span><span id="d4b1" class="nb mb it ly b gy ng nd l ne nf">✔️ <strong class="ly iu">Good</strong><br/># Select radio-button type columns.<br/>characters = star_wars.iloc[:, 15:29]</span></pre><h2 id="2241" class="nb mb it bd mc nv nw dn mg nx ny dp mk li nz oa mm lm ob oc mo lq od oe mq of bi translated">更新代码注释</h2><p id="fe66" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">这是一个棘手且非常常见的陷阱，但我们应该始终记住，当代码发生变化时，也要对代码注释进行所有必要的修改。正如PEP 8所说，“与代码相矛盾的注释比没有注释更糟糕”。更重要的是，有时我们不仅要检查与被修改的代码相关的代码注释，还要检查其他可能被这种修改间接影响的代码注释。</p><h2 id="ef26" class="nb mb it bd mc nv nw dn mg nx ny dp mk li nz oa mm lm ob oc mo lq od oe mq of bi translated">要使用的语言</h2><p id="681d" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">一种常见的做法是始终用英语编写代码注释。然而，这是在某些情况下可以忽略的规则之一:如果我们绝对确定我们的代码永远不会被不讲我们的语言(或任何其他通用语言)的人阅读，那么我们最好完全用那种语言写注释。在这种情况下，对于我们特定的目标受众来说，代码变得更容易理解。</p><h2 id="6c7d" class="nb mb it bd mc nv nw dn mg nx ny dp mk li nz oa mm lm ob oc mo lq od oe mq of bi translated">注释掉部分代码</h2><p id="4201" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">有时，在一个项目中，我们发现为同一任务或调试代码测试几种方法是有用的，然后我们可以决定保留一些测试过的部分，即使我们在最后选择了另一个，以防万一。然而，这种方法只是暂时的，在项目的最终版本中，清除这样的碎片是很重要的。事实上，对于那些将来会阅读这些代码的人(包括我们自己)来说，这可能会让他们分心。读者可能会开始怀疑被注释掉的代码在任何一步是否有用，以及它是否应该保留在项目中。为了避免这种混乱，最好删除所有注释掉的代码。</p><p id="e086" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像往常一样，这种最佳实践可能存在非常罕见的例外。比方说，我们的工作是展示获得相同结果的不同方法，一种方法比另一种方法更可取(仍然可行，但使用较少)。在这种情况下，我们可以关注main方法，并将第二个方法显示为注释掉的代码，并带有相应的注释。此外，这里我们可以使用前面提到的另一个例外，在代码注释中使用大写字母，以使其更加清晰可见:</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="c20c" class="nb mb it ly b gy nc nd l ne nf">✔️<br/># Create a stem plot.<br/>plt.stem(months.index, months)</span><span id="dbfb" class="nb mb it ly b gy ng nd l ne nf"># # ALTERNATIVE WAY TO CREATE A STEM PLOT.<br/># plt.vlines(x=months.index, ymin=0, ymax=months)<br/># plt.plot(months.index, months, 'o')</span></pre><h1 id="6da0" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">结论</h1><p id="e317" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">总而言之，代码注释是一种方便的技术，可以向其他人传达我们用于编码的方法以及它们背后的原因。它提高了整体代码的可读性，并使在不同的逻辑块之间导航变得更加容易。为了在Python中创建有意义的代码注释，我们必须遵循简单明了的技术准则，牢记可能的本地公司或项目特定的约定，使我们的注释尽可能简洁和信息丰富，在代码修改时更新它们，最后但同样重要的是，避免过度使用它们。</p><p id="ccc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><p id="baa0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，你也可以发现下面这些有趣的:</p><div class="og oh gp gr oi oj"><a href="https://python.plainenglish.io/the-little-prince-on-a-word-cloud-8c912b9e587e" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">用Python为《小王子》生成单词云</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">文字云上的小王子:我们可以这样解开他的一些谜团吗？</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">python .平原英语. io</p></div></div><div class="os l"><div class="ot l ou ov ow os ox ks oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://medium.com/geekculture/creating-toyplots-in-python-49de0bb27ec1" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">在Python 🧸中创建玩具图</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">高质量的极简交互式可视化，非常适合电子出版</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox ks oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://medium.com/mlearning-ai/11-cool-names-in-data-science-2b64ceb3b882" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">数据科学中的11个酷名字</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">你可能不知道它们是什么意思</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="oz l ou ov ow os ox ks oj"/></div></div></a></div></div></div>    
</body>
</html>