<html>
<head>
<title>Object detection with Tensorflow model and OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Tensorflow模型和OpenCV的目标检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/object-detection-with-tensorflow-model-and-opencv-d839f3e42849?source=collection_archive---------0-----------------------#2021-07-15">https://towardsdatascience.com/object-detection-with-tensorflow-model-and-opencv-d839f3e42849?source=collection_archive---------0-----------------------#2021-07-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1577" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">使用经过训练的模型来识别静态图像和实时视频上的对象</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/296ee11f0a2dcb651ea9b7c6ad8f4fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhW153TqnV7gndCsaDlu4w.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kw" href="https://www.pexels.com/photo/close-up-photography-of-magnifying-glass-906055/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="bfe9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这篇文章中，我将演示如何使用一个经过训练的模型来检测图像和视频中的对象，使用两个最好的库来解决这类问题。对于检测，我们需要一个模型，能够预测图像中的多个类别，并返回这些对象的位置，以便我们可以在图像上放置盒子。</p><h1 id="3a9c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">模型</h1><p id="c7a6" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">我们将使用来自<a class="ae kw" href="https://tfhub.dev/" rel="noopener ugc nofollow" target="_blank"> Tensorflow Hub </a>库中的模型，该库中有多个在各种数据集内训练过的准备部署模型，可以解决各种问题。对于我们的使用，我过滤了为对象检测任务训练的模型和TFLite格式的模型。这种格式通常用于物联网应用，因为它的尺寸小，性能比更大的模型更快。我选择这种格式，因为我打算在未来的项目中在Rasberry Pi上使用这种模型。</p><p id="c509" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">选择的模型是<a class="ae kw" href="https://tfhub.dev/tensorflow/efficientdet/lite2/detection/1" rel="noopener ugc nofollow" target="_blank"> EfficientDet-Lite2物体探测模型</a>。它在具有91个不同标签的COCO17数据集上进行训练，并针对TFLite应用进行了优化。该模型返回:</p><ol class=""><li id="4da2" class="mq mr iq kz b la lb ld le lg ms lk mt lo mu ls mv mw mx my bi translated">检测的框边界；</li><li id="6c3c" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">检测分数(给定类别的概率)；</li><li id="ee45" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">检测类；</li><li id="38ac" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">检测次数。</li></ol><h1 id="4d4e" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">检测物体</h1><p id="20b4" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">我将把这个部分分为两个部分:静态图像的检测和网络视频的检测。</p><h2 id="cc82" class="ne lu iq bd lv nf ng dn lz nh ni dp md lg nj nk mf lk nl nm mh lo nn no mj np bi translated">静态图像</h2><p id="e1ac" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">我们将从检测Unsplash图像中的对象开始:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nq"><img src="../Images/76eefadb720ee3fda0876c6e7aa2e128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZCWfdsfcBIxMGtFphzzVg.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kw" href="https://unsplash.com/photos/cckf4TsHAuw" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="5981" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">因此，我们要做的第一件事是加载这个图像，并将其处理为TensorFlow模型的预期格式。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="30a1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">基本上，我们使用OpenCV加载原始图像，并将其转换为模型格式的RGB张量。</p><p id="ff3e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们可以加载模型和标签了:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="eb1f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该模型是直接从网站上加载的，但是，您可以将其下载到您的计算机上，以获得更好的加载性能。文本标签CSV可在<a class="ae kw" href="https://github.com/gabrielcassimiro17/raspberry-pi-tensorflow" rel="noopener ugc nofollow" target="_blank">项目报告</a>中找到。</p><p id="bb5c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，我们可以创建预测，并将找到的方框和标签放入图像中:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="c949" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，如果我们运行<em class="nt"> plt.imshow(img_boxes) </em>，我们会得到以下输出:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nu"><img src="../Images/f6eeb0325213b3ba78747b8dd8e3fd1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5oiStcXbvdQprXTY9ocfQ.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kw" href="https://unsplash.com/photos/cckf4TsHAuw" rel="noopener ugc nofollow" target="_blank">修改后的来源</a></p></figure><h2 id="6f5f" class="ne lu iq bd lv nf ng dn lz nh ni dp md lg nj nk mf lk nl nm mh lo nn no mj np bi translated">实时网络摄像头视频</h2><p id="05ee" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">现在，我们可以使用电脑上的网络摄像头实时检测物体。</p><p id="a617" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这一部分并没有看起来那么难，我们只需要在一个循环中插入我们用于一个图像的代码:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2cb4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后我们得到:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/181c0eeb041fef875b103cdc6366164b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*RBAfSYHuSTJHpsx-rx9wrA.gif"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者GIF</p></figure><p id="0bbd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们使用open cv中的VideoCapture从计算机网络摄像头加载视频。然后，我们对静态图像进行了同样的处理，并预测了标签和位置。主要区别在于图像输入是连续的，所以我们在while循环中插入了代码。</p><p id="f979" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">所有使用的代码和笔记本都在这个库中:</p><div class="nw nx gp gr ny nz"><a href="https://github.com/gabrielcassimiro17/raspberry-pi-tensorflow" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">gabrielcassimiro 17/树莓-pi-tensorflow</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">在GitHub上创建一个帐户，为gabrielcassimiro 17/raspberry-pi-tensor flow的开发做出贡献。</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on kq nz"/></div></div></a></div><p id="a0f8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在不久的将来，我会将它加载到一个raspberry pi中，使用一个能够检测对象的模型来创建一些交互，并将结果发布在这里。</p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="45ad" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你喜欢内容，想支持我，可以给我买杯咖啡:</p><div class="nw nx gp gr ny nz"><a href="https://www.buymeacoffee.com/cassimiro" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">Gabriel Cassimiro是一名数据科学家，他向社区分享免费内容</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">嘿👋我刚刚在这里创建了一个页面。你现在可以给我买杯咖啡了！</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">www.buymeacoffee.com</p></div></div></div></a></div></div></div>    
</body>
</html>