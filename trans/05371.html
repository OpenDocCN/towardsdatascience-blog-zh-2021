<html>
<head>
<title>How to access Google Sheets from Python using Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Pandas从Python访问Google Sheets</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-access-google-sheets-from-python-using-pandas-fe7669b73986?source=collection_archive---------11-----------------------#2021-05-12">https://towardsdatascience.com/how-to-access-google-sheets-from-python-using-pandas-fe7669b73986?source=collection_archive---------11-----------------------#2021-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c8c8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们看看如何在不使用奇怪的集成的情况下从Python访问Google Sheets</h2></div><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/c5d0b82bb1d147b05c16337547d0b6c0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*qs5F5eXIBzC_viayvYSsJQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="c1df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Google Sheets是一个非常强大的(免费的)创建电子表格的工具。我几乎已经用工作表取代了LibreOffice Calc，因为它使用起来非常舒适。有时，数据科学家不得不将一些数据从Google工作表中提取到Python笔记本中。在这篇文章中，我将向你展示如何用熊猫来做这件事。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="bd81" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先要做的是创建一个Google Sheet。对于本例，它将只包含2列，其中一列(年龄)缺少一个值。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/c5d0b82bb1d147b05c16337547d0b6c0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*qs5F5eXIBzC_viayvYSsJQ.png"/></div></figure><p id="537a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我们将要使用的数据集。</p><p id="75a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们必须让它在互联网上可见。为此，我们只需进入文件-&gt;发布到web。</p><p id="bf23" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们选择“Microsoft Excel(。xlsx)”并使窗口看起来像这样:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/b52b7d64636da6f7ddc76a6cbd2a9e28.png" data-original-src="https://miro.medium.com/v2/format:webp/1*CNxdAOols5utM7ZfIGpyDw.png"/></div></figure><p id="65d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我们点击“发布”时，我们将能够复制如下所示的URL:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/26ecdefcca37103bf0903228e2499a9f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*apm4S2QphJb8VewYgZlPVw.png"/></div></figure><p id="24ad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是Google Sheet创建的URL，使我们的工作表可以以Excel格式下载。</p><p id="5e95" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在可以转移到像Google Colaboratory这样的Python终端，并使用Pandas库来获取工作表的内容。我们可以简单地使用URL作为Pandas的<em class="lx"> read_excel </em>函数的第一个参数的值。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/8ae299df8b89cf3bcbb406559b43380e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HTzMEOxbwFFu-yo7H0Ar2Q.png"/></div></figure><p id="3cab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是结果</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/d3ba9bab981c390859f8d80e4ec7865f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*9rcVgUrwovG26BcvUtfcTw.png"/></div></figure><p id="4aca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如您所见，数据已经正确地注入到我们的数据框架中。我们还有一个与丢失值相关的NaN。我们不需要担心数据类型，因为它们是直接从excel格式中读取的。</p><p id="6a31" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了特定的论点，我们可以阅读特定的表，跳过一些行和其他东西。</p><p id="436d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过这种简单的方式，我们可以直接从Python连接到Google Sheet，而无需使用特定的API集成。很明显，Google Sheet生成的URL将工作表公开，所以当你把它给任何人时都要小心。</p></div></div>    
</body>
</html>