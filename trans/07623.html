<html>
<head>
<title>Building an Emotion Detection Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建情绪检测应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-an-emotion-detection-application-54697de9ae01?source=collection_archive---------32-----------------------#2021-07-12">https://towardsdatascience.com/building-an-emotion-detection-application-54697de9ae01?source=collection_archive---------32-----------------------#2021-07-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6b91" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用AWS Rekognition用不到50行Python代码构建计算机视觉项目</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8eea66a811a07c15b3c7bfb7a648e6b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yuKjzBxeE-6-MWJK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://unsplash.com/photos/muS2RraYRuQ" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="ea67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">计算机视觉(CV)可能是一个非常理论化和紧张的领域，需要大量的ML和数学知识来解开和理解为对象检测、面部识别和对象跟踪等主题提供动力的算法。如果你在理论上没有必要的经验，或者没有时间来构建一个定制的ML/CV模型，<a class="ae ky" href="https://aws.amazon.com/rekognition/?blog-cards.sort-by=item.additionalFields.createdDate&amp;blog-cards.sort-order=desc" rel="noopener ugc nofollow" target="_blank"> AWS Rekognition </a>可以让你通过API调用来构建强大的CV应用。AWS Rekognition是AWS提供的众多自动人工智能服务之一。这些服务是为那些<strong class="lb iu">在<strong class="lb iu"> ML </strong>中没有</strong>太多<strong class="lb iu">背景</strong>的开发人员，或者时间<strong class="lb iu">少的数据科学家</strong>快速构建强大的ML应用程序，或者<strong class="lb iu">根据你可能正在开发的</strong>定制模型进行性能基准测试。AWS Rekognition是AWS上用于计算机视觉的事实上的自动人工智能服务。如果您对构建定制模型感兴趣，请查看关于如何在那里部署定制TensorFlow模型的<a class="ae ky" href="https://aws.amazon.com/sagemaker/" rel="noopener ugc nofollow" target="_blank"> AWS SageMaker </a>和我的<a class="ae ky" rel="noopener" target="_blank" href="/training-and-deploying-custom-tensorflow-models-with-aws-sagemaker-72027722ad76">文章</a>。对于本文，我们将构建一个<a class="ae ky" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>应用程序，它接受一幅图像，并使用Rekognition返回图像中检测到的主要情感。</p><p id="9936" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong>:对于AWS的新手来说(有一些经验来完全理解这篇文章是很好的)，如果你想继续下去，请确保在下面的<a class="ae ky" href="https://aws.amazon.com/console/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">链接</strong> </a>中做一个记录。我还将提供一个我们将使用的服务列表，以及更深入的定义。如果您已经熟悉了这些服务，可以直接跳到代码演示。</p><h1 id="032e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">目录</h1><ol class=""><li id="0f49" class="mn mo it lb b lc mp lf mq li mr lm ms lq mt lu mu mv mw mx bi translated">AWS服务</li><li id="852e" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">设置简化应用程序</li><li id="ba98" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">集成认知</li><li id="1724" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">整个代码和结论</li></ol><h1 id="ea04" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">AWS服务</h1><p id="bac9" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated"><a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/rekognition.html#Rekognition.Client.detect_faces" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">AWS Rekognition</strong></a>:AWS主要的Auto-AI计算机视觉服务。有大量的功能，从人脸检测，文本检测，到物体跟踪。</p><p id="6546" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> AWS S3 </strong> </a>:亚马逊的主要存储服务，我们将使用该服务来存储我们的<strong class="lb iu">训练数据</strong>和<strong class="lb iu">模型工件</strong>/信息。</p><p id="467e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Boto3 </strong> </a>:针对Python开发者的AWS软件开发包(<strong class="lb iu"> SDK </strong>)，可以用这个来配合AWS服务。在这个用例中，我们将使用Boto3与S3一起访问我们的图像并调用Rekognition。</p><p id="c060" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://aws.amazon.com/iam/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">身份访问和管理(IAM) </strong> </a>:通过权限和角色管理AWS服务的访问。在使用我的代码时，您可能希望通过AWS CLI对用户进行身份验证。这里有一篇<a class="ae ky" href="https://blog.gruntwork.io/authenticating-to-aws-with-the-credentials-file-d16c0fbcbf9e" rel="noopener ugc nofollow" target="_blank">文章</a>详细介绍了设置过程，如果你需要帮助的话。</p><h1 id="e878" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置简化应用程序</h1><p id="4ca7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在我们开始处理Rekognition部分之前，我们需要设置我们的web应用程序。我们希望我们的应用程序能够<strong class="lb iu">上传</strong>一个<strong class="lb iu">文件</strong>，然后我们可以使用Rekognition在后端处理它。Streamlit有一个简洁的文件上传特性，我们可以在这个用例中使用。我已经为<strong class="lb iu">样本图像</strong>创建了一个小的<strong class="lb iu">目录</strong>，我们可以调用它进行分析。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将文件上传到S3</p></figure><p id="9d3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从样本图像目录中捕获文件。然后，我们使用Boto3与S3合作，将我们的本地图像存储在我们创建的S3存储桶中。要创建S3存储桶，您可以转到AWS控制台手动创建，或者如果您有<a class="ae ky" href="https://aws.amazon.com/cli/" rel="noopener ugc nofollow" target="_blank"> AWS CLI </a>设置，您可以简单地运行<strong class="lb iu">AWS MB unique-bucket-name</strong>来创建您的存储桶。我们需要我们在S3的数据，因为<strong class="lb iu"> Rekognition </strong>直接<strong class="lb iu">与S3 </strong>集成，用于其API调用，从而将我们的图像上传到S3的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/605ad84d7868a165a5bb0e2f4060d4c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r0zaYwaB308WI0HfCsWtaw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文件上传到S3(作者截图)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/b20fca9c6ad721911264874122cd9e69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gSpVGmudyADtvrl9-U6Dfw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Streamlit应用程序设置(作者截图)</p></figure><p id="364d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在有了一个Streamlit应用程序集，可以接受图像并将其推送到S3，以便与Rekognition一起使用。</p><h1 id="61f0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">集成认知</h1><p id="e172" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们现在可以专注于对样本图像进行情感检测。Rekognition在<a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/rekognition.html#Rekognition.Client.detect_faces" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> detect_faces </strong> </a>中有一个API调用，它获取输入图像并返回各种参数，例如:年龄范围、性别、眼睛睁开情况、情绪等等。出于这一应用的目的，我们将关注于<strong class="lb iu">情绪参数</strong>。我们首先需要为Rekognition创建一个boto3客户端，就像我们对S3所做的那样。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">识别客户端</p></figure><p id="5941" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在有了客户机，现在可以向detect_faces API调用输入适当的数据了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">重新确认API调用</p></figure><p id="039d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经得到了API响应，我们希望解析输出，将注意力集中在面部表情上。我们为演示上传的示例图像如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9a742065116bd485088257fb2f8da74c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xKJeEBp-nHZOTRVK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://unsplash.com/photos/IF9TK5Uy-KI" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="4769" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在解析响应，以显示检测到的多数情绪和所有其他情绪，以及Rekognition在该情绪中的<strong class="lb iu">置信度</strong>得分。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">解析Rekognition输出</p></figure><p id="aa89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果我们使用<strong class="lb iu">streamlit run filename . py</strong>运行我们的streamlit应用程序，我们应该会看到我们的应用程序成功运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/5f185866aadf43a90ba37e39b42fb826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t51oGFjkIVrIExRVABW_Mg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示重新识别结果(作者截图)</p></figure><p id="20c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到大多数情绪以及Rekognition检测到的所有情绪，为了清理UI，您还可以添加一个CV库，如<a class="ae ky" href="https://pypi.org/project/Pillow/" rel="noopener ugc nofollow" target="_blank"> PIL </a>来显示您正在上传的样本图像或文件。</p><h1 id="3d0f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">整个代码和结论</h1><div class="nl nm gp gr nn no"><a href="https://github.com/RamVegiraju/MoodDetectionApp" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">RamVegiraju/MoodDetectionApp</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">AWS识别的情绪检测。通过在…上创建帐户，为RamVegiraju/MoodDetectionApp开发做出贡献</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc ks no"/></div></div></a></div><p id="52a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要访问该项目的完整代码，请单击上方的链接<strong class="lb iu">。Auto-AI正在快速扩张，AWS、Azure和GCP等云提供商也在增长，并提供各种尖端服务，如Rekognition，使您能够以简单的方式使用ML来支持应用程序。对于数据科学家和那些没有ML背景的人来说，Rekognition对于快速启动和运行计算机视觉应用程序非常有用。在这些<a class="ae ky" href="https://aws.amazon.com/blogs/machine-learning/tag/amazon-rekognition/" rel="noopener ugc nofollow" target="_blank">博客</a>中查看一些更酷的AWS重新识别用例。</strong></p><p id="f6a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对那些从事计算机视觉项目或探索AWS的人有用。请随时在LinkedIn上与我联系，或者在T2媒体上关注我，了解我更多的写作内容。分享任何想法或反馈，谢谢阅读！</p></div></div>    
</body>
</html>