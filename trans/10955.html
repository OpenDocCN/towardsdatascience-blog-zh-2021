<html>
<head>
<title>Simply Spline Regression: Polynomials between Knots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单样条回归:节点间的多项式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simply-spline-regression-polynomials-between-knots-3d007523ad99?source=collection_archive---------21-----------------------#2021-10-25">https://towardsdatascience.com/simply-spline-regression-polynomials-between-knots-3d007523ad99?source=collection_archive---------21-----------------------#2021-10-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5d38" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用python的statsmodels库</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/4c00b40eb353807d4064b55f9a10c9f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJ2JHOH9loUnUax9ZkagHw.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://unsplash.com/photos/1Q6gfwHc5GI" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><blockquote class="la lb lc"><p id="248d" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">简介</strong></p></blockquote><p id="bcc4" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">线性和多项式回归有一些很大的优点，也有一些缺点。线性回归非常简单且易于实施，而多项式回归则需要更高阶的多项式来拟合数据。多项式回归有一个基本的局限性，它导致一些数据拟合向样条拟合发展。样条回归比多项式回归更复杂，但是这里我将使用statsmodels库演示python中的样条回归实现。</p><p id="a468" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">多项式回归可能在局部数据中过度拟合，因此，如果过度拟合，在预测未来趋势时会产生误导。此外，多项式回归线由样本中的每个数据点全局控制。一个单独的数据点可以剧烈地移动多项式曲线。异常值会改变曲线，因此在进行多项式拟合之前从数据中移除异常值非常重要。我还有一篇关于如何去除异常值的文章。</p><div class="md me gq gs mf mg"><a rel="noopener follow" target="_blank" href="/practical-implementation-of-outlier-detection-in-python-90680453b3ce"><div class="mh ab fp"><div class="mi ab mj cl cj mk"><h2 class="bd iv gz z fq ml fs ft mm fv fx it bi translated">异常检测在python中的实际实现</h2><div class="mn l"><h3 class="bd b gz z fq ml fs ft mm fv fx dk translated">IQR、汉佩尔和DBSCAN法</h3></div><div class="mo l"><p class="bd b dl z fq ml fs ft mm fv fx dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu kt mg"/></div></div></a></div><blockquote class="la lb lc"><p id="e385" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">花键</strong></p></blockquote><p id="1f47" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">样条只是整个多项式线的一部分。线被分成几个结，其中每两个结由用户确定的多项式线连接。这基本上消除了单个数据点对全局多项式曲线的影响。</p><blockquote class="la lb lc"><p id="0cb1" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">python实现</strong></p></blockquote><p id="cc9e" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在这个简单的代码中，我将展示样条曲线是如何形成的，以及如何控制这些曲线来获得用户定义的输出。让我们用正弦波创建一个虚拟数据集，如下所示。我将用多条样条曲线来拟合这些数据，而不是单一的多项式曲线。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mv"><img src="../Images/f6bc81293b96a803f0ede7e25455f30e.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*ubXIkffnjxf9xFPzeKuG-A.png"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mw mx l"/></div></figure><p id="0459" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我将把这些数据放在一个panda dataframe中，这样我就可以在模型中使用它们作为列。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj my"><img src="../Images/154eab67efd274f3a8f57fca46c85d0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7YAWGdQmpLQ-jH5-EkOUA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="9925" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我将使用下面的块实现statsmodels样条回归。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mw mx l"/></div></figure><p id="cf83" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">这里，基函数采用用户定义的自由度和节点间多项式的次数。然后，将公式输入到模型中。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mz"><img src="../Images/a74dad3af12de7ab347cf01ef5144b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rfyhY80lM2Z71THwFro18w.png"/></div></div></figure><p id="5cea" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">拟合的R平方值显示了遵循趋势的样条的强度。R平方值越高，模型拟合越好。显然还有一些其他的因素，比如同质性，但这超出了本文的范围。下面的文章就是为了讨论这个话题而写的。</p><div class="md me gq gs mf mg"><a rel="noopener follow" target="_blank" href="/heteroscedasticity-in-regression-model-21d9f5a93e59"><div class="mh ab fp"><div class="mi ab mj cl cj mk"><h2 class="bd iv gz z fq ml fs ft mm fv fx it bi translated">回归模型中的异方差性</h2><div class="mn l"><h3 class="bd b gz z fq ml fs ft mm fv fx dk translated">使用统计模型检查异方差性</h3></div><div class="mo l"><p class="bd b dl z fq ml fs ft mm fv fx dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="na l mr ms mt mp mu kt mg"/></div></div></a></div><p id="e4b1" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">如果df = 1，degree = 1，本质上将是一个线性回归模型。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/adfbdcdc61efa8b00628c8d32e426e1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*rHpXjqKmgteO-ZrpiC4GJA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">df = 1，度数= 1</p></figure><p id="0c51" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">将df更改为2将导致以下拟合。很明显，有两条线有三个结。连接线的顺序仍然是1，因此，在结之间仍然是线性的。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/d748ddb430cbca7ff3b08a68a6f3d8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*3likVEWszwZ_3gLDlkhjFA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">df = 2，度数= 1</p></figure><p id="0386" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">将df保持在2，并将degree改为2将导致这种情况。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/ec314136710caebcad276b7bec0001ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*j-ChSPGZEfHffRHLyxNDRg.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">df = 2，度数= 2</p></figure><p id="25c3" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">现在我们有所收获了。曲线变得更加多项式化，但它离正弦波的良好拟合还差得很远。让我们把df增加到3，degree增加到3。每当阶数为3时，回归就变成三次样条回归，这是许多分析的默认设置。通常需要25、50和75个百分点来拟合数据。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/856e1e0259bd6489d2f80efe5779ffa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*tvwb6mGfHlPuaJxtnB_0VQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">df = 3，度数= 3</p></figure><p id="8bb6" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我们正在到达那里。该曲线有4个节点(包括端点),在这些节点之间拟合了三次多项式。如果我们将degree放回1(线性),这一点会更加明显，如下所示。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/3937da04df09fea0b4757b6ea26a5719.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*TR-COozds3UEMQ9GjCcwQA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">df = 3，度数= 1</p></figure><p id="4840" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">当df =8和degree = 3时，它变得更符合实际。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/204cd856c04c028b3c7d53f3215a784b.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*xL0f1A4CU-EncXChxfpCPw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">df = 8，度数= 3</p></figure><blockquote class="la lb lc"><p id="f039" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">结论</strong></p></blockquote><p id="6282" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">样条回归不像多项式回归那样具有单个数据点的全局影响的缺点。样条回归中的基本数学更为复杂，其中的结由三次样条或用户定义的结确定。它还消除了由于过度拟合而从多项式回归中产生的不期望的摆动。</p><p id="5758" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><strong class="lg iv">参考</strong> : <a class="ae kz" href="https://github.com/gedeck/practical-statistics-for-data-scientists/blob/master/python/code/Chapter%204%20-%20Regression%20and%20Prediction.py" rel="noopener ugc nofollow" target="_blank"> github功能</a></p><p id="7867" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/10/24/Spline-Regression.html" rel="noopener ugc nofollow" target="_blank"> Github页面</a></p></div></div>    
</body>
</html>