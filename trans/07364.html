<html>
<head>
<title>The Intuition behind the Assumptions of Linear Regression Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归算法假设背后的直觉</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-regression-assumptions-why-is-it-important-af28438a44a1?source=collection_archive---------0-----------------------#2021-07-05">https://towardsdatascience.com/linear-regression-assumptions-why-is-it-important-af28438a44a1?source=collection_archive---------0-----------------------#2021-07-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3a21" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">建立线性回归模型只是第一步。在我们对模型估计做出推论或使用模型进行预测之前，应该满足某些条件。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/07e15800781f4d0f20a59be6be7597ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5FdvR2fZQPd9yhYa"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">达斯汀·格罗在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="0766" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">线性回归模型应针对所有模型假设进行验证，包括函数形式的定义。如果假设被违反，我们需要重新审视模型。</p><p id="d2d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将解释线性回归的关键假设，为什么它很重要，以及我们如何使用Python来验证它。我还会谈到在假设不满足的情况下的补救措施。</p><h1 id="8b15" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">线性回归的假设:</h1><p id="4a2f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir">假设1 </strong></p><p id="7941" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回归的函数形式是正确指定的，即参数(自变量)的系数和因变量y之间存在线性关系</p><p id="ca23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">假设2 </strong></p><p id="3cab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">残差呈正态分布。</p><p id="a060" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">假设3 </strong></p><p id="7d6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">残差的方差在自变量x的所有值上都是恒定的(也称为“同方差”)。</p><p id="b329" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">假设4 </strong></p><p id="5312" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">误差之间没有自相关。</p><p id="91c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">假设5 </strong></p><p id="b037" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">自变量之间没有(低)相关性(也称为‘多重共线性’)。</p><p id="a231" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">让我们详细了解这些假设。</strong></p><h1 id="4724" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">假设1:回归的函数形式是正确指定的。</h1><p id="d388" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">线性回归算法假设自变量和因变量y的参数之间存在线性关系。如果真实的关系不是线性的，我们就不能使用该模型，因为精度会显著降低。</p><p id="8211" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，验证这一假设变得很重要。这通过绘制<strong class="ky ir">残差图</strong>来完成。</p><p id="3d37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在只有一个独立变量的简单线性回归模型的情况下，我们绘制残差对预测值，即误差对预测值X1。在多元线性回归的情况下，我们有一个以上的预测值，我们绘制残差和预测值或拟合值ŷ。</p><p id="b62c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">残差图不应显示任何模式，即残差应随机分布在水平轴周围。如果存在模式，我们可以推断线性模型的某些方面存在问题，即使用了不正确的函数形式。这也被称为'<strong class="ky ir">模型- </strong> <strong class="ky ir">设定错误</strong>。</p><p id="1346" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在非线性关联的情况下，我们可以在回归模型中使用预测值的非线性变换，例如log X，X，sqrt(X)。</p><p id="6076" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">非线性关联的残差图示例如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/a2ac417968713fead224bde108d54133.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*OVN_1AKQfNzXOlRvY6-SvQ.png"/></div></figure><p id="21da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">用Python绘制剩余图:</strong></p><p id="ffcf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将残差计算为:</p><p id="f16d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">残差= y _测试-y _预测</p><p id="323f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单地绘制残差和预测y值的散点图。代码如下所示:<br/>导入matplotlib.pyplot为plt <br/> plt.scatter(y_pred，residuals)</p><h1 id="c0ed" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">假设2:残差呈正态分布</h1><p id="f762" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">线性回归模型的建立有两个非常重要的步骤——估计和假设检验。使用普通的最小二乘法(OLS)，我们能够估计参数β1、β2等。这些参数的值会随着样本的不同而变化，因此我们可以说这些估计量是随机变量。</p><p id="13cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦我们完成了估计，我们需要做假设检验来对总体做出推断。因此，我们想知道beta hat(估计beta)与真实beta有多接近，或者beta hat的方差与真实方差有多接近。</p><p id="a3aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们需要找出它们的概率分布，没有它，我们就不能得到它们的真实值。</p><p id="a878" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用OLS，我们得到<strong class="ky ir">βhat =∑(ki∫Yi)</strong>其中ki = Xi / ∑(Xi)</p><p id="01ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里i= 1，2，3，4，....观察</p><p id="831d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里X是非随机的，Ki是常数。因此，hat(估计的β)是Yi的线性函数。</p><p id="d9b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以将上面的等式写成:</p><p id="a1b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">β2 hat =∑ki *(β1+β2∫Xi+ui)</strong>，自Yi = β1 + β2 * Xi +误差(ui)</p><p id="fab3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于k，X是常数，β2 hat最终是随机变量ui的线性函数。因此，β的概率分布将取决于关于误差项或剩余项ui的概率分布的假设。</p><p id="62d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于OLS估计量的概率分布是推断其总体值所必需的，因此残差的分布在假设检验中起着重要的作用。</p><p id="9cee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">为什么是正态分布？</strong></p><p id="4833" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">误差是模型中不包括的一个或多个独立变量的综合影响。中心极限定理指出，如果有大量独立同分布的随机变量，那么它们之和的分布随着变量数量的增加而趋于正态分布。<strong class="ky ir">因此，CLT从理论上解释了假设误差为“正态分布”的原因。</strong></p><p id="06b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于正态分布变量的任何线性函数本身都是正态分布的，作出这一假设使我们能够导出OLS估计量的概率分布。因此，OLS估计量也是正态分布的。它进一步允许我们使用t和F检验进行假设检验。</p><p id="198f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们如何确定误差是否正态分布？</p><p id="b042" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">检查误差是否呈正态分布的最简单方法是使用P-P(概率-概率)图。</p><p id="d4dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">P-P图评估理论分布对给定数据分布的模拟程度。残差的正态概率图是一个散点图，x轴表示正态分布的理论百分位数，y轴表示残差的样本百分位数。</p><p id="a050" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比较线是45度对角线。穿过理论分布的上下百分位数的对角线提供了直观的帮助，以帮助评估理论和样本百分位数之间的关系是否是线性的。当且仅当图落在这条线上时，分布才相等。与这条线的任何偏离都表明两个分布之间的差异</p><p id="1c23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是一个误差分布不正常的P-P图的例子</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/032d3b017be81e595495bd0e7b02c598.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*dQw6oYmJ3trMaJUoQ1imTg.png"/></div></figure><p id="4bf3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是P-P图，其中误差分布为<strong class="ky ir">近似</strong>正态</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/561f1c55177286a87cc8974fae425caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*I0YZl4X1Y7PWQqYstvlo4Q.png"/></div></figure><p id="d116" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">用Python绘制P-P图:</strong></p><p id="9e1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行上面的代码得到以下输出:<br/>normality _ plot = sm . QQ plot(residual，line = 'r ')</p><p id="09bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了P-P图之外，检查误差正态性的更具统计学意义的方法是进行<strong class="ky ir">安德森达林测试</strong>。</p><p id="1343" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">检验误差正态性的安德森-达林试验</strong></p><p id="6e4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Anderson Darling统计测量数据遵循特定分布的程度。对于给定的数据集及其分布，数据越符合分布，统计量就越小。<br/>检验的无效假设和替代假设如下:</p><p id="8c31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ms">零假设</em> <em class="ms"> Ho </em>:数据遵循指定的分布</p><p id="f287" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ms">替代假设Ha </em>:数据不符合规定的分布</p><p id="188c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果p值小于选择的α(0.05或0.10)，我们拒绝数据来自特定分布的零假设</p><p id="7b4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">安德森达林测试的Python代码:</strong></p><p id="1b29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来自scipy import stats<br/>Anderson _ results = stats . Anderson(model . resid，dist='norm ')</p><h1 id="1ed8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">假设3:对于自变量X的所有值，误差的方差是常数</h1><p id="6099" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">同方差假设(<em class="ms"> homo </em> — <strong class="ky ir">相等，</strong> <em class="ms">同方差</em> — <strong class="ky ir"> spread </strong>)陈述了对应于不同X值的y总体具有相同的方差，即它不随着X的增加而增加也不减少。</p><p id="253d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">异方差是指方差不相等，即y群体的方差随x而变化。</p><p id="152b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">非常数方差的原因是什么？</strong></p><p id="b468" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于异方差最流行的一个例子是储蓄和收入数据。随着收入的增长，人们有更多的可自由支配收入，因此在收入分配上有更多的选择。因此，回归收入储蓄可能会发现更高的方差，因为收入增加会导致人们在储蓄决策方面有更多的选择。</p><p id="e85c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">异方差的其他原因包括异常值的存在、重要变量的遗漏、不正确的数据转换或不正确的方程函数形式。</p><p id="9e39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">异方差如何影响OLS估计？</p><p id="4523" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果线性回归的所有假设都满足，OLS估计提供β的最佳线性无偏估计(蓝色)。</p><p id="8233" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">蓝色</strong>是什么意思？这意味着OLS方法给出的估计值是:</p><p id="4c4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">线性:</strong></p><p id="8ebd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它是回归模型因变量Y的线性函数</p><p id="5b2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">无偏:</strong></p><p id="5f3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它的期望值或平均值等于真实值</p><p id="b5c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">高效:</strong></p><p id="0d8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它的方差最小。方差最小的无偏估计量称为有效估计量。</p><p id="8976" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果线性回归的所有假设都满足，OLS给我们最好的线性无偏估计。</p><p id="5759" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，如果放松同方差的假设，β估计仍然是线性的和无偏的，但是它们不是有效的/最佳的。为什么？因为，现在估计的β不会有最小方差。</p><p id="c5ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们试着更好地理解它。用来解释异方差的最常见的例子是单因素线性回归模型，其中储蓄作为因变量，收入作为解释变量。如上图所示，当收入较低时，储蓄的差异也较低。随着收入的增加，可支配收入也增加，这给了个人更多的储蓄选择。因此，随着收入的增加，储蓄的差异也会增加。从上图中可以明显看出这一点。在同方差数据中，所有观测值的方差是一致的，等于(σ)。对于异方差数据，方差等于(sigma(i))，其中i=1，2，3，…观察结果。</p><p id="6fad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">理想情况下，您希望以这样一种方式进行估计，即与来自变异性较高的人群的观察值相比，来自变异性较低的人群的观察值具有更大的权重，因为这将使我们能够更准确地估计人群回归函数。想法是给与较高方差相关的观察值小的权重，以缩小它们的残差平方。</p><p id="5e02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，OLS并不根据观测值对残差平方和(RSS)的贡献来改变观测值的权重。它对所有的观察都给予同等的重视。因此，当RSS被最小化以计算估计值时，具有较高方差的观测值将在等式中具有较大的拉力。因此，使用OLS估计异方差数据的β将不再具有最小方差。</p><p id="9aac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，用异方差数据估计的β将具有较高的方差，从而具有较高的标准误差。</p><p id="5146" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们知道t-stats = beta hat/beta hat的标准差。</p><p id="7e71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">beta的标准误差越高，t-stats值越低。这进一步导致更高的p值，并且犯第二类错误的机会也增加。<strong class="ky ir">也就是说，当p值较高时，重要的变量被推断为不重要。</strong></p><p id="30d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它还影响置信区间、T检验、f检验和其他假设检验。因此，检测异方差并提供补救措施是非常关键的</p><p id="c73f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我们如何检测异方差:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/a2e163047c260b96726743ffbdead7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*mGpXMpGdDqZUhQmprrHu8A.png"/></div></figure><p id="99c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">异方差在残差图中产生独特的扇形或锥形。</strong>要检查异方差性，您需要在多元线性回归的情况下通过拟合值图评估残差，在简单线性回归的情况下评估残差与解释变量的关系。通常，异方差的模式是随着拟合值的增加，残差的方差也增加。</p><p id="44ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了上述图之外，还进行了某些统计测试来确认异方差性。其中之一是对正态分布数据的Breusch-Pagan检验。</p><p id="4b6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Breusch异教异方差检验:</strong></p><p id="da66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ms">零假设</em> <em class="ms"> Ho </em> —误差方差相等(异方差)<br/> <em class="ms">交替假设Ha </em> —误差方差不相等(异方差)</p><p id="3fc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码给出了假设检验的p值。这里X是独立变量的列表</p><p id="ce16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从statsmodels.stats.diagnostic导入het _ breuschpagan<br/>bptest = het _ breuschpagan(model 3 . resid，X)[1]<br/>print(' Breuchpagen测试的p值为'，BP test)</p><p id="1533" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果p值小于0.05，我们拒绝零假设。因此，我们拒绝误差方差相等的零假设。</p><p id="e313" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">异方差的补救措施</strong></p><p id="dfa4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">处理异方差的一种方法是使用凹函数(如log Y或sqrt Y)转换响应变量Y。这种转换会导致较大响应的收缩量更大，从而降低异方差。</p><h1 id="4b6a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">假设4:独立变量之间没有(少)多重共线性</h1><p id="6574" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">多重共线性出现在两个或多个解释变量彼此密切相关的多元回归模型中。</p><p id="8eb3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这可能会造成问题，因为很难区分相关变量对响应变量的单独影响，即确定每个变量如何分别与响应变量相关联。</p><p id="ccc3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么我们假设自变量之间不存在多重共线性？</p><p id="8997" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当X1变化一个单位时，β给出响应变量y的变化率，保持所有其他x不变。当独立变量X1和X2之间高度相关时，不可能保持X2不变，因为它会随着X1的变化而变化。对于具有多重共线性的数据，Betas将采用多个值，并且回归系数没有唯一的解决方案。因此，在高度多重共线性的情况下，β估计是不确定的，标准误差是无限的。</p><p id="38d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">如果自变量的数量小于或刚好等于观测值的数量，多重共线性是一个更严重的问题。</strong></p><p id="af30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">多重共线性如何影响回归模型中的估计和假设检验？</strong></p><p id="5b9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">OLS估计量将具有较大的方差和协方差，使得估计变得困难。因此，置信区间要宽得多，导致零零假设的接受，从而导致2型误差。</p><p id="2887" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于估计的标准误差较高，t stats = beta hat/(beta hat的标准误差)变小。因此，多重共线性导致不显著的t比率。</p><p id="b082" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在多重共线性的情况下，估计的betas对数据的微小变化都非常敏感。</p><p id="3230" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我们如何检查多重共线性:</strong></p><ol class=""><li id="837a" class="mt mu iq ky b kz la lc ld lf mv lj mw ln mx lr my mz na nb bi translated"><strong class="ky ir">散点图</strong></li></ol><p id="27a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">人们可以用散点图来检查自变量之间的相关性。从散点图中很容易看出高度的相关性。如果点位于对角线上或接近对角线，我们可以推断两个变量之间的高度相关性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/d245aef116d4c1fe20fe12e31dab8d2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*a-QexAqyh9LAbwHGxV61jw.png"/></div></figure><p id="db27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.<strong class="ky ir">方差膨胀因子</strong></p><p id="b580" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">方差膨胀因子或VIF用作多重共线性的指标。VIF值越大，该变量与其他回归变量的相关性越强。VIF显示了由于多重共线性的存在，变量的方差被夸大了多少。随着共线性程度的增加，VIF也会增加。如果两个变量之间没有共线性，VIF将为1。</p><p id="f99c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它是通过获取一个预测值并将其与模型中的其他预测值进行回归计算而得。这给出了R值，然后用于VIF公式。通常，VIF大于10的变量被认为是有问题的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/7f4939755a9e7d554a88e29e32e3893a.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*kXpK27JR1xPw-SpFFdtAEw.png"/></div></figure><p id="234a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">用于检查VIF的Python代码:</strong></p><p id="b3b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来自stats models . stats . outliers _ impact导入方差_通货膨胀_因子</p><p id="37e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">def get _ Vif _ factors(X):<br/>X _ matrix = X . values<br/>Vif =[variance _ inflation _ factor(X _ matrix，I)for I in range(X _ matrix . shape[1])]<br/>Vif _ factors = PD。data frame()<br/>vif_factors[' column ']= x . columns<br/>Vif _ factors[' VIF ']= Vif<br/>返回Vif _ factors</p><p id="551b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Vif _ factor = get _ Vif _ factors(X _ train))<br/>Vif _ factors</p><p id="5f06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">多重共线性的补救措施</strong></p><ul class=""><li id="49ed" class="mt mu iq ky b kz la lc ld lf mv lj mw ln mx lr ne mz na nb bi translated">删除具有高VIF的变量</li><li id="93f7" class="mt mu iq ky b kz nf lc ng lf nh lj ni ln nj lr ne mz na nb bi translated">使用主成分分析(PCA)得出不相关的变量</li></ul><h1 id="12cd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">假设5:没有误差的自相关</h1><p id="dd32" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">线性回归模型假设误差项是独立的。这意味着一个观测值的误差项不受另一个观测值的误差项的影响。如果不是这样，则称为<strong class="ky ir">自相关</strong>。</p><p id="3c8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一般在时间序列数据中观察到。时间序列数据由在离散时间点收集的观测数据组成。通常，相邻时间间隔的观测值会有相关误差。</p><p id="3e36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">自相关的存在如何影响OLS估计？</strong></p><p id="74fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">估计的标准误差往往低估了真实的标准误差。因此相关的p值较低。这导致一个结论，即一个变量是重要的，即使它不是。置信区间和预测区间比它们应有的范围要窄。</p><p id="e81a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我们如何检测自相关？</strong></p><p id="8dfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">杜宾沃森测试</strong>用于检查自相关。<br/> <em class="ms">零假设Ho </em>:没有误差自相关<br/> <em class="ms">替代假设</em> Ha:有误差自相关</p><p id="b675" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Durbin Watson统计检查残差的滞后1中是否存在自相关。统计数据如下:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/4b526c294dfdd171c3c0b3bc1e920b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*21iFRZloy9iA0McHHHuaBA.png"/></div></div></figure><p id="4586" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">统计值将介于0到4之间</strong>。介于1.8和2.2之间的值表示没有自相关。小于1.8的值表示正自相关，大于2.2的值表示负自相关</p><p id="bcbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也可以查看一个散点图，一个轴上是残差，另一个轴上是时间分量。如果残差是随机分布的，就没有自相关。如果观察到特定的模式，则表明存在自相关。</p><p id="8d5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">Python中的杜宾沃森测试:</strong></p><p id="5eb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从stats models . stats . stat工具导入durbin_watson</p><p id="581e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">德宾_沃森(模型1.resid)</p><p id="4387" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">自相关补救措施</strong></p><p id="9a6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">检查自相关是否是由于模型的错误设定，即模型的函数形式不正确或一些重要变量被排除在模型之外。在这种情况下，我们需要重新审视这个模型。<br/>还可以添加因变量的滞后和/或一些自变量的滞后。</p><p id="183f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">结论:</strong></p><p id="f958" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有上述假设对于验证模型都很重要。如果违反了其中的任何一条，那么从模型中得出的预测、置信区间和科学见解都将是误导性的和有偏见的。</p><p id="4893" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望这篇文章能帮助你更深入地了解最有用的算法之一。</p><p id="15f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一些很好的参考资料，可以更好地理解这些假设。</p><ol class=""><li id="ebe3" class="mt mu iq ky b kz la lc ld lf mv lj mw ln mx lr my mz na nb bi translated">《基础计量经济学》，达摩达尔·N·古吉拉特，道恩·C·波特，马诺兰詹·帕尔</li><li id="7c98" class="mt mu iq ky b kz nf lc ng lf nh lj ni ln nj lr my mz na nb bi translated">《商业分析:数据驱动的决策科学》作者U Dinesh Kumar</li><li id="b1c2" class="mt mu iq ky b kz nf lc ng lf nh lj ni ln nj lr my mz na nb bi translated">https://statisticsbyjim.com/<a class="ae kv" href="https://statisticsbyjim.com/" rel="noopener ugc nofollow" target="_blank"/></li></ol></div></div>    
</body>
</html>