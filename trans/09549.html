<html>
<head>
<title>How to Estimate Salary with Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用线性回归估算工资</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-estimate-salary-with-linear-regression-6e5511db28f6?source=collection_archive---------5-----------------------#2021-09-05">https://towardsdatascience.com/how-to-estimate-salary-with-linear-regression-6e5511db28f6?source=collection_archive---------5-----------------------#2021-09-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="ee22" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="c126" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">使用Python进行线性回归的初学者友好指南。</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/1fd37eb0243048ac4dd284c231f4eca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qTDqjFtJ5dexi6_flshpGA.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">由<a class="ae li" href="https://unsplash.com/@alexandermils?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">亚历山大·密斯</a>在<a class="ae li" href="https://unsplash.com/s/photos/salary?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8e01" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们的工资真的随着工作年限的增长而增长吗？虽然这可以根据我们对就业市场的一般理解来回答，但我们将使用一种简单的数据驱动方法来验证这一事实。我们将使用<strong class="ll je">线性回归</strong>对工资金额与工作经验年限之间的关系进行建模。</p><p id="a627" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">线性回归是假设<a class="ae li" href="https://www.statisticshowto.com/probability-and-statistics/types-of-variables/explanatory-variable/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll je">解释变量(X)和响应变量(y) </strong> </a>之间的线性关系的模型。我们可以根据X的值预测y的值。在我们的上下文中，估计的工资将是我们的响应变量(y ),因为它是我们的目标预测值，工作经验的年数将是我们的解释变量(X)。</p><p id="34b9" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">一旦我们定义了本例中的解释变量和响应变量，我们将使用<strong class="ll je"> Python </strong>构建一个线性回归模型来解决我们的问题。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="c034" class="mm mn iu bd mo mp mq mr ms mt mu mv mw kj mx kk my km mz kn na kp nb kq nc nd bi translated">必备Python库</h1><p id="b399" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">熊猫—<a class="ae li" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/</a></p><p id="3573" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">numpy—<a class="ae li" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank">https://numpy.org/</a></p><p id="ce24" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">matplotlib—<a class="ae li" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank">https://matplotlib.org/</a></p><p id="4279" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">sci kit-learn—<a class="ae li" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/</a></p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="5549" class="mm mn iu bd mo mp mq mr ms mt mu mv mw kj mx kk my km mz kn na kp nb kq nc nd bi translated">开源代码库</h1><p id="42de" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">本文中的原始完整源代码可以在我的<a class="ae li" href="https://github.com/teobeeguan/Python-For-Machine-Learning/tree/main/Linear%20Regression" rel="noopener ugc nofollow" target="_blank"> Github Repo </a>上获得。如果你想用它来关注我的文章，请随意下载(<em class="nj"> LinearRegression.py </em>)。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="eced" class="mm mn iu bd mo mp mq mr ms mt mu mv mw kj mx kk my km mz kn na kp nb kq nc nd bi translated">数据采集</h1><p id="c5f6" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">我们将用于线性回归的薪资数据(<em class="nj"> Salary_Data.csv </em>)可以从<a class="ae li" href="https://www.kaggle.com/karthickveerakumar/salary-data-simple-linear-regression" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中获得。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="6feb" class="mm mn iu bd mo mp mq mr ms mt mu mv mw kj mx kk my km mz kn na kp nb kq nc nd bi translated">线性回归</h1><h2 id="3293" class="nk mn iu bd mo nl nm dn ms nn no dp mw ls np nq my lw nr ns na ma nt nu nc ja bi translated">1.加载数据</h2><p id="5450" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">首先，我们将使用<em class="nj"> Python Pandas </em>库来读取CSV数据。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="403c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第1–6行:</strong>导入所有需要的库。</p><p id="7aca" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第8行:</strong>使用<em class="nj">熊猫read_csv </em>函数读取csv文件。该函数将以dataframe格式返回数据。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj nx"><img src="../Images/bbeea5bf5df1c2b51032e15872c36ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*fy-o61Y7xujefMDWzHtvJQ.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者准备的图像</p></figure><p id="e082" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第9–10行:</strong>提取<em class="nj"> YearsExperience </em>和<em class="nj"> Salary </em>列，分别赋给变量X和y。</p><h2 id="109e" class="nk mn iu bd mo nl nm dn ms nn no dp mw ls np nq my lw nr ns na ma nt nu nc ja bi translated">2.将数据分成训练集和测试集</h2><p id="6186" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">在建立线性模型之前，我们需要准备一个训练集和一个测试集(机器学习工作流中标准过程的一部分)。训练集将用于训练模型，而测试集将用于评估已训练模型在预测来自未知数据的结果方面的性能。</p><p id="0b7f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们可以使用<em class="nj">Python scikit-learn train _ test _ split</em>函数将我们的数据随机分割成一个训练和测试集。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="362c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第1行:</strong>留出整个数据集的30%作为测试集，并将训练集和测试集分别赋给四个变量。</p><h2 id="2871" class="nk mn iu bd mo nl nm dn ms nn no dp mw ls np nq my lw nr ns na ma nt nu nc ja bi translated">3.数据转换</h2><p id="7504" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated"><em class="nj"> Python scikit-learn </em>只接受二维数组格式的训练和测试数据。我们必须对我们的训练集和测试集执行数据转换。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="08be" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第1–2行:</strong>使用<em class="nj"> Numpy整形函数</em>将训练集从一维序列转换为二维数组。</p><p id="64df" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第3–4行</strong>:使用<em class="nj"> Numpy reshape函数</em>将测试集从一维序列转换为二维数组。</p><h2 id="27a5" class="nk mn iu bd mo nl nm dn ms nn no dp mw ls np nq my lw nr ns na ma nt nu nc ja bi translated">4.培训模式</h2><p id="1dec" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">现在我们准备训练我们的线性模型。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="c46c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第1行:</strong>使用<em class="nj">sci kit-Learn linear regression</em>函数创建一个模型对象。</p><p id="1827" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第2行:</strong>将训练集拟合到模型。</p><h2 id="3a8d" class="nk mn iu bd mo nl nm dn ms nn no dp mw ls np nq my lw nr ns na ma nt nu nc ja bi translated">5.用线性模型预测工资</h2><p id="7001" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">在这个阶段，我们已经训练了一个线性模型，我们首先使用它来预测我们训练集的工资，以查看它与数据的拟合程度。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="ef50" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第1行:</strong>根据训练集使用线性模型预测工资。</p><p id="7df6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第3–10行:</strong>使用Matplotlib创建一个图形，以可视化预测结果。“真实值”在图表上绘制为蓝点，预测值绘制为黑色直线。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ny"><img src="../Images/e1e95b037d670b5518cf67e5fc168fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*Hhydu-_HemxOT2Ps8FWRJQ.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者准备的图像</p></figure><p id="7cd4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">一般来说，线性模型很适合训练数据。这显示了工资和工作经验之间的线性关系。</p><p id="a7e8" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">现在，我们需要检查线性模型是否可以在我们的测试集(未知数据)上表现良好。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="2a90" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第1行:</strong>根据测试集使用线性模型预测工资。</p><p id="1d11" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第3行–第10行:</strong>使用Matplotlib创建一个绘图，以可视化预测结果。“真实值”在图表上绘制为绿点，预测值绘制为黑色直线。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ny"><img src="../Images/afed17878a0dbbc4a0788112f8eabe28.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*EEa2mvLu-JfpeUs6WcV0hQ.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者准备的图像</p></figure><p id="a0b0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">该图表明，我们的线性模型可以很好地适应测试集。我们可以观察到随着工作年限的增加，工资水平呈线性增长。</p><h2 id="1719" class="nk mn iu bd mo nl nm dn ms nn no dp mw ls np nq my lw nr ns na ma nt nu nc ja bi translated">6.模型评估</h2><p id="c3ae" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">上一节使用图形方法来评估我们的线性模型的性能，这在我们的判断中有时是相当主观的。这里我们将使用一些定量方法来获得我们的线性模型的更精确的性能评估。</p><p id="6f17" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们将使用三种量化指标:</p><ul class=""><li id="88c5" class="nz oa iu ll b lm ln lp lq ls ob lw oc ma od me oe of og oh bi translated"><strong class="ll je">均方误差</strong> —真实值与预测值之差的平方的平均值。差异越小，模型的性能越好。这是用于回归分析的常用指标。</li><li id="c19f" class="nz oa iu ll b lm oi lp oj ls ok lw ol ma om me oe of og oh bi translated"><strong class="ll je">解释方差得分</strong> —一种检查模型处理数据集中值的变化情况的度量。1.0分是满分。</li><li id="5c64" class="nz oa iu ll b lm oi lp oj ls ok lw ol ma om me oe of og oh bi translated"><strong class="ll je"> R2分数</strong> —检验我们的模型基于测试集(未知样本)预测值的能力的度量。满分是1.0。</li></ul><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nv nw l"/></div></figure><p id="0009" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">第1–3行:</strong>使用<em class="nj"> Scikit-learn Metrics </em>功能计算我们的线性模型的均方误差、解释方差和R2分数。我们向函数提供真实值(测试集)和预测值。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj on"><img src="../Images/c2d1a10a5a29513df10774ce6c49bc03.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*0y4eehBe2kd_Z5atWc4m9A.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者准备的图像</p></figure><p id="b77e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果我们对我们的均方误差进行平方根计算，我们将获得大约6146.92美元的平均差异，这是一个相当低的误差。此外，解释方差得分和R2得分都达到了0.9以上。这表明我们的线性模型没有过度拟合，可以很好地根据新数据预测工资。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="1bd6" class="mm mn iu bd mo mp mq mr ms mt mu mv mw kj mx kk my km mz kn na kp nb kq nc nd bi translated">结论</h1><p id="95c1" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">我们已经设法建立了一个简单的线性模型，根据多年的工作经验来预测工资。根据我们的线性模型，<strong class="ll je">我们可以得出结论，我们的工资随着工作年限的增长而增长，它们之间存在线性关系。</strong>我们可以使用我们的线性模型，通过输入多年的经验来预测工资。</p><p id="1c5b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">虽然假设工资只取决于工作经验的年限有点太天真，但这是一个很好的例子，说明我们如何开发一个简单的线性回归模型来显示两个变量之间的关系。事实上，现实生活中的大多数现象都不能简单地用一个线性模型来解释。然而，对建立线性模型的理解是建立复杂模型的基础。</p><p id="6db6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我希望你喜欢阅读这篇文章。</p><p id="78fc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> <em class="nj">如果你喜欢我的文章，想看更多类似的文章，可以随时订阅</em> </strong> <a class="ae li" href="https://teobguan2013.medium.com/membership" rel="noopener"> <strong class="ll je"> <em class="nj">中</em> </strong> </a> <strong class="ll je"> <em class="nj">。你将能够在Medium上无限阅读我和其他作者的文章。谢谢你的支持。</em>T13】</strong></p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="ce32" class="mm mn iu bd mo mp mq mr ms mt mu mv mw kj mx kk my km mz kn na kp nb kq nc nd bi translated">参考</h1><ol class=""><li id="3d32" class="nz oa iu ll b lm ne lp nf ls oo lw op ma oq me or of og oh bi translated"><a class="ae li" href="http://www.stat.yale.edu/Courses/1997-98/101/linreg.htm" rel="noopener ugc nofollow" target="_blank">http://www.stat.yale.edu/Courses/1997-98/101/linreg.htm</a></li><li id="b373" class="nz oa iu ll b lm oi lp oj ls ok lw ol ma om me or of og oh bi translated"><a class="ae li" href="https://machinelearningmastery.com/regression-metrics-for-machine-learning/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/regression-metrics-for-machine-learning/</a></li><li id="84b8" class="nz oa iu ll b lm oi lp oj ls ok lw ol ma om me or of og oh bi translated"><a class="ae li" href="https://www.statisticshowto.com/explained-variance-variation/" rel="noopener ugc nofollow" target="_blank">https://www . statistics show to . com/explained-variance-variation/</a></li><li id="6e5d" class="nz oa iu ll b lm oi lp oj ls ok lw ol ma om me or of og oh bi translated"><a class="ae li" href="https://en.wikipedia.org/wiki/Coefficient_of_determination" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Coefficient_of_determination</a></li></ol></div></div>    
</body>
</html>