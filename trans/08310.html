<html>
<head>
<title>Pandas Hacks That I Wish I Had When I Started Out</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫黑客，我希望我有当我开始了</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-hacks-that-i-wish-i-had-when-i-started-out-1f942caa9792?source=collection_archive---------6-----------------------#2021-07-31">https://towardsdatascience.com/pandas-hacks-that-i-wish-i-had-when-i-started-out-1f942caa9792?source=collection_archive---------6-----------------------#2021-07-31</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="1d38" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">我仍然记得学习熊猫和Python时的焦虑；我希望在学习过程中早点掌握这些技巧</h2></div><h1 id="c90e" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">介绍</h1><p id="abdc" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi lx translated">开始接触熊猫和蟒蛇可能是一次令人焦虑的经历。在我的经历中，我已经成长为Stata的一名中高级程序员。那是在我向博士委员会提交论文的几个星期后，但在我答辩之前。我有大把的时间。数据分析结束了，写作也完成了。</p><p id="5030" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">提交后答辩前的时间我是怎么度过的？对我来说，这是大约六周的时间。我开始学习Python。</p><p id="2dcb" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">几年后，我发现自己在为我曾经认为是问题的事情寻找解决方案。现在，我几乎不费吹灰之力就找到了解决办法。出于有一两个空闲时间来分享这些，加上一个真诚的想法，也许(也许)这些黑客可能对其他人有用…给你。</p><p id="dce9" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">准备好了吗？</p><h2 id="d221" class="ml kk iu bd kl mm mn dn kp mo mp dp kt lk mq mr kv lo ms mt kx ls mu mv kz mw bi translated">检查狭长数据帧</h2><p id="ec98" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">您多久检查一次长(许多观察值)但窄(几列)数据框中的数据？在Jupyter笔记本环境中，或者在命令提示符下，检查这些“高”数据框会占用垂直空间，同时“浪费”水平空间。这是我的看法(以及我的感受):</p><figure class="my mz na nb gu nc gi gj paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gi gj mx"><img src="../Images/cec5031ad58d778ada862761c6fcaa58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikm52RUB1DVANz5s-FDvnQ.png"/></div></div><p class="nj nk gk gi gj nl nm bd b be z dk translated">作者插图。</p></figure><p id="2a31" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">如果我们能把输出并排放在一起会怎么样？我们可以。首先定义这个函数:</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="fde7" class="ml kk iu no b gz ns nt l nu nv">def lrpd(df, n=5, sep='&lt; head | tail &gt;', sepcol=' '):<br/>   return(<br/>     pd.concat([df.head(n),<br/>                pd.DataFrame([sep] * n,<br/>                columns=[sepcol]),<br/>                df.tail(n).reset_index().drop('index',<br/>                                              axis=1)], axis=1))</span></pre><p id="e495" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">然后在一行代码中，类似于:</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="1420" class="ml kk iu no b gz ns nt l nu nv">lrpd(df, n=8)</span></pre><p id="fcec" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">会给你:</p><figure class="my mz na nb gu nc gi gj paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gi gj mx"><img src="../Images/08d02383b832835e54b76e663e263de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WnXVfqfQvMVqKMSpNvAafQ.png"/></div></div><p class="nj nk gk gi gj nl nm bd b be z dk translated">作者插图。</p></figure><h2 id="9608" class="ml kk iu bd kl mm mn dn kp mo mp dp kt lk mq mr kv lo ms mt kx ls mu mv kz mw bi translated">测试项目“A”是否也在列表“L”中</h2><p id="017a" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">你可能会因此而对我们动心。但是为什么不也写一个函数呢？至少这是我曾经的初学者的想法。除了这个模仿Stata的<code class="fe nw nx ny no b">inlist()</code>选项，您还应该看到下面的<code class="fe nw nx ny no b">pd.isin()</code>方法。</p><p id="1e74" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">如前所述，这个Stata的<code class="fe nw nx ny no b">inlist()</code>功能就是灵感。首先定义以下内容:</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="a284" class="ml kk iu no b gz ns nt l nu nv">def inlist(list_to_test, item=''):<br/>   isinlist = False<br/>   for i in list_to_test:<br/>      if i == item:<br/>         isinlist = True<br/>   return(isinlist)</span></pre><p id="58c4" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">并实施:</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="a20a" class="ml kk iu no b gz ns nt l nu nv">inlist(df['country'], 'Angola')</span></pre><p id="e93c" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">或者，用漫画小说的风格。数据中有安哥拉吗？</p><figure class="my mz na nb gu nc gi gj paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gi gj mx"><img src="../Images/1e1eb93f293897c57a81346a74b9eae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hvY_3QgKsgrlqdf1UUAvA.png"/></div></div><p class="nj nk gk gi gj nl nm bd b be z dk translated">作者插图。</p></figure></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><p id="6eb0" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">代替一个新的函数，一些聪明的方法链有时可以完成类似的结果。例如，如果测试字符串出现在序列中，链接到<code class="fe nw nx ny no b">isin()</code>的<code class="fe nw nx ny no b">.max()</code>方法将返回<code class="fe nw nx ny no b">True</code>:</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="a68c" class="ml kk iu no b gz ns nt l nu nv"># Returns True<br/>df['country'].isin(['Angola']).max()</span></pre><p id="72ca" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">同样，如果你更喜欢0或1链，那么<code class="fe nw nx ny no b">.sum()</code>方法:</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="cdcd" class="ml kk iu no b gz ns nt l nu nv"># Returns 1<br/>df['country'].isin(['Angola']).max().sum()</span></pre><h2 id="9a1e" class="ml kk iu bd kl mm mn dn kp mo mp dp kt lk mq mr kv lo ms mt kx ls mu mv kz mw bi translated">长期保存数据</h2><p id="a109" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">这第三次攻击更多的是推荐，而不是攻击。建议是，以多种格式保存数据文件。当归档项目文件以备将来某个未知时刻参考时，这种多格式建议尤其重要。</p><p id="1e0f" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">在我职业生涯的早期(这么早),我记得我认为数据就是数据，对吗？所以，我通常把我的数据保存在CSV中。也许很大一部分人默认选择CSV。然而，如果你是熊猫的新手，你知道除了CSV还有21种格式可以选择吗？这些是熊猫支持的现成格式。结合其他软件包，你会有更多的选择。</p><p id="150b" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">以下是熊猫将支持的一些格式，以及一些关于它们的用例的片段。</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="cd9e" class="ml kk iu no b gz ns nt l nu nv">pandas.DataFrame.to_html('file_name.html')<br/>pandas.DataFrame.to_xml('file_name.xml')</span></pre><p id="b138" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">当你使用一个不总是擅长读取<code class="fe nw nx ny no b">.csv</code>文件的平台向任何人发送数据时，使用这些格式。我不止一次将一个<code class="fe nw nx ny no b">csv </code>数据文件发送给某人，他会将该文件导入到一个解析<code class="fe nw nx ny no b">csv</code>数据时出错的工具中。有些事情不太对劲。谁知道呢？有些工具在这方面比其他工具更好。</p><p id="5ab3" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">在无孔不入的情况下，并且默认为许多<code class="fe nw nx ny no b">csv</code>失败了，还有<code class="fe nw nx ny no b">pandas.DataFrame.to_html()</code>和<code class="fe nw nx ny no b">pandas.DataFrame.to_xml()</code>来救场。</p><p id="d6bf" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">我也很喜欢这些非文本格式。</p><pre class="my mz na nb gu nn no np nq aw nr bi"><span id="8554" class="ml kk iu no b gz ns nt l nu nv">pandas.DataFrame.to_stata('file_name.dat')<br/>pandas.DataFrame.to_pickle('file_name.pkl')<br/>pandas.DataFrame.to_parquet('file_name.parquet')</span></pre><p id="16bf" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">通过以更复杂的方式保存数据，这些数据格式可以更好地保留数据表示和数据类型。</p><p id="8be3" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">一般来说，我倾向于以至少两种格式保存数据。这种做法有助于未来证明我的项目。也许在5年、10年或者更久以后，我可能会重新考虑一个项目。或者其他人可能会重访某个项目。如果数据仅以一种不再广泛使用的格式存储，这可能会产生问题。以多种格式保存可以防止在数据标准、工具和其他环境因素尚不可知的未来系统中读取数据时可能出现的问题。</p><p id="e817" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">我赞成以多种格式保存的另一个原因是，有时由于古怪的数据类型，项目中可能会出现错误。每种格式都有自己的数据类型方案。熊猫也有自己的计划。当数据类型没有很好地映射时，将数据从一种格式交换到另一种格式有时会产生意想不到的结果。拥有数据的冗余副本有助于解决这些与数据类型相关的问题。</p><div class="og oh gq gs oi oj"><a href="https://adamrossnelson.medium.com/membership" rel="noopener follow" target="_blank"><div class="ok ab fp"><div class="ol ab om cl cj on"><h2 class="bd iv gz z fq oo fs ft op fv fx it bi translated">加入我的介绍链接媒体-亚当罗斯纳尔逊</h2><div class="oq l"><h3 class="bd b gz z fq oo fs ft op fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="or l"><p class="bd b dl z fq oo fs ft op fv fx dk translated">adamrossnelson.medium.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox nh oj"/></div></div></a></div><h1 id="ebd0" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">结论</h1><p id="9368" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">这些是我希望在我的数据科学职业生涯中早点知道的一些技巧。我希望这些技巧对你有用。如果你有想法或主意，请发表评论。让它成为可乐吧。</p><p id="dcca" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">我也希望你喜欢原来的插图。</p><p id="66d8" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">编辑:感谢媒体、电子邮件和其他平台上的有益评论——我对这篇文章做了一些编辑。我非常感谢那些做出贡献的人。</p><p id="3ff0" class="pw-post-body-paragraph lb lc iu ld b le mg jv lg lh mh jy lj lk mi lm ln lo mj lq lr ls mk lu lv lw in bi translated">另一个我开始时想变得更简单的任务是:在Pandas &gt;中移动列:|</p><div class="og oh gq gs oi oj"><a rel="noopener follow" target="_blank" href="/reordering-pandas-dataframe-columns-thumbs-down-on-standard-solutions-1ff0bc2941d5"><div class="ok ab fp"><div class="ol ab om cl cj on"><h2 class="bd iv gz z fq oo fs ft op fv fx it bi translated">重新排序熊猫数据框列:否定标准解决方案</h2><div class="oq l"><h3 class="bd b gz z fq oo fs ft op fv fx dk translated">简化更改数据框列顺序过程的解决方案</h3></div><div class="or l"><p class="bd b dl z fq oo fs ft op fv fx dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox nh oj"/></div></div></a></div><h1 id="3bf2" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">感谢阅读</h1><p id="f052" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">感谢阅读。把你的想法和主意发给我。你可以写信只是为了说声嗨。我期待着尽快聊天。推特:<a class="ae oz" href="https://twitter.com/adamrossnelson" rel="noopener ugc nofollow" target="_blank">@ adamrossnelson</a>LinkedIn:<a class="ae oz" href="https://www.linkedin.com/in/arnelson" rel="noopener ugc nofollow" target="_blank">亚当·罗斯·尼尔森在推特</a>和脸书:<a class="ae oz" href="https://www.facebook.com/adamrossnelson" rel="noopener ugc nofollow" target="_blank">亚当·罗斯·尼尔森在脸书</a>。</p></div></div>    
</body>
</html>