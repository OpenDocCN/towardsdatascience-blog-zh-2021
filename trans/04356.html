<html>
<head>
<title>Rejection Sampling in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中的拒绝采样</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rejection-sampling-in-r-a3a37e9135ff?source=collection_archive---------15-----------------------#2021-04-13">https://towardsdatascience.com/rejection-sampling-in-r-a3a37e9135ff?source=collection_archive---------15-----------------------#2021-04-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6214" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用拒绝采样生成随机数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/21c3d4625469f3107a5d370d61464550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8m4-aMxqwWZrYFijzncMcQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:图片由<a class="ae ky" href="https://pixabay.com/users/geralt-9301/" rel="noopener ugc nofollow" target="_blank"> geralt </a>从<a class="ae ky" href="https://pixabay.com/photos/businessman-control-success-3492380/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄</p></figure><p id="abec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当从特定分布生成随机数时，这个过程可以在很大程度上自动化。</p><p id="a4f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果想要生成100个属于R中的正态分布的随机数，执行起来很简单:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="26d4" class="ma mb it lw b gy mc md l me mf">rnorm(100)</span></pre><p id="26b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这个过程实际上是如何工作的呢？一个算法如何知道一个随机数是否属于一个特定的分布？</p><p id="a673" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答案是通过<strong class="lb iu">拒绝采样</strong>。</p><p id="edb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拒绝抽样是一种生成属于特定分布的随机数的方法。</p><h1 id="5409" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">剔除取样的工作原理</h1><p id="7bfd" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">笛卡儿图由穿过定义空间的x轴和y轴组成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/503d735af47ae56a8d73f0e7f0692821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qoIvT2jIcL8RwWl3.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:图片由作者创建</p></figure><p id="0738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在图形的整个区域中，给定的分布(如正态分布)只能覆盖图形的给定部分。在这点上，如果一个人向棋盘随机投掷飞镖，那么落在正态分布区域内的飞镖将被接受，而在该区域之外的飞镖将被拒绝。</p><h1 id="9f8d" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">AR包的使用</h1><p id="652a" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">虽然手动设置这种机制可能会被证明是一个繁琐的过程，但R中的<a class="ae ky" href="https://cran.r-project.org/web/packages/AR/AR.pdf" rel="noopener ugc nofollow" target="_blank"> AR包</a>使这变得更加直观。</p><p id="0dd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为参考，AR代表<strong class="lb iu">接受-拒绝方法</strong>，本质上意味着算法接受符合指定分布的随机数，而拒绝不符合的随机数。</p><p id="3a2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看一些例子。</p><h1 id="a782" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">将y函数定义为均匀分布</h1><p id="0331" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">首先，让我们考虑随机数界于0和1之间的均匀分布。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1772" class="ma mb it lw b gy mc md l me mf">library(AR)</span><span id="3e4c" class="ma mb it lw b gy nd md l me mf">simulation = AR.Sim( n = 200,<br/>               f_X = function(y){dunif(y, min = 0, max = 1, log = FALSE)},<br/>               Y.dist = "unif", Y.dist.par = c(0,1),<br/>               Rej.Num = TRUE,<br/>               Rej.Rate = TRUE,<br/>               Acc.Rate = FALSE<br/>)</span><span id="f295" class="ma mb it lw b gy nd md l me mf">simulation</span></pre><p id="feb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，函数(y)被定义为均匀分布<code class="fe ne nf ng lw b">dunif(y, min = 0, max = 1, log = FALSE)</code>，其中<em class="nh"> Y.dist </em>也被设置为均匀分布<code class="fe ne nf ng lw b">unif</code> -其中<em class="nh"> Y.dist </em>代表随机变量的分布名称，即我们指定生成的所有随机数都应该是均匀的。</p><p id="81d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是生成的模拟:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6256" class="ma mb it lw b gy mc md l me mf">Optimal c = 1<br/>The numbers of Rejections = 0<br/>Ratio of Rejections = 0<br/>&gt; simulation<br/>  [1] 0.698931268 0.385566025 0.268550105 0.645668389<br/>  [5] 0.074197359 0.106701437 0.413400215 0.852781124<br/>...<br/>[193] 0.170901990 0.846563826 0.935788635 0.794019386<br/>[197] 0.954960048 0.185282641 0.262304122 0.499565325</span></pre><p id="61ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设生成的随机数来自同一分布，则拒绝率为<strong class="lb iu"> 0 </strong>，即所有生成的随机数都落在指定的分布内。</p><p id="24e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个图形演示，我们看到所有随机数都以绿色突出显示，它们都属于接受区域:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a21222ee2df3acb8996b53f785c2a737.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/0*mS_PKYFLi4qguJq7.png"/></div></figure><p id="301d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当从不同的分布中抽取随机数时，我们可以预期拒绝率将是显著的，因为均匀生成的随机数将不可避免地落在分布之外。</p><h2 id="0641" class="ma mb it bd mh nj nk dn ml nl nm dp mp li nn no mr lm np nq mt lq nr ns mv nt bi translated">Y.dist =正态分布</h2><p id="4581" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">让我们指定<em class="nh"> Y.dist </em>为正态分布。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4494" class="ma mb it lw b gy mc md l me mf">simulation = AR.Sim( n = 200,<br/>               f_X = function(y){dunif(y, min = 0, max = 1, log = FALSE)},<br/>               Y.dist = "norm", Y.dist.par = c(0,1),<br/>               Rej.Num = TRUE,<br/>               Rej.Rate = TRUE,<br/>               Acc.Rate = FALSE<br/>)<br/>simulation</span></pre><p id="b414" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是生成的样本和拒绝分数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="273f" class="ma mb it lw b gy mc md l me mf">Optimal c = 4.132<br/>The numbers of Rejections = 646<br/>Ratio of Rejections = 0.764<br/>&gt; simulation<br/>  [1] 0.928162718 0.263720941 0.791635163 0.787643782<br/>  [5] 0.682266914 0.609826459 0.526126303 0.303784735<br/>...<br/>[193] 0.528860424 0.945110000 0.263584707 0.958508588<br/>[197] 0.136600285 0.855113058 0.952162865 0.776729036</span></pre><p id="51f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到在这种情况下获得了0.764 的<strong class="lb iu">拒绝率。</strong></p><p id="0678" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个图形表示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/4bc9646d42c1143666edbb7a0e2815f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/0*ngTEQ1BLw54Wn0Vc.png"/></div></figure><h2 id="4701" class="ma mb it bd mh nj nk dn ml nl nm dp mp li nn no mr lm np nq mt lq nr ns mv nt bi translated">Y.dist =柯西分布</h2><p id="1404" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">柯西分布怎么样？</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="918e" class="ma mb it lw b gy mc md l me mf">simulation = AR.Sim( n = 200,<br/>               f_X = function(y){dunif(y, min = 0, max = 1, log = FALSE)},<br/>               Y.dist = "cauchy", Y.dist.par = c(0,1),<br/>               Rej.Num = TRUE,<br/>               Rej.Rate = TRUE,<br/>               Acc.Rate = FALSE<br/>)<br/>simulation</span></pre><p id="735e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，观察到明显更高的废品率<strong class="lb iu"> 0.839 </strong>:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="323c" class="ma mb it lw b gy mc md l me mf">Optimal c = 6.283<br/>The numbers of Rejections = 1042<br/>Ratio of Rejections = 0.839<br/>&gt; simulation<br/>  [1] 0.942316029 0.610005076 0.653872133 0.411678591<br/>  [5] 0.350234804 0.511995680 0.962110053 0.224207609<br/>...<br/>[193] 0.320808401 0.788250465 0.805645829 0.214475551<br/>[197] 0.471248814 0.015849055 0.715283175 0.067130172</span></pre><p id="a352" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这又是一个图示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ccbae9fd78ccf8559c7735d7420ebb58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/0*IyJVAZW7_VoxRHrL.png"/></div></figure><p id="32dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，也可以改变随机数本身产生的分布。</p><h1 id="4d95" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">将y函数定义为贝塔分布</h1><p id="19ae" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">虽然这里选择了均匀分布，但原作者选择将y函数定义为beta分布。</p><p id="4a1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从均匀分布中抽取属于正态分布的随机数时，拒绝率为<strong class="lb iu"> 0.764 </strong>。</p><p id="bbac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果y函数被定义为贝塔分布呢？在尝试从该分布中识别正态分布的随机数时，会观察到更低或更高的拒绝率吗？</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="422b" class="ma mb it lw b gy mc md l me mf">simulation = AR.Sim( n = 200,<br/>               f_X = function(y){dbeta(y,2.7,6.3)},<br/>               Y.dist = "norm", Y.dist.par = c(0,1),<br/>               Rej.Num = TRUE,<br/>               Rej.Rate = TRUE,<br/>               Acc.Rate = FALSE<br/>)<br/>simulation</span></pre><p id="a1a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是样品和拒绝率:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0515" class="ma mb it lw b gy mc md l me mf">Optimal c = 6.898<br/>The numbers of Rejections = 1231<br/>Ratio of Rejections = 0.86<br/>&gt; simulation<br/>  [1] 0.36115666 0.41559791 0.38940239 0.36566013 0.60793899<br/>  [6] 0.25795174 0.10902713 0.27325963 0.64264824 0.18258016<br/>...<br/>[191] 0.12631125 0.26920790 0.13224107 0.33171854 0.08197576<br/>[196] 0.22850070 0.41424580 0.34925813 0.13344548 0.57013744</span></pre><p id="08c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，当从贝塔分布采样时，<strong class="lb iu"> 0.86 </strong>的拒绝率明显更高，这意味着从均匀分布采样更有效(至少当试图从该分布生成正态分布随机数时)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/e1a7a5155a7ead4a0eab28bd38e0ef78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*8oDkJiNx3oGk7Q1v.png"/></div></figure><p id="5b06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这不会对生成的数字产生影响，但剔除率越低，效率越高，因为从更接近目标分布的分布中进行采样，必然会减少模拟生成适当随机数所需的时间。这就是所谓的<strong class="lb iu">效率比</strong>。</p><h1 id="93ea" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">结论</h1><p id="9a38" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">拒绝抽样(也称为接受-拒绝算法)是概率领域中的一个关键工具，用于生成符合特定分布的随机数。</p><p id="3e00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本例中，您看到了:</p><ul class=""><li id="5311" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">什么是拒绝抽样及其在生成属于特定分布的随机数中的重要性</li><li id="6654" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">如何使用R中的AR包来实现这个目的</li><li id="0439" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">对不同分布进行采样以提高效率</li></ul><p id="feba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的时间，任何问题或反馈都非常欢迎。</p><p id="4c89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nh">免责声明:本文是在“原样”的基础上编写的，没有任何担保。它旨在提供数据科学概念的概述，不应被解释为专业建议。本文中的发现和解释是作者的发现和解释，不被本文中提到的任何第三方认可或隶属于任何第三方。</em></p><h1 id="8d62" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">参考</h1><ul class=""><li id="e009" class="nv nw it lb b lc mx lf my li oj lm ok lq ol lu oa ob oc od bi translated">何塞·恩平科(2016年)。用于概率、统计和机器学习的Python</li><li id="6f83" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><a class="ae ky" href="https://cran.r-project.org/web/packages/AR/AR.pdf" rel="noopener ugc nofollow" target="_blank">综合R档案网:包‘AR’</a></li></ul></div></div>    
</body>
</html>