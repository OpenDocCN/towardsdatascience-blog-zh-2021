<html>
<head>
<title>Generate Beatles Lyrics using a Markov Chain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用马尔可夫链生成披头士歌词</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generate-unedited-beatles-lyrics-using-markov-chain-b7968c49584f?source=collection_archive---------26-----------------------#2021-05-02">https://towardsdatascience.com/generate-unedited-beatles-lyrics-using-markov-chain-b7968c49584f?source=collection_archive---------26-----------------------#2021-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1fb6009552bed5cf37dba4d9b75c169c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1AorJzY3Sbjc03JJdnR4Q.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@fmdevice" rel="noopener ugc nofollow" target="_blank">费多尔</a>在<a class="ae kf" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="eb65" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我非常喜欢披头士。我希望他们写更多的歌词…但是等等，我是一个程序员，我可以根据他们的唱片目录生成新的歌词！让我们看看怎么做。</p><p id="fcb3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">🎤昨天……我所有的烦恼都显得那么遥远。</em></p><p id="89a7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">哦，等等，这是一篇文章，你听不到我唱歌！(幸好😄)</p><p id="6dd8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将创建一个程序，将许多歌词作为输入，并在每次执行时产生一个新的歌词。</p><p id="e6d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">非常熟练的数据科学家和程序员最终会用<strong class="ki iu"> TensorFlow </strong>或类似的东西创建一个<strong class="ki iu">AI</strong>…但是我们想让它变得简单！我们将使用一种叫做<strong class="ki iu">马尔可夫链</strong>的算法。</p><h1 id="0d4c" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">为什么使用马尔可夫链算法？</h1><p id="5ea7" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">很高兴你问了！<br/>维基百科将<strong class="ki iu">马尔可夫链</strong>描述为:</p><p id="73d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">“描述一系列可能事件的随机模型，其中每个事件的概率仅取决于前一事件达到的状态”</em></p><p id="3c0c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">寥寥数语，让我们来看看以下披头士的歌词:</p><p id="53bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">“爱是古老的；爱是新的，爱是一切，爱是你。</em></p><p id="250f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们把上面的句子分解成单词。</p><p id="bdfe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在回答以下问题:</p><ol class=""><li id="657d" class="mi mj it ki b kj kk kn ko kr mk kv ml kz mm ld mn mo mp mq bi translated">“爱”这个词在上面的句子中重复了多少次？</li><li id="487a" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated">哪些词紧挨着“爱”这个词？</li><li id="a9c3" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated">“是”这个词重复了多少次？</li><li id="7959" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated">哪些词紧挨着“是”这个词？</li></ol><p id="93c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们回答了这些问题之后，我们可以清楚地想象下面的图表:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mw"><img src="../Images/178cce5fbd16ffee3e9462b52545046d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0uZDCqVjzTj9YKEBXnJXQ.png"/></div></div></figure><p id="1bc7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，根据上面的图表，我们可以知道:</p><ol class=""><li id="e881" class="mi mj it ki b kj kk kn ko kr mk kv ml kz mm ld mn mo mp mq bi translated">在“爱”这个词之后，有100%的可能性会遇到“是”这个词</li><li id="22aa" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated">在单词“是”之后，有25%的可能性会遇到下列单词之一:“旧的”、“新的”、“所有的”、“你”</li></ol><p id="883a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，想象对一首更复杂的歌曲做同样的研究，比如<strong class="ki iu"> Hey Jude </strong>:</p><p id="4ea8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">“嘿，裘德，不要让它变坏<br/>唱一首悲伤的歌，让它变好<br/>记得让她进入你的心里<br/>然后你就可以开始让它变好</em></p><p id="4f64" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嘿，裘德，不要害怕从你让她进入你的皮肤的那一刻起，你就被迫走出去得到她</p><p id="b719" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">无论何时你感到痛苦<br/>嘿，裘德，不要把世界扛在肩上<br/></em></p><p id="add2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为你知道，通过让自己的世界变得更冷来装酷的人是傻瓜</p><p id="09d4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">娜娜娜娜……</em></p><p id="4c77" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">嘿，裘德，不要让我失望<br/>她已经找到你，现在去得到她<br/>记得让她进入你的心<br/>然后你可以开始让它变得更好</em></p><p id="6d2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">尽情释放，尽情投入<br/>嘿，裘德，开始<br/>你在等人和你一起表演<br/>难道你不知道只有你自己<br/>嘿，裘德，你会做<br/>你需要的动作就在你的肩膀上<br/>啦，啦，啦，啦……</em></p><p id="4f4a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">嘿，裘德，不要让它变坏<br/>选一首悲伤的歌，让它变得更好<br/>一旦你让她进入你的心<br/>那么你就可以开始让它变得更好</em></p><p id="392e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">娜娜娜……”</em></p><p id="80b7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一位Reddit用户贴了一张关于这首歌的有趣的流程图，这将节省我很多工作:</p><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mw"><img src="../Images/682a0fe9c8e0b64ba6fcec73beadd0fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-9_HTxKaa9K-fdMUQzonw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://www.reddit.com/r/ProgrammerHumor/comments/f27xpu/flowchart_hey_jude/" rel="noopener ugc nofollow" target="_blank"> Reddit </a>上的流程图“嘿，裘德”</p></figure><p id="43d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你能看到我要去哪里吗？我们想要估计每个单词出现在另一个单词旁边的概率。给定这个值，我们将能够根据一个给定单词在另一个给定单词之后出现的概率来组成新的句子。</p><h1 id="4e6d" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">构建马尔可夫链</h1><p id="4ea4" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">我们将在<strong class="ki iu">类型脚本</strong>中构建马尔可夫链，以便在编译阶段之后在我们的浏览器中运行。</p><p id="c0bb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您不习惯TypeScript语法，不要担心！理解起来会毫不费力。</p><p id="c962" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将从定义马尔可夫链接口开始:</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="baee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的类将有三个公共方法:</p><ol class=""><li id="69fd" class="mi mj it ki b kj kk kn ko kr mk kv ml kz mm ld mn mo mp mq bi translated"><code class="fe nd ne nf ng b">add</code>:它会让我们给自己的模型添加越来越多的歌词。</li><li id="147e" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated"><code class="fe nd ne nf ng b">train</code>:它会训练我们的模型。一个模型基本上是一个对象，它保存了一个给定单词和它旁边的所有单词之间的所有关系。</li><li id="09f4" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated"><code class="fe nd ne nf ng b">generate</code>:它会根据我们的模型返回给定长度的新歌词。</li></ol><p id="9dd3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以开始构建我们的<code class="fe nd ne nf ng b">MarkovChain</code>类了:</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="e3de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，在我们的类中，我们还想指定两个私有变量。</p><p id="b223" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一个是<code class="fe nd ne nf ng b">data</code>。它会将我们添加的所有歌词存储为一个唯一的字符串。</p><p id="dbc3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个是<code class="fe nd ne nf ng b">model</code>。这个对象应该是这样的:</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="cde8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(如果你想知道为什么<code class="fe nd ne nf ng b">'new'</code>要加引号，那是因为它是JS中的保留关键字)。</p><p id="2b2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如您可能已经猜到的那样，<code class="fe nd ne nf ng b">model</code>存储了<code class="fe nd ne nf ng b">data</code>中的每个单词，以及它们后面的所有单词。</p><p id="e038" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们开始实现<code class="fe nd ne nf ng b">add</code>方法:</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="fd37" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这种方法，我们希望将输入字符串附加到<code class="fe nd ne nf ng b">data</code>变量上。请注意，我们还在<code class="fe nd ne nf ng b">txt</code>变量后添加了一个空格，以连接给定歌词的最后一个词和下一个词的第一个词。</p><p id="9d80" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在继续使用<code class="fe nd ne nf ng b">train</code>方法。<br/>首先，我们要确保在开始培训之前已经插入了一些数据。然后，我们想从我们的<code class="fe nd ne nf ng b">data</code>中删除所有的特殊字符(不包括单引号)。</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="a072" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样，下面的输入字符串:<code class="fe nd ne nf ng b">'hey there! I\'m trying the Markov Chain for the first time!!!'</code>将被转换成:<code class="fe nd ne nf ng b">['hey', 'there', 'i\'m', 'trying', 'the', 'markov', 'chain', 'for', 'the', 'first', 'time']</code>。</p><p id="e858" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们要训练我们的模型，所以我们基本上要循环每个令牌。如果给定的令牌在我们的模型中还不存在，我们将添加它(并添加一个空数组作为值)。否则，我们将把下一个令牌作为一个值放入当前模型数组中。</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="077e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">厉害！现在我们可以训练我们的模型了。<br/>现在我们需要添加<code class="fe nd ne nf ng b">generate</code>方法。</p><p id="03dc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还将添加一个名为<code class="fe nd ne nf ng b">getRandomElement</code>的私有helper函数，它将从给定的数组中返回一个随机元素。</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="6edf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，这些方法非常简单。<br/>首先，我们要检查用户是否已经对模型进行了训练。<br/>之后，我们开始从模型中获取一个随机单词。<br/>然后我们想要循环<code class="fe nd ne nf ng b">x</code>次，其中<code class="fe nd ne nf ng b">x</code>是我们想要创建的最终歌词的长度。</p><p id="55b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在每一个循环中，我们都希望得到前面实例化的<code class="fe nd ne nf ng b">newWord</code>变量旁边的一个单词。</p><p id="873d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们将这个单词连接到<code class="fe nd ne nf ng b">result</code>字符串。然后我们要检查这个词在我们的模型中是否有它自己的后继词。<br/>如果是，我们用后继者重新实例化<code class="fe nd ne nf ng b">randomWord</code>变量；否则，我们随机取一个新词。</p><p id="058f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦循环结束，我们返回结果字符串，就这样！</p><p id="3b79" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是完整的实现:</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="ad65" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">玩我们的新玩具</h1><p id="bd6d" class="pw-post-body-paragraph kg kh it ki b kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz mh lb lc ld im bi translated">现在我们的类已经准备好了，我们可以如下使用它:</p><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="mx my mz na gt ju"><div class="bz fp l di"><div class="nh nc l"/></div></figure><p id="52ee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你也可以从<a class="ae kf" href="https://github.com/Hackdoor-io/articles-codebase/tree/master/articles/generate-inedited-beatles-lyrics-using-markov-chains" rel="noopener ugc nofollow" target="_blank"> GitHub </a>下载代码！<br/>尽情享受！</p></div></div>    
</body>
</html>