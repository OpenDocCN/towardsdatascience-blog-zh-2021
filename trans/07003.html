<html>
<head>
<title>Troubleshooting a CloudFlare Gateway Timeout error 524 in a Flask-vue.js application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对Flask-vue.js应用程序中的CloudFlare网关超时错误524进行故障排除</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-fix-a-cloudflare-gateway-timeout-error-in-a-flask-vue-js-ml-application-efe2826585bb?source=collection_archive---------7-----------------------#2021-06-25">https://towardsdatascience.com/how-to-fix-a-cloudflare-gateway-timeout-error-in-a-flask-vue-js-ml-application-efe2826585bb?source=collection_archive---------7-----------------------#2021-06-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/08a01e6b9048b66ebdb5f41fb0f0fae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0p1qD6SedRsa0nS02rKnA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">CloudFlare如何通过<a class="ae kc" href="https://www.cloudflare.com/ru-ru/waf/" rel="noopener ugc nofollow" target="_blank"> CloudFlare网站</a>工作</p></figure><p id="aecb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我和<a class="ae kc" href="https://www.linkedin.com/in/manuelguzmandao/" rel="noopener ugc nofollow" target="_blank">曼努埃尔·古兹曼</a> (MSW R &amp; D director)在测试一个ML应用程序时，出现了524网关超时错误，这个应用程序需要几分钟时间来生成结果，然后再将结果发送给用户。</p><p id="04fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们发现应该增加CloudFlare中的超时限制来消除错误。</p><p id="5a81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据我们在谷歌搜索这个错误时发现的一些答案，它是不可能修复的(<a class="ae kc" href="https://stackoverflow.com/questions/38536167/is-it-possible-to-increase-cloudflare-time-out" rel="noopener ugc nofollow" target="_blank">查看这个StackOverflow答案</a>)。</p><p id="72ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过一次头脑风暴，我们按照曼纽尔的想法解决了这个问题。</p><p id="db12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将与您分享我们为解决Cloudflare中的524网关超时错误而采取的所有步骤。</p><p id="9ab7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将介绍如何解决这种类型的错误，更重要的是我们使用的代码片段。</p><h2 id="0cf5" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">什么是524网关超时错误？</h2><p id="7aed" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">524网关超时错误是特定于Cloudflare的HTTP状态代码，表示与服务器的连接因超时而关闭。</p><p id="b312" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是在<a class="ae kc" href="https://support.cloudflare.com/hc/en-us/articles/115003011431-Troubleshooting-Cloudflare-5XX-errors" rel="noopener ugc nofollow" target="_blank"> Cloudflare支持网站</a>中的定义</p><blockquote class="lz ma mb"><p id="663a" class="kd ke mc kf b kg kh ki kj kk kl km kn md kp kq kr me kt ku kv mf kx ky kz la ij bi translated">错误524表示Cloudflare成功连接到源web服务器，但在默认的100秒连接超时之前，源没有提供HTTP响应。企业客户可以将524超时增加到600秒。</p></blockquote><p id="2f21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在可操作的情况下，浏览器向应用程序所在的web服务器发送请求，然后将包含状态代码(即200)和结果(ML应用程序的预测)的回答发送回用户。如果与服务器的连接超过100秒而没有发回响应，用户将收到状态代码524和空内容。</p><p id="9e2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CloudFlare仅在企业计划上提供超时<a class="ae kc" href="https://www.cloudflare.com/fr-fr/enterprise/" rel="noopener ugc nofollow" target="_blank">的定制。</a></p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="mk ml l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">GIF via <a class="ae kc" href="https://media.giphy.com/media/14SAx6S02Io1ThOlOY/giphy.gif" rel="noopener ugc nofollow" target="_blank"> GIPHY </a></p></figure><h2 id="3130" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">解决方案</h2><p id="e92b" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">以下步骤描述了该解决方案</p><ol class=""><li id="9fc7" class="mm mn iq kf b kg kh kk kl ko mo ks mp kw mq la mr ms mt mu bi translated">浏览器发送带有参数的第一个请求来启动后端进程(在我们的例子中，它是一个ML应用程序后端)。</li></ol><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="mv ml l"/></div></figure><p id="f94c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.应用程序后端为这个请求生成一个ID</p><p id="fbe1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.应用程序后端使用给定的参数启动(预测)过程</p><p id="7dc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.应用后端立即将响应发送回浏览器(无需等待预测过程完成),该响应包括请求ID和指示该过程当前正在工作的状态202</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="mv ml l"/></div></figure><p id="a8a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.浏览器收到答案，等待10秒钟(这取决于您的预测过程生成最终结果所需的时间)，然后用相同的ID发出另一个请求，以检查预测过程是否完成(状态200)</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="mv ml l"/></div></figure><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="mv ml l"/></div></figure><p id="88cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.如果预测过程尚未完成，则重复步骤4和5</p><p id="e691" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样！</p><p id="557e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您的浏览器将等待预测结果，并在准备就绪时获得后端答案。</p><figure class="mg mh mi mj gt jr"><div class="bz fp l di"><div class="mk ml l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">GIF via <a class="ae kc" href="https://media.giphy.com/media/4NnTap3gOhhlik1YEw/giphy.gif" rel="noopener ugc nofollow" target="_blank"> GIPHY </a></p></figure><h1 id="9b90" class="mw lc iq bd ld mx my mz lg na nb nc lj nd ne nf lm ng nh ni lp nj nk nl ls nm bi translated">摘要</h1><p id="5a4a" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">与其他类型的应用程序相比，机器学习应用程序的响应时间通常较长。每当应答时间超过服务器连接超时限制时，就可以应用这种解决方案。</p><p id="6ff6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你有问题，欢迎在下面评论或通过<a class="ae kc" href="http://maha.amami@mysciencework.com" rel="noopener ugc nofollow" target="_blank">邮箱</a>或<a class="ae kc" href="https://www.linkedin.com/in/maha-amami-phd-088b42b2/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>提问。我会回答的。</p></div></div>    
</body>
</html>