<html>
<head>
<title>Who will win the next round of Counter-Strike: Global Offensive?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谁会赢得下一轮《反恐精英:全球攻势》？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/who-will-win-the-next-round-of-counter-strike-global-offensive-de574a4f37f4?source=collection_archive---------37-----------------------#2021-06-24">https://towardsdatascience.com/who-will-win-the-next-round-of-counter-strike-global-offensive-de574a4f37f4?source=collection_archive---------37-----------------------#2021-06-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2301" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">使用贝叶斯统计预测回合获胜概率</em></h2></div><p id="bcbc" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><em class="lc">的文章、代码和数据可以在github上的</em><a class="ae ld" href="https://github.com/PaulHiemstra/bayes_csgo_round" rel="noopener ugc nofollow" target="_blank"><em class="lc"/></a>找到</p><h1 id="08c3" class="le lf iq bd lg lh li lj lk ll lm ln lo jw lp jx lq jz lr ka ls kc lt kd lu lv bi translated">介绍</h1><p id="f37e" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">像在其他领域一样，统计和数据的使用在电子竞技中有所增长。一个具体的领域是电子竞技广播，其中统计数据用于增强和改善观看体验。最近一个让我印象深刻的例子是<a class="ae ld" href="https://liquipedia.net/counterstrike/BLAST/Premier/2021/Spring" rel="noopener ugc nofollow" target="_blank"> Blast Spring CS:GO总决赛</a>的一部分，在比赛中展示了一轮获胜概率“AI预测”。随着回合的展开，这个概率被更新。例如，一个反恐(CT)玩家倒下会降低CT获胜的概率。我脑子里的齿轮立即开始转动:除了不称之为“人工智能预测”之外，我如何实现这样一个舍入预测器。在这篇文章中，我将提出我的解决方案，使用贝叶斯统计来解决这个问题。使用这种方法，需要回答的问题可能是:</p><ul class=""><li id="760b" class="mb mc iq ki b kj kk km kn kp md kt me kx mf lb mg mh mi mj bi translated">放置炸弹时1v1获胜概率如何变化</li><li id="59c1" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">当炸弹被放置时，获胜的概率一般是怎样变化的</li><li id="29a3" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">当CT或T玩家倒下时，获胜概率如何变化</li><li id="dadf" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">地图对获胜概率有什么影响</li></ul><p id="d48c" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">反恐精英玩家可以利用这些信息在特定情况下做出明智的决定。此外，一个团队可以使用总的获胜概率，并用它们来衡量自己。例如，你的4v5胜率与整体4v5胜率相比如何。</p><p id="1e19" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在接下来的几节中，我将慢慢建立统计模型。</p><h1 id="03f4" class="le lf iq bd lg lh li lj lk ll lm ln lo jw lp jx lq jz lr ka ls kc lt kd lu lv bi translated">还剩两个CT</h1><p id="80ed" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">我想解决的第一个问题是当两个CT玩家活着的时候，CT获胜的概率。一般来说，活着的玩家数量的减少应该会降低特定团队获胜的概率。但是在我们进入统计之前，首先我们必须确定使用什么数据。</p><p id="31f8" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">为了计算这种可能性，我使用了大量的历史数据(感谢基督徒！):</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><pre class="mp mq mr ms gt mw mx my mz aw na bi"><span id="c569" class="nb lf iq mx b gy nc nd l ne nf">122410<br/>Index(['time_left', 'ct_score', 't_score', 'map', 'bomb_planted', 'ct_health',<br/>       't_health', 'ct_armor', 't_armor', 'ct_money', 't_money', 'ct_helmets',<br/>       &lt;&lt;&lt;SNIP&gt;&gt;&gt;&gt;&gt;<br/>       't_grenade_flashbang', 'ct_grenade_smokegrenade',<br/>       't_grenade_smokegrenade', 'ct_grenade_incendiarygrenade',<br/>       't_grenade_incendiarygrenade', 'ct_grenade_molotovgrenade',<br/>       't_grenade_molotovgrenade', 'ct_grenade_decoygrenade',<br/>       't_grenade_decoygrenade', 'round_winner'],<br/>      dtype='object')</span></pre><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ng"><img src="../Images/ac0a1eef202ce395dabd0ea700d27596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wnM0bgt9Jl_kmSun70v6w.png"/></div></div></figure><p id="9f81" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">该数据集在一轮CS:GO中提供了超过122k的快照，提供了该轮的属性，例如有多少CT仍然活着，哪些武器或工具仍然存在，等等。此外，它还列出了谁赢得了这一轮。回合属性和谁赢了回合的组合使我们能够计算赢的概率。</p><p id="4117" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">以下帮助器函数计算成功概率，在本例中只是计算总联系类型成功概率。</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><pre class="mp mq mr ms gt mw mx my mz aw na bi"><span id="b72c" class="nb lf iq mx b gy nc nd l ne nf">0.4901887100727065</span></pre><p id="9bd6" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">其简单地计算例如<code class="fe nn no np mx b">CT</code>赢得一轮的次数与总回合数的比值。在这种情况下，它显示CT赢得了49%的回合。但是当然，我们有更多的数据可用，而不仅仅是我们属于哪个队，例如有多少CT球员仍然活着。为了扩展我们的回合获胜概率以包括该信息，我们转向<a class="ae ld" href="https://en.wikipedia.org/wiki/Bayes%27_theorem" rel="noopener ugc nofollow" target="_blank">贝叶斯统计</a>。</p><p id="79e9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">贝叶斯统计从CT获胜概率(𝑃(CT获胜)的<em class="lc">先验</em>估计开始，在这种情况下，我们之前计算了总体获胜概率(0.49)。接下来，我们添加额外的证据，在这种情况下，我们知道只有2个CT玩家仍然活着。使用贝叶斯定理来计算<em class="lc">后验</em> CT获胜概率(𝑃(CT获胜|2存活):</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nq"><img src="../Images/416ac02a7c798d8747018b88f0f04e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WIr5mKBFnwAuPnSeMMtLzA.png"/></div></div></figure><p id="292b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">当剩下两个联系类型时，𝑃(2活着|联系类型获胜)是联系类型获胜的<em class="lc">可能性</em>。等式右侧的所有项都可以使用我们的数据进行计算:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><pre class="mp mq mr ms gt mw mx my mz aw na bi"><span id="7db4" class="nb lf iq mx b gy nc nd l ne nf">0.27515169576151494</span></pre><p id="021f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">因此，当一轮中剩下两名CT玩家时，获胜概率从0.49下降到0.27。这是有道理的，因为CT玩家越少，CT赢得这一轮的可能性就越小。</p><h1 id="053a" class="le lf iq bd lg lh li lj lk ll lm ln lo jw lp jx lq jz lr ka ls kc lt kd lu lv bi translated">de_cache上还剩两个联系类型</h1><p id="3205" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">为了使我们的CT获胜概率更加真实，我们将扩大我们放入贝叶斯定理的证据数量。这里我们添加了各队正在比赛的地图，<code class="fe nn no np mx b">de_cache</code>。</p><p id="a328" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">假设这两个证据不相关(条件独立)，我们可以非常直接地扩展我们的公式。这里，除了两个联系类型处于活动状态的证据之外，我们还添加了我们在映射de_cache上使用的证据:</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nr"><img src="../Images/82e3bac4008673d24fd6c4f62bec891d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3hZhJtfWAZ2yLLRvsr8bmg.png"/></div></div></figure><p id="3eae" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">条件独立性的假设确保了新的似然𝑃(map可以以这种简单的方式被插入。这导致以下后验CT获胜概率:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><pre class="mp mq mr ms gt mw mx my mz aw na bi"><span id="f890" class="nb lf iq mx b gy nc nd l ne nf">0.48211252170893965</span></pre><p id="9192" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这表明，给定2个CT在缓存上处于活动状态时，CT获胜概率远远高于给定2个CT处于活动状态时的总体获胜概率，在本例中为0.48比0.27。</p><h1 id="97a0" class="le lf iq bd lg lh li lj lk ll lm ln lo jw lp jx lq jz lr ka ls kc lt kd lu lv bi translated">引入更多的证据</h1><p id="a0f0" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">添加更多的证据当然会使我们的估计更准确。为了让我们的代码更灵活一点(我是一个懒惰的程序员)，我写了一些帮助函数，它允许我们传递任何我们想要的证据，只要它是我们数据集的一部分:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><pre class="mp mq mr ms gt mw mx my mz aw na bi"><span id="dafd" class="nb lf iq mx b gy nc nd l ne nf">0.48211252170893965</span></pre><p id="424e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这表明，通过在字典中提供证据，我们可以在缓存图中获得两个活动联系类型的相同后验概率。有了这些更灵活的代码，我们可以更自由地开始试验。例如，在这里，我们计算了1v1情况下放置炸弹前后的获胜概率:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="b419" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这表明，当炸弹是<em class="lc">而不是</em>放置时，获胜概率稍微偏向于T(CT为0.45)。这可能是因为T可以选择战斗发生的地点。当T成功放置炸弹时，概率会更有利于T。</p><h1 id="145d" class="le lf iq bd lg lh li lj lk ll lm ln lo jw lp jx lq jz lr ka ls kc lt kd lu lv bi translated">炸弹工厂的更多细节</h1><p id="faaa" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">有了更灵活的代码，我们可以计算出更多的概率，包括剩下的CT玩家，剩下的T玩家，玩的地图以及炸弹是否被放置:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="95e9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">请注意，这段代码需要很长时间才能运行，而且肯定没有经过优化。</p><p id="1b06" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">从这一大组概率中，我们可以得出一些有趣的见解。例如，炸弹工厂如何影响CT获胜概率:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ns"><img src="../Images/b82dcf2262d4ba2f73afcb4017053e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7Q2oNL5jsJ36OpBZCbNhQ.png"/></div></div></figure><p id="2632" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">其中x轴是放置炸弹前的CT获胜概率<em class="lc">，y轴是放置炸弹后CT获胜概率的下降。在该图中，我们看到:</em></p><ul class=""><li id="da63" class="mb mc iq ki b kj kk km kn kp md kt me kx mf lb mg mh mi mj bi translated">一般来说，放置炸弹后，CT获胜的概率会下降</li><li id="0246" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">当CT已经有很高的输赢机会时，概率的变化就不大了</li><li id="1bc7" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">最大的变化发生在当联系类型的获胜概率在0.62左右时，下降到0.3左右。</li></ul><p id="e16e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">职业CS:GO的一个要点是，在获胜的概率非常均匀的情况下，让T的植物和游戏进行重拍是有风险的。</p><p id="93bb" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">为了扩大我们对炸弹工厂的探索，我绘制了双方存活玩家的数量，以及在瓦片图中放置炸弹工厂前后的获胜概率:</p><figure class="mp mq mr ms gt mt"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nt"><img src="../Images/2d83b75a3eccfcef762705901ef638ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5zkOfGB08zgNt--fu7UM7g.png"/></div></div></figure><p id="204e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有趣的是:</p><ul class=""><li id="3178" class="mb mc iq ki b kj kk km kn kp md kt me kx mf lb mg mh mi mj bi translated">一般来说，5v5的获胜概率几乎是50/50。de_cache是一个例外，它在很大程度上依赖于CT。在较小的程度上，这也适用于裁减核武器和取消训练。</li><li id="650c" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">当少于三名CT或T玩家存活时，CT获胜概率发生最显著的变化。</li><li id="b34f" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">失去团队成员会降低每个团队的获胜概率。</li><li id="a4e3" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">正如我们在前面的图表中看到的，当T设法放置炸弹时，CT获胜的概率显著下降。</li></ul><h1 id="9d98" class="le lf iq bd lg lh li lj lk ll lm ln lo jw lp jx lq jz lr ka ls kc lt kd lu lv bi translated">有趣的前进方式</h1><p id="0e3e" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">本文中的方法仍然很简单，一些可能的有趣的改进途径可能是:</p><ul class=""><li id="d71e" class="mb mc iq ki b kj kk km kn kp md kt me kx mf lb mg mh mi mj bi translated">添加更多的变量。这确实是一个挑战，因为数据集在计算获胜百分比时会越来越分散。另外，有些变量不是范畴。我目前的方法需要这样，所以这些必须分类。这可以使用<code class="fe nn no np mx b">pd.cut</code>来完成。</li><li id="0ce1" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">超越条件独立的。现在我假设所有的证据都是有条件独立的，这通常是不正确的。使用一个<a class="ae ld" href="https://en.wikipedia.org/wiki/Bayesian_network" rel="noopener ugc nofollow" target="_blank">贝叶斯信念网络</a>我们可以整合各种证据之间的依赖关系。<a class="ae ld" href="https://machinelearningmastery.com/introduction-to-bayesian-belief-networks/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>用Python很好地介绍了BBN的。</li><li id="f2cf" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated">地图和CS:GO元数据的变化可能会使我目前用来计算概率的数据失效。要在实践中使用这样的系统，需要使用相关的最新数据，例如来自hltv.org的数据。理想情况下，将证据纳入贝叶斯定理的方法可能是有益的。例如，较旧的数据对最终数据的影响可能小于较新的数据。不过，我不确定如何在实践中实现这一点。</li></ul><h1 id="0377" class="le lf iq bd lg lh li lj lk ll lm ln lo jw lp jx lq jz lr ka ls kc lt kd lu lv bi translated">我是谁？</h1><p id="9ff7" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">我叫Paul Hiemstra，是荷兰的一名教师和数据科学家。我是科学家和软件工程师的混合体，对与数据科学相关的一切都有广泛的兴趣。你可以在medium上关注我，或者在LinkedIn上关注T4。</p><p id="c191" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如果你喜欢这篇文章，你可能也会喜欢我的其他一些文章:</p><ul class=""><li id="5b3a" class="mb mc iq ki b kj kk km kn kp md kt me kx mf lb mg mh mi mj bi translated"><a class="ae ld" rel="noopener" target="_blank" href="/mastering-data-science-is-not-learning-a-series-of-tricks-df66d8529c29">掌握数据科学并不是学习一系列技巧</a></li><li id="95a4" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated"><a class="ae ld" rel="noopener" target="_blank" href="/altair-plot-deconstruction-visualizing-the-correlation-structure-of-weather-data-38fb5668c5b1">牛郎星图解构:可视化气象数据的关联结构</a></li><li id="230f" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated"><a class="ae ld" rel="noopener" target="_blank" href="/advanced-functional-programming-for-data-science-building-code-architectures-with-function-dd989cc3b0da">面向数据科学的高级函数式编程:用函数运算符构建代码架构</a></li><li id="27cb" class="mb mc iq ki b kj mk km ml kp mm kt mn kx mo lb mg mh mi mj bi translated"><a class="ae ld" rel="noopener" target="_blank" href="/expanding-your-regression-repertoire-with-regularisation-903d2c9f7b28">通过规范化扩展您的回归曲目</a></li></ul></div></div>    
</body>
</html>