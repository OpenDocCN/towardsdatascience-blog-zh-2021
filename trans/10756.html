<html>
<head>
<title>A Simple Guide to Linear Regression using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行线性回归的简单指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-guide-to-linear-regression-using-python-7050e8c751c1?source=collection_archive---------3-----------------------#2021-10-18">https://towardsdatascience.com/a-simple-guide-to-linear-regression-using-python-7050e8c751c1?source=collection_archive---------3-----------------------#2021-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4493" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习机器学习的核心概念，同时在Python中构建线性回归模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/47ccbfcf491396ea9fe3b8d9c99c7fb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*quSxcHc0ib4nbtj7TFH6gw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c81f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个数据科学家应该学习的第一个机器学习算法之一是线性回归。这个简单的模型帮助我们掌握机器学习的核心概念，例如识别因变量和自变量，建立模型，以及理解模型背后的数学和统计学。</p><p id="fa4f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在Python中有两种进行线性回归的常用方法——使用statsmodel和sklearn库。两者都是很好的选择，各有利弊。</p><p id="7929" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本指南中，我将向您展示如何使用这两者进行线性回归，并且我们还将学习线性回归模型背后的所有核心概念。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="e02c" class="lz ma it lv b gy mb mc l md me"><strong class="lv iu">Table of Contents<br/></strong>1. <a class="ae mf" href="#8e94" rel="noopener ugc nofollow">What is Linear Regression?</a><br/>2. <a class="ae mf" href="#65ed" rel="noopener ugc nofollow">Linear Regression in Python</a><br/> - <a class="ae mf" href="#cbcb" rel="noopener ugc nofollow">The Data</a><br/>3. <a class="ae mf" href="#0e95" rel="noopener ugc nofollow">Linear Regression with Statsmodels</a><br/> - <a class="ae mf" href="#b74c" rel="noopener ugc nofollow">Simple Linear Regression</a><br/> - <a class="ae mf" href="#0fa8" rel="noopener ugc nofollow">Multiple Linear Regression</a><br/>4. <a class="ae mf" href="#894e" rel="noopener ugc nofollow">Linear Regression with sklearn</a><br/>5. <a class="ae mf" href="#ee7e" rel="noopener ugc nofollow">Python for Data Science Cheat Sheet (Free PDF)</a></span></pre><h1 id="8e94" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">什么是线性回归？</h1><p id="6fb1" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">线性回归是一种建模两个(简单线性回归)或多个变量(多元线性回归)之间关系的方法。在简单线性回归中，一个变量被视为预测变量或自变量，而另一个变量被视为结果变量或因变量。</p><p id="381b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是线性回归方程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/6bf3b073d30f0425225a7d6372987ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*vl0cIko5IdpbgaXrHEbQ7g.png"/></div></figure><p id="bcd7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中，<code class="fe nd ne nf lv b">y</code>为因变量(目标值)，<code class="fe nd ne nf lv b">x1, x2, … xn</code>为自变量(预测值)，<code class="fe nd ne nf lv b">b0</code>为截距，<code class="fe nd ne nf lv b">b1, b2, ... bn</code>为系数，<code class="fe nd ne nf lv b">n</code>为观察值。</p><p id="2c0f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果等式不清楚，下面的图片可能会有所帮助。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b3ed5239834381742416a674ef58cc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*fX2OhWAD3-zV1HbgMyLVkw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">信用:<a class="ae mf" href="https://www.quora.com/What-does-regression-mean-in-statistics-and-machine-learning" rel="noopener ugc nofollow" target="_blank"> Quora </a></p></figure><p id="0585" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在图中，你可以看到一个线性关系。也就是说，如果一个自变量增加或减少，因变量也会增加或减少。</p><p id="761d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">线性回归可用于进行简单的预测，例如根据学习的小时数预测考试分数，根据工作经验预测员工的工资等等。</p><p id="9bd9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">理论够了！我们来学习一下如何用Python做一个线性回归。</p><h1 id="65ed" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">Python中的线性回归</h1><p id="cc91" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">在Python中有不同的方法进行线性回归。最受欢迎的两个选项是使用statsmodels和scikit-learn库。</p><p id="93fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，让我们看看我们将用来创建线性模型的数据。</p><h2 id="cbcb" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">数据</h2><p id="b51a" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">为了在Python中进行线性回归，我们将使用包含波士顿房价的数据集。原始数据集来自sklearn库，但我对其进行了简化，因此我们可以专注于构建我们的第一个线性回归。</p><p id="7fb4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在我的Github或者T2的Google Drive上下载这个数据集。确保将这个CSV文件放在Python脚本所在的目录中。</p><p id="49fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看这个数据集。为此，导入pandas并运行下面的代码。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="14a8" class="lz ma it lv b gy mb mc l md me"><strong class="lv iu">import pandas as pd</strong><br/>df_boston = pd.read_csv('Boston House Prices.csv')<br/>df_boston</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/c642c3b9c38326249dc88153cf439bd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*uWN6J5QR7Jp8LqNwW85T1A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="381f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有3列。“价值”列包含以1000美元为单位的自住房屋的中值(这是我们想要预测的，也就是我们的目标值)。“房间”和“距离”列包含每个住所的平均房间数和到五个波士顿就业中心的加权距离(两者都是预测值)</p><p id="e5bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">综上所述，我们希望根据房屋的房间数量及其到就业中心的距离来预测房屋价值。</p><h1 id="0e95" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">带统计模型的线性回归</h1><p id="ca92" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">Statsmodels是一个帮助我们进行统计测试和估计模型的模块。它为每个估计量提供了一个广泛的结果列表。</p><p id="a438" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您已经通过Anaconda安装了Python，那么您已经安装了statsmodels。如果没有，你可以用conda或者pip安装。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="b364" class="lz ma it lv b gy mb mc l md me"># pip<br/>pip install statsmodels</span><span id="f2a4" class="lz ma it lv b gy nt mc l md me"># conda<br/>conda install -c conda-forge statsmodels</span></pre><p id="8d8e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦安装了statsmodel，就用下面的代码行导入它。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="d81c" class="lz ma it lv b gy mb mc l md me"><strong class="lv iu">import statsmodels.api as sm</strong></span></pre><p id="a8e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建线性回归之前要做的第一件事是定义因变量和自变量。我们已经在前一节讨论过了。因变量是我们想要预测的值，也称为目标值。另一方面，自变量是预测因子。</p><p id="d3c0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的数据集中，我们有2个预测，所以我们可以使用其中任何一个或两个。</p><p id="f9ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从简单的线性回归开始。简单的线性回归估计一个自变量<strong class="la iu">和一个因变量</strong>之间的关系。</p><h2 id="b74c" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">简单线性回归</h2><p id="a619" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">对于这个例子，我将选择“房间”作为我们的预测/独立变量。</p><ul class=""><li id="6626" class="nu nv it la b lb lc le lf lh nw ll nx lp ny lt nz oa ob oc bi translated">因变量:“值”</li><li id="fe8c" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">自变量:“房间”</li></ul><p id="81a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们也在代码中定义因变量和自变量。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="80b3" class="lz ma it lv b gy mb mc l md me">y = df_boston['Value'] # dependent variable<br/>x = df_boston['Rooms'] # independent variable</span></pre><p id="5fec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本指南中，我将使用线性代数符号——小写字母用于向量，大写字母用于矩阵。</p><p id="c8f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">拟合模型<br/> </strong>现在该拟合模型了。为了向您解释拟合模型的含义，请考虑以下用于简单线性回归的通用方程。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="2244" class="lz ma it lv b gy mb mc l md me">𝑦 = 𝑎𝑥 + 𝑏</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b3ed5239834381742416a674ef58cc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*fX2OhWAD3-zV1HbgMyLVkw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">信用:<a class="ae mf" href="https://www.quora.com/What-does-regression-mean-in-statistics-and-machine-learning" rel="noopener ugc nofollow" target="_blank"> Quora </a></p></figure><p id="d28b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">拟合模型意味着找到<code class="fe nd ne nf lv b">a</code>和<code class="fe nd ne nf lv b">b</code>的最优值，因此我们获得一条最适合数据点的线。拟合良好的模型会产生更准确的结果，因此只有在拟合模型之后，我们才能使用预测值来预测目标值。</p><p id="534a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们使用statsmodels拟合一个模型。首先，我们在拟合模型之前添加一个常数(sklearn默认添加它),然后我们使用。fit()方法。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="5fa1" class="lz ma it lv b gy mb mc l md me">x = sm.add_constant(x1) # adding a constant<br/>lm = sm.OLS(y,x).fit() # fitting the model</span></pre><p id="2fe2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“lm”代表线性模型，代表我们的拟合模型。这个变量将帮助我们预测我们的目标值。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="9ab8" class="lz ma it lv b gy mb mc l md me">&gt;&gt;&gt; lm.predict(x)</span><span id="49e8" class="lz ma it lv b gy nt mc l md me">0      25.232623<br/>1      24.305975<br/>2      31.030253<br/>3      29.919727<br/>4      31.231138<br/>         ...    <br/>501    24.603318<br/>502    20.346831<br/>503    27.822178<br/>504    26.328552<br/>505    19.661029</span></pre><p id="18ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的代码根据“房间”列中的数据预测房屋价值(打印输出)。</p><h2 id="07d1" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">回归表</h2><p id="05bb" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">虽然我们可以预测目标值，但是分析还没有完成。我们需要知道这个线性模型的表现。回归表可以帮助我们解决这个问题。该表提供了一个结果的详细列表，揭示了我们的模型有多好/多差。</p><p id="1efc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要获得回归表，请运行以下代码:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="89f4" class="lz ma it lv b gy mb mc l md me">lm.summary()</span></pre><p id="03c9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您将获得此表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/2aafc9745f23af252489050fe7ddf55e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*pJefjuhxyZ2rP4Y7zsOQPA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8261" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个表格的标题是“OLS回归结果”OLS代表普通最小二乘法，这是估计线性回归最常用的方法。</p><p id="5f18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看第一和第二个表中的一些重要结果。</p><ul class=""><li id="532f" class="nu nv it la b lb lc le lf lh nw ll nx lp ny lt nz oa ob oc bi translated">离开变量:这是因变量(在我们的例子中,“值”是我们的目标值)</li><li id="900f" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">r平方:取0到1之间的值。接近0的r平方值对应于解释不了任何数据可变性的回归，而接近1的值对应于解释数据全部可变性的回归。<strong class="la iu">获得的r平方告诉我们，房间数量解释了房屋价值变化的48.4%。</strong></li><li id="de96" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">Coef:这些是我们之前在模型方程中看到的系数(a，b)。</li><li id="f5e2" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">标准误差:表示预测的准确性。标准误差越低，预测越好。</li><li id="201c" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">t，P&gt;t (p值):t分数和P值用于假设检验。“房间”变量具有统计学显著性p值。此外，我们可以在95%的置信度下说“房间”的值在8.279到9.925之间。</li></ul><p id="a82d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">线性回归方程<br/> </strong>根据上表，让我们使用系数(coef)创建线性方程，然后用数据点绘制回归线。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="3ce0" class="lz ma it lv b gy mb mc l md me"># Rooms coef: 9.1021<br/># Constant coef: - 34.6706</span><span id="065e" class="lz ma it lv b gy nt mc l md me"># Linear equation: 𝑦 = 𝑎𝑥 + 𝑏<br/>y_pred = 9.1021 * x['Rooms'] - 34.6706</span></pre><p id="0287" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中y_pred(也称为yhat)是回归方程中y(因变量)的预测值。</p><p id="403e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">线性回归图<br/> </strong>为了绘制方程，我们使用seaborn。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="9040" class="lz ma it lv b gy mb mc l md me"><strong class="lv iu">import seaborn as sns<br/>import matplotlib.pyplot as plt</strong></span><span id="2469" class="lz ma it lv b gy nt mc l md me"># plotting the data points<br/>sns.scatterplot(x=x['Rooms'], y=y)</span><span id="8fd7" class="lz ma it lv b gy nt mc l md me">#plotting the line<br/>sns.lineplot(x=x['Rooms'],y=y_pred, color='red')</span><span id="fcfa" class="lz ma it lv b gy nt mc l md me">#axes<br/>plt.xlim(0)<br/>plt.ylim(0)<br/>plt.show()</span></pre><p id="8dad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的代码产生了下面的图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/0b685b2e2ad262418cbe21eb7d33cea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KNHgCdhUPalmx3F8Bf-w2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="60d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">红色的图是我们用Python构建的线性回归。我们可以说这是最符合蓝色数据点的线。</p><p id="619c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">恭喜你！您刚刚在Python中构建了第一个简单的线性回归。如果你准备迎接挑战，看看如何进行多元线性回归。</p><h2 id="0fa8" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">多元线性回归</h2><p id="ca86" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">现在你已经知道了线性回归的核心概念，我们可以很容易地创建一个多元线性回归。</p><p id="880e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从设置因变量和自变量开始。在这种情况下，我们将使用2个独立变量。</p><ul class=""><li id="f4c2" class="nu nv it la b lb lc le lf lh nw ll nx lp ny lt nz oa ob oc bi translated">因变量:“值”</li><li id="2952" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">自变量:“房间”和“距离”</li></ul><p id="e32b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们也在代码中定义因变量和自变量。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="1e16" class="lz ma it lv b gy mb mc l md me">y = df_boston['Value'] # dependent variable<br/>X = df_boston[['Rooms', 'Distance']] # independent variable</span></pre><p id="43a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们添加一个常数并拟合模型。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="4d5d" class="lz ma it lv b gy mb mc l md me">X = sm.add_constant(X) # adding a constant<br/>lm = sm.OLS(y, X).fit() # fitting the model</span></pre><p id="343b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看结果。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="ea8c" class="lz ma it lv b gy mb mc l md me">lm.summary()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/8fb5d50799901db0337df66a24e97149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*LUvDB2837vHau-zd9Bx8iw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b76a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">r平方增加了一点。此外，在第二个表中有一个新行代表“距离”变量的参数。该表的分析类似于简单的线性回归，但如果您有任何问题，请随时在评论部分告诉我。</p><h2 id="894e" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">使用sklearn进行线性回归</h2><p id="a062" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">Scikit-learn是Python中的标准机器学习库，它还可以帮助我们进行简单的线性回归或多元线性回归。</p><p id="877a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于之前我们已经用statsmodels深入分析了简单线性回归，现在我们用sklearn做一个多元线性回归。</p><p id="57a6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们来安装sklearn。如果您已经通过Anaconda安装了Python，那么您已经安装了sklearn。如果没有，你可以用conda或者pip安装。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="b3f2" class="lz ma it lv b gy mb mc l md me"># pip<br/>pip install scikit-learn</span><span id="9bae" class="lz ma it lv b gy nt mc l md me"># conda<br/>conda install -c conda-forge scikit-learn</span></pre><p id="5a7d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们从sklearn库中导入linear_model。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="b718" class="lz ma it lv b gy mb mc l md me"><strong class="lv iu">from sklearn import linear_model</strong></span></pre><p id="5497" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因变量和自变量如下。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="adbb" class="lz ma it lv b gy mb mc l md me">y = df_boston['Value'] # dependent variable<br/>X = df_boston[['Rooms', 'Distance']] # independent variable</span></pre><p id="6590" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们必须拟合模型(注意，使用sklearn的fit方法中的参数顺序与statsmodels不同)</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="7bd7" class="lz ma it lv b gy mb mc l md me">lm = linear_model.LinearRegression()<br/>lm.fit(X, y) # fitting the model</span></pre><p id="a316" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">与statsmodels类似，我们使用predict方法来预测sklearn中的目标值。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="977d" class="lz ma it lv b gy mb mc l md me">lm.predict(X)</span></pre><p id="100f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，与statsmodels不同，我们不会使用<code class="fe nd ne nf lv b">.summary()</code>得到一个汇总表。相反，我们必须逐个调用每个元素。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="0465" class="lz ma it lv b gy mb mc l md me">&gt;&gt;&gt; lm.score(X, y)<br/>0.495</span><span id="1291" class="lz ma it lv b gy nt mc l md me">&gt;&gt;&gt; lm.coef_<br/>array([8.80141183, 0.48884854])</span><span id="ccde" class="lz ma it lv b gy nt mc l md me">&gt;&gt;&gt; lm.intercept_<br/>-34.636050175473315</span></pre><p id="0136" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">结果与我们使用statsmodels获得的表格相同。</p><p id="5f67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，为了简单起见，我们没有将数据分为训练和测试。在构建模型之前拆分数据是一种避免过度拟合的流行方法。这将是未来文章的主题，请继续关注！</p><p id="8751" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样！您刚刚学习了如何在Python中进行简单的多元线性回归。你可以在我的<a class="ae mf" href="https://github.com/ifrankandrade/model-building.git" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到本指南中写的所有代码。</p><div class="ol om gp gr on oo"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-text-classification-with-scikit-learn-632357e16f3a"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">Scikit-Learn简单指南—用Python构建机器学习模型</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">Python中的第一个ML模型。</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">towardsdatascience.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ks oo"/></div></div></a></div></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><p id="ee7e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae mf" href="https://frankandrade.ck.page/bd063ff2d3" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">与3k以上的人一起加入我的电子邮件列表，获取我在所有教程中使用的Python for Data Science备忘单(免费PDF) </strong> </a></p><p id="a5f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你使用<a class="ae mf" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="ol om gp gr on oo"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="ox l"><div class="pk l oz pa pb ox pc ks oo"/></div></div></a></div></div></div>    
</body>
</html>