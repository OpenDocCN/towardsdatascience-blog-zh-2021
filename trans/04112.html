<html>
<head>
<title>Five ways to work seamlessly between R and Python in the same project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在同一个项目中实现R和Python无缝协作的五种方式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/five-ways-to-work-seamlessly-between-r-and-python-in-the-same-project-bf173e35fdef?source=collection_archive---------8-----------------------#2021-04-07">https://towardsdatascience.com/five-ways-to-work-seamlessly-between-r-and-python-in-the-same-project-bf173e35fdef?source=collection_archive---------8-----------------------#2021-04-07</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><div class=""><h2 id="7daf" class="pw-subtitle-paragraph js iu iv bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">现在很容易同时使用两种语言来获得最佳效果</h2></div><p id="5191" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">最近我发现自己同时使用R和Python做了更多的项目。对我来说，在工作中使用最好的工具，不受单一语言的限制变得越来越重要。有些事情Python做得最好，有些事情R做得最好，所以如果我们能在需要的时候使用这两者，我们就能做到最好。在最近的一个<a class="ae lg" rel="noopener" target="_blank" href="/generating-parameterized-powerpoint-documents-in-python-and-r-333368479038">例子</a>中，我想创建一个闪亮的应用程序来生成参数化的Powerpoint文档，并想用R编写我的数据处理代码以利用tidyverse，但使用Python编写Powerpoint编辑代码，这在<code class="fe lh li lj lk b">python-pptx</code>包中很容易。</p><p id="9a45" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">现在，在RStudio IDE中使用这两种语言非常容易。要做到这一点，您需要在r中安装并加载<code class="fe lh li lj lk b">reticulate</code>包。以下是您可以做的五件事，让您在同一个项目中使用两种语言进行无缝编码:</p><h2 id="7286" class="ll lm iv bd ln lo lp dn lq lr ls dp lt kt lu lv lw kx lx ly lz lb ma mb mc md bi translated">1.在项目启动时定义Python环境</h2><p id="c5cd" class="pw-post-body-paragraph kk kl iv km b kn me jw kp kq mf jz ks kt mg kv kw kx mh kz la lb mi ld le lf io bi translated">为了避免与使用错误的Python解释器相关的任何问题，您可以在项目启动时通过创建一个<code class="fe lh li lj lk b">.Rprofile</code>文件并将其保存在项目目录中来定义您的Python环境。您的<code class="fe lh li lj lk b">.Rprofile</code>包含每当您的项目启动时将被执行的代码。我的<code class="fe lh li lj lk b">.Rprofile</code>里通常有这两行代码:</p><pre class="mj mk ml mm gt mn lk mo mp aw mq bi"><span id="3b8e" class="ll lm iv lk b gy mr ms l mt mu">Sys.setenv(RETICULATE_PYTHON = "&lt;path&gt;")</span><span id="bf2a" class="ll lm iv lk b gy mv ms l mt mu">print(paste("Python environment forced to", Sys.getenv("RETICULATE_PYTHON")))</span></pre><p id="85d8" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">其中<code class="fe lh li lj lk b">&lt;path&gt;</code>是您希望使用的Python环境中的<em class="mw"> Python可执行文件</em>的路径。第一个命令将其设置为python可执行文件。第二个命令打印一个确认信息，每次启动项目时都会显示在您的终端上。当我开始一个项目时，我的终端看起来是这样的:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi mx"><img src="../Images/6fe21a5115b57b3344fe63d5d498781f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VqyiALd4SHUTnlKQPexDQw.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><h2 id="941d" class="ll lm iv bd ln lo lp dn lq lr ls dp lt kt lu lv lw kx lx ly lz lb ma mb mc md bi translated">2.使用<code class="fe lh li lj lk b">repl_python()</code>在Python中实时编码</h2><p id="3722" class="pw-post-body-paragraph kk kl iv km b kn me jw kp kq mf jz ks kt mg kv kw kx mh kz la lb mi ld le lf io bi translated">在构建项目时，您需要测试Python代码和R代码。<code class="fe lh li lj lk b">reticulate</code>包中的<code class="fe lh li lj lk b">repl_python()</code>函数将您的R终端切换到Python终端，这样您就可以用Python实时编码了。您可以使用<code class="fe lh li lj lk b">exit</code>命令退出，然后用R编写更多的代码，然后如果您返回到Python终端，它仍然会记住上次会话的所有对象，这意味着可以很容易地在语言之间无缝切换。这里有一个简单的例子:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nj"><img src="../Images/05f319d916c4198040d15d3389d8499e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOMNDgyLeazJBYSQ2Qgm8A.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><h2 id="d49e" class="ll lm iv bd ln lo lp dn lq lr ls dp lt kt lu lv lw kx lx ly lz lb ma mb mc md bi translated">3.在Python和R之间交换对象</h2><p id="cc0a" class="pw-post-body-paragraph kk kl iv km b kn me jw kp kq mf jz ks kt mg kv kw kx mh kz la lb mi ld le lf io bi translated">任何相当标准的数据对象，比如值、列表和数据帧，都可以在Python和R之间交换。要在R中使用名为<code class="fe lh li lj lk b">my_python_object</code>的Python对象，可以使用<code class="fe lh li lj lk b">py$my_python_object</code>来调用它。下面是另一个例子，我将来自R的<code class="fe lh li lj lk b">mtcars</code>数据集引入Python:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nk"><img src="../Images/71cbdf64a207f6635077bf8c7de47b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qaEMEheYaw2N-ypCTtH9mQ.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><p id="deba" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">数据对象将被翻译成不同语言的等价结构。例如，R中的列表将被翻译成Python中的dict:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nl"><img src="../Images/37b4934755877103683b387d8c2a4c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HFPoq7W0fQdP_HuUtPvsYQ.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><h2 id="dc91" class="ll lm iv bd ln lo lp dn lq lr ls dp lt kt lu lv lw kx lx ly lz lb ma mb mc md bi translated">4.将Python函数转换成R函数</h2><p id="1aff" class="pw-post-body-paragraph kk kl iv km b kn me jw kp kq mf jz ks kt mg kv kw kx mh kz la lb mi ld le lf io bi translated">当您同时使用这两种语言时，您最终需要将Python代码作为R中的一个函数来执行。如果您将Python函数编写到一个文件中，然后使用<code class="fe lh li lj lk b">source_python()</code>将该文件转换为R中的源代码，那么您的Python函数就变成了一个R函数，供您在需要时使用。下面是一个简单的例子，我编写了一个Python函数将两个数字相加并保存在文件<code class="fe lh li lj lk b">sumof.py</code>中:</p><pre class="mj mk ml mm gt mn lk mo mp aw mq bi"><span id="0fe6" class="ll lm iv lk b gy mr ms l mt mu">def sumof(a, b):<br/>  return a+b</span></pre><p id="3f57" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">现在我可以对<code class="fe lh li lj lk b">sumof.py</code>进行source，它变成了and R函数:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nm"><img src="../Images/2524755b9f3d1e389b8ee8e08fa2b7d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e4VNAUTIaRo0oj_hrOf6lQ.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><h2 id="64d0" class="ll lm iv bd ln lo lp dn lq lr ls dp lt kt lu lv lw kx lx ly lz lb ma mb mc md bi translated">5.编写介于R和Python之间的R Markdown文档</h2><p id="fdea" class="pw-post-body-paragraph kk kl iv km b kn me jw kp kq mf jz ks kt mg kv kw kx mh kz la lb mi ld le lf io bi translated">通过适当地设置您的<code class="fe lh li lj lk b">.Rprofile</code>,您可以创建具有两种语言的代码块的文档，并且您可以在代码块之间交换对象。下面是一些简单的R Markdown代码来演示这一点:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nn"><img src="../Images/cb0bf6f20a3f593a4380bf666a4ff4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hYb3rv_4PjhdJKWZvg_ig.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><p id="1090" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这会产生以下输出:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi no"><img src="../Images/49ce3f26767e11c53f0d7bbaa7c03a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8DFTu7Ci-y0Iav8EB1DXtQ.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><p id="6a94" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">同样，您可以用一种语言编写函数，并在另一种语言中轻松使用它们:</p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi np"><img src="../Images/dcde784c91c1d486f9504d231490408d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NURJlgXdMQu7pZbUItNAAA.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">作者生成的剪切屏幕</p></figure><p id="d081" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">对我来说，这个功能让我的工作变得可能。我希望这些技巧能帮助你开始探索Python和R所能提供的最好的东西。</p></div><div class="ab cl nq nr hz ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="io ip iq ir is"><p id="4925" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">最初我是一名纯粹的数学家，后来我成为了一名心理计量学家和数据科学家。我热衷于将所有这些学科的严谨性应用到复杂的人的问题上。我也是一个编码极客和日本RPG的超级粉丝。在<a class="ae lg" href="https://www.linkedin.com/in/keith-mcnulty/" rel="noopener ugc nofollow" target="_blank"><em class="mw">LinkedIn</em></a><em class="mw">或</em><a class="ae lg" href="https://twitter.com/dr_keithmcnulty" rel="noopener ugc nofollow" target="_blank"><em class="mw">Twitter</em></a><em class="mw">上找我。也可以看看我在</em><a class="ae lg" href="http://drkeithmcnulty.com/" rel="noopener ugc nofollow" target="_blank"><em class="mw">drkeithmcnulty.com</em></a><em class="mw">上的博客。</em></p><figure class="mj mk ml mm gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nx"><img src="../Images/c7e765f4bcedd431d6e3d074ffc2dc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t6QwyIpez1oLPRzMHLGvnA.jpeg"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">unsplash.com的好意</p></figure></div></div>    
</body>
</html>