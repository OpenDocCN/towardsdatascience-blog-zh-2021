<html>
<head>
<title>Calculate Metrics from the Logs of Your Activity Tracker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从活动跟踪器的日志中计算指标</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/calculate-metrics-from-the-logs-of-your-activity-tracker-4e84437c3b3b?source=collection_archive---------40-----------------------#2021-08-31">https://towardsdatascience.com/calculate-metrics-from-the-logs-of-your-activity-tracker-4e84437c3b3b?source=collection_archive---------40-----------------------#2021-08-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3551" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">计算距离，速度和海拔增益从您的活动跟踪器的日志</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a77507fcadf0522f0525161caa11af8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KghuCdYV3nrxWsR8"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">弗兰克·布施在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="94cc" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="0fcc" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">前一篇文章描述了如何从你的活动跟踪器或应用程序导入日志文件。我们还创建了一个热图，显示地图上的轨迹。本文将向您展示如何从gpx日志文件中计算一些基本指标，如行驶距离、速度和方位。一些活动记录器将这些信息存储在日志文件中，但大多数不这样做。</p><h2 id="a2c9" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">计算行驶距离</h2><p id="ac3b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">从日志文件中计算旅行的距离听起来很简单。测井记录由一系列经度/纬度位置组成，因此计算所有时间之间的距离，并将这些时间相加，即可得出行进的距离。但是计算两个经度/纬度位置之间的距离很繁琐，即使是很短的距离。</p><p id="112e" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们将尝试几种方法来找到速度和准确性之间的平衡。您可能已经猜到，与低精度相比，高精度需要更多的计算。我们将把上一篇文章中的数据框架用于所有活动，并过滤掉一个:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="aab9" class="kz la it mu b gy my mz l na nb">df = df[df.name == 'XXXXX'].reset_index(drop=True)<br/>df = df[['timestamp', 'lat', 'lon', 'elevation']]</span></pre><p id="4e81" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在这种情况下，我们根据名称过滤一个活动，但也可以使用源文件或开始日期和/或时间。</p><h2 id="5328" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">平坦的地球</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="26fa" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">用lon/lat计算距离需要一些三角学知识。三角函数以弧度作为输入。gpx文件将经度和纬度存储为度数，因此我们首先添加(第4–5行)以弧度表示的经度和纬度。</p><p id="303f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为每个距离公式创建一个名为<code class="fe ne nf ng mu b">dist_xxxx</code>的方法，计算结果将存储在名为<code class="fe ne nf ng mu b">dist_xxxx</code>的列中。第14行循环所有的实现(到目前为止只有一个)，第16行创建列an，在第一行存储<code class="fe ne nf ng mu b">0</code>。第17–19行调用距离函数，将当前位置和先前位置作为参数。结果存储在适当的列中。第20行根据距离公式打印行驶的总距离。</p><p id="623a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">第一个实现假设两点之间的距离是一条直线(<a class="ae ky" href="https://en.wikipedia.org/wiki/Pythagorean_theorem" rel="noopener ugc nofollow" target="_blank">勾股定理</a>)。它没有考虑到当你靠近其中一个极点时，经线会彼此靠近。假设这些线平行，经度为1度，距离为110.25公里。计算很简单，但即使在短距离内，误差也相对较大。结果是10.8公里。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="75cf" class="kz la it mu b gy my mz l na nb">flat             : 10864.7117</span></pre><h2 id="51c3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">地球是一个球体</h2><p id="642d" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">一个简单的改进是假设地球是一个完美的球体。当你越靠近两极，两条经线之间的距离就越小。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/aa3c92f702d5fc9cf00c6f63d6138291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VqFqfRWofeZjKmh_Nww-Lw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">纬度和经度(来源:<a class="ae ky" href="https://en.wikipedia.org/wiki/Geographic_coordinate_system" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><p id="331d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这个距离取决于所在位置的纬度。在赤道是110公里，但在两极是0公里。通过将110 km乘以纬度的余弦，应用球体形状(0度的余弦为1，90度的余弦为0)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="22e4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">活动日志每隔几秒钟存储一次位置。看起来这些距离的误差可能很小，但是总距离变化很大:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bc83" class="kz la it mu b gy my mz l na nb">flat             : 10864.7117<br/>sphere           :  8057.7413</span></pre><p id="86e5" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">差别是惊人的26%，但这种差别取决于我活动的纬度。如果在赤道附近记录到这种活动，它将接近于0。根据上面的结果，你可以计算出该活动是在纬度50度附近记录的。所以要小心，由于信息量有限，活动的位置从地球上的某个地方缩小到纬度约为50度的范围内。</p><h2 id="438c" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">地球是椭球体</h2><p id="efe8" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">那么地球是球体吗？不，它不是，它是一个椭球体。赤道的半径(“水平”)是6378公里，从极点到极点的半径(“垂直”)是6356公里。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/3bdac1535c9fba26731c6ab4eb7f2bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/0*Svjjp4HxSSS8c1Pk.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">椭圆计算(来源:<a class="ae ky" href="https://en.wikipedia.org/wiki/Reference_ellipsoid" rel="noopener ugc nofollow" target="_blank">维基百科</a>)</p></figure><p id="43d5" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">FCC已经定义了<a class="ae ky" href="https://en.wikipedia.org/wiki/Geographical_distance" rel="noopener ugc nofollow" target="_blank">公式</a>来计算两点之间的距离，其中考虑了这个椭球体形式:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="b6af" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">地球的小椭球形对计算的距离有影响:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4656" class="kz la it mu b gy my mz l na nb">flat             : 10864.7117<br/>sphere           :  8057.7413<br/>ellipsoid        :  8143.150109</span></pre><h2 id="d426" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">哈弗辛函数</h2><p id="ef25" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">哈弗辛函数是计算球体上两点间距离的另一种方法。最早的查找表形式的实现可以追溯到1805年。它是基于哈弗辛的<a class="ae ky" href="https://en.wikipedia.org/wiki/Haversine_formula" rel="noopener ugc nofollow" target="_blank">定律，该定律描述了两点之间的距离，该距离基于它们与网格原点一起形成的三角形。哈弗辛函数没有考虑地球的椭球形状。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="33b9" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">与其他实现相比的哈弗线距离:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ae82" class="kz la it mu b gy my mz l na nb">flat             : 10864.7117<br/>sphere           :  8057.7413<br/>ellipsoid        :  8143.1501<br/>haversine        :  8126.8135</span></pre><p id="275c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">还有更多像文森特的公式一样的计算方法。但是从这里我们将采用椭球体实现:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9ccd" class="kz la it mu b gy my mz l na nb">df = df[['timestamp', 'lat', 'lon', 'elevation', 'latrad', <br/>         'lonrad', 'dist_eucledian']]<br/>df = df.rename(columns={"dist_eucledian": "dist"})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/4b3904b85280705d35d48bf914bdbbd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IsMUaMclb7z9dGbcfzCj6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有距离栏的活动日志(图片由作者提供)</p></figure><h2 id="8252" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">计算速度</h2><p id="2f4e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">所以现在距离有了，就可以计算速度了。速度是距离除以时间，因此我们需要获得两个日志条目之间的时间，并将行驶距离除以该时间(速度单位为km/h):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="48df" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">那很简单…让我们想象一下结果:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ba0d" class="kz la it mu b gy my mz l na nb">df.speed.plot(figsize=(15,8))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/8d9f309fbdb58319ed37504612c3c6c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRhaqZygZyxTF2ZXPvB1zw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">速度随时间的变化(图片由auhtor提供)</p></figure><p id="1fd1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">的确，这好得令人难以置信。该图显示了一个行走活动，速度肯定不是恒定的，但它是可变的吗？不太可能。这是怎么回事？</p><p id="4d6c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">正如您在最后打印的数据帧中所看到的，每秒钟都会记录一次该位置。平均速度1.6米/秒。但是Garmin活动追踪器公认的精确度是3米<a class="ae ky" href="https://support.garmin.com/en-US/?faq=P3DdzRfgik3fky125aHsFA" rel="noopener ugc nofollow" target="_blank"/>。在实践中，它可以更精确，但会发生一些不准确，并且对于1米的预期位移，不准确性相对较高。在整个活动过程中，它会工作(见显示的平均速度5.1公里/小时)，但在这个详细的水平上不是那么好。</p><p id="0b51" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了过滤掉极端情况，我们将实现一个平均速度的策略。我们想要每30秒的平均速度。为了确定要平均的行数，我们首先确定数据集中两行之间的平均时间。用30除以这个数，我们得到要平均的行数。我们使用dataframe的<code class="fe ne nf ng mu b">rolling()</code>函数来创建移动平均值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/f499e1eab61968e8a809cbbbd924b8cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MBpXhB_3lNPfSpbv6KKMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">速度，移动平均线(图片由作者提供)</p></figure><p id="4d75" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这是速度的一个更好的表示。选择30秒是基于我的行走习惯。在旅途中，每个地点拍照大约需要30秒。使30秒的时间间隔更长会使识别这些停车点变得更加困难。</p><p id="9753" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在第一张图中，停车瞬间将速度降至零，30秒移动平均速度在行程后期降至1 km/h或3 km/h以下。</p><p id="6456" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">让我们看看滚动窗口大小的影响:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="e9f2" class="kz la it mu b gy my mz l na nb">df['speed_ma_10'] = df['speed'].rolling(window=10, <br/>                          min_periods=1, center=True).mean()<br/>df['speed_ma_30'] = df['speed'].rolling(window=30, <br/>                          min_periods=1, center=True).mean()<br/>df['speed_ma_60'] = df['speed'].rolling(window=60, <br/>                          min_periods=1, center=True).mean()<br/>df[500:1000][['speed_ma_10', 'speed_ma_30',<br/>              'speed_ma_60']].plot(figsize=(15,8))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/912c68635aa38788eb0e6cbf39d16278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDaHEek_m5sDicR9CZwFeg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多个滚动窗口(图片由作者提供)</p></figure><p id="8b55" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">滚动窗口越小，停止时刻越明显，但窗口越大，停止时刻越不明显。滚动窗口越大，图形越平滑。找到合适的窗口大小是准确性和可读性之间的平衡。对于我的使用，我把它保持在30秒，但是你需要根据你的规格来改变它。</p><p id="0ac6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">请注意，无法使用<code class="fe ne nf ng mu b">df.iloc[::30, :]</code>分割数据帧并在30行中保留1。行驶的距离将是不正确的，因为31和60之间的最短路径被用于计算速度，从而切断了路径上的所有拐角:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/4cb2d33a413a12e50e576bcce9e1e229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gABJStZFNT8SAWo_fIdyXg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分割数据帧对行驶距离的影响(图片由authot提供)</p></figure><h2 id="4f40" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">海拔</h2><p id="a95d" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">当确定上升和下降时，同样的问题出现了。由于高程数据的不准确性，分析原始高程数据会导致上升和下降数字较高:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/27a45a45b5aaef905744d01dc012afd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xlv9TZ5yb2orBCS1AGmAKQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">高程数据(图片由作者提供)</p></figure><p id="d366" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">总的上升和下降是用每行的高程平均值计算的，并对下降的负数和上升的正数求和:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="6dd5" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">与海拔高度和活动概况相比，上升和下降的数字较高。通过使用移动平均值平滑与速度相当的高程数据，可以提高这些值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="89d2" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">30秒移动平均值保持高程数据的形状，并过滤小的差异，正如您在高程数据的子集中看到的，滚动窗口由30、60和120行组成:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/5aaf0e4e2436da977655c68186510704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXErp6TKV0wvpETtKWoV2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">滚动窗口对高程数据的影响(图片由作者提供)</p></figure><h2 id="509c" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">最后的话</h2><p id="8ebd" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">使用活动跟踪器跟踪您的活动会产生一个包含位置和高度数据的详细数据文件。记录的数据包含一些(或大量)噪声，使得从数据中得出结论更加困难。在计算距离、速度和高度等指标之前，需要进行一些数据清理。</p><p id="6ca3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">使用简单的移动平均滤波器来平滑数据。也可以使用更复杂的滤波器，如<a class="ae ky" href="https://ipython-books.github.io/102-applying-a-linear-filter-to-a-digital-signal/" rel="noopener ugc nofollow" target="_blank"> FIR和Butterworth </a>。从数学的角度来看，这非常有趣，但解释起来要复杂得多(与移动平均线相比)。过滤后的数据不会有更好的价值。这些滤波器从信号中移除高频噪声，并且在噪声还包含模式时工作得最好。这在我们的活动数据中并非如此。当我们创建一个带有高频噪声的信号时，IFR滤波器将比移动平均效果更好:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="b3c5" class="kz la it mu b gy my mz l na nb">x = np.arange(0, np.pi, 0.05)<br/>y = np.sin(x) + 0.2*np.sin(x*40) + + 0.05*np.sin(x*80)</span><span id="ec46" class="kz la it mu b gy np mz l na nb">df = pd.DataFrame(y,x, columns=['y'])<br/>df = df.reset_index().rename(columns={'index': 'x'})</span><span id="7c49" class="kz la it mu b gy np mz l na nb">df['y_ma'] = df['y'].rolling(window=5, min_periods=1).mean()<br/>#FIR filter<br/>h = sg.get_window('triang', 5)<br/>fil = sg.convolve(df.y, h / h.sum())<br/>df['y_fir'] = fil[:len(df)]</span><span id="b4b2" class="kz la it mu b gy np mz l na nb">df.plot('x', ['y', 'y_ma', 'y_fir'], style=['--','-','-'])</span></pre><p id="c30a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">IFR滤波信号比移动平均值更接近原始正弦:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/011854e02b5843e6e7c3b9cc9c36d736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XTbmJyf5_dTaO9mUVEjSVw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">FIR滤波器在去除高频噪声方面更好(图片由作者提供)</p></figure><p id="e715" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">理解你的数据是成功的关键:-)。</p><p id="4469" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在你的活动日志文件中隐藏着更多的数据。我们将在下一篇文章中揭开它们的面纱。</p><p id="adb1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我希望你喜欢这篇文章。要获得更多灵感，请查看我的其他文章:</p><ul class=""><li id="66e7" class="nr ns it lx b ly mo mb mp li nt lm nu lq nv mn nw nx ny nz bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/create-a-heatmap-from-the-logs-of-your-activity-tracker-c9fc7ace1657">根据你的活动跟踪器的日志创建热图</a></li><li id="6506" class="nr ns it lx b ly oa mb ob li oc lm od lq oe mn nw nx ny nz bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/remove-personal-information-from-text-with-python-232cb69cf074">用Python删除文本中的个人信息</a></li><li id="8b53" class="nr ns it lx b ly oa mb ob li oc lm od lq oe mn nw nx ny nz bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/side-by-side-comparison-of-strings-in-python-b9491">Python中字符串的并排比较</a></li><li id="c645" class="nr ns it lx b ly oa mb ob li oc lm od lq oe mn nw nx ny nz bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/parallel-web-requests-in-python-4d30cc7b8989">使用Python实现并行web请求</a></li><li id="d2a4" class="nr ns it lx b ly oa mb ob li oc lm od lq oe mn nw nx ny nz bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/all-public-transport-leads-to-utrecht-not-rome-bb9674600e81">所有公共交通工具都通向乌得勒支，而不是罗马</a></li><li id="00b7" class="nr ns it lx b ly oa mb ob li oc lm od lq oe mn nw nx ny nz bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/visualization-of-travel-times-with-otp-and-qgis-3947d3698042">使用OTP和QGIS可视化行程时间</a></li></ul><p id="9014" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><em class="of">免责声明:本文包含的观点和意见仅归作者所有。</em></p></div></div>    
</body>
</html>