<html>
<head>
<title>GANILLA — Fantasy Enhanced</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">加尼拉——幻想增强版</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ganilla-fantasy-enhanced-d4918681820c?source=collection_archive---------22-----------------------#2021-08-07">https://towardsdatascience.com/ganilla-fantasy-enhanced-d4918681820c?source=collection_archive---------22-----------------------#2021-08-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="47dd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当人工智能和出色的插图画家携手点燃我们的想象力</h2></div><p id="6028" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">由</em> </strong> <a class="ae lc" href="https://medium.com/@liork.dagan" rel="noopener"> <strong class="kh ir"> <em class="lb">李奥达甘</em></strong></a><strong class="kh ir"><em class="lb"/></strong><a class="ae lc" href="https://medium.com/@lironsoffer" rel="noopener"><strong class="kh ir"><em class="lb">李龙索夫</em></strong></a><strong class="kh ir"><em class="lb"/></strong><a class="ae lc" href="https://medium.com/@dafna.mordechai" rel="noopener"><strong class="kh ir"><em class="lb">达芙娜</em></strong><strong class="kh ir"><em class="lb">。</em> </strong></a></p><p id="8b7f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在儿童故事中，世界充满了奇迹，疯狂的事情每天都在发生，你发现自己坐在人行道上靠近精灵或仙女也并不罕见。这种魔力在儿童书籍中栩栩如生，伴随着故事可以找到精彩的插图。但是如果机器可以为我们创造这种魔力呢？GANILLA 就是这样一个神经网络，在这篇博文中，我们将向你展示如何做到这一点！</p><h2 id="5bd8" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">什么是加尼拉？</h2><p id="061f" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">GANILLA是GAN ( <strong class="kh ir">生成对抗网络</strong>)的一种，它解决了儿童书籍插图领域的<strong class="kh ir">图像到图像的翻译问题</strong>。在实践中，当你提供一张照片给一个训练有素的GANILLA模型时，它会根据特定插图画家的风格输出输入图像的插图。<br/>在下图中，您可以在左侧看到一个输入图像，以及十个不同的输出图像——这是将输入图像输入到十个经过训练的模型的结果，每个模型都使用不同illustrator的数据进行训练。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/4f570afc34e37bbdaf2d0b7219b44df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nuvcuSUGEXjJtmPhmD4M0Q.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">行动中的加尼拉:一个输入图像，十个不同的输出结果，模仿不同的插图艺术家(图像来源:加尼拉的论文:<a class="ae lc" href="https://arxiv.org/abs/2002.05638v2" rel="noopener ugc nofollow" target="_blank"> arXiv:2002.05638v2 </a>)</p></figure><p id="0351" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然在加尼拉之前就有其他伟大的图像到图像的翻译模型，但这项工作有两个主要的创新点。虽然当前最先进的图像到图像翻译模型成功地传递了风格或内容，但是它们有时不能同时传递两者。在下面的图片中，你可以看到一个例子，其中GANILLA保留了原始输入照片的内容和所需插画师的风格。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mr"><img src="../Images/7b83307fc8974392de5c178d05249a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjgbrP6DrjNX4mK0U0aKjA.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">与CycleGAN和DualGan相比，GANILLA的两个输出示例(图片来源:GANILLA的论文:<a class="ae lc" href="https://arxiv.org/abs/2002.05638v2" rel="noopener ugc nofollow" target="_blank"> arXiv:2002.05638v2 </a>)</p></figure><p id="dfdd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了模型本身，本文还介绍了一种新的定量方法来评估图像到插图的模型。他们不是主观地评估图像，而是通过使用单独的分类器定义考虑内容和风格的指标来制定评估过程。</p><h1 id="ed1a" class="ms le iq bd lf mt mu mv li mw mx my ll jw mz jx lo jz na ka lr kc nb kd lu nc bi translated">用于不成对图像到图像翻译的数据集</h1><p id="2ba3" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">当处理图像到图像的翻译问题时，我们的数据可以是两种类型之一:成对图像或不成对图像。配对数据集是一个集合，其中每个输入图像都有一个预定义的输出图像。这是一种标记数据的形式。<a class="ae lc" href="https://www.kaggle.com/vikramtiwari/pix2pix-dataset" rel="noopener ugc nofollow" target="_blank"> pix2pix数据集</a>就是成对数据的一个例子。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nd"><img src="../Images/0b2a2f8eba87f1844adec527e38d00c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cl9SLrHufpOb94pvuayRDQ.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">来自<a class="ae lc" href="https://www.kaggle.com/vikramtiwari/pix2pix-dataset" rel="noopener ugc nofollow" target="_blank"> pix2pix数据集</a>的图像对示例</p></figure><p id="65bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不成对的数据集由来自两个不同域的两个图像池组成，它们之间没有标记，也没有预定义的相关性。领域之间的映射是一个无监督的学习问题。输入域是自然照片，预期输出域是儿童书籍插图。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ne"><img src="../Images/09bb2abd8321bc75cc629c654f047d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NvjVdwLnXDtTNAv6vqueHw.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">一个不成对的数据集:风景照片(第一排)和宫崎骏<strong class="bd nf"/>(第二排)的插图</p></figure><h1 id="80c6" class="ms le iq bd lf mt mu mv li mw mx my ll jw mz jx lo jz na ka lr kc nb kd lu nc bi translated">架构概述</h1><h2 id="584a" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">加尼拉发电机</h2><p id="3c8a" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">模型的核心是发电机。训练时，它将用于推理，即生成器将接收风景照片作为输入，并返回插图图像作为输出。<br/>发电机有两部分；下采样(编码)阶段基于ResNet，负责从原始图像中提取特征(输入图像内容)。上采样(解码)阶段是特征金字塔网络(FPN)，并且负责从先前提取的信息中创建输出图示(输出图像风格)。<br/>在GANILLA <a class="ae lc" href="https://theaisummer.com/skip-connections/" rel="noopener ugc nofollow" target="_blank">中实现的另一个概念是跳过连接</a>。它在下图中用蓝线表示，顾名思义，它连接模型的各个部分，但不是以直接的方式，而是通过跳过一些层，并在模型中不连续的层之间传输信息。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ng"><img src="../Images/81e3660825e78ddcd65e54e271b4770f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YQqKoiGp4No-ejodjWXU2w.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">加尼拉的发电机架构(图片来源:加尼拉的论文:<a class="ae lc" href="https://arxiv.org/abs/2002.05638v2" rel="noopener ugc nofollow" target="_blank"> arXiv:2002.05638v2 </a>)</p></figure><h2 id="e004" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">加尼拉的D <strong class="ak">是首席法官</strong></h2><p id="f131" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">与GAN模型一样，训练过程需要一个<strong class="kh ir">鉴别器</strong>来评估发电机输出的质量。从技术上来说，鉴别器是一种分类器，用于评估生成的图像是“真”还是“假”。<br/>随着发生器和鉴别器一起接受训练，两者的作用变得更好、更准确，发生器产生更高质量的图像，而鉴别器在区分真假图像方面变得更好。</p><p id="8103" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">加尼拉的鉴别器实现了<strong class="kh ir"> PatchGAN，</strong>一种在<a class="ae lc" href="https://arxiv.org/pdf/1611.07004v3.pdf" rel="noopener ugc nofollow" target="_blank"> pix2pix </a>论文中介绍的方法。PatchGAN鉴别器或马尔可夫鉴别器不将整个图像分类为真实或伪造，而是将图像分成NxN个片段，并分别对它们进行分类。鉴别器在图像上卷积运行，平均所有响应以提供结果。与对整个图像进行分类相比，PatchGAN鉴别器具有更少的参数，运行速度更快，同时实施更多的约束，以促进生成的图像中清晰的高频细节。</p><p id="3d6c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下图比较了不同n值的结果。发现70x70面片产生的结果最清晰，人眼可看到的拖尾伪影较少，但代价是空间和光谱维度(细节和色彩)的准确性较低。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nh"><img src="../Images/bc6e02e3de1f3961e7294c338f113fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gG7QemxZCbr6xwhzRThP0g.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">PatchGAN对于不同N值的结果(图片来源:pix 2 pix paper:<a class="ae lc" href="https://arxiv.org/abs/1611.07004v3" rel="noopener ugc nofollow" target="_blank">arXiv:1611.07004 v3</a>)</p></figure><h2 id="1cbe" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">无监督对偶学习</h2><p id="089c" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">为了从两个域的两组未标记图像中进行训练，GANILLA使用了在<a class="ae lc" href="https://arxiv.org/pdf/1704.02510.pdf" rel="noopener ugc nofollow" target="_blank"> DualGAN </a>论文中介绍的方法。受自然语言翻译双重学习的启发，该方法在训练过程中使用两对生成器和鉴别器。<br/>第一个也是主要的一个，G，是将用于推理的生成器。次要生成器F学习相反方向的映射:从目的域(Y，插图)到源域(X，风景照片)。用于训练的损失函数类似于<a class="ae lc" href="https://arxiv.org/pdf/1703.10593.pdf" rel="noopener ugc nofollow" target="_blank"> CycleGAN </a>纸上的损失函数。</p><h2 id="550f" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">损失函数与循环一致性和恒等性</h2><p id="5817" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">加尼拉的损失函数是几个值的和。其中两个是两台发电机的最小最大损耗(BCE)。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ni"><img src="../Images/0479773dfbdd65d1cd521031961262a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l_WNW497fFVvwwVb"/></div></div></figure><p id="cf8e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将辅助生成器F: Y → X训练成主生成器G: X → Y的反函数。这将通过两个损失函数来完成:</p><ul class=""><li id="592d" class="nj nk iq kh b ki kj kl km ko nl ks nm kw nn la no np nq nr bi translated"><strong class="kh ir">循环一致性损失:</strong> F(G(x)) ~ x和G(F(Y)) ~ Y由L1距离强制。</li><li id="7b13" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated"><strong class="kh ir">身份丢失:</strong> G(Y) = Y，F(X) = X也受L1距离的影响。</li></ul><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/e961cbd60387017f0290a1ac78c9175f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*N-9avVLvJVngWVP--UhYuQ.png"/></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">F(G(X)) ~ X的循环一致性性质的说明同样适用于G(F(Y)) ~Y</p></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/b04f72095aeb1c2ca610e9eae42487f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*UbDzhJGn3Kxu9iArI6DXMw.png"/></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">恒等性质的说明:G(Y) = Y，F(X) = X</p></figure><h1 id="be8a" class="ms le iq bd lf mt mu mv li mw mx my ll jw mz jx lo jz na ka lr kc nb kd lu nc bi translated">轮到我们了！</h1><p id="b55d" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">在阅读了加尼拉的论文并理解了架构之后，<strong class="kh ir">我们已经从头开始实现了它</strong>，并得到了我们的结果。我们使用相同的景观图像作为我们的源域。对于目的地领域，我们选择了宫崎骏<a class="ae lc" href="https://en.wikipedia.org/wiki/Hayao_Miyazaki" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"/></a>的作品，那是我们从网上刮下来的。我们的代码可以在这里找到，这里是我们的一些结果:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nz"><img src="../Images/41409cf21e147d99c45851951ccd4276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PH67577GfyEBWZRNEGVZWA.jpeg"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">我们实现加尼拉模型的例子。上面的图像是原始照片，下面的是模型输出的插图图像</p></figure><h1 id="8198" class="ms le iq bd lf mt mu mv li mw mx my ll jw mz jx lo jz na ka lr kc nb kd lu nc bi translated">轮到你了！</h1><p id="111e" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">想开始自己的深度学习副业？不确定从哪里开始？<br/> <a class="ae lc" href="https://medium.com/@liork.dagan/how-deep-is-your-love-or-how-to-choose-your-first-deep-learning-side-project-524f3700813d" rel="noopener">这篇博文只为你！</a></p><h2 id="ce38" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">想从GANILLA开始吗？</h2><p id="3d06" class="pw-post-body-paragraph kf kg iq kh b ki lw jr kk kl lx ju kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">以下是一些有用的网址:</p><ul class=""><li id="202a" class="nj nk iq kh b ki kj kl km ko nl ks nm kw nn la no np nq nr bi translated"><a class="ae lc" href="https://arxiv.org/abs/2002.05638" rel="noopener ugc nofollow" target="_blank">加尼拉纸</a>。</li><li id="6198" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">YouTube频道“<a class="ae lc" href="https://www.youtube.com/watch?v=-IbNmc2mTz4" rel="noopener ugc nofollow" target="_blank">两分钟论文</a>中关于它的概述。</li><li id="9d9e" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">加尼拉<a class="ae lc" href="https://github.com/giddyyupp/ganilla/blob/master/docs/datasets.md" rel="noopener ugc nofollow" target="_blank">数据集</a></li><li id="7c2d" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">我们实现论文的<a class="ae lc" href="https://github.com/liorkdagan-dev/ganilla" rel="noopener ugc nofollow" target="_blank"> GitHub </a>资源库。</li><li id="8ba2" class="nj nk iq kh b ki ns kl nt ko nu ks nv kw nw la no np nq nr bi translated">最初的<a class="ae lc" href="https://github.com/giddyyupp/ganilla/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>文件库。</li></ul></div></div>    
</body>
</html>