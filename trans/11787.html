<html>
<head>
<title>A Python Pandas Introduction to Excel Users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python熊猫对Excel用户的介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-python-pandas-introduction-to-excel-users-1696d65604f6?source=collection_archive---------2-----------------------#2021-11-24">https://towardsdatascience.com/a-python-pandas-introduction-to-excel-users-1696d65604f6?source=collection_archive---------2-----------------------#2021-11-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="54f7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从Excel迁移到Python之前您需要知道的核心概念</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ad9af606696b5cbb9af637b352f20551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r5QU4Ae67dWtRDfG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@hongqi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Bruce Hong </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="50ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas可能是用Python进行真实世界数据分析的最佳工具。它允许我们清理数据、争论数据、进行可视化等等。</p><p id="b6a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以把熊猫想象成一个超级强大的微软Excel。你可以在Excel中完成的大多数任务也可以在Pandas中完成，反之亦然。也就是说，熊猫在许多领域表现出色。</p><p id="1e5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在对Pandas的介绍中，我们将比较Pandas数据框架和Excel电子表格，学习创建数据框架的不同方法，以及如何制作数据透视表。</p><p id="e56f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:在学习熊猫之前，你应该知道至少了解Python的基础知识。如果你是Python的新手，<a class="ae ky" rel="noopener" target="_blank" href="/python-core-concepts-for-data-science-explained-with-code-decfff497674">看一下我做的这个指南</a>，马上就能开始使用Python。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e9dc" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">Table of Contents<br/></strong>1. <a class="ae ky" href="#f35d" rel="noopener ugc nofollow">Why Excel Users Should Learn Python/Pandas</a><br/>2. <a class="ae ky" href="#7ef2" rel="noopener ugc nofollow">Pandas DataFrames &amp; Excel Spreadsheets</a><br/>3. <a class="ae ky" href="#e7d4" rel="noopener ugc nofollow">How to Create a Dataframe</a><br/> - <a class="ae ky" href="#aed5" rel="noopener ugc nofollow">Creating a dataframe by reading an Excel/CSV file</a><br/> - <a class="ae ky" href="#1740" rel="noopener ugc nofollow">Creating a dataframe with arrays</a><br/> - <a class="ae ky" href="#dfa2" rel="noopener ugc nofollow">Creating a dataframe with a dictionary</a></span></pre><h1 id="f35d" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">Excel用户为什么要学习Python/Pandas</h1><p id="28da" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">数据清理、数据标准化、可视化和统计分析等任务可以在Excel和Pandas上执行。也就是说，Pandas比Excel有一些主要优势。仅举几个例子:</p><ul class=""><li id="6ca6" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">大小限制:Excel可以处理大约100万行，而Python可以处理数百万行(限制在于PC的计算能力)</li><li id="2fd2" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">复杂的数据转换:Excel中的内存密集型计算会导致工作簿崩溃。Python可以处理复杂的计算，没有任何大问题。</li><li id="5e7a" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">自动化:Excel不是为自动化任务而设计的。你可以创建一个宏或使用VBA来简化一些任务，但这是极限。然而，Python可以超越这一点，提供数百个免费库。</li><li id="61b0" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">跨平台能力:在Excel上，你可能会发现Windows和macOS中的公式不兼容。当与不将英语作为其Microsoft Excel版本默认语言的人共享Excel文件时，也会发生这种情况。相比之下，不管计算机上的操作系统或语言设置如何，Python代码都保持不变。</li></ul><p id="3f1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在向您展示如何用Pandas替换Excel(创建数据透视表、可视化等)之前，我将向您解释Pandas的核心概念。在整个指南中，我将提到Excel来提供一些示例，并将其与熊猫进行比较。Excel是最流行的电子表格，所以一些类比将帮助你快速掌握熊猫的概念。</p><p id="15d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><h1 id="7ef2" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">熊猫数据框架和Excel电子表格</h1><p id="4b2b" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">Pandas中的两个主要数据结构是序列和数据帧。第一个是一维数组，第二个是二维数组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9e7400efe0624397e5a4facf03c40ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*R0ANcBbeokdyEwJ6qyae_A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4255" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在熊猫中，我们主要处理数据帧。熊猫数据框架相当于Excel电子表格。熊猫数据框架——就像Excel电子表格一样——有两个维度或轴。</p><p id="a589" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据帧有行和列(也称为系列)。在数据框架的顶部，您将看到列的名称，在左侧是索引。默认情况下，熊猫的索引从0开始。</p><p id="679b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">行和列的交集称为数据值或简称为数据。我们可以存储不同类型的数据，如整数、字符串、布尔值等等。</p><p id="d6f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一张显示美国各州人口排名的数据图表。稍后我将向您展示创建这样一个数据帧的代码，但现在让我们来分析这个数据帧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/07ad6bc802a413c4563cd07860107884.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*muVMUPZowyGhxZIFBub6Vg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="64be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列名(州、人口和邮政)也称为特征，而每个行值称为观察值。我们可以说有3个特征和4个观察值。</p><p id="8a85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，单个列应该具有相同类型的数据。在我们的示例中，<code class="fe ns nt nu lw b">states</code>和<code class="fe ns nt nu lw b">postal</code>列只包含字符串，而population列只包含整数。当试图将不同的数据类型插入到一个列中时，我们可能会得到错误，所以要避免这样做。</p><p id="9dd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总结一下，这就是熊猫和Excel之间的术语翻译。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5c52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我们还没有谈论太多关于空单元格的内容，但是知道在Python中缺失数据用<code class="fe ns nt nu lw b">NaN</code>表示是有好处的，它代表“不是一个数字”。只要数据帧中有空值，就会看到一个<code class="fe ns nt nu lw b">NaN</code>。</p><h1 id="e7d4" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">如何创建数据框架</h1><p id="8413" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">创建数据帧有多种方法。我们可以通过读取Excel/CSV文件、使用数组以及字典来创建数据帧。</p><p id="b5be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在创建数据框架之前，要确保已经安装了Python和Pandas。如果你是Python的新手，你可以通过观看<a class="ae ky" href="https://youtu.be/n83J8cBytus" rel="noopener ugc nofollow" target="_blank">这个视频</a>来安装它。</p><p id="08fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装熊猫，在终端或命令提示符下运行命令<code class="fe ns nt nu lw b">pip install pandas </code>。如果您有Jupyter笔记本，您可以通过运行<code class="fe ns nt nu lw b">!pip install pandas</code>从代码单元安装它</p><h2 id="aed5" class="ma mb it bd mh nx ny dn ml nz oa dp mp li ob oc mr lm od oe mt lq of og mv oh bi translated">通过读取Excel/CSV文件创建数据帧</h2><p id="32da" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">毫无疑问，这是在熊猫身上创建数据帧最简单的方法。我们只需要导入pandas，使用read_csv()方法，并将Excel/CSV文件的名称写在括号内。</p><p id="b46f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来读一个包含世界各国GDP数据的CSV文件(你可以在这个<a class="ae ky" href="https://drive.google.com/drive/folders/12hFh6RPlX5bWzSqpoMvAeT94RCjCvHw5?usp=sharing" rel="noopener ugc nofollow" target="_blank">链接</a>上找到这个文件)</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="b638" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">import pandas as pd</strong><br/>df_gdp <strong class="lw iu">=</strong> pd<strong class="lw iu">.</strong>read_csv('gdp.csv')<br/>df_gdp</span></pre><p id="9617" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们将pandas重命名为“pd”这只是给熊猫命名的惯例。运行上面的代码后，您将看到下面的数据帧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/5f993047a20f8a9a03348b57530f204c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*Oh-im-uxv329USQBWgBzyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是创建数据框架所需的全部内容！现在你可以通过观看我下面的视频教程开始从这个数据框架创建一个数据透视表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj nw l"/></div></figure><h2 id="1740" class="ma mb it bd mh nx ny dn ml nz oa dp mp li ob oc mr lm od oe mt lq of og mv oh bi translated">用数组创建数据帧</h2><p id="cbfd" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">要创建带有数组的数据帧，我们需要首先导入Numpy。让我们导入这个库，并用随机数创建一个数组。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="978f" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">import numpy as np</strong><br/>data = np.array([[1, 4], [2, 5], [3, 6]])</span></pre><p id="f44a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说，如果您还不习惯使用Numpy，您可以使用列表符号创建相同的数组。在下一步创建数据帧时，结果将是相同的。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e681" class="ma mb it lw b gy mc md l me mf">data = [[1, 4], [2, 5], [3, 6]]</span></pre><p id="97f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建一个数据帧，我们导入pandas并使用<code class="fe ns nt nu lw b">.Dataframe()</code>方法。在括号内，我们可以添加<code class="fe ns nt nu lw b">index</code>和<code class="fe ns nt nu lw b">columns</code>参数来指定名称。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="72e1" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">import pandas as pd</strong><br/>df = pd.DataFrame(data, index=['row1', 'row2', 'row3'],<br/>                 columns=['col1', 'col2'])</span></pre><p id="2c26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ns nt nu lw b">df</code>是数据帧的标准名称。如果我们打印这个<code class="fe ns nt nu lw b">df</code>对象，我们得到如下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/7f8a8a8fe71ce7c65ea22b170eae9b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*x1Dw3XupxEhi7huAP_z8dw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="dfa2" class="ma mb it bd mh nx ny dn ml nz oa dp mp li ob oc mr lm od oe mt lq of og mv oh bi translated">用字典创建数据帧</h2><p id="65f3" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">我们也可以从字典中创建一个数据框架。这是我最喜欢的选择，因为字典可以让我们正确地组织数据。您可能还记得，字典由一个键和值组成。我们可以将列表设置为数据值，将键设置为列名。</p><p id="442d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在使用字典之前创建一个人口数据框架。首先，我们创建两个列表:州和人口。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6eab" class="ma mb it lw b gy mc md l me mf"># data used for the example (stored in lists)<br/>states = ["California", "Texas", "Florida", "New York"]<br/>population = [39613493, 29730311, 21944577, 19299981]</span></pre><p id="7923" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们创建一个字典，将字符串<code class="fe ns nt nu lw b">States</code>和<code class="fe ns nt nu lw b">Population</code>设置为键，将之前创建的列表设置为数据值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e69d" class="ma mb it lw b gy mc md l me mf"># Storing lists within a dictionary<br/>dict_states = {'States': states, 'Population': population}</span></pre><p id="299c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦创建了字典，创建dataframe就像使用<code class="fe ns nt nu lw b">.Dataframe()</code>方法一样简单，但是这次我们不需要指定列参数，因为它已经在键中指定了。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3593" class="ma mb it lw b gy mc md l me mf">df_population = pd.DataFrame(dict_states)</span></pre><p id="d8ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你打印<code class="fe ns nt nu lw b">df_population</code>，你会得到这个数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/6f1d8b8c788c73748ecbe1c23c70a75f.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*j1YqjrhIwWeZv-l2ESiHLg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><p id="8099" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://frankandrade.ck.page/bd063ff2d3" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a>加入我的电子邮件列表，与3000多人一起获取我在所有教程中使用的Python for Data Science备忘单</p><p id="a5f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你使用<a class="ae ky" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="ot ou gp gr ov ow"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk ks ow"/></div></div></a></div></div></div>    
</body>
</html>