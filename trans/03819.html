<html>
<head>
<title>Simple Logistic Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的简单逻辑回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-logistic-regression-using-python-scikit-learn-86bf984f61f1?source=collection_archive---------5-----------------------#2021-03-30">https://towardsdatascience.com/simple-logistic-regression-using-python-scikit-learn-86bf984f61f1?source=collection_archive---------5-----------------------#2021-03-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="30e4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从数据预处理到模型评估的逐步指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/76fadf646d3e694bab8fcbe61b7e66a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yi4Sw3H2XPOoFyFld-wlnw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逻辑回归python cheatsheet(图片作者来自<a class="ae ky" href="http://www.visual-design.net" rel="noopener ugc nofollow" target="_blank">www.visual-design.net</a></p></figure><h2 id="102b" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是逻辑回归？</h2><p id="2569" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">不要让逻辑回归这个名字欺骗了你，它通常属于分类算法而不是回归算法的范畴。</p><p id="8172" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">那么，什么是分类模型呢？简而言之，由分类模型生成的预测将是一个分类值，例如，猫或狗，是或否，真或假…相反，回归模型将预测一个连续的数值。</p><p id="786d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">逻辑回归基于Sigmoid函数进行预测，Sigmoid函数是一条曲线状的线，如下所示。尽管它返回概率，但最终输出将是通过将概率与阈值进行比较而分配的标签，这使它最终成为一种分类算法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/a55a6b17345c0a3bc3c097b458a50c80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3nG5GsSYL9k6HA90.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">sigmoid函数的简单说明(图片由作者提供)</p></figure><p id="64e1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在本文中，我将通过以下步骤使用python scikit -learn构建一个简单的逻辑回归模型:</p><ol class=""><li id="ce04" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn mz na nb nc bi translated">数据预处理</li><li id="7029" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">特征工程和EDA</li><li id="e2b0" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">模型结构</li><li id="f95d" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">模型评估</li></ol><p id="2f04" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">数据取自Kaggle公共数据集<a class="ae ky" href="https://www.kaggle.com/jsphyg/weather-dataset-rattle-package" rel="noopener ugc nofollow" target="_blank">“澳大利亚的雨”</a>。目标是根据现有知识，如温度、湿度、风速等，预测二元目标变量“RainTomorrow”。在我的网站上的<a class="ae ky" href="https://www.visual-design.net/post/simple-logistic-regression-using-python-scikit-learn" rel="noopener ugc nofollow" target="_blank">文章末尾，您可以随意获取完整代码。</a></p><h2 id="db9c" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">1.数据预处理</h2><p id="1ead" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">首先，让我们加载库和数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/4c6cb327c774c51d08a0f2dda1441cc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*mkohPuinmBUdF2O-W_BnDA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入库和数据集(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/43543ca19919342b918c38fb535b22c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j1xlHB6LAcYYXx4aPnODmg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.head()(图片作者提供)</p></figure><p id="44a7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">使用<code class="fe nk nl nm nn b">df.describe()</code>查看原始数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/cc62a51af89bf324fc5da363c187ac00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBNKrL4FVThOTYhxjpduGw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.describe()(图片由作者提供)</p></figure><p id="1e58" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们不能总是期望所提供的数据对于进一步的分析是完美的。事实上，这种情况很少发生。因此，数据预处理至关重要，尤其是处理缺失值是确保数据集可用性的必要步骤。我们可以使用<em class="np"> isnull() </em>函数来查看缺失数据的范围。下面的代码片段计算每列缺失值的百分比。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/55b60c7d6fdab0ff935f98d64db69f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPYax3aV7OyH29sSREQfDA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/b0786763e0febe6b348782a5d705cb6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*TDgb5g-72VoWNX6V1iecRw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">缺失值百分比(作者图片)</p></figure><p id="87e6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">有四个字段丢失了38%到48%的数据。我删除了这些列，因为这些值很可能是<strong class="lx iu">丢失的，而不是随机丢失的</strong>。例如，我们遗漏了大量的蒸发数据，这可能会受到测量仪器容量的限制。因此，有更多极端蒸发措施的日子可能不会首先被记录下来。所以剩下的数字已经偏了<strong class="lx iu">。</strong>为此，保留这些字段可能会污染输入数据。如果您想区分三种常见类型的缺失数据，您可能会发现这篇文章<a class="ae ky" href="https://medium.com/analytics-vidhya/how-to-address-missing-data-531ed964e68" rel="noopener">“如何处理缺失数据”</a>很有帮助。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/a87ccce3bb0e3afdf9b4d6d1df48ef13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JVgoZjMhNImA3CXHWuQsOA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按列和按行删除(图片由作者提供)</p></figure><p id="3cfd" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在执行按列删除后，我删除了缺少标签的行，“RainTomorrow”，直到<code class="fe nk nl nm nn b">dropna().</code>为了建立一个机器学习模型，我们需要标签来训练或测试模型，因此没有标签的行对这两个过程都没有太大帮助。但是，数据集的这一部分可以在模型实现后作为预测集分离出来。在处理缺失数据时，不可避免的是数据形状会发生变化，因此<code class="fe nk nl nm nn b">df.shape</code>是一种方便的方法，可以让您跟踪数据的大小。在上面的数据操作之后，数据形状从145460行23列变成了142193行19列。</p><p id="4d44" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">对于剩余的列，我分别估算了分类变量和数值变量。下面的代码将列分为分类列表和数字列表，这对后面的EDA过程也很有帮助。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/04a7acf81639359aa1080b764de9e3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*17Kd7fCT_8XxyPOgXjAfog.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分离数值和分类变量(图片由作者提供)</p></figure><ul class=""><li id="f71c" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn nu na nb nc bi translated"><strong class="lx iu">数值变量:</strong>用变量的平均值估算缺失值。注意，组合<code class="fe nk nl nm nn b">df.fillna()</code>和<code class="fe nk nl nm nn b">df.mean()</code> <em class="np"> </em>将足以只转换数字变量。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/31685e2d86b3625fb43d3aa2638a6c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*gPS4_XKYCYaacKeFdln3gQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">解决数值缺失问题(图片由作者提供)</p></figure><ul class=""><li id="e02a" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn nu na nb nc bi translated"><strong class="lx iu">分类变量:</strong>遍历cat_list并用“未知”替换缺失值</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/9e5e553d5885201ded79b5e5a8abbec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*1Y47sWMyxl_s97wOFtahfw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">处理分类缺失值(图片由作者提供)</p></figure><h2 id="806d" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">2.特征工程和EDA</h2><p id="4c22" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">将这两个过程结合在一起有利于根据数据集的分布和特征选择适当的特征工程技术。</p><p id="6245" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在这个例子中，我没有深入探索数据分析(EDA)过程。如果您有兴趣了解更多，请随意阅读我关于更全面的EDA指南的文章。</p><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/semi-automated-exploratory-data-analysis-eda-in-python-7f96042c9809"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">Python中的半自动探索性数据分析(EDA)</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">一键式全面数据探索流程</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div><p id="18ac" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我通过FOR循环自动进行单变量分析。如果遇到数字变量，将生成一个直方图来可视化分布。另一方面，为分类变量创建一个条形图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/490d64b754cb1a00caed635191d826c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xlKodomv96XNjgPFQYyccw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/3393685bf33bcefb8a779519dfb3f811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6a5F88YKq4pJCgmLdI_M6g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/d72cdfbe43d22d8a233403690b9d3bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2NxyU6femuk01AjzCsCCxw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">单变量分析(图片由作者提供)</p></figure><p id="93ee" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 1)地址异常值</strong></p><p id="64fe" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在我们有了数据分布的整体视图，发现异常值就容易多了。例如，<em class="np">降雨量</em>有严重的右偏分布，表明至少有一个非常高的记录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/81b3e12ab6e3740ab942f85752e88b10.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*GeqdMBC8zQ-8VsbXSq2zfQ.png"/></div></figure><p id="770d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了消除离群值，我使用<em class="np">分位数(0.9) </em>将数据集限制在数据集的90%分位数内。因此，降雨量值的上限从350大幅降至6。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/503279747fa54355e85fbb7391745f96.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*hEwKpbAQLbgAqR-XjJ5fOg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/4e5ed0a8f3f6a034719434782cd40013.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*NfABeey5IZ8OOuM7Vg79jA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">处理异常值(图片由作者提供)</p></figure><p id="e9ca" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 2)特征变换</strong></p><p id="2430" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><em class="np">日期</em>变量被转换成<em class="np">月份</em>。这是因为日期具有如此高的基数，以至于不可能产生模式。而使用month可以给出一年中的某些月份是否更有可能下雨的建议。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/3c554c1fa35b614d2b3d76e41883e402.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*zTApwCaihQASVeYWJbmcZg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">日期转换(图片由作者提供)</p></figure><p id="b549" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 3)分类特征编码</strong></p><p id="b9da" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">逻辑回归只接受数值作为输入，因此，有必要将分类数据编码成数字。最常见的技术是一键编码和标签编码。我发现这篇文章很好地比较了这两者。</p><div class="nx ny gp gr nz oa"><a href="https://www.analyticsvidhya.com/blog/2020/03/one-hot-encoding-vs-label-encoding-using-scikit-learn/" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">一键编码与使用Scikit-Learn的标签编码</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">什么是一键编码？什么时候应该使用一次性编码而不是标签编码？这些都是典型的数据科学…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">www.analyticsvidhya.com</p></div></div><div class="oj l"><div class="ow l ol om on oj oo ks oa"/></div></div></a></div><p id="8fb9" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">以<em class="np"> RainToday </em>为例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/130e8304aa84d4a5666e2e991cbb0671.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*uYfIxzIEdDfOz228sH--fQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">今天下雨的例子</p></figure><ul class=""><li id="309f" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn nu na nb nc bi translated"><strong class="lx iu">标签编码</strong>更适合基数大的<strong class="lx iu">序数数据</strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c0c35b8bf9141bc0b34d9a39ad329e8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*yOxb-NjBnVBrggA_wuQn5Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标签编码</p></figure><ul class=""><li id="39ff" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn nu na nb nc bi translated"><strong class="lx iu">一个热编码</strong>更适合低基数和非序数数据</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/a170a12097a13e40575e31ae5d80245b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*STbqGtcAKO_8jb_kEigAQQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个热编码</p></figure><p id="5cd9" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">尽管这些列不是有序的，我还是选择了标签编码。这是因为大多数字段都有不少于17个唯一值，而一次性编码会使数据变得太大。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/be1db27326721f950c83b16bef0bd57c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nK-DhKo9FOGk8bvlpnTOWA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标签编码代码(图片由作者提供)</p></figure><p id="87b7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在所有的变量都被转换成整数或浮点数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/de25bba80a74066f7f6585d11bb7a2ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*wGX_vdCqG5G8c2XmGaiEsA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.info()(图片作者提供)</p></figure><p id="6315" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 4)特征选择</strong></p><p id="58e6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果您想了解特性选择技术的详细信息，您可能会发现这很有帮助:</p><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/feature-selection-and-eda-in-python-c6c4eb1058a3"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">Python中的特征选择和EDA</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">如何使用数据可视化来指导ML中的特征选择</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="pc l ol om on oj oo ks oa"/></div></div></a></div><p id="f387" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在这个练习中，我使用了上面文章中提到的相关性分析。相关性分析是一种常见的多变量EDA方法，有助于识别高度相关的变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/6b2bd37c553e722ad30aa00e19adb0b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*nAqL9IUv7FAzUJ9llQJ0Nw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">相关性分析(图片由作者提供)</p></figure><p id="9208" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">例如:</p><ul class=""><li id="a2e1" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn nu na nb nc bi translated"><em class="np">最小温度，最大温度，温度9am </em>和<em class="np">温度3pm </em></li><li id="1a74" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn nu na nb nc bi translated"><em class="np">降雨</em>和<em class="np">今日降雨</em></li><li id="c497" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn nu na nb nc bi translated"><em class="np">压力9am </em>和<em class="np">压力3am </em></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/7f5e00f965dda79f3533aa98a6f7f4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IoUgJqzvETECLG4nXFy1XQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">相关矩阵(图片由作者提供)</p></figure><p id="45f8" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">由于逻辑回归要求预测值之间几乎没有多重共线性，我试图在每组高度相关的变量中只保留一个变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/148311566b9ab9b7b8e021aeced6c3ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pmMJB3SFgN9vyBJbemmyqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">特征选择(图片由作者提供)</p></figure><h2 id="0fba" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">3.模型结构</h2><p id="34d0" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">之前，我提到过这个练习的目的是预测明天<em class="np">的降雨</em>。因此，首要任务是分离输入要素(自变量— X)和标注(因变量— y)。<code class="fe nk nl nm nn b">df.iloc[:, :-1]</code>是一个方便的函数，可以抓取除最后一行以外的所有行和所有列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/e54d3d5bf2c8310881c8df432208ab92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KCgb_Y4mXKii5n42IlbW0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自变量和因变量(图片由作者提供)</p></figure><p id="8ec7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">其次，特征和标签都被分解成一个子集用于训练，另一个子集用于测试。结果，返回四个部分，X_train、X_test、y_train和y_test。为此，我们引入了<em class="np"> train_test_split </em>函数，并指定了参数test_size。在下面的示例中，test_size = 0.33，因此大约2/3的数据用于训练，1/3用于测试。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/4039db9b27c47611a123315ad1954e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*ZeStFMONv8BegygYLhgAnA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/e49819fa7bc8046ac093adafe39cd615.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*NIhGGr5qgU6A1K3o6VQHLg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分为训练和测试(图片由作者提供)</p></figure><p id="4468" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">多亏了scikit-learn，我们可以避免从零开始实现所有数学和算法的繁琐过程。相反，我们需要做的只是从sklearn库中导入LogisticRegression，并将训练数据拟合到模型中。然而，通过指定几个参数，例如max_iter、solver、penalty，仍然有改变模型的灵活性。更复杂的机器学习模型通常会涉及超参数调整过程，该过程搜索可能的超参数值并找到最佳组合。</p><p id="bb2b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">对于这个初学者友好的模型，我只改变了max_iter参数，以使逻辑回归收敛，但同时，该数字不应该太高，以导致过度拟合。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/8c5f1eacbc1851ee96ef11e7a926f87e.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*hYlvbSwmqKJUFamcD_XMuA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逻辑回归模型(图片由作者提供)</p></figure><h2 id="ac05" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">4.模型评估</h2><p id="0259" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated"><strong class="lx iu"> ROC、AUC、混淆矩阵和准确度</strong>广泛用于评价Logistic回归模型。所有这些指标都是基于计算模型预测的y值与测试集的实际y值之间的差异，即y_pred和y_test。比较差异时，有四种可能的情况:</p><ol class=""><li id="8f90" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn mz na nb nc bi translated">当预报下雨时，明天确实下雨</li><li id="f579" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">真否定:当预测不下雨的时候，明天不下雨</li><li id="21fc" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">假阳性:当预报下雨时，明天不下雨</li><li id="ede0" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">假阴性:当预测不下雨的时候却下雨了</li></ol><p id="1780" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">混淆矩阵</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/c039fb430f78f000b28e344fb8d12025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*acbP6bom-HS678pHnBoCsw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/c7600142a1e5f899c0dc045d8ded13c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*GP0f1CKWowJMygebzuLllg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">混淆矩阵</p></figure><p id="9a42" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我使用了<code class="fe nk nl nm nn b">plot_confusion_matrix()</code>来提供一个可视化的表示，清楚地指出上面提到的四个场景的数量。如图所示，真正的否定是33122例，表明该模型擅长在实际上不会下雨的时候预测明天不会下雨。然而，它仍然需要提高真阳性率，从而成功地预测明天下雨(只有2756例)。</p><p id="76b2" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">准确度</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/8fdf1ad5966b89b3c89f5ca7ab8a61fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*JfC0_qUsmuTb3YdTjcvupQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">准确(性)</p></figure><p id="490f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">准确性计算所有正确预测的比率:(真阳性+真阴性)/(真阳性+假阳性+假阴性+假阳性)</p><p id="26dd" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> ROC和AUC </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/d395b92b50dbc83fbc0f404da7b6bfa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9seue-Mb7Coa48_GVZqyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ROC、AUC插图(图片由作者提供)</p></figure><p id="9111" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">ROC绘制了不同阈值下的真阳性率和假阳性率。例如，当阈值设置为0.7时，该点指示真阳性率和假阳性率，因此当预测概率大于0.7时，RainTomorrow = Yes。随着概率阈值下降到0.4，更多的病例将被预测为阳性(RainTomorrow = Yes)，因此真阳性率和假阳性率都上升。AUC代表曲线下面积，不同的模型具有不同的ROC，因此AUC得分也不同。在这个例子中，模型2比模型1具有更大的AUC，并且它是更好的模型。这是因为，在相同的假阳性率水平下，模型2具有更高的真阳性率。因此，模型2具有更高的AUC分数，这使其成为更好的模型。</p><p id="c56a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">三个函数用于绘制ROC图和计算AUC:</p><ul class=""><li id="8819" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn nu na nb nc bi translated">predict_proba():为每个实例生成概率分数</li><li id="88a4" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn nu na nb nc bi translated">roc_curve():返回假阳性率、真阳性率以及绘制曲线所必需的参数。</li><li id="0576" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn nu na nb nc bi translated">roc_auc_score():计算auc分数</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/75f784cd7096d9a839df981cc4b471eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*liUlslCmeuU-rM7aJlwR_Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ROC，AUC代码(图片由作者提供)</p></figure></div><div class="ab cl pn po hx pp" role="separator"><span class="pq bw bk pr ps pt"/><span class="pq bw bk pr ps pt"/><span class="pq bw bk pr ps"/></div><div class="im in io ip iq"><h2 id="ed7a" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">带回家的信息</h2><p id="ebdb" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">本文涵盖了逻辑回归模型构建过程的基本步骤:</p><ol class=""><li id="f31e" class="mu mv it lx b ly mo mb mp li mw lm mx lq my mn mz na nb nc bi translated">数据预处理:重点是缺失值插补</li><li id="f228" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">特征工程和EDA:单变量分析和多变量分析:处理异常值和特征转换</li><li id="bae0" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">建模:分割数据集并拟合数据逻辑回归</li><li id="0d38" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">模型评估:混淆矩阵、准确性、ROC和AUC</li></ol><p id="30ac" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">然而，这只是一个基本的指南，旨在让你及时掌握如何实施逻辑回归。通过引入超参数调整、特性重要性和标准化，有足够的空间来改进当前的模型。一如既往，让我们继续学习。</p><h2 id="4b57" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">更多这样的文章</h2><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/semi-automated-exploratory-data-analysis-eda-in-python-7f96042c9809"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">Python中的半自动探索性数据分析(EDA)</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">一键式全面数据探索流程</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/how-to-build-ml-model-using-bigquery-eced0107e4fd"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">如何使用SQL建立机器学习模型</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">BigQuery中的机器学习和预测建模</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="pu l ol om on oj oo ks oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a href="https://medium.com/analytics-vidhya/top-15-websites-for-data-scientists-to-follow-in-2021-67352092c54d" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">2021年数据科学家关注的15大网站</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">启发学习的网站和博客</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">medium.com</p></div></div><div class="oj l"><div class="pv l ol om on oj oo ks oa"/></div></div></a></div></div><div class="ab cl pn po hx pp" role="separator"><span class="pq bw bk pr ps pt"/><span class="pq bw bk pr ps pt"/><span class="pq bw bk pr ps"/></div><div class="im in io ip iq"><p id="82d7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><em class="np">原载于2021年3月30日</em><a class="ae ky" href="https://www.visual-design.net/post/simple-logistic-regression-using-python-scikit-learn" rel="noopener ugc nofollow" target="_blank"><em class="np">【https://www.visual-design.net】</em></a><em class="np">。</em></p></div></div>    
</body>
</html>