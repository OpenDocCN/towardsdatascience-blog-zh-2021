<html>
<head>
<title>A Beginner’s Guide to Graph Neural Networks Using PyTorch Geometric — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyTorch几何图形的神经网络初学者指南—第2部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-2-cd82c01330ab?source=collection_archive---------4-----------------------#2021-08-14">https://towardsdatascience.com/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-2-cd82c01330ab?source=collection_archive---------4-----------------------#2021-08-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ed60" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用深度行走嵌入作为我们的GNN模型的输入特征。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b2e1872b610e1489863213926063a78e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jUMexU3zpd10SkvMzt64oA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/time-lapse-photography-of-blue-lights-373543/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">像素</a>的<a class="ae ky" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>拍摄</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="11a0" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在我之前的<a class="ae ky" href="https://medium.com/@rohithtejam/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-1-d98dc93e7742" rel="noopener">帖子</a>中，我们看到了PyTorch几何库如何用于构建GNN模型，并在<a class="ae ky" href="https://en.wikipedia.org/wiki/Zachary%27s_karate_club" rel="noopener ugc nofollow" target="_blank"> Zachary的空手道俱乐部</a>数据集上制定节点分类任务。</p><h1 id="e246" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">语境。</strong></h1><p id="2d58" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">图形神经网络模型需要初始节点表示来进行训练，之前，我采用节点度数作为这些表示。但有几种方法可以做到这一点，另一种有趣的方法是使用基于学习的方法，如节点嵌入作为数字表示。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="da78" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated"><strong class="ak">回顾:空手道俱乐部数据集。</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/b2c46930fe6a26542f6d5fa6c1725f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FY9xMOEG3DxUzYvT83qprg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">空手道俱乐部数据可视化(来源:作者)</p></figure><p id="8d53" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这是数据集及其可视化的一个小总结，用两种不同的颜色显示了两个派别。</p><p id="e1dd" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">数据集:<a class="ae ky" href="https://en.wikipedia.org/wiki/Zachary%27s_karate_club" rel="noopener ugc nofollow" target="_blank">扎卡里空手道俱乐部</a>。</p><p id="daed" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这里，节点代表参与俱乐部的34名学生，链接代表俱乐部外成对成员之间的78种不同互动。有两种不同类型的标签<em class="nf">即</em>两派。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="8370" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">节点嵌入。</h1><p id="5fcb" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">我们的想法是使用一组称为低维嵌入的数字来捕获网络信息。存在专门用于学习图节点的数字表示的不同算法。</p><p id="395b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><a class="ae ky" href="https://arxiv.org/abs/1403.6652" rel="noopener ugc nofollow" target="_blank"> DeepWalk </a>是一种基于随机行走概念的节点嵌入技术，我将在本例中使用。为了实现它，我选择了<a class="ae ky" href="https://github.com/shenweichen/GraphEmbedding" rel="noopener ugc nofollow" target="_blank">图形嵌入</a> python库，它提供了5种不同类型的算法来生成嵌入。</p><p id="6638" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">首先，安装图形嵌入库并运行安装程序:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="c65d" class="nl md it nh b gy nm nn l no np">!git clone https://github.com/shenweichen/GraphEmbedding.git</span><span id="89b7" class="nl md it nh b gy nq nn l no np">cd GraphEmbedding/</span><span id="20bb" class="nl md it nh b gy nq nn l no np">!python setup.py install</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="6d48" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们使用深度行走模型来学习我们的图节点的嵌入。变量<code class="fe nt nu nv nh b">embeddings</code>以字典的形式存储嵌入，其中键是节点，值是嵌入本身。</p><p id="6889" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如我之前提到的，嵌入只是网络的低维数字表示，因此我们可以对这些嵌入进行可视化。这里，嵌入的大小是128，所以我们需要使用<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html" rel="noopener ugc nofollow" target="_blank"> t-SNE </a>，这是一种降维技术。基本上，t-SNE将128维数组转换成2维数组，这样我们就可以在2D空间中将其可视化。</p><blockquote class="nw nx ny"><p id="5260" class="lg lh nf li b lj lk ju ll lm ln jx lo nz lq lr ls oa lu lv lw ob ly lz ma mb im bi translated">注意:嵌入大小是一个超参数。</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="ae10" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用上述代码制作的可视化效果如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/17fd7b15d773aef36ec490f12b724dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TIffpsAHx4kNQsmiQpGyjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">节点嵌入的可视化(来源:作者)</p></figure><p id="14fa" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们可以看到，为该图生成的嵌入具有良好的质量，因为红点和蓝点之间有清晰的分离。现在，我们可以建立一个图形神经网络模型，在这些嵌入上进行训练，最后，我们将有一个好的预测模型。</p><p id="e989" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我将重用我之前的<a class="ae ky" rel="noopener" target="_blank" href="/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-1-d98dc93e7742">帖子</a>中的代码来构建节点分类任务的图形神经网络模型。我们现在遵循的程序与我之前的帖子非常相似。我们只是将节点特征从DeepWalk嵌入改为deep walk嵌入。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="1a98" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">数据准备。</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="948f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这里，我们只是准备将在下一步中用于创建自定义数据集的数据。请注意我如何更改了保存从DeepWalk算法生成的节点嵌入值的<code class="fe nt nu nv nh b">embeddings</code>变量。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="12e0" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">自定义数据集。</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4d12" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了将结果与我之前的<a class="ae ky" rel="noopener" target="_blank" href="/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-1-d98dc93e7742">帖子</a>进行比较，我使用了与之前类似的数据分割和条件。</p><p id="063b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">数据对象现在包含以下变量:</p><blockquote class="od"><p id="5df2" class="oe of it bd og oh oi oj ok ol om mb dk translated">Data(edge_index=[2，156]，num _ class =[1]，test_mask=[34]，train_mask=[34]，x=[34，128]，y=[34])</p></blockquote><p id="01cd" class="pw-post-body-paragraph lg lh it li b lj on ju ll lm oo jx lo lp op lr ls lt oq lv lw lx or lz ma mb im bi translated">我们可以注意到<code class="fe nt nu nv nh b">x</code>变量的维数从1到128的变化。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="e58a" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">图卷积网络。</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="93e3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们使用相同的代码来构建图形卷积网络。</p><p id="d6b3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在是时候训练模型并在测试集上进行预测了。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="e6a6" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">训练GCN模型。</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="b4d4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用与之前相同的超参数，我们获得如下结果:</p><blockquote class="od"><p id="bc8b" class="oe of it bd og oh oi oj ok ol om mb dk translated">训练精度:1.0 <br/>测试精度:0.90</p></blockquote><p id="75e9" class="pw-post-body-paragraph lg lh it li b lj on ju ll lm oo jx lo lp op lr ls lt oq lv lw lx or lz ma mb im bi translated">这是一个巨大的进步！</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="24a8" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">推论。</h1><p id="7f55" class="pw-post-body-paragraph lg lh it li b lj mu ju ll lm mv jx lo lp mw lr ls lt mx lv lw lx my lz ma mb im bi translated">从结果中可以看出，当GNN模型在<a class="ae ky" rel="noopener" target="_blank" href="/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-1-d98dc93e7742">第1部分</a>的类似条件下进行训练时，我们实际上在训练和测试准确性方面都有了很大的提高。</p><blockquote class="nw nx ny"><p id="9988" class="lg lh nf li b lj lk ju ll lm ln jx lo nz lq lr ls oa lu lv lw ob ly lz ma mb im bi translated">注意:我们当然可以通过进行超参数调整来改善结果。</p></blockquote><p id="7b6d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这表明当我们使用基于学习的节点嵌入作为输入特征时，图形神经网络表现得更好。现在问题来了，为什么会这样？</p><p id="8b92" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">回答这个问题需要一点解释。所以我会写一篇新的帖子来解释这种行为。敬请期待！</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="3057" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">参考文献。</h1><ol class=""><li id="5b6e" class="os ot it li b lj mu lm mv lp ou lt ov lx ow mb ox oy oz pa bi translated">PyTorch几何:【https://github.com/rusty1s/pytorch_geometric T2】</li><li id="1262" class="os ot it li b lj pb lm pc lp pd lt pe lx pf mb ox oy oz pa bi translated">深度行走:【https://arxiv.org/abs/1403.6652 T4】</li><li id="f85c" class="os ot it li b lj pb lm pc lp pd lt pe lx pf mb ox oy oz pa bi translated">图形嵌入库:<a class="ae ky" href="https://github.com/shenweichen/GraphEmbedding" rel="noopener ugc nofollow" target="_blank">https://github.com/shenweichen/GraphEmbedding</a></li><li id="c3ea" class="os ot it li b lj pb lm pc lp pd lt pe lx pf mb ox oy oz pa bi translated">GCN代码示例:<a class="ae ky" href="https://github.com/rusty1s/pytorch_geometric/blob/master/examples/gcn.py" rel="noopener ugc nofollow" target="_blank">https://github . com/rusty 1s/py torch _ geometric/blob/master/examples/gcn . py</a></li></ol><p id="d89e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">5.链接到本系列的第1部分。我强烈建议看看这个:</p><div class="pg ph gp gr pi pj"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-1-d98dc93e7742"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd iu gy z fp po fr fs pp fu fw is bi translated">使用PyTorch几何图形的神经网络初学者指南—第1部分</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">PyTorch几何入门</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px ks pj"/></div></div></a></div></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="e98c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我希望你喜欢阅读这篇文章，你可以在<a class="ae ky" href="https://www.linkedin.com/in/rohithteja/" rel="noopener ugc nofollow" target="_blank"> LinkedIn、</a> <a class="ae ky" href="https://twitter.com/RohithTeja15" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ky" href="https://github.com/rohithteja" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到我。随便打个招呼吧！</p></div></div>    
</body>
</html>