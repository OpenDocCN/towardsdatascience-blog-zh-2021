<html>
<head>
<title>A Complete Guide of How to Choose and Apply the Right Statistical Test in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中选择和应用正确的统计测试的完整指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-complete-guide-of-how-to-choose-and-apply-the-right-statistical-test-in-python-5fcaf5fb9351?source=collection_archive---------19-----------------------#2021-11-01">https://towardsdatascience.com/a-complete-guide-of-how-to-choose-and-apply-the-right-statistical-test-in-python-5fcaf5fb9351?source=collection_archive---------19-----------------------#2021-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="feee" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基本了解何时应该应用Z检验、T检验、卡方检验、方差分析和相关性检验</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8cb282c658c0b308c9e135a2ee51fbce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7DpheMrEJO3fkH2zR8MntA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="120d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们经常低估统计数据及其重要性，根据我自己的经验，我可以肯定地说，这是数据科学中最重要的部分。数据科学中统计学最有用的部分之一是统计测试和假设检验。我们需要知道什么时候使用统计检验，这样我们才能对一个假设得出正确的结论。</p><p id="bb3d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设检验有3个主要步骤:</p><ol class=""><li id="b8d9" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">陈述你的无效(Ho)和替代(H1)假设。</li><li id="1a36" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">执行适当的统计测试。</li><li id="2016" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">决定是否拒绝零假设。</li></ol><p id="e1d6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了决定是否拒绝零假设，我们需要为p值设置一个阈值，称为alpha值。如果我们将alpha值设置为0.05，这意味着我们对结果有95%的把握。对于下面的统计测试，alpha被设置为<strong class="la iu"> 0.05 </strong>。</p><p id="b671" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据集中主要有两种类型的变量。像性别这样的<strong class="la iu">分类变量</strong>和像体重和身高这样的<strong class="la iu">数字变量</strong>。</p><p id="578f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们创建一个包含两个分类变量和两个数值变量的数据集。</p><pre class="kj kk kl km gt mi mj mk ml aw mm bi"><span id="27b2" class="mn mo it mj b gy mp mq l mr ms">import pandas as pd import numpy as np<br/>import random df=pd.DataFrame({'Gender':random.choices(["M",'F'],weights=(0.4,0.6),k=1000), 'Age_Group':random.choices(["18-35",'35-45','45-80'],weights=(0.2,0.5,0.3),k=1000)})</span><span id="011c" class="mn mo it mj b gy mt mq l mr ms">df['Weight']=np.where(df['Gender']=="F",np.random.normal(loc=55,scale=5,size=1000),np.random.normal(loc=70,scale=5,size=1000))<br/> df['Height']=np.where(df['Gender']=="F",np.random.normal(loc=160,scale=5,size=1000),np.random.normal(loc=172,scale=5,size=1000)) </span><span id="8736" class="mn mo it mj b gy mt mq l mr ms">df['Weight']=df['Weight'].astype(int) df['Height']=df['Height'].astype(int) df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/6ec87c08662c2bd9da950bddc2184d0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/0*yRgerolasEXC7-tU.png"/></div></figure><h1 id="1a2d" class="mv mo it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">关于一个分类变量的检验</h1><blockquote class="nm"><p id="11d6" class="nn no it bd np nq nr ns nt nu nv lt dk translated">样题:人口中男女数量有区别吗？</p></blockquote><p id="2579" class="pw-post-body-paragraph ky kz it la b lb nw ju ld le nx jx lg lh ny lj lk ll nz ln lo lp oa lr ls lt im bi translated">对于我们想要检查其值的数量之间是否存在差异的单个分类变量，我们将使用<strong class="la iu"> one proportion Z检验。</strong>我们来陈述一下假设:</p><ul class=""><li id="7b67" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt ob ma mb mc bi translated">胡先生:男女人数没有区别</li><li id="7b19" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ob ma mb mc bi translated">H1:男人和女人的数量是不同的</li></ul><p id="691b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要澄清这是一个双边测试，因为我们正在检查男性Pm<strong class="la iu">和女性Pm </strong>的比例是否不同。如果我们想检查<strong class="la iu"> Pm &gt; Pw </strong>或<strong class="la iu"> Pm &lt; Pw </strong>，那么我们将进行单尾测试。</p><pre class="kj kk kl km gt mi mj mk ml aw mm bi"><span id="c833" class="mn mo it mj b gy mp mq l mr ms">from statsmodels.stats.proportion import proportions_ztest</span><span id="8b2d" class="mn mo it mj b gy mt mq l mr ms">count = 592 #number of females<br/>nobs = 1000 #number of rows | or trials<br/>value = 0.5 #This is the value of the null hypothesis.<br/>#That means porpotion of men = porpotion of women = 0.5</span><span id="00f1" class="mn mo it mj b gy mt mq l mr ms">#we are using alternative='two-sided' because we are chcking Pm≠Pw. #for Pw&gt;Pm we have to set it to "larger" and for Pw&lt;Pm to "smaller" </span><span id="ebef" class="mn mo it mj b gy mt mq l mr ms">stat, pval = proportions_ztest(count, nobs, value, alternative='two-sided')<br/>print("p_value: ",round(pval,3))</span></pre><p id="feac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">p值小于0.05。因此，我们在95%的置信度下拒绝零假设。这意味着人口中男性和女性的数量存在差异。</p><h1 id="2ba2" class="mv mo it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">关于两个分类变量的检验</h1><blockquote class="nm"><p id="6d4f" class="nn no it bd np nq nr ns nt nu nv lt dk translated">例题:不同年龄段的男女比例是否不同？</p></blockquote><p id="8ade" class="pw-post-body-paragraph ky kz it la b lb nw ju ld le nx jx lg lh ny lj lk ll nz ln lo lp oa lr ls lt im bi translated">如果我们想要检查两个分类值的独立性，我们将使用<strong class="la iu">卡方检验。</strong></p><p id="c8b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们陈述假设:</p><ul class=""><li id="8920" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt ob ma mb mc bi translated">胡先生:性别和年龄组是独立的</li><li id="7508" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ob ma mb mc bi translated">H1:性别和年龄组有依赖性</li></ul><pre class="kj kk kl km gt mi mj mk ml aw mm bi"><span id="64bc" class="mn mo it mj b gy mp mq l mr ms">from scipy.stats import chi2_contingency<br/>#The easiest way to apply a chi-squared test is to compute the #contigency table.</span><span id="5824" class="mn mo it mj b gy mt mq l mr ms">contigency= pd.crosstab(df['Gender'], df['Age_Group'])<br/>contigency</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/e92ff1b728ca8c7e6a46a6dde55e9403.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/0*d68-noO1S-zSSUho.png"/></div></figure><pre class="kj kk kl km gt mi mj mk ml aw mm bi"><span id="90bf" class="mn mo it mj b gy mp mq l mr ms">#Chi-square test of independence.<br/>c, p, dof, expected = chi2_contingency(contigency)</span><span id="a695" class="mn mo it mj b gy mt mq l mr ms">print("p_value: ",round(p,3))</span><span id="3eb6" class="mn mo it mj b gy mt mq l mr ms">p_value: 0.579</span></pre><p id="99ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">p值不小于0.05。因此，我们无法在95%的置信水平下拒绝零假设。这意味着性别和年龄组是独立的。</p><h1 id="6930" class="mv mo it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">测试一个分类变量和一个数字变量</h1><blockquote class="nm"><p id="1464" class="nn no it bd np nq nr ns nt nu nv lt dk translated"><em class="od">样题:男女身高有差异吗？</em></p></blockquote><p id="758e" class="pw-post-body-paragraph ky kz it la b lb nw ju ld le nx jx lg lh ny lj lk ll nz ln lo lp oa lr ls lt im bi translated">在这种情况下，我们将使用T检验(学生T检验)。</p><pre class="kj kk kl km gt mi mj mk ml aw mm bi"><span id="7735" class="mn mo it mj b gy mp mq l mr ms">from scipy.stats import ttest_ind<br/>#this is a two-sided test #you can divide the two-sided p-value by #two, and this will give you the one-sided one.</span><span id="514b" class="mn mo it mj b gy mt mq l mr ms">t_stat, p = ttest_ind(df.query('Gender=="M"')['Height'], df.query('Gender=="F"')['Height'])</span><span id="86cf" class="mn mo it mj b gy mt mq l mr ms">print("p_value: ",round(p,3))</span></pre><p id="b3b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">p值小于0.05。因此，我们在95%的置信度下拒绝零假设。这意味着男女身高有差异。</p><h1 id="aec8" class="mv mo it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">测试一个具有两个以上唯一值和一个数值变量的分类。</h1><blockquote class="nm"><p id="4a63" class="nn no it bd np nq nr ns nt nu nv lt dk translated"><em class="od">样题:各年龄段之间身高有差异吗？</em></p></blockquote><p id="5ba0" class="pw-post-body-paragraph ky kz it la b lb nw ju ld le nx jx lg lh ny lj lk ll nz ln lo lp oa lr ls lt im bi translated">现在，我们将使用ANOVA(方差分析)测试。</p><ul class=""><li id="5fc1" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt ob ma mb mc bi translated">胡先生:各组的平均身高是相等的</li><li id="239d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ob ma mb mc bi translated">H1:至少，一个群体的平均身高不同于其他群体</li></ul><pre class="kj kk kl km gt mi mj mk ml aw mm bi"><span id="2962" class="mn mo it mj b gy mp mq l mr ms">import scipy.stats as stats<br/>#stats f_oneway functions takes the groups as input and returns #ANOVA F and p value<br/>fvalue, pvalue = stats.f_oneway(df.query('Age_Group=="18-35"')['Height'], df.query('Age_Group=="35-45"')['Height'], df.query('Age_Group=="45-80"')['Height']) print("p_value: ",round(pvalue,3))</span><span id="8d40" class="mn mo it mj b gy mt mq l mr ms">p_value: 0.141</span></pre><p id="50ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">p值不小于0.05。因此，我们无法在95%的置信水平下拒绝零假设。</p><h1 id="5b6f" class="mv mo it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">测试两个数值变量</h1><blockquote class="nm"><p id="5cf7" class="nn no it bd np nq nr ns nt nu nv lt dk translated"><em class="od">样题:身高和体重有关系吗？</em></p></blockquote><ul class=""><li id="a0b8" class="lu lv it la b lb nw le nx lh oe ll of lp og lt ob ma mb mc bi translated">胡先生:身高和体重没有关系</li><li id="6625" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ob ma mb mc bi translated">H1:身高和体重是有关系的</li></ul><p id="76d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用相关性测试。相关性测试会给我们两个结果，一个相关系数和一个p值。正如你可能已经知道的，相关系数是显示两个变量相关程度的数字。对于其p值，我们应用与之前相同的原则，如果p值小于0.05，我们拒绝零假设。</p><pre class="kj kk kl km gt mi mj mk ml aw mm bi"><span id="e63d" class="mn mo it mj b gy mp mq l mr ms">import scipy.stats as stats<br/>#for this example we will use the Pearson Correlation.<br/>pearson_coef, p_value = stats.pearsonr(df["Weight"], df["Height"]) </span><span id="9e4d" class="mn mo it mj b gy mt mq l mr ms">print("Pearson Correlation Coefficient: ", pearson_coef, "and a P-value of:", round(p_value,3) )</span><span id="9289" class="mn mo it mj b gy mt mq l mr ms">Pearson Correlation Coefficient: 0.6213650837211053 and a P-value of: 0.0</span></pre><p id="6ffd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所见，p值小于0.05，因此，我们在95%的置信水平上拒绝了零假设。这意味着身高和体重之间有关系。</p><h1 id="15d1" class="mv mo it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">总结一下</h1><p id="e2e0" class="pw-post-body-paragraph ky kz it la b lb oh ju ld le oi jx lg lh oj lj lk ll ok ln lo lp ol lr ls lt im bi translated">这是对统计测试和假设检验的介绍。根据变量类型和一些常见问题，我们对何时应该应用Z检验、T检验、卡方检验、方差分析和相关性检验有了基本的了解。你可以把这篇文章作为统计测试的备忘单，但是我鼓励你阅读更多关于它们的内容，因为正如我之前所说的，统计学是数据科学中最重要的部分。</p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><p id="bb6e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">【https://predictivehacks.com】最初发表于<a class="ae ou" href="https://predictivehacks.com/how-to-choose-and-apply-the-right-statistical-test-in-python/" rel="noopener ugc nofollow" target="_blank"><em class="ot"/></a><em class="ot">。</em></p></div></div>    
</body>
</html>