<html>
<head>
<title>Create and publish your own Python package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建并发布您自己的Python包</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-and-publish-your-own-python-package-ea45bee41cdc?source=collection_archive---------12-----------------------#2021-07-18">https://towardsdatascience.com/create-and-publish-your-own-python-package-ea45bee41cdc?source=collection_archive---------12-----------------------#2021-07-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d63e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何pip安装您定制的软件包的简短指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4dd8a6477a6c600e4c41cf89bcee03fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iqxYM34z46kYmBuV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这些鸟是从源头安装的pip(图片由<a class="ae ky" href="https://unsplash.com/@tumbao1949" rel="noopener ugc nofollow" target="_blank">詹姆斯·温斯科特</a>在<a class="ae ky" href="https://unsplash.com/photos/PWR9m_ebonQ" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上提供)</p></figure><p id="23d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能对requests、Pandas、Numpy和许多其他可以用pip安装的包很熟悉。现在是时候创建自己的包了！在这篇文章中，我们将通过所需的步骤来打包和发布您的Python代码，供全世界进行pip安装。首先，我们将看看如何打包您的代码，然后我们如何发布它，使其易于访问。</p><p id="2dd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">(你更愿意和像同事这样的少数人分享你的代码吗？也可以允许人们从私有库</em>   <em class="lv">中</em> <a class="ae ky" href="https://mikehuls.medium.com/create-your-custom-python-package-that-you-can-pip-install-from-your-git-repository-f90465867893" rel="noopener"> <strong class="lb iu"> <em class="lv"> pip安装包。甚至当</em> <a class="ae ky" href="https://mikehuls.medium.com/use-git-submodules-to-install-a-private-custom-python-package-in-a-docker-image-dd6b89b1ee7a" rel="noopener"> <strong class="lb iu"> <em class="lv">将你的包放入Docker容器时也是如此！</em></strong></a>T22)</strong></a></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="173c" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">目标和准备</h1><p id="3ca3" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在本文中，我创建了几个真正重要的函数，希望与大家分享。让我们创建一个名为“<em class="lv"> mikes_toolbox </em>的包，人们只需通过<code class="fe na nb nc nd b">pip install mikes_toolbox</code>就可以使用它。</p><p id="559d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将概述一下安装过程是如何工作的:如果有人调用<code class="fe na nb nc nd b">pip install mikes_toolbox</code>，代码必须来自某个地方。Pip在PyPi上搜索具有该名称的包；Python包索引。你可以把这个想象成Python包的YouTube。首先我们将代码打包，然后上传到PyPi，这样其他人就可以找到我们的包，下载并安装它。</p><h1 id="ac29" class="md me it bd mf mg ne mi mj mk nf mm mn jz ng ka mp kc nh kd mr kf ni kg mt mu bi translated">包装</h1><p id="e31c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">首先，我们将封装我们的代码。我们将创建一个名为“toolbox_project”的项目目录，其中包含以下目录和文件:</p><pre class="kj kk kl km gt nj nd nk nl aw nm bi"><span id="f6a1" class="nn me it nd b gy no np l nq nr">toolbox_project<br/>    mikes_toolbox<br/>        __init__.py<br/>        functions.py<br/>        decorators.py<br/>    LICENSE.txt<br/>    README.md<br/>    setup.cfg<br/>    setup.py</span></pre><p id="172c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">项目文件夹的内容由两部分组成:mikes_toolbox文件夹和4个附加文件。该文件夹是我们包含源代码的实际包。这4个附加文件包含如何安装软件包的信息和一些附加信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b77fefce75fab238528eab299bf38f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JxEa3BiXTyIJx3i0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个包含我们的代码并附有安装说明的包(图片由<a class="ae ky" href="https://unsplash.com/@umbra_media" rel="noopener ugc nofollow" target="_blank"> Christopher Bill </a>在<a class="ae ky" href="https://unsplash.com/photos/3l19r5EOZaw" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄)</p></figure><h2 id="056d" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">包文件夹</h2><p id="b31e" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">mikes_toolbox是我们实际的包，包含了我们所有的源代码。请确保将该文件夹命名为您想要的包名。在我的案例中，它包含以下内容:</p><ul class=""><li id="561b" class="od oe it lb b lc ld lf lg li of lm og lq oh lu oi oj ok ol bi translated"><strong class="lb iu"> mikes_toolbox/function.py和decorators.py <br/> </strong>这是我的源代码。Function.py包含了一个函数比如叫做weirdCase()；一个可以让字符串完全不可读的函数。</li><li id="8e0f" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated"><strong class="lb iu"> mikes_toolbox/__init__。py <br/> </strong>这个文件是必需的。它告诉python mikes _ toolbox是一个Python包文件夹。你可以让它空着。您可以选择在这里包含import语句，以便更容易地从您的包中导入代码。一个例子:<br/>包括<code class="fe na nb nc nd b">from functions import weirdCase</code>。这样一来，人们就不必在软件包安装完毕后进行<code class="fe na nb nc nd b">from mikes_toolbox.functions import weirdCase</code>，而是直接<code class="fe na nb nc nd b">from mikes_toolbox import weirdCase</code>。</li></ul><h2 id="8668" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">LICENSE.txt</h2><p id="9723" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">描述人们如何使用您的许可证。从<a class="ae ky" href="https://choosealicense.com/" rel="noopener ugc nofollow" target="_blank">这个</a>站点中选择一个，然后将内容粘贴到这个文件中。</p><h2 id="b290" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">README.md</h2><p id="012d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这个文件包含关于这个包的信息:它是做什么的？它有什么特点？如何安装使用？在此查看示例<a class="ae ky" href="https://pypi.org/project/mikes-toolbox/" rel="noopener ugc nofollow" target="_blank">或在此</a>查看示例<a class="ae ky" href="https://github.com/mike-huls/toolbox_public/blob/main/README.md" rel="noopener ugc nofollow" target="_blank">。<br/>这个文件是用标记写的。在这个</a>站点上查看一个已经包含一些示例标记的编辑器；只需根据您的需求进行编辑即可。</p><h2 id="ffe2" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">setup.cfg</h2><p id="cf90" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这是一个简单的文件，只包含下面的代码。参考README.md。</p><pre class="kj kk kl km gt nj nd nk nl aw nm bi"><span id="1a53" class="nn me it nd b gy no np l nq nr">[metadata]<br/>description-file = README.md</span></pre><h2 id="bbb3" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">setup.py</h2><p id="4882" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">该文件确保软件包正确安装。复制下面的代码，并在需要的地方进行修改。大多数条目都是符合逻辑的，但download_url需要一点解释(见下文):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><h2 id="a2bc" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">下载_网址</h2><p id="0b37" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">当你<code class="fe na nb nc nd b">pip install pandas</code> pip在PyPi上搜索熊猫时。一旦找到，PyPi就告诉pip在哪里可以下载这个包。大多数情况下，这是git存储库中的一个文件。download_url关键字指的是这个文件的位置。为了获得一个URL，我们首先把源代码放在pip可以到达的地方。最好的方法是将您的代码上传到GitHub repo并创建一个版本。这个过程超级简单，步骤如下:</p><ol class=""><li id="bb7d" class="od oe it lb b lc ld lf lg li of lm og lq oh lu ot oj ok ol bi translated">创建一个存储库(名称不必与包名相匹配，但更有序)。</li><li id="8292" class="od oe it lb b lc om lf on li oo lm op lq oq lu ot oj ok ol bi translated">在你的回购中，在右边；单击“创建新版本”</li><li id="5db3" class="od oe it lb b lc om lf on li oo lm op lq oq lu ot oj ok ol bi translated">填写“标签版本”与setup.py中的相同(<em class="lv">版本</em>关键字)</li><li id="d7a8" class="od oe it lb b lc om lf on li oo lm op lq oq lu ot oj ok ol bi translated">给发布一个标题和描述。这并没有反映在包装中，这纯粹是为了在您的回购中保持一个概览</li><li id="5bc8" class="od oe it lb b lc om lf on li oo lm op lq oq lu ot oj ok ol bi translated">点击“发布发布”</li><li id="2496" class="od oe it lb b lc om lf on li oo lm op lq oq lu ot oj ok ol bi translated">复制“源代码(tar.gz)”的链接地址</li><li id="ac74" class="od oe it lb b lc om lf on li oo lm op lq oq lu ot oj ok ol bi translated">将复制的链接地址作为<em class="lv">下载url </em>的值粘贴在setup.py中</li></ol><p id="9d89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！您的软件包现在可以下载和安装了。下一步是处理分销。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="bf4f" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">分配</h1><p id="f55c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">到目前为止，我们所做的唯一一件事就是打包我们的代码并上传到GitHub，pip仍然不知道我们的包的存在。因此，让我们确保pip可以找到我们的软件包，以便人们可以安装它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d5870178d480bf908e7b1490c7adabe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XgC7xz3-c-h8Z-P1"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由<a class="ae ky" href="https://unsplash.com/@kaip" rel="noopener ugc nofollow" target="_blank">凯皮尔格</a>在<a class="ae ky" href="https://unsplash.com/photos/tL92LY152Sk" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄)</p></figure><h2 id="1708" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">PyPi帐户</h2><p id="2c4a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果你想在YouTube上发布视频，你需要先创建一个帐户。如果你想上传软件包到PyPi，你也需要先创建一个帐户。去<a class="ae ky" href="https://pypi.org/account/register/" rel="noopener ugc nofollow" target="_blank"> PyPi </a>注册一个账号。继续之前，请确认您的电子邮件地址。</p><h2 id="78a6" class="nn me it bd mf ns nt dn mj nu nv dp mn li nw nx mp lm ny nz mr lq oa ob mt oc bi translated">创建源分布</h2><p id="95f6" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这将创建一个tar.gz文件，其中包含运行包所需的所有内容。打开一个终端，cd到您的项目目录并执行下面的命令:</p><pre class="kj kk kl km gt nj nd nk nl aw nm bi"><span id="ddfe" class="nn me it nd b gy no np l nq nr">python setup.py sdist</span></pre><p id="4a8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">(对终端不熟悉？查看</em> <a class="ae ky" href="https://mikehuls.medium.com/terminals-consoles-command-line-for-absolute-beginners-de7853c7f5e8" rel="noopener"> <strong class="lb iu"> <em class="lv">本</em> </strong> </a> <em class="lv">文章为绝对基础知识)</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="15e8" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">上传</h1><p id="6411" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们准备好上传我们的包了！首先，我们需要pip安装Twine，这将有助于我们上传。简单来说就是<code class="fe na nb nc nd b">pip install twine</code>。</p><p id="3387" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一步是实际上传包。在终端中，如果您还不在项目目录中，请转到该目录并执行</p><pre class="kj kk kl km gt nj nd nk nl aw nm bi"><span id="8a2f" class="nn me it nd b gy no np l nq nr">python -m twine upload dist/*</span></pre><p id="fea3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Twine会要求您提供PyPi凭证，但在此之后，您的包应该会被上传！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="572e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">测试</h1><p id="e881" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">创建一个新的python项目，并(可选地)启动一个新的<a class="ae ky" href="https://mikehuls.medium.com/virtual-environments-for-absolute-beginners-what-is-it-and-how-to-create-one-examples-a48da8982d4b" rel="noopener">虚拟环境</a>。然后<code class="fe na nb nc nd b">pip install mikes_toolbox</code>。通过调用来测试代码</p><pre class="kj kk kl km gt nj nd nk nl aw nm bi"><span id="03fb" class="nn me it nd b gy no np l nq nr">from mikes_toolbox import weirdCase<br/><br/>print(weirdCase("This function is essential and very important"))</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="8842" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">更新您的包</h1><p id="4d25" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果你更新你的包，你需要确保更新setup.py中的版本，并在GitHub上创建一个带有相同标签的新版本。此外，更新setup.py中的download _ URL。<br/>一旦完成，用户就可以使用</p><pre class="kj kk kl km gt nj nd nk nl aw nm bi"><span id="50a6" class="nn me it nd b gy no np l nq nr">pip install mikes_toolbox --upgrade</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="65d9" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">结论</h1><p id="2aaf" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在这些简单的步骤中，你已经学会了如何使用PyPi和pip打包你的代码并发布给全世界。此外，您还创建了一个存放代码的中心位置，可用于跟踪bug、发布问题或请求新功能。不再通过邮件共享代码</p><p id="d55c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望我已经阐明了很多创建和分发Python包的过程。如果你有建议/澄清，请评论，以便我可以改进这篇文章。同时，查看我的其他关于各种编程相关主题的文章。编码快乐！</p><p id="ac07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">—迈克</p><p id="15b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">页（page的缩写）学生:比如我正在做的事情？<a class="ae ky" href="https://github.com/mike-huls" rel="noopener ugc nofollow" target="_blank">跟我来</a>！</p><div class="ou ov gp gr ow ox"><a href="https://mikehuls.medium.com/membership" rel="noopener follow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd iu gy z fp pc fr fs pd fu fw is bi translated">通过我的推荐链接加入媒体-迈克·赫斯</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">mikehuls.medium.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl ks ox"/></div></div></a></div></div></div>    
</body>
</html>