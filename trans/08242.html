<html>
<head>
<title>Heteroscedasticity in Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">回归模型中的异方差性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/heteroscedasticity-in-regression-model-21d9f5a93e59?source=collection_archive---------6-----------------------#2021-07-29">https://towardsdatascience.com/heteroscedasticity-in-regression-model-21d9f5a93e59?source=collection_archive---------6-----------------------#2021-07-29</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="6b11" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用统计模型检查异方差性</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/223fa9d86b2f3b6c95731d59bf6c94cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*39_4Kc5dT2SYT1HrZjJ8Cg.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://unsplash.com/photos/rpVQJbZMw8o" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><blockquote class="la lb lc"><p id="c47a" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">简介</strong></p></blockquote><p id="faa2" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">通常，回归分析是对可能具有跨不同自变量值的高方差的内置特征的数据进行的。这类数据的一个缺陷是异方差，它表示拟合值周围的可变方差。当我们观察异方差时，通常需要验证模型，有时在这种情况下回归数据可能不可靠。</p><blockquote class="la lb lc"><p id="3ed8" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">什么是异方差？</strong></p></blockquote><p id="5d1f" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">当我们执行回归时，数据点分散在拟合线周围。对于一个好的回归模型，散射应该尽可能小。当散射是均匀的时，这个模型称为均匀散射模型。如果不是，模型就是异方差的。典型的异方差分布类似于锥形，如下所示</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj md"><img src="../Images/67f2826240baca8a25f65dacf0051fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h3yNICaulvdUhZAKsDbtXQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">异方差数据的锥形分布。作者图片</p></figure><p id="c740" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">从上图可以看出，很明显，在独立变量(n)的值较低时，散射非常紧密，而当n的值较高时，方差较高。</p><blockquote class="la lb lc"><p id="4d9b" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">什么原因导致异方差？</strong></p></blockquote><p id="f550" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">大多数情况下，数据本身就是这种锥形分布的原因。有时，因变量的方差在整个数据集内变化且不恒定是很自然的。例如，在时间序列数据的情况下，因变量的初始值可能非常接近，但在最近的时间内，分散可能会扩大。在20世纪50年代，美国所有50个州的苹果价格可能非常相似，但在最近一段时间可能会有很大差异。换句话说，最近的数据点之间的变化可能比早期数据之间的变化更大。</p><blockquote class="la lb lc"><p id="50ce" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">用python实现</strong></p></blockquote><p id="9e6b" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">对于上面显示的数据集，我们可以通过使用python的<em class="lf"> statsmodels </em>库来检查异方差性。<em class="lf"> Statsmodels </em>包含<em class="lf"> het_white </em>模块，这是针对异方差性的white拉格朗日乘数检验。<a class="ae kz" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.diagnostic.het_white.html#statsmodels.stats.diagnostic.het_white" rel="noopener ugc nofollow" target="_blank">文档</a>显示可以对任何样本数据进行测试，输出p值作为异方差检验的指标。零假设取为“残差数据无异方差”。</p><p id="c141" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">让我们先检查一下同质数据。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="me mf l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mg"><img src="../Images/90fd1ab2910bab57486d4b859686c617.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*LUHpI9pXW-iK60R2fgiw8g.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">拟合线周围的均匀散射。作者图片</p></figure><p id="0aad" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我创建了一个合成数据集作为异方差数据的样本。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="me mf l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mh"><img src="../Images/366587fdeebafbfe9be736e75301a370.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*e-zHCfDz7rotLa_WGClJSA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">拟合线周围的非均匀散射。作者图片</p></figure><p id="ff3e" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我们可以对这个数据进行White的检验[1]来检验是否存在异方差。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="me mf l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mi"><img src="../Images/d9bdfbf668810a98b5044ac819769063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TchWCSkDR8LXC1L_3iCRkw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="c8c2" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在这种情况下，p值非常小，因此我们拒绝零假设，并确认数据集中存在潜在的异方差。</p><blockquote class="la lb lc"><p id="22d7" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">修正异方差</strong></p></blockquote><p id="7d6b" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">异方差使得回归模型不太可靠，因为残差不应该遵循任何特定的模式。为了使模型稳健，散射应该在拟合线周围是随机的。处理异方差的一个非常流行的方法是<a class="ae kz" href="https://scholarworks.umass.edu/cgi/viewcontent.cgi?article=1331&amp;context=pare" rel="noopener ugc nofollow" target="_blank">转换因变量</a>【2】。我们可以对变量执行对数转换，并用White的测试再次检查。为了演示，我们删除了y轴上的一些低值。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mj"><img src="../Images/0c7cb23699a85cafbb830403a6eaf8e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*H7LNaLi5VbkzvG4S6MR0uQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">转换变量。作者图片</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mk"><img src="../Images/7a0317494f8d3aaa36a15b6baa2d0bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lk2RDbnYEPndNDco7lHUUQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="750f" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">当进行怀特检验时，p值变高，表明数据变得同方差。然而，当执行数据转换时，原始数据的定义不再存在，而是被新的变量所取代。</p><blockquote class="la lb lc"><p id="9086" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">结论</strong></p></blockquote><p id="1c49" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">异方差会降低回归模型的稳健性。本质上，预测误差因自变量的不同范围而异，表明模型并不完美。在本文中，我们使用<em class="lf"> statsmodel </em>演示了异方差的原因及其在python中的检测实现。在进行任何回归分析后，应始终检查残差图，并确保残差的可变性不遵循任何模式，或者换句话说，残差的散布应在整个回归线上是均匀的。</p><p id="9558" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/07/28/Heteroscedasticity.html" rel="noopener ugc nofollow" target="_blank"> Github页面</a></p><blockquote class="la lb lc"><p id="93f4" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">参考文献</strong></p></blockquote><p id="3136" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">[1] <a class="ae kz" rel="noopener" target="_blank" href="/heteroscedasticity-is-nothing-to-be-afraid-of-730dd3f7ca1f">异方差没什么可怕的</a></p><p id="9835" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">[2] <a class="ae kz" href="https://scholarworks.umass.edu/cgi/viewcontent.cgi?article=1331&amp;context=pare" rel="noopener ugc nofollow" target="_blank">多元回归分析中的异方差性:什么是异方差性，如何检测异方差性，如何解决异方差性，以及在R和SPSS中的应用</a></p></div></div>    
</body>
</html>