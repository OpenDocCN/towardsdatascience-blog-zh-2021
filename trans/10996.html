<html>
<head>
<title>Let’s Learn List Comprehension with a Lots of Examples: Efficient Python Programming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们通过大量的例子来学习列表理解:高效的Python编程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lets-learn-list-comprehension-with-a-lots-of-examples-efficient-python-programming-98fb41813d7?source=collection_archive---------28-----------------------#2021-10-26">https://towardsdatascience.com/lets-learn-list-comprehension-with-a-lots-of-examples-efficient-python-programming-98fb41813d7?source=collection_archive---------28-----------------------#2021-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/00097b66f0318f44eb3c648c5cfd9480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fCaQ8uKTU4V2RtQi"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">托尔比约恩·赫尔格森在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="3bbb" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">让您的Python代码更紧凑、更快速</h2></div><p id="76de" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">列表理解是一种在列表或字符串上编写for循环的简洁方法。使用列表理解来执行列表或字符串的每个元素的动作并生成新列表是非常容易、简短和紧凑的。通常我们用for循环来实现。做列表理解是写“for循环”的一种相对更快更短的方式。我假设你已经了解初级python编程。</p><p id="3855" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将用大量的例子来解释列表理解，从最简单的例子开始，一直到更复杂的问题。</p><p id="dccb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们首先创建一个简单的数字列表:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="7c3b" class="md me jj lz b gy mf mg l mh mi">digits = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></pre><p id="f620" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们制作一个新的列表，包括数字列表中每个元素的平方。我将首先使用一个常规的for循环，然后使用一个list comprehension。</p><p id="a391" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是常规的for循环:</p><blockquote class="mj mk ml"><p id="8e37" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例1:</p></blockquote><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="2fae" class="md me jj lz b gy mf mg l mh mi">numbers = []</span><span id="c68a" class="md me jj lz b gy mq mg l mh mi">for i in digits:<br/>    numbers.append(i**2)<br/>    <br/>print(numbers)</span></pre><p id="9ef6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="4cd1" class="md me jj lz b gy mf mg l mh mi">[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span></pre><p id="7a6c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在用一个列表理解同样的事情:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9226" class="md me jj lz b gy mf mg l mh mi">[i**2 for i in digits]</span></pre><p id="9455" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="30d8" class="md me jj lz b gy mf mg l mh mi">[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span></pre><p id="7c59" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见，我只写了一行简单的代码，而不是4行代码。</p><blockquote class="mj mk ml"><p id="7c0c" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例2:</p></blockquote><p id="93bd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我会把上面‘数字’列表的所有偶数都分出来，做一个新的列表。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="474f" class="md me jj lz b gy mf mg l mh mi">numbers = []</span><span id="be2a" class="md me jj lz b gy mq mg l mh mi">for i in digits:<br/>    if i%2 ==0:<br/>        numbers.append(i/2)<br/>    <br/>print(numbers)</span></pre><p id="1aa9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="1bb9" class="md me jj lz b gy mf mg l mh mi">[0.0, 1.0, 2.0, 3.0, 4.0]</span></pre><p id="6cf8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，我们必须使用额外的“if语句”来检查数字是否是偶数。下面是如何在列表理解中做同样的事情:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="649b" class="md me jj lz b gy mf mg l mh mi">[i/2 for i in digits if i%2 ==0]</span></pre><p id="d0e5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="f53c" class="md me jj lz b gy mf mg l mh mi">[0.0, 1.0, 2.0, 3.0, 4.0]</span></pre><blockquote class="mj mk ml"><p id="6bf5" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例3:</p></blockquote><p id="de4d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个例子中，我将把“digits”列表的偶数元素乘以3，将奇数元素乘以3，然后加1，使其成为偶数。代码如下:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="aa2f" class="md me jj lz b gy mf mg l mh mi">numbers = []<br/>for i in digits:<br/>    if i%2 ==0:<br/>        numbers.append(3*i)<br/>    else:<br/>        numbers.append(3*i + 1)<br/>print(numbers)</span></pre><p id="8187" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="6122" class="md me jj lz b gy mf mg l mh mi">[0, 4, 6, 10, 12, 16, 18, 22, 24, 28]</span></pre><p id="6657" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个例子中，我们有一个for循环和一个if-else语句。具有列表理解的相同代码的实现:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="51c3" class="md me jj lz b gy mf mg l mh mi">[3*i if i%2 ==0 else 3*i + 1 for i in digits]</span></pre><p id="a654" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="db22" class="md me jj lz b gy mf mg l mh mi">[0, 4, 6, 10, 12, 16, 18, 22, 24, 28]</span></pre><blockquote class="mj mk ml"><p id="755c" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例4:</p></blockquote><p id="af91" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在列表理解中使用内置函数。我将导入数学库，并在“数字”列表的所有元素中使用平方根函数:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="fb73" class="md me jj lz b gy mf mg l mh mi">import math<br/>[math.sqrt(i) for i in digits]</span></pre><p id="50db" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="e37d" class="md me jj lz b gy mf mg l mh mi">[0.0,<br/> 1.0,<br/> 1.4142135623730951,<br/> 1.7320508075688772,<br/> 2.0,<br/> 2.23606797749979,<br/> 2.449489742783178,<br/> 2.6457513110645907,<br/> 2.8284271247461903,<br/> 3.0]</span></pre><blockquote class="mj mk ml"><p id="da6f" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例5:</p></blockquote><p id="732f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个例子将向你展示如何使用一个自定义函数，在列表的每个元素中使用它。首先，让我们定义一个函数，然后在“数字”列表中使用它:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="ad3e" class="md me jj lz b gy mf mg l mh mi">def form(n):<br/>    return 2**n - n**2</span><span id="365c" class="md me jj lz b gy mq mg l mh mi">[form(i) for i in digits]</span></pre><p id="b75a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="ea41" class="md me jj lz b gy mf mg l mh mi">[1, 1, 0, -1, 0, 7, 28, 79, 192, 431]</span></pre><p id="1ed7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看，函数中的公式是如何变换每个数字的。我发现把数字本身和转换后的数字放在一起很有帮助。我们可以使用列表理解来生成元组，其中每个元组将包括数字本身和转换:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="7ba5" class="md me jj lz b gy mf mg l mh mi">[(i, form(i)) for i in digits]</span></pre><p id="7215" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="f01b" class="md me jj lz b gy mf mg l mh mi">[(0, 1),<br/> (1, 1),<br/> (2, 0),<br/> (3, -1),<br/> (4, 0),<br/> (5, 7),<br/> (6, 28),<br/> (7, 79),<br/> (8, 192),<br/> (9, 431)]</span></pre><p id="5383" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了元组，我们还可以使用集合:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9b7b" class="md me jj lz b gy mf mg l mh mi">[{i, form(i)} for i in digits]</span></pre><p id="2db8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="56ef" class="md me jj lz b gy mf mg l mh mi">[{0, 1},<br/> {1},<br/> {0, 2},<br/> {-1, 3},<br/> {0, 4},<br/> {5, 7},<br/> {6, 28},<br/> {7, 79},<br/> {8, 192},<br/> {9, 431}]</span></pre><blockquote class="mj mk ml"><p id="7928" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例6:</p></blockquote><p id="3153" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个例子将处理一个嵌套的for循环。让我们写一个简单的嵌套for循环，然后我们将看到如何使用列表理解来完成它。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9e2e" class="md me jj lz b gy mf mg l mh mi">com = []</span><span id="21de" class="md me jj lz b gy mq mg l mh mi">for i in [3, 1, 4]:<br/>    for j in [9, 0, 2]:<br/>        com.append((i, j))<br/>print(com)</span></pre><p id="e7bb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="1a7a" class="md me jj lz b gy mf mg l mh mi">[(3, 9), (3, 0), (3, 2), (1, 9), (1, 0), (1, 2), (4, 9), (4, 0), (4, 2)]</span></pre><p id="aacc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是使用嵌套for循环的列表理解的一行实现:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="a259" class="md me jj lz b gy mf mg l mh mi">[(i, j) for i in [3, 1, 4] for j in [9, 0, 2]]</span></pre><p id="4449" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="807f" class="md me jj lz b gy mf mg l mh mi">[(3, 9), (3, 0), (3, 2), (1, 9), (1, 0), (1, 2), (4, 9), (4, 0), (4, 2)]</span></pre><blockquote class="mj mk ml"><p id="4d95" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例7:</p></blockquote><p id="72c5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我还想展示嵌套for循环的if-else语句的实现。这次我将检查例6的第一个列表是否是奇数。如果是奇数，我们将加1，否则它将保持原样。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="e749" class="md me jj lz b gy mf mg l mh mi">com = []</span><span id="87f1" class="md me jj lz b gy mq mg l mh mi">for i in [3, 1, 4]:<br/>    for j in [9, 0, 2]:<br/>        if i%2 != 0:<br/>            com.append((i+1, j))<br/>        else:<br/>            com.append((i, j))<br/>            <br/>print(com)</span></pre><p id="b94f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="0b6b" class="md me jj lz b gy mf mg l mh mi">[(4, 9), (4, 0), (4, 2), (2, 9), (2, 0), (2, 2), (4, 9), (4, 0), (4, 2)]</span></pre><p id="4064" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是上面代码块的列表理解实现:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="7bb0" class="md me jj lz b gy mf mg l mh mi">[(i+1, j) if i%2 !=0 else (i, j) for i in [3, 1, 4] for j in [9, 0, 2]]</span></pre><p id="d26c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="adc8" class="md me jj lz b gy mf mg l mh mi">[(4, 9), (4, 0), (4, 2), (2, 9), (2, 0), (2, 2), (4, 9), (4, 0), (4, 2)]</span></pre><blockquote class="mj mk ml"><p id="42f0" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">实施例8:</p></blockquote><p id="356c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个例子中，我将使用一个二维列表，并使用列表理解方法将其展平。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9ded" class="md me jj lz b gy mf mg l mh mi">v = [[1, 3, 4], [2, 5, 6], [7, 5, 4]]</span><span id="8f9a" class="md me jj lz b gy mq mg l mh mi">[i for elements in v for i in elements]</span></pre><p id="4df9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="f102" class="md me jj lz b gy mf mg l mh mi">[1, 3, 4, 2, 5, 6, 7, 5, 4]</span></pre><blockquote class="mj mk ml"><p id="933c" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">示例9:</p></blockquote><p id="8343" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个例子，我们也将采用一个二维列表，并将其旋转90度。这个例子在编码面试中非常流行。让我们先用常规的for循环来实现它，因为对于新程序员来说，它可能有点复杂:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="245c" class="md me jj lz b gy mf mg l mh mi">td = [[1, 3, 4], <br/>      [2, 5, 6], <br/>      [7, 5, 4]]</span><span id="2f08" class="md me jj lz b gy mq mg l mh mi">res = []</span><span id="e283" class="md me jj lz b gy mq mg l mh mi">for i in range(len(td)):<br/>    el = []<br/>    for j in td:<br/>        el.append(j[i])<br/>    res.append(el)<br/>    <br/>print(res)</span></pre><p id="f85c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="4e32" class="md me jj lz b gy mf mg l mh mi">[[1, 2, 7], [3, 5, 5], [4, 6, 4]]</span></pre><p id="f0c2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是如何使用列表理解来做到这一点:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="1ae0" class="md me jj lz b gy mf mg l mh mi">[[j[i] for j in td] for i in range(len(td))]</span></pre><p id="8281" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="6cbf" class="md me jj lz b gy mf mg l mh mi">[[1, 2, 7], [3, 5, 5], [4, 6, 4]]</span></pre><h2 id="848c" class="md me jj bd mr ms mt dn mu mv mw dp mx lh my mz na ll nb nc nd lp ne nf ng nh bi translated">结论</h2><p id="2023" class="pw-post-body-paragraph ky kz jj la b lb ni kk ld le nj kn lg lh nk lj lk ll nl ln lo lp nm lr ls lt im bi translated">希望这些例子对你学好列表理解有帮助。在编写大型应用程序时，找到改进代码的方法是很重要的。列表理解可以是压缩代码并使它们更快的方法之一。但是对于太复杂的代码来说，列表理解可能不是一个好主意。</p><p id="c061" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">欢迎在推特上关注我，喜欢我的T2脸书页面。</p><p id="7fca" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是本主题的视频版本，解释了相同的代码:</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="nn no l"/></div></figure></div></div>    
</body>
</html>