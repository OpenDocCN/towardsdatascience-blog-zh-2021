<html>
<head>
<title>Approaching Anomaly Detection in Transactional Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">交易数据中的异常检测方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/approaching-anomaly-detection-in-transactional-data-744d132d524e?source=collection_archive---------9-----------------------#2021-09-25">https://towardsdatascience.com/approaching-anomaly-detection-in-transactional-data-744d132d524e?source=collection_archive---------9-----------------------#2021-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4d87" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">交易数据中的异常检测可能很难，但它带来了在大量数据中发现未知的好处，否则这是不可能的。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5264701d8a4fec7384818878568992f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TwA3sjoEbfsWvhuD"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">查尔斯·德鲁维奥在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="9f46" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">1导言</h1><p id="e0f5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">通常，当人们谈论交易数据<strong class="lq ir">时，他们指的是金融交易。</strong>然而，<a class="ae kv" href="https://en.wikipedia.org/wiki/Transaction_data" rel="noopener ugc nofollow" target="_blank">根据维基百科</a>，“<strong class="lq ir">交易数据</strong>是描述一个事件(作为交易结果的变化)的数据，通常用动词来描述。交易数据总是有一个时间维度，一个数值，并涉及一个或多个对象”。在本文中，我们将使用向服务器发出请求的数据(互联网流量数据)作为示例，但是所考虑的方法可以应用于前述事务性数据定义下的大多数数据集。</p><p id="d14e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">异常检测</strong>，简而言之，就是在一个生成数据的系统中，找到正常情况下不应该出现的数据点。交易数据中的异常检测有许多应用，下面是几个例子:</p><ul class=""><li id="5622" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">金融交易中的欺诈检测。</li><li id="25cd" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">制造中的故障检测。</li><li id="89b9" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">计算机网络中的攻击或故障检测(本文涉及的情况)。</li><li id="7faa" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">预测性维护的建议。</li><li id="2fb6" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">健康状况监控和警报。</li></ul><h1 id="73e0" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">2数据</h1><h2 id="bc6a" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">2.1数据描述</h2><p id="00c8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们将用作示例的数据如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="c2cc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">具有如下所述的列:</p><ul class=""><li id="0673" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated"><strong class="lq ir">时间戳</strong>:事件发生的时间。</li><li id="b6a1" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir"> serverId: </strong>被访问的服务器的唯一标识符。</li><li id="7c05" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir"> ip </strong>:客户端的IPv4地址或IPv6地址。</li><li id="36d8" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir"> timeMs </strong>:请求和服务器响应之间经过的时间，以毫秒为单位。</li><li id="7b49" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir"> clientSSLProtocol </strong>:用于请求的SSL加密协议。</li><li id="8177" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir"> clientHTTPMethod </strong> : POST，GET，PUT，PATCH，DELETE。</li><li id="533f" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir">clientRequestHTTPProtocol</strong>:HTTP协议的版本，例如HTTP/1、HTTP/2。</li><li id="ef33" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir"> clientRequestPath </strong>:请求的路径，例如。/v3/article/。</li><li id="83da" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir"> userAgent </strong>:一个特征字符串，让服务器和网络对等点识别应用程序、操作系统、供应商和/或发出请求的用户代理的版本。</li></ul><h2 id="9a72" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">2.2数据探索</h2><p id="31e6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这里我们不是在进行经典的EDA(探索性数据分析),而是试图从几个给定的例子中理解如何使用数据。</p><p id="515c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现有功能(列)分为3类，并补充了使用它们的方法:</p><ul class=""><li id="3879" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated"><strong class="lq ir">实数(timeMs，…) </strong>。这些可以直接使用(在基于树的模型的情况下)或者在输入模型之前用<a class="ae kv" href="https://en.wikipedia.org/wiki/Feature_scaling" rel="noopener ugc nofollow" target="_blank">标准化</a>。</li><li id="7e64" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir">基数低的分类变量(clientSSLProtocol，clientHTTPScheme，clientHTTPMethod，…) </strong> <a class="ae kv" href="https://en.wikipedia.org/wiki/Categorical_variable" rel="noopener ugc nofollow" target="_blank">可以编码(one hot，target等..)或者嵌入式。</a></li><li id="75a6" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><strong class="lq ir">具有高基数和文本数据的分类变量(clientRequestPath，userAgent，… </strong>)。这些方法比较棘手，一种方法是解析文本并尝试推断基数较低的类别，或者，例如，使用<a class="ae kv" href="https://en.wikipedia.org/wiki/Sentence_embedding" rel="noopener ugc nofollow" target="_blank">文本嵌入</a>。</li></ul><h2 id="09dd" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">2.3特征工程</h2><p id="e798" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir"> 2.3.1时间特征</strong></p><p id="ea62" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">时间戳</strong>可以被编码成如下特征:</p><ul class=""><li id="113d" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">一小时中的分钟</li><li id="c957" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">一天中的小时</li><li id="5903" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">星期几</li><li id="72f1" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">等等...</li></ul><p id="f09e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了摆脱隐式排序(即周一和周日之间的距离与其他连续日期之间的距离相同，但如果它们分别编码为1和7，则该属性不成立)，通常使用归一化值的<a class="ae kv" rel="noopener" target="_blank" href="/cyclical-features-encoding-its-about-time-ce23581845ca">正弦和余弦。</a></p><p id="ad92" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">2 . 3 . 2 IP地址的处理</strong></p><p id="dbf7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">可以使用字典查找将IP地址转换为地理位置。这个位置可以被视为一个分类变量。</p><p id="9141" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">此外，可以检查IP地址是否是众所周知的代理服务器，并将其标记为众所周知的代理服务器(这对于应用3.1.1中的规则很有用)</p><p id="5a27" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">用户代理标志</p><p id="33df" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> userAgent </strong>值可以被解析以提取关于特定子字符串存在的信息，如“torrent”、“iphone”、“chrome”等，然后相应的标志“uaTorrent”、“uaIphone”、“uaChrome”等被设置为1。</p><p id="caae" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">然而，解析规则可能需要维护，因为相关的关键字往往会随着时间而变化。</p><p id="0bb3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2.3.4 clientRequestPath标志</p><p id="6cbf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">与<strong class="lq ir">用户代理</strong>相同，但是搜索类似“登录”、“管理”等模式...</p><h2 id="946c" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">2.4标签</h2><p id="8f50" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">数据集中的记录没有按照“坏的”和“好的”参与者进行标记，但是我们假设在下一节中数据集可以具有用于监督建模方法的那些标签。</p><h1 id="fe5c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">3建模</h1><p id="635b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本节中，我们回顾了几种异常流量检测器的建模方法，从最简单到最先进，考虑它们的优缺点。</p><h2 id="9d4a" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">3.1检测个别异常</h2><p id="8fe5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir"> 3.1.1简单规则集</strong></p><p id="b614" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这个简单的检测器中，一组规则被应用于每个单独的记录，并且在以下情况下发生警报，例如:</p><ul class=""><li id="5826" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">时间&gt; X</li><li id="2551" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">uaTorrent == 1</li></ul><p id="52ff" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以及规则的逻辑组合(与、或……)</p><p id="19d8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">优点:</p><ul class=""><li id="c28b" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">很容易推理</li><li id="3003" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">易于实现和测试</li><li id="e02e" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">警报是可以解释的</li><li id="506b" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">一个相当复杂的规则集是最快的选择</li></ul><p id="5bf1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">缺点:</p><ul class=""><li id="d49a" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">难以维护，尤其是当规则集变得复杂时</li><li id="6e47" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">不能(快速)适应变化的行为</li><li id="0a89" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">可能会遗漏不明显的病例，因此召回率可能较低</li></ul><p id="9c25" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 3.1.2记录的监督分类</strong></p><p id="5b3c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这种方法假设标签对于数据是可用的，并且问题可以被构造成一个<a class="ae kv" href="https://en.wikipedia.org/wiki/Binary_classification" rel="noopener ugc nofollow" target="_blank">二元分类</a>。几乎所有的分类模型都可以在这里应用，将特征(2.1)作为输入向量。这些模型可以是简单的，如逻辑回归，也可以是复杂的，如神经网络，输出一个介于0和1之间的“异常分数”。然而，<a class="ae kv" href="https://en.wikipedia.org/wiki/Ensemble_learning#Boosting" rel="noopener ugc nofollow" target="_blank">树集成</a>在这里似乎是一个最佳选择，它结合了自然的可解释性、良好的预期预测性能、无需显式编码的分类变量支持以及可接受的推理速度。如果数据量很大，后者非常重要。</p><p id="0599" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">优点:</p><ul class=""><li id="f6d6" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">分类是一个众所周知的ML问题，有许多成功应用的例子</li><li id="3a3f" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">(潜在的)高检测性能(也见缺点)</li><li id="3da9" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">大多数模型都是可以解释的</li></ul><p id="ecc4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">缺点:</p><ul class=""><li id="88d5" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">需要标签，检测质量与标签质量一样好</li><li id="641a" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">标签很可能是不平衡的(异常流量更少)，这需要应用特殊措施，如<a class="ae kv" href="https://en.wikipedia.org/wiki/Oversampling_and_undersampling_in_data_analysis" rel="noopener ugc nofollow" target="_blank">多数类欠采样、少数类过采样</a>、<a class="ae kv" href="https://en.wikipedia.org/wiki/Data_augmentation" rel="noopener ugc nofollow" target="_blank">数据扩充</a>、<a class="ae kv" href="https://arxiv.org/abs/1106.1813" rel="noopener ugc nofollow" target="_blank"> SMOTE </a>等。</li><li id="532e" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">需要用于模型(重新)训练、验证和存储的基础设施</li></ul><p id="6d8b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 3.1.3无监督异常检测</strong></p><p id="bb72" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">高质量的标签并不总是可用的，因此无人监管的方法可能会很方便。<a class="ae kv" href="https://en.wikipedia.org/wiki/Anomaly_detection#Popular_techniques" rel="noopener ugc nofollow" target="_blank">异常检测方法/模型</a>通常学习数据中最流行的模式，然后预测新示例的“异常性”。</p><p id="9338" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">优点:</p><ul class=""><li id="b8e9" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">模型训练不需要标签</li></ul><p id="379c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">缺点:</p><ul class=""><li id="24db" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">标签对于模型验证仍然很方便</li><li id="a852" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">需要用于模型(重新)训练和存储的基础设施</li></ul><h2 id="a75f" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">3.2使用时态数据(“行为”分析)</h2><p id="fb83" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">使用时间可以使模型不断适应潜在恶意行为者不断变化的行为，但这需要对数据进行更多的预处理。这种预处理将是在滚动时间窗口上的聚合，并且可以用类似这样的伪火花码来完成:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="97fe" class="nd kx iq ns b gy nw nx l ny nz">df<br/> …<br/> .groupBy(window(col(“timestamp”), 1.minute), col(“ip”))<br/> .agg(<br/>   count(col(“*”)) as ‘num_reqs,<br/>   avg(col(“timeMs”)) as ‘avgTimeMs,<br/>   skew(col(“timeMs”)) as ‘skewTimeMs,<br/>   count(when(col(“clientRequestPath”).contains(“login”)) as ‘num_logins),<br/> …<br/>)</span></pre><p id="dd1f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">注意:</strong>数据按“ip”分组，但根据使用案例，按国家和/或地区组合(从IP地址解码)分组可能更好。</p><p id="a322" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">通过这个查询，我们可以将数据转换成一组时间序列，并应用下面描述的特定于时间序列的方法。</p><p id="b7a2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 3.2.1对比历史统计</strong></p><p id="98e5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了增加规则“模型”的适应性，我们可以使用数据的时态特征和简单的规则集来修改规则，如下所示:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="1c6b" class="nd kx iq ns b gy nw nx l ny nz">currentTimeMs &gt; avgTimeMs + someConstant</span></pre><p id="e65e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">其中“avgTimeMs”是在最后N个时间戳上度量的连续更新的平均值。</p><p id="2051" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">对于分类特征，可以使用<a class="ae kv" href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence" rel="noopener ugc nofollow" target="_blank">比较当前时刻分类变量的分布</a>和来自相同的最后N个时间戳的一些聚集分布。</p><p id="8bc8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">优点:</p><ul class=""><li id="1b18" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">不需要模型(重新)训练，但仍然提供适应性</li></ul><p id="bc7f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">缺点:</p><ul class=""><li id="843b" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">需要附加的预处理步骤</li></ul><p id="c713" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">注:</strong>其他利弊同简单规则集。</p><p id="a355" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 3.2.2异常检测任务的时间序列预测</strong></p><p id="f073" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">该方法的工作方式如下:基于某个时间窗口，模型预测下一个值，并将预测值与实际观察值进行比较。潜在的<a class="ae kv" href="https://en.wikipedia.org/wiki/Forecasting#Time_series_methods" rel="noopener ugc nofollow" target="_blank">预测方法</a>可能会有所不同，从更传统的东西，如SARIMA到深度学习。<a class="ae kv" href="https://en.wikipedia.org/wiki/Probabilistic_forecasting" rel="noopener ugc nofollow" target="_blank">概率预测</a>由于不利因素列表中描述的因素而成为首选。</p><p id="ae85" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">优点:</p><ul class=""><li id="03b3" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">是一种自我监督的方法，因此不需要标签</li><li id="5e12" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">当超出正常值的指标被返回为异常时，可以解释多变量预测的情况，可选地，与正常值的距离为异常分数，数据列用于分组依据</li><li id="4874" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">例如，在<a class="ae kv" href="https://ts.gluon.ai/" rel="noopener ugc nofollow" target="_blank">胶子-ts </a>中提供的概率模型的情况下，不需要设置阈值，只需要设置百分位数，超出百分位数的观察将被视为异常</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/7b2034e1b9278ca78d1338a39991a228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/0*7sOlkTQ7bziIqoSV"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">关于<a class="ae kv" href="https://ts.gluon.ai/" rel="noopener ugc nofollow" target="_blank">胶子-ts </a>的概率预测例子</p></figure><p id="d55f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">缺点:</p><ul class=""><li id="55dc" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">需要用于模型(重新)训练、验证和存储的基础设施</li><li id="d75f" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">推理时间可能很长，尤其是对于概率模型</li></ul><h2 id="c384" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">3.3解释预测</h2><p id="69ab" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">可解释的预测对于识别检测的根本原因非常重要，这对于调试和调查攻击可能非常有用。所以不推荐像神经网络这种不易解释的模型。</p><p id="8825" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">就工具而言，例如<a class="ae kv" href="https://arxiv.org/abs/1705.07874" rel="noopener ugc nofollow" target="_blank"> SHAP </a>，它是从黑盒模型中推断特性重要性的最佳软件包之一。</p><h1 id="0ce8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">4额外资源</h1><p id="0cb3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这两个存储库是异常检测和时序预测的研究和工具的重要信息源:</p><div class="ob oc gp gr od oe"><a href="https://github.com/yzhao062/anomaly-detection-resources" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">GitHub-yzhao 062/异常检测-资源:异常检测相关的书籍、论文、视频和…</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">离群点检测(也称为异常检测)是一个令人兴奋但又具有挑战性的领域，其目的是识别出…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">github.com</p></div></div><div class="on l"><div class="oo l op oq or on os kp oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a href="https://github.com/cuge1995/awesome-time-series" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">GitHub-cuge 1995/awesome-time-series:论文、代码和其他资源列表</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">关于时间序列预测的最新论文、代码和其他资源的列表。</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">github.com</p></div></div><div class="on l"><div class="ot l op oq or on os kp oe"/></div></div></a></div><h1 id="6b17" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">5结论和后续步骤</h1><p id="22ec" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本文中，我们回顾并总结了应用于交易数据的异常检测任务的数据预处理、特征工程和建模的几种选择。根据系统要求，选项的数量可以缩小:例如，如果推理时间应该是微秒——深度学习模型最有可能出局。可行的方案应进行离线和在线测试，并根据项目开始时选择的成功标准确定最佳方案。该指标可以是<a class="ae kv" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank"> precision </a>(如果担心误报),或者<a class="ae kv" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank"> recall </a>(如果错过攻击代价高昂),甚至是某种综合指标，可以是这两者与各种指标(如推理时间、训练时间、计算负载、错误成本等)的加权组合</p></div></div>    
</body>
</html>