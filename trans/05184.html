<html>
<head>
<title>Clustering Algorithm for data with mixed Categorical and Numerical features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有混合类别和数值特征的数据聚类算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clustering-algorithm-for-data-with-mixed-categorical-and-numerical-features-d4e3a48066a0?source=collection_archive---------4-----------------------#2021-05-07">https://towardsdatascience.com/clustering-algorithm-for-data-with-mixed-categorical-and-numerical-features-d4e3a48066a0?source=collection_archive---------4-----------------------#2021-05-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="81d9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">k-Modes和k-Prototype算法直觉和用法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3280b43f60d6166f50aceab9f622f4ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNgZso98ulnlFIDc9PIb2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/mohamed_hassan-5229782/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6087062" rel="noopener ugc nofollow" target="_blank">穆罕默德·哈桑</a>发自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6087062" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="5b8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">聚类是一种无监督的机器学习技术，它以这样一种方式将群体分成几个聚类或组，即一个聚类中的数据点彼此相似，而不同聚类中的数据点不相似。k-Means是一种流行的聚类算法，仅限于数字数据。</p><h2 id="46ec" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">为什么k-Means不能用于分类特征？</h2><p id="3c41" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">k-Means是一种流行的基于质心的聚类算法，它将整个群体的数据点分成k个聚类，每个聚类具有几乎相等数量的数据点。k-Means聚类算法背后的思想是找到k个质心点，并且数据集中的每个点将属于具有最小欧几里德距离的k个集合中的任一个。</p><p id="a965" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">k-Means算法不适用于分类数据，因为分类变量是离散的，没有任何自然来源。所以计算欧几里得距离对于这样的空间是没有意义的。</p><p id="46e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">k-Means算法有一种变体，称为k-Modes，适用于具有分类特征的数据。k-Prototype是k-Modes算法的扩展，适用于混合分类和数字特征。</p><h1 id="8c47" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">什么是k模式和k原型算法:</h1><p id="e205" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">k-Modes是一种基于k-Means算法范例的算法，用于对分类数据进行聚类。k-modes根据数据点之间的匹配类别定义聚类。k-Prototype算法是对k-modes算法的扩展，它结合了k-Modes和k-means算法，能够对混合的数值和分类变量进行聚类。</p><h2 id="1409" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">安装:</h2><p id="6beb" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">k-modes和k-prototype算法可以使用开源库<code class="fe ne nf ng nh b"><strong class="lb iu">kmodes</strong></code> <strong class="lb iu"> </strong>实现。可以使用以下命令从PyPl安装kmodes库:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="81f9" class="lv lw it nh b gy nm nn l no np"><strong class="nh iu">pip install kmodes</strong></span></pre><h2 id="3eeb" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">用法:</h2><p id="d6c4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如前所述，<code class="fe ne nf ng nh b"><strong class="lb iu">kmodes </strong></code>算法仅用于分类变量的聚类。而人们可以使用<code class="fe ne nf ng nh b"><strong class="lb iu">KPrototypes() </strong></code>函数来用一组混合的分类和数字特征对数据进行聚类。</p><p id="eca9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用于演示的数据集包含分类特征和数字特征。</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="0139" class="lv lw it nh b gy nm nn l no np"><strong class="nh iu">from kmodes.kprototypes import KPrototypes</strong></span><span id="d643" class="lv lw it nh b gy nq nn l no np"><strong class="nh iu">kproto = KPrototypes(n_clusters=2, verbose=2, max_iter=20)<br/>kproto.fit(df_array, categorical=cat_idx)</strong></span></pre><p id="957f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ne nf ng nh b"><strong class="lb iu">KPrototypes </strong></code>函数用于将数据集聚类成给定的<code class="fe ne nf ng nh b"><strong class="lb iu">n_clusters </strong></code>(聚类数)。在拟合训练数据集时，开发人员需要将分类特征的索引指定为参数。训练时<code class="fe ne nf ng nh b"><strong class="lb iu">KPrototypes </strong></code>算法将使用k-Modes算法训练分类特征，剩余的数字特征将使用标准k-Means算法训练。</p><p id="2558" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">训练后，可以使用<code class="fe ne nf ng nh b"><strong class="lb iu">cluster_centroids_()</strong></code>函数获得聚类的质心。</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="23ab" class="lv lw it nh b gy nm nn l no np"><strong class="nh iu">print(kproto.cluster_centroids_)</strong></span></pre><p id="d4df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用函数<code class="fe ne nf ng nh b"><strong class="lb iu">predict()</strong></code>来预测聚类。</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="8db4" class="lv lw it nh b gy nm nn l no np"><strong class="nh iu">clusters = kproto.predict(df_array, categorical=cat_idx)</strong></span></pre><h2 id="9798" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">实施:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)</p></figure><h1 id="886d" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">结论:</h1><p id="b4e9" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在本文中，我们讨论了如何将聚类应用于具有混合的分类和数字特征集的数据集。KPrototypes算法结合了k-Modes和k-Means算法的实现，为具有混合数据类型的数据创建分类。k-Modes算法可以处理缺失值或NaN值，但建议估算这些值以获得更好的性能。</p><p id="5a75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">kModes库的实现模仿了<code class="fe ne nf ng nh b"><strong class="lb iu">scikit-learn</strong></code>中的集群算法，并具有相同的API。</p><blockquote class="nt nu nv"><p id="bc9d" class="kz la nw lb b lc ld ju le lf lg jx lh nx lj lk ll ny ln lo lp nz lr ls lt lu im bi translated">阅读下面提到的文章中的<a class="ae ky" rel="noopener" target="_blank" href="/understanding-k-means-k-means-and-k-medoids-clustering-algorithms-ad9c9fbf47ca">以获得对k-Means、k-Means++和k-Medoids算法的更多理解。</a></p></blockquote><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/understanding-k-means-k-means-and-k-medoids-clustering-algorithms-ad9c9fbf47ca"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">了解K-means、K-means++和K-medoids聚类算法</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">了解K-means、K-means++和K-Medoids聚类算法及其关系的概述。这篇文章…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><h1 id="5cf0" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">参考资料:</h1><p id="4297" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">[1] KModes库GitHub库:<a class="ae ky" href="https://github.com/nicodv/kmodes" rel="noopener ugc nofollow" target="_blank">https://github.com/nicodv/kmodes</a></p><blockquote class="os"><p id="ce02" class="ot ou it bd ov ow ox oy oz pa pb lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>