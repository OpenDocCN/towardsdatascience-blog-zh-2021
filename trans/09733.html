<html>
<head>
<title>Excel: 2 Common Bugs, 1 Rare</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Excel: 2个常见错误，1个罕见错误</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/excel-2-common-bugs-1-rare-1cbe2dc5faef?source=collection_archive---------15-----------------------#2021-09-11">https://towardsdatascience.com/excel-2-common-bugs-1-rare-1cbe2dc5faef?source=collection_archive---------15-----------------------#2021-09-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d30d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">每个人都在使用它，确保他们知道如何使用！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0c67bc24f0b3baaba1f4c4ff296a200d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uqlr9rSHHdJe0g6eJKSxZQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约书亚·科尔曼通过Unsplash拍摄的照片</p></figure><p id="da98" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Excel才是王道。它可能被你公司的许多利益相关者使用。它通常用于快速分析。与编码相比，它的门槛相当低。这么多人在这么多报告中使用它，你几乎肯定会发现一个bug。</p><p id="1089" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将介绍两个常见的错误和一个不太常见的例子。这篇文章既可以帮助你避免这些情况，也可以帮助你为那些使用不符合事实的数字的报告的人提供指导。</p><h1 id="3eee" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">(少数派报告的红球滚下来)有数据不符！！！</h1><p id="f309" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">你戴上手套，这样你就可以浏览录像，找出问题的根源。你所有的监视器都装满了证据。你在执行任务！</p><p id="09c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有人指出，他们得出的“average_$_per_cust”值与他们在其他地方看到的值不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/d0e054a5be540f7c20e4098e0a0f8a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6n_yrzvQZ24-0pJL2wE-w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</p></figure><p id="9e51" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此报告采用了一个已经按商店按月计算了“average_$_per_customer”的列，现在它正在计算每个月的平均值。平均是不允许的！当使用“销售额”的总和/创建的公式“客户”的总和时，请注意上面数据透视表中的差异。</p><p id="f50e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可能看起来没有很大的区别，但当涉及到一些重要的决定时，这可能是一个项目的结束，这个项目实际上做得刚刚好，足以生存。</p><h1 id="4d90" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">求平均值会带来多大的麻烦？</h1><p id="ef46" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">说到平均值，最棘手的是分母的值会对结果产生相当大的影响。在这个例子中，商店10去年还没有开业，所以没有相关的销售。在我们的左栏中，我们将销售额记为0。在我们的右栏中，我们没有值。使用0将在每个观察实例的分母上加1。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/97d83d9d3956693be3081e5443941e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lHOxcSobCLAvZuhnbpA9DQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</p></figure><p id="c615" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">与计算中实际需要的9家商店相比，在10家商店之间分摊的905美元(我们假设以千计)非常不同。</p><h1 id="c5ab" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">这个有点鬼鬼祟祟</h1><p id="5df4" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我们要换个场景，请来了我们的老朋友:V-Lookup。这种情况有点古怪。我想展示一下，以防你遇到类似的情况。首先，看一下靠近输出中间的两列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/2989de94801d0ae5b7e6b74fea9a9b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CXWyzg30IOTR8QKh3MarKA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</p></figure><p id="e35e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个场景中，我们使用V-Lookup引入最右边的“客户”值，以匹配“销售”值。我们没有唯一的标识符来加入，所以创建了一个。“year_week_store_concat”列似乎不言自明。它连接了year、week和store列。这会给我们一个独特的价值，对不对？</p><p id="35dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，在我们的“cust_vlookup”列中，我们看到了值52和50的副本。如果您查看我们的“year_week_store_concat”列，您会注意到对于52的两行，这两行的查找都是2021111。第1周，商店11看起来就像第11周，商店1。使用V-Lookup，它首先找到的任何值都将被引入。</p><p id="049e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">解决办法？使用分隔符。请注意，现在我们有2021–1–11对2021–11–1。使用此方法，“delim_cust_vlookup”将正确匹配这些值！</p><h1 id="47ff" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">最后的想法</h1><p id="6c9e" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">因为将数据放入Excel文件并在几秒钟内创建数据透视表是如此容易，人们可能会忘记较小的细节。我希望你不会遇到这些问题，但是如果你遇到了，也许这些会在调试过程中有所帮助并节省你的时间。</p><p id="9195" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些都是帮助他人避免问题的很好的小技巧。理想情况下，你们将能够像一个团队一样前进，花更少的时间比较结果。一如既往，继续学习！</p><p id="c2f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于那些使用SQL的人来说，在对两个列求和时检查这个可能的错误，并解释它是如何工作的:</p><div class="mu mv gp gr mw mx"><a rel="noopener follow" target="_blank" href="/sum-a-b-vs-sum-a-sum-b-31fb094b786"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">总和(A+B)与总和(A)+总和(B)</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">粉碎SQL Bug！</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">towardsdatascience.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ks mx"/></div></div></a></div><p id="a5ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将帮助您在SQL中使用DateDiff()时避免年份计算错误:</p><div class="mu mv gp gr mw mx"><a rel="noopener follow" target="_blank" href="/using-sqls-datediff-for-age-dc0cb5b34190"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">使用SQL的DateDiff()表示年龄</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">潜在的Bug以及如何避免它</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">towardsdatascience.com</p></div></div><div class="ng l"><div class="nm l ni nj nk ng nl ks mx"/></div></div></a></div></div></div>    
</body>
</html>