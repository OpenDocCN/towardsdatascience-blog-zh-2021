<html>
<head>
<title>Bootstrapping using Python and R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和 R</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bootstrapping-using-python-and-r-b112bb4a969e?source=collection_archive---------4-----------------------#2021-11-19">https://towardsdatascience.com/bootstrapping-using-python-and-r-b112bb4a969e?source=collection_archive---------4-----------------------#2021-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7be3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用重复抽样估计抽样分布</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a7b76c15ff6ece20d50ff0649e6f10be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1GEdBjczMGZofVXQCpZ8xg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:照片由来自<a class="ae ky" href="https://pixabay.com/vectors/chart-statistics-data-histogram-3186078/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ky" href="https://pixabay.com/users/krzysztof-m-1363864/" rel="noopener ugc nofollow" target="_blank"> krzysztof-m </a>拍摄</p></figure><p id="b093" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确定一个总体特征的尝试常常受到这样一个事实的限制，即我们必须依靠一个样本来确定该总体的特征。</p><p id="ebcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在分析数据时，我们希望能够估计抽样分布，以便进行假设检验和计算置信区间。</p><p id="978e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">试图解决这个问题的一种方法是一种叫做<strong class="lb iu">自举</strong>的方法，通过重复采样来推断更广泛人群的结果。</p><p id="7b13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，为了确定同一人群的不同样本是否会产生相似的结果，理想的方法是获取新的数据样本。然而，鉴于这可能是不可能的，一种替代方法是从现有数据中随机取样。</p><p id="8036" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个示例，我们将查看一系列酒店客户的平均每日房价(ADR)的分布。具体而言，ADR 数据的子集与 bootstrapping 技术结合使用，以分析在给定较大样本量的情况下，预期的分布情况。</p><p id="e444" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用自举产生样本时，这通过替换来完成<strong class="lb iu">。这意味着可以从样品中多次选择相同的元素。</strong></p><h1 id="7232" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用 Python 引导</h1><p id="6870" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">使用从 Antonio、Almeida 和 Nunes 提供的数据集中随机抽取的 300 个酒店客户 ADR 值样本，我们将生成 5000 个大小为 300 的 bootstrap 样本。</p><p id="33f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">具体来说，numpy 如下用于生成 300 个替换样本，而循环的<strong class="lb iu">用于一次生成 300 个样本的 5000 次迭代。</strong></p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="91dc" class="mx lw it mt b gy my mz l na nb">my_samples = []<br/>for _ in range(5000):<br/>    x = np.random.choice(sample, size=300, replace=True)<br/>    my_samples.append(x.mean())</span></pre><p id="b1a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是引导样本的直方图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/1ff8fcfd43402027328e7474c508a116.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*FFo0r3M1_PbFES2XCkm2ow.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="1e8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是随机选取的 300 个原始样本的直方图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2a8ce4fc947029b1830011365e360d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*_0nRd6TChOmr921pxzlbFw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="3eca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到原始样本是显著正偏的。但是，自举样本的直方图近似于正态分布，这符合中心极限定理的假设，即随着样本大小的增加，无论原始分布的形状如何，基本数据分布都可以近似为正态分布。</p><p id="7746" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">bootstrapping 的主要用途是估计总体均值的置信区间。例如，95%的置信区间意味着我们有 95%的把握均值位于特定范围内。</p><p id="b357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">引导样本的置信区间如下:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="eb3b" class="mx lw it mt b gy my mz l na nb">&gt;&gt;&gt; import statsmodels.stats.api as sms<br/>&gt;&gt;&gt; sms.DescrStatsW(my_samples).tconfint_mean()</span><span id="c4b4" class="mx lw it mt b gy ne mz l na nb">(94.28205060553655, 94.4777529411301)</span></pre><p id="ac8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据以上所述，我们可以 95%确信真实的人口平均数在 94.28 和 94.47 之间。</p><h1 id="5f8e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用 R 自举</h1><p id="94fa" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">使用 R 中的<strong class="lb iu"> boot </strong>库，可以进行类似形式的分析。</p><p id="8c05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再次假设只有 300 个样本可用:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="ddc2" class="mx lw it mt b gy my mz l na nb">adr&lt;-sample(adr, 300)</span></pre><p id="2dcf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用带有替换的随机取样，产生这 300 个样本的 5，000 个重复。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="a5bc" class="mx lw it mt b gy my mz l na nb">x&lt;-sample(adr, 300, replace = TRUE, prob = NULL)</span><span id="7edf" class="mx lw it mt b gy ne mz l na nb">&gt; mean_results &lt;- boot(x, boot_mean, R = 5000)<br/>ORDINARY NONPARAMETRIC BOOTSTRAP</span><span id="3789" class="mx lw it mt b gy ne mz l na nb">Call:<br/>boot(data = x, statistic = boot_mean, R = 5000)</span><span id="c84e" class="mx lw it mt b gy ne mz l na nb">Bootstrap Statistics :<br/>    original      bias    std. error<br/>t1* 93.00084 -0.02135855    2.030718</span></pre><p id="44d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，以下是置信区间的计算:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8ab4" class="mx lw it mt b gy my mz l na nb">&gt; boot.ci(mean_results)<br/>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS<br/>Based on 5000 bootstrap replicates</span><span id="24fe" class="mx lw it mt b gy ne mz l na nb">CALL : <br/>boot.ci(boot.out = mean_results)</span><span id="e160" class="mx lw it mt b gy ne mz l na nb">Intervals : <br/>Level      Normal              Basic         <br/>95%   (89.04, 97.00 )   (88.98, 96.82 )</span><span id="54c1" class="mx lw it mt b gy ne mz l na nb">Level     Percentile            BCa          <br/>95%   (89.18, 97.02 )   (89.36, 97.32 )  <br/>Calculations and Intervals on Original Scale</span></pre><p id="93c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">生成自举样本的直方图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/fb0803ff7609b79b4dc0115ed9ef72cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*A9Q_9GdLbxJWU7mQrPT-mQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:RStudio 输出</p></figure><p id="7aaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当在 R 中运行时，我们可以看到置信区间比使用 Python 运行时获得的置信区间更宽。虽然原因尚不清楚，但分析仍然表明，所获得的样本平均值代表了总体水平，不可能是偶然获得的。</p><h1 id="b80f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">限制</h1><p id="ae74" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">虽然自举是从样本推断总体特征的非常有用的工具，但一个常见的错误是假设自举是解决小样本问题的方法。</p><p id="baf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如在<a class="ae ky" href="https://stats.stackexchange.com/questions/112147/can-bootstrap-be-seen-as-a-cure-for-the-small-sample-size" rel="noopener ugc nofollow" target="_blank">交叉验证</a>中所解释的，小样本量可能更不稳定，更容易与更广泛的人群产生重大偏差。因此，人们应该确保被分析的样本足够大，以便充分捕捉群体特征。</p><p id="9473" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，小样本量的另一个问题是，bootstrap 分布本身可能会变得更窄，这反过来会导致更窄的置信区间，从而显著偏离真实值。</p><h1 id="5d90" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="55d0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，您已经看到:</p><ul class=""><li id="0caa" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">bootstrapping 如何允许我们使用重复抽样来估计抽样分布</li><li id="0d7e" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">随机抽样时替换的重要性</li><li id="81ee" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">如何使用 Python 和 R 生成引导示例</li><li id="1c17" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">自举的局限性以及为什么更大的样本量更好</li></ul><p id="b64f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的宝贵时间，非常感谢您的任何问题或反馈。你可以在 michael-grogan.com 的<a class="ae ky" href="https://www.michael-grogan.com/" rel="noopener ugc nofollow" target="_blank">找到更多我的数据科学内容。</a></p><h1 id="375e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><ul class=""><li id="994f" class="ng nh it lb b lc mn lf mo li nu lm nv lq nw lu nl nm nn no bi translated"><a class="ae ky" href="https://www.sciencedirect.com/science/article/pii/S2352340918315191" rel="noopener ugc nofollow" target="_blank">安东尼奥，阿尔梅达，努内斯(2019)。酒店预订需求数据集</a></li><li id="9494" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" href="https://stats.stackexchange.com/questions/112147/can-bootstrap-be-seen-as-a-cure-for-the-small-sample-size" rel="noopener ugc nofollow" target="_blank">交叉验证:bootstrap 能被视为小样本的“治疗方法”吗？</a></li><li id="b0d0" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bootstrap.html" rel="noopener ugc nofollow" target="_blank">docs . scipy . org:scipy . stats . bootstrap</a></li><li id="a24c" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">朱利安·比留:抽样分布</li><li id="9b19" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" href="https://statisticsbyjim.com/hypothesis-testing/bootstrapping/" rel="noopener ugc nofollow" target="_blank">吉姆的《统计学:统计学中的自举法介绍及实例</a></li><li id="272a" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" href="https://uoftcoders.github.io/studyGroup/lessons/r/resampling/lesson/" rel="noopener ugc nofollow" target="_blank">多伦多大学编码器-R:Bootstrapping 和置换测试中的重采样技术</a></li></ul><p id="ec90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nx">免责声明:本文是在“原样”的基础上编写的，没有任何担保。它旨在提供数据科学概念的概述，不应被解释为专业建议。本文中的发现和解释是作者的发现和解释，不被本文中提到的任何第三方认可或隶属于任何第三方。作者与本文提及的任何第三方无任何关系。</em></p></div></div>    
</body>
</html>