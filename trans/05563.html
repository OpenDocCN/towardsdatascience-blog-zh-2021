<html>
<head>
<title>Beautiful Ridge maps with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python制作的美丽山脊图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beautiful-ridge-maps-with-python-640906a30e10?source=collection_archive---------32-----------------------#2021-05-17">https://towardsdatascience.com/beautiful-ridge-maps-with-python-640906a30e10?source=collection_archive---------32-----------------------#2021-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="83e6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何用Python快速绘制酷炫的立面图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e4e265c885f0afc1b76d4dbf9dedf23f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-RbFEvgrh0nC1jBQz0Ndmw.png"/></div></div></figure><p id="b7a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这种视觉效果是海拔图和山脊图巧妙结合的结果。</p><p id="6d12" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它使用多条水平线来表示地形的高程，就像跟踪各个纬度的峰值，一条在另一条之上。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lq"><img src="../Images/e8b87e31202d9c046ac24d57dfd9e421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kS6OyrFGuFpUJRQ_AA2T_A.png"/></div></div></figure><p id="ea4c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">结果是一个看起来非常酷的地图，它塑造了特定区域的山脉和不同的海拔高度。</p><p id="2a03" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我不确定这种可视化的实际应用，除了为一份报告制作一个好看的首页或让区域分析PowerPoint发光。但它们是一些非常吸引人的地图，值得一些关注。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="db2f" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">山脊图</h2><p id="106c" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">为了快速创建我们的可视化，我们可以使用<a class="ae mw" href="https://github.com/ColCarroll/ridge_map" rel="noopener ugc nofollow" target="_blank"> ridge_map </a>。</p><p id="6bd1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该软件包使用来自<a class="ae mw" href="https://www2.jpl.nasa.gov/srtm/" rel="noopener ugc nofollow" target="_blank">【SRTM】</a>、Matplotlib的高程数据来绘制图表，甚至用Scykit和Numpy检测湖泊。</p><p id="a760" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装后，我们可以通过导入ridge_map，运行plot_map，不需要任何参数来测试。我们应该弄一张白山的地图。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="bc56" class="ly lz it my b gy nc nd l ne nf">from ridge_map import RidgeMap</span><span id="e1a5" class="ly lz it my b gy ng nd l ne nf">RidgeMap().plot_map()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6e69cc82aabc840e1724aaaacefcc542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9f7KpqkHZMp-iIefneT21A.png"/></div></div></figure><p id="2fbe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">酷毙了。现在让我们尝试一个不同的位置。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="bfb1" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">自定义地图</h2><p id="8a51" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">首先，我们需要一些坐标。我用谷歌地图找到了它们。你也可以将地图显示为“地形”,这样你就可以知道最终的可视化效果会是什么样子。</p><p id="d3ef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦你找到你想要的，你可以在地图上点击鼠标右键来获得坐标。</p><div class="kj kk kl km gt ab cb"><figure class="ni kn nj nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/8c2272c05e4955ad8af48967713a5aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*dyb-VQtNHft9wU7XgxONTA.png"/></div></figure><figure class="ni kn no nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/7955a6f68d490842f014efebb91d5f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*_nx57d0J-uLga2FxedGywg.png"/></div></figure></div><p id="9374" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">山脊图将需要两组坐标，一组用于左下角，另一组用于右上角。</p><blockquote class="np nq nr"><p id="289d" class="ku kv ns kw b kx ky ju kz la lb jx lc nt le lf lg nu li lj lk nv lm ln lo lp im bi translated"><em class="it"> (-123.2510，49.6902，-122.1194，50.3446) <br/>(左下Long，左下Lat，右上Long，右上Lat) </em></p></blockquote><p id="f025" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Google的坐标顺序相反，Lat/ Long，所以我们需要反过来。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="b981" class="ly lz it my b gy nc nd l ne nf"># coordinates<br/>bl = [49.6902343443372, -123.25105812920076][::-1]<br/>tr = [50.34462404053542, -122.11945787458642][::-1]</span><span id="3586" class="ly lz it my b gy ng nd l ne nf">rm = RidgeMap(bl + tr)<br/>values = rm.get_elevation_data()<br/>rm.plot_map(values=rm.preprocess(values=values), label=None)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/ddcd0694f9e3e35dea01e95907f5164e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ykyf7xIIvXh9GiuMdTI8AQ.png"/></div></div></figure><p id="2444" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们首先定义RidgeMap并将坐标传递给构造函数。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="ed6f" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">获取高程数据</h2><p id="d6f2" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">然后，我们使用get_elevation_data检索一个带有我们的规范的NumPy数组。这里我们有三个方便的论据。让我们试试它们。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="d798" class="ly lz it my b gy nc nd l ne nf"># coordinates<br/>bl = [49.6902343443372, -123.25105812920076][::-1]<br/>tr = [50.34462404053542, -122.11945787458642][::-1]</span><span id="74ca" class="ly lz it my b gy ng nd l ne nf">rm = RidgeMap(bl + tr)<br/>values = rm.get_elevation_data(<strong class="my iu">num_lines=160, <br/>                               elevation_pts=800, <br/>                               viewpoint="south"</strong>)<br/>rm.plot_map(values=rm.preprocess(values=values), label=None)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/8a91ede6af96ccc34560b99a6503772f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*52d4Atmdbyka0I6J2cWm8w.png"/></div></div></figure><p id="8f86" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那更好！</p><p id="c401" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">get_elevation_data方法允许我们选择视点以及可视化的详细程度。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="99be" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">预处理</h2><p id="86ad" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">预处理方法将使我们能够配置高程比以夸大丘陵和山脉，并配置水检测。其中<code class="fe ny nz oa my b">water_ntile</code>删除基于海拔百分比的数据，而<code class="fe ny nz oa my b">lake_flatness</code>删除三个方块内的变化。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="ba5c" class="ly lz it my b gy nc nd l ne nf"># coordinates<br/>bl = [49.6902343443372, -123.25105812920076][::-1]<br/>tr = [50.34462404053542, -122.11945787458642][::-1]</span><span id="c72d" class="ly lz it my b gy ng nd l ne nf">rm = RidgeMap(bl + tr)</span><span id="67a2" class="ly lz it my b gy ng nd l ne nf">values = rm.get_elevation_data(num_lines=160, <br/>                               elevation_pts=800, <br/>                               viewpoint="south")</span><span id="e757" class="ly lz it my b gy ng nd l ne nf">rm.plot_map(values=rm.preprocess(values=values, <br/>                                 <strong class="my iu">water_ntile=0, <br/>                                 lake_flatness=8,<br/>                                 vertical_ratio=80</strong>), <br/>            label=None)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/3f169b387775bb78bb40f0bf821b46ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQUgAYdl_V1Kd7E4wWn1hQ.png"/></div></div></figure><p id="2ae7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">来自get_elevation_data和预处理的所有这些参数都是有益的，但有时使用起来很棘手。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="9117" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">绘图地图</h2><p id="4db2" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">对于更加美观的定制，我们有plot_map方法。在那里我们可以配置颜色、线宽和标签。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="d75b" class="ly lz it my b gy nc nd l ne nf"><strong class="my iu">import seaborn as sb<br/>cmap = sb.light_palette("#69d", as_cmap=True)</strong></span><span id="5d5f" class="ly lz it my b gy ng nd l ne nf"># coordinates<br/>bl = [49.6902343443372, -123.25105812920076][::-1]<br/>tr = [50.34462404053542, -122.11945787458642][::-1]</span><span id="ee0d" class="ly lz it my b gy ng nd l ne nf">rm = RidgeMap(bl + tr)</span><span id="57a1" class="ly lz it my b gy ng nd l ne nf">values = rm.get_elevation_data(num_lines=160, <br/>                               elevation_pts=800, <br/>                               viewpoint="south")</span><span id="9af1" class="ly lz it my b gy ng nd l ne nf">rm.plot_map(values=rm.preprocess(values=values, <br/>                                 water_ntile=0, <br/>                                 lake_flatness=8, <br/>                                 vertical_ratio=80), <br/>          <strong class="my iu">  label=None,<br/>            line_color=cmap,<br/>            kind="gradient",<br/>            linewidth=1,<br/>            background_color='black',<br/>            size_scale=15</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/b88bccdf84ee15032d9e6ebdb4e99569.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pG08j0nLprdTbTVjHS9YpA.png"/></div></div></figure><p id="da8a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">山脊图允许我们进行大量的定制。对于所有其他的，我们也有Matplotlib。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h2 id="0d2a" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">Matplotlib</h2><p id="d905" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">plot_map方法返回轴，所以我们可以根据自己的需要进行修改。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="c7ed" class="ly lz it my b gy nc nd l ne nf">import seaborn as sb<br/><strong class="my iu">import matplotlib.pyplot as plt</strong></span><span id="e55b" class="ly lz it my b gy ng nd l ne nf">cmap = sb.light_palette("#69d", as_cmap=True)</span><span id="eaa7" class="ly lz it my b gy ng nd l ne nf"># coordinates<br/>bl = [49.6902343443372, -123.25105812920076][::-1]<br/>tr = [50.34462404053542, -122.11945787458642][::-1]<br/><strong class="my iu">whistler = [50.11262255339053, -122.96522325554356][::-1]</strong></span><span id="93ba" class="ly lz it my b gy ng nd l ne nf">rm = RidgeMap(bl + tr)</span><span id="8b90" class="ly lz it my b gy ng nd l ne nf"># convert annotation coordinates<br/><strong class="my iu">whistler_coords = ((whistler[0] - rm.longs[0])/(rm.longs[1] - rm.longs[0]),(whistler[1] - rm.lats[0])/(rm.lats[1] - rm.lats[0]))</strong></span><span id="dfa8" class="ly lz it my b gy ng nd l ne nf">values = rm.get_elevation_data(num_lines=160, <br/>                               elevation_pts=800, <br/>                               viewpoint="south")</span><span id="638a" class="ly lz it my b gy ng nd l ne nf"><strong class="my iu">ax = </strong>rm.plot_map(values=rm.preprocess(values=values, <br/>                                 water_ntile=0, <br/>                                 lake_flatness=8, <br/>                                 vertical_ratio=80), <br/>            label=None,<br/>            line_color=cmap,<br/>            kind="gradient",<br/>            linewidth=1,<br/>            background_color='black',<br/>            size_scale=15)</span><span id="19b0" class="ly lz it my b gy ng nd l ne nf"><strong class="my iu">ax.plot(*whistler_coords, '.',<br/>        color='white',<br/>        transform=ax.transAxes,<br/>        zorder=len(values)+10)</strong></span><span id="afe5" class="ly lz it my b gy ng nd l ne nf"><strong class="my iu">ax.text(whistler_coords[0]+0.01, <br/>        whistler_coords[1]+0.02, <br/>        'Whistler',<br/>        fontproperties=rm.font,<br/>        size=20,<br/>        color="white",<br/>        backgroundcolor='black',<br/>        transform=ax.transAxes,<br/>        verticalalignment="bottom",<br/>        zorder=len(values)+10)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/96491fa6bac124280ca2d7d5943ba198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WrnLnUrd2IwFBDpyPTZHPg.png"/></div></div></figure><p id="102e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">总的来说，根据我的经验，这种可视化需要大量的实验。因为它更具艺术性而非分析性，你需要测试不同的变量，看看会发生什么，直到你找到你喜欢的东西。</p><p id="de6b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">尽管我不需要这样的地图，但我从这些可视化中获得了很多乐趣，并将再次使用它们来美化我的演示。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="5f9a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我用<a class="ae mw" href="https://github.com/ColCarroll/ridge_map" rel="noopener ugc nofollow" target="_blank">山脊图</a>创建了这篇文章中的所有图像。你可以随意使用它们。</p><p id="58d7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读。希望你喜欢:)</p><p id="702d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae mw" href="https://linktr.ee/admin/settings#Settings--SocialLinks" rel="noopener ugc nofollow" target="_blank">更多Python DataViz教程</a>。</p><p id="278f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">【参考文献:】<br/><a class="ae mw" href="https://github.com/ColCarroll/ridge_map" rel="noopener ugc nofollow" target="_blank">https://github.com/ColCarroll/ridge_map</a>；<br/><a class="ae mw" href="https://github.com/tkrajina/srtm.py" rel="noopener ugc nofollow" target="_blank">https://github.com/tkrajina/srtm.py</a>；</p></div></div>    
</body>
</html>