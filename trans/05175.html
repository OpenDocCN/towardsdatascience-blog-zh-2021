<html>
<head>
<title>Enterprise-grade multi platform Virtual Assistant with Google Dialogflow &amp; Flutter (Part III)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Dialogflow &amp; Flutter的企业级多平台虚拟助理(第三部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/enterprise-grade-multi-platform-virtual-assistant-with-google-dialogflow-flutter-part-iii-303dcd6b9d01?source=collection_archive---------31-----------------------#2021-05-06">https://towardsdatascience.com/enterprise-grade-multi-platform-virtual-assistant-with-google-dialogflow-flutter-part-iii-303dcd6b9d01?source=collection_archive---------31-----------------------#2021-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7ee4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第三部分:在Flutter中设计一个简单的iOS应用程序，与您的Dialogflow代理进行通信</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/56acd62ea26d55c8e0f5da5cd7115e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/1*P3q0s3tSdiO54WomSMgVtw.gif"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片:作者</p></figure><h2 id="121d" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">参见<a class="ae ln" rel="noopener" target="_blank" href="/enterprise-grade-multi-platform-virtual-assistant-with-google-dialogflow-flutter-part-i-da6f05edfed">第一部分</a>和<a class="ae ln" rel="noopener" target="_blank" href="/enterprise-grade-multi-platform-virtual-assistant-with-google-dialogflow-and-flutter-part-ii-343327236d8f">第二部分</a></h2><h1 id="5adb" class="lo ks iq bd kt lp lq lr kw ls lt lu kz jw lv jx ld jz lw ka lh kc lx kd ll ly bi translated">1)第二部分概述</h1><p id="0493" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh la mi mj mk le ml mm mn li mo mp mq mr ij bi translated">上一篇文章描述了如何使用Google Dialogflow构建一个简单的聊天机器人，它能够使用Euler Hermes Open Data web services API在两个国家之间交换贸易流。表示层依靠Google Assistant来显示结果。但是你可能已经注意到谷歌助手是非常有限的，因为你不能自定义组件的布局。例如，<em class="ms">表格</em>对象最多可以显示4–5列，无需任何水平滚动。</p><h1 id="71de" class="lo ks iq bd kt lp lq lr kw ls lt lu kz jw lv jx ld jz lw ka lh kc lx kd ll ly bi translated">2)本文的总结</h1><p id="ba06" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh la mi mj mk le ml mm mn li mo mp mq mr ij bi translated">这一条的目标如下:</p><ul class=""><li id="9a30" class="mt mu iq mb b mc mv mf mw la mx le my li mz mr na nb nc nd bi translated">超越谷歌助手布局的限制</li><li id="c5c7" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">设计一个简单的颤振多平台应用程序，能够:</li><li id="9a5a" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">&gt;安全认证并使用我们的Dialogflow代理</li><li id="1cf8" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">&gt;在移动设备上显示丰富灵活的用户界面(这里是iOS，但也可以是Android或Web应用程序)</li><li id="d498" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">&gt;管理定制的<em class="ms">有效负载</em> Dialogflow消息，以在Dialogflow和我们的Flutter应用程序之间交换信息</li></ul><p id="568c" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">额外的好处是设计的移动应用程序将是动态的。它可以根据从NLP对话后端引擎发送的有效负载消息中包含的业务逻辑做出反应并显示组件。</p><h1 id="6616" class="lo ks iq bd kt lp lq lr kw ls lt lu kz jw lv jx ld jz lw ka lh kc lx kd ll ly bi translated">3)颤振引入和SDK安装</h1><p id="1548" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh la mi mj mk le ml mm mn li mo mp mq mr ij bi translated">Flutter是Google的UI工具包，用于从单个代码库构建<strong class="mb ir">本地</strong>编译的移动、网络和桌面应用。与同等框架相比，本机意味着高性能。</p><p id="fdb4" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">你可以在这里浏览下面的链接<a class="ae ln" href="https://flutter.dev/showcase" rel="noopener ugc nofollow" target="_blank">来探索Flutter的showcase，它展示了使用该框架的一些特性和例子。</a></p><p id="0d05" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">下载和安装Flutter SDK的说明可以在<a class="ae ln" href="https://flutter.dev/docs/get-started/install" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="1ad0" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">您可能还需要安装额外的组件(<em class="ms"> XCode </em> for MacOS…)，这取决于您正在使用的操作系统(MacOS、Windows、Linux)以及您想要用于测试的目标平台(iOS、Android、Web)。</p><p id="f626" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">最后，您还需要安装一个开发环境。这里，我们将使用与Flutters和XCode很好集成的IntelliJ。<a class="ae ln" href="https://www.jetbrains.com/idea/download/" rel="noopener ugc nofollow" target="_blank">下载</a>请到以下链接。</p><h1 id="3ea0" class="lo ks iq bd kt lp lq lr kw ls lt lu kz jw lv jx ld jz lw ka lh kc lx kd ll ly bi translated">4)重新审视了对话流履行代码</h1><p id="8788" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh la mi mj mk le ml mm mn li mo mp mq mr ij bi translated">让我们开始稍微改变一下我们以前的文章(NodeJS)中写的Google dialog flow Cloud fulfillment函数。这里的想法是改变代码的方式，它将继续与谷歌助理和我们新的颤振iOS应用程序。</p><p id="6191" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">这意味着我们的代理人的行为会根据打电话的客户而变化。基本上，添加了一些条件来区分Google Assistant消息和我们移动应用程序的消息。</p><p id="db19" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">这些条件检查了<em class="ms"> agent.requestSource </em>的内容<em class="ms">。ACTIONS_ON_GOOGLE' </em>表示请求来自Google Assistant。如果<em class="ms"> agent.requestSource </em>为<em class="ms"> null </em>，我们认为它来自我们的移动Flutter应用程序。(参见带有“//移动应用程序”注释的代码)</p><p id="28dc" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">您可能知道，如果您向除Google Assistant之外的任何其他应用程序发送Google Assistant消息，而Google Assistant不是为此设计的(Web、移动应用程序)，那么您发送的消息将被Dialogflow上的错误拒绝，并且您的组件将不会显示。</p><p id="052e" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">那么，还有办法在web或移动应用程序中显示一个<em class="ms">表</em>或任何其他Google Assistant组件吗？答案是肯定的！</p><p id="c3a3" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">在这段代码中，请注意使用<strong class="mb ir"> <em class="ms">有效载荷</em> </strong>消息的部分，以避免Dialogflow出现此错误消息。构建一个<em class="ms">表</em>对象，然后将其JSON表示存储到<em class="ms">有效负载</em>消息中。稍后您将看到，这条消息将作为响应发送回移动应用程序。然后，移动应用程序将解析它，并使用一个新的表格小部件向用户显示响应。</p><p id="9b70" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated"><strong class="mb ir">履行源代码:</strong></p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="270c" class="kr ks iq nn b gy nr ns l nt nu">  // .<br/>  // Euler Hermes Trade Flows and Payment Handler - Google Assistant<br/>  // . <br/>  function exportsVSClaimsEHHandler(agent) {   <br/><br/>    let conv = agent.conv(); <br/>    var parameters = "";<br/>    // Google Assistant Connection<br/>    if (agent.requestSource === 'ACTIONS_ON_GOOGLE') {<br/>      	parameters = conv.parameters;<br/>    } <br/>    // Mobile Connection<br/>    else if (agent.requestSource == null) { <br/>       	parameters = agent.parameters;<br/>    }  <br/>    console.log("=======&gt; Parameters " + parameters);<br/>    var countryCodeExport = parameters['geo-country-code-export'];<br/>    var countryCodeImport = parameters['geo-country-code-import'];<br/>    var periodFrom = parameters['date-period-from'];<br/>    var periodTo = parameters['date-period-to'];<br/>    var filter = parameters['filter'];<br/>    var topNN = parameters['topnn']; <br/><br/>    return getTradeFlows(countryCodeExport, countryCodeImport, periodFrom, periodTo, filter, topNN)<br/>       	.then((rows) =&gt; {<br/><br/><br/>    // Google Assistant Connection<br/>    if (agent.requestSource === 'ACTIONS_ON_GOOGLE') {<br/>          <br/>          if (rows.length === 0) {<br/>            conv.ask(`No data has been found for this selection`);<br/>            conv.ask(new Suggestions(intentSuggestions));<br/>            return;<br/>          } <br/><br/>          conv.ask(`Here's the Trade Flows and Payment Defaults data`);<br/>          conv.ask(new Table({<br/>            title: 'Trade Flows/Payment Defaults',<br/>              subtitle: 'Euler-Hermes OpenData',<br/>              image: new Image({<br/>                  url: 'https://s3-eu-west-1.amazonaws.com/aws-ec2-eu-1-opendatasoft-staticfileset/euler-hermes/logo?tstamp=155013988259',<br/>                  alt: 'Alt Text',<br/>              }),           <br/>              dividers: true,<br/>              columns: ['Sector Group', 'Sector', <br/>                  {<br/>                      header: 'Export Amount',<br/>                      align: 'TRAILING',<br/>                  }, <br/>                  {<br/>                      header: 'Claim Amount',<br/>                      align: 'TRAILING',<br/>                  },       <br/>                  {<br/>                      header: 'Traff. Light',<br/>                      align: 'CENTER',<br/>                  }],<br/>              rows: rows    <br/>          }));<br/><br/>          conv.ask(new Suggestions(intentSuggestions));<br/><br/>          agent.add(conv); <br/><br/>       }  <br/><br/><br/>      // Mobile Connection<br/>      if (agent.requestSource == null) {<br/><br/>        if (rows.length === 0) {<br/>          agent.add(`No data has been found for this selection`);<br/>          agent.add(new Suggestions(intentSuggestions));<br/>          return;<br/>        } <br/><br/>        agent.add(`Here's the Trade Flows and Payment Defaults data`);<br/>        let payload = new Table({<br/>          title: 'Trade Flows/Payment Defaults',<br/>          subtitle: 'Euler-Hermes OpenData',<br/>          image: new Image({<br/>            url: 'https://s3-eu-west-1.amazonaws.com/aws-ec2-eu-1-opendatasoft-staticfileset/euler-hermes/logo?tstamp=155013988259',<br/>            alt: 'Alt Text',<br/>          }),           <br/>          dividers: true,<br/>          columns: ['Sector Group', 'Sector', <br/>                    {<br/>                      header: 'Export Amount',<br/>                      align: 'TRAILING',<br/>                    }, <br/>                    {<br/>                      header: 'Claim Amount',<br/>                      align: 'TRAILING',<br/>                    },       <br/>                    {<br/>                      header: 'Traff. Light',<br/>                      align: 'CENTER',<br/>                    }],<br/>          rows: rows    <br/>        });<br/><br/><br/>        var rr = new RichResponse("Trade Flows for mobile", payload);<br/>        rr.platform = 'ACTIONS_ON_MOBILE';<br/>        rr.type = 'tableCard';<br/>        agent.add(new Payload('platform: ACTIONS_ON_MOBILE', rr, {rawPayload: true, sendAsMessage: true}));<br/>      <br/>        //agent.add(new Suggestions(intentSuggestions));<br/><br/>      }  <br/><br/>      <br/><br/>    });<br/><br/><br/> }</span></pre><h1 id="71d0" class="lo ks iq bd kt lp lq lr kw ls lt lu kz jw lv jx ld jz lw ka lh kc lx kd ll ly bi translated">5)设置一个与我们的Dialogflow代理通信的简单iOS应用程序</h1><p id="6657" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh la mi mj mk le ml mm mn li mo mp mq mr ij bi translated">在这里，我们将创建一个带有IntelliJ的iOS应用程序，它与我们的代理进行通信。对于Android手机来说，这应该是完全相同的步骤，这是使用<em class="ms"> Flutter </em>的主要好处之一。您可以用相同的代码定位几个平台。</p><p id="dba0" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated"><strong class="mb ir">颤振应用设置</strong></p><p id="5b5b" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">一旦设置好您的<em class="ms"> Flutter </em>和<em class="ms"> IntelliJ </em>环境，请创建一个新的<em class="ms"> Flutter </em>应用程序，并根据您的需要命名，例如:<strong class="mb ir"><em class="ms">business _ API _ chatbot</em>。</strong></p><p id="b100" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">然后，打开iOS模拟器，创建一个新的iOS 12设备。</p><p id="3227" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">当您准备好运行应用程序时，您的屏幕应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/aa92aceebc2bf59e27b813dca4104574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yVh7mBl_IfLaZHAEsTUJXA.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片:Autor</p></figure><p id="edd6" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated"><strong class="mb ir"> API密钥设置</strong></p><p id="8ca4" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">首先，进入<em class="ms">谷歌云平台</em>控制台，在左侧菜单中选择“<em class="ms"> API和服务</em>，然后选择“<em class="ms">凭证”</em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi oa"><img src="../Images/3b0d84f24ce47ca53509beaeaf967e5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XTGKtPP2z5j2YYXJExFgxQ.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片:Autor</p></figure><p id="de2f" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">创建并下载API密匙，它将允许您从<em class="ms"> Flutter </em>应用程序与您的Dialogflow代理进行通信。</p><p id="d4d7" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">将密钥命名为'<em class="ms"> credentials.json </em>，并将密钥保存到您之前创建的<em class="ms"> Flutter </em>应用程序的'<em class="ms"> assets </em>文件夹中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi ob"><img src="../Images/839db0fa5b3f1c8480a9d9b908ef781b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbDcQTjuvjeuTWR7uxHzaw.png"/></div></div></figure><p id="1ebb" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">编辑'<em class="ms"> pubspec.yaml </em>'文件，确保'<em class="ms"> asset </em>'条目设置如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi oc"><img src="../Images/f2e63cb69aa53076b78a752f9e5d8903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_0Pzd7Y0AJ3M1pSd-MJdw.png"/></div></div></figure><h1 id="0cf9" class="lo ks iq bd kt lp lq lr kw ls lt lu kz jw lv jx ld jz lw ka lh kc lx kd ll ly bi translated">6)向我们的iOS应用程序添加新的小部件，以显示从我们的Dialogflow代理发送的Euler Hermes数据</h1><p id="e0c8" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh la mi mj mk le ml mm mn li mo mp mq mr ij bi translated">最终的应用程序实际上能够显示几个小部件:<em class="ms">简单消息</em>、<em class="ms">基本卡片</em>、<em class="ms">转盘</em>和<em class="ms">数据表</em>。但是在这里，我们将只关注将在以下部分创建的<em class="ms">简单消息</em>和<em class="ms">数据表</em>。</p><p id="f405" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">首先，我们需要创建我们的移动消息结构，它应该反映从我们的Dialogflow代理发送的<em class="ms">有效负载</em>消息结构。</p><p id="7564" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">基本上，包含Euler Hermes数据的<em class="ms">有效负载</em>消息由列标题和数据行组成:</p><ul class=""><li id="9196" class="mt mu iq mb b mc mv mf mw la mx le my li mz mr na nb nc nd bi translated">集团部门</li><li id="8242" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">部门</li><li id="86a9" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">两国间的出口量</li><li id="0104" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">两个国家之间的索赔金额</li><li id="4064" class="mt mu iq mb b mc ne mf nf la ng le nh li ni mr na nb nc nd bi translated">交通灯(绿色、琥珀色、红色)</li></ul><p id="659c" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated"><em class="ms"> TableCard </em>类将存储从我们的Dialogflow代理接收的<em class="ms">有效负载</em>消息提供的所有信息。</p><p id="0c79" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">请注意，<em class="ms"> TypeMobileMessage </em>类确保只执行<em class="ms">有效载荷</em>消息类型。</p><p id="2a97" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">现在，请创建一个新的Dart文件，命名如下:<strong class="mb ir"> mobile_message.dart </strong></p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="bdab" class="kr ks iq nn b gy nr ns l nt nu">class TableColumn {<br/>  String colHeader;<br/>  TableColumn(Map column){<br/>    this.colHeader = column['header'];<br/>  }<br/>}<br/><br/><br/>class TableRow {<br/>  String sectorGroup;<br/>  String sector;<br/>  String exportAmount;<br/>  String claimAmount;<br/>  String trafficLight;<br/>  TableRow(Map row){<br/>    this.sectorGroup = row['cells'][0]['text'];<br/>    this.sector = row['cells'][1]['text'];<br/>    this.exportAmount = row['cells'][2]['text'];<br/>    this.claimAmount = row['cells'][3]['text'];<br/>    this.trafficLight = row['cells'][4]['text'];<br/>  }<br/>}<br/><br/><br/>class TableCard {<br/>  List&lt;TableColumn&gt; cols=[];<br/>  List&lt;TableRow&gt; rows=[];<br/>  TableCard(Map response){<br/>    List&lt;dynamic&gt; listCols = response['payload']['items'][1]['tableCard']['columnProperties'];<br/>    for(var i=0;i&lt;listCols.length;i++){<br/>      cols.add(new TableColumn(listCols[i]));<br/>    }<br/>    List&lt;dynamic&gt; listRows = response['payload']['items'][1]['tableCard']['rows'];<br/>    for(var i=0;i&lt;listRows.length;i++){<br/>      rows.add(new TableRow(listRows[i]));<br/>    }<br/>  }<br/>}<br/><br/><br/>class TypeMobileMessage{<br/>  String platform;<br/>  String type;<br/>  TypeMobileMessage(Map message){<br/>    if (message.containsKey("payload")) {<br/>      this.platform = message['payload']['platform'];<br/>      this.type = message['payload']['type'];<br/>    }<br/>  }<br/>}</span></pre><p id="f81a" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">现在让我们看看如何在我们的移动应用程序中显示一条简单的文本消息。下面是一个简单的文本小部件的代码，当我们的Dialogflow代理向移动应用程序发回一个回答时，将显示这个小部件。一个谷歌助理图标将与文本消息一起显示，让用户可以轻松识别答案来自我们的Dialogflow代理。</p><p id="5f72" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">请创建新的Dart文件，并将其命名为:<strong class="mb ir"> simple_message.dart </strong></p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="1ea0" class="kr ks iq nn b gy nr ns l nt nu">import 'package:flutter/material.dart';<br/>import 'package:flutter/widgets.dart';<br/><br/>class SimpleMessage extends StatelessWidget {<br/>  SimpleMessage({this.text, this.name, this.type});<br/><br/>  final String text;<br/>  final String name;<br/>  final bool type;<br/><br/>  List&lt;Widget&gt; otherMessage(context) {<br/>    return &lt;Widget&gt;[<br/>      new Container(<br/>        margin: const EdgeInsets.only(right: 16.0),<br/>        child: new CircleAvatar(<br/>          child: new Image.asset("img/googleasistant.png"),<br/>          backgroundColor: Colors.<em class="ms">transparent</em>,<br/>        ),<br/>      ),<br/>      new Expanded(<br/>        child: new Column(<br/>          crossAxisAlignment: CrossAxisAlignment.start,<br/>          children: &lt;Widget&gt;[<br/>            new Container(<br/>              margin: const EdgeInsets.only(top: 5.0),<br/>              decoration: BoxDecoration(<br/>                  color: Colors.<em class="ms">white</em>,<br/>                  borderRadius: BorderRadius.all(Radius.circular(20.0))),<br/>              child: Padding(<br/>                padding: EdgeInsets.only(<br/>                    top: 10.0, bottom: 10.0, left: 10.0, right: 10.0),<br/>                child: new Text(text, style: TextStyle(color: Colors.<em class="ms">black</em>),),<br/>              ),<br/>            ),<br/>          ],<br/>        ),<br/>      ),<br/>    ];<br/>  }<br/><br/><br/><br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return new Container(<br/>      margin: const EdgeInsets.symmetric(vertical: 10.0),<br/>      child: new Row(<br/>        crossAxisAlignment: CrossAxisAlignment.start,<br/>        children: this.type ? myMessage(context) : otherMessage(context),<br/>      ),<br/>    );<br/>  }<br/>}</span></pre><p id="62d8" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">使用新的文本小部件后，您的应用程序应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/c902ec7d7de2ac13ab6400d41444f22c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/1*3xfkT1QwK_tdX39PyelhCg.gif"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片:Autor</p></figure><p id="9f00" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">最后一步是创建一个新的<strong class="mb ir"> <em class="ms">表</em> </strong>小部件，它将包含我们来自Euler Hermes的数据。请使用以下代码创建一个新的Dart文件，并将其命名为:<strong class="mb ir"> tableHorizCard.dart </strong></p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="8590" class="kr ks iq nn b gy nr ns l nt nu">import 'package:business_api_chatbot/mobile_message.dart';<br/>import 'package:flutter/material.dart';<br/>import 'package:flutter/widgets.dart';<br/><br/><br/><br/>class TableHorizCardWidget extends StatelessWidget {<br/><br/>  TableHorizCardWidget({this.tableCard});<br/>  final TableCard tableCard;<br/><br/>  // This widget is the root of your application.<br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return Container(<br/>      child: Scaffold(<br/>        //backgroundColor: Colors.black54,<br/>        //appBar: AppBar(),<br/>        body: Center(<br/>          child: Container(<br/>            color: Colors.<em class="ms">white</em>,<br/>            height: 500,<br/>            child: SingleChildScrollView(<br/>              scrollDirection: Axis.vertical,<br/>              child: SingleChildScrollView(<br/>                scrollDirection: Axis.horizontal,<br/>                child: DataTable(<br/>                  columns:<br/>                      &lt;DataColumn&gt;[<br/>                        DataColumn(<br/>                          label: Text(tableCard.cols[0].colHeader, style: TextStyle(fontWeight: FontWeight.<em class="ms">bold</em>)),<br/>                        ),<br/>                        DataColumn(<br/>                          label: Text(tableCard.cols[1].colHeader, style: TextStyle(fontWeight: FontWeight.<em class="ms">bold</em>)),<br/>                        ),<br/>                        DataColumn(<br/>                          label: Text(tableCard.cols[2].colHeader, style: TextStyle(fontWeight: FontWeight.<em class="ms">bold</em>)), numeric:true,<br/>                        ),<br/>                        DataColumn(<br/>                          label: Text(tableCard.cols[3].colHeader, style: TextStyle(fontWeight: FontWeight.<em class="ms">bold</em>)), numeric:true,<br/>                        ),<br/>                        DataColumn(<br/>                          label: Text(tableCard.cols[4].colHeader, style: TextStyle(fontWeight: FontWeight.<em class="ms">bold</em>)),<br/>                        ),<br/>                  ],<br/>                  rows: &lt;DataRow&gt;[<br/>                    for (var item in tableCard.rows)<br/>                      DataRow(<br/>                        cells: &lt;DataCell&gt;[<br/>                          DataCell(Text(item.sectorGroup)),<br/>                          DataCell(Text(item.sector)),<br/>                          DataCell(Text(item.exportAmount, textAlign:TextAlign.right,)),<br/>                          DataCell(Text(item.claimAmount, textAlign:TextAlign.right)),<br/>                          DataCell(Text(<br/>                                item.trafficLight, textAlign: TextAlign.center,<br/>                                style: TextStyle(backgroundColor: item.trafficLight == "R" ? Colors.<em class="ms">red </em>: Colors.<em class="ms">green</em>))),<br/>                        ],<br/>                    ),<br/>                  ],<br/>                ),<br/>              ),<br/>            ),<br/>          ),<br/>        ),<br/>      ),<br/>      height: MediaQuery<br/>          .<em class="ms">of</em>(context)<br/>          .size<br/>          .height,<br/>    );<br/>  }<br/>}</span></pre><p id="3b12" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">使用这个新的<em class="ms">表</em>小部件，您的应用程序应该是这样的。对于我们的文章来说，这个类是非常简单的，但是只需很小的努力就可以有一个复杂得多的布局。例如，固定列显示机制可以在水平滚动中实现。</p><p id="4207" class="pw-post-body-paragraph lz ma iq mb b mc mv jr me mf mw ju mh la nj mj mk le nk mm mn li nl mp mq mr ij bi translated">请注意，您的移动应用程序的行为类似于我们在上一篇文章中创建的Google Assistant应用程序。但是，有了这个移动应用程序，有无限的可能性来创建新的丰富的窗口小部件与<em class="ms">摆动</em>，没有更多的布局限制！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/56acd62ea26d55c8e0f5da5cd7115e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/1*P3q0s3tSdiO54WomSMgVtw.gif"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片:Autor</p></figure></div></div>    
</body>
</html>