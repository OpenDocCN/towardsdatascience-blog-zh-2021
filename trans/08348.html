<html>
<head>
<title>NLP: Splitting Text into Sentences</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然语言处理:将文本分割成句子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/nlp-splitting-text-into-sentences-7bbce222ef17?source=collection_archive---------11-----------------------#2021-08-01">https://towardsdatascience.com/nlp-splitting-text-into-sentences-7bbce222ef17?source=collection_archive---------11-----------------------#2021-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a9d2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将文本转换成句子的语言不可知模型</h2></div><p id="04be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将文本数据拆分成句子可以被认为是一项简单的任务，可以用“.”将文本拆分成句子或'/n '个字符。然而，在自由文本数据中，这种模式是不一致的，作者可以在句子中间换行或使用“.”在错误的地方。例如，这种现象在医疗访问摘要文本和会话/消息文本中很常见。</p><p id="cf6d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了克服这一点，为了开发一个可以在任何语言中使用的通用模型，我们将在本帖中分享一个深度学习模型，它可以决定两个句子是否需要合并。</p><p id="39f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将按照所有常用字符来拆分文本。例如'/n '，然后给定两个句子，模型将决定它们是否必须合并。因此，这个模型将会给我们一个新的句子划分。</p><h1 id="4a03" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">创建数据集</h1><p id="ad7c" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">为了创建用于训练的数据集，考虑文章/案例/对话的列表，例如，来自维基百科的文章列表。我们将肯定对定义为一对应该分开的句子，并保留两个带有“.”的不同句子他们之间。否定对是应该合并的一对句子，认为是一个句子，没有“.”他们之间。我们将使用<em class="ly"> nltk.sent_tokenize </em>函数创建正对，用“.”分割文本，这在大多数情况下是正确的，并且会让模型学习“.”的机制和作用性格。我们将通过在中间拆分句子来创建否定对，这意味着我们实际上不想拆分句子。我们使用<em class="ly">min _ sentence _ length _ for _ splitting</em>参数来定义我们想要为否定对拆分的最小句子长度(我们不想拆分太短的句子)。创建数据集的代码示例:</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="87ba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正对的例子:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mg"><img src="../Images/d38a543d38acc59441b0eecad653aa23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vB4QnBm7R6vkaExoA4G6-w.png"/></div></div></figure><p id="09ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">负对的例子:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mn"><img src="../Images/e0950cf3a1d4d9d8e7ce55fada52164a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MkDoXordONMOb9QKxO5idw.png"/></div></div></figure><h1 id="e9ed" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">模型</h1><p id="ffa0" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">我们训练了一个深度学习模型，它将这两个句子作为输入。对于第一句话，我们应用前向LSTM层，对于第二句话，我们应用后向LSTM层。我们使用一个前向层和一个后向层来预测我们是否应该有一个“.”在中间，所以我们期望第一句的向前传递嵌入第一句结尾的模式，第二句的向后传递嵌入第二句开头的模式。</p><p id="ec46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们连接两个嵌入来表示两个句子的结束和开始意义，以便预测它们是否应该被拆分(应该有一个'.'他们之间或者没有)。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mo"><img src="../Images/ad02a9e264438a6087ffbdc947b22d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OjK0I3yl04ZU_JD94LQpHw.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">模型架构</p></figure><p id="2ead" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的代码准备了语料库并训练了一个标记器，该标记器用于将不同大小的句子转换成相同大小的序列。</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="3628" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">X dataset是一个numpy数组，大小为<em class="ly">[样本数，2，句子长度]，</em> y是一个数组，其中1-表示分裂的句子，0-表示合并的句子。</p><p id="f1bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们训练深度学习模型:</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="fb58" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们想把我们的模型应用到新的看不见的文本上。我们使用<em class="ly">奥运会</em>维基百科页面，并从那里摘录句子。</p><p id="8667" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的transform函数，得到一个分隔句子的列表，并返回合并后的句子作为一个新的文本分割成句子的列表。</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="6a5d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们随机拆分句子，并期望模型将它们合并成一个句子:</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="477a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出是:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mt"><img src="../Images/b0eee987c4bd5a8183eca94148db520b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JuMudAF1adOQHHcNYhVFKw.png"/></div></div></figure><p id="4b76" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">意味着模型正确地决定合并所有三个句子。</p><p id="f01a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个例子，我们给了模型2分离的句子，我们希望它保持分离。</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="a514" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出是:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mu"><img src="../Images/c9400aae5efb5762c8f60c665f291f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uX-1Kfd9ZTG17G47UNWZdQ.png"/></div></div></figure><p id="c98d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着模型正确地决定将这两个句子分开。</p><h1 id="2b22" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">结论</h1><p id="ad16" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">上述模型可以用任何语言训练，只需要创建数据集。然后，训练该模型来决定是否需要将两个句子合并成一个句子或者保持为两个分开的句子。该模型可用于预测新句子对的拆分/合并，并可应用于任何由常用字符拆分成句子的文本，并提供句子的新划分。</p><p id="15dd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在一个SentenceSplitter类中总结了上述所有代码:</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="0822" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽情享受吧！</p></div></div>    
</body>
</html>