<html>
<head>
<title>Easy way to create Live and Staging environments for your Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的数据创建实时和暂存环境的简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/easy-way-to-create-live-and-staging-environments-for-your-data-e4f03eb73365?source=collection_archive---------15-----------------------#2021-05-03">https://towardsdatascience.com/easy-way-to-create-live-and-staging-environments-for-your-data-e4f03eb73365?source=collection_archive---------15-----------------------#2021-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="057d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从使用数据表单的SQL转换的数据图开始</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6dc0ccb605c65f7754a76c16c5aa98a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gAG0y6x8OuoB4Gk0CK57IA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据形式依赖图。作者图片</p></figure><p id="36be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi lu translated"><span class="l lv lw lx bm ly lz ma mb mc di"> L </span>假设您正在使用BigQuery、Snowflake、Redshit等构建您的<strong class="la iu">数据仓库</strong>解决方案。您的任务是创建一些报告，并且您需要为您每天进行的SQL转换创建<strong class="la iu">生产</strong>和<strong class="la iu">测试</strong>环境。</p><p id="1f6e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能希望将数据转换作为代码运行，将更改推送到git存储库。您还在寻找一种简单易用的方法来记录一切，运行SQL单元测试，并在数据仓库出现问题时接收通知警报。</p><p id="5043" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个理想的方法是创建两个独立的数据项目<strong class="la iu">,这两个数据项目不重叠，如果需要的话可以很容易地删除。举个例子，</strong></p><blockquote class="md me mf"><p id="5d33" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated">我想创建一个隔离的<strong class="la iu"> staging </strong>数据项目，然后删除与之相关的所有资源。</p></blockquote><p id="7989" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个琐碎的任务，可以通过<strong class="la iu"> AWS Cloudformation </strong>或<strong class="la iu"> Terraform </strong>(与<strong class="la iu">谷歌云平台</strong>更相关)轻松完成，数据工程师经常被分派这项任务。</p><p id="980b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个教程中，我将使用BigQuery。这是我个人最喜欢的数据仓库解决方案，而且是免费的(如果你处理少量数据，比如在<code class="fe mk ml mm mn b">staging</code>上)。你也可以用类似雪花的东西。30天免费。设置将非常相似。</p><blockquote class="md me mf"><p id="5ecf" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated">环境的一个常见用例是为您的SQL运行分阶段发布流程。</p></blockquote><p id="e174" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<strong class="la iu">试运行</strong>环境中测试代码后，代码被提升到稳定的<strong class="la iu">生产</strong>环境中。</p><h2 id="e068" class="mo mp it bd mq mr ms dn mt mu mv dp mw lh mx my mz ll na nb nc lp nd ne nf ng bi translated">概述</h2><p id="a842" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated"><strong class="la iu">步骤1。</strong>创建<code class="fe mk ml mm mn b">production</code> <strong class="la iu"> BigQuery项目</strong>，随便你怎么称呼，比如<code class="fe mk ml mm mn b">bq-shakhomirov</code></p><p id="19aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤二。将BigQuery项目连接到Dataform项目。</strong></p><p id="ca42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤三。</strong>建立<strong class="la iu"> staging </strong>环境，即在BigQuery <code class="fe mk ml mm mn b">bq-shakhomirov-staging</code>中创建另一个项目</p><p id="95bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">第四步。</strong>创建一个空的(完全空的)<strong class="la iu"> Github </strong>仓库，并在那里迁移<strong class="la iu">数据表单</strong>项目。</p><p id="2640" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完成后，您将能够在自己的分支中开发SQL管道，创建拉请求并合并到<code class="fe mk ml mm mn b">staging</code>分支中。该分支将用于数据表单中的<strong class="la iu">暂存</strong>环境，其中所有SQL转换都在您的<strong class="la iu">暂存BigQuery项目</strong>中运行。实时数据将保持不变。当你对你的脚本感到满意后，你可以将它合并到主分支，并在Datform的<strong class="la iu">生产</strong>环境中使用，即<code class="fe mk ml mm mn b">bq-shakhomirov </code> BigQuery项目。</p><h2 id="f3ad" class="mo mp it bd mq mr ms dn mt mu mv dp mw lh mx my mz ll na nb nc lp nd ne nf ng bi translated"><strong class="ak">第一步。</strong>为生产创建<strong class="ak"> BigQuery项目</strong></h2><p id="e4ba" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">将暂存数据和生产数据分开的一种简单明了的方法是为每个环境使用不同的数据库。我们将使用<code class="fe mk ml mm mn b">bq-shakhomirov</code>(替换为您的项目名称)进行生产，使用<code class="fe mk ml mm mn b">bq-shakhomirov-staging</code>进行测试。</p><blockquote class="md me mf"><p id="93f5" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated">1.转到<a class="ae nm" href="https://console.cloud.google.com/projectselector2/home/dashboard" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> BigQuery页面</strong> </a>并创建您的第一个项目:</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/97c053fdbb8c8e7ee54f47b6f16b96fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XSMZmsNu0CwxeT7LSlu9Og.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><blockquote class="md me mf"><p id="b08a" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated">2.<strong class="la iu">生成数据仓库凭证</strong></p></blockquote><p id="497c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了让Dataform连接到您的BigQuery仓库，您需要使用应用程序默认凭证或服务帐户和JSON密钥。</p><p id="0ce0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您需要从您的Google Cloud控制台创建一个<strong class="la iu">服务帐户</strong>，并为其分配访问BigQuery的权限。</p><p id="c889" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">转到<a class="ae nm" href="https://console.cloud.google.com/iam-admin/serviceaccounts" rel="noopener ugc nofollow" target="_blank">服务账户页面</a></p><p id="f36a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">-确保选择了您创建的新项目，然后单击“打开”。</p><p id="5524" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">-单击“创建服务帐户”并为其命名。授予新帐户<strong class="la iu"> BigQuery Admin </strong>角色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/d76b7f3e2346c49366fe63a5b8b1276d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UG58p_pNiSZGZrjmGHbmUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正在创建服务帐户。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/3297fbf5872c8db5bc3a27aa47188f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxq55uYYbBwSOMW8NBl_UA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正在授予BigQuery管理员角色。作者图片</p></figure><p id="f2f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完成后，您需要为您的新服务帐户创建一个密钥(JSON格式):</p><ul class=""><li id="7bcf" class="nq nr it la b lb lc le lf lh ns ll nt lp nu lt nv nw nx ny bi translated">在“服务帐户”页面上，找到要为其创建密钥的服务帐户行，然后单击“<strong class="la iu">操作</strong>”按钮。</li><li id="ef64" class="nq nr it la b lb nz le oa lh ob ll oc lp od lt nv nw nx ny bi translated">然后点击`<strong class="la iu">管理密钥</strong>`。</li><li id="a99c" class="nq nr it la b lb nz le oa lh ob ll oc lp od lt nv nw nx ny bi translated">点击`<strong class="la iu">创建</strong>`并选择JSON键类型。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/8824c4d6d39735831df2b54dc26441cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gObh7JchHrDiTYQA8N7Gvw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建新的JSON键。作者图片</p></figure><p id="9b67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在您已经创建了一个新的BigQuery项目并生成了您的仓库凭证，您已经准备好创建您的<strong class="la iu">数据表单</strong>项目了！</p><h2 id="2810" class="mo mp it bd mq mr ms dn mt mu mv dp mw lh mx my mz ll na nb nc lp nd ne nf ng bi translated"><strong class="ak">步骤二。将您的项目连接到数据表单</strong></h2><p id="d798" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">去<a class="ae nm" href="https://app.dataform.co/" rel="noopener ugc nofollow" target="_blank">https://app.dataform.co/</a>创建你的数据表单项目。例如，您可以选择使用您的** <strong class="la iu"> Github </strong> **帐户注册，然后创建您的第一个项目。</p><ul class=""><li id="0d2d" class="nq nr it la b lb lc le lf lh ns ll nt lp nu lt nv nw nx ny bi translated">为您的项目命名，例如“bq-shakhomirov”。</li><li id="f0b2" class="nq nr it la b lb nz le oa lh ob ll oc lp od lt nv nw nx ny bi translated">您将需要您的<strong class="la iu"> BigQuery项目ID </strong>来连接到Dataform。您可以在您的<a class="ae nm" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> BigQuery控制台</a>中找到它，只需点击您的项目。</li><li id="c69d" class="nq nr it la b lb nz le oa lh ob ll oc lp od lt nv nw nx ny bi translated">您将看到如下所示的页面。点击“浏览”并上传您的JSON密钥。然后点击“测试连接”,如果一切正常，你就可以开始了。然后点击“保存连接”。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/33d385a13d85d0b91f2bbebe28e7d076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x-xMhbRI2h9xm0PVoZsijQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">连接到数据表单。作者图片</p></figure><h2 id="c4ef" class="mo mp it bd mq mr ms dn mt mu mv dp mw lh mx my mz ll na nb nc lp nd ne nf ng bi translated"><strong class="ak">第三步。</strong>设置暂存环境</h2><p id="6849" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">对于暂存环境，我们将在<strong class="la iu"> BigQuery </strong>(数据库)中创建一个单独的项目。因此我们可以安全地删除所有暂存资源，以备不时之需。Google推荐的最佳实践是创建一个单独的项目来分离生产和暂存环境。</p><blockquote class="md me mf"><p id="1d29" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated">1.您可能想要为暂存创建一个新的<strong class="la iu"> BigQuery项目。</strong></p></blockquote><p id="f38f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只需重复从<strong class="la iu">步骤1 </strong>开始的步骤，并将“-staging”后缀添加到您的项目名称中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/5160ee1efbbeb51b7c45d0317eafe30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nD_jf2yUUL-zfHH0de7K2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建用于暂存的项目。作者图片</p></figure><blockquote class="md me mf"><p id="9489" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated">2.授予您的服务帐户对临时项目的访问权限。</p></blockquote><p id="05da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还记得我们在步骤2中创建了一个服务帐户吗？我们向dataform提供了这些凭据。现在，我们希望该服务帐户能够访问我们的临时项目。</p><p id="3ab8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">转到谷歌控制台中的<a class="ae nm" href="https://console.cloud.google.com/iam-admin/iam" rel="noopener ugc nofollow" target="_blank"> IAM </a>，添加来自<strong class="la iu">步骤1 </strong>的我们的<strong class="la iu">服务帐户电子邮件</strong>作为具有<strong class="la iu"> BigQuery Admin </strong>权限的新成员:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/67ece6b394193bcedbbb8cefc1d8d958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*io0jwxbetEOfFfYxLDUIfQ.png"/></div></div></figure><p id="6c10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在转到您的数据表单项目的环境，选择<strong class="la iu"> staging </strong>并单击<strong class="la iu"> Run schedule </strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/b26138340ba87a50ec0e44efc4ff96fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*58ecM79A9E1ci6cDpr4Mbw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试试运行计划。图片作者。</p></figure><p id="3ebe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这次运行将在您的staging <strong class="la iu"> BigQuery </strong>项目中创建新表。它可以是计划每天运行的任何SQL转换。在我的例子中，它是一个支付历史表和一个视图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/18c48889e9d8fd67a0bfb72c979f2b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vP0yeXyLzx4zKvuaengh-A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">连接到数据表单的暂存环境</p></figure><p id="e259" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，我们选择了一个名为“<strong class="la iu"> staging </strong>”的分支。如果你还没有，你可以在<strong class="la iu">数据表单</strong>控制台中创建它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/9bca94b243f34cc9e1af3d0c4d7489f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fiuImH4ha0QM4DNfkdzEWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在数据表单中创建新分支。作者图片</p></figure><h2 id="0026" class="mo mp it bd mq mr ms dn mt mu mv dp mw lh mx my mz ll na nb nc lp nd ne nf ng bi translated">4.将您的数据表单项目迁移到Github。</h2><p id="1594" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">您可能希望至少有两个分支:一个用于<code class="fe mk ml mm mn b">production</code>(主节点)，一个用于<code class="fe mk ml mm mn b">staging</code>。我称之为<strong class="la iu">分期</strong>。您的数据团队成员可以在其个人分支，即<code class="fe mk ml mm mn b"><strong class="la iu">mshakhomirov-dev</strong></code> <strong class="la iu"> </strong>中开发任何变更，然后创建拉请求以合并到<code class="fe mk ml mm mn b">staging</code>分支中，该分支将在您的<strong class="la iu"> BigQuery </strong>暂存项目中运行。</p><blockquote class="md me mf"><p id="b380" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated"><strong class="la iu"> 1。首先，您需要创建一个完全空的新Github存储库。</strong></p></blockquote><p id="7326" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该存储库可以是私有的或公共的，或者是组织的一部分。存储库必须是全新的，即没有任何提交。</p><p id="0808" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请确保您已经从git提供程序提供了有效的访问令牌。确保您提供了一个凭据，该凭据具有推送至您计划使用的存储库的必要权限。</p><blockquote class="md me mf"><p id="f2a2" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated"><strong class="la iu"> 2。然后转到Dataform并连接到GitHub </strong></p></blockquote><ul class=""><li id="dd20" class="nq nr it la b lb lc le lf lh ns ll nt lp nu lt nv nw nx ny bi translated">你可以点击<strong class="la iu">导航菜单- &gt;项目设置中的<strong class="la iu">将项目迁移到GitHub </strong>按钮。</strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/367e9f2c90538a75f43abdb0ce5eb0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bgL9jjczdN3tmLKnpr3Azg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将项目迁移到GitHub</p></figure><p id="0c57" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果需要的话，创建一个<strong class="la iu"> GitHub </strong>个人访问令牌，但总的来说这个过程相当顺利。</p><p id="e930" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里阅读更多:<a class="ae nm" href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line#creating-a-token" rel="noopener ugc nofollow" target="_blank">https://help . github . com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line # creating-a-token</a></p><ul class=""><li id="05e0" class="nq nr it la b lb lc le lf lh ns ll nt lp nu lt nv nw nx ny bi translated">输入要用来存储项目的Git存储库的全名。</li><li id="4898" class="nq nr it la b lb nz le oa lh ob ll oc lp od lt nv nw nx ny bi translated">确保它是空的并且不包含任何文件。甚至没有。gitignore和README.md</li></ul><p id="d03a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">连接后，您将看到如下屏幕:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/59c1b511994720f05bebbf9f3b2d7b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H4RVWkyz_TX2OTT3vQA_wQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">连接到github repo的数据表单</p></figure><blockquote class="md me mf"><p id="287a" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated"><strong class="la iu"> 3。然后你会想要配置你的数据表单的配置</strong></p></blockquote><p id="6cfd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">确保你的数据表单的<code class="fe mk ml mm mn b">environments.json</code>文件有<code class="fe mk ml mm mn b">gitRef</code>到你的分支。例如:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/02aea21b7c1c3f4c7e45c82a7cc0bad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z2dLDl7334fEvKUSnPmgLg.png"/></div></div></figure><p id="abf6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，无论您将什么合并到存储库中的<code class="fe mk ml mm mn b"><strong class="la iu">staging</strong></code>中，它都将使用自己的时间表在dataform的<code class="fe mk ml mm mn b"><strong class="la iu">staging</strong> environment</code>中运行。</p><blockquote class="md me mf"><p id="a8e7" class="ky kz mg la b lb lc ju ld le lf jx lg mh li lj lk mi lm ln lo mj lq lr ls lt im bi translated">默认情况下，<strong class="la iu"> Dataform </strong>从项目的主Git分支运行所有项目代码。配置环境允许您控制这种行为，使您能够运行多个不同版本的项目代码。</p></blockquote><p id="cb4c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一种清晰而简单的方法来分离暂存数据和生产数据。</p><p id="8924" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，默认情况下，我将使用我的暂存BigQuery项目:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/4d29054a1bdfd760d243770b61243ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRdqtx3ItXynHli5dFTHhQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">dataform.json .图片作者</p></figure><p id="4d83" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当来自暂存分支的拉请求被批准，我们可以将其合并到<code class="fe mk ml mm mn b">master</code>时，我希望<strong class="la iu">数据表单</strong>使用我的live <strong class="la iu"> BigQuery </strong>项目。在这种情况下，我的<code class="fe mk ml mm mn b">environments.json</code>将让<strong class="la iu">默认数据库</strong>覆盖:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/d86c06601bb3b89580b2ebe83efe0028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hr5FUMrFK7aAFCI_Rx6kvA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="17ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe mk ml mm mn b">./environments.json:</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><h2 id="91fa" class="mo mp it bd mq mr ms dn mt mu mv dp mw lh mx my mz ll na nb nc lp nd ne nf ng bi translated"><strong class="ak">结论</strong></h2><p id="d7dc" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">我<strong class="la iu">想在BigQuery中可视化我的SQL转换管道</strong>。我一直在寻找一个专门用于此的图形工具，甚至考虑为此从头开始构建一些东西，但后来我意识到Dataform已经有了。</p><blockquote class="os"><p id="6a6a" class="ot ou it bd ov ow ox oy oz pa pb lt dk translated">一个SQL转换图抵得上一千个字。</p></blockquote><p id="a350" class="pw-post-body-paragraph ky kz it la b lb pc ju ld le pd jx lg lh pe lj lk ll pf ln lo lp pg lr ls lt im bi translated">我的数据仓库也很大。我已经在使用git管理我的SQL脚本了。然而，对于一个成长中的数据团队来说，无论他们做什么样的数据转换，投资于<strong class="la iu">自动化文档</strong>可能是值得的。Dataform让我可以轻松地使用。sqlx和。js模板。本质上，它是相同的SQL，但是您将使用<strong class="la iu"> ref() </strong>函数来引用您使用的表。我使用了大量的<strong class="la iu">数据健康检查</strong>，在我的SQL脚本中明确地定义了它们。同样，dataform让我通过创建数据检查视图来做到这一点。就个人而言，我更喜欢看到SQL脚本中的数据检查SQL，而不是被迫在另一个选项卡中打开视图SQL，但这是一件小事。老实说，当数据校验存储在一个专用数据集中时，对团队的其他成员来说效果更好。更容易找到他们。</p><p id="1661" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Dataform可以很好地描述数据堆栈的数据转换层。您可以声明您的源表，并提供一个描述，说明实际上是什么在向它们提供数据，即API、DB extracts或Kinesis流。</p><h2 id="1a21" class="mo mp it bd mq mr ms dn mt mu mv dp mw lh mx my mz ll na nb nc lp nd ne nf ng bi translated">推荐阅读:</h2><p id="af9c" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">[1]<a class="ae nm" href="https://mshakhomirov.medium.com/building-a-data-warehouse-in-the-cloud-using-bigquery-part-1-155917215678" rel="noopener">https://mshakhomirov . medium . com/building-a-data-warehouse-in-the-cloud-using-big query-part-1-155917215678</a></p><p id="f94c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[2]<a class="ae nm" href="https://docs.dataform.co/dataform-web/scheduling/environments" rel="noopener ugc nofollow" target="_blank">https://help . github . com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line # creating-a-token</a></p><p id="9b3f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae nm" href="https://docs.dataform.co/getting-started-tutorial/set-up" rel="noopener ugc nofollow" target="_blank">https://docs.dataform.co/getting-started-tutorial/set-up</a></p><p id="72c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[4]<a class="ae nm" href="https://docs.dataform.co/best-practices/start-your-dataform-project" rel="noopener ugc nofollow" target="_blank">https://docs . data form . co/best-practices/start-your-data form-project</a></p></div></div>    
</body>
</html>