<html>
<head>
<title>Lesser known data science techniques you should add to your toolkit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">应该添加到您的工具包中的鲜为人知的数据科学技术</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lesser-known-data-science-techniques-you-should-add-to-your-toolkit-a96578113350?source=collection_archive---------16-----------------------#2021-04-11">https://towardsdatascience.com/lesser-known-data-science-techniques-you-should-add-to-your-toolkit-a96578113350?source=collection_archive---------16-----------------------#2021-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/96b7b7918a4c9565f6eaaa08677aa2c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NiqBqj5DpTlzODIK"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">米利安·耶西耶在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="72b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">成为一名高效的数据科学家通常意味着能够为特定问题找到正确的解决方案。在这篇文章中，我想讨论三种技术，它们使我能够在多种环境中解决棘手的问题，但并没有被广泛使用。这三种技术是<strong class="ki iu">分位数回归</strong>、<strong class="ki iu">指数衰减回归</strong>和<strong class="ki iu">树嵌入逻辑回归</strong>。对于每种技术，我将提供一个激励性的例子来说明为什么我认为值得将它添加到您的工具包中，并且还将把每种技术包装在一个定制的sklearn模型中，以便您可以轻松地将它应用到您自己的问题中。</p><p id="d1ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章的所有代码可以在这里找到<a class="ae kf" href="https://conormm.github.io/blog/2021/04/11/lesser-known-data-scienec-techniques.html" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="f02a" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">分位数回归</h2><p id="f174" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">分位数回归是经典线性回归模型的变体。关键区别在于，分位数回归模型针对特定分位数的误差进行优化，而线性回归模型针对均方误差进行优化。实际上，这意味着线性回归模型的偏差应该等于零(即残差的平均值应该为零，模型高估和低估实际值的概率相等)。但是，分位数回归误差可能有偏差(由分位数决定)。具体来说，<strong class="ki iu">分位数回归可以偏置过度预测或预测不足</strong>，这取决于对于特定问题什么是更可取的。但是，<em class="mc">为什么要这样做呢？</em></p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/43c9950b261ac285ee36e7a65a3962a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H-psrXuNaNNXOhEx"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@edge2edgemedia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Edge2Edge媒体</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="459d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可能要解决一个预测问题，低估实际的成本比高估T21的成本要大得多。例如，如果您预测在高峰时间托管一个网站所需的服务器数量，低估实际需求的成本可能会导致网站崩溃，而高估的成本则是在不必要的服务器上的多余支出。虽然这两种结果都是不可取的，但后者(网站崩溃)比前者(支出增加)是一个更大的问题。</p><p id="7745" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还可能希望显示预测的<strong class="ki iu">置信范围。我们可以通过分位数回归来实现这一点，方法是估计几个具有不同分位数的模型，例如，第5个、第50个(中间值)和第95个百分位数。相应的预测可以解释为:</strong></p><ol class=""><li id="b226" class="mi mj it ki b kj kk kn ko kr mk kv ml kz mm ld mn mo mp mq bi translated">实际值低于预测值的概率为5%，高于预测值的概率为95%</li><li id="6347" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated">实际值低于预测值的概率为50%，高于预测值的概率为50%</li><li id="4101" class="mi mj it ki b kj mr kn ms kr mt kv mu kz mv ld mn mo mp mq bi translated">实际值低于预测值的概率为95%，高于预测值的概率为5%</li></ol><p id="db7c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以提取任意分位数的这些预测。sklearn中没有实现分位数回归，但是可以很容易地将StatsModels实现包装在sklearn自定义类中，以便它可以像其他sklearn转换器和模型一样使用:</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="91c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们可以设置一些数据并拟合模型:</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="764c" class="le lf it mz b gy nd ne l nf ng"># generate data<br/>n = 100<br/>X = np.linspace(0, 30, n) <br/>y = 150 + 0.3*X + 1*X**2 + np.random.normal(loc=50, scale=100, size=n)<br/>X = X[:, np.newaxis]</span><span id="3f24" class="le lf it mz b gy nh ne l nf ng"># instantiate models <br/>qr_05 = QuantileRegression(.05)<br/>qr_50 = QuantileRegression(quantile=.5)<br/>qr_95 = QuantileRegression(quantile=.95)</span><span id="1d7d" class="le lf it mz b gy nh ne l nf ng"># structure data for model<br/>model_input = np.c_[X, X**2]</span><span id="35a7" class="le lf it mz b gy nh ne l nf ng"># fit models<br/>qr_05.fit(model_input, y)<br/>qr_50.fit(model_input, y)<br/>qr_95.fit(model_input, y)</span></pre><p id="0bb3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下图显示了我生成的数据的第5(黄线)、第50(红线)和第95(绿线)百分位预测。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/22abef86241c287f0ae6a166bbece5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fYxAuIXAl9J3mWdoH1VgPA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="4554" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">指数衰减曲线</h2><p id="5daf" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">衰变是许多过程的特征。例如，对新产品的参与通常以指数衰减为特征，开始时非常兴奋，随着兴趣的消退而迅速减弱。这也是我在Medium上发表的文章中观察到的东西——例如，以我最近发布的关于<a class="ae kf" rel="noopener" target="_blank" href="/gradient-boosting-is-one-of-the-most-effective-ml-techniques-out-there-af6bfd0df342">渐变增强</a>的这篇相对受欢迎的文章为例。这篇文章前六天的浏览次数如下图所示。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/07fd2408d0a917f8ed1e2096f5f54d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FA_OagXxtHF_F-MBLayN1Q.png"/></div></div></figure><p id="6803" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">帖子在第一天(第0天)达到顶峰，但从那以后就明显衰退了。我们在这里看到的模式是指数衰减，这是一个我们可以用指数衰减回归模型拟合的过程。下面我将指数衰减回归器包装在一个sklearn自定义类中:</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="bee8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们可以根据数据拟合模型，并预测未来几天的情况，如下所示:</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="e604" class="le lf it mz b gy nd ne l nf ng">medium_post_views = np.array([3500, 1600, 482, 245, 198, 116])<br/>days_since_launch = np.arange(medium_post_views.shape[0])<br/>xd = ExponentialDecayRegressor()<br/>xd.fit(days_since_launch, medium_post_views)</span><span id="8ed3" class="le lf it mz b gy nh ne l nf ng">days_since_launch_plus_future = np.arange(12)<br/>xd_preds = xd.predict(days_since_launch_pred)</span></pre><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/b1d6b1066315c814bd9b650130e9d5c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpbaX_gZwUU7mkksbnQ80Q.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="5e76" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以看到指数衰减模型与博客帖子浏览量的实际衰减非常吻合，并且浏览量预计会非常平稳。指数衰减曲线对预测非常有用，而且拟合起来非常简单快速。一旦你有了特定产品/服务/内容类别(等等)的训练衰减曲线。)一旦你知道(或者可以可靠地预测)它的起始值，你就可以预测它将如何在其生命周期中发展。</p><p id="c5c1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通常情况下，您将归一化<em class="mc"> y </em>值，以便衰减从1开始并按比例衰减(见下图)。这使得衰减回归比例不变——例如，我可以将我上一篇帖子的指数衰减曲线应用到这篇帖子的第一天参与度，以便预测总的终身参与度！</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/aa25778375aacc4e403eb435546982f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wS1dn7VmcZWHTcowpmnMPw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="c75b" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">嵌入树的逻辑回归</h2><p id="270a" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">嵌入树的逻辑回归是我第一次在脸书的论文<a class="ae kf" href="https://research.fb.com/wp-content/uploads/2016/11/practical-lessons-from-predicting-clicks-on-ads-at-facebook.pdf" rel="noopener ugc nofollow" target="_blank">中了解到的，但是从那以后在实践中使用了很多次。这个想法是建立一个两阶段模型。在第一阶段，对数据拟合基于树的集合模型，在第二阶段，对基于拟合的树的集合结构的输入特征的变换应用线性模型。</a></p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/b717617fb6edc42ac4f70edb74c0ae16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T1rUnGi0weNQ9OEk"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@phoebezzf?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/>周在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="d16b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">树嵌入通过将每一行编码为向量来变换原始特征空间，其中每一列代表一棵树，并且每一列中的值代表样本被分割成的树的叶节点。例如，如果有500个样本，使用100棵树，那么树嵌入的形状将是500 x 100。这种嵌入然后被进一步转换成二进制向量(这可以产生相当稀疏的矩阵)。<em class="mc">你为什么想这么做？</em></p><p id="7143" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，树嵌入将原始特征空间投影到非线性特征空间，这<strong class="ki iu">将使得线性模型能够处理X和y之间的非线性关系</strong>。第二，除了仅使用基于树的模型之外，使用这种方法，您经常(尽管不总是)可以看到不错的性能增益。最后。可以说，其中一个关键的好处是，i <strong class="ki iu"> t校准预测概率的方式将更好地反映目标发生的概率</strong>。例如，当预测概率等于0.9时，希望对应于样本为真阳性的概率为90%。换句话说，对于所有有90%概率为阳性的样本，10个样本中有9个应该是真阳性。但是，基于树的模型通常不能以这种方式很好地校准。这是一个重要的话题，我很快会写一篇关于它的文章，但是在构建和部署基于树的模型时，你应该意识到这一点。也就是说，逻辑回归模型得到了很好的校准。因此，通过使用树模型来创建非线性特征空间，并使用线性模型来校准概率，您可以获得两个世界的最佳结果。</p><p id="1d88" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是使用sklearn自定义类的两阶段模型的简单实现:</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h2 id="b501" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">摘要</h2><p id="952a" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">我在这篇文章中讨论的三种技术是我经常使用的，它们帮助我解决了许多跨多种环境的应用数据科学问题。希望你能在自己的工作中看到使用这些方法的机会。如果您有任何意见、问题或其他有趣的事情想让我写下来，请联系下面。</p><p id="ea53" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一如既往，感谢您抽出时间阅读！</p></div></div>    
</body>
</html>