<html>
<head>
<title>How to Prepare your Development Environment to Rank on Kaggle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何准备您的开发环境以便在Kaggle上排名</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-prepare-your-development-environment-to-rank-on-kaggle-1a0fa1032b84?source=collection_archive---------16-----------------------#2021-08-25">https://towardsdatascience.com/how-to-prepare-your-development-environment-to-rank-on-kaggle-1a0fa1032b84?source=collection_archive---------16-----------------------#2021-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/af90e053d7bb7c4dcc1c52ded83a210b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCV3BwpClt4l8ZbkNtggWg.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">插图照片由<a class="ae jd" href="https://www.pexels.com/photo/silver-laptop-450035/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae jd" href="https://www.pexels.com/@mateusz-dach-99805?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Mateusz Dach </a>拍摄。</p></figure><div class=""/><div class=""><h2 id="9226" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">这篇文章介绍了为Kaggle影像分类挑战配置定制开发环境的最佳实践。</h2></div><p id="911a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个故事中，我将介绍如何为参加Kaggle挑战赛设置开发环境:<br/> 1)选择一个最近有趣的比赛，<br/> 2)在云中启动一个JupyterLab环境，<br/> 3)下载完整的数据集，<br/> 4)执行初始图像预处理。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="e23c" class="ly lz jg bd ma mb mc md me mf mg mh mi km mj kn mk kp ml kq mm ks mn kt mo mp bi translated">初步选择:竞赛、深度学习框架、云平台</h1><figure class="mr ms mt mu gt is gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/089f9dcb78dc46e54b5169f27e9c889d.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*QWG-PkPdLs-uFLkvBY_qrg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">显示每个串联类别组合的样本图像和计数。</p></figure><p id="003e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将使用最近的Kaggle <a class="ae jd" href="https://www.kaggle.com/c/plant-pathology-2021-fgvc8" rel="noopener ugc nofollow" target="_blank">植物病理学2021 — FGVC8 </a>来展示完整的数据科学周期。这场比赛的一个好的方面是，它非常简单，代表了CIFAR和MNIST以外的真实世界图像分类任务所面临的挑战。</p><p id="a9f8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我为这些比赛选择的框架是<a class="ae jd" href="https://github.com/PyTorchLightning/pytorch-lightning" rel="noopener ugc nofollow" target="_blank"> PyTorch Lightning </a>，它允许我专注于迭代我的数据处理和模型架构，而不用担心训练循环和设备管理的繁重工程。关于为什么你应该查看下面的<a class="ae jd" href="https://devblog.pytorchlightning.ai/why-should-i-use-pytorch-lightning-488760847b8b" rel="noopener ugc nofollow" target="_blank"> PyTorch闪电贴</a>的更多信息。</p><div class="ip iq gp gr ir mv"><a href="https://devblog.pytorchlightning.ai/why-should-i-use-pytorch-lightning-488760847b8b" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jh gy z fp na fr fs nb fu fw jf bi translated">我为什么要用PyTorch Lightning？</h2><div class="nc l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">devblog.pytorchlightning.ai</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni ix mv"/></div></div></a></div><p id="48a0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为一个计算平台，我选择了<a class="ae jd" href="https://docs.grid.ai" rel="noopener ugc nofollow" target="_blank"> Grid.ai </a>，它可以让我精确地指定我想要使用的机器，里面预装了JupiterLab。作为奖励，Grid使我能够用Github同步我所有的Kaggle代码。稍后，我将使用它来运行超参数搜索，为我的模型找到最佳配置。</p><blockquote class="nj nk nl"><p id="931f" class="kv kw nm kx b ky kz kh la lb lc kk ld nn lf lg lh no lj lk ll np ln lo lp lq ij bi translated">完全公开——我目前在<a class="ae jd" href="https://www.grid.ai/" rel="noopener ugc nofollow" target="_blank"> Grid.ai </a> <br/>担任高级研究工程师。注意，还有其他替代方案可以用来利用这些最佳实践，例如Kaggle内核或Colab，但Grid是我的首选平台，因为它使我能够使用云轻松地扩展训练我的模型。</p></blockquote><div class="ip iq gp gr ir mv"><a rel="noopener follow" target="_blank" href="/trivially-scale-pytorch-on-aws-4cfde16e6d37"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jh gy z fp na fr fs nb fu fw jf bi translated">AWS上的普通比例PyTorch</h2><div class="nq l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">在AWS上运行PyTorch工作负载，无需更改代码</h3></div><div class="nc l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="nd l"><div class="nr l nf ng nh nd ni ix mv"/></div></div></a></div><p id="076e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本教程中包含的所有代码和可视化都可以在<a class="ae jd" href="https://github.com/Borda/kaggle_plant-pathology" rel="noopener ugc nofollow" target="_blank">本报告</a>中获得，您可以免费使用和贡献。</p><h1 id="693f" class="ly lz jg bd ma mb ns md me mf nt mh mi km nu kn mk kp nv kq mm ks nw kt mo mp bi translated">准备Kaggle开发环境</h1><p id="b334" class="pw-post-body-paragraph kv kw jg kx b ky nx kh la lb ny kk ld le nz lg lh li oa lk ll lm ob lo lp lq ij bi translated">我选择Grid.ai作为我的开发环境，因为它提供了三个主要的构建模块:</p><ol class=""><li id="1ac5" class="oc od jg kx b ky kz lb lc le oe li of lm og lq oh oi oj ok bi translated"><a class="ae jd" href="https://docs.grid.ai/products/add-data-to-grid-datastores" rel="noopener ugc nofollow" target="_blank">数据存储</a>(使我能够一次上传数据，并在任何地方使用；他们确保我们所有的原型和实验使用相同的数据，并且是可重复的)</li><li id="b58b" class="oc od jg kx b ky ol lb om le on li oo lm op lq oh oi oj ok bi translated"><a class="ae jd" href="https://docs.grid.ai/products/sessions" rel="noopener ugc nofollow" target="_blank">会话</a>(这使我能够专注于机器学习本身。我发现网格实例的CPU/GPU/RAM性能优于Kaggle和Colab内核)</li><li id="f387" class="oc od jg kx b ky ol lb om le on li oo lm op lq oh oi oj ok bi translated"><a class="ae jd" href="https://docs.grid.ai/products/run-run-and-sweep-github-files" rel="noopener ugc nofollow" target="_blank">运行</a>(这使我能够扩大实验规模；我可以实时密切监控多个实验，及早停止次优配置，比较结果，并在一个地方为Kaggle导出最佳模型。</li></ol><h2 id="daa9" class="oq lz jg bd ma or os dn me ot ou dp mi le ov ow mk li ox oy mm lm oz pa mo pb bi translated">启动网格会话</h2><figure class="mr ms mt mu gt is gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/d076fd5dcfb278deed60f0cd87e49a07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*cFl0-auweNZHpjoxoreqTg.gif"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">在网格会话中启动Jupyter实验室。</p></figure><p id="281d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先用GitHub或者Google账号登录<a class="ae jd" href="https://platform.grid.ai/" rel="noopener ugc nofollow" target="_blank"> Grid.ai </a>。然后您可以创建一个会话——配置您的实例类型并设置所需的存储大小(当您想要处理大型数据集时会很方便)。新的交互式会话实例带有一个内置的JupyterLab。</p><figure class="mr ms mt mu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pd"><img src="../Images/649e6aed19b904a40081aa7bddaea129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T2NSG3i2ICxB0blW"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">为完整旅程创建网格会话的步骤<a class="ae jd" href="https://platform.grid.ai/#/dashboard?product_tour_id=221973" rel="noopener ugc nofollow" target="_blank">点击此处</a></p></figure><p id="4e89" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我可以轻松地启动JupyterLab，并使用cli工具<a class="ae jd" href="https://glances.readthedocs.io/en/latest/quickstart.html" rel="noopener ugc nofollow" target="_blank">glasses</a>来监控实时资源使用情况，这让我知道是否存在任何资源瓶颈，如预处理期间的CPU利用率或训练期间的GPU利用率，从而导致训练批量增加。</p><div class="ip iq gp gr ir mv"><a href="https://docs.grid.ai/products/sessions" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jh gy z fp na fr fs nb fu fw jf bi translated">⚡Sessions</h2><div class="nq l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">会话是为开发而优化的交互式机器(带有多个GPU)。</h3></div><div class="nc l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">doc . grid . ai</p></div></div><div class="nd l"><div class="pe l nf ng nh nd ni ix mv"/></div></div></a></div><h2 id="ecd1" class="oq lz jg bd ma or os dn me ot ou dp mi le ov ow mk li ox oy mm lm oz pa mo pb bi translated">设置Kaggle CLI并下载数据集</h2><p id="f39a" class="pw-post-body-paragraph kv kw jg kx b ky nx kh la lb ny kk ld le nz lg lh li oa lk ll lm ob lo lp lq ij bi translated">为了在我们的会话中获得<a class="ae jd" href="https://www.kaggle.com/c/plant-pathology-2021-fgvc8" rel="noopener ugc nofollow" target="_blank">植物病理学2021 — FGVC8 </a>数据集，我们使用由Kaggle直接提供的Kaggle CLI，并在<a class="ae jd" href="https://pypi.org/project/kaggle/" rel="noopener ugc nofollow" target="_blank"> PyPI </a>上进行索引。</p><pre class="mr ms mt mu gt pf pg ph pi aw pj bi"><span id="8f77" class="oq lz jg pg b gy pk pl l pm pn">pip install kaggle</span></pre><p id="9d4b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于任何使用Kaggle CLI的用户，您需要设置<a class="ae jd" href="https://medium.com/@ankushchoubey/how-to-download-dataset-from-kaggle-7f700d7f9198" rel="noopener">您的凭证</a>——登录Kaggle web并创建您的个人密钥，该密钥将作为<code class="fe po pp pq pg b">kaggle.json</code>自动下载。</p><figure class="mr ms mt mu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pr"><img src="../Images/5da310da721599e852b03a1e306c3792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*habmD2_NBED2vqwrDW7nVQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">从个人Kaggle帐户下载凭证文件的步骤如下:(1)选择帐户，(2)向下滚动并“创建新的API令牌”。</p></figure><p id="a1d8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们有了<code class="fe po pp pq pg b">kaggle.json</code>密钥后，我们可以使用JupyterLab将其上传到我们的会话(简单的拖放)并将其移动到Kaggle CLI的正确目的地，如下所示:</p><figure class="mr ms mt mu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ps"><img src="../Images/0165f0f85a622e411ae5772a89b6d89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tL-wazTvMcCtAhzMLYKV4g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">逐步如何设置Kaggle CLI: (1)安装<code class="fe po pp pq pg b">kaggle</code>包，(2)拖放带有凭证的文件，(3)将其移动到预期的系统文件夹。</p></figure><pre class="mr ms mt mu gt pf pg ph pi aw pj bi"><span id="a2de" class="oq lz jg pg b gy pk pl l pm pn">mv kaggle.json /home/jovyan/.kaggle/kaggle.json</span></pre><p id="e603" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我们将数据集下载到我们的会话中。要下载的特定竞赛名称与URL名称相同。此外，每场比赛的数据部分都提供了确切的下载命令。大多数数据集以压缩的形式分发，我们需要将它解压缩到一个目的地文件夹(我通常将该文件夹命名为与竞争对手相同的文件夹)。因此，在我们的竞争中，我们调用以下命令:</p><pre class="mr ms mt mu gt pf pg ph pi aw pj bi"><span id="3d12" class="oq lz jg pg b gy pk pl l pm pn"># doanload dataset via Kaggle CLI<br/>kaggle competitions download plant-pathology-2021-fgvc8<br/># unzip the dataset to a folder<br/>unzip plant-pathology-2021-fgvc8.zip -d plant-pathology</span></pre><h2 id="4c60" class="oq lz jg bd ma or os dn me ot ou dp mi le ov ow mk li ox oy mm lm oz pa mo pb bi translated">数据集预处理</h2><p id="71ce" class="pw-post-body-paragraph kv kw jg kx b ky nx kh la lb ny kk ld le nz lg lh li oa lk ll lm ob lo lp lq ij bi translated">提取之后，我们可以对数据集进行预处理。原始数据集以4K分辨率分布，这对于大多数应用程序来说太大了，所以我们将图像缩小到大约640px。在<a class="ae jd" href="https://devblog.pytorchlightning.ai/how-to-boost-your-image-classification-with-pytorch-lightning-242e2e533429" rel="noopener ugc nofollow" target="_blank">如何在排行榜上排名</a>中描述了这种观察和推理。我们使用一个简单的CLI工具<a class="ae jd" href="https://imagemagick.org/" rel="noopener ugc nofollow" target="_blank"> ImageMagick </a>。</p><pre class="mr ms mt mu gt pf pg ph pi aw pj bi"><span id="1b32" class="oq lz jg pg b gy pk pl l pm pn">apt install imagemagick<br/># apply to all JPEG images in given folder<br/>mogrify -resize 640 plant-pathology/train_images/*.jpg</span></pre><p id="5f47" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最终，您可以编写自己的小脚本来探索python多处理并加速这种转换…</p><figure class="mr ms mt mu gt is"><div class="bz fp l di"><div class="pt pu l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">用于多处理图像缩放的简单<a class="ae jd" href="https://gist.github.com/Borda/17a6ace0f7568b4d460bc0c1ce44a852" rel="noopener ugc nofollow" target="_blank">脚本</a>。</p></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="9958" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是你需要知道的准备Kaggle开发环境和Grid.ai的一切。概括地说，我们选择了一个有趣的<em class="nm"> Kaggle </em>竞赛，展示了如何开始交互式会话，以及如何为任何(本地或云)环境配置Kaggle凭证。</p><p id="01dc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我将在未来的博客文章中继续探索这个下载的数据集，并准备一个基线计算机视觉模型来解决这个任务。我还将回顾一些帮助我在排行榜上排名的技巧，敬请关注。稍后，我们还将分享如何轻松地从离线内核提交内容。</p><div class="ip iq gp gr ir mv"><a rel="noopener follow" target="_blank" href="/intuitive-kaggle-task-exploration-and-model-baselining-e5f641943d08"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jh gy z fp na fr fs nb fu fw jf bi translated">直观的Kaggle任务探索和模型基线</h2><div class="nq l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">用PyTorch闪电和网格点实例在Kaggle上排名的最佳实践(第2/5部分)</h3></div><div class="nc l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="nd l"><div class="pv l nf ng nh nd ni ix mv"/></div></div></a></div><p id="7da5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">敬请关注，并跟随我了解更多！</strong></p><div class="ip iq gp gr ir mv"><a href="https://devblog.pytorchlightning.ai/best-practices-to-rank-on-kaggle-competition-with-pytorch-lightning-and-grid-ai-spot-instances-54aa5248aa8e" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jh gy z fp na fr fs nb fu fw jf bi translated">使用PyTorch Lightning和Grid.ai Spot实例对Kaggle竞争进行排名的最佳实践</h2><div class="nq l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">通过交互式会话、超参数解决图像分类挑战的完整数据科学周期…</h3></div><div class="nc l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">devblog.pytorchlightning.ai</p></div></div><div class="nd l"><div class="pw l nf ng nh nd ni ix mv"/></div></div></a></div><h1 id="272e" class="ly lz jg bd ma mb ns md me mf nt mh mi km nu kn mk kp nv kq mm ks nw kt mo mp bi translated">关于作者</h1><p id="48e4" class="pw-post-body-paragraph kv kw jg kx b ky nx kh la lb ny kk ld le nz lg lh li oa lk ll lm ob lo lp lq ij bi translated"><a class="ae jd" href="https://medium.com/@jborovec" rel="noopener"><strong class="kx jh">Jirka boro vec</strong></a><strong class="kx jh"/>已经在几家不同的IT公司从事机器学习和数据科学工作好几年了。特别是，他喜欢探索有趣的世界问题，并用最先进的技术解决它们。此外，他开发了几个开源python包，并积极参与其他知名项目。在<a class="ae jd" href="https://www.grid.ai/" rel="noopener ugc nofollow" target="_blank"> <em class="nm"> Grid.ai </em> </a>工作，担任研究工程师，是<a class="ae jd" href="https://pytorchlightning.ai/" rel="noopener ugc nofollow" target="_blank"><em class="nm">pytorchlightning . ai</em></a>的主要撰稿人。</p></div></div>    
</body>
</html>