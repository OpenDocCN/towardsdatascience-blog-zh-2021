<html>
<head>
<title>Filter a Pandas DataFrame by a Partial String or Pattern in 8 Ways</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以 8 种方式通过部分字符串或模式过滤熊猫数据帧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/8-ways-to-filter-a-pandas-dataframe-by-a-partial-string-or-pattern-49f43279c50f?source=collection_archive---------1-----------------------#2021-10-31">https://towardsdatascience.com/8-ways-to-filter-a-pandas-dataframe-by-a-partial-string-or-pattern-49f43279c50f?source=collection_archive---------1-----------------------#2021-10-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a8b3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何检查数据帧并只返回所需的行</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cecbcd50a89e878a09de07011a4b28ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8eAjfgyudCxyJ3z8yD622A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@maumascaro?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kz">毛里西奥·马斯卡罗</strong> </a>拍摄自<a class="ae ky" href="https://www.pexels.com/photo/person-holding-magnifying-glass-712786/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kz"> Pexels </strong> </a></p></figure><p id="49a0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">过滤数据帧是指检查其内容并只返回符合特定标准的内容。这是被称为<a class="ae ky" href="https://en.wikipedia.org/wiki/Data_wrangling" rel="noopener ugc nofollow" target="_blank">数据争论</a>的数据分析任务的一部分，使用 Python 的<a class="ae ky" href="https://pandas.pydata.org/docs/" rel="noopener ugc nofollow" target="_blank">熊猫</a>库可以有效地完成。</p><p id="9ce9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这个想法是，一旦你过滤了这些数据，你就可以单独地分析它们，获得对这个组来说可能是独特的见解，并告知项目向前发展的预测建模步骤。</p><p id="4ae6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在本文中，我们将使用<code class="fe lw lx ly lz b">Series.<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isin.html" rel="noopener ugc nofollow" target="_blank">isin()</a></code>和<code class="fe lw lx ly lz b">Series.str.<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.contains.html" rel="noopener ugc nofollow" target="_blank">contains()</a></code>等函数来过滤数据。我尽量少用<code class="fe lw lx ly lz b">apply()</code>和<code class="fe lw lx ly lz b">Lambda</code>函数，它们使用了更多的代码，让包括我在内的许多人感到困惑。但是，我将解释代码并包含相关文章的链接。</p><p id="99ed" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们将使用来自 Kaggle 的<a class="ae ky" href="https://www.kaggle.com/shivamb/netflix-shows" rel="noopener ugc nofollow" target="_blank">网飞数据集</a>，其中包含电视节目和电影的详细信息，包括<code class="fe lw lx ly lz b">title</code>、<code class="fe lw lx ly lz b">director</code>、<code class="fe lw lx ly lz b">cast</code>、上映日期<code class="fe lw lx ly lz b">rating</code>、<code class="fe lw lx ly lz b">year </code>和<code class="fe lw lx ly lz b">duration</code>。现在让我们导入所需的库并将数据集加载到 Jupyter 笔记本中。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="c35b" class="me mf it lz b gy mg mh l mi mj">import pandas as pd</span><span id="3d12" class="me mf it lz b gy mk mh l mi mj">data = pd.read_csv('netflix_titles_nov_2019.csv')</span><span id="3402" class="me mf it lz b gy mk mh l mi mj">data.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/a87739c880d8a51c4c02d1b871613ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Z_PG-SbEchpawIBh-IG0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的网飞数据框架</p></figure><h2 id="e9df" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">1.筛选与列中给定字符串匹配的行</h2><p id="4bc7" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">这里，我们希望根据特定列的内容进行过滤。我们将使用 Pandas 的<code class="fe lw lx ly lz b">Series.isin([list_of_values] )</code>函数，它为列中<em class="ni">与</em>完全匹配的每个元素返回一个<code class="fe lw lx ly lz b">True </code>的“掩码”,如果它与<code class="fe lw lx ly lz b">isin()</code>函数中的任何列表值都不匹配，则返回<code class="fe lw lx ly lz b">False</code>。请注意，即使只有一个值，也必须始终将这些值放在方括号中。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="a326" class="me mf it lz b gy mg mh l mi mj">mask = data['type'].isin(['TV Show'])</span><span id="e75c" class="me mf it lz b gy mk mh l mi mj">#display the mask<br/>mask.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/5ffb7e2bfbbe5229674555629d4cbafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*OaONm42ZgxBV2rUEpa5XVg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="90c5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">然后我们将这个掩码应用于整个数据帧，返回条件为<code class="fe lw lx ly lz b">True</code>的行。请注意，上面掩码为<code class="fe lw lx ly lz b">True</code>的索引位置是下面过滤后的数据帧中唯一返回的行。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="9993" class="me mf it lz b gy mg mh l mi mj">#Display first 5 rows <br/>#of the filtered data</span><span id="66d0" class="me mf it lz b gy mk mh l mi mj">data[mask].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/41be68fcb3282b152d90a2af47008e86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U5Ky7fREPJ6htpYAO_F5pw.png"/></div></div></figure><p id="6bd6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">注:</strong> <code class="fe lw lx ly lz b">df.loc[mask]</code>生成的结果与<code class="fe lw lx ly lz b">df[mask]</code>相同。当您想要选择几列来显示时，这尤其有用。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="495d" class="me mf it lz b gy mg mh l mi mj">data.loc[mask, ['title','country','duration']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/8d53e0bcd55f96ccd9e17297dd2d7717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*Zf6dU3C9Xn7xMbRx7uKLSw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8f2c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">生成上述遮罩的其他方式；</p><ul class=""><li id="6378" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">如果您不想在<code class="fe lw lx ly lz b">isin()</code>函数中处理大写字母和小写字母的混合，首先将该列的所有元素转换成小写字母。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="fafe" class="me mf it lz b gy mg mh l mi mj">mask = data['type'].str.lower().isin(['tv show'])</span></pre><ul class=""><li id="5bdb" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">我们还可以使用==相等运算符来比较两个对象是否相同。这将比较列中的每个元素是否等于所提供的字符串。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="5a88" class="me mf it lz b gy mg mh l mi mj">mask = (data['type'] == 'TV Show')</span></pre><ul class=""><li id="232f" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">我们可以提供一个类似于<code class="fe lw lx ly lz b">isin([‘str1’,’str2'])</code>的字符串列表，并检查一个列的元素是否匹配其中的任何一个。下面的两个掩码返回相同的结果。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="8433" class="me mf it lz b gy mg mh l mi mj">mask = data[’type’].isin([’Movie’,’TV Show’])</span><span id="524d" class="me mf it lz b gy mk mh l mi mj">#or</span><span id="4006" class="me mf it lz b gy mk mh l mi mj">mask = (data[’type’] == 'Movie’) | (data[’type’] == 'TV Show’)</span></pre><p id="0fbc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">返回的掩码将全部为 Trues，因为“类型”列只包含“电影”和“电视节目”类别。</p><h2 id="96e7" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">2.筛选存在部分字符串的行</h2><p id="3963" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">这里，我们想检查一个列中是否存在子字符串。</p><p id="a76d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">例如，<code class="fe lw lx ly lz b">‘listed-in’</code>列包含每部电影或节目所属的流派，用逗号分隔。我想过滤并只返回那些有“恐怖”元素的，因为现在万圣节就要到了。</p><p id="8f95" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们将使用字符串方法<code class="fe lw lx ly lz b">Series.str.contains(‘pattern’, case=False, na=False)</code>，其中<code class="fe lw lx ly lz b">‘pattern’</code>是要搜索的子字符串，而<code class="fe lw lx ly lz b">case=False</code>表示不区分大小写。<code class="fe lw lx ly lz b">na=False</code>表示列中的任何<code class="fe lw lx ly lz b">NaN</code>值都将返回 False(表示没有模式),而不是从掩码中删除布尔身份的<code class="fe lw lx ly lz b">NaN</code>。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="4ae2" class="me mf it lz b gy mg mh l mi mj">mask = data['listed_in'].str.contains('horror', case=False, na=False)</span></pre><p id="ba1b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">然后，我们将对数据应用掩码，并显示过滤后的数据帧的三个样本行。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="373b" class="me mf it lz b gy mg mh l mi mj">data[mask].sample(3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/2dc857d42053a824034fd873ff9b51f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_b9By7hPuCGD2RhiUQnb4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5a0e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">其他示例:</p><ul class=""><li id="3a78" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">我们还可以检查列中是否存在符号。例如，<code class="fe lw lx ly lz b">‘cast’</code>列包含由逗号分隔的参与者，我们可以检查只有一个参与者的行。这是通过用逗号(，)检查行，然后使用波浪号(~)对数据应用过滤掩码来否定语句。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="e9c6" class="me mf it lz b gy mg mh l mi mj">mask = data['cast'].str.contains(',', na=False)</span><span id="00af" class="me mf it lz b gy mk mh l mi mj">data[~mask].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/cbabe61c591fbf133bc4d26abf9481ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jjmUITkPng-OaOASOE9Sjg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f203" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">但是现在这些结果有了<code class="fe lw lx ly lz b">NaNs</code>,因为我们使用了<code class="fe lw lx ly lz b">na=False</code>,波浪号返回掩码为假的所有行。我们将使用<code class="fe lw lx ly lz b"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dropna.html" rel="noopener ugc nofollow" target="_blank">df.dropna</a>(axis=0, subset=’cast)</code>对数据进行过滤。我们使用<code class="fe lw lx ly lz b">axis=0</code>来表示行方式，因为我们希望删除行而不是列。<code class="fe lw lx ly lz b">subset=[‘cast’]</code>仅检查该列的<code class="fe lw lx ly lz b">NaNs</code>。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="52fb" class="me mf it lz b gy mg mh l mi mj">data[~mask].dropna(axis=0, subset=['cast'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/e67b2319c90957e98c1ea0c8047561fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2iD1YRt9xwDsThur8ShTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bf35" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">注意:</strong>要检查特殊字符，如<code class="fe lw lx ly lz b">+</code>或<code class="fe lw lx ly lz b">^</code>，使用<code class="fe lw lx ly lz b">regex=False</code>(默认为<code class="fe lw lx ly lz b">True</code>)，这样所有字符都被解释为普通字符串，而不是正则表达式模式。您也可以使用反斜杠转义字符。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="04a7" class="me mf it lz b gy mg mh l mi mj">df['a'].str.contains('^', regex=False)</span><span id="a358" class="me mf it lz b gy mk mh l mi mj">#or</span><span id="49ec" class="me mf it lz b gy mk mh l mi mj">df['a'].str.contains('\^')</span></pre><h2 id="8465" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">3.使用两个部分字符串中的任意一个(OR)筛选行</h2><p id="3ebd" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">您可以检查是否存在任何两个<em class="ni">或</em>以上的字符串，如果存在任何字符串，则返回<code class="fe lw lx ly lz b">True</code>。</p><p id="8d53" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们看看“恐怖片”或“单口喜剧”来补充每次观看后的情绪状态。</p><p id="334b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们使用<code class="fe lw lx ly lz b">str.contains()</code>并传递由竖线(|)分隔的两个字符串，竖线表示“或”。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="ff13" class="me mf it lz b gy mg mh l mi mj">pattern = 'horror|stand-up'</span><span id="b825" class="me mf it lz b gy mk mh l mi mj">mask = data[’listed_in’].str.contains(pattern, case=False, na=False)</span><span id="db16" class="me mf it lz b gy mk mh l mi mj">data[mask].sample(3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/542435553a4df30f2be022effa9a6fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fjaoa1bCy4FKahe3Degzyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="e539" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">我们也可以使用长格式，创建两个掩码，并使用<code class="fe lw lx ly lz b">|</code>将它们传递到我们的数据中。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/cd5fe9fc937d26a91c9a939bb63661c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*B8rFhcQDZVPDz1MXIW7aCw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="ed1e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">注意:</strong>您可以创建许多掩码，并使用符号<code class="fe lw lx ly lz b">|</code>或<code class="fe lw lx ly lz b">&amp;</code>将它们传递到数据中。<code class="fe lw lx ly lz b">&amp;</code>表示当<em class="ni">两个</em>掩码都为真时组合掩码并返回<code class="fe lw lx ly lz b">True</code>，而<code class="fe lw lx ly lz b">|</code>表示当<em class="ni">任意一个</em>掩码为<code class="fe lw lx ly lz b">True</code>时返回真。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="aeaa" class="me mf it lz b gy mg mh l mi mj">mask1 = (data['listed_in'].str.contains('horror', case=False, na=False))</span><span id="20cd" class="me mf it lz b gy mk mh l mi mj">mask2 = (data['type'].isin(['TV Show']))</span><span id="6110" class="me mf it lz b gy mk mh l mi mj">data[mask1 &amp; mask2].head(3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/16a739d41f5b245ee24c2279b3d7c5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XuQ9sZXlU3PynfxMKv7X0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按作者筛选的数据框架</p></figure><h2 id="d83c" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">4.过滤两个字符串都存在的行(AND)</h2><p id="9220" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">有时，我们希望检查一列的元素中是否出现了多个子字符串。</p><p id="32ac" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在这个例子中，我们将搜索在美国和墨西哥拍摄的电影。</p><ul class=""><li id="3e01" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">代码<code class="fe lw lx ly lz b">str.contains('str1.*str2')</code>使用符号<code class="fe lw lx ly lz b">.*</code>来搜索两个字符串是否严格按照顺序出现<em class="ni">，其中<code class="fe lw lx ly lz b">str1</code>必须首先出现以返回 True。</em></li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="5761" class="me mf it lz b gy mg mh l mi mj">pattern = 'states.*mexico'</span><span id="c33f" class="me mf it lz b gy mk mh l mi mj">mask = data['country'].str.contains(pattern, case=False, na=False)</span><span id="9e60" class="me mf it lz b gy mk mh l mi mj">data[mask].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/6b6551a1a4702c9a53bc57f7ad39cc37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qx6evFj4_phELxaQU4O4Ww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="04df" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">请注意,“美国”总是首先出现在筛选的行中。</p><ul class=""><li id="a7ac" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">在顺序不重要的情况下(墨西哥可以出现在一行中的第一个)，使用<code class="fe lw lx ly lz b">str.contains('str1.*str2|str2.*str1').</code>。<code class="fe lw lx ly lz b">|</code>表示“返回<code class="fe lw lx ly lz b">str1</code>最先出现的行，或者<code class="fe lw lx ly lz b">str2</code>最先出现的行”。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="0ba3" class="me mf it lz b gy mg mh l mi mj">pattern = 'states.*mexico|mexico.*states'</span><span id="14bc" class="me mf it lz b gy mk mh l mi mj">mask = data['country'].str.contains(pattern, case=False, na=False)</span><span id="8e0f" class="me mf it lz b gy mk mh l mi mj">data[mask].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/999f1347b276e3885a1e067ee5070461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSLKJJ_1Mr7Kh2qGcLM_eQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3eba" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">请看“墨西哥”如何出现在第四行的第一个位置。</p><ul class=""><li id="4002" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">您还可以为每个国家创建一个掩码，然后使用<code class="fe lw lx ly lz b">&amp;</code>符号将掩码传递到数据中。下面的代码显示了与上面相同的数据帧。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="5ba4" class="me mf it lz b gy mg mh l mi mj">mask1 = (data['country'].str.contains('states', case=False, na=False)) </span><span id="b11c" class="me mf it lz b gy mk mh l mi mj"><br/>mask2 = (data['country'].str.contains('mexico', case=False, na=False))</span><span id="b426" class="me mf it lz b gy mk mh l mi mj">data[mask1 &amp; mask2].head()</span></pre><h2 id="38d7" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">5.筛选特定列中带有数字的行</h2><p id="530c" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">我们可能还想使用 regex 模式<code class="fe lw lx ly lz b">‘[0–9]’</code>检查列中的数字。代码看起来像<code class="fe lw lx ly lz b">str.contains(‘[0–9]’)</code>。</p><p id="4ca7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在下一个示例中，我们希望检查年龄等级，并返回破折号后的特定年龄，如<code class="fe lw lx ly lz b">TV-14, PG-13, NC-17</code>，而忽略<code class="fe lw lx ly lz b">TV-Y7</code>和<code class="fe lw lx ly lz b">TV-Y7-FV</code>。因此，我们在数字模式前添加一个破折号(-)。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="076f" class="me mf it lz b gy mg mh l mi mj">pattern = '-[0-9]'</span><span id="40f1" class="me mf it lz b gy mk mh l mi mj">mask = data['rating'].str.contains(pattern, na=False)<br/><br/>data[mask].sample(3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/f0430b2a8591d3010abb6c74bd08a6bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Keba41DOfsu-8jF7jfU0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="6b43" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">6.筛选部分字符串出现在多列中的行</h2><p id="1ce9" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">我们可以检查子字符串出现在两个或更多给定列中的行。</p><ul class=""><li id="520e" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">例如，让我们检查“tv”在三列(<code class="fe lw lx ly lz b">‘rating’,’listed_in’</code>和<code class="fe lw lx ly lz b">’type’</code>)中的存在，并返回它在所有中存在的行。最简单的方法是为特定的列创建三个掩码，并使用表示“and”的符号<code class="fe lw lx ly lz b">&amp;</code>过滤数据(如果至少在一列中，使用| symbol 返回 True)。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="254d" class="me mf it lz b gy mg mh l mi mj">mask1 = data['rating'].str.contains('tv', case=False, na=False)</span><span id="d385" class="me mf it lz b gy mk mh l mi mj">mask2 = data['listed_in'].str.contains('tv', case=False, na=False)</span><span id="20cf" class="me mf it lz b gy mk mh l mi mj">mask3 = data['type'].str.contains('tv', case=False, na=False)</span><span id="fce8" class="me mf it lz b gy mk mh l mi mj">data[mask1 &amp; mask2 &amp; mask3].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/7e7d58ca1dc548b4a17975f76b7f7f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14Mi4rNnd0lWpnJwXJc9gQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8d04" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">请查看“tv”是如何出现在上面经过筛选的数据的所有三列中的。</p><ul class=""><li id="6961" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">另一种方法是使用稍微复杂的 apply()和 Lambda 函数。阅读文章<a class="ae ky" rel="noopener" target="_blank" href="/lambda-functions-with-practical-examples-in-python-45934f3653a8?source=your_stories_page-------------------------------------"> Lambda 函数和 Python </a>中的实际例子，了解这两个函数是如何工作的。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="f336" class="me mf it lz b gy mg mh l mi mj">cols_to_check = ['rating','listed_in','type']</span><span id="acfd" class="me mf it lz b gy mk mh l mi mj">pattern = 'tv'</span><span id="558e" class="me mf it lz b gy mk mh l mi mj">mask = data[cols_to_check].apply(<br/>        lambda col:col.str.contains(<br/>        pattern, na=False, case=False)).all(axis=1)</span></pre><p id="61c6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">上面的掩码代码表示，对于列表中的每一列<code class="fe lw lx ly lz b">cols_to_check</code>，应用<code class="fe lw lx ly lz b">str.contains('tv')</code>函数。然后使用<code class="fe lw lx ly lz b">.all(axis=1)</code>将三个掩码合并成一个掩码(或列)，方法是为每一行返回<code class="fe lw lx ly lz b">True</code>，其中<em class="ni">所有</em>列都是<code class="fe lw lx ly lz b">True</code>。(使用<code class="fe lw lx ly lz b">.any()</code>返回<code class="fe lw lx ly lz b">True</code>表示出现在至少一列中)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/6065c58f0ab7e80e5780ebd6dc8d8590.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*Bd1UHVqY8J2dM7bNbo824Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫。所有()和。作者的任何()</p></figure><p id="4310" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">过滤后的数据帧与之前显示的数据帧相同。</p><h2 id="7cf1" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">7.筛选一列中的值出现在另一列中的行。</h2><p id="79ae" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">我们可以检查一列中的值是否作为部分字符串出现在另一列中。</p><p id="2bf5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用我们的网飞数据集，让我们检查一下<code class="fe lw lx ly lz b">‘director’</code>作为演员也出现在<code class="fe lw lx ly lz b">‘cast’</code>中的行。</p><p id="a111" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在这个例子中，我们将使用<code class="fe lw lx ly lz b">df.apply()</code>、<code class="fe lw lx ly lz b">lambda</code>和<code class="fe lw lx ly lz b"><a class="ae ky" href="https://www.w3schools.com/python/ref_keyword_in.asp" rel="noopener ugc nofollow" target="_blank">'in’</a></code>关键字来检查某个值是否出现在给定的字符串序列中。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="5a40" class="me mf it lz b gy mg mh l mi mj">mask = data.apply(<br/>    lambda x: str(x[’director’]) in str(x[’cast’]), <br/>    axis=1)</span></pre><p id="ddef" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">上面的<code class="fe lw lx ly lz b"><a class="ae ky" href="https://www.datacamp.com/community/tutorials/pandas-apply" rel="noopener ugc nofollow" target="_blank">df.apply()</a></code>有一个 lambda 函数，它表示对于每一行(x)，检查<code class="fe lw lx ly lz b">‘director’ </code>中的值是否出现在<code class="fe lw lx ly lz b">‘cast’</code>列中，并返回<code class="fe lw lx ly lz b">True</code>或<code class="fe lw lx ly lz b">False</code>。我用<code class="fe lw lx ly lz b">str()</code>包装这些列，将每个值转换成一个字符串，因为它可能因为<code class="fe lw lx ly lz b">NaNs</code>而引发了一个<code class="fe lw lx ly lz b"><a class="ae ky" href="https://www.geeksforgeeks.org/handling-typeerror-exception-in-python/" rel="noopener ugc nofollow" target="_blank">TypeError</a> </code>。我们使用<code class="fe lw lx ly lz b">axis=1</code>来表示列方式，因此对每一行进行操作，结果将是一列(或系列)。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="f717" class="me mf it lz b gy mg mh l mi mj">data[mask].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/a7754e1da0f1ac7b7863ddfe0ba2e6ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mw-6rM2Z1UU_yRPfW3otbg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者应用()后的 NaNs</p></figure><p id="fffa" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">哎呦！<code class="fe lw lx ly lz b">NaNs</code>真多。让我们使用导演栏作为<code class="fe lw lx ly lz b">subset</code>来删除<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dropna.html" rel="noopener ugc nofollow" target="_blank">和</a>并重新显示。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="5ecb" class="me mf it lz b gy mg mh l mi mj">data[mask].dropna(subset=['director'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/0e8d3d3bbfafdbd1cec34cbbe73d52e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y9mhhgfOHX7bVl8stCaWaw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导演由作者出演</p></figure><p id="9c49" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">关于检查一列中的值是否与另一列中的值匹配的其他方法，请阅读本文。</p><h2 id="994e" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">8.检查给定子字符串的列名(或索引值)</h2><p id="7b90" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">我们可以检查列标题中是否存在部分字符串，并返回这些列。</p><p id="e58b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu"> <em class="ni">过滤列名</em> </strong></p><ul class=""><li id="e874" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">在下面的例子中，我们将使用<code class="fe lw lx ly lz b"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.filter.html" rel="noopener ugc nofollow" target="_blank">df.filter</a>(like=pattern, axis=1)</code>返回具有给定模式的列名。我们也可以用<code class="fe lw lx ly lz b">axis=columns</code>。请注意，这将返回过滤后的数据，并且不会生成掩码。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="c83a" class="me mf it lz b gy mg mh l mi mj">data.filter(like='in', axis=1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2847202ec2ffea54867262d54d55220c.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*z5jlCf3oHDFxFLYAY5mwKQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有“in”子字符串的已筛选列名</p></figure><ul class=""><li id="22ce" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">我们也可以使用<code class="fe lw lx ly lz b">df.loc</code>,在这里我们显示所有的行，但是只显示带有给定子字符串的列。</li></ul><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="a0de" class="me mf it lz b gy mg mh l mi mj">data.loc[:, data.columns.str.contains('in')]</span></pre><p id="cb3d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这段代码生成的结果和上面的图片一样。阅读<a class="ae ky" rel="noopener" target="_blank" href="/8-pandas-functionalities-for-every-data-scientist-f2cd3d890795">这篇</a>文章，了解<code class="fe lw lx ly lz b">.loc</code>如何工作。</p><p id="5087" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu"> <em class="ni">按指标值过滤</em> </strong></p><p id="6dd9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们先把标题设为索引，然后按‘爱’字过滤。我们将使用与上面相同的方法，只是稍作调整。</p><p id="18c0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用<code class="fe lw lx ly lz b">df.filter(like=’Love’, axis=0)</code>。我们也可以用<code class="fe lw lx ly lz b">axis=index</code>。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="4285" class="me mf it lz b gy mg mh l mi mj">df = data.set_index('title')</span><span id="d019" class="me mf it lz b gy mk mh l mi mj">df.filter(like='Love', axis=0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/ee2941de264e2b7a9e3d1e5e94eb6a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v0rVN3sBFPMmYdJYYK6o_w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用“爱”过滤索引</p></figure><p id="0b2a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用<code class="fe lw lx ly lz b">df.loc[]</code>显示与上述相同的结果。这里，我们在<code class="fe lw lx ly lz b"><a class="ae ky" rel="noopener" target="_blank" href="/8-pandas-functionalities-for-every-data-scientist-f2cd3d890795">.loc</a> </code>的第一部分选择所需的行，并在第二部分返回所有列。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="cd7b" class="me mf it lz b gy mg mh l mi mj">df.loc[df.index.str.contains('Love'), :]</span></pre></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h2 id="106b" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">其他过滤方法</h2><ul class=""><li id="5bfe" class="nm nn it lc b ld nd lg ne lj oq ln or lr os lv nr ns nt nu bi translated"><strong class="lc iu">使用熊猫查询()函数</strong></li></ul><p id="2896" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是 SQL 忍者特别青睐的一种数据过滤方式。语法是<code class="fe lw lx ly lz b">df.query(‘expression’)</code>，结果是一个修改的数据帧。很酷的一点是，除了像前面那样按单个列进行过滤之外，您还可以引用一个局部变量，并在表达式中调用 mean()之类的方法。它还提供了其他复杂遮罩的性能优势。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="6f8e" class="me mf it lz b gy mg mh l mi mj">#Example<br/>data.query('country == "South Africa"')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/15393927264cd7c63453a863f11bb3d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*peT4S3rDa40wNFDp1Sy4Tw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按作者筛选查询</p></figure><p id="b895" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我自己很少使用这种方法，但是很多人觉得它更简单，可读性更好。我鼓励你探索更多，因为它有令人信服的优势。<a class="ae ky" href="https://www.dataindependent.com/pandas/pandas-query/" rel="noopener ugc nofollow" target="_blank">这篇</a>和<a class="ae ky" href="https://sparrow.dev/pandas-query/" rel="noopener ugc nofollow" target="_blank">这篇</a>文章是一个很好的起点。</p><ul class=""><li id="e743" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated"><strong class="lc iu">使用其他字符串(Series.str .)示例函数</strong></li></ul><p id="5645" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这些方法还可以过滤数据以返回掩码</p><ul class=""><li id="4f25" class="nm nn it lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated"><code class="fe lw lx ly lz b">Series.str.len() &gt; 10</code></li><li id="6c4c" class="nm nn it lc b ld ou lg ov lj ow ln ox lr oy lv nr ns nt nu bi translated"><code class="fe lw lx ly lz b">Series.str.startswith(‘Nov’)</code></li><li id="5cf4" class="nm nn it lc b ld ou lg ov lj ow ln ox lr oy lv nr ns nt nu bi translated"><code class="fe lw lx ly lz b">Series.str.endswith(‘2019’)</code></li><li id="d0be" class="nm nn it lc b ld ou lg ov lj ow ln ox lr oy lv nr ns nt nu bi translated"><code class="fe lw lx ly lz b">Series.str.isnumeric()</code></li><li id="be76" class="nm nn it lc b ld ou lg ov lj ow ln ox lr oy lv nr ns nt nu bi translated"><code class="fe lw lx ly lz b">Series.str.isupper()</code></li><li id="948e" class="nm nn it lc b ld ou lg ov lj ow ln ox lr oy lv nr ns nt nu bi translated"><code class="fe lw lx ly lz b">Series.str.islower()</code></li></ul></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h2 id="f1d7" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">结论</h2><p id="650b" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated">作为一名数据专家，您可能经常需要根据数据的内容来分离数据。在本文中，我们研究了通过列中的字符串值过滤数据帧的 8 种方法。我们使用了熊猫、<code class="fe lw lx ly lz b">Lambda</code>函数和<code class="fe lw lx ly lz b">‘in’</code>关键字。我们还使用了|和&amp;符号，以及波浪号(~)来否定一个语句。</p><p id="6738" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们知道这些函数返回一个掩码(一列)的<code class="fe lw lx ly lz b">True</code>和<code class="fe lw lx ly lz b">False</code>值。然后，我们使用方括号(如<code class="fe lw lx ly lz b">df[mask]</code>)或使用。类似<code class="fe lw lx ly lz b">df.loc[mask]</code>的锁定功能。你可以从 Github 下载完整的代码<a class="ae ky" href="https://github.com/suemnjeri/Filtering-a-DataFrame/blob/master/filtering%20a%20dataframe%20by%20strings%20or%20patterns.ipynb" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="f80d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我希望你喜欢这篇文章。每当我发表新的文章时，想要收到更多这样的文章，请在这里订阅。如果你还不是一个媒体成员，并且愿意支持我成为一个作家，请点击<a class="ae ky" href="https://medium.com/@suemnjeri/membership" rel="noopener">这个链接</a>，我将获得一小笔佣金。感谢您的阅读！</p><h2 id="683c" class="me mf it bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">参考</h2><p id="1859" class="pw-post-body-paragraph la lb it lc b ld nd ju lf lg ne jx li lj nf ll lm ln ng lp lq lr nh lt lu lv im bi translated"><a class="ae ky" href="https://www.listendata.com/2019/07/how-to-filter-pandas-dataframe.html" rel="noopener ugc nofollow" target="_blank">筛选熊猫数据帧的 10 种方法</a></p><p id="75ab" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae ky" href="https://www.tutorialspoint.com/python_pandas/python_pandas_working_with_text_data.htm" rel="noopener ugc nofollow" target="_blank"> Python 熊猫字符串操作——处理文本数据</a></p><p id="6250" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/11350770/select-by-partial-string-from-a-pandas-dataframe" rel="noopener ugc nofollow" target="_blank">从熊猫数据帧中选择部分字符串</a></p></div></div>    
</body>
</html>