<html>
<head>
<title>Construct a biomedical knowledge graph with NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用自然语言处理构建生物医学知识图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/construct-a-biomedical-knowledge-graph-with-nlp-1f25eddc54a0?source=collection_archive---------3-----------------------#2021-10-25">https://towardsdatascience.com/construct-a-biomedical-knowledge-graph-with-nlp-1f25eddc54a0?source=collection_archive---------3-----------------------#2021-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="cdd0" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="2d68" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">了解如何结合OCR、命名实体链接、关系提取和外部丰富数据库来构建生物医学知识图</h2></div><p id="1eed" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我已经演示了如何<a class="ae lk" rel="noopener" target="_blank" href="/from-text-to-knowledge-the-information-extraction-pipeline-b65e7e30273e">从维基百科页面</a>中创建知识图表。然而，由于这篇文章引起了很多关注，我决定探索使用NLP技术构建知识图有意义的其他领域。在我看来，生物医学领域是一个很好的例子，当你经常分析基因、疾病、药物、蛋白质等之间的相互作用和关系时，用图表表示数据是有意义的。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/97e948ebf94be27a74b655b406682e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znU4UUQi0LlpQJBbShmVkQ.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">显示抗坏血酸与其他生物医学概念关系的子图范例。图片由作者提供。</p></figure><p id="d937" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在上面的可视化中，我们有抗坏血酸，也称为维生素C，以及它与其他概念的一些关系。例如，它表明维生素C可以用来治疗慢性胃炎。</p><p id="aef9" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，你可以让一组领域专家为你绘制药物、疾病和其他生物医学概念之间的所有联系。但是，不幸的是，我们中没有多少人能够负担得起聘请一组医生来为我们做这项工作。在这种情况下，我们可以求助于使用NLP技术来自动提取这些关系。好的方面是，我们可以使用NLP管道来读取所有的研究论文，坏的方面是，并不是所有获得的结果都是完美的。然而，鉴于我身边没有一组科学家准备好人工提取关系，我将求助于使用NLP技术来构建我自己的生物医学知识图。</p><p id="a7fd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这篇博文中，我将用一篇研究论文来引导你完成构建生物医学知识图谱所需的所有步骤。</p><div class="mb mc gp gr md me"><a href="https://arxiv.org/abs/2110.03526" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ja gy z fp mj fr fs mk fu fw iz bi translated">皮肤再生和毛发生长的组织工程</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">许多患有皮肤疾病如慢性伤口、不愈合溃疡和糖尿病溃疡的人需要皮肤…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">arxiv.org</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms lv me"/></div></div></a></div><p id="374c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我将使用由<a class="ae lk" href="https://arxiv.org/search/q-bio?searchtype=author&amp;query=Ahmadi%2C+M" rel="noopener ugc nofollow" target="_blank">穆罕默德·礼萨·艾哈迈迪</a>撰写的皮肤再生和毛发生长的组织工程论文。文章的PDF版本在CC0 1.0许可下提供。我们将通过以下步骤来构建知识图:</p><ul class=""><li id="3fa1" class="mt mu iq kq b kr ks ku kv kx mv lb mw lf mx lj my mz na nb bi translated">使用OCR阅读PDF文档</li><li id="8597" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated">文本预处理</li><li id="5178" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated">生物医学概念识别和链接</li><li id="daaa" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated">关系抽取</li><li id="12e4" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated">外部数据库丰富</li></ul><p id="6c98" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在本文结束时，您将使用以下模式构建一个图。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi nh"><img src="../Images/72e619fb366fdd063140003720a4e794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6rWaYPYOc7MDefBQQKdfUw.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">生物医学图表。图片由作者提供。</p></figure><p id="c641" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们将使用Neo4j来存储我们的图形，Neo4j是一个图形数据库，具有带标签的属性图模型。每篇文章可以有一个或多个作者。我们将文章内容拆分成句子，并使用NLP提取医疗实体及其关系。我们将实体之间的关系存储为中间节点而不是关系，这可能有点违背直觉。这一决定背后的关键因素是，我们希望对从中提取关系的源文本进行审计跟踪。使用带标签的属性图模型，您不能让一个关系指向另一个关系。为此，我们将医学概念之间的联系重构为一个中间节点。这也将允许领域专家评估关系是否被正确提取。</p><p id="e97d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这个过程中，我还将演示使用构建的图来搜索和分析存储信息的应用程序。</p><p id="48dd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们开始吧！</p><h2 id="27f4" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">使用OCR阅读PDF文档</h2><p id="c5ca" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">如前所述，研究论文的PDF版本在CC0 1.0许可下对公众开放，这意味着我们可以轻松地用Python下载它。我们将使用<a class="ae lk" href="https://pypi.org/project/pytesseract/" rel="noopener ugc nofollow" target="_blank"> pytesseract </a>库从PDF中提取文本。据我所知，pytesseract库是OCR中比较流行的库之一。如果你想跟随代码示例，我已经准备了一个<a class="ae lk" href="https://colab.research.google.com/github/tomasonjo/blogs/blob/master/bionlp/bioNLP2graph.ipynb" rel="noopener ugc nofollow" target="_blank"> Google Colab笔记本</a>，所以你不必自己复制粘贴代码。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="ae43" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">文本预处理</h2><p id="1ddb" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">现在我们已经有了文章内容，我们将继续从文本中删除部分标题和图描述。接下来，我们将把课文分成句子。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="9a26" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">生物医学命名实体链接</h2><p id="7b8e" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">现在是激动人心的部分。对于那些不熟悉NLP和命名实体识别和链接的人，让我们从一些基础知识开始。命名实体识别技术用于检测文本中的相关实体或概念。例如，在生物医学领域，我们想要识别文本中的各种基因、药物、疾病和其他概念。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oh"><img src="../Images/a9c08ed2b6a8ebbf4221718c72d6dbd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H4BTrsoM_6xibkxqtKiNKA.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">生物医学概念抽取。图片由作者提供。</p></figure><p id="4f6c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这个例子中，NLP模型识别了文本中的基因、疾病、药物、物种、突变和途径。如前所述，这个过程称为命名实体识别。命名实体识别的升级是所谓的命名实体链接。命名实体链接技术检测文本中的相关概念，并试图将它们映射到目标知识库。在生物医学领域，一些目标知识库是:</p><ul class=""><li id="105e" class="mt mu iq kq b kr ks ku kv kx mv lb mw lf mx lj my mz na nb bi translated"><a class="ae lk" href="https://www.ncbi.nlm.nih.gov/mesh/" rel="noopener ugc nofollow" target="_blank">网</a></li><li id="09dc" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated"><a class="ae lk" href="https://www.ebi.ac.uk/chebi/" rel="noopener ugc nofollow" target="_blank">车壁</a></li><li id="f0b0" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated"><a class="ae lk" href="https://www.omim.org/" rel="noopener ugc nofollow" target="_blank"> OMIM </a></li><li id="3389" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated"><a class="ae lk" href="https://www.ensembl.org/index.html" rel="noopener ugc nofollow" target="_blank">恩森布尔</a></li><li id="7fb9" class="mt mu iq kq b kr nc ku nd kx ne lb nf lf ng lj my mz na nb bi translated">以及其他等等</li></ul><p id="35b8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为什么我们要将医疗实体链接到目标知识库？主要原因是它有助于我们处理实体消歧。例如，我们不希望在图中用单独的实体表示抗坏血酸和维生素C，因为领域专家会告诉你这是一回事。第二个原因是，通过将概念映射到目标知识库，我们可以通过从目标知识库获取关于映射概念的信息来丰富我们的图模型。如果我们再次使用抗坏血酸的例子，如果我们已经知道它的CHEBI id，我们可以很容易地从CHEBI数据库中获取额外的信息。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oi"><img src="../Images/c05ad78a708b46c3915e2ea262542939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3zeWVbB38MoIp4PjXCzuaw.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">CHEBI网站上关于抗坏血酸的浓缩数据。网站上的所有内容都可以在<strong class="bd oj"> CC BY 4.0许可下获得。</strong>图片由作者提供。</p></figure><p id="03a7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我一直在寻找一个体面的开源预培训生物医学命名实体链接有一段时间了。许多NLP模型只专注于提取医学概念的特定子集，如基因或疾病。更罕见的是找到一个模型，检测大多数医学概念，并将它们链接到目标知识库。幸运的是，我偶然发现了<a class="ae lk" href="https://bern.korea.ac.kr/" rel="noopener ugc nofollow" target="_blank">BERN</a>【1】，一个神经生物医学实体识别和多类型规范化工具。如果我理解正确的话，它是一个微调的BioBert模型，集成了各种命名实体链接模型，用于将概念映射到生物医学目标知识库。不仅如此，它们还提供了一个免费的REST端点，因此我们不必处理让依赖项和模型工作的头痛问题。我上面使用的生物医学命名实体识别可视化是使用BERN模型创建的，因此我们知道它可以检测文本中的基因、疾病、药物、物种、突变和路径。</p><p id="ebbf" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">不幸的是，BERN模型没有为所有概念分配目标知识库id。所以我准备了一个脚本，首先查看是否为一个概念给出了一个不同的id，如果没有，它将使用实体名称作为id。我们还将计算句子文本的sha256，以便在以后进行关系抽取时更容易识别特定的句子。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="95a8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我检查了命名实体链接的结果，不出所料，它并不完美。例如，它没有将干细胞确定为一个医学概念。另一方面，它检测到一个名为“心脏、大脑、神经和肾脏”的单一实体。然而，在我的调查中，BERN仍然是我能找到的最好的开源生物医学模型。</p><h2 id="38a5" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">构建知识图表</h2><p id="0781" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">在查看关系提取技术之前，我们将仅使用实体构建一个生物医学知识图，并检查可能的应用。如前所述，我准备了一个<a class="ae lk" href="https://colab.research.google.com/github/tomasonjo/blogs/blob/master/bionlp/bioNLP2graph.ipynb" rel="noopener ugc nofollow" target="_blank"> Google Colab笔记本</a>，你可以用它来跟踪本文中的代码示例。为了存储我们的图表，我们将使用Neo4j。您不必准备本地Neo4j环境。相反，您可以使用免费的Neo4j沙盒实例。</p><div class="mb mc gp gr md me"><a href="https://neo4j.com/sandbox/" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ja gy z fp mj fr fs mk fu fw iz bi translated">Neo4j沙盒</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">使用个人的、可访问的在线图形数据库快速开始学习Neo4j。开始使用内置指南和…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">neo4j.com</p></div></div><div class="mn l"><div class="ok l mp mq mr mn ms lv me"/></div></div></a></div><p id="70b4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在沙箱中启动<a class="ae lk" href="https://sandbox.neo4j.com/?usecase=blank-sandbox" rel="noopener ugc nofollow" target="_blank">空白项目，并将连接细节复制到Colab笔记本中。</a></p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ol"><img src="../Images/ffcc078d5af57d8014ea28fc0d9cf462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jVaHYtwhe9vopJU5WYRBnQ.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">Neo4j沙盒连接详情。图片由作者提供。</p></figure><p id="b6a4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，您可以在笔记本中准备Neo4j连接了。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="f92b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们将从将作者和文章导入图中开始。文章节点将只包含标题。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="a838" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果打开Neo4j浏览器，应该会看到下图。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi om"><img src="../Images/ed32f434234f1d3763f23e85ee16f264.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*0_3Dz53cdV3LkGv5QkRGgA.png"/></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">图片由作者提供。</p></figure><p id="923f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以通过执行以下Cypher查询来导入句子和提到的实体:</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="dcd3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以执行以下Cypher查询来检查构建的图形:</p><pre class="lm ln lo lp gt on oo op oq aw or bi"><span id="2b12" class="ni nj iq oo b gy os ot l ou ov">MATCH p=(a:Article)-[:HAS_SENTENCE]-&gt;()-[:MENTIONS]-&gt;(e:Entity)<br/>RETURN p LIMIT 25</span></pre><p id="8f1f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您已经正确导入了数据，您应该会看到类似的可视化效果。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ow"><img src="../Images/9301be5ded9b8599f1e970aa9fc1592b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*46ZaD1NQfN17dUooUgcFEQ.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">存储为图形的实体提取。图片由作者提供。</p></figure><h2 id="2f40" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">知识图应用</h2><p id="88ea" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">即使没有关系提取流程，我们的图也已经有几个用例了。</p><p id="7e90" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">搜索引擎</strong></p><p id="9425" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们可以用我们的图表作为搜索引擎。例如，您可以使用下面的Cypher查询来查找提到特定医疗实体的句子或文章。</p><pre class="lm ln lo lp gt on oo op oq aw or bi"><span id="f53f" class="ni nj iq oo b gy os ot l ou ov">MATCH (e:Entity)&lt;-[:MENTIONS]-(s:Sentence)<br/>WHERE e.name = "autoimmune diseases"<br/>RETURN s.text as result</span></pre><p id="1314" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="ox">结果</em></p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oy"><img src="../Images/437f6d1498a63ed9efb6b2d6f8a2d074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZSAV2mP6rroWBd0xDR8Cxw.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">图片由作者提供。</p></figure><p id="21fb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">同现分析</strong></p><p id="c8ea" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">第二种选择是共现分析。如果医疗实体出现在同一个句子或文章中，您可以定义它们之间的共现。我发现一篇文章[2]使用医学共现网络来预测医疗实体之间新的可能联系。</p><div class="mb mc gp gr md me"><a href="https://pubmed.ncbi.nlm.nih.gov/25160252/" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ja gy z fp mj fr fs mk fu fw iz bi translated">网状共现网络中的链接预测:初步结果- PubMed</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">基于文献的发现是指从科学文献中自动发现隐含关系</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">pubmed.ncbi.nlm.nih.gov</p></div></div><div class="mn l"><div class="oz l mp mq mr mn ms lv me"/></div></div></a></div><p id="eb64" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以使用下面的Cypher查询来查找经常在同一个句子中同时出现的实体。</p><pre class="lm ln lo lp gt on oo op oq aw or bi"><span id="70e7" class="ni nj iq oo b gy os ot l ou ov">MATCH (e1:Entity)&lt;-[:MENTIONS]-()-[:MENTIONS]-&gt;(e2:Entity)<br/>WHERE id(e1) &lt; id(e2)<br/>RETURN e1.name as entity1, <br/>       e2.name as entity2, <br/>       count(*) as cooccurrence<br/>ORDER BY cooccurrence<br/>DESC LIMIT 3</span></pre><p id="1c6d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="ox">结果</em></p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="1810" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">显然，如果我们分析成千上万或更多的文章，结果会更好。</p><p id="a18e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">考察作者专长</strong></p><p id="5863" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您还可以使用这个图表，通过检查作者最常写的医学实体来找到作者的专业知识。有了这些信息，你也可以建议未来的合作。</p><p id="078c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">执行下面的Cypher查询，检查我们的作者在研究论文中提到了哪些医疗实体。</p><pre class="lm ln lo lp gt on oo op oq aw or bi"><span id="532a" class="ni nj iq oo b gy os ot l ou ov">MATCH (a:Author)-[:WROTE]-&gt;()-[:HAS_SENTENCE]-&gt;()-[:MENTIONS]-&gt;(e:Entity)<br/>RETURN a.name as author,<br/>       e.name as entity,<br/>       count(*) as count<br/>ORDER BY count DESC<br/>LIMIT 5</span></pre><p id="352f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="ox">结果</em></p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="1282" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">关系抽取</h2><p id="e2b7" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">现在我们将尝试提取医学概念之间的关系。根据我的经验，关系提取至少比命名实体提取难一个数量级。如果您不期望命名实体链接有完美的结果，那么您肯定会期望关系提取技术有一些错误。</p><p id="3bbb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我一直在寻找可用的生物医学关系提取模型，但没有发现任何现成的或不需要微调的模型。看起来关系抽取领域处于前沿，并且希望在未来我们会看到更多的关注。不幸的是，我不是NLP专家，所以我避免对自己的模型进行微调。相反，我们将使用基于论文<a class="ae lk" href="https://www.aclweb.org/anthology/2020.coling-main.124" rel="noopener ugc nofollow" target="_blank">的零触发关系提取器，探索few rel</a>【3】的零触发限制。虽然我不建议将这个模型投入生产，但它对于简单的演示来说已经足够好了。该模型在<a class="ae lk" href="https://huggingface.co/fractalego/fewrel-zero-shot" rel="noopener ugc nofollow" target="_blank"> HuggingFace </a>上可用，因此我们不必处理培训或设置模型。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="c729" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">使用零触发关系提取器，您可以定义您想要检测的关系。在这个例子中，我使用了<em class="ox">关联的</em>和<em class="ox">交互</em>关系。我也尝试过更具体的关系类型，如款待、原因等，但结果并不理想。</p><p id="57dc" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">使用这个模型，您必须定义您想要检测哪对实体之间的关系。我们将使用命名实体链接的结果作为关系提取过程的输入。首先，我们找到所有提到两个或更多实体的句子，然后通过关系提取模型运行它们以提取任何联系。我还定义了一个阈值0.85，这意味着如果一个模型预测实体之间的关联概率低于0.85，我们将忽略该预测。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="db24" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们存储关系以及用于提取图中关系的源文本。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/558dff2eb8f49078285329e86690f215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*G5vHHUQtn9fUwNEG0LaxkA.png"/></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">存储在图中的提取关系。图片由作者提供。</p></figure><p id="207e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以使用以下Cypher查询来检查实体和源文本之间的提取关系:</p><pre class="lm ln lo lp gt on oo op oq aw or bi"><span id="b438" class="ni nj iq oo b gy os ot l ou ov">MATCH (s:Entity)-[:REL]-&gt;(r:Relation)-[:REL]-&gt;(t:Entity), <br/>      (r)&lt;-[:MENTIONS]-(st:Sentence)<br/>RETURN s.name as source_entity, <br/>       t.name as target_entity, <br/>       r.type as type, <br/>       st.text as source_text</span></pre><p id="815c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="ox">结果</em></p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi pb"><img src="../Images/676ba1092b2c18c6262d4ac9959b2ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yXNXqzfWtOU0BB1oLDFOHg.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">图片由作者提供。</p></figure><p id="5e3c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如前所述，我用来提取关系的NLP模型并不完美，由于我不是医学博士，我不知道它遗漏了多少连接。然而，它检测到的似乎是合理的。</p><h2 id="5b7f" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">外部数据库丰富</h2><p id="3508" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">正如我之前提到的，我们仍然可以使用外部数据库，如CHEBI或MESH来丰富我们的图表。例如，我们的图包含一个医疗实体<a class="ae lk" href="https://id.nlm.nih.gov/mesh/D004820.html" rel="noopener ugc nofollow" target="_blank">大疱性表皮松解症</a>，我们还知道它的网格id。</p><p id="e251" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以使用以下查询检索大疱性表皮松解症的网格id:</p><pre class="lm ln lo lp gt on oo op oq aw or bi"><span id="6eae" class="ni nj iq oo b gy os ot l ou ov">MATCH (e:Entity)<br/>WHERE e.name = "Epidermolysis bullosa"<br/>RETURN e.name as entity, e.other_ids as other_ids</span></pre><p id="6cd9" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以继续检查网格以找到可用的信息:</p><div class="mb mc gp gr md me"><a href="https://id.nlm.nih.gov/mesh/D004820.html" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ja gy z fp mj fr fs mk fu fw iz bi translated">网状链接数据</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">语义网研究人员的医学主题词的持久URL、本体和SPARQL端点…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">id.nlm.nih.gov</p></div></div><div class="mn l"><div class="pc l mp mq mr mn ms lv me"/></div></div></a></div><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/83d3c5be2a9784e6381b20959deade0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*P7bYJ-cNgSvIhJtOR3ibqA.png"/></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">作者截图。数据由美国国家医学图书馆提供。</p></figure><p id="3a80" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">以下是MeSH网站上关于大疱性表皮松解症的可用信息截图。如前所述，我不是医学博士，所以我不知道在图表中模拟这些信息的最佳方式。但是，我将向您展示如何使用apoc.load.json过程从MeSH REST端点获取信息，从而在Neo4j中检索这些信息。然后，您可以请领域专家帮助您对这些信息进行建模。</p><p id="1f63" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">从MeSH REST端点获取信息的密码查询是:</p><pre class="lm ln lo lp gt on oo op oq aw or bi"><span id="dcf8" class="ni nj iq oo b gy os ot l ou ov">MATCH (e:Entity)<br/>WHERE e.name = "Epidermolysis bullosa"<br/>WITH e,<br/>    [id in e.other_ids WHERE id contains "MESH" | split(id,":")[1]][0] as meshId<br/>CALL apoc.load.json("https://id.nlm.nih.gov/mesh/lookup/details?descriptor=" + meshId) YIELD value<br/>RETURN value</span></pre><h2 id="bf5b" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">作为机器学习数据输入的知识图</h2><p id="ca20" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">作为最后一个想法，我将快速向您介绍如何使用生物医学知识图作为机器学习工作流程的输入。近年来，在节点嵌入领域已经有了大量的研究和进展。节点嵌入模型将网络拓扑转化为嵌入空间。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi pe"><img src="../Images/1103eb11b5e948d254546245a56d7360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fUF3v1IHjpUT1o5HiKF1g.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">版权2017 Manan Shah，SNAP Group。图片在https://github.com/snap-stanford/cs224w-notes<a class="ae lk" href="https://github.com/snap-stanford/cs224w-notes" rel="noopener ugc nofollow" target="_blank"/>的麻省理工学院许可下提供。</p></figure><p id="ee05" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">假设您构建了一个生物医学知识图，其中包含医学实体和概念、它们之间的关系以及来自各种医学数据库的丰富内容。您可以使用节点嵌入技术来学习节点表示，这是固定长度的向量，并将它们输入到您的机器学习工作流中。从药物再利用到药物副作用或副作用预测，各种应用都在使用这种方法。我发现一篇研究论文使用<a class="ae lk" href="https://arxiv.org/abs/2010.09600" rel="noopener ugc nofollow" target="_blank">链接预测新疾病的潜在疗法</a>【4】。</p><h2 id="79f7" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">结论</h2><p id="ae91" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">生物医学领域是知识图表适用的主要例子。有许多应用程序，从简单的搜索引擎到更复杂的机器学习工作流。希望通过阅读这篇博文，你能对如何使用生物医学知识图来支持你的应用有所启发。你可以开始一个<a class="ae lk" href="https://neo4j.com/sandbox/" rel="noopener ugc nofollow" target="_blank">免费的Neo4j沙盒</a>并从今天开始探索。</p><p id="48c0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">和往常一样，代码可以在<a class="ae lk" href="https://github.com/tomasonjo/blogs/blob/master/bionlp/bioNLP2graph.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p><h2 id="f901" class="ni nj iq bd nk nl nm dn nn no np dp nq kx nr ns nt lb nu nv nw lf nx ny nz iw bi translated">参考</h2><p id="faac" class="pw-post-body-paragraph ko kp iq kq b kr oa ka kt ku ob kd kw kx oc kz la lb od ld le lf oe lh li lj ij bi translated">[1]丁·金<em class="ox">等人</em>。“一种用于生物医学文本挖掘的神经命名实体识别和多类型规范化工具”，载于<em class="ox"> IEEE Access </em>，第7卷，第73729–73740页，2019，doi:10.1109/Access。20007.686686666607</p><p id="d8b8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[2] Kastrin A，Rindflesch TC，Hristovski D .网状共现网络中的链接预测:初步结果。学习健康技术信息。2014;205:579–83.PMID: 25160252。</p><p id="45ac" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[3]塞托利，A. (2020)。探索FewRel的零射击极限。在<em class="ox">第28届国际计算语言学会议记录</em>(第1447-1451页)。国际计算语言学委员会。</p><p id="d78d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[4]张(r .)、赫里斯托夫斯基(d .)、舒特(d .)、卡斯特林(a .)、菲兹曼(m .)、基利科格鲁(h .)(2021年)。通过知识图谱完成<em class="ox">实现新冠肺炎的药品再利用。生物医学信息学杂志，115，103696。</em></p></div></div>    
</body>
</html>