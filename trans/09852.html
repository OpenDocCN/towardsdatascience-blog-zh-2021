<html>
<head>
<title>8 Python Snippets for Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学的8个Python片段</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/8-python-snippets-for-data-science-cae923a43fd7?source=collection_archive---------24-----------------------#2021-09-15">https://towardsdatascience.com/8-python-snippets-for-data-science-cae923a43fd7?source=collection_archive---------24-----------------------#2021-09-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/2902aa0725f03da7886c30aeefdc9754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Md3Gy3iJ_AVIR7IQ"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">詹姆斯·哈里森在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="0e8c" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">常见数据科学问题的快速解决方案</h2></div><p id="053b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我喜欢定期查看我的数据库，里面有对数据科学有用的python代码片段，让简单的解决方案永远留在我的脑海里。</p><p id="8c83" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu">在本文中，我将分享8个Python片段，以方便您的数据科学工作流程</em> </strong></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="8d59" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">1.获取熊猫数据帧的内存使用情况</h2><p id="2bf8" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">这里我们使用pandas的<code class="fe na nb nc nd b">.memory_usage()</code>方法来获得pandas数据帧的字节大小，然后将其转换为兆字节</p><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="e99b" class="mc md jj nd b gy nm nn l no np">import pandas as pd<br/>import numpy as np<br/><br/>df = pd.DataFrame(dict(a=list(range(1000)), b=np.random.random(1000)))<br/>BYTES_TO_MB_DIV = 0.000001<br/>mem = round(df.memory_usage().sum() * BYTES_TO_MB_DIV, 3) <br/>print(mem, "MB")</span><span id="1c4b" class="mc md jj nd b gy nq nn l no np">0.016 MB</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="f250" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">2.制作熊猫列小写字母</h2><p id="f480" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">这里我们创建一个简单的dataframe，然后使用pandas <code class="fe na nb nc nd b">.str.lower()</code>方法将列中的所有字母变成小写</p><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="6b18" class="mc md jj nd b gy nm nn l no np">from string import ascii_letters<br/>import pandas as pd</span><span id="cd13" class="mc md jj nd b gy nq nn l no np">df = pd.DataFrame(dict(letters=np.random.choice(list(ascii_letters), 1000), numbers=np.random.randint(0,1000,1000)))<br/>df["letters"] = df["letters"].str.lower()<br/>df["letters"]</span><span id="2a88" class="mc md jj nd b gy nq nn l no np"># Output</span><span id="b7f1" class="mc md jj nd b gy nq nn l no np">0      m<br/>1      y<br/>2      s<br/>3      c<br/>4      l<br/>      ..<br/>995    o<br/>996    q<br/>997    w<br/>998    s<br/>999    u<br/>Name: letters, Length: 1000, dtype: object</span></pre><h2 id="4982" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">3.使用装饰器分析代码</h2><p id="8e02" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在这里，我们使用cProfile包通过一个简单的装饰器来分析一个函数</p><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="78f3" class="mc md jj nd b gy nm nn l no np">import cProfile<br/><br/>def testPerformance(func):<br/>    def wrapper(x):<br/>        print(cProfile.run(f"{func(x)}"))<br/>    <br/>    return wrapper<br/><br/>@testPerformance<br/>def printLoop(n):<br/>    for i in range(n):<br/>        print(i)<br/>printLoop(100)</span><span id="deb6" class="mc md jj nd b gy nq nn l no np"># Output</span><span id="9d93" class="mc md jj nd b gy nq nn l no np">0<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>.<br/>.<br/>.<br/>99<br/>         3 function calls in 0.000 seconds<br/><br/>   Ordered by: standard name<br/><br/>   ncalls  tottime  percall  cumtime  percall filename:lineno(function)<br/>        1    0.000    0.000    0.000    0.000 &lt;string&gt;:1(&lt;module&gt;)<br/>        1    0.000    0.000    0.000    0.000 {built-in method builtins.exec}<br/>        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}<br/><br/>None</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="92d2" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">4.将函数映射到列表元素</h2><p id="8f6d" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">这里我们使用<code class="fe na nb nc nd b">map()</code>内置方法将<code class="fe na nb nc nd b">str.upper()</code>方法映射到一个字母列表</p><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="a9e4" class="mc md jj nd b gy nm nn l no np">from string import ascii_letters<br/>letters = list(ascii_letters)<br/>newlist = list(map(str.upper, letters))<br/>newlist</span><span id="c0b8" class="mc md jj nd b gy nq nn l no np">['A',<br/>...<br/> 'O',<br/> 'P',<br/> 'Q',<br/> 'R',<br/> 'S',<br/> 'T',<br/> 'U',<br/> 'V',<br/> 'W',<br/> 'X',<br/> 'Y',<br/> 'Z']</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="dab0" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">5.基于列表中的值过滤数据帧</h2><p id="a0a9" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">这里，我们将列表中的值与熊猫列中的值进行匹配</p><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="7726" class="mc md jj nd b gy nm nn l no np">df = pd.DataFrame(dict(a=np.random.randint(0,100,100)))<br/>values = np.random.randint(0,50,50)<br/>df.loc[df['a'].isin(values)]</span></pre><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/08702ec68d7a823a4fb502a083963c84.png" data-original-src="https://miro.medium.com/v2/format:webp/1*wFQ0YLWl0_pJup0a1j7W0w.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="9f1d" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">6.用matplotlib从字典中绘图</h2><p id="201c" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">这里我们使用matplotlib直接从字典中绘制数据。</p><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="9de3" class="mc md jj nd b gy nm nn l no np"># source: matplotlib documentation<br/><br/>data = {'a': np.arange(50),<br/>        'c': np.random.randint(0, 50, 50),<br/>        'd': np.random.randn(50)}<br/>data['b'] = data['a'] + 10 * np.random.randn(50)<br/>data['d'] = np.abs(data['d']) * 100<br/><br/>plt.scatter('a', 'b', c='c', s='d', data=data)<br/>plt.xlabel('entry a')<br/>plt.ylabel('entry b')<br/>plt.show()</span></pre><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/4c0e7098ed146b8c081bd9a0d502292d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*nqM3J1mC7UmirgDddB6KeQ.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="44bc" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">7.在matplotlib中使用文本和箭头进行注释</h2><p id="81ee" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在这个改编自matplotlib文档的例子中，我们使用<code class="fe na nb nc nd b">plt.annotate()</code>用箭头和文本注释了一个图形</p><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="6700" class="mc md jj nd b gy nm nn l no np"># adapted from: https://matplotlib.org/stable/tutorials/text/annotations.html<br/><br/>ax = plt.subplot()<br/>t = np.arange(0.0, 10.0, 0.01)<br/>s = np.cos(2*np.pi*t)<br/>line, = plt.plot(t, s, lw=2, color="green")<br/><br/>plt.annotate('local max', xy=(2, 1), xytext=(3, 1.5),<br/>             arrowprops=dict(facecolor='black', shrink=0.05),<br/>             )<br/><br/>plt.annotate('local min', xy=(3.5, -1), xytext=(3, -1.5),<br/>             arrowprops=dict(facecolor='black', shrink=0.05),<br/>             )<br/><br/>plt.ylim(-2, 2)<br/>plt.show()</span></pre><p id="544b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">输出</strong></p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/df0864d82569d0aab8a958bc39f99d7d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Ai55dSqBKoEiwgpFQV_v6A.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="328a" class="mc md jj bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">8.格式化日期。join()和日期时间</h2><pre class="ne nf ng nh gt ni nd nj nk aw nl bi"><span id="5581" class="mc md jj nd b gy nm nn l no np">from datetime import datetime<br/><br/>date = datetime.now()<br/>date = "-".join([str(date.year),str(date.month),str(date.day)])<br/>print(date)</span><span id="ed74" class="mc md jj nd b gy nq nn l no np"># Output<br/>'2021-9-15'</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ea63" class="ns md jj bd me nt nu nv mh nw nx ny mk kp nz kq mn ks oa kt mq kv ob kw mt oc bi translated">关于数据科学片段的结束语</h1><p id="e8b3" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">对于任何想要优化工作流程的数据科学家来说，保持一个更新的快速片段列表来解决简单的问题是必须的。在这篇文章中，我试图分享一些在某个时候对我有帮助的快速解决方案。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="dd0b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你对数据科学感兴趣，可以看看这个Udacity纳米学位项目:</p><blockquote class="od oe of"><p id="054f" class="ky kz lu la b lb lc kk ld le lf kn lg og li lj lk oh lm ln lo oi lq lr ls lt im bi translated">这是一个附属链接，如果你使用该课程，我会得到一小笔佣金，干杯！:)</p></blockquote><ul class=""><li id="07a1" class="oj ok jj la b lb lc le lf lh ol ll om lp on lt oo op oq or bi translated"><a class="ae jg" href="http://seekoapp.io/61414ca762f49f00081def36" rel="noopener ugc nofollow" target="_blank">成为数据科学家</a></li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b209" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢这篇文章，在<a class="ae jg" href="https://lucas-soares.medium.com/" rel="noopener">媒体</a>、<a class="ae jg" href="https://lucas-soares.medium.com/subscribe" rel="noopener">上关注我，订阅我的时事通讯</a>，在<a class="ae jg" href="https://twitter.com/LucasEnkrateia" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae jg" href="https://www.linkedin.com/in/lucas-soares-969044167/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae jg" href="https://www.instagram.com/theaugmentedself/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>，或者<a class="ae jg" href="https://lucas-soares.medium.com/membership" rel="noopener">加入媒体</a>！谢谢，下次再见！:)</p></div></div>    
</body>
</html>