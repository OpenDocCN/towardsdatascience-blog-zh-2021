<html>
<head>
<title>6 SQL Window Functions Coding Problems On Ranking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">6 SQL窗口函数编码排序问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/6-sql-window-functions-coding-problems-on-ranking-interview-countdown-p1-9be0ccf66453?source=collection_archive---------3-----------------------#2021-05-28">https://towardsdatascience.com/6-sql-window-functions-coding-problems-on-ranking-interview-countdown-p1-9be0ccf66453?source=collection_archive---------3-----------------------#2021-05-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7134" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">面试倒计时P1:SQL面试快到了，你正在寻找一些有挑战性的练习来测试你的准备情况？你来对地方了！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/495fda517ec9465f1e07a36a088d116b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TFmMUrTygjg-a-3x"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">特里斯坦·加塞特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f3d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv"> &gt; &gt; &gt;还不是中等会员？考虑与我的</em> <a class="ae ky" href="https://anbento4.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="lv">推荐链接</em> </strong> </a> <em class="lv">注册，以获得Medium提供的一切服务，费用低至每月5美元</em><strong class="lb iu"><em class="lv"/></strong><em class="lv">！</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="be87" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">你的面试倒计时开始了吗？</h1><p id="1590" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">恭喜你！如果你正在阅读这篇文章，你可能已经通过了第一轮筛选面试，并被邀请进入下一步:<em class="lv">一轮SQL编码</em>。</p><p id="6e44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论你的下一次面试是在24小时后还是2周后，有一件事是肯定的:当你通过解决实际的练习来尽最大努力复习最常见的SQL主题时，时间正在流逝。</p><p id="1041" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了帮助你测试你的知识，并意识到SQL窗口函数的流行程度，下面我分享了一些具有挑战性的排名练习，通过重新创建你与技术面试官的互动。</p><blockquote class="na"><p id="8372" class="nb nc it bd nd ne nf ng nh ni nj lu dk translated">这一切都是巧合，但我想不起在我的任何一次SQL面试中，没有人要求我使用窗口函数来解决问题。</p></blockquote><p id="3562" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">称之为巧合吧，但我想不起在我的任何一次SQL面试中，没有人要求我使用窗口函数解决问题。我建议您特别注意<strong class="lb iu"> RANK() </strong>、<strong class="lb iu"> DENSE_RANK() </strong>和<strong class="lb iu"> ROW_NUMBER(): </strong> <em class="lv">这些函数可用于对特定窗口内的数据进行排名，或者，如果您愿意，还可以生成组内排名指数</em>。</p><p id="28d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来的所有编码问题都是对SQL挑战的细微重新解释，这些挑战来自于<strong class="lb iu"/><a class="ae ky" href="https://platform.stratascratch.com/coding?via=antonello" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">StrataScratch</strong></a>，这是一个优秀的平台，专门为希望从事数据科学或数据工程职业的人提供。</p><p id="e72d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在他们的平台上，你可以找到FAANG和其他主要科技公司提出的最新和最现实的面试问题，并决定你是否希望使用SQL或Python来解决这些问题。</p><blockquote class="na"><p id="2374" class="nb nc it bd nd ne nf ng nh ni nj lu dk translated">现在是时候写一些代码了！你准备好了吗？</p></blockquote><div class="np nq nr ns nt nu"><a rel="noopener follow" target="_blank" href="/7-fundamental-sql-concepts-you-will-be-challenged-with-in-faang-interviews-d26097a8d867"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">下一次编码面试前要掌握的7个基本SQL概念</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">通过从真实面试中解决问题来练习，最终得到你应得的工作。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">towardsdatascience.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ks nu"/></div></div></a></div><h2 id="e781" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">问题#1— RANK()函数|难度:难</h2><p id="7f8c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><strong class="lb iu">采访者:</strong> <em class="lv">“如您所见，表格</em><strong class="lb iu"><em class="lv">twitch _ sessions</em></strong><em class="lv">包括一个</em><strong class="lb iu"><em class="lv">user _ id</em></strong><em class="lv">字段，该字段不是唯一的，而是在特定用户每次开始新会话时记录的。</em><strong class="lb iu"><em class="lv">session _ type</em></strong><em class="lv">字段将告诉您在会话开始时，该特定的用户id是查看者还是流媒体工具":</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/e40f4b0745b90182594ddc29057e4591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FD1Cy8JJ3y9DdYWCZECK6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<strong class="bd ow"> twitch_sessions </strong>表的前几行。</p></figure><p id="5632" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">面试官:</strong> <em class="lv">“我想让你找出第一次以观众身份进行会话的用户完成的会话数量。您应该只返回他们的用户ID和会话数。”</em></p><p id="a410" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预期产出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/037a148360c3394f86c2ddd98ac783dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C72Uu--r9uUmBP380-35mw.png"/></div></div></figure><p id="bd88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">面试官的提示:</strong> <em class="lv">“在编写任何代码之前，我会建议你从描述你希望在这里实现什么开始。在这种特定情况下，将请求分成2-3个步骤可能是明智的选择。”</em></p><h2 id="ea14" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">解决方案A)使用CTEs +内部连接:</h2><p id="05cc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我强烈建议您在编写SQL编码问题的解决方案时使用<a class="ae ky" href="https://learnsql.com/blog/when-to-use-cte/" rel="noopener ugc nofollow" target="_blank">通用表表达式(cte)</a>。在我看来，cte非常简洁，可读性强，能帮助你逐步分解你的解决方案，更有效地与面试官分享你的推理。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><p id="0119" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我使用了<code class="fe pa pb pc pd b">cte1</code>来创建一个由<code class="fe pa pb pc pd b">user_id</code>排序的排名，排序由<code class="fe pa pb pc pd b">session_start</code> ( <em class="lv">是您应该关心的唯一时间戳</em>)。然后我使用在第一次CTE中计算出的排名作为<code class="fe pa pb pc pd b">cte2</code>中的过滤器，来隔离在第一次会话中观看的用户。最终，在外部语句中，我用<code class="fe pa pb pc pd b">cte2</code>内部连接了原始表，使其像过滤器一样工作，并计算了会话数。</p><p id="0f7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里使用<code class="fe pa pb pc pd b">rank()</code>函数是有意义的，因为您只是在寻找第一个会话，当通过时间戳排序时，不太可能出现平局。</p><h2 id="08b5" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">解决方案B)使用子查询+ IN()运算符</h2><p id="3f7f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">解决这个问题的另一种方法是使用两个子查询。代码可能看起来更紧凑，但也更难阅读，并且无助于识别不同的步骤。如前所述，一般来说，你应该更喜欢cte，因为它们是行业标准，而且如果你过于频繁地使用子查询，你的同事会暗地里讨厌你，:D</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="a8e0" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">问题#2 - RANK()函数|难度:中等</h2><p id="f5fe" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><strong class="lb iu"> <em class="lv">面试官:</em> </strong> <em class="lv">"表格</em><strong class="lb iu"><em class="lv">online _ retail</em></strong><em class="lv">包含了2010年至2011年我们网站上销售的商品数据。考虑将</em> <strong class="lb iu"> <em class="lv">描述</em> </strong> <em class="lv">字段作为项目名称。还为您提供了</em> <strong class="lb iu"> <em class="lv">发票日期</em> </strong> <em class="lv">、</em> <strong class="lb iu"> <em class="lv">单价</em> </strong> <em class="lv">和</em> <strong class="lb iu"> <em class="lv">数量</em></strong><em class="lv">:</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/8280f83ecd224dbfebbb49e7001338b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*arRZs1svsNFpprZ5-ro_Dw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ow">在线_零售</strong>表的前几行。</p></figure><p id="1e3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="lv">面试官:</em> </strong> <em class="lv">“我问你的是找出每个月最畅销的物品，其中最畅销的物品是用公式</em> <strong class="lb iu"> <em class="lv">(单位*数量)</em> </strong> <em class="lv">计算出来的。请输出月份号、商品描述以及客户支付的金额。”</em></p><p id="377e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预期输出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/8a4a59647e9f265df066975380047643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_MjV7ZRnO0LpSvcOXRG1Q.png"/></div></div></figure><h2 id="82ba" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">解决方案:</h2><p id="3dfb" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">显然，这个解决方案看起来很简单，但是有很多理论</p><p id="a8bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参与其中。例如，要使代码紧凑，您必须知道:</p><ul class=""><li id="7eaa" class="pf pg it lb b lc ld lf lg li ph lm pi lq pj lu pk pl pm pn bi translated">不能在<code class="fe pa pb pc pd b">GROUP BY</code>子句中包含窗口函数。</li><li id="cb9b" class="pf pg it lb b lc po lf pp li pq lm pr lq ps lu pk pl pm pn bi translated">但是，您可以在窗口函数中嵌套聚合函数，因为窗口函数是在它们之后进行逻辑计算的。这不完全是他们教你的第一件事吧？</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><p id="8cea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个特殊的例子中，我创建了一个按发票月份划分的排名，并使用一个聚合函数作为<code class="fe pa pb pc pd b">ORDER BY</code>子句的参数。</p><p id="fd45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在外部的<code class="fe pa pb pc pd b">SELECT</code>语句中，我只是过滤了带有<code class="fe pa pb pc pd b">rnk = 1</code>的条目。使用一般的<code class="fe pa pb pc pd b">rank()</code>函数是可行的，因为问题不是要求唯一的排名值。</p><h2 id="4b70" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">问题#3 — DENSE_RANK()函数|难度:简单</h2><p id="f73a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><strong class="lb iu">面试官:</strong> <em class="lv">"表格</em> <strong class="lb iu"> <em class="lv">公寓</em> </strong> <em class="lv">以</em> <strong class="lb iu"> <em class="lv">公寓id </em> </strong> <em class="lv">为主键，包括房产类型、床位和卧室数量、位置以及房东id等详细信息。你会发现这些数据非常直观。”</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/99d87803f11540b256ba21843ff73df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KnH_iOxhrCQ09P5bCEVvhQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ow">公寓</strong>桌前几排。</p></figure><p id="8927" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">面试官:</strong> <em class="lv">“要求很简单:根据我们网站上列出的床位数对每个主持人进行排名。请记住，一个主机可以管理多个属性。拥有最多床位的主机应排在第一位(rank = 1)，拥有最少床位的主机应排在最后。拥有相同床位数的主机应该获得相同的排名，并且排名应该避免差距。”</em></p><p id="1e5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预期输出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/8a9477b748790e50ec1776168b203265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QFFj0Z6qvHHCXr57ShMsgQ.png"/></div></div></figure><h2 id="223d" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">解决方案:</h2><p id="191a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">与前面的解决方案一样，我使用嵌套聚合函数来生成一个按<code class="fe pa pb pc pd b">sum(n_beds)</code>(<em class="lv">注意，在窗口函数中，您可以声明一个嵌套聚合，但是您不能在别名下传递完全相同的聚合，您必须显式地键入它</em>)。这一次的请求是在出现一个或多个平局的情况下不要在排名中引入差距，因此我使用了<code class="fe pa pb pc pd b">DENSE_RANK()</code>函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h2 id="bd8b" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">问题#4— DENSE_RANK()函数|难度:中等</h2><p id="18af" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">面试官: <em class="lv">“在这个问题中，你需要两张桌子。第一个是</em><strong class="lb iu"><em class="lv">RC _ calls</em></strong><em class="lv">，包含我们的客户服务部门收到的电话的详细信息，支持我们的母公司(公司1)和其子公司(公司2)。第二个表</em><strong class="lb iu"><em class="lv">RC _ users</em></strong><em class="lv">包含用户及其联系的具体公司的详细信息。我们希望了解更多关于用户扭曲我们联系率的情况。”</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pv"><img src="../Images/9eaa39bb6b7d751fdc5f802ff21e9232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fFTutFYg1cAbmPSunIFiaA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<strong class="bd ow"> rc_calls </strong>表的前几行。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/4f446d22c6154bdc4d0631deebbe7b6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jYv1vhwBnVuZbuUssuD-5w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<strong class="bd ow"> rc_users </strong>表的前几行。</p></figure><p id="ed80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">面试官:</strong> <em class="lv">“为了做到这一点，对于每家公司，我要求您返回致电客服最多的前2名用户。你应该输出</em><strong class="lb iu"><em class="lv">company _ id</em></strong><em class="lv">，</em><strong class="lb iu"><em class="lv">user _ id</em></strong><em class="lv">，以及用户的排名。如果有多个用户具有相同的等级，则保留所有用户。</em></p><p id="c3fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预期输出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pw"><img src="../Images/cdacd2a44a8b8789a647b2ebdd3407df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iu0IzWf4gSofsX6VrJLMJw.png"/></div></div></figure><h2 id="144f" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">解决方案:</h2><p id="c092" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">请注意，请求是按公司返回前2名(组)<em class="lv">“有问题的”</em>客户。但是，具有相同排名的客户(只要是<code class="fe pa pb pc pd b">≤ 2</code>)都应该显示出来，这意味着如果出现多个并列的情况，最终的解决方案可能包括4行以上。</p><p id="9abc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此简单地在查询末尾使用<code class="fe pa pb pc pd b">LIMIT 4</code>，将会导致错误的答案。取而代之的是，我使用了<code class="fe pa pb pc pd b">DENSE_RAN()</code>将相同的等级分配给具有相同呼叫次数的所有客户，而没有在等级值之间引入差距。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h2 id="b692" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">问题5 — ROW_NUMBER()函数|难度:简单</h2><p id="58a4" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><strong class="lb iu">面试官:</strong> <em class="lv">“表</em><strong class="lb iu"><em class="lv">email _ logs</em></strong><em class="lv">以字段</em> <strong class="lb iu"> <em class="lv"> id </em> </strong> <em class="lv">为主键，</em> <strong class="lb iu"> <em class="lv"> </em> </strong> <em class="lv">包含了我们电子邮件服务用户的活动信息。”</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/cf3dac37516b4b1ca6293b04472b4743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aA6_01o5juZ5fkqFXt1fng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<strong class="bd ow"> email_logs </strong>表的前几行。</p></figure><p id="49a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">采访者: <em class="lv">“我问你的是生成和每个用户的电子邮件活动排名，其中电子邮件活动我的意思是发送的电子邮件数量。发送电子邮件数量最多的用户将被排在第一位(rank = 1)，以此类推。</em></p><p id="6225" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">你应该输出用户字符串id，电子邮件总数和他们的活动排名。请</em> <strong class="lb iu"> <em class="lv">分配唯一的排名，即使多个用户拥有相同数量的电子邮件</em> </strong> <em class="lv">。按电子邮件总数降序和按用户字母顺序排列记录。”</em></p><p id="8d23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预期输出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/e6fb1f395b40287747471aac599bf8c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vn9JYInSFTklfvoeLi5Igg.png"/></div></div></figure><h2 id="c0a9" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">解决方案:</h2><p id="39a2" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">当要求您生成一个具有唯一值或包含特定行数的排名时，您应该使用<code class="fe pa pb pc pd b">ROW_NUMBER()</code>函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h2 id="07f5" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">问题#6 — ROW_NUMBER()函数|难度:难</h2><p id="6958" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><strong class="lb iu">面试官:</strong> <em class="lv">“在最后这个练习中，你将使用</em> <strong class="lb iu"> <em class="lv">被提名人_电影记录</em> </strong> <em class="lv">表格。这是一份演员名单(</em> <strong class="lb iu"> <em class="lv">姓名</em> </strong> <em class="lv">)和他们参与过的电影以及他们演技的</em><strong class="lb iu"><em class="lv"/></strong><em class="lv">)。在提供解决方案时，请记住名称可能会出现多次，而电影</em> <strong class="lb iu"> <em class="lv"> id </em> </strong> <em class="lv">字段是唯一的。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi py"><img src="../Images/6bb9f683fb80aa39f0abf9d7052ed1e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2igvKt294Jtxi3t5E_0qtA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ow">提名_从影记录</strong>表的前几行</p></figure><p id="d24b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">面试官:</strong> <em class="lv">“你应该从第二部最新电影开始计算评分，并计算每一位演员和他们出演的电影的平均终身评分</em> <em class="lv">。输出演员列表、他们在第二部最新电影中的评分、平均终身评分以及两个评分之间的差异(倒数第二平均)。”</em></p><p id="cca7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预期输出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/08914d5a9b2819a1a519c6c9830d8619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WfPc7DkvssWJJjL6dNKc8w.png"/></div></div></figure><h2 id="dad5" class="oj me it bd mf ok ol dn mj om on dp mn li oo op mp lm oq or mr lq os ot mt ou bi translated">解决方案:</h2><p id="a58c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">请注意，我是如何使用第一个CTE按演员计算排名的，按电影ID排序(<em class="lv">对应每个演员</em> <em class="lv">)，最低的ID对应最近的电影</em>)，使用第二个CTE计算演员的平均终身评分。然后，我使用最外部的查询来计算倒数第二部电影评分和平均终身评分之间的评分差异:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h1 id="2a79" class="md me it bd mf mg pz mi mj mk qa mm mn jz qb ka mp kc qc kd mr kf qd kg mt mu bi translated">结论</h1><p id="0f1c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在这篇关于SQL编码面试的第一篇文章中，我与你分享了6个来自真实面试的关于排名的窗口函数问题。上面分享的问题是<a class="ae ky" href="https://platform.stratascratch.com/coding?via=antonello" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">StataScratch</strong></a><strong class="lb iu"/>的财产，他们好心地授权我使用他们的一些材料来写这篇教程。如果你喜欢这篇文章的风格，我会建议你去看看他们的网站<strong class="lb iu"/><a class="ae ky" href="https://platform.stratascratch.com/coding?via=antonello" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a>，在那里你会发现数百个类似的挑战。</p><p id="6714" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">给我的读者的一个提示</strong> : <em class="lv">这篇文章包括附属链接，如果你购买的话，我可以给你一点佣金，不需要额外的费用。</em></p><h1 id="d0bd" class="md me it bd mf mg pz mi mj mk qa mm mn jz qb ka mp kc qc kd mr kf qd kg mt mu bi translated">你可能也喜欢</h1><div class="qe qf gp gr qg nu"><a rel="noopener follow" target="_blank" href="/8-popular-sql-window-functions-replicated-in-python-e17e6b34d5d7"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">Python中复制的8个流行的SQL窗口函数</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">关于如何利用业务分析中的Pandas高效复制最常用的SQL窗口的教程…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">towardsdatascience.com</p></div></div><div class="od l"><div class="qh l of og oh od oi ks nu"/></div></div></a></div><div class="qe qf gp gr qg nu"><a rel="noopener follow" target="_blank" href="/15-git-commands-you-should-learn-before-your-very-first-project-f8eebb8dc6e9"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">在你开始第一个项目之前，要掌握15个Git命令</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">您需要掌握的最后一个Git教程是命令行版本控制。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">towardsdatascience.com</p></div></div><div class="od l"><div class="qi l of og oh od oi ks nu"/></div></div></a></div><div class="qe qf gp gr qg nu"><a rel="noopener follow" target="_blank" href="/10-algorithms-to-solve-before-your-python-coding-interview-feb74fb9bc27"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">Python编码面试前要解决的10个算法</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">在这篇文章中，我介绍并分享了FAANG中经常出现的一些基本算法的解决方案</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">towardsdatascience.com</p></div></div><div class="od l"><div class="qj l of og oh od oi ks nu"/></div></div></a></div></div></div>    
</body>
</html>