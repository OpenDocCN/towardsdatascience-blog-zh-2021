<html>
<head>
<title>How to algorithmically generate an image dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过算法生成图像数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/algorithmically-generated-image-dataset-71aee957563a?source=collection_archive---------7-----------------------#2021-09-03">https://towardsdatascience.com/algorithmically-generated-image-dataset-71aee957563a?source=collection_archive---------7-----------------------#2021-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3272" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为机器学习创建您自己的图像数据集</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/8367bca66733bfe02f3f00388265b340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*KKms2c9oIX6YRT1EnR6Ing.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">生成图像的示例。(沙漠背景)作者<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=342429&amp;picture=autopista-de-arizona" rel="noopener ugc nofollow" target="_blank">林奈·马利特</a> |(乡村背景)作者<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=200702&amp;picture=casa-de-campo" rel="noopener ugc nofollow" target="_blank">道恩·哈德森</a> |(森林背景)作者<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=167694&amp;picture=bosque-de-la-pintura-al-oleo" rel="noopener ugc nofollow" target="_blank">乔治·霍丹</a> |(冰川背景)作者<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=282737&amp;picture=lago-glaciar-jokulsarlon" rel="noopener ugc nofollow" target="_blank">艾德·罗杰斯</a> |(人物和物体)作者<a class="ae ku" href="https://craftpix.net/" rel="noopener ugc nofollow" target="_blank">craftpix.net</a></p></figure><p id="6df0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这篇文章的灵感来自最近发布的NFT艺术收藏，如Cryptopunks、Sollamas、ON1 Force或Bored Ape Yacht Club。在所有这些项目中，有一些项目的图像是由艺术家创作的，而另一些项目的图像是通过算法生成的。正如我们在数据科学博客中一样，我们创建图片集的有趣方式是第二种。</p><p id="ac6c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在这篇文章中，我们将使用Python创建一个随机图像的集合，这些图像之间有许多共同的特征。我们将从一些基础图像开始，我们将在其上添加元素，以配置将形成集合的最终图像。在这种情况下，我们将使用一个背景，我们将在其上放置不同类型的字符，我们将在其上添加一个对象。</p><p id="acf8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">最后，我们将有一个图像数据集，其中每个图像都有特定的属性。例如，一个带着油炸圈饼的沙漠海盗，或者一个带着钥匙的森林怪物。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/f7f70e5e94ebd7d3e3c3ae4128bc455f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FuBYpYi7QSTkXXVmjsep7A.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">一个在森林里带着锚的海盗。(森林背景)作者<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=167694&amp;picture=bosque-de-la-pintura-al-oleo" rel="noopener ugc nofollow" target="_blank">乔治·霍丹</a> |(海盗兼主播)作者<a class="ae ku" href="https://craftpix.net/" rel="noopener ugc nofollow" target="_blank">craftpix.net</a></p></figure><p id="d1c5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">由于目标不是创建艺术，我将把免费分发的像素艺术作为基础。我将使用这些图像作为基础来生成数百个衍生图像。作为一个有趣的练习，你可以选择一些不同的图像，创建自己完全不同的数据集。</p><p id="3b9f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我将使用三种类型的属性:背景、人物和物体。对于它们中的每一个，我将设置一个百分比形式的概率分布来定义每个特征的常见程度。您可以随意使用这些参数来创建不同种类的数据集。例如，一个数据集，其中99%的图像使用一种特征，1%的图像使用另一种特征。通过做这类实验，并在此基础上建立预测模型，你可以学到很多东西。</p><h2 id="d8b1" class="lw lx it bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">属性的概率分布</h2><p id="ca4f" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">为了生成文章的数据集，我将使用以下属性分布:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mu"><img src="../Images/a7c3c5e2245d4ce54af99bc08bea5da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03M7KcQWIYmWDqeQffwDMQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><h1 id="e3e7" class="mv lx it bd ly mw mx my mb mz na nb me jz nc ka mh kc nd kd mk kf ne kg mn nf bi translated">让我们开始工作吧</h1><p id="dfdb" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">第一步是找到将被用作基础的图像。利用各种各样的网站，我选择了一些图片作为基础。选择这些图像的主要标准是它们可以根据它们的许可进行修改和免费分发。您可以下载这个<a class="ae ku" href="https://github.com/albertsl/image-dataset-generator" rel="noopener ugc nofollow" target="_blank">存储库</a>中使用的所有图像。</p><p id="648e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一旦图像被选中，我们就可以开始编程算法图像生成器。为了生成图像，我将使用Python和Pillow库。这是生成图像的基本脚本:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="5115" class="lw lx it nh b gy nl nm l nn no">from os import path, mkdir</span><span id="e6cf" class="lw lx it nh b gy np nm l nn no">from PIL import Image</span><span id="ace7" class="lw lx it nh b gy np nm l nn no">output_folder = "generated"</span><span id="ccd5" class="lw lx it nh b gy np nm l nn no">if not path.exists(output_folder):</span><span id="9e4b" class="lw lx it nh b gy np nm l nn no">mkdir(output_folder)</span><span id="0eaf" class="lw lx it nh b gy np nm l nn no">background_file = path.join("backgrounds", "forest.png")</span><span id="acc2" class="lw lx it nh b gy np nm l nn no">background_image = Image.open(background_file)</span><span id="1c59" class="lw lx it nh b gy np nm l nn no">output_file = path.join(output_folder, "generated1.png")</span><span id="e119" class="lw lx it nh b gy np nm l nn no">background_image.save(output_file)</span></pre><p id="490b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">首先生成“generated”文件夹来保存生成的文件。如果文件夹已经存在，我们什么也不做。我们加载一个背景，并将其保存在“生成”文件夹中。我们已经完成了第一次图像操作！现在只需要在上面添加更多的元素，直到生成最终的图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/4dbbaf57e67345ae93e189d2db2d476a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJFXQBuzyZ6RWgD6pCebXA.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">例子背景(乡村背景)由<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=200702&amp;picture=casa-de-campo" rel="noopener ugc nofollow" target="_blank">道恩·哈德森</a></p></figure><p id="3717" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们会给背景固定的尺寸，这样所有生成的图像都有相同的尺寸。为了简化工作，我把最大的背景图片缩放到和最小的一样大。我没有缩放字符，因为这个项目的目标是功能，而不是漂亮。我缩放了一些对象，因为它们明显比其他的要大，并且它们在图像之外。</p><p id="00cf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">所使用的背景图像在缩放后具有1920x1078 px的尺寸。</p><p id="11dc" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对字符和对象所做的唯一变换是消除边距，因为每幅图像的每一边都有不同的边距。这使得即使将它们放在相同的位置，其中一些也会比其他的更高或更靠右。</p><p id="9e50" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">当在背景上添加人物和物体时，工作变得有点复杂。现在我们必须定义我们想要放置字符的位置以及它们应该有多大。为了定义位置，我们有几个选项:</p><p id="b787" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">-为所有图像定义固定位置<br/> -为每种类型的人物/每种类型的风景定义固定位置<br/> -随机化位置。如果我们选择后者，我们应该定义一些我们不希望图像出现的限制，我们不希望图像被放在边界上，只有一小部分被看到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/87a44e68a5555afe0d0b81904fc060fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHzZ6-PUiXkEFK84Mm_VDw.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">角色走了边。(森林背景)由<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=167694&amp;picture=bosque-de-la-pintura-al-oleo" rel="noopener ugc nofollow" target="_blank">乔治·霍丹</a> |(怪物和箱子)由<a class="ae ku" href="https://craftpix.net/" rel="noopener ugc nofollow" target="_blank">craftpix.net</a></p></figure><p id="7afb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对于物体来说也是一样，我们必须根据角色在哪里或者在背景上的预定位置来定义放置物体的位置。对于这个数据集，我决定将对象放在字符的右边。</p><p id="d76d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Pillow使用的坐标系的原点在图像的左上角。如图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi nq"><img src="../Images/3c02f01c627fc51337e2f4747be268f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R8NyR3d6o_BlWrpTSY50RQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="dafb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了简化工作，我决定将所有的角色放在背景中相同的固定位置。我将位置定义为图像底部水平居中的一个点。小矩形的尺寸，<em class="nr"> h </em>和<em class="nr"> w </em>是字符的高度和宽度。用黑色标记的点是我们必须计算的，以告诉Pillow在图像中放置字符的位置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi ns"><img src="../Images/2970f8e08b510730756936c3c7cd84e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tmc3KrhtNxEZofOlkW1v-g.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="d245" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这个点可以用下面的公式计算，其中1920是背景的宽度，我们除以2来找到中点。1000是1078的近似值，以便在角色的脚和图像的底部之间留一些空白。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/04316493c895ef7b34a848e8ce66c3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/1*ulVDt-amUvdCuAOn-i_lHw.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="a946" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了将对象放置在字符的右边，我使用了一个类似的公式，在这个例子中，我添加了一个边距<em class="nr"> m </em>，这样对象就不会碰到字符。对我来说效果很好的一个值是30 px。注意，<em class="nr"> h </em>和<em class="nr"> w </em>在这种情况下指的是角色的高度和宽度，而不是对象的高度和宽度，因为我们定位在角色的右侧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/c0af4f13e00f9526a0a2cbf5a9602b2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/1*YFVw7I_aLzame7GFOI1WFg.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi nv"><img src="../Images/11fc4103dc5260d6b9720e16036ba7a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CSlHsCJSkMSYB9jljN7zcQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="1688" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">所有这些计算转化成代码变成这样:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3b4e" class="lw lx it nh b gy nl nm l nn no">def generate_image(background, character, object, file_name):</span><span id="ed8b" class="lw lx it nh b gy np nm l nn no">  background_file = path.join("backgrounds", f"{background}.png")</span><span id="1044" class="lw lx it nh b gy np nm l nn no">  background_image = Image.open(background_file)</span><span id="d568" class="lw lx it nh b gy np nm l nn no">  #Create character</span><span id="9157" class="lw lx it nh b gy np nm l nn no">  character_file = path.join("characters", f"{character}.png")</span><span id="326d" class="lw lx it nh b gy np nm l nn no">  character_image = Image.open(character_file)</span><span id="60ca" class="lw lx it nh b gy np nm l nn no">  coordinates = (int(1920/2-character_image.width/2), int(1000-character_image.height)) #x, y</span><span id="887e" class="lw lx it nh b gy np nm l nn no">  background_image.paste(character_image, coordinates, mask=character_image)</span><span id="91a8" class="lw lx it nh b gy np nm l nn no">  #Create object</span><span id="8574" class="lw lx it nh b gy np nm l nn no">  if object != "none":</span><span id="6ca1" class="lw lx it nh b gy np nm l nn no">  object_file = path.join("objects", f"{object}.png")</span><span id="8171" class="lw lx it nh b gy np nm l nn no">  object_image = Image.open(object_file)</span><span id="5bfa" class="lw lx it nh b gy np nm l nn no">  coordinates = (int(1920/2+character_image.width/2+30), int(1000-object_image.height)) #x, y</span><span id="9740" class="lw lx it nh b gy np nm l nn no">  background_image.paste(object_image, coordinates, mask=object_image)</span><span id="9b2d" class="lw lx it nh b gy np nm l nn no">  output_file = path.join(output_folder, f"{file_name}.png")</span><span id="774f" class="lw lx it nh b gy np nm l nn no">  background_image.save(output_file)</span></pre><h1 id="a2b1" class="mv lx it bd ly mw mx my mb mz na nb me jz nc ka mh kc nd kd mk kf ne kg mn nf bi translated">好吧，但是…给我数据！</h1><p id="07e2" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">在我们生成图像的同时，我们还会将它们和它们的特征一起注册到数据库中。我们将使用pandas进行注册，并将数据保存在CSV文件中。</p><p id="9951" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们创建一个没有数据的DataFrame，只命名列。每当我们生成一个图像，一个新的行将被添加到数据帧。最后，一旦生成了所有图像，CSV将被保存。<em class="nr"> num </em>变量是用于命名图像的顺序计数器。例如，生成的图像将被命名为<em class="nr">生成1 </em>、<em class="nr">生成2 </em>、<em class="nr">生成2894 </em>、…。</p><p id="3068" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">保存图像文件的名称很重要，这样才能知道这些参数对应于哪个文件。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="7fa5" class="lw lx it nh b gy nl nm l nn no">df = pd.DataFrame(columns = ["background", "character", "object", "generated image"])</span><span id="2c87" class="lw lx it nh b gy np nm l nn no">for … …. ….</span><span id="8506" class="lw lx it nh b gy np nm l nn no">  #Code to generate image</span><span id="9409" class="lw lx it nh b gy np nm l nn no">  data = [background, character, object, f"generated{num}"]</span><span id="ed36" class="lw lx it nh b gy np nm l nn no">  s = pd.Series(data, index=df.columns)</span><span id="4b5b" class="lw lx it nh b gy np nm l nn no">  df = df.append(s, ignore_index=True)</span><span id="1d50" class="lw lx it nh b gy np nm l nn no">df.to_csv('data.csv', index=False)</span></pre><h2 id="f7ae" class="lw lx it bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">我会得到多少图像？</h2><p id="b20a" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">您可以用一个简单的公式计算出可能的图像总数。只需将每个类别中可能的属性数量相乘即可。在我们的例子中，4个背景* 5个字符* 11个对象= 220张图像。</p><p id="286e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了生成所有可能的图像，我们将使用这段代码。首先，我们为每个参数定义所有可能的值，然后对它们进行迭代。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="a063" class="lw lx it nh b gy nl nm l nn no">backgrounds = ["countryside", "desert", "forest", "glacial"]</span><span id="7e57" class="lw lx it nh b gy np nm l nn no">characters = ["mage", "warrior", "pirate", "monster", "toadking"]</span><span id="0579" class="lw lx it nh b gy np nm l nn no">objects = ["none", "barrel", "anchor", "axe", "bomb", "key", "chest", "bananas", "cupcake", "donut", "heart",]</span><span id="a477" class="lw lx it nh b gy np nm l nn no">def generate_all_imgs():</span><span id="b9cf" class="lw lx it nh b gy np nm l nn no">  num = 0</span><span id="0b8d" class="lw lx it nh b gy np nm l nn no">  df = pd.DataFrame(columns = ["background", "character", "object", "generated image"])</span><span id="43af" class="lw lx it nh b gy np nm l nn no">  for background in backgrounds:</span><span id="9d0d" class="lw lx it nh b gy np nm l nn no">    for character in characters:</span><span id="6eab" class="lw lx it nh b gy np nm l nn no">      for object in objects:</span><span id="0dc9" class="lw lx it nh b gy np nm l nn no">        generate_image(background, character, object, f"generated{num}")</span><span id="2bb2" class="lw lx it nh b gy np nm l nn no">        data = [background, character, object, f"generated{num}"]</span><span id="3c38" class="lw lx it nh b gy np nm l nn no">        s = pd.Series(data, index=df.columns)</span><span id="ee37" class="lw lx it nh b gy np nm l nn no">        df = df.append(s, ignore_index=True)</span><span id="20ec" class="lw lx it nh b gy np nm l nn no">        num += 1</span><span id="3d70" class="lw lx it nh b gy np nm l nn no">  df.to_csv('data.csv', index=False)</span></pre><h2 id="13bd" class="lw lx it bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">随机选择</h2><p id="69f5" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">在生成图像时，我们已经看到了如何生成所有可能的图像。在这种情况下，我们可以全部生成它们，因为它们很少，但是如果我们增加参数的数量或每个参数的可能性的数量，则可能要生成的图像的数量是巨大的。</p><p id="1513" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">使用这段代码，我们将生成给定数量(<em class="nr"> total_imgs </em>)的图像。为了决定在每个图像中使用哪些特征，我们将求助于机会。请注意，可能会多次生成相同的图像，这在最有可能的参数的情况下是常见的(最有可能的背景，最有可能的角色和最有可能的对象，在我们的情况下，它可能是一个没有对象的森林中的法师)。</p><p id="161e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们将使用上表中为每个属性定义的概率，并使用Numpy的random.choice函数来选择一个属性，同时考虑哪一个最有可能。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="8e96" class="lw lx it nh b gy nl nm l nn no">def generate_random_imgs(total_imgs):</span><span id="5428" class="lw lx it nh b gy np nm l nn no">  df = pd.DataFrame(columns = ["background", "character", "object", "generated image"])</span><span id="cc67" class="lw lx it nh b gy np nm l nn no">  for num in range(total_imgs):</span><span id="9789" class="lw lx it nh b gy np nm l nn no">    background = np.random.choice(np.arange(0,len(backgrounds)), p=[0.3, 0.3, 0.3, 0.1])</span><span id="c10c" class="lw lx it nh b gy np nm l nn no">    background = backgrounds[background]</span><span id="7601" class="lw lx it nh b gy np nm l nn no">    character = np.random.choice(np.arange(0,len(characters)), p=[0.4, 0.3, 0.2, 0.095, 0.005])</span><span id="b7c1" class="lw lx it nh b gy np nm l nn no">    character = characters[character]</span><span id="f666" class="lw lx it nh b gy np nm l nn no">    object = np.random.choice(np.arange(0,len(objects)), p=[0.3, 0.2, 0.1, 0.1, 0.1, 0.05, 0.05, 0.04, 0.03, 0.025, 0.005])</span><span id="dd80" class="lw lx it nh b gy np nm l nn no">    object = objects[object]</span><span id="84ca" class="lw lx it nh b gy np nm l nn no">    generate_image(background, character, object, f"generated{num}")</span><span id="53c9" class="lw lx it nh b gy np nm l nn no">    data = [background, character, object, f"generated{num}"]</span><span id="8add" class="lw lx it nh b gy np nm l nn no">    s = pd.Series(data, index=df.columns)</span><span id="c8bb" class="lw lx it nh b gy np nm l nn no">    df = df.append(s, ignore_index=True)</span><span id="8860" class="lw lx it nh b gy np nm l nn no">  df.to_csv('data.csv', index=False)</span></pre><p id="0ff3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">注意不要使用太高的数字，因为生成过程可能需要几个小时，创建的图像可能会占用很多GB。</p><h1 id="38e6" class="mv lx it bd ly mw mx my mb mz na nb me jz nc ka mh kc nd kd mk kf ne kg mn nf bi translated">结论</h1><p id="6c83" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">我们已经创建了一个小的基本程序来从基本图像生成合成图像的数据集。有了这个数据集，我们可以开始训练一个神经网络，根据背景的类型或根据人物的类型对图像进行分类。</p><p id="a769" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">有了这个脚本，我们就有了做更复杂事情的基础，我们可以给角色添加旋转，让他们有不同的大小，改变颜色等等…</p><p id="362b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">您可以将此数据集生成器用作数据扩充技术的测试平台，例如，您可以创建新的图像，其中角色位于另一个位置，而不是始终相同。你可以创建角色或物体旋转的图像，等等…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/06a998dc0e8d2d6cd8fb6062069c3765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-aFPVDHi_sjWioowm2EaYQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">怪物说感谢阅读！(森林背景)作者<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=167694&amp;picture=bosque-de-la-pintura-al-oleo" rel="noopener ugc nofollow" target="_blank">乔治·霍丹</a> |(怪物)作者【craftpix.net】T2</p></figure><p id="ad4b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">你可以在这个<a class="ae ku" href="https://github.com/albertsl/image-dataset-generator" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到所有的代码和原始图片。</p><p id="0ee3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">用于创建数据集的图像不是我的，它们的原始来源是:</p><ul class=""><li id="64e9" class="nw nx it kx b ky kz lb lc le ny li nz lm oa lq ob oc od oe bi translated">人物和物体:<a class="ae ku" href="https://craftpix.net/freebies/" rel="noopener ugc nofollow" target="_blank">https://craftpix.net/freebies/</a></li><li id="b2c6" class="nw nx it kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">冰川背景:<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=282737&amp;picture=lago-glaciar-jokulsarlon" rel="noopener ugc nofollow" target="_blank">https://www.publicdomainpictures.net/es/view-image.php?image = 282737&amp;picture = lago-glaciar-jokulsarlon</a></li><li id="532a" class="nw nx it kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">沙漠背景:<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=342429&amp;picture=autopista-de-arizona" rel="noopener ugc nofollow" target="_blank">https://www.publicdomainpictures.net/es/view-image.php?image=342429 &amp;图片=亚利桑那州汽车城</a></li><li id="626c" class="nw nx it kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">农村背景:<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=200702&amp;picture=casa-de-campo" rel="noopener ugc nofollow" target="_blank">https://www.publicdomainpictures.net/es/view-image.php?image = 200702&amp;picture = casa-de-Campo</a></li><li id="e8b2" class="nw nx it kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">森林背景:<a class="ae ku" href="https://www.publicdomainpictures.net/es/view-image.php?image=167694&amp;picture=bosque-de-la-pintura-al-oleo" rel="noopener ugc nofollow" target="_blank">https://www.publicdomainpictures.net/es/view-image.php?image = 167694&amp;picture = bosque-de-la-pintura-al-oleo</a></li></ul></div></div>    
</body>
</html>