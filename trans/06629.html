<html>
<head>
<title>3 Ggplot Charts that should be in Every Analyst’s Toolbox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个分析师的工具箱里都应该有3个Ggplot图表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-basic-visualisations-that-should-be-in-every-analysts-toolbox-and-how-to-enhance-them-4ecb0d251e7?source=collection_archive---------34-----------------------#2021-06-14">https://towardsdatascience.com/3-basic-visualisations-that-should-be-in-every-analysts-toolbox-and-how-to-enhance-them-4ecb0d251e7?source=collection_archive---------34-----------------------#2021-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bdbc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">充分利用ggplot2中的颜色、形状和轴来增强3个基本图表；+r中数据分析师的最佳实践。</h2></div><p id="4c09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated"><span class="l lf lg lh bm li lj lk ll lm di">作为</span>分析师，我们的工作是从我们组织拥有的数据中获得洞察力。通常这来自上面的一个<em class="ln">问题</em>和<em class="ln"> </em>我们的工作是决定用好的数据可视化(也就是图表)来回答这些问题的最佳方式。在我作为数据分析师工作一周年之际，我回顾了我收到的常见请求，以及我为回应这些请求而设计的图表。</p><p id="a12e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文接下来的内容是<em class="ln">“如何指导”</em>(1)完成分析的逻辑，以及(2)在r中构建相应的可视化。最后，我分享了在编写这些图表时的最佳实践，以提高您的代码在响应这些常见请求时的<em class="ln">寿命</em>。我希望这些对您作为数据分析师的工作有用！</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/2e4b82c643e5349ec318a082acb6c674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Zul_q7Sgvgb7a9bX"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated"><strong class="bd me">使用以下三个图表增强您的数据分析工具箱。</strong> <em class="mf">照片由</em> <a class="ae mg" href="https://unsplash.com/@shs521?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> <em class="mf">苏珊·霍尔特·辛普森</em></a><em class="mf"/><a class="ae mg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"><em class="mf">拍下</em></a></p></figure><h1 id="8c18" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">每位分析师都会被问到的3个问题:</h1><blockquote class="mz na nb"><p id="31bf" class="ki kj ln kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated"><strong class="kk iu"> 1。</strong>“随着时间的推移，X组之间Y的组成是如何变化的？”→参见<strong class="kk iu">三维图</strong></p><p id="7235" class="ki kj ln kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated"><strong class="kk iu"> 2。</strong>“有什么重大变化吗？”→参见<strong class="kk iu">复合棒+点图</strong></p><p id="77f8" class="ki kj ln kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated"><strong class="kk iu"> 3。</strong>“一段时间以来的趋势是什么？”→参见<strong class="kk iu">增强型同比图</strong></p></blockquote><div class="lp lq lr ls gt ab cb"><figure class="nf lt ng nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/b086785ef2898fe622d098cb8735971c.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*bVWE9y4coqhp_6dlyE2ZVA.png"/></div></figure><figure class="nf lt ng nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/35f11c157711d493f9f1c15064b26642.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*CyOhyRde_1UELRvHye1QfQ.png"/></div></figure><figure class="nf lt nl nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/eed02fdead4c011a6198b151b1eb8b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*S4FQ0j4vOJpnDRI7nVnDEw.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk nm di nn no translated">每个分析请求的相应可视化。下面我们将通过一步一步的指导来制作这些图表！</p></figure></div><h2 id="914e" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated">在开始之前</h2><ul class=""><li id="39f0" class="ob oc it kk b kl od ko oe kr of kv og kz oh ld oi oj ok ol bi translated">虚拟数据用于以下示例，<strong class="kk iu">，即所有数据都是虚构的</strong>，任何与现实的相似之处纯属巧合。</li><li id="db62" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld oi oj ok ol bi translated">R中的<code class="fe or os ot ou b">tidyverse</code>包带有方便的管道操作符<code class="fe or os ot ou b">(%&gt;%)</code>，这使得数据准备快速，代码简洁。因此，对于下面的图表，我们将需要这两个包:</li></ul><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="fd01" class="np mi it ou b gy oz pa l pb pc">## import packages in R<br/>library(ggplot2)<br/>library(tidyverse) # for data preparation</span></pre><h1 id="558b" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated"><strong class="ak"> <em class="mf">分析1:用簇状堆积条形图展示3个维度</em> </strong></h1><p id="4217" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">考虑以下场景</p><ul class=""><li id="8a18" class="ob oc it kk b kl km ko kp kr pg kv ph kz pi ld oi oj ok ol bi translated">有两个区域:A和B</li><li id="c47c" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld oi oj ok ol bi translated">每个地区有3类植物:草、花和树</li><li id="c0b6" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld oi oj ok ol bi translated">每个季度都会测量植物群的数量:从2018年Q1到2020年第四季度</li></ul><p id="5d4e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有三个维度，<code class="fe or os ot ou b">region</code>、<code class="fe or os ot ou b">category</code>和<code class="fe or os ot ou b">time</code>。我们可以使用堆积条形图的聚类来可视化每个维度的趋势。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pj"><img src="../Images/0c3e241fa6ba42a1b2bcaaf3686bc21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVWE9y4coqhp_6dlyE2ZVA.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">三维图表</p></figure><h2 id="22ee" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated">步骤1:数据准备—透视数据集</h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pk"><img src="../Images/d9cad05c9d4a542f7a2b3d2c633642c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XKNrH8b7Wl47slxZWHWasQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated"><strong class="bd me">数据集</strong>:虚拟数据</p></figure><p id="8259" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您的数据可能看起来像左边的表dummy_data。<code class="fe or os ot ou b">dummy_data</code>还没有准备好输入到ggplot代码中，我们首先必须首先使“区域”成为数据集中的一列，而不是A和B分开。这在R中用<code class="fe or os ot ou b">gather</code>函数很容易做到。</p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="fe05" class="np mi it ou b gy oz pa l pb pc">dummy_data_long &lt;- gather(dummy_data, # existing dataset<br/>                          `Region`, # give a name for the keys<br/>                          count, # give a name for the values<br/>                          A:B, # columns to get the keys<br/>                          factor_key = TRUE) # store keys as factors</span><span id="9768" class="np mi it ou b gy pl pa l pb pc">## add a 'total' column, will be used for label on top of bars<br/>dummy_data_long_w_total &lt;- dummy_data_long %&gt;% <br/>  group_by(quarter, Region) %&gt;%<br/>  mutate(Total = sum(count))</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pk"><img src="../Images/95e96169c69faf859b129ae18626ea15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QayggRAhVFTklX9AHlW7fQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated"><strong class="bd me">数据集:</strong>虚拟_数据_长_宽_总</p></figure><h2 id="e0cd" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated">步骤2:创建堆积条形图——比较每个区域的类别</h2><p id="a299" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">使用<code class="fe or os ot ou b">geom_bar</code>创建ggplot中的条形图。只需在<code class="fe or os ot ou b">geom_bar()</code>中指定<code class="fe or os ot ou b">position = 'stack'</code>即可启用堆叠功能。</p><p id="f6d7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，通过使用<code class="fe or os ot ou b">aes</code>中的<code class="fe or os ot ou b">fill</code>参数，ggplot知道根据<code class="fe or os ot ou b">category</code>字段给条形图加阴影。因为我们已经指定了<code class="fe or os ot ou b">position = stack</code>，每个<code class="fe or os ot ou b">category</code>的条将被堆叠而不是并排放置。</p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="a011" class="np mi it ou b gy oz pa l pb pc"># geom_bar() for bar charts</span><span id="a592" class="np mi it ou b gy pl pa l pb pc">stacked_bar &lt;- geom_bar(data = dummy_data_long_w_total,<br/>                        aes(y = count, x = `Region`, <br/>                            fill = factor(category,<br/>                             levels = c('Grass','Trees','Flowers')) <br/>                        ),<br/>                        stat='identity',<br/>                        position = 'stack') # STACKING DONE HERE</span><span id="868d" class="np mi it ou b gy pl pa l pb pc">fill_colours_category &lt;- scale_fill_manual(values = <br/>                      c('Trees' = "#ed7d31", # excel orange <br/>                      'Flowers' = "#4472c4", # excel blue<br/>                      'Grass' = "#a5a5a5")) # excel grey</span></pre><h2 id="3d83" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated"><strong class="ak">第三步:对堆积条形图进行聚类</strong></h2><p id="21c4" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">ggplot允许我们将各种<code class="fe or os ot ou b">geom</code>组件“添加”在一起，因此为了创建最终的图表，我们可以将上面创建的<code class="fe or os ot ou b">stacked_bar</code>添加到其他格式行，这就是我们将如何实现聚类效果。</p><p id="7103" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面代码中的函数<code class="fe or os ot ou b">facet_grid()</code>告诉绘图为我们的时间变量<code class="fe or os ot ou b">quarter</code>创建一个堆积条形图。</p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="01a6" class="np mi it ou b gy oz pa l pb pc">ggplot() +<br/>  stacked_bar + <br/>  fill_colours_category +<br/>  facet_grid(~quarter) +  # CLUSTERING DONE HERE<br/>  scale_y_continuous(breaks = seq(0,15000, by=2500),<br/>                     limits = c(0,15000),<br/>                     expand = c(0,0)) +<br/>  labs(y = 'Area of Nature',<br/>       x = 'Region',<br/>       title = 'Breakdown of Nature between <br/>                Regions A and B over Time',<br/>       fill = 'Type of Nature' )+<br/>  bar_total_labels + ## see below for this code <br/>  chart_1_theme ## a theme() ob</span></pre><p id="048c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只要你有一个<code class="fe or os ot ou b">variable_to_cluster_by</code>，通过用你的图表替换<code class="fe or os ot ou b">stacked_bar</code>并在末尾添加<code class="fe or os ot ou b">facet_grid()</code>，你可以很容易地用任何其他图表(如折线图)复制这种聚类效果。</p><p id="5502" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ln">【额外】我还在剧情末尾加了一个</em> <code class="fe or os ot ou b"><em class="ln">bar_total_labels</em></code> <em class="ln">和</em> <code class="fe or os ot ou b"><em class="ln">chart_1_theme</em></code> <em class="ln">，格式化了剧情的审美。</em> <code class="fe or os ot ou b"><em class="ln">bar_total_labels</em></code> <em class="ln">是一个</em> <code class="fe or os ot ou b"><em class="ln">geom_text</em></code> <em class="ln">对象，而</em> <code class="fe or os ot ou b"><em class="ln">chart_1_theme</em></code> <em class="ln">是一个</em> <code class="fe or os ot ou b"><a class="ae mg" href="https://ggplot2.tidyverse.org/reference/theme.html" rel="noopener ugc nofollow" target="_blank"><em class="ln">theme</em></a></code> <em class="ln">对象，你可以自定义(如果你想复制上面的主题，见代码结束)。</em></p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="3e58" class="np mi it ou b gy oz pa l pb pc"><em class="ln"># the labels in the chart<br/>bar_total_labels &lt;- geom_text(data = dummy_data_long_w_total,<br/> aes(label = ceiling(Total),<br/> y = Total, x = `Region`,<br/> fontface = 2),<br/> size = 4,<br/> vjust = -0.5)</em></span></pre><blockquote class="mz na nb"><p id="dd17" class="ki kj ln kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated"><strong class="kk iu"><em class="it">TLDR；绘制三维图表<br/>-</em>-</strong>-<em class="it">R的</em>-<code class="fe or os ot ou b"><em class="it">gather</em></code>-<em class="it">函数对数据准备很有用<br/> -使用</em>-<code class="fe or os ot ou b"><em class="it">facet_grid</em></code>-<em class="it">为您的图表添加第三维</em></p></blockquote><h1 id="9516" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">分析2:混合不同的几何图形来标记随时间的显著变化</h1><p id="3b63" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">考虑以下场景:</p><ul class=""><li id="5e41" class="ob oc it kk b kl km ko kp kr pg kv ph kz pi ld oi oj ok ol bi translated">你的公司销售一些产品，电话，电视，笔记本电脑等。每周都会收集售出的数量。</li><li id="ed36" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld oi oj ok ol bi translated">您想要确定最近一周每种产品的销售量是否有显著变化。</li></ul><p id="cfc4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个<em class="ln">全面的数据可视化</em>将解决以下3个问题<br/> (1)当前的销售量是多少<br/> (2)以前销售量的基准<br/> (3)是否有重大变化。</p><p id="55c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面的图表用<strong class="kk iu">颜色和几何图形</strong>来解决这些问题。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pj"><img src="../Images/5d8d3092e01ffab23f3f634125c8f107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CyOhyRde_1UELRvHye1QfQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">利用点和棒线来充分利用一个图表。</p></figure><h2 id="f791" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated">步骤1:数据准备—标出重大变更</h2><p id="874a" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">你如何定义“重大”实际上取决于你自己的经营环境，没有正确的答案。对于这个例子，我认为显著是指一年中与<code class="fe or os ot ou b">weekly average</code>的偏差超过2 <code class="fe or os ot ou b">standard deviations (sd)</code>，以使每周的交易量波动均匀。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/f7f7a545ea5c427bf0d7479bef1dde2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*s21UCe1EJwQtEDuDmUHtIg.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated"><strong class="bd me"> dummy_data_2: </strong>起始数据集。您需要首先计算这些字段。</p></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pn"><img src="../Images/38568edafe8c95acfa4b3dca4b3de9b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYnutNxd9-Tu1oK6NezpIA.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated"><strong class="bd me">dummy _ data _ 2 _ flaged:</strong>使用tidyverse轻松计算偏差。</p></figure><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="d764" class="np mi it ou b gy oz pa l pb pc">dummy_data_2_flagged &lt;- dummy_data_2 %&gt;% <br/>  mutate(<br/>Flag = case_when(<br/>Volume &gt; average+2*sd ~ 'Higher',    <br/>Volume &lt; average-2*sd ~ 'Lower',                   <br/> T                    ~ <br/>'No significant deviation'))</span></pre><p id="ae4a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<code class="fe or os ot ou b">tidyverse</code>中的<code class="fe or os ot ou b">mutate</code>和<code class="fe or os ot ou b">case_when</code>功能，轻松计算每个产品的偏差。</p><h2 id="3093" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated"><strong class="ak">第二步:用条形的颜色标出偏差</strong></h2><p id="69b0" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">与图表1类似，我们使用<code class="fe or os ot ou b">geom_bar()</code>来创建条形图。为了用变量<code class="fe or os ot ou b">Flag</code>给条着色，我们在<code class="fe or os ot ou b">aes</code>下指定了<code class="fe or os ot ou b">fill = Flag</code>。与图表1不同，我们没有指定一个<code class="fe or os ot ou b">position</code>，因此条形没有堆叠。</p><blockquote class="mz na nb"><p id="4023" class="ki kj ln kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated"><em class="it">提示:我已经设置了</em> <code class="fe or os ot ou b"><em class="it">y = reorder(Item, Volume)</em></code> <em class="it">，所以条块按照</em> <code class="fe or os ot ou b"><em class="it">Volume</em></code> <em class="it">降序排列。</em></p></blockquote><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="d833" class="np mi it ou b gy oz pa l pb pc"># standard ggplot bar chart</span><span id="ef71" class="np mi it ou b gy pl pa l pb pc">recent_volume_bars &lt;- geom_bar(aes(y = reorder(Item, Volume), <br/>                                   x = Volume,<br/>                                   fill = Flag),<br/>                               stat = 'identity',<br/>                               width = 0.7)</span><span id="31ca" class="np mi it ou b gy pl pa l pb pc"><br/>## set colours for the bars based on deviation</span><span id="e686" class="np mi it ou b gy pl pa l pb pc">flag_colours = c('Higher' = '#2c4b01',<br/>                 'Lower' = '#8b0000',<br/>                 'No significant deviation' = '#23395d')</span><span id="5639" class="np mi it ou b gy pl pa l pb pc">fill_colours_flag &lt;- scale_fill_manual(values = flag_colours)</span></pre><p id="1fb9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ln">【额外】在条形上添加标签，显示最近一周的成交量</em></p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="b1cb" class="np mi it ou b gy oz pa l pb pc"><em class="ln">label_on_bars &lt;- geom_text(aes(label = Volume,<br/>                               y = reorder(Item, Volume),<br/>                               x = Volume),<br/>                           position = position_stack(vjust=0.5),<br/>                           color = 'white', size=6)</em></span></pre><h2 id="a458" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated"><strong class="ak">第三步:用不同的几何图形表示平均周成交量</strong></h2><p id="49a1" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">使用<code class="fe or os ot ou b">geom_point</code>，我们创建一个反映平均值的点图。这给了读者一个很好的偏差比较点！</p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="ff62" class="np mi it ou b gy oz pa l pb pc">average_point &lt;- geom_point(aes(y = reorder(Item, Volume),<br/>                                x = average),<br/>                            stat = 'identity', <br/>                            size = 6, alpha = 0.7,<br/>                            fill = 'white', stroke = 1,<br/>                            shape = 21)</span></pre><h2 id="f7a2" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated"><strong class="ak">步骤4:为点添加图例</strong></h2><p id="042c" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">现在我们的图表上有多个元素，我们需要一种方法来解释图表上的点是什么意思。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi po"><img src="../Images/9885cfb0cb267ba94d87dac1f163554f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7XxCgMZuB7hES9YIFlMxIQ.png"/></div></div></figure><p id="af2e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从第2步开始，在条形美学(<code class="fe or os ot ou b">aes</code>)下指定<code class="fe or os ot ou b">fill = Flag</code>会创建一个相应的图例来解释每种颜色的含义。但是对于我的点，我实际上不希望任何点的颜色不同。因此，我没有分配一个字段<code class="fe or os ot ou b">colour</code>，这将使点的颜色因字段而异，而是将我想要显示的文本作为图例标题。因此，在步骤3的<code class="fe or os ot ou b">aes</code>下添加<code class="fe or os ot ou b">colour = “Average weekly volume over past year"</code>会产生以下图例:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pp"><img src="../Images/b873e9f20c1634b16502bf3bbc9716c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QlWnuXgVYjlw323G_93hPg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图表显示了geom_point的图例，以向读者表明该点与条形有何不同。即使任何轴上的点都没有区别，也是如此。</p></figure><p id="4982" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于我们将<code class="fe or os ot ou b">colour</code>参数用于此“非预期”目的，因此需要进行几次“清理”:</p><ul class=""><li id="e40d" class="ob oc it kk b kl km ko kp kr pg kv ph kz pi ld oi oj ok ol bi translated">使用<code class="fe or os ot ou b">scale_colour_manual(values = c(‘black’))</code>为圆指定所需的颜色</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pq"><img src="../Images/26509daedf757a38fbd4ca7b00d3cd86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqSBV0-lGVoVtvUOtmna7Q.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">在labs下指定colour = NULL，以避免显示单词colour</p></figure><ul class=""><li id="27d6" class="ob oc it kk b kl km ko kp kr pg kv ph kz pi ld oi oj ok ol bi translated">在最终图表中的<code class="fe or os ot ou b">labs()</code>下指定<code class="fe or os ot ou b">colour = NULL</code>，这样“颜色”一词就不会显示出来。</li></ul><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="805d" class="np mi it ou b gy oz pa l pb pc"># Add all the elements together <br/>ggplot(dummy_data_2_flagged)+<br/>  recent_volume_bars +<br/>  fill_colours_flag +<br/>  label_on_bars + <br/>  average_point + <br/>  scale_colour_manual(values = c('black'))+<br/>  theme_deviation_chart +             # define theme() as you like <br/>  labs(title = paste('Volume sold in past week'),<br/>       fill = "Deviation in recent week:",<br/>       colour= NULL) </span></pre><p id="801d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="ln">【给感兴趣的读者】</em> </strong> <em class="ln">你可能会奇怪为什么专门要用</em> <code class="fe or os ot ou b"><em class="ln">colour</em></code> <em class="ln">而不是其他的美学比如</em><code class="fe or os ot ou b"><em class="ln">fill</em></code><em class="ln"/><code class="fe or os ot ou b"><em class="ln">size</em></code><em class="ln"/><code class="fe or os ot ou b"><em class="ln">shape</em></code><em class="ln"/><code class="fe or os ot ou b"><em class="ln">alpha</em></code><em class="ln">等等。</em></p><p id="9f3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ln">我们可以用</em> <code class="fe or os ot ou b"><em class="ln">fill</em></code> <em class="ln">审美代替</em> <code class="fe or os ot ou b"><em class="ln">colour</em></code> <em class="ln">，指定</em> <code class="fe or os ot ou b"><em class="ln">scale_fill_manual(values = c('white')</em></code> <em class="ln">。然而</em> <code class="fe or os ot ou b"><em class="ln">fill</em></code> <em class="ln">已经在我们的酒吧中使用，表示会干扰“清理”的偏差。我已经尝试使用</em> <code class="fe or os ot ou b"><em class="ln">shape</em></code> <em class="ln">和</em> <code class="fe or os ot ou b"><em class="ln">size</em></code> <em class="ln">但无法成功“清理”，很想听听是否有人对此有解决方案！</em></p><blockquote class="mz na nb"><p id="8004" class="ki kj ln kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated"><strong class="kk iu"><em class="it">TLDR；复合条形图和点数图<br/></em></strong><em class="it">-</em><strong class="kk iu"><em class="it"/></strong><em class="it">利用ggplot中的不同元素用一个图表讲述更多内容<br/> -通过使用几何图形的美感在ggplot中添加几何图形的图例。</em></p></blockquote><h1 id="b95e" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">分析三:增强同比图</h1><p id="e0d6" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">同比图表是任何分析师工具箱中的主要工具，因为它能够反映最近的趋势和季节性。在ggplot中，基本的同比图表非常直观。通过在geom_line中指定一个“组”变量，我们立即得到下面的图。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pj"><img src="../Images/4d0638d2aa57203ab23a62f0c2a52e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ez_jCoMjnQ2eeIcynWfoog.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">ggplot中的基本同比图…可以改进</p></figure><p id="2945" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是通过一点点处理和ggplot的元素，我们可以通过:<br/> (1)将日期周期添加到x轴和</p><p id="ae74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(2)遮蔽感兴趣的时间段。</p><h2 id="e865" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated">步骤1:数据准备-格式化2021年每周的日期范围</h2><p id="3ecf" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">一年中的星期并不是最直观的，所以添加2021年每周的日期范围将让读者更好地了解一段时间内的趋势。为此，我们将在R中创建一个dataframe，将2021年的每周映射到一个日期范围。在本例中，一周从星期六开始，到星期五结束。</p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="bcae" class="np mi it ou b gy oz pa l pb pc"># create a column for each date in 2021 <br/>dates2021 &lt;- as.data.frame(x=seq(as.Date("2021-01-01"), as.Date("2021-12-31"), by="days"))<br/>colnames(dates2021) &lt;- 'Date'</span><span id="120c" class="np mi it ou b gy pl pa l pb pc">first_sat_2021 &lt;- as.Date('2021-01-02') # date to start year</span><span id="a051" class="np mi it ou b gy pl pa l pb pc"># Match each date to a week of 2021 (1 - 52) <br/>weeks_2021 &lt;- dates2021 %&gt;% <br/>  mutate(Week = floor(as.numeric(difftime(Date, first_sat_2021, units = "weeks")))+1,<br/>         Year = 2021) %&gt;%<br/>  filter(Week &gt; 0)</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pr"><img src="../Images/03e69964627e8fe34e52e97cc0f623bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SnRHtSbMVRqkh39rcV-czA.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">周_周期_2021</p></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ps"><img src="../Images/79131200b53d909f38041a2a5934c7f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfwlZNluCGgVS83tJVqWKg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">重复上面的代码，为2020年做同样的事情</p></figure><p id="0ba9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将每个日期与一周匹配后，使用<code class="fe or os ot ou b">group_by</code>功能为一年中的每一周格式化一个<strong class="kk iu">日期范围</strong>。</p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="a9d3" class="np mi it ou b gy oz pa l pb pc">week_periods_2021 &lt;- weeks_2021 %&gt;% <br/>  group_by(Week) %&gt;% <br/>  summarise(<br/>week_start_date = first(Date),<br/>week_end_date = last(Date)) %&gt;% <br/>  mutate(<br/>week_period = paste(<br/>format(as.Date(<br/>week_start_date),"%d %b"),<br/>                                                   format(as.Date(week_end_date), "%d %b"),                      <br/>sep = " - "),<br/>                        Year = 2021)</span></pre><h2 id="f46a" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated">步骤2:数据准备——获取每周的数量</h2><p id="85e7" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">假设你有每天<em class="ln">卖出的产品数量</em>，我们可以使用R的<code class="fe or os ot ou b">group_by</code>和<code class="fe or os ot ou b">summarise</code>很容易地得到每周卖出的<em class="ln">数量。</em></p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="5db3" class="np mi it ou b gy oz pa l pb pc"># Dataset with 2 cols: Date &amp; Volume<br/>dummy_data_vol &lt;- read_csv('&lt;YOUR DATASET&gt;') %&gt;%<br/>  mutate(Date = as.Date(Date, format="%d/%m/%Y")) </span><span id="814c" class="np mi it ou b gy pl pa l pb pc"># Date to week mapping <br/>weeks_2020_2021 &lt;- rbind(weeks_2020, weeks_2021)</span><span id="07ed" class="np mi it ou b gy pl pa l pb pc"># Join the date to week mapping to your raw data, and calculate volume each week<br/>volume_each_week &lt;- dummy_data_vol %&gt;%<br/>  right_join(weeks_2020_2021, by = "Date") %&gt;% <br/>  group_by(Year, Week) %&gt;% <br/>  summarise(volume = sum(Volume)) %&gt;% <br/>  ungroup() %&gt;%<br/>  mutate(Year = as.factor(Year))</span></pre><p id="189b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的代码将给出前3列。将此与步骤1中格式化的日期范围连接，以添加第4列。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/4325ef13cfb2a2af982a08afebd2ffd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*4MMccIARDbMCd4VkDi01NQ.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">data frame:volume _ each _ week _ dates，用于绘图</p></figure><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="2d0e" class="np mi it ou b gy oz pa l pb pc"># Add the 2021 date ranges to each week <br/>volume_each_week_dates &lt;- volume_each_week %&gt;% <br/>  left_join(week_periods_2021) %&gt;% <br/>  mutate(week_period = as.Date(week_period))</span></pre><h2 id="8abd" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated"><strong class="ak">步骤3:使用分组变量为每年绘制一条线</strong></h2><p id="0ae0" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">如上所述，使用<code class="fe or os ot ou b">geom_line()</code>中的<code class="fe or os ot ou b">group</code>变量来指定你想要绘制多行的字段。对于同比地块，此字段将为<code class="fe or os ot ou b">Year</code>。此外，<code class="fe or os ot ou b">colour = Year</code>被指定为不同的线条颜色。你也可以指定<code class="fe or os ot ou b">linetype = Year</code>来区分线条的形状(如虚线、点线、粗体)。</p><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="48c6" class="np mi it ou b gy oz pa l pb pc">y_min = 40000<br/>y_max = 80000</span><span id="af58" class="np mi it ou b gy pl pa l pb pc">basic_plot &lt;- ggplot(volume_each_week_dates)+<br/>  geom_line(aes(x = Week, y = volume,<br/>                group = Year, colour = Year)) +<br/>  scale_color_manual(values = c('2020' = "#95C8D8",<br/>                                '2021' = "salmon4"))+<br/>  labs(title = paste('Total Weekly Volume'),<br/>       y = 'Weekly Volume',<br/>       x = '2021 Weeks')+<br/>  ylim(y_min, y_max) + <br/>  scale_x_continuous(breaks = volume_each_week_dates$Week,<br/>                     labels = volume_each_week_dates$week_period,<br/>                     guide = guide_axis(check.overlap=TRUE))+<br/>  theme_trend_chart</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pj"><img src="../Images/64f3a7491d924004fe12f70e4f9e25d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H-Uq0JW5FXvdhSwUi_xzjQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">带日期范围的同比图</p></figure><p id="5704" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe or os ot ou b">scale_x_continuous</code>下，指定在步骤1到<code class="fe or os ot ou b">labels</code>中创建的日期范围，我们在左边得到相应的x轴。日期比第1- 52周更能让读者更直观地理解情节！</p><h2 id="719e" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated"><strong class="ak">步骤4:在图表中突出显示感兴趣的时间段</strong></h2><p id="2403" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">最后，为了增强基本线图，我们可以在ggplot中添加一个阴影矩形和相应的标签，以反映有趣的时间段，从而吸引读者的注意。用ggplot的附加结构也很容易做到这一点。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pj"><img src="../Images/7cb18ba80b2b14bced0eda766423a3f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4V7u2uELXH_-nBs7lMFQg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">增强型同比图表</p></figure><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="7c50" class="np mi it ou b gy oz pa l pb pc">## use dataset in step 1 to find the weeks of interest interesting_period_start = 13<br/>interesting_period_end = 18</span><span id="2bd4" class="np mi it ou b gy pl pa l pb pc">## shaded rectangle<br/>shaded_area &lt;- geom_rect(<br/>  aes(<br/>    xmin = interesting_period_start,<br/>    xmax = interesting_period_end,<br/>    ymin = y_min,<br/>    ymax = y_max<br/>  ),<br/>  fill = 'yellow',<br/>  alpha = 0.01,<br/>  color = NA<br/>)</span><span id="52d8" class="np mi it ou b gy pl pa l pb pc">## text label<br/>shaded_area_label &lt;- annotate(geom = 'label',<br/>                 x = (interesting_period_start + interesting_period_end)/2, y = y_max, <br/>                 label = 'An interesting period in 2020',<br/>                 size = 5, angle = 0,<br/>                 fill = 'white', alpha = 0.8)</span><span id="ddd0" class="np mi it ou b gy pl pa l pb pc">## add this to the basic plot above<br/>basic_plot + shaded_area + shaded_area_label</span><span id="77d8" class="np mi it ou b gy pl pa l pb pc">## note: for bolder lines, add shaded_area before geom_line() </span></pre><blockquote class="mz na nb"><p id="8e18" class="ki kj ln kk b kl km ju kn ko kp jx kq nc ks kt ku nd kw kx ky ne la lb lc ld im bi translated"><strong class="kk iu"> <em class="it"> TLDR:增强您的同比绘图<br/> </em> </strong> <em class="it"> -在您的图表中为每个时间段创建日期范围<br/> -使用</em> <code class="fe or os ot ou b"><em class="it">geom_rect()</em></code> <em class="it"> ggplot对象添加阴影区域</em></p></blockquote></div><div class="ab cl pu pv hx pw" role="separator"><span class="px bw bk py pz qa"/><span class="px bw bk py pz qa"/><span class="px bw bk py pz"/></div><div class="im in io ip iq"><h1 id="3ef3" class="mh mi it bd mj mk qb mm mn mo qc mq mr jz qd ka mt kc qe kd mv kf qf kg mx my bi translated">增强R中的数据分析和可视化的主要收获</h1><ol class=""><li id="701d" class="ob oc it kk b kl od ko oe kr of kv og kz oh ld qg oj ok ol bi translated">使用<code class="fe or os ot ou b">facet_grid()</code>功能向图表添加第三维</li><li id="ac2e" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld qg oj ok ol bi translated">在ggplot中混合不同的几何图形，用你的可视化表达更多；并利用<code class="fe or os ot ou b">aes</code>参数为几何图形添加一个图例</li><li id="97e9" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld qg oj ok ol bi translated">对轴和标签进行一些数据预处理可以使你的可视化更具可读性</li></ol><h1 id="677b" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">超越viz —数据分析师的最佳实践</h1><p id="535c" class="pw-post-body-paragraph ki kj it kk b kl od ju kn ko oe jx kq kr pd kt ku kv pe kx ky kz pf lb lc ld im bi translated">除了创建可视化之外，我发现花一些时间来确保代码的可读性是有用和值得的。当必须重现分析时，这将保持您自己和您的团队的理智。以下是提示的非详尽列表:</p><ol class=""><li id="5bfe" class="ob oc it kk b kl km ko kp kr pg kv ph kz pi ld qg oj ok ol bi translated"><strong class="kk iu">将图表开始时的</strong> <code class="fe or os ot ou b"><strong class="kk iu">theme()</strong></code> <strong class="kk iu">定义为变量</strong>。主题指定了图表的美感，如背景、网格线和大小。在代码的开头将<code class="fe or os ot ou b">theme()</code>定义为一个变量，比如<code class="fe or os ot ou b">my_theme &lt;- theme(&lt;your input&gt;)</code>，然后将<code class="fe or os ot ou b">my_theme</code>添加到每个图表中。如果您需要进行更改，尤其是如果您在一个报表中有多个图表，这将有助于提高代码的可读性和适应性。(我的每个图表的主题在下面的附件中。)</li><li id="78e6" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld qg oj ok ol bi translated">给你的代码加注释，并适当缩进。最后一条似乎很明显，但当试图匆忙做出分析时，有时会被遗忘。但是在这种情况下，一点点就足够了，当您需要重新查看代码时，您会感谢自己的！在R中，<code class="fe or os ot ou b">#</code>用于注释代码。您可以使用至少4个标签在RStudio中创建可折叠的部分:<br/> <code class="fe or os ot ou b"># This will create a collapsable section #####</code></li><li id="2e40" class="ob oc it kk b kl om ko on kr oo kv op kz oq ld qg oj ok ol bi translated">保存图表时在文件名中添加日期。当您必须定期运行报告时，这有助于防止覆盖现有图表。如果代码在2021年6月15日运行，下面的代码将把一个名为<code class="fe or os ot ou b">your_chart</code>的ggplot对象保存到R中的<code class="fe or os ot ou b">folder_path</code>下。</li></ol><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="8d66" class="np mi it ou b gy oz pa l pb pc">today &lt;- as.character(Sys.Date(), “%y%m%d”)<br/>plot.width = 35<br/>plot.height = 15</span><span id="883a" class="np mi it ou b gy pl pa l pb pc">ggsave(filename = paste0("name_your_chart", today, ".jpeg"),<br/>       plot = your_chart, path = folder_path,<br/>       width = plot.width, height = plot.height, units = "cm")</span><span id="c5a6" class="np mi it ou b gy pl pa l pb pc">##[Extra] You can even code the date into <!-- -->folder_path<!-- --> so that a new folder is created each time you have to generate the charts! ##</span><span id="5348" class="np mi it ou b gy pl pa l pb pc">folder_path &lt;-paste0(“~/Desktop/”, today)<br/>if(!dir.exists(folder_path)){dir.create(folder_path)}</span></pre></div><div class="ab cl pu pv hx pw" role="separator"><span class="px bw bk py pz qa"/><span class="px bw bk py pz qa"/><span class="px bw bk py pz"/></div><div class="im in io ip iq"><p id="d782" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">就这些了，谢谢你的阅读和关注！我希望这些图表和概念也能在你作为数据分析师的旅程中派上用场。数据科学社区的开放和共享是我最喜欢的事情之一，所以如果你有任何建议或更好的方法来编码这些图表，请在下面留下评论。快乐分析！</p></div><div class="ab cl pu pv hx pw" role="separator"><span class="px bw bk py pz qa"/><span class="px bw bk py pz qa"/><span class="px bw bk py pz"/></div><div class="im in io ip iq"><h2 id="333a" class="np mi it bd mj nq nr dn mn ns nt dp mr kr nu nv mt kv nw nx mv kz ny nz mx oa bi translated">附件:各图表主题代码</h2><pre class="lp lq lr ls gt ov ou ow ox aw oy bi"><span id="759c" class="np mi it ou b gy oz pa l pb pc">chart_1_theme &lt;- theme(<br/>  panel.grid = element_blank(),<br/>  panel.background = element_blank(),<br/>  axis.title.y = element_text(size=12),<br/>  axis.title.x = element_text(size = 12),<br/>  legend.position = 'bottom',<br/>  legend.title = element_text(size = 12),<br/>  legend.text = element_text(size = 12),<br/>  axis.text.x = element_text(size = 12),<br/>  axis.text.y = element_text(size = 12),<br/>  strip.text.x = element_text(size = 12)<br/>)</span><span id="1c45" class="np mi it ou b gy pl pa l pb pc">theme_deviation_chart = theme(<br/>  axis.title.y = element_blank(),<br/>  plot.title=element_text(size=20),<br/>  plot.subtitle = element_text(size=16),<br/>  axis.text.y = element_text(size = 16),<br/>  legend.position = 'bottom',<br/>  legend.title=element_text(size=16),<br/>  panel.background = element_rect(fill="white", colour ="white"),<br/>  panel.grid.major = element_line(size=0.5, linetype = "solid", colour="gray90"),<br/>  legend.text = element_text(size=14)<br/>)</span><span id="a8de" class="np mi it ou b gy pl pa l pb pc">theme_trend_chart &lt;- theme(<br/>  axis.text.x = element_text(size = text_size, vjust=0.5, angle=90),<br/>  axis.text.y = element_text(size = text_size),<br/>  axis.title = element_text(size = text_size),<br/>  axis.title.x = element_text(size = text_size),<br/>  axis.ticks.y = element_line(linetype = "solid"),<br/>  axis.ticks.x = element_line(linetype="solid"),<br/>  plot.title=element_text(size=text_size),<br/>  plot.subtitle =element_text(size=10),<br/>  panel.background = element_rect(fill="white", colour ="white"),<br/>  panel.grid.major = element_line(size=0.5, linetype = "solid", colour="gray90"),<br/>  legend.text = element_text(size=text_size),<br/>  legend.position = 'bottom')</span></pre></div></div>    
</body>
</html>