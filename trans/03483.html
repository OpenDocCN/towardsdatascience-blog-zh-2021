<html>
<head>
<title>Feature Generation with Gradient Boosted Decision Trees</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于梯度增强决策树的特征生成</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/feature-generation-with-gradient-boosted-decision-trees-21d4946d6ab5?source=collection_archive---------13-----------------------#2021-03-20">https://towardsdatascience.com/feature-generation-with-gradient-boosted-decision-trees-21d4946d6ab5?source=collection_archive---------13-----------------------#2021-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="73ac" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/b2c2d85ec65babee0d7f6260b51ab7bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXQsJuOUhK0GuvykAj3gYQ.jpeg"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">拉布雷尼亚，巴尔巴特，加的斯，作者<a class="ae kl" href="http://www.juntadeandalucia.es/medioambiente/servtc5/ventana/mostrarFicha.do;jsessionid=A3F33C7EEC39616F77B2038E82E3F59F?idEspacio=7408" rel="noopener ugc nofollow" target="_blank">安达卢西亚军政府</a></p></figure><h1 id="2a51" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="fe2e" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">在这篇博客中，我们实现了之前在脸书人工智能研究论文中提到的一个想法:<a class="ae kl" href="https://dl.acm.org/doi/10.1145/2648584.2648589" rel="noopener ugc nofollow" target="_blank"> <em class="mi">在脸书</em> </a>预测广告点击的实际经验</p><p id="0dc9" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">其思想是使用梯度推进决策树创建特征的非线性变换，然后使用最终估计器进行预测。</p><p id="89cc" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">该实现是托管在<a class="ae kl" href="https://sktools.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> sktools包</a>中的python管道转换器，可以通过以下方式下载:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="c281" class="mx kn iq mt b gy my mz l na nb">pip install sktools</span></pre><p id="bf98" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">和一些代码片段来集成以再现它</p><figure class="mo mp mq mr gt ka"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="99c7" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">介绍</h1><p id="ae7a" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">在机器学习任务的建模过程中，需要创建新的特征来描述问题并使模型达到更好的性能，这就是所谓的“特征工程过程”。这是每个机器学习项目周期的一部分。</p><figure class="mo mp mq mr gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ne"><img src="../Images/45fd7148489517cf5e61da4609e6c20f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e5poqo4-OK16aeG6BOrhpg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">从<a class="ae kl" href="http://www.mlebook.com/" rel="noopener ugc nofollow" target="_blank">开始的ML项目生命周期安德烈·布尔科夫</a></p></figure><p id="edea" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">在创建这些新功能的整个设计过程中，我们必须了解手头的任务，寻找功能的相互作用，尝试想象这个新功能如何与其他功能一起工作，考虑宁滨连续功能，创建最佳数量的四分点，以有助于提高线性回归性能的方式处理分类功能。所有这些都是在高维空间中，我们对二维或三维空间的直觉已经产生了误导。该过程不仅需要领域知识、耗时且容易出错，而且还依赖于问题，并且必须为每个新数据集开发方法和函数。不要忘记，并不能保证创建功能在任何时候都能达到最佳性能，这取决于人类的创造力和耐心。</p><p id="3015" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">在可以应用于任何问题的框架中，自动生成特征允许提取数据中更有用和更有意义的信息。允许机器学习工程师在更有用的任务上花费更多时间。</p><h1 id="409f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">利用梯度增强决策树生成特征</h1><p id="687e" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">决策树基于分类和回归树(CART)方法构建二元分裂。在每次树分裂时，基于损失函数的优化来选择分离的最佳选择。在建立了几个分支之后，我们就有了一个树状结构，其中某个单独的预测最终会出现在不同的树叶中。</p><p id="5db1" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">如果单个预测/一行/实例大于X_i中的某个值，则它将向右，否则它将向左。典型的二叉决策树分裂。</p><figure class="mo mp mq mr gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nf"><img src="../Images/f4d9c0dcb7dd621dfe3542d6cb4e4438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZDHinVnB4HgfSSzKPkh4Q.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">决策图表</p></figure><p id="4182" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">对于图中的决策，每个实例有五种可能性:[0，0，0，0，1]，[0，0，0，1，0]，[0，0，1，0，0]，[0，1，0，0，0]和[1，0，0，0，0，0]。</p><p id="96b6" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">给定任何数据集，在训练一个GBM之后，每个实例都可以根据它从每棵树中感受到的叶子进行编码。如果GBM由N个决策树的集合组成，那么每个实例将有N种编码。</p><p id="211a" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">编码的特征集可以水平地附加到先前的特征上，增加了问题的维度，并且增加了源自每个决策树执行的不同分裂的新的非线性信息。</p><h1 id="7f7b" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">一些实验</h1><p id="a4fe" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">在本节中，我们提供了几个基准来比较算法的性能。</p><p id="ca25" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated"><strong class="lm ja">逻辑</strong> —指逻辑回归</p><p id="9bad" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated"><strong class="lm ja">梯度推进</strong> —梯度推进决策树</p><p id="573b" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated"><strong class="lm ja"> GB特性</strong> —指的是前面提到的算法，其中特性通过梯度推进决策树进行转换，最终的估计器是逻辑回归。</p><figure class="mo mp mq mr gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ng"><img src="../Images/fb26dc3f81c0d61af8b3b826c505236c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-LmG1TVxjew6cf-jlhBdig.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">用一些数据集对算法进行基准测试</p></figure><p id="ff42" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">上图是我们对算法进行基准测试的七个数据集的条形图。每组条形代表使用三种方法的数据集的结果。每个条形都有一个相关的标准偏差来衡量预测的稳定性。在较小的数据集中，每次分割之间的差异往往较大，而在较大的数据集中，相似性往往较大，这解释了数据集之间标准差大小的差异</p><h1 id="4a47" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">代码片段</h1><p id="ea12" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">安装sktools软件包</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="cdb5" class="mx kn iq mt b gy my mz l na nb">pip install sktools</span></pre><p id="9746" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">将特征工程技术集成到具有最终估计器的流水线中</p><h2 id="effd" class="mx kn iq bd ko nh ni dn ks nj nk dp kw lv nl nm la lz nn no le md np nq li iw bi translated">分类</h2><p id="98a6" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">该实现处理几个超参数</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="1fb1" class="mx kn iq mt b gy my mz l na nb"><em class="mi">stack_to_X: bool, default = True</em></span></pre><p id="700d" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">如果设置为True，则返回原始列加上由梯度提升决策树算法生成的新列。如果为False，则仅返回新列。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="1417" class="mx kn iq mt b gy my mz l na nb"><em class="mi">add_probs: bool, default = False</em></span></pre><p id="5465" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">如果设置为True，它将返回创建的要素加上通过梯度增强估计的概率。请注意，这可以被视为一个集合。然而，默认值是False，所以不会附加任何概率。</p><p id="0409" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">scikit-learn梯度推进的所有论点也可以通过。</p><figure class="mo mp mq mr gt ka"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h2 id="288d" class="mx kn iq bd ko nh ni dn ks nj nk dp kw lv nl nm la lz nn no le md np nq li iw bi translated">回归</h2><p id="6694" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">为了将其构建为回归问题，需要修改超参数<code class="fe nr ns nt mt b">regression = True</code>。</p><figure class="mo mp mq mr gt ka"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="9029" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">请注意，这种特征生成技术可以视为一个整体，因此在验证过程中必须特别小心。</p><h1 id="6f01" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">感谢</h1><p id="229b" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">这个项目是之前在巴塞罗纳超级计算中心与大卫·布查卡(T2)一起完成的。</p><p id="fca9" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">sktools python包由<a class="ae kl" href="http://linkedin.com/in/david-masip-bonet-935a284b/" rel="noopener ugc nofollow" target="_blank">大卫·马斯普主持。</a></p><p id="1253" class="pw-post-body-paragraph lk ll iq lm b ln mj lp lq lr mk lt lu lv ml lx ly lz mm mb mc md mn mf mg mh ij bi translated">非常感谢<a class="ae kl" href="https://www.linkedin.com/in/vincentwarmerdam/" rel="noopener ugc nofollow" target="_blank"> Vincent Warmerdam </a>在<a class="ae kl" href="https://calmcode.io/" rel="noopener ugc nofollow" target="_blank">https://calmcode.io/</a>发布的关于开源的酷视频</p></div></div>    
</body>
</html>