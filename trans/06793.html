<html>
<head>
<title>7 Data Wrangling Python Functions in under 5 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不到5分钟内完成7个数据辩论Python函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/7-data-wrangling-python-functions-in-under-5-minutes-a8d9ec7cf34b?source=collection_archive---------7-----------------------#2021-06-19">https://towardsdatascience.com/7-data-wrangling-python-functions-in-under-5-minutes-a8d9ec7cf34b?source=collection_archive---------7-----------------------#2021-06-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/570327a5845e892db2a91c6dc7bad15b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1E1ylDatm6KRs_b6Xff0aw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">戴维·克洛德在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="c905" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">PYTHON教程-数据争论</h2><div class=""/><div class=""><h2 id="d08e" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">最基本但最常用的数据操作函数的分步演练</h2></div><h1 id="a9b6" class="lh li jj bd lj lk ll lm ln lo lp lq lr ky ls kz lt lb lu lc lv le lw lf lx ly bi translated">1导言</h1><p id="76a9" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">大家好，我是Gregor，我是一名数据科学家，也是一名大部分时间都需要评估和清理数据的人。我喜欢在我的项目中平等地使用Python/ Pandas和R/ tidyverse。我最近<a class="ae jg" rel="noopener" target="_blank" href="/7-data-wrangling-r-functions-for-your-next-data-science-project-in-under-5-minutes-d5a4ad55f99b">分享了一篇文章，在文章中我概述了我最常用的用于数据争论的R函数</a>。我认为分享如何利用Python中的这些函数是个好主意，尤其是熊猫。</p><p id="630f" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">在下一节中，我将概述我对本文的技术设置，以便您自己立即使用本文中的示例。然后，在第3节中，我将使用Gapminder数据集展示这七个函数。如果您有任何问题或任何意见，请随时与我分享。</p><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi na"><img src="../Images/3118374493867b5e3c921868b7c9c007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQXKGUvIhhbtJhn1ww9OFA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">数据争论功能概述；作者图片</p></figure><h1 id="e36c" class="lh li jj bd lj lk ll lm ln lo lp lq lr ky ls kz lt lb lu lc lv le lw lf lx ly bi translated">2设置</h1><p id="b29b" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">为了展示这些功能，我将使用<strong class="mb jt"> Gapminder数据集</strong>。Gapminder数据集包含该国几十年来的预期寿命、人均GDP和人口数据。此外，我将Jupyter笔记本与熊猫结合使用。</p><p id="ba8a" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">这七项功能是熊猫套餐的一部分。如果你想知道我是如何构建我的代码的，它被称为<strong class="mb jt">方法链</strong>或管道(在R社区中)。我在我的另一篇文章中解释了<a class="ae jg" rel="noopener" target="_blank" href="/the-flawless-pipes-of-python-pandas-30f3ee4dffc2">的基础知识。</a></p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/0a65cb464f05a59b33d0d497103215cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-hAlPvl-OpEIrwFLrIlwQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><h1 id="b1a4" class="lh li jj bd lj lk ll lm ln lo lp lq lr ky ls kz lt lb lu lc lv le lw lf lx ly bi translated">3七个最基本但最常用的数据争论函数</h1><p id="d556" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated"><strong class="mb jt">七个函数</strong>允许您<strong class="mb jt">选择</strong>和<strong class="mb jt">重命名</strong>特定列，<strong class="mb jt">排序</strong>和<strong class="mb jt">过滤</strong>您的数据集，<strong class="mb jt">创建</strong>并计算<strong class="mb jt">新列</strong>，<strong class="mb jt">汇总</strong>值。我将在每个函数中使用<strong class="mb jt"> Gapminder </strong>数据，以便于理解并应用于您的数据集。请注意，我们走得越远，我将使用这些函数的组合。</p><h2 id="7198" class="ni li jj bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx jp bi translated">3.1过滤器()—选择数据集中的列</h2><p id="d2c9" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">仅选择列<em class="nt">洲</em>、<em class="nt">年</em>和<em class="nt">弹出</em>。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/e966d34966e8198702f15923e3cd732d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sAqaXpBZEKdh9CdO-j9hhw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><p id="6633" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">使用<em class="nt"> like </em>运算符选择名称中包含<em class="nt"> co </em>的所有列。请查看文档，了解更多有用的功能。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/10c9af4a3fbd2f3c889fa05764a54796.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_ABS887efyTQ5kaPDVcEw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><h2 id="bad5" class="ni li jj bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx jp bi translated">3.2 rename() —重命名列</h2><p id="f39b" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">将<em class="nt">年</em>列重命名为<em class="nt">年</em>，将<em class="nt">寿命预期</em>重命名为<em class="nt">预期寿命</em>。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/4e9134c01d1e448ba888d150a24f375a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*odv5CSyqUNYssS5TK8UOwA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><h2 id="75c4" class="ni li jj bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx jp bi translated">3.3 sort_values() —对数据集进行排序</h2><p id="5ff9" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">按<em class="nt">年</em>排序。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/b3f365a8067852d27797ec7d56a5a623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M-uIyojAEWMc90Qqqepu0Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><p id="4c8e" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">按<em class="nt"> lifeExp </em>和<em class="nt"> year </em>排序(降序)。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/98703a829ed6bfa56e384ac170c4357d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWwaXT1Ejb7yLV0Yr-W6-g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><h2 id="35e8" class="ni li jj bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx jp bi translated">3.4 query() —过滤数据集中的行</h2><p id="c215" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">过滤带有<em class="nt">年份</em> 1972的行。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/d16ff5b6fc58f55560f0d8b244a79008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZdsGDXU_weheEOAqy3pN2Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><p id="d387" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">筛选出1972年和预期寿命低于平均值的行。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/a764c4c43153edbfb1b4bf10bda914d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eheN9nDJ2pc8ApRp-oNzNg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><p id="21eb" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">过滤年份<em class="nt">为1972年</em>且<em class="nt">预期寿命</em>低于平均值，且<em class="nt">国家</em>为<em class="nt">玻利维亚</em>或<em class="nt">安哥拉</em>的行。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/1c8f6202236d485653a5802354f0942f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XtW_hO54V_qFAdWQzuoQlQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(2行)；作者图片</p></figure><h2 id="7e2f" class="ni li jj bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx jp bi translated">3.5 assign()和lambda —在数据集中生成新列</h2><p id="df50" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">创建一个组合了<em class="nt">洲</em>和<em class="nt">国家</em>信息的列，以及另一个显示四舍五入后的<em class="nt">生命周期</em>信息的列。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oc"><img src="../Images/33b66ed28618d012ecd6c5917e92c19c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5TbDL8aWx9d04NkU0dHCw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(10行)；作者图片</p></figure><h2 id="6be6" class="ni li jj bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx jp bi translated">3.6 agg()-在数据集中创建汇总计算</h2><p id="075c" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">对于整个数据集，计算<em class="nt">人口</em>和<em class="nt">预期寿命</em>的平均值和标准差。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/c2b539e509200b0f33a9dfda248f9e82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a5nXArmFibnQiq7tkMYuDA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(摘要)；作者图片</p></figure><h2 id="3e17" class="ni li jj bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx jp bi translated">3.7 Group by()-将数据集分组并创建汇总计算</h2><p id="2a4e" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">没有<em class="nt"> groupby() </em>函数，<em class="nt"> agg() </em>函数就没那么有用了。将两者结合使用是创建新数据集的有效方法。在下面的例子中，我将按洲对数据集进行分组，然后我将为<em class="nt">人口</em>和<em class="nt">生活支出</em>创建汇总。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/77dee90ee548eaf5bf3dbb928317dc7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGGeGHbcUsLTBBXy1KiaDA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(分组汇总)；作者图片</p></figure><p id="2d6b" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">也可以按多个列进行分组。在下一个例子中，我使用<em class="nt"> groupby() </em>和<em class="nt">洲</em>和<em class="nt">年</em>。</p><figure class="nb nc nd ne gt iv"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi of"><img src="../Images/4ac16bbf25bbad599d7d33c90fa704ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVNczoXLFpCNtQwVQDqFQg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Gapminder数据集(分组汇总)；作者图片</p></figure><h1 id="c66b" class="lh li jj bd lj lk ll lm ln lo lp lq lr ky ls kz lt lb lu lc lv le lw lf lx ly bi translated">4结论</h1><p id="eadf" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">在本文中，我向您展示了我最常用的操作数据集的Pandas函数。我为您提供了一些示例，希望这些示例为您尝试每个功能提供了一个完美的基础。</p><p id="b3cd" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">如果你想了解更多关于熊猫的信息，请务必查阅<a class="ae jg" href="https://pandas.pydata.org/docs/user_guide/index.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>以及用于数据分析的书<a class="ae jg" href="https://pandas.pydata.org/pandas-docs/version/1.2.3/pandas.pdf" rel="noopener ugc nofollow" target="_blank">Python</a>。请让我知道你的想法和你最常用的功能。谢谢大家！</p></div></div>    
</body>
</html>