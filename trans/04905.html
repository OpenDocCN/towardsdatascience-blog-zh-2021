<html>
<head>
<title>Machine Learning Model Interpretation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习模型解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-model-interpretation-47b4bc29d17f?source=collection_archive---------34-----------------------#2021-04-28">https://towardsdatascience.com/machine-learning-model-interpretation-47b4bc29d17f?source=collection_archive---------34-----------------------#2021-04-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5af2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Skater建立ML可视化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/5cc1a7ccc8193cb1dbb54327a5940625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*5sAOvk49-TOXuPuOLHralA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">树(来源:<a class="ae ku" href="https://www.linkedin.com/in/himanshusharmads/" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><p id="1a8e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">解释机器学习模型是一项艰巨的任务，因为我们需要了解模型在后端如何工作，模型使用的所有参数是什么，以及模型如何生成预测。我们可以使用不同的python库来创建机器学习模型可视化，并分析模型的工作对象。</p><div class="lr ls gp gr lt lu"><a rel="noopener follow" target="_blank" href="/machine-learning-model-dashboard-4544daa50848"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">机器学习模型仪表板</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">创建仪表板来解释机器学习模型</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">towardsdatascience.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi ko lu"/></div></div></a></div><p id="3b56" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Staker是一个开源的python库，支持对不同类型的黑盒模型进行机器学习模型解释。它帮助我们创建不同类型的可视化，使我们更容易理解模型是如何工作的。</p><p id="4a9b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在这篇文章中，我们将探索滑板和它的不同功能。让我们开始吧…</p><h1 id="ad80" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">安装所需的库</h1><p id="a6b6" class="pw-post-body-paragraph kv kw it kx b ky nb ju la lb nc jx ld le nd lg lh li ne lk ll lm nf lo lp lq im bi translated">我们将从使用pip安装安装一个溜冰者开始。下面给出的命令将使用pip安装溜冰者。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0336" class="nl mk it nh b gy nm nn l no np">!pip install -U skater</span></pre><h1 id="39c1" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">导入所需的库</h1><p id="368b" class="pw-post-body-paragraph kv kw it kx b ky nb ju la lb nc jx ld le nd lg lh li ne lk ll lm nf lo lp lq im bi translated">下一步将是导入所需的库。要使用Skater解释模型，我们首先需要创建一个模型。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="e97a" class="nl mk it nh b gy nm nn l no np">%matplotlib inline <br/>import matplotlib.pyplot <br/>import matplotlib.pyplot as plt <br/>import numpy as np <br/>from sklearn.model_selection <br/>import train_test_split from sklearn.ensemble <br/>import RandomForestClassifier <br/>from sklearn import datasets <br/>from sklearn import svm<br/>from skater.core.explanations import Interpretation<br/>from skater.model import InMemoryModel<br/>from skater.core.global_interpretation.tree_surrogate <br/>import TreeSurrogate<br/>from skater.util.dataops import show_in_notebook</span></pre><h1 id="aec3" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建模型</h1><p id="10c8" class="pw-post-body-paragraph kv kw it kx b ky nb ju la lb nc jx ld le nd lg lh li ne lk ll lm nf lo lp lq im bi translated">我们将创建一个随机森林分类器，并使用IRIS数据集。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="6ff3" class="nl mk it nh b gy nm nn l no np">iris = datasets.load_iris()<br/>digits = datasets.load_digits()<br/>X = iris.data<br/>y = iris.target<br/>clf = RandomForestClassifier(random_state=0, n_jobs=-1)<br/><br/>xtrain, xtest, ytrain, ytest = train_test_split(X,y,test_size=0.2, random_state=0) clf = clf.fit(xtrain, ytrain)</span><span id="fd0f" class="nl mk it nh b gy nq nn l no np">y_pred=clf.predict(xtest)<br/>prob=clf.predict_proba(xtest)</span><span id="e6fe" class="nl mk it nh b gy nq nn l no np">from skater.core.explanations import Interpretation<br/>from skater.model import InMemoryModel</span><span id="e115" class="nl mk it nh b gy nq nn l no np">from skater.core.global_interpretation.tree_surrogate import TreeSurrogate<br/>from skater.util.dataops import show_in_notebook</span><span id="d120" class="nl mk it nh b gy nq nn l no np">interpreter = Interpretation(<br/>        training_data=xtrain, training_labels=ytrain, feature_names=iris.feature_names<br/>    )<br/>pyint_model = InMemoryModel(<br/>            clf.predict_proba,<br/>            examples=xtrain,<br/>            target_names=iris.target_names,<br/>            unique_values=np.unique(ytrain).tolist(),<br/>            feature_names=iris.feature_names,<br/>        )</span></pre><h1 id="e060" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建可视化</h1><p id="63a6" class="pw-post-body-paragraph kv kw it kx b ky nb ju la lb nc jx ld le nd lg lh li ne lk ll lm nf lo lp lq im bi translated">我们将从创建不同的可视化开始，这将帮助我们分析我们创建的模型是如何工作的。</p><ol class=""><li id="d495" class="nr ns it kx b ky kz lb lc le nt li nu lm nv lq nw nx ny nz bi translated"><strong class="kx iu">部分依赖情节</strong></li></ol><p id="b11e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">该图向我们展示了特定特征如何影响模型的预测。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="d105" class="nl mk it nh b gy nm nn l no np">interpreter.partial_dependence.plot_partial_dependence(<br/>   ['sepal length (cm)'] , pyint_model, n_jobs=-1, progressbar=<strong class="nh iu">False</strong>, grid_resolution=30, with_variance=<strong class="nh iu">True</strong>,figsize = (10, 5)<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a884222d26948e0ecaa6d6a4380004cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*H1qJyOQfjHnMuWZaOk758w.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">PDP剧情(来源:<a class="ae ku" href="https://www.linkedin.com/in/himanshusharmads/" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><p id="1a92" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.<strong class="kx iu">特征重要性</strong></p><p id="6f63" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在此图中，我们将分析我们创建的模型中的功能的重要性。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="45b0" class="nl mk it nh b gy nm nn l no np">plots = interpreter.feature_importance.plot_feature_importance(pyint_model, ascending=True, progressbar=True,<br/>                                n_jobs=-1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4e770ba5c22ccbff4b621a08e61d41e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*QrbnvNjnjXtW41YaGh7GsQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">功能重要性(来源:<a class="ae ku" href="https://www.linkedin.com/in/himanshusharmads/" rel="noopener ugc nofollow" target="_blank">作者</a>)</p></figure><p id="120c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">3.<strong class="kx iu">代理树</strong></p><p id="3ee0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这是我们创建的随机森林模型的图形表示。在每一步，它都显示基尼指数值、等级等。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="c5ed" class="nl mk it nh b gy nm nn l no np">surrogate_explainer = interpreter.tree_surrogate(oracle=pyint_model, seed=5)<br/>surrogate_explainer.fit(xtrain, ytrain)<br/>surrogate_explainer.plot_global_decisions(show_img=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/5cc1a7ccc8193cb1dbb54327a5940625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*5sAOvk49-TOXuPuOLHralA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">代理树(来源:<a class="ae ku" href="https://www.linkedin.com/in/himanshusharmads/" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><p id="438f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这就是我们如何使用Skater来创建不同的图表，帮助我们分析模型的表现。继续尝试不同的数据集，并让我知道您在回复部分的评论。</p><p id="33bd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">本文是与<a class="oc od ep" href="https://medium.com/u/40808d551f5a?source=post_page-----47b4bc29d17f--------------------------------" rel="noopener" target="_blank">皮尤什·英加尔</a>合作完成的。</p><h1 id="8d5f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在你走之前</h1><p id="1eb0" class="pw-post-body-paragraph kv kw it kx b ky nb ju la lb nc jx ld le nd lg lh li ne lk ll lm nf lo lp lq im bi translated"><strong class="kx iu"> <em class="oe">感谢</em> </strong> <em class="oe">的阅读！如果你想与我取得联系，请随时通过hmix13@gmail.com联系我或我的</em> <a class="ae ku" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="kx iu"> <em class="oe"> LinkedIn个人资料</em> </strong> </a> <em class="oe">。可以查看我的</em><a class="ae ku" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="kx iu"><em class="oe">Github</em></strong><em class="oe"/></a><em class="oe">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae ku" href="https://medium.com/@hmix13" rel="noopener"> <strong class="kx iu"> <em class="oe">我的简介</em> </strong> </a> <em class="oe">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>