<html>
<head>
<title>Improve ML Model Performance by Combining Categorical Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é€šè¿‡ç»„åˆåˆ†ç±»ç‰¹å¾æé«˜MLæ¨¡å‹æ€§èƒ½</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/improve-ml-model-performance-by-combining-categorical-features-a23efbb6a215?source=collection_archive---------21-----------------------#2021-05-22">https://towardsdatascience.com/improve-ml-model-performance-by-combining-categorical-features-a23efbb6a215?source=collection_archive---------21-----------------------#2021-05-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="be16" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">æé«˜æ¨¡å‹æ€§èƒ½çš„ä¸€ä¸ªç®€å•æŠ€å·§ã€‚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/403e2610faf21764adc5cae224811fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9IaJBN5dVn92nSVO_0vHA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ç…§ç‰‡ç”±æ¥è‡ª<a class="ae kv" href="https://www.pexels.com/photo/selective-focus-photoraphy-of-chains-during-golden-hour-119562/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">ä½©å…‹æ–¯</a>çš„<a class="ae kv" href="https://www.pexels.com/@joey-kyber-31917?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">ä¹”ä¼ŠÂ·å‡¯ä¼¯</a>æ‹æ‘„</p></figure><p id="3a82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å½“æ‚¨è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ï¼Œæ‚¨çš„æ•°æ®é›†ä¸­å¯ä»¥æœ‰ä¸€äº›è¡¨ç¤ºåˆ†ç±»å€¼çš„è¦ç´ ã€‚åˆ†ç±»ç‰¹å¾æ˜¯å¯ä»¥åˆ†ç»„çš„æ•°æ®ç±»å‹ã€‚</p><p id="8329" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æœ‰ä¸‰ç§å¸¸è§çš„åˆ†ç±»æ•°æ®ç±»å‹ï¼Œå®ƒä»¬æ˜¯:</p><ol class=""><li id="582f" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">åºæ•°</strong> â€”è¿™æœ‰ä¸€ç»„é¡ºåºã€‚ä¾‹å¦‚:ç”¨1-10çš„å°ºåº¦ç»™å¹¸ç¦æ‰“åˆ†</li><li id="37f5" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">äºŒè¿›åˆ¶</strong> â€”åªæœ‰ä¸¤ä¸ªå€¼ã€‚ä¾‹å¦‚:ç”·æ€§æˆ–å¥³æ€§</li><li id="558c" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">åä¹‰</strong> â€”å®ƒæ²¡æœ‰ä»»ä½•è®¢å•é›†ã€‚ç¤ºä¾‹:å›½å®¶</li></ol><p id="6ba8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¤§å¤šæ•°æœºå™¨å­¦ä¹ ç®—æ³•éœ€è¦æ•°å­—è¾“å…¥å’Œè¾“å‡ºå˜é‡ã€‚å› æ­¤ï¼Œæ‚¨å¿…é¡»å°†æ•°æ®é›†ä¸­çš„åˆ†ç±»ç‰¹å¾è½¬æ¢ä¸ºæ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼Œä»¥ä¾›æœºå™¨å­¦ä¹ ç®—æ³•ä½¿ç”¨ã€‚æ‚¨å¯ä»¥å¯¹äºŒè¿›åˆ¶ç‰¹å¾ä½¿ç”¨<a class="ae kv" href="https://www.freecodecamp.org/news/feature-engineering-and-feature-selection-for-beginners/" rel="noopener ugc nofollow" target="_blank">æ ‡ç­¾ç¼–ç </a>ï¼Œæˆ–è€…å¯¹åä¹‰ç‰¹å¾ä½¿ç”¨<a class="ae kv" href="https://hackernoon.com/what-is-one-hot-encoding-why-and-when-do-you-have-to-use-it-e3c6186d008f" rel="noopener ugc nofollow" target="_blank">ä¸€æ¬¡çƒ­ç¼–ç </a>æ–¹æ³•ã€‚</p><p id="fad3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†äº†è§£ç»„åˆåˆ†ç±»ç‰¹å¾å¦‚ä½•æé«˜æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½ã€‚</p><p id="26a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ã€‚ğŸš€</p><h1 id="4c46" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">åœ¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­ç»„åˆåˆ†ç±»ç‰¹å¾</h1><p id="afe5" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªç”±å…¶ä»–ä¸¤ä¸ªåˆ†ç±»è¦ç´ ç»„åˆè€Œæˆçš„æ–°è¦ç´ ã€‚æ‚¨è¿˜å¯ä»¥ç»„åˆä¸‰ä¸ªæˆ–å››ä¸ªä»¥ä¸Šç”šè‡³æ›´å¤šçš„åˆ†ç±»ç‰¹å¾ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="5a5d" class="ni mh iq ne b gy nj nk l nl nm">df["new_feature"] = (<br/>	df.feature_1.astype(str)<br/>	 + "_"<br/>	 + df.feature_2.astype(str)<br/>	)</span></pre><p id="3dee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¦‚ä½•ä½¿ç”¨pandasåˆå¹¶ä¸¤ä¸ªåˆ†ç±»è¦ç´ ï¼Œå¹¶åœ¨æ•°æ®é›†ä¸­å½¢æˆä¸€ä¸ªæ–°è¦ç´ ã€‚</p><p id="9154" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é‚£ä¹ˆä½ åº”è¯¥ç»“åˆå“ªäº›åˆ†ç±»ç‰¹å¾å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜æ²¡æœ‰ç®€å•çš„ç­”æ¡ˆã€‚è¿™å–å†³äºæ‚¨çš„æ•°æ®å’Œè¦ç´ ç±»å‹ã€‚ä¸€äº›é¢†åŸŸçŸ¥è¯†å¯èƒ½å¯¹åˆ›å»ºè¿™æ ·çš„æ–°ç‰¹æ€§æœ‰ç”¨ã€‚</p><p id="d129" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†è¯´æ˜æ•´ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª<a class="ae kv" href="https://zindi.africa/competitions/financial-inclusion-in-africa" rel="noopener ugc nofollow" target="_blank"> Zindi competitioné¡µé¢</a>çš„<a class="ae kv" href="https://zindi.africa/competitions/financial-inclusion-in-africa/data" rel="noopener ugc nofollow" target="_blank">éæ´²é‡‘èåŒ…å®¹æ€§æ•°æ®é›†</a>ï¼Œå®ƒå…·æœ‰è®¸å¤šåˆ†ç±»ç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¸­ä¸€äº›ç‰¹å¾ç»“åˆèµ·æ¥ï¼Œçœ‹çœ‹æˆ‘ä»¬æ˜¯å¦å¯ä»¥æ”¹è¿›æ¨¡å‹æ€§èƒ½ã€‚</p><p id="b572" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¯¥æ•°æ®é›†çš„ç›®æ ‡æ˜¯é¢„æµ‹è°æœ€æœ‰å¯èƒ½æ‹¥æœ‰é“¶è¡Œå¸æˆ·ã€‚æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ã€‚</p><h1 id="802d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">1.åŠ è½½æ•°æ®é›†</h1><p id="4c3e" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">æˆ‘ä»¬çš„ç¬¬ä¸€æ­¥æ˜¯ç¡®ä¿æˆ‘ä»¬å·²ç»ä¸‹è½½äº†æ¯”èµ›ä¸­æä¾›çš„æ•°æ®é›†ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½æ•°æ®é›†<a class="ae kv" href="https://zindi.africa/competitions/financial-inclusion-in-africa/data" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><p id="ae4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯¼å…¥é‡è¦çš„pythonåŒ…ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="2e2e" class="ni mh iq ne b gy nj nk l nl nm">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import warnings<br/>np.random.seed(123)<br/>warnings.filterwarnings('ignore')<br/>%matplotlib inline</span></pre><p id="5e75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åŠ è½½æ•°æ®é›†ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="7bed" class="ni mh iq ne b gy nj nk l nl nm"># Import data</span><span id="c2a5" class="ni mh iq ne b gy nn nk l nl nm">data = pd.read_csv('data/Train_v2.csv')</span></pre><p id="7e0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬è§‚å¯Ÿæ•°æ®é›†çš„å½¢çŠ¶ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="2858" class="ni mh iq ne b gy nj nk l nl nm"># print shape</span><span id="da79" class="ni mh iq ne b gy nn nk l nl nm">print('data shape :', data.shape)</span><span id="6305" class="ni mh iq ne b gy nn nk l nl nm">data shape : (23524, 13)</span></pre><p id="d30c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸Šé¢çš„è¾“å‡ºæ˜¾ç¤ºäº†æ•°æ®é›†ä¸­çš„è¡Œæ•°å’Œåˆ—æ•°ã€‚æ•°æ®é›†ä¸­æœ‰13ä¸ªå˜é‡ï¼Œ12ä¸ªè‡ªå˜é‡å’Œ1ä¸ªå› å˜é‡ã€‚</p><p id="d01e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨pandasåº“ä¸­çš„<strong class="ky ir"> head() </strong>æ–¹æ³•æ¥è§‚å¯Ÿæ•°æ®é›†ä¸­çš„å‰äº”è¡Œã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="bcd3" class="ni mh iq ne b gy nj nk l nl nm"># inspect data </span><span id="6f62" class="ni mh iq ne b gy nn nk l nl nm">data.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/03d2a2e4d52d12ffe4c777f455219965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8kVSJtSWx4mSIit6MyFKQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">æ ·æœ¬daa</p></figure><p id="91f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç†è§£æ¯ä¸ªè¦ç´ çš„å«ä¹‰éå¸¸é‡è¦ï¼Œè¿™æ ·æ‚¨æ‰èƒ½çœŸæ­£ç†è§£æ•°æ®é›†ã€‚æ‚¨å¯ä»¥é˜…è¯»<strong class="ky ir"> VariableDefinition.csv </strong>æ–‡ä»¶æ¥ç†è§£æ•°æ®é›†ä¸­å‡ºç°çš„æ¯ä¸ªå˜é‡çš„å«ä¹‰ã€‚</p><h1 id="1170" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">2.äº†è§£æ•°æ®é›†</h1><p id="f8b5" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">é€šè¿‡ä½¿ç”¨pandasçš„<strong class="ky ir"> info() </strong>æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ›´å¤šå…³äºè¿™äº›ç‰¹æ€§çš„ä¿¡æ¯ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="b9af" class="ni mh iq ne b gy nj nk l nl nm">#show Some information about the dataset</span><span id="8b7f" class="ni mh iq ne b gy nn nk l nl nm">print(train_data.info())</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/70d3e0bda6eb738ea6943b11d515406d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*03urULYWIzcR_gVV_QXteg.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">æ•°æ®æè¿°</p></figure><p id="bc71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¾“å‡ºæ˜¾ç¤ºå˜é‡/ç‰¹å¾åˆ—è¡¨ã€å¤§å°(å¦‚æœåŒ…å«ç¼ºå¤±å€¼)ä»¥åŠæ¯ä¸ªå˜é‡çš„æ•°æ®ç±»å‹ã€‚ä»æ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»»ä½•ç¼ºå¤±å€¼ï¼Œæˆ‘ä»¬æœ‰3ä¸ªæ•´æ•°æ•°æ®ç±»å‹çš„ç‰¹å¾å’Œ10ä¸ªå¯¹è±¡æ•°æ®ç±»å‹çš„ç‰¹å¾(å¤§å¤šæ•°æ˜¯åˆ†ç±»ç‰¹å¾)ã€‚</p><h1 id="acbc" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">3.æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ•°æ®å‡†å¤‡</h1><p id="b06d" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">ä¸‹ä¸€æ­¥æ˜¯ä»æ•°æ®ä¸­åˆ†ç¦»å‡ºè‡ªå˜é‡å’Œç›®æ ‡(bank_account)ã€‚ç„¶åä½¿ç”¨<a class="ae kv" rel="noopener" target="_blank" href="/categorical-encoding-using-label-encoding-and-one-hot-encoder-911ef77fb5bd"> LabelEncoder </a>å°†ç›®æ ‡å€¼ä»å¯¹è±¡æ•°æ®ç±»å‹è½¬æ¢æˆæ•°å€¼ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="ba0e" class="ni mh iq ne b gy nj nk l nl nm">#import preprocessing module<br/>from sklearn.preprocessing import LabelEncoder<br/>from sklearn.preprocessing import MinMaxScaler</span><span id="22c6" class="ni mh iq ne b gy nn nk l nl nm"># Convert target label to numerical Data<br/>le = LabelEncoder()<br/>data['bank_account'] = le.fit_transform(data['bank_account'])</span><span id="c820" class="ni mh iq ne b gy nn nk l nl nm">#Separate training features from target<br/>X = data.drop(['bank_account'], axis=1)<br/>y = data['bank_account']</span><span id="a884" class="ni mh iq ne b gy nn nk l nl nm">print(y)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/824a43918a5be8b16d5caa693fad864f.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*QucjXyANcPePjMSkLN5Wpg.jpeg"/></div></figure><p id="763f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç›®æ ‡å€¼å·²è½¬æ¢ä¸ºæ•°å­—æ•°æ®ç±»å‹ï¼Œ1è¡¨ç¤ºâ€œæ˜¯â€ï¼Œ0è¡¨ç¤ºâ€œå¦â€ã€‚</p><p id="a30f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„é¢„å¤„ç†å‡½æ•°æ¥:</p><ul class=""><li id="7f0a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nr ly lz ma bi translated">å¤„ç†æ•°æ®ç±»å‹çš„è½¬æ¢ã€‚</li><li id="d36d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nr ly lz ma bi translated">ä½¿ç”¨<a class="ae kv" rel="noopener" target="_blank" href="/categorical-encoding-using-label-encoding-and-one-hot-encoder-911ef77fb5bd">ä¸€é”®ç¼–ç å™¨å’Œ/æˆ–æ ‡ç­¾ç¼–ç å™¨</a>å°†åˆ†ç±»ç‰¹å¾è½¬æ¢ä¸ºæ•°å­—ç‰¹å¾ã€‚</li><li id="ab9c" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nr ly lz ma bi translated">åˆ é™¤uniqueidå˜é‡ã€‚</li><li id="99b0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nr ly lz ma bi translated">æ‰§è¡Œ<a class="ae kv" rel="noopener" target="_blank" href="/preprocessing-with-sklearn-a-complete-and-comprehensive-guide-670cb98fcfb9">ç‰¹å¾ç¼©æ”¾</a>ã€‚</li></ul><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="9fe6" class="ni mh iq ne b gy nj nk l nl nm"># function to preprocess our data </span><span id="ed8a" class="ni mh iq ne b gy nn nk l nl nm">def preprocessing_data(data):</span><span id="bb37" class="ni mh iq ne b gy nn nk l nl nm">    # Convert the following numerical labels from interger to float<br/>    float_array = data[["household_size", "age_of_respondent", "year"]].values.astype(float<br/>    )<br/>    <br/>    # categorical features to be converted to One Hot Encoding<br/>    categ = [<br/>        "relationship_with_head",<br/>        "marital_status",<br/>        "education_level",<br/>        "job_type",<br/>        "country",<br/>    ]<br/>    <br/>    # One Hot Encoding conversion<br/>    data = pd.get_dummies(data, prefix_sep="_", columns=categ)<br/>    <br/>    # Label Encoder conversion<br/>    data["location_type"] = le.fit_transform(data["location_type"])<br/>    data["cellphone_access"] = le.fit_transform(data["cellphone_access"])<br/>    data["gender_of_respondent"] = le.fit_transform(data["gender_of_respondent"])<br/>    <br/>    # drop uniquid column<br/>    data = data.drop(["uniquid"]), axis=1)<br/>    <br/>    # scale our data <br/>    scaler = StandardScaler()<br/>    data = scaler.fit_transform(data)<br/>    <br/>    return data</span></pre><p id="9b50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬é¢„å¤„ç†æˆ‘ä»¬çš„æ•°æ®é›†ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="1a25" class="ni mh iq ne b gy nj nk l nl nm"># preprocess the train data </span><span id="f696" class="ni mh iq ne b gy nn nk l nl nm">processed_test_data = preprocessing_data(X_train)</span></pre><h1 id="36a3" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">4.æ¨¡å‹å»ºç«‹å’Œå®éªŒ</h1><p id="496d" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">æ•°æ®é›†çš„ä¸€éƒ¨åˆ†å°†ç”¨äºè¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="865e" class="ni mh iq ne b gy nj nk l nl nm"># Split train_data<br/>from sklearn.model_selection import train_test_spilt<br/>X_Train, X_val, y_Train, y_val = train_test_split(processed_train_data, y_train, stratify = y, test_size = 0.1, random_state=42)</span></pre><p id="9b0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åªæœ‰æ•°æ®é›†çš„<strong class="ky ir"> 10% </strong>å°†ç”¨äºè¯„ä¼°æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚å‚æ•°<strong class="ky ir">åˆ†å±‚= y </strong>å°†ç¡®ä¿è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„ä¸¤ä¸ªç±»çš„å€¼ç›¸ç­‰(â€œæ˜¯â€å’Œâ€œå¦â€)ã€‚</p><p id="a9f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯¹äºè¿™ä¸ªåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong class="ky ir">é€»è¾‘å›å½’ç®—æ³•</strong>æ¥è®­ç»ƒå’Œé¢„æµ‹è°æœ€æœ‰å¯èƒ½æ‹¥æœ‰é“¶è¡Œè´¦æˆ·ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="b55f" class="ni mh iq ne b gy nj nk l nl nm">#import classifier algorithm here<br/>from sklearn.linear_model import LogisticRegression</span><span id="07d1" class="ni mh iq ne b gy nn nk l nl nm"># create classifier<br/>lg_model = LogisticRegression()</span><span id="9e1f" class="ni mh iq ne b gy nn nk l nl nm">#Training the classifier<br/>lg_model.fit(X_Train,y_Train)</span></pre><p id="caa2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®­ç»ƒå®Œåˆ†ç±»å™¨ä¹‹åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹æ¥é¢„æµ‹æˆ‘ä»¬çš„è¯„ä¼°é›†ï¼Œçœ‹çœ‹å®ƒçš„è¡¨ç°å¦‚ä½•ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å‡†ç¡®æ€§ä½œä¸ºæˆ‘ä»¬çš„è¯„ä¼°æ ‡å‡†ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="98d9" class="ni mh iq ne b gy nj nk l nl nm"># import evaluation metrics<br/>from sklearn.metrics import confusion_matrix, accuracy_score</span><span id="9d64" class="ni mh iq ne b gy nn nk l nl nm"># evaluate the model<br/>y_pred = lg_model.predict(X_val)</span><span id="1edc" class="ni mh iq ne b gy nn nk l nl nm"># Get the accuracy<br/>print("Accuracy Score of Logistic Regression classifier: ","{:.4f}".format(accuracy_score(y_val, lg_y_pred)))</span></pre><p id="d8a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Logisticå›å½’åˆ†ç±»å™¨çš„å‡†ç¡®ç‡å¾—åˆ†:<strong class="ky ir"> 0.8874 </strong></p><h1 id="225c" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">ç¬¬ä¸€ä¸ªå®éªŒ:ç»“åˆæ•™è‚²æ°´å¹³å’Œå·¥ä½œç±»å‹ç‰¹å¾ã€‚</h1><p id="43a4" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†åŸºæœ¬çš„æ¨¡å‹æ€§èƒ½ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦å¯ä»¥é€šè¿‡ç»“åˆ<strong class="ky ir"> education_level </strong>å’Œ<strong class="ky ir"> job_type </strong>ç‰¹æ€§æ¥æ”¹è¿›å®ƒã€‚</p><p id="5f4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­éœ€è¦åšçš„æ˜¯æ›´æ–°æˆ‘ä»¬å·²ç»åˆ›å»ºçš„é¢„å¤„ç†å‡½æ•°ï¼Œç„¶åè¿è¡Œå‰©ä½™çš„ä»£ç ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="c104" class="ni mh iq ne b gy nj nk l nl nm"># function to preprocess our data <br/> <br/>def preprocessing_data(data):</span><span id="0c80" class="ni mh iq ne b gy nn nk l nl nm">    # Convert the following numerical labels from integer to float<br/>    float_array = data[["household_size", "age_of_respondent", "year"]].values.astype(float)</span><span id="f725" class="ni mh iq ne b gy nn nk l nl nm">    # combine some cat features <br/>    data["features_combination"] = (data.education_level.astype(str) + "_" + data.job_type.astype(str) )</span><span id="0a85" class="ni mh iq ne b gy nn nk l nl nm">    # remove individual features that are combined together<br/>    data = data.drop(['education_level','job_type'], axis=1)</span><span id="91a4" class="ni mh iq ne b gy nn nk l nl nm">    # categorical features to be converted by One Hot Encoding<br/>    categ = [<br/>      "relationship_with_head",<br/>      "marital_status",<br/>      "features_combination",<br/>      "country"<br/>      ]</span><span id="e42a" class="ni mh iq ne b gy nn nk l nl nm">    # One Hot Encoding conversion<br/>    data = pd.get_dummies(data, prefix_sep="_", columns=categ)</span><span id="9fc2" class="ni mh iq ne b gy nn nk l nl nm">    # Label Encoder conversion<br/>    data["location_type"] = le.fit_transform(data["location_type"])<br/>    data["cellphone_access"] = le.fit_transform(data["cellphone_access"])<br/>    data["gender_of_respondent"] = le.fit_transform(data["gender_of_respondent"])</span><span id="0380" class="ni mh iq ne b gy nn nk l nl nm">    # drop uniquid column<br/>    data = data.drop(["uniqueid"], axis=1)</span><span id="a277" class="ni mh iq ne b gy nn nk l nl nm">    # scale our data <br/>    scaler = StandardScaler()<br/>    data = scaler.fit_transform(data)</span><span id="a484" class="ni mh iq ne b gy nn nk l nl nm">    return data</span></pre><p id="5bee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ä¸Šè¿°é¢„å¤„ç†å‡½æ•°ä¸­ï¼Œæˆ‘é€šè¿‡ä»¥ä¸‹æ–¹å¼æ›´æ–°äº†ä»£ç </p><ul class=""><li id="fed5" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nr ly lz ma bi translated">å°†educaion _ levelå’Œjob_typeç»„åˆèµ·æ¥ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º"<strong class="ky ir"> features_combination </strong>"çš„æ–°ç‰¹æ€§ã€‚</li><li id="1b63" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nr ly lz ma bi translated">ä»æ•°æ®é›†ä¸­ç§»é™¤å•ä¸ªè¦ç´ (education_levelå’Œjob_type)ã€‚</li><li id="a759" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nr ly lz ma bi translated">åœ¨åˆ†ç±»ç‰¹å¾åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªåä¸ºâ€œ<strong class="ky ir">feature _ combination</strong>çš„æ–°ç‰¹å¾ï¼Œé€šè¿‡<strong class="ky ir"> One Hot Encoding </strong>è¿›è¡Œè½¬æ¢ã€‚</li></ul><p id="7a19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">æ³¨æ„:</strong>æˆ‘åªé€‰æ‹©äº†åä¹‰åˆ†ç±»ç‰¹å¾(æœ‰2ä¸ªä»¥ä¸Šçš„å”¯ä¸€å€¼)ã€‚</p><p id="b791" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ä¸ºç¬¬ä¸€ä¸ªå®éªŒé‡æ–°è®­ç»ƒé€»è¾‘å›å½’åˆ†ç±»å™¨åï¼Œæ¨¡å‹æ€§èƒ½ä»<strong class="ky ir"> 0.8874 </strong>æé«˜åˆ°<strong class="ky ir"> 0.8882 </strong>ã€‚è¿™è¡¨æ˜ç»„åˆåˆ†ç±»ç‰¹å¾å¯ä»¥æé«˜æ¨¡å‹æ€§èƒ½ã€‚è¯·è®°ä½ï¼Œæˆ‘ä»¬æ²¡æœ‰æ”¹å˜ä»»ä½•ä¸œè¥¿ï¼Œå¦‚æœºå™¨å­¦ä¹ åˆ†ç±»å™¨ä¸­çš„è¶…å‚æ•°ã€‚</p><h1 id="839d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">ç¬¬äºŒä¸ªå®éªŒ:ç»“åˆä¸å¤´éƒ¨çš„å…³ç³»å’Œå©šå§»çŠ¶å†µç‰¹å¾</h1><p id="a71d" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">åœ¨æˆ‘ä»¬çš„ç¬¬äºŒä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ç»“åˆå¦å¤–ä¸¤ä¸ªåˆ†ç±»ç‰¹å¾ï¼Œå®ƒä»¬æ˜¯<strong class="ky ir">ä¸å¤´éƒ¨çš„å…³ç³»</strong>å’Œ<strong class="ky ir">å©šå§»çŠ¶å†µ</strong>ã€‚</p><p id="1182" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬åªéœ€è¦æ›´æ–°é¢„å¤„ç†å‡½æ•°(å°±åƒç¬¬ä¸€ä¸ªå®éªŒä¸€æ ·)ï¼Œç„¶åè¿è¡Œå‰©ä¸‹çš„ä»£ç ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="1d59" class="ni mh iq ne b gy nj nk l nl nm"># function to preprocess our data </span><span id="6d0a" class="ni mh iq ne b gy nn nk l nl nm">def preprocessing_data(data):</span><span id="97cb" class="ni mh iq ne b gy nn nk l nl nm">    # Convert the following numerical labels from integer to float<br/>    float_array = data[["household_size", "age_of_respondent", "year"]].values.astype(<br/>        float<br/>    )<br/>    <br/>    # combine some cat features <br/>    data["features_combination"] = (data.relationship_with_head.astype(str) + "_"<br/>                           + data.marital_status.astype(str) <br/>                      )<br/>    # remove individual features that are combined together<br/>    data = data.drop(['relationship_with_head','marital_status'], axis=1)<br/></span><span id="9f44" class="ni mh iq ne b gy nn nk l nl nm">    # categorical features to be converted by One Hot Encoding<br/>    categ = [<br/>        "features_combination",<br/>        "education_level",<br/>        "job_type",<br/>        "country",<br/>    ]</span><span id="5f90" class="ni mh iq ne b gy nn nk l nl nm">    # One Hot Encoding conversion<br/>    data = pd.get_dummies(data, prefix_sep="_", columns=categ)</span><span id="5a11" class="ni mh iq ne b gy nn nk l nl nm">    # Label Encoder conversion<br/>    data["location_type"] = le.fit_transform(data["location_type"])<br/>    data["cellphone_access"] = le.fit_transform(data["cellphone_access"])<br/>    data["gender_of_respondent"] = le.fit_transform(data["gender_of_respondent"])</span><span id="73bb" class="ni mh iq ne b gy nn nk l nl nm">    # drop uniquid column<br/>    data = data.drop(["uniqueid"], axis=1)</span><span id="a48a" class="ni mh iq ne b gy nn nk l nl nm">    # scale our data <br/>    scaler = StandardScaler()<br/>    data = scaler.fit_transform(data)</span><span id="1b3c" class="ni mh iq ne b gy nn nk l nl nm">    return data</span></pre><p id="a932" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ä¸Šè¿°é¢„å¤„ç†å‡½æ•°ä¸­ï¼Œæˆ‘é€šè¿‡ä»¥ä¸‹æ–¹å¼æ›´æ–°äº†ä»£ç </p><ul class=""><li id="7e78" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nr ly lz ma bi translated">ç»“åˆrelation_with_headå’Œmarriage _ statusåˆ›å»ºä¸€ä¸ªåä¸ºâ€œ<strong class="ky ir"> features_combination </strong>â€çš„æ–°ç‰¹å¾ã€‚</li><li id="7a53" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nr ly lz ma bi translated">ä»æ•°æ®é›†ä¸­ç§»é™¤å•ä¸ªè¦ç´ (relation_with_headå’Œmarriage _ status)ã€‚</li><li id="b34b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nr ly lz ma bi translated">åœ¨åˆ†ç±»ç‰¹å¾åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªåä¸ºâ€œ<strong class="ky ir"> feature_combination </strong>çš„æ–°ç‰¹å¾ï¼Œé€šè¿‡<strong class="ky ir"> One Hot Encoding </strong>è¿›è¡Œè½¬æ¢ã€‚</li></ul><p id="efaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ä¸ºç¬¬äºŒä¸ªå®éªŒé‡æ–°è®­ç»ƒé€»è¾‘å›å½’åˆ†ç±»å™¨ä¹‹åï¼Œæ¨¡å‹æ€§èƒ½ä»<strong class="ky ir"> 0.8874 </strong>ä¸‹é™åˆ°<strong class="ky ir"> 0.8865 </strong>ã€‚è¿™è¡¨æ˜ï¼Œæœ‰æ—¶å½“ä½ ç»“åˆåˆ†ç±»ç‰¹å¾æ—¶ï¼Œä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸ä¼šåƒä½ é¢„æœŸçš„é‚£æ ·æ”¹å–„ã€‚å› æ­¤ï¼Œä½ å°†éœ€è¦è¿è¡Œå¤§é‡çš„å®éªŒï¼Œç›´åˆ°ä½ ä»ä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­è·å¾—ä»¤äººæ»¡æ„çš„æ€§èƒ½ã€‚</p><h1 id="9cb4" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">åŒ…æ‰</h1><p id="1ebe" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨äº†è§£äº†å¦‚ä½•ç»„åˆæ•°æ®é›†ä¸­çš„åˆ†ç±»ç‰¹å¾ï¼Œä»¥æé«˜æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½ã€‚æ­£å¦‚æˆ‘æ‰€è¯´çš„ï¼Œä¸ºäº†è®©æ‚¨çš„æ¨¡å‹è·å¾—ä»¤äººæ»¡æ„çš„æ€§èƒ½ï¼Œæ‚¨éœ€è¦æ‹¥æœ‰å…³äºæ‚¨æ­£åœ¨è§£å†³çš„é—®é¢˜çš„é¢†åŸŸçŸ¥è¯†ã€‚æ­¤å¤–ï¼Œæ‚¨éœ€è¦è¿è¡Œå¤§é‡éœ€è¦æ›´å¤šè®¡ç®—èµ„æºçš„å®éªŒã€‚</p><p id="e7c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">æ­å–œ</strong>ğŸ‘ğŸ‘ï¼Œä½ å·²ç»åšåˆ°è¿™ç¯‡æ–‡ç« çš„ç»“å°¾äº†ï¼æˆ‘å¸Œæœ›ä½ å­¦åˆ°äº†ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œå¯¹ä½ çš„ä¸‹ä¸€ä¸ªæœºå™¨å­¦ä¹ æˆ–æ•°æ®ç§‘å­¦é¡¹ç›®æœ‰æ‰€å¸®åŠ©ã€‚</p><p id="a90b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœä½ å­¦åˆ°äº†æ–°çš„ä¸œè¥¿æˆ–è€…å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œè¯·åˆ†äº«ç»™å…¶ä»–äººçœ‹ã€‚åœ¨é‚£ä¹‹å‰ï¼Œä¸‹æœŸå¸–å­å†è§ï¼</p><p id="fb4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¹Ÿå¯ä»¥åœ¨Twitter <a class="ae kv" href="https://twitter.com/Davis_McDavid" rel="noopener ugc nofollow" target="_blank"> @Davis_McDavid </a>ä¸Šæ‰¾æˆ‘ã€‚</p><p id="366c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¹‹å‰å‘å¸ƒçš„<a class="ae kv" href="https://hackernoon.com/improve-machine-learning-model-performance-by-combining-categorical-features-g21u34ep" rel="noopener ugc nofollow" target="_blank">æ­¤å¤„</a>ã€‚</p></div></div>    
</body>
</html>