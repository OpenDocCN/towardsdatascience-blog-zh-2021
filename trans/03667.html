<html>
<head>
<title>4 Principles to Learn SQL for Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习数据科学SQL的4个原则</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-principles-to-learn-sql-for-data-science-781520c0e983?source=collection_archive---------21-----------------------#2021-03-25">https://towardsdatascience.com/4-principles-to-learn-sql-for-data-science-781520c0e983?source=collection_archive---------21-----------------------#2021-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="76af" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">提高数据科学技能的技巧</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f9e0d25f7cabf46f8fb72c28d612af39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-MpikqjcFI8jmKQR"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">迈尔在<a class="ae kv" href="https://towardsdatascience.com/s/photos/motivation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener" target="_blank"> Unsplash </a>上拍摄的</p></figure><p id="6140" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不言而喻，编写SQL代码的能力是在任何数据科学岗位上获得成功的必要条件。没有任何证据表明这种情况会很快改变，SQL会一直存在，所以掌握这项技能是一项绝对值得的投资。无论你是在寻找你在数据科学领域的第一份工作，还是在为下一轮就业市场复习你的SQL技能，或者希望提升你的职业生涯，我有四条原则可以帮助你在所有与SQL相关的工作中取得成功。</p><p id="0456" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始吧。</p><h1 id="c91d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak"> 1。在你写任何代码之前，确定正确的粒度</strong></h1><p id="99e7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我说的“谷物”是什么意思</p><blockquote class="mp mq mr"><p id="5593" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">SQL查询的粒度是您希望输出数据集达到的聚合级别。</p></blockquote><p id="eb64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，如果您正在寻找一个聚集日常用户操作的数据集，那么您的“粒度”可以描述为“用户日级别”(<em class="ms">即</em>每行代表每个用户每天采取的操作。)</p><p id="9da2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">提前考虑这些谷物是个好主意，主要有两个原因。</p><h2 id="14c9" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">首先，它帮助您规划查询的结构</h2><p id="4a1d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当你进入数据科学就业市场时，这一点尤其重要，因为在这个过程中，求职者经常被要求现场编写SQL代码。在开始编码之前，为你的问题建立一个心理框架将有助于以一种清晰、有效的方式得到答案，给面试官留下深刻印象。</p><h2 id="b17e" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">其次，它可以帮助您识别代码中的明显错误</h2><p id="d047" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">通常，您会有一些关于您编写的查询预期返回的行数的上下文。例如，假设我的计划谷物处于“用户”级别，我知道我们有~ 1000个用户。当我的查询返回一个有100，000行的数据集时，我立即知道我的查询中的一个或多个连接有问题。</p><h1 id="35d6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak"> 2。格式问题</strong></h1><p id="2258" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">SQL是一种语言，我们的查询讲述了一个故事。让我们把它变成一个我们未来的自己和同事们都能轻松阅读的故事。一些快速检查的查询不需要原始的格式，但是任何有可能被其他人或未来自己读取的查询都应该遵循一致的模式。下面是一个简单但格式良好的查询示例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/0946945b839205498090649f7d406f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y3vu3XcxMKSVULQS"/></div></div></figure><p id="5c91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将注意到我在这里特意选择的一些风格。</p><ul class=""><li id="86bb" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">所有关键字都是大写的</li><li id="c904" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">新行上的关键字右对齐。它们的后续表达式是左对齐的</li><li id="04cb" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">每个表都有一个简单但有意义的别名</li><li id="5b51" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">列号用于GROUP BY和ORDER BY子句中。我知道有些人认为这是“懒惰”的方式，但是速度的好处和按别名列干净地分组比不尽可能显式的代价更重要。例如，如果我想在GROUP BY子句中使用列名，我必须执行以下操作(大多数情况下是这样的，一些数据库允许在GROUP BY中使用别名)</li></ul><p id="383b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于SQL格式化有很多<a class="ae kv" href="https://stackoverflow.com/questions/519876/sql-formatting-standards" rel="noopener ugc nofollow" target="_blank">观点，我不认为其中有一个明显的赢家。选一个就好，要始终如一。</a></p><h1 id="976e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak"> 3。使用cte，而不是子查询</strong></h1><p id="3a15" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">cte或<a class="ae kv" href="https://mode.com/blog/use-common-table-expressions-to-keep-your-sql-clean/" rel="noopener ugc nofollow" target="_blank">公共表表达式</a>，是临时数据集，可以在给定查询的后续SQL语句中引用。cte最好用一个例子来解释。下面的查询标识了从他们的第一个订单到100，000美元订单最快的销售代表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/17f368538860c43d75f85d2e9e33d1a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lyowsdSAUT8X5rTZ9bF8_Q.png"/></div></div></figure><p id="0bde" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来分解这个查询的组件</p><ul class=""><li id="3c52" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">首先，您会注意到带有。所有使用CTE的查询都必须在第一个CTE之前包含此语句。</li><li id="4d8b" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">第一个订单日是我们的第一个CTE。它定义了一个数据集，查找销售代表完成订单的第一天。first_order_day可以在后续表达式中引用，就像引用数据库中的任何其他表一样。</li><li id="50a5" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">接下来，我们定义另一个CTE，运行订单值。这将计算每个销售代表的销售总额。</li><li id="06b8" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">最后，我们引用两个cte来返回对应于最短time_to_goal值的行。</li></ul><p id="0dc3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<a class="ae kv" href="https://mode.com/sql-tutorial/sql-sub-queries/" rel="noopener ugc nofollow" target="_blank">子查询</a>编写的查询可以使用cte重写，我建议这样做——cte更干净，对您的同事和未来的自己来说更容易理解。使用子查询，我们可以看到上面的查询是什么样子的。势不可挡，对吧？</p><blockquote class="mp mq mr"><p id="05c7" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">通过使用cte，我们可以获得相同的结果，并改善可读性和逻辑流程。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/e6d37d72b366db33fb1b01f6cf418c87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hnDNy6CWU1wZizmNVcYJYg.png"/></div></div></figure><h1 id="087d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.用代码注释讲述一个故事</h1><p id="5454" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">最终，SQL现在被视为软件工程中使用的编程语言，那么为什么不像其他语言一样遵循相同的注释约定呢(<em class="ms">例如</em> <a class="ae kv" href="https://www.python.org/dev/peps/pep-0008/#comments" rel="noopener ugc nofollow" target="_blank"> python </a>)。我相信这很大程度上是因为人们学习SQL的方式。虽然软件工程中使用的大多数编程语言都是在牢记这些约定的情况下教授的，但SQL通常是在事后才教授的。它通常被视为达到目的的手段(<em class="ms">即</em>数据集→分析)。</p><blockquote class="mp mq mr"><p id="699d" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">然而，我们在分析中做出的一些最关键的决定发生在SQL查询中，我们应该向我们自己、利益相关者以及那些通过描述性注释来解释我们的意图的人解释这些决定。</p></blockquote><p id="0967" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特别是，在更复杂的查询中，注释对于全面的分析非常有益。</p><h2 id="b1d7" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">他们帮助未来的你和你的代码审查者理解你的意图</h2><p id="b146" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这为我们自己和我们的同事节省了时间，也避免了重读或审查代码时的麻烦。当我们生成用于分析的数据集时，数据科学家这样做是有最终目标的(<em class="ms">例如</em>)我们希望看到过去6个月中登录用户对帮助网站的所有访问。)记录我们打算对我们的查询做什么，有助于指导我们编写我们的查询，并帮助审阅者检查我们工作的准确性。</p><h2 id="e479" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">它记录了对数据的假设</h2><p id="088a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Garbage_in,_garbage_out" rel="noopener ugc nofollow" target="_blank">Garbage in Garbage Out</a>(GIGO)是执行分析时应该首先考虑的一个表达式。简而言之，如果你输入一个分析或建模的无意义数据，你将得到无意义的结果。</p><p id="bd1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一点很重要，因为原始数据在用于分析之前需要建模和聚合。这种情况在某种程度上发生在SQL中(随着像<a class="ae kv" href="https://www.getdbt.com/" rel="noopener ugc nofollow" target="_blank"> dbt </a>这样的工具的出现，情况更是如此)。因此，当你对你的数据做出假设，或者选择一种类型的聚合(<em class="ms">例如</em>使用中位数对平均值<em class="ms">)，</em>在你的代码注释中解释<em class="ms">为什么</em>你这样做。没有什么比无法向同事或利益相关者解释为什么在查询中包含一个表达式更糟糕的了。</p><h1 id="ce1e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">这完全是信任的问题</h1><p id="4ac1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">最终，这四条原则都植根于一个理念，即信任是数据科学家拥有的最重要的资产。在学习和编写SQL时遵循这四个原则将有助于你赢得从面试官到同事和利益相关者的信任。</p><p id="ff22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">专业提示:</strong>如果你是SQL新手，或者想提高你的技能，我认为来自Mode Analytics的<a class="ae kv" href="https://mode.com/sql-tutorial/" rel="noopener ugc nofollow" target="_blank"> SQL学校</a>是最好的免费资源。看看吧！</p></div></div>    
</body>
</html>