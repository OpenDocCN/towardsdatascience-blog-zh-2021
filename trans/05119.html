<html>
<head>
<title>A visual guide to multidimensional NumPy array aggregation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多维数组聚合的可视化指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-visual-guide-to-multidimensional-numpy-array-aggregation-97a8960b3c59?source=collection_archive---------18-----------------------#2021-05-05">https://towardsdatascience.com/a-visual-guide-to-multidimensional-numpy-array-aggregation-97a8960b3c59?source=collection_archive---------18-----------------------#2021-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a16f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">思考轴编号的直观方式</h2></div><p id="bbe6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您刚刚学习使用NumPy中的聚合函数，如sum、mean或median，理解轴参数的作用可能会很困难。在接下来的文章中，我提供了一个直观的轴编号指南，这样你就可以确保你的代码按照预期工作。</p><p id="8e4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">聚集一维数组很简单，因为只需要考虑一个轴。然而，对于2维或更多维，我们必须考虑我们希望聚合数组的方向。在本指南中，我们将使用numpy.sum()函数讨论一维、二维和三维问题。<em class="lb">(注意:其他聚合函数如mean、median、amin、amax使用相同的逻辑。)</em></p><h1 id="51f9" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">维度缩减和轴编号</h1><p id="1a17" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我们可以将沿单个轴的聚合视为将数组的维度减少一个。如果我们聚集一个一维数组，我们得到一个单点。如果我们聚集一个二维数组，我们得到一个一维数组，以此类推。如果我们有多个维度，我们必须决定要消除哪个维度(或轴)。在NumPy中，这可以通过在函数调用中指定axis参数来实现。</p><p id="b2b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">让我强调一下:当您设置参数时，您选择了您想要消除的维度。</strong></p><p id="a56e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于轴编号，我们必须知道的是<strong class="kh ir">索引总是从最高尺寸开始。</strong>每增加一个维度，新维度的索引为0，其他所有索引都增加1。我们将在下面的示例中详细了解这一点。NumPy中axis参数的默认值是<em class="lb"> None，</em>在这种情况下，数组被展平，然后被聚合。</p><p id="fb3e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">提示:如果你不确定你有多少个维度，但你想选择最低的，你可以使用负索引。例如，axis=-1将消除最低的维度。</em></p><h1 id="6443" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">聚集一维数组</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="f246" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; a = numpy.array([1,2])</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/f0577636f06b99ad08562658a25dedef.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*bbSHk-whcafLdawvFNSMnA.png"/></div></figure><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="3043" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; numpy.sum(a, axis=0)<br/>3</span></pre><p id="f1a1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个简单的例子中，只有一个维度可以用来聚集数组。这个维度是第0个维度，即第0个轴。<em class="lb">(不需要指定轴参数，因为展平的二维数组本身就是。)</em></p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/f5253c2df0226dfeea85164e929f3c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*amBJxxQeCcVHNV03fBYhdw.png"/></div></figure><h1 id="2210" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">聚集二维数组</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="fbb4" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; b = numpy.array([[1,2],[3,4]])</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/e4e4308431355095d39ab33d249511cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*5HQJ1NyQTkUyDXZ7OShH8A.png"/></div></figure><p id="b57b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本例中，我们在前面的数组中添加了第二个一维数组，创建了一个二维数组。<strong class="kh ir">请注意，添加的维度是最高的，因此将具有索引0，而先前的将具有索引1。</strong></p><p id="c895" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们可以选择是消除第0维并沿其垂直轴折叠数组，还是消除第一维并沿其水平轴折叠数组。让我们两个都看:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="de00" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; numpy.sum(b, axis=0)<br/>array([4,6])</span></pre><p id="c5e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当<em class="lb">轴=0 </em>时，我们希望消除第0维。我们通过沿其纵轴折叠阵列来实现这一点。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/efbc2b61a1f1c0c047dbbd19b9185b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*QEoTcvMCuLv1DKOjIMRplQ.png"/></div></figure><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="f62b" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; numpy.sum(b, axis=1)<br/>array([3,7])</span></pre><p id="4b75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">按照同样的逻辑，这里我们消除了第一维，并沿其水平轴折叠数组。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/22007b7eab3874b72112a5bf240a9dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*H7WLi5CM8Brapt85WEtHFg.png"/></div></figure><h1 id="454d" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">聚集三维数组</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="022f" class="mi ld iq me b gy mj mk l ml mm">c = numpy.array([[[1,2],[3,4]],[[5,6],[7,8]]])</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d1e76f4d694852b56417b444ac966fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*3IKtbHntVbX5cr18Xj-u-g.png"/></div></figure><p id="6937" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个三维示例中，我们只需将一个二维数组添加到前面的数组中，创建一个shape(2，2，2)的三维数组。<strong class="kh ir">这个添加的维度将是最高的，因此它的索引为0，而所有其他的索引都增加1。</strong>因为我们有三个维度，所以聚合数组时有三个选项需要考虑。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="a500" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; numpy.sum(c, axis=0)<br/>array([[6,8],[10,12]])</span></pre><p id="ac05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<em class="lb">轴=0 </em>，我们指定希望删除最高维度(我们刚刚添加的维度)。我们可以通过折叠三维阵列的两个“层”来实现这一点。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/bd65e1339706015faf05dc3fcaa2cd9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*zR_3vpJ9NpNAa0wj1-cjyg.png"/></div></figure><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="e6b4" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; numpy.sum(c, axis=1)<br/>array([[4,6],[12,14]])</span></pre><p id="6ccb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着<em class="lb">轴=1 </em>我们希望消除第一维。我们通过沿垂直轴折叠两个二维数组(层)来实现这一点。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mx"><img src="../Images/52030957ca43f51c90e7560bb2f8ee77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4od3vQ8W6J0KMOHc3-JzA.png"/></div></div></figure><p id="85fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们将形状(2，2，2)的数组简化为形状(2，1，2)的数组。请注意，NumPy将完全消除大小为1的维度，并输出一个较低维度的shape(2，2)数组，如我的图表的第三阶段所示，除非您设置<em class="lb"> keepdims=True。</em></p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="d7d4" class="mi ld iq me b gy mj mk l ml mm">&gt;&gt;&gt; numpy.sum(c, axis=2)<br/>array([[3,7],[11,15]])</span></pre><p id="f56d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于<em class="lb">轴=2 </em>，我们希望消除第二维。我们通过沿水平轴折叠两个二维数组(层)来实现这一点。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nc"><img src="../Images/ccf9098d39b8c6663bf8292fc497e3cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KmhV9-QVTRNiv0LyvO4CJg.png"/></div></div></figure><p id="be03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与前面的例子类似，我们得到了shape(2，2，1)的数组，但是NumPy默认会输出shape(2，2)的低维数组。</p><h1 id="607d" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">需要记住的要点</h1><ol class=""><li id="9c72" class="nd ne iq kh b ki lu kl lv ko nf ks ng kw nh la ni nj nk nl bi translated">您可以将聚合视为降低数组的维度</li><li id="c676" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">当您选择一个轴时，您实际上设置了您希望消除的尺寸</li><li id="a5db" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">索引总是从最高的维度开始</li></ol><h1 id="9697" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">参考</h1><p id="5e85" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">SciPy社区，<a class="ae nr" href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html" rel="noopener ugc nofollow" target="_blank"> NumPy v1.20手册</a></p><p id="4c1a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">(所有图片均由作者创作并拥有。)</em></p></div></div>    
</body>
</html>