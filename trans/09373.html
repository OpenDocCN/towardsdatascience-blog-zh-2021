<html>
<head>
<title>How to Find Weaknesses in your Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在你的机器学习模型中找到弱点</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-find-weaknesses-in-your-machine-learning-models-ae8bd18880a3?source=collection_archive---------13-----------------------#2021-08-31">https://towardsdatascience.com/how-to-find-weaknesses-in-your-machine-learning-models-ae8bd18880a3?source=collection_archive---------13-----------------------#2021-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d543" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">FreaAI:来自IBM研究人员的新方法</h2></div><p id="a707" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">任何时候使用汇总统计简化数据，都会丢失信息。模型精度也不例外。当将模型简化为汇总统计数据时，您将无法确定哪里的性能最低/最高以及原因。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/54d7880f77ab84605c70b6e7482cb64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*roow3Fua4iDpAMO5aZoFsw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图1:模型性能较低的数据区域示例。图片作者。</p></figure><p id="894b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这个问题，IBM的研究人员最近开发了一种叫做<a class="ae lr" href="https://arxiv.org/pdf/2108.05620.pdf" rel="noopener ugc nofollow" target="_blank"> FreaAI </a>的方法，可以识别给定模型准确性较差的可解释数据切片。从这些切片中，工程师可以采取必要的步骤来确保模型按预期运行。</p><p id="c6a8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不幸的是，FreaAI不是开源的，但是许多概念可以很容易地在您喜欢的技术栈中实现。让我们开始吧…</p><h1 id="d08d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">技术TLDR</h1><p id="de57" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">FreaAI在测试数据中找到具有统计显著低性能的切片。它们被返回给工程师检查。方法步骤如下:</p><ol class=""><li id="06d7" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated"><strong class="kh ir">使用最高先验密度(HPD)方法寻找低精度的单变量数据切片。</strong>这些单变量数据切片缩小了搜索空间，并显示了我们的数据在哪里更有可能出现问题。</li><li id="4287" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated"><strong class="kh ir">使用决策树寻找低精度的二元数据切片。</strong>这些双变量数据切片减少了分类预测因子和二阶相互作用的搜索空间，以显示我们的数据在哪里更有可能出现问题。</li><li id="639b" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated"><strong class="kh ir">删除所有不符合特定启发式规则的数据切片。</strong>主要的两个是测试集的最小支持度和误差的统计显著增加。</li></ol><h1 id="6c88" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">但是，到底是怎么回事呢？</h1><p id="05fd" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">这是一大堆术语，所以让我们慢一点，真正理解发生了什么…</p><h1 id="ec87" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.问题是</h1><p id="8c9a" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">当开发一个模型时，我们经常使用“准确性”度量来确定适合度。一个例子是均方误差，用于线性回归，如图2所示。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/70fcdfdf8e971098926c79d44a8efb43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*GwhqVLE8kFJ0lUKpEKHazA.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图2:均方误差公式。图片作者— <a class="ae lr" href="https://www.probabilitycourse.com/chapter9/9_1_5_mean_squared_error_MSE.php" rel="noopener ugc nofollow" target="_blank"> src </a>。</p></figure><p id="f97b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是这个平均误差仅仅告诉我们平均起来我们做的有多好。我们不知道我们是否在数据的某些方面表现得很好，或者在其他方面表现得很差。</p><p id="18d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是预测建模中一个长期存在的问题，最近得到了很多关注。</p><h1 id="e16c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.解决方案</h1><p id="abe0" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">一种解决方案是FreaAI。该方法由IBM开发，旨在确定我们的模型在数据中表现不佳的地方。</p><p id="c2de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有两个主要步骤。第一步涉及创建数据切片，第二步涉及确定模型在这些数据切片中是否表现不佳。FreaAI的输出是我们数据中模型性能较低的一组“位置”。</p><h2 id="8d2d" class="ne lt iq bd lu nf ng dn ly nh ni dp mc ko nj nk me ks nl nm mg kw nn no mi np bi translated"><strong class="ak"> 2.1。数据切片</strong></h2><p id="dc6a" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">组合测试(CT)是一个框架，它依次查看所有预测器组，以找到表现不佳的区域。例如，如果我们有两个分类预测值，颜色和形状，我们会查看所有可能的组合，看看准确性在哪里下降。</p><p id="84e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，在大型数据集上利用组合测试在计算上是不可能的——随着每个新列的出现，我们看到所需的组合数量呈指数级增长。因此，我们需要定义一种方法来帮助我们搜索特性，找到潜在的不准确的地方。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nq"><img src="../Images/62ce33086aa79b1c3acf0424c4e90516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JTxPgp3obLWzcH6zGdhjsA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图3:蓝色的50%最高密度区域(HDR)的例子。图片作者——<a class="ae lr" href="https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio" rel="noopener ugc nofollow" target="_blank">src</a>。</p></figure><p id="c780" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FreaAI使用的第一种方法是所谓的<a class="ae lr" href="https://stats.stackexchange.com/questions/148439/what-is-a-highest-density-region-hdr" rel="noopener ugc nofollow" target="_blank">最高密度区域(HDR) </a>(图3)。简而言之，HDR找到了数字特征中可以找到一定比例数据的最小区域，即高密度区域。在图3中，该区域由水平蓝色虚线区分，50%的数据位于该线之上。</p><p id="f828" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这里开始，我们将这个范围迭代地减小一个值ε(默认为0.05)，并寻找精度的增加。<strong class="kh ir">如果在给定的迭代中精度确实增加了，我们知道该模型在前一次迭代和当前迭代之间的区域中表现不好。</strong></p><p id="9fc7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了确定数值预测因子的不良拟合区域，我们对测试集中的所有预测因子反复运行HDR方法。</p><p id="5324" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很酷，对吧？</p><p id="c4d0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二种方法利用决策树来处理所有非数字预测器以及两种特征的组合。简而言之，我们拟合一个决策树，并寻找这些特征的哪些分裂降低了准确性。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nr"><img src="../Images/7340db15eacfef257208f98db497281a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3NBNHf6x4-nsYPJuvdw5bg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图4:连续单变量预测因子“年龄”的决策树示例。图片作者。</p></figure><p id="bc06" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在图4中，每个<em class="ns">决策节点</em>(蓝色)是我们特征的一个分割，每个<em class="ns">结束节点</em>(数字)是该分割的精度。通过拟合这些树，我们可以真正减少搜索空间，更快地找到性能差的区域。<strong class="kh ir">此外，因为树对于许多不同种类的数据都非常稳健，所以我们可以对分类预测器或多个预测器进行分析，以捕捉交互效应。</strong></p><p id="2a56" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种决策树方法对所有特征组合以及非数字的单个特征重复进行。</p><h2 id="6cb2" class="ne lt iq bd lu nf ng dn ly nh ni dp mc ko nj nk me ks nl nm mg kw nn no mi np bi translated">2.2.数据切片的试探法</h2><p id="64d5" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">到目前为止，我们只关心使用准确性开发数据切片，但是还有其他启发方法可以帮助我们找到<strong class="kh ir">有用的</strong>数据切片:</p><ol class=""><li id="1dc6" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated"><strong class="kh ir">统计显著</strong>:为了确保我们只查看准确性有意义下降的数据切片，我们只保留性能比我们的误差置信区间的下限低4%的切片。通过这样做，我们可以用概率<em class="ns"> α </em>声明我们的数据切片具有更高的误差。</li><li id="745f" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated"><strong class="kh ir">可解释的</strong>:我们也想确保发现的有问题的地方可以被采取行动，所以我们在创建组合时只看两三个特征。通过限制低阶交互，我们的工程师有更大的机会开发解决方案。</li><li id="4577" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated"><strong class="kh ir">最小支持度</strong>:最后，数据切片必须有足够的误差才值得研究。我们要求必须至少有2个错误分类，或者它必须覆盖5%的测试误差——无论哪个值更大都是我们采用的标准。</li></ol><p id="b82e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有趣的是，您可以根据自己的业务需求定制其他启发式方法。对一些用户进行错误分类比其他用户更糟糕，因此您可以将这一点纳入您的数据切片标准——想想<a class="ae lr" rel="noopener" target="_blank" href="/accuracy-precision-recall-or-f1-331fb37c5cb9">精度/召回权衡</a>。</p><h1 id="bba8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.总结和要点</h1><p id="0941" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">所以，这就是你要的——荣耀的法国。</p><p id="624a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还是那句话，FreaAI不是开源的，但希望它将来会向公众发布。与此同时，您可以将我们讨论的框架应用到您自己的预测模型中，并确定哪里存在系统性的表现不佳。</p><h2 id="1a00" class="ne lt iq bd lu nf ng dn ly nh ni dp mc ko nj nk me ks nl nm mg kw nn no mi np bi translated">3.1.摘要</h2><p id="5ae3" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">概括地说，FreeAI使用HDR和决策树来减少预测器的搜索空间。然后，它反复查看单个特性以及组合，以确定哪里的性能较低。这些低性能领域有一些额外的启发，以确保调查结果是可操作的。</p><h2 id="cc51" class="ne lt iq bd lu nf ng dn ly nh ni dp mc ko nj nk me ks nl nm mg kw nn no mi np bi translated">3.2.你为什么要在乎？</h2><p id="8d2b" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">首先，这个框架帮助工程师识别模型的弱点。当这些弱点被发现时，它们可以(有希望)被纠正，从而改进预测。这种增益对于黑盒模型(如神经网络)特别有吸引力，因为没有模型系数。</p><p id="6415" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">通过隔离表现不佳的数据区域，我们获得了一个了解黑盒的窗口。</strong></p><p id="d8a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FreaAI在其他应用方面也有着令人感兴趣的潜力。一个例子是识别模型漂移，这是当经过训练的模型随着时间变得越来越不有效时发生的情况。IBM刚刚发布了一个用于确定模型漂移的假设测试框架。</p><p id="9383" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个有趣的应用是确定模型偏差。在这种情况下，偏见是不公平的概念，例如基于性别拒绝给某人贷款。通过查看模型性能较低的不同数据分割，您可能会发现存在偏差的区域。</p></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><p id="4d54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ns">感谢阅读！我会再写37篇文章，把学术研究带到DS行业。查看我的评论，链接到这篇文章的主要来源以及一些有用的资源。</em></p></div></div>    
</body>
</html>