<html>
<head>
<title>Statistics in Python — Using Chi-Square for Feature Selection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的统计数据-使用卡方进行要素选择</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/statistics-in-python-using-chi-square-for-feature-selection-d44f467ca745?source=collection_archive---------1-----------------------#2021-10-11">https://towardsdatascience.com/statistics-in-python-using-chi-square-for-feature-selection-d44f467ca745?source=collection_archive---------1-----------------------#2021-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/aa8e054914fdff46fbe5167bb6f9b1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hbflHdgUggjmGMor"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">萨姆·穆卡达姆在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6351" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我之前的两篇文章中，我谈到了如何测量数据集中各列之间的相关性，以及如何检测它们之间的多重共线性:</p><div class="le lf gp gr lg lh"><a rel="noopener follow" target="_blank" href="/statistics-in-python-understanding-variance-covariance-and-correlation-4729b528db01"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">Python中的统计学-了解方差、协方差和相关性</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">理解你的数据之间的关系，知道皮尔逊相关系数和…</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">towardsdatascience.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv jz lh"/></div></div></a></div><div class="le lf gp gr lg lh"><a rel="noopener follow" target="_blank" href="/statistics-in-python-collinearity-and-multicollinearity-4cc4dcd82b3f"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">Python中的统计数据-共线性和多重共线性</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">了解如何发现数据集中的多重共线性</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">towardsdatascience.com</p></div></div><div class="lq l"><div class="lw l ls lt lu lq lv jz lh"/></div></div></a></div><p id="4f81" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，当你试图比较的变量是<em class="lx">连续的</em>时，这些技术是有用的。如果你的变量是<em class="lx">分类的</em>，你如何比较它们？在本文中，我将向您解释如何测试数据集中的两个分类列，以确定它们是否相互依赖(即相关)。我们将使用一个称为<strong class="ki iu">卡方</strong>的统计检验(通常写成<strong class="ki iu"> <em class="lx"> χ </em> 2 </strong>)。</p><p id="ce4a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们开始讨论卡方之前，这里有一个可用于测试各种变量的测试方法的快速总结:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/903ddfb098d0f844bdc69109411b2f78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bB56fmAsXp9FKcfCsv9P1g.png"/></div></div></figure><h1 id="a3ff" class="md me it bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">使用卡方统计确定两个分类变量是否相关</h1><p id="606e" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated"><strong class="ki iu">卡方(<em class="lx"> χ </em> 2)统计</strong>是一种检查<strong class="ki iu"> <em class="lx">两个分类名义变量</em> </strong>之间关系的方法。</p><blockquote class="ng nh ni"><p id="6239" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated"><strong class="ki iu">名义</strong>变量包含没有内在排序的值。名义变量的例子有性别、种族、眼睛颜色、肤色等。<strong class="ki iu">序数</strong>变量，另一方面，包含有排序的值。顺序变量的例子有年级、教育水平、经济状况等。</p></blockquote><p id="a9cb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">卡方检验背后的关键思想是将数据中的观察值与期望值进行比较，看它们是否相关。特别是，这是检查两个分类名义变量是否相关的有用方法。这在机器学习中尤其重要，在机器学习中，您只希望将与目标相关的特征用于训练。</p><p id="b771" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">卡方检验有两种类型:</p><ul class=""><li id="b694" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated"><strong class="ki iu">卡方拟合优度检验</strong> —检验一个变量是否可能来自给定的分布。</li><li id="32c6" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated"><strong class="ki iu">独立性卡方检验</strong> —检验两个变量是否相关。</li></ul><blockquote class="ng nh ni"><p id="66fa" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">查看<a class="ae kf" href="https://www.jmp.com/en_us/statistics-knowledge-portal/chi-square-test.html" rel="noopener ugc nofollow" target="_blank">https://www . jmp . com/en _ us/statistics-knowledge-portal/chi-square-test . html</a>以获得关于上述两个卡方测试的更详细讨论。</p></blockquote><p id="5871" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当比较两个分类变量是否相关时，您将使用独立的<strong class="ki iu">卡方检验。</strong></p><h1 id="4cd6" class="md me it bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">执行卡方检验的步骤</h1><p id="609d" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">要使用卡方检验，您需要执行以下步骤:</p><ol class=""><li id="dfab" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld oa ns nt nu bi translated">定义你的<em class="lx">零假设</em>和<em class="lx">替代假设</em>。它们是:</li></ol><ul class=""><li id="0877" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated"><strong class="ki iu"> H₀ </strong> ( <em class="lx">零假设</em> ) —被比较的两个分类变量相互独立<strong class="ki iu"/>。</li><li id="5cf1" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated"><strong class="ki iu"> H₁ </strong> ( <em class="lx">替代假设</em> ) —被比较的两个分类变量<strong class="ki iu">相互依赖</strong>。</li></ul><p id="9df2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.决定<strong class="ki iu"> α </strong>值。这是你愿意承担的得出错误结论的风险。举例来说，假设在测试独立性时，您将<strong class="ki iu"> α </strong> =0.05。这意味着你承担了5%的风险，得出两个变量是独立的结论，而实际上它们并不独立。</p><p id="b18f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.使用两个分类变量计算<strong class="ki iu">卡方</strong> <strong class="ki iu">得分</strong>，并使用它计算<strong class="ki iu"> p值</strong>。一个<strong class="ki iu"> <em class="lx">低</em> </strong> p值意味着你的两个分类变量之间存在一个<strong class="ki iu"> <em class="lx">高</em> </strong>相关性(它们相互依赖)。p值通过卡方评分计算得出。p值将告诉您测试结果是否有意义。</p><blockquote class="ng nh ni"><p id="71ff" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">在卡方分析中，p值是获得与当前实验中一样大或更大的卡方的概率，但数据仍然支持假设。它是仅仅由于偶然因素而偏离预期的可能性。一般来说，0.05或更大的p值被认为是临界的，任何更小的值都意味着偏差是显著的，被测试的假设必须被拒绝。</p><p id="a6d7" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">来源:<a class="ae kf" href="https://passel2.unl.edu/view/lesson/9beaa382bf7e/8" rel="noopener ugc nofollow" target="_blank">https://passel2.unl.edu/view/lesson/9beaa382bf7e/8</a></p></blockquote><p id="76d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要计算p值，您需要两条信息:</p><ul class=""><li id="0c5e" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated"><strong class="ki iu">自由度— </strong>类别数减1</li><li id="0ae1" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated"><strong class="ki iu">卡方评分</strong>。</li></ul><p id="7be5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果获得的p值<strong class="ki iu"> </strong>为:</p><ul class=""><li id="eb2b" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated">&lt; 0.05 (the <strong class="ki iu"> α </strong>你选择的值)你拒绝<strong class="ki iu"> H₀ </strong> ( <em class="lx">零假设</em>)，接受<strong class="ki iu"> H₁ </strong> ( <em class="lx">备择假设</em>)。这意味着两个分类变量是依赖于<em class="lx">的</em>。</li><li id="5bc9" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated">&gt; 0.05你接受<strong class="ki iu"> H₀ </strong> ( <em class="lx">零假设</em>)，拒绝<strong class="ki iu"> H₁ </strong> ( <em class="lx">替代假设</em>)。这意味着这两个分类变量是独立的。</li></ul><blockquote class="ng nh ni"><p id="3a22" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">在机器学习的特征选择的情况下，您可能希望与目标进行比较的特征具有较低的<strong class="ki iu">p值(小于0.05)，因为这意味着该特征依赖于(相关于)目标。</strong></p></blockquote><p id="4d1f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有了计算出来的卡方得分，您还可以使用它来参考<strong class="ki iu">卡方表</strong>来查看您的得分是在拒绝区域还是在接受区域。</p><p id="78f2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的所有步骤听起来都有点模糊，真正理解卡方如何工作的最好方法是看一个例子。在下一节中，我将使用Titanic数据集，并对一些特征进行卡方检验，看看它们是否与目标相关。</p><h1 id="855b" class="md me it bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated"><strong class="ak">在Titanic数据集上使用卡方检验</strong></h1><p id="d435" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">理解一个新话题的好方法是通过一个例子来理解概念。为此，我将使用经典的泰坦尼克号数据集(<a class="ae kf" href="https://www.kaggle.com/tedllh/titanic-train" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/tedllh/titanic-train</a>)。</p><p id="cab8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Titanic数据集通常用于机器学习，以演示如何建立机器学习模型，并使用它进行预测。具体来说，数据集包含几个特征(<strong class="ki iu">p类</strong>、<strong class="ki iu">性别</strong>、<strong class="ki iu">年龄</strong>、<strong class="ki iu">上船</strong>等)和一个目标(<strong class="ki iu">幸存</strong>)。数据集中的几个要素是分类变量:</p><ul class=""><li id="c769" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated"><strong class="ki iu">p class</strong>-乘客所处的客舱等级</li><li id="e95c" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated"><strong class="ki iu">性别</strong>-乘客的性别</li><li id="3133" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated"><strong class="ki iu">登船</strong>——登船港</li><li id="eb73" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated"><strong class="ki iu">幸存</strong>——如果乘客幸免于难</li></ul><p id="16ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为本文探讨了分类特性和目标之间的关系，所以我们只对包含分类值的那些列感兴趣。</p><h2 id="4d08" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">加载数据集</h2><p id="d2cf" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">现在您已经获得了数据集，让我们将它加载到Pandas数据框架中:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="bfd3" class="ob me it oo b gy os ot l ou ov">import pandas as pd<br/>import numpy as np</span><span id="491b" class="ob me it oo b gy ow ot l ou ov">df = pd.read_csv('titanic_train.csv')<br/>df.sample(5)</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ox"><img src="../Images/59fb092a5d3b4e9a4d2fd91237985668.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SzOeIQjQ2W2YigGpjN7Eeg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="1b80" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">数据清理和特征工程</h2><p id="4443" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">有些列并不真正有用，因此我们将删除它们。此外，还有一些丢失的值，所以让我们删除所有那些值为空的行:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="fef0" class="ob me it oo b gy os ot l ou ov">df.drop(columns=['PassengerId','Name', 'Ticket','Fare','Cabin'], <br/>        inplace=True)<br/>df.dropna(inplace=True)<br/>df</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/8297f54328b26819cbf31f9614c052ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*GEhv0ah-2nTtc_YmIuOvZA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="abb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还将在<strong class="ki iu"> Parch </strong>(父母或子女)和<strong class="ki iu"> Sibsp </strong>(兄弟姐妹或配偶)列的基础上，单独添加一个名为<strong class="ki iu">的列</strong>。我们想探究的是独自一人是否会影响乘客的存活率。所以如果<strong class="ki iu"> Parch </strong>和<strong class="ki iu"> Sibsp </strong>都为0，则只有<strong class="ki iu">为1，否则为0:</strong></p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="4e95" class="ob me it oo b gy os ot l ou ov">df['Alone'] = (df['Parch'] + df['SibSp']).apply(<br/>                  lambda x: 1 if x == 0 else 0)<br/>df</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/e990869207a217cd969fccdd07328427.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*fwu8Eqr0JPGv5lW_drprIA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="48ad" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">可视化特征和目标之间的相关性</h2><p id="a106" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">现在，数据已经清理完毕，让我们试着想象一下乘客的性别与他们在事故中的生还率之间的关系:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="d657" class="ob me it oo b gy os ot l ou ov">import seaborn as sns<br/>sns.barplot(x='Sex', y='Survived', data=df, ci=None)     </span></pre><blockquote class="ng nh ni"><p id="66bd" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">性别栏包含名义数据(即排名不重要)。</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/9e74ecf4f17bc06173c3edeef8c25ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*tAAFQa6-q0or7oM9lW_lMg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="3dfe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上图可以看出，所有女乘客中，70%以上生还；在所有的男人中，大约20%活了下来。似乎在<strong class="ki iu">性别</strong>和<strong class="ki iu">幸存</strong>特征之间存在着非常强的联系。为了证实这一点，我们稍后将使用卡方检验来证实这一点。</p><p id="d4d4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> Pclass </strong>和<strong class="ki iu">幸存</strong>怎么样？他们有关系吗？</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="aee8" class="ob me it oo b gy os ot l ou ov">sns.barplot(x='Pclass', y='Survived', data=df, ci=None)</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/297b6734d3de9c5a2a88d855f5611894.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*VmTBKjhYvCJ-WSJnresFGw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="a18e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或许不出所料，这表明乘客所处的<strong class="ki iu">等级</strong>越高，乘客的存活率越高。</p><p id="d97d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一个有趣的特征是，出发地点是否决定了谁能幸存，谁不能:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="5108" class="ob me it oo b gy os ot l ou ov">sns.barplot(x='Embarked', y='Survived', data=df, ci=None)</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/65e106f8beb416c71612fb9e32c33739.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*bL4x4CkEfTjRVxR6sqKm4A.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="0669" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从图表上看，似乎更多从瑟堡出发的人幸存了下来。</p><blockquote class="ng nh ni"><p id="a88c" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">C =瑟堡；Q =皇后镇；S =南安普敦</p></blockquote><p id="d826" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你还想知道独自旅行是否会让一个人更有生存能力:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="cd16" class="ob me it oo b gy os ot l ou ov">ax = sns.barplot(x='Alone', y='Survived', data=df, ci=None)    <br/>ax.set_xticklabels(['Not Alone','Alone'])</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/bdae623593d5d1ab8dc01999ed1fbfd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*5qN00RDpTxlif-eBfpO2oA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="87b5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以看到，如果一个人与他们的家人在一起，他/她将有更高的生存机会。</p><h2 id="50fa" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">可视化每个特征之间的相关性</h2><p id="89f1" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">既然我们已经可视化了分类特征与目标之间的关系(<strong class="ki iu">幸存</strong>)，我们现在想要可视化每个特征之间的关系。在此之前，您需要将<strong class="ki iu"> Sex </strong>和<strong class="ki iu">abowed</strong>列中的标签值转换为数值。为此，您可以使用<strong class="ki iu"> sklearn </strong>中的<strong class="ki iu"> LabelEncoder </strong>类:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="830a" class="ob me it oo b gy os ot l ou ov">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="6797" class="ob me it oo b gy ow ot l ou ov">from sklearn import preprocessing<br/>le = preprocessing.LabelEncoder()<br/>le.fit(df['Sex'])<br/>df['Sex'] = le.transform(df['Sex'])<br/>sex_labels = dict(zip(le.classes_, le.transform(le.classes_)))<br/>print(sex_labels)</span><span id="f615" class="ob me it oo b gy ow ot l ou ov">le.fit(df['Embarked'])<br/>df['Embarked'] = le.transform(df['Embarked'])<br/>embarked_labels = dict(zip(le.classes_, <br/>                      le.transform(le.classes_)))<br/>print(embarked_labels)</span></pre><p id="bdc5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的代码片段对<strong class="ki iu">性别</strong>和<strong class="ki iu">着手</strong>列进行了标签编码。输出显示了每一列的值的映射，这在以后执行预测时非常有用:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="13e9" class="ob me it oo b gy os ot l ou ov">{'female': 0, 'male': 1}<br/>{'C': 0, 'Q': 1, 'S': 2}</span></pre><p id="c44f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下陈述显示了<strong class="ki iu">着手</strong>和<strong class="ki iu">性别</strong>之间的关系:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="42bf" class="ob me it oo b gy os ot l ou ov">ax = sns.barplot(x='Embarked', y='Sex', data=df, ci=None)<br/>ax.set_xticklabels(embarked_labels.keys())</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/0fffebf3f2337582c29cdbbd259c9185.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*uLQv6pXzt2EcbvNbS_Bqow.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="225f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">似乎从南安普敦(<strong class="ki iu"> S </strong>)登船的男性比从皇后镇(<strong class="ki iu"> Q </strong>)和瑟堡(<strong class="ki iu"> C </strong>)登船的男性多。</p><p id="68c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">上船</strong>和<strong class="ki iu">单独</strong>怎么样？</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="b95d" class="ob me it oo b gy os ot l ou ov">ax = sns.barplot(x='Embarked', y='Alone', data=df, ci=None)<br/>ax.set_xticklabels(embarked_labels.keys())</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/ffda579e0e9279143d842fba37673636.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*5C5g6WsJC_K3_pw2G5UFEw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="e72e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">似乎很大一部分从皇后镇出发的人都是独自一人。</p><p id="d03a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，让我们看看<strong class="ki iu">性</strong>和<strong class="ki iu">独处</strong>之间的关系:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="bfd8" class="ob me it oo b gy os ot l ou ov">ax = sns.barplot(x='Sex', y='Alone', data=df, ci=None)<br/>ax.set_xticklabels(sex_labels.keys())</span></pre><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/9f82129cebf16277f06e7101db0222f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*2Y63OFtfrrC8ZylIyrgU7A.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="4357" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，独自旅行的男性多于女性。</p><h2 id="5f17" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">定义假设</h2><p id="056d" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">你现在定义你的<em class="lx">零假设</em>和<em class="lx">替代假设</em>。如前所述，它们是:</p><ul class=""><li id="4f9f" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated"><strong class="ki iu"> H₀ </strong> ( <em class="lx">零假设</em> ) —待比较的两个分类变量<strong class="ki iu">相互独立</strong>。</li><li id="d8a1" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated"><strong class="ki iu"> H₁ </strong> ( <em class="lx">替代假设</em>)——被比较的两个分类变量<strong class="ki iu">相互依赖</strong>。</li></ul><p id="4b62" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您根据以下p值条件得出结论:</p><ul class=""><li id="ae13" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated">p&lt; 0.05 — this means the two categorical variables are <strong class="ki iu">T25】关联T27】。</strong></li><li id="7a6a" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated">p &gt; 0.05 —这意味着两个分类变量是<strong class="ki iu"> <em class="lx">而不是</em> </strong> <strong class="ki iu"> <em class="lx">相关</em> </strong>。</li></ul><h2 id="9fd3" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">手动计算χ2</h2><p id="1350" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">让我们手动浏览计算χ2值的步骤。第一步是创建一个<em class="lx">列联表</em>。以<strong class="ki iu">性别</strong>和<strong class="ki iu">幸存</strong>列为例，首先创建一个列联表:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/24541e137ac482dca25fb919ef98ef6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*aUXdUlX81LUgKJMl3rnH_w.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="0488" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的列联表显示了两个分类列的频率分布——<strong class="ki iu">性别</strong>和<strong class="ki iu">幸存</strong>。</p><p id="13d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">自由度</strong>接下来被计算为<strong class="ki iu"> <em class="lx">(行数-1) *(列数-1) </em> </strong>。在本例中，自由度为(2–1)*(2–1)=<strong class="ki iu">1</strong>。</p><p id="ca6d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建列联表后，汇总所有行和列，如下所示:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/b4f1cc1d20d3f629065c30c3ac8a2902.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*vyXDcXFVuO4_IVEO-L0ezQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="893d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以上是你的<em class="lx">观测值</em>。</p><p id="6359" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，您将计算<em class="lx">期望值</em>。以下是它们的计算方法:</p><ul class=""><li id="4bc5" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated">将观察值中的每个值替换为其列的总和与其行的总和的乘积除以总和。</li></ul><p id="ea89" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下图显示了如何计算第一个值:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/403aa9822a1abbab4fae65467087093e.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*al_GTCQb_1sx4QQdeL9_6A.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="da61" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下图显示了如何计算第二个值:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/3c4246f0a85bdf015e27c5274e4d8c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*rWg9LQANHrVdItWs_SAvYw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="36eb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是<em class="lx">预期</em>值的结果:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pf"><img src="../Images/24c8fcaa5cc09552e2902ece0e93fad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*5UXNYI-IZKtmet0Eje6lgg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="f87d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，使用公式<strong class="ki iu"> <em class="lx"> χ </em> 2 </strong>计算每个单元格的<strong class="ki iu">卡方值</strong>:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/a7ac89c275fa2c332df27fec7e6537d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*6rt4Sr53FDT7p3PoYbXzvg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="2c0e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将此公式应用于<em class="lx">观察值</em>和<em class="lx">预期值</em>，您得到卡方值:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/2450aa348c4eeb8098acf811781b1684.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*2HtCMP3yXsP_ggP1Wq60vA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="f54a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">卡方值</strong>是卡方值的总和:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/24f2f848771da3a08ac1bed507264654.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*5kWOnmyNqIqXuZG2ZWUlVg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="f3a2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以使用以下网站来验证这些数字是否正确:</p><ul class=""><li id="a228" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated"><strong class="ki iu">卡方计算器</strong>——【https://www.mathsisfun.com/data/chi-square-calculator.html】T4</li></ul><p id="d622" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述步骤的Python实现包含在下面的<strong class="ki iu"> chi2_by_hand() </strong>函数中:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="24bd" class="ob me it oo b gy os ot l ou ov">def <strong class="oo iu">chi2_by_hand</strong>(df, col1, col2):    <br/>    #---create the contingency table---<br/>    df_cont = pd.crosstab(index = df[col1], columns = df[col2])<br/>    display(df_cont)</span><span id="2db2" class="ob me it oo b gy ow ot l ou ov">    #---calculate degree of freedom---<br/>    degree_f = (df_cont.shape[0]-1) * (df_cont.shape[1]-1)</span><span id="4113" class="ob me it oo b gy ow ot l ou ov">    #---sum up the totals for row and columns---<br/>    df_cont.loc[:,'Total']= df_cont.sum(axis=1)<br/>    df_cont.loc['Total']= df_cont.sum()<br/>    print('---Observed (O)---')<br/>    display(df_cont)</span><span id="7b0d" class="ob me it oo b gy ow ot l ou ov">    #---create the expected value dataframe---<br/>    df_exp = df_cont.copy()    <br/>    df_exp.iloc[:,:] = np.multiply.outer(<br/>        df_cont.sum(1).values,df_cont.sum().values) / <br/>        df_cont.sum().sum()            <br/>    print('---Expected (E)---')<br/>    display(df_exp)<br/>        <br/>    # calculate chi-square values<br/>    df_chi2 = ((df_cont - df_exp)**2) / df_exp    <br/>    df_chi2.loc[:,'Total']= df_chi2.sum(axis=1)<br/>    df_chi2.loc['Total']= df_chi2.sum()<br/>    <br/>    print('---Chi-Square---')<br/>    display(df_chi2)</span><span id="6c51" class="ob me it oo b gy ow ot l ou ov">    #---get chi-square score---   <br/>    chi_square_score = df_chi2.iloc[:-1,:-1].sum().sum()<br/>    <br/>    return chi_square_score, degree_f</span></pre><p id="481d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> chi2_by_hand() </strong>函数接受三个参数——包含所有列的dataframe，后面是两个字符串，包含要比较的两个列的名称。它返回一个元组——卡方得分加上自由度。</p><p id="a2d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们使用Titanic数据集测试上面的函数。首先，让我们比较一下<strong class="ki iu">性别</strong>和<strong class="ki iu">幸存的</strong>列:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="aaa8" class="ob me it oo b gy os ot l ou ov">chi_score, degree_f = <strong class="oo iu">chi2_by_hand(df,'Sex','Survived')</strong><br/>print(f'Chi2_score: {chi_score}, Degrees of freedom: {degree_f}')</span></pre><p id="fcfa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将看到以下结果:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="7463" class="ob me it oo b gy os ot l ou ov">Chi2_score: 205.1364846934008, Degrees of freedom: 1</span></pre><p id="ee07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用卡方得分，您现在可以使用<strong class="ki iu">卡方分布曲线</strong>决定是接受还是拒绝零假设:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pi"><img src="../Images/5b4a78a63ada7ced010e8746fb545fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-6smO8JJdxosMSzZUa8HQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="9ba3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">x轴代表<em class="lx"> χ </em> 2分数。临界卡方区域<strong class="ki iu">右侧的区域</strong>被称为<strong class="ki iu">剔除区域</strong>。它左边的区域称为<strong class="ki iu">接受区域</strong>。如果您获得的卡方得分落在可接受区域内，则零假设被接受；否则另一个假设被接受。</p><p id="7325" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么如何获得<strong class="ki iu">临界卡方区域</strong>？为此，您必须检查<strong class="ki iu">卡方表</strong>:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pj"><img src="../Images/83b2e1a7b289f1997e1a17c19590bb69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I3aDpVJ4WPzoSL4SP_mpGw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">表来自<a class="ae kf" href="https://people.smp.uq.edu.au/YoniNazarathy/stat_models_B_course_spring_07/distributions/chisqtab.pdf" rel="noopener ugc nofollow" target="_blank">https://people . SMP . uq . edu . au/YoniNazarathy/stat _ models _ B _ course _ spring _ 07/distributions/chisqtab . pdf</a>；作者注释</p></figure><blockquote class="ng nh ni"><p id="8dee" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">你可以在https://www.mathsisfun.com/data/chi-square-table.html的<strong class="ki iu"> </strong> <a class="ae kf" href="https://www.mathsisfun.com/data/chi-square-table.html" rel="noopener ugc nofollow" target="_blank">查看<strong class="ki iu">卡方表</strong></a></p></blockquote><p id="6075" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是卡方表的使用方法。当您的<strong class="ki iu"> α </strong>设置为0.05，并且<strong class="ki iu"> 1 </strong>自由度时，临界卡方区域为<strong class="ki iu"> 3.84 </strong>(参考上图)。将该值放入卡方分布曲线，您可以得出以下结论:</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pk"><img src="../Images/bc59f1a85ed33d6ebb925780cb508e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2FMF3kxjLyidNOCr9YlVbQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><ul class=""><li id="376d" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated">由于计算的卡方值(<strong class="ki iu"> 205 </strong>)大于<strong class="ki iu"> 3.84 </strong>，因此它落在<em class="lx">拒绝区域</em>，因此零假设被拒绝，而<strong class="ki iu">替代假设被接受</strong>。</li><li id="3637" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated">回想一下我们的替代假设:<strong class="ki iu"> H₁ </strong> ( <em class="lx">替代假设</em> ) —被比较的两个分类变量<strong class="ki iu">相互依赖</strong>。</li></ul><blockquote class="ng nh ni"><p id="e3da" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">这意味着<strong class="ki iu">列中的</strong>和<strong class="ki iu">列中的</strong>列是相互依赖的。</p></blockquote><p id="11c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为练习，您可以在其他功能上使用<strong class="ki iu"> chi2_by_hand() </strong>功能。</p><h2 id="c7c5" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">计算p值</h2><p id="7b25" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">上一节展示了如何通过检查卡方得分并将其与卡方分布曲线进行比较来接受或拒绝零假设。</p><p id="b975" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接受或拒绝零假设的另一种方法是使用<em class="lx"> p值</em>。请记住，可以使用卡方得分和自由度计算p值。</p><blockquote class="ng nh ni"><p id="693e" class="kg kh lx ki b kj kk kl km kn ko kp kq nj ks kt ku nk kw kx ky nl la lb lc ld im bi translated">为简单起见，我们将不详细讨论如何手工计算p值。</p></blockquote><p id="208a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Python中，可以使用<strong class="ki iu"> stats </strong>模块的<strong class="ki iu"> sf() </strong>函数计算p值:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="02ff" class="ob me it oo b gy os ot l ou ov">def chi2_by_hand(df, col1, col2):    <br/>    #---create the contingency table---<br/>    df_cont = pd.crosstab(index = df[col1], columns = df[col2])<br/>    display(df_cont)</span><span id="cc03" class="ob me it oo b gy ow ot l ou ov">    ...</span><span id="6388" class="ob me it oo b gy ow ot l ou ov">    chi_square_score = df_chi2.iloc[:-1,:-1].sum().sum()<br/>    <br/>    <strong class="oo iu">#---calculate the p-value---<br/>    from scipy import stats<br/>    p = stats.distributions.chi2.sf(chi_square_score, degree_f)</strong></span><span id="3e20" class="ob me it oo b gy ow ot l ou ov">    return chi_square_score, degree_f<strong class="oo iu">, p</strong></span></pre><p id="f9a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您现在可以调用<strong class="ki iu"> chi2_by_hand() </strong>函数并获得chi_square分数、自由度和p值:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="7eea" class="ob me it oo b gy os ot l ou ov">chi_score, degree_f<strong class="oo iu">, p</strong> = chi2_by_hand(df,'Sex','Survived')<br/>print(f'Chi2_score: {chi_score}, Degrees of freedom: {degree_f}<strong class="oo iu">,</strong> <strong class="oo iu">p-value: {p}</strong>')</span></pre><p id="430d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述代码会产生以下p值:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="23b9" class="ob me it oo b gy os ot l ou ov">Chi2_score: 205.1364846934008, Degrees of freedom: 1, <strong class="oo iu">p-value: 1.581266384342472e-46</strong></span></pre><p id="0e45" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">快速回顾一下，您接受或拒绝假设，并根据以下p值条件形成您的结论:</p><ul class=""><li id="75c8" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld nr ns nt nu bi translated">p&lt; 0.05 — this means the two categorical variables are <strong class="ki iu">T29】关联T31】。</strong></li><li id="4c16" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld nr ns nt nu bi translated">p &gt; 0.05 —这意味着两个分类变量是<strong class="ki iu"> <em class="lx">而不是</em> </strong> <strong class="ki iu"> <em class="lx">相关</em> </strong>。</li></ul><p id="3f8d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并且由于<strong class="ki iu">p&lt;0.05</strong>——这意味着两个分类变量是<strong class="ki iu"> <em class="lx">相关</em> </strong>。</p><h2 id="d39d" class="ob me it bd mf oc od dn mj oe of dp mn kr og oh mr kv oi oj mv kz ok ol mz om bi translated">尝试其他功能</h2><p id="e1f0" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">让我们尝试包含名义值的分类列:</p><pre class="lz ma mb mc gt on oo op oq aw or bi"><span id="31da" class="ob me it oo b gy os ot l ou ov">chi_score, degree_f, p = chi2_by_hand(df,'<strong class="oo iu">Embarked</strong>','<strong class="oo iu">Survived</strong>')<br/>print(f'Chi2_score: {chi_score}, Degrees of freedom: {degree_f}, p-value: {p}')</span><span id="73fd" class="ob me it oo b gy ow ot l ou ov"># Chi2_score: 27.918691003688615, Degrees of freedom: 2, <br/># p-value: <strong class="oo iu">8.660306799267924e-07</strong></span><span id="70bd" class="ob me it oo b gy ow ot l ou ov"><br/>chi_score, degree_f, p = chi2_by_hand(df,'<strong class="oo iu">Alone</strong>','<strong class="oo iu">Survived</strong>')<br/>print(f'Chi2_score: {chi_score}, Degrees of freedom: {degree_f}, p-value: {p}')</span><span id="4be7" class="ob me it oo b gy ow ot l ou ov"># Chi2_score: 28.406341862069905, Degrees of freedom: 1, <br/># p-value: <strong class="oo iu">9.834262807301776e-08</strong></span></pre><p id="88a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于<strong class="ki iu">着手</strong>和<strong class="ki iu">单独</strong>的p值都是&lt; 0.05，您可以得出结论，即<strong class="ki iu">着手</strong>和<strong class="ki iu">单独</strong>特征都与<strong class="ki iu">幸存</strong>目标相关，并且应该包括在您的模型中用于训练。</p><h1 id="7951" class="md me it bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">摘要</h1><p id="7903" class="pw-post-body-paragraph kg kh it ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">在本文中，我简要介绍了卡方统计测试的工作原理，以及如何将它应用于Titanic数据集。这里需要注意的是:</p><ol class=""><li id="2596" class="nm nn it ki b kj kk kn ko kr no kv np kz nq ld oa ns nt nu bi translated">当<strong class="ki iu">皮尔逊系数</strong>和<strong class="ki iu">斯皮尔曼等级系数</strong>测量两个变量之间关联的<em class="lx">强度</em>时，<strong class="ki iu">卡方检验</strong>测量两个变量之间关联的<em class="lx">显著性</em>。它告诉你的是，你在样本中发现的关系是否有可能存在于总体中，或者由于抽样误差而偶然出现的可能性有多大。</li><li id="c160" class="nm nn it ki b kj nv kn nw kr nx kv ny kz nz ld oa ns nt nu bi translated">卡方检验对你的列联表中的小频率很敏感。一般来说，如果列联表中的某个单元格的频率等于或小于5，那么卡方检验将导致结论错误。此外，如果样本量小于50，则不应使用卡方检验。</li></ol><p id="f92e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望您现在对卡方如何工作以及如何将其用于机器学习中的特征选择有了更好的理解。我的下一篇文章再见！</p><div class="le lf gp gr lg lh"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">加入媒介与我的介绍链接-李伟孟</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">weimenglee.medium.com</p></div></div><div class="lq l"><div class="pl l ls lt lu lq lv jz lh"/></div></div></a></div></div></div>    
</body>
</html>