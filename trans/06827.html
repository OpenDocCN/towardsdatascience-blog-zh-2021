<html>
<head>
<title>X-ray Image Classification and Model Evaluation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">x射线图像分类和模型评估</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/x-ray-image-classification-and-model-evaluation-7810044c0ff5?source=collection_archive---------18-----------------------#2021-06-20">https://towardsdatascience.com/x-ray-image-classification-and-model-evaluation-7810044c0ff5?source=collection_archive---------18-----------------------#2021-06-20</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="6764" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">基于张量流的胸部x光图像肺炎检测</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/ec5a3f47d869d276884ffc4a46783adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aWLrfRNBF_4ZLzXTB4R47g.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://unsplash.com/photos/DK8jXx1B-1c" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="d364" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>拥有肺炎和正常病例胸部x光图像数据集的极好来源。正常X射线和受影响的X射线的图像之间存在显著差异。机器学习可以在确定疾病方面发挥关键作用，并显著缩短诊断时间，同时减少人工工作量。在本文中，我将遍历这个数据集，并以90%的评估准确率对图像进行分类</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj lw"><img src="../Images/c9471c7216c3bb0363036b17f8a1011d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2Pi8xVmGE3-GEqk08FRsg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="d5a5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我被<a class="ae kz" href="https://goodboychan.github.io/python/deep_learning/tensorflow-keras/vision/2020/10/16/01-Image-Classification-with-Cat-and-Dog.html" rel="noopener ugc nofollow" target="_blank">在猫和狗之间的数据集上所做的工作所激励，并重用了数据集管道的代码块。首先，我们需要导入必要的包。</a></p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="0dd6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">初始数据集太大。我选择了一个精简集，对于正常情况有1000个图像，对于肺炎有1000个图像。将有三个目录:培训、验证和测试。验证和测试数据集对模型来说是全新的，我们不需要对这些数据集执行任何图像增强技术。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="0a1f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">接下来导入几个样本。输出显示了两个目标病例的X射线图像。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="d698" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们将为数据集分配标签:0代表正常，1代表肺炎。这就是为什么我们会在模型编译中使用SparseCategoricalCrossentropy()损失函数。该模型定义如下:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="3ec1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为在每个目标文件夹中有相等数量的图像，所以通过将一个文件夹的长度乘以2来获得总的训练或验证或测试长度。下一部分是图像增强</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="792f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们将使用train_datagen和validation_datagen生成器以20个为一批来传输训练图像。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="8682" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">从<a class="ae kz" href="https://goodboychan.github.io/python/deep_learning/tensorflow-keras/vision/2020/10/16/01-Image-Classification-with-Cat-and-Dog.html" rel="noopener ugc nofollow" target="_blank">到这里</a>放置了一堆操作图像的函数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="c18e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这些功能会导致一些随机抖动，并有助于加载图像。下一个块将把标签分配给各个文件夹。如前所述，0代表正常，1代表肺炎。这适用于训练、验证和测试的所有三个文件夹。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="a096" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">每当在检查点观察到训练中的改进时，模型将被保存。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="20aa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后将使用该数据训练该模型。所有文件夹的长度都是预先获得的。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="414b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">完成后，我们可以获得训练和验证损失和准确性。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj lz"><img src="../Images/809a44e7d1c2633e943f906285e7acc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*_lXqD9mlAZ66bYwIQVXdBg.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj lz"><img src="../Images/b0314f119fb5a55fe157d5490e45db57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*4EIgrtsAROKicj7m7u1Oig.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="25cc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">显然，在50个时期之后，在数据集上的训练是极好的，因为准确度已经达到几乎98%,但是验证没有改善太多。验证数据的准确度约为75%。这种过度拟合可以通过删除模型中的数据点来避免。在这里，我将继续进行模型评估，该评估在测试数据集上显示了大约90%的准确性。当然，所有这些数字都取决于图像，并且可能因验证和测试数据集而异。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ma"><img src="../Images/23fc4919e9bfb244831957d569e52101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Oypt-TIpfYDy10tQb21Dyw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="8052" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们已经证明了在DNN使用张量流建立图像分类器。灰度胸部x光图像用于这种分类。初始训练数据集可以进一步扩展到包括所有图像。像我这样采用core i-7 8550U的本地PC平台需要30多分钟来完成2000幅图像数据集上50个时期的训练。支持GPU的PC将能够显著加快训练速度。</p><p id="ae43" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/06/21/X-ray-image-classification.html" rel="noopener ugc nofollow" target="_blank"> Github页面</a></p></div></div>    
</body>
</html>