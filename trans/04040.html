<html>
<head>
<title>Deploying a Cross Platform Deep Learning Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署跨平台深度学习应用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploying-a-cross-platform-deep-learning-application-a026da146d6?source=collection_archive---------20-----------------------#2021-04-05">https://towardsdatascience.com/deploying-a-cross-platform-deep-learning-application-a026da146d6?source=collection_archive---------20-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3299" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Python在iOS、Android、MacOS、Windows和Linux上运行Tensorflow Lite推理</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d37250267c7bb122213a412c17942d69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9L5fLZuNlLzUw47p-mr7Iw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="15fd" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="1a49" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">向下滚动Python代码，使用Tensorflow Lite运行推理，它可以在Android、iOS、Windows、MacOS和Linux上运行。</p><h1 id="8326" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">为什么坚持用Python？</h1><p id="d124" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Python是一个奇妙的生态系统。有这么多高质量的开源库可以帮助你快速构建非常复杂的项目。这无疑有助于Python作为深度学习框架的流行。至关重要的是，pip(或pipenv)为您处理依赖关系，这样您可以避免陷入<em class="mj">版本地狱</em>。这使得Python非常适合于原型开发，但是要得到一个易于使用的完美产品，有时可能比所有其他产品加在一起还要费力。正如笑话所说，答案可能是“我不会从这里开始”。</p><h1 id="b4b6" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">Web app还是手机app？</h1><p id="ad16" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">通常，最好的选择是在web上部署应用程序，这样浏览器就能有效地处理平台细节。然后，您的Python代码可以作为服务运行，并集成到运行在云上的可扩展架构中。但是如果需要来回发送的数据量太大或者太敏感怎么办？鉴于我们大多数人口袋里都装着相当于80年代超级电脑的东西，利用手机的力量是有意义的。</p><p id="30af" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">作为一个例子，我使用深度学习开发了一个基于原始音频数据的<a class="ae mp" href="https://teticio.github.io/deej-ai/" rel="noopener ugc nofollow" target="_blank">音乐推荐算法。给定一组MP3，它会自动创建音乐播放列表，这些音乐可以很好地放在一起，或者从一首歌平稳地过渡到另一首歌。我希望能够在我的手机、平板电脑或电脑上运行它，而不必将我的所有曲目上传到云端进行分析。我认为Tensorflow Lite可以在几乎所有可以想象到的平台上使用，不需要重写大量代码就可以实现。</a></p><h1 id="0528" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">Qt对Kivy</h1><p id="bf08" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">现在有很多跨平台的开发工具，但是很少能在桌面和移动设备上工作，并且很容易集成Python代码。我研究了两个声称能做到这一点的工具:Qt和Kivy。</p><p id="1ac3" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><a class="ae mp" href="https://www.qt.io/" rel="noopener ugc nofollow" target="_blank"> Qt </a>以<a class="ae mp" href="https://pypi.org/project/PyQt5/" rel="noopener ugc nofollow" target="_blank"> PyQt5 </a>和<a class="ae mp" href="https://pypi.org/project/pyqtdeploy/" rel="noopener ugc nofollow" target="_blank"> pyqtdeploy </a>的形式出现。特定于平台的东西，比如播放音频，被Qt抽象掉了，所以理论上，你只需要写一次代码。这种通用方法的缺点是，您可能无法充分利用目标设备的功能。我的经验是，在Android上使用Numpy非常困难，我甚至没有在iOS上尝试过。这真的感觉就像试图把一个圆钉塞进一个方孔。</p><p id="2954" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><a class="ae mp" href="https://kivy.org/#home" rel="noopener ugc nofollow" target="_blank">另一方面，Kivy </a>是用Python编写的，可以与像<a class="ae mp" href="https://buildozer.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> buildozer </a>(用于在iOS和Android上构建)、<a class="ae mp" href="https://www.pyinstaller.org/" rel="noopener ugc nofollow" target="_blank"> PyInstaller </a>(用于打包桌面应用)、<a class="ae mp" href="https://python-for-android.readthedocs.io/en/latest/quickstart/" rel="noopener ugc nofollow" target="_blank"> p4a </a> (Python用于Android)和<a class="ae mp" href="https://github.com/kivy/kivy-ios" rel="noopener ugc nofollow" target="_blank"> kivy-ios </a>这样的库一起工作。我使用Numpy获得了一个基本应用程序，运行非常快，能够使用<a class="ae mp" href="https://kivymd.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> KivyMD </a>(材质设计)让它看起来很智能，同时使用<a class="ae mp" href="https://pyobjus.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> pyobjus </a>(用于在iOS上从Python调用Objective C)<a class="ae mp" href="https://pyjnius.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">pyjnius</a>(用于在Android上从Python调用Java)和<a class="ae mp" href="https://github.com/kivy/plyer" rel="noopener ugc nofollow" target="_blank"> plyer </a>完全控制平台特定的功能。由于pyjnius开发人员之一<a class="ae mp" href="https://github.com/tito" rel="noopener ugc nofollow" target="_blank"> Tito </a>在Android上运行Tensorflow Lite的<a class="ae mp" href="https://github.com/tito/experiment-tensorflow-lite" rel="noopener ugc nofollow" target="_blank">示例</a>，我领先了一步。</p><p id="28fe" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">我花了很长时间才让iOS版本工作，主要是因为我没有Mac，所以我不得不使用模拟器，但也因为Objective C很糟糕，不容易从Python中调用。(我也尝到了版本地狱的滋味，kivy-ios和Cocoapod都有音频库中的重复符号。)另一种方法是从Swift调用Tensorflow Lite和Python，但这将意味着完全重写我的应用程序。</p><p id="8039" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">下面的代码片段扩展了Kivy，允许您以独立于平台的方式在Tensorflow Lite上运行推理。它假设您的模型只有一个输入和输出张量——这是通常的情况——但是推广到多个输入和输出是非常简单的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="338f" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">为了方便开始，我创建了一个可以在Android、iOS、MacOS、Windows和Linux上运行的<a class="ae mp" href="https://github.com/teticio/kivy-tensorflow-helloworld" rel="noopener ugc nofollow" target="_blank">“Hello World”tensor flow Lite应用</a>。对您来说，根据自己的需要对其进行调整应该是相当简单的。现在，没有什么可以阻止您开发一个利用您设备的传感器和功能的深度学习应用程序！</p><div class="ms mt gp gr mu mv"><a href="https://github.com/teticio/kivy-tensorflow-helloworld/tree/main" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd ir gy z fp na fr fs nb fu fw ip bi translated">泰提西奥/基维-滕索尔弗洛-helloworld</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">安装buildozer https://pypi.org/project/buildozer/皮普安装-部队git+https://github.com/kivy/buildozer.git…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">github.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj kp mv"/></div></div></a></div><p id="881c" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">总之，我想说Kivy非常有前途，开发者们一直在忙于改进它。在我看来，它非常接近于能够生产出高质量的应用程序。</p></div></div>    
</body>
</html>