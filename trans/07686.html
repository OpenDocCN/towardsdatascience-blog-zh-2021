<html>
<head>
<title>Removing Duplicate or Similar Images in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中移除重复或相似的图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/removing-duplicate-or-similar-images-in-python-93d447c1c3eb?source=collection_archive---------10-----------------------#2021-07-14">https://towardsdatascience.com/removing-duplicate-or-similar-images-in-python-93d447c1c3eb?source=collection_archive---------10-----------------------#2021-07-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7f18" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当训练使用图像作为输入的机器学习模型时，检查数据集中相似或重复的图片是相关的。这里有一个最有效的方法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7641cb34177a6d90674639d9aa1b7703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CuTCuW71t_B9ujYo"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Anton Maksimov juvnsky 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="bc89" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="d9be" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">检测重复图像的最简单的方法之一是通过检查所有值是否相同来逐个像素地进行比较。然而，当测试大量图像时，这变得非常低效。</p><p id="3a71" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">第二种非常常见的方法是提取两幅图像的加密哈希，并使用MD5或SHA-1等流行的哈希算法比较它们是否相同。虽然这种方法更有效，但它只能检测相同的图像。如果其中一个像素不同(例如，由于光照的轻微变化)，哈希将完全不同。</p><p id="0d2f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">其原因是这些加密算法使用的数据仅基于图像的像素和随机种子。相同的数据和相同的种子会产生相同的结果，但是不同的数据会产生不同的结果。</p><blockquote class="mp"><p id="03bf" class="mq mr iq bd ms mt mu mv mw mx my mj dk translated">对于我们的用例，相似的图像有相似的散列更有意义，对吗？</p></blockquote><p id="7b47" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">这正是图像哈希算法的目标。他们专注于图像的结构及其视觉外观来计算散列。根据您的使用情况，有些算法会比其他算法更好。</p><p id="8301" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">例如，如果您希望形状相同但颜色不同的图像具有相同的哈希，可以使用感知哈希或差异哈希。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/9d26ff4a19221b9371bd6defd4d86413.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*EaXFpFuEqcgltwATpFujaA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<strong class="bd nf"> phash </strong>算法检测到的重复项<a class="ae kv" href="https://github.com/JohannesBuchner/imagehash" rel="noopener ugc nofollow" target="_blank"> ImageHash存储库的第一个例子。</a></p></figure><p id="aea5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">请记住，总是有可能使用更大的图像哈希大小，并获得不太相似的图像，这取决于用例，必须进行超调优。</p><h1 id="b6e6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">履行</h1><p id="3fcb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在Python中使用，我推荐<a class="ae kv" href="https://github.com/JohannesBuchner/imagehash" rel="noopener ugc nofollow" target="_blank"> ImageHash库</a>，支持多种图像哈希算法，如<em class="ng">平均</em>、<em class="ng">感知</em>、<em class="ng">差异</em>、<em class="ng">小波</em>、<em class="ng"> HSV-color </em>、<em class="ng">抗裁剪</em>。</p><p id="4630" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">可以使用以下命令轻松安装它:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="d809" class="nm kx iq ni b gy nn no l np nq">pip install imagehash</span></pre><p id="5bbc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如上所述，每个算法可以调整其散列大小，该大小越高，散列对变化越敏感。根据我的经验，我推荐使用散列大小为8的dhash算法和存储库中可用的z变换。</p><p id="a30b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">下面您可以看到加载图像、转换图像和计算d-hash所需的代码，这些代码封装在dhash_z_transformed方法中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="7c2e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">要在数据管道中应用它，只需用想要散列的图像的路径调用dhash_z_transformed方法。如果该方法为两个图像产生相同的散列，这意味着它们非常相似。然后，您可以选择通过保留一个副本或两个都不保留来删除副本，这取决于您的用例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/20acdffd0fbffcbf59b9f265db86475c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dtxb11BFpfy6ZS2cBtv3YQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在我最近的一个项目中，项目按散列分组的例子。</p></figure><p id="1325" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我鼓励您通过更改hash_size来调整敏感度阈值，以便根据您的用例获得更好的结果。</p><h1 id="3e71" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="c997" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在这篇短文中，我介绍了在训练接收图像作为输入的机器学习模型时要考虑的一个重要步骤。</p><p id="f8b9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我没有展示如何只检测相同的图像，而是介绍了图像哈希算法来识别相似的图像(不同大小但相同的图像，亮度的轻微变化……)。最后，我提供了如何使用外部库在Python中计算这些图像散列的例子。</p><p id="2dba" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果你想发现更多像这样的帖子，你可以在下面找到我:</p><ul class=""><li id="6978" class="nu nv iq lq b lr mk lu ml lx nw mb nx mf ny mj nz oa ob oc bi translated"><a class="ae kv" href="https://github.com/angeligareta" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="13a1" class="nu nv iq lq b lr od lu oe lx of mb og mf oh mj nz oa ob oc bi translated"><a class="ae kv" href="https://www.linkedin.com/in/angeligareta/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="ba43" class="nu nv iq lq b lr od lu oe lx of mb og mf oh mj nz oa ob oc bi translated"><a class="ae kv" href="https://angeligareta.com/" rel="noopener ugc nofollow" target="_blank">个人网站</a></li></ul></div></div>    
</body>
</html>