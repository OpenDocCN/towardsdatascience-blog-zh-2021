<html>
<head>
<title>How To Create Quantum Multinoulli Distributions With Qiskit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Qiskit创建量子多内核分布</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-quantum-multinoulli-distributions-with-qiskit-cea9021f6cb9?source=collection_archive---------34-----------------------#2021-10-19">https://towardsdatascience.com/how-to-create-quantum-multinoulli-distributions-with-qiskit-cea9021f6cb9?source=collection_archive---------34-----------------------#2021-10-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bd61" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">实践中的量子机器学习</h2></div><p id="5bb8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">量子机器学习要不要入门？看看<a class="ae le" href="https://www.pyqml.com/page?ref=medium_multinoulli&amp;dest=/" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">动手量子机器学习用Python </strong> </a> <strong class="kk iu">。</strong></p><p id="11b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">概率分布在机器学习中无处不在。我们的目标是回答最简单的问题还是解决最大的问题并不重要。从技术上讲，目标总是从数据中学习一个未知的概率分布。</p><p id="3b24" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">无论我们进行简单的回归分析还是训练深度神经网络，都无关紧要。目标总是找到某个概率分布。</p><p id="88bd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而且，就算用量子机器学习算法也没关系。最终，你要寻找的答案将是概率性的。</p><p id="8006" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但并不是所有的概率分布都是一样的。他们可能是非常异质的。每种类型的分布都有其特殊性，你最好知道。如果你不知道哪种分布适合你手头的问题，你就有麻烦了。</p><p id="c878" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，如果您知道哪种分布适合您的问题，但不知道如何生成合适的分布，您的情况也不会更好。而且，你猜怎么着，用量子位生成分布本身就是一个挑战。</p><p id="5c48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">经典计算机有数十亿比特的内存。节省一些来存储概率分布没什么大不了的。但是量子计算机只有不到一百个量子位。我们应该考虑如何有效地表示一个概率分布。幸运的是，一个量子位不仅仅是0或1。即使如果我们测量它，它只有0或1，但它处于量子叠加态。这个状态包含了更多的信息。</p><p id="a29b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" rel="noopener" target="_blank" href="/the-very-first-step-into-quantum-machine-learning-95efdf0d980c">在之前的</a>中，我们研究了如何创建一个量子系统来重现伯努利分布。伯努利分布是所有分布中最简单的。只有两个可能的值，每个值都以一定的概率出现。这差不多就是单个量子比特叠加的含义。</p><p id="f32f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设我们的单个量子比特在|𝜓⟩=√0.7|0⟩+√0.3|1⟩.态如果你在这种状态下测量许多量子位，就会产生以下伯努利分布。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/f0bbd75e45a0e37e1454cae02ee96c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HAsaw1wEZlV-6VGv.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="cbe2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">伯努利分布回答简单的问题，你可以用“是”或“否”来回答。例如，一名乘客在泰坦尼克号沉船中幸存了吗？这是一只猫吗？这个学生通过考试了吗？</p><p id="1ab0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是如果我们有多种可能的答案呢？假设我们想从著名的MNIST数据集中标注手写数字？显然，我们需要区分两个以上的输出值。</p><p id="de6a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要多个量子位来代表所有类别，因为我们测量单个量子位为0或1。假设我们想要标记从0到7的数字。然后，我们有八个不同的类别。我们可以用三个量子位来编码这些可能的结果。量子位测量的每个组合代表一个数字。000代表数字0。001代表1。010代表2。011代表3，以此类推。最后，111代表7。</p><p id="3fa0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们会得到一个多内核分布，也称为分类分布。它涵盖了一个事件有多种可能结果的情况。因此，它概括了伯努利分布，该分布涵盖了两种可能结果中的一种。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/96ea089135d3cf257220b02108251ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LDM_qlXa6Uh7q7ETpU6LEg.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="1bfa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，假设我们有这样一个多元分布的数据。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="9f36" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">实际问题是:“<strong class="kk iu">怎样才能让一个量子电路代表这样的分布？</strong>”</p><p id="254a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最简单的方法就是把这些概率转换成振幅，传递给量子电路的<code class="fe ly lz ma mb b">initialize</code>函数。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="4531" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">真正的神奇发生在第6行。我们计算三量子位系统的初始状态。整个技巧是取每个概率的平方根，因为概率是量子态振幅的平方。</p><p id="9c0c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Qiskit <code class="fe ly lz ma mb b">QuantumCircuit</code>的<code class="fe ly lz ma mb b">initialize</code>功能将所有振幅列表作为输入参数(参见<a class="ae le" href="https://qiskit.org/documentation/stubs/qiskit.circuit.QuantumCircuit.initialize.html#qiskit.circuit.QuantumCircuit.initialize" rel="noopener ugc nofollow" target="_blank">官方Qiskit文档</a>)。</p><p id="628d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们用<code class="fe ly lz ma mb b">'statevector_simulator'</code>执行这个电路时，它会再现我们指定的精确分布。</p><p id="fbce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">还有别的办法吗？我们能通过使用量子门来创造多量子分布吗？</strong></p><p id="7772" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然了。但是，这并不简单。</p><p id="191c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用量子门来转换量子位的状态。例如，我们可以使用<code class="fe ly lz ma mb b">qc.ry(theta, 0)</code>函数将位置0的量子位的状态向量旋转角度<code class="fe ly lz ma mb b">theta</code>。此外，我们可以使用<code class="fe ly lz ma mb b">prob_to_angle</code>函数根据概率计算角度θ。更多细节请看<a class="ae le" href="https://betterprogramming.pub/if-you-want-to-gamble-with-quantum-computing-e327c11f97e5" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。</p><p id="2906" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">问题是，在我们的分布中，我们将单个量子位的值用于不同的值。例如，对于所有状态<code class="fe ly lz ma mb b">['100', '101', '110', '111']</code>，左边的数字是1。</p><p id="c8c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，当我们指定量子位3(左手边的量子位)的状态时，我们需要取所有这些状态的概率之和。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="8e7d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们定义我们的便利函数<code class="fe ly lz ma mb b">prob_to_angle</code>并定义一个<code class="fe ly lz ma mb b">QuantumRegister</code>。<code class="fe ly lz ma mb b">QuantumRegister</code>是我们量子位的容器，允许我们在Python代码中轻松地处理单个量子位。</p><p id="a4ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">动作从第9行开始。在那里，我们将分布的值从4到7分开，计算这些状态的总和，并将我们的总概率分成两半。下图描述了迄今为止的状态。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/611b08f14ad59546eeb83f7cdc5a2067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9V3_NIXwHeKVDwyBQTbyw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="acf2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们只区分两类国家。高位量子位为0的和高位量子位为1的。(注意:上量子位在图中字符串的左下方。)</p><p id="5bc1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步，我们进一步将后半部分减半。我们应用相同的逻辑。我们把上量子位为1的状态分成四分之二。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="6946" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与第一次分裂的唯一区别是我们使用的量子门。这一次，我们使用受控RY门而不是普通RY门。不同之处在于，如果控制量子位为1，受控RY门仅应用概率分割。在我们的例子中，这意味着我们只拆分“100”块，而不改动“000”块。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/188d22a03bd1aa9c142e31c34d7bb374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8gjdm4VmYfHRMTodZU-VDw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="2dec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们还需要一个上季度的分裂。我们必须分别管理每个季度。首先，我们把上面的四分之一分成两半。现在，我们必须只触及两个上量子位为1的状态。因此，我们使用多控RY门(<code class="fe ly lz ma mb b">qc.mcry</code>)。</p><p id="8631" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这一点上，<code class="fe ly lz ma mb b">QuantumRegister</code>派上了用场，因为我们可以以数组的形式访问量子位。术语<code class="fe ly lz ma mb b">qr[1:]</code>选择除第一个以外的所有量子位。这些是多重控制RY门的控制量子位。最后一个参数<code class="fe ly lz ma mb b">qr[0]</code>表示目标量子位。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/4c3dbf4eaa56293c0b1f266701d27467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22wIY-J0-06xR6BvGp-qvA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="c07d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还需要使用另一个多重控制的RY门来分割下面的四分之一。我们把它封装成非门，应用在中间的量子位上。这让我们可以选择中间量子位是0而不是1的状态。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="4907" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到目前为止的结果表明，我们准备了一半的状态。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/b6b56a93f6ae0c4624ace1032a15c852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1I8x_TEhlEYTUIfCKgUtxw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="7683" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还需要在下半部分执行相应的步骤，以生成整体分布。这是完整的源代码。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="b985" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们看结果时，我们看到它类似于我们的多诺尔分布。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/f7a54cd684f122a63440d833965db5d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z0MSbJQNpzrimzTgRqLxZw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="1b06" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">方法很简单。我们重复地将状态分成两半，并应用相应的量子位变换。然而，这比简单地用概率初始化三个量子位要多得多。</p><p id="13ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是在某些情况下，你不能在初始化的时候指定所有的概率。例如，如果创建一个量子贝叶斯网络，分布值可能来自其他变量。然后，您不可避免地希望能够以编程方式创建一个多内核发行版。</p><p id="d660" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">量子机器学习要不要入门？看看<a class="ae le" href="https://www.pyqml.com/page?ref=medium_multinoulli&amp;dest=/" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">动手量子机器学习用Python </strong> </a> <strong class="kk iu">。</strong></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/c3892c668b9d47f57e47f1e6d80af7b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*yymQWGhESHNGUr_L.png"/></div></figure><p id="51db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里免费获得前三章<a class="ae le" href="https://www.pyqml.com/page?ref=medium_multinoulli&amp;dest=/" rel="noopener ugc nofollow" target="_blank"/>。</p></div></div>    
</body>
</html>