<html>
<head>
<title>PokéGraph Part IV: Linear Regression with TigerGraph and Plotly Express</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PokéGraph第四部分:使用TigerGraph和Plotly Express进行线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pok%C3%A9graph-part-iv-linear-regression-with-tigergraph-and-plotly-express-d9210247d995?source=collection_archive---------43-----------------------#2021-06-27">https://towardsdatascience.com/pok%C3%A9graph-part-iv-linear-regression-with-tigergraph-and-plotly-express-d9210247d995?source=collection_archive---------43-----------------------#2021-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="699d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用Plotly Express可视化您的TigerGraph数据</h2></div><blockquote class="kf kg kh"><p id="d59e" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">注:本博客假设你有这里的数据:<a class="ae lf" rel="noopener" target="_blank" href="/pokégraph-part-ii-writing-schema-change-jobs-for-tigergraph-d6e4d6d4aba0">https://towards data science . com/pok % C3 % a9 graph-part-ii-writing-schema-change-jobs-for-tiger graph-d 6 E4 d 4 ABA 0</a><br/>它是本的更新版本:<a class="ae lf" href="https://shreya-chaudhary.medium.com/linear-regression-with-a-graph-database-e71db5c1b3f3" rel="noopener">https://shre ya-chaud hary . medium . com/linear-regression-with-a-graph-database-e 71 db 5 C1 B3 f 3</a>。</p></blockquote><h1 id="a084" class="lg lh iq bd li lj lk ll lm ln lo lp lq jw lr jx ls jz lt ka lu kc lv kd lw lx bi translated">目标</h1><p id="03ae" class="pw-post-body-paragraph ki kj iq kl b km ly jr ko kp lz ju kr ma mb ku kv mc md ky kz me mf lc ld le ij bi translated">在过去的博客中，我们已经创建了我们的图表——完成了模式、加载数据和一些模式更改工作——并学习了一点GSQL。现在，让我们通过创建一个线性回归模型将所有这些放在一起。我们将通过使用GSQL来使用我们的TigerGraph神奇宝贝数据，然后我们将使用Plotly Express将其放入交互式UI中。我们的线性回归将使用神奇宝贝的重量和高度，按类型进行颜色编码，并在悬停数据中包含神奇宝贝的名称。我们开始吧！</p><h1 id="45ca" class="lg lh iq bd li lj lk ll lm ln lo lp lq jw lr jx ls jz lt ka lu kc lv kd lw lx bi translated">步骤1:设置解决方案并导入库</h1><p id="4029" class="pw-post-body-paragraph ki kj iq kl b km ly jr ko kp lz ju kr ma mb ku kv mc md ky kz me mf lc ld le ij bi translated">首先，你需要准备好你的解决方案。正如以前的博客所显示的，在<a class="ae lf" href="https://tgcloud.io/app/solutions" rel="noopener ugc nofollow" target="_blank">https://tgcloud.io/app/solutions</a>中，确保你的解决方案旁边有一个绿点，并显示准备好了。</p><p id="6d47" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">接下来，确保您安装了pyTigerGraph。在Colab中，在其中一个单元格中键入以下内容:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="dc8f" class="mp lh iq ml b gy mq mr l ms mt">!pip install pyTigerGraph</span></pre><p id="32e7" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">安装完成后，你可以将pyTigerGraph与Plotly Express和Pandas一起导入。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="287c" class="mp lh iq ml b gy mq mr l ms mt">import pyTigerGraph as tg<br/>import plotly.express as px<br/>import pandas as pd</span></pre><p id="f4ea" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">最后，创建与您的图表的连接:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="1ae3" class="mp lh iq ml b gy mq mr l ms mt">conn = tg.TigerGraphConnection(host="https://SUBDOMAIN.i.tgcloud.io", password="PASSWORD", graphname="PokemonGraph")</span><span id="270a" class="mp lh iq ml b gy mu mr l ms mt">conn.apiToken = conn.getToken(conn.createSecret())</span></pre><p id="1d97" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">当然，用它们各自的值替换子域和密码。</p><h1 id="0c6d" class="lg lh iq bd li lj lk ll lm ln lo lp lq jw lr jx ls jz lt ka lu kc lv kd lw lx bi translated">步骤二:创建和运行查询</h1><p id="ca09" class="pw-post-body-paragraph ki kj iq kl b km ly jr ko kp lz ju kr ma mb ku kv mc md ky kz me mf lc ld le ij bi translated">现在，让我们创建一个查询来获取我们需要的所有变量。为此，我们需要重量、高度、类型和名称。所有这些都是全局列表累计累加器。重量和高度将是INT类型，类型和名称将是STRING类型。最后，我将添加一个最终的全局type_set SetAccum <string>。这将让我们在最后创建一个彩色地图，对线性回归中的点进行颜色编码。总的来说，我们的变量如下所示:</string></p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="2275" class="mp lh iq ml b gy mq mr l ms mt">ListAccum&lt;INT&gt; @@heights, @@weights;<br/>ListAccum&lt;STRING&gt; @@names, @@types;<br/>SetAccum&lt;STRING&gt; @@types_set;</span></pre><blockquote class="kf kg kh"><p id="dc20" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">记住:@@代表全局变量，@代表局部变量。</p></blockquote><p id="cd31" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">然后，对于我们的种子，我们只需抓取我们所有的神奇宝贝:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="7ddd" class="mp lh iq ml b gy mq mr l ms mt">catchThemAll = {Pokemon.*};</span></pre><p id="e503" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">现在，对于我们的选择查询，我们将从口袋妖怪顶点开始，经过Pokemon类型的边，然后在类型顶点结束。然后，在ACCUM子句中，我们将更新所有的累加器。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="4b1a" class="mp lh iq ml b gy mq mr l ms mt">Res = SELECT t FROM catchThemAll:p-(POKEMON_TYPE:e)-Type:t<br/>      ACCUM @@heights+=p.height, @@weights+=p.weight,<br/>            @@names+=p.name, @@types+=t.type_id,<br/>            @@types_set+=t.type_id;</span></pre><blockquote class="kf kg kh"><p id="c376" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">记住:对于累加器来说，a +=不一定意味着加一个值。可以把它看作是“激活”累加器或给累加器的计算增加一个值(可以是平均值、最大值、最小值、列表、集合等。).</p></blockquote><p id="1011" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">最后，让我们打印出所有的累加器。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="620a" class="mp lh iq ml b gy mq mr l ms mt">PRINT @@heights, @@weights, @@names, @@types, @@types_set;</span></pre><p id="31db" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">太棒了。让我们将所有这些放在一个查询中，并使用pyTigerGraph安装它。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="b8dc" class="mp lh iq ml b gy mq mr l ms mt">print(conn.gsql('''</span><span id="97be" class="mp lh iq ml b gy mu mr l ms mt">DROP QUERY getAttributes</span><span id="2152" class="mp lh iq ml b gy mu mr l ms mt">CREATE QUERY getAttributes() FOR GRAPH PokemonGraph {</span><span id="c046" class="mp lh iq ml b gy mu mr l ms mt">   ListAccum&lt;INT&gt; @@heights, @@weights;<br/>   ListAccum&lt;STRING&gt; @@names, @@types;<br/>   SetAccum&lt;STRING&gt; @@types_set;</span><span id="2dcc" class="mp lh iq ml b gy mu mr l ms mt">   catchThemAll = {Pokemon.*};</span><span id="f599" class="mp lh iq ml b gy mu mr l ms mt">   Res = SELECT t FROM catchThemAll:p-(POKEMON_TYPE:e)-Type:t<br/>         ACCUM @@heights+=p.height, @@weights+=p.weight,<br/>               @@names+=p.name, @@types+=t.type_id,<br/>               @@types_set+=t.type_id;</span><span id="1089" class="mp lh iq ml b gy mu mr l ms mt">   PRINT @@heights, @@weights, @@names, @@types, @@types_set;</span><span id="012d" class="mp lh iq ml b gy mu mr l ms mt">}</span><span id="573c" class="mp lh iq ml b gy mu mr l ms mt">INSTALL QUERY getAttributes</span><span id="b30b" class="mp lh iq ml b gy mu mr l ms mt">'''))</span></pre><blockquote class="kf kg kh"><p id="aaec" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">注意:安装可能需要几分钟时间。</p></blockquote><p id="661e" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">太好了！我们快到了！现在让我们使用这些值来创建线性回归。</p><h1 id="0500" class="lg lh iq bd li lj lk ll lm ln lo lp lq jw lr jx ls jz lt ka lu kc lv kd lw lx bi translated">第三步:创建线性回归</h1><p id="267d" class="pw-post-body-paragraph ki kj iq kl b km ly jr ko kp lz ju kr ma mb ku kv mc md ky kz me mf lc ld le ij bi translated">首先，让我们运行刚刚编写的查询，并获取第一个打印函数的结果(在索引0处)。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="8c44" class="mp lh iq ml b gy mq mr l ms mt">att = conn.runInstalledQuery("getAttributes")[0]</span></pre><p id="aefa" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">接下来，我们将att的值赋给各个Python变量。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="9cfc" class="mp lh iq ml b gy mq mr l ms mt">heights, weights, types, names = att["@@heights"], att["@@weights"], att["@@types"], att["@@names"]</span></pre><p id="547f" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">然后，我们将创建一个彩色地图，并分配价值。在这种情况下，我将取0-1之间的所有值，但任何范围都可以。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="24fe" class="mp lh iq ml b gy mq mr l ms mt">colour_map = {val : num for num, val in (enumerate(att["@@types_set"]))}</span><span id="6dde" class="mp lh iq ml b gy mu mr l ms mt">colours = [colour_map[i]/len(att["@@types_set"]) for i in types]</span></pre><p id="5a18" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">最后，我们将使用我们的数据创建一个熊猫数据框架。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="d6c2" class="mp lh iq ml b gy mq mr l ms mt">d = {'height': heights, 'weight': weights, 'type': types, 'name': names, 'type_by_colour': colours}</span><span id="1ee2" class="mp lh iq ml b gy mu mr l ms mt">df = pd.DataFrame(data=d)</span></pre><p id="b1f4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">然后我们可以使用Plotly Express绘制它！</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="b757" class="mp lh iq ml b gy mq mr l ms mt">fig = px.scatter(df, x="height", y="weight", color="type_by_colour", title="Pokemon by Height/Weight and Types", hover_name=names, hover_data=['name', 'type'], trendline="ols")</span><span id="dbee" class="mp lh iq ml b gy mu mr l ms mt">fig.show()</span></pre><p id="5994" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">volia，我们得到这个线性回归！</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mv"><img src="../Images/05b204e3c14a45cdc5c0d8d31f30c23a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSMH7ZuZ-dzpqdLqC8xYWQ.png"/></div></div><p class="nd ne gj gh gi nf ng bd b be z dk translated">结果线性回归</p></figure><h1 id="acb6" class="lg lh iq bd li lj lk ll lm ln lo lp lq jw lr jx ls jz lt ka lu kc lv kd lw lx bi translated">第四步:探索线性回归</h1><p id="a957" class="pw-post-body-paragraph ki kj iq kl b km ly jr ko kp lz ju kr ma mb ku kv mc md ky kz me mf lc ld le ij bi translated">似乎线性回归不是最好的。如果你将鼠标悬停在线上，你可以看到R是0.468573。您还可以找到关于这条线的其他细节，例如悬停区域的重量和高度值以及这条线的方程。</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nh"><img src="../Images/fb128e2de1f7ced03bde8725e8dca041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSThsPW4lGBFn2NiSUbmHg.png"/></div></div><p class="nd ne gj gh gi nf ng bd b be z dk translated">通过将鼠标悬停在线上，您可以找到关于该线的更多信息。</p></figure><p id="fbd6" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">你可以将鼠标悬停在某个点上，以获得关于口袋妖怪的详细信息。</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ni"><img src="../Images/de88cabb2a253c09249c31549faa2807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ilx6m-n5WImzvtSfdwEdOQ.png"/></div></div><p class="nd ne gj gh gi nf ng bd b be z dk translated">盘旋在塞莱斯提拉上空</p></figure><p id="ac87" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">在这种情况下，口袋妖怪是celesteela，体重9.999k，身高92个单位。Celesteela是钢的类型。最后，它给出了钢的色数，约为0.27778。</p><p id="d560" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">如果在某个位置单击并拖动，可以放大区域。要缩小，只需双击。</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nj"><img src="../Images/8c6a873ef0f310292f555193daa441c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VI5o9NhiXbiL6tMQnpCdNw.png"/></div></div><p class="nd ne gj gh gi nf ng bd b be z dk translated">放大线性回归</p></figure><h1 id="76c7" class="lg lh iq bd li lj lk ll lm ln lo lp lq jw lr jx ls jz lt ka lu kc lv kd lw lx bi translated">第五步:资源+祝贺！</h1><p id="c3e8" class="pw-post-body-paragraph ki kj iq kl b km ly jr ko kp lz ju kr ma mb ku kv mc md ky kz me mf lc ld le ij bi translated">恭喜你。您使用来自TigerGraph的数据用Plotly Express创建了一个线性回归！如果您想了解更多关于TigerGraph的信息，加入更多与TigerGraph相关的项目，询问关于TigerGraph的问题，或者只是与社区讨论TigerGraph，请随时加入Discord:</p><div class="nk nl gp gr nm nn"><a href="https://discord.gg/gRHWBZNpxW" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">加入TigerGraph Discord服务器！</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">在Discord上查看TigerGraph社区——与569名其他成员一起闲逛，享受免费的语音和文本聊天。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">不和谐. gg</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob nb nn"/></div></div></a></div><p id="7ebf" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">您可以在开发者门户网站找到更多TigerGraph工具:</p><div class="nk nl gp gr nm nn"><a href="https://developers.tigergraph.com/" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">TigerGraph开发者网站</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">所有TigerGraph开发者内容的一站式商店。探索学习、TigerGraph项目和我们生动的…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">developers.tigergraph.com</p></div></div></div></a></div><p id="bc27" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">了解如何使用TigerGraph编写查询:</p><div class="nk nl gp gr nm nn"><a href="https://docs.tigergraph.com/dev/gsql-ref/querying/select-statement" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">选择指令</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">注意:从TigerGraph 2.6开始，GSQL查询语言现在有两个版本。两者都可以在…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">docs.tigergraph.com</p></div></div><div class="nw l"><div class="oc l ny nz oa nw ob nb nn"/></div></div></a></div><p id="b8eb" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr ma kt ku kv mc kx ky kz me lb lc ld le ij bi translated">点击此处查看Plotly Express的线性回归文档:</p><div class="nk nl gp gr nm nn"><a href="https://plotly.com/python-api-reference/generated/plotly.express.scatter" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">plotly.express.scatter - 5.0.0文档</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">在散点图中，的每一行都由2D空间中的符号标记表示。参数数据帧(数据帧或…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">plotly.com</p></div></div></div></a></div></div></div>    
</body>
</html>