<html>
<head>
<title>Customize Your Pandas Data Frame For Effective Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">定制您的熊猫数据框以进行有效的数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/customize-your-pandas-data-frame-for-effective-data-analysis-ffa8b98630fb?source=collection_archive---------16-----------------------#2021-10-20">https://towardsdatascience.com/customize-your-pandas-data-frame-for-effective-data-analysis-ffa8b98630fb?source=collection_archive---------16-----------------------#2021-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a75" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Pandas Styler增强您的分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dc2208b5731ff4bf18dc1076174a3399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KnxRwW0d72Rx9ao1"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@d_kuruvilla?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹尼尔·库鲁维拉</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="5293" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="fc7e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Pandas是一个强大的数据操作和分析包，我相信这个库对你们很多人来说并不陌生。然而，有时当我以表格形式分析数据时，我观察到的都是简单的数字，很难注意到值的特征。我想，如果我能在我的Pandas数据框中应用更多的可视化组件或条件格式，那就太好了。</p><p id="f714" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">幸运的是，我找到了<strong class="lt iu"> <em class="ms"> Styler对象。</em> </strong>这个表格可视化工具真的让数据框很有诱惑力，信息量大，很多情况下容易跟踪。</p><h1 id="d897" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Styler对象是什么？</h1><p id="ccd2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据加载到数据框后，我们可以设置表格的样式。Styler下的基本动作机制是制作一个HTML表格，应用CSS样式来管理颜色、背景、字体等不同属性。<code class="fe mt mu mv mw b">DataFrame.style</code>属性返回一个<strong class="lt iu"> <em class="ms">样式器</em> </strong>对象。它支持Jupyter Notebook中的自动渲染，因为它定义了一个<code class="fe mt mu mv mw b">_repr_html_</code>方法。</p><p id="17c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们看看<strong class="lt iu"> <em class="ms"> Styler </em> </strong>可以对我们的数据表做些什么。</p><p id="6b3a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，让我们创建一个简单的数据，这样我就可以详细解释这个有效的工具。在我的数据集中，您可以看到产品名称和价格，以及购买这些产品的人的名单。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/d563824460d61e488ba7992f9197ad6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*2cZIM9kNf584a53jW1be9Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:数据框架——作者图片</p></figure><h1 id="1064" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">隐藏列</h1><p id="ea89" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果我不需要<strong class="lt iu">“owner”</strong>列，并且想暂时从数据中隐藏它，我可以使用<code class="fe mt mu mv mw b">hide_columns()</code>方法。</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="4be4" class="ne la it mw b gy nf ng l nh ni">df.style.hide_columns('price')</span></pre><p id="dc15" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如你所看到的，下面的结果已经隐藏了<strong class="lt iu">【拥有者】</strong>列。</p><p id="875b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">输出:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/3dab895b31474bb54de0b5433bf82050.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*UN-CdZFXLA-c5RoLqF4Tog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:隐藏的所有者列—作者图片</p></figure><h1 id="93dc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">突出显示空值</h1><p id="44ca" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">注意空值在分析中很重要。为了观察这些空值，我们可以突出显示它们以便于观察。<code class="fe mt mu mv mw b">highlight_null</code>在这种情况下使用属性。例如，在我的数据集中，我可以看到我的表数据没有Mike购买的产品名称。</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="86a1" class="ne la it mw b gy nf ng l nh ni">df.style.highlight_null(null_color="yellow")</span></pre><p id="8257" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">T29】输出:T31】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/f9d660dc1f92b8c740015cc704548927.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*L1DLGdCOh2XwwcLKPxlNYg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3:突出显示空值—作者图片</p></figure><h1 id="e009" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">突出显示最小/最大值</strong></h1><p id="3aaf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果我想知道谁购买的最多或最少，我可以在列表中用<code class="fe mt mu mv mw b">highlight_min</code>和<code class="fe mt mu mv mw b">highlight_max</code>突出显示最小/最大购买金额。</p><p id="8cf5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们看看谁花钱最多:</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="77f5" class="ne la it mw b gy nf ng l nh ni">df.groupby('owner').agg({'price':'sum'}).reset_index().style.highlight_max(color = 'green') </span></pre><p id="071d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">输出:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/6793bd98d2ac95f2e5a36684b7a73355.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*HKYp0zuO3oQ9VzE8tAKksg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4:突出最大价值——作者图片。</p></figure><p id="1746" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以669的消费金额，罗斯是购买最多的人。</p><p id="fe83" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">同样，通过应用<code class="fe mt mu mv mw b">highlight_min</code>，很明显珍是花费最少的人。</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="0b54" class="ne la it mw b gy nf ng l nh ni">df.groupby('owner').agg({'price':'sum'}).reset_index().style.highlight_min(color = 'red')</span></pre><p id="d788" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">输出:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/23e76c1e6ad55d89f418401730e4cc9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*KoQpcxjnq_-xoSjVHtNdYA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:突出显示最小值——作者图片。</p></figure><h1 id="3f64" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">突出显示分位数</h1><p id="2432" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您也可以突出显示由分位数定义的值。例如，在这种情况下，我想突出显示所有产品价格的90%百分比值。我可以用<code class="fe mt mu mv mw b">highlight_quantile</code>做到</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="507f" class="ne la it mw b gy nf ng l nh ni">df[['price']].style.highlight_quantile(q_left=0.9, axis=None, color='yellow') </span></pre><p id="1ac8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">输出:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/536a8c68a9c619b4b4cad809abe0f449.png" data-original-src="https://miro.medium.com/v2/resize:fit:188/format:webp/1*RzUBhIoi4Rt8EfDHrbaY1A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:突出显示90%的分位数值——作者图片</p></figure><h1 id="cec0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建热图</h1><p id="054e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">热图有助于使用颜色阴影显示值。颜色阴影越强烈，数值越大。您可以选择使用背景渐变或文本渐变方法自定义热图。</p><p id="5e28" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，要为包含5个不同类别A、B、C、D、E中的值的数据集创建热图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/fdda4672bd2f5b9f0de4a341067ae341.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*KWipwmUv2Iaj-hOIj1ZyQQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:数据集df3 -作者图片</p></figure><p id="56a6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们可以应用<code class="fe mt mu mv mw b">style.background_gradient</code>我们甚至可以结合<strong class="lt iu"> <em class="ms"> seaborn </em> </strong>来获得更好的颜色。</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="0805" class="ne la it mw b gy nf ng l nh ni">import seaborn as sns<br/>cm = sns.light_palette("pink", as_cmap=True)<br/>df3.style.background_gradient(cmap=cm) </span></pre><p id="ceae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">输出:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/009f46bbdc8123852846c41af17e9c71.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*7JOnIBnlS3Hbj1GSRQ9XkA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8:热图渐变背景—作者图片</p></figure><p id="92a7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们不想用背景颜色定制我们的表格，我们可以考虑使用<code class="fe mt mu mv mw b">text_gradient</code>方法。</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="3273" class="ne la it mw b gy nf ng l nh ni">cm = sns.light_palette("green", as_cmap=True)<br/>df3.style.text_gradient(cmap=cm)</span></pre><p id="d2d7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">T31】输出:T33】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9aaf54e714fb797992a077886be053e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*6ZLRx2lXy9uyxTtFKQ11TQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9:文本渐变—作者图片</p></figure><h1 id="14af" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建条形图</h1><p id="2335" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在您可以让<code class="fe mt mu mv mw b">df.style.bar</code>以零值为中心，并且您可以将一个列表<code class="fe mt mu mv mw b">[color_negative, color_positive]</code>传递给这些值以获得您的条形图。</p><p id="381f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我会以负/正条形图的形式展示我的价值观。看这个，是不是很容易区分正负价值。</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="821d" class="ne la it mw b gy nf ng l nh ni">df3.style.bar(subset=['A', 'B'], align="zero", color=['pink', 'lightgreen'])</span></pre><p id="7349" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">T35】输出:T37】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ea1c877c5e5f768feb341ff6ac7221cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*9GV-__sirIqRdhbH8IE8ug.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10:正负条形图</p></figure><h1 id="9d0d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">添加标题</h1><p id="afbd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在分析报告中，通常有许多数据框。为了了解每个数据帧描述的内容并区分它们，可以添加标题以获得更详细的信息。</p><p id="1c59" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，我想将我的热图表命名为<strong class="lt iu">“Chi Nguyen Medium Data”</strong>。我可以通过使用<code class="fe mt mu mv mw b">style</code>的<code class="fe mt mu mv mw b">set_caption</code>属性来实现</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="d45c" class="ne la it mw b gy nf ng l nh ni">df3.style.set_caption("Chi Nguyen Medium Data").background_gradient()</span></pre><p id="6dcf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">输出:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/db4e312a55d32c1bf8c6cddf772fb964.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*T9wD_RVbZ579dNaikDiWlg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11:添加的标题——作者的图片</p></figure><h1 id="d8f4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">用你自己的方式设计</h1><p id="c203" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尽管有许多方法可用于设置数据框的样式，但在某些情况下，您将需要自己的自定义函数来完成任务。让我们用一个例子来看看如何创建你的函数。</p><p id="fcf7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我的数据集中，我想说明所有大于其列平均值的值。我将用蓝色突出显示较大的值，用粉色突出显示较小的值。下面是我如何定义我的函数并返回结果。</p><pre class="kj kk kl km gt na mw nb nc aw nd bi"><span id="157a" class="ne la it mw b gy nf ng l nh ni">#Define function<br/>def mean_greater(m):<br/>    greater = m &gt; m.mean()<br/>    return ['background-color: lightblue' if i else 'background-color: pink' for i in greater]</span><span id="2c9d" class="ne la it mw b gy nt ng l nh ni">#Apply function<br/>df3.style.apply(mean_greater)</span></pre><p id="117e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">输出:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/5735b85141a9f9032bc6d94037969858.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*-8FUzsueSTr05wAiAR1kwA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图12:突出显示值</p></figure><h1 id="4663" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="fc44" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">虽然设计数据框架只是分析中非常小的一步，但我相信灵活定制不同的设计方法可以帮助提高我们的分析速度，并为我们提供更全面的观察和数据见解。</p><p id="c843" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从最容易的，看似最不重要的开始，一点一点地积累你的技能，这从来都不过分。</p><h1 id="8502" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">参考</h1><div class="nv nw gp gr nx ny"><a href="https://pandas.pydata.org/docs/user_guide/style.html#Styler-Functions" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">表格可视化- pandas 1.3.4文档</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">本节演示如何使用Styler类可视化表格数据。有关可视化的信息，请使用…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">pandas.pydata.org</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>