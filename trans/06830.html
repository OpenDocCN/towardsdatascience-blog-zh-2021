<html>
<head>
<title>🔥Wildfire Modeling in Yosemite National Park</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">🔥约塞米蒂国家公园的野火建模</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/wildfire-modeling-in-yosemite-national-park-666f45c9a0a0?source=collection_archive---------21-----------------------#2021-06-20">https://towardsdatascience.com/wildfire-modeling-in-yosemite-national-park-666f45c9a0a0?source=collection_archive---------21-----------------------#2021-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f430904f0215a7691d70a173c94a9258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8HqxJEtv31Q8ytUR"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@parachutel_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">李晟</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="da1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章将重点介绍我们在<a class="ae kc" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本</a>中使用<a class="ae kc" href="https://earthengine.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌地球引擎</a> (GEE)、<a class="ae kc" href="https://geemap.org/" rel="noopener ugc nofollow" target="_blank"> geemap、</a> <a class="ae kc" href="https://geopandas.org/" rel="noopener ugc nofollow" target="_blank"> GeoPandas </a>和<a class="ae kc" href="https://grass.osgeo.org/" rel="noopener ugc nofollow" target="_blank"> GRASS GIS </a>对野火事件建模的教程中最重要的部分。通过我们的教程，你可以在2020年夏季在美国加州约塞米蒂国家公园的三个区域进行火灾模拟(<code class="fe lb lc ld le b">from 2020-06-20 through 2020-09-22</code>)。它有三个主要部分:<strong class="kf ir">获取数据、导入数据和Wildfire模拟。</strong></p><p id="7795" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本教程源于<em class="lf"> </em> <a class="ae kc" href="https://ig.conae.unc.edu.ar/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> Mario Gulich高级空间研究所</strong> </a>组织的<em class="lf"> </em>使用GRASS GIS软件进行地理空间数据处理和分析研讨会的最终工作，由<a class="ae kc" href="https://veroandreo.gitlab.io/" rel="noopener ugc nofollow" target="_blank"> Veronica Andreo博士授课。</a></p><blockquote class="lg lh li"><p id="5906" class="kd ke lf kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">我们教程的完整代码可以在:<a class="ae kc" href="https://github.com/acoiman/wildfire_modeling" rel="noopener ugc nofollow" target="_blank">https://github.com/acoiman/wildfire_modeling</a>找到</p></blockquote></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="3585" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">1.获取数据</h1><p id="e6e6" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">获取模型所需的数据可能是一项艰巨的任务。有时，数据不容易获得，因为它们很少或分散在广泛的来源中。在本节中，我们将向您展示一种为wildfire建模目的轻松收集数据的方法。下表显示了本教程中使用的数据。</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="6003" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本教程假设您正在一个Jupyter笔记本和一个Python环境中工作，其中包含所有必需的包。您还需要安装最新版本的GRASS GIS并拥有一个有效的GEE帐户。我们的Python环境基于Ubuntu 20.04上的Anaconda安装。您需要安装以下不包含在Anaconda中的包:Geopandas、GEE Python API、eeconvert、geemap。</p><h1 id="2863" class="lt lu iq bd lv lw nc ly lz ma nd mc md me ne mg mh mi nf mk ml mm ng mo mp mq bi translated">1.2从GEE下载数据</h1><p id="4a5f" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">我们将调用WDPA要素集合(FC)并提取约塞米蒂国家公园多边形。我们将把提取的FC转换为地理数据框架(GDF ),并将其作为shapefile保存到我们的工作目录中。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="5165" class="nl lu iq le b gy nm nn l no np"># get World Data Protected Areas (WDPA) FeatureCollection<br/>pa = ee.FeatureCollection("WCMC/WDPA/current/polygons")</span><span id="f2db" class="nl lu iq le b gy nq nn l no np"># Yosemite National Park polygon<br/>filter = ee.Filter.inList('NAME', ['Yosemite National Park'])<br/>yosemite = pa.filter(filter)</span><span id="db23" class="nl lu iq le b gy nq nn l no np"># transform Yosemite fc into gdf<br/>yosGDF = eeconvert.fcToGdf(yosemite)</span><span id="df65" class="nl lu iq le b gy nq nn l no np"># convert gdf into shp<br/>yosGDF.to_file("gisdata/yosemite/shp/yosemite.shp")</span></pre><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/f85813311096d88eb5faa12d75595468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GiZca5nIT8FCY8t-PBOdAQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者照片</p></figure><p id="ca6c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了从GEE获得100小时的燃料湿度、风向和风速数据，我们首先需要调用GRIDMET ImageCollection并按日期过滤。其次，我们将创建一个矩形，用于裁剪数据。接下来，我们将选择所需的数据并计算模式。生成的图像将被裁剪为之前创建的多边形。之后，我们将创建2000个随机点，用于使用平均值对图像进行采样。最后，生成的FC将被转换为地理数据框架，并作为shapefile保存到我们的工作目录中。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="aae3" class="nl lu iq le b gy nm nn l no np"># load GRIDMET ImageCollection<br/>gridmet = ee.ImageCollection('IDAHO_EPSCOR/GRIDMET').filter(ee.Filter.date('2020-06-20', '2020-09-22'));</span><span id="f314" class="nl lu iq le b gy nq nn l no np"># create a rectangle<br/>coords = [-120.10157709250639,37.36645735913506,-118.99122199244081,38.31280791348237]<br/>bbox = ee.Geometry.Rectangle(coords)</span><span id="bb48" class="nl lu iq le b gy nq nn l no np"># select 100-hour dead fuel moisture (fm100) and calculate the mode<br/>fm100 = gridmet.select('fm100').mode()<br/># clip data to rectangle<br/>fm100_clip =fm100.clip(bbox)</span><span id="edba" class="nl lu iq le b gy nq nn l no np"># create 2000 random points<br/>fm100_points = ee.FeatureCollection.randomPoints(bbox, 2000);<br/># sample points using the mean<br/>samplefm100 = fm100_clip.reduceRegions(**{<br/>  'collection':fm100_points,<br/>  'reducer':ee.Reducer.mean(), <br/>  'scale': 4000, <br/>  });</span><span id="a6a3" class="nl lu iq le b gy nq nn l no np"># transform fc into gdf<br/>samplefm100GDF = eeconvert.fcToGdf(samplefm100)</span><span id="35e0" class="nl lu iq le b gy nq nn l no np"># convert gdf into shp<br/>samplefm100GDF.to_file("gisdata/yosemite/shp/samplefm100.shp")</span></pre><p id="9ace" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将通过调用Landsat 8 Collection 1 Tier 1 32天EVI合成图从GEE下载<a class="ae kc" href="https://en.wikipedia.org/wiki/Enhanced_vegetation_index#:~:text=The%20enhanced%20vegetation%20index%20(EVI,a%20reduction%20in%20atmosphere%20influences." rel="noopener ugc nofollow" target="_blank"> EVI </a>数据，使用Yosemite FC按日期和边界过滤。接下来，我们将计算一个平均图像，并使用之前创建的多边形对其进行裁剪。最后，剪辑后的图像将被导出到我们的Google Drive存储器中，然后我们将它下载到我们的工作目录中。</p><p id="0a3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了运行我们的火灾模拟，我们需要一个由美国农业部林务局定义的燃料模型。在这种情况下，我们将使用https://landfire.cr.usgs.gov/fbfm13.php的<a class="ae kc" href="https://landfire.cr.usgs.gov/fbfm13.php" rel="noopener ugc nofollow" target="_blank">提供的13 Anderson Fire Behavior燃料模型。该模型有13类燃料，其负载、分布和颗粒大小各不相同(Petrasova等人，2018年)。</a></p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="10d4" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">2.导入数据</h1><p id="a137" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">现在，我们将继续导入从GEE和其他来源下载的数据。这一部分包括设置我们的GRASS GIS环境和导入数据本身。</p><p id="e7ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当在Jupyter笔记本中设置GRASS时，我们使用Python来初始化GRASS GIS。首先，我们创建一个GRASS GIS运行时环境，方法是传递一个变量GRASS GIS“所在”的目录，并将其绑定到Python目录。接下来，我们导入GRASS GIS包。之后，我们设置默认字体显示和覆盖行为，以避免每次执行命令时添加`— overwrite '标志。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="46e3" class="nl lu iq le b gy nm nn l no np"># create GRASS GIS runtime environment<br/>gisbase = subprocess.check_output(["grass", "--config", "path"], text=True).strip() # directory where GRASS GIS lives<br/>os.environ['GISBASE'] = gisbase<br/>sys.path.append(os.path.join(gisbase, "etc", "python"))</span><span id="26c5" class="nl lu iq le b gy nq nn l no np"># import grass gis package<br/>import grass.script as gs<br/>import grass.script.setup as gsetup<br/>from grass.pygrass.modules import Module<br/>from grass import script<br/>from grass.pygrass.modules.shortcuts import raster as r, vector as v, general as g, display as d<br/>from grass.pygrass.modules import Module as run_command<br/>import grass.imaging as imaging</span><span id="7a06" class="nl lu iq le b gy nq nn l no np"># default font displays<br/>os.environ['GRASS_FONT'] = 'sans'</span><span id="2abb" class="nl lu iq le b gy nq nn l no np"># overwrite existing maps<br/>os.environ['GRASS_OVERWRITE'] = '1'<br/>gs.set_raise_on_error(True)<br/>gs.set_capture_stderr(True)</span></pre><p id="1d9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们之前需要使用GUI在GRASS GIS中创建一个位置来运行以下单元。在我们的例子中，我们创建了一个名为yosemite_3310_2的位置和一个名为wf_mod_2的地图集。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="c8ee" class="nl lu iq le b gy nm nn l no np"># set GRASS GIS session data<br/>cfile = gsetup.init(gisbase, "grassdata", "yosemite_3310_2", "PERMANENT")</span><span id="5c4f" class="nl lu iq le b gy nq nn l no np"># create a new maset inside yosemite_3310_2 location<br/>g.mapset(flags='c', mapset='wf_mod_2', location='yosemite_3310_2')</span><span id="9f9c" class="nl lu iq le b gy nq nn l no np"># set GRASS GIS session data<br/>cfile = gsetup.init(gisbase, "grassdata", "yosemite_3310_2", "wf_mod_2");</span></pre><h1 id="9cd5" class="lt lu iq bd lv lw nc ly lz ma nd mc md me ne mg mh mi nf mk ml mm ng mo mp mq bi translated">2.2加载数据</h1><p id="14e1" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在这一小节中，我们将上传运行火灾模拟所需的所有数据集。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="ab32" class="nl lu iq le b gy nm nn l no np"># import Yosemite National Park vector<br/>script.run_command('v.import', input='gisdata/yosemite/shp/yosemite.shp',output='yosemite')</span><span id="a088" class="nl lu iq le b gy nq nn l no np"># import evi raster<br/>script.run_command('r.import', input='gisdata/yosemite/raster/evi.tif', output='evi',resolution='value', resolution_value=30.0)</span><span id="b9a3" class="nl lu iq le b gy nq nn l no np"># import fm 100h samples<br/>script.run_command('v.import', input='gisdata/yosemite/shp/samplefm100.shp',output='samplefm100')</span><span id="f353" class="nl lu iq le b gy nq nn l no np"># import vs (wind velocity) samples<br/>script.run_command('v.import', input='gisdata/yosemite/shp/samplevs.shp', output='samplevs')</span><span id="ec76" class="nl lu iq le b gy nq nn l no np"># import th (wind direction) samples<br/>script.run_command('v.import', input='gisdata/yosemite/shp/sampleth.shp',output='sampleth')</span><span id="e786" class="nl lu iq le b gy nq nn l no np"># import landsat image<br/>script.run_command('r.import', input='gisdata/yosemite/raster/landsat/landsat.tif',output='landsat',resolution='value', resolution_value=30.0);</span></pre><p id="3eef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">GRASS GIS最大的特点之一是有一个不断增长的<a class="ae kc" href="https://grass.osgeo.org/download/addons/" rel="noopener ugc nofollow" target="_blank">插件列表</a>，可以很容易地安装在您本地的GRASS GIS中，并用于执行特定的分析。在我们的例子中，我们没有从GEE下载DEM，而是使用了<a class="ae kc" href="https://grass.osgeo.org/grass78/manuals/addons/r.in.nasadem.html" rel="noopener ugc nofollow" target="_blank"> <em class="lf">模块。</em></a></p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="857a" class="nl lu iq le b gy nm nn l no np">r.in.nasadem user="my_nasa_user" password="my_nasa_pw" output=dem memory=2000 resolution=30</span></pre></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="dc9a" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">3.野火模拟</h1><p id="c415" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在我们的教程中，我们模拟了约塞米蒂国家公园三个地区的野火蔓延，见下图。我们将从每个区域的导入数据中获取新数据，模拟不同持续时间的火灾事件，并可视化野火传播。这篇文章只向你展示了我们如何在第三个研究区域模拟野火。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/18c9aa9012ba77cf813d2b6fbe8ab54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*eBzT7XZ3WS5NYmEtkQN0Ag.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者照片</p></figure><h1 id="551f" class="lt lu iq bd lv lw nc ly lz ma nd mc md me ne mg mh mi nf mk ml mm ng mo mp mq bi translated">3.1研究区域3</h1><p id="9fe8" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">3号研究区位于约塞米蒂国家公园的中东部。主要的可燃物类型是覆盖面积为29.70%的封闭木材凋落物和覆盖面积为21.67%的木材(草地和林下植被)。要了解更多关于燃料种类的信息，请点击<a class="ae kc" href="https://iftdss.firenet.gov/firenetHelp/help/pageHelp/content/10-mapstudio/files/fbfmsummaries.htm" rel="noopener ugc nofollow" target="_blank">这里</a>。根据:USGS国家土地覆盖数据库(Yang et al .，2018)，该地区主要由常绿林(51%)、灌木/灌丛(34%)和草地/草本(5%)覆盖。</p><h1 id="ae31" class="lt lu iq bd lv lw nc ly lz ma nd mc md me ne mg mh mi nf mk ml mm ng mo mp mq bi translated">3.2计算数据</h1><p id="f382" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">野火事件建模分为两步。首先，我们执行GRASS <a class="ae kc" href="https://grass.osgeo.org/grass78/manuals/r.ros.html" rel="noopener ugc nofollow" target="_blank"> r.ros </a>模块，该模块生成扩展率(ros)栅格地图。其次，我们运行GRASS <a class="ae kc" href="https://grass.osgeo.org/grass79/manuals/r.spread.html" rel="noopener ugc nofollow" target="_blank"> r.spread </a>模块来模拟椭圆各向异性扩散。</p><p id="c614" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们假设有风且地形陡峭，r.ros模块需要以下输入:</p><blockquote class="lg lh li"><p id="2a6e" class="kd ke lf kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">- moisture_1h: <em class="iq">包含1小时燃油湿度(%)的光栅图。</em> <br/> - moisture_live: <em class="iq">包含live燃料水分(%)的栅格地图。<br/> - </em>速度:<em class="iq">包含风速的栅格地图(英尺/分钟)。<br/> </em> -方向:<em class="iq">包含风向(度)的栅格地图。<br/> </em> -坡度:<em class="iq">包含坡度(度)的栅格地图。<br/> </em> -坡向:<em class="iq">包含坡向度数的光栅地图。</em></p></blockquote><p id="7b54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了完成这项工作，我们将创建并应用一个Python函数。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="8b77" class="nl lu iq le b gy nm nn l no np">caldata('sa_2R', '_sa_2')</span></pre><h1 id="c178" class="lt lu iq bd lv lw nc ly lz ma nd mc md me ne mg mh mi nf mk ml mm ng mo mp mq bi translated">3.3建模</h1><p id="8728" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">现在，我们将为我们的研究区域3运行<em class="lf"> r.ros </em>模块。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="23d2" class="nl lu iq le b gy nm nn l no np"># generates rate of spread raster map<br/>r.ros(model='fuel', moisture_1h='moisture_1h_sa_3', moisture_live='lfm_sa_3_scaled', velocity='wind_speed_sa_3', direction='wind_dir_sa_3', slope='slope_sa_3', aspect='aspect_sa_3',elevation='dem', base_ros='out_base_ros',max_ros='out_max_ros',direction_ros='out_dir_ros',spotting_distance='out_spotting');</span></pre><p id="98a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将创建一个点栅格地图，它将被用作我们的火焰模拟的源。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="5c68" class="nl lu iq le b gy nm nn l no np"># create a vector map from an ASCII points <br/>script.run_command('v.in.ascii',input='gisdata/yosemite/csv/source_3.txt',output='source_3', separator='comma')</span><span id="fb56" class="nl lu iq le b gy nq nn l no np"># rasterize vector map <br/>script.run_command('v.to.rast', input='source_3', output='source_3', type='point', use='cat');</span></pre><p id="5884" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过r.spread模块，我们将模拟32小时的野火事件。我们的第一个模拟周期是480分钟(8小时)，因为当前模拟的初始时间是0(默认值)，我们的滞后是480分钟。请注意，我们使用“s”标志，因为我们正在考虑<a class="ae kc" href="https://www.nwcg.gov/publications/pms437/crown-fire/spotting-fire-behavior#TOC-Estimating-Maximum-Spotting-Distance" rel="noopener ugc nofollow" target="_blank">定位距离</a>。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="88d3" class="nl lu iq le b gy nm nn l no np"># elliptically anisotropic spread simulation 8 hours source 3<br/>r.spread(flags="s", base_ros='out_dir_ros', max_ros='out_max_ros',direction_ros='out_dir_ros', start='source_3',spotting_distance='out_spotting', wind_speed='wind_speed_sa_3', fuel_moisture='moisture_1h_sa_3', output='spread_8h_s3', lag=480)</span><span id="a262" class="nl lu iq le b gy nq nn l no np"># elliptically anisotropic spread simulation 24 hours source 3<br/>script.run_command('r.spread', flags='si', base_ros='out_dir_ros', max_ros='out_max_ros',direction_ros='out_dir_ros', start='spread_16h_s3',spotting_distance='out_spotting', wind_speed='wind_speed_sa_3',fuel_moisture='moisture_1h_sa_3', output='spread_24h_s3', lag=480, init_time=960);</span></pre><p id="651a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">执行r.ros和r.spread模块后，我们现在可以可视化我们的结果。在这种情况下，我们将使用GRASS GIS命令创建四个框架。每一帧将包含每个时间滞后的扩散栅格的速率、指示模拟源的矢量、Landsat图像的CIR(彩色红外)合成以及相应的标题、图例、比例和指北针。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="b968" class="nl lu iq le b gy nm nn l no np"># display monitor and save image file<br/>d.mon(start='cairo', output='gisdata/yosemite/images/sa_3_frame.png', width=800, height=700)</span><span id="251d" class="nl lu iq le b gy nq nn l no np"># remove all frames<br/>d.frame(flags='e')</span><span id="0251" class="nl lu iq le b gy nq nn l no np"># frame spread_8h_s3# create upper-left frame<br/>d.frame(flags='c', frame='first', at=(50,100,0,50))</span><span id="2ad6" class="nl lu iq le b gy nq nn l no np"># add raster map landsat cir<br/>d.rast(map='landsat_cir_sa_3')</span><span id="79ff" class="nl lu iq le b gy nq nn l no np"># add raster map spread_8h_s3<br/>d.rast(map='spread_8h_s3')</span><span id="2e6a" class="nl lu iq le b gy nq nn l no np"># add vector map source_3<br/>d.vect(map='source_3', size=25, icon='basic/pin_dot', color='green',legend_label='Source 3')</span><span id="0225" class="nl lu iq le b gy nq nn l no np"># add title<br/>d.text(text='Fire Spread 8h', bgcolor=('255:255:204'),color='black', size=6)</span><span id="616f" class="nl lu iq le b gy nq nn l no np"># add north arrow<br/>script.run_command('d.northarrow', flags='t', style='9',at=(85,85), fill_color=('0:0:0'),color='none')</span><span id="4e4c" class="nl lu iq le b gy nq nn l no np"># add raster legend<br/>script.run_command('d.legend', flags='sb', raster='spread_32h_s3_reclass',at=(5,60, 81, 83), title='Spread (%)', title_fontsize= 7, bgcolor=('255:255:204'), border_color='none')</span><span id="170e" class="nl lu iq le b gy nq nn l no np"># add vector legend<br/>script.run_command('d.legend.vect', flags='b', at=(7,15), symbol_size=10, fontsize=12,border_color='none', bgcolor=('255:255:204'))</span><span id="ce01" class="nl lu iq le b gy nq nn l no np"># add bar scale<br/>script.run_command('d.barscale', bgcolor=('255:255:204'), at=(40,10), style='line',length=2, units='kilometers', width_scale=0.5)<br/>...</span></pre><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/404ca033c2c725aaaec9f7508b802a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qp4hXdhW16B2niuNZH4m1Q.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者照片</p></figure><p id="378e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们将使用GRASS GIS图像包创建可视化的动画gif图像。</p><pre class="mw mx my mz gt nh le ni nj aw nk bi"><span id="2ac1" class="nl lu iq le b gy nm nn l no np"># create the animated gif with GRASS Python imaging package<br/>imaging.images2gif.writeGifPillow('gisdata/yosemite/images/Animation_Sa_3_2.gif',images, duration=2, repeat=True)</span></pre><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/d80d13a10910a70a3de53a9c1aff335f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*f0ZaTb-vQAd1VvuZHHhTJw.gif"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者照片</p></figure></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="08da" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">4.结论</h1><p id="1d79" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">本教程演示了我们可以将GRASS GIS、Google Earth Engine和Jupyter Notebook集成到一个独特的开发环境中。但是，为了将GEE和Geopandas对象传递到GRASS GIS模块中，还需要做更多的工作。</p><p id="55a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以模拟受过去火灾事件影响的地区的野火，以比较模拟和真实的火灾。</p><p id="5579" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">火灾模拟的结果表明，输出栅格不会与非植被区域重叠。在我们的例子中，火灾模拟在大区域表现更好，因为我们的基本空间分辨率是30米，这适合于区域尺度的研究。</p><blockquote class="lg lh li"><p id="af99" class="kd ke lf kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">一如既往，欢迎任何与此相关的反馈！</p></blockquote></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="59f8" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">5.参考</h1><p id="5561" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">彼得拉索娃、哈蒙、佩特拉什、大不里士和米塔索娃(2018年)。野火蔓延模拟。开源GIS的有形建模(第155-163页)。斯普林格，查姆。</p><p id="921d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">杨、l、金、s、丹尼尔森、p、霍默、c、加斯、l、凯斯、a、科斯特洛、c、德维茨、j、弗莱、j、芬克、m、格兰内曼、b、里格、m和g .西安。2018，新一代美国国家土地覆盖数据库:需求、研究重点、设计和实施策略，第108–123页。</p></div></div>    
</body>
</html>