<html>
<head>
<title>Collect Data from Twitter: A Step-by-Step Implementation Using Tweepy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从 Twitter 收集数据:使用 Tweepy 的逐步实现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/collect-data-from-twitter-a-step-by-step-implementation-using-tweepy-7526fff2cb31?source=collection_archive---------8-----------------------#2021-11-23">https://towardsdatascience.com/collect-data-from-twitter-a-step-by-step-implementation-using-tweepy-7526fff2cb31?source=collection_archive---------8-----------------------#2021-11-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="721e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">本文是使用 tweepy 从 Twitter 收集数据的全面概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/895489f6073f99f5156b55e98cac9dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MPYMHh7NfR72sjCV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">布雷特·乔丹在<a class="ae ky" href="https://unsplash.com/photos/4UgUpo3YdKk" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="1711" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="43c0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">获取数据是任何数据科学/机器学习项目生命周期的第二步，就在框定你想要解决的问题之后，这将使这一步成为其余阶段的支柱。此外，社交媒体是收集数据的好地方，尤其是用于竞争对手分析、话题研究、情感分析等。本文旨在逐步实现如何获取凭证，并在一个简单的用例上实现。</p><h2 id="b84c" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">Twitter，一个相关的数据收集场所</h2><blockquote class="mz na nb"><p id="1d70" class="lr ls nc lt b lu nd ju lw lx ne jx lz nf ng mc md nh ni mg mh nj nk mk ml mm im bi translated">Twitter 拥有 3.13 亿活跃用户(<a class="ae ky" href="https://journals.sagepub.com/doi/full/10.1177/1609406917750782#" rel="noopener ugc nofollow" target="_blank"> Statista，2017 </a>)，这意味着这种数据收集方法可以减少基于研究人员地理位置和研究资源的研究参与障碍。它还可以最大限度地利用资源，包括时间、精力和便利</p></blockquote><h2 id="337d" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated"><strong class="ak">Tweepy 的实现示例</strong></h2><p id="2f16" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在执行任何类型的分析之前，要执行的第一个操作是获取您的 Twitter 认证凭证，如下所述。</p><p id="ab9d" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><strong class="lt iu">获取认证凭证</strong></p><ol class=""><li id="e14a" class="nl nm it lt b lu nd lx ne ma nn me no mi np mm nq nr ns nt bi translated"><em class="nc">注册开发者账户</em></li></ol><p id="4974" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><a class="ae ky" href="https://developer.twitter.com/en/portal/dashboard" rel="noopener ugc nofollow" target="_blank">这里的</a>是进入下一页的链接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/bb2158604f0d674e49b0c13f62677414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzLPs3tiXmfwCl8x1rS-Ag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="72e9" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><em class="nc"> 2。获取您的认证凭证</em></p><p id="a86a" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated">在此页面上，创建一个项目并回答所有问题。然后，您将获得包含所有凭证的以下页面。确保你不会与任何人分享这些信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/e988e4fcb863230ffdb9a44c2f5d15cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6sT94apKOVamO5-3E9Wig.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="1482" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><strong class="lt iu">实施要求</strong></p><ul class=""><li id="a6e4" class="nl nm it lt b lu nd lx ne ma nn me no mi np mm nw nr ns nt bi translated">安装 tweepy 模块</li></ul><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="3dac" class="mn la it ny b gy oc od l oe of">pip install tweepy # install the tweepy module</span></pre><ul class=""><li id="0738" class="nl nm it lt b lu nd lx ne ma nn me no mi np mm nw nr ns nt bi translated">导入所需的模块</li></ul><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="417f" class="mn la it ny b gy oc od l oe of">import tweepy # tweepy module to interact with Twitter<br/>import pandas as pd # Pandas library to create dataframes<br/>from tweepy import OAuthHandler # Used for authentication<br/>from tweepy import Cursor # Used to perform pagination</span></pre><p id="e7a7" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><strong class="lt iu"> Python 实现</strong></p><ul class=""><li id="a2b5" class="nl nm it lt b lu nd lx ne ma nn me no mi np mm nw nr ns nt bi translated">实现实用函数来获取 tweets: <br/>在这个例子中有三个主要的函数。(1)认证功能。(2)为了与 Twitter API 交互的客户端功能。(3)最后一个功能，收集推文并创建一个数据框，其中包含关于给定 Twitter 帐户的一些特定信息。收集的信息如下:<br/> &gt;推文的创建日期<br/> &gt;推文的作者<strong class="lt iu">推文的作者</strong><br/>&gt;与推特账户上的名字相对应的<strong class="lt iu">网名</strong><br/>&gt;<strong class="lt iu">该推文获得的点赞数</strong><br/>&gt;推文转发数<strong class="lt iu"/></li></ul><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="b0f5" class="mn la it ny b gy oc od l oe of">"""<br/>Twitter Authentification Credentials<br/>Please update with your own credentials<br/>"""<br/>cons_key = ''<br/>cons_secret = ''<br/>acc_token = ''<br/>acc_secret = ''</span><span id="6dc5" class="mn la it ny b gy og od l oe of"># (1). Athentication Function<br/>def get_twitter_auth():<br/>    """<br/>    <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>:<br/>        - the authentification to Twitter<br/>    """<br/>    try:<br/>        consumer_key = cons_key<br/>        consumer_secret = cons_secret<br/>        access_token = acc_token<br/>        access_secret = acc_secret<br/>        <br/>    except KeyError:<br/>        sys.stderr.write("Twitter Environment Variable not Set\n")<br/>        sys.exit(1)<br/>        <br/>    auth = tweepy.OAuthHandler(consumer_key, consumer_secret)<br/>    auth.set_access_token(access_token, access_secret)<br/>    <br/>    return auth</span><span id="3db3" class="mn la it ny b gy og od l oe of"># (2). Client function to access the authentication API<br/>def get_twitter_client():<br/>    """<br/>    <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>:<br/>        - the client to access the authentification API<br/>    """<br/>    auth = get_twitter_auth()<br/>    client = tweepy.API(auth, wait_on_rate_limit=True)<br/>    return client<br/></span><span id="b1a3" class="mn la it ny b gy og od l oe of"># (3). Function creating final dataframe<br/>def get_tweets_from_user(twitter_user_name, page_limit=16, count_tweet=200):<br/>    """<br/>    <a class="ae ky" href="http://twitter.com/params" rel="noopener ugc nofollow" target="_blank">@params</a>:<br/>        - twitter_user_name: the twitter username of a user (company, etc.)<br/>        - page_limit: the total number of pages (max=16)<br/>        - count_tweet: maximum number to be retrieved from a page<br/>        <br/>    <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a><br/>        - all the tweets from the user twitter_user_name<br/>    """<br/>    client = get_twitter_client()<br/>    <br/>    all_tweets = []<br/>    <br/>    for page in Cursor(client.user_timeline, <br/>                        screen_name=twitter_user_name, <br/>                        count=count_tweet).pages(page_limit):<br/>        for tweet in page:<br/>            parsed_tweet = {}<br/>            parsed_tweet['date'] = tweet.created_at<br/>            parsed_tweet['author'] = tweet.user.name<br/>            parsed_tweet['twitter_name'] = tweet.user.screen_name<br/>            parsed_tweet['text'] = tweet.text<br/>            parsed_tweet['number_of_likes'] = tweet.favorite_count<br/>            parsed_tweet['number_of_retweets'] = tweet.retweet_count<br/>                <br/>            all_tweets.append(parsed_tweet)<br/>    <br/>    # Create dataframe <br/>    df = pd.DataFrame(all_tweets)<br/>    <br/>    # Revome duplicates if there are any<br/>    df = df.drop_duplicates( "text" , keep='first')<br/>    <br/>    return df</span></pre><p id="e35d" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated">所有的功能最终都实现了，现在我们可以继续收集数据了。比方说，我们想收集谷歌人工智能的推文。创建数据框的函数将 Twitter 用户名/屏幕名称作为强制参数，在本例中，它是<strong class="lt iu"> GoogleAI </strong>，没有@符号。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/862259930079dfda79dad53475b5e8db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luJ2iVL2GJErO9n2MHfKyQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自作者定制的<a class="ae ky" href="https://twitter.com/GoogleAI" rel="noopener ugc nofollow" target="_blank"> GoogleAI Twitter 账户</a></p></figure><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="d59e" class="mn la it ny b gy oc od l oe of">googleAI = get_tweets_from_user("GoogleAI")</span><span id="b19c" class="mn la it ny b gy og od l oe of">print("Data Shape: {}".format(googleAI.shape))</span></pre><p id="88d8" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><strong class="lt iu"> <em class="nc">打印</em> </strong>指令显示<strong class="lt iu"> <em class="nc">数据形状:(1743，6) </em> </strong>含义我们有 1743 条来自 Google AI 的推文，下面的<strong class="lt iu"> <em class="nc">。head(10) </em> </strong>给出了数据帧中的前 10 条推文</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="0319" class="mn la it ny b gy oc od l oe of">googleAI.head(10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/f39e48e8903f3118d99bb3e49138bb06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KE8rAIgWHkMC9je3ZcXJKg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">googleAI.head 的结果(10)</p></figure><h2 id="cc59" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">tweepy 的优点和缺点</h2><p id="ad16" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">优点</strong></p><ul class=""><li id="01f2" class="nl nm it lt b lu nd lx ne ma nn me no mi np mm nw nr ns nt bi translated">写得很好的文档，有一个非常活跃的社区</li><li id="9207" class="nl nm it lt b lu oj lx ok ma ol me om mi on mm nw nr ns nt bi translated">提供关于给定推文的许多特征(例如，关于推文的地理位置的信息，等等。)</li></ul><p id="4577" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><strong class="lt iu">缺点</strong></p><ul class=""><li id="27aa" class="nl nm it lt b lu nd lx ne ma nn me no mi np mm nw nr ns nt bi translated">将用户限制在时间线中的最后 3200 条推文。</li></ul><h2 id="8ccc" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">文章结尾</h2><p id="a8af" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本文中，您了解了如何获得 Twitter 开发人员证书，以及如何使用 tweepy 从 Twitter 获取数据。此外，您已经了解了该工具的局限性和优点。</p><p id="5ec5" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated">如需进一步阅读，请随时查阅以下链接:</p><h2 id="6d70" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">额外资源</h2><p id="bc6d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://github.com/keitazoumana/Social-Media-Scraping/blob/main/Twitter%20Scraping.ipynb" rel="noopener ugc nofollow" target="_blank">Github 上的源代码</a></p><p id="a251" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><a class="ae ky" href="https://developer.twitter.com/en/docs/twitter-api/tools-and-libraries/v2" rel="noopener ugc nofollow" target="_blank"> Twitter 开发者文档</a></p><p id="bc49" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><a class="ae ky" href="https://docs.tweepy.org/en/latest/" rel="noopener ugc nofollow" target="_blank">十二页文档</a></p><p id="2c6d" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><a class="ae ky" href="https://pypi.org/project/twint/" rel="noopener ugc nofollow" target="_blank"> Twint 文档</a></p><p id="0ef7" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><a class="ae ky" href="https://developer.twitter.com/en/docs/twitter-api/getting-started/getting-access-to-the-twitter-api" rel="noopener ugc nofollow" target="_blank">如何访问 Twitter API </a></p><p id="3e8c" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated"><a class="ae ky" href="https://journals.sagepub.com/doi/full/10.1177/1609406917750782" rel="noopener ugc nofollow" target="_blank">使用 Twitter 收集医疗保健消费者的数据:范围审查</a></p><p id="0314" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma ng mc md me ni mg mh mi nk mk ml mm im bi translated">再见🏃🏾</p></div></div>    
</body>
</html>