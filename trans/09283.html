<html>
<head>
<title>Improve Linear Regression for Time Series Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测的改进线性回归方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/improve-linear-regression-for-time-series-forecasting-e36f3c3e3534?source=collection_archive---------15-----------------------#2021-08-28">https://towardsdatascience.com/improve-linear-regression-for-time-series-forecasting-e36f3c3e3534?source=collection_archive---------15-----------------------#2021-08-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4b83" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">结合线性模型和决策树进行更好的预测</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f17ab910bb0c6d81545055cd154919b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S60F_S8Sslf3TOpZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">帕特里夏·瑟纳在Unsplash<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍摄的照片</a></p></figure><p id="75d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时间序列预测是一项非常有趣的任务。然而，<strong class="lb iu">构建一个机器学习算法来预测未来数据比预期的要棘手</strong>。最难处理的是数据中存在的时间依赖性。就其本质而言，时间序列数据会发生变化。这可能导致各种类型的时间漂移，这可能使我们的算法不准确。</p><p id="b14d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我推荐的一个最好的技巧是，当建模一个时间序列问题时，保持简单。<strong class="lb iu">大多数时候，就准确性和适应性而言，越简单的解决方案越好</strong>。它们也更容易维护或嵌入，对可能的数据转移更持久。从这个意义上说，时间序列建模的黄金标准在于采用基于线性的算法。它们需要很少的假设和简单的数据操作来产生令人满意的结果。</p><p id="d660" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们执行销售预测任务。我们使用标准线性回归及其改进版本提供未来预测。我们指的是<strong class="lb iu">线性树</strong>。它们与经典决策树一样，属于模型树家族，但它们是不同的，因为它们计算线性近似(而不是常数)来拟合树叶中的简单线性模型。计算训练以评估数据上拟合多个线性模型的最佳分区。最终模型是基于树的结构，在叶子中具有线性模型。</p><p id="c90b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">线性树的python实现在<a class="ae ky" href="https://github.com/cerlymarco/linear-tree" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Linear-tree</strong></a>:<em class="lv">一个python库，用叶子上的线性模型构建模型树。</em>该软件包可与sklearn完全集成。它提供了简单的基本估计器，这些估计器包装了<code class="fe lw lx ly lz b">sklearn.linear_model</code>中出现的每个线性模型，以构建一个最优的线性树。</p><h1 id="e715" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">数据</h1><p id="e3e4" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">在我们的实验中，我们模拟了一些复制商店销售的数据。我们生成400家商店的人工销售历史。其中商店销售受许多因素影响，包括促销、假期和季节性。我们的职责是提前一年预测未来的日销售额。</p><p id="9796" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们提供预测时，我们不使用任何过去的信息。我们设计所有的回归变量，使其在未来的任何时期都是准确和可访问的。这使我们能够提供长期预测。</p><p id="e708" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有400家店铺，拥有不同年份的历史销售额，每日都有明显的季节性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/b4b1fa864d54d99efbb0292853abbb01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*154TZ-fl9i6eI5hqsWlAfw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模拟店铺销售系列(图片由作者提供)</p></figure><h1 id="9528" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">建模</h1><p id="5bc6" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">我们的目标是预测未来一年我们所有商店的销售额。为了实现这一点，我们在商店层面建立了一个不同的模型。我们对每个商店的训练集进行独立的参数调整。我们以400个特别训练的模型结束。该程序是计算拟合简单的线性回归和线性树。以这种方式，我们可以通过比较两种模型类型在看不见的测试数据上的性能来验证400个独立拟合的良好性。</p><p id="908f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">训练线性树就像训练标准线性回归一样简单。当我们训练线性树时，我们只是在不同的数据分区上拟合多个线性模型。我们可以清楚地理解，我们受益于相同的优点，即简单的预处理和良好的解释能力。</p><p id="1062" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查各种拟合的树路径，我们可以理解算法所采取的决策。在线性树的情况下，我们确定哪些特征负责分割原始数据集，并提供进一步拟合的好处。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/4bc6c8afa1ce2aa8441e2b52991ab37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYokj-1M3BN3-ayoOJ4lDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不同商店安装的不同线性树的学习树路径(图片由作者提供)</p></figure><p id="d5e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，不同的模型用于不同的月份、一年中的不同周，或者一周中的不同天。这并不奇怪，因为单一的线性回归不能很好地概括所提供的整个数据集。线性树直接查看数据，评估并选择最佳分区，而不是手动搜索完美的数据分区。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/6652aee3c0f820723c5f8611975e4d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*csKR8V21WXR6ZtEJRILnlg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自测试数据的预测和真实值(图片由作者提供)</p></figure><p id="131a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于线性回归的测试数据的预测在平均值附近看起来更稳定。用线性树作出的预测很好地适应了数据，更好地适应了各种季节模式并再现了峰值。最后，我们比较了这两种模型的性能。根据测试数据，我们计算所有商店的均方根误差(RMSE)。这使我们能够验证线性树比线性回归好多少倍。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/6e2cde3d8b61977b8ea6a61ce9c47173.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*Fs4E4vJKq06m4W69zA4WBw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在预测商店销售额方面，线性树优于线性回归多少倍(反之亦然)</p></figure><p id="87b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在10倍的测试中，线性树的表现似乎超过了经典线性回归的9倍。这对我们来说是一个很好的结果，这意味着在我们的场景中使用线性树有优势。</p><h1 id="5202" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">摘要</h1><p id="1d57" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">在这篇文章中，我们使用线性模型进行了时间序列预测。我们测试了简单的线性回归和线性树来预测综合的未来商店销售额。结果很有趣。线性树学习更好的数据表示，在大多数情况下提供更准确的预测。这可以简单地通过在按照简单的决策规则获得的指定数据分区中拟合多个线性回归来实现。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="b07a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/cerlymarco/MEDIUM_NoteBook" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">查看我的GITHUB回购</strong> </a></p><p id="ad00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保持联系:<a class="ae ky" href="https://www.linkedin.com/in/marco-cerliani-b0bba714b/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a></p></div></div>    
</body>
</html>