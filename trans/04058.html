<html>
<head>
<title>Kickstart a Big Data Project with AWS EMR and Pyspark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用AWS EMR和Pyspark启动大数据项目</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/kickstart-a-big-data-project-with-aws-emr-and-pyspark-38da9b34564a?source=collection_archive---------38-----------------------#2021-04-05">https://towardsdatascience.com/kickstart-a-big-data-project-with-aws-emr-and-pyspark-38da9b34564a?source=collection_archive---------38-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4b02" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用亚马逊网络服务上的视频游戏数据进行可扩展的数据分析和机器学习</h2></div><p id="ce1e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">读者们好，我想写一篇关于我在日常工作中使用的AWS服务的文章，名为<a class="ae lb" href="https://aws.amazon.com/emr" rel="noopener ugc nofollow" target="_blank"> EMR </a>。这项服务曾经“轻松运行和扩展Apache Spark、Hive、Presto和其他大数据框架。”。在本文中，我将在一个开源数据集上利用这个服务，用Pyspark做一些ETL工作和简单的分析/预测。</p><h1 id="1283" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">数据设置</h1><p id="f5e3" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">对于这个实验，还有什么比育碧开源数据集更好的呢？有一个叫做<a class="ae lb" href="https://www.ubisoft.com/en-us/game/rainbow-six/siege/news-updates/2fQ8bGRr6SlS7B4u5jpVt1/introduction-to-the-data-peek-velvet-shell-statistics" rel="noopener ugc nofollow" target="_blank">的数据偷窥</a>(来源:育碧网站，从细节上看人们可以免费使用，没有提到许可证)可以完成这项工作。我将画一个简短的设置描述，但我会邀请你阅读<a class="ae lb" href="https://www.ubisoft.com/en-us/game/rainbow-six/siege/news-updates/2fQ8bGRr6SlS7B4u5jpVt1/introduction-to-the-data-peek-velvet-shell-statistics" rel="noopener ugc nofollow" target="_blank">的文章</a>解释更多的数据。</p><p id="8161" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个项目使用的数据来自对游戏<a class="ae lb" href="https://www.ubisoft.com/en-us/game/rainbow-six/siege" rel="noopener ugc nofollow" target="_blank">彩虹六号围攻</a>的跟踪，这是一款由育碧蒙特利尔工作室开发的在线战术第一人称射击游戏，于2015年12月发布，目前仍在一个重要的社区中直播(该游戏在一个月前达到了<a class="ae lb" href="https://venturebeat.com/2021/02/09/rainbow-six-siege-2/" rel="noopener ugc nofollow" target="_blank">7000万玩家</a>)。本文将不会详细介绍彩虹六号围攻的游戏是如何构建的(但它看起来像一个反恐精英游戏，其中的角色被称为具有独特能力和装载的操作员)。尽管如此，我还是邀请你看看这个视频来理解其中的逻辑。</p><p id="e03a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新的内容会定期添加到每三个月一次的季节中，并带来新的角色、化妆品、地图、模式(今年<a class="ae lb" href="https://www.youtube.com/watch?v=a_UdQGvKVAc" rel="noopener ugc nofollow" target="_blank">有计划</a>😄).在本文中，收集的数据将集中在第二年的第一季，称为<a class="ae lb" href="https://www.ubisoft.com/fr-ca/game/rainbow-six/siege/game-info/seasons/velvetshell" rel="noopener ugc nofollow" target="_blank">天鹅绒壳</a>行动。</p><p id="a3b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这一季中，增加了两个新的运营商和一个新的地图。</p><p id="f51a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在赛季期间，有几个补丁(在游戏中更新以调整/修复一些东西)已经部署(<a class="ae lb" href="https://www.reddit.com/r/Rainbow6/wiki/patchnotes" rel="noopener ugc nofollow" target="_blank">来源</a>):</p><ul class=""><li id="d501" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated"><a class="ae lb" href="https://rainbow6.ubisoft.com/siege/en-us/game-info/seasons/velvetshell/index.aspx" rel="noopener ugc nofollow" target="_blank">2017年2月7日更新2.1.0:天鹅绒外壳</a></li><li id="d21f" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://forums.ubi.com/showthread.php/1580736" rel="noopener ugc nofollow" target="_blank">2017年2月21日更新2.1.1 </a></li><li id="9969" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://rainbow6.ubisoft.com/siege/en-us/game-info/seasons/velvetshell/reinforcements.aspx" rel="noopener ugc nofollow" target="_blank">2017年3月15日更新2.1.2:季中增援</a></li><li id="0ed7" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://forums.ubi.com/showthread.php/1631242-PC-Server-Maintenance-18APR2017" rel="noopener ugc nofollow" target="_blank"> BattlEye更新</a>2017年4月18日，针对PC</li><li id="754b" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="http://forums.ubi.com/showthread.php/1636409-PS4-XB1-PC-Maintenance-19-04?s=00f594100e7fa7d203f9187cad674d35" rel="noopener ugc nofollow" target="_blank">2017年4月19日更新2.1.3 </a></li><li id="e387" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://forums.ubi.com/showthread.php/1638512-PS4-Server-Maintenance-4-21-2017" rel="noopener ugc nofollow" target="_blank">热修复</a>2017年4月21日，针对PS4</li><li id="57fd" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://forums.ubi.com/showthread.php/1644863-Completed-PC-Server-Maintenance-26Apr2017" rel="noopener ugc nofollow" target="_blank">热修复</a>2017年4月26日，针对PC</li><li id="d950" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://forums.ubi.com/showthread.php/1646550-COMPLETE-PS4-XB1-Maintenance-28-04" rel="noopener ugc nofollow" target="_blank">热修复</a>2017年4月28日，针对主机</li><li id="8f12" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://forums.ubi.com/showthread.php/1651426-PS4-XB1-PC-Server-Maintenance-5-2-2017" rel="noopener ugc nofollow" target="_blank">维修</a>2017年5月2日</li><li id="8110" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lb" href="https://forums.ubi.com/showthread.php/1663425-COMPLETE-PS4-XB1-PC-Server-Maintenance-5-10-2017" rel="noopener ugc nofollow" target="_blank">热修复</a>2017年5月10日</li></ul><p id="ad45" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将重点关注包含分级模式下匹配配置的大数据(19 Gb文件)。</p><h1 id="8208" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">EMR设置</h1><p id="1fd9" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">使用EMR，您可以非常快速地生成一个称为集群的机器舰队，以高效的方式使用大数据框架(著名的分布式计算)。我是一个more Spark用户(pyspark for life ),来介绍一下我在这种情况下的设置。</p><p id="5885" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着时间的推移，已经发布了各种版本的EMR ,但目前主要有两个分支:</p><p id="6352" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">版本之间的两个主要区别是6.x上的Pypsark版本是spark的第3版，而5.x上的版本仍然是第2版。火花的x。请注意，每个版本都有其优点和缺点，所以请记住这一点(例如，在S3管理的文件类型)。</p><p id="8697" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，用于测试的版本<a class="ae lb" href="https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-release-5x.html" rel="noopener ugc nofollow" target="_blank"> EMR 5.31.0 </a>(我试图使用5.32，但它不能很好地与EMR笔记本配合使用)。有一个安装在工作机器上的软件列表。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mn"><img src="../Images/0f77b438be3fdc3876d67983946be61a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HHcCWTuoBE9NIhsL.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="e6c1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可能有很多软件(甚至Tensorflow)，但就我而言，更有用的是Spark、Hadoop。</p><p id="ad5d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为主要是为了测试，所以我只使用M5 . XL大型机器(一个主机和三个内核)。配置是相对的，很小，但我不需要更多(老实说，我正在使用这种方法，但我确信一台机器足以处理这些数据#showoff)。</p><p id="76fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在设置机器的步骤中，可以选择为将在这个集群上运行的应用程序添加一些<a class="ae lb" href="https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-configure-apps.html" rel="noopener ugc nofollow" target="_blank">配置参数</a>；这叫分类(你可以在这里找到我的<a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/setup/configuration.json" rel="noopener ugc nofollow" target="_blank"/>)。在这个配置文件中，有:</p><ul class=""><li id="ff71" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">一个与访问胶合数据目录相关的关键是轻松地构建和保存配置单元表(我将在后面解释)</li><li id="80c7" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">Livy配置避免了(至少延迟了)spark应用程序著名的会话超时，如果Spark应用程序什么都不做，就会发生这种超时。</li></ul><p id="2a3e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当集群启动时，您可以修改您的应用程序，但是这样，每次您正在生成时，一切都将准备就绪(小建议，如果您使用此功能将文件存储在S3，本地编辑器不太方便更新此配置字典)</p><p id="9c4b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为EMR领域的数据科学家，我发现一个非常有用的附加功能是<a class="ae lb" href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-managed-notebooks.html" rel="noopener ugc nofollow" target="_blank"> EMR笔记本</a>，您可以将它附加到一个集群，以便在jupyter/lab环境中利用spark内核。如果集群终止，所有的笔记本都会保存下来(之前我使用的是安装在集群上的jupyterhub软件，这很好，但是如果集群关闭，你会失去一切。</p><p id="99fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">EMR上的notebook的一个优点是能够快速建立一些探索所需的正确库；有一个<a class="ae lb" href="https://aws.amazon.com/blogs/big-data/install-python-libraries-on-a-running-cluster-with-emr-notebooks/" rel="noopener ugc nofollow" target="_blank">很棒的资源</a>正在介绍使用这个特性的方法。</p><p id="9b5f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然设置很简单，那么让我们在分析数据之前先看看处理阶段。</p><h1 id="6c87" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">抽取、转换、加载至目的端（extract-transform-load的缩写）</h1><p id="f015" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">需要进行一个<a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/emr_notebooks/0_collect.ipynb" rel="noopener ugc nofollow" target="_blank">预处理阶段</a>来转换配置单元表中的CSV文件。要开始这一步的处理，需要做两件事:</p><ul class=""><li id="e546" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">将CSV文件复制到s3 bucket中(在特定的子文件夹中)</li><li id="40e9" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">构建一个指向另一个s3位置的数据库，以存储预处理的文件，这些文件将成为配置单元表的数据。</li></ul><p id="0035" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这个实验，由hive表组成的文件的格式将是parquet，但是也可以存储为其他类型。我使用笔记本来构建表，这些新数据可以从AWS Athena等其他服务中访问。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nd"><img src="../Images/c7848ea75a68a1ed01fb72b3c75765d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9C4urdNBSpyABFj9.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="62da" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">包含关于由dateid(游戏服务器中数据的创建日期)划分的玩家的玩家信息的表格有助于赛季数据的导航。一些图表显示了可用的匹配数、平台上的重新分配和游戏模式，以说明新构建的表。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nd"><img src="../Images/32aa385c2eebefadcdc28623bdd11495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jaAMB53bSoC5TwrN.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nd"><img src="../Images/5e13472643d128061f180e7611b4b249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bX101xH2xRq4UjtF.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="f39c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从对构建的新数据的第一次分析中可以注意到:</p><ul class=""><li id="4422" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">9187971发子弹有1588833个匹配</li><li id="6607" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">在PS4上的这个摘录中有更多的比赛(# sonyrepresents)</li><li id="cf47" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">最流行的游戏模式是PvP安全区</li></ul><p id="57c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们所看到的，这个数据集中有大量的匹配和数据要使用，但是我想应用一个健全性检查阶段来确定</p><ul class=""><li id="5bc4" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">好的比赛:两队从第一轮到最后一轮看起来都一样)并且每方有五名队员</li><li id="c8d8" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">拉基维特比赛:一个队至少失去一名队员，但每个队至少有五名队员</li><li id="3a37" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">不良匹配:匹配不符合前面的类别</li></ul><p id="1660" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在这里找到<a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/emr_notebooks/1_etl.ipynb" rel="noopener ugc nofollow" target="_blank"/>包含所有处理过程的笔记本，但在数据处理过程中需要牢记的是:</p><ul class=""><li id="3912" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">决定每场比赛的最后一轮</li><li id="e773" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">汇总每支队伍与每轮玩家等级和等级相关的信息(有一个玩家的唯一标识符，所以我们将评估如果队伍等级和技能等级不变，队伍是相同的)</li><li id="0121" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">对比一下第一轮和最后一轮的队伍。</li></ul><p id="d497" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无论如何，从这个处理过程中，有10%的匹配被认为是好的，27%是不匹配的，剩下的是坏的。</p><p id="6421" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在这个文件中找到<a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/data/match_stats.csv" rel="noopener ugc nofollow" target="_blank">关于每次匹配所计算的信息的摘录；有了这些关于比赛的信息，就可以进行更深入的分析了。</a></p><h1 id="5717" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">公平性分析</h1><p id="825a" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在对匹配做了一些度量计算之后，我想看看在好的和不公平的匹配的设置中是否有一些公平性。在一个在线游戏中，团队和队友的选择背后，有一个被称为匹配的系统，它结合了玩家的知识、当前的在线设置(位置、连接质量等)。)等一些参数。</p><p id="2851" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在配对方面的知识并不丰富，但如果你感兴趣，我将邀请你看看微软在这些主题上的工作，包括以下论文<a class="ae lb" href="https://www.microsoft.com/en-us/research/project/trueskill-ranking-system/" rel="noopener ugc nofollow" target="_blank"> Trueskill </a>、<a class="ae lb" href="https://www.microsoft.com/en-us/research/publication/trueskill-2-improved-bayesian-skill-rating-system/" rel="noopener ugc nofollow" target="_blank"> Trueskill II </a>(更侧重于开发玩家的排名指标)和<a class="ae lb" href="https://www.microsoft.com/en-us/research/project/truematch/" rel="noopener ugc nofollow" target="_blank"> True match </a>(侧重于利用玩家知识等。为了建立更好的匹配，在GDC 2020上有一个关于这个主题的精彩演讲。</p><p id="1d6c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是从一个玩家的角度来看，我并不觉得匹配很公平(有时是#badplayer，)，所以我想看看，例如，在彩虹六号的可用数据上，我们是否可以看到匹配选择中的一些问题。为了进行这种估计，我开始构建团队参考(在本例中是团队0)的胜利预测器，基于:</p><ul class=""><li id="79db" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">每个团队水平的平均值和标准差</li><li id="4c7d" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">技能等级重新划分之间的欧几里德距离(对于每个团队，我计算团队中出现的每种技能等级的团队数量)</li><li id="a70a" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">比赛的配置(平台，补丁版本，游戏模式，地图)</li></ul><p id="949a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用于进行该预测的模式是来自Spark 中mllib的<a class="ae lb" href="https://spark.apache.org/docs/latest/ml-classification-regression.html#random-forest-regression" rel="noopener ugc nofollow" target="_blank">随机森林回归器，在80%的good/ragequit匹配中进行训练，并对剩余的20%进行评估(此处的代码</a><a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/emr_notebooks/2_analysis.ipynb" rel="noopener ugc nofollow" target="_blank">为</a>)。预期是，由于有一个匹配系统，所有比赛的胜利预测应该在50%左右。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ne"><img src="../Images/b10a84ad314703d1fbaf844511fd7966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tnvdXmRry6f7xnBR.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="a7e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很高兴看到现有的系统似乎是公平的(或者至少没有太多的极端值，我认为匹配有时可以扩展研究的范围，因为缺乏适合良好匹配的可用玩家)。</p><p id="bf36" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了更深入地了解这个模型，一个图表显示了这个模型中使用的特性的重要性。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nd"><img src="../Images/57aa258620d593f97facc8bec013fb13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hrOhtU0wtXmR-GLm.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="4a88" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以注意到，平均水平和黄金等级的数量是本质特征；我们想快速查看一下预测与各队平均水平之间的差异。我们可以看到经验的不同(你期望什么)之间的关系。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nf"><img src="../Images/a6ba0f70cfb4fc0cd296c49903d31c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3rHN_y0DvdNmB2-R.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="d267" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管如此，所有这些分析都是在没有太多论述的情况下完成的:</p><ul class=""><li id="c1df" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">比赛的确切执行，老实说，通过玩游戏，你可以认识到，预测比赛的输出只基于选定的功能并不是最好的办法(也许会在另一个版本更回合的基础上工作)</li><li id="100b" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">不知道玩家的经验(地图，操作者，历史比赛)和当前赛季不是最佳的(不知道他当前的心情如赢得比赛，不知道他是否和他的常规球队一起比赛，等等。)</li></ul><p id="a091" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无论如何，这是一个用pyspark构建的非常简单的估计器，有很多问题可以构建和回答。</p><h1 id="5c0a" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">结论</h1><p id="5606" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">本文提供了一个AWS服务的机会，它可以帮助启动一些大数据框架的测试。有几个元素我在这个项目中没有用到，但可能对你的实验有用:</p><ul class=""><li id="1cd9" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">有了EMR，你可以衍生和停止集群，但你能做的是生成一个机器的集群，执行特定的脚本(称为step)并关闭机器；如果我们看到以无服务器的方式更多地使用集群(以节省成本)，这种方法会很有帮助</li><li id="eae3" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">如果EMR集群的当前设置非常有限，您可以通过使用一个名为<a class="ae lb" href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-plan-bootstrap.html" rel="noopener ugc nofollow" target="_blank"> bootstrap actions </a>的元素来安装特定的库，基本上，bags脚本将安装库、软件(如git)或文件夹来存储数据(完全值得，但对我来说不是必需的)</li><li id="fb55" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">如果您想要运行命令行脚本(例如，spark作业的spark-submit)，您可以在集群生成时设置一个ssh密钥，以便在ssh中建立连接，并作为Hadoop用户运行命令</li></ul><p id="2be6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就像事情做得很好一样，EMR和Sagemaker之间有很好的联系，这里有一个很棒的文档<a class="ae lb" href="https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-lifecycle-config-emr.html" rel="noopener ugc nofollow" target="_blank"/>，但是我会建议你遵循以下步骤(在他们的情况下，他们希望人们将它添加到生命周期中):</p><ul class=""><li id="39c5" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">添加与sagemaker笔记本关联的角色的<a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/sagemaker_connection/policy.json" rel="noopener ugc nofollow" target="_blank">跟随策略</a>(并注意sagemaker笔记本的安全组)</li><li id="50e3" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">要启动集群并将其连接到您的笔记本，需要这个<a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/sagemaker_connection/build_connect_emr.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>和一个<a class="ae lb" href="https://github.com/jeanmidevacc/aws-emr-datapeek/blob/main/sagemaker_connection/connect_emr_cluster.sh" rel="noopener ugc nofollow" target="_blank"> bash脚本</a>(由笔记本触发)</li></ul><p id="9090" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您对使用EMR for Spark不感兴趣，您可以将它与另一个框架一起使用，例如dask(这里有一个使用yarn与dask <a class="ae lb" href="https://yarn.dask.org/en/latest/" rel="noopener ugc nofollow" target="_blank">和</a>)的设置)。在你不知道dask的情况下，有一个很好的解释它是什么(以及与Spark的区别)。</p><p id="2daa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个方面，第一人称射击游戏中没有太多围绕电子游戏和在线比赛的数据集，所以我会建议人们看一看<a class="ae lb" href="https://www.ubisoft.com/en-us/game/rainbow-six/siege/news-updates/2fQ8bGRr6SlS7B4u5jpVt1/introduction-to-the-data-peek-velvet-shell-statistics" rel="noopener ugc nofollow" target="_blank">育碧</a>的这个数据集。即使他的原表单上的数据集不好用，你也可以在Kaggle上找到类似<a class="ae lb" href="https://www.kaggle.com/maxcobra/rainbow-six-siege-s5-ranked-dataset" rel="noopener ugc nofollow" target="_blank">这里</a>的更为消化的版本。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="d829" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nn">原载于2021年4月5日https://www.the-odd-dataguy.com</em><a class="ae lb" href="https://www.the-odd-dataguy.com/2021/04/05/cluster-and-video-game-data-introduction-to-aws-emr-and-pyspark/" rel="noopener ugc nofollow" target="_blank"><em class="nn"/></a><em class="nn">。</em></p></div></div>    
</body>
</html>