<html>
<head>
<title>Data Integration with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与熊猫的数据集成</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-integration-with-pandas-b7deaa4f0f31?source=collection_archive---------21-----------------------#2021-08-14">https://towardsdatascience.com/data-integration-with-pandas-b7deaa4f0f31?source=collection_archive---------21-----------------------#2021-08-14</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="c2ff" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">如何轻松导入数据</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/ef97fecc764b296edb7fd2c4bbb79008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zMkuQb0OUwITymc-PByVeQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在<a class="ae kz" href="https://unsplash.com/s/photos/pine?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kz" href="https://unsplash.com/@veverkolog?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Duan veverkolog</a>拍摄的照片</p></figure><p id="ed08" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">对于通过Jupyter Notebook进行的即席数据分析，您通常需要通过CSV、Excel或数据库获得外部数据，以便使用Python对其进行处理。多亏了<strong class="lc iv">便利的熊猫图书馆</strong>，阅读数据相对容易。在本文中，我为您总结了标准流程。当然，您也可以将相同的错误用于以后的标准化和集成的数据集成过程，比如您的数据仓库的ETL。</p><h2 id="090b" class="lw lx iu bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">主要使用案例</h2><p id="e3b1" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">下面是我选择的最常用的命令和源代码。如果你也想尝试一下，你可以简单地使用<strong class="lc iv"> Jupyter笔记本在线</strong>——点击<a class="ae kz" href="https://jupyter.org/try" rel="noopener ugc nofollow" target="_blank">这里</a>【1】。</p><p id="7367" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">从CSV文件中读取</strong></p><p id="19d1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一个非常典型的第一个用例当然是著名的CSV文件，它要么作为源系统的转储提供给您，可以在线检索，要么自动存储在一个文件夹中。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="d94b" class="lw lx iu mv b gz mz na l nb nc">import pandas as pd</span><span id="4dfd" class="lw lx iu mv b gz nd na l nb nc">pd.read_csv(‘yourfilename.csv’, header=None, nrows=5)</span></pre><p id="908a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在<strong class="lc iv">导入熊猫</strong>和<strong class="lc iv"> </strong>通过<em class="ne"> read_csv </em>导入文件后，您将已经看到成功:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nf"><img src="../Images/fe99ae1a71938a2e09ae03c3a2b4b846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0B86H06qnU6la-t976aWaA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">导入的数据-按作者分类的图像</p></figure><p id="8196" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">从谷歌工作表中读取数据</strong></p><p id="3873" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">和上面一样，但是有一个谷歌表单链接— <strong class="lc iv">注意你在</strong>之前就把表单发布到网上了。(转到文件→发布到网站[2])</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="2aa0" class="lw lx iu mv b gz mz na l nb nc">import pandas as pd</span><span id="1d10" class="lw lx iu mv b gz nd na l nb nc">new_google_sheet_url = ‘<a class="ae kz" href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8lv36OQPiqgfFjdgJF9clvwABn2Ao2xDzkIzYp2g1CqBbpLsnW5nefPsPVOKKBX2PdFVX6Mweyyut/pub?gid=1696994381&amp;single=true&amp;output=csv'" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8lv36OQPiqgfFjdgJF9clvwhhh2Ao2xDzkIzYp2g1CqBbpLsnW5nefPsPVOKKBX2PdFVX6Mweyyut/pub?gid=1696994381&amp;single=true&amp;output=csv'</a></span><span id="b2d1" class="lw lx iu mv b gz nd na l nb nc">df=pd.read_csv(new_google_sheet_url)</span></pre><p id="6053" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">瞧:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ng"><img src="../Images/54429943ea6558460ec64a6b899b4498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Newl9E8RZz6_D5hX2bwX4w.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">导入的数据-按作者分类的图像</p></figure><p id="6b67" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">从数据库中读取数据</strong></p><p id="ef12" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">除了CSV和其他类似的文件，你还会经常将数据连接到数据库——这里，除了Pandas，我们还需要sqlite3模块[3]。</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="0336" class="lw lx iu mv b gz mz na l nb nc">import pandas as pd<br/>import sqlite3</span></pre><p id="6e0b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">成功导入数据后，我们现在可以通过SQL字符串轻松地查询表:</p><pre class="kk kl km kn gu mu mv mw mx aw my bi"><span id="a0a6" class="lw lx iu mv b gz mz na l nb nc"># Read via SQLite databases<br/>con = sqlite3.connect(“your.database.link”)<br/>#Read table via Select Statement<br/>player = pd.read_sql_query(“SELECT * from Table”, con)<br/>#close the connection<br/>con.close()</span></pre><p id="8b88" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">其他可能的数据来源</strong></p><p id="0664" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">除了上面提到的标准数据源，当然还有许多其他可能的数据源，例如像Google Big Query和Amazon的Redshift这样的数据仓库技术，甚至是NoSQL数据库。在这里，你会经常找到可下载的Pythons库[4]。</p><h2 id="0cee" class="lw lx iu bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">摘要</h2><p id="389e" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">无论是通过Jupyter Notebook进行的临时数据分析，还是后来的标准化和自动化数据集成流程，通常都需要文件或数据库等外部数据源。这些可以很容易地用工具集Python、Pandas和其他可能的库连接和查询。在本文中，作为概述提到了最常用的数据源，其他数据源通常可以通过其他第三方库访问。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">来自giphy.com的Gif图片</p></figure><h2 id="b87f" class="lw lx iu bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">资料来源和进一步阅读</h2><p id="4ffc" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">[1]Jupyter.org，<a class="ae kz" href="https://jupyter.org/try" rel="noopener ugc nofollow" target="_blank">主页</a> (2021)</p><p id="2963" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[2] <a class="ae kz" href="https://stackoverflow.com/users/4351027/zhukovgreen" rel="noopener ugc nofollow" target="_blank">朱可夫格林</a>，<a class="ae kz" href="https://stackoverflow.com/questions/24063629/loading-a-generic-google-spreadsheet-in-pandas" rel="noopener ugc nofollow" target="_blank">斯塔克韦尔弗洛</a> (2016)</p><p id="fe3f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[3] pythoncentral.io，<a class="ae kz" href="https://www.pythoncentral.io/introduction-to-sqlite-in-python/" rel="noopener ugc nofollow" target="_blank">Python中的SQLite介绍</a> (2013)</p><p id="b14d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[4] Google，<a class="ae kz" href="https://cloud.google.com/bigquery/docs/bigquery-storage-python-pandas" rel="noopener ugc nofollow" target="_blank">使用BigQuery存储API </a>将BigQuery数据下载到pandas(2021)</p></div></div>    
</body>
</html>