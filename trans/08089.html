<html>
<head>
<title>MLOps with MLFlow and Amazon SageMaker Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用MLFlow和Amazon SageMaker管道的MLOps</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mlops-with-mlflow-and-amazon-sagemaker-pipelines-33e13d43f238?source=collection_archive---------3-----------------------#2021-07-25">https://towardsdatascience.com/mlops-with-mlflow-and-amazon-sagemaker-pipelines-33e13d43f238?source=collection_archive---------3-----------------------#2021-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="45ba" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将MLflow用于SageMaker项目的分步指南</h2></div><p id="df7a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今年早些时候，我发表了一篇关于在AWS Fargate上部署MLflow，并在Amazon SageMaker上使用它的分步指南。这有助于简化ML项目的实验阶段。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/40d1a28fb5354cd4f4505d776829bdab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZCSwV8Rlb0HvmwYsWedY7Q.jpeg"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">由<a class="ae lb" href="https://unsplash.com/@arturkornakov?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿图尔·科尔纳科夫</a>在<a class="ae lb" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="eb7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将更进一步，使用MLflow和<a class="ae lb" href="https://aws.amazon.com/sagemaker/pipelines/" rel="noopener ugc nofollow" target="_blank"> Amazon SageMaker Pipelines </a>自动化端到端的ML生命周期。</p><p id="ea82" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">SageMaker Pipelines将ML工作流编排、模型注册和CI/CD结合成一把伞，这样您就可以快速地将您的模型投入生产。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ls"><img src="../Images/e9ff270923c709af6b1685755b7b509b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2qJdktVhZq3-dK7EZx2iSw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><p id="db26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将为<a class="ae lb" href="https://www.youtube.com/watch?v=Hvz2GGU3Z8g" rel="noopener ugc nofollow" target="_blank">模型构建、培训和部署</a>创建一个MLOps项目，以培训一个示例随机森林模型并将其部署到SageMaker端点中。我们将更新项目的modelBuild端，以便它可以将模型记录到MLflow模型注册表中，并更新modelDeploy端，以便它可以将它们发布到产品中。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="6a6e" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">演练概述</h1><p id="3035" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">我们将分三步解决这个问题:</p><ul class=""><li id="1b18" class="mx my iq kh b ki kj kl km ko mz ks na kw nb la nc nd ne nf bi translated">我们将首先在AWS上部署MLflow，并在SageMaker中启动一个MLOps项目。</li><li id="d2cc" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated">然后，我们将更新modelBuild管道，以便将模型记录到我们的MLflow模型注册中心。</li><li id="fe62" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated">最后，我将展示如何使用modelDeploy管道将MLflow模型部署到生产中。</li></ul><p id="7461" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是该项目的架构概述:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nl"><img src="../Images/bf2091bab22b5387658547b0cc63afd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cis5j5PyHYjFMgwbS1cxDQ.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片:架构概述</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="5712" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">先决条件</h1><p id="eb74" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">要浏览此示例，请确保您具备以下条件:</p><ol class=""><li id="b9d2" class="mx my iq kh b ki kj kl km ko mz ks na kw nb la nm nd ne nf bi translated">如果您对SageMaker Pipelines听起来不熟悉，请访问<a class="ae lb" href="https://www.youtube.com/watch?v=Hvz2GGU3Z8g" rel="noopener ugc nofollow" target="_blank">介绍亚马逊SageMaker Pipelines </a>。</li><li id="043c" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nm nd ne nf bi translated">熟悉使用MLflow和Amazon SageMaker 及其<a class="ae lb" href="https://github.com/aws-samples/amazon-sagemaker-mlflow-fargate/tree/main/lab" rel="noopener ugc nofollow" target="_blank">示例实验室</a>管理您的机器学习生命周期。</li><li id="4a84" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nm nd ne nf bi translated">访问亚马逊SageMaker工作室环境并熟悉T2工作室用户界面。</li><li id="b10b" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nm nd ne nf bi translated"><a class="ae lb" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>构建MLFlow推理容器映像并将其推送到ECR。</li><li id="3130" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nm nd ne nf bi translated">这个<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>克隆到您的工作室环境中</li></ol></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="fa66" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">步骤1:在AWS上部署MLflow并在SageMaker中启动MLOps项目</h1><h2 id="f6eb" class="nn mb iq bd mc no np dn mg nq nr dp mk ko ns nt mm ks nu nv mo kw nw nx mq ny bi translated">在AWS Fargate上部署MLflow</h2><p id="c311" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">首先，我们需要设置一个中央MLflow跟踪服务器，这样我们就可以在我们的MLOps项目中使用它。</p><p id="b5af" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果没有，可以<a class="ae lb" href="https://github.com/aws-samples/amazon-sagemaker-mlflow-fargate" rel="noopener ugc nofollow" target="_blank">按照说明</a>和<a class="ae lb" href="https://aws.amazon.com/blogs/machine-learning/managing-your-machine-learning-lifecycle-with-mlflow-and-amazon-sagemaker/" rel="noopener ugc nofollow" target="_blank">博客解释</a>在AWS Fargate上部署MLflow的开源版本。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nz"><img src="../Images/84d8c2a474e2d7f4137858aaeb3b6bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4srsFbJOIVHgbyMVa2gnw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片:在AWS Fargate上托管MLflow，Amazon S3作为工件商店，Amazon RDS for MySQL作为后端商店。</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi oa"><img src="../Images/5960a041db3b925aff80c17567508e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXZO2SLcMP6Y1qH9FkKSgw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">图片由作者提供:一旦部署，确保你把负载平衡器URI放在某个地方。我们将在我们的MLOps项目中使用它，以便管道可以与MLflow通信。</p></figure><h2 id="b98c" class="nn mb iq bd mc no np dn mg nq nr dp mk ko ns nt mm ks nu nv mo kw nw nx mq ny bi translated">启动您的MLOps项目</h2><p id="6f5c" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">现在，我们需要启动一个基于MLOps模板的SageMaker项目，用于模型构建、培训和部署。</p><p id="d861" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以按照朱利安·西蒙的视频来做:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="d9dc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">项目模板将为<em class="od"> modelBuild </em>和<em class="od"> modelDeploy </em>创建2个CodeCommit repos，为<em class="od"> CI </em>和<em class="od"> CD </em>创建2个CodePipeline管道，为打包和测试工件创建CodeBuild项目，以及运行项目的其他资源。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi oe"><img src="../Images/0d5fe419009296495fd3a5d8ef09d492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHBTykiGf5u6T02CWkym3A.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片:您可以在您的环境中克隆repos。</p></figure><h2 id="a4e5" class="nn mb iq bd mc no np dn mg nq nr dp mk ko ns nt mm ks nu nv mo kw nw nx mq ny bi translated">允许项目访问MLflow工件存储</h2><p id="1d70" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">我们使用亚马逊S3作为MLflow的工件存储，您需要更新MLOps项目角色，以便它可以访问MLflow S3存储桶。</p><p id="903b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个角色叫做<em class="od">AmazonSageMakerServiceCatalogProductsUseRole</em>，你可以像我下面做的那样更新它的权限:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi of"><img src="../Images/3747bd5fafec63a608f22fe7e0e060d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kKa2eXpRjouSn263pcBSA.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片:我在这个例子中使用了托管策略。您可以在您的环境中收紧权限。</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="d667" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">步骤2:更新modelBuild管道以将模型记录到MLflow中</h1><p id="8879" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在将modelBuild存储库克隆到您的环境中之后，您可以使用来自<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow/tree/main/model_build" rel="noopener ugc nofollow" target="_blank"> model_build文件夹</a>的代码来更新代码。</p><div class="ld le lf lg gt ab cb"><figure class="og lh oh oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><img src="../Images/cefc55b8f85406ad20f77c513361911d.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*0zoiJfeGAOSUFYNb7X-OpQ.png"/></div></figure><figure class="og lh om oi oj ok ol paragraph-image"><img src="../Images/8539d17b747ceabba0db43fa1b8060fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*zsPRFAx9kESM5PLIV8a6gg.png"/><p class="lo lp gj gh gi lq lr bd b be z dk on di oo op translated">作者图片:您的模型构建报告在更新前(左)和更新后(右)应该是什么样子</p></figure></div><p id="6e18" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow/blob/main/model_build/pipelines/mlflow/pipeline.py" rel="noopener ugc nofollow" target="_blank"> pipeline.py </a>中找到ML管道的例子。它有两个简单的步骤:</p><ul class=""><li id="77d8" class="mx my iq kh b ki kj kl km ko mz ks na kw nb la nc nd ne nf bi translated"><strong class="kh ir"> PrepareData </strong>从sklearn获取数据集，并将其分成训练/测试集</li><li id="9bec" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated"><strong class="kh ir">traineevaluateregister</strong>训练一个随机森林模型，将参数、度量和模型记录到MLflow中。</li></ul><p id="9022" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow/blob/main/model_build/pipelines/mlflow/pipeline.py" rel="noopener ugc nofollow" target="_blank"> pipeline.py </a>的第22行，确保将您的MLflow负载平衡器URI添加到管道参数中。它将被传递给<strong class="kh ir">traineevaluateregister</strong>，这样它就知道在哪里找到MLflow。</p><p id="74a3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您可以将更新后的代码推送到回购的主分支。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi oq"><img src="../Images/ee6fbabcfc23293c95e56ac2b71f9583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mz-F5tOulB60yQdghiH9_Q.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">图片作者:您的管道将被更新，需要几分钟来执行。</p></figure><p id="4d0c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从现在开始，管道将在每次执行时在MLflow中注册新的模型版本。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi or"><img src="../Images/a03c6660a19bf5814ee775171258a456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NqyUib78NOKpMRx8_BkCw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><p id="89ec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了进一步自动化，您可以使用<a class="ae lb" href="https://aws.amazon.com/eventbridge/" rel="noopener ugc nofollow" target="_blank"> Amazon EventBridge </a>来调度管道，或者使用其他类型的触发器和<a class="ae lb" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sagemaker.html#SageMaker.Client.start_pipeline_execution" rel="noopener ugc nofollow" target="_blank">start _ pipeline _ execution</a>方法。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="3b35" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">步骤3:使用modelDeploy管道将MLflow模型部署到生产环境中</h1><p id="662f" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">我们现在可以将新的模型版本引入MLflow模型注册中心，并将使用MLOps项目的modelDeploy端将它们部署到生产中。</p><h2 id="92a0" class="nn mb iq bd mc no np dn mg nq nr dp mk ko ns nt mm ks nu nv mo kw nw nx mq ny bi translated">将推理容器映像推送到ECR</h2><p id="baa8" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">除了ML模型，我们还需要一个容器映像来处理SageMaker端点中的推理。让我们把MLflow提供的推送到ECR。确保这与您的MLOps项目在同一个AWS区域中完成。</p><p id="1a1c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我的例子中，我使用以下命令从我的笔记本电脑推送它:</p><pre class="ld le lf lg gt os ot ou ov aw ow bi"><span id="8b59" class="nn mb iq ot b gy ox oy l oz pa">pip install -q mlflow==1.23.1</span><span id="6ecd" class="nn mb iq ot b gy pb oy l oz pa">mlflow sagemaker build-and-push-container</span></pre><h2 id="e26c" class="nn mb iq bd mc no np dn mg nq nr dp mk ko ns nt mm ks nu nv mo kw nw nx mq ny bi translated">更新模型部署报告</h2><p id="e11f" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">接下来，您可以使用来自<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow/tree/main/model_deploy" rel="noopener ugc nofollow" target="_blank">这个文件夹</a>的代码来更新modelDeploy repo。</p><div class="ld le lf lg gt ab cb"><figure class="og lh pc oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><img src="../Images/0f3fe9937c4ae1e24a0ea6d0287d9b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*CcP24m07l-SBHe6G_IADfQ.png"/></div></figure><figure class="og lh pc oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><img src="../Images/41bfa7457d3801fb8f37eafe55d87a33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*_OHFCBFz09VLm4ebWBAWxQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk pd di pe op translated">作者图片:modelDeploy repo在更新之前(左)和之后(右)的样子</p></figure></div><p id="7150" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow/blob/main/model_deploy/buildspec.yml" rel="noopener ugc nofollow" target="_blank"> buildspec.yml </a>中，您可以定义部署到生产中的模型版本。您还需要输入您的MLflow负载平衡器URI和推理容器URI。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi pf"><img src="../Images/4702116b789f3399a6ad5257e4bf8e13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rMxoL7RkzhMmxzg3F9sq-A.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><p id="07bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我更新了<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow/blob/main/model_deploy/build.py" rel="noopener ugc nofollow" target="_blank"> build.py </a>以从MLflow获取所选的模型版本二进制文件，并将其model.tar.gz上传到S3。</p><p id="2133" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是由<a class="ae lb" href="https://github.com/SofianHamiti/amazon-sagemaker-pipelines-mlflow/blob/main/model_deploy/mlflow_handler.py" rel="noopener ugc nofollow" target="_blank"> mlflow_handler.py </a>完成的，当模型通过modelDeploy管道时，它也转换mlflow中的模型阶段。</p><h2 id="be76" class="nn mb iq bd mc no np dn mg nq nr dp mk ko ns nt mm ks nu nv mo kw nw nx mq ny bi translated">触发部署</h2><p id="0fb6" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">现在可以将代码推送到repo的主分支，这将触发CodePipeline中的modelDeploy管道。一旦测试在试运行中成功，您就可以导航到CodePipeline控制台并手动批准端点投入生产。</p><div class="ld le lf lg gt ab cb"><figure class="og lh pc oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><img src="../Images/a7c4f2bf66765befcf984063a10fed97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*2Z7mGvm0BzkNIObDkwcpAQ.png"/></div></figure><figure class="og lh pc oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><img src="../Images/828fa557616b29b623e6f62fc8364cda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fZ6ez4UCHjJlEeskDfYsFQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk pd di pe op translated">作者提供的图片:模型阶段将在MLflow中过渡，因为它在管道中前进</p></figure></div><p id="53b8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当部署新版本时，管道将存档以前的版本。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi pg"><img src="../Images/98fcc97a11275404b0a2f9477f0dff71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zRcRS3Qk-R4KCYPVeZrJg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><p id="57d4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以看到您的SageMaker端点已准备好生成预测。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ph"><img src="../Images/1cf41b87765179385bc39a8688e8b1d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1a6zAvH9bt885kOh1PApgg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="68fb" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="5003" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">Amazon SageMaker Pipelines将MLOps工具纳入一个保护伞中，以减少运行端到端MLOps项目的工作量。</p><p id="f332" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们使用了SageMaker MLOps项目和MLflow模型注册中心来自动化端到端ML生命周期。</p><p id="9abb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更进一步，您还可以学习如何使用Amazon SageMaker Pipelines 部署无服务器推理服务。</p></div></div>    
</body>
</html>