<html>
<head>
<title>How To Select Rows From Pandas DataFrame Based on Column Values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何根据列值从Pandas数据框架中选择行</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-select-rows-from-pandas-dataframe-based-on-column-values-d3f5da421e93?source=collection_archive---------1-----------------------#2021-06-23">https://towardsdatascience.com/how-to-select-rows-from-pandas-dataframe-based-on-column-values-d3f5da421e93?source=collection_archive---------1-----------------------#2021-06-23</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="824d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">探索如何根据pandas数据框架中的条件选择行</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/5304d4743c96a501520cd465318e7fdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UPYjuMfdpVoxvvt5fcshCQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@mihaiteslariu0?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Teslariu Mihai </a>在<a class="ae kz" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="31b1" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">介绍</h1><p id="e7d3" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">从数据帧中选择行可能是使用pandas最常见的任务之一。在今天的文章中，我们将讨论如何对列值为:</p><ul class=""><li id="8500" class="mo mp iu lu b lv mq ly mr mb ms mf mt mj mu mn mv mw mx my bi translated">等于标量/字符串</li><li id="c34c" class="mo mp iu lu b lv mz ly na mb nb mf nc mj nd mn mv mw mx my bi translated">不等于标量/字符串</li><li id="da9e" class="mo mp iu lu b lv mz ly na mb nb mf nc mj nd mn mv mw mx my bi translated">大于或小于一个标量</li><li id="40e9" class="mo mp iu lu b lv mz ly na mb nb mf nc mj nd mn mv mw mx my bi translated">包含特定(子)字符串</li><li id="4a62" class="mo mp iu lu b lv mz ly na mb nb mf nc mj nd mn mv mw mx my bi translated">可迭代的成员(例如列表)</li></ul><p id="b112" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">此外，我们将讨论如何将多个条件组合在一起。</p></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><p id="25c2" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">在开始讨论从pandas数据帧中选择行的不同方法之前，首先让我们创建一个示例数据帧来演示一些概念，该示例数据帧将贯穿本文。</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="74c8" class="nt lb iu np b gz nu nv l nw nx">import numpy as np</span><span id="8e3e" class="nt lb iu np b gz ny nv l nw nx">df = pd.DataFrame(<br/> [<br/>  (73, 15, 55, 33, 'foo'),<br/>  (63, 64, 11, 11, 'bar'),<br/>  (56, 72, 57, 55, 'foo'),<br/> ],<br/> columns=['A', 'B', 'C', 'D', 'E'],<br/>)</span><span id="9d1e" class="nt lb iu np b gz ny nv l nw nx">print(df)</span><span id="b035" class="nt lb iu np b gz ny nv l nw nx">#     A   B   C   D    E<br/># 0  73  15  55  33  foo<br/># 1  63  64  11  11  bar<br/># 2  56  72  57  55  foo</span></pre></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h1 id="28c5" class="la lb iu bd lc ld nz lf lg lh oa lj lk ka ob kb lm kd oc ke lo kg od kh lq lr bi translated">在熊猫中选择行</h1><p id="2040" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">在下面几节中，我们将讨论并展示如何基于各种可能的条件从数据帧中选择特定的行。</p></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h2 id="f404" class="nt lb iu bd lc oe of dn lg og oh dp lk mb oi oj lm mf ok ol lo mj om on lq oo bi translated">选择列值等于标量或字符串的行</h2><p id="d164" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">假设我们只想选择特定列中有一个特定值的行。我们可以通过简单地使用<code class="fe op oq or np b">loc[]</code>属性来做到这一点:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="8fde" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df.loc[df['B'] == 64]<br/>    A   B   C   D    E<br/>1  63  64  11  11  bar</span></pre><p id="5042" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">我们甚至可以省略<code class="fe op oq or np b">loc</code>并在索引熊猫数据帧时提供布尔条件，如下所示:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="723e" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df[df['B'] == 64]<br/>    A   B   C   D    E<br/>1  63  64  11  11  bar</span></pre><p id="184c" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">注意，除了<code class="fe op oq or np b">df['B']</code>，您还可以使用<code class="fe op oq or np b">df.B</code>来引用列<code class="fe op oq or np b">B</code>。例如，下面的语句与上面的等价。</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="aaa3" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df[df.B == 64]</span></pre><p id="9680" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">在Python的上下文中，将这样的布尔条件命名为<code class="fe op oq or np b">mask</code>是一种常见的做法，然后我们在索引DataFrame时将它传递给data frame。</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="d489" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; mask = df.B == 64<br/>&gt;&gt;&gt; df[mask]<br/>    A   B   C   D    E<br/>1  63  64  11  11  bar</span></pre><p id="3fe8" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">在介绍了几种基于列值等于标量来选择行的可能方法之后，我们应该强调的是<code class="fe op oq or np b">loc[]</code>才是正确的选择。这仅仅是因为<code class="fe op oq or np b"><strong class="lu iv">df[mask]</strong></code> <strong class="lu iv">总是会分派到</strong> <code class="fe op oq or np b"><strong class="lu iv">df.loc[mask]</strong></code> <strong class="lu iv">，这意味着直接使用</strong> <code class="fe op oq or np b"><strong class="lu iv">loc</strong></code> <strong class="lu iv">会稍微快一点</strong>。</p></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h2 id="12cd" class="nt lb iu bd lc oe of dn lg og oh dp lk mb oi oj lm mf ok ol lo mj om on lq oo bi translated">选择列值不等于标量的行</h2><p id="a023" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">接下来，您可能希望只选择特定列<strong class="lu iv">中的值不等于标量</strong>的行的子集。为此，我们只需遵循与之前相同的约定:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="9c67" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df.loc[df['B'] != 64]<br/>    A   B   C   D    E<br/>0  73  15  55  33  foo<br/>2  56  72  57  55  foo</span></pre></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h2 id="df6c" class="nt lb iu bd lc oe of dn lg og oh dp lk mb oi oj lm mf ok ol lo mj om on lq oo bi translated">选择行显示大于或小于标量的列值</h2><p id="6934" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">这是一个与前一个非常相似的用例。在这种情况下，我们只需要使用所需的操作符来执行比较。举个例子，</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="44ac" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df.loc[df['B'] &gt;= 64]<br/>    A   B   C   D    E<br/>1  63  64  11  11  bar<br/>2  56  72  57  55  foo</span></pre></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h2 id="0672" class="nt lb iu bd lc oe of dn lg og oh dp lk mb oi oj lm mf ok ol lo mj om on lq oo bi translated">选择列值包含字符串的行</h2><p id="a0ee" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">最常见的一个用例是，当您需要过滤数据帧时，只保留特定列中包含特定(子)字符串的行。</p><p id="7480" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">和前面的用例一样，我们可以使用<code class="fe op oq or np b">loc</code>来实现:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="5a2e" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df.loc[df['E'].str.contains('oo')]<br/>    A   B   C   D    E<br/>0  73  15  55  33  foo<br/>2  56  72  57  55  foo</span></pre></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h2 id="b8e8" class="nt lb iu bd lc oe of dn lg og oh dp lk mb oi oj lm mf ok ol lo mj om on lq oo bi translated">选择列值在可迭代中的行</h2><p id="8904" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">现在让我们假设我们只想选择那些特定列中的值包含在列表中的行。为此，我们只需使用如下所示的<code class="fe op oq or np b">isin()</code>。</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="7a31" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df.loc[df['B'].isin([64, 15])]<br/>    A   B   C   D    E<br/>0  73  15  55  33  foo<br/>1  63  64  11  11  bar</span></pre></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h2 id="9f57" class="nt lb iu bd lc oe of dn lg og oh dp lk mb oi oj lm mf ok ol lo mj om on lq oo bi translated">选择列值不在iterable中的行</h2><p id="0021" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">现在，如果你想选择值不在可迭代的行(例如，一个列表)，那么你可以简单地使用否定字符<code class="fe op oq or np b">~</code>:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="a348" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df.loc[~df['<!-- -->B<!-- -->'].isin(<!-- -->[64, 15]<!-- -->)]<br/>    A   B   C   D    E<br/>2  56  72  57  55  foo</span></pre></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h2 id="47b1" class="nt lb iu bd lc oe of dn lg og oh dp lk mb oi oj lm mf ok ol lo mj om on lq oo bi translated">多重条件</h2><p id="539f" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">当从pandas数据框架中选择行时，您可能希望或必须将多个条件组合在一起。</p><p id="4423" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">为此，我们需要使用<code class="fe op oq or np b">&amp;</code>操作符</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="2a21" class="nt lb iu np b gz nu nv l nw nx">&gt;&gt;&gt; df.loc[(df['A'] &gt;= 59) &amp; (df['E'].isin(['foo', 'boo']))]<br/>    A   B   C   D    E<br/>0  73  15  55  33  foo</span></pre></div><div class="ab cl nh ni hy nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="in io ip iq ir"><h1 id="5b76" class="la lb iu bd lc ld nz lf lg lh oa lj lk ka ob kb lm kd oc ke lo kg od kh lq lr bi translated">最后的想法</h1><p id="b4b1" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">在今天的文章中，我们讨论了如何对pandas数据帧执行行选择，并展示了具体的用例及示例。</p><p id="31f5" class="pw-post-body-paragraph ls lt iu lu b lv mq jv lx ly mr jy ma mb ne md me mf nf mh mi mj ng ml mm mn in bi translated">在大部分章节中，我们基本上使用了标签索引，这是通过<code class="fe op oq or np b">loc</code>实现的。请注意，pandas有一个名为<code class="fe op oq or np b">iloc</code>的附加属性，通常用于执行位置索引。理解这两者之间的区别是很重要的，我建议你阅读下面的文章，它详细解释了每一个的作用。</p><div class="os ot gq gs ou ov"><a rel="noopener follow" target="_blank" href="/loc-vs-iloc-in-pandas-92fc125ed8eb"><div class="ow ab fp"><div class="ox ab oy cl cj oz"><h2 class="bd iv gz z fq pa fs ft pb fv fx it bi translated">熊猫中的loc与iloc</h2><div class="pc l"><p class="bd b dl z fq pa fs ft pb fv fx dk translated">towardsdatascience.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi kt ov"/></div></div></a></div></div></div>    
</body>
</html>