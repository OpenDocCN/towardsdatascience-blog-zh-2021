<html>
<head>
<title>How To Undo The Last Local Commit in Git</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何撤销 Git 中的最后一次本地提交</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/undo-last-local-commit-git-5410a18f527?source=collection_archive---------31-----------------------#2021-10-27">https://towardsdatascience.com/undo-last-local-commit-git-5410a18f527?source=collection_archive---------31-----------------------#2021-10-27</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="4c6a" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">了解如何在 Git 中撤销最近的本地提交</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/985e0d7fa62381b55020a07e5aa5615d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DbJrZ73enNNmnB_UxBDcmQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@synkevych?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Roman Synkevych </a>在<a class="ae kz" href="https://unsplash.com/s/photos/git?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="e45e" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="e1c8" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">Git 是帮助开发人员、数据科学家和工程师编写代码版本的最强大的工具之一。使用 Git 时，一个非常常见的场景是当您意外提交文件时，您需要撤销最近的提交，以避免将这些文件中所做的更改推送到远程主机。</p><p id="95af" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的文章中，假设您没有将最后一次提交<strong class="ly iv">推送到远程主机</strong>，我们将讨论几个可能的选项。具体来说，我们将探索如何</p><ul class=""><li id="9524" class="mu mv iu ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated">撤消最近的提交，并<strong class="ly iv">清除对提交的文件</strong>所做的所有更改</li><li id="d0b4" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">撤销最后一次提交，并<strong class="ly iv">保留修改文件中的更改</strong></li><li id="0d35" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">撤销最近的提交并且<strong class="ly iv">保留文件和索引中的更改</strong></li></ul></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><h2 id="26a7" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">撤消上次提交并放弃对文件所做的所有更改</h2><p id="896b" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">有时，除了撤销最近的提交，您可能还想放弃对该特定提交中包含的文件所做的所有更改。在这种情况下，你需要做一个<strong class="ly iv">硬复位</strong>。</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="42d7" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">git reset </strong><strong class="nq iv">--hard HEAD~1</strong></span></pre><ul class=""><li id="75d6" class="mu mv iu ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated"><code class="fe ny nz oa nq b">--hard</code>标志表示<code class="fe ny nz oa nq b">git reset</code>命令将重置机头、索引和工作树。这意味着提交将被撤销，此外，对文件所做的更改也将被丢弃。</li><li id="4d91" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe ny nz oa nq b">HEAD~1</code>翻译为“使用第一个父代从<code class="fe ny nz oa nq b">HEAD</code>返回 1 次提交”。通常一个提交只有一个父级，所以在大多数情况下这应该可以解决问题。注意<code class="fe ny nz oa nq b">HEAD~1</code>相当于<code class="fe ny nz oa nq b">HEAD~</code>。</li></ul></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><h2 id="f5ac" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">撤消上次提交，但保留对文件所做的更改</h2><p id="fb63" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">或者，您可能仍然希望进行最近的提交，但同时在本地保留对文件所做的更改。在这种情况下，您只需在运行<code class="fe ny nz oa nq b">git reset</code>命令时指定<code class="fe ny nz oa nq b">HEAD~1</code>:</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="4bb3" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">git reset HEAD~1</strong></span></pre><p id="0b18" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">该命令将指示 Git 将指针<code class="fe ny nz oa nq b">HEAD</code>向后移动一次。但是，对文件所做的更改不会受到影响。现在，如果您运行<code class="fe ny nz oa nq b">git status</code>，您应该仍然能够在本地看到对文件所做的更改。</p></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><h2 id="5392" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">撤消上次提交并保留索引和本地文件更改</h2><p id="e5f4" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">最后，您可能想要撤销最后一次提交，保留对文件的更改，同时<strong class="ly iv">保留索引，</strong>也是如此。</p><p id="4072" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">索引(也称为暂存区)是准备新提交的地方，它包含新提交中要包含的所有内容。例如，每次你运行<code class="fe ny nz oa nq b">git add &lt;filename&gt;</code>的时候，一个文件被从工作的三个文件中添加(或更新)到索引中。实际上，索引是一个存储在<code class="fe ny nz oa nq b">&lt;repo&gt;/.git/index</code>下的二进制文件，包含。</p><pre class="kk kl km kn gu np nq nr ns aw nt bi"><span id="c1e2" class="la lb iu nq b gz nu nv l nw nx"><strong class="nq iv">git reset --soft HEAD~1</strong></span></pre><ul class=""><li id="ce7e" class="mu mv iu ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated"><code class="fe ny nz oa nq b">--soft</code>标志表示<code class="fe ny nz oa nq b">git reset</code>命令只会重置机头，而索引和工作树保持不变。</li></ul><p id="a183" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在，如果你运行<code class="fe ny nz oa nq b">git status</code>，你应该能够看到相同的文件仍然在索引中。</p></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短指南中，我们探索了几种不同的方法来撤销 Git 中最近的本地提交。有时，您可能想要撤消最近的提交，并放弃对已修改文件所做的所有更改，而在其他情况下，您可能只想撤消最近的提交，但同时保留更改。</p><p id="7769" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">但是请注意，只有当您尚未将提交推送到远程主机时，我们在本文中讨论的选项才适用。关于<code class="fe ny nz oa nq b">git reset</code>命令的更多细节，您可以在命令行中运行<code class="fe ny nz oa nq b">git reset -h</code>来显示使用说明。</p></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="ob oc gq gs od oe"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="of ab fp"><div class="og ab oh cl cj oi"><h2 class="bd iv gz z fq oj fs ft ok fv fx it bi translated">通过我的推荐链接加入 Medium-Giorgos Myrianthous</h2><div class="ol l"><h3 class="bd b gz z fq oj fs ft ok fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="om l"><p class="bd b dl z fq oj fs ft ok fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="on l"><div class="oo l op oq or on os kt oe"/></div></div></a></div></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="ob oc gq gs od oe"><a href="https://betterprogramming.pub/how-to-merge-other-git-branches-into-your-own-2fe69f70a2b4" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fp"><div class="og ab oh cl cj oi"><h2 class="bd iv gz z fq oj fs ft ok fv fx it bi translated">如何将其他 Git 分支合并到您自己的分支中</h2><div class="ol l"><h3 class="bd b gz z fq oj fs ft ok fv fx dk translated">使用命令行或 GitHub 桌面快速合并分支</h3></div><div class="om l"><p class="bd b dl z fq oj fs ft ok fv fx dk translated">better 编程. pub</p></div></div><div class="on l"><div class="ot l op oq or on os kt oe"/></div></div></a></div></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu oe"><a rel="noopener follow" target="_blank" href="/dynamic-typing-in-python-307f7c22b24e"><div class="of ab fp"><div class="og ab oh cl cj oi"><h2 class="bd iv gz z fq oj fs ft ok fv fx it bi translated">Python 中的动态类型</h2><div class="ol l"><h3 class="bd b gz z fq oj fs ft ok fv fx dk translated">探索 Python 中对象引用的工作方式</h3></div><div class="om l"><p class="bd b dl z fq oj fs ft ok fv fx dk translated">towardsdatascience.com</p></div></div><div class="on l"><div class="ou l op oq or on os kt oe"/></div></div></a></div></div><div class="ab cl ni nj hy nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu oe"><a href="https://betterprogramming.pub/11-python-one-liners-for-everyday-programming-f346a0a73f39" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fp"><div class="og ab oh cl cj oi"><h2 class="bd iv gz z fq oj fs ft ok fv fx it bi translated">用于日常编程的 11 个 Python 一行程序</h2><div class="ol l"><h3 class="bd b gz z fq oj fs ft ok fv fx dk translated">令人惊叹的 Python 片段不会降低可读性</h3></div><div class="om l"><p class="bd b dl z fq oj fs ft ok fv fx dk translated">better 编程. pub</p></div></div><div class="on l"><div class="ov l op oq or on os kt oe"/></div></div></a></div></div></div>    
</body>
</html>