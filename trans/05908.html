<html>
<head>
<title>Approximating KL Divergence</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逼近KL散度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/approximating-kl-divergence-4151c8c85ddd?source=collection_archive---------26-----------------------#2021-05-26">https://towardsdatascience.com/approximating-kl-divergence-4151c8c85ddd?source=collection_archive---------26-----------------------#2021-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5097" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">无偏的低方差样本估计</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/47e5b3cee58f0b13c7f99bb8acd0daf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BOVp7xzdZ-JE2XC3"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">阿图尔·尤奇卡在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="60bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将讨论KL散度的一个样本近似值。我将讨论正向和反向KL偏差，所以如果你不熟悉这些概念，在这里查看我关于主题<a class="ae kv" rel="noopener" target="_blank" href="/forward-and-reverse-kl-divergence-906625f1df06"> <strong class="ky ir">的文章</strong> </a>可能会有帮助。</p><p id="e695" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想要一些关于如何用代码实现这一点的指导(来自open ai<em class="ls">联合创始人<strong class="ky ir"> John Schulman的评论)！！)查看我的拉动请求<a class="ae kv" href="https://github.com/DLR-RM/stable-baselines3/pull/419" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">此处</strong> </a> <strong class="ky ir"> </strong>为稳定基线3。</strong></em></p><h1 id="2dc1" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">为什么一开始要近似？</h1><ol class=""><li id="c567" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated"><strong class="ky ir">无解析解</strong>:KL散度的完整形式解析解可能未知。例如，高斯混合分布就是这种情况。</li><li id="178b" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated"><strong class="ky ir">高计算复杂度</strong>:计算完整的KL散度经常需要对整个分布空间求和。使用不需要这样做的近似是有用的，因为它可以更快。</li></ol><h1 id="b35d" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">近似值的标准</h1><p id="4e9c" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">KL散度是“真实”分布和“预测”分布之间差异的度量。“真实”分布<strong class="ky ir"> p(x) </strong>被认为是固定的，而“预测”分布<strong class="ky ir"> q(x) </strong>是我们可以控制的。我们将从<strong class="ky ir"> q(x) </strong>中抽取样本作为近似函数的输入，使其成为一个<strong class="ky ir">随机变量</strong>。如果<strong class="ky ir"> p(x) </strong>是已知的，您可以从那里取样本，但有时情况并非如此，因此概括起来，我们将坚持使用<strong class="ky ir"> q(x) </strong>。</p><p id="9aba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">直觉上，近似应该具有与被近似的原始度量相似的行为。我们可以用两种方法来衡量这种相似性:</p><ol class=""><li id="b741" class="ml mm iq ky b kz la lc ld lf ne lj nf ln ng lr ms mt mu mv bi translated"><strong class="ky ir">偏差</strong>:理想情况下，近似值应该是无偏的；也就是说，近似值的期望值应该等于原始度量。</li><li id="8374" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated"><strong class="ky ir">方差</strong>:方差为0的无偏近似值(确定性的)将完全等于原始度量！当然，这是不现实的，但理想情况下，方差应该尽可能低，从而增加获得更接近原始度量的值的可能性。</li></ol><h1 id="788b" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">近似向前KL发散</h1><p id="3e66" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">让我们首先提醒自己完整的分析形式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/0a914194b948f1af87b390f65959a86e.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*kiGFc0dpIR6XpZm2snOvKg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:KL向前发散</p></figure><p id="e2cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们考虑一下偏见的情况。我们想要:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/d26e6d3a63f63e8db2d29424aeb9f2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*yaku6NpT4YU_HDZc1i2XjA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="efb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中approxKL是我们想要得到的近似值。让我们看看下面的解决方案:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/8f0ca5c98deea32f8933fb8aa4ab9015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1oGxmyA03t2CQf-20UyNOw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="756d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/bb4796f78bbb36a734cbf305da6e84cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*1lmw-wHn_LU1mEkQKAL0cA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:向前KL发散的无偏近似</p></figure><p id="c58a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是这个方差仍然很高，因为它可以取负值，而实际KL散度不能。改善这种情况的一种方法是添加一个期望值为0的项，该项与上面的原始近似值负相关。我们提出以下解决方案:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/7e9ada14e5951e7ef87dd38e8b3064e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*vpR7_25IHVz8a5LTke2NqQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="8e73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是可行的，因为<strong class="ky ir"> p(x) </strong>被假定为有效的概率分布。因此，我们可以将近似值更新为:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/e792975f2df9714af576585f762213d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*HJjZ40jJ-S6PZugbIRfZxw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="4302" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中我们可以求解<strong class="ky ir"> λ </strong>来找到最小方差。不幸的是，这取决于具体情况，很难分析计算。但是，我们仍然可以通过选择值-1来找到一个很好的折衷方案。这在任何情况下都导致一个正定的近似！如果我们将比率<strong class="ky ir"> p(x)/q(x) </strong>作为自己的变量，并将其与近似值<strong class="ky ir"> λ=-1 </strong>相对照，我们会得到以下正定图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/168b0367f2e3f23599c29a012b23d714.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*b-I7CN3wYT_oVbkNczguyw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="8106" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，前向KL散度近似的最终形式是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/b90f6a0210b314e2496f23f740109c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*mjaZ_-_D3Ol6UF7xgqkXpA.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/1634486de0fca9a7355d1c181fbd4b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:206/format:webp/1*qIIeLrodpjS7ElmIQcQLpQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:最终缩减方差无偏正向KL散度近似值</p></figure><h1 id="3a67" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">近似反向KL散度</h1><p id="d130" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">我们可以采取同样的步骤来得到反向KL散度和正向KL散度的近似值！</p><p id="0572" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们提醒自己完整的分析形式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/e067a3eb6f500d70d58906e06099a4dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*Jt_Y2QbU8qkkmB1GqTHfrg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:反向KL发散</p></figure><p id="be96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再次，我们需要首先获得一个简单的无偏近似；下面给出了一个解决方案:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/33001559c90c4f49efe6896a5de49718.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*cF1i3UUfML6ciVxbtTPcJg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7bfc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/f0dfd03a718d0ef7f1bd7cd1a0f3b52c.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*j45pkIyQ6J33rxcA2CZ0jA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:反向KL发散的无偏近似</p></figure><p id="424a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这遭受与前向KL散度的无偏近似完全相同的问题:这可能取负值，这导致大的方差。我们可以用和上次一样的术语来反驳这一点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/fae4eebb68b81ed5ae395ca5d1f10fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*JJNISC8kQ9bocunbWYXhEw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="94e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，我们现在可以求解<strong class="ky ir"> λ </strong>以找到最小方差，尽管这取决于具体情况。这次一个很好的折中办法是选择<strong class="ky ir"> λ=1 </strong>，以<strong class="ky ir"> p(x)/q(x) </strong>的比值作为自己的变量，对照这个近似值作图，我们得到如下正定图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/64462a1d28627061320251399357b3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*4UPk-eVv8_YFdvfCON-Qog.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="f9a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，反向KL散度近似的最终形式是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/ffdd6cbe0b9f86f7400a8d07968d4716.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*sCBlIkCNm9beryVFznJbaw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/1634486de0fca9a7355d1c181fbd4b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:206/format:webp/1*qIIeLrodpjS7ElmIQcQLpQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:最终缩减方差无偏反向KL散度近似值</p></figure></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="d10c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下次你试图通过抽样来测量两个分布之间的差异时，请记住这些近似值！</p><p id="450e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您觉得这篇文章有用，请考虑:</p><ul class=""><li id="e86a" class="ml mm iq ky b kz la lc ld lf ne lj nf ln ng lr od mt mu mv bi translated">跟踪我🙌</li><li id="0082" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr od mt mu mv bi translated"><a class="ae kv" href="https://medium.com/subscribe/@rohan.tangri" rel="noopener"> <strong class="ky ir">订阅我的邮件通知</strong> </a>永不错过上传📧</li><li id="75a9" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr od mt mu mv bi translated">使用我的媒介<a class="ae kv" href="https://medium.com/@rohan.tangri/membership" rel="noopener"> <strong class="ky ir">推荐链接</strong> </a> <strong class="ky ir"> </strong>直接支持我并获得无限量的优质文章🤗</li></ul><p id="c62e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">推广的方式，我真的希望你觉得这篇文章有趣，让我知道你的想法！！</p><h1 id="bee3" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">参考</h1><p id="eff7" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated"><a class="ae kv" href="http://joschu.net/blog/kl-approx.html" rel="noopener ugc nofollow" target="_blank">http://joschu.net/blog/kl-approx.html</a>约翰·舒尔曼的《逼近KL散度》</p></div></div>    
</body>
</html>