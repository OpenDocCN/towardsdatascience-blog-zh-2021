<html>
<head>
<title>Images Generation with Neural Style Transfer and Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于神经风格转移和张量流的图像生成</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/images-generation-with-neural-style-transfer-and-tensorflow-a823b0353b06?source=collection_archive---------18-----------------------#2021-07-02">https://towardsdatascience.com/images-generation-with-neural-style-transfer-and-tensorflow-a823b0353b06?source=collection_archive---------18-----------------------#2021-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f02a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用机器学习算法创建独特的图像</h2></div><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="kn ko l"/></div></figure><h2 id="5d25" class="kp kq it bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">3分钟机器学习</h2><p id="ebd6" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt ky lu lv lw lc lx ly lz lg ma mb mc md im bi translated">3分钟机器学习是一系列与机器学习世界相关的教程和内容丰富的视频。你可以在YouTube上找到完整的视频。<a class="ae me" href="https://github.com/GitMarco27/TMML" rel="noopener ugc nofollow" target="_blank">库</a>包含视频中显示的所有文件。这个系列是在实验阶段，完全免费开发，为了娱乐和文化！欢迎任何反馈。</p><h2 id="9c9b" class="kp kq it bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">为什么要看这篇文章？</h2><p id="8da9" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt ky lu lv lw lc lx ly lz lg ma mb mc md im bi translated">本文将介绍如何通过开发一种有趣的机器学习算法来创建独特和原始的图像:<strong class="ln iu">神经风格转移</strong>。我们将看到如何上传已经训练好的<strong class="ln iu">神经网络模型</strong>来加快过程，以及如何上传自己的照片来测试算法并生成自己的图像。</p><p id="bcfa" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">下面是我们最终结果的预览:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/df8e164b0e80d1e38e3ef807a41c8e51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-MljH5TgwNKEWHSm3EFpQ.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">神经风格转移应用程序—图片由作者提供</p></figure><h2 id="64a7" class="kp kq it bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">神经类型转移</h2><p id="66a2" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt ky lu lv lw lc lx ly lz lg ma mb mc md im bi translated">神经类型转移是一种优化技术。它的实现包括使用两个图像:一个表示主要内容(<strong class="ln iu">内容</strong>图像)，另一个表示代表我们希望获得的图像的样式(<strong class="ln iu">样式引用</strong>图像)。该算法混合这些图像，获取内容图像并对其应用样式参考图像。这是通过优化最终图像以匹配内容图像的<strong class="ln iu">内容统计</strong>和<strong class="ln iu">样式参考图像的样式统计</strong>来完成的。该算法的实现涉及卷积网络的使用。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/94ae10c674e1b6b81c768c2f690aef2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*3IuIdhItJIPLmPAI.jpg"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">神经类型转移工作原理—学分:<a class="ae me" href="https://arxiv.org/abs/1508.06576" rel="noopener ugc nofollow" target="_blank">篇</a></p></figure><p id="cb04" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">更多信息请参考Tensorflow原创<a class="ae me" href="https://arxiv.org/abs/1508.06576" rel="noopener ugc nofollow" target="_blank">文章</a>或者这个有趣的<a class="ae me" href="https://www.tensorflow.org/tutorials/generative/style_transfer" rel="noopener ugc nofollow" target="_blank">教程</a>。</p><h2 id="4c58" class="kp kq it bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">代码</h2><p id="9c41" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt ky lu lv lw lc lx ly lz lg ma mb mc md im bi translated">代码需要导入几个库和定义一些环境变量。<strong class="ln iu"> Matplotlib </strong>用于图像绘制，<strong class="ln iu"> Tensorflow </strong>和<strong class="ln iu"> Keras </strong>用于代理模型管理和图像预处理，<strong class="ln iu"> os </strong>系统库用于定义一些系统变量，<strong class="ln iu"> NumPy </strong>作为数值分析的基本工具。我们直接从<strong class="ln iu"> Google Colab </strong>导入一些工具，方便直接从你的PC导入图片。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mw ko l"/></div></figure><p id="3cce" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">剩下的工作就是导入我们想要执行分析的图像。请记住，第一个将是基础图像，它将为最终结果分配主题(<strong class="ln iu">内容</strong>图像)。第二个将分配样式(<strong class="ln iu">样式参考</strong>图像)。这段代码非常有用，因为它允许我们用几行代码直接从本地存储空间上传图像文件，同时在代码共享的情况下创建与用户的交互界面(如本例所示)。我们注意到，正如所写的，这段代码允许同时导入几个图像，但是在这种情况下，我们只需要两个图像:只有最后一个将被存储。图像会自动上传并保存在您的工作区中。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mw ko l"/></div></figure><p id="75c7" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">让我们定义一些有用的函数:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mw ko l"/></div></figure><p id="f080" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated"><strong class="ln iu"> tensor_to_image </strong>允许将TensorFlow张量转换为图像文件，并以此表示。<strong class="ln iu"> load_img </strong>从所需路径加载图像。<strong class="ln iu"> imshow </strong>允许我们可视化一个图像，注意输入文件的大小。</p><p id="6d35" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">让我们展示这些图像:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mw ko l"/></div></figure><p id="2566" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">让我们创建我们的<strong class="ln iu"> <em class="mx">神经风格转移模型</em> </strong>:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mw ko l"/></div></figure><p id="6a9b" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">要开发<strong class="ln iu"> Tensorflow Hub </strong>的潜力，只需:</p><ul class=""><li id="45b7" class="my mz it ln b lo mf lr mg ky na lc nb lg nc md nd ne nf ng bi translated">从<strong class="ln iu"> Tensorflow Hub </strong>加载预训练模型</li><li id="f63e" class="my mz it ln b lo nh lr ni ky nj lc nk lg nl md nd ne nf ng bi translated">生成新的风格化图像，将我们的两个图像作为常量张量流张量传递给模型</li><li id="4d21" class="my mz it ln b lo nh lr ni ky nj lc nk lg nl md nd ne nf ng bi translated">将新图像转换为图像</li><li id="b9e3" class="my mz it ln b lo nh lr ni ky nj lc nk lg nl md nd ne nf ng bi translated">让我们来想象一下结果吧！</li></ul><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/df8e164b0e80d1e38e3ef807a41c8e51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-MljH5TgwNKEWHSm3EFpQ.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">神经风格转移应用程序—图片由作者提供</p></figure><p id="29de" class="pw-post-body-paragraph ll lm it ln b lo mf ju lq lr mg jx lt ky mh lv lw lc mi ly lz lg mj mb mc md im bi translated">让我们添加一些Python命令来自动命名和下载新图像:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mw ko l"/></div></figure><h1 id="bd0f" class="nm kq it bd kr nn no np ku nq nr ns kx jz nt ka lb kc nu kd lf kf nv kg lj nw bi translated">结论</h1><p id="cc7a" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt ky lu lv lw lc lx ly lz lg ma mb mc md im bi translated">我希望你喜欢这篇文章的内容。我提醒你，你可以在这里找到<a class="ae me" href="https://github.com/GitMarco27/TMML/blob/5727dc3f4f87885d1e05863427cbe4ae6b6ea1fe/Notebooks/002_Style_Transfer.ipynb" rel="noopener ugc nofollow" target="_blank">源代码</a>，在GitHub和<a class="ae me" href="https://www.youtube.com/channel/UCExkeDZ9WC0tg9aoFMsNF0w" rel="noopener ugc nofollow" target="_blank"> YouTube </a>上可以找到完整的<a class="ae me" href="https://github.com/GitMarco27/TMML" rel="noopener ugc nofollow" target="_blank">库</a>。<br/>下次见，<br/>马可</p></div></div>    
</body>
</html>