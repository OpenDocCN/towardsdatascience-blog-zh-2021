<html>
<head>
<title>How Vicious Do You Think Your Social Media Comments Are? 😈</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你认为你的社交媒体评论有多恶毒？😈</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-vicious-do-you-think-your-social-media-comments-are-204128141eab?source=collection_archive---------23-----------------------#2021-06-10">https://towardsdatascience.com/how-vicious-do-you-think-your-social-media-comments-are-204128141eab?source=collection_archive---------23-----------------------#2021-06-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="bfd5" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="0137" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">预处理、单词嵌入、模型设计和评估、多标签文本分类</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/79fb7cbb4b71eb98ef29980731eb89cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AQuSENinZxdKVO2Uvy3rIA.gif"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="6a92" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">该项目旨在建立一个<a class="ae ma" href="https://en.wikipedia.org/wiki/Multi-label_classification" rel="noopener ugc nofollow" target="_blank">多标签分类</a>模型，能够检测不同类别的毒性:“有毒”、“严重有毒”、“威胁”、“淫秽”、“侮辱”以及每个评论的“身份仇恨”。一条评论可以属于以上一个以上的类别，或者不属于以上任何一个类别。我使用Regex(正则表达式)、NLTK lib、Bag-of-Words和TF-IDF创建了一个NLP数据预处理管道，然后使用监督机器学习模型(如逻辑回归和朴素贝叶斯)对评论进行分类。</p><h2 id="9309" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">背景</h2><p id="b3e0" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">很明显<a class="ae ma" href="https://scholarcommons.scu.edu/engl_176/2/" rel="noopener ugc nofollow" target="_blank">人类的行为正在改变</a>；我们的情绪越来越依赖于我们在社交媒体上收到的赞、评论和标签。我们得到好的和坏的评论，但每天在数字平台上看到仇恨的话语、诽谤和有害的想法，让它看起来很正常，而它本不应该如此。有毒评论的影响比我们想象的要灾难性得多。它不仅会伤害一个人的自尊或阻止人们进行有意义的讨论，还会煽动人们做出一些邪恶的行为，如最近美国国会的资本骚乱和对印度抗议农民的攻击。因此，如果我们想在社交媒体平台上维持一个文明的环境，以有效地促进对话，那么建立一个可靠的毒性标记系统是非常重要的。</p><h2 id="1f03" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">数据集</strong></h2><p id="fe5e" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">该项目中使用的数据集是为Kaggle毒性评论分类挑战提供的<a class="ae ma" href="https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge/data" rel="noopener ugc nofollow" target="_blank"> Jigsaw/Conversation AI数据集</a>。它包含了维基百科的评论，这些评论已经被人类评级员标记为六种类型的毒性。</p><p id="a244" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">数据集的快照如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi my"><img src="../Images/1f69dd04a8c3b56498058d03e8f3fec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vU0s2cvcZDfuf69nGHGdkw.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图1:数据示例</p></figure><h2 id="d1b7" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">探索性数据分析</strong></h2><ul class=""><li id="9912" class="mz na iq lg b lh mt lk mu ln nb lr nc lv nd lz ne nf ng nh bi translated">评论总数:159，571</li><li id="a597" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ne nf ng nh bi translated">正派评论(负面类):143346</li><li id="66fc" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ne nf ng nh bi translated">不体面的评论(正面类):16，225</li></ul><p id="6ce0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这16，225条不体面的评论被贴上了六种不同类型的有毒标签，如图2所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a4dd89ab688307d809f33872e271c9ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*BKDjQh2e22dMIVO2KH3kEg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图2: <em class="no">每个类别的评论数量</em></p></figure><p id="bd02" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">请注意，注释可能被分配了多个标签，因此图3显示了注释的数量以及与它们相关联的标签数量。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi np"><img src="../Images/1e6b327b7db3497db4b3743a80b77ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*IRydIvEeMm7iDHuDvxJGvQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图3:带有标签数量的注释</p></figure><p id="aa73" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">该数据集非常不平衡，因为负类与正类的比例为89.8:10.2。对于这种倾斜的数据集，该模型将在不学习任何东西的情况下，将评论分类为体面评论的默认准确率为90%。出于同样的原因，在这种情况下，准确性不应该是模型性能的度量。我们需要更具描述性的性能指标。此外，多标签分类问题必须使用与单标签分类问题不同的性能测量来评估。多标签分类度量的一些例子是k处的精度、k处的平均精度、Jaccard相似性分数、汉明损失、采样F1分数等。我使用了Jaccard相似性评分，还检查了F1评分和ROC评分(AUC ),以便更好地评估和选择模型。</p><p id="b6e9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在我探索的这一点上，我弄清楚了问题的本质、数据集的统计数据和用于评估模型的评估指标。于是问题出现了——这些类别之间的关联是什么？我假设任何“严重有毒”、“淫秽”、“威胁”、“侮辱”或“身份仇恨”的评论都自动归入“有毒”类别。为了验证这一点，我将“有毒”类别的评论与其他五个类别成对进行了比较，图4显示所有1，595条严重有毒评论也被标记为有毒评论，证明了我的假设是正确的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/68f0deb121e4ce88c9b2f0fba1c0b716.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*dJ5JPmSeWoSWq0wwyqlU2Q.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图4:毒性和重度毒性比较</p></figure><p id="562d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">但是当比较图5中的“有毒”和“淫秽”类别时，有趣的是注意到在8449条淫秽评论中有523条是无毒的。在调查了一些评论后，我得出结论，当评论给人一种总体上负面的感觉，但不包含粗俗的词语时，人类评分者会将该评论标记为淫秽评论。然而，我也看到了被贴上有毒和淫秽标签的评论。对此有什么解释？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/a74dbf323602b3a34665174c908798c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*aHvgM4YdgmehW0-L4_0ofQ.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图5:有毒和淫秽对比</p></figure><p id="6f12" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">接下来，图6显示总共有478条“威胁”评论，其中29条是无毒的。如果这个评论“<strong class="lg ja"> <em class="ns">你会被屏蔽</em> </strong> <em class="ns"> </em>”被贴上“威胁”而非“有毒”的标签是有道理的。但是<strong class="lg ja">的评论<em class="ns">真好笑。你个人被冒犯了？所以写坏事的人会写你，你的名字等等，对吗？如果一个人被某个网站上的评论或绰号冒犯了，那么这个人至少要在精神上成长500年以上。如果一个人被前面的评论激怒了，那么这个人必须杀了他/她自己。保重！</em> </strong>”被贴上“威胁”而非“有毒”的标签，对我来说没多大意义。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/771daaf47ab4a6062fe56fc94fb3ad66.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0i0wHpDTotxitzr0Qkatbg.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图6:毒性和威胁比较</p></figure><p id="9f5d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当我检查所有7，877条侮辱评论时，我发现533条侮辱评论是无毒的(图7)。在进一步的调查中，我发现“侮辱”评论如果不包含刺耳或粗俗的话，就不是“有毒”的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/95c865caa5a0fb5e990cdff1c6d5b9cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*YX-A1oA326LmsztYBnokZA.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图7:毒性和损伤比较</p></figure><p id="a6d2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">最后，我检查了有毒和身份仇恨评论类别(图8)，1405条身份仇恨评论中有103条是无毒的，原因是这103条评论不包含污秽或粗俗的词语，但它们包含针对种族、肤色、种族、性取向、宗教仇恨等的词语。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/a3e275b3df160a8e81d9ae53b338ec6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*FXL_w-uF61mARsSD5Dc2_w.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图8:毒性和身份仇恨对比</p></figure><p id="08eb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在，让我们看看原始评论。</p><p id="22cb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja"> df.comment_text[0] </strong></p><p id="3281" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ns">“解释\ n为什么在我的用户名“铁杆金属迷”下所做的编辑被恢复了？他们不是故意破坏，只是我在纽约娃娃FAC投票后关闭了一些煤气。请不要将模板从对话页面中删除，因为我现在已经退休了。89.205.38.27 " </em></p><p id="3b10" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在这个例子中，我们看到原始评论有一些不必要的信息，如数字、标点符号和停用词。这些对模型进行预测是没有用的，所以我们在数据预处理中删除了它们。</p><h2 id="58bd" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">数据预处理</strong></h2><ul class=""><li id="c75c" class="mz na iq lg b lh mt lk mu ln nb lr nc lv nd lz ne nf ng nh bi translated">在regex库的帮助下，删除非字符、不需要的空格、数字，并将所有字母转换为小写。</li></ul><p id="552d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这些是我在评论中注意到的模式:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="308f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们用这些替换来写一个清理文本的函数</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nw nx l"/></div></figure><ul class=""><li id="900b" class="mz na iq lg b lh li lk ll ln ny lr nz lv oa lz ne nf ng nh bi translated">使用NLTK完成词条满足、词干提取、标记化和停用词移除</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="4dbb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">通过这两个步骤，我们得到干净的注释。现在原始评论看起来像这样:</p><p id="bed8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ns">“解释编辑做了用户名硬核金属迷还原故意破坏关闭气投纽约娃娃fac请删除模板对话页面，因为退休”</em></p><p id="0698" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">最好是右边！！！</p><h2 id="2c03" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">基于规则的模型</h2><p id="197b" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">在转向机器学习模型之前，我想看看我是否可以通过检查评论中是否存在类别的最常用词来预测评论中的所有六个类别。</p><p id="e65b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为此，按标签创建了六个数据集，然后将来自每个数据集的所有单词存储在它们各自的字典(词汇字典)中，并按照降序排列它们各自的出现次数。最后，通过检查字典中的前三个单词在评论中的出现情况来做出预测。</p><p id="7811" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">预测毒性、严重毒性、淫秽、威胁、侮辱和身份仇恨等级的基线模型精度为:</p><ul class=""><li id="f430" class="mz na iq lg b lh li lk ll ln ny lr nz lv oa lz ne nf ng nh bi translated">有毒:89.4%</li><li id="5d7b" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ne nf ng nh bi translated">重度毒性:88.2%</li><li id="be96" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ne nf ng nh bi translated">淫秽:96.3%</li><li id="47b5" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ne nf ng nh bi translated">威胁:87.8%</li><li id="c15c" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ne nf ng nh bi translated">侮辱:95.8%</li><li id="e28d" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ne nf ng nh bi translated">认同_讨厌:98.3%</li></ul><p id="76a3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">基于这里实现的规则，基线分类器以76.6%的准确度对体面和不体面的评论进行分类。现在我们必须看看基于人工智能的模型是否能提供比这更好的性能。</p><h2 id="c374" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">使用词袋或TF-IDF将评论转换成向量</strong></h2><p id="e20f" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">机器学习模型不接受文本格式的输入，因此我们需要将文本数据转换为矢量形式。这个过程被称为<strong class="lg ja">单词嵌入</strong>。单词嵌入可以大致分为:</p><ol class=""><li id="cca4" class="mz na iq lg b lh li lk ll ln ny lr nz lv oa lz ob nf ng nh bi translated">基于频率——最流行的技术是<a class="ae ma" href="https://en.wikipedia.org/wiki/Bag-of-words_model" rel="noopener ugc nofollow" target="_blank"><strong class="lg ja"/></a><a class="ae ma" href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf" rel="noopener ugc nofollow" target="_blank"><strong class="lg ja">TF-IDF</strong></a></li><li id="7c2b" class="mz na iq lg b lh ni lk nj ln nk lr nl lv nm lz ob nf ng nh bi translated">基于预测——最流行的技术是<strong class="lg ja"> Word2vec </strong>和<strong class="lg ja"> Glove </strong></li></ol><p id="fcb8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里我将使用基于频率的单词嵌入。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="1d46" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">结果嵌入是NumPy数组格式，如果我们观察嵌入，我们将看到高维稀疏数据。</p><h2 id="6e38" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">机器学习模型</strong></h2><p id="4c57" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">为了解决多标签分类问题，OneVsRestClassifier与诸如逻辑回归和朴素贝叶斯的估计器一起使用。</p><p id="9985" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">逻辑回归是尝试的第一选择，因为它适用于高维稀疏数据。第二个选择是多项式朴素贝叶斯，因为它假设计数数据，这意味着每个要素代表某个事物的整数计数。在我们的问题中，整数计数代表一个单词在句子中出现的频率。</p><p id="7118" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">用于训练OneVsRestClassifier的代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="bd21" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在train_model函数中，我使用了<strong class="lg ja"> <em class="ns"> j_score </em> </strong>和<strong class="lg ja"> <em class="ns"> print_score </em> </strong>这些被定义为:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="ddee" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">不同型号的培训结果</strong></h2><p id="c7e6" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">根据不同参数集训练的所有模型的性能摘要:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/87b16a08c9c92189e5316d51be0f9de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*0CVeVN0uoLE929nYkiz9tg.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图9:培训结果</p></figure><p id="f66d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">从训练结果可以清楚地看出，逻辑回归在处理连续数据时表现良好(当使用“TF-IDF”计算特征时)，而<em class="ns">朴素贝叶斯</em>在处理离散形式的数据时表现良好(当使用“词袋”计算特征时)。通过比较这两个模型的<em class="ns"> Jaccard评分</em>、<em class="ns">F1-评分</em>和<em class="ns"> ROC_AUC评分</em>，我注意到朴素贝叶斯表现良好。我确信，随着逻辑回归中超参数的进一步微调，我们可以获得一个好的模型，但要获得与朴素贝叶斯相当的结果，在计算和训练时间方面是相当昂贵的。因此，我选择使用<em class="ns">朴素贝叶斯</em>，使用<em class="ns">“词袋”</em>嵌入技术，其中<em class="ns"> max_features </em>计数为2000。</p><p id="ee14" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里要注意的另一件事是，该模型学习将相应类别中的频繁使用的词与相应的毒性类别相关联。例如，模型会将此评论<em class="ns">“我是一个美丽的黑人同性恋女性</em>”预测为“有毒”和“身份仇恨”，因为“黑人”和“同性恋”在数据集中的“有毒”和“身份仇恨”类别中被大量使用。为了避免这种意想不到的偏见，Jigsaw/Conversational AI提出了另一个<a class="ae ma" href="https://www.kaggle.com/c/jigsaw-unintended-bias-in-toxicity-classification/data" rel="noopener ugc nofollow" target="_blank">数据集</a>，其中他们用身份属性标记了无毒评论的子集。</p><h2 id="07f6" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">结论</strong></h2><p id="c146" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">我们看到机器学习模型击败了基于规则的基线。在未来，我想尝试像LSTM，伯特先进的模式，但在这里我有一个问题给你的读者…</p><p id="a6d7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja"> <em class="ns">当我发现数据集被弱标记时，我应该担心我的模型性能并尝试LSTM或伯特等高级模型，还是应该尝试新的数据集，看看我当前的模型是否能表现得更好？</em>T9】</strong></p><p id="07f2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">要试用此应用程序<a class="ae ma" href="https://classifier-toxic-comment.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">，请点击此处</a>。期待听到大家的想法或评论。</p></div></div>    
</body>
</html>