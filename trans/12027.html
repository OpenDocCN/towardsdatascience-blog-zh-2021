<html>
<head>
<title>Datameer — Simple transformations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Datameer —简单转换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/datameer-simple-transformations-8773709d7e42?source=collection_archive---------18-----------------------#2021-12-03">https://towardsdatascience.com/datameer-simple-transformations-8773709d7e42?source=collection_archive---------18-----------------------#2021-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/22e82034a9e926631e40ce58cdb93b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tIQ908CMyjJC-FAO"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">苏珊·d·威廉姆斯在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1d54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的一个数据工程团队成员正在处理一项新的业务需求。他碰巧遇到了一个相对较新的 SaaS 工具，来自一个已经建立的数据播放器“<a class="ae kc" href="https://www.datameer.com/blog/datameer-offers-innovative-new-saas-data-transformation-solution/?utm_campaign=Transform%20Data%20in%20Snowflake&amp;utm_source=SnoCo&amp;utm_medium=Organic&amp;utm_term=Post&amp;utm_content=Simple-transformations" rel="noopener ugc nofollow" target="_blank"> Datameer </a>”。</p><p id="be15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该工具相当新，支持“拖放”功能。</p><p id="1c8d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不管怎样，我们开始吧。首先，让我向您展示一些我今天正在处理的样本数据。在我的雪花数据库帐户中，我有两个表，一个维度和一个事实。</p><p id="aa98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> D_Tracks </strong>:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/bb47dbca51db58cb8786c1210f566f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/0*99vu84fVOuuHnAjf"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="c2e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> F_Streams </strong>:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/7b348a0a3bb130ba6219219dce782f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/0*8hfKYU752KnP7Ceq"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="fa7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天的目标是简单地找出一首歌每天播放了多少次。从技术上讲，我们只需要三列，即日期、曲目名称和计数。此外，我们只想要那些每天播放不止一次的歌曲——我们感兴趣的是一首歌的受欢迎程度。</p><p id="267b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设您已经用 Datameer SaaS 配置了雪花，让我们看看代表/实现上述需求的解决方案有多容易:</p><p id="5edd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">步骤 1 </strong>:将数据集导入 Datameer SaaS 工具</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/c1d8b2bc86adae2c4b6fbe742bf5724c.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/0*lgoh2_XU3Tx79Vcx"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="73b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第二步</strong>:点击“新建转换”按钮，选择“公式”</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/31aa258d54a8d549592c1dd7f25966ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/0*bNMfH7lr-p7qLG74"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="7604" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第三步</strong>:将 Time_Stamp 转换成日期</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/d8b16b4c9d25fd0efa03feedd43564cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/0*F1qJIiLCW0_YsJkD"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="76fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">出现提示时，选择“Time_Stamp”列并输入以下公式:</p><p id="55ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">TO_DATE(来源。时间戳)</p><p id="1f3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">步骤 4 </strong>:用“F_STREAMS_WITH_DATES”重新命名新“配方”</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/f9c1be7976226f61fae4e7baeabdc40e.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/0*8XKetaUFBnD3mHBt"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="88e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第五步</strong>:点击“F_STREAMS_WITH_DATES”后的新建转换按钮，这次选择“Blend”</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/cd39bef45a348e6b408f47b0b7a631f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/0*3RcvS2dTAL_Dq-8I"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="93e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，我们正在尝试在“Tracks_Key”列的“F_STREAMS_WITH_DATES”和“D_TRACKS”之间执行内部连接。</p><p id="0eff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，请执行以下操作:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/d37eac5bba519e9c48fd8fb56e3f8a42.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/0*U7a3nNBPMnVckbL2"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="6e8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将帮助我们创建一个新的“配方”，如下一个流程图所示。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/95b104869edcf96de91bf0b5ad8746f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/0*3iHKR0NsCGupSmeh"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="3827" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">步骤 6 </strong>:现在添加一个新的聚合转换</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/2e529e60d342920f51ab339297b602f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/0*1bqdAaLAbyUQOQbu"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="f42e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个想法是根据日期和曲目名称对唱片进行分组。此外，我们将创建一个计数列，这将有助于我们过滤掉播放次数少于两次的记录。</p><p id="e367" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了实现上述目标，只需浏览下图:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/2ae8c188f05c1b53f4016417e2628e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/0*LoJpFT4Ru67x1ZvK"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="0764" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">需要注意的是，数据现在看起来如下:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/16fcece0a10b25b0ff9ed35074e06285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GVd6RT4FmJAtDG_t"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="fb33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第 7 步</strong>:删除计数≤ 1 的数据</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/43b84db318b2b207871ed4e8cfcb63ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/0*yAOuwJQDpMKy-Lex"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="c608" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这次一定要选择“过滤器”转换。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/677c6cd78e31e317b185c1ade7af006d.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/0*yy_B-CGeQFwd6AiQ"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="4ad0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">非常简单，向数据集添加一个新的过滤器，只返回计数大于 1 的记录。</p><p id="0472" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第八步</strong>:根据日期对记录进行排序</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/574a33487361d70cb1b0098e2dde48da.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/0*NYWWsVEYoeMA8hRe"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="da36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们需要选择“SQL”转换，在我们的食谱上编写标准的 ANSI SQL，并返回按日期升序排序的结果。</p><p id="9ebe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的流程目前看起来如下:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/34aae5642ce579380979cf2e33d8fd1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rxSQMmj0yMjWOXIm"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="c2e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是按如下方式完成的:</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="eeab" class="lx ly iq lt b gy lz ma l mb mc">select * from F_STREAMS_DATES_TRACKS_AGG_G1 AS FG1<br/>ORDER BY FG1.TIME_STAMP;</span></pre><p id="c56d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">32 条记录的最终数据集如下所示:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/f181ebf72014064f9fd822267bf2c8d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dYfg3Tp-aQF2xt7Q"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="acdf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，如果我们想要编写完整的 SQL 代码，我们可以在同一个工具的 SQL 输入选项中执行以下操作:</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="13e1" class="lx ly iq lt b gy lz ma l mb mc">SELECT TO_DATE(FS.Time_Stamp) as Stream_Date, DT.Track_Name, COUNT(FS.Streams_Key)<br/>FROM EDW.FACTS.F_STREAMS as FS<br/>INNER JOIN EDW.DIMS.D_Tracks DT ON FS.Tracks_Key = DT.Tracks_Key<br/>GROUP BY TO_DATE(FS.Time_Stamp), DT.Track_Name<br/>HAVING COUNT(FS.Streams_Key) &gt; 1;</span></pre><p id="72a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们对 data meer——简单转换——的讨论到此结束。如果你有任何问题，请随时联系我。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><div class="lc ld le lf gt ml"><a href="https://www.datameer.com/blog/datameer-offers-innovative-new-saas-data-transformation-solution/?utm_campaign=Transform%20Data%20in%20Snowflake&amp;utm_source=SnoCo&amp;utm_medium=Organic&amp;utm_term=Post&amp;utm_content=Simple-transformations" rel="noopener  ugc nofollow" target="_blank"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd ir gy z fp mq fr fs mr fu fw ip bi translated">Datameer 提供创新的新 SaaS 数据转换解决方案</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">我们在 Datameer 的团队自豪地宣布，我们正在提供创新的新 SaaS 数据转换解决方案…</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">www.datameer.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz jw ml"/></div></div></a></div></div></div>    
</body>
</html>