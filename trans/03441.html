<html>
<head>
<title>How to Run 30 Machine Learning Models with a Few Lines of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用几行代码运行30个机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-run-30-machine-learning-models-with-2-lines-of-code-d0f94a537e52?source=collection_archive---------1-----------------------#2021-03-19">https://towardsdatascience.com/how-to-run-30-machine-learning-models-with-2-lines-of-code-d0f94a537e52?source=collection_archive---------1-----------------------#2021-03-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1d1a" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">机器学习</h2><div class=""/><div class=""><h2 id="4a70" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">了解如何使用lazy predict运行多个机器学习模型——代码跟随</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1e9ad46ab2ee46962789bf7ae22b99e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-VrCeuHwnnOd-j-pKT4xw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由凯拉·伯顿拍摄。来源:<a class="ae lh" href="https://www.pexels.com/photo/crop-student-using-laptop-on-street-6146980/" rel="noopener ugc nofollow" target="_blank">像素</a></p></figure><p id="96b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当开始一个新的监督机器学习项目时，第一步是分析数据，了解我们试图完成什么，以及哪些机器学习算法可以帮助我们实现我们的目标。虽然<code class="fe me mf mg mh b">scikit-learn</code>库使得用几行代码运行模型变得更加容易，但是当你需要测试多个模型时，它也是非常耗时的。然而，如果我们可以在进入更复杂的方法之前同时运行多个普通模型，并且更好地了解我们应该在哪些模型上投入宝贵的时间，会怎么样呢？</p><p id="9281" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这就是<code class="fe me mf mg mh b">lazy predict</code>试图(成功)完成的事情。它在几秒钟内运行30个机器学习模型，并让我们了解模型在数据集上的表现。为了更好地理解我们如何使用<code class="fe me mf mg mh b">lazy predict</code>，我创建了一个泰坦尼克号幸存者预测项目，这样你就可以跟着编码了。你可以在这里找到<a class="ae lh" href="https://github.com/ismael-araujo/Testing-Libraries" rel="noopener ugc nofollow" target="_blank">完整的笔记本</a>。你可以和我一起编码。Python、<code class="fe me mf mg mh b">Pandas</code>和<code class="fe me mf mg mh b">scikit-learn</code>的基本经验将帮助您更好地理解正在发生的事情。</p><p id="63f6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">导入和清理数据</strong></p><p id="bc7e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">先来导入<code class="fe me mf mg mh b">pyforest</code>。PyForest用一行代码导入了40个最流行的Python库。我写了一篇关于它的文章，你可以在这里找到它。我将使用警告库关闭一些难看的警告消息。我还将导入一些度量库。我们以后会需要它。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="93ad" class="mm mn it mh b gy mo mp l mq mr">import pyforest<br/>import warnings<br/>warnings.filterwarnings("ignore")<br/>from sklearn import metrics<br/>from sklearn.metrics import accuracy_score</span></pre><p id="12be" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们从Kaggle导入将要使用的数据集。你可以在<a class="ae lh" href="https://www.kaggle.com/c/titanic/data" rel="noopener ugc nofollow" target="_blank">这个链接</a>上找到数据集。注意我没有导入<code class="fe me mf mg mh b">Pandas</code>。那是因为它是<code class="fe me mf mg mh b">pyforest</code>自带的。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="f128" class="mm mn it mh b gy mo mp l mq mr"># importing .csv files using Pandas<br/>train = pd.read_csv(‘train.csv’)<br/>test = pd.read_csv(‘test.csv’)</span></pre><p id="c2ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将在本文中跳过一些探索性的数据分析，因为我们的主要焦点是开始使用<code class="fe me mf mg mh b">lazypredict</code>。然而，在我最初的EDA中，你可以在我的GitHub中找到，我注意到我们需要将列<em class="ms">性别</em>转换成数字。我们可以用一个<code class="fe me mf mg mh b">lambda function</code>轻松做到这一点。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="d51e" class="mm mn it mh b gy mo mp l mq mr">train['Sex'] = train['Sex'].apply(lambda x: 1 if x == 'male' else 2)</span></pre><p id="99d9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们还可以删除一些我们不会用于这个微型项目的分类列。对于家庭作业，我建议你在完成这篇文章后尝试使用这些特性。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="1508" class="mm mn it mh b gy mo mp l mq mr">train.drop(columns=[‘Name’,’Ticket’,’Cabin’, ‘PassengerId’, ‘Parch’, ‘Embarked’], inplace=True)</span></pre><p id="28d7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">列车测试拆分</strong></p><p id="0a77" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们将我们的训练集分成变量X和y。我将把所有的特征寻址到X，除了存活的，这是我们的目标标签。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="98e9" class="mm mn it mh b gy mo mp l mq mr">X = train.drop([‘Survived’], axis=1)<br/>y = train.Survived</span></pre><p id="7ed1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们将变量分成训练集和测试集。我将使用默认的0.25作为测试大小。您可以使用轻松地添加其他值。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="ba9e" class="mm mn it mh b gy mo mp l mq mr">X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)</span></pre><p id="5355" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">用</strong>建模<code class="fe me mf mg mh b"><strong class="lk jd">LazyPredict</strong></code></p><p id="f426" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在是娱乐的时候了。如果这是你第一次使用<code class="fe me mf mg mh b">lazypredict</code>，你必须安装它。为此，你可以在终端中输入<code class="fe me mf mg mh b">pip install lazypredict</code>。如果您已经安装了它，让我们将它导入到您的项目中。既然这是一个分类项目，那我们也导入<code class="fe me mf mg mh b">LazyClassifier</code>吧。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="1d81" class="mm mn it mh b gy mo mp l mq mr">import lazypredict<br/>from lazypredict.Supervised import LazyClassifier</span></pre><p id="2acd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，让我们运行模型，看看效果如何。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="73f0" class="mm mn it mh b gy mo mp l mq mr">clf = LazyClassifier(verbose=0,ignore_warnings=True)<br/>models, predictions = clf.fit(X_train, X_test, y_train, y_test)<br/>models</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mt"><img src="../Images/2c70d76a3b7a76edd463904b5556e7a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N_f0qaldxYwnAPO__yPL5Q.png"/></div></div></figure><p id="5b28" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">瞧。你刚刚在不到2秒的时间内迭代了30个模型。这是令人难以置信的快速和毫不费力。然而，我们如何确保这些结果是准确的呢？现在，我们可以通过运行几个模型并比较它们来检查结果。对于这个项目，我将使用随机森林和逻辑回归模型测试数据集。让我们看看我们是否能接近刚刚看到的结果。先说随机森林。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="bd41" class="mm mn it mh b gy mo mp l mq mr">rf = RandomForestClassifier()<br/>rf.fit(X_train, y_train)<br/>y_pred = rf.predict(X_test)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mu"><img src="../Images/6376b2d8c738edd3757cf2310e68195e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6gdKMTFI4_b9GDOkD0HRQ.png"/></div></div></figure><p id="6ada" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如我们所看到的，准确性和F1分数得到了非常相似的结果。现在让我们试试逻辑回归。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="f876" class="mm mn it mh b gy mo mp l mq mr">rf = LogisticRegression()<br/>rf.fit(X_train, y_train)<br/>y_pred_lr = rf.predict(X_test)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mv"><img src="../Images/49aa55f6219681ad3ec7ae141737ffd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfFEuN0HOLl6F4WQiiPVtg.png"/></div></div></figure><p id="59a4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">同样，我们得到了非常相似的结果。看起来结果是可信的。那很容易。</p><p id="1d93" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">结论</strong></p><p id="55d6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe me mf mg mh b">lazypredict</code>是一个简单快捷的库，它可以很好地预测我们的模型在你的数据集。请记住，用<code class="fe me mf mg mh b">lazy predict</code>获得的结果不应被视为最终模型。统计学是数据科学的一个重要组成部分，因为不同的模型有不同的方法，所以在选择最终的模型之前，您应该知道每个模型是如何工作的。更重要的是，数据科学是一个复杂的领域，没有利弊就没有神奇的解决方案。将它作为您的第一次迭代，以确认您计划的方法，并使用<code class="fe me mf mg mh b">scikit-learn</code>等工具反复检查结果。玩得开心，让我知道它是否对你有用！</p></div></div>    
</body>
</html>