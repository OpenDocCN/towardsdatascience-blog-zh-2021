<html>
<head>
<title>Bayesian Linear Regression: Analysis of Car Sales with arm in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">贝叶斯线性回归:基于arm的汽车销售分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bayesian-linear-regression-analysis-of-car-sales-with-arm-in-r-b1147e79a9a4?source=collection_archive---------22-----------------------#2021-09-13">https://towardsdatascience.com/bayesian-linear-regression-analysis-of-car-sales-with-arm-in-r-b1147e79a9a4?source=collection_archive---------22-----------------------#2021-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d49a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用贝叶斯线性回归解释不确定性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7034672702e338e79bd03e6e2445ec47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qW-qRDG5eaxJRu9MGY-RjA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:图片来自<a class="ae ky" href="https://pixabay.com/photos/speedometer-dashboard-car-speed-1249610/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="60e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">线性回归是最常用也是最有用的建模工具之一。</p><p id="0269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然没有任何形式的回归分析可以接近现实，但它可以很好地预测因变量，并确定每个自变量影响因变量的程度，即每个系数的大小和重要性。</p><p id="0d71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，传统的线性回归可能有缺点，因为这种方法不能真正解释估算中的<strong class="lb iu">不确定性</strong>。</p><p id="8c7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，贝叶斯线性回归可以作为这个问题的解决方案-通过重复模拟提供许多不同的系数值估计。例如，如果我们希望进行20，000次模拟，这种方法可以返回20，000条不同的回归线，这些回归线将说明在各种情况下因变量的潜在波动。</p><p id="df5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了说明这一点，让我们来看看R中的<strong class="lb iu"> arm </strong>库如何使用贝叶斯线性回归来预测汽车销量。</p><h1 id="5463" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">标准线性回归</h1><p id="4117" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">该分析是在<a class="ae ky" href="https://www.kaggle.com/gagandeep16/car-sales" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>可用的汽车销售数据集上进行的，该数据集根据<a class="ae ky" href="https://creativecommons.org/publicdomain/zero/1.0/" rel="noopener ugc nofollow" target="_blank"> CC0 1.0通用(CC0 1.0)公共领域专用许可</a>提供。</p><p id="ca18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第一种情况下，设计线性回归来确定销售额(以千计)如何根据以下因素波动:</p><ul class=""><li id="7de8" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">发动机尺寸</li><li id="3d8f" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">车型</li><li id="45b7" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">马力</li><li id="a254" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">轴距</li><li id="d8ac" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">宽度</li><li id="0633" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">长度</li><li id="8462" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">整备重量</li><li id="04bf" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">燃料容量</li><li id="1e93" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">燃料效率</li><li id="cd9e" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">功率性能因数</li></ul><p id="ab31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是线性回归和输出结果。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="4f10" class="nl lw it nh b gy nm nn l no np">Call:<br/>lm(formula = Sales_in_thousands ~ Engine_size + Vehicle_type + <br/>    Horsepower + Wheelbase + Width + Length + Curb_weight + Fuel_capacity + <br/>    Fuel_efficiency + Power_perf_factor)</span><span id="6236" class="nl lw it nh b gy nq nn l no np">Residuals:<br/>    Min      1Q  Median      3Q     Max <br/>-104.47  -29.09   -6.86   14.00  337.19</span><span id="82a7" class="nl lw it nh b gy nq nn l no np">Coefficients:<br/>                       Estimate Std. Error t value Pr(&gt;|t|)   <br/>(Intercept)           -302.7471   154.7623  -1.956  0.05242 . <br/>Engine_size             31.7419    11.0641   2.869  0.00475 **<br/>Vehicle_typePassenger  -45.1881    19.3850  -2.331  0.02117 * <br/>Horsepower              -0.5830     0.8825  -0.661  0.50990   <br/>Wheelbase                3.7231     1.3670   2.724  0.00727 **<br/>Width                    0.8454     2.4341   0.347  0.72889   <br/>Length                   0.7609     0.8295   0.917  0.36054   <br/>Curb_weight            -63.7597    20.4988  -3.110  0.00226 **<br/>Fuel_capacity           -1.1049     2.7603  -0.400  0.68955   <br/>Fuel_efficiency          0.5560     2.3522   0.236  0.81350   <br/>Power_perf_factor        0.2592     1.9605   0.132  0.89502   <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="1061" class="nl lw it nh b gy nq nn l no np">Residual standard error: 58 on 141 degrees of freedom<br/>  (5 observations deleted due to missingness)<br/>Multiple R-squared:  0.3391, Adjusted R-squared:  0.2922 <br/>F-statistic: 7.235 on 10 and 141 DF,  p-value: 3.643e-09</span></pre><p id="80ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，发动机尺寸、车型、轴距和整备质量在5%的水平上具有统计显著性(一些变量在1%的水平上具有显著性)。</p><p id="8ec8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在删除无关紧要的变量并在迭代中再次生成回归后，最终的回归结果如下:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="f76c" class="nl lw it nh b gy nm nn l no np">Call:<br/>lm(formula = Sales_in_thousands ~ Vehicle_type + Wheelbase + <br/>    Curb_weight)</span><span id="aff0" class="nl lw it nh b gy nq nn l no np">Residuals:<br/>    Min      1Q  Median      3Q     Max <br/>-107.15  -32.26   -9.68   18.33  339.38</span><span id="d886" class="nl lw it nh b gy nq nn l no np">Coefficients:<br/>                      Estimate Std. Error t value Pr(&gt;|t|)    <br/>(Intercept)           -288.840     76.741  -3.764 0.000239 ***<br/>Vehicle_typePassenger  -44.626     12.673  -3.521 0.000568 ***<br/>Wheelbase                5.287      0.816   6.479 1.23e-09 ***<br/>Curb_weight            -57.100     10.697  -5.338 3.39e-07 ***<br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="2c7b" class="nl lw it nh b gy nq nn l no np">Residual standard error: 58.67 on 151 degrees of freedom<br/>  (2 observations deleted due to missingness)<br/>Multiple R-squared:  0.2787, Adjusted R-squared:  0.2644 <br/>F-statistic: 19.45 on 3 and 151 DF,  p-value: 1.027e-10</span></pre><p id="957b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重要变量是车辆类型、轴距和整备质量。虽然<strong class="lb iu"> 27.87% </strong>的R平方在统计学上较低，但这并不一定意味着模型不好。事实上，有许多不同的因素可以影响汽车销售，这里没有考虑。</p><p id="cb69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型中的其余变量被表示为非常重要，这表明它们与确定汽车销售相关。让我们更详细地分析模型系数。</p><ul class=""><li id="0c31" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">在这种情况下，<strong class="lb iu"> -288.84 </strong>的截距是虚假的，但理论上代表了所有其他系数为零时的最小销售额。但是，销售额不能为负，因此系数本身没有任何意义。</li><li id="4c7b" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">由于Vehicle_typePassenger变量的系数为-44.626，这意味着如果一种车型被归类为“客车”而不是“轿车”，销售额将下降<strong class="lb iu"> $44.626 </strong>。</li><li id="331e" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">轴距每增加一个单位，汽车销量就会增加<strong class="lb iu">5.287美元</strong>。</li><li id="fed4" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">整备质量每增加一个单位，汽车销量就会减少<strong class="lb iu">-57.10美元</strong>。</li></ul><p id="7cce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用方差膨胀因子检验时，没有一个变量的多重共线性检验为阳性(即VIF统计值大于5)。这表明没有一个变量彼此显著相关，因此扭曲了回归结果。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="6012" class="nl lw it nh b gy nm nn l no np">&gt; library(car)<br/>&gt; vif(M1)<br/>Vehicle_type    Wheelbase  Curb_weight <br/>    1.384649     1.746395     2.035252</span></pre><p id="2392" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">直方图表明汽车销售的分布是非正态的。因此，在这种情况下，异方差性没有被测试(或者实际上被校正)。事实上，正态性并不是生成线性回归模型的必要条件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/8871971134833727091a4443bcca696d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*ViAZh5pLxNB63Mn3IbuMWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:RStudio输出</p></figure><h1 id="aa25" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">贝叶斯线性回归</h1><blockquote class="ns"><p id="66c3" class="nt nu it bd nv nw nx ny nz oa ob lu dk translated">“所有的模型都是错的，但有些是有用的。”</p><p id="1524" class="nt nu it bd nv nw nx ny nz oa ob lu dk translated">乔治·e·p·Box</p></blockquote><p id="7fed" class="pw-post-body-paragraph kz la it lb b lc oc ju le lf od jx lh li oe lk ll lm of lo lp lq og ls lt lu im bi translated">虽然上述线性回归提供了信息，但它的一个缺点是没有考虑到估计中的不确定性。</p><p id="380c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们真的可以期望轴距每增加一个单位，汽车销量总会增加5.287美元吗？</p><p id="3d58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，我们知道情况并非如此。相反，我们想想出一种方法来解释估计中的不确定性，并生成一系列广泛的销售预测。</p><p id="c483" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">毕竟，贝叶斯分析的目的是以概率的方式分析数据——考虑尽可能多的潜在情况。</p><p id="6cfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到这一点，R中的<a class="ae ky" href="https://cran.r-project.org/web/packages/arm/arm.pdf" rel="noopener ugc nofollow" target="_blank"> arm </a> <strong class="lb iu"> </strong>包用于生成20，000条不同的回归线，以说明估计中的不确定性。</p><p id="b02a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，生成模拟时，会生成具有不同系数估计的回归。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="cb62" class="nl lw it nh b gy nm nn l no np">&gt; library(arm)<br/>&gt; M1.sim &lt;- sim(M1, n.sims=20000)<br/>&gt; M1.sim<br/>&gt; coef.M1.sim &lt;- coef(M1.sim)<br/>&gt; coef.M1.sim</span><span id="1c08" class="nl lw it nh b gy nq nn l no np">An object of class "sim"<br/>Slot "coef":<br/>         (Intercept) Vehicle_typePassenger Wheelbase Curb_weight<br/>    [1,]  -142.29350           -40.1585711  4.046482   -62.73836<br/>    [2,]  -311.43351           -46.1396357  6.056344   -74.03777<br/>...<br/>  [249,]  -249.44178           -52.5240319  5.590081   -76.08825<br/>  [250,]  -184.34866           -60.6832116  4.493316   -59.79492<br/> [ reached getOption("max.print") -- omitted 19750 rows ]</span></pre><p id="5ec4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，还会产生残差(由<em class="oh">σhat</em>提取):</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="36f2" class="nl lw it nh b gy nm nn l no np">&gt; sigma.M1.sim &lt;- sigma.hat(M1.sim)<br/>&gt; sigma.M1.sim<br/>[1] 53.53439 56.59501 62.36744 48.25297 62.11458 65.81519 51.64420<br/>[8] 62.34890 55.86902 52.15755 60.12543 59.68573 55.92115 62.00584<br/>[15] 60.30506 63.08531 56.79228 57.74138 53.94584 57.22139 60.00236<br/>...<br/>[981] 54.00598 63.18356 59.70908 60.27791 64.86504 53.71799 59.88211<br/>[988] 58.08702 56.12842 62.05933 61.02171 54.30973 60.43517 61.74605<br/>[995] 54.91794 60.25361 56.72824 57.06674 61.47696 62.64697<br/>[ reached getOption("max.print") -- omitted 19000 entries ]</span></pre><p id="90bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，可以在分位数的基础上计算系数的不确定性:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="a314" class="nl lw it nh b gy nm nn l no np">&gt; apply(coef(M1.sim), 2, quantile)<br/>     (Intercept) Vehicle_typePassenger Wheelbase Curb_weight<br/>0%    -589.44627             -98.60129  1.929788   -97.18706<br/>25%   -341.31489             -53.40231  4.737972   -64.23857<br/>50%   -289.01086             -44.73874  5.287846   -57.07201<br/>75%   -237.68266             -36.07124  5.836498   -49.90656<br/>100%    20.27591              11.40947  8.547013   -19.46040</span></pre><p id="5a23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过观察这些系数，我们可以看到系数本身可能存在显著的变化。</p><p id="08e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，虽然乘用车类型降低了0%、25%、50%和75%分位数的销售额，但在100%分位数的模拟中，销售额实际上是增加的。有没有逆势而上的特殊车型？这个模型可以为进一步研究这个问题提供一个有用的起点。</p><p id="b5dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于汽车的轴距(前轮和后轮之间的距离)，我们可以看到，在0%分位数时，每增加一个单位对销售额的影响是1.92美元，但在100%分位数时会增加到8.54美元。</p><p id="c229" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了系数估计值之外，我们还可以绘制残差图(由sigma.hat提取):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/346f54e464466a6472d305ee814a382b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*MmKpVATzeycHPXVp0p0HUg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:RStudio输出</p></figure><p id="3386" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是基于分位数报告的残差:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="1b6a" class="nl lw it nh b gy nm nn l no np">&gt; q<br/>      0%      25%      50%      75%     100% <br/>47.52279 56.60056 58.82638 61.15704 78.96791</span></pre><p id="84f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于我们已经看到汽车销售的分布具有强烈的正偏态分布(即，选定的几款汽车显示的销售数字比其余的高得多)，这可能是我们看到高不确定性估计值的原因之一，即，50%分位数的不确定性估计值为58，826美元。</p><p id="6f41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，贝叶斯线性回归在通过生成大范围的模拟和潜在情景来模拟这种不确定性时非常有用。</p><h1 id="ff18" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="0cc2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，您已经看到:</p><ul class=""><li id="b60e" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">传统线性回归的缺点</li><li id="74d9" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">如何生成贝叶斯线性回归</li><li id="f17b" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">使用arm包生成许多回归模拟</li><li id="503c" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">模型估计的不确定性分析</li></ul><p id="5636" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的宝贵时间，非常感谢您的任何问题或反馈。你可以在<a class="ae ky" href="https://www.michael-grogan.com/" rel="noopener ugc nofollow" target="_blank">michael-grogan.com</a>找到更多我的数据科学内容。</p><p id="7296" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oh">免责声明:本文是在“原样”的基础上编写的，没有担保。它旨在提供数据科学概念的概述，不应被解释为专业建议。本文中的发现和解释是作者的发现和解释，不被本文中提到的任何第三方认可或隶属于任何第三方。作者与本文提及的任何第三方无任何关系。</em></p></div></div>    
</body>
</html>