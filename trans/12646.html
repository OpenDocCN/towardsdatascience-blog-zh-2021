<html>
<head>
<title>How to Deploy Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何部署机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-deploy-machine-learning-models-601f8c13ff45?source=collection_archive---------2-----------------------#2021-12-29">https://towardsdatascience.com/how-to-deploy-machine-learning-models-601f8c13ff45?source=collection_archive---------2-----------------------#2021-12-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0be0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在网络上部署机器学习模型的最简单方法</h2></div><h2 id="5799" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h2><p id="df74" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我将介绍在 web 上部署机器学习应用程序的最简单的方法。在之前的笔记本中，我已经使用<a class="ae lx" rel="noopener" target="_blank" href="/fish-weight-prediction-regression-analysis-for-beginners-part-1-8e43b0cb07e">线性</a>和<a class="ae lx" rel="noopener" target="_blank" href="/regression-analysis-for-beginners-using-tree-based-methods-2b65bd193a7">基于树的</a>模型建立了机器学习模型。事实证明，经过超调优的 XGboost 模型表现最佳。这就是为什么今天我们将使用 XGboost 构建一个鱼体重预测 web 应用程序。一般来说，部署 ML 模型有不同的选项，比如 Flask、Django、Streamlit 等。今天我将使用 Streamlit，因为这是最简单快捷的方法，而且不需要任何 web 开发知识。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/f4df6b85d58755c53f8368e92532de12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*OxRZXd2sHPhYqBUbF66UMQ.gif"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">ML 模型部署演示(作者供图)</p></figure><p id="266a" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">∘ <a class="ae lx" href="#5799" rel="noopener ugc nofollow">简介</a> <br/> ∘ <a class="ae lx" href="#03c7" rel="noopener ugc nofollow">鱼重预测应用</a> <br/> ∘ <a class="ae lx" href="#aaab" rel="noopener ugc nofollow">是怎么做到的？</a>T12】∘<a class="ae lx" href="#e217" rel="noopener ugc nofollow">结论:</a></p><h2 id="03c7" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">鱼体重预测应用</h2><p id="0696" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">你可以在这里看到演示<a class="ae lx" href="https://share.streamlit.io/gurokeretcha/fishweightpredictionapplication/main.py" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="9b4c" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">这里可以看到 GitHub 代码<a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="aaab" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">怎么做到的？</h2><p id="518e" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">有三个主要的 python 文件来构建应用程序。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/7018c0f8f002293e81e7e89223ca14bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*FB1DSz31ShqH0vrpGdoVPQ.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者照片</p></figure><ol class=""><li id="8cc7" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw mv mw mx my bi translated"><a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication/blob/master/model.py" rel="noopener ugc nofollow" target="_blank"> model.py </a> —构建 ML 模型并保存。</li></ol><p id="dd7b" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication/blob/master/prediction.py" rel="noopener ugc nofollow" target="_blank"> 2。prediction.py </a> —测试保存的 ML 模型。</p><p id="4676" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication/blob/master/main.py" rel="noopener ugc nofollow" target="_blank"> 3。main.py </a> —运行 web 应用程序的主文件。</p><p id="02ce" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">为了自己构建和部署 ML 项目，需要遵循以下 7 个步骤。</p><p id="d442" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">第一步:使用 Pycharm IDE 创建一个新的虚拟环境。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/9031543e5c5049e0c3363b6ce540eeff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*572UFmLoF4MpYk2d7GkDNQ.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">Pycharm IDE，作者照片</p></figure><p id="c149" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">第二步:安装必要的库。</p><p id="8578" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">在这里的<a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication/blob/master/requirements.txt" rel="noopener ugc nofollow" target="_blank"> requirements.txt </a>中，我创建了所有需要安装的库。您可以使用以下方式下载并安装该文件:</p><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="70e7" class="ki kj it nf b gy nj nk l nl nm">pip install -r /path/to/requirements.txt</span></pre><p id="7b36" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">或者您可以使用 pip 逐个安装每个库。</p><p id="39b9" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><strong class="lg iu">第三步:建立最佳机器学习模型并保存。</strong></p><p id="37f4" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication/blob/master/model.py" rel="noopener ugc nofollow" target="_blank"> model.py </a>在这个文件中，我创建了一个机器学习模型，并保存为 JSON 文件<a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication/blob/master/best_model.json" rel="noopener ugc nofollow" target="_blank"> best_model.json </a>。</p><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="285a" class="ki kj it nf b gy nj nk l nl nm">best_xgboost_model.save_model("best_model.json")</span></pre><p id="f28c" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">你可以在我的<a class="ae lx" rel="noopener" target="_blank" href="/regression-analysis-for-beginners-using-tree-based-methods-2b65bd193a7">上一篇文章中看到 ML 模型是如何构建的详细解释。</a></p><p id="f95f" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><strong class="lg iu">第四步:测试加载的模型。</strong></p><p id="19e1" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><a class="ae lx" href="https://github.com/gurokeretcha/FishWeightPredictionApplication/blob/master/prediction.py" rel="noopener ugc nofollow" target="_blank"> prediction.py </a>在这个文件中，我测试了加载的模型，并使用。</p><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="ef07" class="ki kj it nf b gy nj nk l nl nm">np.save('classes.npy', label_encoder.classes_)</span></pre><p id="e0f2" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><strong class="lg iu">第五步:创建 main.py 文件</strong></p><ul class=""><li id="ac45" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw nn mw mx my bi translated"><strong class="lg iu">步骤 5.1 导入库和数据集</strong></li></ul><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="29d6" class="ki kj it nf b gy nj nk l nl nm">import streamlit as st<br/>import pandas as pd<br/>from sklearn.preprocessing import  LabelEncoder<br/>import xgboost as xgb<br/>import numpy as np</span><span id="aa3f" class="ki kj it nf b gy no nk l nl nm">st.header("Fish Weight Prediction App")<br/>st.text_input("Enter your Name: ", key="name")<br/>data = pd.read_csv("fish.csv")</span></pre><ul class=""><li id="59d6" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw nn mw mx my bi translated"><strong class="lg iu">步骤 5.2:加载保存的标签编码器类</strong></li></ul><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="3bd9" class="ki kj it nf b gy nj nk l nl nm">encoder = LabelEncoder()<br/>encoder.classes_ = np.load('classes.npy',allow_pickle=True)</span></pre><ul class=""><li id="c3d4" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw nn mw mx my bi translated"><strong class="lg iu">步骤 5.3:加载保存的最佳模型</strong></li></ul><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="c926" class="ki kj it nf b gy nj nk l nl nm"># load model<br/>best_xgboost_model = xgb.XGBRegressor()<br/>best_xgboost_model.load_model("best_model.json")</span></pre><ul class=""><li id="2d22" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw nn mw mx my bi translated"><strong class="lg iu">步骤 5.4:在网页上显示数据帧</strong></li></ul><p id="e58e" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">如果复选框被选中，显示训练数据</p><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="bc40" class="ki kj it nf b gy nj nk l nl nm">if st.checkbox('Show dataframe'):<br/>    data</span></pre><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi np"><img src="../Images/549b80d145bb177100a89f4ea0f2e66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avqehKVZzdzZNtj-tpmQ7Q.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者照片</p></figure><ul class=""><li id="cbd9" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw nn mw mx my bi translated"><strong class="lg iu">步骤 5.5:选择鱼种</strong></li></ul><p id="2079" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">从所有鱼的独特值中选择鱼的名称。</p><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="693c" class="ki kj it nf b gy nj nk l nl nm">st.subheader("Please select relevant features of your fish!")<br/>left_column, right_column = st.columns(2)<br/>with left_column:<br/>    inp_species = st.radio(<br/>        'Name of the fish:',<br/>        np.unique(data['Species']))</span></pre><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d1aa33af71c50bea95cf2d6f9ba58ed5.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*5iCbzO1J83yyE76K3kWFcw.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者照片</p></figure><ul class=""><li id="23bd" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw nn mw mx my bi translated"><strong class="lg iu">步骤 5.6:使用滑动窗口选择每个特征值</strong></li></ul><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="ac91" class="ki kj it nf b gy nj nk l nl nm">input_Length1 = st.slider('Vertical length(cm)', 0.0, max(data["Length1"]), 1.0)<br/>input_Length2 = st.slider('Diagonal length(cm)', 0.0, max(data["Length2"]), 1.0)<br/>input_Length3 = st.slider('Cross length(cm)', 0.0, max(data["Length3"]), 1.0)<br/>input_Height = st.slider('Height(cm)', 0.0, max(data["Height"]), 1.0)<br/>input_Width = st.slider('Diagonal width(cm)', 0.0, max(data["Width"]), 1.0)</span></pre><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nr"><img src="../Images/874ed7ac43087a46c0706c2a6f898d85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3EvuXteHllP6oRK6zNr9Sw.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者照片</p></figure><ul class=""><li id="ef7d" class="mq mr it lg b lh mk lk ml kr ms kv mt kz mu lw nn mw mx my bi translated"><strong class="lg iu">步骤 5.7:制作预测按钮</strong></li></ul><p id="d067" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">一旦用户点击该按钮，物种输入将从文本转换为相关的数字，然后所有输入的特征与特定的形状连接起来，模型预测就完成了！</p><pre class="lz ma mb mc gt ne nf ng nh aw ni bi"><span id="d313" class="ki kj it nf b gy nj nk l nl nm">if st.button('Make Prediction'):<br/>    input_species = encoder.transform(np.expand_dims(inp_species, -1))<br/>    inputs = np.expand_dims(<br/>        [int(input_species), input_Length1, input_Length2, input_Length3, input_Height, input_Width], 0)<br/>    prediction = best_xgboost_model.predict(inputs)<br/>    print("final pred", np.squeeze(prediction, -1))<br/>    st.write(f"Your fish weight is: {np.squeeze(prediction, -1)} Gram")</span></pre><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ns"><img src="../Images/8cfb2ea40aea12212394121a2b649929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IETVdZMb-07TbKhSqpxgwg.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者照片</p></figure><p id="5cca" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><strong class="lg iu">第六步:上传本地项目到 Github </strong></p><p id="4563" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">您可以使用<a class="ae lx" href="https://git-scm.com/" rel="noopener ugc nofollow" target="_blank"> git </a>上传您的本地项目，或者您可以将文件夹拖放到<a class="ae lx" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的一个空存储库中。</p><p id="871d" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated"><strong class="lg iu">第七步:在</strong> <a class="ae lx" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">细流</strong> </a>上创建账户</p><p id="9592" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">最后一步是创建一个账户，点击“从现有的 repo”连接到你的 GitHub 库</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nt"><img src="../Images/c5d25cae0aa2ddf29c85f940a485f684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJE518hOFpSHT9JN6-jysw.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">Streamlit，作者照片</p></figure><h2 id="e217" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论:</h2><p id="304c" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">没错，就是洒脱。在一般建筑中，机器学习应用主要由两部分组成。第一步是构建模型，第二步是部署和监控模型。今天，我们已经使用 Streamlit 完成了部署部分。这个简单的应用程序只是说明了该模型是如何部署的，它可以作为其他大型项目的样本。在下一篇文章中，我还将尝试使用另一种方法来部署 ML 模型。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="41a4" class="pw-post-body-paragraph le lf it lg b lh mk ju lj lk ml jx lm kr mm lo lp kv mn lr ls kz mo lu lv lw im bi translated">如果你想了解更多关于<strong class="lg iu">应用数据科学</strong>的信息，这里是<strong class="lg iu">我的新 YouTube 频道</strong>——<a class="ae lx" href="https://www.youtube.com/channel/UCvlF0PPaQ2GAuqYKJT4UpJQ" rel="noopener ugc nofollow" target="_blank">AI 学院与朋友</a></p><div class="ob oc gp gr od oe"><a href="https://www.youtube.com/channel/UCvlF0PPaQ2GAuqYKJT4UpJQ" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">和朋友一起的 AI 学院</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">与朋友、家人和全世界分享您的视频</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">www.youtube.com</p></div></div><div class="on l"><div class="oo l op oq or on os me oe"/></div></div></a></div></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><blockquote class="ot ou ov"><p id="0ecd" class="le lf ow lg b lh mk ju lj lk ml jx lm ox mm lo lp oy mn lr ls oz mo lu lv lw im bi translated">我希望你喜欢它，现在可以开始自己创建漂亮的应用程序。</p><p id="e2e4" class="le lf ow lg b lh mk ju lj lk ml jx lm ox mm lo lp oy mn lr ls oz mo lu lv lw im bi translated">如果你喜欢我的文章，想看即将到来的故事，请在<a class="ae lx" href="https://medium.com/@gkeretchashvili" rel="noopener"> medium </a>上关注我。</p></blockquote><div class="ob oc gp gr od oe"><a href="https://medium.com/@gkeretchashvili" rel="noopener follow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">gurami keretcashvili-培养基</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">一个数据科学家不是懂 python，Sklearn，TensorFlow 等的人。但是谁知道如何玩…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">medium.com</p></div></div><div class="on l"><div class="pa l op oq or on os me oe"/></div></div></a></div></div></div>    
</body>
</html>