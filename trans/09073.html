<html>
<head>
<title>No, [] And list() Are Different In Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不，[]和list()在Python中是不同的</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/no-and-list-are-different-in-python-8940530168b0?source=collection_archive---------3-----------------------#2021-08-22">https://towardsdatascience.com/no-and-list-are-different-in-python-8940530168b0?source=collection_archive---------3-----------------------#2021-08-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/9c526c1a494b1ba3ff1509ceebcfd89b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rveds5VvBpklhSm1sLEGhA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片来自<a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4636996" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae jg" href="https://pixabay.com/users/vagelisdimas-6518988/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4636996" rel="noopener ugc nofollow" target="_blank"> Vagelis Dimas </a></p></figure><div class=""/><div class=""><h2 id="febc" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">特殊的Python文字常量使你的程序更快更Python化</h2></div><p id="0577" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只要你是Python开发者，就一定用过这个列表。它是Python中最常用的容器类型。另外，我猜你一定知道我们可以使用成对的方括号<code class="fe lu lv lw lx b">[]</code>来初始化一个空列表。</p><p id="3704" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这篇文章实际上是从与某人的讨论开始的。他认为使用<code class="fe lu lv lw lx b">list()</code>来初始化Python列表更具可读性。显然，这个人很可能来自其他编程语言。好吧，我说如果有人坚持写像<code class="fe lu lv lw lx b">my_list = list()</code>这样的东西，这确实不是世界末日。但坦率地说，<code class="fe lu lv lw lx b">my_list = []</code>不仅更“蟒”，而且速度更快。</p><p id="b91f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我将演示性能的比较。更重要的是，我会告诉你为什么<code class="fe lu lv lw lx b">my_list = []</code>更快。</p><h1 id="71ce" class="ly lz jj bd ma mb mc md me mf mg mh mi kp mj kq mk ks ml kt mm kv mn kw mo mp bi translated">性能的比较</h1><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f0c9c34d7ebc0e8a21389715984c894d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pq4SB7aN3abDBwFV0kuxww.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片来自<a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6518594" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="f4ad" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在深入细节之前，最好先验证一下性能。总是建议先证明想法，再去保护它，甚至争论:)</p><p id="4d90" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从初始化Python列表的两种方式开始。</p><pre class="mq mr ms mt gt mu lx mv mw aw mx bi"><span id="442e" class="my lz jj lx b gy mz na l nb nc">my_list_1 = []<br/>my_list_2 = list()</span></pre><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/23e620543e2f5a62e1fe1bf7fe769231.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*YLOPf4WR4FIJGZQCTrQifA.png"/></div></figure><p id="2011" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就结果而言，他们是一样的。这两条语句都给了我们一个Python列表。现在，我们需要测量<strong class="la jk">性能</strong>。</p><p id="1519" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于像Jupyter这样的Python笔记本，使用神奇的命令<code class="fe lu lv lw lx b">%timeit</code>来测量性能是非常容易的。</p><pre class="mq mr ms mt gt mu lx mv mw aw mx bi"><span id="916a" class="my lz jj lx b gy mz na l nb nc">%timeit my_list_1 = []</span><span id="0332" class="my lz jj lx b gy ne na l nb nc">%timeit my_list_1 = list()</span></pre><p id="0c82" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，上面两行代码需要在不同的单元格中运行。</p><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/924985d6c5ad95002188279ddb3e8293.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*acyv3cIT1COV-TrOluOGOw.png"/></div></figure><p id="771e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如结果所示，使用<code class="fe lu lv lw lx b">[]</code>大约比<code class="fe lu lv lw lx b">list()</code>快3倍。它非常有信心，因为结果是基于10，000，000次运行。</p><p id="cb87" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可能也会对其他类似的场景感兴趣，比如<code class="fe lu lv lw lx b">{}</code>和<code class="fe lu lv lw lx b">dict()</code>。事实上，在这些情况下也存在性能差距。</p><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/650a6cec9f5da77b24353265af98ce3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*U2yLWIOSDbaSZ9hixuJKQw.png"/></div></figure><h1 id="c84a" class="ly lz jj bd ma mb mc md me mf mg mh mi kp mj kq mk ks ml kt mm kv mn kw mo mp bi translated">字节码故障调查</h1><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/4aa5219ea157499f05a2b55494b4e732.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oJJe2tx1fK8jlB1T-d1tzQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片来自<a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6517488" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae jg" href="https://pixabay.com/users/bejan-3893186/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6517488" rel="noopener ugc nofollow" target="_blank"> János Bencs </a></p></figure><p id="c695" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要了解幕后发生了什么，我们可以去Python的底层寻找答案，也就是字节码。</p><p id="0a50" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">字节码可以被认为是Python解释器的一系列指令或低级程序。对于大多数开发人员来说，没有必要学习它，但是知道这样的东西存在是很好的。这一次，我们将使用字节码来调查在两个列表初始化语句运行期间发生了什么。</p><p id="5ab1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python中有一个内置模块叫做<code class="fe lu lv lw lx b">dis</code>(代表“反汇编器”)，可以将一段Python代码反汇编成字节码。</p><pre class="mq mr ms mt gt mu lx mv mw aw mx bi"><span id="bb13" class="my lz jj lx b gy mz na l nb nc">from dis import dis</span><span id="856d" class="my lz jj lx b gy ne na l nb nc">dis("[]")</span><span id="99ac" class="my lz jj lx b gy ne na l nb nc">dis("list()")</span></pre><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/54a1518308e59c36f4b64d834d3a108d.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*I1r6xbrQgbwOoRHN5GoGSw.png"/></div></figure><p id="f15e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到两种方法的字节码完全不同。那一定是性能不同的原因。</p><p id="a7de" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们使用<code class="fe lu lv lw lx b">[]</code>时，字节码显示只有两个步骤。</p><ol class=""><li id="27f8" class="ni nj jj la b lb lc le lf lh nk ll nl lp nm lt nn no np nq bi translated"><code class="fe lu lv lw lx b">BUILD_LIST</code> —相当自圆其说，只是建立一个Python列表</li><li id="56b4" class="ni nj jj la b lb nr le ns lh nt ll nu lp nv lt nn no np nq bi translated"><code class="fe lu lv lw lx b">RETURN_VALUE</code> —返回值</li></ol><p id="f081" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很简单吧？当Python解释器看到表达式<code class="fe lu lv lw lx b">[]</code>时，它就知道需要建立一个列表。所以，这很简单。</p><p id="fb76" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">list()</code>怎么样？</p><ol class=""><li id="9c02" class="ni nj jj la b lb lc le lf lh nk ll nl lp nm lt nn no np nq bi translated"><code class="fe lu lv lw lx b">LOAD_NAME</code> —试着找到对象“列表”</li><li id="b337" class="ni nj jj la b lb nr le ns lh nt ll nu lp nv lt nn no np nq bi translated"><code class="fe lu lv lw lx b">CALL_FUNCTION</code> —调用“list”函数构建Python列表</li><li id="9ebb" class="ni nj jj la b lb nr le ns lh nt ll nu lp nv lt nn no np nq bi translated"><code class="fe lu lv lw lx b">RETURN_VALUE</code> —返回值</li></ol><p id="31cb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每次我们使用有名字的东西时，Python解释器都会在现有变量中搜索名字。顺序是局部作用域-&gt;封闭作用域-&gt;全局作用域-&gt;内置作用域(本文我就不展开这个话题了。请让我知道你是否对此感兴趣。我会再写一篇关于它的文章)。</p><p id="ee96" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这一搜索肯定需要一些时间。有没有尝试过使用一些没有定义的变量或者函数？例如，如果我们有一个变量名或函数名的输入错误，就会抛出如下的<code class="fe lu lv lw lx b">NameError</code>。</p><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/64b3645782224fe3044b6e432c21adfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*7cVB4obiEzyHsS_A6KvumA.png"/></div></figure><p id="0c9a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是Python解释器试图在所有作用域中查找名称，但没有找到任何匹配的情况。</p><p id="68e9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">list</code>在内置范围内，以便解释器可以明确地找到它。然后，解释器意识到我们在它后面放了一对括号<code class="fe lu lv lw lx b">()</code>，所以它是一个应该被调用的函数。</p><p id="9e44" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，列表将被构建并返回。</p><h1 id="5d09" class="ly lz jj bd ma mb mc md me mf mg mh mi kp mj kq mk ks ml kt mm kv mn kw mo mp bi translated">关于文字常数的讨论</h1><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/a3ff1e5ad9d684e47dd233830b164500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNw3b_mXkGGUbkXPJ4wBnA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来自<a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=971774" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae jg" href="https://pixabay.com/users/steenml-856823/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=971774" rel="noopener ugc nofollow" target="_blank">Steen ml ler laur sen</a>的图片</p></figure><p id="1f74" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好吧，我们知道<code class="fe lu lv lw lx b">list()</code>需要额外的步骤来搜索和调用函数名，但是为什么解释器知道<code class="fe lu lv lw lx b">[]</code>应该做什么呢？</p><p id="2931" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">键被称为“文字常量”或“文字值”。</p><p id="a266" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最常见的文字常量是数字和字符串，比如<code class="fe lu lv lw lx b">23</code>和<code class="fe lu lv lw lx b">'hello'</code>。当我们写这样的表达式时，解释器知道它们是文字值。因此，它们不需要匹配任何变量范围内的任何内容。</p><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1d035692b70b7f7ceacf4742f881646a.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*OXmks-357P6QW7ukBJ-_zg.png"/></div></figure><p id="cc66" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">表达式<code class="fe lu lv lw lx b">[]</code>和<code class="fe lu lv lw lx b">{}</code>在Python中也是文字值。</p><h1 id="95da" class="ly lz jj bd ma mb mc md me mf mg mh mi kp mj kq mk ks ml kt mm kv mn kw mo mp bi translated">摘要</h1><figure class="mq mr ms mt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f2b13f4e9f40fd434ed5b463d68996bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHGf4KHbIzw_nIYKGNHDQQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片来自<a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=586185" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae jg" href="https://pixabay.com/users/ryanmcguire-123690/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=586185" rel="noopener ugc nofollow" target="_blank"> Ryan McGuire </a></p></figure><p id="dd18" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我展示了使用<code class="fe lu lv lw lx b">[]</code>和<code class="fe lu lv lw lx b">list()</code>初始化Python列表是完全不同的，无论是在性能方面还是在幕后的实际步骤方面。</p><p id="cb49" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">研究这样一个无关紧要的问题，这大概是在白费力气。然而，吹毛求疵有时能使我们发现更多的知识，这些知识可能在其他方面有所帮助。</p><div class="is it gp gr iu ny"><a href="https://medium.com/@qiuyujx/membership" rel="noopener follow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd jk gy z fp od fr fs oe fu fw ji bi translated">阅读克里斯托弗·陶的每一个故事(以及媒体上成千上万的其他作家)</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">medium.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ja ny"/></div></div></a></div><p id="cdf6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你觉得我的文章有帮助，请考虑加入Medium会员来支持我和成千上万的其他作者！(点击以上链接)</p></div></div>    
</body>
</html>