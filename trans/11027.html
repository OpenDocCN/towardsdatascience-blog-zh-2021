<html>
<head>
<title>Preserving Geodesic Distance for Non-Linear Datasets: ISOMAP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保持非线性数据集的测地线距离:ISOMAP</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/preserving-geodesic-distance-for-non-linear-datasets-isomap-d24a1a1908b2?source=collection_archive---------15-----------------------#2021-10-27">https://towardsdatascience.com/preserving-geodesic-distance-for-non-linear-datasets-isomap-d24a1a1908b2?source=collection_archive---------15-----------------------#2021-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1bd6" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/thoughts-and-theory" rel="noopener" target="_blank">思想和理论</a></h2><div class=""/><div class=""><h2 id="fcf7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">等距特征映射的解释和说明</h2></div><p id="5831" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">降维方法可视化数据集并减小其大小，以及揭示数据集中的不同特征。对于非线性数据集，可以在各种子标题下检查降维，例如距离保持(<em class="ln">等映射</em>)、拓扑保持(<em class="ln">局部线性嵌入</em>)。本文解释了等距特征映射的理论部分，这是一种距离保持的非线性降维方法，并包括降维后获得的数据集的解释和使用范围。python 实现丰富了研究。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/eea1c97f707a9e3ac81b45bfaf1bd48b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DWgGURhp9fwRY9WH"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">照片由<a class="ae me" href="https://unsplash.com/@dariusbashar?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">大流士巴沙尔</a>在<a class="ae me" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><pre class="lp lq lr ls gt mf mg mh mi aw mj bi"><span id="880b" class="mk ml it mg b gy mm mn l mo mp"><strong class="mg jd"><em class="ln">Table of Contents<br/></em>1. Isometric Feature Mapping (ISOMAP)<br/>-  Geodesic Distance vs Euclidean Distance<br/>-  Interpretation of the result of ISOMAP<br/>2. ISOMAP Algorithm<br/>3. Use Cases<br/>4. Python Tutorials<br/>5. References</strong></span></pre><h1 id="2aa9" class="mq ml it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">1.等距特征映射(ISOMAP)</h1><p id="b4a6" class="pw-post-body-paragraph kr ks it kt b ku nh kd kw kx ni kg kz la nj lc ld le nk lg lh li nl lk ll lm im bi translated">Isomap 是一种非线性降维方法，是度量 MDS 的不同版本，在保持<strong class="kt jd">测地线距离</strong>的同时降维。公制 MDS 和 ISOMAP 最明显的区别:<em class="ln">欧氏距离在公制 MDS 中保持不变，而测地线距离在 ISOMAP 中保持不变</em>。<strong class="kt jd">那么，我们为什么需要它呢？保留测地线距离是否更有效？</strong>让我们看看图 1，比较测地线距离和欧几里德距离作为降维技术。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/5f0610c14898100f1706684c96bfe23d.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*bj09sJIehzZ0jBYd6HmwMg.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图一。欧几里德距离与测地线距离[1]</p></figure><p id="1bea" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">欧几里德距离通过忽略数据集的形状仅计算距离<strong class="kt jd">，测地线距离通过传递数据集上的最短路径来计算。在这种情况下，我们可以粗略地说，测地线距离和欧几里德距离的区别；虽然<strong class="kt jd">测地线距离考虑了与这些数据</strong>相邻的数据，但在欧几里德距离中，它仅计算最短的线性路径。当然，由于我们的目标是以最小的损失降低数据集的维数，因此根据数据集使用测地距离可以获得更有效的结果。以下代码块显示了 isomap 在 Swiss roll 数据集上的基本实现:</strong></p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="316f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">查看 ISOMAP 和 MDS 结果，可以看到瑞士卷可以通过使用 ISOMAP 展开。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi np"><img src="../Images/66687478da51758efbc1b0d7d26815d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tD7LBMdd-pFDAKCLsGPSvg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图二。通过使用 MDS 和 ISOMAP 展开瑞士的角色，图片由作者提供</p></figure><p id="5f00" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">红色数据点在图 2(右)中显示为 ISOMAP 结果，考虑了它们之间的邻域距离。当计算两点之间的欧几里德距离时，获得最短的距离(直线距离)。在测地距离中，获得经过数据集的最短路径。为了找出这一点，确定 k 的某个值，并且通过邻居将<strong class="kt jd"> k 最近的</strong>彼此连接，并且链继续。在 Sklearn 库中提供的 ISOMAP 中，可以用<code class="fe nq nr ns mg b">n_neighbors=5</code>来设置。默认值为 5。寻找最短路径的另一种方法是以初始数据为中心画一个圆，并通过一条边将每个数据点连接到圆内的所有其他数据点。</p><h2 id="c07c" class="mk ml it bd mr nt nu dn mv nv nw dp mz la nx ny nb le nz oa nd li ob oc nf iz bi translated">测地线距离与欧几里德距离</h2><p id="9d3c" class="pw-post-body-paragraph kr ks it kt b ku nh kd kw kx ni kg kz la nj lc ld le nk lg lh li nl lk ll lm im bi translated">为了总结测地距离和欧氏距离的区别，我们来看看它们的变换形式。图 3 示出了应用欧几里德距离和测地线距离的肿瘤组织的比较。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi od"><img src="../Images/f1ee2063243afa4b3db6135e72b1e5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qiZLzAaggPH0SKqTRPzjMA.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图 3。肿瘤的 CT 扫描(左)，欧几里德距离(中)，测地距离变换(右)，[2]</p></figure><p id="7af9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在图 4 中，相同的程序被应用于受损的大脑区域并进行比较。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9c711761a8c3f507820aa903657dc25b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*KY3p4QHwsWZ1e24cQ7bQyQ.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图 4。欧几里德距离和测地线距离的比较[2]</p></figure><p id="c64c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">从上面的图像中可以看出，在图像数据集中，测地线距离可以比欧几里德距离更有效地进行区分。在图 4 中，测地线距离已经应用于大脑区域图像，但是可以看出，由于图像的结构，测地线距离变换可以非常方便地用于 google earth、street 和 city 数据集。</p><h2 id="0039" class="mk ml it bd mr nt nu dn mv nv nw dp mz la nx ny nb le nz oa nd li ob oc nf iz bi translated">对 ISOMAP 结果的解释</h2><p id="8d12" class="pw-post-body-paragraph kr ks it kt b ku nh kd kw kx ni kg kz la nj lc ld le nk lg lh li nl lk ll lm im bi translated">ISOMAP 应用于合成人脸数据集，结果如图 5 所示。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi of"><img src="../Images/9ade80ce7b1280c9eb496635de1f0c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wf5IiRZU4XTRE4avuhl9fg.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图 5。应用 Isomap 后的合成图像数据集[3]</p></figure><p id="9728" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">当查看图表时，可以看到图表右侧的图像看向右侧，左侧的图像看向左侧，上侧的图像向上看，下侧的图像向下看，因此面部转向光线方向。另一种方法是，当查看此图时，可以很容易地确定拍摄照片的相机的位置。例如，在图表的左侧，摄像机在右侧，在右侧，摄像机在左侧，在顶部，摄像机在底部，在底部，摄像机在顶部。当然，这些方法对于该数据集是可接受的，并且每个数据集被单独解释。简而言之，也是解释 ISOMAP 数据集的一种非常方便的方式。</p><h1 id="1944" class="mq ml it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">2.ISOMAP 算法</h1><ol class=""><li id="a926" class="og oh it kt b ku nh kx ni la oi le oj li ok lm ol om on oo bi translated">如上所述，首先构建加权图-找到每个样本的最近邻居-这通过两种方式完成:</li></ol><ul class=""><li id="14a2" class="og oh it kt b ku kv kx ky la op le oq li or lm os om on oo bi translated">k 个最近邻居</li><li id="b5b6" class="og oh it kt b ku ot kx ou la ov le ow li ox lm os om on oo bi translated">固定半径，定义半径值，并对半径值内的样本进行分组。</li></ul><p id="3dfb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在应用上面的其中一个后，最近邻通过加权边连接。这些权重(在邻居之间)将是欧几里得距离。到目前为止，创建了样本之间的全连接加权图。</p><p id="9c45" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">2.使用 Floyd Warshall 算法或 Dijkstra 算法，使用测地线距离计算全连通加权图中所有样本对的成对距离。</p><p id="6066" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">3.应用多维标度(MDS)来获得低维版本。</p><blockquote class="oy"><p id="6ad8" class="oz pa it bd pb pc pd pe pf pg ph lm dk translated">以下视频解释了如何使用 Floyd- Warshall 算法找到最短路径:</p></blockquote><figure class="pi pj pk pl pm lt"><div class="bz fp l di"><div class="pn no l"/></div></figure><p id="5ca4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">作为算法的一个限制，如果 k-最近邻或固定半径太小，加权图可能会中断而不是完全连通。如果 k 值或固定半径太高，这一次加权图可能太密集；这会导致在流形中选择错误的距离。</p><h1 id="d940" class="mq ml it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">3.用例</h1><p id="cac9" class="pw-post-body-paragraph kr ks it kt b ku nh kd kw kx ni kg kz la nj lc ld le nk lg lh li nl lk ll lm im bi translated">Isomap 可用于医疗领域，使超声和超声心动图图像在消除噪声后更易于解读。流形学习算法被应用于二维超声心动图图像，以发现心脏运动的连续周期的帧之间的关系。[4]在这种方法中，每个图像可以通过 Isomap 算法由重建的二维流形上的一个点来描述，并且相似的点可以根据周期性心跳周期的性质与相似的图像相关联。[4]</p><p id="86ea" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在一项研究中，ISOMAP 用于在视频帧之间插入图像。通过将 ISOMAP 应用于视频中的每一帧，在低维中提取有意义的特征。为了在 2 帧之间插入新图像，从原始数据集中选择图像，这些图像被映射到与这 2 帧相同的区域中。[5]</p><blockquote class="po pp pq"><p id="7a78" class="kr ks ln kt b ku kv kd kw kx ky kg kz pr lb lc ld ps lf lg lh pt lj lk ll lm im bi translated">可以阅读参考资料中引用的文章，以了解有关上述用例的更多信息。</p></blockquote><h1 id="9d3f" class="mq ml it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">4.Python 教程</h1><ul class=""><li id="20a9" class="og oh it kt b ku nh kx ni la oi le oj li ok lm os om on oo bi translated">在下面的代码块中，Isomap 应用于<code class="fe nq nr ns mg b">fetch_lfw_people</code>数据集中的面，结果如图 6 所示。</li></ul><p id="082c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">数据集许可:<a class="ae me" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.fetch_lfw_people.html" rel="noopener ugc nofollow" target="_blank"> BSD-3 条款许可</a></p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="54d5" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">与上面的合成数据集示例一样，人脸根据光线进行分类。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/2eade216bbb55bd988960ab660352932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*hLl0AZ2_CalEVjr3WQeYEQ.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图 6。ISOMAP 后的影像数据集，按作者分类的影像</p></figure><ul class=""><li id="55e8" class="og oh it kt b ku kv kx ky la op le oq li or lm os om on oo bi translated">在下面的代码块中，Isomap 已经被应用于<code class="fe nq nr ns mg b">MNIST </code>数据集中的数字 9，结果如图 7 所示。</li></ul><p id="66f4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">数据集许可:<a class="ae me" href="https://scikit-learn.org/stable/auto_examples/linear_model/plot_sparse_logistic_regression_mnist.html#sphx-glr-download-auto-examples-linear-model-plot-sparse-logistic-regression-mnist-py" rel="noopener ugc nofollow" target="_blank"> BSD-3 条款许可</a></p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="a5c0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">可以看到，图表左侧数字 9 的尾部向右倾斜，当您在图表中向右移动时，数字 9 的尾部从右向左移动。同样，虽然尾巴在顶部很短，但从顶部到底部会变长。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi pv"><img src="../Images/46224dbef4df30ebe63baeb0fad43949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yiAWb46T6IN4vlxJrYt3mQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图 7。应用 ISOMAP 后数字 9 的定位，图片作者</p></figure><div class="pw px gp gr py pz"><a href="https://ibrahimkovan.medium.com/machine-learning-guideline-959da5c6f73d" rel="noopener follow" target="_blank"><div class="qa ab fo"><div class="qb ab qc cl cj qd"><h2 class="bd jd gy z fp qe fr fs qf fu fw jc bi translated">机器学习指南</h2><div class="qg l"><h3 class="bd b gy z fp qe fr fs qf fu fw dk translated">所有与机器学习相关的文章</h3></div><div class="qh l"><p class="bd b dl z fp qe fr fs qf fu fw dk translated">ibrahimkovan.medium.com</p></div></div><div class="qi l"><div class="qj l qk ql qm qi qn ly pz"/></div></div></a></div><h1 id="4d0d" class="mq ml it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">5.参考</h1><p id="3279" class="pw-post-body-paragraph kr ks it kt b ku nh kd kw kx ni kg kz la nj lc ld le nk lg lh li nl lk ll lm im bi translated">[1] M. Jordan 和 J. Kleinberg，<em class="ln">非线性降维</em>。2007.</p><p id="76cb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">[2]“kimvwijnen/Geodesic _ Distance _ Transform:(测地线)距离变换遵循 Toivanen 等人(1996 年)。”https://github.com/kimvwijnen/geodesic_distance_transform<a class="ae me" href="https://github.com/kimvwijnen/geodesic_distance_transform" rel="noopener ugc nofollow" target="_blank">(2021 年 10 月 25 日访问)。</a></p><p id="0848" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">[3]“非线性降维的全局几何框架|请求 PDF。”<a class="ae me" href="https://www.researchgate.net/publication/285599593_A_Global_Geometric_Framework_for_Nonlinear_Dimensionality_Reduction" rel="noopener ugc nofollow" target="_blank">https://www . researchgate . net/publication/285599593 _ A _ Global _ Geometric _ Framework _ for _ Nonlinear _ Dimensionality _ Reduction</a>(2021 年 10 月 25 日访问)。</p><p id="f712" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">[4] P. Gifani，H. Behnam，A. Shalbaf 和 Z. A. Sani，“使用 Isomap 算法降低超声心动图图像的噪声”，<em class="ln"> 2011 年第一届中东会议。生物医学。英语。MECBME 2011 </em>，第 150–153 页，2011，doi:10.1109/mec BME . 2003032005</p><p id="6f54" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">[5] S. ROBASZKIEWICZ 和 S. EL GHAZZAL，“使用非线性降维在视频帧之间内插图像”，第 x 期，第 5 页，[在线]。可用:<a class="ae me" href="http://cs229.stanford.edu/proj2012/ElGhazzalRobaszkiewicz-InterpolatingImagesBetweenVideoFramesUsingNonLinearDimensionalityReduction.pdf." rel="noopener ugc nofollow" target="_blank">http://cs 229 . Stanford . edu/proj 2012/ElGhazzalRobaszkiewicz-interpolatingimagesbetweendideoframesusinglinearityreduction . pdf .</a></p></div></div>    
</body>
</html>