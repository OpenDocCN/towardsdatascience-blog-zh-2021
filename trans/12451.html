<html>
<head>
<title>3 Ways To Write Python Lists To A Snowflake Table</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将 Python 列表写入雪花表的 3 种方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-ways-to-write-python-lists-to-a-snowflake-table-802318e56c64?source=collection_archive---------15-----------------------#2021-12-20">https://towardsdatascience.com/3-ways-to-write-python-lists-to-a-snowflake-table-802318e56c64?source=collection_archive---------15-----------------------#2021-12-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="38f7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何存储可以用 SQL 查询的大量数据，从 Python 嵌套列表到雪花数据库</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c624eacb646664f1ba2ce5d0f9d64d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QbsRLQNrKgVHYF6g8ws2dA.jpeg"/></div></div></figure><h2 id="eae1" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">建议的点播课程:</h2><p id="e5a7" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated"><em class="mj">你是想通过成为</em> <strong class="ls iu"> <em class="mj">数据工程师</em> </strong> <em class="mj">还是</em> <strong class="ls iu"> <em class="mj">机器学习工程师</em> </strong> <em class="mj">来推进自己的职业生涯吗？我强烈建议您查看以下课程:</em></p><ul class=""><li id="17a4" class="mk ml it ls b lt mm lw mn ld mo lh mp ll mq mi mr ms mt mu bi translated"><a class="ae mv" href="https://imp.i115008.net/jWWEGv" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu"> Python 数据工程纳米学位</strong> </a> <strong class="ls iu"> → </strong> <em class="mj">精品课程！</em></li><li id="d1d8" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated"><a class="ae mv" href="https://click.linksynergy.com/deeplink?id=533LxfDBSaM&amp;mid=39197&amp;murl=https%3A%2F%2Fwww.udemy.com%2Fcourse%2Fleetcode-in-python-50-algorithms-coding-interview-questions%2F" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu"><em class="mj">leet code In Python:50 算法编码面试问题</em></strong></a><strong class="ls iu"><em class="mj"/></strong><em class="mj">→最适合涉及算法的编码回合！</em></li><li id="5632" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated"><a class="ae mv" href="https://platform.stratascratch.com/coding?via=antonello" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu"> <em class="mj"> Python 高级编码问题(StrataScratch)</em></strong></a><strong class="ls iu"><em class="mj">→</em></strong><em class="mj">我找到的准备 Python 的最佳平台&amp; SQL 编码面试到此为止！比 LeetCode 更好更便宜。</em></li><li id="5dc3" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated"><a class="ae mv" href="https://datacamp.pxf.io/DV3mMd" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">用 Python 练习编码面试题(60+题)</strong> </a> <strong class="ls iu"> → </strong> <em class="mj">列表、数组、集合、字典、map()、filter()、reduce()、iterable 对象。</em></li></ul></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="5089" class="ni kv it bd kw nj nk nl kz nm nn no lc jz np ka lg kc nq kd lk kf nr kg lo ns bi translated"><strong class="ak">简介</strong></h1><p id="f0cf" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在构建数据管道时，您可能最终会在 Python 列表中存储大量数据。</p><p id="b221" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">通常，该对象采用列表的列表的形式，其中每个嵌套列表可以表示数据库表中的一行，并且属于它的每个元素可以被分配给特定的列:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="62c1" class="ku kv it nx b gy ob oc l od oe"><strong class="nx iu">lst</strong> = [[x1, y1, z1], [x2, y2, z2], [x3, y3, z3],...,[xn, yn, zn]]</span></pre><p id="ed1b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">尽管 Python 列表不是存储数据的最有效方式，但使用它们来保存中间输出还是很方便的。</p><p id="1837" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">例如，假设您的管道是以这样一种方式编写的，它利用 Python 算法来操作和丰富数据(<em class="mj">，这种逻辑在 SQL </em>中不容易复制)，并且算法的输出最终被附加到一个列表中。</p><p id="db80" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">但是，在某些时候，您可能需要将该列表的内容存储在数据库中。这通常发生在以下情况:</p><ul class=""><li id="6139" class="mk ml it ls b lt mm lw mn ld mo lh mp ll mq mi mr ms mt mu bi translated">数据不需要进一步处理。可以提供给分析师进行报告。</li><li id="c6a3" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated"><strong class="ls iu">数据确实需要额外处理</strong>。然而，使用 Python 列表不再是一种选择，因此您决定将中间结果保存在一个辅助表中。</li></ul><p id="fe1b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">根据您正在使用的数据库，可以应用多种策略。然而，在本教程中，我将向您展示使用将 Python 列表写入雪花数据库的<strong class="ls iu"> 3 种方法:</strong></p><ul class=""><li id="13dc" class="mk ml it ls b lt mm lw mn ld mo lh mp ll mq mi mr ms mt mu bi translated"><code class="fe of og oh nx b">snowflake.connector</code>自行打包；</li><li id="c05a" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated"><code class="fe of og oh nx b">snowflake.connector</code>和<code class="fe of og oh nx b">pandas</code>套餐的组合；</li><li id="3418" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated"><code class="fe of og oh nx b">snowflake.sqlAlchemy</code>和<code class="fe of og oh nx b">pandas</code>套餐的组合。</li></ul><p id="bd82" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">在开始编写代码之前，让我们简要描述一下您在日常工作中可能会遇到的一个实际用例。</p><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/3-nanodegrees-you-should-consider-to-advance-your-data-engineering-career-in-2021-baf597debc72"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">3 门数据工程课程，在 2022 年推进您的职业发展</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">加入数据行业，改变角色或通过注册数据工程简单地学习前沿技术…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ks ol"/></div></div></a></div><h1 id="74a5" class="ni kv it bd kw nj pa nl kz nm pb no lc jz pc ka lg kc pd kd lk kf pe kg lo ns bi translated">插入、更新或删除数据</h1><p id="7f45" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在现实世界中，向目标表中插入新记录是不够的。同时，数据工程师通常还需要更新(<em class="mj">或删除</em>)其中已经存在的记录。</p><blockquote class="pf"><p id="09b6" class="pg ph it bd pi pj pk pl pm pn po mi dk translated">在现实世界中，向目标表中插入新记录是不够的。同时，数据工程师通常还需要更新(<em class="pp">或删除</em>)已经存在的记录。</p></blockquote><p id="c9f8" class="pw-post-body-paragraph lq lr it ls b lt pq ju lv lw pr jx ly ld ps ma mb lh pt md me ll pu mg mh mi im bi translated">在雪花中，这可以通过使用<code class="fe of og oh nx b">MERGE INTO</code>语句来实现，引用<a class="ae mv" href="https://docs.snowflake.com/en/sql-reference/sql/merge.html" rel="noopener ugc nofollow" target="_blank">文档</a> " <em class="mj">根据第二个表(源)或子查询</em>中的值插入、更新和删除表中的值，其语法如下:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="5b18" class="ku kv it nx b gy ob oc l od oe">MERGE INTO <em class="mj">&lt;target_table&gt;</em> USING <em class="mj">&lt;source&gt;</em> ON <em class="mj">&lt;join_expr&gt;</em> { <strong class="nx iu">matchedClause</strong> | <strong class="nx iu">notMatchedClause</strong> }</span></pre><p id="6a35" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">令人烦恼的是，为了决定在<code class="fe of og oh nx b">&lt;target_table&gt;</code>中插入哪些记录，更新(或删除)哪些记录，<code class="fe of og oh nx b">MERGE INTO</code>语句要求<code class="fe of og oh nx b">&lt;source&gt;</code>(读作:<em class="mj">您希望插入、更新或删除到目标表</em>中的新 <em class="mj">记录)作为标准表严格可检索，或者作为子查询进行查询。</em></p><p id="6350" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">反过来，这也就意味着，截至目前，雪花<strong class="ls iu">并不支持一个 Python 列表作为<code class="fe of og oh nx b">USING</code>语句下的</strong> <code class="fe of og oh nx b"><strong class="ls iu">&lt;source&gt;</strong></code>。</p><p id="b5b8" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">这正是数据需要额外处理，但使用 Python 列表不再可能的情况:嵌套的对象需要转换成其他格式并写入数据库表，然后后者才能用作合并的源。</p><p id="77b1" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">下面描述了需要发生的事情的流程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pv"><img src="../Images/11b8e9ffcefd9a9b0d7207734e9796dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RuZauMKp2Gj4tU6wkienig.png"/></div></div><p class="pw px gj gh gi py pz bd b be z dk translated">作者在 Lucidchart 上创建的流</p></figure><p id="ec60" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">这又把我们带回了最初的问题:<strong class="ls iu">如何把 Python 列表写到雪花表？</strong>要回答这个问题，我们先创建一个模拟数据集。</p><h1 id="9bb7" class="ni kv it bd kw nj pa nl kz nm pb no lc jz pc ka lg kc pd kd lk kf pe kg lo ns bi translated">创建模拟 Python 列表</h1><p id="84ad" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">下面我所做的是创建一个<code class="fe of og oh nx b">data_to_insert</code>列表，它本身包含五个子列表，其中存储了关于模拟金融交易的数据。</p><p id="98e0" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">这个列表表示 ETL 管道的输出，它必须被写入雪花中的目标表。为了实现这一点，首先需要将该列表插入到一个辅助表中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="qa qb l"/></div></figure><p id="a0a4" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">然后我把这个列表转换成一个<code class="fe of og oh nx b">df_to_insert</code>熊猫数据框架，很快就会用到。正如所料，数据帧具有形状(5，5):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qc"><img src="../Images/1f802d27c5d877a16d4368fc65d951e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FzuFlT5zOJn1m0W1zPTngg.png"/></div></div></figure><p id="501c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">使用与 DataFrame 相同的列定义，我最终在 SnowFlake 中创建了一个空的辅助(<code class="fe of og oh nx b">source_t</code>)表，现在可以存放数据了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="qa qb l"/></div></figure><p id="6def" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">让我们看看如何通过 Python 连接到 SnowFlake 来填充它，以便通过游标对象执行 SQL 查询。</p><h1 id="997e" class="ni kv it bd kw nj pa nl kz nm pb no lc jz pc ka lg kc pd kd lk kf pe kg lo ns bi translated">如何给雪花写一个 Python 列表</h1><h2 id="d7cd" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">方法#1 | SF 连接器+ ExecuteMany()</h2><p id="f10a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">将 Python 列表批量插入雪花表的第一种方法是通过<code class="fe of og oh nx b">snowflake.connector</code>包连接到雪花。</p><p id="2e09" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">一旦建立了连接(通过<code class="fe of og oh nx b">external browser</code>认证或者通过<code class="fe of og oh nx b">user + password</code>的组合)，您可以简单地将<code class="fe of og oh nx b">INSERT</code>语句传递给<code class="fe of og oh nx b">executemany()</code>方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="qa qb l"/></div></figure><p id="6082" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">现在，可以使用 SQL 检索最初存储在列表中的数据:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="02e2" class="ku kv it nx b gy ob oc l od oe">SELECT * FROM SCHEMA.SOURCE_T </span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/537c1e272bddfd998026ddbaa58b5e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C7-UfVQZe3Xh_0IeVrKVOw.png"/></div></div><p class="pw px gj gh gi py pz bd b be z dk translated">通过以下方式获得的输出</p></figure><p id="f9e6" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated"><strong class="ls iu">优点:</strong><code class="fe of og oh nx b">executemany()</code>方法非常简单，因为它只需要一个<code class="fe of og oh nx b">INSERT</code>语句，不需要将列表转换成另一种格式。</p><p id="fa32" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated"><strong class="ls iu"> CONS: </strong>为了使这种方法成功，列表中的<a class="ae mv" href="https://stackoverflow.com/questions/62541089/snowflake-connector-sql-compilation-error-maximum-number-of-expressions-in-a-li" rel="noopener ugc nofollow" target="_blank"> <em class="mj">最大表达式数必须是</em> <strong class="ls iu"> <em class="mj"> &lt; 16，385 </em> </strong> </a>，这意味着如果您正在处理较大的批处理，这不是一个可以考虑的选项。</p><p id="900f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">此外，对于您希望插入的每一列，您需要添加一个<code class="fe of og oh nx b">%s</code>作为<code class="fe of og oh nx b">VALUES()</code>语句的一部分，这使得键入操作有点重复，代码也不够优雅。</p><h2 id="89aa" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">方法#2 | Pandas + SF 连接器+ WritePandas()</h2><p id="c546" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">如果您正在处理大批量，我建议您:</p><ul class=""><li id="79fc" class="mk ml it ls b lt mm lw mn ld mo lh mp ll mq mi mr ms mt mu bi translated">通过<code class="fe of og oh nx b">snowflake.connector</code>包连接雪花(和上面描述的一模一样)；</li><li id="b0b7" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated">将 Python 列表转换成 pandas DataFrame(之前获得<code class="fe of og oh nx b">df_to_insert</code>时也是这样做的)；</li><li id="7e8e" class="mk ml it ls b lt mw lw mx ld my lh mz ll na mi mr ms mt mu bi translated">使用<code class="fe of og oh nx b">write_pandas()</code>功能将<code class="fe of og oh nx b">df_to_insert</code>写入表格:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="qa qb l"/></div></figure><p id="395d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated"><strong class="ls iu">优点:</strong><code class="fe of og oh nx b">write_pandas()</code><a class="ae mv" href="https://docs.snowflake.com/en/user-guide/python-connector-api.html#write_pandas" rel="noopener ugc nofollow" target="_blank">在幕后高效地将数据保存在 Parquet 文件</a>中，然后使用<code class="fe of og oh nx b">PUT</code>命令将这些文件上传到临时阶段，最后运行<code class="fe of og oh nx b">COPY INTO &lt;table&gt;</code>命令将数据从文件复制到表中</p><p id="c159" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated"><strong class="ls iu"> CONS: </strong>从内存的角度来看，将 Python 列表转换成 DataFrame 可能很麻烦。此外，<code class="fe of og oh nx b">write_pandas()</code>不允许您指定当数据已经出现在表中时要做什么。这意味着，如果您希望每次运行时清空<code class="fe of og oh nx b">source_t</code>，您将需要运行单独的<code class="fe of og oh nx b">TRUNCATE TABLE</code>命令。</p><h2 id="31e6" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">方法#3 | Pandas + SQLAlchemy + To_SQL()</h2><p id="a2fe" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">当您可以自由选择建立与雪花连接的包时，我强烈建议您使用<code class="fe of og oh nx b">sqlalchemy</code>和<code class="fe of og oh nx b">snowflake.sqlalchemy</code>的组合来创建一个<code class="fe of og oh nx b">engine</code>对象。</p><p id="352b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">创建<code class="fe of og oh nx b">engine</code>的好处在于，这是唯一一种在传递给<code class="fe of og oh nx b">to_sql()</code> pandas 方法时工作良好的连接对象(然而，如果您试图传递用方法#1 和#2 创建的<code class="fe of og oh nx b">db_conn_sf</code>连接对象，它将抛出一个错误)。</p><p id="1a56" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">要将<code class="fe of og oh nx b">df_to_insert</code>写入雪花表格，您可以使用类似于下面的脚本，在我看来这是一个很好的解决方案:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="qa qb l"/></div></figure><p id="c4d2" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated"><strong class="ls iu">优点:</strong>当数据已经出现在<code class="fe of og oh nx b">source_t</code>表中时，<code class="fe of og oh nx b">to_sql()</code>方法比<code class="fe of og oh nx b">write_pandas()</code>方法更先进。例如，在这种情况下，我将<code class="fe of og oh nx b">if_exists</code>参数设置为等于<code class="fe of og oh nx b">'replace’</code>，这样我就不需要单独的命令来截断表。</p><p id="2eba" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated"><strong class="ls iu"> CONS: </strong>另一方面，<strong class="ls iu"> </strong>方法背后的算法在转换和存储记录时不如<code class="fe of og oh nx b">write_pandas()</code>函数高效。在插入到<code class="fe of og oh nx b">source_t</code>表之前，数据没有被压缩和保存到 Parquet 文件中，这意味着并行性不能被应用，并且在处理大批量数据时对内存的影响可能是相关的。</p><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/how-to-connect-to-a-postgresql-database-with-python-using-ssh-tunnelling-d803282f71e7"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">如何使用 SSH 隧道通过 Python 连接到 PostgreSQL 数据库</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">了解当需要 SSH 加密时，如何使用 Psycopg2 或 SQLAlchemy 查询 PostgreSQL 数据库</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="qe l ow ox oy ou oz ks ol"/></div></div></a></div><h1 id="cc39" class="ni kv it bd kw nj pa nl kz nm pb no lc jz pc ka lg kc pd kd lk kf pe kg lo ns bi translated">结论</h1><p id="0960" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在本教程中，我已经和你分享了三种可以用来将 Python 列表写入雪花表的方法。现在数据在<code class="fe of og oh nx b">source_t</code>中可用，我可以通过运行类似于<a class="ae mv" href="https://gist.github.com/anbento0490/2e1f6126294a7f01cad14e36b1329ccb" rel="noopener ugc nofollow" target="_blank"> this </a>的<code class="fe of og oh nx b">MERGE INTO</code>查询来完成我的管道上的工作。您可以使用它作为模板来处理您的项目。</p><p id="7b3d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated">但是我也想从你那里了解更多:你曾经面临过这样的问题吗？和..有没有用过其他方法把 Python 列表转换成雪花表？请随意发表评论😁</p><p id="6f5f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly ld nt ma mb lh nu md me ll nv mg mh mi im bi translated"><strong class="ls iu"> <em class="mj">给我的读者一个提示:</em> </strong> <em class="mj">这篇文章包括附属链接，如果你购买的话，我可以从中赚取一小笔佣金，不需要额外的费用。</em></p></div></div>    
</body>
</html>