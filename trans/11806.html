<html>
<head>
<title>A Gentle Intro to Conjugate Priors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">共轭先验的温和介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-gentle-intro-to-conjugate-priors-8be6ac0d31f6?source=collection_archive---------21-----------------------#2021-11-24">https://towardsdatascience.com/a-gentle-intro-to-conjugate-priors-8be6ac0d31f6?source=collection_archive---------21-----------------------#2021-11-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4360" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为了更快更简单的贝叶斯推理</h2></div><p id="d0f2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">共轭先验可以使贝叶斯推理更快更直接。让我们看一看贝叶斯法则，来理解我们的意思。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/b819434933ac3d8a365c877e9dd69b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*szv6Z9H6vZYZ2PdXDpRCPw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">贝叶斯法则:后验概率与似然概率和先验概率成正比。图片作者。</p></figure><p id="1cb9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们进行贝叶斯推断时，我们通常试图识别参数的<strong class="kk iu">后验</strong>(我们在看到数据后对真实模型参数的信念)。就像任何类型的建模一样(回归、深度学习等。)我们要学习参数。这里我们将它们量化为分布而不是点估计。</p><p id="3d42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">P( <em class="lu"> θ </em>)是我们对参数的先验信念，是我们在推断之前必须赋予的东西。P(Y| <em class="lu"> θ </em>是给定参数下我们数据的<strong class="kk iu">似然</strong>。出于这些目的，我们可以忽略 P(Y ),因为它对θ的所有值都是一样的。</p><p id="b314" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lu">注:要了解更多关于贝叶斯推理的直觉背景，请随意参考我以前的</em> <a class="ae lv" rel="noopener" target="_blank" href="/from-bayes-theorem-to-bayesian-inference-b261124633a6"> <em class="lu">文章</em> </a> <em class="lu">。</em></p><h2 id="aa88" class="lw lx it bd ly lz ma dn mb mc md dp me kr mf mg mh kv mi mj mk kz ml mm mn mo bi translated">可能性</h2><p id="4831" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">可能性是我们关注的第一个术语。它的形式取决于我们选择使用什么样的模型。例如，在线性回归模型中，我们假设数据围绕回归线呈正态分布。因此，每个数据点的可能性对应于具有平均 X^T B(即回归线上的点)和方差σ(误差方差)的正态 PDF(概率密度函数)。</p><p id="ef74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不过，线性回归不是本文的重点。我们将使用一个更简单的(单参数)模型，二项式似然模型。</p><p id="a4d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">二项式分布模拟了一系列的伯努利试验。伯努利试验是一种<em class="lu">单次</em>随机二元试验(如抛硬币)，结果 1 的概率为<em class="lu"> θ </em>，结果 0 的概率为(1- <em class="lu"> θ </em>)。二项式分布对所有 n 次试验的结果总和(即抛硬币的头数)进行建模。</p><p id="4d82" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">伯努利试验的可能性对于值 1 是简单的<em class="lu"> θ </em>，对于值 0 是(1- <em class="lu"> θ </em>)。对于 0.7 的<em class="lu"> θ </em>值，伯努利试验可能性如下所示:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mu"><img src="../Images/913342b7243e5b0eea8e878e2476bae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QrQTtlcl-swBdJLSzyM7yQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="939f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者作为一个等式:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/1fcc0a3e9bcb4dc99b7c3fe5976130d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*vXsLOEZhM5eJBZcX_OhA8A.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="fcfb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于 Y=0 和 Y=1 的值。</p><p id="cc3e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用概率<em class="lu"> θ </em>对<em class="lu"> n </em>次伯努利试验的总和进行建模的二项式似然性具有类似的似然函数。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/4520ad59b63d7c068fc9bf2a4ed525f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*YxI6Mfk1269yVApXQQp6Ug.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="5922" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中这个时间<em class="lu"> y </em>是“成功”的总次数，或者结果= 1 的次数，其中<em class="lu"> </em>的可能值在 0 和<em class="lu"> n </em>之间。</p><p id="64a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们用一个例子来更具体地说明这一点。</p><p id="d299" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有一种降压药，它有偏头痛的副作用，我们想弄清楚当你服用这种药时，头痛的概率是多少。假设我们正在研究 30 名患者。“数据”或患头痛的患者总数的可能性是:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/d57a2dd6b0af8960992eec90cbaf5564.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*9xfMU_dTivUBUQPlQ-Ekog.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="ead8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于<em class="lu"> θ </em> = 0.1(或副作用概率为 10%)，可能性看起来像这样:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi my"><img src="../Images/5fec6b73d5ebe645ad7924388b9f2a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*IECGOG9Zp7id1_RisVy6Tw.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mz"><img src="../Images/b4d6869d7fdd8c1cb34fcbefb2c7d84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XC73k5S2R1hJLBhz-sXyrA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">一系列<em class="na"> n=30 次伯努利试验的二项式可能性(y 成功的可能性)，其中</em> θ = 0.1。(图片由作者提供)</p></figure><p id="88d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如所料，在给定<em class="lu"> θ </em> = 0.1 的情况下，最有可能的情况是，我们的患者群体中有 10% ( <em class="lu"> y </em> =3)出现了副作用。</p><h2 id="e8dc" class="lw lx it bd ly lz ma dn mb mc md dp me kr mf mg mh kv mi mj mk kz ml mm mn mo bi translated">在先的；在前的</h2><p id="21f0" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">现在回到我们问题的贝叶斯部分。请记住，我们试图使用一些数据<em class="lu">来推断副作用发生率<em class="lu"> θ </em>。</em>我们实际上从类似的、已经测试过的药物中获得了一些先验信息，即副作用发生率往往在 15%左右。由于我们使用的数据有限(我们只有 30 个受试者要测试)，我们希望以某种方式将我们的先验知识融入到模型中。</p><p id="e573" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用前面的<strong class="kk iu">项 P( <em class="lu"> θ </em>)来做这件事。P( <em class="lu"> θ </em>)代表我们对副作用发生率<em class="lu"> θ </em>真实值的信念，所以应该是某个概率分布，可能值在 0 到 1 之间。从技术上讲，P( <em class="lu"> θ </em>)可以是任何一种分布。但是回头看看贝叶斯法则:</strong></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/b6c78e574188e9c076c2ba24996d5675.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*49tWXTe3qu7z8TxaQufXcA.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="1ca0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请记住，对于<em class="lu"> θ </em>的所有可能值，我们将可能性 p(y| <em class="lu"> θ </em> ) <em class="lu"> </em>和先验 P( <em class="lu"> θ </em>)相乘，这样我们就可以得到<em class="lu"> θ | y. </em>的后验置信分布<em class="lu"/></p><p id="c750" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个有点幼稚的方法是，为 P( <em class="lu"> θ </em>)选择一些分布，从这个分布中取一堆样本，将 P( <em class="lu"> θ </em>)的 PDF 乘以每个<em class="lu"> θ </em>样本的 P(y| <em class="lu"> θ </em>)的 PDF，形成我们的后验概率。但是我们可以用更聪明的方法来做，根本不需要任何采样。</p><p id="2a26" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果似然 P(y| <em class="lu"> θ </em>和先验 P( <em class="lu"> θ </em>)可以来自同一个“家族”，或者相对于<em class="lu"> θ </em>有相同的项，那么我们就可以很容易地将两个概率分布相乘。结果是一个与先验类型相同的后验分布。除了更快的推断之外，每当我们获得更多的数据时，我们可以使用这个后验作为先验。</p><p id="dffe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们再次看看药物副作用例子的可能性分布。二项式可能性是</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="ab gu cl nc"><img src="../Images/eac6e43a4e9ab42477a77687f8206641.png" data-original-src="https://miro.medium.com/v2/format:webp/1*BEyznnGSWTZYpC0E4WgV0A.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="480a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的研究中，我们有<em class="lu"> n </em> =30 名患者，所以我们的可能性等式看起来像这样。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/d57a2dd6b0af8960992eec90cbaf5564.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*9xfMU_dTivUBUQPlQ-Ekog.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="7800" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们希望找到一个具有相同项(相对于<em class="lu"> θ </em>)的先验分布，以便我们可以执行一个乘法步骤，而不是任何积分或采样。我们实际上并不关心 30-choose-y 项，因为和 P( <em class="lu"> y </em>)一样，它对所有的<em class="lu"> θ </em>值都是一样的。</p><p id="92b7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们检查了一些可能的分布…并发现 2 参数贝塔分布看起来很像二项式似然！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/ff599a5d8737cb624c6a67996e5db40c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*FfA8tfYbdjfo2NtugsTt6w.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="b72f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Beta PDF 的第一部分中的<a class="ae lv" href="https://en.wikipedia.org/wiki/Gamma_function" rel="noopener ugc nofollow" target="_blank">伽马函数</a>并不是非常重要；同样，我们不必关心它们的推论，因为它们不是<em class="lu"> θ的函数。</em>其他项(<em class="lu"> θ </em>的某次方幂和(1- <em class="lu"> θ </em>)的某次方幂，与我们的可能性相匹配。</p><p id="891e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们知道应该使用带有参数<em class="lu"> a </em>和<em class="lu"> b </em>的 Beta 先验分布进行快速推断。换句话说，我们将需要选择参数<em class="lu"> a </em>和<em class="lu"> b </em>，使贝塔先验分布看起来像我们关于<em class="lu"> θ </em>的先验信念。</p><h2 id="41b6" class="lw lx it bd ly lz ma dn mb mc md dp me kr mf mg mh kv mi mj mk kz ml mm mn mo bi translated">在后面的</h2><p id="c975" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">接下来，当我们将似然性 P(y| <em class="lu"> θ </em>和先验 P( <em class="lu"> θ </em>)相乘时，我们得到一个后验 P( <em class="lu"> θ | y </em>)，它也具有贝塔分布。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ne"><img src="../Images/87f79914a9567e58db99129b6c158590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G2YM3ujs10wlBcGVtvA2Rg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">二项似然模型后验分布的推导。图片作者。</p></figure><p id="d867" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样！对于任何先前的 P( <em class="lu"> θ </em> ) = Beta( <em class="lu"> a </em>，<em class="lu"> b </em>)，我们有关于<em class="lu"> θ </em>的后验置信，以及<em class="lu"> n </em>试验的任何数据，并且<em class="lu"> y </em>总“成功”(结果等于 1，原谅称副作用成功的误称)。</p><p id="6aae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在回到我们的例子，我们之前认为副作用发生率可能在 15%左右，我们可以使用β(a = 3，b=17)，看起来像这样:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mu"><img src="../Images/0c2827abd4faeaffd86ed9cbbc290b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CAtQ-3g_jG56D4NM8a7sWQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated"><em class="na"> θ的先验分布。</em>图片作者。</p></figure><p id="a05c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用 E[P( <em class="lu"> θ </em> )]或均值 0.15。注意:如果我们不太有信心，我们可以选择一个更宽的先验，其均值仍然为 0.15。值得试验一下先验参数，以找到一个准确描述先验置信度的参数。</p><p id="3260" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们给 30 个病人服用这种药物，发现有副作用，我们的后验概率就变成了</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nf"><img src="../Images/cf4666f45044e54105bb197b2a68c25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxDX6Un0TzT-yAJqbd_6cg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">二项式后验概率的例子。作者图片</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mu"><img src="../Images/ab5a1c6f6000bb70153d57f665af569c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dN2ZYuXgNyyn5ACpUotbsw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated"><em class="na"> θ的后验分布。</em>图片作者</p></figure><p id="708f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们从之前的信念(在看到数据之前)到之后的信念(在看到数据之后)的变化如下:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mu"><img src="../Images/7931e7930abeb00ce1f9c80b58cd2c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-sfwVL24dbovB-9QoqzEQg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated"><em class="na"> θ的先验和后验分布。</em>图片作者</p></figure><p id="65ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在对我们关于副作用率的信念更有信心了一点(如更窄的后验曲线所示)，期望值或均值从 0.15 变为 0.12，这可以从已知的<a class="ae lv" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank"> Beta 分布的均值</a> a/(a+b)计算出来。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="7545" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总之，使用共轭先验进行贝叶斯推断的步骤如下:</p><ol class=""><li id="301f" class="nn no it kk b kl km ko kp kr np kv nq kz nr ld ns nt nu nv bi translated">定义您正在使用的模型，以及该模型的可能性</li><li id="f067" class="nn no it kk b kl nw ko nx kr ny kv nz kz oa ld ns nt nu nv bi translated">找到与可能性具有相同形式(相对于<em class="lu"> θ </em>)的先验分布类型</li><li id="0b9d" class="nn no it kk b kl nw ko nx kr ny kv nz kz oa ld ns nt nu nv bi translated">通过将似然性和先验相乘找到后验分布。</li></ol><p id="bae1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用共轭先验的一些好处是速度(不需要 MCMC 采样)，以及由此产生的明确定义的后验，从中可以很容易地获得汇总统计或用作将来接收更多数据时的先验(“贝叶斯更新”)。</p><p id="1f29" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一些示例共轭先验是二项式似然的β先验、泊松似然的γ先验以及正态似然的平均参数的正态先验(具有已知方差)。</p></div></div>    
</body>
</html>