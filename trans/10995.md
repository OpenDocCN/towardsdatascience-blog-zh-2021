# 工具变量法在因果分析中的应用

> 原文：[https://towardsdatascience.com/apply-instrumental-variables-method-in-causal-analysis-9fd55e39da7a?source=collection_archive---------27-----------------------#2021-10-26](https://towardsdatascience.com/apply-instrumental-variables-method-in-causal-analysis-9fd55e39da7a?source=collection_archive---------27-----------------------#2021-10-26)

## 重点放在通过一个例子说明的实验上

![](../Images/927fec3a857a1c1dec97d2923432c4ee.png)

在 [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上由 [Aniket Deole](https://unsplash.com/@anik3t?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 拍摄

# 动机

2021 年诺贝尔经济学奖授予约书亚·d·安格里斯特和吉多·w·因本斯，以表彰他们对因果关系分析的方法论贡献。。如果你想知道“方法论的贡献”具体是什么，并愿意更深入地挖掘科学[背景](https://www.nobelprize.org/prizes/economic-sciences/2021/popular-information/)，你会注意到“工具变量方法”被称为“因果关系研究的新框架”。受到这个令人兴奋的消息的启发，我想写一篇关于工具变量(IV)方法的文章，尽管我想强调 IV 框架非常复杂，不可能在一篇中型文章中涵盖所有内容。利用观察数据回答因果问题是一种非常重要的方法，但在本文中，我们将介绍这种方法在实验中的应用。该应用遵循安格里斯特(2006 年)的论文“实验犯罪学研究中的工具变量方法:什么、为什么和如何”。我用 R 语言做了复制，你可以看看底部的程序。

# 介绍

在我自己研究因果推理的过程中，我注意到主要有两种方法来引入工具变量:1)一种是由内生性问题引起的(维基百科:在计量经济学中，内生性广义上是指解释变量与误差项相关的情况)，2)另一种是与实验中的问题相关的，当时治疗分配是随机的，但治疗提供不是随机的。在这两种情况下，工具变量框架都提供了解决方案。

在本文中，我们不会深入探讨内生性问题，因为它相当复杂，基本上是一个独立的话题。相反，我们将根据安格里斯特(2006)研究明尼阿波利斯家庭暴力实验(MDVE)的论文，重点关注 IV 方法在实验中的应用。

# 实验中的工具变量(四)

假设我们要分析一个随机实验，凭直觉，仪器变量可以理解为一个因果链，其中一个仪器 Z 改变实际提供的治疗 D，反过来影响结果 y，Z 必须与 D 密切相关，并且是随机分配的或“与随机分配一样好”。最后，Z 对 Y 的因果作用只通过 D 实现(是单通道)。更正式地说，我们定义:

*   仪器:Z *i*
*   治疗变量:D *i*
*   结果变量:Y *i*

IV 因果链中的链接基于潜在结果框架中的条件预期。如果你不熟悉潜在结果模型，你可以看看我以前的文章:

[](https://medium.com/geekculture/an-introduction-of-randomized-experiment-aka-a-b-testing-and-potential-outcome-model-f2c93f73d426) [## 随机实验和潜在结果模型

### 深入探究随机化的重要性

medium.com](https://medium.com/geekculture/an-introduction-of-randomized-experiment-aka-a-b-testing-and-potential-outcome-model-f2c93f73d426) 

第一阶段是从仪器 Z *i* 到感兴趣的因果变量(治疗变量 D *i* )的链接:

![](../Images/264c461e81cae532097668b503ab533c.png)

简化形式(也称为意向处理效应)是工具 Z *i* 对结果 Y *i* 的影响:

![](../Images/899cb0e64479d20988d50d888697cae0.png)

称为局部平均治疗效应(晚期)的因果效应由简化形式与第一阶段估计值的比率确定:

![](../Images/0545a5714eb81f5baafc9842b176fcd0.png)

上面的方程是用总体平均值写的。在实践中，我们使用来自我们的实验数据的样本均值来估计那些。我知道在这一点上，你可能对 Z、D 和 Y 的实际含义有点困惑，因果联系是如何工作的。接下来，我们将通过一个真实的实验来应用这些变量和方程，以了解 IV 是如何工作的。

# 应用程序(MDVE)

在家庭暴力受害者救助项目中，参与实验的明尼阿波利斯警察局的巡逻警官被要求在警官有可能有理由相信发生了攻击的情况下，使用三种方法(在回应时随机选择)中的一种来处理家庭暴力电话:

1.  分离:将施虐者送走八小时。
2.  建议:调解纠纷。
3.  逮捕。

随机化是通过一叠报告表进行的，这些报告表对三种可能的反应中的每一种都进行了随机颜色编码。官员们被要求根据便笺簿上表格的颜色采取行动。

## 数据

我从[哈佛数据节](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/FTZ8GN)
下载了数据和 SAS 程序，Joshua D. Angrist，2009，“复制数据:实验犯罪学研究中的工具变量方法:什么、为什么和如何”，[https://doi.org/10.7910/DVN/FTZ8GN](https://doi.org/10.7910/DVN/FTZ8GN)，哈佛数据节，V1

请注意，数据集不包含作为累犯率的结果变量。为了构建它，我运行了提供的 SAS 程序。然后我把数据加载到 R 中，继续进行因果分析。

那么，MDVE 中的 Z 和 D 是什么呢？

我们将 Z 定义为处理的分配，它是每个官员在实验中使用的便笺簿上随机分配的表格颜色。在分析中，我们还将建议分组并分离到同一个称为“溺爱”的桶中。当案例被指定为待处理时，Z=1，否则为 1。

实验中的官员是自愿参与的，因此应该遵守研究设计。然而，不难想象严格遵守随机化协议是不现实的。在实践中，官员们经常偏离在事件发生时根据报告表格的颜色所指定的反应。例如，在某些情况下，当随机分配是离职或建议时，官员决定进行逮捕。在现场实验中，部分和不完全的依从性并不少见。

因此，在每种情况下，我们定义为 D 的实际治疗与指定为 Z 的治疗并不相同。在分析中，我们表示 D =1 时，案件实际上是溺爱，0 时，逮捕了。

下面我复制了表 1，即安格里斯特(2006)论文中 Z 和 D 的列表。它表明，在被指派逮捕的 92 人中，91 人实际上被逮捕(服从)，只有 1 人没有被逮捕。然而，在被指派提供咨询的 108 人中，有 19 人实际上被逮捕(未遵守)。建议治疗的依从率为 78% (84/108)。同样，在被随机分配隔离的 114 名嫌疑人中，26 人被逮捕，5 人被劝告。分离治疗的依从率为 73% (83/114)。简而言之，我们看到几乎每一个被指派逮捕的案件都导致了逮捕，但是许多被指派建议或分开的案件也导致了逮捕，这是 MDVE 中最常见的偏差。

![](../Images/27184d161be047ad509df6999a8a4e40.png)

表 1:指定和提供的治疗

## IV 作为不完全遵守的解决方案

依从性不完善的问题是否会让您认为这个实验是失败的，因为随机分配的治疗实际上并没有进行？幸运的是我们可以用静脉注射的方法来修复它！

**通过因果链应用 IV 方法，从指定的治疗开始，通过实施的治疗，最终到结果变量，我们可以估计晚期，治疗对依从者的平均因果影响**。我们不知道对总是接受者的影响(例如，无论有没有实验，案例都会被娇惯，而与此相反的是，因为我们指定他们被娇惯，所以他们才会被娇惯)。我们无法得知这种仪器对那些治疗状况不受影响的人的影响。

有趣的是，在 MDVE 中，我们有单方面的依从性:随机分配到治疗组的一些人没有接受治疗，而随机分配到对照组的人没有接受治疗(记住，我们在 92 个被分配逮捕的病例中只有 1 个实际上被溺爱)。在 MDVE 中(几乎)没有总是接受者，(几乎)所有被治疗者都是从犯，因此对从犯的平均因果影响也捕捉到了对被治疗者的平均因果影响。

## 使用 2SLS 回归实施 IV

我们通常使用两阶段最小二乘法(2SLS)作为广义 IV 估计量。我不会在这里详细说明为什么 IV 是 2sl，但是如果你感兴趣的话，我建议你深入研究它，这将把内生性问题带回到图片中，你可能会发现它使一切变得更清楚(或者不清楚)。

下面是我用来在 MDVE 中实现 IV 的 R 代码:

在第一次回归中，我根据。提供治疗。由于治疗的非随机性，这是一种误导。在这种方法中，由于负选择偏倚，估计值 0.087 要小得多。下面等式中的第二项是选择偏差。

![](../Images/d2b7fb31aff0cec3be81491210e1ba93.png)

从第一阶段回归来看，系数= 0.786 就是分配到被溺爱时被溺爱的顺从率((84+5+5+83)/(108+114))。

第三个回归估计了意向治疗(IIT)效应，它捕捉了被分配到治疗的因果效应，并考虑到一些被分配的治疗没有被提供的事实。由于不完全依从性引起的治疗错觉，估计值 0.786 小于 IV 估计值。

IV 回归给出了对被溺爱的因果效应的最新估计，不受不顺从的影响，也不受选择偏差的影响。估计效果是 0.145。

在最后一次回归中，我用两个内生变量和两个工具变量实现了 IV/2SLS。