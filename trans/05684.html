<html>
<head>
<title>How to insert a Python graph into an HTML Web Site</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Python图形插入HTML网站</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-insert-a-python-graph-into-an-html-web-site-688754f67e1c?source=collection_archive---------1-----------------------#2021-05-21">https://towardsdatascience.com/how-to-insert-a-python-graph-into-an-html-web-site-688754f67e1c?source=collection_archive---------1-----------------------#2021-05-21</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="626c" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph">数据可视化</h2><div class=""/><div class=""><h2 id="156a" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">将Altair或Plot.ly中构建的图形与HTML网站集成的简短教程</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/febf8f4023689c9ab9d3c40a7d9297e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZA3fCigb71QKVgfbx36tMw.jpeg"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">图片来自<a class="ae lk" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1076536" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="12ee" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">正如许多人所知，Python是一种非常强大的数据操作语言，包括数据收集、<a class="ae lk" rel="noopener" target="_blank" href="/a-complete-data-analysis-workflow-in-python-and-scikit-learn-9a77f7c283d3">数据分析</a>和数据可视化。关于这最后一个方面，存在许多强大的库和框架，如<a class="ae lk" href="https://plotly.com/graphing-libraries/" rel="noopener ugc nofollow" target="_blank"> Plot.ly </a>图形库和<a class="ae lk" href="https://altair-viz.github.io/" rel="noopener ugc nofollow" target="_blank"> Altair </a>。</p><p id="e53a" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">Plot.ly图形库是一个非常强大的库，它允许用Python、R和Javascript构建图形和地图。Altair是Python的另一个声明性统计可视化库，基于<a class="ae lk" href="https://vega.github.io/vega/" rel="noopener ugc nofollow" target="_blank"> Vega </a>和<a class="ae lk" href="http://vega.github.io/vega-lite" rel="noopener ugc nofollow" target="_blank"> Vega-lite </a>。</p><p id="4196" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在本教程中，我假设您已经知道如何使用Plot.ly或Altair构建图形。我将只说明如何将一个现有的图形与一个HTML网站集成。</p><p id="dd09" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">将Python图形集成到HTML网站需要三个步骤:</p><ul class=""><li id="be6a" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">在Plot.ly或Altair中生成图形</li><li id="516d" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">将图表保存为HTML页面</li><li id="b1e2" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">操作生成的HTML</li></ul><h1 id="c71a" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">Plot.ly</h1><p id="b699" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">首先，我在Plot.ly中构建了一个通用图。在这个具体的例子中，我将关于意大利新冠肺炎阳性病例数的时间序列作为输入数据。我利用以下Python代码绘制了一条线:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="3209" class="nx mw iw nt b gz ny nz l oa ob">import plotly<br/>import plotly.graph_objs as go<br/>import pandas as pd</span><span id="7c9d" class="nx mw iw nt b gz oc nz l oa ob">df = pd.read_csv('<a class="ae lk" href="https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-andamento-nazionale/dpc-covid19-ita-andamento-nazionale.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-andamento-nazionale/dpc-covid19-ita-andamento-nazionale.csv'</a>)</span><span id="1d72" class="nx mw iw nt b gz oc nz l oa ob"># Create a trace<br/>data = [go.Scatter(<br/>    x = df['data'],<br/>    y = df['totale_positivi'],<br/>)]</span><span id="917b" class="nx mw iw nt b gz oc nz l oa ob">layout = go.Layout(<br/>        xaxis=dict(<br/>            title='Data',    <br/>        ),<br/>        yaxis=dict(<br/>            title='Totale positivi',  <br/>        )<br/>    )<br/>fig = go.Figure(data=data, layout=layout)</span></pre><p id="bfca" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">下图显示了生成的输出:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj od"><img src="../Images/7019552ab9851ecd9e1213c8f3ac2ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSq4ua4SRAkndXIpCHtLfg.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="c900" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在，我可以将该图保存为HTML文件。我利用了<code class="fe oe of og nt b">plotly.offline.plot()</code>函数。作为一个配置参数，我指定在绘图中不显示模式栏(<code class="fe oe of og nt b">config={‘displayModeBar’: False}</code>)。这是为了避免让用户操纵HTML页面中的图像。</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="e290" class="nx mw iw nt b gz ny nz l oa ob">plotly.offline.plot(fig,filename='positives.html',config={'displayModeBar': False})</span></pre><p id="c136" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在我可以打开文件<code class="fe oe of og nt b">positives.html</code>并操作它。该文件类似于下面这段代码:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="d287" class="nx mw iw nt b gz ny nz l oa ob">&lt;html&gt;<br/>  &lt;head&gt;&lt;meta charset="utf-8" /&gt;&lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div&gt;<br/>        &lt;script type="text/javascript"&gt;window.PlotlyConfig =  <br/>             {MathJaxConfig: 'local'};<br/>        &lt;/script&gt;</span><span id="1f38" class="nx mw iw nt b gz oc nz l oa ob">        &lt;script type="text/javascript"&gt;<br/>          ...<br/>        &lt;/script&gt;</span><span id="9443" class="nx mw iw nt b gz oc nz l oa ob">        &lt;div id="9eec8ee0-8ebf-4199-8f61-7f86aab4cc81" class="plotly-graph-div" style="height:100%; width:100%;"&gt;&lt;/div&gt;</span><span id="7947" class="nx mw iw nt b gz oc nz l oa ob">        &lt;script type="text/javascript"&gt; <br/>          ... <br/>        &lt;/script&gt;</span><span id="806a" class="nx mw iw nt b gz oc nz l oa ob">    &lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="5872" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">该文件由4个主要部分组成。第二部分很长。第二部分和第四部分可以复制到两个不同的javascript文件中，没有开始和结束标记(<code class="fe oe of og nt b">&lt;script type=”text/javascript”&gt;</code>和<code class="fe oe of og nt b">&lt;/script&gt;</code>)，命名为<code class="fe oe of og nt b">chart-part1.js</code>和<code class="fe oe of og nt b">chart-part2.js</code>。现在，我可以用包含的两个javascript文件替换HTML文件的第二和第四部分:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="dc09" class="nx mw iw nt b gz ny nz l oa ob">&lt;html&gt;<br/>&lt;head&gt;&lt;meta charset="utf-8" /&gt;&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;<br/>        &lt;script type="text/javascript"&gt;window.PlotlyConfig = {MathJaxConfig: 'local'};&lt;/script&gt;<br/>        &lt;script src="js/chart-part1.js"&gt;&lt;/script&gt;<br/>        <br/>        &lt;div id="9eec8ee0-8ebf-4199-8f61-7f86aab4cc81" class="plotly-graph-div" style="height:100%; width:100%;"&gt;&lt;/div&gt;<br/>        &lt;script src="js/chart-part2.js"&gt;&lt;/script&gt;   <br/>    &lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="0318" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">注意，我已经将<code class="fe oe of og nt b">chart-part1.js</code>和<code class="fe oe of og nt b">chart-part2.js</code>文件保存到了<code class="fe oe of og nt b">js</code>文件夹中。现在，我可以将包含在<code class="fe oe of og nt b">div</code>中的所有代码复制到我的HTML Web站点中的任何地方，只要我提醒也将<code class="fe oe of og nt b">js</code>文件夹复制到我的Web站点文件夹中:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="8374" class="nx mw iw nt b gz ny nz l oa ob">&lt;div&gt;<br/>    &lt;script type="text/javascript"&gt;window.PlotlyConfig = {MathJaxConfig: 'local'};&lt;/script&gt;<br/>    &lt;script src="js/chart-part1.js"&gt;&lt;/script&gt;<br/>        <br/>    &lt;div id="9eec8ee0-8ebf-4199-8f61-7f86aab4cc81" class="plotly-graph-div" style="height:100%; width:100%;"&gt;&lt;/div&gt;<br/>    &lt;script src="js/chart-part2.js"&gt;&lt;/script&gt;   <br/>&lt;/div&gt;</span></pre><h1 id="255f" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">阿尔泰尔</h1><p id="d9d8" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">在这个例子中，我使用默认的vega数据集构建了一个简单的散点图，包含在<code class="fe oe of og nt b">vega_datasets</code>库中。</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="8565" class="nx mw iw nt b gz ny nz l oa ob">import altair as alt<br/>from vega_datasets import data</span><span id="5e32" class="nx mw iw nt b gz oc nz l oa ob">chart = alt.Chart(data.cars.url).mark_point().encode(<br/>    x='Horsepower:Q',<br/>    y='Miles_per_Gallon:Q',<br/>    color='Origin:N'<br/>)</span></pre><p id="43f8" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在我可以通过<code class="fe oe of og nt b">save()</code>功能保存图表:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="6063" class="nx mw iw nt b gz ny nz l oa ob">chart.save('chart.html', embed_options={'actions': False})</span></pre><p id="3c07" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在<code class="fe oe of og nt b">embed_options</code>中，我指定我不想打印动作按钮。或者，正如@ <a class="ae lk" href="https://medium.com/@alan-jones?source=post_info_responses---------1-----------------------" rel="noopener">阿兰·琼斯</a>所建议的，我可以在我的Plotly配置中设置<code class="fe oe of og nt b">staticPlot = True</code>而不是隐藏工具栏(这实际上并不会停止交互)。静态图不是交互式的，也没有工具栏。</p><p id="fa2b" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">生成的HTML文件如下所示:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="4870" class="nx mw iw nt b gz ny nz l oa ob">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>  &lt;style&gt;<br/>    .error {<br/>        color: red;<br/>    }<br/>  &lt;/style&gt;<br/>  &lt;script type="text/javascript" src="<a class="ae lk" href="https://cdn.jsdelivr.net/npm//vega@5" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm//vega@5</a>"&gt;&lt;/script&gt;<br/>  &lt;script type="text/javascript" src="<a class="ae lk" href="https://cdn.jsdelivr.net/npm//vega-lite@4.8.1" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm//vega-lite@4.8.1</a>"&gt;&lt;/script&gt;<br/>  &lt;script type="text/javascript" src="<a class="ae lk" href="https://cdn.jsdelivr.net/npm//vega-embed@6" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm//vega-embed@6</a>"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>  &lt;div id="vis"&gt;&lt;/div&gt;<br/>  &lt;script&gt;<br/>    (function(vegaEmbed) {<br/>      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"url": "<a class="ae lk" href="https://cdn.jsdelivr.net/npm/vega-datasets@v1.29.0/data/cars.json" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vega-datasets@v1.29.0/data/cars.json</a>"}, "mark": "point", "encoding": {"color": {"type": "nominal", "field": "Origin"}, "x": {"type": "quantitative", "field": "Horsepower"}, "y": {"type": "quantitative", "field": "Miles_per_Gallon"}}, "$schema": "<a class="ae lk" href="https://vega.github.io/schema/vega-lite/v4.8.1.json" rel="noopener ugc nofollow" target="_blank">https://vega.github.io/schema/vega-lite/v4.8.1.json</a>"};<br/>      var embedOpt = {"actions": false, "mode": "vega-lite"};</span><span id="d467" class="nx mw iw nt b gz oc nz l oa ob">function showError(el, error){<br/>          el.innerHTML = ('&lt;div class="error" style="color:red;"&gt;'<br/>                          + '&lt;p&gt;JavaScript Error: ' + error.message + '&lt;/p&gt;'<br/>                          + "&lt;p&gt;This usually means there's a typo in your chart specification. "<br/>                          + "See the javascript console for the full traceback.&lt;/p&gt;"<br/>                          + '&lt;/div&gt;');<br/>          throw error;<br/>      }<br/>      const el = document.getElementById('vis');<br/>      vegaEmbed("#vis", spec, embedOpt)<br/>        .catch(error =&gt; showError(el, error));<br/>    })(vegaEmbed);</span><span id="c22c" class="nx mw iw nt b gz oc nz l oa ob">&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ebdf" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我将包含在<code class="fe oe of og nt b">&lt;script&gt;</code>标签中的代码复制到一个名为<code class="fe oe of og nt b">chart.js</code>的javascript文件中。如果我想将图表包含到HTML网页中，我必须将以下部分放在我的HTML网页中的任意位置:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="e1c8" class="nx mw iw nt b gz ny nz l oa ob">&lt;div id="vis"&gt;&lt;/div&gt;<br/>  &lt;script src="js/chart.js"&gt;&lt;/script&gt;</span></pre><p id="b2f5" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我还应该提醒在我的HTML页面的头部包含<code class="fe oe of og nt b">vega</code>、<code class="fe oe of og nt b">vega-lite</code>和<code class="fe oe of og nt b">vega-embed</code> javascript文件。最终结果如下所示:</p><pre class="kv kw kx ky gu ns nt nu nv aw nw bi"><span id="8d7d" class="nx mw iw nt b gz ny nz l oa ob">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>  &lt;style&gt;<br/>    .error {<br/>        color: red;<br/>    }<br/>  &lt;/style&gt;<br/>  &lt;script type="text/javascript" src="<a class="ae lk" href="https://cdn.jsdelivr.net/npm//vega@5" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm//vega@5</a>"&gt;&lt;/script&gt;<br/>  &lt;script type="text/javascript" src="<a class="ae lk" href="https://cdn.jsdelivr.net/npm//vega-lite@4.8.1" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm//vega-lite@4.8.1</a>"&gt;&lt;/script&gt;<br/>  &lt;script type="text/javascript" src="<a class="ae lk" href="https://cdn.jsdelivr.net/npm//vega-embed@6" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm//vega-embed@6</a>"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>  &lt;div id="vis"&gt;&lt;/div&gt;<br/>  &lt;script src="js/chart.js"&gt;&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="4322" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">摘要</h1><p id="ba14" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">在这篇简短的教程中，我演示了如何将Plot.ly或Altair Python graph包含到HTML网站中。</p><p id="3789" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">需要三个步骤:生成图形，将其保存为HTML，并处理输出，使代码易于包含在另一个HTML页面上。</p><p id="268e" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">如果你想了解我的研究和其他活动的最新情况，你可以在<a class="ae lk" href="https://twitter.com/alod83" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae lk" href="https://www.youtube.com/channel/UC4O8-FtQqGIsgDW_ytXIWOg?view_as=subscriber" rel="noopener ugc nofollow" target="_blank"> Youtube </a>和<a class="ae lk" href="https://github.com/alod83" rel="noopener ugc nofollow" target="_blank"> Github </a>上关注我。</p><h1 id="74dd" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">相关文章</h1><div class="oh oi gq gs oj ok"><a rel="noopener follow" target="_blank" href="/how-to-insert-an-observablehq-graph-into-a-html-page-57a9f4546ecf"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd jg gz z fq op fs ft oq fv fx jf bi translated">如何将Observablehq图形插入HTML页面</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">一个快速的教程，用你的观察制作精彩的HTML页面。</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">towardsdatascience.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy le ok"/></div></div></a></div><div class="oh oi gq gs oj ok"><a href="https://codeburst.io/quick-start-with-html-through-bootstrap-bbe6f2f1793" rel="noopener follow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd jg gz z fq op fs ft oq fv fx jf bi translated">通过Bootstrap快速使用HTML</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">在本教程中，我将向你展示如何用Bootstrap构建一个简单的HTML页面。Bootstrap是一个工具包，它允许…</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">codeburst.io</p></div></div><div class="ot l"><div class="oz l ov ow ox ot oy le ok"/></div></div></a></div><div class="oh oi gq gs oj ok"><a rel="noopener follow" target="_blank" href="/how-to-improve-d3-js-graphs-with-annotations-252fbb9c5bb5"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd jg gz z fq op fs ft oq fv fx jf bi translated">如何改进带注释的D3.js图形</h2><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">towardsdatascience.com</p></div></div><div class="ot l"><div class="pa l ov ow ox ot oy le ok"/></div></div></a></div></div></div>    
</body>
</html>