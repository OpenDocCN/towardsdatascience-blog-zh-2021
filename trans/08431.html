<html>
<head>
<title>Building Your Own Google Translate App with Plotly Dash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Plotly Dash构建自己的谷歌翻译应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-your-own-google-translate-app-on-plotly-dash-150297dbb8b1?source=collection_archive---------24-----------------------#2021-08-03">https://towardsdatascience.com/building-your-own-google-translate-app-on-plotly-dash-150297dbb8b1?source=collection_archive---------24-----------------------#2021-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="42fb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">语言不分国界！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b6f04f9fcbedc38ad4f66b92ddd88cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJqRa4Vd0UjACKUfKqk1AA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><br/> <a class="ae kv" href="https://unsplash.com/photos/v6kii3H5CcU" rel="noopener ugc nofollow" target="_blank"> Artem Beliaikin </a>在<a class="ae kv" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="3f08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">动机</em> </strong></p><p id="a923" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我喜欢探索！我一直对世界各地的不同语言很感兴趣。我来自一个使用多种语言的国家，我可以证明，掌握多种语言肯定会打开你的世界，因为你可以很容易地与他人联系。虽然谷歌翻译确实让我们的生活变得更加轻松，语言不再是障碍，但我认为如果我能在一次搜索中获得所有语言中一个单词的<strong class="ky ir">翻译，而</strong>则是惊人的。不仅如此，作为一个视觉学习者，<strong class="ky ir">将这些翻译的单词映射到地图上各自的国家</strong>有助于让我的学习更容易，幸运的是，Plotly Dash使这成为可能！</p><p id="a41b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">先睹为快</em> </strong></p><p id="b10c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是该应用程序的最终产品，当你在一个国家徘徊时，翻译的文本就会出现。很想创造一个吗？让我们开始吧！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lt lu l"/></div></figure></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><h1 id="b727" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">图书馆</h1><p id="b600" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">以下库将用于构建此应用程序。</p><ol class=""><li id="b306" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr ne nf ng nh bi translated"><strong class="ky ir"> googletrans </strong>:实现Google Translate API的python库</li><li id="a927" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr ne nf ng nh bi translated">一个交互式的开源绘图/可视化库</li><li id="a472" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr ne nf ng nh bi translated"><strong class="ky ir"> dash </strong>:用于构建web分析应用程序的高效Python框架</li><li id="b912" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr ne nf ng nh bi translated"><strong class="ky ir"> pycountry </strong>:提供语言&amp;国家的ISO数据库</li><li id="6781" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr ne nf ng nh bi translated">熊猫:提供快速、灵活和富于表现力的数据结构的包</li></ol><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="7243" class="ns md iq no b gy nt nu l nv nw">pip install googletrans==3.1.0a0<br/>pip install dash<br/>pip install pycountry<br/>pip install pandas</span></pre><p id="f8fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我已经安装了alpha版本<code class="fe nx ny nz no b">googletrans==3.1.0a0</code>,因为由于谷歌翻译API的变化，其他版本中出现了一些问题。</p><p id="dc36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">数据集的预览</em> </strong></p><p id="08a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据集可以在我的<a class="ae kv" href="https://github.com/Vanessawhj/translation-dashapp/blob/main/updated_population.csv" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa lu l"/></div></figure><h1 id="bcb2" class="mc md iq bd me mf ob mh mi mj oc ml mm jw od jx mo jz oe ka mq kc of kd ms mt bi translated">Googletrans</h1><p id="e773" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">谷歌翻译API支持多种语言。要列出它们，只需运行下面的代码。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="6059" class="ns md iq no b gy nt nu l nv nw">import googletrans<br/>from pprint import pprint</span><span id="252a" class="ns md iq no b gy og nu l nv nw">pprint(googletrans.LANGUAGES)</span></pre><p id="3837" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们看看翻译器是如何工作的。首先需要从<code class="fe nx ny nz no b">googletrans</code>模块导入Translator并创建一个<code class="fe nx ny nz no b">Translator</code>类的对象，然后将文本作为参数传递给<code class="fe nx ny nz no b">Translator</code>类对象的<code class="fe nx ny nz no b">translate()</code>方法。默认情况下，<code class="fe nx ny nz no b">translate()</code>方法返回传递给它的文本的英语翻译，因此您需要使用<code class="fe nx ny nz no b">dest</code>属性指定目标语言。这里我们用<code class="fe nx ny nz no b">‘fr'</code>初始化了<code class="fe nx ny nz no b">dest</code>，这意味着<code class="fe nx ny nz no b">translate()</code>方法会将文本从英语转换成法语。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="a663" class="ns md iq no b gy nt nu l nv nw">result = translator.translate("hello world", dest="fr").text</span></pre><p id="b246" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于我们处理的是pandas DataFrame，而<code class="fe nx ny nz no b">dest</code>因国家而异，所以我使用了<code class="fe nx ny nz no b">.apply()</code>方法来传递函数，并将其应用于Panda系列<code class="fe nx ny nz no b">ISO_lang</code>的每个值。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="3c24" class="ns md iq no b gy nt nu l nv nw">df["transl"] = df["ISO_lang"].apply(lambda x: translator.translate(text, src=lang, dest = x).text)</span></pre><p id="2f0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一个包含翻译文本的新列<code class="fe nx ny nz no b">transl</code>。</p><h1 id="e29f" class="mc md iq bd me mf ob mh mi mj oc ml mm jw od jx mo jz oe ka mq kc of kd ms mt bi translated">Plotly Express</h1><p id="5bed" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">为了可视化我们翻译的文本，我将使用Plotly Express，这是一个新的高级Python可视化库，也是Plotly.py的包装器，允许使用复杂图表的简单语法。Plotly是最好的可视化库之一，因为它允许交互式T21可视化。但最重要的是，它可以<strong class="ky ir">部署在Dash应用</strong>上，这才是本文的主旨！</p><p id="da39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的可视化中使用的图是一个<code class="fe nx ny nz no b">choropleth</code>地图，它允许我们通过根据值着色的区域&amp;呈现数据。数据帧中的每一行被表示为choropleth的一个区域。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh lu l"/></div></figure><p id="769a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nx ny nz no b">color</code>参数本质上是我们想要用于颜色编码的数据帧的列。在这里，我使用了<code class="fe nx ny nz no b">population</code>列，这样我们的choropleth地图也允许我们按照国家来可视化世界人口。</p><h1 id="e64f" class="mc md iq bd me mf ob mh mi mj oc ml mm jw od jx mo jz oe ka mq kc of kd ms mt bi translated">破折号</h1><p id="3ecc" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">现在进入激动人心的部分，让我们把所有东西放在一起，构建我们的dash应用程序！Dash是Plotly的开源框架，用于构建分析性web应用程序和以Plotly图表为特色的仪表盘。这是一个web应用框架，<strong class="ky ir">围绕HTML、CSS和JavaScript </strong>提供抽象，因为它构建在Flask、React.js和Plotly.js之上。</p><p id="731e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们首先导入dash库。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh lu l"/></div></figure><p id="b3b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Dash应用由两部分组成:布局<strong class="ky ir">和交互<strong class="ky ir">两部分。</strong></strong></p><p id="73be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">一、布局</em> </strong></p><p id="7813" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">布局使用两个库，分别是<code class="fe nx ny nz no b">dash_html_components</code>和<code class="fe nx ny nz no b">dash_core_components</code>。<code class="fe nx ny nz no b">dash_html_components</code>库<strong class="ky ir">为所有的HTML标签</strong>提供了类，关键字参数描述了HTML属性，如<code class="fe nx ny nz no b">style</code>、<code class="fe nx ny nz no b">className</code>和<code class="fe nx ny nz no b">id</code>。它允许我们设计应用程序的外观。简而言之，dash允许我们使用Python结构和dash组件库来构建布局，而不是编写HTML，dash组件库使用Div类<strong class="ky ir">转换Python类<strong class="ky ir">来创建HTML</strong>Div。另一方面，<code class="fe nx ny nz no b">dash_core_components</code>库生成更高级别的组件，如控件和图形。<code class="fe nx ny nz no b">dcc.Graph</code>类允许我们在布局中创建一个图表。在幕后，Dash使用Plotly.js创建交互式图形，其中的<code class="fe nx ny nz no b">dcc.Graph</code>组件需要一个包含绘图数据和布局的图形对象或Python字典。同时，<code class="fe nx ny nz no b">dcc.Input</code>接受用户输入(要翻译的文本)并将其作为参数传递给Dash回调中的<code class="fe nx ny nz no b">update_output</code>函数。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh lu l"/></div></figure><p id="a211" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">二世。回调</em> </strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh lu l"/></div></figure><p id="f155" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回调函数本质上是Python函数，每当输入组件的属性发生变化时，dash就会自动调用这些函数<strong class="ky ir">，因此<strong class="ky ir">允许Dash应用程序中的交互</strong>。为了做到这一点，我们需要从<code class="fe nx ny nz no b">dash.dependencies</code>导入<code class="fe nx ny nz no b">Input, Output &amp; State</code>。</strong></p><p id="aff7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每一个<code class="fe nx ny nz no b">state</code> &amp; <code class="fe nx ny nz no b">input</code>都需要表示为回调函数内部的参数。<code class="fe nx ny nz no b">input</code>和<code class="fe nx ny nz no b">state</code>的区别在于，每当输入的<code class="fe nx ny nz no b">component_property</code>发生变化时，自动触发回调。然而，当状态的<code class="fe nx ny nz no b">component_property</code>改变时，它不会被触发。从长远来看，每当用户在文本框中输入时，图表不会更新。当用户点击“翻译”按钮时，只有这时图形才会更新。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="4568" class="ns md iq no b gy nt nu l nv nw">[dash.dependencies.Input(component_id='submit_button', component_property='n_clicks')],     [dash.dependencies.State(component_id='input_state', component_property='value')]</span></pre><p id="9110" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们了解一下<strong class="ky ir">依赖关系</strong>是如何工作的。回调函数中的<code class="fe nx ny nz no b">component_id=’submit_button’</code>基本上与之前在<code class="fe nx ny nz no b">app.layout</code>中初始化的<code class="fe nx ny nz no b">html.Button(id=’submit_button’, n_clicks=0, children=’Submit’)</code>参数进行交互。这意味着当我们的应用程序界面中的提交按钮被点击时，它触发回调函数执行<code class="fe nx ny nz no b">update_output</code>函数，在这里它作为<code class="fe nx ny nz no b">num_clicks</code>参数被传递。回调函数将数据返回给<code class="fe nx ny nz no b">output</code>的<code class="fe nx ny nz no b">component_property='figure'</code>，这是choropleth映射。</p><p id="c4e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">参数的<strong class="ky ir">顺序对于应用程序的运行至关重要</strong>，即<strong class="ky ir">输出→输入→状态</strong>，我们的<code class="fe nx ny nz no b">update_output</code>函数中的参数对应于回调函数中的<code class="fe nx ny nz no b">input</code>和<code class="fe nx ny nz no b">state</code>参数，顺序相同。例如，第一参数<code class="fe nx ny nz no b">num_clicks</code>与输入<code class="fe nx ny nz no b">component_property='n_clicks'</code>相关联，第二参数<code class="fe nx ny nz no b">value</code>与状态<code class="fe nx ny nz no b">component_property='value'</code>相关联。</p><p id="ac34" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在某些情况下，当您不想更新回调输出时，您可以像我一样在回调函数中引发一个<code class="fe nx ny nz no b">PreventUpdate</code>异常。</p><p id="69ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，插入我们之前的代码片段，在<code class="fe nx ny nz no b">update_output</code>函数中创建choropleth映射。为了查看我们的可视化，我们需要<strong class="ky ir">运行我们的web服务器</strong>，就像在Flask中使用<code class="fe nx ny nz no b">app.run_server(debug=False)</code>一样。如果你在Jupyter笔记本上运行，记得<strong class="ky ir">禁用调试模式</strong>和。我们的dash应用程序现在可以运行了！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh lu l"/></div></figure><h1 id="29c4" class="mc md iq bd me mf ob mh mi mj oc ml mm jw od jx mo jz oe ka mq kc of kd ms mt bi translated">结论</h1><p id="0fb8" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">恭喜你！在本文中，你已经学习了<strong class="ky ir">破折号布局和回调</strong>，这两者对于构建你的第一个web应用程序都是必不可少的。Dash创建交互式dashboard的能力超乎想象，所以去创建一些有趣的东西并与世界分享吧！</p><p id="892d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我应该注意到，应用程序加载时间与数据集中的国家数量相对应，这是因为<code class="fe nx ny nz no b">googletrans</code>在生成输出之前必须逐行翻译。</p><p id="06a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整的代码可以在我的<a class="ae kv" href="https://github.com/Vanessawhj/translation-dashapp" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>:)中找到</p><p id="61a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">资源:</strong></p><ol class=""><li id="edb4" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr ne nf ng nh bi translated"><a class="ae kv" href="https://plotly.github.io/plotly.py-docs/generated/plotly.express.choropleth.html" rel="noopener ugc nofollow" target="_blank"> Plotly Express — Choropleth文档</a></li></ol><p id="c1d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.<a class="ae kv" href="https://dash.plotly.com/plugins" rel="noopener ugc nofollow" target="_blank">仪表板组件库</a></p><p id="970b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.<a class="ae kv" href="https://pypi.org/project/googletrans/" rel="noopener ugc nofollow" target="_blank"> Googletrans文档</a></p><p id="064d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我总是乐于接受反馈和建设性的批评。此外，请随时与我分享你的工作，我也期待着向你学习！你可以在Linkedin上找到我。:)</p></div></div>    
</body>
</html>