<html>
<head>
<title>EFPN: Extended Feature Pyramid Network for Small Object Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">EFPN:用于小目标检测的扩展特征金字塔网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/efpn-extended-feature-pyramid-network-for-small-object-detection-980af794a093?source=collection_archive---------21-----------------------#2021-10-14">https://towardsdatascience.com/efpn-extended-feature-pyramid-network-for-small-object-detection-980af794a093?source=collection_archive---------21-----------------------#2021-10-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="8eda" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/thoughts-and-theory" rel="noopener" target="_blank">思想和理论</a></h2><div class=""/><div class=""><h2 id="f506" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">当小事情造成大问题时</h2></div><p id="8ea4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">自最初几天的智能机器系统以来，目标检测一直是计算机视觉应用中的一个突破。尽管被研究了很长时间，但这个话题似乎永远不会过时，已经成为视频理解和计算机视觉中必须知道的问题之一。我希望你已经了解了物体检测的一些背景知识，因为我将忽略关于物体检测的几个基本概念，比如什么是物体检测，物体检测器有多少种。我相信你可以很容易地找到大量关于计算机视觉的定义和解释。</p><p id="4828" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">当技术刚刚取得显著成就时，人们喜欢让事情变得更复杂。在对象检测中，尽管已经提出了许多更具创新性的算法，但我们还会有更多的数据。随着现代图像数据变得越来越具有挑战性，例如包括大量小(或非常小)的物体，传统的物体检测器，如R-CNN、单次检测器(SSD)和YOLO，正变得过时，因为它们不能处理小物体检测问题。因此，作为上述方法(级联R-CNN、DSSD、约洛夫4、约洛夫4-5D)的继承者的现代模型已被提出来应对挑战。你可以在这里看看我为yolov 4-5D评论和解说<a class="ae lk" rel="noopener" target="_blank" href="/yolov4-5d-an-enhancement-of-yolov4-for-autonomous-driving-2827a566be4a">写的帖子。在这篇文章中，我将回顾用于小物体检测的扩展特征金字塔网络(EFPN)，你可能想在这里阅读全文</a><a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="ae36" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">香草FPN探测器的问题</h1><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi md"><img src="../Images/c3be89efedcee5199534531de4664b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*LNbEVqHptq4g-o32l2bp0g.png"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">香草特征金字塔网络(图片来自<a class="ae lk" href="https://arxiv.org/abs/1612.03144" rel="noopener ugc nofollow" target="_blank">论文</a></p></figure><p id="b381" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如论文中所述，特征金字塔网络(FPN)是在不同尺度的特征地图上检测对象的第一个概念，以增强对象检测器的性能，特别是在小对象检测中。fpn具有与编码器-解码器架构相同的结构，其中从输入图像提取的特征首先被编码到提取的特征图(瓶颈),然后该信息被再次放大并与相应的特征级别组合以形成用于预测的最终特征图。通过这样做，较低层中的位置信息可以与较深层中的丰富语义信息相结合，以提高整体检测性能。</p><p id="0753" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">尽管传统的FPN目标检测器可以在一定范围内获得良好的检测结果，但是它们仍然存在一个缺点。如下图所示，检测器不能有效地使用特征图来预测合适的物体尺寸。具体而言，在FPN的工作机制中，高分辨率特征图(例如下图中的1级)应用于小物体检测，低分辨率特征图(例如4级)应负责预测大物体。然而，在几乎所有的特征图级别中都产生了大物体建议，在相同的特征级别(级别1)中提出了中等物体和小物体，这些统计数据证明了普通FPN检测器并不以我们字面上预期的方式工作。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/a474f8627dd0a8e97d57bf3c6deeaebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*Edz5vrHUxVzpKEtr3DQSmg.png"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">传统FPN检测器中金字塔等级和提案规模之间的映射(图来自<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">论文</a></p></figure><h1 id="12b4" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">扩展要素金字塔网络(EFPN)</h1><p id="23a8" class="pw-post-body-paragraph ko kp iq kq b kr mq ka kt ku mr kd kw kx ms kz la lb mt ld le lf mu lh li lj ij bi translated">为了解决上述问题，Deng等人提出了用于小目标检测的扩展特征金字塔网络(<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">全文</a> r)。本文的主要贡献可以概括为:</p><ul class=""><li id="0a63" class="mv mw iq kq b kr ks ku kv kx mx lb my lf mz lj na nb nc nd bi translated">改进小目标检测性能的扩展特征金字塔网络(EFPN)。</li><li id="32df" class="mv mw iq kq b kr ne ku nf kx ng lb nh lf ni lj na nb nc nd bi translated">一个特征纹理传输(FTT)模块，为更准确的小物体检测结果提供可信的细节。</li><li id="53b2" class="mv mw iq kq b kr ne ku nf kx ng lb nh lf ni lj na nb nc nd bi translated">前景-背景平衡损失函数，以减轻前景和背景之间的区域不平衡。</li></ul><p id="50ac" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们浏览一下每一项。</p><h2 id="cadc" class="nj lm iq bd ln nk nl dn lr nm nn dp lv kx no np lx lb nq nr lz lf ns nt mb iw bi translated">1.EFPN的建筑</h2><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi nu"><img src="../Images/446afb9b74748795705c0c0faae9a21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*apoRC33V7dBZ5dVRDfMkYA.png"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">EFPN的管道(图来自<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">报</a></p></figure><p id="b70b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如上图所示，与香草FPN的架构相比，主要区别包括:(1) EFPN多了一个检测层P2’；(2) EFPN利用FTT模块将P2和P3的功能转移到P2。不同于仅使用较低的和相邻的特征图进行放大的先前步骤，FTT模块将两个特征图P2和P3作为其过程的输入，并生成P3‘其随后用于新的检测层P2’。EFPN能够在5个不同的尺度上做出预测。</p><h2 id="d684" class="nj lm iq bd ln nk nl dn lr nm nn dp lv kx no np lx lb nq nr lz lf ns nt mb iw bi translated">2.FTT模块</h2><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi nz"><img src="../Images/10ed7b475f2aef782b13ad5e76e0c8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUE5PuyxGD1jUMPW56SmJQ.png"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">FTT模块的管道(图来自<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">纸</a></p></figure><p id="8720" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在FFT模块中，首先使用<strong class="kq ja">内容提取器</strong>从P3 (Main)中提取语义特征，然后应用亚像素卷积层来放大<strong class="kq ja">内容提取器</strong>的输出。然后，最新信息与特征图P2(参考)相关联，以形成用于选择小物体的可信纹理的<strong class="kq ja">纹理提取器</strong>的输入。最后，建立残差连接用于特征融合并产生输出特征图P3’。通过应用这种方式，P3从浅层特征图P2中导出选择性特征，并从深层P3中接收语义。</p><h2 id="f2e8" class="nj lm iq bd ln nk nl dn lr nm nn dp lv kx no np lx lb nq nr lz lf ns nt mb iw bi translated">3.前景背景平衡损失</h2><p id="bff1" class="pw-post-body-paragraph ko kp iq kq b kr mq ka kt ku mr kd kw kx ms kz la lb mt ld le lf mu lh li lj ij bi translated">提高对象检测性能的经典方法是使用高分辨率输入。受这一想法的启发，作者提出了一种新的训练机制，称为<strong class="kq ja">交叉解析蒸馏</strong>。</p><p id="4945" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了应用知识提炼，学生模型需要从教师网络的输出中学习。为了应对这种情况，作者使用该模型以2x输入进行测试，然后利用前4层的输出作为知识提取的训练目标。例如，与原始输入(1x输入)的P5相比，2x输入的P5具有两倍的分辨率，并且与原始输入(1x输入)的P4具有相同的分辨率，如上图所示。因此，2x输入的P3和P2将被分别用作训练原始输入(1x输入)的P3和P2的目标。使用以下损失函数来训练学生EFPN:</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi oa"><img src="../Images/8fae0cbae2194a3f357a723c20d0cf0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miUEGAqn-a-1vZgxLjRq5w.png"/></div></div></figure><p id="0599" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">其中<em class="ob"> L_fbb </em>是建议的前景-背景平衡损失。这个损失函数实际上是L1损失，然而，它由两部分组成:全局重建损失<em class="ob"> L_glob </em>和正补片损失<em class="ob"> L_pos。</em>建议的前景-背景平衡损失可描述为:</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi oc"><img src="../Images/c83da2a713845dd3f622e895137eaebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOq68OGbILUgqdRla1rJ6Q.png"/></div></div></figure><p id="ca94" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">其中<em class="ob"> F </em>表示计算的特征图，而<em class="ob"> Ft </em>表示目标特征图。λ是重量平衡参数。<em class="ob"> L_glob </em>和<em class="ob"> L_pos </em>公式如下:</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi od"><img src="../Images/5b4bb62e18112c87bc2dae2be4605952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4gfjhYB9vfhLxfhslr8erw.png"/></div></div></figure><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi oe"><img src="../Images/a068e94a032c71947e23624896064ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZiCX6MPoqfHbRp0xTzFNQ.png"/></div></div></figure><p id="ca7a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">其中<em class="ob"> P_pos </em>表示地面真实物体的块，<em class="ob"> (x，y) </em>表示特征地图坐标，<em class="ob"> N </em>表示正像素的数量。更多详情可以找<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">原论文</a>。</p><h1 id="fe7b" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">结果</h1><p id="e06c" class="pw-post-body-paragraph ko kp iq kq b kr mq ka kt ku mr kd kw kx ms kz la lb mt ld le lf mu lh li lj ij bi translated">与其他现代方法相比，作者在清华-腾讯100K小交通标志数据集和MS COCO小对象数据集上测试了EFPN。定量结果如下表所示。与其他最新算法相比，EFPN在各种实验设置中呈现了最先进的检测结果。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi of"><img src="../Images/0cd0f18c510257a0e5d5808a7f31c19a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnuBe4eECmu2hW9-w_klww.png"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">表格来自<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">纸</a></p></figure><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi og"><img src="../Images/c162548b597b835bc60720f321da8285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nx2FlqG2f4P7-giUI2kHNA.png"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">表来自<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">的论文</a></p></figure><p id="28eb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">视觉检测结果如下图所示，每个图像对显示了香草FPN(左)和EFPN(右)结果之间的比较(红色:假阴性，蓝色:假阳性，绿色:真阳性)。很明显，EFPN在小物体探测方面优于FPN。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi oh"><img src="../Images/e270b2d5871e847120b6ae502b2606b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YckYDQzcUNW0T0nQNMQIQ.png"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">FPN和EFPN的视觉对比(图来自<a class="ae lk" href="https://arxiv.org/abs/2003.07021v1" rel="noopener ugc nofollow" target="_blank">报</a>)</p></figure><h1 id="e5de" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">结论</h1><p id="cc5b" class="pw-post-body-paragraph ko kp iq kq b kr mq ka kt ku mr kd kw kx ms kz la lb mt ld le lf mu lh li lj ij bi translated">在这篇文章中，我回顾了扩展特征金字塔网络(EFPN)，这是一个用于小物体检测的普通特征金字塔网络(FPN)的改进。EFPN在准确性和计算方面都显示了它的有效性。EFPN已经在清华-腾讯100K小型交通标志数据集和MS COCO小型物体数据集上产生了最先进的结果。</p><p id="6c72" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">欢迎读者访问我的脸书粉丝页面，这是一个分享关于机器学习的东西的页面:<a class="ae lk" href="https://www.facebook.com/diveintomachinelearning" rel="noopener ugc nofollow" target="_blank">深入机器学习</a>。我关于物体检测的其他著名帖子也可以在<a class="ae lk" rel="noopener" target="_blank" href="/yolov4-5d-an-enhancement-of-yolov4-for-autonomous-driving-2827a566be4a">yolov 4–5D评论</a>和<a class="ae lk" rel="noopener" target="_blank" href="/darkeras-execute-yolov3-yolov4-object-detection-on-keras-with-darknet-pre-trained-weights-5e8428b959e2"> Darkeras </a>找到。</p><p id="b151" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>