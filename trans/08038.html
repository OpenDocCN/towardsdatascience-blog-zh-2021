<html>
<head>
<title>Making AI models more robust more efficiently</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让人工智能模型更强大更高效</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-models-more-robust-more-efficiently-e8737178452c?source=collection_archive---------16-----------------------#2021-07-23">https://towardsdatascience.com/making-models-more-robust-more-efficiently-e8737178452c?source=collection_archive---------16-----------------------#2021-07-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6e24" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">行业笔记</a></h2><div class=""/><div class=""><h2 id="3707" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">将机器学习模型部署到现实世界容易发现领域覆盖问题。一种使模型稳健的方法是生成看不见的数据，而模型需要处理这些数据。基于属性的测试可以解决这个问题！</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/d5ede7f121c96a27351b36d37f8e6a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z7VgaH6V1E9UIzD9"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">基于属性的测试旨在维护给定操作域的某个属性，允许我们估计模型的健壮性。图片作者。</p></figure><p id="f7e0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在<a class="ae ma" rel="noopener" target="_blank" href="/why-dont-we-test-machine-learning-as-we-test-software-43f5720903d">上一篇关于测试</a>机器学习模型的文章中，我们研究了软件测试和如何在MLOps领域中使用这些策略之间的相似之处。我们表明，基于静态数据集的评估模型性能的方法不足以全面检查高维空间中模型的准确性。更深入了解模型稳健性的一种方法是通过基于属性的测试等方法，这些方法根据某些规范合成输入数据，以打破模型！</p><h2 id="a29c" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">但是测试如何能使你的模型在训练时更加健壮和有效呢？</h2><p id="acd4" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">首先，让我们从谈论预期的操作域开始。换句话说，我们期望我们的输入来自哪个数据域——我们期望观察到什么类型的变化、约束、极值？例如，在计算机视觉领域，我们可以开始描述一天中的时间、气象条件，甚至关于观测本身的属性——物体的大小和类型，它们如何变化以及什么需要保持固定。</p><p id="bc69" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这允许我们定义变化轴，或数据的不同可变性。对于一个很少数字输入的小问题，很容易找到一个导致模型性能差的变换输入。但是，如果输入是一个图像，我们该如何做呢？假设我们想将白天的图像转换成夜晚的样子。</p><p id="c271" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在<a class="ae ma" rel="noopener" target="_blank" href="/why-dont-we-test-machine-learning-as-we-test-software-43f5720903d">的上一篇博文</a>中，我们谈到了将数据样本从数据域转换到运营域，沿着时间轴执行更改，然后再转换回数据域。在下图中，我们可以看到一只鹿的图像，它的整个身体被捕捉到，头和鹿角朝向我们。我们可以列举描述图像的其他属性，例如它是在黎明时拍摄的，它包含了背景中的各种灌木和树木，等等。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5a256fac351c4f75184e8bd4b554e646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EB9lMEAbf2cKc0mI"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">我们可以将一天中的时间属性从黎明改为傍晚。作者配图。</p></figure><p id="f3df" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果我们想确保我们的汽车，在州内高速公路系统中行驶，能够识别鹿，并且不管一天中的时间或假设的背景如何，它都能这样做。这意味着我们现在可以改变这些属性，并评估模型的整体稳健性。在工业应用中，收集的数据将最大化以尽可能覆盖模型的操作域。然而，在最好的情况下，观察跨越整个操作领域的数据是不切实际的，在最坏的情况下也是不可能的，这导致部署的机器学习算法从未在该领域的一些领域中被评估。数据的过度收集不仅会导致管理问题、增加注释成本，还会导致算法迭代变慢。如果我们不能明确地列举数据域，那么推断我们期望ML模型在其中工作的操作域就容易得多。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/07d0ec6974cc79e212ebd349772f9dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_Bh1SiquVFT5vqCS"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">在这种情况下，我们将对象的背景从树木改为公路。作者的图表和Sebastian Palomino的照片。</p></figure><p id="9080" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在每个培训阶段结束时，ML模型需要在部署到相应的操作域之前进行测试。然而，在Efemarai，我们认为鲁棒性评估不需要在MLOps周期结束时进行，而是可以作为培训管道的一部分进行整合。</p><h2 id="6f44" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">测试平台</h2><p id="3491" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated"><a class="ae ma" href="https://efemarai.com" rel="noopener ugc nofollow" target="_blank"> Efemarai </a>是一个测试和强健ML模型的平台。它的工作原理是在问题的操作域中找到导致模型性能不佳的边缘案例。它使开发人员能够轻松地将他们现有的ML资产(模型、数据、代码)与规范和测试相集成，以发现这些健壮性问题。</p><p id="7bed" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">因此，您可以获得一个健壮性覆盖图，使开发人员能够沿着多个轴(与行业标准准确性、f1分数、混淆矩阵等一起)监控进度，以获得对部署模型的信心，并为非技术利益相关方(如业务领导、经理、用户和监管机构)提供见解。</p><p id="fec8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">例如，UI/UX设计师可以利用这些见解引导用户走上一条人工智能模型运行良好的道路，并将遇到问题的几率降至最低。</p><p id="8480" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">此外，产生的具有边缘情况的新的合成数据集对ML模型的性能具有直接影响。它有多种用途，在本文的其余部分，我们将说明如何将这些边缘案例样本添加到训练数据集中，不仅对准确性和f1分数，而且对模型的整体稳健性产生直接和可测量的影响。与穷举搜索相比，它加快了迭代和训练时间，从而最小化了所需的资源。</p><h2 id="0f2f" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">ML模型鲁棒性挑战</h2><p id="5e72" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">汽车行业和资产管理中的一个常见问题是识别交通标志。对于那些在现实世界中可以观察到的任何扰动，从一天中的时间、准确的前景、观察角度到天气条件或规模，都必须极其准确和稳健。</p><p id="31d1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们使用德国交通标志识别基准数据集，并尝试在最少的时间内训练最鲁棒的模型。因此，我们将对领域覆盖健壮性和训练速度进行基准测试。</p><p id="4539" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们将使用相同的ImageNet预训练模型测试以下条件:</p><ul class=""><li id="1a81" class="my mz iq lg b lh li lk ll ln na lr nb lv nc lz nd ne nf ng bi translated">a:没有任何额外扰动和变换的有效网络模型；</li><li id="bf25" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">b:用<a class="ae ma" href="https://pytorch.org/vision/master/transforms.html?highlight=autoaugment#torchvision.transforms.AutoAugment" rel="noopener ugc nofollow" target="_blank">自动增强</a>训练的高效网络模型；</li><li id="46c3" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">c:用所有可能的扰动和变换训练的有效网络模型；</li><li id="d247" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">d:使用Efemarai平台生成的附加数据，在没有额外扰动和转换的情况下训练的EfficientNet模型。</li></ul><h2 id="81d4" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">ML鲁棒性结果</h2><p id="c6db" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">让我们首先强调现代神经网络作为通用特征近似器的巨大能力，因为在所有情况下，模型都达到了97%以上的准确度。这也显示了一些问题，比如一项新技术可能会改善百分之零点几的结果，但很难评估现实生活中可能会导致什么样的改善。这正是领域覆盖图可以提供帮助的地方。</p><p id="4774" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">但首先，让我们从达到的准确度和训练时间开始:</p><ul class=""><li id="4bb9" class="my mz iq lg b lh li lk ll ln na lr nb lv nc lz nd ne nf ng bi translated">模型A: 98.6%，2分0秒，20个周期</li><li id="e7ab" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">B型:97.4%，2分22秒，20个周期</li><li id="d902" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">模型C: 97.0%，20个周期8分20秒</li><li id="2480" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">模型D: 99.3%，20个周期3分34秒</li><li id="39f8" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">D型*: 98.6%，<strong class="lg ja"> 15个周期</strong>2分40秒</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nm"><img src="../Images/3efd7b453855d961bb0e42706f63e564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-f68Fan3ym9em3SGS4aaHA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">不同车型的训练力度。图片作者。</p></figure><p id="61ac" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">从上述结果中，我们可以看到所有模型都表现良好，并且添加不同的扰动在某些情况下可以显著增加训练时间(2分钟对8分钟以上)。使用Efemarai平台数据的D型在3分30秒内达到最高精度。如果我们尝试匹配第二好的模型的准确性，它将花费少于25%的时期，并且将几乎匹配最快的训练模型的墙时间。相比之下，它比使用所有增强功能快近3倍。这突出表明，针对模型表现不佳区域的智能转换对整体性能的影响要比统一采样的盲增强高得多。</p><p id="6b82" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在让我们看看健壮性覆盖图。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nn"><img src="../Images/24eb45e5d1bd0a10f7fa59afac32d664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5P9AcIXOM5mNEH4iI_KMoQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">域覆盖图。图片作者。</p></figure><p id="f2dc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">上面的径向图显示了每个模型在特定扰动下的稳健性水平。目标是最大程度地鲁棒并完全填充相应的切片。我们有颜色分组扰动，基于它们的类别，如几何的，颜色的，或本质上基于噪声的。</p><p id="db52" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">首先，我们要强调的是，经过零转换训练的原始模型A非常容易受到在数据集中看不到的扰动的影响！业绩下降30%以上。考虑操作领域是将模型从开发过渡到部署的一个非常重要的步骤，尤其是影响业务度量的情况。</p><p id="e366" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在几何和一些基于噪声的扰动方面，使用Efemarai平台训练的模型D的鲁棒性有了显著提高，并显示出整体最佳的鲁棒性。它将性能最低的案例从大约50%提高到80%以上，这是一个显著的改进！</p><p id="8a18" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">值得注意的是，即使训练时间比模型c少3倍，ML模型D的稳健性的额外数据也能带来多大的改善。</p><p id="8620" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">平台的使用和生成的看不见的数据导致模型性能的直接改进、在与用户操作期间观察到的更少的极限情况，以及对需要收集什么类型的数据的理解。在下一篇博文中，我们将展示这个平台的另一种用途。</p><h2 id="7e86" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">结论</h2><p id="efed" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">在模型开发过程中考虑模型的健壮性，与在部署前最后一步评估模型相比，在迭代速度和达到的性能方面有巨大的回报。我们已经表明，使用基于属性的测试平台进行机器学习，如Efemarai，可以产生更好的模型，更深入地了解性能，并在部署这些模型时更有信心。</p><h2 id="744b" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated"><strong class="ak">关于作者</strong></h2><p id="fa57" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">我是Efemarai的首席技术官兼联合创始人，这是一家早期初创公司，为测试和调试ML模型和数据搭建了一个平台。通过我们的平台，机器学习团队可以跟踪回归，监控改进，并满怀信心地交付他们的ML解决方案。</p><p id="222d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在硅谷和欧盟投资者的支持下，我们正在为人工智能世界带来质量保证，并释放出新的ML应用程序的寒武纪大爆发！</p><p id="e378" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果你想联系我们，请发邮件至team@efemarai.com<a class="ae ma" href="mailto:team@efemarai.com" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>