# 迁移学习:你能学到的最有效的深度学习技能

> 原文：[https://towardsdatascience.com/transfer-learning-in-deep-learning-641089950f5d?source=collection_archive---------23-----------------------#2021-10-26](https://towardsdatascience.com/transfer-learning-in-deep-learning-641089950f5d?source=collection_archive---------23-----------------------#2021-10-26)

## 当你开始一个新的深度学习项目时，迁移学习将大大减少培训时间和成本

![](../Images/659fbd08d1fa65256d2163eb8f82f43f.png)

你可以使用狗分类器深度学习模型来训练和识别使用转移学习的猫——图片来自 [Pixabay](https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=3715733) 的 [huoadg5888](https://pixabay.com/users/huoadg5888-8934889/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=3715733)

训练深度学习模型可能需要几天、几周甚至几个月的时间。

迁移学习可以解决这个问题。这是一种机器学习方法，训练好的模型被重新用作新任务的起点。这加快了培训速度，并提高了相关问题的绩效。

这是深度学习中最受欢迎的方法之一，因为它 ***通过重用与你自己的任务结构相似的其他任务中预先训练的模型*** 来节省时间和金钱。在这篇文章中，你将了解迁移学习是如何工作的，以及如何使用它来加速你的深度学习训练过程！

# 什么是迁移学习？

迁移学习是一种机器学习技术，其中在特定任务上训练的模型被重用为另一个不同任务的训练过程的一部分。

这里有一个简单的类比来帮助你理解迁移学习是如何工作的:想象一个人已经学会了关于狗的所有知识。相比之下，另一个人对猫了如指掌。如果两个人都被问到，“什么动物有四条腿，一条尾巴，会叫？”对狗了如指掌的人会回答“狗”，而对猫了如指掌的人会说“猫”

因为两个人都已经知道了解决手头问题所需的一半信息，所以每个人只需在正确回答之前填写他们缺少的信息。这就是迁移学习在机器学习中的工作方式。将一个模型了解到的某些特性的信息与另一个模型了解的其他特性的信息结合起来，可以产生一个新的任务。

# 如何利用迁移学习？

既然你知道迁移学习是如何工作的，你可能想知道如何让它为你自己的机器学习模型工作。有两种不同的方法可以做到这一点:特征提取和微调。

![](../Images/2c612c2cf82ca49f84294528f83c0394.png)

迁移学习中的特征提取和微调—图片作者[作者](https://thuwarakesh.medium.com)

**特征提取:**如果你想将知识从一个机器学习模型转移到另一个模型，但不想在你的数据集上重新训练第二个更大的模型，那么特征提取是最好的方法。这是可能的，因为你可以从一个模型中学习特征，并训练另一个更小的模型。结合微调使用，此过程可以在短时间内为您提供出色的结果。

**微调:**如果你已经在训练自己的深度学习模型，或者想为你的数据集微调现有模型的输出，这种方法可能很适合你。通过使用较小的模型向较大的模型学习，您可以从较大的模型已经完成的任何工作中受益，而不必经历自己训练它的所有麻烦。因此，这种方法比单独的特征提取更快更有效。

## 将学习从预训练模型转移到新模型的步骤。

迁移学习程序包括这五个步骤。如果你使用 Keras 来建立你的深层网络，这里有一些步骤和方法。

**从预先训练的模型中提取层。** 这些层包含实现任务的一般设置信息。通常情况下，他们会接受大量数据集的预训练。在 Keras 中，您可以通过在加载预训练模型时指定`include_top=False`来轻松消除它。

**冻结图层。**
这确保了来自先前模型的信息在将来的训练中不会被破坏。在 Keras 中，可以使用“可训练”选项在冻结和解除冻结模式之间切换层。

**通过添加可训练层来扩展冻结模型。**
这些新层将学习根据您的具体问题调整预训练模型。下面是向 Keras 模型添加新层的一种方法。

**在数据集上训练新图层。**

在预训练模型上使用新数据集时，指定一个小的学习率。小的比率确保模型不会严重偏离原始模型。慢慢的，新的模式会适应新的问题。

**微调(可选):解冻整个模型，并在新数据集上重新训练它。** 使用`model.trainable=False`将整个模型设置为自由学习。现在按照前面的步骤用小的学习率进行训练。

# 正迁移和负迁移学习

迁移学习有两种类型:负迁移和正迁移。在一个任务上训练的模型所获得的所有知识都会应用到一个新的任务上，但并不是所有的知识都会有益地迁移，这种差异就是负迁移和正迁移的来源。

![](../Images/8a43e6cce22a3877e61d7f444beb6f6d.png)

深度学习模型的正负迁移学习。—图片由[作者](https://thuwarakesh.medium.com)提供

当在一项任务(例如，使用深度神经网络的数字分类)上训练的模型未能完成另一项任务(例如，图像分类任务)时，就会发生负迁移，因为从先前训练中获得的知识会渗透到新任务的执行中。这种类型的干扰表现在新任务中模型性能的退化。

当一些学到的知识有助于提高新任务的结果时，就会发生正迁移。它通过利用以前在相关任务中的学习经验来学习如何更快地执行它。这是有益的，因为你不必花太多时间在第二个新任务上。

# 流行深度学习模型中的迁移学习

用作迁移学习一部分的不同类型的模型如下:

**卷积神经网络:**当输入数据是一组图像时，使用这些模型。卷积神经网络的输入是表示像素的二维数组。模型每一层的输出可以被认为代表了图像的不同部分。这是因为这些类型的网络将输入映射到一组不同的输出，每一个都负责表示图像的特定部分。

示例:参见 [VGG16 和 VGG19](https://keras.io/api/applications/vgg/#vgg16-function) 。这里有一篇由杰森·布朗利[撰写的](https://medium.com/u/f374d0159316?source=post_page-----641089950f5d--------------------------------)[详细博客文章](https://machinelearningmastery.com/how-to-use-transfer-learning-when-developing-convolutional-neural-network-models/)

**递归神经网络:**当输入数据具有时间性质时，如文本或时间序列数据，使用这些模型。在这些情况下，通常来自先前点的信息会影响在未来时间点学习到的信息。这使得递归神经网络非常适合这种类型的数据，因为它们基于环路，允许网络具有记忆并从以前的信息中学习。

例如: [Timenet，一个经过训练从时间序列数据中提取特征的 RNN](https://arxiv.org/pdf/1706.08838.pdf)

**生成对抗网络:**这些模型通过获取关于生成一组图像的知识并将其应用于另一组图像，来使用迁移学习。例如，GANs 可以被训练生成与以前看到的手写数字相似的新样本。然而，这只是这个模型如何用于迁移学习的一个例子。

例子: [DCGAN-TensorFlow，深度卷积生成对抗网络](https://modelzoo.co/model/dcgan-tensorflow)

**自动编码器:**自动编码器是一种特殊类型的模型，用于压缩和解压缩信息。有两种类型的自动编码器:一种将原始数据编码成压缩表示(编码自动编码器)，另一种试图从这种压缩表示中重建原始图像(重建自动编码器)。这些模型可以非常有效地找到输入数据的压缩表示，然后可以用作迁移学习的一部分。

例子:这里有一个由 Sreenivas Bhattiprolu 制作的 Youtube 视频。

# 总而言之，

迁移学习是一种加速深度学习训练的惊人方法。它有助于用已有的知识解决复杂的问题。迁移学习的核心是使用针对一个问题训练的深度学习模型作为解决另一个问题的起点。

本文涵盖了使用迁移学习的基础和好处。如果使用迁移学习，数据科学家可以在更短的时间内训练新模型，而不会消耗大量预算。此外，当针对新问题的训练样本较少时，迁移学习是一个救星。

在大多数情况下，您可以用简单的模型解决组织问题。如果你有兴趣了解它们，可以看看这些文章。

[](/the-1-mistake-companies-make-when-creating-their-data-science-foundation-ff775d9e20b1) [## 公司在创建数据科学基础时犯的头号错误

### 85%的数据科学项目失败的原因很简单。

towardsdatascience.com](/the-1-mistake-companies-make-when-creating-their-data-science-foundation-ff775d9e20b1) [](/is-deep-learning-right-for-you-b59a2219c457) [## 如何评价深度学习是否适合自己？

### 可能不会！在浪费时间之前，这里是你需要知道的

towardsdatascience.com](/is-deep-learning-right-for-you-b59a2219c457) 

> 朋友，谢谢你的阅读。看来你和我有许多共同的兴趣。 ***跟我打招呼*** *上* [*领英*](https://www.linkedin.com/in/thuwarakesh/)*[*推特*](https://twitter.com/Thuwarakesh)*[*中*](https://thuwarakesh.medium.com/subscribe) *。我会为你打破僵局。***

**还不是中等会员？请使用此链接 [**成为会员**](https://thuwarakesh.medium.com/membership) 因为我为你免费推荐赚取佣金。**