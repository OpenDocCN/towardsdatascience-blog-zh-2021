<html>
<head>
<title>Making the Anomaly Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">制作异常数据库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-the-anomaly-database-d81471f9ddaf?source=collection_archive---------27-----------------------#2021-08-19">https://towardsdatascience.com/making-the-anomaly-database-d81471f9ddaf?source=collection_archive---------27-----------------------#2021-08-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7a10" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">这是与Docker、Postgres数据库和异常数据集相关的两篇文章的第二部分。阅读</em> <a class="ae kg" rel="noopener" target="_blank" href="/docker-based-rstudio-postgresql-fbeefe8285bf"> <em class="kf">第一部分</em> </a> <em class="kf">，它将教你如何使用Docker建立一个新的postgres数据库。</em></h2></div><p id="daf2" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">这篇文章描述了如何填充在第1部分中构建的异常数据库。</p><h1 id="f9dc" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">动机</h1><p id="eff8" class="pw-post-body-paragraph kh ki iq kj b kk lv jr km kn lw ju kp kq lx ks kt ku ly kw kx ky lz la lb lc ij bi translated">继续端到端可再现工作流的主题，我还希望能够以编程方式重新创建我的原始数据库。</p><p id="0bf0" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">在这项活动结束时，我能够快速加载和管理大约6G的数据供我个人使用。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/3e96c96964973ee8974a3ecad99aa545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6zEYDDA6sevQpduj.gif"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">大量数据，可使用VSCode快速浏览。来源:作者。</p></figure><p id="564d" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">填充数据库的全部代码都在我的<a class="ae kg" href="https://github.com/rsangole/anomaly_db" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中。</p><h1 id="cc5e" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">谁应该读这个？</h1><p id="6aaa" class="pw-post-body-paragraph kh ki iq kj b kk lv jr km kn lw ju kp kq lx ks kt ku ly kw kx ky lz la lb lc ij bi translated">如果你习惯使用<code class="fe mq mr ms mt b">download.file()</code>、系统命令、<code class="fe mq mr ms mt b">arff</code>文件格式和<code class="fe mq mr ms mt b">{DBI}</code>，你在这里不会学到很多东西。如果你对我的方法感兴趣，请继续阅读。</p><h1 id="8507" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">步伐</h1><p id="40ec" class="pw-post-body-paragraph kh ki iq kj b kk lv jr km kn lw ju kp kq lx ks kt ku ly kw kx ky lz la lb lc ij bi translated">这里只有三个文件:</p><ol class=""><li id="f344" class="mu mv iq kj b kk kl kn ko kq mw ku mx ky my lc mz na nb nc bi translated">初始设置(<code class="fe mq mr ms mt b"><a class="ae kg" href="https://github.com/rsangole/anomaly_db/blob/master/00-execute.R" rel="noopener ugc nofollow" target="_blank">00-execute.R</a></code>)</li><li id="de76" class="mu mv iq kj b kk nd kn ne kq nf ku ng ky nh lc mz na nb nc bi translated">从网上下载数据(<code class="fe mq mr ms mt b"><a class="ae kg" href="https://github.com/rsangole/anomaly_db/blob/master/01-download-data.R" rel="noopener ugc nofollow" target="_blank">01-download-data.R</a></code>)</li><li id="eacd" class="mu mv iq kj b kk nd kn ne kq nf ku ng ky nh lc mz na nb nc bi translated">将数据加载到PostgreSQL中的<code class="fe mq mr ms mt b">anomaly</code>数据库(<code class="fe mq mr ms mt b"><a class="ae kg" href="https://github.com/rsangole/anomaly_db/blob/master/02-load-data-to-postgres.R" rel="noopener ugc nofollow" target="_blank">02-load-data-to-postgres.R</a></code>)</li></ol><h1 id="48e1" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">初始设置</h1><p id="e8bb" class="pw-post-body-paragraph kh ki iq kj b kk lv jr km kn lw ju kp kq lx ks kt ku ly kw kx ky lz la lb lc ij bi translated">列表有助于跟踪数据来源，并帮助我关闭任何下载以节省空间/时间(例如，Monash是一个大约2G的下载)。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="3f76" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">一些简单的内务处理，以确保目录设置正确。此外，如果文件夹是git控制的，存放数据集<code class="fe mq mr ms mt b">large_data</code>的目录需要在<code class="fe mq mr ms mt b">.gitignore</code>中。我检查这个。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="7d52" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">下载数据</h1><p id="5ace" class="pw-post-body-paragraph kh ki iq kj b kk lv jr km kn lw ju kp kq lx ks kt ku ly kw kx ky lz la lb lc ij bi translated">现在，对于上面列表中的数据集，只需使用<code class="fe mq mr ms mt b">download.file()</code>下载所选数据集的数据，并将它们移动/解压缩到<code class="fe mq mr ms mt b">large_data</code>文件夹。我还在检查文件夹是否已经存在，我想覆盖它。</p><p id="323b" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">这里有一个UCR数据集的例子。其余数据集的代码非常相似。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="3527" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">加载数据</h1><p id="e5f0" class="pw-post-body-paragraph kh ki iq kj b kk lv jr km kn lw ju kp kq lx ks kt ku ly kw kx ky lz la lb lc ij bi translated">现在，它就像:</p><ol class=""><li id="b9d0" class="mu mv iq kj b kk kl kn ko kq mw ku mx ky my lc mz na nb nc bi translated">使用<code class="fe mq mr ms mt b">DBI::dbConnect</code>连接到PostgreSQL数据库</li><li id="0558" class="mu mv iq kj b kk nd kn ne kq nf ku ng ky nh lc mz na nb nc bi translated">从<code class="fe mq mr ms mt b">large_data/</code>读取数据集</li><li id="d200" class="mu mv iq kj b kk nd kn ne kq nf ku ng ky nh lc mz na nb nc bi translated">简单清理(<code class="fe mq mr ms mt b">janitor::clean_names</code>，所有时间戳列被称为<code class="fe mq mr ms mt b">time</code>等)</li><li id="2914" class="mu mv iq kj b kk nd kn ne kq nf ku ng ky nh lc mz na nb nc bi translated">使用<code class="fe mq mr ms mt b">DBI::dbWriteTable</code>将数据加载到postgres中</li></ol><p id="bed1" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated">下面是一个示例代码:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="dfe6" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><em class="nk">对于monash数据集，你确实需要使用</em> <code class="fe mq mr ms mt b"><a class="ae kg" href="https://stat.ethz.ch/R-manual/R-devel/library/foreign/html/read.arff.html" rel="noopener ugc nofollow" target="_blank"><em class="nk">foreign::read.arff()</em></a></code> <em class="nk">。</em></p><h1 id="cb88" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">技巧</h1><p id="9789" class="pw-post-body-paragraph kh ki iq kj b kk lv jr km kn lw ju kp kq lx ks kt ku ly kw kx ky lz la lb lc ij bi translated"><strong class="kj ir">大文件下载</strong>将在1分钟的默认超时窗口内超时。在调用<code class="fe mq mr ms mt b">download.file()</code>之前处理这个。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="3c40" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kj ir">数据字典</strong>也可以直接存储在数据库中。我将<code class="fe mq mr ms mt b">UCR_Archive2018/*</code>文件夹中每个<code class="fe mq mr ms mt b">README.md</code>的内容存储在一个名为<code class="fe mq mr ms mt b">ucr_00_meta</code>的数据字典表中。这允许我在下游开发中编程调用字典。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nl"><img src="../Images/a1624e88c7eca5872d82baeae3df9fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DWxaPE9oLLpsHEiH.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">UCR数据集的数据字典。来源:作者。</p></figure><p id="b432" class="pw-post-body-paragraph kh ki iq kj b kk kl jr km kn ko ju kp kq kr ks kt ku kv kw kx ky kz la lb lc ij bi translated"><strong class="kj ir">闪亮</strong>可以有效用于快速探索。这是一个我为自己建造的东西的例子。仪表板直接从PostgreSQL提取数据。UCR元数据也从呈现在每个页面顶部的数据库中提取，从而可以快速浏览数据集。随着我添加更多数据集，我不断扩展这个仪表板。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/c2a06376c8c6f9746e1af6a06bb7e9be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ykOB01PWhXikTQwQ.gif"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">闪亮的仪表板快速可视化数据。来源:作者。</p></figure></div></div>    
</body>
</html>