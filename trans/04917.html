<html>
<head>
<title>Data Apps with Python’s Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的Streamlit的数据应用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-apps-with-pythons-streamlit-b14aaca7d083?source=collection_archive---------3-----------------------#2021-04-29">https://towardsdatascience.com/data-apps-with-pythons-streamlit-b14aaca7d083?source=collection_archive---------3-----------------------#2021-04-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b885" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以最快的方式将脚本转换成应用程序的基础知识</h2></div><p id="faa2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Streamlit是一个易于使用的框架，非常适合构建web应用程序，而无需纠结于布局、事件处理程序或文档树。</p><p id="b47d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其友好的方法使其成为探索数据集、展示机器学习模型、计算机视觉、自然语言处理、数据可视化和许多其他以数据为中心的项目的一个伟大工具。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/c1386c908fb993dfa420030542b03db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-nwlf7_REsE4XM4ZeP2rw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">快速回顾—由作者使用Streamlit制作—图片</p></figure><p id="9fd8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将构建一个简单的应用程序来使用Streamlit探索和转换数据集。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="0ad4" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">入门指南</h2><p id="74af" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">安装之后，我们将创建一个名为<code class="fe mz na nb nc b">app.py</code>的文件，并从一些简单的东西开始。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="c595" class="mb mc it nc b gy nh ni l nj nk">#/app.py<br/>import streamlit as st #<!-- -->pip install streamlit</span><span id="1648" class="mb mc it nc b gy nl ni l nj nk">st.title('Explore a dataset')</span></pre><p id="23cd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的环境终端中，我们可以转到保存脚本的目录，使用下面的命令运行Streamlit，一旦启动，它将打开我们的默认浏览器并显示我们的页面。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="babd" class="mb mc it nc b gy nh ni l nj nk">streamlit run app.py</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/a8f40d5b2f3081a973f4392bd6207c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*u1OvYSBc4jLLFxTODtswYA.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">Streamlit run —作者截图</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nn"><img src="../Images/826c39c8c8263faf7fa00e83764c9a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZWHP-KvT5iQMisAmRAehg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">没有地方比得上localhost—作者截图</p></figure><p id="a1dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">厉害！现在让我们添加一些文本到我们的文件，并再次保存它。</p><p id="1332" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦我们保存，Streamlit将检测到更改，并让我们重新运行或总是重新运行页面。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="937f" class="mb mc it nc b gy nh ni l nj nk"># app.py<br/>import streamlit as st</span><span id="31d0" class="mb mc it nc b gy nl ni l nj nk">st.title('Explore a dataset')<br/>st.write('A general purpose data exploration app')</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi no"><img src="../Images/33e50e02bc48e0e0ef210c8bdc343c23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*glH3OT0FJtZMxyahfDZk2g.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">重新运行按钮—作者截屏</p></figure><p id="c22c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果Streamlit由于某种原因没有检测到更改，或者没有任何更改，但是您想要重新运行它，您可以在右上角的菜单中找到此选项。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi no"><img src="../Images/feee3da65c1ddbdd32a03389a30d3a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u07sKqb6_20veQTj-vLJqQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">更新页面—作者截图</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="efef" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">导入数据</h2><p id="4bd8" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">我想构建一些简单的东西来对数据集进行一些快速的预探索和转换。在开始分析之前，我可以在某个地方验证数据并做一些小的调整。</p><p id="f7c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以从通常的<code class="fe mz na nb nc b">pd.read_csv(file_path)</code>开始。但是我想要更动态的东西，我可以改变文件，而不必写代码。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="f0f8" class="mb mc it nc b gy nh ni l nj nk">import streamlit as st</span><span id="e353" class="mb mc it nc b gy nl ni l nj nk">st.title('Explore a dataset')<br/>st.write('A general purpose data exploration app')</span><span id="1cf5" class="mb mc it nc b gy nl ni l nj nk">file = st.file_uploader("Upload file", type=['csv'])</span><span id="6d32" class="mb mc it nc b gy nl ni l nj nk">st.write(file)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi np"><img src="../Images/5706f12f8160b11336cc628bca1db1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgaR4NX4ApDvmxOS5FRpWA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">文件上传者—作者截图</p></figure><p id="1694" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就这样，我们有了一种将文件上传到应用程序的方法。如果没有上传文件，它将返回None，但是如果我们上传了一个扩展名正确的文件，它会给我们一个包含该文件的对象。</p><p id="e085" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">返回的对象是BytesIO的子类，我们可以像使用任何其他文件一样使用它——这意味着我们用Pandas读取它不会有任何问题。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nq"><img src="../Images/8c206e26b3a0be95af93c8a9d73913c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lpbcjt4KQcLFtN7f_oHfCg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">文件上传者—作者截图</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="cb69" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">写作</h2><p id="a6d7" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">我们可以检查文件是否已上传，然后毫不费力地用熊猫阅读。让我们获取一些关于数据集的信息，并尝试显示它。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="a738" class="mb mc it nc b gy nh ni l nj nk">import streamlit as st<br/>import pandas as pd</span><span id="a02e" class="mb mc it nc b gy nl ni l nj nk">def explore(df):<br/>  # DATA<br/>  st.write('Data:')<br/>  st.write(df)</span><span id="fa48" class="mb mc it nc b gy nl ni l nj nk">  # SUMMARY<br/>  df_types = pd.DataFrame(df.dtypes, columns=['Data Type'])<br/>  numerical_cols = df_types[~df_types['Data Type'].isin(['object',<br/>                   'bool'])].index.values</span><span id="54f9" class="mb mc it nc b gy nl ni l nj nk">  df_types['Count'] = df.count()<br/>  df_types['Unique Values'] = df.nunique()<br/>  df_types['Min'] = df[numerical_cols].min()<br/>  df_types['Max'] = df[numerical_cols].max()<br/>  df_types['Average'] = df[numerical_cols].mean()<br/>  df_types['Median'] = df[numerical_cols].median()<br/>  df_types['St. Dev.'] = df[numerical_cols].std()</span><span id="02b9" class="mb mc it nc b gy nl ni l nj nk">  st.write('Summary:')<br/>  st.write(df_types)</span><span id="9665" class="mb mc it nc b gy nl ni l nj nk">def get_df(file):<br/>  # get extension and read file<br/>  extension = file.name.split('.')[1]</span><span id="367c" class="mb mc it nc b gy nl ni l nj nk">  if extension.upper() == 'CSV':<br/>    df = pd.read_csv(file)<br/>  elif extension.upper() == 'XLSX':<br/>    df = pd.read_excel(file, engine='openpyxl')<br/>  elif extension.upper() == 'PICKLE':<br/>    df = pd.read_pickle(file)</span><span id="e313" class="mb mc it nc b gy nl ni l nj nk">  return df</span><span id="4927" class="mb mc it nc b gy nl ni l nj nk">def main():<br/>  st.title('Explore a dataset')<br/>  st.write('A general purpose data exploration app')</span><span id="290f" class="mb mc it nc b gy nl ni l nj nk">file = st.file_uploader("Upload file", type=['csv' <br/>                                             ,'xlsx'<br/>                                             ,'pickle'])</span><span id="daab" class="mb mc it nc b gy nl ni l nj nk">  if not file:<br/>    st.write("Upload a .csv or .xlsx file to get started")<br/>    return</span><span id="d867" class="mb mc it nc b gy nl ni l nj nk">  df = get_df(file)<br/>  explore()</span><span id="c2f8" class="mb mc it nc b gy nl ni l nj nk">main()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nr"><img src="../Images/89693f6f677b04a8f33846724b0aa9a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8UiDUDkpi7xlTBuVB_nAhQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">数据框-作者截图</p></figure><p id="8baf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mz na nb nc b">write</code>方法不仅仅用于文本；我们可以用它来显示列表、字典、Pandas数据框、Matplotlib图形、Plotly、Altair、Graphviz以及许多其他内容。我们甚至可以通过设置参数<code class="fe mz na nb nc b">unsafe_allow_html=True</code>来编写HTML。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="82d3" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">输入</h2><p id="2e4c" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">我们将使用<code class="fe mz na nb nc b">slider</code>来帮助我们对数据集的一部分进行采样，并使用<code class="fe mz na nb nc b">multiselect</code>来选择我们想要的列。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="0e9d" class="mb mc it nc b gy nh ni l nj nk">import streamlit as st<br/>import pandas as pd</span><span id="abd6" class="mb mc it nc b gy nl ni l nj nk">def explore(df)...</span><span id="dad8" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">def transform(df):<br/>  # Select sample size<br/>  frac = st.slider('Random sample (%)', 1, 100, 100)<br/>  if frac &lt; 100:<br/>    df = df.sample(frac=frac/100)</strong></span><span id="3617" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  # Select columns<br/>  cols = st.multiselect('Columns', <br/>                        df.columns.tolist(),<br/>                        df.columns.tolist())<br/>  df = df[cols]</strong></span><span id="1b69" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  return df</strong></span><span id="b0cc" class="mb mc it nc b gy nl ni l nj nk">def get_df(file)...</span><span id="4fc7" class="mb mc it nc b gy nl ni l nj nk">def main():<br/>  st.title('Explore a dataset')<br/>  st.write('A general purpose data exploration app')</span><span id="469a" class="mb mc it nc b gy nl ni l nj nk">  file = st.file_uploader("Upload file", type=['csv'])</span><span id="d553" class="mb mc it nc b gy nl ni l nj nk">  if not file:<br/>    st.write("Upload a .csv or .xlsx file to get started")<br/>    return</span><span id="c1c6" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  </strong>df = get_df(file)<strong class="nc iu"><br/>  df = transform(df)</strong></span><span id="9362" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  </strong>explore(df)</span><span id="5cf9" class="mb mc it nc b gy nl ni l nj nk">main()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ns"><img src="../Images/adf67c640e676ebeb00ef116bd498618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9CuUkVui9tuqUJF1LXv-4w.gif"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">重新运行按钮—作者截屏</p></figure><p id="1139" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们如何使用Streamlit设置输入非常简单，他们有一系列类似的组件来帮助我们构建应用程序。</p><p id="5ede" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">文件_上传器</strong>，<strong class="kk iu">滑块</strong>，<strong class="kk iu">选择_滑块</strong>，<strong class="kk iu">选择框</strong>，<strong class="kk iu">多选</strong>，<strong class="kk iu">颜色_选择器</strong>，<strong class="kk iu">文本_输入</strong>，<strong class="kk iu">数字_输入</strong>，<strong class="kk iu">文本_区域</strong>，<strong class="kk iu">时间_输入</strong>，<strong class="kk iu">日期_输入</strong>，<strong class="kk iu"/></p><p id="0d77" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的页面开始变大，我仍然想添加更多的探索组件和更多的转换。</p><p id="a07c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，侧边栏是一个方便的类。我们可以将控件添加到侧边栏，节省页面空间，但我想使用侧边栏来选择我们将使用应用程序的哪一部分。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="a2d7" class="mb mc it nc b gy nh ni l nj nk">import streamlit as st<br/>import pandas as pd</span><span id="e6b4" class="mb mc it nc b gy nl ni l nj nk">def explore(df): ...</span><span id="014d" class="mb mc it nc b gy nl ni l nj nk">def transform(df): ...</span><span id="3f03" class="mb mc it nc b gy nl ni l nj nk">def get_df(file): ...</span><span id="d4e8" class="mb mc it nc b gy nl ni l nj nk">def main():<br/>  st.title('Explore a dataset')<br/>  st.write('A general purpose data exploration app')</span><span id="3e1b" class="mb mc it nc b gy nl ni l nj nk">  file = st.file_uploader("Upload file", type=['csv', <br/>                                               'xlsx', <br/>                                               'pickle'])</span><span id="372e" class="mb mc it nc b gy nl ni l nj nk">  if not file:<br/>    st.write("Upload a .csv or .xlsx file to get started")<br/>    return</span><span id="664f" class="mb mc it nc b gy nl ni l nj nk">  df = get_df(file)</span><span id="62d7" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  task = st.sidebar.radio('Task', ['Explore', 'Transform'], 0)</strong></span><span id="7149" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  if task == 'Explore':<br/>    explore(df)<br/>  else:<br/>    transform(df)</strong></span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nt"><img src="../Images/e61a1891ba2b8b13e6663ee4442d9ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0cjNQbacNcLUQC3pGSQaEQ.png"/></div></div></figure><p id="1519" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">需要注意的是，使用Streamlit实现状态并不容易。</p><p id="6fa5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们对Transform进行更改并转到Explore，它将不会保存我们对数据框所做的更改，因为它将重新运行整个应用程序。在这种情况下，唯一不变的是我们上传的文件。</p><p id="caa9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们反其道而行之，文件仍然是一样的，但是来自Transform的所有其他输入将重置为它们的默认位置。</p><p id="bdcc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有一些变通方法——您可以实现一个简单的DB来存储来自用户的输入，并使用会话来了解他们是否已经发送了输入。</p><p id="2e16" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">M Khorasani写了一篇关于用PostgreSQL实现这一点的很棒的文章— <a class="ae nu" rel="noopener" target="_blank" href="/implementing-a-stateful-architecture-with-streamlit-58e52448efa1">用Streamlit实现有状态架构</a>。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="4e09" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">布局</h2><p id="50a6" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">接下来，我们将添加一种方法来转换字段的数据类型。因此，当我们有一个数字或日期作为字符串时，我们可以在开始分析之前轻松处理它。</p><p id="694d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用一个循环为数据集中的每个字段创建一个输入。你可能会想象我们的页面会有很大一部分被这些控件填充，用于一些大的数据集。</p><p id="f8d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">侧边栏非常有用，我们可以用扩展器和栏给页面添加更多的组织。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="225c" class="mb mc it nc b gy nh ni l nj nk">import streamlit as st<br/>import pandas as pd</span><span id="64f6" class="mb mc it nc b gy nl ni l nj nk">def explore(df): ...</span><span id="418e" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">def download_file(df, types, new_types, extension):<br/>  for i, col in enumerate(df.columns):<br/>    new_type = types[new_types[i]]<br/>    if new_type:<br/>      try:<br/>        df[col] = df[col].astype(new_type)<br/>      except:<br/>        st.write('Could not convert', col, 'to', new_types[i])</strong></span><span id="b7e4" class="mb mc it nc b gy nl ni l nj nk">def transform(df):<br/>  frac = st.slider('Random sample (%)', 1, 100, 100)<br/>  if frac &lt; 100:<br/>    df = df.sample(frac=frac/100)<br/>  <br/>  cols = st.multiselect('Columns'<br/>                        ,df.columns.tolist()<br/>                        ,df.columns.tolist())</span><span id="b090" class="mb mc it nc b gy nl ni l nj nk">  df = df[cols]<br/>  <strong class="nc iu">types = {'-':None<br/>           ,'Boolean': '?'<br/>           ,'Byte': 'b'<br/>           ,'Integer':'i'<br/>           ,'Floating point': 'f' <br/>           ,'Date Time': 'M'<br/>           ,'Time': 'm'<br/>           ,'Unicode String':'U'<br/>           ,'Object': 'O'}<br/>  new_types = {}</strong></span><span id="4b4c" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  expander_types = st.beta_expander('Convert Data Types')</strong></span><span id="8975" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  for i, col in enumerate(df.columns):<br/>    txt = 'Convert {} from {} to:'.format(col, df[col].dtypes)<br/>    expander_types.markdown(txt, unsafe_allow_html=True)<br/>    new_types[i] = expander_types.selectbox('Field to be converted:'<br/>                                            ,[*types]<br/>                                            ,index=0<br/>                                            ,key=i)<br/>  st.text(" \n") #break line</strong></span><span id="0dac" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  # first col 15% the size of the second  <br/>  col1, col2 = st.beta_columns([.15, 1])</strong></span><span id="03a5" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  with col1:<br/>    btn1 = st.button('Get CSV')<br/>  with col2:<br/>    btn2 = st.button('Get Pickle')</strong></span><span id="97a4" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  if btn1:<br/>    download_file(df, types, new_types, "csv")<br/>  if btn2:<br/>    download_file(df, types, new_types, "pickle")</strong></span><span id="a6e1" class="mb mc it nc b gy nl ni l nj nk">def get_df(file): ...<br/>def main(): ...</span><span id="0b8d" class="mb mc it nc b gy nl ni l nj nk">main()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nv"><img src="../Images/b5d0d7f83377a33ee0052c512dfa42a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9bveTwHxkoCucSfzbFlE7Q.gif"/></div></div></figure><p id="6a40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好吧。让我们完成将数据帧转换成可下载文件的<code class="fe mz na nb nc b">download_file()</code>方法；我们需要pickle io和base64。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="3088" class="mb mc it nc b gy nh ni l nj nk">import streamlit as st<br/>import pandas as pd<br/><strong class="nc iu">import pickle<br/>import io<br/>import base64</strong></span><span id="8443" class="mb mc it nc b gy nl ni l nj nk">...</span><span id="dfb5" class="mb mc it nc b gy nl ni l nj nk">def download_file(df, types, new_types, extension):<br/>  for i, col in enumerate(df.columns):<br/>    new_type = types[new_types[i]]<br/>    if new_type:<br/>      try:<br/>        df[col] = df[col].astype(new_type)<br/>      except:<br/>        st.write('Could not convert', col, 'to', new_types[i])</span><span id="7f3d" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  # csv<br/>  if extension == 'csv': <br/>    csv = df.to_csv(index=False)<br/>    b64 = base64.b64encode(csv.encode()).decode()  </strong></span><span id="4815" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  # pickle<br/>  else: <br/>    b = io.BytesIO()<br/>    pickle.dump(df, b)<br/>    b64 = base64.b64encode(b.getvalue()).decode()</strong></span><span id="d958" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  # download link<br/>  href = f'&lt;a href="data:file/csv;base64,{b64}" download="new_file.{extension}"&gt;Download {extension}&lt;/a&gt;'</strong></span><span id="b72b" class="mb mc it nc b gy nl ni l nj nk"><strong class="nc iu">  st.write(href, unsafe_allow_html=True)</strong></span><span id="692a" class="mb mc it nc b gy nl ni l nj nk">...</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="9340" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">更进一步</h2><p id="a961" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">我们接触了向我们的应用程序添加内容的方法，了解了输入、侧栏和一些可以改善页面布局的测试组件。现在，您可以探索所有其他方便的<a class="ae nu" href="https://docs.streamlit.io/en/stable/api.html" rel="noopener ugc nofollow" target="_blank"> Streamlit方法</a>，查看社区创建了什么<a class="ae nu" href="https://github.com/jrieke/best-of-streamlit" rel="noopener ugc nofollow" target="_blank">【1】</a><a class="ae nu" href="https://streamlit.io/gallery" rel="noopener ugc nofollow" target="_blank">【2】</a>，甚至开发<a class="ae nu" href="https://docs.streamlit.io/en/stable/streamlit_components.html" rel="noopener ugc nofollow" target="_blank">您的组件</a>。</p><p id="b3db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有些用户自制的组件可以帮助您快速构建应用程序。例如，我们可以用只有四行代码的Pandas Profiling替换我们的Explore部分。</p><pre class="lf lg lh li gt nd nc ne nf aw ng bi"><span id="4eb8" class="mb mc it nc b gy nh ni l nj nk">from pandas_profiling import ProfileReport<br/>from streamlit_pandas_profiling import st_profile_report</span><span id="700b" class="mb mc it nc b gy nl ni l nj nk">def explore(df):<br/>  pr = ProfileReport(df, explorative=True)<br/>  st_profile_report(pr)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ns"><img src="../Images/96b95d4786011abfd98bd3841b82e37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tbfeIAeLtGcxOaRbaIoqzQ.gif"/></div></div></figure><p id="4fbc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总的来说，Streamlit是开发数据应用程序的一个很好的框架。你可以自动化一个过程，给它一个友好的界面，而不需要努力，随着社区的成长和积极的开发，会有不断的改进和创新。</p><p id="3242" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以在这里找到本文中使用的代码的改进版本<a class="ae nu" href="https://github.com/Thiagobc23/Fast-Review" rel="noopener ugc nofollow" target="_blank">，在这里</a>找到其现场版本<a class="ae nu" href="https://share.streamlit.io/thiagobc23/fast-review/main/fast-review.py" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ns"><img src="../Images/6a7801f74d92396614aa845183d17d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EWLbbbdwjc0G-d2CfMHJMQ.gif"/></div></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="0105" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读我的文章！</p><p id="cc6e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">资源:<br/></strong><a class="ae nu" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank">https://streamlit.io/</a>；<br/><a class="ae nu" href="https://pandas.pydata.org/docs/" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/docs/</a>；<br/>https://github.com/pandas-profiling/pandas-profiling<a class="ae nu" href="https://github.com/pandas-profiling/pandas-profiling" rel="noopener ugc nofollow" target="_blank"/>；<br/><a class="ae nu" href="https://github.com/okld/streamlit-pandas-profiling" rel="noopener ugc nofollow" target="_blank">https://github.com/okld/streamlit-pandas-profiling</a>；<br/><a class="ae nu" href="https://docs.python.org/3/library/io.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/io.html</a>；<br/><a class="ae nu" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/pickle.html</a>；<br/><a class="ae nu" href="https://docs.python.org/3/library/base64.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/base64.html</a>；</p></div></div>    
</body>
</html>