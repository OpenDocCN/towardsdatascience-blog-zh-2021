<html>
<head>
<title>Read ERA5 Directly into Memory with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python将ERA5直接读入内存</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/read-era5-directly-into-memory-with-python-511a2740bba0?source=collection_archive---------8-----------------------#2021-03-31">https://towardsdatascience.com/read-era5-directly-into-memory-with-python-511a2740bba0?source=collection_archive---------8-----------------------#2021-03-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2a4c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用气候数据存储API</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7957bf530f82ab37c7fff62298a640f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cSj8NqPwnIYLU4CM"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@possessedphotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">附身摄影</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="8731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5" rel="noopener ugc nofollow" target="_blank"> ERA5 </a>是欧洲中期天气预报中心(<a class="ae ky" href="https://www.ecmwf.int/" rel="noopener ugc nofollow" target="_blank"> ECMWF </a>)制作的第五代气候再分析。该产品提供了许多大气、地表和海洋状态参数的每小时输出，以及不确定性的估计。然而，除非您在<a class="ae ky" href="https://www.ecmwf.int/en/newsletter/162/news/era5-reanalysis-data-available-earth-engine" rel="noopener ugc nofollow" target="_blank"/><a class="ae ky" href="https://registry.opendata.aws/ecmwf-era5/" rel="noopener ugc nofollow" target="_blank">云</a>中工作，否则存储原始每小时输出会占用大量空间。</p><p id="d24d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章概述了如何安装气候数据存储(CDS) API来读取和分析Python中的ERA5输出。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="904e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">CDS API简介</h1><p id="61e4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">CDS API允许访问数据集的<a class="ae ky" href="https://confluence.ecmwf.int/display/CKB/The+family+of+ERA5+datasets" rel="noopener ugc nofollow" target="_blank"> ERA5系列，其中包括ERA5和唯一的land补集ERA5-land。ERA5有四个主要子集:<em class="mz">每小时</em>和<em class="mz">每月</em>产品，每个产品都基于<em class="mz">压力水平</em>(包括高空区域)和<em class="mz">单一水平</em>(大气、海洋和陆地表面数量)。ERA5-land仅包括<em class="mz">单级</em>。</a></p><p id="46db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">四个ERA5子集</strong></p><ul class=""><li id="ac9f" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">ERA5单层每小时数据</li><li id="6545" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">ERA5单层月平均数据</li><li id="bab6" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">ERA5压力水平的每小时数据</li><li id="bee7" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">ERA5压力水平的月平均数据</li></ul><p id="ed25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">两个ERA5-land子集</strong></p><ul class=""><li id="45cf" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">era 5-陆地每小时数据</li><li id="17b6" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">era 5-土地月度数据</li></ul><p id="d70e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ERA5再分析在本<a class="ae ky" href="https://rmets.onlinelibrary.wiley.com/doi/full/10.1002/qj.3803" rel="noopener ugc nofollow" target="_blank">手稿</a>中有详细描述。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cc8f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">安装CDS API密钥</h1><p id="ee46" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">要开始使用CDS API，你需要做的第一件事是用Copernicus创建一个帐户，并将你唯一的API密钥存储在一个点文件中。以下是执行此操作的步骤:</p><ol class=""><li id="8598" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu no ng nh ni bi translated">在此  <strong class="lb iu">注册<a class="ae ky" href="https://cds.climate.copernicus.eu/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">与哥白尼创建账户。</strong></a></strong></li><li id="6b9e" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu no ng nh ni bi translated">一旦您有了帐户，请在此处  <strong class="lb iu"> <em class="mz"> </em> </strong>登录您的Copercius帐户<a class="ae ky" href="https://cds.climate.copernicus.eu/user" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">，并记下页面底部的<code class="fe np nq nr ns b">UID</code>和<code class="fe np nq nr ns b">API key</code>。</strong></a></li><li id="8637" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu no ng nh ni bi translated">将下面的代码片段粘贴到您的终端中，用步骤2中的代码替换<code class="fe np nq nr ns b">&lt;UID&gt;</code>和<code class="fe np nq nr ns b">&lt;API key&gt;</code>:</li></ol><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="26af" class="nx md it ns b gy ny nz l oa ob">{<br/>  echo '<!-- -->url: https://cds.climate.copernicus.eu/api/v2'<br/>  echo '<!-- -->key: UID:API_KEY'<br/>  echo 'verify<!-- -->: 0'<br/>} &gt; ~/.cdsapirc</span></pre><p id="dcdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的命令用您的API密匙创建了文件<code class="fe np nq nr ns b">~/.cdsapirc</code>，这是使用CDS API所必需的。作为健全性检查，使用<code class="fe np nq nr ns b">more ~/.cdsapirc</code>来确保一切看起来都是正确的。一个正确的文件将类似于以下内容:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="9ffe" class="nx md it ns b gy ny nz l oa ob">url: <a class="ae ky" href="https://cds.climate.copernicus.eu/api/v2" rel="noopener ugc nofollow" target="_blank">https://cds.climate.copernicus.eu/api/v2</a><br/>key: 12345:a99b9c9d-9e99-9999-9999-fg99h9i99j9k<br/>verify: 0</span></pre><blockquote class="oc od oe"><p id="aeee" class="kz la mz lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated"><strong class="lb iu">不要把上面的复制到你的</strong> <code class="fe np nq nr ns b"><strong class="lb iu">~/.cdsapirc</strong></code> <strong class="lb iu">文件中，这只是为了举例说明。</strong></p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2ad6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">安装CDS API客户端</h1><p id="460a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一旦在<code class="fe np nq nr ns b">~/.cdsapirc</code>中有了API密匙，就可以通过<code class="fe np nq nr ns b">conda</code>或<code class="fe np nq nr ns b">pip</code>安装<code class="fe np nq nr ns b">cdsapi</code>客户端:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="af31" class="nx md it ns b gy ny nz l oa ob">pip install cdsapi<br/>or<br/>conda install cdsapi</span></pre><p id="c9f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装后，确保您可以在Python脚本中导入并启动客户端，而不会出现任何错误。</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="9a16" class="nx md it ns b gy ny nz l oa ob">import cdsapi<br/>cds = cdsapi.Client()</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b2e2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用CDS API</h1><p id="485c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">下面的代码显示了如何在一个日期范围内请求指定压力水平的月平均温度。输出作为<code class="fe np nq nr ns b">xarray</code>数据集<code class="fe np nq nr ns b">ds</code>存储在内存中。下面的代码也允许将输出保存到磁盘，该操作可以使用<code class="fe np nq nr ns b">download_flag</code>打开或关闭:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="e83e" class="nx md it ns b gy ny nz l oa ob">import cdsapi<br/>import xarray as xr<br/>from urllib.request import urlopen</span><span id="8b06" class="nx md it ns b gy oi nz l oa ob"># start the client<br/>cds = cdsapi.Client()</span><span id="a085" class="nx md it ns b gy oi nz l oa ob"># dataset you want to read<br/>dataset = "reanalysis-era5-pressure-levels-monthly-means"</span><span id="7c0a" class="nx md it ns b gy oi nz l oa ob"># flag to download data<br/>download_flag = False</span><span id="1ec0" class="nx md it ns b gy oi nz l oa ob"># api parameters <br/>params = {<br/>    "format": "netcdf",<br/>    "product_type": "monthly_averaged_reanalysis",<br/>    "variable": "temperature",<br/>    "pressure_level": '1000',<br/>    'year':['2019','2020'],<br/>    'month':['01','02','03'],<br/>    "time": "00:00", <br/>    "grid": [1.0, 1.0],<br/>    "area": [90, -180, -90, 180],<br/>    }</span><span id="e66b" class="nx md it ns b gy oi nz l oa ob"># retrieves the path to the file<br/>fl = cds.retrieve(dataset, params)</span><span id="c6c5" class="nx md it ns b gy oi nz l oa ob"># download the file <br/>if download_flag:<br/>    fl.download("./output.nc")</span><span id="49b8" class="nx md it ns b gy oi nz l oa ob"># load into memory<br/>with urlopen(fl.location) as f:<br/>    ds = xr.open_dataset(f.read())</span></pre><p id="bdfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个更复杂的请求示例，我请求2020年的1月、2月和3月。另外，我请求每个月的第一天中午，<code class="fe np nq nr ns b">12:00</code>。我需要四分之一度的数据<code class="fe np nq nr ns b">grid</code>和美国大陆的数据<code class="fe np nq nr ns b">area</code>:<code class="fe np nq nr ns b">[49.38, -124.67, 25.84, -66.95</code>。注意，<code class="fe np nq nr ns b">area</code>参数指定了一个坐标为<code class="fe np nq nr ns b">[north, west, south, east]</code>的边界框。</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="49b2" class="nx md it ns b gy ny nz l oa ob">import cdsapi<br/>import xarray as xr<br/>from urllib.request import urlopen</span><span id="0e80" class="nx md it ns b gy oi nz l oa ob">c = cdsapi.Client()</span><span id="e7f4" class="nx md it ns b gy oi nz l oa ob"># dataset to read<br/>dataset = 'reanalysis-era5-pressure-levels'</span><span id="c4f2" class="nx md it ns b gy oi nz l oa ob"># flag to download data<br/>download_flag = False</span><span id="b926" class="nx md it ns b gy oi nz l oa ob"># api parameters <br/>params = {<br/>    'format': 'netcdf',<br/>    'product_type': 'reanalysis',<br/>    'variable': 'temperature',<br/>    'pressure_level':'1000',<br/>    'year':['2020'],<br/>    'month':['01','02','03'],<br/>    'day': ['01'],<br/>    'time': ['12:00'],<br/>    'grid': [0.25, 0.25],<br/>    'area': [49.38, -124.67, 25.84, -66.95],<br/>    }</span><span id="a156" class="nx md it ns b gy oi nz l oa ob"># retrieves the path to the file<br/>fl = c.retrieve(dataset, params)</span><span id="c952" class="nx md it ns b gy oi nz l oa ob"># download the file <br/>if download_flag:<br/>    fl.download("./output.nc")</span><span id="797e" class="nx md it ns b gy oi nz l oa ob"># load into memory<br/>with urlopen(fl.location) as f:<br/>    ds = xr.open_dataset(f.read())</span></pre><p id="3ff0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代替<code class="fe np nq nr ns b">year</code>、<code class="fe np nq nr ns b">month</code>、<code class="fe np nq nr ns b">day</code>和<code class="fe np nq nr ns b">time</code>参数，您也可以指定一个日期列表:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="10ce" class="nx md it ns b gy ny nz l oa ob">'date':['2020-01-01 12:00', '2020-02-01 12:00', '2020-03-01 12:00'],</span></pre><p id="6c5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，您可以像这样指定一个<code class="fe np nq nr ns b">date</code>和<code class="fe np nq nr ns b">time</code>:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="e3f3" class="nx md it ns b gy ny nz l oa ob">'date':['2020-01-01', '2020-02-01', '2020-03-01'],<br/>'time: '12:00',</span></pre><p id="2cd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码片段都产生相同的请求，说明了API的灵活性。这些请求非常具体，大多数时候你会希望请求一个连续的范围。</p><h2 id="9f46" class="nx md it bd me oj ok dn mi ol om dp mm li on oo mo lm op oq mq lq or os ms ot bi translated">指定日期范围</h2><p id="e5a4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有几种方法可以做到这一点。最简单的方法是用斜杠分隔所需的日期，该斜杠指定所请求范围的开始和结束日期:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="b802" class="nx md it ns b gy ny nz l oa ob">'date':'2020-01-01 12:00/2020-03-01 12:00'</span></pre><p id="511f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个选择是用熊猫<code class="fe np nq nr ns b">date_range</code>。但是，请注意，API的输入必须是字符串列表。这里有一个使用熊猫的例子:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="0e26" class="nx md it ns b gy ny nz l oa ob">‘date’: <!-- -->list(pd.date_range(‘<!-- -->2020–01–01 12:00<!-- -->',’<!-- -->2020–03–01 12:00<!-- -->', freq=’M’).strftime(‘%Y-%m-%d %H:%M’)),</span></pre><p id="c1b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，在请求月平均值时不能使用<code class="fe np nq nr ns b">date</code>参数，它只适用于高时间分辨率数据。对于月平均数据，您必须使用<code class="fe np nq nr ns b">year</code>和<code class="fe np nq nr ns b">month</code>参数，它们也接受斜线符号:<code class="fe np nq nr ns b">start/end</code>。</p><p id="5b14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe np nq nr ns b">cdsapi</code>非常适合复杂的请求，并且非常灵活，但是有时您会得到一个难以诊断的错误消息。</p><h2 id="b1ca" class="nx md it bd me oj ok dn mi ol om dp mm li on oo mo lm op oq mq lq or os ms ot bi translated">错误消息</h2><p id="43c7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe np nq nr ns b">no data is available within your requested subset. Request returned no data</code>是一个常见的错误信息，它没有太大的帮助。这通常表示关键字值超出了可用范围。例如，只能请求一组特定的压力水平。另外，<code class="fe np nq nr ns b">time</code>参数必须是使用24小时制的最接近的小时。以下是我看到的常见错误以及如何修复它们:</p><ul class=""><li id="5431" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">压力水平必须包含在:[1，2，3，5，7，10，20，30，50，70，范围(100，1000，25)]内，其中<code class="fe np nq nr ns b">range(100,1000,25)</code>表示100到1000，增量为25。如果出现错误，请检查您请求的压力是否包含在此列表中。</li><li id="7d18" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">时间必须是24小时制中最接近的小时:<code class="fe np nq nr ns b">00:00</code>、<code class="fe np nq nr ns b">01:00</code>、…、<code class="fe np nq nr ns b">23:00</code>。如果出现错误，请检查时间是否精确到小时。如果您请求月平均值，请确保将<code class="fe np nq nr ns b">time</code>参数设置为<code class="fe np nq nr ns b">‘00:00’</code>。</li></ul><h2 id="5809" class="nx md it bd me oj ok dn mi ol om dp mm li on oo mo lm op oq mq lq or os ms ot bi translated">证明文件</h2><p id="3b0d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我不知道任何关于CDS API的文档，这使得它很难使用，因为允许的关键字和变量名因数据集而异。以下链接会有所帮助:</p><ul class=""><li id="4c96" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">每个数据集允许的关键字参数在这里是<a class="ae ky" href="https://confluence.ecmwf.int/display/CKB/Climate+Data+Store+%28CDS%29+API+Keywords" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a>。</li><li id="9318" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">表<a class="ae ky" href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">中列出了可用的变量，这里</strong> </a> <strong class="lb iu">。</strong>你提供列在<code class="fe np nq nr ns b">variable name in CDS</code>栏的东西。</li></ul><p id="4a6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以在  <strong class="lb iu">处查看表格<a class="ae ky" href="https://confluence.ecmwf.int/display/CKB/Climate+Data+Store+(CDS)+API+Keywords" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">中的示例脚本。</strong></a></strong></p><p id="7939" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个选择是使用web界面进行选择，并查看底部的“显示API请求”。<a class="ae ky" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-pressure-levels-monthly-means?tab=form" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">这里的</strong> </a>是“月平均压力水平”的形式其他数据集可以在<a class="ae ky" href="https://cds.climate.copernicus.eu/#!/search?text=ERA5&amp;type=dataset" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">这里</strong> </a>找到。单击您想要访问的数据集，然后单击“下载数据”选项卡进行选择。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="182d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使API更易于使用</h1><p id="7d3b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一旦你理解了它是如何工作的，你就会意识到CDS API并不可怕，而是非常强大。我写了一个函数来抽象出我所描述的一些细微差别。这个函数是开源的，所以你可以随意复制和修改它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="99d9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用函数</h1><p id="2ee1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">下面是一个使用<code class="fe np nq nr ns b">get_era5()</code>函数创建下图的例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/c3f00713ed0c079594e39d42513271e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*QzghXGxrHmCyvWj6BPi0hQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">2021年2月ERA5的平均温度(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e010" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结束语</h1><p id="6d00" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">向ECMWF团队致敬，他们发布了<code class="fe np nq nr ns b">cdsapi</code>，并使ERA5再分析产品变得容易获得。该API具有清晰的语法，并且能够在服务器端重新划分输出，这是天赐之物。ECMWF还在开发一个软件包，旨在进一步简化对这些数据集的访问，这样我们就可以更多地关注科学，而不是编码。在撰写本文时，它仍在开发中，但我鼓励您继续关注<a class="ae ky" href="https://climetlab.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> climetlab </strong> </a>。然而，climetlab确实在幕后下载数据。希望climetlab中的一个特性是无需下载就能将输出读入内存。然而，我们总是可以使用CDS API来实现这一点。</p><p id="ab8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这篇文章能帮助你分析ERA5的输出，并简化你的数据管道。编码快乐！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c5ea" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">相关职位</h1><div class="ox oy gp gr oz pa"><a href="https://medium.com/analytics-vidhya/best-free-api-for-weather-records-era5-59c0e204829a" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">天气记录最佳免费API:era 5！</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">在我作为数据科学家的工作中，有一次我需要在我的项目中添加天气数据的详细记录。我想要的东西…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a href="https://medium.com/planet-os/digging-into-the-texas-freeze-using-python-and-era5-zarr-data-fa3c8ff562bb" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">使用Python和ERA5 zarr数据挖掘德州冰冻期</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">德克萨斯州通常属于亚热带气候，夏季炎热，冬季温和。然而，当一个短暂的…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po ks pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a href="https://medium.com/planet-os/era5-reanalysis-data-on-s3-cee2f22422ae" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">ERA5再分析数据</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">在过去的几个星期里，结合AWS公共数据集计划，我们一直在努力使再分析…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pq l pl pm pn pj po ks pa"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="9e80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢你花时间阅读我的帖子。这个功能始于与我的同事Jashvina Devadoss的对话，她当时正在开发一个 <a class="ae ky" href="https://github.com/jashvina-devadoss/ERA5_time_downsample" rel="noopener ugc nofollow" target="_blank"> <em class="mz">类似的功能</em> </a> <em class="mz">。</em></p><p id="f302" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mz">如果你有问题，</em>建议，或者发现这篇文章有用，请在下面评论。</p><p id="48ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mz">感谢阅读和支持媒体作者</em></p><div class="ox oy gp gr oz pa"><a href="https://lukegloege.medium.com/membership" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">通过我的推荐链接加入Medium—Luke Gloege博士</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">lukegloege.medium.com</p></div></div><div class="pj l"><div class="pr l pl pm pn pj po ks pa"/></div></div></a></div></div></div>    
</body>
</html>