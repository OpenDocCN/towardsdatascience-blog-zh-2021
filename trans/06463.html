<html>
<head>
<title>Machine Learning: Predicting Bank Loan Defaults</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习:预测银行贷款违约</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-predicting-bank-loan-defaults-d48bffb9aee2?source=collection_archive---------0-----------------------#2021-06-10">https://towardsdatascience.com/machine-learning-predicting-bank-loan-defaults-d48bffb9aee2?source=collection_archive---------0-----------------------#2021-06-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a954" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一种数据科学方法，用于预测和了解申请人的情况，以最大限度地降低未来贷款违约的风险。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/031d31c947c9d7b30236a9bb009428ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7oPZJ8exIl1oqAaW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@freegraphictoday?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">absolute vision</a>拍摄</p></figure><h1 id="51ec" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">关于项目</h1><p id="d8dc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该数据集包含有关信贷申请人的信息。在全球范围内，银行使用这种数据集和信息数据类型来创建模型，以帮助决定接受/拒绝谁的贷款。</p><p id="f993" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在所有探索性的数据分析、清理和处理我们可能(将)发现的所有异常之后，好/坏申请人的模式将暴露出来，供机器学习模型学习。</p><h1 id="c25b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">机器学习问题和目标</h1><p id="5d92" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们正在处理一个有监督的二进制分类问题。目标是训练最佳的机器学习模型，以最大限度地提高深入了解过去客户概况的预测能力，最大限度地降低未来贷款违约的风险。</p><h1 id="820e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">绩效指标</h1><p id="dc5b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">鉴于我们正在处理一个高度不平衡的数据，用于模型评估的指标是ROC AUC<strong class="lt iu">T5。</strong></p><h1 id="bae4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">项目结构</h1><p id="a4f7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该项目分为三类:</p><ol class=""><li id="f5c6" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">探索性数据分析</li><li id="829f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">数据争论:清理和特征选择</li><li id="c3d3" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">机器学习:预测建模</li></ol><h1 id="49d3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据集</h1><p id="8e03" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可以在这里下载数据集<a class="ae ky" href="https://drive.google.com/file/d/1WFvu8dnVwZV5WuluHFS_eCMJv3qOaXr1/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="2d07" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">功能描述</h2><ul class=""><li id="98f1" class="ms mt it lt b lu lv lx ly ma ns me nt mi nu mm nv my mz na bi translated"><strong class="lt iu"> id </strong>:贷款申请的唯一id。</li><li id="b0fd" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu">等级</strong> : LC指定的贷款等级。</li><li id="923a" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> annual_inc </strong>:借款人在登记时提供的自报年收入。</li><li id="f611" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> short_emp </strong> : 1年或1年以下雇佣。</li><li id="ef07" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> emp_length_num </strong>:任职年限。可能的值介于0和10之间，其中0表示不到一年，10表示十年或更长时间。</li><li id="895f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu">房屋所有权</strong>:房屋所有权的类型。</li><li id="ab31" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> dti(债务收入比)</strong>:用借款人每月总债务支付额除以借款人自报月收入计算的比率，不包括抵押贷款和要求的信用证贷款。</li><li id="d320" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu">用途</strong>:借款人针对贷款请求提供的类别。</li><li id="dd0b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu">期限</strong>:贷款的还款次数。值以月为单位，可以是36或60。</li><li id="9ed8" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu">last _ deliq _ none</strong>:1借款人至少发生一次违约事件。</li><li id="cfb5" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated">last_major_derog_none  : 1借款人至少有90天的不良评级。</li><li id="69ac" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> revol_util </strong>:循环额度利用率，或借款人相对于所有可用循环信贷的信贷金额。</li><li id="8e14" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> total_rec_late_fee </strong>:到目前为止收到的滞纳金。</li><li id="5265" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> od_ratio </strong>:透支比率。</li><li id="b611" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><strong class="lt iu"> bad_loan </strong> : 1一笔贷款未支付时。</li></ul></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/cb2c520c02eb38508ab52f91790a528d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*k03uxySXGeuRTAGv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ashu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ashutosh Dave </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="2960" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">导入</strong>所需的库和依赖项:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="db0d" class="ng la it of b gy oj ok l ol om">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import pingouin as pg</span><span id="b12b" class="ng la it of b gy on ok l ol om">import scipy<br/>from scipy.stats import chi2<br/>from scipy.stats import chi2_contingency<br/>from scipy.stats import pearsonr, spearmanr</span><span id="4be0" class="ng la it of b gy on ok l ol om">from sklearn.preprocessing import StandardScaler<br/>from sklearn.preprocessing import MinMaxScaler<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.model_selection import GridSearchCV<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.neighbors import KNeighborsClassifier<br/>from sklearn.svm import SVC<br/>from sklearn import tree<br/>from sklearn.tree import export_graphviz<br/>from sklearn.externals.six import StringIO<br/>from sklearn.linear_model import Perceptron<br/>from sklearn.neural_network import MLPClassifier<br/>from sklearn.metrics import  precision_recall_curve, roc_auc_score, confusion_matrix, accuracy_score, recall_score, precision_score, f1_score,auc, roc_curve, plot_confusion_matrix</span><span id="5e9e" class="ng la it of b gy on ok l ol om">​from category_encoders import BinaryEncoder<br/>from IPython.display import Image<br/>import pydotplus</span><span id="20df" class="ng la it of b gy on ok l ol om">import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>color = sns.color_palette()</span><span id="8f39" class="ng la it of b gy on ok l ol om">seed = 42</span></pre><p id="8dbf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">加载并显示数据集:<br/> <code class="fe oo op oq of b">&gt;&gt; data = pd.read_csv('lending_club_loan_dataset.csv', low_memory=False)</code> <br/> <code class="fe oo op oq of b">&gt;&gt; data.head()</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/39a69a194547f68c657021e3e4750713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7WrV6qGoG1d5cckXEG4rJw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> data.shape (20000，15) </strong>)。图片作者。</p></figure><h1 id="e468" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">EDA:实验数据分析</h1><p id="bdf1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">主要<strong class="lt iu">数值</strong>属性统计:<br/>T2】</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/7391200694a01692ba266ce904275966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Th4y415-r17gC93z9EJDgg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">数字属性</strong>)。图片作者。</p></figure><p id="ec03" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该数据集有2000个观察值和15个变量，包括目标，分为11个数字特征和4个类别特征。</p><p id="fbeb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有缺少值的变量:“home_ownership”为7.46%，“dti”为0.77%，“last_major_derog_none”为97.13%。</p><p id="7fdb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">根据平均值和中值之间的差异，以及变量“年度收入”、“革命效用”和“总收入延迟费用”的最大值的距离，似乎存在一些异常值。</p><p id="3ba4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">主<strong class="lt iu">类别</strong>属性统计:<br/> <code class="fe oo op oq of b">&gt;&gt; data.describe(include=[np.object])</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/0d5a7aba7b94e6aca9e290edf98cd211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2WH3HlitN80ilirdXcxsw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">分类属性</strong>)。图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="bd4f" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Checking data balance/proportion</strong></span><span id="0eea" class="ng la it of b gy on ok l ol om">loan = data.bad_loan.value_counts().to_frame().rename(columns={"bad_loan":"absolute"})</span><span id="cf68" class="ng la it of b gy on ok l ol om">loan["percent"] = (loan.apply(lambda x: x/x.sum()*100).round(2))</span><span id="a988" class="ng la it of b gy on ok l ol om">display(loan)</span><span id="8bd0" class="ng la it of b gy on ok l ol om">---</span><span id="ae7f" class="ng la it of b gy on ok l ol om"><strong class="of iu">​# pie chart</strong></span><span id="2dde" class="ng la it of b gy on ok l ol om">data.bad_loan.value_counts().plot(kind='pie', subplots=True, autopct='%1.2f%%', explode= (0.05, 0.05), startangle=80, legend=True, fontsize=12, figsize=(14,6), textprops={'color':"black"})</span><span id="e044" class="ng la it of b gy on ok l ol om">plt.legend(["0: paid loan","1: not paid loan"]);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/7c81b013e04c5e7223198e253d7077b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3-YDeBbl53iOF6Qu7upBjg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">饼状图</strong>)。图片作者。</p></figure><p id="f16f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">不平衡数据:</strong> target有80%的违约结果(值1)，而有20%的贷款以已支付/非违约(值0)结束。</p><p id="17b4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">类型</strong>的变量:<br/> <code class="fe oo op oq of b">&gt;&gt; data.dtypes.sort_values(ascending=True)</code></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="e3aa" class="ng la it of b gy oj ok l ol om">id                         int64<br/>short_emp                  int64<br/>emp_length_num             int64<br/>last_delinq_none           int64<br/>bad_loan                   int64<br/>annual_inc               float64<br/>dti                      float64<br/>last_major_derog_none    float64<br/>revol_util               float64<br/>total_rec_late_fee       float64<br/>od_ratio                 float64<br/>grade                     object<br/>home_ownership            object<br/>purpose                   object<br/>term                      object<br/>dtype: object</span></pre><p id="19c5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Couting <strong class="lt iu">变量按类型:</strong> <br/> <code class="fe oo op oq of b">&gt;&gt; data.dtypes.value_counts()</code></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="e068" class="ng la it of b gy oj ok l ol om">float64    6<br/>int64      5<br/>object     4<br/>dtype: int64</span></pre><p id="aa16" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">检查<strong class="lt iu">缺失值:</strong></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="dacb" class="ng la it of b gy oj ok l ol om">nulval = data.isnull().sum().to_frame().rename(columns={0:"absolute"})</span><span id="bb01" class="ng la it of b gy on ok l ol om">nulval["percent"] = (nulval.apply(lambda x: x/x.sum())*100).round(2)</span><span id="4865" class="ng la it of b gy on ok l ol om">nulval</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/644d0244ba997b3c853ccb474c08aa59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*xdlyh45PtgS-ski1zItVEw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">缺失值</strong>)。图片作者。</p></figure><h1 id="cf46" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">EDA功能</h1><p id="3bb7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用和滥用图形描述数据集中的所有要素。首先为每个图表定义一些函数:箱线图、直方图、条形图和饼图、散点图、数据透视图以及统计描述。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="c34d" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># General statistics<br/></strong>def stats(x):<br/>    print(f"Variable: {x}")<br/>    print(f"Type of variable: {data[x].dtype}")<br/>    print(f"Total observations: {data[x].shape[0]}")<br/>    detect_null_val = data[x].isnull().values.any()<br/>    if detect_null_val:<br/>        print(f"Missing values: {data[x].isnull().sum()} ({(data[x].isnull().sum() / data[x].isnull().shape[0] *100).round(2)}%)")<br/>    else:<br/>        print(f"Missing values? {data[x].isnull().values.any()}")<br/>    print(f"Unique values: {data[x].nunique()}")<br/>    if data[x].dtype != "O":<br/>        print(f"Min: {int(data[x].min())}")<br/>        print(f"25%: {int(data[x].quantile(q=[.25]).iloc[-1])}")<br/>        print(f"Median: {int(data[x].median())}")<br/>        print(f"75%: {int(data[x].quantile(q=[.75]).iloc[-1])}")<br/>        print(f"Max: {int(data[x].max())}")<br/>        print(f"Mean: {data[x].mean()}")<br/>        print(f"Std dev: {data[x].std()}")<br/>        print(f"Variance: {data[x].var()}")<br/>        print(f"Skewness: {scipy.stats.skew(data[x])}")<br/>        print(f"Kurtosis: {scipy.stats.kurtosis(data[x])}")<br/>        print("")<br/>        <br/>        <strong class="of iu"># Percentiles 1%, 5%, 95% and 99%</strong></span><span id="1fd3" class="ng la it of b gy on ok l ol om">print("Percentiles 1%, 5%, 95%, 99%")<br/>        display(data[x].quantile(q=[.01, .05, .95, .99]))<br/>        print("")<br/>    else:<br/>        print(f"List of unique values: {data[x].unique()}")</span><span id="4fe0" class="ng la it of b gy on ok l ol om">---</span><span id="e62d" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Variable vs. target chart<br/></strong>def target(x):<br/>    short_0 = data[data.bad_loan == 0].loc[:,x]<br/>    short_1 = data[data.bad_loan == 1].loc[:,x]<br/>    <br/>    a = np.array(short_0)<br/>    b = np.array(short_1)<br/>    <br/>    np.warnings.filterwarnings('ignore')<br/>    <br/>    plt.hist(a, bins=40, density=True, color="g", alpha = 0.6, label='Not-default', align="left")<br/>    plt.hist(b, bins=40, density=True, color="r", alpha = 0.6, label='Default', align="right")</span><span id="088e" class="ng la it of b gy on ok l ol om">plt.legend(loc='upper right')<br/>    plt.title(x, fontsize=10, loc="right")<br/>    plt.xlabel('Relative frequency')<br/>    plt.ylabel('Absolute frequency')<br/>    plt.show()</span><span id="09be" class="ng la it of b gy on ok l ol om">---</span><span id="2ee5" class="ng la it of b gy on ok l ol om">​<strong class="of iu"># Boxplot + Hist chart<br/></strong>def boxhist(x):<br/>    variable = data[x]<br/>    np.array(variable).mean()<br/>    np.median(variable)</span><span id="8669" class="ng la it of b gy on ok l ol om">f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw= {"height_ratios": (0.5, 2)})<br/>    mean=np.array(variable).mean()<br/>    median=np.median(variable)</span><span id="f001" class="ng la it of b gy on ok l ol om">sns.boxplot(variable, ax=ax_box)<br/>    ax_box.axvline(mean, color='r', linestyle='--')<br/>    ax_box.axvline(median, color='g', linestyle='-')</span><span id="286e" class="ng la it of b gy on ok l ol om">sns.distplot(variable, ax=ax_hist)<br/>    ax_hist.axvline(mean, color='r', linestyle='--')<br/>    ax_hist.axvline(median, color='g', linestyle='-')</span><span id="3273" class="ng la it of b gy on ok l ol om">plt.title(x, fontsize=10, loc="right")<br/>    plt.legend({'Mean':mean,'Median':median})<br/>    ax_box.set(xlabel='')<br/>    plt.show()</span><span id="4d1a" class="ng la it of b gy on ok l ol om">---</span><span id="309d" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Histogram<br/></strong>def hist(x):<br/>    plt.hist(data[x], bins=25)<br/>    plt.title(x, fontsize=10, loc="right")<br/>    plt.xlabel('Relative frequency')<br/>    plt.ylabel('Absolute frequency')<br/>    plt.show()</span><span id="d8a4" class="ng la it of b gy on ok l ol om">---</span><span id="6ad4" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Pie chart<br/></strong>def pie(x):<br/>    data[x].value_counts(dropna=False).plot(kind='pie', figsize=(6,5), fontsize=10, autopct='%1.1f%%', startangle=0, legend=True, textprops={'color':"white", 'weight':'bold'});</span><span id="de5a" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Number of observations by class<br/></strong>obs = data[x].value_counts(dropna=False)<br/>o = pd.DataFrame(obs)<br/>o.rename(columns={x:"Freq abs"}, inplace=True)<br/>o_pc = (data[x].value_counts(normalize=True) * 100).round(2)<br/>obs_pc = pd.DataFrame(o_pc)<br/>obs_pc.rename(columns={x:"percent %"}, inplace=True)<br/>obs = pd.concat([o,obs_pc], axis=1)<br/>display(obs)</span><span id="e3ef" class="ng la it of b gy on ok l ol om">---</span><span id="eb97" class="ng la it of b gy on ok l ol om">​<strong class="of iu"># Variable vs. target chart<br/></strong>def target(x):<br/>    short_0 = data[data.bad_loan == 0].loc[:,x]<br/>    short_1 = data[data.bad_loan == 1].loc[:,x]<br/>    <br/>    a = np.array(short_0)<br/>    b = np.array(short_1)<br/>    <br/>    np.warnings.filterwarnings('ignore')<br/>    <br/>    plt.hist(a, bins=40, density=True, color="g", alpha = 0.6, label='Not-default', align="left")<br/>    plt.hist(b, bins=40, density=True, color="r", alpha = 0.6, label='Default', align="right")</span><span id="0ff8" class="ng la it of b gy on ok l ol om">plt.legend(loc='upper right')<br/>    plt.title(x, fontsize=10, loc="right")<br/>    plt.xlabel('Relative frequency')<br/>    plt.ylabel('Absolute frequency')<br/>    plt.show()</span><span id="c6b4" class="ng la it of b gy on ok l ol om">---</span><span id="822c" class="ng la it of b gy on ok l ol om">​<strong class="of iu"># Boxplot + Hist chart<br/></strong>def boxhist(x):<br/>    variable = data[x]<br/>    np.array(variable).mean()<br/>    np.median(variable)</span><span id="234b" class="ng la it of b gy on ok l ol om">f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw= {"height_ratios": (0.5, 2)})<br/>    mean=np.array(variable).mean()<br/>    median=np.median(variable)</span><span id="1830" class="ng la it of b gy on ok l ol om">sns.boxplot(variable, ax=ax_box)<br/>    ax_box.axvline(mean, color='r', linestyle='--')<br/>    ax_box.axvline(median, color='g', linestyle='-')</span><span id="7ea3" class="ng la it of b gy on ok l ol om">sns.distplot(variable, ax=ax_hist)<br/>    ax_hist.axvline(mean, color='r', linestyle='--')<br/>    ax_hist.axvline(median, color='g', linestyle='-')</span><span id="78db" class="ng la it of b gy on ok l ol om">plt.title(x, fontsize=10, loc="right")<br/>    plt.legend({'Mean':mean,'Median':median})<br/>    ax_box.set(xlabel='')<br/>    plt.show()</span><span id="c66e" class="ng la it of b gy on ok l ol om">----</span><span id="5b0b" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Bar chart<br/></strong>def bar(x):<br/>    ax = data[x].value_counts().plot(kind="bar", figsize=(6,5), fontsize=10, color=sns.color_palette("rocket"), table=False)<br/>    for p in ax.patches:<br/>        ax.annotate("%.2f" % p.get_height(), (p.get_x() + p.get_width() / 2., p.get_height()), ha='center', va='center', xytext=(0, 5), textcoords='offset points')</span><span id="77bd" class="ng la it of b gy on ok l ol om">plt.xlabel(x, fontsize=10)<br/>    plt.xticks(rotation=0, horizontalalignment="center")<br/>    plt.ylabel("Absolute values", fontsize=10)<br/>    plt.title(x, fontsize=10, loc="right")<br/>    <br/>---<br/>    <br/><strong class="of iu"># Barh chart<br/></strong>def barh(x):<br/>    data[x].value_counts().plot(kind="barh", figsize=(6,5), fontsize=10, color=sns.color_palette("rocket"), table=False)<br/>    plt.xlabel("Absolute values", fontsize=10)<br/>    plt.xticks(rotation=0, horizontalalignment="center")<br/>    plt.ylabel(x, fontsize=10)<br/>    plt.title(x, fontsize=10, loc="right")</span><span id="1773" class="ng la it of b gy on ok l ol om">---<br/>    <br/><strong class="of iu"># Pivot_table_mean<br/></strong>def pivot_mean(a, b, c):<br/>    type_pivot_mean = data.pivot_table(<br/>        columns=a,<br/>        index=b,<br/>        values=c, aggfunc=np.mean)<br/>    display(type_pivot_mean)</span><span id="e821" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Display pivot_table</strong><br/>    type_pivot_mean.sort_values(by=[b], ascending=True).plot(kind="bar", title=(b), figsize=(6,4),fontsize = 12);</span><span id="65c3" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Pivot_table_sum<br/></strong>def pivot_sum(a, b, c):<br/>    type_pivot_sum = data.pivot_table(<br/>        columns=a,<br/>        index=b,<br/>        values=c, aggfunc=np.sum)<br/>    display(type_pivot_sum)</span><span id="d2b6" class="ng la it of b gy on ok l ol om">#<strong class="of iu"> Display pivot_table</strong><br/>    type_pivot_sum.sort_values(by=[b], ascending=True).plot(kind="bar", title=(b), figsize=(6,4),fontsize = 12);</span><span id="88aa" class="ng la it of b gy on ok l ol om">---<br/>    <br/><strong class="of iu"># Scatter plot</strong><br/>def scatter(x, y):<br/>    targets = data["bad_loan"].unique()</span><span id="f894" class="ng la it of b gy on ok l ol om">for target in targets:<br/>        a = data[data["bad_loan"] == target][x]<br/>        b = data[data["bad_loan"] == target][y]</span><span id="5850" class="ng la it of b gy on ok l ol om">plt.scatter(a, b, label=f"bad loan: {target}", marker="*")<br/>    <br/>    plt.xlabel(x, fontsize=10)<br/>    plt.ylabel(y, fontsize=10)<br/>    plt.title("abc", fontsize=10, loc="right")<br/>    plt.legend()<br/>    plt.show()</span></pre><p id="313f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">数值分布的可视化:</strong></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="7e58" class="ng la it of b gy oj ok l ol om">data.hist(figsize=(10,9), bins=12, ec="b", xlabelsize=8, ylabelsize=8, alpha=0.9, grid=False)</span><span id="1d1e" class="ng la it of b gy on ok l ol om">plt.tight_layout()<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/ff70810f218930d2afe76a9bd4ab338e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pe5X20TccBJ4-2ydDPKBBw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">数值分布)。</strong>图片作者。</p></figure><p id="aefb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">类别分布的可视化:</strong></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="fe90" class="ng la it of b gy oj ok l ol om">for col in data.select_dtypes(include=["object"]).columns:<br/>    data[col].value_counts().plot(kind="bar", color=sns.color_palette("rocket"))<br/>    <br/>    plt.xlabel("Class", fontsize=10)<br/>    plt.xticks(rotation=90, horizontalalignment="center")<br/>    plt.ylabel("Count", fontsize=10)<br/>    plt.title(col, fontsize=10, loc="right")<br/>    plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/4a173f8f0baa9b46160234a1ad9c3ad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CN5GYi961u4v9CV_yp91yA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">)【分类分布】)</strong>)。图片作者。</p></figure><p id="85e2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在“36个月”这一课中，变量“term”似乎有一个打印错误。让我们通过降低大写字符来修复它。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="da84" class="ng la it of b gy oj ok l ol om">&gt;&gt; data.term = data.term.str.lower()<br/>&gt;&gt; data.term.value_counts()</span><span id="644b" class="ng la it of b gy on ok l ol om">36 months    15001<br/> 60 months     4999<br/>Name: term, dtype: int64</span></pre><h1 id="45bb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">功能:等级</h1><p id="d310" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">LC指定的贷款等级。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="4386" class="ng la it of b gy oj ok l ol om">stats("grade")</span><span id="ad95" class="ng la it of b gy on ok l ol om">Variable: grade<br/>Type of variable: object<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 7<br/>List of unique values: ['A' 'D' 'E' 'B' 'G' 'C' 'F']</span><span id="be3f" class="ng la it of b gy on ok l ol om">---</span><span id="31de" class="ng la it of b gy on ok l ol om">bar("grade")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/28ad7511dee42d6975e4b2c6eadb39e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dPlP4ct0sF7xrol3HMEBfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">栏</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="f985" class="ng la it of b gy oj ok l ol om">pivot_sum("home_ownership","grade","id")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/8de863cd094a39fb5e851b50a2273395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIQJLZpKeTyq1qvcE9NOEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_sum </strong>)。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/020fae708c439bd77b1de4ab30b1e76e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GnzSash1LhToWWvEvOvpw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_sum </strong>)。作者图片</p></figure><p id="6a2c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当等级级别降低时，房屋所有权的类型倾向于从抵押贷款转向租赁。在B级、C级和D级上，我们把自己的礼仪类型视为最高等级。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="6e78" class="ng la it of b gy oj ok l ol om">target("grade")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/c94bd1154541de85874e0a19a581e3d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VTgcgnGrZ_htsTPROzqBsw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)。作者图片</p></figure><p id="580b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最高的非违约贷款发生在高等级阶层之间。</p><h2 id="8604" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">功能:年度_公司</h2><p id="788b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">借款人在登记时提供的自报年收入。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="4461" class="ng la it of b gy oj ok l ol om">boxhist("annual_inc")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/6c176a56fccbcda8cea086abca69ea6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAOaQ5o99Q5dNn1Fk-4Rtg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="be17" class="ng la it of b gy oj ok l ol om">stats("annual_inc")</span><span id="c231" class="ng la it of b gy on ok l ol om">Variable: annual_inc<br/>Type of variable: float64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 2566<br/>Min: 8412<br/>25%: 47000<br/>Median: 65000<br/>75%: 88000<br/>Max: 1000000<br/>Mean: 73349.57835<br/>Std dev: 45198.56725472537<br/>Variance: 2042910481.8799326<br/>Skewness: 5.275648123592321<br/>Kurtosis: 66.72665803201564<br/><br/>Percentiles 1%, 5%, 95%, 99%</span><span id="3ec6" class="ng la it of b gy on ok l ol om">0.01     20519.5<br/>0.05     30000.0<br/>0.95    145000.0<br/>0.99    225000.0<br/>Name: annual_inc, dtype: float64</span><span id="2169" class="ng la it of b gy on ok l ol om">---</span><span id="08cc" class="ng la it of b gy on ok l ol om">target("annual_inc")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/320a3c0677ff98351d40e332c1175a43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVq_ZcQgCHEx_AAH3h15Jw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)图片作者</p></figure><p id="eae3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">直方图告诉我们，收益越高，违约趋势越高。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="30b2" class="ng la it of b gy oj ok l ol om">scatter("annual_inc","dti")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/c224a50baa215f9acd96a341262466f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pGJPzn58WKh1TN07ALXVSg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">散开</strong>)。作者图片</p></figure><p id="49b8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">散点图显示了“年收入”和“债务收入比”之间微弱的负相关。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="f7ce" class="ng la it of b gy oj ok l ol om">data.annual_inc.corr(dti)<br/>&gt;&gt; -0.22853314935876534</span></pre><p id="04b1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">相关值为-0.23 </strong>，表示随着年度_inc减少，实例1(违约/未支付)的贷款增加。</p><h2 id="8439" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">功能:short_emp</h2><p id="b71b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">1当雇佣期为1年或更短时。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="85a7" class="ng la it of b gy oj ok l ol om">hist("short_emp")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/4ba25c5a09f0fd83ef63c374ded84b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fuJ9Xsdz1Hig9WS1gMlraA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> hist </strong>)图片作者</p></figure><p id="4540" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">受雇一年或一年以下的客户(实例1)占11.25%，而88.75%的客户受雇一年以上。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="28c1" class="ng la it of b gy oj ok l ol om">stats("short_emp")</span><span id="7b5a" class="ng la it of b gy on ok l ol om">Variable: short_emp<br/>Type of variable: int64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 2<br/>Min: 0<br/>25%: 0<br/>Median: 0<br/>75%: 0<br/>Max: 1<br/>Mean: 0.1125<br/>Std dev: 0.3159885163057429<br/>Variance: 0.09984874243710473<br/>Skewness: 2.4526820936006293<br/>Kurtosis: 4.015649452269171<br/><br/>Percentiles 1%, 5%, 95%, 99%</span><span id="2d67" class="ng la it of b gy on ok l ol om">0.01    0.0<br/>0.05    0.0<br/>0.95    1.0<br/>0.99    1.0<br/>Name: short_emp, dtype: float64</span><span id="8736" class="ng la it of b gy on ok l ol om">---</span><span id="ae59" class="ng la it of b gy on ok l ol om">target("short_emp")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/893105de15ce8f2f671e3952a05767bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DIZetnVN3mWxa7-wni8Y7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)图片作者</p></figure><p id="ffbc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">雇用时间少于1年的部门比其他部门更经常出现贷款违约。</p><h2 id="775d" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">特征:雇员长度数量</h2><p id="5e41" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">雇佣年限。可能的值介于0和10之间，其中0表示不到一年，10表示十年或更长时间。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="5d84" class="ng la it of b gy oj ok l ol om">boxhist("emp_length_num")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/253efa514714fb160b8c7c02909e361a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zcuNZXvKFEInNmnW_UEutA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="8253" class="ng la it of b gy oj ok l ol om">stats("emp_length_num")</span><span id="da0c" class="ng la it of b gy on ok l ol om">Variable: emp_length_num<br/>Type of variable: int64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 12<br/>Min: 0<br/>25%: 3<br/>Median: 7<br/>75%: 11<br/>Max: 11<br/>Mean: 6.8214<br/>Std dev: 3.7742302898357223<br/>Variance: 14.24481428071344<br/>Skewness: -0.27964924120655704<br/>Kurtosis: -1.3664296257576731<br/><br/>Percentiles 1%, 5%, 95%, 99%</span><span id="59a2" class="ng la it of b gy on ok l ol om">0.01     0.0<br/>0.05     1.0<br/>0.95    11.0<br/>0.99    11.0<br/>Name: emp_length_num, dtype: float64</span><span id="d4f1" class="ng la it of b gy on ok l ol om">---</span><span id="90d2" class="ng la it of b gy on ok l ol om">target("emp_length_num")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/e5224df09ab44a33fd254026a9c0e86a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHP8StIGmEA1ELoD5pX4-w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)。作者图片</p></figure><p id="c9ee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除了少数例外，这种非违约贷款发生在10年以上不间断工作的客户中。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="b5ff" class="ng la it of b gy oj ok l ol om">pivot_mean("bad_loan", "purpose", "emp_length_num")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/77fc0e40772cc0eb04857fa9c3706687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XABhYzYwSFW-_0sajYc5hw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_mean </strong>)。作者图片</p></figure><p id="18df" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">平均而言，结婚和度假是大多数贷款最终未能偿还的两个目的。</p><h1 id="d983" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">特征:房屋所有权</h1><p id="b2ae" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">房屋所有权的类型。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="59d5" class="ng la it of b gy oj ok l ol om">stats("home_ownership")</span><span id="6301" class="ng la it of b gy on ok l ol om">Variable: home_ownership<br/>Type of variable: object<br/>Total observations: 20000<br/>Missing values: 1491 (7.46%)<br/>Unique values: 3<br/>List of unique values: ['RENT' 'OWN' 'MORTGAGE' nan]</span><span id="9710" class="ng la it of b gy on ok l ol om">---</span><span id="d9f6" class="ng la it of b gy on ok l ol om">bar("home_ownership")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/9a2d6297f754f97188284df28077903b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O94LlPEGd1pzmc9X9yD00A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">栏</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="8daf" class="ng la it of b gy oj ok l ol om">pie("home_ownership")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/0a54d6380e7048c750dba01293456101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4FzHFUO8YacNQje9FcE_ag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">派</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="fea1" class="ng la it of b gy oj ok l ol om">pivot_sum("bad_loan", "home_ownership", "id")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/70f2c06023f65585426d486290449990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tx6UdStyUx7h3BBNi7U8Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_sum </strong>)。作者图片</p></figure><p id="11f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从比例上来说，房屋所有权和违约贷款之间没有太大的区别。</p><h2 id="72b3" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">特征:债务收入比</h2><p id="b75a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用借款人每月总债务付款对总债务(不包括抵押贷款和要求的LC贷款)除以借款人自我报告的月收入计算的比率。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="bbc2" class="ng la it of b gy oj ok l ol om">boxhist("dti")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/7d933f2270a79fba594a9773fc88c339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZfu5YX_GrC1Ll_hgsCaZg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="6e44" class="ng la it of b gy oj ok l ol om">stats("dti")</span><span id="7ade" class="ng la it of b gy on ok l ol om">Variable: dti<br/>Type of variable: float64<br/>Total observations: 20000<br/>Missing values: 154<br/>Unique values: 3295<br/>Min: 0<br/>25%: 10<br/>Median: 16<br/>75%: 22<br/>Max: 34<br/>Mean: 16.58784137861536<br/>Std dev: 7.585811951545168<br/>Variance: 57.544542964205505<br/>Skewness: nan<br/>Kurtosis: nan<br/><br/>Percentiles 1%, 5%, 95%, 99%</span><span id="e805" class="ng la it of b gy on ok l ol om">0.01     1.7800<br/>0.05     4.6500<br/>0.95    29.6900<br/>0.99    33.4355<br/>Name: dti, dtype: float64</span><span id="d84e" class="ng la it of b gy on ok l ol om">---</span><span id="f63d" class="ng la it of b gy on ok l ol om">target("dti")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/d7715e95039886d39809226eadc462a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ecx-iLTOeGjK7k8awc5Kg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)。作者图片</p></figure><p id="ba9e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">平均而言，与良好贷款相比，不良贷款(违约)的分布具有更高的“dti”值(债务收入比)。趋势是:努力率越高，贷款违约越频繁。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="d6cf" class="ng la it of b gy oj ok l ol om">pivot_sum("home_ownership", "purpose", "dti")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/1ebb7ea060514e5edf8e978c0fc56ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fkiYJJ3EBCajr61XzJEZfQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_sum </strong>)。作者图片</p></figure><p id="edf0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">众所周知，申请贷款的主要目的是“债务合并”,其次是“信用卡”,分别有超过6000人和4000人申请“抵押”和“自有”房屋所有权。</p><p id="f057" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">另一方面,“搬家”和“婚礼”以及19和47在所有权类型的两个相同部分中较少声明的目的。对于那些住在租来的房子里的人来说，申请贷款的人在比例上要少得多。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/242224121fa9af358a19133c50999250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jp4-eR_eGMJb7wUU_AGdEQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_sum </strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="461a" class="ng la it of b gy oj ok l ol om">pivot_sum("bad_loan", "grade", "dti")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/e6ff7e019ae685bf741674e4b838f916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5C195281ZL_6QB9K2buSQQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_mean </strong>)。作者图片</p></figure><p id="2398" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">趋势是，当年级减少时，拖欠贷款的可能性增加。</p><h1 id="3868" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">功能:用途</h1><p id="5822" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">借款人为贷款请求提供的类别。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="18ad" class="ng la it of b gy oj ok l ol om">stats("purpose")</span><span id="6c7f" class="ng la it of b gy on ok l ol om">Variable: purpose<br/>Type of variable: object<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 12<br/>List of unique values: ['credit_card' 'debt_consolidation' 'medical' 'other' 'home_improvement'<br/> 'small_business' 'major_purchase' 'vacation' 'car' 'house' 'moving'<br/> 'wedding']</span><span id="34e4" class="ng la it of b gy on ok l ol om">---</span><span id="6d4d" class="ng la it of b gy on ok l ol om">barh("purpose")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/33f44a4eafcf755ae97a0067856953d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vOLggx61tc3mx0pSOzz_hw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> barh </strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="fc09" class="ng la it of b gy oj ok l ol om">pivot_sum("bad_loan", "purpose", "id")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/814608bbeb23f956d4ed6d34880548d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UZenCxogg-9VhaZuD2rusA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_sum </strong>)。作者图片</p></figure><h1 id="89f9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">功能:术语</h1><p id="6a55" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">贷款的付款次数。值以月为单位，可以是36或60。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="b90d" class="ng la it of b gy oj ok l ol om">pie("term")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/fee56ce2aa80a96a6f1f5bb326076a5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yFULmo4Ft-jHharkTyFCIg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">派</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="401d" class="ng la it of b gy oj ok l ol om">target("term")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/189e6fafeb10e3a158b86532aebe5119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZD2eJklJU-2d3aKcMC8ppQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)。作者图片</p></figure><p id="4c88" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">违约贷款发生相反，更频繁地超过60个月的期限。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="4b2e" class="ng la it of b gy oj ok l ol om">pivot_mean("term", "grade", "annual_inc")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/54b7fc93ef039ca3f4cf0cf547379530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7c7dmqUBhevubJEw5n777g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_mean </strong>)。作者图片</p></figure><p id="b32a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">平均而言，36个月的期限在债务收入比最高的客户中最常见，这些客户属于最低等级类别。</p><h2 id="296c" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">特征:last _ delinq _ none</h2><p id="a57f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">1借款人至少有一次违约事件。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="503a" class="ng la it of b gy oj ok l ol om">target("last_delinq_none")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/76d300b34597c9a1104a1997ad01148b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDb5Ok1EZUo2U7jRSyIXAA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="b8d6" class="ng la it of b gy oj ok l ol om">pie("last_delinq_none")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/7c53a9001f0c13a54f45b6e224dfbd66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*c_DpgeKfdd_bdj-nIcs93w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">派</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="a560" class="ng la it of b gy oj ok l ol om">stats("last_delinq_none")</span><span id="e05a" class="ng la it of b gy on ok l ol om">Variable: last_delinq_none<br/>Type of variable: int64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 2<br/>Min: 0<br/>25%: 0<br/>Median: 1<br/>75%: 1<br/>Max: 1<br/>Mean: 0.5466<br/>Std dev: 0.49783614979391533<br/>Variance: 0.24784083204162968<br/>Skewness: -0.18721487004502552<br/>Kurtosis: -1.9649505924340243<br/><br/>Percentiles 1%, 5%, 95%, 99%</span><span id="865c" class="ng la it of b gy on ok l ol om">0.01    0.0<br/>0.05    0.0<br/>0.95    1.0<br/>0.99    1.0<br/>Name: last_delinq_none, dtype: float64</span><span id="1243" class="ng la it of b gy on ok l ol om">---</span><span id="ce2b" class="ng la it of b gy on ok l ol om">pivot_mean("bad_loan","purpose","last_delinq_none")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/a9409144fe81996ebeb239ee5d2b09f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PwPocAtxanroske2srlVew.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_mean </strong>)。作者图片</p></figure><p id="3603" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">平均而言，在度假和购房等贷款用途中，违约贷款更为常见。</p><h2 id="a154" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">特征:last_major_derog_none</h2><p id="cae4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">1名借款人至少有90天的不良评级。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="cbf0" class="ng la it of b gy oj ok l ol om">bar("last_major_derog_none")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/2842740e51f3e512ca945b95cc6461c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IyF1tPqq4BIGos_sfg_6Jw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">栏</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="621f" class="ng la it of b gy oj ok l ol om">stats("last_major_derog_none")</span><span id="ef78" class="ng la it of b gy on ok l ol om">Variable: last_major_derog_none<br/>Type of variable: float64<br/>Total observations: 20000<br/>Missing values: 19426 (97.13%)<br/>Unique values: 2<br/>Min: 0<br/>25%: 1<br/>Median: 1<br/>75%: 1<br/>Max: 1<br/>Mean: 0.759581881533101<br/>Std dev: 0.42771012441406686<br/>Variance: 0.18293595052629658<br/>Skewness: nan<br/>Kurtosis: nan</span><span id="c807" class="ng la it of b gy on ok l ol om">Percentiles 1%, 5%, 95%, 99%</span><span id="b72e" class="ng la it of b gy on ok l ol om">0.01    0.0<br/>0.05    0.0<br/>0.95    1.0<br/>0.99    1.0<br/>Name: last_major_derog_none, dtype: float64</span><span id="8829" class="ng la it of b gy on ok l ol om">---</span><span id="316a" class="ng la it of b gy on ok l ol om">target("last_major_derog_none")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pv"><img src="../Images/d7b4f61db6dec93d9aa1a29bc98afb16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5IHJVJqplGSPD7EtcccoTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)。作者图片</p></figure><h1 id="3261" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">功能:革命_实用</h1><p id="c752" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">循环额度利用率，或借款人相对于所有可用循环信贷使用的信贷金额。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="a551" class="ng la it of b gy oj ok l ol om">stats("revol_util")</span><span id="c5fd" class="ng la it of b gy on ok l ol om">Variable: revol_util<br/>Type of variable: float64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 1030<br/>Min: 0<br/>25%: 38<br/>Median: 57<br/>75%: 73<br/>Max: 5010<br/>Mean: 55.95814805499972<br/>Std dev: 42.117455872216155<br/>Variance: 1773.880089148075<br/>Skewness: 81.32716395041949<br/>Kurtosis: 9569.242123791564</span><span id="f656" class="ng la it of b gy on ok l ol om">Percentiles 1%, 5%, 95%, 99%</span><span id="56b4" class="ng la it of b gy on ok l ol om">0.01     2.699<br/>0.05    14.500<br/>0.95    91.800<br/>0.99    97.300<br/>Name: revol_util, dtype: float64</span><span id="cc1d" class="ng la it of b gy on ok l ol om">---</span><span id="088f" class="ng la it of b gy on ok l ol om">scatter("annual_inc", "revol_util")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/25323297b84f1173166cde5cce244705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X0ra6Sp0F4Qo0vsshre3FA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">散开</strong>)。作者图片</p></figure><p id="2f5c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">客户的年收入越低，相对于所有可用的循环信贷，借款人使用的信贷额度就越高。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="4c2f" class="ng la it of b gy oj ok l ol om">boxhist("revol_util")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pw"><img src="../Images/b395e767ad3b87aacb1e9511e45b55d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*58dxIqTATziU0lcHt3Azlw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)。作者图片</p></figure><h1 id="5c1d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">特征:总费用</h1><p id="e615" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">迄今收到的滞纳金。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="c3e2" class="ng la it of b gy oj ok l ol om">stats("total_rec_late_fee")</span><span id="0a0c" class="ng la it of b gy on ok l ol om">Variable: total_rec_late_fee<br/>Type of variable: float64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 166<br/>Min: 0<br/>25%: 0<br/>Median: 0<br/>75%: 0<br/>Max: 96<br/>Mean: 0.29062163999999996<br/>Std dev: 3.1086544166442467<br/>Variance: 9.663732282121781<br/>Skewness: 14.299156408331024<br/>Kurtosis: 262.30322072057277</span><span id="d196" class="ng la it of b gy on ok l ol om">Percentiles 1%, 5%, 95%, 99%</span><span id="3054" class="ng la it of b gy on ok l ol om">0.01     0.0<br/>0.05     0.0<br/>0.95     0.0<br/>0.99    15.0<br/>Name: total_rec_late_fee, dtype: float64</span><span id="ed44" class="ng la it of b gy on ok l ol om">---</span><span id="cc4e" class="ng la it of b gy on ok l ol om">target("total_rec_late_fee")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/75508e9e3d4479b57f8649c9f1266817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DsxPJEj0AAqnAahc6fQvGw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">目标</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="c313" class="ng la it of b gy oj ok l ol om">scatter("annual_inc", "total_rec_late_fee")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/84923f67baa2dfb9350c2c6290dfce73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SS1efqu8TvdAwMSLymGDAA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">散点</strong>)图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="f4bc" class="ng la it of b gy oj ok l ol om">data.total_rec_late_fee.corr(annual_inc)<br/>&gt;&gt; -0.00975830114406848</span></pre><p id="9790" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">年收入最低的客户是滞纳金比较多的客户，尤其是最高重的客户。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="6b3c" class="ng la it of b gy oj ok l ol om">pivot_mean("bad_loan", "purpose", "total_rec_late_fee")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/31b621ef20a6c6534c2b614c58c56aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GqvACq8453faNRuK8G4hMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_mean </strong>)。作者图片</p></figure><p id="5224" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">滞纳金在贷款用途中发生的频率更高，如房屋、小企业或度假。另一方面，婚礼和汽车是执行滞纳金最低的信贷目的。</p><h1 id="0533" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">特征:od_ratio</h1><p id="731e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">透支比例。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="b3e0" class="ng la it of b gy oj ok l ol om">boxhist("od_ratio")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/1833f15815b67916bf3aefbb545fcf0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6MafxZoIS5xM2XibM5eEIg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">博克斯特</strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="8cc8" class="ng la it of b gy oj ok l ol om">stats("od_ratio")</span><span id="e8db" class="ng la it of b gy on ok l ol om">Variable: od_ratio<br/>Type of variable: float64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 20000<br/>Min: 0<br/>25%: 0<br/>Median: 0<br/>75%: 0<br/>Max: 0<br/>Mean: 0.5044303048872487<br/>Std dev: 0.2877201586666063<br/>Variance: 0.0827828897031371<br/>Skewness: -0.02052095981509419<br/>Kurtosis: -1.1914529752985776</span><span id="f18f" class="ng la it of b gy on ok l ol om">Percentiles 1%, 5%, 95%, 99%</span><span id="06d3" class="ng la it of b gy on ok l ol om">0.01    0.009887<br/>0.05    0.051495<br/>0.95    0.951616<br/>0.99    0.990142<br/>Name: od_ratio, dtype: float64</span><span id="cc3b" class="ng la it of b gy on ok l ol om">---</span><span id="7172" class="ng la it of b gy on ok l ol om">scatter("annual_inc", "od_ratio")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/61f69771b3910afed0f4033a955cf933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_YXgx0kuHd1L-3CfdOG2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">散开</strong>)。作者图片</p></figure><p id="d37b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">年收入最低的客户之间的透支率更高，同样的申请人涉及最频繁的拖欠贷款。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="99b8" class="ng la it of b gy oj ok l ol om">pivot_sum("bad_loan", "term", "od_ratio")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/4c9519ed7367941d0adf27e86f78dfab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1S2K2eza2AvXjGTxIf4qvw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> pivot_sum </strong>)。作者图片</p></figure><p id="307a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">按比例来说，在违约贷款中，60个月期限的透支比率较高。</p><h1 id="8398" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">特征:坏账</h1><p id="94f7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">1未支付贷款时。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="9574" class="ng la it of b gy oj ok l ol om">stats("bad_loan")</span><span id="cdc5" class="ng la it of b gy on ok l ol om">Variable: bad_loan<br/>Type of variable: int64<br/>Total observations: 20000<br/>Missing values? False<br/>Unique values: 2<br/>Min: 0<br/>25%: 0<br/>Median: 0<br/>75%: 0<br/>Max: 1<br/>Mean: 0.2<br/>Std dev: 0.40001000037498174<br/>Variance: 0.16000800039999288<br/>Skewness: 1.4999999999999996<br/>Kurtosis: 0.24999999999999956</span><span id="4e60" class="ng la it of b gy on ok l ol om">Percentiles 1%, 5%, 95%, 99%</span><span id="97b7" class="ng la it of b gy on ok l ol om">0.01    0.0<br/>0.05    0.0<br/>0.95    1.0<br/>0.99    1.0<br/>Name: bad_loan, dtype: float64</span><span id="70b5" class="ng la it of b gy on ok l ol om">---</span><span id="4838" class="ng la it of b gy on ok l ol om">bar("bad_loan")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi py"><img src="../Images/1a9522317d2f81cc7df7cb101b3643b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PoBR8pKv768AWdCkjvI-AQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">栏</strong>)。作者图片</p></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="0bf4" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">相关</h2><h2 id="5d34" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">热图→皮尔逊方法</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="e478" class="ng la it of b gy oj ok l ol om">mask = np.triu(data.corr(), 1)</span><span id="1be9" class="ng la it of b gy on ok l ol om">plt.figure(figsize=(19, 9))</span><span id="0295" class="ng la it of b gy on ok l ol om">sns.heatmap(data.corr(), annot=True, vmax=1, vmin=-1, square=True, cmap='BrBG', mask=mask);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/e8922d05109500e71d04d8a6a097bc63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2K824DQz8MKV8uoFzi0vgg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">热图</strong>)。作者图片</p></figure><p id="31cf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">热图显示变量之间存在一些正相关和负相关。</p><p id="3e57" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在让我们找出哪些数字特征与目标最相关<strong class="lt iu">。</strong></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="5355" class="ng la it of b gy oj ok l ol om">bad_loan_c = pg.pairwise_corr(data, columns=['bad_loan'], method='pearson').loc[:,['X','Y','r']]</span><span id="fd1f" class="ng la it of b gy on ok l ol om">bad_loan_c.sort_values(by=['r'], ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qa"><img src="../Images/91e7c8d99a0d311c2798b5820011541d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*MMNqqY2exph5ubpeKFlAvA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">与目标相关的数字特征。作者图片</p></figure><p id="2011" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">与目标最相关的变量是<strong class="lt iu">‘DTI’，弱正相关，为0.141884 </strong>。</p><h2 id="6744" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated"><strong class="ak">热图→ </strong>斯皮尔曼方法</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="2ee0" class="ng la it of b gy oj ok l ol om">data_spear = data.copy()</span><span id="e51d" class="ng la it of b gy on ok l ol om">data_spear.drop(["bad_loan"], axis=1, inplace=True)</span><span id="26f9" class="ng la it of b gy on ok l ol om">---</span><span id="b3b7" class="ng la it of b gy on ok l ol om">spearman_rank = pg.pairwise_corr(data_spear, method='spearman').loc[:,['X','Y','r']]</span><span id="d233" class="ng la it of b gy on ok l ol om">pos = spearman_rank.sort_values(kind="quicksort", by=['r'], ascending=False).iloc[:5,:]</span><span id="f1ce" class="ng la it of b gy on ok l ol om">neg = spearman_rank.sort_values(kind="quicksort", by=['r'], ascending=False).iloc[-5:,:]</span><span id="6d34" class="ng la it of b gy on ok l ol om">con = pd.concat([pos,neg], axis=0)</span><span id="b574" class="ng la it of b gy on ok l ol om">display(con.reset_index(drop=True))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/1016af26ecdee372f8dd06044a98ea9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*5rOzPEKi4U_EpXeEZsGXJQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">10个最相关的数值对(Spearman方法)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="490f" class="ng la it of b gy oj ok l ol om">mask = np.triu(data_spear.corr(method='spearman'), 1)</span><span id="eeff" class="ng la it of b gy on ok l ol om">plt.figure(figsize=(19, 9))</span><span id="842a" class="ng la it of b gy on ok l ol om">sns.heatmap(data_spear.corr(method='spearman'), annot=True, vmax=1, vmin=-1, square=True, cmap='BrBG', mask=mask);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/36cc2f892a7adb8b0aa7db36f0fe6b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tj3guVCLqAEzn-88M1Wenw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">热图</strong>)。作者图片</p></figure><p id="60a9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通过绘制热图(spearman方法)，很容易理解变量“last_major_derog_none”和“last _ delinq _ none”是两个最相关的要素，具有最高的单调关系(60%)。尽管如此，' last_major_derog_none '有19426个缺失值(97%)，这太多了。</p><p id="b979" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这种情况下，将从数据集中删除列“last_major_derog_none”以及所有的<em class="qc"> nan值</em>。因此，下一个最相关的变量是“雇员长度数量”和“雇员长度数量”，斯皮尔曼值为-55%。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="7e2d" class="kz la it bd lb lc qd le lf lg qe li lj jz qf ka ll kc qg kd ln kf qh kg lp lq bi translated"><strong class="ak">数据争论:</strong>清洗和特征选择</h1><h2 id="66f4" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">极端值</h2><p id="7330" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们检查数据并检查任何异常值。从选择和过滤数字和类别数据开始。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="7bad" class="ng la it of b gy oj ok l ol om">data_ca = data.select_dtypes(exclude=["int64","float64"]).copy()</span><span id="dd02" class="ng la it of b gy on ok l ol om">data_nu = data.select_dtypes(exclude=["object","category"]).copy()</span></pre><p id="ecce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> #箱线图:</strong>可视化数值数据离散度</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="f055" class="ng la it of b gy oj ok l ol om">fig, axs = plt.subplots(ncols=3, nrows=4, figsize=(16, 8))<br/>index = 0<br/>axs = axs.flatten()</span><span id="3f11" class="ng la it of b gy on ok l ol om">for k,v in data_nu.items():<br/>    sns.boxplot(y=k, data=data_nu, ax=axs[index], orient="h")<br/>    index += 1<br/>    plt.tight_layout(pad=0.4, w_pad=0.5, h_pad=5.0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qi"><img src="../Images/ac5789eb36ffbed486b850d6272e0e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ekadzEhgx5WaDG4ojhOCgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">箱线图</strong>)。作者图片</p></figure><p id="3ed5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe oo op oq of b">display(data.describe().loc[["mean","50%","std"]].loc[:,["annual_inc","revol_util","total_rec_late_fee"]])</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/bdd866bef1947f8bd849d10eecaa79c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*JW9F4mJ5uR0x2Sb2MwY_Bg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="dd92" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当然，<strong class="lt iu">在变量‘年度_公司’，‘革命_效用’和‘总_收入_延迟_费用’中有一些异常值</strong>。让我们检测并解决它们。</p><h2 id="4ebf" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">'年度公司'</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="e182" class="ng la it of b gy oj ok l ol om">print(data.annual_inc.describe())</span><span id="5e19" class="ng la it of b gy on ok l ol om">count      20000.000000<br/>mean       73349.578350<br/>std        45198.567255<br/>min         8412.000000<br/>25%        47000.000000<br/>50%        65000.000000<br/>75%        88000.000000<br/>max      1000000.000000<br/>Name: annual_inc, dtype: float64</span><span id="0300" class="ng la it of b gy on ok l ol om">---</span><span id="a647" class="ng la it of b gy on ok l ol om">boxhist("annual_inc")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qk"><img src="../Images/a9178c37cc621bc341fc46d33dfab71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbDwwLiScGH_ZcLVND2RGg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)。作者图片</p></figure><p id="051c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">图表和箱线图表明该变量在上四分位数之外有太多的数据点。异常值被绘制为超出盒状图须的那些单独的点。这里使用的方法是<strong class="lt iu"> IQR分数</strong>。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="0b10" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Dealing with the outliers through IQR score method</strong></span><span id="123d" class="ng la it of b gy on ok l ol om">Q1 = data['annual_inc'].quantile(0.25)<br/>Q3 = data['annual_inc'].quantile(0.75)</span><span id="b44b" class="ng la it of b gy on ok l ol om">IQR = Q3 - Q1</span><span id="efb4" class="ng la it of b gy on ok l ol om">data['annual_inc'] = data.annual_inc[~((data.annual_inc &lt; (Q1 - 1.5 * IQR)) |(data.annual_inc &gt; (Q3 + 1.5 * IQR)))]</span><span id="92a7" class="ng la it of b gy on ok l ol om">---</span><span id="ed3d" class="ng la it of b gy on ok l ol om">print(data.annual_inc.describe())</span><span id="1446" class="ng la it of b gy on ok l ol om">count     19074.000000<br/>mean      66792.117857<br/>std       27241.646991<br/>min        8412.000000<br/>25%       46000.000000<br/>50%       62000.000000<br/>75%       84000.000000<br/>max      149000.000000<br/>Name: annual_inc, dtype: float64</span><span id="0865" class="ng la it of b gy on ok l ol om">---</span><span id="180d" class="ng la it of b gy on ok l ol om">boxhist("annual_inc")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ql"><img src="../Images/98a81136c72508f659c56dd5671f21ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rEGKMXpJzy4mb8Mybp-V0w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="0293" class="ng la it of b gy oj ok l ol om">print(int(data_nu.annual_inc.describe()[0]) - int(data.annual_inc.describe()[0]),"outliers were removed with this operation.")</span><span id="2c91" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 926 outliers were removed with this operation.</strong></span></pre><h2 id="c661" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">“革命”</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="722a" class="ng la it of b gy oj ok l ol om">print(data.revol_util.describe())</span><span id="48cf" class="ng la it of b gy on ok l ol om">count    20000.000000<br/>mean        55.958148<br/>std         42.117456<br/>min          0.000000<br/>25%         38.800000<br/>50%         57.100000<br/>75%         73.900000<br/>max       5010.000000<br/>Name: revol_util, dtype: float64</span><span id="f1a6" class="ng la it of b gy on ok l ol om">---</span><span id="cc89" class="ng la it of b gy on ok l ol om">boxhist("revol_util")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/884fc15d2275a94e4304251de4bf701d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bSta08oqzIqWp_4XO05mmw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)。作者图片</p></figure><p id="84ce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">图表和箱线图分析表明，该变量有一个远离上四分位数的数据点。</p><p id="cd2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">异常值被绘制为超出箱线图胡须的单个点，但这并不意味着上下四分位数之外的每个数据点都是异常值。</p><p id="5e58" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最好检查一下，并尽可能删除那个孤立点。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="c3b4" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Dealing with the 5010.0 outlier</strong></span><span id="d50e" class="ng la it of b gy on ok l ol om">value = data.revol_util.quantile([.99999])<br/>p = value.iloc[0]<br/>data = data[data["revol_util"] &lt; p]</span><span id="8264" class="ng la it of b gy on ok l ol om">---</span><span id="ee03" class="ng la it of b gy on ok l ol om">print(data['revol_util'].describe())</span><span id="7151" class="ng la it of b gy on ok l ol om">​count    19999.000000<br/>mean        55.710434<br/>std         23.380722<br/>min          0.000000<br/>25%         38.800000<br/>50%         57.100000<br/>75%         73.900000<br/>max        128.100000<br/>Name: revol_util, dtype: float64</span><span id="6808" class="ng la it of b gy on ok l ol om">---</span><span id="07bd" class="ng la it of b gy on ok l ol om">boxhist("revol_util")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qm"><img src="../Images/a775246973fec9414a218fae41f5ad2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*44s3HA4X63-9MBnHnGonQA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os"> boxhist </strong>)。作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="60f6" class="ng la it of b gy oj ok l ol om">print(int(data_nu.revol_util.describe()[0]) - int(data.revol_util.describe()[0]),"outlier was removed with this operation.")</span><span id="7c14" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 1 outlier was removed with this operation.</strong></span></pre><h2 id="9720" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">' total_rec_late_fee '</h2><p id="b5aa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">可视化数据<strong class="lt iu">离散度</strong>:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="bc6f" class="ng la it of b gy oj ok l ol om">sns.boxplot(x=data['total_rec_late_fee'],data=data)</span><span id="a744" class="ng la it of b gy on ok l ol om">plt.xlabel('total_rec_late_fee', fontsize=10)</span><span id="5e15" class="ng la it of b gy on ok l ol om">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qn"><img src="../Images/9c912252aa61d11ff5c72050576bf4ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n6l8SU4WXMvKVxdJ0AkzlA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">箱线图</strong>)。作者图片</p></figure><p id="c511" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">移除</strong>异常值:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="472f" class="ng la it of b gy oj ok l ol om">value = data.total_rec_late_fee.quantile([.989])</span><span id="5d8b" class="ng la it of b gy on ok l ol om">p = value.iloc[0]</span><span id="c59f" class="ng la it of b gy on ok l ol om">data = data[data["total_rec_late_fee"] &lt; p]</span></pre><p id="9b6c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">检查结果<strong class="lt iu"/>:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="6122" class="ng la it of b gy oj ok l ol om">sns.boxplot(x=data['total_rec_late_fee'],data=data)</span><span id="f0d7" class="ng la it of b gy on ok l ol om">plt.xlabel('total_rec_late_fee', fontsize=10)</span><span id="ea74" class="ng la it of b gy on ok l ol om">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/e794e8f935f6d879c059a91f2aa9039a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-6b-6oHW9GNQ_ugNSgumw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">箱线图</strong>)。作者图片</p></figure><p id="a215" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">尽管有大量数据点远离上四分位数，但我相信这些数据点不是异常值，它们的值对于目标分类是有意义的。<strong class="lt iu">不除去</strong>任何别人。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="e64a" class="ng la it of b gy oj ok l ol om">for col in data[["annual_inc", "total_rec_late_fee", "revol_util"]].columns:<br/>    sns.boxplot(data[col])<br/>    plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qp"><img src="../Images/e8241fdc0482774af8484ae0e80070c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9QXTaPmkbBaajT1Ul3cuA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">箱线图</strong>)。作者图片</p></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="614f" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">缺少值</h2><p id="f206" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是时候发现并消除它们了。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="a8d7" class="ng la it of b gy oj ok l ol om">for column in data.columns:<br/>    if data[column].isna().sum() != 0:<br/>        missing = data[column].isna().sum()<br/>        portion = (missing / data.shape[0]) * 100<br/>        print(f"'{column}': number of missing values '{missing}' ---&gt; '{portion:.3f}%'")</span><span id="74bb" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; 'annual_inc': number of missing values '915' ---&gt; '4.626%'<br/>&gt;&gt; 'home_ownership': number of missing values '1476' ---&gt; '7.462%'<br/>&gt;&gt; 'dti': number of missing values '152' ---&gt; '0.768%'<br/>&gt;&gt; 'last_major_derog_none': number of missing values '19208' ---&gt; '97.113%'</em></span></pre><h2 id="b057" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">'年度公司'</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="3494" class="ng la it of b gy oj ok l ol om">data.annual_inc.value_counts(dropna=False)</span><span id="3d3e" class="ng la it of b gy on ok l ol om">NaN         915 &lt;---<br/>60000.0     771<br/>50000.0     729<br/>65000.0     607<br/>70000.0     599<br/>           ... <br/>109097.0      1<br/>88621.0       1<br/>50455.0       1<br/>18300.0       1<br/>96241.0       1<br/>Name: annual_inc, Length: 2349, dtype: int64</span><span id="6666" class="ng la it of b gy on ok l ol om">---</span><span id="b60f" class="ng la it of b gy on ok l ol om">boxhist("annual_inc")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qq"><img src="../Images/353c06731676b6f6d6373ecea8f51e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-rksXe2K5oMN4UlogFnGuA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="036a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">策略</strong>:用平均值(average)替换缺失值。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="ddea" class="ng la it of b gy oj ok l ol om">data["annual_inc"] = data.annual_inc.fillna(data.annual_inc.mean())</span><span id="0b1b" class="ng la it of b gy on ok l ol om">print(f"Fillna done. Anomalies detected: {data.annual_inc.isnull().values.any()}")</span><span id="4e5d" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; Fillna done. Anomalies detected: False</strong></span></pre><h2 id="92e6" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">'住宅_所有权'</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="0910" class="ng la it of b gy oj ok l ol om">data.home_ownership.value_counts(dropna=False)</span><span id="a97e" class="ng la it of b gy on ok l ol om">MORTGAGE    9744<br/>RENT        6959<br/>OWN         1600<br/>NaN         1476 &lt;---<br/>Name: home_ownership, dtype: int64</span><span id="eebc" class="ng la it of b gy on ok l ol om">---</span><span id="7a69" class="ng la it of b gy on ok l ol om">bar("home_ownership")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qr"><img src="../Images/a17ec8d17c93146998abd97f8b909ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B9qGbYbo4KjJj0MIq0dGkQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="bf16" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">策略</strong>:模式插补(用最频繁值代替NaN:Mortage)。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="3c8e" class="ng la it of b gy oj ok l ol om">data["home_ownership"] = data.home_ownership.fillna(data.home_ownership.value_counts().index[0])</span><span id="a8b3" class="ng la it of b gy on ok l ol om">print(f"Imputation done. Missing values: {data.home_ownership.isnull().sum()}")</span><span id="bca1" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; Imputation done. Missing values: 0</strong></span></pre><h2 id="0fa1" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">' dti '</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="462a" class="ng la it of b gy oj ok l ol om">data.dti.value_counts(dropna=False)</span><span id="b072" class="ng la it of b gy on ok l ol om">NaN      152 &lt;---<br/>19.64     20<br/>15.87     20<br/>9.60      19<br/>13.49     19<br/>        ... <br/>1.61       1<br/>29.00      1<br/>29.19      1<br/>31.78      1<br/>3.26       1<br/>Name: dti, Length: 3286, dtype: int64</span><span id="7c03" class="ng la it of b gy on ok l ol om">---</span><span id="c205" class="ng la it of b gy on ok l ol om">boxhist("dti")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/83ef51ac6dba1e368ad68ba9733cf5ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qb7DHQRyhAVIGFY9leY-hA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="37da" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">策略</strong>:用平均值替换缺失值。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="0967" class="ng la it of b gy oj ok l ol om">data["dti"] = data.dti.fillna(data.dti.mean())</span><span id="15af" class="ng la it of b gy on ok l ol om">print(f"Fillna done. Missing values: {data.dti.isnull().values.any()}")</span><span id="4cbd" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; Fillna done. Missing values: False</strong></span></pre><h2 id="f409" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">' last_major_derog_none '</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="7cf5" class="ng la it of b gy oj ok l ol om">abs_mv = data.last_major_derog_none.value_counts(dropna=False)</span><span id="98ff" class="ng la it of b gy on ok l ol om">pc_mv = data.last_major_derog_none.value_counts(dropna=False, normalize=True) * 100</span><span id="a7f0" class="ng la it of b gy on ok l ol om">pc_mv_df = pd.DataFrame(pc_mv)</span><span id="21e5" class="ng la it of b gy on ok l ol om">pc_mv_df.rename(columns={"last_major_derog_none":"Percent %"}, inplace=True)</span><span id="c886" class="ng la it of b gy on ok l ol om">abs_pc = pd.concat([abs_mv,pc_mv_df], axis=1)</span><span id="bbad" class="ng la it of b gy on ok l ol om">abs_pc</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qs"><img src="../Images/d17d72e0410fe4a2ba6066cf430e52e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*GWjpn-GVqau2lVqqWIw2Dw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5cfe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">策略</strong>:删除' last_major_derog_none '数值变量(异常过多)。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="3b64" class="ng la it of b gy oj ok l ol om">data.drop("last_major_derog_none", axis=1, inplace=True)</span><span id="fe34" class="ng la it of b gy on ok l ol om">print(f"All missing values are solved in the entire dataset: {data.notnull().values.any()}")</span><span id="5f53" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; All missing values are solved in the entire dataset: True</strong></span></pre></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="35b0" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">特征选择</h2><p id="887f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe oo op oq of b">&gt;&gt; data.info()</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qt"><img src="../Images/aa922cfd1a7e7c32ebc6e8a99c6a23d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNz5K95zKVvsHtP8K2eJPQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c177" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">策略</strong>:丢弃‘id’数值变量(无关特性)。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="94a8" class="ng la it of b gy oj ok l ol om">data.drop("id", axis=1, inplace=True)</span><span id="b23f" class="ng la it of b gy on ok l ol om">---</span><span id="aff1" class="ng la it of b gy on ok l ol om">data.shape<br/>&gt;&gt; (19779, 13)</span></pre><h2 id="2310" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">数字特征和分类/二元目标</h2><p id="9bdd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">仅选择数值型</strong>变量:<br/> <code class="fe oo op oq of b">&gt;&gt; data_nu = data.select_dtypes(exclude=["object","category"]).copy()</code></p><p id="8764" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">创建<strong class="lt iu">子集</strong> : <br/> <code class="fe oo op oq of b">&gt;&gt; Xnum = data_nu.drop(["bad_loan"], axis= "columns") <br/>&gt;&gt; ynum = data_nu.bad_loan</code></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="615c" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Identifying the predictive features using the Pearson Correlation p-value</strong></span><span id="2192" class="ng la it of b gy on ok l ol om">pd.DataFrame(<br/>    [scipy.stats.pearsonr(Xnum[col], <br/>    ynum) for col in Xnum.columns], <br/>    columns=["Pearson Corr.", "p-value"], <br/>    index=Xnum.columns,<br/>).round(4)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qu"><img src="../Images/a6341973b8550424233a94e10d2b8271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*WDnr6ErOST-qe_mIR06p9w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="970c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">策略</strong>:降‘od _ ratio’(p值&gt; 0.05) →低信息给目标，其他全部保留。</p><h2 id="f2d7" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">分类特征和分类/二元目标</h2><p id="932a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">仅选择类别</strong> c变量:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="636d" class="ng la it of b gy oj ok l ol om">Xcat = data.select_dtypes(exclude=['int64','float64']).copy()</span></pre><p id="3887" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">创建<strong class="lt iu">子集</strong>:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="91e2" class="ng la it of b gy oj ok l ol om">Xcat['target'] = data.bad_loan<br/>Xcat.dropna(how="any", inplace=True)</span><span id="8b00" class="ng la it of b gy on ok l ol om">ycat = Xcat.target<br/>Xcat.drop("target", axis=1, inplace=True)</span></pre><p id="33af" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">卡方检验</strong>独立性检验:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="bf86" class="ng la it of b gy oj ok l ol om">for col in Xcat.columns:<br/>    table = pd.crosstab(Xcat[col], ycat)<br/>    print()<br/>    display(table)<br/>    _, pval, _, expected_table = scipy.stats.chi2_contingency(table)<br/>    print(f"p-value: {pval:.25f}")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/4a55d9d7d7d26a99e44ddd242db1bff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*S14GSrS87x1xMIYONNi5Sg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">卡方</strong>检验)。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qw"><img src="../Images/1e6049e5a892e80a27dc0d9c839348cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*JKu7tjJ0SYxtnQLMADMxOw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<strong class="bd os">卡方</strong>检验)。作者图片</p></figure><p id="4cd0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">策略</strong>:保留所有特征(p值&lt; 0.05)。分类变量具有预测能力。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="b902" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">编码和转换</h2><p id="5507" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们继续将分类变量编码并转换成数字变量。</p><p id="0793" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">特征“等级”是一个尺度，这意味着我将<strong class="lt iu">把它映射</strong>到数字上。另一方面，关于变量‘term’，‘home _ ownership’和‘purpose’，我们需要检查并决定哪个程序<strong class="lt iu"> (OHE </strong>或<strong class="lt iu">二进制编码</strong>)是最佳选择。</p><h2 id="6d6a" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">变量:“等级”</h2><p id="a899" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe oo op oq of b">&gt;&gt; data["grade"] = data.grade.map({"A":7, "B":6, "C":5, "D":4, "E":3, "F":2, "G":1})</code></p><h2 id="0be8" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">变量:“期限”、“房屋所有权”、“用途”</h2><p id="5989" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一个热编码和二进制编码都将显示，所以我们可以选择最好的应用。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="dc5c" class="ng la it of b gy oj ok l ol om">df_term = data.term<br/>df_home = data.home_ownership<br/>df_purp = data.purpose</span><span id="67d3" class="ng la it of b gy on ok l ol om"><strong class="of iu">#term</strong><br/>t_ohe = pd.get_dummies(df_term)<br/>bin_enc_term = BinaryEncoder()<br/>t_bin = bin_enc_term.fit_transform(df_term)</span><span id="4384" class="ng la it of b gy on ok l ol om"><strong class="of iu">#home_ownsership</strong><br/>h_ohe = pd.get_dummies(df_home)<br/>bin_enc_home = BinaryEncoder()<br/>h_bin = bin_enc_home.fit_transform(df_home)</span><span id="785a" class="ng la it of b gy on ok l ol om"><strong class="of iu">#purpose</strong><br/>p_ohe = pd.get_dummies(df_purp)<br/>bin_enc_purp = BinaryEncoder()<br/>p_bin = bin_enc_purp.fit_transform(df_purp)</span><span id="3d54" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; The results are:</em></span><span id="9d4c" class="ng la it of b gy on ok l ol om">** COLUMNS OHE **<br/>term: 2 &lt;--- best<br/>home: 3 &lt;--- best<br/>purp: 12<br/><br/>** COLUMNS BINARY **<br/>term: 2<br/>home: 3<br/>purp: 5 &lt;--- best</span></pre><h2 id="2e90" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">一个热门编码(OHE)</h2><p id="24c0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe oo op oq of b">&gt;&gt; data = pd.get_dummies(data, columns=["term","home_ownership"])</code></p><h2 id="4015" class="ng la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">二进制编码</h2><p id="e5cc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe oo op oq of b">&gt;&gt; bin_enc_purp = BinaryEncoder() <br/>&gt;&gt; data_bin = bin_enc_purp.fit_transform(data.purpose)</code></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="568e" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Concatenating both datasets</strong><br/>df = pd.concat([data,data_bin],axis=1)</span><span id="a123" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Dropping 'purpose'</strong><br/>df.drop(["purpose"], axis=1, inplace=True)</span><span id="7c42" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Lowering upper characters</strong><br/>df.columns = [x.lower() for x in df.columns]</span><span id="947d" class="ng la it of b gy on ok l ol om"><strong class="of iu"># printing 5 first rows</strong><br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qx"><img src="../Images/6ce756b0f1f248af3d9c7bb83fc53cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-G29ncWTMFXywthGS9XMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="710d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这一点上，我们准备测试和训练一些模型！</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="33f3" class="kz la it bd lb lc qd le lf lg qe li lj jz qf ka ll kc qg kd ln kf qh kg lp lq bi translated">机器学习:预测建模</h1><p id="c028" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们正在使用<strong class="lt iu">分类</strong>技术处理<strong class="lt iu">监督二进制问题</strong>。</p><p id="2194" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">鉴于我们有<strong class="lt iu">不平衡数据，</strong>我们将使用<strong class="lt iu"> AUC ROC </strong>作为评估以下模型性能的最佳指标。</p><p id="bfec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们定义一个AUC函数来绘制和显示真阳性率(TPR)和假阳性率(FPR)之间的阈值。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="94a1" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># ROC Curve: Area Under the Curve</strong></span><span id="8ec4" class="ng la it of b gy on ok l ol om">def auc_roc_plot(y_test, y_preds):<br/>    fpr, tpr, thresholds = roc_curve(y_test,y_preds)<br/>    roc_auc = auc(fpr, tpr)</span><span id="abb2" class="ng la it of b gy on ok l ol om">    print(roc_auc)</span><span id="b94f" class="ng la it of b gy on ok l ol om">    plt.title('Receiver Operating Characteristic')<br/>    plt.plot(fpr, tpr, 'b', label = 'AUC = %0.2f' % roc_auc)<br/>    plt.legend(loc = 'lower right')<br/>    plt.plot([0, 1], [0, 1],'r--'<br/>    plt.xlim([0, 1])<br/>    plt.ylim([0, 1])<br/>    plt.ylabel('True Positive Rate'<br/>    plt.xlabel('False Positive Rate')<br/>    plt.show()</span></pre><h1 id="894d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">逻辑回归</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="8129" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Making a copy of the dataset</strong></span><span id="4ab1" class="ng la it of b gy on ok l ol om">df_lr = df.copy()</span><span id="7962" class="ng la it of b gy on ok l ol om">---</span><span id="d8fe" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Dividing the dataset in train (80%) and test (20%)</strong></span><span id="22f6" class="ng la it of b gy on ok l ol om">train_set_lr, test_set_lr = train_test_split(df_lr, test_size = 0.2, random_state = seed)</span><span id="88d3" class="ng la it of b gy on ok l ol om">X_train_lr = train_set_lr.drop(['bad_loan'], axis = 1)<br/>y_train_lr = train_set_lr['bad_loan']</span><span id="3986" class="ng la it of b gy on ok l ol om">X_test_lr = test_set_lr.drop(['bad_loan'], axis = 1)<br/>y_test_lr = test_set_lr['bad_loan']</span><span id="7ab5" class="ng la it of b gy on ok l ol om">---</span><span id="ad58" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Normalizing the train and test data</strong></span><span id="6999" class="ng la it of b gy on ok l ol om">scaler_lr = MinMaxScaler()<br/>features_names = X_train_lr.columns</span><span id="3f60" class="ng la it of b gy on ok l ol om">X_train_lr = scaler_lr.fit_transform(X_train_lr)<br/>X_train_lr = pd.DataFrame(X_train_lr, columns = features_names)</span><span id="f395" class="ng la it of b gy on ok l ol om">X_test_lr = scaler_lr.transform(X_test_lr)<br/>X_test_lr = pd.DataFrame(X_test_lr, columns = features_names)</span><span id="d122" class="ng la it of b gy on ok l ol om">---</span><span id="28a9" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="465f" class="ng la it of b gy on ok l ol om">lr = LogisticRegression(max_iter = 1000, solver = 'lbfgs', random_state = seed, class_weight = 'balanced' )</span><span id="4ded" class="ng la it of b gy on ok l ol om">parameters = {'C':[0.001, 0.01, 0.1, 1, 10, 100]}</span><span id="6664" class="ng la it of b gy on ok l ol om">clf_lr = GridSearchCV(lr, parameters, cv = 5).fit(X_train_lr, y_train_lr)</span><span id="8372" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt;&gt; CPU times: user 10.3 s, sys: 449 ms, total: 10.8 s<br/>Wall time: 3.21 s</em></span><span id="9c54" class="ng la it of b gy on ok l ol om">---</span><span id="56c7" class="ng la it of b gy on ok l ol om">clf_lr</span><span id="bfb5" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt;&gt; GridSearchCV(cv=5, error_score=nan, estimator=LogisticRegression(C=1.0, class_weight='balanced', dual=False, fit_intercept=True, intercept_scaling=1, l1_ratio=None, max_iter=1000, multi_class='auto', n_jobs=None, penalty='l2', random_state=42, solver='lbfgs', tol=0.0001, verbose=0, warm_start=False), iid='deprecated', n_jobs=None, param_grid={'C': [0.001, 0.01, 0.1, 1, 10, 100]}, pre_dispatch='2*n_jobs', refit=True, return_train_score=False, scoring=None, verbose=0)</em></span><span id="d397" class="ng la it of b gy on ok l ol om">clf_lr.best_estimator_</span><span id="6ed6" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt;&gt; LogisticRegression(C=0.1, class_weight='balanced', dual=False, fit_intercept=True, intercept_scaling=1, l1_ratio=None, max_iter=1000, multi_class='auto', n_jobs=None, penalty='l2', random_state=42, solver='lbfgs', tol=0.0001, verbose=0, warm_start=False)</em></span><span id="475d" class="ng la it of b gy on ok l ol om">---</span><span id="97ff" class="ng la it of b gy on ok l ol om">y_preds_lr = clf_lr.predict_proba(X_test_lr)[:,1]</span><span id="c796" class="ng la it of b gy on ok l ol om">---</span><span id="6358" class="ng la it of b gy on ok l ol om">auc_roc_plot(y_test_lr, y_preds_lr)</span><span id="09f2" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 0.7074872114784778</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/a117323c6285ea40a79370ab56ab822f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9N9EarySA3vlXMo-1n7hCw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="2af7" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Confusion Matrix display</strong></span><span id="9b35" class="ng la it of b gy on ok l ol om">plot_confusion_matrix(clf_lr, X_test_lr, y_test_lr, values_format=".4g", cmap="Blues");</span><span id="3c0a" class="ng la it of b gy on ok l ol om">---</span><span id="c44b" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Creating assignments for Final Results</strong></span><span id="d90d" class="ng la it of b gy on ok l ol om">tn, fp, fn, tp = confusion_matrix(y_test_lr == 1, y_preds_lr &gt; 0.5).ravel()</span><span id="4814" class="ng la it of b gy on ok l ol om">tn_lr = tn<br/>fp_lr = fp<br/>fn_lr = fn<br/>tp_lr = tp</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qy"><img src="../Images/20861288d1dfcd138d84c8ae6990a3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*F6WY_6sNxnS2dxJEjmqciQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><h1 id="a106" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">K-最近邻</strong> ( <strong class="ak"> KNN </strong>)</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="e6f8" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Making a copy of the dataset</strong></span><span id="b86d" class="ng la it of b gy on ok l ol om">df_knn = df.copy()</span><span id="32cf" class="ng la it of b gy on ok l ol om">---</span><span id="0dc8" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Dividing the dataset in train (80%) and test (20%)</strong></span><span id="3e86" class="ng la it of b gy on ok l ol om">train_set_knn, test_set_knn = train_test_split(df_knn, test_size = 0.2, random_state = seed)</span><span id="c6d6" class="ng la it of b gy on ok l ol om">​X_train_knn = train_set_knn.drop(['bad_loan'], axis = 1)<br/>y_train_knn = train_set_knn['bad_loan']</span><span id="a844" class="ng la it of b gy on ok l ol om">X_test_knn = test_set_knn.drop(['bad_loan'], axis = 1)<br/>y_test_knn = test_set_knn['bad_loan']</span><span id="804e" class="ng la it of b gy on ok l ol om">---</span><span id="f758" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Normalizing train and test data</strong></span><span id="293f" class="ng la it of b gy on ok l ol om">scaler_knn = MinMaxScaler()<br/>features_names = X_train_knn.columns</span><span id="7298" class="ng la it of b gy on ok l ol om">X_train_knn = scaler_knn.fit_transform(X_train_knn)<br/>X_train_knn = pd.DataFrame(X_train_knn, columns = features_names)</span><span id="8684" class="ng la it of b gy on ok l ol om">X_test_knn = scaler_knn.transform(X_test_knn)<br/>X_test_knn = pd.DataFrame(X_test_knn, columns = features_names)</span><span id="49a1" class="ng la it of b gy on ok l ol om">---</span><span id="9f63" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="1741" class="ng la it of b gy on ok l ol om">for k in range(1, 200, 5):<br/>    k = k + 1<br/>    knn = KNeighborsClassifier(n_neighbors = k).fit(X_train_knn, y_train_knn)<br/>    acc = knn.score(X_test_knn, y_test_knn)<br/>    print('Accuracy for k =', k, ' is:', acc)</span><span id="9f9e" class="ng la it of b gy on ok l ol om">Accuracy for k = 2  is: 0.7965116279069767<br/>Accuracy for k = 7  is: 0.7944893832153691<br/>Accuracy for k = 12  is: 0.8066228513650152<br/>Accuracy for k = 17  is: 0.8066228513650152<br/>Accuracy for k = 22  is: 0.8088978766430738<br/>Accuracy for k = 27  is: 0.8081395348837209<br/>Accuracy for k = 32  is: 0.8106673407482305<br/>Accuracy for k = 37  is: 0.8094034378159757<br/>Accuracy for k = 42  is: 0.8116784630940344<br/>Accuracy for k = 47  is: 0.8119312436804853<br/>Accuracy for k = 52  is: 0.8109201213346815<br/>Accuracy for k = 57  is: 0.8104145601617796<br/>Accuracy for k = 62  is: 0.8096562184024267<br/>Accuracy for k = 67  is: 0.8101617795753286<br/>Accuracy for k = 72  is: 0.8101617795753286<br/>Accuracy for k = 77  is: 0.8104145601617796<br/>Accuracy for k = 82  is: 0.8109201213346815<br/>Accuracy for k = 87  is: 0.8106673407482305<br/>Accuracy for k = 92  is: 0.8104145601617796<br/>Accuracy for k = 97  is: 0.8106673407482305<br/>Accuracy for k = 102  is: 0.8104145601617796<br/>Accuracy for k = 107  is: 0.8104145601617796<br/>Accuracy for k = 112  is: 0.8104145601617796<br/>Accuracy for k = 117  is: 0.8104145601617796<br/>Accuracy for k = 122  is: 0.8104145601617796<br/>Accuracy for k = 127  is: 0.8106673407482305<br/>Accuracy for k = 132  is: 0.8104145601617796<br/>Accuracy for k = 137  is: 0.8104145601617796<br/>Accuracy for k = 142  is: 0.8101617795753286<br/>Accuracy for k = 147  is: 0.8101617795753286<br/>Accuracy for k = 152  is: 0.8101617795753286<br/>Accuracy for k = 157  is: 0.8104145601617796<br/>Accuracy for k = 162  is: 0.8104145601617796<br/>Accuracy for k = 167  is: 0.8104145601617796<br/>Accuracy for k = 172  is: 0.8104145601617796<br/>Accuracy for k = 177  is: 0.8104145601617796<br/>Accuracy for k = 182  is: 0.8104145601617796<br/>Accuracy for k = 187  is: 0.8104145601617796<br/>Accuracy for k = 192  is: 0.8104145601617796<br/>Accuracy for k = 197  is: 0.8104145601617796<br/><em class="qc">&gt;&gt; CPU times: user 1min 8s, sys: 883 ms, total: 1min 9s<br/>Wall time: 1min 10s</em></span><span id="1bdd" class="ng la it of b gy on ok l ol om">---</span><span id="c8ea" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="8ef9" class="ng la it of b gy on ok l ol om">knn = KNeighborsClassifier(n_neighbors = 47, weights='uniform').fit(X_train_knn, y_train_knn)</span><span id="717e" class="ng la it of b gy on ok l ol om">y_preds_knn = knn.predict(X_test_knn)</span><span id="6844" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; CPU times: user 1.29 s, sys: 16 ms, total: 1.31 s<br/>Wall time: 1.31 s</em></span><span id="12f4" class="ng la it of b gy on ok l ol om">---</span><span id="699e" class="ng la it of b gy on ok l ol om">auc_roc_plot(y_test_knn, y_preds_knn)</span><span id="815b" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 0.6670792264504056</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/e2988cfdde07ab55c17f9d563ed02b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNcN5EH_1OFLezrdvPmjjw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="dbc3" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Confusion Matrix display</strong></span><span id="6f0e" class="ng la it of b gy on ok l ol om">plot_confusion_matrix(knn, X_test_knn, y_test_knn, values_format=".4g", cmap="Blues");</span><span id="b34f" class="ng la it of b gy on ok l ol om">---</span><span id="ca75" class="ng la it of b gy on ok l ol om"><strong class="of iu">​# Creating assignments for Final Results</strong></span><span id="1a49" class="ng la it of b gy on ok l ol om">tn, fp, fn, tp = confusion_matrix(y_test_knn == 1, y_preds_knn &gt; 0.5).ravel()</span><span id="5b66" class="ng la it of b gy on ok l ol om">tn_knn = tn<br/>fp_knn = fp<br/>fn_knn = fn<br/>tp_knn = tp</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qy"><img src="../Images/e997f9c869c5fbf28dd3450e85dfca1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*jWXdv2qEddcpa_2OlZgetw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><h1 id="942f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">支持向量机</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="5146" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Making a copy of the dataset</strong></span><span id="4d67" class="ng la it of b gy on ok l ol om">df_svm = df.copy()</span><span id="4303" class="ng la it of b gy on ok l ol om">---</span><span id="9528" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Dividing the dataset in train (80%) and test (20%)</strong></span><span id="5b73" class="ng la it of b gy on ok l ol om">train_set_svc, test_set_svc = train_test_split(df_svm, test_size = 0.2, random_state = seed)</span><span id="8c73" class="ng la it of b gy on ok l ol om">X_train_svc = train_set_svc.drop(['bad_loan'], axis = 1)<br/>y_train_svc = train_set_svc['bad_loan']</span><span id="4296" class="ng la it of b gy on ok l ol om">X_test_svc = test_set_svc.drop(['bad_loan'], axis = 1)<br/>y_test_svc = test_set_svc['bad_loan']</span><span id="4c80" class="ng la it of b gy on ok l ol om">---</span><span id="e6a9" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Standardization of train and test data</strong></span><span id="ae2e" class="ng la it of b gy on ok l ol om">zscore_svc = StandardScaler()<br/>features_names = X_train_svc.columns</span><span id="6445" class="ng la it of b gy on ok l ol om">X_train_svc = zscore_svc.fit_transform(X_train_svc)<br/>X_train_svc = pd.DataFrame(X_train_svc, columns = features_names)</span><span id="7e9d" class="ng la it of b gy on ok l ol om">X_test_svc = zscore_svc.transform(X_test_svc)<br/>X_test_svc = pd.DataFrame(X_test_svc, columns = features_names)</span><span id="c72b" class="ng la it of b gy on ok l ol om">---</span><span id="8c97" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="f03b" class="ng la it of b gy on ok l ol om">svc = SVC(random_state=seed, class_weight='balanced',probability=True, verbose=True)</span><span id="65ae" class="ng la it of b gy on ok l ol om">parameters = {'C':[0.1, 1, 10]}</span><span id="475e" class="ng la it of b gy on ok l ol om">clf_svc = GridSearchCV(svc, parameters, cv = 5).fit(X_train_svc, y_train_svc)</span><span id="f8bd" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; [LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM][LibSVM]CPU times: user 14min 34s, sys: 22.7 s, total: 14min 57s<br/>Wall time: 15min 2s</em></span><span id="d6c0" class="ng la it of b gy on ok l ol om">---</span><span id="be0c" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="d2eb" class="ng la it of b gy on ok l ol om">y_preds_svc = clf_svc.predict_proba(X_test_svc)[:,1]</span><span id="9faa" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; CPU times: user 2.95 s, sys: 17.9 ms, total: 2.97 s<br/>Wall time: 3 s</em></span><span id="749f" class="ng la it of b gy on ok l ol om">---</span><span id="20dc" class="ng la it of b gy on ok l ol om">auc_roc_plot(y_test_svc, y_preds_svc)</span><span id="dc9b" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 0.6754917862341443</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/49bb088e8f0b007f43bccee85932c107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*alKutmhimT8pnPvp93k5yQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="d1f2" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Confusion Matrix display</strong></span><span id="48ab" class="ng la it of b gy on ok l ol om">plot_confusion_matrix(clf_svc, X_test_svc, y_test_svc, values_format=".4g", cmap="Blues");</span><span id="59ba" class="ng la it of b gy on ok l ol om">---</span><span id="d61b" class="ng la it of b gy on ok l ol om"><strong class="of iu">​# Creating assignments for Final Results</strong></span><span id="9353" class="ng la it of b gy on ok l ol om">tn, fp, fn, tp = confusion_matrix(y_test_svc == 1, y_preds_svc &gt; 0.5).ravel()</span><span id="1bec" class="ng la it of b gy on ok l ol om">tn_svc = tn<br/>fp_svc = fp<br/>fn_svc = fn<br/>tp_svc = tp</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qy"><img src="../Images/5085156d9ffc1f4f45fe8a1559c224b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*f49zWYqCgPaUb8x3Hflamg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><h1 id="abf2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">决策树</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="70c0" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Making a copy of the dataset</strong></span><span id="3922" class="ng la it of b gy on ok l ol om">df_trees = df.copy()</span><span id="bf0e" class="ng la it of b gy on ok l ol om">---</span><span id="b7ba" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Dividing the dataset in train (80%) and test (20%)</strong></span><span id="7f61" class="ng la it of b gy on ok l ol om">train_set_dt, test_set_dt = train_test_split(df_trees, test_size = 0.2, random_state = seed)</span><span id="24fd" class="ng la it of b gy on ok l ol om">X_train_dt = train_set_dt.drop(['bad_loan'], axis = 1)<br/>y_train_dt = train_set_dt['bad_loan']</span><span id="1a1c" class="ng la it of b gy on ok l ol om">X_test_dt = test_set_dt.drop(['bad_loan'], axis = 1)<br/>y_test_dt = test_set_dt['bad_loan']</span><span id="6f0d" class="ng la it of b gy on ok l ol om">---</span><span id="027c" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="52dd" class="ng la it of b gy on ok l ol om">clf_tree = tree.DecisionTreeClassifier(random_state = seed, max_depth = 10).fit(X_train_dt, y_train_dt)</span><span id="052e" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; CPU times: user 203 ms, sys: 65.8 ms, total: 268 ms<br/>Wall time: 388 ms</em></span><span id="aa6d" class="ng la it of b gy on ok l ol om">---</span><span id="c6a5" class="ng la it of b gy on ok l ol om">clf_tree.score(X_test_dt, y_test_dt)</span><span id="f7e9" class="ng la it of b gy on ok l ol om">&gt;&gt; 0.788675429726997</span><span id="860a" class="ng la it of b gy on ok l ol om">---</span><span id="0443" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Visualizing variables by importance</strong></span><span id="7c1b" class="ng la it of b gy on ok l ol om">important_features = pd.DataFrame(data = clf_tree.feature_importances_, index = X_train_dt.columns, columns = ["value"])</span><span id="7a8f" class="ng la it of b gy on ok l ol om">important_features.sort_values(by = "value", ascending = False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qz"><img src="../Images/26efec652db978e3af0535123bdccbe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*Mtr_Cu1VHRBZYNcRtbAvOA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="d9ff" class="ng la it of b gy oj ok l ol om">y_preds_dt = clf_tree.predict_proba(X_test_dt)[:,1]</span><span id="0eed" class="ng la it of b gy on ok l ol om">---</span><span id="9392" class="ng la it of b gy on ok l ol om">auc_roc_plot(y_test_dt, y_preds_dt)</span><span id="8eac" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 0.6295855687253067</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/03fe90407a1b8982d2183ad1a1d7547f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzGUzG26pkBrpIOkQlQ0TA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="0d6a" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Confusion Matrix display</strong></span><span id="98d6" class="ng la it of b gy on ok l ol om">plot_confusion_matrix(clf_tree, X_test_dt, y_test_dt, values_format=".4g", cmap="Blues");</span><span id="44bb" class="ng la it of b gy on ok l ol om">---</span><span id="0881" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Creating assignments Final Results</strong></span><span id="5ad8" class="ng la it of b gy on ok l ol om">tn, fp, fn, tp = confusion_matrix(y_test_dt == 1, y_preds_dt &gt; 0.5).ravel()</span><span id="31d3" class="ng la it of b gy on ok l ol om">tn_dt = tn<br/>fp_dt = fp<br/>fn_dt = fn<br/>tp_dt = tp</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qy"><img src="../Images/18a4debc5fd5a6d138eba7b047436a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*IBNCggWi2WRN57U_gdxXFQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><h1 id="f945" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">随机森林</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="33e4" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Making a copy of the dataset</strong></span><span id="de78" class="ng la it of b gy on ok l ol om">df_rf = df.copy()</span><span id="3c27" class="ng la it of b gy on ok l ol om">---</span><span id="235d" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Dividing the dataset in train (80%) and test (20%)</strong></span><span id="4fa8" class="ng la it of b gy on ok l ol om">train_set_rf, test_set_rf = train_test_split(df_rf, test_size = 0.2, random_state = seed)</span><span id="99c9" class="ng la it of b gy on ok l ol om">X_train_rf = train_set_rf.drop(['bad_loan'], axis = 1)<br/>y_train_rf = train_set_rf['bad_loan']</span><span id="d904" class="ng la it of b gy on ok l ol om">X_test_rf = test_set_rf.drop(['bad_loan'], axis = 1)<br/>y_test_rf = test_set_rf['bad_loan']</span><span id="60df" class="ng la it of b gy on ok l ol om">---</span><span id="3ebd" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="9b0c" class="ng la it of b gy on ok l ol om">rf = RandomForestClassifier(random_state = seed, class_weight = None).fit(X_train_rf, y_train_rf)</span><span id="c61c" class="ng la it of b gy on ok l ol om">parameters = {'n_estimators':[10, 100, 300, 1000]}</span><span id="d0b9" class="ng la it of b gy on ok l ol om">clf_rf = GridSearchCV(rf, parameters, cv = 5).fit(X_train_rf, y_train_rf)</span><span id="6dc8" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; CPU times: user 2min 11s, sys: 3.33 s, total: 2min 14s<br/>Wall time: 2min 15s</em></span><span id="8f1f" class="ng la it of b gy on ok l ol om">---</span><span id="0a51" class="ng la it of b gy on ok l ol om">y_preds_rf = clf_rf.predict_proba(X_test_rf)[:,1]</span><span id="85a9" class="ng la it of b gy on ok l ol om">---</span><span id="723d" class="ng la it of b gy on ok l ol om">auc_roc_plot(y_test_rf, y_preds_rf)</span><span id="b90f" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 0.6735905593678521</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/156e914ebc92ed89830d5654176aaf79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vdad9mJuJpos9m_QMhiXGw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="591b" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Confusion Matrxi display</strong></span><span id="ee2f" class="ng la it of b gy on ok l ol om">plot_confusion_matrix(clf_rf, X_test_rf, y_test_rf, values_format=".4g", cmap="Blues");</span><span id="9d30" class="ng la it of b gy on ok l ol om">---</span><span id="7829" class="ng la it of b gy on ok l ol om">​<strong class="of iu"># Creating assignments for Final Results</strong></span><span id="3c31" class="ng la it of b gy on ok l ol om">tn, fp, fn, tp = confusion_matrix(y_test_rf == 1, y_preds_rf &gt; 0.5).ravel()</span><span id="4857" class="ng la it of b gy on ok l ol om">tn_rf = tn<br/>fp_rf = fp<br/>fn_rf = fn<br/>tp_rf = tp</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ra"><img src="../Images/8518abe137266b9f645a8b6e3f64a0a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*YUUUMp11Iw8qSIl1mrEGTQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><h1 id="7e5a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">神经网络</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="d85b" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Making a copy of the dataset</strong></span><span id="fe32" class="ng la it of b gy on ok l ol om">df_nn = df.copy()</span><span id="1484" class="ng la it of b gy on ok l ol om">---</span><span id="30b8" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Dividing the dataset in train (80%) and test (20%)</strong></span><span id="9af1" class="ng la it of b gy on ok l ol om">train_set_nn, test_set_nn = train_test_split(df_nn, test_size = 0.2, random_state = seed)</span><span id="3a76" class="ng la it of b gy on ok l ol om">X_train_nn = train_set_nn.drop(['bad_loan'], axis = 1)<br/>y_train_nn = train_set_nn['bad_loan']</span><span id="903e" class="ng la it of b gy on ok l ol om">X_test_nn = test_set_nn.drop(['bad_loan'], axis = 1)<br/>y_test_nn = test_set_nn['bad_loan']</span><span id="f9df" class="ng la it of b gy on ok l ol om">---</span><span id="2ca8" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Normalization of the train and test data</strong></span><span id="f021" class="ng la it of b gy on ok l ol om">scaler_nn = MinMaxScaler()<br/>features_names = X_train_nn.columns</span><span id="1b1f" class="ng la it of b gy on ok l ol om">X_train_nn = scaler_nn.fit_transform(X_train_nn)<br/>X_train_nn = pd.DataFrame(X_train_nn, columns = features_names)</span><span id="7776" class="ng la it of b gy on ok l ol om">X_test_nn = scaler_nn.transform(X_test_nn)<br/>X_test_nn = pd.DataFrame(X_test_nn, columns = features_names)</span><span id="5704" class="ng la it of b gy on ok l ol om">---</span><span id="b53a" class="ng la it of b gy on ok l ol om"><strong class="of iu">%%time</strong></span><span id="b98a" class="ng la it of b gy on ok l ol om">mlp_nn = MLPClassifier(solver = 'adam', random_state = seed, max_iter = 1000 )</span><span id="30b1" class="ng la it of b gy on ok l ol om">parameters = {'hidden_layer_sizes': [(20,), (20,10), (20, 10, 2)], 'learning_rate_init':[0.0001, 0.001, 0.01, 0.1]}</span><span id="7850" class="ng la it of b gy on ok l ol om">clf_nn = GridSearchCV(mlp_nn, parameters, cv = 5).fit(X_train_nn, y_train_nn)</span><span id="799f" class="ng la it of b gy on ok l ol om"><em class="qc">&gt;&gt; CPU times: user 25min 41s, sys: 41.4 s, total: 26min 22s<br/>Wall time: 6min 53s</em></span><span id="ea1c" class="ng la it of b gy on ok l ol om">---</span><span id="b6a9" class="ng la it of b gy on ok l ol om">y_preds_nn = clf_nn.predict_proba(X_test_nn)[:,1]</span><span id="7b23" class="ng la it of b gy on ok l ol om">---</span><span id="eb66" class="ng la it of b gy on ok l ol om">auc_roc_plot(y_test_nn, y_preds_nn)</span><span id="8a2b" class="ng la it of b gy on ok l ol om"><strong class="of iu">&gt;&gt; 0.7081023081721772</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/f88eb5cf23ec329920fcb5cc6ec8a949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYiQuCh8qTfhbuf1rDgNDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="596f" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Confusion Matrix display</strong></span><span id="6de3" class="ng la it of b gy on ok l ol om">plot_confusion_matrix(clf_nn, X_test_nn, y_test_nn, values_format=".4g", cmap="Blues");​</span><span id="3126" class="ng la it of b gy on ok l ol om">---</span><span id="5651" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Creating assignments for Final Results</strong></span><span id="4ca3" class="ng la it of b gy on ok l ol om">tn, fp, fn, tp = confusion_matrix(y_test_nn == 1, y_preds_nn &gt; 0.5).ravel()</span><span id="66db" class="ng la it of b gy on ok l ol om">tn_nn = tn<br/>fp_nn = fp<br/>fn_nn = fn<br/>tp_nn = tp</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/3f4b34b454cacddd06717f54eadb1d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*nOM3t6fx5HA0y4Z7Y2I9TA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><h1 id="a047" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结果:模型之间的性能比较</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="975e" class="ng la it of b gy oj ok l ol om"><strong class="of iu"># Creating performance table</strong></span><span id="d2de" class="ng la it of b gy on ok l ol om">results_1 = {'Classifier': ['AUC ROC (%)','TN (%)','FP (%)','FN (%)','TP (%)'],</span><span id="fd83" class="ng la it of b gy on ok l ol om">'Logistic Regression (LR)': [aucroclr, (tn_lr/3956*100).round(2), (fp_lr/3956*100).round(2), (fn_lr/3956*100).round(2), (tp_lr/3956*100).round(2)],</span><span id="2fff" class="ng la it of b gy on ok l ol om">'K Nearest Neighbour (KNN)': [aucrocknn, (tn_knn/3956*100).round(2),(fp_knn/3956*100).round(2), (fn_knn/3956*100).round(2),(tp_nn/3956*100).round(2)],</span><span id="e215" class="ng la it of b gy on ok l ol om">'Support Vector Machine (SVC)': [aucrocsvc, (tn_svc/3956*100).round(2),(fp_svc/3956*100).round(2), (fn_svc/3956*100).round(2),(tp_svc/3956*100).round(2)],</span><span id="af00" class="ng la it of b gy on ok l ol om">'Decision Trees (DT)': [aucrocdt, (tn_dt/3956*100).round(2), (fp_dt/3956*100).round(2), (fn_dt/3956*100).round(2),(tp_dt/3956*100).round(2)],</span><span id="4480" class="ng la it of b gy on ok l ol om">'Random Forest (RF)': [aucrocrf, (tn_rf/3956*100).round(2), (fp_rf/3956*100).round(2), (fn_rf/3956*100).round(2),(tp_rf/3956*100).round(2)],</span><span id="c626" class="ng la it of b gy on ok l ol om">'Neural Networks (NN)': [aucrocnn, (tn_nn/3956*100).round(2), (fp_nn/3956*100).round(2),(fn_nn/3956*100).round(2),(tp_nn/3956*100).round(2)]}</span><span id="2763" class="ng la it of b gy on ok l ol om">df1 = pd.DataFrame(results_1, columns = ['Classifier', 'Logistic Regression (LR)', 'K Nearest Neighbour (KNN)', 'Support Vector Machine (SVC)', 'Decision Trees (DT)', 'Random Forest (RF)', 'Neural Networks (NN)'])</span><span id="5a5d" class="ng la it of b gy on ok l ol om">df1.set_index("Classifier", inplace=True)</span><span id="653c" class="ng la it of b gy on ok l ol om">results = df1.T<br/>results<br/></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rb"><img src="../Images/d0e52d3a1fd8e92005dc5d65748e1d55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*svGFkUT00v2gTAfGApFGWQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="e9c4" class="ng la it of b gy oj ok l ol om">​<strong class="of iu"># Creating table for graphic visualization</strong></span><span id="6f27" class="ng la it of b gy on ok l ol om">results_2 = {'Classifier': ['ROC AUC'], 'Logistic Regression (LR)': [aucroclr], 'K Nearest Neighbour (KNN)': [aucrocknn], 'Support Vector Machine (SVC)': [aucrocsvc], 'Decision Trees (DT)': [aucrocdt], 'Random Forest (RF)': [aucrocrf], 'Neural Networks (NN)': [aucrocnn]}</span><span id="78a0" class="ng la it of b gy on ok l ol om">df2 = pd.DataFrame(results_2, columns = ['Classifier', 'Logistic Regression (LR)', 'K Nearest Neighbour (KNN)', 'Support Vector Machine (SVC)', 'Decision Trees (DT)', 'Random Forest (RF)', 'Neural Networks (NN)'])</span><span id="5347" class="ng la it of b gy on ok l ol om">df2.set_index("Classifier", inplace=True)<br/>results_2 = df2</span><span id="c59a" class="ng la it of b gy on ok l ol om">---</span><span id="5149" class="ng la it of b gy on ok l ol om"><strong class="of iu"># Display tHe graph</strong></span><span id="bf07" class="ng la it of b gy on ok l ol om">ax = results_2.plot(kind="bar", title=("Evaluating models' performance"), figsize=(12,8) ,fontsize=10, grid=True)</span><span id="b6be" class="ng la it of b gy on ok l ol om">for p in ax.patches:<br/>    ax.annotate("%.2f" % p.get_height(), (p.get_x() + p.get_width() / 2., p.get_height()), ha='center', va='center', xytext=(0, 5), textcoords='offset points')</span><span id="7f38" class="ng la it of b gy on ok l ol om">plt.legend(fontsize=8.5, loc="upper right")<br/>plt.xlabel('')<br/>plt.xticks(rotation='horizontal')<br/>plt.ylabel('Relative frequency (%)')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rc"><img src="../Images/8a8b8bc194445f80e0aae97be3d47efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VntsjdXRHDcJ2-XuaqssOQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="57b6" class="kz la it bd lb lc qd le lf lg qe li lj jz qf ka ll kc qg kd ln kf qh kg lp lq bi translated">结论</h1><p id="4e59" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最佳模型:<strong class="lt iu"> </strong>支持向量机-分类器(SVC): 75.21%。</p><p id="4e94" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">经验法则非常简单:ROC AUC指标的值越高越好。如果随机模型显示0.5，完美模型将达到1.0。</p><p id="7c5f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">学术评分系统如下:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="1d8f" class="ng la it of b gy oj ok l ol om">.9 -  1 = excellent  (A)<br/>.8 - .9 = good       (B)<br/>.7 - .8 = reasonable (C)<br/>.6 - .7 = weak       (D)<br/>.5 - .6 = terrible   (F)</span></pre><p id="d467" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">TPR和FPR之间的比率由阈值确定，超过该阈值导致阳性情况，将所选模型(SVC)置于合理水平(C ), ROC AUC得分为75.21%。</p><p id="643f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以在这里下载数据集<a class="ae ky" href="https://drive.google.com/file/d/1WFvu8dnVwZV5WuluHFS_eCMJv3qOaXr1/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="2e59" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其他一些文章:</p><div class="rd re gp gr rf rg"><a href="https://goncaloggomes.medium.com/machine-learning-hierarchical-and-k-means-clustering-with-python-fb73ee729128" rel="noopener follow" target="_blank"><div class="rh ab fo"><div class="ri ab rj cl cj rk"><h2 class="bd iu gy z fp rl fr fs rm fu fw is bi translated">机器学习:用Python实现分层聚类和K均值聚类</h2><div class="rn l"><h3 class="bd b gy z fp rl fr fs rm fu fw dk translated">一种数据科学方法，涵盖最常用的模型来执行聚类分析和客户细分…</h3></div><div class="ro l"><p class="bd b dl z fp rl fr fs rm fu fw dk translated">goncaloggomes.medium.com</p></div></div><div class="rp l"><div class="rq l rr rs rt rp ru ks rg"/></div></div></a></div><div class="rd re gp gr rf rg"><a rel="noopener follow" target="_blank" href="/machine-learning-costs-prediction-of-a-marketing-campaign-exploratory-data-analysis-part-i-758b8f0ff5d4"><div class="rh ab fo"><div class="ri ab rj cl cj rk"><h2 class="bd iu gy z fp rl fr fs rm fu fw is bi translated">机器学习:营销活动的成本预测(探索性数据分析——第一部分)</h2><div class="rn l"><h3 class="bd b gy z fp rl fr fs rm fu fw dk translated">预测营销活动最佳目标候选人的数据科学方法</h3></div><div class="ro l"><p class="bd b dl z fp rl fr fs rm fu fw dk translated">towardsdatascience.com</p></div></div><div class="rp l"><div class="rv l rr rs rt rp ru ks rg"/></div></div></a></div><div class="rd re gp gr rf rg"><a href="https://goncaloggomes.medium.com/15-business-questions-about-mobile-marketing-campaigns-roas-return-on-ad-spend-ff636a8095b6" rel="noopener follow" target="_blank"><div class="rh ab fo"><div class="ri ab rj cl cj rk"><h2 class="bd iu gy z fp rl fr fs rm fu fw is bi translated">关于移动营销活动的15个商业问题:ROAS(广告支出回报)</h2><div class="rn l"><h3 class="bd b gy z fp rl fr fs rm fu fw dk translated">探索性营销数据分析，用于监控和评估移动营销活动(EDA)的绩效</h3></div><div class="ro l"><p class="bd b dl z fp rl fr fs rm fu fw dk translated">goncaloggomes.medium.com</p></div></div><div class="rp l"><div class="rw l rr rs rt rp ru ks rg"/></div></div></a></div></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="d1df" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如何与我联系:</p><ul class=""><li id="15ca" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm nv my mz na bi translated"><a class="ae ky" href="http://bit.ly/2ybRqYT" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="d850" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated"><a class="ae ky" href="https://bit.ly/3gAwMTP" rel="noopener ugc nofollow" target="_blank">推特</a></li><li id="3e19" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm nv my mz na bi translated">评论如下</li></ul><p id="a303" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">👏🏻如果你觉得值得的话。</p><p id="297e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">✅感谢你的阅读！</p></div></div>    
</body>
</html>