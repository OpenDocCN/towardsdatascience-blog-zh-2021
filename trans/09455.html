<html>
<head>
<title>From pandas to PySpark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä»ç†ŠçŒ«åˆ°PySpark</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/from-pandas-to-pyspark-fd3a908e55a0?source=collection_archive---------7-----------------------#2021-09-02">https://towardsdatascience.com/from-pandas-to-pyspark-fd3a908e55a0?source=collection_archive---------7-----------------------#2021-09-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ad02c21c88a2631129533aeaf46cf905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7svl6b4_PwXadlAw"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae jg" href="https://unsplash.com/@heyerlein?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">hÂ·æµ·å°”æ—</a>åœ¨<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„</p></figure><div class=""/><div class=""><h2 id="2a91" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">åˆ©ç”¨æ‚¨çš„ç†ŠçŒ«æ•°æ®æ“ä½œæŠ€èƒ½æ¥å­¦ä¹ PySpark</h2></div><p id="eab3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å¯¹äºæ•°æ®åˆ†æå¸ˆã€æ•°æ®ç§‘å­¦å®¶å’Œä»»ä½•ä¸æ•°æ®æ‰“äº¤é“çš„äººæ¥è¯´ï¼Œèƒ½å¤Ÿç†Ÿç»ƒã€é«˜æ•ˆåœ°æ“ä½œå¤§æ•°æ®æ˜¯ä¸€é¡¹æœ‰ç”¨çš„æŠ€èƒ½ã€‚å¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰Pythonå’Œpandasï¼Œå¹¶ä¸”æƒ³è¦å­¦ä¹ è®¨è®ºå¤§æ•°æ®ï¼Œä¸€ä¸ªå¥½çš„å¼€å§‹æ–¹å¼æ˜¯ç†Ÿæ‚‰PySparkï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºApache Sparkçš„Python APIï¼Œ<a class="ae jg" href="https://www.ibm.com/cloud/blog/hadoop-vs-spark" rel="noopener ugc nofollow" target="_blank">ä¸€ä¸ªæµè¡Œçš„å¤§æ•°æ®å¼€æºæ•°æ®å¤„ç†å¼•æ“</a>ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¹¶æ’æ¯”è¾ƒç”¨äºåŸºæœ¬æ•°æ®æ“ä½œä»»åŠ¡çš„pandasä»£ç ç‰‡æ®µå’Œå®ƒä»¬åœ¨PySparkä¸­çš„å¯¹åº”éƒ¨åˆ†ã€‚</p><p id="1c2d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">è¿™ç¯‡æ–‡ç« å‡è®¾è¯»è€…èƒ½å¤Ÿç†Ÿç»ƒåœ°ä½¿ç”¨Pythonä¸­çš„pandasæ“ä½œæ•°æ®ã€‚</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e1bd" class="mc md jj bd me mf mg mh mi mj mk ml mm kp mn kq mo ks mp kt mq kv mr kw ms mt bi translated">0.èµ„æ–™ç»„ğŸ“¦</h1><p id="d748" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">è®©æˆ‘ä»¬ä»å¯¼å…¥å¿…è¦çš„åº“å¼€å§‹ã€‚åœ¨PySparkä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªSparkä¼šè¯ã€‚ä¸€æ—¦åˆ›å»ºäº†Sparkä¼šè¯ï¼Œå°±å¯ä»¥ä»:<a class="ae jg" href="http://localhost:4040/" rel="noopener ugc nofollow" target="_blank"> http://localhost:4040/ </a>è®¿é—®Spark webç”¨æˆ·ç•Œé¢(Web UI)ã€‚ä¸‹é¢å®šä¹‰çš„åº”ç”¨ç¨‹åºåç§°â€œæ•™ç¨‹â€å°†ä½œä¸ºåº”ç”¨ç¨‹åºåç§°æ˜¾ç¤ºåœ¨Web UIçš„å³ä¸Šè§’ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨Web UIï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ æœ‰å…´è¶£äº†è§£æ›´å¤šï¼Œè¯·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="c665" class="ni md jj ne b gy nj nk l nl nm">import pandas as pd<br/>from pyspark.sql import SparkSession<br/>spark = SparkSession.builder.appName('tutorial').getOrCreate()</span></pre><p id="f0ee" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a class="ae jg" href="https://github.com/mwaskom/seaborn-data/blob/master/penguins.csv" rel="noopener ugc nofollow" target="_blank">ä¼é¹…æ•°æ®é›†</a>ã€‚ä½¿ç”¨ä¸‹é¢çš„è„šæœ¬ï¼Œæˆ‘ä»¬å°†åœ¨å·¥ä½œç›®å½•ä¸­ä¿å­˜æ•°æ®çš„ä¿®æ”¹ç‰ˆæœ¬<code class="fe nn no np ne b">penguins.csv</code>ã€‚</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="6696" class="ni md jj ne b gy nj nk l nl nm">from seaborn import load_dataset<br/>(load_dataset('penguins')<br/>    .drop(columns=['culmen_length_mm', 'culmen_depth_mm'])<br/>    .rename(columns={'flipper_length_mm': 'flipper',<br/>                     'body_mass_g': 'mass'})<br/>    .to_csv('penguins.csv', index=False))</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="bc2e" class="mc md jj bd me mf mg mh mi mj mk ml mm kp mn kq mo ks mp kt mq kv mr kw ms mt bi translated">1.æ¯”è¾ƒğŸ”</h1><p id="1703" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä¸¤ä¸ªåº“ä¹‹é—´çš„è¯­æ³•æ¯”è¾ƒã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œåªæ˜¾ç¤ºPySparkè¾“å‡ºï¼Œä»¥å‡å°‘å¸–å­çš„æ··ä¹±ã€‚</p><h2 id="1bdd" class="ni md jj bd me nq nr dn mi ns nt dp mm lh nu nv mo ll nw nx mq lp ny nz ms oa bi translated">ğŸ“ 1.1.åŸºç¡€</h2><p id="9ed5" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">ä¸¤ä¸ªåº“çš„æ•°æ®å¯¹è±¡éƒ½è¢«ç§°ä¸ºdata frame:pandas data frame vs PySpark data frameã€‚è®©æˆ‘ä»¬å¯¼å…¥æ•°æ®å¹¶æ£€æŸ¥å…¶å½¢çŠ¶:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="8172" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df = pd.read_csv('penguins.csv')<br/>df.shape</span><span id="e4c1" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df = spark.read.csv('penguins.csv', header=True, inferSchema=True)<br/>df.count(), len(df.columns)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/d33fcdac3987628e1aa46e0d5358dfb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:160/format:webp/1*DaW9-ug4i5CffnKkdmuwrg.png"/></div></figure><p id="7c26" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å½“ä½¿ç”¨PySparkå¯¼å…¥æ•°æ®æ—¶ï¼Œç¬¬ä¸€è¡Œè¢«ç”¨ä½œæ ‡é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æŒ‡å®šäº†<code class="fe nn no np ne b">header=True</code>ï¼Œå¹¶ä¸”æ•°æ®ç±»å‹è¢«æ¨æ–­ä¸ºæ›´åˆé€‚çš„ç±»å‹ï¼Œå› ä¸ºæˆ‘ä»¬è®¾ç½®äº†<code class="fe nn no np ne b">inferSchema=True</code>ã€‚å¦‚æœæ‚¨æ„Ÿåˆ°å¥½å¥‡ï¼Œå¯ä»¥å°è¯•ä¸ä½¿ç”¨è¿™äº›é€‰é¡¹è¿›è¡Œå¯¼å…¥ï¼Œå¹¶æ£€æŸ¥æ•°æ®å¸§åŠå…¶æ•°æ®ç±»å‹(ä¸pandasç±»ä¼¼ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PySparkæ•°æ®å¸§çš„<code class="fe nn no np ne b">df.dtypes</code>æ¥æ£€æŸ¥æ•°æ®ç±»å‹)ã€‚</p><p id="ed7e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä¸ç†ŠçŒ«DataFrameä¸åŒï¼ŒPySpark DataFrameæ²¡æœ‰<code class="fe nn no np ne b">.shape</code>è¿™æ ·çš„å±æ€§ã€‚æ‰€ä»¥ä¸ºäº†å¾—åˆ°æ•°æ®å½¢çŠ¶ï¼Œæˆ‘ä»¬åˆ†åˆ«æ‰¾åˆ°è¡Œæ•°å’Œåˆ—æ•°ã€‚</p><p id="ad64" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥æœ‰å…³æ•°æ®çš„é«˜çº§ä¿¡æ¯:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="8ef5" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.info()</span><span id="be74" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.printSchema()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b9d6a14a135572575e970d631eef40bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*1lvegpAIOiKlvFzzGId9dg.png"/></div></figure><p id="1fc0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è™½ç„¶è¿™ä¸ªæ–¹æ³•ä¸ä¼šç»™<code class="fe nn no np ne b">df.info()</code>ç›¸åŒçš„è¾“å‡ºï¼Œä½†å®ƒæ˜¯æœ€æ¥è¿‘çš„å†…ç½®æ–¹æ³•ä¹‹ä¸€ã€‚æ˜¯æ—¶å€™çœ‹çœ‹æ•°æ®çš„å¼€å¤´äº†:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="c35e" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.head()</span><span id="9882" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.show(5)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/2cc7481f3c8bdf7dfa1716e953822fa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*sJdd7bU1DY4GmB8Wd6ObBg.png"/></div></figure><p id="5158" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœè¶…è¿‡20è¡Œï¼Œ<code class="fe nn no np ne b">df.show()</code>å°†æ˜¾ç¤º20è¡Œã€‚PySpark DataFrameå…¶å®æœ‰ä¸€ä¸ªå«<code class="fe nn no np ne b">.head()</code>çš„æ–¹æ³•ã€‚è¿è¡Œ<code class="fe nn no np ne b">df.head(5)</code>æä¾›å¦‚ä¸‹è¾“å‡º:</p><figure class="mz na nb nc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi of"><img src="../Images/4dd285b411edce7b203710ac882db451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybSNhTJ_SjT-kqoi2-iNEA.png"/></div></div></figure><p id="599b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">æ¥è‡ª<code class="fe nn no np ne b">.show()</code>æ–¹æ³•çš„è¾“å‡ºæ›´åŠ ç®€æ´ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åœ¨è¿™ç¯‡æ–‡ç« çš„å‰©ä½™éƒ¨åˆ†ä½¿ç”¨<code class="fe nn no np ne b">.show()</code>æ¥æŸ¥çœ‹æ•°æ®é›†çš„é¡¶éƒ¨è¡Œã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•é€‰æ‹©åˆ—:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="1eb9" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df[['island', 'mass']].head(3)</span><span id="64de" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df[['island', 'mass']].show(3)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c9022576cde276240b4b10a0b9e81361.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*u_GvlYYiFpkAVXyrDztUBQ.png"/></div></figure><p id="2bbb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è™½ç„¶æˆ‘ä»¬åœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨å‡ ä¹ç±»ä¼¼ç†ŠçŒ«çš„è¯­æ³•ï¼Œä½†ä»¥ä¸‹ç‰ˆæœ¬çš„ä»£ç ç‰‡æ®µå¯èƒ½æ›´å¸¸ç”¨äºåœ¨PySparkä¸­é€‰æ‹©åˆ—:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="fc3c" class="ni md jj ne b gy nj nk l nl nm">df.select('island', 'mass').show(3)<br/>df.select(['island', 'mass']).show(3)</span></pre><h2 id="66b5" class="ni md jj bd me nq nr dn mi ns nt dp mm lh nu nv mo ll nw nx mq lp ny nz ms oa bi translated">ğŸ“ 1.2.è¿‡æ»¤</h2><p id="fd22" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æ ¹æ®æ¡ä»¶è¿‡æ»¤æ•°æ®:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="6b94" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df[df['species']=='Gentoo'].head()</span><span id="5d84" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df[df['species']=='Gentoo'].show(5)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/1ec6d7e67cd18f1c9c1497a08b8b190b.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*nyAWj9FU-K_OLu2cyhuZ1A.png"/></div></div></figure><p id="c489" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™ä¸¤ä¸ªåº“çš„è¯­æ³•å‡ ä¹ç›¸åŒã€‚ä¸ºäº†è·å¾—ç›¸åŒçš„è¾“å‡ºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="b42f" class="ni md jj ne b gy nj nk l nl nm">df.filter(df['species']=='Gentoo').show(5) <!-- -->df.filter("species=='Gentoo'").show(5)<!-- --> </span></pre><p id="2203" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä¸‹é¢æ˜¾ç¤ºäº†ä¸€äº›å¸¸è§çš„è¿‡æ»¤å™¨æ¯”è¾ƒ:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="dd6e" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>2a df[df['species'].isin(['Chinstrap', 'Gentoo'])].head()<br/>3a df[df['species'].str.match('G.')].head()<br/>4a df[df['flipper'].between(225,229)].head()<br/>5a df[df['mass'].isnull()].head()</span><span id="abd9" class="ni md jj ne b gy ob nk l nl nm">1b df.loc[df['species']!='Gentoo'].head()<br/>2b df[~df['species'].isin(['Chinstrap', 'Gentoo'])].head()<br/>3b df[-df['species'].str.match('G.')].head()<br/>4b df[~df['flipper'].between(225,229)].head()<br/>5b df[df['mass'].notnull()].head()</span><span id="1722" class="ni md jj ne b gy ob nk l nl nm">6 df[(df['mass']&lt;3400) &amp; (df['sex']=='Male')].head()<br/>7 df[(df['mass']&lt;3400) | (df['sex']=='Male')].head()</span><span id="ddf7" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>2a df[df['species'].isin(['Chinstrap', 'Gentoo'])].show(5)<br/>3a df[df['species'].rlike('G.')].show(5)<br/>4a df[df['flipper'].between(225,229)].show(5)<br/>5a df[df['mass'].isNull()].show(5)</span><span id="c698" class="ni md jj ne b gy ob nk l nl nm">1b df[df['species']!='Gentoo'].show(5)<br/>2b df[~df['species'].isin(['Chinstrap', 'Gentoo'])].show(5)<br/>3b df[~df['species'].rlike('G.')].show(5)<br/>4b df[~df['flipper'].between(225,229)].show(5)<br/>5b df[df['mass'].isNotNull()].show(5)</span><span id="a077" class="ni md jj ne b gy ob nk l nl nm">6 df[(df['mass']&lt;3400) &amp; (df['sex']=='Male')].show(5)<br/>7 df[(df['mass']&lt;3400) |(df['sex']=='Male')].show(5)</span></pre><p id="3c14" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è™½ç„¶åœ¨pandasä¸­<code class="fe nn no np ne b">~</code>å’Œ<code class="fe nn no np ne b">-</code>éƒ½ç”¨ä½œå¦å®šï¼Œä½†æ˜¯åœ¨PySparkä¸­åªæœ‰<code class="fe nn no np ne b">~</code>ç”¨ä½œæœ‰æ•ˆå¦å®šã€‚</p><h2 id="e332" class="ni md jj bd me nq nr dn mi ns nt dp mm lh nu nv mo ll nw nx mq lp ny nz ms oa bi translated">ğŸ“ 1.3.æ•´ç†</h2><p id="3f44" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">è®©æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œæ£€æŸ¥è´¨é‡<em class="lu">æœ€å°çš„5è¡Œ</em>:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="070c" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.nsmallest(5, 'mass')</span><span id="da8d" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df[df['mass'].isNotNull()].orderBy('mass').show(5)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/96b1a3eaa658c13e4ce30b349b177548.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*V-3vN_DJznXqphUr8fZDpw.png"/></div></figure><p id="f85e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Pandasçš„<code class="fe nn no np ne b">.nsmallest()</code>å’Œ<code class="fe nn no np ne b">.nlargest()</code>æ–¹æ³•æ˜æ™ºåœ°æ’é™¤äº†ç¼ºå¤±å€¼ã€‚ç„¶è€Œï¼ŒPySparkæ²¡æœ‰ç­‰æ•ˆçš„æ–¹æ³•ã€‚ä¸ºäº†è·å¾—ç›¸åŒçš„è¾“å‡ºï¼Œæˆ‘ä»¬é¦–å…ˆè¿‡æ»¤æ‰ç¼ºå°‘<em class="lu">è´¨é‡</em>çš„è¡Œï¼Œç„¶åæˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œæ’åºå¹¶æ£€æŸ¥å‰5è¡Œã€‚å¦‚æœæ²¡æœ‰ä¸¢å¤±æ•°æ®ï¼Œè¯­æ³•å¯ä»¥ç¼©çŸ­ä¸º:<code class="fe nn no np ne b">df.orderBy(â€˜massâ€™).show(5)</code>ã€‚</p><p id="8e9c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨<code class="fe nn no np ne b">.sort()</code>ä»£æ›¿<code class="fe nn no np ne b">.orderBy()</code>çš„å¦ä¸€ç§æ’åºæ–¹å¼:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="5d55" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.nlargest(5, 'mass')</span><span id="8775" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.sort('mass', ascending=False).show(5)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6c62cdec7e95ebee316f1bef6018c7e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*Zos6rN9-_1hvSF-mp_fxZA.png"/></div></figure><p id="75a7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¯­æ³•çš„è¿™äº›å˜åŒ–ä¹Ÿæ˜¯æœ‰æ•ˆçš„:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="abf5" class="ni md jj ne b gy nj nk l nl nm">df.sort(df['mass'].desc()).show(5)<br/>df.orderBy('mass', ascending=False).show(5)<br/>df.orderBy(df['mass'].desc()).show(5)</span></pre><p id="ec78" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">æˆ‘ä»¬å¯ä»¥æŒ‰å¤šåˆ—æ’åºï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="ec55" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.sort_values(['mass', 'flipper'], ascending=False).head()</span><span id="6ac0" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.orderBy(['mass', 'flipper'], ascending=False).show(5)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/705c5810d51707b15edeef7fa767be7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*owo3yCuBwjIf-RFYbwGXWA.png"/></div></figure><p id="8fbd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">åœ¨PySparké‡Œï¼Œä½ å¯ä»¥è¿™æ ·ä¸ç”¨å•å­å°±è„±èº«:<code class="fe nn no np ne b">df.orderBy(â€˜massâ€™, â€˜flipperâ€™, ascending=False).show(5)</code>ã€‚è¦æŒ‰ä¸åŒæ–¹å‘çš„å¤šåˆ—æ’åº:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="b1a4" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.sort_values(['mass', 'flipper'], ascending=[True, False]).head()</span><span id="ad34" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df[df['mass'].isNotNull()]\<br/>  .sort('mass', 'flipper', ascending=[True, False]).show(5)</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/67f4aa3e59947a86ecb10ddec049a51d.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*EnccT-bvoWO3FS1FmDBdgw.png"/></div></figure><p id="a5e8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™é‡Œæœ‰ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆ:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="d290" class="ni md jj ne b gy nj nk l nl nm">df[df['mass'].isNotNull()]\<br/>  .orderBy(df['mass'].asc(), df['flipper'].desc()).show(5)</span></pre><h2 id="27be" class="ni md jj bd me nq nr dn mi ns nt dp mm lh nu nv mo ll nw nx mq lp ny nz ms oa bi translated">ğŸ“ 1.4.èšåˆ</h2><p id="5c8d" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹å‡ ä¸ªæ±‡æ€»æ•°æ®çš„ä¾‹å­ã€‚ç®€å•çš„èšåˆéå¸¸ç±»ä¼¼ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="b02a" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.agg({â€˜flipperâ€™: â€˜meanâ€™})</span><span id="15c1" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.agg({'flipper': 'mean'}).show()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/353564ab1fde29969920ff1e0d2824ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*emk2wDaooxmKCPEY1U6Zow.png"/></div></figure><p id="ec1c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">æŸ¥çœ‹å¤šä¸ªèšåˆæ—¶ï¼Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨ä¸åŒçš„æ–¹æ³•:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="997b" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.agg({'flipper': ['min', 'max']})</span><span id="d79f" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>from pyspark.sql import functions as F<br/>df.agg(F.min('flipper'), F.max('flipper')).show()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi om"><img src="../Images/d3b631dd00b0acb9e53f6a18ac2ac3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*ZvLO7cbvRefR4EZb_4UVKA.png"/></div></div></figure><p id="736c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¦è·å–åˆ—ä¸­çš„ä¸åŒå€¼:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="0484" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df['species'].unique()</span><span id="0b1b" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.select('species').distinct().show()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/4942239148d09f87a2395df2f476d794.png" data-original-src="https://miro.medium.com/v2/resize:fit:226/format:webp/1*T_Fmt3kMckljvPR5Jk2LSg.png"/></div></figure><p id="93bc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¦åœ¨ä¸€åˆ—ä¸­è·å–å¤šä¸ªä¸åŒçš„å€¼ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="b69e" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df['species'].nunique()</span><span id="1aaa" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.select('species').distinct().count()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/462418ec775db2b831fd450303803906.png" data-original-src="https://miro.medium.com/v2/resize:fit:42/format:webp/1*ptlQaWOlHhGOta37sw-KhQ.png"/></div></figure><h2 id="c7e8" class="ni md jj bd me nq nr dn mi ns nt dp mm lh nu nv mo ll nw nx mq lp ny nz ms oa bi translated">ğŸ“ 1.5.æŒ‰ç»„æ±‡æ€»</h2><p id="245e" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°PySparkåœ¨æ–¹æ³•å’Œå‡½æ•°ä¸­ä½¿ç”¨äº†<em class="lu">é©¼å³°</em>ã€‚å¯¹äº<code class="fe nn no np ne b">.groupBy()</code>ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æŒ‰èšåˆåˆ†ç»„çš„ç¤ºä¾‹:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="55fb" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.groupby('species')['mass'].mean()</span><span id="6b4b" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.groupBy('species').agg({'mass': 'mean'}).show()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/5b2a580fbe64c1a02b880c0da7bb2d26.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*t8ABhadZD9Lbjhv5101pRA.png"/></div></figure><p id="9036" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä»¥ä¸‹æ˜¯èšåˆå¤šä¸ªé€‰å®šåˆ—çš„ç¤ºä¾‹:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="f6a4" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.groupby(â€˜speciesâ€™).agg({â€˜flipperâ€™: â€˜sumâ€™, â€˜massâ€™: â€˜meanâ€™})</span><span id="b868" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.groupBy('species').agg({'flipper': 'sum', 'mass': 'mean'}).show()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/7976ae3dd82bec2517d5581e00e9cc6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*AHXy654HvK-fq8EESKRLWw.png"/></div></figure><p id="8ac0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å¦‚æœæˆ‘ä»¬ä¸æŒ‡å®šåˆ—ï¼Œå®ƒå°†æ˜¾ç¤ºæ‰€æœ‰æ•°å­—åˆ—çš„ç»Ÿè®¡ä¿¡æ¯:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="05e1" class="ni md jj ne b gy nj nk l nl nm"># ğŸ¼ pandas <br/>df.groupby('species').mean()</span><span id="a74a" class="ni md jj ne b gy ob nk l nl nm"># ğŸ‡ PySpark<br/>df.groupBy('species').mean().show()</span></pre><figure class="mz na nb nc gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/500deda6e86e56987849d72ba20e910b.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*XPqMfcN4Ukc3TbnXEgDGjQ.png"/></div></figure><p id="f724" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨<code class="fe nn no np ne b">.avg()</code>ä»£æ›¿<code class="fe nn no np ne b">.mean()</code>ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe nn no np ne b">df.groupBy(â€˜speciesâ€™).avg().show()</code>ã€‚</p><p id="5527" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„å…¨éƒ¨å†…å®¹ï¼å¸Œæœ›è¿™äº›æ¯”è¾ƒå¯¹æ‚¨æœ‰ç”¨ï¼Œå¹¶å¯¹PySparkè¯­æ³•æœ‰æ‰€äº†è§£ã€‚æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œåœ¨åŸºæœ¬ä»»åŠ¡æ–¹é¢ï¼Œè¿™ä¸¤ä¸ªåº“æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚è¿™ä½¿å¾—å¯¹ç†ŠçŒ«æœ‰å·¥ä½œçŸ¥è¯†çš„äººæ›´å®¹æ˜“å¼€å§‹ä½¿ç”¨PySparkã€‚</p><figure class="mz na nb nc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/b2b8c93b70af741d58ac7583d76ae966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D-EhHwdnI5ANdim5"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae jg" href="https://unsplash.com/@hishahadat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">æ²™å“ˆè¾¾ç‰¹Â·æ‹‰èµ«æ›¼</a>åœ¨<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="d191" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">æ‚¨æƒ³è®¿é—®æ›´å¤šè¿™æ ·çš„å†…å®¹å—ï¼Ÿåª’ä½“ä¼šå‘˜å¯ä»¥æ— é™åˆ¶åœ°è®¿é—®åª’ä½“ä¸Šçš„ä»»ä½•æ–‡ç« ã€‚å¦‚æœæ‚¨ä½¿ç”¨</em> <a class="ae jg" href="https://zluvsand.medium.com/membership" rel="noopener"> <em class="lu">æˆ‘çš„æ¨èé“¾æ¥</em> </a>ï¼Œ<em class="lu">æˆä¸ºä¼šå‘˜ï¼Œæ‚¨çš„ä¸€éƒ¨åˆ†ä¼šè´¹å°†ç›´æ¥ç”¨äºæ”¯æŒæˆ‘ã€‚</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="d24c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">æ„Ÿè°¢æ‚¨é˜…è¯»æˆ‘çš„æ–‡ç« ã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œè¿™é‡Œæœ‰æˆ‘çš„ä¸€äº›å…¶ä»–å¸–å­çš„é“¾æ¥:<br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/5-tips-for-pandas-users-e73681d16d17">ç»™pandasç”¨æˆ·çš„5ä¸ªæç¤º</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/writing-5-common-sql-queries-in-pandas-90b52f17ad76">åœ¨pandasä¸­èšåˆæ•°æ®çš„5ä¸ªæç¤º</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/writing-5-common-sql-queries-in-pandas-90b52f17ad76">åœ¨pandasä¸­ç¼–å†™5ä¸ªå¸¸è§çš„SQLæŸ¥è¯¢</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/writing-advanced-sql-queries-in-pandas-1dc494a17afe">åœ¨pandasä¸­ç¼–å†™é«˜çº§SQLæŸ¥è¯¢</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1">å¦‚ä½•åœ¨pandas DataFrameä¸­è½¬æ¢å˜é‡</a></p><p id="911b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å†è§ğŸƒ ğŸ’¨</p></div></div>    
</body>
</html>