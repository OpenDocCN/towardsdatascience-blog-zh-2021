<html>
<head>
<title>Time Series From Scratch — Train/Test Splits and Evaluation Metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始的时间序列—训练/测试分割和评估指标</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-from-scratch-train-test-splits-and-evaluation-metrics-4fd654de1b37?source=collection_archive---------1-----------------------#2021-07-26">https://towardsdatascience.com/time-series-from-scratch-train-test-splits-and-evaluation-metrics-4fd654de1b37?source=collection_archive---------1-----------------------#2021-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4e4a" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/time-series-from-scratch" rel="noopener" target="_blank">时间序列从无到有</a></h2><div class=""/><div class=""><h2 id="ec27" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">时间序列从零开始系列的第7部分—在对时间序列数据建模之前您需要知道的一切。了解如何分割和评估时间序列数据集。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/bf5ea444d86ca73b7c035aa9b3836538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YLf-AAtztRPVAy3VP42IDg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@viktortalashuk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">维克多·塔拉舒克</a>在<a class="ae lh" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="b886" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">今天，您将学习时间序列预测所需的最后一点理论知识——训练/测试分割和评估指标。这些工作方式不同于常规的机器学习。请继续阅读，看看是如何做到的。</p><p id="f8b4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这篇文章的结构如下:</p><ul class=""><li id="aa43" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">时间序列中的训练/测试分割</li><li id="29a7" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">时间序列中的评价指标</li><li id="2f38" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">结论</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="24c5" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">时间序列中的训练/测试分割</h1><p id="a978" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">在机器学习中，训练/测试分割随机分割数据，因为从一个观察到另一个观察没有依赖性。时间序列数据就不是这样了。在这里，您将希望使用数据集后面的值进行测试，而其他的都用于训练。</p><p id="55a7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，如果您每月有144条记录(12年)，一个好的方法是保留前120条记录(10年)用于训练，保留后24条记录(2年)用于测试。</p><p id="cd1c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们来看看实际情况。首先，您将导入库和数据集— <a class="ae lh" href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/airline-passengers.csv" rel="noopener ugc nofollow" target="_blank">航空乘客</a>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="e637" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是数据集的外观:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/c588143b4b2067eb37a8cf4854c27517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5s1-zK0sbhVMvyJrhIwjqw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片1-航班乘客数据集(图片由作者提供)</p></figure><p id="158c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设你想用最后两年的时间进行测试，其他时间都用来训练。您可以使用Python的<em class="nz">切片</em>符号来分割数据集:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="b205" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是两组图像:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/55be8b8cbeed02c24c5812de010103c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hCc8qdx4_RDcZdUUlkN98Q.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图2-航空乘客培训和测试数据集(图片由作者提供)</p></figure><p id="06ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这就是训练/测试劈叉的全部内容。<strong class="lk jd">请记住</strong>——永远不要随机分割时间序列数据。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="1520" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">评估指标</h1><p id="774a" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">评估时间序列模型时，您可以选择相对模型性能指标或一般回归指标。</p><h2 id="69c2" class="oa na it bd nb ob oc dn nf od oe dp nj lr of og nl lv oh oi nn lz oj ok np iz bi translated">相对模型性能指标</h2><p id="40b5" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">在选择时间序列模型时，你会经常听到两个首字母缩略词——AIC和BIC。</p><p id="458c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">AIC，或者说<em class="nz">阿凯克信息标准</em>，向你展示一个模型相对于其他模型有多好。AIC为了简单的模型而惩罚复杂的模型。例如，如果两个模型具有相同的预测性能，但第二个模型有10个以上的参数，AIC将倾向于第一个模型。</p><p id="6189" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">模型的AIC值通过以下公式计算:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/dcc04315547f9f012795537949c64eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*YPV8nHvKuUBt2PQFRtzJSQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片3 — AIC公式(图片由作者提供)</p></figure><p id="1e86" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中<em class="nz"> k </em>是模型中参数的个数，<em class="nz"> L-hat </em>是模型的似然函数的最大值，<em class="nz"> ln </em>是自然对数。</p><p id="c75c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">BIC，或者说<em class="nz">贝叶斯信息准则</em>，类似于AIC。它是在ceratin Bayesian设置下对模型为真的后验概率函数的估计(<a class="ae lh" href="https://www.methodology.psu.edu/resources/AIC-vs-BIC/" rel="noopener ugc nofollow" target="_blank">来源</a>)。同样，值越低，模型越好。</p><p id="34ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">模型的BIC值通过以下公式计算:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/991227d23eafd5340a2efcf638e2fc3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*bTjX2goRG7-bZ_J5HVxPGg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片4 — BIC公式(图片由作者提供)</p></figure><p id="1ca4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中<em class="nz"> k </em>是模型中参数的个数，<em class="nz"> L-hat </em>是模型的似然函数的最大值，<em class="nz"> n </em>是数据点的个数(样本大小)，而<em class="nz"> ln </em>是自然对数。</p><p id="b6fe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们今天不会讨论AIC和BIC的Python实现，因为那需要训练多个预测模型。您将在以后的文章中看到这些是如何工作的。</p><p id="ffd4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">记住，AIC和BIC都是相对指标，所以你不能直接比较不同数据集的模型。而是选择分数最低的型号。</p><h1 id="97ef" class="mz na it bd nb nc on ne nf ng oo ni nj ki op kj nl kl oq km nn ko or kp np nq bi translated">一般回归度量</h1><p id="3e90" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">您可以使用任何回归评估指标，如MAE、MSE或RMSE来评估时间序列预测。我们今天将讨论其中的两个:</p><ul class=""><li id="aed3" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><strong class="lk jd"> RMSE </strong> —均方根误差</li><li id="d101" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd"> MAPE </strong> —平均绝对百分比误差</li></ul><p id="287c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">RMSE会告诉你你的模型平均有多少单位是错的。在我们的航空乘客示例中，RMSE将告诉您在每次预测中您预计模型会错过多少乘客。</p><p id="6003" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">MAPE告诉你，你的预测在百分比上是多么的错误。我喜欢它是因为，在某种程度上，它相当于分类问题中的<em class="nz">精度度量</em>。例如，MAPE值0.02意味着您的预测98%准确。</p><p id="dfb5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Scikit-learn包没有RMSE的官方实现，所以我们必须手动计算MSE值的平方根。</p><p id="f22d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们用代码来实现这两者——我们将把“rmse”声明为lambda函数，生成任意的实际和预测数据，并计算误差指标:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="e52c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/3a52ff9db5ce60d56296540f7d3c1447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*7DyETSAr2QEuoLBaCOg1rQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片5——RMSE和MAPE价值观(图片由作者提供)</p></figure><p id="2e7a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简而言之——平均每个月，预测会有10个乘客单位(数千)的误差，或者2.5%左右。你应该知道的就这些。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="f403" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">结论</h1><p id="5024" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">这就是你要做的——在对时间序列数据建模之前，你需要的最后一点理论知识。现在，您知道了如何分离用于训练和测试的数据，以及如何评估模型和原始预测。</p><p id="eb6a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下一篇文章中，您将构建您的第一个预测模型——使用简单和指数移动平均线。这些通常是更精细模型的基线，但是你会发现它们在一些问题上非常有效。</p><p id="3b94" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">感谢阅读。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="a5ea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">喜欢这篇文章吗？成为 <a class="ae lh" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="nz">中等会员</em> </a> <em class="nz">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ot ou gp gr ov ow"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd jd gy z fp pb fr fs pc fu fw jc bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">medium.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk lb ow"/></div></div></a></div></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="24ad" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">从零开始的时间序列</h1><ol class=""><li id="6af3" class="me mf it lk b ll nr lo ns lr pl lv pm lz pn md po mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/time-series-analysis-from-scratch-seeing-the-big-picture-2d0f9d837329">看清大局</a></li><li id="e677" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md po mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/time-series-from-scratch-introduction-to-time-series-with-pandas-347ac9c6b451">熊猫时间序列介绍</a></li><li id="9574" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md po mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/time-series-from-scratch-white-noise-and-random-walk-5c96270514d3">白噪声和随机游走</a></li><li id="a7b2" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md po mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/time-series-from-scratch-decomposing-time-series-data-7b7ad0c30fe7">分解时间序列数据</a></li><li id="0fba" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md po mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/time-series-from-scratch-autocorrelation-and-partial-autocorrelation-explained-1dd641e3076f">自相关和偏自相关</a></li><li id="99ee" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md po mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/time-series-from-scratch-stationarity-tests-and-automation-14b02fa5ca4d">稳定性测试和自动化</a></li></ol></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="5a38" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">保持联系</h1><ul class=""><li id="13b0" class="me mf it lk b ll nr lo ns lr pl lv pm lz pn md mj mk ml mm bi translated">关注我在<a class="ae lh" href="https://medium.com/@radecicdario" rel="noopener">媒体</a>上的更多类似的故事</li><li id="b484" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">注册我的<a class="ae lh" href="https://mailchi.mp/46a3d2989d9b/bdssubscribe" rel="noopener ugc nofollow" target="_blank">简讯</a></li><li id="d180" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">在<a class="ae lh" href="https://www.linkedin.com/in/darioradecic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</li></ul></div></div>    
</body>
</html>