<html>
<head>
<title>Automating Machine Learning Using FLAML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用FLAML实现机器学习自动化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-machine-learning-using-flaml-46400b94a6b3?source=collection_archive---------11-----------------------#2021-09-17">https://towardsdatascience.com/automating-machine-learning-using-flaml-46400b94a6b3?source=collection_archive---------11-----------------------#2021-09-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8d0d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用FLAML实现机器学习过程的自动化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7afb3d4ed52a4e16f9308f4b377335b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5_yGpQJ6KfZBH-1r"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@pietrozj?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pietro Jeng </a>拍摄</p></figure><p id="eee9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习是一个过程，在这个过程中，我们试图使用一套不同的算法来解决现实生活中的商业问题。创建机器学习模型很容易，但选择哪个模型在泛化和性能方面最适合我们的数据是一项困难的任务。</p><p id="6045" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回归和分类都有各种各样的机器学习算法。这些可以根据我们试图解决的问题的类型来选择，但是这是一个需要很高的计算成本、时间和努力的过程。有不同的Python库提供了一个选项来自动高效地选择最佳机器学习模型的过程，其中一个这样的库是FLAML。</p><p id="8cf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FLAML是一个轻量级开源Python库，有助于自动、高效、经济地找出最佳的机器学习模型。它既快又省时，而且设计轻巧。</p><p id="de51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将探索FLAML及其功能。</p><p id="f00c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧…</p><h1 id="34f2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装所需的库</h1><p id="8512" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将从使用pip安装来安装FLAML开始。下面给出的命令将使用pip安装FLAML。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="52a7" class="mx lw it mt b gy my mz l na nb">pip install flaml</span></pre><h1 id="0909" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">导入所需的库</h1><p id="7011" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这一步中，我们将导入创建机器学习模型和下载数据集所需的所有库。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="77fd" class="mx lw it mt b gy my mz l na nb">from flaml import AutoML</span></pre><h1 id="3ec4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">解决分类问题</h1><p id="cc84" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们将从解决一个分类问题开始。我们将在这里使用的数据是著名的Iris数据集，可以很容易地从Seaborn库中加载。让我们开始创建模型。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="ff9e" class="mx lw it mt b gy my mz l na nb">#Loading the Dataset<br/>from sklearn.datasets import load_iris</span></pre><p id="28c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为Automl创建实例很重要，定义Automl设置也很重要，因此在这一步中，我们还将创建Automl实例并定义设置。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d97f" class="mx lw it mt b gy my mz l na nb">automl = AutoML()</span><span id="238f" class="mx lw it mt b gy nc mz l na nb">automl_settings = {<br/>    "time_budget": 10,  # in seconds<br/>    "metric": 'accuracy',<br/>    "task": 'classification'<br/>}</span></pre><p id="275f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将拆分数据负载，并将其放入模型中。最后，我们还将使用模型进行预测，并找到最佳模型。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="1f88" class="mx lw it mt b gy my mz l na nb">X_train, y_train = load_iris(return_X_y=True)<br/># Train with labeled input data<br/>automl.fit(X_train=X_train, y_train=y_train,<br/>           **automl_settings)</span><span id="cb6e" class="mx lw it mt b gy nc mz l na nb">print(automl.predict_proba(X_train).shape)<br/># Export the best model<br/>print(automl.model)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c573d0311377a9fdbd9ae43c05a18a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*wCMQ7rNXiFT7oV1-F8sg9w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型(来源:作者)</p></figure><p id="8ed5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们可以清楚地看到，额外的树估计量是这个数据的最佳模型。现在让我们打印出模型的最佳超参数和精确度。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="a060" class="mx lw it mt b gy my mz l na nb">print('Best ML leaner:', automl.best_estimator)<br/>print('Best hyperparmeter config:', automl.best_config)<br/>print('Best accuracy on validation data: {0:.4g}'.format(1-automl.best_loss))<br/>print('Training duration of best run: {0:.4g} s'.format(automl.best_config_train_time))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/ee98fc80e3e0927afc300a0f15eda2c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdLz63BKIRxmrBn76w3krw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最佳模特(来源:作者)</p></figure><p id="afee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，对于回归问题，我们也将遵循相同的过程。</p><h1 id="13fa" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">解决回归问题</h1><p id="6bed" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们将解决一个回归问题。我们将在这里使用的数据是著名的波士顿数据集，可以很容易地从Seaborn库中加载。我们可以遵循与分类问题完全相同的过程。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="fcf1" class="mx lw it mt b gy my mz l na nb">from sklearn.datasets import load_boston<br/><br/>automl = AutoML()<br/><br/>automl_settings = {<br/>    "time_budget": 10,  # in seconds<br/>    "metric": 'r2',<br/>    "task": 'regression'<br/>}<br/>X_train, y_train = load_boston(return_X_y=True)<br/># Train with labeled input data<br/>automl.fit(X_train=X_train, y_train=y_train,<br/>           **automl_settings)<br/># Predict<br/>print(automl.predict(X_train).shape)<br/># Export the best model<br/>print(automl.model)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/9b268ef63ac83a8b84fd69f5d5ce7f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*9unwX7k0yvDWeBfGTNYyEg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型(来源:作者)</p></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c908" class="mx lw it mt b gy my mz l na nb">print('Best ML leaner:', automl.best_estimator)<br/>print('Best hyperparmeter config:', automl.best_config)<br/>print('Best accuracy on validation data: {0:.4g}'.format(1-automl.best_loss))<br/>print('Training duration of best run: {0:.4g} s'.format(automl.best_config_train_time))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/086d08fd2929ffb4e5ab478361a448cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O-IP2vcOGi6w2rnB3P8Rpg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最佳模特(来源:作者)</p></figure><p id="b9a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们可以清楚地看到回归问题的最佳模型和超参数。</p><p id="8008" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，您可以对您的数据集执行此过程，并为您的问题找到最佳模型和超参数。尝试使用不同的数据集，并在回复部分告诉我您的意见。</p><p id="d14b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文是与<a class="nh ni ep" href="https://medium.com/u/40808d551f5a?source=post_page-----46400b94a6b3--------------------------------" rel="noopener" target="_blank"> Piyush Ingale </a>合作完成的。</p><h1 id="7053" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在你走之前</h1><p id="3c3e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu"> <em class="nj">感谢</em> </strong> <em class="nj">的阅读！如果你想与我取得联系，请随时联系我在hmix13@gmail.com或我的</em> <a class="ae ky" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nj"> LinkedIn简介</em> </strong> </a> <em class="nj">。可以查看我的</em><a class="ae ky" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="nj">Github</em></strong><em class="nj"/></a><em class="nj">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae ky" href="https://medium.com/@hmix13" rel="noopener"> <strong class="lb iu"> <em class="nj">我的简介</em> </strong> </a> <em class="nj">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>