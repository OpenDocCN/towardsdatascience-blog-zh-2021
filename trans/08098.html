<html>
<head>
<title>Essential Functions in Excel for Data Preprocessing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Excel中用于数据预处理的基本函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/essential-functions-in-excel-for-data-preprocessing-140f002f3ca?source=collection_archive---------12-----------------------#2021-07-25">https://towardsdatascience.com/essential-functions-in-excel-for-data-preprocessing-140f002f3ca?source=collection_archive---------12-----------------------#2021-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dc1c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">本文讨论了Microsoft Excel中用于数据预处理的几个基本函数以及几个示例。这些函数简化了数据预处理的过程。</h2></div><p id="2f57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">本文假设读者对Excel函数有基本的了解。</em></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/188e54a69d2943052f459671005b40e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTwZq7ceSHClNuAconBNig.jpeg"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">照片由<a class="ae ls" href="https://unsplash.com/@mbaumi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">米卡·鲍梅斯特</a>在<a class="ae ls" href="https://unsplash.com/s/photos/spreadsheet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="9313" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于非程序员来说，Microsoft Excel是预处理和处理结构化数据的绝佳工具。Excel有一些功能和技术可以使清理结构化数据变得更加容易。我们将讨论许多函数中的几个，并给出几个例子。在继续之前，我们将讨论几个基本函数，它们将是本文后面一个更大的公式的一部分。</p><h1 id="1c16" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">基本功能</h1><ol class=""><li id="f44c" class="ml mm iq kh b ki mn kl mo ko mp ks mq kw mr la ms mt mu mv bi translated"><strong class="kh ir">如果</strong></li></ol><p id="cc74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个函数检查一个条件，并相应地返回一个指定的值。在下面的示例中，该函数检查条件“是2大于3”。如果条件为真(事实并非如此),则函数返回“2 &gt; 3 ”,否则返回“2 &lt; 3”.</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="3cdc" class="nb lu iq mx b gy nc nd l ne nf">=IF(2&gt;3,"2 &gt; 3","2 &lt; 3")</span></pre><p id="5c7d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Since, 2 isn’t greater than 3, so the condition is FALSE and the value returned will be “2 &lt; 3”.</p><p id="8346" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2. <strong class="kh ir"> IFERROR </strong></p><p id="4644" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该函数有助于错误处理。在Excel中，最常见的错误是#N/A，#VALUE！，#DIV/0！，#REF！，#姓名？，#NUM！，不一而足。让我们来看一个错误处理的例子，我们试图用1除以0。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="6718" class="nb lu iq mx b gy nc nd l ne nf">=IFERROR(1/0,-1000)</span></pre><p id="a2f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的例子中，我们将1除以0。此计算返回一个错误(#DIV/0！).IFERROR函数将计算/公式作为输入，如果计算结果不是错误，则返回计算结果。如果结果是错误的，则返回我们指定的值(在上例中为-1000)。</p><p id="b2b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果不处理，包含错误计算的公式也会返回错误。例如，如果我们添加10个数字(使用SUM函数),其中#DIV/0！是10个数字之一，那么SUM函数也将返回#DIV/0！。</p><p id="a174" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.<strong class="kh ir">左</strong></p><p id="4782" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个函数返回字符串的前n个字符。我们来看一个例子，提取字符串“Excel”的前三个字符。该函数的输出将是“Exc”。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="f748" class="nb lu iq mx b gy nc nd l ne nf">=LEFT("Excel",3)</span></pre><p id="41cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 4。右侧</strong></p><p id="bbd8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个函数返回字符串的最后n个字符。我们来看一个例子，提取字符串“Excel”的后三个字符。该函数的输出将是“cel”。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="0990" class="nb lu iq mx b gy nc nd l ne nf">=RIGHT("Excel",3)</span></pre><p id="5481" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 5。中旬</strong></p><p id="65f1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们输入起始数和要返回的字符数，这个函数将返回一个字符串的子串。让我们看一个从字符串“Excel”中提取子字符串“xce”的例子。在本例中，起始数字是2，要返回的字符数是3。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="3df7" class="nb lu iq mx b gy nc nd l ne nf">=MID("Excel",2,3)</span></pre><p id="b310" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 6。找到</strong></p><p id="db90" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此函数返回子字符串/字符在字符串中第一次出现的位置。我们来看一个例子，求子串“ce”在字符串“Excel”中的位置。该函数返回3，因为它是第一个也是唯一一个“ce”出现的位置。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="0210" class="nb lu iq mx b gy nc nd l ne nf">=FIND("ce","Excel")</span></pre><p id="4818" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">查找功能还使用户能够控制搜索的起点。我们来看一个例子，找出“a”在“abca”中第二次出现的位置。我们将添加一个起点参数2(因为我们想从搜索中排除第一个“a”)。该函数返回4。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="4e58" class="nb lu iq mx b gy nc nd l ne nf">=FIND("a","abca",2)</span></pre><p id="a021" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FIND中的搜索是区分大小写的，还有一个名为search的函数和FIND一样，但是它的搜索是不区分大小写的。查找和搜索函数返回#VALUE！如果在字符串中找不到指定的子字符串/字符，则出现错误。</p><p id="ed96" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 7。ISNUMBER </strong></p><p id="b0ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果给定的输入是一个数字，这个函数返回TRUE，否则返回FALSE。让我们看一个例子，在这个例子中，我们将“abc”和123输入到函数中。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="8526" class="nb lu iq mx b gy nc nd l ne nf">=ISNUMBER("abc")<br/>=ISNUMBER(123)</span></pre><p id="c456" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的示例中，第一个公式返回FALSE，因为“abc”不是数字。第二个公式返回TRUE，因为123是一个数字。</p><p id="5a14" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 8。ISTEXT </strong></p><p id="4af9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果给定的输入是字符串/文本，该函数返回TRUE，否则返回FALSE。让我们看一个例子，在这个例子中，我们将“abc”和123输入到函数中。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="d919" class="nb lu iq mx b gy nc nd l ne nf">=ISTEXT("abc")<br/>=ISTEXT(123)</span></pre><p id="32f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的示例中，第一个公式返回TRUE，因为“abc”是一个字符串/文本。第二个公式返回FALSE，因为123是一个数字。</p><p id="708a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 9。替换</strong></p><p id="cbb1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此函数用替换字符串替换字符串中第n次出现的子字符串。此函数区分大小写，默认情况下“n”为1。我们来看一个例子，将字符串“Excel很酷”中的“Excel”替换为“MS Excel”。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="69c1" class="nb lu iq mx b gy nc nd l ne nf">=SUBSTITUTE("Excel is cool","Excel","MS Excel")</span></pre><p id="f339" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看另一个例子，在字符串“Excel很酷”中用“它”替换第二次出现的“Excel”。Excel是微软开发的”。该公式返回“Excel很酷。它是由微软开发的”。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="17b2" class="nb lu iq mx b gy nc nd l ne nf">=SUBSTITUTE("Excel is cool. Excel is developed by Microsoft","Excel","It",2)</span></pre><p id="16ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 10。修剪</strong></p><p id="103c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个函数从字符串中删除前导和尾随空格。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="d8fc" class="nb lu iq mx b gy nc nd l ne nf">=TRIM(" a ") returns "a"</span></pre><p id="93d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 11。计数</strong></p><p id="73eb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该函数返回一组单元格中非空单元格的计数。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="b241" class="nb lu iq mx b gy nc nd l ne nf">=COUNTA(A1:A10)</span></pre><p id="78fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 12。COUNTBLANK </strong></p><p id="2c11" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该函数返回一组单元格中的空单元格数。此函数有助于查找列中缺失值的计数。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="1363" class="nb lu iq mx b gy nc nd l ne nf">=COUNTBLANK(A1:A10)</span></pre><p id="dad7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 13。COUNTIF </strong></p><p id="1026" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该函数返回一组单元格中指定值的计数。这对于查找被999，-1000，-等值屏蔽的缺失值的计数很有用。等。让我们来看一个例子，计算一系列单元格中出现“-”的次数。我们还可以指定包含搜索条件的单元格地址，而不是“-”。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="fa7c" class="nb lu iq mx b gy nc nd l ne nf">=COUNTIF(A1:A10,"-")<br/>=COUNTIF(A1:A10,B1)</span></pre><h1 id="a538" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">几个数据预处理示例</h1><ol class=""><li id="31dc" class="ml mm iq kh b ki mn kl mo ko mp ks mq kw mr la ms mt mu mv bi translated"><strong class="kh ir">找出一个单词在一个字符串中出现的次数</strong></li></ol><p id="bfb0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可能需要计算一个单词/字符在一个字符串中出现的次数。让我们看一个例子来计算单词“is”在字符串中出现的次数。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/855a29c0e8d42f7ed2c6e5a2ef1efd02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*kG1biZpMB14iu8nYuLKSJw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="7e8e" class="nb lu iq mx b gy nc nd l ne nf">=(LEN(A2)-LEN(SUBSTITUTE(LOWER(A2),"is","")))/LEN("is")</span></pre><p id="b599" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们将公式分解成几个部分，以便更好地理解它，并将其应用于上图的单元格A2中的名称。</p><ul class=""><li id="4018" class="ml mm iq kh b ki kj kl km ko nh ks ni kw nj la nk mt mu mv bi translated">LEN(A2)计算字符串的长度。这将返回44。</li><li id="f94e" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">LEN(SUBSTITUTE(LOWER(A2)，" is "，""))从字符串中删除单词" is "并计算其长度。这会返回40。A2中的字符串被转换为小写，以使替代函数不区分大小写。</li><li id="0c07" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">我们从原始字符串的长度中减去不带“is”的字符串的长度。这给出了单词“is”在字符串中出现的次数(即2)乘以单词“is”的长度(即2)，因此，我们得到2 * 2 = 4。因此，我们需要将结果除以搜索字符串的长度(即“is”的长度为2)，最终得到4 / 2 = 2。</li></ul><p id="415a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2。统计字符串中的单词数</strong></p><p id="0f36" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可能需要找出一个字符串中的单词数。让我们来看一个来自泰坦尼克号数据集的例子，来计算一个乘客名字中的单词数。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/39a6c09296308e7154bedbdb49da53e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*RNYbhJwmBeuMmNHPJu1mhQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="be0b" class="nb lu iq mx b gy nc nd l ne nf">=LEN(A2)-LEN(SUBSTITUTE(A2," ",""))+1</span></pre><p id="605b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们将公式分解成几个部分，以便更好地理解它，并将其应用于上图的单元格A2中的名称。</p><ul class=""><li id="22e3" class="ml mm iq kh b ki kj kl km ko nh ks ni kw nj la nk mt mu mv bi translated">LEN(A2)计算字符串的长度。这将返回23。</li><li id="2fb3" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">LEN(SUBSTITUTE(A2，" "，""))从字符串中删除空格，并计算字符串的长度。这会返回20。</li><li id="5c5c" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">我们从原始字符串的长度中减去不带空格的字符串的长度。这给了我们字符串中的空格数，即3。将空格数加1得到单词数，即4。</li></ul><p id="c6aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 3。提取字符串的第一个单词</strong></p><p id="0355" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在某些情况下，我们可能需要从现有特征创建附加特征。让我们看一个从人名中提取人名的例子。我们假设一个名字的第一个单词就是标题。没有空格的名字被认为没有头衔。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/fef340f66ab04795ef6dd726f2c51de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*c-ggjyfIefpk0DnQ07affQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="2c8b" class="nb lu iq mx b gy nc nd l ne nf">=LEFT(A6,IFERROR(FIND(" ",A6)-1,0))</span></pre><p id="b56b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们将公式分解成几个部分，以便更好地理解它，并将其应用于上图的单元格A2中的名称。</p><ul class=""><li id="fc17" class="ml mm iq kh b ki kj kl km ko nh ks ni kw nj la nk mt mu mv bi translated">FIND返回名称中第一个空格的位置，即4。我们从位置中减去1来排除空间本身。现在变成了3。</li><li id="a9ef" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">如果名称中没有空格，IFERROR将处理FIND返回的错误。如果名称没有空格，IFERROR返回0。在这种情况下，名称中有一个空格。因此，FIND不会返回任何错误。</li><li id="edad" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">LEFT返回FIND返回的前n个字符，即前3个字符。如果名称中没有空格(如上图中的单元格A6 ),则IFERROR返回0，LEFT返回前0个字符，即nothing。</li></ul><p id="cdd5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 4。提取一个字符串的最后一个单词</strong></p><p id="bc57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看一个从名字中提取姓氏的例子。我们假设一个名字的最后一个字是姓氏。当名称中没有空格时，名称将按原样返回。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ns"><img src="../Images/e7ace1f1b1a35127bde8b59db22d93a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LkSYEM-Mz7SbiixuBnyGcw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="2e69" class="nb lu iq mx b gy nc nd l ne nf">=MID(A2,IFERROR(FIND("~",SUBSTITUTE(A2," ","~",LEN(A2)-LEN(SUBSTITUTE(A2," ",""))))+1,1),LEN(A2))</span></pre><p id="f76f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">把公式分解成几部分来解释可能会使事情变得复杂。所以，我们只讨论其中涉及的过程。</p><ul class=""><li id="e14d" class="ml mm iq kh b ki kj kl km ko nh ks ni kw nj la nk mt mu mv bi translated">通过查找字符串中的空格数，可以找到空格最后出现的位置。</li><li id="0ec5" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">最后一个空格被替换为“~”(可以是不属于字符串的任何字符)。</li><li id="52dd" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">我们找到了字符串中“~”的位置，这又是空格在字符串中最后一次出现的位置。加上1会使位置增加1，因此不包括空格。</li><li id="4515" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">如果字符串中没有空格，IFERROR返回原始字符串的长度。</li><li id="ac5e" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">MID返回从最后一个空格开始直到字符串结束的子字符串。由于要提取的字符数量未知，我们可以给出最大可能数量，即原始字符串的长度。</li></ul><p id="ad0b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 5。提取字符串的第n个单词</strong></p><p id="327f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看一个例子，从Titanic数据集中的人名中提取人名。名字的第二个字是头衔。因为第二个单词是大多数名称中的标题，所以建议使用Excel的文本到列功能。然而，我们也将讨论公式。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/5d514a4b85f73202f41aac4fe5186bc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*O_ZWzOYjxKtMtplgs3JFlg.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="b694" class="nb lu iq mx b gy nc nd l ne nf">=SUBSTITUTE(LEFT(MID(A2,IFERROR(FIND("~",SUBSTITUTE(A2," ","~",1))+1,1),LEN(A2)),IFERROR(FIND(" ",MID(A2,IFERROR(FIND("~",SUBSTITUTE(A2," ","~",1))+1,1),LEN(A2)))-1,LEN(A2))),".","")</span></pre><p id="0583" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在SUBSTITUTE(A2，" "，" ~ "，1)中用' n-1 '替换1，提取字符串的' n '个单词。在上面的例子中，我们提取了字符串的第二个单词，所以它是1。下面的公式提取字符串的第三个单词。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="e06e" class="nb lu iq mx b gy nc nd l ne nf">=SUBSTITUTE(LEFT(MID(A2,IFERROR(FIND("~",SUBSTITUTE(A2," ","~",2))+1,1),LEN(A2)),IFERROR(FIND(" ",MID(A2,IFERROR(FIND("~",SUBSTITUTE(A2," ","~",2))+1,1),LEN(A2)))-1,LEN(A2))),".","")</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/def7ab0c3f447541fa91730e603c7b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*gGjqWMjjJ0l8fe-fOD-Bpw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><p id="44e9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">把公式分解成几部分来解释可能会使事情变得复杂。所以，让我们只讨论提取第n个单词的过程。</p><ul class=""><li id="591e" class="ml mm iq kh b ki kj kl km ko nh ks ni kw nj la nk mt mu mv bi translated">最后出现的“n-1”个空格被替换为“~”(可以是不属于字符串的任何字符)。</li><li id="c60f" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">我们找到了字符串中“~”的位置，这又是空格在字符串中最后一次出现的位置。加上1会使位置增加1，因此不包括空格。</li><li id="0b32" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">如果字符串中没有空格，IFERROR返回原始字符串的长度。</li><li id="7f67" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">MID返回从最后一个空格开始直到字符串结束的子字符串。由于要提取的字符数量未知，我们可以给出最大可能数量，即原始字符串的长度。</li><li id="cd93" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">提取结果字符串的第一个单词，如示例3所示。</li><li id="6236" class="ml mm iq kh b ki nl kl nm ko nn ks no kw np la nk mt mu mv bi translated">替换句点(。)在标题的末尾加上一个空字符串(" ")。</li></ul><p id="3a6f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 6。最小-最大标准化</strong></p><p id="69fc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最小-最大归一化对数值特征进行归一化，使其保持在范围[0，1]内。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/e87e161083e9bfe0adc63a73bd61fad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*p4DjyIg86233eMYofP_PJw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="67ce" class="nb lu iq mx b gy nc nd l ne nf">=(A2-MIN($A$2:$A$9))/(MAX($A$2:$A$9)-MIN($A$2:$A$9))</span></pre><p id="1618" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用下面的公式在范围[new_min，new_max]内对数据进行归一化。在下面的公式中，new_max = 10，new_min = 1。因此，数据将被归一化，以使它们保持在范围[1，10]内。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="dfaf" class="nb lu iq mx b gy nc nd l ne nf">=(((A2-MIN($A$2:$A$9))/(MAX($A$2:$A$9)-MIN($A$2:$A$9)))*(10-1))+1</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nv"><img src="../Images/36881f05d91912f6ea2ca98029ac9b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PdTw5EVhyAvOzLuVGe1ZFg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><p id="0338" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">7 .<strong class="kh ir">。离散化</strong></p><p id="2704" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">离散化将数值特征转换为分类特征。它将数字特征转换成类区间，如0–10、11–20等。一旦确定了类间隔/箱，我们就可以使用Excel公式来离散化数据。在下面的例子中，我们将数值离散化为4个类区间，即“0到30”、“31到60”、“61到90”和“91到100”。任何大于100的值都被指定为“未定义”类。</p><pre class="ld le lf lg gt mw mx my mz aw na bi"><span id="c8bd" class="nb lu iq mx b gy nc nd l ne nf">=IF(AND(A2&gt;90,A2&lt;=100),"91 to 100",IF(A2&lt;=30,"0 to 30",IF(AND(A2&gt;=31,A2&lt;=60),"31 to 60",IF(AND(A2&gt;=61,A2&lt;=90),"61 to 90","Undefined"))))</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/faaaadb8bdfbe9e713ea46d8f36794a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:282/format:webp/1*uR2MkwQHvzBw2ZUOkCV2QQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者图片</p></figure><p id="c24d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一些使用Excel函数的数据预处理技术。还有其他预处理/清理技术可以在不使用函数的情况下在Excel中完成，这些技术不在本文中讨论。如果你有编程背景，建议使用Python或r等编程语言，对于非程序员来说，Excel是处理结构化数据的最佳选择之一。</p></div></div>    
</body>
</html>