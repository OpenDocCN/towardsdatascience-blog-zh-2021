<html>
<head>
<title>Two-sample Inference for the Difference Between Groups with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python实现组间差异的双样本推断</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9?source=collection_archive---------11-----------------------#2021-07-06">https://towardsdatascience.com/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9?source=collection_archive---------11-----------------------#2021-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c640" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python实现大学统计</h2></div><h1 id="42f5" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="8762" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在一系列的每周文章中，我将会涉及一些重要的统计学主题。</p><p id="80ac" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">目标是使用Python来帮助我们获得对复杂概念的直觉，从经验上测试理论证明，或者从零开始构建算法。在本系列中，您将会看到涵盖随机变量、抽样分布、置信区间、显著性检验等主题的文章。</p><p id="31fb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在每篇文章的最后，你可以找到练习来测试你的知识。解决方案将在下周的文章中分享。</p><p id="b8d3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">迄今发表的文章:</p><ul class=""><li id="fbec" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/bernoulli-and-binomial-random-variables-d0698288dd36">伯努利和二项随机变量与Python </a></li><li id="a180" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55">用Python从二项式到几何和泊松随机变量</a></li><li id="b1df" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/sampling-distributions-with-python-f5a5f268f636">用Python实现样本比例的抽样分布</a></li><li id="83d3" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/confidence-intervals-with-python-bfa28ebb81c">Python的置信区间</a></li><li id="5eab" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6">使用Python进行显著性测试</a></li><li id="b25d" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9">用Python进行组间差异的双样本推断</a></li><li id="b3e9" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/inference-for-categorical-data-9f3c6034aa57">分类数据的推断</a></li><li id="5520" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/advanced-regression-f74090014f3">高级回归</a></li><li id="12a1" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/analysis-of-variance-anova-8dc889d2fc3a">方差分析— ANOVA </a></li></ul><p id="daf1" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">像往常一样，代码可以在我的<a class="ae mk" href="https://github.com/luisroque/College_Statistics_with_Python" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h1 id="213b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">比较人口比例</h1><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mq"><img src="../Images/3064a07877bc83a0f024d877bd006af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mZTTmppv7mtbFQoe"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图1:2021年葡萄牙地方选举将于同年9月26日举行；<a class="ae mk" href="https://unsplash.com/photos/T9CXBZLUvic" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="0765" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">假设波尔图市的一名候选人对比较投票给他的男女比例感兴趣。在那个周末，一项新的民意调查得出了以下信息:在1000名男性样本中，62%的人回答说将投票给他，在1000名女性样本中，57%的人回答说将投票给他。实际上，这是两种伯努利分布，我们可以用参数来定义:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c8d974a33efb6513e3d83795660cc69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*96EYshreVI8gb_hXbN08Bg.png"/></div></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="d646" class="nm kj it ni b gy nn no l np nq">from scipy.stats import bernoulli, norm<br/>import numpy as np<br/>import seaborn as sns<br/>import math<br/>import matplotlib.pyplot as plt<br/>from graphviz import Digraph</span><span id="8bbf" class="nm kj it ni b gy nr no l np nq"># Theoretical parameters for men<br/>p1 = 0.65<br/>n1=1000<br/>n = n1<br/><br/>μ_1 = p1<br/>var_1 = p1*(1-p1)<br/><br/>dist_men = np.concatenate((np.ones(int(p1*n)), np.zeros(int(n-(p1*n)))))<br/>sns.histplot(dist_men);</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/054a18403eb35268c888506b4322d2b6.png" data-original-src="https://miro.medium.com/v2/format:webp/1*heiRnjw8Yh2rg_JotwK6mQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图2:男性选民的伯努利分布。</p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="d440" class="nm kj it ni b gy nn no l np nq"># Theoretical parameters for women<br/>p2 = 0.58<br/>n2 = n<br/><br/>μ_2 = p2<br/>var_2 = p2*(1-p2)<br/><br/>dist_women = np.concatenate((np.ones(int(p2*n)), np.zeros(int(n-(p2*n)))))<br/>sns.histplot(dist_women);</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/adfd9ad89998208d1e1c5d90cf40e503.png" data-original-src="https://miro.medium.com/v2/format:webp/1*mTGlATg0RWMqeHvvvK_02w.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图3:女性选民的伯努利分布。</p></figure><p id="4ff0" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们想弄清楚男性和女性投票给候选人的方式是否有显著的不同。实际上，我们希望得出该差异的95%置信区间。</p><p id="c1e1" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">因为样本量足够大，我们可以假设正态分布可以近似样本比例的抽样分布。在以前的文章中，我们已经看到了这些发行版的一些属性:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/6c15e47f6e3adb50e17ef97301482835.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*DwRvHIc7HS_X8qeuchVkgg.png"/></div></figure><p id="81b6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">请注意，他们从原始分布中抽取了1000个样本来创建投票，然后计算该样本的平均值。这个过程相当于从样本比例的抽样分布中抽取一个样本。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="5cda" class="nm kj it ni b gy nn no l np nq"># Sampling distribution of sample proportion for men<br/><br/>mu = p1<br/>variance = p1*(1-p1)/n<br/>sigma = math.sqrt(variance)<br/>x = np.linspace(mu - 3*sigma, mu + 3*sigma, 100)<br/>sns.lineplot(x = x, y = norm.pdf(x, mu, sigma));</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/7fe4ce13a100648b8575635ac93c359d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*JS1DTCYvYoevJ_ree16sSQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图4: <code class="fe nu nv nw ni b">Sampling distribution of sample proportion for men.</code></p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="0ab4" class="nm kj it ni b gy nn no l np nq"># Sampling distribution of sample proportion for women<br/><br/>mu = p2<br/>variance = p2*(1-p2)/n<br/>sigma = math.sqrt(variance)<br/>x = np.linspace(mu - 3*sigma, mu + 3*sigma, 100)<br/>sns.lineplot(x = x, y = norm.pdf(x, mu, sigma));</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/6c2781d461cd7e2342d8ecaf6e6db93e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*RPeZ0-1eaJq9oHUDmU0vNQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图5: <code class="fe nu nv nw ni b">Sampling distribution of sample proportion for women.</code></p></figure><p id="c705" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">事实上，我们对男性和女性的个体分布并不感兴趣。我们感兴趣的是它们的差异，所以让我们创建</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/0b11c3429a4ebc2ff923480589988d4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:176/format:webp/1*TBBNDM2im55vS5jRnQ1P4g.png"/></div></figure><p id="9157" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为此，我们需要定义它的参数:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ny"><img src="../Images/4f0d6cf06686922865e8b17e78ade545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*iC8Sv_ksA4ZwfKUprTJIjA.png"/></div></div></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="266a" class="nm kj it ni b gy nn no l np nq"># Sampling distribution of sample proportion for the difference between men and women<br/><br/>mu = p1-p2<br/>variance = p1*(1-p1)/n + p2*(1-p2)/n<br/>sigma = math.sqrt(variance)<br/>x = np.linspace(mu - 3*sigma, mu + 3*sigma, 100)<br/>sns.lineplot(x = x, y = norm.pdf(x, mu, sigma));</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/7b5bb46f6fcf24c2032f6b290d70e8e6.png" data-original-src="https://miro.medium.com/v2/format:webp/1*qle8BC7gs1tVtqqhsPuNMw.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated"><code class="fe nu nv nw ni b">Figure 6: Sampling distribution of sample proportion for the difference between men and women.</code></p></figure><p id="c2b8" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们要计算的置信区间表明p1-p2有95%的可能性在内</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/9c608c19e6692c39ebcb2a1d0086a3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:258/format:webp/1*9Fs8ihQYf8i66Hw77Fq4lw.png"/></div></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="7723" class="nm kj it ni b gy nn no l np nq"># Calculating the number of standard deviations required for a 95% interval<br/><br/>norm.ppf(0.975)</span><span id="e685" class="nm kj it ni b gy nr no l np nq">1.959963984540054</span></pre><p id="07ab" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们计算一下我们的间隔。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="2aa2" class="nm kj it ni b gy nn no l np nq">np.sqrt(variance) * norm.ppf(0.975)</span><span id="2352" class="nm kj it ni b gy nr no l np nq">0.042540701104107376</span></pre><p id="34f9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在我们知道有95%的可能性比例的真实差异在样本比例的实际差异的0.04254以内。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="47ed" class="nm kj it ni b gy nn no l np nq">print(f'The 95% CI is: [{np.round(p1-p2 - np.sqrt(variance) * norm.ppf(0.975), 3)},{np.round(p1-p2 + np.sqrt(variance) * norm.ppf(0.975), 3)}]')</span><span id="f686" class="nm kj it ni b gy nr no l np nq">The 95% CI is: [0.027,0.113]</span></pre><p id="3708" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">候选人可以得出结论，男性投票给他的可能性比女性高95%。请注意，值0(无差异)不包含在间隔中。</p><h1 id="3681" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">比较人口比例的假设检验</h1><p id="6a2b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们的方法可以更直接。我们可以定义一个假设检验来评估，事实上，这是否是一个差异。</p><p id="4690" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们首先定义我们的零假设，它代表无差异的场景。相反，我们的另一种假设认为存在差异。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/05f4e35725a7ad0f47decd952021e758.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*j8JcgL6t07kdFa3PDqlGnA.png"/></div></figure><p id="cae1" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">因此，我们想计算</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/3b717f989bacd8f7757ff2f2b01c46ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*IUkh6_rG9VzhOUpqrYqA9Q.png"/></div></figure><p id="a3b4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果这个概率小于为该问题定义的显著性水平，我们将拒绝我们的零假设，并接受男性和女性投票给候选人的差异。换句话说，假设真正的比例是相等的，我们想知道得到像抽样比例的差值一样极端的东西的概率。我们可以将z值定义为，</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/2d377a03fd46c215bb8d4934051ac0a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*-y_4T__10witVFxRRQuduA.png"/></div></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="5482" class="nm kj it ni b gy nn no l np nq">p0 = (n1*p1+n2*p2)/(n1+n2)<br/>z = ((p1 - p2) - 0) /(np.sqrt(2*(p0*(1-p0)/n)))<br/>z</span><span id="19ed" class="nm kj it ni b gy nr no l np nq">3.2167337783899304</span></pre><p id="73a0" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，我们可以将z统计量与显著性水平为5%的临界值进行比较。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="ff8c" class="nm kj it ni b gy nn no l np nq">z_critical = norm.ppf(0.975)<br/>z_critical</span><span id="41b3" class="nm kj it ni b gy nr no l np nq">1.959963984540054</span><span id="713f" class="nm kj it ni b gy nr no l np nq">z &gt; z_critical</span><span id="d7ea" class="nm kj it ni b gy nr no l np nq">True</span></pre><p id="445b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们的z统计值大于临界值。换句话说，假设我们的零假设，有5%的机会对大于临界值的z统计量进行采样。在这种情况下，我们拒绝h0，这意味着我们接受投票给候选人的男女之间的差异。</p><h1 id="8bfa" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">实验的统计显著性</h1><p id="2e02" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在一项旨在研究假新闻对参与度的影响的实验中，一组500人被随机分配到两个不同的组。随机分组后，每个人都收到了一部只有社交媒体应用的智能手机，他们可以用它来关注朋友的新闻和更新。</p><p id="de3c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">第一组每天至少收到两次假新闻，而第二组没有。30天后，测量花在社交媒体应用上的时间。实验的指导者发现，第一组每天花在应用上的平均时间比第二组多大约12分钟。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="c935" class="nm kj it ni b gy nn no l np nq">gra = Digraph()<br/><br/>gra.node('a', '500')<br/>gra.node('b', '#1\n Fake news')<br/>gra.node('c', '#2\n No fake news')<br/>gra.edges(['ab', 'ac'])</span><span id="725b" class="nm kj it ni b gy nr no l np nq">gra</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/8e51cad90c3d8f51c6cf72962c5d6fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*cfsxxpXIbRwlViEx1PDgFg.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图7:实验研究的设计，其中250人被随机分配到治疗组，250人被随机分配到对照组。</p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="abbf" class="nm kj it ni b gy nn no l np nq">g1 = np.random.normal(3, 1, size=250)<br/>g2 = np.random.normal(2.2, 1, size=250)</span><span id="3025" class="nm kj it ni b gy nr no l np nq">print('Group 1: ' + str(np.round(g1.mean(),1)) + 'h')<br/>print('Group 2: ' + str(np.round(g2.mean(),1)) + 'h')</span><span id="7aff" class="nm kj it ni b gy nr no l np nq">Group 1: 3.0h<br/>Group 2: 2.2h</span></pre><p id="7010" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为了理解这一结果的意义，我们需要将结果重新随机化成两个新组，并测量新组的平均值之间的差异。我们重复模拟200次。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="179a" class="nm kj it ni b gy nn no l np nq">groups_ind = np.zeros((200, 500))<br/>for i in range(200):<br/>    groups_ind[i] = (np.random.choice(np.arange(500, dtype=np.int32), size=500, replace=False))</span><span id="dfde" class="nm kj it ni b gy nr no l np nq">groups_ind = groups_ind.astype('int32')</span><span id="bd4b" class="nm kj it ni b gy nr no l np nq">g = np.concatenate((g1,g2))</span><span id="a3ed" class="nm kj it ni b gy nr no l np nq">g1_rand = g[groups_ind][:,:250]<br/>g2_rand = g[groups_ind][:,250:]<br/><br/>g1_rand_mean = g1_rand.mean(axis=0)<br/>g2_rand_mean = g2_rand.mean(axis=0)<br/><br/>diff_g = g1_rand_mean - g2_rand_mean</span><span id="73d2" class="nm kj it ni b gy nr no l np nq">sns.histplot(diff_g);</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/15d68600f81bb339a85c54e9dab182d9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*RE1FC605NQcVzC4vp54cIw.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图8:200次模拟后，将结果重新随机分为两个新组，各组平均值之间的差异。</p></figure><p id="ae63" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以看到，差异大于0.2的次数非常少。但它有统计学意义吗？</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="7c3e" class="nm kj it ni b gy nn no l np nq">diff_g[diff_g&gt;=0.2].shape[0]/diff_g.shape[0]</span><span id="1e28" class="nm kj it ni b gy nr no l np nq">0.024</span></pre><p id="54cb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">假设在实验开始前建立了5%的显著性水平。在这种情况下，我们看到我们的结果在统计上是显著的，因为在200次模拟中观察到12分钟差异的概率只有2.4%。如果这是偶然的，那200年中只会发生6次。</p><h1 id="a830" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="4a16" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">本文介绍了如何应用置信区间和假设检验来比较两个总体样本之间的差异。这给了我们一种方法来理解这些差异是否真的有统计学意义。我们将这些想法应用到一个实验中，该实验使用模拟和再随机化来测试治疗组和对照组之间的差异。</p><p id="3951" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">保持联系:<a class="ae mk" href="https://www.linkedin.com/in/luisbrasroque/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><h1 id="ddb4" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">练习</h1><p id="5d2c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">你将在下周的文章中找到答案。</p><ol class=""><li id="1211" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv oe mh mi mj bi translated">医生假设，疫苗接种前后因新冠肺炎而住院的平均时间发生了变化。将1000名患者随机分为治疗组和对照组。治疗组已经注射了疫苗，而对照组没有注射。结果显示，治疗组的平均住院时间比对照组少10天。下表总结了1000次数据重新随机化的结果。根据数据，治疗组的平均值比对照组的平均值小10天或更多的概率是多少？从实验结果中你能得出什么结论(假设5%的显著性水平)？</li></ol><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="8862" class="nm kj it ni b gy nn no l np nq">diff = [[-17.5,1],<br/>[-15.0, 6],<br/>[-12.5, 15],<br/>[-10.0, 41],<br/>[-7.5, 82],<br/>[-5.0, 43],<br/>[-2.5, 150],<br/>[0., 167],<br/>[2.5, 132],<br/>[5.0, 127],<br/>[7.5, 173],<br/>[10.0, 38],<br/>[12.5, 18],<br/>[15.0, 6],<br/>[17.5, 1]]</span></pre><h2 id="b2b7" class="nm kj it bd kk of og dn ko oh oi dp ks lj oj ok ku ln ol om kw lr on oo ky op bi translated">上周的答案</h2><ol class=""><li id="3756" class="mb mc it lc b ld le lg lh lj oq ln or lr os lv oe mh mi mj bi translated">根据去年的一项大型民意调查，波尔图大约85%的房屋都接入了高速互联网。Marco想知道这一比例是否发生了变化，他随机抽样调查了80栋房子，发现其中75栋可以接入高速互联网。他想用这个样本数据来检验这个比例是否真的发生了变化。假设推断条件满足，考虑到1%的显著性水平，您对拥有高速互联网的房屋比例会得出什么结论？</li></ol><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="1263" class="nm kj it ni b gy nn no l np nq">p_0 = 0.85<br/>p = 75/80<br/>n = 80<br/>α = 0.01<br/><br/>z = (p-p_0)/np.sqrt(p_0*(1-p_0)/n)<br/>z</span><span id="c4ae" class="nm kj it ni b gy nr no l np nq">2.191785018798024</span><span id="9db8" class="nm kj it ni b gy nr no l np nq">p_value = (1-norm.cdf(z))*2 # see that Marco wants to check if the proportion changed, so it is a two-tail test</span><span id="ba99" class="nm kj it ni b gy nr no l np nq">if p_value &lt; α:<br/>    print("Reject H0")<br/>else:<br/>    print("Fail to Reject H0")</span><span id="fd75" class="nm kj it ni b gy nr no l np nq">Fail to Reject H0</span></pre><p id="5fbb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">2.玛尔塔拥有一家水果店，每周都会收到西瓜。供应商声称它们应该重1公斤。Marta决定对随机抽取的100个西瓜进行称重，发现平均重量为850克，标准偏差为200克。她想用这个样本数据来测试平均值是否小于供应商声称的平均值，如果是这样，就重新协商他们的合同。假设推断的条件满足，Marta应该怎么做(考虑5%的显著性水平)？</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="182e" class="nm kj it ni b gy nn no l np nq">μ_0 = 1<br/>μ = 0.850<br/>s = 0.2<br/>n = 100<br/>α = 0.05<br/><br/>t_star = (μ-μ_0)/(s/np.sqrt(n))<br/>t_star</span><span id="ecdd" class="nm kj it ni b gy nr no l np nq">-7.500000000000001</span><span id="c9d2" class="nm kj it ni b gy nr no l np nq">p_value = t.cdf(t_star, df=n-1)</span><span id="8c19" class="nm kj it ni b gy nr no l np nq">if p_value &lt; α:<br/>    print("Reject H0")<br/>else:<br/>    print("Fail to Reject H0")</span><span id="1251" class="nm kj it ni b gy nr no l np nq">Reject H0</span></pre><p id="6780" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">Marta应该与供应商重新谈判合同，因为西瓜重1公斤的说法在5%的显著性水平上是不真实的。</p></div></div>    
</body>
</html>