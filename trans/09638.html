<html>
<head>
<title>From PDF to Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从PDF到Excel</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-pdf-to-excel-536fe7844828?source=collection_archive---------7-----------------------#2021-09-08">https://towardsdatascience.com/from-pdf-to-excel-536fe7844828?source=collection_archive---------7-----------------------#2021-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="cb88" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学/ Python</h2><div class=""/><div class=""><h2 id="2e3f" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用tabula和xlsxwriter</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/467175ab6a533865b981f48d0e8ddcc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J7OhMAYgFiq5lHQi"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@alysa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">艾丽莎·巴耶纳鲁</a>在<a class="ae lh" href="https://unsplash.com/s/photos/converse?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ba52" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在现实世界中，我们经常会遇到各种格式的数据。今天，我们将处理从PDF中提取表格数据并将其导出到Excel的任务。</p><p id="a278" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">唯一的警告是，pdf文件必须是机器生成的。扫描页面的pdf不工作。这是tabula的一个局限性。</p><p id="ab6b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">说完了，我们走吧！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="ff6b" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">环境</h1><p id="8b21" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">首先，让我们确定我们有一个好的java环境。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="d1fa" class="nn mm it nj b gy no np l nq nr">java -version</span></pre><p id="7276" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您应该会看到类似这样的内容:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/223fbf428b5c2573523602e5e8a0b9dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JyZTUR7WeHqJRv1ACoT_g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://medium.com/@ednalyn.dedios/membership" rel="noopener">作者</a>截图</p></figure><p id="02c0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，让我们用下面的代码安装tabula-py:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="9e06" class="nn mm it nj b gy no np l nq nr">pip install tabula-py</span></pre><p id="cbae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果成功，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nt"><img src="../Images/29f382de827b8a547d04e787d9187ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l21ekVe6wjm_15rP5W5FsQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://medium.com/@ednalyn.dedios/membership" rel="noopener">作者</a>截图</p></figure><p id="a525" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，让我们安装xlsxwriter:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="40ee" class="nn mm it nj b gy no np l nq nr">pip install xlsxwriter</span></pre><p id="db92" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们应该会看到这样的情况:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nu"><img src="../Images/6ae4d59a220e20d3f79a898d563c87f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XjefSlAg-Sr7bqC4S-maHA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://medium.com/@ednalyn.dedios/membership" rel="noopener">作者</a>截图</p></figure><p id="b8bd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们打开jupyter笔记本，开始编码吧！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="41fe" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">从PDF到Dataframe</h1><p id="eaa4" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">让我们从导入以下内容开始:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="c36a" class="nn mm it nj b gy no np l nq nr">import pandas as pd<br/>import tabula<br/>import xlsxwriter</span></pre><p id="8769" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">那我们来拿数据:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="055d" class="nn mm it nj b gy no np l nq nr">data = tabula.read_pdf('../data/in/titanic.pdf', pages='all', stream=True)</span></pre><p id="6051" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的代码产生了一个数据帧列表。因为列表中只有一个数据帧，所以让我们继续提取数据帧本身。我们可以做<code class="fe nv nw nx nj b">df[0]</code>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/a23221723bf718d904c6d40ecb1287f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*fzvsQvvy8VUhrbCke5VfXQ.png"/></div></figure><p id="e93c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，我们需要通过重置索引和转置数据帧两次来将列标题转换为第一行。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="2e8e" class="nn mm it nj b gy no np l nq nr">df = data[0].reset_index().T.reset_index().T</span></pre><p id="22d5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">并将这些列重命名为:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="e30e" class="nn mm it nj b gy no np l nq nr">df.columns=['x', 'passenger', 'pc_class', 'gender', 'age', 'parch', 'fare', 'cabin', 'embarked']</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f606217300e0b3fb3c3752afd09f8ff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*DdXQM85ILpJUs4bzccVP5Q.png"/></div></figure><p id="9249" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们删除前两列:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="0bfe" class="nn mm it nj b gy no np l nq nr">clean_df = df.drop(columns=['x']).reset_index(drop=True)</span></pre><p id="4c1b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们为黄金时间做好了准备:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/3dfb83be1039db344fd38f947c4e11a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*im2W8t4nwbYjO0SsNpIwdQ.png"/></div></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="9d7d" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">Excel的数据框架</h1><p id="9c82" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">让我们首先创建一个新的Excel文件:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="ba62" class="nn mm it nj b gy no np l nq nr">workbook = xlsxwriter.Workbook('../data/out/titanic.xlsx', {'nan_inf_to_errors': True})</span></pre><p id="f0d3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">并添加一个名为“测试”的工作表(选项卡):</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="11ad" class="nn mm it nj b gy no np l nq nr">worksheet = workbook.add_worksheet('test')</span></pre><p id="0d0a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在将数据写入Excel之前，我们需要先将数据帧转换成列表。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="b748" class="nn mm it nj b gy no np l nq nr">data = list(clean_df.to_records(index=False))</span></pre><p id="d6f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们用以下内容初始化Excel文件的第一个单元格(A1 ):</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="e3f4" class="nn mm it nj b gy no np l nq nr"># Rows and columns are zero indexed<br/>row = 0<br/>col = 0</span></pre><p id="86a3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们检查第一行:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ecdee4fdc3b34df1e7995ef72a1694bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*i2QyeQ-gOW1TuqMZ46N8Pw.png"/></div></figure><p id="12ec" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们需要通过手动插入列标题来解决这个问题。让我们将列名插入到列表的索引0中。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="207d" class="nn mm it nj b gy no np l nq nr">data.insert(0, ['passenger', 'pc_class', 'gender', 'age', 'parch', 'fare', 'cabin', 'embarked'])</span></pre><p id="f279" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们可以一行一行地写了。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="ac44" class="nn mm it nj b gy no np l nq nr"># Iterate over the data<br/>for passenger, pc_class, gender, age, parch, fare, cabin, embarked in data:<br/>    worksheet.write(row, col, passenger)<br/>    worksheet.write(row, col + 1, pc_class)<br/>    worksheet.write(row, col + 2, gender)<br/>    worksheet.write(row, col + 3, age)<br/>    worksheet.write(row, col + 4, parch)<br/>    worksheet.write(row, col + 5, fare)<br/>    worksheet.write(row, col + 6, cabin)<br/>    worksheet.write(row, col + 7, embarked)<br/>    row += 1</span></pre><p id="90cb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，让我们关闭工作簿。</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="5c2d" class="nn mm it nj b gy no np l nq nr">workbook.close()</span></pre><p id="1c64" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">瞧啊。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/4b6fb3a36daac8679f399eebb0744dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WtRbAcwjM1DsfIWCrr50Fg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://medium.com/@ednalyn.dedios/membership" rel="noopener">作者</a>截图</p></figure><p id="d972" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">就是这样！我们给自己弄了个Excel文件。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="06cd" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">结论</h1><p id="9dc5" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">在这篇文章中，我们学习了如何使用tabula和xlsxwriter。我们取了一个pdf文件，将其提取为数据帧，然后将内容写入Excel文件。与循环的<em class="od">结合起来</em>，我们可以很容易地接收许多pdf文件，并且有一个平面文件可以输入到像Redshift这样的数据库中。经过一点小小的努力，我们已经为自动化找到了一个成功的组合。</p><p id="6f17" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在我的<a class="ae lh" href="https://github.com/ecdedios/pdf-to-excel" rel="noopener ugc nofollow" target="_blank"> Github </a>上查看回购，以便进一步检查。下面是完整的代码:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="ab2d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">谢谢你过来看我的帖子。</p><p id="a848" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">敬请期待！</p><p id="d8ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="od">如果你想了解更多关于我从懒鬼到数据科学家的旅程，请查看下面的文章:</em></p><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/from-slacker-to-data-scientist-b4f34aa10ea1"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd jd gy z fp oo fr fs op fu fw jc bi translated">从懒鬼到数据科学家</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">我的无学位数据科学之旅。</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox lb oj"/></div></div></a></div><p id="4585" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="od">如果你正考虑转型进入数据科学领域，现在就开始考虑重塑品牌:</em></p><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/the-slackers-guide-to-rebranding-yourself-as-a-data-scientist-b34424d45540"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd jd gy z fp oo fr fs op fu fw jc bi translated">懒鬼将自己重塑为数据科学家指南</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">给我们其他人的固执己见的建议。热爱数学，选修。</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox lb oj"/></div></div></a></div><p id="5e83" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以通过<a class="ae lh" href="https://twitter.com/ecdedios" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae lh" href="https://www.linkedin.com/in/ednalyn-de-dios/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="3695" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">参考</h1><div class="og oh gp gr oi oj"><a href="https://github.com/chezou/tabula-py/blob/master/examples/tabula_example.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd jd gy z fp oo fr fs op fu fw jc bi translated">tabula-py/tabula _ example . ipynb at master chezou/tabula-py</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">tabula-java的简单包装:从PDF中提取表格到pandas data frame-tabula-py/tabula _ example . ipynb at master…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">github.com</p></div></div><div class="os l"><div class="oz l ou ov ow os ox lb oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://xlsxwriter.readthedocs.io/tutorial01.html" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd jd gy z fp oo fr fs op fu fw jc bi translated">教程1:创建一个简单的XLSX文件</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">让我们首先使用Python和XlsxWriter模块创建一个简单的电子表格。假设我们有一些关于…的数据</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">xlsxwriter.readthedocs.io</p></div></div><div class="os l"><div class="pa l ou ov ow os ox lb oj"/></div></div></a></div></div></div>    
</body>
</html>