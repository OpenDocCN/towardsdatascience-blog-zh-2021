<html>
<head>
<title>Use Python to Automate the PowerPoint Update</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 自动更新 PowerPoint</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/use-python-to-automate-the-powerpoint-update-4a385acf1243?source=collection_archive---------0-----------------------#2021-12-09">https://towardsdatascience.com/use-python-to-automate-the-powerpoint-update-4a385acf1243?source=collection_archive---------0-----------------------#2021-12-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7b9d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 Python 编辑 PowerPoint 幻灯片的分步教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0bfce172cbf1195ae2cc763b88c7ba08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5hoUO7SBPn1DCbUKAS5bA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>编辑的 PowerPoint 幻灯片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="829a" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">目标</h1><p id="8d7a" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在两篇关于更智能地使用 Microsoft Excel 的文章之后，我收到了一些直接消息，说他们对这一领域感兴趣，并希望我能分享更多关于其他 office 产品的信息。它刺激我做一个与办公室小贴士相关的系列文章的收藏。第一个是<strong class="ma iu">微软的 PowerPoint </strong>。在本文中，您将了解到</p><ol class=""><li id="569c" class="mu mv it ma b mb mw me mx mh my ml mz mp na mt nb nc nd ne bi translated">如何<strong class="ma iu">确定 PowerPoint 幻灯片中的形状</strong>。</li><li id="f700" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">修改幻灯片，如<strong class="ma iu">插入图像</strong>或<strong class="ma iu">改变文字</strong>。</li><li id="34a0" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">以不同格式输出幻灯片的方法，如<strong class="ma iu"> PNG 或 PDF。</strong></li></ol><p id="e075" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">另外，如果你还没有看过我写的关于微软 Excel 的文章，请随意查看下面的链接。</p><div class="nn no gp gr np nq"><a rel="noopener follow" target="_blank" href="/use-python-to-stylize-the-excel-formatting-916e00e33302"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">使用 Python 来格式化 Excel</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">使用 Python 格式化 Excel 电子表格的分步教程</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div><div class="nn no gp gr np nq"><a href="https://medium.com/mlearning-ai/use-excel-to-scrape-data-no-codes-required-f13748587b0d" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">使用 Excel 抓取数据(不需要代码)</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">用 Excel 内置函数抓取数据的三个简单步骤</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="of l ob oc od nz oe ks nq"/></div></div></a></div></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="a7fa" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">背景</h1><p id="c332" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在许多人的日常工作中，他们不得不频繁地定期更新 PowerPoint 幻灯片中的数字，如表格数字、日期、KPI 统计数据等。每天花 15-30 分钟来处理这些乏味的工作是很烦人的。</p><p id="d848" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">在下面的示例中，我们假设定期更新货币汇率，以弹出变化最大的货币汇率，我们需要显示变化百分比最大的货币汇率的价格趋势。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><blockquote class="og oh oi"><p id="e5b2" class="ly lz oj ma b mb mw ju md me mx jx mg ok nk mj mk ol nl mn mo om nm mr ms mt im bi translated">所有代码和资料都上传到我的 GitHub。你可以查一下民间的 <a class="ae ky" href="https://github.com/cydalytics/Python_PowerPoint_Automation" rel="noopener ugc nofollow" target="_blank"> <strong class="ma iu">和这种回购的</strong> </a> <strong class="ma iu">来进一步研究。=) </strong></p></blockquote></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="2396" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤 1-定义相应的组件</h1><p id="ebe8" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">首先，我们必须决定要更新的元素。以我的幻灯片为例，总共有 7 个地方需要更新。</p><ol class=""><li id="977a" class="mu mv it ma b mb mw me mx mh my ml mz mp na mt nb nc nd ne bi translated">上次更新日期时间</li><li id="0ca0" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">前 5 名表</li><li id="1884" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">底部 5 表</li><li id="69bc" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">顶级数字标签</li><li id="10ce" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">底部图形标签</li><li id="4035" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">最高数字</li><li id="564c" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">底部图形</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/7417ec6458f7afdd00cc91da7ad87f64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_TnPugU9yLeF89It2WJTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">滑梯的 7 个部件(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="68ff" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤 2 —数据准备</h1><p id="f55b" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在理解了要更新的组件之后，接下来是要用于更新的数据源。在一般的办公工作中，数据可以从 SQL server 中提取或从电子邮件中接收数据文件等。这里，我们将演示从互联网上抓取数据的情况。我们将使用雅虎财务数据作为例证。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="7d16" class="ot lh it op b gy ou ov l ow ox"><a class="ae ky" href="https://finance.yahoo.com/currencies" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/currencies</a></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/bcb9bc8d3d39e350dd7c1d1ea30cef75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0VaYPqS5OkTwA-31REBNBQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自雅虎财经的货币(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure><p id="ba9b" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">我不会深入讨论数据是如何收集的，因为这不是本文的重点。基本上就是两行代码。首先，我们使用<code class="fe oz pa pb op b">requests</code>获取页面。然后，我们使用<code class="fe oz pa pb op b">pandas</code>提取表格。请注意，我们还记录了刮擦日期和时间，以备后用。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="92b9" class="ot lh it op b gy ou ov l ow ox">import requests<br/>import pandas as pd<br/>from datetime import datetime</span><span id="f018" class="ot lh it op b gy pc ov l ow ox">datetime_now = datetime.now()<br/>full_list_url='<a class="ae ky" href="https://finance.yahoo.com/currencies'" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/currencies'</a><br/>full_list_page = requests.get(full_list_url)<br/>df = pd.read_html(full_list_page.text)[0].drop_duplicates()<br/>df['pct_change'] = df['% Change'].str.slice(stop=-1).astype(float)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/a4d037d22223c5059541e22be80104ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSh6kqoEoDk4FYMdz8d2sQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测向数据结构(cyda 拍摄<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="4205" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">这张桌子看起来不错，包括了我们需要的所有东西。我们现在可以进入下一步，对表进行排序，并获得前 5 名和后 5 名货币的汇率。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="275d" class="ot lh it op b gy ou ov l ow ox">top_df = df.sort_values(['pct_change'], ascending=False).reset_index(drop=True)[:5]<br/>top_df = top_df[['Name', 'Last Price', 'Change', '% Change']]</span><span id="98aa" class="ot lh it op b gy pc ov l ow ox">bottom_df = df.sort_values(['pct_change'], ascending=True).reset_index(drop=True)[:5]<br/>bottom_df = bottom_df[['Name', 'Last Price', 'Change', '% Change']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/948692b8bc729b8963ac3faebe535693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dkqraE4qk4pBAqcj1tF1EA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">top_df 和 bottom_df 的数据结构(图片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>提供)</p></figure><p id="fda8" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">数字都准备好了。唯一剩下的就是那两块地了。要生成绘图，您只需遵循以下代码。放心吧！我会一步一步地解释，这很容易理解。</p><ol class=""><li id="d40a" class="mu mv it ma b mb mw me mx mh my ml mz mp na mt nb nc nd ne bi translated">获取货币汇率的数据。</li><li id="b818" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">提取收盘价并绘制成折线图。</li><li id="3753" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">设置图表的格式，如颜色、字体大小或透明背景，以便与 PPT 主题保持一致。</li><li id="7bd1" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">将绘图保存到 PNG 中。</li></ol><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="7a99" class="ot lh it op b gy ou ov l ow ox">import json<br/>import matplotlib.pyplot as plt</span><span id="a962" class="ot lh it op b gy pc ov l ow ox">top_name = top_df['Name'][0].replace('/', '')<br/>bottom_name = bottom_df['Name'][0].replace('/', '')</span><span id="dfaa" class="ot lh it op b gy pc ov l ow ox">for idx in range(2):<br/>    <br/>    name = [top_name, bottom_name][idx]<br/>    file_path = ['top.png', 'bottom.png']<br/>    <br/>    url = '<a class="ae ky" href="https://query1.finance.yahoo.com/v8/finance/chart/'" rel="noopener ugc nofollow" target="_blank">https://query1.finance.yahoo.com/v8/finance/chart/'</a> + name + '=X?region=US&amp;lang=en-US&amp;includePrePost=false&amp;interval=30m&amp;useYfid=true&amp;range=1mo&amp;corsDomain=finance.yahoo.com&amp;.tsrc=finance'<br/>    header = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36'}<br/>    page = requests.get(url, headers=header)<br/>    temp_json = json.loads(page.text)<br/>    price_list = temp_json['chart']['result'][0]['indicators']['quote'][0]['close']<br/>    price_list = [price for price in price_list if price != None]<br/>    fig, ax = plt.subplots(figsize=(12, 6))<br/>    ax.plot(price_list, color='#43B7A4')<br/>    ax.set_xticks([])<br/>    ax.tick_params(axis='y', colors='#43B7A4', labelsize=20)<br/>    for axis in ['top','bottom','left','right']:<br/>        ax.spines[axis].set_color('#43B7A4')<br/>        ax.spines[axis].set_linewidth(4)<br/>    plt.savefig(file_path[idx], transparent=True)</span></pre><h2 id="3c74" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">1.获取数据</h2><p id="2a0b" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">特定货币汇率的价格系列数据可以在以下链接中找到。只有一个参数，那就是该货币汇率的<code class="fe oz pa pb op b">name</code>。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="de9a" class="ot lh it op b gy ou ov l ow ox">url = '<a class="ae ky" href="https://query1.finance.yahoo.com/v8/finance/chart/'" rel="noopener ugc nofollow" target="_blank">https://query1.finance.yahoo.com/v8/finance/chart/'</a> + <strong class="op iu">name </strong>+ '=X?region=US&amp;lang=en-US&amp;includePrePost=false&amp;interval=30m&amp;useYfid=true&amp;range=1mo&amp;corsDomain=finance.yahoo.com&amp;.tsrc=finance'</span></pre><p id="1c65" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">请注意，这次您需要指定一个<code class="fe oz pa pb op b">header</code>，以便成功获取页面数据。标题用于假装您正在通过浏览器访问页面。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="fbf8" class="ot lh it op b gy ou ov l ow ox">header = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36'}</span></pre><p id="73c6" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">其余的应该很容易理解，这是获取页面数据并以 JSON 格式加载的常见过程。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="1515" class="ot lh it op b gy ou ov l ow ox">page = requests.get(url, headers=header)<br/>temp_json = json.loads(page.text)</span></pre><h2 id="8928" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">2.绘制折线图</h2><p id="7ad8" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">要得到价格表，我们只需检查数据的字典结构，就可以得到。有一点需要提醒的是，我在这里进行了一次检查，删除了价格表中的那些<code class="fe oz pa pb op b">None</code>数据，因为我发现价格表中有一些数据缺失。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="39c4" class="ot lh it op b gy ou ov l ow ox">price_list = temp_json['chart']['result'][0]['indicators']['quote'][0]['close']<br/>price_list = [price for price in price_list if price != None]</span></pre><p id="6c90" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">我们使用<code class="fe oz pa pb op b">matplotlib</code>来绘制直线。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="9bd5" class="ot lh it op b gy ou ov l ow ox">fig, ax = plt.subplots(figsize=(12, 6))<br/>ax.plot(price_list, color='#43B7A4')</span></pre><h2 id="dcdb" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">3.将图表风格化</h2><p id="68d7" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我做了一些东西来润色剧情。</p><ul class=""><li id="e219" class="mu mv it ma b mb mw me mx mh my ml mz mp na mt pq nc nd ne bi translated"><strong class="ma iu">删除日期的 x 轴刻度</strong></li></ul><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="8e7a" class="ot lh it op b gy ou ov l ow ox">ax.set_xticks([])</span></pre><ul class=""><li id="3c70" class="mu mv it ma b mb mw me mx mh my ml mz mp na mt pq nc nd ne bi translated"><strong class="ma iu">更改 y 轴刻度的字体大小和字体颜色</strong></li></ul><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="4f5e" class="ot lh it op b gy ou ov l ow ox">ax.tick_params(axis='y', colors='#43B7A4', labelsize=20)</span></pre><ul class=""><li id="12bb" class="mu mv it ma b mb mw me mx mh my ml mz mp na mt pq nc nd ne bi translated"><strong class="ma iu">改变边框颜色，使线条宽度变大</strong></li></ul><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="6d9f" class="ot lh it op b gy ou ov l ow ox">for axis in ['top','bottom','left','right']:<br/>    ax.spines[axis].set_color('#43B7A4')<br/>    ax.spines[axis].set_linewidth(4)</span></pre><h2 id="0685" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">4.保存情节</h2><p id="d777" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">最后，我们将图形保存为 PNG 格式。请注意，要使背景透明，只需指定<code class="fe oz pa pb op b">transparent=True</code>。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="73a1" class="ot lh it op b gy ou ov l ow ox">plt.savefig(file_path[idx], transparent=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/58c87576bda65820b60985f9b72fd87b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9AHfIM6cgEcTL6aVv-zmQw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">顶部和底部货币图(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="9e55" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤 3— PowerPoint 更新</h1><p id="2ed9" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">这是我们今天的重点。在使用 Python 编辑 PowerPoint 之前，需要有<code class="fe oz pa pb op b">python-pptx</code>包。要安装它，您可以在终端中键入以下代码。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="682f" class="ot lh it op b gy ou ov l ow ox">pip install python-pptx</span></pre><p id="3b16" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">按照我们通常的做法，我先给你看所有的代码，然后一步一步地教你。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="f04a" class="ot lh it op b gy ou ov l ow ox">from pptx import Presentation<br/>from pptx.util import Inches<br/>import win32com.client<br/>import os</span><span id="dc75" class="ot lh it op b gy pc ov l ow ox">currencies_ppt = Presentation('Currencies.pptx')<br/>slide = currencies_ppt.slides[0]</span><span id="8e98" class="ot lh it op b gy pc ov l ow ox">shapes = slide.shapes<br/>for shape in shapes:<br/>    if shape.shape_type == 13:<br/>        shapes.element.remove(shape.element)<br/>top_img_path = 'top.png'<br/>bottom_img_path = 'bottom.png'<br/>top_pic = slide.shapes.add_picture(top_img_path, Inches(0.40), Inches(4.85), width=Inches(5.30))<br/>bottom_pic = slide.shapes.add_picture(bottom_img_path, Inches(5.25), Inches(4.85), width=Inches(5.30))<br/>ref_element = slide.shapes[0]._element<br/>ref_element.addprevious(top_pic._element)<br/>ref_element.addprevious(bottom_pic._element)</span><span id="c9c9" class="ot lh it op b gy pc ov l ow ox">shapes = slide.shapes<br/>text_box_list = []<br/>auto_shape_list = []<br/>table_list = []<br/>for shape_idx in range(len(shapes)):<br/>    shape = shapes[shape_idx]<br/>    if shape.shape_type == 17:<br/>        text_box_list.append(shape_idx)<br/>    if shape.shape_type == 1:<br/>        auto_shape_list.append(shape_idx)<br/>    if shape.shape_type == 19:<br/>        table_list.append(shape_idx)</span><span id="8a6d" class="ot lh it op b gy pc ov l ow ox">last_update_date_textbox_height = max([shapes[shape_idx].height for shape_idx in text_box_list])<br/>last_update_date_idx = [shape_idx for shape_idx in text_box_list if shapes[shape_idx].height == last_update_date_textbox_height][0]<br/>top_label_left = min([shapes[shape_idx].left for shape_idx in auto_shape_list])<br/>top_label_idx = [shape_idx for shape_idx in auto_shape_list if shapes[shape_idx].left == top_label_left][0]<br/>auto_shape_list.remove(top_label_idx)<br/>bottom_label_idx = auto_shape_list[0]<br/>top_table_left = min([shapes[shape_idx].left for shape_idx in table_list])<br/>top_table_idx = [shape_idx for shape_idx in table_list if shapes[shape_idx].left == top_table_left][0]<br/>table_list.remove(top_table_idx)<br/>bottom_table_idx = table_list[0]</span><span id="4a4f" class="ot lh it op b gy pc ov l ow ox">paragraph = shapes[last_update_date_idx].text_frame.paragraphs[0]<br/>paragraph.runs[4].text = datetime_now.strftime("%#d %b %Y %H:%M")<br/>paragraph = shapes[top_label_idx].text_frame.paragraphs[0]<br/>paragraph.runs[0].text = top_df['Name'][0].replace('/', ' / ')<br/>paragraph = shapes[bottom_label_idx].text_frame.paragraphs[0]<br/>paragraph.runs[0].text = bottom_df['Name'][0].replace('/', ' / ')<br/>top_table = shapes[top_table_idx].table<br/>for i in range(5):<br/>    for j in range(4):<br/>        cell = top_table.cell(i+1, j)<br/>        paragraph = cell.text_frame.paragraphs[0]<br/>        run = paragraph.runs[0]<br/>        run.text = str(top_df.iloc[i, j])<br/>bottom_table = shapes[bottom_table_idx].table<br/>for i in range(5):<br/>    for j in range(4):<br/>        cell = bottom_table.cell(i+1, j)<br/>        paragraph = cell.text_frame.paragraphs[0]<br/>        run = paragraph.runs[0]<br/>        run.text = str(bottom_df.iloc[i, j])</span><span id="2836" class="ot lh it op b gy pc ov l ow ox">currencies_ppt.save('New_Currencies.pptx')</span><span id="3453" class="ot lh it op b gy pc ov l ow ox">ppt_file_path = os.getcwd() + '\\New_Currencies.pptx'<br/>powerpoint = win32com.client.Dispatch('Powerpoint.Application')<br/>deck = powerpoint.Presentations.Open(ppt_file_path)<br/>img_file_path = os.getcwd() + '\\Currencies.png'<br/>powerpoint.ActivePresentation.Slides[0].Export(img_file_path, 'PNG')<br/>pdf_file_path = os.getcwd() + '\\Currencies.pdf'<br/>deck.SaveAs(pdf_file_path, 32)</span><span id="6a42" class="ot lh it op b gy pc ov l ow ox">deck.Close()<br/>powerpoint.Quit()<br/>os.system('taskkill /F /IM POWERPNT.EXE')</span></pre><p id="18bb" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">代码看起来又长又复杂。不要惊慌。如果你理解了结构，你就能很容易地处理它。</p><ol class=""><li id="f64c" class="mu mv it ma b mb mw me mx mh my ml mz mp na mt nb nc nd ne bi translated">指定您正在处理的幻灯片。</li><li id="05b9" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">移除现有地块。</li><li id="524f" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">添加新的地块。</li><li id="ede3" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">定义元件的形状指数。</li><li id="3d1d" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">逐个更新组件。</li><li id="5183" class="mu mv it ma b mb nf me ng mh nh ml ni mp nj mt nb nc nd ne bi translated">把 PPT 导出成我们想要的任何格式。</li></ol><h2 id="c356" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">1.加载 PPT 并指定幻灯片</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="8a65" class="ot lh it op b gy ou ov l ow ox">currencies_ppt = Presentation('Currencies.pptx')<br/>slide = currencies_ppt.slides[0]</span></pre><p id="fa6f" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">从上面的代码可以看到括号里的数字<code class="fe oz pa pb op b">0</code>。它指的是幻灯片编号。因为我正在制作第一张幻灯片，所以我将编号指定为<code class="fe oz pa pb op b">0</code>。例如，如果您的常规更新幻灯片在幻灯片 10 中，那么您必须将编号指定为<code class="fe oz pa pb op b">9</code>。</p><h2 id="7238" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">2.移除旧地块</h2><p id="18f8" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在<strong class="ma iu">步骤 1 </strong>中，我们定义了 7 个组件，有两个图——组件 6 和组件 7。要替换它们，我们首先必须删除它们。否则，新图将与旧图重叠。但问题是‘我们如何指定幻灯片中的特定项目？’</p><p id="bf28" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">在<code class="fe oz pa pb op b">python-pptx</code>中，不同的物体有不同的形状。要检查幻灯片中的形状，您可以执行以下代码。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="8def" class="ot lh it op b gy ou ov l ow ox">for shape in slide.shapes:<br/>    print(shape.shape_type)</span></pre><p id="2058" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">以我的幻灯片为例，下面是我收到的输出。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="922d" class="ot lh it op b gy ou ov l ow ox">PICTURE (13)<br/>PICTURE (13)<br/>TEXT_BOX (17)<br/>TABLE (19)<br/>TABLE (19)<br/>TEXT_BOX (17)<br/>TEXT_BOX (17)<br/>AUTO_SHAPE (1)<br/>AUTO_SHAPE (1)</span></pre><p id="8bc5" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">然后我们就可以算出老剧情应该是<code class="fe oz pa pb op b">PICTURE (13)</code>。要删除它们，我们只需要检查形状类型是否等于 13。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="de02" class="ot lh it op b gy ou ov l ow ox">shapes = slide.shapes<br/>for shape in shapes:<br/>    if shape.shape_type == 13:<br/>        shapes.element.remove(shape.element)</span></pre><h2 id="d44f" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">3.添加新的地块</h2><p id="ecee" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">使用以下功能可以很容易地添加图表。</p><p id="c3bf" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><code class="fe oz pa pb op b">add_picture(image_file, left, top, width=None, height=None)</code></p><p id="2efe" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">基本上，你要做的事情是设置图像文件路径和你要放的图像的 x-y 位置，就像下面这样。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="88b2" class="ot lh it op b gy ou ov l ow ox">top_img_path = 'top.png'<br/>bottom_img_path = 'bottom.png'</span><span id="f3fe" class="ot lh it op b gy pc ov l ow ox">top_pic = slide.shapes.add_picture(top_img_path, Inches(0.40), Inches(4.85), width=Inches(5.30))<br/>bottom_pic = slide.shapes.add_picture(bottom_img_path, Inches(5.25), Inches(4.85), width=Inches(5.30))</span></pre><p id="a9ee" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">请注意，图形的另一个步骤是指定图像的放置顺序。通过这样做，你必须找到一个相对形状作为参考形状，并使用<code class="fe oz pa pb op b">addnext</code>和<code class="fe oz pa pb op b">addprevious</code>函数来指定它们的关系。这就好比 PowerPoint 中的<code class="fe oz pa pb op b">Bring Forward</code>和<code class="fe oz pa pb op b">Send Backward</code>的概念。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="fa3a" class="ot lh it op b gy ou ov l ow ox">ref_element = slide.shapes[0]._element<br/>ref_element.addprevious(top_pic._element)<br/>ref_element.addprevious(bottom_pic._element)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/447ba80477d304455859e122e43927c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qm50JJhuIQa0wUjrevVLkg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">有无相对位置的区别(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure><h2 id="1a76" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">4.查找形状索引</h2><p id="def8" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">要编辑形状，我们必须确定它引用了哪个形状索引。简而言之，我们首先将形状分类到不同的列表中，并根据<code class="fe oz pa pb op b">x-coordinate (left)</code>和<code class="fe oz pa pb op b">y-coordinate (height)</code>确定相应的形状索引。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="1c84" class="ot lh it op b gy ou ov l ow ox">shapes = slide.shapes<br/>text_box_list = []<br/>auto_shape_list = []<br/>table_list = []<br/>for shape_idx in range(len(shapes)):<br/>    shape = shapes[shape_idx]<br/>    if shape.shape_type == 17:<br/>        text_box_list.append(shape_idx)<br/>    if shape.shape_type == 1:<br/>        auto_shape_list.append(shape_idx)<br/>    if shape.shape_type == 19:<br/>        table_list.append(shape_idx)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/a9ee1fd121b3d2781ad9781fe80b7fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fakvHUYtCVpgSxR2eNqn9w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将形状分类成列表(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure><p id="6ec9" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">文本框列表</strong></p><p id="c29a" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">文本框有三种形状。为了识别最后更新日期时间形状，我们可以找到具有最大高度的形状。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="88b4" class="ot lh it op b gy ou ov l ow ox">last_update_date_textbox_height = max([shapes[shape_idx].height for shape_idx in text_box_list])<br/>last_update_date_idx = [shape_idx for shape_idx in text_box_list if shapes[shape_idx].height == last_update_date_textbox_height][0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4b7e52e9aab4101c40f581e330ab68e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0CeaOh4nE0rUBIsYA9CZog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文本框(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure><p id="632a" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">自动形状列表</strong></p><p id="e40b" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">只有两种自动形状，即顶部标签和底部标签。它们具有相同的高度，但 x 坐标不同。在<code class="fe oz pa pb op b">left</code>中具有最小值的一个将是顶部标签，另一个将是底部标签。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="1377" class="ot lh it op b gy ou ov l ow ox">top_label_left = min([shapes[shape_idx].left for shape_idx in auto_shape_list])<br/>top_label_idx = [shape_idx for shape_idx in auto_shape_list if shapes[shape_idx].left == top_label_left][0]<br/>auto_shape_list.remove(top_label_idx)</span><span id="438f" class="ot lh it op b gy pc ov l ow ox">bottom_label_idx = auto_shape_list[0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a05063c7881d3eee71ea401cd7ebccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cr88wY6iZOHL2BzP7A83pA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自动整形(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure><p id="1ba4" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">表格列表</strong></p><p id="96f4" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">由于也只有两个表格，我们可以简单地应用类似的技巧，就像我们在自动形状列表中所做的那样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/15a64ffd7b6a3e800524aeac97f4dcd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0eOipLgpsejU9znsPTmIWg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="cc87" class="ot lh it op b gy ou ov l ow ox">top_table_left = min([shapes[shape_idx].left for shape_idx in table_list])<br/>top_table_idx = [shape_idx for shape_idx in table_list if shapes[shape_idx].left == top_table_left][0]<br/>table_list.remove(top_table_idx)</span><span id="3ed1" class="ot lh it op b gy pc ov l ow ox">bottom_table_idx = table_list[0]</span></pre><h2 id="b13c" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">5.更新组件</h2><p id="8b53" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">要更新组件，一个非常重要的规则是遵循形状内部的变化值，而不是格式。在下面，我用最后更新日期时间作为例子。</p><p id="77b5" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">纯文本(不要用这个)</strong></p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="a33b" class="ot lh it op b gy ou ov l ow ox">shapes[last_update_date_idx].text = 'Last Update: ' + datetime_now.strftime("%#d %b %Y %H:%M")</span></pre><p id="aee3" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">带格式的文本(用这个)</strong></p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="f5ab" class="ot lh it op b gy ou ov l ow ox">paragraph = shapes[last_update_date_idx].text_frame.paragraphs[0]<br/>paragraph.runs[4].text = datetime_now.strftime("%#d %b %Y %H:%M")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/2b367f278a029f220d435bdbde6b1140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMWiICPlJusm8IRZOH7tWg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">纯文本和带格式文本的插图(照片由<a class="ae ky" href="https://blog.cyda.hk/" rel="noopener ugc nofollow" target="_blank"> cyda </a>拍摄)</p></figure><p id="3736" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">从上面的图像中，你可以看出区别。一个段落实际上不仅用于存储形状的值，还用于存储格式信息，如对齐、字体、超链接等。因此，请记住更改段落运行中的文本值，而不是形状值。</p><p id="a697" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">附图的标记实际上具有相同的结构，我将再次重复这个概念。让我们转到表值的更新。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="914f" class="ot lh it op b gy ou ov l ow ox">top_table = shapes[top_table_idx].table<br/>for i in range(5):<br/>    for j in range(4):<br/>        cell = top_table.cell(i+1, j)<br/>        paragraph = cell.text_frame.paragraphs[0]<br/>        run = paragraph.runs[0]<br/>        run.text = str(top_df.iloc[i, j])</span></pre><p id="4b56" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">基本上，这很简单。我们找到感兴趣的表格，并为表格中的每个单元格更改段落运行中的值。请注意，<code class="fe oz pa pb op b">i</code>指的是行记录，<code class="fe oz pa pb op b">j</code>指的是列。</p><h2 id="fbad" class="ot lh it bd li pf pg dn lm ph pi dp lq mh pj pk ls ml pl pm lu mp pn po lw pp bi translated">6.导出文件</h2><p id="f119" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">教程差不多完成了，最后一步是将文件转换成我们想要的格式。基本上，让我分享人们会使用的最常见的文件结构。</p><p id="9988" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">另存为 PPT </strong></p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="7c95" class="ot lh it op b gy ou ov l ow ox">currencies_ppt.save('New_Currencies.pptx')</span></pre><p id="1cc9" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">另存为 PNG </strong></p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="5b92" class="ot lh it op b gy ou ov l ow ox">import win32com.client<br/>import os</span><span id="3b4c" class="ot lh it op b gy pc ov l ow ox">ppt_file_path = os.getcwd() + '\\New_Currencies.pptx'<br/>powerpoint = win32com.client.Dispatch('Powerpoint.Application')<br/>deck = powerpoint.Presentations.Open(ppt_file_path)</span><span id="98ff" class="ot lh it op b gy pc ov l ow ox">img_file_path = os.getcwd() + '\\Currencies.png'<br/>powerpoint.ActivePresentation.Slides[0].Export(img_file_path, 'PNG')</span><span id="acff" class="ot lh it op b gy pc ov l ow ox">deck.Close()<br/>powerpoint.Quit()<br/>os.system('taskkill /F /IM POWERPNT.EXE')</span></pre><p id="9c0e" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated"><strong class="ma iu">另存为 PDF </strong></p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="8d69" class="ot lh it op b gy ou ov l ow ox">import win32com.client<br/>import os</span><span id="e694" class="ot lh it op b gy pc ov l ow ox">ppt_file_path = os.getcwd() + '\\New_Currencies.pptx'<br/>powerpoint = win32com.client.Dispatch('Powerpoint.Application')<br/>deck = powerpoint.Presentations.Open(ppt_file_path)</span><span id="c739" class="ot lh it op b gy pc ov l ow ox">pdf_file_path = os.getcwd() + '\\Currencies.pdf'<br/>deck.SaveAs(pdf_file_path, 32)</span><span id="451e" class="ot lh it op b gy pc ov l ow ox">deck.Close()<br/>powerpoint.Quit()<br/>os.system('taskkill /F /IM POWERPNT.EXE')</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="d4fb" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">结论</h1><p id="935e" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">关于使用 Python 在 PowerPoint 中自动化工作的 office 技巧到此结束。如果你有兴趣了解更多这类工作技巧，请给个赞并关注。请继续关注我的下一篇教程。=)</p><p id="a03a" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh nk mj mk ml nl mn mo mp nm mr ms mt im bi translated">如果你觉得我的文章有用，请在<a class="ae ky" href="https://www.linkedin.com/in/yeungwong/" rel="noopener ugc nofollow" target="_blank">我的 LinkedIn 页面</a>上为我的技能背书，鼓励我写更多的文章。</p><div class="nn no gp gr np nq"><a href="https://medium.com/mlearning-ai/use-python-to-send-outlook-emails-d673ce9e33e4" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">使用 Python 发送 Outlook 电子邮件</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">使用 Python 发送通知电子邮件的分步教程</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="pv l ob oc od nz oe ks nq"/></div></div></a></div><div class="nn no gp gr np nq"><a href="https://medium.com/mlearning-ai/use-python-to-process-pdf-work-7a9d77d718f4" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">使用 Python 处理 PDF 作品</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">没有 Adobe PDF 软件，您也可以编辑 PDF，例如添加文本、拆分页面和提取信息。</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="pw l ob oc od nz oe ks nq"/></div></div></a></div></div></div>    
</body>
</html>