<html>
<head>
<title>Complete Step-by-step Conjugate Gradient Algorithm from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始完成逐步共轭梯度算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/complete-step-by-step-conjugate-gradient-algorithm-from-scratch-202c07fb52a8?source=collection_archive---------2-----------------------#2021-09-27">https://towardsdatascience.com/complete-step-by-step-conjugate-gradient-algorithm-from-scratch-202c07fb52a8?source=collection_archive---------2-----------------------#2021-09-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4101" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">实践教程</h2><div class=""/><div class=""><h2 id="dccd" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">和一般函数优化的实现</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3f78a45bf2caf9d5765d704add3cb13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C1fv3HJdh1RBspwN"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">克里斯蒂安·鲍文在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="5e1f" class="ln lo it lj b gy lp lq l lr ls"><strong class="lj jd">Table of Contents</strong> (read till the end to see how you can get the complete python code of this story)</span><span id="3462" class="ln lo it lj b gy lt lq l lr ls">· <a class="ae lh" href="#791f" rel="noopener ugc nofollow">Conjugate Gradient for Solving a Linear System</a><br/>· <a class="ae lh" href="#834b" rel="noopener ugc nofollow">Improving the Algorithm</a><br/>  ∘ <a class="ae lh" href="#9d26" rel="noopener ugc nofollow">Theorem</a><br/>  ∘ <a class="ae lh" href="#474d" rel="noopener ugc nofollow">Simple Problems</a><br/>· <a class="ae lh" href="#c404" rel="noopener ugc nofollow">Conjugate Gradient for Nonlinear Optimization Problem</a><br/>  ∘ <a class="ae lh" href="#73ae" rel="noopener ugc nofollow">Wolfe Line Search</a><br/>  ∘ <a class="ae lh" href="#01af" rel="noopener ugc nofollow">Implementation</a><br/>  ∘ <a class="ae lh" href="#e04a" rel="noopener ugc nofollow">Scenarios</a><br/>· <a class="ae lh" href="#cd74" rel="noopener ugc nofollow">Conclusion</a></span></pre><p id="4045" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi mq translated"><span class="l mr ms mt bm mu mv mw mx my di"> T </span>共轭梯度是数学上涉及的算法之一。所以，为了简化事情，我们会砍掉任何不必要的冗长的解释。后面我们还会用到一个数学定理但不会证明。我们先导入一些库。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="791f" class="nb lo it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">解线性系统的共轭梯度法</h1><p id="c7fd" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated">考虑一个线性方程<em class="nx"> Ax = b </em>其中<em class="nx"> A </em>是一个<em class="nx"> n × n </em>对称正定矩阵，<em class="nx"> x </em>和<em class="nx"> b </em>是<em class="nx"> n × 1 </em>向量。求解这个方程对于<em class="nx"> x </em>等价于下面凸函数<em class="nx"> f(x) </em>的最小化问题</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/83c0dc448bc6df6405f64eff5e46c0cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*wZecCBFehfowaiXutwGKqw.png"/></div></figure><p id="8504" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">也就是说，这两个问题都有相同的唯一解。</p><p id="24c3" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们将迭代求解<em class="nx"> x </em>的<em class="nx"> Ax = b </em>。定义残差<em class="nx">r(x)</em>:=∇<em class="nx">f(x)= ax b</em>。然后在迭代<em class="nx"> xₖ </em>，我们有</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/8c6325f4662df88d15f308a84e7a5d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/format:webp/1*mcqmW43XgmTLdCfgNJAx5A.png"/></div></figure><p id="0505" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">沿着<em class="nx"> xₖ + αpₖ </em>的<em class="nx"> f </em>的一维极小元显式给出(通过将<em class="nx">f(xₖ+αpₖ】</em>w . r . t .<em class="nx">α</em>的一阶导数设为零)如下</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a6a5ffadba060850d912942ff5240610.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*mE1fGFAhhAZModIkn9vWcw.png"/></div></figure><p id="a81c" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">在共轭梯度法中，选择方向集{ <em class="nx"> p₀，p₁，… </em> }，使其元素相对于<em class="nx"> A </em>为<em class="nx">共轭</em>，即，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7097eda9ae6eedd798e70c0b1c794c5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*j68iVNXTsg93GHAXzxPh6Q.png"/></div></figure><p id="5e4d" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">每个方向<em class="nx"> pₖ </em>被选择为负残差- <em class="nx"> rₖ </em>(这是函数<em class="nx"> f </em>的最陡下降方向)和前一个方向<em class="nx"> pₖ₋₁ </em>的线性组合。我们写作</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0aa7680ee35155a59b14e1d93d97f98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*WvRixFBGu9Vi-j4oAKjf-g.png"/></div></figure><p id="29a7" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">其中标量<em class="nx"> βₖ </em>由要求<em class="nx"> pₖ₋₁ </em>和<em class="nx"> pₖ </em>必须相对于<em class="nx"> A </em>共轭来确定。通过将最后一个等式乘以</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/0175f921aed86f54d1cac800d74a48cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:104/format:webp/1*3g-6-VSXSXcSGrpXHcff8g.png"/></div></figure><p id="b239" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">并强加条件</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/5f704b3da001fa5ce658e30f2fedb5f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:222/format:webp/1*RpjuHoGBOgRkypD20Ozt5w.png"/></div></figure><p id="8c8e" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们发现</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f509b850ade0561a43e65cdfbbec69ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:282/format:webp/1*_Y3dXS89AVY0b7PJNpFIRg.png"/></div></figure><p id="6c73" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">已知<em class="nx"> αₖ </em>和<em class="nx"> pₖ </em>，下一次迭代可以像往常一样使用</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/e83e058eb32fc8e4598c5b1f0799ab87.png" data-original-src="https://miro.medium.com/v2/resize:fit:302/format:webp/1*GMtGZTh0Fvk2D_5aHlwkIw.png"/></div></figure><p id="e397" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">如前所述，选择方向集{ <em class="nx"> p₀，p₁，… </em> }，使得其元素相对于<em class="nx"> A </em>为<em class="nx">共轭</em>。但是我们如何选择第一个搜索方向<em class="nx"> p₀ </em>？简单的用好ol '最陡下降方向在初始点<em class="nx"> x₀ </em>，也就是<em class="nx"> p₀ = -r₀ </em>。</p><p id="d111" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们现在有了一个可行的算法:</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="7c02" class="ln lo it lj b gy lp lq l lr ls">1. Initialize x₀<br/>2. Calculate r₀ = Ax₀ − b<br/>3. Assign p₀ = −r₀<br/>4. For k = 0, 1, 2, …:<br/>    * calculate αₖ = -rₖ'pₖ / pₖ'Apₖ<br/>    * update xₖ₊₁ = xₖ + αₖpₖ<br/>    * calculate rₖ₊₁ = Axₖ₊₁ - b<br/>    * calculate βₖ₊₁ = rₖ₊₁'Apₖ / pₖ'Apₖ<br/>    * update pₖ₊₁ = -rₖ₊₁ + βₖ₊₁pₖ</span></pre><p id="fc62" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">这里，<em class="nx">撇号</em>表示转置操作，以方便书写。</p><div class="oh oi gp gr oj ok"><a rel="noopener follow" target="_blank" href="/complete-step-by-step-gradient-descent-algorithm-from-scratch-acba013e8420"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd jd gy z fp op fr fs oq fu fw jc bi translated">从头开始完成逐步梯度下降算法</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">以及恒定学习速率和线搜索的实现</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">towardsdatascience.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy lb ok"/></div></div></a></div><h1 id="834b" class="nb lo it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">改进算法</h1><p id="0a1e" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated">我们可以进一步提高计算<em class="nx"> αₖ </em>和<em class="nx"> βₖ </em>的时间和空间复杂度。为此，我们提出了以下定理。前面说过，这里不证明定理。</p></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="9d26" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">定理1</h2><p id="dbe9" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated">设<em class="nx"> x₀ </em> ∈ ℝ <em class="nx"> ⁿ </em>为任意起点，并假设序列{ <em class="nx"> xₖ </em> }如上所述生成。然后</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/1a108badc737e557baf6541dc9380bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*kD7WHoZPMz70bFaSx9sA-w.png"/></div></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><p id="d050" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">固定<em class="nx"> k &gt; 0 </em>。因为我们已经</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0aa7680ee35155a59b14e1d93d97f98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*WvRixFBGu9Vi-j4oAKjf-g.png"/></div></figure><p id="cd8e" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">然后</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/f28cbd3d46e9e4eeeb3d837c6195dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:294/format:webp/1*5At1HJtC7XgxLywJD0JWOw.png"/></div></figure><p id="d165" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">因此</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/2136d0f4ff219563e2198b89bfb369b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*OS2xUE44ezDRha90FJzimQ.png"/></div></figure><p id="886a" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">因为由<strong class="lw jd">定理1 </strong>右手边是零，那么我们有</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/6e0ec3efbc9225b8a6cf573b7b560226.png" data-original-src="https://miro.medium.com/v2/resize:fit:242/format:webp/1*NierRTd3OldppWUdqBHRxw.png"/></div></figure><p id="0add" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">将两边除以</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/13cb73ea1ce4d282dd620861dca05d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/format:webp/1*J4kkfNhavyHh77FiKtY6XQ.png"/></div></figure><p id="439f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们获得</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/12462e29e09a1b2e33d8e55622cce4b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/format:webp/1*TQaIws1W0xaQRfzGSGcNkA.png"/></div></figure><p id="e060" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">最后一个等式的左手边正是αₖ。于是我们有了一种更经济的形式<em class="nx"> αₖ </em>如下</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/8f256bf7593993651f152a69d0585a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:218/format:webp/1*UeAADzw662guTdREmBcz1A.png"/></div></figure><p id="5efb" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">既然<em class="nx">rₖ=axₖb</em>，我们就有<em class="nx">rₖ₊₁rₖ=a(xₖ₊₁xₖ)</em>。结合步骤方程式<em class="nx"> xₖ₊₁ = xₖ + αₖpₖ </em>，我们得出</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi px"><img src="../Images/8b13dedae4baa77e174cee538e89b173.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*iFw607yczE0tiBT7Sas5Zg.png"/></div></figure><p id="8d01" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">将最后一个方程代入上面建立的<em class="nx"> βₖ₊₁ </em>方程，我们得到</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi py"><img src="../Images/c2110d1035bdbc0f29bacc3f18621d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*B_CCAZuAbn-hohmKJCI9dg.png"/></div></div></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><p id="daa3" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">考虑以下观察结果:</p><ul class=""><li id="e546" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated">从<strong class="lw jd">定理1 </strong>，我们有</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qi"><img src="../Images/9ff80543fed8bc47d5963c87d7177249.png" data-original-src="https://miro.medium.com/v2/resize:fit:194/format:webp/1*oQjceUSBFtSt11LkS7dhTw.png"/></div></figure><ul class=""><li id="6c7c" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated">我们以前证明过</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/62e4f7001658082a43db0c9dc7cf6cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:242/format:webp/1*PdG3ZmXU3L-JxazTm-DuLQ.png"/></div></figure><ul class=""><li id="5a1b" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated">因为</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0aa7680ee35155a59b14e1d93d97f98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*WvRixFBGu9Vi-j4oAKjf-g.png"/></div></figure><p id="1390" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们有</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi px"><img src="../Images/73e72acd851aa211de4547413aca21d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*cVd55bi3pRk5YBAHQxqIwA.png"/></div></figure><p id="1b45" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">因此</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/c31b2b483260dfb3fdea5e296005d768.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*uI9zav0oq85O4iSXkrxERQ.png"/></div></figure><p id="3512" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">自由<strong class="lw jd">定理1 </strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qk"><img src="../Images/01a8a5501aa93d79397e7f82e978fa2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*WLDupzxU3cHBx0BJAwUlAQ.png"/></div></figure><p id="1d21" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们有</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ql"><img src="../Images/6654ee74c33e4273639b704180c806b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:186/format:webp/1*86jURQcAuwzI5Q19C7oJQg.png"/></div></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><p id="1a2e" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">将这三个观察值代入上面最新的<em class="nx"> βₖ₊₁ </em>方程，我们得到</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qm"><img src="../Images/8a92fe31801e5220a21ed348bb5dbec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*V5M3Xure2_0gFVgvP-ll3A.png"/></div></figure><p id="61d1" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">现在，我们已经具备了构建求解线性系统的共轭梯度算法的所有要素。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="121f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们将尝试使用该算法来解决<em class="nx"> x </em>的<em class="nx"> Ax = b </em>，其中<em class="nx"> A </em>和<em class="nx"> b </em>对于下面三个问题的定义是不同的。</p><h2 id="474d" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">问题1</h2><p id="f402" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated"><em class="nx"> A </em>是2 × 2对称正定矩阵<em class="nx"> b </em>是2 × 1向量。两者都是使用来自<code class="fe qn qo qp lj b">scikit-learn</code>的<code class="fe qn qo qp lj b">make_spd_matrix</code>函数随机生成的。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="542a" class="ln lo it lj b gy lp lq l lr ls">A<br/> [[ 2.5409 -0.0113]<br/>  [-0.0113  0.5287]]</span><span id="1b36" class="ln lo it lj b gy lt lq l lr ls">b<br/> [1.3864  0.3719]</span><span id="bbbc" class="ln lo it lj b gy lt lq l lr ls">The solution x* should be<br/> [0.5488  0.7152]</span></pre><p id="6f7d" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">让我们运行共轭梯度算法，初始点<em class="nx"> x₀ </em>在[-3，-4]。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="564a" class="ln lo it lj b gy lp lq l lr ls">Iteration: 1 	 x = [ 0.7428 -2.9758] 	 residual = 2.0254<br/>Iteration: 2 	 x = [ 0.5488  0.7152] 	 residual = 0.0000</span><span id="a5a9" class="ln lo it lj b gy lt lq l lr ls">Solution: 	 x = [ 0.5488  0.7152]</span></pre><p id="ea37" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">这个解是在两次迭代中找到的。我们可以使用<code class="fe qn qo qp lj b">numpy</code>中的<code class="fe qn qo qp lj b">allclose</code>功能来检查解决方案是否是我们想要的。如果它返回<code class="fe qn qo qp lj b">True</code>，则解是正确的。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="c7c3" class="ln lo it lj b gy lp lq l lr ls">True</span></pre><p id="d3fc" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">最后，我们可以将这个问题转化为函数<em class="nx"> f </em>的最小化，其中<em class="nx"> f </em>定义如下。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="402c" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">为了可视化学习路径，我们创建一些python函数，如下所示。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/349891a3896b4ca149032dbff26577a5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*vyHNYD80-zd5qf2mZKwOOw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure><p id="e70f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">从上面的图中，我们可以确认在两次迭代中确实找到了解决方案。对于下面的另外两个问题，我们不会费心绘图，因为<em class="nx"> x </em>的维数大于2，因此很难或不可能绘图。</p><h2 id="9ebe" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">问题2</h2><p id="fcf3" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated"><em class="nx"> A </em>是一个3 × 3对称正定矩阵，<em class="nx"> b </em>是一个3 × 1向量，两者都是像以前一样随机生成的。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="3fb1" class="ln lo it lj b gy lp lq l lr ls">A<br/> [[ 0.7444 -0.5055 -0.0851]<br/>  [-0.5055  3.4858  0.0572]<br/>  [-0.0851  0.0572  0.4738]]</span><span id="5036" class="ln lo it lj b gy lt lq l lr ls">b<br/> [-0.0043  2.2501  0.2798]</span><span id="b7aa" class="ln lo it lj b gy lt lq l lr ls">The solution x* should be<br/> [ 0.5488  0.7152  0.6028]</span></pre><p id="ee27" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">让我们运行共轭梯度算法，初始点在[3，1，-7]。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="73e8" class="ln lo it lj b gy lp lq l lr ls">Iteration: 1 	 x = [ 0.0261  1.8702 -2.1522] 	 residual = 4.3649<br/>Iteration: 2 	 x = [-0.5372  0.5115 -0.3009] 	 residual = 0.7490<br/>Iteration: 3 	 x = [ 0.5488  0.7152  0.6028] 	 residual = 0.0000</span><span id="514d" class="ln lo it lj b gy lt lq l lr ls">Solution: 	 x = [ 0.5488  0.7152  0.6028]</span></pre><p id="2c7a" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">这个解是在三次迭代中找到的。我们再次看到，这确实是我们想要的解决办法。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="07f5" class="ln lo it lj b gy lp lq l lr ls">True</span></pre><h2 id="2301" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">问题3</h2><p id="3f5b" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated"><em class="nx"> A </em>是一个6 × 6的对称正定矩阵，<em class="nx"> b </em>是一个6 × 1的向量，两者都是像以前一样随机生成的。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="99ea" class="ln lo it lj b gy lp lq l lr ls">A<br/> [[ 3.4430 -0.3963  2.5012  0.9525  0.6084 -1.2728]<br/>  [-0.3963  0.6015 -0.4108 -0.1359 -0.0295  0.2630]<br/>  [ 2.5012 -0.4108  2.5927  0.7072  0.5587 -1.0613]<br/>  [ 0.9525 -0.1359  0.7072  1.1634  0.1920 -0.4344]<br/>  [ 0.6084 -0.0295  0.5587  0.1920  0.7636 -0.3261]<br/>  [-1.2728  0.2630 -1.0613 -0.4344 -0.3261  1.0869]]</span><span id="187c" class="ln lo it lj b gy lt lq l lr ls">b<br/> [ 3.0685  0.0484  2.5783  1.2865  0.8671 -0.8230]</span><span id="789f" class="ln lo it lj b gy lt lq l lr ls">The solution x* should be<br/> [ 0.5488  0.7152  0.6028  0.5449  0.4237  0.6459]</span></pre><p id="c09f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">让我们运行共轭梯度算法，初始点在[9，0，-2，3，-2，5]。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="a0db" class="ln lo it lj b gy lp lq l lr ls">Iteration: 1   x = [ 6.0798  0.2932 -3.6765  1.9076 -2.1460  5.5981]<br/>               residual = 5.2930<br/>Iteration: 2   x = [ 1.5966 -0.3208 -0.2777 -0.5521  1.3176  1.3223]<br/>               residual = 1.1933<br/>Iteration: 3   x = [ 0.6074  0.2616  0.2860  0.7581  0.8068  0.6812]<br/>               residual = 0.3795<br/>Iteration: 4   x = [ 0.5343  0.6703  0.6294  0.5496  0.4109  0.6765]<br/>               residual = 0.0346<br/>Iteration: 5   x = [ 0.5477  0.7172  0.6058  0.5464  0.4280  0.6519]<br/>               residual = 0.0047<br/>Iteration: 6   x = [ 0.5488  0.7152  0.6028  0.5449  0.4237  0.6459]<br/>               residual = 0.0000</span><span id="4078" class="ln lo it lj b gy lt lq l lr ls">Solution:      x = [ 0.5488  0.7152  0.6028  0.5449  0.4237  0.6459]<br/>The solution is correct.</span></pre><p id="5f53" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">这个解是在六次迭代中找到的。我们再次看到，这确实是我们想要的解决办法。</p></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><p id="19b4" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们能从这些例子中学到什么？最明显的就是共轭梯度算法求解所需的迭代与矩阵<em class="nx"> A </em>的维数相同。这就是为什么我们不需要在<code class="fe qn qo qp lj b">LinearCG</code>函数中保护我们的算法免于无限循环(例如使用最大迭代)。事实上，如果<em class="nx"> A </em>只有<em class="nx"> r </em>个不同的特征值，那么共轭梯度迭代最多在<em class="nx"> r </em>次迭代中终止于解。</p><p id="1fdc" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">共轭梯度法只推荐用于大问题；否则，高斯消去法或诸如奇异值分解之类的其他因子分解算法是优选的，因为它们对舍入误差不太敏感。</p><h1 id="c404" class="nb lo it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">非线性优化问题的共轭梯度</h1><p id="ed08" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated">在上一节中，我们已经实现了共轭梯度作为凸二次函数<em class="nx"> f </em>的最小化算法。我们已经准备好加强我们的比赛。我们能否采用这种方法来最小化一般的凸函数，甚至一般的非线性函数<em class="nx"> f </em>？</p><p id="3227" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们可以通过改变前面算法中的两件事来做到这一点:</p><ul class=""><li id="add5" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated">步长<em class="nx"> αₖ </em>目前是沿着<em class="nx"> pₖ </em>的<em class="nx"> f </em>的精确最小值。相反，我们希望使用线搜索算法将<em class="nx"> αₖ </em>作为最小化点的近似值。</li><li id="a577" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated">残差<em class="nx"> rₖ </em>现在应该是目标函数<em class="nx"> f </em>的梯度。</li></ul><p id="faef" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们已经在<a class="ae lh" rel="noopener" target="_blank" href="/complete-step-by-step-gradient-descent-algorithm-from-scratch-acba013e8420">上一篇文章</a>中介绍了一种线搜索算法:<a class="ae lh" rel="noopener" target="_blank" href="/complete-step-by-step-gradient-descent-algorithm-from-scratch-acba013e8420#9f3c">阿米霍线搜索</a>。然而，因为在共轭梯度法中，我们有</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qw"><img src="../Images/d70d66e3fb84a9234b1f56cb314f7fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*kTsskBrHMY9wwrjNMrTNNw.png"/></div></figure><p id="c848" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">如果<em class="nx"> βₖpₖ₋₁ </em>占优势，仅充分下降条件不足以确保下降方向。</p><p id="5464" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">输入沃尔夫线搜索。</p><h2 id="73ae" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">沃尔夫线搜索</h2><p id="cd43" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated">我们增加另一个条件，叫做<em class="nx">曲率条件</em>，它要求<em class="nx"> αₖ </em>满足</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qx"><img src="../Images/44b96b2df209a4f1fe43f3c5aacb03f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*cpsjjc1t4OA5FsazQqU8QA.png"/></div></figure><p id="0ba3" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">对于某些常数<em class="nx">c₂</em>∑<em class="nx">(c₁，1) </em>其中<em class="nx"> c₁ </em>是来自阿米霍条件的常数。注意，左手边仅仅是<em class="nx"> f(xₖ + αpₖ) </em>在<em class="nx"> αₖ </em>的导数，因此曲率条件确保<em class="nx"> f(xₖ + αpₖ) </em>在<em class="nx"> αₖ </em>的斜率大于<em class="nx"> c₂ </em>乘以初始斜率</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qy"><img src="../Images/f3cee062883d600e7c28c3e67cbc95fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:124/format:webp/1*1i_vWIQx8yxDrsYKFRzZjg.png"/></div></figure><p id="4b22" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">该条件排除了Armijo条件优选的不可接受的短步长，因此<em class="nx"> f </em>可以显著减少。结合阿米霍条件，这两个条件也被称为<em class="nx">沃尔夫条件</em>。</p><p id="aa14" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们可以修改曲率条件，以迫使<em class="nx"> αₖ </em>至少位于<em class="nx"> f </em>的局部极小点或驻点的宽邻域内。这种修改被称为<em class="nx">强沃尔夫条件</em>并要求<em class="nx"> αₖ </em>满足</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qz"><img src="../Images/0c8e52f0b8cc51fcb72707a9adea1f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*PHluiG-9dTln7GooH7vxHg.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ra"><img src="../Images/980fdb6f94969eee9849cbf2bb1af144.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*86h5ROr2h2VcQuB4EFuEPQ.png"/></div></figure><p id="25a5" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">对于我们在<a class="ae lh" rel="noopener" target="_blank" href="/complete-step-by-step-gradient-descent-algorithm-from-scratch-acba013e8420">上一篇文章</a>中讨论的阿米霍线搜索，我们通过将<em class="nx"> αₖ </em>乘以收缩项<em class="nx"> ρ </em>来定位最终步长。这种策略对于强Wolfe条件来说是低效的，因为它违背了该条件的目的。因此，对于选择阶段，我们放大以定位最终步长，这通常会在搜索所需步长的过程中减少括号间隔，并插入在早期步骤中收集的一些函数和导数信息，以猜测最小点的位置。我们不会在这里解释数学，因为它非常乏味，直接阅读下面的代码可能会更好。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="ff28" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">哇，这是一个长的。现在我们准备实现Wolfe线搜索到共轭梯度算法。</p><h2 id="01af" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">履行</h2><p id="73c0" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated">首先，我们定义一个目标函数来求解:<a class="ae lh" href="https://en.wikipedia.org/wiki/Griewank_function" rel="noopener ugc nofollow" target="_blank">格里万克函数</a>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi rb"><img src="../Images/ca47c886112f32c58b28c61a457bf38b.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*eqn08xuazt6zBZylGq8TDg.png"/></div></figure><p id="35a6" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们将使用二维版本的格里万克函数(<em class="nx"> n = 2 </em>)，正如在<a class="ae lh" rel="noopener" target="_blank" href="/complete-step-by-step-gradient-descent-algorithm-from-scratch-acba013e8420">上一篇文章</a>中所做的那样。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="4c2e" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">最后，让我们建立非线性共轭梯度算法。如前所述，我们使用</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi rc"><img src="../Images/844c49192d3299f4d3177483b7415a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*hWwCW45ILTkMhVUCPedXdw.png"/></div></figure><p id="96dd" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">以<em class="nx">为方向，αₖ </em>从沃尔夫线搜索为步长。此外，将采取措施，直到满足以下停止标准之一:</p><ul class=""><li id="c2e2" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated"><em class="nx"> f </em>的梯度的范数足够接近零，也就是说，</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi rd"><img src="../Images/290ef7d8aea9682f43896ee2f06db3a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*rgjTXFyot_w6ewEDsjuo2w.png"/></div></div></figure><ul class=""><li id="19e6" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated">采取的步骤数是1000</li></ul><p id="8a3e" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">前面提到的<em class="nx"> βₖ </em>的公式是由弗莱彻-里维斯(FR)开发的。这种方法的一个主要问题是，如果我们，不管什么原因，最终走向错误的方向<em class="nx"> pₖ </em>，那么FR继续产生错误的方向。出于这个原因，Polak-Ribiere (PR)开发了另一种形式的<em class="nx"> βₖ </em>，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi re"><img src="../Images/3fb9f71056cdfb59fe279546d6a7f243.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*fFXoPWWRcmq0cuvyy4pRUA.png"/></div></figure><p id="1cae" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">在实践中，PR的共轭梯度算法通常比FR的效果更好。然而，强沃尔夫条件并不能保证<em class="nx"> pₖ </em>是下降方向。</p><p id="4613" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">在下面的代码中，我们还介绍了βₖ的许多其他变体:</p><ul class=""><li id="fda5" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated">赫斯泰尼斯-斯蒂费尔</li><li id="e55a" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated">戴渊(DY)</li><li id="67fa" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated">哈格-张(赫兹)</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="28c3" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">然后，我们创建一个python函数来创建两个图:</p><ul class=""><li id="de0f" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated"><em class="nx"> x </em>的学习路径以及<em class="nx"> f(x) </em>的轮廓图</li><li id="0b24" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated">每走一步<em class="nx"> f(x) </em>的值</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="3232" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">对于一个初始值<em class="nx"> x₀ </em>和一些<em class="nx"> β </em>估计方法，我们在不同的场景下对<em class="nx"> f </em>运行共轭梯度算法:</p><ul class=""><li id="764a" class="pz qa it lw b lx ly ma mb md qb mh qc ml qd mp qe qf qg qh bi translated"><em class="nx"> x₀ = </em> [ <em class="nx"> 0，3 </em> ]并使用FR</li><li id="1ccc" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated"><em class="nx"> x₀ = </em> [ <em class="nx"> 2，1 </em> ]并使用FR</li><li id="16ce" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated"><em class="nx"> x₀ = </em> [ <em class="nx"> 2，1 </em> ]并使用PR</li><li id="18a6" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated"><em class="nx"> x₀ = </em> [ <em class="nx"> 2，1 </em> ]并使用HS</li><li id="26c4" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated"><em class="nx"> x₀ = </em> [ <em class="nx"> 2，1 </em> ]并使用DY</li><li id="8123" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated"><em class="nx"> x₀ = </em> [ <em class="nx"> 2，1 </em> ]并使用赫兹</li><li id="8bc3" class="pz qa it lw b lx qr ma qs md qt mh qu ml qv mp qe qf qg qh bi translated"><em class="nx"> x₀ = </em> [ <em class="nx"> 2，2 </em> ]并使用赫兹</li></ul></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="e04a" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">场景1: <em class="rf"> x₀ = </em> [ <em class="rf"> 0，3 </em> ]并使用FR</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="fd65" class="ln lo it lj b gy lp lq l lr ls">Initial condition: y = 1.5254, x = [0 3]</span><span id="54a8" class="ln lo it lj b gy lt lq l lr ls">Iteration: 1 	y = 0.0004, x = [ 0.0000 -0.0389], gradient = 0.0195<br/>Iteration: 2 	y = 0.0000, x = [ 0.0000 -0.0012], gradient = 0.0006<br/>Iteration: 3 	y = 0.0000, x = [ 0.0000  0.0000], gradient = 0.0000<br/>Iteration: 4 	y = 0.0000, x = [ 0.0000  0.0000], gradient = 0.0000</span><span id="d7dd" class="ln lo it lj b gy lt lq l lr ls">Solution: 	y = 0.0000, x = [ 0.0000  0.0000]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/21606c9d238ea6edd43cf29000f7996f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*JfTlGNbQ9GG6OzKOc3XzUg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="8d97" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">场景2: x₀ = [2，1]并使用FR</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="2d27" class="ln lo it lj b gy lp lq l lr ls">Initial condition: y = 1.3176, x = [2 1]</span><span id="894a" class="ln lo it lj b gy lt lq l lr ls">Iteration: 1 	y = 0.5170, x = [ 0.2435  1.4838], gradient = 0.6077<br/>Iteration: 2 	y = 0.3029, x = [-0.3727  1.0246], gradient = 0.5152<br/>Iteration: 3 	y = 0.1579, x = [-0.5426  0.2577], gradient = 0.5198<br/>Iteration: 4 	y = 0.0758, x = [-0.3477 -0.2603], gradient = 0.3566<br/>Iteration: 5 	y = 0.0462, x = [-0.1203 -0.3975], gradient = 0.2265<br/>Iteration: 6 	y = 0.0329, x = [ 0.0433 -0.3585], gradient = 0.1822<br/>Iteration: 7 	y = 0.0220, x = [ 0.1482 -0.2118], gradient = 0.1796<br/>Iteration: 8 	y = 0.0120, x = [ 0.1548 -0.0102], gradient = 0.1543<br/>Iteration: 9 	y = 0.0064, x = [ 0.0865  0.1037], gradient = 0.1005<br/>Iteration: 10 	y = 0.0042, x = [ 0.0221  0.1262], gradient = 0.0668<br/>Iteration: 11 	y = 0.0031, x = [-0.0241  0.1051], gradient = 0.0578<br/>Iteration: 12 	y = 0.0020, x = [-0.0511  0.0513], gradient = 0.0571<br/>Iteration: 13 	y = 0.0010, x = [-0.0451 -0.0090], gradient = 0.0453<br/>Iteration: 14 	y = 0.0006, x = [-0.0222 -0.0367], gradient = 0.0288<br/>Iteration: 15 	y = 0.0004, x = [-0.0031 -0.0397], gradient = 0.0201<br/>Iteration: 16 	y = 0.0003, x = [ 0.0104 -0.0304], gradient = 0.0184<br/>Iteration: 17 	y = 0.0002, x = [ 0.0169 -0.0114], gradient = 0.0178<br/>Iteration: 18 	y = 0.0001, x = [ 0.0128  0.0059], gradient = 0.0132<br/>Iteration: 19 	y = 0.0001, x = [ 0.0055  0.0124], gradient = 0.0083<br/>Iteration: 20 	y = 0.0000, x = [-0.0001  0.0123], gradient = 0.0062<br/>Iteration: 21 	y = 0.0000, x = [-0.0041  0.0085], gradient = 0.0059<br/>Iteration: 22 	y = 0.0000, x = [-0.0053  0.0021], gradient = 0.0055<br/>Iteration: 23 	y = 0.0000, x = [-0.0035 -0.0027], gradient = 0.0038<br/>Iteration: 24 	y = 0.0000, x = [-0.0013 -0.0041], gradient = 0.0024<br/>Iteration: 25 	y = 0.0000, x = [ 0.0004 -0.0037], gradient = 0.0019<br/>Iteration: 26 	y = 0.0000, x = [ 0.0015 -0.0023], gradient = 0.0019<br/>Iteration: 27 	y = 0.0000, x = [ 0.0016 -0.0002], gradient = 0.0016<br/>Iteration: 28 	y = 0.0000, x = [ 0.0010  0.0010], gradient = 0.0011<br/>Iteration: 29 	y = 0.0000, x = [ 0.0003  0.0013], gradient = 0.0007<br/>Iteration: 30 	y = 0.0000, x = [-0.0002  0.0011], gradient = 0.0006<br/>Iteration: 31 	y = 0.0000, x = [-0.0005  0.0006], gradient = 0.0006<br/>Iteration: 32 	y = 0.0000, x = [-0.0005 -0.0001], gradient = 0.0005<br/>Iteration: 33 	y = 0.0000, x = [-0.0002 -0.0004], gradient = 0.0003<br/>Iteration: 34 	y = 0.0000, x = [-0.0000 -0.0004], gradient = 0.0002<br/>Iteration: 35 	y = 0.0000, x = [ 0.0001 -0.0003], gradient = 0.0002<br/>Iteration: 36 	y = 0.0000, x = [ 0.0002 -0.0001], gradient = 0.0002<br/>Iteration: 37 	y = 0.0000, x = [ 0.0001  0.0001], gradient = 0.0001<br/>Iteration: 38 	y = 0.0000, x = [ 0.0001  0.0001], gradient = 0.0001<br/>Iteration: 39 	y = 0.0000, x = [ 0.0000  0.0001], gradient = 0.0001<br/>Iteration: 40 	y = 0.0000, x = [-0.0000  0.0001], gradient = 0.0001<br/>Iteration: 41 	y = 0.0000, x = [-0.0001  0.0000], gradient = 0.0001<br/>Iteration: 42 	y = 0.0000, x = [-0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 43 	y = 0.0000, x = [-0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 44 	y = 0.0000, x = [ 0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 45 	y = 0.0000, x = [ 0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 46 	y = 0.0000, x = [ 0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 47 	y = 0.0000, x = [ 0.0000  0.0000], gradient = 0.0000<br/>Iteration: 48 	y = 0.0000, x = [ 0.0000  0.0000], gradient = 0.0000</span><span id="9151" class="ln lo it lj b gy lt lq l lr ls">Solution: 	y = 0.0000, x = [ 0.0000  0.0000]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/6fb0f815ebf888d51df4018b875cd909.png" data-original-src="https://miro.medium.com/v2/format:webp/1*UzBVi0fLV693P9-p4nuNog.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="5833" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">场景3: x₀ = [2，1]并使用PR</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="2cd8" class="ln lo it lj b gy lp lq l lr ls">Initial condition: y = 1.3176, x = [2 1]</span><span id="b854" class="ln lo it lj b gy lt lq l lr ls">Iteration: 1 	y = 0.5170, x = [ 0.2435  1.4838], gradient = 0.6077<br/>Iteration: 2 	y = 0.3194, x = [-0.4134  1.0358], gradient = 0.5266<br/>Iteration: 3 	y = 0.0004, x = [-0.0111  0.0355], gradient = 0.0209<br/>Iteration: 4 	y = 0.0004, x = [-0.0072  0.0370], gradient = 0.0198<br/>Iteration: 5 	y = 0.0000, x = [ 0.0054  0.0041], gradient = 0.0057<br/>Iteration: 6 	y = 0.0000, x = [-0.0000  0.0000], gradient = 0.0000</span><span id="6150" class="ln lo it lj b gy lt lq l lr ls">Solution: 	y = 0.0000, x = [-0.0000  0.0000]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/1a323129a65dba9697f62aecbd0d441b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*7Ls_NGk6MW2JWW23QleZvA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="c166" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">场景4: x₀ = [2，1]并使用HS</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="f16e" class="ln lo it lj b gy lp lq l lr ls">Initial condition: y = 1.3176, x = [2 1]</span><span id="029d" class="ln lo it lj b gy lt lq l lr ls">Iteration: 1 	y = 0.5170, x = [ 0.2435  1.4838], gradient = 0.6077<br/>Iteration: 2 	y = 0.3072, x = [-0.3836  1.0276], gradient = 0.5182<br/>Iteration: 3 	y = 0.0004, x = [ 0.0119  0.0358], gradient = 0.0215<br/>Iteration: 4 	y = 0.0002, x = [-0.0077  0.0221], gradient = 0.0135<br/>Iteration: 5 	y = 0.0000, x = [-0.0000 -0.0000], gradient = 0.0000</span><span id="f878" class="ln lo it lj b gy lt lq l lr ls">Solution: 	y = 0.0000, x = [-0.0000 -0.0000]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/70ac5fdb87b6982f2add96802f5229a0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*uHRoMOHclo0E6oFLar-AIg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="67e1" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">场景5: x₀ = [2，1]并使用DY</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="b22b" class="ln lo it lj b gy lp lq l lr ls">Initial condition: y = 1.3176, x = [2 1]</span><span id="625a" class="ln lo it lj b gy lt lq l lr ls">Iteration: 1 	y = 0.5170, x = [ 0.2435  1.4838], gradient = 0.6077<br/>Iteration: 2 	y = 0.2887, x = [-0.4140  0.9624], gradient = 0.5140<br/>Iteration: 3 	y = 0.1582, x = [-0.5550  0.1947], gradient = 0.5287<br/>Iteration: 4 	y = 0.0763, x = [-0.3343 -0.2981], gradient = 0.3502<br/>Iteration: 5 	y = 0.0480, x = [-0.1058 -0.4143], gradient = 0.2270<br/>Iteration: 6 	y = 0.0341, x = [ 0.0594 -0.3606], gradient = 0.1872<br/>Iteration: 7 	y = 0.0225, x = [ 0.1599 -0.1985], gradient = 0.1855<br/>Iteration: 8 	y = 0.0120, x = [ 0.1550  0.0073], gradient = 0.1545<br/>Iteration: 9 	y = 0.0065, x = [ 0.0819  0.1131], gradient = 0.0991<br/>Iteration: 10 	y = 0.0044, x = [ 0.0172  0.1302], gradient = 0.0673<br/>Iteration: 11 	y = 0.0032, x = [-0.0290  0.1046], gradient = 0.0598<br/>Iteration: 12 	y = 0.0020, x = [-0.0540  0.0461], gradient = 0.0587<br/>Iteration: 13 	y = 0.0010, x = [-0.0445 -0.0140], gradient = 0.0451<br/>Iteration: 14 	y = 0.0006, x = [-0.0206 -0.0392], gradient = 0.0284<br/>Iteration: 15 	y = 0.0004, x = [-0.0016 -0.0407], gradient = 0.0204<br/>Iteration: 16 	y = 0.0003, x = [ 0.0119 -0.0299], gradient = 0.0191<br/>Iteration: 17 	y = 0.0002, x = [ 0.0175 -0.0096], gradient = 0.0182<br/>Iteration: 18 	y = 0.0001, x = [ 0.0125  0.0074], gradient = 0.0130<br/>Iteration: 19 	y = 0.0001, x = [ 0.0050  0.0131], gradient = 0.0082<br/>Iteration: 20 	y = 0.0000, x = [-0.0006  0.0125], gradient = 0.0063<br/>Iteration: 21 	y = 0.0000, x = [-0.0045  0.0082], gradient = 0.0061<br/>Iteration: 22 	y = 0.0000, x = [-0.0055  0.0015], gradient = 0.0055<br/>Iteration: 23 	y = 0.0000, x = [-0.0034 -0.0031], gradient = 0.0037<br/>Iteration: 24 	y = 0.0000, x = [-0.0011 -0.0043], gradient = 0.0024<br/>Iteration: 25 	y = 0.0000, x = [ 0.0005 -0.0038], gradient = 0.0020<br/>Iteration: 26 	y = 0.0000, x = [ 0.0016 -0.0022], gradient = 0.0020<br/>Iteration: 27 	y = 0.0000, x = [ 0.0016 -0.0000], gradient = 0.0016<br/>Iteration: 28 	y = 0.0000, x = [ 0.0009  0.0011], gradient = 0.0011<br/>Iteration: 29 	y = 0.0000, x = [ 0.0002  0.0014], gradient = 0.0007<br/>Iteration: 30 	y = 0.0000, x = [-0.0003  0.0011], gradient = 0.0006<br/>Iteration: 31 	y = 0.0000, x = [-0.0006  0.0005], gradient = 0.0006<br/>Iteration: 32 	y = 0.0000, x = [-0.0005 -0.0001], gradient = 0.0005<br/>Iteration: 33 	y = 0.0000, x = [-0.0002 -0.0004], gradient = 0.0003<br/>Iteration: 34 	y = 0.0000, x = [-0.0000 -0.0004], gradient = 0.0002<br/>Iteration: 35 	y = 0.0000, x = [ 0.0001 -0.0003], gradient = 0.0002<br/>Iteration: 36 	y = 0.0000, x = [ 0.0002 -0.0001], gradient = 0.0002<br/>Iteration: 37 	y = 0.0000, x = [ 0.0001  0.0001], gradient = 0.0001<br/>Iteration: 38 	y = 0.0000, x = [ 0.0001  0.0001], gradient = 0.0001<br/>Iteration: 39 	y = 0.0000, x = [-0.0000  0.0001], gradient = 0.0001<br/>Iteration: 40 	y = 0.0000, x = [-0.0000  0.0001], gradient = 0.0001<br/>Iteration: 41 	y = 0.0000, x = [-0.0001  0.0000], gradient = 0.0001<br/>Iteration: 42 	y = 0.0000, x = [-0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 43 	y = 0.0000, x = [-0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 44 	y = 0.0000, x = [ 0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 45 	y = 0.0000, x = [ 0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 46 	y = 0.0000, x = [ 0.0000 -0.0000], gradient = 0.0000<br/>Iteration: 47 	y = 0.0000, x = [ 0.0000  0.0000], gradient = 0.0000<br/>Iteration: 48 	y = 0.0000, x = [ 0.0000  0.0000], gradient = 0.0000</span><span id="155e" class="ln lo it lj b gy lt lq l lr ls">Solution: 	y = 0.0000, x = [ 0.0000  0.0000]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/5a7dfab9815af0637a5fe3d3bcc9419a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*kRw7K87HE4onW2Ra6VdMsw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="ff11" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">场景6: x₀ = [2，1]并使用赫兹</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="8951" class="ln lo it lj b gy lp lq l lr ls">Initial condition: y = 1.3176, x = [2 1]</span><span id="aea7" class="ln lo it lj b gy lt lq l lr ls">Iteration: 1 	y = 0.5170, x = [ 0.2435  1.4838], gradient = 0.6077<br/>Iteration: 2 	y = 0.2369, x = [-0.4269  0.8147], gradient = 0.4939<br/>Iteration: 3 	y = 0.0000, x = [-0.0064 -0.0053], gradient = 0.0070<br/>Iteration: 4 	y = 0.0000, x = [ 0.0003 -0.0008], gradient = 0.0005<br/>Iteration: 5 	y = 0.0000, x = [ 0.0000  0.0000], gradient = 0.0000</span><span id="3196" class="ln lo it lj b gy lt lq l lr ls">Solution: 	y = 0.0000, x = [ 0.0000  0.0000]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/7f385c645a3107b232ef69f8e7695c48.png" data-original-src="https://miro.medium.com/v2/format:webp/1*iA-dL6bY3cOsDMDgc8yiGA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><h2 id="6bcb" class="ln lo it bd nc pg ph dn ng pi pj dp nk md pk pl nm mh pm pn no ml po pp nq iz bi translated">场景7: x₀ = [2，2]并使用赫兹</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mz na l"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="9198" class="ln lo it lj b gy lp lq l lr ls">Initial condition: y = 1.0669, x = [2 2]</span><span id="4a57" class="ln lo it lj b gy lt lq l lr ls">Iteration: 1 	y = 0.9666, x = [ 1.7144  2.5793], gradient = 0.2652<br/>Iteration: 2 	y = 0.0075, x = [ 3.1474  4.4532], gradient = 0.0104<br/>Iteration: 3 	y = 0.0074, x = [ 3.1379  4.4420], gradient = 0.0028<br/>Iteration: 4 	y = 0.0074, x = [ 3.1400  4.4384], gradient = 0.0000</span><span id="171d" class="ln lo it lj b gy lt lq l lr ls">Solution: 	y = 0.0074, x = [ 3.1400  4.4384]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl qq"><img src="../Images/1718d5802d81af6590b0d0c0e62fdb97.png" data-original-src="https://miro.medium.com/v2/format:webp/1*4xThiVukz3TM_fP4SKXCgw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener">作者</a></p></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><p id="8fef" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">从这些例子中，我们看到，采用共轭梯度算法进行一般函数优化将不再确保过程在某个特定的迭代次数终止。这就是为什么我们使用<code class="fe qn qo qp lj b">max_iter</code>来保护算法。</p><p id="748f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated"><em class="nx"> βₖ </em>计算方法的不同导致算法性能的不同。此外，<em class="nx"> xₖ </em>的不良初始化可能不会导致过程中的全局最小值。</p><p id="3d38" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">从这些结果中你还能推断出什么？让我们在下面的回复部分讨论这个问题。</p><h1 id="cd74" class="nb lo it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">结论</h1><p id="8a74" class="pw-post-body-paragraph lu lv it lw b lx ns kd lz ma nt kg mc md nu mf mg mh nv mj mk ml nw mn mo mp im bi translated">共轭梯度算法用于求解线性系统，或者等价地，优化二次凸函数。它设置学习路径方向，使得它们相对于系数矩阵<em class="nx"> A </em>是<em class="nx">共轭</em>，因此该过程在最多<em class="nx"> A </em>次迭代之后终止。该算法可用于利用Wolfe线搜索优化一般可微函数，并可通过考虑方向系数<em class="nx"> βₖ </em>的变化进行改进。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi rg"><img src="../Images/e1a6e3674ab93bcb99796285f9d0175c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6HsoGpmIb1oibJc_JWbqJA.gif"/></div></div></figure></div><div class="ab cl oz pa hx pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="im in io ip iq"><p id="4859" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">🔥你好！如果你喜欢这个故事，想支持我这个作家，可以考虑 <a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener"> <strong class="lw jd"> <em class="nx">成为会员</em> </strong> </a> <em class="nx">。每月只需5美元，你就可以无限制地阅读媒体上的所有报道。如果你注册使用我的链接，我会赚一小笔佣金。</em></p><p id="bd58" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">🔖<em class="nx">想了解更多经典机器学习模型的工作原理，以及它们是如何优化参数的？或者MLOps大型项目的例子？有史以来最优秀的文章呢？继续阅读:</em></p><div class="oh oi gp gr oj"><div role="button" tabindex="0" class="ab bv gv cb fp rh ri bn rj lb ex"><div class="rk l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw rl rm fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l rl rm fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="rp rq gw l"><h2 class="bd jd wr pz fp ws fr fs oq fu fw jc bi translated">从零开始的机器学习</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi wt au wu wv ww tj wx an eh ei wy wz xa el em eo de bk ep" href="https://dwiuzila.medium.com/list/machine-learning-from-scratch-b35db8650093?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="xb l fo"><span class="bd b dl z dk">8 stories</span></div></div></div><div class="sc dh sd fp ab se fo di"><div class="di ru bv rv rw"><div class="dh l"><img alt="" class="dh" src="../Images/4b97f3062e4883b24589972b2dc45d7e.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*CWNoicci28F2TUQc-vKijw.png"/></div></div><div class="di ru bv rx ry rz"><div class="dh l"><img alt="" class="dh" src="../Images/b1f7021514ba57a443fe0db4b7001b26.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*wSRsSHYnIiGJFAqC"/></div></div><div class="di bv sa sb rz"><div class="dh l"><img alt="" class="dh" src="../Images/deb73e42c79667024a46c2c8902b81fa.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*HVEz7KwzO0tv1Q4d"/></div></div></div></div></div><div class="oh oi gp gr oj"><div role="button" tabindex="0" class="ab bv gv cb fp rh ri bn rj lb ex"><div class="rk l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw rl rm fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l rl rm fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="rp rq gw l"><h2 class="bd jd wr pz fp ws fr fs oq fu fw jc bi translated">高级优化方法</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi wt au wu wv ww tj wx an eh ei wy wz xa el em eo de bk ep" href="https://dwiuzila.medium.com/list/advanced-optimization-methods-26e264a361e4?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="xb l fo"><span class="bd b dl z dk">7 stories</span></div></div></div><div class="sc dh sd fp ab se fo di"><div class="di ru bv rv rw"><div class="dh l"><img alt="" class="dh" src="../Images/15b3188b0f29894c2bcf3d0965515f44.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*BVMamoNudzn9UlAE"/></div></div><div class="di ru bv rx ry rz"><div class="dh l"><img alt="" class="dh" src="../Images/3249ba2cf680952e2ccdff36d8ebf4a7.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*C1fv3HJdh1RBspwN"/></div></div><div class="di bv sa sb rz"><div class="dh l"><img alt="" class="dh" src="../Images/a73f0494533d8a08b01c2b899373d2b9.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*QZvzgiM2VnhYyx8M"/></div></div></div></div></div><div class="oh oi gp gr oj"><div role="button" tabindex="0" class="ab bv gv cb fp rh ri bn rj lb ex"><div class="rk l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw rl rm fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l rl rm fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="rp rq gw l"><h2 class="bd jd wr pz fp ws fr fs oq fu fw jc bi translated">MLOps大型项目</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi wt au wu wv ww tj wx an eh ei wy wz xa el em eo de bk ep" href="https://dwiuzila.medium.com/list/mlops-megaproject-6a3bf86e45e4?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="xb l fo"><span class="bd b dl z dk">6 stories</span></div></div></div><div class="sc dh sd fp ab se fo di"><div class="di ru bv rv rw"><div class="dh l"><img alt="" class="dh" src="../Images/41b5d7dd3997969f3680648ada22fd7f.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*EBS8CP_UnStLesXoAvjeAQ.png"/></div></div><div class="di ru bv rx ry rz"><div class="dh l"><img alt="" class="dh" src="../Images/41befac52d90334c64eef7fc5c4b4bde.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*XLpRKnIMcJzBzCwvXrLvsw.png"/></div></div><div class="di bv sa sb rz"><div class="dh l"><img alt="" class="dh" src="../Images/80908ef475e97fbc42efe3fae0dfcff5.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*K_gzBmjv-ZHlU0Q6HeXclQ.jpeg"/></div></div></div></div></div><div class="oh oi gp gr oj"><div role="button" tabindex="0" class="ab bv gv cb fp rh ri bn rj lb ex"><div class="rk l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw rl rm fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l rl rm fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="rp rq gw l"><h2 class="bd jd wr pz fp ws fr fs oq fu fw jc bi translated">我最好的故事</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi wt au wu wv ww tj wx an eh ei wy wz xa el em eo de bk ep" href="https://dwiuzila.medium.com/list/my-best-stories-d8243ae80aa0?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="xb l fo"><span class="bd b dl z dk">24 stories</span></div></div></div><div class="sc dh sd fp ab se fo di"><div class="di ru bv rv rw"><div class="dh l"><img alt="" class="dh" src="../Images/0c862c3dee2d867d6996a970dd38360d.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*K1SQZ1rzr4cb-lSi"/></div></div><div class="di ru bv rx ry rz"><div class="dh l"><img alt="" class="dh" src="../Images/392d63d181090365a63dc9060573bcff.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*hSKy6kKorAfHjHOK"/></div></div><div class="di bv sa sb rz"><div class="dh l"><img alt="" class="dh" src="../Images/f51725806220b60eccf5d4c385c700e9.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*HiyGwoGOMI5Ao_fd"/></div></div></div></div></div><div class="oh oi gp gr oj"><div role="button" tabindex="0" class="ab bv gv cb fp rh ri bn rj lb ex"><div class="rk l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw rl rm fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l rl rm fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="rp rq gw l"><h2 class="bd jd wr pz fp ws fr fs oq fu fw jc bi translated">R中的数据科学</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi wt au wu wv ww tj wx an eh ei wy wz xa el em eo de bk ep" href="https://dwiuzila.medium.com/list/data-science-in-r-0a8179814b50?source=post_page-----202c07fb52a8--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="xb l fo"><span class="bd b dl z dk">7 stories</span></div></div></div><div class="sc dh sd fp ab se fo di"><div class="di ru bv rv rw"><div class="dh l"><img alt="" class="dh" src="../Images/e52e43bf7f22bfc0889cc794dcf734dd.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*10B3radiyQGAp-QA"/></div></div><div class="di ru bv rx ry rz"><div class="dh l"><img alt="" class="dh" src="../Images/945fa9100c2a00b46f8aca3d3975f288.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*o6A863Vdwq7ThlmW"/></div></div><div class="di bv sa sb rz"><div class="dh l"><img alt="" class="dh" src="../Images/3ca9e4b148297dbc4e7da0a180cf9c99.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*ekmX89TW6N8Bi8bL"/></div></div></div></div></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><a href="https://dwiuzila.medium.com/membership"><div class="gh gi si"><img src="../Images/f767019309a71e9b3b70d2f9b1016aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_dzEmnimgItuotIZ-y73A.png"/></div></a></figure></div></div>    
</body>
</html>