<html>
<head>
<title>Manipulating Values in Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理熊猫数据框中的值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/manipulating-values-in-pandas-dataframes-a84fe35a190?source=collection_archive---------24-----------------------#2021-08-28">https://towardsdatascience.com/manipulating-values-in-pandas-dataframes-a84fe35a190?source=collection_archive---------24-----------------------#2021-08-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="919d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">知道何时使用map()、apply()和applymap()</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9f2360d6915bcfd9c013dd3a21c5bec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vCaDer30Nv95IIgf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安妮·斯普拉特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0afc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据分析中的一个常见任务是处理数据帧中的值。对于那些熟悉熊猫的人来说，你知道通常你有三个函数可以使用——<strong class="lb iu">map()</strong>、<strong class="lb iu"> apply() </strong>和<strong class="lb iu"> applymap() </strong>。然而，通常不清楚什么时候应该使用哪一个，有时每个函数的工作原理都很混乱。</p><p id="9d06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章试图让你明白每个函数是如何工作的，以及什么时候你应该使用什么。</p><h1 id="ea61" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">各种功能的快速总结</h1><p id="114d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，让我们快速浏览一下每个功能的定义:</p><ul class=""><li id="5c7c" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><strong class="lb iu"> map() </strong> —对序列应用函数</li><li id="581c" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu"> apply() </strong> —将函数应用于序列或数据帧(沿两个轴中的一个)</li><li id="94bf" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu"> applymap() </strong> —对数据帧元素应用函数</li></ul><p id="13af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住它们如何工作的最好方法是使用下表来总结它们:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/7cf46e3cbe1bdffe2348b16b8b35451c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PnqmCWWVvdFVHNqW-ql4Qw.png"/></div></div></figure><p id="1316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，<strong class="lb iu"> map() </strong>函数仅适用于系列，<strong class="lb iu"> applymap() </strong>函数仅适用于数据帧，而<strong class="lb iu"> apply() </strong>函数可用于系列或数据帧。</p><p id="d249" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与其解释每个函数的用法，不如让我们通过陈述你试图解决的问题来解决这个问题。</p><h1 id="08d2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">修改单列值</h1><p id="1d97" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果您想修改数据帧中的一列值，使用<strong class="lb iu"> map() </strong>函数很容易做到。考虑以下AAPL数据集(<a class="ae ky" href="https://finance.yahoo.com/quote/AAPL/history/" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/quote/AAPL/history/</a>):</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="c9a1" class="nm lw it ni b gy nn no l np nq">import pandas as pd<br/>df = pd.read_csv('AAPL.csv')<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f72e10b97d7bb16bc9c5569c9d3e9bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*uzX-xqa2VQzzAa71Q787gA.png"/></div></figure><p id="13f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您想要重新格式化日期，使其现在以下列格式显示:</p><p id="30eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ns nt nu ni b">Dec 24, 2018 (Mon)</code></p><p id="7c85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一种简单的方法是将<strong class="lb iu">日期</strong>列作为一个序列，然后对其使用<strong class="lb iu"> map() </strong>函数。以下代码片段将<strong class="lb iu">日期</strong>值转换为我们想要的格式:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="b91a" class="nm lw it ni b gy nn no l np nq">from datetime import datetime</span><span id="b126" class="nm lw it ni b gy nv no l np nq">def format_date(x):<br/>    return datetime.strptime(x, '%Y-%m-%d').strftime(<br/>        '%b %d, %Y (%a)')</span><span id="9477" class="nm lw it ni b gy nv no l np nq">df = pd.read_csv('AAPL.csv')</span><span id="9b3e" class="nm lw it ni b gy nv no l np nq">df['Date'] = <strong class="ni iu">df['Date'].map(format_date)</strong><br/>df</span></pre><p id="3f25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<strong class="lb iu"> format_date() </strong>函数中，参数<strong class="lb iu"> x </strong>是字符串类型(<strong class="lb iu">日期</strong>列的每个值)。例如“<em class="nw">2018–12–24</em>”)。为了转换成我们想要的日期格式，我首先使用<strong class="lb iu"> strptime() </strong>将给定的字符串转换成一个<strong class="lb iu"> datetime </strong>对象，然后使用<strong class="lb iu"> strftime() </strong>函数将<strong class="lb iu"> datetime </strong>对象转换成想要的字符串格式。然后使用<strong class="lb iu"> map() </strong>函数(这是一个序列)的结果来更新<strong class="lb iu">日期</strong>列。</p><p id="de8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更新后的数据帧现在如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/665fadb7850f3950d4e3fad00f9b5210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*QBAIcJMz5MAvOPZTTAPPcA.png"/></div></figure><p id="a641" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以使用<strong class="lb iu"> apply() </strong>函数达到同样的目的，因为它也适用于序列。以下代码片段显示了如何使用<strong class="lb iu"> apply() </strong>函数实现上述步骤:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="6440" class="nm lw it ni b gy nn no l np nq">df = pd.read_csv('AAPL.csv')<br/>df['Date'] = <strong class="ni iu">df['Date'].apply(format_date)   </strong><br/>df</span></pre><h1 id="e2a5" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">修改数据帧中的多列值</h1><p id="fec3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">假设现在除了更改日期格式之外，您还需要将<strong class="lb iu"> Close </strong>列中的值向下舍入到两位小数。在这种情况下，使用<strong class="lb iu"> apply() </strong>函数会很有用，因为它适用于数据帧。</p><p id="df9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下代码片段显示了如何修改<strong class="lb iu">日期</strong>列中值的日期格式，以及如何对<strong class="lb iu">结束</strong>列执行舍入:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="045a" class="nm lw it ni b gy nn no l np nq">from datetime import datetime</span><span id="981b" class="nm lw it ni b gy nv no l np nq">def format_date2(x): <br/>    x['Date'] = datetime.strptime(<br/>        x['Date'], '%Y-%m-%d').strftime('%b %d, %Y (%a)')<br/>    x['Close'] = round(x['Close'],2)<br/>    return x</span><span id="23fc" class="nm lw it ni b gy nv no l np nq">df = pd.read_csv('AAPL.csv')<br/>df = <strong class="ni iu">df.apply(format_date2, axis=1)</strong>   <br/>df</span></pre><p id="4a89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次，您在数据帧上使用<strong class="lb iu"> apply() </strong>函数。在<strong class="lb iu"> format_date2() </strong>函数中，参数<strong class="lb iu"> x </strong>现在将是一个序列(包含每一行，因为我们指定了<strong class="lb iu"> axis=1 </strong>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/a9d62eeac3e2e56f61636191e8b85951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9yP_L3mQjpM0YoZJY4gIAA.png"/></div></div></figure><p id="62d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在该函数中，我们首先修改<strong class="lb iu">日期</strong>值，然后对<strong class="lb iu">收盘</strong>值进行舍入。结果将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/5e0d425f7ad0b4387ae8c55dc4da76c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*H9fdTSkovbGm1le2QgbvTA.png"/></div></figure><blockquote class="oa ob oc"><p id="49fa" class="kz la nw lb b lc ld ju le lf lg jx lh od lj lk ll oe ln lo lp of lr ls lt lu im bi translated">在数据帧上使用<strong class="lb iu"> apply() </strong>功能时，可以指定<strong class="lb iu">轴</strong>参数(0或1)。但是，当您在系列上使用<strong class="lb iu"> apply() </strong>功能时，不支持<strong class="lb iu">轴</strong>参数。</p></blockquote><p id="e0ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您在<strong class="lb iu">轴</strong>设置为1的数据帧上使用<strong class="lb iu"> apply() </strong>函数时，您可以将其视为遍历数据帧中的每一行，然后将所有<strong class="lb iu"> <em class="nw">列</em> </strong>作为一个序列，如下图所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/8c4f653f076c620a616037d8a783b3a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lqQGtcqxO0dqj9ENlkIGMw.png"/></div></div></figure><p id="a182" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，如果将<strong class="lb iu">轴</strong>指定为0，它现在将遍历数据帧中的每一列，然后将所有<strong class="lb iu"> <em class="nw">行</em> </strong>作为一个序列，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/0018961f3666c165db2fb6ec83b47320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*TKn6SSst5LhagJzWp3THaQ.png"/></div></div></figure><h1 id="38bc" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">组合数据帧中的列</h1><p id="12d1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这里是另一个数据集，我将使用它来说明在数据帧上使用<strong class="lb iu"> apply() </strong>函数。这次我将使用来自http://www.weather.gov.sg/climate-historical-daily/<a class="ae ky" href="http://www.weather.gov.sg/climate-historical-daily/" rel="noopener ugc nofollow" target="_blank">的降雨数据集。</a></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="d924" class="nm lw it ni b gy nn no l np nq">df = pd.read_csv('DAILYDATA_S24_202107.csv')<br/>df</span></pre><p id="f271" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据帧看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/e2935cdeaa2d3df4e82480be302b2bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KaxYrBCWMJC_tDlQJbzksQ.png"/></div></div></figure><p id="67f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集包含新加坡2021年7月31天每天的降雨量(以及温度和风速等其他要素)。</p><p id="6029" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我想将三个独立的列— <strong class="lb iu">年</strong>、<strong class="lb iu">月</strong>和<strong class="lb iu">日</strong>合并成一个列— <strong class="lb iu">日</strong>。这是使用<strong class="lb iu"> apply() </strong>函数的好时机:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="83d1" class="nm lw it ni b gy nn no l np nq">import datetime</span><span id="6a08" class="nm lw it ni b gy nv no l np nq">df['Date'] = <strong class="ni iu">df[['Year','Month','Day']].apply(<br/>    lambda x: datetime.date(                    </strong># x is a series<strong class="ni iu"><br/>        int(x['Year']),<br/>        int(x['Month']),<br/>        int(x['Day'])), <br/>    axis=1)</strong><br/>df</span></pre><p id="a9dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您首先提取想要作为数据帧的三列(<strong class="lb iu">年</strong>、<strong class="lb iu">月</strong>和<strong class="lb iu">日</strong>)，然后对其使用<strong class="lb iu"> apply() </strong>函数。当您指定<strong class="lb iu"> axis=1 </strong>时，dataframe的每一行(包含三列— <strong class="lb iu">年</strong>、<strong class="lb iu">月</strong>和<strong class="lb iu">日</strong>)将作为一个序列(<strong class="lb iu"> x </strong>)传递给lambda函数。现在，您可以使用序列中的值来创建一个<strong class="lb iu"> datetime.date </strong>对象。现在在数据帧中创建了一个新列(<strong class="lb iu"> Date </strong>)，用于存储新创建的<strong class="lb iu"> datetime.date </strong>对象(数据帧中的最后一列):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/fd0dd7e7430ac8469bd8ccd0507f091a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cm8AXXR9AUmlnMuKaiXrnA.png"/></div></div></figure><h1 id="1fc2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">列或行值的聚合</h1><p id="2103" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">有时需要聚合数据帧中特定列的值。例如，使用降雨量数据集，您可能想要计算该月的平均日降雨量。在这种情况下，您可以使用<strong class="lb iu"> apply() </strong>功能，将<strong class="lb iu">轴</strong>参数设置为0:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="38e4" class="nm lw it ni b gy nn no l np nq">df[['Daily Rainfall Total (mm)']].apply(lambda x: x.mean(),<br/>    axis=0)</span></pre><p id="36dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您为<strong class="lb iu"> apply() </strong>函数指定<strong class="lb iu"> axis=0 </strong>(或者省略它，因为这是默认值)时，dataframe中的每一列都将作为一个序列传递给lambda函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/c0de76837b2dd7fa996bb9be9723a75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*vVuGxf5Eix-5fX7cUpUamQ.png"/></div></figure><p id="47ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您想获得整个月的平均降雨量和平均温度。您可以首先提取降雨量和温度这两列，然后使用<strong class="lb iu"> apply() </strong>函数:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="95d3" class="nm lw it ni b gy nn no l np nq">df = pd.read_csv('DAILYDATA_S24_202107.csv')</span><span id="098e" class="nm lw it ni b gy nv no l np nq"><strong class="ni iu">df[['Daily Rainfall Total (mm)','Mean Temperature (°C)']].apply(<br/>    lambda x: x.mean()</strong>,<br/>    axis=0)</span></pre><p id="4f23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果将是一系列:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="5e20" class="nm lw it ni b gy nn no l np nq">Daily Rainfall Total (mm)     6.316129<br/>Mean Temperature (°C)        28.619355<br/>dtype: float64</span></pre><p id="3518" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想计算降雨量的平均值和温度的中值呢？在这种情况下，您可以使用序列的<strong class="lb iu">名称</strong>属性来标识每一列。以下示例向您展示了如何操作:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="5178" class="nm lw it ni b gy nn no l np nq">def aggregate_columns(x):<br/>    if <strong class="ni iu">x.name</strong> =='Daily Rainfall Total (mm)':<br/>        return x.mean()<br/>    if <strong class="ni iu">x.name</strong>=='Mean Temperature (°C)':<br/>        return x.median()<br/>    <br/><strong class="ni iu">df[['Daily Rainfall Total (mm)','Mean Temperature (°C)']].apply(<br/>    aggregate_columns,<br/>    axis=0)</strong></span></pre><p id="8bde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果将如下所示:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="f702" class="nm lw it ni b gy nn no l np nq">Daily Rainfall Total (mm)     6.316129<br/>Mean Temperature (°C)        <strong class="ni iu">29.200000</strong><br/>dtype: float64</span></pre><h1 id="cf37" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">变换数据帧中的元素</h1><p id="b6c6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">到目前为止，我们的讨论一直集中在对数据帧执行按行或按列的操作上。然而，有些时候你并不真正关心你的值被计算的顺序，只要它们被计算。我们之前使用的AAPL数据集就是一个很好的例子。假设您需要将<strong class="lb iu">打开</strong>、<strong class="lb iu">高</strong>、<strong class="lb iu">低</strong>、<strong class="lb iu">关闭</strong>和<strong class="lb iu">调整关闭</strong>列中的所有数字四舍五入到两位小数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/809f5a537769b09589d42c641651a229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kNSSysU6NMDjtKGumnomoA.png"/></div></figure><p id="c89a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们是按行还是按列处理它们有关系吗？没有。只要能四舍五入到小数点后两位，我们就很高兴了。这是一个使用<strong class="lb iu"> applymap() </strong>函数的完美例子。<strong class="lb iu"> applymap() </strong>函数将遍历数据帧中的每个元素，并执行指定的功能。以下代码片段显示了这是如何实现的:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="f3db" class="nm lw it ni b gy nn no l np nq">df = pd.read_csv('AAPL.csv')<br/><strong class="ni iu">df[['Open','High','Low','Close','Adj Close']] = \<br/>    df[['Open','High','Low','Close','Adj Close']].applymap(<br/>        lambda x: round(x,2))   </strong><br/>df</span></pre><p id="3e14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所选数据帧中的每个元素都将作为参数传递给lambda函数。</p><p id="5e3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">指定列中的值现在四舍五入到两位小数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/7a4614e9ae8a82bd640771d3d6f3bdf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*fjnjXcQCSsvb2kj6ONAeig.png"/></div></figure><h1 id="2bb2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="00f9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我希望这篇文章已经让您清楚地决定了什么时候应该使用<strong class="lb iu"> map() </strong>、<strong class="lb iu"> apply() </strong>或<strong class="lb iu"> applymap() </strong>函数。总而言之:</p><ul class=""><li id="e067" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">如果你想修改数据帧中的一列，使用<strong class="lb iu"> map() </strong></li><li id="e5d5" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">如果你想一次修改数据帧中的几列，使用<strong class="lb iu"> apply() </strong></li><li id="39f5" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">如果想对数据帧中的列或行执行聚合函数，使用<strong class="lb iu"> apply() </strong></li><li id="8308" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">如果您想修改数据帧中的值，而不用担心是按行还是按列执行，请使用<strong class="lb iu"> applymap() </strong></li></ul></div></div>    
</body>
</html>