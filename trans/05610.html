<html>
<head>
<title>Giving Vertex AI, the New Unified ML Platform on Google Cloud, a Spin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">给谷歌云上新的统一ML平台Vertex AI一个旋转</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/giving-vertex-ai-the-new-unified-ml-platform-on-google-cloud-a-spin-35e0f3852f25?source=collection_archive---------2-----------------------#2021-05-19">https://towardsdatascience.com/giving-vertex-ai-the-new-unified-ml-platform-on-google-cloud-a-spin-35e0f3852f25?source=collection_archive---------2-----------------------#2021-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7089" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们为什么需要它，无代码ML培训到底有多好，以及所有这些对数据科学工作意味着什么？</h2></div><p id="1493" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">过去几个月，谷歌云人工智能平台团队一直在构建机器学习前景的统一视图。这是<a class="ae lb" href="https://techcrunch.com/2021/05/18/google-cloud-launches-vertex-a-new-managed-machine-learning-platform/" rel="noopener ugc nofollow" target="_blank">今天在谷歌I/O发布的顶点人工智能</a>。这是什么？有多好？对数据科学工作来说意味着什么？</p><h2 id="ca67" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">有什么好统一的？</h2><p id="ce86" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">这个想法是机器学习中有几个关键的结构:</p><ul class=""><li id="139b" class="ma mb iq kh b ki kj kl km ko mc ks md kw me la mf mg mh mi bi translated">我们通过接收数据、分析数据和清理数据(ETL或ELT)来创建数据集。</li><li id="fea0" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">然后我们训练一个模型(模型训练)——这包括实验、假设检验和超参数调整。</li><li id="d10a" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">当有新数据时，在计划中，或者当代码改变时，该模型被版本化和重建(ML Ops)。</li><li id="4b36" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">对模型进行评估，并与现有模型版本进行比较。</li><li id="d721" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">该模型被部署并用于在线和批量预测。</li></ul><p id="73f5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，这取决于您如何进行ETL(您是否将数据存储在CSV文件中？TensorFlow记录？JPEG文件？在云存储中？在BigQuery？)，剩下的管道就变得很不一样了。有一个ML数据集的想法不是很好吗？任何下游模型(TensorFlow，sklearn，PyTorch)都可以使用的？这就是统一数据集概念背后的含义。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mo"><img src="../Images/f1c846c00ef356efa1ba88c56772accc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*euQEeEQksTscSaw1vbXs7Q.png"/></div></div><p class="na nb gj gh gi nc nd bd b be z dk translated">Vertex AI为ML生命周期提供了一套统一的API。图表由亨利·塔彭和布莱恩·科巴什卡瓦提供</p></figure><p id="21b4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，部署TensorFlow模型的方式不同于部署PyTorch模型的方式，甚至TensorFlow模型也可能因使用AutoML还是通过代码创建而有所不同。在Vertex AI提供的一组统一的API中，你可以用同样的方式对待所有这些模型。</p><p id="92b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vertex AI提供了四个概念的统一定义/实现:</p><ul class=""><li id="d48f" class="ma mb iq kh b ki kj kl km ko mc ks md kw me la mf mg mh mi bi translated">一个<strong class="kh ir">数据集</strong>可以是结构化的，也可以是非结构化的。它管理包括注释在内的元数据，可以存储在GCP的任何地方。认识到这是远景——目前只支持云存储和BigQuery。还不是Bigtable或Pub/Sub。</li><li id="0d63" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated"><strong class="kh ir">训练管道</strong>是一系列容器化的步骤，可用于使用数据集训练ML模型。容器化有助于通用性、可再现性和可审计性。</li><li id="bce8" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">一个<strong class="kh ir">模型</strong>是一个带有元数据的ML模型，它是用训练管道构建的或者是直接加载的(只要它是兼容的格式)。</li><li id="f934" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">用户可以调用<strong class="kh ir">端点</strong>进行在线预测和解释。它可以有一个或多个模型，以及这些模型的一个或多个版本，并根据请求进行消歧。</li></ul><p id="a400" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关键的想法是，无论数据集、训练管道、模型或端点的类型如何，这些工件都是相同的。都是混搭。因此，一旦创建了数据集，就可以将其用于不同的模型。无论你如何训练你的模型，你都可以从一个端点获得可解释的人工智能。</p><p id="f220" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一点在web用户界面上显而易见:</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ne"><img src="../Images/7b1148e253b094288b8f6ae5c99fff77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fvbqfQyDaAlnT4Wttz2Mpw.png"/></div></div></figure><p id="0010" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了，说够了为什么。让我们兜一圈。</p><h2 id="47c6" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">带BigQuery的SQL中的ML</h2><p id="8fe4" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">当你使用新技术训练一个ML模型，并将其与你知道和理解的东西进行比较时，这总是好的。</p><p id="afb9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将使用Kaggle 上的Airbnb纽约市<a class="ae lb" href="https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data" rel="noopener ugc nofollow" target="_blank">数据集来预测公寓租金的价格。</a></p><p id="0856" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将数据加载到BigQuery中。这个数据集有点笨拙，在我将它加载到BigQuery之前需要清理(详情见<a class="ae lb" href="https://cloud.google.com/blog/topics/developers-practitioners/loading-complex-csv-files-bigquery-using-google-sheets" rel="noopener ugc nofollow" target="_blank">的博文</a>)，但是我将它公之于众，所以你可以简单地尝试一下这个查询:</p><pre class="mp mq mr ms gt nf ng nh ni aw nj bi"><span id="7745" class="lc ld iq ng b gy nk nl l nm nn">SELECT <br/>neighbourhood_group, neighbourhood, latitude, longitude, room_type, price, minimum_nights, number_of_reviews, reviews_per_month, calculated_host_listings_count, availability_365<br/>FROM `ai-analytics-solutions.publicdata.airbnb_nyc_2019`<br/>LIMIT 100</span></pre><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi no"><img src="../Images/3bc1a8053cb3c2b9f22c7734ed061d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wYSKYkUNx0mF29VOg-BGNA.png"/></div></div></figure><p id="76c1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">已经验证了数据现在看起来是合理的，让我们继续训练一个xgboost模型来预测价格。这就像添加两行SQL代码一样简单:</p><pre class="mp mq mr ms gt nf ng nh ni aw nj bi"><span id="a3ed" class="lc ld iq ng b gy nk nl l nm nn">CREATE OR REPLACE MODEL advdata.airbnb_xgboost<br/>OPTIONS(<strong class="ng ir">model_type='boosted_tree_regressor', input_label_cols=['price']</strong>) AS</span><span id="7df3" class="lc ld iq ng b gy np nl l nm nn">SELECT <br/>neighbourhood_group, neighbourhood, latitude, longitude, room_type, price, minimum_nights, number_of_reviews, reviews_per_month, calculated_host_listings_count, availability_365<br/>FROM `ai-analytics-solutions.publicdata.airbnb_nyc_2019`</span></pre><p id="f863" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到一个快速收敛的模型</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7c13049d7131b6dd0ea7a7c95a84b0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*q-AjpT367QQqBPFrdTllVA.png"/></div></figure><p id="c966" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">…平均绝对误差为64.88美元。</p><p id="054c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这有多好？Airbnb上纽约市公寓的均价是多少？</p><pre class="mp mq mr ms gt nf ng nh ni aw nj bi"><span id="7e16" class="lc ld iq ng b gy nk nl l nm nn">SELECT <br/>AVG(price)<br/>FROM `ai-analytics-solutions.publicdata.airbnb_nyc_2019`</span></pre><p id="472b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一共是153美元。所以，我们有40%的折扣。也许不是一个投入生产的模型…但你不会期望一个公共数据集有更多的专有和个性化的数据来帮助改善这些预测。不过，这些数据的可用性有助于我们了解如何训练ML模型来预测价格。</p><p id="2e02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们来试试Vertex AI中的Auto ML表格。</p><h2 id="2c11" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">顶点人工智能</h2><p id="3e0c" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">让我们从Kaggle上的CSV文件开始，这样我们就不会被我将数据加载到BigQuery时所做的数据转换所困扰。转到<a class="ae lb" href="https://console.cloud.google.com/vertex-ai/datasets/create" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/vertex-ai/datasets/create</a></p><ul class=""><li id="4158" class="ma mb iq kh b ki kj kl km ko mc ks md kw me la mf mg mh mi bi translated">将其命名为airbnb_raw，选择<strong class="kh ir">表格</strong>、<strong class="kh ir">回归</strong>，选择<strong class="kh ir">爱荷华</strong>地区，点击<strong class="kh ir">创建</strong></li><li id="79be" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">创建数据集后，从GCS中选择CSV文件，提供URL:GS://data-science-on-GCP/Airbnb _ NYC _ 2019 . CSV，然后点击<strong class="kh ir">继续</strong>。</li><li id="d02a" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">Vertex AI愉快地加载数据，没有任何限制，拉出标题并显示16列。</li><li id="d0be" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">单击Generate Statistics，它会向您显示在缺少值方面唯一可能有问题的字段是review字段。但这是有道理的:不是每个BnB航空公司的客人都会留下评论。</li></ul><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nr"><img src="../Images/b9845ef281fb50fbf455da9104378899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dwU4_0F1s6jDGKW6"/></div></div></figure><ul class=""><li id="2033" class="ma mb iq kh b ki kj kl km ko mc ks md kw me la mf mg mh mi bi translated">现在选择训练新模型并选择回归和自动:</li></ul><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ns"><img src="../Images/1e7f2aa8751b15db708f0dccdb86ca2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DuEluHB7z6X-vzeq6PjSfw.png"/></div></div></figure><ul class=""><li id="2db5" class="ma mb iq kh b ki kj kl km ko mc ks md kw me la mf mg mh mi bi translated">再次注意，我们可以提供自己的定制代码，并且仍然保留在整个工作流中。我们不必仅仅因为想要定制流程的一部分就放弃自动化培训管道。</li><li id="2345" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">在下一个窗格中，选择price作为要预测的目标列:</li></ul><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nt"><img src="../Images/2e8a2668559567d18da07bb5ac4d1fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnoZYKJ9MXBobEQa7V8GKQ.png"/></div></div></figure><ul class=""><li id="f522" class="ma mb iq kh b ki kj kl km ko mc ks md kw me la mf mg mh mi bi translated">在下一个窗格中，从预测值集中删除id列。将邻域更改为分类(来自文本)，并将目标更改为MAE。</li><li id="ad57" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la mf mg mh mi bi translated">给它3个小时的预算，开始训练。</li></ul><p id="500f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大约3小时后，培训结束，我们可以检查模型并根据需要进行部署:</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nu"><img src="../Images/61b7fa962c223aa0b6fa24be51b80869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QjFjgW67UyiJuDc0ZYuZBA.png"/></div></div></figure><p id="f434" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到的平均绝对误差为55美元，比使用xgboost得到的误差几乎高出20%。所以，一个更精确的模型，用更少的代码。包括评估、特性重要性、可解释性、部署等。所有这些都是现成的。</p><h2 id="f9fd" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">最底层的</h2><p id="6aa2" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">BigQuery ML和AutoML表都易于使用并且非常好。它有助于理解领域的基础知识(为什么没有评论？)，以及机器学习的(不要用id列做输入！)，但从一个公民数据科学家的角度来看，他们相当平易近人。编码和基础设施管理开销几乎完全消除了。</p><p id="ba51" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这对数据科学工作来说意味着什么？从编写原始HTML到使用weebly/wix/etc的转变。并不意味着网络开发人员的工作会减少。相反，这意味着更多的人创建网站。当每个人都有一个基本的网站时，它驱动了一种差异化的需求，以建立更好的网站，因此为网络开发人员提供了更多的工作。</p><p id="bc98" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">机器学习的民主化也会导致同样的效果。随着越来越多的事情变得容易，将会有越来越多的机器学习模型被构建和部署。这将推动差异化的需求，并建立超越和解决日益复杂的任务的ML模型管道(例如，不只是估计租赁价格，而是进行动态定价)。</p><p id="ed63" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">机器学习的民主化将导致更多的机器学习，以及更多的ML开发者的工作，而不是更少。这是一件好事，我为此感到兴奋。</p><p id="0aad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有，哦，Vertex AI真的很好看。在你的ML问题上尝试一下，让我知道(你可以在Twitter上@lak_gcp找到我)效果如何！</p><h1 id="91f5" class="nv ld iq bd le nw nx ny lh nz oa ob lk jw oc jx ln jz od ka lq kc oe kd lt of bi translated">更多关于Vertex AI的阅读:</h1><ol class=""><li id="f4a8" class="ma mb iq kh b ki lv kl lw ko og ks oh kw oi la oj mg mh mi bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/giving-vertex-ai-the-new-unified-ml-platform-on-google-cloud-a-spin-35e0f3852f25">给谷歌云上的新统一ML平台Vertex AI一个旋转</a> : <br/>我们为什么需要它，无代码ML培训到底有多好，所有这些对数据科学工作意味着什么？</li><li id="d69b" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la oj mg mh mi bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/how-to-deploy-a-tensorflow-model-to-vertex-ai-87d9ae1df56">如何将TensorFlow模型部署到Vertex AI </a>:在Vertex AI中使用保存的模型和端点</li><li id="8ba2" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la oj mg mh mi bi translated"><a class="ae lb" href="https://medium.com/@lakshmanok/developing-and-deploying-a-machine-learning-model-on-vertex-ai-using-python-865b535814f8" rel="noopener">使用Python在Vertex AI上开发和部署机器学习模型</a>:编写让你的MLOps团队满意的训练管道</li><li id="2169" class="ma mb iq kh b ki mj kl mk ko ml ks mm kw mn la oj mg mh mi bi translated"><a class="ae lb" href="https://lakshmanok.medium.com/how-to-build-an-mlops-pipeline-for-hyperparameter-tuning-in-vertex-ai-45cc2faf4ff5" rel="noopener">如何在Vertex AI中为超参数调整构建MLOps管道</a> : <br/>为超参数调整设置模型和协调器的最佳实践</li></ol></div></div>    
</body>
</html>