<html>
<head>
<title>Simple steps to create custom colormaps in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python创建自定义色彩映射表的简单步骤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-steps-to-create-custom-colormaps-in-python-f21482778aa2?source=collection_archive---------5-----------------------#2021-10-25">https://towardsdatascience.com/simple-steps-to-create-custom-colormaps-in-python-f21482778aa2?source=collection_archive---------5-----------------------#2021-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="726e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">随心所欲地创造任何色彩</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a45c704cc798b0b61a2eaf803a6da709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0buEx5t7EmCUfxQD"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Pawel Czerwinski 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a025" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您发现了一个其他人在出版物中使用的漂亮的色彩映射表，并且您也想在您的结果中使用它。然而，遗憾的是，它并不是matplotlib中内置的colormap。周围有解决的办法吗？</p><p id="6414" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以今天我将向你展示我通常是如何通过创建基于任何图像的自定义色彩映射表来解决这个问题的。</p><p id="ccd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">包装器函数的Github存储库可以在:<a class="ae kv" href="https://github.com/frankligy/scTriangulate/blob/main/image/colors_module/README.md" rel="noopener ugc nofollow" target="_blank">https://Github . com/frank ligy/sc triangulate/blob/main/image/colors _ module/readme . MD</a>找到</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="8338" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在这张<a class="ae kv" href="https://www.cell.com/cell/fulltext/S0092-8674(21)01105-3" rel="noopener ugc nofollow" target="_blank">细胞纸</a>中遇到了一个好看的色彩图，在他们的<a class="ae kv" href="https://els-jbs-prod-cdn.jbs.elsevierhealth.com/cms/attachment/6a494f50-66f9-4e9d-955d-8c7021c24a3b/gr4_lrg.jpg" rel="noopener ugc nofollow" target="_blank">图4，面板K </a>中，有一个彩虹般的色彩图，它显示了很大的对比度，在视觉上也很有吸引力。我们需要做的第一步是截取这个色图的截图，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lz"><img src="../Images/dbdc6fb3e13a111b81d99b0252830ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4cbeppEjJT23D-0PiBz3FQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们想要创建的示例色彩映射表(图片由作者提供)</p></figure><p id="6a09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，它似乎有5个不同的颜色补丁，每个补丁内也有一个梯度。为了用python再现这个色彩映射表，我们首先需要知道一些锚点的颜色，我们提供的锚点越多，我们的色彩映射表看起来就越接近原始色彩映射表。为了提取锚点的颜色，我们使用了免费的web应用程序<a class="ae kv" href="https://color.adobe.com/create/image-gradient" rel="noopener ugc nofollow" target="_blank"> adobe颜色渐变</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/fe4a7ce382b01f0a59dff58acf6b66a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__v1uv7vydQ3YUFjZ75WrQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">上传截图后，我们提取了6个锚点的RGB值(图片由作者提供)</p></figure><p id="5d5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该应用程序要求我们上传截图，然后您可以提取任意数量锚点的RGB颜色(用0-255之间的值表示)。这里我们选择6，因为我们假设有5个不同的颜色补丁。</p><p id="f487" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在红框中突出显示的RGB值将帮助我们在接下来的步骤中创建自定义色彩映射表。</p><p id="09fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">乍一看，在matplotlib中构建自定义色彩映射表的逻辑有点混乱，它要求我们首先创建一个包含<code class="fe mb mc md me b">red</code>、<code class="fe mb mc md me b">green</code>和<code class="fe mb mc md me b">blue</code>通道动态变化规范的<code class="fe mb mc md me b">cdict</code>字典。用一个更简单的例子来解释语法:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mf"><img src="../Images/3d5caf64934d7f4c4eeb625cf4e2870f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ngaFsVJ35BXZeMlnIfhAw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">理解cdict的语法(图片由作者提供)</p></figure><p id="8cc2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和上面的例子一样，我们指导程序如何在从0到1的连续统上线性插值R、G和B通道。关键的概念是选择断点，在断点处我们表达颜色通道的强度。另一个令人困惑的地方是我们需要输入两个值，一个是断点左边的强度，另一个是右边的强度。在一个简单的情况下，比如我刚才展示的例子，对左右两边使用相同的亮度是完全没问题的。对于更详细的操作，我们可以让他们不同的理想效果。记住这一点，我们终于可以开始我们的旅程了！</p><p id="47b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一步是安装和加载必要的软件包:</p><pre class="kg kh ki kj gt mg me mh mi aw mj bi"><span id="52a9" class="mk ml iq me b gy mm mn l mo mp">from matplotlib import colors<br/>import numpy as np<br/>import os<br/>import matplotlib.pyplot as plt<br/>from matplotlib import cm</span></pre><p id="4e4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们首先构建如上所示的<code class="fe mb mc md me b">cdict</code>，这里我们定义一个函数<code class="fe mb mc md me b">inter_from_256() </code>来将Adobe输出值(0–255)转换为range (0，1)。</p><pre class="kg kh ki kj gt mg me mh mi aw mj bi"><span id="d4cf" class="mk ml iq me b gy mm mn l mo mp">def inter_from_256(x):<br/>    return np.interp(x=x,xp=[0,255],fp=[0,1])</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="79ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在可以实例化自定义色彩映射表对象了:</p><pre class="kg kh ki kj gt mg me mh mi aw mj bi"><span id="3eee" class="mk ml iq me b gy mm mn l mo mp">new_cmap = colors.LinearSegmentedColormap('new_cmap',segmentdata=cdict)</span></pre><p id="8eeb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以通过使用自定义颜色图生成颜色条来测试它:</p><pre class="kg kh ki kj gt mg me mh mi aw mj bi"><span id="318a" class="mk ml iq me b gy mm mn l mo mp">fig,ax = plt.subplots()<br/>fig.colorbar(cm.ScalarMappable(norm=colors.Normalize(),cmap=new_cmap),ax=ax)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/c18b83b1b3a256d9da538a5f2932dcfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccfsOWn-MFxmir67IhgVmQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们的自定义彩色地图(图片由作者提供)</p></figure><h1 id="d005" class="mt ml iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">全程一行代码？</h1><p id="c229" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">当我几个月前第一次遇到这个问题时，我发现为新的色彩映射表重复这个过程几次是很痛苦的。所以我开始在我开发的一个名为<a class="ae kv" href="https://github.com/frankligy/scTriangulate" rel="noopener ugc nofollow" target="_blank"> scTriangulate </a>的python包中编写一个名为<a class="ae kv" href="https://github.com/frankligy/scTriangulate/blob/main/image/colors_module/README.md" rel="noopener ugc nofollow" target="_blank">“colors”</a>的模块。让我们使用<a class="ae kv" href="https://github.com/frankligy/scTriangulate/blob/main/image/colors_module/README.md" rel="noopener ugc nofollow" target="_blank">颜色</a>模块中非常方便的函数<code class="fe mb mc md me b">build_custom_continuous_cmap</code>将整个过程简化为一行代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="93e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，我们只需将adobe web应用程序中的所有RGB值传递给该函数，不再需要担心底层流程。</p><p id="d7bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们再测试一次:</p><pre class="kg kh ki kj gt mg me mh mi aw mj bi"><span id="050b" class="mk ml iq me b gy mm mn l mo mp">fig,ax = plt.subplots()<br/>fig.colorbar(cm.ScalarMappable(norm=colors.Normalize(),cmap=new_cmap),ax=ax)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/c18b83b1b3a256d9da538a5f2932dcfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccfsOWn-MFxmir67IhgVmQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">可以得到同样的结果(图片由作者提供)</p></figure><h1 id="5f1c" class="mt ml iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">结论</h1><p id="3543" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">结束了，我希望这个简短的教程对你的情况有所帮助。此外，我想向您推荐<a class="ae kv" href="https://github.com/frankligy/scTriangulate/blob/main/image/colors_module/README.md" rel="noopener ugc nofollow" target="_blank"> scTriangulate.colors </a>模块，以获得更方便的python可视化功能。我写这篇教程的部分原因也是为了获得您的宝贵反馈，了解您希望在python中简化哪些繁琐的绘图过程？如果您有任何功能要求，请让我知道，以便我可以实现它们并将其添加到<a class="ae kv" href="https://github.com/frankligy/scTriangulate/blob/main/image/colors_module/README.md" rel="noopener ugc nofollow" target="_blank"> scTriangulate.colors </a>模块中，以使其他用户受益。</p><p id="c4ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">差不多就是这样！我希望你觉得这篇文章有趣和有用，感谢阅读！如果你喜欢这篇文章，请在medium上关注我，非常感谢你的支持。在我的<a class="ae kv" href="https://twitter.com/FrankLI55917967" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae kv" href="https://www.linkedin.com/in/guangyuan-li-399617173/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我，也请让我知道你是否有任何问题或你希望在未来看到什么样的教程！</p></div></div>    
</body>
</html>