<html>
<head>
<title>Take Full Control Over the Subplots in Matplotlib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">完全控制Matplotlib中的支线剧情</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/take-full-control-over-the-subplots-in-matplotlib-71b3bc11ff0b?source=collection_archive---------37-----------------------#2021-03-22">https://towardsdatascience.com/take-full-control-over-the-subplots-in-matplotlib-71b3bc11ff0b?source=collection_archive---------37-----------------------#2021-03-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/95739e74abe201ef7929a0ee16e14b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g99k9ZuVTGPqNASV"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/@tengyart?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">腾雅特</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="2380" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使用支线剧情和GridSpec一起更好地控制</h2></div><p id="87b7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用支线剧情，将多个情节放在一个图中，对于在一个小空间里总结大量信息非常有用。他们有助于做报告或演示。本文将关注如何有效地使用支线剧情并对网格进行精细的控制。</p><p id="769e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将从基本的子图函数开始，首先制作大小相等的图。让我们进行必要的导入:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="185b" class="md me jj lz b gy mf mg l mh mi">%matplotlib inline</span><span id="d7ab" class="md me jj lz b gy mj mg l mh mi">import matplotlib.pyplot as plt <br/>import numpy as np <br/>import pandas as pd</span></pre><p id="2e5c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是Matplotlib中的基本subplots函数，它生成两行三列大小相等的矩形空间:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="cbdb" class="md me jj lz b gy mf mg l mh mi">fig, ax = plt.subplots(2, 3, sharex = 'col', sharey = 'row', figsize = (9, 6))<br/>fig.tight_layout(pad =3.0)</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/e70e6a3e4758ecd21d861f2f3d914fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*oE29hl4c7EvPhBCVkxL3zw.png"/></div></figure><p id="bc28" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“sharex”参数使同一列中的图具有相同的x轴，将“sharey”参数设置为“row”使同一行中的图共享相同的y轴。这就是为什么只有外层有x轴和y轴的值。共享轴心有利也有弊。我们以后再谈。</p><blockquote class="ml mm mn"><p id="b60d" class="ky kz mo la b lb lc kk ld le lf kn lg mp li lj lk mq lm ln lo mr lq lr ls lt im bi translated"><strong class="la jk">如何访问这个数组中的一个图？</strong></p></blockquote><p id="7b45" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些矩形存储在一个二维数组中。让我们把“斧头”打印出来:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="3685" class="md me jj lz b gy mf mg l mh mi">ax</span></pre><p id="2583" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="0d99" class="md me jj lz b gy mf mg l mh mi">array([[&lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;],<br/>       [&lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;]], dtype=object)</span></pre><p id="c5c4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从上面的输出可以清楚地看出，它实际上是一个二维数组。因此访问其中的一个元素应该使用嵌套的for循环。首先在每个矩形中放一些文本:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="b09c" class="md me jj lz b gy mf mg l mh mi">fig, ax = plt.subplots(2, 3, sharex = 'col', sharey = 'row', figsize = (9, 6))<br/>fig.tight_layout(pad = 2)</span><span id="d54e" class="md me jj lz b gy mj mg l mh mi">for a in ax:<br/>    for b in a:<br/>        text = 'I am a plot'<br/>        b.annotate(text, (0.3, 0.45), fontsize = 12)</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ms"><img src="../Images/5c73e9dda1beb6858f8611e129016b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*_KnWoJT294B-tZqFL1IxVA.png"/></div></div></figure><p id="3bf1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">主要目的是在那些矩形里放一些真实的图形和地块。下一步我会这么做。但为此，我们需要一个数据集。我将使用这个数据集:</p><div class="is it gp gr iu mt"><a href="https://github.com/rashida048/Datasets/blob/master/nhanes_2015_2016.csv" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jk gy z fp my fr fs mz fu fw ji bi translated">rashida 048/数据集</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">在GitHub上创建一个帐户，为rashida048/Datasets开发做出贡献。</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">github.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ja mt"/></div></div></a></div><p id="e340" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请随意下载数据集并跟随。</p><p id="acb4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我使用pandas导入数据集:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="0286" class="md me jj lz b gy mf mg l mh mi">df = pd.read_csv('nhanes_2015_2016.csv')<br/>df.columns</span></pre><p id="0c72" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="ff3d" class="md me jj lz b gy mf mg l mh mi">Index(['SEQN', 'ALQ101', 'ALQ110', 'ALQ130', 'SMQ020', 'RIAGENDR', 'RIDAGEYR', 'RIDRETH1', 'DMDCITZN', 'DMDEDUC2', 'DMDMARTL', 'DMDHHSIZ', 'WTINT2YR', 'SDMVPSU', 'SDMVSTRA', 'INDFMPIR', 'BPXSY1', 'BPXDI1', 'BPXSY2', 'BPXDI2', 'BMXWT', 'BMXHT', 'BMXBMI', 'BMXLEG', 'BMXARML', 'BMXARMC', 'BMXWAIST', 'HIQ210'], dtype='object')</span></pre><p id="3532" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将再次制作一个2x3的绘图数组，并在“ax”元素中设置绘图。我们将像二维数组一样简单地通过索引来访问每个“ax”元素。我希望你记得如何索引一个二维数组。如果您需要复习，请查看这篇文章:</p><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/indexing-and-slicing-of-1d-2d-and-3d-arrays-in-numpy-e731afff0bbe"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jk gy z fp my fr fs mz fu fw ji bi translated">Numpy中1D、2D和3D数组的索引和切片</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">本文从基础到高级展示了Numpy数组的索引和切片。</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="ni l ne nf ng nc nh ja mt"/></div></div></a></div><p id="375b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，下面是如何访问“ax”元素并在其中设置绘图。我给你留了两个空位。请随意装满它们。我的想法是演示如何去做。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="ec6c" class="md me jj lz b gy mf mg l mh mi">fig, ax = plt.subplots(2, 3, figsize = (15, 10))<br/>fig.tight_layout(pad = 2)</span><span id="778e" class="md me jj lz b gy mj mg l mh mi">ax[0, 0].scatter(df['BMXWT'], df['BMXHT'])<br/>ax[1, 1].plot(df['BMXBMI'])<br/>df['DMDHHSIZ'].hist(ax = ax[0, 2])<br/>df.groupby('DMDEDUC2')['BPXSY1'].mean().plot(ax = ax[0, 1], kind='pie', colors = ['lightgreen', 'coral', 'pink', 'violet', 'skyblue'])<br/>plt.show()</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nj"><img src="../Images/db9b319092cfae60b44e83f77793ade3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAXak88pOxYOnfFGXmkP-Q.png"/></div></div></figure><p id="41ee" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，我没有将“sharex”设置为“col”、“sharey”或“row”。这样剧情就没什么帮助了。因为饼图没有传统的x轴和y轴。直方图和散点图具有非常不同的范围。请你自己试试。</p><p id="c043" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面所有的图都是一样大的。我是说同样的高度和宽度。事情不一定是这样的。一个子绘图组中的绘图可以有不同的高度和宽度。这可以使用“add_gridspec”函数来完成。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="cb86" class="md me jj lz b gy mf mg l mh mi">fig = plt.figure(constrained_layout=True, figsize=(8, 8))</span><span id="7ad5" class="md me jj lz b gy mj mg l mh mi">s = fig.add_gridspec(3, 3, width_ratios = [2, 3, 4], height_ratios = [3, 3, 2])</span><span id="b69b" class="md me jj lz b gy mj mg l mh mi">for row in range(3):<br/>    for col in range(3):<br/>        ax = fig.add_subplot(s[row, col])</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1254f6bedf6d7ad39b8ee1d53399da58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*s0HtOatw3DeaVvxoAO7hpw.png"/></div></figure><blockquote class="ml mm mn"><p id="c4b0" class="ky kz mo la b lb lc kk ld le lf kn lg mp li lj lk mq lm ln lo mr lq lr ls lt im bi translated"><strong class="la jk">对网格进行更精细的控制</strong></p></blockquote><p id="713c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可以使用“支线剧情”和“GridSpec”来完成。这里有一个例子。我会在图后说明:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="c304" class="md me jj lz b gy mf mg l mh mi">plt.figure(figsize = (15, 12))<br/>grid = plt.GridSpec(3, 4, wspace =0.3, hspace = 0.3)</span><span id="1a2b" class="md me jj lz b gy mj mg l mh mi">plt.subplot(grid[0, :3])<br/>plt.subplot(grid[0, 3])<br/>plt.subplot(grid[1:, :2])<br/>plt.subplot(grid[1, 2:])<br/>plt.subplot(grid[2, 2:])</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/ff0518cf4f2e7e3a0dcdccc243e17a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rnjvm9vQ5uxfjGmQlZegnw.png"/></div></div></figure><p id="64a0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我解释一下这里发生的事情。首先，我们做了一个3x4的网格。这意味着三行四列。接下来，我们通过网格索引来定制地块的大小。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9cc5" class="md me jj lz b gy mf mg l mh mi">plt.subplot(grid[0, :3])</span></pre><p id="5d89" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用这些代码，我们可以索引网格并定制形状。grid[0，3]'这里是取第一行的前三个地块，做一个更大的地块。我们将行索引放在首位。因为它是第一行，所以row-index是0，而column index是0到3，因为我们取前三列。可以写成0:3。但当它以0开头时，可以写成:3。</p><p id="c729" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个是“grid[0，3]”。这个更简单。0表示行索引为0，3表示列索引为3。</p><p id="3fcb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用“grid[1::2]”，我们正在制作一个大的正方形。行索引从1开始，一直到末尾。列索引从0开始，包含2个图。所以，它需要指数为0和1的图。所以列索引变成0:2，可以写成:2。</p><p id="070e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“[1，2:]”引用行索引1。列索引从2开始，一直到末尾。</p><p id="6dfa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">grid[2，2:]'表示行索引2和列索引2到结尾。</p><p id="7d52" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在你知道了如何索引网格和定制形状的图，让我们再做一个并在其中放一些真实的图。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="c55a" class="md me jj lz b gy mf mg l mh mi">plt.figure(figsize = (12, 12))<br/>grid = plt.GridSpec(4, 4, wspace =0.3, hspace = 0.8)</span><span id="e47e" class="md me jj lz b gy mj mg l mh mi">g1 = plt.subplot(grid[0:2, :3])<br/>g2 = plt.subplot(grid[2:, 0:2])<br/>g3 = plt.subplot(grid[:2, 3])<br/>g4 = plt.subplot(grid[2:, 2:])</span><span id="d310" class="md me jj lz b gy mj mg l mh mi">df.groupby('DMDMARTL')['BPXSY1'].mean().plot(kind = 'bar', ax = g1)<br/>g1.set_title("Bar plot of Systolic blood pressure for different marital status")</span><span id="4747" class="md me jj lz b gy mj mg l mh mi">df['BPXSY1'].hist(ax = g3, orientation = 'horizontal', color='gray')<br/>g3.set_title("Distribution of systolic blood pressure")</span><span id="e57e" class="md me jj lz b gy mj mg l mh mi">df.plot('BPXSY1', 'BPXDI1', kind='scatter', ax = g2, alpha=0.3)<br/>g2.set_title("Systolic vs Diastolic blood pressure")</span><span id="ca53" class="md me jj lz b gy mj mg l mh mi">df['BMXHT'].plot(ax = g4, color='gray')<br/>g4.set_title('Line plot of the Weight of the population')</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/75680b71e38ef96ea5bce055d4488e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_f0WpiXvOCxzOyhqNiwq4A.png"/></div></div></figure><p id="b867" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里！完整的情节。</p><h2 id="c08b" class="md me jj bd nn no np dn nq nr ns dp nt lh nu nv nw ll nx ny nz lp oa ob oc od bi translated">结论</h2><p id="0796" class="pw-post-body-paragraph ky kz jj la b lb oe kk ld le of kn lg lh og lj lk ll oh ln lo lp oi lr ls lt im bi translated">如果你已经运行完了上面的所有代码并且能够理解它们，使用支线剧情应该很容易，并且你现在可以完全控制支线剧情了。以下是该内容的视频版本:</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="d654" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">欢迎在<a class="ae jg" href="https://twitter.com/rashida048" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，并喜欢我的<a class="ae jg" href="https://www.facebook.com/rashida.smith.161" rel="noopener ugc nofollow" target="_blank">脸书</a>页面。</p><h2 id="c59f" class="md me jj bd nn no np dn nq nr ns dp nt lh nu nv nw ll nx ny nz lp oa ob oc od bi translated">更多阅读:</h2><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/an-ultimate-cheatsheet-of-data-visualization-in-seaborn-be8ed13a3697"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jk gy z fp my fr fs mz fu fw ji bi translated">用Python的Seaborn库实现数据可视化的终极指南</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">对学习者来说也是一个很好的资源</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="ol l ne nf ng nc nh ja mt"/></div></div></a></div><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/do-you-need-a-masters-degree-to-become-a-data-scientist-ab894c2a8d41"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jk gy z fp my fr fs mz fu fw ji bi translated">成为数据科学家需要硕士学位吗？</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">我作为波士顿大学数据分析专业硕士学生的经历和体会</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="om l ne nf ng nc nh ja mt"/></div></div></a></div><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/an-ultimate-cheat-sheet-for-numpy-bb1112b0488f"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jk gy z fp my fr fs mz fu fw ji bi translated">Numpy入门指南</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">日常工作所需的所有Numpy功能</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="on l ne nf ng nc nh ja mt"/></div></div></a></div><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/a-complete-guide-to-time-series-data-visualization-in-python-da0ddd2cfb01"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jk gy z fp my fr fs mz fu fw ji bi translated">Python时序数据可视化完全指南</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">这应该给你足够的资源来制作时间序列数据的视觉效果</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="oo l ne nf ng nc nh ja mt"/></div></div></a></div></div></div>    
</body>
</html>