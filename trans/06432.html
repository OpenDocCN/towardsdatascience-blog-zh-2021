<html>
<head>
<title>Use the Datasets library of Hugging Face in your next NLP project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在你的下一个NLP项目中使用拥抱脸的数据集库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/use-the-datasets-library-of-hugging-face-in-your-next-nlp-project-94e300cca850?source=collection_archive---------15-----------------------#2021-06-09">https://towardsdatascience.com/use-the-datasets-library-of-hugging-face-in-your-next-nlp-project-94e300cca850?source=collection_archive---------15-----------------------#2021-06-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8dd6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">拥抱脸的数据集库快速使用指南！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0a5f74e8be072186a7d8189b8a991994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ftuRBk-4rIGWj9KOYoIK_g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@marcobian" rel="noopener ugc nofollow" target="_blank">马可</a>在<a class="ae kv" href="https://unsplash.com/photos/vzFTmxTl0DQ" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e922" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据科学就是关于数据的。网络上有各种来源可以为您的数据分析或机器学习项目获取数据。最受欢迎的来源之一是Kaggle，我相信我们每个人在数据之旅中都用过它。</p><p id="b590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近，我偶然发现了一个为我的NLP项目获取数据的新来源，我很乐意谈论它。这是拥抱脸的数据集库，一个快速高效的库，可以轻松地共享和加载数据集和评估指标。因此，如果你正在从事自然语言处理(NLP)工作，并且想为你的下一个项目获取数据，除了拥抱脸，别无他求。😍</p><p id="1ba8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">动机:</strong> <em class="ls">拥抱脸提供的数据集格式与我们的熊猫数据框架不同，因此最初使用拥抱脸数据集可能会令人望而生畏。</em>😱拥抱脸有很好的文档，但是信息量太大了。我刚刚写了一些我们在处理数据集时的基本步骤。😄<em class="ls">本文绝非详尽无遗，如果您想对数据集做更多的事情，我强烈建议您查看他们的文档。</em></p><p id="9dcb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们先了解一下Hugging Face和datasets库，然后举一个例子来了解如何使用这个库中的数据集。😎</p><p id="269c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">抱紧脸</strong> </a>🤗是自然语言处理(NLP)技术的开源提供商。你可以使用拥抱脸最先进的模型(在变形金刚库下)来建立和训练你自己的模型。您可以使用拥抱脸数据集库来共享和加载数据集。您甚至可以使用这个库进行评估。</p><h1 id="e58f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">数据集库</h1><p id="4b1b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">根据<a class="ae kv" href="https://huggingface.co/docs/datasets/" rel="noopener ugc nofollow" target="_blank">拥抱脸网站</a>的说法，数据集库目前拥有超过100个公共数据集。😳这些数据集不仅有英语的，还有其他语言和方言的。👌它支持大多数数据集的一行数据加载器，这使得数据加载成为一项轻松的任务。🏄🏻根据网站上提供的信息，除了易于访问数据集之外，该图书馆还有以下有趣的特点:</p><ul class=""><li id="3b15" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">在大型数据集上茁壮成长:数据集自然将用户从RAM限制中解放出来，所有数据集都使用高效的零序列化成本后端(Apache Arrow)进行内存映射。</li><li id="63e7" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">智能缓存:永远不要等待你的数据处理几次。</li><li id="7585" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">轻量级和快速的透明和pythonic API(多处理/缓存/内存映射)。</li><li id="737a" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">内置与NumPy、pandas、PyTorch、Tensorflow 2和JAX的互操作性。</li></ul><p id="7499" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">哇！好处还挺多的。👏</p><p id="f44a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将展示我们通常在数据科学或分析任务中所做的一些步骤，以理解我们的数据或将我们的数据转换成所需的格式。所以，让我们快速进入这个库，编写一些简单的Python代码。🐍请注意，本文只涉及数据集，不涉及指标。</p><p id="704a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">数据集版本:</strong> 1.7.0</p><p id="f691" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">使用pip安装</strong></p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="a328" class="nj lu iq nf b gy nk nl l nm nn">!pip install datasets</span></pre><p id="17c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">进口</strong></p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="ae21" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">from</strong> datasets <strong class="nf ir">import</strong> list_datasets, load_dataset<br/><strong class="nf ir">from</strong> pprint <strong class="nf ir">import</strong> pprint</span></pre><p id="7b17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从数据集库中，我们可以导入<strong class="ky ir"> list_datasets </strong>来查看该库中可用的数据集列表。<strong class="ky ir"> pprint </strong>模块提供了“漂亮打印”的功能。你可以在这里了解这个模块<a class="ae kv" href="https://docs.python.org/3/library/pprint.html" rel="noopener ugc nofollow" target="_blank">的更多信息。👈🏼</a></p><p id="2a12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">截至2021年6月7日，数据集库拥有928个数据集。🙌我们可以使用以下代码查看可用数据集的列表:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="0c33" class="nj lu iq nf b gy nk nl l nm nn">datasets = <strong class="nf ir">list_datasets()</strong><br/><strong class="nf ir">print</strong>("Number of datasets in the Datasets library: ", <strong class="nf ir">len</strong>(datasets), "\n\n")</span><span id="cbb5" class="nj lu iq nf b gy no nl l nm nn">#list of datasets in pretty-print format<br/><strong class="nf ir">pprint</strong>(datasets, <strong class="nf ir">compact=True</strong>)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/d0f5795ef6a1f078510a38df4c3e22a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*ssODEwsfgfUJCj-A9OzUxA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集列表的片段</p></figure><p id="6969" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想在下载数据集之前就知道它的属性，该怎么办？我们可以用一行代码做到这一点。☝️只需将索引设置为数据集的名称，就可以了！</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="73cf" class="nj lu iq nf b gy nk nl l nm nn">#dataset attributes <br/>squad = <strong class="nf ir">list_datasets</strong>(<strong class="nf ir">with_details=True</strong>)[datasets.index('squad')]</span><span id="00ca" class="nj lu iq nf b gy no nl l nm nn">#calling the python dataclass<strong class="nf ir"><br/>pprint</strong>(squad.<strong class="nf ir">__dict__</strong>)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/806c36aae4539370ff6368798c9fa1f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*ywOiAn_aIdQHMfh66lVa4Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集属性</p></figure><p id="596f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">挺有意思的！😬</p><p id="61ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">加载数据集</strong></p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3403" class="nj lu iq nf b gy nk nl l nm nn">squad_dataset = <strong class="nf ir">load_dataset</strong>('squad')</span></pre><p id="cfa2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">引擎盖下发生了什么？🤔<strong class="ky ir">datasets . load _ dataset()</strong>执行了以下操作:</p><ol class=""><li id="b894" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr nr mw mx my bi translated">从Hugging Face GitHub repo或AWS bucket下载并导入到库中的SQuAD python处理脚本(如果它尚未存储在库中)。</li><li id="f8da" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nr mw mx my bi translated">运行小队脚本下载数据集。在缓存箭头表中处理和缓存小队。</li><li id="ce73" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nr mw mx my bi translated">根据用户要求的拆分返回数据集。默认情况下，它返回整个数据集。</li></ol><p id="071f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来理解一下我们得到的数据集。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3a37" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>(squad_dataset)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/8910ede7377f8708dc816370e5045ee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oy-wVSCe20GL_sQtMxlt4w.png"/></div></div></figure><p id="aee1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">班数据集有两个部分——训练和验证。features对象包含有关列的信息—列名和数据类型。我们还可以看到每次分割的行数(num_rows)。相当翔实！</p><p id="67af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以在加载数据集时指定拆分。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="f1ac" class="nj lu iq nf b gy nk nl l nm nn">squad_train = <strong class="nf ir">load_dataset</strong>('squad', <strong class="nf ir">split=</strong>'train')<br/>squad_valid = <strong class="nf ir">load_dataset</strong>('squad', <strong class="nf ir">split=</strong>'validation')</span></pre><p id="353e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将在squad_train中保存训练集，在squad_valid中保存验证集。</p><p id="127b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，您将意识到加载一些数据集会抛出一个错误，并且在检查错误时，您会意识到您需要第二个参数config。</p><p id="68a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个例子:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="cab0" class="nj lu iq nf b gy nk nl l nm nn">amazon_us_reviews = <strong class="nf ir">load_dataset</strong>('amazon_us_reviews')</span></pre><p id="2923" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">错误消息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/0bf3cf80a9f6b8365f6b096e2fd4bad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lrrfrhA-co3qCeR7ay7bVw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">加载数据集时引发错误</p></figure><p id="2e9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些数据集包括几个配置，这些配置定义了需要选择的数据集的子部分。</p><p id="7b0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解决方案:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3cc9" class="nj lu iq nf b gy nk nl l nm nn">amazon_us_reviews = <strong class="nf ir">load_dataset</strong>('amazon_us_reviews', 'Watches_v1_00')</span></pre><p id="09af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将加载带有配置观察器的amazon_us_reviews数据集。</p><p id="9a55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，如果加载任何数据集抛出一个错误，只需遵循追溯，因为拥抱脸已经给出了关于错误的好信息。👍</p><p id="35ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们继续我们的数据集。🏃🏻</p><p id="d370" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们看到了数据集信息中的行数。我们甚至可以使用标准的<strong class="ky ir"> len </strong>函数来得到它。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="ff80" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>("Length of training set: ", <strong class="nf ir">len</strong>(squad_train))</span></pre><p id="c185" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">训练集长度:87599</p><p id="57a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">检查数据集</strong></p><p id="aacc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要查看数据集的示例:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="0ca4" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>("First example from the dataset: \n")<br/><strong class="nf ir">pprint</strong>(squad_train[0])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d2570db5f7a950c91fa3dcf83a27044f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*IYmCNMz1-J0lJZJ3qRlkpQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">小队训练数据集第一个例子</p></figure><p id="fe05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想用几个例子得到切片，代码和我们用熊猫数据框的一样。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="841a" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>("Two examples from the dataset using slice operation: \n")<br/><strong class="nf ir">pprint</strong>(squad_train[14:16])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/430111ea8634e2a01052f5376edadb55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wa_z0k8u0LAcaQBuNQ3ZHw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集中的示例切片</p></figure><p id="771a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想要查看列中的值？用列名索引数据集。这是“问题”专栏的一个片段。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="0f10" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>("A column slice from the dataset: \n")<br/><strong class="nf ir">pprint</strong>(squad_train['question'][:5])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/897510366f08cfb5641fb421a47a37c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*zGU8IGS9uRV7p1FJolfemA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">小队的纵队</p></figure><p id="85cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以看到，行的切片给出了一个字典，而列的切片给出了一个列表。<strong class="ky ir"> __getitem__ </strong>方法根据查询的类型返回不同的格式。例如，像dataset[0]这样的项将返回元素的字典，像dataset[2:5]这样的片将返回元素列表的字典，而像dataset['question']这样的列或列的片将返回元素列表。这看起来令人惊讶，但拥抱脸做到了这一点，因为它实际上更容易用于数据处理，而不是为每个视图返回相同的格式。</p><p id="408a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请看这个有趣的例子:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="d3d9" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>(squad_train[‘question’][0])<br/><strong class="nf ir">print</strong>(squad_train[0][‘question’])</span></pre><p id="cfeb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出:</p><p id="bfe9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">据说1858年圣母玛利亚在法国卢尔德向谁显现？据说1858年在法国卢尔德出现的圣母玛利亚是给谁看的？</p><p id="dde5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">两者都返回相同的输出。我们来验证一下！🕵</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="abd2" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>(squad_train['question'][0] == squad_train[0]['question'])</span></pre><p id="d2c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出将为<strong class="ky ir">真</strong>。不错！我们在使用熊猫数据框时犯的一个常见错误在这里并不算是错误。</p><p id="6854" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注:</strong> <em class="ls">数据集由一个或几个Apache箭头表支持，这些表是键入的，允许快速检索和访问。您可以加载任意大小的数据集，而不必担心RAM限制，因为数据集不占用RAM中的空间，并且可以在需要时直接从驱动器中读取。</em></p><p id="98c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们进一步检查数据集。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="ba12" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>("Features: ")<br/><strong class="nf ir">pprint</strong>(squad_train.features)</span><span id="7a47" class="nj lu iq nf b gy no nl l nm nn"><strong class="nf ir">print</strong>("Column names: ", squad_train.<strong class="nf ir">column_names</strong>)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/85218355fd01fc06344ccadf6752e10d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*51IyAjwRWB739JxFmdBJPw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/c893e0391402f637f4d27200c066d726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*r8SYI_kle3tZ9jDjcmiMqA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集功能和列名</p></figure><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="1246" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>("Number of rows: ", squad_train.<strong class="nf ir">num_rows</strong>)<br/><strong class="nf ir">print</strong>("Number of columns: ", squad_train.<strong class="nf ir">num_columns</strong>)<br/><strong class="nf ir">print</strong>("Shape: ", squad_train.<strong class="nf ir">shape</strong>)</span></pre><p id="8949" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出:</p><p id="f166" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">行数:87599 <br/>列数:5 <br/>形状:(87599，5)</p><p id="9cb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，您也可以使用<strong class="ky ir"> len </strong>函数获得行数。</p><p id="dbff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">添加/删除新列</strong></p><p id="5cea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加一个名为“new_column”的列，其中包含条目“foo”。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="850f" class="nj lu iq nf b gy nk nl l nm nn">new_column = ["foo"] * <strong class="nf ir">len</strong>(squad_train)<br/>squad_train = squad_train<strong class="nf ir">.add_column</strong>("new_column", new_column)<br/><strong class="nf ir">print</strong>(squad_train)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/6f50559968ba325701c59a75419e2858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*qRUN6FLCqhN9g37gvp6uWg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">添加到数据集中的新列</p></figure><p id="1281" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们删除该列。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="f429" class="nj lu iq nf b gy nk nl l nm nn">squad_train = squad_train.<strong class="nf ir">remove_columns</strong>("new_column")</span></pre><p id="2474" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">重命名列</strong></p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="68cc" class="nj lu iq nf b gy nk nl l nm nn">squad_train = squad_train.<strong class="nf ir">rename_column</strong>("title", "heading")<br/><strong class="nf ir">print</strong>(squad_train)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/7a32d5933396fad9b4cc54dcbb20c917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*qfRZLseceakvnpAwWp6TlQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">标题列重命名为标题</p></figure><p id="8320" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">修改/更新数据集</strong></p><p id="752c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要修改或更新数据集，我们可以使用dataset.map. map()是一种受tf.data.Dataset map方法启发的强大方法。我们可以将该函数应用于一个示例，甚至一批示例，甚至生成新的行或列。</p><p id="03cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">逐个示例地修改:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="0f31" class="nj lu iq nf b gy nk nl l nm nn">updated_squad_train = squad_train.<strong class="nf ir">map</strong>(<strong class="nf ir">lambda</strong> example: {'question': 'Question: ' + example['question']})<br/><strong class="nf ir">pprint</strong>(updated_squad_train['question'][:5])</span></pre><p id="c5be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/12f3279ec304abcb056885082bb497c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xg-NYJSbxoVndWr2y-YZMA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用映射将“问题”追加到列的每一行</p></figure><p id="7ec8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们使用现有列添加一个新列，并删除旧列。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="edd4" class="nj lu iq nf b gy nk nl l nm nn">updated_squad_train = squad_train.<strong class="nf ir">map</strong>(<strong class="nf ir">lambda</strong> example: {'new_heading': "Context: " + example['heading']}, <strong class="nf ir">remove_columns</strong>=['heading'])<br/><strong class="nf ir">pprint</strong>(updated_squad_train.column_names)<br/><strong class="nf ir">pprint</strong>(updated_squad_train['new_heading'][:5])</span></pre><p id="cd98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/bb30d611f72cabfd5d144c6120df0f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*Jdk1W8mg3Tj1XORHapmF6A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用“标题”列中的内容(和前缀)添加了“新标题”列，并从数据集中删除了“标题”列</p></figure><p id="4528" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用地图对数据集执行多项操作。一定要根据你的需求尝试新事物。🙃</p><p id="5649" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除此之外，您还可以批量处理数据。</p><p id="faac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">展示熊猫数据框等示例</strong></p><p id="20db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们总是喜欢将我们的数据集视为一个格式良好的表格，就像我们看到一个熊猫数据框一样。出于显示目的，我们可以将数据集转换为相同的格式。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3ce9" class="nj lu iq nf b gy nk nl l nm nn"><strong class="nf ir">import</strong> random<br/><strong class="nf ir">import</strong> pandas <strong class="nf ir">as</strong> pd<br/><strong class="nf ir">from</strong> IPython.display <strong class="nf ir">import</strong> display, HTML</span><span id="b5ef" class="nj lu iq nf b gy no nl l nm nn"><strong class="nf ir">def</strong> display_random_examples(dataset=squad_train, num_examples=5):<br/>    <strong class="nf ir">assert</strong> num_examples &lt; len(dataset)<br/>    <br/>    random_picks = []<br/>    <strong class="nf ir">for</strong> i <strong class="nf ir">in</strong> <strong class="nf ir">range</strong>(num_examples):<br/>        random_pick = <strong class="nf ir">random.randint</strong>(0,<strong class="nf ir">len</strong>(dataset)-1)<br/>        random_picks.<strong class="nf ir">append</strong>(random_pick)<br/>    <br/>    df = <strong class="nf ir">pd.DataFrame</strong>(dataset[random_picks])<br/>    <strong class="nf ir">display</strong>(<strong class="nf ir">HTML</strong>(df.<strong class="nf ir">to_html()</strong>))<br/>        <br/>display_random_examples(squad_train, 3)</span></pre><p id="3c1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出是一个格式良好的表格。👌</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/6c9b2bd894ac468b1fc89e1af1873f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OhiqRFv4BxlO65qnlS3_zw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们数据集的格式良好的表格</p></figure><p id="aa6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文到此为止。从这里，您可以根据您的项目需求预处理您的数据，并构建您的模型或创建漂亮的可视化。不可能在一篇文章中涵盖所有内容。但是，通过阅读本文，您可以了解如何使用datasets库中可用的方法。如果你需要对数据集做更多的事情，请查看<a class="ae kv" href="https://huggingface.co/docs/datasets/index.html" rel="noopener ugc nofollow" target="_blank">文档</a>。还有很多很多方法，如排序，洗牌，分片，选择，过滤，连接数据集等。您还可以将数据集格式化为PyTorch、Tensorflow、Numpy和Pandas。如果你想分享你自己的数据集，你也可以这样做。在这里阅读<a class="ae kv" href="https://huggingface.co/docs/datasets/add_dataset.html" rel="noopener ugc nofollow" target="_blank"/>！</p><p id="e203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想看代码，请参考这个<a class="ae kv" href="https://github.com/chetnakhanna16/huggingface_datasets/blob/main/HuggingFace_Datatsets_Library_TDS.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a>到我的Github repo。</p><p id="a978" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考文献:</strong></p><ol class=""><li id="55d0" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr nr mw mx my bi translated">对于数据集:<a class="ae kv" href="https://huggingface.co/datasets" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/datasets</a></li><li id="72dd" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nr mw mx my bi translated">对于数据集文档:<a class="ae kv" href="https://huggingface.co/docs/datasets/" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/docs/datasets/</a></li></ol></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><p id="e044" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢大家阅读这篇文章。请分享您宝贵的反馈或建议。快乐阅读！📗 🖌</p></div></div>    
</body>
</html>