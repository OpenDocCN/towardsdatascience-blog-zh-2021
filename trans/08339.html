<html>
<head>
<title>Python Web Apps Are a Terrible Idea for Analytics Projects.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Web应用对于分析项目来说是一个糟糕的想法。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-web-apps-are-a-terrible-idea-for-analytics-projects-36f1bd33e84b?source=collection_archive---------2-----------------------#2021-08-01">https://towardsdatascience.com/python-web-apps-are-a-terrible-idea-for-analytics-projects-36f1bd33e84b?source=collection_archive---------2-----------------------#2021-08-01</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="2c94" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">纯Python栈忽略了严重的缺点。以下是如何弥补的方法。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e69b3ce1a041b81500da1f0b293299b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LJUA8RPZBMIzFBiB"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">蒂姆·高在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="21dc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这是本能。我们数据科学家热爱Python。因此，我们在每个应用程序中都倾向于Python框架。万能的语言似乎在大多数情况下也能很好地工作。其中一个场景是为您的分析项目构建web应用程序。</p><p id="233c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">其中的关键词是“大多数情况”Python是一门漂亮的语言，几乎可以用在任何问题上。然而，仔细观察可能会发现一些细微的差别，这些差别可能会使Python在某些情况下变得无关紧要。</p><p id="63bf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">多年来，我一直是姜戈的粉丝。它是构建web应用程序最流行的python框架。Django提供了一个典型的web框架所需要的一切——认证、数据库迁移、管理界面等等。集成一个机器学习算法是毫不费力的，因为两者都在同一种语言中。</p><p id="c76e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然而，在发现关于这个框架的可怕事实后，我不得不改变我的想法。更具体地说，它在数据科学项目中的使用。但这不是姜戈的事；是Python。即使您使用其他Python web框架，如Flask，也必须面对同样的问题。</p><p id="5d8f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是在匆忙抛弃Django/Flask之前，我不得不说这不是一个死胡同。我们可以让Python再次变得伟大；作为一个网络框架。</p><p id="db61" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本文中，我们将讨论</p><ul class=""><li id="97f5" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">Flask与ExpressJS执行长时间运行任务的比较；</li><li id="d1c0" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">调查python web应用在分析项目中失败的原因，以及；</li><li id="0862" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">使Python web应用程序更好地满足请求的变通方法。</li></ul></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><h1 id="52ce" class="mr ms iu bd mt mu mv mw mx my mz na nb ka nc kb nd kd ne ke nf kg ng kh nh ni bi translated">Python和JavaScript web应用程序。</h1><p id="35b4" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">与JavaScript相比，我们需要一个演示来理解Python的问题。</p><p id="c503" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因此，让我们在每种语言中使用两种流行的框架来完成相同的任务——计算第30个斐波那契数。下面是我们如何使用Flask (Python。)</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="no np l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">Python (Flask)服务于第30个斐波那契数——作者<a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener"/>。</p></figure><p id="41d9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要运行上述任务，您可以在终端中使用以下命令:</p><pre class="kk kl km kn gu nq nr ns nt aw nu bi"><span id="c476" class="nv ms iu nr b gz nw nx l ny nz">pip install flask # if Flask is not installed yet.<br/>flask app.py</span></pre><p id="cdb8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在让我们用Express JS (JavaScript)做同样的事情:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="no np l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">JavaScript (ExpressJS)服务于第30个斐波那契数——作者<a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener"/>。</p></figure><p id="3344" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以下是使用node启动服务器的方法:</p><pre class="kk kl km kn gu nq nr ns nt aw nu bi"><span id="66b6" class="nv ms iu nr b gz nw nx l ny nz">npm install express --save # if express is not installed already<br/>node app.js</span></pre><p id="7d25" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如你所见，两者在各方面都很相似。它在请求中不接受任何参数，计算第30个斐波那契数，并返回相应的值。</p><p id="9c27" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们在单个线程中以开发模式启动这两个应用程序。这正是我们所需要的，因为我们在单个线程中测量它们的性能。</p><p id="4b49" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，让我们通过向服务器发出多个请求并记录时间流逝来模拟真实世界。下面的代码在10个并行线程中向我们的服务器发送1000个请求。该计划还将打印平均耗时毫秒。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="no np l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用10个线程计算1000个请求的平均响应时间。</p></figure><p id="de5b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们比较一下结果。以下是节点服务器服务时的结果:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/b1a353261e09d2bed69fee79e36258b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3bOH3eHXySH-PJo5zfxeg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用JavaScript服务器计算第30个斐波那契数1000次所用的平均时间截图——来自<a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener">作者</a>。</p></figure><p id="1c39" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当Flask为请求提供服务时，情况也是如此:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/717fa2f29a9e398d79387ba4767a9317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xl_9XRUUHCvNmOBqfczU5g.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用Python服务器计算第30个斐波那契数1000次所用的平均时间截图——来自作者<a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener">。</a></p></figure><p id="d299" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">多次做这个实验会得到几乎相似的结果。Express (JavaScript)处理请求的速度比Flask (Python)快近四倍。)</p><p id="5c0d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">计算第30个斐波那契数并不是一个长期运行的任务。但这足以帮助我们理解这个问题的重要性。</p></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><h1 id="3bd2" class="mr ms iu bd mt mu mv mw mx my mz na nb ka nc kb nd kd ne ke nf kg ng kh nh ni bi translated">是什么让Python服务器变慢了？</h1><p id="4a38" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">你去一家名为“Sync”的餐厅，那里的服务员叫Python。一个陌生人先点他的食物。Python去了厨房，二十分钟后回来，给陌生人上菜。然后他走过来问你:“先生，你要点什么？”</p><p id="5e43" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你现在点菜，你将不得不再等二十分钟。</p><p id="1d27" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">出于无奈，你离开了那家餐厅，去了另一家名为“Async”的餐厅。在那里，水的名字是JavaScript。同样，一个陌生人先点他的食物。JavaScript去了厨房，一会儿就回来。他对陌生人叽叽喳喳地说了些什么，然后沿着你的路走过来，问道:“先生，你要点什么？”</p><p id="dfbe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你点了你的食物；陌生人在接下来的18分钟内得到了他的，而你在20分钟内得到了你的。</p><p id="4c6b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这就是Python和JavaScript的工作方式。Python以同步的方式一次处理一个任务。然而，当已经有一个请求正在处理时，JavaScript接受了另一个请求。这种异步行为使得基于JavaScript的web应用程序速度更快。</p></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><h1 id="e864" class="mr ms iu bd mt mu mv mw mx my mz na nb ka nc kb nd kd ne ke nf kg ng kh nh ni bi translated">如何让Python web应用更好地执行分析？</h1><p id="8a80" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">只要您只有短暂的请求或长期运行的任务，并且只有少量来自用户的预期请求，那么您就做得很好。像Flask和Django这样的Python框架是理想的，因为你可以用一种语言——Python来保存所有的东西。</p><p id="d486" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当您有大量需求的长时间运行的任务时，复杂性就会增加。为了保持服务器正常运行，您可能需要部署多个实例并很好地平衡负载。这种变通方法在大多数情况下是不可持续的。它把成本飙升到一个疯狂的高度。</p><p id="3cda" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">数据科学项目经常伴随着这种长时间运行的任务。没有异步行为的繁重计算可能需要更多的计算能力。然而，在转移到不同的框架之前，您可以尝试一些变通方法。</p><h2 id="effb" class="nv ms iu bd mt oc od dn mx oe of dp nb lj og oh nd ln oi oj nf lr ok ol nh om bi translated">将计算从请求-响应周期中分离出来。</h2><p id="7c96" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">无论如何，将高性能计算与web服务器结合在一起是一个糟糕的想法。即使是异步服务器也不应该在请求-响应周期内为它们服务。如果是这样，Instagram和Spotify这样的巨型平台是如何处理海量计算的？这里有一篇文章可以回答这个问题。</p><div class="on oo gq gs op oq"><a rel="noopener follow" target="_blank" href="/how-to-serve-massive-computations-using-python-web-apps-590e51624bc6"><div class="or ab fp"><div class="os ab ot cl cj ou"><h2 class="bd iv gz z fq ov fs ft ow fv fx it bi translated">如何使用Python Web应用服务于大规模计算？</h2><div class="ox l"><h3 class="bd b gz z fq ov fs ft ow fv fx dk translated">克服Python的局限性，并通过web请求将其用于繁重的数据分析和机器学习。</h3></div><div class="oy l"><p class="bd b dl z fq ov fs ft ow fv fx dk translated">towardsdatascience.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kt oq"/></div></div></a></div><p id="0c1b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个想法是向运行在独立线程上的计算引擎发送消息。web服务器不需要等到计算完成才发送响应。相反，计算引擎更新数据库。web服务器可以使用单独的端点随时读取其值。</p><h2 id="bb2a" class="nv ms iu bd mt oc od dn mx oe of dp nb lj og oh nd ln oi oj nf lr ok ol nh om bi translated">尝试优化您的代码。</h2><p id="9938" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">不管您将使用哪种框架，如果您总是试图优化您的代码，那将是最好的。最近的一个库似乎在优化Python程序方面非常有效。</p><p id="b0f7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Tuplex将您的Python代码转换为本地LLVM，并并行运行它。该库背后的团队在一篇研究文章中显示，它的速度大约快了91倍。下面是我之前写的一篇关于这个话题的详细文章:</p><div class="on oo gq gs op oq"><a rel="noopener follow" target="_blank" href="/how-to-speed-up-python-data-pipelines-up-to-91x-80d7accfe7ec"><div class="or ab fp"><div class="os ab ot cl cj ou"><h2 class="bd iv gz z fq ov fs ft ow fv fx it bi translated">如何将Python数据管道加速到91X？</h2><div class="ox l"><h3 class="bd b gz z fq ov fs ft ow fv fx dk translated">一个5分钟的教程可以为您的大数据项目节省数月时间。</h3></div><div class="oy l"><p class="bd b dl z fq ov fs ft ow fv fx dk translated">towardsdatascience.com</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe kt oq"/></div></div></a></div><h2 id="9f21" class="nv ms iu bd mt oc od dn mx oe of dp nb lj og oh nd ln oi oj nf lr ok ol nh om bi translated">引入异步行为。</h2><p id="0943" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">Flask和Django都有引入异步行为的方法。对于潜在的耗时任务，这种变通方法是一个很好的选择。</p><p id="32a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然而，这两个框架在它们的文档中都提到它们有几个缺点。因此，在所有的web请求中使用它们是不明智的。</p><p id="5452" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">标准Python库asyncio帮助您异步转换一些函数。尽可能使用它。</p><p id="857e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为Python本身不是异步的，所以所有这些解决方法都依赖于运行一个无限事件循环。尽管它们在许多方面并不完美，但在迁移之前考虑它们是值得。</p></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><h1 id="e3d3" class="mr ms iu bd mt mu mv mw mx my mz na nb ka nc kb nd kd ne ke nf kg ng kh nh ni bi translated">最后的想法</h1><p id="04b6" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">Python是一种非常棒的数据科学编程语言。因为它是一种通用语言，Python的应用并不局限于数据科学。但这并不意味着它是所有用例的完美语言。</p><p id="154c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为大多数数据科学家已经爱上了Python，所以我们选择Flask和Django这样的框架来构建web应用。然而，其同步行为可能导致生产中严重的成本劣势。</p><p id="9b5a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">JavaScript本质上是异步的，对于长时间运行的任务表现更好。但是，python框架也有一些变通方法来提高它们的性能。因此，在决定迁移之前考虑它们是值得的。</p><p id="96b8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你仍然喜欢Python web应用程序而不是你的数据科学项目，那么试试streamlit。</p><div class="on oo gq gs op oq"><a rel="noopener follow" target="_blank" href="/how-to-create-stunning-web-apps-for-your-data-science-projects-c7791102134e"><div class="or ab fp"><div class="os ab ot cl cj ou"><h2 class="bd iv gz z fq ov fs ft ow fv fx it bi translated">如何为您的数据科学项目创建出色的Web应用程序</h2><div class="ox l"><h3 class="bd b gz z fq ov fs ft ow fv fx dk translated">数据科学家不必学习HTML、CSS和JavaScript来构建网页。</h3></div><div class="oy l"><p class="bd b dl z fq ov fs ft ow fv fx dk translated">towardsdatascience.com</p></div></div><div class="oz l"><div class="pg l pb pc pd oz pe kt oq"/></div></div></a></div></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><blockquote class="ph pi pj"><p id="e0d7" class="la lb pk lc b ld le jv lf lg lh jy li pl lk ll lm pm lo lp lq pn ls lt lu lv in bi translated">谢谢你的阅读，朋友。看来你和我有许多共同的兴趣。一定要看看我的个人博客。</p><p id="2f7d" class="la lb pk lc b ld le jv lf lg lh jy li pl lk ll lm pm lo lp lq pn ls lt lu lv in bi translated"><strong class="lc iv"> <em class="iu">向我问好</em> </strong>上<a class="ae kz" href="https://www.linkedin.com/in/thuwarakesh/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a><a class="ae kz" href="https://twitter.com/Thuwarakesh" rel="noopener ugc nofollow" target="_blank">Twitter</a><a class="ae kz" href="https://thuwarakesh.medium.com/subscribe" rel="noopener">中</a>。我会为你打破僵局。</p></blockquote><p id="4c22" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">还不是中等会员？请使用此链接<a class="ae kz" href="https://thuwarakesh.medium.com/membership" rel="noopener"> <strong class="lc iv">成为</strong> </a>会员。你可以享受成千上万的有见地的文章，并支持我，因为我赚了一点佣金介绍你。</p></div></div>    
</body>
</html>