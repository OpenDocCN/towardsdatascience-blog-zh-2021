<html>
<head>
<title>Using PyTorch Lightning Flash and FiftyOne to Build Computer Vision Models, Fast</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyTorch Lightning Flash和FiftyOne快速构建计算机视觉模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/open-source-tools-for-fast-computer-vision-model-building-b39755aab490?source=collection_archive---------11-----------------------#2021-06-22">https://towardsdatascience.com/open-source-tools-for-fast-computer-vision-model-building-b39755aab490?source=collection_archive---------11-----------------------#2021-06-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b5fa" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用开源工具PyTorch Lightning Flash和FiftyOne增强计算机视觉工作流程的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://fiftyone.ai"><div class="gh gi kf"><img src="../Images/a69d474be3bce6a7a9532a5b13c01100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RjdeC2YE46Z0ZOEavwGGWA.png"/></div></a><p class="kn ko gj gh gi kp kq bd b be z dk translated">可视化<a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> PyTorch闪电</a>模型预测在<a class="ae kr" href="https://fiftyone.ai" rel="noopener ugc nofollow" target="_blank">五十一</a>(图片由作者提供)</p></figure><p id="5b2e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">开源工具在最近几年取得了显著的进步，满足了许多与端到端平台服务相同的需求。从模型架构开发到数据集管理，再到模型培训和部署，它们都非常有用。通过充分挖掘，您可以找到一个能够支持数据和模型生命周期大部分部分的开源工具。<strong class="ku ir">工具之间的紧密集成是实现近乎无缝的工作流程的最佳方式</strong>。这篇文章深入探讨了模型原型和训练框架<a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> PyTorch Lightning Flash </a>与数据集可视化和模型分析工具<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank"> FiftyOne </a>之间的新集成。</p><p id="eb91" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> Lightning Flash </a>是一个建立在<a class="ae kr" href="https://github.com/PyTorchLightning/pytorch-lightning" rel="noopener ugc nofollow" target="_blank"> PyTorch Lighting </a>之上的新框架，它提供了一系列任务，用于快速原型制作、基线、微调以及用深度学习解决商业和科学问题。尽管无论你有多少深度学习的经验，Flash都很容易掌握，但你可以用Lightning和PyTorch修改现有的任务，找到适合你的抽象级别。为了进一步加快速度，Flash代码是<a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash#scalability" rel="noopener ugc nofollow" target="_blank">可扩展的</a>，内置了对任何硬件上的分布式训练和推理的支持。</p><p id="514e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">Flash使得训练你的第一个模型变得非常容易，但是要继续改进它，你需要知道你的模型表现如何，以及如何改进它。<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank"> FiftyOne </a>是由<a class="ae kr" href="https://voxel51.com/" rel="noopener ugc nofollow" target="_blank"> Voxel51 </a>开发的用于构建高质量数据集和计算机视觉模型的开源工具。它为优化数据集分析管道提供了构建模块，使您能够直接使用数据，包括可视化复杂标注、评估模型、探索感兴趣的场景、识别故障模式、查找注释错误、管理训练数据集等。</p><p id="0495" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">借助Flash + FiftyOne，您可以加载数据集、训练模型并分析以下所有计算机视觉任务的结果:</p><ul class=""><li id="adc3" class="lo lp iq ku b kv kw ky kz lb lq lf lr lj ls ln lt lu lv lw bi translated"><a class="ae kr" href="https://voxel51.com/docs/fiftyone/integrations/lightning_flash.html#model-training" rel="noopener ugc nofollow" target="_blank">图像分类</a></li><li id="3983" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated"><a class="ae kr" href="https://voxel51.com/docs/fiftyone/integrations/lightning_flash.html#model-training" rel="noopener ugc nofollow" target="_blank">图像物体检测</a></li><li id="6890" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated"><a class="ae kr" href="https://voxel51.com/docs/fiftyone/integrations/lightning_flash.html#model-training" rel="noopener ugc nofollow" target="_blank">图像语义分割</a></li><li id="9038" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated"><a class="ae kr" href="https://voxel51.com/docs/fiftyone/integrations/lightning_flash.html#model-training" rel="noopener ugc nofollow" target="_blank">视频分类</a></li><li id="4ce1" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated"><a class="ae kr" href="https://voxel51.com/docs/fiftyone/integrations/lightning_flash.html#image-embeddings" rel="noopener ugc nofollow" target="_blank">嵌入可视化</a></li></ul><h1 id="baaf" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">概观</h1><p id="afac" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated"><a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> Flash </a>和<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank"> FiftyOne </a>之间的紧密集成允许您执行一个端到端的工作流，加载数据集，在其上训练模型，并可视化/分析其预测，所有这些都只需要几个简单的代码块</p><h2 id="f07f" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated">将51个数据集加载到闪存中</h2><p id="d523" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">虽然使用<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank"> FiftyOne </a>开发数据集一直很容易，但与<a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> PyTorch Lightning Flash </a>的集成现在允许您通过将数据集直接加载到Flash和训练任务中来使用这些数据集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="ebdc" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated">培训Flash任务</h2><p id="ac80" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated"><a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> Flash </a>提供了获取任务模型所需的工具，并开始使用尽可能少的代码对数据进行微调，最重要的是，不需要成为该领域的专家。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="6e09" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated"><strong class="ak">可视化51次闪光预测</strong></h2><p id="3af3" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">由于现代数据集的复杂性和规模，图像和视频数据的可视化始终是一个挑战。<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank">fiftone</a>旨在为您的数据集和标签(包括注释和模型预测)提供一个用户友好的视图，现在可以通过<a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash#tasks" rel="noopener ugc nofollow" target="_blank"> Flash模型</a>在一行额外的代码中访问该视图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nn"><img src="../Images/eb710cacf09c07789e0b4358b610ced8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ROUEBDe8DEWdY-MTu00Ifw.gif"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><a class="ae kr" href="https://lightning-flash.readthedocs.io/en/latest/reference/video_classification.html" rel="noopener ugc nofollow" target="_blank"> Flash视频分类预测</a>在<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank">第五十一</a>中可视化(图片由作者提供)</p></figure><h1 id="94b6" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">示例工作流</h1><h2 id="e549" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated">设置</h2><p id="f30a" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">按照本文中的例子，你需要安装相关的包。首先，你需要安装<a class="ae kr" href="https://lightning-flash.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank"> PyTorch闪电灯</a>和<a class="ae kr" href="https://voxel51.com/docs/fiftyone/getting_started/install.html" rel="noopener ugc nofollow" target="_blank">51</a>。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="6f7c" class="mz md iq nt b gy nx ny l nz oa">pip install fiftyone lightning-flash</span></pre><p id="1c4b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">对于嵌入可视化工作流，您还需要安装降维包，<a class="ae kr" href="https://pypi.org/project/umap-learn/" rel="noopener ugc nofollow" target="_blank"> umap-learn: </a></p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="9b35" class="mz md iq nt b gy nx ny l nz oa">pip install umap-learn</span></pre><h2 id="2ee7" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated">一般工作流程</h2><p id="776e" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">使用这些工具的大多数模型开发工作流遵循相同的一般结构:</p><ol class=""><li id="7320" class="lo lp iq ku b kv kw ky kz lb lq lf lr lj ls ln ob lu lv lw bi translated"><a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/dataset_creation/index.html" rel="noopener ugc nofollow" target="_blank">将数据集加载到第五十一个</a></li><li id="0995" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln ob lu lv lw bi translated">从数据集创建一个Flash数据模块</li><li id="7b4c" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln ob lu lv lw bi translated"><a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash#finetuning" rel="noopener ugc nofollow" target="_blank">微调任务</a></li><li id="3c1e" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln ob lu lv lw bi translated"><a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash#predictions" rel="noopener ugc nofollow" target="_blank">根据模型生成预测</a></li><li id="b2ea" class="lo lp iq ku b kv lx ky ly lb lz lf ma lj mb ln ob lu lv lw bi translated">将预测添加回数据集并<a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/app.html" rel="noopener ugc nofollow" target="_blank">可视化它们</a></li></ol><h2 id="2e38" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated">图像目标检测</h2><p id="4192" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">本节展示了使用PyTorch Lightning Flash和FiftyOne之间的这种集成来训练和评估图像对象检测模型的具体示例。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi oc"><img src="../Images/69273e98c0506df3bb3e9cbaba64e312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0RqujwCynC4GfZuVf2l-ng.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><a class="ae kr" href="https://lightning-flash.readthedocs.io/en/latest/reference/object_detection.html" rel="noopener ugc nofollow" target="_blank">闪光物体探测预测</a>在<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank">第五十一</a>中可视化(图片由作者提供)</p></figure><p id="dba0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">从这里开始，您现在可以将您的预测返回到您的数据集中，并可以运行评估来<a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/plots.html#confusion-matrices" rel="noopener ugc nofollow" target="_blank">生成混淆矩阵</a>、<a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/evaluation.html#map-and-pr-curves" rel="noopener ugc nofollow" target="_blank"> PR曲线</a>和<a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/evaluation.html" rel="noopener ugc nofollow" target="_blank">指标，如准确性和映射</a>。特别是，您能够<a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/using_views.html#evaluation-patches" rel="noopener ugc nofollow" target="_blank">识别和查看单个真/假阳性/阴性结果</a>，从而让您了解您的模型在哪些地方表现良好，在哪些地方表现不佳。基于常见的故障模式改进您的模型是开发更好模型的更可靠的方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi od"><img src="../Images/7bcd7931241a7447191483241387c078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*A7KJ9HyRAFXPMode7tbDZw.gif"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/plots.html" rel="noopener ugc nofollow" target="_blank">第五十一集</a>中的互动混淆矩阵(图片由作者提供)</p></figure><h2 id="6766" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated">嵌入可视化</h2><p id="aaee" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">此工作流的独特之处在于，它采用预先训练的模型，并使用这些模型为数据集中的每个图像生成嵌入向量。然后，您可以<a class="ae kr" href="https://voxel51.com/docs/fiftyone/tutorials/image_embeddings.html" rel="noopener ugc nofollow" target="_blank">计算这些嵌入在低维空间中的可视化效果</a>以找到数据的聚类。这种功能可以为硬样本挖掘、数据预注释、样本注释推荐等目的带来宝贵的发现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi oe"><img src="../Images/5627945513c2ea7c6e6dededb6f418a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kp2QWmN9N_LNAfjl2VOHUg.png"/></div></div></figure><p id="7a00" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">借助<a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/plots.html#visualizing-embeddings" rel="noopener ugc nofollow" target="_blank">交互图</a>的概念，您可以点击或圈出这些嵌入的区域，并自动更新您的会话以查看和<a class="ae kr" href="https://voxel51.com/docs/fiftyone/user_guide/app.html#tags-and-tagging" rel="noopener ugc nofollow" target="_blank">标记相应的样本</a>。</p><h2 id="2769" class="mz md iq bd me na nb dn mi nc nd dp mm lb ne nf mo lf ng nh mq lj ni nj ms nk bi translated">附加任务</h2><p id="c222" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">您可以在此查看其他任务的类似工作流程，如<a class="ae kr" href="https://voxel51.com/docs/fiftyone/integrations/lightning_flash.html#model-training" rel="noopener ugc nofollow" target="_blank">分类和分段。</a></p><h1 id="eaba" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">摘要</h1><p id="1f0a" class="pw-post-body-paragraph ks kt iq ku b kv mu jr kx ky mv ju la lb mw ld le lf mx lh li lj my ll lm ln ij bi translated">多年来，令人印象深刻的发展来自开源社区，尤其是在机器学习领域。虽然单个工具可以很好地解决特定的问题，但是工具之间的紧密集成才能产生强大的工作流。<a class="ae kr" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> PyTorch Lightning Flash </a>和<a class="ae kr" href="https://fiftyone.ai/" rel="noopener ugc nofollow" target="_blank"> FiftyOne </a>之间的新集成提供了一种新的简单方法来开发数据集、训练模型和分析结果。</p></div><div class="ab cl of og hu oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ij ik il im in"><p id="2aed" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><em class="om">(本帖由</em><a class="ae kr" href="https://pytorch-lightning.medium.com/" rel="noopener"><em class="om">py torch Lightning</em></a><em class="om">和</em><a class="ae kr" href="https://medium.com/voxel51" rel="noopener"><em class="om">voxel 51</em></a><em class="om">团队合作)</em></p></div></div>    
</body>
</html>