<html>
<head>
<title>Train multiple Time Series Forecasting Models in one line of Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在一行Python代码中训练多个时间序列预测模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/train-multiple-time-series-forecasting-models-in-one-line-of-python-code-615f2253b67a?source=collection_archive---------0-----------------------#2021-04-15">https://towardsdatascience.com/train-multiple-time-series-forecasting-models-in-one-line-of-python-code-615f2253b67a?source=collection_archive---------0-----------------------#2021-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6681" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Auto-TS库开发ARIMA、SARIMAX、FB Prophet、VAR和ML模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8d72a3bea4eff6f340584241d7f6c049.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nAtoDsVR7ZZo-6YZQUAHhw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/mediamodifier-1567646/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3033203" rel="noopener ugc nofollow" target="_blank"> Mediamodifier </a>来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3033203" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="46be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自动机器学习(AutoML)指的是将机器学习管道的一些组件自动化。AutoML通过自动化一些模型开发过程来加速数据科学家的工作流程。自动化允许非专家在没有太多领域知识的情况下训练基本的机器学习模型。</p><p id="1b7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有<a class="ae ky" href="https://medium.com/swlh/8-automl-libraries-to-automate-machine-learning-pipeline-3da0af08f636" rel="noopener">各种Auto-ML开源Python库</a>包括TPOT、MLBox、Auto-Sklearn等，可以自动化一个分类或回归机器学习模型。为了自动化NLP问题，可以使用<a class="ae ky" href="https://medium.com/swlh/autonlp-sentiment-analysis-in-5-lines-of-python-code-7b2cd2c1e8ab" rel="noopener"> AutoNLP库</a>。</p><p id="4283" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论如何使用开源模型Auto-TS来自动化时间序列预测模型的实现。</p><h1 id="d9b1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是自动TS:</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/caaf3218d59532ff373564980db0f7fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sqdTGFex4Lsew4a8WbtLKA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="6453" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Auto-TS是一个带有时间序列预测实现的开源Python库。它可以在一行Python代码中训练多个时间序列预测模型，包括ARIMA、SARIMAX、FB Prophet、VAR等，然后从中选择最佳的一个进行预测。</p><p id="df83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Auto-TS库的一些特性是:</p><ul class=""><li id="8425" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">利用遗传规划优化寻找最优时间序列预测模型。</li><li id="3998" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">利用所有可能的超参数配置和交叉验证，训练朴素模型、统计模型、机器学习模型和深度学习模型。</li><li id="bc81" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">通过学习最佳NaN插补和异常值剔除，执行数据转换以处理杂乱数据。</li><li id="4443" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">模型选择的度量组合选择。</li></ul><h2 id="2a87" class="nc lw it bd lx nd ne dn mb nf ng dp mf li nh ni mh lm nj nk mj lq nl nm ml nn bi translated">安装:</h2><p id="1a91" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">可以使用PyPl安装Auto-TS，使用命令:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="48a0" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">pip install autots</strong></span></pre><p id="46b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用以下方式导入库:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="571a" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">from auto_ts import auto_timeseries</strong></span></pre><h2 id="b397" class="nc lw it bd lx nd ne dn mb nf ng dp mf li nh ni mh lm nj nk mj lq nl nm ml nn bi translated">用法:</h2><blockquote class="oc od oe"><p id="05ef" class="kz la of lb b lc ld ju le lf lg jx lh og lj lk ll oh ln lo lp oi lr ls lt lu im bi translated">本案例研究中使用的数据集是从<a class="ae ky" href="https://www.kaggle.com/szrlee/stock-time-series-20050101-to-20171231?select=AMZN_2006-01-01_to_2018-01-01.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载的从2006年1月到2017年12月的<a class="ae ky" href="https://www.kaggle.com/szrlee/stock-time-series-20050101-to-20171231?select=AMZN_2006-01-01_to_2018-01-01.csv" rel="noopener ugc nofollow" target="_blank">亚马逊股价</a>。</p></blockquote><p id="5a00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个库只提供训练时间序列预测模型。数据集应该有一个时间或数据格式列。</p><ul class=""><li id="a0b8" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">使用时间/日期列加载时序数据集</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="e5f9" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">df = pd.read_csv("AMZN.csv", usecols=['Date', 'Close'])<br/>df['Date'] = pd.to_datetime(df['Date'])<br/>df = df.sort_values('Date')</strong></span></pre><ul class=""><li id="bb58" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">将整个数据分成训练和测试数据</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="d981" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">train_df = df.iloc[:2800]<br/>test_df = df.iloc[2800:]</strong></span></pre><ul class=""><li id="8f5e" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">可视化列车测试值以供参考</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="37e7" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">train_df.Close.plot(figsize=(15,8), title= 'AMZN Stock Price', fontsize=14, label='Train')<br/>test_df.Close.plot(figsize=(15,8), title= 'AMZN Stock Price', fontsize=14, label='Test')<br/>plt.legend()<br/>plt.grid()<br/>plt.show()</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/b133eb8034618542df496b939033b2d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2v1ia-wwQRAW_9HhYi3sqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)、训练测试分割、AMZN股价可视化</p></figure><ul class=""><li id="e328" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">初始化Auto-TS模型对象，并拟合定型数据。</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="69b8" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">model = auto_timeseries(forecast_period=219, score_type='rmse', time_interval='D', model_type='best')<br/>model.fit(traindata= train_df, ts_column="Date", target="Close")</strong></span></pre><ul class=""><li id="1d9c" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">比较不同型号的得分</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="432d" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">model.get_leaderboard()<br/>model.plot_cv_scores()</strong></span></pre><div class="kj kk kl km gt ab cb"><figure class="ok kn ol om on oo op paragraph-image"><img src="../Images/464fa842db8990c42cf02d6c96134831.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*k62BASD1mxkD2wMHgTdiJw.png"/></figure><figure class="ok kn oq om on oo op paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ea2b4e94adf3eeee8f6848b800dedaee.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*HLzUiYnyYPOfuBfBVPeRkQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk or di os ot translated">(图片由作者提供)，不同车型的RMSE评分</p></figure></div><ul class=""><li id="c338" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">预测测试数据</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="1f2c" class="nc lw it nu b gy ny nz l oa ob"><strong class="nu iu">future_predictions = model.predict(testdata=219)</strong></span></pre><ul class=""><li id="a505" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">可视化测试数据值和预测。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/87eca39c79d0c5aca3c7e9b559ea6ea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7KnRXjtqD2Oi7A0Kojv2Uw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，测试与预测，AMZN股价可视化</p></figure><h1 id="f7bc" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论:</h1><p id="adf6" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">在本文中，我们讨论了如何用一行Python代码实现时间序列建模。Auto-TS对数据进行预处理，因为它通过学习最佳NaN插补从数据中移除异常值并处理杂乱数据。只需一行代码，通过初始化Auto-TS对象并拟合训练数据，您就可以训练多个时间序列模型，包括ARIMA、SARIMAX、FB Prophet、VAR，并得出性能最佳的模型。</p><p id="22ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型的结果看起来确实令人满意，但如果我们尝试增加数据集的大小，结果可能会有所改善。</p><p id="8d97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了为时序数据集训练模型的Auto-TS库之外，我们还有各种AutoML库，可以通过自动化模型开发管道来加快数据科学家的工作流程。阅读下面提到的文章中的<a class="ae ky" href="https://medium.com/swlh/8-automl-libraries-to-automate-machine-learning-pipeline-3da0af08f636" rel="noopener">，了解8个AutoML库。</a></p><div class="ou ov gp gr ow ox"><a href="https://medium.com/swlh/8-automl-libraries-to-automate-machine-learning-pipeline-3da0af08f636" rel="noopener follow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd iu gy z fp pc fr fs pd fu fw is bi translated">8个自动化机器学习管道的AutoML库</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">各种AutoML框架概述</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">medium.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl ks ox"/></div></div></a></div><h1 id="1bb1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考资料:</h1><p id="135d" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">[1] Auto-TS文档:【https://pypi.org/project/AutoTS/ T2】</p><blockquote class="pm"><p id="2d1b" class="pn po it bd pp pq pr ps pt pu pv lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>