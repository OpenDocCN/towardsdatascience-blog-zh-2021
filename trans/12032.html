<html>
<head>
<title>How RGB and Grayscale Images Are Represented in NumPy Arrays</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RGB和灰度图像如何在NumPy数组中表示</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploring-the-mnist-digits-dataset-7ff62631766a?source=collection_archive---------4-----------------------#2021-12-04">https://towardsdatascience.com/exploring-the-mnist-digits-dataset-7ff62631766a?source=collection_archive---------4-----------------------#2021-12-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dad2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们从图像基础开始</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab052a348f733ae06765ce3ebb6fd597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dt6WlkTYYkkJOlaF_-KPRw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供，用draw.io制作)</p></figure><p id="059b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天，你将学习机器学习和深度学习中一些最重要和最基本的主题。我保证今天的内容将提供一些对开始学习深度学习(机器学习的一个子集)至关重要的基本概念。</p><p id="d23e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们将开始描述图像基础知识，如像素、像素值、图像属性以及RGB和灰度图像之间的差异。然后我们将讨论如何在NumPy数组中表示这些图像。</p><p id="5830" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为奖励部分，我们将探索包含数千幅手写数字灰度图像的<a class="ae lu" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST数字数据集</a>(见底部引文)。这将有助于你进一步澄清你在图像的数字表示中学到的东西。</p><p id="4008" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，今天的内容将分为两个主要部分:</p><ul class=""><li id="e3f9" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated">图像基础——关键组件和表示</li><li id="c981" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">近距离观察MNIST数据集(可选)</li></ul><p id="a608" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从图像的基础开始。</p><h1 id="4ff9" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">图像基础</h1><h2 id="93fc" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">像素</h2><p id="f059" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">图像由微小的方形元素组成，这些元素被称为<em class="ns">像素</em>。即使是一个小图像也可能包含数百万个不同颜色的像素。</p><h2 id="291c" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">图像属性</h2><p id="750f" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">每个图像都有三个主要属性:</p><ul class=""><li id="419b" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">尺寸</strong> —这是一幅图像的高度和宽度。它可以用厘米、英寸甚至像素来表示。</li><li id="d13b" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu">色彩空间</strong> —例如<strong class="la iu"> RGB </strong>和<strong class="la iu"> HSV </strong>色彩空间。</li><li id="31fd" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu">通道</strong> —这是色彩空间的一个属性。例如，RGB颜色空间有三种类型的颜色或属性，称为<strong class="la iu"><em class="ns">R</em></strong><em class="ns">ed</em><strong class="la iu"><em class="ns">G</em></strong><em class="ns">reen</em>和<strong class="la iu"><em class="ns">B</em></strong><em class="ns">lue</em>(因此得名RGB)。</li></ul><h2 id="b0d0" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">RGB图像与灰度图像</h2><p id="cd14" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">区分RGB图像和灰度图像非常重要。RGB图像有三个颜色通道:红色通道、绿色通道和蓝色通道。但是，灰度图像只有一个通道。</p><h2 id="cbfa" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">像素值</h2><p id="db8b" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">图像的颜色由其像素值表示。一个像素只能有一种颜色，但可以合并以创建多种颜色。</p><p id="acc7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在只有一个通道的灰度图像中，像素值只有一个从0到255(包括0和255)的数字。像素值0表示黑色，像素值255表示白色。灰度图像中的像素值可以表示如下:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="b0be" class="nb mk it nu b gy ny nz l oa ob">[40]</span></pre><p id="638a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于值40接近0而不是255，所以像素的颜色也接近黑色！</p><p id="5ef3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在有三个颜色通道的RGB图像中，像素值有三个数字，每个数字的范围从0到255(包括0和255)。例如，红色通道中像素的数字0表示该像素中没有红色，而数字255表示该像素中有100%的红色。这种解释也适用于其他两个通道中的像素。RGB图像中的像素值可以表示如下:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="43b2" class="nb mk it nu b gy ny nz l oa ob">[255, 255, 0]</span></pre><p id="6ac4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个像素值代表黄色。看下图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/b34490a9c05ada9425d84762710b4ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*akS8GJ6wSeVW3t_kEiRWvw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae lu" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=154782" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的</p></figure><p id="ef7e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">黄色由绿色和红色组成。不涉及蓝色。这就是为什么像素值<code class="fe od oe of nu b">[255, 255, 0]</code>代表黄色像素——红色100% (255)，绿色100% (255)，没有蓝色(0)！</p><h1 id="cbe3" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">深度学习中的图像表示</h1><p id="14f1" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">在机器学习和深度学习中，图像被表示为NumPy数组。在深度学习的上下文中，那些NumPy数组在技术上叫做<strong class="la iu"> <em class="ns">张量</em> </strong> ( <a class="ae lu" href="https://medium.com/geekculture/lets-create-tensors-like-numpy-arrays-90a4cf32144" rel="noopener">学习创建类似NumPy数组的张量</a>)。</p><p id="d4c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当在NumPy数组中表示图像时，大多数人可能会感到困惑，因为涉及到多个维度。基本上，维度的数量由以下因素决定。</p><ul class=""><li id="47f5" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">图像尺寸</strong> —总是需要两个尺寸来表示图像的高度和宽度。</li><li id="d3fa" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu">颜色通道</strong></li><li id="e52b" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu">图像数量</strong></li></ul><h2 id="4578" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">作为NumPy阵列的灰度图像表示</h2><p id="7a4a" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">一个<em class="ns">单个</em>灰度图像可以用一个二维(2D)数字阵列或一个张量来表示。因为在灰度图像中只有一个通道，所以我们不需要额外的维度来表示颜色通道。这两个维度代表图像的高度和宽度。</p><p id="ef87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一批<em class="ns">3幅灰度图像可以使用三维(3D)数字阵列或张量来表示。这里，我们需要一个额外的维度来表示图像的数量。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/1b44f862f98697a535db93d01a601d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tdj28Gr41XAiC04yGWIiSA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供，用draw.io制作)</p></figure><p id="d532" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面三幅灰度图像的<em class="ns">批次</em>的形状可以表示为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/79f5aa65460f793ea1f3e140080065ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*oW1luwDVRSwQ4EC1MCPTuA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供，用draw.io制作)</p></figure><h2 id="a65a" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">作为NumPy数组的RGB图像表示</h2><p id="da72" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">一个<em class="ns">单个</em> RGB <em class="ns"> </em>图像可以使用三维(3D)数字阵列或张量来表示。由于RGB图像中有三个颜色通道，我们需要一个额外的颜色通道维度。</p><p id="185c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">三幅RGB图像的<em class="ns">批次</em>可以使用四维(4D) NumPy数组或张量来表示。这里，我们需要一个额外的维度来表示图像的数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab052a348f733ae06765ce3ebb6fd597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dt6WlkTYYkkJOlaF_-KPRw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供，用draw.io制作)</p></figure><p id="55d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上述3幅RGB图像的<em class="ns">批次</em>的形状可以用两种不同的方式表示:</p><ul class=""><li id="5282" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">通道-最后:</strong>这将把<em class="ns">颜色通道</em>轴放在最后。这是TensorFlow (Keras)和OpenCV中的标准。</li><li id="ec94" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu">通道优先:</strong>将<em class="ns">颜色通道</em>轴放置在<em class="ns">采样</em>轴之后。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6e5e104c57c40509be52cd9a3e64ed7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*_R8Blm_RUPrQyrNs0Idj6Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供，用draw.io制作)</p></figure><blockquote class="oj ok ol"><p id="ec86" class="ky kz ns la b lb lc ju ld le lf jx lg om li lj lk on lm ln lo oo lq lr ls lt im bi translated"><strong class="la iu">要点:</strong>通道-最后符号是将RGB图像表示为NumPy数组的标准符号。</p></blockquote><p id="0322" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">图像基础及其数值表示的足够理论。让我们开始探索MNIST数字数据集。</p><h1 id="879a" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">近距离观察MNIST数据集(可选)</h1><p id="c9a4" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">由<a class="ae lu" href="https://www.nist.gov/" rel="noopener ugc nofollow" target="_blank"> NIST </a>(美国国家标准与技术研究院)构建的<a class="ae lu" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST数字数据集</a>(见底部引文)，是学习深度学习的经典数据集，也是通用机器学习的经典数据集。它已经被机器学习和深度学习社区过度使用了。然而，仍然值得探索和使用这个数据集，特别是如果你打算第一次接触深度学习的话。</p><p id="e634" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">MNIST数据集包含10个类别(0到9)下的70，000幅手写数字的灰度图像。我们将使用两个流行的API来加载数据集:<strong class="la iu"> Keras API </strong>和<strong class="la iu"> Scikit-learn API </strong>。两者都提供了用于轻松加载MNIST数据集的实用函数。我们还将讨论MNIST数据集的两个API之间的差异。</p><h2 id="0330" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">使用Keras API加载MNIST数据集</h2><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="926a" class="nb mk it nu b gy ny nz l oa ob">from tensorflow.keras.datasets import mnist</span><span id="1fe5" class="nb mk it nu b gy op nz l oa ob">(train_images, train_labels), (test_images, test_labels) = mnist.load_data()</span></pre><p id="aa4a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">获取数据的形状</strong></p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="d4c3" class="nb mk it nu b gy ny nz l oa ob">print("Train images shape:", train_images.shape)<br/>print("Train labels shape:", train_labels.shape)<br/>print("Test images shape: ", test_images.shape)<br/>print("Test labels shape: ", test_labels.shape)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/d6f005b2d0478e20590778a75890680b.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*Uf6tkh-IgIwRzjiO3bYO1g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="6703" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">成批的训练和测试图像是三维的。这是因为MNIST数据集包含灰度图像，而不是RGB图像。(60000，28，28)表示训练图像集包含60，000张28 x 28像素的图像。换句话说，它是一个包含60，000个28 x 28整数值的矩阵的数组。</p><p id="67c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练和测试标签是一维的。它们包含10个类别(0到9)的相应标签。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="07d4" class="nb mk it nu b gy ny nz l oa ob">import numpy as np</span><span id="6cbc" class="nb mk it nu b gy op nz l oa ob">np.unique(test_labels)<br/>#OR<br/>np.unique(train_labels)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/d471d565331570cd045954c71e8b25e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*DNsODKL9gQ_1v7mGQmD2mA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f837" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">获取数组类型</strong></p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="87ee" class="nb mk it nu b gy ny nz l oa ob">print("Train images type:", type(train_images))<br/>print("Train labels type:", type(train_labels))<br/>print("Test images type: ", type(test_images))<br/>print("Test labels type: ", type(test_labels))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/4607e9413d380e0870785efdfbe71ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*3N-wHWrEJMIRSF4RKbr6bA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="eb0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">都是NumPy数组。</p><p id="974c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">获取数据类型</strong></p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="a168" class="nb mk it nu b gy ny nz l oa ob">print("Train images data type:", train_images.dtype)<br/>print("Train labels data type:", train_labels.dtype)<br/>print("Test images data type: ", test_images.dtype)<br/>print("Test labels data type: ", test_labels.dtype)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/c64e9b9b0707d61d11ba899a34b69a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*FisenqeFTzeYuazgDfXPGg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="ea5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">像素值的数据类型为<strong class="la iu">“uint 8”</strong>，表示8位整数。</p><p id="eb2c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">从列车图像集中获取单张图像</strong></p><p id="965d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可以使用以下符号访问训练集中的单个图像:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="537d" class="nb mk it nu b gy ny nz l oa ob">train_images[i]</span></pre><p id="26e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该索引从0开始。为了得到第10幅图像，我们应该使用i=9。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="5542" class="nb mk it nu b gy ny nz l oa ob">train_images[9]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/44e05b4367fccc28f004c602b71e224c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*Xf-g4tozEZpyByAmYhkfoQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数组的一部分(图片由作者提供)</p></figure><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="30ec" class="nb mk it nu b gy ny nz l oa ob">train_images[9].shape</span></pre><p id="2d0d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个28 x 28的灰度图像矩阵。</p><p id="5974" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">可视化单幅图像</strong></p><p id="5780" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将可视化训练数据集的第10幅图像。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="d042" class="nb mk it nu b gy ny nz l oa ob">import matplotlib.pyplot as plt</span><span id="22ce" class="nb mk it nu b gy op nz l oa ob">tenth_digit = train_images[9]<br/>plt.imshow(tenth_digit, cmap="binary")<br/>plt.axis("off")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/a3a384c998cea79c7b36860e7e9fcd24.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*Iet8wUdxCDGM2eEXE34kVQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="a835" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练集的第10个图像代表数字4。通过看其对应的标签来看是否正确。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="0f5b" class="nb mk it nu b gy ny nz l oa ob">train_labels[9]</span></pre><p id="2837" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这也返回4。因此，图像与其标签是对应的。</p><h2 id="d488" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">使用Scikit-learn API加载MNIST数据集</h2><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="d7e4" class="nb mk it nu b gy ny nz l oa ob">from sklearn.datasets import fetch_openml</span><span id="82f0" class="nb mk it nu b gy op nz l oa ob">mnist = fetch_openml('mnist_784', version=1)</span><span id="a08a" class="nb mk it nu b gy op nz l oa ob">X, y = mnist['data'], mnist['target']</span></pre><p id="2921" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">获取数据的形状</strong></p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="bb22" class="nb mk it nu b gy ny nz l oa ob">print("X shape:", X.shape)<br/>print("y shape:", y.shape)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/dfbc01800c67e605f69bbb5c476fda9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*x3-7yCOAyS-dWP4eUJyxYg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="eabb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">单个图像的像素值排列在大小为784的一维向量中，该向量等于28×28。这意味着我们仍然可以像在Keras API中一样对矢量进行整形，以获得图像所需的格式。</p><p id="3162" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">获取数组类型</strong></p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="55a0" class="nb mk it nu b gy ny nz l oa ob">print("X type:", type(X))<br/>print("y type:", type(y))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/17e89782b4a42cf28627a65f8ca00e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*1lre9_7GuA09nr1rmJMlaA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="2fe5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">获取数据类型</strong></p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="4a18" class="nb mk it nu b gy ny nz l oa ob">print("X data type:", X.dtypes)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/52e0525c64d359df713f6a37456e6025.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*xnTVwtnFePcnQoKDy4mbLQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="ddbb" class="nb mk it nu b gy ny nz l oa ob">print("y data type:", y.dtypes)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/ad4fbb9ff8916b843f0ebf56f4edb133.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*RIRKWPl4LCMOzqGX756XjQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="c181" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">MNIST数据集的两个API之间的差异</h2><ul class=""><li id="f1c7" class="lv lw it la b lb nn le no lh pa ll pb lp pc lt ma mb mc md bi translated"><strong class="la iu">训练和测试集:</strong>在Kears中，MNIST数据集可以加载训练和测试集。但是在Scikit-learn中，我们需要手动创建训练和测试部件。</li><li id="b877" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu"> Shape: </strong>在Keras中，单个MNIST数字由大小为28 x 28的二维NumPy数组表示。在Scikit-learn中，单个MNIST数字由大小为784的一维NumPy数组表示。我们需要明确地将数组重新整形为28 x 28的数组。</li><li id="d619" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu">数组类型:</strong>在Kears中，图像和标签由NumPy数组重复。在Scikit-learn中，图像由熊猫数据帧重复，而标签由熊猫系列表示。</li><li id="5294" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu">数据类型:</strong>在Kears中，像素值和标签的数据类型为<strong class="la iu">“uint 8”</strong>，表示8位整数。在Scikit-learn中，像素值的数据类型为<strong class="la iu"> "float64" </strong>，标签的数据类型为" category "，在用于以下算法之前，应将其转换为<strong class="la iu"> "uint8" </strong>。</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="d306" class="nb mk it nu b gy ny nz l oa ob">y = y.astype(np.uint8)</span></pre><blockquote class="oj ok ol"><p id="1ab2" class="ky kz ns la b lb lc ju ld le lf jx lg om li lj lk on lm ln lo oo lq lr ls lt im bi translated"><strong class="la iu">重要提示:</strong>如果你使用MNIST数据集进行深度学习，我建议你使用Keras API加载数据。</p></blockquote></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><h2 id="5ced" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">阅读下一篇(强烈推荐)</h2><p id="8777" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">学习创建类似NumPy数组的张量。</p><div class="pk pl gp gr pm pn"><a href="https://medium.com/geekculture/lets-create-tensors-like-numpy-arrays-90a4cf32144" rel="noopener follow" target="_blank"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd iu gy z fp ps fr fs pt fu fw is bi translated">让我们创建类似NumPy数组的张量</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">张量只不过是多维数组的矩阵表示</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">medium.com</p></div></div><div class="pw l"><div class="px l py pz qa pw qb ks pn"/></div></div></a></div><p id="1ed5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">学习NumPy基础知识和数组创建。</p><div class="pk pl gp gr pm pn"><a rel="noopener follow" target="_blank" href="/numpy-for-data-science-part-1-21e2c5ddbbd3"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd iu gy z fp ps fr fs pt fu fw is bi translated">数据科学的NumPy:第1部分</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">NumPy基础和数组创建</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">towardsdatascience.com</p></div></div><div class="pw l"><div class="qc l py pz qa pw qb ks pn"/></div></div></a></div><p id="eb42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">像专家一样分割NumPy数组。</p><div class="pk pl gp gr pm pn"><a href="https://rukshanpramoditha.medium.com/numpy-for-data-science-part-2-7399ffc605e5" rel="noopener follow" target="_blank"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd iu gy z fp ps fr fs pt fu fw is bi translated">NumPy数组索引和切片的完整分步指南</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">数据科学的数字——第二部分</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">rukshanpramoditha.medium.com</p></div></div><div class="pw l"><div class="qd l py pz qa pw qb ks pn"/></div></div></a></div><h2 id="43ae" class="nb mk it bd ml nc nd dn mp ne nf dp mt lh ng nh mv ll ni nj mx lp nk nl mz nm bi translated">阅读下一页(可选)</h2><p id="46fe" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">使用PCA压缩图像！</p><div class="pk pl gp gr pm pn"><a rel="noopener follow" target="_blank" href="/image-compression-using-principal-component-analysis-pca-253f26740a9f"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd iu gy z fp ps fr fs pt fu fw is bi translated">使用主成分分析(PCA)的图像压缩</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">行动中的维度缩减</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">towardsdatascience.com</p></div></div><div class="pw l"><div class="qe l py pz qa pw qb ks pn"/></div></div></a></div></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><p id="2f47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天的帖子到此结束。</p><p id="8835" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您有任何反馈，请告诉我。</p><p id="1e23" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同时，你可以<a class="ae lu" href="https://rukshanpramoditha.medium.com/membership" rel="noopener"> <strong class="la iu">注册成为会员</strong> </a>来获得我写的每一个故事，我会收到你的一部分会员费。</p><p id="0b96" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">非常感谢你一直以来的支持！下一个故事再见。祝大家学习愉快！</p><p id="1e71" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> MNIST数字数据集引用:</strong></p><p id="91d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">邓，2012年。用于机器学习研究的手写数字图像mnist数据库。<strong class="la iu"> IEEE信号处理杂志</strong>，29(6)，第141–142页。</p><p id="949c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> MNIST数字数据集来源:</strong></p><p id="fdfd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank">http://yann.lecun.com/exdb/mnist/</a></p><p id="2931" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> MNIST数字数据集许可证:</strong></p><p id="d9c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"><em class="ns">Yann le Cun</em></strong>(NYU库朗研究所)和<strong class="la iu"><em class="ns">Corinna Cortes</em></strong>(纽约谷歌实验室)持有MNIST数据集的版权，该数据集根据<a class="ae lu" href="https://creativecommons.org/licenses/by-sa/3.0/" rel="noopener ugc nofollow" target="_blank">知识共享署名-同样分享3.0许可证</a>的条款提供。</p><p id="ec96" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="qf qg ep" href="https://medium.com/u/f90a3bb1d400?source=post_page-----7ff62631766a--------------------------------" rel="noopener" target="_blank">鲁克山普拉莫迪塔</a><br/><strong class="la iu">2021–12–04</strong></p></div></div>    
</body>
</html>