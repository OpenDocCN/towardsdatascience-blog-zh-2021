<html>
<head>
<title>SQL — DELETE INTO another table</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL —删除到另一个表中</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sql-delete-into-another-table-b5b946a42299?source=collection_archive---------15-----------------------#2021-05-20">https://towardsdatascience.com/sql-delete-into-another-table-b5b946a42299?source=collection_archive---------15-----------------------#2021-05-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4675" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在一条语句中删除一个表中的记录，并将它们插入到另一个表中</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b93b070d6fefb2b8938a0942b0dbe2e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KFUgR2wgElZKNm4RaKfdlw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">把这个虎尾兰从一个锅里删除到另一个锅里！(图片由<a class="ae ky" href="https://www.pexels.com/photo/green-plant-on-brown-clay-pot-4503267/" rel="noopener ugc nofollow" target="_blank">像素</a>上的<a class="ae ky" href="https://www.pexels.com/@cottonbro" rel="noopener ugc nofollow" target="_blank"> Cottonbro </a>拍摄)</p></figure><p id="7566" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“我为什么需要这样的查询？”一个<strong class="lb iu">删除成</strong>语句是有利的，主要有两个原因:</p><ul class=""><li id="daf5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">语句是<a class="ae ky" href="https://en.wikipedia.org/wiki/Atomicity_(database_systems)" rel="noopener ugc nofollow" target="_blank">原子</a>；要么两者都发生，要么什么都不发生，即如果删除或插入失败，它将回滚更改。</li><li id="3116" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">它更便宜:你的数据库只需要查找一次记录。或者，执行单独的插入和删除需要两次查找</li><li id="10a7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">吹牛的权利:给你的老板和同事留下深刻印象</li></ul><p id="1d91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">深信不疑？“给我看一些代码！”。好的，但是首先我们必须设置一些表来演示查询。让我们编码:</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="11d0" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">设置:创建一些包含数据的表</h1><p id="5d58" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">作为一个例子，我们假设我们有一个有很多流程的公司。每个进程都将其错误记录到一个名为ErrorMessages的表中，以便进行跟踪。一旦一个错误被解决，过期或者不再相关，我们可以从错误消息中删除它。不过，我们希望保存错误信息，这样我们以后就可以分析哪个进程失败得最多。为此，我们将创建ErrorMessageBackup。我们的目标是将ErrorMessages删除到ErrorMessageBackup表中。让我们首先创建我们的表，并将一些数据插入到我们的错误消息中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用一些记录创建我们的表</p></figure><p id="64c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过执行这些查询，我们看到ErrorMessages表的内容如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/31ef33adc44294cab6c37f83961a5c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*ah8d8a_yHMQ1UzatEaUN4w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的错误消息表</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="0bf1" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">执行我们的查询</h1><p id="0e88" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">这是魔法开始的地方。我们想从数据库中删除404错误。让我们检查一下我们的查询，然后再深入一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的删除查询</p></figure><p id="356e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的目标是Id为1的错误消息。我们将它保存在@targetId变量中。然后我们从ErrorMessages表中删除，过滤这个Id。使用输出，我们可以访问已经删除的列。我们将这些列以及一个额外的列输出到ErrorMessageBackup表中。</p><p id="f252" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！一个简单、安全的查询，允许您一次执行两个查询。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="6987" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="c4e4" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">通过这个查询，我们可以执行原子操作，从一个表中删除记录，并允许我们将它们插入到另一个表中。另请查看:</p><ul class=""><li id="e278" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/sql-update-into-another-table-bfc3dff79a66" rel="noopener">更新到另一个标签页</a> le</li><li id="7204" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/sql-rolling-back-statements-with-transactions-81937811e7a7" rel="noopener">使用交易撤销查询</a></li><li id="c5c4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/sql-insert-delete-and-update-in-one-statement-sync-your-tables-with-merge-14814215d32c" rel="noopener">在一条语句中插入、删除和更新</a></li><li id="49ec" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/sql-update-select-in-one-query-b067a7e60136" rel="noopener">更新选择一批记录</a></li><li id="6263" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/version-control-your-database-part-1-creating-migrations-and-seeding-992d86c90170" rel="noopener">版本控制你的数据库</a></li></ul><p id="7152" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://mikehuls.medium.com/sql-update-into-another-table-bfc3dff79a66" rel="noopener">这篇</a> <strong class="lb iu"> </strong>文章向您展示了如何更新到表格中。编码快乐！</p><p id="3a33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">—迈克</p><p id="b381" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">页（page的缩写）学生:比如我正在做的事情？<a class="ae ky" href="https://mikehuls.medium.com/" rel="noopener">跟我来</a>！</p></div></div>    
</body>
</html>