<html>
<head>
<title>How to Combine Two String Columns in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在熊猫中组合两个字符串列</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/combine-two-string-columns-pandas-fde0287485d9?source=collection_archive---------4-----------------------#2021-11-09">https://towardsdatascience.com/combine-two-string-columns-pandas-fde0287485d9?source=collection_archive---------4-----------------------#2021-11-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="3393" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">了解如何在 pandas 数据框架中更有效地将两个字符串列连接成一个新列</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/fa7a1b7d56f2966da972b6cf6528d405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vOF5Jj0CSMWexMGRHy1qCg.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">帕斯卡·米勒在<a class="ae kz" href="https://unsplash.com/s/photos/pandas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="e792" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">通过连接其他列来创建新列是一项相当常见的任务。在今天的简短指南中，我们将展示如何将 string DataFrame 列的内容连接成一个新列。我们将探讨几个不同的选项，您应该始终根据您正在处理的数据集大小来考虑这些选项。</p><p id="8f1b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">这些方法中的一些在应用于小数据集时往往更有效，而其他方法在应用于大数据集时可能执行得更快。</p><p id="76c3" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，我们还将探索如何将字符串与非字符串(例如整数)列连接起来。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="2082" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们创建一个示例数据框架，我们将在本文中引用它来演示一些概念。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="5335" class="la lb iu nc b gz ng nh l ni nj">import pandas as pd</span><span id="95de" class="la lb iu nc b gz nk nh l ni nj">df = pd.DataFrame(<br/>  [<br/>    (1, '2017', 10, 'Q1'),<br/>    (2, '2017', 20, 'Q2'),<br/>    (3, '2016', 35, 'Q4'),<br/>    (4, '2019', 25, 'Q2'),<br/>    (5, '2020', 44, 'Q3'),<br/>    (6, '2021', 51, 'Q3'),<br/>  ], <br/>  columns=['colA', 'colB', 'colC', 'colD']<br/>)</span><span id="6145" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><em class="nl">   colA  colB  colC colD<br/>0     1  2017    10   Q1<br/>1     2  2017    20   Q2<br/>2     3  2016    35   Q4<br/>3     4  2019    25   Q2<br/>4     5  2020    44   Q3<br/>5     6  2021    51   Q3</em></span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="78f7" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">在小型数据集中串联字符串列</h2><p id="65f6" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">对于相对较小的数据集(最多 100–150 行)，您可以使用<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.cat.html" rel="noopener ugc nofollow" target="_blank">pandas.Series.str.cat()</a></code>方法，该方法用于使用指定的分隔符(默认情况下分隔符设置为<code class="fe nm nn no nc b">''</code>)连接序列中的字符串。</p><p id="eddf" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">例如，如果我们想将列<code class="fe nm nn no nc b">colB</code>和<code class="fe nm nn no nc b">colD</code>连接起来，然后将输出存储到一个名为<code class="fe nm nn no nc b">colE</code>的新列中，下面的语句就可以做到:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="1fe1" class="la lb iu nc b gz ng nh l ni nj"><strong class="nc iv">df['colE'] = df.colB.str.cat(df.colD) </strong></span><span id="ee8e" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><em class="nl">   colA  colB  colC colD    </em><strong class="nc iv"><em class="nl">colE</em></strong><em class="nl"><br/>0     1  2017    10   Q1  </em><strong class="nc iv"><em class="nl">2017Q1</em></strong><em class="nl"><br/>1     2  2017    20   Q2  </em><strong class="nc iv"><em class="nl">2017Q2</em></strong><em class="nl"><br/>2     3  2016    35   Q4  </em><strong class="nc iv"><em class="nl">2016Q4</em></strong><em class="nl"><br/>3     4  2019    25   Q2  </em><strong class="nc iv"><em class="nl">2019Q2</em></strong><em class="nl"><br/>4     5  2020    44   Q3  </em><strong class="nc iv"><em class="nl">2020Q3</em></strong><em class="nl"><br/>5     6  2021    51   Q3  </em><strong class="nc iv"><em class="nl">2021Q3</em></strong></span></pre><p id="b380" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在，如果我们想要指定一个将被放置在连接的列之间的分隔符，那么我们只需要传递<code class="fe nm nn no nc b">sep</code>参数:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="2df4" class="la lb iu nc b gz ng nh l ni nj"><strong class="nc iv">df['colE'] = df.colB.str.cat(df.colD, sep='-')</strong></span><span id="37c3" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><em class="nl">   colA  colB  colC colD     </em><strong class="nc iv"><em class="nl">colE</em></strong><em class="nl"><br/>0     1  2017    10   Q1  </em><strong class="nc iv"><em class="nl">2017-Q1</em></strong><em class="nl"><br/>1     2  2017    20   Q2  </em><strong class="nc iv"><em class="nl">2017-Q2</em></strong><em class="nl"><br/>2     3  2016    35   Q4  </em><strong class="nc iv"><em class="nl">2016-Q4</em></strong><em class="nl"><br/>3     4  2019    25   Q2  </em><strong class="nc iv"><em class="nl">2019-Q2</em></strong><em class="nl"><br/>4     5  2020    44   Q3  </em><strong class="nc iv"><em class="nl">2020-Q3</em></strong><em class="nl"><br/>5     6  2021    51   Q3  </em><strong class="nc iv"><em class="nl">2021-Q3</em></strong></span></pre><p id="6687" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">或者，你也可以使用列表理解，这种理解稍微有点冗长，但速度稍快:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="ca35" class="la lb iu nc b gz ng nh l ni nj"><strong class="nc iv">df['colE'] = </strong><strong class="nc iv">[''.join(i) for i in zip(df['colB'], df['colD'])]</strong></span><span id="efed" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><em class="nl">   colA  colB  colC colD    </em><strong class="nc iv"><em class="nl">colE</em></strong><em class="nl"><br/>0     1  2017    10   Q1  </em><strong class="nc iv"><em class="nl">2017Q1</em></strong><em class="nl"><br/>1     2  2017    20   Q2  </em><strong class="nc iv"><em class="nl">2017Q2</em></strong><em class="nl"><br/>2     3  2016    35   Q4  </em><strong class="nc iv"><em class="nl">2016Q4</em></strong><em class="nl"><br/>3     4  2019    25   Q2  </em><strong class="nc iv"><em class="nl">2019Q2</em></strong><em class="nl"><br/>4     5  2020    44   Q3  </em><strong class="nc iv"><em class="nl">2020Q3</em></strong><em class="nl"><br/>5     6  2021    51   Q3  </em><strong class="nc iv"><em class="nl">2021Q3</em></strong></span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="ef21" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">在较大的数据集中串联字符串列</h2><p id="1a26" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在，如果您正在处理大型数据集，连接两列的更有效方法是使用<code class="fe nm nn no nc b">+</code>操作符。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="e47a" class="la lb iu nc b gz ng nh l ni nj"><strong class="nc iv">df['colE'] = df['colB'] + df['colD']</strong></span><span id="f13a" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><em class="nl">   colA  colB  colC colD    </em><strong class="nc iv"><em class="nl">colE<br/></em></strong><em class="nl">0     1  2017    10   Q1  </em><strong class="nc iv"><em class="nl">2017Q1</em></strong><em class="nl"><br/>1     2  2017    20   Q2  </em><strong class="nc iv"><em class="nl">2017Q2</em></strong><em class="nl"><br/>2     3  2016    35   Q4  </em><strong class="nc iv"><em class="nl">2016Q4</em></strong><em class="nl"><br/>3     4  2019    25   Q2  </em><strong class="nc iv"><em class="nl">2019Q2</em></strong><em class="nl"><br/>4     5  2020    44   Q3  </em><strong class="nc iv"><em class="nl">2020Q3</em></strong><em class="nl"><br/>5     6  2021    51   Q3  </em><strong class="nc iv"><em class="nl">2021Q3</em></strong></span></pre><p id="68ce" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">如果您想要包含分隔符，只需将其作为字符串放在两列之间即可:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="22fe" class="la lb iu nc b gz ng nh l ni nj"><strong class="nc iv">df['colE'] = df['colB'] + '-' + df['colD']</strong></span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="c539" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">连接字符串和非字符串列</h2><p id="d295" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在让我们假设您尝试连接的列之一不是字符串格式:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="4923" class="la lb iu nc b gz ng nh l ni nj">import pandas as pd</span><span id="4141" class="la lb iu nc b gz nk nh l ni nj">df = pd.DataFrame(<br/>  [<br/>    (1, <strong class="nc iv">2017</strong>, 10, <strong class="nc iv">'Q1'</strong>),<br/>    (2, <strong class="nc iv">2017</strong>, 20, <strong class="nc iv">'Q2'</strong>),<br/>    (3, <strong class="nc iv">2016</strong>, 35, <strong class="nc iv">'Q4'</strong>),<br/>    (4, <strong class="nc iv">2019</strong>, 25, <strong class="nc iv">'Q2'</strong>),<br/>    (5, <strong class="nc iv">2020</strong>, 44, <strong class="nc iv">'Q3'</strong>),<br/>    (6, <strong class="nc iv">2021</strong>, 51, <strong class="nc iv">'Q3'</strong>),<br/>  ], <br/>  columns=['colA', 'colB', 'colC', 'colD']<br/>)</span><span id="5242" class="la lb iu nc b gz nk nh l ni nj">print(df.dtypes)</span><span id="a2e9" class="la lb iu nc b gz nk nh l ni nj"><em class="nl">colA     int64<br/>colB     int64<br/>colC     int64<br/>colD    object<br/>dtype: object</em></span></pre><p id="71d6" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在这种情况下，您可以简单地使用<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.astype.html" rel="noopener ugc nofollow" target="_blank">pandas.DataFrame.astype()</a></code>或<code class="fe nm nn no nc b">map()</code>方法来转换列。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="4fd1" class="la lb iu nc b gz ng nh l ni nj"># Option 1<br/><strong class="nc iv">df['colE'] = df.colB.astype(str).str.cat(df.colD)</strong></span><span id="2022" class="la lb iu nc b gz nk nh l ni nj"># Option 2<br/><strong class="nc iv">df['colE'] = df['colB'].astype(str) + '-' + df['colD']</strong></span><span id="db40" class="la lb iu nc b gz nk nh l ni nj"># Option 3<br/><strong class="nc iv">df['colE'] = </strong><strong class="nc iv">[<br/>  ''.join(i) for i in zip(df['colB'].map(str), df['colD'])<br/>]</strong></span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短指南中，我们讨论了在 pandas 数据帧中连接字符串列。根据您正在使用的数据集的大小，您可能需要选择执行效率更高的最合适的方法。</p><p id="88e1" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，我们还展示了如何利用 pandas 中的<code class="fe nm nn no nc b">astype()</code>方法连接字符串和非字符串列。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读媒体上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="np nq gq gs nr ns"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">通过我的推荐链接加入 Medium-Giorgos Myrianthous</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">你可能也会喜欢</strong></p><div class="np nq gq gs nr ns"><a rel="noopener follow" target="_blank" href="/how-to-efficiently-convert-a-pyspark-dataframe-to-pandas-8bda2c3875c3"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">加快 PySpark 和 Pandas 数据帧之间的转换</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">将大型 Spark 数据帧转换为熊猫时节省时间</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/how-to-upload-your-python-package-to-pypi-de1b363a1b3"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何将 Python 包上传到 PyPI</h2><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og kt ns"/></div></div></a></div></div></div>    
</body>
</html>