<html>
<head>
<title>Kalman Filtering: A Simple Introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卡尔曼滤波:简单介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/kalman-filtering-a-simple-introduction-df9a84307add?source=collection_archive---------9-----------------------#2021-10-04">https://towardsdatascience.com/kalman-filtering-a-simple-introduction-df9a84307add?source=collection_archive---------9-----------------------#2021-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d781" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">一个机器学习必须知道</h2><div class=""/><div class=""><h2 id="4649" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">高斯噪声下线性系统的最优在线学习算法</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/fff751eb6ed08d17937bd51fb6b30643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9W0uQgQCvHEF3Rn6H4UbJw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">戈罗登科夫在<a class="ae lh" href="https://www.shutterstock.com/image-photo/industry-40-two-engineers-standing-talking-1821601769" rel="noopener ugc nofollow" target="_blank">摄影站</a>拍摄的照片</p></figure><p id="398e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">如果动态系统是线性的且带有高斯噪声，则隐藏状态的最优估计器是卡尔曼滤波器。</strong></p><p id="0f7c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种在线学习算法是机器学习世界基础的一部分。在理解粒子过滤器等更复杂的主题之前，很好地理解它是很重要的。</p><p id="01e6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将从卡尔曼滤波器的一个示例应用开始，然后我将描述算法本身，我将把它应用于一些简单的合成数据，最后，我将展示卡尔曼滤波器失败的地方。</p><h1 id="e840" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">应用示例</h1><p id="e64f" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在工程领域，卡尔曼滤波器是减少传感器信号噪声的最常见模型之一。正如我们将会发现的，当数据中的噪声大致为高斯型时，这些模型非常有用。</p><p id="4193" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">尽管卡尔曼滤波器是一种强大的降噪工具，但它还可以有更多用途，下面是一个例子:</p><p id="0cb5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设我们有一个喷气发动机，它的一个部件上有一条疲劳裂纹。我们正试图用这种部件上的应力传感器来监控裂纹长度。</p><p id="dd5b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们假设我们在每一种情况下都有裂缝的测量值。我们还假设裂纹长度随应力线性增长(实际上根据巴黎定律，实际上是裂纹扩展速率的对数随应力强度因子的对数线性增长)。</p><p id="aaa4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">卡尔曼滤波器涉及以下变量:</p><ul class=""><li id="bbff" class="nb nc it lk b ll lm lo lp lr nd lv ne lz nf md ng nh ni nj bi translated">z:观察变量(我们试图预测的)</li><li id="c72d" class="nb nc it lk b ll nk lo nl lr nm lv nn lz no md ng nh ni nj bi translated">x:隐藏状态变量(我们用来预测Z的变量，理想情况下与Z成线性关系)</li></ul><p id="0225" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我们的例子中，观察变量是裂纹长度。我们隐藏的状态变量是压力。由于我们假设<strong class="lk jd">两者之间存在线性关系</strong>，并且如果我们假设噪声是高斯噪声，<strong class="lk jd">最佳估计器是卡尔曼滤波器！</strong></p><h1 id="6956" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">卡尔曼滤波器</h1><p id="8b0d" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">卡尔曼滤波器是一种在线学习算法。随着新数据的到来，该模型会按顺序更新其对权重的估计。记录方程式中下标的符号。当前时间步长被表示为n(我们想要对其进行预测的时间步长)。</p><h2 id="66ea" class="np mf it bd mg nq nr dn mk ns nt dp mo lr nu nv mq lv nw nx ms lz ny nz mu iz bi translated">以前的状态</h2><p id="d184" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">卡尔曼滤波器的最终目标是通过对隐藏状态变量x进行最佳估计来预测观察变量Z的下一次观察。然后，可以通过使用x对其进行重构来预测Z的下一次观察。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/37ba960af9c49ab99947eaad332e4056.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*07Gj0Y86CNrVSWN7OhSedQ.png"/></div></figure><p id="4097" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">观察变量Z的估计由隐藏状态x的线性变换H给出。下标n表示当前时间步长。Xn|n-1表示给定直到n-1的数据时在时间步长n的隐藏状态X的估计。</p><p id="2517" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据时间步长n处Z的估计值，我们可以用公式表示新息:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/dcbfe9220c56946d48ff33677a440b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*M1dyMTwT8s-PXNBhrSz_Fw.png"/></div></figure><p id="52c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">新息Y是下一个观察状态的预测和下一个状态的真实观察之间的差。</p><p id="58ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了估计隐藏状态X，卡尔曼滤波器假设从隐藏状态到观察变量的转换具有高斯噪声。在喷气发动机的例子中，测量装置可能由于裂纹长度的不准确测量而给系统增加噪声。这些误差被假定为高斯误差。</p><p id="1197" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，每次新的观察值出现时，模型都会估计隐藏状态X，并继续估计不确定性p。它们一起参数化了观察变量估计值的概率密度函数。下一时间步的预测观测值将是最大似然估计值(平均值)。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/c9678ff4ecc3ec6c3b93b13321c5a5b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*JbYqO0olsrjm8FqqmXJZqQ.png"/></div></figure><p id="c894" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第一个等式显示了给定前一隐藏状态时对隐藏状态的估计。f是从前一状态估计到当前状态估计的转换函数。</p><p id="702c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第二个方程是不确定性p的更新估计，这是协方差矩阵，它是前一个状态的协方差矩阵的函数。</p><h2 id="15ab" class="np mf it bd mg nq nr dn mk ns nt dp mo lr nu nv mq lv nw nx ms lz ny nz mu iz bi translated"><strong class="ak">状态更新方程</strong></h2><p id="ea39" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">到目前为止，我们已经公式化了给定数据直到前一时间步的状态(状态n|n-1)。给定我们在时间步长n(STATE n | n)接收到的新数据点，我们想要为新状态制定一个更新。</p><p id="7918" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">通过最小化均方误差，可以导出时间步长n的隐藏状态X和协方差P的最佳更新。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/e132c9838759d76c9d6568025dee7662.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*7Dgoh2hFY57IR0W_KYeXIg.png"/></div></figure><p id="2fd6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/679e7b316bbfa5514a72a0c623bf39f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*hTVQaSisw6-2-F5P6dFjEg.png"/></div></figure><p id="7008" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第一个等式是给定所有数据的隐藏状态n的更新。更新的X由权重的先前估计加上增益项乘以新息给出。这与递归最小二乘(RLS)在线学习算法中的更新结构相同。</p><p id="8b82" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">时间步长n处的卡尔曼增益K由不确定性P的先前估计、线性函数H和新息协方差s的倒数给出</p><p id="2e4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有了这些方程，我们现在可以实现我们自己的卡尔曼滤波器。</p><h1 id="6096" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">示例实现</h1><p id="cdae" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">将使用简单的自回归时间序列数据。卡尔曼滤波器将被实现并用于估计隐藏状态X，然后预测z的下一个观测值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1a9a8b169608baf901b4a48b92262907.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*oQ9dLbv0DlB02EU3azeaDQ.png"/></div></figure><p id="f921" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面看到的自回归时间序列的阶数将设为2。v(n)表示添加到系统中的白噪声。使用随机初始化的权重a，自回归时间序列通过将前两个点乘以权重来生成新点。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi og"><img src="../Images/1c98fcb07d418a8fb053a5cfdec6abbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kj-SFMyYP-tPMHMaqBiURQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="320f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以上是对隐藏状态x的估计。真实值显示为红色，卡尔曼估计显示为蓝色。如你所见，模型很快收敛到隐藏状态的近似值。由于加到信号中的高斯噪声，该模型从未完美地估计它。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/77f5c3ea4adbf25b5bc10b4827493bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-hhrv_ai4ZJFuvt079meEA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="5cfa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">经过200次左右的观测后，模型可以准确地估计出未来的观测变量Z。卡尔曼滤波器和其他在线学习算法最令人印象深刻的是它们的收敛速度。</p><h1 id="6896" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">当卡尔曼滤波器失效时</h1><p id="7e41" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">到目前为止，我们假设隐藏状态和观察状态之间的关系是线性的，我们看到这个模型工作得相当好。但是当我们把这种关系变成非线性关系时会发生什么。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/a81db8d66d2d4d87c18e95aad3478a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eeu7WescwgB5JPkzFU4Riw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="8cc0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这些是隐藏状态X之一的卡尔曼滤波器的估计，该隐藏状态X以正弦波的形式随时间变化。该模型未能生成隐藏状态x的良好估计。此外，预测似乎落后于真实值。</p><p id="de34" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在前面看到的方程中，有两个超参数我没有提到。q是过程噪声协方差，R是测量噪声方差。通过调整R，我们可以使模型更快地适应隐藏状态的变化。调整Q允许控制模型对过程噪声的敏感程度。</p><p id="523d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">即使调整了这些超参数，您也可以看到模型滞后于隐藏状态变量的变化，从而使其预测不太好。卡尔曼滤波器是线性系统的最佳算法，但是当隐藏状态变量和观察变量之间存在非线性关系时，这些模型往往表现不佳。</p><h1 id="1fa1" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">结论</h1><p id="5458" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">卡尔曼滤波器非常强大，广泛用于各种领域，尤其是工程应用中的信号处理。</p><p id="ac5d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上一篇文章中，我描述了一种最简单的在线学习算法，递归最小二乘(RLS)算法。卡尔曼滤波器将RLS算法向前推进了一步，它假设系统中存在高斯噪声。预测时，卡尔曼滤波器估计隐藏状态的均值和协方差。该算法实质上是在预测点周围构建一个分布，其平均值是最大似然估计值。</p><p id="9a32" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们知道，当系统是非线性的时候，这个模型就失效了。然而，在现实生活中，大多数系统都是非线性的。在以后的文章中，我将探索在线学习中的非线性系统，以及该领域中最强大的模型之一:<strong class="lk jd">粒子过滤器</strong>。</p><h1 id="e8e8" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">感谢阅读</h1><p id="8041" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">如果你喜欢的话，可以考虑<a class="ae lh" href="https://medium.com/@diegounzuetaruedas" rel="noopener"> <strong class="lk jd">关注我</strong> </a>来获得更多像这样的文章！</p><p id="0b7c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您想访问medium上成千上万只对会员开放的故事，请考虑使用我的推荐链接注册:</p><p id="53e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://diegounzuetaruedas.medium.com/membership" rel="noopener">https://diegounzuetaruedas.medium.com/membership</a></p></div></div>    
</body>
</html>