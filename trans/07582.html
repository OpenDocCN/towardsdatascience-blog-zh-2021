<html>
<head>
<title>How to Dockerize an Existing Sinatra Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对现有的Sinatra应用程序进行Dockerize</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-dockerize-an-existing-sinatra-application-3a6943d7a428?source=collection_archive---------17-----------------------#2021-07-11">https://towardsdatascience.com/how-to-dockerize-an-existing-sinatra-application-3a6943d7a428?source=collection_archive---------17-----------------------#2021-07-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b5b8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">轻松运行Sinatra应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4ccc90bb484534e5871b3758a06b4850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EU38-A-uRuOyhsFq"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ffstop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Fotis Fotopoulos </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="658a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> W </span>什么是<a class="ae ky" href="http://sinatrarb.com/" rel="noopener ugc nofollow" target="_blank">辛纳特拉</a>？它是一种使用Ruby创建基于web的应用程序的特定领域语言。我们可以用Sinatra更快更省力地创建一个web应用程序。</p><p id="8595" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Dockerized应用程序通过最大限度地减少环境管理等任务来提高开发速度，从而节省时间和精力。通过这篇文章，您将了解如何对现有的Sinatra应用程序进行Dockerize。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="0fd2" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">设置</h1><p id="f312" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">首先，我们需要安装<a class="ae ky" href="https://docs.docker.com/engine/install/" rel="noopener ugc nofollow" target="_blank"> Docker </a>并从<a class="ae ky" href="https://github.com/lifeparticle/Sinatra-Docker" rel="noopener ugc nofollow" target="_blank"> GitHub </a>下载一个git库。对于这个设置，我使用的是macOS。</p><p id="fef7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将创建一个包含Ruby的Docker映像。让我们来分解一下<a class="ae ky" href="https://github.com/lifeparticle/Sinatra-Docker/blob/main/Dockerfile" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Dockerfile </strong> </a>文件的各个成分。</p><pre class="kj kk kl km gt ni nj nk bn nl nm bi"><span id="e22e" class="nn mm it nj b be no np l nq nr">FROM ruby:3.0.0<br/><br/>ADD . /Sinatra-Docker<br/>WORKDIR /Sinatra-Docker<br/>RUN bundle install<br/><br/>EXPOSE 4567<br/><br/>CMD ["/bin/bash"]</span></pre><p id="7f9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ns nt nu nj b">From</code>指令用于定义父图像。这里我们使用的是Docker Hub上预建的Ruby的官方图片。通过使用<code class="fe ns nt nu nj b">ADD</code>指令，我们可以将当前文件夹中的所有内容添加到图像中名为<strong class="lb iu"> Sinatra-Docker </strong>的目录中。<code class="fe ns nt nu nj b">WORKDIR</code>指令会将工作目录设置为<strong class="lb iu"> Sinatra-Docker </strong>。我们再次使用<code class="fe ns nt nu nj b">RUN</code>指令来安装我们的ruby gems。之后，我们使用<code class="fe ns nt nu nj b">EXPOSE</code>指令为我们的容器公开端口4567。默认情况下，Sinatra在端口4567上运行。最后，<code class="fe ns nt nu nj b">CMD</code>指令用于在容器启动时运行命令，这里我们打开bash shell。</p><p id="663e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将创建一个Docker合成文件，使用我们刚刚创建的Docker映像运行Docker容器。我们来分解一下<a class="ae ky" href="https://github.com/lifeparticle/Sinatra-Docker/blob/main/docker-compose.yml" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">docker-compose . yml</strong></a>文件的各个成分。</p><pre class="kj kk kl km gt ni nj nk bn nl nm bi"><span id="b97f" class="nn mm it nj b be no np l nq nr">version: "3.8"<br/>services:<br/>  app:<br/>    build: .<br/>    command: bundle exec rackup --host 0.0.0.0 -p 4567<br/>    ports:<br/>      - "4567:4567"<br/>    volumes:<br/>      - .:/Sinatra-Docker</span></pre><p id="6538" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<strong class="lb iu"> docker-compose.yml </strong>文件中，我们有version、services、app、build、command、ports和volumes标签。<strong class="lb iu">版本</strong>标签用于定义合成文件格式。<strong class="lb iu"> services </strong>标签用于定义我们希望应用程序使用的服务。在这种情况下，我们只有一个名为<strong class="lb iu"> app </strong>的服务。<strong class="lb iu">构建</strong>用于使用我们之前创建的Docker文件构建我们的Docker映像。<strong class="lb iu">命令</strong>标签用于运行我们的应用程序。我们使用“0.0.0.0 ”,这样服务器将监听所有可用的IP地址。<strong class="lb iu">端口</strong>标签用于定义主机和容器端口。它将主机上的端口4567映射到容器上的端口4567。最后，<strong class="lb iu">卷</strong>标签用于将文件夹从主机挂载到容器。</p><p id="31cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在从<strong class="lb iu"> docker-compose.yml </strong>文件所在的目录运行<code class="fe ns nt nu nj b">docker compose up</code>命令。此命令将启动并运行整个应用程序。</p><pre class="kj kk kl km gt ni nj nk bn nl nm bi"><span id="1637" class="nn mm it nj b be no np l nq nr">docker compose up</span></pre><p id="6974" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以通过访问URL<a class="ae ky" href="http://localhost:4567/" rel="noopener ugc nofollow" target="_blank">http://localhost:4567/</a>通过您最喜欢的网络浏览器访问Sinatra应用程序。</p><p id="4698" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们分解我们的Sinatra应用程序。我们可以使用一个<code class="fe ns nt nu nj b">config.ru</code>文件来服务一个模块化的应用程序。你可以在这里阅读更多<a class="ae ky" href="http://sinatrarb.com/intro.html" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="kj kk kl km gt ni nj nk bn nl nm bi"><span id="ceeb" class="nn mm it nj b be no np l nq nr">require './main'<br/>run MyApp</span></pre><p id="7abd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在开发模式下，<code class="fe ns nt nu nj b">sinatra/reloader</code>会在代码改变时自动重新加载Ruby文件。未设置环境变量时，默认为<code class="fe ns nt nu nj b">APP_ENV</code>环境变量(<code class="fe ns nt nu nj b">ENV['APP_ENV']</code>)的值，未设置<code class="fe ns nt nu nj b">APP_ENV</code>环境变量时，默认为<code class="fe ns nt nu nj b">:development</code>。这里可以阅读更多<a class="ae ky" href="http://sinatrarb.com/configuration.html" rel="noopener ugc nofollow" target="_blank">。最后，对于我们的应用程序，我们只有一个端点。</a></p><pre class="kj kk kl km gt ni nj nk bn nl nm bi"><span id="34d1" class="nn mm it nj b be no np l nq nr">require 'sinatra/base'<br/>require "sinatra/reloader"<br/>class MyApp &lt; Sinatra::Base<br/>configure :development do<br/>  register Sinatra::Reloader<br/> end<br/>get '/' do<br/>  'Hello world!'<br/> end<br/>end</span></pre></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="08f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您知道了如何在Docker容器中运行Sinatra应用程序。希望这能帮助你入门Sinatra和Docker。编码快乐！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="7022" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">相关职位</h1><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/how-to-dockerize-an-existing-flask-application-115408463e1c"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">如何对接现有的Flask应用程序</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">轻松运行烧瓶应用程序</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/how-to-mount-a-directory-inside-a-docker-container-4cee379c298b"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">如何在Docker容器中挂载目录</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">专注于编写代码，无需担心环境管理</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om ks ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/how-to-run-a-python-script-using-a-docker-container-ea248e618e32"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">如何使用Docker容器运行Python脚本</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">轻松运行Python</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="oo l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>