<html>
<head>
<title>Saturated Models, Deviance and the Derivation of Sum of Squares</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">饱和模型、偏差和平方和的求导</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/saturated-models-deviance-and-the-derivation-of-sum-of-squares-ee6fa040f52?source=collection_archive---------8-----------------------#2021-12-27">https://towardsdatascience.com/saturated-models-deviance-and-the-derivation-of-sum-of-squares-ee6fa040f52?source=collection_archive---------8-----------------------#2021-12-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="01f8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用饱和模型和偏差探讨平方和误差的来源</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e054e9968f6cf52fbe3d49c0aef88135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TsfiuxbpLaPKmsvl"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">罗伯特·斯汤普在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3131" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我之前的<a class="ae ky" rel="noopener" target="_blank" href="/poisson-regression-and-generalised-linear-models-606fe5f7c1fd">帖子</a>中，我已经讨论过<strong class="lb iu">广义线性模型(GLMs) </strong>。这些是线性回归模型的概括，其中<strong class="lb iu">目标的变量分布是非正态</strong>。使用确定问题的<strong class="lb iu">损失函数</strong>的<strong class="lb iu">最大似然估计</strong>求解 GLMs。这就是分别用于线性和逻辑回归的<strong class="lb iu">平方和</strong>和<strong class="lb iu">对数损失</strong>的来源。然后，我们使用这些损失函数来拟合数据的模型。然而，我们如何确定我们的拟合模型捕捉到的数据有多好？这就是离经叛道的原因。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b16f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是空模型、建议模型和饱和模型？</h1><p id="574d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们讨论偏差之前，我们首先需要了解什么是饱和模型、建议模型和无效模型。</p><p id="524f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">饱和模型是指<strong class="lb iu">参数/系数的数量等于</strong>数据点的数量。这就像一个<strong class="lb iu">‘连接点’</strong>模型，其中直线或曲线通过每个点。这被认为是<strong class="lb iu">完美模型</strong>，因为它考虑了数据中的所有方差，并具有<strong class="lb iu">最大可实现可能性</strong>。</p><p id="8269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">零模型与<strong class="lb iu">相反，只有一个参数，即截距</strong>。这实质上是所有数据点的<strong class="lb iu">平均值</strong>。对于一个<strong class="lb iu">双变量模型</strong>，这是一条水平线，每一点都有<strong class="lb iu">相同的预测</strong>。</p><p id="c435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">提议的模型被认为是<strong class="lb iu">最佳拟合</strong>，并且在零模型和饱和模型之间有<strong class="lb iu">个参数。这是我们适合数据科学和机器学习问题的模型。</strong></p><p id="bb10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的脚本是 Python 中的一段代码，它从随机生成的数据集中绘制了一个空的、建议的和饱和的模型。这段代码利用了<strong class="lb iu">‘NP . poly fit’</strong>方法，允许我们绘制<strong class="lb iu">不同的指定次数多项式</strong>。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="eb7c" class="ne md it na b gy nf ng l nh ni"># import packages<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="866b" class="ne md it na b gy nj ng l nh ni"># generate data and sort it<br/>x = np.random.randn(10)<br/>y = np.random.randn(10)<br/>x.sort()<br/>y.sort()</span><span id="a3bf" class="ne md it na b gy nj ng l nh ni"># calculate the null, proposed and saturated models<br/>null_coeff = np.polyfit(x, y, 0)<br/>null_model = np.poly1d(null_coeff)<br/>null_x = np.linspace(x[0], x[-1])<br/>null_y = null_model(null_x)</span><span id="e2f1" class="ne md it na b gy nj ng l nh ni">saturated_coeff = np.polyfit(x, y, len(x))<br/>saturated_model = np.poly1d(saturated_coeff)<br/>saturated_x = np.linspace(x[0], x[-1])<br/>saturated_y = saturated_model(saturated_x)</span><span id="24af" class="ne md it na b gy nj ng l nh ni">proposed_coeff = np.polyfit(x, y, 3)<br/>proposed_model = np.poly1d(proposed_coeff)<br/>proposed_x = np.linspace(x[0], x[-1])<br/>proposed_y = proposed_model(proposed_x)</span><span id="6019" class="ne md it na b gy nj ng l nh ni"># plot the models<br/>fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(22,7))</span><span id="b211" class="ne md it na b gy nj ng l nh ni">ax1.plot(null_x, null_y, color="blue")<br/>ax1.scatter(x,y,s=70, color="blue")<br/>ax1.set_title('Null Model', fontsize=22)<br/>ax1.axes.xaxis.set_visible(False)<br/>ax1.axes.yaxis.set_visible(False)</span><span id="ad96" class="ne md it na b gy nj ng l nh ni">ax2.plot(proposed_x, proposed_y, color="red")<br/>ax2.scatter(x,y,s=70, color="red")<br/>ax2.set_title('Proposed Model', fontsize=22)<br/>ax2.axes.xaxis.set_visible(False)<br/>ax2.axes.yaxis.set_visible(False)</span><span id="da27" class="ne md it na b gy nj ng l nh ni">ax3.plot(saturated_x, saturated_y, color="green")<br/>ax3.scatter(x,y,s=70, color="green")<br/>ax3.set_title('Saturated Model', fontsize=22)<br/>ax3.axes.xaxis.set_visible(False)<br/>ax3.axes.yaxis.set_visible(False)</span></pre><p id="a6fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此代码的输出产生以下图形:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/6965182c664f2ccb7043a2e417225987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPI4aKk56v3SKEMk7xYiMA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从左到右显示零模型、建议模型和饱和模型的图。作者制作的图像。</p></figure><p id="b600" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们观察到零模型不擅长对数据进行分类，然而另一方面，饱和模型过度分类。在数据科学术语中，这是<strong class="lb iu">过拟合</strong>，并且模型具有<strong class="lb iu">高方差</strong>。然而，提出的模型最好地概括了数据。</p><blockquote class="nl nm nn"><p id="e658" class="kz la no lb b lc ld ju le lf lg jx lh np lj lk ll nq ln lo lp nr lr ls lt lu im bi translated">完整的代码可以在我的 GitHub <a class="ae ky" href="https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/saturated_models.py" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></blockquote><h1 id="008a" class="mc md it bd me mf ns mh mi mj nt ml mm jz nu ka mo kc nv kd mq kf nw kg ms mt bi translated">异常</h1><p id="9621" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">偏差是统计模型的<strong class="lb iu">拟合优度</strong>度量，尤其用于 GLMs。它被定义为饱和模型和建议模型之间的<strong class="lb iu">差异</strong>，并且可以被认为是<strong class="lb iu">我们建议的模型说明了</strong>数据中的多少变化。因此，<strong class="lb iu">偏差越低，模型越好</strong>。</p><p id="71b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数学上，总偏差，<strong class="lb iu"> <em class="no"> D </em> </strong>，定义为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/258af5b92d54eb2e6d2839cb6fc7a428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*SFg8m1V2MRgliQHs3t4e3A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的总偏差公式</p></figure><p id="f2ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中<strong class="lb iu"> <em class="no"> L_s </em> </strong>和<strong class="lb iu"> <em class="no"> L_p </em> </strong>分别为饱和模型和建议模型。<strong class="lb iu"> <em class="no"> μ </em> </strong>值是输入值的<strong class="lb iu">矩阵点积</strong>、<strong class="lb iu"> <em class="no"> x </em> </strong>及其系数<strong class="lb iu"> <em class="no"> β </em> </strong>的预测值:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/346764b77aaa146641bfec1b1a1a37cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/format:webp/1*jnXh6OwBvKqpK3DV1dD3Lg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的线性模型预测</p></figure><p id="0e15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些系数负责拟合最佳模型，可以通过分析或迭代方法<strong class="lb iu">梯度下降</strong>找到<strong class="lb iu">。感兴趣的读者可以在我之前的<a class="ae ky" href="https://levelup.gitconnected.com/why-gradient-descent-is-so-common-in-data-science-def3e6515c5c" rel="noopener ugc nofollow" target="_blank">文章</a>中更好地理解如何拟合这些系数。</strong></p><h1 id="1fb1" class="mc md it bd me mf ns mh mi mj nt ml mm jz nu ka mo kc nv kd mq kf nw kg ms mt bi translated">线性回归偏差</h1><p id="1044" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们现在将推导线性回归的偏差，显示<strong class="lb iu">误差平方和(SSE) </strong>的来源。在线性回归中，目标变量有一个<strong class="lb iu">正态分布</strong>，因此<strong class="lb iu">概率密度函数</strong>为单一预测，<strong class="lb iu">T53】μ</strong>，而<strong class="lb iu"> <em class="no"> y </em> </strong> <em class="no">，</em>为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/15621d0c08e569524d07ff36f95e3d05.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*eK3EpmmngBSA26TJC7T44A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正态分布的概率密度函数，作者</p></figure><p id="ef56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述函数的<strong class="lb iu">对数似然</strong>为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/b9cd00d446c779f4b1590c18630be443.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*_j2RltaYx0STZgn6Y8u4uQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按作者列出的正态分布的对数似然性</p></figure><p id="947b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们<strong class="lb iu">提出的模型的对数似然</strong>。需要重申的是，这只是针对单一的预测和观察。这被定义为<strong class="lb iu">单元偏差</strong>，而<strong class="lb iu">总偏差</strong>是所有单元偏差的总和。</p><p id="1abd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过设置<strong class="lb iu"> <em class="no"> μ=y </em> </strong>，我们得到最大可达对数似然，这就是饱和模型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/72823f6590e595e2d29decca1b701f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*M6BTjbe-tWHx4zR7BGAPtQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">饱和模型可能性，作者</p></figure><p id="c4a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，单位偏差，<strong class="lb iu"> <em class="no"> d </em> </strong>，是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/60c501263d6fe65916d9894cdd2a9551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*ehkVzAlv7q_eTG3aTz_22w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按作者列出的正态分布的单位偏差</p></figure><p id="94a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总偏差是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/30d56e5c62a8ac6994af08f642915b21.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*r7JBVmRWAvYSi5ss1TqGTQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按作者列出的正态分布的总偏差</p></figure><p id="c32a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是<strong class="lb iu">总平方和误差！</strong></p><p id="18cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们可以看到，偏差是线性回归的(比例)平方和误差的通用公式。我们可以对其他概率分布进行类似的推导，如<strong class="lb iu">泊松、伽马和二项式</strong> l 分布，使用它们的 pdf 来计算它们的偏差。例如，如果你的目标是二项分布，偏差就是对数损失公式！</p><h1 id="41b0" class="mc md it bd me mf ns mh mi mj nt ml mm jz nu ka mo kc nv kd mq kf nw kg ms mt bi translated">总结想法</h1><p id="e6ce" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本文中，我们已经了解了饱和模型以及它们如何与称为偏差的拟合优度度量相联系。该值描述了建议的模型考虑了多少数据变化。如果饱和的和建议的模型符合正态分布，偏差等于我们在这里推导出的普遍存在的平方和。</p><p id="c2ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章，并学到一些新的东西！请随意阅读我的其他帖子，进一步探索 GLMs！</p><h1 id="9b94" class="mc md it bd me mf ns mh mi mj nt ml mm jz nu ka mo kc nv kd mq kf nw kg ms mt bi translated">和我联系！</h1><ul class=""><li id="ca40" class="oe of it lb b lc mu lf mv li og lm oh lq oi lu oj ok ol om bi translated">要在媒体上阅读无限的故事，请务必在这里注册！  <em class="no"> </em>💜</li><li id="9786" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated"><a class="ae ky" href="/subscribe/@egorhowell" rel="noopener ugc nofollow" target="_blank"> </a> <em class="no"> </em>😀</li><li id="b8dc" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated"><a class="ae ky" href="https://www.linkedin.com/in/egor-howell-092a721b3/" rel="noopener ugc nofollow" target="_blank"><em class="no">LinkedIn</em></a><em class="no"/>👔</li><li id="a7a0" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated"><a class="ae ky" href="https://twitter.com/EgorHowell" rel="noopener ugc nofollow" target="_blank"> <em class="no">推特</em> </a> <em class="no"> </em> 🖊</li><li id="fb18" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated"><a class="ae ky" href="https://github.com/egorhowell" rel="noopener ugc nofollow" target="_blank"><em class="no">github</em></a><em class="no"/>🖥</li><li id="87b0" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated"><a class="ae ky" href="https://www.kaggle.com/egorphysics" rel="noopener ugc nofollow" target="_blank"><em class="no"/></a><em class="no"/>🏅</li></ul><blockquote class="nl nm nn"><p id="04d6" class="kz la no lb b lc ld ju le lf lg jx lh np lj lk ll nq ln lo lp nr lr ls lt lu im bi translated">(所有表情符号都是由<a class="ae ky" href="https://openmoji.org/" rel="noopener ugc nofollow" target="_blank"> OpenMoji </a>设计的——开源的表情符号和图标项目。执照:<a class="ae ky" href="https://creativecommons.org/licenses/by-sa/4.0/#" rel="noopener ugc nofollow" target="_blank"> CC BY-SA 4.0 </a></p></blockquote></div></div>    
</body>
</html>