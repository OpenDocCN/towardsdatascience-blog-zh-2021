<html>
<head>
<title>How to work with DateTime in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Python 中使用 DateTime</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-work-with-datetime-in-python-26d4092dc484?source=collection_archive---------20-----------------------#2021-12-21">https://towardsdatascience.com/how-to-work-with-datetime-in-python-26d4092dc484?source=collection_archive---------20-----------------------#2021-12-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3ba4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">5 分钟内 3 个有用的片段。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c50d72b45009d3542009664caf6697cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKzTlHtJ5SLHplqLUnwgyA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Elena Koycheva 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><blockquote class="kz la lb"><p id="66af" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">时间是金。</p></blockquote><p id="699b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这句与时间的重要性有共鸣的谚语当然不会过时。在初始阶段，所有数据都会自动分配一个“出生日期”。因此，在某些时候处理数据时，不可避免地会遇到日期和时间数据。本教程将带你浏览 Python 中的<code class="fe mc md me mf b">datetime</code>模块，并利用一些外围库，如<code class="fe mc md me mf b">pandas</code>和<code class="fe mc md me mf b">pytz</code>。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="baee" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">基础知识</h1><p id="2bef" class="pw-post-body-paragraph lc ld it lf b lg nf ju li lj ng jx ll lz nh lo lp ma ni ls lt mb nj lw lx ly im bi translated">在 Python 中，任何与日期和时间有关的事情都由<code class="fe mc md me mf b">datetime</code>模块处理，该模块进一步将模块分为 5 个不同的类。类只是对应于一个对象的数据类型。下图总结了 Python 中的 5 个<code class="fe mc md me mf b">datetime</code>类以及常用的属性和示例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/79df10f36c38143c92303dfdbfc26a18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j89O2vUYds04ufOtzFWsEQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用 Python 解释日期时间类的插图。作者自我图解。</p></figure></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="beeb" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">3 个有用的片段</h1><h1 id="b123" class="mn mo it bd mp mq nl ms mt mu nm mw mx jz nn ka mz kc no kd nb kf np kg nd ne bi translated"><strong class="ak"> 1。将字符串转换成</strong> <code class="fe mc md me mf b"><strong class="ak">datetime</strong></code> <strong class="ak">格式</strong></h1><p id="34df" class="pw-post-body-paragraph lc ld it lf b lg nf ju li lj ng jx ll lz nh lo lp ma ni ls lt mb nj lw lx ly im bi translated">也许使用<code class="fe mc md me mf b">datetime</code>最常见的情况是从正确的格式开始。将日期和时间解析为 Python 通常会被解释为字符串，因为它们具有字母数字的性质。在这一节中，我们将介绍如何将字符串列表解析为<code class="fe mc md me mf b">datetime</code>格式，以及如何将日期和时间数据拆分和组合到数据帧的各个列中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/27d04b01bb7bc82337349ba670488f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uxct12k9Io70x2qf6l1lMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段 1 的打印输出。作者自我图解。</p></figure><p id="0a4c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">但是如果一个<code class="fe mc md me mf b">datetime</code>以一种不寻常的或者不明确的方式被格式化了呢？一个常见的问题是美国和欧洲写作方式的区别。在美式格式中，月份在前面，而在欧式格式中，日子在前面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/7326995ad4573a9ba62dca09b5364b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GDJaCKnqVJ0JTawPeVQyug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国人和欧洲人解释日期的方式。作者自我图解。</p></figure><p id="8bca" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">默认情况下，<code class="fe mc md me mf b">pandas</code>中的<code class="fe mc md me mf b">to_datetime</code>通过将前 12 位以下的数字(&lt; 12)解析为月份，将对象转换为<code class="fe mc md me mf b">datetime</code>。例如，2021 年 2 月 11 日将被解析为 2021–02–11，而 2021 年 13 月 11 日将被解析为 2021–11–13。但是，有一个<code class="fe mc md me mf b">format</code>参数允许您以其他方式定义格式。</p><pre class="kj kk kl km gt nu mf nv nw aw nx bi"><span id="4cf2" class="ny mo it mf b gy nz oa l ob oc">import pandas as pd<br/>dt = "02-11-2021"</span><span id="ddf6" class="ny mo it mf b gy od oa l ob oc">dt1 = pd.to_datetime(dt)<br/>dt1<br/>#output# Timestamp('2021-02-11 00:00:00')</span><span id="a68a" class="ny mo it mf b gy od oa l ob oc">dt2 = pd.to_datetime(dt, format = "%d-%m-%Y")<br/>dt2<br/>#output# Timestamp('2021-11-02 00:00:00')</span></pre><p id="3a4b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">或者，<code class="fe mc md me mf b">strftime()</code>方法有助于在返回字符串之前格式化<code class="fe mc md me mf b">datetime</code>。在下面的示例中，原始<code class="fe mc md me mf b">datetime</code>之间的破折号(-)被替换为齿隙(/)，数字月份(02)被替换为缩写的英语术语(Feb)。</p><pre class="kj kk kl km gt nu mf nv nw aw nx bi"><span id="be24" class="ny mo it mf b gy nz oa l ob oc">import pandas as pd</span><span id="a4dd" class="ny mo it mf b gy od oa l ob oc">dt = pd.to_datetime("02-11-2021")</span><span id="ed2a" class="ny mo it mf b gy od oa l ob oc">dt3 = dt.strftime('%b/%d/%Y')<br/>dt3</span><span id="f507" class="ny mo it mf b gy od oa l ob oc">#output# 'Feb/11/2021'</span></pre><p id="c7cc" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">由于有多种方法来解释日期(日、月、年)和时间(时、分、秒)，所以理解不同的格式代码是非常重要的。下表是常用格式代码的备忘单。有关格式代码的完整列表，请参考<code class="fe mc md me mf b"><a class="ae ky" href="https://strftime.org/" rel="noopener ugc nofollow" target="_blank">strftime.org</a></code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/0bcd5b7bf30ce24b1544ce2dc43e5ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNZ03wgi3djsRbMx5gD9jA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python 中 DateTime 的常用格式代码。作者自我图解。</p></figure><h1 id="1da7" class="mn mo it bd mp mq nl ms mt mu nm mw mx jz nn ka mz kc no kd nb kf np kg nd ne bi translated"><strong class="ak"> 2。使用时区</strong></h1><p id="883d" class="pw-post-body-paragraph lc ld it lf b lg nf ju li lj ng jx ll lz nh lo lp ma ni ls lt mb nj lw lx ly im bi translated">没有时区信息的<code class="fe mc md me mf b">datetime</code>对象被称为“naive ”,有时区信息的对象(通常以+HH:MM 结尾，对应于 GMT)被视为“aware”。<code class="fe mc md me mf b"><a class="ae ky" href="https://pypi.org/project/pytz/" rel="noopener ugc nofollow" target="_blank">pytz</a></code>可能是 Python 中最全面的库之一，它简化了时区计算的任务，并考虑了夏令时结束时的模糊时间。</p><p id="7134" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">下面的代码片段将向您展示如何在“天真”和“意识到”<code class="fe mc md me mf b">datetime</code>对象之间进行转换，并有可能使用不同的时区。代码的最后一部分还演示了如何将给定的<code class="fe mc md me mf b">datetime</code>对象转换成本地时区。这个例子显示了日本和德国的时区代码，对于其他地区，你可以参考这里的<a class="ae ky" href="https://timezonedb.com/time-zones" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/dbc8dd45162ddfda912f25dda9344f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Q3XagTWyceGKbiqgB_GYw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段 2 的打印输出。作者自我图解。</p></figure><h1 id="c01d" class="mn mo it bd mp mq nl ms mt mu nm mw mx jz nn ka mz kc no kd nb kf np kg nd ne bi translated"><strong class="ak"> 3。使用区间</strong>有条件地比较两个 <code class="fe mc md me mf b"><strong class="ak">datetime(s)</strong></code> <strong class="ak"/></h1><p id="d24b" class="pw-post-body-paragraph lc ld it lf b lg nf ju li lj ng jx ll lz nh lo lp ma ni ls lt mb nj lw lx ly im bi translated">不可避免的是，有时候我们不得不有条件地对<code class="fe mc md me mf b">datetime</code>的两个数据帧进行比较。假设您有两个数据帧，第一个数据帧仅由一列<code class="fe mc md me mf b">datetime</code>组成，第二个数据帧由两列组成，这两列表示间隔和其余列中的其他信息。您的目标是从第一个数据帧中找到匹配的<code class="fe mc md me mf b">datetime</code>，如果它落在第二个数据帧的区间内，如果是，复制其他列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f6c223e0f09d297d6ce5550718196f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zdZjGDTuoWiZtGO0VLLmPw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用伪代码解释条件的图示。作者自我图解。</p></figure><p id="9d48" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">实现这一点的一种方法是使用<code class="fe mc md me mf b">pd.Interval</code>压缩两个<code class="fe mc md me mf b">datetime</code>的间隔，然后将它们指定为数据帧的索引，该索引稍后可用于有条件地比较和映射<code class="fe mc md me mf b">datetime</code>。如果满足时间条件，可以使用一个<code class="fe mc md me mf b">for</code>循环来复制感兴趣的列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/10608dbcf4b0ea7adcd061ee9c5d318b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hVpfhn468bYX9ztufLD0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段 3 的打印输出。作者自我图解。</p></figure></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="123f" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">结论</strong></h1><p id="66c6" class="pw-post-body-paragraph lc ld it lf b lg nf ju li lj ng jx ll lz nh lo lp ma ni ls lt mb nj lw lx ly im bi translated">完整的 Python 笔记本可以在<a class="ae ky" href="https://github.com/jackty9/DateTime_Python" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><p id="6793" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">概括来说，这 3 个片段涵盖了 Pythonic】中的 3 个主要功能:</p><ul class=""><li id="fa99" class="oi oj it lf b lg lh lj lk lz ok ma ol mb om ly on oo op oq bi translated">代码片段 1:将字符串转换成<code class="fe mc md me mf b">datetime</code>，反之亦然，带有代码格式化选项。</li><li id="917c" class="oi oj it lf b lg or lj os lz ot ma ou mb ov ly on oo op oq bi translated">代码片段 2:使用不同的时区，包括在 aware 和 naive 之间转换<code class="fe mc md me mf b">datetime</code>。</li><li id="4e4a" class="oi oj it lf b lg or lj os lz ot ma ou mb ov ly on oo op oq bi translated">代码片段 3:有条件地将一个<code class="fe mc md me mf b">datetime</code>间隔与来自不同数据帧的另一个<code class="fe mc md me mf b">datetime</code>进行比较，如果发现匹配，就做一些事情。</li></ul></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="b7db" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">感谢阅读这篇文章。如果你喜欢我的工作，请考虑加入 Medium 来支持我。谢谢大家！😊</p><div class="ow ox gp gr oy oz"><a href="https://jackyeetan.medium.com/membership" rel="noopener follow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">通过我的推荐链接-谭施敏加入媒体</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">jackyeetan.medium.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ks oz"/></div></div></a></div></div></div>    
</body>
</html>