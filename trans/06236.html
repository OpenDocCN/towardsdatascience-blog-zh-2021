<html>
<head>
<title>Custom SpaCy Model Deployment with AWS ECR, SageMaker, and Lambda</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS ECR、SageMaker和Lambda进行定制空间模型部署</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-custom-spacy-model-deployment-with-aws-ecr-sagemaker-lambda-72a488fe58?source=collection_archive---------14-----------------------#2021-06-04">https://towardsdatascience.com/a-custom-spacy-model-deployment-with-aws-ecr-sagemaker-lambda-72a488fe58?source=collection_archive---------14-----------------------#2021-06-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2727" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何使用AWS部署SpaCy的教程。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/453d42ed69630944c1e7a0cb9a880836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iVSmP4JKPpjM8qZm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托马斯·伊万斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="f9f5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">背景:</h1><p id="ef07" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">SpaCy是我最喜欢的NLP图书馆之一。我一直在使用spaCy执行许多命名实体识别(NER)任务。通常，我们首先需要加载一个特定语言的spaCy预训练模型，并使用我们的训练数据集对该模型进行微调。训练过程可以在本地计算机上离线完成，我们甚至可以通过Flask / Streamlit在本地托管它来测试微调后的模型性能。</p><div class="mn mo gp gr mp mq"><a rel="noopener follow" target="_blank" href="/building-a-flask-api-to-automatically-extract-named-entities-using-spacy-2fd3f54ebbc6"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">使用SpaCy构建Flask API来自动提取命名实体</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">如何使用spaCy中的命名实体识别模块来识别文本中的人、组织或位置，然后…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">towardsdatascience.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne ks mq"/></div></div></a></div><p id="9d13" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">虽然我发现了很多关于使用Flask / Streamlit在本地部署spaCy模型的很棒的教程，但是关于如何在更大范围内部署的教程并不多，例如，如何使用AWS部署spaCy模型。</p><p id="fbfc" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">这是一个非常有趣的话题，在做了大量的工作后，我在这篇文章中总结了我的解决方案；希望能对面临同样问题的人有所帮助。</p><h1 id="288b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">简介:</h1><p id="9a66" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本文中，我将解释我的解决方案，说明如何使用AWS服务部署自定义空间模型，包括:</p><ul class=""><li id="4f25" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated">弹性集装箱登记处</li><li id="d2c7" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">AWS SageMaker</li><li id="38a2" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">自动气象站λ</li><li id="0a5a" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">AWS S3铲斗(可选)</li></ul><p id="51ef" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">这是我的计划 🧗🏻：</p><ul class=""><li id="d5c5" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated">首先，原始数据输入可以作为事件发送到<strong class="lt iu"> AWS Lambda </strong>。</li><li id="409b" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">然后，在AWS Lambda <strong class="lt iu">处理函数</strong>中，我们调用一个SageMaker <strong class="lt iu">端点</strong>。端点工作是将事件作为输入，并从部署在SageMaker上的微调spaCy模型返回预测结果。</li><li id="31ba" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">最后，这个端点预测将作为执行结果显示在AWS Lambda <strong class="lt iu">结果选项卡</strong>上。如果出现错误，我们可以在AWS CloudWatch上调试。</li><li id="6e8a" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">在真实的场景中，我们可能还想连接一个AWS API网关，例如，如果我们想为模型托管一个接口。或者可能将预测结果与另一个Lambda连接起来，并集成到生产工作流中。</li></ul><p id="3b78" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">在上述步骤中，spaCy模型托管在AWS SageMaker上，并且可以作为端点随时调用。为了创建SageMaker端点，我们需要首先在AWS ECR上创建我们的<strong class="lt iu">定制空间模型容器</strong>,并准备好tar.gz格式的经过训练的<strong class="lt iu">模型工件</strong>。</p><p id="eb7e" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">此外，要创建一个模型工件，我们可以离线或在线完成。每次我们训练完一个空间模型，训练好的模型会被保存到一个文件夹中。该文件夹通常包含以下文件:</p><p id="ee1a" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated"><em class="ny">*文件名可能不同</em></p><ul class=""><li id="96a1" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated">meta.json</li><li id="92f8" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">ner(文件夹)</li><li id="5e3a" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">标记器</li><li id="4782" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">vocab(文件夹)</li></ul><p id="155c" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">要创建一个模型工件，我们可以简单地将这个文件夹压缩成tar.gz格式，并上传到S3存储桶。或者，我们也可以通过在SageMaker培训部分下创建一个培训任务，用AWS SageMaker在线培训模型。但是我们需要提供来自AWS ECR的<strong class="lt iu">定制训练图像</strong>和来自AWS S3 bucket的<strong class="lt iu">训练数据</strong>。</p><p id="6848" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">希望您现在对一般的工作流程有一点清楚了。现在，让我们开始创建我们的自定义空间模型容器，并将其上传到AWS ECR作为我们的训练图像。</p><h1 id="c5cd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在AWS ECR上创建自定义容器</h1><p id="2057" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">因为spaCy不是SageMaker内置算法之一。我们必须首先在AWS ECR上创建一个空间模型容器，并在SageMaker上创建模型端点时将该容器指定为训练映像。</p><blockquote class="nz oa ob"><p id="990a" class="lr ls ny lt b lu nf ju lw lx ng jx lz oc nh mc md od ni mg mh oe nj mk ml mm im bi translated">SageMaker提供了两个选项，其中第一个选项是使用sage maker提供的内置算法，包括KNN、XgBoost、线性学习器等。而另一个选项是使用ECR中的<strong class="lt iu">自定义docker容器</strong>。</p></blockquote><div class="mn mo gp gr mp mq"><a rel="noopener follow" target="_blank" href="/deploy-custom-deep-learning-based-algorithm-docker-container-on-amazon-sagemaker-4c334190e278"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">在Amazon Sagemaker上部署基于定制深度学习的算法Docker容器</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">在这篇文章中，我将介绍我们如何在Amazon Sagemaker上部署定制的深度学习容器算法…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">towardsdatascience.com</p></div></div><div class="mz l"><div class="of l nb nc nd mz ne ks mq"/></div></div></a></div><p id="98c7" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">上面的文章是一个很棒的参考，它启发了我如何部署一个定制的spaCy容器。我强烈建议通读这篇文章，并对docker容器的内部工作方式有更深入的了解。一开始对我来说理解起来很复杂，但是很有帮助。🧠</p><p id="d9b8" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">简而言之，该部分包括以下步骤:</p><ul class=""><li id="bb29" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated">编辑Github repo下的文件(主要是<em class="ny"> docker文件，train.py和predictor.py </em>)来训练自定义spaCy模型，并可以返回模型预测。</li><li id="830a" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">通过对spaCy docker容器执行<strong class="lt iu">本地测试</strong>来检查计算机终端上的预测结果，如果出现任何错误，则调试代码。</li><li id="25ae" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">最后，将空间容器上传到AWS ECR。</li></ul><p id="3cb6" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">对于训练文件，目标是修改代码来训练自定义空间模型。将CSV格式的数据读取到名为train_data的数据帧后，我们需要将数据帧转换为spaCy model可以接受的输入格式。我建议阅读我以前写的一篇关于如何为NER任务训练空间模型的文章。</p><div class="mn mo gp gr mp mq"><a rel="noopener follow" target="_blank" href="/an-overview-of-building-a-merchant-name-cleaning-engine-with-sequencematcher-and-spacy-9d8138b9aace"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">使用SequenceMatcher和spaCy构建商家名称清理引擎概述</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">使用预训练的spaCy深度学习模型构建一个商家名称清理引擎…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">towardsdatascience.com</p></div></div><div class="mz l"><div class="og l nb nc nd mz ne ks mq"/></div></div></a></div><p id="bcc2" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">本质上，这里我们需要将数据帧转换成以下空间格式:</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="2cd7" class="om la it oi b gy on oo l op oq">TRAIN_DATA = <br/>[<br/>('Amazon co ca', {'entities': [(0, 6, 'BRD')]}),<br/>('AMZNMKTPLACE AMAZON CO', {'entities': [(13, 19, 'BRD')]}),<br/>('APPLE COM BILL', {'entities': [(0, 5, 'BRD')]}),<br/>('BOOKING COM New York City', {'entities': [(0, 7, 'BRD')]}),<br/>('STARBUCKS Vancouver', {'entities': [(0, 9, 'BRD')]}),<br/>('Uber BV', {'entities': [(0, 4, 'BRD')]}),<br/>('Hotel on Booking com Toronto', {'entities': [(9, 16, 'BRD')]}),<br/>('UBER com', {'entities': [(0, 4, 'BRD')]}),<br/>('Netflix com', {'entities': [(0, 7, 'BRD')]})]<br/>]</span></pre><p id="221e" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">然后，在训练文件中，我们定义我们的<strong class="lt iu"> train_spacy </strong>函数来训练模型。train_spaCy函数类似于下一篇文章中的函数。请注意，本文中的代码是用spaCy版本2编写的。</p><div class="mn mo gp gr mp mq"><a href="https://manivannan-ai.medium.com/how-to-train-ner-with-custom-training-data-using-spacy-188e0e508c6" rel="noopener follow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">如何使用spaCy自定义训练数据训练NER？</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">使用我们的自定义数据集训练空间名称实体识别(NER)</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">manivannan-ai.medium.com</p></div></div><div class="mz l"><div class="or l nb nc nd mz ne ks mq"/></div></div></a></div><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练文件示例</p></figure><p id="cd00" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">在预测器文件中，我们需要编辑<strong class="lt iu">预测</strong>函数下的代码。预测函数将test_data作为输入。test_data需要是一个数据帧，我们可以将训练好的空间模型应用到包含我们想要预测的文本的列上。</p><p id="e0e1" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">然后，我们可以为模型的预测创建一个新列。如果这是一个NER任务，那么新列将包含从每行输入中提取的实体。此外，我们可以调整predict函数是只返回预测列表，还是返回包含源列和预测列的整个数据帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预测文件</p></figure><p id="d785" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">最后，在docker文件中，只需根据所需的库相应地编辑代码。对我来说，我添加了<em class="ny">RUN pip 3 install-U spacy = = 2 . 3 . 5</em>来安装我使用的spaCy的正确版本。</p><p id="006b" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">如果你来了，恭喜你！🥳</p><p id="d53f" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">要将我们的容器图像推送到Amazon ECR，我们可以遵循里面的代码(来自上面的<a class="ae ky" rel="noopener" target="_blank" href="/deploy-custom-deep-learning-based-algorithm-docker-container-on-amazon-sagemaker-4c334190e278"> <strong class="lt iu">文章的</strong> </a> Github)</p><ul class=""><li id="d8f3" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated">构建_和_推送. sh文件</li><li id="075c" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">自带创建算法和模型包笔记本</li></ul><p id="c16f" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">这些文件在那篇文章中有很好的解释。我们可以简单地运行代码，将我们自己的定制空间容器推到AWS ECR上。</p><p id="7115" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">直到这一步，我们终于将自定义空间容器上传到了AWS ECR。这是模型部署的关键步骤。现在，我们将切换到AWS SageMaker并创建一个模型端点。</p><h1 id="0e6a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在AWS SageMaker上创建一个模型端点</h1><p id="85e7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如AWS SageMaker开发者指南<a class="ae ky" href="https://docs.aws.amazon.com/sagemaker/latest/dg/whatis.html" rel="noopener ugc nofollow" target="_blank">中所述</a>:</p><blockquote class="nz oa ob"><p id="e9fd" class="lr ls ny lt b lu nf ju lw lx ng jx lz oc nh mc md od ni mg mh oe nj mk ml mm im bi translated">Amazon SageMaker是一项完全托管的服务，使数据科学家和开发人员能够快速轻松地构建、训练和部署任何规模的机器学习模型。Amazon SageMaker包括可以一起使用或单独使用的模块，以构建、训练和部署您的机器学习模型。</p></blockquote><p id="e7eb" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">SageMaker的界面结构如下:</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="dda9" class="om la it oi b gy on oo l op oq">Sections on the AWS SageMaker</span><span id="bf92" class="om la it oi b gy ou oo l op oq">...</span><span id="f4f7" class="om la it oi b gy ou oo l op oq">---&gt;Training<br/>------&gt;Algorithms<br/>------&gt;<strong class="oi iu">Training jobs</strong> <br/>------&gt;Hyperparameter tuning jobs</span><span id="f2d9" class="om la it oi b gy ou oo l op oq">---&gt;Inference<br/>------&gt;Compilation jobs<br/>------&gt;Model packages<br/>------&gt;<strong class="oi iu">Models</strong><br/>------&gt;<strong class="oi iu">Endpoint configurations</strong><br/>------&gt;<strong class="oi iu">Endpoints</strong><br/>------&gt;Batch transform jobs</span><span id="0f10" class="om la it oi b gy ou oo l op oq">...</span></pre><p id="77d0" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">要创建空间模型端点，我们需要完成以下步骤:</p><ul class=""><li id="c830" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated">在AWS sage maker-Training下创建一个<strong class="lt iu">培训任务</strong>。或者，简单地在本地训练你的空间模型，把它压缩成tar.gz<em class="ny"/>格式，然后上传到S3桶。目标是在这一步准备一个<strong class="lt iu">模型工件</strong>。</li><li id="7fda" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">在AWS SageMaker-Inference下创建一个<strong class="lt iu">模型</strong>。我们需要指定来自AWS ECR的<strong class="lt iu">容器图像</strong>和来自AWS S3存储桶的模型工件。</li><li id="b790" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">在AWS SageMaker推论下创建一个<strong class="lt iu">端点配置</strong>。我们需要为端点配置指定一个模型。</li><li id="608a" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">在AWS SageMaker推论下创建一个<strong class="lt iu">端点</strong>。我们需要为端点指定一个端点配置。</li></ul><p id="408c" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">如果你在AWS SageMaker上面的步骤中有任何问题，下面的教程将会很有帮助！🏂🏻</p><div class="mn mo gp gr mp mq"><a href="https://aws.amazon.com/cn/blogs/machine-learning/call-an-amazon-sagemaker-model-endpoint-using-amazon-api-gateway-and-aws-lambda/" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">使用Amazon API Gateway和AWS Lambda | Amazon Web调用Amazon SageMaker模型端点…</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">2021年4月-此帖子已更新，以确保解决方案演练反映对相关AWS所做的更改…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">aws.amazon.com</p></div></div><div class="mz l"><div class="ov l nb nc nd mz ne ks mq"/></div></div></a></div><h1 id="fb19" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">设计AWS Lambda函数</h1><p id="9dea" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如AWS Lambda开发人员<a class="ae ky" href="https://docs.aws.amazon.com/lambda/latest/dg/welcome.html" rel="noopener ugc nofollow" target="_blank">指南</a>中所述:</p><blockquote class="nz oa ob"><p id="03ff" class="lr ls ny lt b lu nf ju lw lx ng jx lz oc nh mc md od ni mg mh oe nj mk ml mm im bi translated">Lambda是一种计算服务，让您无需配置或管理服务器即可运行代码。Lambda在高可用性计算基础设施上运行您的代码，并执行计算资源的所有管理，包括服务器和操作系统维护、容量供应和自动扩展、代码监控和日志记录。</p></blockquote><p id="ed29" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">就空间部署而言，我们将使用AWS Lambda作为接口，可以在用户输入和空间模型端点之间进行通信。具体来说，我们希望将推理文本作为Lambda事件输入，并在Lambda execution选项卡上接收模型响应。</p><p id="6b8d" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">关于如何在AWS Lambda上调用SageMaker端点的一些细节可以在与上面相同的教程<a class="ae ky" href="https://aws.amazon.com/cn/blogs/machine-learning/call-an-amazon-sagemaker-model-endpoint-using-amazon-api-gateway-and-aws-lambda/" rel="noopener ugc nofollow" target="_blank">中找到。本质上，我们希望在Lambda上编写一个python处理函数，它可以执行以下步骤:</a></p><ul class=""><li id="491a" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated"><strong class="lt iu">输入事件:推理文本列表</strong></li><li id="13c2" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">将事件读入数据帧(可选)</li><li id="b5ac" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">将数据帧写入CSV缓冲区(保持数据格式的一致性)</li><li id="5ec6" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">将缓冲区的值转换成ASCII格式(与AWS要求保持一致)</li><li id="cb32" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">调用SageMaker端点并接收响应</li><li id="b71f" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">将响应解码为UTF 8格式</li><li id="4b34" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">将响应读入数据帧(可选)</li><li id="3561" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated"><strong class="lt iu">输出响应:模型预测列表</strong></li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="d360" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">关于创建CSV缓冲区或ASCII / UTF-8转换步骤的一些细节可能是不必要的，但最终它对我有用。如果你有更好的主意，请告诉我！😸</p><p id="45ec" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">如果一切正常，现在，我们应该能够看到在AWS Lambda <strong class="lt iu">执行结果</strong>选项卡上，模型预测的列表被打印出来。💯</p><h1 id="1331" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摘要</h1><p id="9f12" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这就结束了我关于使用AWS部署定制空间模型的文章。概括地说，工作流包括服务:</p><ul class=""><li id="2201" class="nk nl it lt b lu nf lx ng ma nm me nn mi no mm np nq nr ns bi translated">第一步:AWS ECR</li><li id="4c10" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">第二步:AWS S3铲斗(可选)</li><li id="1c34" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">第三步:AWS SageMaker</li><li id="e0ff" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">第四步:AWS Lambda</li></ul><p id="c602" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">希望它能帮助/激励任何从事类似工作的人😋</p><p id="adcd" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">感谢您的阅读！</p><p id="45e8" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi">🏇🏼</p><h1 id="922f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关阅读</h1><div class="mn mo gp gr mp mq"><a href="https://xoelop.medium.com/deploying-big-spacy-nlp-models-on-aws-lambda-s3-2857bfc143ba" rel="noopener follow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">在AWS Lambda + S3上部署大空间NLP模型</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">Spacy型号对于250MB的Lambda限制来说太大了。这向你展示了如何绕过它，从S3和…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">xoelop.medium.com</p></div></div><div class="mz l"><div class="ow l nb nc nd mz ne ks mq"/></div></div></a></div><div class="mn mo gp gr mp mq"><a rel="noopener follow" target="_blank" href="/load-a-large-spacy-model-on-aws-lambda-e1999e5e24b5"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">在AWS Lambda上加载大型空间模型</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">spaCy是一个有用的工具，它允许我们执行许多自然语言处理任务。当将空间整合到一个…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">towardsdatascience.com</p></div></div><div class="mz l"><div class="ox l nb nc nd mz ne ks mq"/></div></div></a></div></div></div>    
</body>
</html>