<html>
<head>
<title>Creating Boxplots Using Matplotlib in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中使用Matplotlib创建箱线图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-boxplots-of-well-log-data-using-matplotlib-in-python-34c3816e73f4?source=collection_archive---------1-----------------------#2021-08-28">https://towardsdatascience.com/creating-boxplots-of-well-log-data-using-matplotlib-in-python-34c3816e73f4?source=collection_archive---------1-----------------------#2021-08-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="535d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用箱线图了解数据分布，识别岩石物理和测井数据中的异常值</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/86d9a94f27b3e3c44f0b2b35b69fb152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8xhd9YFwqKwadVvHv2CpLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用python中的matplotlib生成具有不同y轴范围的多个箱线图。图片作者。</p></figure><p id="48e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">箱线图是一个很好的数据可视化工具，它们可以用来了解数据的分布，无论它是否偏斜，以及是否存在异常值。在本文中，我们将看看什么是盒图，以及如何使用pandas和matplotlib显示它们。</p><p id="03cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了配合这篇文章，我制作了以下<a class="ae lu" href="https://youtu.be/IpMhMUcmLJw" rel="noopener ugc nofollow" target="_blank"> YouTube视频</a>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><h2 id="16f0" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">什么是箱线图？</h2><p id="b0db" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">箱线图是一种基于五个关键数字显示数据分布的图形和标准化方法:最小值、第一个四分位数(第25个百分位数)、中值(第二个四分位数)。/第50个百分位数)、第3个四分位数(第75个百分位数)和“最大值”。最小值和最大值分别定义为Q1-1.5 * IQR和Q3 + 1.5 * IQR。任何超出这些限制的点都被称为异常值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/a8643866c5a21ff60cae2def009fd0a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oakP4vxTLwuqE8ce0fFQRA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">箱线图的图形描述，突出显示关键组成部分，包括中位数、四分位数、异常值和四分位数间距。作者创建的图像。</p></figure><p id="9a71" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">箱线图可用于:</p><ul class=""><li id="9c84" class="mw mx it la b lb lc le lf lh my ll mz lp na lt nb nc nd ne bi translated">识别异常值或异常数据点</li><li id="a116" class="mw mx it la b lb nf le ng lh nh ll ni lp nj lt nb nc nd ne bi translated">来确定我们的数据是否有偏差</li><li id="97cc" class="mw mx it la b lb nf le ng lh nh ll ni lp nj lt nb nc nd ne bi translated">了解数据的分布/范围</li></ul><p id="bb10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了构建箱线图，我们首先从中值/第50百分位(Q2)开始。这代表了我们数据中的中间值。</p><p id="fa7f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后在第25和第75个百分点之间形成一个方框(分别为Q1和Q3)。这个方框表示的范围称为四分位间距(IQR)。</p><p id="ae74" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这个盒子里延伸出线条，也就是众所周知的胡须。这些延伸到Q1-1.5 * IQR和Q3 + 1.5 * IQR，或者延伸到小于该值的最后一个数据点。</p><p id="df3c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">任何超出晶须极限的点都称为异常值。</p><h2 id="9926" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">导入库和数据</h2><p id="8c8d" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我们将在Jupyter笔记本中执行的前几个步骤包括加载库和数据。在这种情况下，我们将使用<a class="ae lu" href="https://lasio.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> lasio </a>加载我们的日志ASCII标准(LAS)文件，<a class="ae lu" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>存储我们的测井数据，以及<a class="ae lu" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>可视化我们的数据。</p><p id="ac61" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Lasio是一个您可能不熟悉的库，但它用于加载LAS文件，石油和天然气行业通常使用这些文件来存储和传输测井数据。你可以看看我的第一个YouTube视频<a class="ae lu" href="https://youtu.be/8U4gxMJybJs" rel="noopener ugc nofollow" target="_blank">，它解释了如何使用这个库。</a></p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="4557" class="lx ly it nl b gy np nq l nr ns">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import lasio</span></pre><p id="adaa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将加载并查看我们的数据。我们可以使用<code class="fe nt nu nv nl b">lasio.read()</code>并传入一个文本字符串来做到这一点。为了将它转换成熊猫数据帧，我在它的末尾添加了<code class="fe nt nu nv nl b">.df()</code>。</p><p id="037d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们正在使用的数据集来自于2018年发布的<a class="ae lu" href="https://www.equinor.com/en/what-we-do/norwegian-continental-shelf-platforms/volve.html" rel="noopener ugc nofollow" target="_blank"> Equinor Volve Field数据集。本教程中使用的文件来自15/9- 19SR井，其中包含一组标准测井测量值。</a></p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="39fd" class="lx ly it nl b gy np nq l nr ns">df = lasio.read("Data/15-9-19_SR_COMP.LAS").df()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/0d4db6301b928e1d275772d606ea557d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*0XdWi1j_N-38ZXqClKZ6ZQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pandas数据框显示了测井数据的前五行和后五行。</p></figure><p id="deac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们调用dataframe时，我们可以看到我们有一个表示前5行和后5行数据的表。每一列代表一个测井测量值。从左到右，我们用AC表示声波压缩慢度，用CALI表示井径，用DEN表示体积密度，用GR表示伽马射线，用NEU表示中子孔隙度和RDEP，用RMED表示深层和中层电阻率。</p><p id="da43" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使用一些matplotlib图，有必要删除由NaN表示的缺失值。我们可以通过使用<code class="fe nt nu nv nl b">.dropna()</code>来移除这些。添加<code class="fe nt nu nv nl b">inplace=True</code>允许我们从原始数据帧而不是它的副本中删除这些。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="3a28" class="lx ly it nl b gy np nq l nr ns">df.dropna(inplace=True)</span></pre><p id="802d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们再次调用<code class="fe nt nu nv nl b">df</code>时，我们可以看到行数从6701减少到6579。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/a94bacf263c5a4d7a813c475a602c32f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*FpmdX5FBePtvg8bJkNay3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pandas数据框显示了移除nan后的前五行和后五行测井数据。</p></figure><h2 id="1f51" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">使用熊猫的简单方框图</h2><p id="6d4f" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">现在我们的数据已经加载，我们可以生成我们的第一个箱线图。我们可以通过键入<code class="fe nt nu nv nl b">df['GR']</code>从数据帧中选择GR列，然后键入<code class="fe nt nu nv nl b">.plot()</code>来做到这一点。</p><p id="be43" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在plot方法的参数中，我们传入<code class="fe nt nu nv nl b">kind=box</code>来告诉函数我们想要一个boxplot。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="2aac" class="lx ly it nl b gy np nq l nr ns">#Simple boxplot using pandas<br/>df['GR'].plot(kind='box');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/15d65ac7bc1480052988a1f5325763a0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*KpqKFxVo8OMB5wad09ED_g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据中GR列的简单箱线图。图片作者。</p></figure><p id="383c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们运行这个单元时，我们得到一个非常基本的箱形图。我们有四分位数范围框，它包含中线。从两边延伸的是胡须，延伸到四分位间距的1.5倍。在顶部，我们有一系列圆圈，代表异常值。</p><h2 id="305c" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">带对数轴的箱线图</h2><p id="24d1" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我们可以看看另一条曲线，在这种情况下，RDEP(深电阻率)。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="8556" class="lx ly it nl b gy np nq l nr ns">#Viewing logarithmically scaled data<br/>df['RDEP'].plot(kind='box');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/fdef0857dfda04fe4c60e753ab3608e6.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xPuD9M_g0PRomhs8sL2cdA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据中RDEP柱的简单箱线图。图片作者。</p></figure><p id="7459" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们重复上面的代码，我们可以看到在图的底部有一个小方框，上面有大量的异常值。根据经验和现有知识，RDEP通常以对数标度绘制，其范围可以从大约0.01欧姆毫米到大约几千欧姆毫米。</p><p id="22d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了解决这个问题，我们可以通过添加<code class="fe nt nu nv nl b">plt.semilogy()</code>将Y轴切换到对数刻度。你会看到我们现在使用matplotlib符号，这是因为pandas调用matplotlib来构建这个方框图。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="657c" class="lx ly it nl b gy np nq l nr ns">df['RDEP'].plot(kind='box')<br/>plt.semilogy();</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/7244903575a438b3063715892707fc0f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dVeVcXZB0GjVwuy4n9Gdtg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用半对数将Y轴设置为对数后，数据中RDEP列的简单箱线图()。图片作者。</p></figure><h2 id="f835" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">使箱线图水平</h2><p id="ba16" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">如果我们更喜欢水平查看我们的盒状图，我们可以添加一个<code class="fe nt nu nv nl b">vert</code>参数，它用来告诉这个图是垂直显示(真)还是水平显示(假)。默认情况下，它被设置为True。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="733d" class="lx ly it nl b gy np nq l nr ns">#Rotating the box plot so it is horizontal<br/>df['GR'].plot(kind='box', vert=False);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/90bed6f5bb34f14987bc2a133abadc9c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*2QSmFyb33qepNFbLI_mY3A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">GR列的水平箱线图。作者图片</p></figure><h2 id="bf55" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">带Matplotlib的箱线图</h2><p id="91ce" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">上面的代码单元是使用matplotlib周围的pandas包装器完成的，如果我们想要使用matplotlib函数和语法，我们可以生成如下所示的相同图形。首先，我们调用<code class="fe nt nu nv nl b">plt.boxplot()</code>，然后将x参数设置为<code class="fe nt nu nv nl b">df['GR']</code>。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="c256" class="lx ly it nl b gy np nq l nr ns">#Using matplotlib to make a boxplot<br/>plt.boxplot(x=df['GR'], vert=False);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/2e58c6688aeb3f26de97ef8bf6545352.png" data-original-src="https://miro.medium.com/v2/format:webp/1*h7ZjH3tkYiQvdUBnr9XmqQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用matplotlib创建的水平箱线图。图片作者。</p></figure><h2 id="42fd" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">设计箱线图的样式</h2><p id="7c40" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">Matplotlib图不是很时尚，用于生成它们的代码非常低级。这就是为什么有许多基于matplotlib开发的库，如seaborn，并引入了更多的功能，使可视化更具吸引力。</p><p id="371b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们将通过改变异常圆的颜色来给我们的图添加一些颜色。为此，我们创建一个名为<code class="fe nt nu nv nl b">red_circle</code>的新变量，然后创建一个字典。在这个字典中，我们将设置<code class="fe nt nu nv nl b">markerfacecolor</code>和<code class="fe nt nu nv nl b">marker</code>。这些将分别设置为红色和圆形。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="a75e" class="lx ly it nl b gy np nq l nr ns">#Changing the outlier markers<br/>red_circle = dict(markerfacecolor='red', marker='o')<br/>plt.boxplot(x=df['AC'], vert=False, flierprops=red_circle);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/bec0f38327b69eb3390ee614b6cb3ffd.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ByB87RwuJoQ7i6bb90AgiQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Boxplot突出显示matplotlib中的异常值并使用fliersprops参数。图片作者。</p></figure><p id="6eb1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们运行这段代码时，我们现在用一些颜色来突出我们的异常值。</p><p id="1078" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在当前箱线图上，我们的IQR框内有一条橙色线代表的中值。我们还可以通过创建另一个名为<code class="fe nt nu nv nl b">mean_shape</code>的字典变量来添加数据的平均值。</p><p id="5ccf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们为<code class="fe nt nu nv nl b">markerfacecolor</code>和<code class="fe nt nu nv nl b">marker</code>设置了与之前相同的参数，它们都将被设置为绿色和菱形。要选钻石，我们可以用字母d。</p><p id="2c00" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，我们将通过添加一个<code class="fe nt nu nv nl b">markeredgecolor</code>变量来改变均值标记的边缘颜色。默认情况下，它被设置为黑色，但这里我们将它设置为绿色。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="cba6" class="lx ly it nl b gy np nq l nr ns">#Adding the mean<br/>red_circle = dict(markerfacecolor='red', marker='o')<br/>mean_shape = dict(markerfacecolor='green', marker='D', markeredgecolor='green')<br/><br/>plt.boxplot(x=df['AC'], vert=False, flierprops=red_circle, <br/>             showmeans=True, meanprops=mean_shape);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/2df4cbb45eaa56b1616c71d3a28bccb9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*u_Jp2jzydiiGSkIpqOgo-g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Matplotlib boxplot使用meanprops和showmeans参数绘制平均值。图片作者。</p></figure><h2 id="eecc" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">添加槽口</h2><p id="36d3" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我们可以用凹口代替线来表示中位数。这可以通过添加参数<code class="fe nt nu nv nl b">notch</code>并将其设置为True来实现。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="9aab" class="lx ly it nl b gy np nq l nr ns">#Adding the median notch to the box<br/>red_circle = dict(markerfacecolor='red', marker='o')<br/>plt.boxplot(x=df['DEN'], vert=False, flierprops=red_circle, <br/>             showmeans=True, meanprops=mean_shape, notch=True);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/07a320ee07c3380a892890ecbecc5a51.png" data-original-src="https://miro.medium.com/v2/format:webp/1*sAJTC3Tsl2nz_9TG4TR_Fg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Matplotlib箱线图，带有表示中值的凹口。图片作者。</p></figure><h2 id="e8c8" class="lx ly it bd lz ma mb dn mc md me dp mf lh mg mh mi ll mj mk ml lp mm mn mo mp bi translated">在图上显示多个箱线图</h2><p id="0072" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">有时，我们可能希望在同一个图形上创建多个箱线图。最简单的方法就是调用<code class="fe nt nu nv nl b">df.plot()</code>，传入<code class="fe nt nu nv nl b">kind=True</code>。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="cc6f" class="lx ly it nl b gy np nq l nr ns">#Displaying all columns in the dataframe on a single figure<br/>df.plot(kind='box');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/a66fdae26c1d299523bb2068e45c8846.png" data-original-src="https://miro.medium.com/v2/format:webp/1*V2_8UH1JMMViP9r3S3lgGA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用df.plot绘制dataframe中所有列的箱线图(kind='box ')</p></figure><p id="15d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将生成一个包含我们所有列的图，但它并不十分吸引人。此外，我们所有的测量都在不同的测量范围内。GR的典型范围为0至200 API，而DEN的典型范围为约1.5克/立方厘米至约3克/立方厘米。</p><p id="10e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这使得读取和识别数据中的异常值变得非常困难。为了制作具有不同y轴的箱线图，为了制作一个既可读又可用的图形，我们需要使用支线图。如果你想在matplotlib中找到更多关于支线剧情的信息，请查看我之前的视频。</p><p id="633d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们首先将异常值定义为红色下划线圆圈。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="cbf7" class="lx ly it nl b gy np nq l nr ns">red_circle = dict(markerfacecolor='red', marker='o', markeredgecolor='white')</span></pre><p id="0955" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们将fig，axs定义为plt.subplots。在参数中，我们传入我们想要的1行，然后是列数。列的数量将等于df.columns的长度。最后，我们将figsize设置为20乘10。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="28ed" class="lx ly it nl b gy np nq l nr ns">fig, axs = plt.subplots(1, len(df.columns), figsize=(20,10))</span></pre><p id="b241" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们需要创建一个小的for循环，它将在我们的每个绘图轴上循环。我们在这里使用枚举函数来跟踪I，我们的索引值。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="f1e8" class="lx ly it nl b gy np nq l nr ns">for i, ax in enumerate(axs.flat):</span></pre><p id="ba2f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们可以通过调用<code class="fe nt nu nv nl b">ax.boxplot()</code>并传入df.iloc来添加我们的boxplot，这允许我们通过索引变量来获取列，我们通过创建方括号来做到这一点，冒号后跟逗号。这告诉iloc函数获取所有行，然后我们传入列索引。接下来，我们指定离群属性并传入red_circle。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="1c50" class="lx ly it nl b gy np nq l nr ns">ax.boxplot(df.iloc[:,i], flierprops=red_circle)</span></pre><p id="3736" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来的几行允许我们设置标题和y刻度标签的字体大小。最后，我们呼吁<code class="fe nt nu nv nl b">plt.tight_layout</code>以一种很好的方式来安排剧情。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="2543" class="lx ly it nl b gy np nq l nr ns">#Creating subplot of each column with its own scale<br/>red_circle = dict(markerfacecolor='red', marker='o', markeredgecolor='white')<br/><br/>fig, axs = plt.subplots(1, len(df.columns), figsize=(20,10))<br/><br/>for i, ax in enumerate(axs.flat):<br/>    ax.boxplot(df.iloc[:,i], flierprops=red_circle)<br/>    ax.set_title(df.columns[i], fontsize=20, fontweight='bold')<br/>    ax.tick_params(axis='y', labelsize=14)<br/>    <br/>plt.tight_layout()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/f3ba5f0dd7657a594adf90ad56921a5d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Tk-_PQzO-StKsDfsTt-rEQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用子图分隔箱线图，以允许不同的y轴刻度/数据范围。图片作者。</p></figure><p id="7223" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们运行细胞时，我们有一个更好看的图，我们可以阅读。每个子情节都有自己的y轴刻度。我们可以看到卡利、GR和NEU都有大量的异常值。最后两个副曲线RMED和RDEP应该用对数来表示。</p><p id="2950" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了捕捉这些，我们可以添加一个简单的if语句来检查列名是否等于RDEP和RMED，然后调用<code class="fe nt nu nv nl b">ax.semilogy()</code>。</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="5609" class="lx ly it nl b gy np nq l nr ns">red_circle = dict(markerfacecolor='red', marker='o', markeredgecolor='white')<br/><br/>fig, axs = plt.subplots(1, len(df.columns), figsize=(20,10))<br/><br/>for i, ax in enumerate(axs.flat):<br/>    ax.boxplot(df.iloc[:,i], flierprops=red_circle)<br/>    df.iloc[:,i]<br/>    ax.set_title(df.columns[i], fontsize=20, fontweight='bold')<br/>    ax.tick_params(axis='y', labelsize=14)<br/>    <br/>    #Checking if column names are equal to columns we expect to be logarithmic<br/>    if df.columns[i] == 'RDEP' or df.columns[i] == 'RMED':<br/>        ax.semilogy()<br/>    <br/>plt.tight_layout()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nw"><img src="../Images/6d5e1dcaed330217371375c0b22c65d3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TKxnmgVwfP0WuGXdt20q1Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用子图分隔箱线图，以允许不同的y轴刻度/数据范围。图片作者。</p></figure><h1 id="3b8a" class="nx ly it bd lz ny nz oa mc ob oc od mf jz oe ka mi kc of kd ml kf og kg mo oh bi translated">摘要</h1><p id="c3df" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">在本教程中，我们已经了解了如何使用matplotlib和pandas创建测井数据的基本箱线图，以及如何使用具有不同y轴/数据范围的多个箱线图创建单个图形。箱线图是非常有用的数据可视化工具，允许我们了解数据的范围和分布，以及识别异常数据点，也称为异常值。</p><p id="8a18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是在项目的探索性数据阶段可以使用的许多方法之一。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><p id="c45b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="op">感谢阅读。在你走之前，你一定要订阅我的内容，把我的文章放到你的收件箱里。</em> <a class="ae lu" href="https://andymcdonaldgeo.medium.com/subscribe" rel="noopener"> <strong class="la iu"> <em class="op">你可以在这里做！</em></strong></a><strong class="la iu"><em class="op"/></strong><em class="op">或者，您可以</em> <a class="ae lu" href="https://fabulous-founder-2965.ck.page/2ca286e572" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> <em class="op">注册我的简讯</em> </strong> </a> <em class="op">免费获取更多内容直接发送到您的收件箱。</em></p><p id="d285" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其次，通过注册会员，你可以获得完整的媒介体验，并支持我自己和成千上万的其他作家。它每个月只花你5美元，你可以完全接触到所有令人惊叹的媒体文章，也有机会用你的写作赚钱。如果你用 <a class="ae lu" href="https://andymcdonaldgeo.medium.com/membership" rel="noopener"> <strong class="la iu"> <em class="op">我的链接</em></strong></a><strong class="la iu"><em class="op"/></strong><em class="op">报名，你直接用你的一部分费用支持我，不会多花你多少钱。如果你这样做了，非常感谢你的支持！</em></p></div></div>    
</body>
</html>