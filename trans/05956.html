<html>
<head>
<title>Python Map, Filter, and Reduce</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python映射、过滤和简化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-map-filter-and-reduce-9a888545e9fc?source=collection_archive---------12-----------------------#2021-05-28">https://towardsdatascience.com/python-map-filter-and-reduce-9a888545e9fc?source=collection_archive---------12-----------------------#2021-05-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="91be" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Map、Filter、Reduce和lambda函数编写优雅而高效的代码</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a3c6c1fc74f888170ce3439588c8e029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ybyYL2NUs-mkts6v"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">雅各布·安德烈森在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4ca5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Python中，可以使用<code class="fe ls lt lu lv b">def</code>来定义函数。另一种编写小功能的方法是使用lambda。Lambda函数是内联匿名函数。它只包含一个没有显式return语句的表达式。让我们看一些例子。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="ff81" class="ma mb iq lv b gy mc md l me mf">from time import time_ns</span><span id="d7c7" class="ma mb iq lv b gy mg md l me mf">def cubed(x):<br/>        return x**3</span><span id="9dd0" class="ma mb iq lv b gy mg md l me mf">lambda_cubed = lambda x:x**3</span><span id="3817" class="ma mb iq lv b gy mg md l me mf">start = time_ns()</span><span id="fed1" class="ma mb iq lv b gy mg md l me mf">print(f"Cube of 9 is {cubed(9)}")</span><span id="48e6" class="ma mb iq lv b gy mg md l me mf">print(f"Time taken for previous method : {(time_ns()-start)//1_000} ms")</span><span id="7f90" class="ma mb iq lv b gy mg md l me mf">start = time_ns()</span><span id="4ea3" class="ma mb iq lv b gy mg md l me mf">print(f"Cube of 9 is {lambda_cubed(9)}")</span><span id="00ea" class="ma mb iq lv b gy mg md l me mf">print(f"Time taken for previous lambda : {(time_ns()-start)//1_000} ms")</span><span id="c3ae" class="ma mb iq lv b gy mg md l me mf">start = time_ns()<br/>print(f"Cube of 9 is {(lambda x:x**3)(9)}")<br/>print(f"Time taken for inline lambda : {(time_ns()-start)//1_000} ms")</span></pre><p id="7deb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在前面的片段中，我们将比较一个函数和一个lambda函数计算9的立方所需的时间。我们可以给一个lambda函数命名。我们可以在片段中看到它们。如果我们运行它，我们会得到这样的结果。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="5351" class="ma mb iq lv b gy mc md l me mf">Cube of 9 is 729<br/>Time taken for previous method : 18 ms<br/>Cube of 9 is 729<br/>Time taken for previous lambda : 3 ms<br/>Cube of 9 is 729<br/>Time taken for inline lambda : 2 ms</span></pre><p id="7753" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每次执行代码片段时，这些数字可能会稍有不同。但是很明显，lambda函数比它们的替代方法要快得多。</p><p id="7925" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在将看到如何使用lambda函数来进一步优化我们的代码。要了解关于Python lambda函数的更多信息，可以访问这个<a class="ae kv" href="https://www.w3schools.com/python/python_lambda.asp" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="a420" class="ma mb iq bd mo mp mq dn mr ms mt dp mu lf mv mw mx lj my mz na ln nb nc nd ne bi translated">地图</h2><p id="e83f" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我们可以使用Python map函数从另一个列表生成一个新列表。我们将比较循环，并映射生成一个包含1–10个方块的列表。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="f8ff" class="ma mb iq lv b gy mc md l me mf">start = time_ns()<br/>squares=[]<br/>for i in range(1,11):<br/>        squares.append(i**2)<br/>print(squares)</span><span id="149d" class="ma mb iq lv b gy mg md l me mf">print(f"Time taken for a for loop to generate squares: {(time_ns()-start)//1_000} ms")</span><span id="82a3" class="ma mb iq lv b gy mg md l me mf">start = time_ns()</span><span id="b3fd" class="ma mb iq lv b gy mg md l me mf">squares=list(map(lambda i:i**2,list(range(1,11))))</span><span id="6f2a" class="ma mb iq lv b gy mg md l me mf">print(squares)<br/>print(f"Time taken for map and lambda function to generate squares : {(time_ns()-start)//1_000} ms")</span></pre><p id="9a85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面代码片段的输出是…</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="4de1" class="ma mb iq lv b gy mc md l me mf">[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]<br/>Time taken for a for loop to generate squares: 12 ms<br/>[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]<br/>Time taken for map and lambda function to generate squares : 9 ms</span></pre><h2 id="52f5" class="ma mb iq bd mo mp mq dn mr ms mt dp mu lf mv mw mx lj my mz na ln nb nc nd ne bi translated">过滤器</h2><p id="e31a" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">类似地，我们可以结合使用filter方法和lambda函数来从列表中过滤出条目。在下一个例子中，我们将使用循环和过滤方法创建一个从1到10的偶数列表。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="8c28" class="ma mb iq lv b gy mc md l me mf">start = time_ns()<br/>evens=[]<br/>for i in range(1,11):<br/>        if i%2==0:<br/>                evens.append(i)<br/>print(evens)<br/>print(f"Time taken for a for loop : {(time_ns()-start)//1_000} ms")</span><span id="3e31" class="ma mb iq lv b gy mg md l me mf">start = time_ns()</span><span id="ef5b" class="ma mb iq lv b gy mg md l me mf">squares=filter(lambda i:i%2==0,list(range(1,11)))</span><span id="d3bd" class="ma mb iq lv b gy mg md l me mf">print(evens)<br/>print(f"Time taken for filter : {(time_ns()-start)//1_000} ms")</span></pre><p id="8b62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们比较每种方法的时间，我们会看到…</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="a714" class="ma mb iq lv b gy mc md l me mf">[2, 4, 6, 8, 10]<br/>Time taken for a for loop : 6 ms<br/>[2, 4, 6, 8, 10]<br/>Time taken for filter : 4 ms</span></pre><p id="451d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">减少</strong></p><p id="ba2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Reduce函数的工作方式类似于聚合函数。前面的方法<code class="fe ls lt lu lv b">map</code>和<code class="fe ls lt lu lv b">filter</code>是python内置的，但是我们需要导入<code class="fe ls lt lu lv b">functools</code>来使用reduce函数。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="ba74" class="ma mb iq lv b gy mc md l me mf">from functools import reduce</span><span id="691b" class="ma mb iq lv b gy mg md l me mf">print(reduce(lambda x,y:x+y, list(range(1,11))))</span></pre><p id="817e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出将是<code class="fe ls lt lu lv b">55</code>。reduce的工作方式是首先获取列表的前两个元素，并存储在<code class="fe ls lt lu lv b">x</code>、<code class="fe ls lt lu lv b">y</code>中。对x执行lambda函数后，y(本例中为sum) reduce函数将新值存储在x中。然后将下一个元素分配给y，并将相同的函数应用于x，y &amp;结果存储在x中，依此类推。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="d709" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没有必要将lambda函数与map、filter和reduce函数一起使用。这里有一个将一列数字作为输入的例子。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="a2bc" class="ma mb iq lv b gy mc md l me mf">a=list(map(int, input().split()))<br/>print(a)</span></pre><p id="1c63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，它们与预定义的Python函数配合得很好。</p><p id="4803" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦您熟悉了这些功能，很容易发现这些功能会导致更短和优化的代码。虽然有时使用for循环可以使代码更具可读性。</p><p id="a5f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是这些功能的知识并没有被浪费。下次你准备在Pandas中预处理一个数据集时，了解lambda函数的概念将会使你受益。</p><p id="5ac5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击<a class="ae kv" href="https://www.learnpython.org/en/Map,_Filter,_Reduce" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">此处</strong> </a>了解更多关于这些功能的信息。</p><p id="2374" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你喜欢。敬请关注更多内容。</p></div></div>    
</body>
</html>