<html>
<head>
<title>The Most for Your Money from Amazon RDS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊RDS让您物超所值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-most-for-your-money-from-amazon-rds-51784064da1f?source=collection_archive---------22-----------------------#2021-09-24">https://towardsdatascience.com/the-most-for-your-money-from-amazon-rds-51784064da1f?source=collection_archive---------22-----------------------#2021-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3751" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">绩效评估和成本节约方案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/896e18c711870a662f5cf46dfbda3790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FtH8xFyLwlmDO_9hc4oxjA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">亚马逊RDS最物有所值—通过Shutterstock获取图片(标准许可)</p></figure><p id="dd74" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://aws.amazon.com/rds/" rel="noopener ugc nofollow" target="_blank"> Amazon RDS </a>是一个强大的托管数据库服务，可以根据您的需要轻松创建、扩展和配置。<br/>然而，亚马逊RDS，像大多数AWS服务一样，如果没有正确的设置和监控，会很快产生高额(更重要的是浪费)成本。<br/>作为一名数据库维护人员，这份服务概述将为您提供如何让您的资金发挥最大价值的高级原则和工具。</p><p id="626e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">*在本文中，我将重点介绍PostgreSQL数据库类型，但是其他DB引擎也有相同或非常相似的配置和指标。只有Amazon Aurora —无服务器会有很大不同。</em></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="79e0" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak">亚马逊RDS的主要成本来源</strong></h1><p id="efa3" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">在创建或更新Amazon RDS实例时，您需要考虑4个主要的成本相关配置:实例类、多AZ配置、硬盘存储和供应的IOPS，然后是支持服务:快照和到S3的快照导出。让我们深入探讨每一个问题。</p><h2 id="967c" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">实例类</strong> ( <strong class="ak"> <em class="nj">成本影响:高</em> </strong>)</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/65d049844330b03ffcc12707e6f6100b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TkZ4t45LsfPT6Xb5wW9mw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">实例类(作者图片)</p></figure><p id="d02a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是成本的主要驱动因素。它定义了硬件类型用途、vCPU、CPU信用、内存和网络性能。它是按小时计费的(和/或胸围积分，如果适用的话), RDS有大量的实例选项供您选择。<br/>实例类型列表及其<a class="ae lr" href="https://aws.amazon.com/rds/instance-types/" rel="noopener ugc nofollow" target="_blank">用途此处</a>和<a class="ae lr" href="https://aws.amazon.com/rds/pricing/" rel="noopener ugc nofollow" target="_blank">定价此处</a>。</p><h2 id="6998" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">多AZ配置(成本影响:高)</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/10c11ec22181a0f93c4242587a243961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54Q-c3yme5I63lShsqVD_w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">多AZ配置(图片由作者提供)</p></figure><p id="4b65" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它为您的实例增加了冗余，以防出现故障。对于生产数据库来说，这是必须的，但对于开发和试运行来说就不那么重要了。如果主实例出现问题，warm实例将始终处于备用模式，因此成本几乎会翻倍。确保除非在生产环境中，否则不要使用它。</p><blockquote class="nm nn no"><p id="e556" class="kv kw ls kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated">启用多AZ配置还会增加实例类型、硬盘存储和IOPS的成本。</p></blockquote><h2 id="6aa1" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">硬盘存储(成本影响:中低)</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/f439a8ac66d6971400bd1834ebd99454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KV9C7cYFq0s8rK6C8-vocw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">存储自动缩放(图片由作者提供)</p></figure><p id="78a3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它可以是磁性、固态硬盘、+/-调配的IOPS。这里的选项在成本方面没有太大的问题，即使磁性将比SSD便宜。它是按GB计费的，而且非常低。当然，如果你在几十万GB的数据库中，你可能要多注意这一点。调配的IOPS也会变得非常昂贵。</p><blockquote class="nm nn no"><p id="6354" class="kv kw ls kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated"><strong class="kx ir"> Pro提示:</strong>当你设置存储时，选中“存储自动缩放”，它可以自动缩放(使用的额外存储之外)，如果数据发生任何重大波动，它将防止你的数据库下降。造成这种情况的原因不仅仅是数据的增长，还可能是因为读取副本滞后、数据未被清空，或者在请求大量涌入时索引未被重构(仅举几个例子)。当然，你不应该依赖于这种长期的和调整“分配的存储”，一旦它被注意到和永久的。</p></blockquote><h2 id="f593" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">快照(RDS备份)(成本影响:低)</strong></h2><p id="a49e" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">这是非常低的，对整个账单几乎无足轻重。您可能需要注意的是保留期，因为您需要支付备份、存储和数据传输的费用。对于非生产数据库，您可以将保留期设置为3 -7天，以消除长期存储成本。</p><h2 id="d48f" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">供应IOPS(成本影响:中到高)</strong></h2><p id="b8df" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">IOPS是一种额外的配置，默认情况下不会应用，但如果使用它们，您应该小心，因为它们会显著影响成本。</p><h2 id="db80" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">快照出口到S3 </strong> <strong class="ak">(成本影响:低)</strong></h2><p id="6b4a" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">这不是大多数人使用的常见选项，但尽管如此，还是要意识到与此相关的成本。随着数据库规模的增长，it成本也会增加。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="cd26" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak">性能测量&amp;实例调整</strong></h1><p id="9adb" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">既然您已经运行了数据库，那么您需要将重点放在监控和优化上。我已经确定了评估的主要指标:</p><ul class=""><li id="182d" class="nt nu iq kx b ky kz lb lc le nv li nw lm nx lq ny nz oa ob bi translated">网络流通量</li><li id="85b2" class="nt nu iq kx b ky oc lb od le oe li of lm og lq ny nz oa ob bi translated">CPU利用率和/或CPU信用使用</li><li id="3619" class="nt nu iq kx b ky oc lb od le oe li of lm og lq ny nz oa ob bi translated">可释放内存</li><li id="0d4c" class="nt nu iq kx b ky oc lb od le oe li of lm og lq ny nz oa ob bi translated">读IOPS，写IOPS</li><li id="a0bb" class="nt nu iq kx b ky oc lb od le oe li of lm og lq ny nz oa ob bi translated">突发余额和/或CPU信用使用</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/266151aa64c9a758eff3de253c1b3c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JihC1jFmdqEy6W5VrZUfIQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Amazon RDS--&gt;(特定的)数据库实例--&gt;监控(图片由作者提供)</p></figure><p id="eefc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这不是一个完整的列表，而是几个你应该注意的基本列表。这些特定的指标将决定是否需要改变。当我们在这里讨论节省时，您正在寻找浪费的资源或低于实例类允许的50%的资源利用率。<br/>理想的规则是，平均来说，您希望利用75%的允许资源。是的，你甚至可以达到85%-90%，但这真的会推动极限，如果意外的激增发生，你会走投无路。<br/>让我们深入了解每项指标。</p><h2 id="d8f5" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">网络吞吐量</strong></h2><p id="8ede" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">这里的用法将指示实例类类型<strong class="kx ir"> </strong>的变化，特别是<em class="ls">网络性能</em>规范的变化。</p><h2 id="1845" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated">CPU利用率和/或CPU信用使用</h2><p id="843e" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">评估CPU使用情况。如果您使用的太少，您可以缩减到具有不同的<em class="ls">内核数量和vCPU </em>单元的实例。</p><h2 id="0e88" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">可释放内存</strong></h2><p id="2cf7" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">评估您使用了多少内存，尤其是在您的高峰期，75%左右的利用率是正常的。如果你用得太少，你可以缩减到一个更低<em class="ls">内存容量的实例。</em></p><h2 id="c40d" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated">读IOPS，写IOPS</h2><p id="f040" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">它决定了访问你硬盘的速度。此处的任何更改都将决定您的硬盘类型和/或配置/取消配置额外的IOPS的更改。<br/> <a class="ae lr" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Storage.html" rel="noopener ugc nofollow" target="_blank">关于IOPS的更多信息和确定您的基本上限</a></p><h2 id="1ede" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated">突发余额和/或CPU信用使用</h2><p id="89be" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">*仅适用于“可突发的性能实例”<br/>如果您的实例类型属于此类别，请密切注意，因为可突发的实例可能会超出实例容量，这将产生成本。<br/>另一方面，如果您没有使用这个选项，您可能希望获得一个具有较低CPU信用/小时的实例。为了评估最适合您的方案，您必须监控两个指标——“突发平衡”和“CPU信用使用”。</p><blockquote class="nm nn no"><p id="7e6a" class="kv kw ls kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated"><strong class="kx ir">警告:</strong>这些指标都不是独立工作的，因为实例类不是每个指标都可以配置的，但是它们是一组预定义的配置。您需要确定哪一对最适合您的用例。</p><p id="ac5b" class="kv kw ls kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated"><strong class="kx ir">专业提示:</strong>如果不永久投入生产，至少在最初几个月启用性能洞察。使用该工具，您将能够在您的堆栈上或直接在使用数据库的应用程序上微调查询、连接和许多其他事情。<br/>通过这些内部的优化可以导致更广泛的实例优化，并潜在地降低实例类型的规模和更多的节省。<br/> <a class="ae lr" href="https://docs.amazonaws.cn/en_us/AmazonRDS/latest/UserGuide/USER_PerfInsights.UsingDashboard.html" rel="noopener ugc nofollow" target="_blank">关于性能洞察的更多信息</a></p></blockquote></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="a7f9" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak">节约成本的附加方式</strong></h1><h2 id="ba40" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated">保留实例</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/7ff915cda1a4a26711bb7038c8c91512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J6q-vXw5_9lZRxWrvkV6og.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="nj"> AWS控制台- &gt;亚马逊RDS - &gt;预约实例</em>(图片由作者提供)</p></figure><p id="34b4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您打算长时间运行同一个实例，那么保留实例(RI)是一个不错的选择。如果您承诺一年或更长时间，它可以为您节省大约30%到50%。<br/>一个有趣的细节是，您正在为一个特定的实例类类型所使用的单元付费。这种承诺允许您通过仍然利用预留来扩大或缩小同一个实例类。<br/> <a class="ae lr" href="https://aws.amazon.com/rds/postgresql/pricing/" rel="noopener ugc nofollow" target="_blank">关于保留实例的更多信息</a></p><h2 id="8a8e" class="mx mb iq bd mc my mz dn mg na nb dp mk le nc nd mm li ne nf mo lm ng nh mq ni bi translated"><strong class="ak">建立账户/服务预算</strong></h2><p id="06d4" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">最后，如果您不确定您需要什么样的配置属性，您至少应该建立一个预算并相应地进行监控。您可以在“我的计费仪表板”-&gt;“预算”下完成此操作。这不会直接帮你省钱，但这是监控成本的主动方式。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="c923" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="5563" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">这是一个非常简短的介绍，介绍了如何在高层次上评估您的Amazon RDS实例，但是它应该让您朝着正确的方向开始。如果您需要更深入的研究，您将必须彻底阅读Amazon RDS文档，通过CloudWatch和Performance Insights保持监控，并检查什么最适合您的用例。</p><h1 id="296b" class="ma mb iq bd mc md oj mf mg mh ok mj mk jw ol jx mm jz om ka mo kc on kd mq mr bi translated">另外，阅读</h1><p id="019f" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/the-most-for-your-money-from-amazon-s3-6536c78189da">亚马逊S3最划算</a></p><h1 id="470a" class="ma mb iq bd mc md oj mf mg mh ok mj mk jw ol jx mm jz om ka mo kc on kd mq mr bi translated">联系人</h1><p id="6eec" class="pw-post-body-paragraph kv kw iq kx b ky ms jr la lb mt ju ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">我是一名软件、数据和机器学习顾问，通过了<a class="ae lr" href="https://www.credly.com/badges/58e38a3f-af0c-441c-be90-6ed99fc4a788/public_url" rel="noopener ugc nofollow" target="_blank"> AWS机器学习</a> &amp; <a class="ae lr" href="https://www.credly.com/badges/0db46f4c-3f60-413d-aa31-8d5e56982d2d/public_url" rel="noopener ugc nofollow" target="_blank"> AWS解决方案架构师认证——专业</a>。如果您的下一个机器学习项目需要帮助，请联系我们。<br/>关注我的最新文章和项目<a class="ae lr" href="https://vel-lesikov.medium.com/subscribe" rel="noopener">，关注我的媒体</a>。</p><p id="ec0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其他联系人:</p><ul class=""><li id="a86e" class="nt nu iq kx b ky kz lb lc le nv li nw lm nx lq ny nz oa ob bi translated"><a class="ae lr" href="https://www.linkedin.com/in/velimir-lesikov/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="d600" class="nt nu iq kx b ky oc lb od le oe li of lm og lq ny nz oa ob bi translated"><a class="ae lr" href="https://vel-lesikov.medium.com/" rel="noopener">中等轮廓</a></li><li id="725f" class="nt nu iq kx b ky oc lb od le oe li of lm og lq ny nz oa ob bi translated"><a class="ae lr" href="https://github.com/velles" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li></ul></div></div>    
</body>
</html>