<html>
<head>
<title>Improving Transformation Invariance in Contrastive Representation Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">改进对比表征学习中的变换不变性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/improving-transformation-invariance-in-contrastive-representation-learning-63f881ea1ac2?source=collection_archive---------31-----------------------#2021-04-01">https://towardsdatascience.com/improving-transformation-invariance-in-contrastive-representation-learning-63f881ea1ac2?source=collection_archive---------31-----------------------#2021-04-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7fcd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">转换不变性对对比学习有什么作用？</h2></div><p id="3e22" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博文中，我想快速回顾一下我最近与Adam Foster和Tom Rainforth合作的关于<a class="ae lb" href="https://arxiv.org/abs/2010.09515" rel="noopener ugc nofollow" target="_blank">提高对比表征学习中的转换不变性</a>的工作，我们试图回答“转换不变性在对比学习中的作用是什么？”我们的方法是加强更强的不变性，并表明这导致下游任务的性能提高。</p><blockquote class="lc ld le"><p id="2b5e" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">我们的方法是加强更强的不变性，并表明这导致下游任务的性能提高。</p></blockquote><h1 id="170e" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">对比学习</h1><p id="eb49" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">对比学习是一种自我监督的方法，通过利用来自未标记数据的信号来学习有用的数据表示。为了评估这种方法，我们重新引入标签，并在冻结的表示上安装线性分类器。最近的对比学习方法已经在这个评估任务上实现了最先进的性能，并且几乎消除了与监督学习的差距，例如<a class="ae lb" href="https://arxiv.org/abs/2002.05709" rel="noopener ugc nofollow" target="_blank"> SimCLR </a>、<a class="ae lb" href="https://arxiv.org/abs/1911.05722" rel="noopener ugc nofollow" target="_blank"> MoCo </a>。这些方法的主要思想是学习对诸如随机裁剪或旋转之类的有害变换不变的表示。我们问了以下问题</p><ol class=""><li id="cf73" class="mg mh iq kh b ki kj kl km ko mi ks mj kw mk la ml mm mn mo bi translated">我们能在这种对比环境中提高不变性吗？</li><li id="b3a7" class="mg mh iq kh b ki mp kl mq ko mr ks ms kw mt la ml mm mn mo bi translated">不变性越强，性能越好吗？</li></ol><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mu"><img src="../Images/1f0c204705902234f7e3bd01dc0eb556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbFpnmnrGa-mmhQnX2eXZw.jpeg"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">SimCLR体系结构学习用不同的变换来匹配相同输入的低维投影。—作者图片</p></figure><blockquote class="lc ld le"><p id="4b37" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">这些方法的主要思想是学习对诸如随机裁剪或旋转之类的有害变换不变的表示。</p></blockquote><h1 id="2ddd" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">我们的方法</h1><p id="a6f3" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">我们提出了2个想法<strong class="kh ir"> 1)一个新的梯度正则化2)特征平均</strong>来鼓励更强的不变性。我们另外提出了一个新的数据集<strong class="kh ir"> Spirograph </strong>来探索我们在完全可微分的生成过程中的想法。</p><p id="efd2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">变换不变性是什么样子的？这里我们看到了相同输入的不同转换，我们希望它们的表示接近。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nk"><img src="../Images/eab141530e72f5ea22ef2681e07b4ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YCdfx5NqEMnwkpfOPUKtnw.jpeg"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">作者图片</p></figure><h2 id="83b6" class="nl lk iq bd ll nm nn dn lp no np dp lt ko nq nr lv ks ns nt lx kw nu nv lz nw bi translated">梯度正则化子</h2><p id="3cfa" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">我们感兴趣的许多变换(例如颜色失真)是可微的，并且由连续参数α控制。如果我们用一个变换参数α，z_α来调用一个输入的表示，我们可以通过<em class="lf">条件方差</em>正式地测量该表示如何随着变换的变化而变化</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/fdcaeb682a1d062312d7c864456b201f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/0*Z-K4DZL8BuaTyAOq"/></div></figure><p id="2685" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们想把这一项减到最小，这样当我们应用不同的变换时，表示就不会有太大的变化。</p><p id="835a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于变换是可微的，<strong class="kh ir">我们可以取表示相对于α </strong>的梯度。鼓励这个梯度变小将使表示随着变换的改变而缓慢改变。在本文中，我们在这个梯度和条件方差的近似值之间建立了联系。我们的最后一个正则项是不同输入的近似条件方差，以促进输入之间的不变性。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ny"><img src="../Images/35705b6f17b68486e859f8b87e570e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6LVnQUCoJkMAaGpa"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">梯度相对于α的条件方差的近似值。</p></figure><figure class="mv mw mx my gt mz gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/bfc22d705d3e8dc9c4fc6b8a9fea7ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*6uCWBN4lHjJJac4XJiQUfg.png"/></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">梯度正则化-利用相对于变换参数的梯度来近似条件方差。—作者图片</p></figure><blockquote class="lc ld le"><p id="1bba" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">由于变换是可微的，我们可以取表示关于α的梯度。鼓励这个梯度变小将使表示随着变换的改变而缓慢改变。</p></blockquote><h2 id="d4ed" class="nl lk iq bd ll nm nn dn lp no np dp lt ko nq nr lv ks ns nt lx kw nu nv lz nw bi translated">特征平均</h2><p id="758c" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">对于测试时间，标准协议是使用来自未转换输入的表示。我们建议，在测试期间利用转换，对来自同一输入的不同转换的多个表示进行平均。该方法产生了一个强不变的表示<br/>，包括不可微的变换(例如随机水平翻转)，因此在第一个想法中不能被正则化。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oa"><img src="../Images/5f95d2938f76d04a2ad6f316d372217f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGRkxWcNqbZufeyZdbNR2w.png"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">要素平均-相同输入但使用不同变换的平均表示。—作者图片</p></figure><blockquote class="lc ld le"><p id="06b2" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">我们建议，在测试期间利用转换，对来自同一输入的不同转换的多个表示进行平均。</p></blockquote><h2 id="bfdb" class="nl lk iq bd ll nm nn dn lp no np dp lt ko nq nr lv ks ns nt lx kw nu nv lz nw bi translated">肺活量记录仪</h2><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ob"><img src="../Images/cf0e3b2f27239724db2cea4a2baa55e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlDRzGeS3ooErvYGKoNm2g.png"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">肺活量描记器的产生。</p></figure><p id="bb50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">受spirograph模式的启发，我们提出了一个新的数据集，该数据集允许从<em class="lf">有害转换因子</em> (6个因子)中分离出<em class="lf">感兴趣的生成因子</em> (4个因子)，并由<strong class="kh ir">完全可微分的生成过程形成。</strong></p><p id="206a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下游任务是使用冻结表示上的线性回归来恢复生成因子。下图显示了具有相同生成因子但具有不同变换因子的肺活量图。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oc"><img src="../Images/aa92d7fb09ec9e39aaa098036164341c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WpWfHP_f7B1Lgjmq"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">肺活量图数据集的样本。两组四幅图像(左和右):每组<br/>显示应用于感兴趣的相同生成因子的不同变换。—作者图片</p></figure><p id="b688" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里讨厌的变换超出了改变纹理的传统变换，即相同输入的颜色。螺旋图变换也使用相同的生成因子改变图像的结构，如下所示。这允许我们在不变性确实存在的地方探索变换不变性的贡献。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi od"><img src="../Images/4dbc82a047d83792d899ab9ecea162b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1y1WnnrTspD2gpDS5RziTg.png"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">仅改变变换参数h对相同生成因子的影响。—作者图片</p></figure><h1 id="8d60" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">实验</h1><p id="32fb" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">我们将展示我们在CIFAR-10、CIFAR-100和spirograph数据集上的实验结果。让我们回到我们的问题</p><h2 id="e822" class="nl lk iq bd ll nm nn dn lp no np dp lt ko nq nr lv ks ns nt lx kw nu nv lz nw bi translated">我们能在这种对比环境中提高不变性吗？</h2><p id="50b2" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">是的，有可能学到更强的不变性。如图所示，我们的梯度正则化有效地降低了CIFAR-10上的条件方差。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oe"><img src="../Images/14e87bd8c00c5b08c3d5cc52cf74bd0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iSbZtL9L1qyp5eIC"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">CIFAR-10的条件方差</p></figure><h2 id="58e1" class="nl lk iq bd ll nm nn dn lp no np dp lt ko nq nr lv ks ns nt lx kw nu nv lz nw bi translated">不变性越强，性能越好吗？</h2><p id="5ed0" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">是的，梯度正则化和特征平均都能带来更好的下游性能。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi of"><img src="../Images/8ac2a6a1718adb32a4a3490150b59197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JDAZJyc_2Lqr2aQm"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">不同数据集上半监督任务的梯度正则化性能</p></figure><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi of"><img src="../Images/afab1a79e6f46d73fab360c1ff293664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ooU3HbSY3PYiO_xw"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">不同数据集的特征平均性能，其中虚线表示来自未转换输入的表示性能。</p></figure><p id="9d66" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当结合我们的两种方法时，<strong class="kh ir">我们在CIFAR-10、CIFAR-100数据集上实现了一流的性能。</strong></p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi og"><img src="../Images/ca53492bac396ca9af7f41e075e41769.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ErDNaGQGwW49hLce"/></div></div></figure><h2 id="1735" class="nl lk iq bd ll nm nn dn lp no np dp lt ko nq nr lv ks ns nt lx kw nu nv lz nw bi translated">对测试时引入不可见转换的鲁棒性</h2><p id="0727" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">除了改进下游性能之外，我们发现我们的正则化器还导致对变换参数α的移动更鲁棒的表示，例如，移动α分布的均值，增加α分布的方差。</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oh"><img src="../Images/d6e2cf4b82a2db53acfd89b228bcd033.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bv_GG2EYE5HOIv_f4cU0Aw.png"/></div></div></figure><h1 id="9796" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">密码</h1><p id="494e" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">您可以在这里找到可复制的代码</p><figure class="mv mw mx my gt mz gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oi"><img src="../Images/001297e2cc91ca29d7951db656309548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xoAxMz1UF2I0VA1QiTrO-Q.jpeg"/></div></div></figure></div></div>    
</body>
</html>