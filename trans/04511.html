<html>
<head>
<title>How to Auto-Adjust the Width of Excel Columns with Pandas ExcelWriter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Pandas ExcelWriter自动调整Excel列的宽度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-auto-adjust-the-width-of-excel-columns-with-pandas-excelwriter-60cee36e175e?source=collection_archive---------3-----------------------#2021-04-18">https://towardsdatascience.com/how-to-auto-adjust-the-width-of-excel-columns-with-pandas-excelwriter-60cee36e175e?source=collection_archive---------3-----------------------#2021-04-18</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="96b1" class="pw-subtitle-paragraph jv it iu bd b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dk translated">使用pandas时动态调整Excel列名的宽度。ExcelWriter和Python</h2></div><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gi gj kn"><img src="../Images/93a345824723c8aa10a13e253bc074c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3bMa7DUVfpYFsROi"/></div></div><p class="kz la gk gi gj lb lc bd b be z dk translated">照片由<a class="ae ld" href="https://unsplash.com/@mbaumi" rel="noopener ugc nofollow" target="_blank">米卡·鲍梅斯特</a>在<a class="ae ld" href="https://unsplash.com/photos/Wpnoqo2plFA" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="74c6" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">您可能需要处理的最令人沮丧的事情之一是使用Python生成Excel文件时，该文件包含许多列，由于列的宽度较短，您无法读取这些列。理想情况下，您应该交付可读的电子表格，其中所有的列都经过适当的格式化，以便它们是可读的。</p><p id="8d01" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">在这篇文章中，我们将探索快速和简单的方法可以用来</p><ul class=""><li id="12b4" class="ma mb iu lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated"><strong class="lg iv">动态</strong> <strong class="lg iv">根据列名的长度调整</strong>所有列宽</li><li id="4f24" class="ma mb iu lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">通过使用其名称<strong class="lg iv">调整特定列</strong></li><li id="1ffa" class="ma mb iu lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">使用特定列的<strong class="lg iv">索引</strong>调整该列</li></ul><p id="c98a" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">最后，我们还将讨论如何修复调用<code class="fe jr js jt ju b">set_column</code>方法(<code class="fe jr js jt ju b">AttributeError: 'Worksheet' object has no attribute 'set_column'</code>)时可能出现的一个常见问题。</p></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><p id="4d42" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">首先，让我们创建一个pandas数据框架，它将在我们的示例中引用，以便演示我们打算在本文中讨论的操作。</p><figure class="ko kp kq kr gu ks"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="2dc1" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">现在让我们尝试使用<code class="fe jr js jt ju b">ExcelWriter</code>将我们刚刚创建的熊猫数据帧写入到一个<code class="fe jr js jt ju b">csv</code>文件中，如下所示(注意，如果下面的代码片段因<code class="fe jr js jt ju b">ModuleNotFoundError: No module named openpyxl</code>失败，您需要做的就是通过运行<code class="fe jr js jt ju b">pip install openpyxl</code>来安装库):</p><figure class="ko kp kq kr gu ks"><div class="bz fq l di"><div class="mv mw l"/></div><p class="kz la gk gi gj lb lc bd b be z dk translated">将熊猫数据框架写入Excel电子表格</p></figure><p id="edaf" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">输出的电子表格应该类似于下图所示。正如您所看到的，名称较长的列被裁剪掉了，整个表格看起来很糟糕。如果您必须处理许多这样的列，问题会更大。</p><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div class="gi gj mx"><img src="../Images/a62259cea7b5528921b284a13543d7a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*5mbysV8JOK4GHpNDqsh83w.png"/></div><p class="kz la gk gi gj lb lc bd b be z dk translated">将熊猫数据帧输出到Excel电子表格</p></figure><p id="2b2c" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">在接下来的几节中，我们将探索一些可以用来自动调整列宽的方法，以便电子表格中的输出表格更具可读性。</p></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h2 id="18b9" class="my mz iu bd na nb nc dn nd ne nf dp ng ln nh ni nj lr nk nl nm lv nn no np nq bi translated">动态调整所有列的宽度</h2><p id="5917" class="pw-post-body-paragraph le lf iu lg b lh nr jz lj lk ns kc lm ln nt lp lq lr nu lt lu lv nv lx ly lz in bi translated">为了根据列的长度自动调整列的宽度，我们只需要遍历列并相应地设置列宽，如下所示:</p><figure class="ko kp kq kr gu ks"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="e7f8" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">注意:如果下面的代码片段与下面的</strong> <code class="fe jr js jt ju b"><strong class="lg iv">AttributeError</strong></code> <strong class="lg iv">不匹配，请阅读文章末尾，看看如何快速解决这个问题。</strong></p><pre class="ko kp kq kr gu nw ju nx ny aw nz bi"><span id="7b6e" class="my mz iu ju b gz oa ob l oc od">AttributeError: 'Worksheet' object has no attribute 'set_column'</span></pre><p id="156f" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">现在Excel电子表格中输出的熊猫数据框架可读性更好，看起来也更好。所有列都调整到相应的宽度，这将使它们适合空间而不会被裁剪。</p><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gi gj oe"><img src="../Images/2ef61a559791cfc23355ceb89f45a6e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fX-PG-DgA_iF_uJJwH-ICw.png"/></div></div><p class="kz la gk gi gj lb lc bd b be z dk translated">将熊猫数据帧输出到Excel电子表格中，并自动调整列宽</p></figure></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h2 id="9114" class="my mz iu bd na nb nc dn nd ne nf dp ng ln nh ni nj lr nk nl nm lv nn no np nq bi translated">通过使用列名来调整列的宽度</h2><p id="920b" class="pw-post-body-paragraph le lf iu lg b lh nr jz lj lk ns kc lm ln nt lp lq lr nu lt lu lv nv lx ly lz in bi translated">现在，您可能希望只手动调整特定列(或列的子集)的宽度。您可以通过引用列名来做到这一点，如下面的代码片段所示。为了这个例子，让我们假设我们想要将列<code class="fe jr js jt ju b">this_is_a_long_column_name</code>的宽度调整为<code class="fe jr js jt ju b">30</code>:</p><figure class="ko kp kq kr gu ks"><div class="bz fq l di"><div class="mv mw l"/></div><p class="kz la gk gi gj lb lc bd b be z dk translated">通过引用特定列的名称来手动调整其宽度</p></figure><p id="186a" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">上面代码片段的输出如下所示。正如我们所看到的，列<code class="fe jr js jt ju b">this_is_a_long_column_name</code>的宽度被调整为<code class="fe jr js jt ju b">20</code>，而其余列的宽度被调整为默认值，这使得宽度较长的列(如最后一列)被裁剪。</p><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gi gj of"><img src="../Images/ac0fefc1265a774943cc755f9f72684f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EbJSQbYAITKK8d7U58dxmQ.png"/></div></div><p class="kz la gk gi gj lb lc bd b be z dk translated">输出此_is_a_long_column_name的列宽已手动调整的电子表格</p></figure></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h2 id="e284" class="my mz iu bd na nb nc dn nd ne nf dp ng ln nh ni nj lr nk nl nm lv nn no np nq bi translated">使用列的索引来调整列的宽度</h2><p id="ea69" class="pw-post-body-paragraph le lf iu lg b lh nr jz lj lk ns kc lm ln nt lp lq lr nu lt lu lv nv lx ly lz in bi translated">或者，您可能希望通过直接引用特定列的索引来手动调整该列的宽度。在下面的示例中，我们通过调整最后一列的宽度来演示这一点。</p><figure class="ko kp kq kr gu ks"><div class="bz fq l di"><div class="mv mw l"/></div><p class="kz la gk gi gj lb lc bd b be z dk translated">通过引用特定列的索引来手动调整其宽度</p></figure><p id="21f1" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">同样，我们可以看到，在这种情况下，最后一列已经被调整为<code class="fe jr js jt ju b">width=40</code>，因此它足够宽以适应列名。</p><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gi gj og"><img src="../Images/2620816abc3d2977256bc819a38d2259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*riklUKiS7g-2WjAUde1LKg.png"/></div></div><p class="kz la gk gi gj lb lc bd b be z dk translated">输出最后一列具有手动调整列宽的电子表格</p></figure></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h2 id="a60c" class="my mz iu bd na nb nc dn nd ne nf dp ng ln nh ni nj lr nk nl nm lv nn no np nq bi translated">如何修复<code class="fe jr js jt ju b">AttributeError: 'Worksheet' object has no attribute 'set_column'</code></h2><p id="720e" class="pw-post-body-paragraph le lf iu lg b lh nr jz lj lk ns kc lm ln nt lp lq lr nu lt lu lv nv lx ly lz in bi translated">如果上述任何操作失败，并显示以下错误</p><pre class="ko kp kq kr gu nw ju nx ny aw nz bi"><span id="c633" class="my mz iu ju b gz oa ob l oc od">AttributeError: 'Worksheet' object has no attribute 'set_column'</span></pre><p id="355c" class="pw-post-body-paragraph le lf iu lg b lh li jz lj lk ll kc lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated">你需要做的就是安装<code class="fe jr js jt ju b">xlswriter</code></p><pre class="ko kp kq kr gu nw ju nx ny aw nz bi"><span id="fe57" class="my mz iu ju b gz oa ob l oc od">pip install xlsxwriter</span></pre></div><div class="ab cl mo mp hy mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="in io ip iq ir"><h2 id="d899" class="my mz iu bd na nb nc dn nd ne nf dp ng ln nh ni nj lr nk nl nm lv nn no np nq bi translated">结论</h2><p id="823f" class="pw-post-body-paragraph le lf iu lg b lh nr jz lj lk ns kc lm ln nt lp lq lr nu lt lu lv nv lx ly lz in bi translated">在这篇文章中，我们探讨了在将pandas数据框架写入Excel电子表格时自动调整列宽的几种可能方法。我们通常会创建电子表格，这样我们就可以生成看起来漂亮、易读的信息。因此，创建不需要读者手动操作的电子表格以使它们可读是很重要的。你可以用我之前分享的最少的代码来实现这一点，当你试图用熊猫数据框创建excel文件时，这些代码肯定会帮助你创建高质量的excel文件。</p></div></div>    
</body>
</html>