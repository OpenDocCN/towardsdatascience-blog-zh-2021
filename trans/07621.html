<html>
<head>
<title>AI Object Detection, with Lions!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AI物体检测，用狮子！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ai-object-detection-with-lions-d301c6ab3564?source=collection_archive---------30-----------------------#2021-07-12">https://towardsdatascience.com/ai-object-detection-with-lions-d301c6ab3564?source=collection_archive---------30-----------------------#2021-07-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4939" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用基于区域的卷积神经网络(R-CNN)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/51cd51677e2157acddc3a3480dfa6849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qiArrpirMik9E1eOnfwoA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="30cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这篇文章原本是为了介绍<a class="ae lu" href="https://aws.amazon.com/rekognition" rel="noopener ugc nofollow" target="_blank"> AWS重新识别</a>。我想我会尝试一下，并提供一个评论。我是<a class="ae lu" href="https://console.aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS服务</a>的粉丝。它们通常都设计得很好，很直观，并且工作起来很愉快。我真的对<a class="ae lu" href="https://aws.amazon.com/rekognition" rel="noopener ugc nofollow" target="_blank"> AWS认证</a>很失望，至少我感兴趣的部分是“<strong class="la iu">自定义标签</strong>”。名字本身可能没有这么明显这是什么。这可以让你给自己的模型贴上标签，进行训练(在我看来是最有用的部分)。AWS确实为“<strong class="la iu">对象和场景检测</strong>”、“<strong class="la iu">图像调节</strong>”、“<strong class="la iu">面部分析</strong>”、“<strong class="la iu">名人识别</strong>”、“<strong class="la iu">人脸比对</strong>”、“<strong class="la iu">图像中的文字</strong>”和“<strong class="la iu"> ppe检测</strong>”提供了图像和视频模型。你可以在这里找到关于定价的信息。</p><p id="a473" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我曾计划用那些旧的儿童书籍来演示这一点。也许你们中的一些人会记得小时候的书。在每一页上，它都有一个非常忙碌和混乱的场景，你必须在人群中找到这个叫“T26瓦尔多的家伙。他戴着红帽子，戴着眼镜，穿着条纹衬衫。我认为这将是一个伟大的使用对象检测的人工智能演示。遗憾的是，我无法向你们展示这些惊人的结果，因为我无法获得许可。这是我对AWS认知的计划。相反，我用了一些我在南非约翰内斯堡的狮子和野生动物园拍摄的照片。</p><p id="42d6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只要记住<a class="ae lu" href="https://aws.amazon.com/rekognition" rel="noopener ugc nofollow" target="_blank"> AWS识别</a>不是<strong class="la iu">便宜</strong>。你按图片付费，有时按时间付费来训练和使用你的模型。这可能会使解决方案非常昂贵。我还没有看过<a class="ae lu" href="https://cloud.google.com/vision" rel="noopener ugc nofollow" target="_blank">谷歌云愿景</a>，但我预计它在定价方面会类似。</p><p id="fa46" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是我决定不在<a class="ae lu" href="https://aws.amazon.com/rekognition" rel="noopener ugc nofollow" target="_blank"> AWS重新识别</a>中使用自定义标签的主要原因。</p><ul class=""><li id="fe1c" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated">当您创建一个“<strong class="la iu">数据集</strong>时，它会自动为您创建一个具有正确权限的S3存储桶。如果您可以选择自己的bucket名称，这将是一个不错的特性。举个例子，如果我现在进入它，它想要创建一个名为“<strong class="la iu">custom-labels-console-eu-west-2–06e 54d 6838</strong>”的S3存储桶。如果你有一个以上的项目，这将是一个痛苦的管理。</li><li id="cc1b" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">在您的"<strong class="la iu">数据集</strong>"文件夹中，您至少要创建一个"<strong class="la iu">训练</strong>"文件夹或类似的文件夹。您也可以选择创建一个“<strong class="la iu">测试</strong>”文件夹。在“<strong class="la iu">项目</strong>”设置中，您可以决定是否要将您的图像分割成“<strong class="la iu">系列</strong>”和“<strong class="la iu">测试</strong>”，或者您可以告诉它将您的“<strong class="la iu">系列</strong>”自动分割成80/20。我这里的问题是你不能在控制台中删除你的“<strong class="la iu">数据集</strong>”。没有删除按钮！您需要完全移除S3存储桶，一段时间后它会被检测到并移除。</li><li id="5c40" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">您可以直接在控制台中标记您的图像。这可能是一个伟大的功能，但它是非常基本的。例如，如果您在标签的图像上放置一个边界框，您只能移动或删除它。你无法重塑它。你应该能够抓住边界框的锚点，并对其进行优化。</li><li id="ce67" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">在训练阶段，如果失败了，它不会给你一个很好的解释。您几乎肯定需要在线搜索问题所在。我遇到的一个问题是我没有添加足够的测试图像。你可能会认为只要将更多的图片复制到“<strong class="la iu"> test </strong>”文件夹中，贴上标签，你就可以…出错了！您添加的新图像永远不会被检测到。你相信你必须手动编辑新图像的清单文件吗？</li><li id="06ef" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">在我训练好我的模型后，我期待着尝试一下。不能通过控制台使用。您需要通过<a class="ae lu" href="https://aws.amazon.com/cli" rel="noopener ugc nofollow" target="_blank"> AWS CLI </a>启动模型、使用模型和停止模型。</li><li id="27ca" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">启动和停止模型花费了很长时间。我的意思是很长一段时间，有时它没有开始，也没有解释问题是什么。请记住，在模型运行时，您是按分钟付费的。</li><li id="d4ad" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">一旦你花了很多钱来训练你的模型，你就不清楚这个模型是否能被导出并在AWS之外使用。我感觉你可能会使用AWS进行推理。我找不到这方面的任何文件。</li></ul><p id="d2e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个阶段，我认为这不适合我。至少在他们修好这一切之前不会。它有真正的潜力，但作为一个"<strong class="la iu">未完成的服务</strong>"我不会使用它。我认为他们也可以为自定义标签提供一些自由层功能。</p><p id="8290" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我完成我的应用机器学习课程时，我想在人工智能方面推进我的研究。我的大部分深造都是从媒体文章中获得的。有些文章非常好，内容丰富，有些则不然。我注意到，尤其是在学习LSTM交易时，许多文章都有糟糕的代码。似乎人们只是在复制同样的代码，而没有试图去理解它。</p><p id="3a4d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几个月前，我发现了一篇关于物体检测的很棒的文章…</p><div class="mj mk gp gr ml mm"><a href="https://medium.com/swlh/tensorflow-2-object-detection-api-with-google-colab-b2af171e81cc" rel="noopener follow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">使用Google Colab的TensorFlow 2对象检测API</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">本文将指导您完成对象识别模型训练所需的所有步骤，从收集…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">medium.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ks mm"/></div></div></a></div><p id="6640" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">演练大部分工作，但有相当大的差距。我遇到了几个问题，试图让这个工作。我试图联系作者，但没有得到任何答案。我自己解决了问题并改进了代码，现在它运行得非常好。</p><p id="a870" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我将使用<a class="ae lu" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌实验室</a>，它是免费的。我实际上把我的升级到了<a class="ae lu" href="https://colab.research.google.com/signup" rel="noopener ugc nofollow" target="_blank">谷歌Colab Pro </a>，每月8.10英镑。它非常值得升级，但不是必需的。如果您使用免费版本，您需要调低“<strong class="la iu"> pipeline.config </strong>”中的“<strong class="la iu"> batch_size </strong>”超参数。</p><h2 id="bbd6" class="nb nc it bd nd ne nf dn ng nh ni dp nj lh nk nl nm ll nn no np lp nq nr ns nt bi translated">让我们准备我们的数据</h2><p id="b9f4" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">为了证明这一点，我们需要一些“<strong class="la iu">商业使用&amp; mods允许的</strong>”图像用于训练和测试。正如我上面提到的，我已经获得了使用一些“<strong class="la iu">Waldo</strong>在哪里”图片的许可。我确实在Flickr上看了看，但就是找不到一组好的图片。我最终只是用了一些我自己拍的照片，以避免任何潜在的版权问题。</p><p id="642c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦我们准备好了我们的图像，我们将需要使用这个非常神奇的免费开源工具，叫做“<a class="ae lu" href="https://github.com/tzutalin/labelImg" rel="noopener ugc nofollow" target="_blank"><strong class="la iu"/></a>”。如何安装<a class="ae lu" href="https://github.com/tzutalin/labelImg/blob/master/README.rst" rel="noopener ugc nofollow" target="_blank">的说明可以在这里找到</a>。为了训练我们的模型，我们首先需要教它“<strong class="la iu">狮子</strong>在哪里。"<a class="ae lu" href="https://github.com/tzutalin/labelImg" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> labelImg </strong> </a>"非常容易地帮你给"<strong class="la iu">狮子</strong>"加标签，并在它周围加一个边框。保存文件时，它将包含一个XML文件，其中包含图像的所有标签信息。图像可以包含一个或多个标签、多个标签，甚至是重叠的标签。在这种情况下，我们只有一个名为“<strong class="la iu"> lion </strong>”的标签。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/62c4a3c075eec1dda2aa4ce7fbb9532c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L2l2zImZqkx_r8YYO04Z4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9d47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见，我已经完成了所有的训练和测试图像，标记了一个或多个“<strong class="la iu"> lion </strong>”。</p><p id="9db6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个阶段，我们应该有一个本地目录，其中包含我们所有的图像和附带的XML文件。</p><p id="7652" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我有124张图片用于训练和测试。我将88张图片和XML文件放入一个“<strong class="la iu"> train </strong>文件夹，将36张图片放入一个“<strong class="la iu"> test </strong>文件夹。我们以后会需要这些。</p><h2 id="ad89" class="nb nc it bd nd ne nf dn ng nh ni dp nj lh nk nl nm ll nn no np lp nq nr ns nt bi translated">Google Colab</h2><p id="9816" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">我为此准备了一个笔记本，但把它分成了两部分:</p><ul class=""><li id="a4f9" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu"> <em class="oa">训练和测试模型</em> </strong></li><li id="2498" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu"> <em class="oa">加载并使用模型</em> </strong></li></ul><p id="c28d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">理想情况下，你只需要训练你的模型一次，因为这需要很长时间。使用<a class="ae lu" href="https://colab.research.google.com/signup" rel="noopener ugc nofollow" target="_blank"> Google Colab Pro </a>需要7个小时，如果您使用<a class="ae lu" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>可能需要更长时间，但至少是免费的。一旦你训练并导出了你的模型，那么加载和使用它就很快了。</p><p id="47d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">给自己创建一个新的<a class="ae lu" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>笔记本。</p><p id="673d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击<strong class="la iu">运行时</strong>，然后<strong class="la iu">改变运行时类型</strong>。在<strong class="la iu">硬件加速器</strong>下选择<strong class="la iu"> GPU </strong>。</p><p id="dea5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该部分的另一个重要菜单选项是“<strong class="la iu">运行时</strong>”下的“<strong class="la iu">管理会话</strong>”。如果你遇到崩溃或谷歌驱动会话挂起，你可能会得到一个“<strong class="la iu">僵尸会话</strong>”，这只是不允许你做任何事情。如果你有这样的问题，硬重置笔记本的最好方法是进入“<strong class="la iu">管理会话</strong>”，终止有问题的会话并重新开始。</p><h2 id="e730" class="nb nc it bd nd ne nf dn ng nh ni dp nj lh nk nl nm ll nn no np lp nq nr ns nt bi translated">训练和测试模型</h2><p id="ac92" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">您笔记本中的第一个代码单元将是安装“<strong class="la iu"> wget </strong>”。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="542a" class="nb nc it oc b gy og oh l oi oj">!pip install wget</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/b76ebdb546ea7d9c327c16b0904c1840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XHYbdk3NfIc1W8OhcLz50A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0fa9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，您将希望包括以下库。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="f8a5" class="nb nc it oc b gy og oh l oi oj">import os<br/>import sys<br/>from shutil import copy, move<br/>from wget import download<br/>from re import compile as re_compile, sub as re_sub, M<br/>from google.colab import drive<br/>from tarfile import open as untar</span></pre><p id="7013" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我的笔记本里，我把我创建的所有这些函数放在一个代码单元里，但是我要把它们分开来解释它们是做什么的。</p><p id="90ef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此功能将安装Google Drive来处理您的模型。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="75d4" class="nb nc it oc b gy og oh l oi oj">def mount_gdrive():<br/>  if not os.path.isdir('/content/gdrive'):<br/>    drive.mount('/content/gdrive')</span></pre><p id="f9ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该函数在Google Drive上创建所需的目录结构。在最初的文章中，他只是向我们展示了目录结构应该是什么样子。这实际上为你做了一切:)</p><p id="148a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您会注意到我使用了几个环境变量:</p><ul class=""><li id="ca45" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu"> GDRIVE_ROOT </strong></li></ul><p id="4fe3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是您的TensorFlow项目在Google Drive中的根目录名称。稍后你会看到，但我称我的为“张量流”。</p><ul class=""><li id="def3" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">项目名称</strong></li></ul><p id="e6b6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是您的TensorFlow对象检测项目的名称。我把我的叫做“狮子”。</p><ul class=""><li id="ba2a" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">张量流_模型</strong></li></ul><p id="d5ad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我们将使用的张量流模型。我们将使用“<strong class="la iu">固态硬盘resnet 50 V1 FPN 640 x640(retina net 50)</strong>”但如果你想看这里的，你可以<a class="ae lu" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md" rel="noopener ugc nofollow" target="_blank">看看其他的。</a></p><ul class=""><li id="0d28" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">我的_车型</strong></li></ul><p id="2503" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个基于我们将使用的张量流模型的模型名称。它是为您生成的，因此您不需要在这里指定任何内容。</p><p id="c70b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了创建所有目录之外，它还下载模型并创建标签映射。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="e605" class="nb nc it oc b gy og oh l oi oj">def create_gdrive_directory_structure():<br/>  global labels</span><span id="d058" class="nb nc it oc b gy ol oh l oi oj">root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']<br/>  tensorflow_model = os.environ['TENSORFLOW_MODEL']<br/>  my_model = os.environ['MY_MODEL']</span><span id="c2c6" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}')<br/>    os.makedirs(f'/content/gdrive/MyDrive/{root_dir}')</span><span id="c05e" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/scripts'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/scripts')<br/>    os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/scripts')</span><span id="a0f3" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/scripts/preprocessing'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/scripts/preprocessing')<br/>    os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/scripts/preprocessing')</span><span id="e945" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace')<br/>    os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace')</span><span id="a750" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')<br/>     os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')</span><span id="8503" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/annotations'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/annotations')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/annotations')</span><span id="a2f5" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/exported-models'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/exported-models')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/exported-models')</span><span id="3b76" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images')</span><span id="14a0" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images/test'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images/test')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images/test')</span><span id="062b" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images/train'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images/train')<br/>       os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/images/train')</span><span id="2056" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models')</span><span id="c4fb" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/{my_model}'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/{my_model}')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/{my_model}')</span><span id="262d" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/my_ssd_resnet50_v1_fpn'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/my_ssd_resnet50_v1_fpn')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/my_ssd_resnet50_v1_fpn')</span><span id="9696" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models'):<br/>    print (f'creating /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models')<br/>      os.makedirs(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models')</span><span id="8fcb" class="nb nc it oc b gy ol oh l oi oj">if not os.path.isfile(f'{tensorflow_model}.tar.gz') and not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models/{tensorflow_model}'):<br/>    print (f'downloading {tensorflow_model}.tar.gz from <a class="ae lu" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md'" rel="noopener ugc nofollow" target="_blank">https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md'</a>)<br/>    download(f'<a class="ae lu" href="http://download.tensorflow.org/models/object_detection/tf2/20200711/{tensorflow_model}.tar.gz'" rel="noopener ugc nofollow" target="_blank">http://download.tensorflow.org/models/object_detection/tf2/20200711/{tensorflow_model}.tar.gz'</a>)</span><span id="6385" class="nb nc it oc b gy ol oh l oi oj">if os.path.isfile(f'/content/{tensorflow_model}.tar.gz') and not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models/{tensorflow_model}'):<br/>    print (f'untar /content/{tensorflow_model}.tar.gz')<br/>    tar = untar(f'/content/{tensorflow_model}.tar.gz', "r:gz")<br/>    tar.extractall()<br/>    tar.close()</span><span id="84c3" class="nb nc it oc b gy ol oh l oi oj">if os.path.exists(tensorflow_model) and not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models/{tensorflow_model}'):<br/>    print (f'moving model {tensorflow_model} to /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models')<br/>    move(tensorflow_model, f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models/{tensorflow_model}')</span><span id="2405" class="nb nc it oc b gy ol oh l oi oj">if os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models/{tensorflow_model}/pipeline.config') \<br/>      and not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/{my_model}/pipeline.config'):<br/>      copy(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/pre-trained-models/{tensorflow_model}/pipeline.config', f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/{my_model}/pipeline.config')</span><span id="5d76" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(f'/content/models') and not os.path.exists(f'/content/gdrive/MyDrive/{root_dir}/models'):<br/>    !git clone <a class="ae lu" href="https://github.com/tensorflow/models.git" rel="noopener ugc nofollow" target="_blank">https://github.com/tensorflow/models.git</a><br/>    print (f'moving /content/models to /content/gdrive/MyDrive/{root_dir}')<br/>    move('/content/models', f'/content/gdrive/MyDrive/{root_dir}')</span><span id="d4be" class="nb nc it oc b gy ol oh l oi oj">if not os.path.isfile(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/annotations/label_map.pbtxt'):<br/>    print (f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/annotations/label_map.pbtxt')</span><span id="3c97" class="nb nc it oc b gy ol oh l oi oj">label_map = ''<br/>    for label in labels:<br/>      label_map += "item {\n"<br/>      label_map += f"  id: {label[0]}\n"<br/>      label_map += f"  name: '{label[1]}'\n"<br/>      label_map += "}\n"</span><span id="f841" class="nb nc it oc b gy ol oh l oi oj">try:<br/>    with open(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/annotations/label_map.pbtxt', 'w') as fh:<br/>        fh.write(label_map)<br/>        fh.close<br/>    except IOError as err:<br/>      print (err)</span></pre><p id="561c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">该功能用于训练和加载模型。它建立必要的对象检测库。</strong></p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="6914" class="nb nc it oc b gy og oh l oi oj">def build():<br/>  root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']<br/>  tensorflow_model = os.environ['TENSORFLOW_MODEL']</span><span id="7dfa" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/models/research')<br/>  !git checkout -f e04dafd04d69053d3733bb91d47d0d95bc2c8199</span><span id="9bf8" class="nb nc it oc b gy ol oh l oi oj">!apt-get install protobuf-compiler python-lxml python-pil<br/>  !pip install Cython pandas tf-slim lvis</span><span id="622d" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/models/research')<br/>  !protoc object_detection/protos/*.proto --python_out=.</span><span id="560f" class="nb nc it oc b gy ol oh l oi oj">!python setup.py build<br/>  !python setup.py install</span><span id="8b2f" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/models/research/object_detection/builders')<br/>  !python model_builder_tf2_test.py<br/>  print('Done')</span></pre><p id="088d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个函数创建TFRecords。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="4b1d" class="nb nc it oc b gy og oh l oi oj">def generate_tfrecords():<br/>  root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']<br/>  tensorflow_model = os.environ['TENSORFLOW_MODEL']</span><span id="8565" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/scripts/preprocessing')</span><span id="5d82" class="nb nc it oc b gy ol oh l oi oj">if not os.path.isfile('generate_tfrecord.py'):<br/>    !wget <a class="ae lu" href="https://gist.githubusercontent.com/whittlem/3dac1a51389678507d6e1a5090287f26/raw/666c93b2b36351942e806f4cedd4cf713d04d691/generate_tfrecord.py" rel="noopener ugc nofollow" target="_blank">https://gist.githubusercontent.com/whittlem/3dac1a51389678507d6e1a5090287f26/raw/666c93b2b36351942e806f4cedd4cf713d04d691/generate_tfrecord.py</a><br/>  <br/>  !python generate_tfrecord.py -x "/content/gdrive/MyDrive/$GDRIVE_ROOT/workspace/$PROJECT_NAME/images/train" -l "/content/gdrive/MyDrive/$GDRIVE_ROOT/workspace/$PROJECT_NAME/annotations/label_map.pbtxt" -o "/content/gdrive/MyDrive/$GDRIVE_ROOT/workspace/$PROJECT_NAME/annotations/train.record"<br/>  !python generate_tfrecord.py -x "/content/gdrive/MyDrive/$GDRIVE_ROOT/workspace/$PROJECT_NAME/images/test" -l "/content/gdrive/MyDrive/$GDRIVE_ROOT/workspace/$PROJECT_NAME/annotations/label_map.pbtxt" -o "/content/gdrive/MyDrive/$GDRIVE_ROOT/workspace/$PROJECT_NAME/annotations/test.record"</span></pre><p id="5844" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个函数将一些重要的脚本移动到正确的位置。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="ff11" class="nb nc it oc b gy og oh l oi oj">def move_scripts():<br/>  root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']<br/>  tensorflow_model = os.environ['TENSORFLOW_MODEL']</span><span id="7b3a" class="nb nc it oc b gy ol oh l oi oj">if os.path.isfile(f'/content/gdrive/MyDrive/{root_dir}/models/research/object_detection/model_main_tf2.py') \<br/>    and not os.path.isfile(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/model_main_tf2.py'):<br/>    print (f'copying /content/gdrive/MyDrive/{root_dir}/models/research/object_detection/model_main_tf2.py to /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')<br/>    copy(f'/content/gdrive/MyDrive/{root_dir}/models/research/object_detection/model_main_tf2.py', f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')</span><span id="262c" class="nb nc it oc b gy ol oh l oi oj">if os.path.isfile(f'/content/gdrive/MyDrive/{root_dir}/models/research/object_detection/exporter_main_v2.py') \<br/>    and not os.path.isfile(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/exporter_main_v2.py'):<br/>    print (f'copying /content/gdrive/MyDrive/{root_dir}/models/research/object_detection/exporter_main_v2.py to /content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')<br/>    copy(f'/content/gdrive/MyDrive/{root_dir}/models/research/object_detection/exporter_main_v2.py', f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')</span></pre><p id="aec7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此功能可选择启动张量板进行训练后分析。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="3330" class="nb nc it oc b gy og oh l oi oj">def start_tensorboard():<br/>  root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']</span><span id="293d" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')<br/>  %load_ext tensorboard<br/>  %tensorboard --logdir=models/$MY_MODEL</span></pre><p id="f0b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此函数根据原始文章对“<strong class="la iu"> pipeline.config </strong>”文件进行建议的更改。</p><p id="30c9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">重要提示:<br/> </strong>原文章将批量改为16。我对此有很多问题。由于内存问题，免费的Google Colab不断崩溃。我不得不把这种方式减少到4左右，如果不是更少的话。使用Google Colab Pro，我可以在12点运行它。如果你使用的是免费版本，那么尝试4，如果你有问题，那么尝试2。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="be83" class="nb nc it oc b gy og oh l oi oj">def update_pipeline_config():<br/>  root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']</span><span id="537e" class="nb nc it oc b gy ol oh l oi oj">with open(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/my_ssd_resnet50_v1_fpn/pipeline.config', 'r') as fh:<br/>    content = fh.read()<br/>    content_new = re_sub('num_classes: \d*', r'num_classes: ' + str(len(labels)), content, flags=M)<br/>    content_new = re_sub('batch_size: \d*', r'<strong class="oc iu">batch_size: 12</strong>', content_new, flags=M)<br/>    content_new = re_sub('fine_tune_checkpoint: .*', r'fine_tune_checkpoint: "pre-trained-models/' + os.environ['TENSORFLOW_MODEL'] + '/checkpoint/ckpt-0"', content_new, flags=M)<br/>    content_new = re_sub('num_steps: \d*', r'num_steps: 25000', content_new, flags=M)<br/>    content_new = re_sub('fine_tune_checkpoint_type: .*', r'fine_tune_checkpoint_type: "detection"', content_new, flags=M)<br/>    content_new = re_sub('use_bfloat16: .*', r'use_bfloat16: false', content_new, flags=M)<br/>    content_new = re_sub('label_map_path: .*', r'label_map_path: "annotations/label_map.pbtxt"', content_new, flags=M)<br/>    content_new = re_sub('input_path: ".*"', r'input_path: "annotations/test.record"', content_new, flags=M)<br/>    content_new = re_sub('input_path: ".*"', r'input_path: "annotations/train.record"', content_new, count=1, flags=M)<br/>    fh.close()</span><span id="f8a0" class="nb nc it oc b gy ol oh l oi oj">with open(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}/models/my_ssd_resnet50_v1_fpn/pipeline.config', 'w') as fh:<br/>      fh.write(content_new)<br/>      fh.close()</span></pre><p id="b9e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是训练模型的函数。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="2046" class="nb nc it oc b gy og oh l oi oj">def train_model():<br/>  root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']</span><span id="77b3" class="nb nc it oc b gy ol oh l oi oj">TF_CPP_MIN_LOG_LEVEL=2<br/>  os.chdir(f'/content/gdrive/MyDrive/{root_dir}/workspace/{project_name}')<br/>  !python model_main_tf2.py --model_dir=models/$MY_MODEL --pipeline_config_path=models/$MY_MODEL/pipeline.config</span></pre><p id="1e2f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将在完成后导出模型。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="0d53" class="nb nc it oc b gy og oh l oi oj">def export_model():<br/>  !python exporter_main_v2.py --input_type image_tensor --pipeline_config_path ./models/$MY_MODEL/pipeline.config --trained_checkpoint_dir ./models/$MY_MODEL/ --output_directory ./exported-models/my_model</span></pre><p id="1ad9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将上述所有函数放在一个代码单元中，但为了便于解释，只是将它们分开。在培养基中，编码细胞很小。我用代码创建了一个<a class="ae lu" href="https://gist.github.com/whittlem/4df46a9ca885bdf9cbed6df6ea7ebfa9" rel="noopener ugc nofollow" target="_blank"> GitHub Gist </a>,这将更容易审查。</p><p id="7b6e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个代码单元格应该是这样的。这是一个重要的单元格，因为它定义了我们使用的所有环境变量和标签。如果您有其他标签，可以将它们包含在列表中。我已经用粗体字标出了你想修改的项目。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="ec84" class="nb nc it oc b gy og oh l oi oj">os.environ['GDRIVE_ROOT'] = '<strong class="oc iu">TensorFlow</strong>'<br/>os.environ['PROJECT_NAME'] = '<strong class="oc iu">lions</strong>'<br/>os.environ['TENSORFLOW_MODEL'] = '<strong class="oc iu">ssd_resnet50_v1_fpn_640x640_coco17_tpu-8</strong>'<br/>os.environ['MY_MODEL'] = 'my_' + os.environ['TENSORFLOW_MODEL']<br/>os.environ['MY_MODEL'] = re_sub('fpn.*$', 'fpn', os.environ['MY_MODEL'])<br/>os.environ['PYTHONPATH'] += f":/content/gdrive/MyDrive/{os.environ['GDRIVE_ROOT']}/models"</span><span id="5ed2" class="nb nc it oc b gy ol oh l oi oj">sys.path.append(f"/content/gdrive/MyDrive/{os.environ['GDRIVE_ROOT']}/models/research")</span><span id="9e23" class="nb nc it oc b gy ol oh l oi oj">labels = [<br/>  <strong class="oc iu">(1, 'lion')</strong><br/>]</span></pre><p id="d77e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个代码单元将从Google Colab挂载您的Google Drive。它会要求您授权从Google Colab到Google Drive的连接。您需要从链接Google Colab复制令牌。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="179d" class="nb nc it oc b gy og oh l oi oj">mount_gdrive()</span></pre><p id="d258" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将初始化您的项目结构。你会看到它正在做的输出。如果它以前已经运行过，那么你不会看到任何输出。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="04d3" class="nb nc it oc b gy og oh l oi oj">create_gdrive_directory_structure()</span></pre><p id="c5bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">无论您是在训练还是加载模型，都需要运行下一个函数。它构建对象检测库。这可能需要一段时间。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="dca2" class="nb nc it oc b gy og oh l oi oj">build()</span></pre><p id="b37b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果一切顺利，您应该会在构建测试结束时看到这一点。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="1af0" class="nb nc it oc b gy og oh l oi oj">OK (skipped=1)<br/>Done</span></pre><p id="15a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在可以包含两个刚刚构建的库。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="c15b" class="nb nc it oc b gy og oh l oi oj">from object_detection.utils import label_map_util<br/>from object_detection.utils import visualization_utils as viz_utils</span></pre><p id="6098" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们需要生成我们的TFRecords。在运行之前，确保您已经将本地映像和相关的XML文件复制到项目的“<strong class="la iu">训练</strong>和“<strong class="la iu">测试</strong>目录中。你可以在Google Drive的“<strong class="la iu"> images </strong>”目录中找到这个。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="8729" class="nb nc it oc b gy og oh l oi oj">generate_tfrecords()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/28ebe1f211ba118024bfa46cbf4c347e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wSQm0tto8xXeHSC28nGfnQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="35b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个函数只是将我们需要的脚本移动到正确的位置。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="bfb0" class="nb nc it oc b gy og oh l oi oj">move_scripts()</span></pre><p id="194a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个可选步骤，但如果你想你可以开始TensorBoard。请注意，您只会在训练结束后看到一些内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/91118276d202de31c132c51467861980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrP8SHRrAqRE0_USY8RIlg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="22db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">"<strong class="la iu">当前数据集没有活动的仪表板。</strong>”是你第一次运行时所期望的。至少到目前为止是这样。在你训练好你的模型后，你会在这里看到一些有趣的分析。</p><p id="f354" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该函数对原文章中描述的“<strong class="la iu"> pipeline.config </strong>”进行所有必要的修改。正如我上面提到的，如果你使用Google Colab的免费版本<a class="ae lu" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"/>，那么就需要减少<strong class="la iu"> batch_size </strong>。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="c4bd" class="nb nc it oc b gy og oh l oi oj">update_pipeline_config()</span></pre><p id="360f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们一直在等待的部分…</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="e85e" class="nb nc it oc b gy og oh l oi oj">train_model()</span></pre><p id="ef48" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将需要很长时间。我第一次训练模型花了7个小时才完成，而且只用了我现在训练的一半图像。</p><p id="f3bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当你看到类似这样的训练日志时，你就会知道它在工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/0c2c23d928c554a8745f2c32253bc03d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m2M4el7uP8E-EASPSFHhnA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2ba2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是它完成25000步的最后一步！</p><p id="180a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦您的模型已经训练好，您会想要导出它，以便以后可以加载它。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="6829" class="nb nc it oc b gy og oh l oi oj">export_model()</span></pre><p id="055e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果一切按计划进行，你应该在最后看到这个。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/132db2f93dfbdf9513b45cbbc6a3f442.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IVSXuHpN8tBM938Gq413Qw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="a622" class="nb nc it bd nd ne nf dn ng nh ni dp nj lh nk nl nm ll nn no np lp nq nr ns nt bi translated">加载和使用模型</h2><p id="f0c8" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在这个阶段，我们应该已经将训练好的模型导出并准备就绪。</p><p id="b5ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有些代码单元/步骤是从本文的培训部分复制来的。我故意把它们分开，因为在大多数情况下，你只是想使用你的模型。</p><p id="97c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">像往常一样，第一步是导入我们的库。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="cb50" class="nb nc it oc b gy og oh l oi oj">import os<br/>import sys<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import warnings</span><span id="5b01" class="nb nc it oc b gy ol oh l oi oj">from google.colab import drive<br/>from re import sub as re_sub<br/>from tensorflow import saved_model, convert_to_tensor, newaxis<br/>from PIL import Image</span><span id="152a" class="nb nc it oc b gy ol oh l oi oj">warnings.filterwarnings('ignore')</span></pre><p id="a7f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们定义我们的环境变量。我用粗体突出显示了三个可能被编辑的参数。根据本演示，您可以将它们留在下面。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="7c4a" class="nb nc it oc b gy og oh l oi oj">os.environ['GDRIVE_ROOT'] = '<strong class="oc iu">TensorFlow</strong>'<br/>os.environ['PROJECT_NAME'] = '<strong class="oc iu">lions</strong>'<br/>os.environ['TENSORFLOW_MODEL'] = '<strong class="oc iu">ssd_resnet50_v1_fpn_640x640_coco17_tpu-8</strong>'<br/>os.environ['MY_MODEL'] = 'my_' + os.environ['TENSORFLOW_MODEL']<br/>os.environ['MY_MODEL'] = re_sub('fpn.*$', 'fpn', os.environ['MY_MODEL'])<br/>os.environ['PYTHONPATH'] += f":/content/gdrive/MyDrive/{os.environ['GDRIVE_ROOT']}/models"</span><span id="f99e" class="nb nc it oc b gy ol oh l oi oj">sys.path.append(f"/content/gdrive/MyDrive/{os.environ['GDRIVE_ROOT']}/models/research")</span></pre><p id="7576" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我有一个代码单元，其中包含了我创建的所有函数。我将把它们分开来解释，但你可能想把它们都放在一个单元格中。</p><p id="ef8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将再次需要此功能来安装您的Google Drive。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="7159" class="nb nc it oc b gy og oh l oi oj">def mount_gdrive():<br/>  if not os.path.isdir('/content/gdrive'):<br/>    drive.mount('/content/gdrive')</span></pre><p id="8a4f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">构建函数也与我们在本文的培训部分使用的函数完全相同。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="0c37" class="nb nc it oc b gy og oh l oi oj">def build():<br/>  root_dir = os.environ['GDRIVE_ROOT']<br/>  project_name = os.environ['PROJECT_NAME']<br/>  tensorflow_model = os.environ['TENSORFLOW_MODEL']</span><span id="1e1c" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/models/research')<br/>  !git checkout -f e04dafd04d69053d3733bb91d47d0d95bc2c8199</span><span id="2564" class="nb nc it oc b gy ol oh l oi oj">!apt-get install protobuf-compiler python-lxml python-pil<br/>  !pip install Cython pandas tf-slim lvis</span><span id="9d1f" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/models/research')<br/>  !protoc object_detection/protos/*.proto --python_out=.</span><span id="314d" class="nb nc it oc b gy ol oh l oi oj">!python setup.py build<br/>  !python setup.py install</span><span id="3a7c" class="nb nc it oc b gy ol oh l oi oj">os.chdir(f'/content/gdrive/MyDrive/{root_dir}/models/research/object_detection/builders')<br/>  !python model_builder_tf2_test.py<br/>  print('Done')</span></pre><p id="3421" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个函数将加载我们的模型。它将返回一个带有检测函数“<strong class="la iu"> detect_fn </strong>”和类别索引“<strong class="la iu"> category_index </strong>”的元组。这些将是“<strong class="la iu">过程_图像</strong>”功能的输入。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="bbcd" class="nb nc it oc b gy og oh l oi oj">def load_model(model: str='', label_map: str=''):<br/>  if model == '' and os.getenv('GDRIVE_ROOT') and os.getenv('PROJECT_NAME'):<br/>    model = '/content/gdrive/MyDrive/' + os.getenv('GDRIVE_ROOT') + '/workspace/' + os.getenv('PROJECT_NAME') + '/exported-models/my_model/saved_model'</span><span id="1013" class="nb nc it oc b gy ol oh l oi oj">if label_map == '' and os.getenv('GDRIVE_ROOT') and os.getenv('PROJECT_NAME'):<br/>    label_map = f'/content/gdrive/MyDrive/' + os.getenv('GDRIVE_ROOT') + '/workspace/' + os.getenv('PROJECT_NAME') + '/annotations/label_map.pbtxt'</span><span id="32b0" class="nb nc it oc b gy ol oh l oi oj">if model == '' or label_map == '':<br/>    raise ValueError('model and label_map.pbtxt locations required!')</span><span id="d2a2" class="nb nc it oc b gy ol oh l oi oj">if not os.path.exists(model):<br/>    raise IOError(f'model not found: {model}')</span><span id="9580" class="nb nc it oc b gy ol oh l oi oj">if not os.path.isfile(label_map):<br/>    raise IOError(f'label_map.pbtxt not found: {label_map}')</span><span id="4dfd" class="nb nc it oc b gy ol oh l oi oj">print('Loading model... ', end='')<br/>  resp_tuple = (saved_model.load(model), label_map_util.create_category_index_from_labelmap(label_map, use_display_name=True))<br/>  print ('done.')</span><span id="b7ac" class="nb nc it oc b gy ol oh l oi oj">return resp_tuple</span></pre><p id="7d19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个辅助函数将把一个图像转换成一个Numpy数组。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="8c31" class="nb nc it oc b gy og oh l oi oj">def image2ndarray(path):<br/>  return np.array(Image.open(path))</span></pre><p id="f95d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该功能将显示我们处理过的图像。这个函数可能需要一些解释。前两个参数"<strong class="la iu"> detect_fn </strong>和"<strong class="la iu"> category_index </strong>"是"<strong class="la iu"> load_module </strong>"函数的输出。<strong class="la iu"> img_path </strong>是输入图像的位置。在<a class="ae lu" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>中输出图像比例相当小。我已经添加了“<strong class="la iu"> img_scale </strong>”，它允许你像浮动一样增加尺寸。例如，您可以使用1.5将图像缩放1.5倍。"<strong class="la iu">裁剪</strong>"是另一个可选参数，它将裁剪并显示检测到的边界框。</p><p id="bb14" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有几个要点要提一下。第一个是对于每个图像，许多检测可能以不同的精确度被发现。我们不希望看到任何得分低于50%的检测。如果你看下面的函数，你会看到“<strong class="la iu">最小分数阈值</strong>”。这是一个超参数，表示我们只对高分检测感兴趣。</p><p id="2ec3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还值得一提的是，检测都是在0和1之间标准化。例如，如果图像是1024x768，标签从中间开始，您将看到x=0.5和y = 0.5，而不是x=512和y=384。为了找到绝对位置，我们需要找到图像的实际尺寸，然后乘以标准化值。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="bb89" class="nb nc it oc b gy og oh l oi oj">def process_image(detect_fn: None, category_index: None, img_path: str='', img_scale: float=1, crop: bool=False):<br/>  if not os.path.isfile(img_path):<br/>    raise IOError(f'input image not found: {img_path}')</span><span id="f708" class="nb nc it oc b gy ol oh l oi oj">  img_path_split = img_path.split('.')<br/>    if img_path_split[1].lower() in ['png']:<br/>      img = Image.open(img_path)<br/>      img_path = f"{img_path_split[0]}.jpg"<br/>      img = img.convert('RGB')<br/>      img.save(img_path)</span><span id="40eb" class="nb nc it oc b gy ol oh l oi oj">  print('Running inference for {}'.format(img_path), end='')<br/>  img_np=image2ndarray(img_path)</span><span id="6576" class="nb nc it oc b gy ol oh l oi oj">  input_tensor = convert_to_tensor(img_np)<br/>  input_tensor = input_tensor[newaxis, ...]</span><span id="2fdc" class="nb nc it oc b gy ol oh l oi oj">  detections=detect_fn(input_tensor)</span><span id="ddfd" class="nb nc it oc b gy ol oh l oi oj">  num_detections = int(detections.pop('num_detections'))<br/>  detections={key:value[0, :num_detections].numpy() for key,value in detections.items()}<br/>  detections['num_detections'] = num_detections</span><span id="1739" class="nb nc it oc b gy ol oh l oi oj">  detections['detection_classes'] = detections['detection_classes'].astype(np.int64)</span><span id="f50f" class="nb nc it oc b gy ol oh l oi oj">  img_np_with_detections = img_np.copy()</span><span id="80e7" class="nb nc it oc b gy ol oh l oi oj">  min_score_thresh = .5</span><span id="71fc" class="nb nc it oc b gy ol oh l oi oj">  viz_utils.visualize_boxes_and_labels_on_image_array(<br/>    img_np_with_detections,<br/>    detections['detection_boxes'],<br/>    detections['detection_classes'],<br/>    detections['detection_scores'],<br/>    category_index,<br/>    use_normalized_coordinates=True,<br/>    max_boxes_to_draw=100,     <br/>    min_score_thresh=min_score_thresh,      <br/>    agnostic_mode=False)<br/>  <br/>  img_file=Image.open(img_path)<br/>  img_width, img_height=img_file.size<br/>  print('')<br/>  print(f'Image size: {img_width}x{img_height}px')</span><span id="c7d5" class="nb nc it oc b gy ol oh l oi oj">  for i in range(min(detections['detection_boxes'].shape[0], detections['detection_boxes'].shape[0])):<br/>    if detections['detection_scores'] is None or detections['detection_scores'][i] &gt; min_score_thresh:<br/>      ymin, xmin, ymax, xmax = detections['detection_boxes'][i]<br/>      x1, x2, y1, y2 = (int(xmin * img_width), int(xmax * img_width), int(ymin * img_height), int(ymax * img_height)) # left, right, top, bottom</span><span id="7edd" class="nb nc it oc b gy ol oh l oi oj">    class_name = category_index[detections['detection_classes'][i]]['name']<br/>  print('detection:', detections['detection_boxes'][i], 'is a', class_name, 'translated to (' + str(x1) + ', ' + str(y1) + ', ' + str(x2) + ', ' + str(y2) + ') pixels')</span><span id="ae41" class="nb nc it oc b gy ol oh l oi oj">    if crop:<br/>      img_crop = img_file.crop((x1, y1, x2, y2)) # left, top, right, bottom<br/>      display(img_crop)</span><span id="cd57" class="nb nc it oc b gy ol oh l oi oj">  %matplotlib inline<br/>  fig=plt.figure()<br/>  img_size=fig.get_size_inches()<br/>  print (f'Render scale: {img_scale}x')<br/>  fig.set_size_inches(img_size[0]*img_scale, img_size[1]*img_scale) <br/>  plt.imshow(img_np_with_detections, aspect='auto')<br/>  print('Done')<br/>  plt.show()</span></pre><p id="3c53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里的代码可能很难阅读，所以为了方便起见，我创建了一个<a class="ae lu" href="https://gist.github.com/whittlem/812b06f40bdd3b73a764ba4833d49d95" rel="noopener ugc nofollow" target="_blank"> GitHub Gist </a>。</p><p id="a982" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使用这些功能，我们的下一个单元将是安装我们的Google Drive，构建我们的附加库，并包含我们构建的库(就像我们在培训步骤中所做的那样)</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="28c4" class="nb nc it oc b gy og oh l oi oj">mount_gdrive()</span></pre><p id="f6f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后构建我们的附加库。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="bddc" class="nb nc it oc b gy og oh l oi oj">build()</span></pre><p id="3678" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后包括我们构建的库。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="af20" class="nb nc it oc b gy og oh l oi oj">from object_detection.utils import label_map_util<br/>from object_detection.utils import visualization_utils as viz_utils</span></pre><p id="2a68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们将加载我们的模块，该模块将返回一个我们接下来需要的元组。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="f81d" class="nb nc it oc b gy og oh l oi oj"><strong class="oc iu">detect_fn</strong>, <strong class="oc iu">category_index</strong> = load_model(<br/>  model = '/content/gdrive/MyDrive/TensorFlow/workspace/<strong class="oc iu">lions</strong>/exported-models/my_model/saved_model',<br/>  label_map = '/content/gdrive/MyDrive/TensorFlow/workspace/<strong class="oc iu">lions</strong>/annotations/label_map.pbtxt'<br/>)</span></pre><p id="03c9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们处理我们的图像…</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="4cd6" class="nb nc it oc b gy og oh l oi oj">process_image(<br/>  detect_fn = detect_fn,<br/>  category_index = category_index,<br/>  img_path = f"/content/gdrive/My Drive/{os.environ['GDRIVE_ROOT']}/workspace/{os.environ['PROJECT_NAME']}/images/test/IMG_1938.JPG',<br/>  img_scale = 4,<br/>  crop = True<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/a5fb3452bca6aedf0d7fac7015b7c8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhbrVTJCTCwRtwyvenauKw.png"/></div></div></figure><p id="1506" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你所看到的，它找到了一只100%自信的狮子，另一只79%自信的在后面。</p><h2 id="0c58" class="nb nc it bd nd ne nf dn ng nh ni dp nj lh nk nl nm ll nn no np lp nq nr ns nt bi translated">概括起来</h2><p id="4004" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">我希望您发现原始文章的这一增强很有用。我试图弥补差距，解决大多数问题，并尽可能多地尝试自动化。我已经在几个不同的个人和专业项目中使用了这个过程，效果很好。您可能面临的两个潜在问题是Google Drive中的磁盘空间(它需要几个空闲Gb)和Google Colab中的资源。Google Colab中的资源问题是一个相当简单的修复方法，因为你可以调低“<strong class="la iu"> batch_size </strong>”，这应该可以帮你解决这个问题。你还需要一点耐心，因为训练一个模型可能需要几个小时:)</p><p id="10d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python是对缩进敏感的，我很欣赏在中型文章中展示代码并不总是按照预期的方式格式化。如果你想让我与你分享练习册，请在评论中告诉我。</p><p id="91b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢这篇文章，我建议你看看下面的文章:</p><div class="mj mk gp gr ml mm"><a href="https://medium.com/geekculture/using-aws-sagemaker-to-solve-machine-learning-ai-problems-3c5896da2b2d" rel="noopener follow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">使用AWS SageMaker解决机器学习和人工智能问题</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">大规模构建、训练和部署机器学习模型</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">medium.com</p></div></div><div class="mv l"><div class="or l mx my mz mv na ks mm"/></div></div></a></div><div class="mj mk gp gr ml mm"><a href="https://levelup.gitconnected.com/predicting-titanic-survivors-using-ml-8570ef4e89e8" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">用最大似然法预测泰坦尼克号幸存者</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">我通过荣誉退休一直在哥伦比亚工程学习应用机器学习。这是一个5个月的课程，我…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mv l"><div class="os l mx my mz mv na ks mm"/></div></div></a></div><div class="mj mk gp gr ml mm"><a href="https://levelup.gitconnected.com/predicting-house-sale-prices-using-ml-30b829fd9556" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">用最大似然法预测房价</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">我通过荣誉退休一直在哥伦比亚工程学习应用机器学习。这是一个5个月的课程，我…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mv l"><div class="ot l mx my mz mv na ks mm"/></div></div></a></div><div class="mj mk gp gr ml mm"><a href="https://levelup.gitconnected.com/categorising-using-machine-learning-5601baf9a05e" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">使用机器学习进行分类</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">我通过荣誉退休一直在哥伦比亚工程学习应用机器学习。这是一个5个月的课程，我…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mv l"><div class="ou l mx my mz mv na ks mm"/></div></div></a></div><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/spotify-artist-recommender-7950af1fe20a"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">Spotify艺术家推荐</h2><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="ov l mx my mz mv na ks mm"/></div></div></a></div><h1 id="9ad0" class="ow nc it bd nd ox oy oz ng pa pb pc nj jz pd ka nm kc pe kd np kf pf kg ns pg bi translated">迈克尔·惠特尔</h1><ul class=""><li id="5c79" class="lv lw it la b lb nu le nv lh ph ll pi lp pj lt ma mb mc md bi translated"><strong class="la iu"> <em class="oa">如果你喜欢这个，请</em> </strong> <a class="ae lu" href="https://whittle.medium.com/" rel="noopener"> <strong class="la iu"> <em class="oa">跟我上媒</em> </strong> </a></li><li id="ac0c" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><strong class="la iu"> <em class="oa">有兴趣合作吗？让我们连线上</em></strong><a class="ae lu" href="https://www.linkedin.com/in/miwhittle/" rel="noopener ugc nofollow" target="_blank"><strong class="la iu"><em class="oa">LinkedIn</em></strong></a></li></ul></div></div>    
</body>
</html>