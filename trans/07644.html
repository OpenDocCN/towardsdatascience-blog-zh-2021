<html>
<head>
<title>3 easy ways to crosstab in pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫中交叉表的3种简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-easy-ways-to-crosstab-in-pandas-4123383bfbf2?source=collection_archive---------8-----------------------#2021-07-13">https://towardsdatascience.com/3-easy-ways-to-crosstab-in-pandas-4123383bfbf2?source=collection_archive---------8-----------------------#2021-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c631" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提高数据处理技能的实用技巧</h2></div><p id="774e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">交叉制表是检验两个或更多分类变量<em class="le">或离散变量</em>之间关系的简单而有效的方法。在本帖中，我们将看看在熊猫身上创建交叉表格的三种简单而有用的方法。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/2308a26f8d76e9de1569d75b4fa353a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0VvkaA5ThDqh3rSP"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">由<a class="ae lv" href="https://unsplash.com/@maartendeckers?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马腾·德克斯</a>在<a class="ae lv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="4761" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">0.数据📦</h1><p id="2d7d" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">在本文中，我们将使用<em class="le"> seaborn的技巧</em>数据集。</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="7075" class="nf me it nb b gy ng nh l ni nj">import pandas as pd # <em class="le">This post uses pandas v1.3.0.</em><br/>from seaborn import load_dataset</span><span id="03c6" class="nf me it nb b gy nk nh l ni nj"># Import data<br/>df = load_dataset("tips")<br/>df.head()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/cb3e321ceec43bdbb8a0921598f18e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*A85Cp16yT-97FffCl-xyEw.png"/></div></figure><p id="1b41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于这个数据集(包括数据字典)的细节可以在这里找到<a class="ae lv" href="https://vincentarelbundock.github.io/Rdatasets/doc/reshape2/tips.html" rel="noopener ugc nofollow" target="_blank">(这个源实际上是针对R的，但是它看起来是指同一个底层数据集)。数据描述引用如下，以便快速访问:</a></p><blockquote class="nm nn no"><p id="d479" class="ki kj le kk b kl km ju kn ko kp jx kq np ks kt ku nq kw kx ky nr la lb lc ld im bi translated">一名服务员记录了他在一家餐馆工作几个月期间收到的每一笔小费的信息</p></blockquote><p id="ba7f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们来看看数据框的摘要:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="c2a8" class="nf me it nb b gy ng nh l ni nj">df.info()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/66c6d98b480471d15e00729d131f4ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*Gzpu6PQswzl3s5FhWE0w1Q.png"/></div></figure><p id="8e68" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有244个记录和7个变量(4个分类变量和3个数值变量)。没有缺失值。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="27e4" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">📍 1.使用交叉表()</h1><p id="8dd4" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">第一种方法是使用<code class="fe nt nu nv nb b">crosstab()</code>。这个函数使得计算总数和百分比变得非常容易。</p><h2 id="f060" class="nf me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">📘 1.1.计数和百分比</h2><p id="065b" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">让我们统计一下<em class="le">时间</em>和<em class="le">日期</em>的类别:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="c949" class="nf me it nb b gy ng nh l ni nj">pd.crosstab(df['time'], df['day'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/24c550b67d42c2260b881de49e5f8cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*d0WVHqnqNuyUiCV9KRqARQ.png"/></div></figure><p id="361e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这个表中，我们可以看到这个数据集中没有周末午餐时间的记录。这可能暗示我们，要么记录的服务员在周末午餐时间不工作，要么餐馆在周末午餐时间不营业。</p><p id="bd37" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过调整以下参数，可以使用<code class="fe nt nu nv nb b">crosstab()</code>轻松地转换为百分比或相加总计:<br/> ✅️ ️ <code class="fe nt nu nv nb b">normalize='columns'</code>:转换为列% <br/> ✅️ ️ <code class="fe nt nu nv nb b">normalize='index'</code>:转换为行% <br/> ✅️ ️ <code class="fe nt nu nv nb b">normalize='all'</code>或️ <code class="fe nt nu nv nb b">normalize=True</code>:转换为表% <br/> ✅️ ️ <code class="fe nt nu nv nb b">margins=True</code>:相加总计(总计的类型取决于<code class="fe nt nu nv nb b">normalize</code>参数)</p><p id="d269" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看一个例子:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="74b1" class="nf me it nb b gy ng nh l ni nj">pd.crosstab(df['time'], df['day'], normalize='index', margins=True)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/c2e1d88452aac3e8625bd77559591605.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*QrEl4rFRy5AZlNv3Yhp2Qg.png"/></div></figure><p id="2cdb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">行总计在这里不会提供太多的值，因为每个行总计只会显示1，所以pandas很聪明，在这个例子中只显示列总计。如果您正在使用Python，尝试调整到不同的<code class="fe nt nu nv nb b">normalize</code>和<code class="fe nt nu nv nb b">margins</code>组合，并注意表格是如何变化的。</p><h2 id="db32" class="nf me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">📙 1.2.聚合数值</h2><p id="2e13" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">除了按类别获取计数和百分比，我们还可以按类别查看数值变量的值。例如，我们可以通过<em class="le">日</em>和<em class="le">时</em>得到中位数<em class="le">小费</em>，如下所示:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="2cca" class="nf me it nb b gy ng nh l ni nj">pd.crosstab(df['time'], df['day'], df['tip'], aggfunc='median')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/3595aa85047681549a4ac032ef15f15d.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*tasfQF7DzMb_F_mT7IoF2Q.png"/></div></figure><p id="ca65" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以在行和列中包含多个变量:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="bdef" class="nf me it nb b gy ng nh l ni nj">pd.crosstab([df['sex'], df['smoker']], <br/>            [df['time'], df['day']], <br/>            df['tip'], aggfunc='median')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ok"><img src="../Images/832c68ae02b9d2cf91afdcad038612fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*a6-HrJbS6Sjgh-OZjtgMXQ.png"/></div></div></figure><p id="19f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要获得多个聚合，我们可以在一个列表中传递它们:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="5943" class="nf me it nb b gy ng nh l ni nj">pd.crosstab(df['time'], df['day'], df['tip'], <br/>            aggfunc=['median', 'mean'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/c02990e8a19c6cf0e2ec4b0b5406f936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*4SAqpXmcuZJW69T5Wl7jqQ.png"/></div></figure><p id="87cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nt nu nv nb b">crosstab()</code>的一个缺点是，每次我们指定一个有点重复的变量时，我们都需要引用数据帧的名称。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="fbb4" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">📍 2.使用pivot_table()</h1><p id="304d" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">下一个函数(或方法)是<code class="fe nt nu nv nb b">pivot_table()</code>。当按类别聚合数字变量时，这种方法非常灵活。</p><h2 id="8600" class="nf me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">📘 2.1.计数和百分比</h2><p id="cf3a" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">让我们用<code class="fe nt nu nv nb b">pivot_table()</code>重新创建上一节的第一个交叉表:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="f052" class="nf me it nb b gy ng nh l ni nj">pd.pivot_table(df, 'tip', 'time', 'day', aggfunc='count')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/172f23041dfc3a58baccffe355b836e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*sqDBjjBziRfigwqel4GkJA.png"/></div></figure><p id="54b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也可以使用DataFrame方法编写此查询:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="e36d" class="nf me it nb b gy ng nh l ni nj">df.pivot_table('tip', 'time', 'day', aggfunc='count')</span></pre><p id="a555" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以用<code class="fe nt nu nv nb b">margins=True</code>得到行、列和表格的总数:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="4ee4" class="nf me it nb b gy ng nh l ni nj">df.pivot_table('tip', 'time', 'day', aggfunc='count', margins=True)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/fecca128b5e88f08a962de0294f9b285.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*Id7TBiTGmxRCmeF9TeZQSQ.png"/></div></figure><p id="ee74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与<code class="fe nt nu nv nb b">crosstab()</code>不同，我们需要第三个变量:<em class="le">提示</em>来获取计数，并且没有一个简单的选项来获取百分比。但是我们不必在每次引用变量时重复输入数据帧名称。</p><h2 id="d5cd" class="nf me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">📙 2.2.聚合数值</h2><p id="e285" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">让我们看一下从上一节中获取相同的三个表的语法:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="1913" class="nf me it nb b gy ng nh l ni nj">df.pivot_table('tip', 'time', 'day', aggfunc='median')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi on"><img src="../Images/0a16dfdd7427ebc4fc7267e4768f107f.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*9KMeUh783qEQ9FgW4UNr2w.png"/></div></div></figure><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="01cf" class="nf me it nb b gy ng nh l ni nj">df.pivot_table('tip', ['sex', 'smoker'], ['time', 'day'], <br/>               aggfunc='median')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oo"><img src="../Images/5eb25f1b931ce970fec65544cfe09c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*2OfZxUcozQxoCTZm_l5YMw.png"/></div></div></figure><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="1df6" class="nf me it nb b gy ng nh l ni nj">df.pivot_table('tip', 'time', 'day', aggfunc=['median', 'mean'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/8dcb8789865d10e586d68b9037c4ffe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*iI0CIkz_wYoHoxSJnDvFog.png"/></div></figure><p id="5e11" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另外，我们可以用<code class="fe nt nu nv nb b">pivot_table()</code>看多个数值变量。这在目前的<code class="fe nt nu nv nb b">crosstab()</code>中是不可能的。我们可以按如下类别聚合多个数字列:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="6dce" class="nf me it nb b gy ng nh l ni nj">df.pivot_table(['tip', 'total_bill'], 'time', 'day', <br/>               aggfunc='median')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/afd133952a0a3e9252e90ac960c85409.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*-sqlxVuODI4UiLJ3ASPrbA.png"/></div></figure><p id="2592" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们不指定values参数，它将使用DataFrame中的所有数字列。</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="0e7c" class="nf me it nb b gy ng nh l ni nj">df.pivot_table(index='time', columns='day', aggfunc='median')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/46d3c5ce7c6388ed0989d8fcb9f0a4df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*NLN8zgOUuzlnPd1wmOh45w.png"/></div></figure><p id="567e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为没有提供第一个参数:values，所以我们不能再按位置传递参数。所以这一次，我们必须指定每个参数。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="9ca4" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">📍 3.使用groupby() + unstack()</h1><p id="4177" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">这种方法非常类似于SQL或R (tidyverse)等语言中的聚合方式。因此，这可能是最常见的获取交叉列表的方法。</p><h2 id="02ba" class="nf me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">📘 3.1.计数和百分比</h2><p id="3a44" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">通过这种方法，我们可以得到<em class="le">时间</em>和<em class="le">日期</em>的计数，如下所示:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="f459" class="nf me it nb b gy ng nh l ni nj">df.groupby(['time', 'day']).size().unstack()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/563cbb83ac789cdcdf2f2307f20b13f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*m8pJ_ydkphRxpIffo_VwjA.png"/></div></figure><p id="2406" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获得总数或转换成百分比需要额外的数据操作，因为我们不再像前两节那样使用专门的函数。</p><h2 id="2385" class="nf me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">📙 3.2.聚合数值</h2><p id="2c4c" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">为了在中位数<em class="le">提示</em>上得到相同的表格，我们使用:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="010a" class="nf me it nb b gy ng nh l ni nj">df.groupby(['time', 'day'])['tip'].median().unstack()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d4effa78a5aaf581799aacfbb1985bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*tEQtMvY4eNS7NvIuIoKhbw.png"/></div></figure><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="17e3" class="nf me it nb b gy ng nh l ni nj">df.groupby(['sex', 'smoker', 'time', 'day'])['tip']\<br/>  .median().unstack(['time', 'day'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/dbaffdabfbfd5e3ba7340715810b1082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*Xvo1tUNsaN18HwsIUUoHxg.png"/></div></figure><p id="f8ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此方法显示每个类别组合。结果，现在显示了周末午餐的空列，输出不如以前清晰。</p><p id="656c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以使用多个聚合函数:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="da28" class="nf me it nb b gy ng nh l ni nj">df.groupby(['time', 'day'])['tip'].agg(['median', 'mean']).unstack()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/b4625b5a73b6c3eb145d8daa4cb6d170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*kpIXqDBL1g5XDZbJ44oXig.png"/></div></figure><p id="3a80" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">类似于<code class="fe nt nu nv nb b">pivot_table()</code>，我们也可以看多个数值变量:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="1f13" class="nf me it nb b gy ng nh l ni nj">df.groupby(['time', 'day'])[['tip', 'total_bill']].median()\<br/>  .unstack()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/05f421741a3ff65f0d95b68141bda31f.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*rrWFj31OzW7qXVHys7RJxA.png"/></div></figure><p id="0917" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与<code class="fe nt nu nv nb b">pivot_table()</code>相比，通过<em class="le">时间</em>和<em class="le">天</em>用<code class="fe nt nu nv nb b">groupby()</code>和<code class="fe nt nu nv nb b">unstack()</code>更容易得到所有数值变量的统计:</p><pre class="lg lh li lj gt na nb nc nd aw ne bi"><span id="5cb8" class="nf me it nb b gy ng nh l ni nj">df.groupby(['time', 'day']).median().unstack()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/8210958086f9d6d95f476514ae7f38ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*_LLb4wKLcDaTL6ZKd1SDRw.png"/></div></figure><p id="75a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就把它带到了这篇帖子的结尾！虽然这三种方法有相似之处，但对于某些任务，其中一种方法可以提供比其他方法更好的解决方案。希望您在下一个数据操作任务中能够熟练地使用它们！</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ox"><img src="../Images/417d0bdf46a871d6f444a969567599b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PgGuwu_eQ9djZpC_"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">塞缪尔·布林格森在<a class="ae lv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="18d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">您想访问更多这样的内容吗？媒体会员可以无限制地访问媒体上的任何文章。如果您使用</em> <a class="ae lv" href="https://zluvsand.medium.com/membership" rel="noopener"> <em class="le">我的推荐链接</em></a><em class="le">成为会员，您的一部分会费将直接用于支持我。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="ac07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您阅读这篇文章。如果你感兴趣，这里有我关于熊猫的一些其他帖子的链接:<br/> ◼️️ <a class="ae lv" rel="noopener" target="_blank" href="/writing-5-common-sql-queries-in-pandas-90b52f17ad76?source=your_stories_page-------------------------------------">在熊猫中编写5个常见的SQL查询</a> <br/> ◼️️ <a class="ae lv" rel="noopener" target="_blank" href="/writing-advanced-sql-queries-in-pandas-1dc494a17afe?source=your_stories_page-------------------------------------">在熊猫中编写高级SQL查询</a> <br/> ◼️️ <a class="ae lv" rel="noopener" target="_blank" href="/5-tips-for-pandas-users-e73681d16d17?source=your_stories_page-------------------------------------">给熊猫用户的5个提示</a> <br/> ◼️️ <a class="ae lv" rel="noopener" target="_blank" href="/5-tips-for-data-aggregation-in-pandas-7eaa8476dc75?source=your_stories_page-------------------------------------">在熊猫中进行数据聚合的5个提示</a> <br/> ◼️️ <a class="ae lv" rel="noopener" target="_blank" href="/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1?source=your_stories_page-------------------------------------">如何在熊猫数据框架中转换变量</a> <br/> ◼️️ <a class="ae lv" href="https://medium.com/p/5b2cbe73d60e/edit" rel="noopener"> 3个简单方法</a></p><p id="2d04" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">再见🏃 💨</p></div></div>    
</body>
</html>