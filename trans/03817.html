<html>
<head>
<title>CIFAR 100: Transfer Learning using EfficientNet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CIFAR 100:ä½¿ç”¨EfficientNetè¿›è¡Œè¿ç§»å­¦ä¹ </h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/cifar-100-transfer-learning-using-efficientnet-ed3ed7b89af2?source=collection_archive---------3-----------------------#2021-03-30">https://towardsdatascience.com/cifar-100-transfer-learning-using-efficientnet-ed3ed7b89af2?source=collection_archive---------3-----------------------#2021-03-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="be3c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">ä½¿ç”¨æœ€å…ˆè¿›çš„EfficientNet-B0è¿›è¡Œè¿ç§»å­¦ä¹ </h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/97b2167db4dcedd5971ae55dc87eca55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_hI9siTZ5x1jLRiuPeSSqw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ç›ä¸½å¨œÂ·ç»´å¡”è±åœ¨<a class="ae kv" href="https://unsplash.com/photos/t809JJ6r9KA" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></figure><p id="82e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">å·ç§¯ç¥ç»ç½‘ç»œ</strong> (CNN)æ˜¯ä¸€ç±»å¸¸ç”¨äºåˆ†æå›¾åƒçš„æ·±åº¦ç¥ç»ç½‘ç»œã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ„å»ºä¸€ä¸ªCNNæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å¯ä»¥æ­£ç¡®è¯†åˆ«ç‰©ä½“çš„å½©è‰²å›¾åƒå¹¶å°†å…¶åˆ†ç±»åˆ°CIFAR-100æ•°æ®é›†çš„100ä¸ªå¯ç”¨ç±»ä¸­çš„ä¸€ä¸ªã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬å°†é‡ç”¨ä¸€ä¸ªæœ€å…ˆè¿›çš„æŠ€æœ¯ä½œä¸ºæˆ‘ä»¬æ¨¡å‹çš„èµ·ç‚¹ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºè¿ç§»å­¦ä¹ ã€‚â¡ï¸</p><p id="ea34" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯è¿ç§»å­¦ä¹ ã€‚æˆ‘ä¸ä¼šè®²å¤ªå¤šç»†èŠ‚ï¼Œä½†ä¼šå°è¯•åˆ†äº«ä¸€äº›çŸ¥è¯†ã€‚ğŸ“</p><h1 id="f72c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">è¿ç§»å­¦ä¹ </strong></h1><p id="d761" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><em class="mp">å¦‚ã€Šæœºå™¨å­¦ä¹ åº”ç”¨ç ”ç©¶æ‰‹å†Œã€‹æ‰€è¿°ï¼Œ</em> <strong class="ky ir"> <em class="mp">è¿ç§»å­¦ä¹ </em> </strong> <em class="mp">æ˜¯é€šè¿‡ä»ä¸€ä¸ªå·²ç»å­¦ä¹ è¿‡çš„ç›¸å…³ä»»åŠ¡ä¸­è¿ç§»çŸ¥è¯†ï¼Œåœ¨ä¸€ä¸ªæ–°ä»»åŠ¡ä¸­å¯¹å­¦ä¹ çš„æé«˜ã€‚</em></p><p id="75e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç®€å•æ¥è¯´ï¼Œè¿ç§»å­¦ä¹ <strong class="ky ir"> </strong>æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œåœ¨ä¸€ä¸ªä»»åŠ¡ä¸Šè®­ç»ƒçš„æ¨¡å‹è¢«é‡æ–°ç”¨äºç¬¬äºŒä¸ªç›¸å…³çš„ä»»åŠ¡ã€‚æ·±åº¦å­¦ä¹ ç½‘ç»œæ˜¯èµ„æºé¥¥æ¸´çš„ï¼Œå¹¶ä¸”å…·æœ‰æ•°ç™¾ä¸‡ä¸ªå‚æ•°ï¼Œè®¡ç®—æˆæœ¬å¾ˆé«˜ã€‚è¿™äº›ç½‘ç»œç”¨å¤§é‡æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œä»¥é¿å…è¿‡åº¦æ‹Ÿåˆã€‚å› æ­¤ï¼Œå½“ä¸€ä¸ªæœ€å…ˆè¿›çš„æ¨¡å‹è¢«åˆ›é€ å‡ºæ¥æ—¶ï¼Œé€šå¸¸éœ€è¦ç ”ç©¶äººå‘˜èŠ±è´¹å¤§é‡çš„æ—¶é—´è¿›è¡ŒåŸ¹è®­ã€‚ç”±äºä¸€ä¸ªæœ€å…ˆè¿›çš„æ¨¡å‹æ˜¯åœ¨èŠ±è´¹å¦‚æ­¤å·¨å¤§çš„èµ„æºåè®­ç»ƒå‡ºæ¥çš„ï¼Œç ”ç©¶è€…è®¤ä¸ºè¿™ç§æŠ•èµ„çš„æ”¶ç›Šåº”è¯¥æ˜¯å¤šæ¬¡æ”¶è·çš„ï¼Œå› æ­¤äº§ç”Ÿäº†è¿ç§»å­¦ä¹ çš„æ¦‚å¿µã€‚</p><p id="2b4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿ç§»å­¦ä¹ çš„æœ€å¤§å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é‡ç”¨æ•´ä¸ªæ¨¡å‹æˆ–æ¨¡å‹çš„æŸä¸€éƒ¨åˆ†ã€‚å—¯ï¼Œèªæ˜ï¼ğŸ˜è¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨è®­ç»ƒæ•´ä¸ªæ¨¡å‹äº†ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¿ç§»å­¦ä¹ å¯ä»¥èŠ‚çœæ—¶é—´å¹¶æä¾›æ›´å¥½çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¯ä»¥è¯†åˆ«æ±½è½¦çš„é¢„è®­ç»ƒæ¨¡å‹åˆ°ç°åœ¨è¯†åˆ«å¡è½¦ã€‚</p><p id="2f24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨è®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹æˆ‘ä»¬å°†åœ¨è¿™é‡Œä½¿ç”¨çš„æœ€å…ˆè¿›çš„æ¨¡å‹ã€‚</p><h1 id="dcf8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">EfficientNet-B0:æœ€å…ˆè¿›çš„æ¨¡å‹</h1><p id="eb89" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://arxiv.org/pdf/1905.11946.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> EfficientNet </strong> </a>æ˜¯è°·æ­Œæ‰“é€ çš„CNNçš„ä¸€ä¸ªå®¶æ—ã€‚ä¸å…¶ä»–æœ€å…ˆè¿›çš„æ¨¡å‹ç›¸æ¯”ï¼ŒâœŒï¸these CNNä¸ä»…æä¾›äº†æ›´å¥½çš„å‡†ç¡®æ€§ï¼Œè€Œä¸”é€šè¿‡å‡å°‘å‚æ•°æ•°é‡æé«˜äº†æ¨¡å‹çš„æ•ˆç‡ã€‚EfficientNet-B0æ¨¡å‹æ˜¯ä¸€ä¸ªç®€å•çš„ç§»åŠ¨å¤§å°çš„åŸºçº¿æ¶æ„ï¼Œå¹¶åœ¨ImageNetæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚</p><p id="cc15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨æ„å»ºç¥ç»ç½‘ç»œæ—¶ï¼Œæˆ‘ä»¬æé«˜æ¨¡å‹æ€§èƒ½çš„åŸºæœ¬æ–¹æ³•æ˜¯å¢åŠ å•å…ƒæ•°æˆ–å±‚æ•°ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•æˆ–ç­–ç•¥å¹¶ä¸æ€»æ˜¯å¥æ•ˆï¼Œæˆ–è€…æˆ‘å¿…é¡»è¯´ï¼Œåœ¨æŸä¸€ç‚¹ä¸Šæ²¡æœ‰å¸®åŠ©ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä¸ºCIFAR-100æ•°æ®é›†æ„å»ºäº†ä¸€ä¸ª9å±‚å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå¹¶è®¾æ³•å®ç°äº†ä»…59%çš„å‡†ç¡®ç‡ã€‚ä¸ä»…ä»…æ˜¯éšæœºçš„æœºä¼šã€‚ğŸ˜æˆ‘å¢åŠ å±‚æ•°æˆ–å•å…ƒæ•°çš„å°è¯•å¹¶æ²¡æœ‰è¿›ä¸€æ­¥æé«˜ç²¾åº¦ã€‚â˜¹ï¸ ( <a class="ae kv" href="https://github.com/chetnakhanna16/CIFAR100_ImageRecognition/blob/master/CIFAR100_ImageClassification_FinalCode_001081074.py" rel="noopener ugc nofollow" target="_blank">é“¾æ¥åˆ°ä»£ç </a>)</p><p id="4122" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> EfficientNetçš„å·¥ä½œç†å¿µæ˜¯ï¼Œæä¾›ä¸€ç§æœ‰æ•ˆçš„å¤åˆç¼©æ”¾æ–¹æ³•(ç¼©æ”¾æ·±åº¦/å®½åº¦/åˆ†è¾¨ç‡çš„æ‰€æœ‰ç»´åº¦)æ¥å¢åŠ æ¨¡å‹å¤§å°ï¼Œå¯ä»¥å¸®åŠ©æ¨¡å‹å®ç°æœ€å¤§çš„ç²¾åº¦å¢ç›Šã€‚</strong>ä¸‹å›¾æ¥è‡ªåŸå§‹è®ºæ–‡ï¼Œç»™å‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„æ¯”ä¾‹å¯è§†åŒ–ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/39bd7803926eb84734ddc8d3ab34ff75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dZIOSPe8gFyOLPyISNwPVw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ã€https://arxiv.org/pdf/1905.11946.pdfã€‘æ¥æº:<a class="ae kv" href="https://arxiv.org/pdf/1905.11946.pdf" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="1433" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mp">æ³¨:</em> </strong> <em class="mp"> EfficientNetæœ‰å¾ˆå¤šå˜ç§ã€‚æˆ‘ç”¨çš„æ˜¯EfficientNet-B0ï¼Œå› ä¸ºå®ƒæ˜¯ä¸ªå°å‹å·ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥è¯•è¯•EfficientNetçš„å…¶ä»–å˜ç§ã€‚</em></p><p id="7f29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ç”¨EfficientNet-B0å»ºç«‹ä¸€ä¸ªå›¾åƒè¯†åˆ«æ¨¡å‹ã€‚è¯·æ³¨æ„ï¼Œæˆ‘åªæ˜¯åœ¨åšæ–‡ä¸­è®­ç»ƒæ¨¡å‹ã€‚å¦‚æœä½ æƒ³äº†è§£é¢„å¤„ç†éƒ¨åˆ†ï¼Œè¯·å‚è€ƒ<a class="ae kv" rel="noopener" target="_blank" href="/cifar-100-pre-processing-for-image-recognition-task-68015b43d658">è¿™ç¯‡åšæ–‡</a>ã€‚</p><p id="e66a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mp">æ³¨:</em> </strong> <em class="mp">æˆ‘ä¼šå°½é‡æŠŠå¤§éƒ¨åˆ†æ¦‚å¿µè¯´æ¸…æ¥šä½†è¿˜æ˜¯ï¼Œæœ¬æ–‡å‡è®¾å¯¹å·ç§¯ç¥ç»ç½‘ç»œ(CNN)æœ‰åŸºæœ¬çš„äº†è§£ã€‚</em>ğŸ“–</p><p id="0cfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™é¡¹ä»»åŠ¡çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„<a class="ae kv" href="https://github.com/chetnakhanna16/CIFAR100_ImageRecognition/blob/master/EffiicientNetB0_CIFAR100.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>ä¸Šæ‰¾åˆ°ã€‚è¯·æ”¾å¿ƒä½¿ç”¨å®ƒæ¥æ„å»ºæ›´æ™ºèƒ½çš„å›¾åƒè¯†åˆ«ç³»ç»Ÿã€‚</p><h1 id="949e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">ä½¿ç”¨è¿ç§»å­¦ä¹ çš„æ¨¡å‹è®­ç»ƒ</h1><p id="6a2d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">ä¸ºäº†è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè®­ç»ƒé›†ã€‚ä¸€ä¸ªå¥½çš„åšæ³•æ˜¯ä¿ç•™ä¸€ä¸ªéªŒè¯é›†æ¥é€‰æ‹©è¶…å‚æ•°ï¼Œå¹¶ä¿ç•™ä¸€ä¸ªæµ‹è¯•é›†æ¥æ ¹æ®çœ‹ä¸è§çš„æ•°æ®æµ‹è¯•æ¨¡å‹ã€‚</p><p id="4bcc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬é¦–å…ˆå¯¼å…¥åº“ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="f5cc" class="mx lt iq mt b gy my mz l na nb"><strong class="mt ir">from</strong> sklearn.model_selection <strong class="mt ir">import </strong>StratifiedShuffleSplit<br/><strong class="mt ir">import</strong> cv2<br/><strong class="mt ir">import</strong> albumentations <strong class="mt ir">as</strong> albu<br/><strong class="mt ir">from</strong> skimage.transform <strong class="mt ir">import</strong> resize<br/><strong class="mt ir">import</strong> numpy <strong class="mt ir">as</strong> np<br/><strong class="mt ir">import </strong>pandas<strong class="mt ir"> as </strong>pd<strong class="mt ir"><br/>import</strong> matplotlib.pyplot <strong class="mt ir">as</strong> plt<br/>%matplotlib inline<br/><strong class="mt ir">from</strong> pylab <strong class="mt ir">import</strong> rcParams<br/><strong class="mt ir">from</strong> sklearn.metrics <strong class="mt ir">import</strong> accuracy_score, confusion_matrix, classification_report<br/><strong class="mt ir">from</strong> keras.callbacks <strong class="mt ir">import</strong> Callback, EarlyStopping, ReduceLROnPlateau<br/><strong class="mt ir">import</strong> tensorflow <strong class="mt ir">as</strong> tf<br/><strong class="mt ir">import</strong> keras<br/><strong class="mt ir">from</strong> keras.models <strong class="mt ir">import</strong> Sequential, load_model<br/><strong class="mt ir">from</strong> keras.layers <strong class="mt ir">import</strong> Dropout, Dense, GlobalAveragePooling2D<br/><strong class="mt ir">from</strong> keras.optimizers <strong class="mt ir">import</strong> Adam<br/><strong class="mt ir">import</strong> efficientnet.keras <strong class="mt ir">as</strong> efn</span></pre><p id="8d0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä½¿ç”¨åˆ†å±‚æ··æ´—åˆ†å‰²å°†æˆ‘çš„è®­ç»ƒé›†åˆ†å‰²ä¸ºè®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œå› ä¸ºå®ƒå°†ä¿ç•™100ä¸ªç±»ä¸­æ¯ä¸ªç±»çš„æ ·æœ¬ç™¾åˆ†æ¯”ã€‚ä¸‹é¢æ˜¯æ‰§è¡Œåˆ†å‰²çš„ä»£ç ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="46be" class="mx lt iq mt b gy my mz l na nb">sss = StratifiedShuffleSplit(n_splits=2, test_size=0.2, random_state=123)<br/><br/><strong class="mt ir">for</strong> train_index, val_index <strong class="mt ir">in</strong> sss.split(X_train, y_train):<br/>    X_train_data, X_val_data = X_train[train_index], X_train[val_index]<br/>    y_train_data, y_val_data = y_train[train_index], y_train[val_index]<br/><br/><strong class="mt ir">print</strong>("Number of training samples: ", X_train_data.shape[0])<br/><strong class="mt ir">print</strong>("Number of validation samples: ", X_val_data.shape[0])</span></pre><p id="7f6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¾“å‡ºç»™å‡ºäº†æ¯ç»„ä¸­çš„æ ·æœ¬æ•°ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="16bf" class="mx lt iq mt b gy my mz l na nb">Number of training samples:  40000 <br/>Number of validation samples:  10000</span></pre><p id="7568" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ ¹æ®EfficientNetï¼Œæˆ‘ä»¬ä¸ä»…éœ€è¦ç¼©æ”¾æ¨¡å‹çš„å®½åº¦å’Œæ·±åº¦(è¿™å°†ç”±é¢„è®­ç»ƒçš„æ¨¡å‹è´Ÿè´£)ï¼Œè¿˜éœ€è¦ç¼©æ”¾å›¾åƒçš„åˆ†è¾¨ç‡ã€‚EfficientNet-B0æ¨¡å‹æ¶æ„è¦æ±‚æ˜ åƒçš„å¤§å°ä¸º(224ï¼Œ224)ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬å°†å¤§å°ä¸º(32ï¼Œ32)çš„å›¾åƒè°ƒæ•´åˆ°æ–°çš„å¤§å°ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="42ac" class="mx lt iq mt b gy my mz l na nb">height = 224<br/>width = 224<br/>channels = 3</span><span id="dd80" class="mx lt iq mt b gy nc mz l na nb">input_shape = (height, width, channels)</span></pre><p id="5b8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸‹é¢çš„å‡½æ•°<strong class="ky ir"> resize_img </strong>å°†å›¾åƒå’Œå½¢çŠ¶ä½œä¸ºè¾“å…¥ï¼Œå¹¶è°ƒæ•´æ¯ä¸ªå›¾åƒçš„å¤§å°ã€‚æˆ‘ä½¿ç”¨äº†åŒä¸‰æ¬¡æ’å€¼æ³•æ¥æ”¾å¤§å›¾åƒã€‚å®ƒè€ƒè™‘æ€»å…±16ä¸ªåƒç´ çš„å·²çŸ¥åƒç´ çš„æœ€è¿‘çš„4x 4é‚»åŸŸã€‚è¿™ç§æ–¹æ³•äº§ç”Ÿæ˜æ˜¾æ›´æ¸…æ™°çš„å›¾åƒï¼Œè¢«è®¤ä¸ºæ˜¯å¤„ç†æ—¶é—´å’Œè¾“å‡ºè´¨é‡çš„ç†æƒ³ç»„åˆã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="db1a" class="mx lt iq mt b gy my mz l na nb"><strong class="mt ir">def</strong> resize_img(img, shape):<br/>    <strong class="mt ir">return</strong> cv2.resize(img, (shape[1], shape[0]), interpolation=cv2.INTER_CUBIC)</span></pre><p id="dad8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½é€šå¸¸ä¼šéšç€æ›´å¤šæ•°æ®çš„æ·»åŠ è€Œæé«˜ï¼Œæ‰€ä»¥æˆ‘è®¡åˆ’è¿›è¡Œå›¾åƒå¢å¼ºï¼Œä½†å†…å­˜å§‹ç»ˆæ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹çš„ä¸€ä¸ªå¤§é™åˆ¶ï¼Œå› ä¸ºå®ƒä»¬æœ‰å¾ˆå¤šå¯è®­ç»ƒçš„å‚æ•°ã€‚æ‰€ä»¥ï¼Œæˆ‘é€‰æ‹©äº†pythonçš„<a class="ae kv" href="https://albumentations.ai/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">ç›¸å†Œ</strong> </a>åº“ï¼Œå®ƒæœ‰åŠ©äºå®æ—¶æ•°æ®æ‰©å……ã€‚(å¦‚æœä½ ä¸äº†è§£è¿™ä¸ªåº“ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ å»çœ‹çœ‹å®ƒçš„ç½‘ç«™å’Œ<a class="ae kv" href="https://github.com/albumentations-team/albumentations" rel="noopener ugc nofollow" target="_blank"> GitHub </a>é¡µé¢ã€‚)</p><p id="9d0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä½¿ç”¨Kerasæ•°æ®ç”Ÿæˆå™¨ç±»åˆ›å»ºäº†è‡ªå·±çš„è‡ªå®šä¹‰æ•°æ®ç”Ÿæˆå™¨ç±»ã€‚å‚æ•°â€œæ°´å¹³ç¿»è½¬â€ã€â€œå‚ç›´ç¿»è½¬â€ã€â€œç½‘æ ¼æ‰­æ›²â€å’Œâ€œå¼¹æ€§å˜æ¢â€è¢«è°ƒæ•´ä¸ºæ‰©å±•æ•°æ®é›†(æ‚¨ä¹Ÿå¯ä»¥å°è¯•å…¶ä»–å‚æ•°)ã€‚</p><p id="86d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç”±äºå›¾åƒä¸­ç‰¹å¾å€¼çš„åˆ†å¸ƒå¯èƒ½å½¼æ­¤éå¸¸ä¸åŒï¼Œå› æ­¤é€šè¿‡å°†æ¯ä¸ªå›¾åƒé™¤ä»¥255æ¥å½’ä¸€åŒ–å›¾åƒï¼Œå› ä¸ºæ¯ä¸ªå•ç‹¬é¢œè‰²çš„èŒƒå›´æ˜¯[0ï¼Œ255]ã€‚å› æ­¤ï¼Œé‡æ–°ç¼©æ”¾çš„å›¾åƒå…·æœ‰æ–°èŒƒå›´[0ï¼Œ1]ä¸­çš„æ‰€æœ‰ç‰¹å¾ã€‚</p><p id="4f66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘åˆ†æ‰¹å®Œæˆäº†æ‰€æœ‰è¿™äº›è½¬æ¢ã€‚æ­¤å¤–ï¼Œæˆ‘åªå¯¹è®­ç»ƒæ•°æ®é›†åº”ç”¨äº†å¢å¼ºï¼Œå¹¶ä¿ç•™äº†éªŒè¯å’Œæµ‹è¯•æ•°æ®é›†ã€‚</p><p id="ac02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ç¼–å†™è‡ªå®šä¹‰æ•°æ®ç”Ÿæˆå™¨ç±»ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆè®¾ç½®æˆ‘ä»¬çš„å¸¸æ•°ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="f912" class="mx lt iq mt b gy my mz l na nb">n_classes = 100<br/>epochs = 15<br/>batch_size = 8</span></pre><p id="8c2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸‹é¢æ˜¯è‡ªå®šä¹‰æ•°æ®ç”Ÿæˆå™¨ç±»çš„ä»£ç ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="9d62" class="mx lt iq mt b gy my mz l na nb"><strong class="mt ir">class</strong> DataGenerator(keras.utils.Sequence):<br/>    <strong class="mt ir">def</strong> __init__(<em class="mp">self</em>, images, labels=<strong class="mt ir">None</strong>, mode='fit', batch_size=batch_size, dim=(height, width), channels=channels, n_classes=n_classes, shuffle=<strong class="mt ir">True</strong>, augment=<strong class="mt ir">False</strong>):<br/>        <br/>        <em class="mp">#initializing the configuration of the generator</em><br/>        <em class="mp">self</em>.images = images<br/>        <em class="mp">self</em>.labels = labels<br/>        <em class="mp">self</em>.mode = mode<br/>        <em class="mp">self</em>.batch_size = batch_size<br/>        <em class="mp">self</em>.dim = dim<br/>        <em class="mp">self</em>.channels = channels<br/>        <em class="mp">self</em>.n_classes = n_classes<br/>        <em class="mp">self</em>.shuffle = shuffle<br/>        <em class="mp">self</em>.augment = augment<br/>        <em class="mp">self</em>.on_epoch_end()<br/>   <br/>    <em class="mp">#method to be called after every epoch</em><br/>    <strong class="mt ir">def</strong> on_epoch_end(<em class="mp">self</em>):<br/>        self.indexes = np.arange(<em class="mp">self</em>.images.shape[0])<br/>        <strong class="mt ir">if</strong> <em class="mp">self</em>.shuffle == <strong class="mt ir">True</strong>:<br/>            np.random.shuffle(<em class="mp">self</em>.indexes)<br/>    <br/>    <em class="mp">#return numbers of steps in an epoch using samples &amp; batch size</em><br/>    <strong class="mt ir">def</strong> __len__(<em class="mp">self</em>):<br/>        <strong class="mt ir">return</strong> int(np.floor(<strong class="mt ir">len</strong>(<em class="mp">self</em>.images) / <em class="mp">self</em>.batch_size))<br/>    <br/>    <em class="mp">#this method is called with the batch number as an argument to #obtain a given batch of data</em><br/>    <strong class="mt ir">def</strong> __getitem__(<em class="mp">self</em>, index):<br/>        <em class="mp">#generate one batch of data</em><br/>        <em class="mp">#generate indexes of batch</em><br/>        batch_indexes = <em class="mp">self</em>.indexes[index * <em class="mp">self</em>.batch_size:(index+1) * <em class="mp">self</em>.batch_size]<br/>        <br/>        <em class="mp">#generate mini-batch of X</em><br/>        X = np.empty((<em class="mp">self</em>.batch_size, *<em class="mp">self</em>.dim, <em class="mp">self</em>.channels))</span><span id="8856" class="mx lt iq mt b gy nc mz l na nb">        <strong class="mt ir">for</strong> i, ID <strong class="mt ir">in</strong> enumerate(batch_indexes):<br/>            <em class="mp">#generate pre-processed image</em><br/>            img = <em class="mp">self</em>.images[ID]<br/>            <em class="mp">#image rescaling</em><br/>            img = img.astype(np.float32)/255.<br/>            <em class="mp">#resizing as per new dimensions</em><br/>            img = resize_img(img, <em class="mp">self</em>.dim)<br/>            X[i] = img<br/>            <br/>        <em class="mp">#generate mini-batch of y</em><br/>        <strong class="mt ir">if</strong> <em class="mp">self</em>.mode == 'fit':<br/>            y = <em class="mp">self</em>.labels[batch_indexes]<br/>            <br/>            <em class="mp">#augmentation on the training dataset</em><br/>            <strong class="mt ir">if</strong> <em class="mp">self</em>.augment == <strong class="mt ir">True</strong>:<br/>                X = <em class="mp">self</em>.__augment_batch(X)<br/>            <strong class="mt ir">return</strong> X, y<br/>        <br/>        <strong class="mt ir">elif</strong> <em class="mp">self</em>.mode == 'predict':<br/>            <strong class="mt ir">return</strong> X<br/>        <br/>        <strong class="mt ir">else</strong>:<br/>            <strong class="mt ir">raise</strong> <strong class="mt ir">AttributeError</strong>("The mode should be set to either 'fit' or 'predict'.")<br/>            <br/>    <em class="mp">#augmentation for one image</em><br/>    <strong class="mt ir">def</strong> __random_transform(<em class="mp">self</em>, img):<br/>        composition = albu.Compose([albu.HorizontalFlip(p=0.5),<br/>                                   albu.VerticalFlip(p=0.5),<br/>                                   albu.GridDistortion(p=0.2),<br/>                                   albu.ElasticTransform(p=0.2)])<br/>        <strong class="mt ir">return</strong> composition(image=img)['image']<br/>    <br/>    <em class="mp">#augmentation for batch of images</em><br/>    <strong class="mt ir">def</strong> __augment_batch(<em class="mp">self</em>, img_batch):<br/>        <strong class="mt ir">for</strong> i <strong class="mt ir">in</strong> range(img_batch.shape[0]):<br/>            img_batch[i] = <em class="mp">self</em>.__random_transform(img_batch[i])<br/>        <strong class="mt ir">return</strong> img_batch</span></pre><p id="4a19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬å°†æ•°æ®ç”Ÿæˆå™¨ç±»åº”ç”¨äºæˆ‘ä»¬çš„è®­ç»ƒé›†å’ŒéªŒè¯é›†ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="5b7d" class="mx lt iq mt b gy my mz l na nb">train_data_generator = DataGenerator(X_train_data, y_train_data, augment=<strong class="mt ir">True</strong>) <br/>valid_data_generator = DataGenerator(X_val_data, y_val_data, augment=<strong class="mt ir">False</strong>)</span></pre><p id="ba7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Kerasä¸­æä¾›äº†EfficientNetç±»æ¥å¸®åŠ©è½»æ¾è½¬ç§»å­¦ä¹ ã€‚æˆ‘ä½¿ç”¨äº†å¸¦æœ‰ImageNetæƒé‡çš„EfficientNet-B0ç±»ã€‚å› ä¸ºæˆ‘ä½¿ç”¨è¿™ä¸ªæ¨¡å‹åªæ˜¯ä¸ºäº†æå–ç‰¹å¾ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰åœ¨ç½‘ç»œçš„é¡¶éƒ¨åŒ…æ‹¬å®Œå…¨è¿æ¥çš„å±‚ï¼Œè€Œæ˜¯æŒ‡å®šäº†è¾“å…¥å½¢çŠ¶å’Œæ± ã€‚æˆ‘è¿˜æ·»åŠ äº†è‡ªå·±çš„æ± å’Œå¯†é›†å±‚ã€‚</p><p id="ff16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸‹é¢æ˜¯ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„EfficientNet-B0æ¨¡å‹çš„ä»£ç ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="3580" class="mx lt iq mt b gy my mz l na nb">efnb0 = efn.EfficientNetB0(weights='imagenet', include_top=<strong class="mt ir">False</strong>, input_shape=input_shape, classes=n_classes)<br/><br/>model = Sequential()<br/>model.add(efnb0)<br/>model.add(GlobalAveragePooling2D())<br/>model.add(Dropout(0.5))<br/>model.add(Dense(n_classes, activation='softmax'))<br/><br/>model.summary()</span></pre><p id="4865" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™æ˜¯è¾“å‡ºã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/7d50f76f2f5596e7de31ffa0c66a9fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VdWY8FKT6dHjKLX8PHgijw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><p id="4fe1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¯¥æ¨¡å‹æœ‰4ï¼Œ135ï¼Œ648ä¸ªå¯è®­ç»ƒå‚æ•°ã€‚ğŸ˜³</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="f61c" class="mx lt iq mt b gy my mz l na nb">optimizer = Adam(lr=0.0001)<br/><br/><em class="mp">#early stopping to monitor the validation loss and avoid overfitting</em><br/>early_stop = EarlyStopping(monitor='val_loss', mode='min', verbose=1, patience=10, restore_best_weights=<strong class="mt ir">True</strong>)<br/><br/><em class="mp">#reducing learning rate on plateau</em><br/>rlrop = ReduceLROnPlateau(monitor='val_loss', mode='min', patience= 5, factor= 0.5, min_lr= 1e-6, verbose=1)</span><span id="70a8" class="mx lt iq mt b gy nc mz l na nb"><em class="mp">#model compiling</em><br/>model.compile(optimizer=optimizer, loss='categorical_crossentropy', metrics=['accuracy'])</span></pre><p id="c903" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ç¼–è¯‘æˆ‘ä»¬çš„æ¨¡å‹ä¹‹åï¼Œè®©æˆ‘ä»¬å°†å®ƒæ”¾åœ¨æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†ä¸Šï¼Œå¹¶åœ¨éªŒè¯æ•°æ®é›†ä¸ŠéªŒè¯å®ƒã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="49a8" class="mx lt iq mt b gy my mz l na nb">model_history = model.fit_generator(train_data_generator, validation_data = valid_data_generator, callbacks = [early_stop, rlrop],verbose = 1, epochs = epochs)<br/><br/><em class="mp">#saving the trained model weights as data file in .h5 format</em><br/>model.save_weights("cifar_efficientnetb0_weights.h5")</span></pre><p id="a98a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä»¥ä¸‹æ˜¯è®­ç»ƒçš„ç‰‡æ®µã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/7d62e1416ad5070255e7d7308ed193ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hgsi3SQ3uEJpUdFmwiDiKw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/814bd93c9cc8cf9f06916249cf500775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MVRb9ACd4K4e4Vg86FV26A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ä½œè€…æä¾›çš„å›¾ç‰‡</p></figure><p id="d462" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ¨¡å‹åœ¨ç¬¬14ä¸ªæ—¶æœŸè°ƒæ•´äº†å­¦ä¹ ç‡ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒé›†ä¸Šè·å¾—äº†84.82%çš„æœ€ç»ˆå‡†ç¡®ç‡ï¼Œè¿™æ˜¯éå¸¸å¥½çš„ã€‚ä½†æ˜¯ç­‰ç­‰ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦çœ‹çœ‹æµ‹è¯•çš„å‡†ç¡®æ€§ã€‚</p><p id="17e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è§†è§‰åŒ–æœ‰åŠ©äºæ›´å¥½åœ°çœ‹å¾…äº‹ç‰©ã€‚è®©æˆ‘ä»¬ç”»å‡ºç²¾åº¦å’ŒæŸè€—å›¾ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="3e7e" class="mx lt iq mt b gy my mz l na nb"><em class="mp">#plot to visualize the loss and accuracy against number of epochs</em><br/>plt.figure(figsize=(18,8))<br/><br/>plt.suptitle('Loss and Accuracy Plots', fontsize=18)<br/><br/>plt.subplot(1,2,1)<br/>plt.plot(model_history.history['loss'], label='Training Loss')<br/>plt.plot(model_history.history['val_loss'], label='Validation Loss')<br/>plt.legend()<br/>plt.xlabel('Number of epochs', fontsize=15)<br/>plt.ylabel('Loss', fontsize=15)<br/><br/>plt.subplot(1,2,2)<br/>plt.plot(model_history.history['accuracy'], label='Train Accuracy')<br/>plt.plot(model_history.history['val_accuracy'], label='Validation Accuracy')<br/>plt.legend()<br/>plt.xlabel('Number of epochs', fontsize=14)<br/>plt.ylabel('Accuracy', fontsize=14)<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/b10c9b2d25e39f80f2b39076fe365f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mQdRSZZQfUDdq9ZZ3fWYkA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><p id="0f81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨è®©æˆ‘ä»¬è¯„ä¼°ä¸€ä¸‹æˆ‘ä»¬çš„æ¨¡å‹ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="fb27" class="mx lt iq mt b gy my mz l na nb">valid_loss, valid_accuracy = model.evaluate_generator(generator = valid_data_generator, verbose = 1)<br/><br/><strong class="mt ir">print</strong>('Validation Accuracy: ', <strong class="mt ir">round</strong>((valid_accuracy * 100), 2), "%")</span></pre><p id="4286" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="9dd8" class="mx lt iq mt b gy my mz l na nb">1250/1250 [==============================] - 85s 68ms/step Validation Accuracy:  82.3 %</span></pre><p id="cf14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨ï¼Œæ˜¯æ—¶å€™çœ‹çœ‹æµ‹è¯•æ•°æ®é›†çš„å‡†ç¡®æ€§äº†ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="46b6" class="mx lt iq mt b gy my mz l na nb">y_pred = model.predict_generator(DataGenerator(X_test, mode='predict', augment=<strong class="mt ir">False</strong>, shuffle=<strong class="mt ir">False</strong>), verbose=1)<br/>y_pred = np.argmax(y_pred, axis=1)<br/>test_accuracy = accuracy_score(np.argmax(y_test, axis=1), y_pred)<br/><br/><strong class="mt ir">print</strong>('Test Accuracy: ', <strong class="mt ir">round</strong>((test_accuracy * 100), 2), "%")</span></pre><p id="25a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="f182" class="mx lt iq mt b gy my mz l na nb">1250/1250 [==============================] - 78s 63ms/step<br/>Test Accuracy:  81.79 %</span></pre><p id="ddce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åŸ¹è®­çš„ç»“æœç›¸å½“ä¸é”™ã€‚æˆ‘ä»¬åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šè·å¾—äº†81.79%çš„å‡†ç¡®ç‡ã€‚ğŸ’ƒ</p><p id="fa66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ä¸ºæ¨¡å‹ç”Ÿæˆæ··æ·†çŸ©é˜µå’Œåˆ†ç±»æŠ¥å‘Šã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="b627" class="mx lt iq mt b gy my mz l na nb">cm = confusion_matrix(np.argmax(y_test, axis=1), y_pred)<br/><strong class="mt ir">print</strong>(cm)</span><span id="5650" class="mx lt iq mt b gy nc mz l na nb">target = ["Category <strong class="mt ir">{}</strong>".format(i) <strong class="mt ir">for</strong> i <strong class="mt ir">in</strong> range(n_classes)]<br/><strong class="mt ir">print</strong>(classification_report(np.argmax(y_test, axis=1), y_pred, target_names=target))</span></pre><p id="8cc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸‹é¢æ˜¯å‰11ä¸ªç±»çš„ä»£ç ç‰‡æ®µã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/b9c4964e70937330ffb68902bff34a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YdcnUbPjCIUlG-n2VaItug.png"/></div></div></figure><p id="bf18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä»åˆ†ç±»æŠ¥å‘Šä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›ç±»åˆ«è¢«å¾ˆå¥½åœ°é¢„æµ‹ï¼Œè€Œä¸€äº›è¢«é”™è¯¯åœ°é¢„æµ‹ã€‚</p><p id="7564" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœæ‚¨æƒ³å¯è§†åŒ–é¢„æµ‹ï¼Œè¿™é‡Œæ˜¯ä»£ç ã€‚</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="f0d5" class="mx lt iq mt b gy my mz l na nb">prediction = pd.DataFrame(y_pred)</span><span id="ca60" class="mx lt iq mt b gy nc mz l na nb">rcParams['figure.figsize'] = 12,15<br/><br/>num_row = 4<br/>num_col = 4<br/><br/>imageId = np.random.randint(0, len(X_test), num_row * num_col)<br/><br/>fig, axes = plt.subplots(num_row, num_col)<br/><br/><strong class="mt ir">for</strong> i <strong class="mt ir">in</strong> range(0, num_row):<br/>    <strong class="mt ir">for</strong> j <strong class="mt ir">in</strong> range(0, num_col):<br/>        k = (i*num_col)+j<br/>        axes[i,j].imshow(X_test[imageId[k]])<br/>        axes[i,j].set_title("True: " + <strong class="mt ir">str</strong>(subCategory.iloc[testData['fine_labels'][imageId[k]]][0]).capitalize() + "<strong class="mt ir">\n</strong>Predicted: " + <strong class="mt ir">str</strong>(subCategory.iloc[prediction.iloc[imageId[k]]]).split()[2].capitalize(), fontsize=14)<br/>        axes[i,j].axis('off')<br/>        fig.suptitle("Images with True and Predicted Labels", fontsize=18) <br/><br/>plt.show()</span></pre><p id="e70f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸‹é¢æ˜¯è¾“å‡ºçš„ç‰‡æ®µã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/20c8157b4f0df50733561ccc76769979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DyQA-LCyjPv2wdY6rAg-Fw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><p id="29a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ¨¡å‹æ··æ·†äº†æ‘©æ‰˜è½¦å’Œè‡ªè¡Œè½¦ã€‚ğŸ™„ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤§å¤šæ•°é¢„æµ‹æ˜¯æ­£ç¡®çš„ã€‚âœ…</p><p id="b458" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ·±åº¦å­¦ä¹ å°±æ˜¯å®éªŒã€‚ä½¿ç”¨EfficientNetçš„å…¶ä»–æœ€æ–°ç‰ˆæœ¬ï¼Œå¾ˆæœ‰å¯èƒ½å¯ä»¥è¿›ä¸€æ­¥æé«˜è¯¥æ¨¡å‹çš„æ€§èƒ½ã€‚è¶…å‚æ•°è°ƒæ•´ä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ çš„ä¸€ä¸ªé‡è¦æ–¹é¢ï¼Œå¯ä»¥å¸®åŠ©æé«˜å‡†ç¡®æ€§ã€‚</p><p id="5428" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘å¸Œæœ›è¿™ä¸ªåšå®¢èƒ½å¸®åŠ©ä½ ç†è§£å¦‚ä½•è¿›è¡Œè¿ç§»å­¦ä¹ ã€‚è¯·éšæ„å°è¯•æ›´å¤šä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚æŸ¥çœ‹æˆ‘çš„<a class="ae kv" href="https://github.com/chetnakhanna16/CIFAR100_ImageRecognition/blob/master/EffiicientNetB0_CIFAR100.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>çš„å®Œæ•´ä»£ç å’Œæˆ‘çš„<a class="ae kv" rel="noopener" target="_blank" href="/cifar-100-pre-processing-for-image-recognition-task-68015b43d658">ä»¥å‰çš„æ–‡ç« </a>çš„åˆå§‹æ­¥éª¤ã€‚å¦å¤–ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ é˜…è¯»<a class="ae kv" href="https://arxiv.org/pdf/1905.11946.pdf" rel="noopener ugc nofollow" target="_blank">çš„åŸåˆ›è®ºæ–‡</a>ã€‚è¿™æ˜¯ä¸€æœ¬æœ‰è¶£çš„è¯»ç‰©ï¼</p><p id="44d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ç›¸å…³æ–‡ç« :</strong></p><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/cifar-100-pre-processing-for-image-recognition-task-68015b43d658"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">CIFAR-100:å›¾åƒè¯†åˆ«ä»»åŠ¡é¢„å¤„ç†</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">å¸¸ç”¨å›¾åƒæ•°æ®é›†(CIFAR-100)çš„é¢„å¤„ç†æˆ–æ•°æ®å‡†å¤‡</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa kp nm"/></div></div></a></div><p id="afdb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">å‚è€ƒ:</strong></p><ol class=""><li id="5c68" class="ob oc iq ky b kz la lc ld lf od lj oe ln of lr og oh oi oj bi translated">åŸæ–‡:<a class="ae kv" href="https://arxiv.org/pdf/1905.11946.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1905.11946.pdf</a></li><li id="be4f" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated">è¿™ä¸ªç¬”è®°æœ¬ç»™äº†æˆ‘å¦‚ä½•è¿›è¡Œè¿ç§»å­¦ä¹ çš„æŒ‡å¯¼ã€‚</li></ol></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><p id="16e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è°¢è°¢å¤§å®¶é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚è¯·åˆ†äº«æ‚¨å®è´µçš„åé¦ˆæˆ–å»ºè®®ã€‚å¿«ä¹é˜…è¯»ï¼ğŸ“—ğŸ–Œ:æˆ‘ä¹Ÿå¾ˆæƒ³çŸ¥é“ä½ ä½¿ç”¨è¿ç§»å­¦ä¹ åœ¨CIFAR-100ä¸Šæœ‰æ²¡æœ‰æ›´å¥½çš„è¡¨ç°ã€‚</p><p id="87f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.linkedin.com/in/chetna-khanna/" rel="noopener ugc nofollow" target="_blank">é¢†è‹±</a></p></div></div>    
</body>
</html>