<html>
<head>
<title>Understanding Monte Carlo Estimation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解蒙特卡罗估计</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-monte-carlo-estimation-5409d85c4c85?source=collection_archive---------13-----------------------#2021-05-02">https://towardsdatascience.com/understanding-monte-carlo-estimation-5409d85c4c85?source=collection_archive---------13-----------------------#2021-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/69287e8f53e84fe996a06c55c6016229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t139sTNGuCKFPFOX"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">阿曼达·琼斯在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="1153" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="0c31" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">蒙特卡罗估计是机器学习工程师工具箱的重要组成部分。在这里，我们直观地深入研究它，以了解它的用例、性能以及一般使用时需要记住的事项。</h2></div><p id="57ee" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">像任何其他好的算法介绍一样，我们从一个关于我们试图解决的问题设置的故事开始。该设置是对积分的估计。</p><p id="f5fd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">假设我给你一个函数<strong class="lj jt"> f </strong>，那真的很复杂。我告诉你你可以对<strong class="lj jt"> f </strong>求值，但是我对这个函数的积分感兴趣。不幸的是，你不能解析地计算这个函数的积分——也许这是不可能的，或者你的数学水平不够高。此外，函数<strong class="lj jt"> f </strong>可能不会显式给出，这可能是某种模拟，您需要运行它来计算<strong class="lj jt"> f </strong>的某个值。你可以做的一个选择是积分的蒙特卡罗估计。</p><blockquote class="md me mf"><p id="c996" class="lh li mg lj b lk ll kt lm ln lo kw lp mh lr ls lt mi lv lw lx mj lz ma mb mc im bi translated">我们正在处理估计积分的问题，因为函数<strong class="lj jt"> f </strong>可能太复杂，不允许对解进行解析计算。</p></blockquote><p id="9d72" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">事实上，正如你可能从名字上怀疑的那样，这种算法起源于赌博游戏，作为一种计算预期赢款的方法，或者基于样本计算你在赌博游戏中可以赢的预期金额。显然，反复赌博以获得更多的样本来提高你的估计是不明智的，但这是计算你的预期赢(输)的有效方法。</p><blockquote class="md me mf"><p id="e377" class="lh li mg lj b lk ll kt lm ln lo kw lp mh lr ls lt mi lv lw lx mj lz ma mb mc im bi translated">在概率中，期望被定义为连续情况下的积分。</p></blockquote></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="f0e6" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">所以，我们来深究一下。在蒙特卡罗抽样中，我们从函数<strong class="lj jt"> f </strong>的域中抽样，我们只取样本的平均值来估计函数的期望值。为什么这是一种有效的方法？TLDR；这一切都可以归结为查看估计量的前两个矩，即均值和方差。让我们来看看数学。我们可以非常粗略地将期望值的蒙特卡罗估计定义如下:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mr"><img src="../Images/8b5eecc883afbe1722bb5f096be3ee3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*un_BjrpC0jM32M2ceDUt0g.png"/></div></div></figure><p id="3861" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">注意上面红色加粗的部分。我想让你记住，所有的样本都是从分布中抽取的，即根据密度<strong class="lj jt"> p(x) </strong>来确定<strong class="lj jt">目标</strong>期望值。这将允许我们在推导估计量的期望值时，操纵期望值。因此，不再拖延，让我们开始推导期望值。看看下面的推导，稍微调解一下:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/502be5d7382503e420defd6eac3e670e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tkob_gH9P5lrG9-GmRjh6Q.png"/></div></div></figure><p id="bd31" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">事实上，我们对随机变量<strong class="lj jt"> f(x) </strong>的估计均值(我们用<strong class="lj jt"> μ-hat </strong>来表示)具有真正的\mu作为期望值。为什么我们会得出这个结论？因为来自分布<strong class="lj jt"> p(x) </strong>的样本是独立同分布的——简称i.i.d .剩下的就是线性的期望了。这也意味着我们对真实均值的估计是<strong class="lj jt">无偏的</strong>，这是一种有趣的说法，即在期望中，它渐近地收敛于真实均值。</p><blockquote class="md me mf"><p id="5de4" class="lh li mg lj b lk ll kt lm ln lo kw lp mh lr ls lt mi lv lw lx mj lz ma mb mc im bi translated">无偏性意味着估计量收敛于真实均值</p></blockquote><p id="3d69" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在你可能会问这种估计量是不是“好的”，可以说你肯定会说，它是好的，因为它收敛于真实均值，而且是无偏的。还有一点你可能需要考虑的是样本数量的收敛速度。为此，我们想看看它的方差，即到其均值(二阶(中心)矩)的期望平方距离。我们得出以下结论:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/f62c7d3e7a7b62c2cb3c2a4eb7b16a5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*StOdQrFqR2-QJG24zU2QIQ.png"/></div></div></figure><p id="4dcd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后我们得到函数<strong class="lj jt"> f </strong>除以估计量的样本数<strong class="lj jt"> S </strong>的方差。这是什么意思？这意味着估计器的平方误差随着因子<strong class="lj jt"> O(1/S) </strong>而下降。如果我们想看看绝对误差，取该项的平方根，我们将得到<strong class="lj jt"> O(1/sqrt(S))。</strong></p><h1 id="fd60" class="my mz jj bd na nb nc nd ne nf ng nh ni ky nj kz nk lb nl lc nm le nn lf no np bi translated">估计π</h1><p id="e8b4" class="pw-post-body-paragraph lh li jj lj b lk nq kt lm ln nr kw lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">这样收敛速度好吗？让我们来看一个例子，估算数字<strong class="lj jt"> π </strong>。假设我们不知道圆周率的前N位，我们想估计它们。首先，我们可能注意到，单位圆的面积定义为π。如果我们看一下单位圆的四分之一面积，我们也许能够通过从单位分布中抽取一些点来估计它。</p><p id="70da" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">看看下图，我们看到的是包含单位圆四分之一面积的正方形。我们可以注意到，当对它们进行均匀采样(x，y在0和1之间)时，一个点落入圆中的概率是π / 4，即圆的该部分的面积除以正方形的面积。我们可以通过采样点并根据它们是否落在圆内来标记它们来估计这一点，本质上，我们正在推断伯努利分布参数θ的值，该值应收敛到π / 4(其期望-落在圆内的概率)。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/cf51035b8d0e35b449ee57431727174e.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*oKM6e5Qf44sqGEB865TKbg.png"/></div></figure><p id="f18e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我在JAX编写了这个方法的简单实现，因为JAX很有趣，我推荐你去看看，但是等价的代码也可以用Numpy编写。如您所见，这在概念上非常简单，它涉及我们从均匀分布中抽取样本，标记落在圆内的样本(第5行)，然后计算并返回π的估计值(第6行)。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="aa6a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下图说明了随着样本数量的增加，估计量的误差是怎样的。正如所料，误差大致按照我们之前推导的<strong class="lj jt"> S </strong>定律O(1/sqrt(S))的平方根倒数发展。重要的是要记住，我们已经得出了估计量的预期误差，这意味着逐点估计它可能会在预期之外波动，如图所示。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/53b76754083a40ef057646ddbb8e823c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*ENnFdSuqaG6PxYv8Zatpaw.png"/></div></figure><p id="a858" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">此外，如果我们以对数标度绘制前面的图，查看<strong class="lj jt">绝对</strong>误差，我们会注意到，当样本大小增加一个数量级时，误差会下降一个数量级。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/a390bc1fb3c210e440342ed7dfb7d516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*UcoosOwThs1-66YcJpxZtw.png"/></div></div></figure><p id="e8a1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在我们回到这个估计量是否好的问题上来。1/sqrt(S)收敛速度对于精确计算来说不是那么好，我会告诉你为什么。以π为例。为了在数字π的第二位上大致平均精确(我说大致是因为这是基于样本的随机算法)，我们需要4个数量级的样本(10k个样本)。类似地，如果我们想要大致精确到第三位数，我们将需要一百万个样本。这是相当多的样本来估计只有前3位数的π！幸运的是，有更好的方法可以实现更快的计算速度。</p><h2 id="1c49" class="oa mz jj bd na ob oc dn ne od oe dp ni lq of og nk lu oh oi nm ly oj ok no jp bi translated">外卖食品</h2><ul class=""><li id="77f9" class="ol om jj lj b lk nq ln nr lq on lu oo ly op mc oq or os ot bi translated">蒙特卡罗算法是一种允许我们计算期望值的基于样本的估计的算法，即计算积分的估计。</li><li id="e0df" class="ol om jj lj b lk ou ln ov lq ow lu ox ly oy mc oq or os ot bi translated">蒙特卡洛情况下的估计误差以<strong class="lj jt"> O(1/sqrt(S)) </strong>的速率下降</li><li id="3499" class="ol om jj lj b lk ou ln ov lq ow lu ox ly oy mc oq or os ot bi translated">这个收敛速度没那么好。</li><li id="6522" class="ol om jj lj b lk ou ln ov lq ow lu ox ly oy mc oq or os ot bi translated">但是这种算法实现起来很简单，并且在进入更好的方法之前，它可以作为估计某个量的第一次尝试。</li><li id="a123" class="ol om jj lj b lk ou ln ov lq ow lu ox ly oy mc oq or os ot bi translated">不要拿它去赌博！</li></ul><h2 id="1134" class="oa mz jj bd na ob oc dn ne od oe dp ni lq of og nk lu oh oi nm ly oj ok no jp bi translated">值得思考的事情</h2><ul class=""><li id="920c" class="ol om jj lj b lk nq ln nr lq on lu oo ly op mc oq or os ot bi translated">在这个算法中，我们可能只是不负责任地忽略了一个事实，即我们假设我们可以从分布<strong class="lj jt"> p(x) </strong>中采样，如果我们不能从这个分布中有效地采样，会发生什么呢？</li><li id="2089" class="ol om jj lj b lk ou ln ov lq ow lu ox ly oy mc oq or os ot bi translated">如果从<strong class="lj jt"> p(x) </strong>取样很贵怎么办？</li></ul><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oz"><img src="../Images/580d5fafc4615b6a08acfdfe633685be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ftKMJQ8XUlWPATk6"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@originspoker?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迪伦·克利夫顿</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div></div>    
</body>
</html>