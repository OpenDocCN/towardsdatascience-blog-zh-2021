<html>
<head>
<title>How to do AVERAGE and MAX word embedding for LONG sentences?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">长句如何做平均和最大单词嵌入？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-do-average-and-max-word-embedding-for-long-sentences-f3531e99d998?source=collection_archive---------22-----------------------#2021-08-09">https://towardsdatascience.com/how-to-do-average-and-max-word-embedding-for-long-sentences-f3531e99d998?source=collection_archive---------22-----------------------#2021-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2552" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何对超过512个单词的长句执行NLP操作</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/223fc884e7ffddb0782bb9c8b910b3bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vChT9zZjAQXwBMuO"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@raphaelphotoch?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Raphael Schaller </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="8b00" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">总体架构/方法</h1><p id="bea3" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">在我们在这个实验中使用的BERT模型的情况下，我们使用来自https://github.com/mukut03/ESG-BERT<a class="ae kv" href="https://github.com/mukut03/ESG-BERT" rel="noopener ugc nofollow" target="_blank">的ESG_BERT模型。在这个BERT模型中，该模型可以处理的最大序列只有512个令牌。因此，如果你的序列超过512个记号，你需要一种叫做<strong class="lx ir">分块的技术。</strong>我们还应该注意，对于我们使用的模型，<strong class="lx ir">单词嵌入向量大小被训练为768 </strong>，因此我们的嵌入输出也将显示每个令牌的向量大小为768。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/fcce2c2bd5d4ea1da68a3bc8a06a7282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U0cHfwIKX4jXlwDh"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:<a class="ae kv" rel="noopener" target="_blank" href="/how-to-apply-transformers-to-any-length-of-text-a5601410af7f">https://towards data science . com/how-to-apply-transformers-to-any-length-of-text-a 5601410 af7f</a></p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/cd0a1007bc85118cb187bd44e1a29124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b-7VOiQZ8UNJSFtvD4-RUQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="2ebd" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">假设我们有978个令牌的序列，我们可以将它们分成2个块，因为978//512 = 1(我们比地板除法多取一个块)。为了说明，我们假设每个单词的嵌入向量大小是3。</p><p id="234f" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">橙色框中是<strong class="lx ir">平均句子嵌入(AvgSE) </strong>，绿色框代表<strong class="lx ir">最大句子嵌入(MaxSE) </strong>。</p><p id="3864" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">为了计算AvgSE，我们需要</p><ol class=""><li id="4cff" class="my mz iq lx b ly mt mb mu me na mi nb mm nc mq nd ne nf ng bi translated">把长序列分块</li><li id="dd3b" class="my mz iq lx b ly nh mb ni me nj mi nk mm nl mq nd ne nf ng bi translated">在每个块中:</li></ol><ul class=""><li id="965c" class="my mz iq lx b ly mt mb mu me na mi nb mm nc mq nm ne nf ng bi translated">查找块中每个单词的单词嵌入</li><li id="ea21" class="my mz iq lx b ly nh mb ni me nj mi nk mm nl mq nm ne nf ng bi translated">找出组块中所有单词嵌入的平均值(将所有向量相加，除以组块中的单词数)</li></ul><p id="9219" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">3.通过将所有单词嵌入相加(在第2项中),除以组块数，再次对进行平均</p><p id="e451" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">为了计算MaxSE，我们需要</p><ol class=""><li id="1a5d" class="my mz iq lx b ly mt mb mu me na mi nb mm nc mq nd ne nf ng bi translated">把长序列分块</li><li id="7a06" class="my mz iq lx b ly nh mb ni me nj mi nk mm nl mq nd ne nf ng bi translated">在每个块中:</li></ol><ul class=""><li id="775e" class="my mz iq lx b ly mt mb mu me na mi nb mm nc mq nm ne nf ng bi translated">查找块中每个单词的单词嵌入</li><li id="cc36" class="my mz iq lx b ly nh mb ni me nj mi nk mm nl mq nm ne nf ng bi translated">找到组块中所有单词嵌入的最大值</li></ul><p id="5153" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">3.再次Max单词embeddings across the chunks(在项目2中)</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="5fd3" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">词汇符号化和组块化的味道</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="6309" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">在标记化下，我们看到<em class="np">“我开玩笑生气了”</em>中的4个词原文，现在被标记为<em class="np"> ['我'，'我'，'开玩笑'，' ##ly '，'生气']。</em>这种标记化在BERT模型中很普遍，根据您选择的BERT模型的类型，单词也会被不同地拆分。</p><p id="1531" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">在分块下，这里是我们的分块代码的工作方式，分块大小为2。我们的句子是<em class="np">“我是屋里的女孩”</em>。组块之后，我们将句子分成许多部分，每个部分的大小为2(除了最后一个组块):<em class="np">[‘我是’，‘一个女孩’，‘在房子里’]</em></p><p id="21aa" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">我们之所以引入这两个概念，是因为它们将在下面的<strong class="lx ir">主代码:长句的平均单词嵌入</strong>和<strong class="lx ir">主代码:长句的最大单词嵌入</strong>部分的主代码块中使用。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="7496" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">让我们首先引入一些辅助函数</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="2a42" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">主代码:长句平均单词嵌入</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="b106" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">主代码:长句最大单词嵌入</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="f3da" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">最终想法:</h1><p id="d84a" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">首先，这是一个简单的方法，可以克服单词嵌入时序列长度的限制。</p><p id="baaf" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">第二点:本教程讲述如何找到整个句子/序列的平均和最大单词嵌入。</p><p id="36ac" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated">希望对你有帮助！</p><p id="2441" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me mv mg mh mi mw mk ml mm mx mo mp mq ij bi translated"><em class="np">免责声明:内容由作者生成，不隶属于任何组织</em></p></div></div>    
</body>
</html>