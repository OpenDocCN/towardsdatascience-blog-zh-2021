<html>
<head>
<title>How to Load the Content of a Google Document in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python加载Google文档的内容</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-load-the-content-of-a-google-document-in-python-1d23fd8d8e52?source=collection_archive---------14-----------------------#2021-05-04">https://towardsdatascience.com/how-to-load-the-content-of-a-google-document-in-python-1d23fd8d8e52?source=collection_archive---------14-----------------------#2021-05-04</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="fb73" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph">数据预处理</h2><div class=""/><div class=""><h2 id="bc30" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">关于在Python中使用Google Doc APIs的快速教程</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/d2480f66ebfb0624cf538344019fb32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DMJcAkaEY_Hnv8tIIMwI2g.jpeg"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">图片由<a class="ae lk" href="https://pixabay.com/users/photomix-company-1546875/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1939255" rel="noopener ugc nofollow" target="_blank">照片合成</a>来自<a class="ae lk" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1939255" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="b1e4" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">您可能在Google Drive中以Google Doc的形式存储了一个文档，并希望将其内容动态加载到Python <code class="fe mh mi mj mk b">pandas</code> DataFrame中进行进一步处理。</p><p id="ceae" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">首先，你需要访问<a class="ae lk" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a>并创建一个新项目，比如说<em class="ml"> MyProject </em>。然后，您必须在主仪表板中选择创建的项目，并选择<em class="ml">explore and enable API</em>。你可以搜索谷歌文档API，然后点击启用API。启用后，您应该创建新的凭据。</p><p id="752b" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">可以选择Google Doc API，查看用户数据，如下图所示。</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj mm"><img src="../Images/18cd261a6d36646c9b4664a56ba6692a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGYealtGgSCoJQXJqRiHiQ.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="ad50" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">您可以按照向导完成凭据的创建。在第4部分OAuth客户端ID中，您可以选择桌面应用程序作为应用程序类型。</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj mn"><img src="../Images/db15cb751c1c744cfb1fc2f9f429f328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z1kP5VkfCXZNqEvSJbwJmQ.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="94e9" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在您可以下载创建的秘密并将其重命名为<code class="fe mh mi mj mk b">credentials.json</code>。将该文件放在将编写Python代码的同一个目录中。</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj mo"><img src="../Images/a3acd51fe29134859e483bed50f89874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CE_AjIJNbA0OQ9l5VaDtkg.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="9d7c" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在你可以下载并复制官方<a class="ae lk" href="https://developers.google.com/docs/api/samples/extract-text" rel="noopener ugc nofollow" target="_blank"> Google Doc API文档</a>的代码，它允许你下载Google Doc文档的内容。确保你有权利阅读谷歌文档！！！</p><p id="8993" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">提取文本后，可以将其保存到本地文件中，然后转换成数据帧以供进一步分析。您将把文本的每一行作为一个新行存储在数据帧中。让我们假设您已经将Google文档的文本存储到一个名为<code class="fe mh mi mj mk b">text</code>的变量中。</p><pre class="kv kw kx ky gu mp mk mq mr aw ms bi"><span id="1356" class="mt mu iw mk b gz mv mw l mx my">doc_content = body.get('content')<br/>text = read_strucutural_elements(doc_content)</span></pre><p id="9563" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在，您可以将它保存到本地文件中:</p><pre class="kv kw kx ky gu mp mk mq mr aw ms bi"><span id="4da2" class="mt mu iw mk b gz mv mw l mx my">with open("my_doc.txt", "w") as text_file:<br/>    text_file.write(text)</span></pre><p id="f312" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">然后您可以重新加载该文件并将其转换为数据帧:</p><pre class="kv kw kx ky gu mp mk mq mr aw ms bi"><span id="48f6" class="mt mu iw mk b gz mv mw l mx my">import pandas as pd</span><span id="5bb2" class="mt mu iw mk b gz mz mw l mx my">with open('my_doc.txt', 'r') as f:<br/>    text = [line for line in f.readlines()]<br/>df = pd.DataFrame(text,columns=['text'])</span></pre><p id="2734" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">最终，您已经准备好处理您的数据了！好好享受吧！</p><h1 id="be67" class="na mu iw bd nb nc nd ne nf ng nh ni nj kl nk km nl ko nm kp nn kr no ks np nq bi translated">摘要</h1><p id="2b03" class="pw-post-body-paragraph ll lm iw ln b lo nr kg lq lr ns kj lt lu nt lw lx ly nu ma mb mc nv me mf mg ip bi translated">在本教程中，我演示了如何通过官方的Google Doc API从Google Doc文档中加载文本，并将其转换为Python <code class="fe mh mi mj mk b">pandas</code> DataFrame。</p><p id="2835" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">这个过程很简单，但是需要一些重要的步骤，包括配置用来访问Google Doc API的凭证。</p><p id="9d5b" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">如果你想了解我的研究和其他活动的最新情况，你可以在<a class="ae lk" href="https://twitter.com/alod83" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae lk" href="https://www.youtube.com/channel/UC4O8-FtQqGIsgDW_ytXIWOg?view_as=subscriber" rel="noopener ugc nofollow" target="_blank"> Youtube </a>和<a class="ae lk" href="https://github.com/alod83" rel="noopener ugc nofollow" target="_blank"> Github </a>上关注我。</p><h1 id="701d" class="na mu iw bd nb nc nd ne nf ng nh ni nj kl nk km nl ko nm kp nn kr no ks np nq bi translated">相关文章</h1><div class="nw nx gq gs ny nz"><a href="https://medium.datadriveninvestor.com/how-to-restore-the-original-layout-of-a-text-document-after-a-manipulation-in-python-8f3de41e8e95" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fp"><div class="ob ab oc cl cj od"><h2 class="bd jg gz z fq oe fs ft of fv fx jf bi translated">如何在Python中操作后恢复文本文档的原始布局</h2><div class="og l"><h3 class="bd b gz z fq oe fs ft of fv fx dk translated">少于10行的代码，用于在操作后保留文本文档的布局，例如文本…</h3></div><div class="oh l"><p class="bd b dl z fq oe fs ft of fv fx dk translated">medium.datadriveninvestor.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on le nz"/></div></div></a></div><div class="nw nx gq gs ny nz"><a rel="noopener follow" target="_blank" href="/how-to-extract-structured-information-from-a-text-through-python-spacy-749b311161e"><div class="oa ab fp"><div class="ob ab oc cl cj od"><h2 class="bd jg gz z fq oe fs ft of fv fx jf bi translated">如何通过Python空间从文本中提取结构化信息</h2><div class="og l"><h3 class="bd b gz z fq oe fs ft of fv fx dk translated">关于如何从文本构建结构化数据集的现成教程。</h3></div><div class="oh l"><p class="bd b dl z fq oe fs ft of fv fx dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="oo l ok ol om oi on le nz"/></div></div></a></div><div class="nw nx gq gs ny nz"><a rel="noopener follow" target="_blank" href="/automatic-update-of-django-models-from-a-google-spreadsheet-7c6d4f30e3ca"><div class="oa ab fp"><div class="ob ab oc cl cj od"><h2 class="bd jg gz z fq oe fs ft of fv fx jf bi translated">从Google电子表格自动更新Django模型</h2><div class="og l"><h3 class="bd b gz z fq oe fs ft of fv fx dk translated">关于如何直接从Google电子表格创建和更新Django模型的现成Python教程</h3></div><div class="oh l"><p class="bd b dl z fq oe fs ft of fv fx dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="op l ok ol om oi on le nz"/></div></div></a></div></div></div>    
</body>
</html>