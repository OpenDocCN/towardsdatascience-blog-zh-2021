<html>
<head>
<title>Picture Purrfect</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像完美</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/picture-purrfect-bbcb5c3e42df?source=collection_archive---------40-----------------------#2021-03-25">https://towardsdatascience.com/picture-purrfect-bbcb5c3e42df?source=collection_archive---------40-----------------------#2021-03-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2983" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">与你毛茸茸的朋友一起捕捉最美好的瞬间！</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/99187a28f84fd6269a9bd5c0fc3546d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*roe_YJmh5ow23w7JFzBPsA.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">给动物拍照并不总是容易的……(照片来自Reddit <a class="ae kz" href="https://www.reddit.com/r/blurrypicturesofcats/" rel="noopener ugc nofollow" target="_blank">猫</a>和<a class="ae kz" href="https://www.reddit.com/r/blurrypicturesofdogs/comments/d4hd7d/blurry_picture_of_a_dog/" rel="noopener ugc nofollow" target="_blank">狗</a>)</p></figure><p id="96c7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">曾经为拍摄动物照片而挣扎过吗？</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/ec2795b18c2cb337215ed64dbec6fc9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*QhrY8clNfw6tO0akNCjAEg.gif"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者GIF</p></figure><p id="15fb" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">或者你有没有发现自己给宠物拍了一堆照片…后来翻遍每张照片，手动选择不好的删除？</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="3c6b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">嗯……这款名为<strong class="lc iu">Picture pur fect</strong>的应用是为了让你轻松拍摄猫咪照片而开发的！只需上传一段你的猫的短视频(特别是当它们在玩耍或走动时)，算法就会自动为你选择最佳帧。</p><p id="5342" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是该应用的一个简短演示:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="12c8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你对它的工作原理感兴趣，请继续阅读！或者你可以跳到最后看完整的演示。</p><p id="02f5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我将讨论四个部分:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mg"><img src="../Images/61a7de433b8306306d43ec41dc159bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8663OT5600r5O-qkGCJtyw.png"/></div></div></figure><h1 id="5e65" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">数据</h1><p id="e6ff" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">用于构建算法的数据由120个猫咪视频组成，这些视频要么来自互联网(多个Youtube猫咪频道)，要么是我自己拍摄的。每个视频的时长为10-30秒。这些导致超过2000个帧，每个帧被标记为<em class="ne">好的</em>或<em class="ne">坏的</em>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nf"><img src="../Images/8094d4b7a6a56bdf0a4d68ac184b68d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OiBskr3i3WgehsmNBPse8Q.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">数据收集和预处理。(图片由作者提供)</p></figure><p id="eb55" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">正如你在上面的例子中看到的，一个好的<em class="ne">帧将包含一只猫，它的脸清晰地显示出来。如果猫的脸被遮挡或模糊，该帧将被标记为<em class="ne">坏的</em>。但是你可以想象，除了这些基本标准之外，还有一定程度的主观性，这取决于谁在给这些框架贴标签(在这种情况下是我)。最终的问题是，我们如何教会机器算法学习我们如何思考？为此，我们需要特征来定量地描述每一帧。(如果我们能够收集足够多的标记帧，我们就可以使用深度学习方法，而不用担心特征。不幸的是，对于这个项目，我没有足够的时间或合适的来源来收集大量的数据。</em></p><h1 id="eeff" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">特征工程</h1><p id="04a7" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">特征工程当然是这个项目的主要焦点，因为它在模型训练中起着重要的作用。有三类技术:</p><ol class=""><li id="a0c8" class="ng nh it lc b ld le lg lh lj ni ln nj lr nk lv nl nm nn no bi translated">猫脸检测</li><li id="4545" class="ng nh it lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">模糊检测</li><li id="dda6" class="ng nh it lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">猫面部特征检测</li></ol></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h2 id="1cac" class="nu mi it bd mj nv nw dn mn nx ny dp mr lj nz oa mt ln ob oc mv lr od oe mx of bi translated">猫脸检测</h2><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi og"><img src="../Images/88e894e2de7f56cbca199337513ae77a.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*7zS6jE4Fcvqyr0ssAwIYLQ.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">用Haar级联分类器进行猫脸检测(猫脸图像经<a class="ae kz" href="https://www.creativefabrica.com/product/cute-face-cat-with-black-line-art-style/" rel="noopener ugc nofollow" target="_blank"><em class="ki">Creative Fabrica</em></a><em class="ki">授权给作者)</em></p></figure><p id="715e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我使用Haar cascade classifier(这篇<a class="ae kz" href="https://katiehuang1221.medium.com/an-introduction-to-computer-vision-131826e2b512" rel="noopener">博文</a>简要解释了cascade classifier如何工作)作为快速过滤器来筛选给定视频中的所有帧，并只保留那些带有cats的帧，用于剩余的(更复杂和耗时的)特征工程步骤。</p><p id="8bb3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用这个检测器，您可以获得猫脸中心的坐标以及猫脸周围边界框的高度和宽度。</p><p id="151a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">从包围盒的位置和大小可以进一步发现猫是否是帧的主体(人脸中心到帧中心的距离和人脸占整个帧的大小比例):</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oh"><img src="../Images/55ffebff5174c9721707d3e009eceefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NbHAcyJK0A4bmLS2wiRAhQ.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">推断猫是否是画面的主体:人脸中心到画面中心的距离，猫脸占整个画面的大小比例。</p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h2 id="7021" class="nu mi it bd mj nv nw dn mn nx ny dp mr lj nz oa mt ln ob oc mv lr od oe mx of bi translated">模糊检测</h2><p id="ca43" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">我们还可以使用一些基本的图像处理技术对每一帧进行模糊检测。有许多不同的方法，但一般来说，它们都与图像中的边缘有多清晰有关，即边缘检测。我选择拉普拉斯和Canny滤波器。</p><p id="9000" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">拉普拉斯方法计算图像的二阶导数，它测量一阶导数变化的速率。然后，我们可以看到相邻像素值的变化是来自不连续的边缘还是来自连续的级数。</p><p id="8c9f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">Canny边缘检测稍微复杂一些。它有多个阶段，包括高斯滤波器降噪。得到的图像是二进制的(大部分是黑色的，但是检测到的边缘用白线描绘)。</p><p id="8068" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">下面的例子显示了一个清晰的猫脸帧和另一个模糊的猫脸帧。您可以看到应用拉普拉斯算子和Canny算子后帧的外观:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oh"><img src="../Images/f1a17a682864b904107fcd1f7ec8682d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1LDm0MU1twINEcFwezNwFw.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">原始帧和应用拉普拉斯算子后的Canny滤波器。(来自YouTube频道的猫<a class="ae kz" href="https://www.youtube.com/channel/UCRxAgfYexGLlu1WHGIMUDqw" rel="noopener ugc nofollow" target="_blank">君的厨房</a>)</p></figure><p id="5ed6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">然后，我们可以计算经过处理的帧的方差，并确定原始帧的清晰度或模糊度。可以对整个帧进行计算，也可以只对猫脸进行计算。猫脸锐度占整个画面锐度的比例也应该算一个特征。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h2 id="2cb5" class="nu mi it bd mj nv nw dn mn nx ny dp mr lj nz oa mt ln ob oc mv lr od oe mx of bi translated"><strong class="ak">猫咪五官检测</strong></h2><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/c857b57bb62a3cca24aaad2d01f0c817.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*8f35agM26SZGJgc9Q4CYgA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">使用定制训练的YOLOv3 (darknet)进行面部特征检测</p></figure><p id="f337" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">前两类与框架的宏观层次更相关。微观层面，我们要识别猫的耳朵、眼睛、鼻子等面部特征。这可以通过基于神经网络架构(darknet的YOLOv3)的定制训练对象检测器来完成。与面部检测的情况类似，将返回每个特征周围的边界框的中心坐标和高度、宽度。这其实给了我们很多信息！</p><p id="be42" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是一个猫从完全清醒到打瞌睡的面部特征检测的例子:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oj"><img src="../Images/a74ef411694cf0e72215862f2e3eee59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iqhCfXvaRLadIh8N3tFkPg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">猫面部特征检测。(来自Youtube频道的猫<a class="ae kz" href="https://www.youtube.com/channel/UC9cH5HQBojNzPCaTLovivbw" rel="noopener ugc nofollow" target="_blank"> KiSH-Log </a>)</p></figure><p id="bdc8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果只是看眼睛，很明显从猫眼的高宽比可以推断出眼睛的形状(猫的眼睛是不是睁着的，猫是不是困了)。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/0898bb2f54f10ddc37a373fdc3ad8ee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*OlmOdXrZy8i4dcHl9cB1JA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">从高度和宽度的比例推断猫眼的形状。(图片由作者提供)</p></figure><p id="97a1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是另一个猫洗澡的例子:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/19f605ccf4bcffed6a70211c5dffd0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*ZjTCX88NjyT0qB2yKieaVA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">猫在洗澡。(猫来自Youtube频道<a class="ae kz" href="https://www.youtube.com/channel/UCwcsDWGip6vtiZyCnvDoClQ" rel="noopener ugc nofollow" target="_blank">基底龙</a></p></figure><p id="d72c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">从猫的两只眼睛和鼻子的相对位置，我们可以推算出猫的面部角度:猫是直视镜头，还是侧视。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi om"><img src="../Images/e1cebfea876fbc017d6cfd90cca21cc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*YBIm2Hl61FnPx-5FDg2FCw.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">使用眼睛、鼻子的位置来计算猫脸相对于摄像机的角度。(图片由作者提供)</p></figure><h1 id="7db2" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">模型</h1><p id="95c4" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">在所有准备工作(数据收集、标记、特征工程)完成后，我们就可以开始训练模型了！在测试的几个不同分类器中，Random forest在ROC AUC方面的性能最好(83.3%)。进一步研究特性的重要性，不难发现顶级特性与清晰度有关。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi on"><img src="../Images/3ae0821100a06a51c5c55f4b38eedef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlKuajviZ9Jwxv6xVSxYKg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">模型训练:给定数据信息，训练随机森林分类器。重要的特征显示在右边。(图片由作者提供)</p></figure><h1 id="78fa" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">Web应用程序</h1><p id="e05a" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">您已经在开始部分看到了web应用程序演示！以下是Picture Purrfect选择的几帧:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/4433eece5eb63e25ba35556ceb5eb628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*P6LEDvqPMge4LeA8vYA3lQ.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">由Picture Purrfect选择的雪纺(平纹)和切达(橙色)框架。(作者照片)</p></figure><p id="6a5c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">希望你喜欢！</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h2 id="ad02" class="nu mi it bd mj nv nw dn mn nx ny dp mr lj nz oa mt ln ob oc mv lr od oe mx of bi translated"><em class="ki">完整展示</em></h2><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="b6b1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">了解有关项目的更多信息:</p><div class="op oq gp gr or os"><a href="https://github.com/katiehuang1221/onl_ds5_project_5" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">Katie Huang 1221/onl _ ds5 _ project _ 5</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">梅蒂斯激情计划为动物拍照并不总是一件容易的事！不用拍一堆照片，直接上传…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">github.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg kt os"/></div></div></a></div><p id="cb6d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">了解有关该应用程序的更多信息:</p><div class="op oq gp gr or os"><a href="https://github.com/katiehuang1221/PicturePurrfect_app" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">Katie Huang 1221/picturepurfect _ app</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">1.您的purffect pic拖放您的视频文件，并点击按钮开始挑选🐾 2.自定义选取器试用…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">github.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg kt os"/></div></div></a></div><p id="905b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">其他视频:</p><div class="op oq gp gr or os"><a href="https://www.youtube.com/channel/UCaZHIPzCIG9Y9xWYDpMvH5w" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">黄凯蒂</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">与朋友、家人和全世界分享您的视频</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">www.youtube.com</p></div></div><div class="pb l"><div class="pi l pd pe pf pb pg kt os"/></div></div></a></div></div></div>    
</body>
</html>