<html>
<head>
<title>Can QR Decomposition Be Actually Faster? Schwarz-Rutishauser Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">QR分解实际上能更快吗？Schwarz-Rutishauser算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/can-qr-decomposition-be-actually-faster-schwarz-rutishauser-algorithm-a32c0cde8b9b?source=collection_archive---------12-----------------------#2021-04-07">https://towardsdatascience.com/can-qr-decomposition-be-actually-faster-schwarz-rutishauser-algorithm-a32c0cde8b9b?source=collection_archive---------12-----------------------#2021-04-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/2925f71a95efacf96aa6addce029163c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IOQFHhhUwFOj6TEE01z0fw.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Arthur V. Ratz摄于Shotstash</p></figure><div class=""/><div class=""><h2 id="20fb" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">在这个故事中，我们将讨论如何通过使用Schwarz-Rutishauser算法(已解释)有效地优化大型矩阵QR分解的性能，介绍其在Python 3.9.x和最新的NumPy 1.20.x库中的实现…</h2></div><h1 id="a4ca" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">介绍</h1><p id="4ab7" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">QR分解是最新的，也可能是最有趣的线性代数算子之一，在科学和工程的许多领域有一些已知的应用。QR分解方法的相关研究始于XX世纪初。</p><p id="08eb" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">今天，一整类QR分解方法在数学中被有效地用于解决线性最小二乘(LS)问题，解线性方程组，以及特征值和奇异值分解(SVD)计算方法的基本步骤<strong class="lo jg">【1】</strong>。</p><p id="a4d6" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在过去的几十年中，不断发展的计算机科学和IT领域影响了研究人员对QR类算法的潜在兴趣，这有利于解决许多现有的现实世界问题。</p><p id="f281" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在<em class="mn"> AI </em>和<em class="mn">数据挖掘</em>的时代，QR算法在数据科学的各个领域得到了应用，例如<em class="mn">主成分分析(PCA) </em>，作为一种在经济科学<strong class="lo jg">【1，3】</strong>中执行系统参数或总体估计的分析时，根据可能具有解释性的因素来表示参数幅度的方法。例如，因子分解可以有效地用于分析工业机器和机械装置的振动水平<strong class="lo jg">【7】</strong>。</p><p id="c7a2" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">以因子的形式表示各种类型的参数提供了一种能力来确定什么对总体评级和估计值具有特定的关键影响。具体而言，因子分解技术提供了获取知识和见解的能力，这些知识和见解在数据挖掘中常用的统计数据集上展示。</p><p id="f38d" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在电子商务和在线交易中，统计数据分解方法被应用于各种基于人工智能的分析软件功能的开发，被商家用来有效地涵盖他们的业务，从而增加受欢迎程度并降低数字内容和服务的成本，向数十亿在线客户做广告<strong class="lo jg">【8】</strong>。</p><p id="915e" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">然而，现有的大多数QR算法都具有非常高的计算复杂度，对大规模矩阵和其他大数据分解过程产生负面影响。显然，这些算法是为了在数据分析中使用它而优化的。</p><p id="b008" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在这个故事中，我们将深入讨论如何优化著名的Gram-Schmidt正交化过程<strong class="lo jg">【1】</strong>，在即将推出的Schwarz-Rutishauser修正<strong class="lo jg">【5】</strong>的基础上显著降低其复杂度。</p><p id="7d76" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">此外，我们将调查Schwarz-Rutishauser算法的复杂性，将其与其他现有的QR分解方法进行比较，如经典的Gram-Schmidt过程和Householder反射<strong class="lo jg">【1，4】</strong>。</p><p id="fcba" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">此外，这个故事在底部包含了工作示例和到一个开源项目的<em class="mn"> GitHub </em>库的链接，这个开源项目包含了<em class="mn"> Python 3.9.x </em>和最新的<em class="mn"> NumPy 1.20.x </em>库，实现了所讨论的Gram-Schmidt、Householder和Schwarz-Rutishauser算法，提供了所有这些方法性能的总结。</p><h1 id="2fa2" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">QR分解</h1><p id="3253" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">QR分解是将实数或复数矩阵<strong class="lo jg"> A (m x n) </strong>分解成正交矩阵<strong class="lo jg"> Q </strong>和上三角矩阵<strong class="lo jg">R【1】</strong>的乘积，例如:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/8b712df48a7546601f91eefa4a0c7476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cSR45YqaAiEekFcrWOs0hg.png"/></div></div></figure><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/a3385db8dfbf78dfdc20dcfe6c5818a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOZSUj5b56rnQxiqcPhIrQ.png"/></div></div></figure><p id="688c" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">通常，矩阵𝙌的计算产生矩阵𝘼<strong class="lo jg">【1，4】</strong>的因式分解，例如:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/3818ba956d5794b94bcc904350f41f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rqZwUa4H_2ADjTFj6m2m6w.png"/></div></div></figure><p id="77ec" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在下面的段落中，我们将彻底讨论矩阵𝙌和𝙍最常见的性质<strong class="lo jg">【4】</strong>。</p><h2 id="5a2e" class="mv kv jf bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">正交矩阵Q:</h2><p id="5bcb" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">通常，正交矩阵𝙌的计算导致矩阵𝘼<strong class="lo jg">【4】</strong>的分解，因此完全分解和部分分解都存在。QR分解不仅可以应用于正方形矩阵，也可以应用于矩形矩阵，即使矩阵不具有满秩。大多数情况下，𝘼的完全因式分解给出了与𝘼矩阵形状相同的𝙌矩阵，或者至少𝙌和𝘼的列数相等<strong class="lo jg">【5】</strong>。矩阵𝘼的因式分解是QR分解的一个有用属性，只要𝘼的元素必须用因式<strong class="lo jg">【1，3】</strong>表示，就可以应用该属性。</p><p id="acc6" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">根据其定义<strong class="lo jg">【1】</strong>，𝙌是一个对称矩阵，由于正交特性<strong class="lo jg"> (1.2) </strong>，与其转置相乘是一个单位矩阵𝙄。𝙌中的每个列向量都与其他向量正交。所有这些列向量构成了𝘼的标准正交基，这非常类似于将欧几里得空间ℝₙ中的每个列向量映射到不同空间ℝ'ₙ.的坐标系中术语“标准正交”是指𝙌中的正交列向量通过除以其欧几里德范数<strong class="lo jg">【1，2，6】</strong>而被归一化。</p><h2 id="3ad3" class="mv kv jf bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">上三角矩阵R:</h2><p id="30ff" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">反过来，上三角矩阵𝙍可以很容易地作为矩阵𝙌's-transpose和𝘼的乘积得到，所以𝙍是一个矩阵，它的所有子对角线都是<strong class="lo jg">0</strong>。具体来说，𝙍的计算导致𝘼的高斯消除，将其减少到行梯队形式<strong class="lo jg">【1，4，5，6】</strong>。为了消除𝙍中对角线元素之后的元素，标量元素𝒓ᵢₖ、𝒓ₖₖ乘以希尔伯特环境空间ℋ<strong class="lo jg">【2】</strong>中子空间ℏ的相应单位基向量𝒆ₖ。</p><p id="871f" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">上面提到的𝘼's上三角矩阵𝙍被有效地用于求解线性最小二乘(LS)问题，以及寻找𝑨𝒙=𝒃线性方程组<strong class="lo jg">【1】</strong>的单个非平凡解。</p><p id="9908" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">一个普通的2乘2 r eal矩阵𝘼的QR分解可以描述为:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/4a7337b9f25148512bd5174c4e3f175b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dzsqtRErtmHcF6PssJzduQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">2乘2平方实矩阵A的QR分解</p></figure><p id="458e" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">第<strong class="lo jg">列第一个</strong>和第<strong class="lo jg">列第二个</strong>列向量<strong class="lo jg">a₁(3；4) </strong>和<strong class="lo jg">a₂(7；5) </strong>、(红色)和(藏青色)，如上图所示。</p><p id="33b4" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">图<strong class="lo jg"> a) </strong>，从左起，说明了列向量<strong class="lo jg"> q₁(-0.6,-0.8) </strong>和<strong class="lo jg"> q₂(-0.8,0.6) </strong>、(金色)和(蓝色)，作为矩阵𝘼分解的结果而获得。这些向量的长度必须总是等于<strong class="lo jg"> | </strong>、𝙦 <strong class="lo jg"> |=1 </strong>，因此是正交单位向量𝙦.</p><p id="792c" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">向量<strong class="lo jg"> q₁ </strong>和<strong class="lo jg"> q₂ </strong>彼此垂直，因此是正交的。在最简单的情况下，这些向量中的每一个都可以通过将𝘼中的每一个列向量旋转90°角来获得。具体的旋转可以通过将平凡的雅可比旋转矩阵乘以多向量𝘼.中的每一列来完成</p><p id="1627" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">对应的向量<strong class="lo jg">r₁(-5；——8.2)</strong>，<strong class="lo jg">r₂(0；-2.6) </strong>在𝙍，(金色)和(蓝色)，分别标绘在图<strong class="lo jg"> b) </strong>中，从右侧开始。与多向量𝙌的列不同，这些向量不是正交的。如上所述，这些向量是作为𝙍中的每个列向量分别与希尔伯特环境空间ℋ中的每个子空间的相应单位基向量𝒆₁和𝒆₂(绿色)的标量乘法的结果而逐列获得的。</p><h2 id="5aa5" class="mv kv jf bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">已知的QR分解方法</h2><p id="fa43" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">目前，至少有三种现有方法广泛用于计算实矩阵和复矩阵的QR分解:</p><ul class=""><li id="2f2e" class="ni nj jf lo b lp mi ls mj lv nk lz nl md nm mh nn no np nq bi translated"><strong class="lo jg">格拉姆-施密特正交化</strong></li><li id="7a0f" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh nn no np nq bi translated"><strong class="lo jg">户主的感想</strong></li><li id="405c" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh nn no np nq bi translated"><strong class="lo jg">吉文斯旋转</strong></li></ul><p id="6106" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">上述每种方法都有自己的优点和缺点。例如，当用于复矩阵的QR分解时，Householder反射通常非常复杂。反过来，Givens旋转方法导致最终迭代次数的精度损失，并且在将其用于大型矩阵分解时效率低下。</p><p id="213e" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在这个故事中，我们将讨论经典的Gram-Schmidt过程和Rutishauser算法。我们将以Householder反射法和Givens旋转法为例，仅用于评估目的，将这两种方法的复杂性与正在讨论的Schwarz-Rutishauser算法的复杂性进行比较。</p><p id="0fec" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在接下来的段落中，我们将讨论Schwarz-Rutishauser算法，它是Gram-Schmidt正交化过程中最成功的变体之一。</p><h1 id="bf4a" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">格拉姆-施密特正交化</h1><p id="52fb" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">Gram-Schmidt过程于50年代中期提出，是用于实矩阵或复矩阵正交化的首批成功方法之一<strong class="lo jg">【1，4，5，6】</strong>。</p><p id="09ed" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">这种方法广泛用于递归地寻找𝑨的正交矩阵𝑸，基于每个向量𝒂ₖ ∈ 𝑨，𝒌=𝟏的正交投影..𝒏到跨度矢量𝗾 <strong class="lo jg"> ᵢ </strong> ∈ 𝙌(𝒌)、𝒊=𝟏..𝒌，这是众所周知的。每个新的正交向量𝙦 <strong class="lo jg"> ₖ </strong> ∈ 𝙌被计算为投影的和，从相应的向量𝒂ₖ ∈ 𝑨.中减去它最后，通过使用上面的等式<strong class="lo jg"> (1) </strong>，可以容易地获得作为𝑸's-transpose和矩阵𝑨的乘积的上三角矩阵𝑹。</p><p id="441b" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">通过使用下面的等式<strong class="lo jg">(2)</strong>获得𝒂到𝒒的正交投影:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nw"><img src="../Images/57d5d7e6cc45caa687cb340c13a615e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77Su736c5Htg0kJxFQW5Iw.png"/></div></div></figure><p id="6b9b" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">通常，整个Gram-Schmidt过程产生一个正交矩阵𝙌，可以表示为:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nx"><img src="../Images/180c70e1642dc4ab2dd1ac3975013a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5sTtodR6JSeGHPn5TOTp2A.png"/></div></div></figure><p id="ef0b" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">，或者:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/93d52149f4eb0f2ba94545ee7927fd14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5nu8FBBlmw7POGsH1tm6uA.png"/></div></div></figure><p id="7b29" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">每个新的向量𝙦ₖ ∈ 𝙌最后通过除以它的欧几里德norm|𝙦ₖ|.来归一化</p><p id="74de" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">下面的一段代码演示了经典的Gram-Schmidt过程的实现:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="fa6a" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">事实上，Gram-Schmidt正交化过程比Householder反射或Givens旋转方法更直观简单。虽然，当应用于大规模矩阵的正交化时，它有许多缺点，例如数值不稳定，以及明显高于𝑶❨𝟐𝒎𝒏 ❩的高计算复杂度。此外，它需要基于确定矩阵的前导维数进行修改，以提供矩形<em class="mn"> m乘n </em>矩阵正交化<strong class="lo jg">【4】</strong>的能力。</p><h1 id="fa79" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">Schwarz-Rutishauser算法</h1><p id="b00c" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">您可能已经注意到，经典的Gram-Schmidt正交化是一种非常复杂的算法，它是由每个向量𝒂ₖ ∈ 𝑨到向量𝗾 <strong class="lo jg"> ᵢ </strong> ∈ 𝙌(𝒌).的正交向量投影的计算引起的在这种情况下，正交投影算子的复杂度大约为𝑶❨𝟑𝒎❩，并且通常对Gram-Schmidt过程本身的整体复杂度有负面影响<strong class="lo jg">【4】</strong>。</p><p id="85af" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">显然，我们需要一种稍微不同的方法来进行𝑨的正交化，而不是计算𝒂ₖ-vectors投影到𝙌(𝒌).上的倍数和</p><p id="bf82" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">Schwarz-Rutishauser算法是经典的Gram-Schmidt正交化过程的修改，由H. R. Schwarz、H. Rutishauser和E. Stiefel在他们的研究论文<em class="mn">“Numerik symmetrischer Matrizen”(Stuttgart，1968)</em><strong class="lo jg">【6】</strong>中提出。以下研究旨在降低现有基于Gram-Schmidt投影方法的复杂性，并提高其数值稳定性<strong class="lo jg">【5】</strong>。</p><p id="246d" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">Schwarz-Rutishauser算法背后的主要思想是，与原始的Gram-Schmidt过程𝑶❨𝟐𝒎𝒏 ❩和Householder反射𝑶❨𝟐𝒎𝒏 -𝟬.相比，𝑨's正交基计算复杂度可以大大降低𝟔𝒏 ❩方法<strong class="lo jg">【5】</strong>。</p><p id="f0b4" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">为了更好地理解Schwarz-Rutishauser算法，让我们从右边更仔细地看一下等式<strong class="lo jg"> (2 </strong>)和<strong class="lo jg"> (3.1) </strong>，如上图所示。</p><p id="3242" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">在计算𝒂's在跨度𝙌(𝒌上的投影和时，我们必须将向量的标量积除以范数|𝙦ₖ|的平方，实际上是将乘积<strong class="lo jg">【2】</strong>归一化。然而，这是不必要的，因为每个向量𝗾 <strong class="lo jg"> ᵢ </strong> ∈ 𝙌(𝒌)已经在之前的𝒌-th算法步骤之一中被立即归一化。</p><p id="941f" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">据此，等式<strong class="lo jg"> (3.1) </strong>可以通过从右侧的投影<strong class="lo jg">【5】</strong>的和中去除除以平方范数来简化:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/ad9e0a29baf71a41c3f6feed4297e833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3gG4Y2x9zXHCWkdPgEaWQ.png"/></div></div></figure><p id="e239" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">由于𝑹是𝑸's-transpose和𝑨的内积，那么我们可以很容易地计算每个列向量𝒓ₖ的𝒊-th元素为:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/181eed00ca973eb36ef45df58b37ef5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rwXinySM5D_OjfuAbQj-dQ.png"/></div></div></figure><p id="436c" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">这里𝗾 <strong class="lo jg"> ᵢ </strong> - <strong class="lo jg"> </strong>和<strong class="lo jg"> </strong> 𝒂ₖ-vectors的标量积乘以希尔伯特环境空间ℋ<strong class="lo jg">【2】</strong>中对应平面的单位基矢𝙚ₖ。</p><p id="c439" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">最后，让我们将等式<strong class="lo jg"> (4.2) </strong>代入<strong class="lo jg"> (4.1) </strong>，这样我们就有了:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/021611f20065e817a7e0fd8bf230d594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u7GhfcYmq6kEaZCzvs9x_A.png"/></div></div></figure><p id="1023" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">由于我们承认𝑸最初等于𝑨 ( 𝑸 =𝑨)，基于上述等式<strong class="lo jg"> (4.2) </strong>和<strong class="lo jg"> (4.3) </strong>的𝗾和𝒓的计算可以递归地进行<strong class="lo jg">【5】</strong>:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/497f7fcaefcdd3857d6c2d2de0f3eaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqDNH7NLD6G26ZK_Am0DVw.png"/></div></div></figure><p id="6e01" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">根据向量算术，为了得到每个新的𝒌-th列𝙦ₖ ∈ 𝙌，我们从向量𝙦ₖ中减去向量𝗾 <strong class="lo jg"> ᵢ </strong> ∈ 𝙌(𝒌)和𝒓ᵢₖ的乘积，这是向量的拒绝。让我们回忆一下，向量𝙦ₖ最初等于𝒂ₖ (𝙦ₖ=𝒂ₖ).这就是为什么求和算子最终可以从方程<strong class="lo jg"> (4.3) </strong>中去掉。</p><p id="6abe" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">除了𝙦ₖ，我们还需要计算𝑹的𝒓ₖₖ 𝒌-th对角线元素，如范数|𝙦ₖ|:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/d1f5b4dd0404b972cf91120190e0fd69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yBb__0ZQsG5MfWfQtdMAZg.png"/></div></div></figure><p id="f642" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">，然后，归一化新𝒌-th列向量𝙦ₖ ∈ 𝙌，除以其范数，等于对角元素𝒓ₖₖ<strong class="lo jg">【5】</strong>。</p><p id="2f69" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">最后，我们可以用公式表示Schwarz-Rutishauser算法:</p><ol class=""><li id="69b7" class="ni nj jf lo b lp mi ls mj lv nk lz nl md nm mh oe no np nq bi translated">初始化矩阵𝙌，等于𝑨 (𝙌=𝑨)，𝑹为<strong class="lo jg"> 0s </strong>的矩阵；</li></ol><p id="6486" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">2.对于每个𝒌-th列向量，𝙦ₖ ∈ 𝙌，𝒌=𝟏..𝒏，请执行以下操作:</p><p id="0230" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">2.1.对于向量的跨度𝗾 <strong class="lo jg"> ᵢ </strong> ∈ 𝙌(𝒌)、𝒊=𝟏..𝒌，这是众所周知的:</p><ul class=""><li id="2200" class="ni nj jf lo b lp mi ls mj lv nk lz nl md nm mh nn no np nq bi translated">得到𝒌-th列向量𝒓ₖ ∈ 𝑹的𝒊-th元𝒓ᵢₖ，方程<strong class="lo jg">(5.1)</strong>；</li><li id="3423" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh nn no np nq bi translated">更新𝒌-th列向量𝙦ₖ ∈ 𝙌，方程<strong class="lo jg">(5.2)</strong>；</li></ul><p id="13ca" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">2.2.继续前面的步骤2.1，对向量𝙦ₖ进行正交化，得到𝒌-th列向量𝒓ₖ；</p><p id="4405" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">3.计算对角元素𝒓ₖₖ作为𝙦ₖ-vector's范数𝒓ₖₖ=|𝙦ₖ|，方程<strong class="lo jg">(5.3)</strong>；</p><p id="4a78" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">4.归一化𝒌-th列向量𝙦ₖ ∈ 𝙌，除以其范数，等于上一步3的𝒓ₖₖ；</p><p id="e293" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">5.继续进行步骤1-4中执行的𝑨正交化，以计算𝑨'正交基𝙌和上三角矩阵𝑹；</p><p id="9795" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">6.一旦完成，从过程返回负的合成矩阵-𝙌和-𝑹；</p><p id="1f78" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">与原始的Gram-Schmidt过程相比，Schwarz-Rutishauser算法的实现非常简单。此外，它提供了就地计算𝑹和𝙌向量的能力，降低了算法的复杂性<strong class="lo jg">【5】</strong>。</p><p id="34ac" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">下面列出了演示Schwarz-Rutishauser算法实现的一段代码:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h1 id="9e91" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">数值的稳定性</h1><p id="0a6e" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">在许多情况下，由于浮点算术溢出问题<strong class="lo jg">【1】</strong>导致的持续舍入误差，使用计算机获得的最高精度近似值在数值上是不稳定的。</p><p id="514b" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">本身，实矩阵或复矩阵分解的稳定性很大程度上取决于其元素的数值表示(实矩阵或复矩阵)以及它们的数量。</p><p id="fc35" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">根据最佳实践，为了避免执行QR分解时显著的精度损失，建议使用Python和其他编程语言的各种现有多精度库(如<strong class="lo jg"> mpmath </strong>或<strong class="lo jg"> GMPY </strong>)将实数或复数矩阵的元素表示为有理数。</p><h1 id="ddaf" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">复杂性</h1><p id="5f8e" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">最后，让我们花点时间来看看Schwarz-Rutishauser算法的复杂性。在大多数情况下，与经典的Gram-Schmidt和Householder反射方法<strong class="lo jg">s【4，5】</strong>相比，它的复杂度评估为𝑶(𝙢𝙣)并且减少到至少两倍<strong class="lo jg"> (2x) </strong>。此外，使用Gram-Schmidt和Householder方法的复矩阵的QR分解需要转置共轭的计算，这又大大增加了总体复杂度，至少增加了𝙣-times。</p><p id="0776" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">所有三种QR算法的复杂性如下表所示:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/e0d7b885495c2fa1ed736db2e8e81df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvmr1byT5evsYDoeKpUlCg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">QR算法计算复杂度</p></figure><p id="825c" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">Schwarz-Rutishauser算法的复杂度对于实矩阵或复矩阵QR分解的情况保持不变，因为以下算法不额外需要计算矩阵的复转置共轭，并且基于相同的正交化过程，应用于任何矩阵，而不管数据类型<strong class="lo jg">【5】</strong>。</p><p id="b665" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">Schwarz-Rutishauser算法和其他现有QR算法的复杂性调查如下图所示:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/236b7e004615bb5b6424756a2ba30b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPzFgzw6ZHFmBv-aiIsHbg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">QR算法复杂性综述</p></figure><p id="44c4" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">如您所见，与Householder反射(红色)相比，Schwarz-Rutishauser算法(navy)的整体复杂度降低了近61%，与经典的Gram-Schmidt正交化过程(绿色)相比，复杂度降低了50%。</p><h1 id="9749" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">总之…</h1><p id="307d" class="pw-post-body-paragraph lm ln jf lo b lp lq kg lr ls lt kj lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">最后，正在讨论的Schwarz-Rutishauser算法在用于任意形状的大规模实数和复数矩阵的因式分解时是非常有效的，这些矩阵在每个维度上具有超过𝟏𝟎元素的大小。此外，它被认为具有更好的数值稳定性，对于并行运行因式分解过程是有吸引力的，可以在多节点计算集群中的多个CPU之间进行扩展。</p><p id="9aab" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">与经典的Gram-Schmidt过程相比，Schwarz-Rutishauser算法的总体复杂度仅为𝑶(𝙢𝙣，𝑶(𝒏)-times更小，并且非常接近矩阵内积复杂度。</p><p id="7fcc" class="pw-post-body-paragraph lm ln jf lo b lp mi kg lr ls mj kj lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated"><strong class="lo jg"><em class="mn">Python 3.9 . x和NumPy 1.20.x中的QR分解完整源代码项目可从我的GitHub资源库下载，网址为</em></strong><a class="ae oh" href="https://github.com/arthurratz/qr_decomposition" rel="noopener ugc nofollow" target="_blank"><strong class="lo jg"><em class="mn">https://github.com/arthurratz/qr_decomposition</em></strong></a></p><h1 id="3010" class="ku kv jf bd kw kx ky kz la lb lc ld le kl lf km lg ko lh kp li kr lj ks lk ll bi translated">参考</h1><ol class=""><li id="80be" class="ni nj jf lo b lp lq ls lt lv oi lz oj md ok mh oe no np nq bi translated"><a class="ae oh" href="https://en.wikipedia.org/wiki/QR_decomposition" rel="noopener ugc nofollow" target="_blank"><em class="mn">“QR分解”——来自维基百科，免费百科</em> </a></li><li id="76dd" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh oe no np nq bi translated"><a class="ae oh" href="https://en.wikipedia.org/wiki/Projection_(linear_algebra)#:~:text=self%2Dadjoint).-,Orthogonal%20projections,%2C%20for%20every%20and%20in%20%2C%20." rel="noopener ugc nofollow" target="_blank"> <em class="mn">《投影(线性代数)》——来自维基百科，免费百科</em> </a></li><li id="4262" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh oe no np nq bi translated"><a class="ae oh" href="https://en.wikipedia.org/wiki/Factorization#:~:text=In%20mathematics%2C%20factorization%20(or%20factorisation,objects%20of%20the%20same%20kind." rel="noopener ugc nofollow" target="_blank"> <em class="mn">“因式分解”——来自维基百科，免费百科</em> </a></li><li id="413d" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh oe no np nq bi translated"><a class="ae oh" href="http://www.seas.ucla.edu/~vandenbe/133A/lectures/qr.pdf" rel="noopener ugc nofollow" target="_blank"><em class="mn">“ECE 133 a—应用数值计算(6。QR-因子分解)”，美国加州大学洛杉矶分校L. Vandenberghe教授，2019年秋季</em> </a></li><li id="0fc4" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh oe no np nq bi translated"><a class="ae oh" href="https://people.inf.ethz.ch/gander/papers/qrneu.pdf" rel="noopener ugc nofollow" target="_blank"><em class="mn">【QR分解算法】作者Walter Gander，Fuer Angewandte Mathematik eidgeneessische Technische Hochschule CH-8092 ZUERIC，1980年4月</em> </a></li><li id="ffff" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh oe no np nq bi translated"><a class="ae oh" href="http://www.sam.math.ethz.ch/~mhg/pub/mhg-published/Rutishauser-LoNM.pdf" rel="noopener ugc nofollow" target="_blank"><em class="mn">《Numerik symmetrischer Matrizen》，H. R. Schwarz、H. Rutishauser和E. Stiefel著，斯图加特，1968年</em> </a></li><li id="cf78" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh oe no np nq bi translated"><a class="ae oh" href="https://scienceon.kisti.re.kr/srch/selectPORSrchPatent.do?cn=USP2009037512463" rel="noopener ugc nofollow" target="_blank"> <em class="mn">“利用QR分解和无约束优化减少多旋翼飞机的振动”，Bechhoefer，Eric Robert，西蒙兹精密产品公司，美国专利USP2009037512463，2005年2月16日</em> </a></li><li id="da15" class="ni nj jf lo b lp nr ls ns lv nt lz nu md nv mh oe no np nq bi translated"><a class="ae oh" href="https://pantelis.github.io/cs301/docs/common/lectures/recommenders/netflix/" rel="noopener ugc nofollow" target="_blank"><em class="mn">《Netflix奖与奇异值分解》，NJIT，cs 301-2021春</em> </a></li></ol></div></div>    
</body>
</html>