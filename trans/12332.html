<html>
<head>
<title>This Python Library Automates Pandas and Helps You Replace Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这个Python库自动化熊猫，并帮助你取代Excel</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/this-python-library-will-help-you-move-from-excel-to-python-in-no-time-139e45ce9c69?source=collection_archive---------7-----------------------#2021-12-15">https://towardsdatascience.com/this-python-library-will-help-you-move-from-excel-to-python-in-no-time-139e45ce9c69?source=collection_archive---------7-----------------------#2021-12-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e986" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个Python库，帮助我们像使用Excel一样处理熊猫。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f931b8fd794e64b41f35e1f08fecfb2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0w_qPBnDOroVOFou"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动创作者</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4a0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是使用Python和<a class="ae ky" rel="noopener" target="_blank" href="/a-python-pandas-introduction-to-excel-users-1696d65604f6">进行数据分析的最佳工具，它比Microsoft Excel </a>等工具有许多优势，但对于那些几乎没有编码经验或不熟悉Pandas的人来说，从Excel过渡到Python是一个挑战。</p><p id="2e0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，现在不再是这样了。几周前，我偶然发现了一个Python库，它可以帮助我们像使用Excel一样处理熊猫。</p><p id="4843" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您展示如何使用Python库来创建数据透视表、连接表、过滤数据等，Python库允许我们使用类似于Excel的接口来处理Pandas数据框架，并自动为我们生成Pandas代码。</p><p id="7461" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从Excel迁移到Python从未如此简单！</p><h1 id="141d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数据集和安装</h1><h2 id="2f5e" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">资料组</h2><p id="cb17" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">在本指南中，我们将使用的数据是在<a class="ae ky" href="https://drive.google.com/drive/folders/1d3N4hs0dDEdEsUqI9J_MHaF5CdYIlSLM?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Drive </a>上提供的一个“学生表现”CSV文件，它是我自己生成的。这是随机数据，包含学生在不同学科获得的分数，在米托的帮助下，我们将很容易地从Excel电子表格转移到Python的数据框架。</p><p id="927d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保CSV文件和Python脚本位于同一个目录中。</p><h2 id="29a5" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">装置</h2><p id="6746" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">为了轻松地创建数据透视表、可视化和执行您在Excel或Pandas中要做的操作，我们只需要安装mitosheet库(确保您有Python 3.6或更高版本，还有JupyterLab)</p><p id="12da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装mitosheet，首先，打开一个新的终端或命令提示符，然后运行以下命令(如果可能，将其安装在新的虚拟环境中):</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="4d1b" class="mn lw it nf b gy nj nk l nl nm">python -m pip install mitoinstaller<br/>python -m mitoinstaller install</span></pre><p id="fef1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们开始与米托合作所需要的一切！有关安装的更多细节，请查看<a class="ae ky" href="https://docs.trymito.io/getting-started/installing-mito" rel="noopener ugc nofollow" target="_blank">官方文档</a>。</p><h1 id="acb6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用mitosheet创建数据框架</h1><p id="c3b2" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">要使用Python创建数据帧，我们需要导入pandas并使用。read_csv()方法，但是使用米托，我们只需要<code class="fe nn no np nf b">import mitosheet</code>并通过键入<code class="fe nn no np nf b">mitosheet.sheet()</code>来初始化它。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="566e" class="mn lw it nf b gy nj nk l nl nm"><strong class="nf iu">import</strong> mitosheet<br/>mitosheet.sheet()</span></pre><p id="a40e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码将创建一个有丝分裂表。如果调用mitosheet.sheet()时图纸没有呈现，请重新启动JupyterLab。</p><p id="446b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们可以通过点击左下角的<code class="fe nn no np nf b">+</code>按钮导入数据集。然后，选择如下图所示的<code class="fe nn no np nf b">StudentsPerformance.csv</code>文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/071792c64fe8c1590ba09b62ede41812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Q5tcROX0IVpcGvXciqT6vQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2489" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导入CSV后，将使用相同的文件名创建一个数据帧。除此之外，米托自动生成下面单元格中的代码。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="0e5c" class="mn lw it nf b gy nj nk l nl nm"><strong class="nf iu">from</strong> mitosheet <strong class="nf iu">import</strong> *; register_analysis('UUID-b580825e-1ba5-47fc-851a-612cf52b9543')</span><span id="6690" class="mn lw it nf b gy nr nk l nl nm"># Imported StudentsPerformance.csv<br/><strong class="nf iu">import</strong> pandas <strong class="nf iu">as</strong> pd<br/>StudentsPerformance_csv = pd.read_csv(r'StudentsPerformance.csv')</span></pre><p id="0be7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是用mitosheet导入数据所需的一切。现在让我们自动化一些常见的Pandas方法。你可以继续阅读或者看我的视频教程。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h1 id="2696" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">添加新列并重命名列</h1><p id="0bee" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">添加新列是我们在Excel/Pandas中执行的一项常见任务。在Excel中，我们只需要右键单击来创建一个新列，而在Pandas中，我们必须使用<code class="fe nn no np nf b">.insert()</code>方法。</p><p id="0d5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了米托，我们可以两全其美。要添加新列，您只需点击“添加列”按钮。然后双击列名来设置您想要的名称。</p><p id="b0f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们通过创建一个名为“average”的新列来实现这一点</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/77c56546b5cf21e8aff1ec0ad7596cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*i5BFwVXhItRIC9UdPw5wMg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="813b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，检查下面的单元格。米托自动生成添加和重命名列的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nt l"/></div></figure><h1 id="9662" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">对一行求和</h1><p id="e1e4" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">米托可以帮助我们合计行值，就像我们在使用Microsoft Excel一样。我们只需要定位我们想要引入公式的单元格，然后按<code class="fe nn no np nf b">= </code>并选择我们想要求和的列，并在它们之间写入<code class="fe nn no np nf b">+</code>运算符。</p><p id="acdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更好地向您展示这是如何工作的，让我们来计算数学、阅读和写作考试的平均分数。在我们上一步创建的“average”列中找到一个单元格，写出下面gif中显示的公式，按enter键，然后<em class="nv">瞧！</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/3878cbaa470f2785c54dcdf792648bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yLHVWOnn_LM-KWVQXhXbNQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="802b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想知道米托做了什么，这里有一段由米托自动生成的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nt l"/></div></figure><h1 id="188e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">过滤数据帧</h1><p id="79f3" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我们可以根据一个或多个条件过滤数据。</p><h2 id="38b0" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">基于1个条件</h2><p id="f598" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">假设我们只想显示与<code class="fe nn no np nf b">female</code>性别相关的数据。使用米托，我们只需要选择“性别”栏，然后点击漏斗图标，选择我们想要过滤的内容。在这种情况下，我们转到“过滤器”部分，点击“添加过滤器”，并设置“完全”等于“女性”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/31ac214e9a06554fe49931812fe534ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*7YIk6Hb6mJYrfhTyOGznmA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="b902" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">基于2个或更多条件</h2><p id="54f0" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">现在，假设我们想要显示与属于<code class="fe nn no np nf b">group B</code>的<code class="fe nn no np nf b">female</code>性别相关的数据。</p><p id="e21b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们只需要重复我们选择<code class="fe nn no np nf b">female</code>性别的步骤，但是现在使用<code class="fe nn no np nf b">group B</code>。选择“组”列，单击漏斗图标，转到“过滤器”部分，单击“添加过滤器”并设置“恰好”等于“组B”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/dacd3cecfeae5c5dc827051cc988c908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*k20crZYDE1rKq7OCNC-KkQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="13f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码对应于前面的过滤器。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nt l"/></div></figure><h1 id="1c79" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建数据透视表</h1><p id="1586" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我们可以在Python中创建一个数据透视表，就像在Excel中使用mitosheet一样。首先，单击“Pivot”按钮，然后选择您希望包含在行、列和值中的元素。</p><p id="c6d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的示例中，我们将创建一个数据透视表，显示所有组在<code class="fe nn no np nf b">race/ethnicity</code>列(组列)中的数学和阅读分数的平均值。为此，请遵循下面gif中显示的步骤。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/ad6a182a5a6c3a1603eaa8fe3f628845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qQmg0CX-qPYA9YNFWjxVeQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c21f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想知道窗帘背后的代码，这里有一个片段。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nt l"/></div></figure><h1 id="9c50" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建条形图</h1><p id="6554" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">就像Excel一样，米托帮助我们在Python中点击几下就可以创建基本的可视化。</p><p id="792a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们为之前创建的数据透视表创建一个条形图。为此，单击“Graph”按钮，然后确保数据源是我们创建的新数据透视表“df2 ”,并且图表类型设置为“bar”</p><p id="d32e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在X轴中，我们应该包括“种族/民族”列(组列)，在Y轴中，包括“匹配分数平均值”列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/db917c5bc09ad189df08757498b091db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5EA1wy9O8ibMwRLvZsvocg.gif"/></div></div></figure><p id="ff73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！我们可以和米托在几分钟内完成所有这些。如果你有很多关于熊猫的经验，也许你能像米托一样快地得到结果，但是如果你是熊猫或Python的新手，这个库就派上用场了</p><h1 id="dc18" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">合并2个表格</h1><p id="ce6e" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">用米托可以很容易地合并两个表。在这个例子中，我们将看到如何进行内部连接。为此，我们需要两个具有相同列的表格，所以从我的<a class="ae ky" href="https://github.com/ifrankandrade/data_preprocessing.git" rel="noopener ugc nofollow" target="_blank"> Github </a>下载“学生表现id”和“语言得分”CSV文件。要导入第二个表，请遵循本文第一部分“创建数据帧”中所示的步骤</p><p id="2c71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将两个表导入米托后，单击“Merge”按钮将它们连接起来。确保两个表中的“Merge Key”选项都设置为“id”(这是我们需要进行内部连接的公共列)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/40e1e196781ffe58d9b7c6e9d1b474ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mjd-bCSFZabKmWdLseE66w.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f3ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此之后，您将看到一个名为“df3”的新数据帧这是连接“学生成绩_id_csv”和“语言分数_csv”数据框架后的结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nt l"/></div></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="2656" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://frankandrade.ck.page/bd063ff2d3" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">与6k以上的人一起加入我的电子邮件列表，获取我在所有教程中使用的Python for Data Science备忘单(免费PDF) </strong> </a></p><p id="a5f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你使用<a class="ae ky" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="od oe gp gr of og"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="op l"><div class="oq l or os ot op ou ks og"/></div></div></a></div></div></div>    
</body>
</html>