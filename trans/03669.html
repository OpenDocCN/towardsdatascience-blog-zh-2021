<html>
<head>
<title>N-Ary Relationships in Graph Databases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图数据库中的n元关系</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/n-ary-relationships-in-graph-databases-81ca596dac48?source=collection_archive---------23-----------------------#2021-03-25">https://towardsdatascience.com/n-ary-relationships-in-graph-databases-81ca596dac48?source=collection_archive---------23-----------------------#2021-03-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="32a8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么超图数据库有优势</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/b4b5f943e504705f9a8c4b5730304463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*5S3NncZJkeZ-2qff2U4aeA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">属性图模式中隐含的三元关系。图片作者。</p></figure><p id="80ab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对<a class="ae lq" href="https://en.wikipedia.org/wiki/Directed_graph" rel="noopener ugc nofollow" target="_blank">有向图</a>进行操作的专用<a class="ae lq" href="https://en.wikipedia.org/wiki/Graph_database" rel="noopener ugc nofollow" target="_blank">图数据库</a>处理三进制或更多(n进制)关系非常糟糕，即使n进制关系在许多严肃的数据建模练习中表现出来。以上图为例，其中每个库存商品代表仓库中某个仓位的一部分。三元关系是由一系列三个二元关系(如有向图)暗示的，如<strong class="kw iu"> <em class="lr">库存项目是针对</em> </strong>零件的。</p><p id="a32f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了有助于形象化场景，想象一个仓库，其中存放着仓库管理员必须打包和挑选的物品(零件)，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/0b5ea6501505346c5eb4231bb11afd09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/0*h6LmfcE_pYME1scP.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">一名仓库保管员在仓库的箱子里寻找零件。图片经由<a class="ae lq" href="https://www.dreamstime.com/side-view-portrait-young-shop-assistant-inspecting-stock-doing-inventory-industrial-tools-store-man-doing-stock-image102810076" rel="noopener ugc nofollow" target="_blank">Dreamstime.com</a>授权给维克多摩根特。ID 102810076七十四张图片| Dreamstime.com</p></figure><p id="d195" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的仓库管理员正在取某个仓库中被称为<em class="lr">箱</em>的零件。注意每个箱子都有一个数字。我们的数据模型涵盖了一个假设的情况，即一家公司有多个仓库，一个零件编号为“123”的零件可能存储在不同仓库的不同编号的箱子中…从而在我们的数据模型/属性图模式中形成了一个称为<em class="lr"> StockedItem </em>的三元唯一关系。</p><p id="a71a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们将<em class="lr">属性</em>添加到StockedItem，我们的图形模式就变成了<em class="lr">属性图形</em>，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/e34920af218e19b1c7c1d47e06d96585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*WvgZAbi2_C5dJ01UYnD7OA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">属性图架构。图片作者。</p></figure><p id="9e6c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一个典型的图形数据库并不复杂，因为如果你知道一个StockedItem的<em class="lr"> Part_Nr </em>你并不知道它是否支持一个关系，<em class="lr"> StockedItem是用于Part </em>的，即使它被模式的可视化所暗示。事实上，许多图形数据库甚至没有提供查看模式的工具。这是因为典型图形数据库的内部管道(<a class="ae lq" href="https://en.wikipedia.org/wiki/Metamodeling" rel="noopener ugc nofollow" target="_blank"> <em class="lr">元模型</em> </a>)不够复杂，不足以映射属性和关系之间的关系，和/或图形数据库被吹捧为<em class="lr">无模式</em>…这基本上意味着您可以对数据库做您想做的事情，并且没有强制实施许多规则来确保您的数据是一致的，并且对数据范围内的一些常见模式有意义。</p><p id="f390" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是典型图形数据库的一个已知问题，迫使人们寻找变通方法来弥补元模型中的不足。</p><p id="029b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，当您想要将数据插入数据库时，问题就出现了。如果你想说“123”零件在“H1”仓库中，在“悉尼”仓库中，你不能只说<strong class="kw iu"> <em class="lr">和</em> </strong>与Part_Nr有关系(图表)【123】表示“123”零件在“Part_Nr”仓库中，以此类推，因为<strong class="kw iu"> <em class="lr"> StockedItem在“T6”</em></strong>仓库中，而<strong class="kw iu"> <em class="lr"> StockedItem在仓库</em> </strong> <em class="lr">、</em>中，而没有太大的区别</p><p id="4bac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我觉得在这里展示如何用典型的图形查询语言将三进制/多进制关系导入典型的图形数据库是没有意义的，因为典型的图形数据库已经过了它们的宣传周期高峰。本文提供了一个更适合数据建模者的解决方案。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/6e479f17de325996f62aad52b9223edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tj5JCPsQWtV_gG4PRCqdjg.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">全世界对图形数据库的兴趣正在下降，并在2017年达到顶峰。来源谷歌趋势，“图形数据库”。</p></figure><h2 id="7535" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">超图数据库具有优势…</h2><p id="987e" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">超图是这样一种图，其中图中的边/关系的概念被扩展，使得每条边可以连接两个以上的节点/顶点，并且边可以连接其他边。我在《走向数据科学》的中写了这些<a class="ae lq" rel="noopener" target="_blank" href="/knowledge-hypergraphs-object-role-modeling-ef0f58f38066">。</a></p><p id="f379" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，概念建模语言<a class="ae lq" rel="noopener" target="_blank" href="/why-learn-object-role-modelling-4eebd93dcda2">对象-角色建模</a> (ORM)，可以被概念化为超图建模语言。我们在ORM中的StockedItem模型看起来像…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/8e7116bc7ca3fafd947da096f11c3a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*_P9Y7Rnb4EdZlqap0zh-DQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">仓库中箱柜零件的对象-角色模型。图片作者。</p></figure><p id="23c5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，StockedItem不仅是图中一个表面上的节点，而且还是一个超边，它连接着源自真正边的关系。我们ORM图中的StockedItem是对象化的事实类型，虚线事实类型是<a class="ae lq" rel="noopener" target="_blank" href="/link-fact-types-in-object-role-modeling-3c68c15eec92">链接事实类型</a>。在语言学中，我们说仓库中的关系部分在Bin中已经被<a class="ae lq" href="https://en.wikipedia.org/wiki/Reification_(linguistics)" rel="noopener ugc nofollow" target="_blank">具体化</a>为<em class="lr"> StockedItem </em>。</p><p id="fb38" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">也就是说，对象-角色建模和具有映射到对象-角色模型的元模型的数据库，具有将图的属性链接到它们各自的关系所需的所有丰满度。比如说，“123”在Bin，“H1”，在Warehouse，“悉尼”，自动映射到超图中相应的关系/边。</p><h2 id="7be9" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">那么…我们的超图数据库在哪里？</h2><p id="aa86" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">你已经以这样或那样的方式使用它们很多年了……它们被称为<a class="ae lq" href="https://en.wikipedia.org/wiki/Relational_database" rel="noopener ugc nofollow" target="_blank"> <em class="lr">关系数据库</em> </a>。关系数据库是为连接的数据而制造的，因为在关系数据库中<em class="lr">关系</em>是一等公民……关系属性与它们的关系联系在一起。关系数据库是关系重要的地方。</p><p id="e21f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在之前的一篇文章中，我解释过关系数据库和图形数据库在概念上几乎是一样的……在概念层次上，同态接近同构。如果我们在这种情况下看我们的例子，我们得到这个原则的形象化…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mx"><img src="../Images/ba5b7bce7de8cc532c8eaa01b74c9edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*kIjqzS4lvhsBtU_eAzVkFw.gif"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">对象-角色模型、实体关系图和属性图模式之间的同态。图片作者。</p></figure><h2 id="ad03" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">一种方便的图形查询/操作语言…</h2><p id="1152" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">当您将关系数据库概念化为图形数据库时，非凡的事情是可能的。如果您可以在关系数据库上进行图形查询，那么专用图形数据库的优势就会有所减弱。</p><p id="6b1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们看一些例子。我们把对象-角色建模超图数据库作为一个两层实现，在关系数据库上有一个对象-角色模型知识图。</p><p id="91f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当您想要将数据插入到对象-角色模型超图数据库中的n元关系中时，它应该不比在专用图数据库中插入属性信息更困难。例如，要确定一个零件123在一个名为“悉尼”的仓库中的“H1”箱柜中，应该很容易:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/c7b7010b4c3977d3ee475f146c768f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eF1gvbwDEtUjeeVBABk11A.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">基于对象角色建模的超图数据库中的插入语句。图片作者。</p></figure><p id="b8ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为关系是hypergraph数据库中的一等公民，所以我们应该能够立即通过节点和关系查询数据库，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/755a4b3c0d3d607fda6e77cb7e1555d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*9-wwRPOzGTsMo7NgqY6WUw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">基于对象-角色建模的超图数据库的图查询。图片作者。</p></figure><p id="4981" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同样，如果我们想知道零件123在悉尼仓库的哪个箱子里(返回箱子，“H1”):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/63a7b687f5efbe8a50caf05c54d92dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*CjheFO6448Ay-qs4MQHjZA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">使用对象-角色模型知识图覆盖对关系数据库进行基于图的查询。图片作者。</p></figure><p id="8ecd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为我们的数据库将关系与属性联系在一起，所以我们可以通过引用关系来插入相同的StockedItem数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi nb"><img src="../Images/3ab67a7059c74213cd150b3c6ad89789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GKcrIKTLSf5OVIMhadV-cg.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">基于对象角色建模的超图数据库中n元关系的替换插入语法。图片作者。</p></figure><p id="8822" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">也就是说，在对象角色建模hypergraph数据库中，您可以选择如何引用数据和关系。典型的图形数据库不提供这种选择。</p><h2 id="27be" class="ly lz it bd ma mb mc dn md me mf dp mg ld mh mi mj lh mk ml mm ll mn mo mp mq bi translated">图数据库中的n元关系</h2><p id="ccb1" class="pw-post-body-paragraph ku kv it kw b kx mr ju kz la ms jx lc ld mt lf lg lh mu lj lk ll mv ln lo lp im bi translated">本文不是诱饵和开关，而是旨在表达一些关于图形数据库的事情:</p><ol class=""><li id="599d" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nh ni nj nk bi translated">典型的图数据库<strong class="kw iu"><em class="lr"/></strong>可以存储n元关系(边和属性)，但是如果对n元关系使用边和属性的组合，典型的图数据库的元模型不会将属性链接到它们各自的边/关系。</li><li id="168a" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated">关系数据库可以被概念化和查询，就像它们是一个图形数据库一样。如果您做了本文之外的功课，您会发现一些证据表明，一些关系数据库的图形查询速度比典型的图形数据库更快；</li><li id="d2c7" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated">超图数据库<strong class="kw iu"> <em class="lr">是</em> </strong>图数据库，顾名思义，当涉及到n元关系时，它们以一种超高效的方式做到这一点；</li><li id="15bb" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated">因为任何关系数据库都可以被概念化为对象-角色模型，并且因为对象-角色模型是有效的超图…你可以(再次)将任何关系数据库可视化为超图/图形数据库。</li></ol><p id="0308" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那么典型的图形数据库和n元关系在哪里呢？</p><p id="579b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">没有什么可以阻止图形数据库供应商支持将属性链接到关系…他们可以做到这一点。在某种程度上，它改变了他们的底层数据模型，他们可能最终得到一个混合的关系/图形数据库…如果你愿意的话，一个<em class="lr">图形</em>数据库，或者更普遍地称为多模型数据库。然而，我们在这里看到的是，实际上任何数据库都可以被概念化为多模型数据库…但是缺少一个更复杂的元模型和图形查询/定义语言。</p><p id="19bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">非常感谢阅读。如果时间允许，我会写更多关于图形数据库、对象角色建模、超图数据库和多模型数据库的文章。</p><ul class=""><li id="6113" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nq ni nj nk bi translated">对于感兴趣的人来说，本文中的所有查询和数据定义都是在SQLite关系数据库上进行的，在元模型级别上有一个对象-角色建模超图覆盖。</li></ul></div></div>    
</body>
</html>