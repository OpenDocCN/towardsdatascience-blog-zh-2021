<html>
<head>
<title>The What, Why, and How of Model Drift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模型漂移的内容、原因和方式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-what-why-and-how-of-model-drift-38c2af0e97ee?source=collection_archive---------21-----------------------#2021-10-26">https://towardsdatascience.com/the-what-why-and-how-of-model-drift-38c2af0e97ee?source=collection_archive---------21-----------------------#2021-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="bfa0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">行业笔记</a>，MLOps</h2><div class=""/><div class=""><h2 id="bf21" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">识别模型漂移的类型、检测技术、预防措施和补救措施</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/2f23bc02fb3fd1e293ff962417ced242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXJ83oz280dUMEe-E0mjaw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:undraw.co<a class="ae lh" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank"/></p></figure><h1 id="e182" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="3f35" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我们的世界千变万化，不断变化。随着时间的推移，正如热力学第二定律所描述的那样，事物趋向于无序。现实的这一基本性质在其范围内包含了机器学习模型的预测能力。换句话说，就像其他任何事情一样，机器学习模型会随着时间的推移而恶化。</p><p id="4c83" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在预测建模的上下文中，模型根据历史数据进行训练，并用于根据看不见的数据进行预测。这个过程产生一个模型，该模型映射输入特征和目标变量之间的关系。但是，在动态环境中，从长远来看，培训数据和生产数据之间的分布变化是不可避免的。随着时间的推移，这导致我们部署的模型的预测变得不太可靠，这种现象通常称为模型漂移。</p><blockquote class="nb"><p id="94dc" class="nc nd it bd ne nf ng nh ni nj nk mv dk translated">"变化是生活中唯一不变的东西。"赫拉克利特</p></blockquote><p id="86f7" class="pw-post-body-paragraph ma mb it mc b md nl kd mf mg nm kg mi mj nn ml mm mn no mp mq mr np mt mu mv im bi translated">如果不能及时发现并充分解决这个问题，可能会在这些模型运行的环境中产生严重的后果。在本文中，我们将深入研究文献中分类的常见漂移类型，确定漂移的一些原因、检测技术，以及最重要的补救措施。</p><h1 id="9e3b" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">模型漂移的类型</h1><p id="1e51" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">本文将涵盖两种主要类型的模型漂移，即数据漂移和概念漂移。值得一提的是，存在第三种类型的移动，<strong class="mc jd">先验概率移动，</strong>，这是由于目标变量分布的移动而发生的。但是，我们不会讨论这种类型的转换。</p><h2 id="7a54" class="nq lj it bd lk nr ns dn lo nt nu dp ls mj nv nw lu mn nx ny lw mr nz oa ly iz bi translated">数据漂移</h2><p id="09d5" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">当我们的输入特征的统计属性发生变化时，数据漂移，也称为<em class="ob">协变量移位</em>，由分布<em class="ob"> P(X </em>的变化表示。</p><blockquote class="nb"><p id="0d1c" class="nc nd it bd ne nf ng nh ni nj nk mv dk translated">这种现象意味着训练数据的输入特征分布与输入的实时生产数据之间存在差异。</p></blockquote><p id="98b1" class="pw-post-body-paragraph ma mb it mc b md nl kd mf mg nm kg mi mj nn ml mm mn no mp mq mr np mt mu mv im bi translated">发生数据漂移的一个常见原因是由于<strong class="mc jd">采样选择偏差</strong>。举例来说，许多学习场景中的默认假设是训练和部署数据是独立且同分布的(即，i.d ),即，它们来自相同的分布。样本选择偏差违反了这一假设，导致模型无法在部署时做出准确的预测。</p><p id="136e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">例如，考虑一个在 2010 年观看的电影数据集上训练的电影推荐系统。如果我们在 2021 年部署这种模型，很可能该模型的性能将是次优的。在我们的例子中，这归因于在此期间电影偏好趋势的变化。最终，由于训练集和制作集的输入特征分布之间的差异，在其他条件相同的情况下，如果用于预测 2021 年的电影偏好，我们的模型可能会失败。该示例捕捉了由于消费者偏好随时间变化以及违反 i.i.d .假设而导致的数据漂移。</p><p id="a339" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">虽然在前面的示例中，训练数据和服务数据之间的输入要素的分布发生了变化，但输入和目标之间的关系假设不变。接下来，我们将阐明随着时间的推移，这种关系的变化意味着什么。</p><h2 id="cc49" class="nq lj it bd lk nr ns dn lo nt nu dp ls mj nv nw lu mn nx ny lw mr nz oa ly iz bi translated">概念漂移</h2><p id="6f90" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">数据漂移表示服务数据和训练数据之间的输入变量的统计特性的差异，而概念漂移表示服务数据和训练数据的模型输入和目标变量之间的关系的差异，即分布<em class="ob"> P(Y|X) </em>的变化。简而言之，投入和目标之间的关系随着时间的推移已经发生了变化。</p><blockquote class="nb"><p id="6086" class="nc nd it bd ne nf ng nh ni nj nk mv dk translated">结果，由机器学习模型学习的映射不再捕捉服务数据的输入和目标之间的关系。</p></blockquote><p id="cd5f" class="pw-post-body-paragraph ma mb it mc b md nl kd mf mg nm kg mi mj nn ml mm mn no mp mq mr np mt mu mv im bi translated">例如，考虑一个天气预测模型，该模型被训练为使用一组不同的输入特征来预测温度和湿度。随着时间的推移，输入要素和目标变量之间的关系可能会由于各种因素而发生变化，例如，其中一个因素可能是气候变化，这是一个很难捕捉到一个变量中的因素，但仍然会影响输入要素和目标变量之间的关系。由于这个原因，我们最终会在模型学习到的关系和模型要预测的传入数据流中的实际关系之间产生差异。这种变化归功于<strong class="mc jd">的动态环境</strong>。<strong class="mc jd"> </strong>最终，这导致了一个对温度和湿度预测能力低的无能模型。</p><h1 id="76df" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">如果模型恶化，这种情况会多快发生？</h1><p id="fb27" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">既然我们已经讨论了不同类型的漂移，现在让我们来看看漂移随时间出现的不同速率。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/0d81db6e65efc180fad310cfd72206cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TT6zGzbonaJObgAXHRwz_w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:<a class="ae lh" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank">undraw.co</a></p></figure><ul class=""><li id="7f3b" class="od oe it mc b md mw mg mx mj of mn og mr oh mv oi oj ok ol bi translated"><strong class="mc jd">突发</strong>:漂移可能由于不可预见的情况而突然发生，通常由外部事件触发。新冠肺炎病毒的爆发导致了电子商务消费者行为的突然改变，这可以被看作是突然漂移的一个例子。</li><li id="6dd2" class="od oe it mc b md om mg on mj oo mn op mr oq mv oi oj ok ol bi translated"><strong class="mc jd">渐进性:</strong>这种类型的漂移需要更长的时间才能发生，而且通常是很自然的事情。季节性可能是逐渐漂移的一个例子。尽管复杂的时间序列模型确实考虑了季节性对模型性能的影响。如果不予考虑，受季节性影响的模型的预测能力会随着时间的推移而下降。</li><li id="56ac" class="od oe it mc b md om mg on mj oo mn op mr oq mv oi oj ok ol bi translated"><strong class="mc jd">循环:</strong>循环漂移周期性地发生，通常发生在一年中的特定时间。例如，在黑色星期五或圣诞节前后，消费者行为可能会有所不同，表现为对消费品需求的增加。由于这些事件的重复发生，可以训练某些模型来迎合这些时期周围增加的需求。</li></ul><h1 id="b0d9" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">检测模型漂移</h1><p id="55ae" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">考虑到不同类型的模型漂移以及它们发生的不同速率，如何检测模型质量的恶化？</p><p id="779d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这可以通过监控生产中模型的性能指标来实现。很明显，对吧？通常，模型的性能是使用部署前的测试集来评估的。到目前为止，我们所发现的模型漂移突出了在生产过程中持续监控模型对输入数据流的性能的重要性。</p><p id="c8d8" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在二进制分类环境中，随时间监控的相关指标是<strong class="mc jd"> F 值</strong>。如果分数随着时间的推移而下降，那么这可能是漂移的明显信号。在无法获得基本事实的情况下，我们无法在预测值和实际值之间进行比较，因此我们需要依赖不同的测量方法。</p><p id="d37a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">由于漂移问题的性质，<strong class="mc jd">统计距离测量</strong>可用于量化分布之间的变化。一种常用的测试是<strong class="mc jd"> Kolmogorov-Smirnov (K-S)测试。</strong>该测试基于参考分布的累积分布和最近分布(在我们的例子中是训练和部署分布)之间的最大差异。该测试的零假设表明两个分布之间没有差异，并且零假设的拒绝可以被推断为模型漂移的指标。</p><p id="63c5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">此外，另一种用于识别漂移的流行距离测量是<strong class="mc jd">群体稳定性指数(PSI)。</strong>用于衡量变量分布随时间的变化。这一指标非常适合于监控人口特征的变化。</p><p id="4fbb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">存在各种不同的方法、度量和测试来检测漂移，例如<strong class="mc jd"> Z 分数</strong>、<strong class="mc jd">基于模型的方法、</strong>和<strong class="mc jd">自适应窗口</strong>。如果你想深入了解，我会在下面提到进一步阅读和研究的资料来源。</p><p id="7186" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">话虽如此，但需要强调的是，监控漂移不是一次性任务，而是一个迭代过程。它需要定期发生，因为服务数据通常是不断传入的数据流。因此，这是一个可以大大受益于自动化的过程，从而提高效率和快速检测漂移。</p><h1 id="775a" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">模型漂移补救措施</h1><p id="e8ae" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">既然我们已经走了这么远。是时候解决一个至关重要的问题了，即纠正模型漂移的问题。可以采取两套方法，一套是预防措施，确保问题不会在一开始就发生；另一套是临时补救措施，在理想情况下，在问题失控之前解决问题。</p><p id="23eb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">预防模型漂移的方法需要使用<strong class="mc jd">在线学习。</strong>在线学习是一种模型训练方法，通过实时数据流不断更新模型。这种方法对于防止模型漂移非常有效。然而，实现实时学习是一项复杂的任务，需要专业知识。</p><p id="ec0d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在现有的一系列补救措施中，最直接的方法是<strong class="mc jd">在其性能下降到预先确定的阈值以下时，定期重新训练</strong>模型。当观察到漂移时，应该用最近的数据重新训练模型。另一种方法是<strong class="mc jd">定期更新</strong>一个模型。这是一种更有效的方法，其中不是完全丢弃不合适的模型并重新训练新的模型，而是将现有状态用作拟合过程的起点，该拟合过程使用最新数据的样本来更新模型拟合。然而，这种方法并不适用于所有的机器学习算法，因为它最适合于依赖权重或系数进行预测的算法，如回归算法和神经网络。</p><p id="8090" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">另一种方法利用<strong class="mc jd">集成学习</strong>技术，其中多个模型的集成用于进行组合预测。这种组合预测通常使用每个模型的单独预测的加权平均值来计算。这里的权重反映了每个模型在最近数据上的表现。</p><p id="1bec" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">总之，其他方法如<strong class="mc jd">实例选择</strong>和<strong class="mc jd">特征删除</strong>也可用于解决模型漂移。我会在下面链接更多的资源给你。</p><h1 id="582f" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">结论</h1><p id="1045" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">总之，我们已经绘制出了存在的两种主要漂移类型，并揭示了漂移可能发生的速率。我们还提到了不同的监控技术、预防措施和补救措施。您还可以在下一节找到更多资源。</p><p id="62e3" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们在这篇文章的开头指出，我们的世界是不断变化的，这也将是我们的结束语。由于模型漂移问题本身是动态的和不断变化的，用于识别和补救漂移的工具和技术也随着时间的推移而变化，并且很可能演变。出于这个原因，有越来越多的研究旨在完善我们对不同环境下模型漂移和补救措施的理解。</p><h2 id="085a" class="nq lj it bd lk nr ns dn lo nt nu dp ls mj nv nw lu mn nx ny lw mr nz oa ly iz bi translated"><strong class="ak">延伸阅读</strong></h2><ul class=""><li id="cc25" class="od oe it mc b md me mg mh mj or mn os mr ot mv oi oj ok ol bi translated"><a class="ae lh" href="https://medium.com/datalab-log/measuring-the-statistical-similarity-between-two-samples-using-jensen-shannon-and-kullback-leibler-8d05af514b15" rel="noopener">使用 Jensen-Shannon 和 Kullback Leibler 测量两个样本之间的统计相似性</a></li><li id="83c2" class="od oe it mc b md om mg on mj oo mn op mr oq mv oi oj ok ol bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Wasserstein_metric" rel="noopener ugc nofollow" target="_blank">瓦瑟斯坦公制</a></li></ul><div class="ou ov gp gr ow ox"><a href="https://www.arangodb.com/2020/11/arangoml-part-4-detecting-covariate-shift-in-datasets/" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd jd gy z fp pc fr fs pd fu fw jc bi translated">ArangoML 第 4 部分:检测数据集中的协变量变化</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">本文是介绍 ArangoML 并展示其对机器学习的好处的系列文章中的第四篇…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">www.arangodb.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl lb ox"/></div></div></a></div><ul class=""><li id="434d" class="od oe it mc b md mw mg mx mj of mn og mr oh mv oi oj ok ol bi translated"><a class="ae lh" href="https://arxiv.org/abs/1010.4784" rel="noopener ugc nofollow" target="_blank">概念漂移下的学习:概述</a></li><li id="ffe9" class="od oe it mc b md om mg on mj oo mn op mr oq mv oi oj ok ol bi translated"><a class="ae lh" href="https://arxiv.org/abs/1704.00362" rel="noopener ugc nofollow" target="_blank">理解概念漂移</a></li><li id="c60f" class="od oe it mc b md om mg on mj oo mn op mr oq mv oi oj ok ol bi translated"><a class="ae lh" href="https://link.springer.com/article/10.1007/s10994-019-05835-w" rel="noopener ugc nofollow" target="_blank">通过模型重用处理概念漂移</a></li></ul><h2 id="b16d" class="nq lj it bd lk nr ns dn lo nt nu dp ls mj nv nw lu mn nx ny lw mr nz oa ly iz bi translated">参考</h2><p id="9e11" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">[1]阿克曼，s .，法奇，e .，拉兹，o .，扎尔马诺维奇，m .，&amp;杜贝，P. (2020)。检测随时间影响机器学习模型性能的数据漂移和异常值。</p><p id="31ae" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">[2]黄，j .，格雷特顿，a .，博格瓦尔特，k .，舍尔科夫，b .，&amp;斯莫拉，A. (2006 年)。用未标记数据校正样本选择偏差。</p><p id="ec07" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">[3] <a class="ae lh" href="https://pkghosh.wordpress.com/2020/02/24/model-drift-detection-with-kolmogorov-smirnov-statistic-on-spark/" rel="noopener ugc nofollow" target="_blank">利用火花上的 Kolmogorov Smirnov 统计量进行模型漂移检测</a>。</p><p id="0a1e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">[4]阿列克谢·齐巴尔。(2004).概念漂移的问题:定义和相关工作。</p></div></div>    
</body>
</html>