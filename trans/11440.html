<html>
<head>
<title>11 Tricks to Master Values Sorting in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">掌握熊猫价值排序的 11 个技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/11-tricks-to-master-values-sorting-in-pandas-7f2cfbf19730?source=collection_archive---------13-----------------------#2021-11-10">https://towardsdatascience.com/11-tricks-to-master-values-sorting-in-pandas-7f2cfbf19730?source=collection_archive---------13-----------------------#2021-11-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2ec7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有效使用 Pandas sort_value()的实践教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/77615908139abac6d5f4db8696384a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1aKZwamtua7PxwWMEL67ig.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@uxindo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> UX 印尼</a>在<a class="ae ky" href="https://unsplash.com/s/photos/sorting?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><blockquote class="kz la lb"><p id="c6b0" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">数据排序是将数据按某种有意义的顺序排列，使其更容易理解、分析或可视化的过程。[1]</p></blockquote><p id="1cf3" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">数据排序是数据分析中最常见和最基本的过程之一。Pandas 有一个内置的方法<code class="fe mc md me mf b">sort_values()</code>来根据给定的标签对数据进行排序。该方法本身使用起来相当简单，但在实践中，您可能会遇到各种排序问题，例如，缺少值、特殊字符、自定义标签(例如，t 恤尺寸<strong class="lf iu"> XS </strong>、<strong class="lf iu"> S </strong>、<strong class="lf iu"> M </strong>、<strong class="lf iu"> L </strong>、<strong class="lf iu"> XL </strong>等)。</p><p id="eb55" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">在本文中，我们将通过一些实践教程来探索熊猫<code class="fe mc md me mf b">sort_values()</code>的不同用例。本文组织如下:</p><ol class=""><li id="395e" class="mg mh it lf b lg lh lj lk lz mi ma mj mb mk ly ml mm mn mo bi translated">对系列进行排序</li><li id="e765" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">按单列对数据帧进行排序</li><li id="be91" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">按多列对数据帧进行排序</li><li id="5129" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">排序前应用转换</li><li id="be23" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">对多列应用转换</li><li id="521b" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">处理自定义排序</li><li id="604f" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">处理缺失值</li><li id="82bf" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">就地排序值</li><li id="9826" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">忽略带有<code class="fe mc md me mf b">ignore_index=True</code>的索引</li><li id="2072" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">按行对数据帧进行排序</li><li id="02d6" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly ml mm mn mo bi translated">选择不同的排序算法</li></ol><blockquote class="mu"><p id="9a88" class="mv mw it bd mx my mz na nb nc nd ly dk translated"><em class="ne">请查看</em> <a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/040-pandas-sort_values/pandas-sort_values.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="ne">笔记本</em> </a> <em class="ne">获取源代码。更多教程可从</em><a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank"><em class="ne">Github Repo</em></a><em class="ne">获取。</em></p></blockquote><p id="8ed9" class="pw-post-body-paragraph lc ld it lf b lg nf ju li lj ng jx ll lz nh lo lp ma ni ls lt mb nj lw lx ly im bi translated">为了演示，让我们创建一个数据帧:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="a3ce" class="no np it mf b gy nq nr l ns nt">df = pd.DataFrame({<br/>    'product': ['keyboard', 'mouse', 'desk', 'monitor', 'chair'],<br/>    'category': ['C', 'C', 'O', 'C', 'O'],<br/>    'year': [2002, 2002, 2005, 2001, 2003],<br/>    'cost': ['$52', '$24', '$250', '$500', '$150'],<br/>    'promotion_time': ['20hr', '30hr', '20hr', '20hr', '2hr'],<br/>})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/1b190c16bd400eb66cc3920dc5d979e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lk1xNxvAvgnal7ZilD4C6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="2c3a" class="oc np it bd od oe of og oh oi oj ok ol jz om ka on kc oo kd op kf oq kg or os bi translated">1.对系列进行排序</h1><p id="4a30" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated"><code class="fe mc md me mf b">sort_values()</code>最简单的用法就是对一个数列进行排序。例如，让我们对“<strong class="lf iu">年”</strong>列的值进行排序:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="9709" class="no np it mf b gy nq nr l ns nt">df['<strong class="mf iu">year</strong>'].sort_values()</span><span id="1547" class="no np it mf b gy oy nr l ns nt">3    2001<br/>0    2002<br/>1    2002<br/>4    2003<br/>2    2005<br/>Name: year, dtype: int64</span></pre><p id="4a43" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><code class="fe mc md me mf b">df['year']</code>将“<strong class="lf iu">年</strong>”列作为一个序列返回，<code class="fe mc md me mf b">sort_values()</code>用于对值进行排序。默认情况下，<code class="fe mc md me mf b">sort_values()</code>返回的输出是升序的。我们可以将<code class="fe mc md me mf b">ascending</code>参数设置为<code class="fe mc md me mf b">False</code>来获得降序结果。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="9aba" class="no np it mf b gy nq nr l ns nt">df['year'].sort_values(<strong class="mf iu">ascending=False</strong>)</span><span id="bf27" class="no np it mf b gy oy nr l ns nt">2    2005<br/>4    2003<br/>0    2002<br/>1    2002<br/>3    2001<br/>Name: year, dtype: int64</span></pre><h1 id="171b" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">2.按单列对数据帧进行排序</h1><p id="e44d" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">要根据单个列中的值对 DataFrame 进行排序，需要传递该列的名称。例如，让我们按“<strong class="lf iu">年</strong>”列对数据集进行排序</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="ae45" class="no np it mf b gy nq nr l ns nt">df.sort_values(<strong class="mf iu">'year'</strong>)<br/># same as df.sort_values(<strong class="mf iu">by='year'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/6a7a95af97abe9fd9c33b28b2c52107c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJkYlTO-uYLFpO0S64Be0w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫按单个列对 _values()排序(图片按作者)</p></figure><p id="ea71" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">默认情况下，该方法将返回<strong class="lf iu">一个按升序排序的新数据帧</strong>，并且<strong class="lf iu">不会修改原始数据帧</strong>。</p><p id="7856" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们还可以使用<code class="fe mc md me mf b">ascending</code>参数来指定我们的偏好，例如将它设置为<code class="fe mc md me mf b">False</code>来获得降序结果。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="a979" class="no np it mf b gy nq nr l ns nt">df.sort_values('year', <strong class="mf iu">ascending=False</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/8a87522b02b39a37f294175b5ab6d052.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYxIMRSCQGPMniGyn9lMbg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫按单个列对 _values()排序(图片按作者)</p></figure><h1 id="2eaf" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">3.按多列对数据帧进行排序</h1><p id="d9ce" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">有时，我们需要按多列对数据帧进行排序。熊猫<code class="fe mc md me mf b">sort_values()</code>非常简单，因为第一个参数<code class="fe mc md me mf b">by</code>接受一个列表作为输入:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="4556" class="no np it mf b gy nq nr l ns nt">df.sort_values(<strong class="mf iu">['category', 'year']</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/452226d16dec053533821d708c5a602b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7V6a4RJHdjNh-wT8fyFqvQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫按多列对 _values()排序(图片按作者)</p></figure><p id="f2b7" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">默认情况下，它按升序对多列进行排序。<code class="fe mc md me mf b">ascending</code>参数接受一个布尔值列表，每个值对应一列。因此，我们也可以指定我们的偏好如下:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="af73" class="no np it mf b gy nq nr l ns nt">df.sort_values(<strong class="mf iu">['category', 'year'], ascending=[True, False]</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/f2dd3ccfd8de4775dbd5360c27cb0e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FYBkeisv4aR5CjWcO8Ca2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫按多列对 _values()排序(图片按作者)</p></figure><h1 id="8ab2" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">4.排序前应用转换</h1><p id="3eb5" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">有时，您的数据不能像预期的那样正确排序，例如“<strong class="lf iu">成本</strong>列中的符号<code class="fe mc md me mf b">$</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/acb7c0921cf6942b29654ebd6bdbcb1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMyBA2p01z-2ieJUTQTmfA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫 sort_values()带变换(图片由作者提供)</p></figure><p id="616f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">问题是，如果我们调用这个方法，我们将得到按字符串而不是数字排序的结果。</p><p id="f842" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">Pandas <code class="fe mc md me mf b">sort_values()</code>提供了一个<code class="fe mc md me mf b">key</code>参数，它允许我们在排序之前传递一个自定义函数来转换值。让我们创建一个 lambda 函数来删除<code class="fe mc md me mf b">$</code>并将剩余的字符串转换成一个数字:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="32b2" class="no np it mf b gy nq nr l ns nt">df.sort_values(<br/>    'cost', <br/>    <strong class="mf iu">key=lambda val: val.str.replace('$', '').astype('float64')</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/32d54faaed0a7f624fbb340979e7320b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*4xYnSfFsRQl8SdENRu1hKw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫 sort_values()带变换(图片由作者提供)</p></figure><h1 id="bf35" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">5.对多列应用转换</h1><p id="7ca3" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">在 Pandas <code class="fe mc md me mf b">sort_values()</code>中，<code class="fe mc md me mf b">key</code>功能适用于每个排序列。我们来看看如何按“<strong class="lf iu">年</strong>”、“<strong class="lf iu">促销 _ 时间</strong>”、“<strong class="lf iu">成本【T31”)对数据帧进行排序。</strong></p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="5a83" class="no np it mf b gy nq nr l ns nt">df = pd.DataFrame({<br/>    'product': ['keyboard', 'mouse', 'desk', 'monitor', 'chair'],<br/>    'category': ['C', 'C', 'O', 'C', 'O'],<br/>    <strong class="mf iu">'year': [2002, 2002, 2005, 2001, 2003],</strong><br/>    <strong class="mf iu">'cost': ['$52', '$24', '$250', '$500', '$150'],</strong><br/>    <strong class="mf iu">'promotion_time': ['20hr', '30hr', '20hr', '20hr', '2hr'],</strong><br/>})</span></pre><p id="37f8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">注意“<strong class="lf iu">成本</strong>”和“<strong class="lf iu">促销 _ 时间</strong>”都是字符串值，需要转换，<strong class="lf iu">年</strong>的值也可以。让我们继续创建一个常规函数<code class="fe mc md me mf b">sort_by_cost_time()</code>:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="643d" class="no np it mf b gy nq nr l ns nt">def <strong class="mf iu">sort_by_cost_time</strong>(x):<br/>    if x.name == 'cost':<br/>        return x.str.replace('$', '').astype('float64')<br/>    elif x.name == 'promotion_time':<br/>        return x.str.replace('hr', '').astype('int')<br/>    else:<br/>        return x<br/></span><span id="a4fe" class="no np it mf b gy oy nr l ns nt"># Pass the function to the key argument<br/>df.sort_values(<br/>   <strong class="mf iu">['year', 'promotion_time', 'cost'], </strong><br/>   <strong class="mf iu">key=sort_by_cost_time<br/></strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/3ef5fd463bd3ccb748528dfb95322b6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIhDWInlr12IzXcCj66jOw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫 sort_values()带变换(图片由作者提供)</p></figure><p id="bf90" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><code class="fe mc md me mf b">sort_by_cost_time()</code>函数检查列名并应用相应的转换。<code class="fe mc md me mf b">else</code>块适用于任何其他列，并返回原始数据。</p><h1 id="ccce" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">6.处理自定义排序</h1><p id="aa07" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">Pandas <code class="fe mc md me mf b">sort_values()</code>使用起来相当简单，但是它不能用于自定义排序，例如，</p><ul class=""><li id="9f90" class="mg mh it lf b lg lh lj lk lz mi ma mj mb mk ly pl mm mn mo bi translated">t 恤尺码:<code class="fe mc md me mf b">XS</code>、<code class="fe mc md me mf b">S</code>、<code class="fe mc md me mf b">M</code>、<code class="fe mc md me mf b">L</code>和<code class="fe mc md me mf b">XL</code></li><li id="7c8e" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly pl mm mn mo bi translated">月份:<code class="fe mc md me mf b">Jan</code>、<code class="fe mc md me mf b">Feb</code>、<code class="fe mc md me mf b">Mar</code>、<code class="fe mc md me mf b">Apr</code>、…。等等</li><li id="01c4" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly pl mm mn mo bi translated">星期几:<code class="fe mc md me mf b">Mon</code>、<code class="fe mc md me mf b">Tue</code>、<code class="fe mc md me mf b">Wed</code>、<code class="fe mc md me mf b">Thu</code>、<code class="fe mc md me mf b">Fri</code>、<code class="fe mc md me mf b">Sat</code>和<code class="fe mc md me mf b">Sun</code>。</li></ul><p id="f6ad" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们已经学习了使用<code class="fe mc md me mf b">key</code>参数的转换。我们当然可以用它来解决自定义排序问题，但是在处理大型数据集时，性能会非常糟糕。我们可以通过声明一个<code class="fe mc md me mf b">CategoricalDtype</code>来更有效地解决这个问题。让我们来看看这个例子:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="5f32" class="no np it mf b gy nq nr l ns nt">df = pd.DataFrame({<br/>    'cloth_id': [1001, 1002, 1003, 1004, 1005, 1006],<br/>    <strong class="mf iu">'size': ['S', 'XL', 'M', 'XS', 'L', 'S'],</strong><br/>})</span></pre><p id="d9c2" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">首先，让我们导入<code class="fe mc md me mf b">CategoricalDtype</code>。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="11b3" class="no np it mf b gy nq nr l ns nt">from pandas.api.types import <strong class="mf iu">CategoricalDtype</strong></span></pre><p id="76da" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">然后，创建一个自定义类别类型<code class="fe mc md me mf b">cat_size_order</code>,用</p><ul class=""><li id="0ace" class="mg mh it lf b lg lh lj lk lz mi ma mj mb mk ly pl mm mn mo bi translated">第一个参数设置为<code class="fe mc md me mf b">['XS', 'S', 'M', 'L', 'XL']</code>为布料尺寸的唯一值。</li><li id="c9ba" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly pl mm mn mo bi translated">第二个变量<code class="fe mc md me mf b">ordered=True</code>将被视为有序分类变量。</li></ul><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="64d2" class="no np it mf b gy nq nr l ns nt">cat_size_order = CategoricalDtype(<br/>    ['XS', 'S', 'M', 'L', 'XL'], <br/>    ordered=True<br/>)</span></pre><p id="6b06" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">之后，调用<code class="fe mc md me mf b">astype(cat_size_order)</code>将尺寸数据转换为自定义类别类型。通过运行<code class="fe mc md me mf b">df['size']</code>，我们可以看到<strong class="lf iu"> <em class="le">大小</em> </strong>列已经转换为带有顺序<code class="fe mc md me mf b">[XS &lt; S &lt; M &lt; L &lt; XL]</code>的类别类型。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="acb6" class="no np it mf b gy nq nr l ns nt">df['size'] = df['size']<strong class="mf iu">.astype(cat_size_order)</strong><br/>df['size']</span><span id="3e2b" class="no np it mf b gy oy nr l ns nt">0     S<br/>1    XL<br/>2     M<br/>3    XS<br/>4     L<br/>5     S<br/>Name: size, <strong class="mf iu">dtype: category</strong><br/><strong class="mf iu">Categories (5, object): [XS &lt; S &lt; M &lt; L &lt; XL]</strong></span></pre><p id="ccb4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">最后，我们可以调用<code class="fe mc md me mf b">sort_values('size')</code>对值进行排序。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="5082" class="no np it mf b gy nq nr l ns nt">df.<strong class="mf iu">sort_values('size')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/8787d538f34c23edf9275a712109a7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*2iWV_cuvJKstLFz3rPOJfw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义排序的 Pandas sort_values()</p></figure><p id="6447" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这里有一篇文章可以了解更多关于熊猫的自定义排序:</p><div class="pn po gp gr pp pq"><a rel="noopener follow" target="_blank" href="/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320"><div class="pr ab fo"><div class="ps ab pt cl cj pu"><h2 class="bd iu gy z fp pv fr fs pw fu fw is bi translated">如何对熊猫数据帧进行自定义排序</h2><div class="px l"><h3 class="bd b gy z fp pv fr fs pw fu fw dk translated">你应该知道的一些最有用的熊猫把戏</h3></div><div class="py l"><p class="bd b dl z fp pv fr fs pw fu fw dk translated">towardsdatascience.com</p></div></div><div class="pz l"><div class="qa l qb qc qd pz qe ks pq"/></div></div></a></div><h1 id="868f" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">7.处理缺失值</h1><p id="b6f4" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">在 Pandas 中，缺失值被赋予值<code class="fe mc md me mf b">NaN</code>，这是“不是一个数字”的缩写。当我们对值进行排序时，默认情况下，这些<code class="fe mc md me mf b">NaN</code>被放在所有其他有效值的后面。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="57b9" class="no np it mf b gy nq nr l ns nt">df = pd.DataFrame({<br/>    'id': [4, 2, 3, <strong class="mf iu">np.nan</strong>, 6, 5],<br/>    'name': ['A', 'B', 'C', 'D', 'E', 'F'],<br/>})</span><span id="19d4" class="no np it mf b gy oy nr l ns nt">df.sort_values('id')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/d292f973b9d3475944a27f314ffedcba.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*qGbo4dXzHM9CRMbIu1EZRg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pandas sort_values()处理缺失值(图片由作者提供)</p></figure><p id="68c7" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果我们想将它们放在开头，我们可以将<code class="fe mc md me mf b">na_position</code>参数设置为<code class="fe mc md me mf b">First</code>。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="49be" class="no np it mf b gy nq nr l ns nt">df.sort_values('id', <strong class="mf iu">na_position='first'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/f06784b7dc5d65b4bd0465160fba3f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*Hj2X7r1v5dwCpuQgUIcj6w.png"/></div></figure><p id="b47c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">或者，我们可以考虑删除或替换丢失的值。</p><div class="pn po gp gr pp pq"><a rel="noopener follow" target="_blank" href="/working-with-missing-values-in-pandas-5da45d16e74"><div class="pr ab fo"><div class="ps ab pt cl cj pu"><h2 class="bd iu gy z fp pv fr fs pw fu fw is bi translated">处理熊猫中缺失的值</h2><div class="px l"><h3 class="bd b gy z fp pv fr fs pw fu fw dk translated">关于 Pandas 中缺失值以及如何使用内置方法处理它们的教程</h3></div><div class="py l"><p class="bd b dl z fp pv fr fs pw fu fw dk translated">towardsdatascience.com</p></div></div><div class="pz l"><div class="qh l qb qc qd pz qe ks pq"/></div></div></a></div><h1 id="7d2d" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">8.就地排序值</h1><p id="aad5" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">重要的是要记住，默认情况下，<code class="fe mc md me mf b">sort_values()</code>将返回一个新的数据帧，而原始数据帧保持不变。为了避免创建新的数据帧，可以将参数<code class="fe mc md me mf b">inplace</code>设置为<code class="fe mc md me mf b">True</code>。</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="cb62" class="no np it mf b gy nq nr l ns nt">df.sort_values('id', <strong class="mf iu">inplace=True</strong>)</span></pre><p id="ae66" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">注意，使用<code class="fe mc md me mf b">inplace=True</code>，调用将返回<code class="fe mc md me mf b">None</code>。</p><h1 id="dee2" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">9.用<code class="fe mc md me mf b">ignore_index=True</code>忽略索引</h1><p id="5998" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">您可能已经注意到，在结果中，每个排序的行的索引保持不变。如果您想忽略原始索引并用<code class="fe mc md me mf b">0</code>到<code class="fe mc md me mf b">n-1</code>标记结果(有序索引)，您可以将参数<code class="fe mc md me mf b">ignore_index</code>设置为<code class="fe mc md me mf b">True</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qi"><img src="../Images/de3663d9675a37723dee75a0458e8a2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vUa3A7r1ARzv-a_XRc1_Gw.png"/></div></div></figure><h1 id="af7f" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">10.按行对数据帧进行排序</h1><p id="75d4" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">熊猫<code class="fe mc md me mf b">sort_values()</code>支持<code class="fe mc md me mf b">axis</code>的说法。默认为<code class="fe mc md me mf b">0</code>，即按列对值进行排序。在某些情况下，您可能希望按行而不是按列对数据帧进行排序。为此，我们可以将<code class="fe mc md me mf b">axis</code>参数设置为<code class="fe mc md me mf b">1</code>:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="6050" class="no np it mf b gy nq nr l ns nt">df = pd.DataFrame({<br/>    'Tom': [70, 67, 90, 50],<br/>    'Jacky': [90, 85, 76, 70],<br/>    'Lucy': [56, 60, 75, 77]<br/>}, index=['Math', 'Chemistry', 'Physics', 'Art'])</span><span id="5abc" class="no np it mf b gy oy nr l ns nt">df.sort_values(<strong class="mf iu">'Chemistry'</strong>, <strong class="mf iu">axis=1</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qj"><img src="../Images/547fa0e662316a2255cab2399bdf940c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2B-2OP6Pk_hEsCAVBEH-5w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫按行排序 _ 值()</p></figure><h1 id="d8a1" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">11.选择不同的排序算法</h1><p id="7195" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">我们应该知道 Pandas <code class="fe mc md me mf b">sort_values()</code>允许我们选择不同的排序算法。根据<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sort_values.html" rel="noopener ugc nofollow" target="_blank">官方 API</a>【2】，默认算法为<strong class="lf iu"> <em class="le">快速排序</em> </strong>。而其他可用的算法有<strong class="lf iu"><em class="le">【merge sort】</em></strong><strong class="lf iu"><em class="le">heap sort</em></strong><strong class="lf iu"><em class="le">stable</em></strong>。要改变这一点，可以将算法名传递给参数<code class="fe mc md me mf b">kind</code>:</p><pre class="kj kk kl km gt nk mf nl nm aw nn bi"><span id="3aa5" class="no np it mf b gy nq nr l ns nt">df.sort_values('Chemistry', <strong class="mf iu">kind='heapsort'</strong>, axis=1)</span></pre><blockquote class="kz la lb"><p id="2a47" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">注意:对于数据帧，此选项仅在对单列或单行排序时适用。[2]</p></blockquote><h1 id="e91c" class="oc np it bd od oe oz og oh oi pa ok ol jz pb ka on kc pc kd op kf pd kg or os bi translated">结论</h1><p id="0d74" class="pw-post-body-paragraph lc ld it lf b lg ot ju li lj ou jx ll lz ov lo lp ma ow ls lt mb ox lw lx ly im bi translated">在本文中，我们已经讨论了 11 个使用熊猫<code class="fe mc md me mf b">sort_values()</code>方法对值进行排序的用例。它非常方便，是探索性数据分析和数据预处理中最受欢迎的方法之一。数据排序是数据科学中一项重要的基本技能。我希望你喜欢这篇文章，并学到一些新的有用的东西。</p><p id="763c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">感谢阅读。请查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/040-pandas-sort_values/pandas-sort_values.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>获取源代码，如果你对机器学习的实用方面感兴趣，请继续关注。更多教程可从<a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank"> Github Repo </a>获得。</p><h2 id="bea3" class="no np it bd od qk ql dn oh qm qn dp ol lz qo qp on ma qq qr op mb qs qt or qu bi translated">参考资料:</h2><ul class=""><li id="f69b" class="mg mh it lf b lg ot lj ou lz qv ma qw mb qx ly pl mm mn mo bi translated">[1] <a class="ae ky" href="https://www.displayr.com/what-is-data-sorting/" rel="noopener ugc nofollow" target="_blank">什么是数据排序？</a></li><li id="baca" class="mg mh it lf b lg mp lj mq lz mr ma ms mb mt ly pl mm mn mo bi translated">[2] <a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sort_values.html" rel="noopener ugc nofollow" target="_blank">熊猫 API 文档 sort_values() </a></li></ul></div></div>    
</body>
</html>