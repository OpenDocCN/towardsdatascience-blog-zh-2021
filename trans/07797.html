<html>
<head>
<title>Modernize Your Sinful Python Code with Beautiful Type Hints</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用漂亮的类型提示使你罪恶的Python代码现代化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1?source=collection_archive---------7-----------------------#2021-07-17">https://towardsdatascience.com/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1?source=collection_archive---------7-----------------------#2021-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="520c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">成为拥有专业代码质量技能的顶级掠夺者</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/67068390919a119df1f0926edababc27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E_WcG0jQ6b_b8PKW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">戴维·克洛德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="3eef" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">您的旅程概述</h1><ol class=""><li id="7c2a" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><a class="ae ky" href="#d5ae" rel="noopener ugc nofollow">设置舞台</a></li><li id="eadd" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#e8cf" rel="noopener ugc nofollow">了解动态类型和静态类型</a></li><li id="284b" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#507c" rel="noopener ugc nofollow">变量的Python类型提示</a></li><li id="886a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#b03b" rel="noopener ugc nofollow">用Mypy检查类型提示</a></li><li id="8039" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#6478" rel="noopener ugc nofollow">函数的Python类型提示</a></li><li id="7f7c" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#111d" rel="noopener ugc nofollow">如何添加列表作为类型提示</a></li><li id="470d" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#1653" rel="noopener ugc nofollow">给你的代码加电的五个令人敬畏的类型提示</a></li><li id="ca76" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#c7b3" rel="noopener ugc nofollow">为什么所有酷小孩都用Python 3.9+ </a></li><li id="9669" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#89a2" rel="noopener ugc nofollow">总结和进一步的资源</a></li></ol></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="d5ae" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">搭建舞台</h1><p id="b53e" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">在由Stack Overflow发起的<em class="nn"> 2020年开发者调查中，</em> Python在“<a class="ae ky" href="https://insights.stackoverflow.com/survey/2020#technology-most-loved-dreaded-and-wanted-languages-wanted" rel="noopener ugc nofollow" target="_blank">开发者想学的编程语言</a>”类别中拔得头筹。尽管如此，Python也有让支持者和批评者恼火的缺点。经常提到的一个缺点如下:</p><blockquote class="no"><p id="6f72" class="np nq it bd nr ns nt nu nv nw nx me dk translated"><em class="ny"> Python有</em> <strong class="ak"> <em class="ny">动态类型</em> </strong> <em class="ny">。这增加了调试时间，并使变量和函数的行为不可预测。</em></p></blockquote><p id="0f1b" class="pw-post-body-paragraph na nb it lt b lu nz ju nc lw oa jx nd ly ob nf ng ma oc ni nj mc od nl nm me im bi translated">尽管动态类型对于快速原型开发来说很方便，但是在大型项目中，它们可能会成为一种烦恼。这就是类型提示发挥作用的地方:自从Python 3.5发布以来，可以通过编写<strong class="lt iu">类型提示来模拟Python中的<strong class="lt iu">静态类型</strong>！❤️ </strong></p><p id="b660" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">编写类型提示的另一个好处是它们可以提高代码质量。当我说代码质量时，大多数人会想到<strong class="lt iu">描述性变量名</strong>和<strong class="lt iu">写得很好的文档字符串</strong>。编写类型提示是提高Python代码质量的一个新方法。</p><blockquote class="no"><p id="0072" class="np nq it bd nr ns nt nu nv nw nx me dk translated">在本文中，我将向您展示如何使用类型提示来增强您的Python代码！</p></blockquote><p id="7299" class="pw-post-body-paragraph na nb it lt b lu nz ju nc lw oa jx nd ly ob nf ng ma oc ni nj mc od nl nm me im bi translated"><strong class="lt iu">目标:</strong>我会教你Python中类型提示的基础知识。完成基础知识之后，我将向您展示五个更棒的类型提示来增强您的Python代码。最后，我将解释随着Python 3.9的引入，类型提示是如何变得不那么麻烦的。</p><p id="7206" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated"><strong class="lt iu">先决条件:</strong>你应该熟悉Python的基础知识。确保您运行的Python版本高于Python 3.5。对于<em class="nn">动态类型</em>、<em class="nn">静态类型</em>或<em class="nn">类型提示</em>没有必要的先决条件。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="e8cf" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">理解动态类型和静态类型</h1><p id="77cf" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">首先我要解释一下术语<strong class="lt iu">动态类型</strong>和<strong class="lt iu">静态类型。</strong>在Python中，您可以在整个程序中任意多次更改变量的数据类型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Python中，变量的类型可以动态改变。</p></figure><p id="e095" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">请注意上面的代码片段:</p><ul class=""><li id="391d" class="lr ls it lt b lu oe lw of ly ol ma om mc on me oo mg mh mi bi translated">我在定义变量<code class="fe op oq or os b">my_variable</code>时没有指定它的数据类型。</li><li id="2af2" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oo mg mh mi bi translated">我可以在整个Python程序中改变变量<code class="fe op oq or os b">my_variable</code>的数据类型。</li></ul><blockquote class="no"><p id="4f3b" class="np nq it bd nr ns ot ou ov ow ox me dk translated">简而言之，Python有<strong class="ak">动态类型</strong>。</p></blockquote><p id="44ba" class="pw-post-body-paragraph na nb it lt b lu nz ju nc lw oa jx nd ly ob nf ng ma oc ni nj mc od nl nm me im bi translated">在一些编程语言(例如Java)中，你需要在创建时指定变量的数据类型。此外，变量的数据类型在程序的后期不能改变。我们说这样的编程语言有<strong class="lt iu">静态类型</strong>。</p><p id="551d" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">用静态类型的语言编程可能看起来是一种负担。然而，用静态类型调试编程语言通常不那么麻烦。使用静态类型，您可以更早地发现错误并以最小的努力修复它们。</p><p id="ffa3" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">简单来说:</p><ul class=""><li id="be8f" class="lr ls it lt b lu oe lw of ly ol ma om mc on me oo mg mh mi bi translated">这是你调试动态类型时的表情😢</li><li id="3089" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oo mg mh mi bi translated">这是你调试静态类型时的表情😎</li></ul><p id="ce65" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">我将向您展示如何使用类型提示在Python中模拟静态类型！</p><blockquote class="oy oz pa"><p id="7eca" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">趣闻:</strong>动态分型有时也叫<strong class="lt iu">鸭子分型</strong>。术语来源于众所周知的说法:“如果它走路像<strong class="lt iu">鸭</strong>，叫声像<strong class="lt iu">鸭</strong>，那么它一定是<strong class="lt iu">鸭。</strong></p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="507c" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">变量的Python类型提示</h1><p id="7f5a" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">我将从以下类型提示的应用开始:</p><blockquote class="no"><p id="e594" class="np nq it bd nr ns nt nu nv nw nx me dk translated">类型提示允许您指定变量的数据类型。</p></blockquote><p id="29a8" class="pw-post-body-paragraph na nb it lt b lu nz ju nc lw oa jx nd ly ob nf ng ma oc ni nj mc od nl nm me im bi translated">因为代码片段比文字更有说服力，所以看一下下面的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">类型提示的一个简单例子。</p></figure><p id="8e17" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">借助类型提示的力量，我已经指定<code class="fe op oq or os b">my_variable</code>应该是一个整数。那还不算太糟！😃</p><p id="3803" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">对于类型提示，您也可以使用标准数据类型，如<code class="fe op oq or os b">float</code>、<code class="fe op oq or os b">bool</code>和<code class="fe op oq or os b">string</code> <strong class="lt iu"> </strong>。以下代码片段记录了汽车的一些有用特性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">各种数据类型的类型提示。</p></figure><p id="c6d0" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">如果您尝试在脚本中运行上面的代码片段，那么Python毫无怨言。一切看起来都很好！然而，这并不意味着Python会检查分配的类型是否正确。事实上，尝试运行以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">错误的类型提示。</p></figure><p id="5388" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">什么！？Python不会用错误的类型提示给出任何错误😧</p><p id="e9eb" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">这是因为Python虽然理解类型提示的语法，但根本不关心它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/fef81695900c03ba4025c954efa7d2d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RubdSGN45YN0aGBP"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@thetonik_co?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托尼克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="a18c" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">您将需要使用一个<strong class="lt iu">外部类型检查器</strong>来检查类型提示是否匹配所提供的变量<strong class="lt iu">。</strong>外部类型检查器<strong class="lt iu">通常是一个外部Python模块。我将向您展示如何使用<strong class="lt iu"> mypy </strong>模块<strong class="lt iu"> </strong>进行外部类型检查。放心吧，<strong class="lt iu"> mypy </strong>好用！</strong></p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="b03b" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">用Mypy检查类型提示</h1><p id="486c" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">mypy的一行描述如下:</p><blockquote class="no"><p id="bdfa" class="np nq it bd nr ns nt nu nv nw nx me dk translated">如果在代码中加入类型提示，mypy可以对代码进行类型检查，并找出常见的错误。</p></blockquote><p id="3c54" class="pw-post-body-paragraph na nb it lt b lu nz ju nc lw oa jx nd ly ob nf ng ma oc ni nj mc od nl nm me im bi translated">要安装<strong class="lt iu"> mypy </strong>，使用PIP(Python的包安装程序)命令:</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="1c76" class="pj la it os b gy pk pl l pm pn">pip install mypy</span></pre><p id="7e8a" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">如果这不起作用，则查看<a class="ae ky" href="https://mypy.readthedocs.io/en/stable/getting_started.html" rel="noopener ugc nofollow" target="_blank">文档</a>以获得安装帮助。使用以下代码行创建一个名为<code class="fe op oq or os b">simple_type_hint.py</code> <strong class="lt iu"> </strong>的文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单类型提示。</p></figure><p id="5dc5" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">打开你的终端，导航到你创建文件<code class="fe op oq or os b">simple_type_hint.py</code>的文件夹。然后运行命令:</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="5c84" class="pj la it os b gy pk pl l pm pn">python -m mypy simple_type_hint.py</span></pre><p id="8700" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">这将显示以下消息:</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="4825" class="pj la it os b gy pk pl l pm pn"><strong class="os iu">Success: no issues found in 1 source file</strong></span></pre><p id="65ae" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">看起来mypy对目前为止写的所有东西都很满意。我现在想故意破坏类型提示，看看会发生什么😈</p><p id="f02f" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">将下面一行代码添加到<code class="fe op oq or os b">simple_type_hint.py</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尝试中断到类型提示。</p></figure><p id="fc39" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">在上面的代码片段中，我用类型提示指定了<code class="fe op oq or os b">my_variable</code>应该是一个整数。尽管如此，我后来通过给<code class="fe op oq or os b">my_variable</code>赋值一个字符串来打破类型提示。</p><p id="3ec1" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">如果您将文件<code class="fe op oq or os b">simple_type_hint.py</code> <strong class="lt iu"> </strong>作为Python程序运行，那么不会像往常一样显示错误。但是，请尝试使用mypy命令:</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="efd0" class="pj la it os b gy pk pl l pm pn">python -m mypy simple_type_hint.py</span></pre><p id="6383" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">这应该会显示类似下面的消息:</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="c6ef" class="pj la it os b gy pk pl l pm pn">simple_type_hint.py:5: error: Incompatible types in assignment (expression has type “str”, variable has type “int”)</span><span id="10d7" class="pj la it os b gy po pl l pm pn">Found 1 error in 1 file (checked 1 source file)</span></pre><p id="46c6" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">与Python不同，mypy会检测出什么问题。上面的错误消息指定了行号(在我的例子中是5)和发生的具体问题。</p><h2 id="6ef0" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">有用！！！</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qa"><img src="../Images/8a05055768f3d6d581e04b68e9b92da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lJ7GyVupVQ-AsNXU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@brucemars?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布鲁斯·马尔斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6b51" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">有一个工作实例感觉很棒，不管多简单🔥</p><blockquote class="oy oz pa"><p id="a26c" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">有趣的事实:</strong>在mypy的GitHub页面上，有一个来自2019年的问题(问题#6740)建议mypy不要再把自己称为<strong class="lt iu">阿尔法软件</strong>。术语alpha软件是指处于预发布/早期版本阶段的软件。Python的创始人吉多·范·罗苏姆介入了讨论，澄清了一些事情:</p></blockquote><blockquote class="no"><p id="50a0" class="np nq it bd nr ns ot ou ov ow ox me dk translated">“我们在这里非常自嘲。我会毫不犹豫地称之为mypy产品质量，即超越测试版。”—范·罗森指南</p></blockquote><h1 id="6478" class="kz la it bd lb lc ld le lf lg lh li lj jz qb ka ll kc qc kd ln kf qd kg lp lq bi translated">函数的Python类型提示</h1><p id="f319" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">大多数Python程序都有大量的函数。我现在将向您展示如何使用函数的类型提示。</p><p id="007e" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">在一个名为<code class="fe op oq or os b">simple_function.py</code> <strong class="lt iu"> </strong>的空文件中，我编写了下面这个简单的函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个简单的函数检查整除2。</p></figure><p id="d16e" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">函数<code class="fe op oq or os b">both_divisible_by_two</code>接受两个整数作为输入。然后检查它们是否能被2整除。很简单，对吧？现在我给函数<code class="fe op oq or os b">both_divisible_by_two</code>添加类型提示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有类型提示的简单函数。</p></figure><p id="5835" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">请注意，只有<code class="fe op oq or os b">both_divisible_by_two</code>的第一行发生了变化:</p><ul class=""><li id="ca15" class="lr ls it lt b lu oe lw of ly ol ma om mc on me oo mg mh mi bi translated">我写了<code class="fe op oq or os b">a: int</code>和<code class="fe op oq or os b">b: int</code>来表示<code class="fe op oq or os b">both_divisible_by_two</code>的输入<code class="fe op oq or os b">a</code>和<code class="fe op oq or os b">b</code>应该是整数。</li><li id="11a1" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oo mg mh mi bi translated">为了表明<code class="fe op oq or os b">both_divisible_by_two</code>的输出是一个布尔值，我使用了语法<code class="fe op oq or os b">-&gt; bool</code>。</li></ul><p id="0a69" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">如果您现在运行通常的命令</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="8b76" class="pj la it os b gy pk pl l pm pn">python -m mypy simple_funciton.py</span></pre><p id="0b06" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">那么你应该得到令人满意的输出</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="d815" class="pj la it os b gy pk pl l pm pn"><strong class="os iu">Success: no issues found in 1 source file.</strong></span></pre><p id="15a6" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">看起来棒极了！如果您有意做出错误的类型提示，检查mypy是否会有反应总是一个很好的明智之举。为了验证这一点，我将<code class="fe op oq or os b">both_divisible_by_two</code> <strong class="lt iu"> </strong>修改如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出带有错误类型提示的简单函数。</p></figure><p id="7a9a" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">如果您再次运行该命令</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="d909" class="pj la it os b gy pk pl l pm pn">python -m mypy simple_funciton.py</span></pre><p id="f98a" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">那么您应该大致得到错误消息</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="32af" class="pj la it os b gy pk pl l pm pn">simple_function.py:4: error: Incompatible return value type (got "bool", expected "str")</span><span id="960b" class="pj la it os b gy po pl l pm pn">Found 1 error in 1 file (checked 1 source file)</span></pre><p id="b472" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">有用！😃</p><blockquote class="oy oz pa"><p id="bc95" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">提示:</strong>如果您在<strong class="lt iu"> </strong> <code class="fe op oq or os b">both_divisible_by_two</code>中将输出的类型提示更改为<code class="fe op oq or os b">int</code> <strong class="lt iu"> </strong>，那么mypy将不会给出错误。你明白为什么吗？这还得归功于Python中一个微妙的实现细节:布尔类<code class="fe op oq or os b">bool</code> <strong class="lt iu"> </strong>是整数类<strong class="lt iu"> </strong> <code class="fe op oq or os b">int</code> <strong class="lt iu"> </strong>下的一个子类</p><p id="a864" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><code class="fe op oq or os b">0 &lt;-&gt; False</code><strong class="lt iu"/><strong class="lt iu"/><code class="fe op oq or os b">1 &lt;-&gt; True</code>。</p><p id="018a" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated">因此，在Python中，布尔值“是”整数。当您使用类型提示时，请记住这个细节！</p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="111d" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">如何将列表添加为类型提示</h1><p id="c735" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">我们已经看到了如何给函数添加基本类型提示。如何输入变量应该是列表的提示？不幸的是，显而易见的方法(编写<code class="fe op oq or os b">list</code>)在Python版本3.8和更低版本中无效😒</p><p id="9ddd" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">您实际上需要进入内置模块<code class="fe op oq or os b">typing</code> <strong class="lt iu"> </strong>来获取列表的类型提示。让我打开一个名为<code class="fe op oq or os b">list_type_hints.py</code> <strong class="lt iu"> </strong>的新文件，并以下面一行开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从类型模块导入列表类型提示。</p></figure><p id="a5da" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">注意<code class="fe op oq or os b">List</code>是大写的。创建一个名为<code class="fe op oq or os b">append_element</code> <strong class="lt iu"> </strong>的函数，将一个值追加到给定的列表中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个简单的函数，向列表追加一个值。</p></figure><p id="3d6e" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">到目前为止，一切顺利。如果为<code class="fe op oq or os b">data</code>参数传递一个字典，函数<code class="fe op oq or os b">append_element</code>将会崩溃。为确保这一点，您可以添加如下类型提示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有列表类型提示的简单函数。</p></figure><p id="9d36" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">如果用命令对文件<code class="fe op oq or os b">list_type_hints.py</code> <strong class="lt iu"> </strong>运行mypy</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="e9d4" class="pj la it os b gy pk pl l pm pn">python -m mypy list_type_hints.py</span></pre><p id="33d7" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">然后mypy报告以下内容:</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="dbcd" class="pj la it os b gy pk pl l pm pn">list_type_hints.py:5: error: “append” of “list” does not return a value</span><span id="bf00" class="pj la it os b gy po pl l pm pn">Found 1 error in 1 file (checked 1 source file)</span></pre><p id="e527" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">这是什么？好像mypy在我们的代码中发现了一个错误😱</p><p id="f1b2" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">有什么问题？在继续之前仔细检查mypy的回答。</p><p id="95a6" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated"><strong class="lt iu">解决方案:</strong>列表方法<code class="fe op oq or os b">append</code> <strong class="lt iu"> </strong>就地修改列表但返回<code class="fe op oq or os b">None</code>。因此有了这个声明</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="982a" class="pj la it os b gy pk pl l pm pn">return data.append(value)</span></pre><p id="2481" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">将始终返回与</p><pre class="kj kk kl km gt pf os pg ph aw pi bi"><span id="56a8" class="pj la it os b gy pk pl l pm pn">return None</span></pre><p id="c15e" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">要修复代码，您应该进行以下简单的编辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">修复了简单函数。</p></figure><p id="9131" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">马上发现问题，太牛逼了！这里，类型提示发现了一个通常的Python解释器不会提醒您的错误😎</p><p id="6129" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">类型提示还有一个额外的好处，那就是它们可以更好地记录代码。现在在<code class="fe op oq or os b">append_element</code>中可以清楚地看到<code class="fe op oq or os b">data</code>应该是一个列表。我也可以使用比<code class="fe op oq or os b">data</code>更具描述性的变量名。描述性变量名和类型提示都可以提高代码的质量。</p><p id="ba86" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">到目前为止，传入<code class="fe op oq or os b">append_element</code>的列表中的元素可以是任何类型。例如，它可以是整数列表、字符串列表或由整数和字符串组成的列表。如果我只想接受一个整数列表，那么我可以如下修改代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">指定列表中元素类型的类型提示。</p></figure><p id="e9a1" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">注意，我把类型提示<code class="fe op oq or os b">List</code>换成了更具体的类型提示<code class="fe op oq or os b">List[int]</code>。现在列表输入和列表输出只能包含整数！</p><blockquote class="oy oz pa"><p id="75e3" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">提示:</strong>在<code class="fe op oq or os b">typing</code>模块中，还有字典<code class="fe op oq or os b">Dict</code>和元组<code class="fe op oq or os b">Tuple</code>等其他容器数据类型。我邀请你在需要的时候看看这些。</p></blockquote><h1 id="1653" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">增强你的代码的五个令人敬畏的类型提示</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qe"><img src="../Images/ecbc2e8a283592782e4cf87d6540ad4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cgWhZnGCjIlyaAP7"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托马斯·凯利在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="9712" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">现在，您已经熟悉了Python中类型提示的基础知识。因此，是时候学习一些更高级的特性了。我将向您展示五个令人敬畏的类型提示，它们将增强您的Python代码🐍</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="5e12" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">可迭代的</h2><p id="2a23" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">要求变量或函数参数应该是一个<code class="fe op oq or os b">List</code>有时过于严格。事实上，只要迭代是可能的，类型通常是可以接受的。对于这种情况，您可以使用<code class="fe op oq or os b">Iterable</code>类型提示。考虑下面的<code class="fe op oq or os b">print_everything</code>功能<strong class="lt iu"> : </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">打印iterable中所有内容的函数。</p></figure><p id="8a8b" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">现在可以对任何支持迭代的对象(例如列表、元组、字符串)调用函数<code class="fe op oq or os b">print_everything</code>。</p><blockquote class="oy oz pa"><p id="aad9" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">提示:</strong>在Python中，没有显式return语句的函数默认返回<code class="fe op oq or os b">None</code>。这就是我为函数<strong class="lt iu"> </strong> <code class="fe op oq or os b">print_everything</code>的输出添加了<code class="fe op oq or os b">-&gt; None</code> <strong class="lt iu"> </strong>类型提示的原因。</p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="5e5b" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">请求即付的</h2><p id="14da" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">Python是一种支持<a class="ae ky" href="https://en.wikipedia.org/wiki/Higher-order_function" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">高阶函数</strong> </a>的编程语言。这样做的结果是，您可以将函数作为参数传递给其他函数。考虑下面的<code class="fe op oq or os b">wrapper_print</code>函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个愚蠢的包装函数。</p></figure><p id="197a" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">属性<code class="fe op oq or os b">__name__</code>给出了函数的名称。注意<code class="fe op oq or os b">wrapper_print</code> <strong class="lt iu"> </strong>的输入和输出都是函数<strong class="lt iu">。通过使用<code class="fe op oq or os b">Callable</code>类型提示，我可以将其指定为类型提示:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在包装函数中使用可调用类型提示。</p></figure><p id="7f4e" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">当试图理解什么是可调用函数时，你经常会遇到这样的说法:“可调用函数是任何可以被调用的东西。”😑</p><p id="8bd8" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">如果你不确定，那么Python有内置的函数<code class="fe op oq or os b">callable</code>来拯救你。函数<code class="fe op oq or os b">callable</code>检查某个东西是否可调用。在日常编码中，当将<code class="fe op oq or os b">Callable</code>指定为类型提示时，你应该记住大部分函数。</p><blockquote class="oy oz pa"><p id="4b7f" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">提示:</strong>放心，函数(独立函数和类方法)都是可调用的。相反，请确保数据类型<code class="fe op oq or os b"><em class="it">int</em></code>、<code class="fe op oq or os b"><em class="it">float</em></code>、<code class="fe op oq or os b"><em class="it">bool</em></code>、<code class="fe op oq or os b"><em class="it">str</em></code>、<code class="fe op oq or os b"><em class="it">None</em></code>、<code class="fe op oq or os b"><em class="it">list</em></code>、<code class="fe op oq or os b"><em class="it">dict</em></code>、<code class="fe op oq or os b"><em class="it">tuple</em></code>或<code class="fe op oq or os b"><em class="it">set</em></code>都是不可调用的。一个有趣的可调用实例是一个拥有dunder方法<code class="fe op oq or os b"><em class="it">__call__</em></code>的类的实例。</p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="5f7a" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">联盟</h2><p id="2ac8" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">有时，要求变量或函数参数只能是单一类型过于严格。一个常见的例子是既可以是整数又可以是浮点数的变量。考虑类型提示</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">变量的浮点类型提示。</p></figure><p id="0454" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">可以想见，<code class="fe op oq or os b">hourly_wage</code> <strong class="lt iu"> </strong>也可能是整数。您可以使用<code class="fe op oq or os b">Union</code>类型提示来指定许多类型提示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用联合类型提示。</p></figure><p id="1656" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">在<code class="fe op oq or os b">Union</code>中，为变量指定每个适当的类型，用逗号分隔。请注意，这里有一个折衷的情况:通过使用<code class="fe op oq or os b">Union</code>添加许多类型提示，您可以获得更大的灵活性。然而，随着您的类型提示变得更加灵活，它们也变得不那么有用了。</p><blockquote class="oy oz pa"><p id="2dd9" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">提示:</strong>在Python 3.10中，有一种全新的语法可用:您可以使用运算符<code class="fe op oq or os b">|</code>来分隔不同类型的提示，而不是使用<code class="fe op oq or os b">Union</code>。因此我们可以用Python 3.10+中的<code class="fe op oq or os b">int | float</code>替换<code class="fe op oq or os b">Union[int, float]</code> <strong class="lt iu"> </strong>。</p><p id="7061" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated">到目前为止，大多数公司还没有使用Python 3.10。因此，我建议通过使用<code class="fe op oq or os b">Union</code>来熟悉经典的语法。</p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="2c06" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">可选择的</h2><p id="a76f" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">通常，函数中的某些参数默认设置为<code class="fe op oq or os b">None</code>。以下面的<code class="fe op oq or os b">lowercase_playlist</code>函数为例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一种降低播放列表中歌曲音量的功能。</p></figure><p id="2211" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">在<code class="fe op oq or os b">lowercase_playlist</code>中<code class="fe op oq or os b">songs</code> <strong class="lt iu"> </strong>参数默认设置为<code class="fe op oq or os b">None</code>。如果<code class="fe op oq or os b">songs</code>没有提供值，那么<code class="fe op oq or os b">songs</code> <strong class="lt iu"> </strong>将被设置为一个包含单曲<em class="nn">的列表“一切都很棒！”。</em> <strong class="lt iu"> </strong>最后，我们用列表理解的方式返回歌曲的小写版本。</p><p id="9268" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">您可以编写<code class="fe op oq or os b">Union[List, None]</code>为<code class="fe op oq or os b">lowercase_playlist</code>提供输入类型提示。但是，这种情况非常普遍，因此有一种特殊的简写语法<code class="fe op oq or os b">Optional[List]</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">小写函数的可选类型提示。</p></figure><p id="ff97" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated"><strong class="lt iu">提示:</strong>函数中的默认参数不应该使用<strong class="lt iu">可变对象</strong>(如列表)。这样做经常会导致恼人的臭虫。关于这个问题，我推荐艾尔·斯威加特的新书《超越蟒蛇的基本技能》第八章<a class="ae ky" href="https://inventwithpython.com/beyond/" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a><strong class="lt iu"/>。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="4684" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">任何的</h2><p id="ef95" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">最后，您可以通过<code class="fe op oq or os b">Any</code>提供一个包罗万象的类型提示。Python文档简单地指出:</p><blockquote class="oy oz pa"><p id="0dab" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><code class="fe op oq or os b">Any </code>-特殊类型表示无约束类型。每种类型都与<code class="fe op oq or os b">Any</code>兼容。<code class="fe op oq or os b">Any</code>兼容各型。</p></blockquote><p id="c526" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">在可以省略类型提示的情况下，为什么还需要<code class="fe op oq or os b">Any</code>？😕</p><p id="48d6" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">在我看来，<code class="fe op oq or os b">Any</code>的主要用途是向其他开发人员表明，缺少限制性类型提示是一种有意识的选择。如果您只是没有指定类型提示，那么其他开发人员可能会开始怀疑:</p><blockquote class="oy oz pa"><p id="8a95" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated">马克忘记在这里添加类型提示了吗？他马虎了吗？嗯…</p></blockquote><p id="9252" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">关注你的开发伙伴，在适当的时候使用<code class="fe op oq or os b">Any</code>类型的提示。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="c7b3" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">为什么所有酷小孩都用Python 3.9+</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qf"><img src="../Images/ed2abd86e0f42135dbe200f61f1cff8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bx_Sr6-vyftgVg_r"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·林肯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="f145" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">在Python 3.9之前，如果想提供类型提示，需要从<code class="fe op oq or os b">typing</code>模块导入<code class="fe op oq or os b">List</code>和<code class="fe op oq or os b">Dict</code>。</p><h2 id="7ffd" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">不再有了！</h2><p id="9977" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">在Python 3.9中，终于有了对列表和字典类型提示的原生支持。这意味着您不需要使用<code class="fe op oq or os b">typing</code>模块来导入<code class="fe op oq or os b">List</code>和<code class="fe op oq or os b">Dict</code>进行类型提示。在Python 3.9+中，可以使用小写的<code class="fe op oq or os b">list</code>和<code class="fe op oq or os b">dict</code>作为类型提示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用列表和字典进行类型提示的新Python 3.9+语法。</p></figure><blockquote class="oy oz pa"><p id="56dd" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">提示:</strong> <em class="it">在Python 3.9之前，从</em> <code class="fe op oq or os b"><em class="it">typing</em></code> <em class="it">模块导入</em> <code class="fe op oq or os b"><em class="it">List</em></code> <em class="it">和</em> <code class="fe op oq or os b"><em class="it">Dict</em></code> <em class="it">时必须大写。</em>这是为了避免覆盖内置的<code class="fe op oq or os b">list()</code>和<code class="fe op oq or os b">dict()</code>构造函数。在Python 3.9+中，您可以安全地使用小写版本的<code class="fe op oq or os b">list</code>和<code class="fe op oq or os b">dict</code>作为类型提示，而不用覆盖任何内容。</p></blockquote><p id="a62d" class="pw-post-body-paragraph na nb it lt b lu oe ju nc lw of jx nd ly og nf ng ma oh ni nj mc oi nl nm me im bi translated">啊！唯一比更少的导入更好的是语法一致性😍</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="89a2" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">总结和更多资源</h1><p id="53ab" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">在本文中，我介绍了Python中的类型提示。类型提示是在Python代码中加入一些静态类型的现代方法。</p><h2 id="6707" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">更多资源</h2><p id="e72e" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">对于求知欲极强的皮托尼斯塔来说，没有比pep 484 T1更好的起点了。此外，mypy的酷人们还做了一份很棒的<a class="ae ky" href="https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html" rel="noopener ugc nofollow" target="_blank">小抄</a>。</p><blockquote class="oy oz pa"><p id="d30f" class="na nb nn lt b lu oe ju nc lw of jx nd pb og nf ng pc oh ni nj pd oi nl nm me im bi translated"><strong class="lt iu">提示:</strong>你可以在你的项目中一点一点地加入类型提示。将部分代码静态类型化，而将其余部分动态类型化是没有问题的。</p></blockquote><h2 id="2d46" class="pj la it bd lb pp pq dn lf pr ps dp lj ly pt pu ll ma pv pw ln mc px py lp pz bi translated">更多类似内容？</h2><p id="6653" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">如果你喜欢我的文章，那么看看我的其他博客文章，比如<a class="ae ky" rel="noopener" target="_blank" href="/learn-some-front-end-web-development-as-a-data-scientist-da662dde6d22">作为数据科学家学习一些前端Web开发</a>和<a class="ae ky" rel="noopener" target="_blank" href="/5-awesome-numpy-functions-that-can-save-you-in-a-pinch-ba349af5ac47"> 5个可以在紧要关头拯救你的牛逼NumPy函数</a>。如果你对数据科学、编程或任何介于两者之间的东西感兴趣，欢迎在LinkedIn上加我，并向✋问好</p></div></div>    
</body>
</html>