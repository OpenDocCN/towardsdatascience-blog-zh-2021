<html>
<head>
<title>How to Easily Convert a Python Script to an Executable File (.exe)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何轻松将Python脚本转换成可执行文件(。exe)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-convert-a-python-script-to-an-executable-file-exe-4966e253c7e9?source=collection_archive---------0-----------------------#2021-05-26">https://towardsdatascience.com/how-to-easily-convert-a-python-script-to-an-executable-file-exe-4966e253c7e9?source=collection_archive---------0-----------------------#2021-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f5d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建Python可执行文件的两种简单方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d5d20af4d11171229278865dcccca12b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCdIwODhjS9IhLpYoXH38w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="06bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然使用终端或您最喜欢的文本编辑器运行Python脚本很简单，但是在某些情况下，您更喜欢隐藏脚本中编写的所有代码(。py)放在可执行文件(.exe)。</p><p id="eba5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也许您需要将脚本发送给一个根本不会编码的人，或者您可能需要安排一个在特定时间在您的计算机上运行<code class="fe lu lv lw lx b">.exe</code>的作业。无论情况如何，在本指南中，我将向您展示两种创建可执行文件的方法。第一个(auto-py-to-exe)有一个友好的界面，可以帮助初学者轻松地创建可执行文件，而第二个(PyInstaller)提供了一种通过终端创建可执行文件的简单方法。</p><pre class="kj kk kl km gt ly lx lz ma aw mb bi"><span id="8a9d" class="mc md it lx b gy me mf l mg mh"><strong class="lx iu">Table of Contents<br/></strong>1. <a class="ae mi" href="#b2c6" rel="noopener ugc nofollow">Making an Executable file with auto-py-to-exe</a><br/> - <a class="ae mi" href="#c689" rel="noopener ugc nofollow">Installing with pip</a><br/> - <a class="ae mi" href="#eeef" rel="noopener ugc nofollow">Running auto-py-to-exe</a><br/> - <a class="ae mi" href="#0063" rel="noopener ugc nofollow">Step 1: Add the script location</a><br/> - <a class="ae mi" href="#7b48" rel="noopener ugc nofollow">Step 2: Choosing “One Directory” or “One File”</a><br/> - <a class="ae mi" href="#d2bc" rel="noopener ugc nofollow">Step 3. Choosing “Console Based” or “Window Based”</a><br/> - <a class="ae mi" href="#7cd6" rel="noopener ugc nofollow">Step 4: Advanced option(e.g. output directory, additional import)</a><br/> - <a class="ae mi" href="#ed33" rel="noopener ugc nofollow">Step 5: Convert the file</a><br/>2. <a class="ae mi" href="#f30d" rel="noopener ugc nofollow">Making an Executable file with PyInstaller</a></span></pre><h1 id="b2c6" class="mj md it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">用auto-py-to-exe制作可执行文件</h1><p id="ad0e" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">第一个选项提供了一个漂亮的GUI(图形用户界面),它负责将Python脚本转换成可执行文件的所有必要工作。</p><p id="2400" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对了，你也可以看看我的YouTube视频，学习一下如何把一个. py转换成。如果你更喜欢看下面的步骤而不是阅读它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><h2 id="c689" class="mc md it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">使用pip安装</h2><p id="97f7" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">要安装auto-py-to-exe的最新版本，只需打开终端并运行以下命令。</p><pre class="kj kk kl km gt ly lx lz ma aw mb bi"><span id="8a51" class="mc md it lx b gy me mf l mg mh">pip install auto-py-to-exe</span></pre><p id="5332" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ns">注意:确保你安装</em> <code class="fe lu lv lw lx b"><em class="ns">auto-py-to-exe</em></code> <em class="ns">的工作环境包含了你的脚本需要运行的所有库。</em></p><h2 id="eeef" class="mc md it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">运行自动复制到可执行文件</h2><p id="847e" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">一旦安装了auto-py-to-exe，创建一个可执行文件就像编写下面的命令一样简单。</p><pre class="kj kk kl km gt ly lx lz ma aw mb bi"><span id="8580" class="mc md it lx b gy me mf l mg mh">auto-py-to-exe</span></pre><p id="2dcb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行该命令后，将打开以下GUI应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/70af2b374766633b932cdc559ca6619e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*q4jQCieVjcweWtqq5VXM3w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9b67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将带您浏览每个选项，以正确创建一个可执行文件。</p><h1 id="473c" class="mj md it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">创建可执行文件的步骤</h1><h2 id="0063" class="mc md it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">步骤1:添加脚本位置</h2><p id="de32" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">浏览您希望转换的脚本，并将其添加到“脚本位置”字段。在本例中，我将选择一个自动化Excel报告的脚本(您可以在下面的链接中找到我的自动化Excel指南)</p><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/a-simple-guide-to-automate-your-excel-reporting-with-python-9d35f143ef7"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">使用Python自动生成Excel报表的简单指南</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">使用openpyxl通过Python自动生成Excel报表。</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div><p id="0bbd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以随意选择任何你想要的剧本。然而，如果你的脚本需要读取一个路径，确保你使用绝对路径，因为相对路径不会像你期望的那样处理可执行文件。如有必要，在下面包含以下代码行，以了解可执行文件的位置，并对脚本进行必要的更改，以便在正确的目录下读取/导出文件。</p><pre class="kj kk kl km gt ly lx lz ma aw mb bi"><span id="d291" class="mc md it lx b gy me mf l mg mh">application_path = os.path.dirname(sys.executable)</span></pre><h2 id="7b48" class="mc md it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">第二步:选择“一个目录”或“一个文件”</h2><p id="761b" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">现在我们必须选择是创建“一个目录”还是“一个文件”第一个创建一个目录，其中包含脚本运行所需的所有依赖项(包括可执行文件)，而第二个只创建一个可执行文件。</p><p id="5181" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个例子，我将选择“一个文件”选项。</p><h2 id="d2bc" class="mc md it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">第三步。选择“基于控制台”或“基于窗口”</h2><p id="e522" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">现在是时候选择是否显示控制台了。如果您选择“基于控制台”，控制台将在运行可执行文件后打开，如果您的脚本生成基于控制台的输出，建议您这样做。但是，如果您不想在运行可执行文件时显示控制台输出，请选择“基于窗口”</p><p id="1650" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我的脚本需要引入Excel电子表格的名称作为输入，以便创建我的Excel报表，因此我将选择“基于控制台”</p><h2 id="7cd6" class="mc md it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">步骤4:高级选项(例如，输出目录、附加导入)</h2><p id="bbdb" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">您可以添加图标，添加您的脚本需要运行的文件，等等！然而，对于这个例子，我将只修改可执行文件的导出路径。为此，点击“设置”选项并浏览您希望的输出目录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/691746308c909e8ae5456458789f9e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*d7SR48_aTa7QKaNjdb2JaA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5d75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ns">注意:如果您在双击创建的可执行文件后看到类似“ModuleFoundNotError:Not module named ' name _ of _ module '”的错误，您必须再次从步骤1开始重复，但是现在在“高级”选项的“隐藏-导入”字段中缺少模块名称。</em></p><h2 id="ed33" class="mc md it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">步骤5:转换文件</h2><p id="77b0" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">要转换。将文件复制到。只需点击下面的蓝色按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6701d4297015fae73ec0b208edfe5963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*TX3_gwvS3etGOxjrnnHROw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8d4b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">auto-py-to-exe</code>在convert按钮上方显示的真正重要的东西是<code class="fe lu lv lw lx b">pyinstaller </code>(本指南中的主库和第二个选项)制作的代码。exe文件)需要创建一个可执行文件背后的花式贵由看到在屏幕上。</p><p id="7d33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦该过程完成，可执行文件应该位于您在步骤4中设置的输出目录中！</p><h1 id="f30d" class="mj md it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">用PyInstaller制作可执行文件</h1><p id="b9db" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">这个选项更适合那些喜欢在终端上快速创建运行命令的可执行文件的人。</p><p id="137f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您习惯于使用终端，那么PyInstaller库将是最佳选择。要安装PyInstaller，请按照下列步骤操作。</p><ul class=""><li id="b69c" class="oo op it la b lb lc le lf lh oq ll or lp os lt ot ou ov ow bi translated"><strong class="la iu">第一步:</strong>打开一个终端，运行<code class="fe lu lv lw lx b">pip install pyinstaller</code></li><li id="dde4" class="oo op it la b lb ox le oy lh oz ll pa lp pb lt ot ou ov ow bi translated"><strong class="la iu">步骤2: </strong>使用终端，转到您的脚本所在的目录(使用<code class="fe lu lv lw lx b">cd</code>命令)</li><li id="85fe" class="oo op it la b lb ox le oy lh oz ll pa lp pb lt ot ou ov ow bi translated"><strong class="la iu">步骤3: </strong>一旦进入正确的目录，在终端中使用下面的语法<code class="fe lu lv lw lx b">pyinstaller --onefile name_of_script.py </code>编写一个命令，使脚本可执行。</li></ul><p id="3c08" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">步骤3中使用的命令类似于步骤5图片中显示的<code class="fe lu lv lw lx b">auto-py-to-exe </code>选项的代码。您可以稍微使用一下由<code class="fe lu lv lw lx b">auto-py-to-exe </code>提供的GUI，以习惯您可以添加到该命令中的许多选项。</p><p id="b069" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行该命令后，您应该会看到一条消息，显示“成功完成”在脚本所在的目录中，应该已经创建了一个名为“dist”的文件夹。在这个文件夹中，你会找到独立的可执行文件！</p></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><p id="3907" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ns">祝贺你！现在，您的Python脚本已经被转换为可执行文件。如果您想安排该文件在您的计算机上运行的时间，请查看本指南。</em></p><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/how-to-easily-automate-your-python-scripts-on-mac-and-windows-459388c9cc94"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">如何在Mac和Windows上轻松自动化您的Python脚本</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">使用crontab和任务调度器来自动化您的脚本并节省时间</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="pj l oi oj ok og ol ks nx"/></div></div></a></div></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><p id="2898" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用Python自动化您的生活！<a class="ae mi" href="https://frankandrade.ck.page/44559e1ae7" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">加入我的20k+人电子邮件列表，获取我的免费自动化备忘单。</strong> </a></p></div></div>    
</body>
</html>