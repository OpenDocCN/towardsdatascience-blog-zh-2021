<html>
<head>
<title>Power BI Tips &amp; Tricks: Custom Sort</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Power BI提示和技巧:自定义排序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/power-bi-tips-tricks-custom-sort-7cf3b4cf2a5e?source=collection_archive---------11-----------------------#2021-07-08">https://towardsdatascience.com/power-bi-tips-tricks-custom-sort-7cf3b4cf2a5e?source=collection_archive---------11-----------------------#2021-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d2c6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Power BI提示和技巧系列的一部分</h2></div><p id="d63d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大约两年前，我开始使用微软的Power BI。一路走来，我学到了一些更高效做事的技巧和诀窍。这个系列是为了方便初学者而设计的，所以如果你有什么不明白的地方，请告诉我。我也很乐意听到你发现有用的额外的提示和技巧！</p><p id="7269" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以直接跳到解决方案，并将它们应用到您自己的数据中，或者您可以跟随<a class="ae lf" href="https://drive.google.com/file/d/1Vl3vwVeLfydjpR7DkI6V6t18HfgBQ0M8/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">一起了解这个示例数据</a>。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/fa227d7938c9456d43231bed7b05c3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IydKD7l-LvKeO73g"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">照片由<a class="ae lf" href="https://unsplash.com/@chuklanov?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Avel Chuklanov </a>在<a class="ae lf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="1cd3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">问题是</h1><p id="5416" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">假设我正在处理一所(小)大学的数据，他们想知道每个年级有多少学生。很好，这听起来像是一个制作簇状条形图的机会。</p><p id="3ba8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将“年级”拖到轴上，将“学号”拖到值上，得到如下结果:</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/f746e02282b51e51f2487d84283931af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*XLkSpXnVgqZ0x1Z0UTMZ2w.png"/></div></figure><p id="92d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我可以按学号(学生人数)或年级的字母顺序对图表进行排序。但是我希望我的数据按照时间顺序排序，学生从大一开始，然后是大二，大三，最后是大四。</p><p id="36c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">啊！当我有一段时间没有这样做时，我几乎总是首先尝试添加一个计算列，然后按此排序。但是这给了我们一个错误，因为我们引入了一个循环依赖。</p><p id="8c7f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是不要害怕！有几种可能的策略可以按照我们想要的任何顺序对数据进行排序。</p><h1 id="61cd" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">解决方案1:创建一个附加表</h1><p id="7faf" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">当其他人正在管理排序应该如何出现时，或者如果您有许多不同的级别，这是一个很好的方法。您可以在Power BI中直接创建该表:</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/baeefbf3ca58a68601c9839b458c3f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*LatE_tHuRvX1PXKrpCX6-g.png"/></div></figure><p id="ed1c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者，您可以创建一个额外的Excel工作簿或在现有工作簿中添加一个工作表。我通常更喜欢Excel格式的表格，因为我觉得在需要的时候更容易更新。我们的表应该是这样的:</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/8db0984d854cc548cfadcbc04abeda6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*SUoxEu72NukQm6RfyQmVqA.png"/></div></figure><p id="08d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们将把这个表添加到Power BI文件中，并在我们的模型中创建一个关系。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/33f64b11157c093f5eb56f6cdbec7a37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*wi3K4Okp7oyUAbBp-Qsdkw.png"/></div></figure><p id="0b7e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我们创建了一个单独的表，所以现在我们可以使用RELATED创建一个计算列，而不会遇到循环依赖问题。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/adb6a0561502e2bdeb9086eb9e5fd554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*TMLpyxijN1HeKPVhpPXNTQ.png"/></div></figure><p id="e770" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个栏目的表现和我们预期的一样(高年级是“1”，低年级是“2”，等等)。).最后，我们告诉Power BI按照我们的排序顺序列对我们的等级列进行排序。同时选择等级列&gt;列工具&gt;按列排序&gt;排序顺序。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi my"><img src="../Images/83c4937d3a8040fab14bea8dc2b25013.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQsIPwS8ZKDWa5q2p99UbQ.png"/></div></div></figure><p id="6ac5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">瞧啊。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/a984624a1fc6408316a0e6bbb638e182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*dWzibCVeX-6pwAAQQVKx3g.png"/></div></figure><p id="7641" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而且现在做更新超级容易。假设我们为五年级学生增加了一个超高年级。我们所要做的就是更新我们的Excel文件，保存它，并刷新Power BI。</p><h1 id="0fa1" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">解决方案2:使用超级查询</h1><p id="4729" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">如果不太可能改变我们想要的排序方式，这是一个很好的选择。我们仍然可以使用这个选项进行更新，只是对于那些不太熟悉Power Query的人来说，它不太方便使用。</p><p id="c6c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用此选项，我们将通过选择“转换数据”选项进入超级查询编辑器。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi na"><img src="../Images/593af8e171f3042cdf81048546c14239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqVDPLwQI7oXppSnhMFihw.png"/></div></div></figure><p id="7159" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们只需点击鼠标就可以做到这一点，所以不要惊慌，但如果你愿意，我们也可以使用M来做到这一点。无论哪种方式都很棒！</p><p id="d5c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想要指向并单击，请在超级查询编辑器中选择“转换”功能区下的“条件列”按钮。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/018c623dfdedf190470a07949d5a5820.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*KkKNEQcXy97O_NU4pDfpAg.png"/></div></div></figure><p id="75c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，您可以为每个级别创建一个附加子句:</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nc"><img src="../Images/4808339d08e81bb2fc09671653c1aa24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hl5eanOIMvyq1gyrbKZmIw.png"/></div></div></figure><p id="e453" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，就像我们对另一个解决方案所做的那样，您所要做的就是退出超级查询编辑器，并使我们的新条件列成为排序“Grade”所依据的列。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi my"><img src="../Images/83c4937d3a8040fab14bea8dc2b25013.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQsIPwS8ZKDWa5q2p99UbQ.png"/></div></div></figure></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><p id="756e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你有它！当您需要以自定义顺序对列进行排序时，有两种解决方案:一种是使用附加表和相关函数，另一种是在Power Query中使用条件列。</p><p id="4d34" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你喜欢哪种解决方案？你有更好的解决方案可以分享吗？</p><p id="3bec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">继续用你的头撞墙——这样会好得多！</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><p id="45f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lf" href="https://medium.com/@jeagleson" rel="noopener"> <strong class="kk iu"> <em class="le">珍娜·伊格尔森</em> </strong> </a> <em class="le"> <br/>我的背景是工业组织心理学，我在人物分析中找到了自己的家。数据使我的作品变得生动。我主要使用Power BI，但偶尔也会使用Tableau和其他工具。我很想听到更多关于你的旅程！在</em><a class="ae lf" href="https://www.linkedin.com/in/jenna-eagleson/" rel="noopener ugc nofollow" target="_blank"><em class="le">Linkedin</em></a><em class="le">或</em><a class="ae lf" href="https://twitter.com/JennaEagleson" rel="noopener ugc nofollow" target="_blank"><em class="le">Twitter</em></a><em class="le">上联系我。</em></p></div></div>    
</body>
</html>