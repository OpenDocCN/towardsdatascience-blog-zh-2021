<html>
<head>
<title>Understanding Graph Mining</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解图形挖掘</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-graph-mining-e713183a64f3?source=collection_archive---------12-----------------------#2021-09-07">https://towardsdatascience.com/understanding-graph-mining-e713183a64f3?source=collection_archive---------12-----------------------#2021-09-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="96b6" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">图形挖掘学习指南</h2><div class=""/><div class=""><h2 id="ee2e" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">你学习深度学习的第一步</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/a2e7c13c320fa918bc2e426c33c76605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5HZng2l9j2iQSbaJ"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源(<a class="ae lh" href="https://unsplash.com/photos/8bghKxNU1j0" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>)</p></figure><blockquote class="li lj lk"><p id="4bb2" class="ll lm ln lo b lp lq kd lr ls lt kg lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><em class="it">想象一下脸书:你如何在朋友层内建立联系？</em></p><p id="6955" class="ll lm ln lo b lp lq kd lr ls lt kg lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><em class="it">想象一下推荐系统:你怎么知道一个人的偏好与其聚类密切相关？</em></p><p id="4cfd" class="ll lm ln lo b lp lq kd lr ls lt kg lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">欢迎来到图形挖掘</p></blockquote><h1 id="70b5" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">理解图形分类</h1><p id="9af7" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">图形分类在大量连接的数据(例如:社交、生物和支付)中生成图形，并使用图形来识别标签(监督的)或聚类(非监督的)。</p><p id="9aea" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">如果这听起来对你来说很难，你可以看看你的大脑，因为它是快速推断图表之间联系的大师。</p><p id="f42f" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">例如，你的大脑知道如何从A点到B点，甚至不需要思考。想象一下你在长时间购物后的最后一次购物之旅。带着孩子去购物时，你可以浏览商品目录，并在不同类别的过道中画出多条直线来比较产品。</p><p id="552b" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">所有这些行动都需要整合，根据一系列子行动来推断最佳行动，以达到最终目标。尽可能以最轻松的方式完成。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ni"><img src="../Images/5b0a6bb776a970afe25fda7ed876c33c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jn05kl5sKD4_QOv2"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">一个简单的DAG(有向无环图)流程图(来源于作者)</p></figure><h1 id="8144" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">同样地…</h1><p id="5c6c" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">图挖掘使用特征来查看一组观察结果如何与用户面临的相似性信号相关联。</p><p id="a6e0" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">图形表示基于距离公式化的实体(节点)之间的关系(边)。</p><p id="d7fa" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">有两个常见的特征:</p><ul class=""><li id="4511" class="nj nk it lo b lp lq ls lt nc nl ne nm ng nn mh no np nq nr bi translated">来自外部来源的自然图表。例如支付网络、社交媒体和道路。</li><li id="060f" class="nj nk it lo b lp ns ls nt nc nu ne nv ng nw mh no np nq nr bi translated">来自节点间相似距离度量的相似图。例如，元数据的blob然后通过图形表示共享blob结构。</li></ul><p id="f392" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">根据图形的特征，我们可以将每个图形分类为</p><ul class=""><li id="916a" class="nj nk it lo b lp lq ls lt nc nl ne nm ng nn mh no np nq nr bi translated">具有一种节点和边的简单齐次</li><li id="a84d" class="nj nk it lo b lp ns ls nt nc nu ne nv ng nw mh no np nq nr bi translated">复杂异构，具有多种类型的节点、多种类型的边。这些可以是有向的，也可以是无向的。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/8dab76a756f35273f6fdb826d9a0165f.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/0*kZer9ZF-Fx34uzdn"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图的基本组成部分(在这种情况下是无向的)是节点和边。(<a class="ae lh" href="https://www.geeksforgeeks.org/graph-data-structure-and-algorithms/" rel="noopener ugc nofollow" target="_blank">来源</a>:geeksforgeeks.org)</p></figure><h1 id="e0bb" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">为什么图表很重要？</h1><h2 id="655a" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">图表无处不在</h2><p id="9f73" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">图表是多用途的。您可以通过对周围的邻域进行分类来构建监督模型，通过将现有标注传播到邻域中缺失的标注来构建半监督模型，以及通过训练节点级嵌入来描述数据的结构角色来构建非监督模型</p><p id="3c02" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">您可以使用图表完成各种各样的任务。例如，您可以根据您的用例对节点、图形和链接进行分类。</p><p id="fdf6" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">其中包括多项突破，如:<a class="ae lh" href="https://deepmind.com/blog/article/traffic-prediction-with-advanced-graph-neural-networks" rel="noopener ugc nofollow" target="_blank">谷歌DeepMind的超级分段图预测到达时间(ETA) </a>和来自Pinterest的<a class="ae lh" href="https://medium.com/pinterest-engineering/pinsage-a-new-graph-convolutional-neural-network-for-web-scale-recommender-systems-88795a107f48" rel="noopener">PinSage</a>。</p><h2 id="3dd7" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">图形计算具有关系和同一性的抽象概念</h2><p id="13c5" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">图形抽象出<em class="ln">局部信息</em>，从数据中提取有用的<em class="ln">全局信息</em>。图形结构/拓扑可以告诉我们很多关于数据的信息，比如发现数据点的聚类，或者为无形的概念提供距离度量。</p><h2 id="fea6" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">图表是灵活的数据类型</h2><p id="3c8e" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">图形通过嵌入和组合多种类型的特征灵活地工作，例如:文本(例如:Jaccard相似性)、视觉(例如:图像相似性)和其他语义属性。例如，当分析师处理活动规则检测时，他们会使用几个特性，如正则表达式设置之间的相似性，并部署正则表达式来捕获这些站点。</p><h2 id="1dc5" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">图表是可缩放的</h2><p id="c047" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">图形采样用于寻找感受野上的子图。这些子图可以在工人的异步分布之上公式化:获取模型参数的专用服务器。</p><p id="3de6" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">这种可扩展性也提供了在图中使用联合学习来保护用户隐私的方法(例如基于Android的ML训练)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c16b094c8a06980611087dfe90bff09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E3It4EBfcefcczlz"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">带有分布式警告的可伸缩性图表(来源于作者)</p></figure><h1 id="cd8b" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">图形挖掘和网络入门</h1><h2 id="c805" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">案例研究:GNNs与Cora</h2><p id="5d6d" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">在这个案例研究中，我们将使用Cora数据，它提供了一个引用网络基准，具有2708个节点，5429条边，7个主题单词包，140个训练，500个验证和1000个测试观察。</p><p id="d19a" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">请随意使用下面的colab作为你的教程。</p><div class="oj ok gp gr ol om"><a href="https://colab.sandbox.google.com/drive/1d8YEErtymICvB_-YjFRH8LfUgtw-8YWW?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd jd gy z fp or fr fs os fu fw jc bi translated">谷歌联合实验室</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">编辑描述</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">colab.sandbox.google.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa lb om"/></div></div></a></div><h2 id="1d69" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">使用的库</h2><p id="e28e" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated"><a class="ae lh" href="https://graphneural.network/" rel="noopener ugc nofollow" target="_blank"> Spektral </a>作为图形深度学习的开源Python库，基于Keras和Tensorflow2。这个项目的主要目标是为创建图形神经网络(GNNs)提供一个简单而灵活的框架。</p><p id="cf02" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">Spektral有一个方便的功能，允许我们快速加载和预处理标准图形表示学习。它还允许函数访问特征矩阵、邻接、矩阵和掩码数组，以了解哪个节点属于训练、验证和测试集。</p><p id="9fa0" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">TF GNN库对模型API是不可知的，集成了DeepMind graphNet、Google神经结构化学习、基于MPNN论文的TF GNN API。该图还可以通过TPU支持的批处理/序列化在Keras层之间传递。</p><p id="d4e8" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated"><strong class="lo jd">在colab中安装和导入这些库非常简单</strong></p><pre class="ks kt ku kv gt pb pc pd pe aw pf bi"><span id="54b1" class="ny mj it pc b gy pg ph l pi pj">!pip install numpy<br/>!pip install tensorflow<br/>!pip install spektral==0.6.1<br/>import numpy as np<br/>import tensorflow as tf<br/>import spektral</span></pre><h2 id="e63e" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">从频谱生成形容词矩阵和特征矩阵</h2><p id="c9ba" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">adj指的是邻接矩阵，features指的是feature_matrix，labels指的是论文的主题，mask sets指的是哪个节点属于哪个数据集。</p><pre class="ks kt ku kv gt pb pc pd pe aw pf bi"><span id="a373" class="ny mj it pc b gy pg ph l pi pj">adj, features, labels, train_mask, val_mask, test_mask = spektral.datasets.citation.load_data(dataset_name=’cora’)</span></pre><p id="420e" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">然后，我们替换密集特征，将特征转换为邻接矩阵，同时在float32中将它们设置为标准的机器学习输出格式。</p><pre class="ks kt ku kv gt pb pc pd pe aw pf bi"><span id="27c5" class="ny mj it pc b gy pg ph l pi pj">features = features.todense()<br/>adj = adj.todense() + np.eye(adj.shape[0])<br/>features = features.astype(‘float32’)<br/>adj = adj.astype(‘float32’)</span></pre><h2 id="13dd" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">培训和评估流程</h2><p id="8ce2" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">我们按照以下步骤在Cora数据集上训练我们的GNN:</p><ol class=""><li id="5899" class="nj nk it lo b lp lq ls lt nc nl ne nm ng nn mh pk np nq nr bi translated">定义2个GNN图层(输入-单位，输出-7个主题，带sumpooling)</li><li id="ef78" class="nj nk it lo b lp ns ls nt nc nu ne nv ng nw mh pk np nq nr bi translated">用Relu激活函数实现定义层的GNN。</li><li id="0245" class="nj nk it lo b lp ns ls nt nc nu ne nv ng nw mh pk np nq nr bi translated">使用<a class="ae lh" href="https://www.youtube.com/watch?v=ENOycxDU9RY" rel="noopener ugc nofollow" target="_blank"> tf。GradientTape() </a>记录自动微分的操作。这有助于我们观察变量和梯度，以捕捉回传播错误</li><li id="8d42" class="nj nk it lo b lp ns ls nt nc nu ne nv ng nw mh pk np nq nr bi translated">将优化器应用于渐变(Adam opt是标准)</li><li id="a3f7" class="nj nk it lo b lp ns ls nt nc nu ne nv ng nw mh pk np nq nr bi translated">基于特征和邻接矩阵指定逻辑和精度计算</li></ol><h2 id="c63a" class="ny mj it bd mk nz oa dn mo ob oc dp ms nc od oe mu ne of og mw ng oh oi my iz bi translated">评估流程</h2><p id="ce4a" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">您可以使用参数(单位、时期和学习率)进行实验，以定义验证准确性和训练/val损失。</p><pre class="ks kt ku kv gt pb pc pd pe aw pf bi"><span id="b7ba" class="ny mj it pc b gy pg ph l pi pj">train_cora(features,adj,gnn,32,200,0.01)</span><span id="e0db" class="ny mj it pc b gy pl ph l pi pj">## Results ##<br/>Epoch 0 | training loss: 1.9685615301132202 | val_accuracy: 0.20399999618530273 | test_accuracy:0.20799998939037323<br/>Epoch 1 | training loss: 2.1238698959350586 | val_accuracy: 0.30399999022483826 | test_accuracy:0.3100000023841858<br/>Epoch 2 | training loss: 1.6506766080856323 | val_accuracy: 0.6060000061988831 | test_accuracy:0.6150000095367432<br/>Epoch 3 | training loss: 1.504560112953186 | val_accuracy: 0.628000020980835 | test_accuracy:0.6359999775886536<br/>…<br/>Epoch 129 | training loss: 0.004622798413038254 | val_accuracy: 0.7520000338554382 | test_accuracy:0.7450000047683716</span></pre><p id="ee68" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">正如你所看到的，似乎越多的纪元和训练步骤运行，我们可以从中获得更多的准确性。</p><p id="e44e" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">搞定了。祝贺你的第一个图表网络！</p><h1 id="f3f4" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">关于作者</h1><p id="0994" class="pw-post-body-paragraph ll lm it lo b lp na kd lr ls nb kg lu nc nd lx ly ne nf mb mc ng nh mf mg mh im bi translated">文森特用ML @ Google对抗网络滥用。文森特使用高级数据分析、机器学习和软件工程来保护Chrome和Gmail用户。</p><p id="f0bd" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">除了在谷歌的工作，Vincent还是<a class="ae lh" rel="noopener" target="_blank" href="/5-biggest-tips-to-juggle-work-and-study-as-data-scientists-7cad143f10a">佐治亚理工学院计算机科学硕士校友</a>、<a class="ae lh" href="https://medium.com/swlh/my-journey-from-a-noob-to-half-ironman-triathlete-de0b21662cd5" rel="noopener">三项全能运动员</a>和<a class="ae lh" href="https://medium.com/@vincentkernn" rel="noopener">面向数据科学媒体的特约作家，为有抱负的ML和数据从业者提供指导，在全球拥有100多万观众</a>。</p><p id="35c3" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">最后，请通过<a class="ae lh" href="http://www.linkedin.com/in/vincenttatan/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> <strong class="lo jd"> LinkedIn </strong> </a> <strong class="lo jd">，</strong><a class="ae lh" href="https://medium.com/@vincentkernn?source=post_page---------------------------" rel="noopener"><strong class="lo jd">Medium</strong></a><strong class="lo jd">或</strong> <a class="ae lh" href="https://www.youtube.com/user/vincelance1/videos?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> <strong class="lo jd"> Youtube频道</strong> </a>联系文森特</p><p id="4a9d" class="pw-post-body-paragraph ll lm it lo b lp lq kd lr ls lt kg lu nc lw lx ly ne ma mb mc ng me mf mg mh im bi translated">索利·德奥·格洛丽亚</p><h1 id="f434" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">参考</h1><ul class=""><li id="fc31" class="nj nk it lo b lp na ls nb nc pm ne pn ng po mh no np nq nr bi translated"><a class="ae lh" href="https://www.youtube.com/watch?v=MTSb0HWPh9M" rel="noopener ugc nofollow" target="_blank">谷歌图挖掘和学习</a></li><li id="00d8" class="nj nk it lo b lp ns ls nt nc nu ne nv ng nw mh no np nq nr bi translated"><a class="ae lh" href="https://arxiv.org/pdf/2006.12138.pdf" rel="noopener ugc nofollow" target="_blank">用Spektral在TF和Keras中绘制神经网络图</a></li></ul></div></div>    
</body>
</html>