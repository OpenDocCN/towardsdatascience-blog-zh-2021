<html>
<head>
<title>UMAP Dimensionality Reduction — An Incredibly Robust Machine Learning Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">UMAP降维——一种非常健壮的机器学习算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/umap-dimensionality-reduction-an-incredibly-robust-machine-learning-algorithm-b5acb01de568?source=collection_archive---------2-----------------------#2021-10-25">https://towardsdatascience.com/umap-dimensionality-reduction-an-incredibly-robust-machine-learning-algorithm-b5acb01de568?source=collection_archive---------2-----------------------#2021-10-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="a228" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a>，机器学习</h2><div class=""/><div class=""><h2 id="bc22" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">一致流形近似和投影(UMAP)如何工作，以及如何在Python中使用它</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/e31d2e88bae6c3f11071c478d09d2ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-ibEgNC4iDbUepGnHrQRw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">一致流形近似和投影(UMAP)。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><h1 id="52d1" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">介绍</h1><p id="e749" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">降维不仅仅是为了数据可视化。它还可以通过识别高维空间中的关键结构并在低维嵌入中保存它们来帮助您克服“T4”维度诅咒。</p><p id="7f3e" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">本文将带您了解一种日益流行的降维技术<strong class="md je">均匀流形逼近和投影(UMAP) </strong>的内部工作原理，并为您提供一个Python示例，可以在您从事数据科学项目时用作指南。</p><h1 id="6acb" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">内容</h1><ul class=""><li id="6b41" class="nc nd iu md b me mf mh mi mk ne mo nf ms ng mw nh ni nj nk bi translated">UMAP在机器学习算法领域的地位</li><li id="746a" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">对UMAP工作原理的直观解释</li><li id="d113" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">在Python中使用UMAP的例子</li></ul><h1 id="1d44" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">机器学习算法领域中的一致流形逼近和投影(UMAP)</h1><p id="c00e" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">下面的旭日图是我对最常用的机器学习算法进行分类的尝试。我创建它是为了满足像你我这样的数据科学家的需求，让他们有一种更结构化、更直观的方式来识别各种算法如何组合在一起。</p><p id="acbd" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">机器学习领域的这种特殊视图使我们能够看到算法之间的相似之处和不同之处，在为特定项目寻找合适的解决方案时，这可以作为快速指南。</p><p id="fcad" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">该图是<strong class="md je">交互式的</strong>，所以请确保点击👇在不同的类别上对<strong class="md je">进行放大并揭示更多的</strong>。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nq nr l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">机器学习算法分类。由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>创建的互动图表。</p></figure><p id="3b1f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> <em class="ns">如果你喜欢数据科学和机器学习</em> </strong> <em class="ns">，请</em> <a class="ae li" href="https://solclover.com/subscribe" rel="noopener ugc nofollow" target="_blank"> <em class="ns">订阅</em> </a> <em class="ns">每当我发布一个新故事时，你都会收到一封电子邮件。</em></p><p id="4a02" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">虽然UMAP最常用于<strong class="md je">无监督学习</strong>，但它也可以执行<strong class="md je">监督</strong>降维。您将在本文结尾的Python部分找到一个例子。</p><h1 id="d34d" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">一致流形近似和投影(UMAP)是如何工作的？</h1><h2 id="6dde" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">解析UMAP的名字</h2><p id="0655" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">让我们从剖析UMAP名字开始，这会给我们一个算法应该做什么的大概概念。</p><blockquote class="oe of og"><p id="eee4" class="mb mc ns md b me mx ke mg mh my kh mj oh mz mm mn oi na mq mr oj nb mu mv mw in bi translated">请注意，以下陈述不是官方定义，而是一组描述，有助于我们理解UMAP背后的关键思想。</p></blockquote><ul class=""><li id="48bd" class="nc nd iu md b me mx mh my mk ok mo ol ms om mw nh ni nj nk bi translated"><strong class="md je">投影</strong> —通过将点投影到平面、曲面或直线上来再现空间物体的过程或技术。你也可以把它想象成一个物体从高维空间到低维空间的映射。</li><li id="50dd" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md je">近似</strong> —该算法假设我们只有有限的一组数据样本(点)，而不是组成流形的整个集合。因此，我们需要根据可用的数据来近似流形。</li><li id="f798" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md je">流形</strong> —流形是在每个点附近局部类似欧几里得空间的拓扑空间。一维流形包括直线和圆，但不包括8字形。二维流形(又称曲面)包括平面、球面、圆环面等等。</li><li id="87f1" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md je">均匀</strong> —均匀假设告诉我们，我们的数据样本均匀地(均匀地)分布在整个流形上。然而，在现实世界中，这种情况很少发生。因此，这个假设导致了这样一个概念，即流形上的距离是变化的。也就是说，空间本身是扭曲的:根据数据出现的稀疏或密集程度而拉伸或收缩。</li></ul><p id="0ce0" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">综上所述，我们可以将UMAP描述为:</p><blockquote class="oe of og"><p id="c483" class="mb mc ns md b me mx ke mg mh my kh mj oh mz mm mn oi na mq mr oj nb mu mv mw in bi translated">一种降维技术，假设可用数据样本均匀(<strong class="md je">均匀</strong>)分布在拓扑空间(<strong class="md je">流形</strong>)中，可以从这些有限数据样本中<strong class="md je">近似</strong>，并映射(<strong class="md je">投影</strong>)到一个更低维的空间。</p></blockquote><p id="7d1b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">上面对算法的描述可能会有所帮助，但对于UMAP是如何施展魔法的，它仍然是模糊的。因此，为了回答“如何做”的问题，让我们分析一下UMAP执行的各个步骤。</p><h2 id="11ee" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">UMAP执行的高级步骤</h2><p id="8aea" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我们可以将UMAP分为两个主要步骤:</p><ol class=""><li id="3b6f" class="nc nd iu md b me mx mh my mk ok mo ol ms om mw on ni nj nk bi translated">学习高维空间中的流形结构；</li><li id="567c" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw on ni nj nk bi translated">找到所述流形的低维表示。</li></ol><p id="068d" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">然而，我们将把它分解成更小的部分，以加深对算法的理解。下面的地图显示了我们分析每一件作品的顺序。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oo"><img src="../Images/7de836cffaf1a42df31fce0ae441caf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oIw3ZIuHUQwPbXOtbYMp8g.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">UMAP的步骤和组成部分——图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><h2 id="281f" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">步骤1 —学习歧管结构</h2><p id="fe46" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">这并不奇怪，但在我们将数据映射到低维之前，我们首先需要弄清楚它在高维空间中是什么样子的。</p><p id="0302" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 1.1。寻找最近邻居</strong> <br/>从使用董等人的<a class="ae li" href="http://www.cs.princeton.edu/cass/papers/www11.pdf" rel="noopener ugc nofollow" target="_blank">最近邻居下降算法寻找最近邻居开始。您将在稍后的Python部分看到，我们可以通过调整UMAP的<strong class="md je"> <em class="ns"> n_neighbors </em> </strong>超参数来指定想要使用的最近邻数。</a></p><p id="e421" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">试验一下<strong class="md je"> <em class="ns"> n_neighbors </em> </strong>的数量很重要，因为它<strong class="md je">控制UMAP如何平衡数据</strong>中的局部与全局结构。它通过在试图学习流形结构时限制局部邻域的大小来实现。</p><p id="aab4" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">从本质上来说，<strong class="md je"> <em class="ns"> n_neighbors </em> </strong>的小值意味着我们想要一个非常局部的解释，精确地捕捉结构的细节。相比之下，一个大的<strong class="md je"> <em class="ns"> n_neighbors </em> </strong>值意味着我们的估计将基于更大的区域，从而更广泛地准确跨越整个流形。</p><p id="626b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 1.2。接下来，UMAP需要通过连接先前确定的最近邻居来构建一个图。为了理解这个过程，我们需要看几个子组件来解释邻域图是如何形成的。</strong></p><p id="5991" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 1.2.1。变化的距离</strong> <br/>正如对UMAP名字的分析中所概述的，我们假设点在流形上均匀分布，这表明它们之间的空间根据数据看起来更稀疏或更密集的地方而拉伸或收缩。</p><p id="4d79" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">这实质上意味着距离度量在整个空间中不是通用的，相反，它在不同的区域之间是不同的。我们可以通过在每个数据点周围绘制圆/球来可视化它，由于不同的距离度量，这些圆/球看起来大小不同(见下图)。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj op"><img src="../Images/503ee1288b889b3619957f52f12f2491.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*NDTdukI_hbf7J-z2hShz_g.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">局部连通性和模糊开集。图片来源:<a class="ae li" href="https://umap-learn.readthedocs.io/en/latest/how_umap_works.html" rel="noopener ugc nofollow" target="_blank"> UMAP文档</a>。</p></figure><p id="594d" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 1.2.2。局部连通性</strong> <br/>接下来，我们要确保我们试图学习的流形结构不会导致许多不相连的点。幸运的是，我们可以使用另一个名为<strong class="md je"><em class="ns">local _ connectivity</em></strong>(默认值= 1)的超参数来解决这个潜在的问题。</p><p id="27d7" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">当我们设置<strong class="md je"> <em class="ns"> local_connectivity=1，</em> </strong>我们告诉算法，高维空间中的每一个点都与至少一个其他点相连。您可以在上图中看到每个实心圆是如何接触到至少一个数据点的。</p><p id="f511" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 1.2.3。模糊区域</strong> <br/>你一定注意到了上面的插图也包含了延伸到最近邻居之外的模糊圆圈。这告诉我们，当我们远离兴趣点时，与其他点的联系的确定性会降低。</p><p id="5ef0" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">最简单的方法是将两个超参数(<strong class="md je"><em class="ns">local _ connectivity</em></strong>和<strong class="md je"> <em class="ns"> n_neighbors </em> </strong>)视为下限和上限:</p><ul class=""><li id="7e76" class="nc nd iu md b me mx mh my mk ok mo ol ms om mw nh ni nj nk bi translated"><strong class="md je"> local_connectivity(默认值=1) </strong> —每个点都100%确定连接到至少一个其他点(连接数量的下限)。</li><li id="0ee9" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md je"> n_neighbors(默认值= 15)</strong>-点直接连接到第16个以上邻居的可能性为0%，因为它不在UMAP构建图表时使用的本地区域内。</li><li id="611e" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md je">邻居2至15</strong>-某个点连接到其第2至第15个邻居有一定程度的确定性(&gt; 0%但&lt; 100%)。</li></ul><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oq"><img src="../Images/fa1006bc22b26a0b7f6cef1c93cc92c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_KfLn5xj1dw7y3P4jdgnig.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">邻里插画。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="97f1" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 1.2.4。边的合并</strong> <br/>最后，我们需要明白，上面讨论的连接确定性是通过边权重(<strong class="md je"> <em class="ns"> w </em> </strong>)来表示的。</p><p id="56bc" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">由于我们采用了变化距离的方法，当从每个点的角度来看时，我们将不可避免地出现边缘权重不对齐的情况。例如，点A→ B的边权重将不同于B→ A的边权重</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj or"><img src="../Images/97f0cc605b9b15d01321e28339835d17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mO-hgV2ZxR7-NTqlPYZ-uQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">不一致的边权重。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="265f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">UMAP通过合并两条边克服了我们刚刚描述的边权重不一致的问题。以下是UMAP文件对此的解释:</p><blockquote class="os"><p id="bb76" class="ot ou iu bd ov ow ox oy oz pa pb mw dk translated">如果我们想合并两条权重为<em class="pc"> a </em>和<em class="pc"> b </em>的不一致的边，那么我们应该有一条权重为𝑎+𝑏−𝑎⋅𝑏.的边思考这个问题的方式是，权重实际上是边(1-单纯形)存在的概率。然后，组合权重是至少一个边存在的概率。</p></blockquote><p id="e1a2" class="pw-post-body-paragraph mb mc iu md b me pd ke mg mh pe kh mj mk pf mm mn mo pg mq mr ms ph mu mv mw in bi translated">最后，我们得到一个连通的邻域图，如下所示:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj op"><img src="../Images/c96c191e34643e5a920a3023bdafb8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*tZ-Z481ITAoWLDVoNMSOzA.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated"><em class="pc">具有组合边权重的图。</em>图片来源:<a class="ae li" href="https://umap-learn.readthedocs.io/en/latest/how_umap_works.html" rel="noopener ugc nofollow" target="_blank"> UMAP文档</a>。</p></figure><h2 id="0488" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">步骤2——寻找低维表示</h2><p id="2223" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">从高维空间学习了近似流形之后，UMAP的下一步就是把它投射(映射)到一个低维空间。</p><p id="1e47" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 2.1。最小距离<br/> </strong>与第一步不同，我们不希望在低维空间表示中改变距离。相反，我们希望流形上的距离是相对于全局坐标系的标准欧几里得距离。</p><p id="bebb" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">从可变距离到标准距离的转换也会影响到最近邻居的接近度。因此，我们必须通过另一个名为<strong class="md je"> <em class="ns"> min_dist </em> </strong> <em class="ns">(默认值=0.1) </em>的超参数来定义嵌入点之间的最小距离。</p><p id="d5f4" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">本质上，我们可以控制点的最小扩散，避免在低维嵌入中许多点相互重叠的情况。</p><p id="a914" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> 2.2。最小化代价函数(交叉熵)<br/> </strong>指定了最小距离，算法就可以开始寻找一个好的低维流形表示。UMAP通过最小化以下成本函数来实现，也称为交叉熵(CE):</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pi"><img src="../Images/67d59f4f3bfb5a59acfabd1a62285a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uv7z-el3YSutoonlVal6Lw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">最小化交叉熵成本方程。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="a71d" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">如你所见，最终目标是<strong class="md je">在低维表示中找到边的最佳权重</strong>。随着迭代随机梯度下降过程，上述交叉熵成本函数被最小化，这些最优权重出现。</p><p id="b639" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">就是这样！UMAP的工作现在完成了，我们得到了一个数组，其中包含了指定的低维空间中每个数据点的坐标。</p><div class="kt ku kv kw gu ab cb"><figure class="pj kx pk pl pm pn po paragraph-image"><a href="https://solclover.com/membership"><img src="../Images/1b3d3abe50e10bf8f8217750c717e6f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*SlTMz5K4dBpjkIvUHo8C_Q.png"/></a></figure><figure class="pj kx pk pl pm pn po paragraph-image"><a href="https://www.linkedin.com/in/saulius-dobilas/"><img src="../Images/60fb21d1cb2701bfb6b71f61c99403e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vabxOXtQ4T034N_mscHSmQ.png"/></a></figure></div><h1 id="6d30" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">在Python中使用UMAP</h1><p id="1633" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">最后，我们可以使用新获得的UMAP知识在Python中进行降维。</p><p id="056a" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们将在MNIST数据集(手写数字的集合)上应用UMAP来说明我们如何成功地分离数字并在低维空间中显示它们。</p><h2 id="a11a" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">设置</h2><p id="bc7b" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我们将使用以下数据和库:</p><ul class=""><li id="2ad1" class="nc nd iu md b me mx mh my mk ok mo ol ms om mw nh ni nj nk bi translated"><a class="ae li" href="https://scikit-learn.org/stable/index.html" rel="noopener ugc nofollow" target="_blank">Scikit-learn library</a>for<br/>1)MNIST数字数据(<a class="ae li" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_digits.html" rel="noopener ugc nofollow" target="_blank">load _ digits</a>)；<br/> 2)将数据拆分成训练样本和测试样本(<a class="ae li" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank">train _ test _ split</a>)；</li><li id="bb68" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://umap-learn.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> UMAP </a>库，用于执行降维；</li><li id="c169" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">用于数据可视化的<a class="ae li" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>和<a class="ae li" href="https://matplotlib.org/stable/contents.html" rel="noopener ugc nofollow" target="_blank">Matplotlib</a>；</li><li id="41eb" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://pandas.pydata.org/docs/" rel="noopener ugc nofollow" target="_blank">熊猫</a>和<a class="ae li" href="https://numpy.org/doc/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Numpy </a>进行数据操作。</li></ul><p id="84cd" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">第一步是导入我们上面列出的库。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="pp nr l"/></div></figure><p id="c2b1" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">接下来，我们加载MNIST数据并显示前十个手写数字的图像。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="pp nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pq"><img src="../Images/80871a5705f725df9e73410e7bbdff99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R50cG29NfxGjAE0OWPiBrw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">前十个手写数字的图像(8×8 = 64像素，即64维)。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="762a" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">接下来，我们将创建一个绘制3D散点图的函数，我们可以多次重用该函数来显示UMAP降维的结果。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="pp nr l"/></div></figure><h2 id="c673" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">将UMAP应用于我们的数据</h2><p id="4606" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">现在，我们将之前加载到数组X中的MNIST数字数据。X (1797，64)的形状告诉我们，我们有1，797个数字，每个数字由64个维度组成。</p><p id="8780" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们将使用UMAP把维数从64降低到3。请注意，我已经列出了UMAP所有可用的超参数，并简要说明了它们的功能。</p><p id="1336" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">虽然在本例中，我将大多数超参数设置为默认值，但我鼓励您尝试使用它们，看看它们如何影响结果。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="pp nr l"/></div></figure><p id="d91b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">上面的代码将UMAP应用于我们的MNIST数据，并打印出转换后的数组的形状，以确认我们已经成功地将维数从64减少到3。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj pr"><img src="../Images/e2820c7d38ef39123209eb25388b92f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*wRmG1C01vP2WgK3xWngiQA.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">新转换数组的形状。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="0939" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们现在可以使用之前创建的图表绘图功能来可视化我们的三维数字数据。我们用一行简单的代码调用该函数，传递我们想要可视化的数组。</p><pre class="kt ku kv kw gu ps pt pu pv aw pw bi"><span id="805c" class="nt lk iu pt b gz px py l pz qa">chart(X_trans, y)</span></pre><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nq nr l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated"><strong class="ak">无监督UMAP </strong>降维的结果。图表作者<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>。</p></figure><p id="810c" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">结果看起来很棒，数字簇之间有清晰的分离。有趣的是，数字1形成了三个不同的簇，这可以用人们书写数字1的不同方式来解释:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj qb"><img src="../Images/489eaabe5c4b735b39ea7c53d848ceab.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*ompfsbXfjG31Kdkc6rSJmA.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">数字1的不同写法。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="5fe2" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">请注意，在底部用一个碱基书写1是如何让它看起来像数字2的。我们可以在一个由1组成的红色小簇中找到这些案例，这个小簇非常靠近由2组成的绿色簇。</p><h2 id="4362" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">监督UMAP</h2><p id="0f82" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">正如本文开头提到的，我们还可以在监督下使用UMAP来帮助降低数据的维度。</p><p id="19cb" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">在执行监督降维时，除了图像数据(X_train数组)，我们还需要将标签数据(y_train数组)传递到一个<strong class="md je"><em class="ns">fit _ transform</em></strong>方法中(参见下面的代码)。</p><p id="4181" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">此外，我想让您注意到我对超参数做了一些其他的小改动，设置<strong class="md je"> <em class="ns"> min_dist=0.5 </em> </strong>和<strong class="md je"><em class="ns">local _ connectivity = 2</em></strong>以获得更好的可视化效果和测试样本的更好结果。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="pp nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj qc"><img src="../Images/cee420a031c636e3d4abfc559e9ba427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*W6IH2Of0Arl1v0iJwP2_UQ.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">转换后的训练和测试数组的形状。图片作者。</p></figure><p id="938b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">既然我们已经使用监督UMAP方法成功地降低了维度，我们可以绘制3D散点图来显示结果。</p><pre class="kt ku kv kw gu ps pt pu pv aw pw bi"><span id="9763" class="nt lk iu pt b gz px py l pz qa">chart(X_train_res, y_train)</span></pre><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nq nr l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated"><strong class="ak">监督UMAP </strong>降维结果— <strong class="ak">训练数据</strong>。图表作者<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>。</p></figure><p id="89f7" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们可以看到，UMAP已经形成了非常紧密的每一个相隔相当远的数字集群。</p><p id="f5d7" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们现在为测试数据创建相同的3D图形，看看UMAP是否能成功地将新数据点放入这些簇中。</p><pre class="kt ku kv kw gu ps pt pu pv aw pw bi"><span id="8c5a" class="nt lk iu pt b gz px py l pz qa">chart(X_test_res, y_test)</span></pre><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nq nr l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated"><strong class="ak">监督UMAP </strong>降维结果— <strong class="ak">测试数据。</strong>图表作者<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>。</p></figure><p id="c45b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">正如您所看到的，结果相当不错，只有少数数字出现在错误的簇中。特别是，它看起来像算法与数字3斗争，有几个例子位于7，8和5的旁边。</p><h1 id="6647" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">结论</h1><p id="dda7" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">感谢您阅读这篇长文，我希望其中的每一部分都让您对这个伟大的算法是如何运行的有了更多的了解。</p><p id="c24c" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">总的来说，UMAP有着坚实的数学基础，它往往能比t-SNE等类似的降维算法做得更好。</p><p id="a7f2" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">秘密在于UMAP能够推断出<strong class="md je">局部</strong>和<strong class="md je">全局</strong>结构，同时保持低维空间中的相对全局距离。这些能力使我们能够开启特定的洞察力，例如发现数字1和2的手写形式之间的相似之处。</p><p id="f0ee" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">欢迎大家分享自己的想法和反馈，有助于我以后写出更好的文章。</p><p id="50cb" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">干杯👏<br/> <strong class="md je">索尔·多比拉斯</strong></p></div><div class="ab cl qd qe hy qf" role="separator"><span class="qg bw bk qh qi qj"/><span class="qg bw bk qh qi qj"/><span class="qg bw bk qh qi"/></div><div class="in io ip iq ir"><p id="b6b3" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> <em class="ns">如果你已经花光了这个月的学习预算，下次请记得我。</em> </strong> <em class="ns">我的个性化链接加入媒介是:</em></p><div class="qk ql gq gs qm qn"><a href="https://solclover.com/membership" rel="noopener  ugc nofollow" target="_blank"><div class="qo ab fp"><div class="qp ab qq cl cj qr"><h2 class="bd je gz z fq qs fs ft qt fv fx jd bi translated">通过我的推荐链接加入Medium索尔·多比拉斯</h2><div class="qu l"><h3 class="bd b gz z fq qs fs ft qt fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="qv l"><p class="bd b dl z fq qs fs ft qt fv fx dk translated">solclover.com</p></div></div><div class="qw l"><div class="qx l qy qz ra qw rb lc qn"/></div></div></a></div></div><div class="ab cl qd qe hy qf" role="separator"><span class="qg bw bk qh qi qj"/><span class="qg bw bk qh qi qj"/><span class="qg bw bk qh qi"/></div><div class="in io ip iq ir"><p id="fae4" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">您可能感兴趣的其他文章:</p><div class="qk ql gq gs qm qn"><a rel="noopener follow" target="_blank" href="/t-sne-machine-learning-algorithm-a-great-tool-for-dimensionality-reduction-in-python-ec01552f1a1e"><div class="qo ab fp"><div class="qp ab qq cl cj qr"><h2 class="bd je gz z fq qs fs ft qt fv fx jd bi translated">t-SNE机器学习算法Python中降维的利器</h2><div class="qu l"><h3 class="bd b gz z fq qs fs ft qt fv fx dk translated">如何使用t分布随机邻居嵌入(t-SNE)来可视化高维数据？</h3></div><div class="qv l"><p class="bd b dl z fq qs fs ft qt fv fx dk translated">towardsdatascience.com</p></div></div><div class="qw l"><div class="rc l qy qz ra qw rb lc qn"/></div></div></a></div><div class="qk ql gq gs qm qn"><a rel="noopener follow" target="_blank" href="/lle-locally-linear-embedding-a-nifty-way-to-reduce-dimensionality-in-python-ab5c38336107"><div class="qo ab fp"><div class="qp ab qq cl cj qr"><h2 class="bd je gz z fq qs fs ft qt fv fx jd bi translated">LLE:局部线性嵌入Python中降维的好方法</h2><div class="qu l"><h3 class="bd b gz z fq qs fs ft qt fv fx dk translated">详细介绍了LLE的工作原理，以及它与Isomap等类似算法的比较</h3></div><div class="qv l"><p class="bd b dl z fq qs fs ft qt fv fx dk translated">towardsdatascience.com</p></div></div><div class="qw l"><div class="rd l qy qz ra qw rb lc qn"/></div></div></a></div></div></div>    
</body>
</html>