<html>
<head>
<title>Automated Marketing Mix Modeling with Facebook Experimental’s Robyn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">脸书实验公司的Robyn为自动化营销组合建模</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automated-marketing-mix-modeling-with-facebooks-robyn-fd79e60b489d?source=collection_archive---------1-----------------------#2021-08-27">https://towardsdatascience.com/automated-marketing-mix-modeling-with-facebooks-robyn-fd79e60b489d?source=collection_archive---------1-----------------------#2021-08-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d0ca" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">营销组合建模的新工具概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d36718475ada61f9270add78c1c68d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5rXejhcKLorK7JiXnQH-tg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@homajob" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照。</p></figure><p id="0420" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章为你提供了脸书实验的罗宾的第一个概述。由于脸书营销科学团队已经创建了一个很棒的<a class="ae ky" href="https://facebookexperimental.github.io/Robyn/docs/quick-start" rel="noopener ugc nofollow" target="_blank">快速入门指南</a>和<a class="ae ky" href="https://facebookexperimental.github.io/Robyn/docs/step-by-step-guide" rel="noopener ugc nofollow" target="_blank">非常详细的页面</a>，我尽量保持文章简短切题。详细解释可以在这里找到更多<a class="ae ky" href="https://facebookexperimental.github.io/" rel="noopener ugc nofollow" target="_blank">信息。</a></p><h2 id="2e7b" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">TL；博士</strong></h2><ul class=""><li id="fbfc" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu mv mw mx my bi translated">脸书实验公司的Robyn是一个自动营销组合建模(MMM)代码，目前处于测试版。</li><li id="8585" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">它为特征转换提供了两种adstock(几何和威布尔)和一种s曲线转换(收益递减)技术。</li><li id="c661" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">为了考虑时间序列的特征，罗宾使用了脸书先知。</li><li id="d95d" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">它利用脸书的<a class="ae ky" href="https://facebookresearch.github.io/nevergrad/" rel="noopener ugc nofollow" target="_blank"> Nevergrad无梯度优化平台</a>生成一组Pareto最优模型解。</li><li id="02ae" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">为了增加模型的准确性，它允许你包含随机控制实验的结果。</li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="007d" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">在我们开始之前…为什么MMM如此重要？</h1><p id="5935" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">每个营销人员都有两个大问题:我当前的营销渠道有什么影响？和<em class="nz">我应该如何战略性地分配我的预算</em>以获得最佳营销组合？</p><p id="9111" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些问题并不新鲜。约翰·沃纳梅克(1838-1922)被一些人认为是市场营销的先驱，他也有同样的问题，并因其著名的经常被引用的名言而闻名:</p><blockquote class="oa"><p id="5279" class="ob oc it bd od oe of og oh oi oj lu dk translated">我一半的广告支出都浪费了；问题是，我不知道是哪一半。</p></blockquote><p id="c840" class="pw-post-body-paragraph kz la it lb b lc ok ju le lf ol jx lh li om lk ll lm on lo lp lq oo ls lt lu im bi translated">为了应对这些挑战，计量经济学家开发了被称为营销组合建模(MMM)的多元回归技术。这个领域的一个非常新的工具是脸书的Robyn，目前它还处于测试阶段。脸书实验小组将罗宾描述为</p><blockquote class="op oq or"><p id="4ecd" class="kz la nz lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">[……]自动化营销组合建模(MMM)代码。它旨在通过岭回归和进化算法减少人为偏差，通过提供预算分配器和收益递减曲线实现可操作的决策制定，并允许对因果关系进行地面实况校准。</p></blockquote><p id="a3aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下文中，我会给你一个Robyn的功能和主要思想的快速概述。由于它仍处于测试版本，所使用的代码和概念可能会发生变化。你可以在这里找到它的最新版本。</p><h1 id="3620" class="nl lw it bd lx nm ov no ma np ow nr md jz ox ka mg kc oy kd mj kf oz kg mm nv bi translated">使用的数据集</h1><p id="2b23" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">为这篇文章找到一个合适的开放数据集是相当棘手的，所以我使用谷歌的<a class="ae ky" href="https://github.com/google/amss" rel="noopener ugc nofollow" target="_blank">aggregate营销系统模拟器</a> (AMSS)来生成一个简单的数据集。如果你对AMSS的更多细节感兴趣，你可以在这里找到他们的论文<a class="ae ky" href="https://research.google/pubs/pub45996/" rel="noopener ugc nofollow" target="_blank">，如果你想用我用过的数据集，你可以在这里</a><a class="ae ky" href="https://github.com/darinkist/medium_article_robyn/blob/main/simulated_marketing_data.csv" rel="noopener ugc nofollow" target="_blank">找到</a>。</p><p id="e641" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将在下面找到营销数据的描述表和图表，以便更好地熟悉数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/70bbb58739ae24d6a09f911ffe51c2e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-vfrOJc4ao5VMHTP469R9g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表1。数据集的描述性指标(图片由作者提供)。</p></figure><p id="a978" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用的数据集基于每周数据，包含208个条目。所有数值均以欧元(€)为单位，不存在北美数值。我们的<strong class="lb iu">目标变量</strong>是<strong class="lb iu">收入</strong>，而其他列是可以用来解释它的特性。</p><p id="a0df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以<strong class="lb iu"> _S </strong>结尾的栏目是我们按渠道(电视、广播、付费搜索)划分的营销预算支出。我们的竞争对手销售额由自我解释栏<strong class="lb iu">竞争对手_销售额</strong>给出。</p><p id="1334" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">描述表中没有显示的一列是<strong class="lb iu">日期</strong>列，以格式<em class="nz"> YYYY-MM-DD </em>表示相应的周。</p><p id="61c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图1显示了一段时间内的收入、收入构成、竞争对手的销售和营销费用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/320b2d980af92d528c05aa4cfbbf0062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76OjwTtZrYpdRdIMBEnU4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图一。收入、收入构成、销售和支出随时间变化的可视化(图片由作者提供)。</p></figure><p id="d4bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以清楚地看到收入的季节性(A1)以及一点趋势(A2)。还可以看到，竞争对手的销售遵循与我们的收入非常相似的模式，我们在春季的广播费用和季节性以及付费搜索费用的趋势方面存在差距。</p><p id="6a53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图2显示了我们的数据集的相关图，以初步了解变量之间的关系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/6e57b65c6d919155b65cbc6b32b30c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AjsQ372EzFFeoptztY2QrA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图二。我们数据集的相关图(图片由作者提供)。</p></figure><p id="bee8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到竞争对手的销售额和我们的收入之间有很高的相关性，其次是我们的付费搜索费用和我们的收入以及竞争对手的销售额之间的相关性较低，为0.4。</p><p id="db26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您对数据集稍微熟悉了一些，让我们现在使用Robyn。</p><h1 id="f2c4" class="nl lw it bd lx nm ov no ma np ow nr md jz ox ka mg kc oy kd mj kf oz kg mm nv bi translated">建立我们的MMM项目</h1><p id="bf2c" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">为了获得Robyn的最新版本，我们将它的存储库克隆到我们的机器上:</p><pre class="kj kk kl km gt pd pe pf pg aw ph bi"><span id="1606" class="lv lw it pe b gy pi pj l pk pl">git clone https://github.com/facebookexperimental/Robyn</span></pre><p id="bf65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们克隆了存储库之后，我们创建了一个名为<strong class="lb iu"> plots </strong>的<strong class="lb iu">新文件夹</strong>来存储后来结果的可视化。</p><p id="722e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的文件夹结构现在应该如下所示:</p><pre class="kj kk kl km gt pd pe pf pg aw ph bi"><span id="cfea" class="lv lw it pe b gy pi pj l pk pl">Robyn/<br/>├── <em class="nz">CHANGELOG.md</em><br/>├── <em class="nz">CODE_OF_CONDUCT.md</em><br/>├── <em class="nz">CONTRIBUTING.md</em><br/>├── <em class="nz">LICENSE.md</em><br/>├── <em class="nz">README.md</em><br/>├── <strong class="pe iu">Robyn.Rproj<br/></strong>├── <strong class="pe iu">plots<br/></strong>├── <strong class="pe iu">source</strong><br/>│   ├── <em class="nz">de_simulated_data.csv</em><br/>│   ├── <strong class="pe iu">fb_robyn.exec.R</strong><br/>│   ├── <em class="nz">fb_robyn.func.R</em><br/>│   ├── <em class="nz">fb_robyn.optm.R</em><br/>│   └── <em class="nz">holidays.csv</em><br/>├── <em class="nz">website</em></span></pre><p id="1123" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们感兴趣的主文件位于<strong class="lb iu">源文件夹</strong>中，名为<strong class="lb iu"> fb_robyn.exec.R </strong>。这是我们必须设置配置和运行争论、建模、优化以及预算分配(如果需要)流程的文件。</p><p id="2791" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在我们去那里之前，让我们简短地看一看Robyn使用了什么(建模)技术。</p><h1 id="3c75" class="nl lw it bd lx nm ov no ma np ow nr md jz ox ka mg kc oy kd mj kf oz kg mm nv bi translated">罗宾的技术</h1><p id="45e6" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">以下几点从较高的层面描述了罗宾的内心世界。有关更多详细信息和解释，请参见他们的<a class="ae ky" href="https://facebookexperimental.github.io/Robyn/docs/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h2 id="b9ad" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">岭回归</strong></h2><p id="2eb1" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">开发人员使用正则化方法的动机是解决许多回归变量之间的多重共线性，并防止模型过度拟合。图3显示了该模型的方程以及函数的主要组成部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/aa59716b7108e9d09834dcc534abf2bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ux-La8zjz51eK2OmAus5gQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3。通过<a class="ae ky" href="https://facebookexperimental.github.io/Robyn/docs/ridge-regression" rel="noopener ugc nofollow" target="_blank">Facebook experiment</a>建立模型方程。</p></figure><p id="2e5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中yₜ是我们的因变量<strong class="lb iu">在时间<em class="nz"> t </em>的收入</strong>。自变量由<strong class="lb iu">截距</strong>定义，随后是<strong class="lb iu"> ad-stock </strong>和<strong class="lb iu"> s曲线</strong> <strong class="lb iu">变换分量</strong>用于每种媒体<em class="nz"> j </em>。<strong class="lb iu">节假日</strong>、<strong class="lb iu">季节性</strong>和<strong class="lb iu">趋势</strong>效果分别用<em class="nz">节假日</em>、<em class="nz">节假日</em>和<em class="nz">趋势</em>来表示。<strong class="lb iu">附加</strong> <strong class="lb iu">独立</strong> <strong class="lb iu">变量</strong>由<em class="nz">等</em>定义，后跟误差项<em class="nz"> ε </em>。</p><h2 id="df8f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">特征转换选项</h2><p id="cc3a" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">MMM中非常常见的转换技术是ad-stock和s曲线(收益递减)转换。</p><p id="c5c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">广告股票转型<br/> </strong>广告股票转型背后的想法是，广告效应通常<strong class="lb iu">不会立即</strong>生效。它们有一个<strong class="lb iu">半衰期</strong>。顾客(通常)不会在看到你的广告后立即跑到商店购买你的产品。你的广告需要一些时间来适应。</p><p id="71ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">罗宾在这里提供了两种方法，经典的几何方法和更灵活的T2威布尔生存函数。更深入的解释请见<a class="ae ky" href="https://facebookexperimental.github.io/Robyn/docs/variable-transformations" rel="noopener ugc nofollow" target="_blank">文件</a>。</p><p id="c99b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">S曲线(收益递减)转变<br/> 这种转变背后的基本思想是，随着时间的推移，广告会失去其有效性，即使给它分配了更多的钱。</p><h2 id="f9e9" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">趋势、季节性和假日效应</h2><p id="1765" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">为了在模型中包含趋势、季节性或假日等时间序列特征或成分，Robyn使用了Facebook<a class="ae ky" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">Prophet</a>。</p><h2 id="6403" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">自动化超参数选择和优化</h2><p id="c84e" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">Robyn使用<a class="ae ky" href="https://facebookresearch.github.io/nevergrad/" rel="noopener ugc nofollow" target="_blank">脸书的Nevergrad无梯度优化平台</a>执行多目标优化，通过提供一组帕累托最优模型解决方案来平衡支出份额和渠道系数分解份额之间的关系。</p><p id="975a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些帕累托最优模型解是多次迭代(即，20，000次迭代和可能的模型解)运行进化算法(自然选择)的结果</p><h2 id="7cd4" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">使用实验结果进行校准</h2><p id="96db" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">Robyn允许我们应用随机控制实验的结果来提高模型的准确性，其中这些结果被用作缩小媒体变量系数的先验。</p><p id="11f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这部分内容不在本文讨论范围内。如果你对更多细节感兴趣，你可以在这里找到他们的<a class="ae ky" href="https://facebookexperimental.github.io/Robyn/docs/calibration" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h1 id="0073" class="nl lw it bd lx nm ov no ma np ow nr md jz ox ka mg kc oy kd mj kf oz kg mm nv bi translated">MMM配置</h1><p id="88fe" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">现在我们对Robyn的技术有了一个基本的概述，让我们继续我们的用例。您将在本文末尾找到完整的代码。</p><p id="462d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们经营罗宾。使用R-Studio运行Rproj，并打开位于源文件夹中的fb_robyn.exec.R。</p><h2 id="e4e2" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">避免时间序列特征的错误</strong></h2><p id="81f1" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">如果您的操作系统不是英语，您应该做的第一件事是取消第13行的注释:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="89ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">否则，您将在数据争论过程中出错(第166行)。</p><h2 id="abcb" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">安装并加载库</strong></h2><p id="adaa" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">确保安装所有使用的库，创建一个名为<em class="nz"> r-reticulate的conda环境，安装</em> nevergrad并使用创建的conda env。</p><h2 id="68e5" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">加载数据</h2><p id="f42a" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">现在是时候加载我们的csv文件了。开发团队已经提供了一个名为de_simulated_data.csv的文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="b540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开发团队还提供了一个假日文件，其中包括几个国家(如美国、英国、印度、德国)的公共假日。</p><h2 id="39fb" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">设置模型输入变量</h2><p id="e622" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">在这一部分，我们将代码中的配置链接到数据集中的列。这一部分非常重要，因为在自动化数据争论过程中，打字错误会导致错误。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure><h2 id="49d1" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">设置全局模型参数</h2><p id="997b" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">Robyn允许我们使用<strong class="lb iu">几何</strong>或<strong class="lb iu">威布尔</strong>股票技巧。在本文中，我们将继续使用几何方法，但是尝试一下威布尔技术绝对是值得的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="ab5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于Robyn使用Nevergrad，我们必须选择一种算法以及试验次数。这里我们也坚持默认的。</p><h2 id="aba2" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">设置超参数界限</h2><p id="a9d4" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">根据我们定义的变量和使用的ad-stock方法，我们必须设置它们的超参数界。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure><h2 id="3f49" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">运行模型</h2><p id="73bd" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">现在我们已经设置了所有的参数，我们可以使用下面的代码来运行我们的模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="27a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Robyn现在正在运行，并将在我们指定的<strong class="lb iu">绘图文件夹</strong>中自动生成绘图。</p><h2 id="f5f0" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">输出和诊断</h2><p id="a051" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">建模过程完成后，您应该在plots文件夹中找到几个文件。</p><p id="71cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些图(以模型id作为其名称)代表基于Pareto最优过程(pareto_front.png)的最优模型解决方案，并为我们提供关于超参数选择(hypersampling.png)的附加信息。</p><p id="d5e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图4。显示了其中一种型号(3_30_1)的单页型号。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/64aca483294dd726c0b07114a7b84719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*45nzC5xd7jXYWi_GGq33Og.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4。单页纸模型(图片由作者提供)。</p></figure><p id="68cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">响应分解瀑布通过预测器</strong> <br/>显示每个特性对响应变量(收入)影响的百分比。在本例中，34.08%的收入可归因于季节性，11.62%可归因于电视广告等。</p><p id="b0c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">支出份额与效果份额<br/> </strong>该图描述了各渠道的支出份额和效果份额。除此之外，它还显示了每个渠道的投资回报率(ROI)。对于我们的例子，我们可以看到频道广播的投资回报率最高，其次是电视和付费搜索。这也表明，电视上的平均费用比他们的平均效果份额大一点。这可能意味着他们正遭遇一些收益递减。</p><p id="fa72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">平均广告库存衰减率<br/> </strong>显示每个渠道的百分比衰减率。衰变率越高，衰变效应持续的时间越长。对于这个例子，频道TV具有最高的平均衰减率。</p><p id="d715" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">实际响应与预测响应<br/> </strong>该图将实际响应与我们的预测进行比较。我们的目标是我们的模型能够解释数据中的大部分差异。因此，我们寻求高R平方(rsq)和低NRMSE。</p><p id="31c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">响应曲线和渠道平均支出<br/> </strong>表明每个渠道的饱和程度，并可能建议潜在的预算再分配策略。观察这些曲线，它们到达拐点和平坡的速度越快，每增加一次€消耗，它们就越快饱和。对于我们的例子，广播和付费搜索的曲线没有显示任何平坦的斜率，可能需要进一步的调查。</p><p id="f2b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">拟合与残差<br/> </strong>经典图表检查我们的回归模型是否有问题。</p><h2 id="4164" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">模拟预算分配</h2><p id="be47" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">一旦我们决定了一个合理的(！！)模型，我们可以运行预算优化模拟来计算最佳媒体支出分配。我们有两种类型的模拟场景:</p><ul class=""><li id="294c" class="mo mp it lb b lc ld lf lg li pp lm pq lq pr lu mv mw mx my bi translated">max _ historical _ response</li><li id="bce3" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">最大响应预期花费</li></ul><p id="99b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个将使用对模型有贡献的历史数据和花费来计算最佳媒体计划。</p><p id="df95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个是在给定预算和天数的情况下计算最佳媒体计划。</p><p id="57f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有的模型都存储在<em class="nz">model _ output _ collect $ all solutions</em>变量中。假设我们想使用上面的模型(3_30_1 ),我们只需使用以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="5be5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了模型id和场景类型之外，我们还必须为我们使用的通道设置下限和上限。如果我们渠道的下限是0.7，上限是1.2，那么我们的花费变化将受到平均时间段花费的0.7倍和平均时间段花费的1.2倍的约束。</p><p id="c599" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行该代码后，Robyn输出一个新的单页页面(图5)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/b000f9d6f4665796cff274dce22d0608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4WAQNRA8Bk9ULgpqAs9lA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5。预算分配器最佳结果单页纸(图片由作者提供)。</p></figure><p id="4276" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">左图显示了如果我们遵循预算优化，预算分配和平均反应将如何变化。右侧的图表显示了每个渠道的响应曲线，以及初始平均支出水平与推荐平均支出水平的对比。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="4b64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章的想法是向您提供脸书实验的Robyn的第一个概述，以及如何通过使用简化的数据集来使用它。对于更深入的解释，实验结果的使用，以及更多的细节，我强烈建议你查阅<a class="ae ky" href="https://facebookexperimental.github.io/Robyn/" rel="noopener ugc nofollow" target="_blank"> Robyn的文档</a>。</p><p id="74c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与这个简短的介绍不同，在型号选择部分投入时间和精力也很重要。<strong class="lb iu">只有使用合理的模型，与企业讨论结果并使用预算优化步骤才有意义。</strong></p><p id="1b8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使该项目仍处于测试阶段，但其背后的动机和想法及其功能非常巧妙，令人印象深刻！</p><p id="1085" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我可以许三个愿望，我希望有一个选择，对横截面数据使用面板回归。其次，找到一种减少计算时间的方法也是很棒的。第三，类似于第一个愿望，不仅仅使用分类变量作为基线变量会很好。...如果我能做第四个Python的移植会很棒；)</p><p id="89bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整文件的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pn po l"/></div></figure></div></div>    
</body>
</html>