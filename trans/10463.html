<html>
<head>
<title>3 Tricks For Manipulating Pandas Dataframes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">操纵熊猫数据帧的3个技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-tricks-for-manipulating-pandas-dataframes-c7933a56b6e0?source=collection_archive---------24-----------------------#2021-10-05">https://towardsdatascience.com/3-tricks-for-manipulating-pandas-dataframes-c7933a56b6e0?source=collection_archive---------24-----------------------#2021-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b53b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">发掘熊猫的全部潜力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9d00d3b3b30787660e8d1f660f89a3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ztbMa6QT9TsT6OI-O-liOg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@little_klein?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">维托达·克莱恩</a>在<a class="ae ky" href="https://unsplash.com/s/photos/trick?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="c6da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是数据科学生态系统中使用最广泛的库之一。它为有效的数据分析和操作提供了许多功能和方法。</p><p id="8fe4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">阅读整个文档并试图一次了解所有的功能和方法并不是掌握Pandas的明智方法。相反，通过解决任务和问题来学习效率要高得多。</p><p id="e9f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将解决3个涉及操作数据框的任务。用于解决这些任务的方法也将有助于其他一些任务。</p><p id="9ba4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将利用NumPy函数，所以让我们从导入两个库开始。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d56a" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span></pre></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="4085" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">堆叠数据框</h1><p id="c1d7" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">假设我们有以下数据帧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/9de8f5699eb47b85b623320ca7df0993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*88DgHw6DhEaDFKWRdSp6vA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="14f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要将它们组合成一个数据框。一种方法是使用熊猫的<code class="fe nk nl nm lw b">concat</code>功能。但是，它将为两个数据框中的每个列名创建一个单独的列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dd16" class="ma mb it lw b gy mc md l me mf">pd.concat([df1, df2, df3])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/2203e46423b533df78299360ace3945e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrGu-ItoQpp8esWtgDh8mQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="9555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们用这种方法组合几个数据框，我们最终会得到一个包含太多列的数据框。相反，我们想要的是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/e09a0050ea3ce191fbe7d1a9b4dd44db.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*Uu2neP17DXUY0Pq-JFayzQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="8e44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过使用NumPy的<code class="fe nk nl nm lw b">vstack</code>函数来创建它。以下代码片段生成了上述数据框。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9a45" class="ma mb it lw b gy mc md l me mf">pd.DataFrame(np.vstack([<br/>    df1.columns, df1, <br/>    df2.columns, df2, <br/>    df3.columns, df3]))</span></pre><p id="21c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以用<code class="fe nk nl nm lw b">columns</code>参数指定列名。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4541" class="ma mb it lw b gy mc md l me mf">df = pd.DataFrame(<br/>    np.vstack([df1.columns, df1, <br/>               df2.columns, df2,<br/>               df3.columns, df3]),<br/>    columns = ["product_code","msr1","msr2","msr3"]<br/>)</span><span id="95d7" class="ma mb it lw b gy np md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/e4ffbbe0af8779c51e310457498ac6c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*uN0_4MF_I2_UU_YHmgGG0Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="1aff" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">选择每隔一行</h1><p id="a6da" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">让我们看一下刚刚创建的数据框。第一、第三和第五行不包含数值。它们表示测量的种类。</p><p id="222c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于某种原因，我们希望只选择包含数值的行。因此，从第二行开始，我们需要每隔一行。</p><p id="b818" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas的<code class="fe nk nl nm lw b">iloc</code>方法在如何从数据帧中选择行和列方面非常灵活。我们可以指定起始和结束索引以及步长。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1afb" class="ma mb it lw b gy mc md l me mf">df.iloc[1::2]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f769db1f2c93780ca7c37868d2bfc066.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*y7SN52DhD_JrK3GZ6N4zTw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="09b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个和第二个数字分别是起始和结束索引。因为我们想一直走到最后一行，所以我们不必指定结束索引，所以它保留为空。最后一个数字是步长。如果我们需要选择每第三行，步长变为3，依此类推。</p><p id="ec95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nk nl nm lw b">iloc</code>方法还允许使用列索引来选择列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d32e" class="ma mb it lw b gy mc md l me mf">df.iloc[1::2, :3]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/421f78bb0310cfbe3ca267cabdb74a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*xr9DoMb_cbZqNUO2-1oEqQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="80c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">逗号后面的数字指定要选择的列。“:3”表达式表示从开头开始选择第三列。我们也没有指明步长，所以使用默认值1。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="48dc" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">在特定位置创建新列</h1><p id="9292" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">向数据框添加新列是一种常见的操作。Pandas使得创建新列变得非常简单。</p><p id="cd46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一种方法是写一个列名并分配一个常数值。让我们在数据框中添加一个日期列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="13bb" class="ma mb it lw b gy mc md l me mf">df["date"] = "2021-10-05"</span><span id="1889" class="ma mb it lw b gy np md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/028cb228cf8d5e09fa61123612801671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*NV6uTZ9wl0o7liVRue8loA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="3288" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，新列添加在末尾。如果我们想在特定的列索引处添加一个新列，我们应该使用<code class="fe nk nl nm lw b">insert</code>函数。</p><p id="541f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下代码片段在数据框的开头创建了一个新的日期列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="adec" class="ma mb it lw b gy mc md l me mf">df.insert(0, "new_date", "2021-10-05")</span><span id="2b3d" class="ma mb it lw b gy np md l me mf">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/fe212bcf76deadb4ea061c708fc34dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCFTE5q06UJYtt6-Wc2IyQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f301" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个参数是新列的索引。第二个参数是列名，最后一个参数定义列值。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="6ae3" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">结论</h1><p id="e1a3" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">在处理表格数据时，Pandas很有可能为您的任务或问题提供解决方案。当你练习和解决熊猫的问题时，你会发现这个神奇图书馆的伟大之处。</p><p id="d60d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和其他软件工具一样，学习熊猫的最好方法是练习。阅读整个文档而不做任何练习只能让你达到一定的水平。你应该通过大量的练习来支持它。</p><p id="5e29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>