<html>
<head>
<title>A Template for Writing Quick Machine Learning Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写快速机器学习应用程序的模板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-template-for-writing-quick-machine-learning-apps-7c7b8bdfeb91?source=collection_archive---------38-----------------------#2021-06-21">https://towardsdatascience.com/a-template-for-writing-quick-machine-learning-apps-7c7b8bdfeb91?source=collection_archive---------38-----------------------#2021-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/88c477a14140982a8dd451d03894ec2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mYor8_4KDm3Mv1zm"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jg" href="https://unsplash.com/@cookiethepom?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Cookie Pom</a>拍摄的照片</p></figure><div class=""/><div class=""><h2 id="6766" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使用PyTorch和Streamlit加速您的机器学习原型</h2></div><h1 id="2ffe" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">ML应用原型</h1><p id="eb11" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">开发一个机器学习模型的过程可以是很多事情:从一个有益的学习体验，到一个可怕和令人沮丧的低准确性和调试噩梦的过程。机器学习工作流程的一个方面曾经很棘手，那就是原型阶段，在这个阶段，我们希望有一个简单的界面来展示我们模型的功能。</p><p id="da02" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">编写数据应用程序的框架Streamlit填补了这一空白，它让人们能够尽快赋予他们的人工智能模型生命，而无需编写成熟的GUI。</p><p id="f9a6" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在这篇文章中，我将向你展示一个用Streamlit和Pytorch编写简单ML应用程序的模板。 </p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="7550" class="ky kz jj bd la lb mz ld le lf na lh li kp nb kq lk ks nc kt lm kv nd kw lo lp bi translated">从模型到原型</h1><p id="09ff" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在这个例子中，我们将编写一个简单的图像分类应用程序。编写人工智能应用程序的步骤如下:</p><ol class=""><li id="1530" class="ne nf jj ls b lt mm lw mn lz ng md nh mh ni ml nj nk nl nm bi translated"><strong class="ls jk">导入依赖关系</strong></li></ol><figure class="nn no np nq gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="df54" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">2.<strong class="ls jk">写一个标题，顶部有一个漂亮的标志图像</strong></p><figure class="nn no np nq gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="0839" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls jk">输出:</strong></p><figure class="nn no np nq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nt"><img src="../Images/fe8cc20d56cc88fb81df9b51c6cdaff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gxc-QT5H4Fm3UR8qiPzYIA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供。来自Unsplash的Jason Leung的标识</p></figure><p id="7479" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls jk"> 3。设置文件上传程序以加载图像</strong></p><figure class="nn no np nq gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2f5d" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls jk">输出:</strong></p><figure class="nn no np nq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/94926fad68c5efbb1bac7b91a5b174f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9WKotjIDVJHQ7jXweskJIQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供。来自Unsplash的Jason Leung的标识</p></figure><p id="9bca" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">4.<strong class="ls jk">编写一个脚本，加载一个预先训练好的模型来运行推理</strong></p><p id="7698" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在这里，我们可以将训练模型的权重放在一个文件夹中，或者从标准库中加载一个预训练模型。在这个例子中，我们将使用<a class="ae jg" href="https://pytorch.org" rel="noopener ugc nofollow" target="_blank"> PyTorch库</a>加载<a class="ae jg" href="https://pytorch.org/hub/pytorch_vision_resnet/" rel="noopener ugc nofollow" target="_blank"> Resnet </a>模型。</p><p id="314c" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在此之前，我们需要下载imagenet类:</p><pre class="nn no np nq gt nv nw nx ny aw nz bi"><span id="43d4" class="oa kz jj nw b gy ob oc l od oe"># source: <a class="ae jg" href="https://pytorch.org/hub/pytorch_vision_resnet/" rel="noopener ugc nofollow" target="_blank">https://pytorch.org/hub/pytorch_vision_resnet/</a><br/>!wget https://raw.githubusercontent.com/pytorch/hub/master/imagenet_classes.txt</span></pre><p id="f50d" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在，我们可以编写加载模型和运行推理的脚本了:</p><figure class="nn no np nq gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="adee" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在这里，我们在图像上做一些基本的转换，比如调整大小，裁剪，然后把它输入到我们的模型中。我们在这里创建的函数<code class="fe of og oh nw b">predict()</code>将从我们的主应用程序中调用，如下所示:</p><figure class="nn no np nq gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="fc1e" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">5.<strong class="ls jk">加载测试图像</strong></p><p id="b8cb" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">为了加载样本图像进行测试，我们将使用与本<a class="ae jg" href="https://pytorch.org/hub/pytorch_vision_resnet/" rel="noopener ugc nofollow" target="_blank"> Pytorch教程</a>中相同的示例，</p><figure class="nn no np nq gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="cd75" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">最终的应用程序如下所示:</p><figure class="nn no np nq gt iv gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/bc4b2552e837b632c858dda4bd89290a.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*CLWG09ar4Na4CV7T3JHzaw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供。来自Unsplash 的<a class="ae jg" href="https://unsplash.com/photos/81rOS-jYoJ8" rel="noopener ugc nofollow" target="_blank"> Jason Leung的Logo</a></p></figure><p id="30b6" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以看到底部的分类是<em class="mr">萨摩耶，</em>这是我们讨论的狗的品种。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="6ce0" class="ky kz jj bd la lb mz ld le lf na lh li kp nb kq lk ks nc kt lm kv nd kw lo lp bi translated">关于人工智能应用的最后一点说明</h1><p id="8e31" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在本教程中，希望你学会了如何编写一个简单的人工智能应用程序来使用Streamlit和Pytorch对图像进行分类，你可以在这里找到完整的源代码<a class="ae jg" href="https://github.com/EnkrateiaLucca/streamlit_template_app" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="4143" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在本文中，您了解了:</p><ul class=""><li id="55d7" class="ne nf jj ls b lt mm lw mn lz ng md nh mh ni ml oj nk nl nm bi translated">如何用Streamlit写一个简单的图像分类app</li><li id="b3be" class="ne nf jj ls b lt ok lw ol lz om md on mh oo ml oj nk nl nm bi translated">如何设置一个脚本，用Pytorch加载一个预先训练好的模型进行推理</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="061a" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果你喜欢这篇文章，请在<a class="ae jg" href="https://twitter.com/LucasEnkrateia" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae jg" href="https://www.linkedin.com/in/lucas-soares-969044167/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae jg" href="https://www.instagram.com/theaugmentedself/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上联系我，并在<a class="ae jg" href="https://lucas-soares.medium.com/" rel="noopener"> Medium </a>上关注我。谢谢，下次再见！:)</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="06f6" class="ky kz jj bd la lb mz ld le lf na lh li kp nb kq lk ks nc kt lm kv nd kw lo lp bi translated">参考</h1><ul class=""><li id="7647" class="ne nf jj ls b lt lu lw lx lz op md oq mh or ml oj nk nl nm bi translated"><a class="ae jg" href="https://pytorch.org/hub/pytorch_vision_resnet/" rel="noopener ugc nofollow" target="_blank"> Pytorch Vision ResNet </a></li><li id="555f" class="ne nf jj ls b lt ok lw ol lz om md on mh oo ml oj nk nl nm bi translated"><a class="ae jg" href="https://streamlit.io" rel="noopener ugc nofollow" target="_blank">流线</a></li><li id="7e25" class="ne nf jj ls b lt ok lw ol lz om md on mh oo ml oj nk nl nm bi translated">Pytorch </li></ul></div></div>    
</body>
</html>