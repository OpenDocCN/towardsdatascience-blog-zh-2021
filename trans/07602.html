<html>
<head>
<title>Change Column Data Type in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Pandas中更改列数据类型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/change-column-data-type-in-pandas-954d7acdef1d?source=collection_archive---------11-----------------------#2021-07-12">https://towardsdatascience.com/change-column-data-type-in-pandas-954d7acdef1d?source=collection_archive---------11-----------------------#2021-07-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f6e0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">使用PYTHON进行动手数据分析</h2><div class=""/><div class=""><h2 id="5e1b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">举例说明-。astype()，。convert_dtypes()和. to_numeric()</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/cf84d1209423c9bc11040eead84a0a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qZF8VGkfxi35Zb2K"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">克里斯·劳顿在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="b416" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">处理数据很少是直截了当的。大多数情况下，需要对导入的数据集执行各种转换，以便于分析。</p><p id="4f85" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我的所有项目中，pandas从来没有为导入的数据集的所有列检测到正确的数据类型。但同时，Pandas提供了一系列方法来轻松转换列数据类型。</p><p id="12b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这里，您将获得在Pandas中改变一个或多个列的数据类型的所有方法，当然还有它们之间的比较。</p><p id="3c88" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在整个阅读过程中，资源用📚，快捷方式用⚡️表示，<strong class="lk jd"> <em class="me">外卖</em> </strong>用表示📌。不要忘记查看一个有趣的💡在这篇文章的结尾。</p><p id="7531" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以快速跟随本<a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/ChangeColDataType_tds.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> <em class="me">笔记本</em> </strong> </a>📌。</p><p id="8d51" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了让您更容易理解，让我们创建一个简单的数据框架。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mf"><img src="../Images/fbe4a46d608a470229dc17c716808ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nu31tGizY8zCNjzJdgSh5Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">熊猫数据框|作者图片</p></figure><p id="d2d8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用这个例子，将更容易理解——如何在Pandas中更改列的数据类型。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="2d61" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">熊猫。DataFrame.astype()</h1><p id="509e" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">此方法用于将特定的数据类型分配给DataFrame列。<br/>让我们将<code class="fe nk nl nm nn b"><strong class="lk jd">int64</strong></code>指定为列<code class="fe nk nl nm nn b">Year</code>的数据类型。使用命令<code class="fe nk nl nm nn b"><strong class="lk jd">.head()</strong></code>和<code class="fe nk nl nm nn b"><strong class="lk jd">.info()</strong></code>，可以快速查看生成的数据帧。</p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="cc6d" class="ns mo it nn b gy nt nu l nv nw">df1 = df.copy()<br/>df1["Year"] = df1["Year"].astype("int64")<br/>df1.head()<br/>df1.info()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/40208cd6326eb180a1b88e5f67d7aaf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ucuM0iPXK4a169_DXM0dg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者更改单列|图像的数据类型</p></figure><p id="8fd0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">类似地，可以将该列更改为Python中任何可用的数据类型。但是，如果数据类型不适合该列的值，默认情况下该方法会抛出一个<code class="fe nk nl nm nn b"><strong class="lk jd">ValueError</strong></code>。</p><blockquote class="ny nz oa"><p id="1712" class="li lj me lk b ll lm kd ln lo lp kg lq ob ls lt lu oc lw lx ly od ma mb mc md im bi translated">憎恨价值观错误？？？</p></blockquote><p id="e7a0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">熊猫有解决办法。此方法中的第二个可选参数μ. e .<code class="fe nk nl nm nn b"><strong class="lk jd">errors</strong></code>让您可以自由处理错误。此选项默认为raise，这意味着引发错误并且不返回任何输出。简单地说，将<code class="fe nk nl nm nn b"><strong class="lk jd">‘ignore’</strong></code> <strong class="lk jd"> </strong>赋给这个参数，忽略错误并返回原始值。</p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="e10f" class="ns mo it nn b gy nt nu l nv nw">df1["Car"] = df1["Car"].astype("int64", errors='ignore')</span></pre><p id="a693" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">❓ <em class="me">想一次改变所有列的数据类型</em> ❓</p><p id="433a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">⚡️只是将列名和数据类型对的字典传递给这个方法，问题就解决了。</p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="e4ba" class="ns mo it nn b gy nt nu l nv nw">df1 = df1.astype({"Year": "complex", "Rating": "float64",\<br/>                  "Car": 'int32'}, errors='ignore')</span></pre><p id="ef90" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">更简单的是，通过在<code class="fe nk nl nm nn b"><strong class="lk jd">astype()</strong></code>中直接传递数据类型，为所有列分配一个数据类型，就像下面的例子。</p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="54c6" class="ns mo it nn b gy nt nu l nv nw">df1 = df1.astype("int64", errors='ignore')<br/>df1.head()<br/>df1.info()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/087cbfbd302b288828be742f07143a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7l9aUP35ehxZnFzvIb8lA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">一次更改所有列的数据类型|按作者排序的图像</p></figure><p id="65d7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如上图所示，<code class="fe nk nl nm nn b">Year</code>和<code class="fe nk nl nm nn b">Rating</code>列的<code class="fe nk nl nm nn b"><strong class="lk jd">Dtype</strong></code>被修改为<code class="fe nk nl nm nn b"><strong class="lk jd">int64</strong></code>，而其他非数字列的原始数据类型被返回而不抛出错误。</p><p id="6aaf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">📚<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> <em class="me">熊猫。data frame . as type</em></strong></a><strong class="lk jd"><em class="me">()</em></strong></p><h1 id="5aee" class="mn mo it bd mp mq oe ms mt mu of mw mx ki og kj mz kl oh km nb ko oi kp nd ne bi translated">pandas.to_DataType()</h1><p id="cdf7" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">好吧好吧，没有这样的方法叫做pandas.to_DataType()，但是，如果把DataType这个词换成想要的数据类型，就可以得到下面2个方法。</p><h2 id="f49c" class="ns mo it bd mp oj ok dn mt ol om dp mx lr on oo mz lv op oq nb lz or os nd iz bi translated">pandas.to_numeric()</h2><p id="7fb8" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">此方法用于将列的数据类型转换为数值类型。因此，根据列中的值，<code class="fe nk nl nm nn b"><strong class="lk jd">float64</strong></code>或<code class="fe nk nl nm nn b"><strong class="lk jd">int64</strong></code>将作为列的新数据类型返回。</p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="358a" class="ns mo it nn b gy nt nu l nv nw">df2 = df.copy()<br/>df2["Rating"]=pd.to_numeric(df2["Rating"])<br/>df2.info()</span></pre><h2 id="58ae" class="ns mo it bd mp oj ok dn mt ol om dp mx lr on oo mz lv op oq nb lz or os nd iz bi translated">pandas.to_datetime()</h2><p id="0c61" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">在这里，列被转换为DateTime数据类型。该方法接受10个可选参数来帮助您决定如何解析日期。</p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="5b5e" class="ns mo it nn b gy nt nu l nv nw">df2 = df.copy()<br/>df2["RealDate"] = pd.to_datetime(df2["Service"])<br/>df2.info()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/3e802452466c2fbb2aa49235df4f162d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvBK-GLNvtbSQQsAD5WqNA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">pandas.to_numeric()和pandas.to_datetime() |作者图片</p></figure><p id="c091" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">❓ <em class="me">需要一次改变多列的数据类型</em> ❓</p><p id="7d08" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">⚡ ️Use的方法<code class="fe nk nl nm nn b"><strong class="lk jd">.apply()</strong></code></p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="33e5" class="ns mo it nn b gy nt nu l nv nw">df2[["Rating", "Year"]] = df2[["Rating",\<br/>                               "Year"]].apply(pd.to_numeric)</span></pre><p id="cd99" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">类似于<code class="fe nk nl nm nn b"><strong class="lk jd">pandas.DataFrame.astype()</strong></code>，方法<code class="fe nk nl nm nn b"><strong class="lk jd">pandas.to_numeric()</strong></code>也给你处理错误的灵活性。</p><p id="7ea4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">📚<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_numeric.html" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd"><em class="me">pandas . to _ numeric()</em></strong></a><br/>📚<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd"><em class="me">pandas . to _ datetime()</em></strong></a></p><h1 id="48cf" class="mn mo it bd mp mq oe ms mt mu of mw mx ki og kj mz kl oh km nb ko oi kp nd ne bi translated">熊猫。DataFrame.convert_dtypes()</h1><p id="c5f4" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">该方法将自动检测最适合给定列的数据类型。默认情况下，<code class="fe nk nl nm nn b"><strong class="lk jd">Dtypes</strong></code>为<code class="fe nk nl nm nn b"><strong class="lk jd">object</strong></code>的所有列都将被转换为字符串。</p><pre class="ks kt ku kv gt no nn np nq aw nr bi"><span id="67f1" class="ns mo it nn b gy nt nu l nv nw">df3 = df.copy()<br/>dfn = df3.convert_dtypes()<br/>dfn.info()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/e85a2e3e34de90a4640df6da83e96843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Emw_A745VcWWCClfF6d8jg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">熊猫。DataFrame.convert_dtypes() |作者图片</p></figure><p id="d075" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据我的观察，这种方法对数据类型转换的控制很差</p><p id="be45" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">📚<a class="ae lh" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.convert_dtypes.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> <em class="me">熊猫。data frame . convert _ dtypes()</em>T22</strong></a></p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="70fc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">总结一下，</em></p><p id="c9a4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇快速阅读中，我演示了如何快速更改单个或多个列的数据类型。我经常使用<code class="fe nk nl nm nn b"><strong class="lk jd">pandas.DataFrame.astype()</strong></code> <strong class="lk jd"> </strong>方法，因为它对不同的数据类型提供了更好的控制，并且具有最少的可选参数。当然，基于分析需求，可以使用不同的方法，比如将数据类型转换为<code class="fe nk nl nm nn b"><strong class="lk jd">datetime64(ns)</strong></code>方法<code class="fe nk nl nm nn b"><strong class="lk jd">pandas.to_datetime()</strong></code>要简单得多。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="1a1f" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">如何看完所有的中篇文章？</h1><p id="167a" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">今天就成为媒体会员&amp;获得⚡ <strong class="lk jd"> <em class="me">无限制</em> </strong> ⚡访问所有媒体故事的权利。</p><blockquote class="ou"><p id="9584" class="ov ow it bd ox oy oz pa pb pc pd md dk translated"><a class="ae lh" href="https://medium.com/@17.rsuraj/membership" rel="noopener"> <em class="pe">在这里报名</em> </a> <em class="pe">和</em> <a class="ae lh" href="https://medium.com/subscribe/@17.rsuraj" rel="noopener"> <em class="pe">加入我的电子邮件订阅</em> </a></p></blockquote><p id="cbdd" class="pw-post-body-paragraph li lj it lk b ll pf kd ln lo pg kg lq lr ph lt lu lv pi lx ly lz pj mb mc md im bi translated">当你在这里注册并选择成为付费媒介会员，我会从你的会员费中获得一部分作为奖励。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="50a6" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">💡项目创意！！</h1><p id="ab26" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">从一个新的<a class="ae lh" href="https://data.world/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> <em class="me">数据集</em> </strong> </a>开始，通过实践<a class="ae lh" rel="noopener" target="_blank" href="/data-wrangling-raw-to-clean-transformation-b30a27bf4b3b"> <strong class="lk jd"> <em class="me">数据争论</em> </strong> </a>技术来评估和清理它，并将其存储在SQL <a class="ae lh" href="https://medium.com/analytics-vidhya/sql-database-with-python-5dda6c9a0c8d" rel="noopener"> <strong class="lk jd"> <em class="me">数据库</em> </strong> </a>中，以最终在<a class="ae lh" rel="noopener" target="_blank" href="/visualize-sqlite-data-with-power-bi-734856383643"><strong class="lk jd"><em class="me">Power BI</em></strong></a>中可视化它，这可能是一个好主意。</p><p id="ffb8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">此外，这个项目想法可以用其中给出的资源来实现。正如我常说的，我乐于接受建设性的反馈和通过LinkedIn分享知识。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h2 id="8ae5" class="ns mo it bd mp oj ok dn mt ol om dp mx lr on oo mz lv op oq nb lz or os nd iz bi translated">感谢您的阅读和宝贵时间！</h2></div></div>    
</body>
</html>