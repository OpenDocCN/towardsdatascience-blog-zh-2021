<html>
<head>
<title>Arvato Solutions Customer Segmentation and Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Arvato解决方案客户细分和预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-analysis-on-arvato-customers-e3d56a366c78?source=collection_archive---------31-----------------------#2021-04-20">https://towardsdatascience.com/an-analysis-on-arvato-customers-e3d56a366c78?source=collection_archive---------31-----------------------#2021-04-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/db255998f572e47a40ae46c4652483c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t21Cwc3pxW0k2ReHgOmGCA.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@sortino" rel="noopener ugc nofollow" target="_blank">约书亚·索蒂诺</a>通过<a class="ae kc" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="b40b" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">介绍</h1><p id="9222" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">客户细分是营销行业中最重要的过程之一，它允许公司将精力集中在具有相似特征的特定客户子集上。这使得公司能够有效地、适当地向各种受众群体营销群体。据Shopify称，客户细分有助于公司:</p><ul class=""><li id="1451" class="lz ma iq ld b le mb li mc lm md lq me lu mf ly mg mh mi mj bi translated">创建有针对性的沟通方法，与特定的客户群体产生共鸣，但不与其他人产生共鸣。</li><li id="838c" class="lz ma iq ld b le mk li ml lm mm lq mn lu mo ly mg mh mi mj bi translated">确定改进产品、新产品或服务机会的方法。</li><li id="346e" class="lz ma iq ld b le mk li ml lm mm lq mn lu mo ly mg mh mi mj bi translated">专注于最赚钱的客户。</li></ul><p id="103c" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">一个顶点项目关注德国人口统计数据的这一过程。具体来说，它需要分析德国普通人口的人口统计数据以及一家邮购公司的客户数据。该分析的目标是使用包括K-Means聚类在内的无监督学习方法来确定邮购公司的客户与一般人群相比如何。</p><p id="bb4d" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在对客户进行细分并解释分组后，下一步是使用单独的训练数据集来实施和调整一些监督学习算法，以预测个人成为公司客户的概率。</p><p id="6356" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">找到最佳预测模型后，最后一步是在测试数据集上使用它来预测客户对活动做出反应的概率。这些预测的概率将被上传到Kaggle比赛中，该比赛将测量这些预测与其他参赛作品相比的准确性。</p><p id="5a72" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">这个项目是Udacity数据科学纳米学位顶点的多个选项之一。因此，贝塔斯曼的这个项目成为我的首选，因为几个月前我已经在机器学习纳米学位项目的另一个版本上工作过。那个版本只包含第一步——从清理数据到对客户进行聚类。现在，这是一个超越这一步的机会，同时进一步应用数据挖掘和机器学习的新技能。</p><h1 id="9f5e" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">数据</h1><p id="4570" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这三个步骤中的每一步都包含具有相同特征的不同数据集。人口统计数据集包含大约366个特征，每个特征描述成千上万人的个性和行为。每一行代表一个人以及该人以外的信息，即家庭、建筑和邻居数据。</p><p id="411f" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">德国人口统计数据和邮购公司的客户数据将用于该分析的无监督学习部分。前者包含总共366个特征和891211个样本，而后者包含369个特征和191652个样本。两者在功能上的区别是CUSTOMER_GROUP、ONLINE_PURCHASE和PRODUCT_GROUP，它们属于客户数据，提供了更多的客户信息。</p><p id="941d" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">邮寄出的训练和测试数据集包含与人口统计数据相同的所有特征。虽然两者都有近43000个样本，但这些数据代表了作为营销活动目标的个人。训练数据中的结果变量被命名为RESPONSE，它指示客户是否响应了成为公司客户的活动。测试数据集包含除响应特征之外的所有特征。这将用于在本项目的最后部分使用最佳模型进行最终预测。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="5a8b" class="kd ke iq bd kf kg mz ki kj kk na km kn ko nb kq kr ks nc ku kv kw nd ky kz la bi translated">第1部分—数据预处理</h1><p id="816d" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">像每一个数据科学问题一样，这个项目在分析数据和进行预测之前涉及到数据预处理和清理。由于四个数据集具有相同的结构，数据清理将被处理到ETL管道中，该管道执行缺失值的修改，确定要删除哪些特征和行，如何处理分类/混合特征，以及生成虚拟变量。</p><h2 id="ca51" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">缺少值</h2><p id="cfc9" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">由于人口统计数据的规模很大，我上传了前100，000个样本，以便更快地执行初始清理。原始数据包含几个缺失值的特征，这些缺失值用NaN以外的许多不同值编码，即-1，0，X，XX。幸运的是，一个单独的Excel文件包含每个特性的值及其描述的索引。与含义“未知”相关联的值是缺失值，因此被收集到字典中。在将所有原始的“未知”编码替换为“NaN”之后，我继续确定哪些特性可以被排除。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/8c77f2a84a49fe734b30fe846375ecab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GAsjFAQj-zGHjNvWFv4CAQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图1 —按特征分类的缺失值百分比直方图(按作者分类的图片)</p></figure><p id="ff9a" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">从<strong class="ld ir">图1，</strong>一个特征的缺失值的最佳阈值是40%，因为任何高于这个阈值的值在特征数量中出现的频率都非常低。结果，九个特征被丢弃，包括阿格_ TYP-最佳阿格类型学，KBA05 _鲍马克斯-单元内的普通建筑，以及蒂特尔_ KZ-此人是否有学术头衔。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/4ab1116d7dd68755b1471303396e02fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2i-SKJaScbgH5Z8ZTxWYUA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图2—按行划分的缺失值百分比直方图(按作者划分的图像)</p></figure><p id="c525" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在删除了大部分缺失的列之后，下一步是对行进行类似的处理。从<strong class="ld ir">图2中可以看出，</strong>行缺失值在50%之后变得不那么频繁，任何缺失值在70%左右的行对分析都没有好处。因此，丢失超过50%的任何行都将被丢弃。</p><h2 id="71e6" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">分类变量</h2><p id="6d8b" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">检查要素的数据类型时，其中一些数据类型具有多个值。例如，CAMEO_DEU_2015和CAMEO_INTL_2015将被拆分为两个要素-财富和人生阶段。CAMEO_DEUG_2015已转换为数字变量，因为其值只有一种含义。</p><p id="a3e9" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">基于PRAEGENDE _ JUGENDJAHRE创建了两个特征。这一原创功能结合了三个维度的信息——十年、运动和国家。根据Excel文件中关于此功能的信息，这些值被转换为十进制和主流。KZ西部的特征已经代表了这个国家。</p><p id="573a" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在去掉一些无用的分类变量后，剩下的变量被转换成虚拟变量。这是数据清理过程的最后一步。</p><p id="621c" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在执行各自的分析之前，上述所有步骤将用于所有四个数据集。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="2e2d" class="kd ke iq bd kf kg mz ki kj kk na km kn ko nb kq kr ks nc ku kv kw nd ky kz la bi translated">第2部分—客户细分</h1><p id="796c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">通过数据清理管道，德国人口统计数据和客户数据集均可用于客户细分分析。客户细分包括缺失值的数据插补、数据标准化、主成分分析降维以及用于细分的K均值聚类。</p><p id="94b6" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">一旦在人口统计数据和客户数据集中生成了聚类，就会对这些聚类进行比较，以确定哪些聚类代表了邮购公司的目标受众，即那些比其人口对应部分获得更高客户比例的聚类。这些聚类将根据最高主成分中的主导特征进行解释，给出营销活动目标人群类型的详细信息。</p><h2 id="2488" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">主成分分析</h2><p id="4a8e" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">干净数据预处理的第一步是为分割分析找到最佳数量的组件和聚类。对于前者，我创建了一个函数，根据解释的方差阈值的百分比，返回某个主成分的最高主成分权重的特征的条形图。对于人口统计数据，<strong class="ld ir">图3 </strong>表明，约154个主成分解释了85%的数据变化。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/601bc5be45c31b7f9ebbcb779647b8c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EO0HWoy9cu84PG6uUd1h1A.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图3——解释85%数据变化的主成分数量。</p></figure><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/461a556fdde0a66df94f12d007e5a301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8mfZoCiEth_xUZlUQEMrLA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图4-主成分1中权重最高和最低的10个特征(作者图片)</p></figure><p id="57af" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">从<strong class="ld ir">图4，</strong>第一主成分中权重最大的特征包括流动模式、单/双户数量、社会地位和汽车份额。具体来说，这些特征与该成分正相关。另一方面，最小的要素权重包括6至10个家庭住宅的共享、每6至10个家庭住宅的汽车拥有量、财富/生命阶段和家庭净收入。这意味着第一主成分与大家庭负相关。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/383da9f3ca4354ad7dc2f533d1170e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_AGULOeJ_65Yw1wcE_rgtg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图5—主成分2中权重最高和最低的10个特征(图片由作者提供)</p></figure><p id="2d18" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">从<strong class="ld ir">图5 </strong>来看，第二个主成分中最大的特征意味着它与在线亲和力、交易活动频率、省钱金融拓扑、年龄组正相关。相反，这一部分与财务准备和最近的财务交易现状负相关。</p><h2 id="a1e5" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">k均值聚类</h2><p id="db47" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">对于人口统计中成千上万的个体，最好估计高于5的聚类数。为了测试要使用多少个分类，肘形方法图显示了当K-means分类分数降低，分类数增加时，一条线显示出肘形的方向变化。对于像人口统计数据这样大的数据集，循环迭代聚类数并收集分数的快速方法是使用小批量K-Means方法。使用常规的K-means将增加计算时间来拟合并在循环中产生分数，特别是对于较大的聚类。另一方面，小批量方法减少了K-mean算法的时间和空间开销。具体来说，它使用固定大小的小批量随机数据。该方法的评分如图6<strong class="ld ir">所示。</strong></p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/1be63a9b2b4378214660aa63a48428f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yj3NeSMC8gbAeM726ORHCQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图6 —从小批量K均值得出的人口统计数据的肘形图。k的最佳值被确定为k = 8。(图片由作者提供)</p></figure><p id="0cb7" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在拟合了25个聚类之后，8个和21个聚类之间似乎有些曲折。因为大型数据集最好用较高数量的聚类来说明，所以图中的最佳弯头似乎集中在k =8个聚类处。</p><p id="8b34" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">为了将人口统计数据与客户数据进行比较，从对聚类的插补来看，后者将具有与前者相同的sklearn对象。具体来说，客户将被扩展到154个主要成分，并细分为8个集群。两个数据集的聚类分布如图7<strong class="ld ir">所示。</strong></p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/195dbcf842beee247649af63b7b56abb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qES94wvrygKJPBNp_sB5qg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图7——德国人口和邮购公司客户的人群比例(图片由作者提供)</p></figure><p id="9775" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">从上面的两个图来看，集群7在德国人口中最具代表性，约占16%，而集群8在公司客户中最具代表性，约占20%。相反，聚类6在人口统计中最少被代表约8%，而聚类5在客户中最少被代表约7.5%。有趣的是，集群6是最具代表性的客户之一。此外，分类7是人口统计中最具代表性的分类之一，也是客户中最不具代表性的分类之一。</p><h2 id="4001" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">聚类解释</h2><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/c8f9687d4d7e7e7254eea036059f05e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6zcf3Ot7mpvjtWWco36Dcg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图8 —聚类比例比较，其中目标受众为正差异，非目标受众为负差异(按作者分类)</p></figure><p id="6071" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">为了确定哪些分类代表邮购公司的目标受众，将从其各自的客户分类比例中减去人口分类比例。此外，目标受众群是那些客户比例大于人口比例的群体。另一方面，非目标受众群体是那些客户比例低于人口比例的群体。根据<strong class="ld ir">图8，</strong>邮购公司的目标受众在集群8和集群6中。聚类8具有最高的正容限，而聚类7具有最大的负容限。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/6fcf1323d448c06a2547857e04fafc09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hmJAjAC2lwAy1bUD4sM13Q.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">表1——按年间隔定义的ALTERSKATEGORIE_FEIN值(图片由作者提供)</p></figure><p id="41a3" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">这里要理解的一个重要变量是年龄组。该项目的任何附件中都没有解释altersketaorie _ FEIN(年龄类别，精细比例)特征。然而，一个变量GEBURTSJAHR——出生年份——与该变量直接相关。创建一个关联这两个特征的字典有助于理解ALTERSKATEORIE_FEIN特征的含义。<strong class="ld ir">表1 </strong>列出了与每个年龄类别变量相关的5年间隔。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/26d1871f1183f6b96eaefdbf0c2c7b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAY4_A77eRBGWUjXfLXUqg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图9-按聚类划分的年龄类别比例热图(图片由作者提供)</p></figure><p id="6c96" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated"><strong class="ld ir">图9 </strong>中的热图显示了将要分析的聚类中年龄类别的比例。在这两个目标受众群体中，1930年至1949年出生的人在年龄组中所占比例最高。对于群组3中的非目标受众，按年龄组划分的最高比例在两个目标群体中几乎相同。另一方面，第7组中1945年至1969年间出生的人比例较高。由于在这种情况下理解诸如年龄组这样的重要变量是重要的，所以目标观众群的质心将带来对彼此之间的相似性和差异的更广泛的洞察。</p><p id="b06a" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">聚类分析和解释包括计算所有特征的8个聚类质心，并将它们逆变换到原始特征尺度。然而，由于有超过300个特征，聚类解释仅限于10个具有最高正主成分权重的特征，如图<strong class="ld ir">图4 </strong>和<strong class="ld ir"> 5所示。</strong></p><blockquote class="od oe of"><p id="627e" class="lb lc og ld b le mb lg lh li mc lk ll oh mp lo lp oi mq ls lt oj mr lw lx ly ij bi translated"><strong class="ld ir"> <em class="iq">目标受众</em> </strong></p></blockquote><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/c27baee928de03a0d67df8e353c80644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*624i6-JHkIj1y5wja8ujHA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图9 —前两个主成分的最高特征的目标受众聚类质心(作者图片)</p></figure><p id="98b1" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">乍一看，除了聚类7之外，第一主成分特征的质心值在所有观众聚类中都是相似的。另一方面，对于第二主成分，该群的大多数质心与所有其他目标观众群相似。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/767f74bff56101bc3144cc7a13969297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17EY6V7Fte_OIfpbi5Rmtg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">表2 —聚类6值及其含义(图片由作者提供)</p></figure><p id="c79b" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在集群6中，客户倾向于20世纪40年代出生的新房主。他们居住在大型社区的单/双家庭住宅中，在社会中的流动性很小。由于储蓄和投资的规模很大，他们必须有很高的退休金。虽然这一群体由普通收入者组成，但他们在过去两年中很少或没有金融交易活动。此外，他们拥有较高的汽车份额和适中的在线亲密度。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/4ce77ccc65a39c4dbba0e598eae9da40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6mMPYUSgeHwdS0G8TNTHlA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">表3—聚类8值及其含义(图片由作者提供)</p></figure><p id="a5cb" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">与集群6类似，集群8中的受众通常出生于20世纪40年代初，生活在大型社区的单/双家庭住宅中，在社会中的流动性较小。由于储蓄的规模很大，他们必须有很高的退休金。虽然这一群体由普通收入者组成，但他们在过去两年中很少或没有金融交易活动，在线亲密度适中。然而，与集群6不同，这些客户是更有经验的业主，并且具有更高的投资活动。</p><blockquote class="od oe of"><p id="8bed" class="lb lc og ld b le mb lg lh li mc lk ll oh mp lo lp oi mq ls lt oj mr lw lx ly ij bi translated"><strong class="ld ir"> <em class="iq">非目标受众</em> </strong></p></blockquote><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/6e06e9c45053fce8c1167835fd4c8266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s3F0vN9mRbGwP6BCJi2yqA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">表4-聚类3质心值及其含义(图片由作者提供)</p></figure><p id="0a99" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">与目标受众类似，第3类客户是20世纪40年代初出生的房主，他们居住在大型社区，在社会中流动性很小。由于储蓄规模非常大，他们必须有很高的退休金。虽然这一群体由普通收入者组成，但他们在过去两年中很少或没有金融交易活动。然而，一些关键的区别是，这一群体的客户平均拥有单/双家庭住房份额，汽车拥有率低，至少有几个交易活动，以及更高的在线亲和力。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/0a92378dda1850c96cefc46d118e59fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l9PiCVz-ViMhDDyB60smJQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">表5—聚类7质心值及其含义(图片由作者提供)</p></figure><p id="651b" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">乍一看，分类7显示的值与其他分类不同。与目标群体一样，这一群体包括居住在大型社区的单/双家庭住房中的房主。由于储蓄规模非常大，他们必须有很高的退休金。然而，这些客户更年轻，并且在过去两年中增加了金融交易活动。而且，他们的线上亲和力很高。</p><p id="4cb3" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">非监督分析的结论是，营销活动的目标受众是1935年至1949年间出生的人，他们在投资和存钱方面具有较高的财务拓扑结构。他们也是很少或没有整体或邮购交易活动的人，即使他们有适度的网上关系。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="ebf7" class="kd ke iq bd kf kg mz ki kj kk na km kn ko nb kq kr ks nc ku kv kw nd ky kz la bi translated">第3部分—监督学习</h1><p id="c1c1" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在对德国人口统计和客户数据集执行聚类分析以确定哪些客户更有可能是邮购公司的客户之后，下一步是将监督学习应用于单独的数据文件。这个数据集与前两个相似，但是每个人都是邮寄活动的目标。此外，它还包括一个响应变量，表示个人在活动结束后是否成为了邮购公司的客户。也就是说，这些数据用作训练集，将用于为单独的测试数据集建立最佳预测算法，该数据集将用于Kaggle比赛。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi op"><img src="../Images/9946e3b80b2334768c2bebd5ed45b263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lh16NYcDZuZbD47fR_qaAg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图10 —培训数据中的客户响应频率(图片由作者提供)</p></figure><p id="47bd" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">由于训练数据集几乎有43，000个样本，<strong class="ld ir">图10 </strong>显示响应变量明显不平衡。换句话说，大约1.24%的目标个人成为了公司的客户。由于这是预测模型将使用的目标变量，因此在测试数据中对个人是否会成为客户进行分类将是一个挑战。一种补救方法是在训练预测模型之前，除了数据预处理和训练/测试拆分之外，还实施采样方法。</p><h2 id="b110" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">数据预处理</h2><p id="5ed5" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">一旦将300个预测因子和反应变量彼此分开，基于0.1的验证比率和0.2的测试比率，将邮寄出的训练数据分成训练、验证和测试集。这三个分割用于在对整个邮寄数据使用最佳模型之前评估候选模型。</p><p id="087e" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">分割后，训练集、验证集和测试集分别通过插补、标准化和PCA缩减为154个组件进行转换。对于这种分析，这些经过处理的数据集将用于评估三种预测算法:逻辑回归、AdaBoost和梯度增强分类器。该过程包括使用ROC分数而不是f1分数对模型执行交叉验证，但不是在对训练数据实施额外修改之前。</p><h2 id="9100" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">重采样— ADASYN</h2><p id="37e1" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在对明显不平衡的数据实施模型之前，重采样方法对于精确的模型至关重要。少数反应——反应= 1——非常罕见，以至于任意模型对结果几乎一无所知，从而导致弱模型。为了使积极的反应更重要，模型需要更好地了解它，这就是过采样的用武之地。</p><p id="c76d" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">两种可能的重采样方法是欠采样和过采样。欠采样包括平衡数据，使得多数类(响应= 0)的观测值随机减少到与少数类相同的大小。然而，对于该数据以及在一些应用中，一个主要的缺点是多数类观察的显著遗漏导致重要信息的丢失，而这些信息对于模型的学习过程可能是至关重要的。另一方面，过采样通常将少数类样本复制到与多数类相同的大小，而不是省略多数类的样本。然而，由于少数样本<a class="ae kc" rel="noopener" target="_blank" href="/class-imbalance-smote-borderline-smote-adasyn-6e36c78d804"> </a>的高重复率，这种策略很可能会使数据过拟合。</p><p id="0187" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">要在两种重采样策略之间做出选择，过采样更好，因为这样会保留更多信息，而不是丢弃<a class="ae kc" href="https://zyxo.wordpress.com/2008/12/30/oversampling-or-undersampling/" rel="noopener ugc nofollow" target="_blank"> </a>。即便如此，imblearn包提供了一些增强的过采样方法，减少了一般过采样的缺点。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oq"><img src="../Images/63c5335f8ec43a42ea1a7b57c3a54440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pcBWk_EPSXuyUBztOtMLjQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图11—ADASYN少数民族样本的KNN世代(图片由<a class="ae kc" href="https://imbalanced-learn.org/stable/over_sampling.html" rel="noopener ugc nofollow" target="_blank"> imblearn </a>提供)</p></figure><p id="fad1" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">一种很好的技术是ADASYN——自适应合成采样方法。这种重采样技术旨在通过生成少数类样本的合成版本来对其进行过采样。考虑一个样本x_i，它变成一个新的样本x_new。这个新样本是通过原始样本的k个最近邻生成的。从所有可能的邻居中选择x_zi，新的观测值计算如下:</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/925d1a7adc54dce44ffa84be77212958.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/0*H7U0g8uFGd1qULkw"/></div></figure><p id="67d0" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">其中λ是0和1之间的随机数。这个新样本一般位于x_i和x_z <a class="ae kc" href="https://imbalanced-learn.org/stable/over_sampling.html" rel="noopener ugc nofollow" target="_blank">和</a>之间的线上。<strong class="ld ir">图11 </strong>说明了这一过程。此外，ADASYN使用密度分布作为标准来决定少数样本的合成样本数。这是通过自适应地改变不同少数样本的权重，同时考虑任何偏斜分布<a class="ae kc" href="https://www.datasciencecentral.com/profiles/blogs/handling-imbalanced-data-sets-in-supervised-learning-using-family/#:~:text=The%20key%20difference%20between%20ADASYN,to%20compensate%20for%20the%20skewed" rel="noopener ugc nofollow" target="_blank"> ⁴ </a>来实现的。</p><p id="5a5d" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">ADASYN重采样适合分割的训练数据，从而产生总共超过61044个样本，而不是30000个样本。</p><blockquote class="od oe of"><p id="c632" class="lb lc og ld b le mb lg lh li mc lk ll oh mp lo lp oi mq ls lt oj mr lw lx ly ij bi translated"><strong class="ld ir"> <em class="iq">逻辑回归</em> </strong></p></blockquote><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi os"><img src="../Images/a32c020f030e47b2ed279d6c178ca62b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMF9CBDP9h_HOl2IxclIWQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图12 —验证和测试集的逻辑回归分类报告(图片由作者提供)</p></figure><p id="3a71" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">根据对重新采样的训练数据的默认逻辑回归模型，验证和测试分数彼此相似。对于肯定回答，召回分数是0.43，精确分数是0.2。这意味着43%的实际客户被正确分类为2%的被预测为客户的个人实际上是客户。验证ROC得分为0.53。</p><p id="fdee" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">对于测试数据，55%的实际客户被正确预测，2%的预测客户被正确分类。ROC评分为0.59，高于验证集。</p><blockquote class="od oe of"><p id="8426" class="lb lc og ld b le mb lg lh li mc lk ll oh mp lo lp oi mq ls lt oj mr lw lx ly ij bi translated"><strong class="ld ir"> <em class="iq"> AdaBoost分类器</em> </strong></p></blockquote><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oq"><img src="../Images/15cd8823c24736a1ff2b1219874258fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPa96TspDix9rZMytMxSrQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图13—验证和测试集的AdaBoost分类报告(图片由作者提供</p></figure><p id="fa11" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">根据重采样训练数据的默认AdaBoost模型，验证和测试分数彼此相似。对于肯定回答，召回分数是0.26，精确分数是0.2。这意味着26%的实际客户被正确预测，2%被预测为客户的个人实际上是客户。验证ROC得分为0.54。</p><p id="55a7" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">对于测试数据，26%的实际客户被正确预测，2%的预测客户被正确分类。ROC评分为0.54，与验证集大致相同，但略高。</p><blockquote class="od oe of"><p id="049d" class="lb lc og ld b le mb lg lh li mc lk ll oh mp lo lp oi mq ls lt oj mr lw lx ly ij bi translated"><strong class="ld ir"> <em class="iq">极端梯度提升分类器</em> </strong></p></blockquote><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ot"><img src="../Images/d9bf58e009812dffaee3083c43410127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k14q78-uljV_jBEeLmtSIQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图14——验证和测试集的极端梯度提升分类报告(图片由作者提供)</p></figure><p id="a467" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">根据对重新采样的训练数据的默认极端梯度提升模型，验证和测试分数彼此相似。对于肯定回答，召回分数是0.07，精确分数是0.1。这意味着实际上是客户的个人中有7%被正确预测，而被预测为客户的个人中有1%实际上是客户。验证ROC得分为0.47，小于其他两个模型。</p><p id="f0e2" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在测试数据中，10%的实际客户预测正确，1%的预测客户正确。ROC评分为0.49，高于验证集。</p><p id="e307" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated"><strong class="ld ir">型号选择</strong></p><p id="7f17" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">根据上述一般模型的初步信息，如果可以选择一个模型，那么向前发展的最佳模型将是逻辑回归模型。因为通过验证和测试，所有三个模型的精确度分数是相同的，所以另一个要考虑的度量是召回和ROC分数。关注正面回答，即使它是少数类，逻辑回归在测试和验证集中也具有最高的回忆和ROC分数。</p><p id="cc4a" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">然而，对于这种分析，监督模型的目标不是挑选哪个模型通常预测得最好。虽然极端梯度增强可以给出比逻辑回归更高的ROC分数，但它被证明是最低的，并且显著低于逻辑回归的ROC分数。那么，这是否意味着在真实的测试集上，逻辑回归会比极端梯度推进给出更高的ROC分数？为了找出答案，需要对列出的三个模型进行交叉验证和优化，以确定对邮寄测试数据的应用是否会给逻辑回归比其他两个整体模型更高的分数。</p><h2 id="f5d2" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">交叉验证模型调整</h2><blockquote class="od oe of"><p id="af0d" class="lb lc og ld b le mb lg lh li mc lk ll oh mp lo lp oi mq ls lt oj mr lw lx ly ij bi translated"><strong class="ld ir"> <em class="iq">逻辑回归</em> </strong></p></blockquote><p id="ba80" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">一旦启动通用逻辑回归模型，它将通过网格搜索交叉验证方法来应用，以找到整个训练数据的最佳参数。通用模型是在包含三种数据转换的流水线中定义的，除了模型之外，还有ADASYN过采样。此管线模型的参数集由三个独立的实例组成。</p><pre class="nr ns nt nu gt ou ov ow ox aw oy bi"><span id="0a01" class="ne ke iq ov b gy oz pa l pb pc">lr_parameters = [<br/>    {'model__penalty':['l1'],<br/>     'model__C': np.arange(0.1, 1.1, 0.1),<br/>     'model__max_iter':[300, 500, 800, 1300],<br/>     'model__solver':['saga']<br/>     },<br/>    <br/>    {'model__penalty':['l2'],<br/>     'model__C': np.arange(0.1, 1.1, 0.1),<br/>     'model__max_iter':[100, 200, 300, 500, 800],<br/>     'model__solver':['newton-cg','lbfgs']<br/>    },<br/>    <br/>    {'model__penalty':['l2'],<br/>     'model__C': np.arange(0.1, 1.1, 0.1),<br/>     'model__max_iter':[300, 500, 800, 1300],<br/>     'model__solver':['sag']<br/>     }<br/>    <br/>]</span></pre><p id="5ed8" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">逻辑回归接受四种不同的惩罚，但在这种情况下，将使用两种惩罚— l2(默认)和l1。参数字典结构由一个<em class="og"> l1 </em>集合和两个略有不同的<em class="og"> l2 </em>集合组成。每一个都包含范围从0.1到1.1乘0.1的C系数、范围从100到1300的最大迭代次数(取决于惩罚)以及不同的解算器。第一个实例对应于<em class="og"> l1 </em>，它只接受‘saga’或‘liblinear’解算器。由于该模型将应用于大型数据集，因此将只使用“saga”。第二个实例是对于<em class="og"> l2 </em>用‘牛顿-CG’和‘lbfgs’。第三个实例是带有解算器“sag”的<em class="og"> l2 </em>，它处理最大迭代次数至少为300的大型数据集。网格搜索完成后，系数为0.8的逻辑回归、1300次最大迭代和“sag”求解器得出ROC得分为0.63。</p><pre class="nr ns nt nu gt ou ov ow ox aw oy bi"><span id="4fcc" class="ne ke iq ov b gy oz pa l pb pc">LogisticRegression(C=0.8, max_iter=1300, solver='sag')</span></pre><p id="70c6" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">结果，该算法在邮寄测试集上的预测导致37.6%的个人被预测为客户。最终提交的分数为0.609。</p><p id="2061" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated"><strong class="ld ir"> AdaBoost分类器</strong></p><p id="fd1f" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">与逻辑回归相反，AdaBoost参数搜索将通过随机搜索进行。虽然有两个参数需要搜索，但几次拟合需要很长时间。学习率值从0.1到0.8按斐波纳契数列组织，包括默认值1。估计数的组织方式相同，从100到300，加上值50。</p><pre class="nr ns nt nu gt ou ov ow ox aw oy bi"><span id="ebf1" class="ne ke iq ov b gy oz pa l pb pc">ab_parameters = {'model__learning_rate': [0.1, 0.2, 0.3, 0.5, 0.8, 1],<br/>              'model__n_estimators': [50, 100, 200, 300]<br/>             }</span></pre><p id="acad" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">AdaBoost分类器上的随机搜索包括12次迭代，其中得分最高的模型具有0.2的学习率和200个估计量。</p><pre class="nr ns nt nu gt ou ov ow ox aw oy bi"><span id="1195" class="ne ke iq ov b gy oz pa l pb pc">AdaBoostClassifier(learning_rate=0.2, n_estimators=200,<br/>                                    random_state=0)</span></pre><p id="2758" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">该算法对邮件发送测试集的预测导致22%的个人被预测为客户。最终提交的分数为0.579。</p><p id="3deb" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated"><strong class="ld ir">极端梯度推进分类器</strong></p><p id="5dc5" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">该模型的参数搜索不同于其他两个模型。因为极端梯度平滑在参数和功效上都比AdaBoost更复杂。管道的定义方式与其他两个模型相同。在这个算法的27个不同参数中，我选择了5个最重要的参数——最大深度、alpha、子样本、树的数量和学习速率。</p><pre class="nr ns nt nu gt ou ov ow ox aw oy bi"><span id="5b09" class="ne ke iq ov b gy oz pa l pb pc">xgb_parameters = {<br/>    'model__max_depth': np.arange(3, 13, 1),<br/>    'model__alpha': np.arange(0.1, 0.8, 0.05),<br/>    'model__subsample': [None, 0.1, 0.25, 0.5, 0.75, 1],<br/>    'model__n_estimators': np.arange(10, 200, 10),<br/>    'model__learning_rate':  np.linspace(0.01, 0.8, 10)<br/>}</span></pre><p id="5a8f" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">定义参数后，将通过随机搜索而不是网格搜索来执行交叉验证。这里定义的XGBoost参数将花费大量的时间和计算工作。因此，通过一定次数的迭代，有限但随机的搜索将改善这两个问题。对于这种随机搜索，设置了45次迭代以增加捕获最佳模型的机会，因为在网格搜索中会有数百种组合可以持续几天。最后，除了搜索中没有的默认参数之外，最佳XGBoost分类器还有以下参数。</p><pre class="nr ns nt nu gt ou ov ow ox aw oy bi"><span id="46bd" class="ne ke iq ov b gy oz pa l pb pc">XGBClassifier(<strong class="ov ir">alpha=0.7</strong>, base_score=0.5, booster=None, colsample_bylevel=1,<br/>colsample_bynode=1, colsample_bytree=1, <br/>gamma=0, gpu_id=-1, importance_type='gain',<br/>interaction_constraints=None,<br/><strong class="ov ir">learning_rate=0.09777777777777778</strong>,<br/>max_delta_step=0, <strong class="ov ir">max_depth=3</strong>,<br/>min_child_weight=1, missing=nan,<br/>monotone_constraints=None, <strong class="ov ir">n_estimators=90</strong>,<br/>n_jobs=0, num_parallel_tree=1, <strong class="ov ir"><em class="og">random_state=0</em></strong>,<br/>reg_alpha=0.699999988, reg_lambda=1,<br/>scale_pos_weight=1, subsample=1,<br/>tree_method=None, validate_parameters=False,<br/>verbosity=None)</span></pre><p id="bf82" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">该算法对邮件发送测试集的预测导致20%的个人被预测为客户。最终提交的分数为0.587。</p><p id="2865" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">在这三个模型中，在Kaggle竞赛中获得最高分的模型是逻辑回归模型。就像基本分类报告一样。</p><figure class="nr ns nt nu gt jr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/1d31e5d2229e5cfdd2a92aee831f5f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*LAc_6ZVNzuHn56qIW6g02w.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">表6 —最终预测结果</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="054f" class="kd ke iq bd kf kg mz ki kj kk na km kn ko nb kq kr ks nc ku kv kw nd ky kz la bi translated">结论</h1><p id="275a" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这个顶点项目的目标包括在Arvato Financial Solutions的类似数据集中进行非监督和监督学习。无监督分析需要主成分分析和K-均值聚类来描述哪些人最有可能成为邮购公司的客户。监督分析侧重于对训练集进行缩放和过采样，以便预测模型可以准确预测活动的目标个人是否会成为公司的客户。该过程包括初始化和优化三个不同的模型，以确认哪一个在应用缩放和重采样后最准确。</p><h2 id="f5a6" class="ne ke iq bd kf nf ng dn kj nh ni dp kn lm nj nk kr lq nl nm kv lu nn no kz np bi translated">未来的工作</h2><p id="dde9" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果通过添加更多参数或增加迭代次数来进一步调整极限梯度提升算法，则可以改进监督结果。与其他通用模型相比，通用XGBoosting验证和测试结果的ROC得分提高了近10%。训练数据不平衡的方式可能意味着测试数据中的客户百分比也很低。也就是说，更一致的随机搜索或替代参数搜索可能会导致XGBoost模型超过逻辑回归得分，考虑到两个最终得分如何相互接近，并且它具有最低的客户预测百分比。</p><p id="9a58" class="pw-post-body-paragraph lb lc iq ld b le mb lg lh li mc lk ll lm mp lo lp lq mq ls lt lu mr lw lx ly ij bi translated">看我的GitHub库<a class="ae kc" href="https://github.com/juliang94/Data-Science-Capstone-Udacity" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div></div>    
</body>
</html>