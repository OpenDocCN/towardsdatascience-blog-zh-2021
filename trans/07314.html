<html>
<head>
<title>3.3 arguments on deciding if using multiple Date tables is a good idea</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3.3关于决定使用多个数据表是否是一个好主意的争论</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-3-arguments-on-deciding-if-using-multiple-date-tables-is-a-good-idea-5b1788c426a6?source=collection_archive---------11-----------------------#2021-07-03">https://towardsdatascience.com/3-3-arguments-on-deciding-if-using-multiple-date-tables-is-a-good-idea-5b1788c426a6?source=collection_archive---------11-----------------------#2021-07-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="db1b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通常，在我们的表格模型中有一个数据表。但有时，多个日期表可能是个好主意。让我们分析一下如何决定做这件事的正确方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/950add0372a769a4b65d36af5db3456f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8DnWiBd0QzwuzQDS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@madebyjens?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">延斯·勒列</a>拍摄</p></figure><p id="bc82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前一段时间，我写了一篇关于用扩展的数据表增强报告的文章。你可以在这里找到这篇文章:<a class="ae ky" rel="noopener" target="_blank" href="/3-ways-to-improve-your-reporting-with-an-expanded-date-table-2d983d76cced">用扩展的数据表</a>改进你的报告的3种方法。</p><p id="34eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从那以后，我与客户和同事讨论了为什么我在Power BI或Analysis Services的表格模型中需要不止一个日期表。</p><p id="7b4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们试图决定是要只有一个日期表还是要有多个日期表时，有三个主题需要考虑:</p><ol class=""><li id="924d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">可用性</li><li id="19b5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">更简单的DAX代码</li><li id="7670" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">简化模型</li></ol><p id="96d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看这三个主题。</p><p id="8691" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但首先，我们需要了解“问题”。</p><h1 id="ad38" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">问题是</h1><p id="a09b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">让我们看一个例子，其中我们有多个日期的事务:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/13f971bc9ab2104d3585d108041c7231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*_K5WDGcNucs0a59VirDxSA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1 —具有多个日期的交易表</p></figure><p id="ac67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上图中，我们看到有多个日期的交易。</p><p id="d40b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们希望能够根据三个日期中的每一个创建报告。</p><p id="69a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以创建一个简单的模型，就像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6bafbcfcf4bd19bcfc35f1f72056520a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VXGbifYLNU9-NrIY55GBkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2 —带有一个数据表的简单数据模型</p></figure><p id="2653" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">活动关系将OrderDate列链接到Date列。</p><p id="d8c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，我们可以构建另一个数据模型，为在线销售表中的每个日期列创建一个日期表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/d3c943b8e369f796522346238a14cbab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dCudp1QqpIFdjr2ZKfhTDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3 —每个日期列有一个数据表的数据模型</p></figure><p id="50ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一种更简单的模型是常见的模型。这个简单的模型对大多数用例都有帮助。</p><p id="8586" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论如何，有三个数据表的模型可能会更有帮助。</p><p id="edfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们深入探讨上面提到的决定哪种模式更好的三个论点。</p><h1 id="4a94" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">可用性</h1><p id="f5d4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">可用性是不客观的，它取决于用户的品味，用户会使用数据模型。</p><p id="8d43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您开发Power BI模型以创建Power BI报告时，您可以遵循自己喜欢的方式。</p><p id="b484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是当你开发一个数据模型时，其他用户也应该使用它，那么你也需要考虑他们的用户技能、习惯和对数据模型的理解。</p><p id="54ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">共享数据模型可以通过Power BI服务或Analysis Services数据模型中的共享数据集来实现。</p><p id="4c50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想向您展示数据模型的哪些部分会影响可用性:</p><ul class=""><li id="13e7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nj mb mc md bi translated">措施的复杂性</li><li id="ba8d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">计算组</li><li id="0a8b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">对目的的理解</li></ul><h1 id="426e" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">措施的复杂性</h1><p id="3ef7" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">当我有多个数据表时，我可以创建简单的度量。我可以对模型中的任何日期表使用这些度量。</p><p id="7c74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我可以使用这个简单的DAX方法来衡量任何日期表的销售额:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="cfc3" class="np mk it nl b gy nq nr l ns nt">Online Sales = SUMX(‘Online Sales’, [UnitPrice]*[SalesQuantity])</span></pre><p id="6324" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">而对于只有一个日期表和多个关系的情况，我需要使用USERELATIONSHIP()函数为一个非活动关系实现相同的功能。</p><p id="2128" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据到期日计算销售额的DAX度量值:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="9c01" class="np mk it nl b gy nq nr l ns nt">Online Sales by Due Date =<br/>CALCULATE(<br/>    SUMX(‘Online Sales’, [UnitPrice]*[SalesQuantity])<br/>    ,USERELATIONSHIP(‘Online Sales’[DueDate],’Date’[Date])<br/>    )</span></pre><p id="ca3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，当您有多个日期表时，您可以对所有日期表使用第一个简单的在线销售度量，而无需添加更多的度量。</p><p id="c18e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，当用户可以选择他想要使用的日期表时，他可以这样做，这是透明的。</p><p id="2776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，用户将无法比较同一图表中基于不同日期轴的数字:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/9499f2a642fd0b534be3281fc389c122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-v8vcwbPeyN7fc5OSZllDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4 —比较两个测量的数据</p></figure><p id="923e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，一旦我们需要时间智能度量，我们就必须创建相同数量的度量。</p><h1 id="e921" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">计算组</h1><p id="decf" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们可以使用计算组来简化我们的模型。我们可以使用这个特性来避免不同度量中的冗余逻辑。</p><p id="814e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在SQLBI文章<a class="ae ky" href="https://www.sqlbi.com/articles/introducing-calculation-groups/" rel="noopener ugc nofollow" target="_blank">介绍计算组— SQLBI </a>中阅读有关计算组的更多信息</p><p id="6ce1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，当使用一个或多个日期表时没有区别。例如，在创建时间智能度量时，您必须为每个日期轴开发不同的计算组。无论您使用一个还是多个日期表格。</p><p id="db54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">计算组不会帮助您决定选择哪条路线。</p><h1 id="4167" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">对目的的理解</h1><p id="b2ea" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">相应地命名您的措施至关重要。</p><p id="d4d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您在下图中看到的，我为每个度量添加了一个后缀来定义目的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/0991eca8ca028002f01c69f82e06cdc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*aSkiUc0V2JXOiqIUNBgEdw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5 —有目的地测量</p></figure><p id="f075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最好独立于您使用一个或多个日期表的决定来完成这项工作。</p><p id="ff55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你必须记住，你的用户需要你的帮助来理解你的模型中每个对象的用途。</p><p id="35df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，如果您相应地命名您的日期表，会有所帮助，如上图所示(图2和图3)。</p><h1 id="9fa1" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">更简单的DAX代码</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/fb21e0d17b171649158eea6318e296b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XQNcN8htQzfm86N9"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@benchaccounting?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">钳工</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="d277" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上一节中，我们已经看到，当我们使用一个日期表时，如果要确保根据特定的日期轴计算销售额，我们需要编写更多的代码。</p><p id="281c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们编写时间智能度量时也是如此。</p><p id="4bd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不是小节数的问题。不管我们的决定如何，我们总是需要开发相同数量的时间智能度量。</p><p id="b1aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，当我们有一个中央数据表时，我们必须为每个时间智能度量添加一个USERELATIONSHIP()。</p><p id="417e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用一个日期表按到期日衡量上一年:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="c019" class="np mk it nl b gy nq nr l ns nt">Online Sales PY (Due Date) =<br/>VAR SalesAmountPY =<br/>    CALCULATE(<br/>        SUMX(‘Online Sales’, [UnitPrice]*[SalesQuantity])<br/>        ,SAMEPERIODLASTYEAR(‘Date’[Date])<br/>        ,USERELATIONSHIP(‘Online Sales’[DueDate], ‘Date’[Date])<br/>        )</span><span id="c109" class="np mk it nl b gy nx nr l ns nt">RETURN<br/>    SalesAmountPY</span></pre><p id="af20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相比之下，当我们有一个专用的到期日表时，看下面的DAX代码，根据到期日计算前一年:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="7e38" class="np mk it nl b gy nq nr l ns nt">Online Sales PY (Due Date) =<br/>VAR SalesAmountPY =<br/>    CALCULATE(<br/>        SUMX(‘Online Sales’, [UnitPrice]*[SalesQuantity])<br/>        ,SAMEPERIODLASTYEAR(‘Due Date’[Date])<br/>        )</span><span id="66bc" class="np mk it nl b gy nx nr l ns nt">RETURN<br/>    SalesAmountPY</span></pre><p id="106a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个解决方案更容易编写和阅读。</p><p id="e1ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时，多个日期表有助于解决只有一个日期表时很难解决的问题。</p><p id="c1a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的文章<a class="ae ky" rel="noopener" target="_blank" href="/a-dax-drama-in-3-acts-with-two-time-dimensions-aa65abbf5f41">中，我描述了一个问题，我需要使用两个日期轴对我的数据应用两个不同的日期过滤器。</a></p><p id="648e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不知道上面文章中解释的问题能否用一个单独的数据表来解决。<br/>即使这个问题可以解决，解决方案也会非常复杂，难以理解。</p><p id="59d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要仔细考虑需求，并相应地决定是只能使用一个日期表，还是需要多个日期表。</p><h1 id="eb0e" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">简化模型</h1><p id="a817" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在数据模型中使用一个数据表最明显的原因是为了简化数据模型。</p><p id="255f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图显示了带有一个日期表的数据模型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/49c86c307f41262ad5294fd220883d3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzeF-hwtD1RD0Xu6s_HTfQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6 —带有一个数据表的数据模型</p></figure><p id="af68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在比较同一个数据模型，但是有多个数据表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/329f66229054ef265003b83d73dceafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoATZIF5g9CPyL23rEOQVA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7 —具有多个数据表的数据模型</p></figure><p id="28a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你看第二个更大，看起来更复杂。</p><p id="4485" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，当您仔细观察第一个数据模型时，可以看到从在线销售表到日期表的三种关系。在外行看来，这三种关系看起来也很复杂。</p><p id="b06f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一点上，这是你的决定，哪个数据模型看起来更容易理解，或者哪个是更复杂的数据模型。</p><h1 id="af81" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结合两种解决方案</h1><p id="1c4a" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">有时，需求会发生冲突，您不能坚持使用一种方法。</p><p id="d18c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，您可以创建一个将两种方法结合在一起的模型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/24192eda3af56b6849b9872f7d2a267a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s74vcesiuIs344AkPn4_jw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8 —组合数据模型</p></figure><p id="4367" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您有了所有的可能性，并且您可以在您的模型中使用这两种方法的优点。</p><p id="8154" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是代价是增加了复杂性和用户使用错误数据表的危险。</p><p id="9667" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您使用Ship Date表创建时间智能度量。<br/>但是，当用户在这个模型上创建一个报表，并将数据表添加到报表中时，该度量将不再有效。</p><p id="608d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您需要向您的度量添加检查，以找出报告中使用了哪个日期表。</p><h1 id="fab2" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">示例1 —带检查的动态PY测量</h1><p id="c8e8" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">这里有一个如何做到这一点的例子:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="683a" class="np mk it nl b gy nq nr l ns nt">Sales PY (by Ship Date) =<br/>    VAR IsShipDate = ISFILTERED(‘ShipDate’)</span><span id="7abf" class="np mk it nl b gy nx nr l ns nt">RETURN<br/>    IF( IsShipDate<br/>        ,CALCULATE([Sum Online Sales]<br/>        ,SAMEPERIODLASTYEAR(‘ShipDate’[Date])<br/>        )<br/>        ,CALCULATE([Sum Online Sales]<br/>            ,SAMEPERIODLASTYEAR(‘Date’[Date])<br/>            ,USERELATIONSHIP(‘Online Sales’[ShipDate], ‘Date’[Date])<br/>        )<br/>    )</span></pre><h1 id="16cf" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">示例2 —带有基本测量的动态PY测量</h1><p id="40ac" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">或者，可以使用SWITCH()函数创建一个更复杂的检查，将所有的数据表合并到一个度量中。</p><p id="5d94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是确定使用哪个日期表的基本度量:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="ecc2" class="np mk it nl b gy nq nr l ns nt">Get used Date table =<br/>SWITCH (<br/>    TRUE<br/>        ,ISFILTERED(‘OrderDate’), 1<br/>        ,ISFILTERED(‘ShipDate’), 2<br/>        ,ISFILTERED(‘DueDate’), 3<br/>        ,0<br/>    )</span></pre><p id="936e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以在所有其他度量中使用此基本度量，如下所示:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="7860" class="np mk it nl b gy nq nr l ns nt">Sum Online Sales PY (Dynamic) =<br/>SWITCH([Get used Date table]<br/>    , 1<br/>    ,CALCULATE([Sum Online Sales]<br/>        ,SAMEPERIODLASTYEAR(‘OrderDate’[Date])<br/>    )<br/>    , 2<br/>    ,CALCULATE([Sum Online Sales]<br/>        ,SAMEPERIODLASTYEAR(‘ShipDate’[Date])<br/>    )<br/>    , 3<br/>    ,CALCULATE([Sum Online Sales]<br/>        ,SAMEPERIODLASTYEAR(‘DueDate’[Date])<br/>    )<br/>    ,CALCULATE([Sum Online Sales]<br/>        ,SAMEPERIODLASTYEAR(‘Date’[Date])<br/>    )</span><span id="5740" class="np mk it nl b gy nx nr l ns nt">)</span></pre><p id="3301" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们将这样的逻辑添加到度量中时，我们还必须考虑性能。</p><p id="3c72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用Power BI中的示例1创建了一个矩阵，并使用Power BI Desktop中的性能分析器将这个矩阵的查询复制到DAX Studio。我使用了服务器计时特性来收集计时信息。</p><p id="fc1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我立即执行带有on Measure的查询，以获得有意义的度量。</p><p id="27f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为基线，让我们使用简单的销售额合计:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/9da9454bfd330e7d1f237c299653f7a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*vJ1Lygq4FAEphBfDGgq2ZQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9 —基线测量(发货日期表)</p></figure><p id="0b11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，用ShipDate日期表来度量PY的时间:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/68926893bad6f141200dbb7a2ee57430.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*odSmil0qJx4K-CPUz7tOPA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10——用装运日期表测量PY</p></figure><p id="d118" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，使用Measure进行测量，该测量检查正在使用哪个日期表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/646643594b6af86269f02aed35f9f980.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*x57cuAUL1PJJGmUmI5lnPw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11——使用数据表检查的PY测量</p></figure><p id="0fdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了进行比较，这里使用了相同的度量，但是这次使用了日期表，该表需要USERELATIONSHIP()函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d9a9bb5e1fe3c21938e5274b65985761.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*pcnvx-0_xjuJK2aXHw5erw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图13——使用数据表检查和用户关系测量PY</p></figure><p id="a6ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里所有的计时都在一个表中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/008d456dec7c7216d4148838a78ee582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*rKsgFcETJekQ92rQsVEA4w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图12 —计时表</p></figure><p id="31b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，使用在线销售和发货日期表之间的关系只多花了127毫秒的时间。</p><p id="78fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对已用日期表的检查只需要额外的30毫秒。这是非常少的时间，您不需要考虑它。</p><p id="648a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是与使用关系相比，使用USERELATIONSHIP()函数需要200毫秒以上。</p><p id="17fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这些值取决于您的模型的几个因素，您需要执行您的测量以获得适当的性能差异。</p><h1 id="3e07" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="b3a5" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">这个问题的答案是“我应该使用一个日期表还是需要多个日期表？”是:</p><p id="1f5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="of">视情况而定</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/76d1a997a27a63f0a6e3c691e87a6554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wAtU-aVVf8sCEO2c"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@sharonmccutcheon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">莎伦·麦卡琴</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="b34d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您必须评估报告需求和用户的能力。</p><p id="b737" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的建议是:</p><ul class=""><li id="fc49" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nj mb mc md bi translated">从一个单独的日期表格开始，除非你知道你需要专用的日期表格。</li><li id="21ec" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">一旦你有了理由，就换成专用的日期表</li></ul><p id="c19c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，这种方法对我来说非常有效。</p><p id="adc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，为什么我用“3.3关于决定使用多个数据表是否是一个好主意的论点”作为这篇文章的标题呢？</p><p id="e0aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用了三个主要论点:</p><ol class=""><li id="c6c7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">可用性</li><li id="faee" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">更简单的DAX代码</li><li id="bcd8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">简化模型</li></ol><p id="b5dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在可用性内部，我进一步提到了三个原因:</p><ul class=""><li id="27a8" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nj mb mc md bi translated">措施的复杂性</li><li id="1066" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">计算组</li><li id="3fd5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">对目的的理解</li></ul><p id="f95c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，3.3个参数。</p></div></div>    
</body>
</html>