<html>
<head>
<title>Learn SQL Server Management Studio — Part 5 Stored Procedures &amp; Scheduling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解SQL Server Management Studio —第5部分存储过程和调度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-sql-server-management-studio-part-5-stored-procedures-scheduling-88fd9788d314?source=collection_archive---------12-----------------------#2021-04-03">https://towardsdatascience.com/learn-sql-server-management-studio-part-5-stored-procedures-scheduling-88fd9788d314?source=collection_archive---------12-----------------------#2021-04-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6ff3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你在派对上开心的技能！循序渐进。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0f9dd54f11b627ecc4269292cc2a0db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*roToJlj_GD9MSxvT"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·泽兹奇在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="29e4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在最后几集里…</h1><p id="2c79" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你好。欢迎学习SQL和SQL Server Studio系列教程的第5部分。有一个简单的目标:让你熟悉和适应这个工具和语言。“这有什么关系？”我知道你在问。事实证明，好奇心和副业往往是被新项目选中的关键，甚至是获得新工作的关键。事实上，您已经使用了一个重要的工具，比如SQL Server Studio，并且编写了一些SQL查询，这将会给您一个清晰的开端。</p><p id="4006" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您错过了关于如何设置我们的环境和本地服务器的第1集，请阅读本文:</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/getting-started-with-sql-server-management-studio-part-1-step-by-step-setup-63428650a1e0"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">了解SQL Server Management Studio —第1部分分步安装</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">这是一个免费且强大的工具，可以利用数据、提高技能并在面试中脱颖而出</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ks mv"/></div></div></a></div><p id="c5ca" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第二集将教你如何创建自己的数据库、表格，以及关于命名约定的重要注释:</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/getting-started-with-sql-server-management-studio-5cd24bb1a87c"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">了解SQL Server Management Studio —第2部分数据库、表和命名约定</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">让你在派对上开心的技能！</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj ks mv"/></div></div></a></div><p id="d95f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在第3集，我们介绍了CRUD操作以及主键和外键:</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/learn-sql-server-management-studio-part-3-crud-operations-primary-foreign-keys-9d884b32ad70"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">了解SQL Server Management Studio —第3部分CRUD操作、主键和外键</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">让你在派对上开心的技能！</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nl l ng nh ni ne nj ks mv"/></div></div></a></div><p id="42f0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在第4集，我们讨论了模式&amp;主要的规范化步骤:</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/learn-sql-server-management-studio-part-4-schemas-normalization-80bcd6a5258"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">了解SQL Server Management Studio —第4部分架构和规范化</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">让你在派对上开心的技能！</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nm l ng nh ni ne nj ks mv"/></div></div></a></div><p id="7cc2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">别忘了回来😉。</p><h1 id="6bc1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">期待什么？</h1><p id="1de5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">今天我们将看看存储过程和作业调度。本教程结束时，您将创建自己的过程，并安排它们在方便的时候运行。这看起来并不多，但它是一项强大而简单的自动化技能，可以添加到您的工具箱中。让我们直接跳进来吧！</p><h1 id="d3b0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">存储过程、奇妙的工具以及在哪里可以找到它们</h1><p id="38fe" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">存储过程是奇妙的工具。它们允许您保存和存储查询。虽然这对于诸如“SELECT * FROM Departments”之类的简单查询似乎并不重要，但对于涉及多个表的复杂查询，或者利用<em class="nn">系统存储过程</em>，这将节省大量时间。“系统存储过程”？这些是SQL Studio中存在的过程，例如，可以使用<em class="nn">sp _ send _ dbmail</em>向使用SQL Studio的电子邮件收件人发送邮件。</p><p id="4703" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，让我们回顾一下上面的内容，希望你会接受这个想法…</p><ul class=""><li id="d42e" class="no np it lt b lu mn lx mo ma nq me nr mi ns mm nt nu nv nw bi translated">将脚本存储为过程，</li><li id="016b" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated">使用系统过程，如sp_send_dbmail，</li><li id="eece" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated">安排程序</li></ul><p id="32a8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望上面提到的潜在用例能让你头脑发热😉让我们看看如何开始。</p><ol class=""><li id="51fe" class="no np it lt b lu mn lx mo ma nq me nr mi ns mm oc nu nv nw bi translated">在SQL Server Studio中，存储过程(或简称为过程)驻留在任何数据库中的programmability子目录下。请看下面的内容:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/4d8cf04737911e645757a94621991dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*iJ7GeFKqjqh89q7a5Uc24Q.png"/></div></figure><p id="ad68" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">起初，没有，然后出现了第一个。让我们看看这是如何发生的。</p><p id="2833" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">2.右键单击存储过程，然后单击存储过程</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/6da510db0a017e90e78b65545ce9eaf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*IhC7pjAgxUojQicXnzoOAg.png"/></div></figure><p id="5dc7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">3.将出现典型的查询窗口，其中填充了一个过程模板</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/582f2ef2eaebb7688ec0eaf0c4b85900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N68mGC6TvYm4JDvxkkKzBA.png"/></div></div></figure><p id="6bd5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">任何以双破折号“- -”开头的内容都会自动变成绿色，这些是注释。它们将被SQL查询编辑器忽略(我可以说编译器吗？🤔)当我们运行脚本时。你可以随意删除绿色的评论，但是部分内容需要调整，以提供作者、创作日期和描述等信息。</p><p id="1c74" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后是“创建过程<procedure_name>”。CREATE过程后面的名称将定义该过程的名称。没有必要保留符号&lt; &gt;。</procedure_name></p><p id="53a9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于这个例子，我们将其命名为<em class="nn">通货膨胀_调整</em></p><p id="58e6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">4.现在，为了保存和检查我们新创建的过程，我们将编写一个占位符查询。在开始和结束之间，添加以下内容。“部门”是我们在前面的练习中创建的表格。我们假设您已经学习了前面的教程，如果没有，请继续创建您自己的表或调整查询以匹配您的环境。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="616b" class="ol la it oh b gy om on l oo op">SELECT * FROM HR_data.dbo.Departments</span></pre><p id="e9a5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是我有的</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/472412a6c4f97c023aaf35bff3d3f96f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a0d4xjMxVbN310bhhiZClw.png"/></div></div></figure><p id="9ba2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">5.我们可以突出显示该查询并运行它(F5或执行绿色箭头)</p><p id="2584" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">6.现在让我们运行整个脚本，这将创建并保存过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/a7754f501e59b57d16e12a1d675a6c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*VGkL1OCv_NB6yXgLnLhl0Q.png"/></div></figure><p id="f326" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用蓝色箭头刷新，出现该过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d16b30cb59f1091f48233f556969eafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*XdDuuOCplGtX5R5mbpy9ag.png"/></div></figure><p id="3ea6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">7.要修改它，请右键单击，然后单击“修改”。将出现查询编辑器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/3cb75992334dc51699ebd7e2965cff2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*vW5XyUBfRIsWAAc2kafF1w.png"/></div></figure><p id="d2e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在可以调整脚本，然后点击“执行”。这将保存和更新程序。在此之前，我们将在我们的薪金表中添加一条新记录，然后我们将返回到该过程并创建一个将自动运行的脚本。</p><p id="b1e1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">8.让我们打开工资表。提醒一下，创建表的一种方法是右键单击Tables &gt; New &gt; Table，然后输入不同的列名和数据类型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/4cf9becbffade7f7036a225747fc789d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQKzFEPXFdYvFOdTctvYqA.png"/></div></div></figure><p id="5bbf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">9.我们现在将向该表添加一条记录</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="f8af" class="ol la it oh b gy om on l oo op">INSERT INTO Salaries</span><span id="5183" class="ol la it oh b gy ov on l oo op">VALUES (1, 2500, 1)</span></pre><p id="4233" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这样，雇员#1的薪金为2500。</p><p id="e251" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">10.回到我们的过程屏幕，我们将编写一个脚本来根据通货膨胀率调整工资。代替我们原来的占位符代码<em class="nn"> SELECT * FROM Departments，</em>，我们将编写以下代码:</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="fdf3" class="ol la it oh b gy om on l oo op">UPDATE Salaries</span><span id="6f01" class="ol la it oh b gy ov on l oo op">SET Salary_USD = Salary_USD * 1.03</span></pre><p id="eca3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该查询更新了Salary表，并将Salary_USD的值设置为Salary_USD乘以1.03，这意味着我们增加了3%的通货膨胀率。</p><p id="94c5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">11.让我们选择这两行，并运行它们(F5或Execute)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/375778fb2ea661897f102f7bbd0beef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*2mXpeubP0ZfI2Ym8eqdDbQ.png"/></div></figure><p id="044e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">快速检查一下我们的原始表，我们看到2500现在是2575，增加了3%。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/edf9d18a64be23848c75ad8dba360395.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*ebOPK6jZf8xC99jXs-R-1A.png"/></div></figure><p id="6f57" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">12.现在，如果您已经学习了以前的教程，这仅仅是对一个专栏进行更新，并不是什么新鲜事。这种加薪每年都要进行，如果我们能安排这样的事情，不是很好吗？进入日程安排。</p><h1 id="a8bd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">计划作业</h1><p id="81dc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这里我们将讨论如何安排一个任务，例如如何运行我们的通货膨胀调整程序。但首先，有些坏消息。允许您从SQL Studio中运行和计划作业的SQL Server代理在SQL Express中不可用，这是因为SQL Express是免费软件。</p><p id="f222" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是，我将向您展示环境是什么样子的，如何安排作业，这样您就可以了解这个特性，或者如果您有付费版本的话，也可以继续学习。或者，可以使用Windows任务计划程序运行脚本。这超出了SQL Studio文章系列的范围，将在附录文章中讨论。</p><h2 id="5346" class="ol la it bd lb oy oz dn lf pa pb dp lj ma pc pd ll me pe pf ln mi pg ph lp pi bi translated">SQL Server代理</h2><p id="bf59" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该部分位于服务器功能列表的末尾。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/766e8bf4f811f6827b3e1f2059e13880.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*HnXbLJM6w0T3f3KTwk92kA.png"/></div></figure><ol class=""><li id="f7af" class="no np it lt b lu mn lx mo ma nq me nr mi ns mm oc nu nv nw bi translated">右键单击作业，然后单击新建作业，将出现一个新窗口</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/2f9dee5e8ea5c54174a1ca9b71b7a6b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8AURVU3VAA0oFDHWrpG2Q.png"/></div></div></figure><p id="918a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这里你可以命名一个工作，精确的分类并提供描述。大多数时候只会填写<em class="nn">姓名</em>。</p><p id="4999" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">2.在“步骤”下，用户可以设置作业应该遵循的不同步骤。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/556ffe4e75802c58807515b82c27a5de.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*6lNMbnl9HLib1IBOhMMQAg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/b865cdf2a3f6346cfe7fd2ed0c8424de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*lFVcgLJ4GoXpR7HuFQXLXA.png"/></div></div></figure><p id="ed73" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果一个作业有多个步骤，可以使用“移动步骤”下的上下箭头重新排列其运行顺序。</p><p id="b8fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">3.点击“新建”，出现一个新窗口。我们为该步骤定义了一个名称，我们精确了数据库，这里应该是<em class="nn"> HR_data </em>和一个命令。该命令将执行我们的存储过程，因此是<em class="nn"> EXEC [dbo]。【通货膨胀_调整】</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/541f4d9ecca73b84321339a4eb3f152d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*Yu92KB4QdOh0bztDS2vfjg.png"/></div></figure><p id="4c5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">4.在新步骤窗口的“高级”选项卡下，我们可以定义下一个操作，无论我们的步骤是成功还是失败。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/930d4fe3f8a31208139559d5abdd8229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQTb-FyA8Icax8Dbq218kA.png"/></div></div></figure><p id="c7a9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是我们在成功情况下的行动范围:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/9677c23cf2796c71055daac151bdd942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*vndF1_4YGifnHlrrcuNlhA.png"/></div></div></figure><p id="6bf1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果失败:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/ced6e82e8bf8f18c9218be5d9ea43b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*atg17ilI3bRELqT773b9QA.png"/></div></figure><p id="7e76" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">它们不言自明。然后，我们可以验证步骤的创建，并点击OK。</p><p id="f329" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">5.该步骤出现在我们的列表中</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/36d7489675495137498c01e403600be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*sAahlwcQAdc0rYT6QHf8Tg.png"/></div></figure><p id="8c37" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">6.现在让我们安排一下</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/c0b087f02fed265f89a4d0050f04919a.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*uHXFqhw7bIdEw80gYSDV_A.png"/></div></div></figure><p id="3c18" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，除了调度功能，还有一个功能是在作业运行或失败时得到通知。</p><p id="db8c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">类似的简单屏幕和一组选项:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/f9939f6589421f0cd95e3a8fcf21982f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*NpfWxMIgWOq9l9ShwS_EXw.png"/></div></figure><p id="74c9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">7.设置新时间表的窗口如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/a6c53d91ae67ee7d7ccfa71a67242fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pc6HpQi5fCqK6Nz0eDlX3w.png"/></div></div></figure><p id="4938" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">频率可以设置为每天、每周或每月。在我们的示例中，我们将选择每月一次，然后调整参数使其每年运行一次。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/dd08af537e7b81c8084f58aa3b9b554f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jynazy2MVyN7F1X5jhbdLg.png"/></div></div></figure><p id="910c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这意味着每12个月一次。正如摘要描述所解释的，该计划将从2022年1月1日开始使用，并在该月的第二天运行。如果这听起来不错，我们为我们的作业计划定义一个名称，然后单击ok。</p><p id="9f03" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">8.已经安排好了。如果我们有更复杂的需求，而这些需求不能由单一的计划来处理，我们可以创建新的计划来涵盖所有的情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/4af660aa2fb352e649b2e19b4b6d4a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*f79U3jxHi0LPlF25sQeNqw.png"/></div></figure><p id="6cf7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们确认所有打开的窗口，新作业将出现在我们的作业列表中。</p><p id="d201" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">注意:作业调度程序显示的开始时间与您的服务器相关联。也就是说，如果它位于德国，则基于该时区安排作业。</strong></p><h1 id="9a39" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">最后的话和接下来会发生什么</h1><p id="6d9e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">暂时就这样吧！我希望您现在对使用SQL Server更有信心，并且:</p><ul class=""><li id="e114" class="no np it lt b lu mn lx mo ma nq me nr mi ns mm nt nu nv nw bi translated">创建和修改SQL存储过程，</li><li id="1005" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated">了解SQL作业调度程序的工作原理，</li><li id="f136" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated">如果你有SSMS付费版，你就知道如何浏览SQL作业调度程序</li></ul><p id="7ccc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢您的阅读，请告诉我您的想法，或者是否有我应该涉及的话题。下次见！</p><h2 id="2f84" class="ol la it bd lb oy oz dn lf pa pb dp lj ma pc pd ll me pe pf ln mi pg ph lp pi bi translated">编码快乐！</h2></div><div class="ab cl pw px hx py" role="separator"><span class="pz bw bk qa qb qc"/><span class="pz bw bk qa qb qc"/><span class="pz bw bk qa qb"/></div><div class="im in io ip iq"><p id="f4f4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢阅读！喜欢这个故事吗？<a class="ae ky" href="https://medium.com/@maximegodfroid/membership" rel="noopener"> <strong class="lt iu">加入媒介</strong> </a>可完整访问我的所有故事。</p></div><div class="ab cl pw px hx py" role="separator"><span class="pz bw bk qa qb qc"/><span class="pz bw bk qa qb qc"/><span class="pz bw bk qa qb"/></div><div class="im in io ip iq"><h1 id="9596" class="kz la it bd lb lc qd le lf lg qe li lj jz qf ka ll kc qg kd ln kf qh kg lp lq bi translated">继续第六集的旅程！</h1><p id="8df1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">通过第6集，了解如何创建SSIS包来导入和导出数据，以便在两个数据库之间传输或在excel/CSV和数据库之间传输。</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/learn-sql-server-management-studio-part-6-ssis-packages-9438dbc90437"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">了解SQL Server Management Studio —第6部分SSIS软件包</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">让你在派对上开心的技能！循序渐进。</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="qi l ng nh ni ne nj ks mv"/></div></div></a></div><h2 id="fbe4" class="ol la it bd lb oy oz dn lf pa pb dp lj ma pc pd ll me pe pf ln mi pg ph lp pi bi translated">或者选择你喜欢的另一集</h2><p id="515d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">在第7集</strong>中，我们将SQL Studio连接到PowerBI，并构建了我们的第一个视觉效果。<a class="ae ky" href="http://Part 7 Connect to PowerBI &amp; First Visuals" rel="noopener ugc nofollow" target="_blank">第7部分连接到PowerBI &amp;第一视觉效果</a></p></div></div>    
</body>
</html>