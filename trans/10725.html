<html>
<head>
<title>MetaClean Automates Peak Quality Assessments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MetaClean自动化最高质量评估</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/metaclean-automates-peak-quality-assessments-3786f4c026b4?source=collection_archive---------14-----------------------#2021-10-15">https://towardsdatascience.com/metaclean-automates-peak-quality-assessments-3786f4c026b4?source=collection_archive---------14-----------------------#2021-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0b96" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用机器学习来检测低质量的集成，节省手动评估峰值的时间</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d8868f4f8578160f25ccf39bb3ca5f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BevjeBzobgvpZtz5GYsN9w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><p id="fa20" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">即使是最好的代谢组学管道也有一定程度的差异，这可能导致样品之间的峰整合不佳。这降低了您准确定量代谢物的能力，通常意味着您必须手动检查每个(感兴趣的)峰的质量。</p><p id="50ca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Kelsey Chetnik、Lauren Petrick和Gaurav Pandey开发了一个新的框架和R包，称为MetaClean。这结合了11个峰质量指标和8个机器学习算法，以自动检测集成较差的峰。</p><p id="ce41" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们采访了Petrick和Pandey关于代谢组学的最新论文<a class="ae lr" href="https://link.springer.com/article/10.1007/s11306-020-01738-3" rel="noopener ugc nofollow" target="_blank">，并了解了MetaClean的工作原理以及如何将其应用于您的数据。</a></p><h1 id="9943" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">当前的自动峰值积分是不可靠的</h1><p id="a9f1" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">液相色谱-质谱联用(LC-MS)是代谢组学工作流程中鉴定和定量化合物的标准工具。在LC-MS中，相同化合物(代谢物)的保留时间和峰形会因测量而略有不同。轻微的波动是正常的，但是自动积分仍然会错误地表征峰，并使样品间的比较复杂化。</p><p id="cd26" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在许多情况下，通过标准后处理工具积分的<strong class="kx ir">高达30% </strong>的峰可能无法通过人工检查。低质量的峰可能是共洗脱分析物、错误校准或背景噪音的产物。因此，您不能期望任何两个样品具有完全相同的峰，即使它们的组成和浓度相匹配。但是为了比较浓度，您仍然需要对不同样品的峰进行精确积分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/42d8f88159b147cab7dce904186c60f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Qw8bmAWmbOGrwaWu.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">LC-MS常见的三个可能的集成问题示例。来源:作者</p></figure><p id="cffa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">评估峰积分的一种方法是手动查看并判断峰形和包含区域。这不仅极其耗时；当你分析每批数千个峰时，这几乎是不可能的。因此，手动QC通常只针对一小部分数据，而且通常只针对感兴趣的峰。虽然这可能会从您的分析中消除假阳性，但它不能解决假阴性，并且集成不良的峰可能会漏掉。</p><h1 id="e4b8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">机器学习可以自动进行峰值评估</h1><p id="ac8c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">个体质量度量可以量化个体峰值质量。然而，这些度量本身通常不足以完全区分低质量和高质量的集成。</p><p id="6a88" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">机器学习模型可以找到复杂而有价值的指标组合，有助于这种区分。您所需要的只是描述峰值积分是高质量还是低质量(您的目标变量)的指标(您的特征)和标签。</p><p id="fc3f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有了这些特征和目标变量，您可以训练模型并评估它们对未知示例的峰值积分的预测程度。如果您发现模型非常准确，您可以轻松地将这些模型应用于数据集中的每个峰(包含数千个峰)。然后，您可以在分析数据之前过滤掉低质量的峰。</p><h1 id="3698" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">MetaClean特性:11个峰值质量指标</h1><p id="d87d" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">Chetnik，Petrick和Pandey探索了质量度量的组合是否可以更好地作为峰值质量分类器的有效特征集。该团队创建了MetaClean来生成这些分类器，并针对几个数据集评估它们的性能。</p><p id="13c8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该团队使用了来自<a class="ae lr" href="http://doi.org/10.1186/1471-2105-15-S11-S5" rel="noopener ugc nofollow" target="_blank">张等人</a>(度量)的四个度量和来自<a class="ae lr" href="https://doi.org/10.1186/s1201%204-018-9209-x" rel="noopener ugc nofollow" target="_blank"> Eshghi等人</a> (M7度量)的七个度量，以及由所有度量组成的组合M11集合。这些指标用于量化样品之间的总体峰形和保留时间一致性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/0c8e237f8b1abca44f31766f85963c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*qWjn9mNTejBXEVDR.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><h1 id="9c1e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">元清理训练数据:500个人工审查的峰值</h1><p id="ec02" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">该团队对89份血浆样本中的500个预处理过的峰进行了手工分类:<strong class="kx ir">几乎40%没有通过手工目测</strong>。他们确保训练数据中有各种不同的峰形，因此模型将在一组有代表性的峰上进行训练。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/5354e6c3a575b80f4fdcc5679be15678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/0*HNxtiRPb4_AksEaf.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><h1 id="a80b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">元清洁模型:八种最大似然分类算法中的佼佼者</h1><p id="38d0" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">下一步是找到对峰值质量进行最佳分类的机器学习算法。MetaClean评估了八种最常用的算法，每种算法都与M4、M7和M11指标配对，以开发24种不同的峰值质量分类器。每个分类器的性能通过五重交叉验证进行评估，重复十次，并对结果进行平均。为此，MetaClean评估了:</p><ul class=""><li id="b23f" class="ms mt iq kx b ky kz lb lc le mu li mv lm mw lq mx my mz na bi translated">决策树；</li><li id="a091" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">逻辑回归；</li><li id="b2b1" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">朴素贝叶斯；</li><li id="fdf8" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">神经网络；</li><li id="71bc" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">线性核的SVM；</li><li id="7108" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">AdaBoost</li><li id="78ba" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">模型平均神经网络；</li><li id="dead" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">随机森林。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/3941d42da75ad83d6860c7424eac213d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Xq8trEkBTGmrL1sF.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">MetaClean使用五重交叉验证评估了24个不同的潜在峰值分类器，这些分类器是从三个峰值质量度量集和八个机器学习算法的组合中构建的。来源:作者</p></figure><p id="b752" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在比较了每个模型的性能后，该团队观察到使用M11度量集的AdaBoost算法性能最佳。他们称这个模型为“全局峰值质量分类器”，它在开发数据集上的分类达到了几乎85%的准确率。</p><p id="ebff" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，仅仅在同一批样本上测试该模型并不能提供该模型在真实情况下表现如何的准确描述。有效的模型还需要在跨批次和跨平台方面表现良好:</p><ul class=""><li id="7eb4" class="ms mt iq kx b ky kz lb lc le mu li mv lm mw lq mx my mz na bi translated"><strong class="kx ir">跨批次</strong>:来自不同批次的其他样品，在同一台机器上以相同的设置进行测量。</li><li id="c721" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated"><strong class="kx ir">跨平台</strong>:在不同机器上测量样品，设置不同。</li></ul><p id="85be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，研究小组评估了另外四个数据集的500个峰值进行测试。他们对Global Peak Quality分类器进行了评估:</p><ul class=""><li id="014c" class="ms mt iq kx b ky kz lb lc le mu li mv lm mw lq mx my mz na bi translated">来自相同仪器的不同数据集，用于测试相同平台的性能；</li><li id="dbf9" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">来自不同平台的三个数据集，用于测试跨平台性能。</li></ul><h1 id="6f4d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">MetaClean在分析来自同一平台的数据时表现出色</h1><p id="8613" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">全局峰质量分类器评估了来自同一仪器的不同数据集(测试1)。该分类器在几乎81%的情况下准确地对峰进行了分类，即使该数据集来自不同的样本类型。</p><h1 id="ccca" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">MetaClean在跨平台分析中表现相当好</h1><p id="5dff" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">该团队将Global Peak Quality分类器应用于四个可公开访问的数据集，每个数据集使用不同的MS仪器、LC色谱柱和/或电离模式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/be3569136e51012b81150e87634a9155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/0*U5PsAtrtYih5fBNS.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><p id="4f1e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">即使有这些平台和样品基质的可变性，分类器也能准确地对65-80%的峰进行分类。然而，这些数据集的性能下降表明，跨平台分析仍然非常具有挑战性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/32225f673e6775e8b3261f36edf22978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YNqAM60XV8LWqeQX.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">全局峰值质量分类器对所有测试集(包括来自不同平台和/或样本矩阵的测试集)实现了超过65%的准确率。来源:作者</p></figure><h1 id="5280" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">基于每个平台培训元清理</h1><p id="6472" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">该团队使用来自不同于生成开发集的实验室的两个数据集(测试3和测试4)作为独立案例，根据他们的数据重新训练和评估模型。他们用来自同一个平台的正面和负面模式数据训练了两个新模型，相互评估。他们表明，针对另一个数据集使用每个模型会产生很好的跨模式结果。每个模型都可以以特定于平台的方式进行优化，甚至可以应用于不同的电离模式。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/c69620358d8d16cb74f6e934254061d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kzce3No1T5oOJLyM.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">当在每个平台的基础上训练时，在正模式数据上训练的模型相对于负模式数据表现得非常好，反之亦然。来源:作者</p></figure><h1 id="a447" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">MetaClean与RSD过滤法的比较</h1><p id="e590" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">随机分析误差可能难以解决，尤其是在复杂样品中。通常，它们是背景噪音或前一次运行的样品残留的产物，与当前问题无关。这些峰值通常变化很大，它们的积分也不一致。</p><p id="6a63" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">发现这些误差的一种方法是通过相对标准偏差(RSD)过滤，其中混合样本被分析多次。丢弃随机峰，并评估共有峰的一致性。当峰面积的标准偏差超出临界值时，它们将被移除。</p><p id="6830" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于MetaClean的运行独立于RSD过滤，研究小组认为首先对数据进行RSD过滤可以达到双重目的:</p><ul class=""><li id="a7c4" class="ms mt iq kx b ky kz lb lc le mu li mv lm mw lq mx my mz na bi translated">将MetaClean的性能与已建立的方法进行比较；</li><li id="f5b2" class="ms mt iq kx b ky nb lb nc le nd li ne lm nf lq mx my mz na bi translated">通过结合RSD过滤提高MetaClean的性能。</li></ul><p id="2dc7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该小组发现，MetaClean在所有测试案例中的表现都优于RSD过滤法，比这种广泛使用的方法更能准确地对峰的质量进行分类。</p><p id="1718" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然RSD在确保随机分析误差最小化方面做得很好，但MetaClean专注于消除可能通过RSD过滤的整合问题。由于RSD和MetaClean是数据质量过滤的互补方法，它们结合使用非常有效。</p><h1 id="8a6f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">对您的数据使用元清理</h1><p id="7ad5" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在您的数据上训练一个元清理模型对您的工作流可能是有价值的。只需很少的前期时间投入，您就可以在实验室中快速分析所有运行的所有峰，并大大降低错误积分率，而无需花费数小时进行手动峰审查。</p><p id="888a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Kelsey、Lauren和Gaurav提供了一个open R包，它根据八个ML和三个质量度量集来评估您的数据，以开发一个模型。您可以立即<a class="ae lr" href="https://cran.r-project.org/package=MetaClean" rel="noopener ugc nofollow" target="_blank">下载软件包</a>并训练您的模型来评估您的LC-MS集成。</p><p id="15f4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请务必阅读发表在代谢组学上的<a class="ae lr" href="https://link.springer.com/article/10.1007%2Fs11306-020-01738-3" rel="noopener ugc nofollow" target="_blank"> MetaClean文章，以了解关于该平台的更多信息。</a></p></div></div>    
</body>
</html>