<html>
<head>
<title>Financial Fraud Detection with AutoXGB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 AutoXGB 进行金融欺诈检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/autoxgb-for-financial-fraud-detection-f88f30d4734a?source=collection_archive---------8-----------------------#2021-11-30">https://towardsdatascience.com/autoxgb-for-financial-fraud-detection-f88f30d4734a?source=collection_archive---------8-----------------------#2021-11-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="62ad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">AutoXGB 与标准 XGBoost 在检测欺诈性信用卡交易方面的对比</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9270c9ee8fb1f09e1726a4d2ed1cf3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MW8kV22kwrkuAFOB"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@cardmapr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> CardMapr </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="dd25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://xgboost.readthedocs.io/en/latest/tutorials/model.html" rel="noopener ugc nofollow" target="_blank"> XGBoost </a>由于其通用性和令人印象深刻的性能，已经成为最重要的机器学习算法之一。</p><p id="e91b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在以前的项目中使用过 XGBoost 之后，我一直乐于让它的<strong class="lb iu">实现更快、更好、更便宜。</strong>当我遇到<strong class="lb iu"> AutoXGB </strong>时，我的好奇心被激起了，它声称是一个自动化工具，用于简化 XGBoost 模型的训练和部署。</p><p id="a66f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于我在金融服务行业的工作，欺诈是一个很大的问题<a class="ae ky" href="https://www.pwc.com/gx/en/services/forensics/economic-crime-survey.html" rel="noopener ugc nofollow" target="_blank"/>，这将是一个利用信用卡欺诈数据来评估 AutoXGB 相对于通常使用的标准 XGBoost 设置的表现的绝佳机会。</p><h1 id="c545" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">内容</h1><blockquote class="mn mo mp"><p id="a27b" class="kz la mq lb b lc ld ju le lf lg jx lh mr lj lk ll ms ln lo lp mt lr ls lt lu im bi translated"><strong class="lb iu"><em class="it">【1】</em></strong><em class="it"/><a class="ae ky" href="#67fd" rel="noopener ugc nofollow"><em class="it">数据采集与理解</em></a><em class="it"><br/></em><strong class="lb iu"><em class="it">【2】</em></strong><em class="it"/><a class="ae ky" href="#5bd5" rel="noopener ugc nofollow"><em class="it">处理类不平衡</em></a><em class="it"><br/></em><strong class="lb iu"><em class="it">【3】</em></strong><em class="it"/><a class="ae ky" href="#4c26" rel="noopener ugc nofollow"><em class="it">选择性能指标 </em>  <em class="it"> </em> </a><a class="ae ky" href="#47a3" rel="noopener ugc nofollow"> <em class="it">让 AutoXGB 经受考验</em></a><em class="it"><br/></em><strong class="lb iu"><em class="it">【6】</em></strong><a class="ae ky" href="#133e" rel="noopener ugc nofollow"><em class="it">最终裁决</em> </a></p></blockquote><p id="fc1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击<a class="ae ky" href="https://github.com/kennethleungty/Credit-Card-Fraud-Detection-AutoXGB" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">此处</strong> </a> <strong class="lb iu"> </strong>查看该项目的 GitHub 回购</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="67fd" class="lv lw it bd lx ly nb ma mb mc nc me mf jz nd ka mh kc ne kd mj kf nf kg ml mm bi translated">(1)数据获取和理解</h1><h2 id="8427" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">概观</h2><p id="b759" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">这个项目使用了来自 Worldline 和<a class="ae ky" href="http://mlg.ulb.ac.be" rel="noopener ugc nofollow" target="_blank">机器学习小组</a>(布鲁塞尔大学)在欺诈检测方面的研究合作的<a class="ae ky" href="https://github.com/Fraud-Detection-Handbook" rel="noopener ugc nofollow" target="_blank">信用卡交易数据</a>(在 <a class="ae ky" href="https://github.com/Fraud-Detection-Handbook/fraud-detection-handbook/blob/main/LICENSE" rel="noopener ugc nofollow" target="_blank"> <em class="mq"> GNU 公共许可证</em> </a>下使用的<em class="mq">)。</em></p><p id="34cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集是真实世界信用卡交易的现实模拟<strong class="lb iu">并且被设计为包括复杂的欺诈检测问题。</strong></p><p id="6c59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些问题包括<strong class="lb iu">类别不平衡</strong>(只有&lt; 1%的交易是欺诈性的)、数字和(高基数)分类变量的<strong class="lb iu">混合</strong>，以及<strong class="lb iu">与时间相关的</strong>欺诈事件。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h2 id="c0f3" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">数据转换</h2><p id="4e8a" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://github.com/Fraud-Detection-Handbook/simulated-data-transformed" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">转换后的</strong>数据集</a>，而不是原始数据集，以符合项目目标。基线特征工程的细节不在讨论范围之内，因此这里有一个简短的总结:</p><ul class=""><li id="ecb2" class="nx ny it lb b lc ld lf lg li nz lm oa lq ob lu oc od oe of bi translated">注明交易是发生在<strong class="lb iu">日还是</strong>夜<em class="mq">(I)</em>；在工作日或周末。 <em class="mq">这样做是因为欺诈模式根据一天中的时间和一周中的日期而不同</em></li><li id="28e6" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated">使用<strong class="lb iu"> RFM </strong>(近期、频率、货币价值)指标描述客户<strong class="lb iu">的消费行为</strong>(例如，平均消费、交易数量)</li><li id="6b74" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated">通过计算一个时间窗口内欺诈案件的平均数量，对与每笔支付<strong class="lb iu">终端</strong>相关的<strong class="lb iu">风险</strong>进行分类</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/fd2c006127df093df9983ba7f3151c5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WOKckojsLCZS9ePg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@claybanks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍摄于<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的粘土堤</a></p></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h2 id="1400" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">预测器和目标特征</h2><p id="63ec" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">在完成特征工程后，我们有一个具有以下特征的数据集:</p><ul class=""><li id="44d7" class="nx ny it lb b lc ld lf lg li nz lm oa lq ob lu oc od oe of bi translated"><strong class="lb iu"> TX_AMOUNT </strong>:美元交易金额<em class="mq"> float </em></li><li id="9076" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu"> TX_DURING_WEEKEND </strong>:交易是否发生在周末<em class="mq"> boolean </em></li><li id="b9de" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu"> TX_DURING_NIGHT </strong>:交易是否发生在夜间<em class="mq"> boolean </em></li><li id="59fd" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu">CUSTOMER _ ID _ NB _ TX _<em class="mq">*</em>DAY _ WINDOW</strong>:每个客户最近 1 天、7 天、30 天的交易笔数[ <em class="mq">整数</em></li><li id="807c" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu">CUSTOMER _ ID _ AVG _ AMOUNT _<em class="mq">*</em>DAY _ WINDOW</strong>:每位客户在过去 1 天、7 天、30 天的平均消费金额(美元)<em class="mq"> float </em></li><li id="3a5c" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu">TERMINAL _ ID _ NB _ TX _ * DAY _ WINDOW</strong>:终端最近 1、7、30 天的交易笔数<em class="mq">整数</em></li><li id="c4c8" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu">TERMINAL _ ID _ RISK _ * DAY _ WINDOW</strong>:过去 1 天、7 天、30 天终端上欺诈交易的平均数量[ <em class="mq">整数</em></li><li id="7d5d" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu"> TX_FRAUD: </strong>指示交易是合法(<strong class="lb iu"> 0 </strong>)还是欺诈(<strong class="lb iu">1</strong>)【<em class="mq">布尔</em>】</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">转换后的信用卡欺诈数据集示例</p></figure><p id="1ec5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从目标变量<strong class="lb iu"> TX_FRAUD </strong>，<strong class="lb iu">，</strong>我们可以看出，我们正在处理一个<strong class="lb iu">二元分类任务</strong>。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h2 id="c20b" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">具有延迟期的列车测试分离</h2><p id="28ed" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">欺诈检测中要考虑的一个重要方面是<strong class="lb iu">延迟期</strong>(又名<strong class="lb iu">反馈延迟</strong>)。在现实世界中，欺诈交易只有在投诉或调查发生后一段时间<strong class="lb iu">才会为人所知。</strong></p><p id="b692" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们需要引入一个连续的<strong class="lb iu">延迟期</strong>(例如，一周)来分离训练集和测试集，其中测试集应该在训练集的最后一个事务之后至少一周<strong class="lb iu">发生。</strong></p><p id="8e2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列车测试划分如下:</p><ul class=""><li id="7ab9" class="nx ny it lb b lc ld lf lg li nz lm oa lq ob lu oc od oe of bi translated"><strong class="lb iu">车组</strong> : 8 周(2018 年 7 月 1 日至 2018 年 8 月 27 日)</li><li id="25cb" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu">延迟期</strong> : 1 周(2018 年 8 月 28 日<strong class="lb iu">至 2018 年 9 月 3 日</strong>)</li><li id="5fd6" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu">测试集</strong> : 1 周(2018 年 9 月 4 日至 2018 年 9 月 10 日)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/ec2339691f361ccc217a330ee55145b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYPys4l3pvlGWwnPM-jTug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">列车和测试设备之间的延迟时间图|图片由作者提供</p></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="5bd5" class="lv lw it bd lx ly nb ma mb mc nc me mf jz nd ka mh kc ne kd mj kf nf kg ml mm bi translated">(2)处理阶层失衡</h1><p id="d197" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">欺诈交易不会经常发生，所以我们手上有一个严重不平衡的数据集也就不足为奇了。</p><p id="25e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从目标变量的值计数来看，在 550，000+交易中，只有 4，935 个欺诈案例<strong class="lb iu"> (0.9%) </strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/f13cf4bd82917caf7cc85a0d769f5324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S6maWzHgX6DYymEgdy4Arg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原始类的值计数:1 =欺诈；0 =合法|作者提供的图片</p></figure><p id="5b70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<strong class="lb iu">合成少数过采样技术(SMOTE) </strong>来处理这种类别不平衡。<a class="ae ky" href="https://arxiv.org/pdf/1106.1813.pdf" rel="noopener ugc nofollow" target="_blank">原始 SMOTE 论文</a>的作者在他们的实现中结合了 SMOTE <strong class="lb iu">和</strong>随机欠采样，所以我在这个项目中使用了这种组合。</p><p id="10e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">具体采样策略如下:</p><ol class=""><li id="faf4" class="nx ny it lb b lc ld lf lg li nz lm oa lq ob lu oq od oe of bi translated"><strong class="lb iu">进行过采样</strong>以将少数类增加到总数据集的 5%(从最初的 0.9%增加 500%)，<strong class="lb iu">然后</strong></li><li id="759f" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oq od oe of bi translated"><strong class="lb iu">随机欠采样</strong>使多数类<strong class="lb iu">的规模为少数类</strong>的两倍(即少数类为多数类规模的 50%)</li></ol><p id="2e8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mq">尽管</em><a class="ae ky" href="https://arxiv.org/pdf/1106.1813.pdf" rel="noopener ugc nofollow" target="_blank"><em class="mq">SMOTE</em></a><em class="mq">作者表明不同的组合给出了可比较的结果，但我选择了 500%/50%组合，因为该论文表明它在石油数据集中的少数样本上给出了最高的准确性。</em></p><p id="86fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过这次采样后，数据集更加均衡，占整个数据集的<strong class="lb iu">少数类从 0.9%增加到</strong> <strong class="lb iu"> 33.3%。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/943cd74b20f828d450b0b7b65500786e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CbpTaekaO5MPUy8zrldCsw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">样本类的值计数:1 =欺诈；0 =合法|作者提供的图片</p></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="4c26" class="lv lw it bd lx ly nb ma mb mc nc me mf jz nd ka mh kc ne kd mj kf nf kg ml mm bi translated">(3)性能指标的选择</h1><p id="278c" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">在我们开始建模之前，我们必须决定评估模型性能的理想指标是什么。</p><p id="a808" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">典型的是基于<strong class="lb iu">阈值的</strong>指标，如准确性和 F1 分数。虽然他们可以评估错误分类的程度，但他们依赖于<strong class="lb iu">特定决策阈值的定义，</strong>例如，概率<strong class="lb iu">&gt;</strong>0.5 =欺诈。</p><p id="bac5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些指标对决策阈值的依赖使得<strong class="lb iu">对</strong>比较不同的模型提出了挑战。因此，更好的选择是<strong class="lb iu">无阈值指标</strong>，如<strong class="lb iu"> AUC ROC </strong>和<strong class="lb iu">平均精度</strong>。</p><p id="d57e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">平均精度</strong>将<a class="ae ky" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html" rel="noopener ugc nofollow" target="_blank">精度-召回曲线</a>总结为每个阈值达到的精度的加权平均值，权重为召回从前一阈值的增加。</p><p id="202f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然 AUC-ROC 更常见，但平均精确度被选为该项目的主要报告指标，原因如下:</p><ul class=""><li id="5352" class="nx ny it lb b lc ld lf lg li nz lm oa lq ob lu oc od oe of bi translated">对于<strong class="lb iu">不平衡</strong>数据集，平均精度为<a class="ae ky" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0118432" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">比</strong> </a>更具信息量。虽然我们已经应用了抽样来平衡我们的数据，但我觉得仍然存在一定程度的剩余不平衡(67:33 而不是 50:50)</li><li id="183c" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated">过多的<strong class="lb iu">假阳性</strong>会使欺诈调查团队不堪重负，因此我们希望在低 <strong class="lb iu">假阳性率(FPR)值</strong>时评估<strong class="lb iu">召回(又名敏感度)。使用 PR 曲线(和 AP)相对于 ROC 的<a class="ae ky" href="https://fraud-detection-handbook.github.io/fraud-detection-handbook/Chapter_4_PerformanceMetrics/ThresholdFree.html" rel="noopener ugc nofollow" target="_blank">优势在于 PR 曲线可以有效地突出<strong class="lb iu">低</strong> FPR 值的模型性能。</a></strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/5f0432c1607f5775efa601e212dfdde8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7xbR3z9MDMr_NmYK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@christiannkoepke?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Christiann Koepke </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="d847" class="lv lw it bd lx ly nb ma mb mc nc me mf jz nd ka mh kc ne kd mj kf nf kg ml mm bi translated">(4)基线— XGBoost 和随机搜索 CV</h1><p id="aa6c" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">基线模型的设置(XGBoost with<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html" rel="noopener ugc nofollow" target="_blank">RandomizedSearchCV</a>)是我倾向于使用的分类任务的第一线方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="3a78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是基线模型的测试集预测结果，其中<strong class="lb iu">平均精度</strong>的关键度量是<strong class="lb iu"> 0.776 </strong>。训练所用的时间是<strong class="lb iu"> 13 分钟</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/44f4ed195c51dbfcdfa6533e0bdcccd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJxTV6MLei6saxOVxXSSOg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试集基线 XGBoost 模型的性能指标|作者图片</p></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="47a3" class="lv lw it bd lx ly nb ma mb mc nc me mf jz nd ka mh kc ne kd mj kf nf kg ml mm bi translated">(5)测试 AutoXGB</h1><p id="3ae5" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">与最近兴起的 AutoML 解决方案一致，AutoXGB 是一个库，它从 CSV 格式的表格数据中自动训练、评估和部署 XGBoost 模型。</p><p id="5769" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<a class="ae ky" href="https://github.com/optuna/optuna" rel="noopener ugc nofollow" target="_blank"> Optuna </a>自动完成超参数调整，使用<a class="ae ky" href="https://github.com/tiangolo/fastapi" rel="noopener ugc nofollow" target="_blank"> FastAPI </a>进行部署。</p><p id="192d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AutoXGB 由拥有世界首位 4x Kaggle 特级大师头衔的 HuggingFace 研究员 Abhishek Thakur  开发。用他自己的话说，AutoXGB 是一个建立 XGBoost 模型的简单工具。</p><p id="59b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我热衷于利用他的专业知识来探索和改进我的 XGBoost 模型通常的实现方式。</p><p id="c68c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装 AutoXGB，请运行以下命令:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="b666" class="ng lw it ov b gy oz pa l pb pc">pip install autoxgb</span></pre><p id="1579" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AutoXGB 框架大大简化了设置 XGBoost 训练和预测所需的步骤。下面是用于为二进制分类任务设置 AutoXGB 的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="53e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是 AutoXGB 的测试集结果，其中<strong class="lb iu">平均精度</strong>的关键指标是<strong class="lb iu"> 0.782 </strong>。训练时间为<strong class="lb iu"> 9 分钟</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/e8da001eb3395c3416495c8cd58580ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vjdltlRqC4vWgCN3hA8eEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试集 AutoXGB | Image 按作者的性能指标</p></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="133e" class="lv lw it bd lx ly nb ma mb mc nc me mf jz nd ka mh kc ne kd mj kf nf kg ml mm bi translated">(6)最终裁决</h1><h2 id="65f0" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">结果比较</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/b40e6dc1ff2bad8895e98e359a21d5ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WBj462CLhE_kyNUzFra_A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">性能和速度比较|图片由作者提供</p></figure><p id="b1c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与基准分数 0.776 相比，AutoXGB 的平均精度分数<strong class="lb iu">略高，为 0.782 </strong>。</p><p id="7d93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AutoXGB <strong class="lb iu">培训</strong>所花费的时间比基准的 13 分钟大约缩短了<strong class="lb iu">30%<strong class="lb iu">9 分钟</strong>。</strong></p><p id="ccf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AutoXGB 的另一个关键优势是，我们距离将模型作为 FastAPI 端点只差<strong class="lb iu">一个命令行</strong>。这种设置减少了建模部署的时间，这是培训时间之外的一个关键因素。</p><p id="81aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下因素可能是推动 AutoXGB 获得更好性能的原因:</p><ul class=""><li id="c80b" class="nx ny it lb b lc ld lf lg li nz lm oa lq ob lu oc od oe of bi translated">使用<strong class="lb iu">贝叶斯优化</strong>和<strong class="lb iu"> Optuna </strong>进行超参数调整，这比随机搜索更快，因为它使用来自先前迭代的信息，在更少的迭代中找到最佳超参数</li><li id="7162" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated">根据作者丰富的数据科学经验，仔细选择 XGBoost <strong class="lb iu">超参数</strong>(类型和范围)的<strong class="lb iu">进行调优</strong></li><li id="e1aa" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><strong class="lb iu">优化内存使用</strong>，通过特定的<a class="ae ky" href="https://github.com/abhishekkrthakur/autoxgb/blob/main/src/autoxgb/utils.py" rel="noopener ugc nofollow" target="_blank">类型转换</a>减少内存使用，例如，将数据类型为<code class="fe pf pg ph ov b">int64</code>的值转换为<code class="fe pf pg ph ov b">int8</code>(消耗的内存减少了 8 倍)</li></ul></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h2 id="72f1" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">重要警告</h2><p id="6e7b" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">虽然性能指标给了 AutoXGB 一个优势，但它最重要的问题之一是参数设置中<strong class="lb iu">粒度控制</strong>的损失。</p><p id="356c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您一直密切关注，您可能会意识到，我们没有引入我们为交叉验证申请的训练/测试分割<strong class="lb iu">的顺序延迟期(我们<a class="ae ky" href="https://fraud-detection-handbook.github.io/fraud-detection-handbook/Chapter_5_ModelValidationAndSelection/ValidationStrategies.html#prequential-validation" rel="noopener ugc nofollow" target="_blank">应该已经完成</a>)。</strong></p><p id="811a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，AutoXGB 不允许我们<strong class="lb iu">指定我们想要用作交叉验证(CV)一部分的验证折叠</strong>，因为唯一与 CV 相关的参数是<code class="fe pf pg ph ov b">n_folds</code>(CV 折叠数)。</p><p id="a5c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种缺乏控制的另一个问题是，我们不能为 XGBoost 分类器指定<strong class="lb iu">评估度量</strong>。</p><p id="71fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在基线模型中，我能够将<code class="fe pf pg ph ov b">eval_metric</code>设置为<code class="fe pf pg ph ov b">aucpr</code>(PR 曲线下的 AUC)，这与我们的平均精度的主要指标一致。但是，对于二进制分类，AutoXGB 的 XGBoost 分类器中的硬编码评估度量是<code class="fe pf pg ph ov b">logloss</code>。</p><p id="f3a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">归根结底，虽然 AutoXGB 等解决方案在简化(并可能改进)XGBoost 实现方面做得很好，但数据科学家需要通过了解幕后发生的事情来了解其局限性。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><p id="b54e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随意查看 GitHub repo <a class="ae ky" href="https://github.com/kennethleungty/Credit-Card-Fraud-Detection-AutoXGB" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">中的代码，点击</strong> </a>。</p><h1 id="a74f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在你走之前</h1><p id="9b69" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">欢迎您<strong class="lb iu">加入我的数据科学学习之旅！</strong>关注我的<a class="ae ky" href="https://kennethleungty.medium.com/" rel="noopener"> Medium </a>页面和<a class="ae ky" href="https://github.com/kennethleungty" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，了解更多精彩的数据科学内容。同时，享受在你的 ML 任务中使用 AutoXGB 的乐趣！</p><div class="pi pj gp gr pk pl"><a href="https://medium.com/geekculture/using-ensemble-regressors-to-predict-condo-rental-prices-47eb7c3d5cd9" rel="noopener follow" target="_blank"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">用集合回归预测公寓租金</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">Python 中集成学习和多元线性回归在公寓租金预测中的应用</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">medium.com</p></div></div><div class="pu l"><div class="pv l pw px py pu pz ks pl"/></div></div></a></div><div class="pi pj gp gr pk pl"><a rel="noopener follow" target="_blank" href="/automatically-generate-machine-learning-code-with-just-a-few-clicks-7901b2334f97"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">只需点击几下鼠标，即可自动生成机器学习代码</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">使用 Traingenerator 轻松创建 PyTorch 和 scikit-learn 模板代码，用于机器学习模型培训</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">towardsdatascience.com</p></div></div><div class="pu l"><div class="qa l pw px py pu pz ks pl"/></div></div></a></div><div class="pi pj gp gr pk pl"><a rel="noopener follow" target="_blank" href="/key-learning-points-from-mlops-specialization-course-deeplearning-ai-andrew-ng-5d0746605752"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">MLOps 专业化认证的关键学习点—课程 1</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">面向生产的机器学习工程课程 1 的主要课程(包括课堂讲稿)</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">towardsdatascience.com</p></div></div><div class="pu l"><div class="qb l pw px py pu pz ks pl"/></div></div></a></div></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h2 id="8ecc" class="ng lw it bd lx nh ni dn mb nj nk dp mf li nl nm mh lm nn no mj lq np nq ml nr bi translated">资源</h2><ul class=""><li id="3d91" class="nx ny it lb b lc ns lf nt li qc lm qd lq qe lu oc od oe of bi translated"><a class="ae ky" href="https://fraud-detection-handbook.github.io/fraud-detection-handbook/Foreword.html" rel="noopener ugc nofollow" target="_blank">用于信用卡欺诈检测的机器学习—实用手册</a></li><li id="baf2" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><a class="ae ky" href="https://github.com/abhishekkrthakur/autoxgb" rel="noopener ugc nofollow" target="_blank"> AutoXGB — GitHub </a></li><li id="4414" class="nx ny it lb b lc og lf oh li oi lm oj lq ok lu oc od oe of bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html" rel="noopener ugc nofollow" target="_blank">sci kit-Learn:Precision-Recall</a></li></ul></div></div>    
</body>
</html>