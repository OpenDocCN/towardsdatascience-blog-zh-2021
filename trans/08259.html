<html>
<head>
<title>Advanced Regression Analysis with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行高级回归分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/advanced-regression-f74090014f3?source=collection_archive---------23-----------------------#2021-07-29">https://towardsdatascience.com/advanced-regression-f74090014f3?source=collection_archive---------23-----------------------#2021-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6418" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python实现大学统计</h2></div><h1 id="e17f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="e17a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在一系列的每周文章中，我将会涉及一些重要的统计学主题。</p><p id="12cd" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">目标是使用Python来帮助我们获得对复杂概念的直觉，从经验上测试理论证明，或者从零开始构建算法。在本系列中，您将会看到涵盖随机变量、抽样分布、置信区间、显著性检验等主题的文章。</p><p id="8d0f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在每篇文章的最后，你可以找到练习来测试你的知识。解决方案将在下周的文章中分享。</p><p id="f48b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">迄今发表的文章:</p><ul class=""><li id="fbec" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/bernoulli-and-binomial-random-variables-d0698288dd36">伯努利和二项随机变量与Python </a></li><li id="a180" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55">用Python从二项式到几何和泊松随机变量</a></li><li id="b1df" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/sampling-distributions-with-python-f5a5f268f636">用Python实现样本比例的抽样分布</a></li><li id="83d3" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/confidence-intervals-with-python-bfa28ebb81c">Python的置信区间</a></li><li id="5eab" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6">使用Python进行显著性测试</a></li><li id="b25d" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9">用Python进行组间差异的双样本推断</a></li><li id="b3e9" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/inference-for-categorical-data-9f3c6034aa57">分类数据的推断</a></li><li id="5520" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/advanced-regression-f74090014f3">高级回归</a></li><li id="4b51" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/analysis-of-variance-anova-8dc889d2fc3a">方差分析— ANOVA </a></li></ul><p id="57ae" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">像往常一样，代码可以在我的<a class="ae mk" href="https://github.com/luisroque/College_Statistics_with_Python" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h1 id="6fab" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">线性回归中斜率的推断</h1><p id="b723" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">想象一下，你想根据一个数据科学家编码的年数来预测他的工资。为了建立这种关系，我们可以从数据科学家群体中随机抽取20个人，并绘制关系图(注意，工资单位是10，000€)。同时，我们可以计算出最佳拟合的线。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mq"><img src="../Images/1c46dbb67126c13059ee81555e14c926.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vd_OoPfMh5ZBB4Sk"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图1:数据科学数据科学是一个跨学科的<strong class="bd ng"> </strong>领域，利用科学的方法、过程、算法和系统从结构化和非结构化数据中提取知识和见解；<a class="ae mk" href="https://unsplash.com/photos/NDfqqq_7QWM" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="3ff6" class="nm kj it ni b gy nn no l np nq">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>from scipy.stats import t, chi2</span><span id="69ba" class="nm kj it ni b gy nr no l np nq">salaries = [[4, 5.5, 3.5, 6, 7, 9, 3.4, 5.3, 4.3, 5.3, 6, 6.2, 6.5, 7, 7.1, 4.3, 5.2, 5, 5.7, 3.2]]<br/>yearsCoding = [[2, 5, 1, 4, 5, 10, 2, 2, 4, 3, 4, 6, 5, 6, 7, 4, 3, 4, 4, 3]]<br/>n = 20</span><span id="496d" class="nm kj it ni b gy nr no l np nq">plt.scatter(yearsCoding[0], salaries[0])<br/>plt.xlabel('Years Coding')<br/>plt.ylabel('Salary');</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/b2972c0593df373a8e8aceea869ab4b1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*FgNHRBFZWuXR93HRBBkJIg.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图2:数据科学家样本的工资(10，000€)按编码年数。</p></figure><p id="55db" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">最佳拟合线可以通过最小化数据点和线之间的平方距离来计算。回归线的方程式如下:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/b2df41be630330211aab670c38235423.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*g-IkzzOPuxVi0wpg4xC7nA.png"/></div></figure><p id="5d7d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">其中b是斜率，a是回归线的截距。请注意，通过为我们的数据计算这条线，我们计算了20名数据科学家的单一样本的最佳拟合线。我们可以计算出一条不同的最佳拟合线，用于我们从总体中抽取的不同样本。发生这种情况是因为我们在估计总体的参数。如果您可以获得世界上所有数据科学家的工资和编码年数来构建您的模型，您将可以估计真实的总体参数。在这种情况下，我们用α <strong class="lc iu"> </strong>和β代替a和b:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/43cc10e29aa21681664f2166428f0b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*-slJhDvAfP2eb6Hx6EBaUg.png"/></div></figure><p id="5e9c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">因为我们使用样本来估计总体参数，所以我们可以根据这些样本进行推断。考虑到这一点，我们知道b不会完全等于β，但是我们能说工资和编码年限之间存在正的线性关系或者非零的线性关系吗？事实上，我们可以通过定义该统计数据的置信区间来实现。这样，我们就能很好地理解真正的参数可能在哪里。在以前的文章中，我们看到了如何计算这样的区间:我们减去/加上临界值t*乘以b的标准误差。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/120a6fb1100a333e892ca16599f0bf34.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/format:webp/1*jiuz9ylCZDe9NqcPnTrg7w.png"/></div></figure><p id="e2f0" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">同样，我们可以为斜率参数定义一个假设检验。一种说法是变量之间没有关系，作为无效假设，另一种说法是变量之间有关系(你也可以更具体地定义另一种假设，只有正或负)。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/c3c6e089c331470ca42547167a2c01b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/format:webp/1*bcF709CRFd97__tm0iplRg.png"/></div></figure><p id="2f83" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">正如在任何其他推理过程中一样，我们必须尊重条件以确保有效的结果。在这种情况下，对于线性回归的斜率，我们必须确保:</p><ul class=""><li id="15fa" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">数据必须是随机生成的；</li><li id="d3f4" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">个人观察应该是独立的(或近似独立的——记住10%规则)；</li><li id="79a3" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">变量之间的关系必须是线性的；</li><li id="446a" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">对于总体中任意给定的x，y的分布一定是正态的；</li><li id="0942" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">对于任何给定的x，方差应该是常数。</li></ul><h1 id="7972" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">从头开始拟合回归线</h1><p id="a877" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们已经定义了回归线的方程。现在，我们需要定义成本函数和更新参数的方法。对于我们的成本函数，我们将使用均方差:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1109a0e36751f64ef80f48a00b40b894.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*6TcOI7qst3rC0Par6cwjzA.png"/></div></figure><p id="67f8" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为了更新我们的参数，我们将使用梯度下降。我不会深入讨论这个方法；我只想给出一些直觉。第一步是计算成本函数相对于每个参数的梯度:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/def6929e4548621f4e661d36bd97b7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*7VdH4E8uythWf2_69CnP8Q.png"/></div></figure><p id="d346" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">然后我们相应地更新参数:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/a3b456d5db32bcf31b40841451ddbeca.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*STkmBnB0qCUojIBND2hd0A.png"/></div></figure><p id="2383" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">其中α代表学习率。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="cf79" class="nm kj it ni b gy nn no l np nq">def fit_lr(X, y, num_iter=1000, lr=0.01):<br/>    n_samples = X.shape[0]<br/>    slope = 0<br/>    intercept = 0<br/><br/>    for _ in range(num_iter):<br/>        y_predicted = np.dot(X, slope) + intercept<br/><br/>        ds = (1/n_samples) * np.dot(X.T, (y_predicted - y))<br/>        di = (1/n_samples) * np.sum(y_predicted - y)<br/><br/>        slope -= lr * ds<br/>        intercept -= lr * di<br/>        <br/>    return (slope, intercept)</span><span id="c891" class="nm kj it ni b gy nr no l np nq">slope, intercept = fit_lr(np.array(yearsCoding[0]), np.array(salaries[0]))</span><span id="2ba8" class="nm kj it ni b gy nr no l np nq">plt.scatter(yearsCoding[0], salaries[0])<br/>plt.xlabel('Years Coding')<br/>plt.ylabel('Salary')<br/>plt.plot(yearsCoding[0],slope*np.array(yearsCoding[0]) + intercept, color='r');</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/3764d14f70ff77e767be0abecdc54427.png" data-original-src="https://miro.medium.com/v2/format:webp/1*SS4CzEJs_s5ShqXZ2TpCEw.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图3:最佳拟合线(红色)对数据科学家样本的工资(10，000€)和编码年数之间的关系进行建模。</p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="0290" class="nm kj it ni b gy nn no l np nq">print('Slope=' + str(slope))<br/>print('Intercept=' + str(intercept))</span><span id="e3f8" class="nm kj it ni b gy nr no l np nq">Slope=0.7096702503648314<br/>Intercept=2.4147010493601404</span></pre><p id="2f88" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">一个编码15年的数据科学家工资会是多少？</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="1261" class="nm kj it ni b gy nn no l np nq">slope * 15 + intercept</span><span id="8d4c" class="nm kj it ni b gy nr no l np nq">13.059754804832611</span></pre><p id="5a12" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">大约是13万€。</p><h1 id="2f5d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">斜率的置信区间</h1><p id="dad2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们可以将斜率^b视为正态分布的随机变量，其均值为b，方差等于<em class="oa"> σ </em>除以x的平方和</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/c6da158b7aeff5b31657a483e7163ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*YwocvidBt1MqzO03XJRQ1g.png"/></div></figure><p id="f345" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">由于我们不知道总体方差，我们使用抽样方差来计算标准误差(se):</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7d30571dd20aa2051cbc0763fc94556a.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*sHmDKb_k2dwP8ep3B3erTg.png"/></div></figure><p id="5daa" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以将SE描述为回归线斜率的抽样分布的标准偏差。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="10bc" class="nm kj it ni b gy nn no l np nq">SS_xx = np.sum((np.array(yearsCoding[0]) - np.mean(np.array(yearsCoding[0])))**2)<br/>SS_xx</span><span id="bf25" class="nm kj it ni b gy nr no l np nq">79.20000000000002</span><span id="58d7" class="nm kj it ni b gy nr no l np nq">SE_b = (np.sqrt(np.sum((np.array(salaries[0])-(np.array(yearsCoding[0])*slope+intercept))**2)/(n-2))) / np.sqrt(SS_xx)<br/>SE_b</span><span id="ae5d" class="nm kj it ni b gy nr no l np nq">0.08687984291368046</span></pre><p id="f730" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们最终可以计算出线性回归斜率的95%置信区间。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="5119" class="nm kj it ni b gy nn no l np nq">print('95% Confidence interval=[' + str(np.round(slope - t.ppf(0.975, df=n-2)*SE_b,2)) + ',' + str(np.round(slope + t.ppf(0.975, df=n-2)*SE_b,2)) + ']')</span><span id="62f6" class="nm kj it ni b gy nr no l np nq">95% Confidence interval=[0.53,0.89]</span></pre><p id="3487" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">回想一下，95%的置信区间意味着真实斜率在95%的时间里都包含在我们的置信区间内。</p><p id="484a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以用这个区间在α= 0.05的显著性水平上检验以下假设:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/84102c7ea74ad66e656cd0da9d861170.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*oraGlgP1c8KY1mRfq6Zz-w.png"/></div></figure><p id="9dcf" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们能得出什么结论？假设H_0为真，我们面临β=0不与95%区间重叠的情况，这种情况发生的概率小于5%。因此，我们拒绝h0，接受建议的h1。它指出，编码的年数和数据科学家的工资之间存在某种关系(非零)。</p><h1 id="8146" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">非线性回归</h1><p id="8414" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，假设一个数据科学家的工资和编码的年数之间的关系不是线性的。在这种情况下，我们看到它更接近于指数关系。如果我们试图用一条线来拟合这些数据，会发生什么？</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="8ac0" class="nm kj it ni b gy nn no l np nq">salaries =    [[3.5, 7.5, 2.5, 7, 9, 40, 3.4, 4.3, 5.3, 5.3, 4, 12.2, 8.5, 10, 18.1, 4.3, 5.2, 5, 5.7, 5.2]]<br/>yearsCoding = [[2, 5,   1  , 4, 5, 10, 2  , 2  , 4,   3  , 4, 6  , 5  , 6 , 7   , 4   , 3  , 4, 4  , 3  ]]<br/>n = 20</span><span id="7e91" class="nm kj it ni b gy nr no l np nq">plt.scatter(yearsCoding[0], salaries[0])<br/>plt.xlabel('Years Coding')<br/>plt.ylabel('Salary');</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/1b44d3d09da4e896e14633b854201f00.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ToFuJbUwkYAtFIKE98bRXA.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图4:数据科学家不同样本的薪资(10000€)与编码年数之间的指数关系。</p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="73c5" class="nm kj it ni b gy nn no l np nq">slope, intercept = fit_lr(np.array(yearsCoding[0]), np.array(salaries[0]))</span><span id="1413" class="nm kj it ni b gy nr no l np nq">plt.scatter(yearsCoding[0], salaries[0])<br/>plt.xlabel('Years Coding')<br/>plt.ylabel('Salary')<br/>plt.plot(yearsCoding[0],slope*np.array(yearsCoding[0]) + intercept, color='r');</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/4b748de96bcc5c12c4efef5c534fe14b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*P1-EflQiVaW9KC_R7hI8ng.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图5:最佳拟合线(红色)对数据科学家样本的工资(10，000€)和编码年数之间的指数关系建模不佳。</p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="0eeb" class="nm kj it ni b gy nn no l np nq">print('Slope=' + str(slope))<br/>print('Intercept=' + str(intercept))</span><span id="9a69" class="nm kj it ni b gy nr no l np nq">Slope=3.35501894004377<br/>Intercept=-5.5729005963397205</span></pre><p id="b5cd" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们发现我们拟合的线根本不能解释这些数据。我们甚至会得到一个刚开始编码的人的负工资，而且我们会严重低估一个编码了10年的人的工资。我们有两个选择。第一种是用指数线拟合数据。这种方法的问题是，我们失去了我们一直在开发的工具来拟合和分析两个变量之间的线性关系。另一方面，我们可以在拟合回归线之前转换我们的数据。</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="1e0d" class="nm kj it ni b gy nn no l np nq">plt.scatter(yearsCoding[0], np.log(salaries[0]))<br/>plt.xlabel('Years Coding')<br/>plt.ylabel('ln(Salary)');</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/b154b5b2da5a161a5ad7a2c16225a79f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*aDEMxPn8VfQylJb_hDxJng.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图6:数据科学家样本按编码年限的工资自然对数(万€)。</p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="8a66" class="nm kj it ni b gy nn no l np nq">slope, intercept = fit_lr(np.array(yearsCoding[0]), np.log(np.array(salaries[0])))</span><span id="3926" class="nm kj it ni b gy nr no l np nq">plt.scatter(yearsCoding[0], np.log(salaries[0]))<br/>plt.xlabel('Years Coding')<br/>plt.ylabel('ln(Salary)')<br/>plt.plot(yearsCoding[0],slope*np.array(yearsCoding[0]) + intercept, color='r');</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/047f7f2f153ec93f527538882678ba64.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Df79hyeTOZZEeu0VYsevUQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">图7:最佳拟合线(红色)对数据科学家样本的工资(10，000€)的自然对数和编码年数之间的关系进行建模。</p></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="7eac" class="nm kj it ni b gy nn no l np nq">print('Slope=' + str(slope))<br/>print('Intercept=' + str(intercept))</span><span id="9466" class="nm kj it ni b gy nr no l np nq">Slope=0.3173211894646696<br/>Intercept=0.5195321580809141</span></pre><p id="a490" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">通过转换，我们看到最佳拟合线实际上解释了编码的可变年数和转换后的可变薪金之间的关系。但是请注意，原始变量之间的关系不是线性的，而是指数关系。</p><p id="8c81" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在这种情况下，编码15年的数据科学家的工资是多少？</p><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="ba70" class="nm kj it ni b gy nn no l np nq">np.exp(slope * 15+intercept)</span><span id="e23b" class="nm kj it ni b gy nr no l np nq">196.24227641696947</span></pre><p id="c58e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这将是几乎2M€！将其与我们之前使用的线性数据集的结果进行比较。</p><h1 id="ff68" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="fd53" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">本文介绍了如何解决线性回归问题，然后使用我们的最佳拟合线来推断我们的参数。在这种情况下，我们关注斜率参数，使用置信区间和假设检验来评估两个感兴趣的变量之间的关联类型。最后，我们引入了转换变量的概念来处理数据可能具有非线性模式的事实。</p><p id="3951" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">保持联系:<a class="ae mk" href="https://www.linkedin.com/in/luisbrasroque/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><h1 id="4be1" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">练习</h1><p id="ba5a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">你将在下周的文章中找到答案。</p><ol class=""><li id="6fb2" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv oe mh mi mj bi translated">Márcia收集了便携式电脑随机样本的电池寿命和价格数据。根据下面提供的数据，总体斜率为0的零假设的检验统计量是什么？</li><li id="8e80" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv oe mh mi mj bi translated">芮随机抽取了一些同事，注意到他们的年龄和他们昨天步行的公里数成正比。回归线斜率的95%置信区间为(15.4，155.2)。芮想用这个区间在5%的显著性水平上检验H_0: β=0 vs. H_1: β ≠ 0。假设推断的所有条件都已满足。芮应该得出什么结论？</li></ol><h2 id="09eb" class="nm kj it bd kk of og dn ko oh oi dp ks lj oj ok ku ln ol om kw lr on oo ky op bi translated">上周的答案</h2><ol class=""><li id="a06f" class="mb mc it lc b ld le lg lh lj oq ln or lr os lv oe mh mi mj bi translated">根据冲浪板经销商的说法，66%的冲浪板是常见的，25%是不常见的，9%是罕见的。José想知道他和他的朋友拥有的板子的稀有程度是否遵循这种分布，所以他随机抽取了500块板子并记录了它们的稀有程度。结果如下表所示。进行拟合优度测试，以确定José和他的朋友拥有的冲浪板的稀有程度分布是否与声称的百分比不一致。</li></ol><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="1c6e" class="nm kj it ni b gy nn no l np nq">table = [['Cards', 345, 125, 30]]<br/>alpha = 0.05<br/>df = pd.DataFrame(table)<br/>df.columns = ['Rarity level', 'Common', 'Uncommon', 'Rare']<br/>df = df.set_index('Rarity level')<br/>df</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/7f6c43cc7bc7ec7774b3b15a137d71e0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HCXgmzZ6QJlEf68jxkhZPw.png"/></div></figure><pre class="mr ms mt mu gt nh ni nj nk aw nl bi"><span id="a212" class="nm kj it ni b gy nn no l np nq">arr = df.to_numpy()<br/><br/>arr = np.concatenate((arr, (np.sum(arr)*np.asarray([0.66, 0.25, 0.09])).reshape(1,-1)))</span><span id="8e8e" class="nm kj it ni b gy nr no l np nq">chi_sq_statistic = np.sum((arr[0]-arr[1])**2/arr[1])<br/>chi_sq_statistic</span><span id="dbca" class="nm kj it ni b gy nr no l np nq">5.681818181818182</span><span id="21ad" class="nm kj it ni b gy nr no l np nq">print('P-value = ' + str(np.round(1-chi2.cdf(chi_sq_statistic, df =2), 4)))</span><span id="ebd3" class="nm kj it ni b gy nr no l np nq">P-value = 0.0584</span><span id="5b52" class="nm kj it ni b gy nr no l np nq">if 1-chi2.cdf(chi_sq_statistic, df =2) &lt; alpha:<br/>    print('Reject H_0')<br/>else:<br/>    print('Fail to reject H_0')</span><span id="1932" class="nm kj it ni b gy nr no l np nq">Fail to reject H_0</span></pre></div></div>    
</body>
</html>