<html>
<head>
<title>The defaultdict Object in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的defaultdict对象</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-better-alternative-to-python-dictionaries-6eaf8b6c48d0?source=collection_archive---------31-----------------------#2021-06-28">https://towardsdatascience.com/a-better-alternative-to-python-dictionaries-6eaf8b6c48d0?source=collection_archive---------31-----------------------#2021-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0fcf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解Python字典对象的更好替代方案</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/643cc3cc9ad056112b29e7a55f2e2c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m416q-XoZaCeImin"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">戴维·舒尔茨在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="be2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个Python开发人员都知道Python中的字典对象。然而，还有另一个类似字典的对象，称为<strong class="lb iu"> <em class="lv"> defaultdict </em> </strong>对象，与常规字典对象相比，它提供了额外的功能。</p><p id="1ae8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面我们通过一个例子来介绍一下这个<strong class="lb iu"> <em class="lv"> defaultdict </em> </strong>对象。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="a553" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">计数示例</h2><p id="5365" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">假设我们想统计一个单词中每个字母出现的次数。我们将创建一个字典，用键作为字母，用它们的值作为出现的次数。</p><p id="28e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用大多数英语词典中最长的单词(根据谷歌):</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="310e" class="md me it nc b gy ng nh l ni nj">word = 'pneumonoultramicroscopicsilicovolcanoconiosis'</span></pre><p id="1b31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用我们都熟悉的dictionary对象来实现这一点，如下所示:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="09d2" class="md me it nc b gy ng nh l ni nj">letter_count = dict()</span><span id="64e6" class="md me it nc b gy nk nh l ni nj">for letter in word:<br/>    if letter not in letter_count:<br/>        letter_count[letter] = 1<br/>    else:<br/>        letter_count[letter] += 1</span><span id="f8b1" class="md me it nc b gy nk nh l ni nj">print(letter_count)</span><span id="9ad9" class="md me it nc b gy nk nh l ni nj"><strong class="nc iu">Output:</strong></span><span id="589e" class="md me it nc b gy nk nh l ni nj">{'p': 2,<br/> 'n': 4,<br/> 'e': 1,<br/> 'u': 2,<br/> 'm': 2,<br/> 'o': 9,<br/> 'l': 3,<br/> 't': 1,<br/> 'r': 2,<br/> 'a': 2,<br/> 'i': 6,<br/> 'c': 6,<br/> 's': 4,<br/> 'v': 1}</span></pre><blockquote class="nl nm nn"><p id="e5f4" class="kz la lv lb b lc ld ju le lf lg jx lh no lj lk ll np ln lo lp nq lr ls lt lu im bi translated">我们首先使用<strong class="lb iu"> dict()构造函数</strong>创建一个空字典对象。然后我们使用for循环遍历单词中的每个字母。当我们循环单词中的每个字母时，我们检查该字母是否已经是字典中的一个关键字。如果没有，我们将键设置为字母，并将其值设置为1(因为这是该字母在我们的循环中第一次出现)。如果这个字母已经作为一个键存在，我们就在它的值上加1。</p></blockquote></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="2522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管一个常规的dictionary对象可以工作，但是这里有两个问题。</p><p id="e887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，注意我们首先必须检查字典中是否已经存在这个键。否则，我们就会有一个<strong class="lb iu"> KeyError </strong>。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="7b09" class="md me it nc b gy ng nh l ni nj">for letter in word:<br/>    letter_count[letter] += 1</span><span id="f951" class="md me it nc b gy nk nh l ni nj"># KeyError</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="e054" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，如果我们试图检查字典中不存在的字母数，我们也会得到一个<strong class="lb iu"> KeyError </strong>。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="1f72" class="md me it nc b gy ng nh l ni nj">letter_count['p']<br/># 2</span><span id="171a" class="md me it nc b gy nk nh l ni nj">letter_count['z']<br/># KeyError</span></pre><p id="d3e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，我们可以用字典<strong class="lb iu"> <em class="lv"> get() </em> </strong>的方法来解决第一个问题，然而第二个问题仍然存在:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="38f8" class="md me it nc b gy ng nh l ni nj">for letter in word:<br/>    letter_count_2[letter] = letter_count_2.get(letter, 0) + 1</span><span id="e626" class="md me it nc b gy nk nh l ni nj">letter_count_2['p']<br/># 2</span><span id="e37b" class="md me it nc b gy nk nh l ni nj">letter_count_2['z']<br/># KeyError</span></pre><blockquote class="nl nm nn"><p id="def7" class="kz la lv lb b lc ld ju le lf lg jx lh no lj lk ll np ln lo lp nq lr ls lt lu im bi translated"><strong class="lb iu"> get </strong>方法接受两个参数:我们想要检索的键的值，以及如果键不存在，我们想要分配给该键的值。</p></blockquote></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><div class="kj kk kl km gt nr"><a rel="noopener follow" target="_blank" href="/sorting-a-dictionary-in-python-4280451e1637"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">用Python对字典进行排序</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">如何用python对字典进行排序</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="80ce" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">defaultdict对象</h2><p id="9b43" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">这是一个很好的例子，当使用一个<a class="ae ky" href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="lv">default dict</em></strong></a><strong class="lb iu"><em class="lv"/></strong>对象会很有帮助。<strong class="lb iu"> <em class="lv"> defaultdict </em> </strong>类是内置<strong class="lb iu"> <em class="lv"> dict </em> </strong>类的子类，也就是说它继承了它。因此，它具有与<strong class="lb iu"> <em class="lv"> dict </em> </strong>类相同的功能，但是，它接受一个额外的参数(作为第一个参数)。这个附加参数<strong class="lb iu"><em class="lv">default _ factory</em></strong>将被调用来为一个尚不存在的键提供一个值。</p><blockquote class="og"><p id="4eb6" class="oh oi it bd oj ok ol om on oo op lu dk translated"><em class="oq">类</em><code class="fe or os ot nc b">collections.<strong class="ak">defaultdict</strong></code>(<em class="oq">default _ factory = None</em>，<em class="oq"> / </em>，<em class="oq">...</em> ])</p></blockquote><p id="1343" class="pw-post-body-paragraph kz la it lb b lc ou ju le lf ov jx lh li ow lk ll lm ox lo lp lq oy ls lt lu im bi translated">我们来看看如何使用<strong class="lb iu"> <em class="lv"> defaultdict </em> </strong>来完成上述任务。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="4740" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先必须从集合模块导入<strong class="lb iu"> <em class="lv">默认字典</em> </strong>:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="54d9" class="md me it nc b gy ng nh l ni nj">from collections import defaultdict</span></pre><p id="b3f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们使用<strong class="lb iu"><em class="lv">default dict()</em></strong>构造函数创建一个<strong class="lb iu"> <em class="lv"> defaultdict </em> </strong>对象:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="ad86" class="md me it nc b gy ng nh l ni nj">letter_count_3 = defaultdict(int)</span></pre><p id="ef04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意我们是如何将<strong class="lb iu"> <em class="lv"> int </em> </strong>函数作为<strong class="lb iu"><em class="lv">default _ factory</em></strong>参数的参数传入的。如果某个键不存在，这个<strong class="lb iu"> <em class="lv"> int </em> </strong>函数将被不带任何参数地调用，以提供该键的默认值。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="fdea" class="md me it nc b gy ng nh l ni nj">for letter in word:<br/>    letter_count_3[letter] += 1</span></pre><blockquote class="nl nm nn"><p id="581b" class="kz la lv lb b lc ld ju le lf lg jx lh no lj lk ll np ln lo lp nq lr ls lt lu im bi translated">因此，当我们在单词上循环时，如果那个键不存在(意味着我们第一次遇到一个字母)，则调用<strong class="lb iu"> int </strong>函数，而不向它传递任何参数，它返回的将是那个键的值。在不传递任何参数的情况下调用<strong class="lb iu"> int </strong>函数会返回整数0。然后，我们在返回的0上加1。</p></blockquote><p id="fac2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这解决了我们上面遇到的两个问题，因为检索任何不存在的键的值都将返回零:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="4950" class="md me it nc b gy ng nh l ni nj">letter_count_3['p']<br/># 2</span><span id="6325" class="md me it nc b gy nk nh l ni nj">letter_count_3['z']<br/># 0</span></pre><p id="2c24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以传入一个<strong class="lb iu"> lambda函数</strong>作为<strong class="lb iu"><em class="lv">default _ factory</em></strong>参数，该参数不接受任何参数并返回值0，如下所示:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="c17c" class="md me it nc b gy ng nh l ni nj">letter_count_3 = defaultdict(lambda: 0)</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="e05d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，考虑注册成为一名媒体会员。每月5美元，你可以无限制地阅读媒体上的故事。如果你用我的 <a class="ae ky" href="https://lmatalka90.medium.com/membership" rel="noopener"> <em class="lv">链接</em> </a> <em class="lv">注册，我会赚一小笔佣金。</em></p><div class="oz pa gp gr pb nr"><a href="https://lmatalka90.medium.com/membership" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">通过我的推荐链接加入媒体——卢艾·马塔尔卡</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">阅读卢艾·马塔尔卡的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">lmatalka90.medium.com</p></div></div><div class="oa l"><div class="pc l oc od oe oa of ks nr"/></div></div></a></div></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="86ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">我希望你喜欢这篇关于Python中</em><strong class="lb iu"><em class="lv">default dict</em></strong><em class="lv">对象的文章。感谢您的阅读！</em></p></div></div>    
</body>
</html>