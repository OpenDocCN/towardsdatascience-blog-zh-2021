<html>
<head>
<title>Through the proxy — conda, git and pip</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过代理— conda、git和pip</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/through-the-proxy-conda-git-and-pip-7ce309ffd6d6?source=collection_archive---------8-----------------------#2021-11-19">https://towardsdatascience.com/through-the-proxy-conda-git-and-pip-7ce309ffd6d6?source=collection_archive---------8-----------------------#2021-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d866" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">打破墙壁🔨</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2e6a9954ceb95c7e2c451f43f595c89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t3vB4eZRYByTJ7Qp"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@hngstrm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亨利&amp;公司</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="c455" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你有没有因为公司的代理而被诱惑把自己的公司烧成灰烬，直到最后一台服务器，然后离开去西伯利亚苔原开始隐士生活？</p><p id="4c0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果是的话，先不要买你的救生包。这里有一个简单的方法可以在一个步骤中自动设置Conda、GIT和pip的代理。</p><h1 id="b31e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">👔用例</h1><p id="bd63" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在为一家公司工作时，你很可能会和代理人一起工作。如果不设置代理，conda、pip和git将无法连接到外部世界。因此，你将无法安装软件包和接触GitHub或任何远程VCS。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/4830c81a6f623e11acfc98d64d0bccf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQRNr_ubV7kgl1tkTzAeKw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代理设置不正确导致连接中断</p></figure><p id="bfc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安全设置也可能会阻止您下载软件包。要设置conda、pip和git，您可以手动修改配置文件(例如condarc和pip.ini)。然而，这可能是痛苦的。尤其是在笔记本电脑上有多个用户的情况下。您也可以使用命令行方式，但是记住这三个组件的命令可能会很繁琐。</p><p id="49f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了简化代理设置，我使用PowerShell脚本或批处理脚本(是的，我公司的笔记本电脑是windows机器)，您可以在<a class="ae kv" href="https://github.com/ThomasBury/conda-git-pip-proxy" rel="noopener ugc nofollow" target="_blank">这个repo </a>中找到。我将解释如何使用它们在一个简单的步骤中设置代理。</p><h1 id="de57" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">🤖使用PowerShell脚本设置代理</h1><p id="ef31" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您可以运行PowerShell脚本，最简单的方法是按如下步骤进行。如果不能，我会在最后解释如何使用批处理脚本来实现相同的结果，仍然是单步执行。</p><ul class=""><li id="1f0f" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">将<a class="ae kv" href="https://github.com/ThomasBury/conda-git-pip-proxy/blob/master/cpg-config.ps1" rel="noopener ugc nofollow" target="_blank"> PowerShell脚本</a> <code class="fe mz na nb nc b">cpg-config.ps1</code>脚本保存在您选择的文件夹中</li><li id="4774" class="mq mr iq ky b kz nd lc ne lf nf lj ng ln nh lr mv mw mx my bi translated">打开一个<code class="fe mz na nb nc b">Windows PowerShell</code>(或者一个<code class="fe mz na nb nc b">anaconda PowerShell</code>，如果你有一个的话)，最好是作为<code class="fe mz na nb nc b">admin</code>(右击- &gt;以管理员身份运行)</li><li id="4d6b" class="mq mr iq ky b kz nd lc ne lf nf lj ng ln nh lr mv mw mx my bi translated">导航到保存脚本的文件夹:<code class="fe mz na nb nc b">cd c:\user\folder_name</code></li><li id="6c58" class="mq mr iq ky b kz nd lc ne lf nf lj ng ln nh lr mv mw mx my bi translated">运行脚本:<code class="fe mz na nb nc b">.\cpg-config.ps1 [proxy_address]</code>然后输入</li></ul><pre class="kg kh ki kj gt ni nc nj nk aw nl bi"><span id="ab3c" class="nm lt iq nc b gy nn no l np nq">PS C:\WINDOWS\system32&gt; cd C:\Users\Projects\cgp-proxy<br/>PS C:\Users\Projects\cgp-proxy&gt; .\cpg-config.ps1 [proxy_address]</span></pre><p id="61db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只需将`[proxy_address]'替换为您的代理地址，所有的、conda、git和pip都将得到配置。</p><p id="e459" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以使用可选参数只配置三个组件中的一个或两个，如下所示:</p><pre class="kg kh ki kj gt ni nc nj nk aw nl bi"><span id="807a" class="nm lt iq nc b gy nn no l np nq">PS C:\WINDOWS\system32&gt; cd C:\Users\Projects\cgp-proxy<br/>PS C:\Users\Projects\cgp-proxy&gt; .\cpg-config.ps1 [proxy_address] pip</span></pre><p id="d1b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，仅用于配置pip。其他可能的值有all、conda、pip、git、git-conda、git-pip、conda-pip。</p><p id="36b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，对于conda，脚本将更新通道顺序，将默认值设为最高优先级，并禁用ssl_verify。</p><p id="63a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行脚本后，conda、pip和git应该能够毫无问题地连接到不同的服务器</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/93e3a422eaca3c5d6cc628829bf001c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*vFeVZoydESE74sY2ML8Vcg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">设置代理后，pip现在可以访问服务器了</p></figure><h1 id="2fd4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">🖊️:如果抛出“没有数字签名”的错误怎么办？</h1><p id="af1d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在尝试运行PowerShell脚本时，您可能会遇到错误<em class="ns">没有数字签名。</em>如果是这样，您可以在PowerShell窗口中键入以下命令:</p><pre class="kg kh ki kj gt ni nc nj nk aw nl bi"><span id="01b2" class="nm lt iq nc b gy nn no l np nq">Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass</span></pre><p id="83aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并键入“是”或“全是”</p><h1 id="b9bf" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">⌨️如何在PowerShell中使用conda</h1><p id="dc54" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果PowerShell无法识别conda，只需打开一个<em class="ns"> anaconda提示符</em>，并使用命令</p><pre class="kg kh ki kj gt ni nc nj nk aw nl bi"><span id="8040" class="nm lt iq nc b gy nn no l np nq">conda init powershell</span></pre><p id="15a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一步只有conda用户才需要。如果您只想配置pip和git，您可以简单地使用</p><pre class="kg kh ki kj gt ni nc nj nk aw nl bi"><span id="6bb9" class="nm lt iq nc b gy nn no l np nq">PS C:\WINDOWS\system32&gt; cd C:\Users\Projects\cgp-proxy<br/>PS C:\Users\Projects\cgp-proxy&gt; .\cpg-config.ps1 [proxy_address] git-pip</span></pre><p id="74b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可选参数的“git-pip”值将使脚本绕过脚本的conda部分。</p><h1 id="55b8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">💻使用命令提示符而不是PowerShell</h1><p id="2042" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您更喜欢使用命令提示符而不是PowerShell，您可以使用如下的<a class="ae kv" href="https://github.com/ThomasBury/conda-git-pip-proxy/blob/master/cpg-config.bat" rel="noopener ugc nofollow" target="_blank">批处理脚本</a></p><ul class=""><li id="ff81" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">将<code class="fe mz na nb nc b">cpg-config.bat</code>脚本保存在您选择的文件夹中</li><li id="de64" class="mq mr iq ky b kz nd lc ne lf nf lj ng ln nh lr mv mw mx my bi translated">打开一个<code class="fe mz na nb nc b">Command Prompt</code>，最好是作为<code class="fe mz na nb nc b">admin</code>(右键- &gt;以管理员身份运行)。相当于用<code class="fe mz na nb nc b">Anaconda CMD</code>做，虽然不是强制的。</li><li id="c6c4" class="mq mr iq ky b kz nd lc ne lf nf lj ng ln nh lr mv mw mx my bi translated">导航到保存脚本的文件夹:<code class="fe mz na nb nc b">cd c:\user\folder_name</code></li><li id="14ba" class="mq mr iq ky b kz nd lc ne lf nf lj ng ln nh lr mv mw mx my bi translated">使用这个命令行:<code class="fe mz na nb nc b">cpg-config.bat [proxy_url] all flexible</code>然后输入。用您的代理url替换<code class="fe mz na nb nc b">[proxy_url]</code>(例如<a class="ae kv" href="https://xyz.proxy.company-name:8080/" rel="noopener ugc nofollow" target="_blank">https://XYZ . proxy . company-name:8080</a>)</li></ul><h1 id="febb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">↩️解除了代理</h1><p id="17d2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当然，您可以随时使用</p><pre class="kg kh ki kj gt ni nc nj nk aw nl bi"><span id="5aee" class="nm lt iq nc b gy nn no l np nq">conda config --remove-key proxy_servers.http<br/>pip config unset global.proxy<br/>git config --global --unset http.proxy</span></pre></div></div>    
</body>
</html>