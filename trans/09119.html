<html>
<head>
<title>Converting conda/pip environments into Docker Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将conda/pip环境转换为Docker图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/converting-conda-pip-environments-into-docker-images-d02aa22e872c?source=collection_archive---------17-----------------------#2021-08-23">https://towardsdatascience.com/converting-conda-pip-environments-into-docker-images-d02aa22e872c?source=collection_archive---------17-----------------------#2021-08-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1476" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Coiled作为Docker图像管道</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6207f4d6da281f01f8d7a22780feecc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zlg6imvX_OAk2bSL0UPhsA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="http://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="f9f7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">TL；博士；医生</h1><p id="1e01" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">构建Docker映像是大多数数据科学家工作流程中必不可少但极具挑战性的一部分。简化这个过程的一个方法是将Coiled连接到您自己的Docker注册表(如DockerHub ),创建一个管道，将您的conda或pip环境转换成可以在其他地方使用的Docker映像。这篇文章向你展示了如何使用<code class="fe mn mo mp mq b">coiled.create_software_environment()</code>命令并通过在你的Coiled cloud仪表板的“帐户”设置中设置容器注册后端来实现。</p><p id="366c" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">你也可以观看下面的视频，获得一步一步的指导:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="ebcb" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><em class="my">免责声明:我在Coiled工作，是一名数据科学传道者实习生。</em> <a class="ae ky" href="http://coiled.io/" rel="noopener ugc nofollow" target="_blank"> <em class="my"> Coiled </em> </a> <em class="my">由</em><a class="ae ky" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"><em class="my">Dask</em></a><em class="my">的最初作者Matthew Rocklin创立，是一个面向分布式计算的开源Python库。</em></p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><h1 id="58d0" class="kz la it bd lb lc ng le lf lg nh li lj jz ni ka ll kc nj kd ln kf nk kg lp lq bi translated">为什么您可能需要Docker图像</h1><p id="0220" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">许多数据科学家需要将conda和/或pip环境转换为Docker映像，以便跨团队协作或将本地工作环境迁移到云上运行。大多数人使用越来越复杂的工作流手动实现这一点(例如，看看<a class="ae ky" rel="noopener" target="_blank" href="/making-docker-and-conda-play-well-together-eda0ff995e3c">这篇中等的文章</a>)。)虽然这在技术上可行，但并不是每个人都能使用。作为一名数据科学家新手，我知道我一开始发现这种体验很复杂，很难掌握。</p><h1 id="742b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">如何盘绕可以让你更容易</h1><p id="5873" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">作为为数据科学家设计的基于云的服务，<a class="ae ky" href="http://coiled.io/" rel="noopener ugc nofollow" target="_blank"> Coiled </a>需要能够将conda和pip环境转换成Docker映像才能正确运行。<code class="fe mn mo mp mq b"><a class="ae ky" href="https://docs.coiled.io/user_guide/software_environment_creation.html" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">coiled.create_software_environment()</strong></a></code> <a class="ae ky" href="https://docs.coiled.io/user_guide/software_environment_creation.html" rel="noopener ugc nofollow" target="_blank">命令</a>将一个<code class="fe mn mo mp mq b"><strong class="lt iu">environment.yml</strong></code> (conda)或<strong class="lt iu"> requirements.txt </strong> (pip)文件转换成Docker映像，然后分发给所有Dask workers，以确保整个盘绕集群的一致性。</p><p id="d078" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是两个代码片段:一个用于conda，一个用于pip:</p><pre class="kj kk kl km gt nl mq nm nn aw no bi"><span id="878d" class="np la it mq b gy nq nr l ns nt"># using conda .yml files<br/>import coiled<br/> <br/>coiled.create_software_environment( <br/>    name='my-env', <br/>    conda='&lt;path/to/environment.yml&gt;' <br/>)</span><span id="769e" class="np la it mq b gy nu nr l ns nt"><br/># using pip .txt files<br/>import coiled</span><span id="31d0" class="np la it mq b gy nu nr l ns nt">coiled.create_software_environment( <br/>    name='my-env', <br/>    pip='&lt;path/to/requirements.txt&gt;' <br/>)</span></pre><p id="bcad" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">本着社区和开源开发的精神，Coiled工程师并没有把这个功能藏起来，而是把它变成了一个通用工具。这意味着您可以将Coiled连接到您自己的Docker注册中心(如DockerHub)来创建conda/pip-to-Docker构建服务。然后，您可以在任何喜欢的地方使用使用Coiled创建的Docker图像。</p><h1 id="2c4d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">如何将Coiled连接到Docker容器注册表</h1><p id="4555" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">默认情况下，Coiled将您创建的软件环境存储在您正在运行的云服务的容器注册表中:AWS、GCP或Azure。<strong class="lt iu"> <em class="my">您可以在Coiled Cloud dashboard的“Account”选项卡中更改此设置，将您的软件环境作为Docker映像保存到您的Docker Hub。</em>T3】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/265c1ea8d08cfa15c1459e15a457cef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Y-Vyq6AriQKBClUBZvbvg.jpeg"/></div></div></figure><p id="a012" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">任何支持Docker注册表API V2的注册表都应该可以工作。在<a class="ae ky" href="https://docs.coiled.io/user_guide/backends.html" rel="noopener ugc nofollow" target="_blank">我们文档的“后端”页面</a>阅读更多细节。</p><p id="c655" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><em class="my">请注意:使用Docker Hub以外的注册中心是一个正在积极开发中的实验性功能。如果您想在</em><a class="ae ky" href="mailto:support@coiled.io" rel="noopener ugc nofollow" target="_blank"><em class="my">support @ Coiled . io</em></a><em class="my">或通过</em><a class="ae ky" href="https://join.slack.com/t/coiled-users/shared_invite/zt-hx1fnr7k-In~Q8ui3XkQfvQon0yN5WQ" rel="noopener ugc nofollow" target="_blank"><em class="my">Coiled Community Slack channel</em></a><em class="my">讨论您的用例，请联系我们。</em></p><p id="9599" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">我在这里偷偷给你一个额外的提示:创建软件环境实际上并不需要你启动一个集群。这意味着你可以使用你的conda/pip-to-Docker管道，而不会烧掉你的任何。</p><h1 id="57f5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么都不发明的价值</h1><p id="7d1c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这就是我喜欢Python生态系统的原因。产品不可或缺的功能可以开放给更广泛的公众使用。它遵循了Matt Rocklin经常宣称的关于开源库Dask的反直觉的最低创造力原则:<strong class="lt iu">“什么都不发明。”</strong></p><p id="530a" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">这个咒语看起来似乎违反直觉，但实际上包含了一个简单的教训:不要试图重新发明轮子，而是创造与人们已经在使用的工具相集成的产品，从而为已经存在的丰富的生态系统增加额外的一块砖。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><p id="ea08" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">我希望这篇文章对你有帮助！<a class="ae ky" href="https://twitter.com/richardpelgrim" rel="noopener ugc nofollow" target="_blank">在Twitter上关注我</a>获取每日数据科学内容。</p><p id="be7f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">或者来我的博客打招呼:</p><div class="nw nx gp gr ny nz"><a href="https://crunchcrunchhuman.com/2021/12/22/kaggle-xgboost-distributed-cloud/" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">在20秒内对20GB数据进行XGBoost训练</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">如果您正在寻找方法来更快地训练XGBoost模型，或者在大于您的机器内存的数据集上训练，这里有一个…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">crunchcrunchhuman.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><p id="c9c8" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><em class="my">原载于2021年8月23日</em><a class="ae ky" href="https://coiled.io/blog/conda-pip-docker-convert/" rel="noopener ugc nofollow" target="_blank"><em class="my">https://coiled . io</em></a><em class="my">。</em></p></div></div>    
</body>
</html>