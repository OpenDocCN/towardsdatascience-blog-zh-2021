<html>
<head>
<title>Question Answering with a fine-tuned BERT</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨å¾®è°ƒè¿‡çš„BERTå›ç­”é—®é¢˜</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/question-answering-with-a-fine-tuned-bert-bc4dafd45626?source=collection_archive---------1-----------------------#2021-05-16">https://towardsdatascience.com/question-answering-with-a-fine-tuned-bert-bc4dafd45626?source=collection_archive---------1-----------------------#2021-05-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7350" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">â€¦åœ¨æ–¯å¦ç¦å¤§å­¦çš„CoQAæ•°æ®é›†ä¸Šä½¿ç”¨æ‹¥æŠ±è„¸å˜å½¢å™¨å’ŒPyTorch</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb573f3398fe9a8bc935821f915ded53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PsajrNCukw6m1h4Vs49bUw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@taypaigey" rel="noopener ugc nofollow" target="_blank">æ³°å‹’</a>åœ¨<a class="ae kv" href="https://unsplash.com/photos/NTur2_QKpg0" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</p></figure><p id="6643" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ¯å½“æˆ‘æƒ³åˆ°é—®é¢˜å›ç­”ç³»ç»Ÿæ—¶ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯æ•™å®¤â€”â€”ä¸€ä¸ªè€å¸ˆæå‡ºçš„é—®é¢˜ï¼Œä¸€ä¸ªæˆ–å‡ ä¸ªå­¦ç”Ÿä¸¾æ‰‹ğŸ™‹æ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå›ç­”é—®é¢˜å¯¹äººç±»æ¥è¯´å¯èƒ½æ˜¯ä¸€é¡¹å¾®ä¸è¶³é“çš„ä»»åŠ¡ï¼Œä½†å¯¹æœºå™¨æ¥è¯´å´ä¸æ˜¯å¦‚æ­¤å¾®ä¸è¶³é“ã€‚è¦å›ç­”ä»»ä½•é—®é¢˜ï¼Œæœºå™¨éƒ½éœ€è¦å…‹æœè®¸å¤šä¸åŒçš„æŒ‘æˆ˜ï¼Œå¦‚è¯æ±‡ç©ºç¼ºã€å…±æŒ‡æ¶ˆè§£ã€è¯­è¨€æ­§ä¹‰ç­‰ã€‚ğŸ˜ä¸ºæ­¤ï¼Œæœºå™¨éœ€è¦å¤§é‡çš„è®­ç»ƒæ•°æ®å’Œæ™ºèƒ½æ¶æ„æ¥ç†è§£å’Œå­˜å‚¨æ–‡æœ¬ä¸­çš„é‡è¦ä¿¡æ¯ã€‚NLPçš„æœ€æ–°è¿›å±•å·²ç»é‡Šæ”¾äº†æœºå™¨ç†è§£æ–‡æœ¬å’Œæ‰§è¡Œä¸åŒä»»åŠ¡çš„èƒ½åŠ›ã€‚ğŸ‘Œ</p><p id="4edc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å®Œæˆä¸€é¡¹å¸¸ç”¨çš„ä»»åŠ¡â€”â€”é—®ç­”ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ‹¥æŠ±è„¸å˜å½¢é‡‘åˆšåº“ä¸­å·²ç»å¯ç”¨çš„å¾®è°ƒBERTæ¨¡å‹æ¥å›ç­”åŸºäºCoQAæ•°æ®é›†çš„æ•…äº‹çš„é—®é¢˜ã€‚æˆ‘ç¡®ä¿¡ï¼Œé€šè¿‡æŸ¥çœ‹ä»£ç ï¼Œæ‚¨ä¼šæ„è¯†åˆ°ä½¿ç”¨ä¸€ä¸ªå¾®è°ƒçš„æ¨¡å‹æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚ğŸ˜</p><p id="ae05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">æ³¨æ„:</em> </strong> <em class="ls">åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬å°†ä¸æ·±å…¥è®¨è®ºBERTæ¶æ„çš„ç»†èŠ‚ã€‚ä½†æ˜¯ï¼Œåœ¨éœ€è¦æˆ–å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä¼šæä¾›è§£é‡Šã€‚</em></p><p id="8186" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">æ–‡ä¸­ä½¿ç”¨çš„ç‰ˆæœ¬:</strong>ç«ç‚¬- 1.7.1ï¼Œå˜å½¢é‡‘åˆš- 4.4.2</p><p id="4a13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬é¦–å…ˆå›ç­”ä¸æœ¬æ–‡ç›¸å…³çš„å‡ ä¸ªé‡è¦é—®é¢˜ã€‚</p><p id="f7ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ä»€ä¹ˆæ˜¯æŠ±è„¸å’Œå˜å½¢é‡‘åˆšï¼Ÿ</strong>ğŸ¤”</p><p id="60ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank">æ‹¥æŠ±è„¸</a>æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†(NLP)æŠ€æœ¯çš„å¼€æºæä¾›å•†ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ‹¥æŠ±è„¸æœ€å…ˆè¿›çš„æ¨¡å‹æ¥æ„å»ºã€è®­ç»ƒå’Œéƒ¨ç½²æ‚¨è‡ªå·±çš„æ¨¡å‹ã€‚<a class="ae kv" href="https://huggingface.co/transformers/" rel="noopener ugc nofollow" target="_blank">å˜å½¢é‡‘åˆš</a>æ˜¯ä»–ä»¬çš„NLPåº“ã€‚æˆ‘å¼ºçƒˆæ¨èä½ å»çœ‹çœ‹æ‹¥æŠ±è„¸å›¢é˜Ÿæ‰€åšçš„æƒŠäººçš„å·¥ä½œï¼Œä»¥åŠä»–ä»¬æ”¶é›†çš„å¤§é‡é¢„å…ˆè®­ç»ƒå¥½çš„NLPæ¨¡å‹ã€‚</p><p id="ee7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ä»€ä¹ˆæ˜¯CoQAï¼Ÿ</strong>ğŸ¤”</p><p id="36e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://arxiv.org/pdf/1808.07042.pdf" rel="noopener ugc nofollow" target="_blank"> CoQA </a>æ˜¯æ–¯å¦ç¦NLPäº2019å¹´å‘å¸ƒçš„ä¼šè¯å¼é—®ç­”æ•°æ®é›†ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå¯¹è¯å¼é—®ç­”ç³»ç»Ÿçš„å¤§è§„æ¨¡æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†æ—¨åœ¨æµ‹é‡æœºå™¨ç†è§£æ–‡æœ¬æ®µè½å¹¶å›ç­”å¯¹è¯ä¸­å‡ºç°çš„ä¸€ç³»åˆ—ç›¸äº’å…³è”çš„é—®é¢˜çš„èƒ½åŠ›ã€‚è¯¥æ•°æ®é›†çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºï¼Œæ¯ä¸ªå¯¹è¯éƒ½æ˜¯é€šè¿‡ä¸¤ä¸ªäººç¾¤å·¥ä½œè€…ä»¥é—®ç­”çš„å½¢å¼å°±ä¸€æ®µå†…å®¹è¿›è¡ŒèŠå¤©æ¥æ”¶é›†çš„ï¼Œå› æ­¤ï¼Œè¿™äº›é—®é¢˜æ˜¯å¯¹è¯å¼çš„ã€‚è¦äº†è§£JSONæ•°æ®çš„æ ¼å¼ï¼Œè¯·å‚è€ƒè¿™ä¸ª<a class="ae kv" href="http://downloads.cs.stanford.edu/nlp/data/coqa/coqa-train-v1.0.json" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a>ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªJSONæ•°æ®é›†çš„æ•…äº‹ã€é—®é¢˜å’Œç­”æ¡ˆæ¥æ„æˆæˆ‘ä»¬çš„æ•°æ®æ¡†æ¶ã€‚</p><p id="53d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ä¼¯ç‰¹æ˜¯ä»€ä¹ˆï¼Ÿ</strong>ğŸ¤”</p><p id="1d3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://arxiv.org/pdf/1810.04805.pdf" rel="noopener ugc nofollow" target="_blank"> BERT </a>æ˜¯æ¥è‡ªå˜å‹å™¨çš„åŒå‘ç¼–ç å™¨è¡¨ç¤ºã€‚å®ƒæ˜¯æœ€æµè¡Œå’Œæœ€å¹¿æ³›ä½¿ç”¨çš„NLPæ¨¡å‹ä¹‹ä¸€ã€‚BERTæ¨¡å‹å¯ä»¥é€šè¿‡æŸ¥çœ‹å•è¯å‰åçš„å•è¯æ¥è€ƒè™‘å•è¯çš„å®Œæ•´ä¸Šä¸‹æ–‡ï¼Œè¿™å¯¹äºç†è§£æŸ¥è¯¢èƒŒåçš„æ„å›¾ç‰¹åˆ«æœ‰ç”¨ã€‚ç”±äºå®ƒçš„åŒå‘æ€§ï¼Œå®ƒå¯¹è¯­è¨€çš„ä¸Šä¸‹æ–‡å’Œæµç¨‹æœ‰æ›´æ·±çš„ç†è§£ï¼Œå› æ­¤ï¼Œç°åœ¨è¢«ç”¨äºè®¸å¤šNLPä»»åŠ¡ä¸­ã€‚å…³äºBERTçš„æ›´å¤šç»†èŠ‚ä»¥åŠä»£ç ã€‚ğŸ™ƒ</p><p id="bbd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å˜å½¢é‡‘åˆšåº“æœ‰å¾ˆå¤šä¸åŒçš„<a class="ae kv" href="https://huggingface.co/transformers/model_doc/bert.html#" rel="noopener ugc nofollow" target="_blank"> BERTæ¨¡å‹</a>ã€‚å¾ˆå®¹æ˜“ä»è¿™ä¸ªåº“ä¸­æ‰¾åˆ°ä¸€ä¸ªç‰¹å®šäºä»»åŠ¡çš„æ¨¡å‹å¹¶å®Œæˆæˆ‘ä»¬çš„ä»»åŠ¡ã€‚</p><p id="929b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼Œä½†é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„æ•°æ®é›†ã€‚ğŸ˜Š</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lt"><img src="../Images/b80a4ed2c024a536f0f93f51d2800e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrZPaUEKIvMUJ5FV81mIzA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lu"><img src="../Images/7ef70211d691055b80928d65998a6918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BkpMqgKKzilgj0FFMLlclw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">æ–¯å¦ç¦çš„JSONæ•°æ®</p></figure><p id="5712" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JSONæ•°æ®æœ‰å¾ˆå¤šå­—æ®µã€‚å‡ºäºæˆ‘ä»¬çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªâ€œé—®é¢˜â€å’Œâ€œç­”æ¡ˆâ€çš„â€œæ•…äº‹â€ã€â€œè¾“å…¥æ–‡æœ¬â€ï¼Œå¹¶å½¢æˆæˆ‘ä»¬çš„æ•°æ®æ¡†æ¶ã€‚</p><h2 id="0c6f" class="lv lw iq bd lx ly lz dn ma mb mc dp md lf me mf mg lj mh mi mj ln mk ml mm mn bi translated"><strong class="ak">å®‰è£…å˜å‹å™¨</strong></h2><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="9f29" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">!pip install</strong> transformers</span></pre><h2 id="da5f" class="lv lw iq bd lx ly lz dn ma mb mc dp md lf me mf mg lj mh mi mj ln mk ml mm mn bi translated"><strong class="ak">å¯¼å…¥åº“</strong></h2><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="6d74" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">import</strong> pandas <strong class="mp ir">as</strong> pd<br/><strong class="mp ir">import</strong> numpy <strong class="mp ir">as</strong> np<br/><strong class="mp ir">import</strong> torch<br/><strong class="mp ir">from</strong> transformers <strong class="mp ir">import</strong> BertForQuestionAnswering<br/><strong class="mp ir">from</strong> transformers <strong class="mp ir">import</strong> BertTokenizer</span></pre><h2 id="fcd8" class="lv lw iq bd lx ly lz dn ma mb mc dp md lf me mf mg lj mh mi mj ln mk ml mm mn bi translated">ä»æ–¯å¦ç¦ç½‘ç«™åŠ è½½æ•°æ®</h2><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="a95a" class="lv lw iq mp b gy mt mu l mv mw">coqa = <strong class="mp ir">pd.read_json</strong>('<a class="ae kv" href="http://downloads.cs.stanford.edu/nlp/data/coqa/coqa-train-v1.0.json'" rel="noopener ugc nofollow" target="_blank">http://downloads.cs.stanford.edu/nlp/data/coqa/coqa-train-v1.0.json'</a>)<br/>coqa<strong class="mp ir">.head()</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/28fe40a70537d638d3af47ad9338967e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrD-KnfAyE5Vx4N56Q10sg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">åŠ è½½çš„æ•°æ®é›†</p></figure><h2 id="b566" class="lv lw iq bd lx ly lz dn ma mb mc dp md lf me mf mg lj mh mi mj ln mk ml mm mn bi translated">æ•°æ®æ¸…ç†</h2><p id="4539" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">æˆ‘ä»¬å°†å¤„ç†â€œæ•°æ®â€åˆ—ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åˆ é™¤â€œç‰ˆæœ¬â€åˆ—ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="5348" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">del</strong> coqa["version"]</span></pre><p id="be40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯¹äºæ¯ä¸€ä¸ªé—®ç­”é…å¯¹ï¼Œæˆ‘ä»¬å°†æŠŠé“¾æ¥çš„æ•…äº‹é™„åŠ åˆ°å®ƒä¸Šé¢ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="c630" class="lv lw iq mp b gy mt mu l mv mw"><em class="ls">#required columns in our dataframe</em><br/>cols = ["text","question","answer"]</span><span id="491a" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">#list of lists to create our dataframe</em><br/>comp_list = []<br/><strong class="mp ir">for</strong> index, row <strong class="mp ir">in</strong> coqa<strong class="mp ir">.iterrows()</strong>:<br/>    <strong class="mp ir">for</strong> i <strong class="mp ir">in</strong> <strong class="mp ir">range</strong>(<strong class="mp ir">len</strong>(row["data"]["questions"])):<br/>        temp_list = []<br/>        temp_list<strong class="mp ir">.append</strong>(row["data"]["story"])<br/>        temp_list<strong class="mp ir">.append</strong>(row["data"]["questions"][i]["input_text"])<br/>        temp_list<strong class="mp ir">.append</strong>(row["data"]["answers"][i]["input_text"])<br/>        comp_list<strong class="mp ir">.append</strong>(temp_list)</span><span id="523f" class="lv lw iq mp b gy nd mu l mv mw">new_df = <strong class="mp ir">pd.DataFrame</strong>(comp_list, columns=cols) </span><span id="11f3" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">#saving the dataframe to csv file for further loading</em><br/>new_df<strong class="mp ir">.to_csv</strong>("CoQA_data.csv", index=<strong class="mp ir">False</strong>)</span></pre><h2 id="74aa" class="lv lw iq bd lx ly lz dn ma mb mc dp md lf me mf mg lj mh mi mj ln mk ml mm mn bi translated">ä»æœ¬åœ°CSVæ–‡ä»¶åŠ è½½æ•°æ®</h2><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="4660" class="lv lw iq mp b gy mt mu l mv mw">data = <strong class="mp ir">pd.read_csv</strong>("CoQA_data.csv")<br/>data<strong class="mp ir">.head()</strong></span></pre><p id="a5ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™æ˜¯æˆ‘ä»¬æ¸…ç†åçš„æ•°æ®ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/8e02cd9f9d751a590bd96f257d3d7840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C5uTFeTMHrJ64BZil8_mCw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">æ¸…ç†çš„æ•°æ®</p></figure><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="87ce" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">print</strong>("Number of question and answers: ", <strong class="mp ir">len</strong>(data))</span></pre><p id="c27f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ•°æ®é›†æœ‰å¾ˆå¤šé—®é¢˜å’Œç­”æ¡ˆï¼Œæˆ‘ä»¬æ¥æ•°ä¸€ä¸‹ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="8ee7" class="lv lw iq mp b gy mt mu l mv mw">Number of question and answers:  108647</span></pre><h2 id="1ef5" class="lv lw iq bd lx ly lz dn ma mb mc dp md lf me mf mg lj mh mi mj ln mk ml mm mn bi translated">æ„å»ºèŠå¤©æœºå™¨äºº</h2><p id="415f" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">ä½¿ç”¨è¿™äº›é¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹çš„æœ€å¤§å¥½å¤„æ˜¯ï¼Œåªéœ€ä¸¤è¡Œç®€å•çš„ä»£ç å°±å¯ä»¥åŠ è½½æ¨¡å‹åŠå…¶æ ‡è®°å™¨ã€‚ğŸ˜²ä¸å°±æ˜¯å•çº¯çš„å“‡å—ï¼Ÿå¯¹äºæ–‡æœ¬åˆ†ç±»è¿™æ ·çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ•°æ®é›†ä¸Šå¾®è°ƒBERTã€‚ä½†å¯¹äºé—®ç­”ä»»åŠ¡ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå³ä½¿æˆ‘ä»¬çš„æ–‡æœ¬æ¥è‡ªå®Œå…¨ä¸åŒçš„é¢†åŸŸï¼Œä¹Ÿèƒ½è·å¾—ä¸é”™çš„ç»“æœã€‚ä¸ºäº†å¾—åˆ°æ›´å¥½çš„ç»“æœï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªä¼¯ç‰¹æ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹æ˜¯æ ¹æ®å°é˜ŸåŸºå‡†è¿›è¡Œå¾®è°ƒçš„ã€‚</p><p id="21f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯¹äºæˆ‘ä»¬çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å˜å½¢é‡‘åˆšåº“ä¸­çš„<strong class="ky ir"> BertForQuestionAnswering </strong>ç±»ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="107e" class="lv lw iq mp b gy mt mu l mv mw">model = <strong class="mp ir">BertForQuestionAnswering.from_pretrained</strong>('bert-large-uncased-whole-word-masking-finetuned-squad')<br/>tokenizer = <strong class="mp ir">BertTokenizer.from_pretrained</strong>('bert-large-uncased-whole-word-masking-finetuned-squad')</span></pre><p id="c758" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é¢„è®¡ä¸‹è½½éœ€è¦å‡ åˆ†é’Ÿï¼Œå› ä¸ºBERT-largeæ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ¨¡å‹ï¼Œæœ‰24å±‚å’Œ340Må‚æ•°ï¼Œä½¿å…¶æˆä¸º1.34GBçš„æ¨¡å‹ã€‚</p><h2 id="7272" class="lv lw iq bd lx ly lz dn ma mb mc dp md lf me mf mg lj mh mi mj ln mk ml mm mn bi translated">é—®é—®é¢˜</h2><p id="5c0f" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">è®©æˆ‘ä»¬éšæœºé€‰æ‹©ä¸€ä¸ªé—®é¢˜ç¼–å·ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="e40c" class="lv lw iq mp b gy mt mu l mv mw">random_num = <strong class="mp ir">np.random.randint</strong>(0,<strong class="mp ir">len</strong>(data))</span><span id="cbc3" class="lv lw iq mp b gy nd mu l mv mw">question = data["question"][random_num]<br/>text = data["text"][random_num]</span></pre><p id="055e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬å°†é—®é¢˜å’Œæ–‡æœ¬æ ‡è®°æˆä¸€å¯¹ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="dfa6" class="lv lw iq mp b gy mt mu l mv mw">input_ids = tokenizer<strong class="mp ir">.encode</strong>(question, text)<br/><strong class="mp ir">print</strong>("The input has a total of {} tokens."<strong class="mp ir">.format</strong>(<strong class="mp ir">len</strong>(input_ids)))</span></pre><p id="61a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜å’Œæ–‡æœ¬å¯¹æœ‰å¤šå°‘ä¸ªä»¤ç‰Œã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="2b82" class="lv lw iq mp b gy mt mu l mv mw">The input has a total of 427 tokens.</span></pre><p id="7905" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†çœ‹çœ‹æˆ‘ä»¬çš„è®°å·èµ‹äºˆå™¨åœ¨åšä»€ä¹ˆï¼Œè®©æˆ‘ä»¬æ‰“å°å‡ºè®°å·å’Œå®ƒä»¬çš„idã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="6ee8" class="lv lw iq mp b gy mt mu l mv mw">tokens = tokenizer<strong class="mp ir">.convert_ids_to_tokens</strong>(input_ids)</span><span id="5b13" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">for</strong> token, id <strong class="mp ir">in</strong> <strong class="mp ir">zip</strong>(tokens, input_ids):<br/>    <strong class="mp ir">print</strong>('{:8}{:8,}'<strong class="mp ir">.format</strong>(token,id))</span></pre><div class="kg kh ki kj gt ab cb"><figure class="nf kk ng nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/e4491b6a5fd79dd3cc5e55e79c0db047.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*521ml0xTQXNZKTiYsDrIEw.png"/></div></figure><figure class="nf kk nl nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/c9f28639e370952ec381b0ae38a1ed21.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*r1g-N-vJbDmBApYr89BP8A.png"/></div></figure><figure class="nf kk nm nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/41d186c2f452033ab6286def8bf581e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*5GD1L38aQfgB5g2vv0dIpA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk nn di no np translated">å¸¦æœ‰idçš„ä»¤ç‰Œ</p></figure></div><p id="17fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">BERTæœ‰ä¸€ç§å¤„ç†æ ‡è®°åŒ–è¾“å…¥çš„ç‹¬ç‰¹æ–¹æ³•ã€‚ä»ä¸Šé¢çš„æˆªå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç‰¹æ®Šçš„ä»¤ç‰Œ[CLS]å’Œ[SEP]ã€‚[CLS] tokenä»£è¡¨åˆ†ç±»ï¼Œå®ƒä»£è¡¨å¥å­çº§åˆ«çš„åˆ†ç±»ï¼Œåœ¨æˆ‘ä»¬åˆ†ç±»æ—¶ä½¿ç”¨ã€‚BERTä½¿ç”¨çš„å¦ä¸€ä¸ªä»¤ç‰Œæ˜¯[SEP]ã€‚å®ƒç”¨äºåˆ†éš”ä¸¤æ®µæ–‡æœ¬ã€‚ä½ å¯ä»¥åœ¨ä¸Šé¢çš„æˆªå›¾é‡Œçœ‹åˆ°ä¸¤ä¸ª[SEP]ä»¤ç‰Œï¼Œä¸€ä¸ªåœ¨é—®é¢˜åé¢ï¼Œä¸€ä¸ªåœ¨æ­£æ–‡åé¢ã€‚</p><p id="769d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é™¤äº†â€œæ ‡è®°åµŒå…¥â€ï¼ŒBERTå†…éƒ¨è¿˜ä½¿ç”¨äº†â€œæ®µåµŒå…¥â€å’Œâ€œä½ç½®åµŒå…¥â€ã€‚ç‰‡æ®µåµŒå…¥æœ‰åŠ©äºBERTåŒºåˆ†é—®é¢˜å’Œæ–‡æœ¬ã€‚åœ¨å®è·µä¸­ï¼Œå¦‚æœåµŒå…¥æ¥è‡ªå¥å­1ï¼Œæˆ‘ä»¬ä½¿ç”¨0çš„å‘é‡ï¼Œå¦åˆ™å¦‚æœåµŒå…¥æ¥è‡ªå¥å­2ï¼Œæˆ‘ä»¬ä½¿ç”¨1çš„å‘é‡ã€‚ä½ç½®åµŒå…¥æœ‰åŠ©äºç¡®å®šå•è¯åœ¨åºåˆ—ä¸­çš„ä½ç½®ã€‚æ‰€æœ‰è¿™äº›åµŒå…¥éƒ½è¢«é¦ˆé€åˆ°è¾“å…¥å±‚ã€‚</p><p id="b791" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å˜å½¢é‡‘åˆšåº“å¯ä»¥ä½¿ç”¨<em class="ls">pretrainedtokenizer . encode _ plus()</em>è‡ªè¡Œåˆ›å»ºç‰‡æ®µåµŒå…¥ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥åˆ›é€ æˆ‘ä»¬è‡ªå·±çš„ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸ºæ¯ä¸ªä»¤ç‰ŒæŒ‡å®šä¸€ä¸ª0æˆ–1ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="941c" class="lv lw iq mp b gy mt mu l mv mw"><em class="ls">#first occurence of [SEP] token</em><br/>sep_idx = input_ids<strong class="mp ir">.index</strong>(tokenizer<strong class="mp ir">.sep_token_id</strong>)<br/><strong class="mp ir">print</strong>("SEP token index: ", sep_idx)</span><span id="e93d" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">#number of tokens in segment A (question) - this will be one more than the sep_idx as the index in Python starts from 0<br/></em>num_seg_a = sep_idx+1<br/><strong class="mp ir">print</strong>("Number of tokens in segment A: ", num_seg_a)</span><span id="3881" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">#number of tokens in segment B (text)</em><br/>num_seg_b = <strong class="mp ir">len</strong>(input_ids) - num_seg_a<br/><strong class="mp ir">print</strong>("Number of tokens in segment B: ", num_seg_b)</span><span id="b4fd" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">#creating the segment ids</em><br/>segment_ids = [0]*num_seg_a + [1]*num_seg_b</span><span id="d5d2" class="lv lw iq mp b gy nd mu l mv mw">#making sure that every input token has a segment id<strong class="mp ir"><br/>assert</strong> <strong class="mp ir">len</strong>(segment_ids) == <strong class="mp ir">len</strong>(input_ids)</span></pre><p id="eea1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™æ˜¯è¾“å‡ºã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="1b1d" class="lv lw iq mp b gy mt mu l mv mw">SEP token index: 8<br/>Number of tokens in segment A: 9<br/>Number of tokens in segment B: 418</span></pre><p id="7b65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨è®©æˆ‘ä»¬æŠŠå®ƒè¾“å…¥åˆ°æˆ‘ä»¬çš„æ¨¡å‹ä¸­ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="ce9d" class="lv lw iq mp b gy mt mu l mv mw"><em class="ls">#token input_ids to represent the input and token segment_ids to differentiate our segments - question and text</em><br/>output = <strong class="mp ir">model</strong>(<strong class="mp ir">torch.tensor</strong>([input_ids]),  token_type_ids=<strong class="mp ir">torch.tensor</strong>([segment_ids]))</span></pre><p id="32a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æŸ¥çœ‹æœ€å¯èƒ½çš„å¼€å§‹å’Œç»“æŸå•è¯ï¼Œå¹¶ä¸”ä»…å½“ç»“æŸæ ‡è®°åœ¨å¼€å§‹æ ‡è®°ä¹‹åæ—¶æ‰æä¾›ç­”æ¡ˆã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="e5c8" class="lv lw iq mp b gy mt mu l mv mw"><em class="ls">#tokens with highest start and end scores</em><br/>answer_start = <strong class="mp ir">torch.argmax</strong>(output.start_logits)<br/>answer_end = <strong class="mp ir">torch.argmax</strong>(output.end_logits)</span><span id="1327" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">if</strong> answer_end &gt;= answer_start:<br/>    answer = " "<strong class="mp ir">.join</strong>(tokens[answer_start:answer_end+1])<br/><strong class="mp ir">else:</strong><br/>    <strong class="mp ir">print</strong>("I am unable to find the answer to this question. Can you please ask another question?")<br/>    <br/><strong class="mp ir">print</strong>("\nQuestion:\n{}"<strong class="mp ir">.format</strong>(question<strong class="mp ir">.capitalize()</strong>))<br/><strong class="mp ir">print</strong>("\nAnswer:\n{}."<strong class="mp ir">.format</strong>(answer<strong class="mp ir">.capitalize()</strong>))</span></pre><p id="81dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™æ˜¯æˆ‘ä»¬çš„é—®é¢˜å’Œç­”æ¡ˆã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="6172" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">Question:</strong><br/>Who is the acas director?<br/><strong class="mp ir"><br/>Answer:</strong><br/>Agnes karin ##gu.</span></pre><p id="fdbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å“‡ï¼ä¼¯ç‰¹é¢„æµ‹åˆ°äº†æ­£ç¡®çš„ç­”æ¡ˆâ€”â€”â€œè‰¾æ ¼å°¼ä¸Â·å¡ç³å¤â€ã€‚ä½†æ˜¯ï¼Œå›å¤é‡Œè¿™ä¸ªâ€œ##â€æ˜¯ä»€ä¹ˆï¼Ÿç»§ç»­è¯»ä¸‹å»ï¼ğŸ“™</p><p id="e11d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¼¯ç‰¹ä½¿ç”¨<strong class="ky ir">è¯å—æ ‡è®°åŒ–</strong>ã€‚åœ¨BERTä¸­ï¼Œç”Ÿåƒ»å­—è¢«åˆ†è§£æˆå­å­—/ç‰‡æ®µã€‚å•è¯å—æ ‡è®°åŒ–ä½¿ç”¨##æ¥åˆ†éš”å·²æ‹†åˆ†çš„æ ‡è®°ã€‚ä¾‹å¦‚:â€œKarinâ€æ˜¯ä¸€ä¸ªå¸¸ç”¨è¯ï¼Œæ‰€ä»¥wordpieceä¸ä¼šæ‹†åˆ†å®ƒã€‚ç„¶è€Œï¼Œâ€œKaringuâ€æ˜¯ä¸€ä¸ªç½•è§çš„è¯ï¼Œæ‰€ä»¥wordpieceå°†å…¶æ‹†åˆ†ä¸ºå•è¯â€œKarinâ€å’Œâ€œ##guâ€ã€‚æ³¨æ„ï¼Œå®ƒåœ¨å¤å‰é¢åŠ äº†##ï¼Œè¡¨ç¤ºå®ƒæ˜¯æ‹†åˆ†åçš„ç¬¬äºŒä¸ªè¯ã€‚</p><p id="e8b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½¿ç”¨å•è¯å—æ ‡è®°åŒ–èƒŒåçš„æƒ³æ³•æ˜¯å‡å°‘è¯æ±‡è¡¨çš„å¤§å°ï¼Œä»è€Œæé«˜è®­ç»ƒæ€§èƒ½ã€‚æƒ³æƒ³è¿™äº›è¯ï¼Œè·‘ï¼Œè·‘ï¼Œè·‘è€…ã€‚å¦‚æœæ²¡æœ‰å•è¯å—æ ‡è®°åŒ–ï¼Œæ¨¡å‹å¿…é¡»ç‹¬ç«‹åœ°å­˜å‚¨å’Œå­¦ä¹ æ‰€æœ‰ä¸‰ä¸ªå•è¯çš„å«ä¹‰ã€‚ä½†æ˜¯ï¼Œé€šè¿‡è¯å—æ ‡è®°åŒ–ï¼Œè¿™ä¸‰ä¸ªå•è¯ä¸­çš„æ¯ä¸€ä¸ªéƒ½å°†è¢«æ‹†åˆ†ä¸ºâ€œrunâ€å’Œç›¸å…³çš„â€œ# #åç¼€â€(å¦‚æœæœ‰åç¼€çš„è¯ï¼Œä¾‹å¦‚ï¼Œâ€œrunâ€ï¼Œâ€œ##ningâ€ï¼Œâ€œ##nerâ€)ã€‚ç°åœ¨ï¼Œæ¨¡å‹å°†å­¦ä¹ å•è¯â€œrunâ€çš„ä¸Šä¸‹æ–‡ï¼Œå…¶ä½™çš„æ„æ€å°†è¢«ç¼–ç åœ¨åç¼€ä¸­ï¼Œè¿™å°†ä»å…·æœ‰ç±»ä¼¼åç¼€çš„å…¶ä»–å•è¯ä¸­å­¦ä¹ ã€‚</p><p id="4146" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¾ˆæœ‰è¶£ï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç®€å•ä»£ç æ¥é‡æ„è¿™äº›å•è¯ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="2448" class="lv lw iq mp b gy mt mu l mv mw">answer = tokens[answer_start]</span><span id="13ec" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">for</strong> i <strong class="mp ir">in</strong> <strong class="mp ir">range</strong>(answer_start+1, answer_end+1):<br/>    <strong class="mp ir">if </strong>tokens[i][0:2] == "##":<br/>        answer += tokens[i][2:]<br/>  <strong class="mp ir">  else:</strong><br/>        answer += " " + tokens[i]</span></pre><p id="619a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸Šé¢çš„ç­”æ¡ˆç°åœ¨å°†å˜æˆ:<strong class="ky ir"> Agnes karingu </strong></p><p id="691e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨è®©æˆ‘ä»¬æŠŠè¿™ä¸ªé—®ç­”è¿‡ç¨‹å˜æˆä¸€ä¸ªç®€å•çš„å‡½æ•°ã€‚</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="df0b" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">def</strong> question_answer(question, text):<br/>    <br/>    <em class="ls">#tokenize question and text as a pair</em><br/>    input_ids = tokenizer<strong class="mp ir">.encode</strong>(question, text)<br/>    <br/>   <em class="ls"> #string version of tokenized ids</em><br/>    tokens = tokenizer<strong class="mp ir">.convert_ids_to_tokens</strong>(input_ids)<br/>    <br/>  <em class="ls">  #segment IDs</em><br/>    #first occurence of [SEP] token<br/>    sep_idx = input_ids<strong class="mp ir">.index</strong>(tokenizer<strong class="mp ir">.sep_token_id</strong>)</span><span id="6772" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">    #number of tokens in segment A (question)</em><br/>    num_seg_a = sep_idx+1</span><span id="1894" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">    #number of tokens in segment B (text)</em><br/>    num_seg_b = <strong class="mp ir">len</strong>(input_ids) - num_seg_a<br/>    <br/>    <em class="ls">#list of 0s and 1s for segment embeddings</em><br/>    segment_ids = [0]*num_seg_a + [1]*num_seg_b</span><span id="2e0e" class="lv lw iq mp b gy nd mu l mv mw">    <strong class="mp ir">assert</strong> <strong class="mp ir">len</strong>(segment_ids) == <strong class="mp ir">len</strong>(input_ids)<br/>    <br/>    <em class="ls">#model output using input_ids and segment_ids</em><br/>    output = <strong class="mp ir">model</strong>(<strong class="mp ir">torch.tensor</strong>([input_ids]), token_type_ids=<strong class="mp ir">torch.tensor</strong>([segment_ids]))<br/>    <br/>    <em class="ls">#reconstructing the answer</em><br/>    answer_start = <strong class="mp ir">torch.argmax</strong>(output.start_logits)<br/>    answer_end = <strong class="mp ir">torch.argmax</strong>(output.end_logits)</span><span id="61db" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">    if</strong> answer_end &gt;= answer_start:<br/>        answer = tokens[answer_start]<br/>        <strong class="mp ir">for</strong> i <strong class="mp ir">in</strong> range(answer_start+1, answer_end+1):<br/>            <strong class="mp ir">if</strong> tokens[i][0:2] == "##":<br/>                answer += tokens[i][2:]<br/>            <strong class="mp ir">else:</strong><br/>                answer += " " + tokens[i]<br/>                <br/>    <strong class="mp ir">if</strong> answer<strong class="mp ir">.startswith</strong>("[CLS]"):<br/>        answer = "Unable to find the answer to your question."<br/>    <br/>    <strong class="mp ir">print</strong>("\nPredicted answer:\n{}"<strong class="mp ir">.format</strong>(answer<strong class="mp ir">.capitalize()</strong>))</span></pre><p id="73c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬ä½¿ç”¨æ•°æ®é›†ä¸­çš„ä¸€ä¸ªæ–‡æœ¬å’Œé—®é¢˜æ¥æµ‹è¯•è¿™ä¸ªå‡½æ•°ã€‚ğŸ˜›</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="748e" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">text</strong> = """New York (CNN) -- More than 80 Michael Jackson collectibles -- including the late pop star's famous rhinestone-studded glove from a 1983 performance -- were auctioned off Saturday, reaping a total $2 million. Profits from the auction at the Hard Rock Cafe in New York's Times Square crushed pre-sale expectations of only $120,000 in sales. The highly prized memorabilia, which included items spanning the many stages of Jackson's career, came from more than 30 fans, associates and family members, who contacted Julien's Auctions to sell their gifts and mementos of the singer. Jackson's flashy glove was the big-ticket item of the night, fetching $420,000 from a buyer in Hong Kong, China. Jackson wore the glove at a 1983 performance during \"Motown 25,\" an NBC special where he debuted his revolutionary moonwalk. Fellow Motown star Walter \"Clyde\" Orange of the Commodores, who also performed in the special 26 years ago, said he asked for Jackson's autograph at the time, but Jackson gave him the glove instead. "The legacy that [Jackson] left behind is bigger than life for me,\" Orange said. \"I hope that through that glove people can see what he was trying to say in his music and what he said in his music.\" Orange said he plans to give a portion of the proceeds to charity. Hoffman Ma, who bought the glove on behalf of Ponte 16 Resort in Macau, paid a 25 percent buyer's premium, which was tacked onto all final sales over $50,000. Winners of items less than $50,000 paid a 20 percent premium."""</span><span id="5265" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">question</strong> = "Where was the Auction held?"</span><span id="3c55" class="lv lw iq mp b gy nd mu l mv mw">question_answer(question, text)</span><span id="cfe4" class="lv lw iq mp b gy nd mu l mv mw"><em class="ls">#original answer from the dataset</em><strong class="mp ir"><br/>print</strong>("Original answer:\n", data<strong class="mp ir">.loc</strong>[data["question"] == question]["answer"].values[0]))</span></pre><p id="3c1c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="a842" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">Predicted answer:</strong><br/>Hard rock cafe in new york ' s times square</span><span id="1b36" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">Original answer:</strong><br/>Hard Rock Cafe</span></pre><p id="cfbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸€ç‚¹ä¹Ÿä¸å·®ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬çš„ä¼¯ç‰¹æ¨¡å‹ç»™å‡ºäº†æ›´è¯¦ç»†çš„å›ç­”ã€‚</p><p id="7c72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™æ˜¯ä¸€ä¸ªå°å‡½æ•°ï¼Œç”¨æ¥æµ‹è¯•BERTå¯¹ä¸Šä¸‹æ–‡çš„ç†è§£ç¨‹åº¦ã€‚æˆ‘åªæ˜¯æŠŠå›ç­”é—®é¢˜çš„è¿‡ç¨‹ä½œä¸ºä¸€ä¸ªå¾ªç¯æ¥ç©è¿™ä¸ªæ¨¡å‹ã€‚ğŸ’ƒ</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="a106" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">text</strong> = <strong class="mp ir">input</strong>("Please enter your text: \n")<br/><strong class="mp ir">question</strong> = <strong class="mp ir">input</strong>("\nPlease enter your question: \n")</span><span id="2f6c" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">while</strong> <strong class="mp ir">True</strong>:<br/>    question_answer(question, text)<br/>    <br/>    flag = <strong class="mp ir">True</strong><br/>    flag_N = <strong class="mp ir">False</strong><br/>    <br/>    <strong class="mp ir">while</strong> flag:<br/>        response = <strong class="mp ir">input</strong>("\nDo you want to ask another question based on this text (Y/N)? ")<br/>        <strong class="mp ir">if</strong> response[0] == "Y":<br/>            question = <strong class="mp ir">input</strong>("\nPlease enter your question: \n")<br/>            flag = False<br/>        <strong class="mp ir">elif</strong> response[0] == "N":<br/>            <strong class="mp ir">print</strong>("\nBye!")<br/>            flag = False<br/>            flag_N = True<br/>            <br/>    <strong class="mp ir">if</strong> flag_N == <strong class="mp ir">True</strong>:<br/>        <strong class="mp ir">break</strong></span></pre><p id="7f41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è€Œä¸”ï¼Œç»“æœï¼ğŸ˜</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="ae8d" class="lv lw iq mp b gy mt mu l mv mw"><strong class="mp ir">Please enter your text: </strong><br/>The Vatican Apostolic Library (), more commonly called the Vatican Library or simply the Vat, is the library of the Holy See, located in Vatican City. Formally established in 1475, although it is much older, it is one of the oldest libraries in the world and contains one of the most significant collections of historical texts. It has 75,000 codices from throughout history, as well as 1.1 million printed books, which include some 8,500 incunabula.   The Vatican Library is a research library for history, law, philosophy, science and theology. The Vatican Library is open to anyone who can document their qualifications and research needs. Photocopies for private study of pages from books published between 1801 and 1990 can be requested in person or by mail.   In March 2014, the Vatican Library began an initial four-year project of digitising its collection of manuscripts, to be made available online.   The Vatican Secret Archives were separated from the library at the beginning of the 17th century; they contain another 150,000 items.   Scholars have traditionally divided the history of the library into five periods, Pre-Lateran, Lateran, Avignon, Pre-Vatican and Vatican.   The Pre-Lateran period, comprising the initial days of the library, dated from the earliest days of the Church. Only a handful of volumes survive from this period, though some are very significant.<br/><br/><strong class="mp ir">Please enter your question: </strong><br/>When was the Vat formally opened?<br/><br/><strong class="mp ir">Answer:</strong><br/>1475<br/><strong class="mp ir"><br/>Do you want to ask another question based on this text (Y/N)?</strong> Y<br/><br/><strong class="mp ir">Please enter your question: </strong><br/>what is the library for?<br/><br/><strong class="mp ir">Answer:</strong><br/>Research library for history , law , philosophy , science and theology<br/><br/><strong class="mp ir">Do you want to ask another question based on this text (Y/N)?</strong> Y<br/><br/><strong class="mp ir">Please enter your question: </strong><br/>for what subjects?<br/><br/><strong class="mp ir">Answer:</strong><br/>History , law , philosophy , science and theology</span><span id="08d1" class="lv lw iq mp b gy nd mu l mv mw"><strong class="mp ir">Do you want to ask another question based on this text (Y/N)?</strong> N<br/><br/>Bye!</span></pre><p id="2496" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç§å•Šã€‚å¾ˆå¥½ç”¨ï¼ğŸ¤—</p><p id="53bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½è®©ä½ äº†è§£æˆ‘ä»¬å¦‚ä½•è½»æ¾åœ°ä½¿ç”¨æ¥è‡ªæ‹¥æŠ±é¢éƒ¨å˜å½¢åº“çš„é¢„è®­ç»ƒæ¨¡å‹å¹¶æ‰§è¡Œæˆ‘ä»¬çš„ä»»åŠ¡ã€‚å¦‚æœä½ æƒ³æŠŠä»£ç çœ‹åšä¸€ä¸ªç¬”è®°æœ¬æ–‡ä»¶ï¼Œè¿™é‡Œæœ‰<a class="ae kv" href="https://github.com/chetnakhanna16/CoQA_QuesAns_BERT/blob/main/CoQA_BERT_QuestionAnswering.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>é“¾æ¥ã€‚</p><p id="b5d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">å‚è€ƒæ–‡çŒ®:</strong></p><ol class=""><li id="3531" class="nq nr iq ky b kz la lc ld lf ns lj nt ln nu lr nv nw nx ny bi translated"><a class="ae kv" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/</a></li><li id="73f4" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated"><a class="ae kv" href="https://arxiv.org/pdf/1810.04805.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1810.04805.pdf</a></li><li id="874d" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated"><a class="ae kv" href="https://arxiv.org/pdf/1808.07042.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1808.07042.pdf</a></li><li id="abe0" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated"><a class="ae kv" href="https://github.com/google-research/bert/issues/44" rel="noopener ugc nofollow" target="_blank">https://github.com/google-research/bert/issues/44</a></li></ol></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="2e8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ„Ÿè°¢å¤§å®¶é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚è¯·åˆ†äº«æ‚¨å®è´µçš„åé¦ˆæˆ–å»ºè®®ã€‚å¿«ä¹é˜…è¯»ï¼ğŸ“— ğŸ–Œ</p></div></div>    
</body>
</html>