<html>
<head>
<title>How to Display Video Streaming From A Webcam Using Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Flask显示来自网络摄像头的视频流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-display-video-streaming-from-a-webcam-using-flask-7a15e26fbab8?source=collection_archive---------13-----------------------#2021-08-30">https://towardsdatascience.com/how-to-display-video-streaming-from-a-webcam-using-flask-7a15e26fbab8?source=collection_archive---------13-----------------------#2021-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ac69" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在网络上实现你的计算机视觉解决方案。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0e4ca99f3207d7e7ff0b6eebb825a071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r32tPVx3EIi2n4jmqm6gGw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">欧内斯特·欧杰在<a class="ae ky" href="https://unsplash.com/s/photos/webcam?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="da15" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="d462" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">计算机视觉帮助我们看到我们看不到的东西。有了计算机视觉，我们可以解决像物体检测、人脸识别、看到隐藏模式等许多问题。</p><p id="cefb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">实现计算机视觉需要几个步骤。如果我们实现了一个计算机视觉解决方案，但却不能将其部署到生产中，例如，在移动或web应用程序中，那么它将毫无用处。</p><p id="3b3a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">令人欣慰的是，有很多人为实现计算机视觉解决方案生成了一个开源库，也为实现以前更容易的web应用程序生成了一个框架。这些库是OpenCV和Flask。</p><p id="f492" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文将向您展示一个如何使用OpenCV从网络摄像头实现人脸检测的示例，并使用Flask在一个web应用程序上实现它。</p><p id="ab49" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">没有进一步，让我们开始吧！</p><blockquote class="ms mt mu"><p id="18b6" class="lr ls mv lt b lu mn ju lw lx mo jx lz mw mp mc md mx mq mg mh my mr mk ml mm im bi translated"><strong class="lt iu">这里边注:</strong>因为这是一个Flask项目，所以你得在一个ide上实现，比如Visual Studio，PyCharm，Sublime Text，或者任何你喜欢的IDE。我先一步一步解释代码。而如果你有什么纠结，可以按照文末的完整代码。</p></blockquote></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><h1 id="6d46" class="kz la it bd lb lc ng le lf lg nh li lj jz ni ka ll kc nj kd ln kf nk kg lp lq bi translated">履行</h1><h2 id="616b" class="nl la it bd lb nm nn dn lf no np dp lj ma nq nr ll me ns nt ln mi nu nv lp nw bi translated">导入库</h2><p id="7953" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们要做的第一件事是导入库。在本例中，我们将导入Flask库来实现我们的web应用程序。此外，我们引入OpenCV库来实现我们的计算机视觉解决方案。</p><p id="f5d0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从Flask中，我们将导入Flask来生成web应用程序。此外，我们将导入用于从网络摄像头接收图像的响应对象。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="8348" class="nl la it bd lb nm nn dn lf no np dp lj ma nq nr ll me ns nt ln mi nu nv lp nw bi translated">初始化对象</h2><p id="0453" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">导入库之后，下一步是初始化几个对象。</p><ul class=""><li id="4dbc" class="nz oa it lt b lu mn lx mo ma ob me oc mi od mm oe of og oh bi translated">第一个是<strong class="lt iu">烧瓶</strong>物体。<br/>正如我之前提到的，Flask对象将初始化我们构建web应用程序所需的东西，因此我们可以专注于构建我们的解决方案。</li><li id="4a2a" class="nz oa it lt b lu oi lx oj ma ok me ol mi om mm oe of og oh bi translated">第二个是OpenCV库中的<strong class="lt iu"> VideoCapture </strong>对象。<br/>该对象将捕捉输出，其中网络摄像头是源。我们将为从网络摄像头拍摄图像设置参数“0”。</li><li id="b570" class="nz oa it lt b lu oi lx oj ma ok me ol mi om mm oe of og oh bi translated">最后一个是OpenCV库中的<strong class="lt iu"> CascadeClassifier </strong>。<br/>这个对象将初始化一个人脸检测模型，该模型基于AdaBoost和级联分类器的组合。这个模型已经用大量的图像进行了训练，这些图像被表示为一个叫做Haar的特征。我不会进一步解释这个分类器，但有一天我会向你解释，安拉保佑。</li></ul><p id="94ab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我们不会从头开始训练我们的模型。我们将使用来自OpenCV的预训练模型，你可以在这里 下载<a class="ae ky" href="https://github.com/opencv/opencv/blob/3.4/data/haarcascades/haarcascade_frontalface_alt.xml" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">。</strong></a></p><p id="5458" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是初始化对象的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="35c8" class="nl la it bd lb nm nn dn lf no np dp lj ma nq nr ll me ns nt ln mi nu nv lp nw bi translated">实现人脸检测</h2><p id="a2e5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">初始化对象后，下一步是实现我们的人脸检测功能。下面是我们的函数将执行的步骤:</p><ul class=""><li id="9d03" class="nz oa it lt b lu mn lx mo ma ob me oc mi od mm oe of og oh bi translated">下面的这个函数将接受一个输入，在这个例子中，它来自网络摄像头，每帧处理一次。</li><li id="f548" class="nz oa it lt b lu oi lx oj ma ok me ol mi om mm oe of og oh bi translated">在每一帧上，该函数将从中检测面部，并设置一个包围我们面部的边界框。</li><li id="31e5" class="nz oa it lt b lu oi lx oj ma ok me ol mi om mm oe of og oh bi translated">在该函数检测到人脸后，该函数使用。jpeg格式并将其转换为字节。</li><li id="c2d8" class="nz oa it lt b lu oi lx oj ma ok me ol mi om mm oe of og oh bi translated">这些来自图像的字节将被附加到HTTP响应中。</li><li id="7019" class="nz oa it lt b lu oi lx oj ma ok me ol mi om mm oe of og oh bi translated">因为我们不止一次发送图像，所以我们将使用yield关键字而不是return关键字。原因是yield关键字返回一个总是生成值的生成器，只要它没有阈值。</li></ul><p id="e9c1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是实现的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h1 id="a682" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">在网络上显示图像</strong></h1><p id="cac5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们创建了我们的人脸检测函数之后，下一步是构建一个在网站上显示人脸检测结果的函数。在下面的函数中，你可以看到在我们函数的名字上面有一个叫做app.route的东西。</p><p id="a1f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此app.route用作标识符，因此我们可以更容易地访问我们的图像。例如，我们有一个名为website.com的网站。我们用/video_feed在app.route参数上设置了一个参数。为了访问我们的网络摄像头的结果，我们可以使用这个链接:<strong class="lt iu">website.com/video_feed</strong>。</p><p id="6145" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在函数内部，我们将返回包含由gen函数生成的图像的响应对象，它从一个名为video的全局变量中获取输入。</p><p id="3859" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用global关键字的原因是为了强调我们没有在函数内部声明video变量。同时，我们需要用它来区分函数中的变量。</p><p id="ed25" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是显示人脸检测结果的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="49ab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，初始化app.run来运行我们的flask应用程序。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="3c98" class="nl la it bd lb nm nn dn lf no np dp lj ma nq nr ll me ns nt ln mi nu nv lp nw bi translated">运行代码</h2><p id="f5bf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">好了，现在我们已经实现了代码。现在让我们在电脑上运行它。要运行代码，您可以使用“python app.py”或“flask run”命令，如下所示:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="63c0" class="nl la it oo b gy os ot l ou ov"><strong class="oo iu">flask run</strong></span></pre><p id="5813" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果成功，我们的终端将显示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/f2ef847e1b9d0c638c71755b47cf7759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/0*2oKh53Srtwljed0I"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图为作者截图。</p></figure><p id="cb78" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是网站上的预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/65c775fb0c5009cd3555e999a3eab229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wAOSSeFZStxQ27EMWVbyvg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">GIF是作者捕获的。</p></figure><p id="4fae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有用！干得好。</p><h1 id="2249" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结束语</h1><p id="d299" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">干得好！我们使用Python中的Flask和OpenCV实现了一个代码，用于显示来自网络摄像头的人脸检测流。我希望它能帮助你实现你的计算机视觉项目，尤其是在一个web应用程序上。</p><p id="4c9b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你对我的文章感兴趣，可以在Medium上关注我。如果你有任何问题或者想打个招呼，你可以在<a class="ae ky" href="https://www.linkedin.com/in/alghaniirfan/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> LinkedIn </strong> </a>上联系我。</p><p id="6317" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">谢谢你看我的文章！</p><blockquote class="ms mt mu"><p id="2b4a" class="lr ls mv lt b lu mn ju lw lx mo jx lz mw mp mc md mx mq mg mh my mr mk ml mm im bi translated">如果代码片段中有错误，您可以在此处查看完整的代码:</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure></div></div>    
</body>
</html>