<html>
<head>
<title>A Data Storytelling Project with Some Advanced Visualization in ggplot2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 ggplot2 中使用一些高级可视化的数据讲述项目</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-data-storytelling-project-with-some-advanced-visualization-in-ggplot2-fb60dfc56dde?source=collection_archive---------16-----------------------#2021-10-27">https://towardsdatascience.com/a-data-storytelling-project-with-some-advanced-visualization-in-ggplot2-fb60dfc56dde?source=collection_archive---------16-----------------------#2021-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e89843f25547468e57056d582d262952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eoAcEdyHIiy8LEis"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@ethanhjy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ethan Hu </a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="9fb0" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">ggplot2 中一些实用的数据准备和有用的绘图技巧</h2></div><p id="63b5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我认为，数据可视化是与人交流数据的最有效方式。因此，对于每个数据科学家或分析师来说，学习可视化非常重要。本文将分享一些 R 中的可视化。我将使用 R 中的 ggplot2 库，这是一个丰富的库。ggplot2 库中包含了许多可视化技术。我自己也在尽可能多的学习。</p><p id="8587" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几周前，我不得不使用这个公共数据集，并使用一些可视化技术进行总结。但是为了准备用于可视化的数据，也使用了一些数据分析技术。</p><p id="0b2e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些是这个项目所必需的库:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="2092" class="md me jj lz b gy mf mg l mh mi">library(ggplot2)<br/>library(psych)<br/>library(dplyr)<br/>library(tidyr)<br/>library(ggpubr)<br/>library(usmap)</span></pre><p id="bec3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我首先导入数据集。该数据集显示了美国各州的农产品出口数据。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9f50" class="md me jj lz b gy mf mg l mh mi">us_ag = read.csv("<a class="ae jg" href="https://raw.githubusercontent.com/plotly/datasets/master/2011_us_ag_exports.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/plotly/datasets/master/2011_us_ag_exports.csv</a>")</span></pre><p id="070c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是该数据集的列:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9c8f" class="md me jj lz b gy mf mg l mh mi">names(us_ag)</span></pre><p id="beaf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9795" class="md me jj lz b gy mf mg l mh mi">[1] "code"   "state"    "category"  "total.exports" "beef"         <br/> [6] "pork"  "poultry"  "dairy"  "fruits.fresh"  "fruits.proc"  <br/>[11] "total.fruits" "veggies.fresh" "veggies.proc" "total.veggies" "corn"         <br/>[16] "wheat" "cotton"</span></pre><p id="3d8c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始真正的乐趣吧！</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="2b97" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我认为看看农产品出口之间是否有关联会很有趣。我将制作一个仅包含农产品的较小数据集，并制作一个相关图。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9b16" class="md me jj lz b gy mf mg l mh mi">corr_data = us_ag[, c("pork", "beef", "poultry", "dairy", "total.fruits", <br/>"total.veggies", "corn", "wheat", "cotton")]</span></pre><p id="2f75" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用此 corr_data 数据集绘制相关图:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9128" class="md me jj lz b gy mf mg l mh mi">corPlot(corr_data, cex = 0.8, main="Corrlation Between Variables",<br/>        las = 2)</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mq"><img src="../Images/5dc00c6fe1389310976a1f5306a91a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nyhuNfemzC5Ivg5SHnTbKw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="fdea" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里显示了一些有趣的相关性。出口大量玉米的州也出口大量猪肉。相关系数为 0.77。家禽和棉花也显示出 0.61 的显著相关性。</p><blockquote class="mr ms mt"><p id="01e3" class="ky kz mu la b lb lc kk ld le lf kn lg mv li lj lk mw lm ln lo mx lq lr ls lt im bi translated">下一个图将是一个发散条形图，显示该州的总出口是低于平均水平还是高于平均水平。</p></blockquote><p id="5cf4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在此之前，需要做一些数据准备。首先，我需要标准化总出口列。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="fb75" class="md me jj lz b gy mf mg l mh mi">us_ag$exports_z = round((us_ag$total.exports - mean(us_ag$total.exports))/sd(us_ag$total.exports), 2)</span></pre><p id="bc1a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我将这些数据标记为“低于平均水平”和“高于平均水平”。如果 exports_z 值小于零，它将被视为低于平均值，否则将被视为高于平均值。然后，我们将根据 exports_z 值对数据集进行排序。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="6720" class="md me jj lz b gy mf mg l mh mi">us_ag$export_level = ifelse(us_ag$exports_z &lt; 0, "below", "above")<br/>us_ag_sorted = us_ag[order(us_ag$exports_z),]</span><span id="7f1a" class="md me jj lz b gy my mg l mh mi">us_ag_sorted$state = factor(us_ag_sorted$state, levels=us_ag_sorted$state)</span></pre><p id="94ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为发散图准备数据。下面是制作发散图的代码块:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9191" class="md me jj lz b gy mf mg l mh mi">{r fig.height=11, fig.width=6}<br/>ggplot(us_ag_sorted, aes(x = state, y = exports_z, label=exports_z)) + <br/>  geom_point(stat = 'identity', aes(col=export_level), size=7) + <br/>  scale_color_manual(name="Exports",<br/>                     labels = c("Above Average", "Below Average"),<br/>                     values = c("above"="#00ba38", "below"="#f8766d"))+<br/>  geom_text(color="white", size = 2) +<br/>  labs(title="Diverging Bar Plot Showing Exports Level",<br/>       subtitle = "Normalized total export",<br/>       x = "Normalized Total Exports",<br/>       y = "State") +<br/>  ylim(-2, 5)+<br/>  coord_flip()</span></pre><p id="930e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">剧情是这样的:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/1fbaf34820a8547c7c90a5df4f97d310.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*Zlnt7tNOq9pgo8iu78534g.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="b5b4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如需详细信息，我还想看看每个州的每个产品的出口。产品这么多。如果我想把它们都放在同一个情节中，这不是很有用。所以，我把它们分成了几个情节。最终，我会把它们结合起来。</p><p id="96b4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个地块将只包括牛肉、猪肉和家禽。代码如下:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="1573" class="md me jj lz b gy mf mg l mh mi">{r fig.height=4, fig.width=12}<br/>us_ag %&gt;% select(state, beef, pork, poultry) %&gt;%<br/>  pivot_longer(., cols = c(beef, pork, poultry),<br/>               values_to="Val") %&gt;%<br/>  ggplot(aes(x = state, y = Val, color=name, alpha = 0.7))+<br/>  geom_point(size = 4) + <br/>  scale_color_manual(values = c("beef" = "black", "pork" = "red", "poultry" = "green")) +<br/>  geom_line(aes(group=name)) + <br/>  theme(axis.text.x = element_text(angle = 90)) + <br/>  guides(alpha=FALSE)+labs(x = "State",<br/>                           y = "Exports",<br/>                           title = "Beef, Pork, and Poultry Exports of States"<br/>                           )</span></pre><p id="f7e2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出图:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi na"><img src="../Images/b8bfd4273660e94d27f132a57ce34c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2ehxBOUCIxO_I8FLDJfgQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="ea04" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见，爱荷华州是最大的猪肉出口地，德克萨斯州是最大的牛肉出口地。</p><p id="ddbe" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">乳制品、全部水果和全部蔬菜包含在下一个地块中:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="bc94" class="md me jj lz b gy mf mg l mh mi">{r fig.height= 4, fig.width=14}<br/>us_ag %&gt;% select(state, total.fruits, total.veggies, dairy) %&gt;%<br/>  pivot_longer(., cols = c(total.fruits, total.veggies, dairy),<br/>               values_to="Val") %&gt;%<br/>  ggplot(aes(state, Val, fill = name)) + geom_col(width = 0.9)+<br/>  theme(axis.text.x = element_text(angle = 90))</span></pre><p id="b4f5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">剧情是这样的:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nb"><img src="../Images/c5a80fa764f73253702d6cb3581d9050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2dEYNC9CaZyjtDU5MZQtew.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="8c13" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">加州出口的水果、蔬菜和奶制品数量最多，远远超过其他任何一个州。</p><p id="347d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，玉米、棉花和小麦:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="8687" class="md me jj lz b gy mf mg l mh mi">{r fig.height= 4, fig.width=14}<br/>us_ag %&gt;% select(state, corn, cotton, wheat) %&gt;%<br/>  pivot_longer(., cols = c(corn, cotton, wheat),<br/>               values_to="Val") %&gt;%<br/>  ggplot(aes(state, Val, fill = name)) + geom_col(width = 0.9)+<br/>  theme(axis.text.x = element_text(angle = 90))+<br/>  labs(x = "State",<br/>       y = "Exports",<br/>       title = "Corn, Cotton, and Wheat Exports of States")</span></pre><p id="e74b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出图在这里:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/88eebe4972f055ad0706707f7d2c5815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ME5CnjcFpcDINwPEgPJfQA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="99ac" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">得克萨斯是最大的棉花出口国。当我住在德克萨斯州的时候，我参观了很多棉花田，爱荷华州是最大的玉米出口地。其他几个州也出口大量玉米。如图所示。</p><p id="44af" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我把这三个图放在一起，在演示中会看起来很好，并且会覆盖一页。下面是将它们结合在一起的代码:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="9499" class="md me jj lz b gy mf mg l mh mi">{r fig.height=10, fig.width=14}<br/>p1 = us_ag %&gt;% select(state, beef, pork, poultry) %&gt;%<br/>  pivot_longer(., cols = c(beef, pork, poultry),<br/>               values_to="Val") %&gt;%<br/>  ggplot(aes(x = state, y = Val, color=name, alpha = 0.7))+<br/>  geom_point(size = 4) + <br/>  scale_color_manual(values = c("beef" = "black", "pork" = "red", "poultry" = "green")) +<br/>  geom_line(aes(group=name)) + <br/>  theme(axis.text.x = element_text(angle = 90)) + <br/>  guides(alpha="none")+<br/>  labs(x = "State",<br/>       y = "Exports",<br/>       title = "Beef, Pork, and Poultry Exports of States")</span><span id="f32f" class="md me jj lz b gy my mg l mh mi">p2 = us_ag %&gt;% select(state, total.fruits, total.veggies, dairy) %&gt;%<br/>  pivot_longer(., cols = c(total.fruits, total.veggies, dairy),<br/>               values_to="Val") %&gt;%<br/>  ggplot(aes(state, Val, fill = name)) + geom_col(width = 0.9)+<br/>  theme(axis.text.x = element_text(angle = 90))+<br/>  labs(x = "State",<br/>       y = "Exports",<br/>       title = "Dairy, Fruits, and Vegetables Exports of States")</span><span id="f409" class="md me jj lz b gy my mg l mh mi">p3 = us_ag %&gt;% select(state, corn, cotton, wheat) %&gt;%<br/>  pivot_longer(., cols = c(corn, cotton, wheat),<br/>               values_to="Val") %&gt;%<br/>  ggplot(aes(state, Val, fill = name)) + geom_col(width = 0.9)+<br/>  theme(axis.text.x = element_text(angle = 90))+<br/>  labs(x = "State",<br/>       y = "Exports",<br/>       title = "Corn, Cotton, and Wheat Exports of States")</span><span id="d1a4" class="md me jj lz b gy my mg l mh mi">ggarrange(p1, p2, p3, nrow=3)</span></pre><p id="342b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是输出图:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nd"><img src="../Images/cf6cb2528898d8a3ddad27442a69b4f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0i1L2Vndgbrj0IefgBkTCw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="49b1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于下一个图，我决定在美国地图上绘制最好的出口产品。为此，我需要经纬度数据。该数据集本身不包括任何后期数据。所以，我简单地从 Kaggle 下载了一些经纬度数据。你可以在这里找到最近的数据。请放心下载使用。</p><p id="8709" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我将把这个纬度较长的数据与主数据集合并:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="4456" class="md me jj lz b gy mf mg l mh mi">latlong = read.csv("statelatlong.csv")<br/>latlong = rename(latlong, c("code" = "State"))<br/>latlong = subset(latlong, select=-c(City))<br/>latlong1 = latlong[, c(3, 2, 1)]<br/>us_ag_ll = merge(latlong, us_ag, by = "code")</span></pre><p id="8769" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个 us_ag_ll 数据集包括所有的列和经度数据。</p><p id="e528" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要找出哪个产品是每个州出口最多的产品。为此，我将创建一个仅包含所有农产品的数据集:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="028f" class="md me jj lz b gy mf mg l mh mi">df = us_ag[, c("beef", "pork", "poultry", "dairy", "total.fruits", "total.veggies", "corn", "wheat", "cotton")]</span></pre><p id="cd22" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的代码块找出最大值和具有最大导出值的产品的名称:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="7cc8" class="md me jj lz b gy mf mg l mh mi">df$max_val = apply(X=df, MARGIN = 1, FUN = max)<br/>df$maxExportItem= colnames(df)[apply(df,1,which.max)]</span></pre><p id="6aae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个 maxExportItem 列需要包含在主数据集 us_ag_ll 中。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="8938" class="md me jj lz b gy mf mg l mh mi">us_ag_ll$max_export_item = df$maxExportItem<br/>us_ag_ll$max_val = df$max_val</span></pre><p id="d341" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要转换纬度和经度数据，以便能够在地图中使用它们。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="f46e" class="md me jj lz b gy mf mg l mh mi">transformed = usmap_transform(us_ag_ll[, c("Longitude", "Latitude")])</span></pre><p id="ef51" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果需要，请检查转换后的数据集。</p><blockquote class="ne"><p id="2d75" class="nf ng jj bd nh ni nj nk nl nm nn lt dk translated">“经度”和“纬度”列已被转换，在转换后的数据集中创建了两个名为“经度. 1”和“纬度. 1”的列。</p></blockquote><p id="9c24" class="pw-post-body-paragraph ky kz jj la b lb no kk ld le np kn lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">我们将使用“经度. 1”和“纬度. 1”来绘图。</p><p id="2187" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我一直认为在地图上放一些值是个好主意。我会把每个州的最大出口项目和出口金额。所以，我们应该准备好数据。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="5324" class="md me jj lz b gy mf mg l mh mi">us_ag_ll$Max_Export_Val = paste(us_ag_ll$max_export_item, us_ag_ll$max_val, sep="-")</span></pre><p id="294f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有的数据准备都做好了！现在让我们开始策划吧！颜色梯度将代表总出口。地图中的值将显示每个州的最大出口项目和最大出口项目的出口值。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="ddaa" class="md me jj lz b gy mf mg l mh mi">{r fig.height=11}<br/>plot_usmap(data = us_ag_ll, values = "total.exports", color = "blue")+<br/>  geom_text(data=us_ag_ll, aes(x = transformed$Longitude.1,<br/>                                y = transformed$Latitude.1, <br/>                                label = Max_Export_Val), size=3.5, color = "black")+<br/>  scale_fill_continuous(low = "white", high = "blue", name = "Total Exports", label = scales::comma) + <br/>  labs(title = "Total Exports in Color in Each State", subtitle = "Top Exports Items and Export Values of Each State")+<br/>  theme(legend.position = "bottom", plot.title = element_text(size = 20, face = "bold"),<br/>        plot.subtitle = element_text(size = 18))</span></pre><p id="41a3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nt"><img src="../Images/60b3e8b6ef20a366264b5e4c329125c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r9jKuKmIeB5cZ1DGx8T7LA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="4953" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">地图中值的位置可以通过一些更好的经纬度数据来改进。我用我在卡格尔找到的东西。</p><p id="ecdb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是我这篇文章想分享的全部内容！</p><h2 id="1c80" class="md me jj bd nu nv nw dn nx ny nz dp oa lh ob oc od ll oe of og lp oh oi oj ok bi translated">结论:</h2><p id="a7fc" class="pw-post-body-paragraph ky kz jj la b lb ol kk ld le om kn lg lh on lj lk ll oo ln lo lp op lr ls lt im bi translated">有许多不同的方法可以处理数据集并将其可视化。如果你也像我一样是一个初学者，并试图提升你的技能，请尝试你自己的想法，如果你能以自己的方式改善这些情节，请随时通过评论部分的 GitHub 链接分享你的代码。</p><p id="01e9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">欢迎在推特上关注我，喜欢我的 T2 脸书页面。</p></div></div>    
</body>
</html>