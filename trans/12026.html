<html>
<head>
<title>Making Python Packages Part 3: Designing Your Classes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">制作Python包第3部分:设计您的类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-python-packages-part-3-designing-your-classes-82b3a5786e30?source=collection_archive---------17-----------------------#2021-12-03">https://towardsdatascience.com/making-python-packages-part-3-designing-your-classes-82b3a5786e30?source=collection_archive---------17-----------------------#2021-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ce10" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为成功建立您的图书馆</h2></div><p id="2948" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你好！欢迎阅读制作Python包系列的第3部分！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/d68ec17032319ff86bf0454e19787344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NrxIjDaSNAqpf_gp3WZ8Yg.jpeg"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">高塔姆·克里希南在<a class="ae lr" href="https://unsplash.com/s/photos/people-walking-in-a-park?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a772" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">前两部分探索了<a class="ae lr" href="https://medium.com/@skylar.kerzner/publish-your-first-python-package-to-pypi-8d08d6399c2f" rel="noopener">如何打包你的代码</a>，以及<a class="ae lr" href="https://medium.com/towards-data-science/packages-part-2-how-to-publish-test-your-package-on-pypi-with-poetry-9fc7295df1a5" rel="noopener">在PyPI上发布供公众使用</a>。</p><p id="6888" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这一部分，我们将讨论如何设置你的源代码:让你的包做一些有趣的事情的类和函数。</p><p id="d68a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们直接开始吧。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="10aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">类别和功能</strong></p><p id="266d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您是一名数据科学家，您可能会花大量时间在笔记本上编写代码，或者编写一个Python脚本。</p><p id="8443" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们中的许多人倾向于在没有太多封装的情况下构建代码原型，只是一行一行地写我们想对我们的熊猫数据帧做的任何统计分析。</p><p id="653c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时候你可能会写函数:也许是因为你需要给pd一个函数。DataFrame.apply()，或者将数据帧上的一系列类似sql的操作封装到一个函数中，或者将所有清理步骤封装到一个列表中。我们编写代码的风格几乎更符合函数式编程，在函数式编程中，像Pandas DataFrame或list这样的数据结构是通过一系列操作来传递的。</p><p id="27fc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">类似地，当我们第一次运行一些统计数据，或者用一个数据集创建一个初始的ML模型时，我们也倾向于不在那里写类。</p><p id="6792" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我们当然使用<em class="lz">类——毕竟，Python中的一切都是对象:从字符串和整数，到列表和数据帧，到ML模型类和NLP管道。</em></p><p id="508e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们很容易使用这些类对象——我们机械地记住我们可以运行。groupby()转换我们的熊猫系列。tolist()，。update()一个集合，获取。来自计数器的most_common()。拟合()一个ML模型并得到它的。参数</p><p id="4cae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，即使我们经常使用这种语法，我们也可能会忽略这样一个事实，即这些确实是某些人编写的类的方法和属性。</p><p id="1e1d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们编写自己的包时，我们需要生成相同类型的直观方法和属性。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="3dc0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">为什么上课？</strong></p><p id="a33e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">学习正确方式<strong class="kh ir">的最好方法是看错误方式</strong>。</p><p id="6d91" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">写Python，Pandas，scikit-learn和spaCy的那些才华横溢的人在设计他们的包的时候，为什么不直接用函数呢？</p><p id="39d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">至少对于scikit-learn来说，我们可以想象得到一个函数，它获取你的数据并输出预测和参数。</p><p id="b7d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也许类似于:</p><pre class="lc ld le lf gt ma mb mc md aw me bi"><span id="962a" class="mf mg iq mb b gy mh mi l mj mk">from scikit-learn import run_logistic_regression</span><span id="daf0" class="mf mg iq mb b gy ml mi l mj mk">predictions, parameters = run_logistic_regression(data)</span></pre><p id="ccb6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这有什么不好？他们为什么使用类？</p><p id="9b13" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来会发生什么？一旦这个模型被训练，我们需要一个新的函数来做进一步的预测。我们需要将这些参数传递给它。</p><pre class="lc ld le lf gt ma mb mc md aw me bi"><span id="c89c" class="mf mg iq mb b gy mh mi l mj mk">predictions = make_logistic_predictions(data, parameters)</span></pre><p id="72ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这有点尴尬，因为我们必须保存和传递参数。</p><p id="8167" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">令人尴尬的是，这两个函数没有正式的关系，尽管它们是为了拟合和使用同一个模型。</p><p id="db81" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您运行dir()或查看源代码，您必须在scikit-learn的其他模型的1000个其他函数列表中找到这两个相关的函数。</p><p id="8a02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但这可能会变得更糟。</p><p id="234c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当它是一个决策树或神经网络的集合体——具有复杂架构的东西——时会发生什么？</p><pre class="lc ld le lf gt ma mb mc md aw me bi"><span id="cf21" class="mf mg iq mb b gy mh mi l mj mk">predictions, parameters = run_random_forest(data)<br/>predictions = make_random_forest_predictions(data, parameters)</span></pre><p id="0c2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果这些参数描述了我们所有不同形状的决策树上的规则，它们会采用什么结构？在列表列表中指定树的形状有点困难。</p><p id="185e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无论如何，我不会反复强调这一点。你可以看到问题。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="0140" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，为什么要上课呢？</p><p id="2c81" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为，<strong class="kh ir"> <em class="lz">一个类是状态和行为的容器。</em> </strong></p><p id="29fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们希望允许用户获取一些数据，用这些数据做一些事情并保存结果时，类是实现这一点的自然方式。</p><p id="b5fc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个类可以存储信息，给我们的用户一套很好的操作，他们可以对这些信息进行操作，并为他们保存结果。</p><p id="0d45" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的意思是，这真的只是面向对象编程的基本论点。但是当你写一个库的时候不要忘记它。</p><p id="d26e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用类是有意义的！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="80fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">界面驱动开发</strong></p><p id="de41" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们知道我们应该使用类，我们也使用过其他库的类，但是如何为你的库开发正确的类结构呢？</p><p id="c9a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您编写类名、这些类中的方法和属性名，并且还没有填充逻辑。</p><p id="5b39" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那是你的界面。接口是一个类的蓝图。它是API，特别是您的用户将使用的类、方法和属性。</p><p id="0143" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样的建议也适用于开发函数:首先编写输入和输出，<strong class="kh ir">使用函数的<em class="lz"> </em> </strong>。只有在这之后，您才应该实现逻辑。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="9f32" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看一个例子。</p><p id="8e93" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在spaCy中，开发人员希望对文本字符串提供NLP(自然语言处理)。因此，他们创建了一个类，该类接受文本字符串，并生成一个对象(一个“doc”)来提供对该文本字符串的各种NLP分析。</p><p id="2fb3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从根本上说，他们的库<strong class="kh ir">获取输入数据</strong>，<strong class="kh ir">通过使用一些算法和数据库对数据进行操作来创建新的信息</strong>，而<strong class="kh ir">使新的信息易于访问</strong>。</p><p id="28cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总的来说，他们希望直观地访问新信息。</p><pre class="lc ld le lf gt ma mb mc md aw me bi"><span id="3ecd" class="mf mg iq mb b gy mh mi l mj mk">doc = nlp(my_text)<br/>token = doc[4] #an object derived from the word at index 4<br/>token.pos_ #outputs the part of speech of that word at index 4</span></pre><ol class=""><li id="59dd" class="mm mn iq kh b ki kj kl km ko mo ks mp kw mq la mr ms mt mu bi translated">他们想给你每个词的NLP分析。</li><li id="e9fb" class="mm mn iq kh b ki mv kl mw ko mx ks my kw mz la mr ms mt mu bi translated">他们希望访问一个单词(令牌)看起来像是访问一个列表元素(如果它像内置Python对象或熟悉的库一样工作，会更直观)</li><li id="4206" class="mm mn iq kh b ki mv kl mw ko mx ks my kw mz la mr ms mt mu bi translated">他们希望对单词(token)的NLP分析是简单的属性，如word.pos_</li></ol></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="21e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">结论</strong></p><p id="c42f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当你开发你的库时，关注你的<strong class="kh ir">终端用户</strong>的体验。</p><p id="1888" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你想让<strong class="kh ir"> <em class="lz">他们的</em> </strong>代码变成什么样子。<strong class="kh ir"> <em class="lz">在你的自述文件中写出用例</em> </strong>的例子。什么会使他们的代码更直观？让他们的生活变得轻松。</p><p id="3d0b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">概述一个提供这种体验的库:类、方法、属性。在你得到<strong class="kh ir">用户</strong> <strong class="kh ir">体验</strong>之前，不要写逻辑。</p><p id="d1e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你优先考虑用户，那么用户会喜欢你的图书馆！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="91ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读！</p><p id="178d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请关注我的Medium，了解数据科学家的更多见解！</p><p id="9d37" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是本系列的第1部分和第2部分:</p><div class="na nb gp gr nc nd"><a href="https://medium.com/@skylar.kerzner/publish-your-first-python-package-to-pypi-8d08d6399c2f" rel="noopener follow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">包第1部分:如何将Python包发布到PyPI</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">嘿！欢迎阅读这份关于如何将python包发布到PyPI的快速、有趣的指南。</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">medium.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ll nd"/></div></div></a></div><div class="na nb gp gr nc nd"><a href="https://medium.com/@skylar.kerzner/packages-part-2-how-to-publish-test-your-package-on-pypi-with-poetry-9fc7295df1a5" rel="noopener follow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">包第2部分:如何在PyPI上发布和测试带有诗歌的包</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">在本指南的上一版中，我们使用传统的setup.py向PyPI发布了一个python包。</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">medium.com</p></div></div><div class="nm l"><div class="ns l no np nq nm nr ll nd"/></div></div></a></div></div></div>    
</body>
</html>