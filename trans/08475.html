<html>
<head>
<title>R Equivalent of 7 Common Pandas Operations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">相当于7只普通熊猫的行动</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/r-equivalent-of-7-common-pandas-operations-76b632fc801b?source=collection_archive---------35-----------------------#2021-08-04">https://towardsdatascience.com/r-equivalent-of-7-common-pandas-operations-76b632fc801b?source=collection_archive---------35-----------------------#2021-08-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f1d0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫和数据表库实践教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/61364a88e800159f7f62a869bce8f986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q2mWWABOtlN0SFU3J_0kPQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">诺德伍德主题公司在<a class="ae ky" href="https://unsplash.com/s/photos/comparison?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6be9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python和R是数据科学生态系统中的两个关键角色。这两种编程语言都提供了大量非常有用的库。</p><p id="a66a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说到数据分析和操作，有两个库非常突出:R的“data.table”和Python的Pandas。</p><p id="44dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我一直在使用两者，但我不能真正宣布一个优于另一个。尽管我个人更喜欢“data.table ”,但我还没有遇到任何任务不能用这两者来完成。</p><p id="2422" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将使用Pandas和“data.table”带您完成7个典型的数据分析操作。因此，这对双方都是一个好的实践。</p><p id="2d94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在早先的<a class="ae ky" rel="noopener" target="_blank" href="/generating-mock-sales-data-with-python-pandas-c904035782fe">文章</a>中，我已经使用NumPy和Pandas生成了模拟销售数据。我将使用这些数据作为例子。让我们从导入库和读取数据集开始。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="c855" class="ma mb it lw b gy mc md l me mf">#Pandas<br/>import numpy as np<br/>import pandas as pd</span><span id="3e26" class="ma mb it lw b gy mg md l me mf">sales = pd.read_csv("/content/mock_sales.csv")<br/>sales.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/fbf3414fe7b84762634ddcda848342c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vMcTHh3OWgVVoSyNAgGrQg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4200" class="ma mb it lw b gy mc md l me mf">#data.table</span><span id="8a91" class="ma mb it lw b gy mg md l me mf">library(data.table)</span><span id="ff94" class="ma mb it lw b gy mg md l me mf">sales &lt;- fread("~/Downloads/mock_sales.csv")<br/>head(sales)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/af109ae878c941d7dd9c4c3caec9ab9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6QAwK-HlsylVzyb6kJwYmw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="aa10" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">示例1</h2><p id="5688" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">查找列中的唯一值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="90e6" class="ma mb it lw b gy mc md l me mf">#Pandas</span><span id="396d" class="ma mb it lw b gy mg md l me mf">sales.ProductGroup.unique()<br/>array(['D', 'A', 'C', 'B'], dtype=object)</span><span id="62bd" class="ma mb it lw b gy mg md l me mf">#data.table</span><span id="4e5a" class="ma mb it lw b gy mg md l me mf">unique(sales$ProductGroup)<br/>[1] "D" "A" "C" "B"</span></pre></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="8bf3" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">示例2</h2><p id="3d87" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">查找一列中唯一值的数量。</p><p id="d6da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的示例中情况并非如此，但是当列中唯一值的数量很大时，您可能会对唯一值的数量感兴趣，而不是显示所有的值。</p><p id="9cdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过添加一个字母“n”来完成这项任务。不过，对于熊猫和“data.table ”,添加的位置是不同的。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="237b" class="ma mb it lw b gy mc md l me mf">#Pandas</span><span id="15d0" class="ma mb it lw b gy mg md l me mf">sales.ProductGroup.nunique()<br/>4</span><span id="fc90" class="ma mb it lw b gy mg md l me mf">#data.table</span><span id="b779" class="ma mb it lw b gy mg md l me mf">uniqueN(sales$ProductGroup)<br/>4</span></pre></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="7564" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">示例3</h2><p id="1c81" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">计算每个产品组的平均日销售额。</p><p id="327b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个任务，我们使用Pandas的groupby功能。用“data.table”稍微简单一点。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="38b5" class="ma mb it lw b gy mc md l me mf">#Pandas</span><span id="3d8d" class="ma mb it lw b gy mg md l me mf">sales.groupby("ProductGroup").agg(<br/>   avg_daily_sales = ("SalesAmount", "mean")<br/>)</span><span id="54d1" class="ma mb it lw b gy mg md l me mf">#data.table</span><span id="d945" class="ma mb it lw b gy mg md l me mf">sales[, .(avg_daily_sales = mean(SalesAmount)), by=ProductGroup]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/a3850675d0389a14a01498ff5ab0e3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*Ct_qrLriG89499oZEWz-Cw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据表输出(图片由作者提供)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="8413" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">实例4</h2><p id="89a9" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">找出销售额最高的3家商店。</p><p id="0847" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">计算部分类似于前面的例子。我们只需更改列名和聚合函数。与上一个示例不同，我们按降序对结果进行排序，并选择前3名。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="de88" class="ma mb it lw b gy mc md l me mf">#Pandas</span><span id="a89f" class="ma mb it lw b gy mg md l me mf">sales.groupby("StoreCode").agg(<br/>   total_sales = ("SalesAmount", "sum")<br/>).sort_values(<br/>   by="total_sales", ascending=False<br/>)[:3]</span><span id="5171" class="ma mb it lw b gy mg md l me mf">#data.table</span><span id="e07a" class="ma mb it lw b gy mg md l me mf">sales[, .(total_sales = sum(SalesAmount)), <br/>      by=StoreCode][order(-total_sales)][1:3]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/39e690705b9f86f1a092f3fcd0e78815.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*H1HPLmxIEcMty91WAsVhxA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫输出(图片作者)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="1c51" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">实例5</h2><p id="571d" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">创建一个名为“IsHigh”的新列，如果销售额大于40，则取值1，否则取值0。</p><p id="4a25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几种方法可以完成这个操作。例如，我们可以如下使用numpy的where函数:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a017" class="ma mb it lw b gy mc md l me mf">#Pandas</span><span id="b183" class="ma mb it lw b gy mg md l me mf">sales["IsHigh"] = np.where(sales["SalesAmount"] &gt; 40, 1, 0)</span><span id="3a52" class="ma mb it lw b gy mg md l me mf">sales.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/6cf1abbbe98ca13cc43c820bdaf7db0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yFEAbmqeUdbcRnJOmHxS0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="c054" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在R端，ifelse函数可用于此任务。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="07dd" class="ma mb it lw b gy mc md l me mf">#data.table</span><span id="cbeb" class="ma mb it lw b gy mg md l me mf">sales[, IsHigh := ifelse(SalesAmount&gt;40,1,0)]</span><span id="6caf" class="ma mb it lw b gy mg md l me mf">head(sales)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/69f55e79576967085e7b7ae296ffe2e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PSRxrDPVwo7teGwNGn4bXA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="f5a6" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">实例6</h2><p id="7beb" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">找出“IsHigh”列取值为1的不同天数。</p><p id="2885" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经介绍了如何使用一列中不同值的数量。该任务涉及一个额外的过滤操作。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ce26" class="ma mb it lw b gy mc md l me mf">#Pandas</span><span id="55e9" class="ma mb it lw b gy mg md l me mf">sales[sales["IsHigh"]==1]["Date"].nunique()<br/>731</span><span id="2481" class="ma mb it lw b gy mg md l me mf">#data.table</span><span id="6bae" class="ma mb it lw b gy mg md l me mf">uniqueN(sales[IsHigh==1]$Date)<br/>731</span></pre></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="18fa" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">例7</h2><p id="0ffb" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">查找产品组列中每个不同值的出现次数。</p><p id="d89d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas的value_counts函数返回不同的值以及出现的次数(即行数)。</p><p id="56f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用“data.table ”,我们可以根据产品组列对行进行分组，并使用N函数对行进行计数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="059c" class="ma mb it lw b gy mc md l me mf">#Pandas</span><span id="691a" class="ma mb it lw b gy mg md l me mf">sales.ProductGroup.value_counts()<br/>B    164475 <br/>D    164475 <br/>A    164475 <br/>C    164475</span><span id="2e06" class="ma mb it lw b gy mg md l me mf">#data.table</span><span id="8c87" class="ma mb it lw b gy mg md l me mf">sales[,.N,ProductGroup]<br/>   ProductGroup      N<br/>1:            D 164475<br/>2:            A 164475<br/>3:            C 164475<br/>4:            B 164475</span></pre><p id="8ad4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每组出现的次数是相同的，因为我是这样生成数据的。方法没有错😊</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="75d7" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">结论</h2><p id="587a" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">R和Python都有几个第三方库，对数据科学家帮助很大。在大多数情况下，一项任务可以使用两种语言的库来完成。因此，宣布一个优于另一个将是一个有争议的讨论。</p><p id="e395" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们做了7个例子来演示一些任务的R和Python版本。</p><p id="4486" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>