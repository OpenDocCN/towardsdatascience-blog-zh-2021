<html>
<head>
<title>Python Bites: Manipulating Text Files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Bites:操纵文本文件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-bites-manipulating-text-files-511d1257d399?source=collection_archive---------9-----------------------#2021-04-03">https://towardsdatascience.com/python-bites-manipulating-text-files-511d1257d399?source=collection_archive---------9-----------------------#2021-04-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1bea" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">读取、写入和追加</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d0a37c1ae6d1b155117e7a36bd2de4e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_wvf79MFMPvCq9VRtZuzw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@patrickian4?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">帕特里克·福尔</a>在<a class="ae ky" href="https://unsplash.com/s/photos/food-bite?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="2b3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文本文件通常用于存储数据。因此，它们在数据科学系统中是必不可少的。Python提供了多种功能和方法来处理文本文件。</p><p id="eb11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建文本文件有许多选项。因为这里的重点是操作文本文件，而不是创建文本文件，所以我们不会涵盖所有的内容。让我们用一种你可以在jupyter笔记本上使用的方法。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9ae3" class="ma mb it lw b gy mc md l me mf">%%writefile myfile.txt<br/>Python is awesome<br/>This is the second line<br/>This is the last line</span></pre><p id="9e07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在在当前工作目录中有一个名为“myfile.txt”的文本文件。为了阅读文本文件的内容，我们首先需要打开它。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f29d" class="ma mb it lw b gy mc md l me mf">f = open("myfile.txt")</span></pre><p id="e8e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以读取“myfile.txt”的内容了。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fb52" class="ma mb it lw b gy mc md l me mf">f.read()<br/>'Python is awesome\nThis is the second line\nThis is the last line'</span></pre><p id="0f04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">read函数，顾名思义，读取文件的内容。您可能已经注意到，新行用“\n”表示。</p><p id="92b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用readlines函数可以逐行读取文件内容。它返回一个列表，其中每一行都包含一个项目。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ee25" class="ma mb it lw b gy mc md l me mf">f.readlines()<br/>[]</span></pre><p id="eb47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的readlines函数返回一个空列表，这有点问题。原因是一旦你读取一个文件，光标会一直移动到文件的末尾。下一次尝试读取同一文件时，光标找不到任何要读取的内容，因为它已经位于文件的末尾。</p><p id="27ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解决方法是将光标设置回初始位置。然后，我们将能够再次读取该文件。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2e36" class="ma mb it lw b gy mc md l me mf">f.seek(0)<br/>0</span><span id="670f" class="ma mb it lw b gy mg md l me mf">f.readlines()<br/>['Python is awesome\n', 'This is the second line\n', 'This is the last line']</span></pre><p id="6bf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦内容被读取，我们应该关闭文件。否则，我们可能会遇到意想不到的结果。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d442" class="ma mb it lw b gy mc md l me mf">f.close()</span></pre><p id="10c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您试图在文件关闭后读取它，Python会抛出一个值错误，指示对关闭的文件进行了I/O操作。</p><p id="7c0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以写入一个现有的文件。模式参数用于选择操作类型。默认值为“r ”,代表读取。因此，在读取文件时，我们不需要指定模式参数的值。</p><p id="4441" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果要覆盖内容，模式设置为“w”。也可以通过append选项(' a ')向现有文件添加新内容。</p><p id="12fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还将查看演示如何覆盖文件或添加新内容的示例。在进入这一部分之前，我想介绍一种打开文件的新方法。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="63a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每次阅读文件时都要关闭文件，这听起来可能是一个乏味的操作。幸运的是，Python提供了一种更实用的读写文件的方式。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="22a1" class="ma mb it lw b gy mc md l me mf">with open("myfile.txt", mode='r') as f:<br/>    content = f.read()</span><span id="df7f" class="ma mb it lw b gy mg md l me mf">print(content)<br/>Python is awesome <br/>This is the second line <br/>This is the last line</span></pre><p id="f6d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们不再需要显式调用文件的close方法。让我们给我们的文件添加一个新文件。我们应该选择追加选项。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f69a" class="ma mb it lw b gy mc md l me mf">with open("myfile.txt", mode='a') as f:<br/>    f.write("\nTHIS IS THE NEW LINE")</span></pre><p id="7e36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是新的内容。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a10e" class="ma mb it lw b gy mc md l me mf">with open("myfile.txt", mode='r') as f:<br/>    updated_content = f.read()</span><span id="83d6" class="ma mb it lw b gy mg md l me mf">print(updated_content)<br/>Python is awesome <br/>This is the second line <br/>This is the last line <br/>THIS IS THE NEW LINE</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="f4be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">写模式覆盖文件。因此，它删除文件中已经存在的内容，并写入新内容。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dd87" class="ma mb it lw b gy mc md l me mf">with open("myfile.txt", mode='w') as f:<br/>    f.write("THIS WILL OVERWRİTE THE EXISTING LINES")</span></pre><p id="c4c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们读新内容。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3769" class="ma mb it lw b gy mc md l me mf">with open("myfile.txt", mode='r') as f:<br/>    updated_content = f.read()</span><span id="8121" class="ma mb it lw b gy mg md l me mf">print(updated_content)<br/>THIS WILL OVERWRİTE THE EXISTING LINES</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="8e39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">mode参数也接受允许多个操作的参数。例如，“r+”打开一个文件进行读写。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="941d" class="ma mb it lw b gy mc md l me mf">with open("myfile.txt", mode='r+') as f:<br/>    content = f.read()<br/>    f.write("\nHere is a new line")<br/>    f.seek(0)<br/>    updated_content = f.read()</span></pre><p id="f438" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们打开文件并阅读其内容。然后我们写新的一行，读取更新的内容。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3992" class="ma mb it lw b gy mc md l me mf">print(content)<br/>THIS WILL OVERWRİTE THE EXISTING LINES</span><span id="113e" class="ma mb it lw b gy mg md l me mf">print(updated_content)<br/>THIS WILL OVERWRİTE THE EXISTING LINES <br/>Here is a new line</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="a088" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">结论</h2><p id="183f" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我们做了几个简单的例子来展示Python如何处理文本文件的读写。当然，还有更多。这篇文章可以被认为是一个介绍，它将使你熟悉操作。</p><p id="bb3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">全面了解基础知识总是很重要的。通过积累基础知识，你将获得高级技能。</p><p id="01e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>