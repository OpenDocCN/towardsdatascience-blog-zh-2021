<html>
<head>
<title>Selecting optimal K for K-means clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为K-均值聚类选择最佳K</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/selecting-optimal-k-for-k-means-clustering-c7579fd2e926?source=collection_archive---------14-----------------------#2021-07-26">https://towardsdatascience.com/selecting-optimal-k-for-k-means-clustering-c7579fd2e926?source=collection_archive---------14-----------------------#2021-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a3cb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以有监督的方式使用无监督聚类。</h2></div><p id="c5d0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">K-means clustering</code>是矢量量化的一种方式，最初来自信号处理，旨在根据平均值对观察值进行聚类。让我们首先阐明这里探讨的集群案例的前提；对客户进行细分<strong class="kh ir">。客户细分</strong>是将组织的客户划分为反映每个分组中客户相似性的集群的方法。这种客户剖析的目的是确定如何识别每个片段中的客户，以增加每个客户对企业的价值。</p><p id="6128" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中一种流行的机器学习技术是<code class="fe lb lc ld le b">K-means</code>聚类，这是一种最简单、最流行的无监督机器学习算法。通常，无监督算法仅使用输入向量从数据集进行推断，而不参考已知或标记的结果。</p><blockquote class="lf lg lh"><p id="157c" class="kf kg li kh b ki kj jr kk kl km ju kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">在<a class="ae lm" href="https://www.amazon.com/Steve-Jobs-Walter-Isaacson/dp/1451648537" rel="noopener ugc nofollow" target="_blank">史蒂夫·乔布斯:沃尔特·伊萨克森独家传记</a>中，尽管经常被曲解，乔布斯说:</p><p id="16ae" class="kf kg li kh b ki kj jr kk kl km ju kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">“有些人说，‘给顾客他们想要的东西。’但这不是我的方法。我们的工作是在他们行动之前找出他们想要什么。我想亨利·福特曾经说过，‘如果我问顾客他们想要什么，他们会告诉我，‘一匹更快的马！’。人们不知道他们想要什么，直到你给他们看。这就是我从不依赖市场调查的原因。我们的任务是阅读页面上还没有的东西。"</p></blockquote><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/a6b9c498da31b2cbd1c1c1f69731b1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j7klJMoZx5zHxyAU"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated"><a class="ae lm" href="https://unsplash.com/@applefanboy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> AB </a>在<a class="ae lm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="2004" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让一些人相信，在他看来，市场研究并不重要，但实际上，乔布斯的意思是超越典型的市场研究，提前解读和发现客户需求。为此，市场细分是一个很好的方法，并对每个集群进行有针对性的市场研究。例如，大学新生的需求与中年户主购买金融服务的需求不同，他们的营销方式也不应该相同。</p><p id="f31c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于营销人员和政策制定者来说，了解不同类别的客户以满足他们更好地服务的需求是至关重要的。吸引新客户不再是成熟企业的好策略，因为帮助现有客户的成本要低得多。哪些属性应该用于此细分？那要看情况了。</p><p id="9aa9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="li">四类客户细分:</em> </strong></p><ul class=""><li id="3dc8" class="md me iq kh b ki kj kl km ko mf ks mg kw mh la mi mj mk ml bi translated">行为细分:关注客户的习惯。例如基于使用的分段。</li><li id="9a8f" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">心理细分:基于不明显特征的细分。例如价值观或观点。</li><li id="7b72" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">基于粗略的特征。例如职业、婚姻状况。</li><li id="54f1" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">地理分割:基于位置。例如城市、国家。</li></ul><p id="e978" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过做客户细分，你会发现每个客户的行为和需求都有相似的特征。然后，这些被归纳成组，这些组可以用来满足具有无数策略的特定需求。此外，这些策略可以是以下内容的输入:</p><ul class=""><li id="345b" class="md me iq kh b ki kj kl km ko mf ks mg kw mh la mi mj mk ml bi translated">目标营销</li><li id="5f56" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">引入符合客户需求的功能</li><li id="af0a" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">产品路线图的开发</li></ul><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mr"><img src="../Images/ee8f1028f4af8c3576bcbef48bf3cefe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SWvo1xYVUJARoz2t"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">照片由<a class="ae lm" href="https://unsplash.com/@emilymorter?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾米丽·莫特</a>在<a class="ae lm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="9051" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用无监督聚类也提出了一个问题，要创建多少个聚类？这是一个很难直接回答的问题。通常，时间经理或CEO会根据特定的业务目标对集群的数量有特定的要求。但是，当数据泄露时，您如何决定是否应该得出集群的数量呢？在这篇博文中，我将描述获得这个数字的技术。话虽如此，但重要的是要知道算法所建议的可能不是最佳的聚类数。分析师应该用商业判断来证明她的选择。这与其说是科学，不如说是一门艺术，选择聚类的数量对于根据分析制定的策略的成功是有害的，因为无意义的输入数据导致无意义的输出。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="a4e6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于本演示，使用了来自<a class="ae lm" href="https://leaps.analyttica.com/sample_cases/11" rel="noopener ugc nofollow" target="_blank"> LEAPS Analyttica </a>的数据集。对数据集进行最小程度的清理，然后使用<code class="fe lb lc ld le b">StandardScaler </code>对数值数据进行缩放，使用<code class="fe lb lc ld le b">OneHotEncoder</code>对分类变量进行一次热编码，以便在使用<a class="ae lm" href="https://scikit-learn.org/stable/index.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a> API的机器学习算法中使用。所有转换都是使用scikit-learn管道和转换器来执行的。</p><p id="1350" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">方法1:使用</strong> <code class="fe lb lc ld le b"><strong class="kh ir">K-means++</strong></code> <strong class="kh ir">和不同的“K”的</strong></p><p id="1946" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总共创建了20个模型，并绘制了<code class="fe lb lc ld le b">inertia</code>、<code class="fe lb lc ld le b">Silhouette Score</code>和<code class="fe lb lc ld le b">Calinski Harabasz Score</code>的分数。这方面的代码如下:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="b58e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这产生了以下情节:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nb"><img src="../Images/4a3c3710e0708caccbf5d7a95ae6fb3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2wDTr1wPHccL0Bh99gckw.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">按作者选择最佳“k”图像</p></figure><p id="74f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">较高的<code class="fe lb lc ld le b">Silhouette Coefficient score</code>与具有更好定义的聚类的模型相关。而更高的<code class="fe lb lc ld le b">Calinski-Harabasz score</code>涉及具有更好定义的聚类的模型。</p><p id="6021" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然通过观察视觉，没有明显的最佳K可以被发现。</p><p id="8986" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基于<code class="fe lb lc ld le b">Silhouette Score</code>和<code class="fe lb lc ld le b">Sum of squared error</code>(又名肘图)，5个分段似乎是初始模型的最佳选择。<code class="fe lb lc ld le b">Calinski Harabasz Score</code>也支持这种分割。</p><p id="d95f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">方法二:使用</strong> <a class="ae lm" href="https://www.scikit-yb.org/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">黄砖</strong> </a> <strong class="kh ir">包</strong></p><p id="c7b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试K-意味着模型的K值为2到10，使用随机状态进行再现性测试，并且不显示模型拟合的时间。使用的代码:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/41d79a7d1355cac06cea2b8c20b35946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*MxkQcU_4geziesIokE8nhg.png"/></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">作者图片</p></figure><p id="6fce" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该图建议将<code class="fe lb lc ld le b">K=5</code>作为最佳集群数。</p><p id="f657" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在使用主成分分析来使用<a class="ae lm" href="https://www.scikit-yb.org/en/latest/" rel="noopener ugc nofollow" target="_blank">黄砖</a>在二维空间中可视化聚类。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/31b55723b2e52083dfc43b1d3a32954e.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*KxZzO_qtEHfBRqvcrs02Ag.png"/></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">作者图片</p></figure><p id="7e05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检测到簇之间的明显分离。</p><p id="5943" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">方法三:使用</strong> <code class="fe lb lc ld le b"><strong class="kh ir">MeanShfit</strong></code> <strong class="kh ir">发现集群</strong></p><p id="bef3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">均值漂移聚类旨在发现样本的平滑密度中的“斑点”。这是一种基于质心的算法，其工作原理是将候选质心更新为给定区域内点的平均值。然后，在后处理阶段过滤这些候选对象，以消除近似重复，从而形成最终的质心集。<a class="ae lm" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MeanShift.html" rel="noopener ugc nofollow" target="_blank">(来自scikit-learn文档)</a></p><p id="9d54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用的代码:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="683c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代码的输出是:</p><pre class="lo lp lq lr gt ne le nf ng aw nh bi"><span id="4efb" class="ni nj iq le b gy nk nl l nm nn">Number of estimated clusters : 5</span></pre><p id="ed02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">MeanShift</code>建议5为最佳聚类数。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="b1d8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我用<code class="fe lb lc ld le b">K=5</code>创建了一个<code class="fe lb lc ld le b">K-means++</code>模型用于我的分析。PCA为3时，这些聚类是可见的。那些3的主成分分析可以解释40%的数据集。观察到集群之间的适当区别。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi no"><img src="../Images/64225eb8c7a8e4f840740e81a783bb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*cOXeJjc8XY3DisDDdTnNuQ.png"/></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">PCA3群集，按作者分类的图像</p></figure><p id="efb5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很好看的聚类，不是吗？</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="9683" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="li">监督无监督聚类:</em></p><p id="4e89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我使用随机Forrest分类模型验证了我的聚类。在将训练测试中的数据集按80%–20%的比率拆分后，我使用聚类模型的预测作为随机森林分类模型的因变量。并检验了模型的预测能力。如果聚类有意义，随机森林模型将能够更准确地预测聚类。该模型在测试集上达到了0.93的模型精度。然后，利用来自随机森林模型的特征重要性和置换重要性的组合的洞察力，探索聚类以识别特征，用于进一步探索聚类内和聚类间的特征。<code class="fe lb lc ld le b">K-means</code>模型能够根据观察到的聚类属性进行很好的聚类。</p><p id="db61" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随机森林分类器的模型报告:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi np"><img src="../Images/aa8adca41278d2a157faa2bdcc0922c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sswJmgn1iQEL8iRn_IzrRA.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">随机森林分类器模型报告，图片由作者提供</p></figure><p id="a5b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">集群的分布:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/129a73e12090b96807fe97834af10def.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*1jyGv6ejBJV8gGuSEzEoQQ.png"/></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">图片作者。</p></figure><p id="ff31" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">探索每个集群后，它们被标记为:</p><ul class=""><li id="3fb8" class="md me iq kh b ki kj kl km ko mf ks mg kw mh la mi mj mk ml bi translated">集群0:低价值服务的频繁用户。</li><li id="6616" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">群组1:高风险客户细分。</li><li id="483a" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">第二组:普通客户。</li><li id="1ac8" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">第三类:最忠诚的客户。(主要由老客户组成)</li><li id="0bb3" class="md me iq kh b ki mm kl mn ko mo ks mp kw mq la mi mj mk ml bi translated">集群4:高价值客户。</li></ul></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="f5cb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此工作流是为无监督聚类模型决定最佳K的一个很好的选择，并使用监督分类模型验证选择。</p><p id="2ebe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有这些都可以在GitHub上找到，点击<a class="ae lm" href="https://github.com/tamjid-ahsan/Selecting-optimal-K-for-K-means-clustering" rel="noopener ugc nofollow" target="_blank">这个链接</a>。这种分析通过客户流失分析进行了扩展，可以在GitHub上使用<a class="ae lm" href="https://github.com/tamjid-ahsan/capstone_customer_churn" rel="noopener ugc nofollow" target="_blank">这个链接</a>找到。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="3bc9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天到此为止。下次见！</p></div></div>    
</body>
</html>