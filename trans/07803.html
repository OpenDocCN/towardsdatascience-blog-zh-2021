<html>
<head>
<title>How to overlay Polygon Shapes onto high-resolution maps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在高分辨率地图上叠加多边形形状</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-overlay-shapefile-data-on-pygmt-maps-3a2d84550780?source=collection_archive---------13-----------------------#2021-07-17">https://towardsdatascience.com/how-to-overlay-shapefile-data-on-pygmt-maps-3a2d84550780?source=collection_archive---------13-----------------------#2021-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="de8d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们将学习如何在PyGMT地图上使用geopandas绘制选定的shapefile数据。</h2></div><p id="c453" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Python中的PyGMT库使绘制高分辨率地形图变得轻而易举。它带有海岸线、国界和地形数据。通常，我们需要使用可用的shapefile (SHP)数据在地图上高亮显示任意选择的多边形形状或区域。</p><div class="lb lc gp gr ld le"><a href="https://www.earthinversion.com/utilities/pygmt-high-resolution-topographic-map-in-python/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">PyGMT:Python中的高分辨率地形图(包括代码)</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">一个简单的教程，如何使用GMT工具绘制高分辨率地形图的Python地形图南部…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">www.earthinversion.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls lt le"/></div></div></a></div><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lu"><img src="../Images/38b680104c3cf2345157bade8100d501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*enm_ltLnbAslKxsQ"/></div></div><p class="mf mg gj gh gi mh mi bd b be z dk translated">安德鲁·斯图特斯曼在<a class="ae mj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="26a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本帖中，我们将看到如何使用geopandas库将shapefile数据叠加在PyGMT地图上。例如，在这里，我获得了。来自<a class="ae mj" href="https://data.gov.tw/dataset/7442" rel="noopener ugc nofollow" target="_blank">data.gov.tw</a>的shp格式，并叠加在台湾的高分辨率地图上。</p><h1 id="8718" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">导入库</h1><p id="b501" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">我们将使用geopandas库来读取。shp文件。</p><pre class="lv lw lx ly gt nh ni nj nk aw nl bi"><span id="d85f" class="nm ml iq ni b gy nn no l np nq">import pygmt<br/>import os<br/>import geopandas as gpd</span></pre><h1 id="e2ac" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">县<code class="fe nr ns nt ni b">shp</code>数据</h1><p id="cf60" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">我从各县下载了<code class="fe nr ns nt ni b">shp</code>数据，并将其保存在<code class="fe nr ns nt ni b">countiesData</code>的工作目录中。<code class="fe nr ns nt ni b">countiesData</code>中有多个文件，但我们只需要<code class="fe nr ns nt ni b">COUNTY_MOI_1090820.shp</code>文件。其他的都是相关的扩展文件。</p><p id="3b91" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们选择了两个县在地图上突出显示——台北市和台南市。</p><pre class="lv lw lx ly gt nh ni nj nk aw nl bi"><span id="3bda" class="nm ml iq ni b gy nn no l np nq">countiesShp = os.path.join("countiesData","COUNTY_MOI_1090820.shp")</span><span id="af3e" class="nm ml iq ni b gy nu no l np nq">gdf = gpd.read_file(countiesShp)</span><span id="87b0" class="nm ml iq ni b gy nu no l np nq">all_data = []<br/>all_data.append(gdf[gdf["COUNTYENG"]=="Taipei City"])<br/>all_data.append(gdf[gdf["COUNTYENG"]=="Tainan City"])</span></pre><h1 id="5521" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">使用PyGMT绘制底图</h1><p id="71c2" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">现在，我们可以使用PyGMT绘制简单的底图。使用PyGMT的好处是我们不需要单独的海岸线和地形数据，并且输出是高分辨率的。</p><pre class="lv lw lx ly gt nh ni nj nk aw nl bi"><span id="b530" class="nm ml iq ni b gy nn no l np nq">region = [119, 123, 21, 26]</span><span id="589d" class="nm ml iq ni b gy nu no l np nq">fig = pygmt.Figure()<br/>fig.basemap(region=region, projection="M4i", frame=True)</span><span id="368a" class="nm ml iq ni b gy nu no l np nq">fig.coast( <br/>    water='skyblue', <br/>    shorelines=True)</span></pre><h1 id="76d9" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">覆盖各县</h1><p id="8d30" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">现在，我们可以覆盖所选的县，用绿色填充它们，然后用背景色(白色)填充所有其他的县。</p><pre class="lv lw lx ly gt nh ni nj nk aw nl bi"><span id="8ed2" class="nm ml iq ni b gy nn no l np nq">for data_shp in all_data:<br/>    fig.plot(data=data_shp,color="green")<br/>fig.plot(data=countiesShp)</span></pre><h1 id="ddad" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">以栅格和矢量格式保存地图</h1><p id="7a06" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">现在，我们可以保存地图的光栅和矢量格式供以后使用。</p><pre class="lv lw lx ly gt nh ni nj nk aw nl bi"><span id="1e3b" class="nm ml iq ni b gy nn no l np nq">fig.savefig('map1.png')<br/>fig.savefig('map1.pdf')</span></pre><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nv"><img src="../Images/bec68d1bbb754c300f75c35a3935c52b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gvzoX6QDKZTNJrJZ.png"/></div></div><p class="mf mg gj gh gi mh mi bd b be z dk translated">简单的台湾县地图(图片由作者提供)</p></figure><h1 id="9a77" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">地形图</h1><p id="7e23" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">我们可以使用地形背景，而不是使用简单的白色作为背景(顺便说一句，我觉得这看起来很不错):</p><pre class="lv lw lx ly gt nh ni nj nk aw nl bi"><span id="c161" class="nm ml iq ni b gy nn no l np nq">import pygmt<br/>import os<br/>import geopandas as gpd</span><span id="7611" class="nm ml iq ni b gy nu no l np nq">countiesShp = os.path.join("countiesData","COUNTY_MOI_1090820.shp")</span><span id="487d" class="nm ml iq ni b gy nu no l np nq">gdf = gpd.read_file(countiesShp)</span><span id="3c05" class="nm ml iq ni b gy nu no l np nq">all_data = []<br/>all_data.append(gdf[gdf["COUNTYENG"]=="Taipei City"])<br/>all_data.append(gdf[gdf["COUNTYENG"]=="Tainan City"])</span><span id="2356" class="nm ml iq ni b gy nu no l np nq">region = [119, 123, 21, 26]</span><span id="40b5" class="nm ml iq ni b gy nu no l np nq">fig = pygmt.Figure()<br/>fig.basemap(region=region, projection="M4i", frame=True)<br/>fig.grdimage("<a class="ae mj" href="http://twitter.com/srtm_relief_03s" rel="noopener ugc nofollow" target="_blank">@srtm_relief_03s</a>", shading=True, cmap='geo')</span><span id="2811" class="nm ml iq ni b gy nu no l np nq">fig.coast( <br/>    water='skyblue', <br/>    shorelines=True)</span><span id="6c06" class="nm ml iq ni b gy nu no l np nq">for data_shp in all_data:<br/>    fig.plot(data=data_shp,color="white", pen=["0.02c", 'white'])<br/>fig.plot(data=countiesShp, pen=["0.02c", 'white'])</span><span id="b729" class="nm ml iq ni b gy nu no l np nq">fig.savefig('map1.png')<br/>fig.savefig('map1.pdf')</span></pre><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nv"><img src="../Images/dbcd702a0d3f88a6cf822fde946fffc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qtp60m-wWFXyGeRBHBLeXw.png"/></div></div><p class="mf mg gj gh gi mh mi bd b be z dk translated">台湾各县地形图(图片由作者提供)</p></figure><h1 id="2666" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">结论</h1><p id="d56b" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">我们已经看到了如何轻松地将shapefile数据添加到PyGMT地图上。我们在台湾的底图上绘制了各县的数据。此外，我们创建了一个覆盖了shapefile数据的高分辨率地形图。</p><div class="lb lc gp gr ld le"><a href="https://www.earthinversion.com/utilities/how-to-overlay-shapefiles-on-pygmt-maps/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">如何在PyGMT地图上叠加shapefile数据</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">这一次我们将看看如何在PyGMT地图上叠加shapefile数据。在这里，例如我拿了县的数据…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">www.earthinversion.com</p></div></div><div class="ln l"><div class="nw l lp lq lr ln ls lt le"/></div></div></a></div></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="a57d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="oe">原载于2021年7月17日</em><a class="ae mj" href="https://www.earthinversion.com/utilities/how-to-overlay-shapefiles-on-pygmt-maps/" rel="noopener ugc nofollow" target="_blank"><em class="oe">【https://www.earthinversion.com】</em></a><em class="oe">。</em></p></div></div>    
</body>
</html>