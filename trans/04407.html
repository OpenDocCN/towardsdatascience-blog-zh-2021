<html>
<head>
<title>How to detect outliers with Python pyod</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python pyod检测异常值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-detect-outliers-with-python-pyod-aa7147359e4b?source=collection_archive---------16-----------------------#2021-04-14">https://towardsdatascience.com/how-to-detect-outliers-with-python-pyod-aa7147359e4b?source=collection_archive---------16-----------------------#2021-04-14</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="c6b2" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph">数据预处理</h2><div class=""/><div class=""><h2 id="6e01" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">关于pyod库使用的快速教程。</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/720b7d7353ed14fab0cec1646d6dca85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M-7vk1bGfcYKLf0k"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">威尔·梅尔斯在<a class="ae lk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="27e7" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">异常值检测是一种预处理技术，它允许识别数据集中的<em class="mh">奇怪的</em>数据点。</p><p id="efc2" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">数据预处理还包括:</p><ul class=""><li id="5bb1" class="mi mj iw ln b lo lp lr ls lu mk ly ml mc mm mg mn mo mp mq bi translated"><a class="ae lk" rel="noopener" target="_blank" href="/data-preprocessing-with-python-pandas-part-1-missing-data-45e76b781993?source=your_stories_page-------------------------------------">缺失值</a></li><li id="d091" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><a class="ae lk" rel="noopener" target="_blank" href="/data-preprocessing-with-python-pandas-part-4-standardization-ccd5b1608f1c?source=your_stories_page-------------------------------------">标准化</a></li><li id="ad38" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><a class="ae lk" rel="noopener" target="_blank" href="/data-preprocessing-with-python-pandas-part-3-normalisation-5b5392d27673?source=your_stories_page-------------------------------------">正常化</a></li><li id="43cf" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><a class="ae lk" rel="noopener" target="_blank" href="/data-processing-with-python-pandas-part-2-data-formatting-710c2eafa426?source=your_stories_page-------------------------------------">格式化</a></li><li id="8bf5" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><a class="ae lk" rel="noopener" target="_blank" href="/data-preprocessing-with-python-pandas-part-5-binning-c5bd5fd1b950?source=your_stories_page-------------------------------------">宁滨</a></li><li id="15a7" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><a class="ae lk" rel="noopener" target="_blank" href="/data-preprocessing-in-python-pandas-part-6-dropping-duplicates-e35e46bcc9d6">删除重复</a>。</li></ul><p id="8489" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">数据集中的异常值检测包括发现具有异常行为的项目。离群值检测可以被认为是一种预处理技术，以及缺失值检测、规范化、标准化、数据格式化、数据宁滨和删除重复项。在Sergio Santoyo的这篇有趣的文章中可以找到异常值检测的快速介绍。</p><p id="30e1" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">存在不同的异常值检测技术:</p><ul class=""><li id="e63f" class="mi mj iw ln b lo lp lr ls lu mk ly ml mc mm mg mn mo mp mq bi translated">极值分析:这种方法假设太大或太小的值都是异常值。这项技术包括Z检验和学生的t检验；</li><li id="7ba5" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><strong class="ln jg">概率和统计模型</strong>:这些方法假设数据的特定分布。离群点是概率低的点；</li><li id="6732" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><strong class="ln jg">线性模型</strong>:这些方法利用每个数据点到特定平面的距离来发现异常值。这些技术包括PCA(主成分分析)；</li><li id="9a65" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><strong class="ln jg">基于接近度的模型</strong>:在这些模型中，离群点是指从其余观察中分离出来的点。这些技术包括聚类分析、基于密度的分析和最近邻法；</li><li id="3180" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><strong class="ln jg">信息论模型</strong>:在这些模型中，离群值增加了描述数据集的最小代码长度；</li><li id="6d96" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated"><strong class="ln jg">高维离群点检测</strong>:这些模型实现了特定的方法来处理高维稀疏数据。</li></ul><p id="3e29" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在本教程中，我利用了<code class="fe mw mx my mz b">pyod</code> Python库，它支持以下异常值检测技术:</p><ul class=""><li id="3289" class="mi mj iw ln b lo lp lr ls lu mk ly ml mc mm mg mn mo mp mq bi translated">基于邻近的</li><li id="6f0b" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">线性的</li><li id="b8c3" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">盖然论的</li><li id="e032" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">离群系综</li><li id="f786" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">神经网络。</li></ul><p id="bf39" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe mw mx my mz b">pyod</code>库的完整文档可以在<a class="ae lk" href="https://pyod.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">这个链接</a>中找到。在本教程中，我只关注前三种技术。</p><p id="8623" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">这个教程可以从我的<a class="ae lk" href="https://github.com/alod83/data-science/tree/master/Preprocessing/OutliersDetection" rel="noopener ugc nofollow" target="_blank"> Github库</a>下载。</p><h1 id="8f88" class="na nb iw bd nc nd ne nf ng nh ni nj nk kl nl km nm ko nn kp no kr np ks nq nr bi translated">构建数据集</h1><p id="88ce" class="pw-post-body-paragraph ll lm iw ln b lo ns kg lq lr nt kj lt lu nu lw lx ly nv ma mb mc nw me mf mg ip bi translated">首先，我从头开始构建数据集:我构建一个正弦波，然后通过手动添加三个异常值来扰动它。我利用<code class="fe mw mx my mz b">numpy</code>库的<code class="fe mw mx my mz b">sin()</code>函数来构建正弦波。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="ddfd" class="ob nb iw mz b gz oc od l oe of">import numpy as np</span><span id="ef12" class="ob nb iw mz b gz og od l oe of">X = np.arange(0,100)<br/>Y = np.sin(50*X)</span></pre><p id="edbe" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在波动扰动之前，我通过<code class="fe mw mx my mz b">matplotlib</code>库绘制了它。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="65ec" class="ob nb iw mz b gz oc od l oe of">import matplotlib.pyplot as plt</span><span id="c79c" class="ob nb iw mz b gz og od l oe of">plt.plot(X,Y)<br/>plt.scatter(X,Y)<br/>plt.grid()<br/>plt.ylabel('Y')<br/>plt.xlabel('X')<br/>plt.show()</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj oh"><img src="../Images/1266d0b7c93b48f0bbe5ef975ec50865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09wChIGY-BXQGRmUYwoR_Q.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="449c" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在我通过修改一些Y值来扰动正弦波。最后，我有3个异常值。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="5377" class="ob nb iw mz b gz oc od l oe of">Y[5] = 1.25<br/>Y[60] = -2<br/>Y[85] = 1.4<br/>n_outliers = 3</span></pre><p id="7146" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我画出了扰动后的波形。3个异常值的存在是清楚的。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="06ac" class="ob nb iw mz b gz oc od l oe of">plt.plot(X,Y)<br/>plt.scatter(X,Y)<br/>plt.grid()<br/>plt.ylabel('Y')<br/>plt.xlabel('X')<br/>plt.show()</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj oi"><img src="../Images/dbfcb1224ebf69bc73294b8678da24b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8RUHBTYRo7Og7jQ2f-ZuQ.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><h1 id="ab6e" class="na nb iw bd nc nd ne nf ng nh ni nj nk kl nl km nm ko nn kp no kr np ks nq nr bi translated">基于邻近的模型</h1><p id="71fe" class="pw-post-body-paragraph ll lm iw ln b lo ns kg lq lr nt kj lt lu nu lw lx ly nv ma mb mc nw me mf mg ip bi translated">这些模型将异常值视为与其余观察值隔离的点。基于邻近度的主要模型包括:</p><ul class=""><li id="6af1" class="mi mj iw ln b lo lp lr ls lu mk ly ml mc mm mg mn mo mp mq bi translated">聚类分析</li><li id="5a03" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">基于密度的分析</li><li id="e428" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">最近的街区。</li></ul><p id="083a" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe mw mx my mz b">pyod</code>库实现了以下算法:</p><ul class=""><li id="b6da" class="mi mj iw ln b lo lp lr ls lu mk ly ml mc mm mg mn mo mp mq bi translated">LOF(局部异常因素)</li><li id="d314" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">COF(基于连通性的异常因素</li><li id="6e92" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">基于聚类的局部离群因子</li><li id="8503" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">局部相关积分</li><li id="f685" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">基于直方图的异常值分数</li><li id="d22f" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">kNN (k最近邻)</li><li id="a34f" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">平均KNN</li><li id="66b7" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">MedKNN(中位数KNN)</li><li id="6b6c" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">子空间离群点检测</li><li id="99fd" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">ROD(基于旋转的异常检测)</li></ul><p id="461c" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在本教程中，我利用了<code class="fe mw mx my mz b">KNN</code>模型。首先，我将<code class="fe mw mx my mz b">Y</code>数据改造成可以作为<code class="fe mw mx my mz b">KNN()</code>模型输入的格式。然后，我构建了<code class="fe mw mx my mz b">KNN</code>模型，并用<code class="fe mw mx my mz b">Y</code>来拟合它。最后，我通过<code class="fe mw mx my mz b">predict()</code>函数预测异常值。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="28ea" class="ob nb iw mz b gz oc od l oe of">from pyod.models.knn import KNN</span><span id="737a" class="ob nb iw mz b gz og od l oe of">Y = Y.reshape(-1, 1)<br/>clf = KNN()<br/>clf.fit(Y)</span><span id="507f" class="ob nb iw mz b gz og od l oe of">outliers = clf.predict(Y)</span></pre><p id="7e04" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe mw mx my mz b">outliers</code>变量是一个数组，如果<code class="fe mw mx my mz b">Y</code>中对应的值是离群值<code class="fe mw mx my mz b">0</code>，则包含<code class="fe mw mx my mz b">1</code>，否则包含<code class="fe mw mx my mz b">0</code>。因此，我可以通过名为<code class="fe mw mx my mz b">where()</code>的<code class="fe mw mx my mz b">numpy</code>函数来计算异常值的位置。在这个例子中，算法正确地检测出异常值。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="53fe" class="ob nb iw mz b gz oc od l oe of">np.where(outliers==1)</span></pre><p id="611f" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">它给出了以下输出:</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="89aa" class="ob nb iw mz b gz oc od l oe of">(array([ 5, 60, 85]),)</span></pre><p id="adec" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我绘制结果。首先我计算<code class="fe mw mx my mz b">Y_outliers</code>和<code class="fe mw mx my mz b">X_outliers</code>，以及<code class="fe mw mx my mz b">Y_inliers</code>和<code class="fe mw mx my mz b">X_inliers</code>。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="cd60" class="ob nb iw mz b gz oc od l oe of">Y_outliers = Y[np.where(outliers==1)]<br/>X_outliers = X[np.where(outliers==1)]<br/>Y_inliers = Y[np.where(outliers==0)]<br/>X_inliers = X[np.where(outliers==0)]</span></pre><p id="6ae3" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">然后，我画一个散点图。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="99cd" class="ob nb iw mz b gz oc od l oe of">plt.scatter(X_outliers, Y_outliers, edgecolor='black',color='red', label='outliers')<br/>plt.scatter(X_inliers, Y_inliers, edgecolor='black',color='green', label='inliers')<br/>plt.legend()<br/>plt.grid()<br/>plt.ylabel('Y')<br/>plt.xlabel('X')<br/>plt.show()</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj oj"><img src="../Images/dc643d28e0930145a5a983c102b81004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NY6N8MvWjMIz830Deu2yZQ.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="1b50" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">每个异常值检测算法为每个数据点计算一个异常值。数据点的异常值越大，该数据点为异常值的概率就越高。我通过<code class="fe mw mx my mz b">decision_function()</code>计算异常分数。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="ebd2" class="ob nb iw mz b gz oc od l oe of">anomaly_score = clf.decision_function(Y)</span></pre><p id="54db" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我绘制了一个直方图，其中显示了异常值，一条垂直线显示了算法用来检测异常值的最小异常值。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="d007" class="ob nb iw mz b gz oc od l oe of">min_outlier_anomaly_score = np.floor(np.min(anomaly_score[np.where(outliers==1)])*10)/10<br/>plt.hist(anomaly_score, bins=n_bins)<br/>plt.axvline(min_outlier_anomaly_score, c='k')<br/>plt.xlabel('Anomaly Score')<br/>plt.ylabel('Number of data points')<br/>plt.show()</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ok"><img src="../Images/9d577a552b79b96370a9151e8c9edcfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKtbST-q49TO6rylT9q3Ug.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="827d" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我可以手动定义异常值。例如，我可以考虑异常值大于0.3的所有数据点。在这种特定的情况下，手动定义并不好用，但在其他情况下，它可能是有用的。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="4c65" class="ob nb iw mz b gz oc od l oe of">raw_outliers = np.where(anomaly_score &gt;= 0.3)<br/>raw_outliers</span></pre><p id="4415" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">它给出了以下输出:</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="85e2" class="ob nb iw mz b gz oc od l oe of">(array([60, 85]),)</span></pre><h1 id="97be" class="na nb iw bd nc nd ne nf ng nh ni nj nk kl nl km nm ko nn kp no kr np ks nq nr bi translated">推广到其他模型</h1><p id="f1db" class="pw-post-body-paragraph ll lm iw ln b lo ns kg lq lr nt kj lt lu nu lw lx ly nv ma mb mc nw me mf mg ip bi translated">所描述的过程也可以推广到其他方法。为了避免重复代码，我定义了一个名为<code class="fe mw mx my mz b">outliers_detection()</code>的函数，它接收异常模型及其名称作为输入。该函数精确计算出我为<code class="fe mw mx my mz b">KNN</code>模型计算出的值。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="9ad4" class="ob nb iw mz b gz oc od l oe of">def outliers_detection(model, name):<br/>    clf = model<br/>    clf.fit(Y)<br/>    <br/>    outliers = clf.predict(Y)<br/>    <br/>    Y_outliers = Y[np.where(outliers==1)]<br/>    X_outliers = X[np.where(outliers==1)]<br/>    <br/>    Y_inliers = Y[np.where(outliers==0)]<br/>    X_inliers = X[np.where(outliers==0)]<br/>    print(X_outliers)<br/>    <br/>    <br/>    plt.scatter(X_outliers, Y_outliers, edgecolor='black',color='red', label='outliers')<br/>    plt.scatter(X_inliers, Y_inliers, edgecolor='black',color='green', label='inliers')<br/>    plt.title(name)<br/>    plt.legend()<br/>    plt.grid()<br/>    plt.ylabel('Y')<br/>    plt.xlabel('X')<br/>    plt.show()<br/>    <br/>    anomaly_score = clf.decision_function(Y)<br/>    min_outlier_anomaly_score = np.floor(np.min(anomaly_score[np.where(outliers==1)])*10)/10<br/>    plt.hist(anomaly_score, bins=n_bins)<br/>    plt.axvline(min_outlier_anomaly_score, c='k')<br/>    plt.xlabel('Anomaly Score')<br/>    plt.ylabel('Number of data points')<br/>    plt.show()<br/>    return anomaly_score</span></pre><h1 id="f3bb" class="na nb iw bd nc nd ne nf ng nh ni nj nk kl nl km nm ko nn kp no kr np ks nq nr bi translated">线性模型</h1><p id="6b39" class="pw-post-body-paragraph ll lm iw ln b lo ns kg lq lr nt kj lt lu nu lw lx ly nv ma mb mc nw me mf mg ip bi translated"><code class="fe mw mx my mz b">pyod</code>库实现了以下线性模型:</p><ul class=""><li id="3765" class="mi mj iw ln b lo lp lr ls lu mk ly ml mc mm mg mn mo mp mq bi translated">主成分分析</li><li id="1fc8" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">最小协方差行列式</li><li id="d6c6" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">单类支持向量机</li><li id="589d" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">基于偏差的异常值检测。</li></ul><p id="d562" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在这个例子中，我使用了<code class="fe mw mx my mz b">OCSVM</code>模型。首先，我构建模型，然后调用<code class="fe mw mx my mz b">outliers_detection()</code>函数。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="fafd" class="ob nb iw mz b gz oc od l oe of">from pyod.models.ocsvm import OCSVM<br/>model = OCSVM()<br/>anomaly_score = outliers_detection(model, 'OCSVM')</span></pre><p id="ab6d" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">该模型确定了以下异常值:</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="f72c" class="ob nb iw mz b gz oc od l oe of">[ 5  6 29 30 53 54 60 65 77 85]</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj oj"><img src="../Images/c6ce21ee021bf5b53991751b7d891f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G9Y9EGK9o1N2SP9n2H4j1w.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ol"><img src="../Images/b587e560774be06db32ce754a1402355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U4cTcKdf8-63R-b-eMLDwQ.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="3173" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">这个模型高估了异常值的数量。因此，我可以手动定义离群值。从前面的直方图中，我可以看到，例如，异常值可能是异常值大于2.5的所有数据点。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="2c3a" class="ob nb iw mz b gz oc od l oe of">raw_outliers = np.where(anomaly_score &gt;= 2.5)<br/>raw_outliers</span></pre><p id="45a2" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">它给出了以下输出:</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="83ed" class="ob nb iw mz b gz oc od l oe of">(array([ 5, 60, 85]),)</span></pre><p id="6b17" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在这种情况下，算法会正确识别异常值。</p><p id="30d2" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">或者，当我构建模型时，我可以指定要检测的异常值的百分比，前提是我事先知道异常值的数量。这可以通过设置<code class="fe mw mx my mz b">contamination</code>参数来完成。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="e3af" class="ob nb iw mz b gz oc od l oe of">model = OCSVM(contamination=n_outliers/len(Y))<br/>anomaly_score = outliers_detection(model, 'OCSVM')</span></pre><p id="7506" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">这给出了以下异常值:</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="2bd4" class="ob nb iw mz b gz oc od l oe of">[ 5 60 85]</span></pre><h1 id="84af" class="na nb iw bd nc nd ne nf ng nh ni nj nk kl nl km nm ko nn kp no kr np ks nq nr bi translated">概率模型</h1><p id="9a8a" class="pw-post-body-paragraph ll lm iw ln b lo ns kg lq lr nt kj lt lu nu lw lx ly nv ma mb mc nw me mf mg ip bi translated"><code class="fe mw mx my mz b">pyod</code>库实现了以下概率模型:</p><ul class=""><li id="75e1" class="mi mj iw ln b lo lp lr ls lu mk ly ml mc mm mg mn mo mp mq bi translated">ABOD(基于角度的异常检测)</li><li id="40ef" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">FastABOD(基于角度的快速异常检测)</li><li id="3c77" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">COPOD(基于Copula的离群点检测)</li><li id="43ad" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">中位数绝对偏差</li><li id="b56b" class="mi mj iw ln b lo mr lr ms lu mt ly mu mc mv mg mn mo mp mq bi translated">随机异常值选择。</li></ul><p id="a83e" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在下面的例子中，我主要关注<code class="fe mw mx my mz b">ABOD</code>模型。类似地，对于<code class="fe mw mx my mz b">OCSVM</code>模型，<code class="fe mw mx my mz b">ABOD</code>模型高估了异常值的数量。</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="38d2" class="ob nb iw mz b gz oc od l oe of">from pyod.models.copod import COPOD <br/>    <br/>model = COPOD()<br/>anomaly_score = outliers_detection(model, 'COPOD')</span></pre><p id="3574" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">该模型确定了以下异常值:</p><pre class="kv kw kx ky gu nx mz ny nz aw oa bi"><span id="d912" class="ob nb iw mz b gz oc od l oe of">[ 6 29 30 53 54 60 76 77 78]</span></pre><p id="c4eb" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在这种情况下，识别出的异常值列表不包含任何实际的异常值。因此，在这个具体的例子中不应该使用这个算法。</p><h1 id="7088" class="na nb iw bd nc nd ne nf ng nh ni nj nk kl nl km nm ko nn kp no kr np ks nq nr bi translated">摘要</h1><p id="25de" class="pw-post-body-paragraph ll lm iw ln b lo ns kg lq lr nt kj lt lu nu lw lx ly nv ma mb mc nw me mf mg ip bi translated">在本教程中，我展示了如何使用Python <code class="fe mw mx my mz b">pyod</code>库检测异常值。</p><p id="21e4" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">可以通过手动设置阈值来修改基本算法，以区分正常数据点和异常值。</p><p id="0368" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">或者，可以通过指定污染百分比来修改基本模型。</p><p id="1fd1" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">如果你想了解我的研究和其他活动的最新情况，你可以在<a class="ae lk" href="https://twitter.com/alod83" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae lk" href="https://www.youtube.com/channel/UC4O8-FtQqGIsgDW_ytXIWOg?view_as=subscriber" rel="noopener ugc nofollow" target="_blank"> Youtube </a>和<a class="ae lk" href="https://github.com/alod83" rel="noopener ugc nofollow" target="_blank"> Github </a>上关注我。</p><h1 id="903f" class="na nb iw bd nc nd ne nf ng nh ni nj nk kl nl km nm ko nn kp no kr np ks nq nr bi translated">相关文章</h1><div class="om on gq gs oo op"><a rel="noopener follow" target="_blank" href="/model-evaluation-in-scikit-learn-abce32ee4a99"><div class="oq ab fp"><div class="or ab os cl cj ot"><h2 class="bd jg gz z fq ou fs ft ov fv fx jf bi translated">Scikit-learn中的模型评估</h2><div class="ow l"><h3 class="bd b gz z fq ou fs ft ov fv fx dk translated">关于如何使用scikit-learn计算最常见的回归和分类指标的教程。</h3></div><div class="ox l"><p class="bd b dl z fq ou fs ft ov fv fx dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd le op"/></div></div></a></div><div class="om on gq gs oo op"><a rel="noopener follow" target="_blank" href="/how-to-deal-with-imbalanced-multiclass-datasets-in-python-fe0bb3f2b669"><div class="oq ab fp"><div class="or ab os cl cj ot"><h2 class="bd jg gz z fq ou fs ft ov fv fx jf bi translated">如何在Python中处理不平衡的多类数据集</h2><div class="ox l"><p class="bd b dl z fq ou fs ft ov fv fx dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="pe l pa pb pc oy pd le op"/></div></div></a></div><div class="om on gq gs oo op"><a rel="noopener follow" target="_blank" href="/automl-in-python-a-comparison-between-hyperopt-sklearn-and-tpot-8c12aaf7e829"><div class="oq ab fp"><div class="or ab os cl cj ot"><h2 class="bd jg gz z fq ou fs ft ov fv fx jf bi translated">Python中的AutoML:Hyperopt sk learn和TPOT的比较</h2><div class="ow l"><h3 class="bd b gz z fq ou fs ft ov fv fx dk translated">两种流行的Python AutoML库的优缺点</h3></div><div class="ox l"><p class="bd b dl z fq ou fs ft ov fv fx dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="pf l pa pb pc oy pd le op"/></div></div></a></div></div></div>    
</body>
</html>