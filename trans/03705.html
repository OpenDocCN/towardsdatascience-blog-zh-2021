<html>
<head>
<title>Forecasting Climate Change in Italy with Long Short Term Memory Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用长短期记忆网络预测意大利的气候变化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/forecasting-climate-change-in-italy-with-long-short-term-memory-networks-eef4990d7b8c?source=collection_archive---------16-----------------------#2021-03-26">https://towardsdatascience.com/forecasting-climate-change-in-italy-with-long-short-term-memory-networks-eef4990d7b8c?source=collection_archive---------16-----------------------#2021-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7e02" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/data-for-change" rel="noopener" target="_blank">变更数据</a></h2><div class=""/><div class=""><h2 id="dff3" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用于预测温度趋势的深度学习</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/e98a75f617a4a291355c3ccbe5e5c19a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZ3LAoO6Dh1VD61HZQRjWA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">恩里克·费雷拉在Unsplash上拍摄的照片</p></figure></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h2 id="6c9f" class="lo lp it bd lq lr ls dn lt lu lv dp lw lx ly lz ma mb mc md me mf mg mh mi iz bi translated"><strong class="ak">简介</strong></h2><p id="3787" class="pw-post-body-paragraph mj mk it ml b mm mn kd mo mp mq kg mr lx ms mt mu mb mv mw mx mf my mz na nb im bi translated">我们生活在一个对人类充满挑战的时代，其中最大的挑战之一就是气候变化。那么，在这个充满变化和困难的时代，数据科学在气候变化中的作用有多重要呢？从我个人的角度来看，在不久的将来，数据科学在气候变化中的作用会越来越大。但是让我解释一下为什么。</p><p id="669f" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">例如，考虑组织如何通过使用监测碳排放的传感器来减少碳足迹，或者数据科学家如何使用卫星数据和跟踪实时天气变化，并使用机器学习模型来防止灾难性事件。</p><p id="5159" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">再想想机器学习在电力消耗或农业方面的应用。通过考虑当地天气、气候模式或家庭行为的算法，数据科学家可以实时预测我们长期需要多少能源。</p><p id="4837" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">在农业领域，使用能够感知土壤湿度和养分的物联网设备，结合天气数据，农民可以更好地控制灌溉和施肥系统。</p><p id="cdbd" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">还有许多其他可能性，如使用算法来改善电动汽车的电池能量管理，采用卫星图像和计算机视觉技术来防止大规模的树木覆盖损失。</p><p id="7455" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">然后，正如你所看到的，数据科学在气候变化问题中发挥了重要作用，在这篇文章中，我将向你展示我如何使用深度学习模型来预测我所居住的国家意大利的气温趋势。</p><p id="1610" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">在本文中，我将向您展示:</p><ul class=""><li id="4ffa" class="nh ni it ml b mm nc mp nd lx nj mb nk mf nl nb nm nn no np bi translated">我做的数据可视化是为了理解温度数据</li><li id="1bfe" class="nh ni it ml b mm nq mp nr lx ns mb nt mf nu nb nm nn no np bi translated">长短期记忆网络的直观介绍</li><li id="d8d1" class="nh ni it ml b mm nq mp nr lx ns mb nt mf nu nb nm nn no np bi translated">如何建立LSTM网络</li></ul><p id="80d4" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">你可以在我的<a class="ae nv" href="https://colab.research.google.com/github/moryba/Climate_Analysis/blob/main/climate_analysis.ipynb" rel="noopener ugc nofollow" target="_blank">谷歌实验室</a>或者我的<a class="ae nv" href="https://github.com/moryba/Climate_Analysis" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完整的代码。</p><p id="012a" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">所以，让我们开始吧！</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h2 id="ee78" class="lo lp it bd lq lr ls dn lt lu lv dp lw lx ly lz ma mb mc md me mf mg mh mi iz bi translated">第一部分:数据可视化</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/9be58822aa30a33fa7224f113a9746fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*w4Dypfr-NBbmYjNGDH8uLw.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="3311" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">在上图中，您可以看到数据集中所有国家的全球平均温度。我用下面的代码构建了这个地图。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="5ab1" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">然后，为了对这些年的气温变化有一个时间线的概述，我写了这段代码，以建立一个从1743年到2013年各国气温变化的地图。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="81d7" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">出局:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/153d2a871cf15554e01ce5279899edd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5IXJtgYMaK9SNWWUX2hEBA.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="ec98" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">为了追踪意大利逐月和逐年的平均气温，我构建了如下图表:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="e9af" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">出局:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/4406fd426f8af68faa334597f1ad2730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_5iuvP5v1Fv0EtZjnrFm6g.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="7d2f" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">这一部分以图表的形式展示了我的主要发现，如果你想看到构建这个图表的整个过程，我建议你看看我的Google Colabo <a class="ae nv" href="https://colab.research.google.com/github/moryba/Climate_Analysis/blob/main/climate_analysis.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>或者我的GitHub简介<a class="ae nv" href="https://github.com/moryba/Climate_Analysis" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h2 id="be8b" class="lo lp it bd lq lr ls dn lt lu lv dp lw lx ly lz ma mb mc md me mf mg mh mi iz bi translated">第二部分:对LSTM的直观解读</h2><p id="06fb" class="pw-post-body-paragraph mj mk it ml b mm mn kd mo mp mq kg mr lx ms mt mu mb mv mw mx mf my mz na nb im bi translated">在开始解释什么是长短期记忆网络之前，让我用几句话来给你一个传统神经网络和递归神经网络的局限性的概述。</p><p id="25ca" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">在传统的神经网络中，如果我们在不同的时间将输入输入到模型中，我们将获得独立的输出。事实上，第二个输出(t)没有关于前一个输出(t-1)的信息，这意味着第一个输出对第二个输出没有影响。如果我们需要建立一个能够从过去的输出中学习的模型，以便做出更准确的预测，这是一个很大的限制。这个问题的解决方案是递归神经网络。</p><p id="9852" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">为了直观地理解什么是RNN，当你看你最喜欢的网飞电视剧时想想。每次看新一集的时候，你都需要记住前几集才能理解后面几集。RNN以同样的方式工作，它记住过去的输出，并使用它们来更好地理解后面将要发生的事情。因此，过去的产出和未来的产出之间存在相关性。</p><p id="6f90" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">您还需要知道，rnn使用反向传播算法进行训练，该算法适用于每个时间戳。在反向传播期间，RNNs尝试计算误差，该误差由实际输出和模型输出之间的差给出，并将其提高到2的幂。但是，当RNNs通过递归神经网络的所有多层传播误差时，我们会发现RNNs的性能在训练期间会非常差，因为我们的梯度变得越来越小。</p><p id="5537" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">为了解决这个问题，我们需要梯度值，当它们向后时保持不变。为此，我们需要一个长短期记忆网络。</p><p id="7b8e" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">LSTM网络可以控制何时让输入进入神经元，以及何时记住前一个时间戳中计算的内容。此外，LSTM网络还可以控制何时让输出传递下一个时间戳。</p><p id="c261" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">因此，LSTM神经元与RNN普通神经元的区别在于，它有可能自己决定电流输入。正如你所观察到的，整个过程都是受我们大脑工作方式的启发，这太神奇了。</p><p id="a48f" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">如果你想更深入地了解LSTM，我建议你读一读克里斯托弗·奥拉写的这篇文章<a class="ae nv" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank"> <em class="ob">了解LSTM网络</em> </a> <em class="ob"> </em>。这篇文章对我理解LSTM网络帮助很大。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h2 id="1e3e" class="lo lp it bd lq lr ls dn lt lu lv dp lw lx ly lz ma mb mc md me mf mg mh mi iz bi translated">第三部分:用LSTM网络建立模型</h2><p id="c03b" class="pw-post-body-paragraph mj mk it ml b mm mn kd mo mp mq kg mr lx ms mt mu mb mv mw mx mf my mz na nb im bi translated">在这一部分中，我将向您展示如何准备和构建模型来预测意大利的气温趋势。我将重点介绍如何构建模型，而不是准备过程。如果你想看完整的代码，你可以去我的GitHub档案。</p><p id="d3e0" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">为了构建模型，我们将使用Keras API。如您所见，第一个变量是训练集的输入。然后我们有我们的网络层，其中第一层被输入，包含50个单元。然后，我们有辍学层，允许网络概括，而不是记忆。接下来，我们有另一层LSTM，和另一个辍学层。</p><p id="b309" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">之后，我们有输出变量，该变量增加了具有一个神经元的密集全连接人工神经网络，并且激活函数将是线性的。</p><p id="3e86" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">在函数的最后，我构建了模型，并用adam optimizer和均方误差对模型进行了编译。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="9326" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">现在，我们可以用训练数据训练我们的模型，并查看摘要</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="3f5c" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">出局:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/425518697f23c1dbb5957206d929edba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*IqjS1vuHeAUjhZSG86k_3Q.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="8cee" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">正如你在上面的总结中看到的，有LSTM层、下降层和密集层。</p><p id="6bec" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">最后，我们可以用训练数据(train_x，train_y)拟合模型，并传递验证数据(test_x，test_y)</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="c285" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">出局:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/3185084d9ee0f8bfe47745c44bba244e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*8titFGdLrNjO5PGpWRe5Og.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="77fa" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">输出向我们展示了整个培训过程中损失和错误的进展。在下图中，您可以看到训练和测试集中的损失趋势。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/5b86a6456daefc4921347ac1dec6abaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*J7jSvwyT6sfKOXtlHN7Vlg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="1c1d" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">相反，在下图中，您可以看到原始数据集与预测值的对比。因此，该模型能够捕捉趋势，但它需要一些改进，以捕捉发生的细节。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi of"><img src="../Images/85df7a2ca7d1e89a5d82ba93989f6cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P0_MrCDm1aqzRU5GQ8t4pw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h2 id="9917" class="lo lp it bd lq lr ls dn lt lu lv dp lw lx ly lz ma mb mc md me mf mg mh mi iz bi translated">结论</h2><p id="33bb" class="pw-post-body-paragraph mj mk it ml b mm mn kd mo mp mq kg mr lx ms mt mu mb mv mw mx mf my mz na nb im bi translated">我希望这篇文章能帮助你对气候变化问题产生更多的兴趣，并理解数据科学在解决气候变化问题方面的潜力。</p><p id="b016" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">我用于这个模型的数据集可以在<a class="ae nv" href="https://www.kaggle.com/berkeleyearth/climate-change-earth-surface-temperature-data" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中找到，你可以在我的G <a class="ae nv" href="https://colab.research.google.com/github/moryba/Climate_Analysis/blob/main/climate_analysis.ipynb" rel="noopener ugc nofollow" target="_blank"> oogle Colab </a>或<a class="ae nv" href="https://github.com/moryba/Climate_Analysis" rel="noopener ugc nofollow" target="_blank"> GitHub </a>中找到完整的代码。所以，你可以试着建立你的模型，了解气候如何随时间变化。</p><p id="052e" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">无论如何，对于那些有兴趣深入了解大数据在气候变化中的应用的人，我建议阅读NASA发表的文章<em class="ob">气候科学中的大数据挑战</em>你可以在这里找到<a class="ae nv" href="https://ntrs.nasa.gov/citations/20160002946" rel="noopener ugc nofollow" target="_blank"/>。这篇文章很有见地，可以为您详细解释气候数据分析的基础设施。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="aa57" class="pw-post-body-paragraph mj mk it ml b mm nc kd mo mp nd kg mr lx ne mt mu mb nf mw mx mf ng mz na nb im bi translated">感谢你阅读这篇文章。您还可以通过其他方式与我保持联系并关注我的工作:</p><ul class=""><li id="a962" class="nh ni it ml b mm nc mp nd lx nj mb nk mf nl nb nm nn no np bi translated"><a class="ae nv" href="https://upscri.be/wxv1zi" rel="noopener ugc nofollow" target="_blank">订阅</a>我的时事通讯。</li><li id="327f" class="nh ni it ml b mm nq mp nr lx ns mb nt mf nu nb nm nn no np bi translated">也可以通过我的电报群<a class="ae nv" href="https://t.me/DataScienceForBeginners" rel="noopener ugc nofollow" target="_blank"> <em class="ob">数据科学初学者</em> </a>联系。</li></ul></div></div>    
</body>
</html>