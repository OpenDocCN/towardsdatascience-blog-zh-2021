<html>
<head>
<title>Predict and recommend with Excel like a king</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像国王一样用Excel预测和推荐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predict-and-recommend-with-excel-like-a-king-d6b4065b129f?source=collection_archive---------44-----------------------#2021-10-04">https://towardsdatascience.com/predict-and-recommend-with-excel-like-a-king-d6b4065b129f?source=collection_archive---------44-----------------------#2021-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e4b8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Excel中方便地修改LSTM和先验参数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d6436454ccf4dbd8344b92784fcfe222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8uqZGNyBYWK-gxcVpb7BGg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卢克·坦尼斯在<a class="ae ky" href="https://unsplash.com/s/photos/king?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h2 id="7410" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">动机:</h2><p id="96db" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们已经在之前的帖子中学习了如何在Jupyter Notebook中编写<a class="ae ky" rel="noopener" target="_blank" href="/market-basket-analysis-using-pysparks-fpgrowth-55c37ebd95c0">市场篮子</a>分析、时间序列<a class="ae ky" rel="noopener" target="_blank" href="/prophet-in-a-loop-a875516ef2f9">预测</a>和<a class="ae ky" rel="noopener" target="_blank" href="/recommender-systems-item-customer-collaborative-filtering-ff0c8f41ae8a">推荐引擎</a>。我们还知道如何<a class="ae ky" rel="noopener" target="_blank" href="/excel-python-app-for-non-pythonists-68b4fec0fabf"> Pyinstall </a>这些Python脚本到exe文件中，并与Excel <a class="ae ky" rel="noopener" target="_blank" href="/python-excel-integration-with-xlwings-f9bf9d1332ea"> wings </a>连接。本文证明了这种Excel独立应用程序的好处，它将客户项目销售的预测、推荐和购物篮分析都集中在一个地方。</p><p id="27ec" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">接收方不需要安装Python，也不需要任何深度学习的编码知识。用户只需将数据输入Excel表格，轻松调整算法设置，点击一个按钮即可直接在Excel中接收结果。之后，用户可以修改参数并重新运行，以获得舒适和直接的结果基准。这不仅对于初学者来说是理想的，对于那些想要摆弄这些算法参数并与他们的非Pythonist同事分享结果的高级实践者来说也是理想的。</p><p id="39d4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi mt translated"><span class="l mu mv mw bm mx my mz na nb di"> P </span> redReX:像王者一样用Excel预测推荐！</p><h2 id="66cf" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">解决方案:</h2><p id="3252" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">首先下载<a class="ae ky" href="https://github.com/DAR-DatenanalyseRehberg/PredReX" rel="noopener ugc nofollow" target="_blank"> PredReX </a> Excel模板和<a class="ae ky" href="https://drive.google.com/drive/folders/1uG6j6nAzCBu_FxgB9gGZktt0bLbErgY5" rel="noopener ugc nofollow" target="_blank">三个Exe文件</a>并保存在一个文件夹中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/5d8b5161df81fa762245debd8b7e65f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*HFY680DLnzqdphwnAnFhJA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PredReX Excel和exe文件。</p></figure><p id="5928" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在打开PredReX，看看输入表。对于这个演示，我们将坚持使用已经包含的数据，但是当然您也可以用您自己的数据替换它们。只需注意保持列标题不变，不要修改文件名PredReX.xlsm。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/5190056b177f48026fd40aedac0e9960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*BA3XD_3sBH_Nl3FcQhARGQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输入数据</p></figure><p id="0f07" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">所以我们得到的是每个销售日的销售额。该值可以是售出的物品数量或销售额，例如以美元计。客户代码25代表一个特定的客户，而销售项目806代表一个特定的销售项目(项目66代表另一个独特的项目，以此类推)。销售交易id是一个账单号，在进行购物篮分析时非常重要。</p><p id="86c4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在让我们转到有趣的部分，选项卡“参数”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/3fec4226fc74dc2218ceb3c2d7a05b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpwXry2llU00vy7zUlZAIw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">所有这些参数都是可调的。</p></figure><p id="23e6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">本文将不解释长短期记忆(LSTM)背后的理论，这是一种用于深度学习领域的特殊类型的递归神经网络。另外，像购物篮分析和推荐这样的数据挖掘技术已经在其他重要的帖子中大量出现。但我对PredReX的想法是为您提供一种务实地尝试这些参数的相互作用的方法，以获得这些算法背后的实际直觉。</p><p id="1f68" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">预测</strong></p><p id="9028" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">有很多关于LSTM的参数，我们可以用来预测未来的销售。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/c68d504958d1e89b1621968cab944b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A4__YpTNGmpfWzuc8zHOLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输入不同的值或从下拉列表中选择。</p></figure><p id="00e0" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">请注意，无论您的预测是基于每日、每周、每月还是每年的水平，为了得到有意义的结果，这都应该与重采样大小相匹配。历元的数量定义了学习算法在数据集上工作的频率。批次大小是模型更新前处理的样本数，必须&gt; =1，而时期数可以设置为1到无穷大之间的整数值。你可以选择MSE，MAE，MAPE和MSLE作为损失函数。对于优化者，你可以选择亚当、阿达马克斯或Sgd。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/88c8d9f4d551b041f4830e81e3294bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*NW_6FmUkJJsVYkrc7Gdnlg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">享受调整LSTM提供的不同超参数的乐趣。</p></figure><p id="9235" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">一旦点击“预测”按钮，Lstm.exe将被执行，预测将被保存到输出表中。您可以检查这两种评估:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/eb790c76c84ff776e791d4524c706933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ax9iuOrNedfBxKvoeg3T0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实际值用蓝色突出显示，预测值用红色显示。</p></figure><p id="9031" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">..以及损失函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a3fcc4ca3d69e4ea7430f4ff2e9f5d4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*_nSt5klkZiNSqPqxBIE3bg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">有100个纪元的例子。</p></figure><p id="05dd" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在你调查了你的结果后，你现在可能想预测每周的水平？继续从适当的下拉列表中选择，重新运行预测并比较您的结果。请记住，没有现成的最佳总体超参数设置，但这确实取决于数据。PredReX试图帮助你对此有一个直觉。用自己的数据试一下就好了。</p><p id="96ec" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">推荐</strong></p><p id="cb00" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">下一步，我们希望在我们的销售交易id中找到模式。进行购物篮分析时，您可以更改最小支持度和阈值，以及项目集的长度。至于指标，您可以选择置信度或提升度..</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/04d0b63b06b74e7356e7cc041899d15f.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*DPp4WCvgdJxTFnWHNQqtrA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">试验这四个先验参数。</p></figure><p id="4440" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">..要查看它如何与您的数据交互:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ce2eed8fff3e58cddb2e99b8399f823f.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*V5iLiOE5l0a13SJfr3jh7A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对项集的支持以逗号分隔。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/7e61aeb7db7a3745952184f61c34bc33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FBeLrz4ycp4wlG6Wn-phsg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">支持、信心和提升可能是市场篮子分析中最常用的指标。</p></figure><p id="c50b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">从购物篮中，我们了解了经常一起购买的商品。现在，我们将继续向前，希望主动向客户推荐他们尚未购买但应该会非常感兴趣的商品。该建议将基于余弦相似性或曼哈顿/欧几里得距离，您可以从下拉列表中进行选择。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/23234f144bda4f3ac09e480a07551e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*5UzYtCeqnXSsN6T8hzB-Tg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e18521c2a56721f9ab1a5fc057bad885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*hVAtNb_8LpJYf68UJA0qYA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">相似性或距离将显示在“输出Sim”选项卡中。</p></figure><p id="e2ea" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">使用“top amount ”,您可以输入要推荐的热门商品数量。因此，如果您像上面的屏幕截图中那样选择3，输出将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/c4c89d33be96d57b255311771dc681e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*ZQ0UnUxg67gMYsH__LQBRQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">前3名意味着将向每个客户推荐前3个项目，其中前1个项目是最受推荐的项目，前2个项目是第二受推荐的项目，依此类推。为了更好的可读性，I代表item。</p></figure><h2 id="b501" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h2><p id="15e8" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">恭喜你，你可以挑战许多参数来微调你的预测，并在Excel中轻松推荐商品。利用LSTM，我们回顾了过去的销售情况，试图对未来的销售做出展望。由于有了先验知识，我们可以更好地理解哪些商品经常一起购买。并且使用客户-项目相似性，我们尝试推荐客户应该高度感兴趣的项目。PredReX搭建了一座从过去到未来的桥梁，同时让您以动手操作的方式微调参数设置。我希望这能帮助你更好地理解这些算法。</p><p id="0bac" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">非常感谢您的阅读！希望这篇文章对你有帮助。请随时在<a class="ae ky" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ky" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室</a>与我联系。</p><div class="np nq gp gr nr ns"><a href="https://jesko-rehberg.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">通过我的推荐链接加入Medium-Jesko Rehberg</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">阅读杰斯科·雷伯格(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">jesko-rehberg.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og ks ns"/></div></div></a></div></div></div>    
</body>
</html>