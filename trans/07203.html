<html>
<head>
<title>Comparing InfluxDB, TimescaleDB, and QuestDB Timeseries Databases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比较InfluxDB、TimescaleDB和QuestDB时间系列数据库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/comparing-influxdb-timescaledb-and-questdb-timeseries-databases-c1692b9327a5?source=collection_archive---------11-----------------------#2021-06-30">https://towardsdatascience.com/comparing-influxdb-timescaledb-and-questdb-timeseries-databases-c1692b9327a5?source=collection_archive---------11-----------------------#2021-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a25" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">timeseries数据库的高级概述，用于比较特性、功能、成熟度和性能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f106075a4b2081ec43858f44cea87a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LEYRvX2DQxLoKIG4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">科技日报在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae ky" href="https://unsplash.com/@techdailyca?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="457b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们生活在数据库的<a class="ae ky" href="https://www.protocol.com/manuals/the-new-database/golden-age-databases-last" rel="noopener ugc nofollow" target="_blank">黄金时代</a>，因为资金正以历史性的速度流入这个行业(例如<a class="ae ky" href="https://www.snowflake.com/" rel="noopener ugc nofollow" target="_blank">雪花</a>、<a class="ae ky" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>、<a class="ae ky" href="https://www.cockroachlabs.com/" rel="noopener ugc nofollow" target="_blank">蟑螂实验室</a>、<a class="ae ky" href="https://neo4j.com/" rel="noopener ugc nofollow" target="_blank"> Neo4j </a>)。如果说关系型与非关系型或在线分析处理(OLAP)与在线事务处理(OLTP)之间的争论主导了过去十年，那么一种新型的数据库正日益受到欢迎。根据<a class="ae ky" href="https://db-engines.com/en/" rel="noopener ugc nofollow" target="_blank"> DB-Engines </a>，一个收集和呈现数据库管理系统信息的计划，<a class="ae ky" href="https://db-engines.com/en/ranking_categories" rel="noopener ugc nofollow" target="_blank">时间系列数据库是自2020年以来增长最快的领域</a>:</p><p id="96b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时间系列数据库(TSDB)是针对接收、处理和存储带时间戳的数据而优化的数据库。这些数据可能包括来自服务器和应用程序的指标、来自物联网传感器的读数、网站或应用程序上的用户交互，或者金融市场上的交易活动。时间系列工作负载通常具有以下特征:</p><ul class=""><li id="a786" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">每个数据点都包含一个时间戳，可用于索引、聚合和采样。该数据也可以是多维的和相关的。</li><li id="0b4b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">高写入速度(摄取)是捕获高频率数据的首选。</li><li id="97d6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">数据的汇总视图(例如缩减采样或汇总视图、趋势线)可能比单个数据点提供更多的洞察力。例如，考虑到网络的不可靠性或传感器读数中的异常值，我们可以在某个时间的平均值超过阈值时设置警报，而不是在单个数据点上设置警报。</li><li id="0daf" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">分析数据通常需要在一段时间内访问它(例如，给我过去一周的点击率数据)。</li></ul><p id="f9d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然其他数据库也可以在一定程度上处理时间序列数据，但TSDBs在设计时考虑了上述属性，以便更有效地按时间处理数据接收、压缩和聚合。因此，随着云计算、物联网和机器学习对时间序列数据的需求持续爆炸，架构师应该如何选择TSDB呢？在本文中，我们将比较几个流行的TSDBs以及市场上的新玩家，以帮助您做出决定。</p><h1 id="ea5c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak"> InfluxDB </strong></h1><p id="1c5f" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">InfluxDB于2013年首次发布，现已超越之前的Graphite和OpenTSDB，成为TSDB领域的市场领导者。与许多OSS数据库公司一样，<a class="ae ky" href="https://www.influxdata.com/" rel="noopener ugc nofollow" target="_blank"> InfluxDB </a>获得了MIT单节点许可，付费计划可用于InfluxDB云和InfluxDB enterprise，提供集群和其他生产就绪功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/b27647440aaf8194bdfb0692bf4bbf7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lSB9oz8woe_pfRRH.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.influxdata.com/time-series-database/" rel="noopener ugc nofollow" target="_blank"> influxdata </a>，(<a class="ae ky" href="https://github.com/influxdata/docs-v2/blob/master/LICENSE" rel="noopener ugc nofollow" target="_blank"> MIT </a>)</p></figure><p id="6dca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在2019年InfluxDB 2.x发布之前，InfluxDB平台由TICK堆栈组成:Telegraf(收集和报告指标的代理)、InfluxDB、Chronograf(从InfluxDB查询数据的接口)和Kapacitor(实时流数据处理引擎)。如下图所示，InfluxDB 1.x主要关注来自服务器和web应用程序的时间序列数据。在Prometheus进入这一领域之前，InfluxDB拥有最大的社区和集成来收集、存储和查看应用程序指标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/3393071f758bf2e0dbe9dc8629bcd0f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f9KyRYRgPNX6nUo2.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.influxdata.com/time-series-platform/" rel="noopener ugc nofollow" target="_blank"> influxdata </a>，(<a class="ae ky" href="https://github.com/influxdata/docs-v2/blob/master/LICENSE" rel="noopener ugc nofollow" target="_blank"> MIT </a>)</p></figure><p id="1ad9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">InfluxDB 2.x极大地简化了架构，将TICK堆栈捆绑到单个二进制文件中，并引入了新的功能，以使用Flux语言收集(例如本机Prometheus插件)、组织(例如组织和存储桶)和可视化(例如数据浏览器)数据。</p><p id="0a42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了理解InfluxDB是如何工作的，我们需要掌握以下关键概念:</p><ul class=""><li id="6fb6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">数据模型(标签集模型)</strong>:除了时间戳字段，每个数据元素都由各种标签(可选的、索引的元数据字段)、字段(键和值)和度量(标签、字段和时间戳的容器)组成。下面的例子是科学家安德森和马伦在克拉马斯和波特兰收集的蜜蜂和蚂蚁的普查数据。这里的<em class="ni">位置</em>和<em class="ni">科学家</em>是标签，属于蜜蜂和蚂蚁的<em class="ni">普查</em>测量的字段/值对。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/46aca0ac4285e0a499481b95c8925e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FfojZwCd3SKKpjqY3s53sw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://docs.influxdata.com/influxdb/v2.0/reference/key-concepts/data-elements/" rel="noopener ugc nofollow" target="_blank"> influxdata </a>，(<a class="ae ky" href="https://github.com/influxdata/docs-v2/blob/master/LICENSE" rel="noopener ugc nofollow" target="_blank"> MIT </a>)</p></figure><ul class=""><li id="fc81" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">数据模式(TSM &amp; TSI) </strong>:数据元素存储在时间结构合并树(TSM)和时间序列索引(TSI)文件中。TSM可以被认为是一棵<a class="ae ky" href="https://docs.influxdata.com/influxdb/v1.8/concepts/storage_engine/" rel="noopener ugc nofollow" target="_blank"> LSM树，具有预写日志(WAL)和类似于表</a>的只读文件，它们被排序和压缩。TSI是InfluxDB内存映射的磁盘上文件的索引，以利用操作系统的<a class="ae ky" href="https://docs.influxdata.com/influxdb/v1.8/concepts/time-series-index/" rel="noopener ugc nofollow" target="_blank">最近最少使用(LRU)内存。这有助于处理高基数的数据集(即集合中的大元素)。</a></li><li id="e515" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> Flux脚本语言:</strong>由InfluxDB开发的一种特定领域语言，用于帮助查询数据。Flux还有一个<code class="fe nk nl nm nn b">sql</code>包来帮助查询SQL数据源。</li></ul><p id="2147" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最值得注意的是，InfluxDB在接收数据之前并不强制执行模式。相反，模式是从输入数据自动创建的，从标记和字段推断。这种类似NoSQL的体验既是InfluxDB的优势，也是其劣势。对于基数相对较低、自然适合这种标记集模型的数据集(例如，大多数基础设施和应用程序指标、一些物联网数据、一些财务数据)，InfluxDB非常容易上手，无需担心设计模式或索引。它在目标是创建物理资产的数字模型的用例中也大放异彩。例如，在物联网中，可能需要创建一个数字双胞胎来表示一组传感器，并以有组织的方式接收数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/ebb025b87c99d0ebeaf2f3eb8e7b6e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kxxD4tTcXATXzB7O"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://blog.timescale.com/blog/timescaledb-vs-influxdb-for-time-series-data-timescale-influx-sql-nosql-36489299877/" rel="noopener ugc nofollow" target="_blank"> TimescaleDB </a>，(<a class="ae ky" href="https://github.com/timescale/timescaledb/blob/master/LICENSE-APACHE" rel="noopener ugc nofollow" target="_blank">阿帕奇</a>)</p></figure><p id="0c2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，当数据集需要连续字段的索引(即InfluxDB不支持数字，因为标记必须是字符串)或数据验证时，“无模式”可能是一个缺点。此外，由于标签是索引的，如果标签经常变化(例如，元数据在初始摄取后可能会改变的用例)，依赖InfluxDB来推断模式可能是昂贵的。</p><p id="cf07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，InfluxDB决定创建自己的自定义函数式数据脚本语言(Flux ),这给控制这个生态系统带来了另一层复杂性。InfluxDB的团队指出了从类似SQL的InfluxQL转向Flux的两个动机:</p><ol class=""><li id="60a3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu np mb mc md bi translated">时间序列数据符合基于流的功能处理模型，其中数据流从一个输出转换到下一个输出。SQL支持的关系代数模型也不能处理这种操作和函数的链接。</li><li id="8043" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu np mb mc md bi translated">InfluxDB希望对不属于SQL标准的时间序列数据(例如指数移动平均)的常见操作提供一流的支持。</li></ol><p id="b460" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Flux语法肯定需要一些努力来适应，特别是如果您正在寻找简单的SQL查询或者不打算学习另一种新语言。仍然考虑到InfluxDB 已经组装的大型社区和<a class="ae ky" href="https://www.influxdata.com/products/integrations/" rel="noopener ugc nofollow" target="_blank">集成，Flux的一些优势开始体现出来，尤其是当与内置仪表板结合时。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/6287d8111490c3d8187fc12e8e207afa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iYwnIgwJtjzHG0At.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.influxdata.com/dashboards/" rel="noopener ugc nofollow" target="_blank"> influxdata </a>，(<a class="ae ky" href="https://github.com/influxdata/docs-v2/blob/master/LICENSE" rel="noopener ugc nofollow" target="_blank"> MIT </a>)</p></figure><p id="b22a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，如果时间序列数据非常符合标记集模型，InfluxDB是一个很好的选择。主要用例似乎是面向基础设施/应用程序监控，但作为该领域的市场领导者，InfluxDB还可以与流行的数据源无缝集成。</p><ul class=""><li id="18aa" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">优点<strong class="lb iu"/>:无模式摄取、巨大的社区、与流行工具的集成</li><li id="0eee" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">缺点</strong>:数据集具有高基数、定制查询/处理语言</li></ul><h1 id="5153" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">时标b</h1><p id="130f" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">InfluxDB选择从头构建一个新的数据库和定制语言，而另一端是<a class="ae ky" href="https://www.timescale.com/" rel="noopener ugc nofollow" target="_blank"> TimescaleDB </a>。TimescaleDB构建在PostgreSQL之上，并添加了一个名为<a class="ae ky" href="https://docs.timescale.com/timescaledb/latest/overview/core-concepts/hypertables-and-chunks/" rel="noopener ugc nofollow" target="_blank"> hypertables </a>的中间层，该中间层将数据分块到多个底层表中，同时将其抽象为一个大型表，以便与数据进行交互。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/c54e2aa653bac008506c48fb1db72f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aWD6lEoLFVubgctr"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://blog.timescale.com/blog/timescaledb-vs-influxdb-for-time-series-data-timescale-influx-sql-nosql-36489299877/" rel="noopener ugc nofollow" target="_blank">时间刻度</a>，(<a class="ae ky" href="https://github.com/timescale/timescaledb/blob/master/LICENSE-APACHE" rel="noopener ugc nofollow" target="_blank">阿帕奇</a>)</p></figure><p id="9cd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PostgreSQL兼容性是TimescaleDB最大的卖点。TimescaleDB完全支持所有SQL特性(例如连接、二级和部分索引)以及流行的扩展，如<a class="ae ky" href="https://postgis.net/" rel="noopener ugc nofollow" target="_blank"> PostGIS </a>。更重要的是，TimescaleDB继承了运行SQL查询的开发人员以及大规模运行PostgreSQL的数据库和系统管理员数十年的知识。由于TimescaleDB可以被视为PostgreSQL的扩展，除了TimescaleDB自己的托管产品外，云托管选项(例如用于PostgreSQL的<a class="ae ky" href="https://azure.microsoft.com/en-us/updates/timescaledb-for-azure-database-for-postgresql-to-power-iot-and-time-series-workloads/" rel="noopener ugc nofollow" target="_blank">Azure Database</a>、<a class="ae ky" href="https://help.aiven.io/en/articles/1752157-getting-started-with-timescaledb-in-aiven-for-postgresql" rel="noopener ugc nofollow" target="_blank"> Aiven </a>)也很容易获得，更不用说虚拟机或容器上的无数自我管理选项了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/95ab30780457185dd7abe26f6f947737.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FmrwAYrHI3rWsKNC41jKIw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片鸣谢:<a class="ae ky" href="https://insights.stackoverflow.com/survey/2020#most-popular-technologies" rel="noopener ugc nofollow" target="_blank"> 2020栈溢出开发者调查</a>，(<a class="ae ky" href="https://insights.stackoverflow.com/survey/2020#most-popular-technologies" rel="noopener ugc nofollow" target="_blank"> ODbL </a>)</p></figure><p id="4cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于TimescaleDB最初是一个物联网平台，他们最初实际上使用InfluxDB来存储他们的传感器数据，因此它的功能对于物联网时间序列数据来说是一个好兆头，这些数据通常是突发性的，由于网络不可靠而经常出现故障，并且具有高基数的特点:</p><ul class=""><li id="23e6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">超表:</strong> TimescaleDB <a class="ae ky" href="https://docs.timescale.com/timescaledb/latest/overview/core-concepts/hypertables-and-chunks/#partitioning-in-hypertables-with-chunks" rel="noopener ugc nofollow" target="_blank">基于时间列以及其他“空间”值</a>如设备uid、位置标识符或股票代码，将其超表划分成块。这些区块可以配置为在内存中保存最新的数据，按照时间列(而不是摄取时间)对数据进行异步压缩和重新排序，并跨节点进行事务性复制或迁移。</li><li id="3bb9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">连续聚合:</strong> TimescaleDB还支持<a class="ae ky" href="https://docs.timescale.com/timescaledb/latest/overview/core-concepts/continuous-aggregates/" rel="noopener ugc nofollow" target="_blank">连续聚合数据</a>以快速计算关键指标，如每小时平均值、最小值和最大值。物联网数据通常在聚合时更有用(例如，给我下午3点到4点之间的平均温度，而不是下午3点的确切温度)，因此不需要在每个聚合查询中扫描大量数据，这有助于创建高性能的仪表盘或分析。</li><li id="38b7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">数据保留:</strong>在传统的关系数据库中，大规模删除是一项开销很大的操作。然而，由于TimescaleDB以块的形式存储数据，因此它<a class="ae ky" href="https://docs.timescale.com/timescaledb/latest/overview/core-concepts/data-retention/#data-retention" rel="noopener ugc nofollow" target="_blank">提供了一个</a> <code class="fe nk nl nm nn b"><a class="ae ky" href="https://docs.timescale.com/timescaledb/latest/overview/core-concepts/data-retention/#data-retention" rel="noopener ugc nofollow" target="_blank">drop_chunks</a></code> <a class="ae ky" href="https://docs.timescale.com/timescaledb/latest/overview/core-concepts/data-retention/#data-retention" rel="noopener ugc nofollow" target="_blank">功能来快速丢弃旧数据，而没有相同的开销</a>。由于旧数据的相关性会随着时间的推移而降低，因此可以将TimescaleDB与长期存储(例如OLAP或blob存储)结合使用，以移动旧数据，从而节省磁盘空间并保持较新数据的高性能。</li></ul><p id="0f63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至于性能，TimescaleDB有一个全面的帖子，详细介绍了使用<a class="ae ky" href="https://github.com/timescale/tsbs" rel="noopener ugc nofollow" target="_blank">时间序列基准测试套件(TSBS) </a>比较TimescaleDB版本1.7.1和InfluxDB 1.8.0(两个OSS版本)的插入和读取延迟指标。这两个数据库现在都有2.x版本，所以这种分析可能有点过时，但结果显示，随着数据基数的增长，TimescaleDB的性能会更好(大约3.5倍的性能)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/3dbfe5b42116518673e705bba6380581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Tt0L3imFvAoFYPK1"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://blog.timescale.com/blog/timescaledb-vs-influxdb-for-time-series-data-timescale-influx-sql-nosql-36489299877/" rel="noopener ugc nofollow" target="_blank"> TimescaleDB </a>，(<a class="ae ky" href="https://github.com/timescale/timescaledb/blob/master/LICENSE-APACHE" rel="noopener ugc nofollow" target="_blank">阿帕奇</a></p></figure><p id="f5c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TimescaleDB团队指出InfluxDB的基于日志结构合并树的系统(TSI)与TimescaleDB的B树索引方法的根本原因。然而，这里的要点并不一定是TimescaleDB在性能方面优于InfluxDB。性能基准是固执己见的，并受到数据模型、硬件和配置的严重影响。相反，该结果表明，TimescaleDB可能更适合数据基数较高的物联网用例(例如，给我1000万台设备中设备X的平均功耗)。</p><p id="17b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要深入比较这两个数据库，请查看:</p><div class="nt nu gp gr nv nw"><a href="https://blog.timescale.com/blog/timescaledb-vs-influxdb-for-time-series-data-timescale-influx-sql-nosql-36489299877/" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">TimescaleDB与InfluxDB:专为时序数据构建</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">深入研究两个领先的时间序列数据库在数据模型、查询语言…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">blog.timescale.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><p id="e615" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，TimescaleDB非常适合那些寻求大幅提升性能而不需要进行大量重构来迁移现有SQL数据库的团队。尽管TimescaleDB仍然相对较新(2017年首次发布)，但基于PostgreSQL构建的决定使其采用数量达到了前5名。有趣的是，我以前的物联网初创公司也使用TimescaleDB作为中间数据存储，来快速提取跨越几个月的聚合指标，并将旧数据移动到长期存储中。由于我们已经在Kubernetes集群上运行PostgreSQL，安装TimescaleDB和迁移我们的工作负载是一项简单的任务。</p><ul class=""><li id="665b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">优点</strong>:兼容PostgreSQL，可随数据基数很好地扩展，提供各种部署模型</li><li id="bea3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">缺点</strong>:固定模式(在接收之前增加了一点复杂性和数据转换工作)</li></ul><h1 id="abc9" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">QuestDB</h1><p id="0ba8" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">对于那些希望利用InfluxDB line协议的灵活性和PostgreSQL的熟悉性的人来说，一个较新的timeseries数据库可以同时满足这两个要求，而不会牺牲性能。QuestDB  (YC S20)是一个用Java和C++编写的开源TSDB，尽管它在不到一年前推出<a class="ae ky" href="https://news.ycombinator.com/item?id=23975807" rel="noopener ugc nofollow" target="_blank"/>，但它现在已经跻身前15名。在底层，<a class="ae ky" href="https://news.ycombinator.com/item?id=23975807" rel="noopener ugc nofollow" target="_blank"> QuestDB利用内存映射文件</a>在数据提交到磁盘之前支持快速读写。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/5620965f8c5e9ff66a19c62a7e8a9da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JgqBhT7-GdV8Sepsc7_q-A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片鸣谢:<a class="ae ky" href="https://questdb.io/blog/2019/12/19/lineprot/" rel="noopener ugc nofollow" target="_blank"> QuestDB </a>，(<a class="ae ky" href="https://github.com/questdb/questdb.io/blob/master/LICENSE.txt" rel="noopener ugc nofollow" target="_blank">阿帕奇</a>)</p></figure><p id="5d46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过用Java和C++从头开始构建数据库，QuestDB团队专注于三件事:</p><ul class=""><li id="2e3f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">性能:</strong>解决接收瓶颈，尤其是高基数数据集。它还支持快速数据检索，方法是始终按顺序存储时间分区的数据(通过在内存中混排)，并且只分析请求的列/分区，而不是整个表。最后，QuestDB应用SIMD指令来并行化操作。</li><li id="457c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">兼容性:</strong> QuestDB支持InfluxDB线路协议、PostgreSQL线路、REST API、CSV上传摄取数据。习惯于其他TSDBs的用户可以轻松地移植到他们现有的应用程序上，而无需进行大量的重写。</li><li id="100d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">通过SQL查询:</strong>尽管支持多种摄取机制，但QuestDB使用SQL作为查询语言，因此不需要学习像Flux这样的特定领域语言。</li></ul><p id="ae69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在性能方面，QuestDB最近发布了一篇博客文章，展示了实现每秒140万行写入速度的基准测试结果<a class="ae ky" href="https://questdb.io/blog/2021/05/10/questdb-release-6-0-tsbs-benchmark/#comparing-ingestion-with-clickhouse-influxdb-and-timescaledb" rel="noopener ugc nofollow" target="_blank"/>。QuestDB团队在AWS上的<code class="fe nk nl nm nn b">m5.8xlarge</code>实例上使用了多达14个作品的<code class="fe nk nl nm nn b">cpu-only</code>用例使用了TSBS基准测试(<em class="ni">注意:140万的数字来自于使用AMD Ryzen5处理器</em>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/7a975f302f1c20fdcd2434995598598a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CGUPrxS6J68Srb5V.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://questdb.io/blog/2021/05/10/questdb-release-6-0-tsbs-benchmark/#comparing-ingestion-with-clickhouse-influxdb-and-timescaledb" rel="noopener ugc nofollow" target="_blank"> QuestDB </a>，(<a class="ae ky" href="https://github.com/questdb/questdb.io/blob/master/LICENSE.txt" rel="noopener ugc nofollow" target="_blank"> Apache </a>)</p></figure><p id="1490" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于具有高基数(&gt; 1000万)的数据集，QuestDB也优于其他TSDBs，在采用英特尔至强处理器的m 5.8 XL大型实例上使用4个线程，峰值接收吞吐量为904千行/秒，在1000万台设备上维持约64万行/秒。当相同的基准在AMD锐龙3970X上运行时，QuestDB显示每秒超过一百万行的摄取吞吐量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/4f33fd97bd286ca1551ad0535cf82bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hzPVTfeqGSFn_8uv.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片鸣谢:<a class="ae ky" href="https://questdb.io/blog/2021/06/16/high-cardinality-time-series-data-performance" rel="noopener ugc nofollow" target="_blank"> QuestDB </a>，(<a class="ae ky" href="https://github.com/questdb/questdb.io/blob/master/LICENSE.txt" rel="noopener ugc nofollow" target="_blank">阿帕奇</a>)</p></figure><p id="47d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，基于数据模型和数据库调优，性能基准可能是主观的，但它仍然为QuestDB描绘了一个引人注目的比较点。看看使用<code class="fe nk nl nm nn b">devops</code>或<code class="fe nk nl nm nn b">iot</code>模式的结果会是多么有趣，因为InfluxDB和TimescaleDB都支持TSBS的开箱即用用例。</p><p id="20e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">QuestDB的另一个有趣的组件是对InfluxDB内联协议和PostgreSQL接收线的支持。对于现有的InfluxDB用户，您可以简单地<a class="ae ky" href="https://questdb.io/docs/third-party-tools/telegraf/#writing-to-questdb-over-tcp" rel="noopener ugc nofollow" target="_blank">配置Telegraf指向QuestDB的地址和端口</a>。同样，对于PostgreSQL用户，使用现有的客户端库或JDBC将数据写入QuestDB。无论采用何种摄取方法，都可以使用标准SQL查询数据，值得注意的例外情况列在<a class="ae ky" href="https://questdb.io/docs/reference/api/postgres/#compatibility" rel="noopener ugc nofollow" target="_blank"> API参考页面</a>上。</p><p id="400b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为该领域的新成员，QuestDB最明显的缺点是缺乏对基础设施功能的支持(如复制、自动备份/恢复)。它已经与一些最流行的工具(如PostgreSQL、Grafana、Kafka、Telegraf、Tableau)集成，但要达到上述其他TSDBs的水平还需要一些时间。</p><p id="b1bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管如此，QuestDB是一个很有前途的项目，可以平衡InfluxDB和TimescaleDB的优点:</p><ul class=""><li id="3098" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">优点</strong>:快速摄取(特别是对于高基数数据集)，支持InfluxDB协议和PostgreSQL连接，通过标准SQL查询</li><li id="d3f5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">缺点</strong>:较小的社区，可用的集成，生产就绪</li></ul><h1 id="3963" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="6e20" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">随着对时间序列数据需求的持续增长，专门处理这些数据的TSDBs将被大量采用，同时也会面临激烈的竞争。除了本文介绍的三个开源TSDBs，还有来自AWS ( <a class="ae ky" href="https://aws.amazon.com/timestream/" rel="noopener ugc nofollow" target="_blank"> AWS Timestream </a>)和Azure(<a class="ae ky" href="https://azure.microsoft.com/en-us/services/time-series-insights/" rel="noopener ugc nofollow" target="_blank">Azure Series Insights</a>)的公共云产品。</p><p id="0d82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与所有数据库一样，选择“完美的”TSDB主要取决于您的业务需求、数据模型和用例。如果您的数据符合具有丰富集成生态系统的标签集模型，那么InfluxDB可以很好地工作。TimescaleDB非常适合现有的PostgreSQL用户。最后，如果性能是主要关注点，QuestDB是一个很有前途的项目，正在快速发展。</p></div></div>    
</body>
</html>