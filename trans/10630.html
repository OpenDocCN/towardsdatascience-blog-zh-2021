<html>
<head>
<title>Combine Your Machine Learning Models With Voting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">把你的机器学习模型和投票结合起来</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/combine-your-machine-learning-models-with-voting-fa1b42790d84?source=collection_archive---------1-----------------------#2021-10-12">https://towardsdatascience.com/combine-your-machine-learning-models-with-voting-fa1b42790d84?source=collection_archive---------1-----------------------#2021-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="73b8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用被低估的集合方法获得更好预测性能的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/74cb95e418269aed5884c4bc0b1a9e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wM9Ujw35xCpDKcHnu-YZnw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由来自<a class="ae kv" href="https://www.pexels.com/photo/man-people-desk-abstract-8850706/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kv" href="https://www.pexels.com/@tara-winstead?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Tara Winstead </a>拍摄</p></figure><p id="d634" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你冒险踏上机器学习之旅时，你无疑会遇到各种各样的机器学习算法。</p><p id="66d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从像K-最近邻这样的懒惰学习分类器到像决策树这样的急切学习分类器，在构建模型时有许多不同的算法可供选择。</p><p id="c520" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你有没有想过让这些模型协同工作会是什么样子？幸运的是，这可以通过一种叫做<strong class="ky ir">投票</strong>的技术轻松实现。</p><p id="8178" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">投票是一种集合方法，它将多个模型的性能结合起来进行预测。</p><p id="d71d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可能会想:首先把模型的预测结合起来有什么意义呢？当您可以单独评估分类器并选择最佳分类器时，为什么要将所有分类器合并为一个呢？</p><h1 id="181e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">投票的好处</h1><p id="b1f6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">合并投票有很多好处。</p><p id="f5f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，由于投票依赖于许多模型的性能，它们不会被来自一个模型的大误差或错误分类所阻碍。一款车型的不佳表现可以被其他车型的强劲表现所抵消。</p><p id="661e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了更好地理解这个概念，我们用投资来打个比方。</p><p id="6ddc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你投资时，人们经常建议你将财富分配到各种股票上。如果你把所有的钱都放在一只股票上，你的整个投资组合都依赖于这只股票的表现，这让你面临很高的风险。另一方面，如果你把钱投资于各种股票，风险就会降低；一只表现不佳的股票不会阻碍你的成功。</p><p id="4931" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">投票以类似的方式进行。通过组合模型来进行预测，您可以利用其他可以做出正确预测的模型来降低一个模型做出不准确预测的风险。这种方法使得估计器更加稳健，并且易于过拟合。</p><p id="0bea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在分类问题中，投票有两种:<strong class="ky ir">硬投票</strong>和<strong class="ky ir">软投票</strong>。</p><p id="8fe6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">硬投票需要挑选具有最高票数的预测，而软投票需要组合每个模型中每个预测的概率，并挑选具有最高总概率的预测。</p><p id="82e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回归问题中的投票有些不同。通过投票构建的回归模型不是查找出现频率最高的预测，而是获取每个模型的预测，并计算它们的平均值以得出最终预测。</p><p id="2f07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在分类或回归问题中，投票是提高预测性能的一种手段。</p><h1 id="9e20" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">投票的缺点</h1><p id="1291" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当你了解到组合模型的好处时，你可能会在你未来的所有机器学习项目中使用投票。</p><p id="dc2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">毕竟，当您可以将它们全部集成到一个评估器中并创建“完美的模型”时，为什么要经历考虑每个模型的优缺点的麻烦呢？</p><p id="c53a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，这种思路是有缺陷的。</p><p id="e401" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要明白，用投票建立的模型不应该被视为机器学习中一刀切的方法。毕竟，投票集成方法也有其局限性。</p><p id="afc8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，在某些情况下，单个模型可以胜过一组模型。例如，在回归问题中，如果预测特征和目标变量具有很强的线性关系，单个线性回归模型无疑可以表现得很好。但是，用其他回归模型做出的投票估计会使线性回归模型的准确预测无效。</p><p id="f40b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其次，由于投票需要使用多种模型，因此它们的计算量自然更大。因此，创建、培训和部署这样的模型将更加昂贵。</p><p id="8fb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，只有当机器学习分类器在相似的水平上执行时，投票才是有益的。从具有相反效率水平的模型构建的投票估计器可能不稳定地运行。</p><h1 id="4784" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Python中的应用</h1><p id="e7ca" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Python中的sklearn包使得实现投票集成方法变得非常容易。它提供了投票分类器和投票回归器，这两个估计器分别用于构建分类模型和回归模型。</p><p id="7a31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用以下代码导入它们:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者创建</p></figure><p id="eaa8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们利用sklearn库来看看投票集合方法的效果。</p><h1 id="5166" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">个案研究</h1><p id="5571" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">有了医院患者的数据集(此处可访问<a class="ae kv" href="https://www.kaggle.com/fedesoriano/heart-failure-prediction" rel="noopener ugc nofollow" target="_blank"/>)，让我们创建单独的机器学习分类器和投票分类器，以确定哪种方法最好地预测心脏病。</p><p id="764e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是数据集要素的预览:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者创建</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/75bc23419586953222a38b2b44a4baa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*f2X0I4kBWiPhhrmQ9s_GGA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="2f41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本案例研究的目标变量是“心脏病”。</p><p id="9fd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们在建模之前准备数据集。预处理阶段需要:</p><ul class=""><li id="59bd" class="ms mt iq ky b kz la lc ld lf mu lj mv ln mw lr mx my mz na bi translated">删除丢失的值(如果有)</li><li id="5ba7" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">编码分类特征</li><li id="e6e9" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">将数据分成训练集和测试集</li><li id="0f52" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">标准化输入要素</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="4509" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们用训练集训练决策树模型、逻辑回归模型和朴素贝叶斯模型，然后用测试集评估它们。这些模型的性能将根据它们的f-1分数来衡量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/2523b3c97b48b84a78acb19698012843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*YISj1ZMKkpIds7Z0smJ9Yw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="6e18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如输出所示，支持向量机是表现最好的模型，f-1得分为0.8897。</p><p id="64fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意3个分类器的f-1分数是多么相似。这是投票估计器将适用于预测心脏病的指标。</p><p id="568f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们创建一个分类器，将决策树分类器、逻辑回归模型以及朴素贝叶斯模型合并为一个分类器。通过给分类器中的“投票”参数赋值，可以在硬投票和软投票之间进行选择。为了便于演示，我们将使用这两种投票技术。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/4136b05e8c3fdcedb2180d9073c5c6e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*HsQ0aZvM8p9tsiAAmt3A_g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="8418" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由硬投票和软投票构成的投票分类器的性能都优于支持向量机。</p><h1 id="9a66" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/23ae83587790241b8d160421a89a9cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iEGV0LbyKJ-xY4rBoSIi-A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由来自<a class="ae kv" href="https://www.pexels.com/photo/black-and-white-laptop-2740956/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kv" href="https://www.pexels.com/@prateekkatyal?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>拍摄</p></figure><p id="14b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，你了解了投票的来龙去脉，以及它在机器学习中的应用。</p><p id="b9fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结合机器学习模型可以显著提高预测建模的质量。</p><p id="4264" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，即使这种集合方法在构建模型时可以作为一种很好的选择，您也不应该将其视为一种可行的方法，因为它的成本更高，而且并不总是胜过单个模型。</p><p id="b5f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我祝你在机器学习的努力中好运！</p></div></div>    
</body>
</html>