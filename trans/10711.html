<html>
<head>
<title>Causal Inference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">因果推理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/causal-inference-962ae97cefda?source=collection_archive---------0-----------------------#2021-10-15">https://towardsdatascience.com/causal-inference-962ae97cefda?source=collection_archive---------0-----------------------#2021-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="729c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python回答因果问题</h2></div><p id="5917" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是关于因果关系的三篇系列文章的第二篇。在<a class="ae le" rel="noopener" target="_blank" href="/causality-an-introduction-f8a3f6ac4c4a">的上一篇文章</a>中，我介绍了这种“新的因果科学”【1】，并给出了因果推理和<a class="ae le" href="https://shawhin.medium.com/causal-discovery-6858f9af6dcb" rel="noopener">因果发现</a>的味道。在本帖中，我们将深入探讨因果推理的一些细节，并以Python中的一个具体例子结束。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/1611002644bc74e941bde66aeac7df0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7qYeeKBkiW9IPLqwIqW_1A.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">因果网络的一个例子。图片作者。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f3b4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从哪里开始？</h1><p id="750b" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在<a class="ae le" rel="noopener" target="_blank" href="/causality-an-introduction-f8a3f6ac4c4a">的上一篇文章</a>、<strong class="kk iu">、<em class="mz">、</em>、</strong>中，我讨论了因果关系如何通过<strong class="kk iu">结构因果模型(SCMs) </strong>用数学方法表示。SCMs由两部分组成:一个图形，它将因果联系可视化，以及方程，它表达了联系的细节。</p><p id="b335" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">概括一下，<strong class="kk iu">图</strong>是由顶点(节点)和边(链接)组成的<strong class="kk iu">数学结构。在这里，我将交替使用图和网络这两个术语。SCMs使用了一种特殊图，称为<strong class="kk iu">有向无环图(DAG) </strong>，它的所有边都是有向的，不存在环。Dag是因果推理的常见起点。</strong></p><h2 id="4fac" class="na md it bd me nb nc dn mi nd ne dp mm kr nf ng mo kv nh ni mq kz nj nk ms nl bi translated">贝叶斯网络与因果网络</h2><p id="35e4" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">当我第一次探索这个主题时，一个模糊之处是<strong class="kk iu">贝叶斯网络</strong>和<strong class="kk iu">因果网络</strong>之间的区别。所以我简单提一下区别。开明的读者可以随意跳过这一节。</p><p id="a0f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从表面上看，贝叶斯和因果网络是完全相同的。然而，不同之处在于他们的解释。考虑下图中的例子。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/fca69894f3133d05400b192f0034225b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hRMcdr6hcCjDq_cjEugBXA.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">可以解释为贝叶斯和因果网络的例子。火和烟的例子取自珀尔[1]。图片作者。</p></figure><p id="9573" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们有一个有2个节点(火图标和烟图标)和1条边(从火指向烟的箭头)的网络。这个网络可以是贝叶斯网络，也可以是因果网络。</p><p id="968c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，关键的区别在于解释这个网络的时候。对于一个<strong class="kk iu">贝叶斯</strong>网络，我们将<strong class="kk iu">节点视为变量</strong>，将<strong class="kk iu">箭头视为条件概率</strong>，即给定火灾信息时烟雾出现的概率。当将此解释为一个<strong class="kk iu">因果</strong>网络时，我们仍然将<strong class="kk iu">节点视为变量</strong>，然而<strong class="kk iu">箭头表示一个因果连接</strong>。在这种情况下，两种解释都有效。然而，如果我们翻转边缘方向，因果网络解释将是无效的，因为烟雾不会引起火灾。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/69b0f511f5a6aa5ee96ce56864f10de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*IVviIpqvMSyr4MXR8wSu5Q.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">示例网络可以解释为贝叶斯网络，但不是因果网络。火和烟的例子取自珀尔[1]。图片作者。</p></figure><h1 id="d57c" class="mc md it bd me mf no mh mi mj np ml mm jz nq ka mo kc nr kd mq kf ns kg ms mt bi translated">什么是因果推理？</h1><p id="977e" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated"><strong class="kk iu">因果推断</strong> <strong class="kk iu">旨在回答因果问题</strong>而不仅仅是统计问题。因果推理的应用数不胜数。回答下面的任何问题都属于因果推理的范畴。</p><ul class=""><li id="f9ff" class="nt nu it kk b kl km ko kp kr nv kv nw kz nx ld ny nz oa ob bi translated">治疗对服用者有直接帮助吗？</li><li id="78be" class="nt nu it kk b kl oc ko od kr oe kv of kz og ld ny nz oa ob bi translated">是营销活动导致了这个月的销售增长还是假期？</li><li id="e522" class="nt nu it kk b kl oc ko od kr oe kv of kz og ld ny nz oa ob bi translated">增加工资会对生产率产生多大影响？</li></ul><p id="da61" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些都是重要而实际的问题，使用更传统的方法(例如线性回归或标准机器学习)可能不容易回答。我希望通过我称之为<em class="mz">因果推理的3个天赋</em>来说明因果推理是如何帮助回答这些问题的。</p><h1 id="73a3" class="mc md it bd me mf no mh mi mj np ml mm jz nq ka mo kc nr kd mq kf ns kg ms mt bi translated">因果推理的三种天赋</h1><h2 id="a9d4" class="na md it bd me nb nc dn mi nd ne dp mm kr nf ng mo kv nh ni mq kz nj nk ms nl bi translated">礼物1:do-operator</h2><p id="7f7e" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在<a class="ae le" rel="noopener" target="_blank" href="/causality-an-introduction-f8a3f6ac4c4a">的上一篇文章</a>中，我从干预的角度定义了因果关系。忽略一些技术细节，据说如果对X的干预导致Y的变化，则X导致Y，而对Y的干预不一定导致X的变化。干预在现实世界中很容易理解(就像当你朋友的糖果习惯失控时)，然而，<em class="mz">这如何符合因果关系的数学表示？</em></p><p id="9e4a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输入do运算符。<strong class="kk iu"> do-operator </strong>是物理干预的<strong class="kk iu">数学表示。如果我们从模型Z → X → Y开始，我们可以通过删除所有传入X的箭头，并手动将X设置为某个值x_0来模拟X中的干预。</strong></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oh"><img src="../Images/53713bbcbf5e31644cf6ab26bc47c735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qc6clFGIUTN_50c6Q7NT5A.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">do运算符如何工作的图示。图片作者。</p></figure><p id="16c3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设我们知道因果联系的细节，do运算符的强大之处在于它允许我们模拟实验。例如，假设我们想问,<em class="mz">增加营销预算会促进销售吗？</em>如果我们有一个包括营销支出和销售的因果模型，我们可以模拟如果我们增加营销支出会发生什么<em class="mz">，并评估销售的变化(如果有的话)是否值得。换句话说，我们可以评估营销对销售的<strong class="kk iu">因果效应</strong>。稍后再谈因果关系。</em></p><p id="9910" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">珀尔和他的同事们的一个主要贡献是<strong class="kk iu"> do-calculus </strong>的规则。这是一个<strong class="kk iu"> <em class="mz">完整的</em>规则集，概述了如何使用do运算符</strong>。</p><p id="cbef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">值得注意的是，do-calculus可以将<strong class="kk iu">介入分布</strong>(即有do算子的概率)转化为<strong class="kk iu">观察分布</strong>(即没有do算子的概率)。这可以从下图中的规则2和规则3看出。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oi"><img src="../Images/7472478ede8c3d4b93c35bdecaf88788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DknxE_AGsE_BQ58i1MXKmw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">微积分的规则。规则摘自珀尔[ <a class="ae le" href="https://arxiv.org/abs/1210.4852" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]的讲座。图片作者。</p></figure><p id="5893" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意符号。<strong class="kk iu"> P(Y|X) </strong>就是我们都很熟悉的条件概率，也就是给定X的一个观测值Y的<strong class="kk iu">概率。而，<strong class="kk iu"> P(Y|do(X)) </strong>是在X </strong>中给定一个<em class="mz">干预</em>Y的<strong class="kk iu">概率。</strong></p><p id="a467" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">do运算符是因果推理工具箱中的一个关键工具。事实上，接下来的两个礼物依赖于do-operator。</p><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/causal-effects-via-the-do-operator-5415aefc834a"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">通过Do运算符的因果关系</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">将观察转化为干预</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa lp om"/></div></div></a></div><h2 id="00f3" class="na md it bd me nb nc dn mi nd ne dp mm kr nf ng mo kv nh ni mq kz nj nk ms nl bi translated">礼物2:消除混淆</h2><p id="c79f" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">混淆是统计学中的一个概念。虽然我没有直呼其名，但这是通过<strong class="kk iu">辛普森悖论</strong>出现在<a class="ae le" rel="noopener" target="_blank" href="/causality-an-introduction-f8a3f6ac4c4a">上一篇</a>中的。下图显示了一个简单的混杂示例。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/f9d8bea2a2f989100aed885c341d0ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*hWGX7tfJZLc0btxXTMZOcw.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">一个简单的混淆例子。年龄是教育和财富的混淆物。图片作者。</p></figure><p id="1ce2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个例子中，年龄是教育和财富的混淆因素。换句话说，如果试图评估教育对财富的影响，你需要根据年龄调整。<strong class="kk iu">调整</strong> <strong class="kk iu">用于</strong>(或调节开启)<strong class="kk iu">年龄</strong>仅仅意味着当查看年龄、教育和财富数据时，人们会比较年龄组内的<strong class="kk iu">、<strong class="kk iu">而不是</strong>年龄组之间的数据点。</strong></p><p id="d528" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果不考虑年龄因素，就不清楚教育是财富的真正<em class="mz">原因</em>还是仅仅是财富的<em class="mz">关联</em>。换句话说，你不知道教育是否直接影响财富，或者只是与财富有一个共同的原因。</p><p id="1ff4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">举个简单的例子，在查看DAG时，混淆非常简单。对于3个变量，混杂因素是指向2个其他变量的变量。<em class="mz">但是更复杂的问题呢？</em></p><p id="51da" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是do操作符提供清晰度的地方。Pearl使用do运算符以明确的方式定义混杂。他说<strong class="kk iu">混淆</strong>是<strong class="kk iu">导致P(Y|X)不同于P(Y|do(X)) </strong> [1]的任何东西。</p><h2 id="fc79" class="na md it bd me nb nc dn mi nd ne dp mm kr nf ng mo kv nh ni mq kz nj nk ms nl bi translated">礼物3:估计因果效应</h2><p id="8378" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">这最后的礼物是因果推论的主要吸引力。在生活中，我们不仅要问自己<em class="mz">为什么</em>，还要问<em class="mz">多少？</em>估计<a class="ae le" rel="noopener" target="_blank" href="/causal-effects-f30f962ffff3">因果关系</a>归结为回答第二个问题。</p><p id="4040" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">考虑读研。知道拥有研究生学位的人比没有研究生学位的人赚更多的钱是一回事，但一个自然的问题是，其中有多少是因为他们的学位？换句话说，<em class="mz">研究生学历对收入的待遇影响如何？</em></p><p id="e40d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将利用回答这个问题的机会来完成一个使用Python进行因果推理的具体例子。</p><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/causal-effects-f30f962ffff3"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">因果关系——简介</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">什么是治疗效果，如何计算？</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pc l ox oy oz ov pa lp om"/></div></div></a></div><h1 id="a304" class="mc md it bd me mf no mh mi mj np ml mm jz nq ka mo kc nr kd mq kf ns kg ms mt bi translated">示例:估计研究生院对收入的处理效果</h1><p id="a8e5" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在这个例子中，我们将使用<a class="ae le" href="https://microsoft.github.io/dowhy/" rel="noopener ugc nofollow" target="_blank">微软DoWhy </a>库进行因果推理[ <a class="ae le" href="https://arxiv.org/abs/2011.04216" rel="noopener ugc nofollow" target="_blank"> 3 </a> ]。这里的目标是估计拥有研究生学位对年收入超过5万美元的因果影响。数据从UCI机器学习库[ <a class="ae le" href="https://archive.ics.uci.edu/ml/datasets/census+income" rel="noopener ugc nofollow" target="_blank"> 4 </a> ]获得。示例代码和数据可在<a class="ae le" href="https://github.com/ShawhinT/YouTube-Blog/tree/main/causal_inference" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到。</p><p id="b4c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">重要的是要强调所有因果推理的起点是一个因果模型。这里我们假设收入只有两个原因:年龄和教育，而年龄也是教育的一个原因。显然，这个简单的模型可能遗漏了其他重要因素。我们将在下一篇关于<a class="ae le" href="https://shawhin.medium.com/causal-discovery-6858f9af6dcb" rel="noopener"> <strong class="kk iu">因果发现</strong> </a>的文章中研究替代模型。然而，现在我们将关注这个简化的案例。</p><p id="3cd8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们加载库和数据。如果您没有这些库，请查看回购中的<a class="ae le" href="https://github.com/ShawhinT/YouTube-Blog/blob/main/causal_inference/requirements.txt" rel="noopener ugc nofollow" target="_blank"> requirements.txt </a>。</p><pre class="lg lh li lj gt pd pe pf pg aw ph bi"><span id="0f35" class="na md it pe b gy pi pj l pk pl"><strong class="pe iu"># Import libraries</strong><br/>import pickle<br/>import matplotlib.pyplot as plt<br/><br/>import econml<br/>import dowhy<br/>from dowhy import CausalModel</span><span id="f239" class="na md it pe b gy pm pj l pk pl"><strong class="pe iu"># Load Data</strong><br/>df = pickle.load( open( "df_causal_inference.p", "rb" ) )</span></pre><p id="3a8c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，第一步是定义我们的因果模型，即DAG。DoWhy使创建和查看模型变得容易。</p><pre class="lg lh li lj gt pd pe pf pg aw ph bi"><span id="e389" class="na md it pe b gy pi pj l pk pl"><strong class="pe iu"># Define causal model</strong><br/>model=CausalModel(data = df,         <br/>                  treatment= "hasGraduateDegree",         <br/>                  outcome= "greaterThan50k",         <br/>                  common_causes="age",         <br/>                  )</span><span id="2c1e" class="na md it pe b gy pm pj l pk pl"><strong class="pe iu"><em class="mz"># View model</em></strong><br/>model.view_model() <br/>from IPython.display import Image, display display(Image(filename="causal_model.png"))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/42016e604d2183609338ed9786ba6cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*r_G7FvM4vPeP4_7XXLvVIQ.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">我们(假设的)因果模型。图片作者。</p></figure><p id="71df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们需要一个estimand。这基本上是一个给我们想要的因果效应的配方。换句话说，它告诉我们如何计算教育对收入的影响。</p><pre class="lg lh li lj gt pd pe pf pg aw ph bi"><span id="aeb4" class="na md it pe b gy pi pj l pk pl"><strong class="pe iu"># Generate estimand</strong><br/>identified_estimand= model.identify_effect(proceed_when_unidentifiable=<strong class="pe iu">True</strong>)<br/>print(identified_estimand)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi po"><img src="../Images/5b1ab427efd17a2c08dce688e1048f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VnjfgLegLy7QT9ajHYf4wQ.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">estimand生成的输出。图片作者。</p></figure><p id="9373" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们基于估计量计算因果效应。在这里，我们使用来自<a class="ae le" href="https://econml.azurewebsites.net/" rel="noopener ugc nofollow" target="_blank"> EconML </a>库的<a class="ae le" href="https://econml.azurewebsites.net/spec/estimation/metalearners.html" rel="noopener ugc nofollow" target="_blank">元学习器</a>【5】，它估计离散目标的条件平均治疗效果。</p><pre class="lg lh li lj gt pd pe pf pg aw ph bi"><span id="8a42" class="na md it pe b gy pi pj l pk pl"><strong class="pe iu"># Compute causal effect using metalearner</strong><br/>identified_estimand_experiment = model.identify_effect(proceed_when_unidentifiable=True)<br/><br/>from sklearn.ensemble import RandomForestRegressor<br/>metalearner_estimate = model.estimate_effect(identified_estimand_experiment,                             method_name="backdoor.econml.metalearners.TLearner",<br/>confidence_intervals=False,<br/>method_params={<br/>     "init_params":{'models': RandomForestRegressor()},<br/>     "fit_params":{}<br/>              })</span><span id="b092" class="na md it pe b gy pm pj l pk pl">print(metalearner_estimate)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pp"><img src="../Images/0b20c3207325c0d8a85b9ebfbce5288f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A6NbIy21Wm11aLwHz9CKaA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">因果估计的输出。图片作者。</p></figure><p id="19ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">平均因果效应约为0.20。这可以解释为，拥有研究生学位会让你年收入超过5万美元的概率增加20%。注意这是平均效应，考虑值的全部分布以评估平均值是否具有代表性是很重要的。</p><pre class="lg lh li lj gt pd pe pf pg aw ph bi"><span id="b888" class="na md it pe b gy pi pj l pk pl"><strong class="pe iu"># Print histogram of causal effects</strong><br/>plt.hist(metalearner_estimate.cate_estimates)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pq"><img src="../Images/b8ed9a91bfb1a825f551a679dfea2414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Cu4Jf_dCAuCHe0otv443Q.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">因果关系的分布。图片作者。</p></figure><p id="d795" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上图中，我们看到了样本间因果关系的分布。显然，该分布是<em class="mz">而不是</em>高斯分布。这告诉我们平均值并不代表总体分布。基于因果效应的进一步分析可能有助于发现“谁”从研究生学位中受益最多的可操作信息。</p><p id="e0a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不管怎样，仅仅根据潜在收入来决定读研，可能表明你并不真的想读研。🤷🏽‍♀️</p><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/causal-effects-via-regression-28cb58a2fffc"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">通过回归的因果效应</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">Python示例代码的3种流行技术</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pr l ox oy oz ov pa lp om"/></div></div></a></div><h1 id="c447" class="mc md it bd me mf no mh mi mj np ml mm jz nq ka mo kc nr kd mq kf ns kg ms mt bi translated">结论</h1><p id="1c01" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">因果推理是回答更传统的方法可能无法解决的自然问题的强大工具。在这里，我从因果推理中勾勒出一些大的想法，并通过代码完成了一个具体的例子。如前所述，所有因果推理的起点是一个因果模型。然而，通常我们手头没有一个好的因果模型。这就是<a class="ae le" href="https://shawhin.medium.com/causal-discovery-6858f9af6dcb" rel="noopener"> <strong class="kk iu">因果发现</strong> </a> <strong class="kk iu"> </strong>可以有所帮助的地方，这也是下一篇帖子的主题。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ps pt l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c2bc" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><p id="74a4" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated"><strong class="kk iu">更多关于因果关系</strong> : <a class="ae le" href="https://shawhin.medium.com/understanding-causal-effects-37a054b2ec3b" rel="noopener">因果关系概述</a> | <a class="ae le" rel="noopener" target="_blank" href="/causality-an-introduction-f8a3f6ac4c4a">因果关系:简介</a> | <a class="ae le" rel="noopener" target="_blank" href="/causal-inference-962ae97cefda">因果推断</a> | <a class="ae le" rel="noopener" target="_blank" href="/causal-discovery-6858f9af6dcb">因果发现</a></p><p id="d84f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">连接</strong> : <a class="ae le" href="https://shawhint.github.io/" rel="noopener ugc nofollow" target="_blank">我的网站</a> | <a class="ae le" href="https://calendly.com/shawhintalebi" rel="noopener ugc nofollow" target="_blank">预定电话</a> | <a class="ae le" href="https://shawhint.github.io/connect.html" rel="noopener ugc nofollow" target="_blank">邮件我</a></p><p id="1e0b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">社交</strong>:<a class="ae le" href="https://www.youtube.com/channel/UCa9gErQ9AE5jT2DZLjXBIdA" rel="noopener ugc nofollow" target="_blank">YouTube</a>|<a class="ae le" href="https://www.linkedin.com/in/shawhintalebi/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae le" href="https://twitter.com/ShawhinT" rel="noopener ugc nofollow" target="_blank">Twitter</a></p><p id="e857" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">支持</strong> : <a class="ae le" href="https://www.buymeacoffee.com/shawhint?source=about_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">给我买杯咖啡</a> ☕️ | <a class="ae le" href="https://shawhin.medium.com/membership?source=about_page-------------------------------------" rel="noopener">成为会员</a> ⭐️</p><div class="oj ok gp gr ol om"><a href="https://shawhin.medium.com/membership" rel="noopener follow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">通过我的推荐链接加入媒体——肖文·塔莱比</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">⭐️成为会员使用我的推荐链接，并获得充分的媒体上的每一篇文章。您的会员费直接…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">shawhin.medium.com</p></div></div><div class="ov l"><div class="pu l ox oy oz ov pa lp om"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="2096" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">朱迪亚·珀尔所著的《为什么:因果的新科学》</p><p id="6dec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[2]珀尔，J. (2012年)。重新审视微积分。<a class="ae le" href="https://arxiv.org/abs/1210.4852" rel="noopener ugc nofollow" target="_blank">arXiv:1210.4852</a><strong class="kk iu">【cs。AI] </strong></p><p id="b9c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[3]阿米特·夏尔马，埃姆雷·基西曼。DoWhy:一个用于因果推理的端到端库。2020.<a class="ae le" href="https://arxiv.org/abs/2011.04216" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/2011.04216</a></p><p id="e19b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[4]杜瓦和格拉夫(2019年)。UCI机器学习知识库[http://archive . ics . UCI . edu/ml]。加州欧文:加州大学信息与计算机科学学院。https://archive.ics.uci.edu/ml/datasets/census+income<a class="ae le" href="https://archive.ics.uci.edu/ml/datasets/census+income" rel="noopener ugc nofollow" target="_blank"/></p><p id="130a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[5] Künzel，ren R .等人，“使用机器学习评估异质治疗效果的金属学者”<em class="mz">美国国家科学院院刊</em>，第116卷第10期，2019年3月，第4156–65页。<a class="ae le" href="http://www.pnas.org," rel="noopener ugc nofollow" target="_blank"><em class="mz">www.pnas.org</em>，</a><a class="ae le" href="https://doi.org/10.1073/pnas.1804597116." rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1073/pnas.1804597116.</a></p></div></div>    
</body>
</html>