<html>
<head>
<title>What’s a pushforward distribution?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是前推分发？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/whats-a-pushforward-distribution-17758c1fd542?source=collection_archive---------18-----------------------#2021-11-06">https://towardsdatascience.com/whats-a-pushforward-distribution-17758c1fd542?source=collection_archive---------18-----------------------#2021-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b36b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">学习如何通过计算和分析来评估它，利用<a class="ae kf" href="https://jax.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> JAX </a>的力量！</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/480954ba2220802473ec8d1645eaf13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*As_pBJ6ItYHJ-8Qt"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@zervez?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> David Sjunnesson </a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="8698" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="0cca" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">假设你有一个随机变量<strong class="lq ir"> <em class="mk"> X </em> </strong>，你把它经过一些变换<em class="mk"> g </em>。由此产生的随机变量<em class="mk">g(</em><strong class="lq ir"><em class="mk">X</em></strong><em class="mk">)</em>的分布称为“前推分布”。今天我们将学习如何计算它的概率密度。</p><h1 id="df05" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">例子</h1><p id="234c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">与其抽象地谈论，不如让我们从一个实际的例子开始。让我们考虑一个 2D 随机变量<strong class="lq ir"> <em class="mk"> X </em> </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/eeb308bc5fdc496fac4cf631f0c51dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/0*DhXOe-HRBva-NokJ"/></div></figure><p id="eb59" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">和变换<em class="mk"> g </em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/be25950c99d958e8675863e7e1654d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/0*u0m8SbkWdJ8vDN7N"/></div></figure><p id="3367" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">我们会用到它。<strong class="lq ir"> <em class="mk"> X </em> </strong>将由 g 得到转化为<em class="mk">g(</em><strong class="lq ir"><em class="mk">X</em></strong><em class="mk">)</em>，我们要一个<em class="mk">g(</em><strong class="lq ir"><em class="mk">X</em></strong><em class="mk">)</em>的概率分布公式。</p><h1 id="cc59" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">预赛</h1><p id="5669" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们导入我们需要的东西，定义我们的发行版，并定义我们的转换。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="2805" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">太好了。要计算<em class="mk">g(</em><strong class="lq ir"><em class="mk">X</em></strong>)，我们只需要:</p><ol class=""><li id="9689" class="mu mv iq lq b lr mm lu mn lx mw mb mx mf my mj mz na nb nc bi translated">从<code class="fe nd ne nf ng b">distribution</code>提取样本</li><li id="2768" class="mu mv iq lq b lr nh lu ni lx nj mb nk mf nl mj mz na nb nc bi translated">将<code class="fe nd ne nf ng b">g</code>应用于<code class="fe nd ne nf ng b">samples</code>的每个元素</li></ol><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="17d1" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">(如果你不熟悉<code class="fe nd ne nf ng b">jax.vmap</code> -参见<a class="ae kf" href="https://jax.readthedocs.io/en/latest/jax.html#jax.vmap" rel="noopener ugc nofollow" target="_blank"> jax 矢量化</a> -别担心，这只是矢量化计算的一个技巧)</p><p id="1e01" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">我们接下来可以看看<strong class="lq ir"> <em class="mk"> X </em> </strong> <em class="mk"> </em>的概率密度在<em class="mk"> g </em>下是如何变化的:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/040967ead94da167669c1b98871232b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*h-Lrp2zcXrh7l9PjSmNk_g.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">概率密度在变换下是如何变化的</p></figure><p id="6fdc" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">这是我们的向前推进的分布！现在让我们看看如何分析计算它。</p><h1 id="4504" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">让我们分析一下(不用数学)</h1><p id="08c5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在网上搜索(例如<a class="ae kf" href="https://betanalpha.github.io/assets/case_studies/probability_theory.html" rel="noopener ugc nofollow" target="_blank">这里</a>，我们可以找到一个可爱的前推概率密度的小公式:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/abd727ff6d6d7469ffd439783abd65c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/0*jA9WiW5dSclWAcpU"/></div></figure><p id="a19e" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">最后一项涉及一个<a class="ae kf" href="https://en.wikipedia.org/wiki/Determinant" rel="noopener ugc nofollow" target="_blank">行列式</a>和一个<a class="ae kf" href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant" rel="noopener ugc nofollow" target="_blank">雅可比行列式</a>，我不相信自己能正确计算它们(尤其是对于任何可以生产的东西)。</p><p id="9dd1" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">然而，幸运的是，我不需要自己计算它们——我的计算机可以替我做！有了<a class="ae kf" href="https://jax.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> JAX </a>，求<code class="fe nd ne nf ng b">transformation</code>和<code class="fe nd ne nf ng b">point</code>的雅可比就和<code class="fe nd ne nf ng b">jax.jacobian(transformation)(point)</code>一样简单！看看这个:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="916e" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">一旦我们找到了<code class="fe nd ne nf ng b">pushforward_density</code>，我们就可以把它和它的计算副本一起绘制出来:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/12beeebec07bae2d5a344191365f2cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*sACkjGE2cXGAxCaw4zZ4Nw.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">g(X)的密度图，通过计算和分析得出(并排)</p></figure><p id="fc69" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx mo lz ma mb mp md me mf mq mh mi mj ij bi translated">嘿，他们匹配！</p><h1 id="a75e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="3e2f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果我们通过一个变换推动一个概率分布，我们最终得到一个向前推动的分布。在这里，我们学习了如何通过计算和分析来计算它的概率密度。这两种方法都不需要我们手工做任何数学运算，多亏了令人敬畏的 JAX 图书馆。</p><h1 id="228a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">参考</h1><p id="444f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">关于前推分布的更多内容，我建议阅读贝坦科特的优秀<a class="ae kf" href="https://betanalpha.github.io/assets/case_studies/probability_theory.html" rel="noopener ugc nofollow" target="_blank">概率论或</a> y 案例研究。</p></div></div>    
</body>
</html>