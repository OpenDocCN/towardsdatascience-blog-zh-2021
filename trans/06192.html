<html>
<head>
<title>How to Use Unsupervised Clustering on Well Log Data with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python对测井数据进行无监督聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-unsupervised-learning-to-cluster-well-log-data-using-python-a552713748b5?source=collection_archive---------6-----------------------#2021-06-03">https://towardsdatascience.com/how-to-use-unsupervised-learning-to-cluster-well-log-data-using-python-a552713748b5?source=collection_archive---------6-----------------------#2021-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2f26" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python细分地下</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/caa3de8e54ad8064de4f7ab622353904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8kblAlNAsE3cbS8hfl7UA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对测井数据进行无监督聚类分析，以识别岩相(图片由作者提供)</p></figure><p id="97dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">了解地下岩性是地球科学和岩石物理学中的一项重要任务。使用由测井技术产生的各种电测量，我们能够推断出下面的地质情况，例如岩性、岩相、孔隙度和渗透率。</p><p id="2d92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">机器学习算法通常被用来将测井记录测量值分成不同的岩性组，称为岩相。这个过程可以使用无监督学习或监督学习算法来实现。</p><p id="8282" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">监督学习</strong>是最常见和最实用的机器学习任务，它旨在使用已映射到“正确”输出的输入数据从示例中学习。或者，我们可以使用<strong class="la iu">无监督学习</strong>运行建模，让算法识别数据中的潜在模式，这些模式在数据探索过程中可能不容易看到。</p><p id="761d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本教程中，我们将使用两种聚类方法(K均值聚类和高斯混合建模)进行无监督学习分类，并将结果与已建立的岩相曲线进行比较。</p><h2 id="7f4f" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">什么是聚类/聚类分析？</h2><p id="71bd" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">数据聚类是探索性数据分析(EDA)的一种常见形式，用于根据共享的特征或属性将数据分成不同的组。彼此相似的数据点被分组在同一个群集中，而不同的数据点被放在另一个群集中。</p><h2 id="7d25" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">k均值聚类</h2><p id="2794" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">K-Means聚类是一种非常常用的无监督机器学习算法。它用于通过最小化数据点和质心之间的距离来将数据分组为K个簇。</p><p id="4bf4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">质心在数据空间中的k个随机点处被初始化，并且基于到质心的距离，其周围的所有点被分配给相关的聚类。然后将质心调整到群集的中心点，并重新分配其周围的点。这种情况一直持续到质心没有变化或者这些点保持在同一个簇中，或者直到达到最大迭代次数。</p><p id="e500" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">K-Means是一种硬聚类方法，其中数据点要么属于某个聚类，要么不属于某个聚类。它还通过对数据应用圆(或多维数据集中的超球)来执行聚类。</p><h2 id="f23a" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">高斯混合模型</h2><p id="d90f" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">GMM方法也允许对数据点进行聚类，只是它考虑了数据差异，导致了更软的分类，并且它不是基于距离而是基于分布。</p><p id="1e7b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，被分类的数据点有可能是一个或另一个聚类。</p><p id="6cb0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然K-Means聚类在数据聚类是圆形的情况下效果很好，但是，在岩石物理和地质情况下，数据很少形成良好的圆形模式。GMM模型使用椭圆形的聚类/决策边界，因此更加灵活。</p><p id="df65" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一篇关于这两种方法之间差异的优秀文章可以在<a class="ae ms" href="https://www.analyticsvidhya.com/blog/2019/10/gaussian-mixture-models-clustering/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2019/10/Gaussian-mixture-models-clustering/</a>找到</p><h2 id="9e89" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">资料组</h2><p id="3cf7" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我们在本教程中使用的数据集构成了由<a class="ae ms" href="https://doi.org/10.5281/zenodo.4351155" rel="noopener ugc nofollow" target="_blank"> Xeek和FORCE 2020 </a>举办的机器学习竞赛的一部分。竞赛的目的是从现有的标记数据中预测岩性。该数据集由挪威海的118口井组成。</p><p id="489e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文的数据和笔记本可以在我位于https://github.com/andymcdgeo/Petrophysics-Python-Series<a class="ae ms" href="https://github.com/andymcdgeo/Petrophysics-Python-Series" rel="noopener ugc nofollow" target="_blank">的GitHub仓库中找到。</a></p><h2 id="d684" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">导入库和数据加载</h2><p id="42cf" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">项目的第一步是导入我们需要的库。对于这个例子，我们将使用<a class="ae ms" href="https://numpy.org" rel="noopener ugc nofollow" target="_blank"> NumPy </a>处理数组，<a class="ae ms" href="https://pandas.pydata.org" rel="noopener ugc nofollow" target="_blank"> pandas </a>存储数据，<a class="ae ms" href="https://seaborn.pydata.org" rel="noopener ugc nofollow" target="_blank"> seaborn </a>和<a class="ae ms" href="https://matplotlib.org" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>显示数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="accf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们将使用<code class="fe mv mw mx my b">pd.read_csv</code>读入数据，然后使用<code class="fe mv mw mx my b">describe()</code>方法查看数据细节。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/f5ac6fd5de20a7fc86da1bfd600924ad.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-P1tzm1-Itsd0JYIOazWlg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">的数据描述</p></figure><p id="2581" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于这是一个相当大的表，我们可以通过调用<code class="fe mv mw mx my b">df.columns</code>来查看列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="11be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回dataframe中的列数组:</p><pre class="kj kk kl km gt na my nb nc aw nd bi"><span id="93e4" class="lu lv it my b gy ne nf l ng nh">Index(['WELL', 'DEPTH_MD', 'X_LOC', 'Y_LOC', 'Z_LOC', 'GROUP', 'FORMATION', 'CALI', 'RSHA', 'RMED', 'RDEP', 'RHOB', 'GR', 'SGR', 'NPHI', 'PEF', 'DTC', 'SP', 'BS', 'ROP', 'DTS', 'DCAL', 'DRHO', 'MUDWEIGHT', 'RMIC', 'ROPA', 'RXO', 'FORCE_2020_LITHOFACIES_LITHOLOGY', 'FORCE_2020_LITHOFACIES_CONFIDENCE'], dtype='object')</span></pre><p id="8e6f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个例子中，我们不需要所有的列，所以我们将复制一个包含所需测井测量值的数据帧，包括井名和深度曲线。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="4215" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还将把<code class="fe mv mw mx my b">FORCE_2020_LITHOFACIES_LITHOLOGY</code>列重命名为更简单的名称，如<code class="fe mv mw mx my b">FACIES</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="3c9e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们调用dataframe时，我们要处理的列数量要少得多。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/c0d8224fd8441b4458fcb5a5ad3ba4f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TPSBE07OmDmF8PuGci4_1Q.png"/></div></div></figure><h2 id="cae6" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">列重新映射/重命名</h2><p id="0a36" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">为了简化绘图，并理解数据中提供的岩性数字的含义，我们可以创建两个字典并将<code class="fe mv mw mx my b">FACIES</code>列映射到两个新列。</p><p id="9069" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个是为数字的字符串表示创建一个字典。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8d70" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第二本字典将岩性数字简化为1到12的范围，而不是原始数据中使用的大范围数字。这将有助于绘制对数图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1fc8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了在我们的数据框架中创建新的列，我们首先定义列名<code class="fe mv mw mx my b">workingdf['LITH']</code>，然后使用<code class="fe mv mw mx my b">.map()</code>方法分配映射值。</p><p id="164c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们对相的字符串和简单数字表示都这样做。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="cac8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们查看数据帧时，我们可以看到现在在末尾有两个新列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/e15d61beae8763043aee92ef6dd331ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oUW4scbtt6clmBTiNAhXLg.png"/></div></div></figure><h2 id="afff" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">将数据可视化</h2><p id="54da" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">由于已经有一个包含该数据的相列，我们可以快速查看数据在每个岩相中的分布情况。</p><p id="a3d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了做到这一点，我们可以使用Seaborn的<code class="fe mv mw mx my b">FacetGrid</code>方法为每种岩性绘制单独的密度-中子交会图(散点图)。</p><p id="e244" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">FacetGrid用于创建地块的基础结构。在这个例子中，FacetGrid已经被传递了我们正在处理的data frame(<code class="fe mv mw mx my b">workingdf</code>)、我们想要用来拆分图的列(<code class="fe mv mw mx my b">col</code>)以及我们想要换行到新行的点(<code class="fe mv mw mx my b">col_wrap</code>)。在这种情况下，一旦有4列，数据就会换行。</p><p id="3d8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们可以在<code class="fe mv mw mx my b">FacetGrid</code>的顶部绘制一个密度中子交会图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/f749059547dfe65a9aa85534d77ce00e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*LIBYNfp8GrzNsOBFKaKuQQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">FORCE 2020 XEEK机器学习数据集内岩性的FacetGrid。</p></figure><p id="5cfa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">创建绘图功能</strong></p><p id="971f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在绘制任何数据之前，我们需要创建一些函数。第一个是create plot函数，它将接受一些参数和我们的相曲线，并将生成一个常规的测井曲线。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="fa1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">按井函数拆分数据</strong></p><p id="15c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将创建的第二种方法将用于按井分割我们的数据帧。这是使用<code class="fe mv mw mx my b">groupby</code>函数完成的，它将允许我们将每个数据帧存储在一个列表中，以便于以后访问。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1e97" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以调用该函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="efd2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回一个索引位置和相关井名的列表</p><pre class="kj kk kl km gt na my nb nc aw nd bi"><span id="227e" class="lu lv it my b gy ne nf l ng nh">index  wellname<br/>0      15/9-13<br/>1      15/9-15<br/>2      15/9-17<br/>3      16/1-2<br/>4      16/1-6 A<br/>5      16/10-1<br/>6      16/10-2<br/>7      16/10-3<br/>8      16/10-5<br/>9      16/11-1 ST3<br/>10      16/2-11 A<br/>11      16/2-16</span></pre><h1 id="d9ad" class="nk lv it bd lw nl nm nn lz no np nq mc jz nr ka mf kc ns kd mi kf nt kg ml nu bi translated">无监督聚类</h1><p id="1edb" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在本节中，我们将建立聚类模型，并在数据集上运行它们。</p><p id="2302" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们将从sklearn库中导入我们的集群模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="0de8" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">寻找最佳聚类数</h2><p id="af72" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">为了确保K均值和高斯混合建模模型有效工作，我们需要为它们提供一个初始的聚类数。如果聚类数选择不正确，算法可能无法很好地执行，或者可能需要更长的时间来解决问题(尤其是当聚类数过高时)。</p><p id="478c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以尝试使用肘形图来确定最佳聚类数，目标是根据结果中形成的“肘形”或拐点来选择聚类数。还有其他方法，例如用于挑选集群数量的剪影方法。</p><p id="15cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个例子，我们将使用肘图。为此，我们在给定的聚类范围内评估模型性能，然后从图中确定最合适的数字。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="a5cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了进行聚类，我们需要删除任何丢失的值。这是通过使用<code class="fe mv mw mx my b">dropna()</code>功能实现的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="037d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以使用<code class="fe mv mw mx my b">describe()</code>函数来确保在删除丢失的数据值后，我们的数据仍然是好的。在这个例子中，我们已经从133，198到82，732个深度级别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/d84960b15426c30c2e3f2ab47eef1e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1uPVXSwFqTuHYD1yAkTFTw.png"/></div></div></figure><p id="998e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使我们的模型简单，我们将使用四个测井测量值(列):伽马射线(GR)、体积密度(RHOB)、中子孔隙度(NPHI)和声波压缩慢度(DTC)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/dc11e2745178498fb6e6e48dae7fa0f1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Gzc_Pcdlskm7E3GzAmL4Og.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用于选择最佳聚类数的肘形图(图片由作者提供)</p></figure><p id="29fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的图中，我们可以看到，随着聚类数量的增加，惯性(到最近的聚类中心的平方距离之和)减小。在该数据集中没有明确定义的间断，但是，我们可以看到斜率从大约5个聚类开始变化。该值的选取将取决于解释器，范围可以从4到10。</p><p id="84fd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，在本例中，我们将5作为最佳聚类数。</p><h2 id="3484" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">拟合聚类模型</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="87c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使比较简单，我们将在高斯混合模型中使用相同数量的聚类。对于该模型，簇数参数被称为n_components。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="9b96" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">绘制结果</h2><p id="4764" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">现在已经使用克均值和GMM方法计算了聚类，我们可以绘制数据以查看预测与标记岩性的关系。请注意，这些方法是无监督的，并且不使用标记的数据进行训练。我们在这里比较无监督方法在测井数据中的表现。</p><p id="5b5b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们在主<code class="fe mv mw mx my b">workingdf</code>数据框架中预测的那样，我们需要将数据再次拆分到各个油井中。我们可以通过调用前面创建的简单函数来做到这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><pre class="kj kk kl km gt na my nb nc aw nd bi"><span id="3683" class="lu lv it my b gy ne nf l ng nh">index  wellname<br/>0      15/9-13<br/>1      15/9-15<br/>2      15/9-17<br/>3      16/1-6 A<br/>4      16/10-1<br/>5      16/10-2<br/>6      16/10-3<br/>7      16/10-5<br/>8      16/2-11 A<br/>9      16/2-16</span></pre><p id="3116" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们要看的第一个图是对数图。我们将传递原始岩相(LITH_SI)列和新计算的KMeans和GMM结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/672e9c26480782834776c8ae2ab276ef.png" data-original-src="https://miro.medium.com/v2/format:webp/1*nod_mB7QzXIBznEFwUJ2lg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用Python生成的测井图显示了不同的无监督学习聚类方法(图片由作者提供)</p></figure><p id="4998" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的图中，我们有原始的岩性，我们计算的k均值和GMM聚类结果在最后三个子图中。</p><p id="9995" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先要注意的是，颜色不一定意味着数据来自每种方法的同一组。有很多方法可以映射它们，使得颜色一致，但是为了本教程的目的，我们不会深入讨论这个。</p><p id="5fa6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">查看16/10–1井(索引4)，我们显示了10个独立的相/组，我们可以看到这些主要与测井测量的变化有关。例如，伽马射线(GR)从大约2300米下降到大约2775米，这与蓝色和浅蓝色组很好地联系在一起。在KMeans和GMM模型中，这一部分也在两种方法中被突出显示为位于同一聚类中，但是，这一部分没有变化。由于这两种方法都被设置为最多5个集群，我们将无法捕获相同程度的变化。</p><p id="46d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了解决这个问题，我们可以增加集群的数量。</p><h2 id="66b5" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">查看散点图/交会图上的结果</h2><p id="5903" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">查看聚类性能的另一种方式是通过散点图。我们可以使用常见的密度-中子散点图/交会图和matplotlib来实现这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/129eff5647ede6057741ea941640cc4d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*tTw8MrGhtzcn5OebtlEQ6g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">无监督学习结果与提供的岩性的交会图(图片由作者提供)</p></figure><p id="9168" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尽管在每种方法中都有聚类的混合，但在测井曲线部分讨论的区间可以在曲线的左下方识别，这里我们有较高的密度值和较低的中子孔隙度值。</p><p id="8cef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在KMeans分组中，该聚类显示为一个完整的聚类，然而，在GMM方法中，我们可以看到它更接近于所提供的岩性。</p><h2 id="481f" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">查看配对图上的结果</h2><p id="db54" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">因为我们在模型中使用了四条输入曲线，所以我们应该查看所有这些曲线，以了解聚类是如何变化的。最好的方法是使用seaborn库中优秀的pairplot。此图在网格上显示数据集中数据之间的关系。这提供了一种快速简单的方法来识别和可视化数据。沿着对角线，还绘制了按聚类划分的数据分布。</p><p id="517f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们查看4号井时，我们需要将该数据帧传递给pairplot (dfs_wells[4])。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/94a4433867198fbf0148c530995e87a2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*60f4iYNiIaC24Psm5rcfNA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">说明每个输入测量的各种聚类的PairPlot(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/48c97aa2252d7a8282ae5154d2060618.png" data-original-src="https://miro.medium.com/v2/format:webp/1*GaxF9maA90WyC61aPqwiWQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">说明每个输入测量的各种聚类的PairPlot(图片由作者提供)</p></figure><p id="20a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这为我们提供了一个更好的图形，也让我们看到数据是如何聚集在其他测井曲线中的。我们可以看到，GMM模型在定义集群方面提供了一些改进，尤其是在DTC与RHOB图中。</p><h1 id="9adc" class="nk lv it bd lw nl nm nn lz no np nq mc jz nr ka mf kc ns kd mi kf nt kg ml nu bi translated">摘要</h1><p id="ff66" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在本文中，我们介绍了使用两种流行的算法(KMeans聚类和高斯混合建模)进行无监督聚类分析的基础知识。使用优化方法，我们通过目测确定了最佳聚类数为5，但是，值得用更多的聚类进行实验，以查看这是否提供了更好的匹配。</p><p id="1835" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦聚类完成，我们看到了多种可视化结果的方法:标准对数图设置、散点图和seaborn的pairplot。</p><p id="8349" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于K-均值聚类利用球形聚类，它可能并不总是适用于测井数据和地下。然而，高斯混合模型似乎确实在聚类方面提供了一点改进。</p><p id="d18c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="nw">感谢阅读！</em>T3】</strong></p><p id="5ed7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nw">如果你觉得这篇文章有用，请随时查看我的其他文章，这些文章从不同的角度研究了Python和测井数据。你也可以在</em> <a class="ae ms" href="https://github.com/andymcdgeo" rel="noopener ugc nofollow" target="_blank"> <em class="nw"> GitHub </em> </a> <em class="nw">找到我在这篇文章和其他文章中使用的代码。</em></p><p id="ef1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nw">如果你想联系我，你可以在</em><a class="ae ms" href="https://www.linkedin.com/in/andymcdonaldgeo/" rel="noopener ugc nofollow" target="_blank"><em class="nw">LinkedIn</em></a><em class="nw">或者我的</em> <a class="ae ms" href="http://andymcdonald.scot/" rel="noopener ugc nofollow" target="_blank"> <em class="nw">网站</em> </a> <em class="nw">找到我。</em></p><p id="d717" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有兴趣了解更多关于python和测井数据或岩石物理学的知识吗？跟我上 <a class="ae ms" href="https://medium.com/@andymcdonaldgeo" rel="noopener"> <em class="nw">中</em> </a> <em class="nw">。</em></p><p id="79ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢这篇文章或任何其他文章，并想表达你的谢意，欢迎你来<a class="ae ms" href="http://buymeacoffee.com/andymcdonaldgeo" rel="noopener ugc nofollow" target="_blank">给我买杯咖啡</a></p><h1 id="ddce" class="nk lv it bd lw nl nm nn lz no np nq mc jz nr ka mf kc ns kd mi kf nt kg ml nu bi translated">参考</h1><p id="3016" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">博尔曼，彼得，奥桑德，彼得，迪里布，法哈德，曼拉尔，投降，&amp;迪辛顿，彼得。(2020).机器学习竞赛FORCE 2020井测井和岩相数据集[数据集]。芝诺多。<a class="ae ms" href="http://doi.org/10.5281/zenodo.4351156" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.4351156</a></p><p id="80c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你需要的最全面的K-Means聚类指南<a class="ae ms" href="https://www.analyticsvidhya.com/blog/2019/08/comprehensive-guide-k-means-clustering/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2019/08/Comprehensive-Guide-K-Means-Clustering/</a></p></div></div>    
</body>
</html>