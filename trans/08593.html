<html>
<head>
<title>Make your Own Book and Movie Recommender System using Surprise</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Surprise制作您自己的书籍和电影推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/make-your-own-book-and-movie-recommender-system-using-surprise-42cc1c840a19?source=collection_archive---------23-----------------------#2021-08-08">https://towardsdatascience.com/make-your-own-book-and-movie-recommender-system-using-surprise-42cc1c840a19?source=collection_archive---------23-----------------------#2021-08-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/03faf47e1ba093f175070fa17622227f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U13wGhZz3deRg_qyr0iY7g.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">Juraj Gabriel 在<a class="ae kc" href="https://unsplash.com/s/photos/book-movie?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="74a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我花了几年的博士时间来构建推荐系统，并从头开始对它们进行基准测试，只有当我完成它时，我才听说了sikit图书馆的惊喜。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://gph.is/g/4V6JjGO" rel="noopener ugc nofollow" target="_blank"> GIF </a> by <a class="ae kc" href="https://gph.is/g/4V6JjGO" rel="noopener ugc nofollow" target="_blank"> GIFY </a></p></figure><p id="afd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我以前就想知道的一个惊喜。这将节省我的时间和精力来实现许多推荐系统基线。</p><p id="6e36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我想在这里分享关于这个库的信息，并给出一些关于如何使用它的代码，因为它可能会帮助其中一个读者。让我们开始吧！</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h1 id="39a8" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">什么是惊喜？</h1><blockquote class="mm mn mo"><p id="981b" class="kd ke mp kf b kg kh ki kj kk kl km kn mq kp kq kr mr kt ku kv ms kx ky kz la ij bi translated">Surprise(代表<strong class="kf ir">简单Python推荐系统引擎</strong>)是一个Python库，用于构建和分析处理显式评级数据的推荐系统。它提供了各种现成的预测算法，如基线算法，邻域法，基于矩阵分解(奇异值分解，PMF，SVD++，NMF)，以及许多其他算法。此外，各种相似性措施(余弦，MSD，皮尔逊…)是内置的。来源:<a class="ae kc" href="http://surpriselib.com/" rel="noopener ugc nofollow" target="_blank">http://surpriselib.com/</a></p></blockquote><p id="ae01" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将在两个不同的数据集上使用Surprise:</p><ol class=""><li id="b56d" class="mt mu iq kf b kg kh kk kl ko mv ks mw kw mx la my mz na nb bi translated">建立一个电影推荐系统。</li><li id="57f1" class="mt mu iq kf b kg nc kk nd ko ne ks nf kw ng la my mz na nb bi translated">建立图书推荐系统。</li></ol><p id="37bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这两种情况下，我将使用协作过滤技术和基于内容的技术来过滤项目，不用担心我会解释它们之间的区别。</p><h1 id="8409" class="lo lp iq bd lq lr nh lt lu lv ni lx ly lz nj mb mc md nk mf mg mh nl mj mk ml bi translated">使用Surprise构建电影推荐系统</h1><h2 id="58ee" class="nm lp iq bd lq nn no dn lu np nq dp ly ko nr ns mc ks nt nu mg kw nv nw mk nx bi translated">安装惊喜</h2><pre class="lb lc ld le gt ny nz oa ob aw oc bi"><span id="2d72" class="nm lp iq nz b gy od oe l of og">pip install surprise</span></pre><h2 id="5a82" class="nm lp iq bd lq nn no dn lu np nq dp ly ko nr ns mc ks nt nu mg kw nv nw mk nx bi translated">读取数据集</h2><p id="4404" class="pw-post-body-paragraph kd ke iq kf b kg oh ki kj kk oi km kn ko oj kq kr ks ok ku kv kw ol ky kz la ij bi translated">我在这里使用的是MovieLens数据集。它包含2500万用户评级。数据在。/data/raw文件夹。我们可以直接加载。csv文件，具有内置的惊喜功能，但为了以后的灵活性目的，通过Pandas数据框加载它会更方便。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="om lg l"/></div></figure><p id="3728" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">出于复杂性考虑，我只使用了这个数据集的一个子集，但是你可以全部使用。然后，我将评级上传到一个惊喜数据集对象，该对象按顺序包含以下字段:</p><ol class=""><li id="1926" class="mt mu iq kf b kg kh kk kl ko mv ks mw kw mx la my mz na nb bi translated">使用者辩证码</li><li id="e9f2" class="mt mu iq kf b kg nc kk nd ko ne ks nf kw ng la my mz na nb bi translated">电影Id</li><li id="68f6" class="mt mu iq kf b kg nc kk nd ko ne ks nf kw ng la my mz na nb bi translated">相应的评级(通常在1-5的范围内)</li></ol><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="om lg l"/></div></figure><h1 id="2478" class="lo lp iq bd lq lr nh lt lu lv ni lx ly lz nj mb mc md nk mf mg mh nl mj mk ml bi translated">训练和交叉验证协同过滤模型</h1><blockquote class="mm mn mo"><p id="b19a" class="kd ke mp kf b kg kh ki kj kk kl km kn mq kp kq kr mr kt ku kv ms kx ky kz la ij bi translated">协同过滤方法依赖于用户的偏好以及系统中其他用户的偏好。这个想法是，如果两个用户是志同道合的(在过去就项目的一些偏好达成一致)，与一个用户相关的项目被推荐给另一个用户，反之亦然。他们仅从用户项目评级矩阵中获得推荐。来源:<a class="ae kc" href="https://boa.unimib.it › phd_unimib_799490" rel="noopener ugc nofollow" target="_blank">我的博士论文报告</a></p></blockquote><p id="9763" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Surprise实现了一些协作算法，如奇异值分解、NMF等。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="om lg l"/></div></figure><pre class="lb lc ld le gt ny nz oa ob aw oc bi"><span id="6c02" class="nm lp iq nz b gy od oe l of og">0it [00:00, ?it/s]</span><span id="5b35" class="nm lp iq nz b gy on oe l of og">RMSE: 0.9265<br/>RMSE: 1.0959<br/>Computing the msd similarity matrix...<br/>Done computing similarity matrix.</span><span id="c0fb" class="nm lp iq nz b gy on oe l of og">1it [00:12, 12.72s/it]</span><span id="f620" class="nm lp iq nz b gy on oe l of og">RMSE: 0.9919<br/>RMSE: 0.9299<br/>RMSE: 1.1025<br/>Computing the msd similarity matrix...<br/>Done computing similarity matrix.</span><span id="0246" class="nm lp iq nz b gy on oe l of og">2it [00:26, 13.54s/it]</span><span id="13cb" class="nm lp iq nz b gy on oe l of og">RMSE: 0.9915<br/>RMSE: 0.9270<br/>RMSE: 1.0996<br/>Computing the msd similarity matrix...<br/>Done computing similarity matrix.</span><span id="71ad" class="nm lp iq nz b gy on oe l of og">3it [00:42, 14.14s/it]</span><span id="a20f" class="nm lp iq nz b gy on oe l of og">RMSE: 0.9905</span></pre><h1 id="949d" class="lo lp iq bd lq lr nh lt lu lv ni lx ly lz nj mb mc md nk mf mg mh nl mj mk ml bi translated">训练基于内容的过滤模型</h1><blockquote class="mm mn mo"><p id="0c27" class="kd ke mp kf b kg kh ki kj kk kl km kn mq kp kq kr mr kt ku kv ms kx ky kz la ij bi translated">基于内容的过滤方法分析与用户相关的项目的一组特征，并基于这些特征学习用户简档。过滤过程基本上包括将用户简档的特征与项目内容(即项目简档)的特征进行匹配。来源:<a class="ae kc" href="https://boa.unimib.it › phd_unimib_799490" rel="noopener ugc nofollow" target="_blank">我的博士论文报告</a></p></blockquote><p id="cc95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，这里我将直接依赖于项目属性，即电影标题。首先，我必须用属性向量描述一个用户概要文件。然后，我将使用这些向量来生成基于相似性度量的推荐。</p><p id="6bca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大多数基于内容的过滤方法是基于启发式模型，该模型在向量空间模型中将用户和项目表示为TF-IDF(或BM25)的向量。</p><p id="59fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在这段代码中使用了TF-IDF，它考虑了在一个文档中频繁出现的术语(TF =term-frequency)，但在语料库的其余部分很少出现的术语(IDF = inverse-document-frequency)。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="om lg l"/></div></figure><p id="f756" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于项目和用户简档被表示为TF-IDF的向量，所以项目以与用户相似度递减的顺序被推荐<br/>(用户简档以项目的相同形式表示)。最常见的度量是余弦相似性，我将在下面使用它来计算两个配置文件之间的相似性。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="om lg l"/></div></figure><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="om lg l"/></div></figure><p id="9003" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设用户想要电影《山达基和信仰的监狱(2015)》中最‘相似’的10部电影。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="om lg l"/></div></figure><pre class="lb lc ld le gt ny nz oa ob aw oc bi"><span id="6269" class="nm lp iq nz b gy od oe l of og">Recommending 10 products similar to Going Clear: Scientology and the Prison of Belief (2015)...<br/>-------<br/>	Recommended: Soulless 2 (2015) (score:0.09111541613391295)<br/>	Recommended: Víkend (2015) (score:0.09111541613391295)<br/>	Recommended: No Longer Heroine (2015) (score:0.06179864475000222)<br/>	Recommended: In the Shadow of Women (2015) (score:0.06179864475000222)<br/>	Recommended: Marco Polo: One Hundred Eyes (2015) (score:0.05026525144746273)<br/>	Recommended: Ugly American, The (1963) (score:0.0)<br/>	Recommended: Snitch Cartel, The (El cartel de los sapos) (2011) (score:0.0)<br/>	Recommended: Drone (2014) (score:0.0)<br/>	Recommended: Kenny Rogers as The Gambler (1980) (score:0.0)<br/>	Recommended: Le Rossignol (2005) (score:0.0)</span></pre><h1 id="518f" class="lo lp iq bd lq lr nh lt lu lv ni lx ly lz nj mb mc md nk mf mg mh nl mj mk ml bi translated">构建图书推荐系统</h1><p id="ad03" class="pw-post-body-paragraph kd ke iq kf b kg oh ki kj kk oi km kn ko oj kq kr ks ok ku kv kw ol ky kz la ij bi translated">这将是一个类似于上面的代码，但应用于不同的数据集。</p><p id="b30b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用了Kaggle上可用的<a class="ae kc" href="https://www.kaggle.com/zygmunt/goodbooks-10k" rel="noopener ugc nofollow" target="_blank"> goodbooks-10k </a>数据集。它包含评级和图书csv文件。第一个包含超过53，000个用户对10，000本书的评级数据。第二个文件包含10，000本书的元数据(标题、作者、ISBN等。).</p><p id="b7c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我通过<a class="ae kc" href="https://github.com/amamimaha/surprise_recommender_systems" rel="noopener ugc nofollow" target="_blank"> Github </a>分享了书籍和电影推荐系统。</p><h1 id="5b76" class="lo lp iq bd lq lr nh lt lu lv ni lx ly lz nj mb mc md nk mf mg mh nl mj mk ml bi translated">结论</h1><p id="4982" class="pw-post-body-paragraph kd ke iq kf b kg oh ki kj kk oi km kn ko oj kq kr ks ok ku kv kw ol ky kz la ij bi translated">就是这样！您可以将此推荐系统代码模板应用于任何您想要的数据。在接下来的几天里，我还将分享关于上下文推荐系统以及如何实现它。</p><p id="4042" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，敬请期待！</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="oo lg l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="http://gph.is/2dUaDW7" rel="noopener ugc nofollow" target="_blank"> GIF </a>由<a class="ae kc" href="https://giphy.com/" rel="noopener ugc nofollow" target="_blank"> Gify </a></p></figure></div></div>    
</body>
</html>