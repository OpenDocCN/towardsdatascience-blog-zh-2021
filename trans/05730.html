<html>
<head>
<title>Understanding *args and **kwargs in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Python中的*args和**kwargs</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-args-and-kwargs-in-python-321937f49c5b?source=collection_archive---------12-----------------------#2021-05-22">https://towardsdatascience.com/understanding-args-and-kwargs-in-python-321937f49c5b?source=collection_archive---------12-----------------------#2021-05-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a4e" class="pw-subtitle-paragraph ju is it bd b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dk translated">了解如何在Python中向函数传递可变数量的参数</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/1a7d1cac6090c09dab39123e1f922a4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qdRCuZn-13M550a5"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">照片由<a class="ae lc" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯里德</a>在<a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="a842" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果您是一名初级Python程序员，您可能会遇到带有如下所示参数的函数声明:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="d3b8" class="md me it jt b gy mf mg l mh mi">def do_something(num1, num2, <strong class="jt iu">*args</strong>, <strong class="jt iu">**kwargs</strong>):</span></pre><p id="742a" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">上面的<code class="fe jq jr js jt b">*</code>和<code class="fe jq jr js jt b">**</code>操作符允许您向函数传递可变数量的参数。然而，这个特性经常给Python程序员带来很多困惑。本文将试图阐明<code class="fe jq jr js jt b">*</code>和<code class="fe jq jr js jt b">**</code>操作符的用途，以及如何在日常编程任务中使用它们。</p><h1 id="d191" class="mj me it bd mk ml mm mn mo mp mq mr ms kd mt ke mu kg mv kh mw kj mx kk my mz bi translated"><strong class="ak">使用* </strong>传递可变数量的参数</h1><p id="1ece" class="pw-post-body-paragraph ld le it lf b lg na jy li lj nb kb ll lm nc lo lp lq nd ls lt lu ne lw lx ly im bi translated">首先，考虑以下函数定义:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="d2c9" class="md me it jt b gy mf mg l mh mi">def do_something(num1, num2, *args):<br/>    print(num1)<br/>    print(num2)</span></pre><p id="3f2c" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">要调用<strong class="lf iu"> do_something() </strong>，需要传入:</p><ul class=""><li id="322a" class="nf ng it lf b lg lh lj lk lm nh lq ni lu nj ly nk nl nm nn bi translated">两个强制参数，后面是，</li><li id="07cd" class="nf ng it lf b lg no lj np lm nq lq nr lu ns ly nk nl nm nn bi translated">可选的可变参数数量</li></ul><p id="24ca" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">让我们试试这个，看看会发生什么。我们可以先这样调用<strong class="lf iu"> do_something() </strong>:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="d1a6" class="md me it jt b gy mf mg l mh mi"># calling the function with two mandatory arguments<br/>do_something(5,6)</span></pre><p id="1a0a" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您现在应该看到:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="aa06" class="md me it jt b gy mf mg l mh mi">5<br/>6</span></pre><p id="cd7b" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您也可以在前两个参数后传递附加参数，如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="0fd3" class="md me it jt b gy mf mg l mh mi">do_something(5,6,<strong class="jt iu">7,8,9</strong>)</span></pre><p id="ebd4" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">第三个参数向前传递到<strong class="lf iu"> do_something() </strong>函数中的<strong class="lf iu"> args </strong>变量中。<strong class="lf iu"> args </strong>的数据类型为<strong class="lf iu">元组</strong>。因此，您可以在函数中使用一个<em class="nt"> for-in </em>循环来提取传入的单个可选参数:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="d089" class="md me it jt b gy mf mg l mh mi">def do_something(num1, num2, *args, **kwargs):<br/>    print(num1)<br/>    print(num2)<br/><strong class="jt iu">    for arg in args:<br/>        print(arg)</strong></span></pre><p id="1e70" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因此，您的输出将如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="deb6" class="md me it jt b gy mf mg l mh mi">5<br/>6<br/>7<br/>8<br/>9</span></pre><p id="dfd4" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">以下对<strong class="lf iu"> do_something() </strong>函数的调用都是有效的:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="3967" class="md me it jt b gy mf mg l mh mi">do_something(5,6,<strong class="jt iu">7</strong>)<br/>do_something(5,6,<strong class="jt iu">7,8</strong>)<br/>do_something(5,6,<strong class="jt iu">7,8,9</strong>)<br/>do_something(5,6,<strong class="jt iu">7,8,9,True</strong>)<br/>do_something(5,6,<strong class="jt iu">7,8,9,True,3.14</strong>)</span></pre><p id="91fb" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">虽然您可以为可选参数传入不同类型的不同参数，但传入相同类型的参数更常见(也更符合逻辑)。例如，您可能有一个名为<strong class="lf iu"> average() </strong>的函数来计算一组数字的平均值:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="1ac3" class="md me it jt b gy mf mg l mh mi">def average(*args):<br/>    return sum(args) / len(args)</span><span id="e9a9" class="md me it jt b gy nu mg l mh mi">print(average(1,2))            # 1.5<br/>print(average(1,2,3))          # 2.0<br/>print(average(1,2,3,4,5))      # 3.0<br/>print(average(1,2,3,4,5, 6.1)) # 3.516666666666667</span></pre><p id="8003" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在这种情况下，传入相同类型(数值类型)的参数很有意义。</p><blockquote class="nv nw nx"><p id="5994" class="ld le nt lf b lg lh jy li lj lk kb ll ny ln lo lp nz lr ls lt oa lv lw lx ly im bi translated">值得一提的是，变量参数的命名并不局限于“<strong class="lf iu"> args </strong>”。您可以使用自己的变量名来命名它。</p></blockquote><h1 id="d40b" class="mj me it bd mk ml mm mn mo mp mq mr ms kd mt ke mu kg mv kh mw kj mx kk my mz bi translated">使用*解包参数</h1><p id="036c" class="pw-post-body-paragraph ld le it lf b lg na jy li lj nb kb ll lm nc lo lp lq nd ls lt lu ne lw lx ly im bi translated">在上一节中，您看到了如何向函数传递可变数量的参数，如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="5c57" class="md me it jt b gy mf mg l mh mi">do_something(5,6,<strong class="jt iu">7,8,9</strong>)</span></pre><p id="517e" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果您的可选参数存储在一个<strong class="lf iu">列表</strong>或<strong class="lf iu">元组</strong>中，如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="1103" class="md me it jt b gy mf mg l mh mi">values = (7,8,9)   # tuple</span></pre><p id="49b7" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在这种情况下，要将values变量传递给<strong class="lf iu"> do_something() </strong>函数，您可以使用<code class="fe jq jr js jt b"><strong class="lf iu">*</strong></code>操作符来<em class="nt">解包</em>值，以便可以将它们传递给函数:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="9f70" class="md me it jt b gy mf mg l mh mi">do_something(5,6,<strong class="jt iu">*values</strong>)</span></pre><p id="9fb3" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe jq jr js jt b">*</code>操作符也处理列表:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="e91b" class="md me it jt b gy mf mg l mh mi">values = <strong class="jt iu">[</strong>7,8,9<strong class="jt iu">]   </strong># list<br/>do_something(5,6,*values)</span></pre><h1 id="b507" class="mj me it bd mk ml mm mn mo mp mq mr ms kd mt ke mu kg mv kh mw kj mx kk my mz bi translated">使用**传入“带关键字的”参数</h1><p id="886f" class="pw-post-body-paragraph ld le it lf b lg na jy li lj nb kb ll lm nc lo lp lq nd ls lt lu ne lw lx ly im bi translated">可变参数的第二种形式对初学者来说稍微有点混乱。考虑以下函数定义:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="8ba5" class="md me it jt b gy mf mg l mh mi">def do_something(num1, num2, <strong class="jt iu">**kwargs</strong>):</span></pre><blockquote class="nv nw nx"><p id="fa3c" class="ld le nt lf b lg lh jy li lj lk kb ll ny ln lo lp nz lr ls lt oa lv lw lx ly im bi translated"><strong class="lf iu"> kwargs </strong>中的<strong class="lf iu"> kw </strong>代表<strong class="lf iu"> k </strong> ey <strong class="lf iu"> w </strong> orded。同样，您可以使用自己喜欢的名称给这个变量命名。</p></blockquote><p id="6f2a" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">除了传入前两个强制参数之外，现在还可以传入一个可选的“关键字”参数。一个例子可以说明这一点:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="6e23" class="md me it jt b gy mf mg l mh mi">do_something(5,6,<strong class="jt iu">x=7</strong>)<br/>do_something(5,6,<strong class="jt iu">x=7,y=8</strong>)</span></pre><blockquote class="nv nw nx"><p id="7856" class="ld le nt lf b lg lh jy li lj lk kb ll ny ln lo lp nz lr ls lt oa lv lw lx ly im bi translated">就个人而言，我更喜欢称x=7和y=8为<strong class="lf iu">键/值</strong>对。</p></blockquote><p id="f5e5" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在上面的例子中，您可以通过指定键(<code class="fe jq jr js jt b">x</code>和<code class="fe jq jr js jt b">y</code>)和它们相应的值(7和8)来传递额外的参数。</p><p id="af12" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在这个函数中，关键字对作为一个<em class="nt">字典</em>被传递给<code class="fe jq jr js jt b"><strong class="lf iu">kwargs</strong></code>。因此，您可以使用<em class="nt"> for-in </em>循环提取它们，如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="3386" class="md me it jt b gy mf mg l mh mi">def do_something(num1, num2, <strong class="jt iu">**kwargs</strong>):<br/>    print(num1)<br/>    print(num2)<br/><strong class="jt iu">    for k,v in kwargs.items():   # get each key/value pair one at a <br/>        print(k,v)               # time</strong></span></pre><p id="63bb" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">当然，您也可以提取键，然后像这样提取值:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="acb7" class="md me it jt b gy mf mg l mh mi">def do_something(num1, num2, **kwargs):<br/>    print(num1)<br/>    print(num2)<br/><strong class="jt iu">    for k in kwargs.keys():    # retrieve all the keys<br/>        print(k, kwargs[k])    # then get the value based on the key</strong></span></pre><p id="1c81" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在任一情况下，输出将如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="d106" class="md me it jt b gy mf mg l mh mi">5<br/>6<br/><strong class="jt iu">x 7<br/>y 8</strong></span></pre><h1 id="1ac1" class="mj me it bd mk ml mm mn mo mp mq mr ms kd mt ke mu kg mv kh mw kj mx kk my mz bi translated"><code class="fe jq jr js jt b">**kwargs</code>的用途</h1><p id="10ec" class="pw-post-body-paragraph ld le it lf b lg na jy li lj nb kb ll lm nc lo lp lq nd ls lt lu ne lw lx ly im bi translated">关于<code class="fe jq jr js jt b">**kwargs</code>的一个常见问题是它的用例。<code class="fe jq jr js jt b"><strong class="lf iu">**kwargs</strong></code>在什么情况下有用？考虑以下情况，其中您有一个包含四列的数据帧:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="9b0e" class="md me it jt b gy mf mg l mh mi">import pandas as pd<br/>import numpy as np</span><span id="1796" class="md me it jt b gy nu mg l mh mi">df = pd.DataFrame(np.random.randn(5,4), <br/>                  columns=['Summer','Winter','Autumn','Spring'])<br/>df</span></pre><p id="23c6" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">数据帧看起来像这样:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/734333edb9fe71a1b20c2b0fd0395088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*CkBEARA7jKOcVmDlBXPVzw.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">以熊猫数据为例</p></figure><p id="8aab" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">假设您被要求编写一个函数，比如说<strong class="lf iu"> fetch_data()，</strong>允许用户从一个或多个单元格包含的值大于某些特定值的列中提取行。例如，您希望从<strong class="lf iu"> Summer </strong>列中提取值大于0.5的所有行。此外，您可能还想从<strong class="lf iu"> Winter </strong>列中提取值大于0.2的行。在这些情况下，您的函数应该足够灵活，可以指定多个列名和值，如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="52b9" class="md me it jt b gy mf mg l mh mi">fetch_data(Summer=0.5)             # retrieve only the Summer column<br/>fetch_data(Summer=0.5, Winter=0.2) # retrieve the Summer and Winter <br/>                                   # columns</span></pre><p id="95f6" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">要实现此功能，您的函数可以使用关键字对接受这些列和值，如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="5262" class="md me it jt b gy mf mg l mh mi">def fetch_data(<strong class="jt iu">**kwargs</strong>):<br/>    for k,v in kwargs.items():<br/>        print(df[[k]][df[k]&gt;v])</span><span id="7ed3" class="md me it jt b gy nu mg l mh mi">        # df[[k]] first returns the specified column (k) as a <br/>        # dataframe, then [df[k]&gt;v] retrieves all the rows whose <br/>        # cell value is more than the value specified (v)</span></pre><p id="5e4f" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">所以下面调用<strong class="lf iu"> fetch_data() </strong>:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="6707" class="md me it jt b gy mf mg l mh mi">fetch_data(Summer=0.5, Winter=0.2)</span></pre><p id="f7fa" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">产生以下输出:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="3829" class="md me it jt b gy mf mg l mh mi">     Summer<br/>0  0.842614<br/>2  0.767157<br/>4  0.935648<br/>     Winter<br/>0  0.843960<br/>3  0.663104</span></pre><h1 id="835c" class="mj me it bd mk ml mm mn mo mp mq mr ms kd mt ke mu kg mv kh mw kj mx kk my mz bi translated">使用**解包参数</h1><p id="1661" class="pw-post-body-paragraph ld le it lf b lg na jy li lj nb kb ll lm nc lo lp lq nd ls lt lu ne lw lx ly im bi translated">正如您可以使用<code class="fe jq jr js jt b">*</code>操作符解包值列表并将其传递给具有可变参数的函数一样，您也可以使用<code class="fe jq jr js jt b">**</code>操作符解包dictionary对象并将其传递给接受关键字参数的函数，如下所示:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="9398" class="md me it jt b gy mf mg l mh mi"><strong class="jt iu">kwpairs = {'Summer':0.5, 'Winter':0.2}    # dictionary<br/>fetch_data(**kwpairs)<br/></strong># same as<br/>fetch_data(Summer=0.5, Winter=0.2)</span></pre><h1 id="48cd" class="mj me it bd mk ml mm mn mo mp mq mr ms kd mt ke mu kg mv kh mw kj mx kk my mz bi translated"><strong class="ak">可变参数和关键字参数的顺序</strong></h1><p id="75fa" class="pw-post-body-paragraph ld le it lf b lg na jy li lj nb kb ll lm nc lo lp lq nd ls lt lu ne lw lx ly im bi translated">在函数声明中，可以有以下类型的参数:</p><ul class=""><li id="4e85" class="nf ng it lf b lg lh lj lk lm nh lq ni lu nj ly nk nl nm nn bi translated">强制参数，和/或</li><li id="ac44" class="nf ng it lf b lg no lj np lm nq lq nr lu ns ly nk nl nm nn bi translated">可变参数，和/或</li><li id="a257" class="nf ng it lf b lg no lj np lm nq lq nr lu ns ly nk nl nm nn bi translated">关键词论据</li></ul><p id="ded6" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">然而，如果一个函数接受带关键字的参数，它必须总是放在函数声明的最后<em class="nt">处。以下函数声明无效:</em></p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="b1b3" class="md me it jt b gy mf mg l mh mi">def do_something(**kwargs, *args):<br/>    ...</span><span id="2603" class="md me it jt b gy nu mg l mh mi">def do_something(*args, **kwargs, num1):<br/>    ...</span><span id="25a8" class="md me it jt b gy nu mg l mh mi">def do_something(**kwargs, num1):<br/>    ...</span></pre><blockquote class="oc"><p id="b2b1" class="od oe it bd of og oh oi oj ok ol ly dk translated">如果一个函数接受带关键字的参数，它必须总是放在函数声明的最后。</p></blockquote><p id="385f" class="pw-post-body-paragraph ld le it lf b lg om jy li lj on kb ll lm oo lo lp lq op ls lt lu oq lw lx ly im bi translated">以下示例显示了一些有效的函数声明:</p><pre class="kn ko kp kq gt lz jt ma mb aw mc bi"><span id="9550" class="md me it jt b gy mf mg l mh mi">def do_something(num1, *args, **kwargs):<br/>    ...</span><span id="d332" class="md me it jt b gy nu mg l mh mi">def do_something(num1, num2, *args):<br/>    ...</span><span id="22eb" class="md me it jt b gy nu mg l mh mi">def do_something(*args, **kwargs):<br/>    ...</span><span id="3a11" class="md me it jt b gy nu mg l mh mi">def do_something(**kwargs):<br/>    ...</span><span id="5381" class="md me it jt b gy nu mg l mh mi">def do_something(*args, num1):<br/>    ...</span><span id="f4ba" class="md me it jt b gy nu mg l mh mi">def do_something(*args, num1, **kwargs):<br/>    ...</span></pre><p id="bf8c" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我将把它作为一个练习留给读者，让他们尝试上面的函数声明，并探索如何将值传递给它们。</p><p id="bb4b" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我希望你现在对<code class="fe jq jr js jt b">*args</code>和<code class="fe jq jr js jt b">**kwargs</code>有更好的理解！</p></div></div>    
</body>
</html>