<html>
<head>
<title>How effective is the signal denoising using the MATLAB-based wavelet analysis?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用基于MATLAB的小波分析进行信号去噪的效果如何？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-effective-is-the-signal-denoising-using-the-matlab-based-wavelet-analysis-9a90ed236f1d?source=collection_archive---------26-----------------------#2021-05-18">https://towardsdatascience.com/how-effective-is-the-signal-denoising-using-the-matlab-based-wavelet-analysis-9a90ed236f1d?source=collection_archive---------26-----------------------#2021-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b355" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们检验了用小波分析滤除时间序列数据中噪声的可行性。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dc13aceedd4a98f1d7fd2cdca262af6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rLWq4_uFSAHyUgO2"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">斯蒂芬·克拉克莫在Unsplash<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍摄的照片</a></p></figure><p id="0da8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="http://www.earthinversion.com/techniques/towards-multi-resolution-analysis-with-wavelet-transform/" rel="noopener ugc nofollow" target="_blank">小波分析</a>可视为傅立叶分析的一般形式。<a class="ae kv" href="http://www.earthinversion.com/techniques/signal-denoising-using-fast-fourier-transform/" rel="noopener ugc nofollow" target="_blank">傅立叶变换</a>常用于信号去噪。尽管如此，这种方法最大的缺点是信号需要稳定。我们现实世界中的大多数测量都不是静态的。此外，在基于傅立叶的去噪中，我们应用低通滤波器来去除噪声。然而，当数据具有高频特征时，如信号中的尖峰或图像中的边缘，低通滤波器会将其平滑掉。</p><p id="ad7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，基于小波的方法可能有一些优点。小波查看多分辨率窗口中的信号。它将信号中的特征定位到不同的尺度。我们可以利用这一点，保留重要信号，消除不均匀噪声。我已经在之前的<a class="ae kv" href="http://www.earthinversion.com/techniques/towards-multi-resolution-analysis-with-wavelet-transform/" rel="noopener ugc nofollow" target="_blank">文章</a>中介绍了使用小波进行多分辨率分析的基础知识。</p><h1 id="51d3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">小波去噪</h1><p id="9347" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当我们对时间序列进行小波变换时，它将信号特征集中在几个大的小波系数中。一般而言，数值较小的系数被视为噪声。理论上，我们可以缩小这些系数，或者干脆去掉它们。</p><h1 id="ba05" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">获取真实世界的信号</h1><p id="5cb5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这种情况下，我将下载记录大地震的地震时间序列。我将使用<code class="fe mp mq mr ms b">Obspy</code>模块从IRIS下载数据。有关如何使用Obspy下载波形的详细信息，请参见我的<a class="ae kv" href="http://www.earthinversion.com/geophysics/getting-started-with-obspy-for-seismologists-part-I/" rel="noopener ugc nofollow" target="_blank">上一篇文章</a>。我将下载位于(北纬38.1689，西经117.8497)的任意选定事件“2020-05-15 Mww 6.5 Nevada”的波形。</p><p id="c3b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将mseed数据保存到脚本目录以及“流”的绘图中。我还对信号进行了高通滤波，以获得时间序列的高频部分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/c0a8e54690dde628befe87d93b01ecf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFuwYVtJg08ihVk09-mAmw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">内华达2020年5月15日Mww 6.5 II-PFO垂直分量波形(图片由作者提供)</p></figure><h1 id="fb7f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">将mseed转换为mat格式</h1><p id="b359" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在，我们想让数据MATLAB可读。我写了一个实用程序来将任何mseed格式的数据转换成mat格式。我将在这种情况下使用它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/1bbf32420dd0b413edea9ee5aff79d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HvLYacZQCp3FBZrgcYUibg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用MATLAB的2020年5月15日Mww 6.5 Nevada II-PFO垂直分量波形(图片由作者提供)</p></figure><h1 id="e159" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">基于非抽样小波变换的信号去噪</h1><p id="0b07" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我将使用Matlab函数<code class="fe mp mq mr ms b">wdenoise</code>通过<code class="fe mp mq mr ms b">sym4</code>和<code class="fe mp mq mr ms b">db1</code>小波将信号降噪到9级。<code class="fe mp mq mr ms b">wdenoise</code>使用带有柯西先验的经验贝叶斯方法对信号降噪。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/eeb845831d7dd0675d3115c305e53b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-nnlgWhjsbG9b6Q2Szp2w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用sym4对地震时间序列进行降噪处理(图片由作者提供)</p></figure><p id="630d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的代码中，我通过设置名称-值对“DenoisingMethod”、“BlockJS”，使用级别9使用块阈值对地震时间序列进行降噪。我用了小波<code class="fe mp mq mr ms b">sym4</code>。</p><p id="c786" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与原始时间序列相比，信号强度的最终差值为<code class="fe mp mq mr ms b">82.5786</code>。</p><p id="3783" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，我使用不同的小波<code class="fe mp mq mr ms b">db1</code>尝试相同的过程。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/de1745e7e8a95dee9f42b5617e170b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8vVwoXiGTqjmxbsX1hDgQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用db1的去噪地震时间序列(图片由作者提供)</p></figure><p id="7bb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这使得信号强度与原始时间序列相比的差值为<code class="fe mp mq mr ms b">34.5294</code>。因此，我们发现小波<code class="fe mp mq mr ms b">sym4</code>中的差异是显著的。我们还可以使用其他几个参数，包括级别。</p><p id="4a2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于“sym4”小波，我尝试将级别更改为2、5、10，并得到SNR分别为82.7493、82.5789、82.5786。不同电平的SNR之间的微小差异可能表明，在这种情况下，高频噪声量并不过量。让我们尝试使用有噪声的合成数据来验证这一假设(在这种情况下，我们将拥有完全的控制权)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/180772bc96d8b586596996902920b7e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Wxz74qHOYN2zs_SgI_68w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">基于四级近似的小波重构(图片由作者提供)</p></figure><h1 id="da7c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">完整的MATLAB代码</h1><pre class="kg kh ki kj gt mw ms mx my aw mz bi"><span id="86e1" class="na lt iq ms b gy nb nc l nd ne">clear; close; clc;<br/>wdir='./';<br/><br/>fileloc0=[wdir,'II-PFO-BHZ'];<br/>fileloc_ext = '.mat';<br/>fileloc = [fileloc0 fileloc_ext];<br/><br/>if exist(fileloc,'file')<br/>    disp(['File exists ', fileloc]);<br/>    load(fileloc);<br/>    <br/>    all_stats = fieldnames(stats);<br/>    all_data = fieldnames(data);<br/>    <br/>    for id=1<br/>        %% read data and header information<br/>        stats_0 = stats.(all_stats{id});<br/>        data_0 = data.(all_data{id});<br/>        <br/>        sampling_rate = stats_0.('sampling_rate');<br/>        delta = stats_0.('delta');<br/>        starttime = stats_0.('starttime');<br/>        endtime = stats_0.('endtime');<br/>        t1 = datetime(starttime,'InputFormat',"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");<br/>        t2 = datetime(endtime,'InputFormat',"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");<br/>        datetime_array = t1:seconds(delta):t2;<br/>        <br/>        %% Plot waveforms<br/>        fig = figure('Renderer', 'painters', 'Position', [100 100 1000 400], 'color','w');<br/>        plot(t1:seconds(delta):t2, data_0, 'k-')<br/>        title([stats_0.('network'),'-', stats_0.('station'), '-', stats_0.('channel')])<br/>        axis tight;<br/>        print(fig,[fileloc0, '_ts', num2str(id),'.jpg'],'-djpeg')<br/>        data_double = double(data_0);<br/>    <br/>        %% Using sym4<br/>        [XDEN,DENOISEDCFS] = wdenoise(data_double,9,'Wavelet','sym4','DenoisingMethod','BlockJS');<br/>        close;<br/>        <br/>        fig2=figure('Renderer', 'painters', 'Position', [100 100 1000 400], 'color','w');<br/>        plot(data_double,'r')<br/>        hold on;<br/>        plot(XDEN, 'b')<br/>        legend('Original Signal','Denoised Signal')<br/>        axis tight;<br/>        hold off;<br/>        axis tight;<br/>        print(fig2,['denoise_signal_sym49','.jpg'],'-djpeg')<br/>        <br/>        snrsym = -20*log10(norm(abs(data_double-XDEN))/norm(data_double))<br/>        <br/>        %% Using db1<br/>        [XDEN_db1,DENOISEDCFS2] = wdenoise(data_double,9,'Wavelet','db1','DenoisingMethod','BlockJS');<br/>        close;<br/>        <br/>        fig3=figure('Renderer', 'painters', 'Position', [100 100 1000 400], 'color','w');<br/>        plot(data_double,'r')<br/>        hold on;<br/>        plot(XDEN_db1, 'b')<br/>        legend('Original Signal','Denoised Signal')<br/>        axis tight;<br/>        hold off;<br/>        axis tight;<br/>        print(fig3,['denoise_signal_db1','.jpg'],'-djpeg')<br/>        <br/>        snrdb1 = -20*log10(norm(abs(data_double-XDEN_db1))/norm(data_double))<br/><br/>    end<br/>end</span></pre><h1 id="dfd9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">含噪合成数据的小波去噪</h1><p id="a581" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这个例子是从MATLAB的例子中派生出来的。在上述情况下，对于相同的数据，我得到sym4和db1小波的SNR分别为9.6994和9.4954。这也显示了sym4的显著差异。请注意,“sym4”在大多数情况下都能很好地工作，这可能是它被采用为缺省值的原因。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/2689f1179ee4064aa5d7a93aeea9e413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBD3xyoFnSDk8s6OdFMIUA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">MATLAB生成的合成数据小波去噪(图片由作者提供)</p></figure><h1 id="97cc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="7c2a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们已经了解了如何从mseed下载地震波形，将其转换为mat格式，然后使用小波分析进行去噪。我们首先对高频地震时间序列进行小波去噪，但重构后，视觉上差别并不明显。但是从信噪比上，我们可以看出区别。我们还绘制了不同尺度下的小波系数。此外，我在一个合成时间序列上展示了小波去噪的工作原理。</p><h1 id="5c61" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><p id="e6fd" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi"><strong class="ky ir">1. </strong>Wu, W., &amp; Cai, P. (n.d.). Simulation of Wavelet Denoising Based on MATLAB — 《Information and Electronic Engineering》2008年03期. Retrieved May 18, 2021, from <a class="ae kv" href="https://en.cnki.com.cn/Article_en/CJFDTotal-XXYD200803017.htm" rel="noopener ugc nofollow" target="_blank">https://en.cnki.com.cn/Article_en/CJFDTotal-XXYD200803017.htm</a><br/>2. [MATLAB](<a class="ae kv" href="https://www.mathworks.com/?s_tid=gn_logo" rel="noopener ugc nofollow" target="_blank">https://www.mathworks.com/?s_tid=gn_logo</a>)</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="34d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nm">原载于2021年5月18日http://www.earthinversion.com</em><a class="ae kv" href="https://www.earthinversion.com/techniques/how-effective-is-the-signal-denoising-using-the-matlab-based-wavelet-analysis/" rel="noopener ugc nofollow" target="_blank"><em class="nm"/></a><em class="nm">。</em></p></div></div>    
</body>
</html>