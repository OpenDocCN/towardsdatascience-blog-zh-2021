<html>
<head>
<title>A Simple Python Guide To Find Carbon Intensity of Commodities</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">寻找商品碳强度的简单 Python 指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-python-guide-to-find-carbon-intensity-of-commodities-6f973170f64e?source=collection_archive---------16-----------------------#2021-11-29">https://towardsdatascience.com/a-simple-python-guide-to-find-carbon-intensity-of-commodities-6f973170f64e?source=collection_archive---------16-----------------------#2021-11-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="46c0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 ResourceTradeEarth 和 ClimateTrace 数据计算碳强度</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/01fb4ab504e51713f7d4e1f2d8bb0528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ezq1Wo5KJ5wJDBxfPsrTRA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://www.pexels.com/photo/yellow-excavator-2101137/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae ky" href="https://www.pexels.com/@tomfisk?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">汤姆·菲斯克</a>的照片</p></figure><h1 id="39fc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">文件和数据</h1><h2 id="a1a5" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">ClimateTrace</h2><ol class=""><li id="13d2" class="mg mh it mi b mj mk ml mm lw mn lz mo mc mp mq mr ms mt mu bi translated"><a class="ae ky" href="https://www.climatetrace.org/inventory?sector=all&amp;time=2015-2020&amp;country=all-countries" rel="noopener ugc nofollow" target="_blank">数据</a></li></ol><h2 id="fd16" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">资源贸易地球:</h2><ol class=""><li id="17a7" class="mg mh it mi b mj mk ml mm lw mn lz mo mc mp mq mr ms mt mu bi translated"><a class="ae ky" href="https://resourcetrade.earth/?year=2019&amp;units=weight&amp;autozoom=1" rel="noopener ugc nofollow" target="_blank">数据</a></li><li id="5092" class="mg mh it mi b mj mv ml mw lw mx lz my mc mz mq mr ms mt mu bi translated"><a class="ae ky" href="https://resourcetrade.earth/about" rel="noopener ugc nofollow" target="_blank">文档</a></li></ol><h2 id="f9fe" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">此会话中使用的 GitHub 数据集</h2><ol class=""><li id="2912" class="mg mh it mi b mj mk ml mm lw mn lz mo mc mp mq mr ms mt mu bi translated"><a class="ae ky" href="https://github.com/neldivad/emission-intensity" rel="noopener ugc nofollow" target="_blank">数据</a></li></ol></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="64f2" class="kz la it bd lb lc nh le lf lg ni li lj jz nj ka ll kc nk kd ln kf nl kg lp lq bi translated">外卖食品</h1><p id="0bfc" class="pw-post-body-paragraph nm nn it mi b mj mk ju no ml mm jx np lw nq nr ns lz nt nu nv mc nw nx ny mq im bi translated">建立一个排放估算模型是非常具有挑战性的，即使应用于高质量的数据集，由于必须做出大量的假设。由于缺乏准确性、清晰度和对数据的理解，这种分析很难用于决策目的。</p><p id="4d6e" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">目前的方法是从交易的重量/价值，而不是生产/消费，得出碳强度。因此，这将导致对碳强度的更高估计。</p><p id="cbd0" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">它将主要作为将来如何使用 Python 对类似数据集进行分析的指南。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="f32b" class="kz la it bd lb lc nh le lf lg ni li lj jz nj ka ll kc nk kd ln kf nl kg lp lq bi translated">介绍</h1><p id="695a" class="pw-post-body-paragraph nm nn it mi b mj mk ju no ml mm jx np lw nq nr ns lz nt nu nv mc nw nx ny mq im bi translated">排放数据一直很难估计。迄今为止，大多数排放清单都是基于自我报告的。报告的排放数据往往有很大的时滞，估算的方法也往往相互不一致。Climate TRACE 的任务是使用人工智能(AI)和机器学习(ML)技术为卫星/传感器数据提供每个部门的最新排放数据。</p><p id="3fa1" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">据推测，碳排放可以通过关于每种商品的生产水平和每个不同国家在生产商品时的局部碳强度的足够信息来准确确定。然而，这两种数据都很难获得。</p><p id="0aba" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">我的方法是，通过将发现的排放量与交易的商品进行对比，找到与商品相关的平均碳强度，从而逆向计算方程式。</p><h1 id="4c5e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据分析</h1><h2 id="567e" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">助手函数和库</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="c5a8" class="lr la it of b gy oj ok l ol om">import warnings<br/>import numpy as np <br/>import pandas as pd<br/>import plotly as py<br/>import seaborn as sns<br/>import statistics as stat<br/>from datetime import date</span><span id="e013" class="lr la it of b gy on ok l ol om">import plotly.express as px<br/>import plotly.graph_objs as go<br/>warnings.filterwarnings("ignore")<br/>pd.set_option('display.max_columns', None)</span><span id="87d0" class="lr la it of b gy on ok l ol om">import plotly.offline as pyo<br/>pyo.init_notebook_mode()</span><span id="5497" class="lr la it of b gy on ok l ol om">import matplotlib.lines as lines<br/>import matplotlib.pyplot as plt</span><span id="c95e" class="lr la it of b gy on ok l ol om">%matplotlib inline</span></pre><p id="3700" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated"><strong class="mi iu">显示/隐藏按钮</strong></p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="987a" class="lr la it of b gy oj ok l ol om">import random<br/>from IPython.display import HTML</span><span id="9c4d" class="lr la it of b gy on ok l ol om">def hide_toggle(for_next=False):<br/>    this_cell = """$('div.cell.code_cell.rendered.selected')""" ; next_cell = this_cell + '.next()';<br/>    toggle_text = 'Code show/hide'  # text shown on toggle link<br/>    target_cell = this_cell ;  js_hide_current = ''</span><span id="6f31" class="lr la it of b gy on ok l ol om">if for_next:<br/>        target_cell = next_cell; toggle_text += ' next cell';<br/>        js_hide_current = this_cell + '.find("div.input").hide();'<br/>    js_f_name = 'code_toggle_{}'.format(str(random.randint(1,2**64)))</span><span id="f085" class="lr la it of b gy on ok l ol om">html = """&lt;script&gt;<br/>            function {f_name}() {{{cell_selector}.find('div.input').toggle(); }}<br/>            {js_hide_current}<br/>        &lt;/script&gt;<br/>        &lt;a href="javascript:{f_name}()"&gt;{toggle_text}&lt;/a&gt;<br/>    """.format(f_name=js_f_name,cell_selector=target_cell,js_hide_current=js_hide_current, toggle_text=toggle_text )<br/>    return HTML(html)</span><span id="5179" class="lr la it of b gy on ok l ol om">hide_toggle()</span></pre><h1 id="a263" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">ClimateTrace 的排放数据</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="77cf" class="lr la it of b gy oj ok l ol om">file = 'climatetrace_emissions_by_subsector_timeseries_interval_year_since_2015_to_2020.csv'</span><span id="93d0" class="lr la it of b gy on ok l ol om">df = pd.read_csv(PATH + file)</span><span id="3d9a" class="lr la it of b gy on ok l ol om">df[‘year’] = pd.DatetimeIndex(df[‘start’]).year<br/>df[‘month’] = pd.DatetimeIndex(df[‘start’]).month</span><span id="31f8" class="lr la it of b gy on ok l ol om">co2 = pd.DataFrame( df.groupby(['sector', 'subsector', 'year'])['Tonnes Co2e'].sum() ) \<br/>.reset_index() <br/>    # wow magic line</span><span id="9766" class="lr la it of b gy on ok l ol om">pd.set_option('display.max_rows', 250)<br/>co2</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/78f00cc5a5989aa8f7046464ec9e7e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/0*mylkMBLPnaoTQL_X.JPG"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="9718" class="lr la it of b gy oj ok l ol om">def make_bar_plot(data, xdata, ydata, cdata, title, legend=True, width=900, height=600):<br/>    import plotly.express as px</span><span id="e1ca" class="lr la it of b gy on ok l ol om">fig = px.bar(data, <br/>                 x= xdata, <br/>                 y= ydata, <br/>                 color= cdata, <br/>                 )</span><span id="d06f" class="lr la it of b gy on ok l ol om">fig.update_layout(<br/>        title= title,<br/>        xaxis_tickfont_size=14,<br/>        yaxis=dict(<br/>            title='',<br/>            titlefont_size=16,<br/>            tickfont_size=14,<br/>        ),<br/>        legend=dict(<br/>            x=0.995,<br/>            y=0.98,<br/>            bgcolor='rgba(255, 255, 255, 0)',<br/>            bordercolor='rgba(255, 255, 255, 0)',<br/>        ),<br/>        showlegend= legend,<br/>        height= height,<br/>        width= width,<br/>        barmode='group', #'stack',<br/>        bargap=0.25, <br/>        bargroupgap=0.1 <br/>    )</span><span id="67d3" class="lr la it of b gy on ok l ol om">fig.show()<br/>    <br/>hide_toggle()</span></pre><h2 id="4042" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">按国家</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="2318" class="lr la it of b gy oj ok l ol om">make_bar_plot(df[ df['country'].isin(['USA']) &amp;  df['year'].isin([2015, 2016, 2017, 2018, 2019]) ], <br/>              xdata='year', <br/>              ydata='Tonnes Co2e', <br/>              cdata='sector', <br/>              title='Co2 Emissions by USA')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/cc60d96167dadeba074935d36b99b811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5_I6Rqhmm-CzcxnE.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2fbb" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">图表中的数字应该与 Climate TRACE live 网站上的数字完全一样。我们可以尝试更进一步，深入到每个部门和子部门。</p><h2 id="a8c1" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">按部门和分部门</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="5595" class="lr la it of b gy oj ok l ol om">make_bar_plot(co2[ co2['year'].isin([2015, 2016, 2017, 2018, 2019]) ], <br/>              xdata='year', <br/>              ydata='Tonnes Co2e', <br/>              cdata='sector', <br/>              title='Co2 Emissions by Sector')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/8ebe0391859c1130bd82b796b89d32bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WyiAhs-H18vEG1Ad.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="f70b" class="lr la it of b gy oj ok l ol om">make_bar_plot(co2[ co2['sector'].isin(['agriculture']) &amp;  co2['year'].isin([2015, 2016, 2017, 2018, 2019]) ], <br/>              xdata='year', <br/>              ydata='Tonnes Co2e', <br/>              cdata='subsector', <br/>              title='Co2 Emissions by Subsector (Agriculture)')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/4260e79c19fffdee715c116d5ab9ee0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B7bPOqTSuIFNwGjL.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="6335" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">资源贸易地球的商品贸易数据</h1><p id="c8ba" class="pw-post-body-paragraph nm nn it mi b mj mk ju no ml mm jx np lw nq nr ns lz nt nu nv mc nw nx ny mq im bi translated">ResourceTradeEarth 按年份提供商品交易价值和重量的数据。该网站是由查塔姆研究所开发的，他们的数据是从国际商品贸易统计(IMTS)中获得的精确版本。</p><p id="a311" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">随后，IMTS 数据由国家海关当局收集，并由联合国统计司编入联合国商品贸易统计数据库。</p><p id="0dc7" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">现在我们已经有了来自 Climate TRACE 的排放数据，我们的目标是通过将商品部门从 Climate race 结果产生的排放量除以从 ResourceTradeEarth 获得的交易价值/重量结果来估计每种商品的排放强度。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="c35d" class="lr la it of b gy oj ok l ol om">export = pd.read_csv(PATH + SUBPATH + 'rte-exporters-2019.csv', <br/>                     encoding= 'ISO 8859-1')<br/>importe= pd.read_csv(PATH + SUBPATH + 'rte-importers-2019.csv', <br/>                     encoding= 'ISO 8859-1')</span><span id="104b" class="lr la it of b gy on ok l ol om">commodities = pd.read_csv(PATH + SUBPATH + 'rte-commodities-2019.csv', <br/>                          encoding= 'ISO 8859-1')</span><span id="39ac" class="lr la it of b gy on ok l ol om">commodities.drop(['Exporter M.49', 'Exporter ISO3', 'Exporter region', <br/>                  'Importer M.49', 'Importer ISO3', 'Importer region'], axis=1, inplace=True)</span><span id="f540" class="lr la it of b gy on ok l ol om">trend = commodities.sort_values(by=['Resource', 'Year'], ascending=True)</span><span id="343f" class="lr la it of b gy on ok l ol om"># Create differenced column<br/>trend['dvalue_share'] = trend.groupby('Resource')['value share'].diff()<br/>trend['dweight_share'] = trend.groupby('Resource')['weight share'].diff()</span></pre><h2 id="cdec" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">按重量绘图</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="8840" class="lr la it of b gy oj ok l ol om">make_bar_plot(commodities, 'Year', 'Weight (1000kg)', 'Resource', 'Weight (1000kg) Traded by Commodities')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/682de0f22ea55eefaa297b6fb0a0ccea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KTjwm4j-ZYxF3W7S.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="9cdc" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">按价值/重量份额绘图</h2><p id="f2b1" class="pw-post-body-paragraph nm nn it mi b mj mk ju no ml mm jx np lw nq nr ns lz nt nu nv mc nw nx ny mq im bi translated">使用以下等式估算以下变量:</p><blockquote class="oq or os"><p id="68cf" class="nm nn ot mi b mj nz ju no ml oa jx np ou ob nr ns ov oc nu nv ow od nx ny mq im bi translated">价值份额 _2015 =资源价值 _2015 /价值总和 _2015</p><p id="dcdc" class="nm nn ot mi b mj nz ju no ml oa jx np ou ob nr ns ov oc nu nv ow od nx ny mq im bi translated">权重份额 _2015 =资源权重 _2015 /权重总和 _2015</p></blockquote><p id="ba7d" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">这个想法是不同的商品在生产和交易过程中有不同的碳强度。我们想知道我们的商品贸易中有多大比例是高碳密度的。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="1274" class="lr la it of b gy oj ok l ol om">make_bar_plot(commodities, 'Year', 'value share', 'Resource', 'Value Share By Traded Commodities')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/c476d3951d3817f97bc1ad333b830dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ECpaWMRfWTwbn3lv.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="efed" class="lr la it of b gy oj ok l ol om">make_bar_plot(commodities, 'Year', 'weight share', 'Resource', 'Weight Share By Traded Commodities')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/c6c76ede09566378a8a4e24ec25ef701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_2yz4K4zJGqV0lL5.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="f6f7" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">按商品和年份分列的价值/重量份额的变化</h2><p id="2f3e" class="pw-post-body-paragraph nm nn it mi b mj mk ju no ml mm jx np lw nq nr ns lz nt nu nv mc nw nx ny mq im bi translated">如果企业的目标是利润最大化，同时排放最少，一些人可能会对按交易价值计算的碳强度感兴趣。然而，这很容易被大宗商品价格扭曲。</p><p id="d934" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">如果一种商品的交易价值份额下降，而交易重量份额保持不变或上升，这意味着价格对该商品越来越不利。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="21bb" class="lr la it of b gy oj ok l ol om">trend</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/0280a568b8d67f2a15134ad1fb0be56a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/0*_q5oUZeH9qYXM7IC.JPG"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="023f" class="lr la it of b gy oj ok l ol om">def make_line_plot(data, xdata, ydata, cdata, title, legend=True, width=900, height=600):<br/>    import plotly.express as px</span><span id="e94d" class="lr la it of b gy on ok l ol om">fig = px.line(data, <br/>                  x= xdata,<br/>                  y= ydata, <br/>                  color= cdata, <br/>                  symbol= cdata,<br/>                 )</span><span id="8322" class="lr la it of b gy on ok l ol om">fig.update_layout(<br/>        title= title,<br/>        xaxis_tickfont_size=14,<br/>        yaxis=dict(<br/>            title='',<br/>            titlefont_size=16,<br/>            tickfont_size=14,<br/>        ),<br/>        legend=dict(<br/>            x=1.02,<br/>            y=0.98,<br/>            bgcolor='rgba(255, 255, 255, 0)',<br/>            bordercolor='rgba(255, 255, 255, 0)',<br/>        ),<br/>        showlegend= legend,<br/>        height= height,<br/>        width= width,<br/>    )</span><span id="cd5b" class="lr la it of b gy on ok l ol om">fig.show()</span><span id="d15f" class="lr la it of b gy on ok l ol om">hide_toggle()</span></pre><h2 id="85d4" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated"><strong class="ak">价值份额变化</strong></h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="3dea" class="lr la it of b gy oj ok l ol om">make_line_plot(trend, <br/>               'Year', <br/>               'dvalue_share', <br/>               'Resource', <br/>               'Value Share Change By Traded Commodities')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/69a35c15ff24117a3c07c2f654aa3dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lH5I9Efym0Vc3hAD.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="ab69" class="lr la it of b gy oj ok l ol om">make_line_plot(trend[ ~trend['Resource'].isin(['Pearls and gemstones']) ], <br/>              'Year', <br/>              'dweight_share', <br/>              'Resource', <br/>              'Weight Share Change By Traded Commodities')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/8dca744d769bd1ef72fdeeb66eac56ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-9Nu6nNVl3_h6WT2.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="69a7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">估算商品的碳强度</h1><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="cfb2" class="lr la it of b gy oj ok l ol om">co2 = pd.DataFrame( df.groupby(['sector', 'year'])['Tonnes Co2e'].sum() ) \<br/>.reset_index() # wow magic line</span><span id="00cd" class="lr la it of b gy on ok l ol om"># Agriculture<br/>agri = trend[ trend['Resource'].isin(['Agricultural products']) ]<br/>agri2 = co2[ co2['sector'].isin(['agriculture']) &amp; ~co2['year'].isin([2020]) ]</span></pre><p id="f2bf" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">有了排放和交易数据的信息，我们可以将它们结合到一个数据框架中。这里，我们假设:</p><ol class=""><li id="429b" class="mg mh it mi b mj nz ml oa lw oy lz oz mc pa mq mr ms mt mu bi translated"><code class="fe pb pc pd of b">Agricultural products</code>RTE 的商品与<code class="fe pb pc pd of b">agriculture</code>部门的气候微量排放相关。</li><li id="85da" class="mg mh it mi b mj mv ml mw lw mx lz my mc mz mq mr ms mt mu bi translated"><code class="fe pb pc pd of b">Fossil fuels</code>商品与<code class="fe pb pc pd of b">oil and gas</code>排放有关。</li><li id="ab34" class="mg mh it mi b mj mv ml mw lw mx lz my mc mz mq mr ms mt mu bi translated"><code class="fe pb pc pd of b">Metals and minerals</code>商品与<code class="fe pb pc pd of b">extraction</code>排放有关。</li></ol><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="3b80" class="lr la it of b gy oj ok l ol om">agriculture = pd.concat([agri.reset_index(drop=True), <br/>                         agri2['Tonnes Co2e'].reset_index(drop=True)],<br/>                        axis= 1) <br/>agriculture['co2 vintensity'] = agriculture['Tonnes Co2e'] / agriculture['Value (1000USD)']<br/>agriculture['co2 wintensity'] = agriculture['Tonnes Co2e'] / agriculture['Weight (1000kg)']</span><span id="d90a" class="lr la it of b gy on ok l ol om"># Oil and gas<br/>oil = trend[ trend['Resource'].isin(['Fossil fuels']) ]<br/>oil2 = co2[ co2['sector'].isin(['oil and gas']) &amp; ~co2['year'].isin([2020]) ]</span><span id="6f50" class="lr la it of b gy on ok l ol om">fossilfuel = pd.concat([oil.reset_index(drop=True), <br/>                         oil2['Tonnes Co2e'].reset_index(drop=True)],<br/>                        axis= 1)<br/>                        <br/>fossilfuel['co2 vintensity'] = fossilfuel['Tonnes Co2e'] / fossilfuel['Value (1000USD)']<br/>fossilfuel['co2 wintensity'] = fossilfuel['Tonnes Co2e'] / fossilfuel['Weight (1000kg)']</span><span id="0933" class="lr la it of b gy on ok l ol om"># Metals and Minerals<br/>metal = trend[ trend['Resource'].isin(['Metals and minerals']) ]<br/>metal2 = co2[ co2['sector'].isin(['extraction']) &amp; ~co2['year'].isin([2020]) ]</span><span id="fb5c" class="lr la it of b gy on ok l ol om">extraction = pd.concat([metal.reset_index(drop=True), <br/>                        metal2['Tonnes Co2e'].reset_index(drop=True)],<br/>                        axis= 1)</span><span id="55bc" class="lr la it of b gy on ok l ol om">extraction['co2 vintensity'] = extraction['Tonnes Co2e'] / extraction['Value (1000USD)']<br/>extraction['co2 wintensity'] = extraction['Tonnes Co2e'] / extraction['Weight (1000kg)']</span><span id="e8df" class="lr la it of b gy on ok l ol om"># All commodities<br/>allcomm = pd.concat([agriculture, fossilfuel, extraction], axis=0)<br/>allcomm</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/60f4ed754c5d4c9498122020911a56db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*11v33B0DMQLu9ESU.JPG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="d4a6" class="lr la it of b gy oj ok l ol om">make_line_plot(allcomm,<br/>              'Year', <br/>              'co2 wintensity', <br/>              'Resource', <br/>              'Carbon Intensity by Weight, by Commodities')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/70f539544ee27b73411633d28fbb25eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_kfcyrLry7wRb085.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="1a48" class="lr la it of b gy oj ok l ol om">make_line_plot(allcomm,<br/>              'Year', <br/>              'co2 vintensity', <br/>              'Resource', <br/>              'Carbon Intensity by Value, by Commodities')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/e1425841bed04c22e9e2c57b289e2f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1VY3pOlgE0hxysgZ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4e94" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">结果不令人满意。以下是一些问题:</p><ol class=""><li id="d752" class="mg mh it mi b mj nz ml oa lw oy lz oz mc pa mq mr ms mt mu bi translated">金属和矿物的碳强度数据非常低，你实际上从图表中看不出来。原因是来自<strong class="mi iu">气候跟踪的开采部门的 CO2 排放数据没有更新，特别是来自煤炭开采部门的数据。</strong></li><li id="e6b0" class="mg mh it mi b mj mv ml mw lw mx lz my mc mz mq mr ms mt mu bi translated">化石燃料和金属的碳密度数据非常低。尚不清楚我们是否还应包括同样受到这些商品影响的其他部门的排放量。(例如:化石燃料的电力和运输，金属的制造)。</li><li id="fe5b" class="mg mh it mi b mj mv ml mw lw mx lz my mc mz mq mr ms mt mu bi translated">由于碳强度来源于交易的重量/价值，因此<strong class="mi iu">没有考虑国内消费的商品</strong>，导致对碳强度的估计要高得多。在我们的图表中，农产品碳强度的上升趋势可能意味着国内对农产品的消费将会增加。</li><li id="5383" class="mg mh it mi b mj mv ml mw lw mx lz my mc mz mq mr ms mt mu bi translated">同一种商品的碳强度在很大程度上取决于生产地。由于垂直农业技术，与欧洲生产的农产品相比，非洲农业单位产量的碳密度可能更高。</li></ol><p id="dddf" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">虽然我们最终没有做出任何有意义的结论，但我希望这能激励其他人采取更好的方法来处理这个问题。</p><p id="7b2c" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">如果您有任何错误或建议希望引起我的注意，请随时留下任何评论。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="2100" class="kz la it bd lb lc nh le lf lg ni li lj jz nj ka ll kc nk kd ln kf nl kg lp lq bi translated">参考:</h1><p id="330a" class="pw-post-body-paragraph nm nn it mi b mj mk ju no ml mm jx np lw nq nr ns lz nt nu nv mc nw nx ny mq im bi translated">[1]查塔姆研究所(2021)，'<em class="ot"> resourcetrade.earth </em>'，<a class="ae ky" href="https://resourcetrade.earth/" rel="noopener ugc nofollow" target="_blank">https://resourcetrade.earth/</a></p><p id="e5d8" class="pw-post-body-paragraph nm nn it mi b mj nz ju no ml oa jx np lw ob nr ns lz oc nu nv mc od nx ny mq im bi translated">[2]气候追踪(2021 年)，<a class="ae ky" href="https://www.climatetrace.org/" rel="noopener ugc nofollow" target="_blank">https://www.climatetrace.org/</a></p></div></div>    
</body>
</html>