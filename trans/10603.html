<html>
<head>
<title>Dynamic Mode Decomposition for Multivariate Time Series Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元时间序列预测的动态模式分解</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dynamic-mode-decomposition-for-multivariate-time-series-forecasting-415d30086b4b?source=collection_archive---------10-----------------------#2021-10-11">https://towardsdatascience.com/dynamic-mode-decomposition-for-multivariate-time-series-forecasting-415d30086b4b?source=collection_archive---------10-----------------------#2021-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6119" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Numpy的DMD预测的Python实现</h2></div><p id="31f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">动态模式分解(DMD)是由<em class="lb"> Peter Schmid </em>于2008年开发的一种数据驱动的降维算法(论文发表于2010年，见[1，2])，类似于矩阵分解和主成分分析(PCA)算法。给定一个多元时间序列数据集，DMD计算一组动态模式，其中每个模式都与一个固定的振荡频率和衰减/增长率相关联。由于每种动态模式下固有的时间行为，DMD确实不同于通常使用的降维算法，如PCA。DMD允许人们用物理上有意义的模式来解释数据的时间行为。一个重要的特征是DMD能够执行多元时间序列预测。在现有的工作中，DMD模型在时空流体流动分析中有广泛的应用(例如见图1)。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/2e182e62192197ffcce846413d1a2355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TVc4E47ChBJ8W5zWsbAf_w.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">图一。流体流动数据集上DMD的示意图。DMD书[3]中的一个例子。</p></figure><p id="6f4c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本帖中，我们将介绍DMD算法的预备知识，并讨论如何用Numpy在Python中再现DMD。然后，为了更好地理解DMD，我们设计了一个玩具示例实验来执行多变量时间序列预测。下面的内容玩得开心！:)</p><blockquote class="ls lt lu"><p id="d0d7" class="kf kg lb kh b ki kj jr kk kl km ju kn lv kp kq kr lw kt ku kv lx kx ky kz la ij bi translated">如果你对图1所示的流体动力学分析感兴趣，在https://medium.com/p/d84065fead4d的<a class="ae ly" href="https://medium.com/p/d84065fead4d" rel="noopener">也有一篇博文。这篇文章介绍了如何用Python中的张量分解算法重建流体动力学。另一篇关于用DMD模型从流体流动数据中发现空间模式的博文在</a><a class="ae ly" href="https://medium.com/@xinyu.chen/reproducing-dynamic-mode-decomposition-on-fluid-flow-data-in-python-94b8d7e1f203" rel="noopener">https://medium . com/@ Xinyu . Chen/reproducing-dynamic-mode-decomposition-on-fluid-flow-data-in-python-94 b 8d 7 E1 f 203</a>。</p></blockquote><h1 id="56b7" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">DMD的模型描述</h1><p id="c3f0" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">DMD与向量自回归(VAR)模型有很强的联系。VAR是一个经典的统计模型，用于捕捉多元时间序列数据的协同进化模式，在经济学和金融学中有着广泛的应用。给定时间序列数据<strong class="kh ir"> <em class="lb"> X </em> </strong>的大小<em class="lb"> N </em> -by- <em class="lb"> T </em>其中<em class="lb"> N </em>是变量的数量，<em class="lb"> T </em>是时间步长的数量，则在任何时间步长<em class="lb"> t </em>中，一阶VAR或VAR(1)的形式为</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mw"><img src="../Images/da8c79beda1ae0304c18ee4f068ec2d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jb1feJ1DIXN9uxnjT7S0g.png"/></div></div></figure><p id="eae8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<strong class="kh ir"> <em class="lb"> x </em> </strong> <em class="lb"> t </em>表示时间<em class="lb"> t </em>中的快照向量，大小为<em class="lb">N</em>-1。<strong class="kh ir"> <em class="lb"> A </em> </strong>是系数矩阵，大小为<em class="lb"> N </em> -by- <em class="lb"> N </em>。</p><p id="4d35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在VAR(1)模型中，建模目标是找到一个表现良好的系数矩阵，并使用它来表示时间相关性。在标准的DMD模型中，我们也采用VAR(1)的形式。为了计算系数，第一个脉冲是将上面的等式重写如下，</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mx"><img src="../Images/419078b056497de5740735b1b7af0e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R69m3VqTxMv80KimEJbvdQ.png"/></div></div></figure><p id="2874" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中我们在等式中定义了以下矩阵:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi my"><img src="../Images/a89b26f7243d9b88f6f4da0af951dc38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5MhOJYQ7F776AZvzRR3hPw.png"/></div></div></figure><p id="e6f9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与VAR(1)不同，DMD不显式计算系数矩阵。在DMD中，有一个低秩结构来逼近VAR(1)中的系数矩阵，它就是Koopman矩阵。</p><h1 id="7f5f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">DMD算法</h1><p id="4bee" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在DMD中，获得Koopman矩阵并实现预测任务并不困难。DMD中最重要的工具是奇异值分解和特征值分解。为了<strong class="kh ir">计算库普曼矩阵</strong>，只有两个步骤应该遵循:</p><ul class=""><li id="72cf" class="mz na iq kh b ki kj kl km ko nb ks nc kw nd la ne nf ng nh bi translated">对数据矩阵<strong class="kh ir"> <em class="lb"> X </em> </strong> 1进行奇异值分解:</li></ul><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mw"><img src="../Images/305f88d84019cd9ecf5cb07e1f1fe6c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XwGN4IuSEkUvwKGcYGMoeQ.png"/></div></div></figure><p id="2fca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<strong class="kh ir"> <em class="lb"> U </em> </strong>由左奇异向量组成，<strong class="kh ir"> <em class="lb"> V </em> </strong>由右奇异向量组成，<strong class="kh ir">σ</strong>由其对角线上的奇异值组成。</p><ul class=""><li id="a6f5" class="mz na iq kh b ki kj kl km ko nb ks nc kw nd la ne nf ng nh bi translated">使用某个预定义的秩<em class="lb"> r </em>实现截断奇异值分解，并通过下式计算库普曼矩阵</li></ul><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ni"><img src="../Images/23855cef1718047c3b067908263c7f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZj6_7g6kLGSZcjxCYK4gA.png"/></div></div></figure><p id="6987" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如上所述，DMD可以通过动态模式探索可解释的时间行为。如果想要<strong class="kh ir">计算动态模式</strong>，请遵循以下步骤:</p><ul class=""><li id="3617" class="mz na iq kh b ki kj kl km ko nb ks nc kw nd la ne nf ng nh bi translated">对库普曼矩阵进行特征值分解:</li></ul><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nj"><img src="../Images/ed760767b4a4cc0a8a49eab5086aa86a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODRCYMdrrviwiTjdiJam5Q.png"/></div></div></figure><p id="afe6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<strong class="kh ir"> <em class="lb"> Q </em> </strong>由特征向量组成，<strong class="kh ir">φ</strong>由特征值组成。</p><p id="9d1f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">DMD模式也称为动态模式，是特征向量。特征值总是以复共轭对的形式出现，可以解释为DMD谱。</p><p id="4606" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面，我们得到了库普曼矩阵，动态模式，DMD谱。一个问题是如何进行多元时间序列预测。我们可以采用以下两个等式来回答这个问题:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mw"><img src="../Images/6dc8c7ffe4e59096129776267d0527fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9B8IZOo7MUFx5qnth2JTDw.png"/></div></div></figure><p id="8677" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们有了VAR(1)中提到的系数矩阵<strong class="kh ir"> <em class="lb"> A </em> </strong>。因此，可以实现时间序列预测任务。下面是DMD算法的Python代码。我们通过使用Numpy来重现它，这样就很容易理解了。</p><pre class="ld le lf lg gt nk nl nm nn aw no bi"><span id="9a10" class="np ma iq nl b gy nq nr l ns nt">import numpy as np</span><span id="b597" class="np ma iq nl b gy nu nr l ns nt">def DMD(data, r):<br/>    """Dynamic Mode Decomposition (DMD) algorithm."""<br/>    <br/>    ## Build data matrices<br/>    X1 = data[:, : -1]<br/>    X2 = data[:, 1 :]<br/>    ## Perform singular value decomposition on X1<br/>    u, s, v = np.linalg.svd(X1, full_matrices = False)<br/>    ## Compute the Koopman matrix<br/>    A_tilde = u[:, : r].conj().T @ X2 @ v[: r, :].conj().T * np.reciprocal(s[: r])<br/>    ## Perform eigenvalue decomposition on A_tilde<br/>    Phi, Q = np.linalg.eig(A_tilde)<br/>    ## Compute the coefficient matrix<br/>    Psi = X2 @ v[: r, :].conj().T @ np.diag(np.reciprocal(s[: r])) @ Q<br/>    A = Psi @ np.diag(Phi) @ np.linalg.pinv(Psi)<br/>    <br/>    return A_tilde, Phi, A</span></pre><p id="10a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出包括库普曼矩阵、特征值和系数矩阵。</p><h1 id="97a8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">DMD预测的一个玩具示例</h1><p id="cdd8" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">让我们考虑下面的玩具例子。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nv"><img src="../Images/f852e3e5f0f5837d3bd86a2fac8b318d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VBGPjIZX1FjuUkD3IBoqjQ.png"/></div></div></figure><pre class="ld le lf lg gt nk nl nm nn aw no bi"><span id="7be4" class="np ma iq nl b gy nq nr l ns nt">import numpy as np</span><span id="3949" class="np ma iq nl b gy nu nr l ns nt">def DMD4cast(data, r, pred_step):<br/>    N, T = data.shape<br/>    _, _, A = DMD(data, r)<br/>    mat = np.append(data, np.zeros((N, pred_step)), axis = 1)<br/>    for s in range(pred_step):<br/>        mat[:, T + s] = (A @ mat[:, T + s - 1]).real<br/>    return mat[:, - pred_step :]</span></pre><p id="cca6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在此处编写代码:</p><pre class="ld le lf lg gt nk nl nm nn aw no bi"><span id="7933" class="np ma iq nl b gy nq nr l ns nt">X = np.zeros((2, 10))<br/>X[0, :] = np.arange(1, 11)<br/>X[1, :] = np.arange(2, 12)<br/>pred_step = 2<br/>r = 2<br/>mat_hat = DMD4cast(X, r, pred_step)<br/>print(mat_hat)</span></pre><p id="86c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行它，输出是</p><pre class="ld le lf lg gt nk nl nm nn aw no bi"><span id="2641" class="np ma iq nl b gy nq nr l ns nt">[[11. 12.]<br/> [12. 13.]]</span></pre><p id="9af4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以看出，DMD预测与地面实况数据完全相同。</p><h1 id="3afb" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">简短的总结</h1><p id="1d92" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">这是一篇简单的文章，介绍DMD算法及其在多变量时间序列预测任务中的应用。从公式上看，DMD确实是一个降秩的VAR模型，可以解决高维时间序列数据中的过参数化问题。DMD相对于VAR还有其他一些优势。例如，DMD由于其解释而在时空数据分析中受到广泛关注。或者，我们也可以使用时间矩阵分解模型(组件包括矩阵分解和VAR)来解决过度参数化问题。有一篇博文(见<a class="ae ly" href="https://medium.com/p/b1c59faf05ea" rel="noopener">https://medium.com/p/b1c59faf05ea</a>)讨论了用时间矩阵分解进行流体动力学预测。</p><p id="7901" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢你阅读这篇文章！如果你有任何问题，请告诉我！</p><h1 id="13c0" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">参考</h1><p id="2920" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">[1]彼得·施密德(2010年)。数值和实验数据的动态模式分解流体力学杂志，656:5–28。</p><p id="c976" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[2]维基百科上的动态模式分解:【https://en.wikipedia.org/wiki/Dynamic_mode_decomposition T2】</p><p id="c655" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[3] J .内森·库茨，史蒂文·l·布伦顿，宾尼·w·布伦顿，约书亚·l·普罗克特(2016)。复杂系统的数据驱动建模。暹罗。</p></div></div>    
</body>
</html>