<html>
<head>
<title>cCorrGAN: Conditional Correlation GAN for Learning Empirical Conditional Distributions in the Elliptope</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">cCorrGAN:学习椭圆曲线中经验条件分布的条件相关GAN</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ccorrgan-conditional-correlation-gan-for-learning-empirical-conditional-distributions-in-the-bfb3cff049b2?source=collection_archive---------21-----------------------#2021-10-06">https://towardsdatascience.com/ccorrgan-conditional-correlation-gan-for-learning-empirical-conditional-distributions-in-the-bfb3cff049b2?source=collection_archive---------21-----------------------#2021-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="36ac" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">金融中的生成模型:动机与挑战</h2></div><p id="cd6b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于隐私、监管和业务要求，在金融服务机构中共享金融数据受到严格限制，包括内部(在机构的职能部门之间，或在授权访问前使用数据)和外部(与研究机构)[6]。因此，生成真实合成数据的方法至关重要，尤其是在缺乏历史数据以及数据匿名至关重要的情况下。例如，缺乏各种市场条件下的股票市场时间序列数据，本质上是因为只有一个“历史”。这使得很难对不同情景下的投资组合进行压力测试。</p><p id="00f2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">生成真实的数据集需要定义数据集之间的适当距离，并测量它们的接近程度。虽然金融数据可以大致分为零售银行数据(通常为表格形式)和市场微观结构数据(通常为时间序列形式),但这里我们将重点关注生成市场微观结构数据(近似为经验金融相关矩阵(CM))。生成多变量时间序列数据是一个更具挑战性的问题，因为它涉及到捕捉单变量时间序列之间的依赖结构，以及其他特征，如自相关和分布属性[1]。经验CMs在多元金融时间序列的研究中是开创性的，并且在资产配置的风险管理中是重要的。CMs在金融领域有很多应用，比如测试交易策略的稳健性，对投资组合进行压力测试，或者客观地比较经验方法。合成CMs还应该展示真实数据的经验属性，称为风格化事实(SF)。到目前为止，科幻小说只是被定性地评价，还没有被浓缩成一个单一的指标。</p><h1 id="8a71" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">FCMs的数学直觉</h1><p id="3ca7" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">我们将通过转向Markowitz的最优投资组合理论来获得对金融相关矩阵的直觉。这一理论表明，通过优化每项资产的权重(即投资于该资产的资本量)，可以在给定总回报的情况下最小化风险，从而找到最佳投资组合。形式上[4]:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/b3051eccbcd9957f750651f5becc1002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*2Wqys5_MIVYIR50ctG-sig.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者图片</p></figure><p id="e866" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用总方差来描述投资组合的总风险[4]</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/07668f9b84e4b207a4d08aa5c866d419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-hEOHEEH_Z3RmIS60ybUg.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者图片</p></figure><p id="a071" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">投资组合中资产的最佳平衡是使固定投资组合回报的方差最小化。风险最小的投资组合在具有最小特征值的协方差矩阵的特征向量上具有很大的权重。这可以被解释为在具有最小方差(相关特征值)的N个不相关投资组合(协方差矩阵的特征向量)上投资最多的资本[4]。随机矩阵理论(RMT)是应用于随机变量矩阵的概率分析的一个分支，当应用于金融CMs时，它的许多结果是有用的。在[4]中，作者使用RMT通过部分去除噪声来清理经验CMs。如果T与N的比率很小，即如果有限时间序列长度与投资组合中的资产数量相比很小，则相关性不太可能包含有用的信息，或者更可能是有噪声的。这种获得相关矩阵的方法需要计算它们，然后执行“清理”过程。不干净的CMs低估了真实风险，尽管干净的CMs在优化投资组合中更准确地解释了风险，但真实风险总是大于估计风险。相反，采样相关矩阵可能是生成实际CMs的更有效的方式。生成对抗网络(GANs)已经被成功和广泛地应用于计算机视觉任务(图像和视频生成)以及语言和音频处理(文本、语音和音乐生成)。然而，直到最近，在金融领域，对生成性深度学习的探索还很少。CorrGAN [2]是解决这一差距的最新尝试，它是一种GAN，经过训练可以学习相关矩阵的分布，从而可以对现实的金融CMs进行采样。</p><p id="3282" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，RMT和其他关于金融相关矩阵的类似工作确实提供了传递金融CMs属性的SFs，使我们能够更好地理解它们。这些是[2，3]:</p><p id="b0e4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">1.成对相关的分布显著地向正的方向倾斜。</p><p id="e8d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.特征值遵循Marchenko-Pastur分布，除了非常大的第一特征值(对应于“市场”)和大约5%的其他大特征值(对应于市场内的自然集群，如行业)。</p><p id="2430" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.Perron-Frobenius性质:第一特征向量有正项。</p><p id="e2e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.相关性遵循层级结构，正如Mantegna [5]所示，金融相关性也是如此。</p><p id="0020" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.CM对应的最小生成树的无标度性质。</p><p id="292b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些程式化的事实允许对合成CMs和经验CMs之间的相似性进行定性评估。这个列表并不详尽，例如，检查GAN学习的潜在空间可以揭示更多以前未知的金融相关性特征。</p><h1 id="663c" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">科尔根</h1><p id="0da9" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">CorrGAN是第一个展示使用GANs对金融CMs进行采样的结果并验证其真实性的模型。使用条件甘纳可以生成单变量时间序列，但这些忽略了多种资产之间的相关性，因此不适用于需要考虑多变量相关性的投资组合管理。在[2]中，描述了椭圆曲线(相关矩阵集)的数学设置:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/38e2aebf9e0080274b4187fa4d5d5dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*bhu2SC_-_AlH0f6UTrwoWQ.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者图片</p></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/4e8df6419437ff0e9793f458cd7beb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*rP1x_RxFM1zhyLZTbhjZXw.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者图片</p></figure><p id="a191" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">N乘N的情况在统计和计算上都要困难得多，并且需要高性能计算(HPC)基础设施来成为量化金融工具箱中的主要部分。定性评估生成矩阵的质量更难，并且由于数据效率低下，训练也更难。数据低效是由于N个资产的相关矩阵有N个！描述相同相关结构的可能矩阵，因为股票的顺序是不相关的。GAN需要用于训练它的数据的多样性，以确保数据分布的完全覆盖。通过避免由矩阵等价引起的冗余，实施置换不变性使得每次训练更新更加多样化。在CorrGAN的论文中，这是通过使用分层聚类算法来设计的，以在CM上引起排列:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/32bbf605b4780d6cfc18650ada7dadfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:302/format:webp/1*Jmr2wVAM9jhEualKXoocaA.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">作者图片</p></figure><p id="01de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该架构遵循深度卷积GAN (DCGAN ),选择该架构是因为根据SFs，CNN显示的属性也适用于金融CMs。这些是局部移位不变性、局部性和层次合成性(学习相关性的层次结构的能力)。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mr"><img src="../Images/88d58c6d6cec4dfa17e655c646788a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-QcAoiO-kwwQdKw0UkRNA.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">图1:GAN的3x3相关采样。图来自[2]。</p></figure><p id="babb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在图1中，蓝色代表使用洋葱方法从三维椭圆图上均匀采样的10，000个点。橙色点是真实的经验矩阵，使用一年中252个工作日的日收益率计算，随机抽样三只股票，不替换标准普尔500的股票。绿点是通过从经过训练的CorrGAN采样生成的合成点。已经有可能看到合成分布与经验分布紧密匹配，直观地验证了一个典型的事实，即金融CMs集中在高正值范围附近。通过绘制第一特征向量的条目、相关性的分布、随机选择的cm的视觉表示、MST中节点度分布的对数-对数图以及特征值的分布，来自[2]的结果显示了CorrGAN如何根据SFs生成真实的样本。然而，它们不是严格的相关矩阵，因为主对角线元素不完全等于1。矩阵也不完全是正半定的，导致小的负特征值。需要后处理投影方法来找到相对于Frobenius范数最近的真实相关矩阵。</p><p id="c86b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CorrGAN的局限性在于，经验分布和合成分布并不完全匹配，更重要的是，每个训练好的模型之间存在不稳定性。这是GANs的一个众所周知的缺陷，即它们不善于捕捉不同的分布模式。这意味着，由于训练期间的模式崩溃，合成矩阵可能不会跨越现实金融CMs的整个子空间，而只是一个受限的子空间。</p><h1 id="4c4f" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">条件CorrGAN: cCorrGAN</h1><p id="b824" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">今年早些时候,[2]的作者发表了cCorrGAN和对CorrGAN的改进，CorrGAN实现了三种广泛的市场稳定机制:压力、稳定和反弹。使用这个新标记的训练集，可以通过与SFs以及PCA投影的交叉检查来定性地评估性能，以确保经验和合成分布的良好定义的聚类和视觉匹配。在数量上，人们可以使用Wasserstein度量来比较经验分布和综合分布。最后,[3]的作者展示了如何应用cCorrGAN来测试投资策略和投资组合分配方法的稳健性，并得出这些方法中哪一种更能受益于某些市场条件(即市场制度)的见解。</p><p id="38c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于未来的研究，以完全端到端的方式生成相关矩阵是深度学习的理想目标和常见实践，这将避免执行训练后预测的需要。同样，虽然cCorrGAN生成了金融CMs，但对于研究人员来说，能够生成现实的多元金融时间序列仍然是一个挑战。</p><h1 id="9b5e" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">笔记</h1><ol class=""><li id="3bb2" class="ms mt iq kh b ki lt kl lu ko mu ks mv kw mw la mx my mz na bi translated">所有内联数学都是作者写的，改编自参考文章。</li></ol><h1 id="cef7" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">参考资料:</h1><p id="c102" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">[1]马科维茨的最优投资组合理论</p><p id="163b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">E.J. Elton和M.J. Gruber，现代投资组合理论和投资分析(1995)，J.Wiley父子公司，纽约，1995年；H.Markowitz，投资组合选择:投资的有效多样化(1959)，J.Wiley父子公司，纽约，1959年。</p><p id="16a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[2]科尔根</p><p id="59a7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">G.Marti，CorrGAN:使用生成式对抗网络对现实财务相关性矩阵进行采样(2020)，ICASSP 2020–2020 IEEE声学、语音和信号处理国际会议(ICA ssp)，第8459–8463页。</p><p id="32d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[3]科尔根</p><p id="81bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">动词 （verb的缩写）Goubet G. Marti和F. Nielsen，cCorrGan:用于学习椭圆中的经验条件分布的条件相关性Gan(2021)，几何信息科学，第613-620页，斯普林格国际出版公司。</p><p id="756e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[4]随机矩阵理论和金融相关性</p><p id="6fda" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">长度Laloux，P. Cizeau，M. Potters和J-P. Bouchaud,《随机矩阵理论和金融相关性》( 2000年),《国际理论和应用金融杂志》,第3卷，第03期，第391-397页。</p><p id="3a9e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[5]财务相关性的层次结构</p><p id="ddd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">R.N. Mantegna,《金融市场的层次结构》( 1999年),《欧洲物理杂志B——凝聚态物质和复杂系统》,第11卷，第1期，第193-197页。</p><p id="34d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[6]生成金融领域的综合数据</p><p id="4a4c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">南Assefa,《生成金融综合数据:机遇、挑战和陷阱》。挑战和陷阱(2020年)，信息科学:数据保护(专题)，2020年。</p></div></div>    
</body>
</html>