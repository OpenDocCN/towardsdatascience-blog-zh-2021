<html>
<head>
<title>5 Examples to Compare Python Pandas and R data.table</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比较Python Pandas和R data的5个示例。表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-examples-to-compare-python-pandas-and-r-data-table-27b43402ae6a?source=collection_archive---------32-----------------------#2021-04-20">https://towardsdatascience.com/5-examples-to-compare-python-pandas-and-r-data-table-27b43402ae6a?source=collection_archive---------32-----------------------#2021-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0d83" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">两者的实用指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e46320958bbd14d5197715c6807e7aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qU17kc0JJZn43BcffuUt4A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Katka Pavlickova 在<a class="ae ky" href="https://unsplash.com/s/photos/two?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="cf04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python和R是数据科学生态系统中的两种主要语言。它们都提供了丰富的库选择，可以加速和改进数据科学工作流。</p><p id="651f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将比较pandas和data.table，这两个流行的数据分析和操作库分别用于Python和R。我们不会试图宣布一个优于另一个。相反，重点是展示这两个库如何为数据争论提供高效灵活的方法。</p><p id="239b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将讨论的例子是常见的数据分析和操作。因此，你可能会经常使用它们。</p><p id="10e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用Kaggle上的墨尔本房产<a class="ae ky" href="https://www.kaggle.com/anthonypino/melbourne-housing-market" rel="noopener ugc nofollow" target="_blank">数据集</a>作为例子。我将使用Google Colab(熊猫)和r studio(data . table)作为IDE。让我们首先导入库并读取数据集。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="db83" class="ma mb it lw b gy mc md l me mf"># pandas<br/>import pandas as pd<br/>melb = pd.read_csv("/content/melb_data.csv")</span><span id="02a2" class="ma mb it lw b gy mg md l me mf"># data.table<br/>library(data.table)<br/>melb &lt;- fread("datasets/melb_data.csv")</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="efc7" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">示例1</h2><p id="967a" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">第一个示例是基于数据集中的现有列创建一个新列。这是特征工程过程中的常见操作。pandas和data.table都提供了完成这项任务的简单方法。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3fbe" class="ma mb it lw b gy mc md l me mf"># pandas<br/>melb["Price_per_area"] = melb["Price"] / melb["Landsize"]</span><span id="6a9f" class="ma mb it lw b gy mg md l me mf"># data.table<br/>melb[, Price_per_area := Price / Landsize]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/cf02813c0e4888fb64bc35fe79b5a269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfXn5HDi3Mcy2Oyv4vdUxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Price、Landsize和Price_per_area列的前5行(图片由作者提供)</p></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="215a" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">示例2</h2><p id="4a30" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">对于第二个示例，我们通过应用几个过滤器来创建原始数据集的子集。该子集包括价格超过100万英镑的h类房屋。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="b9c4" class="ma mb it lw b gy mc md l me mf"># pandas<br/>subset = melb[(melb.Price &gt; 1000000) &amp; (melb.Type == "h")]</span><span id="dcf6" class="ma mb it lw b gy mg md l me mf"># data.table<br/>subset &lt;- melb[Price &gt; 1000000 &amp; Type == "h"]</span></pre><p id="4f9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于pandas，我们提供数据框的名称来选择用于过滤的列。另一方面，data.table只使用列名就足够了。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="2b68" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">示例3</h2><p id="30e2" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">数据分析中非常常用的函数是groupby函数。它允许根据一些数值度量来比较分类变量中的不同值。</p><p id="0ca4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以计算不同地区的平均房价。为了让这个例子更复杂一点，让我们也对房子类型应用一个过滤器。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="aea7" class="ma mb it lw b gy mc md l me mf"># pandas<br/>melb[melb.Type == "u"].groupby("Regionname").agg(<br/>   avg_price = ("Price", "mean")<br/>)</span><span id="954d" class="ma mb it lw b gy mg md l me mf"># data.table<br/>melb[Type == "u", .(avg_price = mean(Price)), by="Regionname"]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/92d3005bf0b1334782bb0d28b90577a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gxdtl82iujT7ocgynD4aWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f78c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas使用groupby函数执行这样的操作。对于data.table，这个操作相对简单一些，因为我们只需要使用by参数。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="6d87" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">实例4</h2><p id="746b" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">让我们进一步看前面的例子。我们找到了房屋的平均价格，但不知道每个地区的房屋数量。</p><p id="e44d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个库都允许在一个操作中应用多个聚合。我们还可以按升序或降序对结果进行排序。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="799a" class="ma mb it lw b gy mc md l me mf"># pandas<br/>melb[melb.Type == "u"].groupby("Regionname").agg(<br/>   avg_price = ("Price", "mean"),<br/>   number_of_houses = ("Price", "count")<br/>).sort_values(by="avg_price", ascending=False)<br/></span><span id="89cd" class="ma mb it lw b gy mg md l me mf"># data.table<br/>&gt; melb[<br/>      Type == "u", <br/>      .(avg_price = mean(Price), number_of_houses=.N), <br/>      by="Regionname"<br/>  ][order(-avg_price)]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/c3d264b73b55e801cceb0502434535b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hs6k7yeyHna4X2mpUOgWYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="7c6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用count函数来获得每组中房屋的数量。的”。n”可以用作data.table中的计数函数。</p><p id="4fc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，两个库都按升序对结果进行排序。在pandas中，此行为由升序参数控制。我们只是用一个减号在data.table中以降序得到结果。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="cee0" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">实例5</h2><p id="b4de" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">在最后一个例子中，我们将看到如何更改列名。例如，我们可以更改类型和距离列的名称。</p><ul class=""><li id="f58a" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">类型:房屋类型</li><li id="a4aa" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">距离:距离</li></ul><p id="337e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集中的距离列表示到中央商务区(CBD)的距离，因此最好在列名中提供此信息。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="987d" class="ma mb it lw b gy mc md l me mf"># pandas<br/>melb.rename(columns={"Type": "HouseType",<br/>                     "Distance": "DistanceCBD"},<br/>            inplace=True)</span><span id="87f0" class="ma mb it lw b gy mg md l me mf"># data.table<br/>setnames(melb, <br/>         c("Type", "Distance"),<br/>         c("HouseType", "DistanceCBD"))</span></pre><p id="719f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于pandas，我们传递一个字典，它将更改映射到rename函数。inplace参数用于将结果保存在原始数据框中。</p><p id="d9ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于data.table，我们使用setnames函数。它有三个参数，分别是表名、要更改的列名和新列名。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="44b1" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">结论</h2><p id="42a2" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我们基于数据分析和操作过程中常见操作的5个示例对pandas和data.table进行了比较。这两个库都提供了简单有效的方法来完成这些任务。</p><p id="7c79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我看来，data.table的语法比熊猫简单一点。Data.table在某些情况下更切题。</p><p id="f33b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得一提的是，我们在本文中所做的例子仅仅代表了这些库的一小部分功能。它们提供了许多功能和方法来执行复杂得多的操作。</p><p id="4eb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>