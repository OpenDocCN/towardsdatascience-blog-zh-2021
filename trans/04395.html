<html>
<head>
<title>Time Series Forecasting with PyCaret Regression Module</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨PyCaretå›å½’æ¨¡å—è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/time-series-forecasting-with-pycaret-regression-module-237b703a0c63?source=collection_archive---------4-----------------------#2021-04-14">https://towardsdatascience.com/time-series-forecasting-with-pycaret-regression-module-237b703a0c63?source=collection_archive---------4-----------------------#2021-04-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9567a5d3c4c820427d3bc6795f37a155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6t7FzC-AdfDlA9LI"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">å¢å¡æ–¯Â·å¸ƒæ‹‰å¡å…‹åœ¨<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</p></figure><h1 id="0154" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">PyCaret</h1><p id="a72a" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">PyCaretæ˜¯ä¸€ä¸ªå¼€æºçš„ä½ä»£ç æœºå™¨å­¦ä¹ åº“å’Œç«¯åˆ°ç«¯çš„æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå†…ç½®äºPythonä¸­ï¼Œç”¨äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚å®ƒå› å…¶æ˜“ç”¨æ€§ã€ç®€å•æ€§ä»¥åŠå¿«é€Ÿæœ‰æ•ˆåœ°æ„å»ºå’Œéƒ¨ç½²ç«¯åˆ°ç«¯MLåŸå‹çš„èƒ½åŠ›è€Œå¹¿å—æ¬¢è¿ã€‚</p><p id="4779" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">PyCaretæ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨æ¥ç”¨å‡ è¡Œä»£ç æ›¿æ¢æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå‘¨æœŸæˆå€åœ°å¿«é€Ÿå’Œæœ‰æ•ˆã€‚</p><p id="1bf9" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">py caret<strong class="ld ir">ç®€å•</strong> <strong class="ld ir">å¥½ç”¨</strong>ã€‚PyCaretä¸­æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½é¡ºåºå­˜å‚¨åœ¨ä¸€ä¸ª<strong class="ld ir">ç®¡é“</strong>ä¸­ï¼Œè¯¥ç®¡é“å¯¹äº<strong class="ld ir">éƒ¨ç½²æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–çš„ã€‚</strong>æ— è®ºæ˜¯è¾“å…¥ç¼ºå¤±å€¼ã€ä¸€é”®ç¼–ç ã€è½¬æ¢åˆ†ç±»æ•°æ®ã€ç‰¹å¾å·¥ç¨‹ï¼Œç”šè‡³æ˜¯è¶…å‚æ•°è°ƒæ•´ï¼ŒPyCaretéƒ½èƒ½å®ç°è‡ªåŠ¨åŒ–ã€‚è¦äº†è§£PyCaretçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è§‚çœ‹è¿™æ®µ1åˆ†é’Ÿçš„è§†é¢‘ã€‚</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">py caretâ€”â€”Pythonä¸­çš„å¼€æºã€ä½ä»£ç æœºå™¨å­¦ä¹ åº“</p></figure><p id="7510" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æœ¬æ•™ç¨‹å‡è®¾æ‚¨å¯¹PyCaretæœ‰ä¸€å®šçš„äº†è§£å’Œç»éªŒã€‚å¦‚æœæ‚¨ä»¥å‰æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œæ²¡å…³ç³»ï¼Œæ‚¨å¯ä»¥é€šè¿‡è¿™äº›æ•™ç¨‹å¿«é€Ÿå…¥é—¨:</p><ul class=""><li id="2b9d" class="mk ml iq ld b le lz li ma lm mm lq mn lu mo ly mp mq mr ms bi translated"><a class="ae kc" rel="noopener" target="_blank" href="/pycaret-2-2-is-here-whats-new-ad7612ca63b"> PyCaret 2.2å·²ç»å‘å¸ƒâ€”â€”æ–°åŠŸèƒ½</a></li><li id="99ee" class="mk ml iq ld b le mt li mu lm mv lq mw lu mx ly mp mq mr ms bi translated"><a class="ae kc" rel="noopener" target="_blank" href="/announcing-pycaret-2-0-39c11014540e">å®£å¸ƒPyCaret 2.0 </a></li><li id="64ac" class="mk ml iq ld b le mt li mu lm mv lq mw lu mx ly mp mq mr ms bi translated">å…³äºPyCaretä½ ä¸çŸ¥é“çš„äº”ä»¶äº‹</li></ul><h1 id="e209" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">æ­£åœ¨å®‰è£…PyCaret</h1><p id="9ab1" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">å®‰è£…PyCaretéå¸¸å®¹æ˜“ï¼Œåªéœ€è¦å‡ åˆ†é’Ÿã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒæ¥é¿å…ä¸å…¶ä»–åº“çš„æ½œåœ¨å†²çªã€‚</p><p id="1e4a" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">PyCaretçš„é»˜è®¤å®‰è£…æ˜¯pycaretçš„ç²¾ç®€ç‰ˆæœ¬ï¼Œå®ƒåªå®‰è£…è¿™é‡Œåˆ—å‡ºçš„<a class="ae kc" href="https://github.com/pycaret/pycaret/blob/master/requirements.txt" rel="noopener ugc nofollow" target="_blank">ç¡¬ä¾èµ–é¡¹</a>ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="8041" class="nd ke iq mz b gy ne nf l ng nh"><strong class="mz ir"># install slim version (default)<br/></strong>pip install pycaret</span><span id="44af" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># install the full version</strong><br/>pip install pycaret[full]</span></pre><p id="9b34" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">å½“ä½ å®‰è£…pycaretçš„å®Œæ•´ç‰ˆæœ¬æ—¶ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ‰€æœ‰å¯é€‰ä¾èµ–é¡¹<a class="ae kc" href="https://github.com/pycaret/pycaret/blob/master/requirements-optional.txt" rel="noopener ugc nofollow" target="_blank"/>ä¹Ÿä¼šè¢«å®‰è£…ã€‚</p><h1 id="43da" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ğŸ‘‰PyCaretå›å½’æ¨¡å—</h1><p id="7b1b" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">PyCaret <strong class="ld ir">å›å½’æ¨¡å—</strong>æ˜¯ä¸€ä¸ªå—ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å—ï¼Œç”¨äºä¼°è®¡ä¸€ä¸ª<strong class="ld ir">å› å˜é‡</strong>(é€šå¸¸ç§°ä¸ºâ€œç»“æœå˜é‡â€ï¼Œæˆ–â€œç›®æ ‡â€)å’Œä¸€ä¸ªæˆ–å¤šä¸ª<strong class="ld ir">è‡ªå˜é‡</strong>(é€šå¸¸ç§°ä¸ºâ€œç‰¹å¾â€ï¼Œæˆ–â€œé¢„æµ‹å™¨â€)ä¹‹é—´çš„å…³ç³»ã€‚</p><p id="6503" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">å›å½’çš„ç›®æ ‡æ˜¯é¢„æµ‹è¿ç»­å€¼ï¼Œå¦‚é”€å”®é¢ã€æ•°é‡ã€æ¸©åº¦ã€å®¢æˆ·æ•°é‡ç­‰ã€‚PyCaretä¸­çš„æ‰€æœ‰æ¨¡å—éƒ½æä¾›äº†è®¸å¤š<a class="ae kc" href="https://www.pycaret.org/preprocessing" rel="noopener ugc nofollow" target="_blank">é¢„å¤„ç†</a>åŠŸèƒ½ï¼Œé€šè¿‡<a class="ae kc" href="https://www.pycaret.org/setup" rel="noopener ugc nofollow" target="_blank">è®¾ç½®</a>åŠŸèƒ½ä¸ºå»ºæ¨¡å‡†å¤‡æ•°æ®ã€‚å®ƒæœ‰è¶…è¿‡25ä¸ªç°æˆçš„ç®—æ³•å’Œå‡ ä¸ªå›¾æ¥åˆ†æè®­ç»ƒæ¨¡å‹çš„æ€§èƒ½ã€‚</p><h1 id="df12" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ğŸ‘‰å…·æœ‰PyCaretå›å½’æ¨¡å—çš„æ—¶é—´åºåˆ—</h1><p id="25b8" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">æ—¶é—´åºåˆ—é¢„æµ‹å¯ä»¥å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç±»:</p><ul class=""><li id="7961" class="mk ml iq ld b le lz li ma lm mm lq mn lu mo ly mp mq mr ms bi translated"><strong class="ld ir">ç»å…¸/ç»Ÿè®¡æ¨¡å‹</strong> â€”ç§»åŠ¨å¹³å‡ã€æŒ‡æ•°å¹³æ»‘ã€ARIMAã€è¨é‡Œç›ã€TBATS</li><li id="961e" class="mk ml iq ld b le mt li mu lm mv lq mw lu mx ly mp mq mr ms bi translated"><strong class="ld ir">æœºå™¨å­¦ä¹ </strong> â€”çº¿æ€§å›å½’ã€XGBoostã€éšæœºæ£®æ—æˆ–ä»»ä½•å…·æœ‰å½’çº¦æ–¹æ³•çš„MLæ¨¡å‹</li><li id="a555" class="mk ml iq ld b le mt li mu lm mv lq mw lu mx ly mp mq mr ms bi translated"><strong class="ld ir">æ·±åº¦å­¦ä¹ </strong>â€”LSTM RNN</li></ul><p id="9367" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æœ¬æ•™ç¨‹ä¸»è¦å…³æ³¨ç¬¬äºŒç±»ï¼Œå³<em class="nj">æœºå™¨å­¦ä¹ </em>ã€‚</p><p id="9c36" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">PyCaretçš„å›å½’æ¨¡å—é»˜è®¤è®¾ç½®å¯¹äºæ—¶åºæ•°æ®æ¥è¯´å¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºå®ƒæ¶‰åŠçš„æ•°æ®å‡†å¤‡æ­¥éª¤å¾ˆå°‘ï¼Œè€Œè¿™äº›æ­¥éª¤å¯¹äºæœ‰åºæ•°æ®(<em class="nj">æ•°æ®å’Œæ—¶åºæ•°æ®</em>ç­‰åºåˆ—)æ˜¯æ— æ•ˆçš„ã€‚</p><p id="57ae" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ä¾‹å¦‚ï¼Œå°†æ•°æ®é›†åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†æ˜¯éšæœºè¿›è¡Œçš„ã€‚è¿™å¯¹äºæ—¶é—´åºåˆ—æ•°æ®æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºæ‚¨ä¸å¸Œæœ›æœ€è¿‘çš„æ—¥æœŸåŒ…å«åœ¨è®­ç»ƒé›†ä¸­ï¼Œè€Œå†å²æ—¥æœŸæ˜¯æµ‹è¯•é›†çš„ä¸€éƒ¨åˆ†ã€‚</p><p id="4e63" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æ—¶é—´åºåˆ—æ•°æ®ä¹Ÿéœ€è¦ä¸åŒç±»å‹çš„äº¤å‰éªŒè¯ï¼Œå› ä¸ºå®ƒéœ€è¦è€ƒè™‘æ—¥æœŸçš„é¡ºåºã€‚è¯„ä¼°æ¨¡å‹æ—¶ï¼ŒPyCaretå›å½’æ¨¡å—é»˜è®¤ä½¿ç”¨kå€éšæœºäº¤å‰éªŒè¯ã€‚é»˜è®¤çš„äº¤å‰éªŒè¯è®¾ç½®ä¸é€‚ç”¨äºæ—¶åºæ•°æ®ã€‚</p><p id="1ec8" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æœ¬æ•™ç¨‹çš„ä¸‹ä¸€èŠ‚å°†æ¼”ç¤ºå¦‚ä½•è½»æ¾æ›´æ”¹PyCaretå›å½’æ¨¡å—ä¸­çš„é»˜è®¤è®¾ç½®ï¼Œä½¿å…¶é€‚ç”¨äºæ—¶é—´åºåˆ—æ•°æ®ã€‚</p><h1 id="23ec" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ğŸ‘‰èµ„æ–™ç»„</h1><p id="813c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">å‡ºäºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘ä½¿ç”¨äº†ç¾å›½èˆªç©ºå…¬å¸çš„ä¹˜å®¢æ•°æ®é›†ã€‚ä½ å¯ä»¥ä»<a class="ae kc" href="https://www.kaggle.com/chirag19/air-passengers" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>ä¸‹è½½æ•°æ®é›†ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="84bc" class="nd ke iq mz b gy ne nf l ng nh"><strong class="mz ir"># read csv file<br/></strong>import pandas as pd<br/>data = pd.read_csv('AirPassengers.csv')<br/>data['Date'] = pd.to_datetime(data['Date'])<br/>data.head()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ed037ac162b9a722b28b74eba87cdfe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*9Gn9v-CWD3Eca3V92edtDw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">æ ·æœ¬è¡Œ</p></figure><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="ab5d" class="nd ke iq mz b gy ne nf l ng nh"><strong class="mz ir"># create 12 month moving average<br/></strong>data['MA12'] = data['Passengers'].rolling(12).mean()</span><span id="337b" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># plot the data and MA<br/></strong>import plotly.express as px<br/>fig = px.line(data, x="Date", y=["Passengers", "MA12"], template = 'plotly_dark')<br/>fig.show()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/20969ee22e159c2dae977e7752844391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXL7m7exxTid0kGcU9jGUA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">ç¾å›½èˆªç©ºå…¬å¸ä¹˜å®¢æ•°æ®é›†æ—¶é—´åºåˆ—å›¾ï¼Œç§»åŠ¨å¹³å‡å€¼= 12</p></figure><p id="91fd" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ç”±äºç®—æ³•ä¸èƒ½ç›´æ¥å¤„ç†æ—¥æœŸï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä»æ—¥æœŸ(å¦‚æœˆå’Œå¹´)ä¸­æå–ä¸€äº›ç®€å•çš„ç‰¹å¾ï¼Œå¹¶åˆ é™¤åŸå§‹çš„æ—¥æœŸåˆ—ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="83ef" class="nd ke iq mz b gy ne nf l ng nh"><strong class="mz ir"># extract month and year from dates</strong><br/>data['Month'] = [i.month for i in data['Date']]<br/>data['Year'] = [i.year for i in data['Date']]</span><span id="b73e" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># create a sequence of numbers<br/></strong>data['Series'] = np.arange(1,len(data)+1)</span><span id="daff" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># drop unnecessary columns and re-arrange<br/></strong>data.drop(['Date', 'MA12'], axis=1, inplace=True)<br/>data = data[['Series', 'Year', 'Month', 'Passengers']] </span><span id="6cc5" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># check the head of the dataset</strong><br/>data.head()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/a19d0937623e241a359520b18bfb4844.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*T4xXVYhrfIyB35EDjl645A.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">æå–è¦ç´ åçš„æ ·æœ¬è¡Œ</p></figure><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="acef" class="nd ke iq mz b gy ne nf l ng nh"><strong class="mz ir"># split data into train-test set<br/></strong>train = data[data['Year'] &lt; 1960]<br/>test = data[data['Year'] &gt;= 1960]</span><span id="fc93" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># check shape<br/></strong>train.shape, test.shape<br/>&gt;&gt;&gt; ((132, 4), (12, 4))</span></pre><p id="a855" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">åœ¨åˆå§‹åŒ–<code class="fe nn no np mz b">setup</code>ä¹‹å‰ï¼Œæˆ‘å·²ç»æ‰‹åŠ¨åˆ†å‰²äº†æ•°æ®é›†ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯å°†æ•´ä¸ªæ•°æ®é›†ä¼ é€’ç»™PyCaretï¼Œè®©å®ƒå¤„ç†æ‹†åˆ†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¿…é¡»åœ¨<code class="fe nn no np mz b">setup</code>å‡½æ•°ä¸­ä¼ é€’<code class="fe nn no np mz b">data_split_shuffle = False</code>ï¼Œä»¥é¿å…åœ¨æ‹†åˆ†å‰æ‰“ä¹±æ•°æ®é›†ã€‚</p><h1 id="3964" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ğŸ‘‰<strong class="ak">åˆå§‹åŒ–è®¾ç½®</strong></h1><p id="79ca" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">ç°åœ¨æ˜¯åˆå§‹åŒ–<code class="fe nn no np mz b">setup</code>å‡½æ•°çš„æ—¶å€™äº†ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe nn no np mz b">fold_strategy</code>å‚æ•°æ˜¾å¼åœ°ä¼ é€’è®­ç»ƒæ•°æ®ã€æµ‹è¯•æ•°æ®å’Œäº¤å‰éªŒè¯ç­–ç•¥ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="761a" class="nd ke iq mz b gy ne nf l ng nh"><strong class="mz ir"># import the regression module</strong><br/>from pycaret.regression import *</span><span id="f1f2" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># initialize setup</strong><br/>s = setup(data = train, test_data = test, target = 'Passengers', fold_strategy = 'timeseries', numeric_features = ['Year', 'Series'], fold = 3, transform_target = True, session_id = 123)</span></pre><h1 id="8d90" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ğŸ‘‰<strong class="ak">åŸ¹è®­å’Œè¯„ä¼°æ‰€æœ‰æ¨¡å‹</strong></h1><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="e1c9" class="nd ke iq mz b gy ne nf l ng nh">best = compare_models(sort = 'MAE')</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/5b5c247ad0c01a54831824e818cd8f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mnqplw1KbJYm9fxyH-46Tg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">æ¯”è¾ƒæ¨¡å‹çš„ç»“æœ</p></figure><p id="d898" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">åŸºäºäº¤å‰éªŒè¯çš„MAEçš„æœ€ä½³æ¨¡å‹æ˜¯<strong class="ld ir">æœ€å°è§’åº¦å›å½’</strong> (MAE: 22.3)ã€‚è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æµ‹è¯•é›†ä¸Šçš„åˆ†æ•°ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="c555" class="nd ke iq mz b gy ne nf l ng nh">prediction_holdout = predict_model(best);</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e0d26cc809a0fe2387760343f347e8f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*Us888u-jaVQzasN8Kn3z6A.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">é¢„æµ‹æ¨¡å‹(æœ€ä½³)å‡½æ•°çš„ç»“æœ</p></figure><p id="a441" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æµ‹è¯•é›†ä¸Šçš„MAEæ¯”äº¤å‰éªŒè¯çš„MAEé«˜12%ã€‚ä¸å¤ªå¥½ï¼Œä½†æˆ‘ä»¬ä¼šåŠªåŠ›çš„ã€‚è®©æˆ‘ä»¬ç”»å‡ºå®é™…çš„å’Œé¢„æµ‹çš„çº¿æ¥å¯è§†åŒ–æ‹Ÿåˆã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="9acb" class="nd ke iq mz b gy ne nf l ng nh"><strong class="mz ir"># generate predictions on the original dataset</strong><br/>predictions = predict_model(best, data=data)</span><span id="6627" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># add a date column in the dataset</strong><br/>predictions['Date'] = pd.date_range(start='1949-01-01', end = '1960-12-01', freq = 'MS')</span><span id="4a4e" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># line plot</strong><br/>fig = px.line(predictions, x='Date', y=["Passengers", "Label"], template = 'plotly_dark')</span><span id="7d7a" class="nd ke iq mz b gy ni nf l ng nh"><strong class="mz ir"># add a vertical rectange for test-set separation</strong><br/>fig.add_vrect(x0="1960-01-01", x1="1960-12-01", fillcolor="grey", opacity=0.25, line_width=0)</span><span id="8cae" class="nd ke iq mz b gy ni nf l ng nh">fig.show()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/711448f7828c7a393a026a0b66349a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BlfRbXuxwcgvs-zrpK8C0Q.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">å®é™…å’Œé¢„æµ‹çš„ç¾å›½èˆªç©ºä¹˜å®¢(1949-1960)</p></figure><p id="5a8c" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æ¥è¿‘å°¾å£°çš„ç°è‰²èƒŒæ™¯æ˜¯æµ‹è¯•æœŸ(å³1960å¹´)ã€‚ç°åœ¨è®©æˆ‘ä»¬æœ€ç»ˆç¡®å®šæ¨¡å‹ï¼Œå³åœ¨æ•´ä¸ªæ•°æ®é›†(è¿™æ¬¡åŒ…æ‹¬æµ‹è¯•é›†)ä¸Šè®­ç»ƒæœ€ä½³æ¨¡å‹ï¼Œå³<em class="nj">æœ€å°è§’åº¦å›å½’</em>ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="48b7" class="nd ke iq mz b gy ne nf l ng nh">final_best = finalize_model(best)</span></pre><h1 id="53c3" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ğŸ‘‰åˆ›å»ºæœªæ¥è¯„åˆ†æ•°æ®é›†</h1><p id="0256" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»åœ¨æ•´ä¸ªæ•°æ®é›†(1949å¹´åˆ°1960å¹´)ä¸Šè®­ç»ƒäº†æˆ‘ä»¬çš„æ¨¡å‹ï¼Œè®©æˆ‘ä»¬é¢„æµ‹åˆ°1964å¹´çš„æœªæ¥äº”å¹´ã€‚è¦ä½¿ç”¨æˆ‘ä»¬çš„æœ€ç»ˆæ¨¡å‹æ¥ç”Ÿæˆæœªæ¥é¢„æµ‹ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†ç”±æœªæ¥æ—¥æœŸçš„æœˆã€å¹´ã€ç³»åˆ—åˆ—ç»„æˆã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="6251" class="nd ke iq mz b gy ne nf l ng nh">future_dates = pd.date_range(start = '1961-01-01', end = '1965-01-01', freq = 'MS')</span><span id="3a1e" class="nd ke iq mz b gy ni nf l ng nh">future_df = pd.DataFrame()</span><span id="65c1" class="nd ke iq mz b gy ni nf l ng nh">future_df['Month'] = [i.month for i in future_dates]<br/>future_df['Year'] = [i.year for i in future_dates]    <br/>future_df['Series'] = np.arange(145,(145+len(future_dates)))</span><span id="d14e" class="nd ke iq mz b gy ni nf l ng nh">future_df.head()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/749621912848d837eed2300b7db932f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*KD4G6VVmbuq-w_6088Vl8Q.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">future_dfä¸­çš„ç¤ºä¾‹è¡Œ</p></figure><p id="5fcc" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨<code class="fe nn no np mz b">future_df</code>æ¥è¯„åˆ†å¹¶ç”Ÿæˆé¢„æµ‹ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="c962" class="nd ke iq mz b gy ne nf l ng nh">predictions_future = predict_model(final_best, data=future_df)<br/>predictions_future.head()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a34d82440df3ece1c83c3f3a5e0809d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*5mqx2Qi2En2VPq9zNZG87g.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">é¢„æµ‹ä¸­çš„æ ·æœ¬è¡Œ_æœªæ¥</p></figure><p id="cc50" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æˆ‘ä»¬æ¥ç”»ä¸€ä¸‹ã€‚</p><pre class="me mf mg mh gt my mz na nb aw nc bi"><span id="dc42" class="nd ke iq mz b gy ne nf l ng nh">concat_df = pd.concat([data,predictions_future], axis=0)<br/>concat_df_i = pd.date_range(start='1949-01-01', end = '1965-01-01', freq = 'MS')<br/>concat_df.set_index(concat_df_i, inplace=True)</span><span id="9e73" class="nd ke iq mz b gy ni nf l ng nh">fig = px.line(concat_df, x=concat_df.index, y=["Passengers", "Label"], template = 'plotly_dark')<br/>fig.show()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/f4923fdb31e0798417d0662e0fe086fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IjglwJEeU2hZMsjxM8yPbg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">å®é™…(1949-1960å¹´)å’Œé¢„æµ‹(1961-1964å¹´)ç¾å›½èˆªç©ºä¹˜å®¢</p></figure><p id="4318" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">é‚£ä¸æ˜¯å¾ˆå®¹æ˜“å—ï¼Ÿ</p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="0a8e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ä½¿ç”¨Pythonä¸­çš„è¿™ä¸ªè½»é‡çº§å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°çš„ç›®æ ‡æ˜¯æ— é™çš„ã€‚å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°ç»™æˆ‘ä»¬GitHubåº“ä¸Šçš„â­ï¸ã€‚</p><p id="69e2" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">è¦äº†è§£æ›´å¤šå…³äºPyCaretçš„ä¿¡æ¯ï¼Œè¯·å…³æ³¨æˆ‘ä»¬çš„LinkedInå’ŒYoutubeã€‚</p><p id="dd8d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">åŠ å…¥æˆ‘ä»¬çš„ä¼‘é—²é¢‘é“ã€‚æ­¤å¤„é‚€è¯·é“¾æ¥<a class="ae kc" href="https://join.slack.com/t/pycaret/shared_invite/zt-p7aaexnl-EqdTfZ9U~mF0CwNcltffHg" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><h1 id="f7e7" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£:</h1><p id="66c3" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><a class="ae kc" rel="noopener" target="_blank" href="/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d">ä½¿ç”¨PyCaret 2.0 </a> <br/> <a class="ae kc" rel="noopener" target="_blank" href="/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01">åœ¨Power BIä¸­æ„å»ºæ‚¨è‡ªå·±çš„AutoMLä½¿ç”¨Docker </a> <br/> <a class="ae kc" rel="noopener" target="_blank" href="/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b">åœ¨Azureä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“åœ¨Google Kuberneteså¼•æ“ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“</a> <br/> <a class="ae kc" rel="noopener" target="_blank" href="/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507">åœ¨AWS Fargateä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“</a> <br/> <a class="ae kc" rel="noopener" target="_blank" href="/build-and-deploy-your-first-machine-learning-web-app-e020db344a99">æ„å»ºå’Œéƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹ webåº”ç”¨</a> <br/> <a class="ae kc" rel="noopener" target="_blank" href="/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2">ä½¿ç”¨AWS Fargateæ— æœåŠ¡å™¨</a> <br/> <a class="ae kc" rel="noopener" target="_blank" href="/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104">æ„å»ºå’Œéƒ¨ç½²æœºå™¨</a></p><h1 id="3c01" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">é‡è¦é“¾æ¥</h1><p id="229f" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a> <br/> <a class="ae kc" href="https://medium.com/@moez_62905" rel="noopener">åšå®¢</a><br/><a class="ae kc" href="http://www.github.com/pycaret/pycaret" rel="noopener ugc nofollow" target="_blank">GitHub</a><br/><a class="ae kc" href="https://stackoverflow.com/questions/tagged/pycaret" rel="noopener ugc nofollow" target="_blank">stack overflow</a><br/><a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">å®‰è£…PyCaret <br/> </a> <a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/tutorials.html" rel="noopener ugc nofollow" target="_blank">ç¬”è®°æœ¬æ•™ç¨‹<br/> </a> <a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/contribute.html" rel="noopener ugc nofollow" target="_blank">æŠ•ç¨¿äºPyCaret </a></p><h1 id="a057" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">æƒ³äº†è§£æŸä¸ªç‰¹å®šæ¨¡å—ï¼Ÿ</h1><p id="2896" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">å•å‡»ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ–‡æ¡£å’Œå·¥ä½œç¤ºä¾‹ã€‚</p><p id="09ad" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/api/classification.html" rel="noopener ugc nofollow" target="_blank">åˆ†ç±»<br/></a>T3ã€‘å›å½’T5ã€‘T6ã€‘èšç±» <br/> <a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/api/anomaly.html" rel="noopener ugc nofollow" target="_blank">å¼‚å¸¸æ£€æµ‹</a> <br/> <a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/api/nlp.html" rel="noopener ugc nofollow" target="_blank">è‡ªç„¶è¯­è¨€å¤„ç†<br/> </a> <a class="ae kc" href="https://pycaret.readthedocs.io/en/latest/api/arules.html" rel="noopener ugc nofollow" target="_blank">å…³è”è§„åˆ™æŒ–æ˜</a></p></div></div>    
</body>
</html>