<html>
<head>
<title>Training AlphaZero in Google Colab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google Colab中训练AlphaZero</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/training-alphazero-in-google-colab-cc2f1d6bd0ba?source=collection_archive---------25-----------------------#2021-05-27">https://towardsdatascience.com/training-alphazero-in-google-colab-cc2f1d6bd0ba?source=collection_archive---------25-----------------------#2021-05-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="216a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">借助朱莉娅的力量在短短5小时内</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4846c34d65d62007a5addad4829a7124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zWFNtj2Y9EcmpbAD7EXWUQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练如此之快，你甚至不会意识到它已经打败了你(图片:杰克·吉文斯，<a class="ae ky" href="https://unsplash.com/photos/iR8m2RRo-z4" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="c576" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着Kaggle对强化学习(RL)的推进，我一直在深入研究RL算法，同时研究哪些算法可以实际训练(我们并不都有一大群GPU！).在这篇文章中，我讨论了如何使用Google的在线笔记本系统Collaboratory，在不到4小时的时间内训练一个代理人玩人类级别的connect four。</p><p id="5cda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章是完全可复制的，你可以在这里找到笔记本，训练你自己的代理人，亲眼看看AlphaZero + Colab + Julia的力量是多么惊人！</p><blockquote class="lv lw lx"><p id="d37b" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><a class="ae ky" href="https://colab.research.google.com/drive/1UbL2A-56rxr4UwxLk-uWyZ2i88nNmyQk?usp=sharing" rel="noopener ugc nofollow" target="_blank"> AlphaZero谷歌合作实验室笔记本链接</a></p></blockquote><p id="3625" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">向<a class="ae ky" href="https://github.com/jonathan-laurent/AlphaZero.jl" rel="noopener ugc nofollow" target="_blank"> Alphazero.jl </a>的所有者以及那些努力让Julia起床并在Google Colab 中运行的人们大声疾呼，这一切才成为可能。</p><h1 id="f79f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">背景</h1><p id="9715" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在深入研究之前，先了解一些关键组件的背景知识，如果您对此不感兴趣，请跳到下一部分。</p><h2 id="d758" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">阿尔法零</h2><p id="6ade" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">AlphaZero是Deepmind在2017年首次分享的强化学习程序。它能够玩围棋、日本兵棋和国际象棋，这三种独特的复杂策略游戏。它完全通过自我游戏来学习如何做到这一点，当它发现和开发策略时，不断地与自己玩游戏。它是世界著名的<a class="ae ky" href="https://www.youtube.com/watch?v=WXuK6gekU1Y&amp;ab_channel=DeepMind" rel="noopener ugc nofollow" target="_blank"> AlphaGo </a>的继任者，AlphaGo 作为第一个在围棋比赛中击败人类大师的系统而成为头条新闻。</p><p id="0d7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该算法的一大卖点是它可以被训练的速度，Deepmind报告说，在训练的一天内就达到了超人的水平。当然，这是在一台超级计算机上训练出来的，但是我们要用少得多的东西来管理。</p><h2 id="b04a" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">谷歌合作实验室</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/d893ea1a065d304b47f14c27a12b25db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PAbjy8ST7SOlh8ALKvGQsA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本文使用的Google Collaboratory笔记本——眼熟吗？(作者创作)</p></figure><p id="e74e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一个Jupyter笔记本，现在想象你不需要设置任何东西，你不需要担心资源，你做的任何工作都可以在你的设备上和其他人即时共享——这就是Google Collaboratory。这是一项基于云的服务，它复制了我们喜爱的Jupyter笔记本电脑，其工作方式与常规桌面安装相同。</p><p id="1d90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的主要好处是，您不再受到您个人设置的计算资源的限制。您可以在云中运行这些笔记本电脑的多个实例，特别是对于我们的用例，您甚至可以使用GPU资源！</p><h2 id="6fae" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">朱莉娅</h2><p id="ffe3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Julia是一种灵活的动态语言(易于使用)，适用于科学和数值计算(不慢)，其性能可与传统的静态类型语言相媲美(<a class="ae ky" href="https://docs.julialang.org/en/v1/" rel="noopener ugc nofollow" target="_blank"> Julia Docs </a>)。</p><p id="6d38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">茱莉亚于2012年推出，从那以后知名度慢慢增长。它在投资公司的时间序列分析和保险业的风险建模中得到了应用。最值得注意的是，纽约美联储银行使用Julia制作美国经济模型，并指出该语言使模型估计比之前的MATLAB实现“快大约10倍”(<a class="ae ky" href="https://en.wikipedia.org/wiki/Julia_(programming_language)#History" rel="noopener ugc nofollow" target="_blank">维基百科</a>)。</p><p id="bb17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于其高性能的能力，它对ML项目特别有用，允许网络训练比在Python中本地运行快得多。</p><h2 id="654b" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">连接四个</h2><p id="5369" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Connect Four(也有许多其他名字，我最喜欢的名字是<em class="ly"> Gravitrips </em>)是一款双人游戏，玩家选择一种颜色，然后轮流将彩色圆盘投入7x6的格子中。碎片垂直下落，占据塔内最低的可用空间。游戏的目标是第一个形成自己的四个圆盘的水平线、垂直线或对角线。</p><p id="7a43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Connect Four实际上是在1995年解决的，这意味着我们知道如果第一个玩家采取正确的行动，他们总是能赢(完美的行动需要41步)，但要在我们的大脑中存储所有可能的5万亿步并不容易，所以我们改为使用一些策略来解决游戏，导致有趣的游戏方式，使游戏在发布时受到欢迎。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/2ffe6508c439d05339e4ce0fa6c709ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*rwxwPRNhm44aoQVg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">连接四个游戏(<a class="ae ky" href="https://commons.wikimedia.org/wiki/File:Connect_Four.gif" rel="noopener ugc nofollow" target="_blank">维基共享</a>)</p></figure><p id="143a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，所有的部分都固定好了(看到我做了什么吗？)，我们继续任务吧。</p><h1 id="396a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">任务</h1><p id="c2de" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">概括一下，在本文中，我们将实现AlphaZero来玩简单的连接四个的游戏。我们将使用Julia作为基础语言，利用其惊人的速度，在云中这样做，使用Colab笔记本在云中训练。</p><blockquote class="lv lw lx"><p id="a979" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">提醒如果你想跟进:<a class="ae ky" href="https://colab.research.google.com/drive/1UbL2A-56rxr4UwxLk-uWyZ2i88nNmyQk?usp=sharing" rel="noopener ugc nofollow" target="_blank"> AlphaZero谷歌合作实验室笔记本链接</a></p></blockquote><p id="9a40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步，设置环境。Google Colab通常用于Python，但实际上也可以在其中设置不同的环境。为了快速训练我们的神经网络，我们将安装Julia并默认启用IJulia运行时。在附带的笔记本中，这意味着运行第一个单元，然后使用启用的新环境进行刷新。</p><p id="5552" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是从git安装Alphazero的Julia实现。这可以通过运行下一部分来完成。笔记本将连接到git并获取该项目的文件。然后我们将把这个包加载到Julia中，并确保我们已经安装了所有需要的依赖项。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="0fc0" class="mz md it no b gy ns nt l nu nv">run(`git clone --branch v0.3.0 <a class="ae ky" href="https://github.com/jonathan-laurent/AlphaZero.jl.git`)" rel="noopener ugc nofollow" target="_blank">https://github.com/jonathan-laurent/AlphaZero.jl.git`)</a><br/>cd("AlphaZero.jl")<br/>run(`julia --project -e "import Pkg; Pkg.instantiate()"`)</span></pre><p id="35bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装好库后，我们就可以开始训练网络了。这可以用另一个简单的一行程序来执行，它启动了一个运行Alphazero核心算法的脚本。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="65c9" class="mz md it no b gy ns nt l nu nv">run(`julia --project --color=yes scripts/alphazero.jl --game connect-four train`)</span></pre><p id="e020" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将从列出网络的参数开始，用初始化的参数运行一个基准，然后进入第一轮自我游戏。每一轮自我游戏应该持续30分钟到1小时。这将取决于初始化的参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/4aa06f748e57c787ed76381a0914c2bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*qNtIkLY92g1aopbc8pnszw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">参数初始化(作者创建)</p></figure><p id="ca10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到这需要多长时间，最好现在就离开这个会话，几个小时后再回来。在之前的测试中，我发现它会在5-10次迭代中表现良好，这取决于你初始化的运气。</p><p id="b1e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你准备好了，你可以停止运行单元，它会在最近一次迭代时切断训练。这样做的最佳时机是当您看到您的代理在所有基准代理中表现良好时(或者您已经没有耐心了)。注意:如果您决定继续提高代理的能力，也可以随时使用以下单元格重新开始培训。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/d161c6020aba3c8638e9a7b9dffb70c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pZ8CUkhKOnrIq7rbdrn6Sw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一轮自我发挥(作者创作)</p></figure><p id="9f01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是最有趣的——和你的经纪人比赛！希望现在你已经训练出了下一个世界排名前四的玩家，你已经做好了被打败的准备。理想情况下，运行下一个单元将加载您训练过的代理，然后启动一个交互环境，但是…我实际上很难让这部分工作起来。或者，您可以从您的培训工作中下载数据，并在您本地的Julia环境中运行(代理仍然是在云中培训的！).</p><p id="cfbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以通过运行笔记本中的最后一个单元格来下载数据，这将压缩所有数据。或者，您可以导航到sessions/connect-four中的数据，其中包含已学习的网络参数以及用于训练的数据。</p><p id="0130" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你在本地完成设置，你就可以按照<a class="ae ky" href="https://jonathan-laurent.github.io/AlphaZero.jl/dev/tutorial/connect_four/#Examining-the-current-agent" rel="noopener ugc nofollow" target="_blank">有用的维基</a>上的说明进行操作。我和我的经纪人玩了很多游戏，但只有一两次能赢——你玩得怎么样？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/1c2b475fa9c8eac9d4c94a2faa683093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OByRQQnDjCaDPj6_.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">接下来连接四颗星(<a class="ae ky" href="https://github.com/jonathan-laurent/AlphaZero.jl" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><h1 id="0ae0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">后续步骤</h1><p id="b38c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本文中，我们看到了如何在几个小时内使用AlphaZero代理训练connect four代理。所使用的AlphaZero库可以访问其他游戏，你可能想用它们来进行训练实验。你也可以尝试实现不同的游戏，比如Snake(这是我目前正在尝试的Kaggle比赛的一部分！).</p><p id="dbc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这是明确的，任何问题或反馈都欢迎在评论中。</p></div></div>    
</body>
</html>