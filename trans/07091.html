<html>
<head>
<title>Optimising PCR protocol with a primer recommendation system using neural network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于神经网络的引物推荐系统优化PCR方案</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optimising-pcr-with-automated-primer-selection-using-neural-network-f6b15d209808?source=collection_archive---------27-----------------------#2021-06-27">https://towardsdatascience.com/optimising-pcr-with-automated-primer-selection-using-neural-network-f6b15d209808?source=collection_archive---------27-----------------------#2021-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e95b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用一个简单的神经网络自动化一个常规的湿实验室任务</h2></div><p id="f5cb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">四年前，当我在一个病理实验室实习时，我的工作主要是对DNA样本进行测序。虽然这是一个相当容易掌握的技术，但对于一个二年级本科生来说，它给了我一个在湿实验室研究的过山车体验。然而，除了常规的移液、离心和混合溶液，我注意到可以系统地自动化和优化方案的初始步骤，即引物选择步骤。</p><h1 id="0de9" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">简而言之，测序</h1><p id="656c" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">DNA是由4个核酸碱基组成的双链结构:腺嘌呤(A)、胞嘧啶(C)、鸟嘌呤(G)和胸腺嘧啶(T)；使得一条链上的碱基通常以互补(即排他)的方式与另一条链上的另一个碱基结合(即A将与T结合，而C将与G结合)。当突变出现时，这种排他性被打破，并可能导致氨基酸序列的变化，并影响随后的蛋白质翻译过程。我们可以通过<em class="ly">测序</em>(也称为<em class="ly">基因分型)的过程来询问基因组成。</em></p><p id="4338" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了进行DNA测序，我们需要首先通过一种称为聚合酶链式反应(PCR)的技术来扩增感兴趣的区域，通过改变温度，双链结构被分离并退火。正是通过这种“热-再-冷-再”的循环，通过聚合酶促进了DNA复制，并重复进行，直到获得足够数量的DNA片段。</p><p id="687e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与PCR相似，测序也依赖于聚合酶温度的升高和降低。两者之间的主要区别在于它们对核酸碱基的使用。在PCR溶液中，所用的核酸碱基仅由脱氧核苷三磷酸(dNTP)组成，而在测序溶液中，所用的核酸碱基由dNTP和双dNTP (ddNTP)组成。ddNTP和dNTP之间的唯一区别是，d dNTP不允许在复制过程中进一步添加碱基，而dNTP允许。你可以想象在测序过程之后，你会得到多个不同大小的DNA片段，有些只有10个碱基，而有些有20或30个碱基。此外，如果你在ddNTP上放上某种信号，这样当它们放在灯下时会发出颜色，你就能知道第10、20或30位的核苷酸是什么。这样做足够多次，你可以得到感兴趣基因的完整核酸组成。</p><h2 id="538f" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf ln ks mg mh lp kw mi mj lr mk bi translated">引物选择</h2><p id="58c7" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">引物是几个碱基对的短DNA片段。引物通常具有与想要启动DNA复制过程的DNA片段互补的碱基，没有它，聚合酶就不能与DNA链结合。</p><p id="8e1b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据经验，可以根据引物的长度和解链温度(Tm)来选择引物。然而，用手这样做不允许人们容易地观察二级结构稳定性和引物发夹的可能出现(当引物不与感兴趣的区域结合，而是与自身结合时，这些情况)。因此，人们可以求助于公开可用的软件，例如由<a class="ae ml" href="https://www.thermofisher.com/uk/en/home/brands/thermo-scientific/molecular-biology/molecular-biology-learning-center/molecular-biology-resource-library/thermo-scientific-web-tools/multiple-primer-analyzer.html" rel="noopener ugc nofollow" target="_blank"> Thermofischer </a>开发的软件。然而，正如学术界经常出现的情况，一个软件并不包含所有的功能，不同的软件可以给出不同的结果。因此，这个项目的目的是合并这些软件，并有可能创建一个自动化的引子推荐系统。</p><h1 id="40fc" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">方法和游戏计划</h1><h2 id="9ed8" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf ln ks mg mh lp kw mi mj lr mk bi translated">熔化温度计算</h2><p id="b607" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">快速搜索显示，对核苷酸杂交热力学的研究相当广泛，不同的小组给出了不同的计算Tm的方法。一些公式相当基础，只需要每个核苷酸的碱基数量，而其他公式，如等式1中的公式，则更高级，需要核苷酸配对焓和熵的实验值。但是，要弄清楚如何将不同的值插入一个公式并不完全是火箭科学，通过足够的文献回顾，您可以得到表1。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/870490542b865c3196049ac848118050.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*Lo5T5l97s7jK2aiPq2k7UA.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">等式1。由SantaLucia等人(1996年)提供</p></figure><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/e228122964cd7f3af5176806b4e01a87.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*onX5y3NMId91fKNu604rtw.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">表1。37℃下1 M NaCl中统一的寡核苷酸dH和dS参数</p></figure><h2 id="f29d" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf ln ks mg mh lp kw mi mj lr mk bi translated">(英)可视化(= visualization)</h2><p id="8527" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">许多现有软件缺少的特征之一是引物和DNA区域之间杂交的可视化。我们可以将它硬编码到程序中的一种方法是给一条链上的每一个核苷酸分配一个“移位”值，该值对应于另一条链上其互补碱基的位置。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/1fa691fdec7b6b7ae58b9d71d4cbb64b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*e0PaPbGZSVuxd6bhkpFFmQ.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">图二。计算稳定性和可视化二级结构的算法的可视化表示</p></figure><p id="e4ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在图2A中，对于引物5’-ccaaggtagtaatgtatattgag-3’中的每个核苷酸，计算机代码指定一个<em class="ly">移位</em>值，其对应于其反向序列(或者在引物二聚体的情况下，另一个引物的反向序列)中3’-5’方向的互补碱基的位置。例如，5’-3’方向上的最后一个碱基G具有-1和0的<em class="ly">移位</em>值，因为从3’-5’方向上的那个位置开始计数，有两个互补的碱基，一个在相同的位置(0)，另一个在前一个位置(-1)。在图2B中，通过在所有核苷酸上提取相同的<em class="ly">移位</em>值，可以随后可视化二级结构中发生的所有杂交事件。例如，通过将5’-3’引物的6个位置定位在其反向序列的右侧，可以构建具有6个键的自身二聚体结构。在图2C中，使用相同的<em class="ly">移位</em>值，也可以描绘出发夹结构，其中在最里面的两个键之间形成的环的大小必须总是大于或等于三个核苷酸。此外，任何二级结构的热力学值都计算为每个键形成所需能量的总和。</p><p id="f2ec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在python中，移位值列表可以用几行列表理解代码进行硬编码:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="e596" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从那时起，我们可以画出盒子和棍子来可视化杂交事件:</p><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="na nb l"/></div></figure><h2 id="ac74" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf ln ks mg mh lp kw mi mj lr mk bi translated"><strong class="ak">引物选择推荐系统:</strong></h2><p id="e214" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">另一个快速文献综述为我们提供了以下引物选择标准:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a5b41e0aafdddaa0f6ec6d04b83ed4a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*NWWV2F40XRG7iRSkdjFyBQ.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">表二。好底漆的标准</p></figure><p id="efa3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然我们可以将标准硬编码到我们的程序中，并让它输出我们选择的引物是否满足所有标准，但我们可以更进一步，创建一个推荐系统，扫描给定感兴趣基因中所有可能的引物，并根据它们的适用性对它们进行排序。</p><p id="0898" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以首先建立一个引物数据库，然后训练一个模型，将一个模型分为好的或坏的，或者给它们分配一个适合性得分。在这种情况下，我选择了分类模型。在这里，我生成了一组78 206个不同长度的引物对，长度在8到41个碱基之间。它们是由计算机从三种不同的基因中随机产生的。从该数据集中，12 600个随机组合被标记为“好”或“坏”。“不良”引物被定义为在表2的9个特征之一中具有异常值的引物。为了实现所有参考点的完全均匀分布,“不良”引物组由9个统一的特征类别组成，每个类别有700对。</p><h2 id="8f62" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf ln ks mg mh lp kw mi mj lr mk bi translated">模特培训</h2><p id="9ee3" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">标记数据集分为训练集(70%)、交叉验证集(20%)和测试集(10%)。在这里，我利用R <em class="ly">神经网络</em>包来优化ANN模型的计算和可视化，并采用了带权重回溯的弹性反向传播(rprop+)方法，其中学习速率根据偏导数的符号在0.5(-)和1.2(+)之间变化。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/94982d9f7a43e07a80896f666dbff326.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*dJrMkOzvhy3BvEVzYUKxgg.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">图3。训练好的人工神经网络模型</p></figure><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="na nb l"/></div></figure><h1 id="e305" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">我的第一个GUI</h1><p id="e41e" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">我注意到现有软件的一个问题是它们的功能脱节，在显示结果时缺乏透明度。利用Python中的<em class="ly"> tkinter </em>库，我创建了一个具有以下特征的界面:1)可定制的输入，2)实时结果可视化和计算，以及3)有组织的输出。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/a1df6147aef6314513ac6cabad45708f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*ZJyAsGnOpw6dTdXVhJaOCQ.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">图4。帮助界面</p></figure><figure class="mn mo mp mq gt mr"><div class="bz fp l di"><div class="nf nb l"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">图5。结果的实时可视化</p></figure><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/f9a4c1ceb56d83a8db922290fb5d8779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*XxZPEZC2KT2z7oZEVHYrhg.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">图6。有组织的输出和透明的结果</p></figure><h2 id="e1d5" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf ln ks mg mh lp kw mi mj lr mk bi translated">相对重要性</h2><p id="d1f2" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">一旦在训练过程之后将权重分配给9个特征中的每一个。我们可以看到哪些特征最能决定引物选择的适宜性。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/137fdc301567f2f64319cf1669df978f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*Hx8jHxQ8dZJBeCYE5XkjFw.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">图7。基于人工神经网络模型的权重排序</p></figure><p id="6d1e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如所怀疑的，Tm和长度的差异起着最重要的作用，其次是GC含量和其他二级结构。最后，我们可以将这样的权重硬编码到我们的程序中，并可以将每个引物标记为好或坏。</p><h1 id="2157" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">结论</h1><p id="e0ce" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">这是一个有趣的练习，在这里我学会了如何从头开始创建一个GUI，并实现一个简单的ML模型到日常的湿实验室工作中。实际上，这不太可能造成很大的差异，因为在大多数情况下，即使是一个稍微差一点的引物也可能在PCR实验中发挥相当好的作用。然而，二级结构杂交确实会发生，这仅在使用超过50 bp的非常长的引物时才会成为问题，且当这种情况发生时，在PCR溶液中有其它优化的化学成分来解决该问题。然而，如果你想试试这个GUI，你可以在下面找到它。</p><div class="ni nj gp gr nk nl"><a href="https://github.com/lehai-ml/primer-design" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd ir gy z fp nq fr fs nr fu fw ip bi translated">乐海ml/引物设计</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">用于可视化和计算二级结构稳定性的引物设计程序该程序利用热力学…</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">github.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ms nl"/></div></div></a></div><h1 id="d116" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">参考</h1><ol class=""><li id="ed46" class="oa ob iq kh b ki lt kl lu ko oc ks od kw oe la of og oh oi bi translated">小Santa Lucia Allawi，H.T .，Seneviratne，p . a .(1996年)。预测DNA双链稳定性的改进的最近邻参数。<em class="ly">生化</em> <strong class="kh ir"> 35，</strong>3555–3562。</li></ol></div></div>    
</body>
</html>