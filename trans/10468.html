<html>
<head>
<title>MCMC: A Visual Introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MCMC:可视化介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mcmc-a-visual-introduction-38e1d6131e86?source=collection_archive---------29-----------------------#2021-10-05">https://towardsdatascience.com/mcmc-a-visual-introduction-38e1d6131e86?source=collection_archive---------29-----------------------#2021-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="e16a" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">随机抽样方法</h2><div class=""/><div class=""><h2 id="29a5" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">直观解释两种基本采样算法</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/fc23bd1070d87ef6ca89e1dfd3e94ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELnAOLARko0j2_r23-wrgA.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图片由<a class="ae le" href="https://www.shutterstock.com/g/chombosan" rel="noopener ugc nofollow" target="_blank">metarworks</a>在<a class="ae le" href="https://www.shutterstock.com/image-photo/ai-artificial-intelligence-concept-deep-learning-1717584028" rel="noopener ugc nofollow" target="_blank"> shutterstock </a>上拍摄</p></figure><h1 id="b5d8" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">介绍</h1><p id="45c3" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在我以前的文章中，我谈到了卡尔曼滤波器。虽然卡尔曼滤波器对于具有高斯噪声的线性系统是最佳的，但是当给定非线性系统时，该算法失败。</p><h2 id="0117" class="mt lg iq bd lh mu mv dn ll mw mx dp lp mg my mz lr mk na nb lt mo nc nd lv iw bi translated">那么非线性系统呢？</h2><p id="72e8" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">非线性系统的问题在于，在最佳算法的推导中涉及的积分是不可处理的。这些积分阻止了我们评估后验概率、期望值和方差，所有这些都是在构建最优模型时涉及到的。</p><h2 id="9c55" class="mt lg iq bd lh mu mv dn ll mw mx dp lp mg my mz lr mk na nb lt mo nc nd lv iw bi translated"><strong class="ak">我们能解决这些积分吗？</strong></h2><p id="7306" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">虽然在非线性系统中，后验概率通常是难以处理的概率密度函数(PDF)，但它们仍然可以被评估。采样方法的目标是间接采样难处理的PDF。通过随机抽样，我们可以对样本取有限和来近似上述积分。</p><p id="3377" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated"><strong class="lz ja">采样方法通过对难以处理的pdf进行间接随机采样，然后对其进行有限求和，来近似非线性系统解析解中涉及的积分。</strong></p><h1 id="5b62" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">拒绝抽样</h1><p id="9a41" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">拒绝抽样是最简单的抽样技术之一。有了它，我们可以重建难以处理的pdf。我们来看一下算法。</p><p id="9584" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">最初，我们有一个目标PDF，我们不能从PDF中采样，但是，我们可以在任何时候评估它。我们试图从这个棘手的PDF中抽取样本。我们采用剔除抽样:</p><ol class=""><li id="2e7a" class="nj nk iq lz b ma ne md nf mg nl mk nm mo nn ms no np nq nr bi translated">设计一个提案PDF，初步猜测我们的目标PDF</li><li id="5c66" class="nj nk iq lz b ma ns md nt mg nu mk nv mo nw ms no np nq nr bi translated">缩放提案PDF，它必须在每一点上都大于目标</li><li id="6ecf" class="nj nk iq lz b ma ns md nt mg nu mk nv mo nw ms no np nq nr bi translated">提案样本PDF</li><li id="63fe" class="nj nk iq lz b ma ns md nt mg nu mk nv mo nw ms no np nq nr bi translated">评估目标PDF的样本</li><li id="edbb" class="nj nk iq lz b ma ns md nt mg nu mk nv mo nw ms no np nq nr bi translated">根据接受概率接受或拒绝样本</li><li id="0e91" class="nj nk iq lz b ma ns md nt mg nu mk nv mo nw ms no np nq nr bi translated">重复N个样本</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/c1080d856a85ee1bff7be95e4878e037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*l6ocqG4bFwywOqYht3lcDw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="0a2f" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">在上图中，橙色部分是我们希望从中取样的目标PDF。提案PDF在每一点上都是大于目标值的正态分布。</p><p id="333c" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">在拒绝抽样中，我们首先对提案PDF(来自上面的蓝色分布)进行抽样，我们可以在两个PDF上评估这个样本。然后我们决定是否保留样品。</p><p id="1675" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">接受概率等于在目标PDF评估的随机样本和在建议PDF评估的随机样本之间的比率。在上图中，接受随机样本的概率是绿线的长度除以黑线加上绿线的长度。对于上面显示的随机样本，您得到的接受概率约为25%。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/156695295461affdd1993fed0fc9890c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*Et-kG5fOB3z6oD9k949a-A.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="41ea" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">重复多次会产生所示的分布。如您所见，尽管目标PDF难以处理且无法采样，但通过拒绝采样，我们有效地从目标PDF中进行了采样。</p><p id="3855" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">剔除取样的问题是很多样本被剔除。因此，该过程最终相当昂贵。在我的例子中，超过五分之三的数据被拒绝。幸运的是，还有其他更有效的采样方法。</p><h1 id="7357" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">大都会-黑斯廷斯算法</h1><p id="ed31" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在这一节中，我将讨论Metropolis-Hastings算法。让我们一步一步地研究这个算法。</p><p id="d76c" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">我们从一个棘手的目标PDF开始，就像以前一样。目标是间接从这个PDF中取样。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/2900e9c2af9312d64c9f171f97dbf415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*6IrdXUqpFvpfcaa__5ov5w.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><ol class=""><li id="96f2" class="nj nk iq lz b ma ne md nf mg nl mk nm mo nn ms no np nq nr bi translated">首先，我们随机抽取一个样本，并在该样本上评估目标PDF，这在上图中显示为蓝色星号。</li><li id="5ce7" class="nj nk iq lz b ma ns md nt mg nu mk nv mo nw ms no np nq nr bi translated">然后，我们在这个新绘制的样本(蓝色曲线)上构建一个提案PDF。</li><li id="c3e4" class="nj nk iq lz b ma ns md nt mg nu mk nv mo nw ms no np nq nr bi translated">我们从这个新的提案PDF中抽取样本(获得绿色三角形)。</li></ol><p id="cfcc" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">到目前为止还不错，现在变得更难了…</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/5606fab74037cc2fd24f51e19b254cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*7Isnwby9l2pzYETL1OWdsQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="1d8a" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">4.我们现在将我们的提案PDF镜像到新绘制的样本上(绿色曲线，它是一个镜像的提案PDF，平均值在绿色三角形上)。</p><p id="3345" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">5.然后在反射的PDF(蓝色三角形)上评估我们的初始样本，在目标PDF(绿色星号)上评估新绘制的样本。</p><p id="7dad" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">一旦完成，我们就可以决定是否接受或拒绝新的样品。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi gj"><img src="../Images/428d2f4678f3f07fff0df67706e398d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VMMw73kR-47jRHXaMPyGXA.png"/></div></div></figure><p id="3a73" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">接受概率给出了样本被接受的概率。最需要注意的是新样本和当前样本的目标PDF之间的比率(上图中开始之间的比率)。如果这个比率很高，这意味着我们正在向一个峰值移动，我们正在向目标PDF攀升，因此我们希望这个新样本更有可能被选中。</p><p id="4ed0" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">建议的pdf之间的比率(三角形之间的比率)给出了当从一个样本改变到另一个样本时我们在空间中移动的平滑程度的度量。注意，如果建议PDF是对称的(就像我们的例子)，那么这个比率等于1。这是Metropolis-Hastings算法的一个特例，称为Metropolis算法。</p><p id="5725" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">如果样品被接受，我们保留它并重新开始。如果样品被拒绝，我们保留之前的样品。这使得Metropolis-Hastings算法比拒绝采样更有效，当拒绝时，它仍然增加样本。</p><h1 id="b027" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">MCMC和后验概率</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/644083c2a30e70afebefdc316e6f5d3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*o4oL1W_lmnqdO8tlj6VNEQ.png"/></div></figure><p id="3acf" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">在贝叶斯定理中，当似然和先验为高斯时，后验概率有解析解(见我的文章<a class="ae le" rel="noopener" target="_blank" href="/drawing-out-the-posterior-probability-surface-of-a-gaussian-classifier-a1f6044ab5ae">这里</a>)。然而，当这些不是高斯分布时，几乎可以肯定分母中的积分无法求解。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/79a7ff250165e7a2cbc98c3d702bc0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*_ruXUz2xbsiYu3MksoYw8g.png"/></div></figure><p id="cb66" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">以上是Metropolis算法中样本的接受概率，其中建议PDF是对称的。你可以看到它和贝叶斯定理中的后验概率的相似性。通过使用Metropolis算法进行采样，我们对后验数据进行采样。对于无限个样本，我们可以从这些随机样本中完美地逼近后验概率密度函数。</p><h1 id="4fc2" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">结论</h1><p id="3a48" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在本文中，我将介绍两种随机抽样方法，并解释它们的重要性。</p><p id="7abf" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">采样方法可用于对难以处理的pdf进行采样。例如，这些可以是后验概率表面，其中似然和后验不是高斯的。</p><p id="5b95" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">拒绝采样虽然非常简单，但效率极低，因为它最终会拒绝大多数样本。MCMC不拒绝任何样本，使得算法更加经济。</p><h2 id="a3db" class="mt lg iq bd lh mu mv dn ll mw mx dp lp mg my mz lr mk na nb lt mo nc nd lv iw bi translated">支持我</h2><p id="83d0" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">希望这对你有所帮助，如果你喜欢，你可以<a class="ae le" href="https://medium.com/@diegounzuetaruedas" rel="noopener"> <strong class="lz ja">关注我！</strong>T3】</a></p><p id="1628" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated">你也可以成为<a class="ae le" href="https://diegounzuetaruedas.medium.com/membership" rel="noopener"> <strong class="lz ja">中级会员</strong> </a> <strong class="lz ja"> </strong>使用我的推荐链接，获得我所有的文章和更多:<a class="ae le" href="https://diegounzuetaruedas.medium.com/membership" rel="noopener">https://diegounzuetaruedas.medium.com/membership</a></p><h2 id="74f1" class="mt lg iq bd lh mu mv dn ll mw mx dp lp mg my mz lr mk na nb lt mo nc nd lv iw bi translated">你可能喜欢的其他文章</h2><p id="4a40" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated"><a class="ae le" rel="noopener" target="_blank" href="/differentiable-generator-networks-an-introduction-5a9650a24823">可微发电机网络:简介</a></p><p id="fb10" class="pw-post-body-paragraph lx ly iq lz b ma ne ka mc md nf kd mf mg ng mi mj mk nh mm mn mo ni mq mr ms ij bi translated"><a class="ae le" rel="noopener" target="_blank" href="/fourier-transforms-an-intuitive-visualisation-ba186c7380ee">傅立叶变换:直观的可视化</a></p></div></div>    
</body>
</html>