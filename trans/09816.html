<html>
<head>
<title>Automatic Grammar and Spelling Correction with PyTorch — Part 1: A Baseline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyTorch自动语法和拼写纠正—第1部分:基线</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automatic-grammar-and-spelling-correction-with-pytorch-part-1-a-baseline-d97b7202de74?source=collection_archive---------20-----------------------#2021-09-14">https://towardsdatascience.com/automatic-grammar-and-spelling-correction-with-pytorch-part-1-a-baseline-d97b7202de74?source=collection_archive---------20-----------------------#2021-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="201d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">建立一个深层的变压器网络，纠正英语句子</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c1d14fa350928e75783ca09723e5d280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3WycjYoOhAdqgXUOAyiCBg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">阿伦·普拉卡什在<a class="ae kv" href="https://unsplash.com/s/photos/errors?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="82c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我是Grammarly或Reverso等服务的忠实粉丝，这些服务可以帮助纠正语法和拼写错误。这促使我建立了一个更简单的机器学习基线，可以自动纠正英语句子。</p><p id="97a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本帖中，我们将介绍序列到序列转换器模型的实现和训练，该模型将输入一个有潜在错误的句子，然后在纠正所有错误后生成相同的句子。这类似于在<a class="ae kv" href="https://arxiv.org/abs/1910.13461" rel="noopener ugc nofollow" target="_blank">巴特</a>中所做的。</p><h1 id="6170" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">数据</h1><p id="d54b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">对于这种基线方法，我们将仅使用合成数据来训练该模型。我们将使用维基百科中的句子。然后，对于每个句子，我们将生成一个“受干扰”的句子，其中有随机的人工拼写和语法错误。这给了我们一个<em class="mp"> (input，output) </em>对，其中输入是有错误的句子，输出是原来的句子。</p><p id="0137" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们假设大部分原始维基百科句子不包含错误。</p><p id="8b99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用合成数据的好处是它们是免费的，我们可以免费生成我们想要的数据。缺点是它们可能不像人们犯的语法和拼写错误的真实例子那样真实或有用。</p><p id="31a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总之，我们实现了11种原始句子的随机变换。</p><h2 id="00b3" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">随机扰动的例子:</h2><h2 id="3799" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">小写:</h2><p id="ab17" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">原句:</p><ul class=""><li id="5a17" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><strong class="ky ir"> <em class="mp">这个</em> </strong> <em class="mp">是一个例句</em></li></ul><p id="eb96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转换句子:</p><ul class=""><li id="4366" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><strong class="ky ir"> <em class="mp">这个</em> </strong> <em class="mp">是一个例句</em></li></ul><h2 id="6333" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">删除随机单词:</h2><p id="6aea" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">原句:</p><ul class=""><li id="4b7d" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><strong class="ky ir"> <em class="mp">这个</em> </strong> <em class="mp">是一个例句</em></li></ul><p id="44f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转换句子:</p><ul class=""><li id="35b8" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><em class="mp">是一个例句</em></li></ul><h2 id="eb6b" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">改变动词形式:</h2><p id="cf83" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">原句:</p><ul class=""><li id="378d" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><em class="mp">这个</em> <strong class="ky ir"> <em class="mp">是</em> </strong> <em class="mp">的一个例句</em></li></ul><p id="d09e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转换句子:</p><ul class=""><li id="358d" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><em class="mp">这个</em> <strong class="ky ir"> <em class="mp">分别是</em> </strong> <em class="mp">一个例句</em></li></ul><h2 id="7896" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">扰乱随机词:</h2><p id="a29f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">原句:</p><ul class=""><li id="11f8" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><em class="mp">这是一个</em> <strong class="ky ir"> <em class="mp">例句</em> </strong> <em class="mp">句子</em></li></ul><p id="d05f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转换句子:</p><ul class=""><li id="4575" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><em class="mp">这是一个</em> <strong class="ky ir"> <em class="mp">宠爱</em> </strong> <em class="mp">的句子</em></li></ul><p id="be79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">等等…</p><p id="e6da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在将它们依次应用于原句之前，我们随机挑选了其中的3个。这些扰动中的每一个都与一个权重相关联，该权重决定了它们被选取的频率。</p><p id="0b66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是使用此过程生成的<em class="mp">(输入，输出)</em>对的示例:</p><h2 id="264d" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak">输入(或受干扰的句子):</strong></h2><ul class=""><li id="d9c0" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><em class="mp">地基</em> <strong class="ky ir"> <em class="mp">是</em> </strong> <em class="mp">的河漂石；外墙</em> <strong class="ky ir"> <em class="mp">是</em> </strong> <em class="mp">红砖加砂岩点缀。</em></li></ul><h2 id="0401" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">输出(或原句):</h2><ul class=""><li id="0bed" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><em class="mp">地基</em> <strong class="ky ir"> <em class="mp">是河流巨砾的</em></strong><em class="mp">；外墙</em> <strong class="ky ir"> <em class="mp">为</em> </strong> <em class="mp">红砖加砂岩点缀。</em></li></ul><p id="9dfd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，我们可以看到，被打乱的句子中动词“to be”的形式和“is”的大小写都是错误的。</p><h1 id="8199" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">模型</h1><p id="d752" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将要使用的模型架构与论文<a class="ae kv" href="https://arxiv.org/abs/1706.03762" rel="noopener ugc nofollow" target="_blank">中介绍的相同</a>。这个模型有一个编码器变压器和一个解码器变压器，注意这两者之间。</p><p id="1c49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">编码器处理有潜在拼写或语法错误的句子，而解码器生成有所有更正的句子。</p><p id="3ad8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解码器是一个自回归模型，我们在训练中使用教师强制。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/41c1305da7031eab829ca9f8c2183048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0c-OMBj_i7fR6qnBXmf6g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型架构——作者图片</p></figure><p id="3f83" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个模型将学习复制输入的句子，同时纠正它的错误。</p><p id="6f4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在解码器的每个时间步骤，模型可以“注意”输入句子的每个标记以及在解码句子中出现在它之前的每个标记。正是这种关注使得模型能够挑选信息，用于预测解码过程中的下一个令牌。</p><p id="fa66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用RTX 3080在大约800万个维基百科句子上训练这个模型大约两天。</p><h1 id="bd09" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">示例预测</h1><p id="b43a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在是时候看看训练有素的模型了:</p><h2 id="2314" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">示例1:</h2><h2 id="dbb2" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">有错误的句子:(an而不是a)</h2><ul class=""><li id="f4d1" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><em class="mp">这是爱尔兰</em><strong class="ky ir"><em class="mp"/></strong><em class="mp">对2010年的总结。</em></li></ul><h2 id="a919" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">由模型更正的句子:</h2><ul class=""><li id="cf33" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><em class="mp">这是2010年爱尔兰</em><strong class="ky ir"><em class="mp"/></strong><em class="mp">的总结。</em></li></ul><p id="31d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型用“a”代替了“an”。</p><h2 id="c4e5" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">示例2:</h2><h2 id="b0f8" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">有错误的句子:(错误的大写+复数而不是单数)</h2><ul class=""><li id="d987" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><strong class="ky ir"> <em class="mp">马蒂诺</em> </strong> <em class="mp">是</em>  <em class="mp">的一部分</em> <strong class="ky ir"> <em class="mp">音乐</em> <strong class="ky ir"> <em class="mp">项目</em> </strong> <em class="mp"> </em> <strong class="ky ir"> <em class="mp">埃斯佩里克</em> </strong> <em class="mp"> </em> <strong class="ky ir"> <em class="mp">炫目</em> </strong> <em class="mp">。</em></strong></li></ul><h2 id="aedd" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">由模型更正的句子:</h2><ul class=""><li id="e814" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><strong class="ky ir">马蒂诺</strong>是的<strong class="ky ir">部分，音乐<strong class="ky ir">投射</strong> <strong class="ky ir">埃斯佩里克</strong> <strong class="ky ir">眩光</strong>。</strong></li></ul><p id="c8aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，模型能够纠正大写错误，但不能解决复数问题。</p><h2 id="fdeb" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">示例3:</h2><h2 id="dace" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">有错误的句子:(错误的动词形式+拼写错误)</h2><ul class=""><li id="9ae9" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated">何 <strong class="ky ir"> <em class="mp">被</em> </strong> <em class="mp">选入</em>西<em class="mp">孟加拉</em> <strong class="ky ir"> <em class="mp">立法院</em></strong><em class="mp">1962年从巴拉萨特选区击败前进集团领袖奇塔巴苏。</em></li></ul><h2 id="7b0c" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">由模型更正的句子:</h2><ul class=""><li id="6f0a" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><em class="mp">何</em> <strong class="ky ir"> <em class="mp">曾于1962年从巴拉萨特选区击败前进集团领袖奇塔巴苏</em> <strong class="ky ir"> <em class="mp">当选西孟加拉邦【立法】</em> </strong> <em class="mp">议员。</em></strong></li></ul><p id="edb3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里的模型使用了动词“to be”的正确形式，并修复了拼写错误。</p><p id="4fc0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从这些例子中我们可以看出，模型学习了单词的正确拼写，以及动词的正确形式。它仍然有一些问题固定单词的单数/复数形式。有趣的是，该模型可以正确地复制像“Barasat”或“Basu”这样的罕见或不常见的单词，这正是我们想要的。</p><h1 id="df8b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="0282" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这个项目中，我们实现了拼写和语法纠正的基线方法。这个模型在PyTorch <a class="ae kv" href="https://github.com/CVxTz/xumi" rel="noopener ugc nofollow" target="_blank">(见代码)</a>中实现起来很简单，并且可以修复明显的错误，就像上面例子中看到的那样。下一步是更严格地评估模型，然后通过使用其他训练集来改进其性能。</p><h2 id="f76b" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">来源:</h2><ul class=""><li id="80c9" class="nc nd iq ky b kz mk lc ml lf nl lj nm ln nn lr nh ni nj nk bi translated"><a class="ae kv" href="http://norvig.com/ngrams/spell-errors.txt" rel="noopener ugc nofollow" target="_blank">http://norvig.com/ngrams/spell-errors.txt</a></li><li id="62aa" class="nc nd iq ky b kz np lc nq lf nr lj ns ln nt lr nh ni nj nk bi translated"><a class="ae kv" href="https://pytorch.org/tutorials/beginner/transformer_tutorial.html" rel="noopener ugc nofollow" target="_blank">https://py torch . org/tutorials/初学者/transformer_tutorial.html </a></li><li id="c36d" class="nc nd iq ky b kz np lc nq lf nr lj ns ln nt lr nh ni nj nk bi translated"><a class="ae kv" href="https://github.com/monolithpl/verb.forms.dictionary" rel="noopener ugc nofollow" target="_blank">https://github.com/monolithpl/verb.forms.dictionary</a></li></ul></div></div>    
</body>
</html>