<html>
<head>
<title>How to tune multiple ML models with GridSearchCV at once?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用GridSearchCV一次调优多个ML模型？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-tune-multiple-ml-models-with-gridsearchcv-at-once-9fcebfcc6c23?source=collection_archive---------4-----------------------#2021-10-30">https://towardsdatascience.com/how-to-tune-multiple-ml-models-with-gridsearchcv-at-once-9fcebfcc6c23?source=collection_archive---------4-----------------------#2021-10-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ae92" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">加快您的型号选择工作流程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ff1699059c65a691fc29b07663fa1326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQlFu35e3dhNKmuuEDYh_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/ltdatehu-9079918/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1095751" rel="noopener ugc nofollow" target="_blank"> LTD EHU </a>发自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1095751" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="334d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型选择是数据科学模型开发流程的重要组成部分。在执行特征工程之后，数据科学家需要选择具有最佳超参数集的模型，该模型对于训练数据集表现最佳。有各种自动化模型选择组件的Auto-ML库。</p><p id="f4e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网格搜索是一种交叉验证技术，可用于调整机器学习模型的超参数。为了从ML模型列表中选择稳健模型，需要对每个模型进行多次交叉验证。在本文中，我们将讨论使用网格搜索和随机搜索交叉验证同时调优多个模型的技巧。</p><h2 id="458b" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">什么是网格搜索和随机搜索交叉验证？</h2><p id="5214" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">GridSearchCV或RandomizedSearchCV是交叉验证技术，用于执行超参数调整，以确定机器学习模型的最佳值。理想情况下，GridSearchCV会尝试所有可能的参数值，而RandomizedSearchCV会随机选取参数并加速交叉验证工作流。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)，GridSearchCV实现</p></figure><p id="ca37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述代码片段可用于为随机森林分类器模型选择最佳超参数集。</p><p id="ba99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理想情况下，GridSearchCV或RandomizedSearchCV需要为多个机器学习模型运行多个管道，以挑选具有最佳超参数值集的最佳模型。数据科学家可能会花很多时间来开发代码并研究它。</p><p id="26c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过创建多个参数字典并为每个字典指定模型，可以使用GridSearchCV或RandomizedSearchCV同时调整多个机器学习模型。一次调优多个模型的逐步方法是:</p><ol class=""><li id="a1a3" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated">初始化多分类器估计器</li><li id="cf95" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">准备第一个分类器的管道。</li><li id="4ebf" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">准备每个估计量的超参数字典，每个估计量都有一个作为“分类器”的关键字和作为估计量对象的值。超参数键应该以分类器的单词开始，用“__”分隔(双下划线)。</li><li id="324d" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">列出超参数字典。</li><li id="20cd" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">使用管道和参数字典列表训练GridSearchCV模型。</li></ol><h2 id="5c71" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">实施:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)</p></figure><p id="dd57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用了一个包含大约5000个实例和29个独立特征的样本二元分类数据集。为了训练一个健壮的机器学习模型，我已经初始化了7个机器学习估计器，包括:</p><ul class=""><li id="dc60" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu nj nb nc nd bi translated">随机森林</li><li id="669d" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nj nb nc nd bi translated">支持向量分类器</li><li id="1c02" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nj nb nc nd bi translated">逻辑回归</li><li id="602a" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nj nb nc nd bi translated">决策图表</li><li id="f609" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nj nb nc nd bi translated">k-最近邻</li><li id="ff8c" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nj nb nc nd bi translated">朴素贝叶斯</li><li id="ca16" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nj nb nc nd bi translated">梯度推进</li></ul><p id="1fa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并进一步用变量名<code class="fe nk nl nm nn b"><strong class="lb iu">param_i</strong></code>准备了它们对应的超参数字典。</p><p id="80f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Scikit-learn包附带了GridSearchCV实现。我已经将带有管道和参数字典列表的第一个估计器传递给GridSearchCV模型。</p><p id="05d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GridSearchCV需要120秒来训练7个估计器的176个模型。具有<code class="fe nk nl nm nn b"><strong class="lb iu">C=10</strong></code>、<code class="fe nk nl nm nn b"><strong class="lb iu">class_weight=None</strong></code>、<strong class="lb iu">、</strong>的支持向量分类器表现最好，交叉验证ROC AUC得分为0.984，测试ROC AUC得分为0.979。</p><p id="0b40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">RandomizedSearchCV模型需要9秒来训练同一组模型。相同的支持向量分类器产生执行最好的结果。</p><h1 id="710f" class="no lw it bd lx np nq nr ma ns nt nu md jz nv ka mg kc nw kd mj kf nx kg mm ny bi translated">结论:</h1><p id="1a97" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在本文中，我们讨论了GridSearchCV和RandomizedSearchCV如何用于同时调优多个机器学习模型。这是一种非常方便的技术，可以加快模型选择工作流程。</p><h1 id="0fbd" class="no lw it bd lx np nq nr ma ns nt nu md jz nv ka mg kc nw kd mj kf nx kg mm ny bi translated">参考资料:</h1><p id="edb1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">[1] Scikit-learn文档:<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . model _ selection。GridSearchCV.html</a></p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="b828" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">喜欢这篇文章吗？成为 <a class="ae ky" href="https://satyam-kumar.medium.com/membership" rel="noopener"> <em class="og">中等会员</em> </a> <em class="og">继续无限制学习。如果你使用下面的链接，我会收到你的一小部分会员费，不需要你额外付费。</em></p><div class="oh oi gp gr oj ok"><a href="https://satyam-kumar.medium.com/membership" rel="noopener follow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">加入我的推荐链接-萨蒂扬库马尔媒体</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">satyam-kumar.medium.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ks ok"/></div></div></a></div><blockquote class="oz"><p id="3f9d" class="pa pb it bd pc pd pe pf pg ph pi lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>