<html>
<head>
<title>How to split data into three sets (train, validation, and test) And why?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将数据分成三组(训练、验证和测试)，为什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-split-data-into-three-sets-train-validation-and-test-and-why-e50d22d3e54c?source=collection_archive---------0-----------------------#2021-05-17">https://towardsdatascience.com/how-to-split-data-into-three-sets-train-validation-and-test-and-why-e50d22d3e54c?source=collection_archive---------0-----------------------#2021-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="839d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Sklearn火车测试拆分不够。我们需要更好、更快的东西</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/35a96ba039c3642d965a7fb2ee77cdef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hyoDzpzBFu-gzK0Y_qrEQA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@nate_dumlao?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">内森·杜姆劳</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="f34c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="3866" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">为什么需要拆分数据？</strong></p><p id="8322" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您不希望您的模型过度学习训练数据，并在部署到生产中后表现不佳。你需要有一个机制来评估你的模型推广的有多好。因此，您需要将输入数据分成训练、验证和测试子集，以防止模型过度拟合，并有效地评估模型。</p><p id="7b92" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这篇文章中，我们将涉及以下内容。</p><ol class=""><li id="65c4" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">培训、验证和测试数据集的简要定义</li><li id="b5cd" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">准备好使用代码来创建这些数据集(2种方法)</li><li id="4bd1" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">了解数据集分割率背后的科学原理</li></ol></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="d00c" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">训练有效测试分割的定义</h1><p id="d69d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">训练有效测试分割是一种评估机器学习模型性能的技术，无论是分类还是回归。你把一个给定的数据集分成三个子集。下面是对每个数据集的作用的简要描述。</p><h2 id="98f9" class="ns la it bd lb nt nu dn lf nv nw dp lj ma nx ny ll me nz oa ln mi ob oc lp od bi translated">训练数据集</h2><ul class=""><li id="a426" class="ms mt it lt b lu lv lx ly ma oe me of mi og mm oh my mz na bi translated">用于学习(由模型)的数据集，即，使参数适合机器学习模型</li></ul><h2 id="a054" class="ns la it bd lb nt nu dn lf nv nw dp lj ma nx ny ll me nz oa ln mi ob oc lp od bi translated">有效数据集</h2><ul class=""><li id="7efd" class="ms mt it lt b lu lv lx ly ma oe me of mi og mm oh my mz na bi translated">调整模型超参数时，用于对符合训练数据集的模型进行无偏评估的数据集。</li><li id="6025" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated">也在其他形式的模型准备中发挥作用，如特征选择、阈值截止选择。</li></ul><h2 id="a805" class="ns la it bd lb nt nu dn lf nv nw dp lj ma nx ny ll me nz oa ln mi ob oc lp od bi translated">测试数据集</h2><ul class=""><li id="cd10" class="ms mt it lt b lu lv lx ly ma oe me of mi og mm oh my mz na bi translated">一组数据，用于对符合训练数据集的最终模型进行无偏评估。</li></ul><p id="782e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想了解更多关于机器学习专家如何定义训练、测试和验证数据集的信息，请阅读Jason Brownlee的这篇文章。#1下面参考资料部分的链接</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="cb41" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">准备使用代码片段</h1><p id="08e9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本帖中，我们将看到将数据分为训练、有效和测试集的两种方法</p><ol class=""><li id="bbaf" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">随机分裂</li><li id="619d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">使用时间分量进行分割</li></ol><h1 id="fa3e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.随机分裂</h1><p id="a6ad" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您无法使用用于训练的相同数据来评估模型的预测性能。如果你用模型之前没有见过的<strong class="lt iu">新数据</strong>来评估模型，那是最好的。随机分割数据是该<strong class="lt iu">无偏评估最常用的方法。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/3b23bfebdde9a4534872b48b81570f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f2KznlrIdj1MeobprVGBtg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将输入数据随机分为训练集、有效集和测试集。作者图片</p></figure><blockquote class="oj ok ol"><p id="5b83" class="lr ls om lt b lu mn ju lw lx mo jx lz on mp mc md oo mq mg mh op mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it">一、使用sk learn→‘train _ test _ split’</em></strong></p></blockquote><p id="80ef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下面的代码片段中，您将学习如何使用两次<code class="fe oq or os ot b">train_test_split</code>来创建我们期望比例的train | valid | test数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure><blockquote class="oj ok ol"><p id="d543" class="lr ls om lt b lu mn ju lw lx mo jx lz on mp mc md oo mq mg mh op mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it">二世。使用Fast _ ml →' train _ valid _ test _ split '</em>T5】</strong></p></blockquote><p id="467c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下面的代码片段中，您将学习如何使用<code class="fe oq or os ot b">train_valid_test_split</code>在一行代码中创建我们期望比例的train | valid | test数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure><h1 id="d2f5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2)使用时间分量进行分割</h1><p id="f780" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可以听听杰瑞米·霍华德关于机器学习的fast.ai讲座:<a class="ae ky" href="https://www.fast.ai/2018/09/26/ml-launch/" rel="noopener ugc nofollow" target="_blank">程序员机器学习入门</a>。在第3课中，他谈到了<em class="om">“什么是好的验证集，我们利用这个讨论来为这个新数据选择一个验证集。”#2 </em></p><p id="2aab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">他举了一个例子，“假设您正在构建一个模型来预测下个月的销售额。如果你无法知道你建立的模型是否能够提前一个月预测销量，那么你也无法知道当你将一个模型投入生产时，它是否会变得更好。”#3 </p><p id="8144" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">每当数据集包含日期变量，并且我们希望预测未来的事情时，使用时态变量是拆分数据集的一种更可靠的方法。因此，我们必须使用最新的样本来创建验证和测试数据集。主要思想是始终选择一个样本子集，忠实地代表我们的模型随后将接收到的数据(无论我们面对的是现实世界的问题还是Kaggle竞争)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/f2180ed9e0ecb03d9a14bf9542c29021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AxtaQkMAJQe4dM5egTX2Uw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对数据进行排序后，训练有效的测试数据集。作者图片</p></figure><blockquote class="oj ok ol"><p id="8de4" class="lr ls om lt b lu mn ju lw lx mo jx lz on mp mc md oo mq mg mh op mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it">一、自定义代码</em> </strong></p></blockquote><p id="1ab4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下面的代码片段中，您将学习如何编写自定义代码，以便在对数据进行排序后，创建符合我们期望比例的train | valid | test数据集。稍加修改后，您可以直接使用这段代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure><blockquote class="oj ok ol"><p id="8c9e" class="lr ls om lt b lu mn ju lw lx mo jx lz on mp mc md oo mq mg mh op mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it">二世。使用Fast _ ml →' train _ valid _ test _ split '</em></strong></p></blockquote><p id="d2e5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下面的代码片段中，您将学习如何在对数据进行排序后，使用<code class="fe oq or os ot b">train_valid_test_split</code>来创建我们期望比例的train | valid | test数据集。所有这些都在一行代码中完成。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="8c89" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">数据集分割率背后的科学</h1><p id="1a82" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">经常有人问，将数据集分成训练集、验证集和测试集的比例是多少？</p><p id="490f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个决定主要取决于两件事。首先是数据中的样本总数，其次是您正在训练的实际模型。</p><ul class=""><li id="284e" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm oh my mz na bi translated">有些模型需要大量的数据来进行训练，因此在这种情况下，您可以针对更广泛的训练集进行优化。</li><li id="2b24" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated">具有很少超参数的模型将易于验证和调整，因此您可以减少验证集的大小。</li><li id="9e61" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated">但是，如果您的模型有许多超参数，您也会希望有一个重要的验证集。</li><li id="5568" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated">如果您碰巧有一个没有超参数或者不容易调整的模型，您可能也不需要验证集。</li></ul><h1 id="7355" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">参考文献</strong></h1><p id="6b28" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"># 1<a class="ae ky" href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/difference-test-validation-datasets/</a># 2<a class="ae ky" href="https://www.fast.ai/2018/09/26/ml-launch/" rel="noopener ugc nofollow" target="_blank">https://www.fast.ai/2018/09/26/ml-launch/</a><br/># 3<a class="ae ky" href="https://www.youtube.com/watch?v=YSFG_W8JxBo" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=YSFG_W8JxBo</a></p><h1 id="0107" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">感谢阅读！！</h1><ul class=""><li id="7afc" class="ms mt it lt b lu lv lx ly ma oe me of mi og mm oh my mz na bi translated">如果你喜欢这个，<a class="ae ky" href="https://samarthagrawal86.medium.com/" rel="noopener">关注我的medium </a>了解更多。</li><li id="051f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated">有兴趣合作吗？我们上<a class="ae ky" href="https://www.linkedin.com/in/samarth-agrawal-2501/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>连线吧。</li><li id="3c86" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated">请随意写下您的想法/建议/反馈。</li><li id="ce57" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated"><a class="ae ky" href="https://www.kaggle.com/nextbigwhat/train-valid-test-split-instead-of-train-test-split" rel="noopener ugc nofollow" target="_blank">卡格尔链接</a></li><li id="1f44" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm oh my mz na bi translated"><a class="ae ky" href="https://pypi.org/project/fast-ml/" rel="noopener ugc nofollow" target="_blank"> Fast_ml链接</a></li></ul><p id="2fb4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">笔记本可在以下位置获得，并附有完整的功能代码:</p><div class="ow ox gp gr oy oz"><a href="https://www.kaggle.com/nextbigwhat/train-valid-test-split-instead-of-train-test-split" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">train_valid_test_split代替train_test_split</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">使用Kaggle笔记本探索和运行机器学习代码|使用推土机蓝皮书中的数据</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">www.kaggle.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ks oz"/></div></div></a></div></div></div>    
</body>
</html>