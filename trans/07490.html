<html>
<head>
<title>How to Deal with an Imbalanced Dataset in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中如何处理不平衡数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-deal-with-an-imbalanced-dataset-in-machine-learning-4f89a1967868?source=collection_archive---------24-----------------------#2021-07-08">https://towardsdatascience.com/how-to-deal-with-an-imbalanced-dataset-in-machine-learning-4f89a1967868?source=collection_archive---------24-----------------------#2021-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f62c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">6种不同的技术来解决你将面临的最常见的问题之一。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3256e0284faf8f6a1e41222deecc43ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jtoMO6P8twdqULUIwZLFiA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@brianna_santellan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">陈伶俐·桑特兰</a>在<a class="ae ky" href="https://unsplash.com/s/photos/dog-cat?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="04ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不平衡的数据集是我们需要处理的一个常见问题，是每个机器学习面试问题集合中的一个主要部分。</p><p id="60e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从一个例子开始:</p><p id="56f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设你正在尝试建立一个分类模型，你有两个类:猫和狗。不幸的是，你的数据非常不准确:有950张猫图片和50张狗图片。</p><p id="5276" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你的模型把每张图片都归类为猫(哑巴吧？)，你就95%准确了！想一想。数据集中的分布很快成为一个大问题。</p><p id="5a67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们试着解决这个问题。</p><h2 id="eac2" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">1.确保您正确地描述了问题</h2><p id="f9e1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在很多情况下，不均衡的班级可能会提供一个以不同的方式看待问题的机会。</p><p id="680e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">制造缺陷、信用卡欺诈、垃圾邮件。这些问题属于同一类别:数据集中的绝大多数样本将代表正常类，只有少数异常代表不同类。</p><p id="2381" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数时候，你最好将这些视为<a class="ae ky" href="https://en.wikipedia.org/wiki/Anomaly_detection" rel="noopener ugc nofollow" target="_blank">异常检测</a>问题，你的主要目标是识别数据集中的异常值。</p><p id="2bc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mt">作为一个相关的提示，确保你使用正确的算法来解决你的问题。例如，基于决策树的模型在处理不平衡的类方面非常出色。当处理结构化数据时，这可能就是您所需要的。</em></p><h2 id="a0b7" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">2.在这些问题上，准确性不是最好的性能指标</h2><p id="bc52" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当数据集不平衡时，精确度不是一个好的性能指标。</p><p id="4e9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，根据您的具体问题，您应该查看以下内容:</p><ul class=""><li id="9fa5" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">精确度、召回率、F值</li><li id="950b" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">混淆矩阵</li><li id="71cb" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">ROC曲线</li></ul><h2 id="d1b8" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">3.收集更多数据</h2><p id="13fd" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我总是喜欢从这里开始。</p><p id="c4e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，我们也许能够找到更多的狗的图片添加到数据集中，并减少差异。</p><p id="6d17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，收集更多的数据并不总是一个选项。但有时确实如此，然而许多团队过早地诉诸合成增强。</p><h2 id="063d" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">4.用合成数据扩充数据集</h2><p id="9445" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">只有当收集更多的数据不可行时，我才会去编造假样本。当处理非结构化数据(比如图像、视频、文本、音频)时，这是一个很好的方法。</p><p id="c256" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可以通过转换现有的图片来创建新的狗图片:</p><ul class=""><li id="1cee" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">改变图像的对比度</li><li id="4878" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">做水平翻转</li><li id="d6f8" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">向两个方向轻微旋转图片</li><li id="a668" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">添加一些噪声</li></ul><p id="3a1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结合这些技术可以产生许多看起来和原始图片一样真实的新样本。</p><p id="1f63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于结构化数据(想想表格数据)，扩充要困难得多，有时甚至不可能。</p><h2 id="b929" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">5.对数据集进行重新采样</h2><p id="8e1f" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">有三种不同的方法可以对数据集进行重采样:</p><ul class=""><li id="e2d9" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">过采样:多次拍摄我们拥有的图片。</li><li id="297b" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">欠采样:取一些我们有的图片，丢弃其余的。</li><li id="00d5" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">结合两种技术:对一个类进行过采样，同时对另一个类进行欠采样。</li></ul><p id="5335" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以通过以下方式对数据进行重新采样:</p><ul class=""><li id="57c9" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">每张狗图片使用4次。这将以总共400张狗图片(50张现有图片× 4)结束。)</li><li id="c5c0" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">使用每隔一张猫图片。这将导致总共475张猫图片(950张现有图片÷ 2)。)</li></ul><p id="7634" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，过采样和欠采样会给你的数据集带来偏差:你是在通过任意改变现有样本来改变数据分布。这可能会有后果，所以要仔细考虑。</p><h2 id="c240" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">6.适当调整每个类别的权重</h2><p id="a874" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">您可以修改您的模型的损失函数，以不同的方式对每个类别进行加权，从而解决不平衡问题。查看<a class="ae ky" href="https://tensorflow.google.cn/api_docs/python/tf/keras/Model#fit" rel="noopener ugc nofollow" target="_blank"> <em class="mt"> Kera's fit() </em> </a>函数上的<em class="mt"> sample_weight </em>属性作为示例:</p><blockquote class="ni nj nk"><p id="a26e" class="kz la mt lb b lc ld ju le lf lg jx lh nl lj lk ll nm ln lo lp nn lr ls lt lu im bi translated">训练样本的可选权重数组，用于加权损失函数(仅在训练期间)。)</p></blockquote><p id="124b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成本敏感学习是另一种相关的技术，您也可以使用它根据每个类的权重来惩罚模型的结果。我写了一篇关于成本敏感学习的简短介绍，应该会有所帮助。</p><h2 id="4c27" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">一锤定音</h2><p id="9379" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这些我一般都是按顺序想的。现在，系统地沿着这个清单往下走已经成了第二天性。</p><p id="6882" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数情况下，需要不止一种技术来解决问题。每一次，实验都会告诉你正确的方法。</p></div></div>    
</body>
</html>