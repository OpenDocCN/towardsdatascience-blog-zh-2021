<html>
<head>
<title>Making it Rain with Raincloud Plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用雨云图让它下雨</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-it-rain-with-raincloud-plots-496c39a2756f?source=collection_archive---------6-----------------------#2021-05-24">https://towardsdatascience.com/making-it-rain-with-raincloud-plots-496c39a2756f?source=collection_archive---------6-----------------------#2021-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cc0e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用python实现ptitprince库以创建健壮的数据可视化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ea5b3a93bbb5d1f86bdf73e6335b9cda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GE9o6WRQyvToC7oqMEumAQ.jpeg"/></div></div></figure><h1 id="009e" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">什么是雨云图</strong></h1><p id="4456" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">雨云图是一种直观、可靠和透明的数据可视化形式。它本质上是一个violin + boxplot + jittered dataset组合，通过中位数和置信区间很好地提供了原始数据、概率分布和统计推断的概览。这可以为用户提供个人观察和一般模式的信息。</p><p id="0655" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">要了解更多关于雨云地块的细节和背景，请阅读原文:</p><div class="mn mo gp gr mp mq"><a href="https://wellcomeopenresearch.org/articles/4-63/v2" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">威康开放研究文章:雨云图:稳健数据的多平台工具…</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">Allen M，Poggiali D，Whitaker K等。雨云图:一种用于稳健数据可视化的多平台工具[第2版…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">wellcomeopenresearch.org</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne ks mq"/></div></div></a></div></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="f963" class="ku kv it bd kw kx nm kz la lb nn ld le jz no ka lg kc np kd li kf nq kg lk ll bi translated">下雨了</h1><p id="71f8" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">要开始创建raincloud地块，必须首先导入必要的库。这个例子是从<a class="ae nr" href="https://github.com/pog87/PtitPrince" rel="noopener ugc nofollow" target="_blank"> ptitprince库</a>构建的，这个库是由<a class="ae nr" href="https://github.com/pog87" rel="noopener ugc nofollow" target="_blank"> David Pogialli </a>创建的。它是raincloud plots的python实现，基于Micah Allen的原始R + ggplot代码。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="c1e3" class="nx kv it nt b gy ny nz l oa ob">import pandas as pd<br/>import seaborn as sns<br/>import os<br/>import matplotlib.pyplot as plt<br/>#sns.set(style="darkgrid")<br/>#sns.set(style="whitegrid")<br/>#sns.set_style("white")<br/>sns.set(style="whitegrid",font_scale=2)<br/>import matplotlib.collections as clt</span><span id="eed7" class="nx kv it nt b gy oc nz l oa ob">import ptitprince as pt</span></pre><p id="3801" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">加载数据</strong></p><p id="ae53" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">对于这个笔记本，我们使用了ptitprince存储库提供的样本数据。这里有一个google drive <a class="ae nr" href="https://drive.google.com/file/d/1RG1gQaUlVzH3GfBlfojPZ_ztuFKF2Sm7/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">链接</a>用于下载个人使用的数据。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="8794" class="nx kv it nt b gy ny nz l oa ob">df = pd.read_csv ("simdat.csv", sep= ",")<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/e90ab62cbc2b2b5042d4d21de2a617b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*84QGx3I6EwaSiB_49TgMNg.png"/></div></div><p class="oe of gj gh gi og oh bd b be z dk translated">数据帧的头部</p></figure><p id="efd9" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">探索数据</strong></p><p id="ff76" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在绘制雨云图之前，我们用一个简单的条形图来观察每个测量值的分布。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="982d" class="nx kv it nt b gy ny nz l oa ob">sns.barplot(x = "group", y = "score", data = df, capsize= .1)<br/>plt.title("Figure P1\n Bar Plot")</span><span id="f2a7" class="nx kv it nt b gy oc nz l oa ob">if savefigs:<br/>    plt.savefig('../figs/tutorial_python/figureP01.png', bbox_inches='tight')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/840aaa5a36489425bca050b1a7fcde17.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*sheaJV7gGWbgZ97y5r2t_w.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">简单的条形图</p></figure><p id="ffea" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">绘制云彩</strong></p><p id="4768" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">“云”是直方图的平滑版本，它将让我们了解数据集的分布情况。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="fa83" class="nx kv it nt b gy ny nz l oa ob"># plotting the clouds<br/>f, ax = plt.subplots(figsize=(7, 5))<br/>dy="group"; dx="score"; ort="h"; pal = sns.color_palette(n_colors=1)</span><span id="4542" class="nx kv it nt b gy oc nz l oa ob">ax=pt.half_violinplot( x = dx, y = dy, data = df, palette = pal, bw = .2, cut = 0.,<br/>                      scale = "area", width = .6, inner = None, orient = ort)</span><span id="9a52" class="nx kv it nt b gy oc nz l oa ob">plt.title("Figure P2\n Basic Rainclouds")<br/>if savefigs:<br/>    plt.savefig('../figs/tutorial_python/figureP02.png', bbox_inches='tight')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/9e56356ddee100aba02c23825d4d03f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*BfcIKmJEwG3z1jyBevjLfQ.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">看看我们的云</p></figure><p id="6835" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">加雨</strong></p><p id="2fcc" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">为了查看特定的数据点并识别潜在的异常值或其他模式，我们添加了“rain”。</p><p id="4c59" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><em class="ok">无抖动</em></p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="de8d" class="nx kv it nt b gy ny nz l oa ob"># adding the rain</span><span id="6474" class="nx kv it nt b gy oc nz l oa ob">f, ax = plt.subplots(figsize=(7, 5))</span><span id="86b9" class="nx kv it nt b gy oc nz l oa ob">ax=pt.half_violinplot( x = dx, y = dy, data = df, palette = pal, bw = .2, cut = 0.,</span><span id="f39b" class="nx kv it nt b gy oc nz l oa ob">scale = "area", width = .6, inner = None, orient = ort)</span><span id="2d8c" class="nx kv it nt b gy oc nz l oa ob">ax=sns.stripplot( x = dx, y = dy, data = df, palette = pal, edgecolor = "white",</span><span id="c390" class="nx kv it nt b gy oc nz l oa ob">size = 3, jitter = 0, zorder = 0, orient = ort)</span><span id="69b7" class="nx kv it nt b gy oc nz l oa ob">plt.title("Figure P3\n Raincloud Without Jitter")</span><span id="2b95" class="nx kv it nt b gy oc nz l oa ob">if savefigs:</span><span id="81eb" class="nx kv it nt b gy oc nz l oa ob">plt.savefig('../figs/tutorial_python/figureP03.png', bbox_inches='tight')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/1afdf36428e14687a40ee5744ab7667f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*oreFdJMvSaJdII_QCyV-6g.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">数据点的简单一维表示</p></figure><p id="707f" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><em class="ok">带抖动</em></p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="8dbe" class="nx kv it nt b gy ny nz l oa ob"># adding jitter to the rain</span><span id="4e03" class="nx kv it nt b gy oc nz l oa ob">f, ax = plt.subplots(figsize=(7, 5))</span><span id="d27b" class="nx kv it nt b gy oc nz l oa ob">ax=pt.half_violinplot( x = dx, y = dy, data = df, palette = pal, bw = .2, cut = 0.,</span><span id="4c64" class="nx kv it nt b gy oc nz l oa ob">scale = "area", width = .6, inner = None, orient = ort)</span><span id="6850" class="nx kv it nt b gy oc nz l oa ob">ax=sns.stripplot( x = dx, y = dy, data = df, palette = pal, edgecolor = "white",</span><span id="53ee" class="nx kv it nt b gy oc nz l oa ob">size = 3, jitter = 1, zorder = 0, orient = ort)</span><span id="0ddb" class="nx kv it nt b gy oc nz l oa ob">plt.title("Figure P4\n Raincloud with Jittered Data")</span><span id="67cf" class="nx kv it nt b gy oc nz l oa ob">if savefigs:</span><span id="944f" class="nx kv it nt b gy oc nz l oa ob">plt.savefig('../figs/tutorial_python/figureP04.png', bbox_inches='tight')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/8a5a06438e22b529365aed9d16f307af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*-6wgW51vDkhiXF9Re9c59A.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">添加抖动点</p></figure><p id="e673" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">添加箱线图</strong></p><p id="2f39" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">为了更好地理解数据的中位数、四分位数和异常值，我们添加了一个空的箱线图。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ad2c" class="nx kv it nt b gy ny nz l oa ob">#adding the boxplot with quartiles</span><span id="7f3e" class="nx kv it nt b gy oc nz l oa ob">f, ax = plt.subplots(figsize=(7, 5))</span><span id="d3e7" class="nx kv it nt b gy oc nz l oa ob">ax=pt.half_violinplot( x = dx, y = dy, data = df, palette = pal, bw = .2, cut = 0.,</span><span id="e128" class="nx kv it nt b gy oc nz l oa ob">scale = "area", width = .6, inner = None, orient = ort)</span><span id="b7cf" class="nx kv it nt b gy oc nz l oa ob">ax=sns.stripplot( x = dx, y = dy, data = df, palette = pal, edgecolor = "white",</span><span id="8248" class="nx kv it nt b gy oc nz l oa ob">size = 3, jitter = 1, zorder = 0, orient = ort)</span><span id="7a02" class="nx kv it nt b gy oc nz l oa ob">ax=sns.boxplot( x = dx, y = dy, data = df, color = "black", width = .15, zorder = 10,\</span><span id="319f" class="nx kv it nt b gy oc nz l oa ob">showcaps = True, boxprops = {'facecolor':'none', "zorder":10},\</span><span id="b6ea" class="nx kv it nt b gy oc nz l oa ob">showfliers=True, whiskerprops = {'linewidth':2, "zorder":10},\</span><span id="304b" class="nx kv it nt b gy oc nz l oa ob">saturation = 1, orient = ort)</span><span id="6853" class="nx kv it nt b gy oc nz l oa ob">plt.title("Figure P5\n Raincloud with Boxplot")</span><span id="a876" class="nx kv it nt b gy oc nz l oa ob">if savefigs:</span><span id="dbba" class="nx kv it nt b gy oc nz l oa ob">plt.savefig('../figs/tutorial_python/figureP05.png', bbox_inches='tight')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/97b036dd3ba64fc0a8dac9d3a06b436b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*bpZ7fDHv1oS2AMg-jlTXkQ.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">添加箱线图，覆盖抖动的数据点</p></figure><p id="48cd" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">添加颜色</strong></p><p id="f158" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们可以设置调色板来表征这两个组。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="aa74" class="nx kv it nt b gy ny nz l oa ob">#adding color</span><span id="8215" class="nx kv it nt b gy oc nz l oa ob">pal = "Set2"</span><span id="5a8c" class="nx kv it nt b gy oc nz l oa ob">f, ax = plt.subplots(figsize=(7, 5))</span><span id="0d43" class="nx kv it nt b gy oc nz l oa ob">ax=pt.half_violinplot( x = dx, y = dy, data = df, palette = pal, bw = .2, cut = 0.,</span><span id="6acc" class="nx kv it nt b gy oc nz l oa ob">scale = "area", width = .6, inner = None, orient = ort)</span><span id="e20c" class="nx kv it nt b gy oc nz l oa ob">ax=sns.stripplot( x = dx, y = dy, data = df, palette = pal, edgecolor = "white",</span><span id="2b4e" class="nx kv it nt b gy oc nz l oa ob">size = 3, jitter = 1, zorder = 0, orient = ort)</span><span id="96e2" class="nx kv it nt b gy oc nz l oa ob">ax=sns.boxplot( x = dx, y = dy, data = df, color = "black", width = .15, zorder = 10,\</span><span id="03cf" class="nx kv it nt b gy oc nz l oa ob">showcaps = True, boxprops = {'facecolor':'none', "zorder":10},\</span><span id="4127" class="nx kv it nt b gy oc nz l oa ob">showfliers=True, whiskerprops = {'linewidth':2, "zorder":10},\</span><span id="f12b" class="nx kv it nt b gy oc nz l oa ob">saturation = 1, orient = ort)</span><span id="0867" class="nx kv it nt b gy oc nz l oa ob">plt.title("Figure P6\n Tweaking the Colour of Your Raincloud")</span><span id="1ae4" class="nx kv it nt b gy oc nz l oa ob">if savefigs:</span><span id="ba75" class="nx kv it nt b gy oc nz l oa ob">plt.savefig('../figs/tutorial_python/figureP06.png', bbox_inches='tight')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/5e38532782f264049ca9280d6ade965e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*uyCzJpmtOkAtiR2y4gRdTA.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">添加颜色</p></figure></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><p id="92f1" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">结论</strong></p><p id="e0c1" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">本文概述了如何使用python和ptitprince库来创建雨云图。要更深入地使用ptitprince库，请查看github存储库:</p><div class="mn mo gp gr mp mq"><a href="https://github.com/pog87/PtitPrince" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">pog87/PtitPrince</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">“雨云情节”的Python实现！见:https://github.com/RainCloudPlots/RainCloudPlots你可以安装…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">github.com</p></div></div><div class="mz l"><div class="om l nb nc nd mz ne ks mq"/></div></div></a></div><p id="eff3" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">或者查看我的存储库和google colab实现的链接:</p><div class="mn mo gp gr mp mq"><a href="https://github.com/chags1313/raincloud_colab" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">chags1313/raincloud_colab</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">github.com</p></div></div><div class="mz l"><div class="on l nb nc nd mz ne ks mq"/></div></div></a></div><div class="mn mo gp gr mp mq"><a href="https://colab.research.google.com/drive/10UObYNGsepQgaCswi6l1cOy0CxQdr3Ki?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">雨云_ptitprince</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">在google colab中使用ptitprince</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">colab.research.google.com</p></div></div><div class="mz l"><div class="oo l nb nc nd mz ne ks mq"/></div></div></a></div><p id="1a85" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>