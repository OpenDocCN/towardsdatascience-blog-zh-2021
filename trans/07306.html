<html>
<head>
<title>Using conda on an M1 Mac</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在M1 Mac电脑上使用conda</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-conda-on-an-m1-mac-b2df5608a141?source=collection_archive---------3-----------------------#2021-07-03">https://towardsdatascience.com/using-conda-on-an-m1-mac-b2df5608a141?source=collection_archive---------3-----------------------#2021-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="55e7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">运行多个conda发行版，从两个世界获得最佳效果。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b0882ecace2767d3b2a5e21ee4095721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mpRLp059c8svqIw0lPHZLQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@pinewatt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">派恩瓦特</a>在<a class="ae kv" href="https://unsplash.com/s/photos/merge?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="79d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你最近在工作中购买或获得了一台新的M1 Mac，并且你正在使用Python开发或从事数据科学项目，你可能已经浪费了一些时间来运行一些包。我仍然在我的Mac上与Python、Docker和conda作斗争，但是我找到了一种让许多包在conda环境中运行的方法。</p><p id="b904" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于M1是基于ARM的系统，许多Python包无法正确安装，因为它们是为在AMD64 (x86)上运行而构建的。像许多其他人一样，我使用conda为我的项目建立环境——最好是使用Anaconda或Miniconda。</p><p id="1a6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我第一次想在我的Mac上安装Tensorflow时，我偶然发现了mini forge(<a class="ae kv" href="https://github.com/conda-forge/miniforge" rel="noopener ugc nofollow" target="_blank">https://github.com/conda-forge/miniforge</a>)，它可以与Miniconda相媲美，但conda-forge是默认通道，并专注于支持各种CPU架构。Tensorflow与Miniforge一起安装时工作正常。</p><p id="90ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是当我需要安装我工作中使用的某些包时——比如SimpleITK(现在也有M1 Python wheel！)— Miniforge无法安装它。这有点像赌博。在某个时候，我意识到我可以在同一个系统上同时安装和使用Miniforge和Miniconda。</p><p id="62d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">编辑:正如</strong><a class="ls lt ep" href="https://medium.com/u/7e72236d2b4b?source=post_page-----b2df5608a141--------------------------------" rel="noopener" target="_blank"><strong class="ky ir">Lucas-Raphael müller</strong></a><strong class="ky ir">给我指出的，你不需要两个都装，Miniconda和Miniforge。你可以像这里说的一样选择是使用针对Intel芯片编译的包还是针对Apple Silicon编译的包:</strong><a class="ae kv" href="https://github.com/Haydnspass/miniforge#rosetta-on-mac-with-apple-silicon-hardware" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">https://github . com/Haydnspass/miniforge # Rosetta-on-MAC-with-Apple-Silicon-hardware</strong></a><strong class="ky ir">。</strong></p><p id="b733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装Miniforge后，初始化命令将在您的。bashrc/。zshrc:</p><pre class="kg kh ki kj gt lu lv lw lx aw ly bi"><span id="87a2" class="lz ma iq lv b gy mb mc l md me"># &gt;&gt;&gt; conda initialize &gt;&gt;&gt;<br/># !! Contents within this block are managed by ‘conda init’ !!<br/>__conda_setup=”$(‘/Users/xyz/miniforge3/bin/conda’ ‘shell.zsh’ ‘hook’ 2&gt; /dev/null)”<br/>if [ $? -eq 0 ]; then<br/> eval “$__conda_setup”<br/>else<br/> if [ -f “/Users/xyz/miniforge3/etc/profile.d/conda.sh” ]; then<br/> . “/Users/xyz/miniforge3/etc/profile.d/conda.sh”<br/> else<br/> export PATH=”/Users/xyz/miniforge3/bin:$PATH”<br/> fi<br/>fi<br/>unset __conda_setup<br/># &lt;&lt;&lt; conda initialize &lt;&lt;&lt;</span></pre><p id="e1c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将使用Miniforge初始化conda。你只需要复制你的。bashrc/。zshrc文件，并将miniforge3更改为miniconda3，并选择默认情况下要使用的文件。更改非常简单，只需运行<code class="fe mf mg mh lv b">source .bashrc</code>进行所需的conda初始化。</p><p id="4386" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，我正在做一个项目，在这个项目中，我需要SimpleITK来预处理图像，需要Tensorflow来训练一个模型。我无法让两者在M1的同一个小型锻造环境中工作。所以我把预处理和训练分成两个环境，一个利用Miniconda运行SimpleITK，一个Miniforge环境运行Tensorflow。</p><p id="fb55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它的好处是你可以通过运行<code class="fe mf mg mh lv b">conda env list</code>同时看到Miniconda和Miniforge环境。唯一的区别是，您将看不到用其他安装程序构建的环境的名称，只能看到路径。初始化Miniconda后，您需要使用Miniforge环境的完整路径运行<code class="fe mf mg mh lv b">conda activate</code>。</p><p id="f2a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这在bash脚本中仍然很容易管理，以便使用由多个conda发行版构建的多个环境来运行脚本。</p><p id="9216" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这只是一个临时的解决办法，直到越来越多的软件包可以在M1上工作，但是我确信这需要一些时间。</p><p id="363d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望这能帮助一些在M1上使用conda处理Python包的人。</p></div></div>    
</body>
</html>