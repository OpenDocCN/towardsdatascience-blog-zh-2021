<html>
<head>
<title>All You Need to Know About Python Dictionaries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于 Python 字典，您需要知道的</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/all-you-need-to-know-about-python-dictionaries-ccd05e5c61dd?source=collection_archive---------3-----------------------#2021-12-01">https://towardsdatascience.com/all-you-need-to-know-about-python-dictionaries-ccd05e5c61dd?source=collection_archive---------3-----------------------#2021-12-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d1f4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">它们是什么，何时使用它们，以及如何高效地使用它们！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/27302339995fedc4b098d34c156d2662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cOrQc5SIWMwqhM_D"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本·怀特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="e61d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="05c2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">成功地处理数据并编写可读和高性能的代码是我们努力的目标。实现这一目标的一个关键部分是为给定的问题选择理想的数据结构。数据结构是一种组织数据的特殊方式，以便可以有效地存储、检索或更新数据。</p><p id="b587" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Python 自带各种内置的数据结构，例如列表、元组、集合、队列或字典等等。在本帖中，我们将看看<em class="ms">词典</em>。我试图涵盖从新手的基本用法到专业人士的高级主题的广泛范围。让我们看看我是否能兑现💪。</p><h1 id="eedd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">字典</h1><p id="5a40" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们从一个简单的问题开始，这个问题很可能我们所有人都已经能回答了</p><blockquote class="mt mu mv"><p id="855d" class="lr ls ms lt b lu mn ju lw lx mo jx lz mw mp mc md mx mq mg mh my mr mk ml mm im bi translated">什么是字典？</p></blockquote><p id="a501" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">字典是具有唯一键的键值映射。相应的值可以是任何类型。在其他编程语言中，您可能会发现 map、hashmap、关联数组或查找表等术语都指代同一个概念。</p><p id="f937" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">那么，字典有什么用呢？它们适合通过<em class="ms">键</em>以快速和可读的方式访问元素，而不必搜索整个数据集。这意味着您可以同时获得性能提升和使用字典编写更可读的代码。现在，他们有什么属性？</p><p id="d10b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">字典是可变的，或者如果你想骄傲的话，是可变的😃。这意味着您可以随时更新、添加或删除键值对。</p><p id="8166" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，由于 Python 3.7 <em class="ms">字典保留插入顺序</em>。也就是说，当你迭代一个字典的元素时，元素将按照它们被添加时的顺序被遍历。如果您使用 Python 3.6 或更早版本，我希望您不要这样做😃，你必须使用一个<a class="ae ky" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" rel="noopener ugc nofollow" target="_blank"> OrderedDict </a>来保证你的字典的顺序。</p><p id="be3a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们开始研究真正的代码之前，我想提到的最后一点是<em class="ms">字典键必须是可散列的</em>。你也经常读到键必须是不可变的，但那只是因为不可变类型也是可散列的。可以用作键的哈希类型的例子有数字、字符串或数字或字符串的元组。您<em class="ms">不能</em>用作键的可变类型是例如列表或字典。所以你不能用字典作为字典中的键😃。顺便提一下，如果你想使用某个类的实例作为键，你必须为那个类实现<a class="ae ky" rel="noopener" target="_blank" href="/how-to-write-awesome-python-classes-f2e1f05e51a9">魔法函数</a> <code class="fe mz na nb nc b">__hash__</code>。</p><p id="360b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">好了，说够了，让我们把手弄脏，来有趣的部分；实码。</p><h2 id="4214" class="nd la it bd lb ne nf dn lf ng nh dp lj ma ni nj ll me nk nl ln mi nm nn lp no bi translated">创建词典</h2><p id="8b93" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们需要知道的第一件事是我们如何能创造一本字典。Python 提供了各种方法来做到这一点，所以让我们看看</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建词典</p></figure><p id="ae2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">创建词典有两种基本方法。首先，您可以使用花括号并向其中添加逗号分隔的<code class="fe mz na nb nc b">key: value</code>对。其次，您可以使用<code class="fe mz na nb nc b">dict</code>类并将键值对传递给构造函数。当您的键是字符串和适当的 Python 名称时，这很好。如果不是，你将不得不传递一个形式为<code class="fe mz na nb nc b">(key, value)</code>的元组的 iterable 到<code class="fe mz na nb nc b">dict</code>。这实际上是在编写第 6 行所示的<code class="fe mz na nb nc b">dict(zip(keys, values))</code>时以一种非常紧凑的方式得到的。</p><p id="947a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">创建字典的另一种方法是将多个字典结合起来。你怎么能这样做？你可以通过用<code class="fe mz na nb nc b">**</code>操作符解包字典，然后用花括号把它们组合起来，见第 9 行。Python 3.9 中引入的另一种方法是使用<code class="fe mz na nb nc b">|</code>操作符来连接字典，如第 10 行所示。</p><p id="8162" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果组合字典有公共键，将使用最后添加的那个值。但是，第一个添加的将决定插入顺序。在给定的例子中，这意味着<code class="fe mz na nb nc b">combined</code>的第一个键值对是<code class="fe mz na nb nc b">python: 10</code>。听起来很疯狂，不是吗？我只能建议玩简单的玩具例子，并熟悉这些细节。</p><p id="df75" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，我想简单提一下字典理解，如第 14 行所示。您可能已经熟悉了列表理解来创建列表，这与创建字典是一样的。因为这个概念应该是相当众所周知的，所以我只给你一个例子。</p><h2 id="ef70" class="nd la it bd lb ne nf dn lf ng nh dp lj ma ni nj ll me nk nl ln mi nm nn lp no bi translated">从字典中阅读</h2><p id="e66e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">既然我们现在知道如何创建字典，我们应该开始利用它们存储的数据。同样，让我们从一些代码开始</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从字典中读取数据</p></figure><p id="c38c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">获取条目最常见的方式是使用第 1 行所示的键在字典中建立索引。这种方法的一个问题是，如果一个键不在字典中，就会引发一个<code class="fe mz na nb nc b">KeyError</code>异常。为了避免这种情况，您可以使用字典的<code class="fe mz na nb nc b">get</code>方法，如第 2 行所示。此方法或者返回与键关联的值，或者如果找不到键，则返回默认值。如果不指定默认值，它将返回<code class="fe mz na nb nc b">None</code>。</p><p id="7b78" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了不仅处理单个键值对，而且处理整个数据，字典提供了不同的方法来访问所有条目。在第 3 行，您可以看到如何使用<code class="fe mz na nb nc b">items()</code>方法迭代所有的键值对。</p><p id="5aa7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您还可以迭代字典本身。在这样做的时候，您迭代这些键，如第 7 行所示。另一种迭代或获取所有键的方法是使用<code class="fe mz na nb nc b">a_dict.keys()</code>。</p><p id="646d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，如果您只对值感兴趣而对键不感兴趣，您可以使用<code class="fe mz na nb nc b">a_dict.values()</code>来获得它们。在第 10 行，你可以看到一个例子，我们计算字典中所有语言的平均等级。</p><h2 id="ce12" class="nd la it bd lb ne nf dn lf ng nh dp lj ma ni nj ll me nk nl ln mi nm nn lp no bi translated">更新词典</h2><p id="8bc5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如开头所说，字典是可变的。这意味着我们可以添加、删除或更新字典的条目。让我们看看 Python 为此提供了什么</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d122" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如第 2 行所示的<code class="fe mz na nb nc b">setdefault</code>函数可能是 dicts 公开的最令人困惑的命令😕。那么它是做什么的，有什么帮助呢？如果在字典中没有找到给定的键，<code class="fe mz na nb nc b">setdefault</code>将带有给定默认值的键添加到字典中，并返回该值。这意味着它更新了字典。如果键存在，它将返回相应的值。尽管函数的名字令人困惑，但它可以帮助您用更少的<code class="fe mz na nb nc b">if-else</code>语句编写更少的代码。使用这种方法的另一种方法是使用集合模块中的<code class="fe mz na nb nc b"><a class="ae ky" href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="noopener ugc nofollow" target="_blank">defaultdict</a></code>。</p><p id="82c9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，要更新或添加条目，我们可以使用索引操作并赋值，如第 3 行所示。如果我们想要添加或更新多个条目，我们可以使用第 4 行所示的<code class="fe mz na nb nc b">update</code>方法。或者，从 Python 3.9 开始，我们可以使用<code class="fe mz na nb nc b">|=</code>操作符，如第 5 行所示。在这两种情况下，我们都必须将要添加或更新的键值对放入另一个字典中，并将其传递给方法或操作符的左侧。</p><p id="8db0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，要从我们的字典中删除条目，我们有两个方法，即<code class="fe mz na nb nc b">popitem</code>和<code class="fe mz na nb nc b">pop</code>。Popitem 移除最后插入的项，并以元组的形式返回相应的键值对。与此相反，<code class="fe mz na nb nc b">pop</code>删除给定键的键值对，并返回相应的值。如果不指定默认值，当找不到键时，<code class="fe mz na nb nc b">pop</code>会引发一个<code class="fe mz na nb nc b">KeyError</code>。如果指定了默认值，则在键不存在的情况下将返回该值。<code class="fe mz na nb nc b">popitem</code>和<code class="fe mz na nb nc b">pop</code>都修改调用它们的字典。</p><p id="5f2c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，还可以使用<code class="fe mz na nb nc b">del</code>删除项目。但是，我不喜欢这个语法，故意把它留在这里。抱歉，我不得不固执己见😃</p><h2 id="b487" class="nd la it bd lb ne nf dn lf ng nh dp lj ma ni nj ll me nk nl ln mi nm nn lp no bi translated">使用字典键入注释</h2><p id="bc1c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我喜欢现代 Python 的一点是类型注释。类型注释极大地帮助我们理解代码和接口。此外，它们提高了我们的编码速度，因为我们的 ide 在自动完成时会用到它们。最后，当使用像<a class="ae ky" href="http://mypy-lang.org/" rel="noopener ugc nofollow" target="_blank"> mypy </a>这样的类型检查器时，您可能会在投入生产之前就发现错误。</p><p id="f364" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为我们没有讨论类型注释的细节，所以让我们继续讨论如何对我们的字典进行类型注释。您可能已经猜到了，我们从一些代码开始</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="dbc2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我在这里做了什么？首先，我创建了一个接受字典作为输入并返回字典的函数。要进行类型注释，您可以使用来自<a class="ae ky" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">类型模块</a>的<code class="fe mz na nb nc b">Dict</code>，或者从 Python 3.9 开始，您可以与<code class="fe mz na nb nc b">dict</code>交换以节省一次导入。现在，必须将键的类型指定为第一个参数，将值的类型指定为第二个参数。就是这样。很简单，不是吗？我希望你们都同意，这个界面比随便输入名字更容易理解。</p><p id="af9b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">关于类型注释，我想介绍的最后一点是所谓的<a class="ae ky" href="https://www.python.org/dev/peps/pep-0589/" rel="noopener ugc nofollow" target="_blank">类型注释</a>。当你预先知道你的键的名字和类型时，你可以使用 TypeDict。为此，您必须编写一个从 TypedDict 继承的类，并将键定义为属性，并用相应值的类型对它们进行类型注释。然而，在我看来，它们的用途相当有限，在许多情况下，您可以使用功能更丰富的<a class="ae ky" href="https://docs.python.org/3/library/dataclasses.html" rel="noopener ugc nofollow" target="_blank">数据类</a>或<a class="ae ky" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">命名的元组</a>。</p><h2 id="6cf5" class="nd la it bd lb ne nf dn lf ng nh dp lj ma ni nj ll me nk nl ln mi nm nn lp no bi translated">词典的替代用法</h2><p id="0f53" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在结束这篇文章之前，我想谈谈我们如何使用字典不仅保存数据，而且提高代码库的可读性。为了说明这一点，我给你们看两个突出的例子。</p><p id="d6ce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，有了字典，我们可以替换某些 if-else 语句，使我们的代码不那么冗长，更整洁。这是怎么回事？我们来看一些代码！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="724a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在给定的示例中，我们希望构建一个函数来从三个不同的数据仓库加载数据。对于每个仓库，我们都有一个专门的功能来完成这项工作。因此，根据定义的仓库名称，目标是选择三个函数中的一个。一种简单的方法是使用一些 if 子句来检查仓库名称，以使用正确的函数。这显示在功能<code class="fe mz na nb nc b">load_data_verbose</code>中。</p><p id="902c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者，我们可以定义一个字典，将仓库名称映射到相应的函数。现在，我们所要做的就是使用仓库名称从字典中获取函数，如<code class="fe mz na nb nc b">load_data.</code>所示，这是一个更好的接口，也更容易扩展到更多的仓库。如果必须添加一个新的，我们只需编写加载函数并更新字典。完成了。</p><p id="ff42" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我想提到的第二个也是最后一个例子是，我们可以在调用函数时使用字典来指定关键字参数。以上面的例子为例，我们可以定义一个字典<code class="fe mz na nb nc b">call_args={"data_base":"snowflake", "from_": datetime.utcnow()}</code>，并使用它来调用<code class="fe mz na nb nc b">load_data</code>函数，就像<code class="fe mz na nb nc b">data = load_data(**call_args)</code>。例如，当您想要有条件地覆盖关键字参数的默认值时，这种语法会非常方便。</p><p id="8987" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">大概就是这样。咳，那篇文章比我最初想象的要长得多😃会的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/ca81a0edafdb0cff58985fcb7f6c6ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xvNrfkSBJbl0yzu5"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@srz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">悉尼·瑞伊</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="0742" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">包裹</h1><p id="8e93" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这篇文章中，我们讨论了什么是 Python 字典以及如何有效地使用它们。我的目标是为新手和专业人士提供见解。我希望我已经做到了这一点，并且您现在已经掌握了新的知识，能够编写更棒的代码，并交付您的下一个数据项目。</p><p id="8eb2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢您关注这篇文章。一如既往，如有任何问题、意见或建议，请随时联系我或关注我，无论是在这里还是通过<a class="ae ky" href="https://www.linkedin.com/in/simon-hawe-75832057" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>。</p></div></div>    
</body>
</html>