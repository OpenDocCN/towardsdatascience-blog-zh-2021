<html>
<head>
<title>Why DST is a Data Engineering nightmare?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么DST是数据工程噩梦？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-dst-is-a-data-engineering-nightmare-605a6044ce75?source=collection_archive---------8-----------------------#2021-11-21">https://towardsdatascience.com/why-dst-is-a-data-engineering-nightmare-605a6044ce75?source=collection_archive---------8-----------------------#2021-11-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="445a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">数据/管道所需的钻杆测试和处理概述</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/60b1d912d26749d88c86a5a05603d64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q8BbAKS18d2H0w3Tbfd26A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">亚历山大·里恩在<a class="ae kv" href="https://unsplash.com/s/photos/time?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="aafa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">嘿伙计们！</p><p id="46ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，DST或夏令时最近结束了，2021年11月7日，那天我格外警惕，一直祈祷不要出什么事！在验证DST影响时，我想到了写一篇关于DST考虑事项的文章，这需要一年两次关注wrt管道、数据和作业。</p><p id="0c55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，如果你不知道什么是夏令时，不要担心，我会在下面解释，相信我，这将是一个有趣的阅读:)</p><h2 id="067c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">到底什么是夏令时或DST？</h2><p id="2adf" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">夏令时是一种通过改变标准时间来确保白天有更多阳光的做法。</p><p id="4f9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在初春的某一天(通常在三月)，美国、加拿大和澳大利亚的时区开始采用夏令时。</p><p id="e796" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也就是说，时钟向前拨一小时，一天中跳过一小时。到了那一天，一天将只有23个小时而不是24个小时，而这就是我的朋友，作为一名数据工程师的麻烦开始了，事实上，除了我以外的任何管道所有者都会遇到这一点。</p><p id="1b7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今年，夏令时从3月14日开始。</p><p id="4e28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">DST日的美国东部时间wrt UTC示例(时区，伙计！):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/65cd596b67dcbf3a9e38ceb57e771318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rai9EvFS1V9Qr56yRvK0nQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">演职员表:【https://www.worldtimebuddy.com/ T4】</p></figure><p id="12cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您仔细观察，会发现第2小时被跳过，时钟被向前拨。所以在三月，一天会有23个小时。在春季和夏季，夏令时导致白天更多的光照，当冬季到来时，时间需要再次标准化。(因为冬天我们晚上很早，夏令时有什么意义呢？)</p><p id="d321" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">冬天开始时，DST结束，时钟被重置为标准时间，这发生在今年的11月7日，这一天将有25个小时:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/e380cf9c8b827a3c34a999e798a6ef21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvXoO5cuAbZYwL0EumoP6w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">演职员表:<a class="ae kv" href="https://www.worldtimebuddy.com/" rel="noopener ugc nofollow" target="_blank">https://www.worldtimebuddy.com/</a></p></figure><p id="8f8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你仔细观察，夏令时结束时，凌晨1点发生了两次，所以一天有25个小时，但仍然有24个小时(<em class="mr">再读一遍</em>)。</p><p id="2501" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，已经非常详细地解释了什么是夏令时，让我们来谈谈为什么它很糟糕！(是的，我说了)</p><h2 id="97cb" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">夏令时如何影响数据？</h2><p id="1a9e" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">当夏令时开始(3月)和结束(11月)时，在那些日子里，一天不会有标准的24小时。因此，在那些日子里，任何标准的处理、检查或比较都可能不起作用。下面列出了一些影响场景:</p><p id="5d2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从数据质量检查开始，假设您对原始数据进行检查，每天应该有24小时，否则数据被认为是“坏”的，即如果一天只有24小时的数据，那么它将被处理/质量良好/完整。</p><p id="10db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，当DST开始时，如上所述，一天将有23个小时，这样的24小时数据检查将失败。为了处理这个问题，可能需要进行特殊处理。</p><p id="1bd3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据质量故障的另一个例子是“丢失数据警报”,或者当某个小时的数据丢失时发送警报。在DST开始的那一天，警报可以发送2小时(跳过这一小时),可能需要特殊处理。</p><p id="7a06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">阈值检查通常是在数据量超过某个值时发送的警报，现在，在DST结束的当天，凌晨1点的数据实际上将包含两个小时的数据(<em class="mr">为了清楚起见，请再次参见上图</em>)，全天将包含25个小时的数据，因此再次对计数/数据量等进行阈值检查。可能会失败，需要特殊处理。</p><p id="7e37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我想我已经把你吓得够呛了，现在让我们讨论一些可能需要的逻辑和报告处理。</p><p id="6bf7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您的逻辑需要前一个/后一个小时的数据来进行任何计算，则需要对DST开始和结束日进行特殊处理，以便在凌晨1点后的3月份，凌晨3点是下一个小时，而不是凌晨2点。同样，在11月，凌晨1点也是凌晨1点后的下一个小时。</p><p id="a4f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，对于11月的这25个小时，您在任何报告中进行的任何比较，如一小时一小时的比较、一天一天的比较，都可能会显示更高的数字(<em class="mr">，除非您决定放弃一个小时的数据，但不建议这样做</em></p><p id="7463" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一个影响领域是时间安排影响。如果您计划特定时区的作业/管道，则DST计划或SLA时间可能会受到影响。一定要仔细检查。</p><p id="ba7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的建议是，如果不需要，不要在特定的时区运行管道，而要在UTC运行。对于最终的可交付数据，当然要进行时区转换，但至少在所有地方，UTC总是一致的。</p><p id="e42d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">嗯，就这样吧！这是我现在能想到的所有影响。如果您有任何其他我没有注意到的考虑因素或影响，我很乐意知道。请留下你的评论。</p><p id="65f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望这有所帮助！</p><p id="2261" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">快乐编码，<br/> JD</p></div></div>    
</body>
</html>