<html>
<head>
<title>The curious case of Simpson’s Paradox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">辛普森悖论的奇特案例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-curious-case-of-simpsons-paradox-6f178548d7e8?source=collection_archive---------21-----------------------#2021-05-05">https://towardsdatascience.com/the-curious-case-of-simpsons-paradox-6f178548d7e8?source=collection_archive---------21-----------------------#2021-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="da72" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">统计测试和分析可能会因为对数据的简单误解而被混淆</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a9ab4ac3f885e4527a0cf259565c5597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6yc_IK25IZsQ_gt9"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@bdchu614?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布伦丹·丘奇</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><blockquote class="kz"><p id="7268" class="la lb it bd lc ld le lf lg lh li lj dk translated">统计学很少提供做任何事情的单一“正确”方式——查尔斯·惠兰在《赤裸裸的统计学》中</p></blockquote><p id="bfa5" class="pw-post-body-paragraph lk ll it lm b ln lo ju lp lq lr jx ls lt lu lv lw lx ly lz ma mb mc md me lj im bi translated">1996年，<a class="ae ky" href="https://www.researchgate.net/publication/254331089_Ignoring_a_Covariate_An_Example_of_Simpson's_Paradox" rel="noopener ugc nofollow" target="_blank"> <em class="mf">阿普尔顿、弗伦奇和范德普姆</em> </a>进行了一项实验，研究吸烟对一个样本人群的影响。这项研究进行了20多年，包括1314名英国女性。与普遍的看法相反，这项研究表明吸烟者往往比不吸烟者长寿。尽管我不是吸烟对人体健康影响的专家，但这一发现令人不安。下图显示，吸烟者的死亡率为23%，而不吸烟者的死亡率约为31%。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/12a67ece52bb9451aa0c4c71cf461c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*iDyNS-0t3aqoMWNOY5ySfQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">吸烟者与非吸烟者的死亡率|作者图片</p></figure><p id="b121" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">现在，事情变得有趣了。把同样的数据按年龄组分开，我们会得到一个完全不同的画面。结果显示，在大多数年龄组中，吸烟者的死亡率比不吸烟者高。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/6de46d823f9a49ae69e8c1c6422accdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_7T9kLqig2uLxiikgnetw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按年龄组细分的研究结果|作者图片</p></figure><h2 id="711d" class="mn mo it bd mp mq mr dn ms mt mu dp mv lt mw mx my lx mz na nb mb nc nd ne nf bi translated">那么，为什么会有这种困惑呢？🤔</h2><p id="2b89" class="pw-post-body-paragraph lk ll it lm b ln ng ju lp lq nh jx ls lt ni lv lw lx nj lz ma mb nk md me lj im bi translated">嗯，我们刚刚在上面看到的现象是<strong class="lm iu">辛普森悖论</strong>的一个经典案例，它不时地让位于大量数据驱动的分析。在本文中，我们将对此进行更深入的探讨，并理解如何在我们的分析中避免类似的谬误。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="43fd" class="ns mo it bd mp nt nu nv ms nw nx ny mv jz nz ka my kc oa kd nb kf ob kg ne oc bi translated">辛普森悖论:事情并不总是像它们看起来的那样</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/56aad56c073cdddf174c62bc03d26d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4VUfxWFvYDhgg7d80vnMuA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/ctribeiro-680997/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1708964" rel="noopener ugc nofollow" target="_blank">卡洛斯·里贝罗</a>拍摄，来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1708964" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a></p></figure><p id="ef6b" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated"><strong class="lm iu"> <em class="mf">按维基百科，辛普森悖论，</em> </strong> <em class="mf">又叫</em> <strong class="lm iu"> <em class="mf">尤尔-辛普森效应</em> </strong> <em class="mf">，可定义如下:</em></p><blockquote class="oe of og"><p id="1f58" class="lk ll mf lm b ln mh ju lp lq mi jx ls oh mj lv lw oi mk lz ma oj ml md me lj im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Simpson%27s_paradox" rel="noopener ugc nofollow" target="_blank">辛普森悖论(Simpson's Paradox)是概率统计中的一种现象，一种趋势出现在几组不同的数据中，但当这些组组合在一起时就消失或逆转。</a></p></blockquote><p id="a750" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">换句话说，根据不同的分组方式，同一个数据集可能呈现相反的趋势。这正是我们在吸烟者和非吸烟者死亡率的例子中看到的。当按年龄分组时，数据显示不吸烟者往往活得更长。但是，当我们看到一个整体画面时，吸烟者往往活得更长。这里到底发生了什么？为什么同样的数据会有不同的解释，第一种情况下是什么在逃避我们的眼睛？嗯，在这种情况下，罪魁祸首被称为<strong class="lm iu">潜伏变量——</strong>条件变量<strong class="lm iu"> </strong>，它可以影响我们对两个变量之间关系的结论——在我们的情况下，吸烟和死亡率。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="c4c7" class="ns mo it bd mp nt nu nv ms nw nx ny mv jz nz ka my kc oa kd nb kf ob kg ne oc bi translated">识别潜在变量🔍</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/160b316a043877b4015fbb546e7ad5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*vkiDwWnsTb6BxaJU1XPFvg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/peggy_marco-1553824/" rel="noopener ugc nofollow" target="_blank"> Peggy_Marco </a>来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1708964" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="4066" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">潜伏的意思是以一种潜在的或难以辨别的状态存在，尽管仍然有影响。同样，潜在变量是一个不包括在分析中的变量，但是如果包括在内，可以极大地改变分析的结果。</p><p id="60d7" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">在讨论的例子中，<strong class="lm iu">年龄组</strong>是潜在的变量。当数据按年龄分组时，我们发现不吸烟者的平均年龄明显更大，因此，更有可能在试验期间死亡，正是因为他们总体上活得更长。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="1130" class="ns mo it bd mp nt nu nv ms nw nx ny mv jz nz ka my kc oa kd nb kf ob kg ne oc bi translated">你自己试试吧。💻</h1><p id="854e" class="pw-post-body-paragraph lk ll it lm b ln ng ju lp lq nh jx ls lt ni lv lw lx nj lz ma mb nk md me lj im bi translated">这是辛普森悖论的另一个显而易见的例子。我们都知道<a class="ae ky" href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lm iu">帕企鹅</strong> </a> <strong class="lm iu">🐧</strong> <a class="ae ky" href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lm iu">数据集</strong> </a> —著名虹膜数据集的替代产品。该数据集由三种企鹅的详细信息组成，包括它们的长度和深度、鳍状肢长度、体重和性别。企鹅喙本质上是企鹅喙的上脊，而它们的翅膀被称为鳍状肢。数据集<a class="ae ky" href="https://www.kaggle.com/parulpandey/palmer-archipelago-antarctica-penguin-data?select=penguins_size.csv" rel="noopener ugc nofollow" target="_blank">可在Kaggle上下载</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/972a002f6d866d5bff2833a552a87887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*gIOJSSoVH7i0GyOAtV0ZfA.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.freepik.com/vectors/nature" rel="noopener ugc nofollow" target="_blank">brgfx-www.freepik.com创建的自然向量</a> |归属1.0通用(<a class="ae ky" href="https://creativecommons.org/licenses/by/1.0/" rel="noopener ugc nofollow" target="_blank"> CC BY 1.0 </a>)</p></figure><h2 id="50e9" class="mn mo it bd mp mq mr dn ms mt mu dp mv lt mw mx my lx mz na nb mb nc nd ne nf bi translated">导入必要的库和数据集</h2><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="ffba" class="mn mo it on b gy or os l ot ou">import pandas as pd<br/>import seaborn as sns<br/>from scipy import stats<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="72c8" class="mn mo it on b gy ov os l ot ou">#plt.rcParams['figure.figsize'] = 12, 10<br/>plt.style.use("fivethirtyeight")# for pretty graphs</span><span id="e32c" class="mn mo it on b gy ov os l ot ou">df  = pd.read_csv('<a class="ae ky" href="https://raw.githubusercontent.com/parulnith/Website-articles-datasets/master/penguins_size.csv'" rel="noopener ugc nofollow" target="_blank">penguins_size.csv'</a>)<br/>df.head()')<br/>df.info()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/4a5746e768fa51816499cad7e0cb92f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Wg8r9copQYj5EWpG_gdnQ.png"/></div></figure><p id="f133" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">数据集中几乎没有丢失的值。让我们摆脱那些。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="6f0a" class="mn mo it on b gy or os l ot ou">df = df.dropna()</span></pre><p id="378d" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">现在让我们想象一下企鹅的<strong class="lm iu">长度和它们的</strong>深度之间的关系。同样，我们将使用seaborn的<code class="fe ox oy oz on b">lmplot</code>方法(其中“<code class="fe ox oy oz on b">lm</code>”代表“<code class="fe ox oy oz on b">linear model</code>”)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pa pb l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/e02eba809df95a71968f8b2ce35bee4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*pI8zh6NZE_JV262dcpv-iA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">企鹅的长度与深度|作者图片</p></figure><p id="f56a" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">在这里，我们看到了数据集的culmen长度和culmen深度之间的负相关。上述结果表明，越长的秆或喙，密度越小。我们还计算了两列之间的相关系数，以使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#:~:text=In%20statistics%2C%20the%20Pearson%20correlation,between%20two%20sets%20of%20data." rel="noopener ugc nofollow" target="_blank">皮尔逊相关系数</a> (PCC)查看负关联，称为<strong class="lm iu">皮尔逊相关系数<em class="mf">r。PCC</em></strong>是一个介于-1和1之间的数字，用于测量两个数据集之间的线性相关性。Scipy库为此提供了一个名为<code class="fe ox oy oz on b">pearsonr()</code>的方法。</p><h2 id="7b7e" class="mn mo it bd mp mq mr dn ms mt mu dp mv lt mw mx my lx mz na nb mb nc nd ne nf bi translated">在物种级别向下钻取</h2><p id="fda2" class="pw-post-body-paragraph lk ll it lm b ln ng ju lp lq nh jx ls lt ni lv lw lx nj lz ma mb nk md me lj im bi translated">当你进一步挖掘并按物种对数据进行分组时，发现正好相反。“<code class="fe ox oy oz on b">hue</code>”参数决定了数据框中的哪一列应该用于颜色编码。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="99c7" class="mn mo it on b gy or os l ot ou">sns.lmplot(x <strong class="on iu">=</strong> 'culmen_length_mm',y <strong class="on iu">=</strong> 'culmen_depth_mm', data <strong class="on iu">=</strong> df, hue <strong class="on iu">=</strong> 'species')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/240dbeca9ec1c85d39daded836313530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*7y1G5oTdu1Lc9tdaSNwCng.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">企鹅的长度和深度按物种分类|图片由作者提供</p></figure><p id="408c" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated">瞧啊。我们有一个辛普森效应的经典例子。虽然秆的长度和深度在群体水平上呈负相关，但物种水平的数据显示出相反的相关性。因此<strong class="lm iu">物种的类型</strong>在这里是一个<strong class="lm iu">潜伏变量</strong>。我们还可以使用下面的代码来查看每个物种的人的系数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pa pb l"/></div></figure><div class="kj kk kl km gt ab cb"><figure class="pe kn pf pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/4cb4e69044a38747ed9655e760dd8ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*EOm4SCGWijobj30NoQdZlQ.png"/></div></figure><figure class="pe kn pk pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/5b893e754fcca47bd7043b8ec1894c5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*5MiFXw4wem7giROBCQqeVA.png"/></div></figure><figure class="pe kn pl pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/3f8863115cc39d1031afef88c1fd04c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*bK7w4jPGD8o6JxV3qXR4qA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk pm di pn po translated">作者提供的图片</p></figure></div><blockquote class="oe of og"><p id="eba0" class="lk ll mf lm b ln mh ju lp lq mi jx ls oh mj lv lw oi mk lz ma oj ml md me lj im bi translated"><strong class="lm iu">这里是</strong> <a class="ae ky" href="https://nbviewer.jupyter.org/github/parulnith/Data-Science-Articles/tree/main/The%20curious%20case%20of%20Simpson%27s%20Paradox/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm iu"> nbviewer链接</strong> </a> <strong class="lm iu">到你想跟随的笔记本柜。</strong></p></blockquote></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="260f" class="ns mo it bd mp nt nu nv ms nw nx ny mv jz nz ka my kc oa kd nb kf ob kg ne oc bi translated">发现辛普森效应的工具🛠</h1><p id="624e" class="pw-post-body-paragraph lk ll it lm b ln ng ju lp lq nh jx ls lt ni lv lw lx nj lz ma mb nk md me lj im bi translated">在数据集中检测辛普森效应可能很棘手，需要一些仔细的观察和分析。然而，由于这个问题在统计世界中不时出现，很少有工具可以帮助我们处理它。一篇题为“<a class="ae ky" href="https://arxiv.org/abs/1805.03094" rel="noopener ugc nofollow" target="_blank">利用辛普森悖论发现行为数据中有趣的模式</a>”的论文于2018年发布，强调了一种数据驱动的发现方法，利用辛普森悖论来揭示行为数据中有趣的模式。<em class="mf">该方法系统地分解数据，以识别群体中行为与群体中其他成员明显不同的子群体。</em>这是一本很好的读物，也有代码链接。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="7e22" class="ns mo it bd mp nt nu nv ms nw nx ny mv jz nz ka my kc oa kd nb kf ob kg ne oc bi translated">结论</h1><p id="9add" class="pw-post-body-paragraph lk ll it lm b ln ng ju lp lq nh jx ls lt ni lv lw lx nj lz ma mb nk md me lj im bi translated">数据具有强大的力量，可以很容易地被操纵以满足我们的需求和目标。聚合和分组数据有多种方式。根据分组方式的不同，数据可能会产生混淆的结果。这取决于我们使用统计工具仔细评估所有细节，并寻找可能影响我们决策和结果的潜在变量。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="9610" class="pw-post-body-paragraph lk ll it lm b ln mh ju lp lq mi jx ls lt mj lv lw lx mk lz ma mb ml md me lj im bi translated"><em class="mf">👉有兴趣看我写的其他文章。这个</em> <a class="ae ky" href="https://github.com/parulnith/Data-Science-Articles/blob/main/README.md" rel="noopener ugc nofollow" target="_blank"> <em class="mf">回购</em> </a> <em class="mf">包含了我分类写的所有文章。</em></p></div></div>    
</body>
</html>