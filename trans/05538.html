<html>
<head>
<title>Productivity Tracking with the Notion API and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用概念API和Python进行生产力跟踪</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/productivity-tracking-with-the-notion-api-and-python-f5f866fe11d8?source=collection_archive---------7-----------------------#2021-05-17">https://towardsdatascience.com/productivity-tracking-with-the-notion-api-and-python-f5f866fe11d8?source=collection_archive---------7-----------------------#2021-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/4d812a2ece52d8a9d1c78dc6eb089846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6Xqc-hboGD7XaWGl"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@isaacmsmith?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾萨克·史密斯</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><div class=""/><div class=""><h2 id="7019" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使用新发布的概念API和Streamlit构建一个简单的项目跟踪仪表板</h2></div><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="8f53" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">随着最近备受期待的测试版<a class="ae jg" href="https://developers.notion.com" rel="noopener ugc nofollow" target="_blank">概念API </a>的发布，许多应用程序之间的集成现在已经成为可能，整个宇宙的可能性现在为数据科学项目敞开了大门。</p><p id="12a6" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在这篇文章中，我将向你展示如何用Streamlit和概念API构建一个简单的项目跟踪仪表板。T12】</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="52f5" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">如果你愿意，你可以看看我在youtube上关于这个话题的视频:</p><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="mi ld l"/></div></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h2 id="de33" class="mj mk jj bd ml mm mn dn mo mp mq dp mr ln ms mt mu lr mv mw mx lv my mz na nb bi translated">设置概念API</h2><p id="a6c5" class="pw-post-body-paragraph le lf jj lg b lh nc kk lj lk nd kn lm ln ne lp lq lr nf lt lu lv ng lx ly lz im bi translated">让我们从<a class="ae jg" href="https://thesweetsetup.com/a-beginners-guide-to-notion/#:~:text=You%20have%20two%20options:%20create,%3E%20Embed%20a%20sub-page%20." rel="noopener ugc nofollow" target="_blank">创建关于概念的页面</a>开始。现在，您需要在您的概念页面上创建一个集成令牌，然后与该集成共享您的数据库。关于如何做到这一点的详细教程可以在<a class="ae jg" href="https://developers.notion.com/docs/getting-started" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="cf6d" class="mj mk jj bd ml mm mn dn mo mp mq dp mr ln ms mt mu lr mv mw mx lv my mz na nb bi translated">设置一个简单的python API从数据库中获取数据</h2><p id="cdcc" class="pw-post-body-paragraph le lf jj lg b lh nc kk lj lk nd kn lm ln ne lp lq lr nf lt lu lv ng lx ly lz im bi translated">现在，您可以设置一个简单的python API来与您的概念应用程序中的数据库进行通信，以便您可以获取数据。</p><p id="b6af" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在我的例子中，我创建了一个简单的数据库，每个属性(表中的列)引用一个项目，每一行与一个月中的某一天相关，每个条目包含一个复选框，指示该项目是否在给定的那一天工作。在我的概念页面上，看起来是这样的:</p><figure class="ky kz la lb gt iv gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/e8193145d5953bde6e42e3ca0456539c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Jt_dGiyweV06Hjmo5-SwjA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="eb72" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">为了从概念数据库中获取数据，我们可以用三种方法编写一个类:</p><ol class=""><li id="9129" class="ni nj jj lg b lh li lk ll ln nk lr nl lv nm lz nn no np nq bi translated"><code class="fe nr ns nt nu b">query_databases()</code>从概念应用程序中获取数据；</li><li id="dbfd" class="ni nj jj lg b lh nv lk nw ln nx lr ny lv nz lz nn no np nq bi translated"><code class="fe nr ns nt nu b">get_projects_titles</code>获取您正在跟踪的项目的名称(它们将是您的概念数据库中的列的标题)；</li><li id="ad8f" class="ni nj jj lg b lh nv lk nw ln nx lr ny lv nz lz nn no np nq bi translated"><code class="fe nr ns nt nu b">get_projects_data</code>从概念API获得的结果字典对象中获取项目跟踪数据。</li></ol><p id="2595" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">python API的完整代码:</p><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="oa ld l"/></div></figure><p id="71a3" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">让我们快速分析一下每个组件:</p><ul class=""><li id="0be8" class="ni nj jj lg b lh li lk ll ln nk lr nl lv nm lz ob no np nq bi translated"><strong class="lg jk">查询数据库</strong></li></ul><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="oa ld l"/></div></figure><p id="7d8a" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">这里，我们使用来自概念API的集成令牌向我们的数据库发送一个post请求，并以json对象的形式返回响应，以便将数据格式化为我们稍后需要可视化的形状。</p><ul class=""><li id="3147" class="ni nj jj lg b lh li lk ll ln nk lr nl lv nm lz ob no np nq bi translated"><strong class="lg jk">获取项目名称</strong></li></ul><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="oa ld l"/></div></figure><p id="ad5d" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">这里，我们只是检索数据库中的所有属性。关于如何使用概念API处理数据库的更多细节可以在<a class="ae jg" href="https://developers.notion.com/docs/working-with-databases" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><ul class=""><li id="a556" class="ni nj jj lg b lh li lk ll ln nk lr nl lv nm lz ob no np nq bi translated"><strong class="lg jk">获取项目数据</strong></li></ul><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="oa ld l"/></div></figure><p id="c762" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">最后，我们从每个项目以及日期列中获取数据。</p><h2 id="f663" class="mj mk jj bd ml mm mn dn mo mp mq dp mr ln ms mt mu lr mv mw mx lv my mz na nb bi translated">使用Streamlit和plotly设置可视化</h2><p id="e32b" class="pw-post-body-paragraph le lf jj lg b lh nc kk lj lk nd kn lm ln ne lp lq lr nf lt lu lv ng lx ly lz im bi translated">现在我们已经加载了数据，让我们使用<code class="fe nr ns nt nu b">plotly</code>包来绘制项目的信息。</p><p id="c077" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">让我们做一些简单的事情，绘制一个条形图，显示在跟踪期间(在本例中是过去45天)每个项目上花费的天数，以及一个项目事件散点图，显示我的日常活动(我是否参与了每个项目)。</p><p id="aa65" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">让我们从导入依赖项开始。</p><pre class="ky kz la lb gt oc nu od oe aw of bi"><span id="c389" class="mj mk jj nu b gy og oh l oi oj">import plotly.graph_objs as go<br/>import pandas as pd<br/>import plotly.express as px<br/>from notion_api import *</span></pre><p id="12db" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">现在，我们使用python API从概念数据库中获取数据。</p><pre class="ky kz la lb gt oc nu od oe aw of bi"><span id="27d3" class="mj mk jj nu b gy og oh l oi oj">nsync = NotionSync()<br/>data = nsync.query_databases()<br/>projects = nsync.get_projects_titles(data)<br/>projects_data,dates = nsync.get_projects_data(data,projects)</span></pre><p id="a316" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们用我们想要研究的数据建立了一个数据框架，并绘制了事件跟踪器和条形图。</p><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="oa ld l"/></div></figure><figure class="ky kz la lb gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/62ab0e8f20940c25716140dd5e4bac06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y20_IGrVx_Hkj1OrIWLSlg.png"/></div></div></figure><p id="888b" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">效果非常好！这个工具真正酷的方面是，<strong class="lg jk"> <em class="ma">当我们更新我们的概念页面时，这个图会自动更新</em> </strong>而不需要任何额外的努力。</p><p id="735f" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">现在，<strong class="lg jk"> <em class="ma">让我们绘制一个事件图</em> </strong>，告诉我们在给定的时间段内每天都在做什么。</p><p id="22f7" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们需要将数据库中checkbox属性的布尔值转换为连续值，我们可以用这种方式绘制这些值，y轴上的每条线代表一个不同的项目，该线区域上的每个点代表在给定的一天参与了该项目。</p><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="oa ld l"/></div></figure><figure class="ky kz la lb gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/84e8dfbef87e281f74578f5369823c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gr07-DSAoMDSvgqb5C8Tug.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="b245" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们找到了。最后，让我们将这段代码封装在一个Streamlit应用程序中，这样我们就可以在任何时候通过在终端上运行一个命令来查看我们的数据。</p><p id="bc69" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">为此，我们只需要几行代码:</p><figure class="ky kz la lb gt iv"><div class="bz fp l di"><div class="oa ld l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="b900" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated"><code class="fe nr ns nt nu b">load_data</code>函数负责直接从我们的概念数据库中获取数据，下面的代码只是使用<code class="fe nr ns nt nu b">plotly</code>包为要在Streamlit中显示的图设置标题和副标题。Streamlit的极简风格让这变得非常简单。</p><p id="7d8c" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在终端上，使用<code class="fe nr ns nt nu b">streamlit run app.py</code>运行Streamlit应用程序</p><figure class="ky kz la lb gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi gj"><img src="../Images/6fa83dde4e1cee8c2836f1e783630629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iKDQlcdq9pQ1wSbeuGJ-Eg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="6618" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">这个项目的完整源代码可以在这里找到<a class="ae jg" href="https://github.com/EnkrateiaLucca/Productivity-Tracking-with-Streamlit-and-Notion-API" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="3b8e" class="ol mk jj bd ml om on oo mo op oq or mr kp os kq mu ks ot kt mx kv ou kw na ov bi translated">关于在数据科学项目中使用概念API的最终想法</h1><p id="572e" class="pw-post-body-paragraph le lf jj lg b lh nc kk lj lk nd kn lm ln ne lp lq lr nf lt lu lv ng lx ly lz im bi translated">这个新的测试版的概念API非常强大。意识到这个应用程序只提供了一个javascript版本的SDK，我写了这段代码来使它很好地与python集成。</p><p id="c48e" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">concept现在提供的与这个官方API的集成真的可以将像这样的生产力项目带到一个全新的水平，我觉得我们会在即将到来的未来看到越来越多真正有趣的功能出现。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="c9e9" class="pw-post-body-paragraph le lf jj lg b lh li kk lj lk ll kn lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">如果你喜欢这篇文章，请在<a class="ae jg" href="https://twitter.com/LucasEnkrateia" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae jg" href="https://www.linkedin.com/in/lucas-soares-969044167/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我，并在<a class="ae jg" href="https://lucas-soares.medium.com" rel="noopener"> Medium </a>上关注我。谢谢，下次再见！:)</p><h1 id="d777" class="ol mk jj bd ml om ow oo mo op ox or mr kp oy kq mu ks oz kt mx kv pa kw na ov bi translated">参考</h1><ul class=""><li id="57f5" class="ni nj jj lg b lh nc lk nd ln pb lr pc lv pd lz ob no np nq bi translated"><a class="ae jg" href="https://developers.notion.com/docs/getting-started" rel="noopener ugc nofollow" target="_blank">概念API入门</a></li><li id="1fbb" class="ni nj jj lg b lh nv lk nw ln nx lr ny lv nz lz ob no np nq bi translated"><a class="ae jg" href="https://developers.notion.com/docs/working-with-databases" rel="noopener ugc nofollow" target="_blank">在概念中使用数据库</a></li><li id="08c0" class="ni nj jj lg b lh nv lk nw ln nx lr ny lv nz lz ob no np nq bi translated"><a class="ae jg" href="https://developers.notion.com/reference/get-database" rel="noopener ugc nofollow" target="_blank">检索概念中的数据库</a></li><li id="bcb5" class="ni nj jj lg b lh nv lk nw ln nx lr ny lv nz lz ob no np nq bi translated"><a class="ae jg" href="https://realpython.com/api-integration-in-python/" rel="noopener ugc nofollow" target="_blank"> Python API集成教程</a></li><li id="4597" class="ni nj jj lg b lh nv lk nw ln nx lr ny lv nz lz ob no np nq bi translated"><a class="ae jg" href="https://streamlit.io" rel="noopener ugc nofollow" target="_blank">流线</a></li></ul></div></div>    
</body>
</html>