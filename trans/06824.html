<html>
<head>
<title>5 Must-Know SQL Functions for String Manipulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于字符串操作的5个必备SQL函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-must-know-sql-functions-for-string-manipulation-8b22526e6144?source=collection_archive---------15-----------------------#2021-06-20">https://towardsdatascience.com/5-must-know-sql-functions-for-string-manipulation-8b22526e6144?source=collection_archive---------15-----------------------#2021-06-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ac02" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">处理文本数据是数据分析的一个重要部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f885fd478a9ebd2f17023c2408afc6fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdxJdQYGBfK9hcLiAUn9mQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@aaronburden?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Aaron Burden </a>在<a class="ae ky" href="https://unsplash.com/s/photos/writing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="f7bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SQL用于管理关系数据库中的数据。然而，它提供的不仅仅是查询数据库。SQL函数还允许高效地执行数据分析和操作。</p><p id="34b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为大量的原始数据是以文本形式出现的，所以拥有多种操作字符串的方法是非常重要的。原始数据通常不是最理想的格式。我们操纵它们来创造有用的和信息丰富的特征。</p><p id="b29f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将介绍5个使用字符串的SQL函数。举例来说，我将使用Kaggle上的一小部分墨尔本房产<a class="ae ky" href="https://www.kaggle.com/dansbecker/melbourne-housing-snapshot" rel="noopener ugc nofollow" target="_blank">数据集</a>。</p><p id="2e41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我创建了一个名为melb的表。让我们先来看看数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/38fb2fdabd996c6ac4eeb9b87ed3ab1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tvQ3MuAoHOdnvtcYoTAJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="2a8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集包含一些待售房屋的信息。</p><p id="d0e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注</strong>:关系数据库管理系统有MySQL、SQL Server、PostgreSQL等几种。尽管它们大多采用相同的SQL语法，但可能会有一些细微的差别。在本文中，我们将使用PostgreSQL。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="1cd5" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">1.串联</h2><p id="aa15" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">串联一个字符串基本上就是将多个字符串组合成一个。在我们的数据集中，我们可以将address和region name列组合起来创建一个完整的地址。</p><p id="2ed5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用concat函数来执行这项任务。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="a8d2" class="md me it nc b gy ng nh l ni nj">SELECT CONCAT(address, ', ' , regionname) AS full_address <br/>FROM melb <br/>LIMIT 5;</span><span id="93dc" class="md me it nc b gy nk nh l ni nj">              full_address<br/>-----------------------------------------<br/>85 Turner St, Northern Metropolitan<br/>25 Bloomburg St, Northern Metropolitan<br/>5 Charles St, Northern Metropolitan<br/>40 Federation La, Northern Metropolitan<br/>55a Park St, Northern Metropolitan</span></pre><p id="9fe9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用“||”操作来连接字符串。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="d3b4" class="md me it nc b gy ng nh l ni nj">SELECT address || ', ' || regionname AS full_address<br/>FROM melb <br/>LIMIT 5;</span></pre><p id="02f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">limit关键字限制要显示的行数。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="f6df" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">2.裂开</h2><p id="30a6" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">一个字符串可能包含多条信息。在这种情况下，我们可能需要从字符串中提取一部分，并将其作为一个单独的特征。</p><p id="7a3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">地址栏包含门牌号。让我们用它来创建一个名为门牌号的新列。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="4d22" class="md me it nc b gy ng nh l ni nj">SELECT SPLIT_PART(address, ' ', 1) AS house_number <br/>FROM melb <br/>LIMIT 5;</span><span id="826f" class="md me it nc b gy nk nh l ni nj">house_number<br/>--------------<br/>85<br/>25<br/>5<br/>40<br/>55a</span></pre><p id="d9fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">split_part函数有3个参数。第一个是列名。第二个是定义分割点的字符，在我们的例子中是空格。第三个参数表示拆分后我们需要哪个部分。门牌号在地址的开头，所以我们取第一部分。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="aa2d" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">3.替换</h2><p id="f38c" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">replace函数允许用一组新的字符替换字符串的一部分。当我们需要标准化一些文本时，它就派上了用场。</p><p id="c53c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以将地址列中的“st”字符替换为单词“street”。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="b13b" class="md me it nc b gy ng nh l ni nj">SELECT address, REPLACE(address, 'St', 'Street') AS new_address <br/>FROM melb <br/>LIMIT 5;</span><span id="9cf2" class="md me it nc b gy nk nh l ni nj">    address      |     new_address<br/>-----------------+---------------------<br/>85 Turner St     | 85 Turner Street<br/>25 Bloomburg St  | 25 Bloomburg Street<br/>5 Charles St     | 5 Charles Street<br/>40 Federation La | 40 Federation La<br/>55a Park St      | 55a Park Street</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="ad30" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">4.左边和右边</h2><p id="2e4c" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">left和right函数可用于从字符串中提取一部分。我们根据字符的数量来定义要选择的部分。例如，带有5的left函数将从左侧返回前5个字符(即从头开始)。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="700d" class="md me it nc b gy ng nh l ni nj">SELECT LEFT(regionname, 5) AS region_5 <br/>FROM melb <br/>LIMIT 5;</span><span id="381f" class="md me it nc b gy nk nh l ni nj">region_5<br/>----------<br/>North<br/>North<br/>North<br/>North<br/>North</span></pre><p id="edbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">右函数的工作方式类似。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="127d" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">5.喜欢</h2><p id="c8ed" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">like其实是一个SQL运算符，不是函数。然而，在处理字符串时，它是一个非常有用的工具。我们可以用它来过滤与另一个字符串或一系列字符“相似”的字符串。</p><p id="e7ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以过滤包含字符串“Park”的地址。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="f6ae" class="md me it nc b gy ng nh l ni nj">SELECT address <br/>FROM melb <br/>WHERE address LIKE '%Park%' <br/>LIMIT 5;</span><span id="e8eb" class="md me it nc b gy nk nh l ni nj">   address<br/>----------------<br/>55a Park St<br/>49 Park St<br/>159 Park St<br/>17 Parkhill Dr<br/>93 Parkmore Rd</span></pre><p id="9546" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“%”代表任何字符。因此，我们正在过滤以任何字符开头和结尾的地址。它必须在某个地方包含“公园”。</p><p id="eaea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">like运算符区分大小写。我们很可能用“公园”得到不同的地址。让我们试试。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="260f" class="md me it nc b gy ng nh l ni nj">SELECT address <br/>FROM melb <br/>WHERE address LIKE '%park%' <br/>LIMIT 5;</span><span id="9d6e" class="md me it nc b gy nk nh l ni nj">    address<br/>-----------------<br/>18 Spark St<br/>14 Riverpark Dr<br/>1 Riverpark Dr<br/>23 Oakpark Dr</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="06aa" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">结论</h2><p id="98ef" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">文本数据是数据分析的重要组成部分。因此，我们需要有效的方法和技术来处理字符串。我们在本文中介绍的内容可以帮助您操作或更新字符串。您还可以使用这些函数从字符串中提取一条信息。</p><p id="dff3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>