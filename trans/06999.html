<html>
<head>
<title>Crack Data Science Interviews: Five SQL Skills for Data Scientists</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">破解数据科学访谈:数据科学家的五项SQL技能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/crack-data-science-interviews-five-sql-skills-for-data-scientists-cc6b32df1987?source=collection_archive---------3-----------------------#2021-06-25">https://towardsdatascience.com/crack-data-science-interviews-five-sql-skills-for-data-scientists-cc6b32df1987?source=collection_archive---------3-----------------------#2021-06-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b5be" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">破解数据科学面试</h2><div class=""/><div class=""><h2 id="3cd4" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">Leetcode助你获得高薪数据职位</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/0078a21998802dd78b2f3fd9beb45c81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_KcJn0abVjvjhlG1W8MwQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@zetong?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">泽通李</a>在<a class="ae lh" href="https://unsplash.com/s/photos/big-data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="a6de" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="6152" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">结构化查询语言SQL是数据从业者用来检索存储在关系数据库中的数据的首选编程语言。对于数据科学家来说，编写有效的查询请求不再被认为是一项不错的技能，而是一项基本技能。这种趋势可以通过在DS招聘信息和面试环节中具体包含SQL经验得到支持。</p><p id="1d80" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">除了编程(<a class="ae lh" rel="noopener" target="_blank" href="/5-python-coding-questions-asked-at-faang-59e6cf5ba2a0?sk=1e974890a4089d3697b2f3b00967bbd4"> Python </a>)、<a class="ae lh" rel="noopener" target="_blank" href="/classifying-rare-events-using-five-machine-learning-techniques-fab464573233?sk=f015318a6eb37b81a33b5dc004ee4be3">机器学习</a>、<a class="ae lh" rel="noopener" target="_blank" href="/how-user-interference-may-mess-up-your-a-b-tests-f29abfcfccf8?sk=9ff3bbae01ff9951e6eca33e1c75cff4"> A/B测试</a>和<a class="ae lh" rel="noopener" target="_blank" href="/crack-data-science-interviews-essential-statistics-concepts-d4491d85219e?sk=af5291865f239ad505e8a8a1a80cceb8">统计</a>，数据科学家经常被要求定义和从多个来源提取数据，以构建感兴趣的指标。不幸的是，SQL仍然是一项不受重视的技能，没有足够的数据科学家充分认识到它的多功能性和重要性。</p><p id="ecbc" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在过去的几个月里，我一直与主要技术公司的高级数据科学家和招聘经理保持密切联系。我收到的评价最高的建议和推荐之一是掌握SQL技能，并知道如何有效地提取数据。</p><p id="fffb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">为此，我创建了一个三部曲帖子，专为初级程序员量身定制。它从简单到中等难度的问题逐步进行。如果你最近开始了你的SQL之旅，我建议在阅读这篇文章之前先看看这三篇文章:1。<a class="ae lh" rel="noopener" target="_blank" href="/essential-sql-skills-for-data-scientists-in-2021-8eb14a38b97f?sk=152837507c40a42f5132c7a649222b0a">容易</a>，2。<a class="ae lh" rel="noopener" target="_blank" href="/4-tricky-sql-questions-for-data-scientists-in-2021-88ff6e456c77?sk=fcd25ff25193a68415e17fac109ee92a">容易/中等</a>和3。<a class="ae lh" rel="noopener" target="_blank" href="/crack-data-science-interviews-advanced-sql-skills-in-2021-322fef819c6c?sk=cd796b2b53f0b9106e59967d3e8fb8f3">中等</a>。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="5963" class="li lj it bd lk ll ni ln lo lp nj lr ls ki nk kj lu kl nl km lw ko nm kp ly lz bi translated">问题1:不同性别的累计总数</h1><div class="nn no gp gr np nq"><a href="https://leetcode.com/problems/running-total-for-different-genders/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">LeetCode</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">提高你的编码技能，迅速找到工作。这是扩展你的知识和做好准备的最好地方…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">leetcode.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe lb nq"/></div></div></a></div><p id="b8d8" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">编写一个SQL查询来查找每种性别每天的总分。</em></p><p id="68ec" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">按性别和日期排序结果表</em></p><p id="a10b" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">查询结果格式如下:</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="4290" class="ol lj it oh b gy om on l oo op">Scores table:<br/>+-------------+--------+------------+--------------+<br/>| player_name | gender | day        | score_points |<br/>+-------------+--------+------------+--------------+<br/>| Aron        | F      | 2020-01-01 | 17           |<br/>| Alice       | F      | 2020-01-07 | 23           |<br/>| Bajrang     | M      | 2020-01-07 | 7            |<br/>| Khali       | M      | 2019-12-25 | 11           |<br/>| Slaman      | M      | 2019-12-30 | 13           |<br/>| Joe         | M      | 2019-12-31 | 3            |<br/>| Jose        | M      | 2019-12-18 | 2            |<br/>| Priya       | F      | 2019-12-31 | 23           |<br/>| Priyanka    | F      | 2019-12-30 | 17           |<br/>+-------------+--------+------------+--------------+<br/>Result table:<br/>+--------+------------+-------+<br/>| gender | day        | total |<br/>+--------+------------+-------+<br/>| F      | 2019-12-30 | 17    |<br/>| F      | 2019-12-31 | 40    |<br/>| F      | 2020-01-01 | 57    |<br/>| F      | 2020-01-07 | 80    |<br/>| M      | 2019-12-18 | 2     |<br/>| M      | 2019-12-25 | 13    |<br/>| M      | 2019-12-30 | 26    |<br/>| M      | 2019-12-31 | 29    |<br/>| M      | 2020-01-07 | 36    |<br/>+--------+------------+-------+</span></pre><h2 id="b20b" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">穿过我的思维</h2><p id="d081" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">这是那种你第一眼就能解决或者感觉完全迷失的问题。它很容易把你引入歧途。</p><p id="3274" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">原因如下。</p><p id="9e67" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">问题要求“<em class="of">每个性别每天的总分，”</em>我的第一反应是计算累计总和，然后按性别和天分组。所以，我错误地试图在SQL中找到一个不存在的计算累积和的语法。</p><p id="9ae4" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">经过一番努力之后，我意识到我们可以应用<em class="of"> SUM() OVER( PARTITION BY… </em>)语句来计算按性别分组的累计总和。然后，按天排序结果。</p><h2 id="3643" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">解决办法</h2><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="150a" class="ol lj it oh b gy om on l oo op"># Write your MySQL query statement below<br/>SELECT gender, day, SUM(score_points) OVER(PARTITION BY gender ORDER BY day) AS total<br/>FROM Scores</span></pre><h2 id="e4af" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">经验法则:</h2><ul class=""><li id="4f35" class="pa pb it mc b md me mg mh mj pc mn pd mr pe mv pf pg ph pi bi translated">许多SQL命令遵循相同的语法，如SUM() OVER()、ROW_NUMBER() OVER()、LEAD() OVER等。理解了其中一个命令的用法，您就为其他命令做好了准备。</li><li id="ffd5" class="pa pb it mc b md pj mg pk mj pl mn pm mr pn mv pf pg ph pi bi translated">你一定要把你的测试结果分组吗？如果是这样，请使用PARTITION BY。</li><li id="a26e" class="pa pb it mc b md pj mg pk mj pl mn pm mr pn mv pf pg ph pi bi translated">成绩排名怎么样？如果是这样，请使用ORDER BY。</li></ul></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="af28" class="li lj it bd lk ll ni ln lo lp nj lr ls ki nk kj lu kl nl km lw ko nm kp ly lz bi translated">问题2:找出连续范围的起始数和结束数</h1><div class="nn no gp gr np nq"><a href="https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">LeetCode</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">提高你的编码技能，迅速找到工作。这是扩展你的知识和做好准备的最好地方…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">leetcode.com</p></div></div><div class="nz l"><div class="po l ob oc od nz oe lb nq"/></div></div></a></div><p id="f95d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">由于</em> <code class="fe pp pq pr oh b"><em class="of">Logs</em></code> <em class="of">中删除了部分id。编写一个SQL查询来查找表</em> <code class="fe pp pq pr oh b"><em class="of">Logs</em></code> <em class="of">中连续范围的开始和结束编号。</em></p><p id="c56e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">按</em> <code class="fe pp pq pr oh b"><em class="of">start_id</em></code> <em class="of">顺序排列结果表。</em></p><p id="32f9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">查询结果格式如下:</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="5073" class="ol lj it oh b gy om on l oo op">Logs table:<br/>+------------+<br/>| log_id     |<br/>+------------+<br/>| 1          |<br/>| 2          |<br/>| 3          |<br/>| 7          |<br/>| 8          |<br/>| 10         |<br/>+------------+</span><span id="c5cc" class="ol lj it oh b gy ps on l oo op">Result table:<br/>+------------+--------------+<br/>| start_id   | end_id       |<br/>+------------+--------------+<br/>| 1          | 3            |<br/>| 7          | 8            |<br/>| 10         | 10           |<br/>+------------+--------------+</span></pre><h2 id="d750" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">穿过我的思维</h2><p id="3fca" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">亚马逊在面试过程中包括了这个问题。</p><p id="9b5c" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">此问题询问缺少数字的连续范围的开始和结束。识别连续范围的起点和终点相对容易，可以分别使用<em class="of"> MIN(log_id) </em>和<em class="of"> MAX(log_id) </em>找到。棘手的部分是识别两个范围之间的不连续性。例如，我们如何辨别这两个连续范围之间的不连续性:1–3和7–8？在这里，我们遗漏了5、6和7。</p><p id="012a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">解决方案在于我们如何对结果进行分组。<strong class="mc jd">如果存在不连续，我们将观察到log_id和每个观察的行排名之间的差距。</strong>对于连续范围，观测值应具有相同的范围；如果有任何差距，那么我们观察到组差异的跳跃。</p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="0d25" class="ol lj it oh b gy om on l oo op">Logs table:<br/>+------------+<br/>| log_id     |<br/>+------------+<br/>| 1          |<br/>| 2          |<br/>| 3          |<br/>| 7          |<br/>| 8          |<br/>| 10         |<br/>+------------+</span></pre><p id="a0ab" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在Logs表中，数字1、2、3构成了一个连续的范围，log_id与行排名之差在同一范围内是一致的，为0(即log_id —行排名，1–1 = 2–2 = 3–3 = 0)。同样的规则也适用于7和8，两者相差3(即log _ id-row ranking = 7-4 = 8–5 = 3)。正如所看到的，当我们从第一范围移动到第二范围时，我们观察到差异的跳跃(不连续)(从0到3)。</p><h2 id="f6fa" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">解决办法</h2><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="42d9" class="ol lj it oh b gy om on l oo op"># Write your MySQL query statement below<br/>SELECT MIN(log_id) AS start_id, MAX(log_id) AS end_id <br/>FROM (<br/> SELECT log_id, ROW_NUMBER() OVER(ORDER BY log_id) AS row_id<br/> FROM Logs<br/>) sub<br/>GROUP BY log_id — row_id<br/>ORDER BY start_id</span></pre><h2 id="f775" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">经验法则:</h2><ul class=""><li id="24fe" class="pa pb it mc b md me mg mh mj pc mn pd mr pe mv pf pg ph pi bi translated">分析手头的问题，把它分解成不同的部分。如果需要，使用子查询来完成次要任务，并移至外部查询。</li><li id="27bc" class="pa pb it mc b md pj mg pk mj pl mn pm mr pn mv pf pg ph pi bi translated">ROW_NUMBER() OVER(ORDER BY …):获取每个单元的行号。</li><li id="9975" class="pa pb it mc b md pj mg pk mj pl mn pm mr pn mv pf pg ph pi bi translated">GROUP BY:log _ id和行号之间的差值，用于标识不连续性。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pt"><img src="../Images/2b3d248eb2875c397b29e83c77b61a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iz7ONqlreSPTdoJp9pAJMQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@onefabian?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">法比安·金特罗</a>在<a class="ae lh" href="https://unsplash.com/s/photos/nature?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="d361" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">问题3:部门最高工资</h1><div class="nn no gp gr np nq"><a href="https://leetcode.com/problems/department-highest-salary/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">LeetCode</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">提高你的编码技能，迅速找到工作。这是扩展你的知识和做好准备的最好地方…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">leetcode.com</p></div></div><div class="nz l"><div class="pu l ob oc od nz oe lb nq"/></div></div></a></div><p id="c1c2" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of"/><code class="fe pp pq pr oh b"><em class="of">Employee</em></code><em class="of">表包含所有雇员。每个雇员都有一个Id，一份薪水，还有一个部门Id列。</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="5f01" class="ol lj it oh b gy om on l oo op">+----+-------+--------+--------------+<br/>| Id | Name  | Salary | DepartmentId |<br/>+----+-------+--------+--------------+<br/>| 1  | Joe   | 70000  | 1            |<br/>| 2  | Jim   | 90000  | 1            |<br/>| 3  | Henry | 80000  | 2            |<br/>| 4  | Sam   | 60000  | 2            |<br/>| 5  | Max   | 90000  | 1            |<br/>+----+-------+--------+--------------+</span></pre><p id="1df0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of"/><code class="fe pp pq pr oh b"><em class="of">Department</em></code><em class="of">表包含公司的所有部门。</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="83b4" class="ol lj it oh b gy om on l oo op">+----+----------+<br/>| Id | Name     |<br/>+----+----------+<br/>| 1  | IT       |<br/>| 2  | Sales    |<br/>+----+----------+</span></pre><p id="fec3" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">编写一个SQL查询来查找每个部门中工资最高的雇员。对于上面的表，您的SQL查询应该返回下面的行(行的顺序无关紧要)。</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="eb7f" class="ol lj it oh b gy om on l oo op">+------------+----------+--------+<br/>| Department | Employee | Salary |<br/>+------------+----------+--------+<br/>| IT         | Max      | 90000  |<br/>| IT         | Jim      | 90000  |<br/>| Sales      | Henry    | 80000  |<br/>+------------+----------+--------+</span></pre><h2 id="d9ba" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">穿过我的思维</h2><p id="ca34" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">亚马逊在面试过程中包括了这个问题。</p><p id="679a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在给出具体细节之前，让我浏览一下总体分析。问题问的是各部门工资最高的员工。因此，自然的问题是可能有多个工资最高的雇员，我们需要返回匹配的雇员。</p><p id="f380" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">下面是具体的细分。我将使用一个子查询来获取按部门Id分组的最高(最大)薪金，然后在匹配部门ID和薪金之前连接雇员和部门表。</p><h2 id="2d7b" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">解决办法</h2><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="c2fc" class="ol lj it oh b gy om on l oo op"># Write your MySQL query statement below<br/>SELECT d.Name AS Department, e.Name AS Employee, Salary<br/>FROM Employee e<br/>JOIN Department d<br/>ON d.Id = e.DepartmentId</span><span id="6467" class="ol lj it oh b gy ps on l oo op">WHERE (DepartmentId,Salary) IN (<br/> SELECT DepartmentId, MAX(Salary)<br/> FROM Employee<br/> GROUP BY DepartmentId<br/>)</span></pre><h2 id="61d9" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">经验法则:</h2><ul class=""><li id="5564" class="pa pb it mc b md me mg mh mj pc mn pd mr pe mv pf pg ph pi bi translated"><code class="fe pp pq pr oh b"><em class="of">Department</em></code> <em class="of"> </em>表只包含两列，其唯一的功能是返回部门名称为部门id。这应该会变成看问题提示时的第二本能。</li><li id="9822" class="pa pb it mc b md pj mg pk mj pl mn pm mr pn mv pf pg ph pi bi translated">如果问题是返回每个组(如department)的最大/最小值，典型的方法是应用子查询为每个组创建一对最大/最小值，然后将该对与外部查询进行匹配(如WHERE子句中所示)。</li></ul></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="5fd2" class="li lj it bd lk ll ni ln lo lp nj lr ls ki nk kj lu kl nl km lw ko nm kp ly lz bi translated">问题4:第二高的薪水</h1><div class="nn no gp gr np nq"><a href="https://leetcode.com/problems/second-highest-salary/submissions/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">LeetCode</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">提高你的编码技能，迅速找到工作。这是扩展你的知识和做好准备的最好地方…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">leetcode.com</p></div></div><div class="nz l"><div class="pv l ob oc od nz oe lb nq"/></div></div></a></div><p id="ca6d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">编写一个SQL查询，从</em> <code class="fe pp pq pr oh b"><em class="of">Employee</em></code> <em class="of">表中获取第二高的薪水。</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="9913" class="ol lj it oh b gy om on l oo op">+----+--------+<br/>| Id | Salary |<br/>+----+--------+<br/>| 1  | 100    |<br/>| 2  | 200    |<br/>| 3  | 300    |<br/>+----+--------+</span></pre><p id="89d4" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">例如，给定上面的雇员表，查询应该返回</em> <code class="fe pp pq pr oh b"><em class="of">200</em></code> <em class="of">作为第二高的薪水。如果没有第二高的薪水，那么查询应该返回</em> <code class="fe pp pq pr oh b"><em class="of">null</em></code> <em class="of">。</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="67df" class="ol lj it oh b gy om on l oo op">+---------------------+<br/>| SecondHighestSalary |<br/>+---------------------+<br/>| 200                 |<br/>+---------------------+</span></pre><h2 id="341b" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">穿过我的思维</h2><p id="9bb8" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">亚马逊和苹果在他们的采访循环中包含了这个问题。</p><p id="7946" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我在另一篇博文中介绍了如何解决这个问题:</p><div class="nn no gp gr np nq"><a rel="noopener follow" target="_blank" href="/4-tricky-sql-questions-for-data-scientists-in-2021-88ff6e456c77"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">2021年数据科学家面临的4个棘手的SQL问题</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">可能会让你犯错的简单查询</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="pw l ob oc od nz oe lb nq"/></div></div></a></div><p id="311a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这是一个简单的问题，可以通过以下步骤解决:</p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="41de" class="ol lj it oh b gy om on l oo op">1. Rank Salary in a descending order</span><span id="80dd" class="ol lj it oh b gy ps on l oo op">2. LIMIT result by 1 and OFFSET 1, which returns the second highest salary</span><span id="e527" class="ol lj it oh b gy ps on l oo op">3. Use DISTINCT to deal with duplicates </span><span id="7aec" class="ol lj it oh b gy ps on l oo op">4. Include the IFNULL statement in the outer query </span></pre><p id="4bca" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/4-tricky-sql-questions-for-data-scientists-in-2021-88ff6e456c77?sk=fcd25ff25193a68415e17fac109ee92a">查看其他帖子了解详细解释</a>。包含它的唯一原因是为问题5提供基线分析，并允许我们比较和对比解决方案。</p><h2 id="54b5" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">解决办法</h2><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="8b20" class="ol lj it oh b gy om on l oo op">SELECT IFNULL(<br/> (SELECT DISTINCT Salary<br/>  FROM Employee<br/>  ORDER BY Salary DESC<br/>  LIMIT 1 <br/>  OFFSET 1),<br/>NULL) AS SecondHighestSalary</span></pre><h2 id="283c" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">经验法则:</h2><ul class=""><li id="8df0" class="pa pb it mc b md me mg mh mj pc mn pd mr pe mv pf pg ph pi bi translated">理解OFFSET和IFNULL是如何工作的。</li></ul></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="a948" class="li lj it bd lk ll ni ln lo lp nj lr ls ki nk kj lu kl nl km lw ko nm kp ly lz bi translated">问题5:第n高工资</h1><div class="nn no gp gr np nq"><a href="https://leetcode.com/problems/nth-highest-salary/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">LeetCode</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">提高你的编码技能，迅速找到工作。这是扩展你的知识和做好准备的最好地方…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">leetcode.com</p></div></div><div class="nz l"><div class="px l ob oc od nz oe lb nq"/></div></div></a></div><p id="dc2e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">编写一个SQL查询，从</em> <code class="fe pp pq pr oh b"><em class="of">Employee</em></code> <em class="of">表中获取第n份最高工资。</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="957e" class="ol lj it oh b gy om on l oo op">+----+--------+<br/>| Id | Salary |<br/>+----+--------+<br/>| 1  | 100    |<br/>| 2  | 200    |<br/>| 3  | 300    |<br/>+----+--------+</span></pre><p id="7805" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of">例如，给定上面的员工表，其中n = 2的第n个最高工资是</em> <code class="fe pp pq pr oh b"><em class="of">200</em></code> <em class="of">。如果没有第n个最高工资，那么查询应该返回</em> <code class="fe pp pq pr oh b"><em class="of">null</em></code> <em class="of">。</em></p><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="75ba" class="ol lj it oh b gy om on l oo op">+------------------------+<br/>| getNthHighestSalary(2) |<br/>+------------------------+<br/>| 200                    |<br/>+------------------------+</span></pre><h2 id="775d" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">穿过我的思维</h2><p id="d79d" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">这是一个普遍的问题，几乎所有的FAANG公司都希望求职者表现出色。</p><p id="0532" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">它要求第n个最高工资，如果没有这样的值，则返回<code class="fe pp pq pr oh b"><em class="of">null</em></code>。例如，如果我们输入n=2，则返回第二高的值；n=3，第三高。</p><p id="4843" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">第一步，我们需要根据薪水值(降序)在子查询中创建一个排名索引。在采访中，我们需要澄清我们应该如何处理平局:我们应该跳过下一个指数还是返回一个连续的数字？</p><p id="c32a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">对于我们的例子，我们选择DENSE_RANK来确保连续的排名；说出排名<em class="of">排名_薪资</em>。</p><p id="0645" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在外部查询中，我们选择DISTINCT Salary并在WHERE子句中设置<em class="of"> n = rankings_salary </em>，这将返回排名第n(最高)的薪金。</p><h2 id="e72b" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated">解决办法</h2><pre class="ks kt ku kv gt og oh oi oj aw ok bi"><span id="fd26" class="ol lj it oh b gy om on l oo op">CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT<br/>BEGIN<br/> RETURN (<br/> # Write your MySQL query statement below.<br/> SELECT IFNULL((SELECT DISTINCT Salary<br/> FROM (<br/> SELECT Salary, DENSE_RANK() OVER(ORDER BY Salary DESC) AS rankings_salary<br/> FROM Employee<br/> ) AS aaa<br/> WHERE n = rankings_salary), NULL) AS getNthHighestSalary)<br/> <br/> ;<br/>END</span></pre><h2 id="40d7" class="ol lj it bd lk oq or dn lo os ot dp ls mj ou ov lu mn ow ox lw mr oy oz ly iz bi translated"><strong class="ak">经验法则:</strong></h2><ul class=""><li id="1481" class="pa pb it mc b md me mg mh mj pc mn pd mr pe mv pf pg ph pi bi translated">如果您必须编写嵌套查询请求，请不要惊慌。推荐的方法是首先编写子查询中最里面的部分，然后一层一层地移动到外部查询。</li><li id="9053" class="pa pb it mc b md pj mg pk mj pl mn pm mr pn mv pf pg ph pi bi translated">一个常见的错误是:忘记命名子查询。</li><li id="76ba" class="pa pb it mc b md pj mg pk mj pl mn pm mr pn mv pf pg ph pi bi translated">不要忘记使用DISTINCT和IFNULL。</li></ul></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="abe6" class="li lj it bd lk ll ni ln lo lp nj lr ls ki nk kj lu kl nl km lw ko nm kp ly lz bi translated">外卖食品</h1><p id="685b" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">熟能生巧。</p><p id="dfa9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">当我开始用SQL编码时，我能执行的唯一查询是对表中的唯一值进行计数。快进到今天，我已经习惯了需要子查询、窗口函数和其他高级应用程序的更高级的编码任务。</p><p id="3bdc" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我想与我的数据同事们分享的最大收获是从小处着手，从错误中学习，并相信增量学习的价值。做那种成长，变得比昨天好1%的人。你最终会得到回报的。</p><p id="2415" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">感谢你的读者，祝一切顺利。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="aa9d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="of"> Medium最近进化出了它的</em> <a class="ae lh" href="https://blog.medium.com/evolving-the-partner-program-2613708f9f3c" rel="noopener"> <em class="of">作家伙伴计划</em> </a> <em class="of">，支持像我这样的普通作家。如果你还不是订户，通过下面的链接注册，我会收到一部分会员费。</em></p><div class="nn no gp gr np nq"><a href="https://leihua-ye.medium.com/membership" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">阅读叶雷华博士研究员(以及其他成千上万的媒体作家)的每一个故事</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">leihua-ye.medium.com</p></div></div><div class="nz l"><div class="py l ob oc od nz oe lb nq"/></div></div></a></div></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="8dc1" class="li lj it bd lk ll ni ln lo lp nj lr ls ki nk kj lu kl nl km lw ko nm kp ly lz bi translated">我的数据科学面试序列</h1><div class="nn no gp gr np nq"><a rel="noopener follow" target="_blank" href="/how-user-interference-may-mess-up-your-a-b-tests-f29abfcfccf8"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">用户干扰如何会搞乱你的A/B测试？</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">来自Lyft、LinkedIn和Doordash的三个解决方案</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="pz l ob oc od nz oe lb nq"/></div></div></a></div><div class="nn no gp gr np nq"><a rel="noopener follow" target="_blank" href="/online-controlled-experiment-8-common-pitfalls-and-solutions-ea4488e5a82e"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd jd gy z fp nv fr fs nw fu fw jc bi translated">运行A/B测试的8个常见陷阱</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">如何不让你的在线控制实验失败</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="qa l ob oc od nz oe lb nq"/></div></div></a></div></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="ae8f" class="li lj it bd lk ll ni ln lo lp nj lr ls ki nk kj lu kl nl km lw ko nm kp ly lz bi translated">喜欢读这本书吗？</h1><blockquote class="qb qc qd"><p id="99b8" class="ma mb of mc b md mw kd mf mg mx kg mi qe my ml mm qf mz mp mq qg na mt mu mv im bi translated">请在<a class="ae lh" href="https://www.linkedin.com/in/leihuaye/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://www.youtube.com/channel/UCBBu2nqs6iZPyNSgMjXUGPg" rel="noopener ugc nofollow" target="_blank"> Youtube </a>找到我。</p><p id="83cd" class="ma mb of mc b md mw kd mf mg mx kg mi qe my ml mm qf mz mp mq qg na mt mu mv im bi translated">还有，看看我其他关于人工智能和机器学习的帖子。</p></blockquote></div></div>    
</body>
</html>