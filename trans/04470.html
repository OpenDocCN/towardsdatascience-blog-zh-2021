<html>
<head>
<title>How to Automate your Online Prints Business with Etsy &amp; Prodigi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Etsy &amp;灵捷自动化您的在线打印业务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-automate-your-online-prints-business-with-etsy-prodigi-6a093bdff20?source=collection_archive---------22-----------------------#2021-04-16">https://towardsdatascience.com/how-to-automate-your-online-prints-business-with-etsy-prodigi-6a093bdff20?source=collection_archive---------22-----------------------#2021-04-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ae9c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">第1/2部分:如何使用Python和Etsy +灵积API创建订单</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9bd7860e590c08cc88504d6c1afd4ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*akB5PzN61MTJqVSd"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/Tzm3Oyu_6sk" rel="noopener ugc nofollow" target="_blank">图像</a>通过Unsplash</p></figure><p id="01cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4年来，我一直在经营我自己的基于体育数据的印刷业务/爱好&amp;在<a class="ae ky" href="https://www.etsy.com/uk/shop/SportsChord" rel="noopener ugc nofollow" target="_blank"> Etsy </a>、<a class="ae ky" href="https://www.thegpbox.com/vendors/sportschord/" rel="noopener ugc nofollow" target="_blank"> GPBox </a>和个人销售了1500多份印刷品。这是一个学习新编程语言/软件的神奇平台，也是一个发挥创造力和尝试新设计的地方。</p><p id="c0de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它开始是一个极其手工的过程；我会先把照片寄到我家，然后再改地址，送到当地邮局寄出。当我一周接到1到2个订单时，这只能勉强维持。在英国，我去过的每个地方，邮局排队的情况都很可怕！</p><p id="2629" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着订单的增加&amp;尤其是在圣诞节前后(约70%的年度订单来自11月/12月)，邮局的冲刺变得过于频繁和紧张。通过谷歌搜索，我了解了直运，即印刷商将订单直接发送给客户的过程。这样，您不需要投资持有任何库存，只需要在自己的商店收到订单时向打印机下订单。</p><p id="ff77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在尝试了几家供应商之后，我找到了一家。他们经营着一个制造中心的国际网络，产品种类繁多，从专业装裱的印刷品到t恤衫。在印花方面，我个人一直对质量很满意，我在Etsy商店收到的评论也反映了这一点。如果你想自己测试，灵知为新客户提供了不同印刷类型的样品包。</p><p id="a14f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几种方法可以在given上排序。仪表板允许您在在线表格中输入客户的详细信息，上传您的图像文件，然后跟踪您的订单状态。还有一个手动订单表单(我还没有亲自使用过)，允许您从导出的Etsy orders csv下多个订单。</p><p id="4eb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最强大的选项是Print API，它允许您使用来自Etsy API &amp;灵捷API的订单详细信息组合，以编程方式下订单并跟踪订单。天才刚刚宣布了他们的API的v4版本，增加了许多额外的特性，所以现在是时候测试一下了！</p><p id="cad1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码是用python编写的，使用requests包和几个支持csv文件来自动化整个订购过程。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="0af5" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">先决条件</h2><p id="a7c5" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">软件:你需要的所有代码都是用Python写的，所以你需要把它安装在你的机器上。为了加快速度，我还使用终端(Windows上的命令提示符)来快速下订单。</p><p id="ed02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">账号:</strong> Etsy店铺有一些房源，灵童账号下单。</p><p id="0cec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">知识:</strong>对Python和API如何工作的基本理解是很容易的，但是你可以通过使用完整的GitHub Repo或拼凑下面的代码片段来获得。</p><p id="7f44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">硬件:</strong>对于第2部分，我使用一个插在电视机后面的Raspberry Pi每小时调用一次API，检查未结订单的状态，尽管我确信有更好的方法可以做到这一点，我们将在后面讨论！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="0023" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">证明</h2><p id="2eb5" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我通常发现这是新项目中最辛苦的部分，但也是最重要的部分之一。当<a class="ae ky" href="https://www.prodigi.com/print-api/docs/reference/#environments" rel="noopener ugc nofollow" target="_blank">从灵物API </a>开始时，您有两个端点可以调用；“沙盒”,即当您创建订单时，没有生产发生，也没有成本。“prodigi”是生产端点，所以只有当您确定要下订单时才使用这个端点。</p><p id="6c29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">两个端点都有一个单独的密钥来认证用户，从版本4开始，在您进行的调用中只需要REST API密钥。我发现在代码的开头使用if语句来区分这两者很有用，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="05ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Etsy的<a class="ae ky" href="https://www.etsy.com/developers/documentation/getting_started/oauth" rel="noopener ugc nofollow" target="_blank">认证过程</a>有点复杂。你需要创建一个应用程序，将授予你一个关键和秘密。然后，您需要将它们交换为OAuth访问令牌和访问令牌密码(总共有4个唯一的字符串)。当用您的密钥和秘密交换令牌时，您还需要包含<a class="ae ky" href="https://www.etsy.com/developers/documentation/getting_started/oauth#section_permission_scopes" rel="noopener ugc nofollow" target="_blank">权限范围</a>(您的应用程序需要访问的内容)。出于这个项目的目的，您将需要<em class="nc"> transactions_r </em>和<em class="nc"> transactions_w. </em>参见下面生成所需令牌的示例脚本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="9bc3" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">收集Etsy订单详细信息</h2><p id="a0b0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">现在我们已经得到了所有的密钥和秘密，我们可以查询Etsy API来返回我们选择的订单的详细信息([order_num]是一个整数，表示未完成的订单，0表示最近的订单)。您需要将您的_SHOP_HERE替换为您的店铺id，您可以在此处找到<a class="ae ky" href="https://app.cartrover.com/get_etsy_shop_id.php" rel="noopener ugc nofollow" target="_blank"/>。使用json包，我们可以解包API的响应并收集订单细节。</p><p id="6288" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我指定了一系列必要的(名字，第一行，第二行等等。)和可选的(total，order_date)变量，当我们在Prodigi API上下订单时会重用这些变量。我包含了总数和订单日期，因为我将每个订单的信息保存在一个单独的表中，以便以后进行分析。</p><p id="b2e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第31–35行有效地映射了灵童和Etsy之间的国家代码。Prodigi要求两个字母的ISO代码，而Etsy提供整数格式的国家ID。你可以下载参考我这里用的<a class="ae ky" href="https://github.com/sportschord/prodigi/blob/main/Files/Countries.json" rel="noopener ugc nofollow" target="_blank">的表</a>。</p><p id="1247" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第36–42行在技术上并不是必需的，但是由于GB快递(皇家邮政跟踪递送)在灵吉上只是额外增加了1行，所以我选择将所有GB订单设置为快递选项，而不考虑他们的Etsy递送选项。</p><p id="3239" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经获得了所有客户的详细信息，我们需要调用特定的收据来找出他们订购了哪种打印。这是在第44–47行完成的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="92ba" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">映射和下单</h2><p id="319c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们获取收据的调用返回一个对象数组，每个订购的商品一个对象。由此，我们可以收集打印的详细信息，如列表ID以及我们在商店中设置的任何自定义变量。在我的情况下，我使用大小(A4，A3等。)和有框/无框印刷品。</p><p id="4493" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在清单Id和产品变体之间建立联系，我使用了一个excel文件中的映射表(你可以在这里找到一个<a class="ae ky" href="https://github.com/sportschord/prodigi/blob/main/Files/Print%20IDs.xlsx" rel="noopener ugc nofollow" target="_blank">的例子</a>)。它包括打印的大小&amp;类型，以及到实际图像文件的可共享链接(我将我所有的图像保存到Google Drive，并允许任何有特定链接的人访问它们，以便图像可以被gign获取)。</p><p id="d601" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦映射完成，我们就有了下订单所需的所有信息，接下来是时候构建json有效负载来发布到灵物API并下订单了。下面的大部分键值对使用我们从Etsy收据或随后的映射表中收集的信息。完整文档见<a class="ae ky" href="https://www.prodigi.com/print-api/docs/reference/#introduction" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="7f45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时，客户不会填写地址中的几行，因为在下Etsy订单时不需要这些行(第二行地址、州、城市)，这就是为什么需要更新这些字段(第51-59行)。</p><p id="4d7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些都确认后，第62行对灵物API进行POST调用来下订单。作为响应，您将获得一个状态代码，确认它是否成功或是否有错误。v4 API的错误消息似乎更详细，这对于检测调用中的任何缺口很有用。然后，您可以继续在灵物仪表盘上查看您的订单。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="1b8a" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">最后的想法</h2><p id="1334" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">加速下单的最后一个技巧是将整个代码包装在一个函数中，然后使用终端为您下单。你可以点击查看整个脚本<a class="ae ky" href="https://github.com/sportschord/prodigi/blob/main/Scripts/Etsy%20v4%20Place%20Order.py" rel="noopener ugc nofollow" target="_blank">。您可以通过使用sys.argv[n]来实现这一点，它允许python与terminal进行交互，并选取您以特定顺序输入的任何变量。中提供路径名的别名。zshrc文件并下一个新订单就像写<em class="nc">etsy 0‘灵童’</em>一样简单！</a></p><p id="9594" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第2部分中，我们将看看一旦下了订单会发生什么。当订单状态更新，我们需要向客户发送调度通知时，我们如何让Etsy和灵捷进行沟通？</p></div></div>    
</body>
</html>