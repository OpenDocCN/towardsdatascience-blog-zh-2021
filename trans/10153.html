<html>
<head>
<title>Sweatpants Unleashed — the Data Science of an Ignominious Garment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">宽松的运动裤——不光彩服装的数据科学</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sweatpants-unleashed-the-data-science-of-an-ignominious-garment-2e0c006202b0?source=collection_archive---------24-----------------------#2021-09-25">https://towardsdatascience.com/sweatpants-unleashed-the-data-science-of-an-ignominious-garment-2e0c006202b0?source=collection_archive---------24-----------------------#2021-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="54c5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">新冠肺炎如何解开宽松服装时间序列分析</h2></div><p id="b4a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将运行一个SARIMA模型及其诊断，进行KPSS、ADF、OCSB、CH和正态性检验。一步一步，用Python，在文明磨损的接缝处。</p><p id="92ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运动裤是失败的标志。你失去了对自己生活的控制，所以你买了一些运动裤。”卡尔·拉格费尔德</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/f5dee9e0be3fa368c72623256b28f71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*GH4j_TjG9bdn9nzMqckE2w.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">迈克·冯，<a class="ae lr" href="https://unsplash.com/photos/rj8ohjW9RBA" rel="noopener ugc nofollow" target="_blank">u</a>nsplash.com</p></figure><p id="2f00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将分析从2010年到2021年9月的关键字“运动裤”的每月谷歌趋势数据；然后研究我们能从历史和人类文明的进程中获得哪些新的见解。</p><p id="ce40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le"> (PSA:末日就要到了！)</em></p><p id="1fe0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lr" href="https://trends.google.com/trends/explore?date=2010-08-25%202021-09-25&amp;q=sweatpants" rel="noopener ugc nofollow" target="_blank">运动裤—探索—谷歌趋势</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ls"><img src="../Images/59c22012c304ed6ac27483b6e325d4f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CB0PEO6JZCnhgI8yc_VJdQ.jpeg"/></div></div></figure><h1 id="f62a" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">0.属国</h1><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="e1c6" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">1.数据处理</h1><h2 id="7b35" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">1.1阅读和争论</h2><p id="eef0" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">从Google Trends下载pants.csv文件后，我们将其读入Jupyter笔记本。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/bdf92c29b573646acac90ddadef773fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*5NxRAd-GtvrMiq0Qqtq8qA.jpeg"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nj"><img src="../Images/d46b05648f00c773b98e6af6cfdced01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8SbWGD51649voLRgUOIiaw.png"/></div></div></figure><p id="f384" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">“Month”列已经作为对象/字符串导入，因此我们将其转换为datetime，然后定义一个索引。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/b8eb0dd837417bc7ecfa295594819d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*Dyks0yldueY4morfVlr74g.png"/></div></figure><p id="1ab8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的分析仅限于2010年以来运动裤时尚的起伏。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/14d3ffb2825b141d28fd2f04c1be0857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*ELNCtb9xu9ssc65SUwYKLw.png"/></div></figure><p id="cf64" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们准备坐下来，开始一些严肃的数据争论，以了解运动裤时尚周期是由什么组成的。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/d3837017204fbe5a01a9da31ab89d502.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*AqQqz9QcgQHuPyXpv_6UMA.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">迈克·冯，nsplash.com</p></figure><h2 id="9163" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">1.2视觉分析</h2><p id="237f" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated"><strong class="kk iu"> 1.2a图表原始数据</strong></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nn"><img src="../Images/1cd8df5b6e322ab85f7f762fc25aed11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k7ERrOK3n5tK_dGwPtf5CQ.png"/></div></div></figure><p id="ba46" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们观察到一个上升的长期趋势。不可否认，在过去的十年里，文明一直在向悬崖边缘漂移。</p><p id="a79e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们看到稳定的季节性波动——一直稳定到最近。该模式显示每年都有一个单独的波峰和波谷。</p><p id="a984" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还察觉到一种漏斗状的波动模式。峰值和谷值在接近时间线末端时表现出更高的振幅。这表明异方差:方差不是时不变的。</p><p id="b732" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 1.2b异常值、热图、趋势和季节性</strong></p><p id="7201" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将创建一个数据透视表，从中我们将得到两个图表，这将使我们能够关注时间序列的不同方面。</p><p id="78aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据透视表为我们提供了一种聚集、排序和过滤源数据的好方法。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi no"><img src="../Images/a54196d97137b33632ca72a26256d269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Po5lA7ke_7IGZFLnZaixEQ.png"/></div></div></figure><p id="a963" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据透视表显示，运动裤的受欢迎程度在接近年底时会飙升。让我们想象一下热图中宽松裤子的热区。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/8326a47e51b1d96ca1c3e19bb3f7b576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*dGbQ7ybTZlxLifnZQDT_HA.png"/></div></figure><p id="e099" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在每年12月观察到季节性高峰，搜索活动在10月和11月开始增加。</p><ul class=""><li id="ea95" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">要么人们倾向于在寒冷的仲冬1月和2月前3个月，通过谷歌搜索舒适温暖但不太紧身的舒适服装，为寒冷的季节做好心理准备；</li><li id="45b8" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">或者成堆的包装好的运动裤——不幸的是——真的把圣诞树下的地板弄得乱七八糟。</li></ul><p id="1084" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在2020年的热图中，我们可以辨别出运动裤出轨的时刻:2020年4-5月和2020年11/12月。这些尖峰将成为我们分析的焦点。</p><p id="9f6a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们想象一下长期趋势。我们取我们的数据透视表，应用聚合函数‘mean’，选择<em class="le">年</em>作为数据透视表中的‘index’；然后绘制年利息的逐年趋势。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="86a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">巴黎时尚沙皇卡尔·拉格费尔德可能会惊呼“末日将至！”十多年来，如果卡尔是对的，我们的文明似乎一直在集体失去对我们生活的控制。</p><p id="9b28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在经历了2010年以来不可阻挡的增长路径后，我们在2020年达到了裤子宽松的峰值，至少是暂时的。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oe"><img src="../Images/04d48e2e724ad2f184d948ffbaae565a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYZIW3N1hbJxWGpPosz95Q.png"/></div></div></figure><p id="1541" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，让我们更仔细地调查源数据中的季节性。我们选择<em class="le">月</em>作为数据透视表中的索引，并让该表计算我们的时间序列中所有年份中每个月的平均值；然后画出12个月的曲线。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi of"><img src="../Images/843fc054b41d6f2f0206a1d21dd6669c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LXqeElmLj2NIbs2Loo8TxA.png"/></div></div></figure><p id="4199" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在每个第四季度末观察到一个季节性的裤子口袋高峰。该图表明，通常情况下，每年都会在6月/7月出现一个低谷，然后在12月出现一个高峰。</p><p id="e612" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总而言之，让我们将时间序列分解为趋势、季节性和残差，并在一个函数中加入相关图(ACF和PACF)。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi og"><img src="../Images/488bdce039100e30140d9bdd178288b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DOII7AQPJg5fETuk32WfIA.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oh"><img src="../Images/da3e3d16d1ad6f4a400255caa7a73939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XI1Qth-22LaRaqffyOmh-g.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oi"><img src="../Images/e3271ac862b2ee30f667ba3cc0bc1ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KuBmQJn2_Xmq6AhWBGVw7A.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oj"><img src="../Images/1dd4f720365acc9c07aadd2562f3461e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zm2YcQcyZcwimktyF5GN4Q.png"/></div></div></figure><p id="3ef3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">pmdarima包提供了tsdisplay方法来可视化时间序列。除了我们上面创建的图表，tsdisplay还显示了观察结果的直方图(右下角)。显然，观察值不是正态分布的；他们是左倾的。非正态性不会使我们想要开发的SARIMA预测模型无效。但是常态会给我们提供更可靠的预测和置信区间。</p><p id="6108" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更令人担忧的是顶部观察曲线的漏斗形状。加宽的漏斗表明方差不是时不变的，这对于时间序列预测是强制性的。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ok"><img src="../Images/0432e9dc7f82754cc9f91e2e65aa5943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*to5j1QPWYCn6qEn4ib2ZUg.png"/></div></div></figure><h1 id="1e4c" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">2.诊断和转换</h1><h2 id="bb5e" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">2.1同伦方差和正态性</h2><p id="b49b" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">直方图显示的观察值似乎不是正态分布的。让我们运行scipy.stats的<em class="le">常规测试</em></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ol"><img src="../Images/2344e4830337fe47f081ccdf66eaa946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ljW-8OiQGCfcuODy3rjSFQ.png"/></div></div></figure><p id="c6bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该检验证实了原始时间序列不是正态分布的，其p值小得几乎为零。</p><p id="6242" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我们不得不坐下来，穿着时髦的黑色运动裤，思考我们的下一步。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/9451fd086d2f42421b573c58bac649b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*onty21ZyHvlmRGbJtonJHQ.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">迈克·冯，<a class="ae lr" href="https://unsplash.com/photos/rj8ohjW9RBA" rel="noopener ugc nofollow" target="_blank">u</a>nsplash.com</p></figure><p id="0d0c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果可能的话，我们决定尝试两种变换来解决这两个问题:非正态性和——更迫切的——异方差(非恒定方差)。</p><p id="e9a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.1a对数转换</strong></p><p id="6efa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们对观察值进行对数变换。</p><p id="e07f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">转换的目的是以缩小其扩张漏斗(减少其异方差)的方式重塑观察曲线；并且理想地还通过调整它们分布的偏斜度和峰度来弯曲曲线，使得它与正态分布的数据更接近地对齐。</p><p id="9015" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">拟合预测模型后，我们将能够对预测值进行逆变换，使它们与原始的、未变换的时间序列数据具有可比性。</p><p id="585b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">pmdarima包提供了LogEndogTransformer方法。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi on"><img src="../Images/99947adb4f241dbc7b6323f1ea8ae619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQv9z94f8VQ73HJBmbiv3Q.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oo"><img src="../Images/bc1496a254d74d4c4c4f254ffc2702f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JidIA85hYmzCdSAXFpTIDg.png"/></div></div></figure><p id="9149" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">经过对数变换的折线图已经失去了它大部分有关的漏斗形状。方差似乎也是时不变的。直方图类似于正态分布，没有明显的向左或向右倾斜。正态性检验的高p值证实了这一点。</p><p id="cb0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.1b Box-Cox变换</strong></p><p id="a050" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为对数转换的替代方法，我们运行Box-Cox转换器，它通常比对数转换更有效。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi op"><img src="../Images/809dd00577045805fde1a4fdae6d7736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FaT24o2EtBAu1AEQ_EBuuw.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/0ec85f312db126164dcdac3f3f499d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*WXmV92AXLa_kwCuFbyVxaQ.png"/></div></figure><p id="d867" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些图表看起来类似于经过对数变换的序列。正态性检验返回一个更有利的p值。</p><p id="7c5b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将继续讨论Box-Cox变换系列。</p><h2 id="c8bc" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">2.2自相关结构</h2><p id="f62f" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">接下来，我们研究Box-Cox变换序列的相关图。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="0b48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在ACF中看到一个季节性的模式。因此，时间序列还不是静止的。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi or"><img src="../Images/cc3a65e3ecb8870f895ae8717f27d5a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IrKzLuKSMM6VrgzU6k5q3w.png"/></div></div></figure><h2 id="13da" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">2.3平稳性</h2><p id="42ca" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">如果时间序列的均值、方差和自相关结构不随时间变化，则时间序列是稳定的。如果它们不是时不变的，我们今天用来准备预报的属性将不同于我们明天观察到的属性。一个不稳定的过程会避开我们利用过去的观察来预测未来发展的方法。时间序列本身不需要在过去和未来期间保持平坦、恒定的直线才能被认为是平稳的，但决定其随时间变化的模式需要是平稳的，以使其未来行为可以预测。</p><p id="10bb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">时间序列需要展示:</p><ul class=""><li id="c573" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">非时变均值</li><li id="4332" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">非时变方差</li><li id="ae51" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">非时变自相关</li></ul><p id="942f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">变化无常的意思</strong></p><p id="f16d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">显示强劲上升或下降趋势的序列没有恒定的平均值。但是如果它的数据点在扰动后趋向于回复到趋势线，时间序列就是<em class="le">趋势</em>-平稳的。通过<em class="le">差分</em>时间序列——取观察值y(t)和早期观察值y(t-n)之间的差值——我们可以获得<em class="le">变化</em>的平稳(均值回复)序列。</p><p id="3d07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">具有<em class="le">季节性</em>的时间序列将显示出在恒定数量的周期之后重复的模式:一月份的温度与七月份的不同，但是一月份的温度将在几年之间处于相似的水平。<em class="le">季节差异</em>是指一个观测值与其前一个观测值之间的差异，即消除了S个滞后，S是一个完整季节的周期数，比如一年12个月或一周7天。</p><p id="a863" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果趋势和季节模式都是相对时间不变的，差分时间序列(相对于趋势的第一差分；和相对于季节性的季节性差异)将具有近似恒定的平均值。</p><p id="499f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在将预测模型拟合到数据之前，所需的差分阶数是应该预先确定的参数。“重要的是要注意，这些信息标准往往不是选择模型差分(d)的适当阶次的良好指南，而只是选择p和q的值。这是因为差分改变了计算似然性的数据，使得具有不同差分阶次的模型之间的AIC值不可比。所以我们需要使用一些其他方法来选择d，然后我们可以使用AICc来选择p和q”(hynd man，<a class="ae lr" href="https://otexts.com/fpp2/arima-estimation.html" rel="noopener ugc nofollow" target="_blank"> 8.6估计和顺序选择|预测:原则和实践(第二版)(otexts.com)</a>)。</p><p id="9328" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了确定是否需要差异，我们可以运行四个测试:</p><ul class=""><li id="eeea" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">一阶差分的增广Dickey-Fuller ADF</li><li id="dfe9" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">科维亚特科夫斯基-菲利普斯-施米特-申first获得第一名</li><li id="9d85" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">Osborn-Chui-Smith-Birchenhall OCSB季节性差异</li><li id="51f6" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">卡诺瓦-汉森季节差异研究中心</li></ul><p id="e26f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.3a一阶差分</strong></p><p id="df76" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用pmdarima的ADF和KPSS检验来获得建议的一阶差分。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/7c68c2a711a5bd837bf30a5f23653584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*M4L5Kws3BAspskMK5VBIAQ.png"/></div></figure><p id="5304" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有一个矛盾。KPSS要求1阶差分，而ADF要求0阶差分。</p><ul class=""><li id="a9a7" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">如果ADF测试没有找到单位根，但是KPSS测试找到了，这个序列就是<em class="le">差分</em>-平稳的:它仍然需要差分。</li><li id="44cd" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">相反，如果KPSS检验没有找到单位根，但是ADF检验找到了，那么该序列将被认为是<em class="le">趋势</em>-平稳的:它将需要差分(或其他变换，如去趋势)。</li><li id="25cc" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">一般来说:如果测试不一致，我们需要取两个测试结果中较高的<em class="le"/>(变量<em class="le"> n_diff </em>)作为适当的差分顺序。只有当两个检验都认为数列是平稳的，我们才能避免求差。</li></ul><p id="3cbc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.3b季节差异</strong></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/ff8e1ff7d3f33186c7b6e7fb5d09f86d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*zmet5QOTBSIKx4GiI9vlNA.png"/></div></figure><p id="0145" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们对Box-Cox变换系列进行OCSB和CH检验。两种测试都认为不需要季节差异。</p><p id="32c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.3c转换后的检查</strong></p><p id="09a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们结合平稳性的测试结果，并计算一个不同的时间序列。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><ul class=""><li id="dd9f" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">下面数据框中的“裤子”一栏包含了关于运动裤流行度的原始谷歌趋势数据。</li><li id="a2a5" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">列“y_bc”包含经过Box-Cox变换的值。</li><li id="ed8e" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">列“y_bc_diff”显示了差异值和转换值。</li></ul><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ou"><img src="../Images/00378b95296fa14aeac2bf3b041f5a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JKQLpS5qK8bukCSCHqfGLg.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ov"><img src="../Images/fd3ac6bb978fcae373e9ea8d793cb99e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ff729zHunxQoP5sIwhB3UQ.png"/></div></div></figure><p id="5e37" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后一轮诊断，现在是差异数据:</p><ul class=""><li id="e7c0" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">差异数据仍然通过了p值高于0.05的正态性检验</li><li id="48db" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">平稳性测试并不坚持额外的差分轮次</li></ul><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ow"><img src="../Images/e79740adfc8bb93646b97179b98f9eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_RJpLOZ40kYlt8vF4lFIA.png"/></div></div></figure><h2 id="91a4" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">2.4训练和测试数据集的拆分</h2><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="80d8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将Google趋势观察分为训练数据集和测试数据集。在持续的测试中，我们保留了最后的24个月用于测试。</p><h1 id="11d8" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">3.萨里玛</h1><h2 id="d2d8" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">3.1训练:自动ARIMA搜索超参数</h2><p id="346b" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">pmdarima包的AutoARIMA方法对SARIMA模型中的自回归AR项和移动平均MA项运行超参数搜索。</p><p id="33ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们选择逐步搜索，它使用Hyndman和Khandakar在2008年开发的算法(<a class="ae lr" href="https://cran.r-project.org/web/packages/forecast/vignettes/JSS2008.pdf" rel="noopener ugc nofollow" target="_blank">自动时间序列预测:R(r-project.org)</a>的预测包)。该算法比全网格搜索快得多，因为它避免了在搜索空间中处理无意义的参数元组。</p><p id="40fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将AutoARIMA方法的输入公式化为所谓的管道。管道由我们的Box-Cox转换组成(但是如果我们想要包含它们的话，可以包含额外的转换)。管道语法将使我们能够在计算预测时对模型结果进行逆变换。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ox"><img src="../Images/7197a2640c607dd1a86d49876473e2e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8lwpjoJ73-jqHCgWIJp39g.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/166aa3091b084fd58c44095af7c5ae82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*o2nVNZyy4oxwr5vEXeZ1nw.png"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oz"><img src="../Images/d5427ff328707d2433189b90109cda34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TEci8tzHYyXf23Kly45kmA.png"/></div></div></figure><p id="19fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">模型摘要</strong>显示了优秀的诊断结果:</p><ul class=""><li id="1a94" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated"><strong class="kk iu"> Ljung-Box测试</strong>返回非常高的p值0.91。所以残差代表<em class="le">白噪声</em>。它们不包含萨里玛模型未能发现的信号，而这些信号本可以用来提高其预测的准确性。</li><li id="ffb4" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="kk iu"> Jarque-Bera正态性检验</strong>得出非常高的p值0.72。偏斜度接近0，峰度接近3，因为它们应该类似于标准的正态分布。因此，我们得出结论，残差是正态分布的。预测值和置信区间将比具有可疑正态性的残差更可靠。</li><li id="afb3" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="kk iu">异方差测试</strong>得出非常高的p值0.78。我们得出结论，残差具有恒定的方差。</li><li id="d712" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">大部分的<strong class="kk iu">萨里玛参数</strong>都有远离零的系数，所以它们的影响是不可忽略的。第二个季节性AR术语<em class="le"> ar是个例外。S.L24 </em>，其系数接近于0，具有跨越零的宽置信区间。它的SAR项也显示出非常高的p值。我们的结论是，第二个SAR术语可能应该跳过。它对模型的贡献不大。</li></ul><h2 id="1bec" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">3.2预测准确性指标</h2><p id="434a" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">我们定义了一些预测准确性指标，这将使我们能够将我们刚刚准备的训练数据集的SARIMA模型与即将到来的样本外预测进行比较。</p><p id="afdc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用公式来填充字典:</p><ul class=""><li id="ec03" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">平均绝对误差(MAE)，</li><li id="9b65" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">平均绝对百分比误差(MAPE)，</li><li id="b7bc" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">均方根误差(RMSE)和</li><li id="669f" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">预测值和观测值之间的相关性</li></ul><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h2 id="45e8" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">3.3训练:样本内预测</h2><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="73b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">pmdarima的<em class="le"> predict_in_sample </em>方法将拟合的SARIMA(0，1，1)x(3，0，0)(12)模型应用于我们培训期间的月份。</p><p id="4b7e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">参数<em class="le"> inverse_transform </em>告知该方法以与原始时间序列相似的结构提供预测值及其置信区间:预测值不会被报告为Box-Cox变换值。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi pa"><img src="../Images/0d35fb9cc9958e461c59136ef6d1224b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_pQkdEnRYofWBN-eZr2QkQ.png"/></div></div></figure><p id="0c66" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">训练数据集的预测精度不会太差。</p><p id="bffb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">自动安装的SARIMA模型已经捕获了ca。91.5%的历史运动裤流行度起伏:平均绝对百分比误差MAPE相当于预测值和实际值之间的8.5%的差异。8.5 %由随机波动组成，模型无法提取稳定的模式。</p><p id="6d0b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">均方根误差RMSE是残差的标准偏差。RMSE讲述了预测与实际观测曲线的紧密程度。</p><p id="7246" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">预测值和实际值之间的(线性)相关性为97%。</p><h2 id="56b4" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">3.4测试:测试数据集的预测</h2><p id="33ae" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">接下来，我们在测试数据集中运行相同的SARIMA模型24个月。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/3c3a25adbcc3bf9eadbdb5014394c3a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*r6bLnH0Kaf865jR0IlLaSQ.png"/></div></figure><p id="4d80" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们得到的预测准确度要差得多。MAPE现在达到了23%。预测和实际观测的相关性从97%下降到78%。</p><p id="f0a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，在2020-2021年，是什么在困扰着我们的萨里玛模式呢？</p><p id="3c41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">训练和测试数据集之间预测准确性的巨大差异通常意味着<em class="le">过度拟合</em>。</p><ul class=""><li id="71ff" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated"><em class="le">欠拟合</em>的模型在拟合的训练数据集和测试数据集中都会表现出较低的精度。</li><li id="22b3" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated"><em class="le">过度拟合</em>的模型将在训练数据集中呈现高精度，但是处理新数据(例如测试数据集中的数据)的能力很差。</li></ul><p id="fdf8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们发布的<em class="le">运动裤案例中，</em>一旦2020年4月在家工作月开始，时间序列在之前10年遵循的模式不再适用。这意味着一个过度拟合模型，但过度拟合是不可避免的，因为2020年的中断无法从训练数据集中的2010-2019年历史数据中分离出来作为一种可预测的模式。</p><h2 id="d41b" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">3.5 2020年，过去的模式将不复存在</h2><p id="37c6" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">让我们回顾一下我们在源数据调查中创建的热图。我们注意到2020年是不同寻常的一年，</p><ul class=""><li id="fb73" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">2020年4月至5月，运动裤的谷歌搜索出现了不寻常的“非季节性”高峰；</li><li id="1a07" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">另一个高峰出现在2020年11月/12月，这与前几年的季节模式更相似，但作为一个热门时尚项目，它的<em class="le">增幅远远高于前几个冬季。</em></li></ul><p id="3384" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们不能仅从谷歌趋势数据中提取原因。但2020年的这种模式表明，4月份对运动裤的兴趣飙升，当时许多人不得不挤在家里温暖的笔记本电脑屏幕周围，而不是继续早晚通勤去工作场所。显然，我们大多数人选择不穿正式的办公室服装，而是坐在餐桌旁敲键盘。</p><p id="9020" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在2020年11月至12月，我们观察到运动裤欢呼的幅度高于往常，这可能是因为新冠肺炎病例在2021年初疫苗上市前的几个月里快速上升。在2020年的秋天，人们可能已经预料到不得不撤回到他们家的洞穴里度过一个漫长而可怕的冬天。</p><p id="26bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从我们的数据科学工具箱中，我们可以拉出用于<em class="le">协整</em> &amp; <em class="le">格兰杰因果关系(</em> <a class="ae lr" rel="noopener" target="_blank" href="/sibling-rivalry-and-cointegration-in-the-game-of-thrones-8642466fa2f2">格兰杰因果关系)的测试工具包。如果我们比较2020年在家工作和运动裤受欢迎的程度，我希望看到一些重要的格兰杰因果关系。</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/ebe10da0e5f74c2b8daaa4942df62df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*vB7UJwJoCFEkeZZ_8cCMdA.png"/></div></figure><p id="c18d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的下一步是什么？</p><p id="7a4a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们调查一下<em class="le">在家工作</em>的突然兴起对过去十年一直有效的时间序列模式造成了多大的破坏。</p><h1 id="576f" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">4.2020年的可预测趋势与趋势突变</h1><h2 id="83ce" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">4.1将SARIMA模型训练到断点</h2><p id="8cd5" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">从我们的谷歌趋势原始数据2010年至2021年，我们切下了一个训练数据集，该数据集于2020年3月结束，就在封锁和在家工作的惯例建立新的现实之前。</p><p id="349a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将新的SARIMA模型拟合到代表旧常态的训练数据集。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi pd"><img src="../Images/46192e6560ac0a1b0ed74a7a95adfedd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ErkwxJjN7NYwAAqWsEQIeA.png"/></div></div></figure><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="82de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们对2020年4月以来的几个月进行预测。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi pe"><img src="../Images/5f243abf8d5521ba45ae2478aa4c6c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxHYvGMPrjeWw8bV9pAzoA.png"/></div></div></figure><p id="f5c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">新的训练模型返回到2020年3月运动裤流行的预测。</p><h2 id="d8db" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">4.2在2020年4月的转折点之后测试SARIMA模型</h2><p id="76f8" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">让我们看看运动裤在2020年3月后不受新冠肺炎影响的另一个宇宙中会如何发展。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi pf"><img src="../Images/a087703b08233335442c70f02d62587d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXkA2aouJoiPX1KFeZh0Wg.png"/></div></div></figure><p id="5289" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如预期的那样，预测精度相当差，说明Covid的破坏从2020年4月开始将宽松裤趋势置于一条非常不同的、不可预见的道路上。</p><h2 id="ad27" class="mr ly it bd lz ms mt dn md mu mv dp mh kr mw mx mj kv my mz ml kz na nb mn nc bi translated">4.3自2020年4月以来不可预见的“在家工作”影响</h2><p id="5a1a" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">为了辨别新冠肺炎对运动裤时尚角落的影响程度，让我们比较一下2020年4月后在那个替代宇宙中的预测和在我们的宇宙中发生的事情。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><ul class=""><li id="440b" class="nq nr it kk b kl km ko kp kr ns kv nt kz nu ld nv nw nx ny bi translated">我们可以看到2011年至2020年第一季度间，萨里玛预测(橙色)与实际观测(蓝色)的接近程度。</li><li id="8080" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">在2020年第二季度初，运动裤突然出现了额外的蓝色尖峰，这在任何季节模式中都从未出现过。未预料到的4月/5月峰值导致了我们预测指标报告的大部分不准确性。</li><li id="a16d" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">SARIMA模型确实预测了2020年11月+12月的峰值。</li><li id="a07a" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">然而，该模型没有预见到运动裤会在2021年，也就是新年伊始之后，突然流行起来；甚至在许多在家工作的安排被改变之前。</li><li id="4e60" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">我们可以推测，家庭已经在2020年储备了运动裤。到2021年1月，他们在接下来的2到3年里都有宽松的裤装。所以对运动裤的寻找在2021年失去了紧迫性。</li><li id="6db7" class="nq nr it kk b kl nz ko oa kr ob kv oc kz od ld nv nw nx ny bi translated">运动裤行业在2020年蓬勃发展，随后在2021年初陷入萧条。</li></ul><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi pg"><img src="../Images/22bddad3a78933b9ad02f2505d85ce16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzxaT8_Tid6NTrk-9w4IGg.png"/></div></div></figure><p id="1302" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步可能是进行干预分析，分离出在家工作的影响，例如将其定义为外生变量</p><p id="7a9a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但我们今天不会这么做。相反，我们会把穿着宽松衣服的腿翘起来小睡一会儿。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/7801c6e13ae78a8e46ac3396edf0141e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tQT6NVFPzODkeo_qYcPdQg.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">迈克·冯，nsplash.com</p></figure></div></div>    
</body>
</html>