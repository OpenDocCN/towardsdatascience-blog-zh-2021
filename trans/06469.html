<html>
<head>
<title>How to Build an AutoML App in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python构建AutoML应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-an-automl-app-in-python-e216763d10cd?source=collection_archive---------6-----------------------#2021-06-10">https://towardsdatascience.com/how-to-build-an-automl-app-in-python-e216763d10cd?source=collection_archive---------6-----------------------#2021-06-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c0083014b158f8ab791c23fdb17a9150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EB-df3hPVAd_6IDjmVyCLg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用来自<a class="ae jg" href="https://1.envato.market/c/2346717/628379/4662" rel="noopener ugc nofollow" target="_blank"> envato elements </a>的<a class="ae jg" href="https://elements.envato.com/user/koctia" rel="noopener ugc nofollow" target="_blank"> koctia </a>的图像创建(经许可)。</p></figure><h2 id="2ffd" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/tag/data-science" rel="noopener">数据科学</a> | <a class="ae ep" href="https://medium.com/tag/machine-learning" rel="noopener">机器学习</a></h2><div class=""/><div class=""><h2 id="0d69" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">使用Streamlit库的分步教程</h2></div><p id="2960" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">自动化机器学习(AutoML)通过简化流程来帮助降低机器学习模型构建的门槛，从而允许非技术用户利用机器学习的力量。另一方面，AutoML的可用性也有助于解放数据科学家的时间(否则他们会花在冗余和重复的预处理任务或模型构建任务上)，允许他们探索数据分析管道的其他领域。</p><p id="d3fc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">简而言之，用户可以向AutoML系统提供输入数据集，用于模型构建(特征转换、特征选择、超参数优化等)。)最后，它将预测作为输出返回。</p><p id="3c15" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你可以构建自己的AutoML应用程序，并根据自己的喜好进行定制，这不是很好吗？该AutoML应用程序的开发分为两部分:(1)模型部署有助于完成数据生命周期，以及(2) AutoML有助于非技术用户访问ML。</p><p id="24ec" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本文中，我们将使用Streamlit和Scikit-learn库用Python构建一个AutoML应用程序。这个web应用程序将允许用户上传他们自己的CSV文件，并且web应用程序将通过执行网格超参数搜索来自动构建随机森林模型。</p><p id="3fca" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">需要注意的是，这篇文章的灵感来自于我前段时间在我的YouTube频道上做的一个视频(<a class="ae jg" href="https://youtu.be/HT2WHLgYpxY" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jt"> <em class="md">如何搭建一个机器学习超参数优化App</em></strong></a>)(<a class="ae jg" href="https://youtube.com/dataprofessor" rel="noopener ugc nofollow" target="_blank"><strong class="lj jt"><em class="md">数据教授</em> </strong> </a>)。</p><figure class="me mf mg mh gt iv"><div class="bz fp l di"><div class="mi mj l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://youtu.be/HT2WHLgYpxY" rel="noopener ugc nofollow" target="_blank"> <em class="mk">如何搭建机器学习超参数优化App </em> </a> @ <a class="ae jg" href="https://youtube.com/dataprofessor" rel="noopener ugc nofollow" target="_blank">数据教授</a></p></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="54c9" class="ms mt jj bd mu mv mw mx my mz na nb nc ky nd kz ne lb nf lc ng le nh lf ni nj bi translated">1.AutoML应用程序概述</h1><p id="dce8" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">我们今天构建的AutoML应用程序不到200行代码，确切地说是171行。</p><h2 id="945c" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">1.1.技术堆栈</h2><p id="b3e0" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">web应用程序将使用以下库在Python中构建:</p><ul class=""><li id="7903" class="oa ob jj lj b lk ll ln lo lq oc lu od ly oe mc of og oh oi bi translated"><code class="fe oj ok ol om b">streamlit</code> —网络框架</li><li id="78d7" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated"><code class="fe oj ok ol om b">pandas</code> —处理数据帧</li><li id="a047" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated"><code class="fe oj ok ol om b">numpy</code> —数值数据处理</li><li id="c71f" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated"><code class="fe oj ok ol om b">base64</code> —对要下载的数据进行编码</li><li id="1290" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated"><code class="fe oj ok ol om b">scikit-learn</code> —进行超参数优化，建立机器学习模型</li></ul><h2 id="82b7" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">1.2.用户界面</h2><p id="c933" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">web应用程序有一个简单的界面，由两个面板组成:(1)左侧面板接受输入CSV数据和参数设置，而(2)主面板显示输出，包括打印出输入数据集的数据帧、模型的性能指标、超参数调整的最佳参数以及调整后的超参数的3D等值线图。</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/e3b77da43d50f3bee17dde0b43257863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XKbeK8iY6WOllH5MRfqvQg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">AutoML应用程序的屏幕截图。</p></figure><h2 id="8ca6" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">1.3.AutoML应用程序演示</h2><p id="cae1" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">让我们看一下下面2个截图中的web应用程序，这样你就可以对你将要构建的应用程序有个大概的了解。</p><p id="7274" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> <em class="md"> 1.3.1。AutoML应用程序使用示例数据集</em> </strong></p><p id="3edd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">试用web应用程序的最简单方法是使用提供的示例数据集，方法是单击主面板中的<code class="fe oj ok ol om b">Press to use Example Dataset</code>按钮，这将加载糖尿病数据集作为示例数据集。</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/905f8bb81e3b61ec6073b68203895eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hI3t1hRXvTLkWrPsyI2_uw.gif"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用示例数据集的AutoML应用程序的屏幕截图。</p></figure><p id="6dfc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">1 . 3 . 2<em class="md">。AutoML应用程序使用上传的CSV数据</em> </strong></p><p id="a89e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">或者，您也可以上传自己的CSV数据集，方法是将文件直接拖放到上传框中(如下图所示)，或者点击<code class="fe oj ok ol om b">Browse files</code>按钮并选择要上传的输入文件。</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/99ed8b1a05052987384c790a74528de4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jUInXkladH4XAfd5M783cg.gif"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用输入CSV数据集的AutoML应用程序的屏幕截图。</p></figure><p id="ff9a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在上面的两个屏幕截图中，在提供示例数据集或上传的CSV数据集后，应用程序打印出数据集的数据帧，通过使用提供的输入学习参数自动构建几个机器学习模型，以执行超参数优化，然后打印出模型性能指标。最后，在主面板的底部提供了调整后的超参数的交互式3D等高线图。</p><p id="2734" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">您也可以点击以下链接试用该应用程序:</p><ul class=""><li id="ed12" class="oa ob jj lj b lk ll ln lo lq oc lu od ly oe mc of og oh oi bi translated"><a class="ae jg" href="https://share.streamlit.io/dataprofessor/ml-opt-app/main/ml-opt-app.py" rel="noopener ugc nofollow" target="_blank">AutoML应用的演示链接</a></li></ul><h1 id="f02c" class="ms mt jj bd mu mv ou mx my mz ov nb nc ky ow kz ne lb ox lc ng le oy lf ni nj bi translated">2.代码</h1><p id="5942" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">现在让我们深入了解一下AutoML应用程序的内部工作原理。如你所见，整个应用程序只用了171行代码。</p><p id="958c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">应该注意的是，代码中提供的所有注释(由包含散列标签符号<code class="fe oj ok ol om b">#</code>的行表示)通过记录每个代码块正在做什么来使代码更可读。</p><figure class="me mf mg mh gt iv"><div class="bz fp l di"><div class="oz mj l"/></div></figure><h2 id="1bb0" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第1–10行</h2><p id="ea97" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">导入必要的库，包括<code class="fe oj ok ol om b">streamlit</code>、<code class="fe oj ok ol om b">pandas</code>、<code class="fe oj ok ol om b">numpy</code>、<code class="fe oj ok ol om b">base64</code>、<code class="fe oj ok ol om b">plotly</code>和<code class="fe oj ok ol om b">scikit-learn</code>。</p><h2 id="f753" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第15–16行</h2><p id="3736" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated"><code class="fe oj ok ol om b">set_page_config()</code>功能允许我们将网页标题指定为<code class="fe oj ok ol om b">page_title=‘The Machine Learning Hyperparameter Optimization App’</code>，并将页面布局设置为全幅模式，如<code class="fe oj ok ol om b">layout=’wide’</code>输入参数所指定。</p><h2 id="dd5c" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第19–25行</h2><p id="f748" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">在这里，我们使用st.write()函数和markdown语法，通过在标题文本<code class="fe oj ok ol om b">The Machine Learning Hyperparameter Optimization App</code>前面使用<code class="fe oj ok ol om b">#</code>标签来编写第20行的网页标题文本。在随后的几行中，我们编写了web应用程序的描述。</p><h2 id="97fa" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第29–58行</h2><p id="b0a4" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">这些代码块属于左侧面板中的输入小部件，它接受用户输入的CSV数据和模型参数。</p><ul class=""><li id="5f44" class="oa ob jj lj b lk ll ln lo lq oc lu od ly oe mc of og oh oi bi translated">第29–33行—第29行通过<code class="fe oj ok ol om b">st.sidebar.header()</code>函数打印左侧边栏面板的标题文本，其中函数中的sidebar指示输入小部件应该放置在左侧边栏面板中的位置。线30通过<code class="fe oj ok ol om b">st.sidebar.file_uploader()</code>功能接受用户输入的CSV数据。正如我们所看到的，有2个输入参数，其中第一个是文本标签<code class="fe oj ok ol om b">Upload your input CSV file</code>，而第二个输入参数<code class="fe oj ok ol om b">type=[“csv”]</code>限制只接受CSV文件。第31–33行通过<code class="fe oj ok ol om b">st.sidebar.markdown()</code>函数以Markdown语法打印到示例数据集的链接。</li><li id="b66b" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第36行—通过<code class="fe oj ok ol om b">st.sidebar.header()</code>功能打印标题文本<code class="fe oj ok ol om b">Set Parameters</code>。</li><li id="2f7f" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第37行通过<code class="fe oj ok ol om b">st.sidebar.slider()</code>功能显示一个滑动条，允许用户通过简单调整滑动条来指定数据分割比率。第一个输入参数打印小部件标签文本<code class="fe oj ok ol om b">Data split ratio (% for Training Set)</code>，其中接下来的4个值代表最小值、最大值、默认值和增量步长。最后，将指定值赋给<code class="fe oj ok ol om b">split_size</code>变量。</li><li id="bd2b" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第39–47行显示学习参数的输入部件，而第49–54行显示一般参数的输入部件。类似于对第37行的解释，这些代码行也利用<code class="fe oj ok ol om b">st.sidebar.slider()</code>作为输入小部件，接受用户指定的模型参数值。第56–58行将滑块输入的用户指定值组合成一个聚合形式，然后作为负责超参数调整的<code class="fe oj ok ol om b">GridSearchCV()</code>函数的输入。</li></ul><h2 id="6194" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第64行</h2><p id="68fd" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">通过<code class="fe oj ok ol om b">st.subheader()</code>功能在输入数据帧上方添加一个副标题文本<code class="fe oj ok ol om b">Dataset</code>。</p><h2 id="160e" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第69–73行</h2><p id="9340" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">这段代码将通过<code class="fe oj ok ol om b">base64</code>库对模型性能结果进行编码和解码，作为一个可下载的CSV文件。</p><h2 id="bc4a" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第75–153行</h2><p id="cc16" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">在高层次上，这个代码块是<code class="fe oj ok ol om b">build_model()</code>自定义函数，它将接受输入数据集和用户指定的参数，然后执行模型构建和超参数调整。</p><ul class=""><li id="6deb" class="oa ob jj lj b lk ll ln lo lq oc lu od ly oe mc of og oh oi bi translated">第76–77行——输入数据帧分为<code class="fe oj ok ol om b">X</code>(删除最后一列Y变量)和<code class="fe oj ok ol om b">Y</code>(特别选择最后一列)变量。</li><li id="c601" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第79行——这里我们通过<code class="fe oj ok ol om b">st.markdown()</code>函数通知用户模型正在构建中。然后在第80行，Y变量的列名通过<code class="fe oj ok ol om b">st.info()</code>函数打印在一个信息框中。</li><li id="e7e5" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第83行——使用<code class="fe oj ok ol om b">X</code>和<code class="fe oj ok ol om b">Y</code>变量作为输入数据，通过<code class="fe oj ok ol om b">train_test_split()</code>功能执行数据分割，而用户指定的分割比率值由<code class="fe oj ok ol om b">split_size</code>变量指定，该变量从第37行描述的滑动条中取值。</li><li id="1d82" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第87–95行—通过分配给<code class="fe oj ok ol om b">rf</code>变量的<code class="fe oj ok ol om b">RandomForestRegressor()</code>函数实例化随机森林模型。如您所见，<code class="fe oj ok ol om b">RandomForestRegressor()</code>函数中定义的所有模型参数都从用户指定的输入小部件中获取参数值，如上文第29–58行所述。</li><li id="f138" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第97–98行—执行超参数调整。<br/> →第97行——在<code class="fe oj ok ol om b">rf</code>变量中指定的上述随机森林模型被指定为<code class="fe oj ok ol om b">GridSearchCV()</code>函数中的<code class="fe oj ok ol om b">estimator</code>参数的输入变量，它将执行超参数调整。在超参数调整中探索的超参数值范围在<code class="fe oj ok ol om b">param_grid</code>变量中指定，该变量直接从用户指定值中取值，该值从滑动条(第40-43行)获得，并作为<code class="fe oj ok ol om b">param_grid</code>变量(第56-58行)进行预处理。<br/> →第98行——超参数调整过程从输入<code class="fe oj ok ol om b">X_train</code>和<code class="fe oj ok ol om b">Y_train</code>作为输入数据开始。</li><li id="f3ef" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第100行—通过<code class="fe oj ok ol om b">st.subheader()</code>功能打印型号性能副标题文本。接下来的行将打印模型性能指标。</li><li id="1600" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第102行——存储在<code class="fe oj ok ol om b">grid</code>变量中的超参数调整过程的最佳模型被用于对<code class="fe oj ok ol om b">X_test</code>数据进行预测。</li><li id="e997" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第103–104行—通过使用<code class="fe oj ok ol om b">Y_test</code>和<code class="fe oj ok ol om b">Y_pred_test</code>作为输入参数的<code class="fe oj ok ol om b">r2_score()</code>函数打印R2分数。</li><li id="521a" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第106–107行—通过使用<code class="fe oj ok ol om b">Y_test</code>和<code class="fe oj ok ol om b">Y_pred_test</code>作为输入参数的<code class="fe oj ok ol om b">mean_squared_error()</code>函数打印MSE分数。</li><li id="4854" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第109–110行—打印最佳参数，并四舍五入到小数点后两位。最佳参数值从<code class="fe oj ok ol om b">grid.best_params_</code>和<code class="fe oj ok ol om b">grid.best_score_</code>变量中获得。</li><li id="2056" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第112–113行—第112行通过<code class="fe oj ok ol om b">st.subheader()</code>功能打印副标题<code class="fe oj ok ol om b">Model Parameters</code>。第113行通过<code class="fe oj ok ol om b">st.write()</code>功能打印存储在<code class="fe oj ok ol om b">grid.get_params()</code>中的模型参数。</li><li id="865b" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第116-125行——从<code class="fe oj ok ol om b">grid.cv_results_</code>获得模型性能指标，并重新调整为<code class="fe oj ok ol om b">x</code>、<code class="fe oj ok ol om b">y</code>和<code class="fe oj ok ol om b">z</code>。<br/> →第116行——我们将有选择地从<code class="fe oj ok ol om b">grid.cv_results_</code>中提取一些数据，这些数据将用于创建一个包含2个超参数组合及其相应性能指标的数据框架，在本例中是R2分数。特别是，<code class="fe oj ok ol om b">pd.concat()</code>功能将用于组合2个超参数(<code class="fe oj ok ol om b">params</code>)和性能指标(<code class="fe oj ok ol om b">mean_test_score</code>)。<br/> →第118行——现在将进行数据整形，以将数据准备成适合创建等高线图的格式。特别是，<code class="fe oj ok ol om b">pandas</code>库中的<code class="fe oj ok ol om b">groupby()</code>函数将用于根据两列(<code class="fe oj ok ol om b">max_features</code>和<code class="fe oj ok ol om b">n_estimators</code>)对数据帧进行分组，从而合并第一列(<code class="fe oj ok ol om b">max_features</code>)的内容。</li><li id="aab5" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第120–122行—数据现在将被旋转到一个m ⨯ n矩阵中，其中的行和列分别对应于<code class="fe oj ok ol om b">max_features</code>和<code class="fe oj ok ol om b">n_estimators</code>。</li><li id="2eb6" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第123-125行——最后，各<code class="fe oj ok ol om b">x</code>、<code class="fe oj ok ol om b"> y</code>和<code class="fe oj ok ol om b">z</code>变量的整形数据将用于绘制等高线图。</li><li id="c2c5" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第128-146行——这些代码块现在将通过<code class="fe oj ok ol om b">plotly</code>库使用<code class="fe oj ok ol om b">x</code>、<code class="fe oj ok ol om b"> y</code>和<code class="fe oj ok ol om b">z</code>变量创建3D等高线图。</li><li id="7780" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第149-152行——然后将<code class="fe oj ok ol om b">x</code>、<code class="fe oj ok ol om b"> y</code>和<code class="fe oj ok ol om b">z</code>变量组合成一个<code class="fe oj ok ol om b">df</code>数据帧。</li><li id="994a" class="oa ob jj lj b lk on ln oo lq op lu oq ly or mc of og oh oi bi translated">第153行——存储在grid_results变量中的模型性能结果现在可以通过<code class="fe oj ok ol om b">filedownload()</code>自定义函数下载(第69–73行)。</li></ul><h2 id="e67e" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">第156–171行</h2><p id="4f6f" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">在高层次上，这些代码块将执行应用程序的逻辑。这由2个代码块组成。第一个是<code class="fe oj ok ol om b">if</code>代码块(第156-159行)，第二个是<code class="fe oj ok ol om b">else</code>代码块(第160-171行)。每次web应用程序加载时，它将默认运行<code class="fe oj ok ol om b">else</code>代码块，而<code class="fe oj ok ol om b">if</code>代码块将在输入CSV文件上传时被激活。</p><p id="0f7a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于两个代码块，逻辑是相同的，唯一的区别是<code class="fe oj ok ol om b">df</code>数据dataframe的内容(无论它是来自输入CSV数据还是来自示例数据)。接下来，通过<code class="fe oj ok ol om b">st.write()</code>功能显示<code class="fe oj ok ol om b">df</code>数据框的内容。最后，通过<code class="fe oj ok ol om b">build_model()</code>自定义函数启动模型构建过程。</p><h1 id="3cc0" class="ms mt jj bd mu mv ou mx my mz ov nb nc ky ow kz ne lb ox lc ng le oy lf ni nj bi translated">3.运行AutoML应用程序</h1><p id="b20b" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">现在我们已经编写了应用程序，让我们继续启动它。</p><h2 id="96c3" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">3.1.创造康达环境</h2><p id="966c" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">让我们首先创建一个新的<code class="fe oj ok ol om b">conda</code>环境(为了确保代码的可再现性)。</p><p id="01c4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先，在终端命令行中创建一个名为<code class="fe oj ok ol om b">automl</code>的新<code class="fe oj ok ol om b">conda</code>环境，如下所示:</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="cee0" class="np mt jj om b gy pe pf l pg ph">conda create -n automl python=3.7.9</span></pre><p id="3085" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其次，我们将登录到<code class="fe oj ok ol om b">automl</code>环境</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="5488" class="np mt jj om b gy pe pf l pg ph">conda activate automl</span></pre><h2 id="c41d" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">3.2.安装必备库</h2><p id="0858" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">首先，下载<code class="fe oj ok ol om b">requirements.txt</code>文件</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="4f1b" class="np mt jj om b gy pe pf l pg ph">wget <a class="ae jg" href="https://raw.githubusercontent.com/dataprofessor/ml-auto-app/main/requirements.txt" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/dataprofessor/</a><a class="ae jg" href="https://github.com/dataprofessor/ml-opt-app" rel="noopener ugc nofollow" target="_blank">ml-opt-app</a><a class="ae jg" href="https://raw.githubusercontent.com/dataprofessor/ml-auto-app/main/requirements.txt" rel="noopener ugc nofollow" target="_blank">/main/requirements.txt</a></span></pre><p id="8fcc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其次，安装如下所示的库</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="4700" class="np mt jj om b gy pe pf l pg ph">pip install -r requirements.txt</span></pre><h2 id="e9fe" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">3.3.下载应用程序文件</h2><p id="413a" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">您可以下载数据教授的GitHub repo上托管的web应用程序文件，也可以使用上面找到的171行代码。</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="c26e" class="np mt jj om b gy pe pf l pg ph">wget <a class="ae jg" href="https://github.com/dataprofessor/ml-app/archive/main.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/dataprofessor/</a><a class="ae jg" href="https://github.com/dataprofessor/ml-opt-app" rel="noopener ugc nofollow" target="_blank">ml-opt-app</a><a class="ae jg" href="https://github.com/dataprofessor/ml-app/archive/main.zip" rel="noopener ugc nofollow" target="_blank">/archive/main.zip</a></span></pre><p id="7429" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">接下来，解压缩文件内容</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="e323" class="np mt jj om b gy pe pf l pg ph">unzip main.zip</span></pre><p id="fa10" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在通过<code class="fe oj ok ol om b">cd</code>命令进入<code class="fe oj ok ol om b">main</code>目录</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="8434" class="np mt jj om b gy pe pf l pg ph">cd main</span></pre><p id="e025" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在你在<code class="fe oj ok ol om b">main</code>目录中，你应该能够看到<code class="fe oj ok ol om b">ml-opt-app.py</code>文件。</p><h2 id="dc70" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">3.4.启动web应用程序</h2><p id="794b" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">要启动应用程序，请在终端提示符下键入以下命令(即确保<code class="fe oj ok ol om b">ml-opt-app.py</code>文件位于当前工作目录中):</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="5982" class="np mt jj om b gy pe pf l pg ph">streamlit run ml-opt-app.py</span></pre><p id="e437" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">几秒钟后，终端提示中出现以下消息。</p><pre class="me mf mg mh gt pa om pb pc aw pd bi"><span id="ec0e" class="np mt jj om b gy pe pf l pg ph">&gt; streamlit run ml-opt-app.py</span><span id="4527" class="np mt jj om b gy pi pf l pg ph">You can now view your Streamlit app in your browser.</span><span id="cf09" class="np mt jj om b gy pi pf l pg ph">Local URL: <a class="ae jg" href="http://localhost:8501" rel="noopener ugc nofollow" target="_blank">http://localhost:8501</a><br/>Network URL: <a class="ae jg" href="http://10.0.0.11:8501" rel="noopener ugc nofollow" target="_blank">http://10.0.0.11:8501</a></span></pre><p id="fb1c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，应该会弹出一个浏览器和应用程序。</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pj"><img src="../Images/58d9a3ec6fdb4175b57e8fefe91bbf0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqt5vgJeG9J2wNpJTaNPBQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">本地启动的AutoML App截图。</p></figure><p id="1e61" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">您也可以通过以下链接测试AutoML应用程序:</p><ul class=""><li id="50b0" class="oa ob jj lj b lk ll ln lo lq oc lu od ly oe mc of og oh oi bi translated"><a class="ae jg" href="https://share.streamlit.io/dataprofessor/ml-opt-app/main/ml-opt-app.py" rel="noopener ugc nofollow" target="_blank"><strong class="lj jt"><em class="md">AutoML App的演示链接</em> </strong> </a></li></ul><h1 id="b045" class="ms mt jj bd mu mv ou mx my mz ov nb nc ky ow kz ne lb ox lc ng le oy lf ni nj bi translated">4.结论</h1><p id="5308" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">现在您已经按照本文中的描述创建了AutoML应用程序，接下来呢？你或许可以将这款应用调整为另一种机器学习算法。附加功能，如功能重要性图也可以添加到应用程序中。可能性是无穷的，并享受定制应用程序的乐趣！请随时发表评论，说明您是如何为自己的项目修改应用程序的。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h2 id="0491" class="np mt jj bd mu nq nr dn my ns nt dp nc lq nu nv ne lu nw nx ng ly ny nz ni jp bi translated">订阅我的邮件列表，获取我在数据科学方面的最佳更新(偶尔还有免费赠品)!</h2></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="3894" class="ms mt jj bd mu mv mw mx my mz na nb nc ky nd kz ne lb nf lc ng le nh lf ni nj bi translated">关于我</h1><p id="f1d4" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">我是泰国一所研究型大学的生物信息学副教授和数据挖掘和生物医学信息学负责人。在我下班后的时间里，我是一名YouTuber(又名<a class="ae jg" href="http://bit.ly/dataprofessor/" rel="noopener ugc nofollow" target="_blank">数据教授</a>)制作关于数据科学的在线视频。在我制作的所有教程视频中，我也在GitHub上分享Jupyter笔记本(<a class="ae jg" href="https://github.com/dataprofessor/" rel="noopener ugc nofollow" target="_blank">数据教授GitHub page </a>)。</p><div class="is it gp gr iu pk"><a href="https://www.youtube.com/dataprofessor" rel="noopener  ugc nofollow" target="_blank"><div class="pl ab fo"><div class="pm ab pn cl cj po"><h2 class="bd jt gy z fp pp fr fs pq fu fw js bi translated">数据教授</h2><div class="pr l"><h3 class="bd b gy z fp pp fr fs pq fu fw dk translated">数据科学、机器学习、生物信息学、研究和教学是我的激情所在。数据教授YouTube…</h3></div><div class="ps l"><p class="bd b dl z fp pp fr fs pq fu fw dk translated">www.youtube.com</p></div></div><div class="pt l"><div class="pu l pv pw px pt py ja pk"/></div></div></a></div><h1 id="0ee5" class="ms mt jj bd mu mv ou mx my mz ov nb nc ky ow kz ne lb ox lc ng le oy lf ni nj bi translated">在社交网络上与我联系</h1><p id="6f07" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">✅YouTube:<a class="ae jg" href="http://youtube.com/dataprofessor/" rel="noopener ugc nofollow" target="_blank">http://youtube.com/dataprofessor/</a><br/>♇网站:<a class="ae jg" href="https://www.youtube.com/redirect?redir_token=w4MajL6v6Oi_kOAZNbMprRRJrvJ8MTU5MjI5NjQzN0AxNTkyMjEwMDM3&amp;q=http%3A%2F%2Fdataprofessor.org%2F&amp;event=video_description&amp;v=ZZ4B0QUHuNc" rel="noopener ugc nofollow" target="_blank">http://dataprofessor.org/</a>(在建)<br/>♇LinkedIn:<a class="ae jg" href="https://www.linkedin.com/company/dataprofessor/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/company/dataprofessor/</a><br/>♇Twitter:<a class="ae jg" href="https://twitter.com/thedataprof" rel="noopener ugc nofollow" target="_blank">https://twitter.com/thedataprof</a>/<br/>♇Facebook:<a class="ae jg" href="https://www.youtube.com/redirect?redir_token=w4MajL6v6Oi_kOAZNbMprRRJrvJ8MTU5MjI5NjQzN0AxNTkyMjEwMDM3&amp;q=http%3A%2F%2Ffacebook.com%2Fdataprofessor%2F&amp;event=video_description&amp;v=ZZ4B0QUHuNc" rel="noopener ugc nofollow" target="_blank">http://facebook.com/dataprofessor/</a><br/>♇github:<a class="ae jg" href="https://github.com/dataprofessor/" rel="noopener ugc nofollow" target="_blank">https://github.com/dataprofessor/</a><br/>♇Instagram:)</p></div></div>    
</body>
</html>