<html>
<head>
<title>Views in SQL: Underutilised, Yet Very Useful</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL中的视图:未充分利用，但非常有用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/views-in-sql-underutilised-yet-very-useful-6895cf607456?source=collection_archive---------18-----------------------#2021-09-15">https://towardsdatascience.com/views-in-sql-underutilised-yet-very-useful-6895cf607456?source=collection_archive---------18-----------------------#2021-09-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4da7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">视图如何帮助跨SQL数据库的分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c7af97551e6edb65267b7b2c58edf368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AiE8BHSJRImXWtm4l-zpIQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:图片来自<a class="ae ky" href="https://pixabay.com/photos/binoculars-field-military-optics-1741047/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="a0df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">视图</strong>是SQL中的虚拟表，其功能类似于标准表，但不需要物理存储，即它只存储在内存中，不占用实际存储空间。</p><p id="329a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，经常会有人希望看到表中数据的子集，或者以某种方式组织的数据。</p><p id="c37f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果只是为了便于理解数据，那么将数据存储在一个表中可能效率很低，因为这意味着额外的存储空间将被用来有效地从另一个表中创建重复的数据。</p><p id="e66c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看一些例子。</p><h1 id="11d7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用ORDER BY和LIMIT查询创建视图</h1><p id="8888" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">考虑下面这个名为<strong class="lb iu">衣服</strong>(所有条目都是作者虚构的)的假设表，它描述了一家商店出售的一系列衣服。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="f635" class="mx lw it mt b gy my mz l na nb">item               | price   | size <br/>-------------------+---------+--------<br/>Sky Blue Jeans     |  79.99  | 31<br/>Fire Red Jeans     |  89.99  | 36<br/>Sky Blue Shirt     |  59.99  | 38<br/>Grass Green Shirt  |  69.99  | 34<br/>...<br/>Peach Purple Hat   |  79.99  | 40<br/>Sun Yellow Jeans   |  109.99 | 42<br/>Olive Green Hat    |  89.99  | 37</span></pre><p id="7c91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，一个表中有数千个这样的条目。但是，商店的所有者想要创建一个视图，其中1)只显示商品和价格，2)只显示按价格排列的前三个条目。让我们创建一个视图，并将其命名为<strong class="lb iu"> condensedclothes </strong>:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7990" class="mx lw it mt b gy my mz l na nb">create view condensedclothes as select item, price from clothes order by price desc limit 3;</span></pre><p id="cd75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果输出如下:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="2f1c" class="mx lw it mt b gy my mz l na nb">&gt;&gt;&gt; select view condensedclothes from database;<br/>item               | price   <br/>-------------------+---------<br/>Black Sunglasses   |  149.99<br/>Blue Sneakers      |  129.99<br/>Red Polo Shirt     |  129.99</span></pre><p id="16e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个假设的场景中，我们可以看到下面的视图让所有者快速查看哪些商品的零售价格最高。然而，使用视图具有以下优点:1)它允许所有者快速查看相关信息，而不必每次都输入单独的查询；以及2)视图不使用存储空间来显示，因为它存储在存储器中。</p><h1 id="059e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建具有内部连接的视图</h1><p id="e8b1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">除了上表之外，假设还存在另一个提供所列项目说明的表:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7e0e" class="mx lw it mt b gy my mz l na nb">&gt;&gt;&gt; select * from clothes limit 1;<br/>item               | price   | size <br/>-------------------+---------+--------<br/>Sky Blue Jeans     |  79.99  | 31</span><span id="e273" class="mx lw it mt b gy nc mz l na nb">&gt;&gt;&gt; select * from clothes2 limit 1;<br/>item                | colour   | type <br/>--------------------+----------+----------<br/>Grass Green T-Shirt | Green    | T-Shirt</span></pre><p id="37af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们假设所有者希望将两个表连接在一起，并按价格查看前三个销售商品——但这次是从<strong class="lb iu">衣服2 </strong>表中添加信息。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="bcdb" class="mx lw it mt b gy my mz l na nb">&gt;&gt;&gt; create view orderedclothes as select t1.item, t1.price, t2.colour, t2.type from clothes as t1 inner join clothes2 as t2 on t1.item=t2.item order by t1.price desc limit 3;<br/>CREATE VIEW</span><span id="e994" class="mx lw it mt b gy nc mz l na nb">&gt;&gt;&gt; select * from orderedclothes;<br/>           item           | price   | colour  | type<br/>--------------------------+---------+---------+-------<br/>Black Sunglasses          |  149.99 | Black   | Sunglasses<br/>Blue Sneakers             |  129.99 | Blue    | Sneakers<br/>Red Polo Shirt            |  129.99 | Red     | Polo Shirt<br/>(3 rows)</span></pre><p id="7061" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，选择新创建的视图(在本例中命名为<strong class="lb iu">ordered waters</strong>)，允许我们按降序查看价格最高的三个项目，但是添加了来自第二个表的信息。</p><p id="3206" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，视图存储在内存中，没有使用数据库本身的存储。</p><h1 id="9000" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">视图的缺点</h1><p id="ca35" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">正如我们所看到的，从能够快速方便地查看表的重要部分的角度来看，视图非常有用。它们还具有不占用存储空间的优点。</p><p id="85b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，使用视图也有一些缺点——主要是在数据操作方面。</p><p id="4179" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，虽然更新视图中包含的数据是可能的，但在许多情况下都不可能做到。这包括在更新视图时使用联接，使用GROUP BY子句，以及在使用视图时DISTINCT子句不可用。</p><p id="3ae6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这方面，如果需要定期更新视图中的数据，视图并不总是最佳选择。</p><p id="ba77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，值得记住的是，视图中的数据本身可以存储为一个单独的表。</p><p id="b41f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，假设我们希望获取<strong class="lb iu"> condensedclothes </strong>视图，并将数据存储在一个表中(我们称这个表为<strong class="lb iu"> condensedtable </strong>)。我们可以这样做:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="85ac" class="mx lw it mt b gy my mz l na nb">&gt;&gt;&gt; create table condensedtable as select * from condensedclothes;<br/>SELECT 3</span><span id="eefc" class="mx lw it mt b gy nc mz l na nb">&gt;&gt;&gt; select * from condensedtable;<br/>item               | price   <br/>-------------------+---------<br/>Black Sunglasses   |  149.99<br/>Blue Sneakers      |  129.99<br/>Red Polo Shirt     |  129.99<br/>(3 rows)</span></pre><p id="2133" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦来自一个视图的数据现在被存储在一个表中，用户就可以更加灵活地利用更大范围的查询，而这在使用视图本身时是不可能的。</p><h1 id="57d5" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="083b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">本文介绍了SQL中的视图以及如何使用它们。特别是，我们看了看:</p><ul class=""><li id="2213" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">视图的优势和使用它们的原因</li><li id="6f01" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">如何在一系列SQL查询中实现视图</li><li id="449a" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">视图的缺点以及何时以表格格式存储更有意义</li></ul><p id="858e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，使用视图的主要优点之一是，它允许查看表的精简版本，而不必使用存储空间——因为视图存储在内存中。</p><p id="832a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，视图可以提供两方面的优势，1)在视图中快速分析数据，2)当希望执行更高级的查询时，将数据存储在表中。</p><p id="2307" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢阅读，任何问题或反馈都非常感谢！您还可以在这里找到原始文章<a class="ae ky" href="https://www.michael-grogan.com/articles/views-sql" rel="noopener ugc nofollow" target="_blank"/>，以及有用的SQL实践的更多例子。</p><h1 id="8caa" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><ul class=""><li id="04df" class="nd ne it lb b lc mn lf mo li nr lm ns lq nt lu ni nj nk nl bi translated">斯蒂芬斯、琼斯和普勒(2016):24小时内的SamsTechYourself</li></ul><p id="6316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nu">免责声明:本文是在“原样”的基础上编写的，没有任何担保。它旨在提供数据科学概念的概述，不应被解释为专业建议。本文中的发现和解释是作者的发现和解释，不被本文中提到的任何第三方认可或隶属于任何第三方。作者与本文提及的任何第三方无任何关系。</em></p></div></div>    
</body>
</html>