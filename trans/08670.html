<html>
<head>
<title>An Ultimate Guide to Time Series Analysis in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫时间序列分析终极指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-ultimate-guide-to-time-series-analysis-in-pandas-d511b8e80e81?source=collection_archive---------22-----------------------#2021-08-10">https://towardsdatascience.com/an-ultimate-guide-to-time-series-analysis-in-pandas-d511b8e80e81?source=collection_archive---------22-----------------------#2021-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/6ee9c4dd04f899fa3f82fb44b8fb6833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BCnM8lFfetiry0r6"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">桑德拉·维尔廷格在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="4719" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">在Pandas中执行时间序列分析所需的所有Pandas功能。您也可以将此用作备忘单。</h2></div><h1 id="e316" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">什么是时间序列分析？</h1><p id="a1a1" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">正是对数据集的分析才有了一系列时间戳。随着对机器学习的日益重视，它变得越来越重要。现在，许多不同类型的行业使用时间序列数据进行时间序列预测、季节性分析、发现趋势以及做出重要的商业和研究决策。所以作为数据科学家或数据分析师，清楚地理解时间序列数据是非常重要的。</p><blockquote class="mm mn mo"><p id="47a5" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">时间序列数据用于:</em></p></blockquote><p id="da04" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">银行和金融机构</p><p id="7c0c" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">股票市场</p><p id="a002" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">社会化媒体</p><p id="368b" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">电力、天然气和石油工业</p><p id="33c0" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">机械或化学过程中的周期性措施</p><p id="3f61" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">以及更多的领域</p><p id="1313" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">这是不可避免的。所以，我们来学学吧。</p><p id="022b" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我将从一些通用函数开始，并使用<strong class="ls jk">脸书股票价格数据集</strong>展示更多主题。</p><p id="4634" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">让我们开始吧！</p><h1 id="b9ad" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">使用正确的格式</h1><p id="2b5f" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">时间序列数据可以有多种不同的格式。但并非所有这些格式都对python的熊猫库友好。最方便的格式是熊猫的时间戳格式。但是大多数时候时间序列数据都是字符串格式的。这里我有一个不同格式的时间序列数据的例子。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="9700" class="nh kz jj nd b gy ni nj l nk nl">import pandas as pd<br/>import numpy as np</span><span id="2537" class="nh kz jj nd b gy nm nj l nk nl">dates = ['2020-11-25 2:30:00 PM', 'Jan 5, 2020 18:45:00', '01/11/2020', '2020.01.11', '2020/01/11', '20201105']</span></pre><p id="5ffe" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">上面的“日期”变量显示了五种不同格式的日期时间设置，并且都是正确的。但是我们需要这种特定的格式来方便地工作。因此，将这些日期转换成正确的格式。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="656c" class="nh kz jj nd b gy ni nj l nk nl">pd.to_datetime(dates)</span></pre><p id="202c" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="ce75" class="nh kz jj nd b gy ni nj l nk nl">DatetimeIndex(['2020-11-25 14:30:00', '2020-01-05 18:45:00',<br/>               '2020-01-11 00:00:00', '2020-01-11 00:00:00',<br/>               '2020-01-11 00:00:00', '2020-11-05 00:00:00'],<br/>              dtype='datetime64[ns]', freq=None)</span></pre><p id="e68a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">世界上还有其他国家，他们首先使用天数。例如，在美式英语中，2002年6月1日被写成“2020年6月1日”。但是在英国，像印度、孟加拉国、巴基斯坦和世界其他一些地方的南亚国家把它写成“1/6/2020”。</p><p id="c951" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">如果你为来自世界其他地方的客户工作，以下是如何格式化日期。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="b31b" class="nh kz jj nd b gy ni nj l nk nl">pd.to_datetime(dates).strftime('%d-%m-%y')</span></pre><p id="8b1b" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="5602" class="nh kz jj nd b gy ni nj l nk nl">Index(['25-11-20', '05-01-20', '11-01-20', '11-01-20', '11-01-20', '05-11-20'], dtype='object')</span></pre><p id="4916" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我只是在这里使用了“%d-%m-%y”作为格式。您可以根据需要更改顺序。</p><blockquote class="mm mn mo"><p id="a760" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">如果需要先放月或者先放年，只需要改变格式中的顺序即可。</em></p></blockquote><p id="a9ab" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">现在，我将导入数据集，我们将使用该数据集来演示许多函数。我们的脸书股票数据。请随意在此下载数据集并跟随:</p><div class="is it gp gr iu nn"><a href="https://github.com/rashida048/Datasets/blob/master/FB_data.csv" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd jk gy z fp ns fr fs nt fu fw ji bi translated">master rashida048/Datasets上的Datasets/FB_data.csv</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">在GitHub上创建一个帐户，为rashida048/Datasets开发做出贡献。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ja nn"/></div></div></a></div><p id="e3a2" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">你学习的唯一方法是通过实践。</p><blockquote class="mm mn mo"><p id="c9bf" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated">如果你读这篇文章是为了学习，我强烈建议你边读边练。</p></blockquote><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="77da" class="nh kz jj nd b gy ni nj l nk nl">df = pd.read_csv('FB_data.csv')<br/>df.head()</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/f138eb685df94c90cef722f5086eceaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*ZoTYoS56vYnWbIdu.png"/></div></figure><p id="9123" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">这是一个原始数据集。看起来不坏！井井有条。但是我们需要像前面讨论的那样改变“日期”列的格式。我们将把它做成DatetimeIndex格式，并把它作为索引列。</p><p id="25e1" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">因为当“日期”列是索引列时，我们将能够非常容易地对其进行重新采样。您将在后面的章节中看到这意味着什么。</p><p id="22bf" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">这是导入数据的正确方法，我在导入时更改了日期的格式并将其设置为索引。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="bc8a" class="nh kz jj nd b gy ni nj l nk nl">df = pd.read_csv('FB_data.csv', parse_dates=['Date'], index_col="Date")<br/>df.head()</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/f394fc29fef3f12c8f5282c6a59f9bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/0*8t5DqF2p7n9_cgmC.png"/></div></figure><p id="213b" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">看，我们改变了“日期”栏的格式！</p><h1 id="a9fe" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">重采样</h1><p id="a43f" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在这一节中，我将讨论如何对数据进行重采样。</p><blockquote class="mm mn mo"><p id="0dcd" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">为什么重采样很重要？</em></p></blockquote><p id="121f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">因为我们并不总是需要庞大数据集中的所有数据。例如，我们可能只需要2019年6月的数据。如果您的日期格式是DatetimeIndex，那就非常简单了:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="c1b2" class="nh kz jj nd b gy ni nj l nk nl">df["2019-06"]</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/ee086212587dec06ea77a72de99d4639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/0*6pQAcIVhB-jhJQ_p.png"/></div></figure><p id="d7d9" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我们只有八天的数据。求2019年6月开盘价均值。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="585e" class="nh kz jj nd b gy ni nj l nk nl">df["2019-06"].Open.mean()</span></pre><p id="9820" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="1845" class="nh kz jj nd b gy ni nj l nk nl">190.71000014285715</span></pre><p id="b72c" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我们也可以得到单个日期的数据。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="4fe6" class="nh kz jj nd b gy ni nj l nk nl">df.loc["2019-06-21"]</span></pre><p id="8232" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="c771" class="nh kz jj nd b gy ni nj l nk nl">Open         1.887500e+02<br/>High         1.920000e+02<br/>Low          1.887500e+02<br/>Close        1.911400e+02<br/>Adj Close    1.911400e+02<br/>Volume       2.275120e+07<br/>Name: 2019-06-21 00:00:00, dtype: float64</span></pre><p id="e0d3" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">比方说，我们需要2019年6月27日到7月10日两个星期的数据。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="437d" class="nh kz jj nd b gy ni nj l nk nl">df.loc["2019-06-27": "2019-07-10"</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/cd50ec847a946d86d064c2358874613e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/0*4ie9mTcOC-nP5IET.png"/></div></figure><p id="e595" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">你也可以按月重新取样。这给出了月平均值。例如，这里我将获得月平均收盘数据:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="d09f" class="nh kz jj nd b gy ni nj l nk nl">df.Close.resample('M').mean()</span></pre><p id="2ae3" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="56aa" class="nh kz jj nd b gy ni nj l nk nl">Date<br/>2019-06-30    190.324286<br/>2019-07-31    199.595454<br/>2019-08-31    184.497726<br/>2019-09-30    185.735000<br/>2019-10-31    184.383912<br/>2019-11-30    195.718500<br/>2019-12-31    201.951904<br/>2020-01-31    216.643333<br/>2020-02-29    207.505263<br/>2020-03-31    165.747727<br/>2020-04-30    177.003335<br/>2020-05-31    216.549001<br/>2020-06-30    232.671332<br/>Freq: M, Name: Close, dtype: float64</span></pre><p id="908a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我们可以用一行代码计算月平均值并绘图:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="eca6" class="nh kz jj nd b gy ni nj l nk nl">df.Close.resample('M').mean().plot()</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/dd25f9af8b34464d12cb2daa97f8cf31.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/0*6UoWSZCQq1XlxL8Y.png"/></div></figure><p id="0002" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">如果您想要周数据并绘制它，您可以通过以下代码获得它:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="da97" class="nh kz jj nd b gy ni nj l nk nl">df.Close.resample('W').mean().plot()</span></pre><blockquote class="mm mn mo"><p id="438a" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">使用plot()函数中的“kind”参数，您可以获得总共13种类型的图，而不是简单的线形图。</em></p></blockquote><p id="911f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我用这个柱状图命名了这13种类型的图。</p><p id="b6c3" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我将绘制季度结算数据的柱状图。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="050c" class="nh kz jj nd b gy ni nj l nk nl">df.Close.resample('Q').mean().plot(kind='bar')</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/97e0aed33f56ec29204ebbea1fccf3aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/0*cgpSJr1-TuSB0nv1.png"/></div></figure><p id="b224" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">上面的“种类”参数采用以下13种可视化类型:</p><ol class=""><li id="6dcd" class="oi oj jj ls b lt mq lw mr lz ok md ol mh om ml on oo op oq bi translated">线条</li><li id="8775" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">区域</li><li id="31bc" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">酒吧</li><li id="edab" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">barh</li><li id="fb5a" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">馅饼</li><li id="e644" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">箱子</li><li id="2bcc" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">赫克宾</li><li id="17b0" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">嘘</li><li id="f79a" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">kde</li><li id="c6ae" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">密度</li><li id="58fa" class="oi oj jj ls b lt or lw os lz ot md ou mh ov ml on oo op oq bi translated">分散</li></ol><h1 id="0547" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">变化</h1><p id="3edc" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">听起来，shift函数将数据移动指定的次数。我们正在使用的FB数据集从2019年6月20日开始。现在，如果我们将数据移动1，2019年6月20日的数据将移动到2019年6月21日，2019年6月21日的数据将移动到2019年6月22日，依此类推。</p><blockquote class="mm mn mo"><p id="f4eb" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">我稍后会解释为什么人们使用shift </em></p></blockquote><p id="5697" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">对于这个例子，我将只使用列。你会非常清楚地看到变化。我将创建一个名为“df1”的新数据帧，只包含开放数据。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="47cd" class="nh kz jj nd b gy ni nj l nk nl">df1 = pd.DataFrame(df['Open'])<br/>df1.head()</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/dc9e276e868c99fb5aa263e7b7dd667d.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/0*UcY8MB-vLPJvkfjk.png"/></div></figure><p id="b778" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">将该数据移动1。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="99bd" class="nh kz jj nd b gy ni nj l nk nl">df1.shift(1)</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/bfafc8ee9be5ae810af3106a0b8b612e.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/0*Yaed5WCS_Yi5WM1z.png"/></div></div></figure><p id="aa3f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">第一行的值为空。仅仅是因为第一行移到了第二行。但是第一行之前没有数据。</p><p id="7563" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">如果你在shift中使用了一个负值，结果正好相反。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="5524" class="nh kz jj nd b gy ni nj l nk nl">df1.shift(-1)</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/362a00d60a29d3dc3190c05c0c0ea869.png" data-original-src="https://miro.medium.com/v2/resize:fit:326/format:webp/0*qN6i4aJDRSufb2eS.png"/></div></figure><blockquote class="mm mn mo"><p id="024d" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">我们为什么要使用shift？</em></p></blockquote><p id="7783" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">班次给你前一天的数据或者第二天的数据。这是一个使用案例。我将使用shift将今天的数据和前一天的数据并排放置。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="fdaf" class="nh kz jj nd b gy ni nj l nk nl">df1['Prev Day Opening'] = df1['Open'].shift(1)<br/>df1</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/c21fc9e520913b7a61ada2358c86cc47.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/0*QyKGA8dp0Qdve9zD.png"/></div></figure><p id="c226" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">有用吗！？</p><p id="b1f6" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">您还可以在另一列中获得1天数据的变化:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="a601" class="nh kz jj nd b gy ni nj l nk nl">df1['1 day change'] = df1['Open'] - df1['Prev Day Opening']</span></pre><p id="f490" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">以百分比计算1周的总数。为此，我们必须推迟5天。对吗？然后取今天和5天前数据的差值。乘以100，然后除以今天的原始数据。让我们来看看，以便更好地理解它。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="bcd3" class="nh kz jj nd b gy ni nj l nk nl">df1['One week total return'] = (df1['Open'] - df1['Open'].shift(5)) * 100/df1['Open'].shift(5)<br/>df1.tail()</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/d32da29fbe516d2f10dbc38e28786739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/0*oX7rqRSTwzM-hzjW.png"/></div></figure><p id="5dda" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我要用df.tail()，因为我们上了5天的班。所以前5行将为空。</p><h1 id="5ce2" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">时区</h1><p id="e0a2" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">理解时区很重要。很可能，你在一个时区，而你的客户在另一个时区。熊猫有很强的适应不同时区的功能。</p><p id="439a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我们有两种类型的日期时间数据。<strong class="ls jk">不知道时区的简单日期时间</strong>和知道时区的<strong class="ls jk">时区感知日期时间</strong>。我们拥有的数据是朴素的日期时间。所以，我们需要使用tz_localize来转换这个DateTime。</p><p id="7da5" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">将脸书数据集的索引转换为“美国/东部”。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="a525" class="nh kz jj nd b gy ni nj l nk nl">df.index = df.index.tz_localize(tz = 'US/Eastern')<br/>df.index</span></pre><p id="ab59" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="34b9" class="nh kz jj nd b gy ni nj l nk nl">DatetimeIndex(['2019-06-20 00:00:00-04:00', '2019-06-21 00:00:00-04:00', '2019-06-24 00:00:00-04:00', '2019-06-25 00:00:00-04:00', '2019-06-26 00:00:00-04:00', '2019-06-27 00:00:00-04:00', '2019-06-28 00:00:00-04:00', '2019-07-01 00:00:00-04:00', '2019-07-02 00:00:00-04:00', '2019-07-03 00:00:00-04:00',<br/>               ...<br/>               '2020-06-08 00:00:00-04:00', '2020-06-09 00:00:00-04:00', '2020-06-10 00:00:00-04:00', '2020-06-11 00:00:00-04:00', '2020-06-12 00:00:00-04:00', '2020-06-15 00:00:00-04:00', '2020-06-16 00:00:00-04:00', '2020-06-17 00:00:00-04:00', '2020-06-18 00:00:00-04:00', '2020-06-19 00:00:00-04:00'], dtype='datetime64[ns, US/Eastern]', name='Date', length=253, freq=None)</span></pre><p id="944a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">在每个日期，它显示负4小时。同样，如果我们将其转换为“欧洲/柏林”,它将增加6个小时。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="788e" class="nh kz jj nd b gy ni nj l nk nl">df = df.tz_convert('Europe/Berlin')<br/>df.index</span></pre><p id="17b9" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="c084" class="nh kz jj nd b gy ni nj l nk nl">DatetimeIndex(['2019-06-20 06:00:00+02:00', '2019-06-21 06:00:00+02:00', '2019-06-24 06:00:00+02:00', '2019-06-25 06:00:00+02:00', '2019-06-26 06:00:00+02:00', '2019-06-27 06:00:00+02:00', '2019-06-28 06:00:00+02:00', '2019-07-01 06:00:00+02:00', '2019-07-02 06:00:00+02:00', '2019-07-03 06:00:00+02:00',<br/>               ...<br/>               '2020-06-08 06:00:00+02:00', '2020-06-09 06:00:00+02:00', '2020-06-10 06:00:00+02:00', '2020-06-11 06:00:00+02:00', '2020-06-12 06:00:00+02:00', '2020-06-15 06:00:00+02:00', '2020-06-16 06:00:00+02:00', '2020-06-17 06:00:00+02:00', '2020-06-18 06:00:00+02:00', '2020-06-19 06:00:00+02:00'], dtype='datetime64[ns, Europe/Berlin]', name='Date', length=253, freq=None)</span></pre><p id="1725" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">您可以找到世界上所有可用的时区，并以这种方式使用适合您的时区:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="3050" class="nh kz jj nd b gy ni nj l nk nl">from pytz import all_timezones<br/>print(all_timezones)</span></pre><p id="d946" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">这是输出的一部分。满输出太大:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="e3b8" class="nh kz jj nd b gy ni nj l nk nl">['Africa/Abidjan', 'Africa/Accra', 'Africa/Addis_Ababa', 'Africa/Algiers', 'Africa/Asmara', 'Africa/Asmera', 'Africa/Bamako', 'Africa/Bangui', 'Africa/Banjul', 'Africa/Bissau', 'Africa/Blantyre', 'Africa/Brazzaville', 'Africa/Bujumbura', 'Africa/Cairo',.....</span></pre><h1 id="5bbd" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">如何生成缺失日期</h1><p id="7c6c" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">如果您有数据并且知道时间段，但是时间没有记录在数据集中，该怎么办？或者你有去年第二季度的数据，但没有今年的数据。而你今年需要用去年的数据。</p><p id="4a4b" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">在许多情况下，您可能需要生成一系列日期。熊猫<strong class="ls jk"> date_range </strong>功能就派上用场了。让我们生成一个10天的时间段:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="5e9e" class="nh kz jj nd b gy ni nj l nk nl">rng = pd.date_range(start='11/1/2020', periods=10)<br/>rng</span></pre><p id="aee5" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="a923" class="nh kz jj nd b gy ni nj l nk nl">DatetimeIndex(['2020-11-01', '2020-11-02', '2020-11-03', '2020-11-04', '2020-11-05', '2020-11-06', '2020-11-07', '2020-11-08', '2020-11-09', '2020-11-10'], dtype='datetime64[ns]', freq='D')</span></pre><blockquote class="mm mn mo"><p id="fe50" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><strong class="ls jk"> <em class="jj">如果我只需要工作日怎么办？</em>T9】</strong></p></blockquote><p id="72da" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我只需要添加一个称为频率的额外参数，如下所示:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="e15d" class="nh kz jj nd b gy ni nj l nk nl">rng = pd.date_range(start='11/1/2020', periods=10, freq='B')<br/>rng</span></pre><p id="6b67" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="98e9" class="nh kz jj nd b gy ni nj l nk nl">DatetimeIndex(['2020-11-02', '2020-11-03', '2020-11-04', '2020-11-05', '2020-11-06', '2020-11-09', '2020-11-10', '2020-11-11', '2020-11-12', '2020-11-13'], dtype='datetime64[ns]', freq='B')</span></pre><p id="8b17" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">还有几个类似的选项和频率。请查看这篇文章，我只详细解释了date_range函数:</p><div class="is it gp gr iu nn"><a rel="noopener follow" target="_blank" href="/pandas-date-range-function-details-fc1bd91b80a0"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd jk gy z fp ns fr fs nt fu fw ji bi translated">熊猫日期范围函数详细信息</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">考虑不同条件生成一系列日期</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="pb l ny nz oa nw ob ja nn"/></div></div></a></div><p id="b359" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">因此，我们可以生成一系列日期，并将它们添加到我们的数据集中！</p><h1 id="75f4" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">旋转</h1><p id="bf94" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">rolling函数聚合指定日期时间数的数据。这里我将取每三天的平均值。在完成这个例子后，我将进一步解释:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="86cc" class="nh kz jj nd b gy ni nj l nk nl">df[["High"]].rolling(3).mean()[:10]</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/e266d5a2499f69dccb3c47abfb9b0dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/0*fAEJQiB-Iocx-g8R.png"/></div></figure><p id="5d9f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">这里到底发生了什么？我在滚动函数中传递了3作为参数，而聚合函数是mean。因此，它取6月20日、21日和24日“高”数据的平均值，放在24日。对第21、24和25个数据进行同样的操作，并放在第25个数据上，以此类推。很多时候，我们使用周平均值或三天平均值来做决定。</p><p id="61ae" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">您还可以选择放置滚动数据的位置。这里有一个例子:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="6652" class="nh kz jj nd b gy ni nj l nk nl">data_rol = df[['High', 'Low']].rolling(window = 7, center = True).mean()<br/>data_rol</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/2e928c5ccff3067ed5e55b36c07b0117.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/0*IKVwJ6tfsZYwPt3s.png"/></div></figure><p id="e36a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">在这个滚动函数中，我传递了window = 7。这意味着需要7天的平均时间。center = True表示将平均值放在第4行而不是第7行。这就是为什么它的底部也有一些空值。</p><p id="d7cc" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">让我们在同一个图中绘制原始“高”数据和7天累计“高”数据:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="b193" class="nh kz jj nd b gy ni nj l nk nl">%matplotlib inline<br/>import matplotlib.ticker as ticker <br/>fig, ax = plt.subplots(figsize= (11, 4))<br/>ax.plot(df['High'], marker = '.', markersize=4, color='0.4', linestyle='None', label='Daily')<br/>ax.xaxis.set_major_locator(ticker.MultipleLocator(30))<br/>ax.plot(data_rol['High'], linewidth=2, label='7-d rolling mean')<br/>ax.set_xlabel('Month')</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/7020944da7a5b5363001e75cbe10d713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/0*zM7BQ4oNBTgJ7KgF.png"/></div></figure><blockquote class="mm mn mo"><p id="c996" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">通常，这种类型的图用于观察数据中的任何趋势</em></p></blockquote><p id="b112" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">在我们的数据中，有一个趋势是可以观察到的。2020年1月后，价值开始下降，曲线变得陡峭。在时间序列分析中，我们有时会努力寻找趋势。但有时我们需要从数据中剔除趋势。尤其是当我们需要使用时间序列数据进行机器学习或预测时。</p><p id="eed4" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">再次行军后，它有一个陡峭的上升。在下一节，我将告诉你如何摆脱这种趋势。</p><h1 id="67b3" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">消除趋势的差异</h1><p id="8536" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">如果数据中有任何趋势，这对于建模、预测或观察季节性都是不利的。为了提高模型性能，或者观察数据中的任何季节性或任何噪声，差分是一种常见的做法。它采用指定天数的数据差异。这里有一个例子:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="2245" class="nh kz jj nd b gy ni nj l nk nl">df_first_order_diff = df[['High', 'Low']].diff()<br/>df_first_order_diff</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/146478891207386aadc7e26e164217b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/0*F8fMEw0z6qFoY__P.png"/></div></figure><p id="c2fc" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">在这里，我没有指定。diff()函数。因此，默认情况下，只需要1天的差异。</p><p id="2fa4" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">您看到结果表中发生了什么吗？“高”和“低”数据是“20–06–19”是21–06–19和20–06–19的“高”和“低”数据的差值。故事发生在2019年6月21日。这就是为什么它在20–06–19中为空。因为在那之前没有数据可以减去。</p><p id="bb86" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">这种差异过程被认为可以消除这种趋势。万一没有，尝试3天差异或7天差异。这是如何进行3天的差异:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="f23e" class="nh kz jj nd b gy ni nj l nk nl">df[['High', 'Low']].diff(3)</span></pre><p id="511c" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">让我们绘制上面一阶差分的数据，看看我们在上一节观察到的趋势是否已经消除。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="c8ac" class="nh kz jj nd b gy ni nj l nk nl">start = '20-06-19'fig, ax = plt.subplots(figsize = (11, 4))<br/>ax.plot(df_first_order_diff.loc[start:, "High"], marker = 'o', <br/>        markersize = 4, linestyle = '-', label = 'First Order Differencing')<br/>ax.xaxis.set_major_locator(ticker.MultipleLocator(30))</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/841300a5ec7faa6855c962a0fa65b0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/0*vrCzqCgWD7yVfrq1.png"/></div></figure><p id="0a5c" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">看那明显的趋势没了！如果你能在最后摆脱这种轻微的趋势，请随意检查我之前提到的3天差异。</p><h1 id="c075" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">重要时间特征提取</h1><p id="1242" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">您可以从时间序列中提取非常有用的年、月、周或工作日。让我们从索引列“Date”中提取年份开始。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="df3b" class="nh kz jj nd b gy ni nj l nk nl">pd.DatetimeIndex(df.index).year</span></pre><p id="50c1" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="afe9" class="nh kz jj nd b gy ni nj l nk nl">Int64Index([2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019,<br/>            ...<br/>            2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020], dtype='int64', name='Date', length=253)</span></pre><p id="aac3" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">现在，选取数据集的一个子集使其变小，并在单独的列中添加年份。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="7c4e" class="nh kz jj nd b gy ni nj l nk nl">df3 = df[['High','Low', 'Volume']]<br/>df3['Year'] = pd.DatetimeIndex(df3.index).year<br/>df3</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/91487b24f80e0ca8e00f65ed4f883392.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/0*AgQ72H5vTtGKV_sd.png"/></div></figure><p id="c964" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">看到我们在最后加上了年份。同样，您可以提取月份和工作日。下面是代码:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="3a0a" class="nh kz jj nd b gy ni nj l nk nl">pd.DatetimeIndex(df3.index).month</span></pre><p id="a230" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="6913" class="nh kz jj nd b gy ni nj l nk nl">Int64Index([6, 6, 6, 6, 6, 6, 6, 7, 7, 7,<br/>            ...<br/>            6, 6, 6, 6, 6, 6, 6, 6, 6, 6], dtype='int64', name='Date', length=253)</span></pre><p id="4d1d" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">以下是提取工作日的方法:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="2fef" class="nh kz jj nd b gy ni nj l nk nl">pd.DatetimeIndex(df3.index).weekday</span></pre><p id="de2e" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="9ab8" class="nh kz jj nd b gy ni nj l nk nl">Int64Index([3, 4, 0, 1, 2, 3, 4, 0, 1, 2,<br/>            ...<br/>            0, 1, 2, 3, 4, 0, 1, 2, 3, 4], dtype='int64', name='Date', length=253)</span></pre><p id="d3e9" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">工作日出来就是数字。如果您需要周日、周一等工作日格式，该怎么办？那会更有用！</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="93fc" class="nh kz jj nd b gy ni nj l nk nl">df3['Weekday'] = pd.DatetimeIndex(df3.index).to_series().dt.day_name()<br/>df3.head()</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/b64cca830f3b2d6b4646596c0553c63a.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/0*lEkJBBi2JaVgqsQl.png"/></div></figure><p id="8679" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">让我们检查工作日是否对“高”、“低”和“量”数据有任何影响。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="e41b" class="nh kz jj nd b gy ni nj l nk nl">import seaborn as sns<br/>fig, axes = plt.subplots(3, 1,figsize=(11, 10), sharex=True)</span><span id="219d" class="nh kz jj nd b gy nm nj l nk nl">for name, ax in zip(['High', 'Low', 'Volume'], axes):<br/>    sns.boxplot(data=df3, x = 'Weekday', y = name, ax=ax)<br/>    ax.set_title(name)</span></pre><figure class="my mz na nb gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/2e246e0dee747c2f775cba455628c620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/0*8cGqxiGQapylxnDC.png"/></div></figure><p id="2e15" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">工作日对这些数据有影响，对吗？周三的“高”、“低”和“量”都在上涨。周一情况正好相反。箱线图在一个包中给出了很多信息。如果您需要复习如何从箱线图中提取所有数据，这里有一篇详细的文章:</p><div class="is it gp gr iu nn"><a rel="noopener follow" target="_blank" href="/understanding-the-data-using-histogram-and-boxplot-with-example-425a52b5b8a6"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd jk gy z fp ns fr fs nt fu fw ji bi translated">使用直方图和箱线图理解数据，并举例说明</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">了解如何从直方图和箱线图中提取最多的信息。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="pk l ny nz oa nw ob ja nn"/></div></div></a></div><h1 id="4b58" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">周期和周期指数</h1><p id="4c05" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">另一个重要的python函数。我们将通过实践来学习。使用周期函数的最基本方法是:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="d0fc" class="nh kz jj nd b gy ni nj l nk nl">y = pd.Period('2020')<br/>y</span></pre><p id="4086" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="d741" class="nh kz jj nd b gy ni nj l nk nl">Period('2020', 'A-DEC')</span></pre><p id="fd5f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">此输出表明，这一时期' 2020年'将于12月结束。有道理，对吧？</p><p id="56a5" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">以下是可从周期函数中提取的所有信息的目录:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="c45c" class="nh kz jj nd b gy ni nj l nk nl">dir(y)</span></pre><p id="5598" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">这是输出的一部分。因为目录大！</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="fe76" class="nh kz jj nd b gy ni nj l nk nl">.<br/>.<br/>.<br/>.<br/>.<br/>'asfreq',<br/> 'day',<br/> 'dayofweek',<br/> 'dayofyear',<br/> 'days_in_month',<br/> 'daysinmonth',<br/> 'end_time',<br/> 'freq',<br/> 'freqstr',<br/> 'hour',<br/> 'is_leap_year',<br/> 'minute',<br/> 'month',<br/> 'now',<br/> 'ordinal',<br/> 'quarter',<br/> 'qyear',<br/> 'second',<br/> 'start_time',<br/> 'strftime',<br/> 'to_timestamp',<br/> 'week',<br/> 'weekday',<br/> 'weekofyear',<br/> 'year']</span></pre><blockquote class="mm mn mo"><p id="3974" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated">我将展示其中的一些。</p></blockquote><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="28ae" class="nh kz jj nd b gy ni nj l nk nl">y.start_time</span></pre><p id="24d6" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="9ea5" class="nh kz jj nd b gy ni nj l nk nl">Timestamp('2020-01-01 00:00:00')</span></pre><p id="2e43" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输入:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="675d" class="nh kz jj nd b gy ni nj l nk nl">y.end_time</span></pre><p id="ad44" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="5c14" class="nh kz jj nd b gy ni nj l nk nl">Timestamp('2020-12-31 23:59:59.999999999')</span></pre><p id="2667" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">如果我们使用频率作为月份:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="7b2c" class="nh kz jj nd b gy ni nj l nk nl">month = pd.Period('2020-2', freq="M") <br/>month</span></pre><p id="eb1d" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="79f5" class="nh kz jj nd b gy ni nj l nk nl">Period('2020-02', 'M')</span></pre><p id="604a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输入:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="1368" class="nh kz jj nd b gy ni nj l nk nl">month.start_time</span></pre><p id="8f8e" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="3009" class="nh kz jj nd b gy ni nj l nk nl">Timestamp('2020-02-01 00:00:00')</span></pre><p id="05c9" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输入:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="0bf8" class="nh kz jj nd b gy ni nj l nk nl">month.end_time</span></pre><p id="004d" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="4ad3" class="nh kz jj nd b gy ni nj l nk nl">Timestamp('2020-02-29 23:59:59.999999999')</span></pre><blockquote class="mm mn mo"><p id="b5ed" class="lq lr mp ls b lt mq kk lv lw mr kn ly ms mt mb mc mu mv mf mg mw mx mj mk ml im bi translated"><em class="jj">我们可以用这种类型的月数据做什么？</em></p></blockquote><p id="1a6f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">必要的话可以加减。例如，如果您有学生的年龄数据，并且需要更新年份或月份，您可以这样做:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="87ba" class="nh kz jj nd b gy ni nj l nk nl">month + 2</span></pre><p id="fb6f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="04c4" class="nh kz jj nd b gy ni nj l nk nl">Period('2020-04', 'M')</span></pre><p id="6894" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">同样的，你可以增加或减少天数。如果我们输入一个日期，默认情况下它会将频率作为日期。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="73a5" class="nh kz jj nd b gy ni nj l nk nl">d = pd.Period('2020-02-28')<br/>d</span></pre><p id="6733" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="ee9f" class="nh kz jj nd b gy ni nj l nk nl">Period('2020-02-28', 'D')</span></pre><p id="3d19" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">如果你增加一两天，它就会增加一两天。但是我这里写的日期是2月28日。这是不同的，对不对？闰年的二月有29天，其他年份的二月有28天。</p><p id="0975" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">让我们在上面的日期d的基础上增加两天:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="2b3b" class="nh kz jj nd b gy ni nj l nk nl">d + 2</span></pre><p id="f237" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="83a5" class="nh kz jj nd b gy ni nj l nk nl">Period('2020-03-01', 'D')</span></pre><p id="9a0a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">2月28日加2天，就得到3月1日。这意味着周期函数知道闰年。</p><p id="3358" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">同样，你可以添加年、小时、分钟甚至季度。</p><p id="58c4" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">让我们来看一个25美分硬币的例子:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="0b19" class="nh kz jj nd b gy ni nj l nk nl">q = pd.Period('2020Q1')<br/>q</span></pre><p id="39c0" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="e279" class="nh kz jj nd b gy ni nj l nk nl">Period('2020Q1', 'Q-DEC')</span></pre><p id="5c66" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">检查q的开始和结束月份。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="7692" class="nh kz jj nd b gy ni nj l nk nl">q.asfreq('M', how='start')</span></pre><p id="f55a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="b483" class="nh kz jj nd b gy ni nj l nk nl">Period('2020-01', 'M')</span></pre><p id="0bf3" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">2020Q1的第一个月是一月。这意味着默认情况下第一季度从一月份开始。检查什么时候结束。虽然我们知道它应该在三月结束。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="13ed" class="nh kz jj nd b gy ni nj l nk nl">q.asfreq('M', how='end')</span></pre><p id="a960" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="aedd" class="nh kz jj nd b gy ni nj l nk nl">Period('2020-03', 'M')</span></pre><p id="9cec" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">q期始于一月，止于三月。任何地方的商业年度都不是从一月开始到三月结束。一会儿我会再谈一谈。</p><p id="74db" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">在q上加1:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="b625" class="nh kz jj nd b gy ni nj l nk nl">q + 1</span></pre><p id="94b7" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="834d" class="nh kz jj nd b gy ni nj l nk nl">Period('2020Q2', 'Q-DEC')</span></pre><p id="8274" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">在这里，“Q-DEC”表示该季度在12月结束。一年有四个季度，最后一个季度在12月结束。但是有几个行业将一月作为第四季度末，或者将六月作为第四季度末。</p><p id="7595" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">我们可以使用“频率”参数来指定季度末。在下一个例子中，我将使用第四季度末作为一月份。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="2196" class="nh kz jj nd b gy ni nj l nk nl">q1 = pd.Period('2020Q2', freq = 'Q-Jan')<br/>q1</span></pre><p id="2d6c" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="9a9d" class="nh kz jj nd b gy ni nj l nk nl">Period('2020Q2', 'Q-JAN')</span></pre><p id="b389" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">看，这里我们把第四季度末改成了一月份！请随意查看第一季度的开始和结束月份。你会看到开始的月份是三月而不是四月。因为第一季度是从二月到四月。</p><p id="f195" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">按照我们之前生成date_range的方式，我们也可以生成期间范围:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="9e03" class="nh kz jj nd b gy ni nj l nk nl">idx = pd.period_range('2017', '2020', freq = 'Q')<br/>idx</span></pre><p id="fabf" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="cf25" class="nh kz jj nd b gy ni nj l nk nl">PeriodIndex(['2017Q1', '2017Q2', '2017Q3', '2017Q4', '2018Q1', '2018Q2', '2018Q3', '2018Q4', '2019Q1', '2019Q2', '2019Q3', '2019Q4', '2020Q1'], dtype='period[Q-DEC]', freq='Q-DEC')</span></pre><p id="6310" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">默认情况下，从“2017Q1”开始。因为默认情况下，季度从一月开始，到十二月结束。但与之前一样，如果我们在1月份指定季度末，它将从2017年第四季度开始。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="dadb" class="nh kz jj nd b gy ni nj l nk nl">idx = pd.period_range('2017', '2020', freq = 'Q-Jan')<br/>idx</span></pre><p id="320a" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="272c" class="nh kz jj nd b gy ni nj l nk nl">PeriodIndex(['2017Q4', '2018Q1', '2018Q2', '2018Q3', '2018Q4', '2019Q1', '2019Q2', '2019Q3', '2019Q4', '2020Q1', '2020Q2', '2020Q3', '2020Q4'], dtype='period[Q-JAN]', freq='Q-JAN')</span></pre><p id="a309" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">您可以将这些季度转换为时间戳:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="e9fa" class="nh kz jj nd b gy ni nj l nk nl">idx = idx.to_timestamp()<br/>idx</span></pre><p id="d4cc" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="b184" class="nh kz jj nd b gy ni nj l nk nl">DatetimeIndex(['2016-11-01', '2017-02-01', '2017-05-01', '2017-08-01', '2017-11-01', '2018-02-01', '2018-05-01', '2018-08-01', '2018-11-01', '2019-02-01', '2019-05-01', '2019-08-01', '2019-11-01'], dtype='datetime64[ns]', freq='QS-NOV')</span></pre><p id="c03f" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">同样，当我们有时间戳时，我们可以使用to_period()将其转换为季度。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="cfcb" class="nh kz jj nd b gy ni nj l nk nl">idx.to_period()</span></pre><p id="90a7" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">输出:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="1dc3" class="nh kz jj nd b gy ni nj l nk nl">PeriodIndex(['2016Q4', '2017Q1', '2017Q2', '2017Q3', '2017Q4', '2018Q1', '2018Q2', '2018Q3', '2018Q4', '2019Q1', '2019Q2', '2019Q3', '2019Q4'], dtype='period[Q-DEC]', freq='Q-DEC')</span></pre><p id="a2d2" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">恭喜你！您现在刚刚学会了对任何数据集执行时间序列分析！</p><h1 id="5d1e" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">结论</h1><p id="583a" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我试图记录和解释大部分大熊猫的功能，用于时间序列分析。学习完这一整页后，您应该有足够的知识对任何时间序列数据执行有效的时间序列分析。但是请记住，要熟练使用所有这些功能需要大量的练习！编码快乐！</p><p id="5036" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">欢迎在推特上关注我，喜欢我的T2脸书页面。</p><p id="d6e7" class="pw-post-body-paragraph lq lr jj ls b lt mq kk lv lw mr kn ly lz mt mb mc md mv mf mg mh mx mj mk ml im bi translated">更多阅读:</p><div class="is it gp gr iu nn"><a rel="noopener follow" target="_blank" href="/series-of-projects-on-data-science-and-data-analytics-in-both-python-and-r-76db3fea9b7e"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd jk gy z fp ns fr fs nt fu fw ji bi translated">Python和R语言的数据科学和数据分析系列项目</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">探索性数据分析、机器学习、自然语言处理和计算机视觉项目</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="pl l ny nz oa nw ob ja nn"/></div></div></a></div><div class="is it gp gr iu nn"><a rel="noopener follow" target="_blank" href="/an-overview-of-performance-evaluation-metrics-of-machine-learning-classification-algorithms-7a95783a762f"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd jk gy z fp ns fr fs nt fu fw ji bi translated">机器学习(分类)算法性能评价指标综述</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">开发一个分类模型和计算所有流行的性能评估指标使用…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="pm l ny nz oa nw ob ja nn"/></div></div></a></div><div class="is it gp gr iu nn"><a rel="noopener follow" target="_blank" href="/four-popular-feature-selection-methods-for-efficient-machine-learning-in-python-fdd34762efdb"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd jk gy z fp ns fr fs nt fu fw ji bi translated">Python中高效机器学习的四种流行特征选择方法</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">使用真实数据集执行特征选择方法，并在每个方法后检索所选特征</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="pn l ny nz oa nw ob ja nn"/></div></div></a></div></div></div>    
</body>
</html>