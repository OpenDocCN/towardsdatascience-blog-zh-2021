<html>
<head>
<title>TensorFlow for Computer Vision — How to Train Image Classifier with Artificial Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉的张量流——如何用人工神经网络训练图像分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tensorflow-for-computer-vision-how-to-train-image-classifier-with-artificial-neural-networks-304bc82f3dd?source=collection_archive---------10-----------------------#2021-11-09">https://towardsdatascience.com/tensorflow-for-computer-vision-how-to-train-image-classifier-with-artificial-neural-networks-304bc82f3dd?source=collection_archive---------10-----------------------#2021-11-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="59f1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">没有卷积的图像分类？这就是为什么这是个坏主意</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fd626a62645fa9faa5afc4c8c096ea04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQKivD963VcB8DDOZxaUuQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@universaleye?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">万用眼</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="2251" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人工神经网络不是为图像分类而设计的。但是他们能有多可怕呢？这就是我们今天要知道的。我们将只使用<code class="fe lv lw lx ly b">Dense</code>层在20，000张图像上训练一个图像分类模型。因此，没有回旋和其他花哨的东西，我们将把它们留到即将到来的文章。</p><p id="436f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不言而喻，但你真的不应该使用香草人工神经网络来分类图像。图像是二维的，如果将它们展平，你会失去使图像可识别的模式。尽管如此，它还是有趣且可行的，并且会让你洞察到这种方法的所有错误。</p><p id="b759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不想看书？请观看我的视频:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="88ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在<a class="ae ky" href="https://github.com/better-data-science/TensorFlow" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上下载源代码。</p><h1 id="40ee" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">使用的数据集和数据准备</h1><p id="8e32" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">我们将使用Kaggle的<a class="ae ky" href="https://www.kaggle.com/pybear/cats-vs-dogs?select=PetImages" rel="noopener ugc nofollow" target="_blank">狗和猫的数据集</a>。它根据知识共享许可协议获得许可，这意味着您可以免费使用它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/294e49ab83c2b0ff84f2cb5fd8931460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3suZy9CA200PS17C9dRWMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片1-狗和猫的数据集(图片由作者提供)</p></figure><p id="76d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集相当大-25，000张图像均匀分布在各个类别之间(12，500张狗图像和12，500张猫图像)。它应该足够大，可以训练一个像样的图像分类器，但不能用人工神经网络。</p><p id="e0f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">唯一的问题是——它的结构不适合开箱即用的深度学习。您可以按照我以前的文章创建一个合适的目录结构，并将其分为训练集、测试集和验证集:</p><div class="mz na gp gr nb nc"><a rel="noopener follow" target="_blank" href="/tensorflow-for-image-classification-top-3-prerequisites-for-deep-learning-projects-34c549c89e42"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">用于图像分类的TensorFlow深度学习项目的三大先决条件</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">编辑描述</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">towardsdatascience.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq ks nc"/></div></div></a></div><h1 id="dc64" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">缩小、灰度化和平面化图像</h1><p id="0a8d" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">让我们把库导入放在一边。我们需要相当多的软件，所以确保安装了Numpy、Pandas、TensorFlow、PIL和Scikit-Learn:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="63cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您不能将图像直接传递给<code class="fe lv lw lx ly b">Dense</code>层。单幅图像是三维的——高度、宽度、颜色通道——<code class="fe lv lw lx ly b">Dense</code>层需要一维输入。</p><p id="4072" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个例子。下面的代码加载并显示训练集中的猫图像:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/8958f34a888d0aa0ea79f5340aae0d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*3y4T-aH_QF-eRwnh56CkLA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片2 —示例猫图片(图片由作者提供)</p></figure><p id="3b4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像宽281像素，高300像素，有三个颜色通道(<code class="fe lv lw lx ly b">np.array(src_img).shape </code>)。总的来说，它有252，900个像素，展平后转化为252，900个要素。这是很多的，所以让我们在可能的地方节省一些资源。</p><p id="9daf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果有意义，你应该<strong class="lb iu">灰度化</strong>你的图像数据集。如果你可以对非彩色图像进行分类，那么神经网络也应该可以。您可以使用以下代码片段将图像转换为灰度:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/48ba9d22103f26a71b0384fe614d4f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*XhKU5hO2oKn_U346UVveug.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3 —灰度猫图像(图片由作者提供)</p></figure><p id="0179" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很明显，它仍然是一只猫，所以颜色在这个数据集中没有起很大的作用。灰度图像宽281像素，高300像素，但只有一个颜色通道。这意味着我们从252，900像素增加到了84，300像素。仍然很多，但绝对是朝着正确方向迈出的一步。</p><p id="f3b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如在<a class="ae ky" rel="noopener" target="_blank" href="/tensorflow-for-image-classification-top-3-prerequisites-for-deep-learning-projects-34c549c89e42">上一篇文章</a>中所讨论的，数据集中的图像没有相同的大小。这对于神经网络模型来说是一个问题，因为它每次都期望相同数量的输入特征。我们可以将每张图片调整到相同的宽度和高度。这就是我们引入精简的地方，以进一步减少输入特性的数量。</p><p id="66ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下代码片段调整了我们的图像大小，使其宽度和高度都为96像素:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/1277406a1b88f3311bf3e2d97524f3d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*qdfzKfcucPQhLRtBGIYHYA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片4 —调整大小的猫图片(图片由作者提供)</p></figure><p id="82a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像有点小和模糊，当然，但它仍然是一只猫。我们已经减少到9216个特征，如果你还记得的话。我们已经将功能数量减少了27，这是一件大事。</p><p id="ec15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为最后一步，我们需要平坦的形象。您可以使用Numpy的<code class="fe lv lw lx ly b">ravel()</code>函数来实现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/39cecb02548876c2337c27607cec23ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*Y6qkrr4zdnO4pA1rbFK04w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片5 —扁平的猫图片(作者图片)</p></figure><p id="9ad6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是计算机如何看待一只猫——它只是一个9216像素的阵列，范围从0到255。问题就在这里——神经网络更喜欢0到1之间的范围。将整个数组除以255.0即可:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/0a50a06c7553cb63d95c5d3bd3336375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dV6rH-hX_CjKyGp-gc1HgA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片6 —展平和缩放的猫图像(图片由作者提供)</p></figure><p id="2e35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一步，我们将编写一个<code class="fe lv lw lx ly b">process_image()</code>函数，将上述所有变换应用到一张图片上:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="67c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在一个随机的狗图像上测试它，然后反转最后一步来直观地表示图像:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/6bff37486b9c75cd6469b011938f8193.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*KNmknQBn2gcQ4nadg-xc2A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片7 —变形的狗图片(图片由作者提供)</p></figure><p id="24c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样——这个功能像广告宣传的那样工作。接下来，让我们将它应用于整个数据集。</p><h1 id="0f5b" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">将图像转换为表格数据，用于深度学习</h1><p id="f363" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">我们将编写另一个函数——<code class="fe lv lw lx ly b">process_folder()</code>——它遍历给定的文件夹，并对任何JPG文件使用<code class="fe lv lw lx ly b">process_image()</code>函数。然后，它将所有图像组合成一个熊猫数据帧，并添加一个类作为附加列(猫或狗):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="55fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将它应用于培训、测试和验证文件夹。您需要为每个文件夹调用它两次，一次为猫，一次为狗，然后连接集合。我们还会将数据集转储到pickle文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="f44b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是<code class="fe lv lw lx ly b">train_set</code>的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/b34d65a84b549b3953717f4185ac3719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0xHW6UIqvcC-v856XH-Ftw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片8 —训练集的头(图片由作者提供)</p></figure><p id="0a3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集包含所有猫的图像，后面是所有狗的图像。这对于训练集和验证集来说并不理想，因为神经网络会按照这个顺序<em class="nz">看到</em>它们。您可以使用Scikit-Learn中的<code class="fe lv lw lx ly b">shuffle</code>函数来随机化排序:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="c496" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/e24a5fc5aacdc0ef6805273ccef77ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6P82GdVUwumNmPN9MkmfcQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片9-混洗训练集的头(图片由作者提供)</p></figure><p id="a54a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">快到了。下一步是将要素从目标中分离出来，就像您通常对任何表格数据集所做的那样。我们将对所有三个子集进行拆分:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="1b97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，你必须分解目标变量。有两个不同的类(cat和dog)，因此每个实例的目标变量应该包含两个元素。例如，下面是应用于<code class="fe lv lw lx ly b">y_train</code>的<code class="fe lv lw lx ly b">factorize()</code>函数的作用:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/9494020452e9b8e098229141029cd3e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*2q2mrxsX4F3pqNYe5llGrw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10-应用于y_train的因式分解函数(图片由作者提供)</p></figure><p id="25df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标签被转换成整数——0代表猫，1代表狗。您可以使用TensorFlow中的<code class="fe lv lw lx ly b">to_categorical()</code>函数，并传入分解的整数表示数组以及不同类的数量(2):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="07ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，<code class="fe lv lw lx ly b">y_train</code>现在看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ab3d88bedaa45a15ea9be92a5be7ac74.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*5b4UWkOTEfYPrBp0lANHPw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11 —分类格式的目标变量(作者图片)</p></figure><p id="ab83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从概率的角度来看，第一张图片有100%的概率是一只猫，有0%的概率是一只狗。这些都是真标签，所以<em class="nz">概率</em>可以是0也可以是1。</p><p id="c4e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在终于拥有了训练神经网络模型所需的一切。</p><h1 id="e49b" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">用人工神经网络(ANN)训练图像分类模型</h1><p id="1d98" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">我已经随机选择了层数和每层的节点数。你可以随意调整网络。您不应该更改以下内容:</p><ul class=""><li id="fb8e" class="oc od it lb b lc ld lf lg li oe lm of lq og lu oh oi oj ok bi translated"><strong class="lb iu">输出层</strong> —它需要两个节点，因为我们有两个不同的类。我们不能再使用<em class="nz"> sigmoid </em>激活功能，所以选择<em class="nz"> softmax </em>。</li><li id="0a7c" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated"><strong class="lb iu">损失函数</strong> —二元交叉熵不会削减它。使用分类交叉熵。</li></ul><p id="4239" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他一切都完全取决于你:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><p id="8e47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我经过100个纪元后得到的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/d6c356657caa940c5394d03a69743050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hm_Pd55tVt7BMMwquV7Zww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图12—100个时期后的人工神经网络结果(图片由作者提供)</p></figure><p id="f95f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">60%的准确率只是比猜测好一点点，但没有什么值得大书特书的。不过，让我们检查一下在培训期间指标发生了什么变化。</p><p id="f7c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下代码片段绘制了100个时期中每个时期的训练损失与验证损失的关系:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/cedb16823dacb5443fd466922d247017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qdkcCYBhLAY589A5VcKR3w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图13——培训损失与验证损失(图片由作者提供)</p></figure><p id="064f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该模型正在很好地学习训练数据，但未能推广。随着我们对模型进行更多时期的训练，验证损失继续增加，这表明模型不稳定且不可用。</p><p id="cbf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看看精确度的对比:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ma l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/48b5b5098fe4328eb9b5c96b41e4cc5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5FKWD93kF2Sb30D8hsporw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图14——训练准确度与验证准确度(图片由作者提供)</p></figure><p id="a825" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似图片。验证准确性稳定在60%左右，而模型过度拟合训练数据。</p><p id="0d4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于具有20K训练图像的两类数据集，60%的准确率几乎是它所能得到的最差的。原因很简单— <code class="fe lv lw lx ly b">Dense</code>图层不是为捕捉复杂的二维图像数据而设计的。你需要一个<em class="nz">概念</em>层来做好这项工作。</p><h1 id="1dc9" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">结论</h1><p id="0001" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">现在你知道了——如何用人工神经网络训练图像分类模型，以及为什么你不应该这样做。这就像穿着人字拖爬山——也许你能做到，但最好不要。</p><p id="c9d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将在下面的文章中了解卷积神经网络是如何工作的，并且您将看到它们带来的改进。我会在周五发布那篇文章，敬请关注。</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><p id="1a9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nz">喜欢这篇文章吗？成为</em> <a class="ae ky" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="nz">中等会员</em> </a> <em class="nz">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="mz na gp gr nb nc"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="pa l nn no np nl nq ks nc"/></div></div></a></div></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="d69a" class="mb mc it bd md me pb mg mh mi pc mk ml jz pd ka mn kc pe kd mp kf pf kg mr ms bi translated">保持联系</h1><ul class=""><li id="f300" class="oc od it lb b lc mt lf mu li pg lm ph lq pi lu oh oi oj ok bi translated">注册我的<a class="ae ky" href="https://mailchi.mp/46a3d2989d9b/bdssubscribe" rel="noopener ugc nofollow" target="_blank">简讯</a></li><li id="2900" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated">在YouTube<a class="ae ky" href="https://www.youtube.com/c/BetterDataScience" rel="noopener ugc nofollow" target="_blank">上订阅</a></li><li id="b52e" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated">在<a class="ae ky" href="https://www.linkedin.com/in/darioradecic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</li></ul></div></div>    
</body>
</html>