<html>
<head>
<title>Where to travel next? A guide to building a recommender system for POIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">接下来去哪里旅游？兴趣点推荐系统构建指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/where-to-travel-next-a-guide-to-building-a-recommender-system-for-pois-5116adde6db?source=collection_archive---------16-----------------------#2021-09-24">https://towardsdatascience.com/where-to-travel-next-a-guide-to-building-a-recommender-system-for-pois-5116adde6db?source=collection_archive---------16-----------------------#2021-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7fc2fd9a7b45f5cea7aa8053394270b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rLmVmmy72w2lQC7hqj2ulQ.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/photos/CJOO0QhCmQM$" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="913e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae kc" rel="noopener" target="_blank" href="/make-your-own-book-and-movie-recommender-system-using-surprise-42cc1c840a19">的上一篇文章</a>中，我写了如何制作你自己的电影和书籍推荐系统。在下文中，我将一步一步地描述如何构建一个推荐系统，该系统基于用户偏好、地理影响和社会影响来建议新的游览地点。</p><p id="f2e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">推荐方法在文章<a class="ae kc" href="https://dl.acm.org/doi/10.1145/2525314.2525339" rel="noopener ugc nofollow" target="_blank"> iGSLR:个性化地理社交位置推荐:一种核密度估计方法】中介绍，张和周，SIGSPATIAL'13。</a></p><p id="67f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将使用Surprise Library一步一步地介绍他们方法的实现。</p><h1 id="ee60" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">加载数据集和预处理</h1><p id="edc3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我使用的数据集是从社交媒体Gowalla收集的。它由2，724，891个兴趣点中的407，533个用户的36，001，959次签到组成。</p><p id="07ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它包括用户签到信息、用户朋友信息、位置信息和用户信息的数据集。</p><p id="1b5b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了减少计算时间，我只选择了拥有5次以上50次以下签到的用户，但是你当然可以处理所有的数据。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="75aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最终的训练数据集应包含所有兴趣点信息和用户信息，没有冗余信息，为此:</p><ol class=""><li id="6f3b" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la mp mq mr ms bi translated">我使用地点id连接了签到数据框和位置数据框</li></ol><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="c752" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.我从获得的数据帧df_checkins_location中计算了被访问位置的频率，以去除冗余的行</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="15cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.我连接了测向频率和测向位置，以获得最终的训练数据集</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="663e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，整个数据集被意外加载</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="9e23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章的作者设计了一个推荐系统，利用社会和地理影响来表达用户的偏好。</p><h1 id="4149" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">社会影响</h1><p id="4bba" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">作者观察到，用户通常会向朋友寻求书籍、电影或兴趣点的推荐。他们通常更喜欢去朋友们强烈推荐的景点，而不是随便去一个地方。</p><p id="508a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们建议使用以下步骤来计算用户的社会影响力:</p><p id="150c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(1)测量她/他与她/他的每个朋友的相似性。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/bd113bd119b1ef27c9a768ce1944fade.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*UtEtux6Go-YtTlZwKzo0bA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">两个用户之间的社会相似性</p></figure><ul class=""><li id="43e1" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la nb mq mr ms bi translated">F(u)是用户u的朋友的集合</li></ul><p id="d16c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="nc">实现</em> </strong></p><p id="bba9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我创建了一个数据框，将每个用户与她/他的朋友联系起来。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/bb6cc331653b03b02189458e754287f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*83o5FWbbl9cwa53dFk9Cuw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">数据集中每个用户的朋友列表</p></figure><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="8e0c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(2)在协同过滤公式中使用这种相似性</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/9940f861883c284af3284470a85b9365.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*oYiHF3QyIKQUv5pDQjktvQ.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">社交协同过滤评级预测</p></figure><ul class=""><li id="736b" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la nb mq mr ms bi translated">r_vi是用户v访问POI i的频率</li></ul><p id="2448" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了获得r_vi，我们需要使用下面的函数:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="f6ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用以下函数计算预测评级的实施情况:</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="cb69" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(3)将POI的预测转换成概率得分</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/8c0c66f2d4496b78f8ebf672bf560364.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*PVQGaFMMjdgXDPvGgYb7gQ.png"/></div></figure><p id="3538" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在哪里</p><ul class=""><li id="8c07" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la nb mq mr ms bi translated">l是所有POI的列表</li></ul><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><h1 id="be6b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">位置的地理影响</h1><p id="cf52" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">作者建议利用同一用户访问的每对位置之间的距离。例如，曾经在世界各地旅行的用户希望得到国外的兴趣点的建议，相反，经常访问其生活区域周围的兴趣点的用户希望得到附近兴趣点的建议。</p><p id="cdf4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着距离分布从一个用户到另一个用户的变化，其计算如下:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0f9f58fb9b486e5d890cb9a9b9fc4074.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*vIOKH1CQw2UBuydNC-THJA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">距离分布估计</p></figure><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="33d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在哪里</p><ul class=""><li id="ef56" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la nb mq mr ms bi translated">d_ij是要推荐的POI和用户已经访问过的POI之间的距离</li></ul><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><ul class=""><li id="ce4f" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la nb mq mr ms bi translated">D_u是用户u访问的所有POI对的距离列表</li><li id="ea7e" class="mk ml iq kf b kg nh kk ni ko nj ks nk kw nl la nb mq mr ms bi translated">k(。)是一个普通的核函数</li></ul><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7b33b6ddc4c0e4acd6c257c5a5129d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*JXC-_s_USHLQGKfrJAGSuA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">正常核函数</p></figure><ul class=""><li id="b252" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la nb mq mr ms bi translated">h是作为最佳带宽的平滑参数。</li></ul><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/c4a424c9adb59c87e062ba15987acc93.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*ZdOqRHw3enBx_fzQz-IQPA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">最佳带宽</p></figure><p id="ed6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用户访问新POI的最终概率计算如下:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2628793de8cd1e0244e496d84ee4498c.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*eS4z9aX1BZT-F1eOBGFa9Q.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">用户访问新位置的地理概率(POI)</p></figure><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><h1 id="6860" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">最终公式</h1><p id="34b1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">将社会影响和地理影响概率相加，以为用户u估计POI的相关性分数。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><h1 id="eea9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="cb9e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">就是这样！这个推荐系统可以帮助你决定你的下一次旅行，以防你认为离POI的距离和你朋友的推荐是选择的重要因素。你可以通过<a class="ae kc" href="https://www.linkedin.com/in/maha-amami-088b42b2/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>给我发消息获取完整的代码。请继续关注推荐系统的更多代码。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="np mj l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://giphy.com/gifs/matt-courteney-schwimmer-128PxwIB1pgN8s" rel="noopener ugc nofollow" target="_blank">吉菲</a>演出</p></figure><figure class="me mf mg mh gt jr gh gi paragraph-image"><a href="https://www.buymeacoffee.com/amamimahaL"><div class="gh gi nq"><img src="../Images/e860cce9c92c3c21c58386ffb6568900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03aelMB7Xsc9dN1dhclHmA.png"/></div></a></figure></div></div>    
</body>
</html>