<html>
<head>
<title>Stephen King Text Generation with Artificial Intelligence (RNN), Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">斯蒂芬金文本生成与人工智能(RNN)，使用Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stephen-king-text-generation-with-artificial-intelligence-rnn-using-python-e92c735851be?source=collection_archive---------12-----------------------#2021-06-03">https://towardsdatascience.com/stephen-king-text-generation-with-artificial-intelligence-rnn-using-python-e92c735851be?source=collection_archive---------12-----------------------#2021-06-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/ec4926c578ec95e9ee0e277465eb52cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*alGBsxvPG3_55Hr9gnoJhw.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">J. Kelly Brito 在<a class="ae jd" href="https://unsplash.com/s/photos/stephen-king-it?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="8995" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">以下是我如何训练一个深度学习架构来编写一个类似斯蒂芬·金的文本。</h2></div><p id="280a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">我喜欢阅读，我是斯蒂芬·金的超级粉丝。</strong>另外，我是一名物理学家和数据科学家，目前在获得硕士学位后正在休假。在这段时间里，我决定读另一本斯蒂芬·金的书，我真的很喜欢它。</p><p id="ae35" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我永远不会让电脑写一本斯蒂芬·金的书，原因很简单。</p><blockquote class="lr"><p id="c865" class="ls lt jg bd lu lv lw lx ly lz ma lq dk translated">我们还没有掌握这种技术。</p></blockquote><p id="c0bc" class="pw-post-body-paragraph kv kw jg kx b ky mb kh la lb mc kk ld le md lg lh li me lk ll lm mf lo lp lq ij bi translated">如果你看一些NLP实验(例如AI写笑话<a class="ae jd" href="https://www.iflscience.com/technology/ais-attempts-at-oneliner-jokes-are-unintentionally-hilarious/all/" rel="noopener ugc nofollow" target="_blank">这里</a>)你可以有把握地说我们在写作方面不如人类。</p><p id="1a19" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以你可能会问“为什么在一篇解释如何用人工智能生成文本的博客文章中，你告诉我我们不能让人工智能生成文本<strong class="kx jh">？</strong>”。答案是这样的:</p><blockquote class="lr"><p id="00d3" class="ls lt jg bd lu lv lw lx ly lz ma lq dk translated">虽然我们确实不能让计算机写一整本书(就目前而言)，但人工智能仍然能够提出情节建议，获得见解，并帮助人类写作。</p></blockquote><p id="9c45" class="pw-post-body-paragraph kv kw jg kx b ky mb kh la lb mc kk ld le md lg lh li me lk ll lm mf lo lp lq ij bi translated">实际上，它在这些方面做得非常好！</p><p id="cc88" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，我决定拿一堆斯蒂芬·金的文本，用一个人工智能(<strong class="kx jh">深度学习</strong>)算法写一个小的新的。这是游戏计划:</p><ol class=""><li id="5894" class="mg mh jg kx b ky kz lb lc le mi li mj lm mk lq ml mm mn mo bi translated"><strong class="kx jh">理论</strong></li><li id="0212" class="mg mh jg kx b ky mp lb mq le mr li ms lm mt lq ml mm mn mo bi translated"><strong class="kx jh">代码</strong></li><li id="81ff" class="mg mh jg kx b ky mp lb mq le mr li ms lm mt lq ml mm mn mo bi translated"><strong class="kx jh">结果</strong></li></ol><p id="9d21" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我知道你们中的一些人可能只对结果感兴趣，或者只对理论部分感兴趣，或者只对代码感兴趣。每个部分都是前后一致的，所以请随意跳到你最喜欢的部分。</p><p id="4ff5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="mu">我们潜进去吧！</em> </strong></p><p id="3a2e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi mv translated"><span class="l mw mx my bm mz na nb nc nd di"> 1。</span> <strong class="kx jh">理论</strong></p><blockquote class="ne nf ng"><p id="4748" class="kv kw mu kx b ky kz kh la lb lc kk ld nh lf lg lh ni lj lk ll nj ln lo lp lq ij bi translated">注意:这是人工智能结构背后所需理论的<strong class="kx jh">简要概述</strong>。如果你觉得你需要更扎实的理论背景，你应该参考不同的资料或书籍。</p></blockquote><p id="877f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们说AI时，我们会说很多东西。另一方面，当谈到“文本生成”时，我们可能希望参考<strong class="kx jh">深度学习</strong>。<strong class="kx jh"> </strong>深度学习是一种特殊的人工智能，能够通过执行<strong class="kx jh">分层学习来完成任务。</strong>让我们简单点。如果你想识别你面前的动物是不是猫，你可能会从看颜色开始，然后是形状，然后是眼睛，等等。所以你基本上从简单的概念开始，然后从简单的概念中建立更复杂的概念。出于这个原因，我们说学习是<strong class="kx jh">分层的(即输入由不同的层处理)。</strong></p><p id="4e0e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">假设输入是由N = N×N个像素组成的图像。<br/> </strong>这个输入被不同的层处理，然后<strong class="kx jh">如果动物是猫，结果是1，如果不是猫，结果是0</strong>。很简单，对吧？</p><p id="48d3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">需要知道的重要一点是，这个结构<strong class="kx jh">需要训练。这意味着你必须使用大量的猫和非猫的标签图片(idk，dogs？)并建立一个学习过程，让机器学习如何执行任务。</strong></p><p id="b45e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，让我们谈谈生意。当我们谈论文本生成时，我们必须记住两个重要的概念:</p><p id="dbee" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">a)将<strong class="kx jh">字嵌入</strong></p><p id="e511" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">b)<strong class="kx jh">递归神经网络</strong></p><p id="84bc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">单词嵌入是机器把一个文本(一个字符串)转换成一个向量(一个数字序列)的部分。</strong></p><p id="a7c5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">递归神经网络是一种特殊的深度学习结构。</strong>这种结构能够收集一个序列顺序(如一个句子)的所有先前输入，以预测获得某个输出的概率。特别是有一个<strong class="kx jh">词汇</strong>包含了文本的所有单词(假设有<strong class="kx jh"> V单词</strong>)和一个<strong class="kx jh"> Logit输出。</strong>这是一个在[0，1]范围内的V数序列，其和为1。<strong class="kx jh">序列的每个数字(假设是j)告诉你输入序列后获得j字的概率。</strong></p><p id="241b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">到目前为止所解释的一切都总结在下面的方案中:</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e8c0dc736a60d6f68e53ae0832e2090a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQjaMw3C8bnRORjFo-MDeg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">来源:<a class="ae jd" href="https://www.tensorflow.org/text/tutorials/text_generation" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/text/tutorials/text_generation</a></p></figure><p id="81ee" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi mv translated"><span class="l mw mx my bm mz na nb nc nd di"> 2。</span>代码<strong class="kx jh">代码</strong></p><blockquote class="ne nf ng"><p id="f973" class="kv kw mu kx b ky kz kh la lb lc kk ld nh lf lg lh ni lj lk ll nj ln lo lp lq ij bi translated">注:本部分灵感来自<a class="ae jd" href="https://www.tensorflow.org/text/tutorials/text_generation" rel="noopener ugc nofollow" target="_blank">本来源</a></p></blockquote><p id="8d05" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">这可能会让你吃惊，但是代码部分非常简单。</strong></p><p id="6d52" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些是您将需要的库:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="c77b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我用过的所有斯蒂芬·金的文本都可以在这里找到<a class="ae jd" href="https://www.kaggle.com/ttalbitt/stephen-king-books" rel="noopener ugc nofollow" target="_blank">。<br/> <strong class="kx jh">在你得到它们之后，很容易用一些非常简单的Python普通代码行来使用它们:</strong></a></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="2b90" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">这些是为了使文本适应TensorFlow并创建字典而运行的代码行:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="ab6b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">建立模型:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="82e8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">训练模型:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="820d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">获取训练好的模型:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="2d69" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">这里是生成文本功能:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="62a6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">可用于实际生成以下简单行的文本(假设给定了输入字符串):</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d857" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="mu">如"后"已作为输入序列给出。</em> </strong></p><p id="79e8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi mv translated"><span class="l mw mx my bm mz na nb nc nd di">3</span>T25】结果</p><p id="26ab" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">到目前为止描述的人工智能结构原则上可以从单个输入生成无限的文本。当然，这会导致糟糕的表现，因为它最终只会一遍又一遍地重复同样的话。因此，从输入中生成一个句子是安全的。需要注意的是，有一个参数叫做<strong class="kx jh"> t(温度)</strong>，它允许你设置算法的创造性。t= 0意味着重复数据集的相同单词，t=1意味着发明非英语句子或单词。这两者之间的良好平衡是关键。</p><p id="7355" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">给你看看一些结果吧！</p><p id="4860" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">第一个例子(t = 0.1，中等输入):</strong></p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="3126" class="nw nx jg ns b gy ny nz l oa ob">Input: "After the"<br/>Output: "After the sun was warm on our faces we were both wearing sweater (.) You know how confused dreams are logic like"</span></pre><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/7765597dbccb64bc055cb59cd361a62f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hQW7eecjFF-NwMiQMgoTwQ.png"/></div></div></figure><p id="deb7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">第二个例子(t=0.1，长输入):</strong></p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="32af" class="nw nx jg ns b gy ny nz l oa ob">Input: "So I decided"<br/>Output: "So I decided the ordinary was going on. I think this was because in my heart I believed that such conditions only"</span></pre><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/30ed9b93f0068b8a54c9964b7d34fed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YkoMGPnMcBDCA3esQ_qgjg.png"/></div></div></figure><p id="3ace" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">第三个例子(t=0.7，短输入):</strong></p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="7b2c" class="nw nx jg ns b gy ny nz l oa ob">Input: "I"<br/>Output: "I fell in love to the sound of breaking glass edged it liked jagged lace. The two ved her be a fluke I r" </span></pre><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/8bbac512d1a9b7b956692b8fe30a9bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JUDk6lpEzfcS8XICLWq5Zw.png"/></div></div></figure><p id="9c14" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">第四个例子(t=0.2，短输入):</strong></p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="3968" class="nw nx jg ns b gy ny nz l oa ob">Input: "He"<br/>Output: "He who spotted her. He recognized her by her red handbag spread out in front of me and it was like takin" </span></pre><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/397b1c1b50f60d9e26c6f30885e08a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gx4DgEit3tofPXqde1ACAw.png"/></div></div></figure><p id="4396" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">一些乐趣(wordcloud): </strong></p><p id="970b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">单词越大，使用频率越高。</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/e4cb304bf60af00d3f97dab1259b0201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gCvLJ7PRsjKR48UNKeXezA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我用Python制作的图片</p></figure><h1 id="499a" class="oh nx jg bd oi oj ok ol om on oo op oq km or kn os kp ot kq ou ks ov kt ow ox bi translated">结论:</h1><p id="1c3f" class="pw-post-body-paragraph kv kw jg kx b ky oy kh la lb oz kk ld le pa lg lh li pb lk ll lm pc lo lp lq ij bi translated">正如可能看到的，<strong class="kx jh">我们无法用这种技术实现一个完全一致的斯蒂芬·金文本生成器</strong>。尽管如此，斯蒂芬·金的粉丝可能会意识到，在生成的文本中有一些东西让他们想起了斯蒂芬·金。这并不令人惊讶，因为人工智能算法已经“看到”了由斯蒂芬·金文本组成的数据集。<strong class="kx jh">另一方面，令人惊讶的是，该算法已经发明了一种新的斯蒂芬·金式(非常短)文本！</strong></p><p id="f803" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="ce33" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.在<a class="ae jd" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Linkedin </strong> </a>上关注我，在那里我发布我所有的故事<br/> B .订阅我的<a class="ae jd" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="kx jh">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae jd" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="kx jh">推荐会员</strong> </a>，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p><p id="1483" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="mu">任何人都快乐斯蒂芬·金！</em> </strong></p></div></div>    
</body>
</html>