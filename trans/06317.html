<html>
<head>
<title>Dashboards for Interpreting &amp; Comparing Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于解释和比较机器学习模型的仪表板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dashboards-for-interpreting-comparing-machine-learning-models-ffcfb4c05152?source=collection_archive---------34-----------------------#2021-06-06">https://towardsdatascience.com/dashboards-for-interpreting-comparing-machine-learning-models-ffcfb4c05152?source=collection_archive---------34-----------------------#2021-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1d9c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用解释为机器学习模型创建仪表板</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/bdb9110f16d2e2366f6d6eaae7b686fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*9MpyH6iZi7ATnZpudXcGbw.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">来源:作者</p></figure><p id="3a3b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">随着技术的发展，数据科学领域有多种机器学习算法，这使得用户/数据科学家/ML工程师很难根据他们正在处理的数据集选择最佳模型。</p><p id="99bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">比较不同的模型可以是选择最佳模型的一种方式，但这是一个耗时的过程，我们将创建不同的机器学习模型，然后比较它们的性能。这也是不可行的，因为大多数模型是黑盒，我们不知道模型内部发生了什么，以及它将如何表现。简而言之，由于模型的复杂性和模型是黑箱，我们不知道如何解释模型。</p><p id="23e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果不解释模型，就很难理解模型是如何表现的，以及它将如何根据提供给它的新数据来表现。这不仅有助于我们理解模型预测，也有助于我们理解它是如何达到特定预测的。</p><p id="797f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下一个大问题是如何解释这些模型和它们的行为，让我来解释一下。如果我告诉你，你不仅可以解读不同的模型，还可以比较它们的性能，会怎么样？是的，现在我们可以看到黑盒的内部，了解模型在做什么。</p><p id="014b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Interpret是一个开源的python库，用于解释和分析不同机器学习模型的性能。在本文中，我们将看到如何使用interpret进行模型解释和可视化模型性能。在这篇文章的最后，我们将会探索一些非常酷的东西，我确信这对所有的数据科学家/ML工程师等都非常有帮助。敬请关注。</p><p id="8b77" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们开始吧…</p><h1 id="ba85" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">安装所需的库</h1><p id="b8a5" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">像任何其他python库一样，我们将使用pip安装来安装解释器。下面给出的命令将执行安装。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="9322" class="ms lr it mo b gy mt mu l mv mw">pip install interpret</span></pre><h1 id="db1a" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">导入所需的库</h1><p id="a2d3" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">接下来，我们将导入将在本文中使用的所有必需的库。我们将装载熊猫，翻译等。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="ceed" class="ms lr it mo b gy mt mu l mv mw">import pandas as pd<br/>from interpret import show<br/>from interpret.glassbox import RegressionTree<br/>from sklearn.model_selection import train_test_split</span></pre><p id="3b77" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将在需要时导入其他功能进行解释。</p><h1 id="1eed" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">创建机器学习模型</h1><p id="1aee" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">现在我们将创建一个机器学习模型，我们将使用解释库来解释它。如您所见，我们已经导入了用于加载数据和拆分数据的库，所以让我们首先加载数据，然后创建模型。我们将在这里使用的数据集是著名的糖尿病数据集。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="7a49" class="ms lr it mo b gy mt mu l mv mw">df = pd.read_csv("Diabetes.csv")<br/>X_train, X_test, y_train, y_test = train_test_split(df[['Pregnancies', 'Glucose','BloodPressure','SkinThickness','Insulin','BMI','DiabetesPedigreeFunction','Age']], df['Outcome'], test_size=0.3)</span><span id="cb06" class="ms lr it mo b gy mx mu l mv mw">#Creating Model<br/>reg_tree = RegressionTree(random_state=42)<br/>reg_tree.fit(X_train, y_train)</span></pre><p id="1217" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们稍后将创建更多的模型，以便我们可以比较不同的模型。</p><h1 id="0719" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">使用可视化进行口译和绩效分析</h1><p id="386f" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">现在，我们将解读模型，并观察模型的性能。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="9394" class="ms lr it mo b gy mt mu l mv mw">#global interpretation<br/>reg_tree_global = reg_tree.explain_global(name='Regression Tree')<br/>show(reg_tree_global)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi my"><img src="../Images/ae8f029e872a6177f286ea085b3b8f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qr5ILuJMT-NL1it2gq-P_Q.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">来源:作者</p></figure><p id="54cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是模型的整体性能，您可以从下拉列表中选择不同的功能，以查看它在模型中的使用情况。这是模型的全局解释，对于局部解释(个体预测)我们可以使用局部函数。</p><p id="bf7a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们想象一下模型的性能。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="3931" class="ms lr it mo b gy mt mu l mv mw">reg_tree_perf = RegressionPerf(reg_tree.predict).explain_perf(X_test, y_test, name='Regression Tree')</span><span id="2cd7" class="ms lr it mo b gy mx mu l mv mw">show(reg_tree_perf)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi nd"><img src="../Images/32297c1e74a28786ef45f2bde4dd19f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FeATcLpcasj5urCHPOaX3Q.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">性能(来源:作者)</p></figure><h1 id="82c1" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">奖金</h1><p id="57fd" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">有趣的部分来了，在奖金部分，我将向您展示如何创建一个模型仪表板，其中包含您创建的所有模型的解释和性能。这不是很有趣吗，让我们看看我们怎么做？</p><p id="c689" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了创建仪表板，首先，让我们再创建一个模型，然后我们将分析仪表板中两个模型的性能和解释。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="f952" class="ms lr it mo b gy mt mu l mv mw">from interpret.glassbox import LinearRegression<br/>lin_reg = LinearRegression(random_state=42)<br/>lin_reg.fit(X_train, y_train)<br/>lin_reg_perf = RegressionPerf(lin_reg.predict).explain_perf(X_test, y_test, name='Linear Regression')<br/>lin_reg_global = lin_reg.explain_global(name='Linear Regression')</span></pre><p id="efd3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在创建了模型之后，有趣的部分来了，我们将创建一个只有一行代码的仪表板，用于分析两个模型的性能，并使用它来解释模型。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="f84b" class="ms lr it mo b gy mt mu l mv mw">show([ lin_reg_global, lin_reg_perf, reg_tree_global, reg_tree_perf])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ne"><img src="../Images/7d6b2da34e9185fe19d8da8cdcd524e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jOtwmIWDXmNSfURGjqcRpg.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">模型仪表板(来源:作者)</p></figure><p id="3ada" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以通过单击仪表板上方的链接在新窗口中打开此仪表板。下面的视频探索了仪表板的不同部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/bdb9110f16d2e2366f6d6eaae7b686fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*9MpyH6iZi7ATnZpudXcGbw.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">仪表板(来源:作者)</p></figure><p id="0ae7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以看到我们为模型解释和性能比较创建了一个仪表板是多么容易。</p><p id="6ef0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">继续尝试不同的数据集和不同的机器学习模型。请在回复部分告诉我您的意见。</p><p id="89d9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文是与<a class="nf ng ep" href="https://medium.com/u/40808d551f5a?source=post_page-----ffcfb4c05152--------------------------------" rel="noopener" target="_blank"> Piyush Ingale </a>合作完成的。</p><h1 id="a9f8" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">在你走之前</h1><p id="216b" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated"><strong class="kw iu"> <em class="nh">感谢</em> </strong> <em class="nh">的阅读！如果你想与我取得联系，请随时联系我在hmix13@gmail.com或我的</em> <a class="ae ni" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="nh"> LinkedIn简介</em> </strong> </a> <em class="nh">。可以查看我的</em><a class="ae ni" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu"><em class="nh">Github</em></strong><em class="nh"/></a><em class="nh">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae ni" href="https://medium.com/@hmix13" rel="noopener"> <strong class="kw iu"> <em class="nh">我的简介</em> </strong> </a> <em class="nh">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>