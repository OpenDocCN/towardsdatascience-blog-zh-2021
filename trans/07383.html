<html>
<head>
<title>Plot a TensorFlow Model with Keras Functional API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Keras Functional API绘制张量流模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/plot-a-tensorflow-model-with-keras-functional-api-f2db639dbbd8?source=collection_archive---------19-----------------------#2021-07-05">https://towardsdatascience.com/plot-a-tensorflow-model-with-keras-functional-api-f2db639dbbd8?source=collection_archive---------19-----------------------#2021-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4c11" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在TensorFlow中可视化神经网络结构的快速指南</h2></div><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="kn ko l"/></div></figure><h1 id="184e" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">为什么要看这篇文章？</h1><p id="2bb8" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">本文将向您展示如何使用<strong class="lj iu"> Google Colab </strong>通过Tensorflow的<strong class="lj iu"> eager execution </strong>和<strong class="lj iu"> Keras Functional API </strong>实现一个卷积神经网络模型。然后我们将<strong class="lj iu">以图形形式绘制</strong>我们的模型:这种可视化允许我们有效地观察我们模型的<strong class="lj iu">结构</strong>，这是一个基本方面，尤其是在处理复杂模型时。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi md"><img src="../Images/34bb9f4ed79d6d18dae2f26ca10aa2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VhiwPCgFb62oIiQh"/></div></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">詹姆斯·哈里森在<a class="ae mo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a5e2" class="pw-post-body-paragraph lh li it lj b lk mp ju lm ln mq jx lp lq mr ls lt lu ms lw lx ly mt ma mb mc im bi translated">我们将得到如下图所示的图表:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/e996989a8338d62c8f2f4f087145ee84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*oLBK_t63fvJkqn8HC_NFow.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">模型结构—按作者分类的图像</p></figure><h2 id="3e6d" class="mv kq it bd kr mw mx dn kv my mz dp kz lq na nb lb lu nc nd ld ly ne nf lf ng bi translated">Keras功能API</h2><p id="f46a" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Keras Functional API 允许您比传统的顺序配置更灵活有效地创建模型，后者通常用于生成简单的代理模型。functional API允许您创建具有非线性拓扑结构、共享层、多输入和多输出的模型……本质上，我们正在创建一个<strong class="lj iu">层图</strong>。有了这个API，我们可以创建<a class="ae mo" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" rel="noopener ugc nofollow" target="_blank">有向无环图</a>，但是如果再加上<strong class="lj iu">自定义层</strong>和<strong class="lj iu">模型</strong>，以及<strong class="lj iu">自定义损失函数</strong>和<strong class="lj iu">优化器</strong>，它就可以创建功能强大且完全可定制的神经网络模型。</p><h2 id="976c" class="mv kq it bd kr mw mx dn kv my mz dp kz lq na nb lb lu nc nd ld ly ne nf lf ng bi translated">代码</h2><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="15b2" class="pw-post-body-paragraph lh li it lj b lk mp ju lm ln mq jx lp lq mr ls lt lu ms lw lx ly mt ma mb mc im bi translated">我们创建一个顺序卷积网络模型，仅用作示例。我们使用Keras Functional API中的一些有用工具:</p><ul class=""><li id="5ff8" class="ni nj it lj b lk mp ln mq lq nk lu nl ly nm mc nn no np nq bi translated"><a class="ae mo" href="https://keras.io/api/layers/core_layers/input/" rel="noopener ugc nofollow" target="_blank">输入</a>:用于实例化一个Keras张量。这种类似张量的物体只需要知道网络的输入和输出就可以建立一个Keras模型。我们指定输入形状(即全高清RGB图像:三维张量)和层的名称</li><li id="c71a" class="ni nj it lj b lk nr ln ns lq nt lu nu ly nv mc nn no np nq bi translated"><a class="ae mo" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D" rel="noopener ugc nofollow" target="_blank"> Conv2D </a> : 2D卷积层(如图像上的空间卷积)。我们指定过滤器的数量和大小以及激活函数。</li><li id="ba3c" class="ni nj it lj b lk nr ln ns lq nt lu nu ly nv mc nn no np nq bi translated"><a class="ae mo" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/MaxPool2D" rel="noopener ugc nofollow" target="_blank">MaxPooling2D</a>:2D空间数据的最大池操作。我们只需要指定池的大小</li><li id="789f" class="ni nj it lj b lk nr ln ns lq nt lu nu ly nv mc nn no np nq bi translated"><a class="ae mo" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Flatten" rel="noopener ugc nofollow" target="_blank">展平</a>:展平输入</li><li id="8f38" class="ni nj it lj b lk nr ln ns lq nt lu nu ly nv mc nn no np nq bi translated"><a class="ae mo" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense" rel="noopener ugc nofollow" target="_blank">密集</a>:规则密集连接NN层</li></ul><p id="c764" class="pw-post-body-paragraph lh li it lj b lk mp ju lm ln mq jx lp lq mr ls lt lu ms lw lx ly mt ma mb mc im bi translated"><em class="nw"> model.summary() </em>显示了模型属性的有用摘要。然而，图形可视化可能成为理解和保存模型图结构的另一个强有力的工具。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/e996989a8338d62c8f2f4f087145ee84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*oLBK_t63fvJkqn8HC_NFow.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">模型结构—按作者分类的图像</p></figure><p id="73ed" class="pw-post-body-paragraph lh li it lj b lk mp ju lm ln mq jx lp lq mr ls lt lu ms lw lx ly mt ma mb mc im bi translated">有趣的是注意到模型中<strong class="lj iu">数据流</strong>的显示，以及每一层的<strong class="lj iu">名称</strong>和与各种卷积和池层的应用相关的<strong class="lj iu">大小变化</strong>。让我们用均匀分布生成的一些数据来测试这个模型，均匀分布的形状与我们的模型输入一致，批量大小等于1。我们还会使用指定的名称将图像自动保存为<em class="nw">“my _ model . png”</em>。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="59ce" class="pw-post-body-paragraph lh li it lj b lk mp ju lm ln mq jx lp lq mr ls lt lu ms lw lx ly mt ma mb mc im bi translated"><em class="nw"> tf.random.uniform </em>对象返回<strong class="lj iu">随机值</strong>，具有均匀分布，具有指定的形状和类型。有趣的是，由于问题中的数据是<strong class="lj iu">浮点数</strong>，取值范围自动设置为<em class="nw">【0，1】</em>。如果需要，可以将最小和最大采样范围作为参数传递给该调用。</p><h1 id="1ef6" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">结论</h1><p id="6020" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">本文就到这里，希望对你有用。你可以在这里找到<a class="ae mo" href="https://github.com/GitMarco27/TMML/blob/5727dc3f4f87885d1e05863427cbe4ae6b6ea1fe/Notebooks/004_Visualize_Model.ipynb" rel="noopener ugc nofollow" target="_blank">源代码</a>，在GitHub和<a class="ae mo" href="https://www.youtube.com/channel/UCExkeDZ9WC0tg9aoFMsNF0w" rel="noopener ugc nofollow" target="_blank"> YouTube </a>上可以找到完整的<a class="ae mo" href="https://github.com/GitMarco27/TMML" rel="noopener ugc nofollow" target="_blank">资源库</a>。<br/>下次见，<br/>马可</p><h2 id="fcb6" class="mv kq it bd kr mw mx dn kv my mz dp kz lq na nb lb lu nc nd ld ly ne nf lf ng bi translated">3分钟机器学习</h2><p id="fd11" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">3分钟机器学习是一系列与人工智能、深度学习和数据科学相关的教程、视频和文章。你可以在YouTube 上找到完整的视频集。GitHub <a class="ae mo" href="https://github.com/GitMarco27/TMML" rel="noopener ugc nofollow" target="_blank">库</a>包含了文章和视频中显示的所有Google Colab笔记本。希望这些内容对你有用，或者只是你感兴趣。欢迎任何反馈。</p><p id="ca51" class="pw-post-body-paragraph lh li it lj b lk mp ju lm ln mq jx lp lq mr ls lt lu ms lw lx ly mt ma mb mc im bi translated">查看其他剧集:</p><ul class=""><li id="b581" class="ni nj it lj b lk mp ln mq lq nk lu nl ly nm mc nn no np nq bi translated"><a class="ae mo" rel="noopener" target="_blank" href="/images-generation-with-neural-style-transfer-and-tensorflow-a823b0353b06">用神经风格转移和张量流生成图像</a></li><li id="6f93" class="ni nj it lj b lk nr ln ns lq nt lu nu ly nv mc nn no np nq bi translated"><a class="ae mo" rel="noopener" target="_blank" href="/cats-vs-dogs-convolutional-classifier-44ec04c8eb7a">猫VS狗卷积分类器</a></li></ul></div></div>    
</body>
</html>