<html>
<head>
<title>Deep Learning on Human Microbiome</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人类微生物组的深度学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-on-human-microbiome-7854fba815fc?source=collection_archive---------20-----------------------#2021-08-18">https://towardsdatascience.com/deep-learning-on-human-microbiome-7854fba815fc?source=collection_archive---------20-----------------------#2021-08-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="499d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/dl-for-life-sciences" rel="noopener" target="_blank">生命科学的深度学习</a></h2><div class=""/><div class=""><h2 id="e0c1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从DNA序列推断样品的微生物组成</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/09feb9c6c49523fa2fe9ff1fa0343447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYl_u7qFSD0inwdVLsTr8Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://hmpdacc.org/" rel="noopener ugc nofollow" target="_blank">图片来源:人类微生物组项目门户</a></p></figure><p id="0e92" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是我的专栏<a class="ae lh" href="https://towardsdatascience.com/tagged/dl-for-life-sciences" rel="noopener" target="_blank"> <strong class="lk jd">生命科学的深度学习</strong> </a> <strong class="lk jd"> </strong>的第九篇文章，我试图展示将人工神经网络应用于计算生物学和生命科学的真实世界项目的具体例子。之前，我们介绍了深度学习在<a class="ae lh" rel="noopener" target="_blank" href="/deep-learning-on-ancient-dna-df042dc3c73d">古代DNA </a>、<a class="ae lh" rel="noopener" target="_blank" href="/deep-learning-for-single-cell-biology-935d45064438">单细胞生物学</a>、<a class="ae lh" rel="noopener" target="_blank" href="/deep-learning-for-data-integration-46d51601f781">数据整合</a>、<a class="ae lh" rel="noopener" target="_blank" href="/deep-learning-for-clinical-diagnostics-ca7bc254e5ac">临床诊断</a>、<a class="ae lh" rel="noopener" target="_blank" href="/deep-learning-on-microscopy-imaging-865b521ec47c">显微成像</a>中的一些应用，以及一些从自然语言处理(NLP)中推断现代人类基因组中<a class="ae lh" href="https://en.wikipedia.org/wiki/Interbreeding_between_archaic_and_modern_humans" rel="noopener ugc nofollow" target="_blank">尼安德特人渗入</a>区域的技术(此处为和<a class="ae lh" rel="noopener" target="_blank" href="/lstm-to-detect-neanderthal-dna-843df7e85743">此处为</a>)。在本文中，我们将了解为什么<strong class="lk jd">人类微生物组</strong>代表生物学中的<strong class="lk jd">大数据</strong><strong class="lk jd"/>，以及如何训练一个<strong class="lk jd">卷积神经网络(CNN) </strong> <strong class="lk jd">分类器</strong> <strong class="lk jd">用于</strong> <strong class="lk jd">预测一个</strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/Metagenomics" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">宏基因组学</strong> </a> <strong class="lk jd">样本</strong> <strong class="lk jd">起始于</strong> <strong class="lk jd">中的微生物组成</strong></p><h1 id="b98a" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">宏基因组学作为大数据</h1><p id="25ff" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">不幸的是<strong class="lk jd">并不直接</strong>开始为<strong class="lk jd">生物</strong>和<strong class="lk jd">生物医学</strong>应用开发机器学习模型，在我看来是因为<strong class="lk jd">缺乏数据</strong>。我在之前的帖子<a class="ae lh" rel="noopener" target="_blank" href="/do-we-have-big-data-in-life-sciences-c6c4e9f8645c">中讨论了一些挑战，我们在生命科学中有大数据吗？</a>。在那里，我提到了生命科学中的三个方向，它们似乎对人工智能和机器学习很有前景，因为它们似乎有足够的数据量，它们是:</p><ol class=""><li id="e18b" class="nb nc it lk b ll lm lo lp lr nd lv ne lz nf md ng nh ni nj bi translated">单细胞组学</li><li id="dfec" class="nb nc it lk b ll nk lo nl lr nm lv nn lz no md ng nh ni nj bi translated">显微成像</li><li id="f226" class="nb nc it lk b ll nk lo nl lr nm lv nn lz no md ng nh ni nj bi translated">将序列视为统计观察的基因组数据</li></ol><p id="47e2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">后来在评论中<a class="np nq ep" href="https://medium.com/u/bf4c4151f086?source=post_page-----7854fba815fc--------------------------------" rel="noopener" target="_blank"> Mikael Huss </a>建议将<a class="ae lh" href="https://en.wikipedia.org/wiki/Metagenomics" rel="noopener ugc nofollow" target="_blank">宏基因组学</a>和<a class="ae lh" href="https://en.wikipedia.org/wiki/Microbiome" rel="noopener ugc nofollow" target="_blank">微生物组</a>数据作为<strong class="lk jd">第四</strong>大数据资源。事实上，人们可以找到大量公开可用的宏基因组学数据，例如，使用伟大的<a class="ae lh" href="https://www.ebi.ac.uk/metagenomics/" rel="noopener ugc nofollow" target="_blank"> EMBL-EBI资源管理公司</a>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nr"><img src="../Images/dbce1bf9e1291d7e78d2e3f0a1f8ba40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L5Jevi8myfj7YzIx24hFtA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://www.ebi.ac.uk/metagenomics/" rel="noopener ugc nofollow" target="_blank">图片来源:EMBL-EBI微生物组数据资源管理中心</a></p></figure><p id="dde9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">宏基因组学之所以能被称为大数据，是因为相对便宜的<a class="ae lh" href="https://en.wikipedia.org/wiki/Shotgun_sequencing" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">鸟枪测序</strong> </a>，因此成千上万的样本被测序，以及宏基因组学数据相对<strong class="lk jd">低维的性质</strong>。事实上，将测序的DNA片段映射到已知的<strong class="lk jd">微生物生物体</strong>通常会导致500–1000个<strong class="lk jd">可靠地</strong>检测到微生物，例如，与具有数百万维的<a class="ae lh" href="https://en.wikipedia.org/wiki/Genetic_variation" rel="noopener ugc nofollow" target="_blank">遗传变异</a>或<a class="ae lh" href="https://en.wikipedia.org/wiki/DNA_methylation" rel="noopener ugc nofollow" target="_blank">甲基化</a>数据相比，这并不是真正的高维数据。</p><h1 id="a837" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">使用SourceTracker的微生物组成</h1><p id="15a3" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">记住<strong class="lk jd">宏基因组学</strong>为<strong class="lk jd">开发机器和深度学习算法提供了大量数据</strong>，在这篇文章中，我将尝试训练一个卷积神经网络(CNN)，它可以估计给定样本中微生物群落的<strong class="lk jd">来源</strong>。例如，从我办公室的桌子上取一份<a class="ae lh" href="https://en.wikipedia.org/wiki/Cotton_swab" rel="noopener ugc nofollow" target="_blank">拭子</a>样本，我期望在那里找到哪种微生物？它们会不会像我的<strong class="lk jd">皮肤</strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/Microbiota" rel="noopener ugc nofollow" target="_blank">微生物群</a>，或者可能是我嘴里的<strong class="lk jd">口腔</strong>微生物？这个可以用一个叫<a class="ae lh" href="https://www.nature.com/articles/nmeth.1650" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">source tracker</strong></a>的奇妙软件来估算。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/5111d7fa5564664f3974321dc3a51967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_-GPaMRamaaRQqFnbOGJA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://www.nature.com/articles/nmeth.1650#citeas" rel="noopener ugc nofollow" target="_blank">骑士<em class="nt">等</em>T21【Nat方法】8、761–763(2011)</a></p></figure><p id="8f7c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简而言之，<a class="ae lh" href="https://www.nature.com/articles/nmeth.1650#citeas" rel="noopener ugc nofollow" target="_blank"> SourceTracker </a>是一种贝叶斯版本的<a class="ae lh" href="https://en.wikipedia.org/wiki/Mixture_model" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">高斯混合模型(GMM) </strong> </a>聚类算法(看起来类似于<a class="ae lh" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0030126" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">狄氏多项混合</strong> </a>)，它是在称为<strong class="lk jd">源</strong>的参考数据集上训练的，即不同类别，例如土壤或人类口腔或人类肠道微生物群落等，并且可以估计每个源在称为<strong class="lk jd">汇</strong>的测试样本中的比例/贡献因此，SourceTracker算法明确地将接收器样本建模为源的<strong class="lk jd">混合</strong>。算法的<strong class="lk jd">贝叶斯味道</strong>来自于在拟合模型时使用<strong class="lk jd"> Direchlet先验</strong>。</p><p id="62a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最初，SourceTracker是针对<a class="ae lh" href="https://en.wikipedia.org/wiki/16S_ribosomal_RNA" rel="noopener ugc nofollow" target="_blank"> 16S数据</a>开发的，即仅使用<a class="ae lh" href="https://en.wikipedia.org/wiki/16S_ribosomal_RNA" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> 16S核糖体RNA基因</strong> </a>。相比之下，这里我们将尝试使用<a class="ae lh" href="https://en.wikipedia.org/wiki/Shotgun_sequencing" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd"/></a><strong class="lk jd"/><a class="ae lh" href="https://en.wikipedia.org/wiki/Metagenomics" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">宏基因组学</strong> </a> <strong class="lk jd">数据</strong>来训练一个分类器。此外，SourceTracker并非设计用于<strong class="lk jd">原始宏基因组序列</strong>，而是需要以某种方式量化的微生物丰度(<a class="ae lh" href="https://en.wikipedia.org/wiki/Operational_taxonomic_unit" rel="noopener ugc nofollow" target="_blank"> OTU丰度</a>)，例如通过<a class="ae lh" href="http://qiime.org/" rel="noopener ugc nofollow" target="_blank">qime</a>管道、<a class="ae lh" href="https://huttenhower.sph.harvard.edu/metaphlan2/" rel="noopener ugc nofollow" target="_blank">meta plan 2</a>或<a class="ae lh" href="https://ccb.jhu.edu/software/kraken2/" rel="noopener ugc nofollow" target="_blank"> Kraken2 </a>。相比之下，我们将在这里训练的CNN分类器的目标是<strong class="lk jd">从</strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/FASTQ_format" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> fastq文件</strong> </a> <strong class="lk jd">预测宏基因组样本的微生物组成，而不量化微生物丰度。</strong></p><h1 id="18b3" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">人类微生物组项目(HMP)数据</h1><p id="89f1" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">为了训练CNN分类器，我们将利用巨大的<a class="ae lh" href="https://www.hmpdacc.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">人类微生物组项目(HMP) </strong> </a>数据资源。HMP提供了用<a class="ae lh" href="https://huttenhower.sph.harvard.edu/metaphlan2/" rel="noopener ugc nofollow" target="_blank">meta plan 2</a>量化的宏基因组分类丰度，可以从<a class="ae lh" href="https://www.hmpdacc.org/hmsmcp2/" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/a1817a98ae0af1105f7de438a32ff99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yve-Njc9KbjP2Nb0U-eSdw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://www.hmpdacc.org/" rel="noopener ugc nofollow" target="_blank">人类微生物组项目(HMP)门户</a></p></figure><p id="3293" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为<strong class="lk jd"> 4 </strong> <strong class="lk jd">人类</strong> <strong class="lk jd">组织</strong> <strong class="lk jd">(微生物群落):</strong> <strong class="lk jd">口腔、肠道、皮肤和阴道</strong>计算宏基因组学概况。下面，我们将使用微生物丰度矩阵来选择<strong class="lk jd">组织特异性细菌</strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/Genus" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">属</strong> </a>，即仅在四种组织中的<strong class="lk jd">一种</strong>中丰富的菌群，因此可以作为人体组织的<strong class="lk jd">微生物制造者</strong>。稍后，我们将使用组织特异性细菌属的<strong class="lk jd">参考基因组</strong>来训练CNN分类器<strong class="lk jd">从</strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/FASTQ_format" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> fastq文件</strong> </a>中的<strong class="lk jd">原始序列中识别</strong>微生物群落(口腔、肠道、皮肤、阴道)。我们将从读取微生物丰度矩阵开始，并通过降维图(<a class="ae lh" href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="noopener ugc nofollow" target="_blank"> PCA </a>和<a class="ae lh" href="https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding" rel="noopener ugc nofollow" target="_blank"> tSNE </a>)可视化来自4个人体组织的样本。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/e30107718783f68fb00b9712d07a2bbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wd1laD_VBr5hHN6GNmCTFw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/e1cb8034f113800c8ab402c883f64007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKVACYtZFlTJWzubGveplQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="4ad1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在PCA和tSNE图中，我们可以看到，就微生物丰度而言，样品可以通过原始组织清楚地分开。这意味着训练CNN分类器应该是非常简单的，它可以通过检查样品中的微生物DNA序列来预测给定样品的来源组织。然而，为了制作PCA和tSNE图，我们使用了<strong class="lk jd">微生物丰度</strong>而不是测序数据本身，因此我们必须首先提取能够最好地分离肠道、口腔、皮肤<strong class="lk jd"> </strong>和<strong class="lk jd"> </strong>阴道样品的微生物。<strong class="lk jd">来自最具鉴别能力的微生物的参考基因组</strong>将在稍后用于为CNN分类器创建序列的<strong class="lk jd">训练数据集。</strong></p><h1 id="c6bd" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">选择组织特异性微生物</h1><p id="87a8" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">为了选择能够最好地分离<strong class="lk jd"/><strong class="lk jd">肠道、口腔、皮肤</strong>和<strong class="lk jd">阴道</strong>样本的微生物，我们可以训练例如<strong class="lk jd">随机森林</strong>分类器，并查看<strong class="lk jd">特征重要性</strong>及其作用方向。然而，这里看起来有大量的<strong class="lk jd">组织特异性</strong>微生物，即在一个组织中丰度很高但在所有其他组织中几乎为零的微生物。例如，如果我们观察<strong class="lk jd">副溶血性嗜血杆菌</strong>在微生物丰度数据框架中的指数为1950，那么<strong class="lk jd">看起来非常具有口腔特异性</strong>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/0c8ebd0ebab4213ec7e761713c4cf43f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pmsHLXenw4-apDFhc3YnvA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="f79d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面，为了简单起见，我们将只集中在<a class="ae lh" href="https://en.wikipedia.org/wiki/Bacteria" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">细菌微生物</strong> </a>上，即<a class="ae lh" href="https://en.wikipedia.org/wiki/Archaea" rel="noopener ugc nofollow" target="_blank">古菌</a>和<a class="ae lh" href="https://en.wikipedia.org/wiki/Virus" rel="noopener ugc nofollow" target="_blank">病毒</a>将被忽略，只有在HMP数据集<strong class="lk jd">中分类在<a class="ae lh" href="https://en.wikipedia.org/wiki/Genus" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">属级</strong> </a>上的细菌生物将被保留</strong>用于进一步分析。我们将建立<strong class="lk jd">组织特异性细菌属</strong>的列表，并将它们的名称用于<strong class="lk jd">、来自</strong><a class="ae lh" href="https://www.ncbi.nlm.nih.gov/refseq/" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">ref seq NCBI</strong></a><strong class="lk jd">数据库</strong>的“grepping”细菌参考基因组。因此，这里我们将微生物丰度的总矩阵细分为细菌属丰度，我们可以看到在HMP项目中有<strong class="lk jd"> 227个细菌属</strong>。接下来，我们将检查所有HMP细菌属，并按照<strong class="lk jd">简单标准</strong>建立<strong class="lk jd">口腔-、</strong> <strong class="lk jd">皮肤-、</strong> <strong class="lk jd">阴道- </strong>和<strong class="lk jd">肠道特异性</strong>属的列表:如果一个细菌属在一个组织中的<strong class="lk jd">比所有其他组织多10倍，则该属被认为是组织特异性的。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="eaf2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">组织特异性的简单标准<strong class="lk jd">为我们提供了<strong class="lk jd"> 61种口腔特异性、53种肠道特异性、49种皮肤特异性和16种阴道特异性细菌属</strong>。让我们从4种组织中选择一些组织特异性属，并观察其丰度:</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/97a446c74a467a8c7187456a173d6dea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i2hmra9u2OdCAc6a_NojNw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="8aed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面，我们可以清楚地看到，我们设法挑选了非常强的组织特异性细菌属标记。<strong class="lk jd">阴道的</strong>最少，为16个组织特异性属。然而，<strong class="lk jd">仔细观察</strong>，可以发现其中包括<strong class="lk jd">伯克霍尔德菌属、罗尔斯顿菌属、博德特氏菌属</strong>等可疑且极有可能是<a class="ae lh" href="https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-014-0087-z" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> PCR试剂污染物</strong> </a>。因此，我们仔细检查了16个阴道特异性细菌属的列表，由于不同的原因，我们可以确信其中只有12个<strong class="lk jd">具有阴道特异性。因此，为了在用于分类分析的组织之间保持平衡，<strong class="lk jd">我们将为4种组织中的每一种选择12种最具组织特异性的标记</strong>，这里是我们挑选的细菌属:</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/14f116556ad9d6f8fb1279a1c0311c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3tIuz5KDKzvZM3OTgn3mQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="1f7e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">经过一番思考，我决定<strong class="lk jd">将</strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/Streptococcus" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">链球菌</strong> </a> <strong class="lk jd">排除在</strong>口腔特有属列表之外。尽管链球菌属似乎是口腔特有的，但它也包括在其他组织如肠道中大量存在的种类。这可能会混淆CNN分类器，因为如果我们grep链球菌的参考基因组，我们将会得到太多来自<strong class="lk jd">肠道特异性链球菌物种</strong>的“污染”序列，然而如果假设链球菌是口腔特异性属，则会得到错误的口腔标签。请在本文的<a class="ae lh" href="https://github.com/NikolayOskolkov/DeepLearningMicrobiome" rel="noopener ugc nofollow" target="_blank">完整笔记本</a>中查看更多详细信息。</p><p id="62f7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以检查选择的微生物属可以相当好地分离口腔、肠道、皮肤和阴道样品。为此，让我们基于样品之间的<a class="ae lh" href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">【Spearman】</strong></a><strong class="lk jd"/>相关性<strong class="lk jd"> </strong>距离并使用48个选定的微生物属(4个组织中的每一个12个)来运行快速<strong class="lk jd">聚类</strong>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/c3a5f979042a7edc6304859c75b49597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJ7Nr_5DSJ7XN__8-yRnSQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="8923" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们清楚地观察到对应于来自HMP项目的口腔、肠道、皮肤和阴道样品的4个集群。最大的聚类是口腔样本，而第二大聚类对应于肠道HMP样本。</p><h1 id="ba7f" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">准备数据和训练CNN分类器</h1><p id="c159" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">现在我们将使用所选的48个组织特异性细菌属的名称，从<a class="ae lh" href="https://www.ncbi.nlm.nih.gov/refseq/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> RefSeq NCBI </strong> </a>数据库中提取所有相应的物种和菌株参考基因组id。下面的片段演示了如何下载和提取与48个挑选的组织特异性属相对应的组织特异性物种和菌株的参考基因组id。为此，我们将使用一个名称-引用-id匹配文件<strong class="lk jd"> MapBactName2ID.txt </strong>，可以从my <a class="ae lh" href="https://github.com/NikolayOskolkov/DeepLearningMicrobiome" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> github </strong> </a>下载。该文件是通过提取参考基因组的标题并将它们的文件名(GCF-id)与标题匹配而构建的。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="723a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，当我们有了对应于组织特异性属的<strong class="lk jd">参考基因组(fasta-files)id</strong>时，我们可以<strong class="lk jd">切片</strong>参考基因组并创建4组序列(例如<strong class="lk jd"> 80 nt长的</strong>)，每组对应于口腔、肠道、皮肤和阴道微生物属的<strong class="lk jd">标签为0、1、2和3。在下面的循环中，我们首先为4个组织</strong>中的每一个读取带有<strong class="lk jd">fasta id</strong><strong class="lk jd">的文件，然后为每个fasta id读取fasta文件并选择长度为80 nt的随机<strong class="lk jd"> 3000 </strong>序列。在运行过程中，我们还将<strong class="lk jd">删除包含N、H、M和其他非规范核苷酸的序列</strong>，并将我们自己限制为仅包含A、C、T和G的序列。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="0aa0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦我们创建了一个标记序列的数据集，其中每个序列都有一个对应于口腔、肠道、皮肤和阴道的标签0、1、2或3，我们就必须将这些序列转换为<strong class="lk jd"> one-hot-encoded tensor (3维numpy array) </strong>，它可以被深度学习算法(如1D CNN)读取。接下来，我们还将把一个热编码的序列分成<strong class="lk jd">训练</strong>T30】和T32】测试T34】子集。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="260e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，让我们写下一个简单的1D CNN架构，并开始训练分类器识别对应于口腔、肠道、皮肤和阴道微生物群落的4个类别的序列模式。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/ef0a413efe2ca041ffafa55882663f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uUi2t6CgORVONB0HWI8HZg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi of"><img src="../Images/ea73c3da7120e12fdc67b939ff800d63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f3POyg-wVDy0hr2WIT97Hw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="cc7c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">检查网络是否已经学会对序列进行分类的最佳方式是在新的<strong class="lk jd">测试集</strong>上评估其性能，该测试集由它在训练期间根本没有观察到的数据组成。这里，我们<strong class="lk jd">评估测试集上的模型，并将结果绘制为混淆矩阵</strong>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/2f3eca9c970eb24c1194bb4be2cd3734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*SQcI0EJMUSbQz-VDWR1qjA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/79acad22ab56e5cf967991460a52a181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pk5n0bBIZDvwVNdeBy_agA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="7335" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">混淆矩阵</strong>的图形表示是蓝色的热图，展示了一种<strong class="lk jd">块状</strong> <strong class="lk jd">结构</strong>，暗示我们的1D CNN分类器能够相当好地区分4种微生物类别。60% 的总体平均评估<strong class="lk jd">准确度乍一看似乎很低，因为我们的思维集中在一个二进制分类问题上，其中一个随机分类器可以给出50%的基本准确度。因此，我们60%的结果可能比随机分类器好一点点。但是，请记住<strong class="lk jd">我们在这里处理的是</strong><strong class="lk jd"/>的</strong> <strong class="lk jd">，因此<strong class="lk jd">一个随机分类器应该给我们25% </strong>(可以通过模拟来确认，此处未显示)的平均准确度，根据样本大小的不同，<strong class="lk jd">的标准偏差约为5-10%</strong>。因此，<strong class="lk jd"> 60%的准确度明显高于随机分类器</strong>预期的基础25% </strong> <strong class="lk jd">。此外，下面我们将使用经过训练的分类器，通过从数以千计的DNA序列</strong>中对预测 <strong class="lk jd">进行<strong class="lk jd">平均，获得微生物群落对宏基因组样本贡献的粗略估计。假设分类器的60%的准确性允许对大多数序列进行正确的预测，即使不是所有的序列都会被正确分类，这仍然会给我们一个很好的<strong class="lk jd">直觉</strong>关于样品来自什么微生物群落(口腔、肠道、皮肤或阴道)。</strong></strong></p><h1 id="8b25" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">预测微生物的组成</h1><p id="61a8" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在这里，我们将检查经过训练的CNN分类器是否可以用于<strong class="lk jd">推断随机宏基因组样本的微生物组成</strong>。为此，我们将挑选随机宏基因组fastq文件(来自HMP、<a class="ae lh" href="https://www.ebi.ac.uk/metagenomics/" rel="noopener ugc nofollow" target="_blank"> MGnify </a>或<a class="ae lh" href="https://diabimmune.broadinstitute.org/diabimmune/three-country-cohort" rel="noopener ugc nofollow" target="_blank"> DIABIMMUNE </a>数据库)，对每个宏基因组序列进行预测，并呈现分配给四个类别(口腔、肠道、皮肤和阴道)的序列的<strong class="lk jd">部分，这将大致对应于每个样品中存在的微生物群落的部分(<strong class="lk jd">微生物组成</strong>)。让我们从HMP项目的几个样本开始。我知道我们使用HMP丰度来选择组织特异性微生物标记(<strong class="lk jd">我们没有使用原始测序数据，尽管</strong>)，使用HMP fastq文件来推断它们的微生物组成可能会有偏差。然而，这是一个好的开始，至少如果CNN分类器在HMP样本上失败，很难期望它在独立样本上表现良好。稍后，我们将使用来自HMP项目以外的真正独立的宏基因组样本来重复这一推论。在下面的循环中，我读取了<strong class="lk jd"> HMP fastq-files </strong>(我从口腔、肠道(粪便)、皮肤和阴道<a class="ae lh" href="https://en.wikipedia.org/wiki/Cotton_swab" rel="noopener ugc nofollow" target="_blank">拭子</a>中随机选取了2个样本，<strong class="lk jd"> one-hot-encode </strong>它们的序列，并使用训练过的CNN分类器</strong>运行<strong class="lk jd">预测。接下来，我选择最可靠的预测，其中一个微生物群落有至少80%的概率。最后，我绘制了分类器分配给每个微生物群落的序列片段。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/f81528f5f0d7f15a77a94ca3a08648b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MFCJbhLbp2de-PVbATYlmg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/1b069f1afff133b78f435048114d67d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRE08r84oCeN0VwcKQO7Kw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="0224" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以看到，对于每个随机HMP样本，我们都得到了相当好的预测<strong class="lk jd">，即<strong class="lk jd">前两个看起来很像口腔</strong>样本，因为口腔微生物(蓝条)构成了大多数微生物群落，而后两个看起来像肠道样本等。标签“口服_”、“肠道_”等。对于上图底部的每个样本，指出在HMP项目中收集样本的<strong class="lk jd">真实组织</strong>。</strong></p><p id="bab1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">总之，我们使用HMP项目中不同组织中丰富的微生物参考基因组序列训练了一个CNN分类器。之后，我们继续在几个随机的HMP样本上评估模型。你大概可以在这里看到<strong class="lk jd">一个可能的问题</strong>。一方面，当训练CNN分类器时，我们没有使用来自HMP样本的<strong class="lk jd">原始序列，而是使用HMP数据中最丰富的属的参考基因组。另一方面，仍然有一个<strong class="lk jd">信息泄露</strong>，因为我们仍然使用<strong class="lk jd">相同的项目</strong>(尽管不同类型的数据)进行训练和测试。因此，评估可能仍然有偏见，看起来好得不真实。为了进行更好的评估，我们将从宏基因组学项目中随机挑选8个与HMP无关的口腔、肠道、皮肤和阴道样本。</strong></p><p id="024a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们将对一些与HMP样品不同的宏基因组样品进行微生物组成推断。<strong class="lk jd">粪便/肠道</strong>样本可以从<a class="ae lh" href="https://diabimmune.broadinstitute.org/diabimmune/three-country-cohort" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">糖尿病</strong> </a> <strong class="lk jd"> e </strong>项目中获取，这里是<a class="ae lh" href="https://diabimmune.broadinstitute.org/diabimmune/three-country-cohort/resources/metagenomic-sequence-data" rel="noopener ugc nofollow" target="_blank">文件</a>。<strong class="lk jd">口腔</strong>宏基因组样本从<a class="ae lh" href="https://www.ebi.ac.uk/metagenomics/studies/MGYS00005592" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> WGS口腔微生物组</strong> </a> <strong class="lk jd"> </strong>项目下载，这里有<a class="ae lh" href="https://www.ebi.ac.uk/ena/browser/view/PRJEB36291?show=reads" rel="noopener ugc nofollow" target="_blank">文件</a>和<a class="ae lh" href="https://bmcmicrobiol.biomedcentral.com/articles/10.1186/s12866-020-01801-y" rel="noopener ugc nofollow" target="_blank">出版物</a>。<strong class="lk jd">皮肤</strong>样本从<a class="ae lh" href="https://www.ebi.ac.uk/metagenomics/studies/MGYS00005533" rel="noopener ugc nofollow" target="_blank"> MGnify </a> <strong class="lk jd"> </strong>资源下载，该资源由<strong class="lk jd"> EBI </strong>提供，来自项目“<a class="ae lh" href="https://www.ebi.ac.uk/metagenomics/studies/MGYS00005533" rel="noopener ugc nofollow" target="_blank">农村和城市环境</a>中儿童和青少年的皮肤微生物群模式不同”，文件可从<a class="ae lh" href="https://www.ebi.ac.uk/ena/browser/view/PRJEB14627?show=reads" rel="noopener ugc nofollow" target="_blank">此处</a>获得。<strong class="lk jd">阴道</strong>拭子样本在<a class="ae lh" href="https://www.ebi.ac.uk/metagenomics/studies/MGYS00005266" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> MOMS-PI </strong> </a>项目中排序，可以从<a class="ae lh" href="https://www.ebi.ac.uk/ena/browser/view/PRJNA326441?show=reads" rel="noopener ugc nofollow" target="_blank">这里</a>检索。</p><p id="c7b7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将对非HMP样本应用与上述HMP样本相同的循环，只有<strong class="lk jd">一处不同</strong>。我们需要始终控制在应用概率截止值(这里是90%)后，我们仍然得到足够的序列来计算微生物群落的比例。这里我要求，如果我们没有至少500个序列(这对于一些随机的非HMP样本是真实的，因为它们的测序深度低)，概率阈值将从0.9降低到0.6。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/614c6c9352ea65c2328b374d41bce353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4wb4xOy-NjK1DTN5HrYb8g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/3d36e2f24f34c4466e7ae296c44c38fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nsbAypP-cTnA2Cef4Jt9Aw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="9903" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这里，我们再次看到对8个非HMP样本中的微生物组成的预测<strong class="lk jd">与样本所来自的真实口腔、肠道、皮肤和阴道微生物群落相当一致</strong>。干得好！我们训练过的CNN分类器可能可以对任何给定样品的微生物组成提供有意义的估计。</p><h1 id="61f6" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">摘要</h1><p id="1a51" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在本文中，我们了解到<strong class="lk jd">宏基因组学</strong>代表了一种适用于<strong class="lk jd">机器和深度学习</strong>分析的大数据。我们利用了来自<strong class="lk jd">人类微生物组项目(HMP) </strong>的宏基因组学数据，并开发了一个1D CNN分类器，该分类器可以从标准<strong class="lk jd"> fastq </strong>数据格式的<strong class="lk jd">原始序列</strong>开始，成功预测不同微生物群落(<strong class="lk jd">口腔、肠道、皮肤或阴道</strong>)对给定样本的贡献，而无需对微生物丰度进行量化。与使用<strong class="lk jd"> SourceTracker </strong>的标准微生物组成推断相比，该方法可能具有优势。</p><p id="a64b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">像往常一样，让我在评论中知道你最喜欢的<strong class="lk jd">生命科学</strong>领域，你希望在深度学习框架内解决这个问题。在Medium <a class="np nq ep" href="https://medium.com/u/4bcf4e21313e?source=post_page-----7854fba815fc--------------------------------" rel="noopener" target="_blank">关注我，在Twitter @NikolayOskolkov关注我，在Linkedin </a>关注我。完整的Jupyter笔记本可以在我的<a class="ae lh" href="https://github.com/NikolayOskolkov/DeepLearningMicrobiome" rel="noopener ugc nofollow" target="_blank"> github </a>上找到。我计划写下一篇关于<strong class="lk jd">如何用深度学习</strong>及时预测人口规模的帖子，敬请关注。</p></div></div>    
</body>
</html>