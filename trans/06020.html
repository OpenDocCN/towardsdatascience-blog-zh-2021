<html>
<head>
<title>Gaussian Smoothing in Time Series Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列数据的高斯平滑</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gaussian-smoothing-in-time-series-data-c6801f8a4dc3?source=collection_archive---------4-----------------------#2021-05-30">https://towardsdatascience.com/gaussian-smoothing-in-time-series-data-c6801f8a4dc3?source=collection_archive---------4-----------------------#2021-05-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="423d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用Python学习时间序列数据中高斯平滑的内部工作原理</h2></div><h1 id="1bef" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">时序数据</h1><p id="e7ea" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">顾名思义，时间序列数据是时间索引数据。数据点是在不同的时间戳收集的。通常，我们会在x轴上显示小时、天或年等时间变量，在y轴上显示我们正在收集的数据。时间序列数据的一个例子是相对于天数的新新冠肺炎病例数。</p><h2 id="efc9" class="lt kg iq bd kh lu lv dn kl lw lx dp kp lg ly lz kr lk ma mb kt lo mc md kv me bi translated">观察数据与真实数据</h2><p id="c790" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">观察数据是我们观察到的数据点。它们是数据生成/报告过程的结果。另一方面，真实的数据是真相，是世界上正在发生的事情的真实价值。让我用新冠肺炎新案例的例子来区分一下。每天出现的新病例是<em class="mf">报告的</em>新病例。它们可能不等于真正的新病例数。这是因为一些新案例可能没有被报告，一些积压的案例可能已经被添加到今天的新案例中。</p><p id="fffb" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">下面，我们看到<em class="mf">尼*的新增病例</em>的时序图。我们注意到少数地方突然出现峰值和下降，这可能是报告不足和/或报告积压的结果。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ml"><img src="../Images/cf824553bcfbcff4a158dd1736460c84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bj9-m563TUZ6qd3JLWLBQQ.png"/></div></div></figure><p id="a0f5" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">因此，在处理这些数据时，减少噪音是有帮助的。通过将数据点与其相邻数据点进行平均来减少此类时间序列数据中的噪声的过程称为平滑。有许多技术可以降低噪声，如简单移动平均、加权移动平均、核平滑器等。我们将学习并应用<em class="mf">高斯核平滑器</em>进行平滑或去噪。</p><h1 id="2907" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">高斯核</h1><p id="62d7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">核定义了用于取相邻点平均值的函数的形状。高斯核具有高斯曲线的形状。高斯曲线具有以下形状:</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/ec449157ee87a5db0fc1e291b4744acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4DbJwmwJlGhvi35L1Inh0Q.png"/></div><p class="my mz gj gh gi na nb bd b be z dk translated">来源:维基共享资源</p></figure><p id="75f0" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">正如在高斯曲线中看到的，近点(在上面的曲线中大约为0)将被赋予更高的权重，而远点将被赋予更低的权重。</p><p id="48f7" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">高斯核的数学表达式如下所示:</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nc"><img src="../Images/f690fae35c99c0fe772ad0e0d79a4cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fewub3dv1RKKJyEIzvqPEQ.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">来源:<a class="ae nd" href="https://en.wikipedia.org/wiki/Kernel_smoother" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><p id="be52" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">其中，<em class="mf"> b </em>定义内核的宽度。</p><h1 id="5b5a" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">平滑过程</h1><p id="5c3c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了进行平滑，我们逐点处理数据。对于每个点，我们计算核函数值，并计算由核函数值加权的数据点的加权平均值。</p><p id="da6b" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">这里用一个例子来理解一下。我们采用之前显示的尼泊尔COVID新病例数据。</p><p id="8637" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">2020年<em class="mf">10月27日</em>新增病例数为<em class="mf"> 570例</em>，而前一天新增病例数为<em class="mf"> 1741例</em>，后一天新增病例数为1954例。570不太可能是当天新增病例的真实数字。让我们尝试使用高斯核平滑器来平滑新的案例数。</p><p id="430d" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">首先，我们来计算基于<em class="mf">2020年10月27日</em>的高斯核值。</p><figure class="mm mn mo mp gt mq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="9ca8" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">我们这里任意取了<em class="mf"> b </em> = <em class="mf"> 2 </em>。我们认为+2/-2天的高斯核宽度占用了很大比例的邻居数据。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ml"><img src="../Images/0d761776b28a01cf955930776261c014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3i0Yjy0f6ap3fiN0DG0B9Q.png"/></div></div></figure><p id="d80c" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">上图显示了与日期相关的高斯核值。精确日期和邻近日期被赋予最高权重(接近1)，而较远的日期被赋予接近0的权重值。</p><p id="ae6a" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">我们将核值标准化，这样我们就不会增加新的案例数量。我们通过将高斯核值除以所有高斯核值的总和来实现。然后，我们将<em class="mf">新案例</em>列与<em class="mf">高斯核值</em>列进行逐元素相乘，并将它们相加，以获得<em class="mf">平滑后的</em>案例数。</p><figure class="mm mn mo mp gt mq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="95c2" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">我们得到平滑后的病例数:<em class="mf"> 2036 </em>。当日报告病例数为<em class="mf"> 570 </em>。我们预计平滑会增加当天的病例数，事实也确实如此。这样，我们可以减少数据中存在的噪声，使其看起来更加平滑。</p><p id="42ca" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">让我们对所有的数据点进行平滑处理。</p><figure class="mm mn mo mp gt mq"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="98da" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">我们完成了将<em class="mf">高斯核平滑</em>应用于新病例的数量。让我们看看新的平滑后的新案例数与以前的新案例数相比如何。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ml"><img src="../Images/79c12c4bf3199a0c41b04f136de62a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*civVTiyprOQp_LJGAgIXlg.png"/></div></div></figure><p id="258a" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">我们可以在上面的图中看到平滑的线几乎没有噪音。平滑减弱了急剧下降和峰值。因此，我们使用高斯核平滑器实现了我们想要做的。选择<em class="mf"> b </em>对我们得到的平滑程度有影响。如果我们将<em class="mf"> b </em>增加到<em class="mf"> 4 </em>，我们会得到更平滑的数据。然而，我们应该小心选择更高的<em class="mf"> b </em>值，因为重要的尖峰、下降可能会丢失。让我们看看<em class="mf"> b </em>的值等于<em class="mf"> 4 </em>的平滑图。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ml"><img src="../Images/24be4dd047faaa08e9a108f1a5bf455e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_KkanwmFcWRBsfc0xoVRA.png"/></div></div></figure><p id="e17c" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">正如所料，我们得到了一个更平滑的图形。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="b410" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">我们理解了高斯内核平滑器的内部工作原理，甚至看到了它在Python中的实现。我们在平滑的时候调整了超参数<em class="mf"> b </em>并且看到了它的效果。我们了解到超参数<em class="mf"> b </em>应该仔细选择。</p><p id="d9a4" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated">如果您正在尝试对时间序列数据进行建模，平滑可能是您想要尝试的第一件事，因为它可以减少噪音并可能使您的模型更好。继续平滑，继续建模！此外，在新冠肺炎期间保持距离，并采取预防措施以保持安全。:)</p><p id="3fdc" class="pw-post-body-paragraph kx ky iq kz b la mg jr lc ld mh ju lf lg mi li lj lk mj lm ln lo mk lq lr ls ij bi translated"><em class="mf">*尼泊尔的COVID数据取自数据</em>  <em class="mf">中的</em> <a class="ae nd" href="https://ourworldindata.org/covid-vaccinations" rel="noopener ugc nofollow" target="_blank"> <em class="mf">我们的世界。</em></a></p></div></div>    
</body>
</html>