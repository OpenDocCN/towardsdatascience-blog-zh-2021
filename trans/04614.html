<html>
<head>
<title>We Did a One Round Data Science Competition and This Happened!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们进行了一轮数据科学竞赛，结果发生了这种情况！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/we-did-a-one-round-data-science-competition-and-this-happened-c17ecff16c6d?source=collection_archive---------34-----------------------#2021-04-20">https://towardsdatascience.com/we-did-a-one-round-data-science-competition-and-this-happened-c17ecff16c6d?source=collection_archive---------34-----------------------#2021-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5334" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">预测鱼量的简单与复杂模型</h2></div><p id="5fd0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作者:<a class="ae le" href="https://www.linkedin.com/in/edkrueger/" rel="noopener ugc nofollow" target="_blank">爱德华·克鲁格</a>和<a class="ae le" href="https://www.linkedin.com/in/dougaf/" rel="noopener ugc nofollow" target="_blank">道格拉斯·富兰克林</a>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/91e97373bba2488e4d5ecb42fc19e190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ln7ub7ScvRPrxPWtdSyaRA.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@mike_swigunski?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">迈克·斯威肯斯基</a>在<a class="ae le" href="https://unsplash.com/s/photos/fish-market?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="518c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lv">本文将讨论我们与一个班级举办的数据科学竞赛。我们将讨论五个得分最高的模型及其复杂性。</em></p><h1 id="c0c3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">介绍</h1><p id="db5a" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">挑战在于创建一个预测鱼体重的机器学习模型。其模型具有最低均方误差(MSE)的学生将被宣布为获胜者！</p><h1 id="cdae" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">挑战</h1><blockquote class="mt mu mv"><p id="23e2" class="ki kj lv kk b kl km ju kn ko kp jx kq mw ks kt ku mx kw kx ky my la lb lc ld im bi translated">你好！欢迎来到日本东京著名的筑地鱼市场！我们来这里收集他们的鱼的数据，但我们没有在早上5点醒来参加金枪鱼拍卖。当我们出现的时候，只剩下一些种类的鱼了。我们收集了剩余鱼的测量值，并希望您使用这些特征训练一个回归模型来预测鱼的重量。</p><p id="a6d1" class="ki kj lv kk b kl km ju kn ko kp jx kq mw ks kt ku mx kw kx ky my la lb lc ld im bi translated">我们将拿出30%的数据，并使用该csv进行评分。我们将根据他们的模型在这些原始数据上预测体重的表现对学生进行排名。分数将根据均方差排名决定。</p></blockquote><p id="3f75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一场一次性比赛。不允许调整模型。也就是说，有一次提交模型的机会，我们将使用它尚未看到的维持数据来度量它。</p><p id="c39d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我们的鱼类数据。在训练数据集中的112行中有7个特征。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mz"><img src="../Images/8c5a5e340d4dcfa142d62295dabd409d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rWfHM6Cv0PJwNi8GPWdBWA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">鱼类数据</p></figure><p id="b181" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下图显示了鱼的长度。这样，我们可以理解长度1-3。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0c3e708e325f263725b3158270de2430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/1*5-s8PXUhC8gblVyWYk3X8w.gif"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">测量一条鱼</p></figure><p id="9d66" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">高度是从鱼的腹部到最厚处的脊骨。宽度是周长的度量。重量以克为单位，长度以厘米为单位。如果你感兴趣，这里有一个数据集的链接！</p><div class="nb nc gp gr nd ne"><a href="https://www.kaggle.com/aungpyaeap/fish-market" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd iu gy z fp nj fr fs nk fu fw is bi translated">鱼市</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">鱼市常见鱼种数据库</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">www.kaggle.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns lp ne"/></div></div></a></div><p id="3003" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看前5名学生模型(按MSE排名)及其方法论。</p><h1 id="dc25" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">前5名模特</h1><p id="37ee" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">即使只上了一周的机器学习课程，我们的学生也想出了一些创造性的解决方案！值得注意的是，排名前五的模型要么都是决策树，要么都是随机森林和线性回归模型。这些模型相对简单，有很强的偏向性。线性回归假设一个线性问题。决策树更加灵活，并假设一个逐步的功能。决策树经常过度拟合它们的训练数据，但是随机森林可以在建立模型时减轻这种风险。</p><p id="b640" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们看看我们的前五名学生模特！</p><h2 id="3596" class="nt lx it bd ly nu nv dn mc nw nx dp mg kr ny nz mi kv oa ob mk kz oc od mm oe bi translated">第五名——2659毫秒</h2><p id="270b" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">我们的第五名选手使用了一个带有一些附加功能的决策树。这些增加的特征之一是椭球的体积。这个几何特征试图捕捉鱼的形状。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/9c90de33feae15c0369c621621400155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*bgJdvbOboKyBNM1h_mnh7w.jpeg"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">约翰·卡梅隆在Unsplash上拍摄的照片</p></figure><p id="a310" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这名学生还选择使用梯度助推器。梯度推进是一种在决策树集合中产生预测模型的技术。这被称为梯度增强树，通常优于随机森林。它像其他boosting方法一样以分阶段的方式构建模型，并通过允许优化任意可微分损失函数<strong class="kk iu">来推广它们。</strong></p><p id="6544" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这位学生的增加了几何特征的梯度提升树获得了2659的MSE，为他们赢得了前5名的成绩。</p><h2 id="ef27" class="nt lx it bd ly nu nv dn mc nw nx dp mg kr ny nz mi kv oa ob mk kz oc od mm oe bi translated">第四名——2332毫秒</h2><p id="8f93" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">我们的第四名学生编写了可能是最优雅的解决方案。这名学生将原始特征输入线性回归模型，得出MSE为2332。这种易于实施且简单明了的模型胜过了90%的学生模型，获得了第4名！</p><p id="0ca8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">线性回归，通常被认为是一个简单的机器学习模型，永远不应该被低估。</p><h2 id="2544" class="nt lx it bd ly nu nv dn mc nw nx dp mg kr ny nz mi kv oa ob mk kz oc od mm oe bi translated">第三名——2163毫秒</h2><p id="2496" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">排名第三的完成者建立了一个线性回归模型，增加了一些功能，并使用了LassoCV。额外的特征是长度和长度的二次项之间的差异。</p><p id="4305" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">套索回归是一种使用收缩的线性回归。收缩是指数值向一个中心点收缩。套索程序鼓励使用较少参数的模型。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/b926272642712f9f0437a24932815620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*eHp3JwaO5beap7if0hvVEw.jpeg"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">engin akyurt在Unsplash上拍摄的照片</p></figure><p id="ab65" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种特殊类型的回归非常适合显示高度多重共线性的模型(如我们的鱼类数据！).Lasso回归具有自动内生最佳子集选择的额外好处。当向您的训练数据中添加许多附加功能时，这个自动化功能非常有用！</p><p id="3931" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个学生用LassoCV建立的线性回归模型产生了2163的MSE，获得了第三名。</p><h2 id="c7cf" class="nt lx it bd ly nu nv dn mc nw nx dp mg kr ny nz mi kv oa ob mk kz oc od mm oe bi translated">第二名——2034毫秒</h2><p id="563e" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">我们的第二名学生也使用了线性回归模型，并添加了几个几何特征来捕捉鱼的形状。三个增加的变量是h*w和l3**2和(l3**2)*h*w。这些变量代表从头到尾穿过鱼的矩形平面、穿过l3的正方形平面和围绕整条鱼的盒子。</p><p id="8ac1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个简单的模型加上一些几何推理产生了2034的MSE和第二名的成绩！</p><p id="f5d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">*戏剧性的鼓声*</p><h2 id="0783" class="nt lx it bd ly nu nv dn mc nw nx dp mg kr ny nz mi kv oa ob mk kz oc od mm oe bi translated">第一名——802毫秒</h2><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/95e79b0ee95db609e1184f82d4c48de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*bUi3hQLj6HsF2EM9D3X-DQ.jpeg"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">干杯！乔治·特罗瓦托在<a class="ae le" href="https://unsplash.com/s/photos/first-place?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7a6f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的第一名选手使用了隔离森林。隔离森林是一种异常检测算法，其工作原理是隔离异常值。剔除异常值可能是将该模型提升到首位的关键特性！通过从训练集中分离出异常值，这名学生建立了一个比同龄人更准确的模型。</p><p id="ae2d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个学生还使用了一个额外的树回归变量。该回归器随机生成决策树，然后使用平均来提高预测精度和控制过拟合。</p><p id="c04e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这款车型的MSE得分为802，远低于其他前5名选手！</p><h1 id="9e9d" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="022f" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">注意，这里使用的所有模型都相对简单。所有五个顶级模型都没有很大的灵活性。这对这个问题很好，因为我们可以假设鱼的大小和质量之间的线性关系。超过一定程度的灵活性，您将得到在新数据上表现不佳的模型。</p><p id="f3ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在竞赛环境中，学生通常会过度设计(和过度拟合)模型，特别是当给定100%的数据来训练模型和多次提交尝试时。通过保留30%的数据并只允许一次提交，我们试图减少这种行为。</p><p id="206a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">复杂的模型并不是天生更好的模型。当用新数据进行测试时，复杂模型的表现往往不如简单模型。以我们的第四名模型为例。它需要最少的工程。简单的线性回归与原来的功能！没有花费额外的时间来设计额外的功能或使用各种回归优化模型，该模型的表现超过了班上90%的学生。</p></div></div>    
</body>
</html>