<html>
<head>
<title>Train all Classification or Regression models in one line of Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在一行Python代码中训练所有分类或回归模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/train-all-classification-or-regression-models-in-one-line-of-python-code-4ccdcaf01f0c?source=collection_archive---------5-----------------------#2021-05-09">https://towardsdatascience.com/train-all-classification-or-regression-models-in-one-line-of-python-code-4ccdcaf01f0c?source=collection_archive---------5-----------------------#2021-05-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="80e5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用lazypredict进行自动化模型训练</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b723e8d836b8ba61dda7cede81409217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MnS7O_AfBDcaPIren5marQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/mohamed_hassan-5229782/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6038877" rel="noopener ugc nofollow" target="_blank">穆罕默德·哈桑</a>来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6038877" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="ff94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自动化机器学习(Auto-ML)是指自动化数据科学模型开发管道的组件。AutoML减少了数据科学家的工作量，加快了工作流程。AutoML可用于自动化各种管道组件，包括数据理解、EDA、数据处理、模型训练、超参数调整等。</p><p id="3a62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于端到端的机器学习项目，每个流水线组件的复杂度取决于项目。有各种各样的AutoML开源库可以加速每个管道组件。阅读<a class="ae ky" href="https://medium.com/swlh/8-automl-libraries-to-automate-machine-learning-pipeline-3da0af08f636" rel="noopener">这篇文章</a>了解8个这样的AutoML库，实现机器学习流水线的自动化。</p><p id="a8d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论如何使用开源Python库LazyPredict来自动化模型训练过程。</p><h1 id="4e02" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是LazyPredict？</h1><p id="bf61" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">LazyPredict是一个开源的Python库，它自动化了模型训练管道，加快了工作流的速度。LazyPredict为分类数据集训练大约30个分类模型，为回归数据集训练大约40个回归模型。</p><p id="1119" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">LazyPredict返回经过训练的模型及其性能指标，而无需编写太多代码。人们可以比较每个模型的性能指标，并调整最佳模型以进一步提高性能。</p><h2 id="d905" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">安装:</h2><p id="e026" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">LazyPredict可以使用以下代码从PyPl库安装:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="d2d0" class="ms lw it nf b gy nj nk l nl nm"><strong class="nf iu">pip install lazypredict</strong></span></pre><p id="08cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装后，可以导入库来执行分类和回归模型的自动训练。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="9f4e" class="ms lw it nf b gy nj nk l nl nm"><strong class="nf iu">from lazypredict.Supervised import LazyRegressor, LazyClassifier</strong></span></pre><h1 id="8b70" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用法:</h1><p id="2dcd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">LazyPredict支持分类和回归问题，因此我将讨论这两项任务的演示</p><blockquote class="nn no np"><p id="17c7" class="kz la nq lb b lc ld ju le lf lg jx lh nr lj lk ll ns ln lo lp nt lr ls lt lu im bi translated">Boston Housing(回归)和Titanic(分类)数据集用于LazyPredict库的演示。</p></blockquote><h2 id="0ea1" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">分类任务:</h2><p id="d50e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">LazyPredict的用法非常直观，类似于scikit-learn。首先，为分类任务创建一个估计器<code class="fe nu nv nw nf b"><strong class="lb iu">LazyClassifier</strong></code> <strong class="lb iu"> </strong>的实例。用户可以通过自定义指标进行评估，默认情况下，将对每个模型的准确性、ROC AUC得分、F1得分进行评估。</p><p id="a7fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在进行lazypredict模型训练之前，必须读取数据集并对其进行处理，以使其适合训练。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)，Titanic数据集处理</p></figure><p id="2bc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在特征工程和将数据分割成训练测试数据之后，我们可以使用LazyPredict继续进行模型训练。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="4b05" class="ms lw it nf b gy nj nk l nl nm"># LazyClassifier Instance and fiting data<strong class="nf iu"><br/>cls= LazyClassifier(ignore_warnings=False, custom_metric=None)<br/>models, predictions = cls.fit(X_train, X_test, y_train, y_test)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/e5e96d5d7d622f079c1e946dc2012596.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*utWDPURMRbuzzY9F4M1GFg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，泰坦尼克号数据集的27个分类模型的性能指标</p></figure><h2 id="8197" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">回归任务:</h2><p id="239e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">与分类模型训练类似，LazyPredict附带了针对回归数据集的自动化模型训练。实现类似于分类任务，只是实例<code class="fe nu nv nw nf b"><strong class="lb iu">LazyRegressor</strong></code>有所变化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)，波士顿住房数据集处理</p></figure><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="2cae" class="ms lw it nf b gy nj nk l nl nm"><strong class="nf iu">reg = LazyRegressor(ignore_warnings=False, custom_metric=None)<br/>models, predictions = reg.fit(X_train, X_test, y_train, y_test)</strong></span></pre><div class="kj kk kl km gt ab cb"><figure class="oa kn ob oc od oe of paragraph-image"><img src="../Images/f1c9a09ec6497a7f68a03980471cdaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*bCfIGmt25DUIMSLvI8vxww.png"/></figure><figure class="oa kn og oc od oe of paragraph-image"><img src="../Images/e37531b7ca699fa3a62853b201c1129c.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*-RdVZmnWYM7-qQ1KdHN5ww.png"/><p class="ku kv gj gh gi kw kx bd b be z dk oh di oi oj translated">(图片由作者提供)，波士顿住房数据集的42个回归模型的性能指标</p></figure></div><p id="b72f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">观察上述性能指标，AdaBoost分类器是分类任务的最佳性能模型，而GradientBoostingRegressor模型是回归任务的最佳性能模型。</p><h1 id="4ce2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论:</h1><p id="0c0f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们讨论了LazyPredict库的实现，它可以用几行Python代码训练大约70个分类和回归模型。这是一个非常方便的工具，因为它提供了模型性能的总体情况，并且可以比较每个模型的性能。</p><p id="ee8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个模型都使用其默认参数进行训练，因为它不执行超参数调整。在选择了性能最佳的模型之后，开发人员可以调整模型以进一步提高性能。</p><p id="43f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">阅读下面提到的文章中的<a class="ae ky" href="https://medium.com/swlh/8-automl-libraries-to-automate-machine-learning-pipeline-3da0af08f636" rel="noopener">可以知道8个类似于LazyPredict的AutoML库。</a></p><div class="ok ol gp gr om on"><a href="https://medium.com/swlh/8-automl-libraries-to-automate-machine-learning-pipeline-3da0af08f636" rel="noopener follow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">8个自动化机器学习管道的AutoML库</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">各种AutoML框架概述</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">medium.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ks on"/></div></div></a></div><h1 id="1524" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考资料:</h1><p id="aee0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">[1] LazyPredict文档:<a class="ae ky" href="https://pypi.org/project/lazypredict/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/lazypredict/</a></p><blockquote class="pc"><p id="383a" class="pd pe it bd pf pg ph pi pj pk pl lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>