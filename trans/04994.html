<html>
<head>
<title>Stop using SMOTE to handle all your Imbalanced Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止使用SMOTE处理所有不平衡的数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stop-using-smote-to-handle-all-your-imbalanced-data-34403399d3be?source=collection_archive---------4-----------------------#2021-05-02">https://towardsdatascience.com/stop-using-smote-to-handle-all-your-imbalanced-data-34403399d3be?source=collection_archive---------4-----------------------#2021-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="47dd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">过采样和欠采样技术的结合</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/22bd05125391453cbe2cecf77cd65b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHRCYysQXTdolsYPLaCu5g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">弗兰基·查马基在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9657" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在分类任务中，可能会遇到目标类别标签分布不均匀的情况。这样的数据集可以称为不平衡数据。数据中的不平衡可能会阻碍数据科学模型的训练。在不平衡类问题的情况下，模型主要在多数类上训练，并且模型变得偏向多数类预测。</p><p id="a74b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在进行建模管道之前，处理不平衡类是至关重要的。有各种类平衡技术通过生成少数类的新样本或移除一些多数类样本来解决类不平衡的问题。处理类平衡技术可以大致分为两类:</p><ul class=""><li id="4052" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">过采样技术:</strong>过采样技术是指创建人为的少数类点。一些过采样技术有<a class="ae ky" href="http://glemaitre.github.io/imbalanced-learn/generated/imblearn.over_sampling.RandomOverSampler.html#imblearn.over_sampling.RandomOverSampler" rel="noopener ugc nofollow" target="_blank">随机过采样</a>、<a class="ae ky" href="http://glemaitre.github.io/imbalanced-learn/generated/imblearn.over_sampling.ADASYN.html#imblearn.over_sampling.ADASYN" rel="noopener ugc nofollow" target="_blank"> ADASYN </a>、<a class="ae ky" href="http://glemaitre.github.io/imbalanced-learn/generated/imblearn.over_sampling.SMOTE.html#imblearn.over_sampling.SMOTE" rel="noopener ugc nofollow" target="_blank"> SMOTE </a>等。</li><li id="6410" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">欠采样技术:</strong>欠采样技术是指去除多数类点。一些过采样技术有<a class="ae ky" href="http://glemaitre.github.io/imbalanced-learn/generated/imblearn.under_sampling.EditedNearestNeighbours.html#imblearn.under_sampling.EditedNearestNeighbours" rel="noopener ugc nofollow" target="_blank"> ENN </a>、<a class="ae ky" href="http://glemaitre.github.io/imbalanced-learn/generated/imblearn.under_sampling.RandomUnderSampler.html#imblearn.under_sampling.RandomUnderSampler" rel="noopener ugc nofollow" target="_blank">随机欠采样</a>、<a class="ae ky" href="http://glemaitre.github.io/imbalanced-learn/generated/imblearn.under_sampling.TomekLinks.html#imblearn.under_sampling.TomekLinks" rel="noopener ugc nofollow" target="_blank"> TomekLinks </a>等。</li></ul><blockquote class="mj mk ml"><p id="e9e8" class="kz la mm lb b lc ld ju le lf lg jx lh mn lj lk ll mo ln lo lp mp lr ls lt lu im bi translated">阅读下面提到的文章中的<a class="ae ky" rel="noopener" target="_blank" href="/7-over-sampling-techniques-to-handle-imbalanced-data-ec51c8db349f">来了解处理类不平衡问题的7种过采样技术。</a></p></blockquote><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/7-over-sampling-techniques-to-handle-imbalanced-data-ec51c8db349f"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">7处理不平衡数据的过采样技术</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">各种过采样技术的深度分析</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ks mt"/></div></div></a></div><p id="2a9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用欠采样技术的缺点是，为了平衡类，我们丢失了许多多数类数据点。过采样技术弥补了这一缺点，但在少数类中创建多个样本可能会导致模型过拟合。</p><p id="40a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SMOTE是数据科学家社区中流行和著名的过采样技术之一，它在少数类样本的聚类中创建人工少数数据点。其思想是将过采样和欠采样技术结合起来，并且一起可以被认为是处理不平衡类数据的另一种采样技术。</p><h1 id="60c1" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">过采样和欠采样技术的结合:</h1><p id="ec7f" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">SMOTE是著名的过采样技术之一，在处理类不平衡方面非常有效。其思想是将SMOTE与一些欠采样技术(ENN、托梅克)相结合，以提高处理不平衡类的效率。</p><p id="2194" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SMOTE和欠采样技术结合的两个例子是:</p><ul class=""><li id="fa8d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">击杀ENN </strong></li><li id="20d4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">用托梅克击杀</strong></li></ul><p id="d681" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在将SMOTE与欠采样技术结合起来之前，我们先来讨论一下什么是SMOTE以及它是如何工作的。</p><h2 id="cb63" class="of nj it bd nk og oh dn no oi oj dp ns li ok ol nu lm om on nw lq oo op ny oq bi translated">什么是击打？</h2><p id="b9b6" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">SMOTE代表合成少数过采样技术，是一种创建合成少数类数据点以平衡数据集的过采样技术。</p><p id="2d21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SMOTE使用k-最近邻算法来创建合成数据点。SMOTE算法的步骤是:</p><ol class=""><li id="d524" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu or mb mc md bi translated">识别少数类向量。</li><li id="f65b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu or mb mc md bi translated">决定最接近的数字(k)的数目，以供考虑。</li><li id="48cb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu or mb mc md bi translated">计算少数数据点与其任何相邻数据点之间的连线，并放置一个合成点。</li><li id="bed3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu or mb mc md bi translated">对所有少数数据点及其k个邻居重复步骤3，直到数据平衡。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/b43068d2843ffbf4e6235317a27789ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X8ef1P0PVmtWfX8Rnm8kHg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，SMOTE</p></figure><p id="119e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SMOTE和一些欠采样技术的结合被证明是有效的，并且一起可以被认为是一种新的采样技术。</p><h1 id="75e9" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">SMOTE与Tomek链接的组合:</h1><p id="e55a" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">Tomek链接是一种欠采样启发式方法，它识别所有彼此最接近但属于不同类别的数据点对，这些数据点对(假设a和b)被称为Tomek链接。Tomek Links遵循以下条件:</p><ul class=""><li id="9f81" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">a和b是彼此最近的邻居</li><li id="ff33" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">a和b属于两个不同的类别</li></ul><p id="1e47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">试探性地，这些Tomek链接点(a，b)出现在两个类别的分离边界上。因此移除Tomek链接点的多数类增加了类分离，并且还减少了沿着多数聚类的边界的多数类样本的数量。</p><h2 id="2a41" class="of nj it bd nk og oh dn no oi oj dp ns li ok ol nu lm om on nw lq oo op ny oq bi translated">想法:</h2><p id="ae9c" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">SMOTE是一种过采样技术，创建新的少数类合成样本，而Tomek Links是一种欠采样技术。</p><p id="566c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于不平衡数据集，首先应用SMOTE创建新的合成少数样本以获得平衡分布。此外，Tomek链接用于移除靠近两个类的边界的样本，以增加两个类之间的分离。</p><h2 id="52c4" class="of nj it bd nk og oh dn no oi oj dp ns li ok ol nu lm om on nw lq oo op ny oq bi translated">实施:</h2><p id="13df" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">Imblearn 包实现了SMOTE和Tomek链接的组合。</p><p id="8083" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe ot ou ov ow b"><strong class="lb iu">pip install imblearn</strong></code>从PyPl安装这个库</p><pre class="kj kk kl km gt ox ow oy oz aw pa bi"><span id="57ef" class="of nj it ow b gy pb pc l pd pe"><strong class="ow iu">from imblearn.combine import SMOTETomek</strong></span><span id="a5e9" class="of nj it ow b gy pf pc l pd pe"><strong class="ow iu">smt = SMOTETomek(random_state=42)<br/>X, y = smt.fit_sample(X, y)</strong></span></pre><h1 id="8872" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">SMOTE与ENN的组合:</h1><p id="b9ce" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">ENN(编辑过的最近邻)是一种欠采样技术，用于移除边界或边界上的多数类实例，这些实例由KNN算法做出的预测不同于其他多数类点。</p><p id="0ff4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似于SMOTETomek，首先应用SMOTE来创建少数类样本的合成数据点，然后使用ENN来移除边界或边界上的数据点以增加两个类的分离。</p><h2 id="de60" class="of nj it bd nk og oh dn no oi oj dp ns li ok ol nu lm om on nw lq oo op ny oq bi translated">实施:</h2><p id="3d68" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">imblearn包中还提供了SMOTE和ENN算法的组合。</p><pre class="kj kk kl km gt ox ow oy oz aw pa bi"><span id="9d33" class="of nj it ow b gy pb pc l pd pe"><strong class="ow iu">from imblearn.combine import SMOTEENN</strong></span><span id="1a74" class="of nj it ow b gy pf pc l pd pe"><strong class="ow iu">smt = SMOTEENN(random_state=42)<br/>X, y = smt.fit_sample(X, y)</strong></span></pre><h1 id="8adf" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">结论:</h1><p id="6327" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">SMOTE和欠采样技术(ENN和托梅克链接)的结合被证明是有效的。SMOTE基本上用于创建少数类的合成类样本以平衡分布，然后欠采样技术(ENN或托梅克链接)用于清除两个类的边界中的不相关点以增加两个类之间的分离。</p><p id="b845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Imblean包附带了SMOTETomek和SMOTEENN的实现。有一条经验法则告诉我们哪种方法最有效。人们可以编写手动Python代码来组合一种过采样技术和一种欠采样技术，以获得最佳结果。</p><blockquote class="mj mk ml"><p id="7b16" class="kz la mm lb b lc ld ju le lf lg jx lh mn lj lk ll mo ln lo lp mp lr ls lt lu im bi translated">你也可以阅读下面提到的文章中的<a class="ae ky" rel="noopener" target="_blank" href="/7-over-sampling-techniques-to-handle-imbalanced-data-ec51c8db349f">来了解处理类不平衡的7种过采样技术。</a></p></blockquote><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/7-over-sampling-techniques-to-handle-imbalanced-data-ec51c8db349f"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">7处理不平衡数据的过采样技术</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">各种过采样技术的深度分析</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ks mt"/></div></div></a></div><h1 id="fae5" class="ni nj it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">参考资料:</h1><p id="0e67" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">[1]不平衡学习API文档:<a class="ae ky" href="http://glemaitre.github.io/imbalanced-learn/api.html" rel="noopener ugc nofollow" target="_blank">http://glemaitre.github.io/imbalanced-learn/api.html</a></p><blockquote class="pg"><p id="11f7" class="ph pi it bd pj pk pl pm pn po pp lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>