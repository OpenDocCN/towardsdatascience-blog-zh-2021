<html>
<head>
<title>Multiple Time Series Forecasting with PyCaret</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åŸºäºPyCaretçš„å¤šæ—¶é—´åºåˆ—é¢„æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/multiple-time-series-forecasting-with-pycaret-bc0a779a22fe?source=collection_archive---------2-----------------------#2021-04-17">https://towardsdatascience.com/multiple-time-series-forecasting-with-pycaret-bc0a779a22fe?source=collection_archive---------2-----------------------#2021-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="03ab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">ä½¿ç”¨PyCareté¢„æµ‹å¤šä¸ªæ—¶é—´åºåˆ—çš„åˆ†æ­¥æ•™ç¨‹</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7a759e3e5437938bb7b153b6c75bd509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8mBuCW7nP0KGhwXQC98Eg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">py caretâ€”â€”Pythonä¸­çš„å¼€æºã€ä½ä»£ç æœºå™¨å­¦ä¹ åº“</p></figure><h1 id="c225" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">PyCaret</h1><p id="4170" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">PyCaretæ˜¯ä¸€ä¸ªå¼€æºçš„ä½ä»£ç æœºå™¨å­¦ä¹ åº“å’Œç«¯åˆ°ç«¯çš„æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå†…ç½®äºPythonä¸­ï¼Œç”¨äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚å®ƒå› å…¶æ˜“ç”¨æ€§ã€ç®€å•æ€§ä»¥åŠå¿«é€Ÿæœ‰æ•ˆåœ°æ„å»ºå’Œéƒ¨ç½²ç«¯åˆ°ç«¯MLåŸå‹çš„èƒ½åŠ›è€Œå¹¿å—æ¬¢è¿ã€‚</p><p id="9642" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">PyCaretæ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨æ¥ç”¨å‡ è¡Œä»£ç æ›¿æ¢æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå‘¨æœŸæˆå€åœ°å¿«é€Ÿå’Œæœ‰æ•ˆã€‚</p><p id="2c2c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">py caret<strong class="lp ir">ç®€å•</strong>T2å¥½ç”¨ã€‚PyCaretä¸­æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½é¡ºåºå­˜å‚¨åœ¨ä¸€ä¸ª<strong class="lp ir">ç®¡é“</strong>ä¸­ï¼Œè¯¥ç®¡é“å¯¹äº<strong class="lp ir">éƒ¨ç½²æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–çš„ã€‚</strong>æ— è®ºæ˜¯è¾“å…¥ç¼ºå¤±å€¼ã€ä¸€é”®ç¼–ç ã€è½¬æ¢åˆ†ç±»æ•°æ®ã€ç‰¹å¾å·¥ç¨‹ï¼Œç”šè‡³æ˜¯è¶…å‚æ•°è°ƒæ•´ï¼ŒPyCaretéƒ½å®ç°äº†è‡ªåŠ¨åŒ–ã€‚</p><p id="c064" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">æœ¬æ•™ç¨‹å‡è®¾æ‚¨å¯¹PyCaretæœ‰ä¸€å®šçš„äº†è§£å’Œç»éªŒã€‚å¦‚æœæ‚¨ä»¥å‰æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œæ²¡å…³ç³»ï¼Œæ‚¨å¯ä»¥é€šè¿‡è¿™äº›æ•™ç¨‹å¿«é€Ÿå…¥é—¨:</p><ul class=""><li id="210f" class="mo mp iq lp b lq mj lt mk lw mq ma mr me ms mi mt mu mv mw bi translated"><a class="ae mx" rel="noopener" target="_blank" href="/pycaret-2-2-is-here-whats-new-ad7612ca63b"> PyCaret 2.2å·²ç»å‘å¸ƒâ€”â€”æ–°åŠŸèƒ½</a></li><li id="14a9" class="mo mp iq lp b lq my lt mz lw na ma nb me nc mi mt mu mv mw bi translated"><a class="ae mx" rel="noopener" target="_blank" href="/announcing-pycaret-2-0-39c11014540e">å®£å¸ƒPyCaret 2.0 </a></li><li id="98a2" class="mo mp iq lp b lq my lt mz lw na ma nb me nc mi mt mu mv mw bi translated"><a class="ae mx" rel="noopener" target="_blank" href="/5-things-you-dont-know-about-pycaret-528db0436eec">å…³äºPyCaretä½ ä¸çŸ¥é“çš„äº”ä»¶äº‹</a></li></ul><h1 id="3500" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak">é‡è¿°</strong></h1><p id="36c2" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">åœ¨æˆ‘çš„<a class="ae mx" rel="noopener" target="_blank" href="/time-series-forecasting-with-pycaret-regression-module-237b703a0c63">ä¸Šä¸€ç¯‡æ•™ç¨‹</a>ä¸­ï¼Œæˆ‘å·²ç»æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨PyCareté€šè¿‡<a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/api/regression.html" rel="noopener ugc nofollow" target="_blank"> PyCaretå›å½’æ¨¡å—</a>ä½¿ç”¨æœºå™¨å­¦ä¹ æ¥é¢„æµ‹æ—¶é—´åºåˆ—æ•°æ®ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰é˜…è¯»ï¼Œä½ å¯ä»¥å…ˆé˜…è¯»<a class="ae mx" rel="noopener" target="_blank" href="/time-series-forecasting-with-pycaret-regression-module-237b703a0c63">ä½¿ç”¨PyCaretå›å½’æ¨¡å—è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</a>æ•™ç¨‹ï¼Œç„¶åå†ç»§ç»­é˜…è¯»æœ¬æ•™ç¨‹ï¼Œå› ä¸ºæœ¬æ•™ç¨‹å»ºç«‹åœ¨ä¸Šä¸€ç¯‡æ•™ç¨‹ä¸­æ¶‰åŠçš„ä¸€äº›é‡è¦æ¦‚å¿µä¹‹ä¸Šã€‚</p><h1 id="7706" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">æ­£åœ¨å®‰è£…PyCaret</h1><p id="184d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">å®‰è£…PyCaretéå¸¸å®¹æ˜“ï¼Œåªéœ€è¦å‡ åˆ†é’Ÿã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒæ¥é¿å…ä¸å…¶ä»–åº“çš„æ½œåœ¨å†²çªã€‚</p><p id="5d8a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">PyCaretçš„é»˜è®¤å®‰è£…æ˜¯pycaretçš„ç²¾ç®€ç‰ˆæœ¬ï¼Œå®ƒåªå®‰è£…è¿™é‡Œåˆ—å‡ºçš„<a class="ae mx" href="https://github.com/pycaret/pycaret/blob/master/requirements.txt" rel="noopener ugc nofollow" target="_blank">ç¡¬ä¾èµ–é¡¹</a>ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="bd40" class="ni kw iq ne b gy nj nk l nl nm"><strong class="ne ir"># install slim version (default)<br/></strong>pip install pycaret</span><span id="eb12" class="ni kw iq ne b gy nn nk l nl nm"><strong class="ne ir"># install the full version</strong><br/>pip install pycaret[full]</span></pre><p id="a81b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">å½“ä½ å®‰è£…pycaretçš„å®Œæ•´ç‰ˆæœ¬æ—¶ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ‰€æœ‰å¯é€‰çš„ä¾èµ–é¡¹<a class="ae mx" href="https://github.com/pycaret/pycaret/blob/master/requirements-optional.txt" rel="noopener ugc nofollow" target="_blank">ä¹Ÿä¼šè¢«å®‰è£…ã€‚</a></p><h1 id="a761" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">ğŸ‘‰PyCaretå›å½’æ¨¡å—</h1><p id="4a10" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">PyCaret <strong class="lp ir">å›å½’æ¨¡å—</strong>æ˜¯ä¸€ä¸ªå—ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å—ï¼Œç”¨äºä¼°è®¡<strong class="lp ir">å› å˜é‡</strong>(é€šå¸¸ç§°ä¸ºâ€œç»“æœå˜é‡â€ï¼Œæˆ–â€œç›®æ ‡â€)å’Œä¸€ä¸ªæˆ–å¤šä¸ª<strong class="lp ir">è‡ªå˜é‡</strong>(é€šå¸¸ç§°ä¸ºâ€œç‰¹å¾â€ï¼Œæˆ–â€œé¢„æµ‹å™¨â€)ä¹‹é—´çš„å…³ç³»ã€‚</p><p id="cd74" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">å›å½’çš„ç›®æ ‡æ˜¯é¢„æµ‹è¿ç»­å€¼ï¼Œå¦‚é”€å”®é¢ã€æ•°é‡ã€æ¸©åº¦ã€å®¢æˆ·æ•°é‡ç­‰ã€‚PyCaretä¸­çš„æ‰€æœ‰æ¨¡å—éƒ½æä¾›äº†è®¸å¤š<a class="ae mx" href="https://www.pycaret.org/preprocessing" rel="noopener ugc nofollow" target="_blank">é¢„å¤„ç†</a>åŠŸèƒ½ï¼Œé€šè¿‡<a class="ae mx" href="https://www.pycaret.org/setup" rel="noopener ugc nofollow" target="_blank">è®¾ç½®</a>åŠŸèƒ½ä¸ºå»ºæ¨¡å‡†å¤‡æ•°æ®ã€‚å®ƒæœ‰è¶…è¿‡25ä¸ªç°æˆçš„ç®—æ³•å’Œå‡ ä¸ªå›¾æ¥åˆ†æè®­ç»ƒæ¨¡å‹çš„æ€§èƒ½ã€‚</p><h1 id="857d" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">ğŸ‘‰èµ„æ–™ç»„</h1><p id="2561" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¤šæ—¶é—´åºåˆ—æ•°æ®é¢„æµ‹çš„ç«¯åˆ°ç«¯å®ç°ï¼ŒåŒ…æ‹¬è®­ç»ƒå’Œé¢„æµ‹æœªæ¥å€¼ã€‚</p><p id="aa66" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">æˆ‘ä½¿ç”¨äº†Kaggleçš„<a class="ae mx" href="https://www.kaggle.com/c/demand-forecasting-kernels-only" rel="noopener ugc nofollow" target="_blank">å•†åº—å•†å“éœ€æ±‚é¢„æµ‹æŒ‘æˆ˜</a>æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†æœ‰10ä¸ªä¸åŒçš„å•†åº—ï¼Œæ¯ä¸ªå•†åº—æœ‰50ä¸ªé¡¹ç›®ï¼Œå³äº”å¹´(2013å¹´è‡³2017å¹´)å…±500ä¸ªæ¯æ—¥çº§åˆ«çš„æ—¶é—´åºåˆ—æ•°æ®ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d6e3619c8a8a56c34cfc31ea737e1b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*VY7MljIxivAiYWSMmAjN6g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">æ ·æœ¬æ•°æ®é›†</p></figure><h1 id="e4d6" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">ğŸ‘‰åŠ è½½å¹¶å‡†å¤‡æ•°æ®</h1><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="d23e" class="ni kw iq ne b gy nj nk l nl nm"><strong class="ne ir"># read the csv file<br/></strong>import pandas as pd<br/>data = pd.read_csv('train.csv')<br/>data['date'] = pd.to_datetime(data['date'])</span><span id="f27a" class="ni kw iq ne b gy nn nk l nl nm"><strong class="ne ir"># combine store and item column as time_series</strong><br/>data['store'] = ['store_' + str(i) for i in data['store']]<br/>data['item'] = ['item_' + str(i) for i in data['item']]<br/>data['time_series'] = data[['store', 'item']].apply(lambda x: '_'.join(x), axis=1)<br/>data.drop(['store', 'item'], axis=1, inplace=True)</span><span id="24a9" class="ni kw iq ne b gy nn nk l nl nm"><strong class="ne ir"># extract features from date</strong><br/>data['month'] = [i.month for i in data['date']]<br/>data['year'] = [i.year for i in data['date']]<br/>data['day_of_week'] = [i.dayofweek for i in data['date']]<br/>data['day_of_year'] = [i.dayofyear for i in data['date']]</span><span id="beef" class="ni kw iq ne b gy nn nk l nl nm">data.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/9472742a4063484ca0943f411ceca9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*D3PBqLf-PsnGdTn7AjGmWw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ä»æ•°æ®ä¸­å–æ ·è¡Œ</p></figure><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="6473" class="ni kw iq ne b gy nj nk l nl nm"><strong class="ne ir"># check the unique time_series</strong><br/>data['time_series'].nunique()<br/>&gt;&gt;&gt; 500</span></pre><h1 id="60f4" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">ğŸ‘‰å¯è§†åŒ–æ—¶é—´åºåˆ—</h1><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="a612" class="ni kw iq ne b gy nj nk l nl nm"><strong class="ne ir"># plot multiple time series with moving avgs in a loop</strong></span><span id="891c" class="ni kw iq ne b gy nn nk l nl nm">import plotly.express as px</span><span id="0238" class="ni kw iq ne b gy nn nk l nl nm">for i in data['time_series'].unique():<br/>    subset = data[data['time_series'] == i]<br/>    subset['moving_average'] = subset['sales'].rolling(30).mean()<br/>    fig = px.line(subset, x="date", y=["sales","moving_average"], title = i, template = 'plotly_dark')<br/>    fig.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/8a5c6bba9bb61c1bf4a71c742f551a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BlE7UEMFRCV6kbEK1oWTEA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">store_1_item_1æ—¶é—´åºåˆ—å’Œ30å¤©ç§»åŠ¨å¹³å‡å€¼</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/92e2ae7924c011ac7a83c79af60d1d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vhc8EP7IbA-_qdwyuENHaQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">store_2_item_1æ—¶é—´åºåˆ—å’Œ30å¤©ç§»åŠ¨å¹³å‡å€¼</p></figure><h1 id="6235" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">ğŸ‘‰å¼€å§‹åŸ¹è®­è¿‡ç¨‹</h1><p id="13d3" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†æ•°æ®ï¼Œè®©æˆ‘ä»¬å¼€å§‹è®­ç»ƒå¾ªç¯ã€‚æ³¨æ„æ‰€æœ‰åŠŸèƒ½ä¸­çš„<code class="fe ns nt nu ne b">verbose = False</code>ï¼Œä»¥é¿å…è®­ç»ƒæ—¶åœ¨æ§åˆ¶å°ä¸Šæ‰“å°ç»“æœã€‚</p><p id="3f62" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">ä¸‹é¢çš„ä»£ç æ˜¯æˆ‘ä»¬åœ¨æ•°æ®å‡†å¤‡æ­¥éª¤ä¸­åˆ›å»ºçš„å›´ç»•<code class="fe ns nt nu ne b">time_series</code>åˆ—çš„å¾ªç¯ã€‚æ€»å…±æœ‰150ä¸ªæ—¶é—´åºåˆ—(10å®¶å•†åº—x 50ä»¶å•†å“)ã€‚</p><p id="b2dc" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">ä¸‹é¢çš„ç¬¬10è¡Œæ˜¯è¿‡æ»¤æ•°æ®é›†çš„<code class="fe ns nt nu ne b">time_series</code>å˜é‡ã€‚å¾ªç¯ä¸­çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯åˆå§‹åŒ–<code class="fe ns nt nu ne b">setup</code>å‡½æ•°ï¼Œç„¶åæ˜¯<code class="fe ns nt nu ne b">compare_models</code>å¯»æ‰¾æœ€ä½³æ¨¡å‹ã€‚ç¬¬24â€“26è¡Œæ•è·ç»“æœï¼Œå¹¶å°†æœ€ä½³æ¨¡å‹çš„æ€§èƒ½æŒ‡æ ‡é™„åŠ åˆ°ä¸€ä¸ªåä¸º<code class="fe ns nt nu ne b">all_results</code>çš„åˆ—è¡¨ä¸­ã€‚ä»£ç çš„æœ€åä¸€éƒ¨åˆ†ä½¿ç”¨<code class="fe ns nt nu ne b">finalize_model</code>å‡½æ•°åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šé‡æ–°è®­ç»ƒæœ€ä½³æ¨¡å‹ï¼ŒåŒ…æ‹¬æµ‹è¯•é›†ä¸­å‰©ä¸‹çš„5%,å¹¶å°†åŒ…æ‹¬æ¨¡å‹åœ¨å†…çš„æ•´ä¸ªç®¡é“ä¿å­˜ä¸ºpickleæ–‡ä»¶ã€‚</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae mx" href="https://gist.github.com/moezali1/f258195ba1c677654abffb0d1acb2cc0" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/moe zali 1/f 258195 ba1c 677654 abffb 0 D1 ACB 2c 0</a></p></figure><p id="36bb" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥ä»<code class="fe ns nt nu ne b">all_results</code>åˆ—è¡¨åˆ›å»ºä¸€ä¸ªæ•°æ®å¸§ã€‚å®ƒå°†æ˜¾ç¤ºä¸ºæ¯ä¸ªæ—¶é—´åºåˆ—é€‰æ‹©çš„æœ€ä½³æ¨¡å‹ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="9b61" class="ni kw iq ne b gy nj nk l nl nm">concat_results = pd.concat(all_results,axis=0)<br/>concat_results.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/39e890492b26eca22f3d4b9823de8335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qgu9jP86L2gaZHi-TvM0SA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">concat_resultsä¸­çš„æ ·æœ¬è¡Œ</p></figure><h1 id="bf77" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">åŸ¹è®­è¿‡ç¨‹ğŸ‘‡</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/922a02bee4875e10b3c8912236be8b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SwI6InjXRuB-TlQwsKZZRQ.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">åŸ¹è®­è¿‡ç¨‹</p></figure><h1 id="7873" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">ğŸ‘‰ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ç”Ÿæˆé¢„æµ‹</h1><p id="653b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»è®­ç»ƒäº†æ¨¡å‹ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨å®ƒä»¬æ¥ç”Ÿæˆé¢„æµ‹ï¼Œä½†æ˜¯é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç”¨äºè¯„åˆ†çš„æ•°æ®é›†(Xå˜é‡)ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="da0f" class="ni kw iq ne b gy nj nk l nl nm"><strong class="ne ir"># create a date range from 2013 to 2019</strong><br/>all_dates = pd.date_range(start='2013-01-01', end = '2019-12-31', freq = 'D')</span><span id="b4e2" class="ni kw iq ne b gy nn nk l nl nm"><strong class="ne ir"># create empty dataframe</strong><br/>score_df = pd.DataFrame()</span><span id="637d" class="ni kw iq ne b gy nn nk l nl nm"><strong class="ne ir"># add columns to dataset</strong><br/>score_df['date'] = all_dates<br/>score_df['month'] = [i.month for i in score_df['date']]<br/>score_df['year'] = [i.year for i in score_df['date']]<br/>score_df['day_of_week'] = [i.dayofweek for i in score_df['date']]<br/>score_df['day_of_year'] = [i.dayofyear for i in score_df['date']]</span><span id="e5b8" class="ni kw iq ne b gy nn nk l nl nm">score_df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f28d245d115f59aa92fb593186e6f94c.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*Dycm3JuIt0gsGPwPc4_8fw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">score_dfæ•°æ®é›†ä¸­çš„æ ·æœ¬è¡Œ</p></figure><p id="6c3d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¾ªç¯æ¥åŠ è½½ç»è¿‡è®­ç»ƒçš„ç®¡é“ï¼Œå¹¶ä½¿ç”¨<code class="fe ns nt nu ne b">predict_model</code>å‡½æ•°æ¥ç”Ÿæˆé¢„æµ‹æ ‡ç­¾ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="0f38" class="ni kw iq ne b gy nj nk l nl nm">from pycaret.regression import load_model, predict_model</span><span id="8b07" class="ni kw iq ne b gy nn nk l nl nm">all_score_df = []</span><span id="ad0d" class="ni kw iq ne b gy nn nk l nl nm">for i in tqdm(data['time_series'].unique()):<br/>    l = load_model('trained_models/' + str(i), verbose=False)<br/>    p = predict_model(l, data=score_df)<br/>    p['time_series'] = i<br/>    all_score_df.append(p)</span><span id="705c" class="ni kw iq ne b gy nn nk l nl nm">concat_df = pd.concat(all_score_df, axis=0)<br/>concat_df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/5f3fea837151e0c77b3a2b1a13af76e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2l9A8jStBQEAULk9fqMObA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">å¯¹concat_dfä¸­çš„è¡Œè¿›è¡Œé‡‡æ ·</p></figure><p id="3581" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">æˆ‘ä»¬ç°åœ¨å°†åŠ å…¥<code class="fe ns nt nu ne b">data</code>å’Œ<code class="fe ns nt nu ne b">concat_df</code>ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="c4c0" class="ni kw iq ne b gy nj nk l nl nm">final_df = pd.merge(concat_df, data, how = 'left', left_on=['date', 'time_series'], right_on = ['date', 'time_series'])<br/>final_df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/9bfa0719bd602c9365dba7a9c8010f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TN9d9WssEBkn-GFSYVgNWg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">final_dfä¸­çš„æ ·æœ¬è¡Œ</p></figure><p id="013f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå¾ªç¯æ¥æŸ¥çœ‹æ‰€æœ‰çš„å›¾ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="aa65" class="ni kw iq ne b gy nj nk l nl nm">for i in final_df['time_series'].unique()[:5]:<br/>    sub_df = final_df[final_df['time_series'] == i]<br/>    <br/>    import plotly.express as px<br/>    fig = px.line(sub_df, x="date", y=['sales', 'Label'], title=i, template = 'plotly_dark')<br/>    fig.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/e4a014ffe56421f922fa50db372d4648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tvjEor2VvHVFgumGgEtfKQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">store_1_item_1å®é™…é”€å”®é¢å’Œé¢„æµ‹æ ‡ç­¾</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/f73c671973c9b7e4a7e0e78f108a2eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99cyEOPNr97uDMLKrnNqig.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">store_2_item_1å®é™…é”€å”®é¢å’Œé¢„æµ‹æ ‡ç­¾</p></figure><p id="efbf" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">æˆ‘å¸Œæœ›æ‚¨ä¼šå–œæ¬¢PyCaretçš„æ˜“ç”¨æ€§å’Œç®€å•æ€§ã€‚åœ¨ä¸åˆ°50è¡Œä»£ç å’Œä¸€ä¸ªå°æ—¶çš„å®éªŒä¸­ï¼Œæˆ‘è®­ç»ƒäº†è¶…è¿‡10ï¼Œ000ä¸ªæ¨¡å‹(25ä¸ªä¼°è®¡å€¼x 500ä¸ªæ—¶é—´åºåˆ—)ï¼Œå¹¶ç”Ÿäº§äº†500ä¸ªæœ€ä½³æ¨¡å‹æ¥ç”Ÿæˆé¢„æµ‹ã€‚</p><h1 id="41a2" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">å³å°†æ¨å‡ºï¼</h1><p id="9bc6" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">ä¸‹å‘¨æˆ‘å°†å†™ä¸€ç¯‡å…³äºä½¿ç”¨<a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/api/anomaly.html" rel="noopener ugc nofollow" target="_blank"> PyCaretå¼‚å¸¸æ£€æµ‹æ¨¡å—</a>å¯¹æ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œæ— ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„æ•™ç¨‹ã€‚è¯·åœ¨<a class="ae mx" href="https://medium.com/@moez-62905" rel="noopener"> Medium </a>ã€<a class="ae mx" href="https://www.linkedin.com/in/profile-moez/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>å’Œ<a class="ae mx" href="https://twitter.com/moezpycaretorg1" rel="noopener ugc nofollow" target="_blank"> Twitter </a>ä¸Šå…³æ³¨æˆ‘ï¼Œè·å–æ›´å¤šæ›´æ–°ã€‚</p></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="d8e2" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">ä½¿ç”¨Pythonä¸­çš„è¿™ä¸ªè½»é‡çº§å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°çš„ç›®æ ‡æ˜¯æ— é™çš„ã€‚å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°ç»™æˆ‘ä»¬GitHubåº“ä¸Šçš„â­ï¸ã€‚</p><p id="7c12" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">æƒ³äº†è§£æ›´å¤šå…³äºPyCaretçš„ä¿¡æ¯ï¼Œè¯·åœ¨LinkedInå’ŒYoutubeä¸Šå…³æ³¨æˆ‘ä»¬ã€‚</p><p id="f750" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">åŠ å…¥æˆ‘ä»¬çš„ä¼‘é—²é¢‘é“ã€‚é‚€è¯·é“¾æ¥<a class="ae mx" href="https://join.slack.com/t/pycaret/shared_invite/zt-p7aaexnl-EqdTfZ9U~mF0CwNcltffHg" rel="noopener ugc nofollow" target="_blank">æ­¤å¤„</a>ã€‚</p><h1 id="8cf3" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£:</h1><p id="5659" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mx" rel="noopener" target="_blank" href="/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d">ä½¿ç”¨PyCaret 2.0 </a> <br/> <a class="ae mx" rel="noopener" target="_blank" href="/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01">åœ¨Power BIä¸­æ„å»ºæ‚¨è‡ªå·±çš„AutoMLä½¿ç”¨Docker </a> <br/> <a class="ae mx" rel="noopener" target="_blank" href="/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b">åœ¨Azureä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“åœ¨Google Kuberneteså¼•æ“ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“</a> <br/> <a class="ae mx" rel="noopener" target="_blank" href="/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507">åœ¨AWS Fargateä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“</a> <br/> <a class="ae mx" rel="noopener" target="_blank" href="/build-and-deploy-your-first-machine-learning-web-app-e020db344a99">æ„å»ºå¹¶éƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹ webåº”ç”¨</a> <br/> <a class="ae mx" rel="noopener" target="_blank" href="/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2">ä½¿ç”¨AWS Fargate server less</a><br/><a class="ae mx" rel="noopener" target="_blank" href="/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104">éƒ¨ç½²PyCaretå’ŒStreamlitåº”ç”¨</a></p><h1 id="3267" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">é‡è¦é“¾æ¥</h1><p id="3c9d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a> <br/> <a class="ae mx" href="https://medium.com/@moez_62905" rel="noopener">åšå®¢</a><br/><a class="ae mx" href="http://www.github.com/pycaret/pycaret" rel="noopener ugc nofollow" target="_blank">GitHub</a><br/><a class="ae mx" href="https://stackoverflow.com/questions/tagged/pycaret" rel="noopener ugc nofollow" target="_blank">stack overflow</a><br/><a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">å®‰è£…PyCaret <br/> </a> <a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/tutorials.html" rel="noopener ugc nofollow" target="_blank">ç¬”è®°æœ¬æ•™ç¨‹<br/> </a> <a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/contribute.html" rel="noopener ugc nofollow" target="_blank">è´¡çŒ®äºPyCaret </a></p><h1 id="875b" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">æƒ³äº†è§£æŸä¸ªç‰¹å®šæ¨¡å—ï¼Ÿ</h1><p id="75fa" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">å•å‡»ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ–‡æ¡£å’Œå·¥ä½œç¤ºä¾‹ã€‚</p><p id="e49b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/api/classification.html" rel="noopener ugc nofollow" target="_blank">åˆ†ç±»<br/> </a> <a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/api/regression.html" rel="noopener ugc nofollow" target="_blank">å›å½’</a> <br/> <a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/api/clustering.html" rel="noopener ugc nofollow" target="_blank">èšç±»</a><br/>T29ã€‘å¼‚å¸¸æ£€æµ‹ <br/> <a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/api/nlp.html" rel="noopener ugc nofollow" target="_blank">è‡ªç„¶è¯­è¨€å¤„ç†<br/> </a> <a class="ae mx" href="https://pycaret.readthedocs.io/en/latest/api/arules.html" rel="noopener ugc nofollow" target="_blank">å…³è”è§„åˆ™æŒ–æ˜</a></p></div></div>    
</body>
</html>