<html>
<head>
<title>Automated customer segmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化客户细分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automated-customer-segmentation-2f9cec9df4df?source=collection_archive---------18-----------------------#2021-11-09">https://towardsdatascience.com/automated-customer-segmentation-2f9cec9df4df?source=collection_archive---------18-----------------------#2021-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2bba" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Python和UbiOps</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/07d4306f9f158b553258a0bd1abd7eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n4S3wp2UH5RUmSUI"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由<a class="ae kv" href="https://firmbee.com/" rel="noopener ugc nofollow" target="_blank">Firmbee.com</a></p></figure><h1 id="6e57" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="abc0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">客户细分是增进你对客户了解的好方法，这样你就能更好地对他们的需求做出反应。要真正从客户细分中获得最大收益，最好是将其自动化，这样可以最大限度地减少手动工作和花费的时间。在这篇文章中，我将向你展示如何使用Python和<a class="ae kv" href="https://ubiops.com/product/" rel="noopener ugc nofollow" target="_blank"> UbiOps </a>来自动化你的客户细分。我将对存储在谷歌表单中的交易数据进行RFM分析。</p><p id="b689" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="mp">你可以在这里找到本教程</em> <a class="ae kv" href="https://github.com/UbiOps/tutorials/tree/master/ready-deployments/customer-segmentation/segmentation_deployment_package_advanced" rel="noopener ugc nofollow" target="_blank"> <em class="mp">的结果代码。</em> </a></p><h1 id="6650" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么是RFM分析？</h1><p id="8d60" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir"> RFM分析</strong>是一种基本的客户细分算法。<strong class="lq ir"> </strong>代表近期、频率、货币分析。这种特定的分析基于三个因素将每个客户分配到一个组:</p><ul class=""><li id="4cd3" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj mv mw mx my bi translated">客户最近购买了什么东西？</li><li id="9343" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj mv mw mx my bi translated">他们多久买一次东西？</li><li id="a234" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj mv mw mx my bi translated">当他们买东西的时候，他们会花多少钱？</li></ul><p id="22ef" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">使用这三个因素，该算法将通过以下方式为每个客户分配一个RFM分数:</p><ol class=""><li id="da7b" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj ne mw mx my bi translated">根据<strong class="lq ir">最近</strong>将客户分成四分之一</li><li id="b063" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">根据<strong class="lq ir">频率</strong>将客户划分为四分位数</li><li id="c3a3" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">根据<strong class="lq ir">支出</strong>将客户分为四分之一</li><li id="aaf1" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">将客户所在的每个四分位数的数字串联起来，以获得一个分数</li></ol><p id="c85e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果我们以客户Annie为例，她可能处于最近消费的第一个四分位数，第二个四分位数，第三个四分位数。她的RFM分数将会是<strong class="lq ir"> 123 </strong>。111分是最高分，444分是最差分。</p><p id="f8ee" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">想深入了解RFM吗？我推荐叶小开·阿恩·贝克的这篇文章。</p><h1 id="4fce" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">如何对您的数据进行RFM分析</h1><p id="0ba8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">RFM分析需要交易数据。我将用这个Kaggle数据集作为一个例子来展示如何进行RFM分析。首先，我们需要导入熊猫并读入数据。</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="5953" class="nm kx iq ni b gy nn no l np nq">import pandas as pd<br/>data_df = pd.read_excel(‘Online_Retail.xlsx’)`</span></pre><p id="bc48" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果你想看一眼数据，你可以使用<code class="fe nr ns nt ni b">data_df.head()</code>，你应该会看到这样的内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/1531e7b3d8127033a338697086420da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jdH6hKGfaJedCQq4"/></div></div></figure><p id="c188" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们有了数据，我们可以开始我们的RFM分析。在这篇博文中，为了保持简洁，我不会涉及数据清理，但是要注意，当您想要将下面的代码应用到您自己的数据集时，您需要确保您的数据是干净的。</p><p id="e111" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们需要做的第一件事是计算每笔交易的总价。为此，我们可以简单地将<strong class="lq ir">单价</strong>列乘以<strong class="lq ir">数量</strong>列，并将结果保存在一个新列中，我们称之为<strong class="lq ir">总价。</strong>您可以通过下面一行代码实现这一点:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="d0d7" class="nm kx iq ni b gy nn no l np nq">data_df[‘TotalPrice’] = data_df[‘Quantity’].astype(int) * data_df[‘UnitPrice’].astype(float)</span></pre><p id="e624" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们已经准备好了必要的列，我们可以对我们的近期、频率和货币值执行以下计算:</p><ol class=""><li id="6388" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj ne mw mx my bi translated"><strong class="lq ir"> Recency </strong>:计算每个客户最近一次购买日期和最后一次购买日期之间的天数。</li><li id="169c" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated"><strong class="lq ir">频率</strong>:计算每个客户的订单数量。</li><li id="f3fe" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated"><strong class="lq ir">货币</strong>:计算每个客户所花的所有钱的总和。</li></ol><p id="2f84" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以使用lambda函数快速进行计算:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="5a44" class="nm kx iq ni b gy nn no l np nq">data_df[‘InvoiceDate’] = pd.to_datetime(data_df[‘InvoiceDate’])<br/>rfm= data_df.groupby(‘CustomerID’).agg({‘InvoiceDate’: lambda date: (date.max() — date.min()).days,<br/>‘InvoiceNo’: lambda num: len(num),<br/>‘TotalPrice’: lambda price: price.sum()})</span></pre><p id="ed0d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">完美！现在我们已经有了我们的值，我们需要做的最后一件事是完成这个分析，根据最近、频率和货币将客户分成不同的四分之一，并将每个四分之一的数字连接起来。</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="c09c" class="nm kx iq ni b gy nn no l np nq"># Change the name of columns<br/>rfm.columns=[‘recency’,’frequency’,’monetary’]</span><span id="9861" class="nm kx iq ni b gy nv no l np nq"># Computing Quantile of RFM values<br/>rfm[‘recency’] = rfm[‘recency’].astype(int)<br/>rfm[‘r_quartile’] = pd.qcut(rfm[‘recency’].rank(method=’first’), 4, [‘1’,’2',’3',’4']).astype(int)<br/>rfm[‘f_quartile’] = pd.qcut(rfm[‘frequency’], 4, [‘4’,’3',’2',’1']).astype(int)<br/>rfm[‘m_quartile’] = pd.qcut(rfm[‘monetary’], 4, [‘4’,’3',’2',’1']).astype(int)</span><span id="8075" class="nm kx iq ni b gy nv no l np nq"># Concatenating the quantile numbers to get the RFM score<br/>rfm[‘RFM_Score’] = rfm.r_quartile.astype(str)+ rfm.f_quartile.astype(str) + rfm.m_quartile.astype(str)</span></pre><p id="0b60" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在运行了这段代码并使用<code class="fe nr ns nt ni b">rfm.head()</code>检查了“rfm”之后，得到的数据帧应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/2b12867c054598105c11979625fef09f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*22afCe_W9Phapg7Y"/></div></div></figure><p id="0aa4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，每个客户都有一个RFM分数，以表明他们是什么类型的客户。您可以利用这些信息来制定营销和销售策略。</p><h1 id="11a2" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">自动化您的RFM分析</h1><p id="349c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了最大限度地利用RFM分析，应该对您的数据定期执行自动化分析。要开始自动化，首先需要在分析和数据存储位置之间建立一个连接。现在，我们使用本地excel表，但更有可能的是，您将这些数据存储在某种共享位置，可以是数据库，也可以是更简单的共享驱动器。在本文中，我将向您展示如果您的交易数据存储在Google Sheet中，如何自动进行这种分析。当然，你的情况可能会非常不同，但我将向你展示的相同原则仍然适用。</p><h1 id="defc" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为您的Google Sheet设置服务帐户</h1><p id="629a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了建立到您的Google表单的连接，我们需要一个能够访问表单的<em class="mp">服务帐户</em>。您可以创建一个，如下所示:</p><ol class=""><li id="9698" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj ne mw mx my bi translated">前往<a class="ae kv" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌开发者控制台</a>并创建一个新项目(或选择一个现有项目)</li><li id="7b32" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">您将被重定向到项目仪表板，在那里点击<strong class="lq ir">“启用API和服务”</strong>，搜索“Sheets API”。</li><li id="bc85" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">在API界面点击<strong class="lq ir">“启用”</strong>启用该API</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/489f833140d8d321fcdc0dce444bc540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/0*KwpafUuELyIfgrfQ"/></div></figure><ol class=""><li id="edf8" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj ne mw mx my bi translated">同样启用<strong class="lq ir">“驱动API”</strong>。</li><li id="ec80" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">转到<strong class="lq ir">“凭证”</strong>选项卡，选择<strong class="lq ir">“创建凭证&gt;服务帐户”</strong>创建一个新的服务帐户。</li><li id="5b06" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">给服务帐户一个名称和描述</li><li id="ff6c" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">将服务帐户权限设置为<strong class="lq ir">“计算引擎服务代理”</strong>，跳过表单中的第三步，点击<strong class="lq ir">创建</strong>。</li><li id="42be" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">导航到新创建的服务帐户，并转到“Keys”选项卡。点击<strong class="lq ir">“添加密钥&gt;创建新密钥”</strong>。</li><li id="e92e" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">将类型设置为<strong class="lq ir"> JSON </strong>并点击<strong class="lq ir">创建</strong>。这将提示下载一个json文件，该文件包含帐户授权所需的私钥。将它存储在运行代码的同一文件夹中。</li></ol><p id="09be" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">好了，我们现在有了一个具有正确权限的服务帐户。我们只需要让服务帐户访问仍然有数据的表。要做到这一点，带着你的数据去谷歌表单，点击“分享”。与您在前面步骤中创建的服务帐户的电子邮件地址<strong class="lq ir">共享google表单。服务帐户将需要编辑权限，因为它将执行读取和写入操作。</strong></p><h1 id="5552" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">从Google工作表中检索数据</h1><p id="0705" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">使用您之前创建的服务帐户，我们现在可以建立从您的Python代码到Google Sheet的连接。我正在使用图书馆<a class="ae kv" href="https://pygsheets.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">的图片来帮助解决这个问题。</a></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="660b" class="nm kx iq ni b gy nn no l np nq">SCOPES = (‘https://www.googleapis.com/auth/spreadsheets', ‘<a class="ae kv" href="https://www.googleapis.com/auth/drive" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/drive</a>')</span><span id="cdb6" class="nm kx iq ni b gy nv no l np nq"># Change the json filename to your json file in the line below<br/>service_account_info = json.loads(“your_json_file.json”)<br/>my_credentials = service_account.Credentials.from_service_account_info(service_account_info, scopes=SCOPES)<br/>gc = pygsheets.authorize(custom_credentials=my_credentials)</span></pre><p id="07d4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在已经建立了一个连接，我们可以继续从Google Sheet中读取数据:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="8c5a" class="nm kx iq ni b gy nn no l np nq">spreadsheet = gc.open(“Online_Retail”)<br/>sheet_data = spreadsheet[0]</span><span id="c667" class="nm kx iq ni b gy nv no l np nq"># Transforming data into a Pandas DataFrame<br/>data_df = sheet_data.get_as_df()</span></pre><p id="fb81" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们有了一个基于Google工作表中的数据的数据框架，我们可以用它来分析前面的部分。把<code class="fe nr ns nt ni b">data_df = pd.read_excel(“Online_Retail.xlsx”)</code>线拿出来就行了。</p><h1 id="d883" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">将结果写入Google工作表</h1><p id="85c8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">既然我们可以检索数据来执行分析，我们还应该确保我们可以将分析结果写到人们可以访问的地方。在这种情况下，我们将把结果写到同一个Google Sheet的一个单独的选项卡中。您可以通过在为RFM分析编码后添加以下代码行来实现这一点:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="0f68" class="nm kx iq ni b gy nn no l np nq">sheet_title = “RFM results”</span><span id="8968" class="nm kx iq ni b gy nv no l np nq">try:<br/>   sh = spreadsheet.worksheet_by_title(sheet_title)<br/>except:<br/>   print('Worksheet does not exist, adding new sheet')<br/>   spreadsheet.add_worksheet(sheet_title)<br/>   sh = spreadsheet.worksheet_by_title(sheet_title)<br/>finally:<br/>   sh.set_dataframe(sorted_customers, 'A1', copy_index = True)<br/>   sh.update_value('A1', 'CustomerID')<br/>   print('Data inserted successfully')</span></pre><p id="cb8b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">从上到下运行结果代码后，首先读入数据，然后执行分析，然后写下结果，您应该能够在Google Sheets中看到您的结果！</p><h1 id="ace5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">将您的分析迁移到云中</h1><p id="3b04" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">所以我们现在有了一段Python代码，它从Google工作表中检索数据，对其执行分析，并将结果写入同一个工作表。在目前的情况下，每当您需要最新的客户细分结果时，代码都需要从笔记本电脑本地运行。如果我们将整个代码转移到云中，我们可以定期进行分析<em class="mp">和</em>我们可以向公司内更多的人开放。为了实现这一点，我将使用<a class="ae kv" href="https://ubiops.com/product/" rel="noopener ugc nofollow" target="_blank"> UbiOps </a>，这是一个允许你在API背后以可扩展的方式提供Python或R代码的平台。我会告诉你我如何使用它。</p><h1 id="9d29" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为UbiOps准备代码</h1><p id="153e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在我将代码放入UbiOps的<a class="ae kv" href="https://ubiops.com/docs/deployments/" rel="noopener ugc nofollow" target="_blank">部署</a>之前，我需要将代码放入所谓的<a class="ae kv" href="https://ubiops.com/docs/deployments/deployment-package/deployment-structure/" rel="noopener ugc nofollow" target="_blank">部署包</a>。这意味着我将代码放在部署类中。这只是为了确保UbiOps知道什么时候运行什么。我们用例的deployment.py文件如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="f795" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在部署文件的旁边，我们需要创建一个requirements.txt文件来通知UbiOps我们代码的依赖关系。以下<code class="fe nr ns nt ni b">requirements.txt</code>应该足够了:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="13b7" class="nm kx iq ni b gy nn no l np nq">google-api-core==1.28.0<br/>google-api-python-client==2.5.0<br/>google-auth==1.30.0<br/>google-auth-httplib2==0.1.0<br/>google-auth-oauthlib==0.4.4<br/>googleapis-common-protos==1.53.0<br/>numpy==1.20.3<br/>oauthlib==3.1.0<br/>pygsheets==2.0.5<br/>pandas==1.2.4</span></pre><p id="b155" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">一旦你有了这两个文件，把它们放在一个单独的文件夹中，然后压缩整个文件夹。这个zip文件是您的部署包。您也可以在这里找到完整的部署文件夹<a class="ae kv" href="https://github.com/UbiOps/tutorials/tree/master/ready-deployments/customer-segmentation/segmentation_deployment_package_advanced" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="8f7b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">在UbiOps中创建部署</h1><p id="fcdb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">您可以通过Python、CLI或WebApp创建部署，这取决于您的偏好。我会使用WebApp。</p><ol class=""><li id="92c9" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj ne mw mx my bi translated">前往<a class="ae kv" href="https://app.ubiops.com" rel="noopener ugc nofollow" target="_blank">https://app.ubiops.com</a>并使用您的帐户登录，如果您没有帐户，请创建一个免费帐户。</li><li id="be77" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">转到您的项目并导航到“部署”部分，单击<strong class="lq ir">创建</strong>。</li><li id="5234" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">为您的部署命名，例如“automated-rfm”</li><li id="f76f" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">在<strong class="lq ir">输入</strong>下定义一个名为<strong class="lq ir">“文件名”</strong>的输入字段，类型为<strong class="lq ir">字符串</strong></li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/dea8824de6bda4f1ef4c4e902781e0c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8nQKbKSf0_bplbkT"/></div></div></figure><p id="ab12" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">5.保留其他设置，点击<strong class="lq ir">下一步:创建版本</strong></p><p id="9cb1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在您已经有了一个部署，我们可以创建版本:</p><ol class=""><li id="ad94" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj ne mw mx my bi translated">在部署<strong class="lq ir">包中，</strong>点击<strong class="lq ir">上传zip文件</strong>，上传您之前创建的部署包zip文件。</li><li id="cd44" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">展开<strong class="lq ir">可选/高级设置</strong>，向下滚动到<strong class="lq ir">部署</strong> <strong class="lq ir">环境变量</strong>。</li><li id="1364" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj ne mw mx my bi translated">点击<strong class="lq ir">创建变量</strong>，填写“credentials”作为名称，并复制粘贴您的google服务帐户的JSON密钥作为值。将环境变量标记为secret并点击复选标记按钮。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/26af5776e10846831867dbba77c9ceee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NiEit324Mifx2XTg"/></div></div></figure><p id="f245" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">4.您可以再次保留所有其他设置的默认值，然后单击<strong class="lq ir">创建</strong></p><p id="0201" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您的部署现在将开始构建。在后台，UbiOps会为你的代码制作一个Docker镜像，并在它周围封装一个API。完成后，您会看到状态将变为<strong class="lq ir">可用</strong>。</p><p id="75a0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">一旦您的部署可用，您可以通过单击右上角的<strong class="lq ir">创建请求</strong>按钮来测试一切是否正常。使用Google工作表的名称作为请求的输入。</p><h1 id="b2b9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">安排您的分析</h1><p id="d6ba" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">自动化分析的最后一步是让它定期运行，以保持所有RFM分数是最新的。您可以通过在UbiOps中创建一个定期触发您的部署的<a class="ae kv" href="https://ubiops.com/docs/data-connections/request-schedules/" rel="noopener ugc nofollow" target="_blank">请求调度</a>来做到这一点。</p><p id="1200" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">转到WebApp中的“请求时间表”并点击<strong class="lq ir">创建。</strong>为您的计划命名，如“monthly-rfm ”,并从下拉菜单中选择您的部署。点击<strong class="lq ir">下一步</strong>进入创建表单的下一部分。在输入数据下，填写您的谷歌表单的名称，然后点击<strong class="lq ir">下一步</strong>。现在将提示您定义一个时间表。假设您需要在每月第一天的8:00进行分析，那么您可以设置以下cron作业:0 8 1 * *</p><p id="92f5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">设置好cron作业表达式后，单击<strong class="lq ir"> Create </strong>，您的时间表将被打开！</p><h1 id="7fe2" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="5073" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果你一直跟着做，你现在已经有了一个RFM分析，它会在每个月的第一天自动执行。这样你就有了一个自动更新的客户细分，你的团队可以用它来指导他们的决策。我在本文中给出的例子可能是专门针对RFM分析的，但是我向您展示的原则也适用于其他类型的客户细分。</p><p id="a12d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您需要自动化您的分析吗？欢迎在评论中告诉我！</p><h1 id="a8d9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">更多信息</h1></div><div class="ab cl oa ob hu oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ij ik il im in"><p id="1183" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">想了解更多关于本文中使用的库和工具的信息吗？看看其他媒体文章:</p><p id="4769" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">图片:</strong></p><p id="d379" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://medium.com/game-of-data/play-with-google-spreadsheets-with-python-301dd4ee36eb" rel="noopener">如何用Python自动化Google Sheets</a>——<a class="nf ng ep" href="https://medium.com/u/c6c6dcd9f4ff?source=post_page-----2f9cec9df4df--------------------------------" rel="noopener" target="_blank">Dayal Chand Aichara</a></p><p id="307b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> RFM: </strong></p><p id="d878" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/know-your-customers-with-rfm-9f88f09433bc">与RFM一起了解你的客户</a>——<a class="nf ng ep" href="https://medium.com/u/619a5a7c0c22?source=post_page-----2f9cec9df4df--------------------------------" rel="noopener" target="_blank">叶小开·阿恩·贝克</a></p><p id="3d55" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> UbiOps: </strong></p><p id="bcef" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://medium.com/ubiops-tech/how-to-build-and-implement-a-recommendation-system-from-scratch-in-python-b5a04d9e8331" rel="noopener">如何从头开始构建和实现推荐系统(Python语言)</a></p></div></div>    
</body>
</html>