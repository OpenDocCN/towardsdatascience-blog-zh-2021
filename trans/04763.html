<html>
<head>
<title>Visualising Star Trek character interactions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化星际迷航人物互动</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualising-star-trek-character-interactions-b337c6ca0afb?source=collection_archive---------31-----------------------#2021-04-25">https://towardsdatascience.com/visualising-star-trek-character-interactions-b337c6ca0afb?source=collection_archive---------31-----------------------#2021-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="79bf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用<a class="ae kf" href="https://networkx.org/" rel="noopener ugc nofollow" target="_blank"> Networkx </a>、<a class="ae kf" href="https://pyvis.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Pyvis </a>、&amp;、<a class="ae kf" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>创建网络仪表板</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/c12c5a3f4b10cdd40dbd089b6569436e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iiSQF9vSDekF5rLbP0Z_tA.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">每部《星际迷航》系列的主要角色互动的频率(图片由作者提供)</p></figure><p id="6d11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可能遇到过交互式网络图(如果没有，我会推荐José Manuel Nápoles Duarte 使用这个应用程序)。你可能也遇到过总结电视/电影角色之间互动的网络图(一个例子是最近在r/dataisbeautiful 上发布的<a class="ae kf" href="https://www.reddit.com/r/dataisbeautiful/comments/m9cver/oc_interaction_intensity_in_lord_of_the_rings/" rel="noopener ugc nofollow" target="_blank">)。但是你见过<em class="ls">互动</em>人物<em class="ls">互动</em>图形(ICIG)吗？嗯，我制作了</a><a class="ae kf" href="https://gmorinan-trekviz-app-d7h5oq.streamlit.app" rel="noopener ugc nofollow" target="_blank">这个仪表板，其中包含《星际迷航》系列</a>中每一部的ICIGs，本文的其余部分将解释关键步骤。</p><h1 id="5863" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">1.找到数据</h1><p id="355a" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><em class="ls">经常检查别人是否已经为你做了工作</em></p><p id="2418" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有数据科学项目都是从数据采集开始的。经过一番搜索，我找到了一个网站，上面有我需要的东西，每一集《星际迷航》的脚本(不包括最近的系列)，格式一致:</p><div class="mq mr gp gr ms mt"><a href="http://www.chakoteya.net/" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">黄诗丹的成绩单网站</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">如果有任何更正，请发电子邮件给chakoteya dot net脸书集团的chrissie。CBS新推出的《星际迷航》系列是第一集…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">www.chakoteya.net</p></div></div></div></a></div><p id="71b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更重要的是，我甚至不用写脚本就可以从这个网站下载所有这些脚本。原来有人已经这样做了，并把它们都放在Kaggle上的JSON中:</p><div class="mq mr gp gr ms mt"><a href="https://www.kaggle.com/gjbroughton/start-trek-scripts" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">星际迷航剧本</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">所有《星际迷航》系列剧本的原始文本剧本和经过处理的台词</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">www.kaggle.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh kq mt"/></div></div></a></div><h1 id="29c5" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">2.处理数据</h1><p id="276b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">总是检查你的输出是否通过常识测试</p><p id="0817" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然《星际迷航》的每一个剧本都是伟大的文学作品，但我来这里只是为了冰冷的硬数据。我所关心的是两个字符有连续行的频率(这就是我如何定义这两个字符之间的一个“交互”)。</p><p id="feae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计算这个需要使用一些选择正则表达式来解析所有的抄本。这里有相当多的普通步骤，所以我只挑选几个处理步骤的几个例子:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">从原始脚本到场景列表</p></figure><p id="4a3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">又走了几步，我找到了一个包含每一行对话的数据框架，然后它可以被转换成一个包含每集角色之间互动次数的表格:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nk"><img src="../Images/27c68fa7fa5875304c4826fe8ed10798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cpX89bd15Acm7HADa5P9xw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">《星际迷航:原始系列》第一集的台词和互动</p></figure><p id="6e26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是在我得到这个最终输出之前，我的解析代码经历了几次迭代。每次迭代之后，我都会看着输出，问自己一些问题，比如:</p><p id="0672" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">q)为什么有些剧集只有30行对白？(答:解析代码中有一个错误，需要更新)。</p><p id="802a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">q)为什么有那么多场景只有1行对白？(答:解析代码中有一个错误，需要更新)。</p><p id="7af2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">问:为什么有少数几集的对话行数是平均水平的两倍？(答:部分笔录为两集)。</p><p id="3db0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当输出看起来很奇怪时，大多数时候是代码有问题。</p><h1 id="f717" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">3.创建交互图</h1><p id="68b4" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><em class="ls"> Networkx:自2005年以来创建Python网络图</em></p><p id="b2e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了数据，是时候开始制作交互图了。据我所见，<a class="ae kf" href="https://networkx.org/" rel="noopener ugc nofollow" target="_blank"> Networkx </a>提供了用python定义图形的最直接的方法。</p><p id="0c4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下面的代码片段中，我们遍历每个字符，设置节点的属性以匹配我们希望该字符的节点如何显示。然后我们遍历交互表中的每个条目:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">制作网络图</p></figure><h1 id="3f19" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">4.让它互动</h1><p id="de3e" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><em class="ls"> Pyvis:用几行代码制作互动网络</em></p><p id="b35a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没有理由不尝试Pyvis(即使您和我一样，更熟悉Networkx ),因为Pyvis可以直接从Networkx graph对象中读取。无论您向Networkx节点添加什么属性，都将被转移到这个Pyvis图中。值得一读的是Pyvis文档，看看所有可以设置的属性，尤其是关于物理引擎的。</p><p id="d6e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦有了Pyvis对象，就可以直接生成一个在应用程序中使用的HTML文件(我已经使用过Streamlit，下面会详细介绍):</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">Networkx -&gt; Pyvis -&gt; HTML</p></figure><h1 id="56b9" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">5.部署应用程序</h1><p id="45b1" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><em class="ls"> Streamlit:将数据科学家转变为应用开发者</em></p><p id="df1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">应用程序部署的平台即服务已经存在一段时间了(如<a class="ae kf" href="https://www.heroku.com/home" rel="noopener ugc nofollow" target="_blank"> Heroku </a>或<a class="ae kf" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>)，但是<a class="ae kf" href="http://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>使得构建和部署一个简单的单页应用程序变得非常快。对于想要成为应用程序开发人员但无法理解Flask的数据科学家来说，这是一个完美的解决方案！</p><p id="2cd2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Streamlit提供了几个小部件，如选择框、复选框和滑块，可用于让用户轻松定制选项:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/0ff8df627800bfddee30c2704fe78fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*VKKbYnS6ysITIGqy6tNU8w.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">Streamlit小部件:选择框(左)，复选框和滑块(右)(作者图片)</p></figure><p id="b0c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些小部件中的每一个都可以用一行代码添加(在下面的代码片段中，每个部件都被添加到侧边栏，因此使用了<strong class="ky ir"> st.sidebar </strong>):</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">真的就这么简单！</p></figure><p id="e948" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最重要的是，Streamlit将免费托管您的应用程序(前提是您乐于公开您的代码)，这就是所需的全部内容:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/0fdd9807def09aa236fe80e56d58b322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I3KXmM51eeTikMetO-nuZA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">Streamlit应用部署流程(图片由作者提供)</p></figure><p id="f54f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终的应用程序看起来像这样(并且包含一个额外的<a class="ae kf" href="https://altair-viz.github.io/)" rel="noopener ugc nofollow" target="_blank">牛郎星</a>时间序列):</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nn"><img src="../Images/b7db5f64728293fce2306ed68b6c2ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9WH7e83mDMR2qT4-csHjw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">最终的应用仪表板是什么样子的(图片由作者提供)</p></figure><h1 id="b171" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">看一下源代码</h1><p id="9ed9" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><a class="ae kf" href="https://gmorinan-trekviz-app-d7h5oq.streamlit.app" rel="noopener ugc nofollow" target="_blank">星际迷航互动角色互动图应用</a>的完整代码可以在这个库中找到(其中包括一些额外的HMTL版本的互动图，每个图节点都是那个角色的图像):</p><div class="mq mr gp gr ms mt"><a href="https://github.com/gmorinan/trekviz" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">gmorinan/trekviz</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">仪表板用于显示不同星际迷航系列中角色有多少台词和互动。要运行…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">github.com</p></div></div></div></a></div></div></div>    
</body>
</html>