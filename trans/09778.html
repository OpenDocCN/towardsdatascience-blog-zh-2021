<html>
<head>
<title>Why Training your CNN with 16 Bit Images isn’t Working</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么用16位图像训练CNN不起作用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-training-your-cnn-with-16-bit-images-isnt-working-e91da350c49d?source=collection_archive---------17-----------------------#2021-09-13">https://towardsdatascience.com/why-training-your-cnn-with-16-bit-images-isnt-working-e91da350c49d?source=collection_archive---------17-----------------------#2021-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="800f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在Keras和Tensorflow中使用Uint16图像实现CNN时的注意事项</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/934fd23289dcbf6ad7815c96b394fc4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fVniO2FZsuP4wwfJXdpf5g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@halacious?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">的照片</a>在<a class="ae kv" href="https://unsplash.com/s/photos/brain?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">的Unsplash </a></p></figure><p id="af0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近我在做一个项目，训练CNN识别卫星图像中的开阔海洋现象，我很难得到结果。这些图像是GeoTIFF格式，这是科学界基于TIFF格式的一种流行文件类型，尤其适用于使用GIS的应用程序。根据<a class="ae kv" href="https://rmets.onlinelibrary.wiley.com/doi/full/10.1002/gdj3.73" rel="noopener ugc nofollow" target="_blank">来源</a>，“高精度值(16位)以及地理信息被保留，用于基于机器学习的方法的开发……”以及图像的检查</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/00deaf36f80044bf2ae03d3457430558.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*IcJ6DrwkGEfmyrqH-cHo6g.png"/></div></figure><p id="1054" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">暗示它们是三个通道的图像，尽管图像在视觉上是灰度的。嗯，训练还是不顺利，我也不知道为什么。经过几个小时的谷歌搜索，阅读github问题线程，浏览StackOverflow，我终于找到了一个解决方案，我希望它可以节省你的时间。</p><p id="bfea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你已经在大量数据上训练了神经网络，特别是图像，你会知道你必须成批地将图像传递给你的网络进行训练，因为总数据量大于你的计算机一次可以加载到它的工作存储器中的数据量。这种技术在TensorFlow中的实现是从他们的<code class="fe lt lu lv lw b">Image Data Generator</code>类中调用的<code class="fe lt lu lv lw b">flow_from_directory()</code>。我的项目中的代码，创建策略学习中使用的测试、训练和验证图像集，最初看起来像</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/9dd278103203de917c8621e3f50500f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*gCZ_Q4ZxqV_zI9W0v1sj1w.png"/></div></figure><p id="5e88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中<code class="fe lt lu lv lw b">color_mode</code>被设置为<code class="fe lt lu lv lw b">‘rgb’</code>，因为根据TensorFlow的文档</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/ff3030090688c0e003360e996b23d032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*xLklQYb1k6XmArENDpR-Nw.png"/></div></figure><p id="c2ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我知道我的图像有三个通道。然而，我最终能够在一些github问题线程中追踪到TensorFlow当前未设置为处理16位RBG图像，它会尝试将我的图像的第一个通道中包含的像素值压缩到0到255之间，这是8位图像的允许值，而不是保留0到65535之间的准备好的高分辨率16位像素值。通过快速检查生成器加载的一个图像像素数组，我验证了这是真的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/ab37cf1ef89016754aa61653588eb904.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*vHEm9XSwTLg2jxTTNvxghQ.png"/></div></figure><p id="ffca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我所有的图像都是单调的白色图像！难怪它学不到任何东西..总之，经过进一步的检查，我发现我的图像中的像素值都包含在第一个通道中，是灰度合成孔径雷达图像，而其他通道包含其他信息。这些信息可能在其他机器学习应用中有用，但对于CNN的训练，我只对像素数据感到满意，更重要的是Tensorflow <em class="ma">可以</em>处理16位灰度图像。因此，只需将上面生成器代码中的参数<code class="fe lt lu lv lw b">color_mode</code>改为<code class="fe lt lu lv lw b">‘grayscale’</code>，就像这样</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/5a514769a8f361254ddbc333907f8827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*54VRKPV4uBeMedB1jMW9mA.png"/></div></figure><p id="c672" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我开始得到结果！为了验证这一点，我们可以再次查看一个图像数组:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/03f68de6e3e8046e1dfd93ca35fe33cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/1*wdL2_dt90ZiAQ_HuSiIiLQ.png"/></div></figure><p id="f22f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一些CNN可以适当借鉴的数据。虽然我希望这对你们中的一些人有所帮助，并在我和其他人遇到的特定问题上为你们节省一些时间，但我们也可以从解决问题的步骤中学习。当谈到CNN和一般的神经网络时，它们可能是一种黑箱，这意味着无论它们是否工作，都很难确定原因。就像这个问题一样，它们不工作的原因通常与提供给网络的数据质量有关。因此，开始故障排除的一个好地方是仔细检查您的数据源，并确保传递的信息是您的神经网络类型能够消化的形式。如果还是不行，就多加几层(开玩笑…大部分)。感谢阅读！</p></div></div>    
</body>
</html>