<html>
<head>
<title>Custom Object DetectionUsing React with Tensorflow.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自定义对象检测使用React with Tensorflow.js</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/custom-object-detection-using-react-with-tensorflow-js-7f79adee9cd4?source=collection_archive---------9-----------------------#2021-07-20">https://towardsdatascience.com/custom-object-detection-using-react-with-tensorflow-js-7f79adee9cd4?source=collection_archive---------9-----------------------#2021-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c299" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">与TENSORFLOW反应。射流研究…</h2><div class=""/><div class=""><h2 id="34f7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">让我们用Azure自定义视觉在不到30分钟的时间内训练一个实时自定义对象检测器</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/9d8ba8ebe35eeb574226d6e1304e7663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f_zpjK3E_HNOtNNj"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">詹娜·哈姆拉摄于<a class="ae lh" href="https://www.pexels.com/photo/pink-floral-selective-focus-photography-979931/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a></p></figure><p id="6534" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你听说过有人使用人工智能来解决他们的行业问题吗，比如<a class="ae lh" href="https://www.nature.com/articles/d41586-020-03157-9" rel="noopener ugc nofollow" target="_blank">医生使用人工智能识别癌细胞</a>，CCTV识别货架上的空产品，甚至是cat探测器？这些“人工智能”背后的基本逻辑是<em class="me">自定义对象检测。</em></p><p id="ee59" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">欢迎来到我的与Tensorflow.js反应系列的第四个故事，在这个故事中，我们将探索<strong class="lk jd">如何通过向AI提供大量药丸图像来训练它检测定制药丸</strong>💊💊使用Microsoft Azure自定义视觉。(不到30分钟！)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/c795a81d26de62ce5af40c170821c6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*3NLCr5tMTFbDk7lOkO9KTQ.gif"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者使用react with tensorflow.js. GIF自定义药丸检测器</p></figure><p id="6073" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在家里用一个简单的黄色药丸玩<a class="ae lh" href="https://pilldetect.manfye.com/" rel="noopener ugc nofollow" target="_blank">这里</a>，或者访问代码<a class="ae lh" href="https://github.com/manfye/react-tfjs-azure-objDetect" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="5725" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">*注意:此web应用程序不仅仅对桌面视图进行了优化。</em></p><h2 id="5fe8" class="mg mh it bd mi mj mk dn ml mm mn dp mo lr mp mq mr lv ms mt mu lz mv mw mx iz bi translated">💡目标检测</h2><p id="e289" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">目标检测是一项计算机视觉任务，包括两个主要任务:</p><ol class=""><li id="ea5c" class="nd ne it lk b ll lm lo lp lr nf lv ng lz nh md ni nj nk nl bi translated">定位图像中的一个或多个对象，以及</li><li id="bf60" class="nd ne it lk b ll nm lo nn lr no lv np lz nq md ni nj nk nl bi translated">对图像中的每个对象进行分类</li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/a3f937691467826e8dadeb070bebd718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/0*1M6hD0n2TdyfgvqR.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图像分类与目标检测(分类和定位)。原文照片由<a class="ae lh" href="https://www.pexels.com/@kmerriman?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">克里斯滕·梅里曼</a>从<a class="ae lh" href="https://www.pexels.com/photo/short-coated-gray-cat-20787/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄，照片由<a class="ae lh" href="https://www.pexels.com/@mccutcheon?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">莎伦·麦卡琴</a>从<a class="ae lh" href="https://www.pexels.com/photo/person-holding-siamese-cat-and-chihuahua-1909802/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</p></figure><p id="3671" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">与图像分类(图2)相反，对象检测的目标是通过边界框和所定位对象的类别来预测对象在图像中的位置，输出可以多于一个类别。关于深入的解释，你可以在我之前的文章<a class="ae lh" rel="noopener" target="_blank" href="/how-to-use-tensorflow-js-in-react-js-object-detection-98b3782f08c2">这里</a>阅读</p><h2 id="9f3d" class="mg mh it bd mi mj mk dn ml mm mn dp mo lr mp mq mr lv ms mt mu lz mv mw mx iz bi translated">💡自定义对象检测</h2><p id="34b5" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">目前，网上有各种预训练的模型，如<a class="ae lh" href="https://github.com/tensorflow/tfjs-models/tree/master/coco-ssd" rel="noopener ugc nofollow" target="_blank"> COCO-SSD </a>，能够检测80多种常见用途的对象，如检测人、铅笔和智能手机。然而，这个模型不能满足检测自定义对象的需要，以我的情况为例，我是一名药剂师，我想做一个web应用程序，能够检测和计数网络摄像机中的药丸。</p><p id="99fe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">传统上，为了训练一个自定义对象，你需要尽可能多地将带标签的图像输入到训练框架中，比如tensorflow和pytorch。然后运行该框架以获得能够检测目标的最终训练模型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/d0ba39e240d1183d9d303d60b5958585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eAGHkkJnuw3-FMjHLIFJw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">训练自定义对象检测模型的流程。作者图片</p></figure><p id="9101" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">目前，<em class="me">最先进的方法</em>是使用pytorch和tensorflow等训练框架来训练模型，但是这种方法有很多缺点，如计算量大、设置时间长、需要显卡以及不适合初学者。</p><p id="bc69" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，出现了商业(免费层可用)的方法来训练模型。在本文中，我将展示使用<a class="ae lh" href="https://www.customvision.ai/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">微软Azure自定义视觉</strong> </a> <strong class="lk jd">方法的方式，只需几次点击<strong class="lk jd">就可以训练一个tensorflow.js对象检测模型</strong>。</strong></p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="ff76" class="oa mh it bd mi ob oc od ml oe of og mo ki oh kj mr kl oi km mu ko oj kp mx ok bi translated"><strong class="ak">🔎</strong>物体检测模型训练</h1><p id="1cd4" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">自定义视觉是微软Azure应用计算机视觉的AI服务和端到端平台。[1]它为Azure用户提供了一个免费层来训练他们的对象检测或图像分类器模型，并将其作为一个API(在我们的例子中，我们下载了生成的模型<strong class="lk jd">😎</strong>)跨网。对于自由层，它允许每个项目多达5，000个训练图像，这足以检测几类对象。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/613b33f35bcfdb1d1f0ef7d2b4e48116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sZIj-AhaH7ZWQvhKhjFx-Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Azure自定义视觉定价。作者图片</p></figure><p id="a042" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉注册完成后，点击<strong class="lk jd">“新建项目”</strong>将出现资源选择界面，点击【新建】进入<strong class="lk jd">新建资源</strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi om"><img src="../Images/c400a52e6352a788e8cef6e802a43237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*TKgL2-hwfjFHW32SWlGvDw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">创建新项目。作者图片</p></figure><p id="f860" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉然后，<strong class="lk jd">创建一个新的资源组</strong>并选择种类:<strong class="lk jd">“定制视觉，培训”</strong>和定价等级到<strong class="lk jd">“F0”</strong>以使用定制视觉培训的免费等级</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi on"><img src="../Images/863de9ee63db25b7b81100c9ff92ffe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*L49jEXFfJNqnSmZCrdMFjw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">创建新资源。作者图片</p></figure><p id="cf64" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉回到“创建新项目”页面，你会注意到一旦你选择了资源，你可以选择项目类型和域，选择“<strong class="lk jd">对象检测</strong>和<strong class="lk jd">通用(压缩)</strong>。通过选择compact，微软Azure允许你下载各种格式的训练模型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/5d322bde4831180ffa0c322e289fac74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*YEE5qLpowvKiUxGin_91Og.png"/></div></figure><p id="b4c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉您将到达如下图所示的培训平台，<strong class="lk jd">点击图片上传</strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/e290a7775ce5d9c8dda4683bc2f4cf63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hmgZZhCJeUl3q5522-VRHw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">定制视力训练平台。作者图片</p></figure><p id="d8ac" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉上传您的未标记的图像用于标记目的。对于本文，我的药丸图片资源是<a class="ae lh" href="https://drive.google.com/drive/folders/1sCZ6y5W_iXmiyh6Ejzfe0p_BIrpM_goP" rel="noopener ugc nofollow" target="_blank">这里</a>。[2]就我而言，我上传了大约50-100张图片用于训练。</p><p id="8cba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">感谢Github用户</em><a class="ae lh" href="https://github.com/mepotts" rel="noopener ugc nofollow" target="_blank"><em class="me">mepotts</em></a><em class="me">提供图片资源。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/34cd5b7d2acecadcee7ec0167171eda4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*lRH8pyZ0LZVNU99e2Bp-Dg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">上传的图片。作者图片</p></figure><p id="cd01" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉接下来，逐一标记您的图像(这是繁琐的部分)，幸运的是，Custom Vision为您提供了一个非常用户友好的标记工具，可以简化您的标记过程。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/ff8d08141b00793aaf3429d75f816725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-9jDJCPh4j1AK5LUTQ9vQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图像的标记。作者图片</p></figure><p id="8d5b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉完成标记后，点击<strong class="lk jd">“训练”</strong>按钮，等待几分钟，结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/136a5fc95b15e521f3f753fc35247a88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BbUyrNDsjUvgP7LLPto6rQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">培训结果。作者图片</p></figure><p id="07c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">👉点击<strong class="lk jd">导出</strong>选择Tensorflow，然后<strong class="lk jd"> TensorFlow.js </strong>导出。恭喜您，您在Tf.js中拥有了第一个自定义对象检测模型</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/710d7c7bed78dd04947529bd5b6a7c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*GrSnfIK9Cu1zj4nzsjRM-A.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">已训练模型的导出。作者图片</p></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="581e" class="oa mh it bd mi ob oc od ml oe of og mo ki oh kj mr kl oi km mu ko oj kp mx ok bi translated"><strong class="ak">🔎</strong>使用React with Tensorflow.js检测自定义对象</h1><h2 id="0e95" class="mg mh it bd mi mj mk dn ml mm mn dp mo lr mp mq mr lv ms mt mu lz mv mw mx iz bi translated">1.设置您的创建反应应用程序</h2><p id="0bca" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">通过终端中的以下命令创建一个<a class="ae lh" href="https://reactjs.org/docs/create-a-new-react-app.html" rel="noopener ugc nofollow" target="_blank"> Create-React-App </a>:</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="26ca" class="mg mh it ov b gy oz pa l pb pc">npx create-react-app tfjs-azureObject<br/>cd tfjs-azureObject</span></pre><p id="71a6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">安装tensorflow.js和Microsoft Customvision，如下所示:</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="53cf" class="mg mh it ov b gy oz pa l pb pc">npm install @tensorflow/tfjs<br/>npm install @microsoft/customvision-tfjs</span></pre><p id="817d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">安装react-网络摄像头，如下所示:</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="0d97" class="mg mh it ov b gy oz pa l pb pc">npm install react-webcam</span></pre><p id="f8b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">并启动应用程序</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="65e6" class="mg mh it ov b gy oz pa l pb pc">npm start</span></pre><blockquote class="pd pe pf"><p id="bd5d" class="li lj me lk b ll lm kd ln lo lp kg lq pg ls lt lu ph lw lx ly pi ma mb mc md im bi translated">所有代码只会发生在App.js中，我只会显示重要的代码，完整代码可以参考我的<a class="ae lh" href="https://github.com/manfye/react-tfjs-azure-objDetect" rel="noopener ugc nofollow" target="_blank"> GitHub库</a></p></blockquote><h2 id="e18d" class="mg mh it bd mi mj mk dn ml mm mn dp mo lr mp mq mr lv ms mt mu lz mv mw mx iz bi translated">2.导入所需的包</h2><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="6f6b" class="mg mh it ov b gy oz pa l pb pc">import React, { useEffect, useState, useRef } from "react";<br/>import Webcam from "react-webcam";<br/>import * as cvstfjs from "@microsoft/customvision-tfjs";</span></pre><p id="4554" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">3.构建用户界面<br/>该项目的用户界面包括:</p><ul class=""><li id="b2d8" class="nd ne it lk b ll lm lo lp lr nf lv ng lz nh md pj nj nk nl bi translated">按钮—用于启动检测</li><li id="178a" class="nd ne it lk b ll nm lo nn lr no lv np lz nq md pj nj nk nl bi translated">画布-用于绘制边界框，以及</li><li id="4af6" class="nd ne it lk b ll nm lo nn lr no lv np lz nq md pj nj nk nl bi translated">网络摄像头—用于输入图像/视频</li></ul><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="61da" class="mg mh it ov b gy oz pa l pb pc">//<strong class="ov jd">Button</strong>: Trigger a predictionFunction() on Click</span><span id="37e8" class="mg mh it ov b gy pk pa l pb pc">&lt;Button<br/>variant={"contained"}<br/>style={{<br/>color: "white",<br/>backgroundColor: "blueviolet",<br/>width: "50%",<br/>maxWidth: "250px",<br/>}}<br/>onClick={() =&gt; {<br/>predictionFunction();<br/>}}<br/>&gt;<br/>Start Detect<br/>&lt;/Button&gt;</span><span id="9121" class="mg mh it ov b gy pk pa l pb pc"><strong class="ov jd">Webcam:</strong><br/>const webcamRef = React.useRef(null);<br/>const [videoWidth, setVideoWidth] = useState(960);<br/>const [videoHeight, setVideoHeight] = useState(640);</span><span id="ff2c" class="mg mh it ov b gy pk pa l pb pc">const videoConstraints = {<br/>height: 1080,<br/>width: 1920,<br/>facingMode: "environment",<br/>};&lt;div style={{ position: "absolute", top: "400px" }}&gt;<br/>&lt;Webcam<br/>audio={false}<br/>id="img"<br/>ref={webcamRef}<br/>screenshotQuality={1}<br/>screenshotFormat="image/jpeg"<br/>videoConstraints={videoConstraints}<br/>/&gt;<br/>&lt;/div&gt;</span><span id="84a5" class="mg mh it ov b gy pk pa l pb pc"><strong class="ov jd">Canvas:</strong><br/>&lt;div style={{ position: "absolute", top: "400px", zIndex: "9999" }}&gt;<br/>&lt;canvas<br/>id="myCanvas"<br/>width={videoWidth}<br/>height={videoHeight}<br/>style={{ backgroundColor: "transparent" }}<br/>/&gt;<br/>&lt;/div&gt;</span></pre><blockquote class="pd pe pf"><p id="ae88" class="li lj me lk b ll lm kd ln lo lp kg lq pg ls lt lu ph lw lx ly pi ma mb mc md im bi translated"><em class="it">注意:画布和网络摄像头的大小和位置必须相同，才能在HTML画布中进行绘制。</em></p></blockquote><h2 id="f3bb" class="mg mh it bd mi mj mk dn ml mm mn dp mo lr mp mq mr lv ms mt mu lz mv mw mx iz bi translated">4.加载模型</h2><p id="2920" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">将下载的模型解压到<strong class="lk jd">“Public”文件夹</strong>中，确保model.json正确地放在/model.json路径中，并带有weights.bin。要使用模型进行预测，代码很简单:</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="75a1" class="mg mh it ov b gy oz pa l pb pc">async function predictionFunction() {<br/>setVideoHeight(webcamRef.current.video.videoHeight);<br/>setVideoWidth(webcamRef.current.video.videoWidth);</span><span id="4d5e" class="mg mh it ov b gy pk pa l pb pc">//testing azure vision api<br/>let model = new cvstfjs.ObjectDetectionModel();<br/>await model.loadModelAsync("model.json");<br/>const predictions = await model.executeAsync(<br/>document.getElementById("img")<br/>);</span></pre><p id="668f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然而，当预测的类必须显示在照片中时，事情就变得复杂了，这就是使用HTML canvas的原因。整个预测函数如下所示:</p><pre class="ks kt ku kv gt ou ov ow ox aw oy bi"><span id="e7d7" class="mg mh it ov b gy oz pa l pb pc">async function predictionFunction() {<br/>setVideoHeight(webcamRef.current.video.videoHeight);<br/>setVideoWidth(webcamRef.current.video.videoWidth);</span><span id="ad86" class="mg mh it ov b gy pk pa l pb pc">//testing azure vision api<br/>let model = new cvstfjs.ObjectDetectionModel();<br/>await model.loadModelAsync("model.json");</span><span id="b121" class="mg mh it ov b gy pk pa l pb pc">const predictions = await model.executeAsync(<br/>document.getElementById("img")<br/>);</span><span id="2f01" class="mg mh it ov b gy pk pa l pb pc">var cnvs = document.getElementById("myCanvas");<br/>cnvs.style.position = "absolute";<br/>var ctx = cnvs.getContext("2d");<br/>ctx.clearRect(0, 0, cnvs.width, cnvs.height);</span><span id="e1a1" class="mg mh it ov b gy pk pa l pb pc">console.log(predictions);</span><span id="eb31" class="mg mh it ov b gy pk pa l pb pc">if (predictions[0].length &gt; 0) {<br/>for (let n = 0; n &lt; predictions[0].length; n++) {<br/>// Check scores<br/>if (predictions[1][n] &gt; 0.5) {<br/>const p = document.createElement("p");</span><span id="65f3" class="mg mh it ov b gy pk pa l pb pc">p.innerText = "Pill" + ": " + Math.round(parseFloat(predictions[1][n]) * 100) + "%";</span><span id="c3c1" class="mg mh it ov b gy pk pa l pb pc">let bboxLeft = predictions[0][n][0] * webcamRef.current.video.videoWidth;</span><span id="8b51" class="mg mh it ov b gy pk pa l pb pc">let bboxTop = predictions[0][n][1] * webcamRef.current.video.videoHeight;</span><span id="54f6" class="mg mh it ov b gy pk pa l pb pc">let bboxWidth = predictions[0][n][2] * webcamRef.current.video.videoWidth - bboxLeft;</span><span id="6bd8" class="mg mh it ov b gy pk pa l pb pc">let bboxHeight = predictions[0][n][3] * webcamRef.current.video.videoHeight - bboxTop;</span><span id="c5ab" class="mg mh it ov b gy pk pa l pb pc">ctx.beginPath();<br/>ctx.font = "28px Arial";<br/>ctx.fillStyle = "red";<br/>ctx.fillText( "Pill" + ": " + Math.round(parseFloat(predictions[1][n]) * 100) + "%", bboxLeft, bboxTop + 70 );</span><span id="c572" class="mg mh it ov b gy pk pa l pb pc">ctx.rect(bboxLeft, bboxTop + 80, bboxWidth, bboxHeight);<br/>ctx.strokeStyle = "#FF0000";<br/>ctx.lineWidth = 3;<br/>ctx.stroke();</span><span id="a693" class="mg mh it ov b gy pk pa l pb pc">}}</span><span id="ea62" class="mg mh it ov b gy pk pa l pb pc">setTimeout(() =&gt; predictionFunction(), 500);<br/>}}</span></pre><p id="514f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">该函数将创建一个边界框，在该框上方显示检测到的对象类别。</em>它包括4个部分，第一部分是清除绘制的HTML画布，然后开始对象的模型检测。</p><p id="f63e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果模型检测到对象，模型将返回预测数据。通过使用边界框数据，我们可以使用HTML画布绘制来绘制边界框。然后，使用500毫秒的超时重新运行整个功能，我们将运行我们的对象检测web应用程序。</p><h1 id="9210" class="oa mh it bd mi ob pl od ml oe pm og mo ki pn kj mr kl po km mu ko pp kp mx ok bi translated">最终想法</h1><p id="dc9f" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">这是我关于用Tensorflow.js进行React的第四篇文章的结尾，我很高兴能够通过介绍React中的这个精彩工具来帮助TF.js社区。</p><p id="36af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我们演练了如何使用Microsoft Custom Vision free层创建自定义对象检测模型，这大大减少了创建自定义对象检测模型的工作量和障碍(我认为减少了80%)。然后，我们使用react将模型合并到Tensorflow.js中，并用不到100行代码编写了整个web应用程序。</p><p id="a3a4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">每个行业对定制对象检测的需求都很高，在本文中，我为我的药房使用创建了一个药丸计数器，我希望在了解定制检测技术后，它可以启发您为您的行业创建更多工具。如果你这样做，一定要和我分享！</p><p id="40f6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，</p><p id="3793" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">感谢您的阅读。</p><p id="c7eb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">希望你喜欢这篇文章</p><h1 id="267e" class="oa mh it bd mi ob pl od ml oe pm og mo ki pn kj mr kl po km mu ko pp kp mx ok bi translated">我对Tensorflow.js文章的反应:</h1><div class="pq pr gp gr ps pt"><a rel="noopener follow" target="_blank" href="/how-to-use-tensorflow-js-in-react-js-object-detection-98b3782f08c2"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd jd gy z fp py fr fs pz fu fw jc bi translated">如何在react.js中使用tensorflow.js对象检测</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">使用COCO-SSD模型定位和识别单个图像中的多个对象</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="qd l qe qf qg qc qh lb pt"/></div></div></a></div><div class="pq pr gp gr ps pt"><a rel="noopener follow" target="_blank" href="/how-to-use-tensorflow-js-in-react-js-sentimental-analysis-59c538c07256"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd jd gy z fp py fr fs pz fu fw jc bi translated">如何在react.js中使用tensorflow.js情感分析</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">2018年3月，谷歌发布了tensor flow . js 1.0版本，该版本使开发者能够使用机器学习(ML)模型…</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="qi l qe qf qg qc qh lb pt"/></div></div></a></div><div class="pq pr gp gr ps pt"><a rel="noopener follow" target="_blank" href="/loading-models-into-tensorflow-js-using-react-js-f3e118ee4a59"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd jd gy z fp py fr fs pz fu fw jc bi translated">使用react.js将模型加载到tensorflow.js</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">立即在react.js中使用您的python Tensorflow模型</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="qj l qe qf qg qc qh lb pt"/></div></div></a></div><h1 id="3570" class="oa mh it bd mi ob pl od ml oe pm og mo ki pn kj mr kl po km mu ko pp kp mx ok bi translated">参考</h1><ol class=""><li id="91ad" class="nd ne it lk b ll my lo mz lr qk lv ql lz qm md ni nj nk nl bi translated">【https://www.customvision.ai/ T4】</li><li id="5bc3" class="nd ne it lk b ll nm lo nn lr no lv np lz nq md ni nj nk nl bi translated"><a class="ae lh" href="https://github.com/mepotts/Pill-Detection" rel="noopener ugc nofollow" target="_blank">https://github.com/mepotts/Pill-Detection</a></li></ol></div></div>    
</body>
</html>