<html>
<head>
<title>Multi-step Time Series Forecasting with ARIMA, LightGBM, and Prophet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用ARIMA、LightGBM和Prophet进行多步时间序列预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/multi-step-time-series-forecasting-with-arima-lightgbm-and-prophet-cc9e3f95dfb0?source=collection_archive---------1-----------------------#2021-07-06">https://towardsdatascience.com/multi-step-time-series-forecasting-with-arima-lightgbm-and-prophet-cc9e3f95dfb0?source=collection_archive---------1-----------------------#2021-07-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6470" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="1e8e" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用Python对不同类型的时间序列进行建模，以比较模型算法</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/312b12d27db2c48e884dda4449beca6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aYYyGXnIK_tPlR6K"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·温克勒</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="10c8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">时间序列预测是数据科学领域中一个非常常见的话题。公司使用预测模型来更清楚地了解他们未来的业务。在开发时间序列预测模型时，选择正确的算法可能是最困难的决定之一。在本文中，我们在不同类型的时间序列数据集上比较了三种不同的算法，即SARIMA萨里玛、LightGBM和Prophet。SARIMA萨里玛是最受欢迎的经典时间序列模型之一。<a class="ae le" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank"> Prophet </a>是脸书在2017年开发的较新的静态时间序列模型。<a class="ae le" href="https://lightgbm.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> LightGBM </a>是一种流行的机器学习算法，一般应用于表格数据，可以捕捉其中的复杂模式。</p><p id="adfa" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们使用以下四种不同的时间序列数据来比较这些模型:</p><ol class=""><li id="b7d6" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">循环时间序列(太阳黑子数据)</li><li id="6adb" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">没有趋势和季节性的时间序列(Nile数据集)</li><li id="6cf1" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">趋势强劲的时间序列(WPI数据集)</li><li id="9d19" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">具有趋势和季节性的时间序列(航空数据集)</li></ol><p id="d82c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">虽然我们将在所有四个不同的时间序列上尝试SARIMA萨里玛和LightGBM，但我们将只在航空数据集上模拟Prophet，因为它是为季节性时间序列设计的。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="39d9" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">1.循环时间序列(太阳黑子数据)</h1><p id="0d88" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">周期性时间序列的上升和下降不是固定频率的，这不同于具有固定和已知频率的季节性时间序列。下面的数据集是来自国家地球物理数据中心的太阳黑子年度(1700-2008)数据。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nv"><img src="../Images/06ca38ea8e4067689a3564421d9e78e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XapX2Msri3i31G0qQgVRQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">太阳黑子数据集</p></figure><p id="0760" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我们检查时间序列的平稳性。平稳性意味着时间序列不会随着时间的推移而改变其统计特性，特别是其均值和方差。具有周期行为的时间序列基本上是平稳的，而具有趋势或季节性的时间序列则不是平稳的(<a class="ae le" href="https://otexts.com/fpp3/stationarity.html" rel="noopener ugc nofollow" target="_blank">详见此链接</a>)。我们需要平稳的时间序列来发展稳定的线性模型，如ARIMA。</p><p id="c843" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面，我们将设置并执行一个显示自相关(ACF)和偏自相关(PACF)图的函数，同时执行扩展的Dickey-Fuller单元测试。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/4401becf174d859aba33dd0a922ef30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQ5ZYtO3Fq8ts4GOvt1SCw.png"/></div></div></figure><p id="aa72" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">自相关(ACF)图可以用来判断时间序列是否平稳。这也有助于找到ARIMA模型中移动平均线部分的阶数。偏自相关(PACF)图有助于识别ARIMA模型中自回归部分的阶数。增强的Dickey-Fuller单元测试检验时间序列是否是非平稳的。零假设是序列是非平稳的，因此，如果p值很小，这意味着时间序列不是非平稳的。</p><p id="200d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">上图中，Dickey-Fuller检验p值不够显著(&gt; 5%)。我们将取第一个差值，使级数更加平稳。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nx"><img src="../Images/48474977312fca4b84645d291db4b791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nX9LBcRDTKHAcTYbvZPiBg.png"/></div></div></figure><p id="c294" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这一次，Dickey-Fuller测试p值是显著的，这意味着该序列现在更有可能是平稳的。</p><p id="75d4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">ACF图显示了正弦曲线模式，并且在PACF图中直到滞后8都有显著的值。这意味着ARIMA(8，1，0)模型(我们取第一个差，因此<em class="ny"> d=1 </em>)。您可以在此链接中看到从ACF/PACF图<a class="ae le" href="https://otexts.com/fpp3/non-seasonal-arima.html#acf-and-pacf-plots" rel="noopener ugc nofollow" target="_blank">确定ARIMA参数顺序的一般规则。下一步，我们将使用<code class="fe nz oa ob oc b">sktime</code>包中的<code class="fe nz oa ob oc b">AutoARIMA</code>，它会自动优化ARIMA参数的顺序。考虑到这一点，上面查找ARIMA参数的正确顺序的图形分析看起来是不必要的，但它仍然有助于我们确定参数顺序的搜索范围，并使我们能够验证AutoARIMA的结果。</a></p><p id="e1d1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在建模之前，我们将数据分为训练集和测试集。该系列的前80%将作为训练集，其余20%将作为测试集。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="68d4" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">1.1太阳黑子数据集上的ARIMA</h2><p id="7021" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">ARIMA是最流行的时间序列预测模型之一，它在一个类似回归的模型中同时使用序列的过去值(自回归)和过去的预测误差(移动平均)。模型有三个不同的参数<em class="ny"> p，d </em>，和<em class="ny"> q </em>。<em class="ny"> p </em>是自回归部分的阶次，<em class="ny"> d </em>是涉及的一阶差分的程度，<em class="ny"> q </em>是移动平均部分的阶次。我们需要找到这些参数的正确值，以获得我们的时间序列上最合适的模型。我们这里用的是<code class="fe nz oa ob oc b"><a class="ae le" href="https://www.sktime.org/en/latest/api_reference/modules/auto_generated/sktime.forecasting.arima.AutoARIMA.html" rel="noopener ugc nofollow" target="_blank">sktime</a></code> <a class="ae le" href="https://www.sktime.org/en/latest/api_reference/modules/auto_generated/sktime.forecasting.arima.AutoARIMA.html" rel="noopener ugc nofollow" target="_blank">的</a> <code class="fe nz oa ob oc b"><a class="ae le" href="https://www.sktime.org/en/latest/api_reference/modules/auto_generated/sktime.forecasting.arima.AutoARIMA.html" rel="noopener ugc nofollow" target="_blank">AutoARIMA</a></code>，它是<code class="fe nz oa ob oc b"><a class="ae le" href="http://alkaline-ml.com/pmdarima/" rel="noopener ugc nofollow" target="_blank">pmdarima</a></code>的包装器，可以自动找到那些ARIMA参数(<em class="ny"> p，d，q </em>)。<code class="fe nz oa ob oc b">pmdarima</code>是一个Python项目，它复制了<a class="ae le" href="https://www.rdocumentation.org/packages/forecast/versions/8.15/topics/auto.arima" rel="noopener ugc nofollow" target="_blank"> R的auto.arima </a>功能。你可以在<a class="ae le" href="https://otexts.com/fpp2/arima-r.html" rel="noopener ugc nofollow" target="_blank">链接</a>中看到auto.arima是如何自动调整参数的。由于上面的分析建议ARIMA(8，1，0)模型，我们将start_p和max_p分别设置为8和9。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/a1f52fb7e0532e0c8f9de4564134acfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRXieyMlpTLVy5ME8uBlUg.png"/></div></div></figure><p id="52ad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">结果是<code class="fe nz oa ob oc b">AutoARIMA</code>选择的参数与我们之前的预期略有不同。</p><p id="a8db" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来，我们将设置一个函数，在该函数下绘制模型预测并评估模型性能。我们使用<a class="ae le" href="https://en.wikipedia.org/wiki/Mean_absolute_error" rel="noopener ugc nofollow" target="_blank">平均绝对误差(MAE) </a>和<a class="ae le" href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error" rel="noopener ugc nofollow" target="_blank">平均绝对百分比误差(MAPE) </a>作为性能指标。MAE对预测期内的绝对预测误差进行平均:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi op"><img src="../Images/0ff3bc8c59a69775be86f2c0f0be36b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S28zBRq_fM82OD68nY7paA.png"/></div></div></figure><p id="0c45" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">𝑡是时间，𝑦𝑡是𝑡的实际值，𝑦̂ 𝑡是预测值，𝑛是预测范围。</p><p id="612e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">MAPE是MAE的缩放度量，它是绝对误差除以实际𝑦:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/ede0f1d74d82e8b7d57f45d91f4941bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xq1WnWVCCWVKo5fSnitH7A.png"/></div></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi or"><img src="../Images/03c5a32915428ac78fbd38491f4f1020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FUyAyim0WNWHEtEUbm6Ljg.png"/></div></div></figure><h2 id="a900" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">黑子数据集上的1.2 LightGBM</h2><p id="07ea" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">要使用<a class="ae le" href="https://lightgbm.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> LightGBM </a>进行预测，我们需要首先将时间序列数据转换为表格格式，其中的特征是用时间序列本身的滞后值创建的(即<em class="ny"> 𝑦𝑡−1、𝑦𝑡−2、𝑦𝑡−3 </em>、…)。由于模型只能预测一步预测，当我们创建多步预测时，预测值将用于下一步的特征，这称为多步预测的递归方法(您可以在本文中找到多步预测的不同方法<a class="ae le" href="https://www.researchgate.net/publication/236941795_Machine_Learning_Strategies_for_Time_Series_Forecasting" rel="noopener ugc nofollow" target="_blank">)。软件包为我们提供了这些功能和一个方便的API。在下面的<code class="fe nz oa ob oc b">create_forecaster</code>函数中，<code class="fe nz oa ob oc b">make_reduction</code>包装<code class="fe nz oa ob oc b">LGBMRegressor</code>，并在我们拟合预测器时将输入时间序列转换成表格格式。</a></p><p id="0279" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们也在使用<code class="fe nz oa ob oc b">ForecastingGridSearchCV</code>来寻找最好的滞后特征<code class="fe nz oa ob oc b">window_length</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/8e325acecef589f77216e51a576f3f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UEZL6OIF-8Tmr-uWfgTlNw.png"/></div></div></figure><p id="ebc9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下表总结了两种不同模型的结果。对于这个时间序列数据，LightGBM的表现优于ARIMA。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/3cfc4e1c423752690368ede18c2f45cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHdmWhn77rFB3wCOwHNoGQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd ou">太阳黑子数据上的模型性能</strong></p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="33d9" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">2.没有趋势和季节性的时间序列(Nile数据集)</h1><p id="0aa9" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">尼罗河数据集包含从1871年到1970年的100年间在阿什万测量的尼罗河年流量。时间序列没有任何季节性，也没有明显的趋势。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/b171678acb5a9810e47cb3590d03b9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tkjMQcG_4dILMusRwltMAQ.png"/></div></div></figure><p id="fbc5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">虽然Dickey-Fuller测试表明它是稳定的，但在ACF图中可以看到一些自相关。我们正试图了解它的第一个不同之处。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ow"><img src="../Images/1043b95aa0bc1abea6cda7508f7ca044.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVNz_RmGN7lrwpxA9g-gUw.png"/></div></div></figure><p id="86d0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这看起来比原来更稳定，因为ACF图显示立即下降，并且Dicky-Fuller测试显示更显著的p值。从这个分析中，我们期望ARIMA在<em class="ny"> p </em>和<em class="ny"> q </em>上具有(1，1，0)，(0，1，1)或任何组合值，并且<em class="ny"> d = 1 </em>，因为ACF和PACF在滞后1处显示了重要值。让我们看看AutoARIMA选择什么参数值。</p><h2 id="1782" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">2.1尼罗河数据集上的ARIMA</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ox"><img src="../Images/5ec9c8d5dbc8a3c4e57a431b89f6c967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iKNdg4Rl-UZMDATo8tge3w.png"/></div></div></figure><p id="88d9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">该模型按照预期选择了<em class="ny"> d = 1 </em>，并且在<em class="ny"> p </em>和<em class="ny"> q </em>上都有1。然后，我们创建一个带有评估的预测。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oy"><img src="../Images/fd15dbc7ef0e11a62f72ac5f7821a707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xrH_1kv8O4yldI--lSKT6g.png"/></div></div></figure><p id="8f88" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">由于时间序列中没有明确的模式，该模型预测随着时间的推移，值几乎保持不变。</p><h2 id="1e02" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">Nile数据集上的2.2 LightGBM</h2><p id="8345" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">我们使用与前面的数据相同的函数来开发LightGBM。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oz"><img src="../Images/899f40e25d162566158d8d57b858dd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJUHsxwVuFwDWitudTCy4A.png"/></div></div></figure><p id="2f13" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">原来LightGBM创造了一个与ARIMA相似的预报。下面的汇总表显示这两种型号之间没有太大的区别。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pa"><img src="../Images/525d19091efad0b39f408ac5602778ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B9PVsmpnqYgYwbZg6A8DwA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd ou">Nile数据的模型性能</strong></p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="12c2" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">3.趋势强劲的时间序列(WPI数据集)</h1><p id="d957" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">美国批发价格指数(WPI)从1960年到1990年有一个强劲的趋势，如下图所示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/4396625ce8781e0a66a7548a91688a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nWjEN0XR1Brow4cXdVuz7A.png"/></div></div></figure><p id="94e5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们取第一个差值，使它保持不变。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/8594c22d76160cd74d366f3ec0bba830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YfyC84FT6bfjFng32jWbRg.png"/></div></div></figure><p id="07ae" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">它仍然看起来不稳定，因为ACF随时间缓慢下降，Dicky-Fuller也没有显示出显著的p值。因此，我们又多了一个不同点。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/30c4c901aad5b825bfb5cf28ffcedeee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*STQr2TruycuU98O22QSW_A.png"/></div></div></figure><p id="92f9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，随着Dicky-Fuller的显著值和ACF图显示快速下降，它看起来是稳定的。从这个分析中，我们期望<em class="ny"> d = 2 </em>因为<em class="ny"> </em> it <em class="ny"> </em>需要二阶差分来使其稳定。由于ACF在滞后1时具有重要值，而PACF在滞后2之前具有重要值，我们可以预期<em class="ny"> q = 1或p = 2 </em>。</p><h2 id="cd37" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">3.1 WPI数据集上的ARIMA</h2><p id="4234" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">我们将时间序列分成训练集和测试集，然后在其上训练ARIMA模型。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pe"><img src="../Images/d3cf0d0ae5fb9a790b39021132c5cba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGk6Ba9X5Etw7oeq3k1AJw.png"/></div></div></figure><p id="62f9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">正如前面的分析所证实的，该模型有二级差异。接下来，我们将创建一个预测及其评估。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/790b5668ba5bff308a36cfaeaa2990ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6FHdMX7x2CLciw_QyKoa6A.png"/></div></div></figure><h2 id="2065" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">3.2 WPI数据集上的LightGBM</h2><p id="0ece" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">我们用和以前一样的方式对LightGBM建模，看看它在这个时间序列上是如何工作的。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pg"><img src="../Images/4ebd033a64647ca608be4a43221c732f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MiXPMO_OlOLdP8lxp7kKpw.png"/></div></div></figure><p id="45f0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">LightGBM显然不太好用。由于回归树算法无法预测超出其在训练数据中看到的值，因此如果时间序列有很强的趋势，它就会受到影响。在这种情况下，我们需要在建模之前取消时间序列的趋势。<code class="fe nz oa ob oc b">sktime</code>提供了一个方便的工具<code class="fe nz oa ob oc b">Detrender</code>和<code class="fe nz oa ob oc b">PolynomialTrendForecaster</code>,用于还原可包含在培训模块中的输入序列。</p><p id="f0b4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在将其纳入培训模块之前，我们将在下面演示<code class="fe nz oa ob oc b">PolynomialTrendForecaster</code>，看看它是如何工作的。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ph"><img src="../Images/1e9df2f6f5702d7ed51f4091d78bda8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wOs7dRoUlUDZA68EvbQ6Nw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">线性去趋势</p></figure><p id="edc3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在上图中，你可以看到趋势预测者捕捉到了时间序列中的趋势。</p><p id="21a4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来，我们使用<code class="fe nz oa ob oc b">TransformedTargetForecaster</code>创建一个预测器，它包括包装<code class="fe nz oa ob oc b">PolynomialTrendForecaster</code>的<code class="fe nz oa ob oc b">Detrender</code>和包装在<code class="fe nz oa ob oc b">make_reduction</code>函数中的<code class="fe nz oa ob oc b">LGBMRegressor</code>，然后在<code class="fe nz oa ob oc b">window_length</code>上用网格搜索训练它。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pi"><img src="../Images/ff6c0d1d663674022392b96e89072265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpO1FMSHOriUB0ZQ50IlTw.png"/></div></div></figure><p id="9fad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这一次，LightGBM在detrender的帮助下预测超出训练目标范围的值。</p><p id="40a5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下表总结了两种不同模型在WPI数据上的表现。LightGBM的表现再次优于ARIMA。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pj"><img src="../Images/751639214da6d948a1cf2d7dde51389a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AeBg2kgHcc7fG2uKJbVNtw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd ou">WPI数据的模型性能</strong></p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="ba6c" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">4.具有趋势和季节性的时间序列(航空数据集)</h1><p id="0fe0" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">Box-Jenkins航空公司数据集由1949-1960年间国际航空公司乘客的月度总数(千单位)组成。如下图所示，该数据具有趋势性和季节性。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pk"><img src="../Images/fe1158955e24bf917103531230e60ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzidtUsWklo4BTytoE1biQ.png"/></div></div></figure><p id="4164" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我们取一个季节差异(滞后12)使其稳定。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/3d8f6f2e7cc1af20d544473681ed10cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P-hWS9w2m9lpMh1t8g-xyw.png"/></div></div></figure><p id="605d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">随着ACF缓慢下降，它看起来仍然不是稳定的，所以我们对它进行额外的一阶差分。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/8a4d57412d7dcf5e60500d967e3ec647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2BqG2n6QO0WGtXI3zrvPw.png"/></div></div></figure><p id="5976" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，它看起来是稳定的，因为Dickey-Fuller的p值是显著的，ACF图显示随着时间的推移快速下降。这一分析的结果表明，当ACF和PACF图在滞后1时显示显著值时，SARIMA与<em class="ny"> d = 1 </em>和<em class="ny"> D </em>(季节差异的顺序)<em class="ny"> = 1.p </em>或<em class="ny"> q </em>可以是1。</p><h2 id="9478" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">4.1航空数据集上的SARIMA</h2><p id="ac75" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">接下来，我们将数据分为训练集和测试集，然后在其上开发SARIMA(季节性ARIMA)模型。SARIMA模型具有ARIMA上空的附加季节参数(P，D，Q)。p、D和Q分别代表季节自相关的阶、季节差异的程度和季节移动平均的阶。为了对SARIMA建模，我们需要指定<code class="fe nz oa ob oc b">sp</code>参数(季节周期。在这种情况下，它是12)在<code class="fe nz oa ob oc b">AutoARIMA</code>上。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi or"><img src="../Images/15b9f5d3e258d35bd691c1de3b04fe1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fJuq2Iq2CG4o0GCez1Wrbg.png"/></div></div></figure><p id="f019" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">正如所料，创建的模型有<em class="ny"> d = 1 </em>和<em class="ny"> D = 1 </em>。接下来，我们创建一个带有评估的预测。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/b16ad12a9517eac095aeb29460162ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8LUwbv_wXkxdMoS22PoiQA.png"/></div></div></figure><h2 id="7080" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">4.2航空数据集上的LightGBM</h2><p id="a98e" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">由于时间序列具有季节性，我们在LightGBM预测模块中增加了<code class="fe nz oa ob oc b">Deseasonalizer</code>。由于季节性效应会随着时间的变化而变化，我们在<code class="fe nz oa ob oc b">Deseasonalizer</code>模块上设置了<code class="fe nz oa ob oc b">“multiplicative”</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/c0f6cd6aaa90213a3c7d7ef58b02724c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vanMBxQ1KpBGc-MWmQFxQA.png"/></div></div></figure><h2 id="f0b8" class="od mx iq bd my oe of dn nc og oh dp ng lo oi oj ni ls ok ol nk lw om on nm iw bi translated">4.3航空数据集上的预言者</h2><p id="684f" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated"><a class="ae le" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank"> Prophet </a>是脸书在2017年开发的一个时间序列预测模型，可以有效处理多个季节性(年、周、日)。它还具有整合节假日影响和在时间序列中实现自定义趋势变化的功能。由于我们的时间序列不需要所有这些功能，我们只是在打开年度季节性的情况下使用Prophet。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/b7dbf465c104ed8f0b3ef4d6e5b504a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-3iiCkOdnpyGiRu-6wtBrQ.png"/></div></div></figure><p id="e997" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下表比较了航空公司数据集上三种不同模型的性能指标。虽然这三款车型之间的性能差异不大，但ARIMA的表现略好于其他车型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/78593659c74f0b1d870793f4fe8964a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gRoyRpatOGhJ-KgmGkEc2Q.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd ou">航空公司数据上的模型性能</strong></p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="8cbb" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">结论</h1><p id="077c" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">在这篇博文中，我们对不同类型的时间序列比较了三种不同的模型算法。除了季节性时间序列(航空公司)之外，LightGBM的表现与ARIMA相当或更好。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi po"><img src="../Images/2bd2987c389f8d14d1b25ecc936b1270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpqUW6ik6YwBgdlk18vT6A.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd ou">通过时间序列数据集建立模型预测MAE</strong></p></figure><p id="d978" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">由于LightGBM是一个非线性模型，它比线性模型有更高的过度拟合数据的风险。您可能希望在使用它时设置可靠的交叉验证。如果你的数据有许多不同的时间序列(例如，公司的股票价格或按产品的销售)，机器学习方法也比线性模型有优势，因为你可以用一个机器学习模型预测多个时间序列(我们在这篇博客中没有挖掘这一优势。如果你感兴趣的话，请看一些来自<a class="ae le" href="https://www.kaggle.com/c/m5-forecasting-accuracy" rel="noopener ugc nofollow" target="_blank"> M5游戏竞赛</a>的实现。</p><p id="def9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">机器学习方法的一个缺点是，它没有任何计算预测区间的内置功能，而大多数静态时间序列实现(即ARIMA或预言家)都有。您可能想编写自己的模块来计算它。</p><p id="a0b6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">虽然Prophet在我们的数据中并不比其他人表现得更好，但如果您的时间序列有多个季节性或趋势变化，它仍然有很多优势。</p><p id="2f3f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您可以在下面的Google Colab链接或Github链接中看到完整的工作代码。</p><div class="pp pq gp gr pr ps"><a href="https://colab.research.google.com/drive/1Z4zNI_bVXoFQBsCHUtxBDCBno6yhXceB?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd ja gy z fp px fr fs py fu fw iz bi translated">谷歌联合实验室</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">用ARIMA、LightGBM和Prophet进行多步时间序列预测</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">colab.research.google.com</p></div></div><div class="qb l"><div class="qc l qd qe qf qb qg ky ps"/></div></div></a></div><div class="pp pq gp gr pr ps"><a href="https://github.com/tomonori-masui/time-series-forecasting/blob/main/multi_step_time_series_forecasting.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd ja gy z fp px fr fs py fu fw iz bi translated">时间序列预测</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">使用ARIMA、LightGBM和Prophet-tomonori-masui/时间序列预测进行多步时间序列预测</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">github.com</p></div></div><div class="qb l"><div class="qh l qd qe qf qb qg ky ps"/></div></div></a></div></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="2218" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">参考</h1><p id="24cc" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">[1] <a class="ae le" href="https://www.sktime.org/en/latest/examples/01_forecasting.html" rel="noopener ugc nofollow" target="_blank">用sktime预测— sktime官方文档</a></p><p id="edb7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[2]<a class="ae le" href="https://www.kaggle.com/kashnitsky/topic-9-part-1-time-series-analysis-in-python" rel="noopener ugc nofollow" target="_blank">Python中的时间序列分析</a></p><p id="43e9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[3]<a class="ae le" rel="noopener" target="_blank" href="/a-lightgbm-autoregressor-using-sktime-6402726e0e7b">light GBM自回归器—使用Sktime </a></p><p id="84d5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[4] Rob J Hyndman和George Athanasopoulos，<a class="ae le" href="https://otexts.com/fpp3/arima.html#arima" rel="noopener ugc nofollow" target="_blank">预测:原则和实践(第3版)——第9章ARIMA模型</a></p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="66e8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="ny">2023年3月9日-更新代码(包括链接的Colab和Github)以使用当前最新的包</em></p></div></div>    
</body>
</html>