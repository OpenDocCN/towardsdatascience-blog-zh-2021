<html>
<head>
<title>Changing Notebook Cell’s Default Output — A Quick Jupyter Notebook Productivity Tip</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更改笔记本电池的默认输出Jupyter笔记本生产力快速提示</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/changing-the-cells-default-output-a-quick-jupyter-notebook-productivity-tip-a788c795884c?source=collection_archive---------15-----------------------#2021-11-17">https://towardsdatascience.com/changing-the-cells-default-output-a-quick-jupyter-notebook-productivity-tip-a788c795884c?source=collection_archive---------15-----------------------#2021-11-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3f1c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我打赌那是你会发现有用的东西</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e48104e97fc48417e5ac79c2a0a996e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*daskQTnp7k21MdJt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@xps?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> XPS </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b244" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jupyter Notebook是一个友好的Python编辑器，适用于所有级别——初学者和有经验的Python用户会时不时或几乎每天都想使用它。对我来说，当我为实用程序模块编写脚本时，我喜欢使用PyCharm。但是，当我处理数据时，我喜欢使用Jupyter笔记本。</p><p id="24e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jupyter Notebook对数据科学家的吸引力来自于它的交互性——你总是可以一步一步地检查数据是什么样子的。这是一些初级数据科学家没有意识到的事情——他们可能非常相信自己的编码技能，并认为一切都会很好。然而，如果不密切、持续地关注数据，您可能会得到一个完全错误的数据集。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="7689" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">默认输出行为</h2><p id="7bff" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">至此，我希望你已经养成了坚持检查数据的好习惯。您可能会做如下事情:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/7add04c73ea1926e85a1a6ae1edfb21f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpGiVGX43VgOTRHkRRY2Qg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查数据头(图片由作者提供)</p></figure><p id="c85a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您读取数据集之后，您要做的是使用<code class="fe nb nc nd ne b">head</code>方法检查它的前五行。除了数据导入，有时您可能需要自己创建数据框架:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/582250e98cf9222036a8745456e32e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KD0hBCfizphxY9KqVUvARw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建数据框架(图片由作者提供)</p></figure><p id="2c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，正如您可能注意到的那样，DataFrame在默认情况下没有输出。同样，您必须在数据帧上使用<code class="fe nb nc nd ne b">head</code>方法，或者简单地在另一个单元格中输入数据帧来检查数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/de3f5bdffe1632a8740873dc926c7f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-Vz-EirlXOl2uA2iUBs0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查数据帧(图片由作者提供)</p></figure><p id="9f57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您一致地操作数据时，比如创建新列、设置数据框架的子集、与其他数据框架对象合并，通过调用单元格中的<code class="fe nb nc nd ne b">df.head</code>或<code class="fe nb nc nd ne b">df</code>来检查新的数据框架对象会变得很乏味。显示数据是因为<strong class="lb iu">单元格的默认输出行为是显示最后一个表达式的求值结果。</strong></p><p id="5959" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当单元格的最后一个操作是一个计算结果为None的语句或表达式时，您不会得到任何输出。例如，当我们创建DataFrame <code class="fe nb nc nd ne b">another_df = pd.DataFrame(data_records)</code>时，我们没有任何输出，因为它是一个赋值语句，不输出任何东西。</p><p id="a54b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有什么方法可以不用显式调用<code class="fe nb nc nd ne b">df.head</code>就能显示新创建的DataFrame？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="195d" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">更改默认输出行为</h2><p id="d7df" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如你所知，Jupyter Notebook是建立在<a class="ae ky" href="https://pypi.org/project/ipython/" rel="noopener ugc nofollow" target="_blank"> IPython </a>库之上的，它提供了笔记本单元的基本功能。因此，通过快速的Google搜索，我意识到我可以通过运行下面的代码来改变默认的输出行为:</p><pre class="kj kk kl km gt ng ne nh ni aw nj bi"><span id="a728" class="mc md it ne b gy nk nl l nm nn">from IPython.core.interactiveshell import InteractiveShell<br/>InteractiveShell.ast_node_interactivity = "last_expr_or_assign"</span></pre><p id="e005" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本质上，您改变了交互式shell在IPython中的工作方式，Jupyter Notebook依赖于IPython。代码所做的是显示最后一个表达式的计算结果或赋值语句中使用的值。运行上述代码后，让我们看看细胞现在的行为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/594bf66f130059c5ca0f9694e6c020bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9zxmOjb5ftMzHB47KrVjwQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">更新的输出行为(图片由作者提供)</p></figure><p id="d7aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，我们不再需要运行<code class="fe nb nc nd ne b">df.head</code>，所有创建的DataFrame对象都会自动显示，以便我们检查数据。</p><p id="9980" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太方便了！</p><p id="e1db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了<code class="fe nb nc nd ne b">“last_expr_or_assign”</code>选项，你还可以尝试其他选项，如下图。对我来说，我觉得这个<code class="fe nb nc nd ne b">“last_expr_or_assign”</code>正是我想要的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">互动选项</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="65eb" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">“永久地”改变行为</h2><p id="1056" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">当您使用完当前笔记本并创建另一个笔记本时，您可能会注意到您必须再次运行以下代码。否则，新笔记本的行为将和以前一样，只显示最后一个表达式的计算结果。</p><pre class="kj kk kl km gt ng ne nh ni aw nj bi"><span id="2d5d" class="mc md it ne b gy nk nl l nm nn">from IPython.core.interactiveshell import InteractiveShell<br/>InteractiveShell.ast_node_interactivity = "last_expr_or_assign"</span></pre><p id="58ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每一个笔记本里做是不是很繁琐？我不知道你的反应，但我发现它很乏味。</p><p id="1d52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，有一个解决方案—我们可以通过将此设置应用到配置文件来更改任何笔记本的默认行为。如果您使用的是Mac (Windows有类似的解决方案)，您应该能够找到一个隐藏的目录(要显示隐藏的文件/文件夹，在Finder中，按下<code class="fe nb nc nd ne b">Shift + Cmd + .</code>)来进行IPython相关的设置:</p><pre class="kj kk kl km gt ng ne nh ni aw nj bi"><span id="5d97" class="mc md it ne b gy nk nl l nm nn">/Users/your_username/.ipython/profile_default</span></pre><p id="41be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个文件夹中，你创建一个名为<code class="fe nb nc nd ne b">ipython_config.py</code>的文件。在该文件中，添加以下代码。代码所做的是获取配置文件，并为任何新创建的笔记本将节点的交互性设置为<code class="fe nb nc nd ne b">“last_expr_or_assign”</code>。</p><pre class="kj kk kl km gt ng ne nh ni aw nj bi"><span id="d203" class="mc md it ne b gy nk nl l nm nn">c = get_config()</span><span id="08a9" class="mc md it ne b gy nq nl l nm nn">c.InteractiveShell.ast_node_interactivity = "last_expr_or_assign"</span></pre><p id="2f36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建这个文件后，您会看到它改变了新笔记本的默认单元格输出行为。超级酷吧？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="1388" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">抑制输出</h2><p id="0f0c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">就检查数据而言，更改默认显示行为很方便。但是，您的笔记本可能会变得很长，因为所有的DataFrame对象都会显示出来。当然，您可以在检查后删除单元的输出。另一个有用的方法是利用分号符号。请观察下面的截图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/75dd775ced91021846f094fcb080ddac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JK-ekGHyQapzz_gkURVvlA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">抑制输出</p></figure><p id="aedc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，如果我们用分号结束我们的赋值，就不会显示更多的输出。如果没有分号，单元格将显示赋值中使用的值。</p><p id="44f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，通过使用分号，我们能够操纵单元格的输出行为，同时享受显示最后一个表达式或赋值的交互的笔记本级设置。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="efc5" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">结论</h2><p id="5542" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在这篇文章中，我与你分享了一个简单的技巧，可以提高你的生产力与Jupyter笔记本。在许多情况下，我们希望在处理过程中不断检查我们的数据，为此，我们可能必须不断使用<code class="fe nb nc nd ne b">df.head</code>或<code class="fe nb nc nd ne b">df</code>，这很繁琐。</p><p id="4277" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过改变IPython中节点的交互模式，我们能够让单元格输出最后一个表达式或赋值，从而避免我们调用这些数据检查方法。此外，我们讨论了如何在不改变每个笔记本设置的情况下，在所有笔记本上一致地实施这种行为。我们还学习了如何在需要时使用分号来隐藏输出。</p><p id="0602" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读这篇文章。通过<a class="ae ky" href="https://medium.com/subscribe/@yong.cui01" rel="noopener">注册我的简讯</a>保持联系。还不是中等会员？通过<a class="ae ky" href="https://medium.com/@yong.cui01/membership" rel="noopener">使用我的会员链接</a>支持我的写作(对你没有额外的费用，但是你的一部分会费作为奖励由Medium重新分配给我)。</p></div></div>    
</body>
</html>