<html>
<head>
<title>Preparing the ImageNet dataset with TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TensorFlow准备ImageNet数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/preparing-the-imagenet-dataset-with-tensorflow-c681916014ee?source=collection_archive---------32-----------------------#2021-12-06">https://towardsdatascience.com/preparing-the-imagenet-dataset-with-tensorflow-c681916014ee?source=collection_archive---------32-----------------------#2021-12-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4bf6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">方便地设置150 GB的图像数据</h2></div><p id="0e9b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">毫无疑问，ImageNet数据集已经成为开发高级机器学习算法的关键因素。其庞大的规模和众多的类别给处理带来了挑战。这些问题导致了更好的数据处理工具和新颖的神经网络结构。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/b59f971cb513806bfe91155e45498f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l6_tuWS7M17pgI0k"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">亨特·哈里特在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="c0cc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">TensorFlow Datasets就是这样一个数据集处理工具。在它的帮助下，您可以方便地访问许多类别的各种数据集。大多数情况下，您可以直接从TensorFlow下载数据。</p><p id="eeb7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，ImageNet是个例外；它需要手动设置。虽然<em class="lv">似乎有一些实现这一目标的指示，但它们有些模糊。因此，我花了一些时间来准备数据集，但我最终得到了一个简洁的脚本。在下文中，我将指导您使用ImageNet数据集进行实验。</em></p><h1 id="154e" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">下载ImageNet</h1><p id="cbff" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">在我们做任何准备之前，我们需要获得数据集。为此，请转到<a class="ae lu" href="https://image-net.org/signup.php" rel="noopener ugc nofollow" target="_blank">注册页面</a>并创建一个帐户。完成此操作并申请使用ImageNet数据集后，进入<a class="ae lu" href="https://image-net.org/download-images.php" rel="noopener ugc nofollow" target="_blank">下载页面</a>。在“ImageNet大规模视觉识别挑战赛(ILSVRC)”下，选择2012版。这将引导您进入新的一页:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mt"><img src="../Images/91e43875871a6ef178adcad03c327eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZY772rmjhLHBAPMHvDg3Zg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">ImageNet下载页面。作者截图。</p></figure><p id="999a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在此页面上，我们需要下载“训练图像(任务1和2)”和“验证图像(所有任务)”文件。因为它们总共有150 GB大，这将需要一些时间。如果你有大学提供的网络，我建议你利用他们的网络。通常，它们的下载速度非常快。</p><p id="8169" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，您有两个文件。第一个，<em class="lv">ils vrc 2012 _ img _ train . tar</em>，包含训练图像及其标签。第二个，<em class="lv"> ILSVRC2012_img_val.tar </em>，包含验证图像及其标签。有了这些存档，我们现在可以为实际使用准备数据集了。</p><h1 id="4c24" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">准备ImageNet数据集</h1><p id="4433" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">准备数据集的完整脚本如下所示。根据您的情况调整任何目录路径:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="735f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要安装TensorFlow数据集，请运行</p><blockquote class="mw mx my"><p id="8598" class="ki kj lv kk b kl km ju kn ko kp jx kq mz ks kt ku na kw kx ky nb la lb lc ld im bi translated">pip安装tensor flow-数据集</p></blockquote><p id="a1c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在必要的安装和导入之后，我们定义了<em class="lv">ils vrc 2012 _ img _ train . tar</em>和<em class="lv"> ILSVRC2012_img_val.tar </em>文件所在的路径:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="eae8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们设置一些配置参数。<em class="lv">手动_方向</em>参数是这里的关键。它确保TensorFlow数据集在我们指定的位置搜索下载的文件。<em class="lv"> extracted_dir </em>是数据集准备期间使用的临时目录。您可以在以后删除它:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="b072" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们实现实际的构建过程。准备工作是通过一个<em class="lv"> DatasetBuilder </em>对象完成的，它“知道”如何设置一个特定的数据集。例如，为了获得ImageNet的构建器，我们通过传递“imagenet2012”来实例化它。</p><p id="4c86" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们在这个对象上调用实际的准备方法，<em class="lv"> download_and_prepare() </em>。这里我们唯一要做的就是传递我们的配置对象:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="d5bd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是我们在python端要做的全部工作。</p><h1 id="fdb8" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">运行脚本</h1><p id="2453" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">要运行该脚本，我们键入</p><blockquote class="mw mx my"><p id="1ce9" class="ki kj lv kk b kl km ju kn ko kp jx kq mz ks kt ku na kw kx ky nb la lb lc ld im bi translated">python <script_name>。巴拉圭</script_name></p></blockquote><p id="f762" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样直接在默认<em class="lv"> ~/tensorflow_datasets/ </em>中构建ImageNet数据集。要改变这一点，我们可以用</p><blockquote class="mw mx my"><p id="78c8" class="ki kj lv kk b kl km ju kn ko kp jx kq mz ks kt ku na kw kx ky nb la lb lc ld im bi translated">TFDS _数据_目录= <custom_path> python <script_name>。巴拉圭</script_name></custom_path></p></blockquote><p id="ca5e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在前面加上了TFDS数据目录，将负责构建位置的环境变量设置到我们选择的目录中。这主要在计算集群中有用，在计算集群中，多个工作人员访问相同的数据集。</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h1 id="69a9" class="lw lx it bd ly lz nj mb mc md nk mf mg jz nl ka mi kc nm kd mk kf nn kg mm mn bi translated">摘要</h1><p id="9d05" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">我们已经完成了ImageNet数据集的设置。不幸的是，我们无法方便地设置测试数据集。此外，没有提供标签，以防止不公平的技术被使用。因此，评估模型的唯一方法是将带有图像-&gt;预测标签映射的文件上传到分级服务器。要获取测试图像，从<a class="ae lu" href="https://image-net.org/download-images.php" rel="noopener ugc nofollow" target="_blank">与之前</a>相同的下载页面下载测试档案。然后，将其解压缩到您选择的目录中。任何进一步的处理都遵循典型的数据流水线。然而，这超出了本文的范围。为了更进一步，看看Keras的<a class="ae lu" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank">功能来实现这个</a>或者在这篇<a class="ae lu" rel="noopener" target="_blank" href="/a-practical-guide-to-tfrecords-584536bc786c">文章</a>中获得使用数据集的印象。</p></div></div>    
</body>
</html>