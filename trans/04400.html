<html>
<head>
<title>How I Created a Fake News Detector with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用Python创建假新闻检测器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-created-a-fake-news-detector-with-python-65b1234123c4?source=collection_archive---------9-----------------------#2021-04-14">https://towardsdatascience.com/how-i-created-a-fake-news-detector-with-python-65b1234123c4?source=collection_archive---------9-----------------------#2021-04-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="102b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用spaCy和Streamlit开发假新闻检测应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4b545f3ad3681b2b41f8f728d76d36dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8FeBJ2G3Dtciejh6poq9UQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马库斯·温克勒在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="04d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated">假新闻的泛滥是对现代民主社会的一个重大挑战。不准确的信息会影响人们的健康和福祉，尤其是在新冠肺炎疫情充满挑战的时期。此外，虚假信息通过阻止公民根据可证实的事实做出理性决定，侵蚀了公众对民主制度的信任。一项令人不安的研究表明，假新闻比真实新闻接触到更多人，传播速度更快，尤其是在社交媒体上。麻省理工学院的研究人员发现，假新闻在Twitter和脸书等平台上被分享的可能性增加了70%。</p><p id="a82a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假新闻运动是现代信息战的一种形式，被国家和其他实体用来削弱对手的权力和合法性。根据欧盟当局的说法，欧洲国家已经成为中国和俄罗斯虚假信息运动的目标，在许多话题上散布谎言，包括新冠肺炎疫情。东方战略任务小组已经成立，通过监控和揭露有关欧盟成员国的假新闻来处理这个问题。</p><p id="d72c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事实审查员是核实已发布新闻事实正确性的个人。这些专业人士通过识别他们的虚假声明来揭穿假新闻。研究表明，传统的事实核查可以通过机器学习和自然语言处理(NLP)算法来增强。在这篇文章中，我将解释如何使用Python编程语言开发一个web应用程序来检测用我的母语(希腊语)编写的假新闻。</p><h1 id="989f" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">希腊假新闻数据集</h1><p id="3a91" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">每一个机器学习项目的成功都取决于拥有一个适当而可靠的数据集。有许多公开的假新闻数据集，如《骗子》和《FakeNewsNet⁴》，但不幸的是，其中大多数都是由英文文章组成的。由于我找不到任何包含希腊语文章的数据集，我决定创建自己的数据集。<a class="ae kv" href="https://github.com/derevirn/gfn-detector/tree/main/data" rel="noopener ugc nofollow" target="_blank">希腊假新闻(GFN)数据集</a>由用希腊语编写的真实和虚假新闻组成，可用于训练文本分类模型，以及其他NLP任务。</p><p id="4a57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该数据集是基于以下方法创建的。首先，真实的新闻是从一些著名的希腊报纸和网站上收集的。我添加了各种话题的新闻，主要集中在政治、经济、新冠肺炎疫情和世界新闻上。为了识别假新闻，我咨询了<a class="ae kv" href="https://www.ellinikahoaxes.gr/" rel="noopener ugc nofollow" target="_blank"> Ellinika Hoaxes </a>，这是一个希腊事实核查网站，已经获得了<a class="ae kv" href="https://www.poynter.org/ifcn/" rel="noopener ugc nofollow" target="_blank">国际事实核查网络</a> (IFCN)的认证。被验证为虚假的新闻条目样本也被添加到数据集中。该过程完成后，生成的数据集用于训练希腊假新闻检测器应用程序的文本分类模型。</p><h1 id="aed2" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">spaCy Python库</h1><p id="ee10" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">有许多高级Python库可用于自然语言处理任务。其中最受欢迎的是<a class="ae kv" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank"> spaCy </a>，这是一个NLP库，带有预训练的模型，以及对60多种语言的标记化和训练的支持。spaCy包括命名实体识别(NER)、词性标注、句子分割、文本分类、词汇化、形态分析等组件。此外，spaCy是一款健壮且可用于生产的软件，可用于现实产品中。这个库用于创建希腊假新闻检测器应用程序的文本分类模型。</p><h1 id="7092" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">简化框架</h1><p id="72ff" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated"><a class="ae kv" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>是一个Python框架，可以让你非常快速地为数据科学项目构建web应用。您可以用几行代码轻松创建一个包含各种小部件的用户界面。此外，Streamlit是一个很好的工具，可以将机器学习模型部署到web上，并增加数据的可视化效果。Streamlit还有一个强大的缓存机制，可以优化应用程序的性能。此外，<a class="ae kv" href="https://streamlit.io/sharing" rel="noopener ugc nofollow" target="_blank"> Streamlit Sharing </a>是一项由库创建者免费提供的服务，让您可以轻松地部署您的应用程序并与其他人共享。有关Streamlit的详细介绍，请参见<a class="ae kv" rel="noopener" target="_blank" href="/streamlit-101-an-in-depth-introduction-fc8aad9492f2">这里的</a>。</p><h1 id="c64a" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">开发Web应用程序</h1><p id="6414" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">出于多种原因，我决定开发<a class="ae kv" href="https://share.streamlit.io/derevirn/gfn-detector/main/app.py" rel="noopener ugc nofollow" target="_blank">希腊假新闻检测器</a>。首先，我想从总体上熟悉spaCy库和NLP，从而提高我的技能集并成为一名专业人员。其次，我想展示使用机器学习来处理假新闻问题的潜力，以一种非专家也能理解的方式。实现这一点的最佳方式是开发一个web应用程序形式的简单原型。Streamlit是实现这一目的的理想工具，所以我决定利用它。我现在将解释源代码功能，从文本分类模型训练开始。我最初使用的是Jupyter笔记本，但是出于本文的目的，代码被转换为下面的Python文件，名为<code class="fe my mz na nb b">gfn_train.py</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="6d50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们导入必要的Python库，并定义两个助手函数。<code class="fe my mz na nb b">load_data()</code>函数重组数据，为每篇新闻文章分配一个类别，并将数据集分成训练和测试子集。<code class="fe my mz na nb b">evaluate()</code>函数计算各种指标，如精确度、召回率和F分数，这可以帮助我们评估文本分类器的性能。在定义辅助函数之后，我们加载spaCy预训练模型。我选择了<code class="fe my mz na nb b">el_core_news_md</code>模式，因为我们正在处理用希腊语写的文章。</p><p id="1ae4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，我们将GFN数据集加载到熊猫数据帧，并通过删除一些不需要的字符来清理它。之后，我们将<code class="fe my mz na nb b">textcat</code>组件添加到我们的预训练模型中。该组件将用GFN数据集进行训练，以创建文本分类模型。然后我们禁用其他组件，因为我们只需要训练<code class="fe my mz na nb b">textcat</code>。然后，我们使用<code class="fe my mz na nb b">load_data()</code>和<code class="fe my mz na nb b">update()</code>函数分别加载数据集和训练模型。我们之前定义的<code class="fe my mz na nb b">evaluate()</code>函数用于打印培训指标和绩效。训练完成后，使用<code class="fe my mz na nb b">to_disk()</code>功能保存模型。我们现在将检查Streamlit web应用程序的主文件<code class="fe my mz na nb b">app.py</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="5704" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们从导入Streamlit、spaCy和其他必要的库开始。在此之后，我们定义了<code class="fe my mz na nb b">get_nlp_model()</code>函数，该函数加载我们之前训练的spaCy文本分类模型。这个函数用<code class="fe my mz na nb b">@st.cache</code> decorator标记，它让Streamlit将模型存储在本地缓存中，从而提高性能。然后，我们使用<code class="fe my mz na nb b">markdown()</code>函数和一些常见的HTML标签定义了打印分类结果的<code class="fe my mz na nb b">generate_output()</code>函数。之后，文章文本被打印出来，同时还有一个用于可视化的单词云。</p><p id="c696" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们使用各种Streamlit小部件创建应用程序布局。首先，我们设置页面标题和描述。其次，我们创建一个用于输入类型选择的单选按钮小部件。通过这样做，用户可以选择输入文章的URL或文本。如果用户选择文章URL作为输入类型，则使用<code class="fe my mz na nb b">get_page_text()</code>功能抓取文本。否则，用户可以在多行文本输入中粘贴文章。在这两种情况下，都使用一个按钮小部件来调用<code class="fe my mz na nb b">generate_output()</code>函数，从而对文章进行分类并打印结果。最后，我们可以执行<code class="fe my mz na nb b">streamlit run app.py</code>命令在本地运行应用程序，或者使用免费的Streamlit共享服务来部署它。</p><h1 id="1202" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">结论</h1><p id="b5a1" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我希望读完这篇文章后，你会更加了解使用NLP和机器学习来处理假新闻这一严重问题的潜力。此外，我鼓励您尝试并创建自己的假新闻检测应用程序，因为修改代码以在不同的数据集上训练模型很简单。如果你想克隆这个项目的Github库，可以在这里找到<a class="ae kv" href="https://github.com/derevirn/gfn-detector" rel="noopener ugc nofollow" target="_blank">。欢迎在评论中分享你的想法，或者在</a><a class="ae kv" href="https://www.linkedin.com/in/giannis-tolios-0020b067/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我，我经常在那里发布关于数据科学和其他主题的内容。你也可以访问我的<a class="ae kv" href="https://giannis.io/" rel="noopener ugc nofollow" target="_blank">个人网站</a>或者查看我的新书，名为<a class="ae kv" href="https://leanpub.com/pycaretbook/" rel="noopener ugc nofollow" target="_blank">用PyCaret </a>简化机器学习。</p><h1 id="f840" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">参考</h1><p id="3bcd" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">[1]沃索伊、索罗什、德布罗伊和希南阿拉尔。"真假新闻在网上的传播."<em class="ne">理科</em>359.6380(2018):1146–1151。</p><p id="72c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2]大川、雷、钱景和威廉·王洋。"用于假新闻检测的自然语言处理综述."<em class="ne"> arXiv:1811.00770 </em> (2018)。</p><p id="4386" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3]王，杨威廉."“骗子，骗子裤子着火了”:假新闻检测的新基准数据集."<em class="ne"> arXiv:1705.00648 </em> (2017)。</p><p id="5d65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[4]舒，凯等，“假新闻网:一个包含新闻内容、社会背景和时空信息的数据仓库，用于研究社交媒体上的假新闻。”<em class="ne">大数据</em>8.3(2020):171–188。</p></div></div>    
</body>
</html>