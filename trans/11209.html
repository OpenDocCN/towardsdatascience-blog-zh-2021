<html>
<head>
<title>Interactive Pipeline and Composite Estimators for your end-to-end ML model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于端到端 ML 模型的交互式管道和复合估算器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interactive-pipeline-and-composite-estimators-for-your-ml-tasks-b739854500bf?source=collection_archive---------26-----------------------#2021-11-02">https://towardsdatascience.com/interactive-pipeline-and-composite-estimators-for-your-ml-tasks-b739854500bf?source=collection_archive---------26-----------------------#2021-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="58cf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">训练和显示流水线、列变换器和链式估算器的基本指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b7d0b0458515057ee1a7da57ab374e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hmsx9idCrdvDw14_93du_A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1694404" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ky" href="https://pixabay.com/users/erik_stein-2524241/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1694404" rel="noopener ugc nofollow" target="_blank">埃里克·斯坦</a>拍摄</p></figure><p id="4f4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据科学模型开发管道涉及各种组件，包括数据注入、数据预处理、特征工程、特征缩放和建模。数据科学家需要为所有组件编写学习和推理代码。对于具有异构数据的机器学习项目，代码结构有时会变得更加混乱，难以为其他团队成员解释。</p><p id="1660" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">管道是一个非常方便的功能，它可以顺序地集合所有的模型开发组件。使用流水线，人们可以容易地在相对干净的代码结构中执行学习和推理任务。</p><p id="458e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论在开发端到端机器学习模型时，如何使用 scikit-learn 管道通过链接估计器和列转换器来构建您的代码。</p><h1 id="7f55" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是管道？</h1><p id="26bc" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">管道可以在干净的代码结构中顺序列出所有的数据处理和特征工程估算器。基本上，它将多个估算器连接成一个。使用管道进行学习和推理任务非常方便，并且可以避免数据泄漏。人们也可以一次对管道中所有估计器的参数执行<a class="ae ky" href="https://scikit-learn.org/stable/modules/grid_search.html#grid-search" rel="noopener ugc nofollow" target="_blank">网格搜索</a>。</p><p id="f7e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将为具有异构特征的二进制样本数据集开发一个端到端的机器学习模型。二进制样本数据集具有文本、数字和分类数据类型的 8 个独立特征。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/17cce1774ad78caef80f155944a35bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVUfrZa0P2ydL81UFHK3Cg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，样本数据集快照</p></figure><h2 id="01b7" class="mt lw it bd lx mu mv dn mb mw mx dp mf li my mz mh lm na nb mj lq nc nd ml ne bi translated">用法:</h2><p id="0ec9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">样本数据集包括文本特征(姓名)、分类特征(性别、已登机)和数字特征(PClass、年龄、SibSp、Parch、Fare)。</p><p id="22ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">原始真实数据集可能包含大量缺失的数据值。我们可以使用 scikit-learn 包中的<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank">simple imputr</a>函数来估算缺失值。对于分类特征，我们可以将一个独热编码器和一个 SVD 估计器连接起来进行特征分解。</p><p id="e759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于文本特征，我们可以使用计数矢量器或 Tf-Idf 矢量器对文本进行矢量化，将文本数据转换为数字嵌入，然后使用降维估计器。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="4432" class="mt lw it ng b gy nk nl l nm nn">Pipeline 1 (For categoircal features):<br/>1) Most Frequent value Imputer<br/>2) One Hot Encoder<br/>3) Truncated SVD decomposition</span><span id="befd" class="mt lw it ng b gy no nl l nm nn">Pipeline 2 (For Text based features):<br/>1) Tf-Idf Vectorizer<br/>2) Truncated SVD decomposition</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)</p></figure><h1 id="792d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">异构数据的列转换器:</h1><p id="6dc8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">样本数据集包含从文本数据类型到浮点和对象数据类型的各种要素数据类型。因此，每种类型的特性都需要单独的特性工程策略。</p><p id="6bb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Column Transformer 是一个 scikit-learn 功能，使开发人员能够针对不同的功能集执行不同的功能工程和数据转换步骤。列转换器的优点是可以在管道内执行数据转换，不会出现数据泄漏问题。</p><h2 id="9ce5" class="mt lw it bd lx mu mv dn mb mw mx dp mf li my mz mh lm na nb mj lq nc nd ml ne bi translated">用法:</h2><p id="a6a4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我对不同的特性集执行了不同的特性转换策略。</p><ul class=""><li id="a148" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">管道 1 用于分类特征，如“性”和“已上船”</li><li id="21dc" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">管道 2 用于基于文本的功能，如“名称”</li><li id="1373" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">数字特征“年龄”的平均估算值，因为它有许多缺失值。</li><li id="c76a" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">其余的数字特性不需要任何特性转换，因此可以使用“passthrough”关键字传递它</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)</p></figure><h2 id="2dde" class="mt lw it bd lx mu mv dn mb mw mx dp mf li my mz mh lm na nb mj lq nc nd ml ne bi translated">建模管道:</h2><p id="8df6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在执行数据转换步骤之后，我们可以移动到模型组件。我将使用逻辑回归估计器来训练转换后的数据集。但是，在进入建模阶段之前，我们还可以包括一个 StandardScaler 估计器来标准化转换后的数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)</p></figure><h1 id="6729" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">可视化管道:</h1><p id="6aec" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">整个管道的可视化表示很容易解释案例研究的端到端流程。Scikit-learn 提供了一个<code class="fe of og oh ng b"><strong class="lb iu">set_config</strong></code> <strong class="lb iu"> </strong>函数，使开发人员能够显示整个端到端管道的图形表示。</p><p id="05dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，<code class="fe of og oh ng b">set_config</code>显示参数为“文本”,显示整个管道的文本格式。更改为“图表”关键字将使其工作。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="7211" class="mt lw it ng b gy nk nl l nm nn"><strong class="ng iu">from sklearn import set_config<br/>set_config(display='diagram')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/823c84201d12c28ddcf899c4bcdc10e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*pzi4i17ac__sSPWlUSzXWQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，整个管道的图解说明</p></figure><h1 id="0c07" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">学习和推理:</h1><p id="d5bb" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">可以使用<code class="fe of og oh ng b"><strong class="lb iu">.fit()</strong></code>函数训练模型管道，并使用<code class="fe of og oh ng b"><strong class="lb iu">.predict()</strong></code>函数进行推理。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)，整个实现</p></figure><h1 id="4cf6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论:</h1><p id="eadd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">管道是一个非常方便的功能，它可以顺序地将所有的估算器组合成一个，并准备一个干净的、结构良好的代码。使用管道，学习和推理任务变得非常容易运行。您可以在可解释的表示中显示整个端到端管道。</p><h1 id="34da" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考资料:</h1><p id="b151" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">[1] Scikit-learn 文档:<a class="ae ky" href="https://scikit-learn.org/stable/modules/compose.html" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/modules/compose.html</a></p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="5193" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oq">喜欢这篇文章吗？成为</em> <a class="ae ky" href="https://satyam-kumar.medium.com/membership" rel="noopener"> <em class="oq">中等会员</em> </a> <em class="oq">继续无限制学习。如果你使用下面的链接，我会收到你的一小部分会员费，不需要你额外付费。</em></p><div class="or os gp gr ot ou"><a href="https://satyam-kumar.medium.com/membership" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">加入我的推荐链接-萨蒂扬库马尔媒体</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">satyam-kumar.medium.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ks ou"/></div></div></a></div><blockquote class="pj"><p id="1ad5" class="pk pl it bd pm pn po pp pq pr ps lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>