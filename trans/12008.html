<html>
<head>
<title>Efficiently Shortlisting a Classification Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有效地筛选分类模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/efficiently-shortlisting-a-classification-model-32e5df0faf3d?source=collection_archive---------29-----------------------#2021-12-02">https://towardsdatascience.com/efficiently-shortlisting-a-classification-model-32e5df0faf3d?source=collection_archive---------29-----------------------#2021-12-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4add" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">以更快的方式收敛到正确的模型</strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/775ce8112ee278b34fe993128fb1534a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ykKzkd6Dov5xuozm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@loic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Djim Loic </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="743e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是晚上 8 点，您仍然在清理数据，执行 EDA，并创建更多的功能。您与业务部门的初步讨论是明天的第一件事，期望讨论正在考虑的潜在“分类”方法，以及所考虑的模型的关键特征。作为一名数据科学家，您希望尝试尽可能多的方法，并为您的业务会议获得最佳的模型预测。</p><p id="3992" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，和往常一样，时间紧迫！！</p><p id="e28b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如今，数据科学家(DS)有节约成本/增加收入的目标，工作压力巨大。由于数据清理、争论和特性工程消耗了大部分时间，DS 从来没有足够的时间在数据上尝试所有相关的方法。</p><p id="2c59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管业内的一些专家确实知道哪种分类算法适用于特定类型的数据，但是通常很难做出选择。要做出明智的决策，需要考虑太多因素，如数据线性、模型训练时间、数据类型(分类与数值)、可解释性、持续监控的难易程度，当然还有准确性。</p><p id="be3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确实有必要加快模型的初步筛选，列出入围的前“n”个模型，然后对它们进行微调，以提高准确性和其他关键指标。</p><p id="b08f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要列出一些方法，可以一次运行一个模型，并比较各种输出指标。然而，这是低效和费时的，当然有有效的方法。</p><p id="6c96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此后，我们讨论三个关键有效的方法来执行这一初步入围。每种方法都有其优点和缺点，并且取决于一个人所处的情况——从这些方法中选择一种是值得的。</p><p id="833c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 1。</strong><strong class="lb iu">lazy predict:</strong>lazy predict 是一个 python 包，封装了 30 个分类模型和 40 个回归模型。它自动化了训练管道，并返回与模型输出相对应的各种度量。在度量的比较之后，可以微调入围模型的超参数，以改进输出度量。</p><p id="b873" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">训练的一些关键分类模型是 SVC、AdaBoost、逻辑回归、树外分类器、随机森林、高斯朴素贝叶斯、XG Boost、岭分类器等。</p><p id="f4fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Python 代码:</strong></p><p id="624f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">#假设已经定义了 X_train、X_test、y_train、y_test，并且已经执行了 EDA。</p><p id="3675" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装 lazypredict</p><p id="51b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">来自 lazypredict。受监督的进口懒汉</p><p id="90f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">cls = lazy classifier(ignore _ warnings = False，custom_metric=None) <br/>模型，预测= cls.fit(X_train，X_test，y_train，y_test)</p><p id="175f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。</strong> <strong class="lb iu">模型列表迭代:</strong>虽然这是一种正统的必不可少的方法，但是，这种方法提供了选择评分方法、创建各种度量(如混淆矩阵等)的灵活性。)并执行交叉验证。这里的想法是创建一个要执行的模型列表，并在创建各种模型度量时遍历模型列表。</p><p id="c8c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Python 代码:</strong></p><p id="2fc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从熊猫导入 read_csv</p><p id="fc35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 matplotlib 导入 pyplot</p><p id="fdcf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 sklearn.neighbors 导入 KNeighborsClassifier</p><p id="f17f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 sklearn.tree 导入决策树分类器</p><p id="8725" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 sklearn.model_selection 导入 KFold</p><p id="550c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">来自 sklearn.linear_model 导入逻辑回归</p><p id="aec7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 sklearn.discriminant _ analysis 导入线性判别分析</p><p id="aa55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 sklearn.svm 导入 SVC</p><p id="3559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 sklearn.model_selection 导入 cross_val_score</p><p id="8003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">data frame = read _ CSV(' classification data . CSV ')</p><p id="f4b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数组 _a1 = dataframe.values</p><p id="73d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">X = array_a1 [:，0:20]</p><p id="250d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Y =数组[:，20]</p><p id="c01c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">#创建模型列表，并追加各种模型进行测试。</p><p id="3046" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">models_list = []</p><p id="602f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">models_list.append(('LogitReg '，LogisticRegression()))</p><p id="ff3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">models_list.append(('SVM '，SVC()))</p><p id="c7f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">models _ list . append((' KNN _ 算法'，KNeighborsClassifier()))</p><p id="5e54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">models_list.append(('LDA_Algo '，LinearDiscriminantAnalysis()))</p><p id="0a0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">models_list.append(('CART_DT '，DecisionTreeClassifier()))</p><p id="abb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型结果= []</p><p id="8937" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型名称= []</p><p id="5eac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">#这可能是 f1、roc 等。取决于问题陈述</p><p id="9a02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">scoring_type = '准确性'</p><p id="f107" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">#遍历模型列表，使用交叉验证分数找到最佳模型。</p><p id="d164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于伪名称，模型列表中的模型名称:</p><p id="76c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">kfold = KFold(n_splits=10，random_state=7)</p><p id="4199" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">cross val _ results = cross _ val _ score(model，X，Y，cv=kfold，scoring= scoring_type)</p><p id="2984" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">model _ results . append(crossval _ results)</p><p id="5053" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型名称.追加(假名)</p><p id="3d9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">print (name，cv_results.mean()，cv_results.std())</p><p id="8584" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.<strong class="lb iu"> AutoML 功能:</strong>在所有解决方案中，这是最有效、最受欢迎的解决方案。有各种各样的 python 包支持 AutoML。一些关键的是-自动 sklearn，自动 Keras，TPOT 等。请注意，这些软件包不仅关注模型过滤的自动化，还加速了数据处理、特征工程等。</p><p id="3c88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结论:</strong> LazyPredict、模型迭代和 AutoML 是在入围和微调模型之前训练模型列表的各种方法。随着数据科学以前所未有的速度发展，我确信有许多其他方法可以更快地获得更好的模型。(如果您遇到任何问题，请在评论中分享)</p><p id="3189" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，随时准备好选项也无妨——您永远不知道与业务部门的会议安排在什么时候。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="9635" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mc">免责声明:本文中表达的观点是作者以个人身份发表的意见，而非其雇主的意见。</em></p></div></div>    
</body>
</html>