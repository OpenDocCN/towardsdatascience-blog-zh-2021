<html>
<head>
<title>Pandas factorize: a fast track from text to numbers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫因子分解:从文本到数字的快速通道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-factorize-a-fast-track-from-text-to-numbers-2a343d91b1f9?source=collection_archive---------18-----------------------#2021-10-12">https://towardsdatascience.com/pandas-factorize-a-fast-track-from-text-to-numbers-2a343d91b1f9?source=collection_archive---------18-----------------------#2021-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7b5a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习如何使用。来自熊猫的factorize()方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b4646f15621d1a930991c96119493f46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6k7J2Dj1iz0c901UExzjWg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">澳大利亚八月在<a class="ae ky" href="https://unsplash.com/s/photos/numbers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="6ad7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这篇文章只会占用你一分钟的时间，但我相信它可以节省几分钟的数据转换时间。</p><h2 id="5151" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">因式分解</h2><p id="0c48" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated"><code class="fe na nb nc nd b">.factorize()</code>是一个Pandas方法，可以帮助你快速地将数据从文本转换成数字。</p><blockquote class="ne"><p id="2281" class="nf ng it bd nh ni nj nk nl nm nn mb dk translated">将对象编码为枚举类型或分类变量。[熊猫文档]</p></blockquote><p id="0e06" class="pw-post-body-paragraph lg lh it li b lj no ju ll lm np jx lo lp nq lr ls lt nr lv lw lx ns lz ma mb im bi translated">很多时候我们需要将一个给定的变量转换成数字，特别是在呈现给某些只需要数字输入的算法之前。因此，有几种方法可以用熊猫来玩这个<em class="nt">把戏</em>，例如像<code class="fe na nb nc nd b">map</code>或<code class="fe na nb nc nd b">replace</code>。</p><h2 id="613d" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">地图示例</h2><pre class="kj kk kl km gt nu nd nv nw aw nx bi"><span id="8bbf" class="mc md it nd b gy ny nz l oa ob">import pandas as ps<br/>import seaborn as sns</span><span id="124b" class="mc md it nd b gy oc nz l oa ob"># Load dataset for this example<br/>df = sns.load_dataset('taxis')</span><span id="be86" class="mc md it nd b gy oc nz l oa ob"># slice only some textual columns<br/>df = df[['payment', 'pickup_borough', 'pickup_zone']]</span><span id="41cd" class="mc md it nd b gy oc nz l oa ob"># payment unique entries<br/>df.payment.unique()<br/><strong class="nd iu">[OUT]:</strong> array(['credit card', 'cash', nan], dtype=object)</span><span id="5521" class="mc md it nd b gy oc nz l oa ob"># Using map<br/>df.payment.map({'cash':0, 'credit card':1})</span></pre><p id="92f3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当我们只有两个选项时，上面的代码将很好地工作。现在，对于<em class="nt"> pickup_borough </em>列，我们已经看到4个条目，仍然可以很快完成。不过，还是来看看<em class="nt"> pickup_zone </em>一栏。</p><pre class="kj kk kl km gt nu nd nv nw aw nx bi"><span id="57ac" class="mc md it nd b gy ny nz l oa ob">df.pickup_zone.nunique()</span><span id="21f6" class="mc md it nd b gy oc nz l oa ob">[OUT]: 194</span></pre><p id="d40d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><em class="nt">哎哟……</em>194个条目。这将需要一些时间来记录和创建映射字典。即使使用代码来实现这一点也需要时间。</p><p id="10cf" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在让我们在这种情况下使用<code class="fe na nb nc nd b">.factorize()</code>函数。</p><h2 id="d0a2" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">因子分解示例</h2><p id="74de" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">请看下面的内容，<code class="fe na nb nc nd b">.factorize</code>将得到一个数组，其中包含每个唯一条目的编号和索引，这样你就知道什么是什么了。因此，0将是“鲁诺希尔西”，1是“上西区南”，等等，直到最后一个是“希尔克雷斯特/波莫诺克”。</p><pre class="kj kk kl km gt nu nd nv nw aw nx bi"><span id="f13d" class="mc md it nd b gy ny nz l oa ob">df.pickup_zone.factorize()</span><span id="0755" class="mc md it nd b gy oc nz l oa ob">[OUT]:<br/>(array([ 0,  1,  2, ..., 61, 75, 64]),  <br/>Index(['Lenox Hill West', 'Upper West Side South', 'Alphabet City',         'Hudson Sq', 'Midtown East', 'Times Sq/Theatre District',         'Battery Park City', 'Murray Hill', 'East Harlem South',         'Lincoln Square East',         ...         'Columbia Street', 'Middle Village', 'Prospect Park', 'Ozone Park',         'Gravesend', 'Glendale', 'Kew Gardens Hills', 'Woodlawn/Wakefield',         'West Farms/Bronx River', 'Hillcrest/Pomonok'],        dtype='object', length=<strong class="nd iu">194</strong>))</span></pre><p id="4cd9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">要从因式分解方法中访问数组，请使用切片索引<code class="fe na nb nc nd b">[0]</code>。让我们用数字放一个新的栏。</p><pre class="kj kk kl km gt nu nd nv nw aw nx bi"><span id="8629" class="mc md it nd b gy ny nz l oa ob"># New factorized column<br/>df['zone_code'] = df.pickup_zone.factorize()[0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/e4f7cf4c34f20e614d219fa53075d3e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*WNue1DUfmCAeO2JGHUPPuw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">因子分解列。图片由作者提供。</p></figure><p id="a5ca" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请注意，我们在第7行有一个<code class="fe na nb nc nd b">NaN</code>。看看factorize是如何处理的。它使用-1。所以，如果需要的话，你可以更容易地摆脱它。</p><pre class="kj kk kl km gt nu nd nv nw aw nx bi"><span id="4b4c" class="mc md it nd b gy ny nz l oa ob">df['pay_cd'] = df.payment.factorize()[0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/0b8819b7606f35ad9b69ffd4a9208695.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*TtHhqr3wnV-3ijU9N6B9QQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">NaN = -1。图片由作者提供。</p></figure><h2 id="8bb4" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">更快的</h2><p id="914b" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">而且，正如所料，因式分解更快。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/34340013116424a77f8273826f498667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*FfTKssnpwIYD9ZnLOF9EBQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">两种方法的时间测量。图片由作者提供。</p></figure><h2 id="6cbe" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">在你走之前</h2><p id="f84e" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">当您需要将包含许多唯一条目的列从文本转换为数字时,<code class="fe na nb nc nd b">factorize</code>方法非常方便。它也比应用映射字典更快。</p><p id="ea3b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">它和<code class="fe na nb nc nd b">map</code>或者<code class="fe na nb nc nd b">replace</code>做的是一样的工作，但是你不需要写字典。</p><p id="4cf3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这是因式分解的<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.factorize.html" rel="noopener ugc nofollow" target="_blank">文档。</a></p><p id="fae5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果这个内容是有帮助的，你想要更多的内容，请关注我。</p><div class="og oh gp gr oi oj"><a href="https://medium.com/gustavorsantos" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">古斯塔夫·桑托斯</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">让我们做出更好的决定。数据驱动的决策。我用Python，R，Excel，SQL创建数据科学项目。</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox ks oj"/></div></div></a></div></div></div>    
</body>
</html>