<html>
<head>
<title>Hands-Off Machine Learning with Google AutoML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google AutoML进行自动机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hands-off-machine-learning-with-google-automl-e63b079f09d1?source=collection_archive---------6-----------------------#2021-12-03">https://towardsdatascience.com/hands-off-machine-learning-with-google-automl-e63b079f09d1?source=collection_archive---------6-----------------------#2021-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4d8a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Google表格数据的AutoML简介</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e0e82088b0790c09a492935dc1eeb8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NK28DwjFB-5_E-Zk"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kv" href="https://unsplash.com/@altumcode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> AltumCode </a>拍摄的照片</p></figure><h1 id="24e2" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">为什么是AutoML？</strong></h1><p id="f0fd" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如今，表格数据无处不在，可以为我们提供对业务和工程问题的有意义的见解。提取这些见解的一种常见方法是对这些数据应用机器学习(ML)技术。将ML应用于数据集的过程由各种步骤组成，<em class="mk">例如，</em>数据预处理、特征工程和超参数优化，这些步骤中的每一个通常都是耗时的反复试验过程。此外，一个人需要成为ML领域的专家，以便在这些步骤中的每一步都高效和有效。对于一个组织来说，要么从外部找到这些领域专家，要么在内部培养这种专业技能，这可能需要相当长的时间。</p><p id="5fea" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">进入<a class="ae kv" href="https://cloud.google.com/automl" rel="noopener ugc nofollow" target="_blank">谷歌的AutoML平台</a>，<em class="mk">，该平台使开发者(具有有限的ML专业知识)能够针对他们的需求训练高质量的模型</em>。作为谷歌统一ML平台Vertex AI的一部分，它提供了在视觉(图像和视频)、文本和结构化数据上自动训练模型的能力。在本教程中，我们将使用结构化数据的AutoML表格来训练预测<a class="ae kv" href="https://www.kaggle.com/camnugent/california-housing-prices" rel="noopener ugc nofollow" target="_blank">加州房价</a>、<em class="mk"> </em>的模型。关于本文讨论主题的更多细节，我们参考<a class="ae kv" href="https://cloud.google.com/vertex-ai/docs/datasets/prepare-tabular" rel="noopener ugc nofollow" target="_blank">顶点人工智能文档</a>。该文档非常广泛，还包含其他AutoML产品的指南，<em class="mk">即</em>培训视觉和文本模型。</p><h1 id="4f96" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">数据准备</h1><p id="33e6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在开始培训之前，我们必须确保培训数据采用平台支持的格式。AutoML表格支持两种导入培训数据的方式；如果我们已经在使用Google的BigQuery平台，我们可以直接从BigQuery表中导入数据，或者上传一个逗号分隔值(CSV)文件到云存储中。对于本教程，我们将通过第二种方法。我们在下表中总结了CSV文件的要求。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/577f74aab2588ac45c5fdc39c73944e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-sfhqZuxWMF8OZPon9m_Vw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">AutoML表格培训数据格式摘要(图片由作者提供)</p></figure><h1 id="dc56" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">创建数据集</h1><p id="b039" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">可以通过谷歌云平台(GCP)控制台导入数据集。在顶点人工智能部分有一个数据集页面，我们可以在那里管理我们的数据集。在这里，我们可以创建一个表格数据集，并为该数据集选择一个数据源。一旦提供了数据源，将显示一个显示数据一般统计信息的页面。这些步骤如下图所示；左边是数据集创建，中间是数据源选择，右边是统计视图。对于我们的例子，我们上传了包含<a class="ae kv" href="https://www.kaggle.com/camnugent/california-housing-prices" rel="noopener ugc nofollow" target="_blank">加州房价数据集</a>的<em class="mk"> housing.csv </em>。</p><div class="kg kh ki kj gt ab cb"><figure class="mr kk ms mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b025fe684c703aedaecaa25ea1f43cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*cFbtXZ2sxGristn1ortBfA.png"/></div></figure><figure class="mr kk mx mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/9b306196643ae5c4eb25f9fb82d91456.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*Er8LVbLx5183WuvbZcskvQ.png"/></div></figure><figure class="mr kk my mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b2011a9a58a55fdd2b6f203294d55387.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*WWzD3ll0HnI7uJM_YxYkvQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk mz di na nb translated">顶点人工智能数据集创建、源选择和统计页面(图片由作者提供)</p></figure></div><h1 id="e46e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">训练模型</h1><p id="5b9b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一旦数据集被创建，我们就可以开始训练我们的第一个模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/79fb384045654c9bc2f7086dfe803f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXGgjE-bl1jjlz5qjqKz_A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">训练方法选择对话(图片由作者提供)</p></figure><p id="c37d" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">我们通过点击统计页面上的<em class="mk">训练一个新模型</em>来启动这个过程。然后，我们会看到一个对话框，允许我们<strong class="lq ir">选择培训目标</strong>，以及我们是使用AutoML来培训模型，还是使用定制的培训解决方案。对于我们的示例，我们选择回归作为训练目标，选择AutoML作为训练方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/2fb14f1375ee1cb04ef096cd97eab552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ax1Hg4YuREMazXcKwZIrg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型细节对话(图片由作者提供)</p></figure><p id="f78d" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">接下来，我们被要求<strong class="lq ir">选择我们想要训练我们的模型来预测的目标变量/列</strong>。在高级选项下，我们还可以控制如何在训练集、验证集和测试集之间拆分数据。</p><p id="2c23" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">这种拆分可以通过随机分配、手动分配和基于所选列的按时间顺序分配来完成。对于我们的示例，我们选择<em class="mk">中值房屋价值</em>作为目标，并保留高级选项的默认值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/76484658852ac05311b934ad0819641d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5tgnKdjbns5ND1KQqcLf_Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">培训选项对话(图片由作者提供)</p></figure><p id="2e62" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">之后，系统会提示我们检查AutoML为我们的数据推断的数据类型。<strong class="lq ir">对于每一列，我们可以选择一个转换，<em class="mk">即</em>数据类型(分类、文本、时间戳或数字)，以及我们是否希望它被</strong> <strong class="lq ir">包含在训练过程中</strong>。在高级选项下，我们可以额外选择一个列，我们希望将其用作行的权重和优化目标。对于回归，这些目标包括RMSE、MAE和RMSLE。<a class="ae kv" href="https://cloud.google.com/vertex-ai/docs/datasets/bp-tabular#tabular_data_preparation_best_practices_for_models" rel="noopener ugc nofollow" target="_blank">任何额外的预处理和/或特征工程最好留给AutoML。</a></p><p id="ad0d" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">对于我们的数据集，推断的数据类型是正确的。我们还在培训过程中包括所有列，并保留高级选项的默认值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/af2ec1c8f8a8df85fdf4d24815039d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IPk_ixRS39umHd7GV24kfA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">培训预算对话(图片由作者提供)</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/567221bfd7dcfa904e9ffe61822f6795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q3bKHqTzLPtliELsN6uKww.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">基于数据集大小的建议训练次数(图片由作者提供)</p></figure><p id="92ec" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">最后，要求<strong class="lq ir">提供培训预算</strong>、<em class="mk">，即</em>用于培训的最大节点小时数。我们根据谷歌建议的培训时间来选择我们的培训预算。培训预算设定后，培训过程将开始，并可通过GCP Vertex AI部分的培训页面进行监控。培训时间可能会比设定的培训预算长，但是，您将只需支付实际节点时间的费用，该时间受您设定的预算限制。一旦训练过程完成，最终的模型将出现在Vertex AI的模型页面上。从那里我们可以观察到各种性能指标和最终模型的特性的重要性，如下图所示。可以检查特性重要性图，以确保最重要的特性对我们的数据/业务问题有意义。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/2ff659b089fd99d2a873d5f76ff18daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ae1vKzqSjqq6D3iTcTqxtw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">根据表格数据训练的自动回归模型的模型概述(图片由作者提供)</p></figure><p id="e1c7" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">对于我们的例子，我们可以看到均方根误差约为48.000，这看起来似乎很多，但实际上可以与人类训练的<a class="ae kv" href="https://www.kaggle.com/shtrausslearning/bayesian-regression-house-price-prediction" rel="noopener ugc nofollow" target="_blank">模型的性能相媲美</a>(数据集非常旧，不包含最佳特征集)。在性能指标下面，我们可以看到每一列的分数，表明它在进行预测时的重要性。我们可以看到,<em class="mk"> total_rooms </em>和<em class="mk"> population </em>列被模型视为两个最重要的特性。</p><h1 id="69ff" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">部署、测试和可解释性</h1><p id="f238" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">然后，由AutoML生成的训练模型可以以两种方式部署；我们可以将模型导出为保存的TensorFlow (TF)模型，然后我们可以在Docker容器中为自己服务，或者我们可以将模型直接部署到GCP端点。这两个选项都可以在模型页面上的<em class="mk">部署和测试</em>选项卡下找到。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/933d8e8a67d43c31df41b8304d41021b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oPkv1TL8B7LQPapalFLuXw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="86e3" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">我们将示例中的模型部署到GCP端点，以便通过GCP控制台进一步测试它。一旦模型部署完毕，我们就可以开始通过GCP提供的<a class="ae kv" href="https://cloud.google.com/vertex-ai/docs/predictions/online-predictions-automl" rel="noopener ugc nofollow" target="_blank">不同方式之一进行测试。我们使用了GCP控制台提供的web界面，它可以在前面提到的<em class="mk">部署和测试</em>选项卡的底部找到。在那里，我们可以处理模型的输入值，并观察它做出的预测。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/e4869b63f41bb184cad8c0eaf98bce1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CEkovNGGzBvPFu8uJWeCPA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">部署的AutoML模型预测+解释(图片由作者提供)</p></figure><p id="b550" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">有趣的是，这个web界面不仅显示预测，还通过局部特征重要性值提供解释。对于AutoML表格(分类和回归)模型，使用<a class="ae kv" href="https://cloud.google.com/vertex-ai/docs/explainable-ai/overview#compare-methods" rel="noopener ugc nofollow" target="_blank">采样Shapley方法</a>计算这些值。这些解释值也可以在GCP控制台之外通过使用Vertex AI的<a class="ae kv" href="https://cloud.google.com/vertex-ai/docs/predictions/online-predictions-automl#explanations-api" rel="noopener ugc nofollow" target="_blank">解释API </a>来请求。</p><h1 id="ae7d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">摘要</h1><p id="5b62" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本文中，我们展示了如何使用Google AutoML来训练、测试和部署一个ML模型，而不需要很多ML领域的专业知识。这使得ML民主化，允许ML专业知识有限的团队将ML应用到他们的数据中，并毫不费力地将结果模型部署到生产中。对于经验丰富的ML从业者，Google的AutoML提供了有趣的高级配置选项，可以用来简化现有的ML工作流程。</p></div></div>    
</body>
</html>