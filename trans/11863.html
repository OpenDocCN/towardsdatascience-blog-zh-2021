<html>
<head>
<title>4 Python Pandas Functions That Serve Better With Dictionaries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">4 Python Pandas 函数更好地服务于字典</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-python-pandas-functions-that-serve-better-with-dictionaries-bbfcc6c39fa5?source=collection_archive---------6-----------------------#2021-11-27">https://towardsdatascience.com/4-python-pandas-functions-that-serve-better-with-dictionaries-bbfcc6c39fa5?source=collection_archive---------6-----------------------#2021-11-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1823" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">多利用熊猫。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5efa3107aad8766f3f157a71c4f5e481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9LnY7HZwipgF_d-wkMcWEg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@lefterisk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Lefteris kallergis </a>在<a class="ae ky" href="https://unsplash.com/s/photos/serve?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="cd9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas 可以说是数据科学生态系统中最受欢迎的数据分析和操作库。首先也是最重要的，它很容易学习，并且提供了直观的语法。</p><p id="249e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">话虽如此，我们还是要关注熊猫的另一大特点:灵活性。</p><p id="aef9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas 功能的能力可以通过使用参数来扩展。例如,“read_csv”函数有一个“usecols”参数，它允许我们读取 csv 文件中列的子集。</p><p id="b9b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，一些函数有接受 Python 字典作为参数的参数。它进一步增加了灵活性，并加快了几个操作。</p><p id="aa29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将讨论 4 个熊猫的功能，它们可以在字典的帮助下更好地发挥作用。</p><p id="5019" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从创建一个样本数据框开始。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="49f3" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="0116" class="ma mb it lw b gy mg md l me mf">df = pd.DataFrame({<br/>   "Group": ["A","B","B","C","A","A","C"],<br/>   "Price": ["125","100","120","36","98","170","111"],<br/>   "Weight": ["12.13","16.21","9.54","7.99","10.06","15.14","10.54"]<br/>})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/0e8cf5324fbd6813678a1b8b3c847184.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*sYm-nrsLo6WzzJsyR8crkg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df(作者图片)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="3162" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">1.Astype</h1><p id="3d04" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">“astype”函数可用于更改列的数据类型。我以所有列都具有 object 数据类型的方式创建了数据框。</p><p id="3c72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，似乎 price 和 weight 列的数据类型应该分别改为 integer 和 float。</p><p id="19cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一种选择是逐个更改数据类型。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a752" class="ma mb it lw b gy mc md l me mf">df["Price"] = df["Price"].astype("int")</span><span id="149f" class="ma mb it lw b gy mg md l me mf">df["Weight"] = df["Weight"].astype("float")</span></pre><p id="026b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更实用的方法是将字典传递给“astype”函数，并在一个步骤中更改两种数据类型。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="309d" class="ma mb it lw b gy mc md l me mf">df = df.astype({"Price":"int", "Weight":"float"})</span></pre><p id="aa54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们检查一下新的数据类型:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="176f" class="ma mb it lw b gy mc md l me mf">df.dtypes</span><span id="45bf" class="ma mb it lw b gy mg md l me mf">Group      object<br/>Price       int32<br/>Weight    float64<br/>dtype: object</span></pre></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="469b" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">2.替换</h1><p id="b62d" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">顾名思义，替换函数用于更改数据框中的值。</p><p id="1f9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它有两个参数:一个是要替换的值，另一个是新值。</p><p id="09d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">replace 函数也接受一个字典，这样我们可以一次替换多个值。</p><p id="d23d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们更新组列中的值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="39a5" class="ma mb it lw b gy mc md l me mf">df["Group"] = df["Group"].replace(<br/>    {"A": "Group A", "B": "Group B", "C": "Group C"}<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/7c870a707e5e4d43826b81c0d689ef7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*7hVM_exBmwnP4V_1J9BzFQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df(作者图片)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="f07f" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">3.菲尔娜</h1><p id="c8f2" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">在数据清理过程中，我们经常需要处理缺失值。“fillna”函数可用于通过适当的替换来更新缺失值。</p><p id="68e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们在多列中有缺失值，并希望使用单独的值来填充每列中缺失的值。</p><p id="97ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你可能猜到的，解决方法是使用字典。</p><p id="3626" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先向数据框中添加一些缺失值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9d9a" class="ma mb it lw b gy mc md l me mf">df.iloc[:2, :2] = np.nan</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/3d54849ad57a219d381ec95f3034e559.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*OdGIwKS9nXmvZkctSZUr6g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df(作者图片)</p></figure><p id="3728" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想将“组 A”用于“组”列，将 100 用于“价格”列，作为缺失值的替换。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1e77" class="ma mb it lw b gy mc md l me mf">df = df.fillna({"Group": "Group A", "Price": 100})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/31f2fbc531930f67f5fffba66a527a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*QQduQ7dLXZtREgwqi9uVRg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df(作者图片)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="8f05" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">4.应用</h1><p id="07b3" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">应用函数用于将函数应用于沿轴(即行或列)的数据框中的值。</p><p id="92e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">轴可以用轴参数改变。默认值为 0，表示该函数与索引一起应用(例如，应用于每一列)。</p><p id="d217" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过使用字典，我们可以对不同的列应用不同的函数。</p><p id="9a3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，下面的代码将“价格”列中的值加 10，并将“重量”列中的值增加 10%。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="87fd" class="ma mb it lw b gy mc md l me mf">df.apply({"Price": lambda x: x + 10, "Weight": lambda x: x * 1.1})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/a63829d6be1a46c09485b0b5851bf0c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*5jdA_2La8cWSjTMOltwhDQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="24d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经讨论了 4 个 Pandas 函数，它们通过使用 Python 字典提供了更多的功能。</p><p id="5899" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些不是唯一可以和字典一起使用的熊猫函数。例如，“read_csv”、“agg”和“round”函数也接受 Python 字典作为参数。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="53d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以成为<a class="ae ky" href="https://sonery.medium.com/membership" rel="noopener">媒介会员</a>来解锁我的作品的全部权限，以及媒介的其余部分。如果您使用以下链接，我将收取您的一部分会员费，无需您支付额外费用。</p><div class="np nq gp gr nr ns"><a href="https://sonery.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">通过我的推荐链接加入 Medium-Soner yl DRM</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">sonery.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og ks ns"/></div></div></a></div></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="aeeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>