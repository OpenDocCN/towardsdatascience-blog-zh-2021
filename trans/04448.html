<html>
<head>
<title>Interesting Ways to Select Pandas DataFrame Columns</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">选择熊猫数据帧列的有趣方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interesting-ways-to-select-pandas-dataframe-columns-b29b82bbfb33?source=collection_archive---------0-----------------------#2021-04-16">https://towardsdatascience.com/interesting-ways-to-select-pandas-dataframe-columns-b29b82bbfb33?source=collection_archive---------0-----------------------#2021-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3b7f0a8b32b68229678795a19883a32d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MArNnCyyR4B8zsbp"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">克里斯汀娜·戈塔迪在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="344e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在数据科学项目的探索性分析或预处理过程中，操作pandas数据框是一项常见任务。过滤和子设置数据也很常见。随着时间的推移，我发现自己需要根据不同的标准来选择列。希望读者找到这篇文章作为参考。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="4520" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">示例数据</h2><p id="8a36" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">如果您想使用我用来测试这些从pandas数据框中选择列的方法的数据，请使用下面的代码片段将wine数据集放入您的IDE或笔记本中。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="d851" class="li lj iq ml b gy mp mq l mr ms">from sklearn.datasets import load_wine<br/>import pandas as pd<br/>import numpy as np<br/>import re</span><span id="8f99" class="li lj iq ml b gy mt mq l mr ms">X = load_wine()<br/>df = pd.DataFrame(X.data, columns = X.feature_names)</span><span id="5a8b" class="li lj iq ml b gy mt mq l mr ms">df.head()</span></pre><figure class="mg mh mi mj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/9c65064bd68e101b1cbeb7569c53ba72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G5gVOud1yeT-Tr-1495NvQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">Jupyter笔记本中葡萄酒数据集的作者截图</p></figure><p id="8806" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，根据您想要做的事情，查看下面的每一个代码片段，并亲自尝试！</p><h2 id="5f28" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">根据名称选择列</h2><p id="c8fa" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">这是从数据帧中选择单个列的最基本方法，只需将列的字符串名称放在括号中。返回熊猫系列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="723e" class="li lj iq ml b gy mp mq l mr ms">df['hue']</span></pre><p id="c438" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在括号中传递一个列表可以让您同时选择多个列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="f9dc" class="li lj iq ml b gy mp mq l mr ms">df[['alcohol','hue']]</span></pre><h2 id="6b2e" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">选择列表中找到的列的子集</h2><p id="d077" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">与上一个示例类似，但这里您可以搜索数据帧中的所有列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="c26f" class="li lj iq ml b gy mp mq l mr ms">df[df.columns[df.columns.isin(['alcohol','hue','NON-EXISTANT COLUMN'])]]</span></pre><h2 id="d625" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">基于列的差异选择列的子集</h2><p id="414f" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">假设你知道你<em class="mv">不</em>想要数据框架中的哪些列。将它们作为一个列表传递给<em class="mv"> difference </em>方法，你将得到除它们之外的所有内容。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="040d" class="li lj iq ml b gy mp mq l mr ms">df[df.columns.difference([‘alcohol’,’hue’])]</span></pre><h2 id="3427" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">选择不在列表中的列子集</h2><p id="cd66" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">返回一个数据框，其中的列不在您要搜索的列表中。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="9f23" class="li lj iq ml b gy mp mq l mr ms">df[df.columns[~df.columns.isin(['alcohol','hue'])]]</span></pre><h2 id="e891" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">基于列的数据类型选择列</h2><p id="6bab" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">数据类型包括“float64”和“object ”,是从传递给<em class="mv"> dtypes </em>方法的列中推断出来的。通过匹配相同数据类型的列，您将得到一系列真/假。使用<em class="mv"> values </em>方法只获取真/假值，而不获取索引。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="edb7" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,(df.dtypes=='float64').values]</span></pre><h2 id="67c6" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">根据包含子字符串的列名选择列</h2><p id="4f5a" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">如果数据框中有大量列，并且它们的列名都有您感兴趣的相似子串，则可以返回名称中包含子串的列。在这里，我们需要包含“al”子字符串的所有内容。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="3e5e" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,['al' in i for i in df.columns]]</span></pre><h2 id="6efb" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">根据包含字符串通配符的列名选择列</h2><p id="245f" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">您可能有数百列，因此查找与某个模式匹配的列可能是有意义的。可以使用<em class="mv"> re </em>包中的“search”函数来搜索与通配符匹配的列名(有关使用正则表达式包的更多详细信息，请参见参考部分中的链接)。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="8102" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,[True if re.search('flava+',column) else False for column in df.columns]]</span></pre><h2 id="87ec" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">根据列名的开头选择列</h2><p id="5a3d" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">如果希望选择名称以某个字符串开头的列，可以使用<em class="mv"> startswith </em>方法，并将其传递到数据框位置的columns位置。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="9bc4" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,df.columns.str.startswith('al')]</span></pre><h2 id="4290" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">根据列名的结尾选择列</h2><p id="616f" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">与上一个示例相同，但是查找名称以某种方式结尾的列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="c525" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,df.columns.str.endswith('oids')]</span></pre><h2 id="6429" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">如果所有行都满足条件，则选择列</h2><p id="46e4" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">如果行满足条件，您可以选择列。这里，如果一列中的所有值都大于14，我们将从数据框中返回该列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="e2a7" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,[(df[col] &gt; 14).all() for col in df.columns]]</span></pre><h2 id="f58c" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">如果列中的任何一行满足条件，则选择列</h2><p id="83c3" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">这里，如果一列中的任何值大于14，我们将从数据框中返回该列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="1dc2" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,[(df[col] &gt; 14).any() for col in df.columns]]</span></pre><h2 id="3f98" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">如果列中的平均行数满足条件，则选择列</h2><p id="e463" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">这里，如果一列中所有值的平均值满足某个条件，则返回该列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="438d" class="li lj iq ml b gy mp mq l mr ms">df.loc[:,[(df[col].mean() &gt; 7) for col in df.columns]]</span></pre></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="59eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的检查，并随时参考它。</p><h2 id="61f2" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">参考</h2><div class="mw mx gp gr my mz"><a href="https://github.com/caseywhorton/medium-blog-code" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">GitHub-Casey Horton/medium-blog-code</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">在GitHub上创建一个帐户，为Casey Horton/medium-blog-code开发做贡献。</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">github.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn jw mz"/></div></div></a></div><div class="mw mx gp gr my mz"><a href="https://docs.python.org/3/library/re.html" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">重新正则表达式操作- Python 3.9.4文档</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">这个模块提供了类似于Perl中的正则表达式匹配操作。无论是图案还是字符串…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">docs.python.org</p></div></div></div></a></div><div class="mw mx gp gr my mz"><a href="https://pandas.pydata.org/" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">熊猫</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">pandas是一个快速、强大、灵活且易于使用的开源数据分析和操作工具，构建于…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">pandas.pydata.org</p></div></div><div class="ni l"><div class="no l nk nl nm ni nn jw mz"/></div></div></a></div></div></div>    
</body>
</html>