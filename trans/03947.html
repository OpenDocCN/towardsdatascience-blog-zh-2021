<html>
<head>
<title>Neo4j for Diseases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于疾病的Neo4j</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/neo4j-for-diseases-959dffb5b479?source=collection_archive---------22-----------------------#2021-04-02">https://towardsdatascience.com/neo4j-for-diseases-959dffb5b479?source=collection_archive---------22-----------------------#2021-04-02</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="eea6" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">用图形数据库分析KEGG疾病数据</h2></div><blockquote class="kg kh ki"><p id="1749" class="kj kk kl km b kn ko js kp kq kr jv ks kt ku kv kw kx ky kz la lb lc ld le lf ik bi translated">本文展示了如何:</p><p id="fabc" class="kj kk kl km b kn ko js kp kq kr jv ks kt ku kv kw kx ky kz la lb lc ld le lf ik bi translated">1.使用Neo4j快速浏览KEGG疾病数据库。</p><p id="4bb4" class="kj kk kl km b kn ko js kp kq kr jv ks kt ku kv kw kx ky kz la lb lc ld le lf ik bi translated">2.识别多用途药物。</p><p id="24f4" class="kj kk kl km b kn ko js kp kq kr jv ks kt ku kv kw kx ky kz la lb lc ld le lf ik bi translated">3.显示一些病原体的细节，如新型冠状病毒。</p><p id="57ce" class="kj kk kl km b kn ko js kp kq kr jv ks kt ku kv kw kx ky kz la lb lc ld le lf ik bi translated">4.用Louvain形成疾病社区，用PageRank发现关联度最高的疾病。SARS和新冠肺炎是与其他大型疾病群隔离的“孤岛”。</p></blockquote><p id="e80e" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated"><em class="kl">免责声明:本文不提供医疗建议。它仅供参考。它不能替代专业的医疗建议、诊断或治疗。</em></p><p id="c3ff" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">新冠肺炎遥遥领先于世界。这种传染病给我们的生活带来了沉重的代价。它扰乱了许多家庭，造成巨大的经济损失，也许永远改变了我们的行为。因此，它提高了我们对公共卫生问题的认识。显而易见，我们人类需要在医学研究上投入更多，以避免下一场灾难。</p><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj lj"><img src="../Images/30291f73c8bedad956331cf1dfced142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inTUrcJu3Wo9yJ2lShKuAg.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图一。来自KEGG疾病数据库的条目“新冠肺炎”在Neo4j中可视化。<em class="lz">作者图片。</em></p></figure><p id="0eeb" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">自从我的上一个故事“<a class="ae ma" href="https://medium.com/geekculture/analyzing-genomes-in-a-graph-database-27a45faa0ae8" rel="noopener">在图数据库中分析基因组</a>”以来，我注意到在<a class="ae ma" href="https://www.genome.jp/kegg/" rel="noopener ugc nofollow" target="_blank">京都基因和基因组百科全书(KEGG) </a>数据库中仍然有许多宝藏。其中之一无疑是KEGG疾病数据库。该数据库包含许多已知人类疾病的详细信息。此外，连同其他数据库，如基因组，药物和基因，KEGG为我们提供了一个非常广泛的网络知识的障碍，其原因和药物。正如我在文章中提到的，像<a class="ae ma" href="https://neo4j.com/" rel="noopener ugc nofollow" target="_blank"> Neo4j </a>这样的图形数据库有助于生物医学研究中的知识发现。来自KEGG的这些信息对于这样一个数据项目来说是完美的。因此，我通过<a class="ae ma" href="https://www.kegg.jp/kegg/rest/keggapi.html" rel="noopener ugc nofollow" target="_blank"> API </a>下载并处理了KEGG疾病数据库中的数据，将其导入Neo4j，进行了几次分析，并发现了一些有趣的信息。</p><p id="1881" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">在这篇文章中，我将集中讨论疾病、病原体和药物之间的关系。这个项目的代码存放在我的Github库中:</p><div class="mb mc gq gs md me"><a href="https://github.com/dgg32/kegg_disease" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fp"><div class="mg ab mh cl cj mi"><h2 class="bd is gz z fq mj fs ft mk fv fx iq bi translated">GitHub-dgg 32/kegg _疾病</h2><div class="ml l"><h3 class="bd b gz z fq mj fs ft mk fv fx dk translated">这个存储库包含我的文章“疾病的Neo4j”的代码和数据。脚本是用于数据处理的。的…</h3></div><div class="mm l"><p class="bd b dl z fq mj fs ft mk fv fx dk translated">github.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms lt me"/></div></div></a></div><h1 id="7d48" class="mt mu ir bd mv mw mx my mz na nb nc nd jx ne jy nf ka ng kb nh kd ni ke nj nk bi translated">1.将数据导入Neo4j</h1><p id="9629" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">所有CSV文件都位于数据文件夹中。如果你想更新信息，你可以按照我的回购README.md中的说明。</p><p id="ddc0" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">从他们的<a class="ae ma" href="https://neo4j.com/download/" rel="noopener ugc nofollow" target="_blank">官网</a>下载Neo4j桌面。安装完成后，添加一个新的“本地DMBS”并命名为“kegg_disease”。点击“…”-&gt;“打开文件夹”- &gt;“导入”，打开其导入文件夹。将所有CSV文件放入文件夹中。然后，运行以下命令，它们将导入所有信息:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><h1 id="4ee1" class="mt mu ir bd mv mw mx my mz na nb nc nd jx ne jy nf ka ng kb nh kd ni ke nj nk bi translated">2.获取概述</h1><p id="4107" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">一旦数据被导入，我们就可以对KEGG疾病数据库进行一些基本的统计。这三个命令获取所有三种类型节点的总数:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="3b36" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">因此，数据库中记录了333种病原体、1，339种药物和2，498种疾病。这是一个相当大的数据集。我们也可以用Neo4j Bloom看看数据的拓扑结构。在搜索短语中输入下面的密码查询并执行它(<a class="ae ma" href="https://medium.com/geekculture/analyzing-genomes-in-a-graph-database-27a45faa0ae8" rel="noopener">我以前的文章展示了详细的步骤</a>):</p><pre class="lk ll lm ln gu ns nt nu nv aw nw bi"><span id="5ab9" class="nx mu ir nt b gz ny nz l oa ob">MATCH p=(n:disease) &lt;-[]-() RETURN p;</span></pre><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj oc"><img src="../Images/db41f287a110b436c2435c009648abaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DcH7Oc9wvj14PxmBFJbHUA.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图二。此项目中的数据拓扑。绿点代表“疾病”，红点代表“药物”，蓝点代表“病原体”。<em class="lz">作者图片。</em></p></figure><p id="5fc1" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">运行以下命令以获取数据集中排名前十的疾病类别。尽管有些疾病(如Schwartz-Jampel综合征和中央核肌病)被分为两类，但要小心，查询不会分别重复计算它们。：</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="a448" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">你会看到这样的结果:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="672d" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">令我惊讶的是，在这个问题下，第一名既不是传染病，也不是两个臭名昭著的杀手——心血管疾病和癌症。是先天畸形，包括<a class="ae ma" href="https://en.wikipedia.org/wiki/Nail%E2%80%93patella_syndrome" rel="noopener ugc nofollow" target="_blank">钉-髌骨综合征</a>和梅克尔综合征。</p><p id="6cf8" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">传染病可由病毒、细菌或真核生物引起。以下命令将显示数据库中每个的编号:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="fff2" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">结果是:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="1a20" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">令我惊讶的是，细菌，而不是病毒，是数据中最常见的病原体。通过发出以下命令，我们可以更深入地了解病毒:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="6d9b" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">这个查询结合了分类法的第一层和第二层，并对它们进行计数。</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="0ad1" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">如你所见，核糖病毒是最丰富的病毒领域。但是核糖病毒也是一个非常多样的分类群。新型冠状病毒及其前身SARS冠状病毒(2002-2004年SARS爆发的病原体)都属于核糖病毒属。但是人类免疫缺陷病毒(HIV)和肝炎病毒也是如此。</p><p id="2831" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">最后，我们可以通过发出以下命令来获得抗传染病药物的数量:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="7a90" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">该查询返回293种药物。值得注意的是,“DISTINCT”关键字在这里是必要的，因为一些药物可以用于治疗多种疾病，如果没有“DISTINCT ”,它们会被重复计算。</p><h1 id="490d" class="mt mu ir bd mv mw mx my mz na nb nc nd jx ne jy nf ka ng kb nh kd ni ke nj nk bi translated">3.寻找多用途药物</h1><p id="14df" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">多用途药物是可以用来治疗一种以上疾病的药物。换句话说，他们是多才多艺的。因为药物的开发很昂贵，而且需要严格的临床试验，所以如果“旧药能出新招”(请看美国国家卫生研究院主任弗朗西斯·柯林斯富有启发性的TED演讲<a class="ae ma" href="https://www.ted.com/talks/francis_collins_we_need_better_drugs_now" rel="noopener ugc nofollow" target="_blank">这里</a>)，这对患者和制药公司来说无疑都是好消息。在实践中，药物受到美国食品和药物管理局等机构的严格监管，制造商只能将它们用于食品和药物管理局批准的适应症。因此，找出数据中最通用的药物以及它们的适应症将是非常有趣的。</p><p id="c43e" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">发出以下命令来查看十大最通用的药物:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="4c26" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">结果是:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="6260" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">前十名名单基本由两类药物组成:类固醇激素和四环素类抗生素多西环素。类固醇激素用于抑制免疫系统和治疗各种炎症。列表中的第三种地塞米松已经在新冠肺炎患者中进行了研究，初步结果显示，它降低了那些接受有创机械通气或单独使用氧气的患者的死亡率，但没有降低那些没有接受呼吸支持的患者的死亡率(<a class="ae ma" href="https://www.nejm.org/doi/10.1056/NEJMoa2021436" rel="noopener ugc nofollow" target="_blank">康复合作小组，2020年</a>)。强力霉素是一种广谱抗生素，用于治疗疟疾、莱姆病、霍乱和梅毒等传染病。事实上，以下查询显示，这些类固醇激素的适应症相互重叠，而多西环素及其衍生物也针对许多相同的疾病。</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj od"><img src="../Images/99b953e938ef24355476dd4fbe4733af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Y78KDE3fjegk1B5xV087g.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图3。KEGG十大多用途药物的适应症。<em class="lz">作者图片。</em></p></figure><p id="d413" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">例如，列表中的前两种药物:泼尼松及其活性形式泼尼松龙，自1955年以来在美国已被批准用于医疗用途。<a class="ae ma" href="https://clincalc.com/DrugStats/Top300Drugs.aspx" rel="noopener ugc nofollow" target="_blank">它们很受欢迎:根据DrugStats数据库</a>，到目前为止，泼尼松是2021年美国第21大处方药，泼尼松龙是第134大处方药。逐一发出这两个命令，查看泼尼松龙磷酸钠的详细信息:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="300d" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">并且查询返回</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="dab7" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">并且:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="d787" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">事实证明，泼尼松龙不仅用于治疗免疫系统疾病，还用于治疗旋毛虫病和结核病等传染病。由于其抗炎作用，它也用于慢性阻塞性肺病(COPD)。<a class="ae ma" href="https://www.pulmonaryfibrosis.org/life-with-pf/pulmonary-fibrosis-treatment-options" rel="noopener ugc nofollow" target="_blank">然而，其在特发性肺纤维化(IPF)中的应用尚不确定</a>。</p><p id="fd83" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">到目前为止，美国2021年最常开出的药物——阿伐他汀及其衍生物，其用途仅限于四种代谢或心血管疾病:高脂血症、家族性高胆固醇血症、心绞痛和心肌梗死。</p><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj oe"><img src="../Images/9bbb4ea6d5b7e9ceec8e33fa52584749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aozf2jltSmoJSNdEs0tRNA.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图4。KEGG中阿伐他汀及其衍生物的适应症。<em class="lz">作者图片。</em></p></figure><h1 id="db17" class="mt mu ir bd mv mw mx my mz na nb nc nd jx ne jy nf ka ng kb nh kd ni ke nj nk bi translated">4.一些病原体的细节</h1><p id="804c" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">现在是探索病原体数据的时候了。首先，我们可以数一数一种病原体能引起多少种不同的疾病。</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="2704" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">前十都是病毒。前两种是乳头瘤病毒，可导致人类不同类型的癌症。根据<a class="ae ma" href="https://en.wikipedia.org/wiki/Human_papillomavirus_infection" rel="noopener ugc nofollow" target="_blank">维基百科</a>，大多数乳头瘤病毒感染是无症状的，90%的病例会在两年内消失。但在其他情况下，它们持续存在并导致疣或病变。这些病变增加了人体各部位患癌的风险，如子宫颈、外阴、阴道、阴茎、肛门、口腔、扁桃体或咽喉(图5。).几乎所有的宫颈癌都是由人乳头瘤病毒引起的；这两种菌株占了70%的病例。仅HPV16就导致了几乎90%的人乳头瘤病毒阳性口咽癌。</p><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj of"><img src="../Images/4342ab3772a41f51a88169aa65b3df29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Yjl4axff4OJfFzXx1Diug.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图5。HPV18和HPV16与癌症。<em class="lz">图片作者。</em></p></figure><p id="cf4d" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">相比之下，非典和新型冠状病毒都与一种疾病有关。SARS导致了中国2002年至2004年的SARS疫情，到目前为止还没有抗病毒疗法。对于新冠肺炎，KEGG列出了药物remdesivir。Siemieniuk <em class="kl">等人</em>。进行了一项活体系统评价(<a class="ae ma" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7390912/" rel="noopener ugc nofollow" target="_blank">在此处阅读</a>)，并声明remdesivir可能会缩短COVID症状。</p><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj og"><img src="../Images/68d34113c0679e8e6097b61acec67953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jpbnh-FgK0f33ZYqYrx0rQ.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图6。非典和新型冠状病毒以及它们引发的疾病。<em class="lz">图片作者。</em></p></figure><p id="c9c5" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">抗疟药硫酸羟氯喹<strong class="km is">未</strong>被<strong class="km is"> </strong>视为治疗KEGG新冠肺炎的药物。</p><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj oh"><img src="../Images/9b2b8c1933deb0db8f0cc73569121923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhQqepiygleaG3yJUDSbKA.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图7。硫酸羟氯喹的细节。<em class="lz">图片作者。</em></p></figure><p id="6f80" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">这与Siemieniuk研究中的一个结论相呼应:</p><blockquote class="oi"><p id="5a14" class="oj ok ir bd ol om on oo op oq or lf dk translated">羟氯喹可能不会降低死亡率或机械通气，而且似乎不太可能有任何其他好处(对新冠肺炎而言)。</p></blockquote><h1 id="1382" class="mt mu ir bd mv mw mx my mz na nb nc nd jx os jy nf ka ot kb nh kd ou ke nj nk bi translated">5.使用图形算法发现社区和高度连接的节点</h1><p id="a018" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">图2中的拓扑。有一些有趣的特点。许多小网络围绕着一大群互连的点。确定这些集群并确定一些连接最紧密的节点，即所谓的枢纽，将是一件有趣的事情。幸运的是，Neo4j为我们提供了一个非常强大的插件:图形数据科学(gds)来处理这些任务。</p><p id="d77d" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">首先转到Neo4j桌面中的项目详细信息选项卡并安装插件:</p><figure class="lk ll lm ln gu lo gi gj paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gi gj ov"><img src="../Images/c1cc6b7755f4cb8b5e789552ef3df804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2K1yMf-5Sd1niseGKYfUKA.png"/></div></div><p class="lv lw gk gi gj lx ly bd b be z dk translated">图8。安装图形数据科学(gds)插件。<em class="lz">作者图片。</em></p></figure><p id="6282" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">在Neo4j中，图形算法在图形投影上运行。首先，我们将所有的节点和边放入一个名为“disease-graph”的带Cypher的命名图投影中。</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><h2 id="f6b2" class="nx mu ir bd mv ow ox dn mz oy oz dp nd lg pa pb nf lh pc pd nh li pe pf nj pg bi translated">5.1利用Louvain算法形成疾病社区</h2><p id="0618" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">现在我们可以对它运行卢万算法来识别集群或社区。该算法将紧密连接的节点压缩成更大的节点，并且重复直到不可能压缩。首先，我们询问可以形成多少个社区:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="6be3" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">在4170个节点中，Louvian算法可以创建2120个社区。我用不同的参数运行这个查询，比如“maxIterations”和“tolerance ”,但是看不到任何大的差异。</p><p id="c5cf" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">我们可以查看最大的社区并查看其成员:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="b8f7" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">它返回:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="8bd8" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">现在，我们可以通过以下方式检查社区“3421”中的成员:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="886a" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">成员包括:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="7600" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">浏览列表后，很明显这个社区主要包含与肿瘤相关的项目。已知会增加癌症风险的病原体，如乙型和丁型肝炎病毒，也在这个社区。</p><p id="9a94" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">您可以进一步分析社区。我自己的社区分析表明，大型集群中的疾病是那些受到最多研究关注的疾病，它们通过常见病原体或通用药物密切相关。相比之下，许多孤立的“岛屿”是罕见的疾病，如<a class="ae ma" href="https://en.wikipedia.org/wiki/Christianson_syndrome" rel="noopener ugc nofollow" target="_blank">克里斯蒂安森综合征</a>或<a class="ae ma" href="https://en.wikipedia.org/wiki/Zimmermann%E2%80%93Laband_syndrome" rel="noopener ugc nofollow" target="_blank">齐默尔曼-拉班德综合征</a>。值得注意的是，非典和新冠肺炎是两个孤立的“孤岛”(图2。)尽管它们引起了轰动性的流行病。信息也很清楚:相对而言，我们对新冠肺炎仍然知之甚少。</p><h2 id="8696" class="nx mu ir bd mv ow ox dn mz oy oz dp nd lg pa pb nf lh pc pd nh li pe pf nj pg bi translated">5.2用PageRank发现连接最多的节点</h2><p id="b3b4" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">最后，我们可以使用<a class="ae ma" href="https://neo4j.com/docs/graph-data-science/current/algorithms/page-rank/#algorithms-page-rank" rel="noopener ugc nofollow" target="_blank"> PageRank </a>来检查图中哪些节点连接良好:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="8fd1" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">最佳结果是:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="dc8e" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">没有药物或病原体节点进入前十二个最重要的列表，所有都是疾病。这一方面可以解释为，在我们的数据模型中，每个病原体和药物都保证与一个疾病节点相关联。所以疾病节点从一开始就是默认的中心。另一方面，这个列表包含了现代世界中一些最常见的人类痛苦，并且已经开发了许多药物来解决它们。事实上，通过更复杂的查询，我们可以计算出与这些主要疾病相关的药物:</p><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><figure class="lk ll lm ln gu lo"><div class="bz fq l di"><div class="nq nr l"/></div></figure><p id="c9f1" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">结果显示，有103种药物被指定用于治疗高血压，位于列表的顶部节点。牛皮癣是这个列表中的最后一种，影响了2-4%的西方人口，但在数据库中有34种药物治疗牛皮癣。然而，药物数量排名并不完全遵循PageRank。例如，有48种药物用于治疗类风湿性关节炎，这比那些排名较高的疾病如乳腺癌、重性抑郁症和血吸虫病的药物还多。</p></div><div class="ab cl ph pi hv pj" role="separator"><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm"/></div><div class="ik il im in io"><h1 id="776a" class="mt mu ir bd mv mw po my mz na pp nc nd jx pq jy nf ka pr kb nh kd ps ke nj nk bi translated">结论</h1><p id="7d65" class="pw-post-body-paragraph kj kk ir km b kn nl js kp kq nm jv ks lg nn kv kw lh no kz la li np ld le lf ik bi translated">该项目是展示Neo4j在生物医学研究中的力量的又一个例子。一旦数据被导入Neo4j，我们就可以快速获得大量关于疾病的数据和细节。如果在关系数据库中完成，我们将需要三个表来建模数据，而不是Neo4j中的一个模式。此外，Cypher查询的表述非常简单，读者无需任何“连接”即可理解。最后，在图形数据库中，我们可以对数据运行图形算法，并轻松发现一些有趣的新见解。</p><p id="924e" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">这并不是说我们应该放弃其他数据库。当我们的数据包含大量连接时，图形数据库是一个很好的选择，例如我们之前的项目和这里的KEGG Disease项目。在简单计数的情况下，如价格表，我们应该使用关系数据库。对于文档，要考虑MongoDB等文档数据库。时间序列也有自己的数据库，如Amazon Timestream或InfluxDB。</p><p id="af9a" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">这个项目也给我们上了关于疾病和健康的宝贵一课。其中之一是关于我们的免疫系统。在目前的新冠肺炎疫情期间，我们更有可能购买那些“增强你的免疫系统”的广告。但是我们的免疫系统非常脆弱，我们绝不希望看到它超速运转。相反，上面的分析表明，一些最通用和广泛使用的药物实际上是免疫抑制剂，即抑制免疫系统的药物。而约翰·霍普金斯大学估计<a class="ae ma" href="https://pathology.jhu.edu/autoimmune/prevalence" rel="noopener ugc nofollow" target="_blank"> 3%的美国人口患有自身免疫性疾病，</a>也就是一千万人左右！这让我想起马特·里奇特尔在<em class="kl"> </em> <a class="ae ma" href="https://www.amazon.com/Elegant-Defense-Extraordinary-Science-Immune/dp/0062698494/ref=sr_1_1?crid=2V1EP1KV05U19&amp;dchild=1&amp;keywords=the+elegant+defense&amp;qid=1625051307&amp;sprefix=the+elegant+defens%2Caps%2C236&amp;sr=8-1" rel="noopener ugc nofollow" target="_blank"> <em class="kl">中的一段优雅的辩护</em> </a> <em class="kl"> </em>当听到有希望增强免疫系统的广告时，安东尼·福奇博士说</p><blockquote class="kg kh ki"><p id="0ce7" class="kj kk kl km b kn ko js kp kq kr jv ks kt ku kv kw kx ky kz la lb lc ld le lf ik bi translated">“这几乎让我窃笑。首先，这是假设你的免疫系统需要增强，而这很可能并不需要。如果你成功地增强了你的免疫系统，你可能会让它做坏事。”</p></blockquote><p id="d1cb" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">这个项目只涵盖了KEGG的一小部分:疾病、药物和病原体。我只是想知道，如果我们利用KEGG中存储的所有信息，我们可以获得什么样的新见解。因此，我鼓励您使用图形数据库来进一步探索这个数据宝库，并向我展示您在这一过程中发现的东西。</p><p id="0370" class="pw-post-body-paragraph kj kk ir km b kn ko js kp kq kr jv ks lg ku kv kw lh ky kz la li lc ld le lf ik bi translated">这篇文章是我自己翻译成中文的:<a class="ae ma" href="https://blog.csdn.net/dgg32/article/details/119081851" rel="noopener ugc nofollow" target="_blank">https://blog.csdn.net/dgg32/article/details/119081851</a></p><div class="mb mc gq gs md me"><a href="https://dgg32.medium.com/membership" rel="noopener follow" target="_blank"><div class="mf ab fp"><div class="mg ab mh cl cj mi"><h2 class="bd is gz z fq mj fs ft mk fv fx iq bi translated">加入媒介与我的介绍链接-黄思兴</h2><div class="ml l"><h3 class="bd b gz z fq mj fs ft mk fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mm l"><p class="bd b dl z fq mj fs ft mk fv fx dk translated">dgg32.medium.com</p></div></div><div class="mn l"><div class="pt l mp mq mr mn ms lt me"/></div></div></a></div></div></div>    
</body>
</html>