<html>
<head>
<title>Detect Change Points with Bayesian Inference and PyMC3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用贝叶斯推理和PyMC3检测变化点</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/detect-change-points-with-bayesian-inference-and-pymc3-3b4f3ae6b9bb?source=collection_archive---------2-----------------------#2021-12-11">https://towardsdatascience.com/detect-change-points-with-bayesian-inference-and-pymc3-3b4f3ae6b9bb?source=collection_archive---------2-----------------------#2021-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="540d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用观察到的数据更新你的信念</h2></div><h2 id="9530" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">动机</h2><p id="9186" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">想象一下，你使用谷歌分析来跟踪你的网站的浏览量。查看视图后，您怀疑某个日期后视图数量可能会突然变化。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="8936" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">如果确实存在一个浏览量突然变化的日期，如何找到那个日期？</p><p id="986b" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">如果你能利用观察到的数据和一些信念来高度确定地猜测变化点，那不是很好吗？</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mj"><img src="../Images/c29efab081d0996409b2192b40f3321c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hRgyaXAOIGoC9WLPQfqaZg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="ddf8" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">这就是贝叶斯推理派上用场的时候。在本文中，我们将学习什么是贝叶斯推理，以及如何使用PyMC3来执行贝叶斯分析。</p><h1 id="3f64" class="mu kj it bd kk mv mw mx kn my mz na kq jz nb ka ku kc nc kd ky kf nd kg lc ne bi translated">什么是贝叶斯推理？</h1><p id="aab2" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">贝叶斯推理是一种技术，其中贝叶斯定理用于指定一个人应该如何根据观察数据更新自己的信念。</p><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/bayes-theorem-clearly-explained-with-visualization-5083ea5e9b14"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">贝叶斯定理，用可视化清晰地解释</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">如果您的COVID检测呈阳性，那么您实际上患有COVID的几率有多大？</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw mo ni"/></div></div></a></div><p id="7e97" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">例如，我们先前的信念可以是硬币是有偏差的，它遵循Beta(1.36，2.36)分布。然而，在投掷硬币超过100次(观察真实数据)后，我们的信念转变为均值为0.5的正态分布。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nx"><img src="../Images/00d5010b372dd07b1db4893474376c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yNA_JFWsL_DWd7i41dtdsQ.gif"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者GIF使用<a class="ae ny" href="https://seeing-theory.brown.edu/bayesian-inference/index.html#section2" rel="noopener ugc nofollow" target="_blank">视觉理论</a>创建</p></figure><p id="b579" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">我们可以看到，收集更多数据后，后验分布可能与先验分布有很大不同。</p><h1 id="7342" class="mu kj it bd kk mv mw mx kn my mz na kq jz nb ka ku kc nc kd ky kf nd kg lc ne bi translated">探索数据</h1><p id="33b4" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我们将使用显示从2021年1月到2021年7月从我的网站<a class="ae ny" href="https://mathdatasimplified.com/" rel="noopener ugc nofollow" target="_blank">数据科学简化版</a>收集的浏览量的数据。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="b65e" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">现在，我们如何找到视图数量分布发生变化的日期？</p><p id="62d3" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">让我们从寻找时间τ和视图数量的先验分布开始。</p><h1 id="72e3" class="mu kj it bd kk mv mw mx kn my mz na kq jz nb ka ku kc nc kd ky kf nd kg lc ne bi translated">先验分布</h1><h2 id="3cd2" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">视图数量的先验分布</h2><p id="6143" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">由于视图的数量是计数数据，因此可以使用离散分布(如泊松分布)对其建模。</p><p id="3f3a" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">泊松分布显示了一个事件在固定的时间间隔内可能发生的次数。泊松分布使用参数<em class="oa"> λ </em>来控制其形状。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/0291ad9c8276441a84884ff238ef942d.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*SC0RSEQ2n6CDXykISVudiw.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="201e" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">让我们画一个泊松分布来看看它是什么样子的。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><p id="30d4" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated"><em class="oa"> λ </em> = 1.5的泊松分布:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/bce21ff1787a299b969b63fd37f06596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*qHqkIbVyf-AHIGW_Ixk9Fw.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="bf33" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">当增加<em class="oa"> λ </em>时，我们给更大的值增加更多的概率。例如，将<em class="oa"> λ </em>的值从1.5增加到3会将分布的平均值向右移动:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi od"><img src="../Images/45e9d2da04708ab9c83f77faa3431778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*BkEexQPWstn-EFDdxUMb9Q.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="a66c" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">从上面的图中，我们可以看到视图的平均数量接近于<em class="oa"> λ。</em></p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/0db200efa7280f8557ba2fb0d25ebbd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*wzh_heOndLOShZ6cxl47Pw.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="e1c3" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">酷！现在我们知道了如何对视图数量的先验分布进行建模，我们如何找到一个合适的<em class="oa"> λ </em>？</p><h2 id="090b" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><em class="of"> λ </em>的先验分布</h2><p id="07a3" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我们不知道<em class="oa"> λ，</em>的具体值，但是我们知道存在一个时间𝜏，在该时间之后，视图数量的分布发生显著变化。因此，我们可以说，<em class="oa"> λ = </em> 𝜆₁在时间𝜏之前，而<em class="oa"> λ = </em> 𝜆₂在时间𝜏.之后</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c4ebd1897d5f5756d654b93edd66a26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*iS5NMeNzret2eORoBmpv3g.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi oh"><img src="../Images/4d810d1ae035bb4bcea611c9928c21b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tMp9ex81zkKMeLvQKmxACg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="65ac" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">但是，我们如何对𝜆₁和𝜆₂的先验分布建模呢？由于𝜆₁和𝜆₂是<a class="ae ny" href="http://www.henry.k12.ga.us/ugh/apstat/chapternotes/7supplement.html" rel="noopener ugc nofollow" target="_blank">连续随机变量</a>，我们可以用指数分布来模拟他们的先验分布。</p><p id="2000" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">指数分布通常用于模拟事件之间经过的时间。指数分布也使用一个参数，比如𝛼，来控制它的形状。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi oi"><img src="../Images/6102925be138bc9dbca82656affac24c.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*mZKtMaEQ7yzYeZhoS93adw.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="617c" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">给定一个特定的𝛼，𝜆的期望值等于𝛼.的倒数</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/1fc70257a3a67030381a41dbbc8654b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/1*NG_oMmfH9yCqnYR_I_VtVA.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="5675" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">让我们看看指数分布是什么样的。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><p id="154f" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">𝛼 = 0.1的指数分布:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/35016399cc390c9213b5be3c6a3fad75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*JrHg1Sn8Wm-mthAKS6kLfA.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="e0f3" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">𝛼 = 1的指数分布:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/4cd203e6c95a4655c5fc37f0d0f15198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*V27jwoyuHQduskpRz2csww.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="3fab" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">现在，𝛼的价值是什么？我们可以把前面找到的两个方程结合起来估算𝛼.的值</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi om"><img src="../Images/f1859ff7976f9f793358e36a45c998bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*lJcgq6UN2TvQ3NZ60NRsGA.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="04a2" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">根据上面的等式，将𝛼设置为等于视图数量的反均值是合理的。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi on"><img src="../Images/f6ec7d73bd546f1d8d4a495837a90e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*CGu_DwKTS9AeA9P4hMzvgQ.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><h2 id="be85" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">时间的先验分布</h2><p id="09ef" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">因为所有日期都同样可能是𝜏，所以我们可以使用均匀分布来模拟𝜏.的先验分布</p><p id="7bf4" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">由于总共有182天，我们可以写:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi oo"><img src="../Images/f064b1db25250c5e81e6134cbad6d5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*mm31MdBgDsvFikdaOCiPkg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="055d" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">这意味着𝜏的概率等于𝑘的日期:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi op"><img src="../Images/3edcdd49bef98ca2a2dee43c0c8d33b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*nKSPW9JUfuiQWQkFSw-SWw.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="2c3b" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">让我们想象一下这种均匀分布的样子:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi oq"><img src="../Images/d02558da14b74120e08f0e191fa110e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S0yhZbTT6SZ9WhOwYnXelQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="42b5" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">从上面的图中我们可以看出，所有日期都同样可能是𝜏.</p><h1 id="4a79" class="mu kj it bd kk mv mw mx kn my mz na kq jz nb ka ku kc nc kd ky kf nd kg lc ne bi translated">使用PyMC3的贝叶斯分析</h1><p id="cc80" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">接下来，我们将使用PyMC3执行贝叶斯分析。PyMC3 是一个Python包，使用直观的语法进行贝叶斯统计建模。</p><p id="dc80" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">要安装PyMC3，请键入:</p><pre class="lx ly lz ma gt or os ot ou aw ov bi"><span id="a28e" class="ki kj it os b gy ow ox l oy oz">pip install pymc3</span></pre><h2 id="3814" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">模型变量</h2><p id="9011" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">首先为𝜆₁、𝜆₂和𝜏.创建PyMC3变量</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><p id="4bec" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">接下来，我们使用<code class="fe pa pb pc os b">pm.math.switch</code>给𝜆.赋值𝑡的日期代表𝜆的日期。如果𝑡比𝜏小，它会将𝜆₁的值赋给𝜆.否则，它会将𝜆₂的价值分配给𝜆。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi pd"><img src="../Images/c77f7623b93fc7f28c42e4601e9391fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g6WFHbTYjyqZb3fknVgJYg.png"/></div></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c4ebd1897d5f5756d654b93edd66a26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*iS5NMeNzret2eORoBmpv3g.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><p id="4fe9" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">接下来，我们使用Poisson(𝜆分布对视图数量进行建模:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><p id="34ab" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">注意，到目前为止，我们只模拟了𝜆₁、𝜆₂和𝜏.的先验分布为了从𝜆₁、𝜆₂和𝜏的后验分布中获得一些样本，我们将使用马尔可夫链蒙特卡罗(MCMC)。</p><h2 id="995a" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">使用MCMC获取后验分布的样本</h2><p id="0a65" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated"><a class="ae ny" href="https://machinelearningmastery.com/markov-chain-monte-carlo-for-probability/" rel="noopener ugc nofollow" target="_blank"> MCMC </a>是一种随机抽样概率分布的方法，它尊重样本之间的概率相关性。</p><p id="a215" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">基于C <a class="ae ny" href="https://nbviewer.org/github/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter3_MCMC/Ch3_IntroMCMC_PyMC3.ipynb" rel="noopener ugc nofollow" target="_blank"> am Davidson-Pilon </a>，一般来说，执行MCMC的算法有:</p><blockquote class="pe pf pg"><p id="2273" class="le lf oa lg b lh me ju lj lk mf jx lm ph mg lo lp pi mh lr ls pj mi lu lv lw im bi translated">1.从当前位置开始。</p><p id="2c18" class="le lf oa lg b lh me ju lj lk mf jx lm ph mg lo lp pi mh lr ls pj mi lu lv lw im bi translated">2.提议换一个新的职位。</p><p id="9f3f" class="le lf oa lg b lh me ju lj lk mf jx lm ph mg lo lp pi mh lr ls pj mi lu lv lw im bi translated">3.基于职位对数据和先前分配的坚持，接受/拒绝新职位<strong class="lg iu">。</strong></p><p id="4f26" class="le lf oa lg b lh me ju lj lk mf jx lm ph mg lo lp pi mh lr ls pj mi lu lv lw im bi translated">4.如果你接受:转到新的职位。返回步骤1。</p><p id="8ce8" class="le lf oa lg b lh me ju lj lk mf jx lm ph mg lo lp pi mh lr ls pj mi lu lv lw im bi translated">否则:不要跳槽。返回步骤1。</p><p id="811d" class="le lf oa lg b lh me ju lj lk mf jx lm ph mg lo lp pi mh lr ls pj mi lu lv lw im bi translated">5.经过大量迭代后，返回所有接受的位置。</p></blockquote><p id="3ad6" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">下面的GIF展示了Metropolis-Hastings的搜索策略，一种MCMC方法。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi pk"><img src="../Images/77ea50dd9c0ab3c79172e36d69acfb0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LoEOPQYDc7bdhbTnxQ-DQg.gif"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者GIF—<a class="ae ny" href="https://chi-feng.github.io/mcmc-demo/app.html?algorithm=RandomWalkMH&amp;target=banana" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="36b0" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">让我们使用MCMC从𝜆₁、𝜆₂和𝜏.的后验分布中获得数千个随机变量</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><p id="2b45" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">接下来，想象一下这些随机变量的样子:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi pl"><img src="../Images/63beb7cc7d0b35810185c7e441f89d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09MCUXnaY9ItSNQAKOV6qQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="54bd" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">从上面的图中，我们可以看出:</p><ul class=""><li id="3418" class="pm pn it lg b lh me lk mf kr po kv pp kz pq lw pr ps pt pu bi translated">𝜆₁的后验分布和𝜆₂.的后验分布之间存在显著差异这表明确实存在一个日期𝜏，在该日期之后，观看次数的分布发生变化。</li><li id="2702" class="pm pn it lg b lh pv lk pw kr px kv py kz pz lw pr ps pt pu bi translated">𝜏 = 91的概率是99.99%。这说明变化点有非常高的几率是91。</li></ul><h1 id="9b39" class="mu kj it bd kk mv mw mx kn my mz na kq jz nb ka ku kc nc kd ky kf nd kg lc ne bi translated">查找预期的视图数量</h1><p id="2c99" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">现在我们有𝜆₁、𝜆₂和𝜏的40k个样本，让我们得到每天的预期浏览量。</p><p id="2ba2" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">计算𝑡:日期的预期浏览量的步骤</p><ul class=""><li id="9a03" class="pm pn it lg b lh me lk mf kr po kv pp kz pq lw pr ps pt pu bi translated">选择一个日期𝑡</li><li id="fbbd" class="pm pn it lg b lh pv lk pw kr px kv py kz pz lw pr ps pt pu bi translated">对于每个𝜏样本，查看𝑡的日期是在𝜏.的日期之前还是之后</li><li id="2e11" class="pm pn it lg b lh pv lk pw kr px kv py kz pz lw pr ps pt pu bi translated">如果𝑡在𝜏之前，𝜆的价值就是𝜆₁.如果𝑡在𝜏之后，𝜆的价值就是𝜆₂.</li><li id="7276" class="pm pn it lg b lh pv lk pw kr px kv py kz pz lw pr ps pt pu bi translated">取𝑡日期𝜆所有值的平均值</li></ul><p id="6058" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">例如，如果只有𝜆₁、𝜆₂和𝜏的3个样本，我们的计算将类似于以下内容:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi qa"><img src="../Images/82c4840c25ed5057bb04b385380f7f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9K6TFa7fRE9U68C-Q5C8WA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="823a" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">使用上面的计算方法来计算每天的预期浏览量:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><p id="618a" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">绘制每天的预期浏览量:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nz md l"/></div></figure><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="ab94" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">相当酷！我们可以看到，在第91天之后，预期的视图数量发生了变化。这与我们从真实数据中看到的相符。</p><h1 id="1183" class="mu kj it bd kk mv mw mx kn my mz na kq jz nb ka ku kc nc kd ky kf nd kg lc ne bi translated">结论</h1><p id="9827" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">在结束本文之前，我们应该花点时间来欣赏一下贝叶斯推理是多么强大。我们仅使用观察到的数据和一些初始信念就能如此确定地得到变化点。</p><p id="34ec" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">另外，我们得到了数据在变化点前后的分布。这些分布比单一值能告诉我们更多。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi qb"><img src="../Images/699a4349fa7e4e181332d209b8563194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a1IgSUC8z8RiT1YGCE1I1g.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="5a20" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">希望这篇文章能给你使用贝叶斯推断和PyMC3分析身边其他有趣数据的知识和动力。</p><p id="ae53" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">随意发挥，并在这里叉这篇文章的源代码:</p><div class="nf ng gp gr nh ni"><a href="https://github.com/khuyentran1401/Data-science/blob/master/statistics/bayesian_example/google%20analytics.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">数据科学/Google analytics . ipynb at master khuyentran 1401/数据科学</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">收集有用的数据科学主题以及代码和文章-Data-science/Google analytics . ipynb at master…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">github.com</p></div></div><div class="nr l"><div class="qc l nt nu nv nr nw mo ni"/></div></div></a></div></div><div class="ab cl qd qe hx qf" role="separator"><span class="qg bw bk qh qi qj"/><span class="qg bw bk qh qi qj"/><span class="qg bw bk qh qi"/></div><div class="im in io ip iq"><p id="b568" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的数据科学工具。你可以在LinkedIn和T2 Twitter上与我联系。</p><p id="313b" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">星<a class="ae ny" href="https://github.com/khuyentran1401/Data-science" rel="noopener ugc nofollow" target="_blank">这个回购</a>如果你想检查我写的所有文章的代码。在Medium上关注我，了解我的最新数据科学文章，例如:</p><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/how-to-solve-a-staff-scheduling-problem-with-python-63ae50435ba4"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">如何用Python解决人员调度问题</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">尽可能减少每班的工人数量，同时为每个时间窗口分配足够的工人</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="qk l nt nu nv nr nw mo ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/observe-the-friend-paradox-in-facebook-data-using-python-314c23fd49e4"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">使用Python观察脸书数据中的朋友悖论</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">平均来说，你的朋友比你的朋友多吗？</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ql l nt nu nv nr nw mo ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/kats-a-generalizable-framework-to-analyze-time-series-data-in-python-3c8d21efe057"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">kats:Python中分析时间序列数据的通用框架</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">预测、检测变化点、异常，并获得时间序列中的关键统计数据</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="qm l nt nu nv nr nw mo ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/how-to-detect-seasonality-outliers-and-changepoints-in-your-time-series-5d0901498cff"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">如何检测时间序列中的季节性、异常值和变化点</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">只需要Kats和几行代码</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="qn l nt nu nv nr nw mo ni"/></div></div></a></div><h1 id="fd1d" class="mu kj it bd kk mv mw mx kn my mz na kq jz nb ka ku kc nc kd ky kf nd kg lc ne bi translated">参考</h1><p id="9be1" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">j . brown lee(2019年9月24日)。<em class="oa">关于概率的马尔可夫链蒙特卡罗的温和介绍</em>。机器学习精通。检索于2021年12月10日，来自<a class="ae ny" href="https://machinelearningmastery.com/markov-chain-monte-carlo-for-probability/." rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/Markov-chain-Monte-Carlo-for-probability/。</a></p><p id="2105" class="pw-post-body-paragraph le lf it lg b lh me ju lj lk mf jx lm kr mg lo lp kv mh lr ls kz mi lu lv lw im bi translated">c .戴维森-皮隆(2016年)。<em class="oa">黑客的贝叶斯方法:概率编程和贝叶斯推理</em>。艾迪森-韦斯利。</p></div></div>    
</body>
</html>