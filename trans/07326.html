<html>
<head>
<title>HOG (Histogram of Oriented Gradients): An Overview</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">HOG(梯度方向直方图):概述</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hog-histogram-of-oriented-gradients-67ecd887675f?source=collection_archive---------1-----------------------#2021-07-04">https://towardsdatascience.com/hog-histogram-of-oriented-gradients-67ecd887675f?source=collection_archive---------1-----------------------#2021-07-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ce8e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">数学，论文解释和代码从零开始为初学者</h2></div></div><div class="ab cl kf kg hu kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ij ik il im in"><h1 id="c0e9" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated"><strong class="ak">什么事？</strong></h1><p id="7173" class="pw-post-body-paragraph le lf iq lg b lh li jr lj lk ll ju lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">梯度方向直方图，也称为HOG，是一种类似Canny边缘检测器、SIFT(尺度不变和特征变换)的特征描述符。它在计算机视觉和图像处理中用于目标检测。该技术对图像的局部部分中梯度方向的出现进行计数。这种方法非常类似于边缘方向直方图和尺度不变特征变换(SIFT)。HOG描述符侧重于对象的结构或形状。它比任何边缘描述符都好，因为它使用梯度的大小和角度来计算特征。对于图像的区域，它使用梯度的大小和方向生成直方图。</p></div><div class="ab cl kf kg hu kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ij ik il im in"><h1 id="d680" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated"><strong class="ak">计算猪特征的步骤</strong></h1><ol class=""><li id="095e" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">获取要计算其HOG特征的输入图像。将图像大小调整为128x64像素(高128像素，宽64像素)。作者在论文中使用了这个维度，因为他们使用这种类型的检测的主要目的是在行人检测任务中获得更好的结果。由于这篇论文的作者在麻省理工学院行人数据库上获得了异常完美的结果，他们决定制作一个新的、更具挑战性的数据集，称为“INRIA”数据集(http://Pascal . inrialpes . fr/data/human/)，其中包含从一组不同的个人照片中裁剪出来的1805张(128x64)人类图像。</li></ol><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mj"><img src="../Images/905bfb3060ef083c7c58f56866d3228f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FgpFKC9mu2WR5qHk08b1IQ.jpeg"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图1:为获取HOG特征而导入的图像。图2:流程的导入图像灰度。图3:导入图像的调整大小和灰度图像。(图片由作者提供)</p></figure><p id="5e2a" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">2.计算图像的梯度。通过结合来自图像的幅度和角度来获得梯度。考虑3x3像素的块，首先为每个像素计算Gx和Gy。首先，使用下面的公式为每个像素值计算Gx和Gy。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e9d14325931e85f29d0b50478224b48e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/1*osjvJUze_RCPSiYcFHvMzw.gif"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">其中r、c分别指行和列。(图片由作者提供)</p></figure><p id="3645" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">在计算Gx和之后，使用下面提到的公式计算每个像素的大小和角度。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/0076e5e11e8fabf705450927fa981b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*E0YLcI7Ui1VUc2Q_R-s88w.png"/></div></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ng"><img src="../Images/2ff047dea2b24410160730819303a0cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nR-a0e4X-ujaVobsykcAfA.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图4:图像大小的可视化。图5:图像角度的可视化。(图片由作者提供)</p></figure><p id="ac39" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">3.在获得每个像素的梯度之后，梯度矩阵(幅度和角度矩阵)被分成8×8的单元以形成块。对于每个块，计算9点直方图。9点直方图开发了具有9个仓的直方图，并且每个仓具有20度的角度范围。图8表示一个9仓直方图，其中的值是在计算后分配的。这些9点直方图中的每一个都可以被绘制成直方图，其中柱输出该柱中梯度的强度。由于一个块包含64个不同的值，对于所有64个量值和梯度值，执行以下计算。由于我们使用9点直方图，因此:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/66a0a9bef1262233eaf353d1169cb7e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*T-kh04SD0ENcL4aU_aSQkQ.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">(图片由作者提供)</p></figure><p id="9561" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">每个第j个面元，面元将具有来自以下的边界:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a9947ca0e0b2623fee14460871512c41.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*Wbm4NwlZ4A_woVA2s7aPKQ.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">(图片由作者提供)</p></figure><p id="b49d" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">每个箱的中心值为:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/9abaa02b11f0748f0920b27661646d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*-DW1IlCY2GBfhVHmJ4W_dA.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">(图片由作者提供)</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nk"><img src="../Images/47ab8d8050b9f0e832caca4a59f856df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VgcYfGjg_WpbrX1S-ACE0Q.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图6:星等图像上的8×8块。图7:角度图像上的8×8块。(图片由作者提供)</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nl"><img src="../Images/568bab22edc336e8815b858eff955c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*JZwuE5wMPDMgZ8Q9pieAug.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图8:9格直方图的表示。对于一个由64个单元组成的8×8块来说，这一个直方图是唯一的。所有64个单元将分别把它们的Vj和Vj+1值加到数组的第j和第(j+1)个索引上。(图片由作者提供)</p></figure><p id="c0d6" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">4.对于块中的每个单元，我们将首先计算第j个容器，然后计算将分别提供给第j个和第(j+1)个容器的值。该值由以下公式给出:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/4d24635471ec98f6fd9e394f23aecc85.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*b_Z1xcvIoNAb1UURK2ASqQ.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">(图片由作者提供)</p></figure><p id="733a" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">5.将一个数组作为一个块的二进制数，并将Vj和Vj+1的值附加到数组中为每个像素计算的第j和第(j+1)二进制数的索引处。</p><p id="883d" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">6.上述计算后的结果矩阵将具有16x8x9的形状。</p><p id="2c59" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">7.一旦所有块的直方图计算结束，来自9点直方图矩阵的4个块被组合在一起以形成新的块(2x2)。这种杵状运动以重叠的方式进行，步幅为8个像素。对于块中的所有4个单元，我们连接每个组成单元的所有9个点直方图以形成36个特征向量。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nn"><img src="../Images/733904f7981a4b05819c515b4766079c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cf9WWyN-605RWi0ZblsdGw.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">上图显示了计算9个柱直方图的方法。(图片由作者提供)灵感来自[<a class="ae no" href="https://www.programmersought.com/article/42554276349/" rel="noopener ugc nofollow" target="_blank">https://www.programmersought.com/article/42554276349/</a></p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi np"><img src="../Images/b0438996471cbf2e7b15cdbaeef27bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*vsZgV-CFQQO5GIjN_XYgWg.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">(图片由作者提供)</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7bb7e5cab710aaf3989109714988c086.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/1*ZNLQg81ZmN6TKFyLhPqilg.gif"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">围绕图像遍历2x2网格框，以便从4个块中生成一个组合的fbi。(图片由作者提供)</p></figure><p id="c808" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">8.每个块的fb值通过L2范数归一化:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/d73a9a714493cae9b6f97724ed43dff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/1*0G_dlDgfNYGDt_6k6lcYBA.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">其中，ε是为避免零分频误差而加到fb平方上的一个小值。在规范中，取值为1e-05。(图片由作者提供)</p></figure><p id="c809" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">9.为了标准化，首先通过以下公式计算k值:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/5f4fdfca383aba3aa1679bbb5e7167ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*UymIQRnu42sDlLmdsuz-Dg.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">(图片由作者提供)</p></figure><p id="cd77" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">10.进行这种标准化是为了减少同一物体的图像之间的对比度变化的影响。从每个街区。收集36点特征向量。在水平方向有7个块，在垂直方向有15个块。因此，HOG特征的总长度将为:7 x 15 x 36 = 3780。获得所选图像的HOG特征。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/0388a33fff27088414a2ec20dbff488f.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*K67G_u5HaHrAAFIjmzVPiw.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">使用skimage库在同一图像上可视化HOG特征。(图片由作者提供)</p></figure></div><div class="ab cl kf kg hu kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ij ik il im in"><h1 id="ab44" class="km kn iq bd ko kp kq kr ks kt ku kv kw jw kx jx ky jz kz ka la kc lb kd lc ld bi translated"><strong class="ak">在Python中从头开始使用特性</strong></h1><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="dbda" class="km kn iq bd ko kp nw kr ks kt nx kv kw jw ny jx ky jz nz ka la kc oa kd lc ld bi translated">在Python中使用skimage库的HOG特征</h1><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="fefc" class="km kn iq bd ko kp nw kr ks kt nx kv kw jw ny jx ky jz nz ka la kc oa kd lc ld bi translated">代码文件</h1><p id="aa00" class="pw-post-body-paragraph le lf iq lg b lh li jr lj lk ll ju lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">链接到包含用python从头开始编写的HOG特征检测器全部代码的Colab文件:<a class="ae no" href="https://colab.research.google.com/drive/1_yDbX68uCxejK448Y0ByOACQUUZw5hWR?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1 _ ydbx 68 ucxejk 448 y0 byoacuzzw 5 hwr？usp =共享</a></p><h1 id="e796" class="km kn iq bd ko kp nw kr ks kt nx kv kw jw ny jx ky jz nz ka la kc oa kd lc ld bi translated"><strong class="ak">参考文献</strong></h1><ol class=""><li id="7871" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">人体检测的方向梯度直方图:<a class="ae no" href="http://lear.inrialpes.fr/people/triggs/pubs/Dalal-cvpr05.pdf" rel="noopener ugc nofollow" target="_blank">http://lear . inrialpes . fr/people/triggs/pubs/Dalal-cvpr 05 . pdf</a></li><li id="a47f" class="ma mb iq lg b lh ob lk oc ln od lr oe lv of lz mf mg mh mi bi translated">撇除文件:<a class="ae no" href="https://scikit-image.org/docs/dev/api/skimage.feature.html?highlight=hog#skimage.feature.hog" rel="noopener ugc nofollow" target="_blank">https://scikit-image.org/docs/dev/api/skimage.feature.html?highlight = hog # skimage . feature . hog</a></li><li id="adcc" class="ma mb iq lg b lh ob lk oc ln od lr oe lv of lz mf mg mh mi bi translated">HOG(梯度方向直方图)特征(使用MATLAB和Python的理论和实现):<a class="ae no" href="https://www.youtube.com/watch?v=QmYJCxJWdEs" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=QmYJCxJWdEs</a></li></ol><p id="3fda" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">敬请关注像这样的新的研究论文解释！</p><p id="42a3" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated">请随时联系并给出您的建议:<a class="ae no" href="https://www.linkedin.com/in/mrinal-tyagi-02a1351b1/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/mrinal-tyagi-02a1351b1/</a></p><p id="8eda" class="pw-post-body-paragraph le lf iq lg b lh mz jr lj lk na ju lm ln nb lp lq lr nc lt lu lv nd lx ly lz ij bi translated"><a class="ae no" href="https://github.com/MrinalTyagi" rel="noopener ugc nofollow" target="_blank">https://github.com/MrinalTyagi</a></p></div></div>    
</body>
</html>