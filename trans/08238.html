<html>
<head>
<title>Generate Pencil Sketch from Photo in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python从照片生成铅笔草图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generate-pencil-sketch-from-photo-in-python-7c56802d8acb?source=collection_archive---------2-----------------------#2021-07-29">https://towardsdatascience.com/generate-pencil-sketch-from-photo-in-python-7c56802d8acb?source=collection_archive---------2-----------------------#2021-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8c08" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用OpenCV的图像处理教程，带代码</h2></div><h2 id="6026" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">导入库</h2><p id="9c05" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated"><a class="ae lx" href="https://docs.opencv.org/master/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="ly"> OpenCV </em> </a>是项目需要的唯一库。<br/>我们也将使用<a class="ae lx" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> <em class="ly"> matplotlib </em> </a>库进行一些可视化，这将在后面中<a class="ae lx" href="#8970" rel="noopener ugc nofollow">讨论。</a></p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="f8b1" class="ki kj it me b gy mi mj l mk ml">import cv2<br/>import matplotlib.pyplot as plt</span></pre><h2 id="ce0d" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">阅读照片</h2><p id="eb32" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">以下命令可用于使用OpenCV读取图像。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="bc84" class="ki kj it me b gy mi mj l mk ml">img=cv2.imread("photo.jpg")</span></pre><p id="8b65" class="pw-post-body-paragraph le lf it lg b lh mm ju lj lk mn jx lm kr mo lo lp kv mp lr ls kz mq lu lv lw im bi translated">该命令读取当前文件夹中的文件<em class="ly">photo.jpg</em>，并在内存中存储为<em class="ly"> img </em>。</p><h2 id="ab62" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">使用OpenCV显示图像</h2><p id="0a29" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">使用OpenCV显示图像不是很直接。以下命令可用于显示照片。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="0179" class="ki kj it me b gy mi mj l mk ml">cv2.imshow(‘original image’,img)<br/>cv2.waitKey(0)<br/>cv2.destroyAllWindows()</span></pre><p id="e5a4" class="pw-post-body-paragraph le lf it lg b lh mm ju lj lk mn jx lm kr mo lo lp kv mp lr ls kz mq lu lv lw im bi translated">执行此命令时，下面的照片将在一个新窗口中打开，标题为“原始图像”</p><figure class="lz ma mb mc gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mr"><img src="../Images/6e99ddf1ac7c385c7ff959f191f72990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RdPUay-F2l6VIIFV"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated"><a class="ae lx" href="https://unsplash.com/@raaminka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拉明卡</a>在<a class="ae lx" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h1 id="8970" class="nd kj it bd kk ne nf ng kn nh ni nj kq jz nk ka ku kc nl kd ky kf nm kg lc nn bi translated">使用Matplotlib显示</h1><p id="950a" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">当每次必须显示图像时打开新窗口，并且为了进一步执行代码必须删除新窗口时，这不是很方便。为了避免这些麻烦，我们可以使用<em class="ly"> matplotlib </em>库的<em class="ly"> pyplot </em>模块来显示<em class="ly"> Jupyter </em>笔记本本身中的图像。</p><p id="ff5e" class="pw-post-body-paragraph le lf it lg b lh mm ju lj lk mn jx lm kr mo lo lp kv mp lr ls kz mq lu lv lw im bi translated">以下命令可用于使用matplotlib显示cv2图像。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="639f" class="ki kj it me b gy mi mj l mk ml">plt.imshow(img)<br/>plt.axis(False)<br/>plt.show()</span></pre><figure class="lz ma mb mc gt ms gh gi paragraph-image"><div class="gh gi no"><img src="../Images/204560865362420409c44c07e6303850.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*iryGFSbrPSErzg7fkKYZcg.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">Matplotlib的输出</p></figure><h2 id="ad7e" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">Matplotlib与OpenCV</h2><p id="24f4" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我们可以观察到使用matplotlib显示的图像与原始图像不一致。这是因为OpenCV使用BGR配色方案，而matplotlib使用RGB配色方案。我们可以使用以下任何一种方法将BGR图像转换成RGB。</p><h2 id="f1c5" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">将BGR转换为RGB:方法1</h2><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="bf8c" class="ki kj it me b gy mi mj l mk ml">plt.imshow(img[:,:,::-1])<br/>plt.axis(False)<br/>plt.show()</span></pre><figure class="lz ma mb mc gt ms gh gi paragraph-image"><div class="gh gi no"><img src="../Images/a0cb49d1475282e70f21171aea047ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*6zMRUJBUwnr8ZnqICytVIQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">matplotlib的输出</p></figure><h2 id="c537" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">将BGR转换为RGB:方法1</h2><p id="d1d8" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">使用<em class="ly"> OpenCV </em>的<em class="ly"> cvtColor </em>方法。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9062" class="ki kj it me b gy mi mj l mk ml">RGB_img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)<br/>plt.imshow(RGB_img)<br/>plt.axis(False)<br/>plt.show()</span></pre><figure class="lz ma mb mc gt ms gh gi paragraph-image"><div class="gh gi no"><img src="../Images/a0cb49d1475282e70f21171aea047ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*6zMRUJBUwnr8ZnqICytVIQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">matplotlib的输出</p></figure><h1 id="01cf" class="nd kj it bd kk ne nf ng kn nh ni nj kq jz nk ka ku kc nl kd ky kf nm kg lc nn bi translated">将图像转换为铅笔草图</h1><p id="6a7f" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">将照片转换为铅笔草图包括以下步骤:</p><h2 id="aa57" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">步骤1:转换为灰色图像</h2><p id="dec8" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">使用OpenCV的cvtColor函数。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="5168" class="ki kj it me b gy mi mj l mk ml">grey_img=cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span></pre><h2 id="0559" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">步骤2:反转图像</h2><p id="03f6" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">可以通过以下两种方法之一反转图像</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="dbc2" class="ki kj it me b gy mi mj l mk ml">invert_img=cv2.bitwise_not(grey_img)<br/>#invert_img=255-grey_img</span></pre><h2 id="c60f" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">第三步:模糊图像</h2><p id="43c0" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">对图像应用<em class="ly">高斯模糊</em>。函数的第二个参数是内核大小，如果应该是一对奇数。<br/>内核越大，图像越模糊，会失去其细微的特征。<br/>为了创建草图，我们只需要图像中的突出特征(对比边缘)。<br/>对于小图像，<em class="ly">内核大小</em>(3，3)，(5，5)等。就足够了，而对于较大的图像，较小的内核大小不会产生任何影响。<br/>可以通过试错法选择合适的内核大小。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="cc1e" class="ki kj it me b gy mi mj l mk ml">blur_img=cv2.GaussianBlur(invert_img, (111,111),0)</span></pre><h2 id="d08f" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">步骤4:反转模糊图像</h2><p id="d9ed" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">重复步骤2</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="d3d1" class="ki kj it me b gy mi mj l mk ml">invblur_img=cv2.bitwise_not(blur_img)<br/>#invblur_img=255-blur_img</span></pre><h2 id="9467" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">第五步:素描</h2><p id="c5fa" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">可以通过在灰度图像和反模糊图像之间执行逐位分割来获得草图。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="60c9" class="ki kj it me b gy mi mj l mk ml">sketch_img=cv2.divide(grey_img,invblur_img, scale=256.0)</span></pre><p id="6b3b" class="pw-post-body-paragraph le lf it lg b lh mm ju lj lk mn jx lm kr mo lo lp kv mp lr ls kz mq lu lv lw im bi translated">详细解释逐位划分超出了本文的范围。<br/>你可以在这里获得<a class="ae lx" href="http://Refer this page for more information on image arithmetic." rel="noopener ugc nofollow" target="_blank">更多关于图像算法的信息。</a></p><h2 id="c887" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">步骤6:保存草图</h2><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="774b" class="ki kj it me b gy mi mj l mk ml"> cv2.imwrite(‘sketch.png’, sketch_img)</span></pre><h2 id="2ba2" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">步骤7:显示草图</h2><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="e9e5" class="ki kj it me b gy mi mj l mk ml">cv2.imshow(‘sketch image’,sketch_img)<br/>cv2.waitKey(0)<br/>cv2.destroyAllWindows()</span></pre><h2 id="b116" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">原始图像与草图</h2><p id="9bcf" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我们可以把原图和草图并排展示出来进行对比。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9302" class="ki kj it me b gy mi mj l mk ml">plt.figure(figsize=(14,8))</span><span id="6d35" class="ki kj it me b gy np mj l mk ml">plt.subplot(1,2,1)<br/>plt.title('Original image', size=18)<br/>plt.imshow(RGB_img)<br/>plt.axis('off')</span><span id="52a7" class="ki kj it me b gy np mj l mk ml">plt.subplot(1,2,2)<br/>plt.title('Sketch', size=18)<br/>rgb_sketch=cv2.cvtColor(sketch_img, cv2.COLOR_BGR2RGB)<br/>plt.imshow(rgb_sketch)<br/>plt.axis('off')<br/>plt.show()</span></pre><figure class="lz ma mb mc gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nq"><img src="../Images/4280ae3931240165ec421a93ce30fc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TYTYW7i6faLRLCLXNmzZDg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">原始图像与生成的草图</p></figure><h1 id="bbd2" class="nd kj it bd kk ne nf ng kn nh ni nj kq jz nk ka ku kc nl kd ky kf nm kg lc nn bi translated">创建草图功能</h1><p id="9df5" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我们可以将所有东西放在一起创建一个草图功能:</p><figure class="lz ma mb mc gt ms"><div class="bz fp l di"><div class="nr ns l"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">来自GitHub Gist的img2sketch功能代码</p></figure><h2 id="ee8d" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">资源:</h2><p id="807f" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">本教程的代码可以从我的<a class="ae lx" href="https://github.com/hashABCD/Publications/tree/main/Medium/imagetr_opencv" rel="noopener ugc nofollow" target="_blank"> GitHub Repo </a>中获得。</p><p id="0348" class="pw-post-body-paragraph le lf it lg b lh mm ju lj lk mn jx lm kr mo lo lp kv mp lr ls kz mq lu lv lw im bi translated">如果你喜欢视频格式的内容，你可以看看这个YouTube教程。</p><figure class="lz ma mb mc gt ms"><div class="bz fp l di"><div class="nt ns l"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">如何从照片生成草图的视频教程</p></figure></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h2 id="0f07" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">成为会员</h2><p id="b48f" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我希望你喜欢这篇文章，我强烈推荐<a class="ae lx" href="https://abhijithchandradas.medium.com/membership" rel="noopener"> <strong class="lg iu">注册<em class="ly">中级会员</em> </strong> </a>来阅读更多我写的文章或成千上万其他作者写的各种主题的故事。<br/> <a class="ae lx" href="https://abhijithchandradas.medium.com/membership" rel="noopener">你的会员费直接支持我和你看的其他作家。你也可以在媒体</a>上看到所有的故事。</p><h2 id="3b94" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">相关文章:</h2><div class="ob oc gp gr od oe"><a rel="noopener follow" target="_blank" href="/create-and-read-qr-code-using-python-9fc73376a8f9"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">使用Python创建和读取二维码</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">如何使用python制作和读取二维码的简单分步指南</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">towardsdatascience.com</p></div></div><div class="on l"><div class="oo l op oq or on os mx oe"/></div></div></a></div><figure class="lz ma mb mc gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ot"><img src="../Images/63a987506737d09de4bf4583894ef948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gm1KYS7PediO_bWtGKTIwA.jpeg"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">由<a class="ae lx" href="https://unsplash.com/@raaminka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Raamin ka </a>在<a class="ae lx" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的原始照片以及计算机生成的草图</p></figure></div></div>    
</body>
</html>