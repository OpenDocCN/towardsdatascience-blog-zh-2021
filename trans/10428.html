<html>
<head>
<title>Multiple linear regression made simple</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元线性回归变得简单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/multiple-linear-regression-made-simple-d073e55e7d0c?source=collection_archive---------41-----------------------#2021-10-04">https://towardsdatascience.com/multiple-linear-regression-made-simple-d073e55e7d0c?source=collection_archive---------41-----------------------#2021-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="96c4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习如何在R中运行多元和简单的线性回归，如何解释结果以及如何验证应用条件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a0d2f3cab13bf2e4a4fbc2b695ae3e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OIqs5a-4BoGp6BGX"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@wangxin96?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">王欣</a>拍摄</p></figure><h1 id="bb5e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="4676" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi mn translated"><span class="l mo mp mq bm mr ms mt mu mv di"> R </span>记住<a class="ae ky" href="https://statsandr.com/blog/descriptive-statistics-in-r/" rel="noopener ugc nofollow" target="_blank">描述性统计</a>是统计学的一个分支，它可以描述你手头的数据。推断统计学(具有流行的<a class="ae ky" href="https://statsandr.com/blog/hypothesis-test-by-hand/" rel="noopener ugc nofollow" target="_blank">假设检验</a>和置信区间)是统计学的另一个分支，它允许进行推断，即基于<a class="ae ky" href="https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/" rel="noopener ugc nofollow" target="_blank">样本</a>得出关于总体的结论。统计学的最后一个分支是关于<strong class="lt iu">模拟两个或多个变量</strong>之间的关系。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn1" rel="noopener ugc nofollow" target="_blank"> 1 </a>描述和评估变量间联系最常用的统计工具是线性回归。</p><p id="8685" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">有两种类型的线性回归:</p><ol class=""><li id="c4d1" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated"><strong class="lt iu">简单线性回归</strong>是一种统计方法，允许评估两个<a class="ae ky" href="https://statsandr.com/blog/variable-types-and-examples/#quantitative" rel="noopener ugc nofollow" target="_blank">定量变量</a>之间的线性关系。更准确地说，它使这种关系能够被量化，并对其重要性进行评估。</li><li id="872c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">多元线性回归</strong>是简单线性回归的推广，这种方法可以评估一个响应变量(定量)和几个解释变量(定量或<a class="ae ky" href="https://statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">定性</a>)之间的线性关系。</li></ol><p id="12b4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在现实世界中，多元线性回归比简单线性回归使用得更频繁。这主要是因为:</p><ul class=""><li id="27ba" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">多元线性回归允许评估两个变量之间的关系，同时<strong class="lt iu">控制其他变量</strong>的效果(即去除效果)<strong class="lt iu">。</strong></li><li id="1da7" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">随着数据收集变得更加容易，在分析数据时可以包括和考虑更多的变量。</li></ul><p id="385f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">多元线性回归是一个如此强大的统计工具，我想把它展示出来，让每个人都理解它，甚至在必要的时候使用它。然而，如果不先介绍简单线性回归，我就不能写多元线性回归。</p><p id="d14d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">因此，在提醒了简单线性回归的原理和解释之后，我将说明如何在r中执行多元线性回归。我还将在多元线性回归的上下文中展示如何解释输出，并讨论其应用条件。然后，我将通过介绍与线性回归直接相关的更高级的主题来结束本文。</p><h1 id="d922" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">简单线性回归:提醒</h1><p id="8b6d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">简单线性回归是一种不对称程序，其中:</p><ul class=""><li id="aec0" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">其中一个变量被认为是要解释的响应或变量。也称为<strong class="lt iu">因变量</strong>，在y轴上表示</li><li id="a151" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">另一个变量是解释变量，也称为<strong class="lt iu">自变量</strong>，表示在x轴上</li></ul><p id="51ef" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">简单的线性回归允许<strong class="lt iu">评估两个变量</strong>之间存在的<em class="nq">线性</em>关系，并量化这种联系。请注意，线性是线性回归中一个强有力的假设，因为它测试并量化了两个变量是否<em class="nq">线性</em>相关。</p><p id="9315" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">线性回归之所以成为强大的统计工具，是因为它允许<strong class="lt iu">量化当解释变量/自变量增加一个单位时，响应变量/因变量的变化量</strong>。这个概念是线性回归的关键，有助于回答以下问题:</p><ul class=""><li id="492a" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">在广告上花费的金额和一定时期内的销售额有联系吗？</li><li id="d01c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">在第一份工作中，学校教育的年数在经济上有价值吗？</li><li id="a8c0" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">烟草税的增加会减少它的消费吗？</li><li id="1b1d" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">根据面积不同，一套公寓最可能的价格是多少？</li><li id="f2f0" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">一个人对刺激的反应时间取决于性别吗？</li></ul><p id="0a7f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">简单线性回归可以被看作是对<a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank">方差分析</a>和<a class="ae ky" href="https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/" rel="noopener ugc nofollow" target="_blank">学生t检验</a>的扩展。方差分析和t-检验允许根据定量变量对各组进行比较，2组用于t-检验，3组或更多组用于方差分析。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn2" rel="noopener ugc nofollow" target="_blank"> 2 </a>对于这些测试，独立变量，即构成不同组进行比较的分组变量，必须是定性变量。线性回归是一种扩展，因为除了用于比较组外，它还用于定量自变量(这是t检验和ANOVA所不能做到的)。</p><p id="dc4e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在本文中，我们感兴趣的是评估一加仑燃料行驶的距离与汽车重量之间是否存在线性关系。对于这个例子，我们使用<code class="fe nr ns nt nu b">mtcars</code>数据集(预加载在R中)。</p><p id="15e5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">该数据集包括32辆汽车的燃料消耗以及汽车设计和性能的10个方面:<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn3" rel="noopener ugc nofollow" target="_blank"> 3 </a></p><ol class=""><li id="5c65" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">mpg</code>英里/(美国)加仑(一加仑≈ 3.79升)</li><li id="4585" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">cyl</code>汽缸数量</li><li id="8cd9" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">disp</code>排水量(立方英寸)</li><li id="01a5" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">hp</code>总马力</li><li id="381f" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">drat</code>后桥传动比</li><li id="21b9" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">wt</code>重量(1000磅，1000磅≈ 453.59千克)</li><li id="f6ec" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">qsec</code> 1/4英里时间(其中1/4英里≈ 402.34米)</li><li id="5479" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">vs</code>发动机(0 = V型，1 =直型)</li><li id="1dda" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">am</code>变速器(0 =自动，1 =手动)</li><li id="8e9c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">gear</code>前进档数量</li><li id="dea3" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><code class="fe nr ns nt nu b">carb</code>化油器数量</li></ol><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="71c8" class="nz la it nu b gy oa ob l oc od">dat &lt;- mtcars</span><span id="606c" class="nz la it nu b gy oe ob l oc od">library(ggplot2)<br/>ggplot(dat, aes(x = wt, y = mpg)) +<br/>  geom_point() +<br/>  labs(<br/>    y = "Miles per gallon",<br/>    x = "Car's weight (1000 lbs)"<br/>  ) +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/7156ba12e4fa8e07cce4cf9753f33aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z6ya0vMTZGS-C2pk.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="b6a5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">上面的<a class="ae ky" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#scatter-plot" rel="noopener ugc nofollow" target="_blank">散点图</a>显示，一加仑燃料行驶的距离和一辆汽车的重量之间似乎有一种<strong class="lt iu">的负相关关系。这是有道理的，因为汽车越重，它消耗的燃料就越多，因此一加仑汽油能行驶的里程就越少。</strong></p><p id="4ee9" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这已经很好地概述了这两个变量之间的关系，但以每加仑英里数为因变量、汽车重量为自变量的简单线性回归走得更远。当重量变化一个单位(本例中为1000磅)时，它会通过<strong class="lt iu">告诉我们平均距离变化了多少英里。由于回归线，这是可能的。</strong></p><h1 id="1cb8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">原则</h1><p id="030e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">简单线性回归的原理是，<strong class="lt iu">找到与观测值</strong>尽可能接近地通过的直线(即确定其方程)<strong class="lt iu">，即成对(，易)形成的点集。</strong></p><p id="9bd9" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">第一步，有很多潜在的线。其中三个被绘制出来:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/885deb7f48b7c43b2d83b19387c11856.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mMgvG4ez6eMk_L34.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="2c71" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了找到尽可能靠近所有点的直线，我们取每个点和每条势线之间垂直距离的平方。注意，我们采用距离的平方来确保负间隙(即线下的点)不会被正间隙(即线上的点)补偿。最接近这组点的线是使这些平方距离之和最小化的线。</p><p id="f7f8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">生成的回归线在下图中以蓝色显示，灰色虚线表示点和拟合线之间的垂直距离。每个观测点和由最小二乘法确定的拟合线之间的这些垂直距离被称为线性回归模型的<strong class="lt iu">残差</strong>并表示为ϵ.</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/7f90a37e024d11bd26fb6e271c398324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qHjXDYRMWiBujuL0.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="4253" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">根据定义，没有其他直线的点和直线之间的总距离更小。这种方法称为最小二乘法，或称<strong class="lt iu"> OLS </strong>为<strong class="lt iu">普通最小二乘法</strong>。</p><h1 id="d46e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">等式</h1><p id="820e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">回归模型可以写成以下方程的形式:</p><p id="2228" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">Y=β0+β1X+ϵ</p><p id="e698" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">使用:</p><ul class=""><li id="95aa" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">因变量y</li><li id="2596" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">x独立变量</li><li id="e87c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">β0截距(x=0时Y的平均值)，有时也表示为α</li><li id="3401" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">β1斜率(X增加一个单位时Y的预期增加量)</li><li id="0a62" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">ϵ残差(平均值0的误差项，描述模型未捕捉到的y的变化，也称为噪声)</li></ul><p id="960e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">当我们确定最接近所有点的那条线时(我们说我们用一条线来拟合观察到的数据)，我们实际上是根据手头的数据<strong class="lt iu">估计未知参数</strong> β0 <strong class="lt iu">和</strong> β1。请记住，在您的几何课上，绘制直线只需要两个参数-截距和斜率。</p><p id="843c" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这些估计值(以及之前散点图中显示的蓝线)可以通过以下公式手动计算:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7a07c3e77c6f5b67956afd7d554dff16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*JG6Wy9N4MUDclFI-DTNTkA.png"/></div></figure><p id="6647" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">其中x和y分别表示x和y的样本均值。</p><p id="a7f4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">(如果你很难手工计算ˇβ0和ˇβ1，看看这个<a class="ae ky" href="https://statsandr.com/blog/a-shiny-app-for-simple-linear-regression-by-hand-and-in-r/" rel="noopener ugc nofollow" target="_blank">闪亮的应用</a>，它可以帮助你根据你的数据轻松找到这些估计值。)</p><h1 id="01d4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">系数ˇβ的解释</h1><p id="960f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">截距</strong>ˇβ0是自变量 X <strong class="lt iu">取值0 </strong>时因变量 Y <strong class="lt iu">的<strong class="lt iu">平均值。它的估计对评估两个变量之间是否存在线性关系没有兴趣。然而，如果你想知道当x=0时，Y的平均值是多少，这是有意义的。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn4" rel="noopener ugc nofollow" target="_blank"> 4 </a></strong></strong></p><p id="e349" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">另一方面，<strong class="lt iu">斜率</strong>ˇβ1对应于当 X <strong class="lt iu">变化一个单位</strong>时 Y <strong class="lt iu">的预期<strong class="lt iu">变化。它告诉我们两个重要的信息:</strong></strong></p><ol class=""><li id="df52" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">斜率的<strong class="lt iu">符号表示线</strong>的<strong class="lt iu">方向——正斜率(ˇβ1&gt;0)表示两个感兴趣的变量之间存在正关系(它们以相同的方向变化)，而负斜率(ˇβ1&lt;0)表示两个变量之间存在负关系(它们以相反的方向变化)。</strong></li><li id="fc2d" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">斜率的<strong class="lt iu">值提供变量Y的<strong class="lt iu">演变速度</strong>的信息，作为变量x的函数。斜率绝对值越大，x的每个单位的Y的预期变化越大。然而，注意，大值不一定意味着关系具有统计显著性(关于关系的<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#significance-of-the-relationship" rel="noopener ugc nofollow" target="_blank">显著性部分有更多信息)。</a></strong></li></ol><p id="7c40" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这类似于<a class="ae ky" href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/" rel="noopener ugc nofollow" target="_blank">相关系数</a>，它给出了关于两个变量之间关系的方向和强度的信息。</p><p id="255e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了在R中执行线性回归，我们使用了<code class="fe nr ns nt nu b">lm()</code>函数(代表线性模型)。该函数要求先设置因变量，再设置自变量，用波浪号(<code class="fe nr ns nt nu b">~</code>)隔开。</p><p id="f2f9" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">应用于我们的重量和汽车消耗的例子，我们有:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="080e" class="nz la it nu b gy oa ob l oc od">model &lt;- lm(mpg ~ wt, data = dat)</span></pre><p id="0292" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><code class="fe nr ns nt nu b">summary()</code>函数给出了模型的结果:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="4c8d" class="nz la it nu b gy oa ob l oc od">summary(model)</span><span id="b8ab" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt, data = dat)<br/>## <br/>## Residuals:<br/>##     Min      1Q  Median      3Q     Max <br/>## -4.5432 -2.3647 -0.1252  1.4096  6.8727 <br/>## <br/>## Coefficients:<br/>##             Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***<br/>## wt           -5.3445     0.5591  -9.559 1.29e-10 ***<br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 3.046 on 30 degrees of freedom<br/>## Multiple R-squared:  0.7528, Adjusted R-squared:  0.7446 <br/>## F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</span></pre><p id="bc00" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在实践中，我们通常在解释系数之前检查应用条件<em class="nq">(因为如果不遵守这些条件，结果可能会有偏差)。然而，在本文中，我在测试条件之前给出了解释，因为重点是展示如何解释结果，而不是找到一个有效的模型。</em></p><p id="5576" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">结果可总结如下(参见表格<code class="fe nr ns nt nu b">Coefficients</code>中的<code class="fe nr ns nt nu b">Estimate</code>栏):</p><ul class=""><li id="f2c4" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">截距ˇβ0 = 37.29表示，假设汽车重量为0磅，我们可以预计平均油耗为37.29英里/加仑。这种解释是为了说明的目的，但作为一个汽车重量0磅是不可能的，这种解释没有任何意义。因此，在实践中，我们不会解释这种情况下的截距。参见<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#another-interpretation-of-the-intercept" rel="noopener ugc nofollow" target="_blank">部分</a>中自变量以平均值为中心时截距的另一种解释。</li><li id="44ae" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">斜率ˇβ1 =-5.34表明:</li><li id="151f" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">重量和一辆汽车用一加仑油可以行驶的距离之间有一个<strong class="lt iu">负关系</strong>(鉴于之前散点图中各点的负趋势，这是意料之中的)。</li><li id="8a98" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">但更重要的是，斜率为-5.34意味着，重量增加一个单位(即增加1000磅)，每加仑的英里数平均减少5.34个单位。换句话说，<strong class="lt iu">每增加1000磅，英里/加仑数平均减少5.34 </strong>。</li></ul><h1 id="ff93" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">截距的另一种解释</h1><p id="b1a3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">截距的另一个有用的解释是当自变量以均值为中心时。在这种情况下，截距被解释为X值等于X平均值的个体的Y平均值。</p><p id="a951" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">让我们在实践中看到它。我们首先将<code class="fe nr ns nt nu b">wt</code>变量置于平均值附近，然后使用这个新变量重新运行一个简单的线性模型:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="6537" class="nz la it nu b gy oa ob l oc od">dat_centered &lt;- dat</span><span id="fa09" class="nz la it nu b gy oe ob l oc od">dat_centered$wt_centered &lt;- dat$wt - mean(dat$wt)</span><span id="d2b5" class="nz la it nu b gy oe ob l oc od">mod_centered &lt;- lm(mpg ~ wt_centered,<br/>  data = dat_centered<br/>)</span><span id="c7c4" class="nz la it nu b gy oe ob l oc od">summary(mod_centered)</span><span id="f129" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt_centered, data = dat_centered)<br/>## <br/>## Residuals:<br/>##     Min      1Q  Median      3Q     Max <br/>## -4.5432 -2.3647 -0.1252  1.4096  6.8727 <br/>## <br/>## Coefficients:<br/>##             Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept)  20.0906     0.5384  37.313  &lt; 2e-16 ***<br/>## wt_centered  -5.3445     0.5591  -9.559 1.29e-10 ***<br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 3.046 on 30 degrees of freedom<br/>## Multiple R-squared:  0.7528, Adjusted R-squared:  0.7446 <br/>## F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</span></pre><p id="94ce" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">根据结果，我们看到:</p><ul class=""><li id="e65b" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">斜率没有改变，解释与没有居中的情况相同(这是有意义的，因为回归线只是简单地向右或向左移动)。</li><li id="b4ac" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">更重要的是，截距现在是ˇβ0 = 20.09，因此我们可以预计，一辆平均重量的汽车平均油耗为20.09英里/加仑(平均重量为3.22，即3220磅)。</li></ul><p id="1b19" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这种居中特别有趣:</p><ul class=""><li id="d489" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">当连续自变量的<strong class="lt iu">没有</strong>有意义的值为0时(这种情况下，重量为0磅的汽车没有意义)，或者</li><li id="5412" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">解释截距的时候很重要。</li></ul><p id="25dc" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，不一定要仅围绕平均值进行居中。自变量也可以集中在数据范围内的某个值上。只要值有意义并且在数据范围内，居中的确切值并不重要(不建议将其居中在数据范围之外的值上，因为我们不确定该范围之外的两个变量之间的关系类型)。对于我们的例子，我们可能会发现选择最低值或最高值的权重是最佳选择。因此，由我们来决定解释截距最有意义的权重。</p><h1 id="ee4d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">关系的重要性</h1><p id="d5dd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如前所述，斜率的<strong class="lt iu">值本身并不能</strong>使<strong class="lt iu">评估线性关系</strong>的显著性成为可能。换句话说，不同于0的斜率不一定意味着它与0有<em class="nq">显著</em>不同，因此不意味着总体中的两个变量之间有<strong class="lt iu">显著</strong>关系。10°的斜率可能不显著，2°的斜率可能显著。</p><p id="de4a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">该关系的显著性还取决于斜率的可变性，斜率通过其标准误差来衡量，通常记为se(ˇβ1)。</p><p id="1a98" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了评估线性关系的重要性，我们不用过多的细节，将斜率除以其标准误差。该比率是测试统计值，遵循具有N2个自由度的学生分布:<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn5" rel="noopener ugc nofollow" target="_blank"> 5 </a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/edc839622b491554ac57f85b271bcde6.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*1db2eaR-pAYpz81upX2tkQ.png"/></div></figure><p id="9233" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">对于双边检验，无效假设和替代假设是:<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn6" rel="noopener ugc nofollow" target="_blank"> 6 </a></p><ul class=""><li id="3566" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">H0:β1=0(两个变量之间没有(线性)关系)</li><li id="df4e" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">H1:β1≠0(两个变量之间存在(线性)关系)</li></ul><p id="07dc" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">粗略地说，如果该比率的绝对值大于2，则斜率明显不同于0，因此两个变量之间的关系很重要(在这种情况下，它是正还是负取决于估计值的符号ˇβ1)。</p><p id="0eaa" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">标准误和测试统计显示在表格<code class="fe nr ns nt nu b">Coefficients</code>的<code class="fe nr ns nt nu b">Std. Error</code>和<code class="fe nr ns nt nu b">t value</code>栏中。</p><p id="81b5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">幸运的是，R给出了一个更精确和更简单的方法来评估关系的重要性。该信息在<code class="fe nr ns nt nu b">Coefficients</code>表的<code class="fe nr ns nt nu b">Pr(&gt;|t|)</code>栏中提供。这是测试的<a class="ae ky" href="https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/#a-note-on-p-value-and-significance-level-alpha" rel="noopener ugc nofollow" target="_blank"><em class="nq">p</em>-值</a>。对于任何统计检验，如果<em class="nq">p</em>-值大于或等于显著性水平(通常α=0.05)，我们不拒绝零假设，如果<em class="nq">p</em>-值低于显著性水平，我们拒绝零假设。如果我们不拒绝零假设，我们不拒绝两个变量之间没有关系的假设(因为我们不拒绝斜率为0的假设)。相反，如果我们拒绝没有关系的零假设，我们可以得出结论，这两个变量之间存在显著的线性关系。</p><p id="2510" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在我们的示例中，<em class="nq">p</em>-value = 1.29 e-10&lt;0.05，因此我们在显著性水平α=5%拒绝零假设。因此，我们得出结论，汽车重量和油耗之间有着<strong class="lt iu">显著的关系</strong>。</p><p id="1341" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="nq">提示:</em>为了确保我只解释有意义的参数，我倾向于首先根据<em class="nq"> p </em>值检查参数的意义，然后相应地解释估计值。为了完整起见，请注意测试也是在截距上执行的。<em class="nq">p</em>-值小于0.05，我们还得出截距明显不同于0的结论。</p><h1 id="a01c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关性并不意味着因果关系</h1><p id="9511" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">请注意，两个变量之间的显著关系并不一定意味着一个变量对另一个变量有影响，或者这两个变量之间有因果关系！</p><p id="d9c0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">X和Y之间的显著关系可能出现在几种情况下:</p><ul class=""><li id="5d4a" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">x导致Y</li><li id="a1e3" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">y导致X</li><li id="a1d6" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">第三个变量导致X和Y</li><li id="b001" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">这三个原因的结合</li></ul><p id="e368" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">单靠一个统计模型无法建立两个变量之间的因果联系。证明两个变量之间的因果关系更加复杂，除其他外，还需要特定的实验设计、结果随时间的可重复性以及各种样本。这就是为什么你会经常读到“<a class="ae ky" href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/#correlation-does-not-imply-causation" rel="noopener ugc nofollow" target="_blank">相关性并不意味着因果关系</a>”和线性回归遵循同样的原则。</p><h1 id="006d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">申请条件</h1><p id="1817" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">线性回归不能用于所有情况。除了要求因变量必须是连续的定量变量外，简单线性回归还要求数据满足以下条件:</p><ol class=""><li id="f735" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated"><strong class="lt iu">线性:</strong>两个变量之间的关系应该是线性的(至少大致如此)。因此，在进行简单的线性回归之前，总是需要用散点图来表示数据。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn7" rel="noopener ugc nofollow" target="_blank"> 7 </a></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/f6aeed145c0a6563bf1fb0728d911399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ocRWpHQU0gd0_4uB.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><ol class=""><li id="0a10" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated"><strong class="lt iu">独立性:</strong>观察必须是独立的。通常是抽样计划和实验设计提供了这种情况的信息。如果数据来自不同的个人或实验单位，通常是独立的。另一方面，如果在不同时期测量相同的个体，数据很可能不是独立的。</li><li id="a34e" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">残差的正态性:</strong>对于大样本量，无论误差是否遵循<a class="ae ky" href="https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/" rel="noopener ugc nofollow" target="_blank">正态分布</a>(中心极限定理的一个结果，详见<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#ref-ernst2017regression" rel="noopener ugc nofollow" target="_blank">恩斯特和艾伯斯</a> ( <a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#ref-ernst2017regression" rel="noopener ugc nofollow" target="_blank"> 2017 </a>))置信区间和对系数的检验都(近似)有效！对于小样本量，残差应遵循正态分布。这种情况可以通过视觉测试(通过<a class="ae ky" href="https://statsandr.com/blog/descriptive-statistics-in-r/#qq-plot" rel="noopener ugc nofollow" target="_blank"> QQ图</a>和/或<a class="ae ky" href="https://statsandr.com/blog/descriptive-statistics-in-r/#histogram" rel="noopener ugc nofollow" target="_blank">直方图</a>)，或者更正式地测试(例如通过<a class="ae ky" href="https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/#normality-test" rel="noopener ugc nofollow" target="_blank">夏皮罗-维尔克测试</a>)。</li><li id="5db8" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">残差的同方差:</strong>误差的方差应该是常数。当残差的离差随着预测值(拟合值)的增加而增加时，则缺少同方差。这种情况可以通过视觉测试(通过标绘标准化残差与拟合值)或更正式地测试(通过Breusch-Pagan测试)。</li><li id="7d80" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">没有影响点:</strong>如果数据包含<a class="ae ky" href="https://statsandr.com/blog/outliers-detection-in-r/" rel="noopener ugc nofollow" target="_blank">异常值</a>，识别它们是至关重要的，这样它们<strong class="lt iu">就不会</strong>、<strong class="lt iu">自己影响</strong>回归的结果。请注意，例如，如果点在回归线的直线上，异常值本身<em class="nq">不是问题</em>，因为它不会影响回归线。如果它对估计值(尤其是回归线的斜率)有实质性的影响，那么它就成为线性回归中的一个问题。这可以通过识别异常值并比较有和没有潜在异常值的结果来解决(两种方法的结果是否相同？)</li></ol><p id="5deb" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="nq">提示:</em>我记得前4个条件，感谢首字母缩略词“LINE”，表示线性、独立性、正态性和方差相等。</p><p id="bbd0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">如果不满足任何条件，测试和结论可能是错误的，因此最好避免使用和解释模型。如果是这种情况，通常可以通过变换(例如，对数变换、平方或平方根、Box-Cox变换等)来满足条件。)的数据。如果没有帮助，可以考虑删除一些变量或添加其他变量，甚至考虑非线性模型。</p><p id="7259" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请记住，在实践中，在根据模型得出任何结论之前，应验证<strong class="lt iu">应用条件。我在这里避免测试我们的数据的条件，因为它将在多元线性回归的上下文中详细讨论(参见本<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#conditions-of-application-1" rel="noopener ugc nofollow" target="_blank">部分</a>)。</strong></p><h1 id="5cf5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">形象化</h1><p id="1af4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你是博客的常客，你可能知道我喜欢画(简单而有效)<a class="ae ky" href="https://statsandr.com/tags/visualization/" rel="noopener ugc nofollow" target="_blank">可视化</a>来说明我的统计分析。线性回归也不例外。</p><p id="5447" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">有许多方法可以可视化这两个感兴趣的变量之间的关系，但我目前发现的最简单的方法是通过同名包中的<code class="fe nr ns nt nu b">visreg()</code>函数:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="8de5" class="nz la it nu b gy oa ob l oc od">library(visreg)<br/>visreg(model)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/3558c5b825aaef6ab65af197d7badca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Rlll2l1rxz4ip7LJ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="8363" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我喜欢这种简单的方法——只有一行代码。</p><p id="4e39" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">但是，其他元素也可以显示在回归图上(例如回归方程和R^2).这可以通过<code class="fe nr ns nt nu b">{ggpubr}</code>包中的<code class="fe nr ns nt nu b">stat_regline_equation()</code>和<code class="fe nr ns nt nu b">stat_cor()</code>功能轻松完成:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="7bc9" class="nz la it nu b gy oa ob l oc od"># load necessary libraries<br/>library(ggpubr)</span><span id="8285" class="nz la it nu b gy oe ob l oc od"># create plot with regression line, regression equation and R^2<br/>ggplot(dat, aes(x = wt, y = mpg)) +<br/>  geom_smooth(method = "lm") +<br/>  geom_point() +<br/>  stat_regline_equation(label.x = 3, label.y = 32) + # for regression equation<br/>  stat_cor(aes(label = ..rr.label..), label.x = 3, label.y = 30) + # for R^2<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/bbec3229ccafbe974350415a4a276a45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F4x3_T6oS31THVeZ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><h1 id="d3b5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">多元线性回归</h1><p id="f355" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在，您已经理解了简单线性回归背后的原理，并且知道了如何解释结果，是时候讨论多元线性回归了。</p><p id="c7af" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们还从多元线性回归的基本原理开始，然后展示如何解释结果，如何测试应用的条件，并以更高级的主题结束。</p><h1 id="40d0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">原则</h1><p id="a356" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">多元线性回归是简单线性回归的推广，在某种意义上，这种方法可以通过其参数中的线性函数将一个变量与几个变量<strong class="lt iu">联系起来。</strong></p><p id="118a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">多元线性回归用于评估两个变量<strong class="lt iu">之间的关系，同时考虑其他变量</strong>的影响。通过考虑其他变量的影响，我们抵消了这些其他变量的影响，以便<strong class="lt iu">隔离</strong>并测量两个感兴趣变量之间的关系。这一点是与简单线性回归的主要区别。</p><p id="835d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了说明如何在R中执行多元线性回归，我们使用与简单线性回归(<code class="fe nr ns nt nu b">mtcars</code>)相同的数据集。下面是一个简短的预览:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="6e22" class="nz la it nu b gy oa ob l oc od">head(dat)</span><span id="181d" class="nz la it nu b gy oe ob l oc od">##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb<br/>## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4<br/>## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4<br/>## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1<br/>## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1<br/>## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2<br/>## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span></pre><p id="691b" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们已经看到，一辆汽车用一加仑油可以行驶的距离与其重量之间存在显著的负线性关系(ˇβ1 =-5.34，p值&lt; 0.001).</p><p id="a623" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">However, one may wonder whether there are not in reality other factors that could explain a car’s fuel consumption.</p><p id="ad74" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">To explore this, we can visualize the relationship between a car’s fuel consumption ( 【T1】 ) together with its weight ( 【T2】 ), horsepower ( 【T3】 ) and displacement ( 【T4】 ) (engine displacement is the combined swept (or displaced) volume of air resulting from the up-and-down movement of pistons in the cylinders, usually the higher the more powerful the car):</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="0d96" class="nz la it nu b gy oa ob l oc od">ggplot(dat) +<br/>  aes(x = wt, y = mpg, colour = hp, size = disp) +<br/>  geom_point() +<br/>  scale_color_gradient() +<br/>  labs(<br/>    y = "Miles per gallon",<br/>    x = "Weight (1000 lbs)",<br/>    color = "Horsepower",<br/>    size = "Displacement"<br/>  ) +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/fc6f39137ba7e6d442d4aaa4e500a4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WcvG0NXMnn1ZJFyR.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Plot by author</p></figure><p id="c1a7" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">It seems that, in addition to the negative relationship between miles per gallon and weight, there is also:</p><ul class=""><li id="5919" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">a negative relationship between miles/gallon and horsepower (lighter points, indicating more horsepower, tend to be more present in low levels of miles per gallon)</li><li id="faeb" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">a negative relationship between miles/gallon and displacement (bigger points, indicating larger values of displacement, tend to be more present in low levels of miles per gallon).</li></ul><p id="db20" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">Therefore, we would like to evaluate the relation between the fuel consumption and the weight, but this time by adding information on the horsepower and displacement. By adding this additional information, we are able to <strong class="lt iu">仅捕获英里/加仑与重量</strong>之间的直接关系(马力和排量产生的间接影响被抵消)。</p><p id="4776" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这就是多元线性回归的全部意义！事实上，在多元线性回归中，因变量和解释变量之间的估计关系是一种<strong class="lt iu">调整的</strong>关系，即不受其他解释变量的线性影响。</p><p id="0ea0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">让我们通过在线性回归模型中增加马力和排量来说明调整的概念:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="8566" class="nz la it nu b gy oa ob l oc od">model2 &lt;- lm(mpg ~ wt + hp + disp,<br/>  data = dat<br/>)</span><span id="3f44" class="nz la it nu b gy oe ob l oc od">summary(model2)</span><span id="1d47" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt + hp + disp, data = dat)<br/>## <br/>## Residuals:<br/>##    Min     1Q Median     3Q    Max <br/>## -3.891 -1.640 -0.172  1.061  5.861 <br/>## <br/>## Coefficients:<br/>##              Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept) 37.105505   2.110815  17.579  &lt; 2e-16 ***<br/>## wt          -3.800891   1.066191  -3.565  0.00133 ** <br/>## hp          -0.031157   0.011436  -2.724  0.01097 *  <br/>## disp        -0.000937   0.010350  -0.091  0.92851    <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 2.639 on 28 degrees of freedom<br/>## Multiple R-squared:  0.8268, Adjusted R-squared:  0.8083 <br/>## F-statistic: 44.57 on 3 and 28 DF,  p-value: 8.65e-11</span></pre><p id="f30e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们可以看到，现在，英里/加仑与重量之间的关系在斜率方面变弱了(现在β1= -3.8，而只考虑重量时β1= -5.34)。</p><p id="0613" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">重量对油耗的影响根据马力和排量的影响进行调整。这是在考虑了马力和排量的影响后，英里/加仑和重量之间的剩余影响。在本<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#interpretations-of-coefficients-widehatbeta-1" rel="noopener ugc nofollow" target="_blank">章节</a>中有更详细的解释。</p><h1 id="77a4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">等式</h1><p id="d1ab" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">多重线性回归模型由以下等式定义</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9e4f71ee64b22dac8cdddebb1ad1aaeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*hyTOgecBaDVIJxEbOYKf-Q.png"/></div></figure><p id="1846" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">它类似于简单线性回归方程，除了有多个独立变量(X1，X2，…，Xp)。</p><p id="04e6" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">通过最小二乘法对参数β0，…，βp的估计基于与简单线性回归相同的原理，但是应用于pp维度。因此，问题不再是找到最佳线(最靠近成对点(yi，xi)的线)，而是找到最靠近坐标点(yi，xi1，…，xip)的pp维平面。这是通过<strong class="lt iu"> <em class="nq">最小化</em>平面</strong>上的点的偏差的平方和来实现的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/f1cdc22048163dc715e579848c8026ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/0*mYeoOGEbFpoUkLhM.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:Thaddeussegura</p></figure><h1 id="21a3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">系数ˇβ的解释</h1><p id="c5b5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最小二乘法导致系数的调整估计。术语“调整”是指在考虑了其他独立变量对因变量以及预测变量的线性影响后的<strong class="lt iu">。</strong></p><p id="bd06" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">换句话说，当其他解释变量(X2，…，Xp)的线性效应被移除时，系数β1对应于Y和X1之间关系的斜率，既在因变量Y的水平也在X1的水平。</p><p id="b516" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">将重量、马力和排量作为独立变量应用于我们的模型，我们得到:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="0ac6" class="nz la it nu b gy oa ob l oc od">summary(model2)</span><span id="c898" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt + hp + disp, data = dat)<br/>## <br/>## Residuals:<br/>##    Min     1Q Median     3Q    Max <br/>## -3.891 -1.640 -0.172  1.061  5.861 <br/>## <br/>## Coefficients:<br/>##              Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept) 37.105505   2.110815  17.579  &lt; 2e-16 ***<br/>## wt          -3.800891   1.066191  -3.565  0.00133 ** <br/>## hp          -0.031157   0.011436  -2.724  0.01097 *  <br/>## disp        -0.000937   0.010350  -0.091  0.92851    <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 2.639 on 28 degrees of freedom<br/>## Multiple R-squared:  0.8268, Adjusted R-squared:  0.8083 <br/>## F-statistic: 44.57 on 3 and 28 DF,  p-value: 8.65e-11</span></pre><p id="2371" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">表<code class="fe nr ns nt nu b">Coefficients</code>给出了每个参数的估计值(列<code class="fe nr ns nt nu b">Estimate</code>)，以及参数无效值的p值(列<code class="fe nr ns nt nu b">Pr(&gt;|t|)</code>)。</p><p id="00b4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">假设与简单线性回归相同，即:</p><ul class=""><li id="b7ee" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">H0:βj=0</li><li id="b153" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">H1:βj≠0</li></ul><p id="2c9c" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">βj=0的检验相当于检验假设:在所有其他条件相同的情况下，因变量是否与所研究的自变量相关联，也就是说，处于其他自变量的恒定水平。</p><p id="dfc0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">换句话说:</p><ul class=""><li id="e8d1" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">β1=0的测试对应于测试假设:在马力和排量不变的情况下，油耗与汽车重量有关吗</li><li id="7de9" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">β2=0的测试对应于测试假设:在重量和排量不变的情况下，油耗与马力相关吗</li><li id="648f" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">β3=0的测试对应于测试假设:在重量和排量不变的情况下，燃油消耗是否与排量相关</li><li id="7bb3" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">(为了完整起见:β0=0的测试对应于测试假设:当重量、马力和排量等于0时，英里/加仑是否不同于0)</li></ul><p id="3373" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在实践中，我们通常在解释系数之前检查应用条件<em class="nq">(因为如果不遵守这些条件，结果可能会有偏差)。然而，在本文中，我在测试条件之前给出了解释，因为重点是展示如何解释结果，而不是找到一个有效的模型。</em></p><p id="42f8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">基于我们模型的输出，我们得出结论:</p><ul class=""><li id="49bd" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">在英里/加仑和重量之间有一个显著的负相关关系，<strong class="lt iu">在其他条件相同的情况下</strong>。因此，重量每增加一个单位(即增加1000磅)，在马力和排量保持不变的情况下，平均每加仑行驶英里数减少3.8英里(p值= 0.001)。</li><li id="2ee5" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">在其他条件相同的情况下，英里/加仑和马力之间存在显著的负相关关系。因此，在重量和排量不变的情况下，每增加一个单位的马力，一加仑汽油行驶的距离平均减少0.03英里(p值= 0.011)。</li><li id="4dc2" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">当重量和马力保持不变时，我们不拒绝英里/加仑和排量之间没有关系的假设(因为p值= 0.929 &gt; 0.05)。</li><li id="e963" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">(为了完整性，但只有当它有意义时才应该被解释:对于重量、马力和排量= 0，我们可以预计一辆汽车平均油耗为37.11英里/加仑(p值&lt; 0.001). See a more useful interpretation of the intercept when the independent variables are centered in this <a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#another-interpretation-of-the-intercept" rel="noopener ugc nofollow" target="_blank">部分</a>)。)</li></ul><p id="2d9f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这就是如何解释定量自变量。<strong class="lt iu">解释定性独立变量</strong>略有不同，因为在其他条件相同的情况下，它量化了某一水平相对于参考水平的影响。因此，它根据因变量比较不同的组(由分类变量的不同水平形成)(这就是为什么线性回归可以被视为t检验和ANOVA的扩展)。</p><p id="9c0f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了说明，我们根据重量(<code class="fe nr ns nt nu b">wt</code>)和发动机的形状(<code class="fe nr ns nt nu b">vs</code>)来模拟燃料消耗(<code class="fe nr ns nt nu b">mpg</code>)。变量<code class="fe nr ns nt nu b">vs</code>有两级:V型<a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/#change-reference-level" rel="noopener ugc nofollow" target="_blank">参考级</a>和直列发动机。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn7" rel="noopener ugc nofollow" target="_blank"> 7 </a></p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="fab3" class="nz la it nu b gy oa ob l oc od">## Recoding dat$vs<br/>library(forcats)<br/>dat$vs &lt;- as.character(dat$vs)<br/>dat$vs &lt;- fct_recode(dat$vs,<br/>  "V-shaped" = "0",<br/>  "Straight" = "1"<br/>)</span><span id="5bf8" class="nz la it nu b gy oe ob l oc od">model3 &lt;- lm(mpg ~ wt + vs,<br/>  data = dat<br/>)</span><span id="d150" class="nz la it nu b gy oe ob l oc od">summary(model3)</span><span id="9526" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt + vs, data = dat)<br/>## <br/>## Residuals:<br/>##     Min      1Q  Median      3Q     Max <br/>## -3.7071 -2.4415 -0.3129  1.4319  6.0156 <br/>## <br/>## Coefficients:<br/>##             Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept)  33.0042     2.3554  14.012 1.92e-14 ***<br/>## wt           -4.4428     0.6134  -7.243 5.63e-08 ***<br/>## vsStraight    3.1544     1.1907   2.649   0.0129 *  <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 2.78 on 29 degrees of freedom<br/>## Multiple R-squared:  0.801,  Adjusted R-squared:  0.7873 <br/>## F-statistic: 58.36 on 2 and 29 DF,  p-value: 6.818e-11</span></pre><p id="ec1a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">基于我们模型的输出，我们得出结论:</p><ul class=""><li id="e7c0" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">对于V型发动机，重量增加一个单位(即增加1000磅)，平均每加仑行驶里程数减少4.44英里(p值= 0.013)。</li><li id="baae" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">(为了完整性，但只有当它有意义时才应该解释:对于重量= 0和V形发动机，我们可以预计汽车的平均油耗为33英里/加仑(p值&lt; 0.001). See a more useful interpretation of the intercept when the independent variables are centered in this <a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#another-interpretation-of-the-intercept" rel="noopener ugc nofollow" target="_blank">部分</a>)。)</li><li id="7e61" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">申请条件</li></ul><h1 id="2aea" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">对于简单线性回归，多元线性回归需要一些应用条件，以使模型可用，结果可解释。简单线性回归的条件也适用于多元线性回归，即:</h1><p id="5226" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">因变量和自变量之间关系的线性</strong><a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn8" rel="noopener ugc nofollow" target="_blank">8</a></p><ol class=""><li id="3953" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated"><strong class="lt iu">观察值的独立性</strong></li><li id="4aca" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">残差的正态性</strong></li><li id="bb02" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">残差的同方差</strong></li><li id="1a43" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">无影响点</strong> ( <a class="ae ky" href="https://statsandr.com/blog/outliers-detection-in-r/" rel="noopener ugc nofollow" target="_blank">异常值</a>)</li><li id="7f0c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">但是多元线性回归还有一个条件:</li></ol><p id="75bd" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><strong class="lt iu">无多重共线性:</strong>当自变量之间存在强线性<a class="ae ky" href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a><strong class="lt iu">相关性时，出现多重共线性，条件是模型中的其他变量。检查它是很重要的，因为当变量改变时，它可能导致估计参数的不精确或不稳定。可以通过研究每对独立变量之间的相关性来评估，或者更好的是，通过计算方差膨胀因子(VIF)来评估。相对于解释变量严格独立的情况，VIF衡量估计回归系数的方差增加了多少。高VIF值是多重共线性的标志(根据域的不同，阈值通常为5或10)。减少VIF最简单的方法是去除一些相关的独立变量，或者最终将数据标准化。</strong></p><ol class=""><li id="43e5" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">你会经常看到这些条件通过运行<code class="fe nr ns nt nu b">plot(model, which = 1:6)</code>得到验证，完全正确。然而，我最近从<code class="fe nr ns nt nu b">{performance}</code>包中发现了<code class="fe nr ns nt nu b">check_model()</code>函数，它同时测试所有这些条件(老实说，以一种更优雅的方式)。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn9" rel="noopener ugc nofollow" target="_blank"> 9 </a></li></ol><p id="1413" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">应用在我们的<code class="fe nr ns nt nu b">model2</code>上，以英里/加仑为因变量，重量、马力和排量为自变量，我们得到:</p><p id="29af" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">作者的情节</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="e3dd" class="nz la it nu b gy oa ob l oc od"># install.packages("performance")<br/># install.packages("see")<br/>library(performance)</span><span id="553e" class="nz la it nu b gy oe ob l oc od">check_model(model2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/5882ba0b6f80256694466de9ebe15808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EkEuSdJ8g_f8li3Z.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">除了同时测试所有条件之外，它还提供了关于如何解释不同诊断图以及您应该期待什么的见解(参见每个图的副标题):</p></figure><p id="39b2" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">方差的同质性(右上图)受到重视</p><ul class=""><li id="a452" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">多重共线性(左中图)不是问题(对于VIF，我倾向于使用阈值10，并且它们都低于10) <a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn11" rel="noopener ugc nofollow" target="_blank"> 11 </a></li><li id="d615" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">没有有影响的点(右中图)</li><li id="7176" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">由于3个点偏离参考线，残差的正态性(两个底部图)也不完美，但对我来说似乎仍然可以接受。在任何情况下，给定参数<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn12" rel="noopener ugc nofollow" target="_blank"> 12 </a>的数量，并且给定与正态分布的小偏差，观察值的数量足够大，因此无论误差是否遵循正态分布，对系数的测试都(近似)有效</li><li id="9656" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">线性(左上图)并不完美，所以让我们分别检查每个独立变量:</li><li id="8d8c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">作者的情节</li></ul><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="5180" class="nz la it nu b gy oa ob l oc od"># weight<br/>ggplot(dat, aes(x = wt, y = mpg)) +<br/>  geom_point() +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/01dbaf7c1ed74c6cb5a1e0c548b9ac53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HaQjTC2eHUHY8_7C.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="cfe3" class="nz la it nu b gy oa ob l oc od"># horsepower<br/>ggplot(dat, aes(x = hp, y = mpg)) +<br/>  geom_point() +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/dd5a146ad6390d8297b2d48a8cfec546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l7XIyq1beQ9p9FxI.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="077f" class="nz la it nu b gy oa ob l oc od"># displacement<br/>ggplot(dat, aes(x = disp, y = mpg)) +<br/>  geom_point() +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/5d1cc4b453c270fedd72fb49cd58a256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LUsjmK13rMqaZjG8.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">似乎英里/加仑和马力之间的关系不是线性的，这可能是该模型的轻微线性缺陷的主要组成部分。为了提高线性度，可以移除变量或应用变换(例如对数和/或平方)。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn13" rel="noopener ugc nofollow" target="_blank"> 13 </a>如果这不能解决线性问题，可以考虑其他类型的模型。</p></figure><p id="ee40" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了简单和说明的目的，我们假设本文的其余部分是线性的。</p><p id="746a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">当满足应用条件时，我们通常说模型有效。但并不是所有有效的型号都是<em class="nq">好的</em>型号。下一节讨论模型选择。</p><p id="9cfe" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">如何选择好的线性模型？</p><h1 id="c8e1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">满足应用条件的模型是最低要求，但您可能会找到几个满足此标准的模型。因此，有人可能会问<strong class="lt iu">如何在所有有效的不同模型</strong>中做出选择？</h1><p id="3119" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">选择一个好的线性模型的三个最常用的工具是根据:</p><p id="a8da" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">与模型相关联的p值，</p><ol class=""><li id="8c67" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">决定系数R^2和</li><li id="dbd3" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">阿凯克信息标准</li><li id="50b6" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">这些方法将在接下来的章节中详细介绍。注意，前两个适用于简单和多元线性回归，而第三个仅适用于多元线性回归。</li></ol><p id="c562" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">与模型关联的p值</p><h1 id="27b2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在解释模型的估计值之前，最好先检查与模型相关的p值。该p值指示该模型是否比仅具有截距的模型<strong class="lt iu">更好。</strong></h1><p id="1507" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">测试的假设(称为f检验)是:</p><p id="ac86" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">H0:β1=β2=⋯=βp=0</p><ul class=""><li id="4711" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">H1:H1:至少有一个系数β≠0</li><li id="8bdd" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">该p值可在<code class="fe nr ns nt nu b">summary()</code>输出的底部找到:</li></ul><p id="a8b7" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">p值= 8.65e-11。零假设被拒绝，因此我们得出结论，我们的模型比只有截距的模型更好，因为至少有一个系数β明显不同于0。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="7f7d" class="nz la it nu b gy oa ob l oc od">summary(model2)</span><span id="d045" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt + hp + disp, data = dat)<br/>## <br/>## Residuals:<br/>##    Min     1Q Median     3Q    Max <br/>## -3.891 -1.640 -0.172  1.061  5.861 <br/>## <br/>## Coefficients:<br/>##              Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept) 37.105505   2.110815  17.579  &lt; 2e-16 ***<br/>## wt          -3.800891   1.066191  -3.565  0.00133 ** <br/>## hp          -0.031157   0.011436  -2.724  0.01097 *  <br/>## disp        -0.000937   0.010350  -0.091  0.92851    <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 2.639 on 28 degrees of freedom<br/>## Multiple R-squared:  0.8268, Adjusted R-squared:  0.8083 <br/>## F-statistic: 44.57 on 3 and 28 DF,  p-value: 8.65e-11</span></pre><p id="ac8e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">如果其中一个模型的p值&gt; 0.05，这意味着您选择的变量没有一个有助于解释因变量。换句话说，你应该完全忘记这个模型，因为它不会比简单地取因变量的平均值更好。</p><p id="28fb" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">决定系数R^2</p><h1 id="99ae" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">决定系数R^2是模型的<strong class="lt iu">拟合优度的度量。它衡量模型解释的总可变性的比例，或模型与数据的拟合程度。</strong></h1><p id="d610" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">R^2在0和1之间变化:</p><p id="3a84" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">R^2=0:这个模型解释不了什么</p><ul class=""><li id="cdc1" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">R^2=1:模型解释了一切</li><li id="528b" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">0 <r the="" model="" explains="" part="" of="" variability=""/></li><li id="0f31" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">the higher the R^2, the better the model explains the dependent variable. As a rule of thumb, a R^2&gt; 0.7表示模型<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn13" rel="noopener ugc nofollow" target="_blank"> 13 </a>的良好拟合</li><li id="18d5" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">注意，在简单的线性回归模型中，决定系数等于<a class="ae ky" href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/" rel="noopener ugc nofollow" target="_blank">相关系数</a>的平方:R^2=corr(X,Y)^2.</li></ul><p id="424a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">将英里/加仑作为因变量，重量、马力和排量作为自变量，应用于我们的<code class="fe nr ns nt nu b">model2</code>,我们得到:</p><p id="4a77" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">R^2显示在<code class="fe nr ns nt nu b">summary()</code>输出的底部，或者可以用<code class="fe nr ns nt nu b">summary(model2)$r.squared</code>提取。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="97c2" class="nz la it nu b gy oa ob l oc od">summary(model2)</span><span id="716b" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt + hp + disp, data = dat)<br/>## <br/>## Residuals:<br/>##    Min     1Q Median     3Q    Max <br/>## -3.891 -1.640 -0.172  1.061  5.861 <br/>## <br/>## Coefficients:<br/>##              Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept) 37.105505   2.110815  17.579  &lt; 2e-16 ***<br/>## wt          -3.800891   1.066191  -3.565  0.00133 ** <br/>## hp          -0.031157   0.011436  -2.724  0.01097 *  <br/>## disp        -0.000937   0.010350  -0.091  0.92851    <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 2.639 on 28 degrees of freedom<br/>## Multiple R-squared:  0.8268, Adjusted R-squared:  0.8083 <br/>## F-statistic: 44.57 on 3 and 28 DF,  p-value: 8.65e-11</span></pre><p id="5da3" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">该车型的R^2为0.8268，这意味着一加仑汽油行驶距离的82.68%由汽车的重量、马力和排量决定。相对较高的R^2意味着汽车的重量、马力和排量是解释一加仑燃料可以行驶的距离的良好特征。</p><p id="56b4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">注意，如果要比较自变量数量不同的模型，最好参考调整后的R^2 (=此处为0.8083)。的确，在模型中加入变量并不能使R^2降低，即使变量与因变量无关(所以在模型中加入变量时R^2会人为增加，或者至少保持不变)。因此，调整后的R^2通过惩罚额外的变量来考虑模型的复杂性(变量的数量)，因此它是拟合优度和节俭之间的折衷。</p><p id="94f3" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">吝啬</p><h1 id="f1ce" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">一个<strong class="lt iu">简约的模型(很少的变量)通常比一个复杂的模型(很多变量)更受青睐</strong>。有两种方法可以从具有许多独立变量的模型中获得一个简洁的模型:</h1><p id="6333" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以<strong class="lt iu">反复删除与因变量</strong>最不相关的自变量(即在<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#overall-effect-of-categorical-variables" rel="noopener ugc nofollow" target="_blank">方差分析表</a>中具有最高p值的那个)，直到它们都与响应变量显著相关，或者</p><ol class=""><li id="ec5f" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">我们可以根据<strong class="lt iu">赤池信息标准(AIC) </strong>选择模型。AIC表达了用尽可能少的系数拟合模型的愿望，并允许对模型进行比较。根据这个标准，最好的模型是具有最低AIC的模型。该标准基于拟合质量和其复杂性之间的折衷。我们通常从具有许多独立变量的全局模型开始，程序(称为逐步算法)<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn14" rel="noopener ugc nofollow" target="_blank"> 14 </a>自动比较模型，然后根据AIC选择最佳模型。</li><li id="a367" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">我们展示了如何在r中执行第二个选项。为了便于说明，我们从一个模型开始，该模型将数据集中的所有变量作为独立变量(不要忘记首先转换因子变量):</li></ol><p id="aa8c" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">(公式<code class="fe nr ns nt nu b">mpg ~ .</code>是将数据集中存在的所有变量视为自变量的捷径，除了已被指定为因变量的变量(此处为<code class="fe nr ns nt nu b">mpg</code>)。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="e1d3" class="nz la it nu b gy oa ob l oc od">## vs has already been transformed into factor<br/>## so only am is transformed here</span><span id="33ce" class="nz la it nu b gy oe ob l oc od">## Recoding dat$vs<br/>library(forcats)<br/>dat$am &lt;- as.character(dat$am)<br/>dat$am &lt;- fct_recode(dat$am,<br/>  "Automatic" = "0",<br/>  "Manual" = "1"<br/>)</span><span id="2d5b" class="nz la it nu b gy oe ob l oc od">model4 &lt;- lm(mpg ~ .,<br/>  data = dat<br/>)</span><span id="a217" class="nz la it nu b gy oe ob l oc od">model4 &lt;- step(model4, trace = FALSE)</span></pre><p id="4a36" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">根据这一标准选择的型号如下:</p><p id="ea72" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">使用自动程序时要小心，因为即使它是所选的最佳模型，它也是基于:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="d3bd" class="nz la it nu b gy oa ob l oc od">summary(model4)</span><span id="fa30" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt + qsec + am, data = dat)<br/>## <br/>## Residuals:<br/>##     Min      1Q  Median      3Q     Max <br/>## -3.4811 -1.5555 -0.7257  1.4110  4.6610 <br/>## <br/>## Coefficients:<br/>##             Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept)   9.6178     6.9596   1.382 0.177915    <br/>## wt           -3.9165     0.7112  -5.507 6.95e-06 ***<br/>## qsec          1.2259     0.2887   4.247 0.000216 ***<br/>## amManual      2.9358     1.4109   2.081 0.046716 *  <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 2.459 on 28 degrees of freedom<br/>## Multiple R-squared:  0.8497, Adjusted R-squared:  0.8336 <br/>## F-statistic: 52.75 on 3 and 28 DF,  p-value: 1.21e-11</span></pre><p id="9ea9" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在一个单一的标准(AIC在这种情况下)，但更重要的是；</p><ul class=""><li id="ccec" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">它基于一些数学规则，这意味着不考虑行业知识或人类专业知识。</li><li id="670c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">我相信这种模型选择的自动程序是一个很好的起点，但是我也相信最终的模型应该总是与其他模型进行检查和测试，以确保它在实践中是有意义的(应用常识)。</li></ul><p id="7216" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">最后但同样重要的是，不要忘记验证<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#conditions-of-application-1" rel="noopener ugc nofollow" target="_blank">应用条件</a>，因为逐步程序不能保证它们得到遵守。</p><p id="c8ab" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">形象化</p><h1 id="bc8b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">有许多方法可以将线性回归的结果可视化。我知道的最简单的两个是:</h1><p id="ce6f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe nr ns nt nu b">visreg()</code>它在不同的图中说明了因变量和自变量之间的关系(每个自变量一个，除非你指定了你想要说明的关系):</p><ol class=""><li id="4e6a" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">作者的情节</li></ol><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="3f78" class="nz la it nu b gy oa ob l oc od">library(visreg)<br/>visreg(model4)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/3cc5e2de6ab0b8d369aec1e70acb779c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Cd3SLq98Wej6JFEb.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/4b948a7d0301ed2cd8fc92a6e49e1a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pNPZKimfcski_kOM.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/f9e2b9dd040c934e00d987eca92c9d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2r2Y_rI_paFYtC2Z.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><code class="fe nr ns nt nu b">ggcoefstats()</code>在一张图中显示了结果:</p></figure><ol class=""><li id="0503" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">作者的情节</li></ol><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="b7ae" class="nz la it nu b gy oa ob l oc od">library(ggstatsplot)<br/>ggcoefstats(model4)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/aed53e2a8c13f536c4e30665ca6ce512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wGCzNxtsUFkbmmrm.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在该图中:</p></figure><p id="60db" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">当实线不与垂直虚线交叉时，估计值在5%显著性水平上显著不同于0(即p值&lt; 0.05)</p><ul class=""><li id="9cb5" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">furthermore, a point to the right (left) of the vertical dashed line means that there is a positive (negative) relationship between the two variables</li><li id="fed9" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">the more extreme the point, the stronger the relationship</li><li id="c8b9" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">To go further</li></ul><h1 id="8ea5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Below some more advanced topics related to linear regression. Feel free to comment at the end of the article if you believe I missed an important one.</h1><p id="a016" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Extract model’s equation</p><h1 id="0209" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">You can easily extract the equation of your linear model in LaTeX or directly in your R Markdown document thanks to the  【T1】  function from the  【T2】  package:</h1><p id="718d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">The function works for linear regression, but also for many other models such as <a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank"> ANOVA </a>、GLM、逻辑回归等)。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="7255" class="nz la it nu b gy oa ob l oc od">library(equatiomatic)<br/>extract_eq(model4, use_coefs = TRUE)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e077732c578354f31b5333201aba78b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*H7fWrVwPLeJaFEvsNB4QRw.png"/></div></figure><p id="ef4b" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">自动报告</p><h1 id="0f15" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">同名软件包中的<code class="fe nr ns nt nu b">report()</code>功能允许根据最佳实践指南自动生成模型报告:</h1><p id="3a92" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">请注意，该函数也适用于数据框架、统计测试和其他模型。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="a839" class="nz la it nu b gy oa ob l oc od">library(report)</span><span id="3088" class="nz la it nu b gy oe ob l oc od">report(model4)</span><span id="ea17" class="nz la it nu b gy oe ob l oc od">## We fitted a linear model (estimated using OLS) to predict mpg with wt, qsec and am (formula: mpg ~ wt + qsec + am). The model explains a statistically significant and substantial proportion of variance (R2 = 0.85, F(3, 28) = 52.75, p &lt; .001, adj. R2 = 0.83). The model's intercept, corresponding to wt = 0, qsec = 0 and am = Automatic, is at 9.62 (95% CI [-4.64, 23.87], t(28) = 1.38, p = 0.178). Within this model:<br/>## <br/>##   - The effect of wt is statistically significant and negative (beta = -3.92, 95% CI [-5.37, -2.46], t(28) = -5.51, p &lt; .001; Std. beta = -0.64, 95% CI [-0.87, -0.40])<br/>##   - The effect of qsec is statistically significant and positive (beta = 1.23, 95% CI [0.63, 1.82], t(28) = 4.25, p &lt; .001; Std. beta = 0.36, 95% CI [0.19, 0.54])<br/>##   - The effect of am [Manual] is statistically significant and positive (beta = 2.94, 95% CI [0.05, 5.83], t(28) = 2.08, p = 0.047; Std. beta = 0.49, 95% CI [7.59e-03, 0.97])<br/>## <br/>## Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</span></pre><p id="9173" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">预言</p><h1 id="9d57" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">线性回归也经常用于<strong class="lt iu">预测目的</strong>。可以用<code class="fe nr ns nt nu b">predict()</code>函数计算出<strong class="lt iu">新数据</strong>的置信区间和预测区间。</h1><p id="c6f5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设我们想预测一辆带手动变速器的汽车的英里/加仑数，该车重3000磅，在18秒内行驶1/4英里(<code class="fe nr ns nt nu b">qsec</code>):</p><p id="dd5d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">根据我们的模型，预计这辆车一加仑油可行驶22.87英里。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="161f" class="nz la it nu b gy oa ob l oc od"># confidence interval for new data<br/>predict(model4,<br/>  new = data.frame(wt = 3, qsec = 18, am = "Manual"),<br/>  interval = "confidence",<br/>  level = .95<br/>)</span><span id="bcee" class="nz la it nu b gy oe ob l oc od">##        fit      lwr    upr<br/>## 1 22.87005 21.09811 24.642</span><span id="14c2" class="nz la it nu b gy oe ob l oc od"># prediction interval for new data<br/>predict(model4,<br/>  new = data.frame(wt = 3, qsec = 18, am = "Manual"),<br/>  interval = "prediction",<br/>  level = .95<br/>)</span><span id="9fac" class="nz la it nu b gy oe ob l oc od">##        fit      lwr      upr<br/>## 1 22.87005 17.53074 28.20937</span></pre><p id="0e7e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">置信区间和预测区间的区别在于:</p><p id="9875" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">一个<strong class="lt iu">置信区间</strong>给出了一个新观察值的Y的<strong class="lt iu">平均值</strong>的预测值，而</p><ul class=""><li id="ea1b" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">一个<strong class="lt iu">预测</strong>区间给出了一个<strong class="lt iu">个体</strong> Y对于一个新观察的预测值。</li><li id="6cbb" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">预测区间比置信区间宽，以说明由于预测个体反应而产生的<strong class="lt iu">额外不确定性，而不是给定x值的平均值</strong></li></ul><p id="2891" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">线性假设检验</p><h1 id="8b98" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">线性假设检验可以推广第<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#p-value-associated-to-the-model" rel="noopener ugc nofollow" target="_blank">节</a>中提到的f检验，同时提供系数比较检验或系数线性组合相等检验的可能性。</h1><p id="d9b3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">例如，要测试线性约束:</p><p id="48f1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">H0:β1=β2=0</p><ul class=""><li id="662f" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated">H1:H1:不是H0</li><li id="2bcc" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">我们使用<code class="fe nr ns nt nu b">{car}</code>包的<code class="fe nr ns nt nu b">linearHypothesis()</code>函数如下:</li></ul><p id="aed8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们拒绝零假设，我们得出结论，β1和β2中至少有一个不同于0 (p值= 1.55e-09)。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="21c3" class="nz la it nu b gy oa ob l oc od">library(car)<br/>linearHypothesis(model4, c("wt = 0", "qsec = 0"))</span><span id="c4ed" class="nz la it nu b gy oe ob l oc od">## Linear hypothesis test<br/>## <br/>## Hypothesis:<br/>## wt = 0<br/>## qsec = 0<br/>## <br/>## Model 1: restricted model<br/>## Model 2: mpg ~ wt + qsec + am<br/>## <br/>##   Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)    <br/>## 1     30 720.90                                 <br/>## 2     28 169.29  2    551.61 45.618 1.55e-09 ***<br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><p id="0435" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">分类变量的总体效应</p><h1 id="4f85" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">当自变量是k个类别的分类变量时，回归表提供k1 p值:</h1><p id="b000" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">变量<code class="fe nr ns nt nu b">vs</code>和<code class="fe nr ns nt nu b">am</code>有两个级别，因此回归输出中显示一个级别。变量<code class="fe nr ns nt nu b">cyl</code>有3个级别(4、6和8)，所以显示其中的2个。<code class="fe nr ns nt nu b">vs</code>和<code class="fe nr ns nt nu b">am</code>的总体效果在<code class="fe nr ns nt nu b">Pr(&gt;|t|)</code>栏中报告，但不包括<code class="fe nr ns nt nu b">cyl</code>的<strong class="lt iu">总体</strong>效果，因为该变量有2个以上的级别。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="3bad" class="nz la it nu b gy oa ob l oc od">model5 &lt;- lm(mpg ~ vs + am + as.factor(cyl),<br/>  data = dat<br/>)</span><span id="5176" class="nz la it nu b gy oe ob l oc od">summary(model5)</span><span id="a545" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ vs + am + as.factor(cyl), data = dat)<br/>## <br/>## Residuals:<br/>##     Min      1Q  Median      3Q     Max <br/>## -6.2821 -1.4402  0.0391  1.8845  6.2179 <br/>## <br/>## Coefficients:<br/>##                 Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept)       22.809      2.928   7.789 2.24e-08 ***<br/>## vsStraight         1.708      2.235   0.764  0.45135    <br/>## amManual           3.165      1.528   2.071  0.04805 *  <br/>## as.factor(cyl)6   -5.399      1.837  -2.938  0.00668 ** <br/>## as.factor(cyl)8   -8.161      2.892  -2.822  0.00884 ** <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 3.097 on 27 degrees of freedom<br/>## Multiple R-squared:  0.7701, Adjusted R-squared:  0.736 <br/>## F-statistic: 22.61 on 4 and 27 DF,  p-value: 2.741e-08</span></pre><p id="7c15" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了获得分类变量总体效应的p值，我们需要通过<code class="fe nr ns nt nu b">{car}</code>包中的<code class="fe nr ns nt nu b">Anova()</code>函数获得方差分析表:<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fn15" rel="noopener ugc nofollow" target="_blank"> 15 </a></p><p id="d002" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">从这张方差分析表中，我们得出结论:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="f371" class="nz la it nu b gy oa ob l oc od">library(car)<br/>Anova(model5)</span><span id="4162" class="nz la it nu b gy oe ob l oc od">## Anova Table (Type II tests)<br/>## <br/>## Response: mpg<br/>##                 Sum Sq Df F value  Pr(&gt;F)  <br/>## vs               5.601  1  0.5841 0.45135  <br/>## am              41.122  1  4.2886 0.04805 *<br/>## as.factor(cyl)  94.591  2  4.9324 0.01493 *<br/>## Residuals      258.895 27                  <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><p id="d9e4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><code class="fe nr ns nt nu b">vs</code>与<code class="fe nr ns nt nu b">mpg</code>无明显关联(p值= 0.451)</p><ul class=""><li id="c18d" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm np nh ni nj bi translated"><code class="fe nr ns nt nu b">am</code>和<code class="fe nr ns nt nu b">cyl</code>与<code class="fe nr ns nt nu b">mpg</code>显著相关(p值&lt; 0.05)</li><li id="1942" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated">互动</li></ul><h1 id="75cc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">到目前为止，我们已经讨论了没有任何交互作用的多元线性回归。如果因素A对响应的影响取决于因素B所采取的水平，则因素A和B <strong class="lt iu">之间存在<strong class="lt iu">相互作用</strong>影响。</strong></h1><p id="0fb2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在R中，可以按如下方式添加交互:</p><p id="0d03" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">从输出中我们得出结论，重量和传输之间存在相互作用(p值= 0.00102)。这意味着重量对一加仑<strong class="lt iu">行驶距离的影响取决于变速箱类型</strong>。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="c447" class="nz la it nu b gy oa ob l oc od">model6 &lt;- lm(mpg ~ wt + am + wt:am,<br/>  data = dat<br/>)</span><span id="f59a" class="nz la it nu b gy oe ob l oc od"># Or in a shorter way:<br/>model6 &lt;- lm(mpg ~ wt * am,<br/>  data = dat<br/>)</span><span id="c44e" class="nz la it nu b gy oe ob l oc od">summary(model6)</span><span id="5fc9" class="nz la it nu b gy oe ob l oc od">## <br/>## Call:<br/>## lm(formula = mpg ~ wt * am, data = dat)<br/>## <br/>## Residuals:<br/>##     Min      1Q  Median      3Q     Max <br/>## -3.6004 -1.5446 -0.5325  0.9012  6.0909 <br/>## <br/>## Coefficients:<br/>##             Estimate Std. Error t value Pr(&gt;|t|)    <br/>## (Intercept)  31.4161     3.0201  10.402 4.00e-11 ***<br/>## wt           -3.7859     0.7856  -4.819 4.55e-05 ***<br/>## amManual     14.8784     4.2640   3.489  0.00162 ** <br/>## wt:amManual  -5.2984     1.4447  -3.667  0.00102 ** <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>## Residual standard error: 2.591 on 28 degrees of freedom<br/>## Multiple R-squared:  0.833,  Adjusted R-squared:  0.8151 <br/>## F-statistic: 46.57 on 3 and 28 DF,  p-value: 5.209e-11</span></pre><p id="ce29" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">处理交互的最简单方法是可视化分类变量的每个级别的关系:</p><p id="9684" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">作者的情节</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="f140" class="nz la it nu b gy oa ob l oc od">visreg(model6, "wt", by = "am")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/10add6d557276c5243cbebb30e95dd43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xefn_xcBl-FqMqyL.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们看到，与自动变速器的汽车相比，手动变速器的汽车重量和英里/加仑之间的关系更强(斜率更陡)。</p></figure><p id="cb6c" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这是一个很好的例子，说明当研究两个变量(比如X和Y)之间的关系时，如果也有可能与X和Y都相关的其他变量的数据，将它们包括在回归中并根据这些变量有条件地分析关系<strong class="lt iu">是很重要的。</strong></p><p id="f3a8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">忽略一些应该包含在模型中的变量可能会导致错误和误导性的结论，直到关系完全颠倒(这种现象被称为<a class="ae ky" href="https://en.wikipedia.org/wiki/Simpson%27s_paradox" rel="noopener ugc nofollow" target="_blank">辛普森悖论</a>)。</p><p id="2c4d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">摘要</p><h1 id="0617" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在本文中，我们首先提醒一下<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#simple-linear-regression-reminder" rel="noopener ugc nofollow" target="_blank">简单线性回归</a>，特别是它的<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#principle" rel="noopener ugc nofollow" target="_blank">原理</a>以及如何<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#interpretations-of-coefficients-widehatbeta" rel="noopener ugc nofollow" target="_blank">解释结果</a>。</h1><p id="fdae" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这为更好地理解<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#multiple-linear-regression" rel="noopener ugc nofollow" target="_blank">多元线性回归</a>奠定了基础。在解释了其<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#principle-1" rel="noopener ugc nofollow" target="_blank">原理</a>之后，我们展示了如何<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#interpretations-of-coefficients-widehatbeta-1" rel="noopener ugc nofollow" target="_blank">解释输出</a>以及如何选择一个<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#how-to-choose-a-good-linear-model" rel="noopener ugc nofollow" target="_blank">良好的线性模型</a>。然后我们提到了几个<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#visualizations-1" rel="noopener ugc nofollow" target="_blank">可视化</a>，并以更多的<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#to-go-further" rel="noopener ugc nofollow" target="_blank">高级主题</a>结束了这篇文章。</p><p id="abe5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">感谢阅读。我希望这篇文章能帮助你更好地理解线性回归，并给你信心在r。</p><p id="f189" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p><p id="d57d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">参考</p><h1 id="a2b3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">奥斯汀，彼得C，和Ewout W Steyerberg。2015."线性回归分析中每个变量所需的受试者人数."<em class="nq">临床流行病学杂志</em>68(6):627–36。</h1><p id="ce9d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">恩斯特，安雅F，卡斯帕J艾伯斯。2017.“临床心理学研究实践中的回归假设？对常见误解的系统回顾。”PeerJ  5: e3323。</p><p id="a221" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">詹姆斯、加雷思、丹妮拉·威滕、特雷弗·哈斯蒂和罗伯特·蒂布拉尼。2013.<em class="nq">统计学习入门</em>。第112卷。斯普林格。</p><p id="98d1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">有些人将回归分析视为推断统计学的一部分。这是真的，因为一个样本是用来评估一个群体中两个或更多变量之间的联系的。我倾向于将回归与推断统计区分开来，原因很简单:( I)回归通常在更广的范围内使用(用于预测分析等),并且因为(ii)线性回归的主要目标(参见本<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#simple-linear-regression-reminder" rel="noopener ugc nofollow" target="_blank">部分</a>)不同于推断统计领域众所周知的置信区间和假设检验的目标。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref1" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></p></div><div class="ab cl ol om hx on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="im in io ip iq"><ol class=""><li id="9c81" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">形式上，ANOVA也可用于比较2组，但实际上我们倾向于将其用于3组或更多组，将t检验留给2组。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref2" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="daf6" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">关于数据集的更多信息可以通过执行<code class="fe nr ns nt nu b">?mtcars</code>找到。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref3" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="fd6a" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">请注意，当X不能等于0或在实践中没有意义时，最好避免解释截距。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref4" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="fc20" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">n是观察次数。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref5" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="c4b6" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">也接受0以外的其他值。在这种情况下，测试统计变为tn2 =ˇβa/se(ˇβ1 ),其中a为假设斜率。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref6" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="5fe2" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">请注意，可以通过两个变量的散点图或残差和拟合值的散点图来检查线性。在的<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#conditions-of-application-1" rel="noopener ugc nofollow" target="_blank">部分可以看到更多相关信息。</a><a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref7" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="84d4" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">您可以随时使用<code class="fe nr ns nt nu b">relevel()</code>功能更改参考电平。查看更多<a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/" rel="noopener ugc nofollow" target="_blank">数据操作技术</a>。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref8" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="8cd6" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">请注意，也可以对残差进行线性测试。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref9" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="c8f2" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">安装完<code class="fe nr ns nt nu b">{performance}</code>包后，您还需要手动安装<code class="fe nr ns nt nu b">{see}</code>包。如果需要更多帮助，请参见<a class="ae ky" href="https://statsandr.com/blog/an-efficient-way-to-install-and-load-r-packages/" rel="noopener ugc nofollow" target="_blank">如何安装R包</a>。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref10" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="fcd6" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">我使用阈值10是因为，如<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#ref-james2013introduction" rel="noopener ugc nofollow" target="_blank">James et al .</a>(<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#ref-james2013introduction" rel="noopener ugc nofollow" target="_blank">2013</a>)所示，介于5和10之间的值表示中度相关，而大于10的VIF值表示高度和<em class="nq">不可容忍的</em>相关。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref11" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="9fcc" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#ref-austin2015number" rel="noopener ugc nofollow" target="_blank"> Austin和Steyerberg </a> ( <a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#ref-austin2015number" rel="noopener ugc nofollow" target="_blank"> 2015 </a>)表明，在使用普通最小二乘法估计的线性回归模型中，每个变量有两个受试者往往能够准确估计回归系数。我们的数据集包含32个观察值，远远超过每个变量两个受试者的最小值。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref12" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="671a" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">如果您应用对数变换，请参见关于如何解释结果的两个指南:英文版<a class="ae ky" href="https://sites.google.com/site/curtiskephart/ta/econ113/interpreting-beta" rel="noopener ugc nofollow" target="_blank">和法文版<a class="ae ky" href="https://www.parisschoolofeconomics.eu/docs/yin-remi/interpretation-des-coefficients.pdf" rel="noopener ugc nofollow" target="_blank">分别为</a>和</a>。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref13" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="dc5e" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">请注意，高R^2并不保证您选择了最好的变量或您的模型是好的。它只是告诉我们模型与数据吻合得很好。建议在比较模型时运用常识，不要只参考R^2(特别是当R^2接近时)。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref14" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="ce20" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">主要有两种方法；向后向前。反向方法包括从包含所有可能相关的解释变量的模型开始，然后递归地去除降低模型的信息标准的变量，直到不可能降低为止。向前方法是向后方法的反向方法，从这个意义上说，我们从一个具有最低信息标准的单变量模型开始，并且在每一步都添加一个解释变量。默认情况下，R中的<code class="fe nr ns nt nu b">step()</code>函数组合了向后和向前方法。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref15" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="30c4" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">不要与<code class="fe nr ns nt nu b">anova()</code>函数混淆，因为它提供的结果取决于变量在模型中出现的顺序。<a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/#fnref16" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="9cb9" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">相关文章</li></ol><h1 id="0459" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><a class="ae ky" href="https://statsandr.com/blog/hypothesis-test-by-hand/" rel="noopener ugc nofollow" target="_blank">手工假设检验</a></h1><ul class=""><li id="8a29" class="nb nc it lt b lu lv lx ly ma os me ot mi ou mm np nh ni nj bi translated"><a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank">R中的方差分析</a></li><li id="6bbf" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated"><a class="ae ky" href="https://statsandr.com/blog/outliers-detection-in-r/" rel="noopener ugc nofollow" target="_blank">R中的离群点检测</a></li><li id="d00e" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated"><a class="ae ky" href="https://statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/" rel="noopener ugc nofollow" target="_blank">R中的Wilcoxon检验:如何在非正态假设下比较两组</a></li><li id="3fbe" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated"><a class="ae ky" href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/" rel="noopener ugc nofollow" target="_blank">R中的相关系数和相关检验</a></li><li id="7bcb" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm np nh ni nj bi translated"><em class="nq">原载于2021年10月4日https://statsandr.com</em><a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/" rel="noopener ugc nofollow" target="_blank"><em class="nq"/></a><em class="nq">。</em></li></ul></div><div class="ab cl ol om hx on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="im in io ip iq"><p id="2176" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi"><em class="nq">Originally published at </em><a class="ae ky" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/" rel="noopener ugc nofollow" target="_blank"><em class="nq">https://statsandr.com</em></a><em class="nq"> on October 4, 2021.</em></p></div></div>    
</body>
</html>