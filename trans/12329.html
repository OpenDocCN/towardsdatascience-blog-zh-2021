<html>
<head>
<title>Sell Out Sell In Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卖出预测中的销售</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sell-out-sell-in-forecasting-45637005d6ee?source=collection_archive---------4-----------------------#2021-12-15">https://towardsdatascience.com/sell-out-sell-in-forecasting-45637005d6ee?source=collection_archive---------4-----------------------#2021-12-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="85c6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">雀巢公司销售预测的机器学习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f10b63c048907795bd502114eb0698b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEaTOEIvL-bNAT0SZy0jjw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">售罄预测中的销售，作者提供的图像</p></figure><p id="c7ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我想从雀巢公司的角度告诉大家销售预测。我将向您展示我们方法的理念/方法。然而，如果你想使用其中的一些东西，我邀请你去<a class="ae lu" href="https://github.com/BartoszSzablowski/Sell_Out_Sell_In_Forecasting" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，在那里我们展示了这个项目的Python实现。我们的方法在<a class="ae lu" href="https://dssconf.pl/" rel="noopener ugc nofollow" target="_blank">数据科学峰会</a>上提出。这些例子是基于真实数据的，当然，它们是匿名的。我在<strong class="la iu">数据科学中心</strong>的<strong class="la iu">雀巢</strong>工作。使用Python或R，我实现机器学习模型来支持业务决策过程。<strong class="la iu">数据科学中心</strong>是雀巢公司支持欧洲、北非和中东的分析团队。</p><h1 id="7512" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">议程</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2490bc0dff8a6831cde9704f6c07d836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xNbpqcr8KlMbLvBJNzCVA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">议程，作者图片</p></figure><p id="5131" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文的议程是从<strong class="la iu">业务问题</strong>开始，然后<strong class="la iu">理解数据</strong>，转换它(<strong class="la iu">特征工程</strong>，我将从<strong class="la iu">模型培训</strong>方面结束。</p><p id="d982" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想查看评估，即在测试集上评估模型，将预测值与真实值进行比较，那么这部分在<a class="ae lu" href="https://github.com/BartoszSzablowski/Sell_Out_Sell_In_Forecasting" rel="noopener ugc nofollow" target="_blank"> GitHub </a>的解决方案中。</p><h1 id="a5dd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">商业理解</h1><h2 id="9abe" class="mn lw it bd lx mo mp dn mb mq mr dp mf lh ms mt mh ll mu mv mj lp mw mx ml my bi translated">➔在预测中出售</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7558ed277b53ccd366ab01d6912acd13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SWiJqFmVeFT6wgBNR4WkPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">商业理解，作者图片</p></figure><p id="a8b1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从商业角度来看，正确的预测很重要。如果我们的预测假设销售的产品少于实际需求，那么我们就会损失利润。另一方面，如果我们的预测被高估，那么我们实际销售的产品会减少，我们也会亏损，我们会产生产品库存成本，或者更糟，我们的产品会过期。一个糟糕的预测会给商业、生产和物流带来后果。</p><p id="fbbd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">销售可分为<strong class="la iu">卖进</strong>和<strong class="la iu">卖出</strong>。</p><p id="dfc3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">销售入</strong>是制造商(在我们的例子中是雀巢)销售给零售商的产品数量，而<strong class="la iu">销售出</strong>是零售商销售给最终客户的产品数量。作为制造商，我们对在销售<strong class="la iu">感兴趣。这里你已经可以看到<strong class="la iu">卖入</strong>和<strong class="la iu">卖出</strong>的关系。如果我们不供货，零售商就不会出售产品。此外，如果他们因为计划促销我们的产品而想卖出更多，他们也必须从我们这里订购更多的产品。</strong></p><p id="52ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">业务和生产条件要求<strong class="la iu">每周预测最长3个月</strong>或平均未来12周的销售情况。预测应该是每周的，因为生产或物流是每周计划的。</p><h1 id="7219" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">售罄预测</h1><h2 id="5c52" class="mn lw it bd lx mo mp dn mb mq mr dp mf lh ms mt mh ll mu mv mj lp mw mx ml my bi translated">➔为什么卖出去需要一个未来的卖出去</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9948b03824d49f2689c8c8ba7fd02ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5b1tDsb8qMdV537bKr1DXg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用的数据集，按作者分类的图像</p></figure><p id="c445" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经知道为什么一个企业需要一个好的预测，让我们看看数据，做一个<strong class="la iu"> E </strong>探索<strong class="la iu"> D </strong> ata <strong class="la iu"> A </strong>分析来更好地理解它。</p><p id="4847" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">销售额按周进行汇总，即<strong class="la iu"> PERIOD_TAG </strong>列，它告诉我们一年中某个特定的周。</p><p id="46cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来的两列告诉我们该观察是关于哪个<strong class="la iu">产品</strong>和哪个<strong class="la iu">客户</strong>。从我们的角度来看,<strong class="la iu">客户</strong>是<strong class="la iu">零售商</strong>。您可以在不同的商店看到我们的许多产品，因此我们需要对每个产品/零售商组合进行预测。</p><p id="422b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"/>销售可分为:<br/>-<strong class="la iu">-</strong>-实际销售，即<strong class="la iu">交付</strong>给零售商的产品数量。<br/> - <strong class="la iu">订单</strong>-实际需求，客户向订购的<strong class="la iu">产品数量。有时可能会发生我已经提到的情况，即订购产品的数量高于实际销售产品的数量。除其他因素外，这可能是由于低估了预测。</strong></p><p id="743e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个变量是<strong class="la iu">销售出去</strong>，这是从零售到最终客户的产品销售数量，我们作为一个社会在商店购买了多少。</p><p id="9b09" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来的变量与我们在商店看到的<strong class="la iu">促销</strong>有关。其中的前2个与促销的<strong class="la iu">分布</strong>有关，这是该商店中所有商店和大卖场进行促销的百分比。在促销周，不一定所有的商店都有促销活动。<br/>最后2个变量是<strong class="la iu">类型的促销</strong>，这是一个二元变量，表示一周内是否有给定类型的促销。促销的类型肯定不止两种，然而，为了本文的目的，我只分离了两种。实际上，它可能是，例如，降价，报纸上的产品信息，商店里我们产品的单独位置，等等。</p><blockquote class="mz"><p id="faed" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">随着时间推移销售产品不过是一个时间序列。为不同的零售商销售多种产品是多个时间序列。</p></blockquote><p id="2fcb" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">让我们看一个为零售商之一销售一种产品的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/36ab57db7db585a79774e2be57ccb59f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uoliQIioMkYUpVTEeHAjyQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一段时间内销售一种产品，图片由作者提供</p></figure><p id="78f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">在第一张图表</strong>上，您可以看到<strong class="la iu">订购产品的数量</strong>。正如你所看到的，时间上的移动平均线是恒定的，但在某些周它是相关的——因此显著增加。</p><p id="282e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">在下一张图表</strong>上，我们添加了<strong class="la iu">卖出</strong>，我们可以看到它落后于卖出。如果我们看到客户的产品订单数量显著增加，那么我们可以预计，在接下来的平均3-4周内，该客户的商店将比平时销售更多的产品。这种脱销与滞销的时间长短因零售商而异。</p><p id="2b47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">在第三张图表</strong>上，我们添加了<strong class="la iu">交付产品的数量</strong>，正如我之前所说，它并不总是等于订购产品的数量。但是在这里，我们可以看到其他依赖因素，例如，如果我们交付的数量没有订购的那么多，那么在接下来的几周内，我们的客户可能会重复订购。</p><p id="3c8c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">在最后一幅图</strong>中，只有<strong class="la iu">售罄</strong>和<strong class="la iu">促销数据</strong>，该售罄明显依赖于这些数据。</p><blockquote class="no np nq"><p id="af8c" class="ky kz nr la b lb lc ju ld le lf jx lg ns li lj lk nt lm ln lo nu lq lr ls lt im bi translated">因此我们的<strong class="la iu">结论</strong>在<strong class="la iu">雀巢</strong>。首先，我们应该预测<strong class="la iu">卖出</strong>，在此基础上，我们将预测<strong class="la iu">卖出</strong>。</p></blockquote><h1 id="a538" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">特征工程</h1><h2 id="5d0e" class="mn lw it bd lx mo mp dn mb mq mr dp mf lh ms mt mh ll mu mv mj lp mw mx ml my bi translated">监督学习问题的➔时间序列变换</h2><p id="ba64" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">我们的方法基于<strong class="la iu">机器学习</strong>，因此我们使用<strong class="la iu">一个模型来预测多个产品</strong>。</p><p id="c318" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://en.wikipedia.org/wiki/Andrew_Ng" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">吴恩达</strong> </a>曾经说过:</p><blockquote class="mz"><p id="4ec5" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">应用机器学习基本上是特征工程。</p></blockquote><p id="1988" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">人们常说，数据是机器学习的燃料。然而在现实中，这并不完全正确。如果我们简单地把现有的数据作为输入，在大多数情况下我们不会准备好模型。不如说数据如油。所以必须首先将原油转化为燃料。在我们的例子中，这个转换是<strong class="la iu">特征工程</strong>。</p><p id="0769" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在现有功能的基础上创建新功能，使机器学习算法能够工作。获得正确的数据会大大提高数据的质量，因为我们将原始数据转化为信息，模型会将这些信息转化为知识。那么模型可以更好地理解世界，并且将给出更高质量的预测。</p><p id="ffdb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如今，我们可以看到使用XGBoost或神经网络等模型的趋势。当然，有时我们别无选择，一个例子就是使用卷积神经网络对照片中的物体进行分类。然而，在我看来，我们应该始终做好数据分析工作，并将结论转化为数据转换。当我教分类的时候，我喜欢展示一个例子，逻辑回归对转换好的数据比XGBoost对原始数据更准确。此外，如果模型不太复杂，它也更容易理解，这对商业来说也很重要。这样我们就知道并能解释变量如何影响我们模型的预测。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="84d2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，让我们回到我们的项目。在我们可以使用机器学习算法之前，<strong class="la iu">我们的时间序列必须转化为一个监督学习问题</strong>。在时间序列中，没有<strong class="la iu"> <em class="nr"> X </em> </strong>和<strong class="la iu"> <em class="nr"> y </em> </strong>变量的概念。所以我们需要选择我们将要预测的(<strong class="la iu"> <em class="nr"> y </em> </strong>)并使用<strong class="la iu">特征工程</strong>来创建所有将用于进行预测的<strong class="la iu"><em class="nr"/></strong>变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/61fc027684f4da47fb35fda66f9fd7a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WCcehovfXqfNX5q2pZn-Ug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建y变量，图片作者</p></figure><p id="d9bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一步，我们创建我们的<strong class="la iu">目标</strong>，模型将预测的<strong class="la iu">值。这些值是客户将在一周、两周内销售的数量，等等，以及客户将在一周、两周内从我们这里订购的数量，等等。</strong></p><blockquote class="no np nq"><p id="e4ce" class="ky kz nr la b lb lc ju ld le lf jx lg ns li lj lk nt lm ln lo nu lq lr ls lt im bi translated">➞这将是我们的<strong class="la iu"> <em class="it"> y </em> </strong>。</p></blockquote><p id="1ea1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于我们分析的产品，我们看不到趋势，但情况并非总是如此。所以，<strong class="la iu">我们不需要只预测原始值</strong>，而是比如说<strong class="la iu">微分值</strong>，这是一个流行的、广泛使用的<strong class="la iu">数据变换</strong>使得<strong class="la iu">时间序列</strong>数据<strong class="la iu">平稳</strong>。我们也可以用当前值预测未来值的对数比。通过使用这些转换中的任何一种来创建新值，我们可以预测动态，并且可以预测训练数据范围之外的原始值。</p><p id="9f55" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于最后的日期，我们无法创建未来的值，因为我们不知道它们。然而，我们并不因此而消除所产生的缺失。这些失踪可能会出现在最后的日期。也就是说，对于倒数第二个日期，12月22日，我们只能提前一周进行预测，以便与真实值进行比较。然而，我们不能预测未来2周。根据预测范围，我们将测试数据的窗口移动到同一时期的预测值，例如2019年。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/716ad2516db9a913380807845ae53120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8FbI5kNuyQRduA8VTd9cw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从未来创造X个变量，图片作者</p></figure><p id="63e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">接下来，我们创建X个变量</strong>,<strong class="la iu">的特征</strong>，在此基础上模型将<strong class="la iu">拟合</strong>，然后<strong class="la iu">做出预测</strong>。这些值可以是在进行预测时已知的未来特征，在我们的例子中，这些只是<strong class="la iu">促销变量</strong>，下周、两周内的促销活动等等。</p><blockquote class="no np nq"><p id="74b8" class="ky kz nr la b lb lc ju ld le lf jx lg ns li lj lk nt lm ln lo nu lq lr ls lt im bi translated">➞它将是我们的<strong class="la iu"> <em class="it"> X </em> </strong>。</p></blockquote><p id="36a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些是我们使用的唯一的未来特征，并且在执行预测时是已知的。没有<strong class="la iu">数据泄露</strong>。这一点很重要，从业者都知道，但经常被研究人员或利益相关者忽略。<strong class="la iu">数据泄漏</strong>发生在模型可以访问实际上不可用的信息时。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e58d75cdc15dcaf82ae9901ac8422bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tV5AH7d46m5GvhGDsfF4g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">根据滞后值创建X变量，按作者排序</p></figure><p id="061f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">滞后值</strong>，一周前、两周前我们卖了多少，等等。这是一个<strong class="la iu">简单的办法</strong>把<strong class="la iu">变</strong>一个<strong class="la iu">时间序列</strong>变成<strong class="la iu">监督学习</strong>的问题。另一方面，在这里，我们没有第一行的这些特性，因为没有从中获取它们的数据。</p><blockquote class="no np nq"><p id="ba45" class="ky kz nr la b lb lc ju ld le lf jx lg ns li lj lk nt lm ln lo nu lq lr ls lt im bi translated">➞这将是我们的<strong class="la iu"> <em class="it"> X </em> </strong>。</p></blockquote><p id="b871" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们看到了一个类似的情况，缺少值，但是这些缺少的特性将第一次出现在索引中。我们需要所有的X变量，我们不打算用另一个值来代替它们。因此，我们<strong class="la iu">删除那些以这种方式</strong>创建的带有缺失值的观察值。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a3e05d9c98c02880fbe6d784c09cf943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*88zvt_h1BerunN9F7Zumaw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于滚动统计数据创建X变量，按作者分类的图像</p></figure><p id="8b7e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">添加原始滞后值后的下一步是添加滚动统计</strong>，也就是说，对于滑动窗口，我们计算各种统计。这可以是平均值、中间值、标准偏差、总和，或者至少是不同值之间的差值。最后可以是订购和交付产品之和的<strong class="la iu">差额</strong>。这样一个变量告诉模型，零售商可能会再次订购，因为它没有收到过去订购的那么多。我们计算不同宽度窗口的统计数据，例如，前2个值、前3个值的移动平均值，等等。</p><blockquote class="no np nq"><p id="c91a" class="ky kz nr la b lb lc ju ld le lf jx lg ns li lj lk nt lm ln lo nu lq lr ls lt im bi translated">➞这将是我们的<strong class="la iu"> <em class="it"> X </em> </strong>。</p></blockquote></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/58b1200175a99e1e1c59c958e8c26e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ww_aJv0cREa3TNYY3wXfMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于循环变量创建X变量，图片由作者提供</p></figure><p id="01bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在时间序列中，除了趋势之外，还可能有<strong class="la iu">季节性</strong>，这意味着一年中某个特定时期的销售额比另一个时期多。为了使用星期数作为信息，我<strong class="la iu">将星期转换成一个循环变量</strong>，它是正弦和余弦。因此，我把一个变量转换成两个变量。这里我转换的是周数，但是我们可以对其他循环变量使用相同的方法，比如一个小时或一周中的一天。以星期几为例，我将说明为什么这种转换可能比其他转换更好。</p><p id="ed68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们将星期几转换成一个<strong class="la iu">数字变量</strong>，星期一的值可能是1，而星期天的值可能是7。因此，对于这个模型来说，这两天会相隔很远，但实际上，星期天之后是星期一。</p><p id="11b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一个转换可以是<strong class="la iu"> OneHotEncoder </strong>，但是我们会创建多个二进制变量。</p><blockquote class="no np nq"><p id="8bee" class="ky kz nr la b lb lc ju ld le lf jx lg ns li lj lk nt lm ln lo nu lq lr ls lt im bi translated">➞这些变量也将是我们的<strong class="la iu"> <em class="it"> X </em> </strong>。</p></blockquote><p id="29e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些是数据转换的例子，我会说是基本的。我们会根据问题找到其他的。<strong class="la iu">我们还应该转换分类变量</strong>，它们是<strong class="la iu">客户</strong>和<strong class="la iu">产品</strong>。</p><h1 id="9349" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">链式多输出回归</h1><h2 id="ecff" class="mn lw it bd lx mo mp dn mb mq mr dp mf lh ms mt mh ll mu mv mj lp mw mx ml my bi translated">使用ML模型进行多输出回归的➔方法</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/52e44061bb6c9229a440ab7f95459843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCmINTUqjNhdmozad1cAdw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用于训练多个卖出和买进模型的方法，按作者分类的图像</p></figure><p id="1b2f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">我们已经为<strong class="la iu"> <em class="nr"> X </em> </strong>和<strong class="la iu"> y </strong>创建了一组新的特征</strong>，所以问题变成了——你如何在雀巢公司找到合适的模特？<strong class="la iu">标准的机器学习算法</strong>(我说的不是神经网络)是为了<strong class="la iu">预测单个数值</strong>而设计的，所以我们需要对每个视界有一个单独的模型。我们作为模型使用<strong class="la iu">随机森林</strong>。此外，正如我前面提到的，我们希望<strong class="la iu">先进行卖出预测，然后再进行卖出预测</strong>。提醒一下,“卖出”是零售商卖给最终客户的产品数量，这里的“卖出”是零售商从雀巢订购的产品数量。我们<strong class="la iu">首先</strong>预测下一个<strong class="la iu"> 20周卖出</strong>，<strong class="la iu">然后下一个15周卖出</strong>。<strong class="la iu">售罄</strong>的时间跨度更长，因为<strong class="la iu">售罄</strong>需要预测未来售罄值，我们从探索性分析中得知<strong class="la iu">售罄最多比</strong>售罄晚3-4周。出于理性的原因，我们选择了多一周。</p><p id="7a47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为模型学习方法，我们使用<strong class="la iu">链式多输出回归</strong>，它是模型的<strong class="la iu">线性序列。<strong class="la iu">的第一个模型</strong>是<strong class="la iu">提前1周</strong>售罄的模型，它使用我们创建的变量。下一款<strong class="la iu">车型</strong>将在<strong class="la iu">前2周</strong>售罄，其功能和预测与上一款车型相同。<strong class="la iu">一旦我们将所有销售模型拟合好，我们就在</strong>中拟合销售模型。每个模型都可以访问以前模型的相同功能和预测。此外，每个模型都有功能选择，我会写一秒钟。</strong></p><h1 id="fce9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">训练单个模型</h1><h2 id="3d9c" class="mn lw it bd lx mo mp dn mb mq mr dp mf lh ms mt mh ll mu mv mj lp mw mx ml my bi translated">➔特征选择/超参数选择</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eb24058aeb440503501ecf0018a9c209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vWqycag366KdnXHeG8-aWQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练单个模型，由作者生成图像</p></figure><p id="3ce6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">现在，我将展示基于3周前模型销售的单个模型学习</strong>。</p><p id="b331" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我从<strong class="la iu">特征选择</strong>开始。使用<strong class="la iu">特征工程</strong>我们<strong class="la iu">已经创建了许多特征</strong>，由此我们面临<strong class="la iu">维度诅咒</strong>的问题，并且碰巧特征之间<strong class="la iu">相关</strong>，因此它们中的许多携带相同的信息，由此我们可以发现模型认为一个信息更重要，即使它在现实中并非如此。另一个原因是我们不想教授模型<strong class="la iu">噪音</strong>。<strong class="la iu">因此需要使用特征选择</strong>。<strong class="la iu">我们可以将其分为在特征工程和先前模型预测过程中创建的变量</strong>。</p><p id="ff7c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将<strong class="la iu">从预测</strong>开始，这是我们在底部看到的。我们的模型使用以前模型的销售预测，但不使用所有销售预测。我们仅选择接下来的5个售罄预测，它们是售罄4W、售罄5W、售罄6W、售罄7W和售罄8W。这是由于我们的探索性数据分析和业务关系。零售商现在会从我们这里订购更多的产品，因为他们打算通过促销在3周内卖出更多的产品。</p><p id="2147" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们创建的<strong class="la iu">特性中，主要是我们没有选择那些与售完相关的特性，例如售完的滞后、售完的滚动统计、促销数据，因为这些变量已经减少到预测。在某种程度上，在这种情况下，<strong class="la iu">我们通过基于数据的预测来减少数据的多维性</strong>。</strong></p><p id="ae9e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们只使用与销售相关的特征以及循环和分类变量。然而，我们并不采取所有的，只有相关的。然而，不同窗口宽度的移动平均值可能被认为是相关的。我们不应该把它们都拿走，只拿最相关或最相关的一个。</p><p id="fcf9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我所说的，实际上<strong class="la iu">每个型号都使用不同的功能</strong>。</p><p id="ab92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经选择了特性，那么<strong class="la iu">训练</strong>本身是什么样子的呢？这个过程尽可能标准化。但是，我想简单地谈谈超参数的<strong class="la iu">选择。我们使用的数据是<strong class="la iu">时间序列</strong>，所以<strong class="la iu">观察值是相互依赖的</strong>。<strong class="la iu">分割训练/测试集时不能使用随机化</strong>，也不能使用交叉验证。在这种情况下，会有数据泄漏。因此，在每个分割中，<strong class="la iu">测试或验证指标必须高于训练指标</strong>。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/011066cf67e0e4f4d4bd2f36ebaa3894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vpvSRmHdLVz9Cuq3"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae lu" href="https://unsplash.com/@mehrad_vosoughi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Mehrad Vosoughi </a>在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="bd0d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">谢谢您们。我希望我没有让你感到厌烦，我所展示的一切都符合数据科学的艺术。从外面看起来可能很复杂，但当我们深入细节时，你可以看到它包含了机器学习中使用的许多基本方法。首先，它是有效的，我展示了如何使用机器学习来处理时间序列，我们至少不必使用蒙特卡罗树搜索(开玩笑)。此外，您还看到了我们如何将业务问题转化为机器学习解决方案。</p><p id="0f99" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi">😎</p></div></div>    
</body>
</html>