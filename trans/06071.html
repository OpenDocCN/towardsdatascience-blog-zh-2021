<html>
<head>
<title>BEAM (Batch + strEAM) your Data Pipelines on Google Dataflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在谷歌数据流上传送(批量+流)你的数据管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beam-batch-stream-your-data-pipelines-on-google-dataflow-2e3230bcdc21?source=collection_archive---------23-----------------------#2021-05-31">https://towardsdatascience.com/beam-batch-stream-your-data-pipelines-on-google-dataflow-2e3230bcdc21?source=collection_archive---------23-----------------------#2021-05-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="47f3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Apache Beam是批处理和流处理的统一编程模型</h2></div><h1 id="fe97" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">为什么需要数据管道？</h1><p id="768b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在21世纪，大多数企业依靠可扩展的平台&amp;服务或产品的数据化来保持市场竞争力。随着来自不同来源、具有不同数量、速度和种类的数据激增，企业需要新的数据战略。因此，需要数据管道将所有不同来源的数据整合到一个共同的目的地，以进行快速分析，或者在连接的应用程序和系统之间处理和传输数据。</p><p id="1bdd" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated">因此，组织开始根据其业务需求部署批处理或流式管道。</p><p id="4aa0" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi ly translated"><span class="l lz ma mb bm mc md me mf mg di"> P </span></p><p id="2429" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated"><strong class="kz ir">批量处理:</strong></p><ul class=""><li id="1628" class="mh mi iq kz b la lt ld lu lg mj lk mk lo ml ls mm mn mo mp bi translated">与有界数据集一起使用。</li><li id="ce73" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">在一段时间内收集一组数据，然后一次性处理。</li><li id="be1a" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">更关心吞吐量而不是延迟。</li><li id="368d" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">用例:寻找一家银行的忠实客户；折扣后的销售差额等。</li></ul><p id="61af" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated"><strong class="kz ir">流处理:</strong></p><ul class=""><li id="7b0b" class="mh mi iq kz b la lt ld lu lg mj lk mk lo ml ls mm mn mo mp bi translated">用于未绑定的数据集。</li><li id="7bbc" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">数据一生成就被馈送到处理引擎。</li><li id="16b3" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">更关心延迟而不是吞吐量。</li><li id="9332" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">用例:股市情绪分析；实时检测欺诈交易、物联网设备等。</li></ul><p id="3d63" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi ly translated"><span class="l lz ma mb bm mc md me mf mg di"> R </span>例如，在Spark中，rdd/data frame用于批处理，而您需要为流处理编写数据流。因此，他们需要维护两个不同的流水线以及各自的执行引擎，这不仅增加了总的维护开销，而且将它们与相关的执行引擎锁定在一起。</p><p id="25dd" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated">为了缓解这些挑战，谷歌孵化了一个数据流模型，可以应用于有界和无界数据集，然后将其SDK捐赠给Apache基金会。</p><p id="3d43" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated">从那时起，贡献者社区培育了它，因此，我们有了"<a class="ae mv" href="https://beam.apache.org/get-started/beam-overview/" rel="noopener ugc nofollow" target="_blank"> Apache Beam </a>"一个统一的编程模型，它易于使用，对流和批处理工作流进行数据并行处理，最重要的是平台独立性(可移植，支持多个运行程序)，以消除任何API锁定。</p><blockquote class="mw"><p id="bceb" class="mx my iq bd mz na nb nc nd ne nf ls dk translated"><strong class="ak"> Apache Beam </strong>是批处理&amp;流处理的统一编程模型，抽象层允许用任何语言(Java、Python、Go等)创建。)并且可以在Google Cloud Dataflow、Spark、Flink等任何执行框架上执行。</p></blockquote><h1 id="887b" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw ng jx kr jz nh ka kt kc ni kd kv kw bi translated">阿帕奇波束的体系结构；</h1><figure class="nk nl nm nn gt no gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nj"><img src="../Images/e4d7d7106d055b809c7a69f555e861f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qntZa40bnJOoIyiZx1tU_g.png"/></div></div><p class="nv nw gj gh gi nx ny bd b be z dk translated">作者的Apache Beam架构</p></figure><ul class=""><li id="c1e2" class="mh mi iq kz b la lt ld lu lg mj lk mk lo ml ls mm mn mo mp bi translated">使用您选择的编程语言SDK——Java、Python或Go——编写管道。</li><li id="f752" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">Beam / Runner API将其转换为可由执行引擎使用的语言通用标准。</li><li id="9bc4" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">Fn API提供了特定于语言的SDK工作器，这些工作器充当嵌入到管道中作为函数规范的UDF的RPC接口。</li><li id="e33d" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">选定的运行器在底层资源上执行流水线，正确选择运行器是高效执行的关键。</li></ul><h1 id="6607" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Apache射束工作流程:</h1><figure class="nk nl nm nn gt no gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nz"><img src="../Images/b132b953724217faf2892346d5d468fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LmxL-3AZppW_ErBbnZC7g.png"/></div></div><p class="nv nw gj gh gi nx ny bd b be z dk translated">作者的Apache工作流</p></figure><p id="1e3c" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated"><strong class="kz ir">:Pipeline:</strong>封装了从开始到结束的数据处理任务，包括读取I/P数据、转换和写入O/P数据。</p><p id="cebc" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated"><strong class="kz ir"> PCollection: </strong>波束流水线操作的分布式数据集。它可以是有界的，也可以是无界的。它本质上是不可变的，因此，对PCollection的任何转换都会创建一个新的PCollection。</p><p id="43b9" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated"><strong class="kz ir"> PTransform: </strong>表示应用于PCollection的数据处理操作或转换步骤。</p><p id="40d4" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated"><strong class="kz ir">I/O Sink&amp;Sources:</strong>Source和Sink APIs提供了将数据读入集合或从集合中写出的函数。</p><h1 id="6d9e" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">阿帕奇波束能力矩阵；</h1><p id="4bea" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Apache Beam的主要优势是它的可移植API层，可以跨多种执行引擎或运行程序执行。因为它为不同的赛跑者提供了在技术创新上竞争的公平场所，这些技术创新提供了更好的性能、可靠性、操作管理的简易性等。因此，Apache发布了一个能力矩阵，将不同跑步者的能力按照其相应的“什么/哪里/何时&amp;如何”问题进行分组:</p><figure class="nk nl nm nn gt no gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi oa"><img src="../Images/d70daf1de5a53eb7544f16d03fe81dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CmrvYZLvcyDJ9VzY7UINrw.png"/></div></div><p class="nv nw gj gh gi nx ny bd b be z dk translated"><strong class="bd ob">参考:</strong> <a class="ae mv" href="https://beam.apache.org/documentation/runners/capability-matrix/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ob">阿帕奇波束能力矩阵</strong> </a> <strong class="bd ob">来自Apache.org</strong></p></figure><blockquote class="oc od oe"><p id="74db" class="kx ky of kz b la lt jr lc ld lu ju lf og lv li lj oh lw lm ln oi lx lq lr ls ij bi translated">在图表中，你可以看到谷歌云数据流运行检查所有主要功能，但这不是我认为谷歌云数据流是推荐选择的唯一原因。</p></blockquote><h1 id="9702" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">那么，为什么谷歌云数据流？</h1><p id="f82c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先，谷歌对开源及其社区的承诺无与伦比。自2016年以来，谷歌已经为15，000多个开源项目做出了贡献，通过云数据流，谷歌甚至减轻了其设置、维护和扩展所需的开销，以高效执行复杂的大规模连续作业，方法是提供:</p><ul class=""><li id="d5c1" class="mh mi iq kz b la lt ld lu lg mj lk mk lo ml ls mm mn mo mp bi translated">完全托管的无服务器服务。</li><li id="8ce2" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">自动优化管道，如使用的工人数量，将数据流拆分到关键空间，并并行处理它们。</li><li id="a7f2" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">Liquid Sharding(动态工作再平衡)可根据作业管道的需求动态调整工作人员的数量。</li><li id="fc43" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">用于批处理的低价灵活资源调度(FlexRS ),保证在6小时的窗口内执行。</li><li id="9e3f" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">内置的实时人工智能功能允许构建智能解决方案，如预测分析、异常检测等。</li><li id="d56e" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated">开箱即用集成到谷歌云资源的其余部分，实现无缝连接。</li></ul><figure class="nk nl nm nn gt no gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi oj"><img src="../Images/eecc1c47e4c90b4f69330b2d3340658d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QeYQjLx4b-4sZEikCLW3vQ.png"/></div></div><p class="nv nw gj gh gi nx ny bd b be z dk translated"><strong class="bd ob">作者的Google Cloud原生数据源和数据流接收器</strong></p></figure><h1 id="59dc" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">结论</h1><p id="058f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这里，我向您概述了Apache Beam编程模型，以及为什么Google Cloud Dataflow实际上应该是它的运行者，如果您还在阅读这篇文章，我相信您对探索Apache Beam的下一个数据管道非常感兴趣，或者希望在一个统一的、独立于平台的模型中转变现有的管道。所以为什么停止，不久我将发布一个实际的场景及其实现，以便更好地理解。</p><p id="bdbd" class="pw-post-body-paragraph kx ky iq kz b la lt jr lc ld lu ju lf lg lv li lj lk lw lm ln lo lx lq lr ls ij bi translated"><strong class="kz ir">同时，这里有一些我提到的资源，你也应该浏览一下，以便更深入地理解:</strong></p><ul class=""><li id="ea6c" class="mh mi iq kz b la lt ld lu lg mj lk mk lo ml ls mm mn mo mp bi translated"><a class="ae mv" href="https://beam.apache.org/documentation/basics/" rel="noopener ugc nofollow" target="_blank">阿帕奇光束文档</a></li><li id="6255" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated"><a class="ae mv" href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43864.pdf" rel="noopener ugc nofollow" target="_blank">数据流模型</a></li><li id="16ad" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated"><a class="ae mv" href="https://beam.apache.org/documentation/runners/capability-matrix/" rel="noopener ugc nofollow" target="_blank">阿帕奇波束能力矩阵</a></li><li id="7cd7" class="mh mi iq kz b la mq ld mr lg ms lk mt lo mu ls mm mn mo mp bi translated"><a class="ae mv" href="https://cloud.google.com/dataflow/docs/guides/templates/provided-templates" rel="noopener ugc nofollow" target="_blank">数据流模板</a>:谷歌提供数据流模板，让你从加速学习开始。</li></ul></div></div>    
</body>
</html>