<html>
<head>
<title>Weather forecasting with Machine Learning, using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">天气预报与机器学习，使用Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/weather-forecasting-with-machine-learning-using-python-55e90c346647?source=collection_archive---------1-----------------------#2021-04-18">https://towardsdatascience.com/weather-forecasting-with-machine-learning-using-python-55e90c346647?source=collection_archive---------1-----------------------#2021-04-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/2108841571dd222cc666826ee4e083cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MvVCdp0-p2ugnvw96A9uPw.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">由<a class="ae jd" href="https://unsplash.com/s/photos/climate?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jd" href="https://unsplash.com/@karsten_wuerth?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">卡斯滕·沃思</a>拍摄的照片</p></figure><div class=""/><div class=""><h2 id="688d" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">简单而强大的天气预报机器学习应用</h2></div><p id="6218" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">物理学家将气候定义为一个<strong class="kx jh">【复杂系统】</strong>。虽然有很多关于它的解释，但在这个具体的例子中，我们可以认为<strong class="kx jh">【复杂】</strong>是<strong class="kx jh">【无法以分析的方式解决】</strong>。</p><p id="3363" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这可能看起来令人沮丧，但它实际上为旨在解决气候挑战的广泛的数字算法铺平了道路。随着过去几年的计算发展，机器学习算法肯定是其中的一部分。</p><p id="1a4c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我想讨论的挑战是基于使用传统机器学习算法预测平均温度:<strong class="kx jh">自回归综合移动平均模型(ARIMA) </strong>。</p><p id="0a6b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然这篇文章不想详细介绍理论背景，<strong class="kx jh">但它确实想一步一步地指导如何在Python中使用这些模型，并将其应用于现实世界的数据。</strong></p><p id="ad68" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">所以让我们从描述Python框架开始。</strong></p><h2 id="d11d" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">0.图书馆</h2><p id="0f47" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">用过的库都是最著名的数据分析，绘图，数学运算<strong class="kx jh"> (pandas，matplotlib，numpy) </strong>。还有一些是用于高级数据可视化的(比如<strong class="kx jh">叶子</strong>，还有一些是用于ARIMA模型的特定库(比如<strong class="kx jh"> statsmodels </strong>)。以下是导入的代码:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="8f4d" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">1.数据集/数据集探索</h2><p id="58f7" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">数据集是开源的，可以在这里找到<a class="ae jd" href="https://www.kaggle.com/berkeleyearth/climate-change-earth-surface-temperature-data?select=GlobalLandTemperaturesByMajorCity.csv" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="aafc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您想知道数据集中的城市，请使用这条熊猫线选择它们:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="4f3a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们想在世界地图上标出这些城市，我们需要稍微改变一下纬度和经度。为了做到这一点，让我们使用这几行代码:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="dba4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并显示城市:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="501c" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">2.预处理、高级可视化、稳定性</h2><p id="7681" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我选择隔离芝加哥，并将该城市的数据视为我的数据集。没有什么特别的原因要那么做…我就是喜欢芝加哥:)。当然，您可以使用自己的城市，并使用自己的数据集执行后续步骤。</p><blockquote class="mv"><p id="3e29" class="mw mx jg bd my mz na nb nc nd ne lq dk translated">目标是<strong class="ak"> AverageTemperature列</strong>，即该特定月份的平均温度。我们有1743年到2013年的数据。</p></blockquote><p id="523f" class="pw-post-body-paragraph kv kw jg kx b ky nf kh la lb ng kk ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">通过这条线，我们确定了<strong class="kx jh"> NaN值</strong>，并用饼图显示它们:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="d869" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于它们不是数据集的一致部分，<strong class="kx jh">我决定用以前的值来填充缺失的值。</strong>我对平均温度的不确定性做了同样的处理。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="630a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">“dt”列是标识年和月的列。对于接下来的操作，<strong class="kx jh">更方便的方法是将该列转换成datetime对象，并在两个不同的列中显式标识年份和月份</strong>。我们可以通过使用以下代码行来实现这一点:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="314c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用该数据集，可以获得如下散点图:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="946b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是读起来并不容易，所以我们应该做得更好。</p><p id="7a24" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们来描述我创建的三个超级基本函数:</p><ul class=""><li id="965d" class="nk nl jg kx b ky kz lb lc le nm li nn lm no lq np nq nr ns bi translated"><strong class="kx jh"> get_timeseries(start_year，end_year) </strong>提取两年之间的数据集部分</li><li id="9827" class="nk nl jg kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated"><strong class="kx jh"> plot_timeseries(start_year，end_year) </strong>以可读的方式绘制get_timeseries中提取的时间序列</li><li id="3000" class="nk nl jg kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated"><strong class="kx jh">plot _ from _ data</strong>(<strong class="kx jh">data，time，display_options) </strong>以可读的方式绘制时间(dt)的数据(AverageTemperature)。显示选项允许显示记号，改变颜色，设置标签…</li></ul><p id="98d9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完成后，我们可以画出这样的图:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1ada" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们使用ARIMA模型时，我们应该考虑平稳的时间序列。为了检查我们考虑的时间序列是否是平稳的，我们可以检查相关和自相关图:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8b52" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这表明时间序列不是静止的。尽管如此，如果我们对整个数据集执行<a class="ae jd" href="https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test" rel="noopener ugc nofollow" target="_blank"> AD Fuller测试</a>，它会告诉我们数据集是稳定的。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="fc8f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但这是真的，因为我们在看整个数据集。事实上，如果我们分析一个单一的十年，很明显数据集在十年时间内绝对不是静止的。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1ff0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">为了考虑这种非平稳性，将在ARIMA模型中考虑微分项。</strong></p><h2 id="7d4a" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">3.机器学习算法</h2><p id="c725" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们考虑1992年至2013年这十年，并绘制图表:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="efa2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">执行训练/测试分割:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="83b5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">绘制拆分:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2f63" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">机器学习算法是<a class="ae jd" href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> ARIMA模型。</strong> </a> <strong class="kx jh"> </strong>这些都是基于采用最大似然函数的优化程序。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="02b2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用<a class="ae jd" href="https://en.wikipedia.org/wiki/Akaike_information_criterion" rel="noopener ugc nofollow" target="_blank"> AIC </a>来考虑和评估零微分ARIMA模型。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="6e13" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">而<strong class="kx jh">一阶微分</strong>模型用这些线考虑:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2734" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用此功能突出显示总摘要，并显示(2，1，5)模型和(2，1，6)模型是最好的模型。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="d5d0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">可以看到<strong class="kx jh">的统计汇总值几乎相同</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="ce29" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样的事情也发生在统计图表之间:</p><ul class=""><li id="a9eb" class="nk nl jg kx b ky kz lb lc le nm li nn lm no lq np nq nr ns bi translated"><strong class="kx jh">模型(2，1，5) </strong></li></ul><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><ul class=""><li id="f882" class="nk nl jg kx b ky kz lb lc le nm li nn lm no lq np nq nr ns bi translated"><strong class="kx jh">模型(2，1，6) </strong></li></ul><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5f0c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尽管如此，最好使用低指数模型，以避免过度拟合并减少计算机的计算压力。为此，<strong class="kx jh">考虑了(2，1，5)模型。</strong></p><h2 id="c309" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">4.预测</h2><p id="b707" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们绘制预测操作的结果:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="d942" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们考虑具有相应不确定性(由数据集给出)和置信区间(由算法给出)的特定预测区域:</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="cdef" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">最后，让我们考虑一个可读性更强的版本的剧情:</strong></p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="2258" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">5.结论</h2><p id="1a96" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这些方法非常容易采用，因为它们不需要像深度学习方法(RNN，CNN……)那样的任何特定计算能力。</p><p id="8a7a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尽管如此，<strong class="kx jh">预测完全符合数据集本身设计的误差范围</strong>。考虑到我们只检查了月平均值，这一点很重要，同时考虑日值并进行日预测可能也很有趣。</p><p id="8ae8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="ce33" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.在<a class="ae jd" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Linkedin </strong> </a>上关注我，在那里我发布我所有的故事<br/> B .订阅我的<a class="ae jd" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="kx jh">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae jd" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="kx jh">推荐会员</strong> </a>，这样你就不会有任何“本月最大故事数”，你可以阅读我(以及数千名其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p><p id="44a7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">再见。:)</p></div></div>    
</body>
</html>