<html>
<head>
<title>How to use Python and Tableau to Analyze Digital Photo Metadata</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python和Tableau分析数码照片元数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-python-and-tableau-to-analyze-digital-photo-metadata-e4d4a744b6a4?source=collection_archive---------26-----------------------#2021-03-23">https://towardsdatascience.com/how-to-use-python-and-tableau-to-analyze-digital-photo-metadata-e4d4a744b6a4?source=collection_archive---------26-----------------------#2021-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="57bb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">本文分享了一个Python程序，它使用exifread模块读取数字图像文件中的元数据，并使用Tableau Public分析细节</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2411ec20275e4df570e04a75a3153a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OxJdlDiBMBcX9mV_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成熟的秃鹰。图片由作者提供。</p></figure><h1 id="a7ad" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><p id="92b6" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">假设你是一名专门拍摄猛禽的野生动物摄影师，比如老鹰、老鹰和猎鹰。你更喜欢捕捉飞行中的鸟的图像(BIF)，尤其是当它们捕获猎物的时候。今天，你站在密西西比河明尼苏达州一侧的河岸上，在佩平湖的下游，紧接着穿过T2奇普瓦河口的海峡，在那里流入浩瀚的密西西比河。当秃鹰在水下捕鱼时，你的超长焦镜头对准了它们。</p><p id="2476" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">现在，假设您想要分析您在过去十年中拍摄的鸟类照片。不久以前，当被摄对象用胶片拍照时，关于每张照片的信息都是以模拟的形式被记录在胶片上，记录在摄影师的头脑中，也许还被摄影师记录在纸上。相比之下，今天，专用数码相机或智能手机相机记录丰富详细的数字化图像和关于它们的各种元数据。</p><p id="660b" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">本文向您展示了如何编写一个Python程序，从数码照片文件中提取元数据。然后，它会查找每张照片拍摄日期的日出和日落时间。最后，它将数据写入CSV文件，每张照片一条记录。本文还描述了一个Tableau公共工作簿，它使用CSV文件来组织、查看和分析其中包含的照片元数据。</p><h1 id="62a8" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">数码照片元数据</h1><p id="4c80" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">当你点击数码相机或智能手机上的快门按钮时，该设备会将来自照片传感器的图像的详细数据写入数字媒体上的文件，如相机的SD卡或智能手机的内存。该文件包含在显示器上重建图像所需的数据和元数据，元数据是关于图像的数据。照片编辑软件，如Adobe Lightroom和Photoshop、Microsoft Photos或Google Photos，使用图像数据和元数据。用Python和其他语言编写的自定义程序也可以读取这些类型的数据。</p><p id="4184" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">数码照片元数据以一种标准格式存储，这种格式称为可交换图像文件格式，通常称为Exif。有关Exif结构中包含的字段列表，请参阅由CIPA相机和成像产品协会出版的<a class="ae mm" href="http://www.cipa.jp/std/documents/e/DC-008-2012_E.pdf" rel="noopener ugc nofollow" target="_blank"> Exif标准</a>的第42页。</p><p id="b849" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">存储在每个照片文件中的元数据包括与图像相关的值，如日期和时间、相机的品牌和型号以及镜头的品牌和型号。它还包括曝光信息，包括快门速度、感光度(ISO)和光圈(F档)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/ac7b42c968c16cd3eff5eaecedc1bcc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5AZEwECT1R_EK8jQ-8yYiA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">大白鹭。图片由作者提供。</p></figure><h1 id="0739" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">本文的案例</h1><p id="ff60" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">当我想象这篇文章时，我想象它将描述一个数据分析项目，它将帮助我确定一天中拍摄鸟类的最佳时间。但它变得更多了。它帮助我理解和反思我的鸟类摄影习惯、技巧和偏好。这可能会支持我拍摄更好的鸟类照片并经常拍摄的目标。</p><h1 id="63b7" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">照片</h1><p id="8345" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">为了获得1，000多张鸟类照片供该程序处理并与Tableau Public一起分析，我在Adobe Lightroom中搜索了超过30，000张照片的目录，以找到符合这些标准的图像文件:</p><ul class=""><li id="c206" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated"><strong class="ls iu">星级2/5</strong>—每次拍照后，我会将相机SD卡上的照片导入Lightroom。下一步是后处理，包括检查照片，删除那些模糊、构图不佳或其他不理想的照片，编辑其余的照片，并给每张照片打分。评级是主观的，基于我对照片的喜欢程度，从1星到5星，其中1是可接受的，5是优秀的。对于这个项目，我选择了评分为2或更高的照片。</li><li id="c757" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">RAW的图像类型</strong>——用我的DSLR或无反光镜相机，我以RAW模式拍摄所有照片，这从传感器捕捉了尽可能多的图像细节。另一种方法是将图像捕获为JPEG文件。JPEG文件是可以接受的，但就其性质而言，相机已经处理并试图优化每张照片，并将其压缩为JPEG格式。</li><li id="50df" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">鸟的关键词</strong> —在一张鸟的照片之后，我的意图是给每张饲养员的照片加上关键词“鸟”。如果时间允许，我会添加其他关键词，如物种、性别和颜色。这些关键字将帮助我以后搜索和找到鸟类图片。</li></ul><p id="73e7" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">在这个项目中，我排除了那些我认为是在离家很远的地方拍摄的照片。因为我的相机中设置的日期和时间是当地时区(在我的情况下是美国中部时间)，该时区的日期和时间值被写入每个图像文件。包含我所在时区以外的图片可能会扭曲数据分析的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/89c3bf3bd3a1b8ef6eedb8c518be5361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xXI2FWUiKCiwOHGc"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">过滤要从Lightroom导出的鸟类照片图像文件。图片由作者提供。</p></figure><h1 id="12d8" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">本项目中使用的软件</h1><p id="a709" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我为这个项目使用了下面列出的软件。</p><ul class=""><li id="51b3" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated"><strong class="ls iu"> Windows 10操作系统</strong>——我在大部分专业和个人电脑工作中使用Windows。</li><li id="3c9e" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu"> Adobe Lightroom </strong> —我的照片存储在Adobe Lightroom的云中(Creative Cloud版本)。图像JPEG (*。jpg)文件从Lightroom导出，由稍后描述的Python程序进行处理。你使用的任何照片编辑软件都可以正常工作。</li><li id="4732" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu"> Python 3.9.2编程语言</strong>—Python 3的任何最新版本都应该可以工作。</li><li id="1a98" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu"> Visual Studio社区</strong> —我用过很多版本的微软Visual Studio。社区版免费。</li><li id="75f2" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu"> Tableau Public </strong> —我在Tableau Public工作簿的两个仪表板中创建了这个项目中显示的图表。Tableau Public是流行且强大的Tableau商业智能和数据可视化工具的免费版本。公共版本在这个项目中运行良好。但是它的主要限制是只能从有限的文件类型中读取数据，并且只能将工作簿保存到Tableau公共服务器。这意味着世界上的任何人都可以查看您使用Tableau Public创建的可视化效果。</li><li id="5d6e" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu"> Windows记事本</strong> —我用记事本查看Python程序创建的CSV文件。任何文本或代码编辑器都可以。</li></ul><p id="e3ef" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls iu"> <em class="nh">关于软件和操作系统的说明:</em> </strong></p><p id="9dc1" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">Python语言应该可以在任何现代操作系统上工作，包括Mac OS、Linux和Windows。Lightroom和Tableau Public版本适用于Mac OS和Windows。虽然微软发布了一个版本的Visual Studio for Mac OS，但它不支持Python。但是几乎任何代码编辑器或集成开发环境(IDE)都可以工作。记事本是特定于Windows的，但每个操作系统都支持工具来读取文本文件，如程序创建的CSV文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bdc1dd760f5b2f5c72faaef04022dc0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-7bg5YANEUt56rZH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">沙丘鹤。图片由作者提供。</p></figure><h1 id="ad9a" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">程序中使用的Python模块</h1><p id="8a2c" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">以下是程序中使用的Python模块的列表，以及如何使用它们的描述:</p><ul class=""><li id="4e99" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated"><a class="ae mm" href="https://astral.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">星体</strong> </a> <strong class="ls iu"> </strong> —获取日期和时区的日出和日落。</li><li id="99b0" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><a class="ae mm" href="https://docs.python.org/3/library/csv.html" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">csv</strong></a><strong class="ls iu"/>—从每个图像文件的Exif数据结构中选择元数据写入CSV文件。</li><li id="88f5" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><a class="ae mm" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">日期时间</strong> </a> <strong class="ls iu"> </strong> —从日期时间值中提取日期。</li><li id="2e2d" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><a class="ae mm" href="https://pypi.org/project/ExifRead/" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">Exif Read</strong></a><strong class="ls iu"/>—从保存为JPEG格式的图像中读取Exif数据(。JPG)文件。</li><li id="54d9" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><a class="ae mm" href="https://docs.python.org/3/library/os.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu"> os </strong> </a> <strong class="ls iu"> </strong> —获取一个目录下的镜像文件的名称。</li><li id="6e63" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><a class="ae mm" href="https://pypi.org/project/pytz/" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">pytz</strong></a><strong class="ls iu"/>—将日出和日落日期时间值从协调世界时(UTC)转换为美国中部时区。这允许相对于拍摄每张照片的日期和时间来确定日出和日落的日期时间值。</li></ul><h1 id="ca8e" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">代码</h1><p id="106d" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">该程序的代码分为两个模块。控制器模块运行程序，一个名为c_photo_exif的类完成这项工作。这些模块将在以下章节中介绍和显示。</p><h1 id="9d91" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">控制器模块</h1><p id="49e7" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">用C语言编写的程序有一个main()函数作为它们的入口点。在Python中，我喜欢把入口点称为控制器。这是因为它控制着程序的整体流程。photo_exif_controller.py文件作为这个程序的入口点和控制器。</p><p id="427e" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">为了读取图像文件，控制器使用以下值调用c_photo_exif类的构造函数(__init__()):</p><ul class=""><li id="60fc" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated">包含要读取的图像文件的目录的名称。</li><li id="367a" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated">程序将为每个图像文件写入记录元数据的CSV文件的名称。</li><li id="516d" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated">离照片拍摄地最近的城市。</li><li id="0056" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated">照片拍摄地的时区。</li></ul><p id="652c" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">编写这个程序时假设输入目录中的所有照片都是在大致相同的位置拍摄的。稍后将描述克服这一限制的潜在增强。</p><h1 id="2530" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">c_photo_exif Python类</h1><p id="e19a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">文件c_photo_exif.py中的c_photo_exif Python类是程序的引擎。它执行以下任务:</p><ol class=""><li id="e4a4" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml ni mz na nb bi translated">创建一个CSV输出文件，并写入其列名。</li><li id="f118" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml ni mz na nb bi translated">遍历指定目录中的图像文件。</li><li id="3910" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml ni mz na nb bi translated">从每个文件的Exif结构中获取图像元数据。</li><li id="c478" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml ni mz na nb bi translated">获取每张照片拍摄当天的日出和日落日期时间值。</li><li id="53bc" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml ni mz na nb bi translated">将数据写入CSV文件。</li></ol><p id="eb75" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">注意:<strong class="ls iu"> <em class="nh">由于c_photo_exif类的内容大约有150行长，所以显示在下面的附录a中。</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4dc47de98e20e9a4c19fe3102fd022e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z4nQKkRImS-sQ26Z"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">CSV文件中的照片Exif数据。图片由作者提供。</p></figure><h1 id="0d1a" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">潜在的计划改进和增强</h1><h2 id="811c" class="nj kz it bd la nk nl dn le nm nn dp li lz no np lk md nq nr lm mh ns nt lo nu bi translated">潜在的改进</h2><p id="8f8d" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">与大多数概念验证(POC)程序一样，这个程序只执行满足特定需求所需的基本任务。在本例中，它从一组图像文件中读取Exif数据，获取与每张照片拍摄日期相关的日出和日落日期时间值，并将数据写入CSV文件供以后使用。以下是可对程序进行的潜在改进，以使其为生产做好准备:</p><ul class=""><li id="609f" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated">添加错误处理,这样当出现严重错误(如磁盘故障)时，程序可以正常关闭或重试。</li><li id="ebb6" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">将消息写入日志文件</strong>以捕获重要事件，如程序开始时间、结束时间、错误消息和处理的图像文件数量。</li></ul><h2 id="3ab0" class="nj kz it bd la nk nl dn le nm nn dp li lz no np lk md nq nr lm mh ns nt lo nu bi translated">潜在的改进</h2><p id="9b92" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">虽然该程序执行其预期的功能，但它可以被增强以服务于额外的用途。以下是一些想法:</p><ul class=""><li id="c7b7" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated"><strong class="ls iu">将输出数据写入关系数据库表</strong>，而不是CSV文件。根据需要，将数据写入数据库而不是CSV文件可以提供一些优势，例如性能和消除创建重复记录的可能性。</li><li id="57b1" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">从图像文件中获取附加数据</strong>。在本例中，写入输出CSV文件的所有内容都是从操作系统(文件名)、每个图像文件中的Exif数据结构以及Astral Python模块中的日出和日落数据时间值中捕获的。其他有用的数据，如关键字、评级、标题和说明，可能存在于每个图像文件中。我打算学习如何获得这些数据，并在下一篇文章中介绍它们。</li><li id="c8e3" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">将输出数据写入Tableau超文件</strong>。在这个项目中，Tabeau Pulic工作簿从CSV文件中读取图像元数据，而Tableau Creator桌面工作簿可以直接从以Tableau专有的hyperfile格式编写的文件中获取数据。</li><li id="9936" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">为上下文</strong>添加其他数据。例如，如果每个鸟类图像文件在标题或关键字字段中包含物种的名称，则可以从单独的数据存储库中获得物种的描述，并将其写入CSV文件。</li></ul><h1 id="e293" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">Tableau公共工作簿</h1><p id="ebcd" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我在这个项目的数据分析部分使用了Tableau Public。Python程序编写的CSV文件充当Tableau工作簿的数据源。使用Tableau创建工作表、视觉效果和仪表板的说明超出了本文的范围。但是这两个仪表盘被公布在Tableau公共网站上的一个名为<a class="ae mm" href="https://public.tableau.com/profile/randall.runtsch#!/vizhome/BirdPhotographyDataAnalysis/BirdPhotosOverview" rel="noopener ugc nofollow" target="_blank">鸟类摄影数据分析</a>的工作簿中。请随意下载工作簿，修改它，并将其与您的数码照片的元数据集成在一起。</p><h2 id="1535" class="nj kz it bd la nk nl dn le nm nn dp li lz no np lk md nq nr lm mh ns nt lo nu bi translated">鸟类照片概览仪表板</h2><p id="6de0" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这个仪表盘显示了我自2012年以来拍摄鸟类的相机的使用数据。它还按镜头长度、快门速度、光圈和ISO显示照片数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/e1375826c3b3d4c841f4ea92d768b0c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S9LW85zXzHjBqapW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Tableau公共照片图表。图片由作者提供。</p></figure><h2 id="3f26" class="nj kz it bd la nk nl dn le nm nn dp li lz no np lk md nq nr lm mh ns nt lo nu bi translated">按月份和小时显示的鸟类照片</h2><p id="0f2b" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这显示了相机在这些时间段拍摄的照片数量:</p><ul class=""><li id="a116" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated">一年中的月份</li><li id="8fc9" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated">一天中的某个时刻</li><li id="b2c5" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated">相对于日出的拍摄时间</li><li id="86e3" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated">相对于日落的拍摄时间</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/163cb2e3e5c54774c51e5a700c8ac9d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2RJ9Byz_IJNgBNG2"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Tableau公共照片图表。图片由作者提供。</p></figure><h1 id="cfd8" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">我学到了什么教训？</h1><p id="d0fc" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">摄影和拍摄好照片是我生活中重要的组成部分。和大多数追求一样，我希望随着时间的推移提高自己的技能和成果。以下是我从这个项目中学到的一些经验，或者直接通过观察数据，或者间接地作为催化剂来反思我多年来的鸟类摄影经历。我想提高我的技术来增加我的守门员比例和图像质量。</p><ul class=""><li id="5603" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated"><strong class="ls iu">在相机中设置当地时间</strong> —因为当我离家旅行时，我已经将相机中的日期和时间重置为当地时间，所以我不能总是可靠地确定特定照片是何时拍摄的。从现在起，每当我离开我的时区时，我打算将相机的时间设置为当地时间。幸运的是，有了智能手机，时间会自动改变。</li><li id="ceeb" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">在Lightroom中或通过智能手机应用程序</strong>为每张照片添加位置信息——直到我进行了这项分析，我才意识到时间和位置数据可以如此紧密地联系在一起。从现在开始，我会在导入后立即将位置信息记录到Lighroom中的keeper photos。我还会尝试使用智能手机上的尼康SnapBridge应用程序来自动捕捉每张照片的拍摄位置。</li><li id="edcb" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">为更多的守护者使用最高合理的快门速度</strong> —摄影的一个经验法则是将快门速度设置为镜头焦距的倒数或更高。使用这个规则，700毫米的焦距保证了1/700秒的快门速度。但是设置快门速度涉及到许多变量。例如，相机或镜头可能具有图像稳定功能，这有助于在较低的快门速度下捕捉清晰的图像。另一方面，在鸟类摄影中，拍摄对象通常很远且在移动，因此可能需要更快的快门速度来获得清晰的图像。为了获得更清晰的鸟类照片，我会尝试将快门速度提高到经验法则的倒数以上，无论是使用图像稳定、三脚架还是单脚架。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/03c37ce682facfed1ee28097b7e9025c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kQUNN8hMCXL_WtXE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">雌性红翅乌鸫。图片由作者提供。</p></figure><h1 id="cbc2" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">下一步是什么？</h1><p id="a08c" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">也许，通过这篇文章，您已经想到了将摄影元数据用于个人或商业项目的方法。以下是我可能会探索的想法:</p><ul class=""><li id="231b" class="mt mu it ls b lt mn lw mo lz mv md mw mh mx ml my mz na nb bi translated">使用Exif数据<strong class="ls iu">研究其他类型或主题的摄影模式</strong>，如昆虫、哺乳动物、风景和建筑。或者，我可能会按鸟类研究数据。</li><li id="a64b" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated">了解如何以编程方式<strong class="ls iu">从照片文件中获取不是以Exif格式存储的额外数据</strong>。例如，也许我对Lightroom目录中的许多照片应用的星级和标题可以在应用程序导出的每个JPEG文件中找到。有了这些数据点，照片的特征就可以在不同的评级中进行比较和对比。</li><li id="8a82" class="mt mu it ls b lt nc lw nd lz ne md nf mh ng ml my mz na nb bi translated"><strong class="ls iu">使用存储在每个图像文件中的日期和时间、关键字和潜在位置(GPS) </strong>来确定每年何时何地返回特定地点，以便有机会拍摄特定种类的鸟类。</li></ul><h1 id="4847" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="56d7" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">到目前为止，您可能对每个数码照片文件的Exif文件中存储的元数据有所了解。您还应该了解如何编写Python程序来获取元数据并在数据分析项目中使用它。像我一样，也许你可以使用图像元数据来了解你的摄影习惯和技术，并尝试在未来拍出更好的照片。</p><h1 id="fb3a" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">关于作者</h1><p id="2773" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Randy Runtsch是一名数据分析师、软件开发人员、作家、摄影师、自行车手和冒险家。他和妻子住在美国明尼苏达州东南部。</p><p id="e708" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">关注Randy即将发表的关于公共数据集的文章，以推动数据分析解决方案、编程、数据分析、摄影、自行车旅行、啤酒等。你可以在shootproof.com<a class="ae mm" href="https://randallruntschimages.shootproof.com/" rel="noopener ugc nofollow" target="_blank">和shutterstock.com</a>看到他的一些照片。</p><h1 id="420e" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">附录A — Python c_photo_exif类</h1><p id="e180" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">c_photo_exif类在文章的正文中有描述。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="6ab3" class="nj kz it ny b gy oc od l oe of">"""<br/>Name:           c_photo_exif.py<br/>Author:         Randy Runtsch<br/>Date:           March 20, 2021<br/>Description:    The c_photo_exif class opens all image files in the specified <br/>                folder, reads the Exif data from each file. It then gets the sunrise<br/>                and sunset times of the day the photo was taken. It then writes a subset<br/>                of the Exif data, and the sunrise and sunset times, as a row in a CSV file.<br/>"""</span><span id="93a0" class="nj kz it ny b gy og od l oe of">import csv<br/>import exifread<br/>import os<br/>import datetime<br/>from pytz import timezone<br/>from astral.geocoder import lookup, database<br/>from astral.sun import sun</span><span id="75ec" class="nj kz it ny b gy og od l oe of">class c_photo_exif:</span><span id="7375" class="nj kz it ny b gy og od l oe of">def __init__(self, input_photo_folder, output_csv_file_nm, city, time_zone):</span><span id="8ce2" class="nj kz it ny b gy og od l oe of"># Create the output CSV file with headers and process all of the <br/>        # photo files.</span><span id="f01b" class="nj kz it ny b gy og od l oe of"># Set astral location as Minneapolis and time zone as US/Central.<br/>        astral_db = database() <br/>        self._astral_city = lookup(city, astral_db)<br/>        self._time_zone = time_zone</span><span id="3346" class="nj kz it ny b gy og od l oe of">self._rows_processed = 0</span><span id="67ee" class="nj kz it ny b gy og od l oe of">csv_writer = self.init_csv_file(output_csv_file_nm)</span><span id="3bca" class="nj kz it ny b gy og od l oe of">self.process_photos(input_photo_folder, csv_writer)</span><span id="0900" class="nj kz it ny b gy og od l oe of">def process_photos(self, input_photo_folder, csv_writer):</span><span id="00ef" class="nj kz it ny b gy og od l oe of"># Process all of the image files contained in the input folder.</span><span id="2e82" class="nj kz it ny b gy og od l oe of">rows = 0</span><span id="51cc" class="nj kz it ny b gy og od l oe of">for subdirs, dirs, files in os.walk(input_photo_folder):<br/>            <br/>            for photo_file_nm in files:</span><span id="7c1a" class="nj kz it ny b gy og od l oe of"># Process only files with a .jpg extension.</span><span id="6abd" class="nj kz it ny b gy og od l oe of">if photo_file_nm[-4:] == '.jpg':</span><span id="9332" class="nj kz it ny b gy og od l oe of">self._rows_processed += 1</span><span id="a39c" class="nj kz it ny b gy og od l oe of">photo_file_nm_full = input_photo_folder + '/' + photo_file_nm<br/>                    self.process_photo(photo_file_nm, photo_file_nm_full, csv_writer)</span><span id="e3b0" class="nj kz it ny b gy og od l oe of">def process_photo(self, photo_file_nm, photo_file_nm_full, csv_writer):</span><span id="6389" class="nj kz it ny b gy og od l oe of"># Get a subset of EXIF values from the photo file. Call function write_csv_file_row()<br/>        # to write the values as a row to a CSV file.</span><span id="7636" class="nj kz it ny b gy og od l oe of">photo_file = open(photo_file_nm_full, 'rb')</span><span id="6f6e" class="nj kz it ny b gy og od l oe of">tags = exifread.process_file(photo_file)</span><span id="c34d" class="nj kz it ny b gy og od l oe of">camera_make     = tags['Image Make']<br/>        camera_model    = tags['Image Model']<br/>        photo_date_time = tags['EXIF DateTimeOriginal']<br/>        focal_length    = tags['EXIF FocalLength']<br/>        shutter_speed   = tags['EXIF ExposureTime']<br/>        f_stop          = tags['EXIF FNumber']<br/>        exposure_bias   = tags['EXIF ExposureBiasValue']<br/>        white_balance   = tags['EXIF WhiteBalance']<br/>        iso             = tags['EXIF ISOSpeedRatings']</span><span id="ada1" class="nj kz it ny b gy og od l oe of"># Exif date-time values contain colons in the date part (for example, 2021:01:20). Replace<br/>        # the first two colons with hyphens (-) so that they will be treated as date-time values<br/>        # in other programs, such as Tableau. This will leave the colons in place in the time portion<br/>        # of the value.</span><span id="6d39" class="nj kz it ny b gy og od l oe of">photo_date_time = photo_date_time.values.replace(':', '-', 2)</span><span id="391d" class="nj kz it ny b gy og od l oe of"># Get sunrise and sunset date-time values.</span><span id="9fb0" class="nj kz it ny b gy og od l oe of">sunrise_date_time   = self.get_sun_date_time(photo_date_time, 'sunrise')<br/>        sunset_date_time    = self.get_sun_date_time(photo_date_time, 'sunset')</span><span id="0372" class="nj kz it ny b gy og od l oe of">self.write_csv_file_row(csv_writer, photo_file_nm, photo_date_time, sunrise_date_time, sunset_date_time, \<br/>            camera_make, camera_model, focal_length, shutter_speed, f_stop, exposure_bias, iso, white_balance)</span><span id="02e9" class="nj kz it ny b gy og od l oe of">def init_csv_file(self, output_csv_file_nm):</span><span id="a3af" class="nj kz it ny b gy og od l oe of"># Open the CSV output file for write (create a new file and overwrite<br/>        # the existing file), write its header, and return its handle.</span><span id="f9bb" class="nj kz it ny b gy og od l oe of">headers = ['File Name', 'Photo Date Time', 'Sunrise Date Time', 'Sunset Date Time', 'Camera Make', 'Camera Model', \<br/>            'Focal Length', 'Shutter Speed', 'F Stop', 'Exposure Bias', 'ISO', 'White Balance']</span><span id="0e1f" class="nj kz it ny b gy og od l oe of">csv_file = open(output_csv_file_nm, 'w', encoding='utf-8', newline='')</span><span id="8f65" class="nj kz it ny b gy og od l oe of">csv_writer = csv.DictWriter(csv_file, headers)<br/>        csv_writer.writeheader()</span><span id="1b33" class="nj kz it ny b gy og od l oe of">return csv_writer</span><span id="9e71" class="nj kz it ny b gy og od l oe of">def write_csv_file_row(self, csv_writer, file_name, photo_date_time, sunrise_date_time, sunset_date_time, \<br/>        camera_make, camera_model, focal_length, shutter_speed, f_stop, exposure_bias, iso, white_balance):</span><span id="a303" class="nj kz it ny b gy og od l oe of"># Assemble the record of Exif values by column and write it to the CSV file.</span><span id="057f" class="nj kz it ny b gy og od l oe of">row = {'File Name' : file_name, 'Photo Date Time' : photo_date_time, 'Sunrise Date Time' : sunrise_date_time, \<br/>                  'Sunset Date Time' : sunset_date_time, 'Camera Make' : camera_make, 'Camera Model' : camera_model, \<br/>                  'Focal Length' : focal_length, 'Shutter Speed' : shutter_speed, \<br/>                  'F Stop' : f_stop, "Exposure Bias": exposure_bias, 'ISO' : iso, 'White Balance' : white_balance}</span><span id="426a" class="nj kz it ny b gy og od l oe of">csv_writer.writerow(row)</span><span id="9826" class="nj kz it ny b gy og od l oe of">def get_sun_date_time(self, date_time_in, date_time_type):</span><span id="d787" class="nj kz it ny b gy og od l oe of"># Get the sunrise or sunset date and time in UTC, convert it to the local<br/>        # timezone, and return it as a string in this format: YYYY-MM-DD HH:MM:SS.</span><span id="eee8" class="nj kz it ny b gy og od l oe of">date_in = datetime.datetime(int(date_time_in[0:4]), int(date_time_in[5:7]), int(date_time_in[8:10]))</span><span id="940b" class="nj kz it ny b gy og od l oe of">astral_sun = sun(self._astral_city.observer, date_in)<br/>        astral_date_time = astral_sun[date_time_type]</span><span id="f0bd" class="nj kz it ny b gy og od l oe of">astral_date_time_local = astral_date_time.astimezone(timezone(self._time_zone))<br/>        date_time_out = astral_date_time_local.strftime('%Y-%m-%d %X')</span><span id="851b" class="nj kz it ny b gy og od l oe of">return date_time_out</span><span id="1660" class="nj kz it ny b gy og od l oe of">def print_exif_values(self, photo_file_nm):</span><span id="1bf0" class="nj kz it ny b gy og od l oe of"># Print most of the human-readable Exif values for the specified photo file.</span><span id="485a" class="nj kz it ny b gy og od l oe of">file = open(photo_file_nm, 'rb')</span><span id="2552" class="nj kz it ny b gy og od l oe of"># Return Exif tags<br/>        exif_tags = exifread.process_file(file)</span><span id="fdd6" class="nj kz it ny b gy og od l oe of">for exif_tag in exif_tags.keys():<br/>            if exif_tag not in ('JPEGThumbnail', 'TIFFThumbnail', 'Filename', 'EXIF MakerNote'):<br/>                print("Key: %s, value %s" % (exif_tag, exif_tags[exif_tag]))</span><span id="3c23" class="nj kz it ny b gy og od l oe of">def get_rows_processed(self):</span><span id="ca1b" class="nj kz it ny b gy og od l oe of">return self._rows_processed</span></pre></div></div>    
</body>
</html>