<html>
<head>
<title>5 Use Cases of Pandas loc and iloc Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pandas loc和iloc方法的5个用例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-use-cases-of-pandas-loc-and-iloc-methods-a94796b1f734?source=collection_archive---------25-----------------------#2021-03-22">https://towardsdatascience.com/5-use-cases-of-pandas-loc-and-iloc-methods-a94796b1f734?source=collection_archive---------25-----------------------#2021-03-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1894" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让它们更有用。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1b56168c9e426bff98fa5b24785a595b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kfFePeawLFRv0FqNXLvo5Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历杭德罗·皮涅罗·阿梅里奥在Unsplash上拍摄的照片</p></figure><p id="976a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是一个高度灵活和强大的数据分析和操作库。它提供了许多函数和方法来在数据分析过程的每个步骤中执行有效的操作。</p><p id="529f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">loc和iloc是用于过滤、选择和操作数据的基本方法。它们允许我们访问数据帧中的特定单元格或多个单元格。</p><p id="1766" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论loc和iloc的5个用例，我认为它们在典型的数据分析过程中非常有用。</p><p id="e9bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用Kaggle上的墨尔本房产<a class="ae ky" href="https://www.kaggle.com/dansbecker/melbourne-housing-snapshot" rel="noopener ugc nofollow" target="_blank">数据集</a>作为例子。我们首先使用read_csv函数读取csv文件。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="adaf" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="16cd" class="ma mb it lw b gy mg md l me mf">df = pd.read_csv("/content/melb_data.csv")</span><span id="3f22" class="ma mb it lw b gy mg md l me mf">print(df.shape)<br/>(13580, 21)</span><span id="58ed" class="ma mb it lw b gy mg md l me mf">df.columns</span><span id="8f3f" class="ma mb it lw b gy mg md l me mf">Index(['Suburb', 'Address', 'Rooms', 'Type', 'Price', 'Method', 'SellerG','Date', 'Distance', 'Postcode', 'Bedroom2', 'Bathroom', 'Car','Landsize', 'BuildingArea', 'YearBuilt', 'CouncilArea', 'Lattitude','Longtitude', 'Regionname', 'Propertycount'],<br/>dtype='object')</span></pre><p id="f2fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集包含墨尔本约13580所房屋的21个要素。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="2e84" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">示例1</h2><p id="e344" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">之间的主要区别在于它们访问行和列的方式:</p><ul class=""><li id="c2f5" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated">loc使用行和列标签</li><li id="9fbc" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">iloc使用行和列索引</li></ul><p id="b554" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用这两种方法来选择地址列中的第一行。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d091" class="ma mb it lw b gy mc md l me mf">df.loc[:5, 'Address'] # df.loc[0:5, 'Address'] works as well<br/>0        85 Turner St <br/>1     25 Bloomburg St <br/>2        5 Charles St <br/>3    40 Federation La <br/>4         55a Park St <br/>5      129 Charles St<br/></span><span id="b5a1" class="ma mb it lw b gy mg md l me mf">df.iloc[:5, 1]<br/>0        85 Turner St <br/>1     25 Bloomburg St <br/>2        5 Charles St <br/>3    40 Federation La <br/>4         55a Park St</span></pre><p id="0410" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能已经注意到，我们使用相同的表达式来选择行。原因是Pandas默认分配整数行标签。因此，除非我们指定行标签，否则行的索引和标签是相同的。唯一的区别是上限包含在loc方法中。</p><p id="fd21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列索引也从0开始，因此地址列的索引是1。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="f56b" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">示例2</h2><p id="44c4" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我们不必指定一个范围来选择多行或多列。我们也可以在列表中传递它们。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1fde" class="ma mb it lw b gy mc md l me mf">df.loc[[5,7,9], ['Address', 'Type']]</span><span id="31c3" class="ma mb it lw b gy mg md l me mf">df.iloc[[5,7,9], [1,2]]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/6c8062c2543ecaf146231bc93e912800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2E4q4cLI4HHPz3Nb5yhKg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="66b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们选择了地址和类型列中标签(或索引)为5、7和9的行。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="1dc7" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">示例3</h2><p id="1d0d" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我们可以使用loc方法创建一个新列。让我们创建一个列，对于价格超过100万英镑的房屋，该列的值为1。因为每个数据点(即行)代表一所房子，所以我们将条件应用于价格列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6d88" class="ma mb it lw b gy mc md l me mf">df.loc[df.Price &gt; 1000000, 'IsExpensive'] = 1</span></pre><p id="722e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于满足条件的行,“IsExpensive”列为1，对于其他行为NaN。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0812" class="ma mb it lw b gy mc md l me mf">df.loc[:4, ['Price','IsExpensive']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/57fe14bdd1aacf33150fd8d433064d52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngHnGnZAuds8b30TMCYrng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="d067" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">实例4</h2><p id="31f2" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">loc方法接受多个条件。让我们创建一个名为category的新列，对于价格高于140万且类型为“h”的行，该列的值为“昂贵的房子”。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9761" class="ma mb it lw b gy mc md l me mf">df.loc[(df.Price &gt; 1400000) &amp; (df.Type == 'h'), 'Category'] = 'Expensive House'</span><span id="1c42" class="ma mb it lw b gy mg md l me mf">df.loc[:4, ['Price','Category']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/d62d8f408e9f9092dfce8a916688ea38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0DiqgZjfxTND-ufKgetIPw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="d31a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以稍后处理NaN值。例如，Pandas的fillna函数提供了处理缺失值的灵活方式。我们还可以使用loc方法根据其他条件来填充缺失的值。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="32e9" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">实例5</h2><p id="0f97" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我们可以使用loc方法根据条件更新现有列中的值。例如，下面的代码将对高于140万美元的价格应用5%的折扣。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="91ff" class="ma mb it lw b gy mc md l me mf">df.loc[df.Price &gt; 1400000, 'Price'] = df.Price * 0.95</span><span id="7916" class="ma mb it lw b gy mg md l me mf">df.loc[:4, ['Price','IsExpensive']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/28c105a26cc0ebc113f7888e3cc76876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMCFT-6PsH2bWW0X29qS4g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="458e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用iloc方法来完成这项任务，但是我们需要提供price列的索引。因为使用列标签比使用索引更方便，所以对于此类任务，loc方法比iloc方法更可取。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h2 id="edc7" class="ma mb it bd mo mp mq dn mr ms mt dp mu li mv mw mx lm my mz na lq nb nc nd ne bi translated">结论</h2><p id="d66c" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">由于现实生活中的数据通常是混乱的或者不是最合适的格式，数据科学家或分析师最常见的任务之一就是清理和处理数据。</p><p id="1e7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拥有一种灵活的方法来访问行和列以完成这样的任务是至关重要的。loc和iloc方法正是我们在这些情况下所需要的。</p><p id="d0b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>