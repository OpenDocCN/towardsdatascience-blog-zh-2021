<html>
<head>
<title>How to Encode Categorical Columns Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python编码分类列</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-encode-categorical-columns-using-python-9af10b36f049?source=collection_archive---------9-----------------------#2021-06-06">https://towardsdatascience.com/how-to-encode-categorical-columns-using-python-9af10b36f049?source=collection_archive---------9-----------------------#2021-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f94b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">机器学习模型读取的不是字符串而是数字。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b4a183b1b961ccb4d55ee27f1ea60bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Uyfwe6RRR88OrrAZ9szMQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com/s/photos/matrix?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="420d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="70d2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">机器学习是从数据中提取模式的好方法。有了这个模式，我们可以从新数据中提取隐藏信息，甚至预测标签。在我们可以使用机器学习模型中的数据之前，我们需要首先清理数据。</p><p id="8906" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在存在的数据还不是干净的。可能存在的问题是缺少值、分布不均匀、单个列的格式不同，或者某些列不是数字格式。</p><p id="43cb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">机器学习模型读取数字。如果这些列不是数字，模型将捕捉到一个错误。此外，模型不会将这些列纳入建模过程。因此，我们需要将非数字列重新格式化为数字列。</p><p id="d79c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文将向您展示如何使用Python处理非数字或分类列。没有进一步，让我们开始吧！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="e3c0" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">履行</h1><h2 id="a548" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">数据源</h2><p id="634d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了演示这一过程，我们将使用一个称为中风预测数据集的数据集。这是fedesoriano在Kaggle上创建的数据集。</p><p id="d9ce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该数据集描述了是否患有中风的人。此外，数据集包含与疾病相关的指标。该数据集属于监督学习问题，因为它包含一个人是否可能患有中风的标签。</p><p id="9f36" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以在这里 访问数据集<a class="ae ky" href="https://www.kaggle.com/fedesoriano/stroke-prediction-dataset" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">。</strong></a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/8629653fe6a75a4ae06b819af160bfe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sgPPs_oDv4fRM_MH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者捕捉到的</p></figure><p id="ec45" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在让我们导入数据。为此，我们可以使用pandas库来处理我们的数据集。下面是导入和预览数据的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="878d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上面的数据集中可以看出，有些列已经是数字格式的了。它们是年龄、高血压和心脏病栏。此外，有些列不是数字格式，如工作类型、性别、居住类型和吸烟状态列。</p><p id="0105" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们将关注非数字列。让我们根据数据类型来分离数据框。下面是这样做的代码和结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="5e9b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">分离数据框后，让我们检查每一列的唯一值。您可以使用。检索列中不同值的唯一方法。下面是代码和结果预览:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="23e3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">根据上面的结果，两列有两个唯一的值。三列有两个以上的唯一值。为什么计算唯一值的数量很重要？因为我们将以不同的方式对列进行编码。</p><p id="fd78" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于具有两个不同值的列，我们可以直接对该列进行编码。当一个列有两个以上的唯一值时，我们将使用one-hot编码。</p><h2 id="2425" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">使用标签编码对标签进行编码</h2><p id="6c61" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们知道了每列的特征之后，现在让我们重新格式化列。首先，我们将用两个不同的值重新格式化列。它们是曾经结婚和居住类型列。为此，我们可以使用scikit-learn中的LabelEncoder对象对列进行编码。</p><p id="d6f5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在让我们看看曾经结过婚这一栏。首先，我们将像这样初始化LabelEncoder对象:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="51d1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">之后，我们可以像这样将对象放入数据中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="1c84" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们可以将该列转换成数字格式，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4ac7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是我们运行代码后的结果，包括编码过程之前、之后和相反的过程:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="164c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">干得好！我们已经对第一列进行了编码。现在让我们对下一列进行编码，这是“residence_type”列。</p><p id="df50" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">回想一下前面的代码，拟合和转换过程似乎是分开执行的。实际上，我们可以将这个过程与。fit_transform方法。</p><p id="f012" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是代码和结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="305e" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">使用一键编码对标签进行编码</h2><p id="4bc7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">不错！让我们转到具有两个以上不同值的列。有三列包含两个以上的唯一值。它们是性别、工作类型和吸烟状态列。为了处理这些列，我们将使用一种称为一次性编码的技术。</p><p id="d4d0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">什么是热门编码？该过程将对列进行编码，并将其转换为矩阵。其中每一列表示该列中的每个不同值，每个单元格确定该值是否存在。</p><p id="c207" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是一键编码流程的示例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/da2a80050ca6402d7d1d37adf88537a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d0cqhS9MkKFn_YM1PjuBUA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者插图</p></figure><p id="5989" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了实现这一点，我们将使用scikit-learn中的OneHotEncoder对象对这些列进行编码。</p><p id="30fe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们来看看性别一栏。首先，我们将像这样初始化OneHoteEncoder对象:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9c51" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，我们可以使用。fit_transform方法来同时拟合和转换数据。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="e98a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">哎呀，这里有一个错误。如果我们读取错误，它说有一个值错误。该函数需要一个二维数组作为输入。</p><p id="de12" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要转换列的形状，我们可以使用。整形列的整形方法。但是我们需要首先将列转换为NumPy数组。为此，我们可以用np.array函数包装该列。</p><p id="34c4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们重复这个过程！下面是一键编码过程之前、之后和之后的代码和结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="d8b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有用！现在让我们将它应用到其他列，如smoking_status和work_type列。下面是一键编码过程的代码和结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="7622" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">干得好！现在您已经对所有的列进行了编码。</p><h2 id="e642" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">创建编码的数据帧</h2><p id="df5c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对这些列进行编码后，我们可以从中创建一个数据帧。对于每一列，我们将初始化DataFrame对象以创建dataframe。然后，我们使用。concat方法。下面是这样做的代码和结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="70f1" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">与数字列数据框架组合</h2><p id="c503" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">太好了！这些分类列已经是dataframe格式。现在让我们将它们与数字列结合起来。下面是这样做的代码和结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="8e2c" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">包装过程的技巧</h2><p id="eea9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">哇，那是一个漫长的过程。实际上，有一个技巧可以让你只用一行代码就做到这一点。您可以使用一个名为。从熊猫图书馆拿假人做所有这些。</p><p id="7a75" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们回忆一下包含数据帧中所有分类列的df _ categorical变量。以下是对数据帧及其结果进行编码的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="09de" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在让我们将它们与数字列结合起来:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="886f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">简单吧？如果你时间不多，get_dummies函数马上就能帮到你！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="c0fa" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">结束语</h1><p id="3d52" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">干得好！现在，您已经了解了如何使用Python对分类变量进行编码。我希望这篇文章能帮助你解决这个问题。因此，如果您从事这样的项目，下次就不必扔掉这些列了。</p><p id="073e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你对我的文章感兴趣，可以关注我的媒介，获取更多关于数据科学和机器学习的文章。如果你有任何问题或者想打个招呼，你可以在<a class="ae ky" href="https://www.linkedin.com/in/alghaniirfan/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> LinkedIn </strong> </a>上联系我。</p><p id="fc86" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">谢谢你看我的文章！</p></div></div>    
</body>
</html>