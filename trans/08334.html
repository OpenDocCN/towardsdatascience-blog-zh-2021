<html>
<head>
<title>Explore Better Materials Using Deep Graph Convolutional Networks and Bayesian Optimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度图卷积网络和贝叶斯优化探索更好的材料</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/explore-better-materials-using-deep-graph-convolutional-networks-and-bayesian-optimization-144a9b6699fc?source=collection_archive---------30-----------------------#2021-07-31">https://towardsdatascience.com/explore-better-materials-using-deep-graph-convolutional-networks-and-bayesian-optimization-144a9b6699fc?source=collection_archive---------30-----------------------#2021-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f5cd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从理论计算中提取知识来设计材料，以最大限度地减少破坏性实验的次数。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8677108e778f28ceaed52e84dcce7f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EF3NBRj6fRp9T2ujXQL-nw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Louis-Etienne Foy 在<a class="ae kv" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="ee28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated"><span class="l lt lu lv bm lw lx ly lz ma di">你想要更好的材料吗？是的，我们有。我们想要容量更大、寿命更长的更好的电池。或者，我们想要更好的太阳能电池板和更高的发电量。或者，我们想要焦耳热损失更少的更好的半导体。所有这些性能限制都源于组成它们的材料。所以，是的，我们确实希望任何产品都有更好的材料。</span></p><h2 id="4d31" class="mb mc iq bd md me mf dn mg mh mi dp mj lf mk ml mm lj mn mo mp ln mq mr ms mt bi translated">动机</h2><p id="44f4" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">但是我们如何从几乎无限的现有材料中找到它们呢？一种方法是利用模拟数据库，如<a class="ae kv" href="https://materialsproject.org" rel="noopener ugc nofollow" target="_blank">材料项目</a>。这种类型的数据库已经使用DFT计算来编译材料特性，这有利于缩小探索范围。然而，众所周知，有几个性质的可预测性很差，比如带隙，所以我们不能从表面上接受它们的值。虽然，根据<a class="ae kv" href="http://www.crystallography.net/cod/" rel="noopener ugc nofollow" target="_blank">结晶学开放数据库</a>显示，目前为止，累计晶体数量已经达到<strong class="ky ir">476995</strong>，以至于无法通过实验的方式检查其性能。啊，我希望有一个好的实验数据库和材料发现的搜索引擎！可悲的是，根本不存在。(至少现阶段是这样。)是的，我们应该创造一种方法来利用从理论数据库到实验晶体结构数据库的知识。那么，在机器学习的帮助下，让我们考虑有效探索所需材料的方法。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="5421" class="ng mc iq bd md nh ni nj mg nk nl nm mj jw nn jx mm jz no ka mp kc np kd ms nq bi translated">问题设置</h1><p id="ca3b" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">让我们考虑探索具有期望的<strong class="ky ir">带隙</strong>的材料。当我们想要一个更好的半导体时，这个特征值是最基本的指导。根据产品的设计，所需的带隙值会有所不同。因此，我们可以将半导体材料发现问题简化如下:</p><blockquote class="nr"><p id="8b19" class="ns nt iq bd nu nv nw nx ny nz oa lr dk translated">当我们设置E为带隙的理想值时，如何用最少的探索试验从晶体数据库中尽可能多地找到带隙最接近的晶体？</p></blockquote><p id="1c7e" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf od lh li lj oe ll lm ln of lp lq lr ij bi translated">让我们把这个问题说得更具体一些。我们要澄清的事情如下:</p><blockquote class="og oh oi"><p id="0f98" class="kw kx oj ky b kz la jr lb lc ld ju le ok lg lh li ol lk ll lm om lo lp lq lr ij bi translated">1.我们需要多精确地接近目标值？<br/> 2。哪个指标最合适？<br/> 3。我们如何构建数据集？<br/> 4。我们需要探索到什么程度？</p></blockquote><p id="0b2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们应该在0.01 eV误差内估计目标值。eV，电子伏特，是带隙的单位。根据其制造方法或条件，带隙可以在这个尺度上变化。所以，继续追求可能会徒劳无功。其次，当我们强调绝对值而不是比率时，我们可以采用MAE(平均绝对值)度量。顾名思义，这可以通过目标值与估计值之差的绝对值的平均值来获得。接下来，我们可以使用CIF(晶体信息文件)数据集。CIF是描述晶体结构的国际格式，它包含基本信息，但不是定量的。第三，我们可以使用材料项目数据库作为伪实验数据集。假设我们可以从假设的实验数据集中探索带隙为E的材料。在这种情况下，我们可以应用同样的策略来有效地进行实际的实验。考虑到实际情况，我们可以通过调查科技论文来收集目标值的初步信息。假设这个数字是100左右。此外，我们可以通过考虑其他不希望的方面如合成成本或反应性来排除许多候选物。这样，我们可以获得100个初步信息，并将勘探候选对象缩小到6000个左右。<br/>那么，我们可以把实验材料探索问题概念化如下:</p><blockquote class="nr"><p id="241d" class="ns nt iq bd nu nv nw nx ny nz oa lr dk translated">当我们将E设置为带隙的理想值时，如何利用100个先验信息，用最少的探索试验从大约6000个候选者中尽可能多地找到MAE小于0.01 eV的晶体？</p></blockquote></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="77c1" class="ng mc iq bd md nh ni nj mg nk nl nm mj jw nn jx mm jz no ka mp kc np kd ms nq bi translated"><strong class="ak">机器学习策略</strong></h1><h2 id="f6ef" class="mb mc iq bd md me mf dn mg mh mi dp mj lf mk ml mm lj mn mo mp ln mq mr ms mt bi translated">贝叶斯优化</h2><p id="2b9f" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">正如我们可以很容易地在谷歌搜索中发现的，<strong class="ky ir">贝叶斯优化</strong>似乎是一个有效的探索。贝叶斯优化是一种算法，旨在以最少的尝试探索更好的数据点。例如，谷歌大脑团队将这种算法应用于<a class="ae kv" href="https://www.blog.google/technology/research/makings-smart-cookie/" rel="noopener ugc nofollow" target="_blank">智能优化巧克力饼干配方</a>。不管怎样，这看起来很实用，是的，我们应该把它应用到材料发现上。但是等等，我们需要<strong class="ky ir">描述符</strong>。换句话说，这组变量用来识别唯一的晶体。谷歌团队使用了每个饼干烹饪程序的定量值，例如木薯淀粉的重量比。如何才能量化晶体？</p><h2 id="e706" class="mb mc iq bd md me mf dn mg mh mi dp mj lf mk ml mm lj mn mo mp ln mq mr ms mt bi translated">水晶图卷积神经网络</h2><p id="62ea" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">一个简单的方法是利用<strong class="ky ir">预先训练好的水晶深度学习模型</strong>。<strong class="ky ir"> CGCNN </strong>，Crystal Graph卷积神经网络，是材料科学领域开创性的深度学习架构。在<a class="ae kv" href="https://github.com/txie-93/cgcnn" rel="noopener ugc nofollow" target="_blank">作者的GitHub资源库</a>中，他们开放了预先训练好的模型，每个人都可以使用。当我们查看准备好的模型文件夹时，我们可以找到带隙模型(band-gap.pth.tar)。通过使用该模型作为特征提取器，我们可以在autopilot上将CIF文件转换为128个定量描述符。</p><h2 id="9b98" class="mb mc iq bd md me mf dn mg mh mi dp mj lf mk ml mm lj mn mo mp ln mq mr ms mt bi translated">主成分分析</h2><p id="ab68" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">不幸的是，128个描述符对于贝叶斯优化来说太多了。虽然有很多针对高维优化的前沿算法，但基本上，低维效果更好，不需要额外的努力。此外，这128个描述符仅用于定量识别晶体，因此高维数不是必需的。因此，我们可以使用PCA，主成分分析来降低维数。通过将128维减少到3维，我们可以设置更有效的探索空间。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="27ca" class="ng mc iq bd md nh ni nj mg nk nl nm mj jw nn jx mm jz no ka mp kc np kd ms nq bi translated">代码</h1><p id="c6eb" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">Python库要求:</p><ul class=""><li id="8d1e" class="on oo iq ky b kz la lc ld lf op lj oq ln or lr os ot ou ov bi translated">pymatgen</li><li id="f998" class="on oo iq ky b kz ow lc ox lf oy lj oz ln pa lr os ot ou ov bi translated">pytorch</li><li id="6e8c" class="on oo iq ky b kz ow lc ox lf oy lj oz ln pa lr os ot ou ov bi translated">sci kit-学习</li><li id="893c" class="on oo iq ky b kz ow lc ox lf oy lj oz ln pa lr os ot ou ov bi translated">GPyOpt</li><li id="fc45" class="on oo iq ky b kz ow lc ox lf oy lj oz ln pa lr os ot ou ov bi translated">GPy</li></ul><h1 id="d283" class="ng mc iq bd md nh pb nj mg nk pc nm mj jw pd jx mm jz pe ka mp kc pf kd ms nq bi translated">数据集构建</h1><p id="dccd" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我们将使用材料项目API来构建数据集。首先，您需要在Materials项目上创建一个帐户，然后获取API密钥。这可以通过遵循官方指令来完成。然后，我们将为先验信息和探索编译两个数据集。您应该将<strong class="ky ir"> MY_API_KEY </strong>更改为您的密钥。</p><p id="8228" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个代码中，我们搜索带隙在2.3和2.8之间的晶体，得到6749种材料。然后，它们被分成两个文件夹；“cif_prior”和“cif_experiment”，分别包含100个和6649个cif文件。此外，带隙值在每个文件夹中存储为“id_prop.csv”。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pg ph l"/></div></figure><h1 id="bba0" class="ng mc iq bd md nh pb nj mg nk pc nm mj jw pd jx mm jz pe ka mp kc pf kd ms nq bi translated">使用预训练的CGCNN模型将CIF转换为128个描述符</h1><p id="6fff" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">您可以按照这里的官方说明来git克隆CGCNN资源库。你需要将<strong class="ky ir"><em class="oj">atom _ init . JSON</em></strong>复制到“cif_prior”和“cif_experiment”两个文件夹中。然后，您可以通过修改<strong class="ky ir"> <em class="oj"> predict.py </em> </strong>来创建特征提取代码。我在predict.py中的<strong class="ky ir"> validate函数</strong>的基础上创建了<strong class="ky ir"><em class="oj">extract _ feature . py</em></strong>，代码太长，这里写不下，所以我只展示修改的部分。</p><p id="0b6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，主要功能的修改部分是这样的最后一部分。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="556d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，像这样修改validate函数的中间部分。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="848f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，可以用下面的参数执行这个<strong class="ky ir"><em class="oj">extract _ feature . py</em></strong>。</p><pre class="kg kh ki kj gt pi pj pk pl aw pm bi"><span id="89ce" class="mb mc iq pj b gy pn po l pp pq">python3 extract_feature.py ./pre-trained/band-gap.pth.tar ./cif_experiment</span></pre><p id="6524" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样你就可以得到128个描述符作为<strong class="ky ir"><em class="oj">CG CNN _ features . CSV</em></strong>。我们应该为“cif_prior”和“cif_experiment”创建特征。并将<strong class="ky ir"><em class="oj">CG CNN _ features . CSV</em></strong>重命名为<strong class="ky ir"><em class="oj">CG CNN _ features _ prior . CSV</em></strong>和<strong class="ky ir"><em class="oj">CG CNN _ features _ experiment . CSV</em></strong>。</p><h1 id="5849" class="ng mc iq bd md nh pb nj mg nk pc nm mj jw pd jx mm jz pe ka mp kc pf kd ms nq bi translated">通过主成分分析将维数从128减少到3</h1><p id="8fea" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我们将把128个特征转换成三维数据。同样，对两个数据集执行两次代码，将输出<strong class="ky ir"><em class="oj">CG CNN _ PCA . CSV</em></strong>重命名为<strong class="ky ir"><em class="oj">CG CNN _ PCA _ prior . CSV</em></strong>和<strong class="ky ir"><em class="oj">CG CNN _ PCA _ experience . CSV</em></strong>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pg ph l"/></div></figure><h1 id="db11" class="ng mc iq bd md nh pb nj mg nk pc nm mj jw pd jx mm jz pe ka mp kc pf kd ms nq bi translated">贝叶斯优化</h1><p id="30a2" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">最后，我们将使用贝叶斯优化探索更好的材料。实验设置将通过定义以下类实例来完成。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="4bab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一切准备工作都已就绪。下一个代码将自动探索更好的材料。在该设置中，目标带隙被设置为E = 2.534 [eV]。我们期望的材料应该具有0.01 eV的MAE误差，因此，目标范围将在2.524和2.544 eV之间。贝叶斯优化循环将按照<em class="oj"> n_experiment </em>重复探索30次。发现的材料和相应的值存储在以下self实例中:</p><ul class=""><li id="00cc" class="on oo iq ky b kz la lc ld lf op lj oq ln or lr os ot ou ov bi translated">探索的带隙值；exp.explored _ bandgaps</li><li id="05d6" class="on oo iq ky b kz ow lc ox lf oy lj oz ln pa lr os ot ou ov bi translated">水晶名称；出口晶体</li><li id="a377" class="on oo iq ky b kz ow lc ox lf oy lj oz ln pa lr os ot ou ov bi translated">累积损失曲线；结果</li></ul><p id="006d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过添加基于这些实例和变量的代码，您可以自由地可视化或导出这些结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="8733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我的设置中，在5次内，贝叶斯优化可以找到想要的材料。也就是说，这种方法在实际的材料勘探方案中似乎是有用的。享受材料发现！</p></div></div>    
</body>
</html>