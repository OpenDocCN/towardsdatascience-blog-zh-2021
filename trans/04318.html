<html>
<head>
<title>Bubble Charts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">气泡图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bubble-charts-70ef7485c51e?source=collection_archive---------27-----------------------#2021-04-12">https://towardsdatascience.com/bubble-charts-70ef7485c51e?source=collection_archive---------27-----------------------#2021-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f7ed" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">plotly Express vs . plotly . graph _ objects</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1d1435d7ef714d313bd10f410f469d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1T54sAhorVLNwSgZKFuVA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安德鲁·伍尔夫在<a class="ae ky" href="https://unsplash.com/s/photos/bubbles?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="9fbf" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">数据可视化</strong></h1><p id="e3d4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据可视化讲故事是人类最原始的交流形式。有可追溯到公元前44000年的洞穴绘画，远早于公元前3000年的文字交流。</p><p id="04f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">根据进化论，<strong class="lt iu">我们是视觉物种</strong>:我们进化的方式使得大量的精神资源被用于视觉感知和知识获取。比起文字，我们更注重视觉元素。</p><p id="4f01" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的大脑是一个带宽非常宽的并行图像处理器。一些数据证实了上面的说法:传输到我们大脑的信息90%是视觉的；视觉信息传递到大脑的速度比同样的信息以文本形式传递要快6万倍；65%的学生是视觉学习者。</p><p id="5936" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据可视化是一种交流工具。这是讲述我们数据中的故事并将其传达给适当受众的最有力方式。但在一个充满屏幕和视觉元素的世界里，我们必须防止观众出现视觉疲劳的症状。</p><p id="2958" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以我们的图表和数字应该:视觉上有趣；展示一个清晰的故事；有可以利用的信息；有一个信息丰富的标题，清晰标注的轴，适当的图例，最好是没有不必要元素的二维图表。</p><p id="16b6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当信息的本质是显示三个或更多数字变量之间的<strong class="lt iu">联系或相关性时，</strong>一个好的图表应该帮助我们找到模式，确定相关性的存在或不存在，识别异常值，并显示集群和缺口的存在。<strong class="lt iu">气泡图</strong>非常适合这种用途。</p><h1 id="86da" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">气泡图</strong></h1><p id="046b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">气泡图用于确定至少<strong class="lt iu">三个数值变量</strong> <strong class="lt iu">是否相关</strong>或共享某种模式。在笛卡尔坐标系中，为一对数值变量(<strong class="lt iu"> A，B </strong>)的每次观察绘制一个气泡或圆盘，圆盘根据变量A的值水平放置，根据变量B垂直放置。第三个数值变量(C)通过气泡的<strong class="lt iu">区域表示。你甚至可以在不同的泡泡中使用不同的颜色加入第四个变量(<strong class="lt iu"> D </strong>:数字或分类)。</strong></p><p id="fdf3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通过这些数据点产生的形状以及气泡或圆盘相对大小的差异，讲述了三个或四个变量之间的关系，而不是它们的确切值。</p><p id="7e7b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在特殊情况下，它们可以用来显示一段时间内的趋势或比较分类变量。它们被认为是<a class="ae ky" href="https://medium.com/analytics-vidhya/scatter-plots-why-how-3de6e1e32645" rel="noopener">散点图</a>的自然延伸，其中的点被气泡或<strong class="lt iu">圆盘所取代。</strong></p><h1 id="0a08" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">带有Plotly Express的气泡图</strong></h1><p id="00e6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> Plotly Express (PE)是Plotly.py的高级包装器，与Plotly生态系统的其余部分完全兼容</strong>，简单、强大，有点类似Seaborn。它是免费的，可以用于商业应用和产品。该库包括绘制趋势线和地图的函数，以及执行<strong class="lt iu">刻面</strong>和动画的函数。有了PE，你可以在线制作交互式图形，也可以离线保存。</p><p id="07e7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们使用了从Kaggle [1]下载的数据集。它属于80种谷类产品的营养数据。这些数据是由康奈尔大学的学生于20世纪90年代早期在当地的威格曼斯超市收集的。我们想知道《消费者报告》的评级和一些特定的营养数据(糖、钠、维生素)之间是否有关联。</p><p id="054d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们导入Plotly Express为<em class="ms"> px，</em>熊猫库为<em class="ms"> pd </em>，并将我们的<em class="ms"> csv文件</em>转换成<strong class="lt iu">数据帧</strong>:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9c55" class="my la it mu b gy mz na l nb nc">import pandas as pd<br/>import plotly.express as px</span><span id="59e9" class="my la it mu b gy nd na l nb nc">df = pd.read_csv(path + 'cereals.csv', index_col = False,<br/>                 header = 0,   sep = ';', engine='python')</span></pre><p id="c461" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面的屏幕截图显示了数据集的前十条记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/15b390710a069371ea9b2c6edb3b9cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1lzq6q-Nv1nUT5SiSlt79w.png"/></div></div></figure><p id="5728" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">实际的数据探索表明，我们只需使用<code class="fe nf ng nh mu b"><em class="ms">df.dropna(inplace = True)</em></code> <em class="ms"> </em>消除一些具有N/A值的行，数据集就可以绘制图形了。</p><p id="3b26" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于本文中的气泡图，Plotly Express函数为<code class="fe nf ng nh mu b"> <em class="ms">px.scatter</em></code>，对应的参数为:<code class="fe nf ng nh mu b"><em class="ms">data_frame</em></code>；<code class="fe nf ng nh mu b"> x=</code>代表一个数值变量的<em class="ms">数据帧</em>中的列名；<code class="fe nf ng nh mu b"><em class="ms">y=</em></code>表示另一个数值变量的<em class="ms">数据帧</em>中的列名；<code class="fe nf ng nh mu b"><em class="ms">size=</em></code>通过气泡的<strong class="lt iu">区域表示第三个数值变量的<em class="ms">数据帧</em>中的列名。</strong></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="df1b" class="my la it mu b gy mz na l nb nc">df.dropna(inplace = True)</span><span id="f616" class="my la it mu b gy nd na l nb nc">fig0 = px.scatter(df, x = 'sugars', y = 'rating',size = 'vitamins')</span><span id="f56a" class="my la it mu b gy nd na l nb nc">fig0.write_image(path + "figbubble0.png")</span><span id="626b" class="my la it mu b gy nd na l nb nc">fig0.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5fdee065ce3b53c69a1f6efe02e23019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*x2OhcJFZQO4XVYjqii_2Lg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图0:气泡图。作者用Plotly Express制作的图表。</p></figure><p id="0369" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">毫无疑问，这不是一个有用的讲故事的合适图表。</p><p id="a97a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们认为0糖和93等级的泡沫是异常值。我们没有删除该点，而是在范围[0–80]内建立了y轴。此外，我们使用<code class="fe nf ng nh mu b"><em class="ms">px.scatter</em>.</code>中的<code class="fe nf ng nh mu b"> <em class="ms">color</em></code> <em class="ms"> </em>参数合并了第四个数值变量</p><p id="184e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们用<code class="fe nf ng nh mu b"> <em class="ms">update.layout</em></code>更新了图表:设置标题、字体大小、<a class="ae ky" rel="noopener" target="_blank" href="/histograms-with-plotly-express-e9e134ae37ad"> <em class="ms">模板</em>、</a>以及带有宽度和高度的图形尺寸。然后我们更新了x轴和y轴(文本、字体、tickfont)。我们将图表保存为静态的<em class="ms"> png </em>文件，最后，我们绘制了图表。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1fea" class="my la it mu b gy mz na l nb nc">fig1 = px.scatter(df, x = 'sugars', y = 'rating',<br/>                  size = 'vitamins',   color = 'sodium')</span><span id="6803" class="my la it mu b gy nd na l nb nc">fig1.update_layout(<br/>                   title = "Cereals Consumer Reports Ratings ",<br/>                   "title_font_size = 40,    <br/>                   template = 'seaborn',<br/>                   width = 1600, height = 1400)</span><span id="eaa2" class="my la it mu b gy nd na l nb nc">fig1.update_xaxes(<br/>                  title_text = 'Sugar',<br/>                  title_font=dict(size=30, family='Verdana',  <br/>                                  color='purple'),<br/>                  tickfont=dict(family='Calibri', color='black', <br/>                                size=25))</span><span id="6bfd" class="my la it mu b gy nd na l nb nc">fig1.update_yaxes(<br/>                  title_text = "Rating", range = (0,80),<br/>                  title_font=dict(size=30, family='Verdana', <br/>                                  color='orange'),<br/>                  tickfont=dict(family='Calibri', color='black', <br/>                                size=25)</span><span id="f467" class="my la it mu b gy nd na l nb nc">fig1.write_image(path + "figbubble1.png")<br/>fig1.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/04a48adc56033cb385fa07f6a561e5c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*4T86p_LYlzHbM7zIYfdoag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:一个合适的气泡图。作者用Plotly Express制作的图表。</p></figure><p id="f49c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">图1清楚地显示了消费者评价和谷物含糖量之间的负相关关系。右侧的彩色垂直刻度表示钠的量(<code class="fe nf ng nh mu b">color = ‘sodium’</code>)。由于图表上的彩色气泡分布均匀，我们可以得出结论，钠的含量不会显著影响消费者的鉴赏能力。最后，气泡的大小与谷物中维生素的数量有关。该图显示了评级和维生素之间的零关系。</p><h1 id="c8c0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">气泡图与Plotly.graph_objects </strong></h1><p id="686d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe nf ng nh mu b"><em class="ms">plotly.graph_objects</em> </code>模块包含了Python类的层次结构。<code class="fe nf ng nh mu b"><em class="ms">Figure </em></code>是初级类。<code class="fe nf ng nh mu b"><em class="ms">Figure </em></code>具有数据属性和布局属性。数据属性有40多个对象，每个对象引用一个特定类型的图表(<strong class="lt iu"> trace </strong>)及其相应的参数。布局属性指定图形的整体属性(轴、标题、形状、图例等。).</p><p id="8fe5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用<em class="ms"> plotly.graph_objects </em>的概念是使用<code class="fe nf ng nh mu b"> .<em class="ms">add_trace(go.Scatter())</em> </code>创建图形，然后添加<code class="fe nf ng nh mu b">.update_layout(), .update_xaxes, .update_yaxes</code>等方法来操作图形。最后，我们用<code class="fe nf ng nh mu b">.write_image() </code>导出图形，并用<code class="fe nf ng nh mu b">.show().</code>渲染</p><p id="79df" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，我们键入了带有颜色、色彩空间、不透明度、大小和其他大小参数的<code class="fe nf ng nh mu b">mode = ‘markers’</code>和<em class="ms">字典</em>。特别是，<code class="fe nf ng nh mu b"><em class="ms">sizeref</em> </code>属性允许缩放气泡的大小，而<code class="fe nf ng nh mu b"><em class="ms">colorscale </em></code>允许显示特定的调色板。图例的文本由<code class="fe nf ng nh mu b"><em class="ms">name</em> </code>属性表示。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="149a" class="my la it mu b gy mz na l nb nc">import plotly.graph_objects as go<br/>fig2 = go.Figure()</span><span id="1240" class="my la it mu b gy nd na l nb nc">sizeref = 2.*max(df['sodium'])/(150**2)</span><span id="14dd" class="my la it mu b gy nd na l nb nc">fig2.add_trace(go.Scatter(<br/>                          x = df['sugars'], y = df['rating'],<br/>                          mode = 'markers',<br/>                          name = 'Size = vitamins * Color = sodium',<br/>                          marker = dict(color = df['sodium'],<br/>                          colorscale = 'portland',<br/>                          opacity = 0.8,size = df['vitamins'],<br/>                          sizemode = 'area', sizeref= sizeref,<br/>                          sizemin= 4, showscale = True<br/>                          )))</span><span id="8c66" class="my la it mu b gy nd na l nb nc">fig2.update_layout(title = "Cereals Consumer Reports Ratings ",<br/>                   title_font_size = 40, template = 'seaborn',<br/>                   width = 1600, height = 1400)</span><span id="231f" class="my la it mu b gy nd na l nb nc">fig2.update_layout(legend=dict(<br/>                               yanchor="top", y=0.99,<br/>                               xanchor="left",x=0.01),<br/>                               legend_font_size= 20,<br/>                               showlegend = True)</span><span id="ea8a" class="my la it mu b gy nd na l nb nc">fig2.update_xaxes(title_text = 'Sugar',<br/>                  title_font=dict(size=30, family='Verdana', <br/>                                  color='purple'),<br/>                  tickfont=dict(family='Calibri', color='black', <br/>                                 size=25))</span><span id="1520" class="my la it mu b gy nd na l nb nc">fig2.update_yaxes(title_text = "Rating", range = (0,80),<br/>                  title_font=dict(size=30, family='Verdana', <br/>                                  color='orange'),<br/>                  tickfont=dict(family='Calibri', color='black', <br/>                                size=25))</span><span id="58c1" class="my la it mu b gy nd na l nb nc">fig2.write_image(path + "figbubble2.png")<br/>fig2.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8adf7f70ff1f957a59d1bec9f155dbf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*oWrHuPM6Ei0RMCNLt5wVtA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:带有Plotly.graph_objects的气泡图。作者使用与上图相同的数据集制作的图表。</p></figure><p id="5ec8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">总结一下:</strong></p><p id="f51a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当我们想要显示三个或四个变量之间的关系而不是它们的确切值时，气泡图是合适的。Plotly Express和Plotly.graph_objects允许您使用少量且一致的代码行创建高质量的静态图像。</p><p id="4037" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是您必须注意以下警告:</p><ul class=""><li id="2b91" class="nj nk it lt b lu mn lx mo ma nl me nm mi nn mm no np nq nr bi translated">请记住，气泡的面积与其半径不成正比，而是与其平方成正比；</li><li id="0120" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">与散点图不同，气泡图不会随着数据点数量的增加而改善；</li><li id="f743" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">它们不应用于表示零或负值，因为没有负或零区域；</li><li id="e85f" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">要用气泡图显示一段时间内的趋势，你必须把时间变量放在横轴上。</li></ul><p id="65ef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你对这篇文章感兴趣，请阅读我以前的(<a class="ae ky" href="https://medium.com/@dar.wtz" rel="noopener">https://medium.com/@dar.wtz</a>):</p><p id="d1c3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">带Plotly Express、跟踪和布局的面积图</p><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/area-charts-with-plotly-express-510a1f12ac11"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">带Plotly Express的面积图</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">轨迹和布局</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div><p id="4152" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">带有Plotly Express、主题和模板的直方图</p><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/histograms-with-plotly-express-e9e134ae37ad"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">用Plotly表示的直方图</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">主题和模板</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="op l ol om on oj oo ks oa"/></div></div></a></div><p id="598d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">参考文献</strong></p><p id="5350" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[1]:<a class="ae ky" href="https://www.kaggle.com/crawford/80-cereals" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/crawford/80-cereals</a></p><p id="5447" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[2]:<a class="ae ky" href="https://www.kaggle.com/crawford/80-cereals/discussion/154053" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/Crawford/80-麦片/discussion/154053 </a></p></div></div>    
</body>
</html>