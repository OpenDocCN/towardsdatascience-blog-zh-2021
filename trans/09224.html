<html>
<head>
<title>Statistical Machine Learning: Gradient Boosting &amp; AdaBoost from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">统计机器学习:从零开始的梯度提升和AdaBoost</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/statistical-machine-learning-gradient-boosting-adaboost-from-scratch-8c4b5a9db9ed?source=collection_archive---------19-----------------------#2021-08-26">https://towardsdatascience.com/statistical-machine-learning-gradient-boosting-adaboost-from-scratch-8c4b5a9db9ed?source=collection_archive---------19-----------------------#2021-08-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a28" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">全计算模拟助推程序的数学推导</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0fbf0682366d7b8e6d9905852ff36fec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0bP_lkoi_yOzEobM"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">奥斯卡·诺德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="2090" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1:简介</h1><p id="22ea" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Boosting是一系列用于离散和连续随机变量目标的集成机器学习技术。助推模型采用非参数加性模型的形式，并且最典型地被指定为加性成分是“弱学习者”。从经验风险分解的角度来看，可以很容易地表明，任何任意统计估计量的均方误差(MSE)是所述抽样估计量的偏差和抽样方差的平方和…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/2825e04a3bc78414e0a78f344579f0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlhAEkaq2YPwY1Jguw-tDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1234" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">…“弱学习者”是具有高平方偏差但低抽样方差的统计估计量。从计算的角度来看，弱学习者具有模型拟合容易的优势。弱学习器的例子包括只限于几层深度的单个决策和回归树，甚至可能是一层(称为“决策/回归树桩”)。</p><p id="edae" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">提升的动机是恢复弱学习器的附加集合，它们一起可以指定任意复杂的模型。在本文中，我们将详细说明梯度增强和AdaBoost的理论框架和完整的数学推导。我们还将从头开始提供这些方法的完整计算模拟，而不使用增强计算包。</p><p id="d98e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这篇文章的目录如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/fff19f08b4a81091923250c310446181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0L4veP12xuw10kU4cT29wA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="4bfe" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak"> 2:梯度推进模型</strong></h1><p id="e89b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">利用梯度推进，模型估计过程可以被视为在提议弱学习者的空间上在函数空间中执行梯度下降(因此得名“梯度推进”)。让我们进入数学规范和拟合程序:</p><h2 id="c255" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">2.1:统计模型的规格</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/1000d4b2a283d9a71ca58687038b6995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*08NgvczYtX7wYD9j5dSlnQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="a20b" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">2.2:安装程序</h2><p id="4022" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了理解梯度增强模型的拟合过程，首先回忆一下泰勒展开是有帮助的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/c14dd8fd6de9bbb0e4d560461940900a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iINorNTkkd5dp0vxAg56sA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/a4e3504fd16ff8615a91a5271d76138d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pmN2JXoDFoWsQMQZid6NDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/e548aaaabd5751883afa40a5593034d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8y25e554uaQyD6nDiNARg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/9a5f04ebd5be034f2c70fdf17b3dc03d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pbo_AqytEqKmYWC8BNdcGg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/04d6706cdef34019c0d938191a74357f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yz4Qzk3ANBM4R9rvsKM79A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/c6cad83dec1eed4a1c1f745d443c72ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ks3KHUwvYojVQzRux3Mi0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="b259" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3: AdaBoost模型</h1><p id="581b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">接下来让我们讨论AdaBoost，它实际上是更一般的梯度增强模型的一个特例</p><h2 id="0343" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">3.1:统计模型的规格</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/53476c16f60bf8117ed5105f28caee23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UXug-YP7YNkrzXa4cP_Sw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="239f" class="mu la it bd lb mv mw dn lf mx my dp lj ma mz na ll me nb nc ln mi nd ne lp nf bi translated">3.2:安装程序</h2><p id="e778" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">根据<em class="no">第3.1节</em>中概述的信息和符号，让我们深入了解AdaBoost的安装程序</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/3869efb4379fad49764a641182ef191f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bsU8j_6cU36vytJ8k2hDDg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/9443922a686d866391e65690237f35d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UpWb1hiJoWUXaVVqTcYh0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="98e9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4:对于非参数可加模型，提升作为贪婪拟合过程的另一种观点/动机</h1><p id="ef39" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">从非参数加性模型的角度来看，有一个略微不同的观点。这是一个在数理统计和统计学习社区中被很好理解的观点，但是我很少在机器学习社区的计算机科学分支中看到这个观点。我认为这是一个值得理解的视角，并且提供了一个更健壮的关于Boosting作为一系列过程的观点。</p><p id="02f9" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">有一类统计模型称为非参数可加模型。这类估计量非常庞大，而且非常灵活。从某种意义上说，这类模型太灵活了。作为一名利用该类统计模型的分析师，有如此多的超参数和设计选项可供选择，指定一个“正确的”模型可能会让人不知所措。</p><p id="6502" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于一个给定的预测问题，有一些潜在的非参数加性模型，可以说在全局意义上“工作得最好”。这种“最佳”模式我们将称为“真正的NPA模式”。给定我们的样本数据，我们将尽最大努力指定和恢复这个“真正的NPA模型”。但是，如何以一种有条理的、切实可行的方式着手这样做呢？我们需要搜索的参数空间是巨大的！</p><p id="02d0" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">先打个比方吧。想象一下，我们有一个机器学习问题，我们正在利用线性回归来解决它。我们有100个特性可供选择，我们知道有一些真正的特性组合可以提供“最佳子集选择”线性回归模型。但是，我们将不得不测试2 ⁰⁰不同的模型，以恢复“最好的一个”，这是一个数百万亿的搜索空间。我们可以利用向前选择等贪婪算法，而不是试图在整个空间中搜索，在向前选择中，我们将选择一个变量，并每次将一个变量添加到最终模型中，根据贪婪的短视启发式方法做出选择。通过这种方法，我们只需要测试几千个模型，而不是数百万亿个。我们知道这种向前选择的过程不可能恢复“最佳子集选择”问题的<em class="no">精确</em>解；但它将恢复一个可能非常适合我们目的的模型。</p><p id="8f76" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">上面的前向选择场景非常类似于利用Boosting作为机器学习上下文中非参数可加模型的拟合过程。我们希望恢复对“真实NPA模型”的估计，但是搜索空间的大小令人难以承受。在这种意义上，Boosting可以被视为一系列贪婪算法过程，用于估计“真实NPA模型”问题的解决方案，类似于使用前向选择来估计最佳子集选择问题。</p><h1 id="4bb4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5:计算模拟</h1><p id="c1f2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下面是一个完整的工作示例(从头开始构建),在连续目标上拟合梯度增强模型，在二元分类目标上拟合AdaBoost模型。</p><p id="9836" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">首先，让我们加载我们需要的库:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b1e3" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">接下来，使用一个特意复杂的模型规范来模拟数据集的函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="a121" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">让我们恢复一个具有连续结果目标Y的模拟数据集，并拟合一个梯度推进模型。注意，我们将打印每个弱学习者添加到模型中的全局损失函数的经验实现。当经验损失&lt; 1.</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="331c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">Let’s now recover a simulated dataset with a binary categorical outcome target Y, and fit an AdaBoost Model. Note, we will print the empirical realization of the Global Loss function with each weak learner added to the model. We will consider the model to have converged when all n=1000 training points are correctly classified by the ensemble model.</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="0cf8" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">For the complete code/notebook for the above computational simulation, please see the following <a class="ae ky" href="https://github.com/atrothman/Gradient-Boosting-AdaBoost-Simulation" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> github链接</strong> </a>时，我们将认为模型已经收敛。</p><h1 id="b7ec" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">6:总结和结论</h1><p id="1680" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">希望以上有见地。正如我在以前的一些文章中提到的，我认为没有足够的人花时间去做这些类型的练习。对我来说，这种基于理论的洞察力让我在实践中更容易使用方法。我个人的目标是鼓励该领域的其他人采取类似的方法。以后我会继续写类似的作品。请<a class="ae ky" href="https://anr248.medium.com/" rel="noopener"> <strong class="lt iu">订阅并关注我在Medium </strong> </a>和LinkedIn<a class="ae ky" href="http://www.linkedin.com/in/andrew-rothman-49739630" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>上的更新！</p></div></div>    
</body>
</html>