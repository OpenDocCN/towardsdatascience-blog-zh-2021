<html>
<head>
<title>Automating AWS S3 File Management with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python自动化AWS S3文件管理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-aws-s3-file-management-with-python-6312e26dd771?source=collection_archive---------18-----------------------#2021-05-23">https://towardsdatascience.com/automating-aws-s3-file-management-with-python-6312e26dd771?source=collection_archive---------18-----------------------#2021-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2282" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何利用可编程性和Python来自动化管理您的AWS S3文件。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/993b413a994a7d2997365f031d16e5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xhkvws56RcHnYq9WlNjWGA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自Unsplash。</p></figure><p id="0b88" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">亚马逊网络服务(AWS) S3 是全球使用最多的<strong class="la iu">云存储平台</strong>之一。免费层包括5 GB的标准存储，20，000个get请求和2，000个put请求，为期12个月，这使其适合于在相对较短的<strong class="la iu">时间</strong>内运行的各种<strong class="la iu">中小型项目</strong>。一些项目可能需要频繁收集需要存储在云中的数据，我们可以利用<strong class="la iu">可编程性</strong>来自动管理这些文件，而不是手动管理这些文件。</p><p id="c659" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在今天的文章中，我将展示一些介绍性的<strong class="la iu">代码示例</strong>，介绍如何利用<a class="ae lu" href="https://docs.aws.amazon.com/AmazonS3/latest/API/Welcome.html" rel="noopener ugc nofollow" target="_blank"> AWS S3 API </a>并使用<strong class="la iu"> Python 3.8 </strong>和<a class="ae lu" href="https://pypi.org/project/boto3/" rel="noopener ugc nofollow" target="_blank"> boto3 </a>包自动化您的文件管理。</p><h2 id="af8a" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">1 |收集AWS S3 API信息</h2><p id="b81a" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">首先，我们将定义几个Python变量，这些变量将保存我们的AWS S3帐户的API和访问信息。</p><p id="b9f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">登录您的<a class="ae lu" href="https://s3.console.aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> AWS S3管理控制台</a>，通过您右上角的用户名打开下拉菜单，点击<a class="ae lu" href="https://console.aws.amazon.com/iam/home#/security_credentials" rel="noopener ugc nofollow" target="_blank"> <em class="mt">我的安全凭证</em> </a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/94f8a2e7814d0302ba3854268bf665d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxgNL9ts-nf_TEDfm9-Z4w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自AWS S3管理控制台的图像。</p></figure><p id="cc18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<em class="mt">访问密钥</em>下，您需要点击C <em class="mt">创建一个新的访问密钥</em>并复制您的访问密钥ID和您的秘密密钥。这两个变量将作为单独的变量添加到我们的Python代码中:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="7131" class="lv lw it mw b gy na nb l nc nd">aws_access_key = "###############"<br/>aws_secret_key = "###############"</span></pre><p id="6f4f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们需要创建我们的S3文件桶，我们将通过我们的API访问。在<a class="ae lu" href="https://s3.console.aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> S3管理控制台</a>上，导航至<em class="mt">桶</em>并点击<em class="mt">创建桶。</em></p><p id="be02" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建存储桶后，我们定义一个保存存储桶名称的变量:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="076e" class="lv lw it mw b gy na nb l nc nd">aws_bucket = "bucket-name"</span></pre><h2 id="8eec" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">2 |将文件上传到S3存储桶</h2><p id="bd57" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">在我们收集了AWS S3帐户的API和访问信息之后，我们现在可以开始使用Python和boto3包对我们的S3 bucket进行API调用。<a class="ae lu" href="https://pypi.org/project/boto3/" rel="noopener ugc nofollow" target="_blank"> boto3 </a>包是Python的官方AWS软件开发包(SDK)。</p><p id="ef33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们首先导入必要的包，并定义包含API和bucket信息的变量。然后，我们可以编写一个函数，让我们将本地文件上传到我们的bucket。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="7eb4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mt"> local_filename </em>参数保存了我们想要上传的本地文件的名称，而<em class="mt"> aws_filename </em>参数定义了当本地文件上传到我们的AWS S3存储桶时应该如何对其进行重命名。然后我们通过<em class="mt"> boto3.client </em>建立到AWS S3账户的连接，最后利用boto3函数<em class="mt"> upload_file </em>上传我们的文件。</p><h2 id="a8b3" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated"><strong class="ak"> 3 |从S3桶下载文件</strong></h2><p id="39d0" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">既然我们已经看到了如何将本地文件上传到我们的S3存储桶，我们还将定义一个函数来将文件下载到我们的本地机器。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="06ac" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">4 |列出S3存储桶中的文件</h2><p id="ab7e" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">除了上传和下载文件，我们还可以请求一个目前在我们的S3桶所有文件的列表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="e8cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出将是我们的bucket中所有文件名的Python列表。</p><h2 id="a795" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">5 |获取S3桶中文件的公共URL</h2><p id="77df" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">此外，我们可以请求生成一个可公开访问的URL，指向我们的bucket中的一个文件。如果我们想与外部人员自动共享文件，这将非常有用。</p><p id="a3b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了生成一个公共URL，我们还需要定义Python变量，这些变量包含我们的bucket的签名版本和我们的bucket的数据中心所在的区域名称。请相应地调整变量值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="d00e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个函数将返回一个我们文件的公共URL的Python字符串，这个字符串允许任何有链接的人访问它。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="d12e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望这篇用Python自动管理AWS S3文件的介绍对你有所帮助。💡我将在未来更新和添加新的代码示例，所以请随时回来更新。</p><p id="8b17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我知道你的想法，或者如果你有任何问题，请联系我或在下面评论。</p></div></div>    
</body>
</html>