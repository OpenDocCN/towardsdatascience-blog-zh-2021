<html>
<head>
<title>Online Experiments Tricks — Variance Reduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在线实验技巧——方差减少</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/online-experiments-tricks-variance-reduction-291b6032dcd7?source=collection_archive---------4-----------------------#2021-09-13">https://towardsdatascience.com/online-experiments-tricks-variance-reduction-291b6032dcd7?source=collection_archive---------4-----------------------#2021-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d1cf" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="60cc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated"><em class="kr">分层、CUPED、方差加权估计量和基于ML的方法CUPAC和MLRATE </em></h2></div><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/e6873880eae1e443aea3ba6f9297b242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OeiI-6IxaAvvmwLzdXST4A.jpeg"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@marekpiwnicki?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马雷克·皮尼基</a>在<a class="ae li" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="35b9" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated"><strong class="ak">为什么我们需要方差缩减？</strong></h1><p id="ce13" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">当我们进行在线实验或A/B测试时，我们需要确保我们的测试具有很高的统计功效，以便我们有很高的概率发现实验效应(如果它确实存在的话)。有哪些因素可能会影响权力？样本大小、实验度量的采样方差、显著性水平α和效应大小。</p><p id="7bd1" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">提高功效的标准方法是增加样本量。然而，动态范围是有限的，因为最小可检测效应MDE与1/sqrt(sample_size)成比例。此外，在现实中，获取更多的样本或运行更长时间的实验来增加样本量可能并不总是容易或可行的。</p><p id="c3cb" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">我们能做的下一个最好的事情是减少实验指标的抽样方差。人们可以做的最简单的事情就是转换度量标准。Winsorize、binarize或其他更复杂的度量转换将有助于显著减少差异。然而，度量转换会引入偏差。所以这种方法有一个偏差-方差权衡。</p><p id="55c6" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">许多其他方差减少方法在技术产业中被开发和生产，以提高实验的灵敏度/功效。在本文中，我将介绍一些流行的方差缩减方法，并用Python演示一些简单的例子:</p><ul class=""><li id="39d9" class="nc nd it md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated"><strong class="md jd">分层和后分层</strong></li><li id="c255" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md jd"> CUPED </strong>(使用预实验数据的受控实验)</li><li id="394d" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md jd">方差加权估值器</strong></li></ul><p id="e575" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">基于ML的方法:</p><ul class=""><li id="27d9" class="nc nd it md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated"><strong class="md jd"> CUPAC </strong>(使用预测作为协变量的控制)</li><li id="021d" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md jd"> MLRATE </strong>(机器学习回归调整治疗效果估计器)</li></ul><h1 id="815e" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated"><strong class="ak">分层</strong></h1><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nq"><img src="../Images/24374848ebed4da49d9acef62d60cbbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J8zjvPFHFXLzz8S-"/></div></div></figure><p id="c4af" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">分层抽样将人口分成k个阶层(例如，国家)，然后实验从每个阶层独立地随机抽样个体。设Y_strat为分层抽样下的处理效果，p_k表示来自k层的样本量比例，下面的等式告诉我们，处理效果是各层处理效果的汇集平均值，是无偏的。方差是层内方差的加权平均值，并且有效地去除了层间方差。方差小于简单随机抽样下的方差，简单随机抽样既包括层内方差，也包括层间方差(更多信息见本<a class="ae li" href="https://www.kdd.org/kdd2016/papers/files/adp0945-xieA.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>)。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/5101800e94b425e1ac050df5f969501d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/0*wjyQs-sJIw7-grCt"/></div></figure><h2 id="15b4" class="ns lk it bd ll nt nu dn lp nv nw dp lt mk nx ny lv mo nz oa lx ms ob oc lz iz bi translated"><strong class="ak"> <em class="kr">利弊</em> </strong></h2><p id="032c" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">分层方法提供了治疗效果的无偏估计，并有效地消除了层间差异。然而，在实践中，通常很难在实验前实施分层抽样。</p><blockquote class="od oe of"><p id="8910" class="mb mc og md b me mx kd mg mh my kg mj oh mz mm mn oi na mq mr oj nb mu mv mw im bi translated">“在网络世界中，由于我们是随着时间的推移收集数据，我们通常无法从提前形成的地层中取样。”(邓、徐、科哈维和沃克，2013年)</p><p id="11f8" class="mb mc og md b me mx kd mg mh my kg mj oh mz mm mn oi na mq mr oj nb mu mv mw im bi translated">实际上，实施分层抽样既复杂又昂贵。它“需要一个排队系统和多台机器的使用。”(谢和奥里塞特，2016年)</p></blockquote><h2 id="b891" class="ns lk it bd ll nt nu dn lp nv nw dp lt mk nx ny lv mo nz oa lx ms ob oc lz iz bi translated"><strong class="ak"> <em class="kr">后期分层</em> </strong></h2><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ok"><img src="../Images/0a3b849915ae7141147175666144534c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pIj3JA8zlR7tiBb8"/></div></div></figure><p id="5f89" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">在实践中，后分层比分层更常见。后分层首先对人口进行随机抽样，然后将个人分成不同的阶层。类似于分层，后分层可以实现类似的方差减少。</p><p id="fdc4" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">这里有一个非常简单的例子，我们从四个不同的正态分布(4层)中生成数据，将个体随机分配到治疗组和对照组，将治疗效果添加到治疗组，并通过bootstrapping可视化治疗效果。治疗效果计算为无分层的治疗和对照之间的平均差异，以及有分层的每个层的平均差异的平均值。从我们的简单例子中，我们确实看到了分层的方差减少。至关重要的是，平均值没有变化，所以我们应该能够更好地看到任何实验对平均值的影响，因为方差已经减小了。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi on"><img src="../Images/78978efdcbd6bd4bb3e361eb17574d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7N9dDxqaVIOi0iMW"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated"><em class="kr">有无分层的治疗效果</em></p></figure><h1 id="a8f5" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated"><strong class="ak">杯状</strong></h1><p id="8d94" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">CUPED (使用预实验数据的受控实验)由微软的亚历克斯·邓、徐亚、罗恩·科哈维和托比·沃克于2013年首次提出，并已被广泛应用于大型科技公司，如bookings.com的<a class="ae li" href="https://www.kdd.org/kdd2016/papers/files/adp0945-xieA.pdf" rel="noopener ugc nofollow" target="_blank"/>、<a class="ae li" href="https://booking.ai/how-booking-com-increases-the-power-of-online-experiments-with-cuped-995d186fff1d" rel="noopener ugc nofollow" target="_blank"/>、<a class="ae li" href="https://www.tripadvisor.com/engineering/reducing-a-b-test-measurement-variance-by-30/" rel="noopener ugc nofollow" target="_blank">猫途鹰</a>等。CUPED使用预实验数据X(例如，Y的预实验值)作为控制协变量:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi oo"><img src="../Images/02ccb6c21e19dfa022eb2ea2aafc4f70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ib5g0xgoCjnx0nIk"/></div></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi op"><img src="../Images/cca94874d67ffed6c6c18d6c075d6eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Dj1_Cs70PrgsJbfM"/></div></div></figure><p id="248e" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">换句话说，Y的方差减少了(1-Corr(X，Y))。我们需要X和Y之间的相关性很高，CUPED才能很好地工作。在原论文中，推荐使用Y的预实验值作为x。</p><p id="2a81" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">这是一个抽样的例子。我们看到，对照组和治疗组的Y的方差都降低了，Y_cuped和Y的方差之比为0.2789，这与基于上述理论方程的(1-Corr(X，Y))值相同。减少方差会减少这两个分布之间的重叠，从而更容易看到实验效果。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi oq"><img src="../Images/aef3bd9033376d33188a466c5b063875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vsUU1d5T5hF4OAen"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated">【CUPED调整前后Y的方差</p></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi or"><img src="../Images/32c1d3848aba97d4f26a6c35cb70a075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*it87kVWht8Mmb84u"/></div></div></figure><p id="5f64" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">这里我们多次模拟我们的实验，计算对照组和治疗组的均值差，得到治疗效果的分布。请注意，Y_cuped不是Y的无偏估计量。但Y_cuped的平均差是Y的平均差的无偏估计量。根据下图，很明显，在我们的简单情况下，cuped降低了我们处理的方差。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi os"><img src="../Images/cb290be67fedcd113c2984fd28e29f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7j62af9lriCpQ8dI"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated"><em class="kr">带和不带吸盘调节的治疗效果</em></p></figure><h2 id="756f" class="ns lk it bd ll nt nu dn lp nv nw dp lt mk nx ny lv mo nz oa lx ms ob oc lz iz bi translated"><strong class="ak"> <em class="kr">利弊</em> </strong></h2><p id="f104" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">CUPED非常容易使用和实现。然而，协变量的选择可能是棘手的，尤其是当目标变量的实验前测量不可用时。协变量必须与目标测量相关，但与实验无关。此外，原始论文没有经历有多个协变量的情况。这篇<a class="ae li" href="https://j-sephb-lt-n.github.io/exploring_statistics/cuped_cupac_and_other_variance_reduction_techniques.html#controlvariates" rel="noopener ugc nofollow" target="_blank">博文</a>讲述了从一个协变量到多个协变量的代数扩展。另一种解决方案是使用ML来构造控制变量，我们将在后面讨论。</p><h1 id="6ed8" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated">方差加权估计量</h1><p id="ea35" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">方差加权估计法是由脸书和Lyft的Kevin Liou和Sean Taylor于2020年提出的。该方法的主要思想是给予具有较低预实验方差的用户更多的权重。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ot"><img src="../Images/a1d2225f211d852c71debae7587f60ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a-CU_uXQDy152q-f"/></div></div></figure><p id="90df" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">这种方法放松了同方差假设，而是假设每个个体都有自己的度量方差。例如，上图显示了两个人，其中一个(绿线)比另一个(蓝线)具有更高的方差。</p><p id="4dc3" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">在下面的等式中，Y是感兴趣的度量，δ是治疗效果，Z是治疗的指示函数。为了最小化治疗效果的方差，我们通过方差的倒数对每个用户进行加权。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/b004c563a6007feb4703b5ddc3437e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/0*9KenRS_cWlPpfbpj"/></div></figure><p id="74f4" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">与CUPED类似，方差加权估计也使用预实验数据。文中提到了几种估计方差的方法，包括利用预实验时间序列数据的经验方差，建立ML模型，以及利用经验Bayes估计量。最简单的方法是使用经验方差。</p><p id="ddda" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">加权诱导偏差。为了减少偏倚，本文提出了一种基于用户实验前方差对用户进行分组的方法，计算每个分组内治疗效果和实验前方差的平均值，然后计算跨层的加权治疗效果。</p><p id="0592" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">因此，总的来说，在实践中，我们将估计方差，将方差分成k个层，通过方差的倒数对每个层进行加权，并计算加权处理效果。</p><p id="d71b" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">这里有一个演示这种方法的非常简单的例子。我从四个层次开始，我们知道每个层次的度量方差。然后，我们可以用每一层的方差倒数来衡量处理效果。对于本例，除了分层方法之外，方差加权估计量还提供了方差减少的额外好处。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ov"><img src="../Images/b3ff73565e30673ca69d850fe8594f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B4GdY-r749cCYB_R"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated"><em class="kr">使用和不使用方差加权估计量的处理效果</em></p></figure><h2 id="601a" class="ns lk it bd ll nt nu dn lp nv nw dp lt mk nx ny lv mo nz oa lx ms ob oc lz iz bi translated"><strong class="ak"> <em class="kr">利弊</em> </strong></h2><ul class=""><li id="31bc" class="nc nd it md b me mf mh mi mk ow mo ox ms oy mw nh ni nj nk bi translated">方差加权估计量将单个预试验方差建模为权重，它可以用作CUPED等其他方法的良好扩展。当用户之间存在高度倾斜的差异时，以及当治疗前差异是治疗后差异的良好指标时，它工作得很好。</li><li id="f10c" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">然而，当预处理方差的方差较低或者当实验前和实验后方差不一致时，方差加权估计器可能不起作用。此外，方差加权估计量不是无偏的。管理偏倚对这种方法很重要。</li></ul><h1 id="d883" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated"><strong class="ak">基于ML的方法</strong></h1><p id="df05" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">近年来发展了几种基于最大似然的方差缩减方法。我将简要介绍两种基于ML的方法——CUPAC和MLRATE。由于原始论文没有描述精确的算法和它们的ML模型的细节，我将只涉及我对高级思想的理解，而不展示这些方法的例子。</p><h1 id="c32f" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated">CUPAC </h1><p id="4053" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated"><a class="ae li" href="https://doordash.engineering/2020/06/08/improving-experimental-power-through-control-using-predictions-as-covariate-cupac/" rel="noopener ugc nofollow" target="_blank"> CUPAC </a>(使用预测作为协变量的控制)是由Doordash的Jeff Li，和Jared Bauman在2020年提出的。它是CUPED的延伸。CUPAC没有选择与治疗无关的实验前协变量X，而是使用机器学习模型的结果作为其控制变量。机器学习模型的目标是“最大化预测协变量(CUPAC)和目标度量之间的部分相关性”。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi oz"><img src="../Images/635030ea2e54d3960b0dfa9775e916fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wFsEA-lQayM0X06_t80G5Q.png"/></div></div></figure><p id="702a" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">假设我们有实验前指标，X1、X2、X3和X4。本质上，这种方法所做的是使用一些机器学习模型来预测Y使用X1，X2，X3和X4。然后，我们可以使用预测值作为CUPED中的控制协变量。</p><h1 id="33ed" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated"><strong class="ak"> MLRATE </strong></h1><p id="4d46" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">ml rate(machine learning regression-adjusted treatment effect estimator)是由和Princeton的郭等人于2021年提出的。</p><p id="0357" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">和CUPAC类似，MLRATE也是用一个ML模型从X预测Y，我们把预测值叫做g(X)。MLRATE不是从Y中减去g(X ),而是在回归模型中包括g(X)和治疗指标，然后计算回归调整的治疗效果。下图展示了这种回归模型:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi pa"><img src="../Images/01b7e573102bb0492540ddb6e7ee13cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FZBHn5GVEJGrvhsC"/></div></div></figure><ul class=""><li id="e9a7" class="nc nd it md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated">首先，我们从协变量的向量或协变量x的矩阵开始，然后我们学习并应用交叉拟合监督学习算法。交叉拟合用于避免过度拟合偏差。交叉拟合过程如下:我们将数据分成k份。对于每个分裂，我们在不在当前分裂中的样本上训练我们的数据，并获得函数g。然后，我们使用当前分裂中的X，并获得当前分裂的g(X)的预测值。</li><li id="3e6a" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">接下来，我们建立一个回归模型，其中我们用回归变量预测实验指标Y:T—治疗指标，g(X) —交叉拟合ML的预测值，以及T(g(x)-g)。</li><li id="ee00" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">α1的OLS估计量是我们感兴趣的治疗效果。</li></ul><h2 id="a40c" class="ns lk it bd ll nt nu dn lp nv nw dp lt mk nx ny lv mo nz oa lx ms ob oc lz iz bi translated"><strong class="ak">其他基于ML的方法</strong></h2><p id="8b08" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">业内使用的基于ML的方法还有其他的<strong class="md jd"> </strong>。例如，Yandex的波亚尔科夫等人在2016年开发了<a class="ae li" href="https://www.kdd.org/kdd2016/papers/files/adf0653-poyarkovA.pdf" rel="noopener ugc nofollow" target="_blank">增强决策树回归调整</a>。</p><p id="2a67" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">总之，本文总结了一些业界流行的方差缩减方法——后分层法、CUPED法、方差加权估计法以及基于ML的方法CUPAC和MLRATE。在实践中，CUPED在科技公司中被广泛使用和生产，基于ML的方法通常用于合并多个协变量。结合多种方法来实现最佳方差减少也是常见的。希望这篇文章对你有所帮助。谢谢！</p><p id="4a9b" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated"><strong class="md jd">鸣谢</strong>:非常感谢Anthony Fu和Jim Bednar为本文提供指导和反馈。感谢Kevin Liou和Sean Taylor澄清了我关于方差加权估计量的问题。</p><p id="90c6" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated"><strong class="md jd">参考文献</strong></p><ul class=""><li id="430f" class="nc nd it md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated"><a class="ae li" href="https://exp-platform.com/Documents/2013-02-CUPED-ImprovingSensitivityOfControlledExperiments.pdf" rel="noopener ugc nofollow" target="_blank">https://exp-platform . com/Documents/2013-02-CUPED-improvingsensitivity of controlled experiments . pdf</a><a class="ae li" href="https://www.kdd.org/kdd2016/papers/files/adp0945-xieA.pdf" rel="noopener ugc nofollow" target="_blank">https://www.kdd.org/kdd2016/papers/files/adp0945-xieA.pdf</a></li><li id="7c35" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://www.kdd.org/kdd2016/papers/files/adp0945-xieA.pdf" rel="noopener ugc nofollow" target="_blank">https://www.kdd.org/kdd2016/papers/files/adp0945-xieA.pdf</a></li><li id="e7cd" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://booking.ai/how-booking-com-increases-the-power-of-online-experiments-with-cuped-995d186fff1d" rel="noopener ugc nofollow" target="_blank">https://booking . ai/how-booking-com-increases-the-power of-online-experiments-with-cuped-995d 186 fff1d</a></li><li id="9f41" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://www.tripadvisor.com/engineering/reducing-a-b-test-measurement-variance-by-30/" rel="noopener ugc nofollow" target="_blank">https://www . tripadvisor . com/engineering/reducing-a-b-test-measurement-variance-by-30/</a></li><li id="969b" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://medium.com/bbc-data-science/increasing-experiment-sensitivity-through-pre-experiment-variance-reduction-166d7d00d8fd" rel="noopener">https://medium . com/BBC-data-science/increasing-experiment-sensitivity-through-pre-experiment-variance-reduction-166d 7d 00 D8 FD</a></li><li id="9364" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://doordash.engineering/2020/06/08/improving-experimental-power-through-control-using-predictions-as-covariate-cupac/" rel="noopener ugc nofollow" target="_blank">https://door dash . engineering/2020/06/08/improving-experimental-power-through-control-using-predictions-as-co variate-cupac/</a></li><li id="3a60" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://codeascraft.com/2021/06/02/increasing-experimentation-accuracy-and-speed-by-using-control-variates/" rel="noopener ugc nofollow" target="_blank">https://code ascraft . com/2021/06/02/通过使用控制变量提高实验精度和速度/ </a></li><li id="e54b" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">https://dl.acm.org/doi/10.1145/3391403.3399542<a class="ae li" href="https://dl.acm.org/doi/10.1145/3391403.3399542" rel="noopener ugc nofollow" target="_blank"/></li><li id="9132" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">【https://www.youtube.com/watch?v=kgIwougeN0M T4】</li><li id="7f71" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://www.kdd.org/kdd2016/papers/files/adf0653-poyarkovA.pdf" rel="noopener ugc nofollow" target="_blank">https://www . KDD . org/KDD 2016/papers/files/ADF 0653-poyarkova . pdf</a></li><li id="be0a" class="nc nd it md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://arxiv.org/abs/2106.07263" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/2106.07263</a></li></ul><p id="8744" class="pw-post-body-paragraph mb mc it md b me mx kd mg mh my kg mj mk mz mm mn mo na mq mr ms nb mu mv mw im bi translated">作者索菲亚·杨2021年9月12日</p></div></div>    
</body>
</html>