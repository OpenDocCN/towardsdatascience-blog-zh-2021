<html>
<head>
<title>How to Deploy a Machine Learning Model with FastAPI, Docker and Github Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用FastAPI、Docker和Github动作部署机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-deploy-a-machine-learning-model-with-fastapi-docker-and-github-actions-13374cbd638a?source=collection_archive---------0-----------------------#2021-07-11">https://towardsdatascience.com/how-to-deploy-a-machine-learning-model-with-fastapi-docker-and-github-actions-13374cbd638a?source=collection_archive---------0-----------------------#2021-07-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b2ea" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">具有CI/CD的端到端管道</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/96f4baaeedb5f84bf9d5e0b768a937c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ydc5IAtan9qiOXyD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="819e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你是一名数据科学家，在一家软件公司工作。</p><p id="32ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您刚刚训练了一个模型，您对它很满意，因为它在您的本地交叉验证中表现很好。</p><p id="8c3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是将该模型投入生产的时候了，以便您组织中的其他团队可以使用它并将其嵌入到他们的应用程序中。</p><p id="50e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是数据科学家面临的非常普遍的情况。管理起来既麻烦又痛苦，但是使用正确的工具，这个过程可以顺利进行。</p><blockquote class="lv lw lx"><p id="c4b3" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">在本教程中，我将展示一个端到端的用例来解释将模型投入生产的工作流程。这是一篇相对较长的文章，所以请随意跳到你感兴趣的部分。</strong></p></blockquote><p id="a703" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我们将要介绍的内容:</p><ol class=""><li id="bf8b" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated"><strong class="lb iu">生产机器学习和API简介</strong></li><li id="9282" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated"><strong class="lb iu">FastAPI特性的快速概述</strong></li><li id="6d1c" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated"><strong class="lb iu">使用FastAPI和SpaCy构建推理API </strong></li><li id="2c49" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated"><strong class="lb iu">用Docker和docker-compose封装API</strong></li><li id="3f97" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated"><strong class="lb iu">将API部署到AWS EC2，并使用Github Actions CI/CD自动化流程</strong></li></ol><p id="bd9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你准备好了。事不宜迟，让我们直接开始吧🚀。</p><p id="8ef2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly"> PS:所有代码在</em><a class="ae ky" href="https://github.com/ahmedbesbes/anonymization-api" rel="noopener ugc nofollow" target="_blank"><em class="ly">Github</em></a><em class="ly">上都有。</em></p><blockquote class="lv lw lx"><p id="b667" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">新到中？你可以每月订阅5美元，解锁我写的不限数量的关于编程、MLOps和系统设计的文章，以帮助数据科学家(或ML工程师)编写更好的代码。</p></blockquote><div class="mq mr gp gr ms mt"><a href="https://medium.com/membership/@ahmedbesbes" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">加入我的介绍链接媒体-艾哈迈德贝斯</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">阅读Ahmed Besbes的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ks mt"/></div></div></a></div></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="6b98" class="np nq it bd nr ns nt nu nv nw nx ny nz jz oa ka ob kc oc kd od kf oe kg of og bi translated">将模型投入生产意味着什么？</h1><p id="a5a7" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">在我们更进一步之前，让我们从一个共同点开始。</p><p id="d6b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从广义上来说，不涉及很多细节，将模型投入生产是一个过程，在这个过程中，模型被集成到现有的IT环境中，并可供其他团队使用和消费。</p><p id="cb46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使这个过程尽可能高效，应该仔细管理许多步骤:数据存储、服务、工件记录、资源管理等等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/e35a0ce316377d2104f7cfc6763d7977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*78KXcOnJGz-JR41M.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作和修改的图像</p></figure><p id="db56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你的模型从未离开过你的本地电脑，而你所有的实验都在jupyter笔记本上，那么你很可能还没有准备好投入生产。</p><p id="e2d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不过不用担心。本教程旨在帮助您开始使用API将模型投入生产。</p><h1 id="dabe" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">API到底是什么？</h1><p id="bc39" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">是<strong class="lb iu"> A </strong>应用程序<strong class="lb iu"> P </strong>编程<strong class="lb iu"> I </strong>接口的简称。它只是两个相互通信的独立应用程序之间的中介。</p><p id="dd5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您是一名开发人员，并且希望您的应用程序可供其他开发人员使用和集成，您可以构建一个API作为您的应用程序的入口点。因此，开发人员必须通过HTTP请求与该API进行通信，以使用您的服务并与之交互。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/de9cb44557a375514f62a8a7241366cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Lt3eBssWFfyhJCCD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f644" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将API视为应用程序的抽象(用户看不到你的代码，也不安装任何东西，他们只是调用API)和与第三方(开发者、应用程序、其他API等)集成的简化。)</p><p id="8407" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API无处不在。数据科学世界也不例外。</p><h1 id="7295" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">什么是FastAPI，为什么它适合生产机器学习？</h1><p id="cdb0" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">FastAPI目前是构建可在生产环境中伸缩的健壮的高性能API的首选框架。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/84658d78496d9b999e72cfeb26e26fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qyVqV1nrBZeG6aVW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图—<a class="ae ky" href="https://fastapi.tiangolo.com" rel="noopener ugc nofollow" target="_blank">https://fastapi.tiangolo.com</a></p></figure><p id="eebf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FastAPI最近越来越受欢迎，用户在web开发人员、数据科学家和ML工程师中的采用率大幅上升。</p><p id="9c28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我通过展示我能想到的最有趣的特性来解释围绕这个框架的所有宣传。</p><p id="af4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将转到在特定用例中使用FastAPI的部分。</p><p id="281e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly"> PS:这个列表并不详尽，如果你想有一个全局的概述，你可以参考</em> <a class="ae ky" href="https://fastapi.tiangolo.com/features/" rel="noopener ugc nofollow" target="_blank"> <em class="ly">官方</em> </a> <em class="ly">文档。</em></p><h2 id="7925" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">1)简单的语法</h2><p id="d98b" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">FastAPI的语法很简单，这使得它使用起来很快。它实际上类似于Flask的语法:因此，如果您正在考虑从Flask迁移到FastAPI，迁移应该很容易。</p><p id="f000" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实例化Flask和FastAPI应用程序是一样的。然而，与Flask不同，FastAPI没有集成web服务器。FastAPI是专门为构建API而设计的。它没有责任为他们服务。</p><p id="02ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FastAPI做一件事，而且做得很好。</p><p id="63e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务API是uvicorn的责任，这是一个很好的选择，因为uvicorn是一个使用<a class="ae ky" href="https://github.com/MagicStack/uvloop" rel="noopener ugc nofollow" target="_blank"> uvloop </a>和<a class="ae ky" href="https://github.com/MagicStack/httptools" rel="noopener ugc nofollow" target="_blank"> httptools </a>的闪电般快速的ASGI服务器实现。</p><p id="9e2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">烧瓶:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="c20c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> FastAPI: </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="988b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">在两个库中，为HTTP </strong>请求定义路由和附加处理程序遵循相同的语法。你用<a class="ae ky" href="https://realpython.com/primer-on-python-decorators/" rel="noopener ugc nofollow" target="_blank">装修工</a>。</p><p id="8a99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FastAPI的语法甚至更简单:每个特定的HTTP请求都有一个装饰器，不像Flask将请求类型作为参数传递给route装饰器。</p><p id="a484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">烧瓶:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="1321" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> FastAPI: </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="52df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Flask和FastAPI中，path <strong class="lb iu">参数都是从我们传递给route </strong>的路径中解析出来的。对于FastAPI，我们将这些参数作为参数添加到函数中。我个人认为FastAPI在这种特殊情况下的语法更容易阅读和理解。</p><p id="82ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">烧瓶:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="c8b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> FastAPI: </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="4606" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在FastAPI 中提取查询参数要容易得多:您只需将它们作为处理程序的参数，FastAPI会处理剩下的事情:它从route中解析它们，并将它们转换成您指定的类型。</p><p id="4167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用Flask时，您必须调用<code class="fe pi pj pk pl b">request</code>类，单独获取每个参数并应用一些最终的后处理。</p><p id="82a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">烧瓶:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="c8cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> FastAPI: </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="7db2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要快速了解FastAPI的语法，请看这个<a class="ae ky" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><h2 id="6709" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">2)一个超快的<em class="pm">框架</em></h2><p id="45a4" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">根据独立网站techempower的说法，FastAPI+uvicon是最快的网络服务器之一。</p><p id="5815" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个执行基本任务的性能比较，比如JSON序列化、数据库访问和服务器端模板合成。每个框架都在现实的生产配置中运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/2601c106f6136bd24abea593e6c074c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pg9hk7JQFbhuP52m"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://techempower.com" rel="noopener ugc nofollow" target="_blank">https://techempower.com</a></p></figure><h2 id="c5dc" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">3)异步请求</h2><p id="7f85" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">FastAPI带来了以前的web框架如Flask和Django所缺乏的新特性:<strong class="lb iu">异步请求。</strong></p><p id="2215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">异步编程是一种编程模式，它使代码能够独立于主应用程序线程运行。异步编程在许多用例中使用，例如事件驱动的系统、高度可伸缩的应用程序以及I/O绑定的任务，例如通过网络读写文件。</p><p id="9006" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果在处理程序中使用异步函数，那么在调用该函数之前，必须将<code class="fe pi pj pk pl b">async</code>添加到处理程序中，并添加<code class="fe pi pj pk pl b">await</code>参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="3cc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里了解更多关于异步编程的知识。</p><h2 id="14b9" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated"><strong class="ak"> 4)使用Pydantic的现代python类型</strong></h2><p id="9d8a" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">FastAPI与Pydantic集成在一起，用标准的python类型对请求和响应主体进行类型化。</p><p id="14a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这在运行时强制验证，并通过允许您的IDE正确地自动完成并检测与类型相关的错误来提高您的编码效率。</p><p id="1910" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的例子中，我们设计了一个小的API来发布工作申请并接收随机的决定。请求体遵循Application类中定义的模式。它仅仅意味着它必须具有:</p><ul class=""><li id="56c1" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">类型为<strong class="lb iu">字符串</strong>的<code class="fe pi pj pk pl b">first_name</code>键</li><li id="d90b" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">类型为<strong class="lb iu">字符串</strong>的<code class="fe pi pj pk pl b">last_name</code>键</li><li id="e98e" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">一个类型为<strong class="lb iu"> int </strong>的<code class="fe pi pj pk pl b">age</code>键</li><li id="fe32" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">类型为<strong class="lb iu">字符串</strong>的<code class="fe pi pj pk pl b">degree</code>键</li><li id="9f04" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">一个<strong class="lb iu">可选的</strong>类型的<code class="fe pi pj pk pl b">interest</code>键<strong class="lb iu">字符串</strong></li></ul><p id="d027" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，您可以使用决策类中定义的模式键入API响应。</p><p id="74ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这有什么用呢？</p><p id="6adc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您不小心向first_name字段传递了一个整数。FastAPI将检测类型不匹配，并相应地引发错误。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="906e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里了解更多关于Pydantic <a class="ae ky" href="https://fastapi.tiangolo.com/tutorial/body/" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h2 id="4842" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">5)字符串查询参数的验证</h2><p id="ec7b" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">FastAPI允许通过在字符串查询参数上添加约束来验证用户输入。例如，您可以设置最大或最小长度，或者设置查询必须匹配的正则表达式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="e277" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里了解更多关于字符串验证<a class="ae ky" href="https://fastapi.tiangolo.com/tutorial/query-params-str-validations/" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h2 id="cac8" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">6)数值参数的验证</h2><p id="f703" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">同样，当使用数字参数时，您可以通过使用<code class="fe pi pj pk pl b">gt</code>(大于)和<code class="fe pi pj pk pl b">le</code>(小于或等于)来设置一个范围作为约束。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="54de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里了解更多关于数字验证的信息。</p><h2 id="49bc" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">7)更好的错误处理和自定义消息</h2><p id="cda4" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">使用FastAPI，您可以用特定的消息和状态代码来定义和引发自定义错误。这有助于其他开发人员在使用您的API时轻松理解错误并进行调试。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="b931" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里了解更多关于错误处理<a class="ae ky" href="https://fastapi.tiangolo.com/tutorial/handling-errors/" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h2 id="5904" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">8)遵循OpenAPI标准的自动文档生成</h2><p id="63eb" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">一旦您开始使用FastAPI，就会自动为您生成交互式API文档和探索。</p><p id="ecd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本地启动API后，您可以通过此链接<code class="fe pi pj pk pl b"><a class="ae ky" href="http://localhost:8000/docs" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/docs</a></code>访问它。</p><p id="92d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将看到您创建的每条路由的文档，以及一个交互式界面，您可以直接从浏览器测试每个端点。</p><div class="kj kk kl km gt ab cb"><figure class="pp kn pq pr ps pt pu paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/25c2cd9507e2b3e0cc49b66b0b0485f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/0*aihtA0C68ZpLbD9p"/></div></figure><figure class="pp kn pv pr ps pt pu paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/3b35278ed5c982c5f29618157f631428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*ChsMl5mmVK5EPz9b"/></div><p class="ku kv gj gh gi kw kx bd b be z dk pw di px py translated">作者提供的图片</p></figure></div><h2 id="dc80" class="ou nq it bd nr ov ow dn nv ox oy dp nz li oz pa ob lm pb pc od lq pd pe of pf bi translated">9)世界一流的文档，学习并开始使用框架</h2><p id="b28d" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">我很少见过如此完整且易于理解的文档。由<a class="pz qa ep" href="https://medium.com/u/963974981597?source=post_page-----13374cbd638a--------------------------------" rel="noopener" target="_blank">塞巴斯蒂安·拉米雷斯</a>领导的FastAPI团队已经完成了记录每一段代码的惊人工作。</p><p id="5097" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里开始学习如何使用FastAPI<a class="ae ky" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"/>，坦白地说，没有更好的选择了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/7e17693f5478b440049536ae91b167d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rODSsMqHVBhwLZiD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="16e1" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">使用FastAPI和Spacy创建匿名化API</h1><p id="7253" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">让我们进入有趣的部分。</p><p id="90b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我之前的一篇<a class="ae ky" rel="noopener" target="_blank" href="/how-to-build-and-deploy-a-text-anonymizer-with-spacy-and-streamlit-70ed9607823">帖子</a>中，我构建了一个Streamlit应用程序，它通过检测带有空间模型的命名实体来匿名化文本。要使用这个应用程序，你必须打开一个浏览器并与用户界面互动。</p><p id="b075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，</p><blockquote class="lv lw lx"><p id="cddf" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">如果我们可以创建一个API端点来做同样的事情，这样开发人员就可以在不使用UI的情况下轻松地与这个程序进行交互，会怎么样？</strong></p></blockquote><p id="35b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这看起来像是FastAPI的完美工作。</p><p id="eede" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的图表代表了我们将要构建的API的模式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qb"><img src="../Images/9931fa13f833e88f497044046d744cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnyb5S1fzfgEE_8cM5FmPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="38d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将只定义一个路由，它将接受路径<code class="fe pi pj pk pl b">/entities</code>上的POST请求，并且它将期望一个包含三个字段的请求体:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qc"><img src="../Images/b85273b20dd90efd0a70dc6502555d63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rmygcrP1MbIjVoY4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="8257" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated"><strong class="lb iu">文本</strong>:要匿名的文本</li><li id="fc7f" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated"><strong class="lb iu">model _ size</strong>:NER模型的尺寸(默认为“sm”)</li><li id="2608" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated"><strong class="lb iu">model _ language</strong>:NER车型的语言(默认为“en”)</li></ul><p id="4f2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为输出，API将返回一个包含两个键的JSON对象:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/68a5e10ba81b9a1681163f25d32820f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WlOpoW4VqRW1kR9v"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="d812" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated"><strong class="lb iu">实体:</strong>提取的实体列表。每个实体是一个JSON，包含四个键(<strong class="lb iu"> start </strong>:文本中实体的起始索引，<strong class="lb iu"> end </strong>:结束索引，<strong class="lb iu"> type </strong>:实体的类型，<strong class="lb iu"> text </strong>:实体的值)</li><li id="1bd5" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated"><strong class="lb iu">匿名化_文本:</strong>将实体匿名化的原始输入文本</li></ul><p id="2362" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了设置请求和响应体的类型，我们将使用<strong class="lb iu"> Pydantic。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><ul class=""><li id="e2dc" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">对于请求的主体，我们将<code class="fe pi pj pk pl b">UserRequestIn</code>定义为BaseModel类的子类。它会有三个属性:<code class="fe pi pj pk pl b">text,</code> <code class="fe pi pj pk pl b">model_language</code>和<code class="fe pi pj pk pl b">model_size</code>。<br/>我本可以将<code class="fe pi pj pk pl b">model_language</code>和<code class="fe pi pj pk pl b">model_size</code>的类型设置为string，但是，为了本教程，我为它们定义了两个类:ModelLanguage和ModelSize。这两个类继承自<code class="fe pi pj pk pl b">str</code>和<code class="fe pi pj pk pl b">Enum</code>。使用Enum的想法是限制每个字段的可能值。对于语言，我们只需要英语(“en”)和法语(“fr”)，对于大小，我们需要三个可能的值(“sm”表示小，“md”表示中，“lg”表示大)。</li><li id="5dea" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">至于响应的主体，我们定义了<code class="fe pi pj pk pl b">EntitiesOut</code>类，再次作为BaseModel的子类。如前面的响应主体截图所示，它将有两个键:<strong class="lb iu">实体</strong>和<strong class="lb iu">anonymous ized _ text。</strong><br/><strong class="lb iu">anonymous _ text</strong>是一个字符串，而<strong class="lb iu"> entities </strong>是一列<strong class="lb iu"> EntityOut </strong>对象。EntityOut只是一个BaseModel类，表示每个实体的模式:它有四个字段:start (int)、end (int)、type (str)和text (str)。</li></ul><p id="47df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，使用Pydantic为您的请求和响应构建定制类型非常直观。通过组合其他复杂类型，你可以变得更有创造力。</p><p id="bbb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然已经创建了数据模型，我们就可以开始构建API了:首先，我们用Spacy加载语言模型。这些模型将保存在<code class="fe pi pj pk pl b">ml/models/</code>文件夹中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="1855" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将定义API路由和处理程序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="adad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里发生了一些事情:</p><ul class=""><li id="16ba" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">在装饰器<code class="fe pi pj pk pl b">@app.post</code>中，我们将路径设置为<code class="fe pi pj pk pl b">entities/</code>，并将<code class="fe pi pj pk pl b">response_model</code>参数设置为<code class="fe pi pj pk pl b">EntitiesOut</code>。在这里，FastAPI强制响应体遵循在<code class="fe pi pj pk pl b">EntitiesOut</code>类中用Pydantic声明的模式。</li><li id="a4f9" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">处理程序的第一个参数是请求体:我们将其类型设置为<code class="fe pi pj pk pl b">UserRequestIn</code>以强制输入验证。</li><li id="0535" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">剩下的就是纯python代码:我们提取数据，调用模型，并匿名化检测到的实体。</li><li id="f586" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">最后返回一个字典，有两个键:<strong class="lb iu">实体</strong>和<strong class="lb iu">anonymouzed _ text。</strong></li></ul><p id="3608" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在一切都应该可以在本地运行了。进入项目的根目录，运行<code class="fe pi pj pk pl b">uvicorn api.main:app --reload</code></p><div class="kj kk kl km gt ab cb"><figure class="pp kn qe pr ps pt pu paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ea6dfe663b7ce5148bcd9b2c8fb9ec4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/0*hubd6GG683q9ldxC"/></div></figure><figure class="pp kn qf pr ps pt pu paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/bf166ae096eb277dac5f7b2496300eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1560/0*u9kWrp8f3CUiGbzQ"/></div><p class="ku kv gj gh gi kw kx bd b be z dk qg di qh py translated">作者提供的图片</p></figure></div><p id="643e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要检查API是否在工作，您可以打开<a class="ae ky" href="http://localhost:8000/docs" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/docs</a>来查看交互界面，在这里您可以从浏览器尝试API。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/5ca1392436f3b1294276ba5a2b597598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FB4NG7UTcHr4jWPc"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="b1fa" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">用Docker打包API</h1><p id="728c" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">既然API在本地工作，我们可以构建一个Docker映像来打包它的依赖项，并在一个隔离的执行环境中运行它，也就是一个<em class="ly">容器</em>。</p><p id="9aa3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以将容器视为虚拟机，尽管它们不像虚拟机那样提供严格的隔离。</p><p id="0ddc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Docker映像由<code class="fe pi pj pk pl b">Dockerfile</code>定义，它基本上是Docker构建映像的一组指令。</p><p id="524e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像通常建立在其他基础图像之上。这些图像可以从Docker <a class="ae ky" href="https://hub.docker.com," rel="noopener ugc nofollow" target="_blank"> Hub </a>中提取，这是Github的一个等价物，但是是针对Docker图像的。</p><p id="601d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们API的docker文件。它包含在项目的根目录中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="526b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们一行一行地详细说明发生了什么:</p><ol class=""><li id="c49c" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">我们指出我们从<code class="fe pi pj pk pl b">python:3.7</code>开始的基本图像。Docker在构建映像时从中央存储库中取出它。</li><li id="7d63" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">Python依赖项(fastapi、uvicorn和spacy)在镜像中使用<code class="fe pi pj pk pl b">pip</code>安装。</li><li id="2cb8" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">我们将<code class="fe pi pj pk pl b">api/</code>文件夹的内容(从主机)复制到<code class="fe pi pj pk pl b">/api/api/</code>文件夹(在镜像上)<br/> PS:这个文件夹是在镜像中自动创建的</li><li id="651e" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">我们将PYTHONPATH变量设置为<code class="fe pi pj pk pl b">/api</code></li><li id="7bb6" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">我们为后续的CMD命令设置工作目录。这仅仅意味着Dockerfile文件的最后一行将从工作目录中执行。</li><li id="8a0d" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">我们向Docker表明，容器将在运行时监听端口8000。</li><li id="1615" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated"><code class="fe pi pj pk pl b">ENTRYPOINT</code>允许配置作为可执行文件运行的容器。</li><li id="fadb" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">我们设置要执行的命令(我们将省略<code class="fe pi pj pk pl b">uvicorn</code>命令，因为它已被声明为入口点。</li></ol><p id="9771" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将定义一个docker-compose，它将为我们的API创建一个服务。<br/>我本可以只使用Dockerfile，因为docker-compose是一个定义多容器应用程序的工具，而且我们目前只有一个容器。</p><p id="94a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是为了本教程，让我们来看看它是如何完成的:一般来说，您可能希望在单独的容器中运行多个服务，docker-compose是将它们组合在一起的一个很好的工具。</p><p id="5dca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在同一位置再次创建一个<code class="fe pi pj pk pl b">docker-compose.yaml</code>文件。</p><div class="kj kk kl km gt ab cb"><figure class="pp kn qi pr ps pt pu paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/68bee477c175b6b2a2bcdcbc4991dcee.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/0*ApvfQGf8Th5IZUpa"/></div></figure><figure class="pp kn qj pr ps pt pu paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/855dc82749a30745b82c7ee194b1ab21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1566/0*dhxbMabxW7OxcIfG"/></div><p class="ku kv gj gh gi kw kx bd b be z dk qg di qh py translated">作者提供的图片</p></figure></div><p id="547a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个文件中，我们将docker-compose的版本设置为3(最新的)。我们为服务命名(<code class="fe pi pj pk pl b">anonymization-api</code>)，为构建步骤设置Dockerfile的路径，并将端口8000(在容器上)映射到端口8000(在主机上)。</p><p id="fb01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们运行这个命令，它将为容器内部的API提供服务，并使它可以从主机访问。</p><pre class="kj kk kl km gt qk pl ql qm aw qn bi"><span id="b970" class="ou nq it pl b gy qo qp l qq qr"><strong class="pl iu">docker-compose up --build</strong></span></pre><h1 id="b3f1" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">在AWS上启动并配置EC2实例</h1><p id="21d2" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">让我们创建一个EC2实例，我们将在其中用Docker部署API。</p><ul class=""><li id="a3a3" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">首先，连接到您的AWS帐户，转到EC2部分并选择一个发行版。这个教程我推荐Ubuntu 20.04 LTS。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qs"><img src="../Images/f15fe90f1ef2b1efc5f3581d6f9a5cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*igY5SHpOqFc-g5jC.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><ul class=""><li id="04e2" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">举个例子:我们不会在这里发疯。我们就挑一个比较小的:a <code class="fe pi pj pk pl b">t2.medium</code>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qs"><img src="../Images/bf700582f4bca6e54332bd4a2072a7f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0Vzynnvgid5TfdBC.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><ul class=""><li id="abc3" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">现在启动实例。</li><li id="ad61" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">创建一个弹性IP地址，并将其关联到正在运行的实例。这样，每次我们重新启动实例时，这个IP都不会改变。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qs"><img src="../Images/459db9fd61a06f8889fef3c9775a93e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0lmAHQgVZljvvTAv.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><ul class=""><li id="db7d" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">添加一个新的安全组(我将其命名为fastapi)以允许端口8000上的入站流量。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qs"><img src="../Images/989b84ae3b687a7e4f8e050df21d3df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IAmOnXSwW0D8AXc2.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><ul class=""><li id="db1f" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">然后，将其添加到实例安全组:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qt"><img src="../Images/424a159b28185d362bf2bef8f7f63ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q4BQmY8V1Q8JSQwW.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="3da5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，实例已经准备好接受端口8000上的请求。</p><ul class=""><li id="cc7c" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">使用您的终端SSH到它。</li><li id="8d89" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">按照ubuntu的官方文档<a class="ae ky" href="https://docs.docker.com/engine/install/ubuntu/" rel="noopener ugc nofollow" target="_blank">安装<code class="fe pi pj pk pl b">docker</code>和<code class="fe pi pj pk pl b">docker-compose</code></a></li><li id="0aa5" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">生成一个ssh密钥，并将其添加到您的Github帐户，这样它就可以无缝地执行git克隆(我们将在下一节中使用它)</li></ul><h1 id="38e7" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">在Github操作上创建部署工作流</h1><p id="8880" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">Github Actions是Github的CI/CD服务。它允许您基于git提交、合并或拉取请求等事件自动测试、构建和部署应用程序。</p><p id="6c3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly">要了解更多关于Github动作的信息，请看一下这个</em> <a class="ae ky" href="https://docs.github.com/en/actions" rel="noopener ugc nofollow" target="_blank"> <em class="ly">链接</em> </a> <em class="ly">。</em></p><p id="cded" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在repo中添加工作流程，请点击<strong class="lb iu">操作</strong>选项卡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qu"><img src="../Images/6a2dc9f60e3cff5bbf6dc404079466bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_csYL04e759Z-thz.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="8529" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，点击<strong class="lb iu">自行设置工作流程。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qv"><img src="../Images/412408fd813e818867baebe71fe296ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jEmKMfhsnOElxj3w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="0af2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个YAML文件将被自动创建在一个<code class="fe pi pj pk pl b">workflows</code>文件夹中，该文件夹将被创建在回购根目录下的一个<code class="fe pi pj pk pl b">.github</code>文件夹中。</p><p id="216f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，我们将工作流设置为仅在<strong class="lb iu">主</strong>分支上的<strong class="lb iu">推送</strong>请求时触发。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qw"><img src="../Images/51fb12180b058544bf971a1a1a8882af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0WIj0hfKqRlrhX4l.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="35c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将被触发的作业将在一个远程服务器上运行，GitHub Actions将通过<strong class="lb iu"> SSH Remote命令连接到该服务器。</strong>在其他情况下，该作业可能在Github运行程序上运行，例如Github提供的实例。</p><p id="4fa8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/appleboy/ssh-action" rel="noopener ugc nofollow" target="_blank"> SSH Remote Commands </a>是一个定制的GitHub动作，你可以在市场上找到。它是免费使用的，你只需要在<code class="fe pi pj pk pl b">uses</code>部分之后调用它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="934c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将使用以下参数调用SSH远程命令Github操作</p><ul class=""><li id="b2ec" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated"><strong class="lb iu">主机</strong>:服务器的主机名(即其公共IP)</li><li id="e975" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated"><strong class="lb iu">用户名</strong>:ssh用户名</li><li id="8a05" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated"><strong class="lb iu">key</strong>:ssh私钥的内容</li><li id="74e5" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated"><strong class="lb iu">脚本</strong>:ssh连接建立后将执行的脚本</li></ul><p id="2a80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该脚本将列出SSH连接建立后将在服务器上运行的命令:</p><ul class=""><li id="1042" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">克隆回购</li><li id="2410" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">光盘放进去</li><li id="f600" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">运行docker-compose build和up命令。</li></ul><pre class="kj kk kl km gt qk pl ql qm aw qn bi"><span id="d4f8" class="ou nq it pl b gy qo qp l qq qr">git clone git@github.com:ahmedbesbes/anonymization-api.git<br/>cd anonymization-api<br/>sudo docker-compose up --build -d</span></pre><p id="5e7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前面的参数<code class="fe pi pj pk pl b">host</code>、<code class="fe pi pj pk pl b">username</code>和<code class="fe pi pj pk pl b">key</code>不会硬编码到YAML文件中。他们永远不会。这个信息很敏感。</p><p id="24fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们将被存储为<strong class="lb iu"> Github Secrets </strong>并用$符号引用，就像你调用环境变量一样。</p><p id="5ac6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建Github secrets，请转到存储库的设置，然后单击左侧选项卡上的secrets。Github机密总是在Github repo的范围内定义。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qx"><img src="../Images/68055143d207ed91a2cd6a0d38270163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EdA64IBYhDzx14qC.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="7fa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后通过设置它们的名称(用大写字母)和它们的值来定义你的秘密。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qy"><img src="../Images/08f53f32652443237d3d4cbc12aa7c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NxcxeO1opAn3xQvG.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="b4b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是你如何设置<code class="fe pi pj pk pl b">USERNAME</code>秘密的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qz"><img src="../Images/68e85360f88967a09e5faef490411319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hyENdhXcQvwjx8gG.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="a381" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">现在你可以提交、推动并期待奇迹的发生！</strong></p><p id="4963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你推送你的代码(在测试本地一切正常之后)，你会注意到，在点击<strong class="lb iu">动作</strong>标签之后，一个新的运行正在排队等待开始。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ra"><img src="../Images/cdfd9dead2d105a6c7a37194558226c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2Ec5OVQze94ZUfGK.png"/></div></div></figure><p id="978d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过点击它，您可以看到构建的不同步骤。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rb"><img src="../Images/0ba21376b4040c46aa8272a18b8ddf8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*deW-XYhkXsFDL_Qe.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="a56b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦API成功地部署在您的远程服务器上，启动Postman并在API端点上执行一些请求来检查它是否正常工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qs"><img src="../Images/c1e371b67fd5a56eee1d7b93613c9012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ICJSx6t6vbgIdQWo.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="b4ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有后！🎊现在API已经部署好了，可以工作了，并准备好接受请求。</p><h1 id="36d4" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">结论和后续步骤</h1><p id="1677" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">到目前为止，已经涵盖了很多内容。</p><p id="7856" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们了解了FastAPI提出的有趣特性。然后，我们用这个框架构建了一个API，最后用Docker部署在AWS上。</p><p id="c3ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使部署过程尽可能顺利，我们还使用了GitHub Actions工作流，该工作流在每次推送时被触发，并使用自定义操作。</p><p id="1157" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，为了使这个API更适合生产，我们可以考虑这些特性(我可能会在未来的博客文章中涉及它们)</p><ul class=""><li id="e8b4" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu po mi mj mk bi translated">为API设置域名</li><li id="a827" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">通过添加HTTPS来保护API</li><li id="1c43" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">使用<code class="fe pi pj pk pl b">gunicorn</code>代替<code class="fe pi pj pk pl b">unicorn</code>进行部署</li><li id="4876" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu po mi mj mk bi translated">添加数据库服务(例如PostgreSQL)来存储输入和预测:这是应用异步请求的好机会。</li></ul><h1 id="9748" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">资源:</h1><p id="9739" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">这里是我在学习FastAPI和部署时浏览的一些高质量资料。</p><div class="mq mr gp gr ms mt"><a href="https://fastapi.tiangolo.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">FastAPI</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">FastAPI框架，高性能，简单易学，快速编码，准备生产文档…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">fastapi.tiangolo.com</p></div></div><div class="nc l"><div class="rc l ne nf ng nc nh ks mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a href="https://pydantic-docs.helpmanual.io/" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">pydantic</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">版本文档:1.8.2使用python类型注释的数据验证和设置管理。pydantic…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">pydantic-docs.helpmanual.io</p></div></div></div></a></div><div class="mq mr gp gr ms mt"><a href="https://www.starlette.io/" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">明星</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">✨闪耀的小ASGI框架。✨ Starlette是一个轻量级的ASGI框架/工具包，非常适合…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">www.starlette.io</p></div></div><div class="nc l"><div class="rd l ne nf ng nc nh ks mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a href="https://medium.com/@calebkaiser/why-we-switched-from-flask-to-fastapi-for-production-machine-learning-765aab9b3679" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">为什么我们从Flask转向FastAPI进行生产机器学习</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">最流行的工具并不总是最好的</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">medium.com</p></div></div><div class="nc l"><div class="re l ne nf ng nc nh ks mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/how-to-properly-ship-and-deploy-your-machine-learning-model-8a8664b763c4"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">如何正确地发布和部署您的机器学习模型</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">FastAPI、Docker和GitHub操作实用指南</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="rf l ne nf ng nc nh ks mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/machine-learning-service-for-real-time-prediction-9f18d585a5e0"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">用于实时预测的机器学习服务</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">使用FastAPI为实时预测构建一个生产就绪的机器学习服务。</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="rg l ne nf ng nc nh ks mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/build-an-async-python-service-with-fastapi-sqlalchemy-196d8792fa08"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">用FastAPI &amp; SQLAlchemy构建异步python服务</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">使用FastAPI和新的SQLAlchemy AsyncIO构建一个完全异步的python服务，包括异步数据库查询…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="rh l ne nf ng nc nh ks mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a href="https://testdriven.io/blog/moving-from-flask-to-fastapi/" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">从Flask转移到FastAPI</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">Python是最流行的编程语言之一。从脚本到API开发再到机器学习…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">testdriven.io</p></div></div><div class="nc l"><div class="ri l ne nf ng nc nh ks mt"/></div></div></a></div><h1 id="26ca" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">感谢阅读！🙏</h1><p id="9b42" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">我希望这篇文章对你有用。如果你对改进我建立的工作流程有任何建议，请不要犹豫，在<a class="ae ky" href="https://github.com/ahmedbesbes/anonymization-api/issues" rel="noopener ugc nofollow" target="_blank"> Github </a>或评论中提出。</p><p id="d049" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，代码可以在我的<a class="ae ky" href="https://github.com/ahmedbesbes/anonymization-api" rel="noopener ugc nofollow" target="_blank">回购</a>上获得:请随意在你的项目上试用。</p><p id="21e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我就讲到这里，下次见！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rj"><img src="../Images/64ba67e5f7e4dc0c953b47de510b7459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mnghzeabgHgbzlRH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@karsten116?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡斯滕·怀恩吉尔特</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="c79c" class="np nq it bd nr ns on nu nv nw oo ny nz jz op ka ob kc oq kd od kf or kg of og bi translated">新到中？您可以每月订阅5美元，并解锁无限的文章— <a class="ae ky" href="https://ahmedbesbes.medium.com/membership" rel="noopener">单击此处。</a></h1></div></div>    
</body>
</html>