<html>
<head>
<title>Calculating Machine Learning Model Performance Metrics With Confidence Intervals using FRONNI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用FRONNI计算具有置信区间的机器学习模型性能度量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fronni-a-python-library-for-quickly-calculating-machine-learning-model-performance-metrics-with-3baf28eaa5c0?source=collection_archive---------31-----------------------#2021-12-13">https://towardsdatascience.com/fronni-a-python-library-for-quickly-calculating-machine-learning-model-performance-metrics-with-3baf28eaa5c0?source=collection_archive---------31-----------------------#2021-12-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3a72" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个Python库，用于快速计算和显示带有置信区间的机器学习模型性能指标</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/85e4a98e765d5ad15e1808a014d36f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m0q8VVX7NfLn9308"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd kv">FRONNI这个名字来源于统计学家Bradley Efron的姓氏，Bradley Efron是bootstrap重采样技术的发明者，John Ioannidis是广受好评的文章《</strong> <a class="ae kw" href="https://en.wikipedia.org/wiki/Why_Most_Published_Research_Findings_Are_False" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kv">为什么大多数发表的研究结果都是假的</strong> </a> <strong class="bd kv">》的作者。</strong>照片由<a class="ae kw" href="https://unsplash.com/@minhctran?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Minh Tran </a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="9ea0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据科学家花费大量时间评估他们的机器学习模型的性能。这样做的一种常见方法是针对分类问题的分类报告，例如内置在<a class="ae kw" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn库</a>中的报告(在Github上被引用超过440，000次)。类似地，对于回归问题，人们使用<a class="ae kw" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.r2_score.html" rel="noopener ugc nofollow" target="_blank"> r2得分</a>、<a class="ae kw" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_squared_error.html" rel="noopener ugc nofollow" target="_blank"> MSE </a>或<a class="ae kw" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_absolute_percentage_error.html" rel="noopener ugc nofollow" target="_blank"> MAE </a>。</p><p id="4e40" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">依赖这些的问题是，当我们的测试样本中有不平衡的和/或小的数据集时，构成每个点估计的数据量可能非常小。因此，无论对评估指标有什么样的估计，都不可能真正代表现实世界中发生的事情。相反，向读者呈现一系列置信区间的值会好得多。</p><p id="074b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">例如，我们可以通过使用<a class="ae kw" href="https://en.wikipedia.org/wiki/Bootstrapping_%28statistics%29#:~:text=This%20technique%20allows%20estimation%20of,sampling%20from%20an%20approximating%20distribution" rel="noopener ugc nofollow" target="_blank"> bootstrap </a>技术从原始数据集(替换)创建数百个样本，然后丢弃最极端的5%的值以获得95%的置信区间，从而轻松创建任何感兴趣的指标的置信区间。</p><p id="8976" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，当数据集很大时，如上所述运行引导程序会变成计算量很大的计算。即使是相对较小的100万行样本，当重采样1000次时，也会变成10亿行数据集，并导致计算花费接近一分钟的时间。当离线进行这些计算时，这不是问题，但是工程师经常在Jupyter笔记本上交互工作，并且希望快速得到答案。出于这个原因，<strong class="kz ir"> Meta </strong>(又名脸书)决定为常见的机器学习指标创建一些这些计算的快速实现，例如使用<a class="ae kw" href="http://numba.pydata.org/" rel="noopener ugc nofollow" target="_blank"> numba库</a>的precision &amp; recall，它提供了比常规Python并行处理代码大约23倍的加速。</p><p id="cffa" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们用分类问题的例子来证明这一点。考虑标准的<a class="ae kw" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_digits.html#sklearn.datasets.load_digits" rel="noopener ugc nofollow" target="_blank">手写数字数据集</a>，我们正在构建一个ML模型来识别数字。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/534cc6218bfdd14e70c9248b39a3fc57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/0*z0hJyMDp-H9jmeXH"/></div></figure><p id="23ca" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">到目前为止，这是标准的东西。现在，我们可以使用FRONNI来获得精确度、召回率、f1分数和相关的置信区间。PyPi中有这个库，要安装FRONNI只需运行pip install。</p><p id="6e58" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lu"> pip安装fronni </em></p><p id="1669" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在运行FRONNI分类报告，以获得每个类别的精确度、召回率和f1分数及其置信区间。您可以使用参数n控制自举样本的数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/aba193789495089ef5119873e19b8b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/0*7QRNdLUqHUMZBF12"/></div></figure><p id="413b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">瞧啊。，它给出了每个类的精确度、召回率和f1分数的上限和下限。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/069ca9a9e2de27452ffdeb885d05c19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/0*pM31SigU2_ymzUVX"/></div></figure><p id="eaca" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数字分类器的FRONNI分类报告输出示例。</p><p id="64c5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">类似地，FRONNI回归模块给出了RMSE、r2评分和MAE的置信区间。完整的文档请参考GitHub库。</p></div></div>    
</body>
</html>