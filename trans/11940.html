<html>
<head>
<title>7-day Challenge — Mastering Ggplot2: Day 3 — Slope Graph</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">7 天挑战—掌握 Ggplot2:第 3 天—斜率图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/7-day-challenge-mastering-ggplot2-day-3-slope-graph-a7cb373dc252?source=collection_archive---------16-----------------------#2021-11-30">https://towardsdatascience.com/7-day-challenge-mastering-ggplot2-day-3-slope-graph-a7cb373dc252?source=collection_archive---------16-----------------------#2021-11-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5c61" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">认识一个非常有趣的图形——斜率图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/26f69f920959384339ae0af73bd8e2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xSgo8k6Der9AmMi1"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@brookelark?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布鲁克·拉克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="8b10" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="0093" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在<a class="ae ky" rel="noopener" target="_blank" href="/7-day-challenge-mastering-ggplot2-day-1-bar-chart-4b2ced928a31"> <em class="mn"> </em> <strong class="lt iu"> <em class="mn">掌握 ggplot2:第 1 天—条形图</em> </strong> </a>和<strong class="lt iu"> <em class="mn">第 2 天—线图</em> </strong>之后继续我的一系列学习可视化，我将分享一个激动人心的情节，我旅程的第 3 天的<strong class="lt iu">斜率图</strong>。但是，要了解 ggplot 如何工作的一般想法和一些简单的概念，您可以先查看我的文章<a class="ae ky" rel="noopener" target="_blank" href="/guide-to-data-visualization-with-ggplot2-in-a-hour-634c7e3bc9dd"> <strong class="lt iu"> <em class="mn">使用 ggplot </em> </strong> </a>进行数据可视化的指南。</p><p id="3e80" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">首先，斜率图用于显示两点之间的变化，而不太关心中间点。这在比较不同时间戳中的值和显示一段时间内的趋势时特别有用。如下图所示，图 1 是一个斜率图的例子。它比较了不同公司在 2007 年和 2020 年的收入。通过查看图表，我们可以很容易地看出 A 区是这段时间内增长最快的公司。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/c504c4e47960c659488a681b91b1f7a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*2UA9sd7Xkq99dva0ACMqLg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1:收入—按作者分类的图片</p></figure><p id="f683" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果你想了解更多关于斜率图形和它们的解释，你可以在<a class="ae ky" href="https://www.storytellingwithdata.com/blog/2018/6/1/swdchallenge-slopegraph" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"><em class="mn">story telling with data</em></strong></a><em class="mn">阅读更多。</em></p><p id="333c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在这篇文章中，我将告诉你 4 个步骤来获得任何斜率图形。很简单。</p><p id="437e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">现在，让我们试着用 ggplot2 得到这个有趣的图形。</p><h1 id="1530" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据集</h1><p id="1ba5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我将使用来自<code class="fe mu mv mw mx b">dplyr</code>包的数据集<strong class="lt iu">“Storm”</strong>。这些数据记录了从 1975 年到 2015 年 40 年间不同类型风暴的各种属性。下面，我总结一下我的数据集。</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="432d" class="nc la it mx b gy nd ne l nf ng">library(dplyr)<br/>data = storms <br/>skim(data)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/f5e840596e233fce6737926e902525ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1m8J25UVEePrjeHvLhwu4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:数据汇总—按作者分类的图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/bb3c1dc8c720fbf8caf8b65033109053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6mt2DxgeKlKA_k_-_xe1TA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3:标题(数据)—作者图片</p></figure><h1 id="9832" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">让我们开始吧…</h1><h2 id="dd88" class="nc la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">目标 1:通过斜率图将 1975 年不同类型风暴的平均风力与 2015 年进行对比。</h2><ol class=""><li id="1663" class="nu nv it lt b lu lv lx ly ma nw me nx mi ny mm nz oa ob oc bi translated"><strong class="lt iu">变换数据集得到 1975 年和 2015 年的平均风力。</strong></li></ol><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="ce97" class="nc la it mx b gy nd ne l nf ng">mean_storm &lt;- data %&gt;% filter(year %in% c('1975','2015'))%&gt;%<br/>              group_by(year,status) %&gt;% <br/>              summarise(avg_windpower = mean(wind))</span></pre><p id="e188" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这是我将用来可视化我的斜率图的数据框。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/73d9466e2fc7ea703d8284612c7f49cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*xWiKPtzWczEfUfXhIk3cmw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4:转换后的数据—按作者分类的图像</p></figure><p id="de62" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> 2。画出坡度线</strong></p><p id="225b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在我看来，斜率图是各种各样的线图，或者说是一种特定类型的线图。因此，在第一阶段，获得一条斜线类似于生成一个应用了<code class="fe mu mv mw mx b">geom_line</code>的线图。我将向您展示如何:</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="88cd" class="nc la it mx b gy nd ne l nf ng">f1 &lt;- ggplot(data = mean_storm, aes(x = year, y = avg_windpower, group = status, color=status,alpha=1)) +<br/>  geom_line( size = 2) +<br/>  geom_point( size = 4) +<br/>  xlab("Year") + ylab("Avg wind power") +<br/>  ggtitle("Average wind power in 1975 and 2015")</span><span id="c940" class="nc la it mx b gy oe ne l nf ng">f1</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/abe9ac4e545df4cd327fa81782bc5d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qAVHJ1vdZyHDEk85Lsq7xw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 5:我的草图——作者图片</p></figure><p id="d143" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> 3。移除不必要的元素</strong></p><p id="8488" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们离我们需要的东西越来越近了。在这一步，为了有一个清晰的斜率图形，我们必须删除和调整一些元素。基本上，所有的调整都发生在<code class="fe mu mv mw mx b">theme()</code>属性中:</p><ul class=""><li id="c334" class="nu nv it lt b lu mo lx mp ma og me oh mi oi mm oj oa ob oc bi translated">调整 x 轴标签并用<code class="fe mu mv mw mx b">scale_x_discrete(position = "top").</code>将它们移动到图表的顶部，然后改变这些标签的字体大小使其更清晰。</li><li id="1dce" class="nu nv it lt b lu ok lx ol ma om me on mi oo mm oj oa ob oc bi translated">通过获取<code class="fe mu mv mw mx b">theme()</code>属性中的<code class="fe mu mv mw mx b">legend.position = "none"</code>来移除图例</li><li id="4af1" class="nu nv it lt b lu ok lx ol ma om me on mi oo mm oj oa ob oc bi translated">删除 y 轴上的所有内容，包括标题、标签、刻度线</li><li id="35e8" class="nu nv it lt b lu ok lx ol ma om me on mi oo mm oj oa ob oc bi translated">通过将这些元素设置为<code class="fe mu mv mw mx b">element_blank()</code>从 x 轴移除刻度线、标题</li><li id="d1c2" class="nu nv it lt b lu ok lx ol ma om me on mi oo mm oj oa ob oc bi translated">为了使图表更加清晰，我将删除图表中的所有网格线。为此，应该删除<code class="fe mu mv mw mx b">theme</code>属性中的一些元素:<code class="fe mu mv mw mx b">panel.grid.major.y, panel.grid.minor.y, panel.grid.minor.x, panel.grid.major.x</code></li></ul><p id="1748" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这是我们移除一些东西后得到的结果:</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="2a1f" class="nc la it mx b gy nd ne l nf ng">f2 &lt;- f1+  <br/>  scale_x_discrete(position = "top") +</span><span id="b520" class="nc la it mx b gy oe ne l nf ng">## Changing font size of x-axis and main title of the graph<br/>theme(<br/>  plot.title = element_text(color="black", size=15, face="bold",  hjust = 0.5 ), <br/>  axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 12, face="bold"),</span><span id="eb80" class="nc la it mx b gy oe ne l nf ng">## Removing grid lines<br/>  panel.grid.major.y = element_blank(),<br/>  panel.grid.minor.y = element_blank(),<br/>  panel.grid.major.x = element_blank(),<br/>  panel.grid.minor.x = element_blank(),</span><span id="2569" class="nc la it mx b gy oe ne l nf ng">## Removing the legend<br/>  legend.position = "none",</span><span id="01e4" class="nc la it mx b gy oe ne l nf ng">## Removing everything from the y axis<br/>  axis.title.y     = element_blank(),<br/>  axis.text.y      = element_blank(),</span><span id="22cb" class="nc la it mx b gy oe ne l nf ng">## Removing title from the x axis <br/>  axis.title.x     = element_blank(),</span><span id="868a" class="nc la it mx b gy oe ne l nf ng">## Remove x &amp; y tick marks<br/>  axis.ticks       = element_blank())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/019ecb9e9ceecdd113e137eceb17c3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Dqw-gJmOM73PTPISBwvtKw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 6:删除元素后的图表——作者提供的图片</p></figure><p id="761a" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> 4。给坡度线添加标签</strong></p><p id="1565" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">现在，我们的图表已经接近完成，但是如果没有图表值，它看起来还是很空。这就是为什么我们将为更多信息添加数据标签，而<code class="fe mu mv mw mx b">geom_text()</code>属性将用于此目的。</p><ul class=""><li id="f0ee" class="nu nv it lt b lu mo lx mp ma og me oh mi oi mm oj oa ob oc bi translated">使用<code class="fe mu mv mw mx b">aes(label = "--")</code>写入每组对应的值</li><li id="0929" class="nu nv it lt b lu ok lx ol ma om me on mi oo mm oj oa ob oc bi translated">比如我想用风暴的名称和对应的风力来标注 2015 年每个风暴组的平均风力，就用<code class="fe mu mv mw mx b">aes(labels=paste0(status,"-",round(avg_windpower,2),"km/h"))</code>。</li><li id="d7c6" class="nu nv it lt b lu ok lx ol ma om me on mi oo mm oj oa ob oc bi translated">此外，我们还可以通过控制不同的元素来定制标签的外观和位置，例如<code class="fe mu mv mw mx b">hjust, vjust, size, alpha</code></li></ul><p id="a058" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">让我们看看添加不同的<code class="fe mu mv mw mx b">geom_text()</code>元素后会有什么。</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="aac1" class="nc la it mx b gy nd ne l nf ng">f2 + <br/>geom_text(data = mean_storm %&gt;% filter(year == "1975"), <br/>aes(label = paste0(status, " - ", round(avg_windpower,2), "km/h")),   hjust = 1.1, <br/>fontface = "bold", <br/>vjust=0.25,<br/>size = 4, <br/>alpha = 3) +<br/>  <br/>geom_text(data = mean_storm %&gt;% filter(year == "2015"), aes(label = paste0(status, " - ", round(avg_windpower,2), "km/h")) , <br/>hjust = -0.1, <br/>fontface = "bold",<br/>vjust = 0.25,<br/>size = 4, <br/>alpha = 3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/a907eef61a1cec385bd2f3c239d7831e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmYe7EfMWJYnL6mHia8UJg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 7:典型的斜率图——作者图片</p></figure><p id="194c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这比第一张图好多了，对吧？</p><p id="c778" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">但这并不是故事的结尾；请再忍耐一下，看看我们将在下一张图中遇到什么。</p><h2 id="1c00" class="nc la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">目标 2:用斜率图直观显示 10 年、20 年、30 年、40 年不同类型风暴的平均风力。</h2><ol class=""><li id="3581" class="nu nv it lt b lu lv lx ly ma nw me nx mi ny mm nz oa ob oc bi translated"><strong class="lt iu">转换数据集以获得从 1975 年开始的<em class="mn"> 10 年、20 年、30 年和 40 年的平均风速。</em> </strong></li></ol><p id="ac82" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">好了，像往常一样，让我们从最基本的步骤开始，即获取数据框以进行可视化。</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="37d1" class="nc la it mx b gy nd ne l nf ng">mean_storm2 &lt;- data %&gt;% <br/>  group_by(year,status) %&gt;% <br/>  summarise(avg_windpower = mean(wind))</span><span id="413a" class="nc la it mx b gy oe ne l nf ng">df2 &lt;- mean_storm2 %&gt;% pivot_wider(names_from = status, values_from = avg_windpower)</span><span id="7976" class="nc la it mx b gy oe ne l nf ng">year &lt;- c()<br/>year[1] &lt;- 1975<br/>period &lt;- c()</span><span id="94b8" class="nc la it mx b gy oe ne l nf ng">while(max(year) &lt; 2015) {<br/>  next_year &lt;- tail(year,1) + 10<br/>  year &lt;- c(year,next_year)<br/>  }</span><span id="4cb8" class="nc la it mx b gy oe ne l nf ng">period &lt;- c()<br/>for (i in 1:length(year)) {<br/>  period[i] = year[i] - year[1] <br/>}</span><span id="1871" class="nc la it mx b gy oe ne l nf ng">##Marking the period corresponding with each year (E.g: 1985 - period = 10 years)<br/>df3 &lt;- data.frame(year,period)</span><span id="5ac1" class="nc la it mx b gy oe ne l nf ng">df4 &lt;- merge(x = df2, y = df3, by = "year", all.x = TRUE)</span><span id="7c9a" class="nc la it mx b gy oe ne l nf ng">df5 &lt;- select(df4[!is.na(df4$period), ], -1)</span><span id="7ec1" class="nc la it mx b gy oe ne l nf ng">df6 &lt;- df5 %&gt;%<br/>  pivot_longer(!period, names_to = "status", values_to = "avg_windpower")<br/>df6$period &lt;- as.character(df6$period)</span><span id="4e4f" class="nc la it mx b gy oe ne l nf ng">df7 &lt;- subset(df6, period != '0')</span><span id="8f32" class="nc la it mx b gy oe ne l nf ng">df7$period &lt;- factor(df7$period, <br/>                            levels = c("10", "20", "30", "40"), <br/>                            labels = c("10 Years","20 Years","30 Years","40 Years"), <br/>                            ordered = TRUE)</span></pre><p id="1fdc" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这是我们转换后的数据框:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/88b9399eefd004b58a0db114868519c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*z68Ag42-ottyLskrXvGzNA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 8:转换后的数据—按作者分类的图像</p></figure><p id="369d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">让我们进入第二步，这是绘制我们的斜率图。</p><p id="47a0" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> 2。画出坡度线</strong></p><p id="04d0" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如前所述，我们将调整 x 标签的标题和位置，并使用<code class="fe mu mv mw mx b">geom_line()</code>绘制草图</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="abf6" class="nc la it mx b gy nd ne l nf ng">f2 &lt;- ggplot(data = df7, aes(x = period, y = avg_windpower, group = status)) +<br/>  geom_line(aes(color = status, alpha = 1), size = 2 ) +<br/>  scale_x_discrete(position = "top") +<br/>  theme_gray() +  ggtitle("Wind power by time") + <br/>  theme(plot.title = element_text(color="black", size=15, face="bold", hjust = 0.5 ))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/2f194dfaf43b4009debe4e4e86688fb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*r5eD8B4iXmH1fBDKfIV4Rg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 9:草图——作者提供的图片</p></figure><p id="db11" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> 3。移除不必要的元素</strong></p><p id="2581" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">与我们之前所做的类似，为了使图表更清晰，我们将从图表中删除一些元素。消除这些元素的代码与<strong class="lt iu"> <em class="mn">目标 1 中的相应部分相同。</em> </strong>重复代码，下面是我们得到的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/9bc16d27fb4e48e4536a0f00d0e0eefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*vaxby3XB2OXaZGim91HZ7Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 10:删除不必要的元素——作者图片</p></figure><p id="4ff6" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> 4。给坡度线添加标签</strong></p><ul class=""><li id="5ac6" class="nu nv it lt b lu mo lx mp ma og me oh mi oi mm oj oa ob oc bi translated">这一部分的不同之处在于，我将使用<code class="fe mu mv mw mx b">geom_label</code>而不是<code class="fe mu mv mw mx b">geom_text.</code>来绘制该图。实际上，这两个元素以相同的方式工作。但是，<code class="fe mu mv mw mx b">geom_label</code>在文本周围多加一个框，给数字足够的空间，避免数字值和图形之间的重叠。</li><li id="7b3e" class="nu nv it lt b lu ok lx ol ma om me on mi oo mm oj oa ob oc bi translated">此图中要使用的另一个额外元素是<code class="fe mu mv mw mx b">geom_text_repel.</code>。该属性将有助于在线的两端获得不同组的标签，而不会使线重叠。只要一声令下，一切都变得整洁有序。</li></ul><p id="bd3d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">你可以看到我的图表如下:</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="665b" class="nc la it mx b gy nd ne l nf ng">f3 &lt;- f2+<br/> geom_text_repel(data = df7 %&gt;% filter(period == "10 Years"), <br/>                  aes(label = status) , <br/>                  hjust = "left", <br/>                  fontface = "bold", <br/>                  size = 4.2, <br/>                  nudge_x = -.45, <br/>                  direction = "y") +<br/> geom_text_repel(data = df7 %&gt;% filter(period == "40 Years"), <br/>                  aes(label = status) , <br/>                  hjust = "right", <br/>                  fontface = "bold", <br/>                  size = 4.2, <br/>                  nudge_x = .5, <br/>                  direction = "y") +<br/> geom_label(aes(label = round(avg_windpower,2)), <br/>             size = 4, <br/>             label.padding = unit(0.05, "lines"), <br/>             label.size = 0.0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/7c23efbf85aa5474e97fe9cc6135f09b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0DUGlczvQdpNssnzU4Nmrg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 11:最终图形——作者提供的图像</p></figure><h1 id="ab9f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">最后…</h1><p id="9f65" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">经过大量的添加和删除元素，我可以这个有趣的图表。就我个人而言，我并没有看到这种图形被普遍使用，然而学习一种新技术从来都不是多余的。希望你觉得我的文章在某些方面有帮助，感谢你一直读到最后。</p><p id="d4b3" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我学习 ggplot 的第三天到此结束。我将从第 4 天继续我的学习之旅:统计使用图。</p><p id="5352" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu">参考</strong></p><div class="ou ov gp gr ow ox"><a href="https://ibecav.github.io/slopegraph/" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd iu gy z fp pc fr fs pd fu fw is bi translated">Slopegraphs 和 R -愉快的转移-2018 年 5 月 26 日</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">我试着每天至少浏览一下 R 博客的内容。不是每篇文章我都感兴趣，但我经常有一篇…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">ibecav.github.io</p></div></div></div></a></div></div></div>    
</body>
</html>