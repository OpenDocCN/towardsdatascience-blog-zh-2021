<html>
<head>
<title>From DevOps to MLOPS: Integrate Machine Learning Models using Jenkins and Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从DevOps到MLOPS:使用Jenkins和Docker整合机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-devops-to-mlops-integrate-machine-learning-models-using-jenkins-and-docker-79034dbedf1?source=collection_archive---------3-----------------------#2021-05-06">https://towardsdatascience.com/from-devops-to-mlops-integrate-machine-learning-models-using-jenkins-and-docker-79034dbedf1?source=collection_archive---------3-----------------------#2021-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="367d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何用Jenkins和Docker自动化数据科学代码:MLOps = ML + DEV + OPS</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e8e157033e7fdf97b796adf352dbcf3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UeVl1Rq5PuIYacPlPQwBpw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Annamária Borsos摄影</p></figure><h1 id="cec5" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">MLOPS = ML + DEV + OPS</h1><p id="091c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">有多少创造出来的AI模型已经在企业投入生产？随着对数据科学团队和技术的投资，人工智能项目的数量显著增加，随之错过了许多投入生产和评估实际商业价值的机会。其中一个解决方案是MLOPS，它能够将数据科学和IT运营结合起来，在生产中部署、监控和管理ML/DL模型。</p><p id="a783" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">持续集成(CI)和持续交付(CD)，也称为CI/CD管道，体现了DevOps团队的敏捷操作原则和实践的文化，允许软件开发团队更频繁、更可靠地更改代码，或允许数据科学家持续测试模型的准确性。CI/CD是一种关注业务需求的方式，例如改进的模型准确性、自动化部署步骤或代码质量。持续集成是一组实践，驱动开发团队持续地实现小的变更，并将代码签入版本控制存储库。如今，数据科学家和IT运营人员拥有不同的平台(内部、私有云和公共云、多云……)和工具，需要通过自动集成和验证机制来解决这些问题，以便灵活地构建、打包和测试应用。通过自动向选定平台交付应用程序，持续交付在持续集成结束时介入。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/0897fb0c5215c397d133ab357009947f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJR--aGOquwL_8jgyXr1Aw.jpeg"/></div></div></figure><p id="8c7b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">本文的目标是使用Jenkins和Docker将机器学习模型与DevOps集成。用Jenkins和Docker做ML/DL有很多好处。一个例子是，当我们训练机器学习模型时，有必要不断测试模型的准确性。使用Jenkins可以完全自动化这项任务。当我们从事数据科学项目时，我们通常会花一些时间来提高模型准确性，然后当我们满意时，我们会将应用程序作为API部署到生产中。假设我们的模型准确率是85%。几天或几周后，我们决定调整一些超参数并添加一些数据，以提高模型的准确性。然后，我们计划将其部署到生产环境中，为此，我们需要花费一些精力来构建、测试和再次部署该模型，这可能需要大量工作，具体取决于上下文和环境。这就是开源自动化服务器Jenkins的用武之地。</p><p id="edd6" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">Jenkins提供了一个持续集成和持续交付(CI/CD)系统，提供了数百个插件来构建、部署和自动化软件项目。使用Jenkins有几个优点。它很容易安装和配置，它有一个重要的社区，数百个插件，它有能力在不同的环境中分配工作。Jenkins有一个目标:花更少的时间在部署上，花更多的时间在代码质量上。Jenkins允许我们创造工作岗位，这是Jenkins构建流程的核心。例如，我们可以创建工作来用不同的任务测试我们的数据科学项目。Jenkins还提供了一套插件，Jenkins Pipeline，它支持CI/CD。它们可以是声明性的和脚本化的管道。</p><p id="98f4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在本文中，我们将看到如何使用Jenkins和Docker集成一个在EEG数据上训练的机器学习模型(线性判别分析和多层感知器神经网络)。</p><p id="7bc8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">要学习这些概念:我们来考虑以下文件:<strong class="lp ir"> Dockerfile，train-lda.py，train-nn.py，train-auto-nn.py，requirements.txt，train.csv，test.csv </strong></p><p id="4ec8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir"> train-lda.py </strong>和<strong class="lp ir"> train-nn.py </strong>是python脚本，它们摄取并归一化EEG数据，训练两个模型对数据进行分类，并测试模型。<strong class="lp ir">Docker文件</strong>将用于构建我们的Docker映像，requirements.txt ( <em class="mp"> joblib </em>)用于Python依赖项。<strong class="lp ir"> train-auto-nn.py </strong>是一个python脚本，用不同的参数调整神经网络模型。<strong class="lp ir"> train.csv </strong>是用于训练我们的模型的数据，而<strong class="lp ir"> test.csv </strong>是包含新EEG数据的文件，将用于我们的推理模型。</p><p id="f89b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">你可以在<a class="ae mq" href="https://github.com/xaviervasques/EEG-letters" rel="noopener ugc nofollow" target="_blank">GitHub</a>:<a class="ae mq" href="https://github.com/xaviervasques/Jenkins" rel="noopener ugc nofollow" target="_blank">https://github.com/xaviervasques/Jenkins</a>上找到所有文件</p><h1 id="596d" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">詹金斯装置</h1><p id="e371" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">与Jenkins一起，我们将运行一个容器映像，其中安装了用于训练我们的模型的所有必要要求。为此，我们将使用Jenkins中的build pipeline插件创建一个作业链。</p><p id="cb65" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">首先你需要安装詹金斯。在这里，我们安装长期支持版本。</p><p id="cca5" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在Red Hat / CentOS上，我们可以键入以下命令:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="a470" class="mw kw iq ms b gy mx my l mz na">sudo wget -O /etc/yum.repos.d/jenkins.repo \</span><span id="3cb4" class="mw kw iq ms b gy nb my l mz na">https://pkg.jenkins.io/redhat-stable/jenkins.repo</span><span id="93a8" class="mw kw iq ms b gy nb my l mz na">sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key</span><span id="f0bd" class="mw kw iq ms b gy nb my l mz na">sudo yum upgrade</span><span id="4ae6" class="mw kw iq ms b gy nb my l mz na">sudo yum install jenkins java-1.8.0-openjdk-devel</span></pre><p id="e108" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在Ubuntu上，我们可以键入以下命令来安装Jenkins:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="b6b4" class="mw kw iq ms b gy mx my l mz na">wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -</span><span id="1ce2" class="mw kw iq ms b gy nb my l mz na">sudo sh -c 'echo deb https://pkg.jenkins.io/debian-stable binary/ &gt; \</span><span id="eb38" class="mw kw iq ms b gy nb my l mz na">/etc/apt/sources.list.d/jenkins.list'</span><span id="be86" class="mw kw iq ms b gy nb my l mz na">sudo apt-get update</span><span id="70b8" class="mw kw iq ms b gy nb my l mz na">sudo apt-get install jenkins</span></pre><p id="1259" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">詹金斯需要Java。我们可以安装开放Java开发工具包(OpenJDK)。我们可以在这里看到安装Jenkins所需的所有信息:<a class="ae mq" href="https://www.jenkins.io/doc/book/installing/" rel="noopener ugc nofollow" target="_blank">https://www.jenkins.io/doc/book/installing/</a></p><p id="6b0a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">Jenkins可以安装在许多发行版(Linux、macOS、Windows等)上，并部署在私有或公共云上，如IBM Cloud或其他。您可以使用不同的命令来启动一些Jenkins服务，例如:</p><p id="0b67" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">注册詹金斯服务</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="5112" class="mw kw iq ms b gy mx my l mz na">sudo systemctl daemon-reload</span></pre><p id="0584" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">启动Jenkins服务</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="b3ef" class="mw kw iq ms b gy mx my l mz na">sudo systemctl start jenkins</span></pre><p id="d38c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">检查Jenkins服务的状态</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="218a" class="mw kw iq ms b gy mx my l mz na">sudo systemctl status jenkins</span></pre><p id="a3e4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">如果一切都设置正确，您应该会看到如下输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/792e0b7289f875fbbce3cd33f255fcc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CeTggofgPbuZPm3HzdtUEQ.png"/></div></div></figure><p id="73fb" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">詹金斯使用端口8080。我们可以使用ufw打开它:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="64b1" class="mw kw iq ms b gy mx my l mz na">sudo ufw allow 8080</span></pre><p id="980d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">并检查状态以确认新规则:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="d18f" class="mw kw iq ms b gy mx my l mz na">sudo ufw status</span></pre><p id="d3fa" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">要启动Jenkins，通过键入hostame -I获得服务器的IP地址，并通过输入您的IP和端口:192.168.1.XXX:8080启动您的浏览器</p><p id="2654" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">您应该会看到类似这样的内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b8f04e0dd484275e6e2ac649a01b1905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*NoEzbNOR9RKqATLabdorcA.png"/></div></figure><p id="2edd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在您的终端中，使用cat命令显示密码:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="2e97" class="mw kw iq ms b gy mx my l mz na">sudo cat /var/lib/jenkins/secrets/initialAdminPassword</span></pre><p id="317c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">复制护照并粘贴在<em class="mp">管理员密码</em>中，点击<em class="mp">继续</em>。</p><p id="56ee" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然后按照一些简单的步骤来配置您的环境。</p><h1 id="f52d" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">场景实施</h1><p id="aec0" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">假设我们需要定期训练我们的模型。在这种情况下，建议在Jenkins中包装该过程，以避免手工操作，并使代码更易于维护和改进。在本文中，我们将展示两个场景:</p><p id="b162" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">场景1: </strong>当有人更新机器学习代码或提供额外数据时，我们会自动克隆一个GitHub知识库。然后，詹金斯将自动开始一个模型的训练，并提供分类准确度，检查准确度是否低于80%。</p><p id="39cd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">场景2: </strong>我们将执行与场景1相同的操作，并添加一些额外的任务。我们将自动开始多层感知器神经网络(NN)模型的训练，提供分类准确度分数，检查它是否小于80%，如果是，运行train-auto-nn.py，它将寻找我们模型的最佳超参数，并打印新的准确度和最佳超参数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/88afe9a7c6e5cbaa9c8fd7128a85ddd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byBR0SNI3nUnRz3ngsPpiA.jpeg"/></div></div></figure><p id="d264" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">场景1 </strong></p><p id="2325" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们将首先使用Dockerfile创建一个容器映像。可以看以前的文章来做:<a class="ae mq" href="https://xaviervasques.medium.com/quick-install-and-first-use-of-docker-327e88ef88c7" rel="noopener">快速安装并首次使用Docker </a>，<a class="ae mq" rel="noopener" target="_blank" href="/build-and-run-a-docker-container-for-your-machine-learning-model-60209c2d7a7f">使用Docker和Python Rest APIs搭配Flask </a>为你的机器学习模型和<a class="ae mq" rel="noopener" target="_blank" href="/machine-learning-prediction-in-real-time-using-docker-and-python-rest-apis-with-flask-4235aa2395eb">机器学习预测实时构建并运行Docker容器。然后，我们将在Jenkins中使用build pipeline来创建作业链。我们将使用一个简单的模型，线性判别分析，用scikit-learn编码，我们将用EEG数据(train.csv)训练它。在我们的第一个场景中，我们希望设计一个Jenkins流程，其中每个作业将执行不同的任务:</a></p><p id="1e3a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">- <strong class="lp ir">工作#1: </strong>当我们在GitHub中更新代码时，自动提取GitHub库</p><p id="8899" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">- <strong class="lp ir">工作#2: </strong>自动启动机器学习应用，训练模型，给出预测精度。检查模型精度是否低于80%。</p><p id="84b9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">詹金斯使用我们的linux与用户所谓的<em class="mp">詹金斯</em>。为了让我们的<em class="mp"> jenkins </em>用户使用<strong class="lp ir"> sudo </strong>命令，我们可能想要告诉操作系统在执行命令时不要询问密码。为此，您可以键入</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="c634" class="mw kw iq ms b gy mx my l mz na">sudo visudo /etc/sudoers</span></pre><p id="df5e" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这将在编辑模式下打开<em class="mp"> sudoers </em>文件，您可以如下添加或修改文件:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="f41e" class="mw kw iq ms b gy mx my l mz na">jenkins ALL=(ALL) NOPASSWD: ALL</span></pre><p id="aa6b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">另一种可能更安全的方法是在/etc/sudoers.d目录中创建一个文件，因为该目录中包含的所有文件都将被自动处理，从而避免修改sudoers文件，并防止升级过程中出现任何冲突或错误。您唯一需要做的就是在sudoers文件的底部包含这个命令:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="12e7" class="mw kw iq ms b gy mx my l mz na">#includedir /etc/sudoers.d</span></pre><p id="dc7a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">要使用正确的权限在/etc/sudoers.d中创建新文件，请使用以下命令:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="a4d7" class="mw kw iq ms b gy mx my l mz na">sudo visudo -f /etc/sudoers.d/filename</span></pre><p id="01f9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">现在我们只需要在文件中包含相关的行:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="c386" class="mw kw iq ms b gy mx my l mz na">jenkins ALL=(ALL) NOPASSWD: ALL</span></pre><p id="764b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">打开Jenkins并点击<em class="mp">自由式项目</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/2e1d36b3c07ddb3c4d9d96ab13654c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcTk9ZC9bShJhbIyukG2Dw.png"/></div></div></figure><p id="c2ba" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">工作#1: </strong>当我们在GitHub中修改ML代码时，自动提取GitHub库</p><p id="b5f3" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">点击<em class="mp">创建一个作业</em>并将其命名为<em class="mp">下载</em>或其他名称。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/24bb845bc1d916aef2b046ff39472ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziY0WrrCdq_rMlMcTgfN5g.png"/></div></div></figure><p id="82ba" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在源代码管理中，选择Git，插入您的存储库URL和您的凭证。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/54925c2587b0676382d2fc82edf87aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJCodeLP6iuWjFzFRK9AdQ.png"/></div></div></figure><p id="b3b4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">转到构建触发器并选择轮询SCM</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/cdbd883ba19a4f5cb9ee785d3dc8467d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bxil_5JAM2GxkxCAt-KMQw.png"/></div></div></figure><p id="54bc" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">你可以点击“？”获得一些帮助，但仅举一个例子，H/10****意味着每10分钟从GitHub下载一次代码。这对于我们的示例来说并不太有用，所以您可以将Schedule框留空。如果您让它为空，它将只在由提交后挂钩触发时，由于SCM更改而运行。</p><p id="d62d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然后，单击“添加构建步骤”下拉菜单，并选择“执行shell”。键入以下命令，将GitHub存储库的容器复制到您之前创建的特定路径:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="8dfe" class="mw kw iq ms b gy mx my l mz na">sudo -S cp * /home/xavi/Public/Code/Kubernetes/Jenkins/code</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/8338d0ba91a0e970909a450900dd33d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cLGqmF4evGxUHH_-jw3gmQ.png"/></div></div></figure><p id="4bbd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">并点击<em class="mp">保存</em>。</p><p id="72e9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们可以点击“立即构建”,您应该会在创建的存储库中看到您的代码。当我们在GitHub存储库中修改我们的文件时(git add，git commit，git push)，这些文件将在我们创建的存储库中自动更新。</p><p id="aba0" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">工作#2: </strong>自动开始训练我们的机器学习模型，给出预测精度</p><p id="eddc" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">让我们从建立我们的docker形象开始(我们可以将这一步直接放入Jenkins):</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="6947" class="mw kw iq ms b gy mx my l mz na">docker build -t my-docker -f Dockerfile .</span></pre><p id="9dbd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">按照相同的步骤，我们将创建一个新作业。我们需要进入<em class="mp">构建触发器</em>并在其他项目构建完成后点击<em class="mp">构建</em>并输入<strong class="lp ir">作业#1 </strong>的名称(在我们的例子中是<em class="mp">下载</em>):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/b391c35210a01d56c0bf1e627c62f5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*upQU0ZaC8GyXA7OTyHFXpA.png"/></div></div></figure><p id="4e1d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">仅当构建稳定时，点击<em class="mp">触发器。</em></p><p id="aa4c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然后，在<em class="mp"> Build </em>中打开一个<em class="mp"> Execute shell </em>并键入以下命令，自动启动机器学习应用程序，训练模型并将预测精度打印在一个文件(result.txt)中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/043d52b7a3d7f215a01de2a6ed2f4d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*diYjV0uHDdfO-X0EMFo8hg.png"/></div></div></figure><p id="694f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在这里，我们检查<em class="mp"> my-docker-lda </em>是否已经构建，然后运行我们的容器并将lda模型的准确性保存在一个<em class="mp"> result.txt </em>文件中。下一步是检查模型的准确度是否小于80%,如果是，则输出“是”,否则输出“否”。例如，我们可以发送电子邮件来提供信息:<a class="ae mq" href="https://plugins.jenkins.io/email-ext/" rel="noopener ugc nofollow" target="_blank">https://plugins.jenkins.io/email-ext/</a></p><p id="61f7" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">要查看作业的输出，只需进入<em class="mp">仪表板</em>、<em class="mp">最后成功</em>栏，选择作业，并进入<em class="mp">控制台输出</em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/2c39ece30c3bd90b21c7a5c1ba0a4529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VQF3fAaCPUSP7ooS7V95xg.png"/></div></div></figure><p id="ddea" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">场景二</strong></p><p id="c787" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">让我们保留<strong class="lp ir">工单#1 </strong>和<strong class="lp ir">工单#2 </strong>并创建一个新工单。</p><p id="d146" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">作业#3: </strong>自动启动神经网络训练，给出预测精度，检查精度是否小于80%，如果是，运行docker容器执行autoML</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/84a845245b3f03890bd75fa581e3e863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZPisUH-xWT7Mhxfgqnm-Ug.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/bea3162201d350a60cee2bb317c70573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRYIr6MPqOU3P_aCfasi2g.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/09f5888d6541447212e641887ee94d19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6MVgQh_eupeVgADjREaCMw.png"/></div></div></figure><p id="bba8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">你应该在<em class="mp">控制台输出</em>中看到所选的参数和新的精度。</p><h1 id="79ec" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">下一步是什么？</h1><p id="f6b2" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Jenkins真正关注的是如何自动化数据科学代码。</p><p id="9ad1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">下一步是考虑将Ansible与Jenkins一起使用。Ansible可以在CI/CD管道中发挥重要作用。Ansible将负责应用程序的部署，我们不需要担心如何部署应用程序以及环境是否设置正确。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="1bbd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">来源:</strong></p><p id="2557" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><a class="ae mq" href="https://medium.com/@fmirikar5119/ci-cd-with-jenkins-and-machine-learning-477e927c430d" rel="noopener">https://medium . com/@ fmirikar 5119/ci-CD-with-Jenkins-and-machine-learning-477 e 927 c430 d</a></p><p id="2598" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><a class="ae mq" href="https://www.jenkins.io/" rel="noopener ugc nofollow" target="_blank"> https://www.jenkins.io </a></p><p id="d20b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><a class="ae mq" href="https://cloud.ibm.com/catalog/content/jenkins" rel="noopener ugc nofollow" target="_blank">https://cloud.ibm.com/catalog/content/jenkins</a></p><p id="dad8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><a class="ae mq" rel="noopener" target="_blank" href="/automating-data-science-projects-with-jenkins-8e843771aa02">https://towards data science . com/automating-data-science-projects-with-Jenkins-8e 843771 aa 02</a></p></div></div>    
</body>
</html>