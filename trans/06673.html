<html>
<head>
<title>Reconstruct Source Galaxy Images from Strong Gravitational Lens Images Using U-Net</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用U-Net从强引力透镜图像重建源星系图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reconstruct-source-galaxy-images-from-strong-gravitational-lens-images-using-u-net-1d8221100601?source=collection_archive---------30-----------------------#2021-06-15">https://towardsdatascience.com/reconstruct-source-galaxy-images-from-strong-gravitational-lens-images-using-u-net-1d8221100601?source=collection_archive---------30-----------------------#2021-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a0da" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何生成遥远星系的无透镜图像</h2></div><p id="0c44" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">引力使遥远星系的光线弯曲，这使得它们看起来像透镜。下面的图像向我们展示了来自遥远类星体的光如何由于透镜星系的强大引力而弯曲，透镜星系的作用类似于类星体(源)和观察者之间的光学透镜。这产生了一个扭曲的类星体图像，显示在图像的右侧。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/dadc5aa40644949f24623092a22fac8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZUvm_GmuWJAy2aCddbz5g.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">强引力透镜的简单说明</strong> <strong class="bd lr"> | </strong> <strong class="bd lr">作者图，星系图像</strong>:曼德尔鲍姆、蕾切尔、莱克纳、克莱尔、利奥特、亚历克西、&amp;罗、巴纳比。(2012).宇宙真实星系数据集。芝诺多。<a class="ae ls" href="http://doi.org/10.5281/zenodo.3242143" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.3242143</a></p></figure><p id="4d7c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个项目试图重建被引力透镜扭曲的遥远光源的原始图像。</p><p id="4056" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<a class="ae ls" href="https://en.wikipedia.org/wiki/Convolutional_neural_network" rel="noopener ugc nofollow" target="_blank">卷积神经网络</a>、<a class="ae ls" href="https://en.wikipedia.org/wiki/U-Net" rel="noopener ugc nofollow" target="_blank"> U-Net </a>和带有<a class="ae ls" href="https://en.wikipedia.org/wiki/Structural_similarity" rel="noopener ugc nofollow" target="_blank">结构相似性指数的均方误差</a>，我们能够生成这些星系的无透镜图像。即消除<a class="ae ls" href="https://en.wikipedia.org/wiki/Strong_gravitational_lensing" rel="noopener ugc nofollow" target="_blank">强引力透镜</a>的影响，生成源图像。此外，我们能够预测导致这种扭曲的强引力透镜的透镜参数。我们致力于开发一种算法来消除这种视觉效应，以便我们可以检测其他可能的未识别引力透镜。即重建源星系的图像。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lt"><img src="../Images/1b7da5861aaa8a39c9ce106c7ca4e44d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Ycmd9ylLQdsWK-n71j1EA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">解除强引力透镜效应| </strong> <strong class="bd lr">作者图，星系图像</strong>:曼德尔鲍姆、蕾切尔、拉克纳、克莱尔、莱奥陶德、亚历克西、&amp;罗、巴纳比。(2012).宇宙真实星系数据集。芝诺多。<a class="ae ls" href="http://doi.org/10.5281/zenodo.3242143" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.3242143</a></p></figure><h1 id="515f" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">资料组</h1><p id="6069" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">由于没有多少强引力透镜的图像可用，我们决定使用<a class="ae ls" href="https://zenodo.org/record/3242143" rel="noopener ugc nofollow" target="_blank">宇宙数据集</a>来模拟数据。Cosmos数据集有60K个星系图像。我们利用红移特性过滤出星系，用于我们的项目。过滤星系后，我们使用<a class="ae ls" href="https://github.com/sibirrer/lenstronomy" rel="noopener ugc nofollow" target="_blank">透镜体</a>和随机生成的透镜参数来模拟源星系的透镜图像。我们还使用旋转<a class="ae ls" href="https://github.com/JelleAalbers/minilensmaker" rel="noopener ugc nofollow" target="_blank">数据增强</a>来生成更多的模拟数据。我们的数据集由生成的透镜图像和它的源真实星系对组成。这些图像是64x64灰度图像。基于galaxy独特的源id，它们被分布到测试、验证和训练数据集，以避免数据集之间的数据泄漏。透镜图像用于预测星系引力透镜的透镜参数。给定透镜图像，无透镜图像是用于预测无透镜星系的同一星系的正确描述。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mr"><img src="../Images/8376aadb18b4ad598be4969088fb8f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*og5NdH4Bd9lJ-Tl4OVSIvQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">数据增强创建模拟强引力透镜数据|作者图，</strong> <strong class="bd lr">星系图像</strong>:曼德尔鲍姆、雷切尔、拉克纳、克莱尔、利乌托德、亚历克西、&amp;罗、巴纳比。(2012).宇宙真实星系数据集。芝诺多。<a class="ae ls" href="http://doi.org/10.5281/zenodo.3242143" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.3242143</a></p></figure><h1 id="d734" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">方法</h1><p id="372f" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">我们把问题分成两步。</p><p id="6cbc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，预测8个<a class="ae ls" href="https://www.nature.com/articles/nature23463" rel="noopener ugc nofollow" target="_blank">透镜参数</a>:</p><ul class=""><li id="7e58" class="ms mt iq kh b ki kj kl km ko mu ks mv kw mw la mx my mz na bi translated"><a class="ae ls" href="https://en.wikipedia.org/wiki/Einstein_radius" rel="noopener ugc nofollow" target="_blank">爱因斯坦半径</a>(θ_ E)</li><li id="41d3" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">透镜的幂律质量分布指数(伽马)</li><li id="f546" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">透镜的椭圆度分量(e1，e2)</li><li id="a15c" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">镜头在图像中的位置(center_x，center_y ),单位为弧秒</li><li id="e981" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">透镜图像的外部剪切分量(γ1，γ2)。</li></ul><p id="66fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其次，U-net从它的透镜对图像生成无透镜源星系图像。</p><h1 id="1552" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">架构第1部分:预测透镜参数</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ng"><img src="../Images/0bbf5c2d1eabe46e757837538b140094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AfD-cvpl1MWYphVR0ETm0Q.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">预测透镜参数|作者图表，银河影像</strong>:曼德尔鲍姆，瑞秋，拉克纳，克莱尔，利奥特，亚历克西，&amp;罗，巴纳比。(2012).宇宙真实星系数据集。芝诺多。<a class="ae ls" href="http://doi.org/10.5281/zenodo.3242143" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.3242143</a></p></figure><p id="898e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们预处理我们的图像之后，我们在具有三个块的卷积神经网络中使用我们的训练数据集，使用相应的透镜参数作为最后一层的输出，这产生了我们的第一部分的模型。在每个模块中，我们应用了2D卷积、最大池化、批量标准化和一个Relu激活函数。最后，我们将这些层展平，并将输入传递到两个密集的层中，一个是Relu，另一个是线性函数。我们将所有8个要预测的参数指定为每个数据集中的标签，然后对数据集中的所有图像运行该函数。它能够跨所有三个数据集以良好的度量来预测透镜化参数。</p><p id="5dea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第1部分的超参数:我们调整了Adam的学习速率、CNN的层数、小批量和纪元。</p><pre class="lc ld le lf gt nh ni nj nk aw nl bi"><span id="40b0" class="nm lv iq ni b gy nn no l np nq">model = models.Sequential()<br/>model.add(layers.Conv2D(32, (3, 3),input_shape=(64, 64, 1),use_bias=<strong class="ni ir">False</strong>)) <br/>model.add(layers.MaxPooling2D((2, 2))) model.add(layers.BatchNormalization()) model.add(layers.Activation("relu"))<br/>model.add(layers.Conv2D(64, (3, 3) ,use_bias=<strong class="ni ir">False</strong>)) model.add(layers.MaxPooling2D((2, 2))) model.add(layers.BatchNormalization()) model.add(layers.Activation("relu"))<br/>model.add(layers.Conv2D(64, (3, 3),use_bias=<strong class="ni ir">False</strong>)) model.add(layers.MaxPooling2D((2, 2))) model.add(layers.BatchNormalization()) model.add(layers.Activation("relu")) model.add(layers.Flatten()) model.add(layers.Dense(64, activation='relu')) model.add(layers.Dense(8,activation='linear'))</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nr"><img src="../Images/641a715c549e3a58ec492a0d90cf8612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQkwrLZiOULOoYoRB5z9Xw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">CNN预测透镜参数</p></figure><p id="a57f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试集的每个透镜参数类的“均方根误差”输出的度量:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ns"><img src="../Images/364d097784c9c86e44c10d7d454e3b31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gHbNTS56JtUilHyh"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nt"><img src="../Images/b6e3f2e3c3723a2c7ac7452712240077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rxCn57sEEe5pBPGX"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">每个输出类参数的RMS，<strong class="bd lr">作者的图表，</strong></p></figure><p id="e2ab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这表明θE(爱因斯坦半径)比透镜中心坐标和γ更容易预测，但比透镜椭圆度分量(e1，e2)更难预测。</p><h1 id="0d80" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">架构第2部分:生成源星系图像</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nu"><img src="../Images/1f886effcade89678c3d6b1413f97d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H6JPchdXOGtGpzSbjLW-Iw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">使用U-Net </strong> <strong class="bd lr">将有透镜的图像转换为无透镜的源星系图像|作者的图表，</strong> <strong class="bd lr">星系图像</strong>:曼德尔鲍姆、雷切尔、拉克纳、克莱尔、利乌托德、亚历克西、&amp;罗、巴纳比。(2012).宇宙真实星系数据集。芝诺多。<a class="ae ls" href="http://doi.org/10.5281/zenodo.3242143" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.3242143</a></p></figure><p id="19c4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第二部分中，我们将一张有透镜的图像转换成一张无透镜的源星系图像。为此，我们使用我们的U-net编码器/解码器网络和图像相似性作为我们的误差/损失函数。</p><h2 id="22c5" class="nm lv iq bd lw nv nw dn ma nx ny dp me ko nz oa mg ks ob oc mi kw od oe mk of bi translated">U-Net实验和超参数调谐</h2><p id="8aef" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">我们开始了一个简单的<a class="ae ls" href="https://en.wikipedia.org/wiki/U-Net" rel="noopener ugc nofollow" target="_blank"> U-Net </a>，它具有多个Conv2D、最大池、<a class="ae ls" href="https://naokishibuya.medium.com/up-sampling-with-transposed-convolution-9ae4f2df52d0" rel="noopener">转置卷积层</a>，以及带有MSE损耗和Adam优化器的最后一层的线性激活。之后，我们在U-Net中添加了更多的隐藏块，提高了它的性能。然后我们实验了不同的激活函数:relu，elu等。Relu为我们提供了更好的中间层结果。然后，我们加入了对结果没有太大改善的辍学者，所以把它去掉了。此外，添加批处理规范化有助于U-Net。仍然没有从人工误差分析中为螺旋星系生成更好的图像，所以我们决定使用不同的图像相似性损失函数。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi og"><img src="../Images/51b68bb97d73221f0e7f3a8684757ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YHtFJhHfGvErliWD"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">初始模型</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/f078c4ecc176cd4d6a1b788876df1902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yynIsoaDhYdxobv_"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">MSE生成正确形状的中间模型</strong><strong class="bd lr">|星系图像</strong>:曼德尔鲍姆、蕾切尔、莱克纳、克莱尔、利奥特、亚历克西、&amp;罗、巴纳比。(2012).宇宙真实星系数据集。芝诺多。【http://doi.org/10.5281/zenodo.3242143 T4】</p></figure><p id="539f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">指标和自定义损失函数:</strong></p><p id="5d05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用图像结构相似性SSIM指数、峰值信噪比(PSNR)和均方误差(MSE)作为损失函数进行实验。SSIM给了我们更好的结果。我们通过编写一个结合了SSIM和MSE的自定义损失函数来进一步改进我们的结果。</p><h2 id="fc80" class="nm lv iq bd lw nv nw dn ma nx ny dp me ko nz oa mg ks ob oc mi kw od oe mk of bi translated">具有定制损耗功能的U-Net</h2><pre class="lc ld le lf gt nh ni nj nk aw nl bi"><span id="cf15" class="nm lv iq ni b gy nn no l np nq">inputs = Input((64, 64, 1))</span><span id="76be" class="nm lv iq ni b gy oi no l np nq">s = Lambda(lambda x: x / 255) (inputs)<br/>c1 = Conv2D(16, (3, 3),  padding='same',use_bias=False) (s)</span><span id="cd4b" class="nm lv iq ni b gy oi no l np nq">c1 = BatchNormalization()(c1)<br/>c1 = Activation('relu')(c1)<br/>c1 = Conv2D(16, (3, 3), padding='same',use_bias=False) (c1)<br/>c1 = BatchNormalization()(c1)<br/>c1 = Activation('relu')(c1)<br/>p1 = MaxPooling2D((2, 2)) (c1)</span><span id="1cff" class="nm lv iq ni b gy oi no l np nq">c2 = Conv2D(32, (3, 3),  padding='same',use_bias=False) (p1)<br/>c2 = BatchNormalization()(c2)<br/>c2 = Activation('relu')(c2)<br/>c2 = Conv2D(32, (3, 3), padding='same',use_bias=False) (c2)<br/>c2 = BatchNormalization()(c2)<br/>c2 = Activation('relu')(c2)<br/>p2 = MaxPooling2D((2, 2)) (c2)</span><span id="1c0b" class="nm lv iq ni b gy oi no l np nq">c3 = Conv2D(64, (3, 3), padding='same',use_bias=False) (p2)<br/>c3 = BatchNormalization()(c3)<br/>c3 = Activation('relu')(c3)<br/>c3 = Conv2D(64, (3, 3), padding='same',use_bias=False) (c3)<br/>c3 = BatchNormalization()(c3)<br/>c3 = Activation('relu')(c3)<br/>c3 = Conv2D(64, (3, 3), padding='same',use_bias=False) (c3)<br/>c3 = BatchNormalization()(c3)<br/>c3 = Activation('relu')(c3)<br/>p3 = MaxPooling2D((2, 2)) (c3)</span><span id="8fc7" class="nm lv iq ni b gy oi no l np nq">c4 = Conv2D(128, (3, 3), padding='same', use_bias=False) (p3)<br/>c4 = BatchNormalization()(c4)<br/>c4 = Activation('relu')(c4)<br/>c4 = Conv2D(128, (3, 3), padding='same',use_bias=False) (c4)<br/>c4 = BatchNormalization()(c4)<br/>c4 = Activation('relu')(c4)<br/>p4 = MaxPooling2D(pool_size=(2, 2)) (c4)</span><span id="eb55" class="nm lv iq ni b gy oi no l np nq">c5 = Conv2D(256, (3, 3), padding='same',use_bias=False) (p4)<br/>c5 = BatchNormalization()(c5)<br/>c5 = Activation('relu')(c5)<br/>c5 = Conv2D(256, (3, 3),  padding='same',use_bias=False) (c5)<br/>c5 = BatchNormalization()(c5)<br/>c5 = Activation('relu')(c5)</span><span id="2175" class="nm lv iq ni b gy oi no l np nq">u6 = Conv2DTranspose(128, (2, 2), strides=(2, 2), padding='same') (c5)<br/>u6 = concatenate([u6, c4])<br/>c6 = Conv2D(128, (3, 3),  padding='same',use_bias=False) (u6)<br/>c6 = BatchNormalization()(c6)<br/>c6 = Activation('relu')(c6)<br/>c6 = Conv2D(128, (3, 3),  padding='same',use_bias=False) (c6)<br/>c6 = BatchNormalization()(c6)<br/>c6 = Activation('relu')(c6)</span><span id="4ddc" class="nm lv iq ni b gy oi no l np nq">u7 = Conv2DTranspose(64, (2, 2), strides=(2, 2), padding='same') (c6)<br/>u7 = concatenate([u7, c3])<br/>c7 = Conv2D(64, (3, 3),  padding='same',use_bias=False) (u7)<br/>c7 = BatchNormalization()(c7)<br/>c7 = Activation('relu')(c7)<br/>c7 = Conv2D(64, (3, 3),  padding='same',use_bias=False) (c7)<br/>c7 = BatchNormalization()(c7)<br/>c7 = Activation('relu')(c7)<br/>c7 = Conv2D(64, (3, 3),  padding='same',use_bias=False) (c7)<br/>c7 = BatchNormalization()(c7)<br/>c7 = Activation('relu')(c7)</span><span id="ecf9" class="nm lv iq ni b gy oi no l np nq">u8 = Conv2DTranspose(32, (2, 2), strides=(2, 2), padding='same') (c7)<br/>u8 = concatenate([u8, c2])<br/>c8 = Conv2D(32, (3, 3), padding='same',use_bias=False) (u8)<br/>c8 = BatchNormalization()(c8)<br/>c8 = Activation('relu')(c8)<br/>c8 = Conv2D(32, (3, 3), padding='same',use_bias=False) (c8)<br/>c8 = BatchNormalization()(c8)<br/>c8 = Activation('relu')(c8)</span><span id="5704" class="nm lv iq ni b gy oi no l np nq">u9 = Conv2DTranspose(16, (2, 2), strides=(2, 2), padding='same') (c8)<br/>u9 = concatenate([u9, c1], axis=3)<br/>c9 = Conv2D(16, (3, 3),  padding='same',use_bias=False) (u9)<br/>c9 = BatchNormalization()(c9)<br/>c9 = Activation('relu')(c9)<br/>c9 = Conv2D(16, (3, 3), padding='same',use_bias=False) (c9)<br/>c9 = BatchNormalization()(c9)<br/>c9 = Activation('relu')(c9)</span><span id="dc86" class="nm lv iq ni b gy oi no l np nq">out = Conv2D(1, (1, 1), use_bias=False) (c9)<br/>out = BatchNormalization()(out)<br/>outputs = Activation('linear')(out)</span><span id="6677" class="nm lv iq ni b gy oi no l np nq"># Optimizer<br/>optimizer = tf.keras.optimizers.Adam(learning_rate=0.001)</span><span id="5177" class="nm lv iq ni b gy oi no l np nq">model = Model(inputs=[inputs], outputs=[outputs])</span><span id="d347" class="nm lv iq ni b gy oi no l np nq">model.compile(loss=mse_ssim_loss, optimizer=optimizer, metrics=['mse',ssim_loss,psnr_loss])</span><span id="dc33" class="nm lv iq ni b gy oi no l np nq">model.summary()</span></pre><h1 id="e4a4" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">结合了SSIM和均方误差的定制损失函数</h1><pre class="lc ld le lf gt nh ni nj nk aw nl bi"><span id="e558" class="nm lv iq ni b gy nn no l np nq">def mse_ssim_loss(y_true, y_pred):<br/>return tf.reduce_mean(tf.math.squared_difference(y_true, y_pred)) - tf.reduce_mean(tf.image.ssim(y_true, y_pred, 1.0))</span></pre><p id="ac14" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个损失函数也为螺旋星系带来了更好的结果。</p><p id="59f5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">val _ MSE:0.0023—val _ ssim _ loss:0.0468—val _ PSNR _ loss:30.6308。损失曲线。</p><p id="2950" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">测试集改进模型的U-Net结果:</strong>更多结果如下</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/78f05d6f6c171482bee069eb50b1ea25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*44FaMmVWRrrHk4mU"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">改进后的模型还带有自定义损失函数生成图案| </strong> <strong class="bd lr">银河影像</strong>:曼德尔鲍姆、蕾切尔、莱克纳、克莱尔、利奥特、亚历克西、&amp;罗、巴纳比。(2012).宇宙真实星系数据集。芝诺多。<a class="ae ls" href="http://doi.org/10.5281/zenodo.3242143" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.3242143</a></p></figure><h1 id="435b" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">见解和未来工作:</h1><p id="b1aa" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">我们试图从我们的训练模型中为来自互联网的原始强引力透镜图像生成一个源，但我们需要对这些数据进行更多的预处理和噪声消除。我们也将尝试高斯噪声消除以及增加更多的数据(基于数据的方法)。我们还将对RGB图像进行实验，并继续完善这两个部分的模型。这样我们就可以更接近预测这些源星系的实际样子。此外，我们将公开模拟数据。</p><h1 id="adb5" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">贡献</h1><p id="7801" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">Git储存库:<a class="ae ls" href="https://github.com/madhumitadange/Generate-Source-Galaxy-Images-from-Strong-Gravitational-Lens-Images" rel="noopener ugc nofollow" target="_blank">从强引力透镜图像生成源星系图像</a></p><p id="318a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据:<a class="ae ls" href="https://drive.google.com/drive/folders/1av08dbI44aa5R2LmY8hXxSSZbEaUuh8U?usp=sharing" rel="noopener ugc nofollow" target="_blank">透镜数据</a></p><h1 id="f8e8" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">承认</h1><p id="a3ab" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">我和我的团队成员<a class="ae ls" href="https://profiles.stanford.edu/anand-bhavsar" rel="noopener ugc nofollow" target="_blank"> Anand Bhavsar </a>要感谢我们的导师<a class="ae ls" href="https://profiles.stanford.edu/jelle-aalbers" rel="noopener ugc nofollow" target="_blank"> Jelle Aalbers </a>先生，他是斯坦福大学的Kavli博士后，天体物理学领域的专家，帮助我们建立数据，为我们建立模型提供指导和建议，并对我们的测试结果给予反馈。</p><h1 id="ccd2" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">更多结果:</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi og"><img src="../Images/bf703dde8087d8487b5ddf3a16fe6ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Rl2TIjZK9LMySTF"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/94cd6141f27fc468b00c7383a334ccfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zPTFqzqS4JUDtTEB"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/7714e43d5d70be0720fadbc29e56171b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vcizXYriDxdbpkV2"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/90b6ef48e02d92fac327f8d838b326c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SNE5L6giQDsSyWoV"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/2197765084f3ee9f1201e8f4ab2f2430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d1UK4-pGtRkis4pb"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/4f6db1f68295e8a2231f1febc2c3163a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L8IrTBLjzXtPYlVj"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/f8f4b82597bbfb4d3ab7f63a926a7275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XCBqSdTiYym-78Ds"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/fc05499d476c57ba7dfe6ce2ee6359ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h39YUBGoAHBH0Bar"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/814bcb9ca06ece36632cab7673e90e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*86uPqd4pHU9-h35b"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><strong class="bd lr">样本输出图像| </strong> <strong class="bd lr">星系图像</strong>:曼德尔鲍姆、蕾切尔、拉克纳、克莱尔、利乌托德、亚历克西、&amp;罗、巴纳比。(2012).宇宙真实星系数据集。芝诺多。<a class="ae ls" href="http://doi.org/10.5281/zenodo.3242143" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.3242143</a></p></figure><h1 id="b68b" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">参考资料:</h1><div class="oj ok gp gr ol om"><a href="https://en.wikipedia.org/wiki/Strong_gravitational_lensing" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">强引力透镜-维基百科</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">强引力透镜效应是一种引力透镜效应，强到足以产生多重图像、弧…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">en.wikipedia.org</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ll om"/></div></div></a></div><p id="6752" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://zenodo.org/record/3242143" rel="noopener ugc nofollow" target="_blank">宇宙真实星系数据集</a></p><div class="oj ok gp gr ol om"><a href="https://www.nature.com/articles/nature23463" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">用卷积神经网络快速自动分析强引力透镜</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">强引力透镜的参数估计是用卷积神经网络自动获得的</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">www.nature.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://github.com/sibirrer/lenstronomy" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">西伯利亚/朗斯托尼</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">lenstronomy是一个多用途的软件包，用于模拟强引力透镜。软件包显示在…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">github.com</p></div></div><div class="ov l"><div class="pc l ox oy oz ov pa ll om"/></div></div></a></div><p id="298e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://en.wikipedia.org/wiki/Structural_similarity" rel="noopener ugc nofollow" target="_blank">结构相似度</a> (SSIM)</p><p id="5cee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://en.wikipedia.org/wiki/Peak_signal-to-noise_ratio" rel="noopener ugc nofollow" target="_blank">峰值信噪比</a> (PSNR)</p><div class="oj ok gp gr ol om"><a href="https://kipac.stanford.edu/" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">欢迎|卡维利粒子天体物理学和宇宙学研究所(KIPAC)</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">中子星是由被称为简并物质的高度压缩的物质构成的，这种物质密度如此之大以至于必须被描述…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">kipac.stanford.edu</p></div></div><div class="ov l"><div class="pd l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://arxiv.org/abs/2002.01479" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">强引力透镜是什么？高倍放大的质量和红移分布…</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">许多遥远的物体只有被高度放大才能被发现，或者变得更有科学价值…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">arxiv.org</p></div></div></div></a></div><div class="oj ok gp gr ol om"><a href="http://spiff.rit.edu/classes/phys240/lectures/grav_lens/grav_lens.html" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">引力透镜理论</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">版权所有迈克尔·里奇蒙。本作品根据创作共用许可协议进行许可。什么是镜头？这是一块…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">spiff.rit.edu</p></div></div><div class="ov l"><div class="pe l ox oy oz ov pa ll om"/></div></div></a></div><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="pf pg l"/></div></figure><div class="oj ok gp gr ol om"><a href="https://naokishibuya.medium.com/up-sampling-with-transposed-convolution-9ae4f2df52d0" rel="noopener follow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">转置卷积上采样</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">如果你听说过转置卷积，并对它的实际含义感到困惑，这篇文章是为…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">naokishibuya.medium.com</p></div></div><div class="ov l"><div class="ph l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://up42.com/blog/tech/image-similarity-measures" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">使用图像相似性度量比较地面实况和预测</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">图像相似性度量在图像融合算法和应用中起着重要的作用...</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">up42.com</p></div></div><div class="ov l"><div class="pi l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/understanding-semantic-segmentation-with-unet-6be4f42d4b47"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">用UNET理解语义分割</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">盐鉴定案例研究</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pj l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/nucleus-segmentation-using-u-net-eceb14a9ced4"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">基于U-网的细胞核分割</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">深度学习如何用于分割医学图像？</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pk l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://www.tensorflow.org/tutorials/images/" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">卷积神经网络(CNN) |张量流核心</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">为了完成这个模型，你将把卷积基(形状为(4，4，64))的最后一个输出张量输入到一个…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">www.tensorflow.org</p></div></div><div class="ov l"><div class="pl l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://www.nature.com/articles/nature23463" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">用卷积神经网络快速自动分析强引力透镜</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">强引力透镜的参数估计是用卷积神经网络自动获得的</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">www.nature.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://hubblesite.org/resource-gallery/images" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">形象</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">探索一个发展中的图片画廊，以天文观测和信息科学内容为特色…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">hubblesite.org</p></div></div><div class="ov l"><div class="pm l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://www.freepik.com" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">面向所有人的免费图片资源</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">数百万免费图文资源。Vectors、库存照片、PSD、图标，所有您需要的创意…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">www.freepik.com</p></div></div><div class="ov l"><div class="pn l ox oy oz ov pa ll om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://www.flaticon.com/" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">Flaticon，最大的免费矢量图标数据库</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">4，714，500+SVG，PSD，PNG，EPS格式或作为图标字体的自由矢量图标。成千上万的免费图标在最大的…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">www.flaticon.com</p></div></div><div class="ov l"><div class="po l ox oy oz ov pa ll om"/></div></div></a></div></div></div>    
</body>
</html>