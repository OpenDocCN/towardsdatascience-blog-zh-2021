<html>
<head>
<title>VLOOKUP implementation in Python in three simple steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python通过三个简单的步骤实现VLOOKUP</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/vlookup-implementation-in-python-in-three-simple-steps-93b5a290fd72?source=collection_archive---------1-----------------------#2021-09-18">https://towardsdatascience.com/vlookup-implementation-in-python-in-three-simple-steps-93b5a290fd72?source=collection_archive---------1-----------------------#2021-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6df9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通常，在数据分析领域，数据清理和处理需要花费最多的时间和精力。虽然与模型开发等更有趣的部分相比，数据清理、过滤和预处理等步骤通常被低估或忽略，但决定输出质量的是数据质量。正如正确的说法，垃圾输入=垃圾输出，反之亦然。</p><p id="91ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Excel中，VLOOKUP、HLOOKUP、xlookup和INDEX MATCH等函数对于从数据表或区域中查找满足给定条件的所需数据非常有用。在本文中，我将描述一种简单的方法，用Python通过三个简单的步骤复制Excel的VLOOKUP函数。本文使用的脚本可以在这个<a class="ae ko" href="https://github.com/hbshrestha/Data_Analytics" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中获得。让我们开始吧。</p></div><div class="ab cl kp kq hx kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="im in io ip iq"><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/6c881dfeeee2955af74e44e47c1ba06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rogn8vW2cGGWVSjYEb-txw.jpeg"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated">图片来自<a class="ae ko" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>作者<a class="ae ko" href="https://unsplash.com/@jey_photography" rel="noopener ugc nofollow" target="_blank"> Jonnelle Yancovic </a></p></figure><h2 id="84a4" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">数据</h2><p id="7916" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">首先，我将描述我们在这篇文章中使用的数据。</p><p id="09e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">世界银行开放数据是一个关于全球发展的免费和开放的数据来源。人们可以从世界银行的<a class="ae ko" href="https://datacatalog.worldbank.org/collections" rel="noopener ugc nofollow" target="_blank">数据库</a>中找到数百个与全球发展相关主题的数据集，包括经济、人口、气候变化、卫生、基础设施、能源等。分析这些指标的时间序列数据对于制定适合一个国家或地区的政策、制度和监管框架至关重要。</p><p id="81b1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">世界银行的数据可以以Excel或CSV格式直接从数据库中下载，也可以使用<code class="fe mk ml mm mn b">pandas_datareader</code>从Python中直接访问，如下面的脚本所示:</p><figure class="kx ky kz la gt lb"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="6e2a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇文章中，我将使用特定国家特定年份的选择性指标。我从世界银行数据库中选择了国内生产总值、人均国内生产总值、电力供应、人口和二氧化碳排放数据，并提供了这些指标的代码，这些数据也可以从网站上获得。接下来，我通过提供ISO代码随机选择了12个国家，并下载了2018年的数据。我用指标名称而不是代码来重命名列，并且只选择索引中的国家。数据帧<code class="fe mk ml mm mn b">df</code>如下所示:</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mq"><img src="../Images/45caba1b7ecb482327eb6076a9984293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4mX_-lCX31haZuOoMkCyQ.png"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated">2018年选自世界银行数据库的发展指标</p></figure><h2 id="c9ce" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated"><strong class="ak">Excel中的VLOOKUP实现</strong></h2><p id="948d" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">在这一节中，我将描述VLOOKUP函数如何在Excel中从数据表或数据区域中获取所需的数据子集。如下面的Excel截图所示，A到F列表示与<code class="fe mk ml mm mn b">df</code>中相同的数据。在I到L列中，我想从第一个表中获得二氧化碳排放量和人口数据。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mr"><img src="../Images/bf594bc8992ec4bd089282636fcfea1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uMeql0zux69I0vBV4VhpyQ.png"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated">在Excel中实现的VLOOKUP函数在右边的表(I1:L6)中从左边的表(A1:F13)中获取值</p></figure><p id="4857" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Excel屏幕截图中用红色矩形表示的公式栏中，我们可以看到用于单元格J2的公式。</p><p id="f091" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mn b">=VLOOKUP($I2, $A$1:$F$13,6,FALSE) * 1000</code></p><p id="57e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中，</p><p id="a61f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mn b">$I2</code>代表我们要在第一个表中查找的国家不丹；</p><p id="12b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mn b">$A$1:$F$13</code>表示整个第一个表，在该表中可以找到查找值和要返回的数据</p><p id="b892" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mn b">6</code>代表栏号(此处代表kt CO2栏),将从该栏返回相应的数值(不丹),以及</p><p id="d714" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mn b">FALSE</code>表示完全匹配。</p><h2 id="3222" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">用Python实现它的三个简单步骤</h2><p id="3918" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">在这里，我描述了上面在Excel中使用的相同函数的实现，但是用Python分三个简单的步骤:</p><p id="aa80" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">首先，</strong>我们创建一个名为<code class="fe mk ml mm mn b">df_target</code>的数据帧，我们希望在其中包含所需的子集数据。最初，数据框架包括五个所需国家的名称。然后我们为想要从<code class="fe mk ml mm mn b">df</code>返回的指标<code class="fe mk ml mm mn b">CO2 emissions (tonnes)</code>和<code class="fe mk ml mm mn b">Population</code>创建空列。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ms"><img src="../Images/f3447d304b60b6b94c310501734fbde9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qUakND2_ifR9twYPM2JrXQ.png"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated">第一步</p></figure><p id="d4e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe mk ml mm mn b">df_target</code>中的<code class="fe mk ml mm mn b">countries</code>列与<code class="fe mk ml mm mn b">df</code>中的<code class="fe mk ml mm mn b">country</code>列共用。因此，<strong class="js iu">其次，</strong>我们将<code class="fe mk ml mm mn b">df_target</code>中的<code class="fe mk ml mm mn b">countries</code>列设置为索引。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mt"><img src="../Images/264793b9d651b124f02627a6fd3ca5da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qy8K6YfojYi4kkWjB3gtcg.png"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated">第二步</p></figure><p id="f647" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第三步，</strong>这是我们将<code class="fe mk ml mm mn b">df_target</code>中的索引映射到<code class="fe mk ml mm mn b">df</code>以获取所需列的数据作为输出的主要步骤。例如，<code class="fe mk ml mm mn b">df</code>的<code class="fe mk ml mm mn b">kt CO2</code>列的值乘以1000后返回给<code class="fe mk ml mm mn b">df_target</code>的<code class="fe mk ml mm mn b">CO2 emissions (tonnes)</code>列。<a class="ae ko" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.map.html" rel="noopener ugc nofollow" target="_blank"> map()函数</a>根据输入对应关系映射系列的值，并用于将系列中的每个值替换为另一个值，该值可从函数、字典或系列中提取。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mu"><img src="../Images/13e06c20bb1cab68e8fecd1609dfe62b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1x0JgZ2SXYvtNtPYPKysA.png"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated">第三步</p></figure><p id="0767" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们学习了一种简单的技术，用Python通过三个简单的步骤实现Excel的VLOOKUP函数。Python中不同包的功能和模块使得几个步骤自动化，否则将花费大量的时间和精力，从这个意义上说，这是优化成本和资源的真正福音。</p></div></div>    
</body>
</html>