<html>
<head>
<title>Power BI — Working with Time Intelligence</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Power BI —使用时间智能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/power-bi-working-with-time-intelligence-3496d288bb61?source=collection_archive---------13-----------------------#2021-12-14">https://towardsdatascience.com/power-bi-working-with-time-intelligence-3496d288bb61?source=collection_archive---------13-----------------------#2021-12-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d138" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基于时间的报告的简单概念</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b2ddb9962dde366fda958aa45b3c304f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-6eJco8OseTWyznm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@loic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Djim Loic </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e973" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Power BI 简化了时间智能的使用。一旦您理解了这些概念，您将能够进行各种复杂的基于时间的报告。</p><p id="4897" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了让时间智能在 Power BI 中工作，您需要一个日期表。没有它肯定不行。一个简单的日期表可以在<a class="ae ky" rel="noopener" target="_blank" href="/dates-in-power-bi-ada30f85e4b3">这里</a>找到。</p><p id="8908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将介绍 Power BI 中一些非常有用的时间智能功能，以及使用它们的步骤。</p><p id="7f5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么使用这些时间智能功能的步骤是什么呢？</p><ol class=""><li id="6d31" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">构建一个日期表</li><li id="7891" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">构建通用衡量标准</li><li id="32f1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将时间智能函数添加到一般度量中</li></ol><p id="4caa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大概就是这样。我们来分析一下。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="b406" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">构建一个日期表</h1><p id="1920" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">这是我用下面的创建的一个简单的日期表格。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d6f4" class="ns mr it no b gy nt nu l nv nw">DATE_TABLE = CALENDAR(DATE(2019,01,01),DATE(2022,01,01))</span></pre><p id="d510" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这段代码中，Power BI 生成从 2019 年 1 月 1 日到 2022 年 1 月 1 日的所有日期。这就是使用 DAX 创建日期表的方法。</p><p id="6cbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的关键词是<em class="nx"> all </em>，记住时间智能功能不会处理缺失的日期。</p><p id="1f6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我还添加了一个额外的列，称为“月 _ 年”,这是通过添加下面的新列来完成的。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="98fc" class="ns mr it no b gy nt nu l nv nw">Month_Year = FORMAT(DATE_TABLE[Date], “MMM-YYYY”)</span></pre><p id="c1c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是日期表格的外观。也可以随意尝试一下 FORMAT 函数。Power BI 为日期列提供了许多不同的格式样式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/30178c30e8d555bb5ccc2184ba4de419.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*RI3dXDIKWRYhBT5tONI60g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="04af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是添加了 DATE_TABLE 的模型的外观。</p><p id="e725" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用日期将 date_TABLE 的 DATE 列与 FACT_TABLE 连接起来。这是一个一对多的关系。</p><p id="16a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想知道为什么这个模型是这样建立的，看看这篇<a class="ae ky" rel="noopener" target="_blank" href="/power-bi-modelling-bcd4431f49f9">文章</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/25dff9beead0eb662b7798a9a79eeca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4mbYV22jvVe1ML4Pioc4fg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d7dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在进入下一步。</p><h1 id="cd60" class="mq mr it bd ms mt oa mv mw mx ob mz na jz oc ka nc kc od kd ne kf oe kg ng nh bi translated">构建一个通用度量。</h1><p id="afc4" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">您在这里建立的度量很重要。永远记住你要回答的问题。</p><p id="57d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于演示的目的，我将创建一个没有任何过滤器的通用销售额。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="49e0" class="ns mr it no b gy nt nu l nv nw">Sales_Measure = SUM(FACT_TABLE[Totals])</span></pre><p id="c07f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是它在 Power BI 中的一个简单表格中的外观。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/763a2b4c815b87abe8754b984f63ff9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*LoMSJwtIrVA6eog8vcZTcQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1339" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是最后一步，也是最有趣的部分。😀</p><h1 id="0da1" class="mq mr it bd ms mt oa mv mw mx ob mz na jz oc ka nc kc od kd ne kf oe kg ng nh bi translated">向度量添加时间智能函数。</h1><p id="8eb7" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我第一次想用的智能函数是 SAMEPERIODLASTYEAR。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="30cc" class="ns mr it no b gy nt nu l nv nw">SAMEPERIODLASTYEAR_Measure = CALCULATE([Sales_Measure] , SAMEPERIODLASTYEAR(’Date_Table’[Date]))</span></pre><p id="e118" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我可以并排看到去年同期的销售额。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/643721d2faf98bebac112fbf8e9685a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*8Xxn2eNcVFbpSX3JfDRQnA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a8f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，2020 年 4 月的销售额是 509，2021 年 4 月是 4444。</p><p id="8b6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SAMEPERIODLASTYEAR 度量从去年开始提取销售额，这样您就可以不用太多代码进行简单的比较。</p><p id="e7fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个巧妙的技巧！</p><p id="91f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以用一个新的时间智能函数替换以前的函数，以创建一个新的度量值来度量不同的东西:)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/5f7afb495bb2241d748f0d6624df4989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UuxiypC-qNaupZ_y7RsJ2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8379" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想换成按月累计和按年累计。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/a659a08ea2721bd714550a53f722bca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFGo4GXZ3VLEOXujG-6QuA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="635c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我再一次用另一种方法来代替时间智能方法。第一个是本月至今，另一个是年初至今</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/4494537ebdbb25f75c22a3108cb2508e.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*DmYn6ZzWAgY6IylW2haTig.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1323" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，您可以看到按月和按年累计的总和。</p><p id="3a88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你已经对这些时间情报工作有了一个基本的概念，你可以在它的基础上进行构建了！</p><p id="3f31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我需要今年迄今为止的总销售额，并将其与去年同期进行比较。我想比较 2020 年和 2019 年的年度累计总数。</p><p id="bad7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，因为我们已经建立了“按年总计”度量，所以我们要做的就是像这样添加度量。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="fa2c" class="ns mr it no b gy nt nu l nv nw">Total_Sales_YTD = CALCULATE([Total_Ses_YTD], SAMEPERIODLASTYEAR (DATE_TABLE[Date]))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/1975a3a01dd79ea8eeea6bcfd8a207f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*s6IgOEPGHTzhxbHbIhJVEA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1d92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，视觉显示去年的运行总数。</p><p id="783f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个被低估的函数是 DATEADD。只要你知道你想在多长时间内旅行，它允许你在任何时间方向旅行。🛸</p><p id="b6b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里我也可以写，</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="1456" class="ns mr it no b gy nt nu l nv nw">Total_Sales_YTD_LY__DATEADD = CALCULATE([Total_Sales_YTD],DATEADD(DATE_TABLE[Date],-1, YEAR))</span></pre><p id="0235" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将是结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/3cac989cf452dc46bdb00693e52165b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*e3r1GRWLVFfaab5ICzqKAA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="71e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">DATEADD 允许您按年、月或日移动。唯一的区别是，您必须计算持续时间，而不是调用像 PREVIOUSYEAR 或 SAMEPERIODLASTYEAR 这样的通用函数。注意不要输入错误的时间间隔。它发生了！</p><p id="0c8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">概括地说，下面是使用 Power BI 中的时间智能功能的步骤。</p><ol class=""><li id="15f9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">建一个日期表</strong>，用它做维度/过滤/主题表，很重要。如果没有日期表，所有这些时间智能功能都将不起作用。</li><li id="fa6f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">建立一个通用的衡量标准</strong>，考虑一下，看看这个衡量标准的结果是否能回答你的业务问题。</li><li id="fe7f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">为通用度量</strong>添加一个时间智能函数，例如用 DATEQTD 替换 DATEYTD 当然会得到不同的结果，但模式是一样的。</li></ol><p id="dacf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的数据之旅中保持安全并祝您好运！</p></div></div>    
</body>
</html>