<html>
<head>
<title>The Easiest Way to Validate Data As An Analytics Engineer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">作为分析工程师验证数据的最简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-easiest-way-to-validate-data-as-an-analytics-engineer-e9d20d777bd4?source=collection_archive---------31-----------------------#2021-12-14">https://towardsdatascience.com/the-easiest-way-to-validate-data-as-an-analytics-engineer-e9d20d777bd4?source=collection_archive---------31-----------------------#2021-12-14</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><div class=""><h2 id="ffb6" class="pw-subtitle-paragraph js iu iv bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">如何使用 Excel 比较两个不同来源的数据模型</h2></div><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/c4db162ab6e1bd352c291701a39de2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-WX7WXkrVz-wuQpWYVjrig.jpeg"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated"><a class="ae la" href="https://unsplash.com/@sigmund?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae la" href="https://unsplash.com/s/photos/checking?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="9cf8" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">作为一名分析工程师，验证数据模型是我工作的一大部分。随着现代数据堆栈的建立，旧的数据堆栈将被取代。随着旧数据栈的替换，新的数据模型也要根据旧的数据模型进行验证。</p><p id="5ba0" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">这可能很困难，因为数据模型位于两个不同的地方。通常情况下，数据太大，无法将一个数据源接收到另一个数据源中以便于比较。有时你必须回到最基础的地方，这就是为什么我在比较数据集时选择 Excel。</p><p id="5a1e" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我目前正在使用<a class="ae la" href="https://fivetran.com/" rel="noopener ugc nofollow" target="_blank"> Fivetran </a>、<a class="ae la" href="https://www.snowflake.com/" rel="noopener ugc nofollow" target="_blank">雪花</a>和<a class="ae la" href="https://www.getdbt.com/" rel="noopener ugc nofollow" target="_blank"> dbt </a>构建数据模型。目前，我们的旧数据模型位于<a class="ae la" href="https://www.domo.com/" rel="noopener ugc nofollow" target="_blank"> Domo </a>中。Domo 被认为是商业智能工具，所以数据模型运行缓慢。这使得在雪花和 Domo 中比较输出变得困难。</p><h2 id="1f37" class="lx ly iv bd lz ma mb dn mc md me dp mf lk mg mh mi lo mj mk ml ls mm mn mo mp bi translated">用例</h2><p id="29ee" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">在验证一个聚合列时，我发现 Domo 和 Snowflake 中的内容有差异。在验证时，我选择一小部分数据进行比较，而不是整个数据集。对于这个实例，我选择了其中<code class="fe mv mw mx my b">start_date</code>列的年份为 2020 并且推荐数不为空的行。</p><pre class="kl km kn ko gt mz my na nb aw nc bi"><span id="a695" class="lx ly iv my b gy nd ne l nf ng">select distinct <br/>   user_id<br/>from "core"."data_models"."referral_info" <br/>where number_of_referrals is not null <br/>   and year(start_date)=2020</span></pre><p id="81bc" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在 Domo 中，我用这些相同的过滤器创建了推荐数据模型的子集。我在这里只选择了<code class="fe mv mw mx my b">user_id</code>列，因为我想直接比较在 Snowflake 中推荐的用户列表和在 Domo 中推荐的用户列表。选择多个列只会使比较更加混乱。</p><p id="47e2" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">通过将数据集限制为具有唯一 id 的一列，我们可以很容易地看到数据中哪里不匹配。一旦我们找到了一个模型中的用户而不是另一个模型中的用户，我们就可以调查为什么会这样。</p><p id="b8a1" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">接下来，我将 Domo 和 Snowflake 中的数据子集导出到 Excel 中。幸运的是，每个数据集只有几千行。如果数据集的行数超过了几千行，那么您会希望对数据集进行更多的过滤。大型数据集导出到 Excel 需要很长时间。</p><h2 id="1120" class="lx ly iv bd lz ma mb dn mc md me dp mf lk mg mh mi lo mj mk ml ls mm mn mo mp bi translated">比较数据集</h2><p id="2f48" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">现在，您已经将两个数据集保存到 Excel 文件中，您将希望找到一种方法来轻松地比较记录。将<code class="fe mv mw mx my b">user_ids</code>的一列与<code class="fe mv mw mx my b">user_ids</code>的另一列复制到 Excel 表中。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/d0cdb7c954fda0e8831ceea5d9c4d789.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*VHu0ckPQfNMA5l9b1koJsw.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><ol class=""><li id="7f64" class="ni nj iv ld b le lf lh li lk nk lo nl ls nm lw nn no np nq bi translated">选择包含两列<code class="fe mv mw mx my b">user_ids</code>的整个数据集</li><li id="966e" class="ni nj iv ld b le nr lh ns lk nt lo nu ls nv lw nn no np nq bi translated">转到主页选项卡，然后单击“样式”</li><li id="2596" class="ni nj iv ld b le nr lh ns lk nt lo nu ls nv lw nn no np nq bi translated">在“样式”中，单击“条件格式”</li><li id="eeed" class="ni nj iv ld b le nr lh ns lk nt lo nu ls nv lw nn no np nq bi translated">将鼠标悬停在“突出显示单元格规则”选项上</li><li id="a9e9" class="ni nj iv ld b le nr lh ns lk nt lo nu ls nv lw nn no np nq bi translated">点击“重复值”</li></ol><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/52df00fbfc2c01e19d92e22a08b0f888.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*2-Wrrnnb2FVTlJ-41TIoxA.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="3ecd" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">6.在弹出窗口中，选择“副本”,并选择您希望它们高亮显示的颜色</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/c5ca0c4dd2c45e4fb3a320ef9c5c459b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*ZP6Y6HdM3jUnS1Wnr3Lysg.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="d358" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">7.单击“确定”</p><p id="9d14" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">现在，您将会看到所有的副本都以您选择的颜色高亮显示。通过这种方式查找重复项，它们不必在同一行。它将在整个数据集中寻找重复项。这就是为什么确保您有一个来自每个数据源的<code class="fe mv mw mx my b">user_ids</code>的独特列表很重要。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/7e497a6d763f602ed8495636c74af6ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*I-y9iduxoi8ouxPPhcIHew.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><h2 id="b82d" class="lx ly iv bd lz ma mb dn mc md me dp mf lk mg mh mi lo mj mk ml ls mm mn mo mp bi translated">调查差异</h2><p id="1ac9" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">现在，您可以更深入地了解是什么原因导致用户在一个数据模型中有大量推荐，而在另一个数据模型中没有。选择每个数据集中<code class="fe mv mw mx my b">user_id</code>，并比较每个数据模型中的列值。</p><p id="d56a" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在这里，我将特别关注具有<code class="fe mv mw mx my b">user_id = 3</code>和<code class="fe mv mw mx my b">user_id = 7</code>的用户。</p><p id="f9bd" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">您的<code class="fe mv mw mx my b">number_of_referrals</code>逻辑中使用的列值是否相同？</p><p id="1df1" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">数据类型是否相同？</p><p id="3733" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">当我进一步研究我的差异时，我发现用于连接两个数据集的列之一在一个模型中是时间戳，而在另一个模型中是日期。这导致数据集无法正确连接，从而消除了参考值。</p><h1 id="4ef2" class="ny ly iv bd lz nz oa ob mc oc od oe mf kb of kc mi ke og kf ml kh oh ki mo oi bi translated">结论</h1><p id="10f1" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">验证数据是分析工程师最棘手的部分之一。它需要对数据模型中使用的数据和逻辑有深刻的理解。导致问题的往往是一些最意想不到的事情，比如数据类型。</p><p id="1893" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">确保您花时间来正确验证您的数据模型。数据的完整性取决于您正在实施的实践。坏数据输入意味着坏数据输出。如果你的数据模型给你不正确的结果，而你的公司把他们的整个分析建立在这些数据模型的基础上，那么会有很多地方出错。</p><p id="2893" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">花时间去理解你的数据。调查一下。找问题。试着找到他们。你总是想在你的模型投入生产之前找到它们。</p></div></div>    
</body>
</html>