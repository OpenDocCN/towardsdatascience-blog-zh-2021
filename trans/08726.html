<html>
<head>
<title>Extracting Feature Vectors From URL Strings For Malicious URL Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从URL字符串中提取特征向量用于恶意URL检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/extracting-feature-vectors-from-url-strings-for-malicious-url-detection-cbafc24737a?source=collection_archive---------5-----------------------#2021-08-12">https://towardsdatascience.com/extracting-feature-vectors-from-url-strings-for-malicious-url-detection-cbafc24737a?source=collection_archive---------5-----------------------#2021-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="2407" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">介绍</h1><p id="2d36" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在网上传播的网络攻击中，恶意网址是相当大比例的攻击媒介。恶意URL要么是指向恶意代码静默下载的链接，要么是指向恶意网页、钓鱼网站等的链接。这种URL已经成为一种流行的在线危害主机的方式，从而创建了大规模的僵尸网络。例如，在驾车下载中，攻击者将恶意javascript嵌入到网页中，当用户访问某个页面时就会执行该脚本。它试图危害用户系统上的浏览器或用户插件。要构建主动模型来识别此类恶意URL，分析师需要能够使用某些功能。这些特征将从简单的URL字符串中提取出来。因此，给定一个简单的URL字符串，我们如何提取有用的特征向量来建立预测？</p><p id="960f" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">在本文中，我将演示如何从URL字符串中提取深入的词汇特征、基于主机的特征和基于内容的特征。这些特征包括从Shodan、WHOIS、Wayback machine中提取的特征，从网站的原始HTML内容中提取的统计特征，以及URL字符串本身的静态特征。本文中提取的特征分为三大类:基于内容的特征、基于主机的特征和词汇特征。本文策划并实现了这些特征作为URL特征向量的提取。这些X特征可以在恶意URL归属问题中用作特征向量，为恶意URL检测建立预测模型，或者为日志流中的不良主机建立简单的快速过滤器。</p><h1 id="8a27" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">数据</h1><p id="9ad8" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我将使用的数据来自<a class="ae lo" href="https://www.unb.ca" rel="noopener ugc nofollow" target="_blank">加拿大网络安全研究所</a>。有一个<a class="ae lo" href="https://www.unb.ca/cic/datasets/url-2016.html" rel="noopener ugc nofollow" target="_blank"> 2016 URL数据集</a>，根据攻击类型对URL进行分类。你可以在他们的网站上下载这些数据，对于这个项目，我们将在这篇文章中使用11，500个恶意网址和35，300个良性网址。恶意软件URL与从DNS-BH获得的恶意软件网站相关。因此，这些网址不包含钓鱼网址或恶意嵌入式下载链接，而是指向包含恶意代码或软件的恶意网站的链接。良性网址是从Alexa顶级网站收集的。一旦你下载了数据，你应该有两个文件'恶意软件_数据集. csv '和'良性_列表_大_最终. csv '。在我的代码中，我将这些文件重命名为“malware.csv”和“良性. csv”。</p><h1 id="85b4" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">URL功能</h1><p id="ae01" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">从URL中提取的特征是确定URL是否是恶意的基础。任何学习努力的成功都取决于训练数据的质量，因此也取决于输入模型的特征的质量。我们必须确保提取的特征代表或潜在地表明我们试图建模的问题。这里，我们的意思是所收集的特征的变化必须代表问题的发生或不存在。因此，问题是，URL字符串的哪些特征可以告诉我们它是恶意的还是非恶意的，或者它是良性的还是非良性的？从URL字符串中提取要素有三种信息来源。</p><ul class=""><li id="f049" class="lp lq iq kn b ko lj ks lk kw lr la ls le lt li lu lv lw lx bi translated"><strong class="kn ir">词法特征</strong>:这些是指从文字URL字符串中提取的统计特征。例如，URL字符串的长度、位数、其查询部分中的参数数量、URL是否被编码等。</li><li id="d97b" class="lp lq iq kn b ko ly ks lz kw ma la mb le mc li lu lv lw lx bi translated"><strong class="kn ir">基于主机的特征</strong>:这些是URL的主机名属性的特征。这些提供关于网页主机的信息，例如，注册国家、域名属性、开放端口、命名服务器、连接速度、从注册开始的生存时间等。</li><li id="e9d9" class="lp lq iq kn b ko ly ks lz kw ma la mb le mc li lu lv lw lx bi translated"><strong class="kn ir">内容特征</strong>:从下载的网页HTML代码中获取。这些特征捕捉网页的结构和嵌入其中的内容。这些信息包括脚本标签、嵌入对象、可执行文件、隐藏元素等。</li></ul><p id="6286" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">我将解释从这些信息源中提取的不同特征，并证明为什么它们与识别恶意或良性URL相关。我还执行了一些基本的统计t测试，以测试恶意和良性之间这些特征的差异的显著性，从而识别每个类别中的关键区别特征。</p><h1 id="21f0" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">词汇特征</h1><p id="0af7" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">词法特征从URL字符串中获得。包含词汇特征的动机是基于一个简单的事实，即恶意URL看起来不同于良性URL，因此我们可以提取统计属性来量化这些外观的差异。举个简单的例子，URL“Amazon . com”中“. com”的存在和位置看起来并不可疑，但是，相同的子字符串在“amazon.com.support.info”中看起来是恶意的。另一个经典的例子是黑客常用的策略是<strong class="kn ir"> <em class="md">混淆</em> </strong>一个恶意的网址看起来像一个合法的网址。他们通过模仿流行品牌的名字并对其稍加改动来做到这一点(googleinfo.com，apple-support.com)。检测网络钓鱼网址的不同项目一致认为，不同类型的网址表现出不同的字母分布。这里的“字母分布”指的是URL字符串中字符的顺序、字符的复杂性等。这些是一些可能被提取的词汇特征。我仅从URL字符串中提取了18个词汇特征。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/bc4a74ea7baeb10aa8ef133a11d1dfef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*laAcBkYX2GMMm7gJNGWwWQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">词汇特征表</p></figure><p id="ed14" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">URL的方案很重要，因为这表明网页上配置了何种安全级别(HTTP/HTTPS)，服务器的用途是什么(显示信息(HTTP)，传输文件(FTP)，通过网站收集的信息是否加密(HTTPS)等)。显示为IP地址的主机或域名通常意味着主机没有解析为域名，或者没有正确配置为指向域名。</p><p id="8d3e" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">最常用的词汇特征包括URL字符串的一些上述统计属性，如URL字符串的长度、模式、路径长度、子目录等。然而，一些不太明显的问题，如在URL和URL编码中出现某些关键字，也值得包括在内。众所周知，DGA域名的字母分布比合法域名更加混乱<a class="ae lo" href="https://github.com/SuperCowPowers/data_hacking/blob/master/dga_detection/DGA_Domain_Detection.ipynb" rel="noopener ugc nofollow" target="_blank">见</a>。合法的域名往往有定义明确的名称，说明一个品牌或产品，所以倾向于不那么杂乱无章。因此，测量URL字符串的熵可以告诉我们哪些域名“不太真实”。</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="a00f" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">这也适用于作为IP地址的域名，例如“42 . 50 . 23 . 80/子目录. com”。例如，当恶意网站托管在受损公共网络中的受害者机器上时。其他词汇特征，如‘的存在。com '作为域扩展名，表示。URL字符串中的“com”。在下表中，我列出了样本中恶意和良性URL之间的显著不同的特征。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mw"><img src="../Images/0825fa8996b72291488fc9dff359566f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZX5Sd4qJFHHGu88hdyIg5Q.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">词汇特征的箱线图</p></figure><p id="8b63" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">目测，我们看到良性网址的熵更高，一般比恶意网址长。此外，所有的网址中至少有一个句点(如预期的那样)，但恶意网址中平均至少有两个句点。类似地，我们可以捕捉某些“红旗”关键字出现在URL字符串中的事实。这些关键字可能涉及攻击者在试图欺骗合法页面时使用的关键字，或者涉及黑客将试图操纵的网站上的安全设置的流行术语的关键字。例如，URL中的关键字“admin”通常表示站点管理用户的身份验证页面。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mx"><img src="../Images/566f4622d6de81c6c4fb93ad1048c67b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-cKzt-TcBD43JU4NrQlmQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">红色标记关键字的条形图</p></figure><p id="3296" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">在我们的示例中，只有恶意URL将IP作为主机名，并将端口号作为URL字符串。正如前面所解释的，恶意URL中绝大多数都包含子字符串“admin”。我们还可以探索恶意和良性网址的“域扩展”或“TLD”矩阵。给定一个逻辑矩阵，其中0和1表示URL中是否存在TLD，我们可以估计良性和恶意文件之间每个TLD的平均差异，并返回两组之间有显著差异的文件。我们可以创建一个TLD矩阵，并从两组之间的独立t检验中提取差异和p值。</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="c088" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">现在，我们可以排除P值小于0.05的TLD(在95%的置信水平下测试)，并绘制恶意和良性URL之间TLD的排序平均差异和P值。我们用最高平均差和最低(最高)显著P值作图。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi my"><img src="../Images/6e2fb1eb2817cc23c5cf1531bdbf3bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kx_VikMcj2k0CnSpCJQwjg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">词汇特征平均差异的显著性(恶意——良性)</p></figure><p id="3488" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">每个条形的宽度是Y轴上恶意和良性TLD之间的平均差异。条形按其显著差异的降序排列(因此最小的P值是第一个条形)。顶级域名如。信息，。茹，还有。cn更像是恶意网址的同义词，而良性网址则更容易链接到。com和。net域。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mz"><img src="../Images/9a2f28bf3e804307cb304126e3e344cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pg5q6EWLcf_1TJH3Sr-xUQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">基于词汇特征的互相关图</p></figure><p id="c142" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir"> <em class="md">恶意网址长度一般比良性网址</em> </strong>短。相关图显示，虽然良性URL的熵可能比恶意字符串略高，但恶意URL字符串的长度比良性字符串短。良性字符串也记录更多的数字计数和更多的编码字符。这是可以预期的，尤其是大多数良性网站流行的某些博客或文章命名约定，例如，'【https://blogname.com/article-name/YYYY-MM-DD】'或'<a class="ae lo" href="https://hollywoodlife.com/2015/05/13/justin-bieber-perfect-girl-someone-pushes-spiritually/" rel="noopener ugc nofollow" target="_blank">' https://Hollywood life . com/2015/05/13/Justin-Bieber-perfect-girl-someone-pusses-spiritically/</a>'。最后，运行'<a class="ae lo" href="https://raw.githubusercontent.com/eneyi/eneyi.github.io/master/assets/random/get_lexical_features.py" rel="noopener ugc nofollow" target="_blank">get _ lexical _ features . py</a>'(&lt;&lt;在此获取完整代码)</p><h1 id="7ccb" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">基于内容的功能</h1><p id="c7f4" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">基于内容的特征是从原始内容(即网页的HTML和javascript内容)中提取的统计信息。这些包括关于页面的原始编码内容的信息，例如空白百分比、页面上的标记数量、脚本数量、脚本中的字符数量，以及HTML代码的结构信息，例如某些标签的位置和存在。包含这些基于内容的功能背后的基本原理是捕获在受损页面中发现的页面内容特征，例如，存在注入的内容或被设计为包含恶意代码的页面，例如，存在某些脚本标签或可疑的HTML元素。<a class="ae lo" href="https://dl.acm.org/doi/abs/10.1145/1963405.1963436" rel="noopener ugc nofollow" target="_blank"> Prophiler项目</a>寻找攻击副作用的存在，例如注入页面上不合适的标签。例如，在SQL注入攻击中，格式错误的文档或重复的标签等异常情况会出现在原始HTML内容中。</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="7626" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">这组特征提取的目标是寻找页面上的“可疑”内容。可疑对象可能包括HTML标签之间存在纯文本格式的外壳代码，存在双“”、“”和“<title>”元素，存在零大小或隐藏的iframes，存在可疑的“<object>”和“<embed>”标签等。除了在HTML代码内容中寻找可疑活动，我们还可以从脚本中的函数调用和关键字中搜索可疑活动。通常，我们不能访问外部脚本，但我们也可以从内嵌和包含的脚本中提取大量信息。例如，下载驱动在攻击执行期间调用几个DOM修改函数和事件附件。此外，一些javascript函数被恶意行为者用来加密恶意代码或执行不需要的例程。还有一些在跨站脚本攻击中使用的流行脚本函数有<strong class="kn ir"> <em class="md"> escape()、eval()、link()、unescape()、exec()和search() </em> </strong>。此外，可以编写恶意脚本，将iframe，其他脚本，object标记，embed标记和frame标记插入网页，如果没有混淆，就有可能使用这些元素' iframe '，' object '，' embed '来识别DOM修改脚本。提取以下24个基于内容的特征:</embed></object></title></p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi na"><img src="../Images/c1fa4066894a2460326a58790251fc0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcBNkgE0pedB6vlTkVaZtA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">基于内容的功能表</p></figure><p id="e525" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">如前所述，我们对以下基于内容的特征的均值差异进行了简单的独立t检验。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nb"><img src="../Images/9f79578b60e8272dec0061f00cff4643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YQuCUtc5HQvs2Wz5TdVqxg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">基于宿主特征的均值差异的显著性</p></figure><p id="0807" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir"> <em class="md">良性网站的内容比恶意网站多。</em> </strong>一般来说，我们观察到良性网站的内容总体上比恶意网站多。虽然这对人类来说似乎是显而易见的，但最终拥有量化这一想法的功能还是不错的。最突出的是网页上的独特单词数和恶意网站中每句话的平均单词数。恶意网站也倾向于具有较低数量的HTML标签和较大的页面熵。良性站点通常有更多的脚本标记，而恶意站点的区别在于脚本标记比实际内容多。</p><p id="6988" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">此外，较高的脚本与正文比率也表明恶意脚本也比良性脚本更加详细或“健壮”。这些脚本观察的主要原因是良性网站上的大多数脚本倾向于外部链接(这仍然算作脚本标签，但不测量熵，因为原始HTML内容是空的)，而不是写入或注入的恶意或受损网站。然而，良性网站的平均脚本长度仍然比恶意网站略高，因此我们不能完全忽视恶意网站的大部分内容都在脚本标签中这一事实。最后，你可以在这里下载完整的“get _ content _ features . py”<a class="ae lo" href="https://raw.githubusercontent.com/eneyi/eneyi.github.io/master/assets/random/get_content_features.py" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="1e4d" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">基于主机的功能</h1><p id="a6f6" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">有时有必要超越对URL字符串的视觉检查来识别恶意链接传播背后的参与者或参与者组。检查基于主机的功能可以将网络钓鱼URL或下载驱动(例如)归因于网站或链接所有者。基于主机的功能从URL的主机名属性中获得。这组功能允许我们抓住“谁”、“哪里”、“何时”和“网站如何托管”的某些特征。包含这些参数背后的动机是网站部署策略、存在时间以及恶意和良性网站的声誉存在差异。一个典型的例子是恶意网站隐藏注册信息，网站更新的平均间隔天数，使用同一个主机IP创建大量恶意链接，或注册域名和托管网站之间的天数。众所周知，攻击者会利用僵尸网络在多个国家的多台机器上运行。</p><p id="dc11" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">为了提取有意义的基于主机的特性，我们需要用python编写三个库</p><ul class=""><li id="5dfd" class="lp lq iq kn b ko lj ks lk kw lr la ls le lt li lu lv lw lx bi translated">与域名注册信息<a class="ae lo" href="https://pypi.org/project/python-whois/" rel="noopener ugc nofollow" target="_blank"> (python的whois库)</a>进行交互。这将为我们提供与主机IP相关的域名信息。比如什么时候注册的，谁注册的，注册什么时候到期等等。<strong class="kn ir"> <em class="md">注意</em> </strong>这是一项免费服务，选择匿名的注册人的信息将保持不变。其他服务在注册服务商决定私有化之前提供关于注册服务商的可靠付费信息。“Domaintools.com”可能提供了关于主机的最可靠的whois信息。</li><li id="5510" class="lp lq iq kn b ko ly ks lz kw ma la mb le mc li lu lv lw lx bi translated">访问网络上主机的信息<a class="ae lo" href="https://shodan.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> (python的shodan的API) </a>。这将为我们提供有关主机的信息，即网站所在的机器(如果可用)。Shodan提供了一个开放的API来访问诸如开放端口、操作系统、web技术等信息。</li><li id="11c0" class="lp lq iq kn b ko ly ks lz kw ma la mb le mc li lu lv lw lx bi translated">访问关于网站变化的信息<a class="ae lo" href="https://pypi.org/project/waybackpy/" rel="noopener ugc nofollow" target="_blank"> (python的waybackpy库)</a>。Wayback Machine是万维网的数字档案。对于任何一个网站，Wayback机器都在线记录了其存在的所有版本。因此，我们可以使用它来获取有关网站更改的信息，更改频率，自其存在以来的更改总数，第一次更改，最后一次更改等。</li></ul><p id="d6c0" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">以下是提取的21个基于主机的特征。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nc"><img src="../Images/d805a2f5f587b5ce4039a3d23086857d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LVgaeM48ny2kr36FMIxlBg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">基于主机的功能表</p></figure><p id="4953" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir"> *注意:* </strong>这些是特定于域的结果，所以我们不需要为每个URL运行代码，而是为每个唯一的主机运行代码。不管URL字符串上的子域、查询和参数如何，结果都不会改变。“缓存”列表将存储已处理主机的列表，此代码的输出将是URL文件中每个唯一主机的记录。</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="cacc" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">众所周知，当使用相同的漏洞利用工具包设计不同的攻击时，多组恶意行为者共享相同的主机名或在其路径名中具有相似的重复模式。此外，当恶意代码被托管在受害者计算机上时，在受损的公共网络上，网站通常不会与任何域名相关联，而是由IP地址引用。域名注册的“生存时间”检查从域名注册(从whois数据)到相关网页第一次在网上出现(Wayback机器)之间的时间。有实验[ref]表明，生存时间较短的域将来很可能会迁移到其他IP地址或域。因此，由于恶意网址的生命周期比良性网址短，它们在整个生命周期中的网站更新次数也比良性网址少。<br/>在这里，我们还可以验证恶意和良性URL之间的TTL、网站更新频率和预期寿命是否存在差异。为了证实这种差异，我对每个特征进行了独立的学生T检验，比较了两组的平均值。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nd"><img src="../Images/2941f01e15b1469d9e700c13e97c2876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XwGkNzPVqFZ67n8SwIYOqA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">基于主机的特征的平均差异的显著性(恶意-良性)</p></figure><p id="e1fb" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">与前面的概念相同，在我们的示例中，恶意主机比良性主机有更长的寿命。虽然知名品牌的良性主机(如Alexa顶级网站)比大多数恶意主机的寿命更长，但恶意主机在野生环境中的平均存在时间更长，但在其生命周期内站点更新更少。此外，恶意行为者在购买域名后，还需要更长的时间来托管网站，以域名托管生存时间来衡量。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi ne"><img src="../Images/3b0d93b8b0fdbdf976c70c1e599bf5a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HhulVSdCUYZ6rhm3CAaWA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">TTL和连接速度(恶意与良性)</p></figure><p id="e621" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">如果我们忽略下图中的主要ISP提供商，如Amazon、Google和Cloudflare，我们可以看到有相当多的恶意主机ISP提供商没有出现在良性顶部。此外，请注意ISP提供商获得良性和恶意信息的频率差异。良性主机泄露注册信息的可能性是恶意主机的3倍。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nf"><img src="../Images/0b3a4b03adeea2e749c933746dd025ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rN9cNqBTRst5TQrHeb3v0Q.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">ISP(恶意与良性)</p></figure><p id="e358" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">当考虑与恶意URL相关联的顶级域时，恶意行为者的ISP看起来也可以链接到特定的国家行为者。最后，在这里下载完整的‘get _ host _ features . py’<a class="ae lo" href="https://raw.githubusercontent.com/eneyi/eneyi.github.io/master/assets/random/get_host_features.py" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9bfa" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">总之，恶意URL比良性URL更长，熵更低。恶意主机比良性主机注册的时间更长，但在其存在期间更新更少。良性URL也比良性URL有更长注册时间。本文展示了我们如何从URL字符串中提取有用的特征向量，还展示了恶意和良性主机和URL字符串之间的一些比较。在以后的文章中，我将介绍恶意、网络钓鱼和篡改URL属性，以从恶意主机中提取基于主机和基于内容的特征，并开发一种集成方法(Whois链接、状态属性和基本的无监督学习)来确定恶意URL在线分布背后的属性组。</p><p id="3283" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">参考</p><ul class=""><li id="6662" class="lp lq iq kn b ko lj ks lk kw lr la ls le lt li lu lv lw lx bi translated">《Prophiler:大规模检测恶意网页的快速过滤器》<em class="md">第20届万维网国际会议论文集</em>。2011.</li></ul></div></div>    
</body>
</html>