<html>
<head>
<title>6 Lesser-Known Pandas Aggregate Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">6只鲜为人知的熊猫集合功能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/6-lesser-known-pandas-aggregate-functions-c9831b366f21?source=collection_archive---------13-----------------------#2021-09-08">https://towardsdatascience.com/6-lesser-known-pandas-aggregate-functions-c9831b366f21?source=collection_archive---------13-----------------------#2021-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f4e4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">…这使得groupby函数更加有用。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/50e8401494838610fb5886ed6b4ec7b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qd7mWunLEcGMLwynVTiOjg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">巴赫尔·凯里在<a class="ae ky" href="https://unsplash.com/s/photos/six?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="db2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">groupby是用于数据分析的最常用的Pandas函数之一。它首先根据一列中的不同值将数据点(即数据框中的行)分组。然后，它计算每个组的聚合值。</p><p id="6600" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们有一个包含汽车品牌和价格的数据集。为了计算每个分支的平均价格，我们根据brand列对行进行分组，然后对price列应用mean函数。</p><p id="7072" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas提供了几个可以和groupby函数一起使用的集合函数，比如mean、min、max、sum等等。在本文中，我们将看到一些鲜为人知的聚合函数，它们使得groupby函数更加有用。</p><p id="acf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将涉及的功能有:</p><ul class=""><li id="b93d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第一</li><li id="2595" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">最后的</li><li id="75b2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">没什么</li><li id="4ee9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">努尼克岛</li><li id="8886" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">形容</li><li id="a3a4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">分位点</li></ul><p id="4e7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从创建一个样本数据框开始。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="9c51" class="mo mp it mk b gy mq mr l ms mt">import numpy as np<br/>import pandas as pd</span><span id="7651" class="mo mp it mk b gy mu mr l ms mt">df = pd.DataFrame({<br/>    "Brand": ["Ford","Honda","Toyota","Seat"] * 25,<br/>    "Price": np.random.randint(10000, 30000, size=100)<br/>})</span><span id="b40e" class="mo mp it mk b gy mu mr l ms mt">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/4959056e11f2e6790df9132722be0e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*N4ss8NUgb2xmX2_tXGBLUw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="4efa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一个包含100辆汽车的价格和品牌信息的数据框。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h2 id="6a4d" class="mo mp it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">1.第一</h2><p id="0804" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">第一个函数，顾名思义，返回每个组的第一个值。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="9e3a" class="mo mp it mk b gy mq mr l ms mt">df.groupby("Brand", as_index=False).first()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/a14d3b7bbd464aec929a81e9cda932a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*DiBeh2S17TK4GFiG9BuEcA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h2 id="06ac" class="mo mp it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">2.最后的</h2><p id="9773" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">last函数返回每个组的最后一个值。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="7661" class="mo mp it mk b gy mq mr l ms mt">df.groupby("Brand", as_index=False).last()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/6f0a1dec90b42078ae4936d839db3c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*bKLk2elkCWUztUAVJbMnEQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="5c61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个和最后一个函数对于这个数据集来说可能不是很有用。但是，有时您需要一个简单的解决方案来查找每个组的第一个或最后一个条目。当您处理基于日期或时间的数据时，顺序更加重要。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h2 id="4bff" class="mo mp it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">3.北</h2><p id="13bf" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">第n个函数扩展了第一个和最后一个函数的功能。它允许获取每个组的第n行。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="479b" class="mo mp it mk b gy mq mr l ms mt">df.groupby("Brand", as_index=False).nth(2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/096f47e7718325b0103749f7c3d40499.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*Y1OKgpsaNGuumMgmjD2Fzg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><ul class=""><li id="f93b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第n个(0)与第一个()相同</li><li id="1c53" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第n个(-1)与最后一个()相同</li></ul></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h2 id="40b0" class="mo mp it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">4.努尼克岛</h2><p id="de98" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">nunique函数返回每个组的不同值的数量。在我们的数据集中，每个品牌可能是25，因为我们在一个大范围内生成了25个随机整数。</p><p id="0a61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当处理现实生活中的数据集时，每个类别或组的唯一值可能是一种有价值的见解。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="fc1b" class="mo mp it mk b gy mq mr l ms mt">df.groupby("Brand", as_index=False).nunique()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/263e2310f4edbc62e14ff129044f32fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*IphgLrXPe-nWjGqaWEdawQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h2 id="0366" class="mo mp it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">5.形容</h2><p id="c4ed" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">describe函数为每个组返回几个统计数据。它通常用于获取整个数据框的概览。我们还可以将它与groupby函数一起使用，从几个不同的角度比较各组。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="0da8" class="mo mp it mk b gy mq mr l ms mt">df.groupby("Brand", as_index=False).describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/0dd9f4b08e49c61fa02e4852cf260abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ffyM7fnNLPgWQoADDkIgTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="cecb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">25%、50%和75%的值分别是第一、第二和第三四分位数。与其他统计数据一起，它们提供了值分布的结构化概览。</p><p id="8fc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个分位数(25%)意味着25%的值低于该值。同样，50%的值低于第二个分位数，因此第二个分位数是中值。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h2 id="d5c8" class="mo mp it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">6.分位点</h2><p id="ed3a" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">我们用describe函数得到25%、50%和75%的分位数。分位数函数提供了更多的灵活性，因为它接受一个参数。</p><p id="ac55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了找到40%的分位数，我们将0.4作为参数传递给分位数函数。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="b6d3" class="mo mp it mk b gy mq mr l ms mt">df.groupby("Brand", as_index=False).quantile(0.4)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ebef71503feca1ef9ebd18bd53fd4357.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*GDAjMzcf6GV7i8hqC3kCbw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h2 id="af0f" class="mo mp it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">结论</h2><p id="11cd" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">groupby函数是探索性数据分析中的救命稻草。mean、sum、min和max是groupby常用的聚合函数。</p><p id="722f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在本文中讨论的函数并不常用，但在某些情况下它们会派上用场。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="51d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后但同样重要的是，如果你还不是<a class="ae ky" href="https://sonery.medium.com/membership" rel="noopener">中级会员</a>并打算成为其中一员，我恳请你使用以下链接。我将从你的会员费中收取一部分，不增加你的额外费用。</p><div class="oe of gp gr og oh"><a href="https://sonery.medium.com/membership" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">通过我的推荐链接加入Medium—Soner yld RM</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">sonery.medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="1025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>