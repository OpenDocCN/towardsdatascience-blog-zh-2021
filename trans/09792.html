<html>
<head>
<title>Scan Environment Variables in Production Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">扫描生产应用程序中的环境变量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/scan-environment-variables-in-production-application-4482a4830da1?source=collection_archive---------31-----------------------#2021-09-13">https://towardsdatascience.com/scan-environment-variables-in-production-application-4482a4830da1?source=collection_archive---------31-----------------------#2021-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/45a0f77e60dbcbb1ca3744d4d169c5d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ZLkJcvdcOrOSpzwEmf8SA.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@miracleday?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">埃琳娜·莫日维洛</a>在<a class="ae kc" href="https://unsplash.com/s/photos/keys?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="76dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没有环境变量，就没有完整的生产应用程序。大多数项目将环境变量作为事实保存在<code class="fe lb lc ld le b">.env</code>中。随着应用程序中环境变量的增加，很难在生产中准确无误地跟踪它们。</p><p id="3145" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在部署应用程序时，在生产环境中定义或更新env变量并不是一种理想的方式。</p><p id="8e7a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我创建了一个简单的<strong class="kf ir"> npm包</strong> <code class="fe lb lc ld le b">scan-env</code>。这个简单的包扫描应用程序环境变量，并打印缺少环境变量的报告。</p><p id="da8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自己去试试<a class="ae kc" href="https://www.npmjs.com/package/scan-env" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="dc3f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在下一节中，我将创建一个虚拟项目来使用它。</p><h1 id="a9ef" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">入门指南</h1><p id="b228" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">创建一个<code class="fe lb lc ld le b">scanenv-demo</code>项目。</p><p id="4a87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe lb lc ld le b">npm init -y</code>初始化项目。</p><h2 id="89df" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated">安装扫描环境</h2><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="59f5" class="mi lg iq le b gy nc nd l ne nf">npm install scan-env</span></pre><h2 id="bbb2" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated">项目结构</h2><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="a51c" class="mi lg iq le b gy nc nd l ne nf">scanenv-demo<br/>|- index.js<br/>|- .env<br/>|- .env.example</span></pre><p id="7f28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在项目中创建3个文件<code class="fe lb lc ld le b">index.js</code>、<code class="fe lb lc ld le b">.env</code>和<code class="fe lb lc ld le b">.env.example</code>。</p><h2 id="d800" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated"><strong class="ak"> index.js </strong></h2><p id="5aa8" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">将下面的代码复制并粘贴到<code class="fe lb lc ld le b">index.js</code>中。</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="1462" class="mi lg iq le b gy nc nd l ne nf">const scan = require("scan-env");</span><span id="0bca" class="mi lg iq le b gy ng nd l ne nf">// scan env<br/>const status = scan();</span><span id="2c7a" class="mi lg iq le b gy ng nd l ne nf">if (!status) {<br/>  console.error("Missing Envs.");<br/>  process.exit(1);<br/>}</span><span id="b826" class="mi lg iq le b gy ng nd l ne nf">console.log(<br/>  `${process.env.GREETING} ${process.env.REGION} from ${process.env.FROM}.`<br/>);</span></pre><h2 id="daea" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated"><strong class="ak">。环境</strong></h2><p id="0f2f" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">从这个文件中，应用程序将使用环境变量。</p><p id="4de5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将以下按键复制并粘贴到<code class="fe lb lc ld le b">.env</code>中。</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="c78a" class="mi lg iq le b gy nc nd l ne nf">GREETING=Namaste<br/>REGION=World</span></pre><h2 id="56f2" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated"><strong class="ak">env . example</strong></h2><p id="f733" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">列出应用程序所需的所有环境变量。</p><p id="4627" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">复制并粘贴<code class="fe lb lc ld le b">.env.example</code>中的以下按键。</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="e686" class="mi lg iq le b gy nc nd l ne nf">GREETING=Anything<br/>REGION=Anything<br/>FROM=Anything</span></pre><blockquote class="nh ni nj"><p id="b0f9" class="kd ke nk kf b kg kh ki kj kk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz la ij bi translated">注意:<code class="fe lb lc ld le b">.env.example</code>的语法必须和<code class="fe lb lc ld le b">.env</code>一样。</p></blockquote><h2 id="4a45" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated">运行应用程序</h2><p id="f4f0" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">FROM</code>键在<code class="fe lb lc ld le b">.env</code>中丢失。我们在等一份丢失的报告。</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="e540" class="mi lg iq le b gy nc nd l ne nf">node index.js</span></pre><p id="d982" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">输出</strong></p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="9421" class="mi lg iq le b gy nc nd l ne nf">Env Scan Report<br/>--------------------------------------------------------------------<br/>Total Missing Environment Variables:<br/>1</span><span id="7122" class="mi lg iq le b gy ng nd l ne nf">Missing Environment Variables:<br/>FROM<br/>--------------------------------------------------------------------</span></pre><p id="a002" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">.env</code>中增加<code class="fe lb lc ld le b">FROM</code>键</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="fcfc" class="mi lg iq le b gy nc nd l ne nf">GREETING=Namaste<br/>REGION=World<br/>FROM=India</span></pre><p id="422b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe lb lc ld le b">node index.js</code>运行应用程序。</p><p id="bbe6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">输出</strong></p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="e16e" class="mi lg iq le b gy nc nd l ne nf">Namaste World from India.</span></pre><h2 id="0426" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated"><strong class="ak">忽略环境变量</strong></h2><p id="7dd3" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">当您在不同的环境中运行应用程序时，您可能希望忽略一些环境变量。</p><p id="61f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此使用<code class="fe lb lc ld le b">.envignore</code>文件。</p><p id="8c7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个<code class="fe lb lc ld le b">.envignore</code>文件并粘贴下面的密钥。</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="99b6" class="mi lg iq le b gy nc nd l ne nf">REGION=Anything</span></pre><p id="ca60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，<code class="fe lb lc ld le b">scanenv</code>检查<code class="fe lb lc ld le b">.envignore</code>是否存在。如果它存在，那么它会忽略这些键。</p><p id="bf90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行应用程序<code class="fe lb lc ld le b">node index.js</code>。</p><p id="3c3f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">输出</strong></p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="8f7b" class="mi lg iq le b gy nc nd l ne nf">Namaste undefined from India.</span></pre><h2 id="77c4" class="mi lg iq bd lh mj mk dn ll ml mm dp lp ko mn mo lt ks mp mq lx kw mr ms mb mt bi translated">结论</h2><p id="cab3" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">如果文件名不是<code class="fe lb lc ld le b">.env</code>、<code class="fe lb lc ld le b">.env.example</code>和<code class="fe lb lc ld le b">.envignore</code>，则以相同的顺序将文件名传递给函数。</p><p id="ebcd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>