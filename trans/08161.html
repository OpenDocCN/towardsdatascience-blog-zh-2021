<html>
<head>
<title>Backpropagation in Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络中的反向传播</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/backpropagation-in-neural-networks-6561e1268da8?source=collection_archive---------5-----------------------#2021-07-27">https://towardsdatascience.com/backpropagation-in-neural-networks-6561e1268da8?source=collection_archive---------5-----------------------#2021-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc84" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从零开始的神经网络，包括数学和python代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d1639bf01333af791e65168650707174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y4aag7gH0QbE2obB"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jjying?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> JJ英</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="189a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="8201" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你曾经使用过神经网络，并想知道它背后的数学是如何工作的吗？在这篇博文中，我们将从头开始推导前向和后向传播，从中编写一个神经网络python代码，并学习线性代数和多元微积分的一些概念。</p><p id="92eb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我将从解释一些线性代数基础开始。如果你对这个足够精通，你可以跳过下一部分。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="42f8" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">向量和矩阵</h1><p id="843f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">简单的数字(标量)用小写字母书写。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/2b9b92fe0924d83b2a03597b1177a90a.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/format:webp/1*JTyDPoFJbZ8M0UegyE101A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6cfe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">向量用粗体字母表示，默认情况下它们是列向量。</p><p id="9c33" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">行向量的名称也用粗体表示，但是用大写字母T表示转置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/59af15dabc81ee470ce769111a4d384b.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*B3iLECuw8iCsxxGZaSA4jQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">autor提供的图像</p></figure><p id="f66a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">矩阵用粗体大写字母表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/7ae997e8cd203b50fa786582ee24cdf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*xmhMAxcTowADMJ2ddaq1Ag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">autor提供的图像</p></figure><p id="aeb4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当转置一个矩阵时，我们交换行和列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/9edcf6fd75bff1cbd891c241e1b8d5d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*XCMjRya4rVGw0yygwfmnag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="026c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">矩阵或向量的维数是:</p><p id="83be" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">(行数、列数)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/2f9d81045d2ae3decabc641e4ce17b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*KDfZ7DUXTC4r9Htjp6m3iw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/c808d5e0e1a999a06dad643e23af0306.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*aortxRjuwPOPqEgdVHe1sw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ddfbb1814687323e51e7af89633e0db7.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*aLfMZr4YGg1b18Rt5P2bsw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="dda0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">点积⋅</h1><p id="6c02" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当两个向量或矩阵乘以点积时，左边向量或矩阵的列数必须与右边向量或矩阵的行数相匹配。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/c0aed267f39ca0431132633f82bd85c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtELFbAf4CStRjEB-jQ9Pg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="c343" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">结果的维数可以计算如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/021a344be3c3dac15ffbba8783e6918f.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*0VcbMGF7sB6yXNIC38gQvA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e5a9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该乘法中的“内部”维度必须匹配，并在输出维度中消失。</p><h1 id="7785" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">元素态乘积(Hadamard乘积)</h1><p id="0a67" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当使用元素乘积将两个向量或矩阵相乘时，它们必须具有相同的维数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/bc612d3ad9a8276e9c1f1c58431389a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*RXIyeTaXiM3CqkhE10RhCQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="0f0b" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">矩阵计算</h1><p id="662d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们还需要向量和矩阵的微积分。我们使用雅可比矩阵的概念。雅可比就是一个向量或导数矩阵。</p><p id="1a8e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">标量值函数相对于矢量<strong class="lt iu"> 𝑥 </strong>的导数定义如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/08342f1263342399176cc8cd5e538494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rro94a42uM4wsFBSWOseg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c1ed" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们用输出向量<strong class="lt iu"> 𝑓 </strong>定义一个函数对单个变量x的导数，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/f26b09043a1e43cabb1768311bac9554.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*-HmcPfftuPBmGvTS7TId4g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8445" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">具有输出向量和输入变量向量的函数的导数定义如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/56dc6aeea4c3f6d83949165270f9c4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WAgZSbd95r2LvSWacdxng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="8b4e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">向量链规则</h1><p id="ff4e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">矢量链规则看起来非常类似于标量链规则。在这个例子中，向量<strong class="lt iu"> 𝑓 </strong>是向量<strong class="lt iu"> 𝑔 </strong>的函数，向量<strong class="lt iu"> 𝑔 </strong>本身是向量<strong class="lt iu"> 𝑥 </strong>的函数。所以<strong class="lt iu">𝑓</strong>(<strong class="lt iu">𝑔</strong>(<strong class="lt iu">𝑥</strong>))相对于<strong class="lt iu"> 𝑥 </strong>的导数计算如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/b1ef08441ab030189c97225d2fc0594e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFCvUG00Pq8i6ilO8g020w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="18bb" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">单输入向量神经元</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/4ed57e2b143c65e4695e94e9d437bc45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqpDszybT3E-8FiQh7-Q8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="078c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> 𝑥 </strong>:是进入神经元的输入样本。在上图中，它有3个特征。例如，这可以是一个人的身高(1.75米)、体重(80公斤)和年龄(30岁)。注意，我们一次只输入一个样本(在我们的例子中是一个人)到神经元中。</p><p id="6e57" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">𝑎:被称为激活，它是神经元的输出。它是神经元根据一个输入样本做出的预测。我们可以选择我们的神经元应该预测什么。在我们人类的例子中，一个有用的预测可能是身体质量指数。</p><p id="bbc4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> 𝑤 </strong>:神经元的权重。它对向量<strong class="lt iu"> 𝑥 </strong>的每个输入特征有单独的权重。</p><p id="30d5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">𝑏: <strong class="lt iu">神经元的</strong>偏差。一个神经元只有一种偏向。</p><p id="f95e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">𝑦:是网络输出的真实值或目标值。我们希望𝑎尽可能靠近𝑦。因此，我们在训练阶段改变权重<strong class="lt iu"> 𝑤 </strong>和偏差𝑏。</p><p id="f915" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">𝐿:被称为损失。𝑎离𝑦越近，损失越小，因此越好。因此，我们想尽量减少损失。最小化神经网络中损失的最常见方法是梯度下降。在这篇博文中，我将使用“均方误差”损失。</p><h2 id="0a93" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">梯度下降</h2><p id="6e58" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在训练期间<strong class="lt iu"> w </strong>以下列方式更新。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e24b0e67411ca722de0c441552595fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*SPa3nRLIV85jV0OIdTbkug.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fd8c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中<strong class="lt iu"> w </strong>是新更新的权重向量，𝜆是学习率。𝜆是一个超参数，可以自由选择。通常在0.05左右。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c2f9ce5e347c522da9408f0b86941c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*a01NF4f7iYn891edzUU7DQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0893" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">∇𝐿( <strong class="lt iu"> w </strong>是损失相对于权重的梯度。它只是损失𝐿的导数相对于权重的转置。一般来说，函数对某些变量的梯度总是相应导数的转置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/ae402c743a18a3e454f801d9b95d97e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*m9QD2pXXQ5kmSnBb6_DXoQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1706" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">𝑏是新的更新的偏见。∇𝐿(𝑏)是损耗相对于权重的梯度。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ac8c48571ab1a9d1c34445fbeca1a8dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*VlQiwwG0wkig_hLQ7pU7Cw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bcf6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这种情况下，梯度是导数的转置并不重要，因为它是一个单一的数，转置一个单一的数不会改变它。</p><h2 id="02fd" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">计算渐变</h2><p id="5900" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">应用向量链规则:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/761235bb72e7fd388302625483844df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*O4A5gFgOrQ6x_V0q1iwuBw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/81478a6ce0949c136ae028295352d311.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*mspJc1gWoPl-hwkY3xUEEQ.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/9142c0be30232ab3db440f68f3df0a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*YmFCmqG2frg-cvf_aXfVvw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c635" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">重量的导数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/228d72aaf14a2381f4f0999ed4227053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ogOq7xyOpXFz6pJtn_xEXw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/776c54c77986cfbc2b5bfc2440cce0b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*0oRH_s22RYV4iNPOlFa4LA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c721" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> 𝑥 </strong>不依赖于<strong class="lt iu"> w </strong>，因此它被视为常数，导数必须仅针对<strong class="lt iu">w</strong></p><p id="79e2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">关于偏差的导数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/70b12d2238be40d7f52096c7f12c30a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*NeD23fqEuZSaoVTBgupo7w.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/12c165df44f4214475c2b5ecdd848880.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*QyQc6znlwrYVV8TKAvKg7g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="c542" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated"><strong class="ak">梯度下降</strong></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/3871b9d81f740d4d2be0305edea92430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*90vlidLznSflVUOqlEDapQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/dc35e4d25cf747b19247013d5a69ea39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*myt152f1Qi6A9GQ-Z1gHYw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="cb6e" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated"><strong class="ak">代码</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><p id="6135" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">测试我们神经元的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><p id="0012" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，我们用虚拟数据集测试我们的数据，看看它是否有效。每个样本有3个特征。如果第一个特征是1，则期望的输出是1。其他两个特征对结果并不重要。因此，我们希望第一个权重变为1，而其他权重和偏差将变为0。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/02e89d65f070e26f7efd738c3a52cfe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wcJsvhXxiacJ1CWMgsOJw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示训练过程中权重、偏差和损失变化的图表(图片由作者提供)</p></figure><p id="2070" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们对训练过的网络在训练中从未见过的样本进行测试，以了解它对未见过的数据的推广情况。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="64b9" class="nt la it ow b gy pa pb l pc pd">Test: <br/>predicted y: 0.9992918862001037, true y: 1</span></pre><p id="0c15" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">测试样本的输出显示，我们非常接近真实值。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="2685" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">能够同时对多个样本进行训练</h1><h2 id="03ab" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">前进传球</h2><p id="20a4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">每个数据点的大小为3:</p><p id="d825" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们有数据点𝑥1，𝑥2，…</p><p id="feff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">圆点表示我们可以输入神经元的数据点(𝑚)的数量是可变的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/f606ef186f6d0e77c957a858ca937f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*5WVz2wQAKuFMkoac4qfImA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="157e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了获得输入矩阵，我们垂直堆叠输入向量:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/d9885db2fd7547dcc6e730ea978cea95.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*xQLLkMaNbxKwokvSW_4-WQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="eacb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们必须按如下方式调整损失:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/15fdc8e7113b6f99501fbddc5e96ff0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*ACGFRu7w-Mknsi8SIy_wsA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="66f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中𝑚是我们使用的数据点数。</p><p id="f9c2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> 𝑎，</strong>激活向量然后以如下方式计算:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/1542eee7de89c6266bd6f661ce96779f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*OUUMC2dYkSzlXjY-JrdYRQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/57dfffa82c2731e7a4cc4ec45e82ae98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FBC7_ktXJVbcSxpMrNmvKA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="358d" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">偶数道次</h2><p id="23d3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">应用向量链规则:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/859c920a3bd7cb2d90b61627944689aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/format:webp/1*mfD4c0FIFaYqhYJuwQ71lA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/5a1663a0b0b7d7d71598d06d52b57597.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/format:webp/1*qW7wLyHLFKPgdatA22A1aQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2a6a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">计算导数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/0edafab420c5e5621f6bc1545c42b9d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CCRlWeMemcLaXrop8n0w_g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="74a3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">关于重量:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/bea08a98110129aabf99e99591db9d8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*zq4CS7U5fJWNHJzaM8zQXA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/3b77cf070f377fe35cbfb08dcd6e5824.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*xFh_Jw0DhnQ9cl3yR1FrOg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="67f5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">关于偏差:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/3ff4152cc6d482f8d7fec520e81c2eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*BawCeqJGiZrmIMWKehnrDg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/cfdbca46a05f36de160c86c2608fbc70.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*dunkum_JqaTBqofQwt3J5A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="3ebe" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">梯度下降</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/1019fec49aa348f584d8aa143f48b432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*oia1Eq-ACiipASUjSr-Bmw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/9df2fb32e1fe841fc0d86be98358d974.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*zO5oOKBhW2g-OCyHwCZJSg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="e97b" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">密码</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><h2 id="d409" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">随机梯度下降</h2><p id="9d8b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">随机梯度下降意味着，我们同时对所有训练样本进行训练。</p><p id="1f99" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以看到权重、偏差和损失的相同演变，就像在具有单一输入的神经元中一样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/0b0eadaac410d1c16be3a64498bdd009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYKVLW36x1we6lohLs036g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b220" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以在下面看到，预测的输出非常接近真实的y:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="9dc3" class="nt la it ow b gy pa pb l pc pd">Test: <br/>predicted y: 0.9999991060923578, true y: 1</span></pre><h2 id="a342" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">小批量梯度下降</h2><p id="3002" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">小批量梯度下降意味着，我们同时在训练集的子集上训练神经元。</p><p id="0694" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们必须编写一个函数来生成随机批次。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/879d280b9cb3d934994051bbd60c2c9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1VZAoz9Q-W_mWtKJQH2nDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="25c8" class="nt la it ow b gy pa pb l pc pd">predicted y: 0.9956078874633946, true y: 1</span></pre></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="89b5" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">添加激活功能</h1><p id="0d88" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">激活函数是非线性函数。</p><p id="e31e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">3个非常重要的激活函数及其导数:</p><p id="bcd4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">tanh:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/6584c5a2c1bff3375969e5c69fa9dd3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/1*fjcVxM1iX4hdvZ31X6ILkg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/abb401525e9ff7af3c225885cf177aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*0BzgJhGLwDQ4kNMEgxjgaw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b14f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">西蒙德:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/bea306f7a297e2bad0ce93070015820a.png" data-original-src="https://miro.medium.com/v2/resize:fit:258/format:webp/1*pGm6WZTa5DeauaJPxm7P6Q.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi px"><img src="../Images/bb5654ca25a272a55b2d8397ac2a63ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*cpvWv7pb7aEuWBmZXGxk2A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="52a7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">整流线性单位:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/6a2555783ca805cdae3489d99e95b5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*9p8y9Vv7jTdHKsFJqaEr9g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="2ad8" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">前进传球</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi py"><img src="../Images/b3caabbac6006032871a6ed0bf359896.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*Ec4vzQBN4BpSaDnpkOYC2Q.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/f9bd5c928e4834904261fc5d56cd16ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:202/format:webp/1*epbaxmTAK-M79MnJLg0SMg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qa"><img src="../Images/cf96ec5c324ea06d948cec8d5a442028.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*VgK4i0ARGA7cCUWEOV6lKw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/a698f7e4e848b6d5ade137e4401a8245.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/1*mUeP0VmGMqAisgXB74kuXA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/65f73c10a48e0f7ca6185307efd7ec04.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/1*S4NwYNKJCZTJJrgN8lJP-Q.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/5469abb413b9829d12a11baa38bd4f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kHZFnt_vBE9JJ89onaiBPQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者提供的图片</p></figure><h2 id="4f50" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">向后传球</h2><p id="715b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">应用向量链规则:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/09a972ebbb6a3695025ab43751bc1c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/1*zxq9BTlgqThFuDwiJl0HJg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/bb5f85cb75c105363ce3bafc1cdf25bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/format:webp/1*AIfHudoRRhejoCXnptyr8w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="26ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">计算导数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/d817ed5500282eb245af731665780ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/1*B4443LKszZtDYFBkbEZJ0A.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/b6e3aedd293d22781cdd9593f6a40538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9UuR3srcLIt2I4a2vBH7CQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="84b5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">np.diag函数从一个向量构造一个矩阵，其中矩阵的对角线等于该向量，并且它是非对角线的。</p><p id="e3e4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">关于重量:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/e34f83b468bbd93d65d236307f2c3213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*VhrMbR8wZmo3Km0myy5mqg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/1f7273c3750913297755a3db7e9c898b.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*qYWuQd3keAbQUrAWTNgJuQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="50ff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">关于偏差:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/0cbde222fcb2376df66821a210a46a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*RvkAVtgfuei91TxJ5k6-wg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qi"><img src="../Images/34c887f4074d657f7d2dd83a1a88c5e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HG_MeTYVt-z0DrYhi_GGGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="c9e7" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">密码</h2><p id="8b58" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">激活功能:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><p id="49ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">神经元:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><p id="016a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">迷你批次梯度下降</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qj"><img src="../Images/105b73c2cab80d7dab8ea454d3daa2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddWIAGeNJkr4-fr9ZzYSFA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6642" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">值、权重和偏差收敛到不同于先前的情况。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="d051" class="nt la it ow b gy pa pb l pc pd">prediceted y: 0.9394357707018176, true y: 1</span></pre></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="b61f" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated"><strong class="ak">深度神经网络</strong></h1><p id="65cc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">向前传球</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qk"><img src="../Images/6ddcbeb0ff19a677c5d00a4054ac1519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVvdGCNcBFMAjMCp4BdKjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d91e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">括号中的上标表示该层。</p><p id="bdcc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第1层(=输入层):</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qm"><img src="../Images/400e187c363b7a294065f9e7eb31564c.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*kcSGqX6GicIpjF29LnpeUQ.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qn"><img src="../Images/1c0dea57436f772abba9fd28ecaf17dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*78SOjh3hA8VJbGUttmVkUA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d9f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第二层(=输出层):</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/9b23364ca7a09c603227ac71967e41f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*PLGdtE3LAPbiUZNzxQ9Czg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/6d5aa9dfaee130ef51d51ceb8f0e240a.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/format:webp/1*RZ9gnJIQAbA5BNxb318l4A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0b33" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">损失:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qm"><img src="../Images/906aacfb894c874d5d1b4743d4d22940.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*lnDnSf636GeX7FAdGXvilA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="32a0" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated"><strong class="ak">向后传球</strong></h2><p id="f9dd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第一层(=输入层):</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qq"><img src="../Images/2c35341370d1621fdb2cabd18bb7ab9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*zPtP-tW6cVNTef8LgGS4hw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/c4c87fd8ce2857e4be2fea63fdbdf6ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*xM9uTtU7fusm78X8ffLU4w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="217c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第二层(=输出层):</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qr"><img src="../Images/be5576c055314de2e4c7acbc040d3cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*cloqACTf02VgFsnvfE1PiA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qs"><img src="../Images/b37cc133d6daafca6e2f29807c692994.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*Zb2wvzQkDBhmX07eqj8Nhw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e190" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">计算第2层的导数是一个问题，因为我们必须对矩阵求向量的偏导数，对矩阵求矩阵的偏导数。这将导致张量，这将使它变得不必要的复杂。</p><p id="6bbe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们不使用向量链规则，而是直接计算损失对权重和偏差的最终导数。为此，我们:</p><ol class=""><li id="5ece" class="qt qu it lt b lu mn lx mo ma qv me qw mi qx mm qy qz ra rb bi translated">用索引符号重写向前传递。在这个符号中，我们可以看到损失的最终导数的每个元素相对于权重和偏差的样子。</li><li id="c710" class="qt qu it lt b lu rc lx rd ma re me rf mi rg mm qy qz ra rb bi translated">计算导数。</li><li id="bb11" class="qt qu it lt b lu rc lx rd ma re me rf mi rg mm qy qz ra rb bi translated">为了编写高效的代码，请返回到矢量化形式。</li></ol><p id="56a8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第一层(=输入层):</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rh"><img src="../Images/775eca9842a053c66eb2f8f2577a9833.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*prMTrGrfuwzz9zKLcWC2sg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ri"><img src="../Images/c212e1ea7f81441dccb98cb582a644f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:266/format:webp/1*3NN_mh-ZM4zAk-eq0ZwXmw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d124" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第二层(=输出层):</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9fd77fbbbdef08c890145745357faae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*7meUzjF4XYsOWt3Y0avJWA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ri"><img src="../Images/793459de837f55556ae71eb490653a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:266/format:webp/1*0DvIhaYTs6F0466GqFuhHA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="faba" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">损失:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qm"><img src="../Images/906aacfb894c874d5d1b4743d4d22940.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*lnDnSf636GeX7FAdGXvilA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="f904" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated"><strong class="ak">向后传球</strong></h2><p id="d52e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第二层(=输出层):</em> </strong></p><p id="6e07" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了推导索引符号中的公式，我们可以查看计算图。例如，为了推导第2层权重的公式，我们构建了一个计算图，其中所有相互依赖的变量都是相连的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rj"><img src="../Images/d9cc190a91af02a25199a95d2eed76c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*UKNitrTCxJ53r8pU519dmQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bb7b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们用索引符号重写了相同的计算图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rk"><img src="../Images/1cd90ae9ff1bca96b86a95b3ecf17050.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*JxvxKzajYzZeJX0vXyVKQA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="05ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们现在想知道损失对每个重量的导数。对于每个权重，我们必须对该权重出现的所有分支求和。作为层2的重量1的例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rl"><img src="../Images/59aef4fa0f732e395b6a478892188fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*iK_vySet34iKZeMOH5uldA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3df0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">损失相对于所有重量的导数为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rl"><img src="../Images/d0badf9924b05048f9aa879d59293c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*tHKXPvOVvVD59-OMEsEUqw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4d6b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化形式写回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rm"><img src="../Images/c9577e2b7f7d7f01b28429f7a2234dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*zbB7o2B9n70YlKVhz4weBg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="87c9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，通过观察等式的左侧，我们可以看到我们的矢量化形式最终必须具有的维数。这有助于我们以正确的方式构造点积，并给我们必须转置的信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rn"><img src="../Images/edae0216b7f666c339cfeec72acb1f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*E0HtYCEPV9O7J27wqgP_Yg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="eb3a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化形式写回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ro"><img src="../Images/d61acbc916afb239fc0c587eae249db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*kn5BPSd_M8rZpYK8qJ1hKw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b814" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">第一层(=输入层):</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rp"><img src="../Images/8fce9fe2bb56e257e6ea6f7c5113e287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJGiAq29TGZdb00_QDBwBw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5a9f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化形式写回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rq"><img src="../Images/558283de54ef02399d174de4aeff0888.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*jGDxrkbKpo00MQZ6F0fDyQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="453f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">重新划分偏差:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rr"><img src="../Images/997199e55ecc246e3ff2dd2f1fbb5ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O496R5DUzvhPfMeaRbY7SA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e971" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化形式写回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/058b1c3e3efccbe3ddc4b1599430fab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*dHbGoASGF_qZ44NaT6HC-g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8ff9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了使求和更清楚:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rs"><img src="../Images/de963d66eb5dcd626814f9cd09c5b4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*GC0ft1Jg69AsO5pZf9jeRA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f292" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">“轴= 1”意味着我们对各列求和。</p><h1 id="1148" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">通式</h1><p id="7d1b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了推广我们上面导出的公式，我们将输入损耗的概念引入到层中的神经元中。输入错误<strong class="lt iu"> 𝛿 </strong> (𝐿)进入最后一层𝐿是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rt"><img src="../Images/37dd6879b1063712faebf7ea03c1a05b.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*HMjHUO6MbdrfUSrx7g18gA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0891" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化的形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ru"><img src="../Images/a77dd3fc8e13d1788fd2580b0d69639a.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*Sp9_oUfUMuxkQchocYWDVw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f573" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于我们网络的所有其他层l:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rv"><img src="../Images/b32cc496b3324dbd4abaa2a6ba90f75f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jfjWb1JwQUq-F6753SYdLw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="582c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化的形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rw"><img src="../Images/91ab444c7320a2c3558aaa3036d8d126.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*IeJ8Xwrq53OJ0cBpqNyWsw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e065" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">𝑓表示非线性激活函数。这可以是例如乙状结肠或relu。𝑓′表示𝑓.的导数</p><p id="8a7e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">关于重量的导数:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rx"><img src="../Images/303d66e68454a203a51c02c14caaa09d.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*jr2FH8DXe7jKacQg7jUeoQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3314" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化的形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ry"><img src="../Images/05b3bf78933beb81fad8d2d3fa3bb491.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*Ep6h-2yu1Ay2nf_-NAhLFw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9cf5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ql">关于偏差的导数:</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rz"><img src="../Images/b6a212f7bf542e5a205cc5b93ff9b282.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*zET4Ib1skMv1Ukj_8AQXmA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f82c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以矢量化的形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi sa"><img src="../Images/72c06a64625124f6cdc762b8b1d11560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*wUFrLrGIEnFpwrxgDYA0tw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi sb"><img src="../Images/8c82f0d0532946ff4bac72ef1d64b019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSTgd2zg8wrJ_l_-1vo8hg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="ca12" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">最终代码</strong></h1><p id="3653" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">此代码可用于创建和训练任意深度神经网络。传递给__init__方法的列表“层”可以更改，这将更改网络。列表的长度等于层数。这些数字等于每层中神经元的数量。第一个必须等于特征的数量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><p id="0457" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">测试我们的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者代码</p></figure><p id="061d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们再次查看输出层的权重和偏差的演变以及训练期间损失的演变。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi sc"><img src="../Images/9ab47c991dc20351851d9c28e179eacf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AC4vklAaHoYCJA8ACts6Ug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="64d4" class="nt la it ow b gy pa pb l pc pd">predited y: 0.9514167066315814, true y: 1</span></pre><h1 id="0fc2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">结论</strong></h1><p id="dfe4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你还和我在一起，我祝贺你，虽然这是一个旅程。如果第一次没有成功，也不要绝望。我花了一个多月才想明白这一切。</p><p id="a6f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">今天你已经学会了如何在任意深度神经网络中导出权重梯度。你现在也应该能够将这些知识应用到其他问题上，比如线性回归、递归神经网络和强化学习等等。</p><p id="7055" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是要知道，现在有非常好的自动签名框架，它能够为你数值计算梯度。尽管如此，我仍然认为，手工推导这些公式有助于我们对神经网络如何运行以及出现的一些问题(如香草RNN中的消失和爆炸梯度)的总体理解。</p><h2 id="1005" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">相关著作</h2><div class="sd se gp gr sf sg"><a rel="noopener follow" target="_blank" href="/snake-with-policy-gradients-deep-reinforcement-learning-5e6e921db054"><div class="sh ab fo"><div class="si ab sj cl cj sk"><h2 class="bd iu gy z fp sl fr fs sm fu fw is bi translated">具有策略梯度的Snake深度强化学习</h2><div class="sn l"><h3 class="bd b gy z fp sl fr fs sm fu fw dk translated">策略梯度深度强化学习在蛇游戏中的应用</h3></div><div class="so l"><p class="bd b dl z fp sl fr fs sm fu fw dk translated">towardsdatascience.com</p></div></div><div class="sp l"><div class="sq l sr ss st sp su ks sg"/></div></div></a></div><div class="sd se gp gr sf sg"><a href="https://medium.com/@Vincent.Mueller/einstein-index-notation-d62d48795378" rel="noopener follow" target="_blank"><div class="sh ab fo"><div class="si ab sj cl cj sk"><h2 class="bd iu gy z fp sl fr fs sm fu fw is bi translated">爱因斯坦指数符号</h2><div class="sn l"><h3 class="bd b gy z fp sl fr fs sm fu fw dk translated">爱因斯坦求和、指数符号和数值</h3></div><div class="so l"><p class="bd b dl z fp sl fr fs sm fu fw dk translated">medium.com</p></div></div><div class="sp l"><div class="sv l sr ss st sp su ks sg"/></div></div></a></div><h2 id="7136" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">想联系支持我？</h2><p id="b9f4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">LinkedIn<br/><a class="ae ky" href="https://www.linkedin.com/in/vincent-m%C3%BCller-6b3542214/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/vincent-m%C3%BCller-6b3542214/</a><br/>脸书<br/><a class="ae ky" href="https://www.facebook.com/profile.php?id=100072095823739" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/profile.php?id=100072095823739</a><br/>Twitter<br/><a class="ae ky" href="https://twitter.com/Vincent02770108" rel="noopener ugc nofollow" target="_blank">https://twitter.com/Vincent02770108</a><br/>Medium<br/><a class="ae ky" href="https://medium.com/@Vincent.Mueller" rel="noopener">https://medium.com/@Vincent.Mueller</a><br/>成为Medium会员并支持我(你的部分会费直接归我)<br/><a class="ae ky" href="https://medium.com/@Vincent.Mueller/membership" rel="noopener">https://medium.com/@Vincent.Mueller/membership</a></p></div></div>    
</body>
</html>