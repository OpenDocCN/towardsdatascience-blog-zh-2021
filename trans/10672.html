<html>
<head>
<title>Cosine Similarity Intuition With Implementation in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">余弦相似直觉及其Python实现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cosine-similarity-intuition-with-implementation-in-python-51eade2674f6?source=collection_archive---------13-----------------------#2021-10-13">https://towardsdatascience.com/cosine-similarity-intuition-with-implementation-in-python-51eade2674f6?source=collection_archive---------13-----------------------#2021-10-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8ffb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">包括使用余弦相似性公式的实际计算</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/60c9497254c898e7ecb4f0ef4ebb61ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cdnVh1idXMFtaBIw9Q9wHw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=702784" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的<a class="ae ky" href="https://pixabay.com/users/thedigitalartist-202249/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=702784" rel="noopener ugc nofollow" target="_blank">皮特·林福思</a>拍摄</p></figure><p id="c053" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习中经常会出现这种情况，你需要比较数据，分析它们有多相似。</p><p id="8e54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在<a class="ae ky" href="https://www.researchgate.net/publication/220974615_Automatic_Text_Summarization_Using_a_Machine_Learning_Approach" rel="noopener ugc nofollow" target="_blank">自动文本摘要</a>中，在训练期间，您需要识别原始文档中的哪些句子与参考摘要中的句子相似。评估摘要的质量也需要这样做。</p><p id="b8cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者你可能需要将一份文件分类，比如说，科学、育儿或技术。</p><p id="29fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一种用于计算两个文本之间相似度的技术叫做<a class="ae ky" href="https://www.sciencedirect.com/topics/computer-science/cosine-similarity" rel="noopener ugc nofollow" target="_blank">余弦相似度</a>。</p><p id="7daa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑下面的基本文本和其他三个文本。我想测量文本1、文本2和文本3与基本文本的相似程度。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4cb7" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">Base text<br/></strong>Quantum computers encode information in 0s and 1s at the same time, until you "measure" it</span><span id="c774" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">Text1</strong><br/>A qubit stores "0 and 1 at the same time" in the same way how a car travelling north-west travels north and west at the same time</span><span id="4d76" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">Text2</strong><br/>Considering how quickly the brain reorganizes, it’s suggested that dreams are a defence mechanism</span><span id="5b05" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">Text3</strong><br/>Computers will come with more processing power due to more advanced processors</span></pre><p id="67fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你是怎么做到的？</p><h1 id="412e" class="mh mb it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">文本变成了载体</h1><p id="b13f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这个案例很简单，可以帮助你清楚地想象它是如何工作的。</p><p id="4257" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，你需要选择——在什么方面相似？！比如同样字数的两个文本相似吗？</p><p id="021e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有两个属性，或称为特征，我用来衡量相似性。</p><ul class=""><li id="2866" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">字数统计(无介词或冠词)</li><li id="17bc" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">基础文本中的单词</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/6330c590d602fbaf8941396393bfe9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QGr9sinCPavlRqrSpzfaDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图一。作为向量表示的文本。按作者。</p></figure><p id="a336" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个属性可以被认为是向量的元素，如图1所示。如您所见，X轴和Y轴代表了这些特征。</p><p id="c4f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个矢量之差形成一个角度。这个角度告诉你它们有多相似或不同。</p><p id="208b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">0度角=它们是一样的。</p><p id="6d2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">90度角=它们彼此相反。</p><h1 id="47f7" class="mh mb it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">余弦相似性</h1><p id="53ff" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">虽然知道角度会告诉你文本有多相似，但最好是0到1之间的值。1表示文本相同。</p><p id="307d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是余弦相似性出现的原因。这是计算它的公式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/eb8d0b075cae734cbe1214064f32f546.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/0*AWIuyRtaO-hYYZNi.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图二。来源:<a class="ae ky" href="https://en.wikipedia.org/wiki/Cosine_similarity" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Cosine_similarity</a></p></figure><p id="cad0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一些数学让你玩得开心。</p><p id="a80d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">a和B是两个文本的向量表示。分子A . B表示两个向量的点积。||A或B||表示矢量的大小。</p><p id="1fdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来计算其中一对——基础文本和文本1。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dff6" class="ma mb it lw b gy mc md l me mf">Let A be the Base text vector = 11, 11<br/>Let B be text1 vector = 4, 17</span><span id="9775" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">Dot product of A and B</strong> = 11 * 4 + 11 * 17 (A first element times B first element + A second element times B second element)<br/>= 44 + 187<br/>= 231</span><span id="1e33" class="ma mb it lw b gy mg md l me mf">The magnitude is taken by squaring each element and adding them up, then taking the square root.</span><span id="bee6" class="ma mb it lw b gy mg md l me mf">||A|| = <strong class="lw iu">√</strong>11<strong class="lw iu">² + </strong>11²<br/>||B|| = <strong class="lw iu">√</strong>4<strong class="lw iu">² + </strong>17²</span><span id="cee5" class="ma mb it lw b gy mg md l me mf">||A|| = 15.5563<br/>||B|| = 17.4642</span><span id="8007" class="ma mb it lw b gy mg md l me mf">||A||*||B|| = 15.5563 * 17.4642<br/>= 271.6783</span><span id="890f" class="ma mb it lw b gy mg md l me mf">Cos sim = 231 / 271.6783<br/><strong class="lw iu">= 0.85 (85% similar!)</strong></span></pre><h1 id="2dee" class="mh mb it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">Python代码</h1><p id="76cd" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">代码很简单，特别是因为我使用了一个内置函数来计算余弦相似度。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python代码。来源:<a class="ae ky" href="https://www.youtube.com/watch?v=m_CooIRM3UI" rel="noopener ugc nofollow" target="_blank"> codebasics </a>。</p></figure><p id="1902" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/06f6c3ba52fdc2450b81cf89d443bc42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jpYyuT_uJCwjel3gH7g0Fw.png"/></div></div></figure><h1 id="c73b" class="mh mb it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="c978" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">正如您在结果中看到的，文本2与基础文本不太相似。Text2是关于梦的，和关于量子计算机的基础文字没有任何共同之处。</p><p id="7eb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，你有没有注意到，有70%的相似！？这不可能。</p><p id="279a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那是因为我选的功能不太对。单词特别重要。除非这是我真正想要的——字数相似的文本是相似的，主题无关紧要……这是对文本比较的一种奇怪的理解。</p><p id="816b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在以后的文章中，我将更多地探索现实世界中用于特性选择的技术。</p><p id="3be5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="38e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="od">延伸阅读:</em> </strong></p><div class="oe of gp gr og oh"><a href="https://medium.com/programming-for-beginners/the-other-approach-to-solve-linear-regression-90be71778b58" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">求解线性回归的另一种方法</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">正规方程介绍。</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://medium.com/programming-for-beginners/unsupervised-versus-supervised-machine-learning-1e55aeb3d2df" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">无监督与有监督的机器学习</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">关于两种学习方式的初学者指南</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov ks oh"/></div></div></a></div></div></div>    
</body>
</html>