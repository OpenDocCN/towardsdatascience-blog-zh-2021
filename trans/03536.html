<html>
<head>
<title>Image color identification with Machine Learning and Image Processing, using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像颜色识别与机器学习和图像处理，使用Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-color-identification-with-machine-learning-and-image-processing-using-python-f3dd0606bdca?source=collection_archive---------16-----------------------#2021-03-22">https://towardsdatascience.com/image-color-identification-with-machine-learning-and-image-processing-using-python-f3dd0606bdca?source=collection_archive---------16-----------------------#2021-03-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/2c40321b4619763e149081c6cae2ca8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzjAopfFnXpgRbCv9Hoo-g.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">拉娅·索德伯格在<a class="ae jd" href="/s/photos/fruit?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="230b" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">用几行代码识别图像的颜色</h2></div><p id="e810" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi lr translated"><span class="l ls lt lu bm lv lw lx ly lz di">计算机视觉中一个非常常见的任务就是识别颜色。</span></p><p id="9eef" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更一般地说，学习的一个迷人的方面是，有时我们知道一些事情，但我们无法解释它们。例如，如果我让你描述“红色”,你唯一的选择是给我看一个红色的物体，就像上面报道的红橙色……但是你不能真正解释“红色”是什么。</p><p id="f5af" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">为此，需要付出一定的努力将颜色的定义传输给计算机。</strong></p><p id="4dd5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们开始吧！</p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h2 id="8557" class="mh mi jg bd mj mk ml dn mm mn mo dp mp le mq mr ms li mt mu mv lm mw mx my mz bi translated">1.图像</h2><p id="8b53" class="pw-post-body-paragraph kv kw jg kx b ky na kh la lb nb kk ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">第一步是得到一个图像。我用过这个:</p><figure class="ng nh ni nj gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nf"><img src="../Images/ba318f6ab89089311705d2d0a86e5ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgqprePfM42kIhA2G8wKcQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">照片由<a class="ae jd" href="https://unsplash.com/@danielacuevas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">丹妮拉·奎瓦斯</a>在<a class="ae jd" href="/s/photos/landscape?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="d657" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="nk">这种算法的最大优点是，正如你将看到的，它非常健壮，并且它给出的令人满意的输出完全独立于输入图像，所以你可以选择你自己的照片。</em> </strong></p><h2 id="2863" class="mh mi jg bd mj mk ml dn mm mn mo dp mp le mq mr ms li mt mu mv lm mw mx my mz bi translated">2.图书馆</h2><p id="549a" class="pw-post-body-paragraph kv kw jg kx b ky na kh la lb nb kk ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">让我们召唤一些恶魔。您将需要用于机器学习部分的<strong class="kx jh"> Sklearn </strong>库、用于矢量转换的<strong class="kx jh"> Numpy </strong>、用于最终摘要的Pandas 和一些图像处理典型库<strong class="kx jh"> (cv2、skimage、matplotlib.pyplot、…) </strong></p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="f79a" class="mh mi jg bd mj mk ml dn mm mn mo dp mp le mq mr ms li mt mu mv lm mw mx my mz bi translated">3.机器学习部分</h2><p id="9282" class="pw-post-body-paragraph kv kw jg kx b ky na kh la lb nb kk ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated"><a class="ae jd" rel="noopener" target="_blank" href="/color-identification-in-images-machine-learning-application-b26e770c4c71">这篇伟大的文章</a> <strong class="kx jh">给了我们一个非常好的提示</strong>。事实上，主要思想是可以将图像用作(N_rows X N_columns X N_channels)向量。<strong class="kx jh">考虑到</strong> <strong class="kx jh">这个向量，有可能应用K均值算法，识别K个聚类，那将是我们的颜色。</strong></p><p id="43df" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">这非常有趣，原因有几个</strong>。首先，它不需要对大量图像进行任何特定的训练。第二个是你可以增加聚类的数量(从而增加颜色的数量)，选择更少或更多的色调。</p><p id="99ee" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，您将需要以下功能:</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="0ef4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些命令:</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="e6de" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nk">这最后几行可能需要一段时间，但没那么长。此外，这是该过程中唯一“计算量大”的部分。</em></p><p id="aaed" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦完成，你将拥有你的10种颜色(我通过设置“颜色数量=10”来选择它们为10)</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="07ff" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">他们来了。</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="10c0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">特别是，采用颜色的rgb编码(rgb_colors list)是很有用的…但我们将在稍后实现。</p><h2 id="c32f" class="mh mi jg bd mj mk ml dn mm mn mo dp mp le mq mr ms li mt mu mv lm mw mx my mz bi translated">3.图像处理部分</h2><p id="871a" class="pw-post-body-paragraph kv kw jg kx b ky na kh la lb nb kk ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">所以我们有自己的颜色。困难的是，虽然我们可以看到它们并识别它们，但我们无法将“标签”列表中的每个元素与其对应的颜色联系起来。实际上，<strong class="kx jh"> K Means是一种无监督的学习方法</strong>。</p><p id="e1ea" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，如果我们想自动检测天空的颜色，并将其与饼图中的一种颜色相关联，我们需要更有创意一些。</p><p id="3480" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">主要的想法是非常基本的。事实上，图像是RGB编码的。<strong class="kx jh">这意味着，如果我们计算图像和10种颜色之一的rgb表达式之间的差异，当图像等于颜色时，我们会得到[0，0，0]。</strong></p><p id="4704" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我告诉你，这不是正统。其实你会有负像素。但是有用，有用就别碰:)</p><p id="3463" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第一步是技术性的，它基于将RGB转换为整数值。</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="8847" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，如果我们想要识别图像的颜色，<strong class="kx jh">想法是将这个图像分成更小的方块</strong>。在这种情况下，我选择每个正方形的维数为N_rows/10 X N_columns/10，因此得到100个正方形。这些正方形是通过使用下面的函数得到的。</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="e267" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当然，方块不是单色的。这意味着每个方块将有多种颜色。尽管如此，图像之间的平均距离是我们需要的指标:<strong class="kx jh">我们选择平均来说比其他颜色更接近0的颜色</strong>。具体来说，我们通过使用以下函数来实现:</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="1575" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">使用此功能，我们可以为每个方块绘制“最佳颜色”。</strong></p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="deb2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我展示给你看:</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="978d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">太棒了！不是吗？</p><h2 id="b163" class="mh mi jg bd mj mk ml dn mm mn mo dp mp le mq mr ms li mt mu mv lm mw mx my mz bi translated">4.最后的结果</h2><p id="280c" class="pw-post-body-paragraph kv kw jg kx b ky na kh la lb nb kk ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">为了<strong class="kx jh">获得该实验对图像所有方块的总结</strong>，可以使用以下函数:</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="8e4e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是:</p><figure class="ng nh ni nj gt is"><div class="bz fp l di"><div class="nl nm l"/></div></figure><blockquote class="nn no np"><p id="7079" class="kv kw nk kx b ky kz kh la lb lc kk ld nq lf lg lh nr lj lk ll ns ln lo lp lq ij bi translated">附注:每一栏下的数字是该特定方块的颜色百分比</p></blockquote><h1 id="6b36" class="nt mi jg bd mj nu nv nw mm nx ny nz mp km oa kn ms kp ob kq mv ks oc kt my od bi translated">结论</h1><p id="5d0c" class="pw-post-body-paragraph kv kw jg kx b ky na kh la lb nb kk ld le nc lg lh li nd lk ll lm ne lo lp lq ij bi translated">我们被生活在一个拥有“能看见”的机器的世界的想法吓坏了。虽然这种想法可能令人担忧，因为它是可以理解的，但同时我忍不住认为它非常迷人。我喜欢认为我们在某种程度上是新世界和新自然的创造者…或者也许我只是太累了。</p><p id="f66f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="ce33" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.在<a class="ae jd" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Linkedin </strong> </a>上关注我，在那里我发布我所有的故事<br/> B .订阅我的<a class="ae jd" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="kx jh">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae jd" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="kx jh">推荐会员</strong> </a>，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p><p id="53ae" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">再见。:)</p></div></div>    
</body>
</html>