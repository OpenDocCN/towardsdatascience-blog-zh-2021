<html>
<head>
<title>Modeling, Visualizing, and Navigating a Transportation Network with Memgraph</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Memgraph对交通网络进行建模、可视化和导航</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/modeling-and-navigating-a-transportation-network-with-memgraph-944f84828007?source=collection_archive---------29-----------------------#2021-04-12">https://towardsdatascience.com/modeling-and-navigating-a-transportation-network-with-memgraph-944f84828007?source=collection_archive---------29-----------------------#2021-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="10f1" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="7699" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">了解如何通过使用Cypher查询语言和简单的图形算法在伦敦找到自己的路。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5e8e3d8d8296a5539b9e76be0fda9bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QTd4IFUNfh49ya4-_LpZ2Q.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">威尔·H·麦克马汉在<a class="ae le" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="ee3a" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">介绍</h1><p id="18b6" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">如果骑自行车或步行不是一种选择，使用公共交通是在城市中旅行的最环保的方式。在公共交通系统中导航可能会令人困惑和复杂。</p><p id="9b78" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">作为一名乘客，你通常想知道如何从一个车站到另一个车站，以及在哪里换车，以尽可能优化你的旅程。本质上，问题是在复杂的车站和线路网络中寻找最短路径。这种类型的问题是一个典型的图形用例。图表用于建模和导航各种领域的复杂网络问题，包括交通、网络安全、欺诈检测等等。</p><p id="8991" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在本教程中，您将探索如何使用图表来建模和导航交通网络。您将学习如何将伦敦地铁数据集导入Memgraph，并使用Memgraph Lab在地图上显示该数据集。接下来，您将学习如何使用Cypher查询语言和图形算法来帮助您探索伦敦地铁网络，并在城市中找到自己的路，而不会迷路或因交通堵塞而浪费时间。</p><h1 id="b1fb" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">先决条件</h1><p id="2193" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">要完成本教程，您需要:</p><ul class=""><li id="fb49" class="my mz iq lz b ma mt md mu mg na mk nb mo nc ms nd ne nf ng bi translated">一个<a class="ae le" href="https://docs.memgraph.com/memgraph/getting-started/installation/" rel="noopener ugc nofollow" target="_blank"> Memgraph DB </a>的安装:一个本地的、内存中的图形数据库。要安装和设置Memgraph DB，请遵循<a class="ae le" href="https://docs.memgraph.com/memgraph/getting-started/installation/" rel="noopener ugc nofollow" target="_blank">安装</a>指南上的<strong class="lz ja"> Docker安装</strong>说明。</li><li id="2ea4" class="my mz iq lz b ma nh md ni mg nj mk nk mo nl ms nd ne nf ng bi translated">一个<a class="ae le" href="https://memgraph.com/download#Lab-download" rel="noopener ugc nofollow" target="_blank"> Memgraph Lab </a>的安装:一个用于导入数据、开发、调试和分析数据库查询以及可视化查询结果的集成开发环境。</li><li id="01cc" class="my mz iq lz b ma nh md ni mg nj mk nk mo nl ms nd ne nf ng bi translated">你可以在这里下载伦敦地铁网络数据集。</li></ul><h1 id="928b" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">定义图形数据模型</h1><p id="a7af" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在本教程中，您将使用由<a class="ae le" href="https://github.com/nicola/tubemaps" rel="noopener ugc nofollow" target="_blank"> Nicola Greco </a>发布的伦敦地铁网络数据集。它包含302个站(节点)和812个连接(边)。节点<code class="fe nm nn no np b">lat</code>和<code class="fe nm nn no np b">lng</code>属性表示一个站点的坐标，对于在地图上可视化数据也很重要。</p><p id="d3cb" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如果两个站相邻，则用<code class="fe nm nn no np b">:Connection</code>类型的边连接。因为火车是双向行驶的，所以每个方向都有优势。</p><p id="1a3b" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">每条边都有一个表示在两个站点之间旅行所需时间(以分钟为单位)的<code class="fe nm nn no np b">time</code>属性和一个<code class="fe nm nn no np b">line</code>属性，在本教程稍后添加一个<code class="fe nm nn no np b">name</code>属性后，这个属性会更有意义。</p><p id="e337" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">既然已经定义了方案，就可以导入数据集了。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/d6005b8ba3ebea97496da22ad5eecdba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zfNw_m-sFgTvfSYgiTW8w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><h1 id="26ee" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">使用CVS导入工具导入数据集</h1><p id="72a6" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">第一步是将数据加载到Memgraph中。Memgraph附带了将数据导入数据库的工具。对于本教程，您将使用<strong class="lz ja"> CSV导入工具</strong>。</p><p id="8812" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">CSV导入工具应该用于将数据初始批量摄取到Memgraph中。在接收时，CSV导入程序会创建一个快照，数据库将使用该快照在下次启动时恢复其状态。你可以<a class="ae le" href="https://docs.memgraph.com/memgraph/concepts/storage/#durability-and-data-recovery" rel="noopener ugc nofollow" target="_blank">在这里了解快照</a>。</p><h2 id="03d4" class="nr lg iq bd lh ns nt dn ll nu nv dp lp mg nw nx lr mk ny nz lt mo oa ob lv iw bi translated">格式化CSV文件</h2><p id="39bd" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">CSV文件的每一行代表应该导入到数据库中的单个条目。节点和关系都可以使用CSV文件导入数据库。</p><p id="c2a0" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">要获得所有相关数据，您需要三个文件。第一个包含关于节点的数据(<code class="fe nm nn no np b">stations.csv</code>)，另外两个包含关于关系的数据(<code class="fe nm nn no np b">connections.csv</code>和<code class="fe nm nn no np b">connections-reverse.csv</code>)。每个CSV文件必须有一个描述数据的标题。<br/> <code class="fe nm nn no np b">stations.csv</code>有如下表头:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="db32" class="nr lg iq np b gy og oh l oi oj">id:ID(STATION),lat:double,lng:double,name:string,display_name:string,zone:int,total_lines:int,rail:int</span></pre><p id="a275" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><code class="fe nm nn no np b">ID</code>字段类型设置在创建关系时将用于节点的内部<code class="fe nm nn no np b">ID</code>。这是可选的，没有指定<code class="fe nm nn no np b">ID</code>值的节点将被导入，但不能连接到任何关系。</p><p id="5c00" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">当导入关系时，<code class="fe nm nn no np b">START_ID</code>字段类型将应该与关系连接的开始节点设置为带有<code class="fe nm nn no np b">END_ID</code>的结束节点。必须指定字段，并且节点<code class="fe nm nn no np b">ID</code>必须是节点CSV文件中指定的节点id之一。</p><p id="45a1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">文件<code class="fe nm nn no np b">connections.csv</code>和<code class="fe nm nn no np b">connections-reverse.csv</code>除了头之外是一样的。这是因为我们需要两个方向的连接，因此，与其在导入数据后创建缺失的关系，不如导入第二个文件，并在其中切换<code class="fe nm nn no np b">START_ID</code>和<code class="fe nm nn no np b">END_ID</code>。因此，您从第一个文件中获得了每个关系的副本，只是方向相反。</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="b35f" class="nr lg iq np b gy og oh l oi oj">:END_ID(STATION),:START_ID(STATION),line:int,time:int</span><span id="e96c" class="nr lg iq np b gy ok oh l oi oj">:START_ID(STATION),:END_ID(STATION),line:int,time:int</span></pre><h2 id="fc4c" class="nr lg iq bd lh ns nt dn ll nu nv dp lp mg nw nx lr mk ny nz lt mo oa ob lv iw bi translated">使用CSV导入工具</h2><p id="7823" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated"><strong class="lz ja">【注意】</strong>如果您的Memgraph数据库实例正在运行，您需要在继续下一步之前停止它。</p><p id="2da5" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">首先，您需要将CSV文件复制到Docker映像可以看到它们的地方。导航到包含数据文件的文件夹，并运行以下命令:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="a269" class="nr lg iq np b gy og oh l oi oj">docker container create --name mg_import_helper -v mg_import:/import-data busybox<br/>docker cp connections.csv mg_import_helper:/import-data<br/>docker cp connections-reverse.csv mg_import_helper:/import-data<br/>docker cp stations.csv mg_import_helper:/import-data<br/>docker rm mg_import_helper</span></pre><p id="e390" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">用于指定输入CSV文件的两个主要标志是<code class="fe nm nn no np b">--nodes</code>和<code class="fe nm nn no np b">--relationships</code>。<br/>节点标签(<code class="fe nm nn no np b">Station</code>)和关系类型(<code class="fe nm nn no np b">:Connection</code>)需要在导入时设置，因为CSV文件不包含这些信息。</p><p id="8782" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">您可以使用以下命令运行导入程序:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="6f1e" class="nr lg iq np b gy og oh l oi oj">docker run -v mg_lib:/var/lib/memgraph -v mg_etc:/etc/memgraph -v mg_import:/import-data --entrypoint=mg_import_csv memgraph --nodes Station=/import-data/stations.csv --relationships Connection=/import-data/connections.csv --relationships Connection=/import-data/connections-reverse.csv --data-directory /var/lib/memgraph true --storage-properties-on-edges true</span></pre><p id="beeb" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在，您可以通过运行以下命令来启动Memgraph:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="9999" class="nr lg iq np b gy og oh l oi oj">docker run -v mg_lib:/var/lib/memgraph -p 7687:7687 memgraph:latest --data-directory /var/lib/memgraph</span></pre><p id="0dee" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如果您对CSV导入工具有其他问题，请查看我们的文档:<a class="ae le" href="https://docs.memgraph.com/memgraph/database-functionalities/import-data/#csv-import-tool" rel="noopener ugc nofollow" target="_blank"> CSV导入工具</a>。</p><h1 id="719b" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">用Memgraph Lab可视化图形</h1><p id="1481" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">一旦你有了Memgraph中的数据，用Memgraph Lab可视化它就相当容易了。<strong class="lz ja"> Memgraph Lab </strong>自动检测具有数字<code class="fe nm nn no np b">lat</code>和<code class="fe nm nn no np b">lng</code>属性的节点。要获得图表，请运行以下Cypher查询:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="7f60" class="nr lg iq np b gy og oh l oi oj">MATCH (n)-[r]-(m)<br/>RETURN n,r,m;</span></pre><p id="1889" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如果一切正常，您应该会得到类似于下图的可视化效果。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ol"><img src="../Images/360e8596aad9102a8db391dd8ba88bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ft2Ei3xqbdxH2HEVu1mSiQ.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><h2 id="9af6" class="nr lg iq bd lh ns nt dn ll nu nv dp lp mg nw nx lr mk ny nz lt mo oa ob lv iw bi translated">向边缘添加属性</h2><p id="e1ae" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">属性没有多大意义，因为我们通常通过名称或颜色来识别伦敦地铁线。除非你在边上添加一个<code class="fe nm nn no np b">name</code>属性，否则地图会更加混乱。</p><p id="57ee" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">下面的Cypher查询使用了允许列出多个谓词的<code class="fe nm nn no np b">CASE</code>表达式。匹配第一个计算结果为<code class="fe nm nn no np b">true</code>的表达式，在<code class="fe nm nn no np b">THEN</code>关键字之后提供的表达式的结果用于设置关系的<code class="fe nm nn no np b">name</code>属性的值。</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="4310" class="nr lg iq np b gy og oh l oi oj">MATCH (n)-[r]-(m)<br/>SET r.name = CASE<br/>WHEN r.line = 1  THEN "Bakerloo Line"<br/>WHEN r.line = 2  THEN "Central Line"<br/>WHEN r.line = 3  THEN "Circle Line"<br/>WHEN r.line = 4  THEN "District Line"<br/>WHEN r.line = 5  THEN "East London Line"<br/>WHEN r.line = 6  THEN "Hammersmith &amp; City Line"<br/>WHEN r.line = 7  THEN "Jubilee Line"<br/>WHEN r.line = 8  THEN "Metropolitan Line"<br/>WHEN r.line = 9  THEN "Northern Line"<br/>WHEN r.line = 10 THEN "Piccadilly Line"<br/>WHEN r.line = 11 THEN "Victoria Line"<br/>WHEN r.line = 12 THEN "Waterloo &amp; City Line"<br/>WHEN r.line = 13 THEN "Docklands Light Railway"<br/>END;</span></pre><h2 id="e762" class="nr lg iq bd lh ns nt dn ll nu nv dp lp mg nw nx lr mk ny nz lt mo oa ob lv iw bi translated">设计图表样式</h2><p id="0510" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">虽然数据集现在更有意义，但地图的样式仍然有点过于统一。您可以使用Memgraph Lab中的样式编辑器根据自己的喜好设置地图的样式。你可以在本教程中阅读更多关于样式编辑器<a class="ae le" href="https://memgraph.com/blog/how-to-style-your-graphs-in-memgraph-lab" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="4f17" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">首先，让我们把车站变小，做成正方形。一个带黑边的白色圆圈是为换乘站预留的(在那里你可以在线路之间切换)。为此，您将使用以下样式脚本:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="c1a0" class="nr lg iq np b gy og oh l oi oj">@NodeStyle HasLabel?(node, "Station") {<br/>    size: 15<br/>    color: black<br/>    shape: "square"<br/>    color-hover: red<br/>    color-selected: Darker(red)<br/>}</span><span id="dbd5" class="nr lg iq np b gy ok oh l oi oj">@NodeStyle Greater?(Property(node, "total_lines"), 1) {<br/>    size: 30<br/>    shape: "dot"<br/>    border-width: 2<br/>    border-color: black<br/>    color: white<br/>    color-hover: red<br/>    color-selected: Darker(red)<br/>}</span><span id="47f7" class="nr lg iq np b gy ok oh l oi oj">@NodeStyle HasProperty?(node, "name") {<br/>    label: AsText(Property(node, "name"))<br/>}</span></pre><p id="8a6e" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在你可以添加最重要的东西，标志性的线条颜色！为此，您将使用以下脚本:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="a7c9" class="nr lg iq np b gy og oh l oi oj">@EdgeStyle HasProperty?(edge, "name") {<br/>  label: AsText(Property(edge, "name"))<br/>  width: 10<br/>}</span><span id="69f9" class="nr lg iq np b gy ok oh l oi oj">@EdgeStyle Equals?(Property(edge, "line"),1)  {color: #AE6017}<br/>@EdgeStyle Equals?(Property(edge, "line"),2)  {color: #F15B2E}<br/>@EdgeStyle Equals?(Property(edge, "line"),3)  {color: #FFE02B}<br/>@EdgeStyle Equals?(Property(edge, "line"),4)  {color: #00A166} <br/>@EdgeStyle Equals?(Property(edge, "line"),5)  {color: #FBAE34}<br/>@EdgeStyle Equals?(Property(edge, "line"),6)  {color: #F491A8}<br/>@EdgeStyle Equals?(Property(edge, "line"),7)  {color: #949699}<br/>@EdgeStyle Equals?(Property(edge, "line"),8)  {color: #91005A}<br/>@EdgeStyle Equals?(Property(edge, "line"),9)  {color: #000000}<br/>@EdgeStyle Equals?(Property(edge, "line"),10) {color: #094FA3}<br/>@EdgeStyle Equals?(Property(edge, "line"),11) {color: #0A9CDA}<br/>@EdgeStyle Equals?(Property(edge, "line"),12) {color: #88D0C4}<br/>@EdgeStyle Equals?(Property(edge, "line"),13) {color: #00A77E}</span></pre><p id="631c" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">您的图表现在应该看起来像这样:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi om"><img src="../Images/ea05a999aada3efc779969d0abff3987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H4i1kU5e-toHMPHyagWJRw.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><h1 id="d23a" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">探索图形网络</h1><p id="29ce" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">现在，您已经将图形数据加载到Memgraph中，并在Memgraph Lab中设置了可视化，您已经准备好开始使用图形遍历和算法来探索伦敦地铁网络。</p><p id="569b" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">假设你正在计划一次旅行，想在一个交通便利的车站附近找一家酒店。</p><p id="d9cc" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">通过使用以下密码查询，您将找到哪些工作站与其他工作站的连接最多:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="a541" class="nr lg iq np b gy og oh l oi oj">MATCH (s1:Station)-[:Connection]-&gt;(s2:Station)<br/>WITH DISTINCT s2.name as adjacent, s1.name as name<br/>RETURN name AS Station_name, COUNT(adjacent) AS Total_connections<br/>ORDER BY Total_connections DESC LIMIT 10;</span></pre><p id="7e86" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">对于每个桩号，查询的第一部分匹配所有相差一度的桩号。第二部分计算连接数，并返回10个连接最多的站的列表。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi on"><img src="../Images/cf54171ac63e0d4e8308ae5cbaec674b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bLIvil_Yqh6dM6gdk3hFJQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="ed95" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在你有你的清单，国王十字圣潘克拉斯是显而易见的选择。通过运行以下查询，您可以很容易地检查您可以从King's Cross St. Pancras访问哪些管道线路:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="a089" class="nr lg iq np b gy og oh l oi oj">MATCH (:Station {name:"King's Cross St. Pancras"})-[r]-(:Station)<br/>WITH DISTINCT r.name AS line<br/>RETURN line;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/50aae2e9c293c79ebf95af487cb95eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FVhw8wDdZcvB-6pckG6N3g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="7d62" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">比方说，你正在进行一次预算旅行，你想留在第一票价区，以保持较低的交通成本。在这种情况下，您可以使用广度优先算法来查找在第一票价区停留期间您可以从圣潘克拉斯到达哪些车站:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="4cc9" class="nr lg iq np b gy og oh l oi oj">MATCH p = (s1:Station {name:"King's Cross St. Pancras"})<br/>          -[:Connection * bfs (e, n | n.zone = 1)]-<br/>          (s2:Station)    <br/>UNWIND (nodes(p)) as rows<br/>WITH DISTINCT rows.name as Station <br/>RETURN Station LIMIT 10;</span></pre><p id="84a7" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><code class="fe nm nn no np b">(e, n | n.zone = 1)</code>被称为<em class="op">滤波器λ</em>。这个函数采用一个边符号<code class="fe nm nn no np b">e</code>和一个节点符号<code class="fe nm nn no np b">n</code>，并通过返回<code class="fe nm nn no np b">true</code>或<code class="fe nm nn no np b">false</code>来决定该边和节点对在广度优先扩展中是否有效。在这个例子中，如果车站在第一收费区，lambda返回<code class="fe nm nn no np b">true</code>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/dba83bc78cffff924ae89ca056359921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TP0Fl_Yb9Q6cSfWT3K2tSg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="f296" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">或者，如果您更喜欢视觉，您可以通过运行以下查询来可视化您的结果:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="6112" class="nr lg iq np b gy og oh l oi oj">MATCH p = (:Station {name:"King's Cross St. Pancras"})<br/>          -[:Connection * bfs (e, n | n.zone = 1)]-<br/>          (:Station)<br/>RETURN p;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi or"><img src="../Images/7f06b81ef91fd40eaa69a2828a3b67a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KaBCqfp3YG7-4vpN24IvZA.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="f2c3" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">假设你刚刚到达伦敦希思罗机场。你可能累了，急需洗个澡，打个盹儿，但是在去酒店的路上，你会想去位于威斯敏斯特地铁站的大本钟。</p><p id="c341" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">幸运的是，Memgraph可以帮助你立刻找到最快的路线！</p><p id="1f15" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">寻路算法是经典的图论问题之一，自19世纪以来一直被研究。最短路径算法计算图中两个节点之间的路径，使得边权重的总和最小。<br/>这里的语法类似于广度优先搜索语法。代替一个<em class="op">过滤器λ</em>，我们需要提供一个<em class="op">权重λ</em>和<em class="op">总权重符号</em>。给定一个边和节点对，<em class="op"> weight lambda </em>必须返回使用给定边扩展到给定节点的成本(<code class="fe nm nn no np b">time</code>)。</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="5513" class="nr lg iq np b gy og oh l oi oj">MATCH p = (s1:Station {name: "Heathrow Terminal 4"})<br/>          -[edge_list:Connection *wShortest (e, n | e.time) time]-<br/>          (s2:Station {name: "Westminster"})<br/>RETURN *;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/81efc3218f624ca300d8fddbd3052080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GTNItUR-GINe7Sfv9Jqf0g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="3fe1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这条路线将让你在43分钟内从希思罗机场到威斯敏斯特，但在环线和区线有延迟，所以你想把他们排除在搜索之外。您可以在最短路径查询中组合使用<em class="op">权重</em>和<em class="op">过滤器λs</em>:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="76d9" class="nr lg iq np b gy og oh l oi oj">MATCH p = (s1:Station {name: "Heathrow Terminal 4"})<br/>          -[edge_list:Connection *wShortest (e, n | e.time) time (e, n | e.name != "Circle Line" AND e.name != "District Line")]-<br/>          (s2:Station {name: "Westminster"})<br/>RETURN *;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/3677ac6760af37f34c05371516e97f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Ugma7QlLwaFVgd-VKO_qg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="937e" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">新路线只多3分钟，但你会避免延误。</p><p id="1415" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">从威斯敏斯特出发的最短路线将在10分钟内带您到达酒店(不包括环线和区线)。</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="05cc" class="nr lg iq np b gy og oh l oi oj">MATCH p = (s1:Station {name: "Westminster"})<br/>          -[edge_list:Connection *wShortest (e, n | e.time) time (e, n | e.name != "Circle Line" AND e.name != "District Line")]-<br/>          (s2:Station {name: "King's Cross St. Pancras"})<br/>RETURN *;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/0504a675bc785a672ca030fd3c235387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YCWCNhc31XJCl7xNOcq6uw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="a92f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">令人惊讶的是，伦敦有多少博物馆和美术馆是免费参观的。大英博物馆绝对应该是你的首选！虽然你可以在那里呆上几个小时，但是你想什么都看一点，所以让我们再增加几个选项。</p><p id="02e2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">托特纳姆法院路站离大英博物馆最近，这将是您的第一站。南肯辛顿站距离三个令人惊叹的博物馆只有几步之遥:科学博物馆、自然历史博物馆和维多利亚和阿尔伯特博物馆。要找到旅行的最佳路线，您可以使用以下Cypher查询:</p><pre class="kp kq kr ks gt oc np od oe aw of bi"><span id="4845" class="nr lg iq np b gy og oh l oi oj">MATCH p = (:Station {name: "King's Cross St. Pancras"})<br/>          -[:Connection *wShortest (e, n | e.time) time1]-<br/>          (:Station {name: "Tottenham Court Road"})<br/>          -[:Connection *wShortest (e, n | e.time) time2]-<br/>          (:Station {name: "South Kensington"})<br/>RETURN p, time1 + time2 AS total_time;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/b9c372fa1dfde169356ccaaa5c96e69b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Ad2-v886TqfF_kYYW17hQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><h1 id="7657" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">结论</h1><p id="ebde" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在本教程中，您学习了如何使用<strong class="lz ja"> Memgraph </strong>和<strong class="lz ja"> Cypher </strong>对复杂的交通网络进行建模和导航。在图形算法的帮助下，您找到了最佳路线，并学习了如何使用<strong class="lz ja"> Memgraph Lab </strong>可视化数据以充分利用数据。如果你有兴趣探索另一个图形路线规划教程，你可以在<a class="ae le" href="https://playground.memgraph.com/" rel="noopener ugc nofollow" target="_blank"> Memgraph Playground </a>上查看<a class="ae le" href="https://playground.memgraph.com/Europe" rel="noopener ugc nofollow" target="_blank">探索欧洲路网</a>演示。</p><p id="5a10" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">一个朋友曾经告诉我:</p><p id="8699" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在伦敦你永远不会迷路，你只要找到一个地铁站，就知道你在哪里了</p><p id="01dd" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">我会说:</p><p id="ad9a" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">“你永远不会在伦敦迷路，你只需要用Memgraph找到最短的路径！”</p><p id="45e5" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">记住，永远站在右边，别忘了注意空隙！</p></div></div>    
</body>
</html>