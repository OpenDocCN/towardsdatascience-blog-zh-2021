<html>
<head>
<title>Visualizing Football Game Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化足球比赛数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-football-game-data-6a124fab911b?source=collection_archive---------9-----------------------#2021-12-23">https://towardsdatascience.com/visualizing-football-game-data-6a124fab911b?source=collection_archive---------9-----------------------#2021-12-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="82db" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 Python、JSON、Matplotlib 和 Streamlit</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7e485517412751cbcd6a5cfc4b7bc411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CU-poG83ygAIxRDqYho5g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://www.pexels.com/de-de/@fabtruji?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">法布里西奥·特鲁希略</a>拍摄于<a class="ae kv" href="https://www.pexels.com/de-de/foto/weisses-und-grunes-gras-wahrend-des-tages-54567/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">像素</a></p></figure><ul class=""><li id="2884" class="kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">在 Streamlit 上查看申请:<a class="ae kv" href="https://share.streamlit.io/andriigoz/football_game_stats/main.py" rel="noopener ugc nofollow" target="_blank">https://share . Streamlit . io/andriigoz/football _ game _ stats/main . py</a></li><li id="b33e" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated">GitHub 库:<a class="ae kv" href="https://github.com/AndriiGoz/football_game_stats" rel="noopener ugc nofollow" target="_blank">https://github.com/AndriiGoz/football_game_stats</a></li></ul><h2 id="9c42" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ld mc md me lf mf mg mh lh mi mj mk ml bi translated">浏览数据</h2><p id="f2d2" class="pw-post-body-paragraph mm mn iq ky b kz mo jr mp lb mq ju mr ld ms mt mu lf mv mw mx lh my mz na lj ij bi translated">我总是对显示足球运动员在球场上表现的热图感到兴奋。让我们尝试构建我们的应用程序，在其中我们可以选择一个玩家和他的动作，并将其可视化。用于分析的数据在 StatsBomb 开放数据存储库中的<a class="ae kv" href="https://github.com/statsbomb/open-data" rel="noopener ugc nofollow" target="_blank">处找到。StatsBomb 是一家收集和存储足球比赛数据的英国公司。对于我的应用程序，我取了 15 个 JSON 文件，代表 2020 年欧锦赛淘汰赛阶段的 15 场比赛，比赛发生在 2021 年 6 月 26 日至 2021 年 7 月 11 日之间。</a></p><p id="4cc3" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">让我们打开并发现意大利和英格兰之间的决赛。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="4be5" class="lt lu iq nf b gy nj nk l nl nm"># Read JSON file<br/>with open('3795506.json', 'r', errors="ignore") as f:<br/>    game = json.load(f)<br/>df = pd.json_normalize(game, sep='_')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/e6e5694cf6a366a77cf1f1c2d020d4f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K21NERHe0D51a9fzaF53PQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">4796 行× 122 列</p></figure><p id="470b" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">让我们先来看看数据框架。共 4796 行，122 列，有<em class="no">时间戳</em>、<em class="no">玩家名</em>、<em class="no">类型名位置、</em>等列。它告诉我们整个游戏的故事，从开始到结束:发生了什么，谁做的，什么样的行动，在哪里等。有一个大约 120 分钟长的游戏和一个 4796 行的数据帧，我们得到每 1.5 秒捕获的动作列表。</p><p id="c8c8" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">那场比赛玩家做了几个动作？那是什么样的行动？使用<em class="no"> pd.value_counts </em>我们可以看到<em class="no"> player_name </em>和<em class="no"> type_name </em>列的唯一值的计数，并了解那里发生了什么。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/03fd578b37850950722d11f0e366fccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*F1cqs6sX-C3eORJDz8fibQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">玩家名称和类型名称的动作数量</p></figure><p id="64ab" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">马尔科·维拉蒂以他的 382 次行动成为游戏中最活跃的玩家。最常见的动作是<em class="no">传球、接球</em>和<em class="no">持球</em>。对于我的应用程序，我决定采取四个最频繁的动作加上<em class="no"> Shot </em>动作。<em class="no"/>app 的思路是做一些下拉菜单，我们可以在里面选择一场比赛、一名球员、其中一个动作，然后在球场上画出这个具体动作的可视化。</p><h2 id="8877" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ld mc md me lf mf mg mh lh mi mj mk ml bi translated">创建音高</h2><p id="27d3" class="pw-post-body-paragraph mm mn iq ky b kz mo jr mp lb mq ju mr ld ms mt mu lf mv mw mx lh my mz na lj ij bi translated">在<em class="no">之友的追踪库</em>中的<a class="ae kv" href="https://github.com/Friends-of-Tracking-Data-FoTD/SoccermaticsForPython/blob/master/FCPython.py" rel="noopener ugc nofollow" target="_blank">这里</a>找到了 Pitch Plot 函数。他们用<em class="no">长度、宽度、单位</em>和<em class="no">线条颜色</em>参数创建了一个很好的函数，返回给我们一个现成的足球场作为次要情节。所以我们只是拿着它，并不太坚持这一部分。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="044a" class="lt lu iq nf b gy nj nk l nl nm">from FCPython import createPitch<br/># Create pitch plot<br/>pitch_width = 120<br/>pitch_height = 80<br/>fig, ax = createPitch(pitch_width, pitch_height, 'yards', 'gray')</span></pre><h2 id="14b5" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ld mc md me lf mf mg mh lh mi mj mk ml bi translated">通过绘图功能</h2><p id="7b04" class="pw-post-body-paragraph mm mn iq ky b kz mo jr mp lb mq ju mr ld ms mt mu lf mv mw mx lh my mz na lj ij bi translated">我们通过选择包含某些<em class="no">类型名称</em>和<em class="no">玩家名称</em>的行来启动通道绘图功能。<em class="no"> type_name </em>在这里等于“Pass”，<em class="no"> player_name </em>将由用户从下拉菜单中选择分配(这将在 Streamlit 应用程序部分完成)。接下来，我们得到<em class="no">位置</em>和<em class="no"> pass_end_location </em>系列<em class="no"> </em>并将它们转换成两个列表:(x1，y1)坐标，这里给出了一个 pass；和(x2，y2)坐标，其中接收到传球。使用<em class="no">py plot . fibble(x1，y1，u，v) </em>方法，我们现在可以绘制代表通道的箭头。此外，我们为主队分配蓝色，为客场队分配红色。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/92858070ca68576795274c40f2979e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*FrT1faLOJXYHLkQDl7pEjw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马尔科·维拉蒂通行证地图(意大利)。作者图片</p></figure><p id="5d78" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">这样，我们就有了一个函数，它返回游戏中所选玩家的所有传球的可视化效果。进位图和 Shot 图功能具有相同的结构，因此不必在本文中描述。</p><h2 id="29b2" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ld mc md me lf mf mg mh lh mi mj mk ml bi translated">接球图</h2><p id="e189" class="pw-post-body-paragraph mm mn iq ky b kz mo jr mp lb mq ju mr ld ms mt mu lf mv mw mx lh my mz na lj ij bi translated">对于球收据绘图功能，我们选择<em class="no">type _ name = =‘球收据’</em>的行。这里我们只得到一个(x，y)坐标列表，并用<em class="no"> plt 将它们可视化为点。</em>圆(x，y)法。压力绘图功能具有相同的逻辑。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/a32a18213e1e96c8d4997b929ac3567b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*OFnOWEndEzk1X_0p0w8dkA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">哈里·马奎尔(英国)的球收据地图。作者图片</p></figure><h2 id="d8cc" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ld mc md me lf mf mg mh lh mi mj mk ml bi translated">简化应用程序</h2><p id="90e6" class="pw-post-body-paragraph mm mn iq ky b kz mo jr mp lb mq ju mr ld ms mt mu lf mv mw mx lh my mz na lj ij bi translated">Streamlit 是每个数据科学家都应该知道的强大工具。它非常简单，同时，它让您有可能通过 web 应用程序可视化和共享您的数据见解。首先，我们创建了一个侧边栏，它有四个下拉菜单和一些只有几行代码的文本:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="2f87" class="lt lu iq nf b gy nj nk l nl nm"># Drop-down menu 'Select Football Game'<br/>st.sidebar.markdown('## Select Football Game')<br/>menu_game = st.sidebar.selectbox('Select Game', games_list, index=14)<br/><br/># Drop-down menus 'Select Team, Player and Activity'<br/>st.sidebar.markdown('## Select Player and Activity')<br/>menu_team = st.sidebar.selectbox('Select Team', (team_1, team_2))<br/>if menu_team == team_1:<br/>    menu_player = st.sidebar.selectbox('Select Player', player_names_1)<br/>else:<br/>    menu_player = st.sidebar.selectbox('Select Player', player_names_2)<br/>menu_activity = st.sidebar.selectbox('Select Activity', activities)<br/>st.sidebar.markdown('Select a player and activity. Statistics plot will appear on the pitch.')</span></pre><p id="56ec" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">这里我们让用户通过从相应的<em class="no">‘选择玩家’</em>和<em class="no">‘选择活动’</em>下拉菜单中选择来指定<em class="no">玩家名称</em>和<em class="no">类型名称</em>。这些参数将定义必须显示哪个特定的玩家和活动。然后 activity 的 plot 会被<em class="no"> st.pyplot </em>函数调用。使用<em class="no"> st.head </em>、<em class="no"> st.write </em>和<em class="no"> st.markdown </em>方法，我们用一些文本填充我们的主区域。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/281da4652f7243581c7fd8e97420a6f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMjrQKuxSzrbYAxqILr-tw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Streamlit 上的<a class="ae kv" href="https://share.streamlit.io/andriigoz/football_game_stats/main.py" rel="noopener ugc nofollow" target="_blank">应用程序</a></p></figure><p id="d12d" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">要创建 Streamlit 应用程序，您需要为您的 Python 安装 Streamlit 库。为了分享它，你必须在<a class="ae kv" href="http://streamlit.io" rel="noopener ugc nofollow" target="_blank"> streamlit.io </a>注册，制作一个新的应用程序，并将其连接到 GitHub 存储库中的项目文件夹。将自动创建一个随时可用的 web 应用程序。</p><h2 id="d083" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ld mc md me lf mf mg mh lh mi mj mk ml bi translated">参考</h2><p id="9bdd" class="pw-post-body-paragraph mm mn iq ky b kz mo jr mp lb mq ju mr ld ms mt mu lf mv mw mx lh my mz na lj ij bi translated">[1] StatsBomb 公开数据:【https://github.com/statsbomb/open-data T4】</p><p id="b441" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">[2]创建 Pitch 资源库:<a class="ae kv" href="https://github.com/Friends-of-Tracking-Data-FoTD/SoccermaticsForPython/blob/master/FCPython.py" rel="noopener ugc nofollow" target="_blank">https://github . com/Friends-of-Tracking-Data-FoTD/SoccermaticsForPython/blob/master/fc python . py</a></p><p id="ca29" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">[3] <a class="ae kv" href="https://medium.com/@irfanalghani11?source=post_page-----2f4070d551ff-----------------------------------" rel="noopener"> Irfan Alghani Khalid </a>，如何使用 Python 分析足球赛事数据:<a class="ae kv" rel="noopener" target="_blank" href="/how-to-analyze-football-event-data-using-python-2f4070d551ff">https://towards Data science . com/How-to-Analyze-Football-Event-Data-Using-Python-2f 4070d 551 ff</a></p><p id="4008" class="pw-post-body-paragraph mm mn iq ky b kz la jr mp lb lc ju mr ld nb mt mu lf nc mw mx lh nd mz na lj ij bi translated">[4]2020 年欧锦赛淘汰赛阶段:<a class="ae kv" href="https://en.wikipedia.org/wiki/UEFA_Euro_2020_knockout_phase" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/UEFA_Euro_2020_knockout_phase</a></p></div></div>    
</body>
</html>