<html>
<head>
<title>Clustering Algorithm for Customer Segmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">客户细分的聚类算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clustering-algorithm-for-customer-segmentation-e2d79e28cbc3?source=collection_archive---------2-----------------------#2021-07-04">https://towardsdatascience.com/clustering-algorithm-for-customer-segmentation-e2d79e28cbc3?source=collection_archive---------2-----------------------#2021-07-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2057" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">K-均值聚类的逐步指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5b5de0f3c58c4c8dea0760d7fe6d107d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xCKGM7tUzoR53oFv4yTPWA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">聚类分析信息图(图片作者来自<a class="ae ky" href="https://www.visual-design.net/post/clustering-algorithm-for-customer-segmentation" rel="noopener ugc nofollow" target="_blank">网站</a></p></figure><h1 id="0872" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是聚类算法？</h1><p id="d82e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">在商业环境中:</strong>聚类算法是一种辅助客户细分的技术，客户细分是将相似的客户归类到同一细分市场的过程。聚类算法有助于从静态人口统计和动态行为两方面更好地了解客户。具有相似特征的客户通常以相似的方式与企业互动，因此企业可以通过为每个细分市场创建定制的营销策略来受益于这种技术。</p><p id="871d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">在数据科学上下文中:</strong>聚类算法是一种无监督的机器学习算法，它发现密切相关的数据点组。监督算法和非监督算法之间的根本区别在于:</p><ul class=""><li id="ad12" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">监督算法:它需要将数据集划分为训练集和测试集，算法基于训练数据集的输出/标签进行学习，并将其推广到未观察到的数据。例如，决策树、回归、神经网络。</li><li id="c4ab" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">无监督算法:当数据集中没有任何已定义的输出/标签时，它用于发现隐藏模式。例如，聚类、关联规则挖掘、降维。</li></ul><p id="82c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这里，我收集了各种ML算法的实用指南。</p><div class="ng nh gp gr ni"><div role="button" tabindex="0" class="ab bv gv cb fp nj nk bn nl ks ex"><div class="nm l"><div class="ab q"><div class="l di"><img alt="Destin Gong" class="l de bw nn no fe" src="../Images/dcd4375055f8aa7602b1433a60ad5ca3.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*_qYYfgLTcvZF3zhHO0yVdA@2x.jpeg"/><div class="fb bw l nn no fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://destingong.medium.com/?source=post_page-----e2d79e28cbc3--------------------------------" rel="noopener follow" target="_top">德斯坦贡</a></p></div></div><div class="nr ns gw l"><h2 class="bd iu wd ms fp we fr fs pz fu fw is bi translated">机器学习实用指南</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi wf au wg wh wi sw wj an eh ei wk wl wm el em eo de bk ep" href="https://destingong.medium.com/list/practical-guides-to-machine-learning-a877c2a39884?source=post_page-----e2d79e28cbc3--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="wn l fo"><span class="bd b dl z dk">10 stories</span></div></div></div><div class="oe dh of fp ab og fo di"><div class="di nw bv nx ny"><div class="dh l"><img alt="Principal Component Analysis for ML" class="dh" src="../Images/1edea120a42bd7dc8ab4a4fcdd5b822d.png" width="194" height="194" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*swd_PY6vTCyPnsgBYoFZfA.png"/></div></div><div class="di nw bv nz oa ob"><div class="dh l"><img alt="Time Series Analysis" class="dh" src="../Images/fda8795039b423777fc8e9d8c0dc0d07.png" width="194" height="194" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*8sSAHftNwd_RNJ3k4VA0pA.png"/></div></div><div class="di bv oc od ob"><div class="dh l"><img alt="deep learning cheatsheet for beginner" class="dh" src="../Images/b2a4e3806c454a795ddfae0b02828b30.png" width="194" height="194" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*uNyD4yNMH-DnOel1wzxOOA.png"/></div></div></div></div></div><h1 id="352d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">为聚类准备数据</h1><p id="a47a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在概述了什么是集群之后，让我们更深入地研究一个实际的客户数据示例。我用的是Kaggle数据集“<a class="ae ky" href="https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python" rel="noopener ugc nofollow" target="_blank">商城客户细分数据</a>”，数据集中有五个字段，<em class="ol"> ID，年龄，性别，收入，支出分数</em>。商场最关心的是顾客的消费分数，因此本练习的目标是在领域<em class="ol">消费分数</em>中找到隐藏的聚类。</p><h2 id="fd1f" class="om la it bd lb on oo dn lf op oq dp lj ma or os ll me ot ou ln mi ov ow lp ox bi translated">1.加载和预览数据</h2><p id="4a51" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用describe()加载数据集并汇总列统计信息。</p><pre class="kj kk kl km gt oy oz pa pb aw ok bi"><span id="ccce" class="om la it oz b gy pc pd l pe pf">import pandas as pd  <br/>import numpy as np  <br/>import seaborn as sns  <br/>import matplotlib.pyplot as plt  <br/>from pandas.api.types import is_string_dtype, is_numeric_dtype    </span><span id="28f1" class="om la it oz b gy pg pd l pe pf">df = pd.read_csv("../input/customer-segmentation-tutorial-in-python/Mall_Customers.csv")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/01b3492e47960d819f58247173504c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LeMF4pofKZsQPFHgHZjCnw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">描述数据集</p></figure><p id="2823" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">检查每个字段的分布:对分类变量使用条形图，对数值变量使用直方图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/83b3a2a7bac267760a2aa6cc8105138d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1yMZNoxMoVHP7Bt-eUHFXA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">单变量分析(图片由作者提供)</p></figure><div class="kj kk kl km gt ab cb"><figure class="pj kn pk pl pm pn po paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/915d720b6bea05368ca5ce36992371c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*5FxyGKTNRbVEcwIuBM02sA.png"/></div></figure><figure class="pj kn pp pl pm pn po paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/856dd9ae559becde6d0d373297c80bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*aUXqok2RXrhO66cJ288kWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk pq di pr ps translated">数据分布(图片由作者提供)</p></figure></div><p id="1ecf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您想了解更多关于数据可视化和EDA的细节，请查看这两篇文章。</p><div class="ng nh gp gr ni pt"><a rel="noopener follow" target="_blank" href="/feature-selection-and-eda-in-python-c6c4eb1058a3"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd iu gy z fp py fr fs pz fu fw is bi translated">机器学习中的特征选择和EDA</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">如何使用数据可视化来指导特征选择</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="qd l qe qf qg qc qh ks pt"/></div></div></a></div><div class="ng nh gp gr ni pt"><a rel="noopener follow" target="_blank" href="/semi-automated-exploratory-data-analysis-eda-in-python-7f96042c9809"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd iu gy z fp py fr fs pz fu fw is bi translated">Python中的半自动探索性数据分析(EDA)</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">一键式全面数据探索流程</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="qi l qe qf qg qc qh ks pt"/></div></div></a></div><h2 id="5445" class="om la it bd lb on oo dn lf op oq dp lj ma or os ll me ot ou ln mi ov ow lp ox bi translated">2.数据预处理</h2><p id="73fd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">既然我们已经定义了目标并对数据有了更好的理解，我们需要预处理数据以满足模型需求。在这个例子中，我选择K均值聚类作为主要算法，原因将在后面解释。</p><p id="8fdb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">标准的k均值算法不能直接应用于分类数据。更具体地说，分类变量(例如，本例中的性别)的搜索空间是离散的(男性或女性)，因此不能直接与连续空间组合并以相同方式测量距离。因此，我丢弃了“性别”字段和“客户ID”字段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qj"><img src="../Images/f7a0b4f5429e37f48795c3f064fcadbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LRBW2T_p2YSBk5dT4zj2Q.png"/></div></div></figure><p id="ce68" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于K表示基于欧几里得距离解释数据点之间的接近程度，因此将所有维度协调到一个标准尺度中是很重要的。应该选择适当的数据转换类型，以便与数据的分布保持一致。来自Google 的这篇文章提供了集群中数据转换的一般指南。</p><p id="1425" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">总而言之:</p><ul class=""><li id="1482" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">如果正态分布→归一化</li><li id="0a51" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">如果幂律分布→对数变换</li><li id="f97f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">如果数据不符合任何分布→分位数</li></ul><p id="48ad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从前面的单变量分析中，我们可以看到这些变量既不符合正态分布也不符合法律分布。因此，我使用MinMaxScaler将数据范围缩小到0到1之间，同时保持分布形状。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qk"><img src="../Images/471dbc57686ae2580f36d6dea27bf92b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*phnFJo00k2jYetZMku_Dcg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ql"><img src="../Images/1b2ec75bbe33b65d97e5e9c33517e45f.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*mdjsSoEEoYt8WMJjlqSdUQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据转换(图片由作者提供)</p></figure><h2 id="1684" class="om la it bd lb on oo dn lf op oq dp lj ma or os ll me ot ou ln mi ov ow lp ox bi translated">3.电子设计自动化(Electronic Design Automation)</h2><p id="84b2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">探索性数据分析提供了视觉线索，表明当将多个变量组合在一起时，是否有可能形成有洞察力的集群。这也是必不可少的一步，因为选择合适的聚类算法依赖于聚类的形状。一些基于中心的算法(例如K均值)更适用于球状簇，并且它们倾向于将线性簇分开。而基于密度的算法(例如DBSCAN)更适合具有不规则形状和大量噪声的聚类。</p><p id="7c00" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我以下面的方式形象化了这三个领域。</p><p id="1f91" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> 2D散点图</strong></p><ul class=""><li id="46dc" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">年龄与年收入</li><li id="b0a5" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">年收入与支出得分</li><li id="955b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">年龄与支出收入</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qm"><img src="../Images/8ff4c81f8455813dea509dc40430b399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipJl_uj1k_S7oylDgY3FqQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">2D散点图(图片由作者提供)</p></figure><p id="6cad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">三维散点图:</strong></p><ul class=""><li id="2716" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">年龄与年收入和支出得分</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qn"><img src="../Images/b0f1f8b0f81f125bee78e48a61c46aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-SRU2uk1SC89mNz3uwhpQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qo"><img src="../Images/573c7425f45b0a8d137288f28d7fd96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AUnZWG3N7GgdZBAD01Qb4w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">3D散点图(图片由作者提供)</p></figure><p id="07e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这种情况下，很明显,“年收入与支出分数”的图表生成了一些基于中心的聚类。因此，我将使用K均值算法进行进一步的探索。</p><h1 id="0e5e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">k表示聚类</h1><h2 id="aaf5" class="om la it bd lb on oo dn lf op oq dp lj ma or os ll me ot ou ln mi ov ow lp ox bi translated">1.K均值聚类是如何工作的？</h2><p id="fe1c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">k表示聚类是一种基于<strong class="lt iu">中心的聚类算法</strong>，这意味着它根据接近度或距离将数据点分配给聚类，遵循以下程序:</p><ol class=""><li id="1f83" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm qp my mz na bi translated"><strong class="lt iu">指定星团的数量“K”。</strong></li><li id="f811" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated"><strong class="lt iu">初始化K个随机质心，给每个簇分配一个质心:</strong>质心是每个簇的中心。开始时随机选择k个数据点作为质心，其他数据点的聚类标记随后相对于它们定义。因此，不同的初始质心分配可能导致不同的集群形成。</li><li id="d7e7" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated"><strong class="lt iu">通过将数据点分配到最近的质心来形成K个聚类:</strong>最近的质心通常由最小的欧几里德距离来定义，但根据使用情况，它也可以是相关或余弦。</li><li id="e43d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated"><strong class="lt iu">重新计算每个聚类的质心</strong>:在所有数据点被分配到一个聚类后，对于每个聚类，我们重新计算属于该聚类的所有数据点的平均值，并将其定义为新的质心。</li><li id="508e" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated"><strong class="lt iu">当质心不再变化时达到收敛:</strong>重复步骤2-4，直到达到停止准则，即质心不再变化或达到最大迭代次数。</li></ol><p id="6875" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该过程还确定了K均值算法具有将点聚类成具有相似大小的圆形的限制，并且它还严重依赖于预定义的数字K</p><h2 id="10e1" class="om la it bd lb on oo dn lf op oq dp lj ma or os ll me ot ou ln mi ov ow lp ox bi translated">2.如何建立K均值聚类模型？</h2><p id="06d3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在让我们仔细看看如何使用python scikit learn实现它。</p><p id="6b2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我定义了一个<em class="ol"> KMeans_Algorithm </em>函数，它将数据集和聚类数作为参数传递。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qq"><img src="../Images/7b6a32068e0c9a0f05a960cc931ff9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJFIe32eXCKr5LKInZM4zA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">定义KMeans_Algorithm函数(图片由作者提供)</p></figure><p id="6371" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该函数从sklearn库中调用<em class="ol"> KMeans() </em>并指定一些关键参数:</p><ul class=""><li id="f539" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><strong class="lt iu"> <em class="ol"> n_clusters: </em> </strong>集群的数量</li><li id="f578" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"><em class="ol">init:</em></strong><em class="ol"/>它控制初始化技术，我选择了“k-means++”来以一种聪明的方式选择初始质心以加速收敛</li><li id="f2c5" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> <em class="ol"> max_iter: </em> </strong>指定每次运行允许的最大迭代次数</li><li id="0845" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> <em class="ol">算法</em> </strong> <em class="ol"> : </em>有几个选项可以选择，“auto”、“full”和“elkan”我选择“elkan”是因为它是一个K Means算法变体，使用三角形不等式使其更具时间效率。</li><li id="84fe" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"><em class="ol">random _ state:</em></strong>用一个整数来决定初始质心的随机生成</li></ul><p id="423c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">输出将生成以下属性和评估指标:</p><ul class=""><li id="48e1" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><strong class="lt iu"><em class="ol">cluster _ centres _:</em></strong>返回一个形心位置的数组</li><li id="97c3" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> <em class="ol">惯性_: </em> </strong>数据点到其最近质心的距离平方之和</li><li id="3ad6" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> <em class="ol">标签_: </em> </strong> <em class="ol"> </em>将聚类标签分配给每个数据点</li><li id="3717" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"><em class="ol">silhouette _ score:</em></strong>数据点到同一聚类中其他数据点之间的距离与最近邻聚类中的数据点进行比较</li></ul><p id="e5c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个例子中，我主要对关于“支出分数”的聚类的形成感兴趣。因此，我使用了数据集X1，X2，X3，如下所述，作为模型的输入。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qr"><img src="../Images/2b7e7f747eb67d43247b7a376a8defa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x9xs2SS_gce2kUcp9mjf4A.png"/></div></div></figure><p id="b6e9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，我们不再需要为无监督模型的训练和测试划分数据集。</p><p id="fc40" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">年龄与支出得分</strong></p><p id="188c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面的代码使用了数据集X1——按比例调整的年龄与按比例调整的支出分数，并直观地显示了随着分类数从2增加到10，分类是如何变化的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qs"><img src="../Images/e93009aedf1d0e9acc8264c70a6cbec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_pUuEcDFB_TpLYMSQmRsEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">年龄与花费分数的k均值(图片由作者提供)</p></figure><p id="9d5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">代码的第一部分遍历多个集群，并为每个集群生成一个散点图，红色方块表示质心。如下所示，当指定的“k”值改变时，聚类也改变。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qt"><img src="../Images/67ccd948a593f2df21572208e2032a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bkdLRT-y5-2svN8fZK61LA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X1的聚类结果(图片由作者提供)</p></figure><p id="ac71" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">之后，我基于两个指标评估模型性能:<strong class="lt iu">惯性和轮廓系数</strong>。</p><p id="8636" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于聚类是一种无监督算法，我们不能根据预测结果和实际结果之间的差异直接评估模型质量。因此，评估应基于<a class="ae ky" href="https://www.geeksforgeeks.org/ml-intercluster-and-intracluster-distance/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">最小化类内距离同时最大化类间距离</strong>的原则。</a>基于这一原理，有两种评价方法可以确定最佳聚类数。</p><p id="04ed" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> 1)利用惯性的肘法:</strong></p><p id="2343" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">惯性测量样本到其最近聚类质心的平方距离之和。对于相同数量的聚类，惯量越小表示聚类越好。肘方法通过查看下图的转折点(“肘”点)来确定最佳聚类数，在本例中为6。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qu"><img src="../Images/1e0ba3c136a12700dc24f9136a4a7637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONfQtirM6DRX8n3JicDd3Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">肘法(图片由作者提供)</p></figure><p id="4082" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> 2)轮廓系数:</strong></p><p id="0749" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是让它显得令人生畏的剪影系数公式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/ec8c806d1a0993b96268469cae4a7ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*AaxgzXD_88iEc9IU.png"/></div></figure><p id="1743" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是基本上它转化为最小化簇内距离，同时最大化簇间距离。<em class="ol"> a(i) </em>是数据点I到<strong class="lt iu">同一聚类中其他数据点的平均距离，</strong>和<em class="ol"> b(i) </em>是数据点I到<strong class="lt iu">最近邻聚类中所有点的平均距离。</strong>目标是最小化<em class="ol"> a(i) </em>并最大化<em class="ol"> b(i) </em>，因此当<em class="ol"> </em>系数越接近1，表示聚类越好。在本例中，2和6都显示了分数的峰值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qw"><img src="../Images/a834d9121bd01f2bfefbe2888b7e1145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f84tND3rRoO8_VHyI6QwMQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">轮廓系数(图片由作者提供)</p></figure><p id="c2c8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">基于这两个指标的结果，在绘制“年龄”与“支出分数”的对比图时，6很可能是最佳的聚类数。然而，无论是从分数还是从视觉效果来看，说年龄和花费分数一起形成有洞察力的聚类仍然不足以令人信服。</p><p id="6b9d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">年收入与支出得分</strong></p><p id="a6fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从EDA过程中，我们观察到图表中有几个不同的集群。现在，让我们仔细看看该模型是否能如预期的那样将客户划分为不同的细分市场。该代码与上面的代码类似，但只是将输入数据集更改为X2-按比例缩放的年收入与按比例缩放的支出分数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qx"><img src="../Images/6c54d6c252c72927b6fd70f3a25518b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pTjdtSruWMi7IinJ2iRrzA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qy"><img src="../Images/bab399287ea5fa0a6fb79d67ad2c89d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fv59Cg7s3evdlpr4kW5wlQ.png"/></div></div></figure><div class="kj kk kl km gt ab cb"><figure class="pj kn qz pl pm pn po paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/c429bbff204a0578734691eddbed226d.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*Pb1zS0dUs3R8_J9AqxUQzA.png"/></div></figure><figure class="pj kn ra pl pm pn po paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/db29ef8dd6c7e76d95a541646f0000a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*dqBcl8ngex3sAtbFUdFjzA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk rb di rc ps translated">年收入与支出得分的平均值(图片由作者提供)</p></figure></div><p id="0497" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">很明显，当聚类的数量等于5时，存在相当好的分割，并且在散点图中也清楚地示出了这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rd"><img src="../Images/892cb997235addafc844f07bf68dbde3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Hs4q7cMw5BfP5mrKuPDbQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">年收入与支出分数，含5个聚类</p></figure><p id="3086" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">年龄对比年收入对比支出得分</strong></p><p id="be27" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你感兴趣，我们还可以进一步研究这三个领域是如何相互作用的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi re"><img src="../Images/17982f9e9260158c6abcda4897822e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AHrnk1XtacflvRL5Yz_YOA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rf"><img src="../Images/20526f50fb47ebf676ccdaccc273fd60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Od8xcKmSHKjl3BC2RivFUQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi rg"><img src="../Images/5406de91585fea1225c7e43f85244e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qmKcdz974zN8R_GcW6potQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">年龄、年收入和支出得分的平均值(图片由作者提供)</p></figure><p id="1ec8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然，就可视化和度量值而言，没有形成任何突出的聚类的迹象，但无监督学习是关于发现和探索隐藏的努力。尽管如此，做进一步的调查还是值得的。</p><h1 id="98ec" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.如何应用于客户细分？</h1><p id="059d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">毕竟，聚类模型的目标是为客户细分带来洞察力。在本练习中，根据两个方面将客户分为5类:支出分数与年收入，这最有利于制定量身定制的营销策略。</p><p id="0245" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如下所示，客户可以分为五类:</p><ol class=""><li id="d506" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm qp my mz na bi translated">高年收入(7万美元以上)和高支出分数(60分以上)</li><li id="c3b3" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated">高年收入(7万美元以上)和低支出分数(40分以下)</li><li id="a4d5" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated">低年收入(低于4万美元)和高支出分数(高于60)</li><li id="b7ec" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated">低年收入(低于4万美元)和低支出分数(低于40)</li><li id="7f8b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated">平均年收入(介于4万美元和7万美元之间)和平均支出得分(介于40和60之间)</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi rh"><img src="../Images/d4d3bb4107dd98337e159807f366302e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*7U76qkmAP66piBVAwmJE_Q.png"/></div></figure><p id="d5dd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">基于每个群体的不同特征，企业可以不同地接近每个客户群体。第一类和第三类客户产生的收入最多，他们需要使用营销策略来留住客户，如忠诚度计划或通过时事通讯提供折扣。另一方面，客户获取策略更适合第二组和第四组。这可以是根据他们的收入水平量身定制的营销活动，因为高收入群体和低收入群体对产品有不同的偏好。</p><h1 id="ab2b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">更进一步</h1><p id="374c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用K均值聚类有几个局限性，值得注意。当集群的大小和密度不同时，或者如果有任何显著的异常值，它就不能很好地工作。因此，当遇到类似这样的情况时，我们需要考虑其他聚类算法。例如，DBSCAN对噪声和异常值有更强的抵抗力，并且层次聚类不假设任何特定数量的聚类。如果你想了解更多关于与DBSCAN的比较，请查看我的<a class="ae ky" href="https://www.kaggle.com/destingong/customer-segmentation-using-clustering-algorithm" rel="noopener ugc nofollow" target="_blank"> Kaggle笔记本</a>。</p><p id="4cfb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">希望你喜欢我的文章:)。如果你想阅读更多我关于媒体的文章，请使用这个附属链接(【https://destingong.medium.com/membership】T2)注册媒体会员。</p></div><div class="ab cl ri rj hx rk" role="separator"><span class="rl bw bk rm rn ro"/><span class="rl bw bk rm rn ro"/><span class="rl bw bk rm rn"/></div><div class="im in io ip iq"><h1 id="6625" class="kz la it bd lb lc rp le lf lg rq li lj jz rr ka ll kc rs kd ln kf rt kg lp lq bi translated">带回家的信息</h1><p id="d62f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">本文介绍了聚类算法，特别是K表示聚类，以及我们如何在业务环境中应用它来帮助客户细分。一些关键要点:</p><ol class=""><li id="88e1" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm qp my mz na bi translated">为聚类分析准备数据:数据转换和探索性数据分析</li><li id="d6df" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated">使用scikit learn实现k均值聚类算法</li><li id="979a" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm qp my mz na bi translated">使用惯性和轮廓分数的聚类算法评估</li></ol><h2 id="7cee" class="om la it bd lb on oo dn lf op oq dp lj ma or os ll me ot ou ln mi ov ow lp ox bi translated">更多这样的文章</h2><div class="ng nh gp gr ni pt"><a rel="noopener follow" target="_blank" href="/semi-automated-exploratory-data-analysis-eda-in-python-7f96042c9809"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd iu gy z fp py fr fs pz fu fw is bi translated">Python中的半自动探索性数据分析(EDA)</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">一键式全面数据探索流程</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="qi l qe qf qg qc qh ks pt"/></div></div></a></div><div class="ng nh gp gr ni pt"><a rel="noopener follow" target="_blank" href="/simple-logistic-regression-using-python-scikit-learn-86bf984f61f1"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd iu gy z fp py fr fs pz fu fw is bi translated">Python中的简单逻辑回归</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">从数据预处理到模型评估的逐步指南</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="ru l qe qf qg qc qh ks pt"/></div></div></a></div><div class="ng nh gp gr ni pt"><a href="https://medium.com/analytics-vidhya/top-15-websites-for-data-scientists-to-follow-in-2021-67352092c54d" rel="noopener follow" target="_blank"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd iu gy z fp py fr fs pz fu fw is bi translated">2021年数据科学家关注的15大网站</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">启发学习的网站和博客</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">medium.com</p></div></div><div class="qc l"><div class="rv l qe qf qg qc qh ks pt"/></div></div></a></div></div><div class="ab cl ri rj hx rk" role="separator"><span class="rl bw bk rm rn ro"/><span class="rl bw bk rm rn ro"/><span class="rl bw bk rm rn"/></div><div class="im in io ip iq"><p id="0dd0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ol">原载于2021年7月4日https://www.visual-design.net</em><a class="ae ky" href="https://www.visual-design.net/post/semi-automated-exploratory-data-analysis-process-in-python" rel="noopener ugc nofollow" target="_blank"><em class="ol"/></a><em class="ol">。</em></p></div></div>    
</body>
</html>