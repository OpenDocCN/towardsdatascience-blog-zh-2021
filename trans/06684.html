<html>
<head>
<title>Transfer Learning with VGG16 and Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用VGG16和Keras进行迁移学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/transfer-learning-with-vgg16-and-keras-50ea161580b4?source=collection_archive---------0-----------------------#2021-06-16">https://towardsdatascience.com/transfer-learning-with-vgg16-and-keras-50ea161580b4?source=collection_archive---------0-----------------------#2021-06-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="566f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用最先进的训练神经网络来解决你的图像分类问题</h2></div><p id="b2d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文的主要目标是用代码和例子演示如何使用一个已经训练好的CNN(卷积神经网络)来解决你的具体问题。</p><p id="82ab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">卷积网络对于图像问题非常有用，但是，如果你使用一个大的架构，并且没有GPU，那么卷积网络的计算成本会很高。为此，我们有两种解决方案:</p><h2 id="fab7" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">绘图处理器</h2><p id="5b54" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">GPU对训练神经网络更有效，但它们在普通计算机上并不常见。所以这就是<strong class="kh ir"/><a class="ae lz" href="https://research.google.com/colaboratory/" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="ma">Google colab</em></strong></a>来拯救我们的地方。他们提供GPU高达16 GB内存的虚拟机，最棒的是:<strong class="kh ir">它是免费的</strong>。</p><p id="9206" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，即使有了这些升级的规格，你仍然可以在训练一个全新的CNN时挣扎。这就是迁移学习可以帮助你用更少的计算获得更好的结果的地方。</p><h2 id="8174" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">迁移学习</h2><p id="fe75" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">那么什么是迁移学习呢？</p><p id="e22f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了更好地解释这一点，我们必须首先了解CNN的基本架构。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/4cf9ac9270cc1ce85921c2ff017eab7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rWkXtlUfhmIdIEZLAnoZ0g.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><p id="8df7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CNN可以分为两个主要部分:特征学习和分类。</p><p id="6b76" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">特征学习</strong></p><p id="c62f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这一部分中，神经网络的主要目标是在图像的像素中找到可用于识别分类目标的模式。这发生在网络的卷积层，专门处理手头问题的那些模式。</p><p id="13de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我不会深入探究这背后的工作原理，但如果你想更深入地挖掘，我强烈推荐这篇文章  和<strong class="kh ir"><em class="ma"/></strong><a class="ae lz" href="https://youtu.be/HGwBXDKFk9I" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="ma">这个令人惊叹的视频</em> </strong> </a> <strong class="kh ir"> <em class="ma">。</em> </strong></p><p id="c4f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">分类</strong></p><p id="b3c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们想使用这些模式将我们的图像分类到正确的标签。网络的这一部分正是做这项工作的，它使用来自前几层的输入，在新图像中找到与你的匹配模式最匹配的类别。</p><p id="cf90" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">定义</strong></p><p id="4e21" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，现在我们可以在我们的上下文中定义迁移学习，即利用经过训练的CNN的特征学习层来分类一个不同于它为之创建的问题。</p><p id="4527" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">换句话说，我们使用神经网络发现对给定问题的图像分类有用的模式来分类完全不同的问题，而无需重新训练网络的这一部分。</p><p id="0cef" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我将演示如何使用Keras实现这一点，并证明在很多情况下，这比训练一个新的网络效果更好。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="12ea" class="my lc iq bd ld mz na nb lg nc nd ne lj jw nf jx lm jz ng ka lp kc nh kd ls ni bi translated">使用Keras进行迁移学习</h1><p id="a01b" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在这个演示中，我将使用一个著名的神经网络VGG16。这是它的架构:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nj"><img src="../Images/58ea35edb31156cca06ed49631f88120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MTuQrB_uw_xr2jzBqg2GUw.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><p id="d5b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该网络在ImageNet数据集上进行训练，该数据集包含属于1000个不同标签的超过1400万个高分辨率图像。</p><p id="36d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想更深入地研究这个特定的模型，你可以研究一下<a class="ae lz" href="https://arxiv.org/abs/1505.06798" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="ma">这篇论文。</em> </strong> </a></p><h2 id="352c" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">资料组</h2><p id="b57c" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在这个演示中，我将使用<a class="ae lz" href="https://www.tensorflow.org/datasets/catalog/tf_flowers" rel="noopener ugc nofollow" target="_blank"> tf_flowers数据集</a>。只是提醒一下:VGG16网络没有被训练来对不同种类的花进行分类。</p><p id="2a45" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据看起来是这样的:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/7783c9339d0d95f56ed99c28632232b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5IUj-C5CSCAad4ptrH1ddA.png"/></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><p id="6d46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后…</p><h2 id="47a8" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">代码</h2><p id="bf32" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">首先，我们必须从TensorFlow加载数据集:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="900d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以加载VGG16模型了。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="c005" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<em class="ma">Include _ top =</em><strong class="kh ir"><em class="ma">False</em></strong>移除在ImageNet数据集上训练的分类层，并将模型设置为不可训练。此外，我们使用VGG16中的preprocess_input函数来规范化输入数据。</p><p id="5e13" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以运行这段代码来检查模型摘要。</p><pre class="mc md me mf gt nn no np nq aw nr bi"><span id="8839" class="lb lc iq no b gy ns nt l nu nv">base_model.summary()</span></pre><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nw"><img src="../Images/0b1fadf5044bdeffb031dbe615931845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygjmUShTBQvUkybf6woSSg.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><p id="3f8a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">两个要点:该模型有超过1400万个训练参数，并以maxpooling层结束，该层属于网络的特征学习部分。</p><p id="b76c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们为我们的具体问题添加最后几层。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="1ea0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并编译和拟合模型。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="563b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在测试集上评估这个模型，我们得到了96%的准确率！</p><p id="9229" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样！</p><p id="9f98" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这么简单。很漂亮，对吧？</p><p id="fbd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们如何在世界上找到一些模式，可以用来识别完全不同的事物。</p><p id="3e13" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想查看完整的代码和一个jupyter笔记本，这里有GitHubrepo:</p><div class="nx ny gp gr nz oa"><a href="https://github.com/gabrielcassimiro17/object-detection" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">gabrielcassimiro 17/对象检测</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">在GitHub上创建一个帐户，为gabrielcassimiro 17/对象检测开发做出贡献。</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">github.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ml oa"/></div></div></a></div></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="ff38" class="my lc iq bd ld mz na nb lg nc nd ne lj jw nf jx lm jz ng ka lp kc nh kd ls ni bi translated">额外:与手工制作的模型相比</h1><p id="edbc" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">为了确保这种方法在计算资源和精度上都更好，我为这个问题创建了一个手工制作的简单模型。</p><p id="bc03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是代码:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="1828" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用相同的最终层和拟合参数来比较卷积的影响。</p><p id="cb74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">手工模型的准确率为83%。比我们从VGG16型号获得的96%要差得多。</p></div></div>    
</body>
</html>