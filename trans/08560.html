<html>
<head>
<title>Make a rock-solid ML model using Sklearn Pipeline!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Sklearn管道做一个坚如磐石的ML模型！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/make-a-rock-solid-ml-model-using-sklearn-pipeline-926f2ccf4706?source=collection_archive---------15-----------------------#2021-08-07">https://towardsdatascience.com/make-a-rock-solid-ml-model-using-sklearn-pipeline-926f2ccf4706?source=collection_archive---------15-----------------------#2021-08-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ae33" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么、如何以及何时使用Sklearn的管道！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7cd9c439780982cff791ef4de01611e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kaAOWKZZu9Fmv2XB"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="37df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你正在建立一个预测模型，并在没有任何预处理步骤(如清理数据、输入缺失值)的情况下达到预期的精度，那么你恰好是世界上最幸运的人！但是，除非您执行大量的转换和预处理，否则今天的大多数数据都不会说话。涉及到几个步骤，从预处理、转换到建模。当将这些模型投入生产时，我们必须构建一个可以无中断运行的健壮流程，这一点很重要。这就是Sklearn Pipeline和其他支持组件发挥作用的地方。</p><h2 id="d315" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">为什么要用Sklearn管道？</h2><p id="6589" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我会旋转Jupiter笔记本，开始探索我的数据，创新新功能，执行预处理，如清理、缩放等。在输入模型之前。然而，我知道在Jupyter或类似的ide中这样做可能会变得一团糟。在Jupyter笔记本中创建一个自动化路径比按Shift+Enter更有意义。使用Sklearn Pipeline是一种方便的方法，可以通过预处理步骤来执行这些步骤，并确保代码的可再现性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f6ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果企业每天都依赖机器学习模型来做出决策，生产模型的不稳定和不一致的结果会对企业产生重大影响。</p><blockquote class="mv mw mx"><p id="3348" class="kz la my lb b lc ld ju le lf lg jx lh mz lj lk ll na ln lo lp nb lr ls lt lu im bi translated">我不是“Jupyter haters粉丝俱乐部”的成员；我自己构建了Jupyter Notebook中的所有内容，然后将其转换为集成Sklearn管道的Python脚本！</p></blockquote></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="a667" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">一般Sklearn管道工作流程:</h2><p id="082b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果我们看一个端到端机器学习管道的一般化图表，它看起来会像下面这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/0f1878ac747515419c190576c7864719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3CUgNaoTUG3eg_BOFkN-YA.jpeg"/></div></div></figure><p id="be79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦提供了数据，</p><ul class=""><li id="ce78" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated">我们做插补——用平均值、中间值等填充缺失值。</li><li id="1c69" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">接下来是一些特性工程，比如为缺失值创建一个标志，为所提供的分类特性创建groupby均值，等等。可以做到。</li><li id="a5b4" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">可以使用缩放/归一化来帮助算法更快地收敛，并且可以使用PCA来去除一些噪声。</li><li id="4cb1" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">最后，对数据进行估计。你可以使用<em class="my">管道</em>来生成对未知数据的预测。</li></ul><p id="6d4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Sklearn的<em class="my">管道</em> <strong class="lb iu"> </strong>集成了上面提到的所有组件，并编排了交付模型的流程。如果我们想一想，不同的乐高积木如何有助于实现你的最终产品，不同的积木在<em class="my">管道</em>中和谐地组合在一起，使其发挥作用！让我们一起来简单了解一下几种常用的变压器:</p><ul class=""><li id="475d" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><strong class="lb iu"> Pipeline: </strong>它是一系列步骤的集合，包括帮助机器学习工作流程自动化的最终估计器。上图是<em class="my">管道</em>的一个例子。</li><li id="5617" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu">特征联合:</strong>数据流不是线性的，需要多个东西一起预处理。它并行执行所有函数，并将最终结果粘贴在一起。当您想要对一列应用不同的转换时，请使用它。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/7cdedea180d293be7732017056feec5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxKySca-al_YecoG5ucvIg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者创造的形象</p></figure><ul class=""><li id="3d82" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><strong class="lb iu"> Column Transformer: </strong>帮助组合应用于不同列的不同类型的转换，并将它们连接起来。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/e1410de5a5fed4b5309e74ef15b8d1dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5owwVzISYtBTNzp-e-2zzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者创造的形象</p></figure><ul class=""><li id="cfcc" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><strong class="lb iu"> make_column_selector: </strong>这个Lego块有助于根据数据类型选择多个列。Regex也可以用于选择列。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/243d70c36d4258930081ead7934031bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nY1h6d7dNniLt67QSH3RzA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者创造的形象</p></figure><ul class=""><li id="5c05" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><strong class="lb iu">简单估算器:</strong>该转换器可用于用平均值、中值、最频繁值或常数来填充缺失值。</li><li id="04dc" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu"> BaseEstimator，TransformerMixin: </strong>您可以使用这些基类来创建您的转换器。TransformerMixin主要用于实现一个转换方法。</li><li id="ed2b" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu"> FunctionalTransformer: </strong>这有助于将用户定义的函数转换成易于使用并与<em class="my">管道</em>集成的函数。</li></ul></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="b740" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">简短示例:</h2><p id="f3da" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">让我们在乳腺癌数据集上做一个小的实现，看看使用<em class="my">管道</em>时会有什么不同。</p><p id="4b1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">正常ML代码:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob mu l"/></div></figure><p id="4b3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">实施管道:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob mu l"/></div></figure><p id="3f7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们从上面的代码中看到的，有几件事很突出:</p><ul class=""><li id="5c16" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated">清洁和质量代码</li><li id="4177" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">易于复制</li><li id="55ae" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">裁员实践中的失业</li></ul></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="7113" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">一些优势:</h2><h2 id="7460" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">可读性和再现性</h2><ul class=""><li id="c36f" class="nk nl it lb b lc mo lf mp li oc lm od lq oe lu np nq nr ns bi translated">可读性是机器学习领域经常被忽视的一个方面。比起关注代码的质量，我们更重视取得成果。代码必须是任何用户/同事在他们的实践中容易想到的，并与你分享。</li><li id="ab9b" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">此外，重要的是，编写的代码在以相同的步骤反复运行时能够产生相同的结果。当在代码中进行小的调整以获得更好的ML模型而不干扰所有组件时，这非常有帮助。</li></ul><h2 id="516b" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">标准化的工作流程—减少数据泄露的机会</h2><ul class=""><li id="9ffe" class="nk nl it lb b lc mo lf mp li oc lm od lq oe lu np nq nr ns bi translated">当使用<em class="my">管道</em>拟合数据时，工作流程变得非常规范，发生数据泄露的机会也更少。数据泄漏是ML从业者在将模型投入生产时面临的最大障碍之一。</li></ul><h2 id="d385" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">出错时易于调试</h2><ul class=""><li id="fedb" class="nk nl it lb b lc mo lf mp li oc lm od lq oe lu np nq nr ns bi translated">您的管道可能会抛出错误或导致失败。在这种情况下，如果你的代码是干净有效的，那么找出问题的根源就变得更加容易了！</li></ul><h2 id="8bf0" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">可重用性</strong></h2><ul class=""><li id="3c2d" class="nk nl it lb b lc mo lf mp li oc lm od lq oe lu np nq nr ns bi translated">您可以根据新项目的要求，稍加调整，将已经建成的<em class="my">管道</em>移植到一个项目中。这提高了我的效率，帮助我专注于整个ML管道的不同部分。</li></ul><h2 id="e60d" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">更多应用</strong></h2><ul class=""><li id="08e3" class="nk nl it lb b lc mo lf mp li oc lm od lq oe lu np nq nr ns bi translated">我们可以结合管道使用网格搜索</li><li id="952d" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">使用像Dask这样的库将它们并行化。</li><li id="10fa" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">您可以使用多个估算器运行一个循环，并对每个估算器使用<em class="my">管道</em>。</li></ul><p id="9639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后但同样重要的是，Sklearn Pipeline应该真正集成，并成为工作流的重要组成部分。我已经构建了几个项目，并广泛使用了它们。它们的扩展或应用是无限的，如果使用，它们可以成为一个很好的工具！感谢您的宝贵时间！</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="4a6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://twitter.com/pratikkgandhi" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ky" href="https://www.linkedin.com/in/pratikkgandhi/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我。你也可以通过pratikkgandhi@gmail.com联系我</p></div></div>    
</body>
</html>