<html>
<head>
<title>SUM(A+B) VS SUM(A)+SUM(B)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">总和(A+B)与总和(A)+总和(B)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sum-a-b-vs-sum-a-sum-b-31fb094b786?source=collection_archive---------24-----------------------#2021-08-11">https://towardsdatascience.com/sum-a-b-vs-sum-a-sum-b-31fb094b786?source=collection_archive---------24-----------------------#2021-08-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="30e3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">粉碎SQL Bug！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4c7a9f71f1df4408eb9cf32b01a7e125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cd9j8-nwxGE_SoG2_Qxa6A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ekamelev?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">егоркамелев</a>通过Unsplash拍摄</p></figure><blockquote class="kz la lb"><p id="ecf7" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我需要你把去年的销售额加到今年的销售额上，然后把总数给我。—你工作的地方有很多人</p></blockquote><p id="111a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">从这篇文章的标题来看，这两个公式略有不同。这些相似的结构甚至可能在您工作的地方的SQL查询中很常见。让我们来看看这两者的区别，以及如何在未来避免一个微小的错误和大量的时间/信誉损失。</p><h1 id="a140" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">桌子</h1><p id="0069" class="pw-post-body-paragraph lc ld it lf b lg mu ju li lj mv jx ll lz mw lo lp ma mx ls lt mb my lw lx ly im bi translated">让我们看一下我们的小表，它有“sales_ly”和“sales_ty”列。在该数据中，商店5在今年开业，因此去年没有销售额:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/0f3fc9be142ca2e26c60c6b4689f8864.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*2Ydzfz3WFDHPB9c1RFL2yg.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</p></figure><p id="169a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">让我们来看看使用上面显示的每种技术对这些值求和时的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/c5113b539fc0e2ca332ffc493a8f9f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*Iv3ODIhdgqz-hjvnD_BZzA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</p></figure><p id="9b2b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们可以看到，' sales_ly' = 400而' sales_ty' = 500。检查检查。等一下，伙计！求和成单个值时，一个过程显示800？！？这是什么原始巫术？</p><p id="b29f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这和一个很久以前的朋友有关，他叫秩序行动。让我们想象一下正在发生的事情:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/c7799bbdd61f4102d990a2f91acaf9a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJQeEThNpT1AkoKjWGy45Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</p></figure><p id="2a68" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们的SUM(A + B)过程用蓝色突出显示。我们可以看到，这个过程的第一步是右边“总计”栏中显示的内部A + B。嗯，第5行总计有一个空值！这是因为像'+'和'-'这样的操作数不能处理空值。所以，100 + Null = Null。</p><p id="bba4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在，我们看看橙色的SUM(A) + SUM(B)朋友。这个过程从垂直方向开始，先对A求和，然后对B求和，然后水平移动，得出正确答案！</p><p id="8459" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><strong class="lf iu">解决方案1:总和(A) +总和(B) </strong></p><h1 id="5735" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">你可能已经注意到了我们的粉色惊喜嘉宾…</h1><p id="ba92" class="pw-post-body-paragraph lc ld it lf b lg mu ju li lj mv jx ll lz mw lo lp ma mx ls lt mb my lw lx ly im bi translated">在这种情况下，使用ISNULL()函数也很有帮助。这将把空值替换为0，然后使用“+”操作数将0与100相加。</p><p id="c43a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><strong class="lf iu">方案二:ISNULL( ) </strong></p><h1 id="c40e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">第三种解决方案，包括潜在缺陷</h1><p id="35ed" class="pw-post-body-paragraph lc ld it lf b lg mu ju li lj mv jx ll lz mw lo lp ma mx ls lt mb my lw lx ly im bi translated">说“用0替换所有的空值”是很容易的。这肯定会解决空值的问题，并且总和仍然有效。如果你使用平均值之类的东西，这可能会产生另一个错误。去年没有开业的第5家店将被包括在分母中，同时为分子贡献一个大鹅蛋。书呆子在桌子上！</p><p id="9969" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">正如在<a class="ae ky" href="https://medium.com/geekculture/in-data-theres-almost-never-a-magic-silver-bullet-6cf30a5c70b4?sk=3a221694f078282e755130d87ed2833b" rel="noopener">之前的一篇文章</a>中提到的，使用这个问题，你应该像看一场80年代的游戏秀一样阅读它，观众齐声尖叫:“什么……会……打破这个吗？！？，在提出已知问题的解决方案时非常有用。</p><p id="b0ea" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><strong class="lf iu">暂定解决方案3:用0替换表格中的所有空值</strong></p><h1 id="a0e9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">快速查看代码差异</strong></h1><p id="8d27" class="pw-post-body-paragraph lc ld it lf b lg mu ju li lj mv jx ll lz mw lo lp ma mx ls lt mb my lw lx ly im bi translated">让我们快速看一下执行聚合的代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/e90a8b3e5d69e50b5a070e12be92ed8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*Vxd5lw6-WCz9pNHgqQFKtg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</p></figure><h1 id="4dfd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">最后的想法</h1><p id="11a0" class="pw-post-body-paragraph lc ld it lf b lg mu ju li lj mv jx ll lz mw lo lp ma mx ls lt mb my lw lx ly im bi translated">我关注的一个共同趋势似乎是，在数据世界中有很多工具和技术。找出什么有效，为什么有效。想想什么会打破它。不要认为相同的方法或工具在不同的应用中会产生相同的结果。可用数据取决于用例。</p><p id="7deb" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">直到下一次，继续学习。</p></div></div>    
</body>
</html>