# 利用复杂网络改进机器学习方法

> 原文：[https://towardsdatascience.com/using-complex-networks-to-improve-machine-learning-methods-fe2c034f6de3?source=collection_archive---------22-----------------------#2021-10-26](https://towardsdatascience.com/using-complex-networks-to-improve-machine-learning-methods-fe2c034f6de3?source=collection_archive---------22-----------------------#2021-10-26)

## 使用高级数据分类算法来利用数据的拓扑特征

![](../Images/98e835adac456ab74c518b877dbb07b3.png)

艾莉娜·格鲁布尼亚克在 [Unsplash](https://unsplash.com/s/photos/network?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上的照片

数据科学为数据科学家工具箱提供了许多不同的范例，如监督学习、非监督学习、时间序列、强化学习等等。要精通所有这些范例是不可能的，但是，对每一个范例都有一个基本的和可行的知识可以帮助我们更好地解决问题。

最近一个为数据科学家提供有洞察力的工具的领域是复杂网络，这是一个专注于研究基于实体之间关系的复杂现象的领域。

在这篇文章中，我将告诉你一些关于复杂网络的知识，以及如何将它们与机器学习算法结合使用，以提高使用 sknet 库进行预测的性能。

# 复杂网络

让我们从定义什么是复杂网络开始:一个被称为节点的实体的集合，这些节点通过表示某种关系的边相互连接。

如果你在想:这是一个图表！嗯，你是对的，大多数复杂的网络可以被认为是一个图。然而，复杂网络通常会扩展到数千或数百万个节点和边，这使得它们很难用标准的图算法进行分析。

复杂网络和数据科学领域之间有很多协同作用，因为我们有工具来尝试和理解网络是如何构建的，以及我们可以从整个系统中预期什么行为。因此，如果您可以将数据建模为一个复杂的网络，您就有了一套新的工具来应用它。

事实上，有许多机器学习算法可以应用于复杂的网络，也有一些算法可以利用网络信息进行预测。尽管这个交叉点相对较新，但我们已经可以对它进行一些尝试。

因此，为了开始我们连接这两个领域的旅程，现在让我们看看如何将一些表格数据转换成复杂的网络，以及如何对其进行分类。

# 将数据转化为复杂的网络

从表格数据构建复杂网络的方法有很多。在这里，我将描述一种 KNN 构造方法，该方法使用每个数据点的最近邻来构造网络。

给定一个表格数据集，算法基本如下:

*   选择一个 K 值
*   数据集的每一行都是空间中的一个点，因此将成为一个节点
*   获取空间中的每个点，并计算到其他点的距离
*   从正在评估的节点中选择 K 个最近的节点，并在它们之间绘制一条边

这个想法是连接最近的点。请注意，这种方法不会产生单个节点(没有连接的节点)，因为每个节点到另一个节点都有距离。

*附注:当用类转换数据时，可能需要每个类都在一个单独的组件上。这是一些算法的要求。*

这种方法的脆弱性发生在你有密集的区域，有许多节点彼此靠近。可以想象一个密集的区域也应该是密集连接的，但是 KNN 构造器只会为每个节点创建 K 条边。

还有其他算法试图解决这个问题。一个例子是 Epsilon Radius 构造函数，它在密集区域工作得很好，但是在稀疏区域会产生单值，这就不好了。然后可以结合这两种方法，使用ε半径 KNN 构造函数。所有这些算法都可以在 sknet 库中找到。

# 高级数据分类

既然我们可以将数据转换成复杂的网络，那么我们该如何利用它呢？嗯，我们可以做很多事情，但在这里，我将侧重于一个特定的算法:高级数据分类。

高级数据分类算法试图将来自传统机器学习算法(如支持向量机和随机森林)的发现与通过分析复杂网络的度量而促进的结构模式识别相结合。

它基本上由两部分组成:

*   一个低级分类器，是我们使用的传统机器学习算法的一个有趣的名字，如支持向量机或 Boosting 算法
*   高级分类器，一种复杂的基于网络的分类机制

然后，该模型将两种结果结合起来生成预测。这里的想法是，复杂网络机制能够识别数据的拓扑方面，而低级分类器将不能容易地识别这些方面。

但是这种复杂的网络机制是如何工作的呢？基本上，对于每个预测点，我们将它添加到网络的每个类组件，并验证该组件的一些度量如何变化。如果变化很小，那么我们确信该点没有改变组件的结构，并且可能从那里开始。然而，如果度量发生了很大的变化，那么这个点就改变了组件的结构，并且可能不属于那里。

人们可以通过设置一个称为 *p* 的参数来控制高级分类对最终预测的影响程度，该参数是一个介于 0 和 1 之间的值，用于定义高级影响。

关于高级数据分类如何工作的更多细节可以在[1]中找到。

# 编码

让我们看看如何使用 sknet 库将我们的表格数据转换为复杂的网络，然后利用结构模式识别来尝试和改进我们的标准机器学习算法。

在开始任何编码之前，第一步是使用 pip 安装 sknet 库:

```
pip install scikit-net
```

现在，让我们看一下代码:

```
from sklearn.datasets import load_wine
from sklearn.metrics import accuracy_score
from sknet.network_construction import KNNConstructor
from sknet.supervised import HighLevelClassifierX, y = load_wine(return_X_y = True)
X_train, X_test, y_train, y_test = train_test_split(X, y,
                                                    test_size=0.2)
knn_c = KNNConstructor(k=5)
classifier = HighLevelClassifier()
classifier.fit(X_train, y_train, constructor=knn_c)pred = classifier.predict(X_test)
print(accuracy_score(y_test, pred))
```

如您所见，代码相当简单，但让我们看看每一部分，了解发生了什么:

```
X, y = load_wine(return_X_y = True)
X_train, X_test, y_train, y_test = train_test_split(X, y,
                                                    test_size=0.2)
```

在这里，我们只是使用 sklearn 库来导入 Wine 数据集，然后将它分成一个包含 20%数据的维持测试集。

```
knn_c = KNNConstructor(k=5)
classifier = HighLevelClassifier()
classifier.fit(X_train, y_train, constructor=knn_c)
```

在第一行中，我们将创建一个 KNN 构造函数，它将负责将葡萄酒数据集转换成一个复杂的网络。在下一行，我们正在实例化高级分类器类，就像我们对来自 sklearn 的分类器所做的一样。

最后，我们在训练数据上拟合分类器。注意，我们将构造函数传递给 fit 函数，这样它就知道如何在 fit 期间转换数据。这是库中每个算法的标准方法。

```
pred = classifier.predict(X_test)
print(accuracy_score(y_test, pred))
```

最后，我们只是使用拟合的分类器来预测测试集的标签，并将其与真实标签进行比较。

注意这里我没有参数化分类器。为了简单起见，我使用了默认参数，但是，我们能够控制我们将使用哪个低级分类器，我们应该对高级预测赋予多少权重，我们应该对高级分类使用哪些指标，等等。每个参数的列表可以在[这里](https://tnanukem.github.io/scikit-net/main/api_reference/sknet.supervised.high_level_classification.html)找到。

# 关于 sknet 库的更多信息

sknet 库的开发旨在弥补在复杂网络上实现机器学习算法的现有差距。它已经提供了将表格数据转换成复杂网络的工具，正如你在这篇文章中看到的，而且还提供了将时间序列转换成网络的工具。它还实现了监督、非监督和半监督算法，可用于从复杂网络中学习或改进现有方法。

希望你喜欢它并测试 lib！

[1] Silva，T.C .，赵，L .基于网络的高层数据分类(2012)，IEEE Trans .神经网络。学习。系统。23(6)