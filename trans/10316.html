<html>
<head>
<title>A Simple Guide To Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据框简单指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-guide-to-pandas-dataframes-b125f64e1453?source=collection_archive---------9-----------------------#2021-10-01">https://towardsdatascience.com/a-simple-guide-to-pandas-dataframes-b125f64e1453?source=collection_archive---------9-----------------------#2021-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="48c6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Python的Pandas库创建、存储和操作数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9a65ad3e32b38ae28ccfb6dc66e1e6a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ef96bMiPLgVPKoij"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">埃米尔·佩龙在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="3815" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标准Python库<code class="fe lv lw lx ly b">pandas</code>是用于数据分析和操作的最流行的库之一。<code class="fe lv lw lx ly b">pandas</code>用于将数据转换为称为DataFrame的结构化格式，可用于各种操作和分析。数据帧有助于将数据格式化为清晰的表格，便于阅读和操作。</p><h1 id="3cc6" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">装置</h1><p id="26b0" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated"><code class="fe lv lw lx ly b">pandas</code>是标准的Python库之一，应该已经安装了，但是如果没有，可以用下面的命令安装:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="66fe" class="na ma it ly b gy nb nc l nd ne">pip install pandas</span></pre><h1 id="6b3c" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">入门指南</h1><p id="4ecd" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated"><code class="fe lv lw lx ly b">pandas</code>库通常与Python的<code class="fe lv lw lx ly b">numpy</code>库一起使用，因此为了本教程，我将导入并使用这两个库。(将来会写一个如何使用<code class="fe lv lw lx ly b">numpy</code>库的指南！)下面是一个从<code class="fe lv lw lx ly b">numpy</code>系列创建<code class="fe lv lw lx ly b">pandas</code>数据帧的简单例子:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="937a" class="na ma it ly b gy nb nc l nd ne">import pandas as pd<br/>import numpy as np</span><span id="4181" class="na ma it ly b gy nf nc l nd ne">values = np.random.randn(3, 2)<br/>print(values)<br/>print(type(values))</span><span id="257d" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values)<br/>print(type(df))<br/>print(df)</span></pre><p id="3444" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是两个打印语句的输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="1464" class="na ma it ly b gy nb nc l nd ne">&lt;class 'numpy.ndarray'&gt;<br/>[[-1.01774631  1.0842383 ]<br/> [-0.04752437 -0.19560713]<br/> [-0.3643328   0.34562402]]</span><span id="49e7" class="na ma it ly b gy nf nc l nd ne">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>          0         1<br/>0 -1.017746  1.084238<br/>1 -0.047524 -0.195607<br/>2 -0.364333  0.345624</span></pre><p id="b3d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，第一个输出是一个3行2列的多维<code class="fe lv lw lx ly b">numpy</code>数组。<code class="fe lv lw lx ly b">np.random.randn</code>就是简单地在指定的输出形状中生成随机数。通过使用<code class="fe lv lw lx ly b">numpy</code>数组作为参数调用<code class="fe lv lw lx ly b">pd.DataFrame()</code>，可以将数组转换为<code class="fe lv lw lx ly b">pandas</code>数据帧。第二组打印语句显示了DataFrame，它包含与<code class="fe lv lw lx ly b">numpy</code>数组相同的值，以及3行2列的相同形状。默认情况下，列和行的索引从0开始，但这些可以手动更改，也可以在创建数据帧时通过初始化来更改。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="d009" class="lz ma it bd mb mc nn me mf mg no mi mj jz np ka ml kc nq kd mn kf nr kg mp mq bi translated">更新表格</h1><h2 id="2907" class="na ma it bd mb ns nt dn mf nu nv dp mj li nw nx ml lm ny nz mn lq oa ob mp oc bi translated">更改列/行索引</h2><p id="a091" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">如前所述，默认情况下，列和索引从0开始。但是，使用简单的整数作为索引并不总是有用的，因此建议根据您正在处理的数据将行和列更改为更合适的标签。您可以在初始化数据帧时或之后更改它们。假设您有想要用来标记列和行的字段名称。以下代码显示了如何使用名称初始化DataFrame:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="798c" class="na ma it ly b gy nb nc l nd ne">import pandas as pd<br/>import numpy as np</span><span id="2d41" class="na ma it ly b gy nf nc l nd ne">values = np.random.randn(3, 2)</span><span id="5fad" class="na ma it ly b gy nf nc l nd ne">rows = ["A", "B", "C"]<br/>features = ["foo", "bar"]</span><span id="9afe" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)<br/>print(df)</span></pre><p id="cb95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="ad7a" class="na ma it ly b gy nb nc l nd ne">        foo       bar<br/>A -2.702060  0.791385<br/>B  1.696073 -0.971109<br/>C -1.430298 -2.549262</span></pre><p id="9364" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，<code class="fe lv lw lx ly b">index</code>和<code class="fe lv lw lx ly b">columns</code>参数允许您在创建DataFrame时指定索引和列名。您也可以使用以下内容手动更改它们(建议使用关键字重命名，而不是位置):</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="9d1f" class="na ma it ly b gy nb nc l nd ne">df.rename(columns={"bar": "baz"}, inplace=True)</span><span id="837c" class="na ma it ly b gy nf nc l nd ne">        foo       baz<br/>A  0.010732  0.420194<br/>B -1.718910 -1.810119<br/>C  0.409996  0.694083</span></pre><p id="3ccb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里您可以看到，通过调用<code class="fe lv lw lx ly b">rename()</code>函数，列<code class="fe lv lw lx ly b">bar</code>被更改为<code class="fe lv lw lx ly b">baz</code>。注意<code class="fe lv lw lx ly b">inplace=True</code>被添加到参数的末尾。如果要提交对数据帧的更改，这是必要的。或者，由于DataFrame上的函数返回DataFrame对象，您可以执行以下操作，其效果与添加<code class="fe lv lw lx ly b">inplace=True</code>相同:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="d7b2" class="na ma it ly b gy nb nc l nd ne">df = df.rename(columns={"bar": "baz"})</span></pre><p id="79bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里打印<code class="fe lv lw lx ly b">df</code>会得到与上面相同的结果，只是列被重命名了。</p><p id="7ea1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，通过使用<code class="fe lv lw lx ly b">set_index()</code>函数，您可以选择其中一列作为索引，如下所示，使用3x4矩阵:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="e0cf" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="edc7" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="a6b8" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)</span><span id="102f" class="na ma it ly b gy nf nc l nd ne">df.set_index("foo", inplace=True)</span><span id="6a2c" class="na ma it ly b gy nf nc l nd ne">print(df)</span></pre><p id="8440" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="2027" class="na ma it ly b gy nb nc l nd ne">     bar  baz  qux<br/>foo<br/>1      2    3    4<br/>5      6    7    8<br/>9     10   11   12</span></pre><p id="22fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将获取<code class="fe lv lw lx ly b">foo</code>列并用这些值替换当前索引。当有一列用于<code class="fe lv lw lx ly b">date</code>或<code class="fe lv lw lx ly b">id</code>并且您想要将索引设置为这些唯一值时，这通常会很方便。</p><h2 id="ee47" class="na ma it bd mb ns nt dn mf nu nv dp mj li nw nx ml lm ny nz mn lq oa ob mp oc bi translated">添加新列/行</h2><p id="7b65" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">如果您想在数据帧的底部追加一个新行，您必须确保它与现有数据帧的形状相同。例如，如果您有与上面相同的4列数据帧，则正在添加的新行也应该有相同的4列。下面是新的数据框架，由3行4列组成:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="cf11" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="57fa" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="2a78" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)<br/>prrint(df)</span></pre><p id="7aa3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="ebd1" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux<br/>A    1    2    3    4<br/>B    5    6    7    8<br/>C    9   10   11   12</span></pre><p id="1222" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果您想添加一个新行，这4列必须对齐。至于索引，您可以指定它或者让<code class="fe lv lw lx ly b">pandas</code>自动生成一个新的(默认为下一个可用的整数):</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="fd35" class="na ma it ly b gy nb nc l nd ne">new_data = [[13, 14, 15, 16]]<br/>new_df = pd.DataFrame(new_data, index=["D"], columns=features)</span><span id="c44b" class="na ma it ly b gy nf nc l nd ne">df = df.append(new_df)<br/>print(df)</span></pre><p id="a670" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="6e7a" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux<br/>A    1    2    3    4<br/>B    5    6    7    8<br/>C    9   10   11   12<br/>D   13   14   15   16</span></pre><p id="ee37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意<code class="fe lv lw lx ly b">new_data</code>不仅仅是一个列表，而是一个1行4列的矩阵。这是因为它必须遵循与附加它的初始数据帧相同的结构。然后，您可以将这个1x4转换为第二个DataFrame，它具有指定的索引和相同的列。功能<code class="fe lv lw lx ly b">df.append()</code>允许您将这个由单行组成的新数据帧添加到原始数据帧中。</p><p id="6750" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要向数据帧添加新列，只需用新列名和新数据引用数据帧。使用与上面相同的数据帧，它看起来像这样:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="4553" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="8156" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="54cf" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)<br/>df["quux"] = [55, 56, 57]</span><span id="5ed5" class="na ma it ly b gy nf nc l nd ne">print(df)</span></pre><p id="87bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="329e" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux  quux<br/>A    1    2    3    4    55<br/>B    5    6    7    8    56<br/>C    9   10   11   12    57</span></pre><p id="7528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只要新列表与初始数据帧具有相同的行，就可以很容易地追加新列。</p><p id="3994" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一个更巧妙的技巧——如果您想选择所有的列名，您可以调用<code class="fe lv lw lx ly b">df.columns</code>来返回<code class="fe lv lw lx ly b">['foo', 'bar', 'baz', 'qux', 'quux']</code>！</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="757c" class="lz ma it bd mb mc nn me mf mg no mi mj jz np ka ml kc nq kd mn kf nr kg mp mq bi translated">选择数据</h1><p id="e229" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">有时，您可能需要访问特定的行或列，甚至是特定的数据单元格。与我们之前添加列的方式类似，您可以用同样的方式访问一个或多个列:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="016f" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="5846" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="f053" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)<br/>print(df[["foo", "baz"]])</span></pre><p id="204d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="4ed3" class="na ma it ly b gy nb nc l nd ne">   foo  baz<br/>A    1    3<br/>B    5    7<br/>C    9   11</span></pre><p id="2c31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过调用由列名列表索引的<code class="fe lv lw lx ly b">df</code>，您可以创建一个只包含指定列的新对象。现在，如果您只想访问某些行，您可以使用<code class="fe lv lw lx ly b">.loc</code>或<code class="fe lv lw lx ly b">.iloc</code>。这两者的区别只是通过名称或索引位置来访问行。以下示例显示了两种方法以及它们如何返回同一行:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="6df8" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="6e67" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="ebd0" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)</span><span id="e998" class="na ma it ly b gy nf nc l nd ne">row_loc = df.loc["B"]<br/>print(row_loc)</span><span id="5413" class="na ma it ly b gy nf nc l nd ne">row_iloc = df.iloc[1]<br/>print(row_iloc)</span></pre><p id="3f8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="9a05" class="na ma it ly b gy nb nc l nd ne">foo    5<br/>bar    6<br/>baz    7<br/>qux    8<br/>Name: B, dtype: int64</span><span id="fdac" class="na ma it ly b gy nf nc l nd ne">foo    5<br/>bar    6<br/>baz    7<br/>qux    8<br/>Name: B, dtype: int64</span></pre><p id="398e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">索引1处的行(第二行，因为我们从0开始计数！)和索引为<code class="fe lv lw lx ly b">B</code>的行是同一行，可以用任何一种方法访问。</p><p id="fdf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想访问单个单元格，您也可以使用<code class="fe lv lw lx ly b">.iloc</code>,如下图所示:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="679d" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="7cc8" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="3c4d" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)<br/>print(df)</span><span id="7b41" class="na ma it ly b gy nf nc l nd ne">cell = df.iloc[1, 2]<br/>print("cell: ", cell)</span></pre><p id="76ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="8e2d" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux<br/>A    1    2    3    4<br/>B    5    6    7    8<br/>C    9   10   11   12</span><span id="0a46" class="na ma it ly b gy nf nc l nd ne">cell:  7</span></pre><p id="1605" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">.iloc</code>，第一个值是行，第二个值是列——因此<code class="fe lv lw lx ly b">.iloc[1, 2]</code>访问第2行第3列的单元格。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="bbd3" class="lz ma it bd mb mc nn me mf mg no mi mj jz np ka ml kc nq kd mn kf nr kg mp mq bi translated">操作</h1><p id="818f" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">数学运算也可应用于<code class="fe lv lw lx ly b">pandas</code>数据帧中的数据。简单地说，可以将标量应用于数据帧的一列，如下所示:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="d7c0" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="0c32" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="9e2b" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)</span><span id="68fe" class="na ma it ly b gy nf nc l nd ne">df["qux"] = df["qux"] * 10</span><span id="b420" class="na ma it ly b gy nf nc l nd ne">print(df)</span></pre><p id="2011" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="10f2" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux<br/>A    1    2    3   40<br/>B    5    6    7   80<br/>C    9   10   11  120</span></pre><p id="2c19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们将<code class="fe lv lw lx ly b">qux</code>列乘以标量10，并用新的值替换该列中的值。您还可以在多列之间执行操作，例如将列相加或相乘。在下面的示例中，我们将两列相乘，并将它们存储到一个新列中:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="1c56" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="d096" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="7253" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)</span><span id="69d8" class="na ma it ly b gy nf nc l nd ne">df["quux"] = df["bar"] * df["baz"]</span><span id="35e7" class="na ma it ly b gy nf nc l nd ne">print(df)</span></pre><p id="6896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="b677" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux  quux<br/>A    1    2    3    4     6<br/>B    5    6    7    8    42<br/>C    9   10   11   12   110</span></pre><p id="0fe6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，新的<code class="fe lv lw lx ly b">quux</code>列的每一行都是<code class="fe lv lw lx ly b">bar</code>列和<code class="fe lv lw lx ly b">baz</code>列的每一行的乘积。</p><p id="a838" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在数据帧上执行的另一个重要操作是<code class="fe lv lw lx ly b">apply()</code>功能。这允许您对数据帧中的数据应用整个函数。以下是使用<code class="fe lv lw lx ly b">apply()</code>函数对数据应用独立函数的简单示例:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="371c" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="c557" class="na ma it ly b gy nf nc l nd ne">def sum_function(row):<br/>    return row["foo"] + row["bar"] + row["baz"] + row["qux"]</span><span id="33a7" class="na ma it ly b gy nf nc l nd ne">values = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]<br/>rows = ["A", "B", "C"]<br/>features = ["foo", "bar", "baz", "qux"]</span><span id="9b4d" class="na ma it ly b gy nf nc l nd ne">df = pd.DataFrame(values, index=rows, columns=features)</span><span id="3dc4" class="na ma it ly b gy nf nc l nd ne">df["quux"] = df.apply(sum_function, axis=1)</span><span id="1f4e" class="na ma it ly b gy nf nc l nd ne">print(df)</span></pre><p id="5f5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="cb8e" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux  quux<br/>A    1    2    3    4    10<br/>B    5    6    7    8    26<br/>C    9   10   11   12    42</span></pre><p id="07fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们有一个名为<code class="fe lv lw lx ly b">sum_function()</code>的函数，它简单地将一行中的4个元素相加。使用相同的DataFrame，我们可以用这个函数作为参数调用<code class="fe lv lw lx ly b">df.apply()</code>。第二个参数<code class="fe lv lw lx ly b">axis=1</code>是必需的，因为默认情况下轴被设置为0，而<code class="fe lv lw lx ly b">apply()</code>将作用于行而不是列。使用这个<code class="fe lv lw lx ly b">apply()</code>函数，我们可以看到<code class="fe lv lw lx ly b">quux</code>列包含所有先前字段的总和，这是由指定的函数应用的。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="da8b" class="lz ma it bd mb mc nn me mf mg no mi mj jz np ka ml kc nq kd mn kf nr kg mp mq bi translated">读取/写入数据</h1><p id="9c94" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated"><code class="fe lv lw lx ly b">pandas</code>的另一个简洁的特性是你可以读写数据帧中的文件。例如，您可以读入CSV或JSON文件，处理数据，然后将其写回新文件。假设您在与Python脚本相同的目录中有一个名为<code class="fe lv lw lx ly b">data.csv</code>的文件，其中包含我们一直在处理的相同数据。您可以使用以下代码将它读入数据帧:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="f011" class="na ma it ly b gy nb nc l nd ne">import pandas as pd</span><span id="3ca6" class="na ma it ly b gy nf nc l nd ne">df = pd.read_csv("data.csv")</span><span id="2c08" class="na ma it ly b gy nf nc l nd ne">print(df)</span></pre><p id="cea2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其输出将与我们一直在处理的数据相同:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="6f55" class="na ma it ly b gy nb nc l nd ne">   foo  bar  baz  qux<br/>A    1    2    3    4<br/>B    5    6    7    8<br/>C    9   10   11   12</span></pre><p id="8008" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，如果您想将数据写回一个新的CSV，您可以使用以下命令将它写到您的工作目录:</p><p id="e6a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">output.csv</code>:</p><pre class="kj kk kl km gt mw ly mx my aw mz bi"><span id="7573" class="na ma it ly b gy nb nc l nd ne">,foo,bar,baz,qux<br/>A,1,2,3,4<br/>B,5,6,7,8<br/>C,9,10,11,12</span></pre><p id="eaa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个<code class="fe lv lw lx ly b">output.csv</code>正是我们最初用<code class="fe lv lw lx ly b">read_csv()</code>函数读入数据帧的<code class="fe lv lw lx ly b">data.csv</code>所包含的内容！</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="de7b" class="lz ma it bd mb mc nn me mf mg no mi mj jz np ka ml kc nq kd mn kf nr kg mp mq bi translated">外卖食品</h1><p id="4268" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated"><code class="fe lv lw lx ly b">pandas</code>库非常灵活，对于处理数据集和数据分析非常有用。使用<code class="fe lv lw lx ly b">pandas</code>对数据进行存储、操作和执行操作非常简单。此外，许多机器学习模型可以使用<code class="fe lv lw lx ly b">pandas</code>数据帧作为它们的输入。本指南的目标是提供该库的简单概述，并提供一些基本示例来帮助您更好地理解<code class="fe lv lw lx ly b">pandas</code>的一些关键特性。</p><p id="a7bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读，我希望您已经对<code class="fe lv lw lx ly b">pandas</code>有了足够的了解，可以开始在您的下一个Python项目中实现它了！</p></div></div>    
</body>
</html>