<html>
<head>
<title>Creating Geographical Plots Using Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Plotly创建地理图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-geographical-plots-using-plotly-e77401f676c1?source=collection_archive---------22-----------------------#2021-04-15">https://towardsdatascience.com/creating-geographical-plots-using-plotly-e77401f676c1?source=collection_archive---------22-----------------------#2021-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0a23" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用plotly可视化地理数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ece483385ff696fdd167f0e5221ea06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_PB4RXNNnYF9R5t46YcMzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="dff8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Plotly是一个创建高级交互图形的开源库，可用于轻松绘制各种类型的图形和图表。</p><p id="3b4b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在plotly之前，创建地理图从未如此容易。Plotly在后端使用JS来呈现图形。这使得它们具有视觉吸引力和高度交互性。</p><p id="1f24" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将使用plotly来创建地理图，并使用其他功能。</p><p id="3a05" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始吧…</p><h1 id="bc41" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">安装所需的库</h1><p id="b715" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我们将从使用pip安装plotly开始。下面给出的命令将安装它。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="776a" class="mw lv it ms b gy mx my l mz na">pip install plotly</span></pre><h1 id="c262" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">导入所需的库</h1><p id="d48f" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在这一步中，我们将导入一些创建图表所需的库，加载数据所需的库等等。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="a496" class="mw lv it ms b gy mx my l mz na">import pandas as pd<br/>from urllib.request import urlopen<br/>import json<br/>import plotly.express as px<strong class="ms iu"><br/></strong>import plotly.graph_objects as go</span></pre><h1 id="37cd" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">创建地理图表</h1><p id="6d6d" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">这是最后一步，我们将使用不同的在线数据集创建不同的地理地图。我们将从创建一个简单的图表开始。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="d8dc" class="mw lv it ms b gy mx my l mz na">with urlopen('https://raw.githubusercontent.com/plotly/datasets/master/geojson-counties-fips.json') as response:<br/>    counties = json.load(response)</span><span id="d1da" class="mw lv it ms b gy nb my l mz na">df = pd.read_csv("https://raw.githubusercontent.com/plotly/datasets/master/fips-unemp-16.csv",<br/>                   dtype={"fips": str})</span><span id="960c" class="mw lv it ms b gy nb my l mz na">fig = px.choropleth_mapbox(df, geojson=counties, locations='fips', color='unemp',<br/>                           color_continuous_scale="Viridis",<br/>                           range_color=(0, 12),<br/>                           mapbox_style="carto-positron",<br/>                           zoom=3, center = {"lat": 37.0902, "lon": -95.7129},<br/>                           opacity=0.5,<br/>                           labels={'unemp':'unemployment rate'}<br/>                          )<br/>fig.update_layout(margin={"r":0,"t":0,"l":0,"b":0})<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/844fc400b5d2ca4f29c43f80617c5e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r4n5lvdMurZwu29Y1yLsyQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">地理图(来源:作者)</p></figure><p id="e08a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，让我们看看其他类型的图表，我们可以使用Plotly创建。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="12be" class="mw lv it ms b gy mx my l mz na">df = px.data.election()<br/>geojson = px.data.election_geojson()</span><span id="2cdf" class="mw lv it ms b gy nb my l mz na">fig = px.choropleth_mapbox(df, geojson=geojson, color="winner",<br/>                           locations="district", featureidkey="properties.district",<br/>                           center={"lat": 45.5517, "lon": -73.7073},<br/>                           mapbox_style="carto-positron", zoom=9)<br/>fig.update_layout(margin={"r":0,"t":0,"l":0,"b":0})<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ece483385ff696fdd167f0e5221ea06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_PB4RXNNnYF9R5t46YcMzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">地理图(来源:作者)</p></figure><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="8188" class="mw lv it ms b gy mx my l mz na">us_cities = pd.read_csv("https://raw.githubusercontent.com/plotly/datasets/master/us-cities-top-1k.csv")<br/>us_cities = us_cities.query("State in ['New York', 'Ohio']")</span><span id="a2f0" class="mw lv it ms b gy nb my l mz na">import plotly.express as px</span><span id="9f98" class="mw lv it ms b gy nb my l mz na">fig = px.line_mapbox(us_cities, lat="lat", lon="lon", color="State", zoom=3, height=300)</span><span id="6e8d" class="mw lv it ms b gy nb my l mz na">fig.update_layout(mapbox_style="stamen-terrain", mapbox_zoom=4, mapbox_center_lat = 41,<br/>    margin={"r":0,"t":0,"l":0,"b":0})</span><span id="74ed" class="mw lv it ms b gy nb my l mz na">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/95bf78b25d754312d0b50c3c89450a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRXzhHAXbUHZCW7BUidILA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线条地图框(来源:作者)</p></figure><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="13c0" class="mw lv it ms b gy mx my l mz na">fig = go.Figure(go.Scattermapbox(<br/>    mode = "markers+lines",<br/>    lon = [10, 20, 30],<br/>    lat = [10, 20,30],<br/>    marker = {'size': 10}))<br/><br/>fig.add_trace(go.Scattermapbox(<br/>    mode = "markers+lines",<br/>    lon = [-50, -60,40],<br/>    lat = [30, 10, -20],<br/>    marker = {'size': 10}))<br/><br/>fig.update_layout(<br/>    margin ={'l':0,'t':0,'b':0,'r':0},<br/>    mapbox = {<br/>        'center': {'lon': 10, 'lat': 10},<br/>        'style': "stamen-terrain",<br/>        'center': {'lon': -20, 'lat': -20},<br/>        'zoom': 1})<br/><br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d2ef8287fae33bbe6f1a5749197c4f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bff-dkQNikDSGjsBCdIA0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">散点图框(来源:作者)</p></figure><p id="21df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是你如何使用plotly创建不同的地理图。继续在不同的数据集上尝试，并让我知道您在回复部分的评论。</p><p id="5bc7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">本文与</strong> <a class="nc nd ep" href="https://medium.com/u/40808d551f5a?source=post_page-----e77401f676c1--------------------------------" rel="noopener" target="_blank"> <strong class="la iu">皮尤什英加尔</strong> </a> <strong class="la iu">合作。</strong></p><h1 id="a21d" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">在你走之前</h1><p id="989d" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated"><strong class="la iu"> <em class="ne">感谢</em> </strong> <em class="ne">的阅读！如果您想与我取得联系，请随时通过hmix13@gmail.com联系我或我的</em> <a class="ae nf" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> <em class="ne"> LinkedIn个人资料</em> </strong> </a> <em class="ne">。可以查看我的</em><a class="ae nf" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="la iu"><em class="ne">Github</em></strong><em class="ne"/></a><em class="ne">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae nf" href="https://medium.com/@hmix13" rel="noopener"> <strong class="la iu"> <em class="ne">我的简介</em> </strong> </a> <em class="ne">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>