<html>
<head>
<title>Origins of Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归的起源</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-essence-of-logistic-regression-e9188625cb7d?source=collection_archive---------28-----------------------#2021-11-29">https://towardsdatascience.com/the-essence-of-logistic-regression-e9188625cb7d?source=collection_archive---------28-----------------------#2021-11-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9eca" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用广义线性模型解释逻辑回归的起源</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/29d823488070e2bfa1c6719e8042aefd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M0ySTXUiuC3RdE7G"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">布雷特·乔丹在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e2ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Logistic_regression" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">逻辑回归</strong> </a> <strong class="lb iu"> </strong>是几乎每个数据科学家都在使用的一种无处不在的算法。然而，尽管它已经广为人知并得到了实施，但许多实践者仍然没有完全理解它的起源。在我的<a class="ae ky" rel="noopener" target="_blank" href="/poisson-regression-and-generalised-linear-models-606fe5f7c1fd">上一篇文章</a>中，我讨论了<a class="ae ky" href="https://en.wikipedia.org/wiki/Generalized_linear_model" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">【GLMs】</strong></a>以及它们与机器学习算法的联系。我建议现在的读者浏览一下那篇文章，以便对 GLMs 有一个全面的了解。然而，简而言之，GLMs 为目标变量<strong class="lb iu">非正态分布</strong>提供了一个理论框架。在本文中，我们将使用 GLMs 推导逻辑回归，以显示它的确切来源。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9789" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">例题和动机</h1><p id="f4ab" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">逻辑回归的目的是在给定一些特征的情况下，为发生的事件或属于某一类别的样本分配一个<strong class="lb iu">概率。这类似于一个<strong class="lb iu">布尔值输出。</strong></strong></p><p id="6b20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个示例问题是确定学生是否通过考试。让我们将通过(成功)指定为<strong class="lb iu"> 1 </strong>，将失败指定为<strong class="lb iu"> 0 </strong>。现在，让我们假设我们知道他们为考试学习了多长时间，称这个为<strong class="lb iu"> <em class="mz"> X_1 </em> </strong>，以及他们是否通过了之前的考试<strong class="lb iu"> <em class="mz"> X_2 </em> </strong>。因此，我们可以把这个问题表述为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/8cbdafcf9c8ea5c5dfa99e90a6481616.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*GMvA21QvvYeykPZJe5yjLA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="2f57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中<strong class="lb iu"> <em class="mz"> Y </em> </strong>为目标，那个<strong class="lb iu">应该</strong>取值在<strong class="lb iu"> 0 </strong>和<strong class="lb iu"> 1 之间，</strong>和<strong class="lb iu"> <em class="mz"> β </em> </strong>值是我们需要计算的<strong class="lb iu">未知系数</strong>来拟合模型。然而，你看到上面等式的问题了吗？<strong class="lb iu">无法保证输出会在 0 和 1 之间。</strong>花在学习上的时间，<strong class="lb iu"> <em class="mz"> X_1 </em> </strong> <em class="mz">，</em>可以取从<strong class="lb iu"> 0 </strong>到<strong class="lb iu">无穷大</strong>的值，这样我们就可以得到一个大于<strong class="lb iu"> 1 的<strong class="lb iu"> <em class="mz"> Y </em> </strong>值。这不好，会让我们的模型变得荒谬。</strong></p><p id="23cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们需要找到一种方法，或者更好的一个<strong class="lb iu">函数</strong>，来满足我们的目标变量<strong class="lb iu">的要求。</strong>可以使用 GLMs 的数学框架找到该函数。</p><h1 id="3259" class="mc md it bd me mf nb mh mi mj nc ml mm jz nd ka mo kc ne kd mq kf nf kg ms mt bi translated">伯努利和二项式分布</h1><p id="3783" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">上述问题所需的输出由<a class="ae ky" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">伯努利分布</strong> </a>满足。这种分布用两种可能的结果计算某个试验的概率，<strong class="lb iu">成功或失败。</strong>例如，抛硬币是否会落在人头上。人们通常将<strong class="lb iu">成功</strong>的概率指定为<em class="mz"> p，</em> ，因此<strong class="lb iu"> <em class="mz"> </em>失败</strong>的概率为<strong class="lb iu">1–p</strong>。</p><p id="722d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">伯努利分布的概率质量函数为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/f70dbeb744d7ad5f86f4cf825af58792.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*YOgkNvQpDp-4MnsQTtk71w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="6ad3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中<strong class="lb iu"> <em class="mz"> x </em> </strong>是成功试验的<strong class="lb iu">次数</strong>，<strong class="lb iu"> <em class="mz"> p </em> </strong>是成功试验的<strong class="lb iu">概率</strong>。</p><p id="e6d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">伯努利分布是二项分布的<strong class="lb iu">特例，其中我们有<strong class="lb iu">个多次试验</strong>，用<strong class="lb iu"> <em class="mz"> n </em> </strong>表示，因此可以有<strong class="lb iu">个以上的成功试验</strong>。二项式分布的<strong class="lb iu">概率质量函数</strong>为:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/7d98c3161dc5d80f89191035dfcb66d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*7qgtmDzFGCYSz8khr-8v4w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="13d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这与伯努利分布的函数相同，只是我们现在乘以由下式给出的<strong class="lb iu">二项式系数</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/4c4382da703963e926380b5922b9737a.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*uUhj6kucOM6s4Ik6ra-e-A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="8fe5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些系数计算在<strong class="lb iu"><em class="mz"/></strong>试验中有<strong class="lb iu"><em class="mz">【x】</em></strong><em class="mz"/>种结果的方式(排列)的数量。这些系数出现在<a class="ae ky" href="https://en.wikipedia.org/wiki/Binomial_coefficient" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">帕斯卡三角</strong><strong class="lb iu">组合学</strong> </a> <strong class="lb iu">等许多自然现象中。</strong></p><h1 id="68b4" class="mc md it bd me mf nb mh mi mj nc ml mm jz nd ka mo kc ne kd mq kf nf kg ms mt bi translated">GLMs 和链接功能</h1><p id="551c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">GLMs 可用于确定<strong class="lb iu">将输入“链接”到所需分配输出</strong>的功能。GLM 理论框架要求目标变量分布是指数族的一员，该指数族由以下<strong class="lb iu">概率密度函数</strong>给出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/7ca81cf5788bc6e8178e5f3a8254a68d.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*wezCahdS3QJHC_pJsMXQFg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="eb7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中，<strong class="lb iu"> θ </strong>为<strong class="lb iu">自然参数，</strong>即<strong class="lb iu"> </strong>为<strong class="lb iu">与均值挂钩，</strong><strong class="lb iu">φ</strong>为<strong class="lb iu">标度参数</strong>，即<strong class="lb iu">与方差</strong>挂钩。此外，<strong class="lb iu"> a(φ) </strong>、<strong class="lb iu"> b(θ) </strong>和<strong class="lb iu"> c(y，φ) </strong>是需要计算的附加函数。</p><p id="ea22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以通过数学推导得出，指数族的<strong class="lb iu">均值、<em class="mz"> E(Y)、</em>和方差、<em class="mz"> Var(Y) </em>、</strong>由下式决定:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e10c3927a2458edae54e32e079879b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:242/format:webp/1*Fr763FOB-sp4J74NnpGRQg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/867c54c84b31c2a66ad20d28409ce06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*bipIQk7XS2YLaPOz65OZwA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="0463" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些公式只是为了完整性而给出的，对于这个推导来说并不是必需的。同样，这个理论框架在我的<a class="ae ky" rel="noopener" target="_blank" href="/poisson-regression-and-generalised-linear-models-606fe5f7c1fd">上一篇文章</a>中有更详细的解释。</p><h1 id="f028" class="mc md it bd me mf nb mh mi mj nc ml mm jz nd ka mo kc ne kd mq kf nf kg ms mt bi translated">二项分布的链接函数</h1><p id="51f2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">实际上，二项式分布是指数族的一员，可以用要求的格式写成:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/ab4201abe4568fbfceadeef45e41c153.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*4_MnHhcHoeL5gaeClvkecg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="3e98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将二项式公式的系数<strong class="lb iu">与指数族公式的系数</strong>进行匹配，我们得出结论:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/fdfb4b090842cb7338cc7bf9a8eefae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:326/format:webp/1*EK3UDSqTccqg4OHOh-MZ9g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="12fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你认识这个等式吗？上述函数被称为<strong class="lb iu"> Logit 函数</strong>，是二项式/伯努利分布的<strong class="lb iu">圆锥形连接函数</strong>。作为参考，上面的<strong class="lb iu"> <em class="mz"> p </em> </strong> <em class="mz"> </em>值是输出变量<strong class="lb iu"> <em class="mz"> Y </em> </strong> <em class="mz"> </em>等于<strong class="lb iu">1</strong><strong class="lb iu"><em class="mz">P = P(Y = 1)</em></strong><em class="mz">的<strong class="lb iu">概率</strong>。</em></p><p id="1e87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，对于具有二项式/伯努利分布的目标变量,<strong class="lb iu">数学推导的关联函数是 Logit 函数</strong>。这就是为什么叫<strong class="lb iu"> Logistic 回归！</strong></p><p id="ed37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到我们上面设置的学生是否通过考试的问题。我们现在可以使用<strong class="lb iu"> Logit 函数</strong>修改我们之前的等式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/0ed92ef65cb3e4be2a9de692c46ff9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*Bwz2ndcMkCvz36W7lVy1Pg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="7de4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重新排列:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/d1b9803b15cf71e92c13ef78c9ac280b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*HeWABngD_72LxdTAQDw1Xg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在 LaTeX 中生成的方程。</p></figure><p id="2ce0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们推导出了著名的<a class="ae ky" href="https://en.wikipedia.org/wiki/Sigmoid_function" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Sigmoid 函数</strong> </a>！这个新的等式现在确保了无论我们的输入取什么值，输出总是在 0 和 1 之间！</p><h1 id="9b1c" class="mc md it bd me mf nb mh mi mj nc ml mm jz nd ka mo kc ne kd mq kf nf kg ms mt bi translated">结论</h1><p id="3d87" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我希望你喜欢上面的文章，并对逻辑回归的起源有所了解。我省略了相当多的数学细节，因为有些推导已经非常详尽了！因此，请随意进一步探讨这个话题，以获得更好的直觉！</p><h1 id="3e85" class="mc md it bd me mf nb mh mi mj nc ml mm jz nd ka mo kc ne kd mq kf nf kg ms mt bi translated">和我联系！</h1><ul class=""><li id="ca40" class="nq nr it lb b lc mu lf mv li ns lm nt lq nu lu nv nw nx ny bi translated">要在媒体上阅读无限的故事，请务必在这里注册！  <em class="mz"> </em>💜</li><li id="9786" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="/subscribe/@egorhowell" rel="noopener ugc nofollow" target="_blank"> <em class="mz">想在我发帖注册时得到更新的邮件通知吗！</em>T45<em class="mz">T47】😀</em></a></li><li id="b8dc" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://www.linkedin.com/in/egor-howell-092a721b3/" rel="noopener ugc nofollow" target="_blank"> <em class="mz">领英</em> </a> <em class="mz"> </em>👔</li><li id="a7a0" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://twitter.com/EgorHowell" rel="noopener ugc nofollow" target="_blank"> <em class="mz">碎碎念</em> </a> <em class="mz"> </em> 🖊</li><li id="fb18" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://github.com/egorhowell" rel="noopener ugc nofollow" target="_blank"><em class="mz">github</em></a><em class="mz"/>🖥</li><li id="87b0" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://www.kaggle.com/egorphysics" rel="noopener ugc nofollow" target="_blank"><em class="mz"/></a><em class="mz"/>🏅</li></ul><blockquote class="oe of og"><p id="dbf0" class="kz la mz lb b lc ld ju le lf lg jx lh oh lj lk ll oi ln lo lp oj lr ls lt lu im bi translated">(所有表情符号都是由<a class="ae ky" href="https://openmoji.org/" rel="noopener ugc nofollow" target="_blank"> OpenMoji </a>设计的——开源的表情符号和图标项目。执照:<a class="ae ky" href="https://creativecommons.org/licenses/by-sa/4.0/#" rel="noopener ugc nofollow" target="_blank"> CC BY-SA 4.0 </a></p></blockquote></div></div>    
</body>
</html>