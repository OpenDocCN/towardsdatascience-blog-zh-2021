<html>
<head>
<title>An introduction to SQL using FPL data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用FPL数据的SQL简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-sql-using-fpl-data-8314ec982308?source=collection_archive---------24-----------------------#2021-05-07">https://towardsdatascience.com/an-introduction-to-sql-using-fpl-data-8314ec982308?source=collection_archive---------24-----------------------#2021-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="101b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用梦幻超级联赛数据的SQL基础指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ae35e3c322b156d98956dadcd8e47ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Uo_bGtFKU2UuxLc3"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">内森·罗杰斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7ac4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于任何与数据打交道的人来说，SQL是一项非常有用的技能。这是一个教程，为那些想学习一些基础知识，并有兴趣这样做与幻想英超联赛数据。</p><h2 id="8340" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">数据</h2><p id="ffd4" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在本教程中，我使用来自https://github.com/vaastav/Fantasy-Premier-League<a class="ae kv" href="https://github.com/vaastav/Fantasy-Premier-League" rel="noopener ugc nofollow" target="_blank">的数据。这是一个用于获取游戏周数据的FPL库。以前的比赛周可以在资源库中找到。我用的是一个叫merged_gw的文件。每个玩家的每个游戏都有一行。</a></p><h2 id="4c50" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">工具</h2><p id="f84f" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在本教程中，我使用数据库浏览器的SQLite(<a class="ae kv" href="https://sqlitebrowser.org/" rel="noopener ugc nofollow" target="_blank">https://sqlitebrowser.org/</a>)。我选择了这个，通常也选择了SQL Lite，因为设置非常简单。DB Browser for SQLite将让我们创建数据库，添加数据，然后查询数据。</p><h1 id="1fbc" class="mq lt iq bd lu mr ms mt lx mu mv mw ma jw mx jx md jz my ka mg kc mz kd mj na bi translated">创建数据库和表</h1><p id="7378" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我们需要做的第一件事是创建一个数据库。在数据库浏览器中:</p><ol class=""><li id="5add" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">转到<strong class="ky ir">文件&gt;新数据库</strong>。</li><li id="9724" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">保存文件——我将其命名为<em class="np"> FPL.db </em></li></ol><p id="8a3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，您将看到一个创建表的选项。在这里，我们只需单击cancel，因为我们将利用DB Browser的功能，根据我们要导入的CSV来定义表，然后导入数据。</p><ol class=""><li id="a7b6" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">转到<strong class="ky ir">文件&gt;从CSV导入&gt;表。</strong></li><li id="f4bf" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">选择文件并点击<strong class="ky ir">打开</strong></li><li id="199e" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">给这张桌子起个名字——我把它命名为<em class="np"> Players_GWs </em></li><li id="4b70" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">选中复选框，说明CSV中的第一行代表列名(这些将成为我们的表名列)。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/2f760a01a7d169d3d1901db630981d06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KImgi6-hX4Y0wxg-o6ieCg.png"/></div></div></figure><p id="ca1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样做将创建表格。该应用程序还显示了用于创建表的查询。CREATE TABLE后面是我们正在创建的表的名称，然后在括号中是每列的名称，后面是数据类型，每列名称用逗号分隔:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="bc95" class="ls lt iq ns b gy nw nx l ny nz">CREATE TABLE "Players_GWs" (<br/> "name" TEXT,<br/> "position" TEXT,<br/> "team" TEXT,<br/> "xP" REAL,<br/> "assists" INTEGER,<br/> "bonus" INTEGER,<br/> "bps" INTEGER,<br/>.........</span></pre><h1 id="176d" class="mq lt iq bd lu mr ms mt lx mu mv mw ma jw mx jx md jz my ka mg kc mz kd mj na bi translated">探索数据</h1><p id="0eef" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">要执行SQL，我们转到<em class="np">执行SQL </em>选项卡:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/cf792850d4e939d64e390b2a9b29c7e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*1TLsEQzuBkr5XgpxeeHI4A.png"/></div></figure><p id="69bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下示例中的所有查询都是通过输入查询并单击工具栏中的“运行”按钮(或CTRL + Enter)来执行的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/e48edd22e9d0755de08122588e9d9a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*yc9NqfJrA4fBILyL2szEUA.png"/></div></figure><h2 id="1673" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">选择基础</h2><p id="c274" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我们使用SELECT来查询数据库。下面是一个从数据库中获取数据的基本SELECT语句。我们说我们想要从哪个表中选择哪些列。*表示我们选择所有列。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="623d" class="ls lt iq ns b gy nw nx l ny nz">SELECT * FROM Players_GWs</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/03025aa1e89eb26f51878446bdc36e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WslIMhvGRf-3ncWAd5VX3g.png"/></div></div></figure><h2 id="471d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">限制</h2><p id="6108" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这将返回我们所有的行和列。不是很有用，因为有20，700行。如果我们想快速查看我们拥有的数据类型，我们可以运行上面的限制，只返回指定数量的行。这里我们返回5行:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="ff19" class="ls lt iq ns b gy nw nx l ny nz">SELECT * FROM Players_GWs LIMIT 5</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/b8a07421b1fe0fd7bc04745f1827412c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7ko-4y7a7cmMUI5JP8aqA.png"/></div></div></figure><h2 id="19bd" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">选择特定列</h2><p id="30f8" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">所以我们有更少的行，但是通过使用*我们仍然可以看到所有的列，这使得我们很难看到最有趣的列。我们可以用我们想要查看的特定列替换*。让我们加上<em class="np">姓名，职位，团队，GW，总积分，</em>和<em class="np">值。</em></p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="1a98" class="ls lt iq ns b gy nw nx l ny nz">SELECT name, position, team, GW, total_points, value FROM Players_GWs LIMIT 5</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/4a40415790b2ef85469ffa1441f86d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqdUA2BUwh6u0CLq4e2EvQ.png"/></div></div></figure><p id="3bae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样值得注意的是，这些列可以按照我们选择的任何顺序排列。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="40c0" class="ls lt iq ns b gy nw nx l ny nz">SELECT position, GW, name, team, total_points, value FROM Players_GWs LIMIT 5</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/3e9e45de8080c37c522683eeecdd377b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OnwU0s-iiclO7sIxqvd1MA.png"/></div></div></figure><h2 id="a5aa" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">以...排序</h2><p id="db4c" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">到目前为止，我们有一个按名称字母顺序排列的记录列表(因为这就是CSV中的数据以及它保存到包中的方式)。更有趣的是根据某种度量标准来查看前5行。我们可以将total_points列添加到查询中，并根据它进行排序。这需要在限制前进行。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="6338" class="ls lt iq ns b gy nw nx l ny nz">SELECT name, position, team, GW, total_points, value FROM Players_GWs ORDER BY total_points LIMIT 5</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/f8a340b914ceb3aaf69f11d47f950e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3m1ZTYLV5V-U5aiK18mRMg.png"/></div></div></figure><h2 id="e8c5" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">由DESC订购</h2><p id="afea" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">如我们所见，数据从最小到最大。这是单场得分最低的五位选手。通过将DESC添加到我们的订单中，我们可以看到前五名。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/525b0d8b9f1dc950c7822af2b3d17761.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcEMsmiy_yxBlRLvJk1jSQ.png"/></div></div></figure><h2 id="fd31" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">在哪里</h2><p id="13d6" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">如果我们想查看某个特定团队的情况，我们可以使用WHERE来过滤团队。让我们看看马刺。所以就是[我们要匹配的列]=[我们要匹配的值]:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="4a52" class="ls lt iq ns b gy nw nx l ny nz">SELECT name, position, team, GW, total_points, value FROM Players_GWs WHERE team='Spurs' ORDER BY total_points DESC LIMIT 5</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/79fd8b6a39c55d36a050af813ef916c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0ZsnaQaIYT3CkPdyYQjiQ.png"/></div></div></figure><h2 id="59bb" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">喜欢</h2><p id="99e0" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">“马刺队”寻找一个精确的匹配。我们也可以用LIKE来匹配一个模式。例如，假设我们想同时匹配曼城和曼联，我们可以用LIKE替换=并将' Man% '作为我们想要匹配的。这将查找所有以“Man”开头的团队。%是一个通配符，匹配其后任意数量的字符。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="ed44" class="ls lt iq ns b gy nw nx l ny nz">SELECT name, position, team, GW, total_points, value FROM Players_GWs WHERE team LIKE 'Man%' ORDER BY total_points DESC LIMIT 5</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/b8d27c5a693b7277df4fb858de45af0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KyqX0dEFO3enz2wKIRkyzw.png"/></div></div></figure><h2 id="009e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">分组依据</h2><p id="ffa2" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">到目前为止，我们一直返回单行(每一行代表一个游戏)。如果我们想要查看某个特定团队或玩家在所有游戏周的一些指标的总和，我们可以使用GROUP BY和对total_points执行的SUM函数。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="8c9b" class="ls lt iq ns b gy nw nx l ny nz">SELECT name, team, SUM(total_points) FROM Players_GWs GROUP BY name</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/1d6d0546b2ce307827e0905e1a7046a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIW0rr_nBaNbmU8sa7R_0A.png"/></div></div></figure><p id="0c79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们也可以按多列分组。比方说，我们希望先按团队再按球员进行细分。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="cffd" class="ls lt iq ns b gy nw nx l ny nz">SELECT team, name, SUM(total_points) AS 'overall points' FROM Players_GWs GROUP BY team, name</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/74a999cb3a78a55bd4a82b91978857a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SCpNiqwv4SXAmy7jNNYXBw.png"/></div></div></figure><p id="eac7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在第一组示例中，如果玩家在整个赛季中为不同的球队效力，球队栏将随机显示一个球队。但是第二组可以让我们看到每支球队的得分——因为我们是按球队和球员的名字分组的。</p><h2 id="3e34" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">如同</h2><p id="750e" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">代表所有游戏周中每个玩家点数的列的名称不是最具描述性的。它显示为我们对数据库中的total_points数据执行的函数。我们可以用AS给它起一个更好的名字。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="8129" class="ls lt iq ns b gy nw nx l ny nz">SELECT name, team, SUM(total_points) AS 'overall points' FROM Players_GWs GROUP BY name</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/80943a9b8be3b50770bfdc8a8d04bc69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wW-abnFMp8T4e3eqRRtQ4w.png"/></div></div></figure></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="56e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些是SQL入门的一些基本查询类型。这里，我们只处理一个表中的数据，但是我们可以在另一个表中包含详细的团队信息，然后使用查询从两个表中获取数据。我将在以后的教程中研究这个和更复杂的查询。</p><p id="f945" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如需进一步阅读，请查看位于https://sqlite.org/docs.html的SQLite文档</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="316e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作者拍摄的所有截图。由<a class="ae kv" href="https://unsplash.com/@nathanjayrog?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">内森·罗杰斯</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上做的介绍性图片。</p></div></div>    
</body>
</html>