<html>
<head>
<title>Tracking Aerosol Pollution from Space</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">追踪来自太空的气溶胶污染</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tracking-aerosol-pollution-from-space-8ff53bb64d0f?source=collection_archive---------18-----------------------#2021-11-30">https://towardsdatascience.com/tracking-aerosol-pollution-from-space-8ff53bb64d0f?source=collection_archive---------18-----------------------#2021-11-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a897" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用 Google Earth 引擎提取某地区气溶胶污染的时间序列</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/b8652b3c1722e55008b74471f084cdc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*iw3rVYeMKwSOPNt-xTtatg.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">照片由<a class="ae kr" href="https://unsplash.com/@callmefred?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">在<a class="ae kr" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上叫我弗雷德</a></p></figure><h1 id="57a7" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated">1.介绍</h1><p id="386f" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">如今，在世界许多地方都能经常看到烟雾弥漫的天气。悬浮在空气中的细小固体颗粒通过吸收或散射阳光在造成烟雾条件中起着主要作用。这些粒子被称为气溶胶。气溶胶的来源包括来自工厂的污染、火灾产生的烟雾、风暴产生的灰尘、火山灰等(来源:NASA)。气溶胶可能对人类健康有害。它们还会干扰温度、云的形成和大气循环模式。因此，监测其水平并将其保持在限制范围内是很重要的。</p><p id="d9a6" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">NASA 的 Terra 卫星上的中分辨率成像光谱仪(MODIS)传感器每天跟踪气溶胶光学厚度(AOD)。它是一个无量纲数，与观测位置上方大气垂直柱中的气溶胶量有关。AOD 告诉我们，这些气溶胶粒子阻止了多少阳光直射到地面。值 0.01 对应于非常干净的大气，值 0.4 对应于雾蒙蒙的空气条件。AOD 值大于 1 代表严重污染时大气中气溶胶浓度高。一些自然现象如野火和沙尘暴会导致介于 1 和 3 之间的高 AOD 值。MODIS 传感器报告的最大 AOD 为 4。</p><p id="ce69" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">在这篇博客中，我们将使用谷歌地球引擎(GEE)提取每日 AOD 数据(2000-2020 年),并找出德里市气溶胶污染的严重程度。</p><h1 id="4ead" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated">2.工作流程</h1><p id="a6f3" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">工作流程可以分为三大部分</p><ul class=""><li id="6f79" class="ml mm iq lm b ln mg lq mh lt mn lx mo mb mp mf mq mr ms mt bi translated">使用 GEE 收集 AOD 数据。</li><li id="79b9" class="ml mm iq lm b ln mu lq mv lt mw lx mx mb my mf mq mr ms mt bi translated">将数据作为 pandas dataframe 导入并绘图。</li><li id="2fc9" class="ml mm iq lm b ln mu lq mv lt mw lx mx mb my mf mq mr ms mt bi translated">统计每年严重污染的天数。</li></ul><h1 id="28d4" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated">3.使用 GEE 收集 AOD 数据</h1><p id="a90b" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">我们将从导入相关的库和认证 GEE 开始。</p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="8be7" class="ne kt iq na b gy nf ng l nh ni"># Import relevant libraries<br/>import ee</span><span id="6f67" class="ne kt iq na b gy nj ng l nh ni"># Authenticate GEE and initialize<br/>try:<br/>    ee.Initialize()<br/>except Exception as e:<br/>    ee.Authenticate()<br/>    ee.Initialize()</span></pre><p id="4763" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">接下来，我们导入感兴趣区域(RoI)的矢量 shapefile 和 AOD 的光栅图像。每天的 AOD 值是从收集的不同图像中获得的，这些图像以卫星观察到该位置的日期进行标记。我们定义了一个函数<code class="fe nk nl nm na b">reduce_del</code>,通过对 RoI 内包含的像素值进行平均，将它们减少到一个统计量。然后，该函数被映射到集合中的所有图像上，以导出该区域在所选持续时间内的平均 AOD。然后，生成的时间序列将作为 CSV 文件导出到 Google Drive。</p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="729b" class="ne kt iq na b gy nf ng l nh ni"># Import the boundaries of the region of interest<br/>delhi = ee.FeatureCollection("FAO/GAUL/2015/level1") \<br/>            .filter(ee.Filter.eq('ADM1_NAME','Delhi'))</span><span id="f95e" class="ne kt iq na b gy nj ng l nh ni"># Import the raster data on aerosol concentration and apply regional filters.<br/># It vastly improves run time of the code by reducing the number of images in the collection.<br/>asol = ee.ImageCollection("MODIS/006/MCD19A2_GRANULES")\<br/>        .filterBounds(delhi)\<br/>        .filterDate('2000-01-01', '2020-12-31');</span><span id="2c12" class="ne kt iq na b gy nj ng l nh ni"># Reduce the image data into a statistic for Delhi<br/>def reduce_del(img):<br/>    stat = img.reduceRegion(reducer=ee.Reducer.mean(), geometry=delhi, scale=1000).get('Optical_Depth_047')<br/>    date = img.date().format()<br/>    mydict = {'date': date, 'stat': stat}<br/>    return ee.Feature(None).set(mydict)</span><span id="2e76" class="ne kt iq na b gy nj ng l nh ni"># Convert ImageCollection into FeatureCollection and filter the FeatureCollection keeping only notNull values<br/>reduced_del = ee.FeatureCollection(asol.map(reduce_del)).filter(ee.Filter.notNull(['date','stat']))</span><span id="47b4" class="ne kt iq na b gy nj ng l nh ni"># Code for exporting Delhi AOD data to GDrive as a batch process.<br/>task = ee.batch.Export.table.toDrive(<br/>    collection = reduced_del,<br/>    description = 'aod_stat_del',<br/>    folder = 'satellite',<br/>    fileFormat = 'CSV',<br/>    selectors = ['date','stat']<br/>)</span><span id="7cf5" class="ne kt iq na b gy nj ng l nh ni">task.start()</span></pre><h1 id="caeb" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated">4.将数据作为时间序列导入并绘图</h1><p id="6cbf" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">我们将数据从 Google Drive 下载到本地机器，并使用 Pandas 导入。AOD 值以 0.001 的比例报告。通过将所有值除以 1000，我们将这些值重新调整为 1。由于同一天有多个观察值，我们取它们的平均值来得出每天的单个值。</p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="262b" class="ne kt iq na b gy nf ng l nh ni">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>from scipy import stats<br/>import matplotlib.pyplot as plt</span><span id="fe51" class="ne kt iq na b gy nj ng l nh ni">aerosoldf = pd.read_csv('C:\\Users\\ADMIN\\Desktop\\satellite\\geemap\\data\\aod_stat_del.csv')</span><span id="087f" class="ne kt iq na b gy nj ng l nh ni"># Define a function to transform the dataframe into time series<br/># Rescale AOD values from 0.001 to 1 by dividing the numbers by 1000.<br/># Group the observations by day and take the average AOD value<br/>def tseries(df):<br/>    <br/>    df['date_formatted'] = pd.to_datetime(df['date']).dt.normalize()<br/>    <br/>    df.stat = df.stat/1000<br/>    <br/>    df = df.groupby('date_formatted').agg(mean_stat =    pd.NamedAgg(column = 'stat', aggfunc = 'mean'))<br/>    <br/>    return df</span><span id="430c" class="ne kt iq na b gy nj ng l nh ni">aerosoldf = tseries(aerosoldf)</span><span id="a0dc" class="ne kt iq na b gy nj ng l nh ni"># we create a figure with pyplot and set the dimensions to 15 x 7<br/>fig, ax = plt.subplots(figsize=(15,7))</span><span id="e970" class="ne kt iq na b gy nj ng l nh ni"># we'll create the plot by setting our dataframe to the data argument<br/>ax.plot(aerosoldf.index, aerosoldf.mean_stat)</span><span id="1cbb" class="ne kt iq na b gy nj ng l nh ni"># we'll set the labels and title<br/>ax.set_ylabel('aerosol optical depth',fontsize=20)<br/>ax.set_xlabel('date',fontsize=20)<br/>ax.set_title('Daily Aerosol Optical Depth Delhi (2000 - 2020)',fontsize=20);</span><span id="e80b" class="ne kt iq na b gy nj ng l nh ni">plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nn"><img src="../Images/4beb32b86070101a1a1921e8bfb73ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-tIpToR0H-cfLQxxM6Oe2A.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">AOD 时间序列:作者图片</p></figure><h1 id="4b13" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated">5.数据处理</h1><p id="de48" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">每日时间序列图看起来很乱。我们绘制了大跨度的数据(20 年的每日数据)，目的是验证气候变化的说法。值得注意的是，AOD 值超过 1 的次数在近期有所增加，这意味着严重污染事件的频率有所增加。让我们数一数每年 AOD 大于 1 的天数。</p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="4ae1" class="ne kt iq na b gy nf ng l nh ni"># Retrieve year information from date index<br/>aerosoldf['year'] = aerosoldf.index.year<br/>#Define AOD threshold as 1 <br/>aerosoldf['threshold'] = 1<br/>#Create a binary column which takes value 1 when AOD exceeds threshold and 0 otherwise<br/>aerosoldf['severe'] = np.where(aerosoldf['mean_stat'] &gt; aerosoldf['threshold'], 1,0)</span><span id="987e" class="ne kt iq na b gy nj ng l nh ni">#Group the observations and count the number of days having severe pollution in each year<br/>aerosol = aerosoldf.groupby('year').agg(obs_days = pd.NamedAgg(column = 'severe', aggfunc = 'count'),<br/>                                        severe_days = pd.NamedAgg(column = 'severe', aggfunc = 'sum'))</span><span id="7ee7" class="ne kt iq na b gy nj ng l nh ni"># As the number of observed days are not uniform across years, we calculate the percentage of severe days and multiply by 365 to make it comparable across years</span><span id="453c" class="ne kt iq na b gy nj ng l nh ni">aerosol['severe_days_annual'] = aerosol['severe_days'] / aerosol['obs_days'] * 365<br/>aerosol</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/9584a129bcf52d2da156e070860222b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*kahouv4OPSbnrzDOJaop5w.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">显示每年严重天数的数据框架的前 10 行:作者图片</p></figure><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="4cc3" class="ne kt iq na b gy nf ng l nh ni"># Function to find slope and intercept of trendline<br/>def trendline(df):<br/>    # get coeffs of linear fit<br/>    slope, intercept, r_value, p_value, std_err = stats.linregress(df.index,df['severe_days_annual'])<br/>    <br/>    pct = intercept + slope * df.index<br/>    return(pct)</span><span id="3a3a" class="ne kt iq na b gy nj ng l nh ni">#Plot<br/>fig = plt.figure(figsize=(15,6))</span><span id="422d" class="ne kt iq na b gy nj ng l nh ni">ax = fig.add_subplot(111)</span><span id="45e1" class="ne kt iq na b gy nj ng l nh ni">ax.plot(aerosol.index.astype(int), aerosol.severe_days_annual, linestyle="dashed", marker = 'o')</span><span id="7927" class="ne kt iq na b gy nj ng l nh ni">ax.plot(aerosol.index.astype(int), trendline(aerosol), color = 'red', marker='o')</span><span id="a21a" class="ne kt iq na b gy nj ng l nh ni">ax.set_xticks(range(2000,2021))</span><span id="6b8b" class="ne kt iq na b gy nj ng l nh ni"># we'll set the labels and title<br/>ax.set_title('Number of days with severe aerosol concentration in Delhi',fontsize=20);<br/>plt.grid()<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nt"><img src="../Images/fa73e3a80d0ace6adecc99c615f0f3fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ERTm_f2GZ2X1vAh5JQTclw.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图表显示严重污染事件的频率增加:图片由作者提供</p></figure><h1 id="fffd" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated">6.结论</h1><p id="844a" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">趋势图显示，一年中大约有 4 个月，德里空气受到高水平气溶胶的严重污染。一年中的严重天数从 2000 年的 70 天增加到 2020 年的 110 天。与二十年前相比，严重污染事件的发生频率增加了近 60%。那是惊人的！！这突出表明，由于污染的影响是跨国的，因此需要在国家和国际一级开展有意义的对话并制定行动计划。</p><p id="9335" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">免责声明:本博客表达的观点是个人观点。</p><h1 id="79d0" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated">参考</h1><ul class=""><li id="ec95" class="ml mm iq lm b ln lo lq lr lt nv lx nw mb nx mf mq mr ms mt bi translated"><a class="ae kr" href="https://earthdata.nasa.gov/earth-observation-data/near-real-time/hazards-and-disasters/air-quality" rel="noopener ugc nofollow" target="_blank">https://earth data . NASA . gov/earth-observation-data/near-real-time/hazards-and-disasters/air-quality</a></li><li id="6619" class="ml mm iq lm b ln mu lq mv lt mw lx mx mb my mf mq mr ms mt bi translated">MCD 19 a 2.006:NASA 陆地过程分布式活动档案中心(LP DAAC)发布的 Terra &amp; Aqua MAIAC 陆地气溶胶光学厚度每日 1 公里</li><li id="1a68" class="ml mm iq lm b ln mu lq mv lt mw lx mx mb my mf mq mr ms mt bi translated">吴(2020)。geemap:一个 Python 包，用于与 Google Earth 引擎进行交互式地图绘制。《开放源码软件杂志》，5(51)，2305 页。【https://doi.org/10.21105/joss.02305 T4】</li><li id="aa05" class="ml mm iq lm b ln mu lq mv lt mw lx mx mb my mf mq mr ms mt bi translated">Gorelick，m . Han cher，m . Dixon，m . Ilyushchenko，s .，Thau，d .，&amp; Moore，R. (2017)。谷歌地球引擎:面向所有人的全球地理空间分析。环境遥感。</li></ul></div></div>    
</body>
</html>