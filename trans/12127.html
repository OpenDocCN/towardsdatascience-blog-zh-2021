<html>
<head>
<title>8 SQL Date Functions You Need to Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你需要知道的 8 个 SQL 日期函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/8-sql-date-functions-you-need-to-know-c6c887a8394f?source=collection_archive---------16-----------------------#2021-12-07">https://towardsdatascience.com/8-sql-date-functions-you-need-to-know-c6c887a8394f?source=collection_archive---------16-----------------------#2021-12-07</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><figure class="gl gn jt ju jv jw gh gi paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="gh gi js"><img src="../Images/e75b4820c7d45c216bf317f2b0bda53c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxaY6uLCrZkWSzEKH9ReMQ.jpeg"/></div></div><p class="kd ke gj gh gi kf kg bd b be z dk translated">照片由<a class="ae kh" href="https://unsplash.com/@towfiqu999999?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Towfiqu barbhuiya </a>在<a class="ae kh" href="https://unsplash.com/s/photos/calendars?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="5c22" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">SQL 中有如此多不同的日期函数，很难将它们全部记录下来！然而，它们是一些最方便的函数，尤其是在处理时间序列数据时。</p><p id="7c8d" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">在重建一些核心数据模型时，我遇到了一个以前从未听说过的日期函数。我想可能还有其他人没有听说过这个函数，甚至是我将要提到的一些函数。</p><p id="5f94" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">无论是 SQL 忍者还是初学者，这篇文章都将是在 SQL 代码中使用日期的很好的复习或介绍。</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="116c" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated">Timestampdiff()</h2><p id="3129" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">时间戳确实如其名。它找出两个时间戳之间的差异。</p><p id="b9aa" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这需要不同的参数——一个间隔和两个日期值。</p><p id="1b5f" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">timestampdiff(MONTH, '2021-12-01', '2021-12-31 06:03:15')</code></p><p id="eba3" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">间隔可以是<code class="fe ml mm mn mo b">Month</code>、<code class="fe ml mm mn mo b">Year</code>、<code class="fe ml mm mn mo b">Minute</code>、<code class="fe ml mm mn mo b">Second</code>。</p><p id="7e7f" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong>2<strong class="kk iw">T19】日期或日期时间值(日期自动读取为 00:00:00)和间隔</strong></p><p id="d85d" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输出:</strong>您指定的任意间隔中两个日期之间的时间</p><p id="3fe6" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这个函数对于查找两个 datetime 列之间过去了多长时间非常有用。</p><p id="d86f" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">请注意，从第二个日期值中减去第一个日期值，使其为正数。如果我们交换这两个日期，我们会得到一个负值。</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="13bf" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated">Datediff()</h2><p id="9e72" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">这和之前的函数是一样的，除了现在我们发现的是两个日期之间的差异，而不是两个日期时间戳。</p><p id="d8a1" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这仍然需要不同的参数——一个间隔和两个日期值。</p><p id="cd86" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">datediff(MONTH, '2021-12-01', '2021-12-31 06:03:15')</code></p><p id="5617" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">间隔可以是<code class="fe ml mm mn mo b">Month</code>、<code class="fe ml mm mn mo b">Year</code>、<code class="fe ml mm mn mo b">Minute</code>和<code class="fe ml mm mn mo b">Second</code>。</p><p id="22b4" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong>2<strong class="kk iw">T27】日期或日期时间值(日期时间自动读取为 00:00:00)和间隔</strong></p><p id="5943" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输出:</strong>您指定的任意间隔中两个日期之间的时间</p><p id="14b3" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这个函数的工作方式与另一个几乎相同，但是，这个例子中的时间戳将被读作<code class="fe ml mm mn mo b">2021-12-31 00:00:00</code>，而不是时间<code class="fe ml mm mn mo b">06:03:15</code>。</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="a7d6" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated">月份()</h2><p id="33b0" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">这个函数只是从您输入的日期值中提取月份。</p><p id="97c2" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">month('2021-12-01')</code>返回十二月的值<code class="fe ml mm mn mo b">12</code>。</p><p id="a01f" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong> 1 日期或日期时间值</p><p id="099e" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输出:</strong>从 1 到 12 的月份数</p><p id="ad5c" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">我发现自己在验证数据模型中的数据时经常使用这种方法。我用它来比较同一个月的数据，以确保行数或聚合匹配。</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="a5b5" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated">年份()</h2><p id="b6cb" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">该函数从您输入的日期值中提取年份。</p><p id="7704" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">year('2021-12-01 01:12:45')</code>返回该年的值<code class="fe ml mm mn mo b">2021</code>。</p><p id="2edf" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong> 1 日期或日期时间值</p><p id="995b" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">产量:</strong>年份</p><p id="e59f" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">同样，我经常在模型的数据验证阶段使用它。我将使用它来比较大量的数据，而不仅仅是一个月的数据。</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="d76f" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated">当前日期()</h2><p id="d6d5" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">这将为您提供 SQL 代码运行日期的当前日期。例如，我在 2021 年 12 月 4 日写这篇博文。这个函数将返回<code class="fe ml mm mn mo b">2021-12-04</code>。</p><p id="64c7" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">current_date()</code></p><p id="d776" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong>无</p><p id="8c97" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输出:</strong>一个日期值</p><p id="f5a9" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">该函数有助于计算从某个日期列值开始经过的时间。经常发现自己和<code class="fe ml mm mn mo b">datediff()</code>配合使用。</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="676c" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated">日期添加()</h2><p id="67c5" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">此函数允许您向日期列添加值。您几乎可以向日期列添加任何时间单位。<code class="fe ml mm mn mo b">Hour</code>、<code class="fe ml mm mn mo b">Day</code>、<code class="fe ml mm mn mo b">Week</code>、<code class="fe ml mm mn mo b">Month</code>、<code class="fe ml mm mn mo b">Year</code>恰好是比较流行的几个单位。</p><p id="b406" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">date_add('2021-12-01', INTERVAL 1 WEEK)</code></p><p id="b433" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">该代码将为日期增加一周，成为<code class="fe ml mm mn mo b">2021-12-08</code>。</p><p id="cfe9" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong>日期或日期时间值，数值，时间单位</p><p id="65c6" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输出:</strong>一个日期或日期时间值</p><p id="3e69" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw"> Date_add() </strong>有助于创建日期范围或查找未来的时间值。这是我在 web 会话模型中经常使用的一种方法。</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="4d27" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated"><code class="fe ml mm mn mo b">Cast()</code></h2><p id="c497" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">这是一个经典函数，我几乎在处理日期、日期时间或时间戳的任何时候都会用到。在使用上面提到的任何函数之前，对 SQL 代码中使用的基本列进行操作是很有帮助的。</p><p id="e050" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">Cast('2021-12-01' AS timestampntz)</code></p><p id="1150" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong>任意日期类型的列名</p><p id="2e9f" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输出:</strong>指定日期类型的列名</p><p id="4851" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw"> CAST() </strong>函数有助于创建所有时间值列的一致性。我在我的一个模型中遇到了一个问题，我在使用 timstampnt 值和时间戳值时，没有意识到这会影响我的输出。这个函数节省了铸造的时间值，并给我正确的输出！</p></div><div class="ab cl lg lh hz li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="io ip iq ir is"><h2 id="334f" class="ln lo iv bd lp lq lr dn ls lt lu dp lv kt lw lx ly kx lz ma mb lb mc md me mf bi translated"><code class="fe ml mm mn mo b">Datepart()</code></h2><p id="6432" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">最后，也是最重要的，我自己刚刚学会的最新的 SQL 日期函数！我在重写的一些代码中发现了这个函数，但不知道它有什么作用。经过一番研究，这是我了解到的情况。</p><p id="fa40" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw"> datepart() </strong>函数返回时间值列的指定部分。它类似于<code class="fe ml mm mn mo b">month()</code>和<code class="fe ml mm mn mo b">year()</code>函数，但是允许您选择提取日期的哪一部分。</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="dc76" class="ln lo iv mo b gy mx my l mz na">datepart(year, '2021-12-01')</span></pre><p id="1908" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这段代码将返回<code class="fe ml mm mn mo b">2021</code>作为输出。</p><p id="976a" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输入:</strong>时间单位、日期或日期时间值</p><p id="0726" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><strong class="kk iw">输出:</strong>代表指定时间单位的数值</p><p id="66ee" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe ml mm mn mo b">Datepart()</code>看起来确实比<code class="fe ml mm mn mo b">month()</code>或<code class="fe ml mm mn mo b">year()</code>运行得快一点，所以当在大量数据上运行查询时，这个函数是首选。</p><h1 id="bfd0" class="nb lo iv bd lp nc nd ne ls nf ng nh lv ni nj nk ly nl nm nn mb no np nq me nr bi translated">结论</h1><p id="bb50" class="pw-post-body-paragraph ki kj iv kk b kl mg kn ko kp mh kr ks kt mi kv kw kx mj kz la lb mk ld le lf io bi translated">无论你是 SQL 的初学者还是专家，你都知道一个充满有用数据函数的工具箱。把它们放在你的后口袋里，你就可以准备好处理任何棘手的约会问题。</p><p id="c076" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">正是对细节的关注使一个人成为真正的 SQL 忍者。当您知道多个不同的功能时，您可以选择最适合您的用例的功能。这为您提供了编写代码和运行速度的灵活性。</p><p id="c5ab" class="pw-post-body-paragraph ki kj iv kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">查看<a class="ae kh" rel="noopener" target="_blank" href="/how-to-use-sql-cross-joins-5653fe7d353"> <em class="ns">如何使用 SQL 交叉连接</em> </a>、<a class="ae kh" rel="noopener" target="_blank" href="/how-to-use-sql-window-functions-5d297d29f810"> <em class="ns">如何使用 SQL 窗口函数</em> </a>和<a class="ae kh" rel="noopener" target="_blank" href="/top-skills-to-ace-every-sql-interview-question-33356b08845a"> <em class="ns">如果你正在寻找提高你的 SQL 编码水平的方法，就可以掌握每一个 SQL 面试问题</em> </a>的最高技巧。</p></div></div>    
</body>
</html>