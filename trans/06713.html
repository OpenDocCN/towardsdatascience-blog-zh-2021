<html>
<head>
<title>Get Your Conda Environment to Show in Jupyter Notebooks — the “Easy Way”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让您的Conda环境在Jupyter笔记本电脑上展示——简单的方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/get-your-conda-environment-to-show-in-jupyter-notebooks-the-easy-way-17010b76e874?source=collection_archive---------1-----------------------#2021-06-17">https://towardsdatascience.com/get-your-conda-environment-to-show-in-jupyter-notebooks-the-easy-way-17010b76e874?source=collection_archive---------1-----------------------#2021-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="543f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">(还有一些其他方式……)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d233405289b98c3e062173e1253d6e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sd5_onEpIbRDd3tU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国宇航局在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="5164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我第一次开始使用Jupyter笔记本时，我花了比我愿意承认的更长的时间来弄清楚如何让我的conda环境内核显示在内核列表中。当我成功时，我并不满意，因为我希望它是自动的。像大多数事情一样，一旦你知道怎么做，两者都很简单。</p><p id="01e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面我将展示三种方法，每种方法都最适合特定的场景。</p><h1 id="375b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">方法1:“简单的方法”</h1><p id="d307" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是我的首选方法，因为它简单。新环境会自动出现(只要它们安装了<code class="fe ms mt mu mv b">ipykernel</code>。)</p><blockquote class="mw mx my"><p id="2839" class="kz la mz lb b lc ld ju le lf lg jx lh na lj lk ll nb ln lo lp nc lr ls lt lu im bi translated">在撰写本文时，<code class="fe ms mt mu mv b">nb_conda_kernels</code>还不支持Python 3.9。这只会影响我们的基本环境，我们在任何工作中都不会用到它，对吗？:).您的其他环境可以使用任何Python版本，包括3.9。</p></blockquote><p id="bb26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最初，您的内核列表(在Change kernel下)将只显示您当前的环境。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/2290ea437e78cf9369b2428b0ac5f982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UvijwViDH4AVVSs1ZrDixQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1a46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要让您的其他环境内核自动显示:</p><p id="f5fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.首先，在您的基础环境中安装<code class="fe ms mt mu mv b">nb_conda_kernels</code>。一旦安装完毕，任何从基础环境运行的笔记本都会自动显示任何其他安装了<code class="fe ms mt mu mv b">ipykernel</code>的环境的内核。</p><pre class="kj kk kl km gt ne mv nf ng aw nh bi"><span id="af3e" class="ni lw it mv b gy nj nk l nl nm">(base)$ conda install nb_conda_kernels</span></pre><p id="5d4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.接下来，创建一个新环境。我会叫我的<code class="fe ms mt mu mv b">new-env</code>。如果您已经有了一个想要在Jupyter笔记本上展示的环境，请跳过这一步。</p><pre class="kj kk kl km gt ne mv nf ng aw nh bi"><span id="a7bc" class="ni lw it mv b gy nj nk l nl nm">(base)$ conda create --name new-env</span></pre><p id="904d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.激活您想要在笔记本中使用的环境，并安装<code class="fe ms mt mu mv b">iypkernel</code>。我的环境叫<code class="fe ms mt mu mv b">new-env</code>。如果您已经有了一个环境，用您的环境名称代替<code class="fe ms mt mu mv b">new-env</code></p><pre class="kj kk kl km gt ne mv nf ng aw nh bi"><span id="5d76" class="ni lw it mv b gy nj nk l nl nm">(base)$ conda activate new-env</span><span id="45d3" class="ni lw it mv b gy nn nk l nl nm">(new-env)$ conda install ipykernel</span></pre><p id="daf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.从您的基本环境重新启动Jupyter笔记本电脑，完成。你可以在这里看到我所有安装了ipykernel的环境，包括<code class="fe ms mt mu mv b">new-env</code>都显示出来了。我现在可以随意在它们之间切换。极乐世界。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/8fcbaafb78ca52e49aaa94abe45f28c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XELL6xTQZ-B-CQI88oImzA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="f441" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">方法二:“通常的方式”</h1><p id="6870" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">单独注册您想要在内核列表中显示的每个环境并不难。如果您有许多环境，这可能更好，因为它允许您<strong class="lb iu">注册</strong>和<strong class="lb iu">取消注册</strong>您的环境内核，这有助于保持列表整洁。</p><ol class=""><li id="d07a" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">记下您的环境正在使用的python的位置。一些os/python版本组合引入了一个路径问题，如果你知道它的存在，这个问题很容易解决。</li></ol><pre class="kj kk kl km gt ne mv nx bn ny nz bi"><span id="cc8a" class="oa lw it mv b be ob oc l od nm">(new-env)$ which python<br/>/opt/homebrew/Caskroom/miniforge/base/bin/python &lt;- yours may be different.</span></pre><p id="fe66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.在您的新环境中安装<code class="fe ms mt mu mv b">ipykernel</code></p><pre class="kj kk kl km gt ne mv nx bn ny nz bi"><span id="9f9d" class="oa lw it mv b be ob oc l od nm">(new-env)$ conda install ipykernel</span></pre><p id="a82e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.检查您的python位置。</p><pre class="kj kk kl km gt ne mv nx bn ny nz bi"><span id="90f6" class="oa lw it mv b be ob oc l od nm">(new-env)$which python<br/>/opt/homebrew/Caskroom/miniforge/base/bin/python</span></pre><p id="8203" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果python位置与第一步中的位置不匹配，您需要在继续之前停用并重新激活conda环境。</p><pre class="kj kk kl km gt ne mv nx bn ny nz bi"><span id="5077" class="oa lw it mv b be ob oc l od nm">(new-env)$conda deactivate new-env<br/>(base)$conda activate new-env<br/>(new-env)$which python<br/>/opt/homebrew/Caskroom/miniforge/base/bin/python &lt;- this should match step 1</span></pre><p id="7344" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.使用下面的命令向Jupyter注册内核规范。<code class="fe ms mt mu mv b">--name=</code>参数将为这个环境的内核设置您在Jupyter笔记本上看到的名称(因此您可以随意命名它，但是使用环境的名称可能是明智的)。</p><pre class="kj kk kl km gt ne mv nx bn ny nz bi"><span id="c5ab" class="oa lw it mv b be ob oc l od nm">(new-env)$ipython kernel install --user --name=new-env</span></pre><p id="86a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.现在<code class="fe ms mt mu mv b">new-env</code>将会显示在你的内核列表中(不需要重启Jupyter Notebook——只需要在你的浏览器中重新加载页面)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/516216c619883bfac4f4f01a621e03a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25KWrO8pDtVUN__inp5mCA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9a5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.当您想要取消注册内核规范(从可用内核列表中删除环境内核)时，使用以下命令:</p><pre class="kj kk kl km gt ne mv nx bn ny nz bi"><span id="8481" class="oa lw it mv b be ob oc l od nm">$jupyter kernelspec uninstall new-env</span></pre><h1 id="0f2a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">方法三:“快速肮脏的方法”</strong></h1><p id="73bc" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个方法实际上并没有让你的环境在Jupyter笔记本上显示出来，但是值得注意。如果你在任何环境中安装<code class="fe ms mt mu mv b">jupyter</code>并从该环境中运行<code class="fe ms mt mu mv b">jupyter notebook</code>，笔记本将使用活动环境中的内核。内核将以默认名称<code class="fe ms mt mu mv b">Python 3</code>显示，但是我们可以通过执行以下操作来验证这一点。</p><ol class=""><li id="9e2f" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">激活您的环境，安装<code class="fe ms mt mu mv b">jupyter</code>，运行<code class="fe ms mt mu mv b">jupyer notebook</code>。</li></ol><pre class="kj kk kl km gt ne mv nf ng aw nh bi"><span id="2a75" class="ni lw it mv b gy nj nk l nl nm">(base)$ conda activate new-env<br/>(new_env)$ conda install jupyter<br/>(new_env)$ jupyter notebook</span></pre><p id="b6e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.在您的笔记本中运行以下代码，以确认您使用的是正确的内核</p><pre class="kj kk kl km gt ne mv nf ng aw nh bi"><span id="4553" class="ni lw it mv b gy nj nk l nl nm">import os<br/>print (os.environ['CONDA_DEFAULT_ENV'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/536c497f9939404db29b052b688c8eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*djxqDxEZf0LebosTufvfqw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="c105" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="c885" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">最后，你如何选择在Jupyter Notebook中与你的内核交互应该基于你的特殊需求，而不是缺乏关于你的选择的信息。希望这篇文章有助于消除后面的。</p><p id="2769" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">去做好事吧。</p><h2 id="bd1f" class="ni lw it bd lx oe of dn mb og oh dp mf li oi oj mh lm ok ol mj lq om on ml oo bi translated">参考资料:</h2><p id="b06a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我觉得这个栈溢出答案的评分不够高(去投上一票吧，以示对<a class="ae ky" href="https://stackoverflow.com/users/859591/lumbric" rel="noopener ugc nofollow" target="_blank"> lumbric </a>贴上回答自己问题的答案的一点爱)。这是我对这个主题最初理解的基础。</p><div class="op oq gp gr or os"><a href="https://stackoverflow.com/questions/58068818/how-to-use-jupyter-notebooks-in-a-conda-environment" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">如何在康达环境下使用Jupyter笔记本？</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">免责声明:仅在Ubuntu和Windows中测试(见本回答的评论)，如果有变化请评论…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">stackoverflow.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg ks os"/></div></div></a></div></div></div>    
</body>
</html>