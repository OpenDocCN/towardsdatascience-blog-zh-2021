<html>
<head>
<title>Advanced forecasting using Bayesian diffusion modeling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用贝叶斯扩散模型的高级预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/advanced-forecasting-using-bayesian-diffusion-modeling-b155a3dc1d84?source=collection_archive---------8-----------------------#2021-04-13">https://towardsdatascience.com/advanced-forecasting-using-bayesian-diffusion-modeling-b155a3dc1d84?source=collection_archive---------8-----------------------#2021-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="ccf7" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">行业笔记</a></h2><div class=""/><div class=""><h2 id="c642" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated"><strong class="ak">在数据科学的所有领域，对旨在预测和阐明动态现象的创新建模解决方案有着巨大的需求</strong>。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3879b722be363dfb9df093f7dd9d36e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hGuAo6SLnObQPZgICSwPtA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图一。绿色、蓝色=原始数据，粉色=选定的拟合值，黑色=从23到25的时间预测，灰色= 95%贝叶斯后验预测区间。图片作者。</p></figure><p id="a2b7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">动态现象建模和预测的高姿态用例包括:</p><ul class=""><li id="8e8c" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated"><strong class="lg ja">金融</strong> —预测股价走势或商品价格波动</li><li id="b6d6" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated"><strong class="lg ja">生物医学</strong> —预测生物轨迹，例如生长、进化、药物治疗影响的确定</li><li id="300d" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated"><strong class="lg ja">流行病学</strong> —评估疫苗接种等干预策略对传染病流行的影响，例如新冠肺炎</li><li id="bdfc" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated"><strong class="lg ja">能源</strong> —预测风力或波浪涡轮机的输出，电力需求预测</li><li id="0003" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated"><strong class="lg ja">制造</strong> —优化连续工业过程的输出，如食品生产中的蒸发</li></ul><p id="4a37" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">机器学习方法</strong>，例如<a class="ae mo" href="https://en.wikipedia.org/wiki/Long_short-term_memory" rel="noopener ugc nofollow" target="_blank"> LSTM网络</a>或<a class="ae mo" href="https://en.wikipedia.org/wiki/Random_forest#:~:text=Random%20forests%20or%20random%20decision,average%20prediction%20(regression)%20of%20the" rel="noopener ugc nofollow" target="_blank">随机森林</a>，已经被用于解决这些和类似的问题，但是这些方法并非没有<a class="ae mo" rel="noopener" target="_blank" href="/how-not-to-use-machine-learning-for-time-series-forecasting-avoiding-the-pitfalls-19f9d7adf424">挑战</a>。本文介绍了一种不同的建模方法——<strong class="lg ja">贝叶斯扩散建模</strong>——这是一种白盒方法，仅使用几个参数就能够实现丰富的动态行为。这种方法有些先进，至少在数学意义上是如此，因为扩散过程涉及随机微积分，但是使用现有的R/Python/Julia库，加上一些编程知识，以及以前接触过的一点贝叶斯推理，现实世界的应用可能相对容易。</p><p id="561a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">一个端到端的例子展示了贝叶斯扩散模型应用于开源数据集。使用了<a class="ae mo" href="https://www.r-project.org/" rel="noopener ugc nofollow" target="_blank"> R </a>，特别是<a class="ae mo" href="https://r-nimble.org/" rel="noopener ugc nofollow" target="_blank"> R-nimble </a>库，但是建模同样可以在Python中使用例如<a class="ae mo" href="https://mc-stan.org/" rel="noopener ugc nofollow" target="_blank"> Stan </a>或<a class="ae mo" href="https://www.tensorflow.org/probability/overview" rel="noopener ugc nofollow" target="_blank"> Tensorflow probability </a>来实现。R-nimble是一个通用计算框架，在google groups上有一个活跃的社区。</p><p id="3953" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">希望这个简短的案例研究能激发人们对这种丰富而优雅的方法论的兴趣。它不是新的，但也不是许多数据科学家建模工具箱的一部分，可能是一个有价值的补充。特别是对于预测和预测用例，因为这是一种连续时间方法，所以处理不规则间隔的数据是内置的，这在其他方法中建模序列相关性方面可能相当困难。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="98ca" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">1.贝叶斯扩散建模—构建模块</h1><p id="8bd3" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">贝叶斯扩散建模由两个关键构件组成:</p><p id="5a79" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">第一步，</p><ul class=""><li id="a489" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated"><strong class="lg ja">定义一个随机过程</strong> <strong class="lg ja">使得</strong> <strong class="lg ja">足够灵活来描述感兴趣的动态现象</strong>——这被封装在一个<strong class="lg ja">随机微分方程</strong> (SDE)中。<strong class="lg ja">存在许多标准配方。</strong></li></ul><p id="5ee9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">第二步，</p><ul class=""><li id="44ed" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated"><strong class="lg ja">使用马尔可夫链蒙特卡罗(MCMC)</strong><strong class="lg ja"/>模拟，从数据中估计步骤1的SDE中的参数 <strong class="lg ja">，如果适用，包括解决测量误差和分层随机效应结构等复杂性所需的附加参数。</strong></li></ul><p id="8f8d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">随机微分方程是一种高度灵活和简洁的描述动态现象的方法，广泛应用于<a class="ae mo" href="https://www.quantstart.com/articles/Stochastic-Differential-Equations/" rel="noopener ugc nofollow" target="_blank">量化金融</a>，在<a class="ae mo" href="https://pubmed.ncbi.nlm.nih.gov/33490877/" rel="noopener ugc nofollow" target="_blank">医学</a>和<a class="ae mo" href="https://onlinelibrary.wiley.com/doi/full/10.1002/we.1988" rel="noopener ugc nofollow" target="_blank">能源</a>中有一些例子。可以使用MCMC从数据中估计模型的参数，MCMC虽然计算量大，但是容易获得，并且具有无论模型复杂程度如何都几乎普遍适用的显著优势。<strong class="lg ja">结合这两种方法给出了贝叶斯扩散建模</strong>。</p><p id="1d76" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下面给出的用例示例有所简化，以使其尽可能容易理解，但是在更现实的情况下会出现相同的建模步骤。主要区别在于，这里的模型公式是先验选择的，而实际上，这应该由某种形式的模型选择过程来决定，以确保在给定可用数据的情况下，选择的模型是最佳参数化的。</p><h1 id="209f" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">2.预测癌症肿瘤增长——案例研究</h1><p id="28dd" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">这包括三个部分:</p><ol class=""><li id="c0ca" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz ny mg mh mi bi translated"><strong class="lg ja">数据；</strong></li><li id="a594" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz ny mg mh mi bi translated"><strong class="lg ja">型号</strong> <strong class="lg ja">配方</strong>；</li><li id="70f3" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz ny mg mh mi bi translated"><strong class="lg ja">模型拟合和预测</strong>。</li></ol><p id="57e0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下面提供了关键的建模代码片段作为要点。完整的数据集可从作者的<a class="ae mo" href="https://github.com/fraseriainlewis/towardsdatascience" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>获得，以及重现结果和图表所需的完整代码。</p><h1 id="827d" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">2.1数据</h1><p id="3430" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">数据包括乳腺癌肿瘤的单一生长轨迹，这些数据的片段在下面的要点中给出。原始数据在Zenodo <a class="ae mo" href="https://zenodo.org/record/3574531#.YGmSJjHisuU" rel="noopener ugc nofollow" target="_blank">这里</a>中可用，但由于它们仅由23天内的15个时间点组成，模拟用于生成更密集的采样数据集，在同一时间段内给出n=231而不是n=15。使用了几种不同的模拟数据集。关于数据格式需要特别注意的一点是，每一行都是一个过渡，即开始时间(时间1)、停止时间(时间2)以及起点(观察1)和终点(观察2)。这种格式是为了匹配如何指定模型可能性(见下文)。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nz oa l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">要点1。数据片段。作者的GitHub上有完整的数据集(链接见正文)</p></figure><h1 id="9b0a" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">2.2模型制定</h1><p id="94d8" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">贝叶斯扩散从概率上描述了一个过程如何从一个给定的起始位置，例如(时间1，观察值1)发展到一个较晚的位置(时间2，观察值2)。这个过程用随机微分方程(SDE)来描述。下面的等式1给出了为该案例研究选择的SDE。它是众所周知的<a class="ae mo" href="https://en.wikipedia.org/wiki/Gompertz_function" rel="noopener ugc nofollow" target="_blank"> Gompertz函数</a>的随机形式，这里选择它是因为Gompertz模型已经被用于癌症肿瘤生长的建模(例如，参见这个<a class="ae mo" href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1007178" rel="noopener ugc nofollow" target="_blank">出版物</a>)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7436deaf6ceae1ccb62009db658233e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*0OtOFng-CMG3NWh-vlehYQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">等式1。Gompertz函数的随机微分方程。图片作者。</p></figure><p id="ab8a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在等式1中，dt项之前的乘法因子被称为<strong class="lg ja">漂移</strong>，dW之前的项被称为<strong class="lg ja">扩散</strong>。dW是一个布朗运动过程(或<a class="ae mo" href="https://en.wikipedia.org/wiki/Wiener_process" rel="noopener ugc nofollow" target="_blank"> Wiener过程</a>，因此dW中的“W ”),它不断干扰过程X(t)随时间的演化。特别考虑到肿瘤的生长，考虑到在任何复杂的动态生物系统中发生的自然涨落，例如由于肿瘤和其他生物体之间对必需营养物的竞争，这种扰动在直觉上是合理的。</p><p id="c5e0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在这个例子中，类似Gompertz的SDE是一个合理的先验选择。有许多标准的SDE模型，大多最初在金融建模环境中使用或开发。例如，<a class="ae mo" href="https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process" rel="noopener ugc nofollow" target="_blank">奥恩斯坦-乌伦贝克模型</a>是一个均值回复过程，以及<a class="ae mo" href="https://en.wikipedia.org/wiki/Vasicek_model" rel="noopener ugc nofollow" target="_blank">瓦西切克模型</a>是为利率建模而开发的。一般来说，SDE可以有任何漂移和扩散项，包括明确依赖于时间t。多项式形式的漂移已在生物应用中用于模拟儿童生长轨迹(见<a class="ae mo" href="https://gatesopenresearch.org/articles/4-71" rel="noopener ugc nofollow" target="_blank">此处</a>)。也就是说，一个主要的实际警告是，SDE需要有一个易处理的切片密度(见下文),因此漂移和扩散项的选择通常要考虑到这一点。</p><p id="5564" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">对等式1中的模型的最后一点说明是，扩散过程(dW)由X(t)缩放。这是一种方便的方法，以确保扩散过程不会干扰整个过程到导致X(t)为负值的程度，这在这里没有生物学意义，因为X(t)是肿瘤的大小。</p><h1 id="b8db" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">2.3使用MCMC的模型拟合</h1><p id="6c4a" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">为了理解如何使用SDE模型，可能有必要更详细地查看完整示例的代码。以下是要点的一个片段，但首先有必要完成等式1中模型的规范，并通过以下方式确定其可能性:</p><ol class=""><li id="4747" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz ny mg mh mi bi translated">确定SDE的<strong class="lg ja">切片密度</strong>(也称为转移概率密度)，以及</li><li id="d4d4" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz ny mg mh mi bi translated">定义模型中需要的任何<strong class="lg ja">额外复杂性</strong>，例如测量或观察误差。</li></ol><h1 id="4b3c" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">2.3.1 SDE切片密度推导</h1><p id="e127" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">使用<a class="ae mo" href="https://www.wolfram.com/resources/" rel="noopener ugc nofollow" target="_blank"> Wolfram语言沙箱</a>(不需要登录)或者直接在Mathematica或Wolfram引擎(对开发者免费)中从等式1很容易得出切片密度。参见图2，该图显示了如何在等式1中计算SDE的切片密度。这将在R-nimble后期的MCMC代码中使用。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/960957e26e0c04c192f5f97e8896bb25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lU8xrB326yQ32xichBSy2w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图二。切片密度计算。图片作者。</p></figure><p id="c129" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">切片密度定义了模型(随机过程)在未来通过特定点的可能性，这是基于对过程当前状态的了解。因此，该密度函数描述了任意两个时间点之间模型的所有路径或实现的概率“切片”。在图2中，还计算了对数切片密度的表达式，这是R-nimble模型规范所需要的。</p><h1 id="325c" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">2 . 3 . 2 MCMC中的附加模型特征</h1><p id="feff" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">任何给定数据集的最佳模型可能仅包含SDE-漂移和扩散部分，但是，通常还会希望在模型中包含额外的随机误差分量，例如独立同分布(iid)正态误差。这将考虑测量误差，例如，假设用于测量肿瘤体积的仪器遭受小的但不可忽略的测量误差。这将对应于iid正常误差，以及潜在动力系统中存在的随机可变性。</p><p id="ddae" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">测量误差包含在以下要点给出的模型中。请注意，通过包括这种形式的额外随机误差，正在建模的动态现象现在仅被潜在地观察到——实际观察到的是Y(t) = X(t) + Z(t)，其中X(t)是真实的肿瘤生长，Z(t)是测量误差(比如说)。</p><h1 id="41d1" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">2 . 3 . 3 R-nimble中的模型公式</h1><p id="385b" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">下面的要点包含在R-nimble中定义贝叶斯扩散模型(带有测量误差)的关键代码片段。完整的代码可在<a class="ae mo" href="https://github.com/fraseriainlewis/towardsdatascience" rel="noopener ugc nofollow" target="_blank">这里</a>获得。一些评论:</p><ul class=""><li id="c1df" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">完整的代码使用CRAN <strong class="lg ja">并行</strong>库来提高效率，这稍微增加了复杂性(主要的建模代码需要打包到一个函数中)</li><li id="d6f3" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">定义<strong class="lg ja"/><strong class="lg ja">自定义概率分布</strong>对于切片密度来说是必要的，这很简单——参见R-nimble手册</li><li id="61a1" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">要生成预测值/拟合值，输入数据集需要包含带有NA的虚拟记录，以便对预测值/拟合值进行估计</li><li id="b57f" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">按照目前的编码，完整的MCMC估计需要在8个内核(英特尔至强2.2 Ghz)上花费60分钟，因此需要一些耐心(或者如果只是调试，则减少链的长度)。</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nz oa l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">要点2。模型代码段。GitHub上有完整的代码(链接见正文)。</p></figure><p id="4e2b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了完整起见，来自完整代码运行的R会话信息是:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/ad7c4a50f02d6312d82c007c45fd2ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTimS_FNDAfLHvPtwn920Q.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图三。r会话信息。图片作者。</p></figure><h1 id="7c57" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">结果</h1><p id="4dc8" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">使用等式1中给出的Gompertz公式(加上根据上述要点添加的iid正态误差)的贝叶斯扩散模型适合两个不同的数据集。每个数据集由n=231个数据点组成，是原始癌症肿瘤数据集的不同实现(参见第2.1节)。图4和图5显示了使用模型的预测及其相关的不确定性，以及说明模型拟合的拟合值子集。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/7e377372d34a8f0789710de176bdd939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YB1pwXoYmJEZTtwkQ2cTKQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图4。绿色=原始数据，粉色=一些拟合值，黑色=从时间=23到25的预测，灰色= 95%贝叶斯后验预测区间。图片作者。</p></figure><p id="2b33" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">图4中的结果看起来直观合理——特别是对于这样一个简单的模型，Gompertz只有两个参数——并且拟合值接近观察值。这些预测看起来也很合理，表现也像预测应该表现的那样，预测的未来越远，不确定性就越大。请注意，这些是<strong class="lg ja">贝叶斯后验预测</strong> <strong class="lg ja">预测</strong>，即来自后验预测分布的分位数，因此预测周围的不确定性估计也包括参数估计不确定性(与根据单个参数估计集进行预测相反，这是非贝叶斯建模中的典型情况)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/56b9e6c9ad4606964066a7c7124cf71b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A9Q7Y8-rV1iYbGmMMEsqRA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图五。蓝色=原始数据，粉色=一些拟合值，黑色=从时间=23到25的预测，灰色= 95%贝叶斯后验预测区间。图片作者。</p></figure><p id="5d35" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">图5与图4相似，因为拟合值和预测的结果看起来都很合理。该轨迹的定性行为与图4中的截然不同，在图4中，肿瘤的生长最初呈线性增长，然后趋于平稳。这里使用了相同形式的随机Gompertz模型，但是参数估计值非常不同，反映了数据的不同形状。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="c1e6" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">3.贝叶斯扩散建模—构建模型</h1><p id="ebfd" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">与任何建模方法一样，真正的技巧通常是如何构建和参数化模型，以便它对于特定的问题或数据集是最佳的(至少在某种意义上)。这对于贝叶斯扩散模型来说尤其如此，因为既有SDE公式本身，又有MCMC公式，它们中的每一个都可以定制。以下两节包含一些关于使用SDE构建模型的一般性建议和备注。</p><h1 id="0493" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated"><strong class="ak"> <em class="oe"> 3.1通用SDE公式</em> </strong></h1><p id="247c" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">第2节展示了基于Gompertz公式的贝叶斯扩散模型的应用。还有许多其他的可能性，例如等式2示出了在漂移项中是线性的，但也明显依赖于时间的SDE。图6显示了如何在等式2中计算SDE的对数切片密度。同样，这是一个相对简单的过程(因为Mathematica在这里做了所有困难的工作！).</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f17f2421a368ed854be9f6494dfdb7a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*rOMA6Er-upQGdUydL_OAxg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">等式2。SDE的多项式形式。图片作者。</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/7a4d0b6769693b02125f709e45711857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gKbpxnjHBU92QZ7MqVTEtg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图六。多项式SDE的切片密度估计。图片作者。</p></figure><h1 id="9707" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">3.2.转换和嵌套</h1><p id="b12d" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">布朗运动对动态过程的扰动假设被建模的过程可以增加和减少，这对于上面的肿瘤例子是合适的。然而，对于一些动态现象，扩散实际上只能在一个方向上发生。一个很好的例子是身高，儿童/动物/植物的身高增长是一个非递减的过程——身高增长可能会放缓或停止，但实体不会(至少通常)变小。这个问题的解决方案不是直接用SDE/扩散模型来模拟动态过程，而是将扩散模型结合到模型的参数中，该模型确实实施非递减行为，</p><ul class=""><li id="a18d" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">考虑增长模型<strong class="lg ja">Y(t)= a+b X(t)+c X(t)</strong>——一个简单的多项式回归。现在，如果对一个非递减过程建模，那么只需包括参数的变换，例如</li><li id="292a" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated"><strong class="lg ja">Y(t)= exp(a)+exp(b)X(t)+exp(c)X(t)</strong>—这现在是一个非线性模型，这对于MCMC估计来说不是问题，它强制模型无论a，b，c取正值还是负值都是非递减的。</li></ul><p id="f0d3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果被建模的过程是动态的，那么假设参数a、b和c随时间是静态的可能是不现实的，或者至少在模型选择过程中应该考虑这种可能性。为了允许回归参数随时间随机波动，可以使用贝叶斯扩散对这些参数单独或联合建模，例如参见等式3，</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/d93b61a6f4eea0aa8a1b225b8a9ce103.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*NlqIFedxQnKjAXBN32nB7w.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">等式3。带有漂移参数ω的回归模型中参数“a”的简单SDE。图片作者。</p></figure><p id="da5a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果希望回归参数随时间相互关联，则可以将它们参数化为联合漂移和扩散过程(这将涉及SDEs系统和多个布朗运动过程)。这种方法可以提供极其丰富的建模框架。</p><h1 id="187d" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">3.3易加工性</h1><p id="d3d9" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">建模时的一个实际考虑是易处理性。从数学上来说，SDE一般不易于分析，因此需要选择一个公式，它具有封闭形式的切片密度。严格地说，这是不正确的，因为有可能用数字来估计切片密度。可以使用模拟，有很多<a class="ae mo" href="https://cran.r-project.org/web/packages/Sim.DiffProc/vignettes/snssde.html" rel="noopener ugc nofollow" target="_blank"> SDE模拟库</a>可供R使用，也有<a class="ae mo" href="https://diffeq.sciml.ai/stable/tutorials/sde_example/" rel="noopener ugc nofollow" target="_blank">茱莉亚</a>，或者通过数值求解<a class="ae mo" href="https://en.wikipedia.org/wiki/Fokker%E2%80%93Planck_equation" rel="noopener ugc nofollow" target="_blank">福克-普朗克</a>方程。但是这两种方法在技术和计算上都需要相当大的努力，因为这也需要嵌套在MCMC采样过程中。</p><h1 id="4671" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">4.结束语</h1><p id="497d" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">本文简要介绍了贝叶斯扩散建模，并希望证明它可以成为解决具有挑战性的预测问题的有力工具。学习如何将贝叶斯扩散模型应用于实际问题的最佳方式是通过一个端到端的编码示例。这可以在GitHub <a class="ae mo" href="https://github.com/fraseriainlewis/towardsdatascience" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="9323" class="mw mx iq bd my mz nt nb nc nd nu nf ng kf nv kg ni ki nw kj nk kl nx km nm nn bi translated">关于作者</h1><p id="4994" class="pw-post-body-paragraph le lf iq lg b lh no ka lj lk np kd lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">这是<a class="ae mo" href="https://www.linkedin.com/in/fraser-lewis-819a5080/" rel="noopener ugc nofollow" target="_blank">我</a>，我在<a class="ae mo" href="https://www.danone.com/" rel="noopener ugc nofollow" target="_blank">达能</a>的研发数据科学部门工作，在那里我管理着一个庞大的数据科学家团队，我也很幸运地做了一些建模工作。</p></div></div>    
</body>
</html>