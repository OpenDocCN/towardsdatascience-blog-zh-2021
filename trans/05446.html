<html>
<head>
<title>Automate Google Sheet Reporting in 5 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5分钟内自动完成谷歌表单报告</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-google-sheet-reporting-in-5-minutes-8bbdc1f8e293?source=collection_archive---------6-----------------------#2021-05-14">https://towardsdatascience.com/automate-google-sheet-reporting-in-5-minutes-8bbdc1f8e293?source=collection_archive---------6-----------------------#2021-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c926" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">每月自动将报告发送给你的老板，无需担心</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4f8cffc974ca3a35654b186fac7088b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*23SxxmgyoNUFMKm6"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由来自<a class="ae ky" href="https://www.pexels.com/photo/macbook-pro-beside-wine-glass-on-brown-wooden-table-4099298/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae ky" href="https://www.pexels.com/@taryn-elliott?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">塔林·埃利奥特</a>拍摄</p></figure><p id="801c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您是否曾经使用google sheets收集数据，与您组织中的每个人共享这些数据，以便输入他们的每周、每月数据，如绩效报告、库存报告或KPI数据报告？之后，你将不得不每月提取数据来进行编译。</p><p id="65f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果这些重复的行为可以自动化，并且最终报告可以每月通过电子邮件发送给相关人员(比如你的老板)，那该有多好？是的，这篇文章可以帮助你实现这个目标！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/abe627277a1f2de6fcdabdf7c7781698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*82qEZtTu8GgwuBI-ZC-Piw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自动化流程的图示。作者图片</p></figure><p id="5070" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="lw">场景:贵公司希望每月有一定数量的客户在贵公司的40多家零售店中查询特定产品的信息。</em> </strong></p><h1 id="b1cb" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">1.数据收集和报告生成</h1><p id="cc1b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">根据您的偏好设置您的数据收集表，例如，下图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/88778845062e0c088f65b4de52623cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vILMvPggQVUVrFqDIN9VZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据收集电子表格。作者图片</p></figure><p id="7a69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，最后一行是用户输入的最新数据，它是使用google sheet公式捕获的，如下所示:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="38ef" class="na ly it mw b gy nb nc l nd ne">=INDEX(B1:B13,Max(MATCH("zzz",B1:B13),Match(143^143,B1:B13)))</span></pre><p id="a98a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此公式自动捕获用户在特定区域(在本例中为列)的最新输入，公式中的数据用于绘制下图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/c46b30e8ac5842ac192985fab5b2cd02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*q8a71Fyw8zBQgU44LCPkHQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">报告中所需的图表。作者图片</p></figure><p id="19ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一步结束时，您已经有了最新的报告和每月报告的图表。</p><h1 id="157e" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">2.设置Google应用程序脚本</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/94c44fdae00b236936d841f257764d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*lp4fReMyIJJvrcAXail1PQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置Google企业应用套件脚本。作者图片</p></figure><p id="ddd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进入<em class="lw">工具</em> → <em class="lw">脚本编辑器</em>打开并授权Google Apps脚本，你会注意到一个名为Code.gs的文件在你屏幕的左侧，代码区在你屏幕的右侧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/14e73e42cf773683ec9977a553dbc29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85WVkDG8Bc2B5JqkNcmAYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Google Apps脚本的接口。作者图片</p></figure><p id="62ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将以下代码粘贴到内部:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="bf81" class="na ly it mw b gy nb nc l nd ne">function sendEmails() {</span><span id="661b" class="na ly it mw b gy ni nc l nd ne">// Get the sheet where the data is, in sheet 'system'<br/>var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1")</span><span id="dc7f" class="na ly it mw b gy ni nc l nd ne">// Get the data of particular cell, in this case, i need only the total cell (F14)<br/>var data = sheet.getRange('F14').getValues();</span><span id="3345" class="na ly it mw b gy ni nc l nd ne">// Get all the chart in the sheets<br/>const chartBlobs = new Array();<br/>const emailImages = {};<br/>const charts = sheet.getCharts();<br/>charts.forEach(function(chart, i){<br/>chartBlobs[i] = chart.getAs("image/png");<br/>emailImages["chart"+i] = chartBlobs[i];<br/>});</span><span id="78ea" class="na ly it mw b gy ni nc l nd ne">// Send email<br/>MailApp.sendEmail({<br/>to: "you@gmail.com,"yourboss@gmail.com"",<br/>subject: "Customer Enquiries as of " + new Date(),<br/>htmlBody: "Customer Enquiries Data: &lt;br&gt;" +<br/>"Total: " + data + "&lt;br&gt;",<br/>inlineImages:emailImages<br/>});<br/>}</span></pre><p id="9731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过保存并单击顶部的Run按钮来测试代码。您将收到一封电子邮件，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/98080e205811a1e2710c49941fd075da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*5sdd6RjZRsq_O3YlHalOKg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">电子邮件报告。作者图片</p></figure><p id="496c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您的偏好定制您的报告，并使其符合您组织的格式。</p><h1 id="f3a3" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">3.安排每月电子邮件</h1><p id="caf7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">太好了，现在你有一个很好的报告生成功能，可以在你按下时触发。接下来，我们将设置爆破功能的触发器。Google App Script根据用户需求提供了几种类型的触发器，分别是:</p><ul class=""><li id="e6c9" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated">事件驱动，如表单被编辑、打开或表单提交</li><li id="35c0" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">时间驱动、每小时、每周或每月</li><li id="8bb7" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">按日期排列的日历</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/f1eb20dcb242c786a81f8b476719ba5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OZZbEy_uqSEd-C0mF7ka1w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">功能触发。作者图片</p></figure><p id="9ffa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的情况下，我希望有一个每月计时器，它将在每月6日自动触发该功能(如下图)，因为我已经告诉所有分行经理在每月4日前更新信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/134f7ad6ab650308c810d1ef9cc48f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*2_mVdtJlPXypCG5NHHiowA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置我的每月功能触发器。作者图片</p></figure><p id="63b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，保存触发器，你就有了你的自动邮件报告系统，它将在5分钟内每月发送给你的老板，而不需要任何额外的步骤！</p><p id="d69e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/geekculture/never-miss-your-customers-birthday-email-with-google-sheets-d64e75372341" rel="noopener">https://medium . com/geek culture/never-miss-your-customers-birthday-email-with Google-sheets-d64e 75372341</a></p><h1 id="a23e" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">最后的话:</h1><p id="3f36" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我经常发现，由于缺乏知识，在大多数组织中，资源被花费在可以自动化的任务上。因此，我决定在接下来的文章中写更多对组织有益的生产力技巧，这将包括使用多种编码语言，如pythons和Google Apps脚本。</p><p id="8e20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的其他生产力文章:</p><div class="oa ob gp gr oc od"><a href="https://medium.com/geekculture/never-miss-your-customers-birthday-email-with-google-sheets-d64e75372341" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">使用Google Sheets在5分钟内自动向客户发送生日电子邮件</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">一个简单的5分钟设置，自动向您的客户发送生日祝福电子邮件，每年都不会错过</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><p id="bd82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，感谢您花时间阅读我的文章！</p></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><h1 id="8fc6" class="lx ly it bd lz ma oz mc md me pa mg mh jz pb ka mj kc pc kd ml kf pd kg mn mo bi translated">参考资料:</h1><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/automate-excel-with-python-7c0e8c7c6256"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">使用Python自动化Excel</h2><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="pe l oo op oq om or ks od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://aryanirani123.medium.com/send-charts-in-email-using-google-apps-script-d652dc752468" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">使用Google Apps脚本通过电子邮件发送图表</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">欢迎，在这篇博客中，我将向你展示如何使用谷歌应用程序脚本在电子邮件中发送图表。在…上发送图表</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">aryanirani123.medium.com</p></div></div><div class="om l"><div class="pf l oo op oq om or ks od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://www.benlcollins.com/apps-script/google-apps-script-beginner-guide/" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">谷歌应用程序脚本:学习应用程序脚本的初学者指南</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">Google Apps Script是一种基于云的脚本语言，用于扩展Google Apps的功能和构建…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">www.benlcollins.com</p></div></div><div class="om l"><div class="pg l oo op oq om or ks od"/></div></div></a></div></div></div>    
</body>
</html>