<html>
<head>
<title>The Post-Modern Stack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">后现代堆栈</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-post-modern-stack-993ec3b044c1?source=collection_archive---------21-----------------------#2021-09-22">https://towardsdatascience.com/the-post-modern-stack-993ec3b044c1?source=collection_archive---------21-----------------------#2021-09-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="a19d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/mlops-without-much-ops" rel="noopener" target="_blank">在启动阶段有效地进行ML</a></h2><div class=""/><div class=""><h2 id="c2b3" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">连接现代数据堆栈和现代ML堆栈</h2></div><h2 id="69ec" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated"><strong class="ak">概述</strong></h2><p id="5175" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi mc translated"><span class="l md me mf bm mg mh mi mj mk di">随着</span>天下没有不散的宴席，我们已经到了这个系列的最后一集，一个全新的<a class="ae ml" href="https://github.com/jacopotagliabue/post-modern-stack" rel="noopener ugc nofollow" target="_blank">开源回购</a>汇集了我们在前几集讨论的许多主题，在开始之前我们在这里回顾一下:</p><ol class=""><li id="3e4f" class="mm mn iq ll b lm mo lp mp kx mq lb mr lf ms mb mt mu mv mw bi translated"><a class="ae ml" rel="noopener" target="_blank" href="/mlops-without-much-ops-d17f502f76e8">m lops without more Ops</a>:我们引入了关注重要事物的原则；</li><li id="a2ac" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb mt mu mv mw bi translated"><a class="ae ml" rel="noopener" target="_blank" href="/ml-and-mlops-at-a-reasonable-scale-31d2c0782d9c">合理规模的ML和m lops</a>:这里我们解释“合理规模”。在科技巨头的行星级基础设施和无代码场景之间，有一个复杂的从业者的令人兴奋的工作世界:我们称之为“合理的规模”，它确实是大多数数据操作和MLOps发生的地方；</li><li id="068c" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb mt mu mv mw bi translated"><a class="ae ml" rel="noopener" target="_blank" href="/hagakure-for-mlops-the-four-pillars-of-ml-at-reasonable-scale-5a09bd073da"> Hagakure for MLOps </a>:在这里，我们讨论现代MLOps的原则，以及小型团队如何得益于蓬勃发展的开放生态系统而富有成效；</li><li id="4f4b" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb mt mu mv mw bi translated"><a class="ae ml" rel="noopener" target="_blank" href="/the-modern-data-pattern-d34d42216c81">现代数据模式</a>:我们提出了(包括电池、数据和开源代码)一个实用的解决方案，来解决大规模接收、转换和查询数据的问题。</li></ol><p id="6a83" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">如果你密切关注我们，第4集将我们带到了数据领域的极限，在ML领域的开始:现在是时候结束这个循环了，将那些经过良好转换的数据行纳入机器学习模型，为用户提供预测服务。</p><p id="7aeb" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated"><strong class="ll ja">TL；博士</strong>:在<em class="nf">这个</em>岗位上，我们将再次把技术含量和组织智慧结合起来:</p><ul class=""><li id="8bce" class="mm mn iq ll b lm mo lp mp kx mq lb mr lf ms mb ng mu mv mw bi translated">我们引入“后现代堆栈”，也就是一种解构(看到现在的双关语了吧？我们之前共享的现代数据堆栈。我们重新利用<a class="ae ml" href="https://github.com/jacopotagliabue/paas-data-ingestion" rel="noopener ugc nofollow" target="_blank">第4集</a>(雪花+ dbt)中的数据操作工具来支持我们最喜欢的MLOps设置，这是一个<a class="ae ml" href="https://metaflow.org/" rel="noopener ugc nofollow" target="_blank">元流</a>管道，无缝结合了本地和云计算，并以无服务器的方式弥合了数据、训练和推理之间的差距。</li><li id="382f" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb ng mu mv mw bi translated">我们回到开始的地方，根据我们所学的知识，再次讨论<em class="nf">没有Ops的MLOps，</em>的基本原则，以及它如何形成(或应该形成)许多关于软件组织的传统讨论:人员配备、构建与购买，等等。</li></ul><p id="b428" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">克隆<a class="ae ml" href="https://github.com/jacopotagliabue/post-modern-stack" rel="noopener ugc nofollow" target="_blank">回购</a>，<a class="ae ml" href="https://www.youtube.com/watch?v=5kHDb-XGHtc" rel="noopener ugc nofollow" target="_blank">查看视频</a>，扣好安全带，和我们一起做最后一次旅行。</p><h2 id="6776" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated"><strong class="ak">将现代数据堆栈与现代ML堆栈结合起来</strong></h2><p id="73fb" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated"><a class="ae ml" href="https://www.mihaileric.com/posts/mlops-is-a-mess/" rel="noopener ugc nofollow" target="_blank">现代数据堆栈</a> (MDS)已经整合了大量关于数据收集、存储和转换的最佳实践。对于结构化或半结构化数据，MDS尤其有效，它通常依赖于三个关键部分:</p><ul class=""><li id="f1e3" class="mm mn iq ll b lm mo lp mp kx mq lb mr lf ms mb ng mu mv mw bi translated">通过工具或基础设施的可扩展摄取机制；</li><li id="69e7" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb ng mu mv mw bi translated">一个用于存储和计算的数据仓库(在合理的规模下，查询性能令人印象深刻)；</li><li id="07c0" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb ng mu mv mw bi translated">一个对原始数据进行类似DAG操作的转换工具，可能基于SQL作为不同角色(数据工程师、分析师、ML人员)的通用语言。</li></ul><p id="e5d6" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">网络上到处都是例子(包括我们自己的<a class="ae ml" href="https://github.com/jacopotagliabue/paas-data-ingestion" rel="noopener ugc nofollow" target="_blank">！)如何建立MDS。然而，它们可能会让你想知道“在ML方面”会发生什么:一旦数据被预先聚合，特性被预先计算，它是如何被下游消费以产生商业价值的？<em class="nf">这篇</em>文章通过提出一个轻量级工具链来回答这个问题，该工具链利用Metaflow作为ML操作的主干:社区对</a><a class="ae ml" href="https://github.com/jacopotagliabue/you-dont-need-a-bigger-boat" rel="noopener ugc nofollow" target="_blank">“更大的船”回购</a>的反应非常积极，<em class="nf">但是</em>我们认为我们也应该为希望更快开始的团队提出一个低接触的替代方案。</p><h2 id="2e5a" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated"><strong class="ak">后现代堆栈</strong></h2><p id="828c" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">由于流程图胜过一千个自述，我们的后现代堆栈(PMS)看起来是这样的:</p><figure class="ni nj nk nl gt nm gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nh"><img src="../Images/88911191c4d444b646e1011c7d465196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SraFsZjLDVGd-ukK5hbqA.jpeg"/></div></div><p class="nt nu gj gh gi nv nw bd b be z dk translated"><em class="nx">后现代堆栈一览【图片由我们的朋友在</em><a class="ae ml" href="https://outerbounds.com/" rel="noopener ugc nofollow" target="_blank"><em class="nx">outbounds</em></a>，<em class="nx"> </em> ll商标，所有标识均为其各自所有者的财产】</p></figure><p id="95b5" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">我们有四个主要的“功能”阶段，两个在数据领域，两个在ML领域:</p><ol class=""><li id="6f47" class="mm mn iq ll b lm mo lp mp kx mq lb mr lf ms mb mt mu mv mw bi translated"><strong class="ll ja">存储</strong>:我们使用雪花存储原始数据——我们重新使用Coveo去年发布的神奇的电子商务开放数据集<a class="ae ml" href="https://github.com/coveooss/SIGIR-ecom-data-challenge" rel="noopener ugc nofollow" target="_blank"/>，其中包含数百万个真实世界的匿名购物事件。</li><li id="e416" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb mt mu mv mw bi translated"><strong class="ll ja">转换</strong>:我们使用<a class="ae ml" href="https://www.getdbt.com/" rel="noopener ugc nofollow" target="_blank"> dbt </a>作为我们的转换框架——我们在雪花中运行一系列类似DAG的SQL查询<em class="nf">，并准备好我们的原始数据供Python代码使用。</em></li><li id="2d27" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb mt mu mv mw bi translated"><strong class="ll ja">训练</strong>:我们使用深度学习框架<a class="ae ml" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>来训练购物推荐的顺序模型——给定购物者互动过的产品列表，最有可能的下一次互动是什么？</li><li id="35c4" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb mt mu mv mw bi translated"><strong class="ll ja">服务</strong>:我们使用<a class="ae ml" href="https://aws.amazon.com/sagemaker/" rel="noopener ugc nofollow" target="_blank"> Sagemaker </a>作为我们的PaaS服务平台，这样一来，I)我们可以使用Python代码来触发部署，ii)通过使用AWS，我们可以获得与Metaflow的良好互操作性(即模型工件已经在s3中)。</li></ol><p id="8946" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">PMS并不比<a class="ae ml" rel="noopener" target="_blank" href="/noops-machine-learning-3893a42e32a4">你的普通元流管道</a>更复杂:通过将聚合委托给雪花，分布式计算被抽象为合理的规模；通过引入对dbt的支持，端到端的科学家可以准备好自己的特性，并一步到位地对数据集进行版本化；通过使用Metaflow，我们可以运行我们想要的所有Python代码，<em class="nf">在我们想要的地方</em>:我们可以以统一的、有原则的方式加入dataOps和MLOps，我们可以挑选需要硬件加速的地方。</p><p id="5f4b" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">PDP是一个零脂肪、严肃但完全现实的管道，开始将原始数据转化为实时预测。</p><blockquote class="ny"><p id="5317" class="nz oa iq bd ob oc od oe of og oh mb dk translated">更好的是，你有一个管道<strong class="ak">大量使用开源软件，而很少占用人们的时间</strong>:开发、培训和部署可以由一个ML工程师<em class="nx">完成，不需要任何基础设施知识</em>，也不需要devOps的支持。</p></blockquote><p id="2347" class="pw-post-body-paragraph lj lk iq ll b lm oi ka lo lp oj kd lr kx ok lt lu lb ol lw lx lf om lz ma mb ij bi translated">在探索这种设置对您的组织(而不仅仅是您的代码)的全面影响之前，可能是一个好时机来为对书呆子细节感兴趣的读者提及一些隐藏的瑰宝:</p><ul class=""><li id="5915" class="mm mn iq ll b lm mo lp mp kx mq lb mr lf ms mb ng mu mv mw bi translated">dbt cloud  : dbt为团队内部和团队之间的协作提供了一个SaaS版本的工具。为了支持这一场景，我们包括了通过连接到dbt云实例来运行相同流的可能性:虽然从流的角度来看这有点不太直观，但我们确实相信云产品是有价值的，特别是在数据堆栈涉及的人员更加多样化的大型组织中。</li><li id="65c9" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb ng mu mv mw bi translated"><strong class="ll ja">模型测试</strong>:我们在部署前加入了一个测试步骤，以提高对部署前全面测试重要性的认识。我们将<a class="ae ml" href="https://github.com/jacopotagliabue/reclist" rel="noopener ugc nofollow" target="_blank"> RecList </a>与Metaflow <a class="ae ml" rel="noopener" target="_blank" href="/integrating-pythonic-visual-reports-into-ml-pipelines-a163d150ed04"> cards </a>的力量结合起来，展示开源软件如何帮助开发更值得信赖的模型和更具包容性的文档。敬请期待不久的将来更深入的集成！</li></ul><p id="82ff" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">在<a class="ae ml" href="https://www.mihaileric.com/posts/mlops-is-a-mess/" rel="noopener ugc nofollow" target="_blank">蓬勃发展的时刻，但也是空间</a>令人困惑的增长时刻，我们希望我们的开放堆栈将为测试MLOps水域的团队提供可靠的第一步，展示几个简单的部分如何在大规模构建ML系统方面走得非常远。</p><blockquote class="ny"><p id="4b2c" class="nz oa iq bd ob oc od oe of og oh mb dk translated">这可能不是你旅程的终点，但我们相信这是一个很好的开始。</p></blockquote><h2 id="3b2a" class="ko kp iq bd kq kr on dn kt ku oo dp kw kx op kz la lb oq ld le lf or lh li iw bi translated"><strong class="ak"> MLOps和peopleOps </strong></h2><p id="3fc0" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">如果你还记得我们的<a class="ae ml" rel="noopener" target="_blank" href="/mlops-without-much-ops-d17f502f76e8">景观概述</a>，以合理规模运营的团队要么是小型的快速成长的创业公司，要么是在大型但传统的公司中开始ML实践的团队(如果你愿意的话，是企业中的创业公司<em class="nf">):他们想要的是<em class="nf">关闭反馈回路</em>的速度，所以NoOps是他们所需要的。特别是，我们对ML生命周期的方法强调了不花费<em class="nf">前期</em>工程时间来支持在第一天(甚至可能在第1000天)肯定不需要的规模和复杂性的重要性。</em></p><blockquote class="os ot ou"><p id="55f6" class="lj lk nf ll b lm mo ka lo lp mp kd lr ov nc lt lu ow nd lw lx ox ne lz ma mb ij bi translated">与“玩具世界”教程相比，我们的设计具有与您一起成长的优势:如果您确实需要在第1000天将X换成Y，其余的工具仍然可以完美地相互配合。</p></blockquote><p id="6000" class="pw-post-body-paragraph lj lk iq ll b lm mo ka lo lp mp kd lr kx nc lt lu lb nd lw lx lf ne lz ma mb ij bi translated">我们想要结束我们的系列，强调这种方法对组织如何工作和概念化数据以及他们产品的ML开发的一些影响。</p><ul class=""><li id="fcc7" class="mm mn iq ll b lm mo lp mp kx mq lb mr lf ms mb ng mu mv mw bi translated">超越人数的效率。考虑传统指标，如研发人数:现代MLOps方法可能会质疑围绕这一点的一些既定原则。例如，采用现代MLOps方法意味着你的商品销售成本(COGS)可能会构成<strong class="ll ja">一个更大的AWS账单——然而商品和服务生产中涉及的直接人工可能会更低。</strong>此外，这也意味着可能需要重新考虑传统指标，如<a class="ae ml" href="https://www.fingrid.fi/globalassets/dokumentit/fi/yhtio/tki-toiminta/raportit/fingrid-measure_final_public.pdf" rel="noopener ugc nofollow" target="_blank">研发人数或申请的专利数量</a>，并且可能需要不同的基准<strong class="ll ja">。</strong>因此，随着科技世界的快速变化，我们的衡量方法应该考虑到这一点。</li><li id="0e4e" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb ng mu mv mw bi translated"><em class="nf">灵活的垂直度。ML正在成为许多公司的重要产品组件(Coveo当然是其中之一)。关于能够在产品中嵌入ML功能的令人不安的事实是，ML工程师需要在业务问题方面接受培训，就像他们在超参数优化方面一样。考虑到这一点，在一个横向独立的单位中拥有10多名数据科学家可能不是正确的方式，因为这将他们从现场分离出来，并减缓数据和决策之间的反馈循环。或者，人们可能希望将ML ninjas直接嵌入到业务单元中，这样他们可以直接了解业务问题。唯一的问题是，如果业务部门没有准备好吸收ML工程师，他们很容易就会失去预期的影响力。采用强大的MLOps实践是使ML团队的垂直化更加亲切的一种方式，因为业务部门可以更有效地吸收数据科学家。“合理规模”拓扑中的MLOps看起来像垂直和水平之间的中间点——如果你愿意，可以说是一个T形:一些水平组件已经到位，以使每个人都具有生产力并重用知识和专业技能(例如，广泛采用元流)；但是考虑到用例的特殊性，特性是在业务线内垂直开发的。</em></li><li id="2214" class="mm mn iq ll b lm mx lp my kx mz lb na lf nb mb ng mu mv mw bi translated">留住人才:远离基础设施。可以说，这种方法最重要的结果是，MLOps可以作为吸引和留住关键人才的一部分。用更少的人力换取更多的计算将会产生<strong class="ll ja">一个小的、快乐的ML团队，这个团队比一个更大的、不那么专注的团队要好得多。大多数技术人才对使用最好的工具做前沿工作感到兴奋，关注具有挑战性的问题，并看到他们的工作在生产中的影响。如果没有正确的MLOps实践，顶级人才将很快因从事事务性任务而感到沮丧，并且看不到他们的工作有切实的业务影响。因此，更高的留存率和更高的ML生产率通常可以抵消可能更高的AWS账单。正如麦肯锡在一篇关于<a class="ae ml" href="https://www.mckinsey.com/business-functions/people-and-organizational-performance/our-insights/the-organization-blog/the-great-attrition-wanting-the-best-keeping-the-worst" rel="noopener ugc nofollow" target="_blank">“大损耗</a>”的文章中所说，“公司想要最好的，保留最差的，ML从业者更替的主要原因之一是将相当大一部分时间投入到低影响的任务中，如数据准备和基础设施维护。</strong></li></ul><blockquote class="ny"><p id="5fde" class="nz oa iq bd ob oc oy oz pa pb pc mb dk translated">最后，采用我们的MLOps方法也将明显影响首席财务官做出的<a class="ae ml" href="https://www.gartner.com/smarterwithgartner/how-leading-cfos-use-cost-management-as-a-catalyst-for-growth" rel="noopener ugc nofollow" target="_blank">战略决策，并让他们更开心。</a></p></blockquote><p id="e9ec" class="pw-post-body-paragraph lj lk iq ll b lm oi ka lo lp oj kd lr kx ok lt lu lb ol lw lx lf om lz ma mb ij bi translated">有一种流行的观点认为，管理R&amp;D支出的有效方式需要降低基础设施成本。但这通常是一种误导性的看待事物的方式。<strong class="ll ja">购买而非建设可以带来更准确的COGS </strong>估计和预测，尤其是对于不太成熟、更具实验性的行业——众所周知，时间就是金钱，考虑到缓慢勘探的机会成本，基础设施可能看起来更便宜。此外，我们经常发现，随着时间的推移，在初创企业中构建和维护基础设施的实际成本比大多数人想象的更难预测。不仅很容易低估长期所需的全部努力，而且每次你为了构建一个基础设施而创建一个团队时，你都引入了人的因素的典型的不可预测性。</p><h2 id="c90f" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated"><strong class="ak">想多聊聊ML“合理规模”的未来？</strong></h2><p id="f291" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated"><a class="ae ml" href="https://towardsdatascience.com/tagged/mlops-without-much-ops" rel="noopener" target="_blank">我们的系列报道到此为止</a>，但是我们很乐意收到您的来信:联系我们，在Medium和Linkedin上关注我们(<a class="ae ml" href="https://www.linkedin.com/in/jacopotagliabue/" rel="noopener ugc nofollow" target="_blank">这里</a>、<a class="ae ml" href="https://www.linkedin.com/in/cirogreco/" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae ml" href="https://www.linkedin.com/in/andrea-polonioli/" rel="noopener ugc nofollow" target="_blank">这里</a>)，看看我们的下一个“合理项目”是什么。</p><blockquote class="ny"><p id="38d8" class="nz oa iq bd ob oc od oe of og oh mb dk translated">再见，牛仔们！</p></blockquote></div><div class="ab cl pd pe hu pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="ij ik il im in"><h2 id="e84d" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated"><strong class="ak">致谢</strong></h2><p id="97d4" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">特别感谢dbt Labs的Sung Won Chung、Hugo Bowne-Anderson、Gaurav Bhushan、Outerbounds的Savin Goyal、Valay Dave以及Coveo的Luca Bigon和Patrick John Chia对草案和回购提出的有益意见。</p></div></div>    
</body>
</html>