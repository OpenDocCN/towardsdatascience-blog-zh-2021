<html>
<head>
<title>4 Data Pipeline Practices You (Probably) Didn’t Know About</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你(可能)不知道的4种数据管道实践</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-data-pipeline-practices-you-probably-didnt-know-about-f6ed145fbe69?source=collection_archive---------9-----------------------#2021-06-23">https://towardsdatascience.com/4-data-pipeline-practices-you-probably-didnt-know-about-f6ed145fbe69?source=collection_archive---------9-----------------------#2021-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4ad9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建高质量数据管道的数据工程技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/086512d549e88ab9d78654c15d78b154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-cIA_N1osiUS5FIu"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae ky" href="https://unsplash.com/@thisisengineering?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> ThisisEngineering RAEng </a></p></figure><p id="d1ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嘿，各位，<br/>在每个科技产品的背后，都有<strong class="lb iu">自动化</strong>要做，以保持数据整洁和最新。现在是2021年，仅仅知道如何构建酷的数据模型还不足以在数据科学家领域生存。你必须潜得更深。</p><p id="f458" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如今，数据管道越来越优先化。<br/>这主要得益于行业的成熟。数据科学家意识到，要为他们的模型获得干净的数据，他们必须为他们的数据仓库建立一个坚实的基础。</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/should-you-become-a-data-engineer-in-2021-4db57b6cce35"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">2021年该不该成为数据工程师？</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">数据工程是新的数据科学。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="5768" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，除了专门的数据工程师，数据科学家自己也必须了解数据管道。在本文中，我们将讨论一些您应该在设计中实现的数据管道实践，以确保稳定的数据生态系统。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="dc7d" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">先决条件</h1><p id="137a" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">本文中的实践涵盖了一般的<strong class="lb iu">数据流水线概念</strong>。<br/>无论你使用什么样的工作流管理系统，你都可以在任何地方应用这些概念。</p><p id="f757" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就我个人而言，我使用Apache Airflow进行批处理作业，使用Apache Beam进行流作业已经超过3年了。我发现他们很有效率。</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/data-engineering-basics-of-apache-airflow-build-your-first-pipeline-eefecb7f1bb9"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">数据工程Apache气流的基础——构建您的第一条管道</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">如果你从事技术工作，你很有可能需要管理数据。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="nr l mj mk ml mh mm ks ly"/></div></div></a></div><p id="08e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你了解basic <strong class="lb iu"> Python </strong>也会有所帮助，因为它是数据行业的主流编程语言。</p><p id="c73e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">改变我的想法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gif by <a class="ae ky" href="https://giphy.com/gifs/IepriDYu8gcidIVZPB/media" rel="noopener ugc nofollow" target="_blank"> Giphy </a></p></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="9575" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">计划与算法触发器</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/e808ad6fa80776318afd9f286206472f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z6dwR_zhn68kCHAdviPaoQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="651a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在传统流水线中，有基本的<strong class="lb iu"> ETL/ELT作业</strong>。<br/>无论您正在处理哪种工作，都需要触发器来启动工作本身。</p><p id="5005" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们进入<strong class="lb iu">时间表触发器vs算法触发器</strong>的辩论。</p><h2 id="f8d2" class="nv mv it bd mw nw nx dn na ny nz dp ne li oa ob ng lm oc od ni lq oe of nk og bi translated">计划触发器</h2><p id="91c8" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">你的基本触发器。调度程序在任何种类的工作流管理系统中都是可用的。它允许你以固定的时间间隔开始工作，比如每分钟、每小时、每天、每周等等。</p><p id="2f20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时间表触发器对不可避免的任务很有用。这意味着它们必须不管任何依赖关系而运行，并且通常在任何情况下都不会失败。</p><h2 id="44db" class="nv mv it bd mw nw nx dn na ny nz dp ne li oa ob ng lm oc od ni lq oe of nk og bi translated">算法触发器</h2><p id="c46b" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">一种定制的触发器。算法触发器有多种形式。最常见的是其他工作的传感器和触发器。它允许您在特定条件下开始作业<strong class="lb iu"/>。例子有—</p><ul class=""><li id="cad3" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated">文件被导入到文件夹中</li><li id="a81f" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">向表中添加一行</li><li id="0c7f" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">多个相关作业已完成</li></ul><p id="16be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">算法触发器对于有<strong class="lb iu">依赖</strong>的任务很有用。<br/>通常，这些作业会失败，除非满足<strong class="lb iu">某些条件</strong>。</p><h2 id="d19c" class="nv mv it bd mw nw nx dn na ny nz dp ne li oa ob ng lm oc od ni lq oe of nk og bi translated">判决</h2><p id="6d5b" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">你应该使用哪种触发器取决于你的工作性质。<br/>拥有适当的依赖和触发结构对于构建可靠的流水线架构至关重要。</p><p id="ddfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">问类似于— </strong>的问题</p><ul class=""><li id="24da" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated">该作业应该每天运行吗？</li><li id="98b4" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">这项工作占用的资源是否比需要的多？</li><li id="d84e" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">作业应该多久执行一次？</li><li id="80f7" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">工作的成功有多重条件吗？</li></ul><p id="3ea6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一个完美的世界里，我们所有的工作都运行良好。</p><p id="180e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我们知道这是不可能的。<br/> <strong class="lb iu">工作失败时学习</strong>。有了经验你会变得更好。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="6e28" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">适当的警报</h1><p id="3987" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我们的<strong class="lb iu">管道破裂</strong>。这不是世界末日。重要的是我们事后做了什么。</p><p id="37c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦发生这种情况，我们必须通知<strong class="lb iu"/>。<br/>通常情况下，基本的警报不足以实现这一点。</p><p id="02a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数工作流管理系统提供基本的警报解决方案。<br/>但是，组织通常会添加他们自定义的警报级别。</p><h2 id="d9e6" class="nv mv it bd mw nw nx dn na ny nz dp ne li oa ob ng lm oc od ni lq oe of nk og bi translated">电子邮件</h2><p id="b9b5" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">最简单的解决方案。<br/>这是最起码应该包含的。</p><p id="50b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">团队的所有成员都会收到一封电子邮件，提醒他们作业失败了。这不是最有效的解决方案，因为我们并不是一直盯着我们的电子邮件。我们可能会时不时地错过这一点。</p><p id="3a67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个非常基本的电子邮件气流警报形式。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="a805" class="nv mv it ow b gy pa pb l pc pd">from airflow.utils.email import send_email</span><span id="083f" class="nv mv it ow b gy pe pb l pc pd">email_to = 'receivers@email.com'<br/>email_subject = '(FAILED) ' + jobname + date<br/>email_content = 'Your job has failed.'<br/>send_email(email_to, email_subject, email_content)</span></pre><h2 id="d454" class="nv mv it bd mw nw nx dn na ny nz dp ne li oa ob ng lm oc od ni lq oe of nk og bi translated">松弛的</h2><p id="53fd" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">下一级警报。如果你是搞技术的，很可能你的公司已经采用了松弛作为一种沟通渠道。当消息被发送过来时，Slack会向你发出一种卡嗒声(我很确定我们都很熟悉这种声音)。</p><p id="564b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">创建一个警报专用频道</strong>。让您的管道在出现故障时向通道发送警报。这将确保团队在出现问题时得到提醒。</p><p id="74dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是使用其<strong class="lb iu"/><a class="ae ky" href="https://slack.dev/python-slack-sdk/web/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">API</strong></a>的时差警报的基本形式。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="3b09" class="nv mv it ow b gy pa pb l pc pd">from slack import WebClient</span><span id="d494" class="nv mv it ow b gy pe pb l pc pd">client = WebClient(token = 'your token here')<br/>response = client.chat_postMessage(<br/>                channel = slack_cannel,<br/>                text = message<br/>                )</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="4c8f" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">正确记录</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/107abb98d78f2a98d161363b381b5e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7pPa-hfIoLkmwaLQ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@artur_luczka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Artur uczka</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="26d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pg">不，不是那种日志</em>。</p><p id="7ccf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在编程中，日志记录只是一个用来定义写下你所做的一切的过程的花哨词汇。流水线过程中有两种类型的日志。任务日志和作业日志。</p><h2 id="dc3e" class="nv mv it bd mw nw nx dn na ny nz dp ne li oa ob ng lm oc od ni lq oe of nk og bi translated">任务日志</h2><p id="dfb2" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">这些日志记录了任务执行过程中的重要信息。我们不想打印我们运行的每一行代码，但是应该有足够的日志来帮助我们浏览任务。</p><p id="2ded" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个例子—</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="b1fd" class="nv mv it ow b gy pa pb l pc pd">Import PostgresHook</span><span id="b7b0" class="nv mv it ow b gy pe pb l pc pd">#Extraction Job<br/>def ExtractFromSource(query):<br/>    query_to_run = query<br/>    logging.info("Query : %" query_to_run)<br/>    <br/>    cursor = PostgresHook(connection).get_conn().cursor()<br/>    logging.info("Connecting to Postgres Connection %" connection)</span><span id="8e9b" class="nv mv it ow b gy pe pb l pc pd">    cursor.execute(query_to_run)<br/>    result = cursor.fetchall()</span></pre><p id="89c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<strong class="lb iu">调试</strong>期间，日志就像一个断点。它们有助于我们在任务失败时确定错误的来源。</p><p id="2be9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个提取作业中，我们记录了<strong class="lb iu">查询</strong>和<strong class="lb iu">连接</strong>。<br/>这实现了两件事——</p><ol class=""><li id="942b" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu ph on oo op bi translated">通知我们任务运行良好<strong class="lb iu">，直到每个点</strong></li><li id="1388" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu ph on oo op bi translated">向我们展示了传递的查询和连接变量</li></ol><p id="9a81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果出现问题，我们可以清楚地确定哪个步骤有问题，以及检查查询或连接变量是否有问题。</p><h2 id="1d7b" class="nv mv it bd mw nw nx dn na ny nz dp ne li oa ob ng lm oc od ni lq oe of nk og bi translated">作业日志</h2><p id="1dcc" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">作业日志是作业运行的记录。<br/>至少，它们显示了<strong class="lb iu">作业开始到结束的时间和状态。</strong> <br/>如果您的工作流管理系统默认情况下还没有这个，您应该将它存储在某个地方，甚至可能在您的数据仓库中。</p><p id="cd19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个工作日志的例子—</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/2e27ddd0f0f2553bb1750d727a659382.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*Kq8Eb-0bEA1E7WFNPgx0TQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4dd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">在您的数据仓库中创建一个审计表</strong>。使用这些数据为每个运行的作业插入一行。数据科学家和分析师可以轻松地浏览该表，以检查某些表的最新作业运行，以及作业是否成功运行。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="ca53" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">检查重复</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/b7ca23800974265e42b8b577995992b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E8K46em8xKLKBAnH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">菲尔·肖在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="400c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在提取或转换数据，您可能以前遇到过这个错误。你提取/转换中的重复。</p><p id="a87b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可能是由于几个原因，比如—</p><ul class=""><li id="18ee" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated">错误连接</li><li id="99b7" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">作业触发两次</li><li id="4e85" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">脏数据</li></ul><p id="57a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可以通过在管道中增加一个步骤<strong class="lb iu">检查重复</strong>来纠正。实现这一点的方法之一是通过主键检查计数。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="ab5d" class="nv mv it ow b gy pa pb l pc pd">Select max(count) from (<br/>Select primary_key, count(*) from table group by primary_key)</span></pre><p id="430a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果结果返回大于1，则表明数据中存在重复。<br/>如果你的数据没有主键，你也可以给它们分配主键。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="0348" class="nv mv it ow b gy pa pb l pc pd">alter table TABLENAME add primary key (ID,NAME,PMID)</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="2ee6" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">结论</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/282a90df0cbf18eab958a94f2705d7c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i8x2TdkmIoVO-m1q"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="24b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">恭喜</strong>！<br/>你已经成功改善了你的数据管道。<br/>这些年来我一直在学习这些概念，希望分享这些概念能为你节省一些时间。</p><p id="e94f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">在这篇文章中，我们了解到— </strong></p><ul class=""><li id="4638" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated">时间表与算法触发器</li><li id="b20f" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">适当的警报</li><li id="e73b" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">充分记录</li><li id="104c" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">重复检查</li></ul><p id="f1ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我引用一段话。</p><blockquote class="pl pm pn"><p id="bdad" class="kz la pg lb b lc ld ju le lf lg jx lh po lj lk ll pp ln lo lp pq lr ls lt lu im bi translated">作为数据科学家，我们的工作是从噪音中提取信号。—丹尼尔·唐克朗</p></blockquote></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="4cb0" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">订阅我的时事通讯，保持联系。</h1><p id="1bae" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">也可以通过<a class="ae ky" href="https://nickefy.medium.com/membership" rel="noopener"> <strong class="lb iu">我的链接</strong> </a>注册一个中等会员来支持我。你将能够从我和其他不可思议的作家那里读到无限量的故事！</p><p id="19e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我正在撰写更多关于数据行业的故事、文章和指南。你绝对可以期待更多这样的帖子。与此同时，可以随时查看我的其他<a class="ae ky" href="https://medium.com/@nickmydata" rel="noopener"> <strong class="lb iu">文章</strong> </a>来暂时填补你对数据的饥渴。</p><p id="27fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="pg">感谢</em> </strong> <em class="pg">阅读！如果你想与我取得联系，请随时联系我在nickmydata@gmail.com或我的</em> <a class="ae ky" href="https://www.linkedin.com/in/nickefy/" rel="noopener ugc nofollow" target="_blank"> <em class="pg"> LinkedIn个人资料</em> </a> <em class="pg">。也可以在我的</em><a class="ae ky" href="https://github.com/nickefy" rel="noopener ugc nofollow" target="_blank"><em class="pg">Github</em></a><em class="pg">中查看之前写的代码。</em></p></div></div>    
</body>
</html>