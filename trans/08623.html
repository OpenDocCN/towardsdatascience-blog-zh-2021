<html>
<head>
<title>User-to-User vs Item-to-Item Collaborative Filtering explained through simple examples (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过简单的例子解释用户对用户和项目对项目的协同过滤(第1部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/user-to-user-vs-item-to-item-collaborative-filtering-explained-through-simple-examples-part-1-f133bec23a58?source=collection_archive---------21-----------------------#2021-08-09">https://towardsdatascience.com/user-to-user-vs-item-to-item-collaborative-filtering-explained-through-simple-examples-part-1-f133bec23a58?source=collection_archive---------21-----------------------#2021-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7a00" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">简单解释了协同过滤背后的魔力。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1ed3cf837b7d7ebb05b5f653b7e294b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ECsSsaAEZePnFxf8"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Samuel Regan-Asante 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a6fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你是一名数据科学家，想要建立一个项目组合来推荐书籍/电影/产品，或者你只是想了解协同过滤是如何工作的，这篇文章将会帮助你。</p><p id="1209" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">概括地说，有两种主要类型的推荐系统。基于内容的协同过滤。顾名思义，第一种基于内容的类型通过推荐与你喜欢的内容相似的产品来工作。一种常见的方法是推荐具有相似描述的产品(即内容)作为您最喜欢的产品。在这篇文章中，我们将关注第二种类型，即<strong class="ky ir">协同过滤</strong>方法，这种方法根据用户评级推荐产品，在行业中被广泛采用。</p><p id="3932" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们用电影推荐来说明这个概念。如果我们使用用户对用户的方法，我们会发现用户之间的相似性，而推荐给用户的电影将基于与他们最相似的另一个用户喜欢的电影。</p><p id="6d0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一方面，如果我们使用项目到项目的方法，我们会发现电影之间的相似性。然后如果一个用户喜欢一部电影，我们会推荐和那部最相似的电影。</p><p id="ec1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户到用户和项目到项目之间的区别可能会令人困惑，帮助我区分它们的概念是我们是否使用用户或项目作为绘制的轴。如果我们使用用户作为轴，那么这意味着我们在使用项目到项目的方法。反之亦然，如果我们用电影作为轴心，这意味着我们在做用户对用户的方法。我们来举例说明。</p><p id="0468" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">用户对用户的方法</strong></p><p id="9350" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个例子，其中3个用户(u1、u2、u3)对2部电影(m1、m2)进行了评级。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/59f024ee87a18bd018e42d0daa96e877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*l-8rwpWYAZog6fLRPplieg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd lt"> 3电影用户评分1 &amp; 2 </strong></p></figure><p id="72c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们可以通过将电影1的收视率作为x轴，将电影2的收视率作为y轴来绘制这些用户。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lu"><img src="../Images/2874620e92ecf1bcecd7d82eac97ee79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BVNfOw557iHxWyf4UByDg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用户对用户的方法</p></figure><p id="f403" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所见，用户1和用户3非常相似。如果我们有一些电影X，用户1确实喜欢，而用户3没有看过，我们将只把电影X推荐给用户3。</p><p id="7615" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">逐项方法</strong></p><p id="d0fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们假设只有2个用户(u1，u2)对3部电影(m1，m2，m3)进行了评级。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/6c2324d742bc331bdc160387148999b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*cl8gtkLNoNPdj29q0H2F2A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd lt">用户1 &amp; 2 </strong>评价的3部电影</p></figure><p id="e2c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们不会试图寻找用户之间的相似性，而是将重点放在以每个用户评级为轴绘制电影上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lw"><img src="../Images/4fccad9012cfc32af9f40f75232230ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*USkZc-VRNJrGa73H-l4BOg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">逐项方法</p></figure><p id="9fca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过查看图表，我们可以看到电影1和3更接近，因此更相似。起初，这可能看起来有点像魔术，但肯定是有效的，因为喜欢动作片的用户可能会对其他类型的评分很低，从而导致这些相似性聚类的出现。但是我们如何量化这种相似性呢？</p><p id="0984" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">确定相似性的两种流行方法是<strong class="ky ir">余弦距离</strong>和<strong class="ky ir">皮尔逊相关性</strong>，余弦距离本质上是两个向量之间的角度投影，皮尔逊相关性计算向量之间的成对相关性。</p><p id="1ea9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">余弦相似度</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/7725dcc42324dda666536b2da6c800b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*9o2f0CCO1kU81_H_892khQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">确定两个向量A和b之间余弦相似性的公式。分子表示两个向量的点积，分母表示它们的大小相乘。</p></figure><p id="3b4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们用python计算余弦距离。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/275a5419d50927fd1897b0314fbb067c.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*Yo1Ior4uor7_4dmwcsTw2g.png"/></div></figure><pre class="kg kh ki kj gt mb mc md me aw mf bi"><span id="3776" class="mg mh iq mc b gy mi mj l mk ml">from sklearn.metrics.pairwise import cosine_similarity</span><span id="a656" class="mg mh iq mc b gy mm mj l mk ml">cosine_similarity(df)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/dfbfcf80e4c3409c7481047383d7af67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TIq8a2_q7MX6TF04BuvKZQ.png"/></div></div></figure><p id="7aa0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或将余弦相似性数组放入数据帧中</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/b35d8eab570b03325f53992a81b24090.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*BQmHhEXugNtGEGQrd6egxA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">余弦相似矩阵</p></figure><p id="d175" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们做了什么，这意味着什么？</p><p id="4339" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过做余弦相似度(df)，我们已经计算了每部电影之间的cos(Theta)。因此，第一行向我们展示了电影1与其自身完全相关/相似，与电影2相关性差，与电影3相关性非常强。相关性越强，电影越相似；这使得我们能够向一个用户推荐他过去可能喜欢的类似电影。</p><p id="60a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">标准化评级</strong></p><p id="aa96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将用户相对于其他用户的“审阅者难度”标准化的常用方法是通过减去平均值并将评级除以范围来标准化他们的评级。</p><p id="62c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们将评级标准化，然后取余弦相似度，我们会得到</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/f3b9935334608e1ef0dd95c70cf34127.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*v92TlTuQXTqvtEbWUkIYhg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">归一化余弦相似矩阵</p></figure><p id="99b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你可以看到相关性更容易解释，但得出的结论与我们之前的分析相同。</p><p id="668e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">皮尔森相关性</strong></p><p id="a23f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就拿电影之间的皮尔逊相关性来说吧。提醒一下，这是我们的逐项评级数据框架(df)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/275a5419d50927fd1897b0314fbb067c.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*Yo1Ior4uor7_4dmwcsTw2g.png"/></div></figure><p id="c7a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们仍然在做项目到项目的方法，但是为了计算电影之间的相似性，我们必须对这个矩阵进行转置，使每部电影成为一列。原因是Pearson correlation将每一列视为一个向量，并将计算它们之间的成对相关性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/8c56a7f841e4e5cbc30c9915b8311f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*nzzoBlvrIOZqyA80qTM5tw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">项目间的皮尔逊相关矩阵</p></figure><p id="c349" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，对角线上的词都是1，因为每部电影都有完美的相关性/完美的相似性。但是为了解释其含义，从第一行我们可以看到，电影1与电影2的相关性非常差，而与电影3的相关性非常强，这也与我们使用归一化余弦相似性方法得到的结果一致。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><p id="3809" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">最后的话</strong></p><p id="810b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果用户告诉我们他们最喜欢的电影，我们如何扩展这种方法并创建一个函数或后端API来向用户推荐电影？</p><p id="896f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，一个简单的策略是，如果他们告诉我们他们喜欢电影1；我们将获得m1的相似性行，按照降序排列相似性值，并选取与电影1最相似的前10或50个项目，并将它们推荐给用户。</p><p id="2381" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将在下一篇文章“<strong class="ky ir">如何使用开源MovieLens数据集构建电影推荐引擎后端Flask API(第2部分)</strong>中进一步探讨这个问题。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><p id="d2f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考文献</strong></p><ul class=""><li id="44e8" class="my mz iq ky b kz la lc ld lf na lj nb ln nc lr nd ne nf ng bi translated"><a class="ae kv" href="https://medium.com/code-heroku/how-to-turn-your-machine-learning-scripts-into-projects-you-can-demo-cbc5611ca442" rel="noopener">https://medium . com/code-heroku/how-to-turn-your-machine-learning-scripts-into-projects-you-can-demo-CBC 5611 ca 442</a></li><li id="1f4c" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><a class="ae kv" href="https://realpython.com/build-recommendation-engine-collaborative-filtering/" rel="noopener ugc nofollow" target="_blank">https://real python . com/build-re commendation-engine-collaborative-filtering/</a></li></ul></div></div>    
</body>
</html>