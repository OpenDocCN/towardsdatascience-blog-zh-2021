<html>
<head>
<title>Why you should try something else than Airflow for data pipeline orchestration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么您应该尝试使用气流以外的方式来进行数据管道编排</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-you-should-try-something-else-than-airflow-for-data-pipeline-orchestration-7a0a2c91c341?source=collection_archive---------4-----------------------#2021-09-20">https://towardsdatascience.com/why-you-should-try-something-else-than-airflow-for-data-pipeline-orchestration-7a0a2c91c341?source=collection_archive---------4-----------------------#2021-09-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2be1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">下面我们来评价一下气流旁边的<a class="ae ki" href="https://aws.amazon.com/step-functions/" rel="noopener ugc nofollow" target="_blank"> AWS step函数</a>、<a class="ae ki" href="https://cloud.google.com/workflows" rel="noopener ugc nofollow" target="_blank"> Google workflows </a>、<a class="ae ki" href="https://www.prefect.io/" rel="noopener ugc nofollow" target="_blank">提督</a>。</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/8b0e72c5529a378d02b012dc9a6921c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9RzNEQy_ug0Jou5maZ3ZdQ.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">范【数码影像】作者rajat sarki，<a class="ae ki" href="https://unsplash.com/photos/Gx2SU87s4WY" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="16bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然就使用和社区规模而言，Airflow作为一种数据编排管道占据了市场主导地位，但它已经相当陈旧，最初的设计并不能满足我们今天的一些需求。Airflow仍然是一个很棒的产品，但本文的目标是提高对替代产品的认识，以及对于您的数据用例，什么是完美的编排工具。下面我们来评价一下气流旁边的<a class="ae ki" href="https://aws.amazon.com/step-functions/" rel="noopener ugc nofollow" target="_blank"> AWS步骤功能</a>、<a class="ae ki" href="https://cloud.google.com/workflows" rel="noopener ugc nofollow" target="_blank"> Google workflows </a>、<a class="ae ki" href="https://www.prefect.io/" rel="noopener ugc nofollow" target="_blank">提督</a>。</p><p id="bf08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，如今好的数据编制工具的标准是什么呢？</p><h1 id="379d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">API-第一设计⚙</h1><p id="fa18" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">由于云提供商是API优先的，所以您希望您的编排工具是相同的。理想情况下，您希望能够通过API完成几件事情:</p><ul class=""><li id="bab3" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">创建/删除工作流</li><li id="b53c" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">非静态/不断发展的工作流的简单DAG序列化和反序列化。</li><li id="3068" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">运行参数化工作流</li><li id="5229" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">处理访问管理</li><li id="4550" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">通过IaC框架(Terraform/Pulumi)部署编排工具(如果不是无服务器的话)</li></ul><p id="31d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些特性将使您能够连接到所有现有的云服务，同时最大限度地利用事件驱动管道。</p><p id="d883" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Airflow DAGs的创建是非常静态的，与其他工具相比，API仍然非常有限。虽然您可以有一个策略来自动化Dag的部署，但是您仍然需要在最后生成一个静态文件。</p><p id="020e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">提督似乎没有完全适应动态dag创建，并有一点相同的模式，为DAG创建气流，见问题<a class="ae ki" href="https://github.com/PrefectHQ/prefect/discussions/3772" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="2bd3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">无服务器&amp;运行时☁️的关注点分离</h1><p id="c385" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">无服务器总是有一个悖论。一方面，我们不想管理服务，而更愿意关注我们的用例。另一方面，当出现问题或我们需要定制功能时，这是一个黑盒地狱。</p><p id="6031" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在过去管理一个Airflow集群是一件痛苦的事情，Kubernetes借助Airflow v2解决了许多问题。但是，我们不应该低估Kubernetes集群的维护成本。除此之外，您还需要添加一些东西来确保它能够顺利工作，例如，认证、秘密管理和K8s集群的监控。使用您所在的云提供商提供的无服务器编排工具，这是非常平滑和内置的。使用Kubernetes集群，您可以独自维护或启用这些功能。</p><p id="ea93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无服务器orchestrator工具的另一个特点是，您必须清楚地分离关注点，并且只将它用于编排任务，而不是实际运行它们。有气流的一个危险路径就是把它当运行时。同样，Kubernetes在解决这个问题上帮了很大的忙(参见本文<a class="ae ki" href="https://medium.com/bluecore-engineering/were-all-using-airflow-wrong-and-how-to-fix-it-a56f14cb0753" rel="noopener">这里</a>)，但这仍然是在您的集群上，维护依赖于您已经部署的监控这个集群的工具。</p><h1 id="cc7f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">整合能力⛓</h1><p id="b895" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">你想触发什么？有没有什么“连接器”可以让你在没有任何自定义层的情况下触发目标运行时？</p><p id="f7d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">气流有很多运营商。如果你没有找到你所需要的，你可以随时建立你自己的。提督也有一个很好的<a class="ae ki" href="https://docs.prefect.io/api/latest/tasks/airtable.html#writeairtablerow" rel="noopener ugc nofollow" target="_blank">集成列表</a>。</p><p id="04bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤功能<a class="ae ki" href="https://docs.aws.amazon.com/step-functions/latest/dg/concepts-service-integrations.html" rel="noopener ugc nofollow" target="_blank">有几个与AWS服务的集成</a>，甚至提供同步作业或等待回调。</p><p id="5f57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谷歌工作流也开始添加与GCP服务的连接器。</p><h1 id="20ea" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用户界面功能🔮</h1><p id="b241" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当运行复杂的工作流时，有一个清晰的地方来观察哪里出错并快速采取行动是非常重要的。</p><p id="dfcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还想轻松地回滚或重试特定的任务/子任务，尤其是在数据管道环境中。请注意，最佳实践应该使您的数据幂等。</p><p id="74ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，如今，管道仪表板甚至还不够。问题是您可能有一个无声的失败，并且您可能需要在一个中心工具中输入其他警报/信息。例如，您有一个总是丢弃任何不符合模式的数据的管道。在这种情况下，您需要另一个监控工具，比如用于数据可观察性的数据质量工具。</p><h1 id="8bbf" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">测试🏗</h1><p id="a095" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">作为开发人员，您希望有一种简单的方法来测试您的管道，并且开发周期尽可能短。乍一想，我们可能会认为可以在任何地方运行的数据编制器(如airflow/Prefect)会提供最佳和流畅的测试体验，对吗？不尽然，因为在本地运行它们可能会折磨你的笔记本电脑的CPU，增加你的风扇产生疯狂的气流😏).</p><p id="a8a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用managed Airflow(AWS/astronomy ),您可以出于开发原因动态创建air flow实例(并通过代码使其自动化),但启动时间是不可忽略的。是的，对于一个开发者来说，哪怕一两分钟都是一生。</p><p id="46fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，最终，如果您利用IaC框架，拥有像AWS Step函数/工作流这样的完整无服务器编排器将使您能够快速测试您的管道。此外，您是在目标环境中直接测试它，几乎没有副作用。</p><p id="48ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，AWS提供了一个用于测试目的的阶跃函数仿真器<a class="ae ki" href="https://docs.aws.amazon.com/step-functions/latest/dg/sfn-local.html" rel="noopener ugc nofollow" target="_blank">，这里是</a>。</p><h1 id="83ef" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">总之，还是放点星星吧！🌟</h1><p id="76e4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个表只是一个高层次的评价。当然，您应该考虑其他因素，如您团队的当前知识、您现有的基础架构，并制定您自己的基准！虽然我真的很喜欢并且一直是(并且仍然是)Airflow的长期用户，但我必须说，我对大多数新用例的首选是AWS步骤功能/ GCP工作流，具体取决于用例。</p><p id="d0c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ki" href="https://dagster.io/" rel="noopener ugc nofollow" target="_blank"> Dagster </a>是另一个值得考虑的好工具，但是我没有这方面的经验，而且因为他们不提供云托管版本(虽然根据他们的网站，这正在进行中)，我没有花时间去投资它。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nh"><img src="../Images/c4b8dd08451db0e3b8a57242b4f51cc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rx_S9VRuhJKzgEL-EiK8Q.png"/></div></div></figure><h1 id="eb17" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">迈赫迪·瓦扎又名迈赫迪欧·🧢</h1><p id="e573" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">感谢阅读！🤗 🙌如果你喜欢这个，<strong class="lb iu">跟随我上</strong>🎥<a class="ae ki" href="https://www.youtube.com/channel/UCiZxJB0xWfPBE2omVZeWPpQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Youtube </strong> </a>，<strong class="lb iu"> </strong> ✍️ <a class="ae ki" href="https://medium.com/@mehdio" rel="noopener"> <strong class="lb iu">中型</strong> </a>，或者🔗<a class="ae ki" href="https://linkedin.com/in/mehd-io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> LinkedIn </strong> </a>了解更多数据/代码内容！</p><p id="f4eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">支持我写作</strong> ✍️通过加入媒介通过这个<strong class="lb iu"> </strong> <a class="ae ki" href="https://mehdio.medium.com/membership" rel="noopener"> <strong class="lb iu">链接</strong> </a></p></div></div>    
</body>
</html>