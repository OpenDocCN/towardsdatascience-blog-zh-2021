<html>
<head>
<title>Build Excel Automation Tools with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python构建Excel自动化工具</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/use-python-to-design-automation-tools-for-excel-users-e824b37c646d?source=collection_archive---------12-----------------------#2021-04-17">https://towardsdatascience.com/use-python-to-design-automation-tools-for-excel-users-e824b37c646d?source=collection_archive---------12-----------------------#2021-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f3c3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用于销售分析的Excel自动化工具的设计可供您的同事在没有任何Python知识的情况下使用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/192f7e8d9b6ca4af6931fd2c7723705e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*bbgbzoAn3uo7GOM86iIhQA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Excel自动化—(图片由作者提供)</p></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><p id="d393" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">你读过多少文章说“Excel已死，Python万岁”，“Python是新的Excel”或者“Excel过时了”？</p><p id="9bde" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">但是当你环顾四周，在你的团队或其他部门你几乎找不到其他同事使用Python。</p><p id="c9b4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">而当你提到它时，它被视为一个人们无法信任的黑匣子，因为“<em class="lu">它太复杂了”、“我们看不到公式”</em>或“<em class="lu">我无法在我的电脑上运行它”</em>。</p><p id="3cb3" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">推广它的第一步是让他们有可能在没有python知识的情况下在他们的计算机上运行您的脚本。</p><p id="ee9f" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">💌新文章免费直入你的收件箱:<a class="ae lv" href="https://www.samirsaci.com/#/portal/signup" rel="noopener ugc nofollow" target="_blank">时事通讯</a></p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><p id="fb71" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">如果你喜欢看，看看这篇文章的视频版本</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lw lx l"/></div></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="3244" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">1.方案</h1><p id="2595" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated">你是一家大型零售公司的<strong class="la ir">数据科学家，供应链团队的同事请求你帮助<strong class="la ir">分析销售数据</strong>。</strong></p><p id="090a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">对于本例，我们将从Kaggle挑战:<a class="ae lv" href="https://www.kaggle.com/c/demand-forecasting-kernels-only/data" rel="noopener ugc nofollow" target="_blank">商店商品需求预测挑战</a>中获取一个数据集。我在另一篇文章(<a class="ae lv" rel="noopener" target="_blank" href="/machine-learning-for-store-demand-forecasting-and-inventory-optimization-part-1-xgboost-vs-9952d8303b48">链接</a>)中使用这个数据集进行商店需求预测。</p><p id="79b0" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">数据集</p><ul class=""><li id="cbf6" class="mv mw iq la b lb lc le lf lh mx ll my lp mz lt na nb nc nd bi translated">2013年1月1日至2017年12月31日的交易</li><li id="14ca" class="mv mw iq la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated"><strong class="la ir"> 913，000 </strong>销售交易</li><li id="7e03" class="mv mw iq la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated"><strong class="la ir"> 50 </strong>独特的SKU</li><li id="0828" class="mv mw iq la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated"><strong class="la ir"> 10 </strong>店铺</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj lx l"/></div></figure><p id="5b07" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">目标:</strong>你的同事想要为每个商店建立一个按商品统计的月销售额数据透视表。</p><p id="77e7" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">问题:</strong>拥有近100万条记录，您的同事正在接近Excel的极限。因此，他们请求数据科学家的支持，以找到神奇的解决方案。</p><div class="nk nl gp gr nm nn"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">萨米尔Samir供应链组合的数据科学</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">🏭使用高级数学概念的供应链网络优化👨‍🏭仓储的持续改进…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">samirsaci.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob kl nn"/></div></div></a></div></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="088c" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">2.解决办法</h1><p id="3a3d" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated">我们将设计一个python脚本来执行数据处理，创建数据透视表并将结果导出到Excel文件中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj lx l"/></div></figure><p id="699f" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">您的脚本正在执行以下任务:</p><ol class=""><li id="1b77" class="mv mw iq la b lb lc le lf lh mx ll my lp mz lt oc nb nc nd bi translated">从Kaggle Challenge导入初始原始数据(sales_data.csv)</li><li id="9f68" class="mv mw iq la b lb ne le nf lh ng ll nh lp ni lt oc nb nc nd bi translated">日期格式化</li><li id="ec72" class="mv mw iq la b lb ne le nf lh ng ll nh lp ni lt oc nb nc nd bi translated">每对商店、商品按月销售的数据透视表</li><li id="1bfe" class="mv mw iq la b lb ne le nf lh ng ll nh lp ni lt oc nb nc nd bi translated">按商店和项目对记录进行排序</li><li id="e2b8" class="mv mw iq la b lb ne le nf lh ng ll nh lp ni lt oc nb nc nd bi translated">将最终报告保存在Excel文件中</li></ol></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="8a92" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">3.使用可执行文件(.exe)</h1><p id="8c60" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated"><strong class="la ir">目标:</strong>创建一个可执行文件(。exe)，它将运行您的脚本，并且可以在您的计算机上没有安装python的情况下使用。</p><h2 id="f7d7" class="od lz iq bd ma oe of dn me og oh dp mi lh oi oj mk ll ok ol mm lp om on mo oo bi translated"><strong class="ak">工具箱中的新Python库:Pyinstaller </strong></h2><blockquote class="op oq or"><p id="dc9c" class="ky kz lu la b lb lc jr ld le lf ju lg os li lj lk ot lm ln lo ou lq lr ls lt ij bi translated">PyInstaller将Python应用程序及其所有依赖项打包到一个包中。用户可以运行打包的应用程序，而无需安装Python解释器或任何模块。</p></blockquote><h2 id="05b0" class="od lz iq bd ma oe of dn me og oh dp mi lh oi oj mk ll ok ol mm lp om on mo oo bi translated"><strong class="ak">第一步:安装Pyinstaller </strong></h2><pre class="kg kh ki kj gt ov ow ox oy aw oz bi"><span id="f049" class="od lz iq ow b gy pa pb l pc pd">pip install pyinstaller</span></pre><h2 id="b902" class="od lz iq bd ma oe of dn me og oh dp mi lh oi oj mk ll ok ol mm lp om on mo oo bi translated">步骤2:将python脚本保存在当前目录中</h2><p id="5236" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated">将它保存在与销售记录初始文件(sales_data.csv)相同的目录中。将文件命名为:“pivot.py”</p><h2 id="1cff" class="od lz iq bd ma oe of dn me og oh dp mi lh oi oj mk ll ok ol mm lp om on mo oo bi translated">步骤3:使用Pyinstaller创建可执行文件</h2><p id="bbe3" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated">在命令提示符下输入以下命令</p><pre class="kg kh ki kj gt ov ow ox oy aw oz bi"><span id="51df" class="od lz iq ow b gy pa pb l pc pd">pyinstaller --onefile pivot.py</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="pf pg di ph bf pi"><div class="gh gi pe"><img src="../Images/6b905e15ae3e0ca9f764f4aea08b17e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tq3unuorWp-hGOHH41SCOA.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Pyinstaller处理日志—(图片由作者提供)</p></figure><p id="2884" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">当该过程完成时，您将看到此消息“从EXE-00.toc成功构建EXE”还有你的(。exe) fill会弹出一个名为“Build”的文件夹。</p><h2 id="edbf" class="od lz iq bd ma oe of dn me og oh dp mi lh oi oj mk ll ok ol mm lp om on mo oo bi translated">步骤4:使用你的可执行文件</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="pf pg di ph bf pi"><div class="gh gi pj"><img src="../Images/40b2e18c9afaefc651cad53b680a6fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDoYBfNfYaiUe5_oBpR-Pg.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">您的新(。文件处理日志—(图片由作者提供)</p></figure><p id="8b24" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">请你的同事剪切并粘贴这个(。exe)文件，并单击以启动脚本。由于在脚本的每一步都放置了打印消息，他们可以跟踪这个过程。</p><p id="1663" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">结果:</strong>在流程结束时，他们可以找到保存在您文件夹中的销售报告(sales_report.xlsx)。</p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h2 id="f8d0" class="od lz iq bd ma oe of dn me og oh dp mi lh oi oj mk ll ok ol mm lp om on mo oo bi translated">超越:自动化数据提取</h2><p id="09bf" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated">在开始构建报告之前，您需要从ERP中收集数据。如果您正在使用SAP，您可能会对这一系列关于ERP自动化的文章感兴趣</p><div class="nk nl gp gr nm nn"><a href="https://www.samirsaci.com/sap-automation-of-product-listing-for-retail/" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">零售产品列表的SAP自动化</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">自动化和报告使用Visual Basic自动化产品，通过SAP GUI脚本工具在SAP中自动列出产品…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">www.samirsaci.com</p></div></div><div class="nw l"><div class="pk l ny nz oa nw ob kl nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a href="https://www.samirsaci.com/sap-automation-for-retail/" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">面向零售业的SAP自动化</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">自动化和报告设计RPA解决方案使用通过SAP GUI脚本工具构建的Visual Basic脚本设计RPA…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">www.samirsaci.com</p></div></div><div class="nw l"><div class="pl l ny nz oa nw ob kl nn"/></div></div></a></div></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="112f" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">4.结论</h1><p id="ece9" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated"><em class="lu">关注我的medium，了解更多与供应链数据科学相关的见解。</em></p><p id="9b46" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">您现在有了一个工具来与其他同事分享您的工作，并构建将影响您公司的生产力并支持人们自动完成枯燥任务的工具。</p><p id="9e3c" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这可以与使用seaborn的酷可视化、获取数据的外部API的连接、预测未来销售的机器学习模型或任何可以为您的计算带来附加值的东西相结合。</p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="bd60" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">关于我</h1><p id="24c5" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated">让我们在<a class="ae lv" href="https://www.linkedin.com/in/samir-saci/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>和<a class="ae lv" href="https://twitter.com/Samir_Saci_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上连线，我是一名供应链工程师，正在使用数据分析来改善物流运营和降低成本。</p><p id="5724" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">如果你对数据分析和供应链感兴趣，可以看看我的网站</p><div class="nk nl gp gr nm nn"><a href="https://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">Samir Saci |数据科学与生产力</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">专注于数据科学、个人生产力、自动化、运筹学和可持续发展的技术博客</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">samirsaci.com</p></div></div><div class="nw l"><div class="pm l ny nz oa nw ob kl nn"/></div></div></a></div><h1 id="d3c1" class="ly lz iq bd ma mb pn md me mf po mh mi jw pp jx mk jz pq ka mm kc pr kd mo mp bi translated">参考</h1><p id="7873" class="pw-post-body-paragraph ky kz iq la b lb mq jr ld le mr ju lg lh ms lj lk ll mt ln lo lp mu lr ls lt ij bi translated">[1] Kaggle数据集，商店商品需求预测挑战，<a class="ae lv" href="https://www.kaggle.com/c/demand-forecasting-kernels-only" rel="noopener ugc nofollow" target="_blank">链接</a></p></div></div>    
</body>
</html>