<html>
<head>
<title>Simulating Multi-Agent Swarming Events in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python模拟多智能体群集事件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simulating-multi-agent-swarming-events-in-python-ee133143944d?source=collection_archive---------13-----------------------#2021-05-22">https://towardsdatascience.com/simulating-multi-agent-swarming-events-in-python-ee133143944d?source=collection_archive---------13-----------------------#2021-05-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a966" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以鸟类迁徙为例模拟多主体强化学习分析中的群集现象</h2></div><p id="7031" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">成群结队在自然界频繁发生:从一群候鸟到一群执行特定任务的无人机。因此，能够模拟群集如何工作将使您能够构建自己的多智能体强化学习算法，以密切模仿现实世界的场景。为了让你对我们今天正在构建的东西有所了解，下面的GIF将是我们使用候鸟为例的群集模拟模型的输出。事不宜迟，我们开始吧！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/e1bcfd2e7e94227f82711d4f428a3eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/1*stNVhg5lFj4mGDUuQOcLXw.gif"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">作者GIF</p></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="34d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">注:</strong>可以在帖子末尾找到完整代码。</p><h1 id="4bc7" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">动机</h1><p id="dc00" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">为什么模拟在多智能体强化学习(RL)问题中很重要？这主要是因为模拟是RL中的探索性数据分析(EDA)方法之一，它允许我们可视化系统中不同代理的相互关系。在这篇文章中，我们将讨论群集事件，因为它们是多智能体强化学习的许多例子中的一些，我在下面编译了它们在现实生活中是如何行动的！</p><ol class=""><li id="53b5" class="mu mv it kk b kl km ko kp kr mw kv mx kz my ld mz na nb nc bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=V4f_1_r80RY" rel="noopener ugc nofollow" target="_blank">成群的鸟</a></li><li id="a5e6" class="mu mv it kk b kl ne ko nf kr ng kv nh kz ni ld mz na nb nc bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=44KvHwRHb3A&amp;ab_channel=GuinnessWorldRecordsGuinnessWorldRecordsVerified" rel="noopener ugc nofollow" target="_blank">无人机群</a></li><li id="0c7d" class="mu mv it kk b kl ne ko nf kr ng kv nh kz ni ld mz na nb nc bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=15B8qN9dre4&amp;ab_channel=GuinnessWorldRecordsGuinnessWorldRecordsVerified" rel="noopener ugc nofollow" target="_blank">鱼群</a></li><li id="52da" class="mu mv it kk b kl ne ko nf kr ng kv nh kz ni ld mz na nb nc bi translated">还有很多其他的！</li></ol></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="5fd5" class="lx ly it bd lz ma nj mc md me nk mg mh jz nl ka mj kc nm kd ml kf nn kg mn mo bi translated">群集算法:Viscek模型</h1><p id="d300" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们将实现<a class="ae nd" href="http://arxiv.org/pdf/cond-mat/0611743.pdf" rel="noopener ugc nofollow" target="_blank"> Viscek </a>模型(1995 ),作为我们的多智能体群集基线算法，在此基础上已经构建了许多更高级的实现。</p><p id="129c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想象你正在试图模拟300只鸟的群集(<em class="no"> N </em> =300)，其中每只鸟的索引为i=0…( <em class="no"> N </em> -1)。一只鸟只有在半径为<em class="no"> R </em>的圆内与另一只鸟相互作用时，才会改变方向和速度矢量。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi np"><img src="../Images/d6d2ba5b566be768e4801ee9c4e80592.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/0*ErAfbiE9NKZ3aDre.png"/></div></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">交互发生的半径(来源:<a class="ae nd" href="http://arxiv.org/pdf/cond-mat/0611743.pdf" rel="noopener ugc nofollow" target="_blank"> Viscek </a>)</p></figure><p id="0674" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从导入所需的Python库并初始化上述常量开始。</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="a0b3" class="nz ly it nv b gy oa ob l oc od">import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="6f82" class="nz ly it nv b gy oe ob l oc od">N = 300 # number of birds<br/>R = 0.5 # radius of effect</span><span id="0f34" class="nz ly it nv b gy oe ob l oc od"># Preparing the drawing<br/>L = 5   # size of drawing box</span><span id="d6d3" class="nz ly it nv b gy oe ob l oc od">fig = plt.figure(figsize=(6,6), dpi=96)<br/>ax = plt.gca()</span></pre><p id="7d76" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于每个时间步，<em class="no"> n </em>，每只鸟沿x轴和y轴(<strong class="kk iu"> <em class="no"> r </em> </strong>)的位置更新如下:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi of"><img src="../Images/a6fb6a65dbddd75b178b493382151ad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*rKjKsx39WRyrvP6F.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">每个时间步长的位置更新(来源:<a class="ae nd" href="http://arxiv.org/pdf/cond-mat/0611743.pdf" rel="noopener ugc nofollow" target="_blank"> Viscek </a></p></figure><p id="e3f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是用Python实现的。</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="8502" class="nz ly it nv b gy oa ob l oc od">Nt = 200 # number of time steps<br/>dt = 0.1 # time step</span><span id="075e" class="nz ly it nv b gy oe ob l oc od"># bird positions (initial)<br/>x = np.random.rand(N,1)*L<br/>y = np.random.rand(N,1)*L</span></pre><p id="c344" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="no"> v </em> </strong>为速度恒定的速度矢量，<em class="no"> v0 </em>，角度<em class="no">θ</em><strong class="kk iu"><em class="no">ᵢ</em></strong>(读作:theta) <em class="no">。</em>我们还将引入一个角度扰动(读作:<em class="no"> eta </em>)来模拟鸟类运动的自然随机性。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi of"><img src="../Images/92913d6b48d27624a359874acfa35e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*LZmtc3d-4HtuQV5u.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">时间步长n时x和y方向的速度矢量计算(来源:<a class="ae nd" href="http://arxiv.org/pdf/cond-mat/0611743.pdf" rel="noopener ugc nofollow" target="_blank"> Viscek </a></p></figure><p id="19aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">速度向量在下面的Python中初始化。</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="6ff0" class="nz ly it nv b gy oa ob l oc od">v0 = 0.5 # constant speed<br/>eta = 0.6 # random fluctuation in angle (in radians)<br/>theta = 2 * np.pi * np.random.rand(N,1)</span><span id="454e" class="nz ly it nv b gy oe ob l oc od"># bird velocities (initial)<br/>vx = v0 * np.cos(theta)<br/>vy = v0 * np.sin(theta)</span></pre><p id="239d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们将进入主for循环。对于每个时间步长，位置<strong class="kk iu"><em class="no">r</em></strong>更新为:</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="87e7" class="nz ly it nv b gy oa ob l oc od"># Update position<br/>x += vx*dt<br/>y += vy*dt</span></pre><p id="43cd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并且通过找到R 内的(1) <strong class="kk iu">平均角度，(2) <strong class="kk iu"> </strong>加上<strong class="kk iu">随机扰动</strong>以产生新的θ，以及(3)更新<strong class="kk iu">新的速度向量</strong>、<strong class="kk iu"> <em class="no"> v </em> </strong>来更新<strong class="kk iu">v</strong>:</strong></p><p id="b053" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(1)R内的平均角度</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="0653" class="nz ly it nv b gy oa ob l oc od">mean_theta = theta</span><span id="097a" class="nz ly it nv b gy oe ob l oc od"># Mean angle within R<br/>for b in range(N):<br/>    neighbors = (x-x[b])**2+(y-y[b])**2 &lt; R**2<br/>    sx = np.sum(np.cos(theta[neighbors]))<br/>    sy = np.sum(np.sin(theta[neighbors]))<br/>    mean_theta[b] = np.arctan2(sy, sx)</span></pre><p id="2fa3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(2)给速度角增加一个随机扰动。随机项是通过从[-0.5，0.5]内的正态分布中采样，将其乘以预定义的η，并将该扰动项与计算的平均θ相加而生成的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi og"><img src="../Images/dbb58575ecd010cd4df3f3450e7a5639.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/0*P6DlkRaJ7Jo07n4e.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">正态分布(作者图片)</p></figure><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="ffff" class="nz ly it nv b gy oa ob l oc od"># Adding a random angle perturbation<br/>theta = mean_theta + eta*(np.random.rand(N,1)-0.5)</span></pre><p id="5059" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(3)用新的θ更新速度矢量:</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="1c31" class="nz ly it nv b gy oa ob l oc od"># Updating velocity<br/>vx = v0 * np.cos(theta)<br/>vy = v0 * np.sin(theta)</span></pre><p id="8a3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总的来说，<strong class="kk iu"> <em class="no"> r和v </em> </strong>的更新将在dt * Nt个时间步长内完成。</p><p id="c807" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，现在一切都准备好了，让我们画出更新的样子来结束吧！</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="aab7" class="nz ly it nv b gy oa ob l oc od">plt.cla()<br/>plt.quiver(x,y,vx,vy,color='r')<br/>ax.set(xlim=(0, L), ylim=(0, L))<br/>ax.set_aspect('equal')<br/>plt.pause(0.001)</span></pre></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="1dd1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一切正常，你会在屏幕上看到这个消息。恭喜你！您可以试验并更改一些参数，看看您的模拟模型如何变化。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi oh"><img src="../Images/2cdfed6c29e0852b868b207e0852d16c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bvRebJps85P1rxqaqub5tQ.png"/></div></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">蜂拥事件(图片由作者提供)</p></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="1cf6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你已经到达终点，那就做得很好。你可以在这里找到完整的代码:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="oi oj l"/></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="9b36" class="lx ly it bd lz ma nj mc md me nk mg mh jz nl ka mj kc nm kd ml kf nn kg mn mo bi translated">离别的思绪</h1><p id="b6dc" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">模拟是强化学习中探索性数据分析的一个步骤。一旦您对现实世界的数学行为有了更清晰的认识，您将能够设计更鲁棒的RL算法。如果你喜欢这篇文章，我会做更多真实世界的模拟，作为我的多代理RL EDA系列的一部分。敬请关注！</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="e790" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">【https://tinyurl.com/2npw2fnz】<em class="no">订阅我的电子邮件简讯:</em><a class="ae nd" href="https://tinyurl.com/2npw2fnz" rel="noopener ugc nofollow" target="_blank"><em class="no"/></a><em class="no"/><strong class="kk iu"><em class="no">我定期在那里用通俗易懂的英语和漂亮的可视化总结AI研究论文。</em>T55】</strong></p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="2b18" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，您可以在这里找到更多关于RL和仿真主题的资源:</p><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/getting-started-to-reinforcement-learning-tic-tac-toe-f1d32d53acb4"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">强化学习入门—井字游戏</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">实现一个简单的双代理强化学习模型</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb lk on"/></div></div></a></div><div class="ok ol gp gr om on"><a href="https://github.com/AndreasKuhnle/SimRLFab" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">AndreasKuhnle/SimRLFab</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">复杂工作车间生产计划和控制的模拟和强化学习框架</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">github.com</p></div></div><div class="ow l"><div class="pc l oy oz pa ow pb lk on"/></div></div></a></div><div class="ok ol gp gr om on"><a href="https://deepsense.ai/what-is-reinforcement-learning-the-complete-guide/" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">什么是强化学习？完全指南- deepsense.ai</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">人工智能预计市场规模为73.5亿美元，正在突飞猛进地发展…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">deepsense.ai</p></div></div><div class="ow l"><div class="pd l oy oz pa ow pb lk on"/></div></div></a></div><div class="ok ol gp gr om on"><a href="https://www.guru99.com/reinforcement-learning-tutorial.html" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">强化学习:什么是，算法，应用，例子</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">强化学习被定义为一种机器学习方法，它关注的是软件代理应该如何采取…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">www.guru99.com</p></div></div><div class="ow l"><div class="pe l oy oz pa ow pb lk on"/></div></div></a></div></div></div>    
</body>
</html>