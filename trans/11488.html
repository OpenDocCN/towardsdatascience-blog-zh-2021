<html>
<head>
<title>How to Skyrocket Your Python Speed with Numba 🚀</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Numba提升你的Python速度🚀</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-skyrocket-your-python-speed-with-numba-89fd16362e47?source=collection_archive---------9-----------------------#2021-11-12">https://towardsdatascience.com/how-to-skyrocket-your-python-speed-with-numba-89fd16362e47?source=collection_archive---------9-----------------------#2021-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="44a8" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">快速介绍</h2><div class=""/><div class=""><h2 id="350a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">学习如何使用Numba Decorators让你的代码更快</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/6d226e044eabee415758fd23111abc9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9FZIR81hdcGxIBVN"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Marc-Olivier Jodoin 在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="4dac" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">您的旅程概述</h1><ol class=""><li id="8592" class="ma mb it mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated"><a class="ae lh" href="#3846" rel="noopener ugc nofollow">设置舞台</a></li><li id="404f" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#31ff" rel="noopener ugc nofollow">了解数字和安装</a></li><li id="c8d8" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#6cf5" rel="noopener ugc nofollow">使用Jit-Decorator </a></li><li id="69ad" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#2df5" rel="noopener ugc nofollow">三个陷阱</a></li><li id="b3a0" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated">【Numba闪耀的地方</li><li id="a079" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#500b" rel="noopener ugc nofollow">包装</a></li></ol></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="3846" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">1 —搭建舞台</h1><p id="b97a" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">在数据科学和数据工程中，许多从业者每天都在编写代码。为一个问题制定一个可行的解决方案绝对是最重要的事情。然而，有时代码的执行速度也很重要。</p><p id="0872" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">在<strong class="mc jd">实时分析</strong>和<strong class="mc jd">预测</strong>中尤其如此。如果代码太慢，那么这可能会给整个系统造成瓶颈。随着时间的推移，系统通常会变慢。由于要处理的数据越来越多，在数据学科中尤其如此。最坏的情况是，你构建的实时系统可能太慢而没有用😮</p><p id="add8" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">很多编译型编程语言，比如C++，一般都比Python快。这是否意味着您应该将整个Python管道连根拔起？不。这通常不值得付出巨大的努力。</p><p id="741f" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">另一种方法是让您的Python代码更快。这就是Numba介入的地方:</p><blockquote class="ob"><p id="01c8" class="oc od it bd oe of og oh oi oj ok mn dk translated">Numba 是一个Python库，旨在提高你的Python代码的速度。Numba的目的是在运行时检查你的代码，看看是否有部分代码可以被翻译成快速机器码。</p></blockquote><p id="b5a2" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">听起来很复杂，对吧？确实是。然而，对于最终用户(也就是你)来说，使用Numba非常简单。通过几行额外的Python代码，您可以显著增加代码库的主要部分。你并不真的需要理解Numba是如何工作的才能看到结果。</p><p id="fcd1" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">在这篇博文中，我将向你展示Numba的基础知识，让你开始学习。如果你需要了解更多，那么我推荐<a class="ae lh" href="https://numba.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Numba文档</a>。如果你更喜欢视觉学习，那么我也制作了一个关于这个主题的视频:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oq or l"/></div></figure></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="31ff" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">2 —了解Numba和安装</h1><p id="5aac" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">让我先给你一个Numba的高层次概述👍</p><p id="db69" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">Numba这样描述自己:</p><blockquote class="ob"><p id="a59b" class="oc od it bd oe of og oh oi oj ok mn dk translated">Numba是一个开源的JIT编译器，它将Python和NumPy代码的子集翻译成快速的机器代码。— Numba文档</p></blockquote><p id="a3b5" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">我们来解开上面的说法。Numba是一个开源的轻量级Python库，它试图让你的代码更快。其方式是使用行业标准的<a class="ae lh" href="https://llvm.org/" rel="noopener ugc nofollow" target="_blank"> LLVM </a>编译器库。你不需要理解LLVM编译器库来使用Numba。</p><p id="c54d" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">在实践中，您将添加某些<a class="ae lh" href="https://realpython.com/primer-on-python-decorators/" rel="noopener ugc nofollow" target="_blank"> Python装饰器</a>来告诉Numba应该优化正在讨论的装饰函数。然后，在运行时，Numba会检查您的函数，并尝试将部分函数编译成快速机器码。</p><p id="f1e8" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">术语<strong class="mc jd"> JIT编译</strong>是<a class="ae lh" href="https://en.wikipedia.org/wiki/Just-in-time_compilation" rel="noopener ugc nofollow" target="_blank">即时编译</a>的缩写。因此，编译步骤发生在代码执行期间，而不是预先编译代码(例如C++)。实际的区别？您不会生成难以共享的二进制文件，而只会得到Python文件！</p><p id="198c" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">让我从Numba的主页向您展示一个代码示例，以演示Numba是多么容易使用。下面的代码是一个<a class="ae lh" href="https://en.wikipedia.org/wiki/Monte_Carlo_method" rel="noopener ugc nofollow" target="_blank">蒙特卡罗方法</a>用于近似圆周率的值。</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="3ec8" class="oy lj it ou b gy oz pa l pb pc">import random<br/><br/>def monte_carlo_pi(nsamples):<br/>    acc = 0<br/>    for i in range(nsamples):<br/>        x = random.random()<br/>        y = random.random()<br/>        if (x ** 2 + y ** 2) &lt; 1.0:<br/>            acc += 1<br/>    return 4.0 * acc / nsamples</span></pre><p id="eaea" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">Numba尚未应用于上述代码。如果变量<code class="fe pd pe pf ou b">nsamples</code>很大，那么函数<code class="fe pd pe pf ou b">monte_carlo_pi</code>相当慢。但是，添加下面两行代码会使它快很多:</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="5289" class="oy lj it ou b gy oz pa l pb pc">from numba import jit # &lt;-- importing jit from numba<br/>import random<br/><br/>@jit(nopython=True) # &lt;-- The only difference<br/>def monte_carlo_pi(nsamples):<br/>    acc = 0<br/>    for i in range(nsamples):<br/>        x = random.random()<br/>        y = random.random()<br/>        if (x ** 2 + y ** 2) &lt; 1.0:<br/>            acc += 1<br/>    return 4.0 * acc / nsamples</span></pre><p id="efeb" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">没那么糟，对吧？😃</p><p id="cc55" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">如果您通过Anaconda在Jupyter笔记本中工作，那么在Anaconda提示符下运行以下命令来安装Numba:</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="1ca5" class="oy lj it ou b gy oz pa l pb pc">conda install numba</span></pre><p id="700c" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">如果你在IDE中编写代码，比如Visual Studio Code<a class="ae lh" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">或者py charm</a><a class="ae lh" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank">或者PIP，那么你可能想通过PIP安装Numba:</a></p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="288b" class="oy lj it ou b gy oz pa l pb pc">$ pip install numba</span></pre><p id="bc29" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">更多高级选项，如从源代码编译Numba，可以在<a class="ae lh" href="https://numba.readthedocs.io/en/stable/user/5minguide.html" rel="noopener ugc nofollow" target="_blank">安装页面</a>中找到。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="6cf5" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">3—使用Jit装饰器</h1><p id="fcd4" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">现在Numba已经安装好了，你可以试用了。我创建了一个Python函数，它执行一些NumPy操作:</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="8e41" class="oy lj it ou b gy oz pa l pb pc">import numpy<br/>from numba import jit</span><span id="a147" class="oy lj it ou b gy pg pa l pb pc">def numpy_features(matrix: np.array) -&gt; None:<br/>    """Illustrates some common features of NumPy."""<br/>    cosine_trace = 0.0<br/>    for i in range(matrix.shape[0]):<br/>        cosine_trace += np.cos(matrix[i, i])<br/>    matrix = matrix + cosine_trace</span></pre><p id="2c23" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">上面的代码不用想太多。该功能的唯一目的是使用NumPy中的几个不同功能，如<a class="ae lh" href="https://numpy.org/doc/stable/reference/ufuncs.html" rel="noopener ugc nofollow" target="_blank">通用功能</a>和<a class="ae lh" href="https://numpy.org/doc/stable/user/basics.broadcasting.html" rel="noopener ugc nofollow" target="_blank">广播</a>。让我用Jupyter笔记本中的以下神奇命令为上面的代码计时:</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="3327" class="oy lj it ou b gy oz pa l pb pc">x = np.arange(1000000).reshape(1000, 1000)<br/>%time numpy_features(x)</span><span id="e6c1" class="oy lj it ou b gy pg pa l pb pc"><strong class="ou jd">Output:</strong><br/>Wall time: 32.3 ms</span></pre><p id="9bed" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">如果您运行上面的代码，根据您的硬件和其他因素，您将获得稍微不同的速度。这可能不是你见过的最慢的Python代码。然而，整个代码库中像这样的代码确实会降低整个应用程序的速度。</p><p id="ef44" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">现在让我们将<code class="fe pd pe pf ou b">@jit(nopython = true)</code>装饰器添加到函数中，看看会发生什么。代码现在应该如下所示:</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="cfc8" class="oy lj it ou b gy oz pa l pb pc">import numpy<br/>from numba import jit</span><span id="55df" class="oy lj it ou b gy pg pa l pb pc">@jit(nopython=True)<br/>def numpy_features(matrix: np.array) -&gt; None:<br/>    """Illustrates some common features of NumPy."""<br/>    cosine_trace = 0.0<br/>    for i in range(matrix.shape[0]):<br/>        cosine_trace += np.cos(matrix[i, i])<br/>    matrix = matrix + cosine_trace</span></pre><p id="3827" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">编写代码的方式没有太大变化，但是速度不同了。如果您再次对代码计时，您会得到以下结果:</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="da49" class="oy lj it ou b gy oz pa l pb pc">x = np.arange(1000000).reshape(1000, 1000)<br/>%time numpy_features(x)</span><span id="1bad" class="oy lj it ou b gy pg pa l pb pc"><strong class="ou jd">Output:</strong><br/>Wall time: 543 ms</span></pre><p id="e6d3" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">什么？代码变得比原始代码慢10倍😧</p><p id="c9bd" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">不要气馁。尝试再次运行代码:</p><pre class="ks kt ku kv gt ot ou ov ow aw ox bi"><span id="73c8" class="oy lj it ou b gy oz pa l pb pc">x = np.arange(1000000).reshape(1000, 1000)<br/>%time numpy_features(x)</span><span id="4deb" class="oy lj it ou b gy pg pa l pb pc"><strong class="ou jd">Output:</strong><br/>Wall time: 3.32 ms</span></pre><p id="0e19" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">现在的代码比原来的代码快了10倍。</p><p id="1d53" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">这是怎么回事？😵</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="2df5" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">4—三个陷阱</h1><h2 id="35d5" class="oy lj it bd lk ph pi dn lo pj pk dp ls mh pl pm lu mj pn po lw ml pp pq ly iz bi translated">编译的陷阱</h2><p id="7158" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">我给你看的这个奇怪的东西不是一个bug，而是一个特性。当你第一次用<code class="fe pd pe pf ou b">@jit(nopython=True)</code>装饰器运行函数时，代码会变慢。为什么？</p><p id="561a" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">第一次，Numba必须检查函数中的代码，并找出要优化的代码。这增加了<strong class="mc jd">额外的开销</strong>，因此该功能运行缓慢。然而，每次后续的功能会快得多。</p><p id="fb9a" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">这最初看起来像是一种权衡，但实际上并非如此。在数据分析和数据工程中，函数要运行很多次。</p><p id="e9fb" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">例如，考虑一个在预测之前对进入数据管道的新数据进行归一化的函数。在实时系统中，新数据一直在不断到达，函数每分钟被使用数百次甚至数千次。在这种系统中，最初较慢的运行可以在几秒钟内完成。</p><h2 id="8942" class="oy lj it bd lk ph pi dn lo pj pk dp ls mh pl pm lu mj pn po lw ml pp pq ly iz bi translated">不将参数nopython设置为True</h2><p id="d488" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">装饰器<code class="fe pd pe pf ou b">@jit(nopython=True)</code>可以不带参数<code class="fe pd pe pf ou b">nopython</code>使用。如果你这样做，那么默认情况下Numba将设置<code class="fe pd pe pf ou b">nopython=False</code>。</p><p id="4648" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">这不是一个好主意！</p><p id="5ee6" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">如果<code class="fe pd pe pf ou b">nopython=False</code>那么Numba不会在无法优化代码时提醒你。在实践中，您只需将Numba开销添加到代码中，而无需任何优化。这会降低代码的速度😠</p><p id="4cfa" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">如果Numba没有成功优化您的代码，那么您希望被告知。最好完全移除Numba装饰器。因此你应该总是使用参数<code class="fe pd pe pf ou b">@jit(nopython=True)</code>。</p><blockquote class="pr ps pt"><p id="a233" class="nj nk os mc b md nw kd nl mf nx kg nm pu ny no np pv nz nr ns pw oa nu nv mn im bi translated">专业提示:装饰者<code class="fe pd pe pf ou b">@njit</code>是<code class="fe pd pe pf ou b">@jit(nopython=True)</code>的简写，很多人用它来代替。</p></blockquote><h2 id="62fb" class="oy lj it bd lk ph pi dn lo pj pk dp ls mh pl pm lu mj pn po lw ml pp pq ly iz bi translated">不要过度优化你的代码</h2><p id="533e" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">过度优化代码意味着在不需要的时候花费大量时间来获得最佳性能。</p><p id="a05c" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated"><strong class="mc jd">不要过度优化你的代码！</strong></p><p id="a8d4" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">在许多情况下，代码速度并不那么重要(例如，批量处理中等数量的数据)。降低代码速度几乎总是会增加开发时间。仔细权衡是否应该将Numba整合到代码库中。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="1987" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">Numba闪耀的地方</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi px"><img src="../Images/0a368c0f53b2279c2051a3ef093dd73e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*meiFOn9vFaRz-_5W"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@coopery?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">穆罕默德·诺哈西</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="6702" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">假装Numba擅长优化任何类型的Python代码对任何人都没有帮助。Numba擅长优化的只是一些Python代码。</p><p id="1c75" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">Numba非常擅长优化任何涉及循环或NumPy代码的东西。由于许多机器学习库(如<a class="ae lh" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn </a>)大量使用Numpy，这是使用Numba的好地方🔥</p><p id="71e8" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">然而，Numba不理解例如熊猫。将<code class="fe pd pe pf ou b">@jit(nopython=True)</code>添加到一个纯粹处理熊猫数据帧的函数中可能不会产生很好的性能。参见<a class="ae lh" href="https://numba.readthedocs.io/en/stable/user/5minguide.html" rel="noopener ugc nofollow" target="_blank"> Numba文档</a>中的示例。</p><p id="584c" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">我的建议如下:</p><blockquote class="ob"><p id="eae7" class="oc od it bd oe of og oh oi oj ok mn dk translated">总是通过测试代码的速度来检查添加的Numba decorator是否增加了价值(在第一个编译步骤之后)。不要只是为了好玩而使用Numba decorators，必要时这样做可以加快代码的速度。</p></blockquote></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="500b" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">6—总结</h1><p id="9712" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">如果你需要了解更多关于Numba的信息，那么查看Numba文档<a class="ae lh" href="https://numba.pydata.org/" rel="noopener ugc nofollow" target="_blank">或我在Numba上的YouTube视频</a>。</p><p id="ec9d" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated"><strong class="mc jd">喜欢我写的？</strong>查看我的其他帖子，了解更多Python内容:</p><ul class=""><li id="ce05" class="ma mb it mc b md nw mf nx mh py mj pz ml qa mn qb mp mq mr bi translated">用漂亮的类型提示使你罪恶的Python代码现代化</li><li id="71d0" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn qb mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/visualizing-missing-values-in-python-is-shockingly-easy-56ed5bc2e7ea">用Python可视化缺失值非常简单</a></li><li id="f9dc" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn qb mp mq mr bi translated">【SymPy符号数学快速指南</li><li id="22c8" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn qb mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/5-awesome-numpy-functions-that-can-save-you-in-a-pinch-ba349af5ac47"> 5个超赞的数字功能，能在紧要关头救你一命</a></li><li id="fd15" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn qb mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/5-expert-tips-to-skyrocket-your-dictionary-skills-in-python-1cf54b7d920d"> 5个专家提示，让你的Python字典技能突飞猛进🚀</a></li></ul><p id="8d6a" class="pw-post-body-paragraph nj nk it mc b md nw kd nl mf nx kg nm mh ny no np mj nz nr ns ml oa nu nv mn im bi translated">如果你对数据科学、编程或任何介于两者之间的东西感兴趣，那么请随意在LinkedIn上加我，并向✋问好</p></div></div>    
</body>
</html>