<html>
<head>
<title>Simple Machine Translation: Yorùbá to English</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单的机器翻译:英语</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-machine-translation-yor%C3%B9b%C3%A1-to-english-1b958ccdc8a1?source=collection_archive---------16-----------------------#2021-08-02">https://towardsdatascience.com/simple-machine-translation-yor%C3%B9b%C3%A1-to-english-1b958ccdc8a1?source=collection_archive---------16-----------------------#2021-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/72803c670ce0042e64fbfe9f8a79c5b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*afHVS0LFJ1CkicPhIfwyug.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图片作者|元素作者Freepik : <a class="ae jd" href="https://www.freepik.com/pch-vector" rel="noopener ugc nofollow" target="_blank"> pch.vector </a>、<a class="ae jd" href="https://www.freepik.com/0melapics" rel="noopener ugc nofollow" target="_blank"> 0melapics </a>、<a class="ae jd" href="https://www.freepik.com/syarifahbrit" rel="noopener ugc nofollow" target="_blank"> syarifahbrit </a></p></figure><div class=""/><div class=""><h2 id="7e94" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">微调赫尔辛基NLP多语言模型，将文本从约伯语翻译成英语。</h2></div><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi kv"><img src="../Images/5dbdd1d4854da514a824905a8648935c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4oXiR7k7hPPd6ckn1aaSw.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">约鲁巴语机器翻译挑战| <a class="ae jd" href="https://zindi.africa/competitions/ai4d-yoruba-machine-translation-challenge" rel="noopener ugc nofollow" target="_blank">津迪</a></p></figure><blockquote class="la lb lc"><p id="3ee7" class="ld le lf lg b lh li kh lj lk ll kk lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jh"> <em class="jg">针对西班牙语读者:</em></strong><em class="jg"/><a class="ae jd" href="https://www.ibidem-translations.com/edu/traduccion-automatica-yoruba-ingles/" rel="noopener ugc nofollow" target="_blank"><em class="jg">traducción automática simple:del yorba inglés</em></a></p></blockquote></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h1 id="c0bb" class="mh mi jg bd mj mk ml mm mn mo mp mq mr km ms kn mt kp mu kq mv ks mw kt mx my bi translated">介绍</h1><p id="c7b1" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">在本文中，我们将构建一个机器翻译模型，将约鲁巴语句子翻译成英语。这些句子来自各种资源，如新闻文章、社交媒体上的对话、口头记录以及纯用约鲁巴语编写的书籍。</p><p id="f543" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">低资源语言的机器翻译非常少见，而且由于这些语言的可用训练数据有限，很难得到准确的结果。我们有一个可用于约鲁巴语文本(JW300)的数据集，但它是用来训练宗教领域的。我们需要一个一般化的模型，可以在多个领域中使用，这就是<a class="ae jd" href="https://ai4d.ai/" rel="noopener ugc nofollow" target="_blank"><strong class="lg jh">AI4D . ai</strong></a><strong class="lg jh"/>带来更多一般化数据的地方，我们所要做的就是根据这些数据训练我们的模型，并产生一个准确的结果，以确保在<strong class="lg jh"/><a class="ae jd" href="https://zindi.africa/competitions/ai4d-yoruba-machine-translation-challenge" rel="noopener ugc nofollow" target="_blank">AI4D yorübá机器翻译挑战赛— Zindi </a>中的领先地位。</p><p id="60c7" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">在这个项目中，我们将使用赫尔辛基NLP模式，所以让我们把他们作为一个组织来讨论。</p><h2 id="190f" class="nh mi jg bd mj ni nj dn mn nk nl dp mr nb nm nn mt nd no np mv nf nq nr mx ns bi translated">赫尔辛基NLP</h2><p id="5590" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">赫尔辛基大学的语言技术研究小组训练了赫尔辛基NLP模型。他们的使命是为所有人类语言提供机器翻译。他们还研究和开发处理人类语言的工具，包括自动拼写和语法检查、<a class="ae jd" href="https://translate.ling.helsinki.fi/" rel="noopener ugc nofollow" target="_blank">机器</a>翻译和ASR(自动语音识别)更多信息请访问<a class="ae jd" href="https://blogs.helsinki.fi/language-technology/" rel="noopener ugc nofollow" target="_blank">语言技术</a>。这些模型在<a class="ae jd" href="https://huggingface.co/Helsinki-NLP" rel="noopener ugc nofollow" target="_blank"> HuggingFace </a>和GitHub上公开发售。</p><h1 id="6d7c" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">导入基本库</h1><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h1 id="9a9a" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">选择选项</h1><ul class=""><li id="888c" class="oa ob jg lg b lh mz lk na nb oc nd od nf oe lz of og oh oi bi translated">要清理你的文本，你需要使<strong class="lg jh"> <em class="lf"> Clean </em> </strong>变量为真，因为现在我正在训练我的数据而没有清理。</li><li id="3ce1" class="oa ob jg lg b lh oj lk ok nb ol nd om nf on lz of og oh oi bi translated">如果你想训练你的模型，使<strong class="lg jh"> <em class="lf">训练</em> </strong>变量<strong class="lg jh">为真</strong>。</li></ul><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="oo nz l"/></div></figure><h1 id="fdc5" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">读取翻译数据</h1><p id="96d5" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">使用pandas阅读训练数据，对我们的数据集有初步的了解。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="op nz l"/></div></figure><p id="5f5d" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">训练数据包括10，054个平行的约伯语-英语句子。我们有三列<strong class="lg jh"> ID </strong>:唯一标识符、<strong class="lg jh">约鲁巴语</strong>:包含约鲁巴语的文本和<strong class="lg jh">英语</strong>:文本包含约鲁巴语的英语翻译。数据看起来相当干净，没有丢失的值。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="oq nz l"/></div></figure><h1 id="3b70" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">清理数据</h1><p id="fce3" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">我们已经删除了标点符号，将文本转换为小写，并删除了文本中的数字，以使我们的模型性能更好。现在，我将关闭这个特性，但是我将在以后的实验中使用它。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="or nz l"/></div></figure><h1 id="dd68" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">正在加载标记器和模型</h1><p id="aa3a" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">我们使用了机器翻译中隐藏的宝石，它被训练成多种语言，包括约鲁巴语。赫尔辛基NLP模型是机器语言翻译领域最好的模型之一，它们具有迁移学习功能，这意味着我们可以使用相同的模型和相同的权重，并根据我们的新数据进行微调，以获得最佳结果。我们将使用<a class="ae jd" href="https://huggingface.co/Helsinki-NLP/opus-mt-mul-en" rel="noopener ugc nofollow" target="_blank">Helsinki-NLP/opus-mt-mul-en拥抱脸</a>模型，并在由<strong class="lg jh">人工智能促进发展-非洲网络(</strong><a class="ae jd" href="https://ai4d.ai/" rel="noopener ugc nofollow" target="_blank"><strong class="lg jh">ai4d . ai</strong></a><strong class="lg jh">)提供的更一般化的约鲁巴语文本上对其进行微调。</strong></p><p id="d189" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">这个模型可以在拥抱脸网站上公开获得，使用变形金刚库很容易下载和训练。我们将使用GPU，添加<code class="fe os ot ou ov b">.to(cuda)</code>将激活该模型上的GPU。</p><ul class=""><li id="4e6a" class="oa ob jg lg b lh li lk ll nb ow nd ox nf oy lz of og oh oi bi translated"><strong class="lg jh">源组</strong>:多种语言</li><li id="6279" class="oa ob jg lg b lh oj lk ok nb ol nd om nf on lz of og oh oi bi translated"><strong class="lg jh">目标人群</strong>:英语</li><li id="bbcf" class="oa ob jg lg b lh oj lk ok nb ol nd om nf on lz of og oh oi bi translated"><strong class="lg jh">作品自述</strong> : <a class="ae jd" href="https://github.com/Helsinki-NLP/Tatoeba-Challenge/tree/master/models/mul-eng/README.md" rel="noopener ugc nofollow" target="_blank">多英</a></li><li id="e9f7" class="oa ob jg lg b lh oj lk ok nb ol nd om nf on lz of og oh oi bi translated"><strong class="lg jh">型号</strong>:变压器</li></ul><p id="7490" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated"><em class="lf">如果你有良好的互联网连接，下载和加载模型不会花太多时间</em></p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="oz nz l"/></div></figure><pre class="kw kx ky kz gt pa ov pb pc aw pd bi"><span id="e9a2" class="nh mi jg ov b gy pe pf l pg ph">Downloading: 100% 1.15k/1.15k [00:00&lt;00:00, 23.2kB/s]<br/>Downloading: 100% 707k/707k [00:00&lt;00:00, 1.03MB/s]<br/>Downloading: 100% 791k/791k [00:00&lt;00:00, 1.05MB/s]<br/>Downloading: 100% 1.42M/1.42M [00:00&lt;00:00, 2.00MB/s]<br/>Downloading: 100% 44.0/44.0 [00:00&lt;00:00, 1.56kB/s]<br/>Downloading: 100% 310M/310M [00:27&lt;00:00, 12.8MB/s]</span></pre><h1 id="4ebc" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">准备培训模型</h1><h2 id="dfec" class="nh mi jg bd mj ni nj dn mn nk nl dp mr nb nm nn mt nd no np mv nf nq nr mx ns bi translated">【计算机】优化程序</h2><p id="556f" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">我们将使用AdamW优化器来使我们的模型快速收敛，并以0.0001的学习率提供更好的结果。我试验了PyTorch库中不同的优化器，AdamW在这个问题上表现得更好。通过进行超参数调整，我以0.0001的学习率获得了最好的结果。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="op nz l"/></div></figure><p id="9e27" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">我使用了<a class="ae jd" href="https://www.kaggle.com/ekshusingh/helsinki-nlp-opus-mt-en-fr" rel="noopener ugc nofollow" target="_blank"> ekshusingh </a>技术来微调赫尔辛基NLP模型。它训练速度快，并且只需要很少的样本就能产生更好的结果。</p><p id="f007" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">我做了一些超参数调整，得到了27个<strong class="lg jh">时期</strong>和32个<strong class="lg jh">批量</strong>的最终参数。</p><p id="6360" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated"><code class="fe os ot ou ov b">model_train()</code>功能首先将批次分为<code class="fe os ot ou ov b">local_X</code>和<code class="fe os ot ou ov b">local_y</code>。我们使用来自记号赋予器的<code class="fe os ot ou ov b">prepare_seq2seq_batch</code>函数将文本转换成记号，这些记号可以用作我们模型的输入。然后，我们使用梯度下降来减少损失，并打印最终损失。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pi nz l"/></div></figure><h1 id="7603" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">培养</h1><p id="8d61" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">模型的训练花费30分钟，有27个时期，每个时期花费大约38秒来运行。最终损失为0.0755，这相当不错，显然我们的模型表现良好，但我们仍需要在评估指标上检查它。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="oo nz l"/></div></figure><pre class="kw kx ky kz gt pa ov pb pc aw pd bi"><span id="416f" class="nh mi jg ov b gy pe pf l pg ph">100% 125/125 [00:38&lt;00:00, 3.84it/s]</span><span id="b2a7" class="nh mi jg ov b gy pj pf l pg ph">Loss: tensor(0.0755, device='cuda:0', grad_fn=&lt;DivBackward0&gt;)</span></pre><h1 id="bb2c" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">测试模型</h1><p id="d683" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">对测试数据集中的单一样本进行测试。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="oo nz l"/></div></figure><p id="a9fd" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">模型表现得相当好，句子有道理。我们需要删除括号和其他不必要的标点符号<code class="fe os ot ou ov b">&lt;pad&gt;</code>，以进一步清理我们的数据集。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pk nz l"/></div></figure><p id="7893" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">使用字符串<code class="fe os ot ou ov b">sub</code>和<code class="fe os ot ou ov b">replace</code>，我们从文本中移除了<code class="fe os ot ou ov b">&lt;pad&gt;,', [,]</code>。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pl nz l"/></div></figure><p id="614d" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">最终的文本看起来很干净，对于最初的评估几乎是完美的。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pk nz l"/></div></figure><h1 id="adce" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">对测试数据集的预测</h1><p id="acf1" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">让我们从测试数据集进行预测，并检查我们的模型表现如何。我们将加载您可以从Zindi平台访问的测试数据集。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="op nz l"/></div></figure><p id="6c0a" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">生成预测并将张量批量解码成文本。使用<code class="fe os ot ou ov b">.progress_apply</code>我们已经翻译了测试数据集中的所有约鲁巴语文本，并将其移动到名为<code class="fe os ot ou ov b">Label</code>的新列中</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pm nz l"/></div></figure><p id="2170" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">清除我们预测的翻译。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="pn nz l"/></div></figure><p id="d6b1" class="pw-post-body-paragraph ld le jg lg b lh li kh lj lk ll kk lm nb lo lp lq nd ls lt lu nf lw lx ly lz ij bi translated">你可以看到我们测试数据集的最终版本，它非常准确。为了检查我们的模型在测试数据集上的表现，我们将尝试在Zindi平台上上传文件。</p><figure class="kw kx ky kz gt is"><div class="bz fp l di"><div class="oq nz l"/></div></figure><h2 id="2b89" class="nh mi jg bd mj ni nj dn mn nk nl dp mr nb nm nn mt nd no np mv nf nq nr mx ns bi translated">公制的</h2><p id="20b1" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">比赛使用<a class="ae jd" href="https://pypi.org/project/rouge-score/" rel="noopener ugc nofollow" target="_blank">胭脂分数</a>指标，分数越高，你的模型表现越好。我们这款的排行榜分数是0.3025还不错，能让你进前20。</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi po"><img src="../Images/c75d03704664cf4a53a2590b33d93ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-qHtteLRQE32p8RcZaF-Kw.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者指标| Zindi排行榜得分</p></figure><h1 id="84da" class="mh mi jg bd mj mk nt mm mn mo nu mq mr km nv kn mt kp nw kq mv ks nx kt mx my bi translated">结论</h1><p id="149e" class="pw-post-body-paragraph ld le jg lg b lh mz kh lj lk na kk lm nb nc lp lq nd ne lt lu nf ng lx ly lz ij bi translated">利用迁移学习的能力，我们创建了一个在通用约鲁巴语文本上表现良好的模型。赫尔辛基NLP机器翻译多语言模型表现相当好。我在HugginFace和<a class="ae jd" href="https://huggingface.co/Helsinki-NLP/opus-mt-mul-en" rel="noopener ugc nofollow" target="_blank"> opus-mt-mul-en </a>上试验了许多公开可用的模型，到目前为止，它们在我们的低资源语言上表现得最好。由于谷歌翻译，机器翻译研究已经衰落，但谷歌翻译不提供低资源语言的翻译，其中一些语言不太准确，所以微调您的机器翻译模型为您提供了使用转换器翻译任何低资源语言的自由。最后，这是我的起始代码，通过多次实验和预处理文本，我以0.35168的最终Rogue分数在比赛中获得了第14名。</p><figure class="kw kx ky kz gt is gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/5d4296c76dac6833462f39b8ee90d61a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*rO1gbwYtQFpINJUQmGmm2w.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">竞赛排行榜| <a class="ae jd" href="https://zindi.africa/competitions/ai4d-yoruba-machine-translation-challenge/leaderboard" rel="noopener ugc nofollow" target="_blank">津迪</a></p></figure><blockquote class="la lb lc"><p id="5188" class="ld le lf lg b lh li kh lj lk ll kk lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">你可以在<a class="ae jd" href="https://huggingface.co/kingabzpro/Helsinki-NLP-opus-yor-mul-en" rel="noopener ugc nofollow" target="_blank">kingabzpro/Helsinki-NLP-opus-yor-mul-en拥抱脸</a>上找到我的模特</p></blockquote></div></div>    
</body>
</html>