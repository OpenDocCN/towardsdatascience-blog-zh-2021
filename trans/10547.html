<html>
<head>
<title>Detecting Outliers Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python检测异常值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/detecting-outliers-using-python-66b25fc66e67?source=collection_archive---------11-----------------------#2021-10-08">https://towardsdatascience.com/detecting-outliers-using-python-66b25fc66e67?source=collection_archive---------11-----------------------#2021-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ba05" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用隔离森林进行自动异常检测</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ef61b69685d7d5a5bd70e6f9c94dc3d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LhOqDBzJFiibuV5m"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">鲁珀特·布里顿在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="a001" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是离群点检测？</h1><p id="74de" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在构建任何类型的机器学习模型之前探索数据时，检测异常值可能很重要。异常值的一些原因包括数据收集问题、测量错误和数据输入错误。检测异常值是分析数据点中潜在错误的一个步骤，这些错误可能需要在模型训练之前消除。这有助于防止机器学习模型学习不正确的关系并潜在地降低准确性。</p><p id="6e09" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我们将模拟一个来自两个分布的数据集，看看我们能否检测出异常值。</p><h1 id="f9f1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据生成</h1><p id="461d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了测试异常值检测模型，生成了来自两个样本的虚拟数据集。从一个分布中随机抽取200个点，从一个单独的移位分布中随机抽取5个点，这样我们就有了下面的起点。你会看到蓝色的200个初始点和橙色的异常值。我们知道哪一个是哪一个，因为这是生成的数据，但在未知的数据集上，目标是在没有内部知识的情况下从本质上发现异常值。让我们看看一些现成的scikit-learn算法能做得有多好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/680182dd32d26d5109887715883d442f.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/0*1-AFFpxVSH5McyXX.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">初始数据集</p></figure><h1 id="24ef" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">隔离森林</h1><p id="a811" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">检测异常值的一种方法是使用scikit-learn的<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html" rel="noopener ugc nofollow" target="_blank">隔离森林</a>模型。这使我们能够构建一个类似于随机森林的模型，但旨在检测离群值。</p><p id="09d1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据生成后的pandas数据框架起点如下——一列为数值，另一列为我们可用于准确性评分的基本事实:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/3c6d75d254935383da5f5ea9d5690234.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/0*QUNF_LSn72-i6fTl.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">初始数据帧—前5行</p></figure><h1 id="e39f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">拟合模型</h1><p id="6762" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">第一步是拟合我们的模型，注意拟合方法只接受X，因为这是一个无监督的机器学习模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="e60e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">预测异常值</h1><p id="d31b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用predict方法，我们可以预测一个值是否是异常值(1不是异常值，接近-1就是异常值)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="5db7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">查看结果</h1><p id="1586" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了查看结果，我们将绘制并计算精确度。在原始数据集上绘制新的预测列会产生以下结果。我们可以看到离群值被恰当地提取出来；然而，我们的标准分布也有一些尾部。我们可以进一步修改污染参数，将其调整到我们的数据集，但这是一个很好的开箱即用的过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/c22283249f77de8dc04b455ddbd0ee10.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/0*5YNpOOsdpoHRyQQI.png"/></div></figure><p id="b886" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个例子中，还可以简单地计算准确度、精确度和召回率。该模型有90%的准确性，因为初始数据集中的一些数据点被错误地标记为异常值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="bed3" class="nb la it mx b gy nc nd l ne nf">Output: Accuracy 90%, Precision 20%, Recall 100%</span></pre><h1 id="8719" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">解释规则</h1><p id="e555" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以使用决策树分类器来解释这里发生的一些事情。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="849f" class="nb la it mx b gy nc nd l ne nf">|--- Value &lt;= 1.57<br/>|   |--- Value &lt;= -1.50<br/>|   |   |--- class: Outlier<br/>|   |--- Value &gt;  -1.50<br/>|   |   |--- class: Standard<br/>|--- Value &gt;  1.57<br/>|   |--- class: Outlier</span></pre><p id="f00e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">基本规则是将-1.5和1.57作为确定“正常”的范围，其他一切都是异常值。</p><h1 id="4aeb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">椭圆形信封</h1><p id="caeb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">隔离林不是检测异常值的唯一方法。另一个适合高斯分布数据的是<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.covariance.EllipticEnvelope.html#sklearn.covariance.EllipticEnvelope" rel="noopener ugc nofollow" target="_blank">椭圆包络</a>。</p><p id="b8a7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">代码本质上是相同的，我们只是换出了正在使用的模型。由于我们的数据是从随机样本中抽取的，这导致了一个稍微更好的拟合。</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="de19" class="nb la it mx b gy nc nd l ne nf">Output: Accuracy 92%, Precision 24%, Recall 100%</span></pre><p id="f1bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可以对我们的数据运行不同的异常值检测模型来自动检测异常值。这可能是分析可能对我们的建模工作产生负面影响的潜在数据问题的第一步。</p><p id="a5df" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ng">所有的例子和文件都可以在</em> <a class="ae ky" href="https://github.com/bstuddard/python-examples/tree/master/outlier-detection/isolation-forest" rel="noopener ugc nofollow" target="_blank"> <em class="ng"> Github </em> </a> <em class="ng">上找到。</em></p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="15b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ng">原发布于</em><a class="ae ky" href="https://datastud.dev/posts/python-outlier-detection" rel="noopener ugc nofollow" target="_blank"><em class="ng">https://data stud . dev</em></a><em class="ng">。</em></p></div></div>    
</body>
</html>