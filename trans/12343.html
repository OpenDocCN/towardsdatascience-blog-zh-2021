<html>
<head>
<title>Data Vault in BigQuery: How to create and manage tables for master data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BigQuery中的数据仓库:如何创建和管理主数据的表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-vault-in-bigquery-how-to-create-and-manage-tables-for-master-data-cd043cc9c55e?source=collection_archive---------18-----------------------#2021-12-15">https://towardsdatascience.com/data-vault-in-bigquery-how-to-create-and-manage-tables-for-master-data-cd043cc9c55e?source=collection_archive---------18-----------------------#2021-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e35d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为主数据创建中心和卫星表</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ade694000854e9155f0e0a969864f3a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4SjvfJY7cW3CXndm"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">劳拉·奥克尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="dfed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我之前的帖子中，我写了关于<a class="ae kv" rel="noopener" target="_blank" href="/what-is-a-data-lake-it-is-not-a-data-swamp-376430d6c15e">建立一个数据湖</a>和<a class="ae kv" rel="noopener" target="_blank" href="/antipatterns-and-obsolete-mindset-in-corporations-74540f128bc0">企业中过时的数据思维</a>。嗯……最近，我们决定为我的雇主评估Google BigQuery中的数据仓库模型。在这样做的过程中，我想与大家分享我们小小的成功故事。在本文中，我想与您分享一个例子，说明我们如何将主数据从源系统加载到Data Vault模型中。</p><h1 id="2971" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">基础</h1><h2 id="eca6" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">什么是集线器表？</h2><p id="becf" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">集线器包含唯一标识一个实体的键(业务键)。例如，这些可以是账号或客户号。对于每个键，您创建一个代理键，比如一个<em class="nb">散列业务键</em>。除了密钥之外，<em class="nb">加载时间戳</em>和<em class="nb">源</em>也被存储。</p><h2 id="2b0a" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">什么是卫星桌？</h2><p id="d65f" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">描述性信息存储在卫星中。像地址、年龄、出生日期或其他任何信息。卫星中没有商业密钥。使用代理键。所有描述性列被散列在一起，并存储在每个记录的表中，以检测新输入记录中的变化。</p><h1 id="1d6d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">开发数据仓库模型</h1><h2 id="e178" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">设置强制表</h2><p id="b979" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">在我们的实验中，我们考虑将客户数据从源系统加载到一个数据仓库模型中。那么我们需要哪些桌子呢？</p><ul class=""><li id="53a1" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated"><strong class="ky ir"> <em class="nb">作为我们源系统的客户表</em> </strong></li><li id="fe1f" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir"> <em class="nb">枢纽表</em> </strong>管理业务和代理键</li><li id="4184" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated"><strong class="ky ir"> <em class="nb">卫星表</em> </strong>持久化客户的所有描述性数据</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/ee68969bb73f0db056d82f936eee8045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3XcKscGkTe377R8EQrjekw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者创建</p></figure><p id="51f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意卫星表中的hash_diff。hash_diff包含由描述性列组成的散列。</p><h2 id="b6da" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">加载客户数据的SQL脚本</h2><p id="68e5" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">下面您可以看到两个BigQuery SQL脚本，分别用于将客户数据加载到Hub和Satellite。</p><p id="800e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将按照下面的工作流程加载卫星表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/3840080b0a8c40418fd95e26727260c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*rUkFjmP0rtuhfcIutH7muQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者创作[灵感来自blog.scalefree.com]</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者创建</p></figure><p id="45d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下代码显示了Hub表的加载脚本。工作流程类似于第一个。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者创建</p></figure><h2 id="3d4c" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">结果</h2><p id="1d7d" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">在下图中，您可以看到带有一些示例数据的工作流。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/94ee950a650de78a02baf1131cee591b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*86Qoz1IcdDoZysf97JwCBg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者创建</p></figure><h1 id="b263" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="24bb" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">我希望你喜欢这个小帖子，我也希望它能让一些人开心。尤其是在BigQuery环境中，你不会发现太多关于Data Vault的内容。请不吝赐教。</p></div></div>    
</body>
</html>