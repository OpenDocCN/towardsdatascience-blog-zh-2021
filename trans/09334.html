<html>
<head>
<title>Working with Multi-Index Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用多索引熊猫数据框架</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/working-with-multi-index-pandas-dataframes-f64d2e2c3e02?source=collection_archive---------8-----------------------#2021-08-30">https://towardsdatascience.com/working-with-multi-index-pandas-dataframes-f64d2e2c3e02?source=collection_archive---------8-----------------------#2021-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8e56" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何轻松使用多索引数据框架</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bb4b73ef8f9670af3fdb16b24b77cb3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OjlEsokG-wF9UZZh"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@freegraphictoday?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">absolute vision</a>拍摄</p></figure><p id="c5c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数熊猫数据帧的学习者都熟悉数据帧的样子，以及如何使用<strong class="lb iu"> loc[] </strong>和<strong class="lb iu"> iloc[] </strong>索引器方法提取行和列。然而，当涉及到多索引数据框架时，事情会变得非常棘手。多索引(也称为<em class="lv">层次索引</em>)数据帧使用多个列作为数据帧的索引。一个多索引的数据框架允许你以多维的格式存储你的数据，并且打开了许多令人兴奋的来表示你的数据。</p><p id="7c41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您介绍如何操作多索引数据帧，以及您可能会遇到的一些陷阱。也就是说，系好安全带——这将是一次过山车之旅！开个玩笑，会很有趣的！</p><h1 id="6e73" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">加载数据集</h1><p id="0b71" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">对于本文，我将使用下面的数据框架进行说明:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="25ef" class="my lx it mu b gy mz na l nb nc">import pandas as pd</span><span id="9a7b" class="my lx it mu b gy nd na l nb nc">scores = {'Zone': ['North','South','South',<br/>                   'East','East','West','West','West','West'], <br/>          'School': ['Rushmore','Bayside','Rydell',<br/>                     'Shermer','Shermer','Ridgemont',<br/>                     'Hogwarts','Hogwarts','North Shore'],             <br/>          'Name': ['Jonny','Joe','Jakob', <br/>                   'Jimmy','Erik','Lam','Yip','Chen','Jim'], <br/>          'Math': [78,76,56,67,89,100,55,76,79],<br/>          'Science': [70,68,90,45,66,89,32,98,70]}</span><span id="d908" class="my lx it mu b gy nd na l nb nc">df = pd.DataFrame(scores, columns = <br/>                  ['Zone', 'School', 'Name', <br/>                   'Science', 'Math'])<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ccbbd4df203376933a7dee82c2970e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*f-glQsnVp7uNBsieODAkDg.png"/></div></figure><h1 id="076e" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">获取多索引数据帧</h1><p id="e800" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当您在<strong class="lb iu"> df </strong>数据帧上应用聚合函数时，您将获得一个多索引数据帧:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="b842" class="my lx it mu b gy mz na l nb nc"><strong class="mu iu">df_result_zone_school</strong> = df.groupby(['Zone','School'])<strong class="mu iu">.agg(<br/>    {<br/>        'Science':['mean','min','max'],<br/>        'Math':['mean','min','max']<br/>    })</strong><br/>df_result_zone_school</span></pre><p id="15de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/fe751f107ed79437fcbf1fe1e7946e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aa2x4UU3iUX6beks3wnezA.png"/></div></div></figure><p id="60b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您拥有的是一个具有多列的数据帧，这些列充当数据帧的索引(通常称为<em class="lv">多索引</em>数据帧)。此外，列标题还包含多个级别。</p><p id="b144" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面几节中，我将向您展示如何从多索引数据帧中提取行和列。</p><h1 id="5e1c" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">使用列</h1><p id="3ce5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">让我们先从柱子开始。您可以使用<strong class="lb iu">列</strong>属性来获取列标题列表:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="99dc" class="my lx it mu b gy mz na l nb nc">df_result_zone_school<strong class="mu iu">.columns</strong></span></pre><p id="bf14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将看到以下内容:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="07a2" class="my lx it mu b gy mz na l nb nc">MultiIndex(levels=[['Science', 'Math'], ['mean', 'min', 'max']],<br/>           codes=[[0, 0, 0, 1, 1, 1], [0, 1, 2, 0, 1, 2]])</span></pre><p id="d0e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标题按级别分组，第一列属于0级，第一列属于下一级:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/f1ea5711a1c5dc6cee109e0449b8464b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*09CfL-Air0HhwlrU0Q6Wjg.png"/></div></div></figure><p id="cf1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<strong class="lb iu">列获得每个级别的值。get_level_values() </strong>函数:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bfd8" class="my lx it mu b gy mz na l nb nc">print(df_result_zone_school.columns.get_level_values(0))<br/>print(df_result_zone_school.columns.get_level_values(1))</span></pre><p id="4ea0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将打印以下内容:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="dab4" class="my lx it mu b gy mz na l nb nc">Index(['Science', 'Science', 'Science', 'Math', 'Math', 'Math'], dtype='object')</span><span id="cae7" class="my lx it mu b gy nd na l nb nc">Index(['mean', 'min', 'max', 'mean', 'min', 'max'], dtype='object')</span></pre><h2 id="4c9a" class="my lx it bd ly nh ni dn mc nj nk dp mg li nl nm mi lm nn no mk lq np nq mm nr bi translated">提取具有0级标题的列</h2><p id="78fa" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果您想要提取一个单独的列，比如说<strong class="lb iu">科学</strong>列，您可以简单地指定0级列名:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="e256" class="my lx it mu b gy mz na l nb nc">df_result_zone_school[<strong class="mu iu">'Science'</strong>]</span></pre><p id="cd61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将产生以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/e079db8767d11e41dbf5d09ae58dac01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*TLMiwfC5xraNks1kxXKTLA.png"/></div></figure><p id="e009" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，结果中不包括<strong class="lb iu">科学</strong>列标题。要包含它，请用列表(<strong class="lb iu"> [] </strong>)将列名括起来:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4caf" class="my lx it mu b gy mz na l nb nc">df_result_zone_school[<strong class="mu iu">['Science']</strong>]</span></pre><p id="1277" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">科学</strong>列标题现在包含在结果中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/051158a2199975d70e5a2a8c9d27e0d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*RIO3xrDi5zTACWktmSQwSg.png"/></div></figure><p id="2c96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果需要其他列，只需将列名添加到列表中:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="805a" class="my lx it mu b gy mz na l nb nc">df_result_zone_school[['Science'<strong class="mu iu">, 'Math'</strong>]]</span></pre><p id="01d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">科学</strong>和<strong class="lb iu">数学</strong>列现在都会出现在结果中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/d31402db9b4174ff4acf9afb4f9394ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHXiiGR_IppeoGb5Ukv9AA.png"/></div></div></figure><h2 id="832e" class="my lx it bd ly nh ni dn mc nj nk dp mg li nl nm mi lm nn no mk lq np nq mm nr bi translated">提取具有0级和1级标题的列</h2><p id="353f" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果你只想得到<strong class="lb iu">理科，意思是</strong>列呢？在这种情况下，可以通过<strong class="lb iu">科学</strong>和<strong class="lb iu">意思</strong>作为元组:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3262" class="my lx it mu b gy mz na l nb nc">df_result_zone_school[<strong class="mu iu">('Science','mean')</strong>]</span></pre><p id="9606" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回一个<strong class="lb iu">系列</strong>(即一个<em class="lv">多索引系列</em>):</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5048" class="my lx it mu b gy mz na l nb nc">Zone   School     <br/>East   Shermer        55.5<br/>North  Rushmore       70.0<br/>South  Bayside        68.0<br/>       Rydell         90.0<br/>West   Hogwarts       65.0<br/>       North Shore    70.0<br/>       Ridgemont      89.0<br/>Name: (Science, mean), dtype: float64</span></pre><p id="49ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望结果是数据帧吗？使用列表(<strong class="lb iu"> [] </strong>)包装元组:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="47ec" class="my lx it mu b gy mz na l nb nc">df_result_zone_school[<strong class="mu iu">[('Science','mean')]</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/8b4393b4d3e92eb45a6f6b3d875b230a.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*x6HwXufEQgEtyGXd15bLPw.png"/></div></figure><p id="b9b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<strong class="lb iu">科学</strong>下的<em class="lv">和</em>都是指和<strong class="lb iu">最小</strong>栏呢？您可能会尝试这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="795c" class="my lx it mu b gy mz na l nb nc">df_result_zone_school[('Science',<strong class="mu iu">['mean','min']</strong>)]</span></pre><p id="53d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，这不起作用。相反，您必须使用<strong class="lb iu"> loc[] </strong>索引器:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d6e6" class="my lx it mu b gy mz na l nb nc">df_result_zone_school<strong class="mu iu">.loc</strong>[<strong class="mu iu">:</strong>, <strong class="mu iu">('Science',['mean','min'])</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/e565fb780c2aa12c1e6613b238a3223d.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*fENwROssDU1AlmIUVATWkA.png"/></div></figure><p id="3261" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面也可以写成:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a228" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[:,<strong class="mu iu">[('Science','mean'),<br/>                             ('Science','min')]</strong>]</span></pre><p id="ed0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种技术，您现在可以检索基于0级和1级标题的附加列:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ab2d" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[:,[('Science','mean'),<br/>                             ('Science','min'),<br/>                             <strong class="mu iu">('Math','mean')</strong>]]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/f992abc150b080bc5dd0ca32dbc85457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*xBn0p7Ohn5bluJvNideLQw.png"/></div></figure><p id="feeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">务必注意，下面的<strong class="lb iu">将<em class="lv">而不是</em>将</strong>工作:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="e96c" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[:, [('Science',['mean','min']), <br/>                              ('Math','mean')]]</span></pre><h2 id="1827" class="my lx it bd ly nh ni dn mc nj nk dp mg li nl nm mi lm nn no mk lq np nq mm nr bi translated">分割列</h2><p id="8eb0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">您可以对0级列标题执行切片:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="7de8" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[:,<strong class="mu iu">'Science':'Math'</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/823a863a52036b922babe4685dde5dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YGCKi_cqoccO8UwJNya5sQ.png"/></div></div></figure><p id="ad7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一级标题上切片怎么样？像下面这样的？</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6185" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[:,('Science','mean':'max')]</span></pre><p id="2d8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不，这不行。要对1级头进行切片，您需要将开始和结束指定为元组:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ba6a" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[:,<strong class="mu iu">('Science','mean'):('Science','max')</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/1a0e7692aca8f6f55a2fd8534692f2a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*3sJb_wiQKS2lMRLWWk7K-Q.png"/></div></figure><p id="8525" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是另一个跨0级和1级头切片的例子:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="114a" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[:,<strong class="mu iu">('Science','mean'):('Math','min')</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/6ccac978c7c80906f0fb8b051d26cdc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*DHJdj_BMEP2zGaq8fzo45A.png"/></div></figure><h1 id="e9e6" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">使用行</h1><p id="88c9" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在您已经查看了列，是时候查看行了。首先要做的是检查数据帧的索引:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c4b2" class="my lx it mu b gy mz na l nb nc">df_result_zone_school<strong class="mu iu">.index</strong></span></pre><p id="697a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该看到以下内容:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d64c" class="my lx it mu b gy mz na l nb nc">MultiIndex([( 'East',     'Shermer'),<br/>            ('North',    'Rushmore'),<br/>            ('South',     'Bayside'),<br/>            ('South',      'Rydell'),<br/>            ( 'West',    'Hogwarts'),<br/>            ( 'West', 'North Shore'),<br/>            ( 'West',   'Ridgemont')],<br/>           names=['Zone', 'School'])</span></pre><p id="9ded" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">索引中的每一项都是包含0级(<strong class="lb iu">区</strong>)和1级(<strong class="lb iu">学校</strong>)索引的元组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/ce25b2a99845ce83fc55a4b5474d2926.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*3TXMgVoDX_fHQ2LXZgNJ7w.png"/></div></figure><p id="d8a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与列标题一样，您可以使用<strong class="lb iu"> get_level_values() </strong>函数来获取各个级别的索引:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c045" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.index<strong class="mu iu">.get_level_values(0)</strong>     # level-0</span></pre><p id="7609" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与列标题不同，索引的每个级别都有一个名称。除了通过级别号获取索引，您还可以直接使用其名称:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c603" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.index.get_level_values('<strong class="mu iu">Zone</strong>')</span></pre><p id="6294" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述两个语句的结果是:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="e1e6" class="my lx it mu b gy mz na l nb nc">Index(['East', 'North', 'South', 'South', 'West', 'West', 'West'], dtype='object', name='Zone')</span></pre><p id="e3a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得1级指数:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="870d" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.index.get_level_values(1)      # level-1<br/><em class="lv"># OR</em><br/>df_result_zone_school.index.get_level_values('<strong class="mu iu">School</strong>')</span></pre><p id="7922" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="028a" class="my lx it mu b gy mz na l nb nc">Index(['Shermer', 'Rushmore', 'Bayside', 'Rydell', 'Hogwarts', 'North Shore', 'Ridgemont'],<br/>      dtype='object', name='School')</span></pre><h2 id="b2b1" class="my lx it bd ly nh ni dn mc nj nk dp mg li nl nm mi lm nn no mk lq np nq mm nr bi translated">提取索引级别为0的行</h2><p id="c36a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在让我们尝试获取属于<strong class="lb iu">南部</strong>区域的所有行:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9568" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<strong class="mu iu">'South'</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/0ddb7546af5f510b051de4e3781e740e.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*BBsb2SJKiqcMYNeLGQzsWg.png"/></div></figure><p id="3dc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，结果中未显示索引<strong class="lb iu"> South </strong>。为了显示这一点，将它放在一个列表中(<strong class="lb iu"> [] </strong>):</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9f0a" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<strong class="mu iu">['South']</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/d5b7f9eac2165f3d8297d5b4fffe5565.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*J7g_LzkV5_YON2MGdYTa0w.png"/></div></figure><p id="2fc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想在<strong class="lb iu">南区</strong>和<strong class="lb iu">西区</strong>都有学校:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="82e4" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<strong class="mu iu">['South','West']</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d91c9f29ef1c75f2b132c534aab38a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*7uQW4AosFlUtItXzK-fzxA.png"/></div></figure><h2 id="c1c9" class="my lx it bd ly nh ni dn mc nj nk dp mg li nl nm mi lm nn no mk lq np nq mm nr bi translated">提取具有0级和1级索引的行</h2><p id="c7ce" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果您想让<strong class="lb iu">湾畔</strong>学校位于<strong class="lb iu">南部</strong>区域，请将这两个值包含在一个元组中:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bf6c" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<strong class="mu iu">('South','Bayside')</strong>]</span></pre><p id="6b62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果将是一个<strong class="lb iu">系列</strong>(多指标系列):</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a2e5" class="my lx it mu b gy mz na l nb nc">Science  mean    68.0<br/>         min     68.0<br/>         max     68.0<br/>Math     mean    76.0<br/>         min     76.0<br/>         max     76.0<br/>Name: (South, Bayside), dtype: float64</span><span id="d137" class="my lx it mu b gy nd na l nb nc">df_result_zone_school.loc[[<strong class="mu iu">('South','Bayside')</strong>]]</span></pre><p id="9ec1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得dataframe形式的结果，请使用list( <strong class="lb iu"> [] </strong>)包装元组:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="53d4" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<strong class="mu iu">[('South','Bayside')]</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a427291c5d633d26880fc5d61d1ddd41.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*i7EhEqZh1iY1gy30K_CDNw.png"/></div></figure><p id="d14c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想要分别来自<strong class="lb iu">南部</strong>和<strong class="lb iu">西部</strong>区域的<strong class="lb iu"> Bayside </strong>和<strong class="lb iu"> Ridgemont </strong>学校，请将它们作为元组传递:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c6f3" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<br/>    <strong class="mu iu">[('South','Bayside'),<br/>     ('West','Ridgemont')]</strong><br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/58e630b451871d888c1ffdfeb5d90d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*kjrEfLSOdFwJ7-cqRfGsZQ.png"/></div></figure><p id="9269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">把<strong class="lb iu">霍格沃茨</strong>和<strong class="lb iu">里奇蒙</strong>从<strong class="lb iu">西区</strong>区弄来怎么样？下面这个说法能行得通吗？</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f47a" class="my lx it mu b gy mz na l nb nc"><em class="lv"># this wouldn't work</em><br/>df_result_zone_school.loc[('West',['Hogwarts','Ridgemont'])]</span></pre><p id="8797" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，上面的方法行不通。要使它工作，您需要在元组的后面添加一个<strong class="lb iu">逗号(，)</strong> <em class="lv">:</em></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3e5d" class="my lx it mu b gy mz na l nb nc"><em class="lv"># note the comma at the end</em><br/>df_result_zone_school.loc[('West',['Hogwarts','Ridgemont'])<strong class="mu iu">,</strong>]</span><span id="733a" class="my lx it mu b gy nd na l nb nc"><em class="lv"># this will also work</em><br/>df_result_zone_school.loc[('West',['Hogwarts','Ridgemont'])<strong class="mu iu">,:</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/c71954c8030bae5d5c5d9e926c333fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*0tw40S_YFAq0f7lPDe_1vA.png"/></div></figure><p id="88c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解决上述问题的另一种方法是指定两个元组:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6f9f" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<br/>    [<strong class="mu iu">('West','Hogwarts'),<br/>     ('West','Ridgemont')</strong>]<br/>]</span></pre><p id="17f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种方法，您可以检索任何想要的行:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="b95b" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<br/>    [<br/> <strong class="mu iu">       ('West','Hogwarts'),<br/>        ('West','Ridgemont'),<br/>        ('South','Bayside')</strong><br/>    ]<br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/9f03ff2fb0931d381837d09fc39d27ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*AZIFO8Uc4J4e4G868BUbgA.png"/></div></figure><h2 id="24e4" class="my lx it bd ly nh ni dn mc nj nk dp mg li nl nm mi lm nn no mk lq np nq mm nr bi translated">切片行</h2><p id="63aa" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当然，您可以根据索引对行进行切片。假设您想要从<strong class="lb iu">北部</strong>到<strong class="lb iu">西部</strong>区域的所有学校:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bc02" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<strong class="mu iu">'North':'West'</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/a2286ffbcc5f433f148232eb00a5d6e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*Ry-TZr_fI6b3kPeuJ4RWxA.png"/></div></div></figure><p id="69a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从南面的<strong class="lb iu">，海湾边的</strong>到西面的<strong class="lb iu">，霍格沃茨</strong>的所有学校怎么样？没问题:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="38e7" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<br/>    <strong class="mu iu">('South','Bayside'):('West','Hogwarts')</strong><br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/72db8795403b90cfb8223aea0a0da6f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*Eom0Fc8D0dHnWxHoh7IH2Q.png"/></div></figure><p id="b8a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">把<strong class="lb iu">霍格沃茨</strong>带到<strong class="lb iu">西区</strong>的<strong class="lb iu">里奇蒙</strong>怎么样？既然都属于<strong class="lb iu">西</strong>区，下面还能工作吗？</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2a65" class="my lx it mu b gy mz na l nb nc"><em class="lv"># this wouldn't work</em><br/>df_result_zone_school.loc[<br/>    ('West','Hogwarts':'Ridgemont')<br/>]</span></pre><p id="b9ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，您应该这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d190" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.loc[<br/>    <strong class="mu iu">('West','Hogwarts'):('West','Ridgemont')</strong><br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/8c15382f4826a44d64b74d126b5c5d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*JmHhuXHceRUKovmJ9TXUMg.png"/></div></figure><h1 id="3b0f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">按位置获取行和列</h1><p id="a601" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">通过位置获取行和列比通过值获取更直接。以下是一些使用<strong class="lb iu"> iloc[] </strong>索引器的示例:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="7910" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.iloc[<strong class="mu iu">[0],[0]</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/be056e36434a939b357ad591531cd333.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*AV_zGcxxiGAClaWWKPhNzA.png"/></div></figure><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="229e" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.iloc[<strong class="mu iu">[0],[0,1]</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/13ebe91e0c964a46107000772d33fdae.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*U83r_MDlQAwukJTtB8qHpw.png"/></div></figure><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="e3ef" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.iloc[<strong class="mu iu">[1,2,3]</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/998d059295e388c15e257043c5d2dec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*I5A4WSUCrUmQn_EgBhv_2g.png"/></div></figure><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2446" class="my lx it mu b gy mz na l nb nc">df_result_zone_school.iloc[<strong class="mu iu">2:5, 3:</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/ca4db36f988a18eecbeb9675ab74d79c.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*E7zdAySQ7tV52vyvb9Ul4w.png"/></div></figure><h1 id="c1d0" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">基于索引值搜索行</h1><p id="9445" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">有时基于数组索引提取行更容易。例如，假设您想要获取属于北<strong class="lb iu">和南</strong>区域的所有行。你可以得到0级索引，然后使用<strong class="lb iu"> isin() </strong>函数，就像这样:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="71b7" class="my lx it mu b gy mz na l nb nc">condition = df_result_zone_school.index.<strong class="mu iu">get_level_values(<br/>    'Zone').isin(['North','South'])</strong><br/>df_result_zone_school[condition]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/87d860cc446d7be905465a64f35c1a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*VnfLjteBIWnh2Ac8zLyqhg.png"/></div></figure><p id="c72c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想得到所有以'<em class="lv"> th </em>结尾的区域，你可以使用<strong class="lb iu"> endswith() </strong>函数:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="373a" class="my lx it mu b gy mz na l nb nc">condition = df_result_zone_school.index.<strong class="mu iu">get_level_values(<br/>    'Zone').str.endswith('th')</strong><br/>df_result_zone_school[condition]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/469d5cc2e9eec2128c7cbfdf8bcc0900.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*l-wdwWpid9CZX8U_UHAjgQ.png"/></div></figure><p id="8c8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只上赖德尔和谢默学校怎么样？检查过了！</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f968" class="my lx it mu b gy mz na l nb nc">condition = df_result_zone_school.index<strong class="mu iu">.get_level_values(<br/>    'School').isin(['Rydell','Shermer'])</strong><br/>df_result_zone_school[condition]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/3bfdc5d5f841d948c9fdae9492391a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*l_nXRJ6oAEM-IJRrf1xstg.png"/></div></figure><p id="ad75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，如果你想得到<strong class="lb iu"> Rydell </strong>和<strong class="lb iu"> Shermer </strong>学校，以及<strong class="lb iu"> West </strong>区的所有学校呢？</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2bee" class="my lx it mu b gy mz na l nb nc">condition1 = df_result_zone_school.index<strong class="mu iu">.get_level_values(<br/>    'School').isin(['Rydell','Shermer'])</strong><br/>condition2 = df_result_zone_school<strong class="mu iu">.index.get_level_values(<br/>    'Zone').isin(['West'])</strong><br/>df_result_zone_school[ <strong class="mu iu">condition1 | condition2</strong> ]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/ae7fecc8449bcd0b720402c292d91521.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*5uyuv2Ms3eWRuh3y0pNQ0w.png"/></div></figure><h1 id="7a17" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">重置索引</h1><p id="27ee" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果你到现在还在关注，那就太好了！还记得我们的多索引数据框架吗？</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6295" class="my lx it mu b gy mz na l nb nc">df_result_zone_school</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/2e9aa0fb6e78baacc43d05c6e93db83c.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*FOa1mxSxZGJx7LdAH41FFA.png"/></div></figure><p id="277b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时，您希望将索引扁平化，以便更容易处理数据帧。您可以通过<strong class="lb iu"> reset_index() </strong>函数来实现:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0103" class="my lx it mu b gy mz na l nb nc">df_result = df_result_zone_school<strong class="mu iu">.reset_index()</strong><br/>df_result</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/3dfa79306c587dc48842f89bdc49c374.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*zbX3AWv8E3T-rjFz79D4Sg.png"/></div></figure><p id="069f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> reset_index() </strong>函数具有<strong class="lb iu">级</strong>参数，允许您指定要移除的索引。默认情况下，它会删除所有级别的索引。所以上面的语句本质上是这样的:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c3e4" class="my lx it mu b gy mz na l nb nc">df_result = df_result_zone_school.reset_index(<br/><strong class="mu iu">    level=['Zone','School']</strong>)</span></pre><p id="14b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用索引的级别号或索引名来指定要删除的索引:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="01da" class="my lx it mu b gy mz na l nb nc">df_result_school = df_result_zone_school.reset_index(level=[0])<br/># same as <br/>df_result_school = df_result_zone_school.reset_index(level=<br/>    ['Zone'])<br/>df_result_school</span></pre><p id="7396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述语句从索引中删除了区域:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/bfc692fd37350bc787e2e8f0eccffecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*yWtyNQI3kaLa-PulcSvuJQ.png"/></div></figure><p id="aa76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下语句将<strong class="lb iu">学校</strong>从索引中删除:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2944" class="my lx it mu b gy mz na l nb nc">df_result_zone = df_result_zone_school.reset_index(level=[1])<br/># same as <br/>df_result_zone = df_result_zone_school.reset_index(level=['School'])<br/>df_result_zone</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/212162ef2b04bfa0ba34887d09a6a56a.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*ZQrl6Ewn2wUOKCUPeASG_Q.png"/></div></figure><p id="7f7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<strong class="lb iu"> set_index() </strong>函数指定一列作为索引，而不是使用<strong class="lb iu"> reset_index() </strong>函数从索引中删除一列。调用<strong class="lb iu"> df_result </strong>数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/c0c6275667c7ee6200991980b35fcf7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*T3LiCq_WlEt8fBpcu4DqNw.png"/></div></figure><p id="9518" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下语句将<strong class="lb iu">区域</strong>设置为索引:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="76d4" class="my lx it mu b gy mz na l nb nc">df_result.<strong class="mu iu">set_index('Zone')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/288c9c20e3b66a71831fbb4c80d9ebac.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*JSuuiMgp3iSH2s1KfBhl5A.png"/></div></figure><p id="d94a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，下面的语句将<strong class="lb iu">区域</strong>和<strong class="lb iu">学校</strong>都设置为索引:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="aa18" class="my lx it mu b gy mz na l nb nc">df_result.set_index(<strong class="mu iu">['Zone','School']</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b6793c55ead9d22d95d640098dd8ffa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*aqeyGjE3w5InCHoKGTmOlA.png"/></div></figure><h1 id="031e" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="d883" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我希望这篇文章使处理多索引数据框架不像最初看起来那么可怕。记住我在本文中讨论的技术的最好方法是自己尝试代码示例。如果你有进一步的问题，请留下你的评论，我会尽量在这里回答。玩得开心！</p><div class="os ot gp gr ou ov"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">加入媒介与我的介绍链接-李伟孟</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">weimenglee.medium.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj ks ov"/></div></div></a></div></div></div>    
</body>
</html>