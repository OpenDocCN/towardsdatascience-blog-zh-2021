<html>
<head>
<title>Using NLP to identify Adverse Drug Events (ADEs)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自然语言处理识别药物不良事件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-nlp-to-identify-adverse-drug-events-ades-7a0194f1966a?source=collection_archive---------16-----------------------#2021-10-08">https://towardsdatascience.com/using-nlp-to-identify-adverse-drug-events-ades-7a0194f1966a?source=collection_archive---------16-----------------------#2021-10-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="352d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">制药和医疗保健公司如何利用NLP自动检测非结构化文本中的ade</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/88b644f284958de6d3b79e37075e3fec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0DULQmIuLsxlDm8x"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">莎伦·麦卡琴在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="9703" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">这是怎么回事？</h1><p id="e3a8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><em class="mk">药物不良事件</em> (ADE)定义为患者因接触药物而遭受的伤害。大量关于药物相关安全性问题(如不良反应)的信息发布在医学病例报告中，由于其非结构化的性质，这些信息通常只能由人类读者来研究。</p><p id="2e7c" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在本教程中，我们将训练一个自然语言处理(NLP)模型来识别给定文本中的ade。我们将使用来自拥抱面部数据集中枢的<a class="ae kv" href="https://huggingface.co/datasets/ade_corpus_v2" rel="noopener ugc nofollow" target="_blank"> ADE数据集</a>来教导模型ADE相关和非ADE相关文本之间的区别。我们将使用拥抱脸和亚马逊SageMaker来训练和部署模型，并用我们自己的短语进行测试。</p><h1 id="a9e8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为什么这很重要？</h1><p id="059c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://health.gov/our-work/national-health-initiatives/health-care-quality/adverse-drug-events" rel="noopener ugc nofollow" target="_blank">根据疾病预防和健康促进办公室的数据</a>，ade具有严重的影响:在住院环境中，ade约占所有医院不良事件的三分之一，每年影响约200万次住院，并延长住院时间1.7至4.6天。在门诊环境中，ade包括超过350万次医生诊室就诊，估计有100万次急诊就诊，以及大约125，000次住院。</p><p id="e509" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">能够使用人工智能模型自动标记非结构化文本数据中的ADE相关短语有助于预防ADE，并带来更安全、更高质量的医疗保健服务、更低的医疗保健成本、更知情和更积极的消费者以及更好的健康结果。</p><h1 id="f53d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">数据</h1><p id="aae4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">对于本教程，我们将使用<a class="ae kv" href="https://huggingface.co/datasets/ade_corpus_v2" rel="noopener ugc nofollow" target="_blank"> ADE语料库V2数据集</a>。该数据集于2021年5月发表在拥抱脸网站上，并公开发布。它由3个子集组成，(1)ADE分类语料库，(2)药物ADE关系语料库，和(3)药物剂量关系语料库。对于本教程，我们将专注于分类子集，它根据句子是否与ADE相关(标签=1)或不相关(标签=0)对句子进行分类。数据集看起来是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/ad486e6e260381591789374c7698b4cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*xZu5jvscL8LJr8X412hZKg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="9683" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">行动（或活动、袭击）计划</h1><p id="1b78" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">训练NLP模型以识别ADE相关短语需要几个步骤:首先，我们需要下载并处理数据集，这导致单独的训练、验证和测试数据集。然后，我们用训练和验证数据集训练该模型。之后，我们将它部署到一个端点，在那里我们可以测试模型。下图说明了步骤的顺序:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/b204cd8e8b16963c5b84aea20cc6f903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M6D5hk3WWSH474ijoUy8Gw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="ee15" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">本教程的所有代码都可以在这个<a class="ae kv" href="https://github.com/marshmellow77/adverse-drug-effect-detection" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到。repo被分成4个笔记本，它们反映了上面概述的步骤:1_data_prep.ipynb(数据处理)，2_inspect_data_optional.ipynb(这使我们可以在训练之前查看已处理的数据)，3_train.ipynb(模型训练)，4_deploy.ipynb(模型部署和测试)。</p><h1 id="720a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">处理数据</h1><p id="b242" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了处理数据，我们将利用亚马逊SageMaker 上的<a class="ae kv" rel="noopener" target="_blank" href="/huggingface-processing-jobs-on-amazon-sagemaker-b1f5af97b663">拥抱面部处理工作。这允许我们启动一个执行</a><a class="ae kv" href="https://github.com/marshmellow77/adverse-drug-effect-detection/blob/main/scripts/preprocess.py" rel="noopener ugc nofollow" target="_blank">处理脚本</a>的计算实例。工作完成后，计算实例将自动关闭，我们只需支付处理数据的时间。</p><p id="976a" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">让我们看看处理脚本的一些关键部分:</p><p id="84b5" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">处理脚本做一些事情:下载数据，删除重复数据，重组和分割数据，标记数据，并将其保存到S3。</p><h2 id="8cb3" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">洗牌和分割数据</h2><p id="8e9f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">有许多方法可以加载数据集、删除重复项并将其分成几个部分。在这个脚本中，我们利用<a class="ae kv" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>和<a class="ae kv" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>库来完成这个任务，但是<a class="ae kv" href="https://huggingface.co/docs/datasets/processing.html#processing-data-in-a-dataset" rel="noopener ugc nofollow" target="_blank">数据集类</a>也有方法来<a class="ae kv" href="https://huggingface.co/docs/datasets/processing.html#filtering-rows-select-and-filter" rel="noopener ugc nofollow" target="_blank">过滤</a>和<a class="ae kv" href="https://huggingface.co/docs/datasets/processing.html#splitting-the-dataset-in-train-and-test-split-train-test-split" rel="noopener ugc nofollow" target="_blank">分割</a>数据集。</p><p id="1183" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">将数据集混洗并分成三部分的一种方法是使用Numpy的split()函数。它允许我们在定义的阈值分割数据集。例如，要将一个数据集混洗并拆分成70%的训练数据、20%的验证数据和10%的测试数据，我们可以使用这行代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="8042" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">将数据符号化</h2><p id="48d1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了使数据集为模型训练做好准备，我们将在将数据集保存到S3之前对其进行标记化:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h1 id="57c3" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">训练模型</h1><p id="b078" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在SageMaker上训练拥抱脸模型很简单，这要归功于拥抱脸和AWS之间的合作关系。Github repo中的<a class="ae kv" href="https://github.com/marshmellow77/adverse-drug-effect-detection/blob/main/3_train.ipynb" rel="noopener ugc nofollow" target="_blank">培训笔记本</a>遵循了如何培训NLP模型的最佳实践，并使用<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/how-it-works-training.html" rel="noopener ugc nofollow" target="_blank"> SageMaker培训作业</a>来旋转短暂的计算实例以培训模型。这些计算实例仅用于训练模型，并在训练完成后立即拆除。该模型保存在S3上，可以从那里下载并在任何地方托管该模型:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/756c98b223c1104b45d416f57906efc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KAJEI_YIurmJ9dWh3MbUqw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="a470" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">部署模型</h1><p id="859e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本教程中，我们将通过获取我们刚刚训练的模型并像这样将其部署在S3上来简化我们的生活(参见Github repo中的<a class="ae kv" href="https://github.com/marshmellow77/adverse-drug-effect-detection/blob/main/4_deploy.ipynb" rel="noopener ugc nofollow" target="_blank">部署笔记本</a>):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="1ce3" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">这将创建一个SageMaker端点，然后我们可以通过SDK与之交互。这使得我们可以很容易地测试和摆弄这个模型。</p><h1 id="268c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">测试模型</h1><p id="c9d5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一旦部署了模型，我们就可以用测试数据(或一些编造的句子)来测试它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/a49b5553c0f638b98fbaa6a5de217a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*mfwqmNRc54kVeQOm_ptiaQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="6aa0" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="7608" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本教程中，我们训练了一个NLP模型来识别给定短语中的药物不良事件(ade)。我们使用一个带注释的语料库来训练NLP模型，并将其部署到SageMaker端点，该语料库旨在支持从医学病例报告中提取有关药物相关不良反应的信息。接下来的步骤可能包括使用专用评估脚本进行自动模型评估，并在Hugging Face的模型中心发布模型。</p><h1 id="e64e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">引用</h1><p id="f947" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">本教程使用的数据集是本文中描述的工作的产物:</p><p id="0924" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">Gurulingappa等人，《支持药物副作用信息提取的基准语料库》，JBI，2012年。<br/><a class="ae kv" href="http://www.sciencedirect.com/science/article/pii/S1532046412000615" rel="noopener ugc nofollow" target="_blank">http://www . science direct . com/science/article/pii/s 1532046412000615</a>，DOI:<a class="ae kv" href="https://doi.org/10.1016/j.jbi.2012.04.008" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1016/j.jbi.2012.04.008</a></p></div></div>    
</body>
</html>