<html>
<head>
<title>A simple framework for performance metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绩效指标的简单框架</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-framework-for-performance-metrics-cca97ddf91e5?source=collection_archive---------22-----------------------#2021-05-03">https://towardsdatascience.com/a-simple-framework-for-performance-metrics-cca97ddf91e5?source=collection_archive---------22-----------------------#2021-05-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="10be" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">轻松选择适合您问题的最佳指标</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fe7e06042f7d9ffb87ee127fdf932cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHEgaK67ehrZrCFrv2sYag.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Clark Van Der Beken 在<a class="ae kv" href="https://unsplash.com/s/photos/acropolis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8dbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">准确性、敏感性、特异性、F1分数……—性能指标的列表似乎永无止境。尤其是如果你是数据科学的新手，你很容易感到在选择的海洋中束手无策。在这篇文章中，我想向你介绍一个对性能指标进行分组的框架，它们如何相互联系，以及你如何使用它来为你的问题和模型选择最佳指标。</p><h2 id="de15" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">绩效指标框架</h2><p id="ab70" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">你一定听说过一些指标，比如准确度、灵敏度、F1分数、接收机工作特性(ROC)等等。但是当我开始深入研究它们时，我经常问自己，它们是如何相互联系的。过了一会儿，我偶然发现了由<a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0167865508002687" rel="noopener ugc nofollow" target="_blank">费里和他的同事</a>提出的一个奇妙的框架，这个框架让我的事情变得简单多了。</p><p id="e0d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基本上，我们可以将二进制分类任务的常见性能指标分为三类。它们中的每一个都有不同的用途:</p><ul class=""><li id="10a9" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">阈值度量:检查您的模型是否满足预定义的阈值。</li><li id="5c35" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">分级度量:将模型实例或完整的模型相互比较。</li><li id="bd6e" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">概率度量:测量你的分类的不确定性。</li></ul><p id="3ff6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们按顺序看一下每一个:</p><h2 id="f3e7" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">阈值度量</h2><p id="383d" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这些是你的日常指标，比如准确性、F1、FDR，基本上是维基百科页面上列出的一切。它们的共同点是，您预先指定了哪些性能指标对您给定的问题很重要，并定义了您的模型需要通过的阈值。这就是这个名字的由来。如果你的模型没有通过你的门槛，它甚至不会被进一步考虑。</p><p id="8952" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">阈值度量基本上适用于所有的分类器算法，不管它们是直接输出类别标签(像简单的k均值或决策树)还是类别成员分数(像模糊c均值或逻辑回归)。</p><p id="0dcd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不会详细讨论这些指标是如何计算的，这超出了本文的范围。如果您有兴趣了解各个指标，请查看参考资料，我在其中列出了一些优秀的资料。</p><p id="0c81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我想说的是，如果你有一个平衡或不平衡的数据集，提前检查是非常重要的。对于不平衡的数据集，诸如准确度之类的常见度量已经不再适用，因为总是预测多数类的朴素分类器已经具有高准确度。取而代之的是，使用关注少数类的指标，这是约定俗成的积极类。</p><h2 id="a012" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">排名指标</h2><p id="718d" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">当处理输出类成员分数的分类器时，排名度量特别有用。要将这个分数转换成一个清晰的类标签，您需要对分数应用一个阈值。但是如何选择这个门槛呢？排名指标让它变得轻而易举。让我们首先假设您有一个平衡的数据集:</p><p id="ff2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">训练完模型后，迭代所有可能的阈值，计算真阳性率和假阳性率。然后把这些互相勾连。你最终会得到所谓的接收机工作特性，简称ROC:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/2b7f2b91c42556fc7473a6054432bbe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85BfHqPtyQuZV7uzQrZWcg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">接收器工作特性示意图。一个完美的分类器的TPR为1，FPR为0，位于左上角(绿色星号)。无技能分类器发现的真阳性和假阳性一样多，用虚线表示。通过迭代模型的不同阈值，您可以生成一条描述模型行为的曲线(灰线)。比随机分类器差的分类器可以通过简单地选择其输出的反义词而被转换成熟练的分类器。这将反映其行为沿对角线(红星)。图片由作者提供。</p></figure><p id="17e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个完美的分类器应该在这个图的左上角。对角线描绘了一个没有技巧的简单分类器。你可以把它想象成一个简单地输出随机数，或者总是一个固定数的分类器。当你移动阈值时，你会偶然得到越来越多的真阳性，但同时你的假阳性也会同样增加。要选择最佳模型，只需选择最靠近左上角的点。你可以通过计算真阳性率——假阳性率(也称为约登J统计量)轻松做到这一点。</p><p id="07e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个有趣的事实是，对角线以下的模型不一定比随机模型差。通过简单地反转模型输出，你基本上可以通过对角线来反映它的点，并可能获得一个非常熟练的模型。</p><p id="e02d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于不平衡数据集，对应的图是精度-召回曲线。这一次，最佳分类器位于右上方(与ROC相反，ROC位于左上方)，而朴素分类器将在数据集中的阳性部分产生一条穿过precision(定义为TP/ (TP + FP))的水平线。这是因为具有随机预测的无技能分类器也有机会将数据集预测为阳性(在精确度中不考虑阴性！).同时，通过移动阈值，无技能分类器将正确地识别越来越多的阳性，从而提高召回率(定义为所有阳性中的真阳性)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/6c36511b4bf522724836179be01b389c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mn-v2MObtI4iP6W_0SEz-A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不平衡数据集的精确召回曲线。完美的分类器现在在右上角(绿色的星星)，而无技能的分类器总是有恒定的精度。迭代您的模型的阈值将产生类似于灰色线的行为。图片由作者提供。</p></figure><p id="bc45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要选择最佳阈值，计算Precision + Recall，选择这个点的阈值(等于选择F1分最高的模型)。</p><h2 id="b3b3" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">概率度量</h2><p id="08e1" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">概率度量有点特殊，因为在这里我们不仅要评估我们的模型是否做了正确的分类，而且更感兴趣的是它对分类的确定程度。与排名度量一样，这些当然只能应用于输出类成员概率的模型(在评估它们之前可能需要归一化)。</p><p id="4c4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用概率度量，我们可以特别惩罚模型以高置信度进行错误分类，而模型输出不是非常确定的错误不会遭受如此高的代价。请注意，一个非决定性的模型通常在概率度量上也不会表现得很好，因为它们也奖励强而正确的预测。</p><p id="2c2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最常见的概率度量是对数损失，也称为交叉熵。因为它对积极因素和消极因素的权重相等，所以您应该只将它应用于平衡的数据集。想象一个二元分类问题，我们用逻辑回归来拟合它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/a89cedbde79281292cca3c9a16ef7bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvBugBrW_NnJeuXehNJtfQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">测井曲线损失的直观解释。想象一个一维问题，其中每个点只是一个数字(x轴)。对于每一个点，我们都知道属于阳性类别的真实概率，1表示阳性(绿点)，0表示阴性(红点)。我们对我们的问题进行逻辑回归，以对这些点进行分类(灰线)。预测概率与真实概率之间的差异用于计算对数损失。图片由作者提供。</p></figure><p id="4348" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从我们的测试集中，我们知道给定点在正类中的真实概率，对于负类是0，对于正类是1。我们的逻辑回归分配一个在0到1范围内的概率。对数损失是基于我们的分配概率与真实概率的差异。对于每个点，我们计算对数损失并对所有点进行平均。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/1dc8bd5277fc55c2b3b8795a051d6f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s7AuPynz8MzMkHTUFrCxWQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">对数损失公式。y这是我们的分类器分配给每个点的概率，即从上面的s形曲线上的值。图片由作者提供。</p></figure><p id="b246" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于不平衡的数据集，您应该再次使用更侧重于积极类的度量，例如Brier分数。它被定义为正类的预期和预测概率之间的均方误差:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/7108546ba74cd6abae17cbbf5d340de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*KZWYGelffNGsA9iOr8IicQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Brier分数的定义。请注意，仅适用于正类，不适用于负类。图片由作者提供。</p></figure><h2 id="879e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><p id="3c26" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我希望这个框架对你和对我一样有用。首先，决定与您的项目最相关的阈值度量，然后训练您的模型，并用排名度量对它们进行排名。最后，如果你有概率模型，考虑使用概率度量。</p><p id="627b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，困难的部分之一仍然是决定哪一个度量是最有意义的。为此，最好的方法通常是与领域专家深入讨论他们真正想要避免的错误。或者继续关注更多关于这个问题的内容。</p><h2 id="53ae" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">参考</h2><p id="8a0c" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">Ferri，Hernandez-Orallo &amp; Modroiu (2009):分类性能测量的实验比较。<em class="nj">模式识别字母</em></p></div></div>    
</body>
</html>