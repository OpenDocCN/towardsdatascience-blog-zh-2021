<html>
<head>
<title>Combine the Best of MS Excel and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">结合MS Excel和Python的优点</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/combine-the-best-of-ms-excel-and-python-c85cad9fdc3b?source=collection_archive---------13-----------------------#2021-05-20">https://towardsdatascience.com/combine-the-best-of-ms-excel-and-python-c85cad9fdc3b?source=collection_archive---------13-----------------------#2021-05-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="46db" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">您还不需要(也不应该)完全逃离Excel</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/71c894b439f975e93202789ac89d482b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sgJd414qQi3-rbqF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尼克·里克特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="91a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你听说过Python是新的Excel吗？老实说，我已经读过好几遍了。</p><p id="e0db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，为什么我看到很多人还在用Excel呢？</p><p id="1dc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，这两个工具的目的不同，其次，Excel本身就很强大(如果不是这样，它不会流行这么多年)。</p><p id="2cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，编程语言每年都变得越来越流行，有些人，比如你和我，对验证已知的活动如何以不同的方式处理感兴趣，当然，也很容易。</p><p id="37f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是这篇文章的一个关键方面。有一种MS Office原生编程语言叫做VBA (Visual Basic for Applications)。尽管你可能不知道，但你可能已经用过了。为什么使用所谓的宏。</p><p id="7625" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">长话短说，VBA是一种由微软开发的编程语言，它是如何配置宏，一堆定义好的命令。这是故事变得有趣的时刻。Python最著名的用例之一是自动化多种类型的任务，包括但不限于Excel用例。然而，这类问题不是已经被VBA解决了吗？请记住，我们在这里是为了做得更好，做得与众不同。此外，很多宏都是由不知道如何改变或适应它们的人使用的。他们只是在那里呆了几年…</p><p id="8b2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">宏已经被使用的事实对你来说可能是一个很大的障碍，主要原因是<strong class="lb iu">的便利性</strong>。为什么？我注意到的原因是:</p><ol class=""><li id="587f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">人们习惯于点击宏按钮，这对他们来说已经足够了。他们只是希望工作完成(而且这是公平的，有道理的)；</li><li id="0e04" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">有些人就是不愿意学习一门(新的)编程语言。</li></ol><p id="f037" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所述，举例来说，很难将您设法开发的Python脚本的唯一用途分散到整个组织中。你需要让人们能够使用Excel和宏，就这样。这样，他们感觉很舒服，你可能会以某种方式继续练习。</p><h2 id="aad2" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">为什么要这么做？</h2><p id="55f4" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">尤其是如果你刚刚开始用Python运行一些程序，很可能你正在寻找真正的使用问题来解决，有时，这可能不太容易预先找到。</p><p id="56f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最重要的是尽可能多的坚持练习。今天你们要学习这个例子，我将要展示给你们，但是你们不应该就此打住。</p><p id="402e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，Python是过去几年中发展最快的编程语言之一，这并非毫无意义。它的易用性和大量的库吸引了全球数百万程序员的注意，这是它如此受欢迎的关键。</p><h2 id="b675" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">怎么做？</h2><p id="1d46" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">那么，还记得那位同事抱怨他们需要每天准备并发送给经理的无聊报告吗？我可以肯定地告诉你，使用Python可以帮助他们实现这一点，如果你的同事想了解Python，他们不需要了解任何东西，相信我。</p><p id="e702" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于解决这个问题可能存在的宏呢？嗯，如前所述，继续允许人们使用宏是很重要的。然而，这不会是他们所习惯的宏，<strong class="lb iu">他们只是不知道他们正在使用Python </strong>。</p><p id="8da5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用以下内容:</p><ol class=""><li id="5edc" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">VBA和壳牌</li><li id="9bf1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">Python文件</li><li id="3cd1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">表单控件按钮</li></ol><p id="0377" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们去看看。</p><h1 id="05c4" class="nh mk it bd ml ni nj nk mo nl nm nn mr jz no ka mu kc np kd mx kf nq kg na nr bi translated">1.VBA和壳牌</h1><p id="2be2" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">别生我的气，但我会让你用一点VBA。这只是一种设置让我们能够提前使用Python所需的变通方法的方式。</p><p id="cca2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开您将在本练习中使用的excel文件。我将使用以下代码:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="a237" class="mj mk it nt b gy nx ny l nz oa">C:\Users\Desktop\python test\main_file.xlsm</span></pre><p id="d0c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你打开它，键入F11，然后VBA图形用户界面将打开。它应该类似于下图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/e5390151d41f3727cd51b559c62b821b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSYx-51KfoE8iSRQjx09WA.png"/></div></div></figure><p id="09a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有可用的模块，只需点击顶部菜单中的“插入”，然后点击“模块”。好了，让我们来看看代码本身:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="7e8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很简单。我们来分析一下以上最重要的几个方面。</p><p id="3bd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要使用命令“Dim”来声明变量。所以我们宣布:</p><ol class=""><li id="6866" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">Python解释器路径(“python_exe”)</li><li id="5bc0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">Python脚本路径(“python_py”)。<em class="oe"> Chr(34)可能需要，如果你的路径包含空格，像我一样。</em></li><li id="9d16" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">当前目录路径(“目录路径”)</li></ol><p id="66db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">声明这些变量后，需要使用一个<a class="ae ky" href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/shell-function" rel="noopener ugc nofollow" target="_blank">外壳函数</a>。简单地说，适用于我们场景的这个Shell函数的基本语法是:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="2df5" class="mj mk it nt b gy nx ny l nz oa">program_to_excute file_to_execute command_line_argument</span></pre><p id="70a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它非常类似于在Linux发行版中使用的<a class="ae ky" href="https://docs.microsoft.com/en-us/powershell/" rel="noopener ugc nofollow" target="_blank"> Windows Powershell </a>和<a class="ae ky" href="https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html" rel="noopener ugc nofollow" target="_blank"> Bash </a>中用于shell脚本的语法(或任何其他Shell)。</p><p id="fc05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oe">看看下面的故事，我探索了Linux中基本Shell脚本的一些功能。</em></p><div class="of og gp gr oh oi"><a href="https://levelup.gitconnected.com/python-and-linux-i-o-redirection-for-managing-investments-ef009be30f39" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">用于管理投资的Python和Linux I/O重定向</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">使用谷歌云平台(GCP)上的Linux虚拟机获得每日投资结果表</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow ks oi"/></div></div></a></div><p id="f532" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这个意义上说，我们已经设置了Python解释器来执行Python文件，并且我们正在设置一个将在Python文件中使用的参数。向前移动…</p><h1 id="233c" class="nh mk it bd ml ni nj nk mo nl nm nn mr jz no ka mu kc np kd mx kf nq kg na nr bi translated">2.Python文件</h1><p id="396a" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">最后，万能的Python文件。</p><p id="1481" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们强调一下你为什么真的喜欢使用Python的更详细的原因。Python在过去几年变得如此流行肯定有几个原因。当然，其中之一是它的多功能性。尽管对于某些领域来说，这最终会成为一个缺点(因为它会使脚本变慢)。由于我们不是在谈论实时用例，它真的不会对我们产生负面影响。</p><p id="547e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其多功能性主要是由于三个原因:</p><ol class=""><li id="1d7e" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">解释语言。可以交互地运行脚本的每一行(它不是一种编译语言)。这甚至导致实时敏感性案例使用Python来构建他们的应用程序原型，因为这比一些常见的替代方法更简单。</li><li id="8c61" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">动态类型语言。与VBA和其他语言不同，你不需要显式声明你将在程序中使用的变量类型。内存是在给每个变量赋值时分配的。</li><li id="98dc" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">大型社区。有大量的图书馆可供使用。很有可能你想要达到的目标已经被别人完成了。在真正尝试之前，花时间去寻找它。</li></ol><p id="fb6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，评论完了，让我们看看剧本。它分为两部分:</p><ol class=""><li id="d2d3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">Windows API</li><li id="cf50" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">数据操作</li></ol><p id="9509" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面，让我带你看一下每一个。</p><h2 id="8751" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">1.Windows API</h2><p id="695f" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">这里提到的API可以通过包<a class="ae ky" href="https://pypi.org/project/pywin32/" rel="noopener ugc nofollow" target="_blank"> pywin32 </a>获得。它允许我们从另一个应用程序控制Windows应用程序。在这种情况下，来自Python脚本。</p><p id="1b7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，这个图书馆里的物品很像VBA本身。</p><p id="c2e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看Python脚本的第一部分:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="51a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">向前发展…</p><h2 id="67e0" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">2.数据操作</h2><p id="3a79" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">当然，从这里开始，这真的取决于你的情况。我们将探索一些使用Python可以轻松实现的常见需求。</p><p id="e434" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我会考虑一个来自Kaggle的数据库，<a class="ae ky" href="https://www.kaggle.com/zynicide/wine-reviews?select=winemag-data-130k-v2.json" rel="noopener ugc nofollow" target="_blank">葡萄酒评论</a>。更具体地说，该文件命名为“winemag-data-130k-v2.json”。</p><p id="259d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您同事的日常活动是共享类似数据透视表的报表，该报表包含以下行层次结构:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="b956" class="mj mk it nt b gy nx ny l nz oa">variety; region_1; region_2; province; taster_name</span></pre><p id="5263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随后是每种情况的“点数”。</p><p id="8080" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能会注意到这个数据库中有一些空值。此外，您不确定他们需要在报告中使用的字段(或列)是否会受到任何空案例的影响。从这个意义上说，根据每一列的数据类型填充空值是明智的。</p><p id="1167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是即使在Excel中使用Python而不是VBA的主要优势之一。你能想象在不借助<a class="ae ky" href="https://pandas.pydata.org/docs/" rel="noopener ugc nofollow" target="_blank">熊猫</a>的情况下如何做到以上几点吗？</p><p id="b702" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看看实现这一点的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="e38e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过执行上述操作，您的同事可以确保所有被标识为包含空值的列都填充了正确的值。</p><p id="4698" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，是时候生成所需的数据透视表了，因为这是该领域的每个人用来管理、探索以及采取适当行动的方式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="16c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您是否注意到“主”Excel文件正在更新，现在它显示了数据透视表？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/76b98cac73bd6f73c8527f39283df7bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gGeHwNZb1MFYeNfztJlSw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文章结果的屏幕截图(数据继续显示在右侧和底部)</p></figure><p id="6742" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你应该得到了类似上面的东西。</p><h1 id="9a31" class="nh mk it bd ml ni nj nk mo nl nm nn mr jz no ka mu kc np kd mx kf nq kg na nr bi translated">结论</h1><p id="9d2c" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">您设法处理了与一个已知用例相关的多个文件(json和Excel文件),您可以在日常工作中使用Python脚本轻松处理这些文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/912ef8efcf733fa88019ebe1ae304219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WAx6m7scE9FMhugKFK6oUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">案例结构</p></figure><p id="cfc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过利用Python的多功能性，您使用一个非常强大的名为pandas的库来操作数据源中包含的数据。除此之外，请记住，还有许多其他流行的库可以用于web应用程序、机器学习和可视化用例。</p><p id="a916" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最重要的是:你要让用户保持他们通常的工作方式。希望你(不小心)成功唤醒用户开始学习Python。</p></div></div>    
</body>
</html>