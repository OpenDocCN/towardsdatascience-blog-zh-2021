<html>
<head>
<title>Geometric and Poisson Random Variables with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python处理几何和泊松随机变量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55?source=collection_archive---------23-----------------------#2021-06-08">https://towardsdatascience.com/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55?source=collection_archive---------23-----------------------#2021-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c052" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python实现大学统计</h2></div><h1 id="c362" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="79d7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在一系列的每周文章中，我将涉及一些重要的统计学主题。</p><p id="89aa" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">目标是使用Python来帮助我们获得对复杂概念的直觉，从经验上测试理论证明，或者从零开始构建算法。在本系列中，您将会看到涵盖随机变量、抽样分布、置信区间、显著性检验等主题的文章。</p><p id="7ff4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在每篇文章的最后，你可以找到练习来测试你的知识。解决方案将在下周的文章中分享。</p><p id="c7ea" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">迄今发表的文章:</p><ul class=""><li id="fbec" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/bernoulli-and-binomial-random-variables-d0698288dd36">伯努利和二项随机变量与Python </a></li><li id="a180" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/geometric-and-poisson-random-variables-with-python-e5dcb63d6b55">用Python从二项式到几何和泊松随机变量</a></li><li id="b1df" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/sampling-distributions-with-python-f5a5f268f636">用Python实现样本比例的抽样分布</a></li><li id="83d3" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/confidence-intervals-with-python-bfa28ebb81c">Python的置信区间</a></li><li id="5eab" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/significance-or-hypothesis-tests-with-python-7ed35e9ac9b6">使用Python进行显著性测试</a></li><li id="b25d" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/two-sample-inference-for-the-difference-between-groups-with-python-de91fbee32f9">用Python进行组间差异的双样本推断</a></li><li id="b3e9" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/inference-for-categorical-data-9f3c6034aa57">分类数据的推断</a></li><li id="5520" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/advanced-regression-f74090014f3">高级回归</a></li><li id="f139" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/analysis-of-variance-anova-8dc889d2fc3a">方差分析— ANOVA </a></li></ul><p id="8a6d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">像往常一样，代码可以在我的<a class="ae mk" href="https://github.com/luisroque/College_Statistics_with_Python" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h2 id="4831" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated">比较几何随机变量和二项随机变量</h2><p id="d78b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们从概述什么是二项随机变量(RV)开始。以下是清单:</p><ul class=""><li id="9cbe" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">审判是独立的；</li><li id="509f" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">每次试验都可以分为成功或失败；</li><li id="0129" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">固定的试验次数；</li><li id="08d0" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv mg mh mi mj bi translated">每次试验成功的概率是恒定的。</li></ul><p id="484b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这种变量的一个例子可以是<em class="nc"> X </em>，<em class="nc">在10次掷骰子后5的数量</em>。注意试验是独立的；在第一次试验中滚动骰子不影响在第二次试验中滚动骰子。我们可以清楚地将试验分为成功(我们得到了5分)或失败(我们得到了除5分之外的任何数字)。我们掷10次骰子，所以10代表我们的试验次数。最后，成功的概率是恒定的，因为我们总是一次又一次地使用同一个骰子，所以得到5的概率总是1/6。</p><p id="3580" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">那么，二项式RV和几何式RV有什么区别呢？当我定义几何RV <em class="nc"> Y </em>，<em class="nc">掷骰数直到你在公平骰子</em>上得到一个5时，看看你是否能找出差异。在继续之前考虑一下(参考清单)。</p><p id="4bf4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">主要区别是试验次数固定；我们已经没有了。据我们所知，它可能是一个古戈尔(10^100)卷数。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="80c3" class="mq kj it ni b gy nm nn l no np">from IPython.display import Image<br/>import numpy as np<br/>import seaborn as sns<br/>from scipy.stats import binom</span></pre><h2 id="c179" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated">几何随机变量的概率</h2><p id="407b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">克里斯蒂亚诺·罗纳尔多的点球转化率约为84%，是世界上最好的之一。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nq"><img src="../Images/5e2c2df4c2977b9a3eed1b5a6c42b0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QeE-QkpL7Ye7DZ3g9Q_wiw.png"/></div></div><p class="ny nz gj gh gi oa ob bd b be z dk translated">图1:22位世界最佳点球手的职业生涯点球统计；<a class="ae mk" href="https://www.jd-sports.com.au/page/world-cup-penalty-statistics/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="5149" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在想象罗纳尔多罚点球，直到他罚丢一个球。设<em class="nc"> X </em>为他第一次罚球不进的射门次数。c罗第一次投篮不中发生在第4次试射的概率有多大？</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7eacdbdef77ea7d995a84b4f3866bbea.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*i3Je9aAE4gD27odn7B18dQ.png"/></div></figure><p id="8b08" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">你可以看到上面的等式是前三次投篮得分的概率0.84乘以第四次失误的概率0.16的乘积。回想一下，这些尝试是独立的；这就是为什么我们可以像这里一样把它们繁殖起来。</p><p id="a8f3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">所以c罗连续进3个点球，然后第4个罚丢的概率在10%左右。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="a1a1" class="mq kj it ni b gy nm nn l no np">0.84**3*0.16</span><span id="2643" class="mq kj it ni b gy od nn l no np">0.09483263999999998</span></pre><p id="a1c7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以将几何分布的概率质量函数概括如下:</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/3abb79806d9526c2f870320061ef163e.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*oT-MXCcrxWPaesXsBT3Cuw.png"/></div></figure><h2 id="8e82" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated"><strong class="ak">累积几何概率</strong></h2><p id="6c54" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在计算累积几何概率时，我们可以从两个不同的角度来看。</p><p id="0109" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们假设成功的概率<em class="nc"> p </em> =0.1，我们要计算<em class="nc"> P(X &lt; 5) </em>。</p><p id="e69a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以这样想:</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/38d1c7a9d69a6d049032448f7ef4cd8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*DgqQd0TwauCSEEfYlb4otA.png"/></div></figure><p id="f076" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">或者我们可以反过来想，前4次试验都没有成功，所以:</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/5bfd159ca1d6f9dc2b08d6fbf4d52105.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*6o2krfiKp6cKynnS_4Jdpw.png"/></div></figure><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="097d" class="mq kj it ni b gy nm nn l no np">def geomcdf_1(p, x):<br/>    # implementing first approach<br/>    prob = 0<br/>    for i in range(x-1):<br/>        prob+=p*(1-p)**i<br/>    return prob</span><span id="827b" class="mq kj it ni b gy od nn l no np">def geomcdf_2(p, x):<br/>    # implementing second approach<br/>    prob = 1-(1-p)**(x-1)<br/>    return prob</span><span id="d9aa" class="mq kj it ni b gy od nn l no np">geomcdf_1(0.1, 5)</span><span id="9d49" class="mq kj it ni b gy od nn l no np">0.34390000000000004</span><span id="0f6f" class="mq kj it ni b gy od nn l no np">geomcdf_2(0.1, 5)</span><span id="ca46" class="mq kj it ni b gy od nn l no np">0.3439</span></pre><p id="700f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以看到，实现任何一种方法都会得到相同的结果。然而，第二种方法的计算成本要低得多，因为我们不需要遍历所有情况。</p><h2 id="1952" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated">几何随机变量的期望值</h2><p id="0287" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">任何离散RV的概率是概率加权结果的总和。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/6dbde688758464804bec76600a315151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*D2DGN2w3OcYbZQMlwEY_-g.png"/></div></figure><p id="91d2" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在几何RV中，我们已经知道如何计算概率。例如，<em class="nc"> P(X=1) </em>是一次成功的概率，因此<em class="nc"> P(X=1)=p </em>。在<em class="nc"> P(X=2)，</em>我们有两次试验，因此必然有一次不成功的试验和一次成功的试验，因此<em class="nc"> P(X=2)=(1-p)p </em>等等。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6ac566ef2534c5c721348954587a59e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*qu5uaDlWl6-oa1WG4sBSsA.png"/></div></figure><p id="5576" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果我们减去这两个方程，</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/d4a17e6e0bd84da4b26875d74351100b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*ilCn5V1dy7Rl_mbB1nFjPw.png"/></div></figure><p id="b8e9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这就是我们的经典几何级数，其公比是<em class="nc"> (1-p) </em>。事实上，这也是我们称之为几何RV的原因之一。一个几何级数的和为<em class="nc"> 1/(1-r) </em>，其中<em class="nc"> r </em>为公比。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/5c7118e8692171c34c9a889713308884.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*krRibOtgT5IUr2beT08gsA.png"/></div></figure><p id="d174" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在我们已经得到了几何RV的期望值，让我们通过实验看看是否能得到相同的结果。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="6650" class="mq kj it ni b gy nm nn l no np">p=0.2<br/>X = np.random.geometric(p, 1000000)<br/><br/>print('Theoretical expected value: ' + str(X.mean()))<br/>print('Empirically calculated expected value: ' + str(1/p))</span><span id="7d8d" class="mq kj it ni b gy od nn l no np">Theoretical expected value: 5.00225<br/>Empirically calculated expected value: 5.0</span></pre><p id="b53c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这就对了，我们可以对我们的推导感到满意了。</p><h2 id="03da" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated">比较泊松随机变量和二项随机变量</h2><p id="5cb2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们能从二项式随机变量(RV)中近似出一个泊松随机变量(RV)吗？</p><p id="a909" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们将RV <em class="nc"> X </em>定义为我们看到经过我们街道的UberEats摩托车的数量。</p><p id="26d0" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果我们试图建立在这个想法上，我们会以某种方式得到一个期望值<em class="nc"> X </em>，看起来像这样:</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/ffef010a5814810d346218990aff0108.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*Rl8gz1sjgCa6Fv7aPkBHMg.png"/></div></figure><p id="de48" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们的概率是这样的:</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/e9351bc816021fccaf1fe5aa992e63a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*71SdZsSRa-0AU-KbkegdOQ.png"/></div></figure><p id="f99c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">问题是，每分钟都有超过一辆摩托车经过我们的街道，而我们目前的设置无法解释这一点。但是有一种方法可以做到这一点，因为我们可以更细化。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/d8cfd230940b0b5d80758122cf3e15b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*C05l6qgD9xYgTTaY4Rs9TA.png"/></div></figure><p id="9a33" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，我们在用秒来工作，每秒钟看到1辆摩托车的概率相当小。但是我们仍然可以面对半秒钟内有两辆摩托车经过我们街道的问题。所以我们可以把它变得更小。我想你知道这是怎么回事了。</p><p id="0c82" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们需要理解当<em class="nc"> n </em>趋于无穷大时会发生什么。在深入讨论这个问题之前，让我们先修改一下在我们的证明中需要用到的三个性质。前两个与限制有关:</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/9703637fbcc71e3e9b276c10b5cb1e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*Uucy_aicr8uDvDYeBhVRoA.png"/></div></figure><p id="519b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">第三个是组合学:</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/957e1a00ff7ffdf7025e4ba1e17722a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*Tg6raDeyuJgm1qpQVJDPwA.png"/></div></figure><p id="f17f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">利用这些性质，我们可以直观地看出泊松RV实际上是二项式RV的导数。</p><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi oq"><img src="../Images/bed2a845eb03593e02dd7f14dcfa3e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KP40Kd006G9whpN_dN_gnw.png"/></div></div></figure><p id="9b31" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们刚刚得到了泊松分布的概率质量函数。</p><h2 id="5fbb" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated">通过计算概率质量函数值来证明</h2><p id="617f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们总是希望我们的证明和推导是安全的，所以让我们首先计算二项式RV的<em class="nc"> n </em>的不同值的概率质量函数，然后将结果与相同速率的泊松RV进行比较。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="e9f7" class="mq kj it ni b gy nm nn l no np">from scipy.stats import binom, poisson<br/>import matplotlib.pyplot as plt</span><span id="fa5c" class="mq kj it ni b gy od nn l no np">n1 = 20<br/>n2 = 60<br/>n3 = 3600<br/>λ = 9<br/><br/>x = np.arange(9)<br/><br/>X1 = binom.pmf(x, n1, λ/n1)<br/>X2 = binom.pmf(x, n2, λ/n2)<br/>X3 = binom.pmf(x, n3, λ/n3)<br/><br/>Z = poisson.pmf(x, 9)</span><span id="c51a" class="mq kj it ni b gy od nn l no np">print(f'P(X1&lt;=9) of a Binomial RV with n={n1}: ' + str(np.sum(X1)))<br/>print(f'P(X2&lt;=9) of a Binomial RV with n={n2}: ' + str(np.sum(X2)))<br/>print(f'P(X3&lt;=9) of a Binomial RV with n={n3}: ' + str(np.sum(X3)))<br/>print(f'P(Z&lt;=9) of a Poisson RV with λ={λ}: ' + str(np.sum(X3)))</span><span id="80f4" class="mq kj it ni b gy od nn l no np">P(X1&lt;=9) of a Binomial RV with n=20: 0.41430623411611534<br/>P(X2&lt;=9) of a Binomial RV with n=60: 0.44482436484547344<br/>P(X3&lt;=9) of a Binomial RV with n=3600: 0.455487676774296<br/>P(Z&lt;=9) of a Poisson RV with λ=9: 0.455487676774296</span></pre><p id="3145" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">注意我们的直觉是正确的；随着<em class="nc"> n </em>的值变得更大，我们实际上正在逼近泊松RV的相同概率。</p><h2 id="e5fe" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated">抽样证明</h2><p id="5841" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们可以通过从上面定义的RVs中取样来做同样的练习，然后计算概率。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="d0aa" class="mq kj it ni b gy nm nn l no np">X1 = binom.rvs(n=n1, p=λ/n1, size=100000)<br/>X2 = binom.rvs(n=n2, p=λ/n2, size=100000)<br/>X3 = binom.rvs(n=n3, p=λ/n3, size=100000)<br/><br/>Z = poisson.rvs(9, size=100000)</span><span id="6827" class="mq kj it ni b gy od nn l no np">print(f'P(X1&lt;=9) of a Binomial RV with n={n1}: ' + str(X1[X1&lt;9].shape[0]/X1.shape[0]))<br/>print(f'P(X2&lt;=9) of a Binomial RV with n={n2}: ' + str(X2[X2&lt;9].shape[0]/X2.shape[0]))<br/>print(f'P(X3&lt;=9) of a Binomial RV with n={n3}: ' + str(X3[X3&lt;9].shape[0]/X3.shape[0]))<br/>print(f'P(Z&lt;=9) of a Poisson RV with λ={λ}: ' + str(Z[Z&lt;9].shape[0]/Z.shape[0]))</span><span id="b7a9" class="mq kj it ni b gy od nn l no np">P(X1&lt;=9) of a Binomial RV with n=20: 0.41375<br/>P(X2&lt;=9) of a Binomial RV with n=60: 0.44721<br/>P(X3&lt;=9) of a Binomial RV with n=3600: 0.45365<br/>P(Z&lt;=9) of a Poisson RV with λ=9: 0.45409</span></pre><p id="480d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们还可以绘制每个分布的概率质量函数，注意当<em class="nc"> n </em> =3600时，这个近似值实际上是非常好的。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="6f42" class="mq kj it ni b gy nm nn l no np">_,ax = plt.subplots(2, 2, figsize=(25, 10), sharey=True, sharex=True)<br/>ax = ax.ravel()<br/><br/>λ=9<br/><br/>ax[0].hist(binom.rvs(n=20, p=9/20, size=100000), bins=50)<br/>ax[0].set_title(f'Binomial RV with n={20}, p={9}')<br/>ax[1].hist(binom.rvs(n=60, p=9/60, size=100000), bins=50, color='darkorange')<br/>ax[1].set_title(f'Binomial RV with n={60}, p={9}')<br/>ax[2].hist(binom.rvs(n=1000000, p=9/1000000, size=100000), bins=50, color='black');<br/>ax[2].set_title(f'Binomial RV with n={3600}, p={9}')<br/>ax[3].hist(poisson.rvs(9, size=100000), bins=50, color='red')<br/>ax[3].set_title(f'Poisson RV with λ={9}');</span></pre><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi or"><img src="../Images/c37768138c4e121ecf5bcd6ab919a2cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uT8pCekfddKDwY1HV-Q7PQ.png"/></div></div><p class="ny nz gj gh gi oa ob bd b be z dk translated">图2:使用具有不同<em class="os"> n值的二项式RV来近似泊松RV；请注意，随着n变大，二项式RV的采样分布形状越来越接近泊松RV的采样分布。</em></p></figure><h1 id="08d7" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">练习</h1><p id="323e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">你将在下周的文章中找到答案。</p><ol class=""><li id="0d3f" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv ot mh mi mj bi translated">你有一副标准的牌，你在挑选牌，直到你得到一张女王(如果他们不是女王，你替换他们)。你需要挑5张牌的概率是多少？而不到10？而且超过12个？</li><li id="c759" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv ot mh mi mj bi translated">Jorge对冰柜进行检查。他发现94%的冰柜成功通过了检查。设<em class="nc"> C </em>为Jorge检查的冰柜数量，直到某个冰柜未通过检查。假设每次检查的结果都是独立的。</li><li id="6fa8" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv ot mh mi mj bi translated">佩德罗罚球命中率为25%。作为热身，佩德罗喜欢罚任意球，直到他罚进为止。设M为佩德罗第一次任意球射门的次数。假设每个镜头的结果是独立的。找出佩德罗第一次投篮不到4次的概率。</li><li id="1154" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv ot mh mi mj bi translated">构建一个计算泊松PMF的函数，除了使用来自<code class="fe ou ov ow ni b">numpy</code>的<code class="fe ou ov ow ni b">np.exp</code>之外，不使用任何来自外部包的函数。选择一些参数，并将您的结果与<code class="fe ou ov ow ni b">scipy</code>中的<code class="fe ou ov ow ni b">pmf</code>函数进行比较。</li><li id="c55d" class="mb mc it lc b ld ml lg mm lj mn ln mo lr mp lv ot mh mi mj bi translated">构建一个计算泊松CDF的函数，而不使用任何外部包。选择一些参数，并将您的结果与<code class="fe ou ov ow ni b">scipy</code>中的<code class="fe ou ov ow ni b">cdf</code>函数进行比较。</li></ol><h2 id="5f9e" class="mq kj it bd kk mr ms dn ko mt mu dp ks lj mv mw ku ln mx my kw lr mz na ky nb bi translated">上周的答案</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="9439" class="mq kj it ni b gy nm nn l no np">def fact(n):<br/>    x = 1<br/>    for i in range(1, n+1):<br/>        x *= i<br/>    return x<br/><br/>def comb(n, k):<br/>    x = 1<br/>    return fact(n)/(fact(k)*fact(n-k))<br/><br/>def binompmf(prob, n, k):<br/>    return comb(n,k)*prob**k*(1-prob)**(n-k)<br/><br/>def binomcdf(prob, n, x):<br/>    result = 0<br/>    for x_ in range(0, x+1):<br/>        result += binompmf(prob, n, x_)<br/>    return result</span></pre><p id="4b8c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">1.一家公司生产瓶装水。在其主要工厂，有缺陷的瓶子数量是5%。质量检查包括随机选择和测试1000瓶。这些样品中有缺陷的瓶子数量的平均值和标准偏差是多少？</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="e89a" class="mq kj it ni b gy nm nn l no np">print('μ_x={}'.format(1000*0.05))<br/>print('σ_x={}'.format((1000*0.05*(1-0.05))**(1/2)))</span><span id="5d28" class="mq kj it ni b gy od nn l no np">μ_x=50.0<br/>σ_x=6.892024376045111</span></pre><p id="b3a7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">2.一家葡萄酒公司正在进行促销活动，声称每4箱葡萄酒中有1箱含有惊喜。假设你会买5箱这款酒，让X代表你在这些箱子里可以赢得的惊喜数量。假设这些盒子代表随机样本，并假设盒子之间的惊喜是独立的。你在5个盒子中最多赢得1个惊喜的概率是多少？</p><p id="5896" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">(你能用三种不同的方法解决这个问题吗？提示:通过抽样，对个体概率求和，并使用CDF) </p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="a2ec" class="mq kj it ni b gy nm nn l no np"># We want to calculate P(X&lt;=1)<br/><br/># Solution 1: By sampling<br/><br/>x = np.random.binomial(5, 0.25, 1000000)<br/><br/>x[x&lt;=1].shape[0]/x.shape[0]</span><span id="4008" class="mq kj it ni b gy od nn l no np">0.632957</span><span id="a47b" class="mq kj it ni b gy od nn l no np"># Let's draw our discrete distribution<br/><br/>sns.histplot(x, stat="density", discrete=True, shrink=0.3);</span></pre><figure class="nd ne nf ng gt nr gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/1cb059e23b57bf1b2e79c352d6c5fb61.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Ep-9uRKBYkkOCrL_gUNRgQ.png"/></div></figure><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="47af" class="mq kj it ni b gy nm nn l no np"># Solution 2: Solve it by calculating the probability for each case (X=0 and X=1)<br/><br/># Using our function<br/>print(str(binompmf(0.25, 5, 0) + binompmf(0.25, 5, 1)))<br/><br/># Using scipy package<br/>print(str(binom.pmf(0, 5, 0.25)+binom.pmf(1, 5, 0.25)))</span><span id="1764" class="mq kj it ni b gy od nn l no np">0.6328125<br/>0.6328125</span><span id="b4c5" class="mq kj it ni b gy od nn l no np"># Solution 3: Using the CDF<br/><br/># Using our function<br/>print(str(binomcdf(0.25, 5, 1)))<br/><br/># Using scipy package<br/>print(str(binom.cdf(1, 5, 0.25)))</span><span id="6e95" class="mq kj it ni b gy od nn l no np">0.6328125<br/>0.6328125</span></pre><p id="e54b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">3.一位数学老师正在和她的学生一起做一个活动，她给他们一个20个问题的选择题，而他们一个答案也不知道。学生需要猜测每个问题，每个问题有5个可能的选择，其中一个是正确的。每个学生答对的问题数量的平均值和标准差是多少？</p><p id="b1ef" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">你能用两种不同的方法解决这个问题吗？提示:通过采样和使用我们上面做的理论推导)</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="2e83" class="mq kj it ni b gy nm nn l no np"># Solution 1: solving by sampling<br/><br/>n = 20<br/>p = 0.2<br/><br/># Using numpy package<br/>X = np.random.binomial(20, 0.2, 1000000)<br/><br/>print(X.mean())<br/>print(X.std())</span><span id="418a" class="mq kj it ni b gy od nn l no np">4.001996<br/>1.7910455091884183</span><span id="5918" class="mq kj it ni b gy od nn l no np"># Using the theoretical derivation<br/><br/>μ_x = n*p<br/>σ_x = (n*p*(1-p))**(1/2)<br/><br/>print(μ_x)<br/>print(σ_x)</span><span id="ffad" class="mq kj it ni b gy od nn l no np">4.0<br/>1.7888543819998317</span></pre><p id="3951" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">保持联系:<a class="ae mk" href="https://www.linkedin.com/in/luisbrasroque/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p></div></div>    
</body>
</html>