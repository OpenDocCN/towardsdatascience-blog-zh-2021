<html>
<head>
<title>The Intuitive Explanation of Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归的直观解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-intuitive-explanation-of-logistic-regression-a0375b1bee54?source=collection_archive---------35-----------------------#2021-04-26">https://towardsdatascience.com/the-intuitive-explanation-of-logistic-regression-a0375b1bee54?source=collection_archive---------35-----------------------#2021-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="521e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">深刻的基本理解是正确使用的关键</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/b21576d627c0aa5e92e743f1548942f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*BovPufYV8PMy1EbeEyMLLQ.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由皮查拜的<a class="ae ku" href="https://pixabay.com/users/geralt-9301/" rel="noopener ugc nofollow" target="_blank">杰拉德</a>拍摄</p></figure><h1 id="d00f" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">介绍</h1><p id="9c1b" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">逻辑回归可能很难理解！因此，我对逻辑回归的原因、内容和方式做了一个非常直观的解释。我们将从一些有助于更清晰理解的构件开始，所以坚持住！通过这篇文章，我希望能引导你理解、构建和解释逻辑回归模型。尽情享受吧！</p><h1 id="da8d" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">什么是逻辑回归？</h1><p id="c6c9" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">逻辑回归是一种非常流行的预测或理解二元变量(热或冷，大或小，这个或那个——你懂的)的方法。逻辑回归属于分类的机器学习范畴。</p><p id="cbc9" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">再举一个例子来区分线性回归和逻辑回归:而不是预测某样东西会卖多少钱..你也可以预测它是否会被卖掉。不多说了，让我们开始吧！</p><h1 id="8aef" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">将线性回归理解为前兆</h1><p id="3954" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们来讨论一个线性回归的输出。对于那些不熟悉线性回归的人来说，最好从这里开始。你可以访问这个帖子来了解一下<a class="ae ku" rel="noopener" target="_blank" href="/build-evaluate-and-interpret-your-own-linear-regression-model-in-minutes-e6a3e8253501">简单线性回归</a> &amp;这个为<a class="ae ku" rel="noopener" target="_blank" href="/multiple-regression-a-primer-on-parallel-slopes-models-137d114e314e">多元线性回归</a>。</p><p id="6979" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">现在知道一点线性回归；您会知道线性回归输出相当于一条直线的方程。很简单..这就是我们想要的一切；只是一种重新解释一个变量的方法，借以洞察另一个变量。</p><p id="b0e9" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">知道了这些，让我们对一个二元变量进行线性回归。二进制是或否，1或0。这个变量将是我们逻辑回归的候选变量，但我们很快就会知道。</p><h1 id="7781" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">构建线性回归以理解逻辑回归</h1><p id="41b8" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">今天我们将使用<code class="fe mo mp mq mr b">mtcars</code>数据集。这是一个用于数据科学学习的经典数据集，详细描述了各种汽车的油耗、发动机详细信息以及其他详细信息。</p><p id="bfdd" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">快速浏览数据集:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="d7ef" class="mw kw it mr b gy mx my l mz na">glimpse(mtcars)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/f365b73b26eb9cad2da58caeb133396e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sYNfVhXNA2Q5Z7Tm"/></div></div></figure><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="9f97" class="mw kw it mr b gy mx my l mz na">head(mtcars)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/7984e1194778aca8b6a84f624352c487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CpDwLql-TL24AzmF"/></div></div></figure><h1 id="50d1" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">二元变量的线性回归</h1><p id="18f6" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">在这个数据集中，我们有一个二元变量… <code class="fe mo mp mq mr b">vs</code>。由于对汽车了解不多，我无法给你详细解释<code class="fe mo mp mq mr b">vs</code>是什么意思，但高水平是它是发动机配置的代表..我也知道配置会对功率、效率等产生影响。这是我们能够通过模型梳理出来的。因此，希望这将很容易确定的差异！</p><p id="e9bb" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">让我们建立回归模型吧！我们将试图把<code class="fe mo mp mq mr b">vs</code>理解为每加仑英里数的函数。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="2412" class="mw kw it mr b gy mx my l mz na">fit &lt;- lm(vs ~ mpg<br/>  ,data = mtcars)<br/>summary(fit)</span></pre><p id="282f" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">请随意查看下面的回归输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/2ef192b01964ecb7633c6684291cd2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0jmBfT0B6kGkUcxD"/></div></div></figure><p id="a1e9" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">你可以看到R的平方是0.44，这意味着我们可以解释44%的y的变化，x的变化。不错。我们还看到p值小于0.05。竖起两个大拇指。</p><p id="2b6e" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">现在事情变得棘手了..让我们来看看y轴截距。我们的y轴截距是0.67。看起来很奇怪，因为vs不是可以变负的东西…事实上，它只能是0或1。这将构成对二元变量使用线性回归的一个主要问题，但稍后会有更多的讨论。首先，我们将寻求更好地理解我们正在处理的数据。</p><h1 id="030c" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">可视化我们的输出</h1><p id="60cd" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们用散点图快速地将这两个变量形象化，并添加回归线，给我们一些额外的见解。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="0673" class="mw kw it mr b gy mx my l mz na">mtcars %&gt;%<br/>  ggplot(aes(x = mpg, y = vs))+<br/>  geom_point()+<br/>  geom_smooth(method = 'lm', se = FALSE)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/bfd4c11683a4e2a5ac5bed879e32182b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_QwfPRAM8gozKce5"/></div></div></figure><p id="ad56" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">首先，你可以看到y轴是一个连续变量，所以你会看到所有的点都在0或1上。</p><p id="d33c" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">至于x轴，我们可以看到，根据因变量是1还是0，分别向右和向左集中。这与我之前提到的<code class="fe mo mp mq mr b">vs</code>为1的汽车比<code class="fe mo mp mq mr b">vs</code>为0的汽车油耗更低是一致的。</p><p id="1193" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">从图表中可以非常直观地看到，直线以线性方式穿过两组。</p><h1 id="2c7e" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">明显的问题？</h1><p id="5ab6" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">这里显而易见的问题是，这条线在两个方向上永远都在延伸。任何一个极端的输出都是没有意义的。</p><p id="a5e3" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">为此，我们不能原样使用线性回归。这并不意味着它是无用的，我们只是必须修改它，使我们的预测极限不是无限的。</p><h1 id="0a1f" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">“一般化”线性回归</h1><p id="6072" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们得到逻辑回归的方法是通过所谓的“广义线性模型”。你可以想想我们刚刚通过简单的线性回归，创建的一条线的函数或方程。通过线性模型，我们可以根据与x相关的函数来理解y。对于逻辑回归，我们将该函数有效地包装在一个负责“概括”模型的附加函数中。</p><h1 id="4eb5" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">概化或概化函数的目的是什么？</h1><p id="36c4" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们要做的是对给定的数据点进行分类，或者换句话说，将给定mpg的车辆分配到两个组中的一个，v (0)或straight (1)。</p><p id="686b" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">从概率的角度来考虑这个问题是有帮助的。对于任何给定的<code class="fe mo mp mq mr b">mpg</code>数据点，汽车有一个给定的概率或者是v或者是直线。因此，一个旨在阐明这种关系的模型的输出有可能是有意义的。</p><p id="5481" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">总结这个想法，我们想以一种代表概率的方式来概括线性输出。</p><h1 id="44d1" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">如何概括</h1><p id="b481" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我前面提到的一般化过程是将我们的线性函数包装成另一个函数。这个函数就是所谓的链接函数。正如我刚才提到的，链接函数将线性输出缩放为0到1之间的概率。对于广义线性模型的子类逻辑回归，使用了<strong class="lp iu">逻辑</strong>链接函数。</p><h1 id="b031" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">可视化逻辑回归</h1><p id="5497" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们看一下与之前相同的图，但这次拟合的是<strong class="lp iu">逻辑</strong> <strong class="lp iu">曲线</strong>。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="4163" class="mw kw it mr b gy mx my l mz na">mtcars %&gt;%<br/>  ggplot(aes(x = mpg, y = vs))+<br/>  geom_point()+<br/>geom_smooth(method = "glm", se = FALSE, method.args = list(family = "binomial"))</span></pre><p id="dca1" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我们包含了和以前一样的代码，只是现在我们的方法是“glm ”,它指定我们想要一个通用的线性模型；其次，我们指定家庭=“二项式”。这就是调用哪个链接函数的原因。在这种情况下，“二项式”使用logit函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/5abb96450f72ee874a45d3cc19dc9776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rLbGAi6At9utDADi"/></div></div></figure><p id="78f4" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">让我们解释一下我们的新图表。正如你所看到的，我们线的两端都变平了，所以这条线永远不会达到0或1。</p><p id="3d53" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我们可以看到，朝向中间的线非常直，与我们的线性模型相似。</p><h1 id="3d23" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">构建我们的第一个逻辑回归模型</h1><p id="f76e" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们开始构建我们自己的逻辑回归模型。这与线性回归调用非常相似，但有两个关键区别。第一个是呼叫是<code class="fe mo mp mq mr b">glm</code>，第二个是家庭是类似于你在<code class="fe mo mp mq mr b">geom_smooth</code>呼叫中看到的“二项式”。这里使用它的基本原理是一样的。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="7e56" class="mw kw it mr b gy mx my l mz na">fit &lt;- glm(vs ~ mpg<br/>          ,data = mtcars<br/>          ,family = 'binomial')<br/>summary(fit)</span></pre><p id="89a6" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我想用glm函数指出的第一件事是，你必须首先将因变量编码为1或0。其他分类算法可能不需要所述编码，但是在逻辑回归的情况下，重申一下，它是线性输出的包装。因此，位于我们的链接函数内部的线性模型不会对角色或因素起作用。</p><h1 id="96e8" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">逻辑回归解释</h1><p id="7d5a" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">现在该说说解读了。这也不是一个非常简单的话题，但我们会尽可能直观地探讨它。</p><p id="f9e6" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">考虑逻辑回归解释有三种方式:</p><ul class=""><li id="469d" class="ng nh it lp b lq mj lt mk lw ni ma nj me nk mi nl nm nn no bi translated">可能性</li><li id="c30c" class="ng nh it lp b lq np lt nq lw nr ma ns me nt mi nl nm nn no bi translated">可能性</li><li id="c888" class="ng nh it lp b lq np lt nq lw nr ma ns me nt mi nl nm nn no bi translated">对数概率</li></ul><p id="0e3c" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">就可解释性而言，每一种都有不同的取舍。但是首先…定义</p><h1 id="114d" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">可能性</h1><p id="6ed8" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">很简单，概率是用0到1表示的可能性的度量。</p><h1 id="fdef" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">可能性</h1><p id="cd4d" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">另一方面，Odds用来表示某件事发生的频率(概率)相对于不发生的频率(1-概率)。</p><p id="f5b4" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">这个公式看起来像这样。</p><p id="e8a3" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">这里要考虑的一件事是它是指数级的。</p><p id="af8f" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">让我们写一点快速代码，使指数标度的原因更加直观。我们将在0 . 05之前创建一个0到1的序列。然后，我们将根据上述公式创建一个赔率字段。最后，我们将绘制线！</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="f010" class="mw kw it mr b gy mx my l mz na">probs_vs_odds &lt;- data.frame(prob = seq(0, 1, by = 0.05))<br/>probs_vs_odds &lt;- probs_vs_odds %&gt;% <br/>  mutate(inverse_prob = 1-prob,<br/>         odds = prob / inverse_prob)<br/>probs_vs_odds %&gt;%<br/>  ggplot(aes(x = prob, y = odds))+<br/>  geom_line()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/ad4e126f318584f3c9e83109ea077ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HF-sFYqolpEJPXAb"/></div></div></figure><p id="17f9" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我还将在下面添加数据帧，以提供额外的说明。希望这能让我们清楚地思考。当概率为5%时，你的赔率是1/20，相反，当概率为95%时，你的赔率是19比1，而不是线性变化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/81a85df4f4e8bbcf15931b8ed1bbf103.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/0*7cQrsTS5E1cG7LSr"/></div></figure><h1 id="0e59" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">对数赔率</h1><p id="b234" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">非常类似于一个变化的几率。我们采用对数来缓和指数曲线。一旦我们得到了对数几率，我们就能够再次将我们的模型可视化为一条线。这对于函数解释来说很好，但是对于输出解释来说就很糟糕了</p><h1 id="fa42" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">权衡取舍</h1><p id="75b3" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我下面的视觉效果旨在传达功能和输出的可解释性。概率的输出很容易解释，但是它的函数是非线性的。赔率是有道理的，但是并不是最容易在心里理解的事情&amp;它是指数级的..作为一个函数，不太有意义。最后，对数概率几乎不可能解释，但是它的函数是线性的，这对于解释是很好的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nv"><img src="../Images/ede8701daea2786940cc3ed0029068d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jBYQQZR2TfXrKihl"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nw"><img src="../Images/64a5194b54929d9030947d53c615b3bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sgqfVVt0vzi5WCgA"/></div></div></figure><p id="52af" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">没有一个是绝对最好的。而对于输出，概率是最容易解释的，概率函数本身是非线性的。你可能会发现自己在用某种组合来交流预测和函数等等。</p><h1 id="7718" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">性能赋值</h1><p id="ae46" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">在这最后一部分，我将为您提供一些工具，这些工具将是模型性能评估的关键。</p><p id="067e" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我们将使用所谓的交叉验证。所有这一切意味着，不是用你所有的数据点来训练一个模型，而是你将抽取一些数据点，等到模型被训练好，然后为它们生成预测，然后在预测和实际之间进行比较。</p><p id="e841" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">下面我们分解训练和测试组，并生成模型。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="2fb1" class="mw kw it mr b gy mx my l mz na">n &lt;- nrow(mtcars)<br/>n_train &lt;- round(0.8 * n) <br/>set.seed(123)<br/>train_indices &lt;- sample(1:n, n_train)<br/>train &lt;- mtcars[train_indices,]  <br/>test &lt;- mtcars[-train_indices,]</span><span id="74ec" class="mw kw it mr b gy nx my l mz na">fit &lt;- glm(vs ~ mpg<br/>  ,data = train<br/>  ,family = "binomial")</span></pre><p id="c6a6" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">从这里，我们将为我们的测试组生成一个预测。如果你看一下<code class="fe mo mp mq mr b">pred</code>字段，你实际上会看到是1的概率。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/a2c4a6bb27eecccab50eb7503794cbb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LYxlafN9_Yab2Jwl"/></div></div></figure><p id="efe9" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">这留给我们的挑战是，不是说这些车可能有配置1，这些有0；我们只剩下概率了。</p><p id="2e51" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">你会在下面代码的第二行看到我绕过了预测。. 5及以上为1，以下为0。</p><p id="6da2" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">. 5被用作一个相当标准的分类阈值——尽管肯定存在需要更高或更低阈值的情况。</p><p id="f2f7" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">最后，我们使用<code class="fe mo mp mq mr b">caret</code>的<code class="fe mo mp mq mr b">confusionMatrix</code>函数来可视化混淆矩阵，并提供一些性能评估指标。诸如准确性、p值、敏感性、特异性等等。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="2c97" class="mw kw it mr b gy mx my l mz na">test$pred &lt;- predict(fit, test, type = 'response')<br/>test$pred &lt;- as.factor(round(test$pred))<br/>test$vs &lt;- as.factor(test$vs)<br/>confusionMatrix(test$pred, test$vs)</span></pre><p id="d788" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">在我们的例子中，p值很高，准确性中等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ny"><img src="../Images/a546b5d012e7b23ef4ff79948a687ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RVRFgGWeQ79TuMfR"/></div></div></figure><h1 id="90d4" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">结论</h1><p id="0fb2" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">如果你已经做到了这一步，那么希望你已经了解了一两件关于逻辑回归的事情，并且会对构建、解释和交流你自己的逻辑回归模型感到舒服。</p><p id="bb79" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">在这篇文章中，我们讨论了以下内容:</p><ul class=""><li id="42a1" class="ng nh it lp b lq mj lt mk lw ni ma nj me nk mi nl nm nn no bi translated">定义</li><li id="2748" class="ng nh it lp b lq np lt nq lw nr ma ns me nt mi nl nm nn no bi translated">模型结构</li><li id="4c56" class="ng nh it lp b lq np lt nq lw nr ma ns me nt mi nl nm nn no bi translated">解释</li><li id="cf95" class="ng nh it lp b lq np lt nq lw nr ma ns me nt mi nl nm nn no bi translated">性能赋值</li></ul><p id="0f63" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我希望这证明有用！查看我在datasciencelessons.com<a class="ae ku" href="http://datasciencelessons.com" rel="noopener ugc nofollow" target="_blank">的其他数据科学课程，或者在Twitter </a><a class="ae ku" href="https://twitter.com/data_lessons" rel="noopener ugc nofollow" target="_blank"> @data_lessons </a>上关注我。祝数据科学快乐！</p></div></div>    
</body>
</html>