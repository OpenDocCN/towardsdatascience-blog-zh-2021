<html>
<head>
<title>Pfam Database Filtering Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行Pfam数据库过滤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pfam-database-filtering-using-python-164c3131c897?source=collection_archive---------35-----------------------#2021-04-05">https://towardsdatascience.com/pfam-database-filtering-using-python-164c3131c897?source=collection_archive---------35-----------------------#2021-04-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2768" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过字符串搜索选择隐马尔可夫模型(HMM)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/19dfc0c98ba822e4aec50e832fa62b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FWIW66oKeOZujdtJpSbJBQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">取自<a class="ae ky" href="https://pfam.xfam.org/family/PF00149#tabview=tab4" rel="noopener ugc nofollow" target="_blank"> Pfam </a>上Metallophos (PF00149)的HMM标志图截图。</p></figure><p id="75b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在生物信息学中，隐马尔可夫模型(hmm)用于识别在功能方面可能进化相似的序列。隐马尔可夫模型试图在给定观察到的Y(氨基酸序列)的情况下或者对于贝叶斯纯粹主义者:P(X | Y)的情况下指定X(在这个例子中是函数)。在上面的徽标中，其他具有感兴趣功能的基因(金属磷)可能在第8位含有D(天冬氨酸)，在第10位含有H(组氨酸)。如果这两个氨基酸存在于一个未标记的基因中，那么称这个新基因的功能为金属蛋白的信心就会增加。XKCD(不出所料)有一个很棒的漫画解释了条件(Y)的观测如何影响X(太阳爆炸)的预测。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/0250a5bb28242ac9d833f2ed86990b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*wkyDRC8SuVLHu-clziY7KQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图像归功于<a class="ae ky" href="https://xkcd.com/1132/" rel="noopener ugc nofollow" target="_blank"> XKCD </a>。</p></figure><p id="d4a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">隐马尔可夫模型在生物信息学中有着广泛的应用。一个被充分利用的存储蛋白质功能域hmm的仓库是<a class="ae ky" href="https://pfam.xfam.org/" rel="noopener ugc nofollow" target="_blank"> Pfam数据库</a>。Pfam数据库由Erik Sonhammer、Sean Eddy和Richard Durbin于1995年创建，用于帮助基因组注释。Pfam 34.0于2021年3月24日发布，包含19179个蛋白质家族。蛋白质家族是共享相似序列或功能的一组蛋白质。Pfam提供了一个<a class="ae ky" href="http://ftp.ebi.ac.uk/pub/databases/Pfam/current_release/" rel="noopener ugc nofollow" target="_blank"> FTP站点</a>来下载整个数据库。Pfam网站在允许用户搜索关键字和感兴趣的Pfam方面做得很好，但是，直到现在，在查询之后，下载感兴趣的家族是一个耗时的手动过程。</p><p id="997a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">从数据库中过滤Pfams】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/34350536a06107335f32f3d9ad905684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OIJJ4dXlrAOJICqq"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由法国人Daphné Be在Unsplash上拍摄</p></figure><p id="e012" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤1:下载Pfam-A.hmm.gz数据库</p><p id="ec06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pfam-A.hmm数据库可以从<a class="ae ky" href="http://ftp.ebi.ac.uk/pub/databases/Pfam/current_release/" rel="noopener ugc nofollow" target="_blank"> FTP站点</a>访问和下载。解压后需要1.5GB多一点的内存，所以要准备好。</p><p id="df10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤2:选择您的家庭或查询选项</p><p id="22e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文中的示例是查找包含单词“metallophos”的域。下载数据集中的Pfams描述不会像基于网络的搜索那样全面，因为域仅包含家族名称和简短的功能描述文本。</p><p id="6dab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤3:进行过滤</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="3097" class="mc md it ly b gy me mf l mg mh">from re import search, IGNORECASE</span></pre><p id="ef44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">re模块是Python标准库的一部分。在数据库中，Pfams由“//”分隔。我可以将所有内容读入内存，但是，您可以通过下面的awk命令分割Pfam-A.hmm文件，并搜索每个文件:</p><p id="cfd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">**注意:将n=10000改为较小的数据库文件</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="4b82" class="mc md it ly b gy me mf l mg mh">awk -v n=10000 'BEGIN{RS=ORS="//\n"; FS=OFS="\n"; c=0} {$1=$1; if(NR%n==1){close(f); f="file_" ++c ".txt"}; print &gt;f}' Pfam-A.hmm</span></pre><p id="5894" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将Pfam记录分割成一个列表，我们用两个正斜杠("//")分割数据库文件。我们还删除了最后一条记录，它对应于一个空条目。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="5127" class="mc md it ly b gy me mf l mg mh">a_file = open("Path_to_your/Downloads/Pfam-A.hmm", 'r')</span><span id="cc57" class="mc md it ly b gy mi mf l mg mh">file_contents = a_file.read().split('//')[0:-1]</span></pre><p id="46ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是字符串搜索魔术:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="361d" class="mc md it ly b gy me mf l mg mh">## Our query string<br/>substring="metallophos"</span><span id="7ec4" class="mc md it ly b gy mi mf l mg mh">## Loop through our database list<br/>for file in file_contents:<br/>     ## Check if substring is in record <br/>     if search(substring, file, IGNORECASE):<br/>        if file[:1] == '\n':<br/>            file = file[1:]<br/>        ## Write matches to new file<br/>        with open("metallophos.hmm", "a") as myfile:<br/>            myfile.write(file+"//\n")</span></pre><p id="d8cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！我们对子串metallophos的搜索返回了6个Pfam家族，我们可以用它们来搜索我们感兴趣的基因组以识别相似的功能域。我叫科迪·格利克曼，可以在LinkedIn上找到我。一定要看看我的其他一些文章！</p><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/data-augmentation-in-medical-images-95c774e6eaae"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">医学图像中的数据增强</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">如何通过重塑和重采样数据来提高视觉模型的性能</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ks mm"/></div></div></a></div><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/building-a-beautiful-static-webpage-using-github-f0f92c6e1f02"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">使用GitHub创建漂亮的静态网页</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">查找模板和为静态网页创建表单的位置</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="nb l mx my mz mv na ks mm"/></div></div></a></div><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/creating-photo-mosaics-using-python-49100e87efc"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">使用Python创建照片镶嵌</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">一步一步的教程，让你自己的美丽的图像</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="nc l mx my mz mv na ks mm"/></div></div></a></div><p id="66d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[1] Sonnhammer，Erik LL，Sean R. Eddy和Richard Durbin。" Pfam:基于种子比对的蛋白质结构域家族综合数据库."<em class="nd">蛋白质:结构、功能和生物信息学</em>28.3(1997):405–420。</p></div></div>    
</body>
</html>