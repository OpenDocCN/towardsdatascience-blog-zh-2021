<html>
<head>
<title>Going Beyond Spectral Similarity With MS2DeepScore</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用MS2DeepScore超越光谱相似性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/going-beyond-spectral-similarity-with-ms2deepscore-ef0f923428e6?source=collection_archive---------36-----------------------#2021-09-06">https://towardsdatascience.com/going-beyond-spectral-similarity-with-ms2deepscore-ef0f923428e6?source=collection_archive---------36-----------------------#2021-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="34d0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用深度学习模型直接从MS/MS谱图预测结构相似性。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f166fece6c9bce4c166a9fe106442917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Hdejr5ZkzL16-J2NqVNBQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><p id="4c52" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">光谱相似性得分通常被用作结构相似性的代表。但是在很多情况下，两者有很大的不同。这可能会对库比较的结果产生疑问。Florian和他的团队建立了一个深度学习模型，成功地直接从串联质谱预测了结构相似性。</p><h1 id="d58a" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">光谱比较是每个代谢组学工作流程的一部分</h1><p id="b8e9" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">将质谱测量结果与库测量结果进行比较是任何代谢组学分析流程中的关键步骤。你需要可靠的光谱比较，</p><ul class=""><li id="f2b2" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq mt mu mv mw bi translated"><strong class="kx ir">识别您的化合物</strong>:在参考库中搜索与您的碎片模式相匹配的化合物。</li><li id="bddb" class="mo mp iq kx b ky mx lb my le mz li na lm nb lq mt mu mv mw bi translated"><strong class="kx ir">寻找类似物</strong>:通过相似的裂解模式寻找结构相关的化合物。</li><li id="228a" class="mo mp iq kx b ky mx lb my le mz li na lm nb lq mt mu mv mw bi translated"><strong class="kx ir">帮助结构解析</strong>:将你的分子与一个分子类别联系起来，以缩小潜在的分配范围。</li></ul><p id="5812" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于串联质谱，通常通过计算它们之间的余弦值来比较质谱。高余弦值表明两种化合物的裂解曲线重叠良好。</p><p id="6776" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可能认为高余弦值与高结构相似性相关。不幸的是，余弦分数只能告诉你光谱的<strong class="kx ir">相似度。但是当你想要注释你的化合物时，你会对<strong class="kx ir">结构相似感兴趣。这是一个至关重要的区别。</strong></strong></p><h1 id="fdd6" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">光谱和结构的相似性:苹果和橘子</h1><p id="feaa" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">让我们来看看不同之处:</p><ol class=""><li id="767b" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq nc mu mv mw bi translated"><strong class="kx ir">光谱相似度</strong>，例如余弦相似度，测量两个质谱图之间的重叠。</li><li id="eb5c" class="mo mp iq kx b ky mx lb my le mz li na lm nb lq nc mu mv mw bi translated"><strong class="kx ir">结构相似度，</strong>与Tanimoto评分一样，使用分子结构的2D向量表示法来量化两个<strong class="kx ir">分子指纹</strong>的重叠。</li></ol><p id="5b63" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">光谱相似性可能与结构相似性显著不同。这可能会让你从图书馆搜索中得出错误的结论。让我们看看这会对你的工作产生怎样的影响。</p><p id="c427" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以抗生素达托霉素(上图)和一种假设的类似物(下图)为例:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/ae8813187392e97af0ce9254faedece0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NfMsNSwi-XsimCOc.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><p id="740c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">达托霉素(上图)和它的类似物(下图)改变了裂解模式，尽管总体上彼此非常相似。余弦分数比较将给出较低的分数，并且不能检测出它们是高度相似的结构。</p><ul class=""><li id="e54b" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq mt mu mv mw bi translated"><strong class="kx ir">高结构相似性:</strong>类似物(下图)的结构仍与其未修饰形式达托霉素(上图)高度相似。</li><li id="83de" class="mo mp iq kx b ky mx lb my le mz li na lm nb lq mt mu mv mw bi translated"><strong class="kx ir">低光谱相似性:</strong>类似物中的修饰携带到许多碎片中，并使许多质谱峰发生位移。结果，几乎没有重叠的峰保留下来，因此光谱相似性得分较低。</li></ul><p id="3b61" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这意味着，如果你的样品中含有达托霉素类似物，你将<strong class="kx ir">不会</strong>从文库或类似物搜索中找到，即使你在文库中有达托霉素参比光谱！</p><p id="bcdc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这意味着如果你仅仅依靠余弦相似性，</p><ul class=""><li id="bbcb" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq mt mu mv mw bi translated">你不能确定余弦值最高的匹配真的是最好的结构匹配。</li><li id="01d6" class="mo mp iq kx b ky mx lb my le mz li na lm nb lq mt mu mv mw bi translated">您的库可能包含相近的结构匹配，但您看不到它，因为匹配的光谱相似性得分非常低。</li></ul><p id="366d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，Florian Huber和他的团队找到了一种直接从串联质谱预测结构相似性的方法。</p><h1 id="1ab8" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">MS2DeepScore如何从串联质谱预测结构相似性</h1><p id="91c4" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">MS2DeepScore可以预测化合物何时是密切相关的结构类似物，即使其他比较方法，如余弦相似性，可能会失败。</p><p id="a404" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Florian Huber和他的团队使用来自15，000多种独特化合物的100，000多种光谱训练了MS2DeepScore。一旦经过训练，MS2DeepScore模型就可以直接从两种化合物各自的MS/MS图谱中预测它们之间的Tanimoto相似性得分。</p><p id="481f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用它所学到的知识，MS2DeepScore在关联结构相似的化合物方面始终优于余弦相似度和Spec2Vec，即使当化合物的碎片图谱发生变化时。重要的是，用于比较得分准确性的化合物不包括在MS2DeepScore训练数据集中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/71d1bdfb066bc8e81bb23b86eaecc22f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y2XHuBjE4jBKBz8i.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">MS2DeepScore在精度与召回率方面优于余弦得分和Spec2Vec。来源:作者</p></figure><p id="17e5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的实施例中，达托霉素和类似物之间的余弦值仅为0.24。由此，我们可以假设这些化合物在结构上并不紧密。但MS2DeepScore模型预测的谷本得分为0.95，非常接近实际的谷本得分0.98。</p><h1 id="75dc" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">使用MS2DeepScore</h1><p id="ae2d" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">开始使用MS2DeepScore很简单，您可以在几分钟内开始用它比较光谱。</p><p id="daa6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">无论用什么乐器采集，都可以使用MS2DeepScore。MS2DeepScore与<a class="ae ne" href="https://blog.esciencecenter.nl/build-your-own-mass-spectrometry-analysis-pipeline-in-python-using-matchms-part-i-d96c718c68ee" rel="noopener ugc nofollow" target="_blank"> matchms模块</a>一起工作，因此您可以选择几个开源数据类型，如。mgf，。mzxml和. mzml。</p><p id="8af9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Florian和他的团队将MS2DeepScore设计成一个包含Jupyter笔记本教程的<a class="ae ne" href="https://github.com/matchms/ms2deepscore" rel="noopener ugc nofollow" target="_blank"> python包</a>来帮助您入门。你可以使用<a class="ae ne" href="https://zenodo.org/record/4699356" rel="noopener ugc nofollow" target="_blank">模型</a>开始比较你的光谱，该模型已经在<a class="ae ne" href="https://zenodo.org/record/4699300" rel="noopener ugc nofollow" target="_blank">的15，000种化合物</a>的109，000个光谱上进行了预训练。要了解更多关于MS2DeepScore及其开发的信息，请务必查看<a class="ae ne" href="https://doi.org/10.1101/2021.04.18.440324" rel="noopener ugc nofollow" target="_blank">预印本出版物</a>。</p><h1 id="8c93" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">MS2DeepScore的下一步是什么？</h1><p id="5f42" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我们正在构建利用MS2DeepScore进行库匹配的新方法，包括一个API、一个易于使用的界面和持续更新的模型。</p><p id="63ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个新版本将提供，</p><ul class=""><li id="a82e" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq mt mu mv mw bi translated">在超过230，000个光谱上训练的新模型；</li><li id="6c60" class="mo mp iq kx b ky mx lb my le mz li na lm nb lq mt mu mv mw bi translated">图书馆与GNPS公共数据库的匹配；</li><li id="01fe" class="mo mp iq kx b ky mx lb my le mz li na lm nb lq mt mu mv mw bi translated">一种新的否定模式比较。</li></ul><p id="39be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您想试用它，请不要犹豫<a class="ae ne" href="https://www.datarevenue.com/en-contact" rel="noopener ugc nofollow" target="_blank">联系我们</a>获得测试版访问。</p></div></div>    
</body>
</html>