<html>
<head>
<title>Customer segmentation with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行客户细分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/customer-segmentation-with-python-31dca5d5bdad?source=collection_archive---------20-----------------------#2021-06-07">https://towardsdatascience.com/customer-segmentation-with-python-31dca5d5bdad?source=collection_archive---------20-----------------------#2021-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ff01" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习用Python构建用于客户细分的K-Means聚类算法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fd6c95f1e31eb9c7e40c2e41492f6869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*q0ptbSpIphpjikue.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Unsplash上的粘土银行图像</p></figure><h1 id="0921" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><p id="e3af" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">客户细分对于企业了解其目标受众非常重要。不同的广告可以基于他们的人口统计特征、兴趣和富裕程度被策划并发送给不同的受众分群。</p><p id="7f7c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">有许多无监督的机器学习算法可以帮助公司识别他们的用户群，并创建消费者细分市场。</p><p id="cf9a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在本文中，我们将研究一种流行的无监督学习技术，称为K-Means聚类。</p><p id="a002" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">该算法可以接收未标记的客户数据，并将每个数据点分配到聚类中。</p><p id="e80e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">K-Means的目标是将所有可用的数据分组到彼此不同的非重叠子组中。</p><p id="adf0" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这意味着每个子组/聚类将由区别于其他聚类的特征组成。</p><p id="9e4e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">K-Means聚类是数据科学家帮助公司进行客户细分的常用技术。这是一项重要的技能，大多数数据科学面试将测试你对这种算法的理解/你将它应用到现实生活场景的能力。</p><p id="756f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在本文中，您将了解以下内容:</p><ul class=""><li id="4ecc" class="mr ms it ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated">K均值聚类的数据预处理</li><li id="318a" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">从头开始构建K-Means聚类算法</li><li id="cb69" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">用于评估聚类模型性能的指标</li><li id="ae66" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">可视化构建的集群</li><li id="c653" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">解释和分析构建的集群</li></ul><h2 id="83a2" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">先决条件</h2><p id="388b" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">你可以在这里下载本教程<a class="ae nr" href="https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python" rel="noopener ugc nofollow" target="_blank">的数据集。</a></p><p id="a9c6" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">确保在开始之前安装以下库:pandas、numpy、matplotlib、seaborn、scikit-learn、kneed。</p><p id="aa91" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">一旦你完成了，我们就可以开始建立模型了！</p><h2 id="5439" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">导入和读取数据框</h2><p id="16cf" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">运行以下代码行以导入必要的库并读取数据集:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="791b" class="nf kz it nt b gy nx ny l nz oa"># Imports<br/><br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import sea<br/>from kneed import KneeLocator<br/>from sklearn.datasets import make_blobs<br/>from sklearn.cluster import KMeans<br/>from sklearn.metrics import silhouette_score<br/>from sklearn.preprocessing import StandardScaler<br/>from sklearn.decomposition import PCA<br/>from mpl_toolkits.mplot3d import Axes3D<br/><br/># reading the data frame<br/><br/>df = pd.read_csv('Mall_Customers.csv')</span></pre><p id="bf18" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在，让我们看看数据帧的头部:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="630d" class="nf kz it nt b gy nx ny l nz oa">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/0e001e2115b2ebb2638d031f04d0a930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/0*9H2qo3F-9flziVAF.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c213" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">数据集中有五个变量。CustomerID是数据集中每个客户的唯一标识符，我们可以删除这个变量。它没有为我们提供任何有用的集群信息。</p><p id="3513" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">由于性别是一个范畴变量，它需要被编码并转换成数字。</p><p id="606a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">所有其他变量在输入到模型中之前都将按正态分布进行缩放。我们将用平均值0和标准差1来标准化这些变量。</p><h2 id="a6df" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">标准化变量</h2><p id="a538" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">首先，让我们对数据集中的所有变量进行标准化，使它们的规模大致相同。</p><p id="cfef" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">你可以在这里了解更多关于标准化<a class="ae nr" href="https://www.youtube.com/watch?v=mnKm3YP56PY" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="d805" class="nf kz it nt b gy nx ny l nz oa">col_names = ['Annual Income (k$)', 'Age', 'Spending Score (1-100)']<br/>features = df[col_names]<br/>scaler = StandardScaler().fit(features.values)<br/>features = scaler.transform(features.values)<br/>scaled_features = pd.DataFrame(features, columns = col_names)<br/>scaled_features.head()</span></pre><p id="fccb" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在，让我们看看数据帧的头部:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/72f4feb1973e51a303ca1ce0dbddbc4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/0*eNyOBQJ3rx8JZc_D.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fa11" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以看到所有的变量都被转换了，现在以零为中心。</p><h2 id="c00b" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">一个热编码</h2><p id="042a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">变量“性别”是分类的，我们需要将其转换成数字变量。</p><p id="46aa" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这意味着我们需要为每个类别替换数字。我们可以用pd.get_dummies()对熊猫做这件事。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="45f7" class="nf kz it nt b gy nx ny l nz oa">gender = df['Gender']<br/>newdf = scaled_features.join(gender)<br/><br/>newdf = pd.get_dummies(newdf, prefix=None, prefix_sep='_', dummy_na=False, columns=None, sparse=False, drop_first=False, dtype=None)<br/><br/>newdf = newdf.drop(['Gender_Male'],axis=1)<br/><br/>newdf.head()</span></pre><p id="528f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让我们再看一下数据帧的头部:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/e6d59b72a970f1d74c2de9f6b125c74b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/0*C0p5hRh7Y456C-nz.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4e27" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以看到性别变量被改变了。您可能已经注意到，我们从数据框中删除了'<em class="oe"> Gender_Male </em>'。这是因为不再需要保留变量了。</p><p id="5234" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">'<em class="oe">性别_男性</em>的值可以从'<em class="oe">性别_女性</em>，'(<em class="oe">即如果'性别_女性'为0，那么'性别_男性'将为1，反之亦然</em>)。</p><p id="13d9" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">要了解更多关于分类变量的一键编码，你可以观看<a class="ae nr" href="https://www.youtube.com/watch?v=6WDFfaYtN6s" rel="noopener ugc nofollow" target="_blank">这个</a> YouTube视频。</p><h2 id="592e" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">构建聚类模型</h2><p id="4fd8" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们构建一个K均值聚类模型，并将其应用于数据集中的所有变量。</p><p id="dd5d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">然后，我们将在肘形图中可视化聚类模型的性能。</p><p id="8c0c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">肘图将告诉我们，在构建模型时，应该使用多少个理想的聚类。</p><p id="fb3a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">你可以在这里了解更多关于选择最佳集群数量和肘方法<a class="ae nr" href="https://www.geeksforgeeks.org/elbow-method-for-optimal-value-of-k-in-kmeans/" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="7f6c" class="nf kz it nt b gy nx ny l nz oa">SSE = []<br/><br/>for cluster in range(1,10):<br/>    kmeans = KMeans(n_jobs = -1, n_clusters = cluster, init='k-means++')<br/>    kmeans.fit(newdf)<br/>    SSE.append(kmeans.inertia_)<br/><br/># converting the results into a dataframe and plotting them<br/><br/>frame = pd.DataFrame({'Cluster':range(1,10), 'SSE':SSE})<br/>plt.figure(figsize=(12,6))<br/>plt.plot(frame['Cluster'], frame['SSE'], marker='o')<br/>plt.xlabel('Number of clusters')<br/>plt.ylabel('Inertia')</span></pre><p id="24ee" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">可视化模型的性能:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/99fa918f48f383d31c9b559eedc3ee6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PEhfn1zlov9QdTbT.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8272" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">根据上面的肘图，我们可以看到最佳的集群数是<strong class="ls iu"> 4 </strong>。</p><p id="07b6" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在，让我们看看另一个聚类指标。</p><h2 id="0665" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">轮廓系数</h2><p id="81c1" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">轮廓系数或轮廓分数是用于评估由算法创建的聚类质量的度量。</p><p id="4eaf" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">轮廓分数范围从-1到+1。轮廓分数越高，模型越好。</p><p id="88fe" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">轮廓分数测量同一聚类内所有数据点之间的距离。这个距离越小，轮廓得分越好。</p><p id="63ca" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">它还测量对象和最近簇中的数据点之间的距离。这个距离越高越好。</p><p id="28fb" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">轮廓分数越接近+1表示聚类性能越好，轮廓分数越接近-1表示聚类模型越差。</p><p id="1427" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让我们计算我们刚刚建立的模型的轮廓分数:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="64c7" class="nf kz it nt b gy nx ny l nz oa"># First, build a model with 4 clusters<br/><br/>kmeans = KMeans(n_jobs = -1, n_clusters = 4, init='k-means++')<br/>kmeans.fit(newdf)<br/><br/># Now, print the silhouette score of this model<br/><br/>print(silhouette_score(newdf, kmeans.labels_, metric='euclidean'))</span></pre><p id="de1b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这款的剪影评分大概在<strong class="ls iu"> 0.35 </strong>左右。</p><p id="8449" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这是一个不错的模型，但我们可以做得更好，并尝试获得更高的集群分离。</p><p id="715d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在我们尝试这样做之前，让我们将刚刚构建的集群可视化，以了解模型的表现如何:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="0a5c" class="nf kz it nt b gy nx ny l nz oa">clusters = kmeans.fit_predict(df.iloc[:,1:])<br/>newdf["label"] = clusters<br/> <br/>fig = plt.figure(figsize=(21,10))<br/>ax = fig.add_subplot(111, projection='3d')<br/>ax.scatter(newdf.Age[newdf.label == 0], newdf["Annual Income (k$)"][newdf.label == 0], df["Spending Score (1-100)"][newdf.label == 0], c='blue', s=60)<br/><br/>ax.scatter(newdf.Age[df.label == 1], newdf["Annual Income (k$)"][newdf.label == 1], newdf["Spending Score (1-100)"][newdf.label == 1], c='red', s=60)<br/>ax.scatter(newdf.Age[df.label == 2], newdf["Annual Income (k$)"][newdf.label == 2], df["Spending Score (1-100)"][newdf.label == 2], c='green', s=60)<br/>ax.scatter(newdf.Age[newdf.label == 3], newdf["Annual Income (k$)"][newdf.label == 3], newdf["Spending Score (1-100)"][newdf.label == 3], c='orange', s=60)<br/><br/>ax.view_init(30, 185)<br/>plt.show()</span></pre><p id="da18" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">上述代码的输出如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/5aea11c996380045b911918e25cca420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XNkTmlS0qOat9DQg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="63b5" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">从上面的图表中，我们可以看到集群分离并不太大。</p><p id="4002" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">红色的点与蓝色混合，绿色的点与黄色的点重叠。</p><p id="ab57" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这一点，以及剪影分数向我们表明，该模型的表现不是太好。</p><p id="e3d8" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在，让我们创建一个比这个模型具有更好的聚类可分性的新模型。</p><h2 id="d6b6" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">构建聚类模型#2</h2><p id="8dbb" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">对于这个模型，让我们做一些特征选择。</p><p id="5a98" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以使用一种叫做主成分分析(PCA)的技术。</p><p id="e92c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">PCA是一种帮助我们降低数据集维度的技术。当我们在数据帧上运行PCA时，会创建新的组件。这些组件解释了模型中的最大方差。</p><p id="ad13" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以选择这些变量的子集，并将它们包含在K-means模型中。</p><p id="f470" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在，让我们对数据集运行PCA:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="dd50" class="nf kz it nt b gy nx ny l nz oa">pca = PCA(n_components=4)<br/>principalComponents = pca.fit_transform(newdf)<br/><br/>features = range(pca.n_components_)<br/>plt.bar(features, pca.explained_variance_ratio_, color='black')<br/>plt.xlabel('PCA features')<br/>plt.ylabel('variance %')<br/>plt.xticks(features)<br/><br/>PCA_components = pd.DataFrame(principalComponents)</span></pre><p id="0c39" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">上述代码将呈现以下图表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/398e48565c958dd65232465af061f20e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/0*GH7yHdtOfuPHzGAH.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0071" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这张图表向我们展示了每个PCA成分，以及它的方差。</p><p id="3110" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">基于这种可视化，我们可以看到前两个主成分分析解释了大约70%的数据集方差。</p><p id="f1d8" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以将这两个部分输入到模型中。</p><p id="851f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让我们使用前两个主要成分再次构建模型，并决定要使用的聚类数:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="d9d3" class="nf kz it nt b gy nx ny l nz oa">ks = range(1, 10)<br/>inertias = []<br/><br/>for k in ks:<br/>    model = KMeans(n_clusters=k)<br/>    model.fit(PCA_components.iloc[:,:2])<br/>    inertias.append(model.inertia_)<br/><br/>plt.plot(ks, inertias, '-o', color='black')<br/>plt.xlabel('number of clusters, k')<br/>plt.ylabel('inertia')<br/>plt.xticks(ks)<br/>plt.show()</span></pre><p id="c517" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">上面的代码将呈现下面的图表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ca63cb27b35fe7b65fa251a91002dc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/0*tKQgge_4dT5OXg8S.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8761" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">同样，看起来最佳的集群数量是<strong class="ls iu"> 4。</strong></p><p id="b439" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以用4个聚类来计算该模型的轮廓分数:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ab4f" class="nf kz it nt b gy nx ny l nz oa">model = KMeans(n_clusters=4)<br/>model.fit(PCA_components.iloc[:,:2])<br/><br/># silhouette score<br/>print(silhouette_score(PCA_components.iloc[:,:2], model.labels_, metric='euclidean'))</span></pre><p id="e077" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这个模型的剪影得分是<strong class="ls iu"> 0.42，</strong>比我们之前创建的模型要好。</p><p id="21ea" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以像之前一样直观地看到该模型的集群:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="1fd1" class="nf kz it nt b gy nx ny l nz oa">model = KMeans(n_clusters=4)<br/><br/>clusters = model.fit_predict(PCA_components.iloc[:,:2])<br/>newdf["label"] = clusters<br/> <br/>fig = plt.figure(figsize=(21,10))<br/>ax = fig.add_subplot(111, projection='3d')<br/>ax.scatter(newdf.Age[newdf.label == 0], newdf["Annual Income (k$)"][newdf.label == 0], newdf["Spending Score (1-100)"][newdf.label == 0], c='blue', s=60)<br/>ax.scatter(newdf.Age[newdf.label == 1], newdf["Annual Income (k$)"][newdf.label == 1], newdf["Spending Score (1-100)"][newdf.label == 1], c='red', s=60)<br/>ax.scatter(newdf.Age[newdf.label == 2], newdf["Annual Income (k$)"][newdf.label == 2], newdf["Spending Score (1-100)"][newdf.label == 2], c='green', s=60)<br/><br/>ax.scatter(newdf.Age[newdf.label == 3], newdf["Annual Income (k$)"][newdf.label == 3], newdf["Spending Score (1-100)"][newdf.label == 3], c='orange', s=60)<br/><br/>ax.view_init(30, 185)<br/>plt.show()</span></pre><h2 id="77cf" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">模型1与模型2</h2><p id="46e3" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们比较这个模型和第一个模型的聚类可分性:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/65dd52cadcfb438c8bd4d158ec317dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ArmCHc9mXbY4c2zm.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型1</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/ed7abb3e330b635f70eda792e9a87de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/0*4bCPGraOev1hla_6.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型2</p></figure><p id="a00d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">请注意，第二个模型中的聚类比第一个模型中的聚类分离得更好。</p><p id="37ef" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">再者，第二个模特的剪影评分高了很多。</p><p id="13c1" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">出于这些原因，我们可以选择第二个模型来继续我们的分析。</p><h2 id="3d75" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">聚类分析</h2><p id="d48c" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">现在，我们已经完成了这些不同的集群的构建，让我们试着解释它们，看看不同的客户群。</p><p id="ba5d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">首先，让我们将聚类映射回数据集，并查看数据框的头部。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="3734" class="nf kz it nt b gy nx ny l nz oa">df = pd.read_csv('Mall_Customers.csv')<br/>df = df.drop(['CustomerID'],axis=1)<br/><br/># map back clusters to dataframe<br/><br/>pred = model.predict(PCA_components.iloc[:,:2])<br/>frame = pd.DataFrame(df)<br/>frame['cluster'] = pred<br/>frame.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/6e95a21ef71785ed3e8739815339be45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/0*OzOAqOVi1fc0ovt5.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9c79" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">请注意，数据框中的每一行现在都被分配给了一个聚类。</p><p id="237e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">为了比较不同分类的属性，让我们找出每个分类中所有变量的平均值:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="d6ab" class="nf kz it nt b gy nx ny l nz oa">avg_df = df.groupby(['cluster'], as_index=False).mean()<br/>avg_df.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/97822c7a7a895eaccbfcd8ed25278653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/0*RqqNy1R0IW-QZm5z.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7c89" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果我们把它们形象化，我们就能更容易地解释这些集群。运行这四行代码，得到每个变量的不同可视化效果:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="da08" class="nf kz it nt b gy nx ny l nz oa">sns.barplot(x='cluster',y='Age',data=avg_df)<br/>sns.barplot(x='cluster',y='Spending Score (1-100)',data=avg_df)<br/>sns.barplot(x='cluster',y='Annual Income (k$)',data=avg_df)</span></pre><h2 id="e611" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">消费得分vs年收入vs年龄</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/0b6514851519e9f38a35e01cd3c09ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/0*sn20XzvRGyWqo-Hb.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/6a1ca089eef6db0f5127f17cf2bfc196.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/0*iKM7whicy6GIUlAb.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/0b01b639093ee4bba2b5bb5b10294a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/0*CDQexs37DQfPAIlN.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="7a5a" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">性别分类</h2><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="acfe" class="nf kz it nt b gy nx ny l nz oa">df2 = pd.DataFrame(df.groupby(['cluster','Gender'])['Gender'].count())<br/>df2.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/ef20163d1c38b76c55a5c5e014e12a6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/0*BbpUl33BZs-M4KpN.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="d07e" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">每个细分市场的主要属性</h2><p id="a171" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">群集0:</p><ul class=""><li id="6d16" class="mr ms it ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated">平均年收入高，支出低。</li><li id="9fbd" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">平均年龄在40岁左右，性别以男性为主。</li></ul><p id="5f8b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">群组1:</p><ul class=""><li id="0b95" class="mr ms it ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated">中低收入，平均消费能力。</li><li id="2e95" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">平均年龄在50岁左右，性别以女性为主。</li></ul><p id="5745" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">第二组:</p><ul class=""><li id="2334" class="mr ms it ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated">平均收入低，支出分数高。</li><li id="afdc" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">平均年龄在25岁左右，性别以女性为主。</li></ul><p id="fec6" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">第三组:</p><ul class=""><li id="4b11" class="mr ms it ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated">平均收入高，消费得分高。</li><li id="7b03" class="mr ms it ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">平均年龄在30岁左右，性别以女性为主。</li></ul><p id="8972" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">值得注意的是，计算中值年龄可以更好地了解每个聚类中的年龄分布。</p><p id="fefe" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">此外，女性在整个数据集中的比例更高，这也是大多数聚类中女性数量多于男性的原因。我们可以找到每个性别相对于整个数据集中的数字的百分比，从而让我们更好地了解性别分布。</p><h2 id="bd19" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">围绕每个集群构建人物角色</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7af042102eee82c66641f160194858b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oWhmGqQLg7LD2UsS.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae nr" href="https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae nr" href="https://unsplash.com/@heyerlein?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> h heyerlein </a>拍摄</p></figure><p id="3421" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">既然我们知道了每个集群的属性，我们就可以围绕它们构建角色。</p><p id="1821" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">作为数据科学家，能够围绕您的分析讲述一个故事是一项重要的技能。</p><p id="13a5" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这将有助于你的客户或利益相关者更容易理解你的发现。</p><p id="05eb" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">下面是一个基于创建的集群构建消费者角色的示例:</p><h2 id="4c74" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">第0类:节俭的消费者</h2><p id="e847" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这个角色由对金钱非常谨慎的中年人组成。</p><p id="35e4" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">尽管与所有其他群体中的个人相比，他们的平均收入最高，但他们的支出却最少。</p><p id="ed04" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这可能是因为他们有经济责任——比如为孩子的高等教育存钱。</p><p id="c84d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">建议:促销、优惠券和折扣代码将吸引这一细分市场的个人，因为他们倾向于减少支出。</p><h2 id="bb12" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">群组1:几乎退休</h2><p id="e3db" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这部分人由一群老年人组成。</p><p id="e186" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">他们挣得更少，花得更少，可能正在为退休存钱。</p><p id="9b16" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">建议:针对这些人的营销可以通过脸书来完成，这吸引了年龄较大的人群。向这部分人群推广医疗保健相关产品。</p><h2 id="02ac" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">集群2:粗心的买家</h2><p id="6b17" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这一部分是由较年轻的年龄组组成的。</p><p id="6f46" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这部分人中的个人最有可能是第一批就业者。与所有其他细分市场相比，他们赚的钱最少。</p><p id="45de" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">然而，他们是非常高的消费者。</p><p id="6a0d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这些热情的年轻人享受着美好的生活方式，并且倾向于入不敷出。</p><p id="4cc4" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">建议:由于这些都是年轻人，他们花钱很多，向他们提供旅游优惠券或酒店折扣可能是个好主意。为他们提供顶级服装和化妆品品牌的折扣对这个细分市场也很有效。</p><h2 id="1cb7" class="nf kz it bd la ng nh dn le ni nj dp li lz nk nl lk md nm nn lm mh no np lo nq bi translated">集群3:高度富裕的个人</h2><p id="9a9f" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这部分人是由中年人组成的。</p><p id="ff21" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这些人努力工作积累了大量财富。</p><p id="5391" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">他们也花大量的钱去过好的生活方式。</p><p id="73dd" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这些人可能刚刚组建家庭，过着以婴儿或家庭为中心的生活方式。向这些人推销婴儿或儿童相关产品是个好主意。</p><p id="8392" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">建议:由于他们巨大的消费能力和他们的人口统计，这些个人可能会寻找购买或投资的财产。他们也比其他群体更有可能申请住房贷款，并做出严肃的财务承诺。</p><h1 id="a42e" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="06fc" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们已经成功地建立了一个用于客户细分的K-Means聚类模型。我们还探索了集群解释，并分析了每个集群中的个人行为。</p><p id="a1ae" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">最后，我们看了一些可以根据集群中每个个体的属性提供的业务建议。</p><p id="3d89" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">您可以使用上面的分析作为将来任何集群或细分项目的起始代码。</p></div><div class="ab cl or os hx ot" role="separator"><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow"/></div><div class="im in io ip iq"><p id="21cc" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">本帖最初发表于<a class="ae nr" href="https://www.natasshaselvaraj.com/customer-segmentation-with-python/" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></div></div>    
</body>
</html>