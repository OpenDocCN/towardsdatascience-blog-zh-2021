<html>
<head>
<title>Deploy a beast virtual machine for data science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为数据科学部署beast虚拟机</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploy-a-beast-virtual-machine-420b8756190e?source=collection_archive---------21-----------------------#2021-03-29">https://towardsdatascience.com/deploy-a-beast-virtual-machine-420b8756190e?source=collection_archive---------21-----------------------#2021-03-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="fa78" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/making-sense-of-big-data" rel="noopener" target="_blank">理解大数据</a></h2><div class=""/><div class=""><h2 id="154a" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用Jupyter Hub在Azure中构建定制数据科学虚拟机的指南，在一个命令中即可运行。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/74f3ea6c21acf5042d2a742279ba3b35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*-aEIxmqlrHWoVacR5HXb8Q.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">(图片来自pixilart.com<a class="ae la" href="https://www.pixilart.com/" rel="noopener ugc nofollow" target="_blank"/>来源:<a class="ae la" href="https://www.pixilart.com/art/little-laptop-1b5bef298dcee31" rel="noopener ugc nofollow" target="_blank">https://www.pixilart.com/art/little-laptop-1b5bef298dcee31</a>)</p></figure><p id="0159" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">你梦想有一天拥有超越你笨重的笔记本电脑J-Hub或Google Colab会话的能力吗？幻想您的M/L实验使用64+内核和500+GB RAM的专用硬件？直接访问英伟达特斯拉T4，M60，V100和AMD镭龙MI25 GPU设备，或1800+MBit/秒的互联网速度来下载数据进行处理怎么样？(底线:如果这些让你的瞳孔放大，像我一样，你可能需要多出去走走。)</p><p id="99a8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">今天我要把那个书呆子梦变成现实。我将向您展示如何在Azure中部署任何针对数据科学预配置的虚拟机，以及运行Jupyter Hub服务器，只需一个命令。</p><p id="2fd9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">如果你一直想进入专用云硬件的神秘世界，现在是时候了。有一种新的语言叫做<a class="ae la" href="https://github.com/Azure/bicep" rel="noopener ugc nofollow" target="_blank"> Bicep </a>，来自微软(2020年8月推出)。它提供了一种简单而优雅的方式来描述Azure云组件，您可以在命令行轻松部署这些组件。</p><p id="54e7" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我在GitHub 上专门为数据科学家构建了一个<a class="ae la" href="https://github.com/danny-baker/deploy-beast-datascience-vm" rel="noopener ugc nofollow" target="_blank">二头肌模板集。手动选择您的虚拟机规格，包括型号(内核和ram选项)，选择操作系统磁盘大小(高达4TB)，使用一个命令部署脚本，您的虚拟机在90秒内即可启动。它带有一个定制的Linux Ubuntu 18.04操作系统映像，专门为数据科学设置，预装了150GB的好东西，包括对Python、R、Julia、SQL、C#、Java、Node.js、F#的原生支持。</a></p><p id="2293" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">如果你不了解Linux，不要担心。开箱即用，该机器运行Jupyter Hub服务器，让您可以通过HTTPS(使用自签名TLS证书)即时(安全)访问该机器。一旦机器启动，你就可以通过JHub访问它。零设置。零麻烦。零笑话。</p><p id="61a0" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">对于Python JHub的粉丝来说，我敢肯定，你们中的许多人都对从本地机器上运行的硬件限制感到沮丧，或者实际上是来自像Google Colab Premium这样的云笔记本服务的限制。</p><p id="e925" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">非常清楚:这个VM是你自己的私有JHub服务器，拥有你愿意支付的所有能力和存储。</strong></p><p id="3f58" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">需要500GB Ram、4TB存储和64个CPU内核运行6小时？在几秒钟内部署您需要的确切虚拟机，并像专业人员一样完成工作。也许你和一些朋友需要一个128GB内存的中等规格钻机和一个英伟达特斯拉T4一个月；分担成本并获得协作。或者试试Azure 30天免费试用版(200美元信用),体验一下基本的4核机器、32GB内存和1TB存储。选择权在你。</p><p id="5ea8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">你的虚拟机将会为你运行，毫不妥协，不受限制。听，并理解。这台机器就在外面。这是不能讨价还价的。这是无法讲道理的。它不会感到怜悯、悔恨或恐惧。而且它绝对不会停止，直到你的[信用卡]死亡。(抱歉，终结者。忍不住。)</p><p id="4d7d" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在以下部分，我将尝试总结和对比现代数据科学家的硬件选项和局限性。我将提供云基础设施的快速速成课程(基于我不完善的理解)，我还将通过数据科学的视角描述Azure的整个VM目录。我的目标是揭开云基础设施的神秘面纱(至少对Azure来说是这样)，并描绘出有哪些选择，何时你可能想使用它们，以及你预计会支付多少钱。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lx"><img src="../Images/ffde557f5b8d2553daf0495e5f82408a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ro_Qfz_1TnfkKUtlpijF7Q.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">要是云技术像这样就好了。(图片来自pixilart.com<a class="ae la" href="https://www.pixilart.com/" rel="noopener ugc nofollow" target="_blank">)。来源:https://www.pixilart.com/art/rainbow-cloud-c07afa838edaa20</a><a class="ae la" href="https://www.pixilart.com/art/rainbow-cloud-c07afa838edaa20" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="bb7d" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">问题:云很可怕</strong></p><p id="e3f9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我认为现实是有大量的数据科学家对本地硬件或免费云服务的局限性感到沮丧，渴望尝试专用的虚拟硬件，但不知道如何轻松开始。(即智力进入成本太高)</p><p id="4768" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">谁不会被所有可笑的供应商专用术语和难以比较的定价吓跑呢？此外，还有与“云”远程机器相关的其他可怕的东西，如linux、git、ssh-keygen公共/私有加密、网络协议、TLS证书和VPN安全考虑。这是一个字面上的噩梦，这就是为什么整个行业都在努力摆脱所有这些痛苦，提供笔记本电脑即服务类型的产品。</p><blockquote class="mc md me"><p id="9d6a" class="lb lc mf ld b le lf ka lg lh li kd lj mg ll lm ln mh lp lq lr mi lt lu lv lw ij bi translated">有趣的是,“云”技术就像它的名字来源于大气云一样不透明。</p></blockquote><p id="9bed" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">令人悲伤的事实是，如果你召集一个顶级工程师团队，把他们关在一个房间里两周，并让他们设计他们能想象到的最复杂、最不连贯、最难以理解的云生态系统，你就会得到我们今天所拥有的。</p><p id="6689" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">供应商们不再以功能来命名事物，而是被激励去创造像“EFA fabric adapter”或“infiniband”这样的公司流行语(顺便说一下，这些都是真实的)来锁定客户。从短期来看，这可能会保护市场和客户份额，但从长期来看，我认为缺乏术语的功能标准化对行业来说确实是有害的。当硬件基本上在做同样的事情时，事情不应该这么复杂。在汽车行业，世界上每一个机械师都称“燃油泵”为“燃油泵”。它泵送燃料，因此根据它的功能准确地命名。当然有不同品牌的燃油泵，有些泵的压力比其他泵高，但它们基本上做的是一样的。可悲的是，这并没有发生在云世界，我认为现实的混淆是非常可悲的。这是一个很难想象云虚拟硬件原理上如何工作的抽象概念，更不用说在不同“制造商”对每个组件都有不同命名的情况下理解它了。</p><p id="1c53" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">第二个问题是:硬件不是免费的。现代数据科学家几乎总是会遇到硬件限制。无论是在本地机器上，还是在Kaggle Kernals或Google Colab中令人沮丧的会话超时，以及ram和存储的持续压力。你升级你的本地机器吗？选择托管服务(如<a class="ae la" href="https://colab.research.google.com/signup#" rel="noopener ugc nofollow" target="_blank"> Google Colab Premium </a>或<a class="ae la" href="https://cloud.google.com/ai-platform" rel="noopener ugc nofollow" target="_blank"> Google AI platform </a>)还是勇往直前进入专用虚拟硬件的最终领域？成本和限制如何比较，学习曲线会有多陡？</p><p id="1f0a" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">如果你需要更好的规格，你需要做好支付的准备。句号。但我认为，如果做得明智，云是一个比升级本地机器更具成本效益的选择，而且就您卧室的本地硬件而言，您可以远远超出即使是最好的钱也能买到的规模。</p><p id="38eb" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我希望这篇文章能让你对这些问题有一个大致的了解，并提供一个简单的选项，用最少的设置让Azure data science vm超快地运行起来。</p><p id="384a" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">带回家的消息</strong></p><ol class=""><li id="4d1a" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw mo mp mq mr bi translated">为数据科学建立一个专用的虚拟机不再像过去那样可怕，打开了访问你一直梦想的庞大硬件规格的大门。</li><li id="02e8" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw mo mp mq mr bi translated">微软发布了一种叫做Bicep的新语言，它可以帮助你优雅地描述和构建他们的基础设施。他们还发布了一个定制的数据科学操作系统映像。(很爽)。</li><li id="c664" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw mo mp mq mr bi translated">Bicep和data science操作系统映像的结合意味着您可以在90秒内按下按钮构建一个data science虚拟机，并通过JHub连接到它。我已经<a class="ae la" href="https://github.com/danny-baker/deploy-beast-datascience-vm" rel="noopener ugc nofollow" target="_blank">构建了模板</a>来帮助您做到这一点:像老板一样手动选择您的虚拟机规格并部署基础架构代码。</li><li id="96b7" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw mo mp mq mr bi translated">虽然专用硬件通常必须付费，但你可以使用200美元的信用进行30天的免费试用，但有一些重要的警告。</li></ol></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="b147" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated"><strong class="ak">快速入门</strong></h1><p id="090c" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">如果你知道如何使用ARM模板(和Bicep)部署Azure资源，那么克隆我的<a class="ae la" href="https://github.com/danny-baker/deploy-beast-datascience-vm" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>，打开适当的Bicep模板文件，设置你的VM规格，创建一个资源组，然后用一个命令在Azure CLI中部署。</p><p id="2a9e" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">使用单一命令部署</strong></p><p id="ebc8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az deployment group create -f vmtemplate.bicep --resource-group &lt;RESOURCE GROUP NAME&gt; --parameters adminUsername="USERNAME" adminPassword="PASSWORD"</code></p><p id="03fa" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这将使用针对免费帐户优化的默认模板虚拟机规格(E系列、4核、32GB内存、64GB临时固态硬盘、1TB固态硬盘操作系统磁盘):</p><p id="c551" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">或者使用最多六个参数指定虚拟机规格:</p><p id="214f" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az deployment group create -f vmtemplate.bicep --resource-group &lt;RESOURCE GROUP NAME&gt; --parameters adminUsername="USERNAME" adminPassword="PASSWORD" vmModel="Standard_E4s_v3" osDiskSize=1000 osDiskType="Premium_LRS" projectName="myproject"</code></p><p id="dfb6" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">通过JHub访问虚拟机</strong></p><p id="9e31" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">部署完成后，获取新虚拟机的公共IP地址(从门户或CLI)并通过<code class="fe ob oc od oe b"><a class="ae la" href="https://xxx.xxx.xxx.xxx:8000" rel="noopener ugc nofollow" target="_blank">https://xxx.xxx.xxx.xxx:8000</a></code>在浏览器中访问Jupyter Hub服务器</p><p id="2b59" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">通过安全外壳(SSH)访问虚拟机</strong></p><p id="bfa9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">通过终端直接访问:<code class="fe ob oc od oe b">ssh USERNAME@xxx.xxx.xxx.xxx</code></p><p id="d039" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">注意事项:</p><ul class=""><li id="f4d4" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">二头肌模板部署就像手臂。json模板(你只需要先安装Bicep)</li><li id="2dca" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">用户名和密码应该用“引号”括起来，否则特殊字符将无法正确检测</li><li id="e975" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">密码需要很强(1个大写字母、1个数字、1个特殊字符)</li><li id="fb19" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">对于JHub和其他暴露在互联网上的服务，vm为HTTPS创建一个自签名证书(TLS/SSL)。当你试图连接时，现代浏览器仍然会大发脾气。只需点击通过安全警告，你可以连接确定，并相信你是通过加密协议访问服务。</li><li id="397d" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">如果你不需要JHUB，并且希望使用密钥对你的虚拟机进行更安全的SSH访问，我有一个专门针对T4的模板。</li><li id="32e1" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">对于高级用户，我也有一个模板，用于将您的虚拟机放在高级VPN网关后面<code class="fe ob oc od oe b">vmtemplate_vpn.bicep</code>。请参阅文档或GitHub自述文件中的详细说明。</li><li id="c157" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">请注意，具有公共IP和暴露端口的虚拟机确实会引入易受攻击的漏洞。这对于短期任务来说可能是可以的，但是最佳实践是将虚拟机私有地放在VPN后面。我已经在我的repo中为此提供了一个模板，尽管注意它是为高级用户提供的，因为它需要手动步骤来创建根/客户端证书。我认为对于短期工作来说，攻击的风险是相当低的，使用默认设置应该没问题，但要知道这是有风险的。</li></ul></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="2734" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated"><strong class="ak">初学者指南</strong></h1><p id="0d5a" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">如果你是云基础设施的新手，并假装在这一点上不害怕，不要担心。遵循本指南和下面的逐步说明，您将很快拥有一个完全专用的虚拟机。</p><p id="d5e8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">下面是你要做的:在一条命令中，你将把Bicep文件(描述云基础设施的高级语言)编译成Azure Resource Manager (ARM)模板(JSON格式的基础设施的低级抽象)，然后在Azure中构建所需的资源。部署大约需要2分钟，您就可以启动并运行了。如果你是微软云的新手，我建议你获得一个<a class="ae la" href="https://azure.microsoft.com/en-gb/free/" rel="noopener ugc nofollow" target="_blank">免费的微软Azure账户</a>，这样你就可以在试用的限制内免费玩了。</p><p id="fd98" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">真正需要强调的是，我们在此次部署中使用的操作系统映像完全是(由微软)为数据科学而设置的。这意味着几乎不需要任何设置(或Linux技能)。它提供了对所有通用语言的支持，并且它本机运行Jupyter Hub服务器和R Studio lab服务器作为开箱即用的服务！这意味着一旦虚拟机启动，您就可以通过HTTPS安全地立即连接到虚拟机。</p><h2 id="ae8e" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">现代数据科学家的硬件选择</h2><p id="0797" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">在选择硬件时，我认为实际上有三个主要选项:</p><ol class=""><li id="1e99" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw mo mp mq mr bi translated">本地机器</li><li id="6499" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw mo mp mq mr bi translated">托管服务(例如笔记本电脑即服务产品)</li><li id="ab73" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw mo mp mq mr bi translated">专用远程硬件(即虚拟机)</li></ol><p id="db6c" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">每一种都有其优势和局限性，还有许多其他因素，如协作和共享工作的能力，这些因素更适合一些选项。下面我提供了众所周知的笔记本工具与专用云硬件的快速对比。很难从Kaggle和Colab那里知道确切的数字，因为许多限制都没有确切地说明或公布，所以我从其他人那里了解了一些情况。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi or"><img src="../Images/18c45622bed28725b2aa21b91c12b8de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2eADvYvRwzBdexLbBb0ZyQ.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">Kaggle、Colab和云虚拟机(在本例中为Azure)的快速比较。</p></figure><h2 id="5a0d" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">为什么选择虚拟机？</h2><ul class=""><li id="3687" class="mj mk iq ld b le nw lh nx lk os lo ot ls ou lw of mp mq mr bi translated">可扩展性和选择:访问数百个内核、数千GB内存和海量存储。</li><li id="db20" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">按需付费(按秒计费)</li><li id="0aa8" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">完全控制(完全控制您的硬件)</li><li id="72fa" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">疯狂的网速(我用一个典型的4核虚拟机达到了1854 MBit/秒的下载速度)</li></ul><h2 id="bf33" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">专用虚拟机的替代方案</h2><ul class=""><li id="7610" class="mj mk iq ld b le nw lh nx lk os lo ot ls ou lw of mp mq mr bi translated">您的本地硬件</li><li id="1622" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated"><a class="ae la" href="https://colab.research.google.com/notebooks/intro.ipynb#recent=true" rel="noopener ugc nofollow" target="_blank"> Google Colab </a></li><li id="80db" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated"><a class="ae la" href="https://www.kaggle.com/kernels" rel="noopener ugc nofollow" target="_blank">Kaggle kernels</a></li><li id="7d8f" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated"><a class="ae la" href="https://notebooks.azure.com/" rel="noopener ugc nofollow" target="_blank">天蓝色笔记本</a>(虽然我认为这已经不存在了)</li><li id="aacf" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated"><a class="ae la" href="https://deepnote.com/" rel="noopener ugc nofollow" target="_blank">深度笔记</a></li><li id="977d" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated"><a class="ae la" href="https://curvenote.com/" rel="noopener ugc nofollow" target="_blank">曲线板</a></li><li id="1de0" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated"><a class="ae la" href="https://www.dataschool.io/cloud-services-for-jupyter-notebook/" rel="noopener ugc nofollow" target="_blank">等。</a></li></ul><h2 id="9c6e" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated"><strong class="ak">Google Colab(以及类似服务)是如何免费的？？</strong></h2><p id="1acb" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">事实是，他们不是真的。硬件不是免费的。但是硬件可能没有得到充分利用，我怀疑，这正是这些服务可以零成本提供给你的原因。你在Kaggle Kernals和Google Colab上获得的将是现货市场闲置的产能；啤酒杯底的渣滓。您无法锁定超过6-12小时的硬件的原因可能是因为在企业客户早上醒来并以全价按需启动硬件之前，组件通常不会被使用。当这种情况发生时，你将被踢出你的硬件，以支持付费用户。我不确定，但这是我最好的猜测。我在这里想说明的一点是，当你想要适当地访问硬件时，你需要付费，要么通过一个很棒的本地平台，一个托管服务，要么通过云中的专用虚拟机。免费服务很棒，但是有充分的理由严格限制。</p><h2 id="1a9d" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">我可以在我的虚拟机上安全地访问Jupyter Hub吗？</h2><p id="b2b3" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">是的……嗯<em class="mf">合理地</em>安全地。事实上，这可能是这个特殊设置中最重要的事情。微软已经完成了构建特殊数据科学linux操作系统映像的所有工作，该映像可以自动运行Jupyter Hub服务器。不需要设置。他们还处理自签名TLS证书，这意味着您可以使用HTTPS连接到您的虚拟机的JHub服务器。在大多数浏览器中，您需要点击通过安全警告，但这只是因为您在虚拟机和您的pc之间使用自签名证书。这意味着您可以立即启动JHub并以强劲的马力运行，如果您愿意，还可以在您的新硬件上与其他人实时协作。我要再次强调，让一台机器的端口对公共互联网开放是有风险的。最好的选择是将机器放在VPN后面的私有网络上，但这要复杂得多，而且更难让JHub工作(我在GitHub repo中为高级用户准备了一个专用模板)。对于初学者，我认为你可以使用默认的虚拟机设置和公共IP。只是要意识到风险。</p><h2 id="495c" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">什么是基础设施即代码？</h2><p id="2aa2" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">这个例子演示了如何将云基础设施构建为代码，这是一种将您需要的组件描述为“代码”的方式。真的就是这样。许多(或所有)大公司都有某种API，用于解释要部署的基础设施。无论你是从浏览器还是直接从<em class="mf">代码</em>构建一台机器，它都被转换成一种特定于领域的格式，供供应商吸收，就像一个蓝图，以便构建组件并将它们连接起来。微软Azure使用被称为ARM模板的东西。您想要构建的所有基础设施的json表示。AWS使用. json和。yaml喜欢的界面。我不确定谷歌和其他公司。微软发布了一种新的开源语言，名为<a class="ae la" href="https://github.com/Azure/bicep" rel="noopener ugc nofollow" target="_blank">Bicep</a>(2020年8月)，它极大地简化了你描述他们基础设施的方式。它真的很棒，我们要用它了！</p><h2 id="a754" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">当我部署虚拟机时，实际构建的是什么？？</h2><p id="f885" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">重要的是要明白，当您调配虚拟机时，还需要其他云资源；它不仅仅是一个孤立配置的神奇虚拟机。例如，要部署一个具有一些暴露于互联网的端口的虚拟机，您在Azure中实际做的是构建一个虚拟网络、网络内的子网、虚拟网络接口卡、网络安全组(控制打开/关闭哪些端口之类的事情)、具有持久磁盘的存储帐户(预加载了操作系统)、虚拟机本身(实际上是计算cpu-ram组件)和一个面向公众的IP地址，以绑定到网络接口卡，以便您可以通过互联网访问虚拟机。在你把自己从最近的阳台上扔下去之前，我保证一旦你掌握了基本知识，它不会太糟糕。所有这些神奇的事情都发生在一个干净的步骤中，因此您不需要担心复杂性，可以专注于您最擅长的事情:数据的<em class="mf">科学【T1:)</em></p><p id="f7e6" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这里是网络拓扑，只是给你一个你将在Azure中构建的最终产品的图片。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/0e9be7ea4bdce2c1a2a8325a7d27dafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/0*GXALDwwxsOSIDMGs.PNG"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">这些是您将构建的组件，只需一个命令，即可创建您的数据科学虚拟机。</p></figure><h2 id="cc56" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">在Azure中理解虚拟机类型</h2><p id="a141" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">我认为大多数重量级数据科学应用程序需要高内存处理，以及CPU或GPU的并行处理。如果你是像我一样的黑客数据科学家，你会知道生活中的所有问题都可以用更多的RAM来解决。因此，我认为最令人感兴趣的虚拟机类型是来自Azure的D/E/M/N系列。</p><p id="8d65" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">下表列出了我对Azure机器类型以及数据科学应用程序需要关注的快速而粗略的描述。有许多子变型，所以这只是一个味道，让你对规格和成本范围的想法。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ow"><img src="../Images/e9eeb192a2629c1820229d4d6e25d0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCearFdpw6inwZHW-WHo-A.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">关于数据科学的Azure VM类的快速浏览</p></figure><p id="cff5" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">需要注意的一件重要事情是:RAM数量是基于CPU内核进行扩展的。所以你不能只有一个256GB内存的4核机器，以防你想知道。不同的类有不同的核心:内存比率，这是值得理解的。E系列拥有最高的内存:内核比率。</p><p id="bd35" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">更多信息<a class="ae la" href="https://azure.microsoft.com/en-gb/pricing/details/virtual-machines/linux/" rel="noopener ugc nofollow" target="_blank">在这里</a>。有用的网站<a class="ae la" href="https://azureprice.net/" rel="noopener ugc nofollow" target="_blank"> azurepricenet </a>可以让你快速找到你需要的VM家族和具体型号，以及定价。</p><p id="5180" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">对于数据工程和M/L中的非GPU应用，我认为D/E系列为您提供了一个可靠的全能设置，单个实例中最多可有96个内核和672GiB RAM，外加许多选项来适应特定项目。例如，一个“E16as_v4”将为您提供16个2.35Ghz内核、128GiB RAM和256GB临时SSD存储，每小时约1美元。</p><p id="3b6f" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">如果您正在做一些疯狂的事情，M系列是直截了当的猛兽，单个实例可以时钟输出到416个核心和11，400Gb RAM。我的意思是，我不知道你会在数据科学中使用这些。公平地说，这些更适合核心企业应用程序。但是他们在那里。</p><p id="04c9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">对于快速发展的深度学习人群，新的<a class="ae la" href="https://docs.microsoft.com/en-us/azure/virtual-machines/sizes-gpu?context=/azure/virtual-machines/context/context" rel="noopener ugc nofollow" target="_blank"> N系列</a>适合你。内有许多变体和类，但本质上，您可以自定义虚拟机以获得对GPU的部分访问(例如，每个节点0.25个GPU核心到4个专用GPU核心)。您可以直接访问Nvidia Tesla T4和M60、Volta V100、AMD Radion MI25，这些虚拟机采用最新一代cpu内核库，包含4至64个CPU内核。我应该强调这些在免费试用中不可用，你<em class="mf">必须</em>加入付费计划。这些都是严肃的，我想你们中的许多人可能想尝试。</p><p id="dc8b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这里还值得一提的是，微软并不是GPU云产品领域的巨头。公平地说，这是谷歌和其他公司。底线是他们中的大多数都提供GPU选项，如果这对你的工作至关重要，那么就值得研究选项。无论如何，我认为Azure是尝试专用云硬件的一个很好的选择，因为现在使用新的Bicep语言很容易部署。</p><p id="b8ac" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">另一件值得注意的重要事情是，在标准PAYG帐户上，您将无法提供开箱即用的资源。所有Azure帐户都有软和硬vcpu(核心)配额，因此如果您想要超过4个核心，您需要向服务台提出配额增加请求，这可能需要48小时来处理。您可以在Az CLI中根据给定区域检查所有虚拟机类型的当前限制，更多信息<a class="ae la" href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/quotas" rel="noopener ugc nofollow" target="_blank">请点击</a>。</p><h2 id="de3f" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">我的虚拟机在哪里？</h2><p id="2814" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">微软在世界各地都有数据中心，你可以在这张<a class="ae la" href="https://azure.microsoft.com/en-gb/global-infrastructure/geographies/" rel="noopener ugc nofollow" target="_blank">地图</a>上看到。根据您将创建的“资源组”的位置，您的虚拟机将驻留在您选择的数据中心。Azure资源组只是一个方便的桶，可以放入所有的资源，就像桌面电脑上的文件夹一样。您可以在“文件夹”级别控制访问，并通过一次删除来删除其所有内容。地区之间存在边际价格差异，但是对于这个用例，最重要的因素是为您的资源组选择离您当前位置最近的位置。这将最小化你和机器之间的延迟。例如“美国中部”或“英国南部”。</p><h2 id="d200" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">我可以在浏览器中使用Azure门户构建一个数据科学虚拟机吗？</h2><p id="e5b1" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">是的。事实上，我建议你使用<a class="ae la" href="http://portal.azure.com/" rel="noopener ugc nofollow" target="_blank"> Azure门户</a>，选择<a class="ae la" href="https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/dsvm-ubuntu-intro" rel="noopener ugc nofollow" target="_blank">数据科学操作系统映像</a>，构建你的第一个虚拟机。这与我在这个构建模板中使用的操作系统映像完全相同。使用门户有一些限制，所以你不能指定太多的选项，但是你肯定可以在JHub等上启动并访问你的虚拟机。我希望这篇指南向您展示将基础设施作为代码部署是多么容易，无论如何，当您从Azure门户进行部署时，这是在幕后实际发生的事情。</p><h2 id="2e11" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">我的虚拟机如何计费？</h2><p id="fff0" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">你按秒付费。是的，让虚拟机开着会比周五晚上喝龙舌兰酒更快地积累你的信用卡(你在免费账户上受到保护，别担心)。</p><p id="340d" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">大多数其他基础设施基本上是免费的(虚拟网络、子网、公共IP等)。关键成本是计算(虚拟机)和存储(连接到虚拟机的持久磁盘)。</p><p id="5bd3" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">请注意，小时费率是PAYG，如果您对虚拟机有持续需求，通常可以在3年预订期内将按需价格降低60–70%(您可以随时取消预订)。许多虚拟机还可以现货价格购买，这非常有吸引力。不要上当。我认为这对于数据科学应用来说不是一个好主意，因为你通常需要长的不间断的处理管道。在现货市场上，你的VM可以在没有任何警告的情况下被拉出来，毁掉你所有的工作。PAYG是在使用资源时获得有保证的独占性的唯一途径。</p><p id="3234" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">黄金法则是:永远记住关闭虚拟机(取消配置)或拆除所有资源(删除所有内容)您可以暂时取消配置，保留操作系统磁盘，就像关闭PC一样，或者您可以在完成后删除整个资源组。</p><h2 id="2ae2" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">免费试用版中最好的虚拟机是什么？</h2><p id="74e4" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">30天的免费试用可以获得200美元的积分，这很好，但请注意以下一些重要限制:</p><ul class=""><li id="c696" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">最大核心数=每个区域4个(意味着免费帐户上没有大灰狼虚拟机)</li><li id="9504" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">无法访问GPU虚拟机系列(升级到PAYG帐户以访问N系列GPU优化的虚拟机，起价约为1美元/小时)</li></ul><p id="41e2" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">最残忍的免费帐户设置:</p><ul class=""><li id="f29a" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">e系列“标准E4s_v3”(我的模板中的默认值)</li><li id="3d8b" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">4个内核(英特尔至强白金8272CL基本内核时钟2.5GHz，可提升至3.4Ghz所有内核)</li><li id="2b41" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">32GB内存</li><li id="b954" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">1tb高级固态硬盘(最快的操作系统磁盘类型)</li><li id="d270" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">疯狂的网速(通常1000多兆比特/秒)</li></ul><p id="91f8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这个包将燃烧约10美元的信用/天，你可以运行它24-7全速，不间断，没有cpu的限制，为20天，直到你的免费信用耗尽。您可以将操作系统磁盘大小设置为高达4，095 GB(4tb)的任何值，但1tb最大限度地提高了30天试用期的存储容量。</p><h2 id="dfe2" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">存储如何与虚拟机协同工作？</h2><p id="d835" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">所有虚拟机都需要一个用于操作系统映像的托管永久磁盘。您可以附加额外的磁盘(通常是几个)并把它们挂载到文件系统上，但是请注意，如果您不熟悉linux的话，这是非常麻烦的。到目前为止，最快、最简单的选择是将操作系统磁盘大小(高达4TiB SSD)增加到您手头任务所需的大小，因为这是自动安装的。</p><p id="8f14" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">许多VM类提供临时高速存储也没有什么价值。这通常在地理位置上靠近数据中心的计算硬件(cpu核心),基本上是您可以获得的最快的存储。我认为这有时被称为“暂存”存储。请注意，它是短暂的，仅持续几天，因此对于数据处理阶段非常有用。如果您的VM类提供临时存储，它会自动安装在您的VM上的位置<code class="fe ob oc od oe b">/mnt</code>。</p><h2 id="6202" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">如何在虚拟机之间来回传输数据？</h2><p id="e8af" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">这是一台合适的远程Linux机器，所以它不像将文档复制粘贴到你的笔记本电脑上运行JHub的windows文件系统那样简单。但是，美妙之处在于，你可以通过浏览器直接通过Jupyter Hub服务器进行大部分上传/下载，这应该可以满足大多数人的需求。别忘了，你可以从虚拟机上以闪电般的速度从互联网上下载数据。因为你的虚拟机位于数据中心，它的数据传输速度通常比你的家庭互联网或Colab快十倍(1800+ Mbit/s)。</p><p id="5520" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">将数据放入虚拟机:</strong></p><ul class=""><li id="1eb7" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">从您的pc:从linux终端使用浏览器或类似于<code class="fe ob oc od oe b">rsync</code>的工具中的JHub上传功能(要求您在windows中有WSL)</li><li id="fe7a" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">来自互联网:wget/curl/github(就像你在云笔记本工具中一样)</li></ul><p id="2ede" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">从您的虚拟机中获取数据:</strong></p><p id="7a3a" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这比你想象的要复杂一些，因为机器运行的是Linux，而你可能运行的是Windows，但是我没有什么标准的建议。它还取决于你计划在哪里存储数据，以及你有多少数据。</p><ul class=""><li id="5381" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">小(&lt;30GB): use the JHub file download feature in browser (the simplest)</li><li id="1861" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">medium: (&lt;1TB): use a linux data transfer application like  【T0】  (requires linux on your local machine, native for MacOS but Windows you will need <a class="ae la" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener ugc nofollow" target="_blank"> WSL </a></li><li id="de41" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">大型:(+1TB):直接传输到云数据存储服务，如Azure Blob或网络文件系统(NFS)。这将允许您快速从虚拟机中获取数据并将其关闭(以节省成本)，然后您可以直接连接到云存储服务以下载或更长期地存储数据。</li></ul></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="3009" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated">说明</h1><p id="5c22" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">既然速成课程已经完成，我们可以从一步一步的指导开始，以代码的形式部署您的虚拟机基础架构。注意这都在my<a class="ae la" href="https://github.com/danny-baker/deploy-beast-datascience-vm" rel="noopener ugc nofollow" target="_blank">GitHub repo</a>T1】中有详细说明</p><h2 id="06c1" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">先决条件</h2><ul class=""><li id="bd9e" class="mj mk iq ld b le nw lh nx lk os lo ot ls ou lw of mp mq mr bi translated">微软Azure账户(例如<a class="ae la" href="https://azure.microsoft.com/en-gb/free/" rel="noopener ugc nofollow" target="_blank">免费试用</a>或现收现付)</li></ul><h2 id="163c" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">1.安装VS代码和二头肌/手臂延伸(可选)</h2><p id="f208" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">这是为我们打开和编辑项目文件做准备，主要是<code class="fe ob oc od oe b">vmtemplate.bicep</code>文件或类似的模板。Microsoft Visual Studio代码非常适合这个项目，因为它是开源的，并且有可下载的bicep和ARM模板扩展，这意味着它很好地着色了代码，使其更具可读性。下载并安装<a class="ae la" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS代码</a>以及<a class="ae la" href="https://marketplace.visualstudio.com/items?itemName=msazurermtools.azurerm-vscode-tools" rel="noopener ugc nofollow" target="_blank">手臂工具</a>和<a class="ae la" href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-bicep" rel="noopener ugc nofollow" target="_blank">二头肌</a>延伸。注意，一旦VS代码运行，就可以很容易地从代码中安装这些扩展。当然这是可选的。您可以使用任何编辑器(例如Notepad++和VIM等)。)并且您根本不需要编辑文件，因为您可以在build命令中将vm规范作为参数传递。</p><h2 id="01e7" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">2.安装Azure CLI</h2><p id="7d0c" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">什么是Azure CLI？这是一个专门的程序，它提供了一个命令行界面(即CLI)来直接与Azure资源进行交互。这意味着您可以像老板一样在命令行上构建和拆除基础设施，而不是从web浏览器门户进行。最直接的方法是<a class="ae la" href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli" rel="noopener ugc nofollow" target="_blank">安装Azure CLI </a>，它可以在Windows、MacOS和Linux上运行。</p><p id="cfda" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我真的需要使用Azure CLI吗？对于这个完整的例子，是的。因为门户界面有一些限制。一般情况下:不需要。如果您只想使用用户名/密码和data science操作系统映像构建虚拟机，您可以根据需要从门户一次性完成所有操作。</p><h2 id="79ee" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">3.安装二头肌</h2><p id="cd48" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">Bicep是一种很酷的新的领域特定语言，用于以比使用ARM模板更简单的方式部署Azure资源，ARM模板是JSON格式的，阅读起来很痛苦。Bicep文件编译成Azure资源管理器(ARM)模板，然后Azure可以直接接收这些模板来构建基础设施。因此，Bicep脚本是ARM模板之上的高级抽象，它简化了您想要构建的基础设施的描述。安装二头肌只需要几分钟。此处遵循安装指南<a class="ae la" href="https://github.com/Azure/bicep" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="f03b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在Azure CLI最新版本中，它基本上是:</p><p id="beb3" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az bicep install</code></p><p id="ad35" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az bicep upgrade</code></p><h2 id="8202" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">4.克隆此回购</h2><p id="ca31" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">将这个项目repo复制到你的本地机器上，或者直接从Github浏览器下载，或者通过<code class="fe ob oc od oe b">git clone</code>等。如果你不熟悉GitHub和git，实际上，你只需要把<code class="fe ob oc od oe b">vmtemplate.bicep</code>文件放到你的本地机器上，你就可以在Azure CLI中访问它。</p><h2 id="bd19" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">5.配置虚拟机规格(有趣的部分)</h2><p id="fa8f" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">在visual studio代码中打开<code class="fe ob oc od oe b">vmtemplate.bicep</code>文件。</p><p id="939f" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在文件的开头，我总结了所有你可能想要调整虚拟机设置的旋钮和转盘。默认情况下，我选择了我能在免费帐户的限制内找到的最艰难的设置(这是一个E4s_v3，带有32GB RAM，64GB临时SSD存储和1TB高级SSD操作系统驱动器)。当然，你可以在免费账户上混合搭配几乎任何多达4个内核的虚拟机，并尝试不同大小和类型的硬盘。</p><p id="5cc4" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">您可以在。bicep文件本身，或者通过在build命令中将所需的值作为参数传递来覆盖默认值。完全由你决定。进一步提供的例子。</p><p id="6d7e" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">关键决策点:</strong></p><ul class=""><li id="1525" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">虚拟机型号—这一点至关重要，因为它决定了内核、RAM、临时存储的数量以及与I/O相关的其他限制。实际上有数百个选项。在<a class="ae la" href="https://azure.microsoft.com/en-gb/pricing/details/virtual-machines/linux/" rel="noopener ugc nofollow" target="_blank"> Azure docs </a>或<a class="ae la" href="https://azureprice.net/" rel="noopener ugc nofollow" target="_blank"> azurenet </a>上查找您想要的内容。你只需要文本字符串，比如“Standard_E4s_v3”。</li><li id="9a26" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">操作系统磁盘大小—默认为1TB高级SSD，但您可以选择高达4tb(4095 GB)的任何容量作为单个磁盘。</li><li id="df2a" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">操作系统磁盘类型请特别注意，有3种不同的存储类别，即固态硬盘“高级_LRS”，“标准固态硬盘_LRS”，即受限制的固态硬盘介质，然后是传统的硬盘驱动器“标准_LRS”。标准ssd是高级ssd价格的一半，标准HDD是高级SSD价格的1/4。在此参考文件<a class="ae la" href="https://azure.microsoft.com/en-gb/pricing/details/managed-disks/" rel="noopener ugc nofollow" target="_blank">。在所有的数据科学应用程序中，为了获得最佳性能，我只会使用“高级LRS”。</a></li></ul><h2 id="fb55" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">6.登录Azure</h2><p id="f119" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">从azure CLI:</p><p id="dcba" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az login --use-device-code</code></p><p id="fa13" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这将打开浏览器，让您输入CLI中显示的代码</p><p id="8da9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">检查可用帐户</p><p id="53fc" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az account list --output table</code></p><p id="f582" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">设置订阅(如果默认帐户不正确)</p><p id="5074" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az account set --subscription &lt;name&gt;</code></p><p id="9bc2" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">列出资源组(查看订阅中的任何现有资源组)</p><p id="f9bd" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az group list --output table</code></p><p id="314b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">可选:将Azure CLI输出格式永久设置为table，该格式比JSON更易于阅读，这是默认设置。我强烈建议这样做。</p><p id="b2d6" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az configure</code>(并按照提示操作。确保选择输出为表格格式)</p><h2 id="3be2" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">7.创建Azure资源组</h2><p id="6ad2" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">在地理位置靠近您当前位置的区域创建一个新的资源组。</p><p id="91ee" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">要查看可用区域:</p><p id="77a2" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az account list-locations</code></p><p id="cf22" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在本例中，我在“美国中部”地区创建了一个名为“beast”的资源组。通常需要几秒钟。</p><p id="4ed3" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az group create --name beast --location "Central US"</code></p><p id="f584" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">检查资源组是否已创建</p><p id="60b0" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az group list --output table</code>(如果您已经更改了Az CLI配置，则不需要每次都附加- output表)</p><p id="3ac3" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">几秒钟后，它应该会出现。您可以通过搜索“资源组”或在CLI中键入<code class="fe ob oc od oe b">az group list</code>来直接在portal.azure.com进行检查。</p><h2 id="d4e9" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">8.设置访问</h2><p id="bb4c" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">我们几乎准备好构建资源了。我们需要做的最后一件事是设置如何访问机器。有两种主要方法可以做到这一点:用户名/密码凭证或SSH公共/私有密钥加密。我有一个单独的二头肌文件为每个选项。我现在推荐user/pass default，因为这是JHub兼容的选项。</p><p id="9872" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">选择用户名和密码</p><ul class=""><li id="da35" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">注意密码必须至少包含1个大写字母、1个数字和1个特殊字符。</li><li id="edbf" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">我建议你用类似<a class="ae la" href="https://keepass.info/" rel="noopener ugc nofollow" target="_blank"> keepass </a>的东西生成一个强密码。</li><li id="11ec" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">对于我们将使用的默认模板，您必须创建用户名和密码。这是因为Jupyter Hub需要用户/通行证，不支持SSH密钥。因为我假设大多数人希望在他们的虚拟机上运行笔记本，所以我设置了允许用户名/密码的模板，这并不是连接到Linux主机的最安全的方式。</li></ul><p id="35e8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">可选:创建SSH密钥对</p><p id="6dcc" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">仅适用于您不打算使用JHub并且想要最安全的方式来访问您的VM的情况。如果您在Windows或MacOS中运行linux、WSL，并且您基本上有一个linux终端，那么您可以为虚拟机的安全shell访问(SSH)创建公钥/私钥加密文件。这是最安全的访问方式，尽管Jupyter Hub不支持它。所以不管怎样，如果你打算主要使用JHub，你就需要使用推荐的<code class="fe ob oc od oe b">vmtemplate.bicep</code>模板。从JHUB你可以访问一个完整的根终端来做你需要的任何事情。因此，这实际上只适用于那些希望能够用加密密钥直接SSH到虚拟机的铁杆用户。如果您确实需要这个选项，那么创建SSH密钥对时要准备好公钥以供复制。</p><h2 id="35f8" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">9.伟大的建筑</h2><p id="7f6a" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">这是你们一直在等待的时刻:我们已经准备好建设基础设施。从Azure CLI中，确保导航到当前工作目录，即<code class="fe ob oc od oe b">vmdeploy.bicep</code>文件所在的目录。您还必须通过Az CLI登录您的Azure帐户(步骤6)。通过运行下面适当的命令，传入用户名/密码或公钥的参数来构建虚拟机。</p><p id="0664" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们假设您决定使用用户名:jamesbond /密码:G0|den3y3，并且已经创建了一个名为“beast”的资源组。</p><p id="554b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">使用用户名/密码部署</strong></p><p id="ffd8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">使用中的默认虚拟机规范进行构建。二头肌锉:</p><p id="a5a4" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az deployment group create -f vmtemplate.bicep --resource-group beast --parameters adminUsername="jamesbond" adminPassword="G0|den3y3"</code></p><p id="1bdc" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">构建将自定义虚拟机规格作为参数传递:</p><p id="dbfa" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az deployment group create -f vmtemplate.bicep --resource-group beast --parameters adminUsername="jamesbond" adminPassword="G0|den3y3" vmModel="Standard_D2s_v3" osDiskSize=180 osDiskType="Premium_LRS" projectName="myproject"</code></p><p id="3c59" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja">使用SSH公钥部署</strong></p><p id="0a6d" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b">az deployment group create -f vmtemplate_ssh.bicep --resource-group beast --parameters adminUsername="jamesbond" adminPublicKey="INSERT FULL ASCII PUBLIC KEY HERE"</code></p><p id="7b97" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">笔记</p><ul class=""><li id="cd3e" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">对于SSH，您调用的是另一个名为<code class="fe ob oc od oe b">vmtemplate_ssh.bicep</code>的bicep模板文件。</li><li id="7efc" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">始终用引号将用户名和密码(以及公钥)括起来，以确保正确解析特殊字符。有时没有它们你会得到一个错误。</li></ul><p id="3d2e" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">如果它工作了，你应该看到类似这样的东西</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ox"><img src="../Images/c21b35099b668281611d2cccf85f7f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1mqDr13-QC9Roycy.PNG"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">如果你在耐心等待2分钟后在Azure CLI中看到类似这样的东西，那么你看起来不错。</p></figure><p id="0b11" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">登录Azure门户网站，看看你的新基础设施！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi oy"><img src="../Images/c7ac17dd9304c818f91065fc0b789f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DLSzSHwco_pS9UjG.PNG"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">导航到门户中的资源组，您可以看到所有新创建的组件(在右边)</p></figure><p id="b6fc" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">获取虚拟机的公共IP地址</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi oz"><img src="../Images/afb1f8f6db73e5fbb1b17cf874971017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*79U9OXFtK2-KevIN.PNG"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">单击虚拟机本身，查看其公共和私有IP地址(右上角)</p></figure><h2 id="defd" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">10.通过Jupyter Hub通过浏览器连接到机器！</h2><p id="08a3" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">您的新虚拟机预配置了一系列服务。部署后，它立即运行一系列容器化服务(通过Docker ),包括在端口8000上公开的Jupyter Hub服务。Jupyter Hub(在某种程度上)是一个网络服务器，所以你可以从互联网上的任何浏览器直接连接到它。</p><p id="3386" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">首先获取新虚拟机的IP地址:</p><ul class=""><li id="a436" class="mj mk iq ld b le lf lh li lk ml lo mm ls mn lw of mp mq mr bi translated">从Azure门户:搜索资源组，导航到正确的组，点击虚拟机(你可以在右上角看到公共IP)</li><li id="f4b9" class="mj mk iq ld b le ms lh mt lk mu lo mv ls mw lw of mp mq mr bi translated">来自Azure CLI: <code class="fe ob oc od oe b">az vm show -d -g &lt;RESOURCE GROUP NAME&gt; -n &lt;VM NAME&gt; --query publicIps -o tsv</code></li></ul><p id="14fb" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">打开浏览器并访问Jupyter Hub webserver(它运行在通过端口8000暴露的虚拟机上)，其中IP地址替换了x。：</p><p id="7470" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><code class="fe ob oc od oe b"><a class="ae la" href="https://xxx.xxx.xxx.xxx:8000" rel="noopener ugc nofollow" target="_blank">https://xxx.xxx.xxx.xxx:8000</a></code></p><p id="8dfe" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">浏览浏览器安全警告。您的虚拟机已经生成了自己的自签名SSL证书，以允许加密的浏览器流量(HTTPS)。但是，由于这不是一个公共证书，当您第一次连接时，浏览器通常会发出警告。不要担心，你通常可以点击“接受风险”，然后“转到网站”。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi pa"><img src="../Images/24722c7cdd1288d12155434f7dff9c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SHZRqKNdmeaEoieW.PNG"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">你仍然可以通过HTTPS安全地传输数据，只不过你使用的是一个来自Linux虚拟机的自签名证书，它不能被浏览器公开识别。</p></figure><p id="2d93" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">完成后，您应该会看到一个Jupyter hub登录屏幕:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi pb"><img src="../Images/2f5e5ec06e09c351ce1494d86a87e6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HzbaJH9MeKrGdOWP.PNG"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">如果你看到这个屏幕。开始庆祝吧。</p></figure><p id="51cf" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">使用您在部署时为虚拟机提供的用户名和密码登录Jupyter Hub</p><p id="7367" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">如果成功了，您将看到如下所示的Jhub会话。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi pc"><img src="../Images/33d0219639dff1aaf670f2e7fa1ea3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JmfWbmiUtIr9jln3.PNG"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">Jupyter Hub会话由运行在本地机器浏览器中的远程虚拟机托管！</p></figure><h2 id="99c6" class="og nf iq bd ng oh oi dn nk oj ok dp no lk ol om nq lo on oo ns ls op oq nu iw bi translated">你被录取了。在这一点上，你可以开始玩笔记本电脑或与朋友合作，以数据科学了！</h2><p id="b3d3" class="pw-post-body-paragraph lb lc iq ld b le nw ka lg lh nx kd lj lk ny lm ln lo nz lq lr ls oa lu lv lw ij bi translated">我真诚地希望这对某人有用；这对一年前的我肯定是有用的。请注意，在我的<a class="ae la" href="https://github.com/danny-baker/deploy-beast-datascience-vm" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中，我在<code class="fe ob oc od oe b">READEME.md</code>的结尾提供了额外的细节，比如如何将你的虚拟机放在VPN后面(如果安全是最重要的),以及如何测试你的虚拟机的一些基本规格，如互联网速度，如果你不熟悉Linux，检查处理器和RAM的利用率等。</p><p id="e96d" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">最后要说明的是，我不是云方面的权威，我只是碰巧花了六个月的时间与各种Azure虚拟机一起工作，觉得是时候分享一些我一路走来所学到的东西了。</p><p id="2801" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我欢迎更正和澄清，我也希望看到了解AWS和谷歌云的人写类似的文章。</p><p id="4bce" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">享受❤</p></div></div>    
</body>
</html>