<html>
<head>
<title>Master Python Sets With These 6 Things</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python大师用这6样东西来设定</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/master-python-sets-with-these-6-things-23dce2c7e0d8?source=collection_archive---------24-----------------------#2021-09-13">https://towardsdatascience.com/master-python-sets-with-these-6-things-23dce2c7e0d8?source=collection_archive---------24-----------------------#2021-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6998" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Python项目中明智地使用集合</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9e6c076b15d4786b8ba7f9f484df85bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5BOnoYnPdjlEVuVP"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@krisroller?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯托弗·罗拉</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="aa0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每个Python项目中，我们到处都使用内置数据类型。在数据容器中，我注意到使用最多的是列表和字典，其次是元组。不知何故，集合是最少使用的。但是，有一些特殊的方法是集合所独有的，这将使我们的工作变得得心应手。在这篇文章中，我想回顾一下集合的所有重要基础知识。在您的项目中使用set会更舒服。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="51f1" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">1.结构:字面、构造和理解</h2><p id="afdd" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">当我们创建一个set对象时，最常见的方式是在我们知道什么对象构成了<code class="fe na nb nc nd b">set</code>对象的情况下使用literal方式。具体来说，我们使用一对花括号将元素括起来。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">集合创建</p></figure><p id="015b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以直接使用set构造函数，在其中我们可以传递任何iterable，比如列表、元组和字典。下面是一些例子。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="9745" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; # Create a set from a list using the constructor<br/>&gt;&gt;&gt; set([1, 3, 2, 3, 2])<br/>{1, 2, 3}<br/>&gt;&gt;&gt; # Create a set from a dictionary using the constructor<br/>&gt;&gt;&gt; set({1: "one", 2: "two"})<br/>{1, 2}</span></pre><p id="63f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能听说过列表综合，以类似的方式，我们可以使用集合综合和现有的iterable来创建集合。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="7864" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; # Starting with a list of integers<br/>&gt;&gt;&gt; numbers = [-3, -2, -1, 1, 2, 3]<br/>&gt;&gt;&gt; # Create a set from the integers<br/>&gt;&gt;&gt; squares = {x*x for x in numbers}<br/>&gt;&gt;&gt; squares<br/>{9, 4, 1}</span></pre><p id="34b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，集合理解具有以下语法。这就像列表理解，除了我们用花括号代替方括号。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="5954" class="mc md it nd b gy nk nl l nm nn">{expression for item in iterable}</span></pre><h2 id="422f" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">2.哈希能力</h2><p id="e66e" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">并非所有数据都可以保存在集合中，只有可哈希对象可以作为集合项目。在Python中，哈希是应用哈希算法将对象转换为整数形式的哈希值的过程。然而，并不是每个对象都是可散列的。通常，只有不可变的对象是可哈希的，比如整数、字符串和元组。相比之下，可变对象在默认情况下是不可哈希的，一些内置的可变对象类型包括列表、集合和字典。下面的代码向您展示了这些情况。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="63a9" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; # Sets consist of immutable objects<br/>&gt;&gt;&gt; {1, "two", (3, 4)}<br/>{1, (3, 4), 'two'}<br/>&gt;&gt;&gt; # Mutable objects can't be set items<br/>&gt;&gt;&gt; {[1, 2, 3]}<br/>Traceback (most recent call last):<br/>  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br/>TypeError: unhashable type: 'list'</span></pre><p id="472c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">找出对象的哈希能力的一种方法是简单地使用内置的哈希函数。您将看到不可变对象与有效的哈希值相关联，而可变对象则不是。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="03a1" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; hash("Hello, World!")<br/>-7931929825286481919<br/>&gt;&gt;&gt; hash({1: "one", 2: "two"})<br/>Traceback (most recent call last):<br/>  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br/>TypeError: unhashable type: 'dict'</span></pre><h2 id="a5bb" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">3.非常适合会员测试</h2><p id="8dc4" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">您可能想知道为什么集合只存储可散列的对象，因为在幕后，Python使用散列表来保存这些数据。本质上，在哈希表中，我们使用哈希值来跟踪存储的对象。最大的好处是条目的查找时间恒定，这使得集合在成员关系方面是一个完美的数据结构。</p><p id="6274" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为直接比较，知道一个列表或一个元组是否包含一个特定的项需要相当长的时间，因为Python需要遍历所有的项才能知道成员资格是否为真。下面的代码向您展示了我们如何对集合和列表之间的成员资格检查进行计时。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成员资格检查:列表与集合</p></figure><p id="8f83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，即使set对象的项目数变为100，000，成员资格检查时间也是一致的。相比之下，检查成员资格所需的时间几乎与列表对象成线性增长，这突出了与列表相比，集合的成员资格检查的效率。</p><h2 id="f51b" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">4.检查集合之间的关系和操作</h2><p id="d80b" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">当我们有多个集合时，我们可以评估它们之间的关系。为了简单起见，让我们研究最基本的场景:两个集合对象之间可能的关系。下面的总结向您展示了关于集合之间的关系和操作的最常用的方法。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="6f46" class="mc md it nd b gy nk nl l nm nn"><strong class="nd iu">Check Relationships</strong><br/><strong class="nd iu">issubset</strong>: whether a set is a subset of the other<br/><strong class="nd iu">issuperset</strong>: whether a set is a superset of the other<br/><strong class="nd iu">isdisjoint</strong>: whether two sets have no intersection<br/>&lt;=: equivalent to issubset<br/>&lt;: a proper subset<br/>&gt;=: equivalent to issuperset<br/>&gt;: a proper superset</span><span id="a52d" class="mc md it nd b gy no nl l nm nn"><strong class="nd iu">Between-set Operations</strong><br/><strong class="nd iu">intersection</strong>: a set of items that belong to both sets<br/><strong class="nd iu">difference: </strong>a set of items that belong to the set but not others<strong class="nd iu"><br/>union</strong>: a set of all the items from both sets<br/><strong class="nd iu">symmetric_difference</strong>: a set of items that belong to only one set<br/>&amp;: equivalent to intersection<br/>-: equivalent to difference<br/>|: equivalent to union<br/>^: symmetric difference</span></pre><p id="fab4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些定义应该很简单，好奇的读者可以自己尝试这些操作。需要注意的一点是，您不必使用集合作为调用这些方法的参数，因为它们可以接受任何可迭代对象。下面是一个简单的例子。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="40fd" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; {1, 2}.issubset([1, 2, 3])<br/>True</span></pre><h2 id="5c48" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">5.使用和更新成员</h2><p id="be2a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">当我们使用集合对象中的所有成员时，一种常见的方式是for循环，因为集合是一种可迭代的对象，如下所示。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="2f9b" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; for number in {1, 2, 3}:<br/>...     print(number)<br/>... <br/>1<br/>2<br/>3</span></pre><p id="78bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想要使用集合中的一个项目，请不要使用订阅，因为集合不支持此操作。原因很简单——set项没有排序，它们也不是序列数据，因此当您使用subscription时，它不知道应该呈现哪个项。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="8bd0" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; {1}[0]<br/>Traceback (most recent call last):<br/>  File "&lt;input&gt;", line 1, in &lt;module&gt;<br/>TypeError: 'set' object is not subscriptable</span></pre><p id="dce0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，您可以使用<code class="fe na nb nc nd b">pop</code>方法，该方法将返回一个项目。然而，与此同时，该项目将从设置对象中删除，你必须记住这个副作用。如果您想简单地删除一个项目，您可以使用<code class="fe na nb nc nd b">remove</code>方法，该方法将返回<code class="fe na nb nc nd b">None</code>。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="c036" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; primes = {2, 3, 5, 7}<br/>&gt;&gt;&gt; primes.pop()<br/>2<br/>&gt;&gt;&gt; primes<br/>{3, 5, 7}<br/>&gt;&gt;&gt; primes.remove(3)<br/>&gt;&gt;&gt; primes<br/>{5, 7}</span></pre><p id="3063" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，当您使用<code class="fe na nb nc nd b">pop</code>方法时，如果器械包是空的，则<code class="fe na nb nc nd b">KeyError</code>将会升高。如果您使用<code class="fe na nb nc nd b">remove</code>方法移除不在set对象中的项目，您也会遇到<code class="fe na nb nc nd b">KeyError</code>。为了避免引发<code class="fe na nb nc nd b">KeyError</code>的可能性，一个相关的方法是<code class="fe na nb nc nd b">discard</code>，当它是一个实际的成员时，它将移除指定的项，或者忽略移除而不引发<code class="fe na nb nc nd b">KeyError</code>异常。</p><p id="0e59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果要移除set对象中的所有项目，只需调用<code class="fe na nb nc nd b">clear</code>，如下图所示。有些人可能会想到做<code class="fe na nb nc nd b">primes = set()</code>，不推荐这样做，因为它做的是将一个空的set对象赋给primes变量，而不是真正修改同一个set对象。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="340f" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; primes = {2, 3, 5, 7}<br/>&gt;&gt;&gt; primes.clear()<br/>&gt;&gt;&gt; primes<br/>set()</span></pre><p id="f494" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要向set对象添加一个项目，只需调用:</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="3a78" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; primes = {2, 3, 5, 7}<br/>&gt;&gt;&gt; primes.add(11)<br/>&gt;&gt;&gt; primes<br/>{2, 3, 5, 7, 11}</span></pre><p id="7982" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您想要添加多个项目时，可以使用<code class="fe na nb nc nd b">update</code>方法。类似于前面提到的方法(例如，<code class="fe na nb nc nd b">issubset</code>)，我们可以在<code class="fe na nb nc nd b">update</code>方法中使用任何可重复项，如下所示。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="ebed" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; primes.update([5, 7, 11, 13, 17])<br/>&gt;&gt;&gt; primes<br/>{2, 3, 5, 7, 11, 13, 17}</span></pre><h2 id="4d9d" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">6.另一种选择:冷冻</h2><p id="c562" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">最后但并非最不重要的一点是，有必要了解集合数据类型的一种替代形式——冻结集合(<code class="fe na nb nc nd b">frozenset</code>)。顾名思义，冻结集是不可变的，因此一旦创建，就不能修改项目。请参见以下代码片段中的示例。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="f037" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; primes_frozen = frozenset([2, 3, 5])<br/>&gt;&gt;&gt; primes_frozen.add(7)<br/>Traceback (most recent call last):<br/>  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br/>AttributeError: 'frozenset' object has no attribute 'add'</span></pre><p id="0c72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一点可能有些人不知道，就是你可以拿一套和一套冷冻的做比较。不是因为他们看起来不同的类型而返回<code class="fe na nb nc nd b">False</code>，而是只通过他们的成员进行比较，如下所示。</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="f82d" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; {1, 2, 3} == frozenset([1, 2, 3])<br/>True<br/>&gt;&gt;&gt; {1, 2, 3} &lt; frozenset([1, 2, 3, 4])<br/>True</span></pre><p id="c916" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能想知道，既然现有的集合数据类型似乎可以提供一切，我们为什么要使用冻结的集合。考虑使用冻结集有几个原因。</p><ul class=""><li id="bf49" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">当您使用集合对象并且不希望项目被意外更改时，这是使用冻结集合的好时机，因为它具有不变性，可以防止不希望的更改。</li><li id="4b46" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">不变性伴随着hashability，hash ability允许在set对象中包含冻结的集合。因为集合是可变的，所以它们不能是集合项。请参考下面的代码进行快速对比。</li></ul><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="865a" class="mc md it nd b gy nk nl l nm nn">&gt;&gt;&gt; {{1, 2}, {2, 3}}<br/>Traceback (most recent call last):<br/>  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br/>TypeError: unhashable type: 'set'<br/>&gt;&gt;&gt; {frozenset([1, 2]), frozenset([2, 3])}<br/>{frozenset({2, 3}), frozenset({1, 2})}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="70f7" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">结论</h2><p id="08c6" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在本文中，我们回顾了Python中使用set对象的最基本的操作。正如您所看到的，虽然与列表和字典相比，它们不太常用，但是集合具有有用的特征，比如集合之间的唯一成员和操作，这使得它们在特定的用例中很有价值。</p></div></div>    
</body>
</html>