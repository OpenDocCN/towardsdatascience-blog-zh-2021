<html>
<head>
<title>Crack Data Science Interviews: Advanced SQL Skills in 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">破解数据科学访谈:2021年的高级SQL技能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/crack-data-science-interviews-advanced-sql-skills-in-2021-322fef819c6c?source=collection_archive---------5-----------------------#2021-03-26">https://towardsdatascience.com/crack-data-science-interviews-advanced-sql-skills-in-2021-322fef819c6c?source=collection_archive---------5-----------------------#2021-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a539" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">破解数据科学面试</h2><div class=""/><div class=""><h2 id="3cd4" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">数据科学家和软件工程师的高级读物</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1d80ed51b8663df3e7cb4b4da52c6713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77n_Xgh9hg-p9ZR0ro_KzA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@fer_nando?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">费尔·南多</a>在<a class="ae lh" href="https://unsplash.com/t/wallpapers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="30af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结构化查询语言SQL是检索和管理数据的首选编程语言。从关系数据库中有效地提取数据是任何数据专业人员的必备技能。在过去的几个月里，我一直与数据科学的领导者保持密切联系，经常出现的一个建议是编写更多更好的SQL查询。</p><blockquote class="me mf mg"><p id="0a71" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">为了跟踪谁是活跃用户，我们使用SQL。</p><p id="86f3" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">为了计算业务指标，我们使用SQL。</p><p id="d9b6" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">为了执行任何与数据检索和管理相关的操作，我们使用SQL。</p><p id="5cb1" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi">…</p></blockquote><p id="a72b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在之前的两篇帖子中，我介绍了数据科学访谈中问到的几个基本SQL技能，这对初学者读者来说是一个很好的开始:</p><div class="ml mm gp gr mn mo"><a rel="noopener follow" target="_blank" href="/essential-sql-skills-for-data-scientists-in-2021-8eb14a38b97f"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">2021年数据科学家必备的SQL技能</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">数据科学家/工程师的重要SQL技能</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc lb mo"/></div></div></a></div><div class="ml mm gp gr mn mo"><a rel="noopener follow" target="_blank" href="/4-tricky-sql-questions-for-data-scientists-in-2021-88ff6e456c77"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">2021年数据科学家面临的4个棘手的SQL问题</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">可能会让你犯错的简单查询</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="nd l mz na nb mx nc lb mo"/></div></div></a></div><p id="2b2b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在今天的帖子中，我对FAANG公司提出的5个真实的面试问题进行了现场编码和思考。这些问题都是LeetCode上的中级题，第一次试用解决不了的请放心。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="32e3" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">#问题1:苹果、亚马逊和脸书的排名分数</h1><ul class=""><li id="df0e" class="od oe it lk b ll of lo og lr oh lv oi lz oj md ok ol om on bi translated"><a class="ae lh" href="https://leetcode.com/problems/rank-scores/" rel="noopener ugc nofollow" target="_blank">https://leetcode.com/problems/rank-scores/</a></li></ul><p id="6449" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">编写一个SQL查询来对分数进行排名。如果两个分数相同，两者的排名应该相同。请注意，在平局之后，下一个排名数字应该是下一个连续的整数值。换句话说，级别之间不应该有“漏洞”。</em></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="eedd" class="ot nm it op b gy ou ov l ow ox">+----+-------+<br/>| Id | Score |<br/>+----+-------+<br/>| 1  | 3.50  |<br/>| 2  | 3.65  |<br/>| 3  | 4.00  |<br/>| 4  | 3.85  |<br/>| 5  | 4.00  |<br/>| 6  | 3.65  |<br/>+----+-------+</span></pre><p id="3410" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">例如，给定上面的</em> <code class="fe oy oz pa op b"><em class="mh">Scores</em></code> <em class="mh">表，您的查询应该生成以下报告(按最高分排序):</em></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="5b96" class="ot nm it op b gy ou ov l ow ox">+-------+---------+<br/>| score | Rank    |<br/>+-------+---------+<br/>| 4.00  | 1       |<br/>| 4.00  | 1       |<br/>| 3.85  | 2       |<br/>| 3.65  | 3       |<br/>| 3.65  | 3       |<br/>| 3.50  | 4       |<br/>+-------+---------+</span></pre><p id="2b9d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="mh">重要提示:</em> </strong> <em class="mh">对于MySQL解决方案，要转义用作列名的保留字，可以在关键字前后使用撇号。例如</em><strong class="lk jd"><em class="mh"/></strong><em class="mh">【等级】。</em></p><h2 id="bb7a" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">穿过我的思维</h2><p id="6ac8" class="pw-post-body-paragraph li lj it lk b ll of kd ln lo og kg lq lr pl lt lu lv pm lx ly lz pn mb mc md im bi translated">苹果、亚马逊和脸书在他们的数据科学采访中提出了这个问题。这是一个简单的问题，要求等级之间没有“漏洞”或“跳跃”。</p><p id="c7c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在SQL中，有两种处理秩的方式:<em class="mh"> rank() </em>和<em class="mh"> dense_rank() </em>。区别在于dense_rank()命令不会跳过等级，而rank()命令会在出现平局时跳过等级。</p><p id="c697" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">问题语句明确地告诉我们，在平局之后，等级之间不应该有“洞”，这使得dense_rank()成为一个明显的选择。如果另一个问题没有提供这样一个友好的暗示，记得让你的面试官澄清如何打领带。如果他们有意排除如此重要的信息，他们希望你提出问题。</p><h2 id="6519" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">解决办法</h2><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="d2ce" class="ot nm it op b gy ou ov l ow ox"># Write your MySQL query statement below<br/>SELECT score, DENSE_RANK() OVER(ORDER BY Score DESC) AS `Rank`<br/>FROM Scores</span></pre><p id="aa2e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有两点需要注意:</p><ol class=""><li id="cc34" class="od oe it lk b ll lm lo lp lr po lv pp lz pq md pr ol om on bi translated"><strong class="lk jd"> DESC </strong>。如果问题要求按得分降序排列，记得用DESC。</li><li id="19e5" class="od oe it lk b ll ps lo pt lr pu lv pv lz pw md pr ol om on bi translated"><strong class="lk jd"> `Rank` </strong>。Rank是SQL中的保留关键字，您应该在它的前后包含一对撇号，例如<strong class="lk jd"> `Rank` </strong>。</li></ol></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="480b" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">#问题2:数苹果和橘子</h1><ul class=""><li id="ca5f" class="od oe it lk b ll of lo og lr oh lv oi lz oj md ok ol om on bi translated"><a class="ae lh" href="https://leetcode.com/problems/count-apples-and-oranges/" rel="noopener ugc nofollow" target="_blank">https://leetcode.com/problems/count-apples-and-oranges/</a></li></ul><p id="0924" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">表:<code class="fe oy oz pa op b">Boxes</code></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="47ce" class="ot nm it op b gy ou ov l ow ox">+--------------+------+<br/>| Column Name  | Type |<br/>+--------------+------+<br/>| box_id       | int  |<br/>| chest_id     | int  |<br/>| apple_count  | int  |<br/>| orange_count | int  |<br/>+--------------+------+<br/>box_id is the primary key for this table.<br/>chest_id is a foreign key of the chests table.<br/>This table contains information about the boxes and the number of oranges and apples they contain. Each box may contain a chest, which also can contain oranges and apples.</span></pre><p id="70f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">表:<code class="fe oy oz pa op b">Chests</code></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="6ad9" class="ot nm it op b gy ou ov l ow ox">+--------------+------+<br/>| Column Name  | Type |<br/>+--------------+------+<br/>| chest_id     | int  |<br/>| apple_count  | int  |<br/>| orange_count | int  |<br/>+--------------+------+<br/>chest_id is the primary key for this table.<br/>This table contains information about the chests we have, and the corresponding number if oranges and apples they contain.</span></pre><p id="1438" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">编写一个SQL查询来计算所有盒子中苹果和橘子的数量。如果一个盒子里有一个箱子，你还应该包括里面苹果和橘子的数量。</p><p id="9778" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">返回结果表中</em> <strong class="lk jd"> <em class="mh">任意顺序</em> </strong> <em class="mh">。</em></p><p id="1f81" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">查询结果格式如下:</em></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="f631" class="ot nm it op b gy ou ov l ow ox">Boxes table:<br/>+--------+----------+-------------+--------------+<br/>| box_id | chest_id | apple_count | orange_count |<br/>+--------+----------+-------------+--------------+<br/>| 2      | null     | 6           | 15           |<br/>| 18     | 14       | 4           | 15           |<br/>| 19     | 3        | 8           | 4            |<br/>| 12     | 2        | 19          | 20           |<br/>| 20     | 6        | 12          | 9            |<br/>| 8      | 6        | 9           | 9            |<br/>| 3      | 14       | 16          | 7            |<br/>+--------+----------+-------------+--------------+<br/><br/>Chests table:<br/>+----------+-------------+--------------+<br/>| chest_id | apple_count | orange_count |<br/>+----------+-------------+--------------+<br/>| 6        | 5           | 6            |<br/>| 14       | 20          | 10           |<br/>| 2        | 8           | 8            |<br/>| 3        | 19          | 4            |<br/>| 16       | 19          | 19           |<br/>+----------+-------------+--------------+<br/><br/>Result table:<br/>+-------------+--------------+<br/>| apple_count | orange_count |<br/>+-------------+--------------+<br/>| 151         | 123          |<br/>+-------------+--------------+</span></pre><h2 id="d446" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">穿过我的思维</h2><p id="54a8" class="pw-post-body-paragraph li lj it lk b ll of kd ln lo og kg lq lr pl lt lu lv pm lx ly lz pn mb mc md im bi translated">这是一个很好的SQL问题，因为它测试了候选人的分析技巧和分解问题的能力。让大多数候选人感到困惑的棘手部分是存在两个表，您应该将这两个表结合起来以获得有效值。</p><p id="f2bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，box_id = 18有来自箱子表的附加苹果和桔子计数，但是box_id = 2没有附加计数。</p><blockquote class="px"><p id="c98e" class="py pz it bd qa qb qc qd qe qf qg md dk translated">这两种情况下如何计算计数？</p></blockquote><p id="6bce" class="pw-post-body-paragraph li lj it lk b ll qh kd ln lo qi kg lq lr qj lt lu lv qk lx ly lz ql mb mc md im bi translated">答案是IFNULL()命令。我们指定如果箱子表中没有值该怎么办，如果有值该怎么办。如果没有IFNULL()语句，我们就会遇到错误。</p><h2 id="fb1e" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">解决办法</h2><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="1256" class="ot nm it op b gy ou ov l ow ox"># Write your MySQL query statement below<br/>SELECT SUM(b.apple_count+IFNULL(c.apple_count,0)) AS apple_count, SUM(b.orange_count+IFNULL(c.orange_count,0)) AS orange_count<br/>FROM Boxes b<br/>LEFT JOIN Chests c<br/>USING(chest_id)</span></pre><p id="2332" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有两点需要注意:</p><ol class=""><li id="95e1" class="od oe it lk b ll lm lo lp lr po lv pp lz pq md pr ol om on bi translated"><strong class="lk jd">左加入</strong>。我们应该使用左连接，而不是内连接，因为我们希望在box表中保留甚至没有chest_id的记录。</li><li id="e5f5" class="od oe it lk b ll ps lo pt lr pu lv pv lz pw md pr ol om on bi translated"><strong class="lk jd"> IFNULL(c.apple_count，0) </strong>。如果apple_count中有Null，我们应该指定值。</li></ol></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="f21c" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">#问题3:项目雇员I，脸书</h1><ul class=""><li id="e51d" class="od oe it lk b ll of lo og lr oh lv oi lz oj md ok ol om on bi translated"><a class="ae lh" href="https://leetcode.com/problems/project-employees-i/" rel="noopener ugc nofollow" target="_blank">https://leetcode.com/problems/project-employees-i/</a></li></ul><p id="5d75" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">表:<code class="fe oy oz pa op b">Project</code></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="8471" class="ot nm it op b gy ou ov l ow ox">+-------------+---------+<br/>| Column Name | Type    |<br/>+-------------+---------+<br/>| project_id  | int     |<br/>| employee_id | int     |<br/>+-------------+---------+<br/>(project_id, employee_id) is the primary key of this table.<br/>employee_id is a foreign key to <!-- -->Employee<!-- --> table.</span></pre><p id="fdba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">表:<code class="fe oy oz pa op b">Employee</code></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="023f" class="ot nm it op b gy ou ov l ow ox">+------------------+---------+<br/>| Column Name      | Type    |<br/>+------------------+---------+<br/>| employee_id      | int     |<br/>| name             | varchar |<br/>| experience_years | int     |<br/>+------------------+---------+<br/>employee_id is the primary key of this table.</span></pre><p id="a5f4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">编写一个SQL查询，报告每个项目所有员工的平均</em><strong class="lk jd"><em class="mh"/></strong><em class="mh"/><strong class="lk jd"><em class="mh">工作年限，四舍五入到两位数</em> </strong> <em class="mh">。</em></p><p id="54f2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">查询结果格式如下:</em></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="ad13" class="ot nm it op b gy ou ov l ow ox">Project table:<br/>+-------------+-------------+<br/>| project_id  | employee_id |<br/>+-------------+-------------+<br/>| 1           | 1           |<br/>| 1           | 2           |<br/>| 1           | 3           |<br/>| 2           | 1           |<br/>| 2           | 4           |<br/>+-------------+-------------+</span><span id="9bc1" class="ot nm it op b gy qm ov l ow ox">Employee table:<br/>+-------------+--------+------------------+<br/>| employee_id | name   | experience_years |<br/>+-------------+--------+------------------+<br/>| 1           | Khaled | 3                |<br/>| 2           | Ali    | 2                |<br/>| 3           | John   | 1                |<br/>| 4           | Doe    | 2                |<br/>+-------------+--------+------------------+</span><span id="43ab" class="ot nm it op b gy qm ov l ow ox">Result table:<br/>+-------------+---------------+<br/>| project_id  | average_years |<br/>+-------------+---------------+<br/>| 1           | 2.00          |<br/>| 2           | 2.50          |<br/>+-------------+---------------+<br/>The average experience years for the first project is (3 + 2 + 1) / 3 = 2.00 and for the second project is (3 + 2) / 2 = 2.50</span></pre><h2 id="a7e3" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">穿过我的思维</h2><p id="d7df" class="pw-post-body-paragraph li lj it lk b ll of kd ln lo og kg lq lr pl lt lu lv pm lx ly lz pn mb mc md im bi translated">脸书包括这个问题。在写任何查询之前，我总是问自己:</p><blockquote class="px"><p id="6a12" class="py pz it bd qa qb qc qd qe qf qg md dk translated">“你真的明白这个问题问的是什么吗？”</p></blockquote><p id="4ab2" class="pw-post-body-paragraph li lj it lk b ll qh kd ln lo qi kg lq lr qj lt lu lv qk lx ly lz ql mb mc md im bi translated">上面写着每个项目的平均经验年数。有两条关键信息。首先，平均值被定义为经验年数的总和除以员工人数。第二，结果应该按项目分组。</p><p id="823f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">剩下的就不言自明了。</p><h2 id="07e4" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">解决办法</h2><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="ed25" class="ot nm it op b gy ou ov l ow ox"># Write your MySQL query statement below<br/>SELECT project_id, ROUND(SUM(experience_years)/COUNT(employee_id),2) AS average_years<br/>FROM Project<br/>JOIN Employee<br/>USING(employee_id)<br/>GROUP BY project_id</span></pre><p id="bfaf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个警告，记住将结果四舍五入到2位数，如果问题没有说明什么，就要求澄清。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="d920" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated"><strong class="ak">#问题4:两个人之间的通话次数，亚马逊</strong></h1><ul class=""><li id="aa19" class="od oe it lk b ll of lo og lr oh lv oi lz oj md ok ol om on bi translated"><a class="ae lh" href="https://leetcode.com/problems/number-of-calls-between-two-persons/" rel="noopener ugc nofollow" target="_blank">https://leet code . com/problems/number-of-calls-between-two-person/</a></li></ul><p id="ffab" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">表:<code class="fe oy oz pa op b">Calls</code></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="6bd0" class="ot nm it op b gy ou ov l ow ox">+-------------+---------+<br/>| Column Name | Type    |<br/>+-------------+---------+<br/>| from_id     | int     |<br/>| to_id       | int     |<br/>| duration    | int     |<br/>+-------------+---------+<br/>This table does not have a primary key, it may contain duplicates.<br/>This table contains the duration of a phone call between from_id and to_id.<br/>from_id != to_id</span></pre><p id="9fa2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">编写一个SQL查询来报告每对不同的人</em> <code class="fe oy oz pa op b"><em class="mh">(person1, person2)</em></code> <em class="mh">之间的通话次数和总通话时长，其中</em> <code class="fe oy oz pa op b"><em class="mh">person1 &lt; person2</em></code> <em class="mh">。</em></p><p id="027c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">以任意顺序返回结果表。</em></p><p id="c811" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">查询结果格式如下:</em></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="9954" class="ot nm it op b gy ou ov l ow ox">Calls table:<br/>+---------+-------+----------+<br/>| from_id | to_id | duration |<br/>+---------+-------+----------+<br/>| 1       | 2     | 59       |<br/>| 2       | 1     | 11       |<br/>| 1       | 3     | 20       |<br/>| 3       | 4     | 100      |<br/>| 3       | 4     | 200      |<br/>| 3       | 4     | 200      |<br/>| 4       | 3     | 499      |<br/>+---------+-------+----------+</span><span id="20c7" class="ot nm it op b gy qm ov l ow ox">Result table:<br/>+---------+---------+------------+----------------+<br/>| person1 | person2 | call_count | total_duration |<br/>+---------+---------+------------+----------------+<br/>| 1       | 2       | 2          | 70             |<br/>| 1       | 3       | 1          | 20             |<br/>| 3       | 4       | 4          | 999            |<br/>+---------+---------+------------+----------------+</span></pre><h2 id="5a86" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">穿过我的思维</h2><p id="4e4c" class="pw-post-body-paragraph li lj it lk b ll of kd ln lo og kg lq lr pl lt lu lv pm lx ly lz pn mb mc md im bi translated">亚马逊问这个问题。分析问题后，我们发现一对不同的人可能是<strong class="lk jd">人1 →人2或人2 →人1。我们必须把它们加在一起，得到总持续时间。</strong></p><ul class=""><li id="f6ff" class="od oe it lk b ll lm lo lp lr po lv pp lz pq md ok ol om on bi translated">我们如何做到这一点？</li><li id="0e56" class="od oe it lk b ll ps lo pt lr pu lv pv lz pw md ok ol om on bi translated">从from_id和to_id中选取值时的用例。</li></ul><p id="1a58" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于问题有一个额外条件<strong class="lk jd"> person1 &lt; person2 </strong>，我们可以使用CASE WHEN语句从from_id和to_id中选择较小(较大)的值。具体来说，我们选择较小的值作为人员1，较大的值作为人员2。</p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="51cf" class="ot nm it op b gy ou ov l ow ox">SELECT CASE WHEN from_id&lt; to_id THEN from_id ELSE to_id END AS person1</span></pre><p id="a1e3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，我们按照相同的过程为person2选择较大的值，并计算数量/持续时间。</p><p id="398a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">参见下面的代码。</p><h2 id="ee06" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">解决办法</h2><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="1358" class="ot nm it op b gy ou ov l ow ox"># Write your MySQL query statement below<br/>SELECT CASE WHEN from_id&lt; to_id THEN from_id ELSE to_id END AS person1,<br/>CASE WHEN from_id &lt;to_id THEN to_id ELSE from_id END AS person2,<br/>COUNT(*) AS call_count,</span><span id="d45a" class="ot nm it op b gy qm ov l ow ox">SUM(duration) AS total_duration</span><span id="d4d5" class="ot nm it op b gy qm ov l ow ox">FROM Calls <br/>GROUP BY person1, person2</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="cf96" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">问题5:销售分析II，亚马逊</h1><ul class=""><li id="abed" class="od oe it lk b ll of lo og lr oh lv oi lz oj md ok ol om on bi translated"><a class="ae lh" href="https://leetcode.com/problems/sales-analysis-ii/" rel="noopener ugc nofollow" target="_blank">https://leetcode.com/problems/sales-analysis-ii/</a></li></ul><p id="723a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">表:<code class="fe oy oz pa op b">Product</code></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="5978" class="ot nm it op b gy ou ov l ow ox">+--------------+---------+<br/>| Column Name  | Type    |<br/>+--------------+---------+<br/>| product_id   | int     |<br/>| product_name | varchar |<br/>| unit_price   | int     |<br/>+--------------+---------+<br/>product_id is the primary key of this table.</span></pre><p id="3605" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">表:<code class="fe oy oz pa op b">Sales</code></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="24e5" class="ot nm it op b gy ou ov l ow ox">+-------------+---------+<br/>| Column Name | Type    |<br/>+-------------+---------+<br/>| seller_id   | int     |<br/>| product_id  | int     |<br/>| buyer_id    | int     |<br/>| sale_date   | date    |<br/>| quantity    | int     |<br/>| price       | int     |<br/>+------ ------+---------+<br/>This table has no primary key, it can have repeated rows.<br/>product_id is a foreign key to Product table.</span></pre><p id="da2f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">编写一个SQL查询，报告</em> <strong class="lk jd"> <em class="mh">购买者</em> </strong> <em class="mh">购买了S8，但没有购买iPhone和G4。请注意，S8、iPhone和G4是出现在</em> <code class="fe oy oz pa op b"><em class="mh">Product</em></code> <em class="mh">表中的产品。</em></p><p id="6169" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh">查询结果格式如下:</em></p><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="b86e" class="ot nm it op b gy ou ov l ow ox">Product table:<br/>+------------+--------------+------------+<br/>| product_id | product_name | unit_price |<br/>+------------+--------------+------------+<br/>| 1          | S8           | 1000       |<br/>| 2          | G4           | 800        |<br/>| 3          | iPhone       | 1400       |<br/>+------------+--------------+------------+</span><span id="3d34" class="ot nm it op b gy qm ov l ow ox">Sales <!-- -->table:<br/>+-----------+------------+----------+------------+----------+-------<br/>| seller_id | product_id | buyer_id | sale_date  | quantity | price <br/>+-----------+------------+----------+------------+----------+-------<br/>| 1         | 1          | 1        | 2019-01-21 | 2        | 2000  |<br/>| 1         | 2          | 2        | 2019-02-17 | 1        | 800   |<br/>| 2         | 1          | 3        | 2019-06-02 | 1        | 800   |<br/>| 3         | 3          | 3        | 2019-05-13 | 2        | 2800  |<br/>+-----------+------------+----------+------------+----------+-------Result table:<br/>+-------------+<br/>| buyer_id    |<br/>+-------------+<br/>| 1           |<br/>+-------------+<br/>The buyer with id 1 bought an S8 but didn't buy an iPhone. The buyer with id 3 bought both.</span></pre><h2 id="9305" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated">穿过我的思维</h2><p id="f0df" class="pw-post-body-paragraph li lj it lk b ll of kd ln lo og kg lq lr pl lt lu lv pm lx ly lz pn mb mc md im bi translated">亚马逊问这个问题。要选择购买了S8但没有购买iPhone (G4)的用户，我们可以使用<strong class="lk jd"> product_name = 'S8' </strong>和<strong class="lk jd"> product_name！= 'iPhone' </strong>如果是Python问题，则过滤出案例。不幸的是，它在SQL中变得更加棘手，我们不能使用！=符号。</p><blockquote class="px"><p id="f489" class="py pz it bd qa qb qc qd qe qf qg md dk translated">那么，如何才能筛选出病例呢？</p><p id="a713" class="py pz it bd qa qb qc qd qe qf qg md dk translated"><strong class="ak"> SUM(以防万一)化险为夷！</strong></p></blockquote><p id="3e66" class="pw-post-body-paragraph li lj it lk b ll qh kd ln lo qi kg lq lr qj lt lu lv qk lx ly lz ql mb mc md im bi translated">回想一下我们可以用CASE WHEN语句来赋值条件。此外，我们可以将它与SUM()子句结合起来，计算每种情况的总值，将其相加，并选择满足条件的案例。</p><h2 id="5552" class="ot nm it bd nn pb pc dn nr pd pe dp nv lr pf pg nx lv ph pi nz lz pj pk ob iz bi translated"><strong class="ak">解决方案</strong></h2><pre class="ks kt ku kv gt oo op oq or aw os bi"><span id="d176" class="ot nm it op b gy ou ov l ow ox"># Write your MySQL query statement below</span><span id="e688" class="ot nm it op b gy qm ov l ow ox">SELECT DISTINCT buyer_id<br/>FROM Sales <br/>INNER JOIN Product <br/>USING(product_id)<br/>GROUP BY buyer_id<br/>HAVING SUM(CASE WHEN product_name = ‘S8’ THEN 1 ELSE 0 END) &gt; 0<br/>AND SUM(CASE WHEN product_name = ‘iPhone’ THEN 1 ELSE 0 END) = 0 <br/>AND SUM(CASE WHEN product_name = ‘G4’ THEN 1 ELSE 0 END) = 0</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="a0fb" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">外卖食品</h1><ul class=""><li id="6237" class="od oe it lk b ll of lo og lr oh lv oi lz oj md ok ol om on bi translated">在提出解决方案之前，充分理解问题。</li><li id="8db1" class="od oe it lk b ll ps lo pt lr pu lv pv lz pw md ok ol om on bi translated">如果缺少关键信息，询问澄清问题。</li><li id="4fd0" class="od oe it lk b ll ps lo pt lr pu lv pv lz pw md ok ol om on bi translated">在下一次数据科学面试之前，练习这些高级主题。</li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="e9a0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="mh"> Medium最近进化出了自己的</em> <a class="ae lh" href="https://blog.medium.com/evolving-the-partner-program-2613708f9f3c" rel="noopener"> <em class="mh">作家伙伴计划</em> </a> <em class="mh">，支持像我这样的普通作家。如果你还不是订户，通过下面的链接注册，我会收到一部分会员费。</em></p><div class="ml mm gp gr mn mo"><a href="https://leihua-ye.medium.com/membership" rel="noopener follow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">阅读叶雷华博士研究员(以及其他成千上万的媒体作家)的每一个故事</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">leihua-ye.medium.com</p></div></div><div class="mx l"><div class="qn l mz na nb mx nc lb mo"/></div></div></a></div></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="5b70" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">我的数据科学面试序列</h1><div class="ml mm gp gr mn mo"><a rel="noopener follow" target="_blank" href="/online-controlled-experiment-8-common-pitfalls-and-solutions-ea4488e5a82e"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">运行A/B测试的8个常见陷阱</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">如何不让你的在线控制实验失败</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="qo l mz na nb mx nc lb mo"/></div></div></a></div><div class="ml mm gp gr mn mo"><a rel="noopener follow" target="_blank" href="/5-python-coding-questions-asked-at-faang-59e6cf5ba2a0"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">FAANG在2021年提出这5个Python问题</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">数据科学家和数据工程师的必读！</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="qp l mz na nb mx nc lb mo"/></div></div></a></div></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="8d07" class="nl nm it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">喜欢读这本书吗？</h1><blockquote class="me mf mg"><p id="99b8" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">请在<a class="ae lh" href="https://www.linkedin.com/in/leihuaye/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://www.youtube.com/channel/UCBBu2nqs6iZPyNSgMjXUGPg" rel="noopener ugc nofollow" target="_blank"> Youtube </a>上找到我。</p><p id="83cd" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">还有，看看我其他关于人工智能和机器学习的帖子。</p></blockquote></div></div>    
</body>
</html>