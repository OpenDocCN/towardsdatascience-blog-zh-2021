<html>
<head>
<title>Accessing Data in a MultiIndex DataFrame in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在熊猫的多索引数据框架中访问数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/accessing-data-in-a-multiindex-dataframe-in-pandas-569e8767201d?source=collection_archive---------0-----------------------#2021-04-26">https://towardsdatascience.com/accessing-data-in-a-multiindex-dataframe-in-pandas-569e8767201d?source=collection_archive---------0-----------------------#2021-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0482" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫帮助你开始数据分析的提示和技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d056e0c51a0777c7a3304d46a0368c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QxRMA9wrAgW2o6jx9-60iA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安娜斯塔西娅·切平斯卡在<a class="ae ky" href="https://unsplash.com/s/photos/table-row?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f33b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个<strong class="lb iu"> MultiIndex </strong>(也称为层次索引)数据帧允许您将多个列作为一个行标识符，将多个行作为一个标题标识符。使用<strong class="lb iu"> MultiIndex </strong>，您可以进行一些复杂的数据分析，尤其是处理更高维度的数据。访问数据是处理多索引数据框架的第一步。</p><p id="71b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将了解如何访问多索引数据框架中的数据。这篇文章的结构如下:</p><ol class=""><li id="ee7c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">通过一级索引选择数据</li><li id="760e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">通过多级索引选择数据</li><li id="1cbb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用切片选择数据区域</li><li id="be9c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用<code class="fe mj mk ml mm b">slice(None)</code>选择所有内容</li><li id="5a52" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用横截面<code class="fe mj mk ml mm b">xs()</code></li><li id="5639" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用<code class="fe mj mk ml mm b">IndexSlice</code></li></ol><p id="4239" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了进行演示，我们创建了一个虚拟数据集，并将使用<em class="mn">前2列作为行标识符</em>和<em class="mn">前2行作为标题标识符</em>来加载它。</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="83c5" class="ms mt it mm b gy mu mv l mw mx">df = pd.read_csv('dataset.csv',<br/>    <strong class="mm iu">index_col=[0,1],</strong><br/>    <strong class="mm iu">header=[0,1]</strong><br/>).sort_index()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/cb5fbfaf0d9c2fc72c02988dd396e41c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gRZf57FzG5GQtaPLkpO-hA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">昼夜天气数据(作者制作)</p></figure><p id="c97a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/031-pandas-multiIndex/multiindex-selection.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>获取源代码。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><h1 id="bbaa" class="ng mt it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">1.通过一级索引选择数据</h1><p id="ee02" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">当选择数据帧上的数据时，Pandas <code class="fe mj mk ml mm b">loc</code>是最受欢迎的数据之一。在上一篇文章中，我们已经介绍了<a class="ae ky" rel="noopener" target="_blank" href="/how-to-use-loc-and-iloc-for-selecting-data-in-pandas-bd09cb4c3d79"/><code class="fe mj mk ml mm b"><a class="ae ky" rel="noopener" target="_blank" href="/how-to-use-loc-and-iloc-for-selecting-data-in-pandas-bd09cb4c3d79">loc</a></code><a class="ae ky" rel="noopener" target="_blank" href="/how-to-use-loc-and-iloc-for-selecting-data-in-pandas-bd09cb4c3d79">和</a> <code class="fe mj mk ml mm b"><a class="ae ky" rel="noopener" target="_blank" href="/how-to-use-loc-and-iloc-for-selecting-data-in-pandas-bd09cb4c3d79">iloc</a></code> <a class="ae ky" rel="noopener" target="_blank" href="/how-to-use-loc-and-iloc-for-selecting-data-in-pandas-bd09cb4c3d79">用于在通用(单索引)数据框架</a>中选择数据。访问<strong class="lb iu">多索引</strong>数据帧中的数据的方式与访问单索引数据帧的方式相似。</p><p id="a6f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以将第一级标签传递给<code class="fe mj mk ml mm b">loc</code>来选择数据</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="6d20" class="ms mt it mm b gy mu mv l mw mx"># Retrieve London's Day weather<br/>df.loc['London', 'Day']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/2f95a8922e9b4beb8194f6c1a5fef601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qja05uZiB0555R8LyA0t5g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a5b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用<code class="fe mj mk ml mm b">:</code>返回所有数据。</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="190a" class="ms mt it mm b gy mu mv l mw mx"># To get all rows - all Day weather<br/>df.loc[:, 'Day']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/3f0275e9af8284e463282ff0ab6e444b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hd7a2pE5B1PGF86e4ER2ZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="121a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并获取所有列</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="cf60" class="ms mt it mm b gy mu mv l mw mx"># To get all columns<br/>df.loc['London' , :]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/cbcd712d2b365c1a77b2ce70bed4c371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ks0N9Pmkq-YYUH7B2qRS3A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7a44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上工作如我们所料。然而，你可能会惊讶地发现<code class="fe mj mk ml mm b">df.loc['London', '2019-07-02']</code>也很管用</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="7892" class="ms mt it mm b gy mu mv l mw mx"># This also works<br/>&gt;&gt;&gt; <strong class="mm iu">df.loc['London' , '2019-07-02']</strong></span><span id="8d3a" class="ms mt it mm b gy of mv l mw mx">Day    Weather                Shower<br/>       Wind                SW 16 mph<br/>       Max Temperature            29<br/>Night  Weather            Heavy rain<br/>       Wind                SW 16 mph<br/>       Max Temperature            17<br/>Name: (London, 2019-07-02), dtype: object</span></pre><p id="63f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个结果通常会导致歧义。事实上，上述所有语句都是从多索引数据帧中检索数据的简写符号。对于多索引数据帧，建议使用元组来避免歧义。</p><p id="2583" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是使用元组的等效语句</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="b049" class="ms mt it mm b gy mu mv l mw mx"># Equivalent to <strong class="mm iu">df.loc['London', 'Day']</strong><br/>df.loc[<strong class="mm iu">('London', )</strong> , <strong class="mm iu">('Day', )</strong>]</span><span id="75d7" class="ms mt it mm b gy of mv l mw mx"># Equivalent to <strong class="mm iu">df.loc[:, 'Day']</strong><br/>df.loc[:, <strong class="mm iu">('Day',)</strong>]</span><span id="d834" class="ms mt it mm b gy of mv l mw mx"># Equivalent to <strong class="mm iu">df.loc['London' , :]</strong><br/>df.loc[('London', ) , :]</span><span id="578d" class="ms mt it mm b gy of mv l mw mx"># Equivalent to <strong class="mm iu">df.loc['London' , '2019-07-02']</strong><br/>df.loc[<strong class="mm iu">('London' , '2019-07-02')</strong>]</span></pre><h1 id="72b8" class="ng mt it bd nh ni og nk nl nm oh no np jz oi ka nr kc oj kd nt kf ok kg nv nw bi translated">2.通过多级索引选择数据</h1><p id="4379" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">如果你想阅读2019-07-01的<strong class="lb iu">伦敦</strong>日<strong class="lb iu">天气，你可以简单地做:</strong></p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="259f" class="ms mt it mm b gy mu mv l mw mx">&gt;&gt;&gt; df.<strong class="mm iu">loc['London', 'Day']</strong>.<strong class="mm iu">loc['2019-07-01']</strong></span><span id="ca73" class="ms mt it mm b gy of mv l mw mx">Weather               Shower<br/>Wind               SW 16 mph<br/>Max Temperature           28<br/>Name: 2019-07-01, dtype: object</span></pre><p id="9d52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，<code class="fe mj mk ml mm b">loc['London', 'Day']</code>返回一个数据帧，并调用<code class="fe mj mk ml mm b">loc['2019-07-01']</code>再次提取数据。这当然有效，但是有一种更有效的方法使用元组。</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="4385" class="ms mt it mm b gy mu mv l mw mx">&gt;&gt;&gt; df.loc[<strong class="mm iu">('London', '2019-07-01')</strong>, '<strong class="mm iu">Day</strong>']</span><span id="d15e" class="ms mt it mm b gy of mv l mw mx">Weather               Shower<br/>Wind               SW 16 mph<br/>Max Temperature           28<br/>Name: (London, 2019-07-01), dtype: object</span></pre><p id="c2e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">多索引键采用元组的形式。在这种情况下，<code class="fe mj mk ml mm b">('London', '2019-07-01')</code>选择行标签，<code class="fe mj mk ml mm b">'Day'</code>选择列。</p><p id="2eff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以传递标签列表来选择多行或多列:</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="0863" class="ms mt it mm b gy mu mv l mw mx"># Select multiple rows<br/>df.loc[ <br/>    ('London' , <strong class="mm iu">['2019-07-01','2019-07-02']</strong> ) ,<br/>    'Day'<br/>]</span><span id="93f9" class="ms mt it mm b gy of mv l mw mx"># Select multiple columns<br/>df.loc[ <br/>    'London' ,<br/>    ('Day', <strong class="mm iu">['Weather', 'Wind']</strong>)<br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/3c72cf8d80f3c884d20c3b44817c783b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8-qe5jnhZfbrQKByztzSwA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="b3ae" class="ng mt it bd nh ni og nk nl nm oh no np jz oi ka nr kc oj kd nt kf ok kg nv nw bi translated">3.通过切片选择数据范围</h1><p id="4322" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">Slice(写为<code class="fe mj mk ml mm b">start:stop:step</code>)是一种强大的技术，允许选择一定范围的数据。当我们想要选择两个项目之间的所有内容时，这非常有用。</p><p id="b173" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对多索引数据帧中的一级索引进行切片与对单索引数据帧进行切片的方式相似。举个例子，</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="fed9" class="ms mt it mm b gy mu mv l mw mx">df.loc[<br/>    <strong class="mm iu">'Cambridge':'Oxford'</strong>,<br/>    'Day'<br/>]</span></pre><p id="6e61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当分割多层索引时，我们将会得到一个语法错误，如下所示:</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="7f6c" class="ms mt it mm b gy mu mv l mw mx"># We are getting a SyntaxError<br/>df.loc[<br/>    ('London', <strong class="mm iu">'2019-07-01': '2019-07-03'</strong>),<br/>    'Day'<br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/bdb8a1260b2af14984b095fe0f7fed85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CUchIy_ox_glffnesmpRA.png"/></div></div></figure><p id="2f45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对多级索引进行切片的正确方法是使用元组:</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="cdcb" class="ms mt it mm b gy mu mv l mw mx">df.loc[<br/>    <strong class="mm iu">('London','2019-07-01'):('London','2019-07-03')</strong>,<br/>    'Day'<br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/f14e891701570bc6f253ca0107195ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2fRrp806hbXbqRTBMhG2Kw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bc01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">较低级别的索引不必相同。例如，我们可以选择从<code class="fe mj mk ml mm b">('Cambridge', '2019-07-01')</code>到<code class="fe mj mk ml mm b">('London', '2019-07-02')</code>的数据范围</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="44cc" class="ms mt it mm b gy mu mv l mw mx">df.loc[<br/>    <strong class="mm iu">('Cambridge', '2019-07-01'):('London','2019-07-02')</strong>,<br/>    'Day'<br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/f453babe42bcae0dd43c9ed57173acfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JeudWBwtUU6sOYNf8gFzLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="e70a" class="ng mt it bd nh ni og nk nl nm oh no np jz oi ka nr kc oj kd nt kf ok kg nv nw bi translated">4.使用<code class="fe mj mk ml mm b">slice(None)</code>选择所有内容</h1><p id="4580" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">当通过一级索引检索数据时，我们可以使用<code class="fe mj mk ml mm b">:</code>来选择所有内容。然而，当使用多级索引时，我们会遇到语法错误。</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="2503" class="ms mt it mm b gy mu mv l mw mx"># Getting <strong class="mm iu">SyntaxError</strong><br/>df.loc[ <br/>    <strong class="mm iu">('London', :)</strong>,<br/>    'Day'<br/>]</span><span id="6caf" class="ms mt it mm b gy of mv l mw mx"># Getting <strong class="mm iu">SyntaxError</strong><br/>df.loc[ <br/>    <strong class="mm iu">(: , '2019-07-04')</strong>,<br/>    'Day'<br/>]</span></pre><p id="da8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择特定索引级别上所有内容的正确方法是使用<code class="fe mj mk ml mm b">slice(None)</code></p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="172f" class="ms mt it mm b gy mu mv l mw mx">df.loc[ <br/>    ('London', <strong class="mm iu">slice(None)</strong>),<br/>    'Day'<br/>]</span><span id="221a" class="ms mt it mm b gy of mv l mw mx">df.loc[<br/>    (<strong class="mm iu">slice(None)</strong> , '2019-07-04'), <br/>    'Day'<br/>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/4905dfe1846badabb15beba592b0c9a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CDFJ9HlXDOKabMi4uZIMtw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="2d40" class="ng mt it bd nh ni og nk nl nm oh no np jz oi ka nr kc oj kd nt kf ok kg nv nw bi translated">5.使用横截面<code class="fe mj mk ml mm b">xs()</code></h1><p id="5606" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">DataFrame的<code class="fe mj mk ml mm b">xs()</code>方法可以接受一个<code class="fe mj mk ml mm b">level</code>参数，使得在多索引的特定级别选择数据更加容易。</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="570b" class="ms mt it mm b gy mu mv l mw mx">df.xs('2019-07-04', <strong class="mm iu">level='Date'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/6247a3dd32a7832e22ed16a4ee5c9367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nfsfEnZE2gs1NL5ta6QAxg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.xs的结果(' 2019–07–04 '，level='Date ')(图片由作者提供)</p></figure><p id="5389" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mj mk ml mm b">xs()</code>也允许使用多个键进行选择</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="1061" class="ms mt it mm b gy mu mv l mw mx">df.xs(('London', '2019-07-04'), <strong class="mm iu">level=['City','Date']</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/4148cfe52092f034c983473dba63d70f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u8vRFwP3cT9WVsvwQM6qjA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.xs的结果(('伦敦'，' 2019–07–04 ')，level=['城市'，'日期'])(图片由作者提供)</p></figure><p id="f914" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以通过提供<code class="fe mj mk ml mm b">axis</code>参数来选择带有<code class="fe mj mk ml mm b">xs()</code>的列。</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="2cbe" class="ms mt it mm b gy mu mv l mw mx">df.xs('Wind', level=1, <strong class="mm iu">axis=1</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d0b9843403ddf0e21638158e4992f30d.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*YhPMVgmsMepIHOek02XMaA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.xs的结果('风'，级别=1，<strong class="bd ot">轴=1 </strong>)</p></figure><p id="6c68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，所选的列标签<code class="fe mj mk ml mm b">'Wind'</code>不包括在结果中。为了保持被选中的级别，我们可以通过<code class="fe mj mk ml mm b">drop_level=False</code></p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="8f8f" class="ms mt it mm b gy mu mv l mw mx">df.xs('Wind', level=1, axis=1, <strong class="mm iu">drop_level=False</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/8d0ad8da2949fcb925a2be3009729976.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*vKn9DTbg9oRlSjMmHWknNw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.xs的结果(' Wind '，level=1，axis=1，<strong class="bd ot"> drop_level=False </strong>)</p></figure><h1 id="a4dd" class="ng mt it bd nh ni og nk nl nm oh no np jz oi ka nr kc oj kd nt kf ok kg nv nw bi translated">6.使用<code class="fe mj mk ml mm b">IndexSlice</code></h1><p id="82b0" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">您可以使用Pandas <code class="fe mj mk ml mm b">IndexSlice</code>来简化更自然的语法。</p><p id="3cca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，用<code class="fe mj mk ml mm b">:</code>代替<code class="fe mj mk ml mm b">slice(None)</code></p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="fcd0" class="ms mt it mm b gy mu mv l mw mx">from pandas <strong class="mm iu">import IndexSlice as idx</strong></span><span id="51bd" class="ms mt it mm b gy of mv l mw mx">df.loc[ <br/>    <strong class="mm iu">idx[: , '2019-07-04'], </strong><br/>    'Day'<br/>]</span><span id="30e9" class="ms mt it mm b gy of mv l mw mx"># Instead of <strong class="mm iu">slice(None)</strong><br/># df.loc[ <br/>#    <strong class="mm iu">(slice(None) , '2019-07-04')</strong>, <br/>#    'Day'<br/># ]</span></pre><p id="f998" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对行和列都使用<code class="fe mj mk ml mm b">IndexSlice</code></p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="ea48" class="ms mt it mm b gy mu mv l mw mx">rows = idx[: , '2019-07-01']<br/>cols = idx['Day' , ['Max Temperature','Weather']]</span><span id="8cf5" class="ms mt it mm b gy of mv l mw mx">df.loc[rows, cols]</span></pre><p id="7b93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe mj mk ml mm b">xs()</code>和<code class="fe mj mk ml mm b">IndexSlice</code>选择数据范围</p><pre class="kj kk kl km gt mo mm mp mq aw mr bi"><span id="839f" class="ms mt it mm b gy mu mv l mw mx">rows= (<br/>    <strong class="mm iu">idx['2019-07-02':'2019-07-04']</strong>, <br/>    'London'<br/>)</span><span id="b26a" class="ms mt it mm b gy of mv l mw mx">df.xs(<br/>    rows , <br/>    level = ['Date','City']<br/>)</span></pre><h1 id="608b" class="ng mt it bd nh ni og nk nl nm oh no np jz oi ka nr kc oj kd nt kf ok kg nv nw bi translated">结论</h1><p id="5307" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">使用<strong class="lb iu"> MultiIndex </strong>，您可以进行一些复杂的数据分析，尤其是处理更高维度的数据。使用<strong class="lb iu">多索引</strong>数据框架时，访问数据是第一步。我希望这篇教程对你访问多索引数据框架有用。我建议你查看一下<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html" rel="noopener ugc nofollow" target="_blank">文档</a>来了解你可以做的其他事情。</p><p id="f45e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。请查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/031-pandas-multiIndex/multiindex-selection.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>获取源代码，如果您对机器学习的实用方面感兴趣，请继续关注。</p><h2 id="8574" class="ms mt it bd nh ov ow dn nl ox oy dp np li oz pa nr lm pb pc nt lq pd pe nv pf bi translated">你可能会对我的其他一些熊猫文章感兴趣:</h2><ul class=""><li id="7f9e" class="lv lw it lb b lc nx lf ny li pg lm ph lq pi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/all-pandas-cut-you-should-know-for-transforming-numerical-data-into-categorical-data-1370cf7f4c4f"> Pandas cut()函数，用于将数值数据转换为分类数据</a></li><li id="f502" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac" rel="noopener">使用熊猫方法链接提高代码可读性</a></li><li id="bbdb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320">如何对熊猫数据帧进行自定义排序</a></li><li id="e597" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/all-the-pandas-shift-you-should-know-for-data-analysis-791c1692b5e">为了数据分析你应该知道的所有熊猫移位()</a></li><li id="0bc7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/when-to-use-pandas-transform-function-df8861aa0dcf">何时使用Pandas transform()函数</a></li><li id="dbcb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/pandas-concat-tricks-you-should-know-to-speed-up-your-data-analysis-cd3d4fdfe6dd">你应该知道的熊猫串联()招数</a></li><li id="e767" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/difference-between-apply-and-transform-in-pandas-242e5cf32705" rel="noopener">熊猫的应用()和变换()的区别</a></li><li id="c0f6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/all-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184">所有的熊猫合并()你应该知道</a></li><li id="a481" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/working-with-datetime-in-pandas-dataframe-663f7af6c587">在Pandas数据框架中处理日期时间</a></li><li id="d2b4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3" rel="noopener">熊猫阅读_csv()你应该知道的招数</a></li><li id="9cfe" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu pj mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e">用Pandas read_csv()解析日期列应该知道的4个技巧</a></li></ul><p id="24b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更多教程可以在我的<a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到</p></div></div>    
</body>
</html>