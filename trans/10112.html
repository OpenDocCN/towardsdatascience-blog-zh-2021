<html>
<head>
<title>Understanding Machine Learning Models Better with Explainable AI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用可解释的人工智能更好地理解机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-machine-learning-models-better-with-explainable-ai-bea6d28f5094?source=collection_archive---------20-----------------------#2021-09-24">https://towardsdatascience.com/understanding-machine-learning-models-better-with-explainable-ai-bea6d28f5094?source=collection_archive---------20-----------------------#2021-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6391" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用ExplainerDashboard用几行代码构建一个交互式仪表板</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/83c47df94e2bbf13cd92a2e8bd4540f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlpuFb4f1sn9wYgnrHfP5A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者(Canva设计)</p></figure><p id="d5a7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过基于网络的仪表板来解读机器学习的工作是很有趣的。想象一下，访问显示模型性能、特征重要性以及假设分析信息的交互式图表。令人兴奋的是，构建这样一个信息丰富的仪表板不需要任何web开发专业知识，但简单的几行python代码就足以生成一个令人惊叹的交互式机器学习仪表板。这可以通过使用一个名为“解释器仪表板”的库来实现。</p><p id="072c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">ExplainerDashboard是一个python包，它生成交互式仪表板，允许用户理解并解释模型如何工作以及它如何决定结果。没有这样的工具，机器学习模型就是“黑盒模型”。因此，很难解释模型做出决策背后的原因，以及哪些因素影响了模型的决策。使用Python中的这个包，我们可以在Jupyter或Colab笔记本中轻松地将仪表板部署为web应用程序。这个web应用程序提供了几个交互式图表来解释它所应用的机器学习模型的工作原理。这些模型可以基于Scikit-learn、XGBoost、CatBoost、LightGBM和其他一些模型。仪表板通过各种交互式<br/>图提供对模型性能的洞察，如用于理解特征相关性的SHAP值图、用于特征交互的<br/> SHAP交互图、用于选定特征影响的部分相关性图(PDP)以及通过决策树可视化决策路径等。还可以通过“假设”分析来评估改变特征值对模型性能的影响。此外，高级用户也可以使用一些额外的代码来定制这些仪表板。对于本教程，我们将只探索该包的功能，我将带您一步一步地用Python创建您自己的机器学习模型仪表板，只需几行代码。在教程的最后，我们将看到我们可以从这个机器学习仪表板中收集到什么样的见解。</p><h1 id="d60a" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">解释器仪表板库</h1><p id="39a5" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">这个Python包为机器学习模型构建了一个基于web应用程序或内嵌笔记本的可解释仪表板。仪表板的默认组件是不言自明的，不需要额外的定义函数。这些图表或仪表板的交互组件基于另一个名为Dash的库，该库以网络应用和图表而闻名，使用了一个名为“Plotly”的库。最后，整个仪表板实际上是一个使用flask server在本地机器上运行的web应用程序。你可以在这里找到所有官方文档。</p><p id="1812" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们从ExplainerDashboard库的pip安装开始本教程</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="bce6" class="mu ls iq mq b gy mv mw l mx my">pip install explainerdashboard</span></pre><p id="7773" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以在Colab或Kaggle笔记本中直接使用该命令。然而，如果使用在本地机器上运行的Jupyter笔记本，使用虚拟环境可能是一个更好的选择，以避免由于包依赖性而导致的任何冲突。</p><p id="55c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">方法:</p><ul class=""><li id="c52e" class="mz na iq kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated">导入库和样本数据集</li><li id="8bbb" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">从数据集创建DataFrame(本演示教程不需要数据预处理)</li><li id="4781" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">拆分数据并训练模型</li><li id="6864" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">在本地端口上部署仪表板</li></ul><h1 id="3056" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">回归示例机器学习仪表板</h1><p id="21f0" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">对于本教程，让我们使用sklearn库中的样本<a class="ae mo" href="https://scikit-learn.org/stable/datasets/toy_dataset.html" rel="noopener ugc nofollow" target="_blank">玩具数据集</a>“糖尿病”数据集来构建回归问题的机器学习仪表板。</p><h1 id="88f6" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">导入库</h1><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="8841" class="mu ls iq mq b gy mv mw l mx my">#Importing Libraries &amp; Packages</span><span id="2c45" class="mu ls iq mq b gy nn mw l mx my">import pandas as pd<br/>from sklearn.ensemble import RandomForestRegressor<br/>from sklearn.model_selection import train_test_split<br/>from explainerdashboard import RegressionExplainer, ExplainerDashboard</span></pre><p id="ca5b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们需要Pandas库用于数据框架，而ExplainerDashboard和Dash Bootstrap库用于构建仪表板。sklearn库将用于获取玩具数据集，分割它并导入RandomForestRegressor来为这个回归示例训练模型。</p><h1 id="ee78" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">导入数据集</h1><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f0c7" class="mu ls iq mq b gy mv mw l mx my">#Import the Diabetes Dataset<br/>from sklearn.datasets import load_diabetes</span><span id="e01f" class="mu ls iq mq b gy nn mw l mx my">data= load_diabetes()</span><span id="b51f" class="mu ls iq mq b gy nn mw l mx my">#print the dataset<br/>data</span></pre><h1 id="ee06" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">加载数据集</h1><p id="4886" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我们需要将数据集加载到X和y变量上，以创建熊猫数据框架。x将保存要素，y将保存目标值。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="e4ac" class="mu ls iq mq b gy mv mw l mx my">#create a DataFrame from the dataset<br/>X=pd.DataFrame(data.data,columns=data.feature_names)</span><span id="84f2" class="mu ls iq mq b gy nn mw l mx my">#Printing first five rows of the DataFrame<br/>X.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/9f581b7588b0bdedfbf7bbd914b23f65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zlZOrHnFo1aVAlCs"/></div></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f031" class="mu ls iq mq b gy mv mw l mx my">#Load target values in y<br/>y=pd.DataFrame(data.target,columns=[“target”])<br/>y.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/a9c192082670d4371b9c55fdb10176db.png" data-original-src="https://miro.medium.com/v2/resize:fit:262/0*ZVpWl1Bxv1NK8F6b"/></div></div></figure><p id="f997" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们的数据准备好了，我们可以使用RandomForestRegressor来训练模型。</p><h1 id="5513" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">分割数据集</h1><p id="21e7" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">让我们使用sklearn的train-test split函数将数据集按80–20的比例拆分。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="e473" class="mu ls iq mq b gy mv mw l mx my">#Splitting the Dataset<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1)<br/>print(X_train.shape,y_train.shape,X_test.shape,y_test.shape)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/fb39a94ec5584491f4ea66fbb6e16441.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/0*5XGGSdxGSjDb7uC6"/></div></figure><h1 id="6d8c" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">训练模型</h1><p id="4f55" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我们现在可以用随机选择的估计值的RandomForestRegressor来训练模型。您也可以尝试使用不同的值或使用XGBoost来训练模型并进行比较。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="6bb9" class="mu ls iq mq b gy mv mw l mx my">#Training the model<br/>model = RandomForestRegressor(n_estimators=50, max_depth=5)</span><span id="4a41" class="mu ls iq mq b gy nn mw l mx my">model.fit(X_train, y_train.values.ravel())</span></pre><p id="22de" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:在这一步中，我们使用推荐的命令“ravel()”将“y_train”转换为一维数组。这种对列向量y的整形将避免由RandomForestRegressor生成的DataConversionWarning。</p><h1 id="3eb4" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">使用训练模型设置仪表板实例</h1><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f75e" class="mu ls iq mq b gy mv mw l mx my">explainer = RegressionExplainer(model, X_test, y_test)</span><span id="ba15" class="mu ls iq mq b gy nn mw l mx my">#Start the Dashboard<br/>db = ExplainerDashboard(explainer,title=”Diabetes Prediction”,whatif=False)</span><span id="1afa" class="mu ls iq mq b gy nn mw l mx my">#Running the app on a local port 3050<br/>db.run(port=3050)</span></pre><p id="3bd4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该仪表板将在端口为3050的本地服务器上运行(如果您选择另一个端口号，比如8080或3000，那么您的情况可能会有所不同)</p><p id="fef4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">单击该链接将在web浏览器的单独选项卡中打开仪表板。</p><p id="7ec8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您的完全交互式机器学习仪表板已经准备好了！</p><p id="de2c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在我的<a class="ae mo" href="https://github.com/Devashree21/ExplainerDashboard" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>上找到这个笔记本的完整代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/e186473e167da32a54d41110cbc767de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_LXVyCgfGNRj2Jx49tQv_A.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按作者分类的仪表板GIF</p></figure><h2 id="53a4" class="mu ls iq bd lt ns nt dn lx nu nv dp mb le nw nx md li ny nz mf lm oa ob mh oc bi translated">仪表板中的见解</h2><p id="ee8a" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">有了这个仪表板，我们可以得到一些见解，比如-</p><ul class=""><li id="50ae" class="mz na iq kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated">Shap值表示每个单独的特征如何影响预测</li><li id="2056" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">置换重要性，它允许我们更深入地挖掘，以可视化模型性能如何随着特征的改变而恶化</li><li id="4cf3" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">在使用类似于本教程的XGBoost或RandomForestRegressor的回归模型的情况下，我们可以可视化单个决策树，而在分类器模型的情况下，我们可以获得混淆矩阵、ROC-AUC曲线等。更好地理解模型的决策。</li><li id="9d2e" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">假设分析(在启动仪表板时打开的情况下)有助于了解在我们修改特征或部分数据时模型行为的变化。它还允许我们比较不同的模型。</li></ul><p id="ce2a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，对上面的图和它们包括的参数有一些基本的理解对于理解来自这样的机器学习仪表板的洞察力也是有帮助的。对于任何寻找本教程主题的理论详细信息的人，我建议阅读克里斯托夫·莫尔纳尔的书'<a class="ae mo" href="https://christophm.github.io/interpretable-ml-book/shap.html" rel="noopener ugc nofollow" target="_blank">可解释的机器学习</a>。</p><p id="60da" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本教程到此为止。希望作为读者的你能学到一些新的有趣的东西。</p><p id="8ce8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">直到下一篇文章，快乐阅读！</p></div></div>    
</body>
</html>