<html>
<head>
<title>Reclassifying Inventory with Machine Learning – Art Lovers’ Edition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习重新分类库存——艺术爱好者版</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reclassifying-inventory-with-machine-learning-art-lovers-edition-53818c287996?source=collection_archive---------25-----------------------#2021-03-26">https://towardsdatascience.com/reclassifying-inventory-with-machine-learning-art-lovers-edition-53818c287996?source=collection_archive---------25-----------------------#2021-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ce81" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">预测大都会艺术博物馆收藏的艺术品的受欢迎程度和重要性</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5f318478b98fb051372cb99494eab105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*93WpZ4p2IFLcG-Gd"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">艾莉森·考特尼在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a98e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大都会艺术博物馆，也被称为Met，是美国最大的艺术博物馆，永久收藏超过200万件作品。永久收藏从古典绘画到广泛的现代艺术收藏都有。我仍然记得我第一次走进博物馆时的激动心情。感觉我在短短几个小时内经历了几个世纪的人类历史。我是如此的敬畏，以至于作为我在<a class="ae kv" href="https://www.thisismetis.com/" rel="noopener ugc nofollow" target="_blank"> Metis </a>数据科学训练营的一个项目，我决定做一个关于预测大都会博物馆藏品中艺术品的受欢迎程度和重要性的项目。</p><p id="caf2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">博物馆保留了一份精选作品清单，这些精选作品是从大都会博物馆的永久收藏中挑选出来的，被认为是受欢迎的和重要的。这些还不到收藏中所有艺术品的1%。我的项目的目标是创建一个分类器，它能够根据描述艺术品的特征来识别这些突出显示的项目。Met可以使用这种类型的模型来识别他们的集合中他们可能认为重新分类为重要的对象。它还可以用于对新添加到集合中的内容进行初始分析。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="85f8" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">数据和方法</h2><p id="78bb" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">对于这个问题，我使用了Met BigQuery公共数据集，其中有超过200，000件艺术品。它包含关于艺术品的信息，如标题、艺术家、部门、城市、国家、文化、分类等。</p><p id="9a73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我用来从Google Cloud BigQuery数据仓库中提取艺术品数据的SQL查询，它利用Google基础设施的处理能力实现了超快速的SQL查询。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">提取插图数据的SQL查询</p></figure><p id="e533" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了找到与突出显示的艺术品最接近的项目，我需要创建一个分类器，以高精度找到突出显示的项目，然后挑选得分最高的非突出显示的项目。希望这些是应该被强调的艺术品，但可能不知何故“从裂缝中滑落”。</p><p id="4c8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图显示了生成需要重新考虑以突出显示的候选人列表所需的步骤。第一步是创建一个分类器来预测突出显示的项目。下一步是用分类器对所有观察结果进行评分，并根据分数进行排序。最后一步是挑选得分最高的非高亮项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/54f20bc7b42882ba56fb12b519faae9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ixAGrC5BXo0CgQnJIGvk-A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成要重新考虑以突出显示的候选艺术品列表所需的步骤</p></figure><p id="a5ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个大海捞针式的问题，其中类严重不平衡，我只对列表顶端的精度感兴趣。Precision@k是最适合这个问题的度量标准，其中我挑选了k个得分最高的项目，并在这个集合上测量分类器的精度。</p><h2 id="ee35" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">特征工程</h2><p id="c65f" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">数据集包含描述艺术品尺寸的列。为了能够使用它，我必须解析它的内容。根据物体是二维还是三维，我计算并存储了面积或体积。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/db669b58419b98a7d9993052f23f334f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qnrohp4wgRk-w47t4KJE0w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">解析维度列(面积单位为厘米，体积单位为厘米)</p></figure><p id="2a1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">许多分类特征，如国家、城市、时期、部门等，都有数百个(如果不是数千个的话)唯一值，频率计数按照Zipf定律随着等级快速减少。这是一个使用数理统计制定的经验法则，指的是这样一个事实，即对于物理和社会科学中研究的许多类型的数据，等级-频率分布是一种反比关系。</p><p id="3e64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在左图中，您可以看到各部门的绝对频率，在右图中，是相同的数据，但Y轴是对数刻度。我将从这些分类变量中创建虚拟特征，因此，为了保持特征的合理数量，我只保留了每个类别中的前X个值，并将其余的标记为“其他”。保留值的数量因变量而异。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/7820052b2e78cc9123bf59b93452a292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PlOnOnN_w5fP-D2EF9xkGw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">频率计数随着等级快速减少</p></figure><h2 id="ff17" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">机器学习</h2><p id="639f" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这个项目中我最喜欢的部分来了——使用机器学习来实现我的主要目标，即创建一个分类器来找到与突出显示的艺术品最接近的项目。为了这个项目，我尝试了不同的ML模型——随机森林、袋装决策树、增强决策树和神经网络(DNN)。</p><p id="aea3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于每个模型，我选择了一个不同的阈值，该阈值将产生正好100个阳性结果，允许我使用Precision@k来比较它们，其中k是100。尽管DNN的性能比表现最好的随机森林稍低，但DNN的输出粒度更好，允许我正确地对对象进行排序。这是一个很好的例子，说明性能指标分数不是影响模型选择的唯一标准。</p><p id="d7f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面你可以在测试集上找到DNN模型的混淆矩阵和ROC曲线。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/3851c943aa849b4853dd7f0e01804724.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*E1YdauByjPg6h68jhMprLQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">DNN测试集混淆矩阵</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b35c826de02555383680ce2617ccbd64.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*4F9QLyWpgniN13QcoZyBtg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">DNN检验集ROC曲线</p></figure><p id="3a8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在整个数据集上重新训练了我的神经网络，对所有对象进行了评分，并挑选了前10个得分最高的非突出显示项目。然后我使用<a class="ae kv" href="https://metmuseum.github.io/" rel="noopener ugc nofollow" target="_blank">大都会艺术博物馆收藏API </a>来显示结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从Met Collection API中检索和显示图像</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="082a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请访问我的<a class="ae kv" href="https://github.com/SatenikS" rel="noopener ugc nofollow" target="_blank"> Github帐户</a>来查看这个和我的其他项目的代码。也可以随时通过<a class="ae kv" href="https://www.linkedin.com/in/satenik-safaryan/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div></div>    
</body>
</html>