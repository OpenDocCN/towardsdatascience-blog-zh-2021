<html>
<head>
<title>Automate Excel with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python自动化Excel</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-excel-with-python-7c0e8c7c6256?source=collection_archive---------0-----------------------#2021-05-13">https://towardsdatascience.com/automate-excel-with-python-7c0e8c7c6256?source=collection_archive---------0-----------------------#2021-05-13</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="601e" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/automation-with-pywin32" rel="noopener" target="_blank">使用PyWin32实现自动化</a></h2><div class=""/><div class=""><h2 id="9727" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">用Python自动处理无聊的事情，腾出手来喝咖啡</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/98f5a9e7c486d3689d24895f05c4199a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iBBruTKm_6Qmbg-_zCbUbQ.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@brigittetohm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">布里吉特·托姆</a>在<a class="ae li" href="https://unsplash.com/s/photos/coffee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1ff1" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">大多数情况下，一个组织会有多个数据源，数据科学家或数据分析师必须在执行分析或创建模型之前，将不同数据源中的数据提取并编译到一个Excel文件中。如果我们手动执行，这将是一项复杂且耗时的任务。</p><p id="80d7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">用最著名的Python库<code class="fe mf mg mh mi b">pandas</code>来做这件事会缩短时间，但是硬编码的Excel文件可能不会受到直接访问Excel文件的其他领域用户的青睐。因此，创建一个格式良好的交互式Excel文件将减轻领域用户的工作，并启发他们。</p><blockquote class="mj"><p id="9f4c" class="mk ml iu bd mm mn mo mp mq mr ms me dk translated">Excel允许您以透明的方式处理数据，这意味着当打开Excel文件时，数据立即可见，并且数据处理的每个步骤也可见。—周红[1]</p></blockquote><p id="330f" class="pw-post-body-paragraph lj lk iu ll b lm mt ke lo lp mu kh lr ls mv lu lv lw mw ly lz ma mx mc md me in bi translated">此外，Excel很棒，因为我们可以看到报告是如何生成的，以及各列之间的关系。Excel文件本身是不言自明的。而<code class="fe mf mg mh mi b">pandas</code>生成的硬编码Excel文件不具备这些特性。</p><p id="d6c7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">所以，这就是<code class="fe mf mg mh mi b">pywin32</code>的用武之地。<code class="fe mf mg mh mi b">Pywin32 </code>允许我们从Python访问Microsoft Excel。我们可以通过<code class="fe mf mg mh mi b">pywin32</code>访问Excel中的所有对象、方法和属性。(在此查看所有Excel对象、方法和属性<a class="ae li" href="https://docs.microsoft.com/en-us/office/vba/api/overview/excel" rel="noopener ugc nofollow" target="_blank">。)</a></p><h1 id="006a" class="my mz iu bd na nb nc nd ne nf ng nh ni kj nj kk nk km nl kn nm kp nn kq no np bi translated">Excel VBA参考</h1><p id="3b4a" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated"><code class="fe mf mg mh mi b">pywin32</code>没有官方文档，所以我必须参考Excel VBA的官方文档来了解可用的对象、属性和方法。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj nv"><img src="../Images/1e68f232dadee83e603da633747ecc78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kdSQjIimU1eU3P1H7w0S5w.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">截图来自<a class="ae li" href="https://docs.microsoft.com/en-us/office/vba/api/overview/excel/object-model" rel="noopener ugc nofollow" target="_blank">微软文档</a></p></figure><h2 id="4223" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">Excel对象模型</h2><p id="9ff4" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">对象、属性、方法和事件包含在Excel对象模型中<em class="oh">(我现在不处理事件，所以在本文中，我将只关注对象、属性和方法)</em>。下面的流程图说明了它们之间的关系。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oi"><img src="../Images/502b8398301efdeeb31f97e1ca79f7ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ctw3de4Z-zo2NOz93DUnCQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者创建的图像</p></figure><p id="bc06" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我经常使用的一个对象是<strong class="ll je">范围对象</strong>。区域是指Excel工作表中的单元格。Range对象包含如下图所示的方法和属性。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oj"><img src="../Images/257223bc8b87a4f4aab38011986d94f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWJkMZMXgccQsO-Pa-8jcA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">截图来自<a class="ae li" href="https://docs.microsoft.com/en-us/office/vba/api/overview/excel/object-model" rel="noopener ugc nofollow" target="_blank">微软文档</a></p></figure><p id="3e2a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">该文档包含Excel VBA的基本语法。幸运的是，将Excel VBA中的语法翻译成Python是很容易的。在我们进入示例之前，我们需要了解五个项目:</p><ul class=""><li id="b8da" class="ok ol iu ll b lm ln lp lq ls om lw on ma oo me op oq or os bi translated">Excel对象</li><li id="0ea6" class="ok ol iu ll b lm ot lp ou ls ov lw ow ma ox me op oq or os bi translated">Excel对象方法</li><li id="2b2e" class="ok ol iu ll b lm ot lp ou ls ov lw ow ma ox me op oq or os bi translated">Excel对象属性</li><li id="f6a3" class="ok ol iu ll b lm ot lp ou ls ov lw ow ma ox me op oq or os bi translated">Excel常量</li><li id="87e7" class="ok ol iu ll b lm ot lp ou ls ov lw ow ma ox me op oq or os bi translated">Excel宏</li></ul></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><h2 id="f070" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated"><strong class="ak"> Excel对象</strong></h2><p id="54ac" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated"><strong class="ll je"> Excel对象</strong>类似于<strong class="ll je"> Python类模块。</strong></p><p id="53d7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">当我们想调用一个定义在类模块中的函数时，我们会调用类模块，后跟一个点，然后是函数名。我们需要导入class模块来使用它的函数，但是对于<code class="fe mf mg mh mi b">pywin32 </code>模块来说，它已经导入了一切，所以我们可以直接调用任何Excel对象、方法和属性。</p></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><p id="6069" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">以下部分是对Excel对象、方法和属性的详细解释，并附有示例。为了提供更清晰的信息，该示例将使用由下面的脚本生成的Excel文件来运行。</p><ol class=""><li id="fa2f" class="ok ol iu ll b lm ln lp lq ls om lw on ma oo me pf oq or os bi translated">定义创建Excel文件的函数</li></ol><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="dd1f" class="nw mz iu mi b gz pk pl l pm pn">def create_test_excel_file(f_path: Path, f_name: str, sheet_name: str):<br/>    <br/>    filename = f_path / f_name<br/>    random.seed(365)<br/>    np.random.seed(365)<br/>    number_of_data_rows = 1000<br/>    <br/>    # create list of 31 dates<br/>    dates = pd.bdate_range(datetime(2019, 9, 1), freq='1d', periods=31).tolist()</span><span id="5ac2" class="nw mz iu mi b gz po pl l pm pn">data = {'Date': [random.choice(dates) for _ in range(number_of_data_rows)],<br/>            'Gender': [random.choice(['Female', 'Male']) for _ in range(number_of_data_rows)],<br/>            'Products': [random.choice(['Shirts', 'Pants', 'Caps', 'Socks']) for _ in range(number_of_data_rows)],<br/>            'Price': np.random.normal(15, 5, size=(1, number_of_data_rows))[0]}</span><span id="7e28" class="nw mz iu mi b gz po pl l pm pn"># create the dataframe and save it to Excel<br/>    pd.DataFrame(data).to_excel(filename, index=False, sheet_name=sheet_name, float_format='%.2f')</span></pre><p id="c2e4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">2.定义参数并执行功能</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="1019" class="nw mz iu mi b gz pk pl l pm pn"># sheet name <br/>sheet_name = 'example'  # update with sheet name from your file<br/># file path<br/>f_path = Path.cwd()  # file in current working directory<br/># f_path = Path(r'c:\...\Documents')  # file located somewhere else<br/># excel file name<br/>f_name = 'example.xlsx'<br/>create_test_excel_file(f_path, f_name, sheet_name)</span></pre><p id="f379" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">为您创建的Excel文件的屏幕截图。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj pp"><img src="../Images/c0914a3a89ddda7e4590ec1f628fc5cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*AtaUHsfptV29CdR0cpy-Xw.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者创建的图像</p></figure><h2 id="f9c4" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">Excel对象方法</h2><p id="dc5c" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">Excel对象模型中的<strong class="ll je">方法</strong>与Python中的<strong class="ll je">函数</strong>相同，都是可调用的，执行任务。用python编写函数应该<strong class="ll je">总是以一对包含关键字参数</strong>的括号结束，如下面的Python脚本所示，函数<code class="fe mf mg mh mi b">greet</code>以一对包含名为“name”的参数的括号结束。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="3503" class="nw mz iu mi b gz pk pl l pm pn"># Python Functions:<br/># create a function<br/>def greet(name):<br/>    print(f"Hello {name}")</span><span id="34bc" class="nw mz iu mi b gz po pl l pm pn">greet(name = "Alisa")</span></pre><p id="d567" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">下面的脚本显示了如何在Excel中使用一种方法，通过使用<code class="fe mf mg mh mi b">pywin32</code>来<strong class="ll je">自动筛选</strong>。它与Python函数语法非常相似，除了我们不需要定义方法，我们<strong class="ll je">将对象放在方法</strong>的前面，就像我们将类模块名称放在我们在类模块中定义的函数之前一样。<em class="oh">(这里使用的Excel文件是前面章节创建的Excel文件。)</em></p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="54f1" class="nw mz iu mi b gz pk pl l pm pn">import pandas as pd<br/>from pathlib import Path<br/>import win32com.client as win32<br/><br/>f_path = Path.cwd() # change to the path to the Excel file<br/>f_name = 'example.xlsx' # Excel File name<br/>filename = f_path/f_name<br/>sheetname = 'example' # change to the name of the worksheet<br/><br/># create Excel object<br/>excel = win32.gencache.EnsureDispatch('Excel.Application')<br/># excel can be visible or not<br/>excel.Visible = True <br/># open Excel Workbook   <br/>wb = excel.Workbooks.Open(filename)</span><span id="1ff6" class="nw mz iu mi b gz po pl l pm pn"># create filter in Excel Worksheet<br/>wb.Sheets(sheetname).Range("A1").AutoFilter(Field = 2, <!-- -->Criteria1="Female", VisibleDropDown=False<!-- -->)</span></pre><p id="52b9" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在上面的例子中，<code class="fe mf mg mh mi b">wb.Sheets(sheetname).Range(“A1”)</code>是指对象，<code class="fe mf mg mh mi b">AutoFilter()</code>是方法，<code class="fe mf mg mh mi b">Field = 2, Criteria1="Female", VisibleDropDown=False</code>是参数。字段是指要筛选的列。<code class="fe mf mg mh mi b">Field = 2</code>指左数第二列，即B列['性别']。该脚本的结果如下图所示，数据根据“性别”过滤，当我们将<strong class="ll je">标准</strong>设置为女性时，仅显示“女性”记录。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj pq"><img src="../Images/596b88961b1b7c4878813dccbe203704.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*AlaUsNC0lsb2PAlW08IsSQ.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者创建的图像</p></figure><p id="0670" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">将Excel VBA写入Python的标准语法是以这种方式组织代码:</p><blockquote class="mj"><p id="a475" class="mk ml iu bd mm mn mo mp mq mr ms me dk translated">对象。方法(参数=参数)</p></blockquote><p id="1e9d" class="pw-post-body-paragraph lj lk iu ll b lm mt ke lo lp mu kh lr ls mv lu lv lw mw ly lz ma mx mc md me in bi translated">当您查看Excel VBA文档时，总会有一些如下的脚本示例(下面的脚本是根据上面提到的Excel VBA参考中的示例修改的)。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="bb09" class="nw mz iu mi b gz pk pl l pm pn">Worksheets("Sheet1").Range("A1").AutoFilter _<br/> Field:=2, _<br/> Criteria1:="Female", _<br/> VisibleDropDown:=False</span></pre><p id="7023" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Excel VBA和Python的语法只有微小的区别，其中<strong class="ll je"> Excel VBA不保存括号</strong>中的参数，而在<strong class="ll je"> Python中，</strong>我们必须<strong class="ll je">创建Excel对象并显式定义工作簿路径和名称</strong>。因此，从Excel VBA转换到Python是可能且容易的。</p></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><h2 id="49e9" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">Excel对象属性</h2><p id="48f0" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">Excel对象模型中的<strong class="ll je">属性</strong>与Python中的<strong class="ll je">变量</strong>相同，不可调用，只返回赋值。例如，Excel表中某列的列宽是用来存储该列的列宽的属性。另一个例子，Excel表中单元格的值。你可以把它想象成一个变量，你可以改变它的值，就像你在python中改变变量的值一样。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="4bc2" class="nw mz iu mi b gz pk pl l pm pn"># Python Variable: <br/># assign a value to a variable<br/>x = 5<br/># change the value assigned to the variable<br/>x = 6</span></pre><p id="e805" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">上面显示了如何在Python中更新变量值的简单示例。下面的脚本展示了如何使用<code class="fe mf mg mh mi b">pywin32</code>来更新Excel中单元格的值。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="01ae" class="nw mz iu mi b gz pk pl l pm pn">import pandas as pd<br/>from pathlib import Path<br/>import win32com.client as win32<br/>import datetime<br/>today = datetime.date.today()</span><span id="e396" class="nw mz iu mi b gz po pl l pm pn">f_path = Path.cwd() # change to the path to the Excel file<br/>f_name = 'example.xlsx' # Excel File name<br/>filename = f_path/f_name<br/>sheetname = 'example' # change to the name of the worksheet<br/><br/># create Excel object<br/>excel = win32.gencache.EnsureDispatch('Excel.Application')<br/># excel can be visible or not<br/>excel.Visible = True <br/># open Excel Workbook   <br/>wb = excel.Workbooks.Open(filename)</span><span id="2d86" class="nw mz iu mi b gz po pl l pm pn"># update value in Excel Worksheet<br/>wb.Sheets(sheetname).Range("F1").Value = f"Today date: {today}"</span></pre><p id="ade6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在上面的例子中，<code class="fe mf mg mh mi b">wb.Sheets(sheetname).Range(“F1”)</code>指的是对象，<code class="fe mf mg mh mi b">Value</code>是属性，而<code class="fe mf mg mh mi b">f”Today date: {today}”</code>是分配给对象的值。简而言之，我们将一个值放入一个单元格中。当我们用Python编写脚本时，我们可以应用一些Python脚本。在这种情况下，使用<strong class="ll je"> f字符串</strong>。下图显示了脚本的结果。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pr"><img src="../Images/f43731d18c05f09ae24e4e5e113ef817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6hndVPD1eeiOxMaEY9ONw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者创建的图像</p></figure><p id="9077" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">当我运行这个脚本时，从前面的脚本创建的过滤器没有被清除，所以过滤器仍然在文件中。清除过滤器的方法将在下一节中解释。</p><p id="26f8" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">将Excel VBA写入Python的标准语法是以这种方式组织代码:</p><blockquote class="mj"><p id="3eff" class="mk ml iu bd mm mn mo mp mq mr ms me dk translated">对象。属性=值</p></blockquote><p id="708e" class="pw-post-body-paragraph lj lk iu ll b lm mt ke lo lp mu kh lr ls mv lu lv lw mw ly lz ma mx mc md me in bi translated">下面是根据Excel VBA参考修改的脚本。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="edc1" class="nw mz iu mi b gz pk pl l pm pn">Worksheets("Sheet1").Range("F1").Value = "2021-05-13"</span></pre><p id="1adc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">对于属性，Excel VBA中的语法在大多数情况下与Python中的语法相同。当要分配的值是Excel常量时，语法会稍有不同。</p></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><h2 id="f246" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">Excel常数</h2><p id="40cb" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">一些对象方法和属性只接受常量列表作为它们的参数。Excel常量通常以“xl”开头。在这种情况下，我们必须在使用Python时导入常量(在使用Excel VBA时这是不必要的)。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="7160" class="nw mz iu mi b gz pk pl l pm pn">import pandas as pd<br/>from pathlib import Path<br/>import win32com.client as win32<br/><strong class="mi je">win32c = win32.constants</strong></span><span id="5e72" class="nw mz iu mi b gz po pl l pm pn">f_path = Path.cwd() # change to the path to the Excel file<br/>f_name = 'example.xlsx' # Excel File name<br/>filename = f_path/f_name<br/>sheetname = 'example' # change to the name of the worksheet<br/><br/># create Excel object<br/>excel = win32.gencache.EnsureDispatch('Excel.Application')<br/># excel can be visible or not<br/>excel.Visible = True <br/># open Excel Workbook   <br/>wb = excel.Workbooks.Open(filename)</span><span id="f242" class="nw mz iu mi b gz po pl l pm pn"># set cell horizontal alignment<br/>wb.Worksheets("example").Columns("A:D").HorizontalAlignment = <strong class="mi je">win32c</strong>.xlLeft</span></pre><p id="9a30" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在上面的例子中，赋值为<code class="fe mf mg mh mi b">xlLeft</code>，因为它是Excel常量，我们必须在常量前面添加<strong class="ll je"> win32c </strong>(因为我将<code class="fe mf mg mh mi b">win32.constants</code>保存为win32c)。上面脚本的结果如下图所示。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj pp"><img src="../Images/cf248a9ed9286fdf642063b4af7b68c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*MsOrSoUbmDxwUAnkI9iUkg.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者创建的图像</p></figure><p id="8862" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">标题的水平对齐方式是居中，现在向左对齐。</p><p id="eb4f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">将Excel VBA写入Python的标准语法是以这种方式组织代码:</p><blockquote class="mj"><p id="0391" class="mk ml iu bd mm mn mo mp mq mr ms me dk translated">对象。Property = win32c。ExcelConstant</p></blockquote></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><h2 id="e8ae" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">Excel宏</h2><p id="723e" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">pywin32的语法类似于将Excel VBA翻译成Python语法。因此，您可以随时参考Excel VBA文档，了解Excel中可用的对象、方法和属性。当文档不够时，您可以简单地记录特定过程的宏并参考步骤信息。</p><p id="781c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在我的工作中，我使用Excel宏来获取特定列的字体颜色(<code class="fe mf mg mh mi b"><em class="oh">expression</em>.Columns.Font.Color</code>)和单元格填充颜色(<code class="fe mf mg mh mi b"><em class="oh">expression</em>.Columns.Interior.Color</code>)的颜色代码。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ps"><img src="../Images/f767cbd4416eb88e90cd85da0d209711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pR0cRwkG7jfPvdeHGd9Vrw.gif"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">作者创建的GIF</p></figure><p id="e3fb" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在上面的GIF中，255代表红色的颜色代码，我们可以在Python脚本中使用它来改变单元格的颜色。</p><p id="7cbe" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">当我们不确定在某种情况下使用哪些方法或属性时，我们总是可以记录Excel宏。</p></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><h1 id="7f41" class="my mz iu bd na nb pt nd ne nf pu nh ni kj pv kk nk km pw kn nm kp px kq no np bi translated">例子</h1><p id="96d9" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">在这一节中，我将分享我经常使用的方法和属性。与上面的例子一样，在运行任何执行excel方法或修改Excel属性的脚本之前，我们需要导入库并创建Excel对象。以下示例中使用的Excel文件仍然是我们在前面部分创建的文件。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="2c10" class="nw mz iu mi b gz pk pl l pm pn">import pandas as pd<br/>from pathlib import Path<br/>import win32com.client as win32<br/>win32c = win32.constants</span><span id="9ba5" class="nw mz iu mi b gz po pl l pm pn">f_path = Path.cwd() # change to the path to the Excel file<br/>f_name = 'example.xlsx' # Excel File name<br/>filename = f_path/f_name<br/>sheetname = 'example' # change to the name of the worksheet<br/><br/># create Excel object<br/>excel = win32.gencache.EnsureDispatch('Excel.Application')<br/># excel can be visible or not<br/>excel.Visible = True <br/># open Excel Workbook   <br/>wb = excel.Workbooks.Open(filename)</span></pre><h2 id="91b0" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">方法</h2><ol class=""><li id="c3e9" class="ok ol iu ll b lm nq lp nr ls py lw pz ma qa me pf oq or os bi translated"><strong class="ll je">自动滤镜</strong></li></ol><p id="38e3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">向每列添加筛选器。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="c9cd" class="nw mz iu mi b gz pk pl l pm pn">wb.Sheets(sheetname).Range("A1").AutoFilter(Field = 1)</span></pre><p id="f4b6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 2。自动调整</strong></p><p id="958e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">根据单词长度调整列宽。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="8a21" class="nw mz iu mi b gz pk pl l pm pn">wb.Sheets(sheetname<!-- -->).Columns("A:I").AutoFit()</span></pre><p id="b1f5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 3。复制</strong></p><p id="ded6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">将单元格区域的值复制到另一个位置。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="66c8" class="nw mz iu mi b gz pk pl l pm pn">wb.Sheets(sheetname2).Range("A1:E10").Copy(Destination = wb.Sheets(sheetname).Range("F1"))</span></pre><p id="7c3f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 4。复制+选择性粘贴</strong></p><p id="6c9a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">将一个工作表的格式复制到另一个工作表。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="4ee0" class="nw mz iu mi b gz pk pl l pm pn"># copy paste FORMAT only, which include font colour, fill colour, and border<br/>wb2.Sheets(sheetname).Range("A:D").Copy()<br/>wb.Sheets(sheetname).Range("A1").PasteSpecial(Paste=win32c.xlPasteFormats)</span></pre><p id="4e33" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 5。向下填充(向左填充、向右填充、向上填充)</strong></p><p id="7550" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">将公式填入单元格区域。例如，从单元格A2填充到A1000，如下面的脚本所示。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="c78d" class="nw mz iu mi b gz pk pl l pm pn">wb.Sheets(sheetname).Range("A2:A1000").FillDown()</span></pre><p id="a1d5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 6。插入</strong></p><p id="50dd" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">通过向下移动原始列<em class="oh">(到后面的索引，例如，从C列到D列)</em>插入新列。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="b77e" class="nw mz iu mi b gz pk pl l pm pn"># insert a new row by shifting the original row down<br/>wb.Sheets(sheetname).Rows("1:2").Insert(win32c.xlShiftDown)</span></pre></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><h2 id="354b" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">性能</h2><ol class=""><li id="0d07" class="ok ol iu ll b lm nq lp nr ls py lw pz ma qa me pf oq or os bi translated"><strong class="ll je">列宽</strong></li></ol><p id="314e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">调整列宽。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="eb85" class="nw mz iu mi b gz pk pl l pm pn">wb.Sheets(sheetname).Columns("A").ColumnWidth = 10</span></pre><p id="e3bc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 2。字体/内部颜色</strong></p><p id="0bdd" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">字体</strong>包含更多属性，例如字体颜色、字体大小和字体名称。</p><p id="8f69" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">分配颜色有两种方法，颜色代码和颜色索引。对于颜色代码，它是一个很长的数字，只能通过查阅Excel宏步骤信息来获得。而对于颜色索引，您可以在Excel中创建一个颜色表，并找到您想要的颜色索引。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="1565" class="nw mz iu mi b gz pk pl l pm pn">wb.Worksheets(sheetname).Columns("K:K").Font.Color = -4165632<br/>wb.Worksheets("sheetname").Columns("K:K").Interior.Color = 10092492</span></pre><p id="2f48" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 3。公式</strong></p><p id="c484" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">将公式分配给单元格。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="225d" class="nw mz iu mi b gz pk pl l pm pn">wb.Sheets(sheetname).Range(f"{column_insert}2").Formula = "=A2+B2"</span><span id="f18c" class="nw mz iu mi b gz po pl l pm pn"># if you wish to create a function<br/>column1 = "A"<br/>column2 = "B"<br/>operation = "+" # math operation to perform between 2 columns</span><span id="b264" class="nw mz iu mi b gz po pl l pm pn">def math_op(column1, column2, operation):<br/>  wb.Sheets(sheetname).Range(f"{column_insert}2").Formula =   f"={column1}2{operation}{column2}2"</span><span id="a90f" class="nw mz iu mi b gz po pl l pm pn">math_op(column1, column2, operation)</span></pre><p id="cddd" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe mf mg mh mi b">{column1}</code>和<code class="fe mf mg mh mi b">{operation}</code>之间的‘2’，<code class="fe mf mg mh mi b">{column2}</code>后的‘2’表示第2行。</p><p id="4ee9" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 4。水平对齐</strong></p><p id="3fb0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">调整单元格水平对齐。对准有三种类型，分别是<code class="fe mf mg mh mi b">xlLeft</code>、<code class="fe mf mg mh mi b">xlCenter </code>和<code class="fe mf mg mh mi b">xlRight</code>。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="4156" class="nw mz iu mi b gz pk pl l pm pn">wb.Worksheets("sheetname").Rows("1:1").HorizontalAlignment = win32c.xlLeft</span></pre><p id="2c2f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je"> 5。数字格式</strong></p><p id="69c1" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">设置数值的格式。对于<code class="fe mf mg mh mi b">NumberFormat</code>值，可以通过Excel宏获取。</p><pre class="kt ku kv kw gu pg mi ph pi aw pj bi"><span id="c6c6" class="nw mz iu mi b gz pk pl l pm pn">wb.Worksheets("sheetname").Columns("O:O").NumberFormat= '_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(<a class="ae li" href="http://twitter.com/_" rel="noopener ugc nofollow" target="_blank">@_</a>)'</span></pre></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><h1 id="32e3" class="my mz iu bd na nb pt nd ne nf pu nh ni kj pv kk nk km pw kn nm kp px kq no np bi translated"><strong class="ak">结论</strong></h1><p id="b87a" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">Pywin32允许我们像手工一样设置Excel报表。我们可以用引用单元格设置公式(例如:O2 = P2+Q2)，创建数据透视表，设置单元格格式(例如:单元格颜色、字体颜色、列宽等)。)，设置滤镜等等。</p><p id="6aa7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们可以通过<code class="fe mf mg mh mi b">pywin32</code>自动生成定期生成的格式报告。我们只需在Python脚本中创建所有方法或设置属性一次。</p><p id="1ec6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">此外，我们可以扩大这种自动化。例如，我们可能需要在完成后通过电子邮件发送这份Excel报告。我们可以简单地添加脚本的另一行来发送报告。</p><p id="1a4d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">最后，每当你进退两难时，记住Python <strong class="ll je"> pywin32 </strong>的标准语法如下。</p><blockquote class="mj"><p id="2bc8" class="mk ml iu bd mm mn mo mp mq mr ms me dk translated">对象。方法(参数= <em class="qb">参数</em></p><p id="27bc" class="mk ml iu bd mm mn mo mp mq mr ms me dk translated">对象。属性=值</p><p id="df66" class="mk ml iu bd mm mn mo mp mq mr ms me dk translated">对象。Property = win32c。ExcelConstant</p></blockquote></div><div class="ab cl oy oz hy pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="in io ip iq ir"><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="qc qd l"/></div></figure><p id="9bb7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果您是一个视频爱好者，这里有一个视频，介绍了您应该知道的使用PyWin32库自动生成Excel报表的关键概念。</p><h1 id="0938" class="my mz iu bd na nb nc nd ne nf ng nh ni kj nj kk nk km nl kn nm kp nn kq no np bi translated">保持联系</h1><p id="458a" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">在<a class="ae li" href="https://www.youtube.com/channel/UCiMtx0qbILP41Ot-pkk6eJw" rel="noopener ugc nofollow" target="_blank"> YouTube </a>上订阅</p><h2 id="1bce" class="nw mz iu bd na nx ny dn ne nz oa dp ni ls ob oc nk lw od oe nm ma of og no ja bi translated">一些旁注</h2><p id="475f" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">如果您有兴趣了解如何自动化<strong class="ll je">创建数据透视表并从数据透视表中提取过滤后的数据到pandas DataFrame </strong>，<a class="ae li" href="https://kahemchu.medium.com/automate-excel-with-python-pivot-table-899eab993966" rel="noopener">用Python自动化数据透视表(创建、过滤和提取)</a>。</p><p id="8c7f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果你有兴趣用Python创建图表或数据透视图，并自动导出为图像，那么<a class="ae li" href="https://kahemchu.medium.com/automate-excel-chart-with-python-d7bec97df1e5#eb8b-f75b97c49234" rel="noopener">用Python自动化Excel图表</a>。</p><p id="f5e7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果你的工作使用的是Google Sheet而不是Microsoft Excel，你可以参考这篇文章，“<a class="ae li" rel="noopener" target="_blank" href="/automate-google-sheet-reporting-in-5-minutes-8bbdc1f8e293">自动化Google Sheet Report </a>”来了解可能的自动化。</p><p id="af1f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果你有兴趣知道如何使用<code class="fe mf mg mh mi b">pywin32</code>访问Microsoft Outlook邮件和下载附件，你可以参考这篇文章“用Python自动下载邮件附件<a class="ae li" rel="noopener" target="_blank" href="/automatic-download-email-attachment-with-python-4aa59bc66c25">”。</a></p><h1 id="f51d" class="my mz iu bd na nb nc nd ne nf ng nh ni kj nj kk nk km nl kn nm kp nn kq no np bi translated">文献学</h1><p id="a12f" class="pw-post-body-paragraph lj lk iu ll b lm nq ke lo lp nr kh lr ls ns lu lv lw nt ly lz ma nu mc md me in bi translated">[1] H .周，通过Excel学习数据挖掘:理解机器学习方法的逐步方法，纽约:新闻媒体，2020 .</p><p id="dcde" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">[2] <a class="ae li" href="https://trenton3983.github.io/files/solutions/2020-06-22_pivot_table_win32com/create_pivot_table_with_win32com.html" rel="noopener ugc nofollow" target="_blank">如何用Python win32com模块在Excel中创建数据透视表</a> —用Python在Excel中创建数据透视表的完整示例。</p><p id="7388" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">[3] <a class="ae li" href="https://docs.microsoft.com/en-us/office/vba/api/overview/excel" rel="noopener ugc nofollow" target="_blank"> Excel VBA参考</a> —关于Microsoft Excel中的对象、方法、属性和事件的完整参考。</p><p id="fa1b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><em class="oh">祝贺并感谢你阅读到最后。希望你喜欢这篇文章。</em> ☺️</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj qe"><img src="../Images/0b90c6f38706b7670d0650e13a7804f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhVRX8FNLrJ1v1XBLFtIog.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated"><a class="ae li" href="https://unsplash.com/@calebchen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Caleb Chen </a>在<a class="ae li" href="https://unsplash.com/s/photos/thank-you?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div></div>    
</body>
</html>