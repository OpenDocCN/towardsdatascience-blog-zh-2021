<html>
<head>
<title>Basic Molecular Representation for Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的基本分子表示</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/basic-molecular-representation-for-machine-learning-b6be52e9ff76?source=collection_archive---------3-----------------------#2021-09-14">https://towardsdatascience.com/basic-molecular-representation-for-machine-learning-b6be52e9ff76?source=collection_archive---------3-----------------------#2021-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="a117" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/thoughts-and-theory" rel="noopener" target="_blank">思想和理论</a></h2><div class=""/><div class=""><h2 id="44d3" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">从微笑到单词嵌入和图形嵌入</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c41e1b1aadb452591d52c3a3eba619b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GbshlGqHAi8agfGLEi-Y2g.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="e2bf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">机器学习已经应用于化学信息学和生命科学中的许多问题，例如，<a class="ae ma" href="https://moleculenet.org/" rel="noopener ugc nofollow" target="_blank">研究分子性质</a>，<a class="ae ma" href="https://zitniklab.hms.harvard.edu/drugml/" rel="noopener ugc nofollow" target="_blank">开发新药</a>。这些应用的问题解决流程中的一个关键问题是选择适当的分子表示，以表征目标数据集并服务于下游模型。图1显示了不同分子表示的概念框架。通常，一个分子由一个线性形式表示为一个<a class="ae ma" href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system" rel="noopener ugc nofollow" target="_blank">微笑</a>串，或者由一个<a class="ae ma" href="https://en.wikipedia.org/wiki/Graph_theory" rel="noopener ugc nofollow" target="_blank">图</a>形式表示为一个相邻矩阵，可能与原子的节点属性矩阵和键的边属性矩阵一起。SMILES字符串可以进一步转换成不同的格式，比如分子指纹、一键编码或单词嵌入。另一方面，分子表示的图形形式可以被下游模型直接使用或者被转换成用于任务的图形嵌入。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mb"><img src="../Images/88dd2a95204c893de1b2454561880ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-PcCb78KyjFI48ELGvvPQw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mc">图1。分子表示的概念框架</strong></p></figure><p id="9af6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">本帖描述了在实现上述概念框架时使用的一些代码，包括:</p><ul class=""><li id="f3b9" class="md me iq lg b lh li lk ll ln mf lr mg lv mh lz mi mj mk ml bi translated">阅读、绘图、分析分子，</li><li id="a853" class="md me iq lg b lh mm lk mn ln mo lr mp lv mq lz mi mj mk ml bi translated">从微笑串生成分子指纹，</li><li id="4908" class="md me iq lg b lh mm lk mn ln mo lr mp lv mq lz mi mj mk ml bi translated">从SMILES字符串生成一位热码编码，</li><li id="1b6d" class="md me iq lg b lh mm lk mn ln mo lr mp lv mq lz mi mj mk ml bi translated">从SMILES字符串生成单词嵌入，以及</li><li id="7723" class="md me iq lg b lh mm lk mn ln mo lr mp lv mq lz mi mj mk ml bi translated">在图形中生成分子表示。</li></ul><h1 id="9fd0" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">阅读、绘制和分析分子</h1><p id="c39d" class="pw-post-body-paragraph le lf iq lg b lh nj ka lj lk nk kd lm ln nl lp lq lr nm lt lu lv nn lx ly lz ij bi translated"><a class="ae ma" href="https://www.rdkit.org/docs/GettingStartedInPython.html" rel="noopener ugc nofollow" target="_blank"> RDKit </a>是一个用于化学信息学的开源库。图2显示了读取咖啡因<a class="ae ma" href="https://en.wikipedia.org/wiki/Caffeine" rel="noopener ugc nofollow" target="_blank">的微笑字符串并绘制其分子结构的代码。请注意，在微笑字符串中，C是碳，N是氮，O是氧。如图3所示，可以显示没有标记碳的分子，或者如图4所示，显示有标记碳的分子。</a></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图二。阅读并画出咖啡因的分子。[ </strong> <a class="ae ma" href="https://www.rdkit.org/docs/GettingStartedInPython.html#drawing-molecules" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> 3 </strong> </a>，<strong class="ak"/><a class="ae ma" href="https://chemicbook.com/2021/03/01/how-to-show-atom-numbers-in-rdkit-molecule.html" rel="noopener ugc nofollow" target="_blank"><strong class="ak">4</strong></a><strong class="ak">]</strong></p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/12c2d561bd3a9a71addcf61a27c716ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*GUcErt-hKEyD3vQ83uoLFA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mc">图3。caffeine.png</strong></p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/c91c17e76a169fc78e5c115aa5427b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Lf0IYqBeGizXArPV6Q_qdw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mc">图4。咖啡因_with_prop.png </strong></p></figure><p id="44a5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">图5显示了显示咖啡因分子中原子和键的代码。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图5。展示咖啡因分子中的原子和键。【</strong><a class="ae ma" href="https://github.com/dakoner/keras-molecules/blob/dbbb790e74e406faa70b13e8be8104d9e938eba2/convert_rdkit_to_networkx.py" rel="noopener ugc nofollow" target="_blank"><strong class="ak">5</strong></a><strong class="ak">】</strong></p></figure><p id="dc60" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">图6和图7分别显示了咖啡因分子中原子和键的细节。注意事项:</p><ol class=""><li id="b63d" class="md me iq lg b lh li lk ll ln mf lr mg lv mh lz nr mj mk ml bi translated">术语“<em class="ns">芳烃</em>”在下表中可简单视为“<em class="ns">环</em>”。图6中的<em class="ns"> GetIsAromatic </em>表示原子是否在环中，图7中的<em class="ns"> GetBondType </em>表示键是否在环中。</li><li id="d4db" class="md me iq lg b lh mm lk mn ln mo lr mp lv mq lz nr mj mk ml bi translated">图6和图7可以被视为图1所示概念框架中的简单原子属性矩阵和简单键属性矩阵。</li><li id="2a68" class="md me iq lg b lh mm lk mn ln mo lr mp lv mq lz nr mj mk ml bi translated">图7中的键列表可以表示分子的图形形式，即邻接矩阵的链表。</li></ol><div class="kp kq kr ks gt ab cb"><figure class="nt kt nu nv nw nx ny paragraph-image"><img src="../Images/c91c17e76a169fc78e5c115aa5427b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Lf0IYqBeGizXArPV6Q_qdw.png"/></figure><figure class="nt kt nz nv nw nx ny paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/84dc8b9e599c0db2048495bd963664d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*PQLuxspXMZkTn5U6qH2cAA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk oa di ob oc translated"><strong class="bd mc">图6。咖啡因的原子。</strong></p></figure></div><div class="ab cb"><figure class="nt kt od nv nw nx ny paragraph-image"><img src="../Images/c91c17e76a169fc78e5c115aa5427b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Lf0IYqBeGizXArPV6Q_qdw.png"/></figure><figure class="nt kt oe nv nw nx ny paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/2237c5fed4063f757dbda1e5d309bc75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*ZF5Qok6hJA0I6fRmRhms_Q.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk of di og oc translated"><strong class="bd mc">图7。咖啡因的结合。</strong></p></figure></div><h1 id="e1e7" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">从微笑字符串生成分子指纹</h1><p id="321d" class="pw-post-body-paragraph le lf iq lg b lh nj ka lj lk nk kd lm ln nl lp lq lr nm lt lu lv nn lx ly lz ij bi translated">RDKit支持几个<a class="ae ma" href="https://www.rdkit.org/docs/GettingStartedInPython.html#fingerprinting-and-molecular-similarity" rel="noopener ugc nofollow" target="_blank">指纹函数</a>，其输出可用于计算分子相似性或作为下游机器学习模型的输入。图8显示了检索RDKit指纹和Morgan指纹的代码，图9显示了这些指纹函数的结果。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图8。检索RDKit指纹和Morgan指纹</strong></p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图九。RDKit指纹和Morgan指纹。</strong></p></figure><h1 id="aeae" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated"><strong class="ak">从SMILES字符串中生成一位热码</strong></h1><p id="9ca2" class="pw-post-body-paragraph le lf iq lg b lh nj ka lj lk nk kd lm ln nl lp lq lr nm lt lu lv nn lx ly lz ij bi translated">将SMILES字符串视为自然语言中的文本，可能SMILES字符串最简单的表示方法是字符级的<a class="ae ma" href="https://en.wikipedia.org/wiki/One-hot" rel="noopener ugc nofollow" target="_blank">一键编码</a>。图10显示了在SMILES字符串的字符级生成一键编码的代码。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图10。SMILES字符串字符级的一键编码。【</strong><a class="ae ma" href="https://iwatobipen.wordpress.com/2017/01/22/encode-and-decode-smiles-strings/" rel="noopener ugc nofollow" target="_blank"><strong class="ak">6</strong></a><strong class="ak"/></p></figure><p id="11eb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">注意，一键编码也可以用在原子级或原子/键属性矩阵中。</p><h1 id="9978" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">从SMILES字符串生成单词嵌入</h1><p id="3a47" class="pw-post-body-paragraph le lf iq lg b lh nj ka lj lk nk kd lm ln nl lp lq lr nm lt lu lv nn lx ly lz ij bi translated">在语言建模的背景下，生成分子表示的更复杂的方法是将<a class="ae ma" href="https://en.wikipedia.org/wiki/Word_embedding" rel="noopener ugc nofollow" target="_blank">单词嵌入</a>的方法应用于分子的子结构。图11中的代码显示了使用<a class="ae ma" href="https://github.com/samoturk/mol2vec" rel="noopener ugc nofollow" target="_blank"> mol2vec </a>和<a class="ae ma" href="https://radimrehurek.com/gensim/models/word2vec.html" rel="noopener ugc nofollow" target="_blank"> word2vec </a>为<a class="ae ma" href="https://moleculenet.org/datasets-1" rel="noopener ugc nofollow" target="_blank"> HIV </a>数据集中的所有分子生成单词嵌入的过程。数据集中有41127个分子(图12)，每个分子被编码为一个300维向量(图13)。注意，代码摘自“<a class="ae ma" href="https://www.kaggle.com/vladislavkisin/tutorial-ml-in-chemistry-research-rdkit-mol2vec" rel="noopener ugc nofollow" target="_blank"> <em class="ns">化学研究中的简单ML:rd kit&amp;mol 2 vec</em></a>”，详细解释了预测HIV活性的解决方案。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图11。为艾滋病毒数据集中的分子生成单词嵌入</strong></p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图12。HIV数据集的列和行。</strong></p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图13。HIV数据集中分子的Mol2vec嵌入</strong></p></figure><h1 id="c27e" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">在图形中生成分子表示</h1><p id="c842" class="pw-post-body-paragraph le lf iq lg b lh nj ka lj lk nk kd lm ln nl lp lq lr nm lt lu lv nn lx ly lz ij bi translated">在RDKit中操纵分子/原子/键的过程为生成分子表示的图形形式提供了基础。上面的图5、图6和图7显示了咖啡因的邻接矩阵、节点属性矩阵和边属性网络。然而，将RDKit中的分子转换成<a class="ae ma" href="https://networkx.org/documentation/stable/tutorial.html" rel="noopener ugc nofollow" target="_blank"> NetworkX </a>(一个用于网络分析的开源库)中的图形，可以利用传统图形算法和现代图形模型的研究来调查分子结构和性质。图14显示了将RDKit中的分子转换成NetworkX中的图形的代码。图15显示了由RDKit和NetworkX绘制的分子图。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图14。将RDKit中的分子转换为NetworkX中的图形</strong></p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/5c4fcc01c0a83bff1b71b18c5349e539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCPGYODRrApiJ-yzbh03wQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mc">图15。RDKit和NetworkX的分子图</strong></p></figure><p id="ffa6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">图网络中的一个重要研究领域是图嵌入。一般来说，图嵌入由三个主题组成:<em class="ns">节点级嵌入</em>(将图中的节点编码为向量)、<em class="ns">边级嵌入</em>(将图中的边编码为向量)、g <em class="ns">图级嵌入</em>(将整个图编码为向量。)在本文中，我们将术语<em class="ns">图嵌入</em>视为<em class="ns">图级嵌入</em>，它为一个分子找到一个向量，该向量可以用作下游模型的输入。图16显示了将RDKit中的分子转换为NetworkX中的图形，并通过<a class="ae ma" href="https://github.com/benedekrozemberczki/graph2vec" rel="noopener ugc nofollow" target="_blank"> Graph2Vec </a>在<a class="ae ma" href="https://github.com/benedekrozemberczki/karateclub" rel="noopener ugc nofollow" target="_blank"> KarateClub </a>下生成其图形嵌入的代码。Graph2Vec是一个图形嵌入算法，KarateClub是一个为图形数据提供无监督机器学习模型的包。图17显示了HIV数据集中分子的Graph2Vec嵌入。KarateClub在库中介绍了几种图形嵌入算法。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图16。为HIV数据集中的分子生成图形嵌入</strong></p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图17是HIV数据集中分子的Graph2Vec嵌入图</strong></p></figure><h1 id="5906" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">结论</h1><p id="0910" class="pw-post-body-paragraph le lf iq lg b lh nj ka lj lk nk kd lm ln nl lp lq lr nm lt lu lv nn lx ly lz ij bi translated">这篇文章描述了几种分子表示，包括基于字符串的格式，基于图形的格式，以及一些变体，如单词嵌入和图形嵌入。这些分子表示，加上不同的机器学习算法，包括深度学习模型和图形神经网络，可以作为处理分子机器学习问题的基线。</p><p id="ea7a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">感谢阅读。如果你有任何意见，请随时给我留言。</p></div></div>    
</body>
</html>