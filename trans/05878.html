<html>
<head>
<title>Analysing La Liga 2020/21 with Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用普罗特利分析2020/21赛季西甲联赛</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analysing-la-liga-2020-21-with-plotly-1f63c99073b4?source=collection_archive---------49-----------------------#2021-05-25">https://towardsdatascience.com/analysing-la-liga-2020-21-with-plotly-1f63c99073b4?source=collection_archive---------49-----------------------#2021-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eafd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">用动画线形图描绘西甲比赛，用图表显示统计数据</strong></h2></div><blockquote class="ki kj kk"><p id="d806" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">"进攻为你赢得比赛，防守为你赢得冠军."</p></blockquote><p id="8fb9" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">作为一个狂热的巴萨球迷，我不禁赞同弗格森爵士(前曼联主帅)的上述说法，尤其是在当前俱乐部足球的背景下。巴塞罗那足球俱乐部(FC Barcelona)曾在其黄金时代完全主宰国内联赛和欧洲足球。然而，俱乐部自2015/16赛季以来就没有打进过欧冠决赛。在上赛季输给劲敌皇家马德里之后，巴塞罗那在本赛季的倒数第二个比赛日输给了塞尔塔维戈，也被踢出了冠军争夺战。另一方面，马德里竞技队在去年夏天从巴塞罗那转会到马德里竞技队的首席射手路易斯·苏亚雷斯的激励下，获得了他们的第11个西甲冠军。</p><p id="d026" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">西甲联赛在很大程度上被认为是一场三足鼎立的比赛，尤其是在最近几年，因为在过去十年中，只有巴塞罗那、皇家马德里和马德里竞技赢得了联赛冠军或成为了联赛冠军的最大竞争者。在这篇文章中，我将使用一个动画情节的线图比赛和一个非常基本的仪表板来讨论这三个俱乐部在本赛季西甲的竞争和基本统计数据。代码和数据可以在这个GitHub <em class="kn"> </em> <a class="ae ll" href="https://github.com/hbshrestha/Analysing-La-Liga-2020-21-Statistics-using-Plotly" rel="noopener ugc nofollow" target="_blank">资源库</a>中获得。让我们开始吧。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="6f2c" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated"><strong class="ak">西甲2020/21赛季动画剧情线路图</strong></h1><p id="7323" class="pw-post-body-paragraph kl km it ko b kp ml ju kr ks mm jx ku li mn kx ky lj mo lb lc lk mp lf lg lh im bi translated">首先，我的目标是想象整个赛季前三名球队在西甲联赛中的表现。我首先导入三个必需的包，在本例中是pandas、numpy和plotly.graph_objects。用于此目的的数据可在这个<a class="ae ll" href="https://github.com/hbshrestha/Analysing-La-Liga-2020-21-Statistics-using-Plotly/blob/main/data/la%20liga%20race.xlsx" rel="noopener ugc nofollow" target="_blank">储存库</a>中获得，这个储存库是我根据<a class="ae ll" href="https://www.fctables.com/spain/liga-bbva/" rel="noopener ugc nofollow" target="_blank">FcTables.com</a>通过跟踪每个俱乐部每个比赛日的赢、输和平而创建的。dataframe由每个比赛日之后西甲三支顶级球队的累计积分组成，如下图所示。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/95e2dfed6b3e337699b1a83e04732206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*d0xbw5V6ySypGCNTv9A9-w.png"/></div><p class="my mz gj gh gi na nb bd b be z dk translated">每个比赛日后包含累积积分的数据框(图片由作者提供)</p></figure><p id="4b27" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">plotly.graph_objects包括显示图形的数据和布局元素。我从定义<code class="fe nc nd ne nf b">numOfFrames</code> <em class="kn">，</em>开始，这相当于dataframe中的行数。我创建了一个名为<code class="fe nc nd ne nf b">initial_data</code> <em class="kn">，</em>的散点图类型的轨迹，它表示数据帧的第一行中的数据。</p><p id="4737" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">为了获得动画折线图竞赛，在每个瞬时时间点捕获帧是一个先决条件，这样第一帧捕获第一行的数据，第二帧捕获第一和第二行的数据，依此类推。为此目的创建了嵌套for循环，使得<code class="fe nc nd ne nf b">frames</code> <em class="kn"> </em>将每个<code class="fe nc nd ne nf b">current_frame</code> <em class="kn"> </em>的实例附加到末尾。</p><figure class="mr ms mt mu gt mv"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="615d" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">通过传递用于数据的<code class="fe nc nd ne nf b">initial_data</code>和用于布局的<code class="fe nc nd ne nf b">frames</code>，我得到了一个描述联赛中前三名俱乐部每个比赛日总积分的动画线图，如下所示:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ni"><img src="../Images/107a9fb59c1027965170a544fd1c98cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WDeACNRrkxzQkJxJ1SoCDA.gif"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">前三名俱乐部每个比赛日的积分(图片由作者提供)</p></figure><p id="b88c" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><strong class="ko iu">分析</strong></p><p id="5e28" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">正如上面的gif图片所示，巴塞罗那在赛季开始的前十场比赛中表现不佳。这是他们这么多赛季以来最糟糕的开局之一，俱乐部在前八场比赛中仅积11分，在联赛中排名第13位。相比之下，马竞的开局要好得多。到2021年1月赛季中期，马竞在联赛中稳步上升，分别与皇家马德里和巴塞罗那拉开了10分和13分的差距。</p><p id="3be2" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">前十场比赛后，巴塞罗那加快了速度，连续几场连胜，甚至在某些点上超过了皇家马德里，并缩小了与联赛领头羊的差距。另一方面，马德里竞技在赛季中期后下降了几分，并将领先优势从超过11分缩小到只有几分。在赛季的最后一个季度，巴塞罗那和皇家马德里都丢掉了几个关键分，甚至错过了登上榜首的机会。在本赛季的最后一个比赛日，三家俱乐部都赢得了比赛，然而，马德里竞技成为了西甲2020/21赛季的最终赢家。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="d924" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated"><strong class="ak"> Plotly仪表盘</strong></h1><p id="aae2" class="pw-post-body-paragraph kl km it ko b kp ml ju kr ks mm jx ku li mn kx ky lj mo lb lc lk mp lf lg lh im bi translated">在本节中，我打算创建一个非常基本的交互式仪表盘，以可视化西甲2020/21的统计数据并进行讨论。我为此使用的包与上面的线图比赛使用的包是一样的。用于此目的的数据可在<a class="ae ll" href="https://github.com/hbshrestha/Analysing-La-Liga-2020-21-Statistics-using-Plotly/blob/main/data/la%20liga%20statistics.xlsx" rel="noopener ugc nofollow" target="_blank">此处</a>获得，可从<a class="ae ll" href="https://fbref.com/en/comps/12/La-Liga-Stats" rel="noopener ugc nofollow" target="_blank">fbref.com</a>公开获得。数据帧如下所示:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nn"><img src="../Images/49e9dace1a90cd525758f0f25cb01303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUaEL5WScNZGXpJUcVzOIA.jpeg"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">西甲2020/21积分表(图片由作者提供)</p></figure><p id="7d80" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">接下来，我初始化该图，并创建一个我希望在仪表板中显示的指标的字典。在我的字典里，这些键代表着分数、进球、失球、净胜球、获胜的比赛、平局的比赛和失败的比赛。该字典的每个键都链接到原始数据集的相应子集。</p><pre class="mr ms mt mu gt no nf np nq aw nr bi"><span id="e29c" class="ns lu it nf b gy nt nu l nv nw">#create a figure from the graph objects (not plotly express) library<br/>fig=go.Figure()</span><span id="c174" class="ns lu it nf b gy nx nu l nv nw">#Create dictionary for ease of access<br/>df_dict={"points":df[["Squad","Pts"]],<br/>        "goal_difference":df[["Squad","GD"]],<br/>        "goals_scored":df[["Squad","GF"]],<br/>        "goals_conceded":df[["Squad","GA"]],<br/>        "matches_won":df[["Squad","W"]],<br/>        "matches_drawn":df[["Squad","D"]],<br/>        "matches_lost":df[["Squad","L"]]}</span></pre><p id="31ee" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">在这一步，我需要为下拉菜单创建一个按钮列表。为此，我初始化了一个名为<code class="fe nc nd ne nf b">dropdowns</code> <em class="kn"> </em>的空列表和一个计数器<code class="fe nc nd ne nf b">i</code>。使用for循环，我为每个指示器创建一个名为<code class="fe nc nd ne nf b">dropdown</code> <em class="kn"> </em>的按钮对象。该按钮还包含一个名为<code class="fe nc nd ne nf b">args</code>的布尔值(真/假)列表，它告诉根据真值显示哪个轨迹。</p><figure class="mr ms mt mu gt mv"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="a627" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">所有的按钮对象都被追加到<code class="fe nc nd ne nf b">dropdowns</code>列表中。如下图所示，对于第一个字典，只有列表中的第一项在更新时可见。对于第二个字典，它是列表中可见的第二个项目，依此类推。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ny"><img src="../Images/17a758b51abf1a720c984c5ab33aa8b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xr3pICEIlk1AeW81C5YE6g.jpeg"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated"><strong class="bd nz"> <em class="oa">下拉列表</em> </strong>由每个指标组成的列表作为标签，“更新”作为方法，True/False作为可见参数。(图片由作者提供)</p></figure><p id="2dd6" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">最后，为了更新绘图的布局，我指定了(x，y)坐标，我想要的<code class="fe nc nd ne nf b">dropdowns</code>按钮的位置，以及我想要菜单弹出的方向。</p><figure class="mr ms mt mu gt mv"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="43dc" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我得到了一个基本的交互式仪表板，如下所示。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ni"><img src="../Images/f9bd57a6b106619b310d8d621f5ade4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*RwuZsSz9gK54e2i6QJ-lRA.gif"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">带有西甲2020/21统计数据的仪表板</p></figure><h1 id="0461" class="lt lu it bd lv lw ob ly lz ma oc mc md jz od ka mf kc oe kd mh kf of kg mj mk bi translated">分析</h1><p id="2b21" class="pw-post-body-paragraph kl km it ko b kp ml ju kr ks mm jx ku li mn kx ky lj mo lb lc lk mp lf lg lh im bi translated">在西甲2020/21赛季总共38场比赛之后，马竞以86分的成绩成为冠军。皇家马德里以84分接近第二，巴塞罗那以79分排名第三。排名前三的俱乐部分别赢得了26场、25场和24场比赛。巴塞罗那以85个进球成为联赛中进球最多的球队，冠军和亚军各进67个球。然而，巴塞罗那也是三支球队中防守最差的，在同样多的比赛中丢了38个球。虽然巴塞罗那在三个俱乐部中净胜球最多，但输掉七场比赛和七场平局对俱乐部来说是非常昂贵的。</p><h1 id="70e8" class="lt lu it bd lv lw ob ly lz ma oc mc md jz od ka mf kc oe kd mh kf of kg mj mk bi translated">结论</h1><p id="acf9" class="pw-post-body-paragraph kl km it ko b kp ml ju kr ks mm jx ku li mn kx ky lj mo lb lc lk mp lf lg lh im bi translated">在这篇文章中，一个简单的西甲比赛和基本统计数据的分析是在一个动画线图比赛和使用Plotly的仪表板的帮助下进行的。除了对数据有一个整体的了解之外，Plotly的交互功能对于从图中获得准确的信息非常有用。交互式功能、地图、动画等。可以通过其开源图形库<a class="ae ll" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank">访问。</a></p></div></div>    
</body>
</html>