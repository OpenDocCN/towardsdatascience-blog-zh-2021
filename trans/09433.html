<html>
<head>
<title>Implementing Machine Learning algorithm to detect attacks in IoT traffic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实现机器学习算法来检测物联网流量中的攻击</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implementing-machine-learning-algorithm-to-detect-attacks-in-iot-traffic-df61b679e16b?source=collection_archive---------31-----------------------#2021-09-01">https://towardsdatascience.com/implementing-machine-learning-algorithm-to-detect-attacks-in-iot-traffic-df61b679e16b?source=collection_archive---------31-----------------------#2021-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7ae0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">本文阐述了通过使用随机森林分类器算法来检测物联网流量中发现的攻击和异常。</h2></div><h1 id="27f0" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">介绍</h1><p id="1f8c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">物联网基础设施中的攻击和异常检测是物联网领域日益关注的问题。由于物联网基础设施的使用越来越多，对这些基础设施的攻击也呈指数级增长。因此，有必要开发一个智能、安全的物联网环境，能够检测其漏洞。这里，提出了一种基于机器学习的解决方案，可以检测攻击类型并保护物联网系统。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lt"><img src="../Images/dbadffafa733cbbe62ff987b7306e821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tmiJDkQ_I2vVoVua"/></div></div><p class="mf mg gj gh gi mh mi bd b be z dk translated"><a class="ae mj" href="https://unsplash.com/@bermixstudio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Bermix工作室</a>在<a class="ae mj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="8f34" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">解决方案的设计和工作流程</h1><p id="f7fc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该解决方案的整个工作流程将在下面以图示的形式介绍。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/5d94c1768dd4ace52a811ea58e4238bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*gbLOOlDEeg8ScSaiWQjGgg.png"/></div><p class="mf mg gj gh gi mh mi bd b be z dk translated">物联网攻击检测解决方案的工作流程。作者图片</p></figure><h2 id="d468" class="ml kg iq bd kh mm mn dn kl mo mp dp kp lg mq mr kr lk ms mt kt lo mu mv kv mw bi translated">工作流程中涉及的步骤如下:</h2><ul class=""><li id="052e" class="mx my iq kz b la lb ld le lg mz lk na lo nb ls nc nd ne nf bi translated"><strong class="kz ir"> <em class="ng">数据集收集和描述:</em> </strong> <em class="ng">使用</em> <strong class="kz ir"> <em class="ng"> </em>分布式智能空间协调系统</strong> ( <strong class="kz ir"> DS2OS </strong>)创建虚拟物联网环境，该系统具有一组基于物联网的<strong class="kz ir">服务</strong>，如温度控制器、窗户控制器、灯光控制器等。<strong class="kz ir">用户</strong>和服务之间的通信被捕获并存储在<strong class="kz ir"> CSV </strong>文件格式中。在数据集中，有357，952个样本和13个特征。该数据集包含347，935个<strong class="kz ir">正常</strong>数据和10，017个<strong class="kz ir">异常</strong>数据，并包含八个已分类的类。这8类攻击是拒绝服务(DoS)、数据类型探测、恶意控制、恶意操作、扫描、刺探、错误设置、正常。该数据集可以免费使用，并且可以在<strong class="kz ir">Kaggle</strong>webiste<a class="ae mj" href="https://www.kaggle.com/francoisxa/ds2ostraffictraces" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/francoisxa/ds2ostraffictraces</a>上找到。“<strong class="kz ir">mainsimulationaccesstraces . CSV</strong>”文件包含使用pandas库读取的数据集</li></ul><pre class="lu lv lw lx gt nh ni nj nk aw nl bi"><span id="a9c8" class="ml kg iq ni b gy nm nn l no np">import pandas as pd  #Pandas library for reading csv file<br/>import numpy as np   #Numpy library for converting data into array</span><span id="53bd" class="ml kg iq ni b gy nq nn l no np">Dataset=pd.read_csv('mainSimulationAccessTraces.csv')<br/>x=Dataset.iloc[:,:-2].values<br/>y=Dataset.iloc[:,12].values</span></pre><ul class=""><li id="c858" class="mx my iq kz b la nr ld ns lg nt lk nu lo nv ls nc nd ne nf bi translated"><strong class="kz ir">数据预处理</strong>:数据预处理的第一步是处理数据集中的<strong class="kz ir">缺失值</strong>。在数据集中，我们可以看到“<strong class="kz ir">访问的节点类型</strong>”列和“<strong class="kz ir">值</strong>”列包含由于数据传输过程中出现异常而导致的缺失数据。因为“访问的节点类型”列是分类类型，所以我将使用一个常数值来填充它。“值”列是数字类型的，因此我使用均值策略来填充缺失的值。下一步是<strong class="kz ir">特性选择</strong>，它包括删除对数据没有任何意义的<strong class="kz ir">时间戳</strong>特性。下一步涉及使用标签编码将名义分类数据转换成向量。</li></ul><pre class="lu lv lw lx gt nh ni nj nk aw nl bi"><span id="5ea8" class="ml kg iq ni b gy nm nn l no np">from sklearn.impute import SimpleImputer<br/>imputer=SimpleImputer(missing_values=np.nan,strategy='constant',verbose=0)<br/>imputer=imputer.fit(x[:,[8]])<br/>x[:,[8]]=imputer.transform(x[:,[8]])</span><span id="f38c" class="ml kg iq ni b gy nq nn l no np">imputer1=SimpleImputer(missing_values=np.nan,strategy='mean',verbose=0)<br/>imputer1=imputer1.fit(x[:,[10]])<br/>x[:,[10]]=imputer1.transform(x[:,[10]])</span><span id="6b8d" class="ml kg iq ni b gy nq nn l no np">from sklearn.preprocessing import LabelEncoder<br/>labelencoder_X = LabelEncoder()<br/>for i in range(0,10):<br/>    x[:,i] = labelencoder_X.fit_transform(x[:,i])<br/>x=np.array(x,dtype=np.float)</span><span id="c08a" class="ml kg iq ni b gy nq nn l no np">y=labelencoder_X.fit_transform(y)</span></pre><ul class=""><li id="05c5" class="mx my iq kz b la nr ld ns lg nt lk nu lo nv ls nc nd ne nf bi translated"><strong class="kz ir">采样</strong>:这个阶段包括将数据集分成训练和测试数据集。我已经分配了80%的数据集用于训练，剩下的20%用于测试。</li></ul><pre class="lu lv lw lx gt nh ni nj nk aw nl bi"><span id="eec9" class="ml kg iq ni b gy nm nn l no np">from sklearn.model_selection import train_test_split<br/>x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=0)</span></pre><ul class=""><li id="e30a" class="mx my iq kz b la nr ld ns lg nt lk nu lo nv ls nc nd ne nf bi translated"><strong class="kz ir">归一化</strong>:使用<strong class="kz ir">标准定标器</strong>库对训练和测试数据集进行归一化，使所有特征值在相似范围内。</li></ul><pre class="lu lv lw lx gt nh ni nj nk aw nl bi"><span id="bf19" class="ml kg iq ni b gy nm nn l no np">from sklearn.preprocessing import StandardScaler<br/>sc = StandardScaler()<br/>x_train = sc.fit_transform(x_train)<br/>x_test = sc.transform(x_test)</span></pre><ul class=""><li id="5bd5" class="mx my iq kz b la nr ld ns lg nt lk nu lo nv ls nc nd ne nf bi translated"><strong class="kz ir">建立ML模型</strong>:将<strong class="kz ir">训练</strong>数据集传递给<strong class="kz ir">随机森林</strong>分类器算法进行训练，生成模型/预测器。我已经用<strong class="kz ir"> sklearn </strong>库完成了这一步。我用了10棵树做模型。训练后，<strong class="kz ir">测试</strong>数据集被传递给<strong class="kz ir">预测器/模型</strong>，它将判断数据是否受到攻击。</li></ul><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi nw"><img src="../Images/ac250c1b74fb20d029297e1efb2aaa63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WUXqX_coo9O3HHXd"/></div></div><p class="mf mg gj gh gi mh mi bd b be z dk translated">凯文·Ku在<a class="ae mj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><pre class="lu lv lw lx gt nh ni nj nk aw nl bi"><span id="9286" class="ml kg iq ni b gy nm nn l no np">from sklearn.ensemble import RandomForestClassifier<br/>classifier=RandomForestClassifier(n_estimators=10,criterion='entropy',random_state=0)<br/>classifier.fit(x_train,y_train)</span><span id="a9b3" class="ml kg iq ni b gy nq nn l no np">y_pred = classifier.predict(x_test)</span></pre><ul class=""><li id="065d" class="mx my iq kz b la nr ld ns lg nt lk nu lo nv ls nc nd ne nf bi translated"><strong class="kz ir">模型评估</strong>:最后一步是确定我们模型的准确性，我们已经使用混淆矩阵和准确性参数来确定性能。</li></ul><blockquote class="nx ny nz"><p id="4128" class="kx ky ng kz b la nr jr lc ld ns ju lf oa ob li lj oc od lm ln oe of lq lr ls ij bi translated">使用随机森林算法，我得到了99.37%的准确率。我还在下面附上了<strong class="kz ir">混淆矩阵</strong>的快照</p></blockquote><pre class="lu lv lw lx gt nh ni nj nk aw nl bi"><span id="92f0" class="ml kg iq ni b gy nm nn l no np">from sklearn.metrics import confusion_matrix<br/>from sklearn.metrics import accuracy_score <br/>cm = confusion_matrix(y_test, y_pred)<br/>accuracy=accuracy_score(y_test, y_pred)</span></pre><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi og"><img src="../Images/cf33672d59dd84a65b914def33bf4afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I_m5Giq5GcnFyZjAHsgdNw.png"/></div></div><p class="mf mg gj gh gi mh mi bd b be z dk translated">混淆矩阵</p></figure><h1 id="5926" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">结论</h1><p id="bbe0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">随机森林算法能够在虚拟物联网环境数据集上提供99.37%的准确率。还可以在此基础上执行交叉折叠验证，以避免模型过度拟合。要了解有关用于生成数据的物联网环境的更多信息，请参考以下URL<a class="ae mj" href="https://www.researchgate.net/publication/330511957_Machine_Learning-Based_Adaptive_Anomaly_Detection_in_Smart_Spaces" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/publication/330511957 _ Machine _ Learning-Based _ Adaptive _ Anomaly _ Detection _ in _ Smart _ Spaces</a></p></div></div>    
</body>
</html>