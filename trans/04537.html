<html>
<head>
<title>Create your own Python package and publish it into PyPI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建自己的Python包，并将其发布到PyPI中</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-your-own-python-package-and-publish-it-into-pypi-9306a29bc116?source=collection_archive---------3-----------------------#2021-04-19">https://towardsdatascience.com/create-your-own-python-package-and-publish-it-into-pypi-9306a29bc116?source=collection_archive---------3-----------------------#2021-04-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ac50" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在本文中，您将找到将代码转换成Python包并将其上传到Python包索引站点的简单步骤</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/dd8b7f0bb09228b9992c4a21c4497d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1R89tY3fc9Yg0Tcq8eMroA.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由<a class="ae kf" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>授权</p></figure><h1 id="3c15" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">您愿意与全球Python开发者社区分享您的代码吗？</h1><h1 id="422a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">开始吧！</h1><p id="efe2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我假设正在阅读本文的大多数人已经运行了下面的命令。但是，幕后发生了什么？</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="2b4f" class="mp kx iq ml b gy mq mr l ms mt">pip install pandas</span></pre><p id="eb95" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">在你运行命令<em class="mz"> pip install </em>的时候，你正在访问<a class="ae kf" href="https://pypi.org" rel="noopener ugc nofollow" target="_blank"> PyPI站点</a>来下载一个包。网站<a class="ae kf" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/</a>是Python编程语言的软件仓库。</p><h2 id="8d68" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">步骤0:准备要共享的代码</h2><p id="82df" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">作为一个例子，我将使用几个程序转换成一个Python包。这个代码是一个简单的游戏，能够“猜测”玩家心中的数字。你可以在我的<a class="ae kf" href="https://github.com/mwpnava/Python-Code/tree/master/My_own_Python_package" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中看到代码。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nl"><img src="../Images/28dd800b5937f245c68468a925d73fc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/0*b5DyR8Qj2RX8DxQc.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">文件夹内容。作者图片</p></figure><h2 id="5807" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">步骤1:创建__init__。py文件</h2><p id="d3d9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">创建一个名为<em class="mz"> __init__的文件。py </em>并将其保存到您的代码所在的文件夹中。这个文件告诉Python这个文件夹包含一个Python包。<em class="mz"> __init__里面的代码。每当您在Python程序中导入一个包时，就会运行py </em>文件。在这种情况下，我的<em class="mz"> __init__。py </em>文件正在从numberGuesserGame模块导入<em class="mz"> GuessMyNumber </em>类。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/eb1152afb7da2135851ec751fc2d8e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J8Jl9qhjCOZzHVrW.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">__init__。py文件内容。作者图片</p></figure><p id="92e9" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">现在，我的文件夹里有三个文件:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/22566859819daa54a35b659646a70dbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/0*SbqFDFIxYQcKbhOA.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">文件夹内容。作者图片</p></figure><h2 id="171d" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">步骤2:创建setup.py文件</h2><p id="95e8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在目录中向上一级，创建<em class="mz"> setup.py </em>文件。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi no"><img src="../Images/c86f75bdb77e53471c7a536328125843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/0*SXGYbjwk4ZA6SbFE.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">文件夹内容。作者图片</p></figure><p id="14ff" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">这个重要的文件包含关于包的信息。每次运行命令<em class="mz"> pip </em>，它都会自动寻找setup.py文件。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/40706a699d1a3c3340114b7522efd086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cxYBKQI7_BOSVCyc.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">setup.py文件内容。作者图片</p></figure><p id="af4e" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">它主要包括对<em class="mz"> setup </em>函数的调用，该函数接收参数以指定项目如何定义的细节，例如，<em class="mz">名称、作者、版本、描述等。</em></p><h2 id="9532" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">步骤3:在本地安装您的软件包</h2><p id="3881" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">完成步骤1和2后，就可以在本地安装Python包了。首先，打开一个终端，转到包含您的软件包的文件夹，键入下面的命令。圆点表示在当前文件夹中查找setup.py文件，并在其中安装软件包。</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="67f3" class="mp kx iq ml b gy mq mr l ms mt">pip install .</span></pre><p id="2e64" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">现在，您可以留在该文件夹中或移动到另一个文件夹来运行Python并使用您的包。让我们看看这个例子:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/0732e6e95441ffe68819de4273d3ccea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MkntG-8hb7dzlJUU.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">运行我的包。作者图片</p></figure><h2 id="6c73" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">步骤4:创建许可证和自述文件</h2><p id="eb2c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">回到包含您的包的目录，再创建两个文件:</p><ul class=""><li id="d2e1" class="np nq iq lq b lr mu lu mv lx nr mb ns mf nt mj nu nv nw nx bi translated">License.txt 将告诉用户使用你的软件包的条款和条件。我将<a class="ae kf" href="https://opensource.org/licenses/MIT" rel="noopener ugc nofollow" target="_blank">麻省理工学院的许可证</a>复制并粘贴到我的文件中</li><li id="79a7" class="np nq iq lq b lr ny lu nz lx oa mb ob mf oc mj nu nv nw nx bi translated"><strong class="lq ir"> README.md </strong>会简单的告诉用户你的包是关于什么的</li></ul><p id="10c6" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">你的文件夹应该看起来像下面的图片，你的包，和4个附加文件:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b87d0cec110dbf90cd3f5b3d26a3a9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*-_y947LZ2_ppgTtb.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">文件夹内容。作者图片</p></figure><h2 id="b659" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">第五步。生成您的源代码发行版</h2><p id="5544" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一旦你有了所有需要的文件，使用下面的命令安装最新版本的<em class="mz"> setuptools </em>包(我们在<em class="mz"> setup.py </em>文件中使用)。</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="3356" class="mp kx iq ml b gy mq mr l ms mt">python -m pip install --user --upgrade setuptools</span></pre><p id="5eec" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">确保您位于setup.py所在的目录中，并运行以下命令:</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="9dd8" class="mp kx iq ml b gy mq mr l ms mt">python setup.py sdist</span></pre><p id="2670" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">你会看到有一个新的文件夹<em class="mz"> dist </em>包含了tar.gz文件，它提供了元数据和<em class="mz"> pip </em>安装所需的基本源文件。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/76f3984c829db17811d7046c1efd488e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/0*44PdbNUvoTnKU4ql.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">文件夹内容。作者图片</p></figure><p id="1b5e" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">您还会看到一个<em class="mz"> ProjectName.egg-info </em>文件夹，它包含需要移动到目标系统上特定位置的文件和元数据。别担心，你可以忽略它，删除它或在这里了解更多信息<a class="ae kf" href="https://setuptools.readthedocs.io/en/latest/deprecated/python_eggs.html#eggs-and-their-formats" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="4e36" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">第六步。为测试PyPI和PyPI存储库创建帐户。</h2><p id="0bc7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">去<a class="ae kf" href="https://test.pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI测试</a>和<a class="ae kf" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI </a>网站创建你的账户，记住你的密码很重要，这些密码很快会被重新输入命令行。</p><h2 id="4c8b" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">第七步。将您的包上传到测试PyPI存储库</h2><p id="50c9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">下一步是安装<em class="mz"> twine </em>，这个实用程序将帮助你把你的包上传到<a class="ae kf" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI仓库</a>或者其他仓库。一旦安装好<em class="mz">绳线</em>，就不需要重复这个步骤。</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="ab83" class="mp kx iq ml b gy mq mr l ms mt">pip install twine</span></pre><p id="f0e1" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">打开一个终端，在你的命令行中输入下面的命令，它会要求你提供你之前在步骤6中创建的用户名和密码。</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="f617" class="mp kx iq ml b gy mq mr l ms mt">twine upload --repository-url https://test.pypi.org/legacy/ dist/*</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/c8cb939037494d633a21bdd8412dfd2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4a0xWLfJlQOCbg4h.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">上传包裹。作者图片</p></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/95ad9d0d95598bdd18e63e0e8c2b1c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9VxKAAYUrTkWFUow.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">文件夹内容。作者图片</p></figure><p id="3fdd" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">登录到<a class="ae kf" href="https://test.pypi.org/" rel="noopener ugc nofollow" target="_blank"> Test PyPI存储库</a>并验证您的包在那里。如果是这样，复制软件包名称下的命令，在命令行中运行它，并在屏幕上阅读说明软件包已成功安装的消息。</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="cfab" class="mp kx iq ml b gy mq mr l ms mt">pip install -i https://test.pypi.org/simple/ guesser-game</span></pre><h2 id="cf7e" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">第八步。将您的包上传到PyPI存储库</h2><p id="6d20" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最后，这是您必须运行的最后一个命令，以便与全球Python开发人员社区共享您的包。确保你在<em class="mz"> setup.py </em>文件所在的同一个目录下。</p><pre class="kh ki kj kk gt mk ml mm mn aw mo bi"><span id="a9ed" class="mp kx iq ml b gy mq mr l ms mt">twine upload dist/*</span></pre><p id="cb86" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">现在，这个包在<a class="ae kf" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI仓库</a>中！</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/7a56a82be127fc91950b84e95891a4fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fCKS2WgmCnA-znBD.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">文件夹内容。作者图片</p></figure><h2 id="40ea" class="mp kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">结论:</h2><p id="4196" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">知道如何上传你的Python包很重要，但在我看来，愿意分享你的知识、与社区合作、创造学习文化和寻找不同的做事方法同样重要，甚至更重要。</p><p id="d216" class="pw-post-body-paragraph lo lp iq lq b lr mu jr lt lu mv ju lw lx mw lz ma mb mx md me mf my mh mi mj ij bi translated">更多参考资料，可以回顾一下<a class="ae kf" href="https://packaging.python.org/" rel="noopener ugc nofollow" target="_blank">packaging.python.org</a>。</p></div></div>    
</body>
</html>