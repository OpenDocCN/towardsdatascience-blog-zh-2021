<html>
<head>
<title>Use annotations to tell better stories with your plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用注释来讲述更好的故事</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/use-annotations-to-tell-better-stories-with-your-plots-410cb1752bee?source=collection_archive---------20-----------------------#2021-09-12">https://towardsdatascience.com/use-annotations-to-tell-better-stories-with-your-plots-410cb1752bee?source=collection_archive---------20-----------------------#2021-09-12</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><figure class="iu iv gp gr iw ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi it"><img src="../Images/d1212aa1365670b6be079484b920e970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvX5H2x_urnYKNS6_PCUnA.jpeg"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">照片由<a class="ae ji" href="https://unsplash.com/@isaacmsmith?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">艾萨克·史密斯</a>在<a class="ae ji" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><div class=""/><div class=""><h2 id="0335" class="pw-subtitle-paragraph ki jk jl bd b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dk translated">以及如何使用<code class="fe la lb lc ld b">plotly</code>在Python中实现</h2></div><p id="36f1" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">俗话说，一幅画胜过千言万语。在数据科学中，我们经常使用不同类型的情节来探索数据或讲述故事，通常是针对非技术观众。</p><p id="6a8b" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">数据可视化通常被认为是一项独立的技能，需要花费专门的时间和精力来掌握。几乎任何人都可以运行一行程序来创建一个简单的情节。但是有许多技术或细节可以极大地改善图形，强化我们想要传达的信息。</p><p id="a8cf" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">有许多很棒的文章和书籍致力于该主题，例如，<a class="ae ji" href="https://www.amazon.com/gp/product/1119002257/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1119002257&amp;linkCode=as2&amp;tag=erykml0c-20&amp;linkId=f9ab5a2c180698ede61f6ccdb33bc825" rel="noopener ugc nofollow" target="_blank"> <em class="ma">用数据讲故事:商业人士的数据可视化指南</em> </a> <em class="ma"> </em>(免责声明:引用链接)。在这篇短文中，我们将关注一个可以极大地帮助理解故事的方面——情节注释。</p><h2 id="87eb" class="mb mc jl bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms mt bi translated">关于封面故事的一些背景信息</h2><p id="f28c" class="pw-post-body-paragraph le lf jl lg b lh mu km lj lk mv kp lm ln mw lp lq lr mx lt lu lv my lx ly lz io bi translated">你很有可能已经听说过这个故事，即使你可能对加密货币没有明确的兴趣。2021年初，埃隆·马斯克发布了几条关于<strong class="lg jm"> DOGE </strong>的推文，DOGE最初是作为一个笑话而创造的。这些推文对DOGE的价格产生了很大的影响，使其暴涨。我们将仔细看看硬币的价格，以及它是如何受到推文的影响的。</p><figure class="mz na nb nc gt ix"><div class="bz fp l di"><div class="nd ne l"/></div><p class="je jf gj gh gi jg jh bd b be z dk translated">引发这一切的推特</p></figure><h2 id="60ab" class="mb mc jl bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms mt bi translated">用Python探索DOGE价格</h2><p id="18a0" class="pw-post-body-paragraph le lf jl lg b lh mu km lj lk mv kp lm ln mw lp lq lr mx lt lu lv my lx ly lz io bi translated">和往常一样，我们首先需要导入库。对于本文，我们将使用绘图库<code class="fe la lb lc ld b">plotly</code>。这是因为我发现它是最容易实现注释的。然而，这在其他库中也是可能的。</p><figure class="mz na nb nc gt ix"><div class="bz fp l di"><div class="nf ne l"/></div></figure><p id="638d" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">我们将使用<code class="fe la lb lc ld b">yfinance</code>库下载2021年1月至4月的DOGE-USD历史价格。关于如何使用这个库的更多细节，你可以参考我以前的文章。我们还计算了每日百分比变化，以供进一步分析。</p><figure class="mz na nb nc gt ix"><div class="bz fp l di"><div class="nf ne l"/></div></figure><p id="e684" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">下载的数据如下所示:</p><figure class="mz na nb nc gt ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi ng"><img src="../Images/d462d8b0af223c0685a3f8be959481d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yPnSDy7wshNxGwrl2W62Nw.png"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">作者图片</p></figure><p id="0112" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">我们可以使用以下代码片段轻松创建DOGE收盘价的交互式线图:</p><figure class="mz na nb nc gt ix"><div class="bz fp l di"><div class="nf ne l"/></div></figure><figure class="mz na nb nc gt ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi nh"><img src="../Images/1fc47ec1d47470906ddfade2e679dd7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oaPlMXxS7h0NhiNB9jtbaw.png"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">作者图片</p></figure><p id="cfc0" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">我们确实可以看到DOGE的价格是如何随着时间的推移而变化的。在那4个月里，价格增长了65倍！使用<code class="fe la lb lc ld b">plotly</code>的交互式工具提示，我们可以详细了解任意一天的价格。</p><p id="02a7" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">注释的一个方便的用例是指出埃隆·马斯克在哪一天发推文。然后，我们可以清楚地观察到价格是如何响应这些推文而变化的(注意:推文本身并不是价格变化的唯一原因)。</p><p id="83b2" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">首先，让我们定义注释。</p><figure class="mz na nb nc gt ix"><div class="bz fp l di"><div class="nf ne l"/></div></figure><p id="d60d" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">在这个列表中，我们提到了埃隆·马斯克在2021年的4个月里发布的4条推文。对于每个注释，我们指定以下内容:</p><ul class=""><li id="4dcb" class="ni nj jl lg b lh li lk ll ln nk lr nl lv nm lz nn no np nq bi translated"><code class="fe la lb lc ld b">x</code>-用于注释的x轴值。在这种情况下，我们使用推文的日期。</li><li id="9814" class="ni nj jl lg b lh nr lk ns ln nt lr nu lv nv lz nn no np nq bi translated"><code class="fe la lb lc ld b">y</code> —用于注释的y轴值。这里，我们使用当天的收盘价。</li><li id="70ca" class="ni nj jl lg b lh nr lk ns ln nt lr nu lv nv lz nn no np nq bi translated"><code class="fe la lb lc ld b">text</code> —注释的标题。在这里，我们使用的是埃隆·马斯克的推文内容。</li><li id="526b" class="ni nj jl lg b lh nr lk ns ln nt lr nu lv nv lz nn no np nq bi translated"><code class="fe la lb lc ld b">arrowhead</code> —表示我们想要使用哪种形状的箭头</li></ul><p id="ae80" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">我们可以使用的一些附加参数:</p><ul class=""><li id="aab9" class="ni nj jl lg b lh li lk ll ln nk lr nl lv nm lz nn no np nq bi translated"><code class="fe la lb lc ld b">arrowsize </code> —决定箭头的大小</li><li id="d5d7" class="ni nj jl lg b lh nr lk ns ln nt lr nu lv nv lz nn no np nq bi translated"><code class="fe la lb lc ld b">ax</code> / <code class="fe la lb lc ld b">ay </code> —用于沿轴移动标注。当我们不希望注释相互重叠或与线条重叠时，这就很方便了。</li></ul><p id="7413" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">当我们准备好列表时，我们可以使用<code class="fe la lb lc ld b">update_layout</code>方法将注释应用到图中。</p><figure class="mz na nb nc gt ix"><div class="bz fp l di"><div class="nf ne l"/></div></figure><p id="73b8" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">运行该行会更新该图，如下所示:</p><figure class="mz na nb nc gt ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi nw"><img src="../Images/d12bb613c8aecf271944997560064edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qfn6gEw-_tEON3k0SPhKVw.png"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">作者图片</p></figure><p id="59d9" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">通过注释，我们可以清楚地看到DOGE的价格在推文发布当天以及随后几天的表现。有趣的是，当我们查看2021年之前的价格历史时，与推文发布后的暴涨相比，价格基本持平。</p><p id="7325" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated"><strong class="lg jm">注意</strong>:我们也可以使用<code class="fe la lb lc ld b">fig</code>对象的<code class="fe la lb lc ld b">add_annotation</code>方法来添加注释。参数与上面指定的参数相同。我们使用了<code class="fe la lb lc ld b">update_layout</code>方法，因为一次添加多个注释更方便。</p><p id="8189" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">通过稍微修改包含注释(y轴值)的列表，我们可以得到相同的图，但DOGE价格的每日百分比变化除外。</p><figure class="mz na nb nc gt ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi nx"><img src="../Images/003318c02db86589d8e201de908a4640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YLPGPJlbApJd4h_Lr4pihg.png"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">作者图片</p></figure><p id="f8d2" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">正如我们所看到的，tweets和随后的几天可以被描述为DOGE价格的异常高的每日百分比变化。</p><h2 id="b738" class="mb mc jl bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms mt bi translated">外卖食品</h2><ul class=""><li id="b2c8" class="ni nj jl lg b lh mu lk mv ln ny lr nz lv oa lz nn no np nq bi translated">在情节上使用注释可以极大地帮助向观众传达故事，尤其是非技术性的观众，</li><li id="57a5" class="ni nj jl lg b lh nr lk ns ln nt lr nu lv nv lz nn no np nq bi translated">在Python中，注释可以添加到任何类型的绘图中，但是要记住，不同库之间实现的细节是不同的，</li><li id="d395" class="ni nj jl lg b lh nr lk ns ln nt lr nu lv nv lz nn no np nq bi translated"><code class="fe la lb lc ld b">plotly</code>提供了一种非常简单的方法来给它的图形添加注释。</li></ul><p id="83f0" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">你可以在我的<a class="ae ji" href="https://github.com/erykml/medium_articles/blob/master/Misc/plot_annotations.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到本文使用的代码。此外，欢迎任何建设性的反馈。你可以在推特或评论中联系我。</p><p id="76f0" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">喜欢这篇文章吗？成为一个媒介成员，通过无限制的阅读继续学习。如果你使用<a class="ae ji" href="https://eryk-lewinson.medium.com/membership" rel="noopener">这个链接</a>成为会员，你将支持我，不需要额外的费用。提前感谢，再见！</p><p id="41e1" class="pw-post-body-paragraph le lf jl lg b lh li km lj lk ll kp lm ln lo lp lq lr ls lt lu lv lw lx ly lz io bi translated">您可能还会对以下内容感兴趣:</p><div class="iu iv gp gr iw ob"><a rel="noopener follow" target="_blank" href="/learn-what-a-depth-chart-is-and-how-to-create-it-in-python-323d065e6f86"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd jm gy z fp og fr fs oh fu fw jk bi translated">了解什么是深度图以及如何用Python创建深度图</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">使用币安的API获取订单数据</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">towardsdatascience.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op jc ob"/></div></div></a></div><div class="iu iv gp gr iw ob"><a rel="noopener follow" target="_blank" href="/mplfinance-matplolibs-relatively-unknown-library-for-plotting-financial-data-62c1c23177fd"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd jm gy z fp og fr fs oh fu fw jk bi translated">mpl finance——matplolib相对不为人知的用于绘制金融数据的库</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">包括快速创建图表的方法，如烛台，连科，或点和图</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">towardsdatascience.com</p></div></div><div class="ok l"><div class="oq l om on oo ok op jc ob"/></div></div></a></div><div class="iu iv gp gr iw ob"><a rel="noopener follow" target="_blank" href="/the-simplest-way-to-create-an-interactive-candlestick-chart-in-python-ee9c1cde50d8"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd jm gy z fp og fr fs oh fu fw jk bi translated">用Python创建交互式烛台图表的最简单方法</h2><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">towardsdatascience.com</p></div></div><div class="ok l"><div class="or l om on oo ok op jc ob"/></div></div></a></div><h2 id="e3a1" class="mb mc jl bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms mt bi translated">参考</h2><p id="1ce7" class="pw-post-body-paragraph le lf jl lg b lh mu km lj lk mv kp lm ln mw lp lq lr mx lt lu lv my lx ly lz io bi translated"><a class="ae ji" href="https://www.fool.com/the-ascent/buying-stocks/articles/5-times-elon-musk-has-sent-dogecoin-prices-soaring/" rel="noopener ugc nofollow" target="_blank">https://www . fool . com/the-ascent/buying-stocks/articles/5-times-elon-musk-has-send-dog ecoin-prices-spiring/</a></p></div></div>    
</body>
</html>