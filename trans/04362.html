<html>
<head>
<title>How to create custom scikit-learn classification and regression models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建自定义scikit-学习分类和回归模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-custom-scikit-learn-classification-and-regression-models-70db7e76addd?source=collection_archive---------21-----------------------#2021-04-13">https://towardsdatascience.com/how-to-create-custom-scikit-learn-classification-and-regression-models-70db7e76addd?source=collection_archive---------21-----------------------#2021-04-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/2ea4c419afe9ab1a05d93e382ea87fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vhTPKa7J6-mt-wEJ"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">让-菲利普·德尔伯格在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="75e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit learn </a>是Python中标准机器学习模型的首选包。它不仅提供了您在实践中想要使用的大多数核心算法(即GBMs、随机森林、逻辑/线性回归)，而且还提供了用于特征预处理的各种转换(例如Onehot编码、标签编码)以及用于跟踪模型性能的度量和其他便利功能。但是，仍然会有你需要做一些稍微不同的事情的时候。在这些情况下，我经常<strong class="ki iu">仍然希望在scikit learn的通用API内工作</strong>。坚持使用scikit learn API有两个主要好处:</p><ol class=""><li id="1021" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">您可以与其他数据科学家共享您的模型，他们可能知道如何使用它，而无需您提供重要的文档。</li><li id="a3ae" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">您可以在包含其他scikit-learn操作的管道中使用它——至少对我来说，这是主要的好处。</li></ol><p id="326b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">幸运的是，实现定制模型非常简单，因此它可以像标准的scikit-learn模型一样工作。</p><h2 id="4fbd" class="ls lt it bd lu lv lw dn lx ly lz dp ma kr mb mc md kv me mf mg kz mh mi mj mk bi translated">实现自定义模型🚀</h2><p id="5f13" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld im bi translated">在scikit-learn API中实现定制模型可以使用下面的框架类来完成——一个用于分类，一个用于回归。基本上，您想做的任何事情都可以添加到<code class="fe mq mr ms mt b">init</code>、<code class="fe mq mr ms mt b">fit</code>、<code class="fe mq mr ms mt b">predict</code>和<code class="fe mq mr ms mt b">predict_proba</code>(用于分类器)方法中。通过继承<code class="fe mq mr ms mt b">BaseEstimator</code>、<code class="fe mq mr ms mt b">ClassifierMixin/RegressorMixin</code>，该类将与其他scikit-learn类具有互操作性，并且可以在scikit-learn管道中使用。</p><figure class="mu mv mw mx gt ju"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="439b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇<a class="ae kf" rel="noopener" target="_blank" href="/lesser-known-data-science-techniques-you-should-add-to-your-toolkit-a96578113350">帖子</a>中，你可以看到我是如何在实践中使用这个结构来定义定制的scikit-learn模型的。例如，下面的模型创建了一个树空间逻辑回归分类器:</p><figure class="mu mv mw mx gt ju"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="450f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，我将几个scikit-learn模型包装在一起。您可以看到,<code class="fe mq mr ms mt b">fit</code>方法将在输入上拟合一个<code class="fe mq mr ms mt b">GradientBoostedClassifier</code>,使用这个拟合的模型来转换输入，一个热编码这个转换，然后在输出上拟合一个<code class="fe mq mr ms mt b">LogisticRegression</code>。将它包装在一个单独的定制模型中比单独定义这些步骤要整洁得多。</p><p id="a732" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读——希望这对您有所帮助。</p></div></div>    
</body>
</html>