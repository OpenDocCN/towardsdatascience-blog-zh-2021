<html>
<head>
<title>Build Your First Mood-Based Music Recommendation System in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python构建你的第一个基于情绪的音乐推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-your-first-mood-based-music-recommendation-system-in-python-26a427308d96?source=collection_archive---------4-----------------------#2021-10-14">https://towardsdatascience.com/build-your-first-mood-based-music-recommendation-system-in-python-26a427308d96?source=collection_archive---------4-----------------------#2021-10-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="5394" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="3cc8" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用Spotify API从头开始基于音频的推荐</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/d6d2f9fd0d57d3dc1ea4f9fe759f86d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r73XfHG10vSxFr0JAIaehg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://www.pexels.com/de-de/@a-darmel" rel="noopener ugc nofollow" target="_blank">阿莱娜·达梅尔</a>拍摄</p></figure><h1 id="02e1" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">为什么要建立基于情绪的推荐系统？</h1><p id="8ab4" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">虽然音乐流派在建立和展示社会身份方面发挥着巨大的作用，但在音乐偏好领域，歌曲的情感表达以及更重要的是，它对听众的情感印象往往被低估。</p><h2 id="ba9c" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">流派是不够的</h2><p id="15f8" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">仅仅几十年前，按流派和/或艺术家选择音乐是唯一的选择。想听现场音乐？好吧，选择一个艺术家或者一个典型的基于流派的节日。想买音乐？好吧，看看我们按流派分类的CD架，挑一张你喜欢的艺术家的专辑。随着数字音乐平台上定制或预先策划的播放列表和个人推荐的出现，这种情况发生了巨大变化。</p><p id="b96b" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">因此，如果你的目标是建立一个音乐推荐系统，你将需要找到一种超越流派标签的思维方式，并且——更困难的是——找到量化的方法来将你的想法实现为一个真正有用的推荐工具。推荐方法有两个主要分支:</p><h2 id="3874" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated"><strong class="ak">协同过滤:</strong></h2><p id="d86a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在这里，我们对用户行为进行建模，以预测在特定情况下特定用户在统计上可能喜欢什么。这包括“其他人也买了X”以及考虑到整体受欢迎程度。最后，一个随机的用户很可能比活结更喜欢德雷克。尤其是如果我们已经知道他喜欢其他说唱艺人。</p><h2 id="d06c" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">基于内容的过滤</h2><p id="9c86" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">另一种方法是从音乐对象本身检索数据。这可以是元数据，如发行日期、指定的流派或歌曲发行时使用的标签。另一方面，我们也可以从音频本身检索出或多或少的抽象音乐特征。这包括明显的方面，如音调或速度，但也包括高度抽象的数学特征，如MFCCs，在某种程度上，它是对音乐音色的测量(GER:“Klangfarbe”，EN:“声音的颜色”)。</p><p id="a0e8" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在这篇文章中，我将向你展示一种无需任何机器学习就能构建有效推荐系统的简单方法。嗯……至少你那边没有。</p><h1 id="7e91" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">从哪里获取音频数据？</strong></h1><p id="03d6" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">使用现有算法或机器学习模型从<em class="nm"> MIR </em> ( <em class="nm">音乐信息检索</em>)研究中提取音频数据，对于该领域的初学者来说是一件困难的事情。幸运的是，一些聪明人构建了API来与我们分享他们的数据，这样我们就可以用它来构建创新技术。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nn"><img src="../Images/04656b4e61b180a2393ab063b5c6a680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LE0SwgQr7yBf9sTcQEu9PA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd no">图1: </strong>节选Spotify Web API关于<a class="ae lh" href="https://developer.spotify.com/discover/" rel="noopener ugc nofollow" target="_blank">可用音频功能的文档</a>。</p></figure><p id="a5f8" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">Spotify Web API是一个很好的起点。它可以免费使用，正如你在<strong class="mc jd">图1 </strong>中看到的，它提供了多种情绪特征，这些特征是从它们内部的机器学习模型中提取出来的。但是，我们究竟如何用“可跳舞性”、“效价”、“能量”和“节奏”(后者很难被视为情绪特征)来模拟情绪的复杂性呢？实际上，<strong class="mc jd">我们只需要其中的两个</strong>。</p><h1 id="cf23" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">心理学:效价唤醒平面</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi np"><img src="../Images/aedad373e5ff7a0761682515649478b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ch94qXPba4KQOcf_FkBcfw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd no">图2: </strong>价唤醒平面和其上几种情绪/心境的位置(改编自Russel，1980)</p></figure><p id="5115" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">情绪的因素结构(即情绪存在多少个独立维度)的一个占主导地位的心理学模型是<strong class="mc jd">价-唤醒平面(图2)。</strong>这是一个二维模型，将每一种现有的情绪或心情还原为其唤醒成分(这种感觉是高能还是低能？)及其化合价成分(感觉好还是不好？).尽管这种模式并非没有问题(例如，恐惧和愤怒在这里会被放在一起)，但它被广泛采用，因为它在复杂性和预测能力之间取得了巨大的平衡。</p><p id="5217" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">这里令人惊讶的是，我们可以很好地采用价-唤醒平面模型，使用Spotify API的“价”和“能量”功能。在本文的其余部分，我将介绍如何从API抓取数据，以及如何用它实现一个简单有效的推荐系统。</p><h1 id="fd77" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">如何使用Spotify API创建数据集</strong></h1><h2 id="8cd9" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated"><strong class="ak">授权(烦人的部分)</strong></h2><p id="3b15" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">让我们从最无趣的部分开始:要访问Spotify API，你需要按照本指南<a class="ae lh" href="https://developer.spotify.com/documentation/general/guides/authorization-guide/" rel="noopener ugc nofollow" target="_blank">注册一个应用程序</a>。或者，看看<a class="ae lh" href="https://medium.com/@maxtingle/getting-started-with-spotifys-api-spotipy-197c3dc6353b" rel="noopener">这篇中型文章</a>，其中很好地说明了这个过程。我知道你只是想开始，但不幸的是，你必须先通过认证。一旦您有了自己的客户ID和客户机密ID，我将为您提供创建推荐数据集所需的所有代码。这听起来像交易吗？</p><h2 id="fc4f" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">代码准备</h2><p id="f464" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">为了建立一个推荐系统，我们需要一个曲目数据库，从中我们可以挑选出最适合给定曲目的曲目。为此，您只需要Python包<a class="ae lh" href="https://github.com/felix-hilden/tekore" rel="noopener ugc nofollow" target="_blank"> <em class="nm"> tekore </em> </a> ( &lt; pip在您的终端中安装tekore &gt;)、您的Spotify客户端ID和Secret ID，以及我将向您提供的代码。</p><p id="8db5" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">首先，请在项目目录中创建一个名为“authorization.py”的新python脚本，并用以下代码填充它:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="aaff" class="mw lj it nr b gy nv nw l nx ny">import tekore as tk</span><span id="5687" class="mw lj it nr b gy nz nw l nx ny">def authorize():<br/> CLIENT_ID = “ENTER YOUR CLIENT ID HERE”<br/> CLIENT_SECRET = “ENTER YOUR CLIENT SECRET HERE”<br/> app_token = tk.request_client_token(CLIENT_ID, CLIENT_SECRET)<br/> return tk.Spotify(app_token)</span></pre><p id="f2cd" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">只需输入您的客户ID和客户密码ID，代码中会这么说。这个脚本只做一件事:它授权您访问Spotify API，并返回一个允许您访问API的对象。该脚本充当我们的主程序的助手脚本。然而，主要的是，它确保你的客户ID和秘密ID对主程序的读者/用户是隐藏的。只有这样我才能和你分享我的全部代码。</p><h2 id="a775" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">获取Spotify数据集</h2><p id="86a0" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">当然，有很多方法可以收集数据集。我们将使用一种方法，从超过120个流派中抽取100首曲目，从而产生一个包含各种风格音乐的约12000首曲目的曲目数据库。</p><p id="5ee0" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">如果你还没有安装软件包<em class="nm">熊猫</em>和<em class="nm"> tqdm </em>的话，你需要通过&lt; pip install【软件包名称】&gt;来安装它们。从那里，只需复制并运行下面的代码和/或按照我的代码快速概述。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h2 id="1d08" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">如果您只想复制代码，请跳过这一步</h2><p id="8f9d" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">算法是这样工作的:我们使用助手脚本来授权我们的API访问。然后，我们使用<sp.recommendation_genre_seeds>获取Spotify的所有120个流派标签，并将每个流派的推荐数量设置为100(这是可能的最大数量)。下一步，我们建立一个字典，它可以保存我们想要抓取的所有数据。接下来，我们循环播放每个流派，然后播放该流派的每首曲目。对于这些音轨，我们抓取元数据和音频信息，并将它们存储在我们之前创建的<data_dict>中。然后，我们将字典转换成pandas数据帧，删除重复的id，最后将数据帧导出到我们的工作目录。</data_dict></sp.recommendation_genre_seeds></p><p id="df71" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated"><strong class="mc jd">惊艳！</strong>你知道你的工作目录中有一个名为“valence _唤醒_数据集. csv”的数据集。接下来，我们将使用这个数据集来构建我们的推荐系统。</p><h1 id="9a37" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">如何使用效价和唤醒度进行推荐</h1><h2 id="87a7" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">基本思想:向量距离</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/80057885739cd91211971655535cf6ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wBVG7Iv7CIhJFpfPSM8Gxw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd no">图3: </strong>应用于一些知名歌曲的价唤醒平面上的距离(仅估计位置)</p></figure><p id="83df" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">如果你看一下<strong class="mc jd">图3 </strong>，我们的相似性度量就很容易理解。在那里，我估计了几首著名歌曲在效价唤醒平面上的位置。在这个平面上，每个向量(一条轨迹，其坐标为“价”和“唤醒”)，在这个例子中是托托的“罗莎娜”，可以通过一条线与其他轨迹相连。从视觉上看，很明显，迈克尔·杰克逊的“颤栗”的情感轮廓更类似于“罗珊娜”，而不是平面上更远的所有其他曲目。</p><p id="01e8" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">数学上，连接每条轨道的线也是向量，我们可以测量它们的长度。2D向量(a，b)的长度或“范数”被定义为<em class="nm"> sqrt(a +b ) </em>。假设一个轨道有0.5个“价”和1个“能”，因此坐标是(0.5，1)。那么，它的长度，也就是它到坐标系原点(点(0，0))的距离，等于<em class="nm"> sqrt((0.5) + 1 </em>，大约是1.12。因此，我们所需要的是找到连接一个给定轨迹和所有其他轨迹的所有向量(箭头)，应用公式并取具有最低范数/长度的箭头。</p><p id="1e38" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">从点<em class="nm"> p1 </em>到点<em class="nm"> p2 </em>的这个“箭头向量”由<em class="nm"> p2-p1给出。</em>因此，轨迹T1和轨迹t2之间基于情绪的“距离”等于norm(t2-t1)。换句话说，从t2中减去t1，然后使用上面的公式计算得到的向量的范数。在Python代码中，这很容易实现:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="1df2" class="mw lj it nr b gy nv nw l nx ny">def distance(p1, p2):<br/>    distance_x = p2[0]-p1[0]<br/>    distance_y = p2[1]-p1[1]<br/>    distance_vec = [distance_x, distance_y]<br/>    norm = (distance_vec[0]**2 + distance_vec[1]**2)**(1/2)<br/>    return norm</span></pre><p id="e092" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在我的代码中，我使用numpy.linalg.norm(p2-p1)，它做同样的事情。</p><h2 id="59b4" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">一些统计问题</h2><p id="4dbe" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在我们进入推荐系统的实际实现之前，我想向您指出我们的系统将要面临的两个统计问题。如果你真的不在乎，就跳过这一部分，或者以后再来。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/40077d9d5071ee81cbef36cdf5b526be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwDKVYCHFzFmnzlFYuU9sw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd no">图4: </strong>“化合价”和“能量”特征的分布。</p></figure><p id="5781" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">正如您在图4 中看到的，这两个特性的分布完全不同。虽然“化合价”似乎遵循某种近似非常平坦的正态分布，但“能量”却严重左倾。这对于我们的模型来说有一个主要的缺点:在不涉及太多统计细节的情况下，这意味着:“化合价”0.2的“跳跃”并不总是与“能量”0.2的跳跃是一回事。然而，我们的模型假设向量(0.5，0.5)与(0.7，0.5)一样接近。如果你想解决这个冲突，应用一个<a class="ae lh" href="https://medium.com/analytics-vidhya/z-score-in-detail-9dd0f0afa142" rel="noopener"> <em class="nm"> z变换</em> </a>会有所帮助。出于本文的目的，我们将忽略这个问题。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/f80782a1d3589a2f179254ae3e4ad1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r0amqj1sf0g8jav8vJob9w.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd no">图5: </strong>“化合价”与“能量”的相关性与线性回归线。</p></figure><p id="1a75" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">另一个问题如图5所示。在心理学理论中，效价和唤醒被认为是情绪的两个统计上独立的维度。然而，如果我们将数据集中的所有12，000首曲目绘制成“能量-价”平面，我们会看到随着“价”的增加，“能量”也会增加。事实上，发现回归斜率为0.250，这表明两个特征之间存在不可忽略的相关性。不幸的是，这个问题没有解决方案，因为这个错误(至少对我们来说)是内置在Spotify API中的。</p><h1 id="6d61" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">最终推荐算法</h1><p id="5531" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">从这一点开始，构建最终的推荐算法就很简单了。我将指导您完成本部分的最后几个步骤。你也可以跟着<a class="ae lh" href="https://github.com/MaxHilsdorf/mood-based-music-recommendation-system/blob/main/recommendation_system.ipynb" rel="noopener ugc nofollow" target="_blank">一起看这个笔记本</a>。</p><p id="b46e" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">首先，我们导入一些模块:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="a9da" class="mw lj it nr b gy nv nw l nx ny">import pandas as pd<br/>import random<br/>import authorization # this is the script we created earlier<br/>import numpy as np<br/>from numpy.linalg import norm</span></pre><p id="a08c" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">接下来，我们读入大约12000个磁道的数据帧:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="bdc8" class="mw lj it nr b gy nv nw l nx ny">df = pd.read_csv("valence_arousal_dataset.csv")</span></pre><p id="6013" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在，我们将“价”和“能量”列组合起来，形成每个音轨的单个向量“情绪_vec ”:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="fc1f" class="mw lj it nr b gy nv nw l nx ny">df["mood_vec"] = df[["valence", "energy"]].values.tolist()</span></pre><p id="673f" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">我们实施推荐算法之前的最后一步是授权您的Spotify API访问，就像我们之前做的那样:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="ad17" class="mw lj it nr b gy nv nw l nx ny">sp = authorization.authorize()</span></pre><p id="8a76" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">最后，是时候实现我们的基于向量距离的推荐算法了。该算法采取的步骤是:</p><ol class=""><li id="d334" class="of og it mc b md nh mg ni mj oh mn oi mr oj mv ok ol om on bi translated">从Spotify API抓取输入音轨的“价”和“能量”值</li><li id="6bd2" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated">计算输入轨迹和参考数据集中所有其他轨迹之间的距离。</li><li id="a315" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated">从最低到最高距离对参考轨迹进行排序。</li><li id="ebd3" class="of og it mc b md oo mg op mj oq mn or mr os mv ok ol om on bi translated">返回n条最近的轨迹。</li></ol><p id="8291" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">代码是:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h1 id="6450" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">测试推荐算法</h1><p id="e3a3" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">剩下要做的就是测试我们的算法是否产生有意义的结果！每个Spotify曲目作为一个ID，您可以像这样简单地从web浏览器中提取:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/587fc4fb1b8ada30ad82a63afe338135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DFJSCMTjU2Y38gPTc2fKKw.png"/></div></div></figure><p id="4c78" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">这就给你带来了https://open.spotify.com/track/3JOVTQ5h8HGFnDdp4VT3MP?的<a class="ae lh" href="https://open.spotify.com/track/3JOVTQ5h8HGFnDdp4VT3MP?si=96f7844315434b0a" rel="noopener ugc nofollow" target="_blank">si=96f7844315434b0a </a>"其中"<a class="ae lh" href="https://open.spotify.com/track/3JOVTQ5h8HGFnDdp4VT3MP?si=96f7844315434b0a" rel="noopener ugc nofollow" target="_blank"> 3JOVTQ5h8HGFnDdp4VT3MP </a>"为曲目ID。</p><h2 id="bba4" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">加里·朱尔斯的《疯狂的世界》</h2><p id="af17" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">那么我们把加里·朱尔斯的《疯狂的世界》("化合价" = 0.30，"能量" = 0.06)扔到我们的推荐者里怎么样？</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ou ob l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Spotify嵌入加里·朱尔斯的《疯狂世界》。</p></figure><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="1297" class="mw lj it nr b gy nv nw l nx ny">mad_world = "3JOVTQ5h8HGFnDdp4VT3MP"<br/>recommend(track_id = mad_world, ref_df = df, sp = sp, n_recs = 5)</span></pre><p id="1be2" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">“化合价”= 0.31，“能量”= 0.05的最佳推荐是亨瑞·贝拉方特的《荣耀经理》。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ou ob l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Spotify嵌入亨瑞·贝拉方特的《光荣的马槽》。</p></figure><p id="3723" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">还不错！虽然“荣耀经理”来自完全不同的流派，但我们的算法已经匹配了这些歌曲，因为它们都具有相似的“价”和“能量”水平。</p><h2 id="55ac" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">托托的《罗珊娜》</h2><p id="9d43" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">让我们再举一个例子！托托的《罗珊娜》“化合价”为0.739，“能量”为0.513。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ou ob l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Toto的《罗珊娜》的Spotify嵌入。</p></figure><p id="809f" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">最受欢迎的推荐是由Duelo创作的“Sentimientos De Chartón ”,其“化合价”为0.740，“能量”为0.504。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ou ob l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Spotify嵌入Duelo的“Sentimientos De Chartón”。</p></figure><p id="f278" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">再一次，音乐类型非常不同，更像是“拉丁”而不是“流行摇滚”。然而，《Sentimientos De Cartón》捕捉到了这种“浪漫渴望”的感觉，同时仍传达出一种运动感和最佳状态，就像《罗珊娜》一样。</p><h1 id="b9cc" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">结论和最终想法</h1><p id="be0b" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated"><strong class="mc jd">恭喜你！</strong>如果你一直关注这篇文章，那么你要么已经建立了你的第一个基于情绪的推荐系统，要么至少已经了解了一点如何编写这样一个系统。然而，仍有一些事情值得简要地思考或讨论。</p><h2 id="b2b5" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">我们取得了什么成就？</h2><p id="a283" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我们一起建立了音乐推荐系统的基础，该系统使用“价-唤醒平面”的适应以及向量距离测量来匹配传达相似类型情感/情绪的曲目。这种方法从根本上不同于协作过滤方法(“其他用户也购买了[…]”)，因为它试图提取歌曲的内在品质，而不依赖于用户数据。这对于你们(像我一样)没有运营大型音乐平台，拥有数十亿相关用户数据点的人来说，尤其有帮助。另一个好处是，这种方法的实现是快速和免费的，从收集数据到实现实际的推荐算法。最后，跨流派类别推荐音乐是任何现实世界推荐系统的期望品质，因为这支持用户参与新类型的音乐并发展他们的个人音乐品味。</p><h2 id="93db" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">我该如何改进这个推荐系统？</h2><p id="1e41" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">正如在统计一节中提到的，<strong class="mc jd">对“价”和“能量”特征进行“z变换”</strong>将使您的距离测量更准确，从而使您的推荐更准确。</p><p id="77f4" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">Spotify API提供了更多功能，如“可跳舞性”、“声音”和“速度”。试着想出合理的方法来<strong class="mc jd">扩展“价-唤醒平面”</strong>或者从零开始开发你自己的变量集。</p><p id="7e56" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">将基于情绪的方法与协作过滤方法结合起来也是一种有趣的探索。怎么样，在我们使用“价”和“能量”计算出前10个推荐之后，我们<strong class="mc jd">按照“流行度”</strong>对推荐重新排序(这也是Spotify API中的一个功能)。</p><p id="a39a" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">你可以让用户<strong class="mc jd">决定一组所有推荐都必须是</strong>的类型，或者一组不应该出现在推荐中的类型。</p><p id="15cb" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">最后，你可以通过探索Spotify API的可能性和分析越来越多的歌曲来扩展你的参考数据集。较大的数据库更有可能为每个输入轨迹准备一个近乎完美的匹配。</p><blockquote class="ov ow ox"><p id="cea6" class="ma mb nm mc b md nh kd mf mg ni kg mi oy nj ml mm oz nk mp mq pa nl mt mu mv im bi translated"><strong class="mc jd">非常感谢你阅读这篇文章！如果您有任何问题或意见，或者有任何不正常的地方，请告诉我。我目前正在探索创造性的方法，使用自建的机器学习模型来扩展这里显示的推荐系统。如果你想看的话，请继续关注！</strong></p></blockquote></div></div>    
</body>
</html>