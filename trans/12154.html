<html>
<head>
<title>Using pointers in C</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在C #中使用指针</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-pointers-in-c-95ba8802e3d4?source=collection_archive---------15-----------------------#2021-12-08">https://towardsdatascience.com/using-pointers-in-c-95ba8802e3d4?source=collection_archive---------15-----------------------#2021-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fa56" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">简介</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b44a1a67cf4ab364a279ef40fb0dfe0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nRgGdbwL2Qj5gIi3SvO-7Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">亚历山大·巴甫洛夫·波德瓦尼摄于Pexels</p></figure><p id="3ee1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设您熟悉编程概念，并熟悉Python或r等现代高级语言。C编程语言自20世纪70年代初就已出现，是一种通用编程语言，用于从网络编程到视频游戏，再到数据科学的各种用途。与Python等语言不同，C是一种编译语言。这意味着它通常需要更长的开发时间，因为每次运行时都需要编译。另一方面，最终编译的程序将比解释语言运行得快得多。一些依赖于性能的Python包，如<strong class="kx ir"> numpy </strong>和<strong class="kx ir"> pandas </strong>有一部分是用C语言编写的，C也可以用来创建速度很重要的数据产品。C语言的一个特点是它使用指针。这篇简短的文章将通过几个例子介绍C语言中的指针。</p><p id="f944" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们首先快速浏览一个基本的C程序及其结构。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="e92d" class="lw lx iq ls b gy ly lz l ma mb">#include &lt;stdio.h&gt;</span><span id="f765" class="lw lx iq ls b gy mc lz l ma mb">int main(void);</span><span id="c08a" class="lw lx iq ls b gy mc lz l ma mb">int main(void)<br/>{<br/>    printf("Hello world\n\r");<br/>    return 0;<br/>}</span></pre><p id="2fb5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于不熟悉C语言的人来说，上面的程序会在屏幕上显示消息“Hello world”。第一行包括标准的输入和输出头文件，其中包含有用的函数，如用于输出消息的<strong class="kx ir"> printf() </strong>。下一行是一个函数原型，告诉编译器将有一个名为main的函数，它将返回一个整数值，并且不带任何参数。其次是函数本身。所有的C程序都需要一个名为“main”的函数，它是第一个被执行的函数。在函数内部(由左大括号和右大括号{})我们有main函数的主体，它使用<strong class="kx ir"> printf() </strong>函数显示文本字符串“Hello world ”,后跟换行符“\n”和返回符“\r”。最后返回数字零。这可以用来检查程序是否仍在运行。</p><h2 id="b879" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">什么是指针？</h2><p id="b410" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">指针是一种变量，它允许我们通过内存中的地址来存储另一个变量在内存中的位置。变量名就像是我们引用这个位置的标签，所以我们可以访问存储在那个位置的值。在C语言中可以使用指针，原因有很多，包括:</p><ul class=""><li id="f3ad" class="mz na iq kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated">微控制器编程</li><li id="a90a" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">创建动态数据结构(如链表)</li><li id="9908" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">访问存储在数组中的信息</li><li id="cf5e" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">优化程序以运行更快和/或使用更少的内存</li></ul><p id="4914" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们声明一个整数变量，并将其命名为<strong class="kx ir"> num </strong>，我们可以给它赋值(例如10):</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="7d58" class="lw lx iq ls b gy ly lz l ma mb">int num = 10;</span></pre><p id="286d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这类似于创建一个“盒子”来存储值，并给这个盒子一个标签来引用里面的值，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/0734e7bec95a3c79a7373fa48e7c9e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*A377mKWXxV2mv6dvgwKTyg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="0dab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们实际上可以使用C语言中的&amp;符号(操作符的地址)输出变量存储的地址(内存中的位置)。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="a422" class="lw lx iq ls b gy ly lz l ma mb">printf("Address of num is %p", &amp;num);</span></pre><p id="ef3e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这给出了输出:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="0002" class="lw lx iq ls b gy ly lz l ma mb">Address of num is 0x7ffe472b7514</span></pre><p id="8b80" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当然，根据数据在实际设备内存中的存储位置，这个输出在不同的机器上会有所不同。指针是为处理这种类型的数据而设计的，可以在C语言中通过在变量名前加一个星号(*)来声明，也称为间接或取消引用运算符，因为它是间接工作的。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="e4b2" class="lw lx iq ls b gy ly lz l ma mb">int *ptr = &amp;num;</span></pre><p id="ecf5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里我们创建一个指向整数的指针(指针类型必须与它所指向的对象类型相同)并用变量<strong class="kx ir"> num </strong>的地址初始化它。下图以图形方式显示了这一点，其中方框代表内存中的位置。我们可以在盒子的前面看到变量名，在盒子的顶部看到存储的内容。你可以看到变量<strong class="kx ir"> num </strong>存储在内存中的位置0x7ffe472b7514，这也是指针变量的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/0e9bbca09453c5e0a8d66efdff7cac63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vfR3yjrwphVSwYCjgPK2GQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="93b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这允许我们通过指针间接地操作存储在那个位置的值。</p><p id="dbdb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以写一个简短的程序来输出变量的值、变量的地址、指针以及指针所指向的值:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="9ab1" class="lw lx iq ls b gy ly lz l ma mb">#include &lt;stdio.h&gt;</span><span id="9d1f" class="lw lx iq ls b gy mc lz l ma mb">int main(void);</span><span id="c0a8" class="lw lx iq ls b gy mc lz l ma mb">int main(void)<br/>{<br/>    int num = 10;<br/>    int *ptr = &amp;num;</span><span id="44c5" class="lw lx iq ls b gy mc lz l ma mb">    printf("Value of num = %d", num);<br/>    printf("\n\rAddress = %p", &amp;num);<br/>    printf("\n\rPointer ptr = %p", ptr);<br/>    printf("\n\rValue pointer is pointing at = %d", *ptr);<br/>    <br/>    return 0;<br/>}</span></pre><p id="419f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">百分比符号是占位符，指示要放在文本字符串中的值的类型。<strong class="kx ir"> %d </strong>用于整数，<strong class="kx ir"> %p </strong>用于指针的值。该代码产生以下输出:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="a179" class="lw lx iq ls b gy ly lz l ma mb">Value of num = 10<br/>Address = 0x7ffe472b7514<br/>Pointer ptr = 0x7ffe472b7514<br/>Value pointer is pointing at = 10</span></pre><h2 id="455b" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated"><strong class="ak">这有什么帮助？</strong></h2><p id="d317" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">本质上，你可以使用一个指针指向任何相同类型的变量(例如，任何整数、双精度、字符等)。).这可用于改变/更新相同类型的许多不同变量的值。使用指针时，执行时间也更快。更有效地访问存储器。它们还可以用来访问数组和结构的元素，并通过引用而不是通过值将参数传递给函数。它们对于需要访问特定内存位置的低级编程任务也很有用。我们将快速浏览一下其中的一些特性。</p><h2 id="4d8e" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">指针符号</h2><p id="c1c9" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">可以用几种不同的方式声明指针。以下两个例子都是有效的:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="b272" class="lw lx iq ls b gy ly lz l ma mb">int* p = &amp;i;</span></pre><p id="741d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">或者</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="7e20" class="lw lx iq ls b gy ly lz l ma mb">int *p = &amp;i;</span></pre><p id="aa7a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您还可能遇到箭头操作符(-&gt;)，它与指向结构或联合的指针变量一起使用。</p><p id="3c9f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">结构是允许几种不同的变量类型一起存储在单个数据结构中的数据结构。在这个例子中，我们创建了一个名为<strong class="kx ir"> person </strong>的结构，它包含一个由100个字符组成的数组(一个字符串)来表示这个人的名字，一个整数表示他们的年龄，一个浮点数表示他们的薪水。然后，我们创建一个指向这个名为<strong class="kx ir"> deptManager </strong>(部门经理)的结构的指针，并将其设置为<strong class="kx ir"> NULL </strong>。在main函数中，我们使用内存分配函数<strong class="kx ir"> malloc </strong>为这个结构创建一些内存，然后使用指针的名称，后跟箭头操作符来提供姓名、年龄和薪水的值。我们使用字符串库(string.h)中的字符串复制函数(<strong class="kx ir"> strcpy </strong>)将名称值复制到字符串变量中。最后，我们用<strong class="kx ir"> printf </strong>函数输出这些值。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="2ff7" class="lw lx iq ls b gy ly lz l ma mb">#include &lt;stdio.h&gt;<br/>#include &lt;string.h&gt;</span><span id="55cb" class="lw lx iq ls b gy mc lz l ma mb">int main(void);</span><span id="f3a3" class="lw lx iq ls b gy mc lz l ma mb">struct person {<br/>    char name[100];<br/>    int age;<br/>    float salary;<br/>};</span><span id="7867" class="lw lx iq ls b gy mc lz l ma mb">struct person *deptManager = NULL;</span><span id="992c" class="lw lx iq ls b gy mc lz l ma mb">int main(void)<br/>{<br/>    deptManager = (struct person*)malloc(sizeof(struct person));<br/>    strcpy(deptManager-&gt;name, "Derek Sanders");<br/>    deptManager-&gt;age = 47;<br/>    deptManager-&gt;salary = 22.000;</span><span id="b44b" class="lw lx iq ls b gy mc lz l ma mb">    printf("Department manager's name = %s", deptManager-&gt;name);<br/>    printf("\n\rDepartment manager's age = %d", deptManager-&gt;age);<br/>    printf("\n\rDepartment manager's salary = %f", deptManager-&gt;salary);<br/>    <br/>    return 0;<br/>}</span></pre><p id="aad8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">哪些输出:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="87b0" class="lw lx iq ls b gy ly lz l ma mb">Department manager's name = Derek Sanders<br/>Department manager's age = 47<br/>Department manager's salary = 22.000</span></pre><p id="42a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">写<strong class="kx ir"> deptManager- &gt;年龄</strong>与写<strong class="kx ir"> (*deptManager)相同。年龄</strong></p><p id="f6dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您还可以通过在变量前添加更多星号来创建指针对指针等:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="65b8" class="lw lx iq ls b gy ly lz l ma mb">*p;<br/>**p;<br/>***p;<br/>…</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/b0049f73c58a6de4a52219e3bd64e224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ERv2Vxvt8MK3FvJf3WTKQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="0925" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated"><strong class="ak">指针和数组</strong></h2><p id="61e4" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">我们也可以在数组中使用指针。例如——我可以使用一个字符数组生成一个文本字符串，并将其命名为<strong class="kx ir"> myName </strong>，将其值设置为我的名和姓。我可以使用索引(在C中从0开始)来访问数组的元素。为了得到字母“A”，我可以输出数组的第一个元素<strong class="kx ir">我的名字【0】</strong>。这种表示法掩盖了指针的使用，所以我们可以使用指针表示法来达到同样的目的:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="a08b" class="lw lx iq ls b gy ly lz l ma mb">int main(void)<br/>{<br/>  char myName[] = "Alan Davies";</span><span id="814b" class="lw lx iq ls b gy mc lz l ma mb">  printf("The first letter of my name is %c", myName[0]);<br/>  printf("\n\rThe first letter of my name is %c", *(myName));<br/>  printf("\n\rThe first letter of my surname is %c", myName[5]);<br/>  printf("\n\rThe first letter of my surname is %c", *(myName + 5));</span><span id="76fe" class="lw lx iq ls b gy mc lz l ma mb">  return 0;<br/>}</span></pre><p id="2036" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于后续元素，我们可以只添加索引，因此对于第5个元素“D ”,我们可以添加5，以此类推。这会产生以下输出:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="356b" class="lw lx iq ls b gy ly lz l ma mb">The first letter of my name is A<br/>The first letter of my name is A<br/>The first letter of my surname is D<br/>The first letter of my surname is D</span></pre><p id="aa17" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这也可以应用于更高维的阵列。我们可以编写一个程序来创建一个8×8的矩阵，并用随机数填充它。我们可以这样做:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="1443" class="lw lx iq ls b gy ly lz l ma mb">#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;</span><span id="94cc" class="lw lx iq ls b gy mc lz l ma mb">int main(void);</span><span id="cd3c" class="lw lx iq ls b gy mc lz l ma mb">int main(void)<br/>{<br/>    int x, y;<br/>    int data[8][8];</span><span id="1617" class="lw lx iq ls b gy mc lz l ma mb">    for(x=0; x&lt;8; x++)<br/>    {<br/>        for(y=0; y&lt;8; y++)<br/>        {<br/>            data[x][y] = rand()%100;<br/>        }<br/>    }<br/>    return 0;<br/>}</span></pre><p id="49a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里我们声明一个二维数组来存储矩阵值。然后，我们使用两个for循环遍历矩阵中的行和列，使用来自<strong class="kx ir"> stdlib </strong>库的<strong class="kx ir"> rand() </strong>函数添加一个随机数。这可能会产生类似下面的if输出。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="5ff9" class="lw lx iq ls b gy ly lz l ma mb">49 21 62 27 90 59 63 26<br/>40 26 72 36 11 68 67 29<br/>82 30 62 23 67 35 29 2<br/>22 58 69 67 93 56 11 42<br/>29 73 21 19 84 37 98 24<br/>15 70 13 26 91 80 56 73<br/>62 70 96 81 5 25 84 27</span></pre><p id="c88c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以使用指针用更紧凑的代码实现同样的事情:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="df85" class="lw lx iq ls b gy ly lz l ma mb">#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;</span><span id="e306" class="lw lx iq ls b gy mc lz l ma mb">int main(void);</span><span id="c7f1" class="lw lx iq ls b gy mc lz l ma mb">int main(void)<br/>{<br/>    int i, data[8][8];</span><span id="d284" class="lw lx iq ls b gy mc lz l ma mb">    for(i=0; i&lt;64; i++)<br/>        *(*data + i) = rand()%100;<br/>    <br/>    return 0;<br/>}</span></pre><p id="d4de" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个例子中，我们使用指针指向内存中的矩阵位置，并为每个矩阵元素生成一个随机数。这与前一个例子归档了相同的最终目标，但是使用了指针。</p><p id="1d78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用指针访问多维数组中的数据有几种不同的方式。例如，要获取第一行和第一列中的元素，我们通常会写:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="4da6" class="lw lx iq ls b gy ly lz l ma mb">data[0][0]</span></pre><p id="e7e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以写:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="f897" class="lw lx iq ls b gy ly lz l ma mb">*data[0]</span></pre><p id="8e2b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">或者甚至:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="b453" class="lw lx iq ls b gy ly lz l ma mb">**data</span></pre><p id="abc4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于零以上的元素，如<strong class="kx ir"> data[0][1] </strong>，我们可以编写以下任何一个:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="d279" class="lw lx iq ls b gy ly lz l ma mb">data[0][1]<br/>*(data[0] + 1)<br/>*(*data + 1)</span></pre><h2 id="1702" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated"><strong class="ak">指针和变量范围</strong></h2><p id="a542" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">指针的另一个有用的方面与变量范围有关。假设您想创建一个简单的函数，将传递给它的变量的值加倍。您可以编写一个简单的函数，将数字作为参数，然后将值加倍并输出。如果在调用double函数之前和之后输出变量的值，变量的值将保持不变，因为我们没有更新原始变量的值。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="7278" class="lw lx iq ls b gy ly lz l ma mb">#include &lt;stdio.h&gt;</span><span id="7277" class="lw lx iq ls b gy mc lz l ma mb">int main(void);<br/>void doubleVariable(int);</span><span id="f163" class="lw lx iq ls b gy mc lz l ma mb">void doubleVariable(int var)<br/>{<br/>    var = var * 2;<br/>    printf("\n\rvariable = %d", var);<br/>}</span><span id="a43e" class="lw lx iq ls b gy mc lz l ma mb">int main(void)<br/>{<br/>    int num = 10;</span><span id="157f" class="lw lx iq ls b gy mc lz l ma mb">    printf("num = %d", num);<br/>    doubleVariable(num);<br/>    printf("\n\rnum after doubling = %d", num);<br/>    <br/>    return 0;<br/>}</span></pre><p id="4deb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，输出将是:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="b2e0" class="lw lx iq ls b gy ly lz l ma mb">num = 10<br/>variable = 20<br/>num after doubling = 10</span></pre><p id="5dc9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们想更新原始值，我们可以改变程序来使用指针。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="20fd" class="lw lx iq ls b gy ly lz l ma mb">#include &lt;stdio.h&gt;</span><span id="5f03" class="lw lx iq ls b gy mc lz l ma mb">int main(void);<br/>void doubleVariable(int*);</span><span id="b461" class="lw lx iq ls b gy mc lz l ma mb">void doubleVariable(int *var)<br/>{<br/>    *var = *var * 2;<br/>    printf("\n\rvariable = %d", *var);<br/>}</span><span id="8ea4" class="lw lx iq ls b gy mc lz l ma mb">int main(void)<br/>{<br/>    int num = 10;</span><span id="9083" class="lw lx iq ls b gy mc lz l ma mb">    printf("num = %d", num);<br/>    doubleVariable(&amp;num);<br/>    printf("\n\rnum after doubling = %d", num);</span><span id="81ad" class="lw lx iq ls b gy mc lz l ma mb">    return 0;<br/>}</span></pre><p id="e213" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它产生:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="f24a" class="lw lx iq ls b gy ly lz l ma mb">num = 10<br/>variable = 20<br/>num after doubling = 20</span></pre><p id="882e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意，C知道在乘法运算中使用星号和在基于上下文的指针中使用星号的区别。在这个例子中，我们将变量的地址传递给一个指针参数，它可以更新原始变量。在某些情况下，这可以作为创建全局变量的替代方法，并通过引用而不是通过值来传递变量。</p><h2 id="a808" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated"><strong class="ak">指针和字符串</strong></h2><p id="580c" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">C #中的字符串表示为字符数组。您可以明确指定在方括号之间使用多少个字符，或者由字符串的长度来定义:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="8d05" class="lw lx iq ls b gy ly lz l ma mb">char myStr[20] = "This is my string";<br/>char myStr[] = "This is my string";</span></pre><p id="2a45" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以更新这些字符串的值。例如，我们可以在原始字符串上复制一个新字符串:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="2829" class="lw lx iq ls b gy ly lz l ma mb">char myStr[20] = "This is my string";<br/>printf("myStr = %s", myStr);<br/>strcpy(myStr, "New string");<br/>printf("\n\rmyStr = %s", myStr);</span></pre><p id="3334" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它将输出:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="a80b" class="lw lx iq ls b gy ly lz l ma mb">myStr = This is my string<br/>myStr = New string</span></pre><p id="dda7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们也可以将指针与字符串一起使用:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="5f17" class="lw lx iq ls b gy ly lz l ma mb">char *newStr = "A new string";</span></pre><p id="f8e5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以用同样的方式输出字符串:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="7eec" class="lw lx iq ls b gy ly lz l ma mb">printf("\n\rnewStr = %s", newStr);</span></pre><p id="8528" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们不能像以前那样更新这个字符串。如果你以这种方式声明一个字符串，它被大多数编译器存储在只读存储器中，所以不能被更新。这对于创建不可变的字符串很有用。我们也可以使用内存分配函数为一个字符串创建可以访问的内存。然后我们可以更新字符串。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="686a" class="lw lx iq ls b gy ly lz l ma mb">char *newStr = (char*)malloc(sizeof(char)*4);<br/>newStr = "Alan";<br/>printf("String = %s", newStr);<br/>newStr = "Dave";<br/>printf("\n\rString = %s", newStr);</span></pre><p id="65fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用字符指针也适用于单个字符。当与string一起使用时，它们实际上指向一个空终止字符串的第一个字符(\0)。</p><p id="5dae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们可以用它们来节省内存。例如，假设我们有一个水果列表(一个字符串数组)。我们可以说明列表中有多少项(即5)，然后每个项有多少个字符(即15)。我们也可以像这样输出第一项“苹果”。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="d44d" class="lw lx iq ls b gy ly lz l ma mb">char fruitList[5][15] = {<br/>    "Apples",<br/>    "Pears",<br/>    "Oranges",<br/>    "Bananas",<br/>    "Mangos"<br/>};</span><span id="62cb" class="lw lx iq ls b gy mc lz l ma mb">printf("Fruit[0] is %s", fruitList[0]);</span></pre><p id="c1f7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里的缺点是，我们使用了比我们需要(即75字节)更多的字节(每个字符是一个字节)来存储数据，因为我们允许每个单词最多15个字符，即使他们不需要全部15个字符。我们可以通过使用指针来改进这一点，因此我们只使用我们需要的字节数:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="03b0" class="lw lx iq ls b gy ly lz l ma mb">char *fruitList[5] = {<br/>    "Apples",<br/>    "Pears",<br/>    "Oranges",<br/>    "Bananas",<br/>    "Mangos"<br/>};</span><span id="1831" class="lw lx iq ls b gy mc lz l ma mb">printf("Fruit[0] is %s", fruitList[0]);</span></pre><h2 id="6d03" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated"><strong class="ak">一句警告的话</strong></h2><p id="a92f" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">指针的误用也会导致问题。权力越大，责任越大——您可能会覆盖内存中存储的其他信息，带来灾难性的后果。当您声明一个指针并试图在指向某个地方之前更新它的值时，就会发生这种情况。例如:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="30ba" class="lw lx iq ls b gy ly lz l ma mb">int *p;<br/>*p = 10;</span></pre><p id="67fd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">应该是这样的:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="2946" class="lw lx iq ls b gy ly lz l ma mb">int i, *p;<br/>p = &amp;i;<br/>*p = 10;</span></pre><h2 id="23c3" class="lw lx iq bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated"><strong class="ak">总之</strong></h2><p id="6d08" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">c语言是一种编译语言，与许多其他现代语言相比，它更接近于计算机的一些低级功能。c程序编译运行很快。当我们需要为性能(例如实现机器学习算法)或用其他语言(例如Python)创建数据科学库编写最佳代码时，这可能特别有利。虽然指针最初很难掌握，但它是一个特别强大的工具，可以以多种不同的方式使用，包括优化程序以使用更少的内存和/或运行更快。</p></div></div>    
</body>
</html>