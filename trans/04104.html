<html>
<head>
<title>A Complete Yet Simple Guide to Move from Excel to Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Excel迁移到Python的完整而简单的指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-complete-yet-simple-guide-to-move-from-excel-to-python-d664e5683039?source=collection_archive---------0-----------------------#2021-04-07">https://towardsdatascience.com/a-complete-yet-simple-guide-to-move-from-excel-to-python-d664e5683039?source=collection_archive---------0-----------------------#2021-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="23fe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用熊猫和Numpy代替Excel。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c3e357168c11cbf4de605777799e1e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmRGG86D5OMh1crRfOcExA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(Canva上制作)</p></figure><p id="22ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为一个使用Excel多年的人，我知道在像Python这样的全新环境中学习Excel/VBA中已经可以做的事情听起来并不令人兴奋。然而，Python环境提供的所有好处都使它物有所值。出于这个原因，我想出了一个有用而简单的指南，我希望当我从Excel转换到Python时就有了。</p><p id="459f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将使用Python的Pandas和Numpy库来替换您过去可能使用的许多Excel函数。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="76ba" class="lz ma it lv b gy mb mc l md me"><strong class="lv iu">Table of Contents<br/></strong>1. <a class="ae mf" href="#4dc0" rel="noopener ugc nofollow">The Dataset</a><br/>2. <a class="ae mf" href="#00e3" rel="noopener ugc nofollow">Sum, Average, Max, Min, Count</a><br/> - <a class="ae mf" href="#0d49" rel="noopener ugc nofollow">Columns (e.g. sum a column)</a><br/> - <a class="ae mf" href="#c754" rel="noopener ugc nofollow">Rows (e.g. sum a row)</a><br/>3. <a class="ae mf" href="#312b" rel="noopener ugc nofollow">IF</a><br/> - <a class="ae mf" href="#75c6" rel="noopener ugc nofollow">Replace IF with np.where</a><br/> - <a class="ae mf" href="#f528" rel="noopener ugc nofollow">Replace nested IF with np.select</a><br/>4. <a class="ae mf" href="#0a91" rel="noopener ugc nofollow">SumIf, CountIf, AverageIf</a><br/> - <a class="ae mf" href="#7c86" rel="noopener ugc nofollow">One condition (select a column with square brackets [ ] )</a><br/> - <a class="ae mf" href="#69f4" rel="noopener ugc nofollow">Two or more conditions (select columns and use &amp; or |)</a><br/>5. <a class="ae mf" href="#0cbd" rel="noopener ugc nofollow">Basic Data Cleaning</a><br/> - <a class="ae mf" href="#b662" rel="noopener ugc nofollow">Change the case of text with .str.lower, .str.upper or .str.title</a><br/> - <a class="ae mf" href="#64d6" rel="noopener ugc nofollow">Extract text in a column with .str.extract</a><br/> - <a class="ae mf" href="#e0a3" rel="noopener ugc nofollow">Identify whether a cell is empty with the .isnull method</a><br/>6. <a class="ae mf" href="#b306" rel="noopener ugc nofollow">Vlookup</a><br/> - <a class="ae mf" href="#071c" rel="noopener ugc nofollow">Find an element with .loc[ ]</a><br/> - <a class="ae mf" href="#e97b" rel="noopener ugc nofollow">Merge two tables with pd.merge or pd.concat</a><br/>7. <a class="ae mf" href="#09cd" rel="noopener ugc nofollow">Pivot Table</a><br/> - <a class="ae mf" href="#ac65" rel="noopener ugc nofollow">Use the .pivot_table method</a><br/>8. <a class="ae mf" href="#d450" rel="noopener ugc nofollow">Replace Excel Graphs with Python’s Matplotlib or Seaborn</a></span></pre><h1 id="4dc0" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">数据集</h1><p id="72a6" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">在本指南中，我们将使用. csv格式的Excel文件，这是处理数据集时通常使用的格式。该数据集由学生在各种科目中获得的分数组成，将帮助我们轻松地从Excel电子表格切换到Python的数据框架。你可以在<a class="ae mf" href="https://www.kaggle.com/spscientist/students-performance-in-exams" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>或者my <a class="ae mf" href="https://github.com/ifrankandrade/data_preprocessing.git" rel="noopener ugc nofollow" target="_blank"> Github </a>上下载这些数据(查看数据集文件夹)。</p><p id="d543" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从本指南开始，让我们导入Pandas和Numpy库。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="caa1" class="lz ma it lv b gy mb mc l md me">import pandas as pd<br/>import numpy as np</span></pre><p id="8959" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nc">注意:如果你没有在Python中安装那些库，你可以通过在你的终端或者命令提示符上写</em> <code class="fe nd ne nf lv b">pip install pandas</code>和<code class="fe nd ne nf lv b">pip install numpy</code> <em class="nc">来轻松安装。</em></p><p id="14b9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有了这个，我们就可以先看看数据了。为此，我们使用<code class="fe nd ne nf lv b">pd.read_csv()</code>。确保CSV和Python脚本位于相同的位置(相同的路径)。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="035b" class="lz ma it lv b gy mb mc l md me">df_excel = pd.read_csv('StudentsPerformance.csv')<br/>df_excel</span></pre><p id="4643" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦我们读取这个CSV文件，我们给它一个名字。在这种情况下，我将其命名为<code class="fe nd ne nf lv b">df_excel</code>。df代表dataframe，它是读取CSV文件后给出的典型名称。运行下面的代码后，我们获得了下面的输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/3734389f62b6247284d552dcef83cd24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kf6eEbxWV-wAXfd57bCjHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d394" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这看起来类似于Excel电子表格，但在这种格式下，更容易争论数据。现在我将向你展示如何用Python来做一些你可能在Excel中用过的常用函数。</p><h1 id="00e3" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">总和、平均值、最大值、最小值、计数</h1><p id="9948" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">Excel的常用函数可以很容易地替换为Pandas方法。让我们来看看。</p><h2 id="0d49" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">列(例如，对一列求和)</h2><p id="bf6a" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">如果我们想得到上面列出的大多数函数，我们使用<code class="fe nd ne nf lv b">.describe()</code>方法。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="5387" class="lz ma it lv b gy mb mc l md me">df_excel.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/1e4e9ff13a57849f876fbad9348d5ce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*1ZgS7IgEUbde5q0Uhsq4GQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="959a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如您所见，这样我们就可以得到所有数字列的计数、平均值、最大值和最小值。</p><p id="0753" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，如果我们想要选择一个特定的行，我们首先用方括号<code class="fe nd ne nf lv b">[ ] </code>选择，然后使用我们需要的方法(<code class="fe nd ne nf lv b">.sum()</code>、<code class="fe nd ne nf lv b">.mean()</code>等)。).比如，我们来计算数学成绩的平均值。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="67b3" class="lz ma it lv b gy mb mc l md me">In [1]: df_excel['math score'].mean()<br/>Out [1]: 66.089</span></pre><p id="42e6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些是你可以使用的一些其他方法。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="ba42" class="lz ma it lv b gy mb mc l md me">df_excel['math score'].mean()<br/>df_excel['math score'].max()<br/>df_excel['math score'].min()<br/>df_excel['math score'].count()</span></pre><h2 id="c754" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">行(例如，对一行求和)</h2><p id="d088" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">现在，假设我们要计算3个分数(数学、阅读和写作)的平均值。这些值在不同的列中，所以我们有两个选项。我们可以对每列求和</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="0c27" class="lz ma it lv b gy mb mc l md me">df_excel['average'] = (df_excel['math score'] + df_excel['reading score'] + df_excel['writing score'])/3</span></pre><p id="171c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者使用我们之前使用的方法对一列中的值求和，但是在这种情况下，我们添加了<code class="fe nd ne nf lv b">axis=1</code></p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="3c1e" class="lz ma it lv b gy mb mc l md me">df_excel['average'] = df_excel.mean(axis=1)</span></pre><p id="5ce5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在计算平均值时，我们还添加了一个新列<code class="fe nd ne nf lv b">[‘average’]</code>。我们将在下一节使用这个新专栏(<code class="fe nd ne nf lv b">IF</code>)。</p><p id="6d42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住，在这个示例中，我们可以使用第二个选项，因为只有数字值在所需的列中(数学、阅读和写作分数)。如果有一个额外的列我们不想在总和中考虑，我们应该只使用第一个选项。</p><p id="2978" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想计算一列中特定数据的数量，我们可以使用<code class="fe nd ne nf lv b">.value_counts()</code>方法</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="dd69" class="lz ma it lv b gy mb mc l md me">In [2]: df_excel['gender'].value_counts()<br/>Out [2]: <br/>female    518<br/>male      482</span></pre><h1 id="312b" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">如果</h1><p id="4b0c" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们可以通过使用Numpy轻松替换Excel的IF函数。</p><h2 id="75c6" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">将IF替换为np.where</h2><p id="0d93" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">假设我们想知道一个学生是否通过了考试，并用这些信息创建一个新的列。我们可以通过下面的代码轻松做到这一点。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="f3a0" class="lz ma it lv b gy mb mc l md me">df_excel['pass/fail'] = np.where(df_excel['average'] &gt; 70, 'Pass', 'Fail')</span></pre><p id="e948" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见,<code class="fe nd ne nf lv b">np.where()</code>需要3个参数——条件，条件为真时的值，条件为假时的值。</p><h2 id="f528" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">用np.select替换嵌套IF</h2><p id="f88f" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">假设我们希望根据获得的分数给出从A到F的分数。在这种情况下，我们有2个以上的值，所以我们使用<code class="fe nd ne nf lv b">np.select()</code></p><p id="de55" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nd ne nf lv b">np.select() </code>needs to arguments——一个条件列表和一个值列表。Python中的列表由方括号<code class="fe nd ne nf lv b">[ ]</code>表示</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="69df" class="lz ma it lv b gy mb mc l md me">conditions = [<br/>    (df_excel['average']&gt;=90),<br/>    (df_excel['average']&gt;=80) &amp; (df_excel['average']&lt;90),<br/>    (df_excel['average']&gt;=70) &amp; (df_excel['average']&lt;80),<br/>    (df_excel['average']&gt;=60) &amp; (df_excel['average']&lt;70),<br/>    (df_excel['average']&gt;=50) &amp; (df_excel['average']&lt;60),<br/>    (df_excel['average']&lt;50),<br/>]</span><span id="f2d1" class="lz ma it lv b gy nt mc l md me">values = ['A', 'B', 'C', 'D', 'E', 'F']</span></pre><p id="6c0c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">请记住，每个条件都应该在括号内。</strong>现在我们使用<code class="fe nd ne nf lv b">.select()</code>方法，并将其分配给一个新的<code class="fe nd ne nf lv b">[‘grades’]</code>列。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="1d19" class="lz ma it lv b gy mb mc l md me">df_excel['grades'] = np.select(conditions, values)</span></pre><p id="8ac0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在输出的前5行应该是这样的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/1ea9af75417b95ff3865a367ca495760.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*6iEv_ka-a7NFYySgx2yCMA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="949d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们挑选了这3列，用双方括号<code class="fe nd ne nf lv b">df_excel[[</code>‘平均’，‘通过/失败’，‘等级’<code class="fe nd ne nf lv b">]] </code>，前5行可以用<code class="fe nd ne nf lv b">.head() </code>方法显示。</p><div class="nv nw gp gr nx ny"><a href="https://medium.datadriveninvestor.com/how-to-start-making-money-coding-even-if-you-have-no-experience-3b114cf7c649" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">即使没有经验，如何开始编码赚钱</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">没有工作赚钱的最好方法。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">medium.datadriveninvestor.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div><h1 id="0a91" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">SumIf，CountIf，AverageIf</h1><p id="b87a" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">在Python中，为了基于条件求和、计数或计算平均值，我们首先过滤掉值，然后进行计算。</p><h2 id="7c86" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">一个条件(用方括号[ ]选择一列)</h2><p id="3a63" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">假设我们只想对女性的分数求和。为此，首先，我们编写条件<code class="fe nd ne nf lv b">df_excel[‘gender’] == ‘female’ </code>,然后。我们使用方括号<code class="fe nd ne nf lv b">[ ]</code>来选择<code class="fe nd ne nf lv b">df_excel</code>框架中的条件</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="388d" class="lz ma it lv b gy mb mc l md me">df_female = df_excel[df_excel['gender'] == 'female']</span></pre><p id="28ac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们只选择了女性，并将其放入一个名为<code class="fe nd ne nf lv b">df_female</code>的数据框中。现在，我们可以执行我们在“总和、平均值、最大值、最小值、计数”一节中看到的任何计算。</p><h2 id="69f4" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">两个或更多条件(选择列并使用&amp;或|)</h2><p id="2486" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">如果我们有两个或更多的条件，代码看起来将与上面的类似，但有一些变化。假设我们想要计算B组<code class="fe nd ne nf lv b">(‘race/ethnicity’)</code>中女性的分数</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="3335" class="lz ma it lv b gy mb mc l md me">df_sumifs = df_excel[(df_excel['gender'] == 'female') &amp; (df_excel['race/ethnicity'] == 'group B')]</span></pre><p id="8d03" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们可以使用两个条件&amp;分别代表和/或。<strong class="la iu">请记住，每个条件都应该在括号</strong>内。</p><p id="227d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们把分数加起来。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="3beb" class="lz ma it lv b gy mb mc l md me">df_sumifs = df_sumifs.assign(sumifs = df_sumifs['math score'] + df_sumifs['reading score'] + df_sumifs['writing score'])</span></pre><p id="6289" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，我使用了<code class="fe nd ne nf lv b">.assign() </code>方法向您展示了在进行计算时创建新列的另一种方法。</p><h1 id="0cbd" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">基本数据清理</h1><p id="7f82" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们将检查一些用于数据清理的方法。如果您想了解所有用于清理数据的方法，请查看我写的关于如何在Python中清理和准备数据的完整指南。</p><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/a-straightforward-guide-to-cleaning-and-preparing-data-in-python-8c82f209ae33"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">用Python清理和准备数据的简单指南</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">如何识别和处理脏数据？</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om ks ny"/></div></div></a></div><p id="783d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将继续使用我们之前定义的<code class="fe nd ne nf lv b">df_excel</code>框架。</p><h2 id="b662" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">更改带有. str.lower、. str.upper或. str.title的文本的大小写</h2><p id="b7ad" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">要访问包含在列中的字符串，我们使用<code class="fe nd ne nf lv b">.str</code>，然后我们可以用下面的代码改变文本的大小写</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="93c8" class="lz ma it lv b gy mb mc l md me">df_excel['gender'].str.title()<br/>df_excel['gender'].str.upper()<br/>df_excel['gender'].str.title()</span></pre><p id="2e6b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了保存这些值，我们可以覆盖一个列，如下面的代码所示。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="ec15" class="lz ma it lv b gy mb mc l md me">df_excel['gender'] = df_excel['gender'].str.title()</span></pre><p id="c3a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是在这种情况下，我们将保持值不变。</p><h2 id="64d6" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">用. str.extract提取列中的文本</h2><p id="ecb0" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们可以很容易地用<code class="fe nd ne nf lv b">.str.extract</code>从一个列中提取文本。除此之外，如果我们想提取文本的特定模式，我们可以使用正则表达式。</p><p id="80b1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们只想提取列<code class="fe nd ne nf lv b">‘race/ethnicity’</code>中的大写单词(例如，“B组”中的“B”)。为此，我们编写以下代码。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="ddc3" class="lz ma it lv b gy mb mc l md me">df_excel['race/ethnicity'].str.extract(r'([A-Z])')</span></pre><p id="bed4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，我们使用正则表达式<code class="fe nd ne nf lv b">r'([A-Z])’ </code>，其中<code class="fe nd ne nf lv b">[A-Z]</code>表示大写的单词，而括号<code class="fe nd ne nf lv b">() </code>是选择所需模式所必需的。正则表达式可能看起来吓人，但它们比你想象的要简单。在下面的链接中，你会发现我为轻松学习正则表达式而制作的简单指南。</p><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/a-simple-and-intuitive-guide-to-regular-expressions-404b057b1081"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">简单直观的正则表达式指南</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">轻松地从任何文本中提取信息。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="oo l oj ok ol oh om ks ny"/></div></div></a></div><h2 id="e0a3" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">属性标识单元格是否为空。isnull方法</h2><p id="4c2b" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">为了替换Excel的COUNTA，在Python中我们可以使用<code class="fe nd ne nf lv b">.isnull()</code>来查找空值。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="05cd" class="lz ma it lv b gy mb mc l md me">df_excel[df_excel['gender'].isnull()]</span></pre><p id="cda9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，没有空值，因此结果将是一个空数据帧。</p><h1 id="b306" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">纵向查找函数</h1><p id="1454" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">为了像Vlookup在Excel中那样查找元素，我们将根据我们想要解决的问题使用<code class="fe nd ne nf lv b">.loc[]</code>、<code class="fe nd ne nf lv b">.merge()</code>或<code class="fe nd ne nf lv b">.concat()</code>。</p><p id="d46c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">仅对于这些示例，我们将使用2个Excel电子表格。第一个是我们到目前为止一直在处理的“学生表现”，而第二个是我用随机的<code class="fe nd ne nf lv b">id</code>和<code class="fe nd ne nf lv b">language score</code> <strong class="la iu"> </strong>值创建的名为“LanguageScore”的CSV文件(你可以在我的<a class="ae mf" href="https://github.com/ifrankandrade/data_preprocessing.git" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到这个文件)。让我们像以前一样用<code class="fe nd ne nf lv b">pd.read_csv() </code>读取两个文件。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="a547" class="lz ma it lv b gy mb mc l md me">excel_1 = 'StudentsPerformance.csv'<br/>excel_2 = 'LanguageScore.csv'</span><span id="94ea" class="lz ma it lv b gy nt mc l md me">df_excel_1 = pd.read_csv(excel_1)<br/>df_excel_2 = pd.read_csv(excel_2)</span></pre><p id="67ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们将在<code class="fe nd ne nf lv b">df_excel_1 </code>上创建一个<code class="fe nd ne nf lv b">id</code>列，这样它就有了一个与<code class="fe nd ne nf lv b">df_excel_2</code>相同的列。为此，我们运行以下代码。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="0b15" class="lz ma it lv b gy mb mc l md me">df_excel_1 = df_excel_1.reset_index()<br/>df_excel_1 = df_excel_1.rename(columns={'index':'id'})</span></pre><p id="f0a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如您所见，我基于索引创建了一个<code class="fe nd ne nf lv b">id</code>列。<code class="fe nd ne nf lv b">reset_index() </code>通过将索引添加为列来删除索引。您可以删除索引做<code class="fe nd ne nf lv b">.reset_index(drop=True) </code>，但是在这种情况下，我将使用<code class="fe nd ne nf lv b">.rename()</code>方法重命名这个新的<code class="fe nd ne nf lv b">index</code>列。这样，我们就有了一个新的<code class="fe nd ne nf lv b">id</code>列。</p><h2 id="071c" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">用查找一个元素。位置[ ]</h2><p id="cf58" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">使用Pandas查找元素就像在<code class="fe nd ne nf lv b">[] </code>中编写<code class="fe nd ne nf lv b">.loc[] .</code>一样简单，我们必须包含行和列标签。Ler找到与第100行相关的信息。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="b2f8" class="lz ma it lv b gy mb mc l md me">In [3]: df_excel_1.loc[100, ]<br/>Out [3]:</span><span id="545b" class="lz ma it lv b gy nt mc l md me">id                                      100<br/>gender                                 male<br/>race/ethnicity                      group B<br/>parental level of education    some college<br/>lunch                              standard<br/>test preparation course                none<br/>math score                               79<br/>reading score                            67<br/>writing score                            67</span></pre><p id="cfe6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们也可以设定条件。例如，我们想得到学生的数学成绩，其中<code class="fe nd ne nf lv b">id</code>等于100。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="5b14" class="lz ma it lv b gy mb mc l md me">In [3]: df_excel_1.loc[df_excel_1['id']==100, 'math score']<br/>Out [3]:<br/>100    79<br/>Name: math score, dtype: int64</span></pre><p id="b491" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着得到100分的学生在数学上得到20分。</p><h2 id="e97b" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">用pd.merge或pd.concat合并两个表</h2><p id="50ab" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">假设您想将所有参加考试的学生的语言成绩相加。在这种情况下，我们使用<code class="fe nd ne nf lv b">pd.merge()</code>。这要求两个表有一个公共列。在这种情况下，该列是<code class="fe nd ne nf lv b">id</code>列。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="4efe" class="lz ma it lv b gy mb mc l md me">df_excel_3 = pd.merge(df_excel_1, df_excel_2, on='id', how='left')<br/>df_excel_3['language score'].fillna('0', inplace=True)</span></pre><p id="c0ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面你可以看到需要另一个参数<code class="fe nd ne nf lv b">(how)</code>。这表明合并是如何执行的。左右会有<code class="fe nd ne nf lv b">df_excel_1</code>和<code class="fe nd ne nf lv b">df_excel_2</code>作为最终结果的参考，而<code class="fe nd ne nf lv b">inner </code>只会给出<code class="fe nd ne nf lv b">id</code>栏内的常用数据。</p><p id="6803" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您也可以使用<code class="fe nd ne nf lv b">pd.concat()</code>达到同样的目的，但是您必须在连接帧之前将<code class="fe nd ne nf lv b">id</code>设置为索引，并将帧作为列表包含在内(在括号<code class="fe nd ne nf lv b">[]</code>内)</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="1aee" class="lz ma it lv b gy mb mc l md me">df_excel_3 = pd.concat(<br/> [df_excel_1.set_index('id'), df_excel_2.set_index('id')], axis=1<br/>)<br/>df_excel_3['language score'].fillna('0', inplace=True)<br/>df_excel_3</span></pre><p id="5a36" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有不匹配的值都会收到一个NaN，但是我们可以通过使用<code class="fe nd ne nf lv b">.fillna()</code>方法用任何值替换它。</p><h1 id="09cd" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">数据透视表</h1><h2 id="ac65" class="lz ma it bd mh nh ni dn ml nj nk dp mp lh nl nm mr ll nn no mt lp np nq mv nr bi translated">使用。数据透视表方法</h2><p id="c6b9" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">Pandas的pivot_table方法与Excel中的方法类似。</p><p id="719d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们想要获得<code class="fe nd ne nf lv b">race/ethnicity </code>列中所有组的数学和写作分数。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="5f89" class="lz ma it lv b gy mb mc l md me">df_excel = pd.read_csv('StudentsPerformance.csv')</span><span id="6c2e" class="lz ma it lv b gy nt mc l md me">df_pivot = df_excel.pivot_table(index='race/ethnicity', values=['math score', 'writing score'], aggfunc='mean')<br/>df_pivot</span></pre><p id="644b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nd ne nf lv b">index</code>参数将对<code class="fe nd ne nf lv b">‘race/ethnicity’ </code>列进行分组，而<code class="fe nd ne nf lv b">values</code>参数将显示数值。最后，由<code class="fe nd ne nf lv b">aggfunc</code>进行计算。在这种情况下，我们选择平均值。<code class="fe nd ne nf lv b"> </code>结果，我们得到下面的数据透视表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/92d0e9fd938f276f3b7c901123c163a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*BVg8w4kZo4TpO6AT6vz44g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="d450" class="mg ma it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">用Python的Matplotlib或Seaborn替换Excel图表</h1><p id="fdd4" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">Python包含不同的库，使得可视化效果和Excel提供的一样好。</p><p id="c66b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们根据上面创建的<code class="fe nd ne nf lv b">df_pivot </code>的结果制作一个简单的柱状图。首先，我们导入<code class="fe nd ne nf lv b">matplotlib </code>，然后我们使用<code class="fe nd ne nf lv b">plt.bar()</code></p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="bc26" class="lz ma it lv b gy mb mc l md me">import matplotlib.pyplot as plt</span><span id="8112" class="lz ma it lv b gy nt mc l md me">df_plot = df_pivot.reset_index()<br/>plt.bar(df_plot['race/ethnicity'], df_plot['math score'])<br/>plt.show()</span></pre><p id="335f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nd ne nf lv b">plt.bar() </code>的第一个参数是标签，第二个是数值。然后我们用<code class="fe nd ne nf lv b">plt.show()</code>显示结果</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/7027b1e44d2643bc4d35db53e13c930b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*dNyDyjbgqyD8hYfDpht7-g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3bc2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在Python plot中可以做很多事情，比如给图形添加标签、标题、定制图形的大小和颜色，但这是一个全新的主题。我已经用Python制作了一个漂亮的可视化指南，包括线图、条形图、饼状图、直方图、箱线图等。请点击下面的链接查看。</p><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/a-simple-guide-to-beautiful-visualizations-in-python-f564e6b9d392"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">Python中美丽可视化的简单指南</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">自定义Matplotlib &amp; Seaborn，永远忘记那些难看的蓝条。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="or l oj ok ol oh om ks ny"/></div></div></a></div></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><p id="2536" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nc">就是这样！现在您已经准备好利用Python和Pandas提供的所有好处了！本文使用的所有代码在我的</em> <a class="ae mf" href="https://github.com/ifrankandrade/data_preprocessing.git" rel="noopener ugc nofollow" target="_blank"> <em class="nc"> Github </em> </a> <em class="nc">上都有。</em></p><p id="3bb2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae mf" href="https://frankandrade.ck.page/bd063ff2d3" rel="noopener ugc nofollow" target="_blank"><strong class="la iu"/></a><strong class="la iu">】与3k+人一起加入我的电子邮件列表，获取我在所有教程中使用的Python for Data Science备忘单。</strong></p><p id="ec3b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我看的学习Python的书单。</p><div class="nv nw gp gr nx ny"><a href="https://betterprogramming.pub/4-python-books-i-read-as-a-self-taught-programmer-5a5453840cdb" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">作为一名自学成才的程序员，我阅读了4本Python书籍</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">学习Python来创建游戏、网站、自动化任务等的书籍</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">better编程. pub</p></div></div><div class="oh l"><div class="oz l oj ok ol oh om ks ny"/></div></div></a></div><p id="1adb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦你掌握了熊猫，这里有一些你可以开始的项目。</p><div class="nv nw gp gr nx ny"><a href="https://medium.datadriveninvestor.com/i-used-to-pay-180-yr-for-a-profitable-betting-tool-this-year-i-built-one-in-python-dda1a9b9581f" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">我曾经每年花180美元购买一个有利可图的赌博工具。今年我用Python做了一个</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">完整的代码创建一个足球博彩工具与熊猫和硒。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">medium.datadriveninvestor.com</p></div></div><div class="oh l"><div class="pa l oj ok ol oh om ks ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a href="https://medium.datadriveninvestor.com/make-money-with-python-the-sports-arbitrage-project-3b09d81a0098" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">用Python赚钱——体育套利项目</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">充分代码，使额外的钱与体育套利。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">medium.datadriveninvestor.com</p></div></div><div class="oh l"><div class="pb l oj ok ol oh om ks ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/a-simple-guide-to-automate-your-excel-reporting-with-python-9d35f143ef7"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">使用Python自动生成Excel报表的简单指南</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">使用openpyxl通过Python自动生成Excel报表。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="pc l oj ok ol oh om ks ny"/></div></div></a></div><p id="d6ac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我还做了一个指南，帮助你建立你的第一个机器学习模型。</p><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-text-classification-with-scikit-learn-632357e16f3a"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">Scikit-Learn简单指南—用Python构建机器学习模型</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">Python中的第一个ML模型。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="pd l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>