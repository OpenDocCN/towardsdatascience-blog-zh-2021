<html>
<head>
<title>Visualizing Spotify Data with Python and Tableau</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python和Tableau可视化Spotify数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-spotify-data-with-python-tableau-687f2f528cdd?source=collection_archive---------1-----------------------#2021-09-16">https://towardsdatascience.com/visualizing-spotify-data-with-python-tableau-687f2f528cdd?source=collection_archive---------1-----------------------#2021-09-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a38c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用您的流数据和Spotify的API创建一个动态仪表板</h2></div><p id="37a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我不需要做这个项目来发现我仍然沉迷于Lorde的'<a class="ae lb" href="https://open.spotify.com/track/0TEekvXTomKt3hdXDZxxeW" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"/></a><strong class="kh ir">'</strong>'排骨，但尽管如此，工作还是很有趣。参见下文，了解如何使用您自己的Spotify数据轻松复制它！</p><p id="9fa5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://public.tableau.com/app/profile/anne.bode/viz/SpotifyPREMIUMDashboard/PremiumDashboard" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Tableau公共仪表盘</strong> </a> <br/> <a class="ae lb" href="https://jovian.ai/abode118/spotify-data-prep" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Jupyter笔记本</strong> </a></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/b5187ae88901f8c5ca68c5202fc7a241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IdybzQcWJqLaECUpOm8j0g.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated"><a class="ae lb" href="https://public.tableau.com/app/profile/anne.bode/viz/SpotifyPREMIUMDashboard/PremiumDashboard" rel="noopener ugc nofollow" target="_blank">https://public . tableau . com/app/profile/Anne . bode/viz/spotifypremiumdash/PremiumDashboard</a></p></figure><h1 id="6ce8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤1:请求数据</h1><p id="a15c" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在此 向Spotify <a class="ae lb" href="https://www.spotify.com/account/privacy/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">索取您的数据副本。耐心等几天。<em class="mp">可能有一种方法可以直接使用Spotify的API请求这些数据，但那是另外一个项目了！</em></strong></a></p><h1 id="d758" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤2:准备流/库数据</h1><p id="c79b" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">使用Spotify给我们的文件，我们现在将创建一个数据帧，其中包括我们所有的流媒体数据，以及每首歌曲是否在我们的资料库中，以及每首歌曲的Spotify“URI”(唯一标识符，以后会派上用场)</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="58f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建<strong class="kh ir"> df_stream </strong>:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="d351" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我从Spotify清理了我的“YourLibrary”文件，这样它就只包含了“tracks”字典，用方括号[ ]括起来，并保存为一个新文件“YourLibrary1”。更擅长清理json文件的人可能会自动执行这个步骤，并使用原始文件。</p><p id="bfcc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建<strong class="kh ir"> df_library </strong>:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f3f2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建我们的最终数据帧，<strong class="kh ir"> df_tableau: </strong></p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h1 id="d9d7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤3:创建新的Spotify项目</h1><p id="5e71" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在这里 登录你的开发者账号<a class="ae lb" href="https://developer.spotify.com/dashboard" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">。在仪表板中，创建一个新项目。创建后，您可以检索您的“客户ID”和“客户机密”我们将在步骤4中使用这些。</strong></a></p><h1 id="11a7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤4:使用Spotify的API创建流派数据框架</h1><p id="08e6" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">首先，我们将使用我们的客户端ID和客户端密码来生成一个访问令牌，这样我们就可以从Spotify的API中提取数据。注意:此令牌必须在一小时后重新生成。我在<a class="ae lb" href="https://stmorse.github.io/journal/spotify-api.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">这篇文章</strong> </a>的帮助下想出了如何做到这一点。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="8bdd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们将从库中提取与每个track_uri相关联的艺术家和流派，并添加到字典<em class="mp">(查看Spotify的</em> <a class="ae lb" href="https://developer.spotify.com/console/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="mp">控制台</em></strong></a><strong class="kh ir"><em class="mp"/></strong><em class="mp">以了解如何提取您感兴趣的数据点)。</em></p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="5254" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将把这个字典转换成一个dataframe ( <strong class="kh ir"> df_genre </strong>)并扩展它，以便每个曲目/艺术家的每个流派都在它自己的行中(我使用了这个解决方案)。这将创建<strong class="kh ir"> df_genre_expanded </strong>。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="17fc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们将把<strong class="kh ir"> df_tableau </strong>和<strong class="kh ir"> df_genre_expanded </strong>保存为csv文件，以便加载到tableau中。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h1 id="16a3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤5:将数据加载到Tableau中</h1><p id="174b" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">连接到Excel文件(MySpotifyDataTable.csv)作为数据源。这应该也会在左侧弹出您的GenresExpandedTable.csv文件。将后一个文件拖到右边，并在两个表之间添加一个关系。确保基于track_uri <em class="mp">创建关系(注意:您可能需要单击GenresExpandedTable.csv旁边的向下箭头，然后单击“字段名在第一行”)</em>。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ms"><img src="../Images/a284a6e28bd64fc194bc20307a23d4f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*okkf8BiEpOGVfSTjjA4z6A.png"/></div></div></figure><h1 id="d55f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤6:编辑Tableau中的字段</h1><p id="9171" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我们将在数据表中添加两个计算字段。我们可以用Python来完成这个，但是我想用Tableau来做实验。</p><ol class=""><li id="2a91" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated">将<strong class="kh ir"> Ms播放</strong>转换为<strong class="kh ir">分钟收听</strong>:<br/><em class="mp">【Ms播放】/60000 </em></li><li id="cecc" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">将<strong class="kh ir">结束时间</strong> (UTC)转换为<strong class="kh ir">结束时间(Adj) </strong>(您的时区，已考虑夏令时):<br/> <em class="mp"> IF【结束时间】&lt;DATE(2020–03–08)THEN DATEADD('小时'，-5，[结束时间]) <br/> ELSEIF【结束时间】&lt;DATE(2020–11–01)THEN DATEADD('小时'，-4，[结束时间</em></li></ol><h1 id="2120" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤7:创建可视化效果</h1><p id="6dd6" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated"><a class="ae lb" href="https://public.tableau.com/app/profile/anne.bode/viz/SpotifyPREMIUMDashboard/PremiumDashboard" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">下载仪表板</strong> </a>来看看我是如何创建下面的可视化效果的。请注意，它们在仪表板中都是链接在一起的，因此可以互相过滤，这很不正常！</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/e87c903c113f5ae74c92772c8e742e02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gj3Af_U9MKU2WI6QHbaD2A.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">仪表板过滤了风格为“alt z”的歌曲/艺术家——我是一个酷Z一代的孩子吗？</p></figure><ol class=""><li id="f8e7" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated">顶级艺人:收听分钟数最多的流行艺人，个人歌曲构成了丰富多彩的片段</li><li id="7d0d" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">艺人广度</strong> : <strong class="kh ir"> </strong>我听了&gt; 1分钟和&gt; 1流的每位艺人的歌曲数量</li><li id="e8bd" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">热门歌曲</strong>:收听分钟数最多的流行歌曲</li><li id="490d" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">流派</strong>:我听过的所有流派，用大小和颜色表示流的数量</li><li id="3c23" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">按月统计的听众人数</strong>:不言而喻的<em class="mp">(编辑9/29:我将“在图书馆中”字段从一个度量转换为一个维度，这样我就可以将它包含在一个堆叠条形图中，以查看我每个月总共听了多少分钟，其中有多少分钟在我的图书馆中)</em></li><li id="a659" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">每小时听众人数</strong>:不言自明</li></ol><h1 id="7ea9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后</h1><p id="e05d" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">通过分析您的Spotify流媒体和图书馆数据，您可以收集到大量有趣的见解，尤其是结合通过Spotify API获得的其他数据字段(即流派)时。我知道今年我真的很喜欢朱利安·贝克，我对洛德的爱没有时间限制。8月份，我听了太多阿德里安娜·伦克的'<a class="ae lb" href="https://open.spotify.com/track/1abuE8PRWIA2GAH1DqzfNl" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"/></a><strong class="kh ir">'</strong>(# sadgirlvibes)，但12月份，我最喜欢的歌当然是玛丽亚·凯莉的'<a class="ae lb" href="https://open.spotify.com/track/0bYg9bo50gSsH3LtXe2SQn" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">我想要的圣诞礼物就是你</strong> </a>'。现在我知道如何连接到Spotify的API，在未来的项目中，我想检查我听的歌曲/艺术家的音乐质量(不仅仅是流派)。我特别感兴趣的一个领域是“可跳舞性”，因为每当我被指派为家庭公路旅行的DJ时，我母亲的唯一标准就是“我能跟着跳舞的东西。”不管那是什么意思。</p><p id="7b92" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">祝你好运分析你自己的收听历史，继续收听2013年以来你最喜欢的歌曲！</p></div></div>    
</body>
</html>