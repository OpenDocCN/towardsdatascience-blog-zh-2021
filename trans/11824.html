<html>
<head>
<title>Easy grouped bar charts in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的简易分组条形图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/easy-grouped-bar-charts-in-python-b6161cdd563d?source=collection_archive---------9-----------------------#2021-11-25">https://towardsdatascience.com/easy-grouped-bar-charts-in-python-b6161cdd563d?source=collection_archive---------9-----------------------#2021-11-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9056" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何创建每个条目有两个、三个或更多条的条形图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3f272dfcaa9bfcf8394ffb868742259f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDMc_TBVGPqGW3X5-C6oeg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f8ad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我经常想创建一个图，但不记得如何创建，这是一个条形图，其中每个条目或数据帧的每一行都有两个或更多的条形。这样做的目的是比较同一行中的两个不同结果，例如在比较模型的输出或查看不同来源的测量结果有何不同时。虽然有一些例子，但我经常发现自己在无休止地寻找一个简单的实现，或者从各种来源拼凑代码，所以现在我已经能够做到这一点，并记住了代码，我想我会分享我的简单实现，它可以从每个条目两个扩展到三个甚至更多！</p><p id="6d42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我们可以创建一个虚构的数据集，记录五名候选人在一个虚构的学生社团中三年来的投票结果。为了简单起见，我们可以假设三个候选人在三年内没有变化，并且有172个成员各自为他们最喜欢的候选人投票。我们可以假设受欢迎程度会随着时间的推移而变化，这样我们就可以使用条形图来检测潜在的趋势。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="8e54" class="lz ma it lv b gy mb mc l md me">#create the dictionary of voting returns<br/>data_dict = {"Candidates": ["Jessica", "William", "Hussein", "Peter",  "Meridith"],<br/>            2012: [10, 27, 56, 31, 48],<br/>            2013: [30, 19, 48, 12, 63],<br/>            2014: [52, 7, 38, 22, 53]}</span><span id="345c" class="lz ma it lv b gy mf mc l md me">#convert that into a dataframe<br/>data_df = pd.DataFrame(data_dict)</span><span id="f29a" class="lz ma it lv b gy mf mc l md me">#show the dictionary<br/>data_df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/04a0ce7a5afaa9df055e6b830e29a65d.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*nOhzJKG66tyEkUcqyAfwww.png"/></div></figure><p id="70d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以使用这个数据集，例如在一个简单的分组条形图中比较2012年和2013年这两年的结果。我们可以简单地为每个候选人显示两个条形，这样我们就可以看到他们的受欢迎程度在两年内是如何变化的:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="74f3" class="lz ma it lv b gy mb mc l md me">#use fivethirty eights style of plots<br/>plt.style.use("fivethirtyeight")</span><span id="597f" class="lz ma it lv b gy mf mc l md me">#create the base axis to add the bars to<br/>fig, ax = plt.subplots(1,1, figsize = (8,6))</span><span id="3493" class="lz ma it lv b gy mf mc l md me">#extract the labels<br/>label = data_df["Candidates"]<br/>#use this to create x ticks to add the data to<br/>x = np.arange(len(label))</span><span id="bc4b" class="lz ma it lv b gy mf mc l md me">#set a width for each bar <br/>width = 0.3</span><span id="9aec" class="lz ma it lv b gy mf mc l md me">#create out first bar<br/>#set it so that x will be the centre of the bars<br/>#so that we can add our labels later<br/>#so set the centre of the first to be 1/2 width away<br/>#to the left<br/>rect1 = ax.bar(x - width/2,<br/>              data_df[2012],<br/>              width = width, <br/>               label = 2012,<br/>               edgecolor = "black"<br/>              )</span><span id="72bc" class="lz ma it lv b gy mf mc l md me">#create the second bar<br/>#with a centre half a width to the right<br/>rect2 = ax.bar(x + width/2,<br/>              data_df[2013],<br/>              width = width,<br/>              label = 2013,<br/>              edgecolor = "black")</span><span id="3791" class="lz ma it lv b gy mf mc l md me">#add the labels to the axis<br/>ax.set_ylabel("Votes",<br/>             fontsize = 20,<br/>             labelpad = 20)<br/>ax.set_xlabel("Candidates",<br/>             fontsize = 20,<br/>             labelpad =20)<br/>ax.set_title("Votes per candidate",<br/>            fontsize = 30,<br/>            pad = 20)</span><span id="2dc9" class="lz ma it lv b gy mf mc l md me">#set the ticks<br/>ax.set_xticks(x)<br/>ax.set_xticklabels(label)</span><span id="c34f" class="lz ma it lv b gy mf mc l md me">#add the legend<br/>#using the labels of the bars<br/>ax.legend(title = "Year of election",<br/>         fontsize = 16,<br/>         title_fontsize = 20)</span><span id="daf9" class="lz ma it lv b gy mf mc l md me">#adjust the tick paramaters<br/>ax.tick_params(axis = "x",<br/>              which = "both",<br/>              labelrotation = 90)<br/>ax.tick_params(axis = "y",<br/>              which = "both",<br/>              labelsize = 15)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3f272dfcaa9bfcf8394ffb868742259f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDMc_TBVGPqGW3X5-C6oeg.png"/></div></div></figure><p id="ffd0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里我们可以看到，从2012年到2013年，梅里蒂斯和杰西卡的人气上升，而威廉、侯赛因和彼得的人气下降。</p><p id="d0b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实现的关键部分是为要添加的条形创建一个位置数组。这里，它的长度等于我们的数据集中候选值的数量，并使用<code class="fe mh mi mj lv b">x = np.arange(len(data_df["Candidates"])</code>生成，以确保我们有相同数量的x值作为候选值。然后，我们将每组数据的位置调整到x刻度的任一侧。在这种情况下，每个条形的中心<code class="fe mh mi mj lv b">width/2</code>远离<code class="fe mh mi mj lv b">x</code>值，因此<code class="fe mh mi mj lv b">x</code>值保持在每个组的中心。这意味着我们可以使用数组将标签添加到绘图中，方法是将xticks设置为数组，并将标签添加为刻度标签。</p><p id="03cb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们希望每个条目有两个以上的条时，这当然会变得有点复杂，但这种变化并不太难处理。这方面的一个例子是，如果我们想了解人气在三年内的变化情况:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="d2d7" class="lz ma it lv b gy mb mc l md me">#create the base axis<br/>fig, ax = plt.subplots(1,1, figsize = (8,6))</span><span id="cc86" class="lz ma it lv b gy mf mc l md me">#set the labels<br/>#and the x positions<br/>label = data_df["Candidates"]<br/>x = np.arange(len(label))</span><span id="f1e6" class="lz ma it lv b gy mf mc l md me">#set the width of the bars<br/>width = 0.2</span><span id="6ef5" class="lz ma it lv b gy mf mc l md me">#create the first bar -1 width<br/>rect1 = ax.bar(x - width,<br/>              data_df[2012],<br/>              width = width, <br/>               label = 2012,<br/>               edgecolor = "black")</span><span id="6862" class="lz ma it lv b gy mf mc l md me">#create the second bar using x<br/>rect2 = ax.bar(x,<br/>              data_df[2013],<br/>              width = width,<br/>              label = 2013,<br/>              edgecolor = "black")</span><span id="40f7" class="lz ma it lv b gy mf mc l md me">#create the third bar plus 1 width<br/>rects2 = ax.bar(x + width,<br/>               data_df[2014],<br/>               width = width,<br/>               label = 2014,<br/>               edgecolor = "black")</span><span id="eb8e" class="lz ma it lv b gy mf mc l md me">#add the labels to the axis<br/>ax.set_ylabel("Votes",<br/>             fontsize = 25,<br/>             labelpad = 20)<br/>ax.set_xlabel("Candidates",<br/>             fontsize = 25,<br/>             labelpad =20)<br/>ax.set_title("Votes per candidate",<br/>            fontsize = 30,<br/>            pad = 20)</span><span id="ca19" class="lz ma it lv b gy mf mc l md me">#set the ticks<br/>#using the labels<br/>ax.set_xticks(x)<br/>ax.set_xticklabels(label)</span><span id="5333" class="lz ma it lv b gy mf mc l md me">#add the legend<br/>ax.legend(title = "Year of election",<br/>         fontsize = 16,<br/>         title_fontsize = 20,<br/>         bbox_to_anchor = (1.02, 0.7))</span><span id="5f3d" class="lz ma it lv b gy mf mc l md me">#adjust the tick paramaters<br/>ax.tick_params(axis = "x",<br/>              which = "both",<br/>              labelrotation = 90,<br/>              labelsize = 20)<br/>ax.tick_params(axis = "y",<br/>              which = "both",<br/>              labelsize = 20)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/17bfae960cad8261b50eab2263665154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvIQ-eHWpTtY0MqAUKTMyQ.png"/></div></div></figure><p id="cb10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里的关键是第一个条的中心距离组的中心有一个<code class="fe mh mi mj lv b">width</code>。这是因为中间的条将具有<code class="fe mh mi mj lv b">width = 0.2</code>，因此第二条的中心需要至少<code class="fe mh mi mj lv b">width/2 + width/2</code>远离<code class="fe mh mi mj lv b">x</code>值。我们可以将宽度增加到<code class="fe mh mi mj lv b">0.3</code>,它仍然是相同的计算，这种方式使得实现起来很简单，没有什么复杂的记忆！</p><p id="55c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想在条形图中添加更多的条形，例如四个、五个甚至更多，那么您需要做的就是调整条形的宽度和每个结果的位置，以便x值在条形组的中心对齐。例如，如果您希望每个条目有四个条，那么您可以将<code class="fe mh mi mj lv b">x</code>作为中心，第一个条远离<code class="fe mh mi mj lv b">-1.5 * width</code>，第二个条远离<code class="fe mh mi mj lv b">-0.5 * width</code>，第三个条远离<code class="fe mh mi mj lv b">0.5 * width</code>，第四个条远离<code class="fe mh mi mj lv b">1.5 * width</code>，只要它们具有相同的宽度。这将意味着标签将集中在<code class="fe mh mi mj lv b">x</code>上，因此它们将位于每个组的中心。</p><p id="7c1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好了，现在你可以用一种简洁的方式创建简单的分组条形图了，当我将来想再次使用它时，我不会忘记我把代码放在哪里了！</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="5d0a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢你所读的，并且想在medium上看到更多其他作者的作品，请随意使用我下面的参考代码注册:</p><div class="ms mt gp gr mu mv"><a href="https://philip-wilkinson.medium.com/membership" rel="noopener follow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">通过我的推荐链接加入媒体-菲利普·威尔金森</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">philip-wilkinson.medium.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ks mv"/></div></div></a></div><p id="3b78" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者考虑看看我的其他文章:</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/ucl-data-science-society-python-logic-3eb847362a97"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">UCL数据科学学会:Python逻辑</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">讲习班3:条件语句、逻辑语句、循环和函数</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj ks mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/univariate-outlier-detection-in-python-40b621295bc5"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">Python中的单变量异常检测</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">从数据集中检测异常值的五种方法</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nl l ng nh ni ne nj ks mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/introduction-to-decision-tree-classifiers-from-scikit-learn-32cd5d23f4d"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">scikit-learn决策树分类器简介</h2><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nm l ng nh ni ne nj ks mv"/></div></div></a></div></div></div>    
</body>
</html>