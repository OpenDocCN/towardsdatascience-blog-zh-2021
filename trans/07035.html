<html>
<head>
<title>ML Classifier Performance Comparison for Spam Emails Detection (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">垃圾邮件检测的ML分类器性能比较(下)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ml-classifier-performance-comparison-for-spam-emails-detection-part-2-aae4ba42bc4b?source=collection_archive---------39-----------------------#2021-06-25">https://towardsdatascience.com/ml-classifier-performance-comparison-for-spam-emails-detection-part-2-aae4ba42bc4b?source=collection_archive---------39-----------------------#2021-06-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="f859" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用TensorFlow检测垃圾邮件并评估模型</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/434870a26c78ec76467ce6f40790ab74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T17pmwmSL4vpFub2nqcWgA.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://unsplash.com/photos/TaOGbz_S-Qw" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><blockquote class="la lb lc"><p id="ec67" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">简介</strong></p></blockquote><p id="8926" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">对自然语言进行分类是当今自然语言处理的巨大挑战之一。它涉及到能够有效区分目标文本和正常文本的技术。聊天机器人等其他服务也严重依赖用户输入的文本。他们需要处理大量的数据，以确定用户的需求，并引导用户走上正确的道路。</p><blockquote class="la lb lc"><p id="ff0a" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">使用张量流</strong></p></blockquote><p id="2028" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在这个垃圾邮件分类器的第1部分中，我展示了如何使用nltk包对文本进行词干分析和词条分类，然后将其输入到分类器模型中进行训练，最后评估模型的性能。我已经展示了朴素贝叶斯、SVC和随机森林作为电子邮件分类器的性能。</p><div class="md me gq gs mf mg"><a rel="noopener follow" target="_blank" href="/ml-classifier-performance-comparison-for-spam-emails-detection-77749926d508"><div class="mh ab fp"><div class="mi ab mj cl cj mk"><h2 class="bd iv gz z fq ml fs ft mm fv fx it bi translated">垃圾邮件检测的ML分类器性能比较-第1部分</h2><div class="mn l"><h3 class="bd b gz z fq ml fs ft mm fv fx dk translated">应用朴素贝叶斯、SVC和随机森林进行邮件分类</h3></div><div class="mo l"><p class="bd b dl z fq ml fs ft mm fv fx dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu kt mg"/></div></div></a></div><p id="46a9" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在本文中，我将演示如何使用Tensorflow对电子邮件进行标记和有效分类。让我们开始吧。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="31b3" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我已经包含了pad_sequence，它将被用来使所有的文本数组大小相等。填充可以基于最大尺寸来完成，并且可以是后填充或前填充。接下来定义超参数</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="38a5" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">用户可以使用这些参数来防止过度拟合训练数据。例如，可以减少词汇大小，以最小化低频词的过度匹配。此外，嵌入维度越低，模型的训练速度就越快。我还包括了一个词汇以外的单词令牌。我将使用第1部分中使用的相同数据集。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="2a99" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我通常将整个数据集的80%用于训练，剩下的将用于测试。测试数据集以前从未被模型看到过。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><blockquote class="la lb lc"><p id="eeee" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">编码标签</strong></p></blockquote><p id="4cae" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">由于数据集具有字符串形式的标签，因此它将通过编码为0和1 (0表示垃圾邮件，1表示真实文本)来转换为整数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="7f6a" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">接下来要做的是将文本和标签转换成numpy数组并输入到模式中。标记化也被启动并适应来自数据集的文本。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="713c" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">如前所述，需要进行填充以使数组长度相等。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><blockquote class="la lb lc"><p id="8860" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">型号定义</strong></p></blockquote><p id="b8a0" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">然后用双向LSTM RNN算法定义该模型。这里使用双向LSTM来获得RNN的最佳性能。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><blockquote class="la lb lc"><p id="5be3" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">训练模型</strong></p></blockquote><p id="6c71" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在20个时期之后，该模型被很好地训练，并且验证数据(这里是测试数据)的准确度约为98%</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mx"><img src="../Images/f237a4e283721f955ade14da0c1294ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*AUlR-FHix6ehLc3OjHuATA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj my"><img src="../Images/b39d576c81ba81fef02178295bc65390.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*ZAun8mHqNCm7Zley2qiK_w.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="f4eb" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">接下来，将仅使用model.predict方法来获得超出精度数的模型性能参数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mz"><img src="../Images/c8d0f8140fa3bd556d06cc2fe232b3a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*94dOq3HSASqIiDzQNLh5CA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="7de8" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">该报告显示，该模型对于两种文本类别都具有非常好的精确度、召回率和F1分数(0和1: 0表示垃圾邮件，1表示真实邮件)。对于0，召回率比精确度低一点，这表明存在一些假阴性。该模型错误地将一些真实的电子邮件识别为垃圾邮件。</p><p id="25bd" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我们可以识别任何样本文本，以检查它是垃圾邮件还是真实的。由于已经定义了记号赋予器，我们不再需要再次定义它。我们所需要的就是对样本文本进行标记，用0填充它，然后传递给模型进行预测。选择一些朗朗上口的词，如“赢家”，“免费”，“奖”，最终会使这个文本被检测为垃圾邮件。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mv mw l"/></div></figure><blockquote class="la lb lc"><p id="400d" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">结论</strong></p></blockquote><p id="8c8a" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">本文演示了如何使用Tensorflow来有效地训练一个具有高精度的NLP模型，然后评估模型的性能参数，如精度、召回率和F1分数。对于这个小数据集，20个历元似乎可以生成一个验证准确率约为98%的优秀模型。</p><p id="ace5" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/06/23/Spam-email-classification-Part2-Tensorflow.html" rel="noopener ugc nofollow" target="_blank"> Github页面</a></p></div></div>    
</body>
</html>