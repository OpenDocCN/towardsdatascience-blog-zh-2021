<html>
<head>
<title>Intuitive ways of understanding Dynamic Time Warping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解动态时间扭曲的直观方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/intuitive-ways-of-understanding-dynamic-time-warping-5fb60fcbe037?source=collection_archive---------16-----------------------#2021-07-03">https://towardsdatascience.com/intuitive-ways-of-understanding-dynamic-time-warping-5fb60fcbe037?source=collection_archive---------16-----------------------#2021-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="abfc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过编辑距离和等效性</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/397f2feb2d999a5abe49d659a24c62dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CqKS_L9jJT6bgRKb"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Joshua Sukoff 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="458b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">动态时间扭曲(DTW)，尽管它的名字很科幻，但它只不过是一种(特别有用的)测量两个时间序列<code class="fe ls lt lu lv b">x=(x1,...,xn)</code>和<code class="fe ls lt lu lv b">y=(y1,...,ym)</code>之间距离的技术。</p><ul class=""><li id="86b0" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">“动态的”,因为算法涉及动态规划</li><li id="5cc7" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">时间，因为它是时间序列</li><li id="ebb0" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">因为它可以被解释为计算<code class="fe ls lt lu lv b">x</code>和<code class="fe ls lt lu lv b">y</code>的扭曲版本之间的“通常”距离</li></ul><p id="a46d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如何计算它的机制和各种可视化已经存在(例如，罗曼·塔维纳德在他们的博客上，章晓虎在Medium上，泰雷兹·塞恩·科尔廷在YouTube上)，但是这些解释缺少的是一种更深层次的直觉和一种你可以自己想出距离的感觉。</p><p id="467e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在这里的目的是通过编辑距离和等价性给出一些解释，这将让你对DTW的现状有一个更直观的了解。你甚至可以用这些想法来构建你自己的距离概念！</p><p id="8123" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了帮助解释，我将使用示例<code class="fe ls lt lu lv b">x=(0,1,1,-2,0)</code>和<code class="fe ls lt lu lv b">y=(0,0,1,-1)</code>来说明为什么这两个序列之间的DTW距离是1。</p><h2 id="5086" class="mk ml iq bd mm mn mo dn mp mq mr dp ms lf mt mu mv lj mw mx my ln mz na nb nc bi translated">DTW通过编辑距离</h2><p id="0d36" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">编辑距离通常用于自然语言处理和DNA分析。维基百科关于<a class="ae kv" href="https://en.wikipedia.org/wiki/Edit_distance" rel="noopener ugc nofollow" target="_blank">编辑距离</a>的文章给出了很好的描述:</p><blockquote class="ni nj nk"><p id="7ce8" class="kw kx nl ky b kz la jr lb lc ld ju le nm lg lh li nn lk ll lm no lo lp lq lr ij bi translated"><strong class="ky ir">编辑距离</strong>是一种通过计算将一个字符串转换成另一个字符串所需的最少操作次数来量化两个字符串之间不同程度的方法</p></blockquote><p id="9721" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">标准的操作是:删除一个字符，插入一个字符，用一个字符替换另一个字符，每一个对距离的贡献是相等的。</p><p id="5efa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">DTW可以被认为是编辑距离的一种形式，其中的操作如下:</p><ul class=""><li id="5c5f" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">可以在相邻空间中插入或删除条目的副本。这是零成本的。例如，通过复制<code class="fe ls lt lu lv b">-2</code>条目从<code class="fe ls lt lu lv b">(0,1,1,-2,0)</code>到<code class="fe ls lt lu lv b">(0,1,1,-2,-2,0)</code>将是零成本操作。或者从<code class="fe ls lt lu lv b">(0,1,1,-2,0)</code>到<code class="fe ls lt lu lv b">(0,1,-2,0)</code>，移除一个<code class="fe ls lt lu lv b">1</code>将是零成本操作。</li><li id="cd0e" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">可以编辑条目。如果把<code class="fe ls lt lu lv b">a</code>编辑成<code class="fe ls lt lu lv b">b</code>，代价就是<code class="fe ls lt lu lv b">a</code>和<code class="fe ls lt lu lv b">b</code>之间的距离。例如，通过将<code class="fe ls lt lu lv b">1</code>编辑为<code class="fe ls lt lu lv b">5</code>从<code class="fe ls lt lu lv b">(0,1,1,-2,0)</code>转到<code class="fe ls lt lu lv b">(0,1,5,-2,0)</code>将是成本为4的操作。</li><li id="92b8" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">可以在序列末尾插入或删除零。这是零成本的。例如，通过移除末端的<code class="fe ls lt lu lv b">0</code>从<code class="fe ls lt lu lv b">(0,1,1,-2,0)</code>到<code class="fe ls lt lu lv b">(0,1,1,-2)</code>将是零成本操作。</li></ul><p id="e75c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从<code class="fe ls lt lu lv b">x</code>到<code class="fe ls lt lu lv b">y</code>的DTW距离将是使用这三种操作编辑<code class="fe ls lt lu lv b">x</code>到<code class="fe ls lt lu lv b">y</code>的最低成本方式。注意第三个操作的原因是为了灵活地处理不同长度的系列。</p><p id="5b3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一个小练习/挑战，尝试使用编辑距离显示<code class="fe ls lt lu lv b">x=(0,1,1,-2,0)</code>和<code class="fe ls lt lu lv b">y=(0,0,1,-1)</code>之间的距离等于<code class="fe ls lt lu lv b">1</code>。</p><p id="d844" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="cb16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="437c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="1faa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不，真的，我建议试一试。通过主动参与，然后被动阅读别人的答案，你会学到更多！</p><p id="94a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="6446" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="cd8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="8a14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是我如何从<code class="fe ls lt lu lv b">x</code>到<code class="fe ls lt lu lv b">y</code>。(注意，可能会有多个编辑序列达到最小距离):</p><ul class=""><li id="31d7" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">从<code class="fe ls lt lu lv b">x=(0,1,1,-2,0)</code>开始</li><li id="7086" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">然后是<code class="fe ls lt lu lv b">(0,0,1,1,-2,0)</code>，通过复制<code class="fe ls lt lu lv b">0</code>。成本为0</li><li id="4684" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">然后通过移除重复的<code class="fe ls lt lu lv b">1</code>来移除<code class="fe ls lt lu lv b">(0,0,1,-2,0)</code>。成本为0</li><li id="83c7" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">然后是<code class="fe ls lt lu lv b">(0,0,1,-1,0)</code>，将<code class="fe ls lt lu lv b">-2</code>编辑为<code class="fe ls lt lu lv b">-1</code>。成本为1</li><li id="a328" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">然后通过移除末端的<code class="fe ls lt lu lv b">0</code>移动<code class="fe ls lt lu lv b">(0,0,1,-1)</code>，即y轴。成本为0</li></ul><p id="321e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以总成本是1，因此DTW距离是1。</p><p id="eca5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，这让我们对变形的构成有了一些了解。如果你要在图表上绘制这些时间序列:</p><ul class=""><li id="e80f" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">添加或删除重复项对应于水平地局部挤压或拉伸事物</li><li id="e38d" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">编辑一个条目相当于局部挤压或垂直拉伸东西</li></ul><h2 id="8259" class="mk ml iq bd mm mn mo dn mp mq mr dp ms lf mt mu mv lj mw mx my ln mz na nb nc bi translated">经由等价的DTW</h2><p id="8b95" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">另一种方法是问:我希望距离捕捉到<code class="fe ls lt lu lv b">x</code>和<code class="fe ls lt lu lv b">y</code>之间的哪些差异，以及我希望距离忽略哪些差异？</p><p id="b11c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有几种更正式的表达方式:</p><ul class=""><li id="b1dd" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">我怎样才能改变<code class="fe ls lt lu lv b">x</code>和<code class="fe ls lt lu lv b">y</code>而不影响它们之间的距离</li><li id="8cc8" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">距离函数的不变性是什么</li><li id="b9ca" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">我认为哪个时间序列与<code class="fe ls lt lu lv b">x</code>的距离为0</li><li id="52fd" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">我认为哪些序列等同于<code class="fe ls lt lu lv b">x</code>。这是我将使用的视角。</li></ul><p id="e4ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你建立了等价的概念，我们就可以定义<code class="fe ls lt lu lv b">x</code>和<code class="fe ls lt lu lv b">y</code>之间的距离如下:</p><ul class=""><li id="785b" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">设<code class="fe ls lt lu lv b">X</code>是等价于<code class="fe ls lt lu lv b">x</code>的所有级数的集合</li><li id="d918" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">设<code class="fe ls lt lu lv b">Y</code>是等价于<code class="fe ls lt lu lv b">y</code>的所有数列的集合</li><li id="b9cb" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">设<code class="fe ls lt lu lv b">d</code>是一些“通常的”距离概念，例如欧几里德距离<code class="fe ls lt lu lv b">d(x,y) = sqrt(sum (xi-yi)^2)</code>或与L1范数的距离<code class="fe ls lt lu lv b">d(x,y) = sum |xi-yi|</code>。</li><li id="77cb" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">然后将<code class="fe ls lt lu lv b">x</code>和<code class="fe ls lt lu lv b">y</code>之间的距离定义为<code class="fe ls lt lu lv b">d(x', y')</code>的最小值，其中<code class="fe ls lt lu lv b">x'</code>距离<code class="fe ls lt lu lv b">X</code>而<code class="fe ls lt lu lv b">y'</code>距离<code class="fe ls lt lu lv b">Y</code>。</li></ul><p id="05e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是你如何使用等价来创造距离概念的一般框架。(注意，这与如何测量点集之间的距离有关，例如，在聚类中，如果您知道如何测量单个点之间的距离)。</p><p id="125e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要使用此等效框架获得DTW距离:</p><ul class=""><li id="a44a" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">我们说两个序列是等价的，如果你可以通过添加/删除重复的条目或者在末尾添加/删除0来从一个序列到另一个序列</li><li id="6370" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">d</code>是距离L1范数的距离，所以<code class="fe ls lt lu lv b">d(x,y) = sum |xi — yi|</code></li></ul><p id="42af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再一次，作为一个小练习，试着用这个视角来展示<code class="fe ls lt lu lv b">x=(0,1,1,-2,0)</code>和<code class="fe ls lt lu lv b">y=(0,0,1,-1)</code>之间的DTW距离是1。</p><p id="9d80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="a491" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="5005" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="3c5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再说一次，我真的强烈建议你试试！如果你不确定该怎么做，那就意味着我的解释不太好；如果是这样的话，请告诉我，我可以为将来做些改进！</p><p id="0177" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="bcbe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="5ae4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">…</p><p id="f977" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是我如何得到1:</p><ul class=""><li id="48c0" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated"><code class="fe ls lt lu lv b">(0,1,1,-2,0)</code>相当于<code class="fe ls lt lu lv b">x'=(0,0,1,1,-2,0)</code></li><li id="1683" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">(0,0,1,-1)</code>相当于<code class="fe ls lt lu lv b">y'=(0,0,1,1,-1,0)</code></li><li id="dc79" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">x'</code>和<code class="fe ls lt lu lv b">y'</code>之间的距离为<code class="fe ls lt lu lv b">0+0+0+0+1+0 = 1</code></li></ul><h2 id="88e7" class="mk ml iq bd mm mn mo dn mp mq mr dp ms lf mt mu mv lj mw mx my ln mz na nb nc bi translated">结束语</h2><p id="5ae5" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">我提供了两种不同的DTW算法的解释:</p><ul class=""><li id="dc41" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">给定一组可能的操作，确定最小编辑距离</li><li id="a9d3" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">确定时间序列等价版本之间的最小L1范数距离</li></ul><p id="57df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我应该承认，我对小练习的回答忽略了一个重要的细节:我展示了如何可能得到1，但我没有给出任何明确的论据证明这是最小的可能距离！对于具体的例子，这并不太难，但一般来说，这将是确定距离最困难的部分。</p><p id="3847" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，这正是“动态”部分的用武之地！DTW算法的好处在于，它为你提供了一个紧凑而简单的算法来计算最小值。</p></div></div>    
</body>
</html>