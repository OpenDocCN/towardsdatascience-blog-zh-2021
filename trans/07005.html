<html>
<head>
<title>Bayes’ Theorem for Medical Tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">医学检验的贝叶斯定理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bayes-theorem-for-medical-test-f1fb12b579c6?source=collection_archive---------9-----------------------#2021-06-25">https://towardsdatascience.com/bayes-theorem-for-medical-test-f1fb12b579c6?source=collection_archive---------9-----------------------#2021-06-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5538" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">理解医学检验的贝叶斯定理。解释结果和更多测试的组合</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ff456d3bb6f35b67174fcb943f551e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QHlvmi0Dxacckdoga_ad6A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@testalizeme?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Testalize.me </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="2b2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> B </span>阿耶斯定理是统计学中的主要定理之一，也是科学中应用最广泛的公式之一。</p><p id="e05b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">直到上世纪中叶，它的重要性一直在稳步增长。现在，它被认为是所有统计学课程的基础，应用于几乎所有的研究领域，而不是工业领域。</p><p id="f6fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">乍一看，贝叶斯定理似乎令人困惑，并且常常难以理解，而这在本质上并不容易的统计学领域已经存在。</p><p id="61b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，如果我们分析引导贝叶斯得出他的定理的思维过程，我们会看到这些是自然的和逻辑的思维方式。</p><h2 id="ac08" class="mf mg it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">定理</h2><p id="9d7e" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">贝叶斯定理是以托马斯·贝叶斯牧师的名字命名的。大约在1740年，贝氏进行了一项思维实验:他想象自己背靠一张平的方形桌子，把一个球发射到桌子上，但不知道球会落在哪里。</p><p id="0caf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，他想到发射第二个球，这次问他的助手球是落在第一个球的左边、右边、前面还是后面。使用这个系统，他能够缩小每次新发射的第一个球的位置。</p><p id="5950" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种系统不可能准确地知道第一个球落在哪里；但是它创造了一种方法，或者说一种思维方式，通过这种方法，每一个新的证据都可以提高估计值。这是他的定理创造的最有趣的范式转变之一</p><p id="2180" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">贝叶斯从未发表过他的想法。在他1761年去世后，他的朋友理查德·普莱斯发现了他的笔记并扩展了它们。通过应用现代标准，我们应该把这个定理称为贝叶斯价格定理。然而，尽管普莱斯做了工作，这个定理仍然不为人知，直到被皮埃尔·西蒙·拉普拉斯重新发现。他重新陈述了定理给出了“<em class="me">(给定一个事件)原因的概率与事件(给定其原因)的概率成正比</em>”。</p><p id="0a09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用更现代的话来说:贝叶斯定理描述了一个事件发生的可能性，基于可能与该事件相关的条件的先验知识。</p><h1 id="30ec" class="nd mg it bd mh ne nf ng mk nh ni nj mn jz nk ka mq kc nl kd mt kf nm kg mw nn bi translated">经典表示</h1><p id="9436" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">该公式最经典的表示如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/200c5938431d7e6a0e9235ab4582ea25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*EB89iVTAZlU-QQNqwJ_mSg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">贝叶斯定理(作者图片)</p></figure><p id="6c28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中A和B是我们想要分析的两个事件，并且:</p><ul class=""><li id="3f6e" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">P(A)和P(B)是事件A和事件B的不同且独立的概率。A是假设为真的概率。<strong class="lb iu"> P(A)是前面的<em class="me"/></strong>。</li><li id="c018" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated"><strong class="lb iu"> P(B) </strong>是看到证据的概率。这个元素叫做<strong class="lb iu"><em class="me"/></strong>。</li><li id="9dfe" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated"><strong class="lb iu"> P(A|B) </strong>(读作:A的P使得给定B的P的B)是条件概率，因此，事件A的概率，给定事件B已经发生(为真)。这被称为<strong class="lb iu"><em class="me"/><em class="me">概率</em> </strong>或<em class="me">条件</em>概率。</li><li id="9b0c" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">反之亦然，<strong class="lb iu"> P(B∣A) </strong>是b给定a的概率.假设为真时看到证据的概率。这种可能性被命名为<strong class="lb iu"><em class="me"/></strong>。</li></ul><p id="1790" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，该公式将先验概率与后验概率联系起来，并有可能将新的观察结果整合到基于先前观察结果的已建立模型中。</p><h1 id="752b" class="nd mg it bd mh ne nf ng mk nh ni nj mn jz nk ka mq kc nl kd mt kf nm kg mw nn bi translated">典型的例子</h1><p id="8c38" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们从一个简单的例子开始，看看当我们拥有所有需要的信息时，贝叶斯定理是如何工作的。</p><p id="6235" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们考虑一所由60%的男生(B)和40%的女生(G)组成的学校，其中所有的男生都留着短发，而留长发的女生(L)和留短发的女生的比例相等(50/50)。</p><blockquote class="od oe of"><p id="ef12" class="kz la me lb b lc ld ju le lf lg jx lh og lj lk ll oh ln lo lp oi lr ls lt lu im bi translated">我们遇到了一个剪短发的学生。<strong class="lb iu"> <em class="it">学生是女生的概率有多大？</em>T29】</strong></p></blockquote><p id="13b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">发型事件与学生的性别有关，因此这些是我们的因变量。学生的性别是自变量。</p><ul class=""><li id="1266" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">考虑到整个学校，学生剪短发(事件S)的概率是所有男生加上一半女生:P(S)=60%+(40/2)%=80%</li><li id="25c3" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">假设学生是女生，留短发的学生的相关概率为:P(S∣G) = 50% <br/>这是因为女生在长发和短发之间平分秋色。</li><li id="899d" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">假设学生是男生，留短发的学生的相关概率是:P(S∣B)=100% <br/>因为所有男生都留短发。</li></ul><p id="a53c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以应用公式来计算<strong class="lb iu">条件概率</strong>:</p><p id="25ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">p(g∣s)= p(g)p(s∣g)/p(s)= 0.4×0.5/0.8 = 0.25→25%</p><p id="0f53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">综上，留短发的学生是女生的概率是16%。</p><h1 id="b88b" class="nd mg it bd mh ne nf ng mk nh ni nj mn jz nk ka mq kc nl kd mt kf nm kg mw nn bi translated">理解医学测试的贝叶斯定理</h1><p id="9c3a" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">为了评估诊断测试的性能，我们需要使用通常所说的混淆矩阵。这是一个简单的2乘2表格网格，其中计算了测试的预测与患者的真实情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/d4ac8d323773014b7900c008d7cad110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PeHQw1IH61japZ13l7HXLw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">混乱矩阵(图片由作者提供)</p></figure><p id="f27f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果患者被预测为阳性，并且确实受到疾病的影响，则称之为<strong class="lb iu">真阳性</strong>。</p><p id="4b16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与之相反的是<strong class="lb iu">真阴性</strong>，患者是健康的，并且预测如此。</p><p id="f22c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">剩下的元素是夫妇<strong class="lb iu">假阳性</strong>，被认为受影响但健康的人和<strong class="lb iu">假阴性</strong>，被认为健康但患病。</p><p id="75bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很容易看出最后两种在医学上是最危险的。一个假阳性的个体最好的情况是受到惊吓，最坏的情况是不需要治疗。假阴性反而会推迟必要的治疗。</p><h2 id="bedd" class="mf mg it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">医学悖论</h2><p id="9c88" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们看一个医学测试和逻辑错误的例子，这种逻辑错误经常被称为医学悖论，尽管这种说法并不恰当。</p><p id="da16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们假设我们有一个医学测试，它被宣传有99%的准确率，对于一种影响0.1%人口的疾病。如果在10万人身上进行。该测试有以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/7311e160c636b8384d178141337d670f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jqoiXIA3Fgl6KbI9awkwjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对10万人的测试结果(图片由作者提供)</p></figure><p id="1430" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想了解:</p><blockquote class="od oe of"><p id="cc38" class="kz la me lb b lc ld ju le lf lg jx lh og lj lk ll oh ln lo lp oi lr ls lt lu im bi translated">测试P(+)结果为阳性，以及受疾病P(D|+)影响的概率是多少？</p></blockquote><p id="3048" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给定99%的测试准确度，我们可能认为有99%的测试是准确的。但是贝叶斯定理告诉我们一些其他的东西。让我们看看如何:</p><p id="3b4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们找到贝叶斯定理的所有元素:</p><ul class=""><li id="7e76" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">被疾病感染的概率(D)，未经检验等于它在人群中的传播，这是<em class="me">先验</em>假设:<em class="me"> P(D) = 0.1%。</em></li><li id="6882" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">与之相反，不患此病的是:<em class="me"> P( D) = 1-P(D) = 99.9% </em></li><li id="f983" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">测试结果为阳性的概率是所有阳性结果的总和除以品尝的总人数:(97+999)/100，000 = <em class="me"> P(+) = 1.096% </em></li><li id="0110" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">与之相反的是<em class="me"> P(-) = 1-P(+) = 98.904% </em></li></ul><p id="6ff0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用混淆矩阵，我们可以构建另一个矩阵来帮助我们解决问题:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/c073751f35515c6d9f7e19fe9e41f012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DXryyfZ4euzwXJcGLxOCJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="557b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们计算一下，这相当于:</p><ul class=""><li id="fcc4" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">TPR通常被称为<em class="me">灵敏度</em>，代表P(+|D)，等于97%。</li><li id="3628" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">TNR或更一般的<em class="me">特异性</em>，因此P(-| D)等于99%。</li><li id="b70f" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">FNR也称为<em class="me">遗漏率</em>，P(-|D)等于3%。</li><li id="ae90" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">FPR已知<em class="me">虚警</em> P(+| D)的概率为1%</li></ul><p id="7af7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这些指标中，灵敏度<em class="me">和特异性<em class="me">是与医学测试最相关的指标，通常最好有一项测试能预测更多的FP而不是FN，因为通常会进行第二次测试来确认疾病，而几乎没有人想再次检查他们是否没事。</em></em></p><p id="9b26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到我们的问题，看看在测试呈阳性时感染该疾病的概率是多少，我们可以在以下公式中看到所有结果:</p><ul class=""><li id="f1ac" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">P(D|+)= P(+|D) P(D)/P(+) → 8.9%</li><li id="21b1" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">P( D|+) = P(+| D) P( D) /P(+) → 91.1%</li><li id="e56d" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">P(D|-) = P(-|D) P(D)/P(-) → 0%</li><li id="f9f7" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">P( D|-) = P(-| D) P( D)/P(-) → 91.1%</li></ul><blockquote class="od oe of"><p id="1827" class="kz la me lb b lc ld ju le lf lg jx lh og lj lk ll oh ln lo lp oi lr ls lt lu im bi translated">我们可以看到，如果我们以99%的准确度测试阳性，我们仍然有91%的概率P( D|+)健康，只有9%的概率P(D|+)患病。这比99%更不可怕。</p></blockquote><p id="fda4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于我们的测试和疾病的传播，有1.1%的人测试呈阳性，只有9%的人在测试中实际患病。</p><h1 id="fd2b" class="nd mg it bd mh ne nf ng mk nh ni nj mn jz nk ka mq kc nl kd mt kf nm kg mw nn bi translated">给定两个阳性测试的患病概率</h1><p id="4a6d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">然而，让我们想象我们想要使用相同的程序做第二个测试。</p><blockquote class="od oe of"><p id="9f4f" class="kz la me lb b lc ld ju le lf lg jx lh og lj lk ll oh ln lo lp oi lr ls lt lu im bi translated">鉴于<strong class="lb iu">两次</strong>阳性检测，受影响的概率有多大？</p></blockquote><p id="c1a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要计算两次结果为正的概率。应该是:</p><p id="9eb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">P(++) = P(+│D) P(D)+P(+│ D) P( D)</p><p id="c2a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们计算一下，结果会是:0.0010408</p><p id="2cbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，为了计算P(D|++ ),我们将使用以下公式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/86f64eb9ad56457cecd97a64fc1a93ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*dHrwabk96fck4S6z_9YZ_g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">给定两个阳性和相等测试的患病概率(图片由作者提供)</p></figure><p id="dec9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在的结果是:90.4%</p><p id="0df8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着我们几乎可以肯定，如果进行第二次阳性测试，结果是正确的。我们可以通过增加第三个测试等等来尝试。</p><p id="d4b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">贝叶斯测试的美妙之处在于，我们可以根据新的测试来更新我们的信念。</p></div></div>    
</body>
</html>