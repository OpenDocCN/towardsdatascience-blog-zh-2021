<html>
<head>
<title>Automatic Update of Django Models from a Google Spreadsheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Google电子表格自动更新Django模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automatic-update-of-django-models-from-a-google-spreadsheet-7c6d4f30e3ca?source=collection_archive---------18-----------------------#2021-10-25">https://towardsdatascience.com/automatic-update-of-django-models-from-a-google-spreadsheet-7c6d4f30e3ca?source=collection_archive---------18-----------------------#2021-10-25</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="6cb6" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph">数据输入</h2><div class=""/><div class=""><h2 id="fb64" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">关于如何直接从Google电子表格创建和更新Django模型的现成Python教程</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/4979e8a743f17057bab2cdf7dd5a1db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzSBA8wWeNNDbmwmcAEMGA.jpeg"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="8b89" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">通常，数据模型定义和数据模型实现是由不同的人执行的，数据模型定义中的一点点变化都应该尽快转换成实现的模型。</p><p id="2fe0" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated"><strong class="lm jg">模型变化转化为实现的速度取决于定义和实现之间的关系。</strong></p><p id="687d" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">在本教程中，我提出了一种机制，将模型中的变化直接转化为实现中的变化。我利用以下工具:</p><ul class=""><li id="faa5" class="mg mh iw lm b ln lo lq lr lt mi lx mj mb mk mf ml mm mn mo bi translated"><strong class="lm jg">数据模型定义的谷歌电子表格</strong></li><li id="662b" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg"> Python </strong>将电子表格中的更改转化为Django的更改</li><li id="4c76" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated">Django 在Web界面中呈现模型。</li></ul><p id="b9e9" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">通过Google电子表格自动更新Django中的数据模型需要三个步骤:</p><ul class=""><li id="3d62" class="mg mh iw lm b ln lo lq lr lt mi lx mj mb mk mf ml mm mn mo bi translated"><strong class="lm jg">谷歌电子表格中的数据模型定义</strong></li><li id="2973" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg">模型转换</strong>从Google电子表格到Django模型</li><li id="e5b0" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg">Django的车型更新</strong></li></ul><h1 id="3934" class="mu mv iw bd mw mx my mz na nb nc nd ne kl nf km ng ko nh kp ni kr nj ks nk nl bi translated">1数据模型定义</h1><p id="b3f2" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">首先，我定义了一个基本的数据模型。例如，我可以考虑三个表:</p><ul class=""><li id="53e5" class="mg mh iw lm b ln lo lq lr lt mi lx mj mb mk mf ml mm mn mo bi translated"><code class="fe nr ns nt nu b">Person(<strong class="lm jg">id</strong>,name,surname,birthDate,sex)</code></li><li id="ddb7" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><code class="fe nr ns nt nu b">Organization(<strong class="lm jg">id</strong>,name,address,website,locality)</code></li><li id="de5c" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><code class="fe nr ns nt nu b">Staff(person_id,organization_id)</code></li></ul><p id="b043" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">然后，我创建了一个新的Google电子表格，并为每个表格分配了一个工作表，如本例所示。对于每个表，我定义了以下列:</p><ul class=""><li id="5c4e" class="mg mh iw lm b ln lo lq lr lt mi lx mj mb mk mf ml mm mn mo bi translated"><strong class="lm jg">属性— </strong>表格的属性列表</li><li id="286e" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg">描述</strong> —属性代表什么</li><li id="6f5e" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg">数据类型</strong> —属性数据类型</li><li id="cd75" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg">最大长度</strong> —字符型变量的最大长度。它仅对字符属性有效</li><li id="549e" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg">关键字</strong> —指定属性是否为关键字(主关键字或外键)</li><li id="ea1a" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><strong class="lm jg">外键表</strong> —如果属性是外键，指定相关的表</li></ul><p id="b798" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">下图显示了Person表的构建表:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj nw"><img src="../Images/ba5c0ba12ea2746a69814437b04379e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F683Rn0dTSoo9ZwPsiA0Hw.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="84e6" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated"><strong class="lm jg">数据模型可由模型设计者动态更新，无需考虑任何实现。他们甚至可以通过添加或删除属性，向电子表格中添加其他表格或修改现有表格。</strong></p><p id="f6a1" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">模型设计者尊重表格的结构就足够了。</p><h1 id="ede8" class="mu mv iw bd mw mx my mz na nb nc nd ne kl nf km ng ko nh kp ni kr nj ks nk nl bi translated">2模型到Django模型的转换</h1><p id="a336" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">下一步包括从Google电子表格到Django的模型转换。这可以通过用Google电子表格的内容动态构建Django模型来实现。实际上，<strong class="lm jg">我可以编写一个Python代码，根据Google电子表格动态生成Django </strong> <code class="fe nr ns nt nu b"><strong class="lm jg">model.py</strong></code> <strong class="lm jg">脚本。</strong></p><p id="f546" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">模型转换可以通过三个步骤实现:</p><ul class=""><li id="5aa8" class="mg mh iw lm b ln lo lq lr lt mi lx mj mb mk mf ml mm mn mo bi translated">阅读谷歌电子表格</li><li id="64e6" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated">创建表和Django模型类之间的映射</li><li id="6fdf" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated">创建<code class="fe nr ns nt nu b">model.py</code>脚本的内容</li></ul><h2 id="1917" class="nx mv iw bd mw ny nz dn na oa ob dp ne lt oc od ng lx oe of ni mb og oh nk jc bi translated">2.1阅读谷歌电子表格</h2><p id="1635" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">在我之前的文章中，我描述了如何用Python加载Google文档的内容。关于Google电子表格，认证的过程非常相似，不同之处在于Google电子表格API应该在Google控制台中启用，而不是在Google文档API中启用。</p><p id="e9a7" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">为了完整起见，我在这里报告了用于身份验证的Python代码:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="9966" class="nx mv iw nu b gz om on l oo op">from __future__ import print_function<br/>import os.path<br/>from googleapiclient.discovery import build<br/>from google_auth_oauthlib.flow import InstalledAppFlow<br/>from google.auth.transport.requests import Request<br/>from google.oauth2.credentials import Credentials</span><span id="8faa" class="nx mv iw nu b gz oq on l oo op"># If modifying these scopes, delete the file token.json.<br/>SCOPES = ['<a class="ae nv" href="https://www.googleapis.com/auth/spreadsheets.readonly'" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/spreadsheets.readonly'</a>]</span><span id="5f8c" class="nx mv iw nu b gz oq on l oo op"># The ID and range of a sample spreadsheet.<br/>SPREADSHEET_ID = 'YOUR DOCUMENT ID'<br/></span><span id="6818" class="nx mv iw nu b gz oq on l oo op">creds = None<br/># The file token.json stores the user's access and refresh tokens, and is created automatically when the authorization flow completes #for the first time.<br/>if os.path.exists('token.json'):<br/>    creds = Credentials.from_authorized_user_file('token.json', SCOPES)<br/># If there are no (valid) credentials available, let the user log in.<br/>if not creds or not creds.valid:<br/>    if creds and creds.expired and creds.refresh_token:<br/>        creds.refresh(Request())<br/>    else:<br/>        flow = InstalledAppFlow.from_client_secrets_file(<br/>            'credentials.json', SCOPES)<br/>        creds = flow.run_local_server(port=0)<br/>    # Save the credentials for the next run<br/>    with open('token.json', 'w') as token:<br/>        token.write(creds.to_json())</span></pre><p id="d460" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">认证后，我可以加载Google电子表格的内容:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="fd6d" class="nx mv iw nu b gz om on l oo op">service = build('sheets', 'v4', credentials=creds)<br/>sheet = service.spreadsheets()<br/>sheet_metadata = service.spreadsheets().get(spreadsheetId=SPREADSHEET_ID).execute()</span></pre><p id="4924" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">并把它转换成熊猫字典的数据框架。实际上，字典中的每一项都是Google电子表格的一个表，相关的键是表名:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="e2b7" class="nx mv iw nu b gz om on l oo op">df_dict = {}</span><span id="9eee" class="nx mv iw nu b gz oq on l oo op">properties = sheet_metadata.get('sheets')</span><span id="8ca0" class="nx mv iw nu b gz oq on l oo op">for  item in properties:<br/>    table = item.get('properties').get('title')<br/>    df_dict[table] = pd.DataFrame()<br/>    <br/>    result = sheet.values().get(spreadsheetId=SPREADSHEET_ID,<br/>                                range=table + '!A1:F').execute()<br/>    header = result.get('values', [])[0]<br/>    <br/>    values = result.get('values', [])[1:] <br/>    if not values:<br/>        print('No data found.')<br/>    else:<br/>        all_data = []<br/>        for col_id, col_name in enumerate(header):<br/>            column_data = []<br/>            for row in values:<br/>                if col_id &lt; len(row):<br/>                    column_data.append(row[col_id])<br/>                else:<br/>                    column_data.append('')</span><span id="373a" class="nx mv iw nu b gz oq on l oo op">            ds = pd.Series(data=column_data, name=col_name)<br/>            all_data.append(ds)<br/>        df_dict[table] = pd.concat(all_data, axis=1)</span></pre><h2 id="5bd6" class="nx mv iw bd mw ny nz dn na oa ob dp ne lt oc od ng lx oe of ni mb og oh nk jc bi translated">2.2创建表和Django模型类之间的映射</h2><p id="5346" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">这一步可以通过构建一个表来轻松完成，该表将每个数据帧的列映射到Django模型类的属性:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="7380" class="nx mv iw nu b gz om on l oo op">tables = {}<br/>for table,df in df_dict.items():<br/>    tables[table] = {}<br/>    for i in range(0, df.shape[0]):<br/>        attr = {}<br/>        attr['default'] = 'None'<br/>        if df['MAX LENGTH'][i] != '':<br/>            attr['max_length'] = df['MAX LENGTH'][i]<br/>        if df['KEY'][i] == 'primary key':<br/>            attr['primary_key'] = 'True'<br/>        tables[table][df['ATTRIBUTES'][i]] = [df['DATA TYPE'][i], attr]</span></pre><p id="5653" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">它产生以下输出:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="88fe" class="nx mv iw nu b gz om on l oo op">{<br/>'<strong class="nu jg">PERSON</strong>': {<br/>  '<strong class="nu jg">id</strong>'    : ['Integer', {'default': 'None', 'primary_key': 'True'}],<br/>  '<strong class="nu jg">Name</strong>'  : ['Char', {'default': 'None', 'max_length': '32'}],<br/>  '<strong class="nu jg">Surname</strong>': ['Char', {'default': 'None', 'max_length': '32'}],<br/>  '<strong class="nu jg">BirthDate</strong>': ['Date', {'default': 'None'}],<br/>  '<strong class="nu jg">Sex</strong>'.  : ['Char', {'default': 'None', 'max_length': '1'}]},</span><span id="0f09" class="nx mv iw nu b gz oq on l oo op"> '<strong class="nu jg">ORGANIZATION</strong>': {<br/>  '<strong class="nu jg">id</strong>'  : ['Integer', {'default'  : 'None', 'primary_key': 'True'}],<br/>  '<strong class="nu jg">Name</strong>'    : ['Char', {'default': 'None', 'max_length': '64'}],<br/>  '<strong class="nu jg">Address</strong>' : ['Char', {'default': 'None', 'max_length': '128'}],<br/>  '<strong class="nu jg">WebSite</strong>' : ['Char', {'default': 'None', 'max_length': '128'}],<br/>  '<strong class="nu jg">Locality</strong>': ['Char', {'default': 'None', 'max_length': '64'}]},</span><span id="2452" class="nx mv iw nu b gz oq on l oo op"> '<strong class="nu jg">STAFF</strong>'.   : {<br/>  '<strong class="nu jg">person_id</strong>': ['Integer', {'default': 'None'}],<br/>  '<strong class="nu jg">organization_id</strong>': ['Integer', {'default': 'None'}]}<br/>}</span></pre><p id="6ca2" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">在实践中，为每个表构建属性列表，并为每个属性将表列转换为Django模型属性。</p><h2 id="928f" class="nx mv iw bd mw ny nz dn na oa ob dp ne lt oc od ng lx oe of ni mb og oh nk jc bi translated">2.3创建<code class="fe nr ns nt nu b">model.py</code>脚本的内容</h2><p id="5860" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">模型转换的最后一步包括动态生成<code class="fe nr ns nt nu b">model.py</code>脚本。</p><p id="e570" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">我定义了一个函数来解析上一个表中的每一项，并为Django类中的每个属性构建代码:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="2732" class="nx mv iw nu b gz om on l oo op">def <strong class="nu jg">get_type</strong>(attr_type):<br/>    if isinstance(attr_type, list):<br/>        attr = attr_type[0] + 'Field('<br/>        for k,v in attr_type[1].items():<br/>            attr = attr + k + '=' + v + ','<br/>        attr = attr[:-1]<br/>        return attr + (')\n')<br/>    else:<br/>        return attr_type + 'Field()\n'</span></pre><p id="1906" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">然后我构建一个字符串，它将包含<code class="fe nr ns nt nu b">model.py</code>文件的所有内容。我用静态代码初始化它:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="9a4a" class="nx mv iw nu b gz om on l oo op">script = 'from django.db import models\n'</span></pre><p id="a4d7" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">然后，我为表中的每一项构建一个Django模型类:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="b18f" class="nx mv iw nu b gz om on l oo op">for model,attributes in tables.items():<br/>    script = script + "class " + model + "(models.Model):\n"<br/>    for attr_name,attr_type in attributes.items():<br/>        script = script + '\t' + attr_name + ' = models.' + get_type(attr_type)</span></pre><p id="4f9f" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">最后，我将结果保存到名为<code class="fe nr ns nt nu b">model.py</code>的文件中:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="e7b2" class="nx mv iw nu b gz om on l oo op">root = 'mywebsite/myapp/'<br/>file_name = root + 'models.py'<br/>with open(file_name, "w") as py_file:<br/>    py_file.write(script)</span></pre><h1 id="73de" class="mu mv iw bd mw mx my mz na nb nc nd ne kl nf km ng ko nh kp ni kr nj ks nk nl bi translated">3在Django更新模型</h1><p id="4823" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">现在我准备对Django进行修改。我只需运行以下命令:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="21b1" class="nx mv iw nu b gz om on l oo op">python3 manage.py makemigrations</span></pre><p id="86ed" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">这将给出以下输出:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj or"><img src="../Images/614d080263c2d834605fcf9837497375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpQ2IGJJ9idNA5CilvwwHQ.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="8881" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">最后:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="d770" class="nx mv iw nu b gz om on l oo op">python3 manage.py migrate</span></pre><p id="b458" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">该命令应该将三个表添加到数据库中:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj os"><img src="../Images/bd5b0db9cc4c3d177599972fa82f63c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*LnlbMqXpD3pD4s6Io599pQ.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><h1 id="ea77" class="mu mv iw bd mw mx my mz na nb nc nd ne kl nf km ng ko nh kp ni kr nj ks nk nl bi translated">摘要</h1><p id="8e01" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">在本教程中，我展示了如何从Google电子表格中自动更新Django模型。这个过程允许同步数据模型和数据实现，尽管这两个过程由不同的人管理。</p><p id="ef1b" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">如果你已经走了这么远来阅读，对我来说今天已经很多了。谢谢！你可以在<a class="ae nv" href="https://alod83.medium.com/which-topics-would-you-like-to-read-c68314dc6813" rel="noopener">这篇文章</a>中读到更多关于我的信息。</p><h1 id="42ad" class="mu mv iw bd mw mx my mz na nb nc nd ne kl nf km ng ko nh kp ni kr nj ks nk nl bi translated">你愿意支持我的研究吗？</h1><p id="afc6" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">你可以每月订阅几美元，解锁无限的文章——<a class="ae nv" href="https://alod83.medium.com/membership" rel="noopener">点击这里</a>。</p><h1 id="a9eb" class="mu mv iw bd mw mx my mz na nb nc nd ne kl nf km ng ko nh kp ni kr nj ks nk nl bi translated">额外奖金</h1><p id="77d0" class="pw-post-body-paragraph lk ll iw lm b ln nm kg lp lq nn kj ls lt no lv lw lx np lz ma mb nq md me mf ip bi translated">我可以在Django中配置管理控制台，以便手动插入记录。这可以通过将每个创建的模型类注册到管理控制台来实现。我可以通过创建一个<code class="fe nr ns nt nu b">admin.py</code>脚本来自动完成:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="cc3a" class="nx mv iw nu b gz om on l oo op">script = """from django.contrib import admin\n</span><span id="c027" class="nx mv iw nu b gz oq on l oo op">from .models import *<br/>"""</span><span id="6317" class="nx mv iw nu b gz oq on l oo op">for model in tables.keys():<br/>    script = script + "admin.site.register(" + model + ")\n"</span></pre><p id="d003" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">然后，我可以保存文件:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="f582" class="nx mv iw nu b gz om on l oo op">file_name = root + 'admin.py'<br/>with open(file_name, "w",encoding='utf-8') as py_file:<br/>    py_file.write(script)</span></pre><p id="9b27" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">然后，我可以再次应用迁移并创建一个新的超级用户:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="b0b0" class="nx mv iw nu b gz om on l oo op">python3 manage.py makemigrations<br/>python3 manage.py migrate<br/>python3 manage.py createsuperuser</span></pre><p id="9190" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">最后，我可以运行应用程序:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="b300" class="nx mv iw nu b gz om on l oo op">python3 manage.py runserver</span></pre><p id="73f4" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">并连接到管理控制台:</p><pre class="kv kw kx ky gu oi nu oj ok aw ol bi"><span id="10c6" class="nx mv iw nu b gz om on l oo op"><a class="ae nv" href="http://127.0.0.1:8000/admin" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/admin</a></span></pre><p id="c035" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">在这里我可以看到我的表并添加新记录:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ot"><img src="../Images/4a7b8024009ca08900a307dda51ce7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZB-0vXpii1t-dka_h23GYg.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="6c54" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">本教程的所有代码都可以从我的<a class="ae nv" href="https://github.com/alod83/data-science/tree/master/DataVisualization/Django" rel="noopener ugc nofollow" target="_blank"> Github库</a>下载。</p><h1 id="9592" class="mu mv iw bd mw mx my mz na nb nc nd ne kl nf km ng ko nh kp ni kr nj ks nk nl bi translated">相关文章</h1><div class="ou ov gq gs ow ox"><a rel="noopener follow" target="_blank" href="/building-a-fast-web-interface-in-django-for-data-entry-62f24947ef23"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd jg gz z fq pc fs ft pd fv fx jf bi translated">在Django中构建数据输入的快速Web界面</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">关于如何安装Django并利用它快速构建数据输入的Web界面的教程</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">towardsdatascience.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl le ox"/></div></div></a></div><div class="ou ov gq gs ow ox"><a rel="noopener follow" target="_blank" href="/how-to-manipulate-a-pandas-dataframe-in-sql-7d1a1503f47"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd jg gz z fq pc fs ft pd fv fx jf bi translated">如何在SQL中操作熊猫数据帧</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">这是一个现成的代码，包含一些使用SQL查询操作Python Pandas数据框架的技巧。</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">towardsdatascience.com</p></div></div><div class="pg l"><div class="pm l pi pj pk pg pl le ox"/></div></div></a></div><div class="ou ov gq gs ow ox"><a rel="noopener follow" target="_blank" href="/how-to-scrape-html-tables-with-python-pandas-98d18d2129cb"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd jg gz z fq pc fs ft pd fv fx jf bi translated">如何用Python熊猫刮HTML表格</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">一个现成的代码，它利用了Python熊猫库的read_html()函数</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">towardsdatascience.com</p></div></div><div class="pg l"><div class="pn l pi pj pk pg pl le ox"/></div></div></a></div></div></div>    
</body>
</html>