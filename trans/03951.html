<html>
<head>
<title>Binary classification with automated machine learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于自动机器学习的二元分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/binary-classification-with-automated-machine-learning-1a36e78ba50f?source=collection_archive---------26-----------------------#2021-04-02">https://towardsdatascience.com/binary-classification-with-automated-machine-learning-1a36e78ba50f?source=collection_archive---------26-----------------------#2021-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3ff0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用开源的MLJAR auto-ML更快地构建精确的模型</h2></div><p id="8621" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自动化<a class="ae lb" href="https://www.machinelearningnuggets.com/" rel="noopener ugc nofollow" target="_blank">机器学习</a>工具的兴起让开发者能够更快地建立准确的机器学习模型。这些工具通过执行特征工程、算法选择、调整以及记录模型来减少工程师的工作。一个这样的库是开源的<a class="ae lb" href="https://github.com/mljar/mljar-supervised" rel="noopener ugc nofollow" target="_blank"> MLJAR </a>包。在本文中，让我们看看如何使用这个包进行二进制分类。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="59b4" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">入门指南</h2><p id="7f1a" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">MLJAR包可以用来建立一个完整的机器学习管道，具有特征工程和超参数调整功能。该软件包还支持流行的机器学习算法，包括:</p><ul class=""><li id="f7a3" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated"><a class="ae lb" href="https://heartbeat.fritz.ai/introduction-to-deep-learning-with-keras-c7c3d14e1527" rel="noopener ugc nofollow" target="_blank">神经网络</a></li><li id="9a6e" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><a class="ae lb" href="https://heartbeat.fritz.ai/boosting-your-machine-learning-models-using-xgboost-d2cabb3e948f" rel="noopener ugc nofollow" target="_blank"> XGBoost </a></li><li id="d4e0" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><a class="ae lb" href="https://heartbeat.fritz.ai/fast-gradient-boosting-with-catboost-38779b0d5d9a" rel="noopener ugc nofollow" target="_blank"> Catboost </a></li><li id="5e8f" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><a class="ae lb" href="https://heartbeat.fritz.ai/lightgbm-a-highly-efficient-gradient-boosting-decision-tree-53f62276de50" rel="noopener ugc nofollow" target="_blank"> LightGBM </a>等等。</li></ul><p id="3c4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://supervised.mljar.com/" rel="noopener ugc nofollow" target="_blank"> MLJAR </a>根据选择的算法建立几个模型，并通过集合或堆叠模型获得最终预测。一旦训练完成，该软件包还提供可视化，可用于解释模型。其中包括功能重要性以及显示各种型号性能的排行榜。</p><p id="217e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了开始使用这个包，你需要通过<code class="fe mv mw mx my b">pip</code>安装它。</p><pre class="mz na nb nc gt nd my ne nf aw ng bi"><span id="a8d3" class="lj lk iq my b gy nh ni l nj nk">pip install mljar-supervised</span></pre><h2 id="134f" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">获取数据</h2><p id="fa25" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">对于这个示例，让我们使用<a class="ae lb" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html" rel="noopener ugc nofollow" target="_blank"> Scikit-learn </a>来创建一个分类数据集。这可以使用数据集模块中的<code class="fe mv mw mx my b">make_classification</code>函数来完成。</p><figure class="mz na nb nc gt nl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="5c42" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是将这个数据集分成训练集和测试集。</p><figure class="mz na nb nc gt nl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="e4e8" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">使用MLJAR进行二元分类</h2><p id="6261" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">令人惊讶的是，使用MLJAR进行二进制分类只需要几行代码。MLJAR在幕后负责所有的机器学习魔法。这里的第一步是导入<code class="fe mv mw mx my b">AutoML</code>类。</p><figure class="mz na nb nc gt nl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="20ef" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是创建该类的一个实例，同时指定您希望用于解决该问题的算法。可以设置的其他参数包括:</p><ul class=""><li id="312f" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated"><strong class="kh ir">模式</strong> —该套件配有四种内置模式。<code class="fe mv mw mx my b">Explain</code>模式是解释和理解数据的理想模式。它产生了特征重要性的可视化以及树的可视化。在为生产建立ML模型时使用<code class="fe mv mw mx my b">Perform</code>。<code class="fe mv mw mx my b">Compete</code>是为了建立用于机器学习竞赛的模型。<code class="fe mv mw mx my b">Optuna</code>模式用于搜索高度调谐的ML模型。</li><li id="c822" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir">算法</strong> —指定您想要使用的算法。它们通常作为列表传入。</li><li id="4fad" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir">结果路径— </strong>存储结果的路径</li><li id="8768" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir"> total_time_limit </strong> —训练模型的总时间(秒)</li><li id="ca67" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir"> train_ensemble — </strong>指示是否在训练过程结束时创建一个集合</li><li id="8d4e" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir"> stack_models </strong> —决定是否创建模型堆栈</li><li id="5742" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated"><strong class="kh ir"> eval_metric </strong> —将被优化的度量。如果<code class="fe mv mw mx my b">auto</code><code class="fe mv mw mx my b">logloss</code>用于分类问题，而<code class="fe mv mw mx my b">rmse</code>用于回归问题</li></ul><figure class="mz na nb nc gt nl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="298b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是使算法适合训练和测试集。</p><figure class="mz na nb nc gt nl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi no"><img src="../Images/a656264c80de4b620eaab1e6416b24b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PheQr6KfdjLkQ8A5f_cZXw.png"/></div></div></figure><h2 id="7e82" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">MLJAR解释</h2><p id="1525" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">模型拟合后，您可以使用<code class="fe mv mw mx my b">report</code>功能获得各种模型解释。例如，您可以看到符合此二元分类问题的模型的排行榜。</p><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/88c01baaeda3b1158d2faf7db2c4e727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-cLucgPcHJ2i45HFJevAg.png"/></div></div></figure><p id="473f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当您单击单个模型时，您还会看到几个可视化效果和模型摘要。</p><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/50fff70e96919329dcf24740cfe05d36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n6Pp7UOhfOln7xLbbL_sfQ.png"/></div></div></figure><p id="3dea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，你会看到混淆矩阵。</p><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/468840b9d33991a5b671fdf07a2aa9ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G6ci8lhXm9DvX5Hq5vql7w.png"/></div></div></figure><p id="e604" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MLJAR还会默认显示训练过程的学习曲线。为验证集和训练集绘制学习曲线。垂直线显示最佳迭代次数，用于进行预测。</p><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/e5b833f5ebdfa0bb96f1c75758c5d7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wIsTKSBZLN6Ho-MtX2yZjA.png"/></div></div></figure><p id="99e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你也可以从报告中发现特性的重要性。这是排列重要性的例子。使用Sckit-learn的<a class="ae lb" href="https://scikit-learn.org/stable/modules/generated/sklearn.inspection.permutation_importance.html" rel="noopener ugc nofollow" target="_blank">排列重要性</a>进行计算。</p><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/49a2fbe420afece2cf1b07eb6cf1c8c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aOsKmiOdgcwqM2iLx4SqXQ.png"/></div></div></figure><p id="b585" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MLJAR还绘制了<a class="ae lb" href="https://www.kaggle.com/wrosinski/shap-feature-importance-with-feature-engineering" rel="noopener ugc nofollow" target="_blank"> SHAP重要性</a>。</p><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/3defff127340473045ded3e590ae8ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5hUSnJ7wBVRxXtUg38pftA.png"/></div></div></figure><p id="a64a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它还显示了SHAP重要依赖图。</p><figure class="mz na nb nc gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/d631d1e205c7759e72f90ef449172e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqzLhUK1lQur0aH2U3PJWg.png"/></div></div></figure><h2 id="55b6" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">姆加魔法</h2><p id="280b" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">当用MLJAR训练一个模型时，在幕后会发生一些事情。机器学习模型的训练分几个步骤进行。这些步骤需要:</p><ul class=""><li id="20e2" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated">训练简单的算法，如决策树，以获得快速的洞察力。</li><li id="1f28" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">使用默认超参数训练模型。这里每个算法都有一个模型。</li><li id="98ea" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">在给定的超参数上执行随机搜索。</li><li id="dc2a" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">从原始数据中构建新的特征，使模型具有更强的预测能力。MLJAR将这些特性称为黄金特性。这些特性可以在结果路径中的一个名为<code class="fe mv mw mx my b">golden_features.json</code>的文件中找到。这些特征被添加到数据中，并且使用Xgboost、CatBoost和LightGBM算法来训练新的模型。</li><li id="c8f8" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">为每个算法获得的最佳模型被选择，并且其超参数被用于基于一组选择的特征来训练新的模型。</li><li id="7c40" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">模型被进一步调整，然后被集合。</li></ul><h2 id="e211" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">为什么要使用MLJAR</h2><p id="6f63" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">人们为什么会考虑在机器学习工作流中使用MLJAR有几个原因:</p><ul class=""><li id="b1b3" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated">它执行特征预处理，例如缺失值的插补和类别的转换</li><li id="e56d" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">执行高级特征工程</li><li id="e81a" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">能够转换时间和日期</li><li id="42b4" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">执行超参数调谐</li><li id="de45" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">提供广泛的模型解释和可视化</li><li id="d221" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">为您运行的每个实验创建降价报告</li></ul></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="f2e1" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">最后的想法</h2><p id="a6af" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">在本文中，您已经看到了如何构建二进制分类模型MLJAR auto-ML。您已经看到这个过程只需要几个步骤。您还看到了MLJAR auto-ML使用多种算法为分类问题构建多种模型。下一步是在您自己的二元分类数据集上使用该包。</p><div class="nw nx gp gr ny nz"><a href="https://github.com/mljar/mljar-supervised/" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">ml jar/ml jar-受监督</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">文档:https://supervised.mljar.com/源代码:https://github.com/mljar/mljar-supervised…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on nt nz"/></div></div></a></div></div></div>    
</body>
</html>