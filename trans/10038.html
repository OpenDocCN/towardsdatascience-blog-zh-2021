<html>
<head>
<title>Re-evaluating Kafka: issues and alternatives for real-time</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重新评价卡夫卡:实时的问题和选择</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/re-evaluating-kafka-issues-and-alternatives-for-real-time-395573418f27?source=collection_archive---------4-----------------------#2021-09-22">https://towardsdatascience.com/re-evaluating-kafka-issues-and-alternatives-for-real-time-395573418f27?source=collection_archive---------4-----------------------#2021-09-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="c9f5" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">行业笔记</a></h2><div class=""/><div class=""><h2 id="bd25" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">卡夫卡的挑战让许多工程师在通往成功数据流的道路上筋疲力尽。如果有更简单的方法呢？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/e047591a508d2e72242e36eb74e1af79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I3Xrt8GP7AZjct3YPrnu7g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图片由<a class="ae le" href="https://pixabay.com/users/mohamed_hassan-5229782/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6038877" rel="noopener ugc nofollow" target="_blank">穆罕默德·哈桑</a>从<a class="ae le" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6038877" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>拍摄</p></figure><p id="ac27" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">与大多数使用Apache Kafka的数据工程师交谈，他们会有很多话要说。他们可以列出这个平台让他们感到沮丧的所有事情，但是以他们喜欢这个平台的事实作为结论。</p><p id="12c4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是怎么回事？</p><p id="8780" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Apache Kafka是现代数据基础设施的基石。在许多方面，它都很出色，但它也带来了一些复杂的问题，对一些用户的影响比其他用户更大。在过去十年左右的时间里，我们已经把卡夫卡视为同类作品中唯一的选择，我们也接受了它将不可避免地挑战我们的观点。</p><p id="8709" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是随着数据领域的迅速扩大，我们不应该继续认为这是理所当然的。可行的、方便用户的替代品正在出现。为了节省时间和精力，值得重新评估最成熟的系统(如Kafka)是否是您组织的最佳选择，或者更新的系统是否更适合。</p><h1 id="e74d" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">什么是阿帕奇卡夫卡，它是做什么的？</h1><p id="995e" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated"><a class="ae le" href="https://kafka.apache.org/intro" rel="noopener ugc nofollow" target="_blank"> Apache Kafka </a>是业界领先的开源事件流媒体平台。由LinkedIn员工于2010年创立，后来捐赠给了阿帕奇基金会。Kafka被誉为一个极其强大的平台，为数千家公司提供数据基础设施基础，包括网飞、Airbnb和Twitter等知名公司。</p><p id="eea6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">卡夫卡被用作<strong class="lh ja">事件总线</strong>。应用程序将事件或消息生成到Kafka中，Kafka将它们记录到有序的消息历史中。其他应用程序按顺序使用这些消息，并在产生新消息时得到实时通知。传统数据库非常适合针对当前状态进行查询和更新，相比之下，Kafka擅长于必须对导致当前状态的各种变化做出快速反应的应用程序。</p><p id="8bc8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Kafka运行在一个容错服务器集群上。被称为<strong class="lh ja">生产者</strong>的客户端系统向Kafka服务器发布或写入事件。另一组叫做<strong class="lh ja">消费者</strong>的客户订阅或阅读这些事件。消息包含在<strong class="lh ja">主题</strong>中，可以进一步划分。</p><p id="a30c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Kafka在一些重要的方面提供了一个替代旧消息队列(如RabbitMQ)的选择，主要是:</p><ul class=""><li id="95cd" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma ne nf ng nh bi translated">通过向集群添加更多的节点和向单个主题添加分区，它可以很容易地进行水平扩展</li><li id="ef45" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">它可以在一段可配置的时间内保存消息，而不是在消息到达消费者时立即删除它们</li></ul><h1 id="46f1" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">卡夫卡有什么好？</h1><p id="bfc2" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">正如我们所看到的，Kafka是第一个此类事件流平台，现在已经有超过十年的成熟度和庞大的用户群。随着对良好管理、低延迟数据流的需求变得越来越明显，即使是最传统的公司也注意到了这一点，并且<a class="ae le" href="https://techbeacon.com/app-dev-testing/what-apache-kafka-why-it-so-popular-should-you-use-it" rel="noopener ugc nofollow" target="_blank">经常转向Kafka </a>。</p><p id="e85b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">对于建立大型、高度定制的数据管道的大型企业，如网飞，卡夫卡可以提供一个支柱。许多其他开源项目都是基于Kafka构建的。如果你有一个致力于Kafka的工程师团队，或者你有很多时间，你可以在各种各样的用例中获得很好的结果。</p><p id="0ddb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">简而言之:卡夫卡快速、高效、可定制、强大，并且在管理得当的情况下非常可靠。</p><h1 id="fd12" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">卡夫卡的问题是什么？</h1><p id="1469" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">作为一个中小型组织的商业领袖，你可能会看到卡夫卡在2010年取得的突破以及随后网飞世界的成功，并感到兴奋。Kafka——开源且维护良好——能解决所有数据孤岛和延迟问题吗？</p><p id="2fdd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">不一定。</p><p id="d320" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Kafka天生就很难实现和维护，以至于许多组织都无法实现他们的目标。作为数据基础设施的主干，Kafka本身就是一个庞大而复杂的系统。最重要的是，当与客户端系统集成时，它会带来额外的复杂性。</p><p id="41c0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这些特有的挑战造成了很高的准入门槛和持续的维护难题。让我们进入更多的细节。</p><p id="c14f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">运行Kafka部署是一项庞大而复杂的工作。从本质上来说，你的Kafka部署肯定是一个大规模的项目。想象一下，运行一个由多个关键应用程序使用的同样大规模的MySQL数据库。几乎可以肯定，您需要雇用一名数据库管理员(或一整个团队)来管理它。卡夫卡也不例外。这是一个大而复杂的系统，往往由多个客户端应用程序共享。当然不好操作！</p><p id="ec14" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Kafka管理员必须从一开始就回答困难的设计问题。这包括定义消息如何存储在分区主题、保留期以及团队或应用程序配额中。我们不会在这里讨论细节，但是您可以将这个任务看作是设计一个数据库模式，但是增加了时间维度，这增加了复杂性。您需要考虑每条消息代表什么，如何确保它以正确的顺序被使用，在哪里以及如何执行有状态转换，等等——所有这些都要非常精确。</p><p id="e56a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">卡夫卡是一个低级工具。</strong>像MySQL或任何其他数据库一样，Kafka是一个开放式工具，它不会提供一条简单的成功之路。它本身并不能解决实际的业务问题。</p><p id="4adc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了从Kafka中获得任何价值，您需要读写数据的客户端应用程序。卡夫卡本身并不关心这是怎么做到的。相反，它优先考虑处理大量不同用例的灵活性。这是Kafka如此强大的部分原因，但是为了使用Kafka集群做任何有用的事情，您的客户端应用程序需要提出自己关于如何使用这些灵活的API的意见。</p><p id="5ee6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你可能听说过“流媒体很难”这句话，这就是为什么。</p><p id="613d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Kafka可能是开源的，但其固有的困难导致了纯粹为了管理它而存在的公司的激增——包括由创建Kafka的工程团队创建的Confluent。除了专业的工程师团队之外，它根本不是为处理任何事情而设计的。</p><p id="9572" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">除了逻辑上的困难，Kafka还有一些其他的限制，使得它对于某些用例来说不太理想。</p><ul class=""><li id="357d" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma ne nf ng nh bi translated"><strong class="lh ja">即时转型极具挑战性。</strong> Kafka提供了一个消费者框架，可用于在运行时支持流媒体应用，但具体细节取决于您。<a class="ae le" href="https://kafka-tutorials.confluent.io/transform-a-stream-of-events/ksql.html" rel="noopener ugc nofollow" target="_blank"> KsqlDB或者Confluent </a>可以有所帮助，但是自己做起来不太直观。</li><li id="e55d" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">历史数据是有局限性的。尽管Kafka的优势之一是可以持久保存事件，但扩展可能会变得非常困难，并且会受到可用磁盘空间、服务器和持续数据迁移的限制。Kafka最初是为本地存储而设计的，因此在云上部署它(存储几乎不是问题)需要额外的跑腿工作和不断的妥协。公司应该使用速度较慢但更具可扩展性的网络连接永久磁盘，还是速度较快但短暂的固态硬盘(可能需要更多数据迁移)？</li><li id="e770" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated"><strong class="lh ja">卡夫卡不是为</strong> <a class="ae le" href="https://www.estuary.dev/real-time-and-batch-data-processing-an-introduction/" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja">批量数据</strong> </a> <strong class="lh ja">而设计的。</strong>实时数据为许多更新的工作流程提供了动力，但批处理范式远未过时。Kafka不处理batch而不进行一点黑客攻击，用户必须特别小心不要让他们的代理过载大规模的批处理读取——同样的代理负责记录他们新的实时数据</li></ul><h1 id="7c66" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">用新鲜的眼光评价卡夫卡</h1><p id="a586" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">想象一下，经过漫长的过程并克服了无数令人沮丧的障碍，您已经成功地将Kafka部署为您组织的数据管道的中心元素。你也已经弄清楚谁将管理系统的不同方面，<em class="mb">和</em>如何管理组成新团队的人</p><p id="5655" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你觉得很有成就——这是理所当然的。你做了一些有挑战性的事情，建立了一个有价值的系统。到目前为止，你和卡夫卡已经一起经历了很多，你可以可靠地识别和安抚它的大多数怪癖。</p><p id="69ed" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是有几个假设支撑着这个场景:</p><ul class=""><li id="dad7" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma ne nf ng nh bi translated">Kafka是解决数据基础设施问题的唯一解决方案</li><li id="6bb3" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">您的系统的价值值得大量的(时间和精力)成本</li></ul><p id="5410" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们已经接受了卡夫卡的现状，因为多年来它提供了同类中唯一的解决方案。如果获得一个快速、健壮、可扩展的流媒体管道需要一些麻烦，那就这样吧。这是我们必须付出的代价。</p><p id="97c4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在某种程度上，这是有意义的。我们都习惯性地认为，提供高价值的东西也必然伴随着高成本。对于Kafka部署来说，这种成本表现为时间和精力——对于一个公司来说，这基本上与金钱是一回事。</p><p id="f043" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">对于实物商品，随着时间的推移，制造业的进步和竞争的加剧会降低成本。就技术而言，给定解决方案所需的时间和精力同样会减少。说到创建可扩展的实时数据管道，可能是时候重新评估价值和成本了。</p><p id="d255" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在上面这样的场景中，也许我们可以重新定义我们对成功的概念:不是战胜系统固有的复杂性，而是选择一个解决方案，用最少的时间和精力满足我们的需求。</p><h1 id="944c" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">重新思考数据管道的成本和价值</h1><p id="3905" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">许多技术系统，包括用于数据基础设施和分析的系统，正处于类似于工业革命的增长时期。</p><p id="258b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们创建复杂系统的能力有了显著的提高，我们关于数据基础设施可以和应该是什么的想法也发生了变化。初创公司正在为高级分析和数据存储开发新产品和服务。或许更重要的是，正如Bessemer Venture Partners在本文中描述的那样，他们正在使数据集成变得更加简单。</p><p id="054b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">作为其中一家初创公司——河口公司的员工，很容易看到这种转变将在未来几年产生的影响。</p><p id="490b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是这对你意味着什么呢？这意味着你可以比以往任何时候都更自由地评估Kafka(或任何其他大牌数据平台)是否适合你。您可以定义什么使系统对您的组织有价值，并使用它来评估您不断增长的选项库。</p><p id="d5e6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">对于卡夫卡来说，几个备选方案包括<a class="ae le" href="https://pulsar.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇脉冲星</a>、<a class="ae le" href="https://vectorized.io/" rel="noopener ugc nofollow" target="_blank">小熊猫</a>、<a class="ae le" href="https://streamsets.com/" rel="noopener ugc nofollow" target="_blank"> StreamSets </a>，以及河口的新产品<a class="ae le" href="https://www.estuary.dev/product/" rel="noopener ugc nofollow" target="_blank"> Flow </a>。</p><p id="fe88" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，您完全可以期待系统以更少的努力和混乱提供可伸缩性和灵活性。随着技术呈指数级发展，对您的数据基础架构有更高的期望是合理的！</p><p id="0468" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以问自己一些问题，比如:</p><ul class=""><li id="edc9" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma ne nf ng nh bi translated">什么对你更重要:成熟度和用户社区，还是易用性和新的增值？</li><li id="4642" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">Kafka的特定架构是否与您的业务目标保持一致，以至于物流挑战是值得的？</li><li id="961d" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">或者你只是在寻找一个灵活、可靠、实时的数据管道——不一定是卡夫卡？</li><li id="1dda" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">如果您已经有一个Kafka部署，您的团队目前花费在管理它上的一些时间和精力可以用在其他项目上吗？</li></ul><p id="4a6c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">经过这一切，Kafka很可能是你的组织的最佳选择；你可能会发现时间和努力的代价是值得的。新的替代方案虽然发展迅速，但可能仍处于让您的组织感到不舒服的早期阶段。</p><p id="93dd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">无论哪种方式，实时数据基础设施空间都是一个值得以客观的心态在一致的基础上重新评估的空间。直截了当、无摩擦的数据基础设施<em class="mb">是可能的</em>，随着数据在我们现代世界的重要性，我们不应该期望任何东西减少。</p><p id="11b0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="mb">这个故事的一个版本最初发布在</em> <a class="ae le" href="https://www.estuary.dev/blogs/" rel="noopener ugc nofollow" target="_blank"> <em class="mb">河口博客</em> </a> <em class="mb">上。</em></p></div></div>    
</body>
</html>