<html>
<head>
<title>A Worm’s Eye-View of the Markov Switching Dynamic Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">马尔可夫转换动态回归模型的蠕虫视角</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-worms-eye-view-of-the-markov-switching-dynamic-regression-model-2fb706ba69f3?source=collection_archive---------10-----------------------#2021-11-15">https://towardsdatascience.com/a-worms-eye-view-of-the-markov-switching-dynamic-regression-model-2fb706ba69f3?source=collection_archive---------10-----------------------#2021-11-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/33583f9482ecb59c67bf2419866b1727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-6UVw49oMRFpskiVsuMGg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">个人消费支出高波动区域(数据来源<a class="ae jd" href="https://fred.stlouisfed.org/series/PCE" rel="noopener ugc nofollow" target="_blank">美国弗雷德</a>在<a class="ae jd" href="https://fred.stlouisfed.org/searchresults/?st=personal%20consumption%20expenditures&amp;t=public%20domain%3A%20citation%20requested&amp;ob=sr&amp;od=desc&amp;types=gen;cc" rel="noopener ugc nofollow" target="_blank">公共领域</a>许可下)(图片由作者提供)</p></figure><div class=""/><div class=""><h2 id="881c" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">详细解释了MSDR模型，并提供了Python教程来帮助您使用真实世界的数据集在MSDR上运行</h2></div><p id="30a3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">马尔可夫切换动态回归</strong>模型是一种<strong class="kx jh">隐马尔可夫模型</strong>，可以用来表示这样的现象，其中一部分现象是直接观察到的，而其余部分是“隐藏的”。使用<strong class="kx jh">马尔可夫模型</strong>对隐藏部分建模，而使用合适的<strong class="kx jh">时间序列回归模型</strong>对可见部分建模，使得时间序列回归模型的均值和方差根据隐藏马尔可夫模型所处的状态而变化。</p><p id="3f70" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本文的前半部分详细解释了MSDR模型是如何工作的，后半部分是一个快速教程<strong class="kx jh">,讲述如何在真实世界数据集<strong class="kx jh">上使用<strong class="kx jh"> Python </strong>和<strong class="kx jh"> statsmodels </strong>和构建和训练MSDR模型。</strong></strong></p><p id="f4a8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您不熟悉马尔可夫过程，请阅读以下文章:</p><div class="ip iq gp gr ir lr"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-discrete-time-markov-chains-d5be17cf0e12"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jh gy z fp lw fr fs lx fu fw jf bi translated">离散时间马尔可夫链初学者指南</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">以及如何使用Python模拟离散马尔可夫过程的教程</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">towardsdatascience.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf ix lr"/></div></div></a></div><p id="7c55" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于<strong class="kx jh">隐马尔可夫模型</strong>的详细处理，包括MSDR模型，请查看以下内容:</p><div class="ip iq gp gr ir lr"><a rel="noopener follow" target="_blank" href="/a-math-lovers-guide-to-hidden-markov-models-ad718df9fde8"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jh gy z fp lw fr fs lx fu fw jf bi translated">数学爱好者的隐马尔可夫模型指南</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">它们是如何工作的，以及它们为什么被“隐藏”起来。</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">towardsdatascience.com</p></div></div><div class="ma l"><div class="mg l mc md me ma mf ix lr"/></div></div></a></div><h1 id="ee69" class="mh mi jg bd mj mk ml mm mn mo mp mq mr km ms kn mt kp mu kq mv ks mw kt mx my bi translated">MSDR模型的一般说明</h1><p id="f992" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">我们将查看MSDR模型的一般说明，该模型由时间索引因变量<strong class="kx jh"> <em class="ne"> y </em> </strong>、回归变量矩阵<strong class="kx jh"> <em class="ne"> X </em> </strong>、拟合系数向量<em class="ne"><strong class="kx jh"><em class="ne">β_ cap</em></strong>和残差<strong class="kx jh"> <em class="ne"> ε </em> </strong> <em class="ne">组成。</em></em></p><p id="a5b5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">粗体变量表示向量或矩阵。带有“上限”的变量是指该变量的拟合值，即在数据集上训练模型得到的值。</p><h2 id="8041" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">因变量<em class="nr"> y </em></h2><p id="578f" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">设<strong class="kx jh"> <em class="ne"> y </em> </strong> <em class="ne"> </em>为“<em class="ne"> n </em>”时间索引观测值的<em class="ne">【n×1】</em>向量<em class="ne"> y_t: </em></p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/4d6c17fb702dd1de9f2bea0ac34847e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*eMp9mSY9eLLTc4SWGKym4w.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">因变量<strong class="bd nx"> y </strong>(图片作者提供)</p></figure><h2 id="884d" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">回归变量矩阵X</h2><p id="4589" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">设<strong class="kx jh"> <em class="ne"> X </em> </strong>为回归变量的<em class="ne">【n X(m+1)】</em>矩阵。第一列是截距。<strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em>就是这个矩阵的一行。</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/1d92e253cb40faa0c8abc8d773fdb240.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*7zNNSLqU4_L3J1PIml8SUg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归变量矩阵<strong class="bd nx"> X </strong>(图片来自作者)</p></figure><h2 id="fe8e" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">拟合回归系数<strong class="ak"> <em class="nr"> β_cap </em> </strong></h2><p id="1faa" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">设<strong class="kx jh"> <em class="ne"> β_cap </em> </strong>为回归系数的<em class="ne"> [(m+1) X 1] </em>向量。<em class="ne"/><em class="ne">β</em>上的“cap”表示它是模型训练产生的系数的拟合值。</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/bd1ba042b775e1b0ba35b783114b299f.png" data-original-src="https://miro.medium.com/v2/resize:fit:172/format:webp/1*WJ6tQU4KsBco9A3DKskYpw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">拟合回归系数β_cap的向量(图片由作者提供)</p></figure><p id="ac95" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在考虑包含附加误差分量的时间序列模型的以下一般规范:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/076910b886b1efb215af2ed69619563e.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*BjbgLvfaP3s1T0kw226cBA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">y_t表示为平均值和误差项之和(图片由作者提供)</p></figure><p id="7de8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的模型中，观测值<em class="ne"> y_t </em>是预测值<em class="ne"> μ_cap_t </em>和残差<em class="ne"> ε_t </em>之和。我们进一步假设<em class="ne"> ε_t </em>是一个<a class="ae jd" rel="noopener" target="_blank" href="/heteroscedasticity-is-nothing-to-be-afraid-of-730dd3f7ca1f">同态分布</a>和<em class="ne"> N(0，σ ) </em>分布随机变量。</p><p id="7fcd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne"> μ_cap_t </em>是某个回归函数<em class="ne"> η(。)</em>这样说:</p><p id="6afc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne">μ_ cap _ t =η(</em><strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t，</em><strong class="kx jh"><em class="ne">β_ cap</em></strong><em class="ne">)</em></p><ul class=""><li id="a346" class="ob oc jg kx b ky kz lb lc le od li oe lm of lq og oh oi oj bi translated"><em class="ne"> η(。)=0 </em>得出<a class="ae jd" rel="noopener" target="_blank" href="/the-white-noise-model-1388dbd0a7d"> <strong class="kx jh">白噪声模型</strong></a><strong class="kx jh">:</strong><em class="ne">y _ t =ε_ t .</em></li><li id="7b5c" class="ob oc jg kx b ky ok lb ol le om li on lm oo lq og oh oi oj bi translated"><em class="ne"> η(。)=y_bar=(y_1+y2+…+y_n)/n </em>得出<em class="ne"> </em> <a class="ae jd" rel="noopener" target="_blank" href="/the-complete-guide-to-r-squared-adjusted-r-squared-and-pseudo-r-squared-4136650fc06c"> <strong class="kx jh">均值模型</strong></a>:<strong class="kx jh"/><em class="ne">y _ t = y _ bar。</em></li><li id="e5d2" class="ob oc jg kx b ky ok lb ol le om li on lm oo lq og oh oi oj bi translated"><em class="ne"> η(。)=</em><strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em><strong class="kx jh"><em class="ne">β_ cap</em></strong>产量<a class="ae jd" rel="noopener" target="_blank" href="/the-complete-guide-to-r-squared-adjusted-r-squared-and-pseudo-r-squared-4136650fc06c"> <strong class="kx jh">线性模型</strong></a>:y _ t =<strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em><strong class="kx jh"><em class="ne">β_ cap</em></strong><em class="ne">+ε_ t</em></li><li id="37a3" class="ob oc jg kx b ky ok lb ol le om li on lm oo lq og oh oi oj bi translated"><em class="ne"> η(。)= exp(</em><strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em><strong class="kx jh"><em class="ne">β_ cap</em></strong><em class="ne">)</em>产生了<a class="ae jd" rel="noopener" target="_blank" href="/poisson-regression-models-for-time-series-data-sets-54114e68c46d"><strong class="kx jh"/></a>泊松模型或<a class="ae jd" rel="noopener" target="_blank" href="/a-guide-to-building-nonlinear-least-squares-nls-regression-models-310b97a7baeb"> <strong class="kx jh">非线性</strong> </a>泊松模型。</li></ul><p id="a141" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">诸如此类。</p><h2 id="0f61" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">马尔可夫模型中的混合</h2><p id="5adf" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">让我们介绍一下<a class="ae jd" rel="noopener" target="_blank" href="/a-beginners-guide-to-discrete-time-markov-chains-d5be17cf0e12"> k状态马尔可夫过程</a>对上述指定回归模型的影响，如下:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi op"><img src="../Images/b5192bb0e4df6dd6a747b870425a1d12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*JoAqJkPy7mIyiaeDNAbAKA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">用预测均值<em class="nr"> μ_cap_t_j和残差</em> ε_t之和表示的观测值y_t(图片由作者提供)</p></figure><p id="0038" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其中，如前所述，预测平均值是<strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em>和<em class="ne"> β_cap </em> 的函数:</p><p id="dd65" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne">μ_ cap _ t _ j =η(</em><strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t，</em><strong class="kx jh"><em class="ne">β_ cap</em></strong><em class="ne">_ j)</em></p><p id="5579" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是这一次，注意回归系数向量被称为<strong class="kx jh"><em class="ne">β_ cap</em></strong><em class="ne">_ j</em>对应于<em class="ne">第j个</em>马尔可夫状态。</p><p id="1b68" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一般来说，如果马尔可夫模型在'<em class="ne"> k' </em>状态<em class="ne">【1，2，…，j，…，k】</em>上运算，回归系数是大小为<em class="ne"> [(m+1) X k] </em>的矩阵，如下所示:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/c7b86e446d17d4e993a5dd91f0d53cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*alPGxGFgHPSX9flHvMMu4A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">大小为[k x (m+1)]的系数矩阵(图片由作者提供)</p></figure><p id="f5d6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里的直觉是，取决于[1，2，…，k中的哪个马尔可夫状态或“状态”<em class="ne"> j </em> <em class="ne">当前有效，回归模型系数将<strong class="kx jh">切换</strong>到适当的状态特定的<em class="ne">向量</em><strong class="kx jh"><em class="ne">β_ cap</em></strong><em class="ne">_ j</em>从<strong class="kx jh"> <em class="ne"> β_cap_s </em> </strong>因此得名‘马尔可夫<strong class="kx jh">切换</strong>动态回归模型’。</em></p><p id="db53" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne">k</em>-状态马尔可夫过程本身由以下状态转移矩阵<strong class="kx jh"> <em class="ne"> P </em> </strong>支配:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi or"><img src="../Images/23fca6917d721a5b61a785194c67dc59.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*krPHER_cHxUuhHLkNtP6Qw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">马尔可夫过程的状态转移矩阵<strong class="bd nx"> P </strong>(图片由作者提供)</p></figure><p id="651d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并且在时间步<em class="ne"> t </em>具有以下状态概率分布<strong class="kx jh"> <em class="ne"> π_ </em> </strong> <em class="ne"> t </em>:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi os"><img src="../Images/fcc0534043ed39f56bfb4f4b8b648374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFtu0N1xTH2Qpebe9dxhxA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">k状态马尔可夫过程的状态概率分布向量(图片由作者提供)</p></figure><p id="1e50" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并且已知/假设在<em class="ne"> t=0 </em>时<strong class="kx jh"> <em class="ne"> π_0 </em> </strong>的某个值，我们计算<strong class="kx jh"><em class="ne">π_</em></strong><em class="ne">t</em>如下:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/27f9adb07ad9ccb1d94074b24180caf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/0*cAR4MXwOT1AZKTut.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">给定t=0时的概率分布和转移矩阵<strong class="bd nx"> P </strong>(图片由作者提供)，马尔可夫过程在t时的状态概率分布公式</p></figure><h2 id="cb30" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">具有线性连接函数的MSDR模型</h2><p id="34bb" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">现在假设我们为预测平均值假设一个<strong class="kx jh">线性链接函数</strong>:</p><p id="5fc0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne"> η(。)=</em><strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em><strong class="kx jh"><em class="ne">β_ cap _ s</em></strong>从而产生<a class="ae jd" rel="noopener" target="_blank" href="/the-complete-guide-to-r-squared-adjusted-r-squared-and-pseudo-r-squared-4136650fc06c"> <strong class="kx jh">线性模型</strong> </a> <strong class="kx jh"> </strong>为可见过程:</p><p id="12d6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne">y _ t =</em><strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em><strong class="kx jh">T59】β_ cap _ s</strong><em class="ne">+ε_ t</em></p><p id="0ab2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">回想一下<strong class="kx jh"><em class="ne">X</em></strong><em class="ne">_ t</em>是一个大小为<em class="ne">【1x(m+1)】的矩阵，而</em> <strong class="kx jh"> <em class="ne"> β_cap_s </em> </strong>是一个大小为<em class="ne"> [(m+1) X k]，</em>的矩阵，因此，<strong class="kx jh"> <em class="ne"> x </em> </strong> <em class="ne"/></p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ou"><img src="../Images/f485f550c570b71431bb1f84c526ce03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VzeKH73etT-umXy4Gq1PAw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="624b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，对于每个时间步，上述计算返回平均值的<em class="ne"> k </em>个可能预测，对应于基础马尔可夫过程的<em class="ne"> k </em>个状态。我们需要一种方法将它们整合成一个单一的预测。我们通过计算<em class="ne"> μ_cap_t_j </em>的期望值来实现:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/63e47d8d035f72ab74267371acc26e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*YGR901MRW0SNDqVX8kfaMQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">预测平均值的期望值(图片由作者提供)</p></figure><p id="1b00" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">马尔可夫模型在时间<em class="ne"> t </em>处于状态<em class="ne"> j </em>的概率由马尔可夫变量<em class="ne"> s_t </em>的状态概率分布的<em class="ne">第j个</em>元素给出。我们之前看到，它是以下向量:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi os"><img src="../Images/fcc0534043ed39f56bfb4f4b8b648374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFtu0N1xTH2Qpebe9dxhxA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">k状态马尔可夫过程的状态概率分布向量(图片由作者提供)</p></figure><h1 id="fd4d" class="mh mi jg bd mj mk ml mm mn mo mp mq mr km ms kn mt kp mu kq mv ks mw kt mx my bi translated">训练和评估</h1><p id="7406" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">MSDR模型的训练包括估计系数矩阵<strong class="kx jh"><em class="ne">【β_ cap _ s】</em></strong>、转移矩阵<strong class="kx jh"> <em class="ne"> P </em> </strong>和因变量<strong class="kx jh"><em class="ne">【y】</em></strong>的方差<em class="ne"> σ </em>，估计过程通常是最大似然估计(MLE)或期望最大化。</p><p id="9e1e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将说明MLE，它找到了将使观察整个训练数据集<strong class="kx jh"><em class="ne"/></strong>y的联合概率密度最大化的<strong class="kx jh"><em class="ne">P</em></strong><em class="ne"/><strong class="kx jh"><em class="ne">β_ cap _ s</em></strong>和σ的值。换句话说，我们希望最大化以下产品:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/47c9c2c58c927ccfe46da76c5d2c7690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*az1op5sYcY32uC0W_CVIGQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">观察数据集的可能性(图片由作者提供)</p></figure><p id="afb9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的乘积中，概率密度<em class="ne">f(</em><strong class="kx jh"><em class="ne">y</em></strong><em class="ne">= y _ t)</em>的形式取决于我们对<strong class="kx jh"><em class="ne">【y</em></strong><em class="ne">假设了什么样的模型。</em></p><p id="bae0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们假设一个像前面看到的线性模型，概率密度<em class="ne">f(</em><strong class="kx jh"><em class="ne">y</em></strong><em class="ne">= y _ t)</em>由下面的等式给出:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/3f18af9fe690b6168afa4b68018811c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*xT-VyZMK_zH5wa0Vx624aA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">k状态隐马尔可夫模型影响下的正态分布<strong class="bd nx"> y </strong>(图片由作者提供)</p></figure><p id="16c1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其中，<em class="ne"> μ_cap_t </em>是使用等式(1)计算的所有可能状态的预测平均值的期望值。在给定回归变量值<strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em>和状态特定系数矩阵<strong class="kx jh"> <em class="ne"> β_cap_s. </em> </strong>的情况下，L.H.S .上的概率被读取为在时间<em class="ne"> t </em>观察<em class="ne"> y_t </em>的条件概率密度</p><p id="09b2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">还有一种计算概率密度的方法。让我们将<em class="ne"> f( ) </em>的公式改写如下:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c6d73a583785b96e6d9d8cd7efa4eed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*wv9Kj9k0o9F-eln6ikQoCg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd nx"> y </strong>的概率密度取决于<strong class="bd nx"> X </strong>以及在时间t处于状态j的隐马尔可夫过程(图片由作者提供)</p></figure><p id="f164" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其中，<em class="ne">μ_ cap _ TJ =</em><strong class="kx jh"><em class="ne">x</em></strong><em class="ne">_ t</em><strong class="kx jh"><em class="ne">β_ cap</em></strong><em class="ne">_ j .</em>即回归变量的线性组合<strong class="kx jh">和与状态<em class="ne"> j: </em></strong></p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oz"><img src="../Images/eaf6bdb9077ec6c44c2ee3f3e886cc63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwZXqfefkBX6je8D6UYprQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">正态分布y_t的条件均值，表示为回归变量<strong class="bd nx"> x </strong> _t、y_t的滞后版本和马尔可夫状态相关拟合系数<strong class="bd nx"> <em class="nr"> β_cap </em> </strong> <em class="nr"> _ </em> j的线性组合(图片由作者提供)</p></figure><p id="1e10" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于一个<em class="ne"> k- </em>状态马尔可夫过程，我们将得到<em class="ne"> k </em>这样的概率密度值，对于每个时间步<em class="ne"> t </em>，对于<em class="ne">【1，2，3，…，k】</em>中的每个状态<em class="ne"> j </em>都有一个。</p><p id="fe41" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">和以前一样，对于每个时间步，我们希望将这些<em class="ne"> k </em>概率密度合并成一个密度。这一次，我们求助于<a class="ae jd" href="https://en.wikipedia.org/wiki/Law_of_total_probability" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh">全概率定律</strong> </a>，该定律指出，如果事件A可以与事件A1，或事件A2，或事件A3等等共同发生，那么A的无条件概率可以表示如下:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pa"><img src="../Images/ef7ac19589fdc469593d2c7abb36e9ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-46ahmkJbvvTUDouppdMgg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">全概率定律(图片由作者提供)</p></figure><p id="54db" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">利用这个定律，我们得到在时间<em class="ne"> t </em>观察到<em class="ne"> y_t </em>的概率密度如下:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pb"><img src="../Images/2431d6afff7cc2908c59a43e06800363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2P3s5tVQi9lXbe3iNkdunA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">k状态马尔可夫模型影响下的<strong class="bd nx"> <em class="nr"> y </em> </strong>的概率密度(图片由作者提供)</p></figure><p id="8468" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意，在k项的每一项中，我们都使用相应的条件均值<em class="ne"> μ_cap_tj。</em>而且我们知道<em class="ne"> P(s_t=1)，P(s_t=2)，…等等。</em>是马尔可夫过程在时间<em class="ne"> t. </em>的状态概率</p><p id="c6f4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们已经有了f(<strong class="kx jh"><em class="ne">y</em></strong><em class="ne">= y _ t)</em>的公式，让我们回到似然方程:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/47c9c2c58c927ccfe46da76c5d2c7690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*az1op5sYcY32uC0W_CVIGQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">观察数据集的可能性(图片由作者提供)</p></figure><p id="b612" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最大化这个乘积的<strong class="kx jh">自然对数通常是迅速的，因为它的好处是将乘积转换成在微积分中更容易处理的求和(我们很快就会知道为什么)。因此，我们最大化下面的<strong class="kx jh"> <em class="ne">日志</em></strong>-可能性:</strong></p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pc"><img src="../Images/8820056559b52fee8d2c99d9d648c995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*86veEkEfQR8zIjS9V_WaMA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">观察数据集的对数似然性(图片由作者提供)</p></figure><p id="37a2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对数似然的最大化通过使用以下程序来完成:</p><ol class=""><li id="bfd0" class="ob oc jg kx b ky kz lb lc le od li oe lm of lq pd oh oi oj bi translated">取对数似然w . r . t .<strong class="kx jh"><em class="ne"/></strong>中的每个转移<em class="ne">概率p_ij </em>和系数矩阵<strong class="kx jh"> <em class="ne">中的每个状态特定系数<em class="ne">β_ cap _ q _ j</em>β_ cap _ s</em></strong><em class="ne"/>其中<em class="ne"> q in [0，1，…，m] </em>和马尔可夫状态</li><li id="d198" class="ob oc jg kx b ky ok lb ol le om li on lm oo lq pd oh oi oj bi translated">将每个偏导数设为零，</li><li id="6fc6" class="ob oc jg kx b ky ok lb ol le om li on lm oo lq pd oh oi oj bi translated">使用诸如<a class="ae jd" href="https://en.wikipedia.org/wiki/Newton%27s_method" rel="noopener ugc nofollow" target="_blank">牛顿-拉夫森</a>、<a class="ae jd" href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method" rel="noopener ugc nofollow" target="_blank">内尔德-米德</a>或<a class="ae jd" href="https://en.wikipedia.org/wiki/Powell%27s_method" rel="noopener ugc nofollow" target="_blank">鲍威尔的<em class="ne">中的<em class="ne">(k+(m+1)* k</em>系数以及方差σ的某种优化算法来求解与<em class="ne"> k </em>马尔可夫转移概率、<em class="ne"> (m+1)*k </em>相对应的<em class="ne"> (k +(m+1)*k +1) </em>方程(实际上比那个数少得多)</em></a></li></ol></div><div class="ab cl pe pf hu pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="ij ik il im in"><h1 id="39cd" class="mh mi jg bd mj mk pl mm mn mo pm mq mr km pn kn mt kp po kq mv ks pp kt mx my bi translated">使用Python和Statsmodels构建MSDR模型的教程</h1><p id="0176" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">在本教程中，我们将使用MSDR模型来调查美国个人消费支出和密歇根大学发布的消费者情绪指数之间的可能联系。正如我们将很快看到的，MSDR模型的隐马尔可夫部分将帮助我们解释个人消费支出数据中的一些可变性，否则用消费者情绪数据进行直接回归可能无法完成。</p><p id="1c59" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们从检查两个数据集开始:个人消费支出和消费者情绪指数。两个数据集都可以从这里下载<a class="ae jd" href="https://gist.github.com/sachinsdate/f74d433cb3226542a9b362b1beb6ae0e" rel="noopener ugc nofollow" target="_blank"/>。使用<a class="ae jd" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>，我们将两个数据集加载到一个数据帧中:</p><pre class="nt nu nv nw gt pq pr ps pt aw pu bi"><span id="86de" class="nf mi jg pr b gy pv pw l px py"><strong class="pr jh">import </strong>pandas <strong class="pr jh">as </strong>pd<br/><strong class="pr jh">import </strong>numpy <strong class="pr jh">as </strong>np<br/><strong class="pr jh">from </strong>matplotlib <strong class="pr jh">import </strong>pyplot <strong class="pr jh">as </strong>plt<br/><strong class="pr jh">import </strong>statsmodels.api <strong class="pr jh">as </strong>sm</span><span id="d09e" class="nf mi jg pr b gy pz pw l px py"><strong class="pr jh"><em class="ne"><br/>#Load the PCE and UMCSENT datasets<br/></em></strong>df = pd.<strong class="pr jh">read_csv</strong>(<strong class="pr jh">filepath_or_buffer</strong>=<strong class="pr jh">'</strong>UMCSENT_PCE.csv<strong class="pr jh">'</strong>, <strong class="pr jh">header</strong>=0, <strong class="pr jh">index_col</strong>=0, <strong class="pr jh">infer_datetime_format</strong>=True, <strong class="pr jh">parse_dates</strong>=[<strong class="pr jh">'</strong>DATE<strong class="pr jh">'</strong>])</span><span id="b9a8" class="nf mi jg pr b gy pz pw l px py"><strong class="pr jh"><em class="ne">#Set the index frequency to 'Month-Start'<br/></em></strong>df = df.<strong class="pr jh">asfreq</strong>(<strong class="pr jh">'</strong>MS<strong class="pr jh">'</strong>)</span></pre><p id="05a6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们绘制两个时间序列:</p><pre class="nt nu nv nw gt pq pr ps pt aw pu bi"><span id="9c31" class="nf mi jg pr b gy pv pw l px py">fig = plt.<strong class="pr jh">figure</strong>()<br/>fig.<strong class="pr jh">suptitle</strong>('% Chg in Personal Consumption Expenditure')<br/>df['PCE_CHG'].<strong class="pr jh">plot</strong>()<br/>plt.<strong class="pr jh">show</strong>()</span><span id="f6bf" class="nf mi jg pr b gy pz pw l px py">fig = plt.<strong class="pr jh">figure</strong>()<br/>fig.<strong class="pr jh">suptitle</strong>('% Chg in U. Michigan Consumer Sentiment Index')<br/>df['UMCSENT_CHG'].<strong class="pr jh">plot</strong>()<br/>plt.<strong class="pr jh">show</strong>()</span></pre><p id="9051" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到下面的图:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/21b0b135e340096518bd4529869a420d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0NGwBOd9bZeGVu3rb6cwQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">个人消费支出的百分比变化(数据来源<a class="ae jd" href="https://fred.stlouisfed.org/series/PCE" rel="noopener ugc nofollow" target="_blank">美国弗雷德</a>在<a class="ae jd" href="https://fred.stlouisfed.org/searchresults/?st=personal%20consumption%20expenditures&amp;t=public%20domain%3A%20citation%20requested&amp;ob=sr&amp;od=desc&amp;types=gen;cc" rel="noopener ugc nofollow" target="_blank">公共领域</a>许可下)(图片由作者提供)</p></figure><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qa"><img src="../Images/a8957ea408ff9de942c2271722c12c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AytQUlVyIrDmPCdkg7KEfg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">消费者情绪指数的百分比变化(数据来源:<a class="ae jd" href="https://data.sca.isr.umich.edu/data-archive/mine.php" rel="noopener ugc nofollow" target="_blank">密歇根大学</a>在公共领域许可下)(图片由作者提供)</p></figure><h2 id="2f74" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">回归目标和回归策略</h2><p id="ff79" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">我们的回归目标是使用美国密歇根消费者情绪指数的方差来解释个人消费支出的方差。</p><p id="52f7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，我们的回归模型的变量如下:</p><p id="8742" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">因变量</strong><strong class="kx jh"><em class="ne">y</em></strong>= PCE _ CHG(个人消费支出的M-o-M %变化)</p><p id="9f90" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">回归变量</strong><strong class="kx jh"><em class="ne">X</em></strong>= UMCSENT _ CHG(消费者情绪指数的M-o-M %变化)，加上回归的截距。</p><p id="296a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是我们的<strong class="kx jh"> <em class="ne"> y </em> </strong>和<strong class="kx jh"> <em class="ne"> X </em> </strong>矩阵:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/c5e32a7863e765a17a4f5bf0299d84bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*t052FYh3T1b0ttLlQur7rw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd nx"> y </strong>和<strong class="bd nx"> X </strong>矩阵(图片由作者提供)</p></figure><p id="cd9d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">回归的截距由statsmodels添加。</p><p id="5fe9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这两个图表中，我们都可以看到高波动性区域(即方差)，如PCE图表下方的红圈所示:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/33583f9482ecb59c67bf2419866b1727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-6UVw49oMRFpskiVsuMGg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">个人消费支出高波动区域(图片由作者提供)</p></figure><p id="c749" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将使用一个2态马尔可夫转换动态回归模型来尝试对高低方差区域之间的这些方差“转换”进行建模:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qc"><img src="../Images/77fbeca4b9ccbc56321f7283a978b999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5U4X3JPzELT34XJ5BIySQQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">在高低方差状态之间切换的双态MSDR模型(图片由作者提供)</p></figure><p id="b95b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意，这次我们对马尔可夫状态使用基于0的索引，因为这是statsmodels使用的。</p><p id="eb90" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">状态转移矩阵是:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/b559c8770ab3e9cb92f4592b0263d407.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*gBzLt948gpyOhkGb8Fy5BQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">状态转移矩阵(图片由作者提供)</p></figure><p id="aa00" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的MSDR模型的等式如下:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/63e5c99183ee871c9e54274cb835fecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*zhoNIDDKJl37h1eIfzwmrg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">具有状态依赖均值和方差的2状态MSDR模型的方程(图片由作者提供)</p></figure><p id="bbed" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请注意，我们还引入了一个<strong class="kx jh">特定于州的方差</strong>。我们说，模型的残差正态分布在一个零均值和一个方差周围，该方差根据基础马尔可夫过程所处的状态在两个值之间切换。</p><p id="8bd0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">statsmodels支持方差切换MSDR模型。</p><p id="a1f9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们构建并训练两状态MSDR模型:</p><pre class="nt nu nv nw gt pq pr ps pt aw pu bi"><span id="4787" class="nf mi jg pr b gy pv pw l px py">msdr_model = sm.<strong class="pr jh">tsa</strong>.<strong class="pr jh">MarkovRegression</strong>(<strong class="pr jh">endog</strong>=df[<strong class="pr jh">'</strong>PCE_CHG<strong class="pr jh">'</strong>], <strong class="pr jh">k_regimes</strong>=2, <strong class="pr jh">trend</strong>=<strong class="pr jh">'</strong>c<strong class="pr jh">'</strong>, <strong class="pr jh">exog</strong>=df[<strong class="pr jh">'</strong>UMCSENT_CHG<strong class="pr jh">'</strong>], <strong class="pr jh">switching_variance</strong>=True)</span><span id="5c50" class="nf mi jg pr b gy pz pw l px py">msdr_model_results = msdr_model.<strong class="pr jh">fit</strong>(<strong class="pr jh">iter</strong>=1000)</span></pre><p id="be82" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne"> trend='c' </em>告诉statsmodels给<strong class="kx jh"> <em class="ne"> X </em> </strong>矩阵添加一个截距。</p><p id="4175" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们打印模型培训总结:</p><pre class="nt nu nv nw gt pq pr ps pt aw pu bi"><span id="50e8" class="nf mi jg pr b gy pv pw l px py"><strong class="pr jh">print</strong>(msdr_model_results.<strong class="pr jh">summary</strong>())</span></pre><p id="7a1c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到以下输出:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qf"><img src="../Images/077ca68b9a6a70b2864853ad3433d4f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5AzE9t24iF250_NBCXtYDw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">MSDR模特培训总结(图片由作者提供)</p></figure><p id="f39f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上述结果中的变量名可以解释为:<br/><em class="ne">β_ 0 = const<br/>β_ 1 = x1<br/>σ= sigma 2<br/>p[0-&gt;0]= p _ 00，因此，p _ 01 = 1—p _ 00<br/>p[1-&gt;0]= p _ 10，因此，p _ 11–1-p _ 10</em></p><p id="7203" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过查看结果中的拟合系数值，我们可以写出特定于制度的模型方程如下:</p><p id="c1ec" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">对于体制=0(低方差体制):<br/></strong><em class="ne">PCE _ CHG = 0.0048+0.0026 * UMC sent+ε_ t，<br/>其中ε_t ~ N(0，1.701e-05) </em></p><p id="90b0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">对于政权=1(高方差政权):<br/></strong><em class="ne">PCE _ CHG = 0.0041+0.1203 * UMCSENT+ε_ t，<br/>其中ε_t ~ N(0，0.0012) </em></p><p id="a207" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">马尔可夫状态转移图和矩阵<strong class="kx jh"> <em class="ne"> P </em> </strong>如下:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qg"><img src="../Images/899f00b94f6c0172e83fc9d87e457388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpd0sBG9OSOVLaicaLF7Tg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">拟合2态马尔可夫模型的状态转移图和转移矩阵P(图片由作者提供)</p></figure><p id="0d2f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到，当个人消费支出处于低方差状态时，不到2%的时间倾向于切换到高方差状态，而如果消费支出处于高方差状态，则倾向于以大约20%的概率切换回低方差状态。</p><p id="8477" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">训练结果中暴露出的一个有些令人不安的事实是，在状态0中，UMCSENT ( <em class="ne"> β_10) </em>的系数在<em class="ne"> 95% </em>置信水平<em class="ne"> (p值=0.513 &gt; 0.05) </em>下不具有统计显著性，在状态<em class="ne"> 1 </em>中，<em class="ne"> β_01 </em>和<em class="ne"> β_11 </em>在95%置信水平下不具有统计显著性</p><p id="b209" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们画出每个时间步<em class="ne">t</em>的马尔可夫状态概率<strong class="kx jh"><em class="ne">π_</em></strong><em class="ne">t</em>在我们的例子中，时间步是一个月。除了图表<strong class="kx jh"><em class="ne">π_</em></strong><em class="ne">t</em>之外，我们还将绘制PCE %变化图，我们还将绘制根据基于GDP的衰退指标数据集(来源于<a class="ae jd" href="https://fred.stlouisfed.org/series/JHDUSRGDPBR" rel="noopener ugc nofollow" target="_blank">美国FRED </a>在<a class="ae jd" href="https://fred.stlouisfed.org/searchresults?st=recession&amp;t=public%20domain%3A%20citation%20requested&amp;ob=sr&amp;od=desc&amp;types=gen;cc" rel="noopener ugc nofollow" target="_blank">公共领域</a>许可下)推断的美国衰退<strong class="kx jh">日期。</strong></p><pre class="nt nu nv nw gt pq pr ps pt aw pu bi"><span id="bbc6" class="nf mi jg pr b gy pv pw l px py">df_r = pd.read_csv(<strong class="pr jh">'JHDUSRGDPBR.csv'</strong>, header=0, index_col=0, infer_datetime_format=<strong class="pr jh">True</strong>, parse_dates=[<strong class="pr jh">'DATE'</strong>])<br/><br/>figure, axes = plt.<strong class="pr jh">subplots</strong>(3)<br/>ax = axes[0]<br/>ax.<strong class="pr jh">plot</strong>(df.<strong class="pr jh">index</strong>, df[<strong class="pr jh">'</strong>PCE_CHG<strong class="pr jh">'</strong>])<br/>ax.<strong class="pr jh">set</strong>(<strong class="pr jh">title</strong>='% Chg in Personal Consumption Expenditure')<br/><br/>ax = axes[1]<br/>ax.<strong class="pr jh">plot</strong>(df.<strong class="pr jh">index</strong>, msdr_model_results.<strong class="pr jh">smoothed_marginal_probabilities</strong>[0])<br/>ax.<strong class="pr jh">set</strong>(<strong class="pr jh">title</strong>=<strong class="pr jh">'</strong>Smoothed probability of regime 0')<br/><br/>ax = axes[2]<br/>ax.<strong class="pr jh">plot</strong>(df.<strong class="pr jh">index</strong>, msdr_model_results.<strong class="pr jh">smoothed_marginal_probabilities</strong>[1])<br/>ax.<strong class="pr jh">plot</strong>(df_r.<strong class="pr jh">index</strong>, df_r[<strong class="pr jh">'</strong>JHDUSRGDPBR<strong class="pr jh">'</strong>])<br/>ax.<strong class="pr jh">set</strong>(<strong class="pr jh">title</strong>='Smoothed probability of regime 1 super-imposed on GDP based recession indicator (Orange)')<br/><br/>plt.<strong class="pr jh">show</strong>()</span></pre><p id="1410" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到如下的情节:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qa"><img src="../Images/46575c202a15090411b8db95603efcc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RcjMCUoyejnu4fyoYOqRiw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">马尔可夫状态概率叠加了基于GDP的衰退指标(图片由作者提供)</p></figure><p id="d15b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到往往当马尔可夫状态模型处于高方差状态时，美国经济处于衰退状态。</p><p id="0719" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是完整的源代码:</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="qh qi l"/></div></figure></div><div class="ab cl pe pf hu pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="ij ik il im in"><h1 id="4b30" class="mh mi jg bd mj mk pl mm mn mo pm mq mr km pn kn mt kp po kq mv ks pp kt mx my bi translated">参考文献和版权</h1><h2 id="686a" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">数据集</h2><p id="6f16" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">美国经济分析局，个人消费支出[PCE]，从圣路易斯美联储银行检索；<a class="ae jd" href="https://fred.stlouisfed.org/series/PCE" rel="noopener ugc nofollow" target="_blank">https://fred.stlouisfed.org/series/PCE</a>，2021年11月11日。在<a class="ae jd" href="https://fred.stlouisfed.org/tags/series?t=public%20domain%3A%20citation%20requested" rel="noopener ugc nofollow" target="_blank">公共许可证</a>下可用。</p><p id="dce4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">密歇根大学，调查研究中心，消费者调查。<a class="ae jd" href="https://data.sca.isr.umich.edu/data-archive/mine.php" rel="noopener ugc nofollow" target="_blank">消费者情绪指数</a>。在公共许可下可用。</p><p id="d3f7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Hamilton，James，根据基于GDP的衰退指标[JHDUSRGDPBR]推断的美国衰退日期，从圣路易斯美联储银行的FRED处检索；<a class="ae jd" href="https://fred.stlouisfed.org/series/JHDUSRGDPBR" rel="noopener ugc nofollow" target="_blank">https://fred.stlouisfed.org/series/JHDUSRGDPBR</a>，2021年11月12日。</p><h2 id="6fe7" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">书</h2><p id="bc52" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">詹姆斯·d·汉密尔顿，<a class="ae jd" href="https://press.princeton.edu/books/hardcover/9780691042893/time-series-analysis" rel="noopener ugc nofollow" target="_blank"> <em class="ne">时间序列分析</em> </a>，普林斯顿大学出版社，2020年。ISBN: 0691218633</p><h2 id="be53" class="nf mi jg bd mj ng nh dn mn ni nj dp mr le nk nl mt li nm nn mv lm no np mx nq bi translated">形象</h2><p id="1ebd" class="pw-post-body-paragraph kv kw jg kx b ky mz kh la lb na kk ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">所有图片的版权<a class="ae jd" href="https://www.linkedin.com/in/sachindate/" rel="noopener ugc nofollow" target="_blank"> Sachin Date </a>归<a class="ae jd" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener ugc nofollow" target="_blank"> CC-BY-NC-SA </a>所有，除非图片下面提到了不同的来源和版权。</p></div><div class="ab cl pe pf hu pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="ij ik il im in"><h1 id="77db" class="mh mi jg bd mj mk pl mm mn mo pm mq mr km pn kn mt kp po kq mv ks pp kt mx my bi translated">相关阅读</h1><div class="ip iq gp gr ir lr"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-discrete-time-markov-chains-d5be17cf0e12"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jh gy z fp lw fr fs lx fu fw jf bi translated">离散时间马尔可夫链初学者指南</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">以及如何使用Python模拟离散马尔可夫过程的教程</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">towardsdatascience.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf ix lr"/></div></div></a></div><div class="ip iq gp gr ir lr"><a rel="noopener follow" target="_blank" href="/a-math-lovers-guide-to-hidden-markov-models-ad718df9fde8"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jh gy z fp lw fr fs lx fu fw jf bi translated">数学爱好者的隐马尔可夫模型指南</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">它们是如何工作的，以及它们为什么被“隐藏”起来。</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">towardsdatascience.com</p></div></div><div class="ma l"><div class="mg l mc md me ma mf ix lr"/></div></div></a></div></div><div class="ab cl pe pf hu pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="ij ik il im in"><p id="b20a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ne">感谢阅读！如果您喜欢这篇文章，请</em> <a class="ae jd" href="https://timeseriesreasoning.medium.com" rel="noopener"> <strong class="kx jh"> <em class="ne">关注我</em> </strong> </a> <em class="ne">获取关于回归和时间序列分析的提示、操作方法和编程建议。</em></p></div></div>    
</body>
</html>