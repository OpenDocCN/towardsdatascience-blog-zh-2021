<html>
<head>
<title>Building a Data Warehouse in Python Using PostgreSQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PostgreSQL在Python中构建数据仓库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-data-warehouse-in-python-using-postgresql-f10dce22e3aa?source=collection_archive---------2-----------------------#2021-07-20">https://towardsdatascience.com/building-a-data-warehouse-in-python-using-postgresql-f10dce22e3aa?source=collection_archive---------2-----------------------#2021-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5ca7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一种简化的方法来提供健壮且可扩展的数据仓库</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6c47ae31fc5bafc05b947f1d75813d8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kDoqYAhV2mfIsNW2"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">娜娜·斯米尔诺娃在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="0f59" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="c237" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">随着当今时代数据的丰富和激增，有一种以有意义的方式存储和重用这些信息财富的内在需求。这就好比厨房里堆满了各种各样的用具和工具，却没有一种有组织的方式来管理它们。嗯，除非你囤积得很快，否则你很可能会用勺子的后端来打开你的午餐罐头。</p><p id="c4eb" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">数据仓库能够以前所未有的方式按需缓存、标记、分析和重用您管理的数据。就像你母亲在她整洁有序的厨房里导航一样。请注意，没有放之四海而皆准的解决方案，有多少个仓库就有多少种建仓方式。</p><p id="9827" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">可以说，实现成功的数据仓库有三个关键因素:</p><ol class=""><li id="999b" class="mt mu it lx b ly mo mb mp li mv lm mw lq mx mn my mz na nb bi translated"><strong class="lx iu">服务器:</strong>首先，您必须提供一个既健壮又有弹性的分布式数据库系统。</li><li id="73d2" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">索引:理想情况下，你的数据库系统应该有某种形式的索引，允许你以极快的速度访问记录。拥有一个全文索引将是一个额外的收获。</li><li id="a8ca" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated"><strong class="lx iu"> Dashboard: </strong>你应该有一个暂存区，在这里你可以以一种不变的方式导入、导出、可视化和改变你的数据。</li></ol><p id="db72" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在本教程中，我们将通过创建一个数据仓库来解决上面提到的第一点和最后一点，我们可以在其中存储数据集、数组和记录。此外，我们将创建一个仪表板，在那里我们可以用图形界面与我们的仓库加载，检索，变异和可视化我们的数据。或许在另一篇文章中，我们将实现第二点，即全文索引数据库。</p><h2 id="c364" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">服务器:PostgreSQL</h2><p id="e016" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">PostgreSQL，简称Postgres，是一个开放源代码的关系数据库系统，由于其扩展的功能和相对易用性，它通常是开发人员的首选数据库。尽管它被标榜为结构化数据库管理系统，但它也可以存储非结构化数据，包括但不限于数组和二进制对象。然而，最重要的是，Postgres的图形用户界面使得动态提供和管理数据库变得太容易了，这是其他数据库系统应该注意的。</p><p id="9340" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在我们的数据仓库实现中，我们将使用本地Postgres服务器来存储我们所有的数据。在我们继续之前，请使用<a class="ae ky" href="https://www.postgresql.org/download/" rel="noopener ugc nofollow" target="_blank">此链接</a>下载并安装Postgres。在安装过程中，系统会提示您设置用户名、密码和本地TCP端口以连接到您的服务器。默认端口是5432，您可以保持不变，也可以根据需要进行修改。安装完成后，您可以通过运行<strong class="lx iu"> pgAdmin 4 </strong>应用程序登录服务器，该应用程序将在您的浏览器上打开一个门户，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/56ee062eff489db44b6388b26a1506ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4KwvYVTwPJxROeC9yV8NQg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PostgreSQL服务器门户。图片作者。</p></figure><p id="12c7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">将会有一个默认的数据库，标签为<strong class="lx iu"> postgres </strong>，但是您可以通过右击<strong class="lx iu"> Databases </strong>菜单，然后选择<strong class="lx iu"> Create </strong>来创建您自己的数据库，以提供一个新的数据库。</p><h2 id="0d17" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Python实现</h2><p id="6f8b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">现在您已经提供了您的服务器和数据库，您应该安装软件包<strong class="lx iu"> sqlalchemy </strong>，它将用于通过Python连接到我们的数据库。您可以通过在Anaconda提示符下键入以下命令来下载并安装这个软件包:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="83fa" class="kz la it nj b gy nn no l np nq">pip install sqlalchemy</span></pre><p id="2044" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">此外，下载、安装并导入所有其他必要的库到Python脚本中，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2e5d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">首先，我们需要在我们的<strong class="lx iu"> records_db </strong>数据库之间建立一个连接，并创建一个可以存储记录和数组的表。此外，我们需要创建另一个到<strong class="lx iu"> datasets_db </strong>数据库的连接，我们将在其中存储数据集:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="1fdf" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">按照Postgres的命名约定，表名必须以下划线或字母(不是数字)开头，不能包含破折号，并且长度必须少于64个字符。对于我们的<strong class="lx iu">记录</strong>表，我们将创建一个数据类型为<strong class="lx iu">文本</strong>的<strong class="lx iu">名称</strong>字段，声明为<strong class="lx iu">主键</strong>，以及一个数据类型为<strong class="lx iu">细节</strong>的<strong class="lx iu">文本[] </strong>字段，这是一个一维数组的Postgres表示法。要获得Postgres支持的所有数据类型的详尽列表，请参考此<a class="ae ky" href="https://www.postgresql.org/docs/9.5/datatype.html" rel="noopener ugc nofollow" target="_blank">链接</a>。我们将使用<strong class="lx iu">名称</strong>字段作为主键，稍后将用于搜索记录。此外，请注意，存储您的数据库凭证的一种更安全的方式是将它们保存在一个<a class="ae ky" href="https://medium.com/@t.rosen2101/how-to-create-a-gitignore-file-to-hide-your-api-keys-95b3e6692e41" rel="noopener">配置文件</a>中，然后在您的代码中将它们作为参数调用。</p><p id="1026" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">随后，我们将创建以下五个函数来写入、更新、读取和列出数据库中的数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4056" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">将字符串连接到查询时，请注意SQL注入漏洞。您可以使用参数化来防止SQL注入，如本文<a class="ae ky" href="https://www.w3schools.com/sql/sql_injection.asp" rel="noopener ugc nofollow" target="_blank">中的</a>所述。</p><h2 id="822f" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">仪表板:简化</h2><p id="487b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">Streamlit是一个纯Python web框架，允许您在指尖实时开发和部署用户界面和应用程序。在本教程中，我们将使用Streamlit来呈现一个仪表板，我们可以用它来与Postgres数据库进行交互。</p><p id="b066" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在下面的代码片段中，我们使用了几个文本输入小部件来插入数据集的记录、数组和名称的值。此外，我们正在使用Streamlit的功能，以图表和数据框的形式交互式地可视化我们的数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4de2" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">您可以在本地浏览器上运行仪表板，方法是在Anaconda提示符下键入以下命令。首先，将根目录更改为保存源代码的位置:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="95b8" class="kz la it nj b gy nn no l np nq">cd C:/Users/...</span></pre><p id="1cb3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">然后键入以下内容运行您的应用程序:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="26b6" class="kz la it nj b gy nn no l np nq">streamlit run file_name.py</span></pre><h2 id="8a1f" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结果</h2><p id="6c74" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">这就是你要的，一个可以用来实时标记、写入、读取、更新、上传和可视化我们的数据的控制面板。我们的数据仓库的美妙之处在于，它可以扩展到托管您可能需要的尽可能多的数据，所有这些都在我们刚刚创建的同一结构中！如果你想了解更多关于数据仓库的基础知识，我建议你报名参加科罗拉多大学关于<a class="ae ky" href="https://click.linksynergy.com/deeplink?id=hOGDdF2uhHQ&amp;mid=40328&amp;murl=https%3A%2F%2Fwww.coursera.org%2Fspecializations%2Fdata-warehousing" rel="noopener ugc nofollow" target="_blank">数据仓库</a>的课程。这是提高速度的好方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/5c728c1ea2296645b7011049ab5d2d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CiNU9jN5TZB5kKTJctN1g.png"/></div></div></figure><p id="8e12" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果您想了解更多关于数据可视化和Python的知识，请随时查看以下(附属链接)课程:</p><h2 id="77a0" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用Streamlit开发Web应用程序:</h2><div class="nt nu gp gr nv nw"><a href="https://www.amazon.com/Web-Application-Development-Streamlit-Applications/dp/1484281101?&amp;linkCode=ll1&amp;tag=mkhorasani09-20&amp;linkId=a0cb2bc17df598006fd9029c58792a6b&amp;language=en_US&amp;ref_=as_li_ss_tl" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">使用Streamlit开发Web应用程序:开发和部署安全且可伸缩的Web应用程序…</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">使用Streamlit开发Web应用程序:使用……开发安全且可扩展的Web应用程序并将其部署到云中</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">www.amazon.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><h2 id="7177" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用Python实现数据可视化:</h2><div class="nt nu gp gr nv nw"><a href="https://www.coursera.org/learn/python-for-data-visualization?irclickid=xgMQ4KWb%3AxyIWO7Uo7Vva0OcUkGQgW2aEwvr1c0&amp;irgwc=1&amp;utm_medium=partners&amp;utm_source=impact&amp;utm_campaign=3308031&amp;utm_content=b2c" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">用Python实现数据可视化</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">“一图胜千言”。我们都熟悉这个表达。它尤其适用于试图…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">www.coursera.org</p></div></div><div class="of l"><div class="ol l oh oi oj of ok ks nw"/></div></div></a></div><h2 id="ac9e" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">面向所有人的Python专业化:</h2><div class="nt nu gp gr nv nw"><a href="https://www.coursera.org/specializations/python?irclickid=xgMQ4KWb%3AxyIWO7Uo7Vva0OcUkGQgW16Ewvr1c0&amp;irgwc=1&amp;utm_medium=partners&amp;utm_source=impact&amp;utm_campaign=3308031&amp;utm_content=b2c" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">面向所有人的Python</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">学习用Python编程和分析数据。开发收集、清理、分析和可视化数据的程序…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">www.coursera.org</p></div></div><div class="of l"><div class="om l oh oi oj of ok ks nw"/></div></div></a></div><h2 id="a899" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">GitHub资源库:</h2><div class="nt nu gp gr nv nw"><a href="https://github.com/mkhorasani/data_warehouse" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">mkhorasani/数据仓库</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">使用PostgreSQL在Python中构建数据仓库</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="on l oh oi oj of ok ks nw"/></div></div></a></div></div><div class="ab cl oo op hx oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="im in io ip iq"><h1 id="2af4" class="ov la it bd lb ow ox oy le oz pa pb lh jz pc ka ll kc pd kd lp kf pe kg lt pf bi translated">新到中？您可以在此订阅并解锁无限文章<a class="ae ky" href="https://khorasani.medium.com/membership" rel="noopener">。</a></h1></div></div>    
</body>
</html>