<html>
<head>
<title>Noise cancellation with Python and Fourier Transform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Python和傅立叶变换消除噪声</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/noise-cancellation-with-python-and-fourier-transform-97303314aa71?source=collection_archive---------3-----------------------#2021-09-05">https://towardsdatascience.com/noise-cancellation-with-python-and-fourier-transform-97303314aa71?source=collection_archive---------3-----------------------#2021-09-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/fc0702797726c48cce8e5cef155b9eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C3BWT7miPgEKSOnw8YTgGg.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">欧内斯特·卡尔希米特在<a class="ae jd" href="https://unsplash.com/s/photos/noise?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="4891" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">下面介绍如何使用傅立叶变换这样非常简单的工具，用很少的几行代码就可以获得高效的噪声消除。</h2></div><p id="7f48" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">模拟噪音是一项非常困难的任务。我甚至不想反驳这一点。</strong>作为一名物理学家，我无时无刻不在与噪音打交道，捕捉噪音、对噪音建模或笼统地处理噪音都不容易。</p><p id="6fe0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于这个原因，多年来已经开发了许多复杂、智能和有效的方法。随着计算机这些年的技术进步，<strong class="kx jh">机器(深度)学习</strong>去噪算法已经取得了很好的性能。虽然这些方法允许获得令人难以置信的结果，但有时基于极其合理和一般考虑的非常简单的方法可以用来解决<strong class="kx jh">噪声消除问题</strong>，并获得极好的结果。</p><p id="f209" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个概念的一个重要例子是<strong class="kx jh">傅立叶去噪方法。</strong></p><h2 id="380d" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">1.该理论</h2><p id="2aeb" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">假设你有一个信号，从数学上讲，可以认为是一个从实空间到实数的函数:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/991fc04ee75e66bcf9939bd507d34af0.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/1*ulgBLEAvEvL9doUccVjOmg.gif"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我用<a class="ae jd" href="https://latex.codecogs.com/eqneditor/editor.php" rel="noopener ugc nofollow" target="_blank">这个工具</a>生成了这张图片</p></figure><p id="6b92" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Fourier_transform" rel="noopener ugc nofollow" target="_blank">傅立叶变换</a>的想法是在<strong class="kx jh">另一个域</strong>中研究这个信号。<strong class="kx jh"> <br/> </strong>更具体地说，你使用的域是频域，因此得到:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/0a22701dd90cb823f988cb755626c8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/1*o-hKCNPQKYOHoad4fkwiiA.gif"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我用<a class="ae jd" href="https://latex.codecogs.com/eqneditor/editor.php" rel="noopener ugc nofollow" target="_blank">这个工具</a>生成了这张图片</p></figure><p id="7184" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么这意味着什么呢？为什么它如此重要？这个想法是，你可以将信号分解为正弦和余弦的离散和(或连续和，即积分),考虑它们的特定幅度。让我们把它变得简单些。我们假设你有<strong class="kx jh">这个信号:</strong></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/ecfa3c8c0db0af8eed23ab107caddb4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fayx4rs5tE0DrkZhDJ2lGA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我使用<strong class="bd mv"> Python </strong>生成的图像</p></figure><p id="1138" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那意味着你的信号是<strong class="kx jh"> y </strong>:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a915b626f971a9d041d4762d1f22e07d.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/1*q_BSVIDfZKtHsjfEHl0LZA.gif"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我用这个<a class="ae jd" href="https://latex.codecogs.com/eqneditor/editor.php" rel="noopener ugc nofollow" target="_blank">工具</a>生成了这张图片</p></figure><p id="d1ff" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，由于这个信号只是一个正弦信号，在傅立叶空间中，它看起来像这样:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/45082ae2f8598aad2ce1ba6c3bfda409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UfGqPpfm-3WHH1refyHnKQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我用<strong class="bd mv"> Python </strong>生成的图片</p></figure><p id="f091" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们有1作为正弦的频率是<strong class="kx jh"> 1 ( </strong>把信号想成y = sin(ωx)。<br/>这是用一个可逆函数得到的，这个可逆函数就是<a class="ae jd" href="https://en.wikipedia.org/wiki/Fast_Fourier_transform" rel="noopener ugc nofollow" target="_blank"><strong class="kx jh"/></a><strong class="kx jh">。</strong>使用<strong class="kx jh">快速傅立叶逆变换</strong>，您可以轻松返回到原始功能。</p><p id="e7fa" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么，我们为什么要讨论<strong class="kx jh">噪声消除呢？<br/> </strong>一个安全(且通用)的假设是，噪声可以在所有频率下存在，而你的信号在频谱中受到<strong class="kx jh">限制</strong>(即频带受限)，并且只有<strong class="kx jh">某些特定的非零频率</strong>来表征它。</p><p id="22f9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设您有一个像这样的噪声正弦函数:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/6f01ff9606f51e09ca95151393839122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lc4Qe8e7ToHxv6tyQHbmeg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我使用<strong class="bd mv"> Python </strong>生成的图像</p></figure><p id="2015" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">频谱是这样的:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi my"><img src="../Images/edde4e097b4485fa5ed0d0de9fd45cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GSZaFHQuVxrg0n1Zb2RMUg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我使用<strong class="bd mv"> Python </strong>生成的图像</p></figure><p id="5f4a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然你可以看到ω= 1时的峰值，但其他一切都只是噪声。</p><p id="8027" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">必须做的一个一般假设是，信号和噪声是<strong class="kx jh">不相关的，</strong>，即使你的信号是有噪声的，<strong class="kx jh">信号的“非噪声”部分占主导地位。</strong></p><p id="0d9d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，主要思想是找到<strong class="kx jh">真实信号频率</strong>，并通过仅使用信号的重要频率来获得<strong class="kx jh">重构信号</strong>。将使用<strong class="kx jh">相关值</strong>找到的“不相关频率”将被设置为0。</p><p id="a7bb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我知道这一切听起来令人困惑，但我真的认为在一个实际的例子之后会清楚得多。所以跟我来！</p><h2 id="5bdc" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">2.数据集</h2><p id="dd16" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">为了进行我们将要进行的所有分析，我们需要这些库:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8d18" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我从<a class="ae jd" href="https://www.kaggle.com/vijayvvenkitesh/microsoft-stock-time-series-analysis" rel="noopener ugc nofollow" target="_blank">这里</a>下载了数据。这是一个时间序列，是我们所需要的完美例子:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1ca1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以决定我们想要的任何功能。我分析了<strong class="kx jh">【Close】</strong>一个没有具体原因，所以放心在另一个特性上重复同样的过程吧！</p><h2 id="23b7" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">3.数据预处理</h2><p id="9388" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们看到的第一个主要问题是我们没有一个均匀采样的时间空间。例如，我们有第一个日期，即四月<strong class="kx jh">第一个</strong>日(2015-04-01)，第二个日期是四月<strong class="kx jh">第二个</strong>日(2015-04-02)，第三个日期是<strong class="kx jh">第六个</strong>日(2015-04-06)。</p><p id="5507" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">我们可以通过考虑一个连续的时间空间并添加与最近的可用日期相关的值来解决这个问题。</strong></p><p id="8729" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在实践中，您可以通过这些代码行来实现这一点，正如您所看到的，这两个时间序列(真实的和人为的)本质上是相同的:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1243" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">第二个问题是傅立叶分析仅适用于平稳数据</strong>，我们可以清楚地看到，这一时间序列在逐年增加。</p><p id="2487" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们正在使用一点机器学习来解决这个问题。特别是，我们将使用<strong class="kx jh">多项式回归</strong>来寻找最适合数据的多项式函数。然后我们将去掉这条线，得到平稳的时间序列:</p><p id="eee8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将这样做:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><h2 id="a2f6" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">4.去噪算法</h2><p id="b879" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们得到傅立叶变换，并绘制振幅:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="49d8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好的，我们的想法是<strong class="kx jh">过滤它。我们正在切断低于某一水平的所有频率。</strong>该水平通过使用最大振幅作为参考值来设置。例如，您可以降低所有低于最大振幅0.7倍的频率。</p><p id="8dfe" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是它如何工作的一个例子。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="67d4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们对每个滤波傅立叶变换进行逆变换，我们会得到以下结果:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="b895" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是您可以使用的基于特定阈值过滤数据的所有函数:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1bc7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，为了获得<strong class="kx jh">最佳阈值</strong>，我们现在可以查看原始信号之间的相关性以及原始信号与重构信号之间的差异。如果相关性很高，这意味着我们仍然会从原始信号中遗漏一些东西。否则，由于信号不应与噪声相关，我们可以假设我们只是在删除噪声，这就是我们想要做的。</p><p id="705c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是我们可以得到的信息:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="abeb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里是不同阈值下的相关性(<strong class="kx jh">相关值</strong>和<strong class="kx jh"> p值)</strong>:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="356e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，我们发现最佳阈值是最大值的0.004倍！</p><p id="5e77" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是结果！</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="a89e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">他们看起来很相似，事实上，我们真的很保守！这意味着我们真的不想取消信号的重要信息，即使这意味着我们可能不会删除所有的噪声。</p><p id="3f96" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们能做的另一件事就是放宽这个门槛。这肯定会减少更多的噪声，但也可能会从信号中去掉一些重要的东西。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mz na l"/></div></figure><h2 id="4c03" class="lr ls jg bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">4.结论</h2><p id="2e98" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这篇博客文章想要表明，有时好的老式方法仍然可以帮助你解决问题，而不需要使用疯狂快速的GPU和先进的深度学习算法。</p><p id="7153" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当然，你可能会遇到更具体的噪音问题，这可能比这篇文章中解释的要困难得多。无论如何，在一般情况下，当你并不真正知道问题，你只是在探索它，傅立叶去噪方法可能是一个非常好的研究起点！</p><p id="44bb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="ce33" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.在<a class="ae jd" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Linkedin </strong> </a>上关注我，在那里我发布我所有的故事<br/> B .订阅我的<a class="ae jd" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="kx jh">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae jd" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="kx jh">推荐会员</strong> </a>，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p><p id="3240" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">非常感谢，很快再见！</p></div></div>    
</body>
</html>