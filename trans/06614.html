<html>
<head>
<title>More Pattern Matching in Python 3.10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 3.10中更多的模式匹配</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/more-advanced-pattern-matching-in-python-3-10-2dbd8598302a?source=collection_archive---------19-----------------------#2021-06-14">https://towardsdatascience.com/more-advanced-pattern-matching-in-python-3-10-2dbd8598302a?source=collection_archive---------19-----------------------#2021-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d17f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">比‘开关’厉害多了。我在哈利·波特和一只死鹦鹉的帮助下解释</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0dc2998a80209d3429bd088c4e8a0f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*podRNE8ID6HuUL6T"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@ashkfor121?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ashkan Forouzani </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0a80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python终于有了一个<em class="lv"> switch </em>语句。万岁！</p><p id="7dfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但它不是你在C或Java中会发现的常见或普通的switch语句——当然不是，这是Python。Python 3.10实现了结构化模式匹配，可以像一个<em class="lv"> switch </em>语句一样简单，但也可以更复杂。</p><p id="be5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在这里介绍了结构模式匹配的基础知识<a class="ae ky" rel="noopener" target="_blank" href="/pattern-matching-in-python-3-10-6124ff2079f0">——本文深入探讨了这个主题，着眼于捕获匹配的模式(获取可能不止一个值的匹配值)并向模式添加条件。</a></p><p id="d8eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，首先，让我们复习一下基础知识。结构匹配模式是用关键字<code class="fe lw lx ly lz b">match</code>实现的。这包含一个块，该块包含每个匹配的一列<code class="fe lw lx ly lz b">case</code>语句。您可以在下面的代码中看到语法——它非常简洁明了。</p><p id="86aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码运行一个循环，给变量<code class="fe lw lx ly lz b">quote</code>赋值1，2，3，4和5。我们定义了四种情况，第一种匹配数字1或4(<code class="fe lw lx ly lz b">| </code>字符是or操作符)；第二个和第三个分别匹配2和3，最后一个是匹配任何内容的通配符。大小写是按顺序处理的，所以只有前面的任何一个不匹配时，通配符才匹配。此外，与C不同，这里没有“中断”语句——在每种情况下的代码块被执行后，控制被转移到<code class="fe lw lx ly lz b">match</code>的末尾。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="8a88" class="me mf it lz b gy mg mh l mi mj">for quote in [1,2,3,4,5]:<br/>    match quote:<br/>        case 1|4:<br/>            print("He's gone to meet his maker.")<br/>        case 2:<br/>            print("He should be pushing up the daisies.")<br/>        case 3:<br/>            print("He's shuffled off his mortal coil.")<br/>        case _:<br/>            print("This is a dead parrot!")</span></pre><p id="bf3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是运行代码的结果:</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="6aa8" class="me mf it lz b gy mg mh l mi mj">He's gone to meet his maker.<br/>He should be pushing up the daisies.<br/>He's shuffled off his mortal coil.<br/>He's gone to meet his maker.<br/>This is a dead parrot!</span></pre><h2 id="9451" class="me mf it bd mk ml mm dn mn mo mp dp mq li mr ms mt lm mu mv mw lq mx my mz na bi translated">捕获匹配的模式</h2><p id="a6a4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">有时，当我们匹配OR模式时，我们希望能够使用匹配的值。</p><p id="94b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们想象一下，某个偶然熟悉Python的书呆子，决定表示一个类似于下面这样的Monty Python脚本:</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="59eb" class="me mf it lz b gy mg mh l mi mj">script = [["The Dead Parrot Sketch"],<br/>          ["Cast","Customer","Shop Owner"],<br/>          ["Customer","He's gone to meet his maker."],<br/>          ["Owner","Nah, he's resting."],<br/>          ["Customer","He should be pushing up the daisies."],<br/>          ["Owner", "He's pining for the fjords"],  <br/>          ["Customer", "He's shuffled off his mortal coil."],<br/>          ["Customer", "This is a dead parrot!"]]</span></pre><p id="b95d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个列表列表。第一个包含一个字符串—标题。第二个是cast，它是字符串“Cast ”,后面跟有许多其他字符串，代表<em class="lv">剧中人</em>。其余的是两个字符串的列表，演职人员和他或她应该说的台词。</p><p id="fb3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里没有数据设计奖。</p><p id="f0b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们如何解读这个结构？标题很容易匹配，因为它是唯一的单个字符串。通过指定一个以字符串“cast”开头，后跟许多其他元素的列表来匹配转换(<code class="fe lw lx ly lz b">*actors</code>就是这样做的)。脚本的行由最后一个案例匹配:它匹配两个元素，第一个是“Customer”或“Owner ”,第二个是<code class="fe lw lx ly lz b">line</code>,它将捕获脚本的行。问题是我们想在下面的代码中使用“客户”或“所有者”的值，所以我们使用关键字<code class="fe lw lx ly lz b">as</code>将它绑定到变量<code class="fe lw lx ly lz b">person</code>。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="c0ef" class="me mf it lz b gy mg mh l mi mj">for line in script:<br/>    match line:<br/>        case [title]:<br/>            print(title)<br/>        case ["Cast",*actors]:<br/>            print("Cast:")<br/>            for a in actors: print(a)<br/>            print("---")<br/>        case [("Customer"|"Owner") as person, line] :<br/>            print(f"{person}: {line}")</span></pre><p id="5214" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码，我们得到这个:</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="bd7c" class="me mf it lz b gy mg mh l mi mj">The Dead Parrot Sketch<br/>Cast:<br/>Customer<br/>Shop Owner<br/>---<br/>Customer: He's gone to meet his maker.<br/>Owner: Nah, he's resting.<br/>Customer: He should be pushing up the daisies.<br/>Owner: He's pining for the fjords<br/>Customer: He's shuffled off his mortal coil.<br/>Customer: This is a dead parrot!</span></pre><h2 id="4724" class="me mf it bd mk ml mm dn mn mo mp dp mq li mr ms mt lm mu mv mw lq mx my mz na bi translated">条件格</h2><p id="de00" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在这种情况下，我们希望在满足某些条件的情况下创建匹配。看看下面的代码:我们有一个哈利波特角色列表和一个银河系漫游指南中的角色列表。</p><p id="b716" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们要求输入一个名字，然后尝试匹配这个名字。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="8def" class="me mf it lz b gy mg mh l mi mj">harrypotter = ["Harry","Hermione","Ron"]</span><span id="5473" class="me mf it lz b gy ng mh l mi mj">hhgtg = ["Arthur","Ford","Zaphod","Trillian"]</span><span id="aaa8" class="me mf it lz b gy ng mh l mi mj">name = input("Enter a name: ")</span><span id="115a" class="me mf it lz b gy ng mh l mi mj">match name:<br/>    case n if n in hhgtg:<br/>        print(f"{n} is a character in Hitchhiker's guide to the Galaxy.")<br/>    case n if n in harrypotter:<br/>        print(f"{n} is a character in the Harry Potter stories.")<br/>    case _:<br/>        print(f"{n} is an unknown character.")</span></pre><p id="211e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种结构:</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="d63b" class="me mf it lz b gy mg mh l mi mj">case &lt;match&gt; if &lt;match&gt; in &lt;list&gt; </span></pre><p id="b92b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只匹配一个大小写，如果它满足我们想要匹配的字符串在列表中的条件。我认为代码是不言自明的，所以这是程序运行几次的结果。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="944f" class="me mf it lz b gy mg mh l mi mj">Enter a name: Harry<br/>Harry is a character in the Harry Potter stories.</span><span id="5b13" class="me mf it lz b gy ng mh l mi mj">Enter a name: Zaphod<br/>Zaphod is a character in Hitchhiker's guide to the Galaxy.</span><span id="f635" class="me mf it lz b gy ng mh l mi mj">Enter a name: Elizabeth Bennet<br/>Elizabeth Bennet is an unknown character.</span></pre><p id="abaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一种情况当然是通配符，它将匹配以前没有处理过的任何内容。</p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="15dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解更多，请访问Python.org网站并阅读<a class="ae ky" href="https://www.python.org/dev/peps/pep-0636/" rel="noopener ugc nofollow" target="_blank"> PEP 636 </a>，这是一篇关于结构模式匹配的教程。</p><p id="9485" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解更多关于Python 3.10中的新特性，你可以看看其他媒体文章，比如James Briggs的Python 3.10中的新特性。</p><p id="1a70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我在我的<a class="ae ky" rel="noopener" target="_blank" href="/pattern-matching-in-python-3-10-6124ff2079f0">上一篇文章</a>中提到的，你还不应该认真使用Python 3.10，因为它仍然是一个测试版，但是如果你想试用它，可以从Python网站上下载。</p></div></div>    
</body>
</html>