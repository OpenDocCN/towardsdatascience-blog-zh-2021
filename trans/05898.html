<html>
<head>
<title>Exploratory Data Analysis in R: Data Summarising, Visualization, and Predictive Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中的探索性数据分析:数据汇总、可视化和预测模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploratory-data-analysis-in-r-data-visualization-summarising-and-machine-learning-model-da79439b3952?source=collection_archive---------16-----------------------#2021-05-26">https://towardsdatascience.com/exploratory-data-analysis-in-r-data-visualization-summarising-and-machine-learning-model-da79439b3952?source=collection_archive---------16-----------------------#2021-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/97438a4a2a1755287d1a11d39db7628b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Coq-5Jlj5l7tnLem"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">考特尼·库克在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="4067" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">提取数据集的含义</h2></div><p id="5bb6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">探索性数据分析对于理解任何数据集都是不可避免的。它包括数据汇总、可视化、一些统计分析和预测分析。本文将关注使用R和R的不同包的数据故事或探索性数据分析。</p><p id="fcc0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文将涵盖:</p><ol class=""><li id="c175" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">一些关键点的总结和可视化</li></ol><p id="ae8b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.一些基本统计数据</p><p id="d9c4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.预测模型</p><p id="4615" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您经常关注我的文章，您可能已经在Python中看到过另一个使用相同数据集的探索性数据分析项目。以下是链接:</p><div class="is it gp gr iu md"><a rel="noopener follow" target="_blank" href="/exploratory-data-analysis-visualization-and-prediction-model-in-python-241b954e1731"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jk gy z fp mi fr fs mj fu fw ji bi translated">Python中的探索性数据分析、可视化和预测模型</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">在Python中使用Pandas、Matplotlib、Seaborn和Scikit_learn库</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ja md"/></div></div></a></div><p id="da3d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在这里使用相同的数据集来执行r中的探索性数据分析。</p><p id="d2d1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">开始吧！<a class="ae jg" href="https://www.kaggle.com/andrewmvd/heart-failure-clinical-data" rel="noopener ugc nofollow" target="_blank">请随意从此链接</a>下载数据集。</p><h2 id="2211" class="ms mt jj bd mu mv mw dn mx my mz dp na lh nb nc nd ll ne nf ng lp nh ni nj nk bi translated">总结和可视化</h2><p id="052e" class="pw-post-body-paragraph ky kz jj la b lb nl kk ld le nm kn lg lh nn lj lk ll no ln lo lp np lr ls lt im bi translated">我将数据集与RStudio文件放在同一个文件夹中。因此，我可以在RStudio中读取CSV文件:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="8cb8" class="ms mt jj nv b gy nz oa l ob oc">df = read.csv("heart_failure_clinical_records_dataset.csv")</span></pre><p id="f07c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我没有展示截图，因为数据集相当大。这些是数据集中的列:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="bfc4" class="ms mt jj nv b gy nz oa l ob oc">colnames(df)</span></pre><p id="3533" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="fd6f" class="ms mt jj nv b gy nz oa l ob oc">[1] "age"                      "anaemia"                  "creatinine_phosphokinase" "diabetes"                 "ejection_fraction"       <br/> [6] "high_blood_pressure"      "platelets"                "serum_creatinine"         "serum_sodium"             "sex"                     <br/>[11] "smoking"                  "time"                     "DEATH_EVENT"</span></pre><p id="8324" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据集有不同的健康参数、年龄、性别和死亡事件。有许多方法可以处理数据集。我想先看一个相关图。最好先看看哪些变量是相关的。它需要“corrplot”库。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="8402" class="ms mt jj nv b gy nz oa l ob oc">library(corrplot)<br/>corrplot(cor(df), type = "upper")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/9bddb893dad7ef573f8c96b30bcb9fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*hTMBZGRS5LFiqpqNVtZjJQ.png"/></div></figure><p id="175a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将用这个情节作为决定下一步行动的指南。</p><p id="fc64" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个数据集中有六个连续变量。让我们检查它们的分布。首先，这六个变量将被分离为不同的数据集，然后使用基数R制作直方图:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="1108" class="ms mt jj nv b gy nz oa l ob oc">df1 = df[, c('age', 'creatinine_phosphokinase', 'ejection_fraction', 'platelets', 'serum_creatinine', 'serum_sodium')]</span><span id="54a2" class="ms mt jj nv b gy oe oa l ob oc">hist.data.frame(df1, title = "Histograms of all Numerical Variables")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/c90f5026cac8ec224ae82106f3e482e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*xVeki1KdiWw5F-4BdhMG8Q.png"/></div></figure><p id="3a2c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该分布提供了关于这六个变量的概念。有一些数据会更有帮助。我将使用给出一些基本统计参数的汇总函数。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="07cd" class="ms mt jj nv b gy nz oa l ob oc">summary(df1)</span></pre><p id="7a70" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="ff95" class="ms mt jj nv b gy nz oa l ob oc">age        creatinine_phosphokinase ejection_fraction   platelets     <br/> Min.   :40.00   Min.   :  23.0           Min.   :14.00     Min.   : 25100  <br/> 1st Qu.:51.00   1st Qu.: 116.5           1st Qu.:30.00     1st Qu.:212500  <br/> Median :60.00   Median : 250.0           Median :38.00     Median :262000  <br/> Mean   :60.83   Mean   : 581.8           Mean   :38.08     Mean   :263358  <br/> 3rd Qu.:70.00   3rd Qu.: 582.0           3rd Qu.:45.00     3rd Qu.:303500  <br/> Max.   :95.00   Max.   :7861.0           Max.   :80.00     Max.   :850000  <br/> serum_creatinine  serum_sodium  <br/> Min.   :0.500    Min.   :113.0  <br/> 1st Qu.:0.900    1st Qu.:134.0  <br/> Median :1.100    Median :137.0  <br/> Mean   :1.394    Mean   :136.6  <br/> 3rd Qu.:1.400    3rd Qu.:140.0  <br/> Max.   :9.400    Max.   :148.0</span></pre><p id="a2b7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，为了方便起见，将分类变量作为单独的数据集:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="5e90" class="ms mt jj nv b gy nz oa l ob oc">df2 = df[, c('anaemia', 'diabetes', 'high_blood_pressure', 'sex', 'smoking', 'DEATH_EVENT')]</span><span id="87e7" class="ms mt jj nv b gy oe oa l ob oc">head(df2)</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi og"><img src="../Images/47dc26419374e4b6ea748b30bef82e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*7_P7P1F4qp10Cy5NzZCBOg.png"/></div></div></figure><p id="f843" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尽管相关图显示死亡事件和“性别”变量之间没有相关性。还是想看看男女死亡人数。在此之前，最好将这些列的0和1改为一些有意义的字符串。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="4aa3" class="ms mt jj nv b gy nz oa l ob oc">df$death = ifelse(df$DEATH_EVENT == 1, "Yes", "No")<br/>df$sex = ifelse(df$sex == 1, "Male", "Female")</span><span id="c9f2" class="ms mt jj nv b gy oe oa l ob oc">table(df$sex, df$death)</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/602a48f5308656dff4bb11c7a55ca87a.png" data-original-src="https://miro.medium.com/v2/resize:fit:254/format:webp/1*3D8LjslsVjOW4IZJzXbcQw.png"/></div></figure><p id="085d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总体而言，数据集中男性多于女性。男女比例是多少？</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="bda1" class="ms mt jj nv b gy nz oa l ob oc">data = table(df$sex)<br/>data1 = round(data/sum(data)*100)<br/>data1 = paste(names(data1), data1)<br/>paste(data1, "%", sep = "")</span></pre><p id="fb52" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="a03d" class="ms mt jj nv b gy nz oa l ob oc">[1] "Female 35%" "Male 65%"</span></pre><p id="65f9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了进一步了解数据集中的人口，让我们分别检查男性和女性人口的年龄分布:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="cf5b" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(x = age)) + <br/>  geom_histogram(fill = "white", colour = "black") + <br/>  facet_grid(sex ~ .)</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/630325b474ebd0a8cdcbd6793cbc7a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*AwDyTltOrk7vPr8txpEZjw.png"/></div></figure><p id="c29b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的直方图表明，男性人口总体上比女性人口年龄大。</p><p id="9627" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">血清肌酐和血清钠有一定的相关性。散点图将清楚地显示:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="054a" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df) + geom_point(aes(x = serum_creatinine, y = serum_sodium, colour = death, shape = death)) + ggtitle("Serum Creatinine vs Serum Sodium")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/3ace325faeb09e44b21925c0b3171616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*bYUguLZeLx_TjvQjI9RadA.png"/></div></figure><p id="83e0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于一些异常值，大部分数据都聚集在一个地方。在这种情况下，一个好的做法是检查没有这些异常值的同一个图。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="9733" class="ms mt jj nv b gy nz oa l ob oc">df_scr = df[df$serum_creatinine &lt; 4.0 &amp; df$serum_sodium &gt; 120,]</span><span id="dd2b" class="ms mt jj nv b gy oe oa l ob oc">ggplot(df_scr) + geom_point(aes(x = serum_creatinine, y = serum_sodium, colour = death, shape = death)) + ggtitle("Serum Creatinine vs Serum Sodium")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/4dd9e5720b9165d0aca9648596cdad23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*rN8oPAlSWf0u30B6AmyHCA.png"/></div></figure><p id="27b1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该图清楚地显示了血清钠和血清肌酸酐之间的关系。这些点被死亡事件用不同的颜色和形状分开。</p><p id="d59b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个图是射血分数对死亡事件。它将显示抖动图，实际上是散点图的修改版本。当散点图中的一个变量是分类变量时，点保持在一条直线上，它们重叠。变得难以理解。这就是为什么在抖动图中，他们会稍微偏移点，以便更好地理解数据。此外，我们将添加一个红点来显示数据的平均值。</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/c6420ca36a637ee4161d3fedee741088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*QU4joWhmiIoOfJgqN6MQKg.png"/></div></figure><p id="b2fd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你注意到我稍微整理了一下数据。我剔除了两个异常值。</p><p id="a45a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">时间变量与死亡事件有很强的相关性。我希望看到一个显示死亡事件和无死亡事件的“时间”差异的箱线图:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="3906" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(death, time))+geom_point() + labs(title="Death Event with Time Variable Segregated by Gender",<br/>                                                 x = "Death",<br/>                                                 y = "Time") +<br/>  geom_boxplot(fill='steelblue', col="black", notch=TRUE) + facet_wrap(~ sex)</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ol"><img src="../Images/577edff6187832a860ae4aced0916aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UG1Gz1xUUclrseiBkwKx3A.png"/></div></div></figure><p id="e0d9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">肌酐磷酸激酶与死亡事件有一定的相关性。下一个图用直方图探索了这个问题:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="cc1c" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(x=creatinine_phosphokinase, fill=death)) + geom_histogram(bins=20) + labs(title = "Distribution of Creatinine Phosphokinase", x = "Creatinine Phosphokinase", y = "Count")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/772a010a023a54f3542e7935f5aea863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*bfhQ8jxMwn6RGvMcGcvABQ.png"/></div></figure><p id="bcc3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">贫血也与肌酐磷酸激酶有关。这种分布可以按贫血症来区分，以便按贫血症分别观察分布情况:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="6376" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(x=creatinine_phosphokinase, fill=death)) + geom_histogram(bins=20)+facet_wrap(~anaemia) + labs(title = "Distribution of Creatinine Phosphokinase", x = "Creatinine Phosphokinase", y = "Count")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/611c9b0dbb664c97e3db700e259ba247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*L5W74EhhtpbD6EcZhhweCA.png"/></div></figure><p id="b050" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">贫血症和非贫血症人群的分布差异很大。</p><p id="1796" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“时间”变量与死亡事件有很强的相关性。这个年龄与时间散点图用不同的颜色显示死亡事件。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="1438" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(x = age, y = time, col = death))+geom_point() + labs(title = "Age vs Time", x = "Age", y = "Time")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/02eefbe440943b05ab808a5a50e92fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*9who4UEec9gbPiK3azXokw.png"/></div></figure><p id="f420" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下图显示了死亡事件中不同颜色的血清肌酐分布:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="12b1" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(x = serum_creatinine, fill = death))+geom_histogram() + labs(title = "Distribution of Serum Creatinine different colors for death event", x = "Serum Creatinine", y = "Count")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/1f1e66c900e8278627d78519fe424163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*z6_LxO5FnBllAMtCxLQg-Q.png"/></div></figure><p id="1063" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">极少数异常值在最右边。让我们检查没有这些异常值的相同分布:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="b37c" class="ms mt jj nv b gy nz oa l ob oc">df_sc = df[df$serum_creatinine &lt; 4.0,]</span><span id="ad54" class="ms mt jj nv b gy oe oa l ob oc">ggplot(df_sc, aes(x = serum_creatinine, fill = death))+geom_histogram() + labs(title = "Distribution of Serum Creatinine different colors for death event", x = "Serum Creatinine", y = "Count")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/60edc94050c2257d7e0f0f897f9e2260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*W4CNDj1uR8SCeT4iFD9RMg.png"/></div></figure><p id="9243" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在分布更加清晰了。</p><p id="c7f8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">死亡事件的射血分数可能不同。观察射血分数是否也因性别而异也将是有趣的。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="a8e3" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(death, ejection_fraction, fill = as.factor(sex))) + <br/>  geom_bar(stat = "summary", fun = "median", col = "black",<br/>           position = "dodge") + geom_point(position = position_dodge(0.9)) + labs(title = "Ejection Fraction per Death Event", x = "Death", y = "Ejection Fraction")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/9576e8e22d005f28815378550c41d1c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikVzQxkHr2-7YFmgv7RmlQ.png"/></div></div></figure><p id="d659" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那些黑点显示了数据中的差异。</p><p id="f55f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个图分别探索了死亡事件和非死亡事件中贫血和肌酸酐磷酸激酶之间的关系。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="a907" class="ms mt jj nv b gy nz oa l ob oc">ggplot(df, aes(x = as.factor(anaemia), y = creatinine_phosphokinase, fill = death)) + geom_violin() +<br/>  stat_summary(aes(x= as.factor(anaemia), y = creatinine_phosphokinase), fun = median, geom='point', colour = "red", size = 3)+facet_wrap(~death)+<br/>geom_jitter(position = position_jitter(0.1), alpha = 0.2) + labs(title = "Creatinine Phosphokinase for Anaemia State Segregated by Death Event", x = "Anaemia", y ="Creatinine Phosphokinase")</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5513c52b4d6f90bacbe21cca599c6c3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*79Lf65d2KzTP6Z6H0M2QdQ.png"/></div></figure><p id="3d40" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个情节中，你可以同时看到几个不同的角度。violin图显示了分布和异常值。同时，我将抖动图放入其中，红点指向相应数据的中值。</p><h2 id="6fbe" class="ms mt jj bd mu mv mw dn mx my mz dp na lh nb nc nd ll ne nf ng lp nh ni nj nk bi translated">预测模型</h2><p id="7b86" class="pw-post-body-paragraph ky kz jj la b lb nl kk ld le nm kn lg lh nn lj lk ll no ln lo lp np lr ls lt im bi translated">在本节中，我们将尝试使用数据集中的其他特征来预测死亡事件。首先，我们应该检查死亡事件的比例:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="eac9" class="ms mt jj nv b gy nz oa l ob oc">data = table(df$death)<br/>round(data/sum(data), 2)</span></pre><p id="8816" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="4021" class="ms mt jj nv b gy nz oa l ob oc"> No  Yes <br/>0.68 0.32</span></pre><p id="48dd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个预测模型，我将再次导入数据集，因为我对之前导入的数据集做了一些更改。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="9bc8" class="ms mt jj nv b gy nz oa l ob oc">df1 = read.csv("heart_failure_clinical_records_dataset.csv")</span></pre><p id="8b9f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我将数据集分为训练数据和测试数据。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="846b" class="ms mt jj nv b gy nz oa l ob oc">library(caTools)<br/>set.seed(1243)<br/>split = sample.split(df1$DEATH_EVENT, SplitRatio = 0.75)</span></pre><p id="f999" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这种分割应该为每个DEATH_EVENT提供布尔值。其中75%是真的，25%是假的。基于该分割值，训练数据和测试数据将被分离:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="eaec" class="ms mt jj nv b gy nz oa l ob oc">training_data = subset(d, split == TRUE)<br/>test_data = subset(d, split == FALSE)</span></pre><p id="5da4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据集已准备好用于分类器。我为这个项目选择一个支持向量机分类器。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="bcd4" class="ms mt jj nv b gy nz oa l ob oc">library(e1071)</span><span id="b679" class="ms mt jj nv b gy oe oa l ob oc">svm_fit = svm(formula = DEATH_EVENT ~ .,<br/>                 data = training_data,<br/>                 type = 'C-classification',<br/>                 kernel = 'linear'<br/>              )</span></pre><p id="41f4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练数据被拟合到分类器中，分类器现在被训练。现在可以用测试数据测试分类器了。使用测试数据，我将预测死亡事件。所以，我们需要从测试数据中排除死亡事件。</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="e60a" class="ms mt jj nv b gy nz oa l ob oc">y_pred = predict(svm_fit, newdata = test_data[-13])</span></pre><p id="4acc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">预测完成了。现在让我们检查一下预测的准确性。此处的“caret”包中使用了ConfusionMatrix函数。因为这个ConfusionMatrix函数只用一行代码就提供了如此多的信息:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="1b31" class="ms mt jj nv b gy nz oa l ob oc">library(caret)</span><span id="1aa8" class="ms mt jj nv b gy oe oa l ob oc">confusionMatrix(y_pred, as.factor(test_data$DEATH_EVENT))</span></pre><p id="0db9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="nq nr ns nt gt nu nv nw nx aw ny bi"><span id="ca97" class="ms mt jj nv b gy nz oa l ob oc">Confusion Matrix and Statistics</span><span id="f800" class="ms mt jj nv b gy oe oa l ob oc">Reference<br/>Prediction  0  1<br/>         0 47  5<br/>         1  4 19<br/>                                          <br/>               Accuracy : 0.88            <br/>                 95% CI : (0.7844, 0.9436)<br/>    No Information Rate : 0.68            <br/>    P-Value [Acc &gt; NIR] : 5.362e-05       <br/>                                          <br/>                  Kappa : 0.7212          <br/>                                          <br/> Mcnemar's Test P-Value : 1               <br/>                                          <br/>            Sensitivity : 0.9216          <br/>            Specificity : 0.7917          <br/>         Pos Pred Value : 0.9038          <br/>         Neg Pred Value : 0.8261          <br/>             Prevalence : 0.6800          <br/>         Detection Rate : 0.6267          <br/>   Detection Prevalence : 0.6933          <br/>      Balanced Accuracy : 0.8566          <br/>                                          <br/>       'Positive' Class : 0</span></pre><p id="d602" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总体准确率为88%。</p><p id="094b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看上面的混淆矩阵！它准确地预测了47个无死亡事件，4个无死亡事件被错误地预测为死亡事件。另一方面，19个死亡事件被准确预测，5个死亡事件被错误预测为无死亡事件。</p><p id="d88f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里真阳性是19，假阳性是4，假阴性是5。使用此信息，F1分数计算如下:</p><p id="03d0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">true _ positive/(true _ positive+0.5 *(false _ positive+false _ negative))= 0.81</p><p id="c49b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我不是在评论预测模型的效果是好是坏。这取决于期望值，期望值因项目而异。</p><h2 id="a4c4" class="ms mt jj bd mu mv mw dn mx my mz dp na lh nb nc nd ll ne nf ng lp nh ni nj nk bi translated">结论</h2><p id="5b3f" class="pw-post-body-paragraph ky kz jj la b lb nl kk ld le nm kn lg lh nn lj lk ll no ln lo lp np lr ls lt im bi translated">探索性数据分析是非常动态的。你可以用很多不同的方法来处理数据集。这是我的方法之一。如果你以前在Python中检查过我在相同数据集上的工作，你会看到一种不同的方法。请随意尝试一些其他类型的可视化和分类器。感谢阅读！</p><p id="f443" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">欢迎在推特上关注我，喜欢我的T2脸书页面。</p><h2 id="8447" class="ms mt jj bd mu mv mw dn mx my mz dp na lh nb nc nd ll ne nf ng lp nh ni nj nk bi translated">更多阅读</h2><div class="is it gp gr iu md"><a rel="noopener follow" target="_blank" href="/a-complete-free-course-on-inferential-statistics-for-data-scientists-in-r-129483f5f522"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jk gy z fp mi fr fs mj fu fw ji bi translated">一个完全免费的R语言数据科学家推断统计学课程</h2><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="oq l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a rel="noopener follow" target="_blank" href="/exploratory-data-analysis-of-text-data-including-visualization-and-sentiment-analysis-e46dda3dd260"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jk gy z fp mi fr fs mj fu fw ji bi translated">文本数据的探索性数据分析，包括可视化和情感分析</h2><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="or l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a rel="noopener follow" target="_blank" href="/a-complete-beginners-guide-to-data-visualization-in-ggplot2-121f1eee23cd"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jk gy z fp mi fr fs mj fu fw ji bi translated">ggplot2中数据可视化的完全初学者指南</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">这是一个丰富的图书馆。今天就开始使用吧</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="os l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a rel="noopener follow" target="_blank" href="/text-files-processing-cleaning-and-classification-of-documents-in-r-394c6b4f1504"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jk gy z fp mi fr fs mj fu fw ji bi translated">R语言中文本文件的处理、清理和分类</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">使用了一些很棒的包和K近邻分类器</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="ot l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a rel="noopener follow" target="_blank" href="/python-or-r-which-one-is-better-for-data-scientists-or-data-analysts-3be038f6c74c"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jk gy z fp mi fr fs mj fu fw ji bi translated">Python还是R？数据科学家和数据分析师哪个好？</h2><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="ou l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a rel="noopener follow" target="_blank" href="/do-you-need-a-masters-degree-to-become-a-data-scientist-ab894c2a8d41"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jk gy z fp mi fr fs mj fu fw ji bi translated">成为数据科学家需要硕士学位吗？</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">我作为波士顿大学数据分析专业硕士学生的经历和体会</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="ov l mo mp mq mm mr ja md"/></div></div></a></div></div></div>    
</body>
</html>