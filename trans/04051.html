<html>
<head>
<title>iOS Computer Vision Object Detection with Turi Create</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Turi Create的iOS计算机视觉对象检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ios-computer-vision-object-detection-with-turi-create-be109edd4257?source=collection_archive---------31-----------------------#2021-04-05">https://towardsdatascience.com/ios-computer-vision-object-detection-with-turi-create-be109edd4257?source=collection_archive---------31-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e7f6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">iOS计算机视觉项目概述，该项目的构建和部署不到一天时间</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1070ab5e560a6b3bb3a19a4051d8552a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pStxtJ57yM2Pdmyf"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">卡尔·海尔达尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6b44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">计算机视觉项目无处不在。</strong></p><p id="6902" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，训练你的计算机视觉模型并不总是容易的。Keras中的对象检测需要一些操作，而在Tensorflow或PyTorch中编写相同的代码需要一些严肃的代码柔术。那么，即使你能够训练你的模型，也要祝你好运把它放到移动设备上。谷歌云的AutoML解决了部分问题，但简单的iOS部署可能难以实现。</p><p id="52ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">苹果用它的<a class="ae kv" href="https://developer.apple.com/documentation/createml" rel="noopener ugc nofollow" target="_blank"> Create ML </a>工具做了一件惊人的工作，让iOS的计算机视觉更加平易近人。如果你不关心超参数调整，或者如果你被Python或Keras吓到了，那么苹果提供了一种快速简单的方法，只需拖放你的标记图像，然后开始训练。训练后，模型可以很容易地放到iOS应用程序中，让其他人也能很容易地使用你创造的东西。作为起点，苹果开发者文档提供了一个用于对象检测的<a class="ae kv" href="https://developer.apple.com/documentation/vision/recognizing_objects_in_live_capture" rel="noopener ugc nofollow" target="_blank">优秀示例应用</a>。</p><p id="dafc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，如果您试图训练的模型过于耗费资源，无法在标准Mac硬件上构建，该怎么办？如果您想利用GPU来加快训练过程，该怎么办？根据这篇文章的标题，你可能会认为这是Turi Create的切入点。</p><div class="ls lt gp gr lu lv"><a href="https://github.com/apple/turicreate" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">苹果/turicreate</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">快速链接:安装|文档| WWDC 2019 | WWDC 2018查看我们在WWDC 2019和WWDC 2018的演讲…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="ecb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了更好地了解一个端到端的Turi Create项目是什么样子的，你可以看看<a class="ae kv" href="https://github.com/mcgovey/compvision-playing-card-detection" rel="noopener ugc nofollow" target="_blank">这个用于计算机视觉扑克牌检测的repo </a>，以及<a class="ae kv" href="https://github.com/mcgovey/compvision-playing-card-detection/raw/master/Kevin%20McGovern%20Project%20Overview.pdf" rel="noopener ugc nofollow" target="_blank">这个总结项目的论文</a>或<a class="ae kv" href="https://www.youtube.com/watch?v=ZEHn_VSixwI" rel="noopener ugc nofollow" target="_blank">这个视频概述</a>。</p><div class="ls lt gp gr lu lv"><a href="https://github.com/mcgovey/compvision-playing-card-detection" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">mcgovey/compvision-扑克牌-检测</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">使用扑克牌的视频，两三张扑克牌在一个随机的…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mk l mg mh mi me mj kp lv"/></div></div></a></div><p id="5da1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于那些不熟悉Turi Create T1的人来说，它是一个Python库，抽象了Tensorflow、PyTorch甚至Keras的复杂性。它的Python API可以很容易地将数据格式化为所需的预处理图像格式，然后创建一个可以在不同类型的硬件上运行的模型(不仅仅是像Create ML这样的MAC)。</p><p id="055d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用笔记本电脑之外的东西最好的一点是，有一个免费的资源可以帮助使用已经可用的GPU进行培训，Google Colab。根据你的模型的复杂性，你可能需要升级你的账户，以利用<a class="ae kv" href="https://colab.research.google.com/signup" rel="noopener ugc nofollow" target="_blank">谷歌Colab Pro </a>的高内存和更快的GPU。</p><h2 id="3c42" class="ml mm iq bd mn mo mp dn mq mr ms dp mt lf mu mv mw lj mx my mz ln na nb nc nd bi translated">项目演练</h2><p id="c26a" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">在使用Turi Create做任何事情之前，您必须将数据转换成一种叫做sFrame的格式。这意味着您计划用来训练计算机视觉模型的图像必须具有概述图像、标签和边界框尺寸的格式(如果是对象检测模型)。<a class="ae kv" href="https://colab.research.google.com/drive/1IY-XJyvkcc2oKCJK6SyyHtGxv_VIzlmy?usp=sharing" rel="noopener ugc nofollow" target="_blank">这本笔记本</a>讲述了一个物体探测模型的例子。</p><p id="0f2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你的数据在一个sFrame中，你就可以开始使用Turi Create构建你的模型了。本笔记本会带你完成这些步骤。如上所述，加速模型训练的方法之一是使用GPU。如果您使用的是Google Colab，您可以通过单击运行时&gt;更改运行时类型&gt;然后选择硬件加速器下的下拉菜单并将其更改为GPU来实现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/037b2fa7bb811a59cc1e50c89ed62923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s5xAZ1H1UoE5C549dAdJxw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在Google Colab中改变运行时类型。</p></figure><p id="ef7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦设置被更改，你仍然需要让Turi Create来识别你的GPU。在linux系统上(这是Google Colab构建的基础)，你可以用下面的代码块来做这件事(注意，在这些命令之间还有其他事情要做，但是我想强调一下特定于GPU的命令。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="b92e" class="ml mm iq nl b gy np nq l nr ns">!pip install turicreate</span><span id="20cf" class="ml mm iq nl b gy nt nq l nr ns">!pip uninstall -y tensorflow</span><span id="c91c" class="ml mm iq nl b gy nt nq l nr ns">!pip install tensorflow-gpu</span><span id="fd6f" class="ml mm iq nl b gy nt nq l nr ns">!export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH</span><span id="c1bf" class="ml mm iq nl b gy nt nq l nr ns">tc.config.set_num_gpus(-1)</span></pre><p id="e45d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">要了解更多关于本库实现的细节，请查看</strong> <a class="ae kv" href="https://apple.github.io/turicreate/docs/userguide/image_classifier/advanced-usage.html#using-gpus" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Turi创建文档</strong> </a> <strong class="ky ir">。</strong></p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="ab04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦将数据加载到sFrame和环境设置中，就可以开始训练模型了。您可以决定您希望模型运行多少次迭代。对于您的第一次运行，您将希望从少量的迭代开始，以确保一切按预期运行。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="ceef" class="ml mm iq nl b gy np nq l nr ns"># Create a model</span><span id="9488" class="ml mm iq nl b gy nt nq l nr ns">model = tc.object_detector.create(train_data, max_iterations=10)</span></pre><h2 id="3264" class="ml mm iq bd mn mo mp dn mq mr ms dp mt lf mu mv mw lj mx my mz ln na nb nc nd bi translated">训练就是这么简单！</h2><p id="a1e1" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">既然您已经训练了您的模型，请确保保存它。如果你想以后再来看它，那么你要确保把它保存为一个<em class="ob">。型号</em>文件。当你准备把它放到iOS应用程序中时，把它存为一个<em class="ob">。mlmodel </em>。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="94ed" class="ml mm iq nl b gy np nq l nr ns"># Save the model for later use in Turi Create</span><span id="5d7d" class="ml mm iq nl b gy nt nq l nr ns">model.save(’mymodel.model’)</span><span id="8931" class="ml mm iq nl b gy nt nq l nr ns"># Export for use in Core ML</span><span id="88d0" class="ml mm iq nl b gy nt nq l nr ns">model.export_coreml(’mymodel.mlmodel’)</span></pre><p id="7626" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后一件事！你会想看看你的模型表现如何。您可以使用model.evaluate(test_data)方法来查看模型在训练数据或样本数据之外的表现。</p><p id="1f67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">这并不难！</strong>所以下一次当你试图建立一个计算机视觉模型，并且你不想担心在Keras中训练一个模型和担心转换格式，或者创建ML花费太长时间的时候，想想Turi Create！</p></div></div>    
</body>
</html>