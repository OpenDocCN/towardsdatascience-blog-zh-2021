<html>
<head>
<title>An Approach for Choosing Number of Clusters for K-Means</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种选择K-均值聚类数的方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-approach-for-choosing-number-of-clusters-for-k-means-c28e614ecb2c?source=collection_archive---------7-----------------------#2021-06-27">https://towardsdatascience.com/an-approach-for-choosing-number-of-clusters-for-k-means-c28e614ecb2c?source=collection_archive---------7-----------------------#2021-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f2ba" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">所建议的方法考虑了内部距离和聚类数目之间的一般权衡，并自动选择聚类数目</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c5618d1b4e79f24ed191ac7fa2bc109c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwh4ElgPDfTIF0AfGxrdxQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">弗兰基·查马基在<a class="ae kv" href="https://unsplash.com/s/photos/data-clusters?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e2ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们使用聚类算法时，选择聚类的数量总是一项具有挑战性的任务。虽然有一些现有的方法可以帮助完成这项任务，但它们通常是单独使用，以便做出决定。此外，您可能还需要根据方法的结果手动选择最终的集群数量。</p><p id="eaf2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我建议一种方法，它考虑了内部距离和集群数量之间的折衷，并自动选择集群的数量。</p><h1 id="d10e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">现有方法</h1><p id="9cde" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在本节中，您可以找到选择集群数量的两种最常见的方法。各有各的优势和局限。</p><h2 id="bb39" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">轮廓分析</h2><p id="cd07" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这是一个众所周知的方法，也提供了非常酷的可视化。它允许我们解释和验证集群内的一致性。完整的Python实现和解释可以在scikit-learn页面中找到:</p><div class="nb nc gp gr nd ne"><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">在KMeans clustering - scikit-learn上使用剪影分析选择聚类数…</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">剪影分析可用于研究所得聚类之间的分离距离。剪影情节…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">scikit-learn.org</p></div></div><div class="nn l"><div class="no l np nq nr nn ns kp ne"/></div></div></a></div><p id="af90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个scikit-learn Python代码产生了下面的可视化效果，帮助我们理解所选择的集群数量是否是一个好的选择。</p><p id="fe16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种方法的一个缺点(在链接中也有提到)是，它可能会产生多个集群，所以您需要自己从不同的选项中进行选择。</p><h2 id="981a" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">惯性和肘法</h2><p id="a251" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">惯性是样本到它们最近的聚类中心的平方距离的总和。我们希望这个数字尽可能小。但是，如果我们选择K等于样本数，我们将得到惯性=0。这是我们能够达到的最小惯性值，但是我们没有达到将数据聚类到最佳数量的聚类中的目标。<br/>惯性值随着聚类数的增加而减少——所以我们需要手动选择K，同时考虑惯性值和聚类数之间的权衡。为此，我们通常使用肘方法，我们选择惯性图中的肘点。之后，惯性值的改善不显著。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/a54096a4e65bfdaed2c7a369aa500e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*xLl_4YMENQBEGZV0BclMsg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">惯性图</p></figure><p id="2741" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基于这种方法，选择的K大约为8–11，但是需要手动选取。</p><p id="6178" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一篇很好的文章总结了这种方法:</p><div class="nb nc gp gr nd ne"><a rel="noopener follow" target="_blank" href="/k-means-clustering-from-a-to-z-f6242a314e9a"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">k-均值聚类:从A到Z</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">关于K-均值聚类你需要知道的一切</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">towardsdatascience.com</p></div></div><div class="nn l"><div class="nu l np nq nr nn ns kp ne"/></div></div></a></div><h1 id="c212" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">建议的接近比例惯性</h1><p id="7b16" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">上述两种方法需要您手动决定集群的数量。基于我从这些方法中学到的东西，我开发了一个自动选择K(聚类数)的过程。</p><p id="d733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所建议的方法考虑了每个可能的K的惯性值，并通过惩罚参数对其进行加权。该参数表示惯性和簇数量之间的权衡。</p><p id="b330" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们没有单独使用惯性，而是计算了它的加权版本:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/971372bf3bc0a3f1080661ca92544cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*koIzAEI-tJ8uBavuouMFPw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">比例惯性公式</p></figure><ul class=""><li id="f4a4" class="nw nx iq ky b kz la lc ld lf ny lj nz ln oa lr ob oc od oe bi translated">惯性-样本到其最近的聚类中心的距离的平方和</li><li id="ae75" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated">阿尔法-手动调整的因素，给予惩罚的集群数量</li><li id="d2c6" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated">惯性(K=1)-所有数据点都在同一聚类中的基本情况的惯性</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/64e57178e490d7078426ec7868727eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*lOVgsMF3-AYyH5AlAtEZUA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">比例惯性图</p></figure><p id="972e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Alpha是手动调整的，因为在我看来，集群数量的损失是一个商业决策，应该纳入分析中。</p><p id="3e20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用缩放的惯性，选择的K是明显的，并且可以自动完成。在上述情况下，K=9。</p><h1 id="831e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">密码</h1><p id="b4b0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">以下函数是在并行计算中为每个K计算调整后的惯性。非并行选项在下一段代码中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="6b4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">非平行选项:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="3c02" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">示例-如何使用</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="02ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该函数返回最佳k值和一个数据框，该数据框包含所有可能的k值的所有调整惯性值:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/bb619cca1be18b4ce632cc01a8dfc517.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/1*i4CPzZtpy-_4nlDF_WwRDA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">返回的结果</p></figure><h1 id="8c47" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">关闭</h1><p id="f287" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">建议的解决方案对我过去遇到的各种业务问题非常有效。请让我知道它是如何为你工作的，如果你认为可以做更多的调整来改善它。</p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="a022" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">非常感谢Oshry Ben-Harush帮助我开发了这种方法，并感谢Noga Gershon Barak和T2 Noam Kalush提供的技术反馈以及对本文的校对和评论。</p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><h1 id="3610" class="ls lt iq bd lu lv ox lx ly lz oy mb mc jw oz jx me jz pa ka mg kc pb kd mi mj bi translated">附加阅读</h1><p id="e759" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">很好的指南，详细介绍了k-means算法以及在Python中的使用</p><div class="nb nc gp gr nd ne"><a href="https://realpython.com/k-means-clustering-python/" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">Python中的K-Means聚类:实用指南-真正的Python</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">在本教程中，您将了解到:聚类是一组用于将数据划分成组或簇的技术…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">realpython.com</p></div></div><div class="nn l"><div class="pc l np nq nr nn ns kp ne"/></div></div></a></div></div></div>    
</body>
</html>