<html>
<head>
<title>What Is Logistic Regression?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是逻辑回归？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-is-logistic-regression-d3f59ef1a9b?source=collection_archive---------22-----------------------#2021-05-21">https://towardsdatascience.com/what-is-logistic-regression-d3f59ef1a9b?source=collection_archive---------22-----------------------#2021-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5372" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">逻辑回归是数据科学家和机器学习工程师的基本分类工具。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2a95a4130acb94a0e9600e389df39159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZoCYVjaEy9P2agzg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@claybanks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克莱班克斯</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="eb59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本教程是关于应用逻辑回归的基础，使用了一点Python。也是《什么是线性回归》这篇帖子的延续。，可以在这里找到<a class="ae kv" rel="noopener" target="_blank" href="/what-is-linear-regression-e44d2c4bf025">。</a></p><h1 id="b15c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">关于逻辑回归</h1><p id="ae99" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这有点违反直觉，但逻辑回归通常被用作分类器。事实上，逻辑回归是科学家使用的最常用和最著名的数据分类方法之一。这种分类方法背后的思想是输出将在0和1之间。本质上是返回你给模型的数据属于某个组或类的概率。在那里，开发者可以根据他们想要的谨慎程度来设置阈值。</p><p id="6f8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，我可以将阈值设置为0.8。这意味着逻辑回归模型的任何输出等于或大于0.8将被归类为1。任何低于0的都将被归类为0。从那里，我可以根据我的用例以及我关心的指标，将0.8的阈值向上或向下移动。</p><h1 id="9c52" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">逻辑回归和线性回归有什么关系？</h1><p id="febb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">线性回归公式可以包含在逻辑回归公式中。如果你还记得，线性回归公式是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/cebef9b09b879e914c2b7687602be651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*g6nmKUcsCeGTuPLkKOScgQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">线性回归方程</p></figure><p id="fcfd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">嗯……逻辑回归的公式是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/39aaaa16a505c452a3a070a72b184e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*50T5llZegiCHTO8aAKSlwg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">逻辑回归方程</p></figure><p id="ca3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以用线性回归公式替换掉<code class="fe mr ms mt mu b">y</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/3ee5cdb4ca3b5f13b0c4d7d9ca974e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*QQOSybSqBPe5rC2pw03Caw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">逻辑回归方程2</p></figure><h1 id="5204" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">这个逻辑回归方程是干什么的？</h1><p id="4b9a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">线性回归部分提供一些输出值，逻辑回归部分将这些值推到0和1之间(包括0和1)。这在某种程度上形成了一条S曲线，你可能以前见过。</p><p id="39d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有，下面是Scikit学习文档中的一个示例:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/7e585a2076fe3a3dbade51d48854226e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*lVHhPPsMfy_RrjeSa2sv0g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://scikit-learn.org/stable/auto_examples/linear_model/plot_logistic.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/auto _ examples/linear _ model/plot _ logistic . html</a></p></figure><h1 id="2d7a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">让我们用Python编写一个例子</h1><p id="6aa3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们主要需要流行的机器学习库Scikit Learn。Numpy稍后用于构建一些数据结构，将数据输入Scikit Learn。</p><p id="8ac0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将创建关于患者的样本数据，以及他们是否应该被批准进行某种类型的治疗。我们将为年龄、体重、平均静息心率创建列，然后为批准决定创建列。除了批准决定之外，我们使用所有的列作为我们的特征。我们的模型应该估计每个特征对于批准决定的重要性，并且我们应该得到患者被批准治疗的概率。</p><p id="2ffd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注</strong>:这个数据完全是编造的。这并不表示医疗专业人员进行了任何真正的治疗或决策。</p><h2 id="b972" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">库导入</h2><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="e20e" class="mx lt iq mu b gy nn no l np nq"><em class="nr"># Import numpy to create numpy arrays</em><br/><strong class="mu ir">import</strong> <strong class="mu ir">numpy</strong> <strong class="mu ir">as</strong> <strong class="mu ir">np</strong><br/><br/><em class="nr"># Import Scikit-Learn to allow us to run Logistic Regression</em><br/><strong class="mu ir">from</strong> <strong class="mu ir">sklearn.linear_model</strong> <strong class="mu ir">import</strong> LogisticRegression</span></pre><h2 id="ac79" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">为我们的模型创建数据</h2><p id="18d2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们正在创建的数据包含与年龄、体重和平均心率相关的特征。我们的批准决定将是一个名为<code class="fe mr ms mt mu b">approved</code>的列，包含0或1，表示患者是否被批准。0表示患者未被批准，1表示患者被批准。</p><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="c8ff" class="mx lt iq mu b gy nn no l np nq"><em class="nr"># Sample Data</em><br/>approved = np.array([1, 1, 1, 0, 0, 0, 1, 1, 0, 0])<br/>age = [21, 42, 35, 33, 63, 70, 26, 31, 52, 53]<br/>weight = [110, 180, 175, 235, 95, 90, 175, 190, 250, 185]<br/>avg_hrt = [65, 70, 72, 77, 67, 62, 68, 65, 73, 75]</span></pre><h2 id="47d6" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">构建要素和标签</h2><p id="5980" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将多个Python数组堆叠成一个numpy对象。此外，指定认可阵列的“形状”。</p><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="aecb" class="mx lt iq mu b gy nn no l np nq"><em class="nr"># Combining the multiple lists into one object called "X"</em><br/>X = np.column_stack([age, weight, avg_hrt])</span><span id="f010" class="mx lt iq mu b gy ns no l np nq"><em class="nr"># Reshaping the approvals to work with scikit learn</em><br/>y = approved.reshape(len(approved), )</span></pre><h2 id="f035" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">让我们建立一个逻辑回归模型</h2><p id="a9f2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，我们实例化模型。</p><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="c259" class="mx lt iq mu b gy nn no l np nq"><em class="nr"># Instantiating the model object</em><br/>model = LogisticRegression()</span></pre><p id="7a7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以用数据来拟合模型。这就是我们如何估计患者的认可状态——给定他们的年龄、体重和平均静息心率。</p><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="3c18" class="mx lt iq mu b gy nn no l np nq"><em class="nr"># Fitting the model with data</em><br/>fitted_model = model.fit(X, y)</span></pre><p id="bdb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在模型已经训练好了，让我们来看看系数。</p><blockquote class="nt nu nv"><p id="e10d" class="kw kx nr ky b kz la jr lb lc ld ju le nw lg lh li nx lk ll lm ny lo lp lq lr ij bi translated">年龄的系数= -0.6785458695283049 <br/>体重的系数=-0.10023841185826<br/>平均静息心率的系数=-0.49686</p></blockquote><h2 id="a3eb" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">解释系数</h2><p id="ee83" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这些系数告诉我们，年龄是最重要的因素。紧随其后的是平均静息心率。对于这个特定的数据+案例，患者的体重排在最后。</p><p id="4eb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">系数的值量化了这些特性对获得批准的可能性有多大的影响。请这样想:</p><p id="532d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">随着特征值(左侧*)的增加，获得批准的概率降低，因为系数为负。减少量由系数值量化(右侧*)。</p><p id="9cff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">*左侧和右侧指的是系数的打印结果，如上所示。</p><p id="9edc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这有助于了解哪些特征有助于您的模型并影响您的决策。当谈到可解释的人工智能时，通常有一种方法来解释模型并看到模型如何做出决定是极其重要的。在这种情况下，我们可以查看系数来确定每个功能的影响程度，以及为什么算法可能会选择批准某个人，而不是其他人。</p><h1 id="a3a7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">让我们用新数据来检验这个模型</h1><h2 id="152e" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated"><strong class="ak">创建新数据</strong></h2><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="522d" class="mx lt iq mu b gy nn no l np nq">new_age = [20, 45, 33, 31, 62, 71, 72, 25, 30, 53, 55]<br/>new_weight = [105, 175, 170, 240, 100, 95, 200, 170, 195, 255, 180]<br/>new_avg_hrt = [64, 68, 70, 78, 67, 61, 68, 67, 66, 75, 76]</span><span id="0ddf" class="mx lt iq mu b gy ns no l np nq"><em class="nr"># Combining the multiple lists into one object called "test_X"</em><br/>test_X = np.column_stack([new_age, new_weight, new_avg_hrt])</span></pre><h2 id="be31" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">通过模型运行新数据</h2><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="9fdf" class="mx lt iq mu b gy nn no l np nq">results = fitted_model.predict(test_X)</span></pre><h2 id="9dfe" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">看一看结果</h2><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="00f1" class="mx lt iq mu b gy nn no l np nq">print(f"Our approval results are: <strong class="mu ir">{</strong>results<strong class="mu ir">}</strong>")</span></pre><blockquote class="nt nu nv"><p id="967d" class="kw kx nr ky b kz la jr lb lc ld ju le nw lg lh li nx lk ll lm ny lo lp lq lr ij bi translated">我们的审批结果是:[1 1 1 0 0 0 1 1 0 0]</p></blockquote><p id="1000" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，Scikit Learn自动为我们设置了一个阈值，并决定了我们的批准。如果您想查看实际的概率，我们可以使用Scikit Learn提供的另一个函数- <code class="fe mr ms mt mu b">predict_proba()</code>:</p><pre class="kg kh ki kj gt nj mu nk nl aw nm bi"><span id="b17f" class="mx lt iq mu b gy nn no l np nq">results_w_probs = fitted_model.predict_proba(test_X)</span><span id="0898" class="mx lt iq mu b gy ns no l np nq">print("Our approval results with their probabilites:")<br/><strong class="mu ir">for</strong> result <strong class="mu ir">in</strong> results_w_probs:<br/>    print(f"Probability not approved = <strong class="mu ir">{</strong>result[0]<strong class="mu ir">:</strong>.2f<strong class="mu ir">}</strong>, Probability approved = <strong class="mu ir">{</strong>result[1]<strong class="mu ir">:</strong>.2f<strong class="mu ir">}</strong>")</span></pre><blockquote class="nt nu nv"><p id="e23c" class="kw kx nr ky b kz la jr lb lc ld ju le nw lg lh li nx lk ll lm ny lo lp lq lr ij bi translated">我们的批准结果及其概率:<br/>不批准概率= 0.00，批准概率= 1.00 <br/>不批准概率= 0.28，批准概率= 0.72 <br/>不批准概率= 0.00，批准概率= 1.00 <br/>不批准概率= 0.84，批准概率= 0.16 <br/>不批准概率= 0.92，批准概率= 0.08 <br/>不批准概率= 0.99，批准概率= 0.01 【T8 通过概率= 0.00 <br/>未通过概率= 0.00，通过概率= 1.00 <br/>未通过概率= 0.00，通过概率= 1.00 <br/>未通过概率= 1.00，通过概率= 0.00 <br/>未通过概率= 1.00，通过概率= 0.00</p></blockquote><p id="790e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong>:1和0的概率列表与我们之前传递给<code class="fe mr ms mt mu b">predict_proba()</code>函数的初始numpy数组顺序相同。</p><p id="45b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们可以设置不同的阈值，根据概率提供不同数量的批准。如果要谨慎审批人，可以把门槛设成0.8或者0.9。如果治疗是安全的，非侵入性的，并且成本很低——我们可以将阈值降低到0.25或0.3。这完全取决于用例。</p><h1 id="235d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">后续步骤</h1><p id="29f4" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我希望你喜欢这个教程，并发现它很有用！如果你想让你的模型变得更好，下面是你应该考虑的一些后续步骤:</p><ul class=""><li id="3af4" class="nz oa iq ky b kz la lc ld lf ob lj oc ln od lr oe of og oh bi translated">查找并添加更多数据，无论是更多行数据还是新功能。</li><li id="6278" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated">测试不同的阈值。</li><li id="aafc" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated">了解分类指标。(Scikit Learn的<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html" rel="noopener ugc nofollow" target="_blank">分类报告</a>是一个很好的起点)</li><li id="e2e3" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated">针对对您的用例有意义的分类指标定制您的模型。准确性可能不是最好的衡量标准。(一个例子是当你的班级不平衡时)</li><li id="1273" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated">探索更复杂的模型，如XGBoost、LightGBM、SVM、神经网络等。</li></ul><h1 id="015e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">链接</h1><ul class=""><li id="e194" class="nz oa iq ky b kz mk lc ml lf on lj oo ln op lr oe of og oh bi translated"><a class="ae kv" href="https://github.com/frankiecancino/ML_Tutorials/blob/master/logistic_regression.ipynb" rel="noopener ugc nofollow" target="_blank">原Jupyter笔记本</a></li><li id="5c5f" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated"><a class="ae kv" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank">sci kit-学习文档</a></li><li id="c83b" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated"><a class="ae kv" href="https://www.linkedin.com/in/frankie-cancino/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="4c52" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated"><a class="ae kv" href="https://twitter.com/frankiecancino" rel="noopener ugc nofollow" target="_blank">推特</a></li></ul></div></div>    
</body>
</html>