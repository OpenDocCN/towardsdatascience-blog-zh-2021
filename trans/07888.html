<html>
<head>
<title>Benefits of Remote Entry with SSH</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SSH远程登录的优势</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/benefits-of-remote-entry-with-ssh-76acb72f918a?source=collection_archive---------33-----------------------#2021-07-19">https://towardsdatascience.com/benefits-of-remote-entry-with-ssh-76acb72f918a?source=collection_archive---------33-----------------------#2021-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c74c" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">快速教程</h2><div class=""/><div class=""><h2 id="28db" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用ssh-keygen保持您的动力</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/2ff57af48413b53bb509c3249e81584b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jrDIp-HOaTwbGg7P"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@gohrhyyan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Goh Rhy Yan </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b8cf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我所有的工作都是在远程计算机上完成的，这通常需要我在一天中多次输入密码。这个小任务是可以避免的。</p><p id="a284" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我将描述如何设置进入服务器的无钥匙进入，这样你就不必每次登录或<code class="fe me mf mg mh b">scp</code>文件时都输入密码。我还将描述如何在不输入密码的情况下通过bastion服务器远程复制文件，以及如何安排远程备份。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="cf41" class="mp mq it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">0.设置无钥匙进入</h1><p id="2d3d" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">在本地计算机上，使用以下命令创建RSA密钥:</p><pre class="ks kt ku kv gt nm mh nn no aw np bi"><span id="c5d8" class="nq mq it mh b gy nr ns l nt nu">ssh-keygen</span></pre><p id="ef4a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这将使用您的RSA密钥创建一个文件。默认位置是</p><pre class="ks kt ku kv gt nm mh nn no aw np bi"><span id="a4cc" class="nq mq it mh b gy nr ns l nt nu">~/.ssh/id_rsa</span></pre><p id="61f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将密钥复制到远程服务器上的<code class="fe me mf mg mh b">~/.ssh/authorized_keys</code>中:</p><pre class="ks kt ku kv gt nm mh nn no aw np bi"><span id="58db" class="nq mq it mh b gy nr ns l nt nu">ssh-copy-id user@remote.server</span></pre><p id="9eb4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在你可以不用密码进入<code class="fe me mf mg mh b">ssh</code>服务器了:</p><pre class="ks kt ku kv gt nm mh nn no aw np bi"><span id="33a1" class="nq mq it mh b gy nr ns l nt nu">ssh user@remote.server</span></pre><h2 id="6213" class="nq mq it bd mr nv nw dn mv nx ny dp mz lr nz oa nb lv ob oc nd lz od oe nf iz bi translated">如果我的远程服务器有一个堡垒主机怎么办？</h2><p id="6ebf" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">在这种情况下，您可以遵循与上面相同的步骤，将您的bastion服务器视为您的本地机器。</p><p id="58c2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，登录到您的堡垒服务器并创建一个RSA密钥。然后使用<code class="fe me mf mg mh b">ssh-copy-id</code>将其复制到您的远程服务器。最后，确认你可以用密码<code class="fe me mf mg mh b">ssh</code>进入远程服务器。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="17a8" class="mp mq it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">1.复制文件</h1><p id="1676" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">一旦设置了<code class="fe me mf mg mh b">ssh</code>键，你就可以在没有密码的情况下跨服务器传输文件。</p><h2 id="7898" class="nq mq it bd mr nv nw dn mv nx ny dp mz lr nz oa nb lv ob oc nd lz od oe nf iz bi translated">1.1从本地机器复制→远程服务器</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="54a1" class="nq mq it bd mr nv nw dn mv nx ny dp mz lr nz oa nb lv ob oc nd lz od oe nf iz bi translated">1.2从远程服务器复制→本地机器</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="62bf" class="mp mq it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">2.跨堡垒服务器移动文件</h1><p id="51af" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">您可以使用移动文件到远程服务器，即使您中间有一个堡垒节点。</p><p id="c14f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，确保使用<code class="fe me mf mg mh b">ssh-keygen</code>在堡垒服务器和远程服务器上设置了RSA密钥</p><h2 id="25e9" class="nq mq it bd mr nv nw dn mv nx ny dp mz lr nz oa nb lv ob oc nd lz od oe nf iz bi translated">2.1.从本地机器复制→远程服务器</h2><p id="490d" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">您可以使用<code class="fe me mf mg mh b">rsync</code>将文件从本地机器复制到远程服务器。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="4d3e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe me mf mg mh b">-e</code>标志执行其后的命令。它将首先<code class="fe me mf mg mh b">ssh</code>进入堡垒服务器，然后<code class="fe me mf mg mh b">ssh</code>进入远程服务器。</p><h2 id="a93c" class="nq mq it bd mr nv nw dn mv nx ny dp mz lr nz oa nb lv ob oc nd lz od oe nf iz bi translated">2.2从远程服务器复制→本地机器</h2><p id="2ef2" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">这将把文件从远程服务器复制到您的本地机器。再次绕过堡垒服务器。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="08d2" class="mp mq it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">2.远程备份</h1><p id="c38a" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">启用RSA密钥后，您可以使用cron作业每月无缝备份一个远程目录。这里有一个简单的例子。</p><p id="5e16" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，打开您的crontab:</p><pre class="ks kt ku kv gt nm mh nn no aw np bi"><span id="eaf6" class="nq mq it mh b gy nr ns l nt nu">crontab -e</span></pre><p id="7d17" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">并粘贴以下内容来安排远程备份</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="2f7a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这将在每月1日凌晨1:00将远程目录备份到您的本地计算机。</p><p id="f2fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe me mf mg mh b">rsync</code>标志是:</p><ul class=""><li id="7d70" class="oh oi it lk b ll lm lo lp lr oj lv ok lz ol md om on oo op bi translated"><code class="fe me mf mg mh b">-r</code> →递归备份源目录</li><li id="f8cc" class="oh oi it lk b ll oq lo or lr os lv ot lz ou md om on oo op bi translated"><code class="fe me mf mg mh b">-t</code> →保存文件上的时间戳</li></ul><p id="f6a9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你不熟悉cron jobs，我推荐以下视频</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov og l"/></div></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="a72e" class="mp mq it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">结论</h1><p id="7344" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">远程登录服务器的能力比无钥匙进入有更多的优势。您可以无缝地将文件移动到远程服务器，跨堡垒服务器传输数据，并安排在指定时间备份远程目录。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="59e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="ow">感谢您阅读和支持媒体作者</em></p><div class="ox oy gp gr oz pa"><a href="https://lukegloege.medium.com/membership" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd jd gy z fp pf fr fs pg fu fw jc bi translated">通过我的推荐链接加入Medium—Luke Gloege博士</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">lukegloege.medium.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po lb pa"/></div></div></a></div></div></div>    
</body>
</html>