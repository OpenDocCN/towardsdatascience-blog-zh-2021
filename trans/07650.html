<html>
<head>
<title>Basics of Donut charts with Python’s Matplotlib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的Matplotlib的圆环图基础</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/basics-of-donut-charts-with-pythons-matplotlib-100cf71b259d?source=collection_archive---------14-----------------------#2021-07-13">https://towardsdatascience.com/basics-of-donut-charts-with-pythons-matplotlib-100cf71b259d?source=collection_archive---------14-----------------------#2021-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a58f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Matplotlib绘制甜甜圈的不同方法快速指南</h2></div><p id="2d30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与饼状图有许多相似之处，这种创造性的可视化使其区别于其声名狼藉的表亲。开放的中心使切片看起来像条形，并将比较的焦点从面积和角度改变为长度。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/3f5d8b266b8f13ab16f309a05775be22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pVJxIMeGzcxTHofhGz4klw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">甜甜圈和圆形进度条——作者图片</p></figure><p id="fbcf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将检查用Matplolib绘制环形图的两种方法。一种简单的方法是使用饼图和参数楔形图，另一种更复杂的方法是使用极轴和水平条形图。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="b87e" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">图片兴趣探测调查</h2><p id="d59a" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在Matplotlib中没有绘制环形图的方法，但是我们可以使用wedgeprops快速转换饼图。</p><p id="0494" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从一个简单的馅饼开始。</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="f562" class="mb mc it na b gy ne nf l ng nh">import matplotlib.pyplot as plt</span><span id="f6d5" class="mb mc it na b gy ni nf l ng nh">plt.pie([87,13], startangle=90, colors=['#5DADE2', '#515A5A'])</span><span id="b308" class="mb mc it na b gy ni nf l ng nh">plt.show()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/812074fdd7636fc398bbdaee5fa672c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*g7hB9zkfqn0Q9rmq9rw0Yg.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">饼图—作者图片</p></figure><p id="68c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以添加参数wedgeprops并定义边缘的宽度，其中一个意味着边界将一直延伸到中心。</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="73a2" class="mb mc it na b gy ne nf l ng nh">fig, ax = plt.subplots(figsize=(6, 6))<br/> <br/>ax.pie([87,13], <br/>       wedgeprops={'width':0.3}, <br/>       startangle=90, <br/>       colors=['#5DADE2', '#515A5A'])</span><span id="a9dc" class="mb mc it na b gy ni nf l ng nh">plt.show()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/48f8992be0344b52f6e8294cb96549e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*QEGpJeIOCrpDzsKBbL-bJw.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">甜甜圈——作者图片</p></figure><p id="15ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这很简单。现在我们可以利用中心的空间让我们的数据更加明显。</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="2cab" class="mb mc it na b gy ne nf l ng nh">fig, ax = plt.subplots(figsize=(6, 6))</span><span id="f441" class="mb mc it na b gy ni nf l ng nh">wedgeprops = {'width':0.3, 'edgecolor':'black', 'linewidth':3}</span><span id="dd7f" class="mb mc it na b gy ni nf l ng nh">ax.pie([87,13], wedgeprops=wedgeprops, startangle=90, colors=['#5DADE2', '#515A5A'])</span><span id="c1cd" class="mb mc it na b gy ni nf l ng nh">plt.title('Worldwide Access to Electricity', fontsize=24, loc='left')</span><span id="15ef" class="mb mc it na b gy ni nf l ng nh">plt.text(0, 0, "87%", ha='center', va='center', fontsize=42)<br/>plt.text(-1.2, -1.2, "Source: ourworldindata.org/energy-access", ha='left', va='center', fontsize=12)</span><span id="509a" class="mb mc it na b gy ni nf l ng nh">plt.show()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/69f2cef1d88a208a7a2b29fbef04d366.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*Sj-Toe-7pmXzI778uSGCew.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">带细节的圆环图—图片由作者提供</p></figure><p id="5421" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们要显示简单的比较或比例时，圆环图特别有用。在我看来，使用它们的最佳方式就像一个圆形进度条，比如我们突出显示单一比例的例子。</p><p id="5c7e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这些情况下，我们可以进一步简化图表。</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="0da5" class="mb mc it na b gy ne nf l ng nh">fig, ax = plt.subplots(figsize=(6, 6))</span><span id="f678" class="mb mc it na b gy ni nf l ng nh">data = [87, 13]<br/>wedgeprops = {'width':0.3, 'edgecolor':'black', 'lw':3}<br/>patches, _ = ax.pie(data, wedgeprops=wedgeprops, startangle=90, colors=['#5DADE2', 'white'])</span><span id="2106" class="mb mc it na b gy ni nf l ng nh">patches[1].set_zorder(0)<br/>patches[1].set_edgecolor('white')</span><span id="ec30" class="mb mc it na b gy ni nf l ng nh">plt.title('Worldwide Access to Electricity', fontsize=24, loc='left')<br/>plt.text(0, 0, f"{data[0]}%", ha='center', va='center', fontsize=42)<br/>plt.text(-1.2, -1.3, "Source: ourworldindata.org/energy-access", ha='left', va='top', fontsize=12)</span><span id="645e" class="mb mc it na b gy ni nf l ng nh">plt.show()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7d0e6e7a5f6ca07f7a876b12205a5e1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*GJ4wblUOp2mNy8qn72ciKA.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">圆形进度条—作者图片</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="73d4" class="mb mc it bd md me mf dn mg mh mi dp mj kr mk ml mm kv mn mo mp kz mq mr ms mt bi translated">酒吧</h2><p id="e8a5" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">尽管这个解决方案比前一个更复杂，但它提供了一些令人兴奋的定制选项。</p><p id="e11a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">先说简单的。</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="841b" class="mb mc it na b gy ne nf l ng nh">from math import pi</span><span id="6c8c" class="mb mc it na b gy ni nf l ng nh">fig, ax = plt.subplots(figsize=(6, 6), subplot_kw={'projection':'polar'})</span><span id="1580" class="mb mc it na b gy ni nf l ng nh">data = 87 <br/>startangle = 90</span><span id="b396" class="mb mc it na b gy ni nf l ng nh">x = (data * pi *2)/ 100 # convert x data from percentage<br/>left = (startangle * pi *2)/ 360 # convert start from angle</span><span id="8c90" class="mb mc it na b gy ni nf l ng nh">ax.barh(1, x, left=left, height=1, color='#5DADE2')<br/>plt.ylim(-3, 3)</span><span id="6f85" class="mb mc it na b gy ni nf l ng nh">plt.show()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/49bd956358169b6e0b1f7ff0a24eefaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*51alg2dMAtVF0x7Hue5HXg.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">极轴中的水平条-作者图片</p></figure><p id="a4fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你大概能明白为什么这更复杂了。</p><p id="419f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们从角度出发。因此，我们必须在将每个元素添加到轴之前转换其x位置。</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="aeb7" class="mb mc it na b gy ne nf l ng nh">from math import pi</span><span id="919f" class="mb mc it na b gy ni nf l ng nh">fig, ax = plt.subplots(figsize=(6, 6), subplot_kw={'projection':'polar'})</span><span id="dc8c" class="mb mc it na b gy ni nf l ng nh">data = 87<br/>startangle = 90</span><span id="f763" class="mb mc it na b gy ni nf l ng nh">x = (data * pi *2)/ 100<br/>left = (startangle * pi *2)/ 360 #this is to control where the bar starts</span><span id="a539" class="mb mc it na b gy ni nf l ng nh">plt.xticks([])<br/>plt.yticks([])<br/>ax.spines.clear()</span><span id="282b" class="mb mc it na b gy ni nf l ng nh">ax.barh(1, x, left=left, height=1, color='#5DADE2') <br/>plt.ylim(-3, 3)</span><span id="836e" class="mb mc it na b gy ni nf l ng nh">plt.text(0, -3, "87%", ha='center', va='center', fontsize=42)</span><span id="7970" class="mb mc it na b gy ni nf l ng nh">plt.show()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi no"><img src="../Images/94221fe7c91b9b2a574229a3c74cad42.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*fpCPyUUPDr221nnHbOos-g.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">圆形进度条—作者图片</p></figure><p id="47cd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用这种方法时，您有更多的选择；更容易添加多个进度条，定义它们之间的距离，并向可视化添加细节。</p><p id="1c42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一方面，文本的定位会变得很棘手。</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="9d5f" class="mb mc it na b gy ne nf l ng nh">from math import pi<br/>import numpy as np<br/>from matplotlib.patches import Patch<br/>from matplotlib.lines import Line2D</span><span id="56cd" class="mb mc it na b gy ni nf l ng nh">fig, ax = plt.subplots(figsize=(6, 6))</span><span id="1246" class="mb mc it na b gy ni nf l ng nh">ax = plt.subplot(projection='polar')</span><span id="44d6" class="mb mc it na b gy ni nf l ng nh">data = [82, 75, 91]<br/>startangle = 90<br/>colors = ['#4393E5', '#43BAE5', '#7AE6EA']</span><span id="db20" class="mb mc it na b gy ni nf l ng nh">xs = [(i * pi *2)/ 100 for i in data]<br/>ys = [-0.2, 1, 2.2]<br/>left = (startangle * pi *2)/ 360 #this is to control where the bar starts</span><span id="f255" class="mb mc it na b gy ni nf l ng nh"># plot bars and points at the end to make them round<br/>for i, x in enumerate(xs):<br/>    ax.barh(ys[i], x, left=left, height=1, color=colors[i])<br/>    ax.scatter(x+left, ys[i], s=350, color=colors[i], zorder=2)<br/>    ax.scatter(left, ys[i], s=350, color=colors[i], zorder=2)<br/>    <br/>plt.ylim(-4, 4)</span><span id="a131" class="mb mc it na b gy ni nf l ng nh"># legend<br/>legend_elements = [Line2D([0], [0], marker='o', color='w', label='Group A', markerfacecolor='#4393E5', markersize=10),<br/>                  Line2D([0], [0], marker='o', color='w', label='Group B', markerfacecolor='#43BAE5', markersize=10),<br/>                  Line2D([0], [0], marker='o', color='w', label='Group C', markerfacecolor='#7AE6EA', markersize=10)]<br/>ax.legend(handles=legend_elements, loc='center', frameon=False)</span><span id="e4de" class="mb mc it na b gy ni nf l ng nh"># clear ticks, grids, spines<br/>plt.xticks([])<br/>plt.yticks([])<br/>ax.spines.clear()</span><span id="23c0" class="mb mc it na b gy ni nf l ng nh">plt.show()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi np"><img src="../Images/2f6f0649a68e934603f8a3330553708e.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*iIZM_4Z0s6gUMYpuZiZayA.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">多个进度条—作者图片</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="6b13" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">楔形区的width属性是一个简单的参数，它可以使任何饼图更加激动人心，可读性更好。</p><p id="1acd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有其他选项来绘制这种可视化效果也很棒。我看过另一个教程，他们展示了如何在饼图的中心画一个白色的圆圈，将它变成一个甜甜圈，这表明了如何通过数据可视化来获得创意。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="29c0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读我的文章！— <a class="ae nq" href="https://linktr.ee/admin/settings#Settings--SocialLinks" rel="noopener ugc nofollow" target="_blank">更多Python DataViz教程</a>。</p><p id="8de2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">资源:</strong><br/>T3】MPL派；<br/> <a class="ae nq" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Wedge.html" rel="noopener ugc nofollow" target="_blank"> MPL楔形</a>；<br/> <a class="ae nq" href="https://matplotlib.org/stable/gallery/pie_and_polar_charts/polar_demo.html" rel="noopener ugc nofollow" target="_blank"> MPL极坐标散点示例</a>；<br/><a class="ae nq" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.barh.html" rel="noopener ugc nofollow" target="_blank">MPL Barh</a>；</p></div></div>    
</body>
</html>