<html>
<head>
<title>Automate Your Excel Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python自动化您的Excel</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-your-excel-using-python-91a7217e7e44?source=collection_archive---------25-----------------------#2021-06-09">https://towardsdatascience.com/automate-your-excel-using-python-91a7217e7e44?source=collection_archive---------25-----------------------#2021-06-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="270b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从手动到自动化的方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d51b3d86df8c95feabc3b08a9a5a350e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OHkFUSObjeBBtD6axRdTnw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://www.pexels.com/@alexasfotos?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kz"> Alexas Fotos </strong> </a>来自<a class="ae ky" href="https://www.pexels.com/photo/time-for-change-sign-with-led-light-2277784/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kz"> Pexels </strong> </a></p></figure><p id="c036" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">Python是一种令人惊叹的编程语言。更容易学习和适应。python中的错误消息是不言自明的。我们不需要花时间去寻找错误信息的解决方案。这就是我喜欢这种编程语言的原因。</p><p id="4312" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我觉得这应该是最理想的编程语言。编程语言的目标应该是帮助我们构建令人兴奋的产品，而不是浪费时间解决错误。</p><p id="79fc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">最近，我学习了使用python自动化excel任务。我想与更多的观众分享这些惊人的技巧。这种自动化策略使用python编程。好的一面是python代码的每一行都是自我解释的，你不需要谷歌任何东西。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="3c5a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">您可以使用自己选择的代码编辑器。在本文中，我将使用Jupyter笔记本进行演示。</p><h1 id="448e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">安装所需的库</h1><p id="04d4" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">我们需要安装一个python库，<code class="fe na nb nc nd b">openpyxl</code>。在命令提示符下键入以下命令。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="84c7" class="ni me it nd b gy nj nk l nl nm">pip install openpyxl</span></pre><h1 id="75bf" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">加载现有工作簿</h1><p id="d70e" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">如果您有一个现有的excel工作簿，并且您想从特定的工作表中读取数据或修改任何工作表中的数据,<code class="fe na nb nc nd b">openpyxl</code>提供了一个名为<code class="fe na nb nc nd b">load_workbook()</code>的函数，可以如下使用。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="7ec8" class="ni me it nd b gy nj nk l nl nm">from openpyxl import Workbook, load_workbook</span><span id="f2a8" class="ni me it nd b gy nn nk l nl nm">wb = load_workbook('my_demo_sheet.xlsx')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/3bc4bee0cc55d83559c5131b653d893d.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*nxv5UAdPTlTdqwrRVfNN5Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">演示工作表</p></figure><h1 id="fcae" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">访问工作表</h1><p id="41f4" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">如果要访问活动工作表中的内容。那么workbook有一个名为<code class="fe na nb nc nd b">active</code>的属性，它可以帮助我们指向活动工作表。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="0fcc" class="ni me it nd b gy nj nk l nl nm">ws = wb.active<br/>print(ws)</span></pre><p id="d2cc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">但是，如果你想指向任何其他工作表，那么我们可以这样做。在这里，我从我的excel表中访问<code class="fe na nb nc nd b">sheet2</code>。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="bcb9" class="ni me it nd b gy nj nk l nl nm">ws = wb["Sheet2"]</span></pre><h1 id="0f24" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">访问单元格值</h1><p id="d1fa" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">一旦我们定义了工作表，我们就可以引用工作表中的任何单元格。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="b1f0" class="ni me it nd b gy nj nk l nl nm">cell_to_access= ws['A5']</span></pre><p id="778e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了获得单元格的值，我们必须使用<code class="fe na nb nc nd b">value </code>属性。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="8834" class="ni me it nd b gy nj nk l nl nm">cell_value = ws['A5']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/cd9a119f455f2826e890df56c9a67b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*ODDCPXmHAfV-Ti1ikqRlwQ.png"/></div></figure><h1 id="3bf2" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">更改单元格的值</h1><p id="3e6e" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">我们可以使用下面一行代码来更改excel表格中的任何值。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="0a33" class="ni me it nd b gy nj nk l nl nm">ws['B1'].value="Second Tab"</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/988efd9ddad7909f6165e58e91b35a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*u4DkojvNA_DWCRmYik2AUg.png"/></div></figure><p id="356a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们还需要保存更改，如下所示。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="affd" class="ni me it nd b gy nj nk l nl nm">wb.save("my_demo_sheet.xlsx")</span></pre><h1 id="724d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">获取工作表名称</h1><p id="a76f" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">如果您想知道工作簿中可用工作表的名称，您可以使用下面的python代码行来获取列表形式的工作表名称。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="2b1b" class="ni me it nd b gy nj nk l nl nm">print(wb.sheetnames)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/b22fa7dfcce86c91b66b47423cc02bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*cZA1HUgZtKnuAcj-okLoog.png"/></div></figure><h1 id="528f" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">访问其他工作表</h1><p id="3999" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">使用<code class="fe na nb nc nd b">.active</code>属性，我们可以访问默认的活动工作表。如果您想访问另一个表，即摘要，我们可以如下操作。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="3539" class="ni me it nd b gy nj nk l nl nm">ws = wb["summary"]</span></pre><h1 id="c5df" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">创建新工作表</h1><p id="890b" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">要在同一个excel工作簿中创建一个新的工作表，我们可以使用如下所示的<code class="fe na nb nc nd b">create_sheet()</code>。当我们修改工作表时，我们需要保存工作簿以将更改应用到excel工作簿。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="bb20" class="ni me it nd b gy nj nk l nl nm">wb.create_sheet("Index_sheet")<br/>wb.save("test1.xlsx")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d275f38e1714d5a604ef4b88003548ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*zv_rVd_ahPv4zSjlf6qj3g.png"/></div></figure><h1 id="a542" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">创建新工作簿</h1><p id="7d92" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">创建新的Excel工作簿非常简单。我们需要调用函数<code class="fe na nb nc nd b">Workbook()</code>。由于这是一个新工作簿，我们需要将该工作表设置为默认工作表。我们还可以使用<code class="fe na nb nc nd b">title</code>属性更改工作表的名称。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="03d6" class="ni me it nd b gy nj nk l nl nm">wb = Workbook()</span></pre><p id="43c0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">定义默认工作表。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="9f31" class="ni me it nd b gy nj nk l nl nm">ws = wb.active<br/>ws.title = "Demo_data"</span></pre><h1 id="642d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">向工作表添加数据</h1><p id="c597" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">一旦我们定义了工作表，我们就可以使用<code class="fe na nb nc nd b">append</code>函数添加数据。这将按行添加数据。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="100d" class="ni me it nd b gy nj nk l nl nm">ws.append(["This","Is", "A", "Header"])<br/>ws.save("New_WB.xlsx")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/0775f34ba2ab7823215a4d7e05cf47c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*WxHM3L97kee_MvdYIQDYwQ.png"/></div></figure><h1 id="59b5" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">添加新行</h1><p id="91c7" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">我们可以使用<code class="fe na nb nc nd b">insert_rows()</code>来添加任意数量的行。该函数将row_number作为输入。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="b30c" class="ni me it nd b gy nj nk l nl nm">for i in range(2):<br/>    ws.insert_rows(row_num)</span></pre><h1 id="c650" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">删除行</h1><p id="962f" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">我们可以使用<code class="fe na nb nc nd b">delete_rows()</code>功能删除任何一行。该函数将column_number作为输入。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="557e" class="ni me it nd b gy nj nk l nl nm">for i in range(3):<br/>   ws.delete_rows(col_num)</span></pre><h1 id="e32e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">添加新列</h1><p id="b805" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">如果你想插入任何列，那么<code class="fe na nb nc nd b">insert_cols()</code>功能可以使用循环添加任何列。该函数将column_number作为输入。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="ae35" class="ni me it nd b gy nj nk l nl nm">ws.insert_cols(column_number)</span></pre><h1 id="5bef" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">删除列</h1><p id="a6c2" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">要删除任何列，可以使用以列号为输入的<code class="fe na nb nc nd b">delete_cols()</code>函数。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="845e" class="ni me it nd b gy nj nk l nl nm">ws.delete_cols(column_number)</span></pre><h1 id="e073" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">在excel表中移动数据</h1><p id="246c" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">假设您有一个包含数据的excel表，并且您想要将行或列的任何部分移动到另一个位置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/8c1296738ea39b722814117aafdb0d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*KkJe91VGq3RiGSImUB24QQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">移动前</p></figure><p id="e452" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们可以使用<code class="fe na nb nc nd b">move_range()</code>来移动我们的数据。该函数有三个参数—选定的数据、要移动的行数(+N，-N)和要移动的列数(+N，-N)。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="59ef" class="ni me it nd b gy nj nk l nl nm">ws.move_range("B2:D9", rows=0, cols=2 )</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/1f6ecd40eb042188c2b8b92e8f82154e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*7aJYY2GTyXhe5VxlfM9yOA.png"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="145f" class="md me it bd mf mg nw mi mj mk nx mm mn jz ny ka mp kc nz kd mr kf oa kg mt mu bi translated">结论</h1><p id="2a85" class="pw-post-body-paragraph la lb it lc b ld mv ju lf lg mw jx li lj mx ll lm ln my lp lq lr mz lt lu lv im bi translated">本文到此为止。我们已经介绍了自动化excel任务的不同场景。这些任务也可以在excel中手动完成。但是，如果有一些重复的场景，您可以根据您的要求在这个自动化策略上投入一些时间，以节省您的日常时间。</p><p id="37be" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我希望你喜欢这篇文章。谢谢你的阅读！</p><p id="cd02" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">以下是我的一些最佳选择:</p><div class="ob oc gp gr od oe"><a href="https://levelup.gitconnected.com/six-ultimate-daily-hacks-for-every-programmer-60f5f10feae" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">每个程序员的15个终极日常技巧</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">打印“hello world”不需要导入TensorFlow</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="on l"><div class="oo l op oq or on os ks oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a href="https://betterprogramming.pub/how-a-single-mistake-wasted-3-years-of-my-data-science-journey-b7ca1e962085" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">一个错误如何浪费了我3年的数据科学之旅</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">自定进度的课程只是安眠药；行业专家是正确的选择</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">better编程. pub</p></div></div><div class="on l"><div class="ot l op oq or on os ks oe"/></div></div></a></div></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><blockquote class="ou ov ow"><p id="2136" class="la lb ox lc b ld le ju lf lg lh jx li oy lk ll lm oz lo lp lq pa ls lt lu lv im bi translated"><em class="it">走之前……</em></p></blockquote><p id="8394" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你喜欢这篇文章，并且想继续关注更多关于<strong class="lc iu"> Python &amp;数据科学</strong>的<strong class="lc iu">精彩文章</strong>——请点击这里<a class="ae ky" href="https://pranjalai.medium.com/membership" rel="noopener">https://pranjalai.medium.com/membership</a>考虑成为一名中级会员。</p><p id="3d59" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">请考虑使用<a class="ae ky" href="https://pranjalai.medium.com/membership" rel="noopener">我的推荐链接</a>注册。通过这种方式，会员费的一部分归我，这激励我写更多关于Python和数据科学的令人兴奋的东西。</p><p id="9cdc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">还有，可以随时订阅我的免费简讯:<a class="ae ky" href="https://pranjalai.medium.com/subscribe" rel="noopener"> <strong class="lc iu">普朗加尔的简讯</strong> </a>。</p></div></div>    
</body>
</html>