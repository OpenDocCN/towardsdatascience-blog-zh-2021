<html>
<head>
<title>A tale of two models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">两个模特的故事</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-tale-of-two-models-6c0c7a14d1c9?source=collection_archive---------44-----------------------#2021-07-26">https://towardsdatascience.com/a-tale-of-two-models-6c0c7a14d1c9?source=collection_archive---------44-----------------------#2021-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f77d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">语言课程:我们如何构建决定通话目的的人工智能模型</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/802ae1eef470f030d9d832aa9dc30892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rYMhS0UhenuMbV9-BizIXg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由拨号盘提供。</p></figure><p id="1241" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Dialpad的ASR和NLP团队在不断创新。事实上，我们最近推出了一项新功能，利用人工智能的力量来检测呼叫的目的，以便客户可以更好地了解常见的交互模式，并从这些模式中提取可操作的见解。</p><p id="029e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，正如我们所发现的，打电话并不像看起来那么简单。查看我们关于<a class="ae ls" href="https://www.dialpad.com/blog/call-purpose-ch-1/" rel="noopener ugc nofollow" target="_blank">为什么我们建造这个</a>和<a class="ae ls" href="https://www.dialpad.com/blog/call-purpose-data-deep-dive/" rel="noopener ugc nofollow" target="_blank">的其他文章，我们查看了</a>的数据以获得额外的背景。在这篇文章中，我们将深入研究我们为这一特定功能开发的两个人工智能模型，包括我们看到的成功和我们克服的挑战。</p><h1 id="b8b2" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">更简单的基于规则的模型</h1><p id="ea10" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">首先，根据我们对数据的洞察(参见上面提到的<a class="ae ls" href="https://www.dialpad.com/blog/call-purpose-data-deep-dive/" rel="noopener ugc nofollow" target="_blank">博客</a>，我们构建了一个简单的基于规则或启发式的模型，仅用了几周时间就投入生产。由于Dialpad为许多行业的许多企业提供服务，我们不能依赖基于呼叫主题的模型，这种模型经过培训可以识别吸尘器维修的所有方面，对于安排采访或收集教育产品的反馈几乎没有用处。</p><p id="2bb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们必须找到更通用的东西。</p><p id="24d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们训练模型要看的一些东西:</p><ul class=""><li id="0f22" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">特定词汇模式的存在或缺失，这些模式通常出现在呼叫语句的目的中，例如“呼叫是因为”或“呼叫的原因”</li><li id="ed4a" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">围绕文本上下文——看看之前说了什么，问了什么问题</li><li id="c575" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">时间线索—多注意通话的某些部分，如通话的开始或客户帐户验证后的通话部分。</li><li id="8325" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">扬声器类别—确定扬声器是发出呼叫的人还是正在接收呼叫的人</li></ul><p id="0a6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在处理模糊会话数据时，该模型必须考虑词汇和结构的可变性，容忍语音识别错误，并处理口语的特性，如不完整的句子和填充词的大量使用。</p><p id="cb72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们决定首先建立一个简单的模型，原因有两个——在投入更多时间之前衡量客户对该功能的兴趣，以及为有监督的机器学习模型廉价地收集训练数据集。</p><p id="a870" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如每一位经验丰富的机器学习科学家可以证明的那样，建立一个好的人工智能模型的关键是好的数据。但是组装高质量数据集的成本和劳动可能令人望而生畏。对于这种模式，它将涉及到检查整个通话记录，其中许多很长，有些包含转录错误，并确定通话目的的陈述点。</p><p id="b78d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这需要几个月的时间，而且收集起来相当繁琐。</p><p id="a78e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是我们的顾客很感兴趣！他们希望这种能力能够检测通话的目的。</p><p id="5720" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们开始构建一个更强大的模型(功能开发的下一阶段)。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/db5549ce8ac09acb35dd4aa0f8f62fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n7smcJAFNN-BNqezZs9VdQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由拨号盘提供。</p></figure><h1 id="4cb1" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">深度学习模型</h1><p id="68d0" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">启发式模型精确度高，但召回率低，这意味着它没有像我们希望的那样频繁启动——但当它启动时，它非常准确。这实际上是启发式模型的一个常见问题，因为规则是相当生硬、不灵活的工具，不可能解释进行预测时令人眼花缭乱的变量数量。</p><p id="1e8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，一个只关注于呼叫开始时检测呼叫目的的规则将错过在呼叫的很晚时候才陈述呼叫目的的时间，而一个关注于匹配陈述的规则将错过呼叫目的作为问题出现的情况。</p><p id="4da7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">启发式模型也很难维护，因为组成模型的规则需要定期更新，例如当模型使用的数据在内容或结构上发生变化时。但是由于其有限的范围，基于规则的模型对于最明显的情况来说是相当准确的，并且运行起来很便宜。</p><p id="760f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种设置实际上证明了它非常能够生成标记为通话目的陈述的通话记录部分的丰富训练数据集，并由一个人在循环中验证数据子集以确保质量。</p><p id="ec48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，用基于规则的模型所遗漏的语言模式来扩充数据集。现在，我们可以用它来训练一个深度学习模型，该模型根据话语表达呼叫目的的可能性来评分。</p><p id="92b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以前的模型是做出一个<em class="nf">二元</em>决策，即命中或未命中，而这一新的概率评分模型能够找到最具信息性的通话目的陈述，一旦更好地代表对话的话语进入系统，该陈述就会实时更新。</p><p id="0751" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，在对话开始时出现的以下话语是有效的呼叫目的:</p><p id="8286" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nf">你好。是的，我想和经理谈谈最近的交货问题。</em></p><p id="3c9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，新模型能够捕捉到随后出现的更具信息性的通话目的:</p><p id="bdb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我会解释我打电话的原因。上周，我接到通知，我订购的自行车X-5型号将于周二交付，我不得不呆在家里接受交付。我不得不请了一天假，等了一整天，但是没有发生。这辆自行车本周四才到，包装破损，到处都是划痕。我想在这个问题上得到帮助。</p><p id="7834" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以前的模型面临的另一个挑战是检测<em class="nf">隐式声明的</em>调用目的。例如，您能猜出“<em class="nf">似乎无法登录</em>”是客户打电话的<em class="nf">原因</em>还是解决另一个更大问题的<em class="nf">步骤</em>吗？</p><p id="1b82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">确定这一点的规则将过于复杂和不灵活，但深度学习模型能够从数据中学习这些细微差别，并相应地对话语进行评分。</p><p id="8bbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，这种设置有其自身的弱点:深度学习模型非常消耗资源，运行起来非常耗时。为了减少负载，我们开发了简单的规则来过滤提供给深度学习模型的数据，这样它就不必在对话的每个部分都运行<em class="nf">。这种过滤机制使得模型快速有效。</em></p><p id="5a7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种混合模型目前正在生产中，具有高精度和高召回率，能够捕获更广泛的呼叫目的陈述，更少地依赖于抄本的质量，并且比基于规则的模型更容易维护，因为它无缝地适应变化的数据。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/697c091d4e9f88afe54770e2cd847d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQAe6FyWEiOIKw75ghDkgg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由拨号盘提供。</p></figure><h1 id="d8dd" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">简洁明了</h1><p id="cd4b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">通话目的陈述，尤其是在通话的早期说出，也可能有其他目的:问候、建立联系、寒暄、确保技术正常工作(你能听到我吗？！)，使通话目的难以识别。因此，我们精心设计了一些规则来剔除这些陈述中的错误。曾经是这样的陈述:</p><p id="ac0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很好，谢谢。下午好。我是带拨号盘的本杰明。是的，我能听见你。我正在联系我们的新产品报价。现在打电话合适吗？</p><p id="6df6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在就像<em class="nf">一样简单:“我正在联系我们的新产品报价。”</em></p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="c795" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特别感谢我的同事Elena Khasanova。</p></div></div>    
</body>
</html>