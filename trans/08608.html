<html>
<head>
<title>Hessian Matrix and Optimization Problems in Python 3.8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 3.8中的Hessian矩阵和优化问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hessian-matrix-and-optimization-problems-in-python-3-8-f7cd2a615371?source=collection_archive---------6-----------------------#2021-08-09">https://towardsdatascience.com/hessian-matrix-and-optimization-problems-in-python-3-8-f7cd2a615371?source=collection_archive---------6-----------------------#2021-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="338c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在没有TensorFlow或PyTorch的情况下执行经济优化</h2></div><p id="b164" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">建议</strong></p><p id="21a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与Python 3.8的兼容性测试，在MacOS 11.3和Linux Ubuntu Server 20.04 LTS环境下执行。</p><p id="a862" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用的库:Numpy，Sympy。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="2796" class="lk ll iq lg b gy lm ln l lo lp">pip3.8 install numpy sympy</span></pre><p id="ec85" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Hessian矩阵用于牛顿型方法中的大规模优化问题，因为它们是函数的局部泰勒展开的二次项的系数。偏导数在经济学中扮演着重要的角色，在经济学中，大多数描述经济行为的函数都假设经济行为取决于不止一个变量。例如，一个社会消费函数可以描述消费商品的花费取决于收入和财富；边际消费倾向就是消费函数相对于收入的偏导数。</p><p id="2f76" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Hessian矩阵也通常用于在图像处理和计算机视觉中表达图像处理算子(参见高斯拉普拉斯(LoG)斑点检测器)。海森矩阵也可以用于正常模式分析，以计算红外光谱中不同的分子频率。</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lq"><img src="../Images/4d0395bf14a13a91dae8557c52f7293c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RhWPJyYuWCNlPqgq"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">由<a class="ae mc" href="https://unsplash.com/@christoffere?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">christofer engstrm</a>在<a class="ae mc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e67a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数值函数的Hessian矩阵是其二阶偏导数的方阵，记为H(f)。在数学中，多变量函数的偏导数是它对其中一个变量的导数，其他变量保持不变。</p><p id="92b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">示例:</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi md"><img src="../Images/44e2c1924ab419a0bdaf141ef35cb411.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*J_NjiS3nBk7SAEP9jDUfmA.png"/></div></div></figure><figure class="lb lc ld le gt lr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/56d72440005c02939adb4a4417c16c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*ZjejZHkjJ6AwKkVTqSMBcw.png"/></div></figure><p id="d29d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">梯度向量可以解释为“最快增加的方向和速率”。</p><figure class="lb lc ld le gt lr"><div class="bz fp l di"><div class="mf mg l"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">如何用sympy求偏导数？</p></figure><p id="25b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果函数的梯度在点<em class="mh"> p </em>不为零，梯度的方向就是函数从<em class="mh"> p </em>增加最快的方向，梯度的大小就是那个方向的增加率，最大的绝对方向导数。</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/bef10cca3de884146d5ed6bf7341d6eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*ojmFgZ1LRfFDczGCesBy4g.png"/></div></figure><p id="6f5b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在有序集合E中，部分A的一个元素是A的最大元素或最大值，如果它属于A并且大于A的任何其他元素。对于有序集合的任何部分，最大值的存在通常是不确定的。另一方面，在存在条件下，这样的元素是唯一的。类似地，最小元素或最小值(如果存在的话)是比的任何其他元素都小的的元素。</p><p id="5852" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">目标是通过求解以下方程来确定最大或最小候选值:</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/a33b963e08909b7cd8e75712702ce93a.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*4qrs4wSInWkQGMwUyCyU0Q.png"/></div></figure><p id="7b16" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Python 3.8中的实现非常简单，需要Sympy库中的“solve”函数。</p><figure class="lb lc ld le gt lr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="0dda" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们需要执行二阶导数来获得hessian矩阵:</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mk"><img src="../Images/ca5178f6a150d9f0c5e07046aa47c897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAcW_HdyhvFlCmztSb5i5w.png"/></div></div></figure><p id="212b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">顺便说一下，这是程序的主要功能，它仲裁所有指令块之间的变量分配:</p><figure class="lb lc ld le gt lr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="87aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的程序中，我们将施瓦兹定理应用于多变量函数的二阶偏导数，使得:</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi ml"><img src="../Images/1afa54680017b90b85cd023258f0f24d.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*PM5fLbZQr2WDqIzlLsRWuw.png"/></div></div></figure><p id="0450" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，我们不会证明这个定理，也不会试图在本文中解释它。下面是一个numpy.matrix格式的hessian矩阵示例，用于函数:</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/35447d432e28e4c0e06e0574ed37a4dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*x0BqAefRjJhpsC5YM4PwQQ.png"/></div></figure><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="6a06" class="lk ll iq lg b gy lm ln l lo lp">Hessian matrix that organizes all the second partial derivatives of the function x**2–1.5*x*y + y**2 is : <br/>[[2 -1.50000000000000]<br/>[-1.50000000000000 2]]</span><span id="609a" class="lk ll iq lg b gy mn ln l lo lp">Determinant in the critical point {x: 0.0, y: 0.0} is : 1.75000000000000</span></pre><p id="7009" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">行列式是一个标量值，它是一个方阵的元素的函数。</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mo"><img src="../Images/53b9adf14a999c27fc035e4a3020bce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axgeB1YqNRvDweHh7aHpZQ.png"/></div></div></figure><p id="7f94" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它允许表征矩阵和由矩阵表示的线性映射的一些属性。特别地，行列式非零当且仅当矩阵可逆，且矩阵所表示的线性映射是同构的。</p><figure class="lb lc ld le gt lr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="6157" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，对于正半定和负半定Hessian，该测试是不确定的(Hessian半定但不确定的临界点可能是局部极值或鞍点)。</p><figure class="lb lc ld le gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mp"><img src="../Images/b4aaf135c34542270e33e83e65a183ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vTZf2PQKYf7KCU0pfeVP2g.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">图片由Louis Brulé Naudet提供。</p></figure><p id="e553" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的例子中，对于临界点(0；0)，行列式为1.75 &gt; 0，f'xx &gt; 0，那么，临界点是一个局部极小值，所以函数是严格凸的。</p><blockquote class="mq mr ms"><p id="336b" class="kf kg mh kh b ki kj jr kk kl km ju kn mt kp kq kr mu kt ku kv mv kx ky kz la ij bi translated">Tensorflow或其他机器学习库无疑是强大的，但它们仍然过度消耗资源，并且可能成为低性能机器的障碍，本文旨在解释一种构建Hessian矩阵的新方法，使用一种更轻便的科学计算工具:sympy。</p></blockquote><p id="e558" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Louis Brulé Naudet拥有巴黎萨克莱大学的法律和经济学/管理学双学位。</p><div class="mw mx gp gr my mz"><a href="https://louisbrulenaudet.com" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">路易·布鲁莱·诺代</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">Clover和Lemone共同基金会，商务和财政法专业，程序设计界面概念…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">louisbrulenaudet.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn lw mz"/></div></div></a></div></div></div>    
</body>
</html>