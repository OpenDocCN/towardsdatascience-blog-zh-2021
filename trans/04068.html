<html>
<head>
<title>How to Set up a Machine Learning Model for Legal Contract Review</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立法律合同审查的机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-set-up-a-machine-learning-model-for-legal-contract-review-fe3b48b05a0e?source=collection_archive---------8-----------------------#2021-04-06">https://towardsdatascience.com/how-to-set-up-a-machine-learning-model-for-legal-contract-review-fe3b48b05a0e?source=collection_archive---------8-----------------------#2021-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="a2cc" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">行业笔记</a></h2><div class=""/><div class=""><h2 id="39e6" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">深入研究新发布的自然语言处理数据集，以了解合同</h2></div><p id="41d7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">合同审查是彻底阅读合同以理解签署合同的个人或公司的权利和义务并评估相关影响的过程。人们普遍认为这是初级律师事务所合伙人必须做的最重复、最乏味的工作之一。这也很昂贵，而且是对法律专业人员技能的低效利用。在这篇博文中，我展示了如何建立一个<a class="ae lk" href="https://arxiv.org/abs/2103.06268" rel="noopener ugc nofollow" target="_blank">新发布的数据集</a>和相关的机器学习模型来自动化合同审查。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/bdd5551b797b4d2d0ba20915ab2ce770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DHlVdDTzxSjZ-SXB"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated"><a class="ae lk" href="https://unsplash.com/@homajob?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae lk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="2f53" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">合同评审需要什么？</h1><p id="6ee9" class="pw-post-body-paragraph ko kp iq kq b kr na ka kt ku nb kd kw kx nc kz la lb nd ld le lf ne lh li lj ij bi translated">谈到合同审查，律师的工作就是手动审查数百页的合同，以找到合同中规定的相关条款或义务。这是重复的，因为他们总是需要在任何给定的合同中识别相同的数据点:合同的生效日期是什么？续约条款是什么？谁参与了这个合同？</p><p id="e42e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">律师事务所面临着降低成本的巨大压力，尤其是在COVID时代期间和之后。随着自然语言处理(NLP)的最新进展，机器学习模型可以学习自动提取和识别合同中的关键条款，从而节省数百小时的人工劳动。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="1324" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">什么是CUAD数据集？</h1><p id="25c2" class="pw-post-body-paragraph ko kp iq kq b kr na ka kt ku nb kd kw kx nc kz la lb nd ld le lf ne lh li lj ij bi translated">2021年3月，<a class="ae lk" href="https://www.atticusprojectai.org" rel="noopener ugc nofollow" target="_blank"> Atticus项目</a>发布了合同理解Atticus数据集(CUAD)，该数据集由500多份合同组成，每份合同都由法律专家仔细标记，以确定41种不同类型的重要条款，总共有13，000多条注释。除了数据集，他们还发布了几个经过数据集训练的最先进的变压器模型。你可以在他们的<a class="ae lk" href="https://github.com/TheAtticusProject/cuad/" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>找到数据集和训练代码，微调后的模型可以从<a class="ae lk" href="https://zenodo.org/record/4599830" rel="noopener ugc nofollow" target="_blank"> Zenodo </a>下载。</p><p id="1431" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这篇文章中，我将带你一步一步地建立和运行微调后的模型，这样你就可以用它们来做你自己的预测。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="99d4" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">数据准备</h1><p id="90e0" class="pw-post-body-paragraph ko kp iq kq b kr na ka kt ku nb kd kw kx nc kz la lb nd ld le lf ne lh li lj ij bi translated">你应该可以在你自己的机器上运行这个例子，因为它不是很耗费资源，我们也不需要模型的毫秒级响应。我用的所有代码和笔记本都可以在<a class="ae lk" href="https://github.com/marshmellow77/cuad-demo" rel="noopener ugc nofollow" target="_blank">我的GitHub repo </a>里找到。</p><p id="ef62" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在第一个笔记本中，<a class="ae lk" href="https://github.com/marshmellow77/cuad-demo/blob/main/1_preparation.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="nf">1 _ preparation . ipynb</em></a>，我运行一组shell命令来下载数据、代码、模型和库。相反，您可以在终端中轻松运行这些命令。</p><p id="2c0f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">出于这个博客的目的，我使用的是<em class="nf"> roberta-base </em>模型，它是最小的，但也是表现第三好的模型。当然，你可以选择使用性能更好的<em class="nf"> roberta-large </em>型号或<em class="nf"> deberta-v2-xlarge </em>型号。无论选择哪种模型，加载模型和进行预测的指令都是相同的。所有型号均可在此下载<a class="ae lk" href="https://zenodo.org/record/4599830#.YGRiwOfTVhE" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c76c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">运行这些命令后，您的主项目文件夹中应该有以下三个文件夹:<em class="nf"> cuad-data/ </em>，其中包含实际的cuad数据集<em class="nf">，cuad-models/ </em>，其中包含模型，<em class="nf">和cuad-training/ </em>，其中包含用于训练模型的Python脚本和shell脚本。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/20d1d8afd078ebf1c8caaf6c9ec1dc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*BBvTfb0Wk89IfGbp_736_w.png"/></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">CUAD演示的文件夹结构</p></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="3f45" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">加载模型</h1><p id="7999" class="pw-post-body-paragraph ko kp iq kq b kr na ka kt ku nb kd kw kx nc kz la lb nd ld le lf ne lh li lj ij bi translated">查看<em class="nf"> cuad-training/train.py </em>中的训练代码，我们可以看到cuad模型基于AutoModelForQuestionAnswering类，该类是专门为问答任务训练的。这是有意义的，因为我们希望模型通过问它一个问题来识别合同的某些部分(例如，“合同的日期是什么？”).</p><p id="bf89" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">有了这些知识，我们可以像这样加载模型和它的记号化器(为模型准备输入):</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="a93a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">注意，我们将<em class="nf"> use_fast </em>参数设置为<em class="nf"> False </em>。原因是问答(Q &amp; A)模型与具有更智能的溢出处理的快速标记化器不兼容。这完全符合我们的目的，我们只需要记住相应地设置参数。</p><p id="f933" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">既然我们已经加载了模型，我们可以用一个样本快速测试它。CUAD团队提供JSON文件中的合同和相关查询数据。41个查询的完整列表可在<a class="ae lk" href="https://github.com/marshmellow77/cuad-demo/blob/main/output/questions.txt" rel="noopener ugc nofollow" target="_blank">此处</a>查看。现在，我们可以使用数据集中的一个契约和查询来测试刚刚加载的模型:</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="698d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这段代码从JSON文件加载第三个查询，询问“合同的日期是什么？”，并显示该合同的前100个单词:</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/51dc77b9f5795e64f4b71f98f191859f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*k7bdK_ngnkkuXMGOI3DWkg.png"/></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">查询和签约。我强调了合同中的相关部分。</p></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="f993" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">进行第一次测试预测</h1><p id="79e1" class="pw-post-body-paragraph ko kp iq kq b kr na ka kt ku nb kd kw kx nc kz la lb nd ld le lf ne lh li lj ij bi translated">问答模型的工作方式是将问题和契约连接在一起(用一个特殊的标记分开)，标记化(即准备输入以便模型可以理解)，然后输入到模型中。然后，该模型将提供两个输出:开始逻辑和结束逻辑。</p><p id="26f8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">开始逻辑描述了字符串中每个单词成为问题答案开始的概率。类似地，结尾逻辑描述了每个单词成为答案结尾的概率。</p><p id="5de3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了从模型中获得最佳预测，我们现在要做的就是选择具有最高概率的开始和结束标记。</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="df75" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这一切听起来有点抽象，所以我包含了以下两个图表来澄清。第一个图表描述了契约中的每个标记成为答案的开始标记的概率，第二个图表描述了除结束标记之外的相同情况:</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi nk"><img src="../Images/3065c0a15102efbc665a2e9a84fb788e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4EX1EuQR-Eb64O6IDoD8Q.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">每个标记成为开始标记的概率</p></figure><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi nl"><img src="../Images/a354408eb7986340591823c4a1fa9cc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoT40-CBtHJZuVnmaAFBwg.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">每个标记成为结束标记的概率</p></figure><p id="9de1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">通过分别挑选具有最高概率的两个记号，我们检索总体上具有最高概率的模型预测:</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/4e91f1360e8c5d9123e0e15beec2d9e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*E1K8VafOyhAYwcViXoDpiw.png"/></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">模型预测法</p></figure><p id="4c40" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">完整代码可以在笔记本<a class="ae lk" href="https://github.com/marshmellow77/cuad-demo/blob/main/2_loading_model.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="nf">2 _ loading _ model . ipynb</em></a>中找到。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="eb76" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">摘要</h1><p id="ac72" class="pw-post-body-paragraph ko kp iq kq b kr na ka kt ku nb kd kw kx nc kz la lb nd ld le lf ne lh li lj ij bi translated">在这篇博文中，我们介绍了自动化合同审查的挑战以及帮助应对这一挑战的CUAD数据集。我们已经下载了数据集并加载了相关的微调模型。然后，我们创建了第一个示例查询，以确保模型正确运行。我们已经查看了模型的输出，并确定了提取模型预测的简单方法。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="4d7a" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">后续步骤</h1><p id="1a53" class="pw-post-body-paragraph ko kp iq kq b kr na ka kt ku nb kd kw kx nc kz la lb nd ld le lf ne lh li lj ij bi translated">我们在这里还没有完成:虽然我们现在已经建立并运行了模型，但是我们的方法对于在生产中实际使用来说有点太简单了。首先，您可能已经问过自己:“如果模型预测到一个结束标记在契约中的开始标记之前，该怎么办？”这是一个合理的问题，因为开始和结束标记是由模型独立预测的，所以我们必须实现一些逻辑来解决这个问题。</p><p id="c06f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们当前方法的另一个限制并不明显，但与问答模型的底层架构有关。这些模型中的大多数，包括这一个，只能接受512个令牌(大致相当于512个单词)，这包括问题和契约的组合。但是这对于我们的用例来说是行不通的:大多数合同都比512个单词长得多，例如，特定合同评审查询的答案可能在合同的第27页。</p><p id="271a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在以后的博客文章中，我们将看看如何克服这些限制，以及如何为这个演示设置一个用户友好的UI。</p><p id="5e19" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja"><em class="nf">【2021年4月13日编辑:</em> </strong> <a class="ae lk" rel="noopener" target="_blank" href="/how-to-set-up-a-machine-learning-model-for-legal-contract-review-part-2-6ecbbe680ba"> <strong class="kq ja"> <em class="nf">第二部</em> </strong> </a> <strong class="kq ja"> <em class="nf">现已出版！】</em> </strong></p></div></div>    
</body>
</html>