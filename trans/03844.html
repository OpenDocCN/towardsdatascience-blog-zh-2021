<html>
<head>
<title>Not all pixels matter for classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">并非所有的像素对分类都很重要</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/not-all-pixels-matter-for-classification-b8d8f0f198d3?source=collection_archive---------30-----------------------#2021-03-30">https://towardsdatascience.com/not-all-pixels-matter-for-classification-b8d8f0f198d3?source=collection_archive---------30-----------------------#2021-03-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a1de" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="4a47" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">利用低秩结构和稀疏性对图像进行分类</h2></div><p id="4cfe" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我女儿两岁了。像她这个年龄的大多数孩子一样，她已经很擅长区分各种各样的动物了。当我画猫和狗的时候，她甚至能把它们区别开来，天哪，我画得太糟糕了！仔细想想，这是相当了不起的。即使信息很少(我告诉过你我真的不擅长画画吗？)，她能正确推断出我给她看的图片上是什么。计算机是一个完全不同的故事。我们使用现成的监督学习算法来训练它们。这些算法通常涉及过度参数化的深度神经网络，其参数使用数千(如果不是数百万)图像的数据集来拟合。但是我们能更有效率吗？我们能否训练计算机仅用少量像素就能检测出呈现给它的是一只猫还是一只狗的图像？有时确实如此，这就是我们今天要探讨的。</p><h1 id="f202" class="ln lo it bd lp lq lr ls lt lu lv lw lx ki ly kj lz kl ma km mb ko mc kp md me bi translated">猫还是狗？</h1><p id="720c" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/pixels-are-not-created-equal-b3ae4b36ffbc">在之前的一篇文章</a>中，我讨论了工程和工业中流行的标准化数据集是如何被底层的低等级结构所表征的。然后，我们利用这种结构设计了一种有效的算法，从有限的像素测量值重建图像。类似的想法可以用于分类目的。</p><p id="7837" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">今天，我们将使用由猫狗的灰度图像组成的简单数据集。每张图片是64乘64像素，我们有242个。虽然这是一个相对较小的数据集，但足以说明我的观点。下图显示了这些猫和狗的随机子集。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/9aae255a9e1e49ce51fa2737a3c3c9c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*cYiblUk6KYsa-Qw-vQ76OQ.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">我们数据集中的随机宠物。图片由作者提供。</p></figure><p id="366a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我将展示的大部分灵感来自<a class="ae mk" href="https://epubs.siam.org/doi/pdf/10.1137/15M1036713" rel="noopener ugc nofollow" target="_blank">布伦顿<em class="mx">等人</em>T7】。不要犹豫，看看他们的文章，了解更多细节。关键是，与我们为</a><a class="ae mk" rel="noopener" target="_blank" href="/pixels-are-not-created-equal-b3ae4b36ffbc">图像重建</a>所做的相比，分类图像实际上需要更少的像素。</p><h2 id="cfe8" class="my lo it bd lp mz na dn lt nb nc dp lx la nd ne lz le nf ng mb li nh ni md iz bi translated">基线模型</h2><p id="84b7" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">让我们从建立一个基线模型开始。为此，我们将使用基于线性判别分析的简单线性分类器。数学细节对我们的讨论不重要，因此被省略了。如果你想了解更多，这里有很多关于LDA的帖子。</p><p id="2b9b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">此后，90%的图像将被随机分配给训练集，剩下的10%分配给测试集。这一过程重复100次，以获得统计上相关的结果。然后，向量<strong class="kt jd"> w </strong>和偏差<em class="mx"> b </em>被定义为这100次实验的模型参数的平均值。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/acc8448e4a6f356300cb77bf49e8a6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*_U3Sr10vXH3DTn8-i8Bvqg.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">基线模型的决策线(平均超过100次实验)。图片由作者提供。</p></figure><p id="aac6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">左边的图片显示了最终的矢量<strong class="kt jd"> w </strong>(一旦被重塑成图像)。看不到特定的模式，然而，相应的模型在测试集上达到了80%的平均准确率。这定义了我们以后的基线。</p><h1 id="286f" class="ln lo it bd lp lq lr ls lt lu lv lw lx ki ly kj lz kl ma km mb ko mc kp md me bi translated">用于分类的稀疏传感器放置</h1><p id="cf77" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">我们的基线模型在做出决定之前必须观察图像的所有4096个像素。现在的问题是:我们能否在只观察少量像素的情况下实现类似的性能？这个问题的答案是一个三阶段的程序。首先，我们的数据被线性投影到一个更低维的子空间。然后，基于嵌入的数据训练线性分类器。最后，从投影基和低维决策向量中推断出最重要的像素。</p><h2 id="5923" class="my lo it bd lp mz na dn lt nb nc dp lx la nd ne lz le nf ng mb li nh ni md iz bi translated">降维</h2><p id="2395" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">如前所述，低维嵌入从数据矩阵<strong class="kt jd"> X </strong>的奇异值分解中获得</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/7a227315a89d391227fba448ca553edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*wrfqy8UoDLjgrcuSTtLv4A.png"/></div></figure><p id="5e6c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">下图显示了被重新整形为图像的<strong class="kt jd"> U </strong>的前36列。与特征脸平行，这些图像可以被称为特征脸。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nl"><img src="../Images/6bbd4542adee38cb92f81012bc401627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rrLL9PHIzry6OTSfeCLDKg.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">引渴——六个eigenpets(从左到右，从上到下)。图片由作者提供。</p></figure><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/ccb0b918a4e70b046034e17141017871.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*HAP9u3oJ163bbFq0ktesDQ.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">作为秩的函数的近似的核范数。图片由作者提供。</p></figure><p id="5eb8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">左边显示了近似的核范数作为其秩的函数的演变。由于我们的数据集很小，没有清晰的低秩结构出现。尽管如此，我们仍然可以利用这种低维嵌入来识别用于分类的最相关的像素。尽管缺乏底层的低秩结构，我们将在秩小至r = 20时截断数据矩阵。</p><h2 id="a986" class="my lo it bd lp mz na dn lt nb nc dp lx la nd ne lz le nf ng mb li nh ni md iz bi translated">低维分类</h2><p id="7a9b" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">现在让我们在这个低维子空间中训练我们的分类器。使用相同的学习程序。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/61f29ef0a5c2831628cd114da8bfe404.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*mp_smDoQkFd8oGnnmHv0NQ.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">当数据被限制在一个20维的空间时。图片由作者提供。</p></figure><p id="bfee" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">左图是高维空间中的决策线<strong class="kt jd">ψw</strong>。一些猫的模式开始出现。因此，向量<strong class="kt jd">ψw</strong>定义了一个比我们的基线模型更容易解释的超平面。这也导致在测试集上类似的80%的准确度。但是请注意，要在实践中使用该模型，仍然需要考虑图像的所有4096个像素，以将其投影到决策线上。</p><h2 id="2c82" class="my lo it bd lp mz na dn lt nb nc dp lx la nd ne lz le nf ng mb li nh ni md iz bi translated">识别最相关的像素</h2><p id="44cb" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">有趣的部分来了。决策向量<strong class="kt jd"> w </strong>是20维的。因此，实际上只需要20像素的测量值就可以将给定的图像投影到相应的低维决策线上。但是如何选择它们呢？借鉴<a class="ae mk" rel="noopener" target="_blank" href="/how-to-reconstruct-an-image-if-you-see-only-a-few-pixels-e3899d038bf9">压缩传感</a>、<a class="ae mk" href="https://epubs.siam.org/doi/pdf/10.1137/15M1036713" rel="noopener ugc nofollow" target="_blank">布伦顿<em class="mx">等人</em> </a>的思想。建议通过解决以下优化问题来识别最具信息量的像素</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/153c7d9db99d3c2bf291971f79378152.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*DKb5evbXz9nRsKMirIDAWw.png"/></div></figure><p id="ac9a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">向量∊ ℝⁿ被认为是稀疏的。它的大多数条目是零，并且它最多有r = 20个非零条目。等式约束<strong class="kt jd">ψ</strong>ᵀ<strong class="kt jd">s = w</strong>强制所选像素确实将图像投影到适当的决策线上。因此，<strong class="kt jd"> s </strong>可以理解为选择最有信息的像素用于分类目的的掩码。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/34032c0b5fa5576a3f8e7e008b018ca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*WhhKFTBugjJyB5eL6A59aw.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">用于分类目的的最重要的像素。图片由作者提供。</p></figure><p id="3c5d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">给定我们的训练数据集，左图显示了叠加在图像上的这些最具信息量的像素的位置，对应于我们当前模型的决策线。有趣的是，如果我们重复整个过程(包括随机分配到训练集和测试集)，这个简单的过程识别出鼻子、眼睛、耳朵和前额是最能提供信息的区域，以确定出现的是猫还是狗。这为我们的模型提供了一些可解释性。</p><h2 id="8760" class="my lo it bd lp mz na dn lt nb nc dp lx la nd ne lz le nf ng mb li nh ni md iz bi translated">少像素模型与高维基线</h2><p id="9d26" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">既然我们已经确定了信息最丰富的像素，让我们仅使用这些有限的像素测量值来训练线性分类器。再次使用相同的学习程序。下图显示了有限像素测量值在相应决策线上的投影。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/204d96dcf099fb75a474888ac202224f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*Apwy0EljA_NxuOVpO0a0VQ.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">图片由作者提供。</p></figure><p id="16a6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">即使使用非常有限的测量，我们的分类器也可以以与我们之前的两个模型(80%)相当的准确度(78%)区分猫和狗。鉴于我们现在只使用了0.5%的像素，这是相当令人印象深刻的！一个明智的问题是，我们能做得更好吗？有没有可能用更少的像素达到类似的性能？答案有些反差。低于这个阈值，我们的简单模型的准确性会迅速下降，但更好的维度减少或更鲁棒的分类器可能会做得更好。然而，这个简单的例子说明了如何使用标准线性代数技术来显著减少分类所需的数据量。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h1 id="9803" class="ln lo it bd lp lq ny ls lt lu nz lw lx ki oa kj lz kl ob km mb ko oc kp md me bi translated">结论</h1><p id="64ac" class="pw-post-body-paragraph kr ks it kt b ku mf kd kw kx mg kg kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">在大数据时代，试图用尽可能少的数据建立一个模型可能会适得其反。数据效率在工程和工业应用中仍然至关重要。在这种情况下，数据收集或存储可能是复杂和庞大的，数据处理也是如此。我充分意识到我提出的问题是对这种情况的过度简化。我希望它仍能启发那些需要数据高效或可解释模型的人。我介绍的方法可以在许多方面进行改进。诸如支持向量机或逻辑回归的其他分类器可以用来代替简单的线性判别分析。类似地，与PCA相比，非负矩阵分解可以提供更直观的图像嵌入。使用图像的小波变换也可能更有效。可能性是无限的。让我知道这是否对你的特殊问题有帮助！</p><p id="ddb0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">PS:如果你想了解更多，我在这篇文章的末尾添加了一个学术参考文献列表。我也强烈建议你看看Brunton &amp; Kutz的新书，<a class="ae mk" href="http://www.databookuw.com/" rel="noopener ugc nofollow" target="_blank"> <em class="mx">数据驱动的科学与工程——机器学习、动力系统与控制</em> </a>，你可以从他们的网站上免费下载(【http://databookuw.com/】<a class="ae mk" href="http://databookuw.com/" rel="noopener ugc nofollow" target="_blank">)。你也可以查看他们各自的YouTube频道(</a><a class="ae mk" href="https://www.youtube.com/c/Eigensteve/videos" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae mk" href="https://www.youtube.com/channel/UCoUOaSVYkTV6W4uLvxvgiFA/videos" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><blockquote class="od oe of"><p id="cbc9" class="kr ks mx kt b ku kv kd kw kx ky kg kz og lb lc ld oh lf lg lh oi lj lk ll lm im bi translated"><em class="it">想要阅读更多此类内容？</em>查看我其他关于<a class="ae mk" href="https://loiseau-jc.medium.com/list/lowrank-structure-and-datadriven-modeling-8f39635a90ea" rel="noopener">低秩结构和数据驱动建模</a> <em class="it">的文章或者干脆我的</em> <a class="ae mk" href="https://loiseau-jc.medium.com/list/machine-learning-basics-0baf10d8f8b5" rel="noopener"> <em class="it">机器学习基础知识</em> </a>！</p></blockquote><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/how-to-reconstruct-an-image-if-you-see-only-a-few-pixels-e3899d038bf9"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd jd gy z fp or fr fs os fu fw jc bi translated">如果只看到几个像素，如何重建一幅图像？</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">压缩传感快速介绍</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa mr om"/></div></div></a></div></div></div>    
</body>
</html>