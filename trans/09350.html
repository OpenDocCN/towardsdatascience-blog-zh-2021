<html>
<head>
<title>How to Implement Artificial Intelligence Using scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用scikit-learn实现人工智能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-implement-artificial-intelligence-using-scikit-learn-e4f322ae4f32?source=collection_archive---------24-----------------------#2021-08-30">https://towardsdatascience.com/how-to-implement-artificial-intelligence-using-scikit-learn-e4f322ae4f32?source=collection_archive---------24-----------------------#2021-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6df8" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="6fc5" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">这篇介绍power Python工具的文章将让你很快应用人工智能</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/ea89632e6257babdbd550cd9ffbb7888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yOyhs0f9mL9CokGriekGbQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片来源:<a class="ae lh" href="https://pixabay.com/users/ahmedgad-9403351/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3501528" rel="noopener ugc nofollow" target="_blank">阿迈德·加德</a>在<a class="ae lh" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3501528" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a></p></figure><p id="3ad1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据科学家将人工智能(AI)用于一系列强大的用途。它现在运行控制系统，减少建筑能耗，它为购买衣服或观看节目提供建议，它有助于改善农业实践和我们可以种植的食物量，有一天它甚至可能为我们驾驶汽车。知道如何使用这些工具将使你有能力解决下一代社会的技术挑战。</p><p id="6929" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">幸运的是，对于已经熟悉Python和数据分析的人来说，开始使用人工智能并不那么具有挑战性。您可以利用强大的scikit-learn包来为您完成大部分艰苦的工作。</p><h2 id="e595" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">什么是scikit-learn？</h2><p id="67d7" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">scikit-learn是一个python包，旨在促进机器学习和人工智能算法的使用。它包括用于分类、回归和聚类的算法，包括流行的随机森林和梯度推进算法。这个软件包被设计成可以很容易地与常见的科学软件包numpy和scipy接口。尽管不是专门为熊猫设计的，但它也能很好地与熊猫互动。</p><p id="cfb5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">scikit-learn还包括一些有用的工具，有助于使用机器学习算法。开发准确预测系统行为的机器学习管道需要<a class="ae lh" rel="noopener" target="_blank" href="/how-to-choose-between-multiple-models-a0c274b4228a">将数据分成训练和测试集</a>，以及对算法进行评分以确定它们的运行情况，并<a class="ae lh" rel="noopener" target="_blank" href="/a-primer-on-model-fitting-e09e757fe6be">确保模型既不过度拟合也不欠拟合</a>。scikit-learn界面包括执行所有这些任务的工具。</p><h2 id="6586" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">scikit-learn算法是如何工作的？</h2><p id="f599" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">开发和测试scikit-learn算法可以分三个一般步骤进行。它们是:</p><ol class=""><li id="9c9d" class="nb nc it lk b ll lm lo lp lr nd lv ne lz nf md ng nh ni nj bi translated">使用描述需要模型预测的现象的现有数据集来训练模型。</li><li id="e9b0" class="nb nc it lk b ll nk lo nl lr nm lv nn lz no md ng nh ni nj bi translated">在另一个现有数据集上测试该模型，以确保其性能良好。</li><li id="08ce" class="nb nc it lk b ll nk lo nl lr nm lv nn lz no md ng nh ni nj bi translated">使用模型来预测项目所需的现象。</li></ol><p id="95a2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">scikit-learn应用程序编程接口(API)提供了通过单个函数调用来执行这些步骤的命令。所有的scikit-learn算法在这个过程中使用相同的函数调用，所以如果你学会了一个，你就学会了所有的。</p><p id="1679" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">训练scikit-learn算法的函数调用是<em class="np">。fit() </em>。来训练你称为。函数，并将训练数据集的两个组件传递给它。这两个组件是x数据集，提供描述数据集的<em class="np">特征</em>的数据，以及y数据，提供描述系统的<em class="np">目标</em>的数据(<em class="np">特征</em>和<em class="np">目标</em>是机器学习术语，本质上表示x和y数据)。然后，该算法创建由所选算法和模型参数确定的数学模型，该模型尽可能匹配所提供的训练数据。然后，它将参数存储在模型中，允许您根据项目需要调用模型的fit版本。</p><p id="bc74" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">测试模型拟合度的函数是<em class="np">。score() </em>。要使用该函数，您需要再次调用该函数，并传递表示特征的x数据集和表示目标的相应y数据集。与定型模型时相比，使用不同的数据集(称为测试数据集)非常重要。当对训练数据评分时，模型很可能得分很高，因为它在数学上被迫与该数据集匹配。真正的测试是模型在不同数据集上的表现，这是测试数据集的目的。调用<em class="np">时。score() </em>函数scikit-learn将返回<a class="ae lh" href="https://en.wikipedia.org/wiki/Coefficient_of_determination#:~:text=R2%20is%20a%20statistic,predictions%20perfectly%20fit%20the%20data." rel="noopener ugc nofollow" target="_blank"> r值</a>，说明模型使用提供的x数据集预测提供的y数据集的效果如何。</p><p id="c475" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以使用scikit-learns <em class="np">预测给定输入的系统输出。预测()</em>函数。重要的是，您只能在拟合模型后执行此操作。拟合是指如何调整模型以匹配数据集，因此如果不首先进行拟合，模型将不会提供有价值的预测。一旦模型合适，您就可以将一个x数据集传递给<em class="np">。predict() </em>函数，它将返回模型预测的y数据集。通过这种方式，你可以预测一个系统未来的行为。</p><p id="7fa1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这三个函数构成了scikit-learn API的核心，对您将人工智能应用于技术问题大有帮助。</p><h2 id="2dd7" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">如何创建培训和测试数据集？</h2><p id="1f03" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">创建单独的训练和测试数据集是训练人工智能模型的关键组成部分。如果不这样做，我们就无法创建一个与我们试图预测的系统相匹配的模型，也无法验证其预测的准确性。幸运的是，scikit-learn再次提供了一个有用的工具来促进这一过程。那个工具就是<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"><em class="np">train _ test _ split()</em></a>函数。</p><p id="3cb7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="np"> train_test_split() </em>做的和听起来一样。它将提供的数据集分成训练数据集和测试数据集。您可以使用它来创建所需的数据集，以确保您的模型正确预测您正在研究的系统。您向<em class="np"> train_test_split() </em>提供一个数据集，它提供您需要的训练和测试数据集。然后，它返回拆分为定型数据集和测试数据集的数据集，您可以使用这些数据集来开发您的模型。</p><p id="b961" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用<em class="np"> train_test_split() </em>的时候有几个需要注意的地方。首先，<em class="np"> train_test_split() </em>本质上是随机的。这意味着，如果使用相同的输入数据多次运行，train_test_split()将不会返回相同的训练和测试数据集。如果您想要测试模型准确性的可变性，这可能是好的，但是如果您想要在模型上重复使用相同的数据集，这也可能是不好的。为了确保每次都能得到相同的结果，您可以使用<em class="np"> random_state </em>参数。随机状态设置将强制它在每次运行时使用相同的随机化种子，并提供相同的数据集分割。当使用random_state时，习惯上将其设置为42，这可能是对《银河系漫游指南》的幽默回应，而不是出于任何技术原因。</p><h2 id="1880" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">这两者是如何结合在一起的？</h2><p id="ab2a" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">总之，这些工具创建了一个简化的界面来创建和使用scikit-learn工具。让我们以scikit-learn的<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener ugc nofollow" target="_blank"> <em class="np">线性回归</em> </a>模型为例来讨论一下。</p><p id="3d99" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要实现这一过程，我们必须首先导入所需的工具。它们包括scikit-learn模型、<em class="np"> train_test_split() </em>函数和用于数据分析过程的pandas。这些函数按如下方式导入:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="951c" class="me mf it nr b gy nv nw l nx ny">from scikit-learn.linear_model import LinearRegression<br/>from scikit-learn.model_selection import train_test_split<br/>import pandas as pd</span></pre><p id="7931" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后我们可以读入一个数据集，这样它就可以用于训练和测试模型。我创建了一个<a class="ae lh" href="https://peter-grant.my-online.store/HPWH_Performance_Map_Tutorial_Data_Set/p6635995_20036443.aspx" rel="noopener ugc nofollow" target="_blank">真实数据集</a>，展示热泵热水器(HPWHs)的<a class="ae lh" rel="noopener" target="_blank" href="/tutorial-automatically-creating-a-performance-map-of-a-heat-pump-water-heater-7035c7f208b0">性能作为其运行条件的函数</a>，专门帮助人们学习数据科学和工程技能。假设您已经下载了数据集，并将其保存在与脚本相同的文件夹中，您可以使用下面的代码行打开它。如果没有，您可以根据需要调整这些步骤，在您喜欢的任何数据集上进行练习。</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="3bc4" class="me mf it nr b gy nv nw l nx ny">data = pd.read_csv('COP_HPWH_f_Tamb&amp;Tavg.csv', index_col = 0)</span></pre><p id="e7bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下一步是将数据集分成X和y数据。为此，我们创建新的数据框，指定代表要素和目标的数据集列。在HPWHs的情况下，特征是水箱温度和环境温度，而目标是电力消耗。数据集包含八列，显示储水箱中八个不同深度的水温，每一列名为“Tx (deg F)”，其中x是代表测量位置的数字。它还包含一个列，显示热水器周围空间的测量环境温度，名为“T_Amb(华氏度)”。最后，数据集包含一个存储电力消耗数据的列，称为“P_Elec (W)”。在这种情况下，过滤我们的数据集也很重要，这样我们只在耗电时使用数据。如果我们跳过这一步，我们将把非线性引入线性模型，这将使模型失败。</p><p id="0185" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以使用以下代码完成所有这些步骤:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="8ca6" class="me mf it nr b gy nv nw l nx ny"># Filter the data to only include points where power &gt; 0<br/>data = data[data['P_Elec (W)'] &gt; 0]</span><span id="b280" class="me mf it nr b gy nz nw l nx ny"># Identify X columns and create the X data set<br/>X_columns = ['T_Amb (deg F)']<br/>for i in range(1, 9):<br/>    X_columns.append('T{} (deg F)'.format(i))<br/>    <br/>X = data[X_columns]</span><span id="7cc9" class="me mf it nr b gy nz nw l nx ny"># Create the y data set<br/>y = data['P_Elec (W)']</span></pre><p id="e3a0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们有了X和y数据集，我们可以将这些X和y数据集分成训练和测试数据集。这可以通过调用scikit-learn的<em class="np">函数train_test_split() </em>来完成，如下所示。</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="f071" class="me mf it nr b gy nv nw l nx ny">X_train, X_test, y_train, y_test = train_test_split(X, y, random_state = 42)</span></pre><p id="f0b7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">既然我们已经准备好了训练和测试数据集，我们可以创建并拟合数据集的<em class="np">线性回归</em>模型。为此，我们首先创建模型的一个实例，然后调用<em class="np">。fit() </em>功能如下。</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="7fd3" class="me mf it nr b gy nv nw l nx ny">model = LinearRegression()<br/>model = model.fit(X_train, y_train)</span></pre><p id="0a50" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">注意，这个实现使用了线性回归模型的默认参数。这可能会也可能不会产生与数据的良好拟合，我们可能需要更改参数来获得良好的拟合。我将在以后的文章中提供实现这一点的高级方法，但是现在使用默认参数就足以学习这些概念了。</p><p id="8115" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下一步是在测试数据集上对模型进行评分，以确保它很好地符合数据集。你可以通过调用<em class="np">来实现。score() </em>并通过测试数据。</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="ea4a" class="me mf it nr b gy nv nw l nx ny">score = model.score(X_test, y_test)</span></pre><p id="23bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果模型在测试数据集上得分很高，那么你就有机会拥有一个训练有素的、适合数据集的模型。如果没有，那么您需要考虑收集更多的数据，调整模型的参数，或者使用完全不同的模型。</p><p id="27a6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果模型运行良好，那么您就可以声明模型可以使用，并开始预测系统的行为。因为我们现在没有额外的数据集可以预测，所以我们可以简单地预测测试数据集的输出。为此，您调用了<em class="np">。预测()</em>功能如下。</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="3924" class="me mf it nr b gy nv nw l nx ny">predict = model.predict(X_test)</span></pre><p id="93dc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当暴露于X_test定义的输入时，预测变量现在将保存系统的预测输出。然后，您可以使用这些输出直接与y test中的值进行比较，使您能够更仔细地研究模型拟合和预测准确性。</p><h2 id="454f" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">这款车型表现如何？</h2><p id="2916" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">由于我们计算了模型的分数，并将其保存到变量分数中，因此我们可以很快看到模型对HPWH耗电量的预测有多好。在这种情况下，模型的得分为0.58。</p><p id="8ce6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">r是从0到1的度量。零表示该模型根本不能解释观察到的系统行为。一个表明模型完美地解释了系统的行为。0.58的r值表明该模型解释了一半以上的观察到的行为，这不是很好。</p><p id="d9c4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我上面提到的三个潜在改进是:</p><ul class=""><li id="5a98" class="nb nc it lk b ll lm lo lp lr nd lv ne lz nf md oa nh ni nj bi translated">收集更多的数据，</li><li id="aa29" class="nb nc it lk b ll nk lo nl lr nm lv nn lz no md oa nh ni nj bi translated">调整模型的参数，</li><li id="16b9" class="nb nc it lk b ll nk lo nl lr nm lv nn lz no md oa nh ni nj bi translated">使用完全不同的模型。</li></ul><p id="4cff" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们当然可以收集更多的数据或调整<em class="np">线性回归</em>模型的参数，但这里的核心问题可能是热泵功耗和水温之间的关系是非线性的。线性模型很难预测非线性的东西！</p><p id="5110" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以使用为非线性系统设计的模型来尝试同样的方法，看看我们是否能得到更好的结果。一个可能的模型是<em class="np">随机森林回归器</em>。我们可以通过在脚本末尾添加以下代码来尝试。</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="97f1" class="me mf it nr b gy nv nw l nx ny">from sklearn.ensemble import RandomForestRegressor</span><span id="ffcd" class="me mf it nr b gy nz nw l nx ny">model = RandomForestRegressor()<br/>model.fit(X_train, y_train)<br/>score = model.score(X_test, y_test)</span></pre><p id="cb73" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种方法得到了非常高的分数0.9999，这在另一方面是可疑的。这个模型很有可能对数据集过度拟合，实际上在未来不会产生现实的预测。不幸的是，给定可用的数据集，我们无法真正确定这一点。如果您要使用这个模型来开始预测系统，您将需要监控它，以查看它在更多数据可用时的表现，并继续训练它。根据测量数据绘制预测图还可以洞察模型的行为。</p><p id="02ef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这个特定数据集的例子，我会说我会信任这个模型。这是因为该数据集不包含实际测量数据，而是我通过实施回归方程创建的示例数据集，以显示HPWH在这些条件下的表现。这意味着<em class="np"> RandomForestRegressor </em>可能与数据匹配得很好，因为它确定了我用来创建数据集的方程。</p><p id="aed6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有了这些，你就可以开始使用scikit-learn来实现机器学习和人工智能了！如果您记得所有scikit-learn算法都使用<em class="np"> fit() </em>、<em class="np"> score() </em>和<em class="np"> predict() </em>函数，并且您可以使用<em class="np"> train_test_split() </em>创建您的数据集，那么您就踏上了学习不同算法和预测实际系统行为的道路。</p></div></div>    
</body>
</html>