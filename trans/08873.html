<html>
<head>
<title>Automating Version Tags and Changelogs for your Python Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的Python项目自动化版本标签和变更日志</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-version-tags-and-changelogs-for-your-python-projects-6c46b68c7139?source=collection_archive---------17-----------------------#2021-08-16">https://towardsdatascience.com/automating-version-tags-and-changelogs-for-your-python-projects-6c46b68c7139?source=collection_archive---------17-----------------------#2021-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f4cb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基于项目的提交历史，使用commitizen实现版本标签和变更日志自动化的实践指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f96b9e69129682b87bdbfd7335b9528f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HB-b9xGizBMEBcbx"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@yancymin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Yancy Min </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7f92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">厌倦了跟踪您的代码变更是否保证次要或主要版本增量？太忙而不能保持一个整洁的日志？尝试使用<a class="ae ky" href="https://commitizen-tools.github.io/commitizen/" rel="noopener ugc nofollow" target="_blank"> commitizen </a>，这是一个命令行实用程序，它“强迫”您按照<a class="ae ky" href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener ugc nofollow" target="_blank">常规提交</a>标准(或不同的用户定义格式)编写提交消息。配置完成后，commitizen将根据您的提交自动调整代码的语义版本，并更新您的changelog。</p><h2 id="6f3f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">配置</h2><p id="d12c" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">Commitizen通过五个简单的步骤进行配置。首先，您需要安装commitizen:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5ae1" class="lv lw it mu b gy my mz l na nb">pip install commitizen</span></pre><p id="d2fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二，将代码当前版本号的引用添加到您的<code class="fe nc nd ne mu b">__init__.py</code>文件中，或者添加一个单独的<code class="fe nc nd ne mu b">__version__.py</code>文件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="dccd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第三，更新你的<code class="fe nc nd ne mu b">.pre-commit-config.yaml</code>以包含一个用于提交的预提交钩子(如果你不熟悉预提交钩子，<a class="ae ky" href="https://python.plainenglish.io/how-to-improve-your-python-code-style-with-pre-commit-hooks-e7fe3fd43bfa" rel="noopener ugc nofollow" target="_blank">查看我之前的关于使用预提交钩子改进代码风格的博文</a>):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="c5a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第四，更新您的<code class="fe nc nd ne mu b">pyproject.toml</code>文件以包含commitizen，它引用您代码的当前版本以及代码中需要在提交时更新版本的其他位置(例如您的<code class="fe nc nd ne mu b">setup.py</code>文件):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="d88e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，运行<code class="fe nc nd ne mu b">pre-commit install --hook-type commit-msg</code>来设置提交预提交挂钩。</p><h2 id="7120" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">在git工作流中使用commitizen</h2><p id="081e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在我们已经安装并配置了commitizen，让我们看看它在git工作流中的使用。</p><p id="c11c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们假设您已经签出了一个新的(特性)分支，并且您已经做了一些您想要提交的更改。在添加(卸载)被跟踪的文件后，我们不使用传统的<code class="fe nc nd ne mu b">git commit '&lt;commit-message&gt;'</code>命令，而是使用<code class="fe nc nd ne mu b">commitizen commit</code>命令(简称为<code class="fe nc nd ne mu b">cz c</code>)。使用该命令将提示一系列选项:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/f608e575b1c0fd7e2e34eb19aa47ca3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n0A59BKP1MHyBsdYIZGPBg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用“cz c”提交时的不同提交选项(图片由作者提供)</p></figure><p id="3dd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用选择菜单对您所做的更改进行分类(例如，错误修复或新功能)，并在提示时添加提交消息。这将为提交消息添加所选代码更改分类的前缀(如<code class="fe nc nd ne mu b">feat</code>或<code class="fe nc nd ne mu b">fix</code>)。例如，如果您添加了一个新特性，commitizen生成的提交消息可能如下所示:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9fc0" class="lv lw it mu b gy my mz l na nb">doc: update README</span></pre><p id="fbac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您提交并推送您的分支、注册一个PR并合并到主分支(或“main”)之后，检查主分支并运行:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3ac8" class="lv lw it mu b gy my mz l na nb">cz bump --check-consistency --changelog</span></pre><p id="22fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将检查您的commitizen配置(和代码)中版本的一致性，并生成或更新一个变更日志(见<a class="ae ky" href="https://github.com/ngoet/es_demo/blob/main/CHANGELOG.md" rel="noopener ugc nofollow" target="_blank">这里</a>是一个基于commitizen的变更日志的例子)。随后，运行以下命令来更新分支上的changelog和版本引用，并推送新的版本标记:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3f53" class="lv lw it mu b gy my mz l na nb">git push<br/>git push --tags</span></pre><p id="a346" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就这样——现在，您已经为基于提交历史的Python项目的自动化版本和变更日志设置好了。感谢阅读！</p><p id="5b94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ni">另外，如果这一切进行得有点太快，看看</em> <a class="ae ky" href="https://github.com/ngoet/es_demo" rel="noopener ugc nofollow" target="_blank"> <em class="ni">这个回购</em> </a> <em class="ni">我为一个</em> <a class="ae ky" href="https://medium.com/@ndgoet" rel="noopener"> <em class="ni">不同的博客帖子</em> </a> <em class="ni">设置的，在那里我使用commitizen进行版本控制。</em></p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><div class="kj kk kl km gt nq"><a href="https://medium.com/@ndgoet/membership" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">用我的推荐链接加入媒体。</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="b3a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如果你喜欢这篇文章，这里还有一些你可能喜欢的文章:</strong></p><div class="of og gp gr oh nq"><a href="https://python.plainenglish.io/how-to-improve-your-python-code-style-with-pre-commit-hooks-e7fe3fd43bfa" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">如何用预提交钩子改进Python代码风格</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">实施代码风格是简化开发过程的关键，下面是如何实现自动化。</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">python .平原英语. io</p></div></div><div class="nz l"><div class="oi l ob oc od nz oe ks nq"/></div></div></a></div><div class="of og gp gr oh nq"><a rel="noopener follow" target="_blank" href="/automating-unit-tests-in-python-with-hypothesis-d53affdc1eba"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">使用假设在Python中自动化单元测试</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">单元测试是产生高质量代码的关键。以下是如何自动化测试Python代码。</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="oj l ob oc od nz oe ks nq"/></div></div></a></div><div class="of og gp gr oh nq"><a rel="noopener follow" target="_blank" href="/simplify-your-python-code-automating-code-complexity-analysis-with-wily-5c1e90c9a485"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">简化您的Python代码:用Wily自动化代码复杂性分析</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">以下是如何让评估代码复杂性成为Python开发例程的一部分</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">towardsdatascience.com</p></div></div><div class="nz l"><div class="ok l ob oc od nz oe ks nq"/></div></div></a></div></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="413b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ni">在依赖</em> <a class="ae ky" href="/@ndgoet" rel="noopener ugc nofollow" target="_blank"> <em class="ni">中的任何内容之前，请仔细阅读</em> <a class="ae ky" href="https://medium.com/@ndgoet/disclaimer-5ad928afc841" rel="noopener"> <em class="ni">本免责声明</em> </a> <em class="ni">我关于Medium.com的文章</em> </a> <em class="ni">。</em></p></div></div>    
</body>
</html>