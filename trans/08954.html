<html>
<head>
<title>Python But It's Weird</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python但是很奇怪</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-but-its-weird-f90b45220f86?source=collection_archive---------17-----------------------#2021-08-18">https://towardsdatascience.com/python-but-its-weird-f90b45220f86?source=collection_archive---------17-----------------------#2021-08-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8f81" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak">质疑你的Python技能的代码片段</strong></h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9a5c977a57f4438e85859df7fc650a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RpS8Qe_1XLYAE863"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@viniciusamano?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">vini cius“amnx”Amano</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ff88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们都爱Python！长期使用这种语言后，如果深入概念，你会对这种语言的模块化感到惊讶。根据我的经验，我发现使用Python、一点PowerBI和基于它的SQL的组合很容易实现我的大部分数据分析工作。</p><p id="d0bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是在这么多的特性中，有一些非常奇怪的Python概念和代码，您在编程过程中可能会遇到，也可能不会遇到。也许它被跳过了，或者你假设它对Python来说是显式正确的，没有任何解释。让我举一些例子。</p><h1 id="8916" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">递增/递减运算符在Python中有效吗？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/4be1f34b515112ec8ac010d5208098f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sKhpZeZpaOtqoMOh"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">沃洛季米尔·赫里先科在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="9a4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在像C/C++/Java/Go这样的编程语言中，我们有增量(++)和减量运算符(-)，它们将变量的值更新1。这些是在循环中迭代时常用的。</p><p id="c155" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您尝试在Python中使用这些操作符，您将得到以下结果:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="603a" class="mq lt iq mm b gy mr ms l mt mu">&gt;&gt;&gt; a = 10<br/>&gt;&gt;&gt; print(++a)<br/>&gt;&gt;&gt; 10<br/>&gt;&gt;&gt; print(--a)<br/>&gt;&gt;&gt; 10<br/>&gt;&gt;&gt; print(a++)<br/>&gt;&gt;&gt; SyntaxError: invalid syntax<br/>&gt;&gt;&gt; print(a--)<br/>&gt;&gt;&gt; SyntaxError: invalid syntax</span></pre><p id="6175" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">后递增/递减返回语法错误，因为Python语法中没有定义这种类型的语法。但是前递增/递减运算符呢？即使这些操作符返回概念上错误的答案，我们如何得到它们的结果？</p><p id="0c50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实际上，双加号(++)被视为+(+a)，它被解析回(a ),这就是它没有引发任何错误的原因。而是返回“a”的原始值。同样的解释也适用于(- -a)。</p><h1 id="b952" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">是否正确使用了round()函数？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/e629a275b917e26497ca024d9017d4f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lNb2EzLHH8PPYJAO"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@varunkgaba?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Varun Gaba </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7e44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尝试在不使用Python IDE的情况下评估以下内容:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="9f60" class="mq lt iq mm b gy mr ms l mt mu">&gt;&gt;&gt; print(round(12.5) - round(11.5))</span></pre><p id="c916" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很可能，您会将值12.5舍入为13，将11.5舍入为12，并将最终答案舍入为1。这个答案在Python 3.x中是错误的！</p><p id="6060" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Python的3.x round函数是使用银行家或收敛舍入实现的，这与5的边缘情况不同。大于5的值向上舍入和小于5的值向下舍入的通常规则保持不变。对于5的边缘情况，它将数字舍入到最接近的偶数。</p><p id="00fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着12.5将被舍入到12，因为它是最接近的偶数，而11.5也将被舍入到12，导致最终答案为0。所以，在这种情况下使用round函数！</p><h1 id="cec9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">海象操作员行为</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/5fadbad8f51de07f48c1a988af158bd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rGSl2FpxwphxndFt"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">杰伊·鲁泽斯基在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a325" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">随着Python 3.8的发布，一个新的运营商进入了人们的视线，walrus operator。根据官方文档，它是一种赋值表达式，用于循环、表达式和更多实例中。它允许您在同一个表达式中赋值和返回值。</p><p id="b275" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有可能的实例都在官方版本中讨论过，你可以在<a class="ae kv" href="https://www.python.org/dev/peps/pep-0572" rel="noopener ugc nofollow" target="_blank"> PEP 572 </a>上找到。我在网上发现的一个有趣的用例将在下面讨论，在这里我输入数字，直到输入为-1。</p><p id="8ff8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在一般情况下，代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="3a51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，使用walrus运算符，它将被简化为:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="20a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您试图在程序中使用walrus操作符作为赋值操作符，您将会得到一个语法错误:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="1bca" class="mq lt iq mm b gy mr ms l mt mu">&gt;&gt;&gt; a := func(x)<br/>&gt;&gt;&gt; SyntaxError: invalid syntax</span></pre><p id="1e36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是因为海象“无粘性赋值表达式”被限制在顶级。通过将表达式括在括号中，仍然可以使用walrus运算符赋值。这将是一个有效的表达式，但不建议使用。</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="4393" class="mq lt iq mm b gy mr ms l mt mu">&gt;&gt;&gt; (a := func(45))</span></pre><h1 id="70bd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">循环引用</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/83abb2a9eeb06959198669cb0fdb0ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3us-ZmlMPNfzjbuS"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马特·西摩在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="54aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个概念真的让我大吃一惊，我都不知道Python语言里有没有这样的东西！</p><p id="a4d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您将一个列表声明为:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="ecdb" class="mq lt iq mm b gy mr ms l mt mu">&gt;&gt;&gt; some_list = some_list[0] = [0, 1]</span></pre><ol class=""><li id="c4ac" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nf ng nh ni bi translated">这里，已经完成了三项任务。在这种情况下，先取最左边和最右边，然后取剩余的赋值。因此，some_list变量保存值[0，1]。</li><li id="107d" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">现在有趣的部分，some_list[0]将被分配给[0，1]。您可能认为它应该抛出一个错误，但是由于some_list变量已经被赋值，所以它不会引发任何错误。</li><li id="9e67" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">但是，我们也知道[0，1]首先被指定为some_list。</li><li id="0d6d" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">这意味着some_list[0]只想引用自身。即使赋予了自我价值，它也会再次指向自身。</li><li id="3d53" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">这就产生了无限引用，称为循环引用。</li><li id="2c0d" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">Python通过将这个无限引用值指定为省略号(…)来处理这个问题。是啊！如果您打印出some_list变量，您将看到这个值。</li></ol><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="deb0" class="mq lt iq mm b gy mr ms l mt mu">&gt;&gt;&gt; [[...], 1]</span></pre><p id="2cf1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即使在我们的例子中尝试打印some_list[0],也会得到如上所示的相同值。它将保持相同的价值为任何数量的水平！你可以尝试另一个非常著名的复杂例子:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="f502" class="mq lt iq mm b gy mr ms l mt mu">&gt;&gt;&gt; a, b = a[b] = {}, 5<br/>&gt;&gt;&gt; print(a)</span></pre><p id="e16b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里也是，最初，a和b被分配各自的值为{}和b。对于a[b]，它将b值5分配为字典的键，但是该值指向正在更新的字典a。因此，key 5将保存一组省略号和值5。</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="52de" class="mq lt iq mm b gy mr ms l mt mu">{5: ({…}, 5)}</span></pre><h1 id="1ce4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="0d22" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">Python中有很多值得关注的东西。其中一些被设计成以定义的方式发生，其他的只是由社区发现的复活节彩蛋。诸如字符串实习、GIL限制、基于等价的字典键散列、“is”操作符用法等等。您可以通过访问这个<a class="ae kv" href="https://github.com/satwikkansal/wtfpython" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>查看整个列表，它是本文中讨论的所有内容的主要来源。</p><p id="d97d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢这篇文章，如果你喜欢，一定要表示你的支持。如果有任何疑问、疑问或潜在的机会，您可以通过<a class="ae kv" href="https://www.linkedin.com/in/kaustubh-gupta/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae kv" href="https://twitter.com/Kaustubh1828" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae kv" href="https://github.com/kaustubhgupta" rel="noopener ugc nofollow" target="_blank"> GitHub </a>联系我。</p><p id="5678" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">热门文章— </strong></p><ul class=""><li id="36e9" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nt ng nh ni bi translated"><strong class="ky ir"> 100k观点俱乐部</strong></li></ul><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/building-android-apps-with-python-part-1-603820bebde8"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">用Python构建Android应用程序:第1部分</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">使用Python构建Android应用程序的分步指南</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol kp nx"/></div></div></a></div><ul class=""><li id="905d" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nt ng nh ni bi translated"><strong class="ky ir"> 50K观点俱乐部</strong></li></ul><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/3-ways-to-convert-python-app-into-apk-77f4c9cd55af"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">将Python应用程序转换为APK的3种方法</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">结束构建Python系列的Android应用程序！</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="om l oi oj ok og ol kp nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/run-python-code-on-websites-exploring-brython-83c43fb7ac5f"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">在网站上运行Python代码:探索Brython</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">Python中的JavaScript等效脚本</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="on l oi oj ok og ol kp nx"/></div></div></a></div><p id="12a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考文献— </strong></p><ol class=""><li id="3bc9" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nf ng nh ni bi translated"><a class="ae kv" href="https://github.com/satwikkansal/wtfpython" rel="noopener ugc nofollow" target="_blank">https://github.com/satwikkansal/wtfpython</a></li><li id="4c8d" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><a class="ae kv" href="https://www.python.org/dev/peps/pep-0572/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/dev/peps/pep-0572/</a></li></ol></div></div>    
</body>
</html>