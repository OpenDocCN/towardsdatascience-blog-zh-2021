<html>
<head>
<title>Pandas for Data Science: A Beginner’s Guide to Missing Values, Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学熊猫:缺失值初学者指南，第二部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-ii-drop-isna-cbbe16a15e70?source=collection_archive---------26-----------------------#2021-04-04">https://towardsdatascience.com/pandas-ii-drop-isna-cbbe16a15e70?source=collection_archive---------26-----------------------#2021-04-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8084" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用drop()、drop_duplicates()和isna()处理Pandas的Python数据科学项目中的缺失值。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2f0be0cd5d68cf92b78ec3023783e66a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9_ZCmml2_pAH3IH42Ytmg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自<a class="ae kv" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1711000" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae kv" href="https://pixabay.com/users/sharonang-99559/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1711000" rel="noopener ugc nofollow" target="_blank">莎朗·昂</a></p></figure><p id="19db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<a class="ae kv" href="https://christineegan42.medium.com/pandas-i-read-csv-head-tail-info-and-describe-43b9b2736490" rel="noopener"> Pandas Essentials I </a>中，我描述了如何开始用Python分析和操作Pandas中的数据。在本教程中，我将解释如何通过处理缺失值来继续使用国家的金属乐队数据集。</p><p id="e727" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在第一节<strong class="ky ir">处理缺失值</strong>中，我提供了一些关于处理缺失值的基本信息。如果你只是为了代码片段而来，这些信息会在Jupyter笔记本的第二部分<strong class="ky ir">数据分析:缺失值</strong>中。</p><h1 id="907d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">一.处理缺失的价值观</h1><p id="76c8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">数据往往是不完美的。最明显的缺陷之一是缺少值，这可能会对您的项目造成严重破坏。</p><h2 id="0723" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">A.什么是缺失值？</h2><p id="21b2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在表格数据(或以行和列的模式排列的数据)中，当有一列包含空白行时，这些空白单元格中的值被视为缺失。</p><p id="a14a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然有一些处理缺失值的通用过程，但是每个数据集都是唯一的，在确定如何处理它们之前评估数据是很重要的。在本教程中，我将探索一些最基本的方法来纠正Python中的缺失值。</p><h2 id="3885" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">B.<strong class="ak">什么是南</strong>？</h2><p id="ebbf" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当数据通过Pandas导入Python时，将出现在该单元格位置的占位符值通常是NaN(非数字)。对于日期时间数据类型，会调用NaT(非时间)。</p><h2 id="e89a" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated"><strong class="ak"> C .为什么数据缺失？</strong></h2><p id="8117" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">数据丢失可能有多种原因。其中包括:</p><ol class=""><li id="a083" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated"><strong class="ky ir">人/机错误</strong> —有人在数据输入阶段犯了一个错误。(例如，由于传感器的问题，没有记录三天的温度。)</li><li id="8dd7" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated"><strong class="ky ir">无响应</strong> —可能没有提供响应。(例如选择不披露收入的调查对象。)</li><li id="393c" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated"><strong class="ky ir">损耗</strong> —一些观察数据不可用，因为它们不再可用于研究。(例如，退出纵向研究的参与者会阻止在研究的后期记录某些指标。)</li><li id="f76a" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated"><strong class="ky ir">修订</strong> —只有拥有特定权限的用户才能访问数据。(例如，诊断仅包括已签署HIPPA表格的患者)</li></ol><p id="fea8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将重点介绍清除缺失值以提高数据完整性的基本方法。但是，在项目的后期阶段，在调查领域的上下文中考虑缺失值的深层本质是很重要的。</p><h2 id="7ae8" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">D.数据是怎么丢失的？</h2><p id="33a1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">缺失数据分为三种主要类型:</p><ol class=""><li id="e8eb" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">完全随机失踪(MCAR)</li><li id="8b32" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">随机失踪(三月)</li><li id="1761" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">非随机缺失(MNAR)</li></ol><p id="5aa7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看看这个<a class="ae kv" href="https://stefvanbuuren.name/fimd/sec-problem.html" rel="noopener ugc nofollow" target="_blank">资源</a>，了解更多关于不同类型的缺失值。</p><h2 id="009d" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">E.为什么缺失值是一个问题？</h2><p id="89f3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">请继续阅读下一节，查看不同类型的缺失值的一些示例、与它们相关的问题以及如何处理它们。</p><h2 id="5cf3" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">二。识别缺失值</h2><p id="b1a7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在本教程中，我讨论了如何。info()可用于获取数据的快速摘要。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="2de5" class="mp lt iq nq b gy nu nv l nw nx">df.info()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/13b20c6c67637816cf84f2c9db55bf02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmSxotMzPgQ9VXGn4BhP0Q.png"/></div></div></figure><p id="4a35" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没有多少值是明确丢失的</p><h1 id="0b4d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">二。使用Jupyter笔记本进行数据分析</strong></h1><p id="b1f9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">1.返回到终端中的项目文件夹。输入以下内容:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="55ba" class="mp lt iq nq b gy nu nv l nw nx">$ jupyter notebook</span></pre><p id="3fb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当Jupyter启动时，选择您的项目笔记本。在上一个教程中，我们使用Pandas方法做了一些初步的分析。要重新执行代码并从我们离开的地方开始，从页面顶部选择<strong class="ky ir">内核&gt;重启并运行所有</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/d9ba414f0c63f9f439dfc063f2592e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJHgSPtATiABGaVkFJ1qvw.png"/></div></div></figure><h2 id="ddbd" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated"><strong class="ak">答:放下一个有熊猫的专栏</strong></h2><p id="0269" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">因为某些值丢失而删除整个列是删除丢失值的一种笨拙的方法。</p><p id="f98a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.在上面笔记本的第三个单元格中，我们查看了最上面的五行。我们可以做的一件事是清理和改进数据帧，去掉<strong class="ky ir">“未命名:0”</strong>列。它似乎是索引的副本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/367e2c85c3bb79b98de1daf4ab9ce72b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w008c0YyqnpJZUEao45Q2w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">第一个是按国家排列的金属乐队数据集</p></figure><p id="c682" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.要去掉那一行，我们可以用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.drop.html?highlight=drop" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> drop() </strong> </a>。该方法将允许我们在数据框中删除一行或一列。输入:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="fbc1" class="mp lt iq nq b gy nu nv l nw nx">df = df.drop(“Unnamed: 0”, axis=1) </span></pre><p id="554e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如何分解是我们使用<strong class="ky ir"> = </strong>来重新分配我们的<strong class="ky ir"> df </strong>变量给它自己的一个修改版本。在赋值<strong class="ky ir">的右侧，drop() </strong>被应用于数据帧。</p><p id="ecce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要做到这一点，请记住以下几点:</p><ul class=""><li id="d252" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ob nh ni nj bi translated">我们需要为drop()提供必要的参数，在本例中是列<strong class="ky ir">的名称</strong>(未命名:0)和轴<strong class="ky ir">。</strong></li><li id="800a" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ob nh ni nj bi translated">坐标轴的默认值为0，表示行数。如果您没有指定一个轴，Pandas会认为您引用的是一个行位置，并将抛出一个错误。</li><li id="1b52" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ob nh ni nj bi translated">要表示“未命名:0”将从列中删除，请输入<strong class="ky ir"> axis=1 </strong>作为参数。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/a3fc58e134dbee82c2a83568ece83b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wg_bSVwa1hji7T61X6gKQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">未命名的数据帧:0已移除</p></figure><p id="986a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请记住，如果您想一次删除多列，请将这些列放在方括号内以表示多列，如下所示:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="00c5" class="mp lt iq nq b gy nu nv l nw nx">df = df.drop([“Unnamed: 0”, "split", "another_column"], axis=1)</span></pre><h1 id="7517" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">三。丢下熊猫的复制品</h1><p id="ecea" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">4.由于这是一个按国家划分的波段数据集，我们可以使用波段名作为主键，或者作为数据中每个观测值(或行)的唯一标识值。因此，band_name列中不应有重复值。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="4f50" class="mp lt iq nq b gy nu nv l nw nx">df[df['band_name'].duplicated()]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/f5b313a48a57dab9d5a3e806f37eed90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNCQ5UqAP5DvkofOnnKIsA.png"/></div></div></figure><p id="44aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">6.对于此示例，这些重复的波段名称很可能是真正的重复。然而，验证我们的假设，即每个观测的波段名确实是唯一的，不会有什么坏处。此外，在其他数据集中，标识列可能不那么明显，所以最好仔细查看重复项。在您的笔记本中尝试这行代码，以便更仔细地查看重复的内容:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="a0c3" class="mp lt iq nq b gy nu nv l nw nx">df[df['band_name'].duplicated()]</span></pre><h1 id="a4c1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">四。用熊猫填充缺失值</strong></h1><p id="3bf6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">4.既然我们已经做出了改进，我们可以更仔细地查看其余的数据。我们可以通过链接方法<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isna.html?highlight=isna#pandas.DataFrame.isna" rel="noopener ugc nofollow" target="_blank"> isna() </a>和<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.sum.html?highlight=sum#pandas.Series.sum" rel="noopener ugc nofollow" target="_blank"> sum() </a>来检查每一列中有多少个空值:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="8494" class="mp lt iq nq b gy nu nv l nw nx">df.isna().sum()</span></pre><p id="bed9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">5.“原点”好像少了8行。让我们通过输入以下命令来检查缺少数据的行:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="7731" class="mp lt iq nq b gy nu nv l nw nx">df[df[‘origin’].isna()]</span></pre><p id="a827" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您的笔记本应该看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/5d7e00fb42b0a42f059ca61abd90bc48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZI6T7qfXOJ_e0y1Iy00mgQ.png"/></div></div></figure><p id="0549" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们进入这一行时，我们要做的是让Pandas显示df的各个部分，这样列“origin”就有一个空值。使用<strong class="ky ir"> df[df[column]] </strong>语法允许我们<a class="ae kv" href="https://pandas.pydata.org/docs/user_guide/indexing.html?highlight=slicing" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">切片</strong> </a>查看满足特定标准的数据帧部分。</p><p id="0678" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在处理缺失值时，谨慎是关键。我们有多种方法来处理缺失的价值，任何方法都有其利弊。因为我们试图确定什么因素会影响一个金属乐队的粉丝数量，所以我们在做决定时会记住这一点。</p><p id="d626" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">处理这种情况的两种方法是消去法或代换法。我们可以通过删除这些行来消除丢失的值。由于我们有5000行数据，我们的分析不会因为丢失8行数据而受到根本影响。然而，我们也可以通过替换“丢失”来最小化丢失的数据量。这样，我们仍然可以在分析中使用这些波段的其他数据。</p><p id="8093" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于这是小规模的，这个选择是相当琐碎的。然而，当数据集越来越大，丢失的数据量也越来越大时，您应该尽可能避免丢弃太多的数据。</p><p id="d103" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">6.我将使用第二个选项，用“Missing”替换这些值。我们所需要做的就是:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="7ba2" class="mp lt iq nq b gy nu nv l nw nx">df = df.fillna(“Missing”)</span></pre><p id="90b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很好，现在我们去掉了多余的列并修复了空值，我们可以开始检查其他列的数据类型了。</p><p id="0d43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">7.如果您正在跟踪一天系列中的数据，请将您的笔记本保存为MyProject.ipynb，以便我们可以从上次停止的地方继续。继续阅读熊猫三继续。</p><p id="75f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">三世。我们做了什么？</strong> <br/> 1。在Jupyter笔记本中重新打开了a项目。<br/> 2。使用drop()消除熊猫数据框中的列。<br/> 3。链接isna()和sum()以返回所有列4的缺失值的数量。<br/> 4。使用fillna()填充缺少的值</p><p id="40e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">四。下一步是什么？</strong> <br/>在<a class="ae kv" href="https://christineegan42.medium.com/pandas-iii-value-counts-duplicated-min-max-d705cae54862" rel="noopener"> Pandas III </a>中，我们将按国家数据集分析和转换金属乐队中的“拆分”和“成型”列。</p></div></div>    
</body>
</html>