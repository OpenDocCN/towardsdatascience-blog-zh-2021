<html>
<head>
<title>Hybrid Linear-Nonlinear Optimization Approach to the Approximation of Multi-Pole Debye Dielectric Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多极德拜介电函数近似的线性-非线性混合优化方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hybrid-linear-nonlinear-optimization-approach-to-the-approximation-of-multi-pole-debye-dielectric-9163aa86baeb?source=collection_archive---------41-----------------------#2021-08-31">https://towardsdatascience.com/hybrid-linear-nonlinear-optimization-approach-to-the-approximation-of-multi-pole-debye-dielectric-9163aa86baeb?source=collection_archive---------41-----------------------#2021-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d8bc" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/thoughts-and-theory" rel="noopener" target="_blank">思想和理论</a></h2><div class=""/><p id="fd93" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><em class="ku">在我之前的</em> <a class="ae kv" href="https://medium.com/@sylwia.majchrowska/modelling-dispersive-materials-with-gprmax-software-during-google-summer-of-code-2021-adventure-b9042b4e9341" rel="noopener"> <em class="ku">帖子</em> </a> <em class="ku">中，我介绍了我在Google Summer of Code 2021期间所做的一些工作，这些工作与色散材料的电特性建模有关。在帖子里，我想分享我最终提交的结果。</em></p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/e94bc9d594ef76354f252f3f23837fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KY32KWzADXtQrQb-"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated">特里·维利迪斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="fbfd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">使用外部电场可以极化某些种类的材料。这些电磁绝缘材料被称为电介质。它们的极化是由内部电荷的轻微运动引起的(正的方向与外部磁场的方向相反，负的方向与外部磁场的方向相反)。这产生了一个内部电场，在某些情况下，还可以重新定向材料的分子。为了测量材料的电极化率，使用了称为介电常数的变量(由希腊字母<em class="ku"> ε </em>表示)。</p><blockquote class="lm"><p id="8ae3" class="ln lo iq bd lp lq lr ls lt lu lv kt dk translated">具有高介电常数的材料比具有低介电常数的材料响应于施加的电场极化更多，从而在材料中存储更多的能量。介电性质的研究涉及材料中电能和磁能的储存和耗散，对于解释各种物理现象非常重要[1]。</p></blockquote><p id="5f4f" class="pw-post-body-paragraph jw jx iq jy b jz lw kb kc kd lx kf kg kh ly kj kk kl lz kn ko kp ma kr ks kt ij bi translated">此外，一些材料表现出介电色散。这意味着电介质材料的介电常数取决于外加电场的频率。这种频率依赖性反映了一个事实，即当施加电场时，材料的极化不会立即改变。材料的响应总是在施加电场后出现，在振荡电场的情况下，会出现特征介电弛豫过程[1]。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/1a5162737dda0b2e70a45ef6c90b1650.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/0*eme1veaqu1ZSCiGY"/></div><p class="li lj gj gh gi lk ll bd b be z dk translated"><em class="mc">宽频率范围内的介电常数谱。ε′和ε″分别表示介电常数的实部和虚部。影响材料响应的各种过程被标记在图像上。图片由[1]提供。</em></p></figure><h1 id="4f77" class="md me iq bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">松弛函数的变体</h1><p id="1b2b" class="pw-post-body-paragraph jw jx iq jy b jz nb kb kc kd nc kf kg kh nd kj kk kl ne kn ko kp nf kr ks kt ij bi translated">德拜方程模拟角频率ω的交变电场中的弛豫过程，描述理想的非相互作用电偶极子群体的介电弛豫响应。作为极化指数衰减的基本原理，复介电常数由德拜函数给出为[2]</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/f6aa0d9c78e3075f92510d123ba24919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*r_MaUH5wIFqkdTHDFeRJ_w.png"/></div></figure><p id="1074" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这里，实部ε′(ω)是介电常数，虚部ε″(ω)是损耗因子，I =√–1。ε <em class="ku"> s </em>为静态介电常数，ε∞为无限频率介电常数，τo为弛豫时间，为弛豫过程的特征时间。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nh"><img src="../Images/97ef8665e1be8fef8c2ba1eeae537069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1OW4wIb-ICbSX06F"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated"><em class="mc">德拜函数的实部和虚部。f0是弛豫频率。图片作者。</em></p></figure><p id="f655" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">然而，单极德拜方程是大多数材料在宽频率范围内的介电行为的不良模型。为了克服这一点，经验导出的Havriliak–Negami弛豫被提出作为单极德拜弛豫模型的修改。该方程另外具有两个指数参数，并表示为[3]</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5214e46f3196fce68e301de66e0ef4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/0*9jAT9ghioItysXlb.png"/></div></figure><p id="7931" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">其中α和β为正实常数(0 ≥ α，β ≤ 1)。根据该模型，可以推导出β=1时的科尔-科尔方程[4]和α=1时的科尔-戴维森方程[5]。当α=1，β=1时，得到再见方程。Havriliak-Negami函数首先用于描述聚合物的介电特性[3]，而Cole-Cole方程主要用于模拟生物组织[6]和液体[7]。</p><p id="c54e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">另一方面，恒定Q因子方法(或品质Q因子)[8]中的Jonscher函数主要用于描述混凝土[9]和土壤[10]的介电特性。其他类型的弛豫函数估计非均质材料的体积介电常数。这里，复折射率模型(CRIM) [11]可以根据其组分的介电性质和体积分数来说明混合物的介电性质。</p><p id="ddf0" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">Havriliak-Negami、Jonscher函数以及稳定的Q因子、CRIM和实验获得的数据不能直接应用于FDTD算法。许多研究人员采用的方法是使用多极德拜展开法，利用多个弛豫时间和形式[12]中的无量纲权重对复介电常数进行近似</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/bcdcd09b44772adff83a0a885e608db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/0*z58UdQhDJpfXBJm-.png"/></div></figure><p id="30fc" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">εn和τ0，N(N = 1，2，…，N)分别是德拜色散的介电常数(重量)和弛豫时间的变化。参数N表示德拜极点的数量(德拜展开分量的总数)。多极德拜模型被广泛使用，因为它可以容易地在时域和频域中表达。</p><h1 id="1c76" class="md me iq bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">寻找松弛时间和无量纲权重</h1><p id="7ae8" class="pw-post-body-paragraph jw jx iq jy b jz nb kb kc kd nc kf kg kh nd kj kk kl ne kn ko kp nf kr ks kt ij bi translated">多极德拜拟合过程的目标是最小化目标函数，该目标函数是所选择的弛豫模型(这里我们有Havriliak-Negami、Jonsher、CRIM或实验数据)和德拜展开的近似形式之间的差异。任务中的函数被明确定义，包括两倍于德拜极点数量的变量，因为我们要计算弛豫时间和无量纲权重。</p><p id="1e41" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">由于色散材料的因果性质，介电常数的实部和虚部通过Kramers-Kronig关系彼此相关。这表明，对于相同的参数，介电常数的实部和虚部可以用德拜函数的和来近似表示。然后，可以仅对虚部的实值展开进行优化过程。在文献中，一些单一的非线性优化程序被用来寻找所有的未知参数(即权重和松弛时间)。然而，因为展开是德拜函数的线性组合，所以更有效的方法是使用线性最小二乘法(LS)来找到权重，使用非线性方法来找到弛豫频率，这里默认使用粒子群优化(PSO)技术。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1c23a158711a480932879ea84c591ea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/0*tVAHh58SP9QZx6al"/></div><p class="li lj gj gh gi lk ll bd b be z dk translated">用粒子群算法寻找函数的全局最小值。图片由<a class="ae kv" href="https://commons.wikimedia.org/wiki/File:ParticleSwarmArrowsAnimation.gif" rel="noopener ugc nofollow" target="_blank">维基共享</a>提供。</p></figure><p id="9ccb" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">gprMax子包<strong class="jy ja"> <em class="ku"> DebyeFit </em> </strong>中采用的技术是Kelley等人[13]提出的混合线性-非线性优化方法的修改。这些调整可以克服一些不稳定性问题，从而使该过程更加稳健和快速。特别地，在负权重的情况下，符号被反转，以便在优化过程中引入大的惩罚(从而间接地约束权重总是正的)。此外，介电常数的近似实部和计算实部之间的差异被添加到成本作用中，以避免可能的不稳定性。</p><h1 id="cc05" class="md me iq bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">代码结构</h1><p id="ff8b" class="pw-post-body-paragraph jw jx iq jy b jz nb kb kc kd nc kf kg kh nd kj kk kl ne kn ko kp nf kr ks kt ij bi translated">gprMax子包<strong class="jy ja"> <em class="ku"> DebyeFit </em> </strong>包含两个主要脚本:</p><ul class=""><li id="5cc6" class="nl nm iq jy b jz ka kd ke kh nn kl no kp np kt nq nr ns nt bi translated"><strong class="jy ja"> <em class="ku"> Debye_fit.py </em> </strong>带有所有松弛函数类的定义，</li><li id="0c2b" class="nl nm iq jy b jz nu kd nv kh nw kl nx kp ny kt nq nr ns nt bi translated"><strong class="jy ja"><em class="ku">optimization . py</em></strong>定义了三种选择的全局优化方法。</li></ul><p id="3069" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja"> <em class="ku">类弛豫</em> </strong>设计用于模拟不同的弛豫函数，如Havriliak-Negami(` havriliaknegami类')、Jon scher(` Jon scher类')、复折射率混合(` CRIM类')模型，以及通过实验得出的或使用其他函数计算的任意介电数据(` Rawdata类')。所选对象类型的构造器构造适当的松弛对象，并定义其所有参数，以及频率点网格。</p><p id="4bb6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja"> <em class="ku">类优化器</em> </strong>支持全局优化算法(粒子群、对偶退火、进化算法),用于找到一组最佳松弛时间，使实际电容率和近似电容率之间的误差最小化，并计算给定松弛时间的优化权重。这里编写的代码主要基于外部库，如“scipy”和“pyswarm”。优化器对象是在松弛模块中创建的。用户可以从三种优化算法中选择一种，并以python字典的形式显示其属性。</p><p id="975d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">通过使用run方法，在松弛对象初始化之后启动拟合过程。函数内部实现的算法由以下步骤组成:</p><ol class=""><li id="9a69" class="nl nm iq jy b jz ka kd ke kh nn kl no kp np kt nz nr ns nt bi translated">使用check_inputs方法检查输入的有效性。</li><li id="45dc" class="nl nm iq jy b jz nu kd nv kh nw kl nx kp ny kt nz nr ns nt bi translated">使用print_info方法打印关于所选近似设置的信息。</li><li id="4b25" class="nl nm iq jy b jz nu kd nv kh nw kl nx kp ny kt nz nr ns nt bi translated">使用计算方法计算实部和虚部，然后设置self.rl和self.im属性。</li><li id="ca6c" class="nl nm iq jy b jz nu kd nv kh nw kl nx kp ny kt nz nr ns nt bi translated">使用optimize方法调用主优化模块，并根据error方法计算误差。[可选]如果德拜极点的数量设置为-1，则重复优化程序，直到百分比误差小于5%或达到20个德拜极点。</li><li id="01eb" class="nl nm iq jy b jz nu kd nv kh nw kl nx kp ny kt nz nr ns nt bi translated">使用print_output方法以gprMax格式打印结果</li><li id="c708" class="nl nm iq jy b jz nu kd nv kh nw kl nx kp ny kt nz nr ns nt bi translated">[可选]使用save_result方法以gprMax格式将结果保存在txt文件中</li><li id="61b4" class="nl nm iq jy b jz nu kd nv kh nw kl nx kp ny kt nz nr ns nt bi translated">[可选]使用plot_result方法绘制实际和近似的介电特性。</li></ol><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nh"><img src="../Images/1a9d22fe1704484782d134b16de3b6a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*er0n2c_UdkkfC2G1"/></div></div><p class="li lj gj gh gi lk ll bd b be z dk translated"><em class="mc">最终用户可以绘制实际和近似电容率以及频率范围内的误差。图片作者。</em></p></figure><h1 id="5f40" class="md me iq bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">总结</h1><p id="5eb1" class="pw-post-body-paragraph jw jx iq jy b jz nb kb kc kd nc kf kg kh nd kj kk kl ne kn ko kp nf kr ks kt ij bi translated">为<a class="ae kv" href="https://www.gprmax.com/" rel="noopener ugc nofollow" target="_blank"> gprMax </a>工作是一次很好的学习经历。gprMax是构建大型复杂GPR模拟的强大工具。它在许多领域的广泛应用证实了它的有用性。</p><p id="b55f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这项工作描述了新的先进建模功能的增加，如拟合实验得出的或使用某些弛豫函数计算的任意介电数据的可能性。这里采用的混合线性-非线性优化方法提供了一种有效且精确的优化程序，以将多极德拜展开拟合到介电数据。</p><h1 id="eead" class="md me iq bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">文学</h1><p id="9b13" class="pw-post-body-paragraph jw jx iq jy b jz nb kb kc kd nc kf kg kh nd kj kk kl ne kn ko kp nf kr ks kt ij bi translated">[1]应用笔记1217–1，<em class="ku">测量材料介电特性的基础知识</em>，惠普文献编号5091–3300 e，1992年。</p><p id="7845" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[2] P .德拜，<em class="ku">极地分子</em>，多佛出版公司，纽约州，1929年。</p><p id="0249" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[3] S. Havriliak和S. Negami，<em class="ku">某些聚合物中介电和机械松弛过程的复平面表示</em>，聚合物，第8卷，第161-210页，1967年。</p><p id="52e7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[4] K. S. Cole和R. H. Cole，<em class="ku">电介质中的分散和吸收，交流电流特性</em>，化学物理杂志，第9卷，第341-351页，1941年。</p><p id="39f0" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[5] M. F .曼宁和M. E .贝尔，<em class="ku">固体电介质中的导电和相关现象</em>，修订版。物理学，第12卷，第215-257页，1940年。</p><p id="6c7a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[6] D. Ireland，A. Abbosh，<em class="ku">使用优化的德拜模型和FDTD方法在微波频率下模拟人体头部</em>，IEEE Trans。天线与传播，第61卷第4期，第2352–2355页，2013年。</p><p id="d7f4" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[7] J. Barthel、R. Buchner和M. Munsterer，“电解质数据收集，第2部分:水和水性电解质溶液的介电特性”，系列。化学数据系列。德国法兰克福:DECHEMA，第十二卷，1995年。</p><p id="6c15" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[8] M. Bano，<em class="ku">遵循介电常数频率复幂定律的有损介质的探地雷达波建模</em>，地球物理勘探，第41卷，第11–26页，2004年。</p><p id="2f0b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[9] T. Bourdi、J. Rhazi、F. Boone和G. Ballivy，<em class="ku">Jonschermodel在混凝土介电常数表征中的应用</em>，物理学杂志D:应用物理学，第41卷，第205410页，2008年10月。</p><p id="f646" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[10] E. Kjartansson，<em class="ku">恒定Q波传播和衰减</em>，地球物理研究杂志，第84卷，第4737-4748页，1979年。</p><p id="f897" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[11] J. R. Birchak，C.G. Gardner，J.E. Hipp，J . M Victor，<em class="ku">用于检测土壤湿度的高介电常数微波探头</em>，Proc .IEEE，第62卷，第93-98页，1974年。</p><p id="8139" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[12] C. A. Balanis，<em class="ku">高级工程电磁学</em>，纽约州:威利市，第二区。2.8.1, 1989.</p><p id="1d86" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">[13] D. F. Kelley，T. J. Destan和R. J. Luebbers，<em class="ku">使用混合粒子群最小二乘优化方法对复介电常数进行德拜函数展开</em>，IEEE天线与传播汇刊，第55卷，第7期，第1999–2005页，2007年7月。</p><div class="oa ob gp gr oc od"><a href="https://github.com/gprMax/gprMax/pull/296" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ja gy z fp oi fr fs oj fu fw iz bi translated">[GSoC 2021]通过majsylw拉动请求#296 gprMax/gprMax模拟复杂材料</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">这个拉取请求包含了我在GSoC 2021期间所做的工作。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="on l oo op oq om or lg od"/></div></div></a></div></div></div>    
</body>
</html>