<html>
<head>
<title>Pandas vs SQL. When Data Scientists Should Use One Over the Other.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫vs SQL。当数据科学家应该使用一个而不是另一个的时候。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-vs-sql-when-data-scientists-should-use-one-over-the-other-ba5f27a78e5d?source=collection_archive---------3-----------------------#2021-05-21">https://towardsdatascience.com/pandas-vs-sql-when-data-scientists-should-use-one-over-the-other-ba5f27a78e5d?source=collection_archive---------3-----------------------#2021-05-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a9e6" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">意见</h2><div class=""/><div class=""><h2 id="d702" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">深入探究每种工具的优势</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/fc8ad5f5b37fbdb24e4bfc03c42987c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kOeiU1zHREpYM77UHFBlQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@rigels?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">参宿七</a>在<a class="ae lh" href="https://unsplash.com/s/photos/pandas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>【1】拍摄。</p></figure></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><h1 id="e0c9" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">目录</h1><ol class=""><li id="d354" class="mh mi it mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">介绍</li><li id="0581" class="mh mi it mj b mk mz mm na mo nb mq nc ms nd mu mv mw mx my bi translated">熊猫</li><li id="1ded" class="mh mi it mj b mk mz mm na mo nb mq nc ms nd mu mv mw mx my bi translated">结构化查询语言</li><li id="94f2" class="mh mi it mj b mk mz mm na mo nb mq nc ms nd mu mv mw mx my bi translated">摘要</li><li id="d56d" class="mh mi it mj b mk mz mm na mo nb mq nc ms nd mu mv mw mx my bi translated">参考</li></ol><h1 id="70e8" class="lp lq it bd lr ls ne lu lv lw nf ly lz ki ng kj mb kl nh km md ko ni kp mf mg bi translated">介绍</h1><p id="3025" class="pw-post-body-paragraph nj nk it mj b mk ml kd nl mm mn kg nm mo nn no np mq nq nr ns ms nt nu nv mu im bi translated">这两种工具不仅对数据科学家很重要，对数据分析和商业智能等类似职位的人也很重要。也就是说，数据科学家什么时候应该专门使用pandas而不是SQL，反之亦然？在某些情况下，您可以只使用SQL，而在其他一些时候，pandas更容易使用，特别是对于那些专注于Jupyter笔记本设置中的研究的数据科学家。下面，我将讨论你什么时候应该使用SQL，什么时候应该使用pandas。请记住，这两种工具都有特定的用例，但是它们的功能有很多重叠的地方，这也是我下面要比较的地方。</p><h1 id="54ed" class="lp lq it bd lr ls ne lu lv lw nf ly lz ki ng kj mb kl nh km md ko ni kp mf mg bi translated">熊猫</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/f6b8dbd5d7fccc3eb4e09c697b812c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnyxhHqBwDKcrExqRTd6Ig.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@kalenkempx?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">卡伦·坎普</a>在<a class="ae lh" href="https://unsplash.com/s/photos/pandas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>【2】上拍摄。</p></figure><p id="98c5" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated"><a class="ae lh" href="https://pandas.pydata.org/docs/index.html" rel="noopener ugc nofollow" target="_blank">Pandas</a>【3】是Python编程语言中的一个开源数据分析工具。当您已经有了主数据集(通常来自SQL查询)时，pandas的好处就开始了。这一主要区别意味着这两个工具是独立的，但是，您也可以在各自的工具中执行几个相同的功能，例如，您可以在pandas中从现有的列创建新的要素，这可能比在SQL中更容易和更快。</p><p id="289f" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">需要注意的是，我并不是在比较Pandas能做SQL不能做的事情，反之亦然。我将根据个人经验，选择能更有效或更适合数据科学工作的工具。</p><blockquote class="oc od oe"><p id="9ff1" class="nj nk of mj b mk nx kd nl mm ny kg nm og nz no np oh oa nr ns oi ob nu nv mu im bi translated">以下是使用pandas比SQL更有利的时候——同时还具有与SQL相同的功能:</p></blockquote><ul class=""><li id="6330" class="mh mi it mj b mk nx mm ny mo oj mq ok ms ol mu om mw mx my bi translated"><strong class="mj jd">根据现有特征创建计算字段</strong></li></ul><p id="7d59" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">当合并一个更复杂的SQL查询时，通常还会合并子查询，以便划分不同列的值。在熊猫身上，你可以简单地划分特征，就像下面这样:</p><pre class="ks kt ku kv gt on oo op oq aw or bi"><span id="2be4" class="os lq it oo b gy ot ou l ov ow">df["new_column"] = df["first_column"]/df["second_column"]</span></pre><p id="1db6" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">上面的代码显示了如何划分两个单独的列，并将这些值分配给一个新列-在这种情况下，您将对整个数据集或数据框执行要素创建。在数据科学的过程中，您可以在特征探索和特征工程中使用该功能。</p><ul class=""><li id="6530" class="mh mi it mj b mk nx mm ny mo oj mq ok ms ol mu om mw mx my bi translated"><strong class="mj jd">分组依据</strong></li></ul><p id="9d77" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">还可以参考子查询，SQL中的group by可能会变得非常复杂，并且需要一行又一行的代码，这在视觉上可能会让人不知所措。在熊猫中，你可以简单地通过一行代码进行分组。<em class="of">我不是在一个简单的select from table查询的末尾引用group by，而是在一个包含多个子查询的查询中引用。</em></p><pre class="ks kt ku kv gt on oo op oq aw or bi"><span id="1a19" class="os lq it oo b gy ot ou l ov ow">df.groupby(by="first_column").mean()</span></pre><p id="6a15" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">这个结果将返回数据帧中每一列的first_column的平均值。使用这个分组功能还有很多其他的方法，下面链接的pandas文档中很好地概述了这些方法。</p><ul class=""><li id="d18e" class="mh mi it mj b mk nx mm ny mo oj mq ok ms ol mu om mw mx my bi translated"><strong class="mj jd">检查数据类型</strong></li></ul><p id="d910" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">在SQL中，您经常需要转换类型，但是有时可以更清楚地看到pandas以垂直格式排列数据类型的方式，而不是在SQL中滚动水平输出。您可以预期<em class="of">返回的数据类型的一些</em>示例是int64、float64、datetime64[ns]和object。</p><pre class="ks kt ku kv gt on oo op oq aw or bi"><span id="acce" class="os lq it oo b gy ot ou l ov ow">df.dtypes</span></pre><p id="f8ce" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">虽然这些都是pandas和SQL的相当简单的函数，但在SQL中，它们特别复杂，有时在pandas数据框架中更容易实现。现在，让我们看看SQL更擅长执行什么。</p><h1 id="457e" class="lp lq it bd lr ls ne lu lv lw nf ly lz ki ng kj mb kl nh km md ko ni kp mf mg bi translated">结构化查询语言</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1e633551f96d5f3b097a4c5ced6b57f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcVV-Stq79lbp4y8tYcdqA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">卡斯帕·卡米尔·鲁宾在<a class="ae lh" href="https://unsplash.com/s/photos/query?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>【4】上的照片。</p></figure><p id="db4c" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">SQL可能是被最多不同职位使用最多的语言。例如，数据工程师可以使用SQL、Tableau开发人员或产品经理。也就是说，数据科学家倾向于频繁使用SQL。值得注意的是，SQL有几种不同的版本，通常都有相似的功能，只是格式略有不同。</p><blockquote class="oc od oe"><p id="2909" class="nj nk of mj b mk nx kd nl mm ny kg nm og nz no np oh oa nr ns oi ob nu nv mu im bi translated">以下是使用SQL比pandas更有利的时候——同时还具有与pandas相同的功能:</p></blockquote><ul class=""><li id="a865" class="mh mi it mj b mk nx mm ny mo oj mq ok ms ol mu om mw mx my bi translated"><strong class="mj jd"> WHERE子句</strong></li></ul><p id="c132" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">SQL中的这个子句使用频率很高，在熊猫中也可以执行。然而，对于熊猫来说，这要稍微困难一些，或者说不那么直观。例如，您必须写出冗余的代码，而在SQL中，您只需要<code class="fe ox oy oz oo b">WHERE</code>。</p><pre class="ks kt ku kv gt on oo op oq aw or bi"><span id="ac5f" class="os lq it oo b gy ot ou l ov ow">SELECT ID</span><span id="79a8" class="os lq it oo b gy pa ou l ov ow">FROM TABLE</span><span id="b131" class="os lq it oo b gy pa ou l ov ow">WHERE ID &gt; 100</span></pre><p id="6a58" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">对熊猫来说，可能是这样的:</p><pre class="ks kt ku kv gt on oo op oq aw or bi"><span id="9bf6" class="os lq it oo b gy ot ou l ov ow">df[df["ID"] &gt; 100]["ID"]</span></pre><p id="ed65" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">是的，两个都很简单，一个只是更直观一点。</p><ul class=""><li id="2179" class="mh mi it mj b mk nx mm ny mo oj mq ok ms ol mu om mw mx my bi translated"><strong class="mj jd">加入</strong></li></ul><p id="1e98" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">Pandas有几种连接方式，这可能有点让人不知所措，而在SQL中，您可以执行简单的连接，如下所示:<code class="fe ox oy oz oo b">INNER, LEFT, RIGHT</code></p><pre class="ks kt ku kv gt on oo op oq aw or bi"><span id="b5d7" class="os lq it oo b gy ot ou l ov ow">SELECT</span><span id="8bab" class="os lq it oo b gy pa ou l ov ow">one.column_A,</span><span id="0258" class="os lq it oo b gy pa ou l ov ow">two.column_B</span><span id="59da" class="os lq it oo b gy pa ou l ov ow">FROM FIRST_TABLE one</span><span id="268a" class="os lq it oo b gy pa ou l ov ow">INNER JOIN SECOND_TABLE two on two.ID = one.ID</span></pre><p id="5214" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">在这段代码中，join比pandas更容易阅读，在pandas中，您必须合并数据帧，尤其是当您合并两个以上的数据帧时，在pandas中会非常复杂。SQL可以执行多重连接，无论是内部连接还是其他连接。，都在同一个查询中。</p><p id="fcaa" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">所有这些例子，无论是SQL还是pandas，至少可以用于数据科学过程的探索性数据分析部分，也可以用于特征工程，以及在将模型结果存储到数据库中后对其进行查询。</p><h1 id="2eac" class="lp lq it bd lr ls ne lu lv lw nf ly lz ki ng kj mb kl nh km md ko ni kp mf mg bi translated">摘要</h1><p id="95d6" class="pw-post-body-paragraph nj nk it mj b mk ml kd nl mm mn kg nm mo nn no np mq nq nr ns ms nt nu nv mu im bi translated">pandas与SQL的这种比较更多的是个人偏好。话虽如此，你可能会觉得我的意见相反。然而，我希望它仍然揭示了pandas和SQL之间的区别，以及您可以在这两个工具中执行相同的操作，使用稍微不同的编码技术和完全不同的语言。</p><blockquote class="oc od oe"><p id="1e00" class="nj nk of mj b mk nx kd nl mm ny kg nm og nz no np oh oa nr ns oi ob nu nv mu im bi translated">总的来说，我们比较了使用pandas和SQL的好处，反之亦然，它们有一些共享的功能:</p></blockquote><pre class="ks kt ku kv gt on oo op oq aw or bi"><span id="4977" class="os lq it oo b gy ot ou l ov ow">* creating calculated fields from existing features</span><span id="1810" class="os lq it oo b gy pa ou l ov ow">* grouping by</span><span id="ed90" class="os lq it oo b gy pa ou l ov ow">* checking data types</span><span id="d099" class="os lq it oo b gy pa ou l ov ow">* WHERE clause</span><span id="6cff" class="os lq it oo b gy pa ou l ov ow">* JOINS</span></pre><p id="c1d7" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">我希望你觉得我的文章既有趣又有用。如果你同意这些比较，请在下面随意评论——为什么或为什么不同意？你认为一种工具比另一种更好吗？你能想到哪些其他数据科学工具可以进行类似的比较？pandas和SQL还有哪些功能可以比较？</p><p id="7285" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated"><em class="of">请随时查看我的个人资料和其他文章，也可以通过LinkedIn联系我。</em></p><h1 id="fa47" class="lp lq it bd lr ls ne lu lv lw nf ly lz ki ng kj mb kl nh km md ko ni kp mf mg bi translated">参考</h1><p id="c07e" class="pw-post-body-paragraph nj nk it mj b mk ml kd nl mm mn kg nm mo nn no np mq nq nr ns ms nt nu nv mu im bi translated">[1]照片由<a class="ae lh" href="https://unsplash.com/@rigels?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">参宿七</a>在<a class="ae lh" href="https://unsplash.com/s/photos/pandas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>(2019)拍摄</p><p id="5663" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">[2]照片由<a class="ae lh" href="https://unsplash.com/@kalenkempx?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">卡伦·肯普</a>在<a class="ae lh" href="https://unsplash.com/s/photos/pandas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>(2020)上拍摄</p><p id="095d" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">[3]熊猫开发小组，<a class="ae lh" href="https://pandas.pydata.org/docs/index.html" rel="noopener ugc nofollow" target="_blank">熊猫文献</a>，(2008-2021)</p><p id="6397" class="pw-post-body-paragraph nj nk it mj b mk nx kd nl mm ny kg nm mo nz no np mq oa nr ns ms ob nu nv mu im bi translated">[4]卡斯帕·卡米尔·鲁宾在<a class="ae lh" href="https://unsplash.com/s/photos/query?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片，(2017年)</p></div></div>    
</body>
</html>