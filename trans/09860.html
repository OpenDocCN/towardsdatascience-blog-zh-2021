<html>
<head>
<title>What Is The Difference Between predict() and predict_proba() in scikit-learn?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">scikit-learn中的predict()和predict_proba()有什么区别？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predict-vs-predict-proba-scikit-learn-bdc45daa5972?source=collection_archive---------0-----------------------#2021-09-16">https://towardsdatascience.com/predict-vs-predict-proba-scikit-learn-bdc45daa5972?source=collection_archive---------0-----------------------#2021-09-16</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="3985" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">如何对数据集使用<code class="fe kj kk kl km b">predict</code>和<code class="fe kj kk kl km b">predict_proba</code>方法来执行预测</h2></div><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gi gj kn"><img src="../Images/2ae357736028dbbb9e1d79fde9bc2254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AGtqIgRj5DqckRhHttJGdA.jpeg"/></div></div><p class="kz la gk gi gj lb lc bd b be z dk translated"><a class="ae ld" href="https://unsplash.com/@kimberlyfarmer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">金伯利农民</a>在<a class="ae ld" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h2 id="cd7b" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">介绍</h2><p id="fe1f" class="pw-post-body-paragraph ma mb iu mc b md me jv mf mg mh jy mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">当用<code class="fe kj kk kl km b">sklearn</code>训练模型(更精确地说是监督估值器)时，我们有时需要预测实际类别，而在其他一些场合，我们可能希望预测类别概率。</p><p id="3264" class="pw-post-body-paragraph ma mb iu mc b md mt jv mf mg mu jy mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">在今天的文章中，我们将讨论如何在数据集上使用<code class="fe kj kk kl km b">predict</code>和<code class="fe kj kk kl km b">predict_proba</code>方法来执行预测。此外，我们将探索这些方法之间的差异，并讨论何时使用其中一种方法。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="fa82" class="pw-post-body-paragraph ma mb iu mc b md mt jv mf mg mu jy mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">首先，让我们创建一个示例模型，我们将在本文中引用它来演示一些概念。在我们的示例中，我们将使用<a class="ae ld" href="https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" rel="noopener ugc nofollow" target="_blank">虹膜数据集</a>，它也包含在<code class="fe kj kk kl km b">scikit-learn</code>的<code class="fe kj kk kl km b">sklearn.datasets</code>模块中。这将是一项分类任务，我们需要根据花瓣和萼片的尺寸(长度和宽度)识别并正确预测三种不同类型的鸢尾，即刚毛鸢尾、杂色鸢尾和海滨鸢尾。</p><pre class="ko kp kq kr gu nf km ng nh aw ni bi"><span id="c6e5" class="le lf iu km b gz nj nk l nl nm">import numpy as np<br/>from sklearn import datasets<br/>from sklearn.neighbors import KNeighborsClassifier<br/></span><span id="75cf" class="le lf iu km b gz nn nk l nl nm"># Load the Iris dataset<br/>iris_X, iris_y = datasets.load_iris(return_X_y=True)</span><span id="1037" class="le lf iu km b gz nn nk l nl nm"># Split Iris dataset into train/test sets randomly<br/>np.random.seed(0)<br/>indices = np.random.permutation(len(iris_X))<br/>iris_X_train = iris_X[indices[:-10]]<br/>iris_y_train = iris_y[indices[:-10]]<br/>iris_X_test = iris_X[indices[-10:]]<br/>iris_y_test = iris_y[indices[-10:]]</span><span id="1a58" class="le lf iu km b gz nn nk l nl nm"># Instantiate and fit a KNeighbors classifier<br/>knn = KNeighborsClassifier()<br/>knn.fit(iris_X_train, iris_y_train)</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="7198" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">predict()方法</h2><p id="809f" class="pw-post-body-paragraph ma mb iu mc b md me jv mf mg mh jy mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated"><code class="fe kj kk kl km b">scikit-learn</code>中的所有监督估计器都实现了<code class="fe kj kk kl km b">predict()</code>方法，该方法可以在经过训练的模型上执行，以便<strong class="mc iv">预测一组新数据的实际标签</strong>(或类别)。</p><p id="86c4" class="pw-post-body-paragraph ma mb iu mc b md mt jv mf mg mu jy mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">该方法接受与将对其进行预测的数据相对应的单个参数，并返回包含每个数据点的预测标签的数组。</p><pre class="ko kp kq kr gu nf km ng nh aw ni bi"><span id="9130" class="le lf iu km b gz nj nk l nl nm"><strong class="km iv">predictions = knn.predict(iris_X_test)</strong></span><span id="cf42" class="le lf iu km b gz nn nk l nl nm">print(predictions)<br/><strong class="km iv"><em class="no">array([1, 2, 1, 0, 0, 0, 2, 1, 2, 0])</em></strong></span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="10c8" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">proba()方法</h2><p id="f76b" class="pw-post-body-paragraph ma mb iu mc b md me jv mf mg mh jy mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">在分类任务的上下文中，一些<code class="fe kj kk kl km b">sklearn</code>评估器也实现了<code class="fe kj kk kl km b">predict_proba</code>方法，返回每个数据点的分类概率。</p><p id="fd82" class="pw-post-body-paragraph ma mb iu mc b md mt jv mf mg mu jy mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">该方法接受与计算概率的数据相对应的单个参数，并返回包含输入数据点的类概率的列表数组。</p><pre class="ko kp kq kr gu nf km ng nh aw ni bi"><span id="c724" class="le lf iu km b gz nj nk l nl nm"><strong class="km iv">predictions = knn.predict_proba(iris_X_test)</strong></span><span id="2bc7" class="le lf iu km b gz nn nk l nl nm">print(predictions)<br/><strong class="km iv"><em class="no">array([[0. , 1. , 0. ],<br/>       [0. , 0.4, 0.6],<br/>       [0. , 1. , 0. ],<br/>       [1. , 0. , 0. ],<br/>       [1. , 0. , 0. ],<br/>       [1. , 0. , 0. ],<br/>       [0. , 0. , 1. ],<br/>       [0. , 1. , 0. ],<br/>       [0. , 0. , 1. ],<br/>       [1. , 0. , 0. ]])</em></strong></span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="8fab" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">最后的想法</h2><p id="0891" class="pw-post-body-paragraph ma mb iu mc b md me jv mf mg mh jy mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">在今天的文章中，我们讨论了如何使用预训练的<code class="fe kj kk kl km b">scikit-learn</code>模型对数据进行预测。此外，我们探讨了由<code class="fe kj kk kl km b">scikit-learn</code>的估计器实现的方法<code class="fe kj kk kl km b">predict</code>和<code class="fe kj kk kl km b">predict_proba</code>之间的主要差异。</p><p id="41d2" class="pw-post-body-paragraph ma mb iu mc b md mt jv mf mg mu jy mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated"><code class="fe kj kk kl km b">predict</code>方法用于预测实际类别，而<code class="fe kj kk kl km b">predict_proba</code>方法可用于推断类别概率(即特定数据点落入基础类别的概率)。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="e65d" class="pw-post-body-paragraph ma mb iu mc b md mt jv mf mg mu jy mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated"><a class="ae ld" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="mc iv">成为会员</strong> </a> <strong class="mc iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。</strong></p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph ma mb iu mc b md mt jv mf mg mu jy mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated"><strong class="mc iv">你可能也会喜欢</strong></p><div class="np nq gq gs nr ns"><a rel="noopener follow" target="_blank" href="/scikit-learn-vs-sklearn-6944b9dc1736"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">Scikit-Learn和Sklearn有区别吗？</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">Python中的scikit-learn vs sklearn</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kx ns"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="ko kp kq kr gu ns"><a rel="noopener follow" target="_blank" href="/fit-vs-predict-vs-fit-predict-in-python-scikit-learn-f15a34a8d39f"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">Python scikit中的fit()vs predict()vs fit _ predict()-learn</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">sklearn中的fit，predict和fit_predict方法有什么区别</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kx ns"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="ko kp kq kr gu ns"><a href="https://medium.com/geekculture/fit-vs-transform-vs-fit-transform-in-python-scikit-learn-2623d5a691e3" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">Python scikit中的fit()vs transform()vs fit _ transform()-学习</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">sklearn中的fit，transform和fit_transform方法有什么区别</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">medium.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og kx ns"/></div></div></a></div></div></div>    
</body>
</html>