<html>
<head>
<title>How to Give Your Python Code a Magic Touch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何给你的Python代码带来魔力</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-give-your-python-code-a-magic-touch-c778eeb9ac57?source=collection_archive---------4-----------------------#2021-11-02">https://towardsdatascience.com/how-to-give-your-python-code-a-magic-touch-c778eeb9ac57?source=collection_archive---------4-----------------------#2021-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="88e1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建一个强大的多项式引擎，方便学习和研究</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/e06b54adce2d7cff197baf1dffca7c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*1crsXkiFPgOsMoxMVHgzoQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片来自<a class="ae ku" href="https://commons.wikimedia.org/wiki/File:Bernoulli_polynomials_no_title.svg" rel="noopener ugc nofollow" target="_blank">维基共享资源</a></p></figure><p id="145b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在本文中，我将向您展示如何用Python构建一个学习多项式的工具。</p><p id="535a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">此外，这个工具使用起来应该很直观，感觉就像Python自带的内置类型。</p><p id="3f09" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们将使用所谓的<em class="lr">邓德方法</em>一起做这件事。</p><h1 id="e1a4" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">目录</h1><p id="9826" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated"><a class="ae ku" href="#eddb" rel="noopener ugc nofollow"> Intro </a> <br/> <a class="ae ku" href="#40c3" rel="noopener ugc nofollow">魔法方法</a><br/>∘<a class="ae ku" href="#c75e" rel="noopener ugc nofollow">_ _ str _ _</a><br/>∘<a class="ae ku" href="#9142" rel="noopener ugc nofollow">_ _ len _ _</a><br/>∘<a class="ae ku" href="#b43b" rel="noopener ugc nofollow">_ _ getitem _ _</a><br/>∘<a class="ae ku" href="#8643" rel="noopener ugc nofollow">_ _ eq _ _，__add__，__sub__，__mul__，__floordiv__ </a> <br/> <a class="ae ku" href="#e881" rel="noopener ugc nofollow">多项式作为函数</a> <br/> <a class="ae ku" href="#9554" rel="noopener ugc nofollow">零和图【图</a></p><h1 id="eddb" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">介绍</h1><p id="57ec" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">几年前，我发现了一种有趣的多项式。</p><p id="237f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我想研究它们的特性，但没有工具来适当地探索它们。有了技术武装，我将通过构建这样一个工具来进行战斗。</p><p id="7e71" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在我们构建它之前，让我们快速回顾一下Python的double-under或<em class="lr">“dunder”</em>方法。</p><h1 id="40c3" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">神奇的方法</h1><p id="2129" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">邓德方法，有时被称为<em class="lr">魔法方法</em>，是以两个下划线开始和结束的类的方法。</p><p id="33ec" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这些方法模拟了Python的内置功能，比如使用关键字<strong class="kx iu"> len </strong>、<strong class="kx iu"> + </strong>、<strong class="kx iu"> with </strong>等。</p><p id="a663" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了更好地理解这一点，让我们构建一个表示多项式并支持Python语法的类。</p><p id="4da5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">描述一个多项式所需的最少信息量是多少？是系数的问题，不是吗？</p><p id="7e82" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们尝试以下方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="54f7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们肯定需要系数，其余的只是为了展示。系数只是作为以常数项开始的类构造函数的参数给出。我们将为多项式赋予默认名称<em class="lr"> f </em>，当然我们可以在实例化对象时更改它。</p><h2 id="c75e" class="mr lt it bd lu ms mt dn ly mu mv dp mc le mw mx me li my mz mg lm na nb mi nc bi translated">__str__</h2><p id="05ab" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">说到“显示”，让我们确保用户在打印多项式时看到有用的东西。我们将在上面添加一个名为__str__的dunder方法。</p><p id="9fde" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">来自<em class="lr"> __str__ </em>方法的输出就是你打印出你的对象时所看到的。如果你的类中没有这个方法，那么你只能打印出你的类名，这可能没什么用。</p><p id="11a1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">不要太担心方法的内容，一会儿你就会看到它做了什么。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="c2ef" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，我们能够打印出我们期望看到的多项式。当然，您可以根据自己的需要进行更改，请注意，我们也有一个<em class="lr"> __repr__ </em> dunder，它属于同一个系列，但更适合开发人员而不是用户。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/8797f2baa1bbd9b047d25656706bd68e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_NQvteUzvdLv-edwq0ZfQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="a3b0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这很好，但是我们还没有真正对多项式做任何事情。为了给这个类增加一些功能，让我们编写代码来实现多项式的加、减、乘、除以及其他有趣的运算和功能。</p><h2 id="9142" class="mr lt it bd lu ms mt dn ly mu mv dp mc le mw mx me li my mz mg lm na nb mi nc bi translated">__len__</h2><p id="af3e" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">我们想这样做的方法是使用dunder方法来获得工具的直观性。具体来说，<em class="lr"> __len__ </em>方法将让我们使用内置的<strong class="kx iu"> len </strong>函数来显示多项式的某种长度。在这种情况下，我选择使用术语的数量作为度量。</p><h2 id="b43b" class="mr lt it bd lu ms mt dn ly mu mv dp mc le mw mx me li my mz mg lm na nb mi nc bi translated">__getitem__</h2><p id="ec89" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">当你分割一个列表或者获取第n个元素时，你使用list[n]语法。我们可以对多项式做同样的事情。在这种情况下，我决定我们应该得到第n个系数。</p><h2 id="8643" class="mr lt it bd lu ms mt dn ly mu mv dp mc le mw mx me li my mz mg lm na nb mi nc bi translated">_ _ eq _ _ ,_ _ add _ _ ,_ _ sub _ _ ,_ _ mul _ _ _，以及__floordiv__</h2><p id="3328" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">以上方法分别对应<strong class="kx iu">=</strong>，<strong class="kx iu"> + </strong>，<strong class="kx iu"> - </strong>，<strong class="kx iu"> * </strong>，<strong class="kx iu"> // </strong>，唯一需要说明的方法可能是<em class="lr"> __floordiv__ </em>方法，我决定实现这个方法是因为可能要做多项式除法。</p><p id="8d4a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我只返回商，而不是余数，如果它应该是非零的。我们也可以选择使用<em class="lr"> __truediv__ </em> dunder方法，但是我认为在这种情况下划分楼层更有意义。</p><p id="5beb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了更好地理解这一点，您应该亲自试验一下代码。现在，让我们将上述方法添加到我们的类中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="e881" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">多项式作为函数</h1><p id="dc96" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">我们现在有很多选择。</p><p id="5dd8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">注意，现在Python理解了如何通过使用符号<strong class="kx iu"> + </strong>来添加多项式，例如，这给了它在编写代码时更自然的感觉。毕竟，我们现在能够像写数学一样写它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/1841845550303a83ca51b91869abbd4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RKfciIITIed_OJh5BcNx2A.png"/></div></div></figure><p id="ab4a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们添加一些功能来实现差异化。</p><p id="3bdb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们将实现一个<em class="lr"> prime </em> property方法和一个更通用的n次微分方法，称为<em class="lr"> diff </em>。我们相应地更改名称，以帮助用户跟踪不同的对象。</p><p id="0120" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">因为prime也返回一个多项式对象，我们的其他方法也处理导数，使我们能够很好地打印出来，并继续处理它。</p><p id="3f83" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们还将添加一个名为<em class="lr"> negating_shift </em>的方法。</p><p id="8df4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们需要这种方法的原因与我在本文开头提到的研究有关。该方法将采用多项式<em class="lr"> f(x) </em>以及实数α，并返回相应的多项式f(α - x)。</p><p id="87a7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，如果一个多项式不能被调用，它会是什么呢？</p><p id="2731" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们需要使它成为一个<em class="lr">函数对象</em>，它应该能够像我们使用任何其他函数一样计算实数和复数。</p><p id="772b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们将所有这些也添加到模块中。</p><p id="d100" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">到目前为止的完整代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="448d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在我们可以用一个简单的方法来区分<em class="lr"> n </em>次。还要注意，现在我们可以像调用多项式所代表的函数一样调用它们了！</p><p id="cc06" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这要感谢<em class="lr"> __call__ </em> dunder方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/efb1fbdee86e0317ad590544dd3caeac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ilwadQ2H9w9P3LALLm-cmA.png"/></div></div></figure><h1 id="9554" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">零和图</h1><p id="1038" class="pw-post-body-paragraph kv kw it kx b ky mk ju la lb ml jx ld le mm lg lh li mn lk ll lm mo lo lp lq im bi translated">我们肯定希望能够找到根，我们也希望能够显示多项式的图形，现在我们有了根，我们也可以找到函数的局部最小值和最大值。</p><p id="1a3b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">能够显示根在复平面中的位置也是有用的。</p><p id="840d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">因此，我们也可以为此添加方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="f6d9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">请注意，我们可以更改作为参数的轴的大小。这在某些时候可能会很方便。</p><p id="bada" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在我们可以得到根或零，也可以得到漂亮的显示和图形。我们在下面看到，单位的<em class="lr"> 5 </em>根在复平面上构成一个五角星。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/ce3d78887bb6ee7a10d18b8c1d8872b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tHYt12rnvLN1ZIQC7vRM3Q.png"/></div></div></figure><p id="c1c2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">显示屏上的点是多项式的复数零点。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="915e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">到目前为止，我们已经有了很多不错的Pythonic功能。我将在未来添加更多的像判别式，因式分解等。在此期间，是时候学习我最初想学习的多项式类了。</p><p id="3b7c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这将是一篇单独的文章，因为这篇文章会变得太长。</p><p id="80a2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">您可以在这里获得完整的代码:</p><div class="np nq gp gr nr ns"><a href="https://github.com/KRBM/PolynomialEngine/" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">GitHub-KRBM/多项式引擎</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">通过多项式的系数来指定多项式:我们可以分别用+和-来加减多项式，p.zeros给出…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">github.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og ko ns"/></div></div></a></div><p id="b894" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果您有任何问题、意见或顾虑，请联系LinkedIn:</p><div class="np nq gp gr nr ns"><a href="https://www.linkedin.com/in/kasper-m%C3%BCller-96ba95169/" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">Kasper Müller -高级顾问，数据和分析，金融服务，技术咨询- EY | LinkedIn</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">编程、数学和教学是我最大的兴趣。数据科学、机器学习、编程…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">www.linkedin.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og ko ns"/></div></div></a></div></div></div>    
</body>
</html>