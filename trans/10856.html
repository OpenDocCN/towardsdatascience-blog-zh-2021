<html>
<head>
<title>Is dbt the Future of Analytics?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">dbt是分析的未来吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/is-dbt-the-future-of-analytics-d6ff93cbb20c?source=collection_archive---------5-----------------------#2021-10-21">https://towardsdatascience.com/is-dbt-the-future-of-analytics-d6ff93cbb20c?source=collection_archive---------5-----------------------#2021-10-21</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><div class=""><h2 id="b77f" class="pw-subtitle-paragraph js iu iv bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">该工具如何改变数据分析师的工作方式</h2></div><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/73d70b9e04b4ab8c1dd81ffa1458ae2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*An-yFGrhzXxF1ZoX5kDfKw.jpeg"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated"><a class="ae la" href="https://unsplash.com/@tomparkes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">汤姆·帕克斯</a>在<a class="ae la" href="https://unsplash.com/s/photos/future?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="bd4a" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">如果你听说过一个分析工程师或者了解数据建模，那么你可能对<a class="ae la" href="https://www.getdbt.com/" rel="noopener ugc nofollow" target="_blank"> dbt </a>很熟悉(如果你不熟悉，在这里阅读什么是<a class="ae la" rel="noopener" target="_blank" href="/what-is-dbt-a0d91109f7d0"/>)。它现在是非常热门的工具，因为它让数据团队的生活变得更加轻松！这不正是我们都希望在工具中实现的吗？</p><p id="2bd6" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我第一次接触dbt是在两年前，当时我是一名数据工程师。我不知道它是什么，也不知道如何正确使用它。我阅读了大量的文档，老实说，我仍然很困惑。直到我把这个工具付诸行动，我才真正看到它的价值。</p><p id="9462" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">由于我在一个工程团队，我们实际上根本不关注分析。这是一个支持我们业务财务方面的工程团队。我们使用dbt来编译和测试我们的SQL代码，使得它比我们期望使用的内部平台运行起来要快得多。</p><p id="5e65" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">因此，虽然我已经使用dbt很多年了，但我从未将它用于分析目的，直到我最近的角色。我们选择将其实现到由其他新工具组成的数据堆栈中，如<a class="ae la" href="https://fivetran.com/" rel="noopener ugc nofollow" target="_blank"> Fivetran </a>、<a class="ae la" href="https://www.snowflake.com/" rel="noopener ugc nofollow" target="_blank">雪花</a>和<a class="ae la" href="https://www.prefect.io/" rel="noopener ugc nofollow" target="_blank">提督</a>。</p><p id="13e3" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在新的数据堆栈中一起使用这些工具，我们的数据文化已经开始转变。我们已经看到了数据质量、模型运行速度和使用文档的巨大改进。Dbt将在分析领域长期存在，原因如下。</p><h2 id="7321" class="lx ly iv bd lz ma mb dn mc md me dp mf lk mg mh mi lo mj mk ml ls mm mn mo mp bi translated">数据质量</h2><p id="6abb" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">dbt最棒的地方在于，它消除了反复重写相同代码的需要。您可以编写一个模型，然后在其他模型中引用它。这创建了更可靠的代码，因为您在所有模型中使用了相同的逻辑。</p><p id="af09" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">这在分析中派上用场的方法之一是通过您公司的关键绩效指标。我们有一种方法来定义和计算它。通常，如果这个KPI在许多不同的模型中被不同地计算，就有很多事情出错的空间。</p><p id="2a58" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">Dbt通过使我们的代码模块化来提供帮助。我们可以简单地重用而不是重新编码！这不仅提高了数据质量，还为我们分析师节省了大量宝贵的时间。</p><p id="1492" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">dbt提高数据质量的另一种方式是鼓励直接在源代码中进行转换和重命名。你可以在他们的文档<a class="ae la" href="https://discourse.getdbt.com/t/how-we-structure-our-dbt-projects/355" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多。但是，本质上，您在基本模型中完成了所有较小的数据“管理”任务。这些是直接从原始源表中选择的模型。</p><p id="ee21" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">然后，您的其他模型只引用这些基础模型，而不是任何原始数据。这可以防止错误，比如意外地将日期转换为两种不同类型的时间戳(是的，我以前也遇到过这种情况)，或者给同一列取两个不同的名称。</p><p id="1f1c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">这些类型的问题很简单，但当您深入编写数据模型时，可能是最难弄清楚的。两种不同的时间戳转换导致所有的日期在下游被不正确地连接，将模型变成了一场巨大的灾难。幸运的是，我们能够在投入生产之前发现并修复这个问题。</p><h2 id="9cca" class="lx ly iv bd lz ma mb dn mc md me dp mf lk mg mh mi lo mj mk ml ls mm mn mo mp bi translated">速度</h2><p id="2b10" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">如果您正在使用dbt之外的另一种转换工具，那么您可能理解对速度的需求。我见过运行时间超过8小时的数据模型！很抱歉，如果您的数据模型需要那么长时间才能运行，那么您就不可能拥有高效的分析工作流。</p><p id="9c21" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">Dbt使您能够将代码组织成基本数据模型和中间数据模型，从而大大加快核心数据模型的运行速度。因为您的模型也是模块化的，所以您运行它们一次，并在您的其他模型中引用它们。您不会浪费时间和资源一遍又一遍地运行相同的代码块。</p><p id="b707" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">Dbt模型在使用<code class="fe mv mw mx my b">dbt run</code>命令执行时也是并行运行的。有依赖关系的模型在它们的上游模型完成之前不会运行，但是相互不依赖的模型会同时运行。这增加了吞吐量，并最大限度地减少了运行时间。</p><p id="3efc" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">模型通过使用一种叫做“多线程”的技术并行运行。不同的模型在不同的线程上处理，允许它们一起执行。当你在你的<code class="fe mv mw mx my b">dbt_project.yml</code>文件中看到<code class="fe mv mw mx my b">thread: 300</code>时，那只是指你允许同时运行多少个模型。</p><h2 id="1d10" class="lx ly iv bd lz ma mb dn mc md me dp mf lk mg mh mi lo mj mk ml ls mm mn mo mp bi translated">证明文件</h2><p id="8c02" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">在分析和数据建模领域，文档是最被低估的优势之一。你的数据的有用程度取决于它被记录的程度。它不仅使新团队成员成功入职的速度提高了三倍，还让团队中的每个人对数据有了更深入的理解。</p><p id="4780" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">如果你正确地进行分析，你会不断地问关于你的数据的问题。当提出问题时，dbt文档可以提供答案。即使已经在公司工作多年的人也不得不偶尔参考数据定义。数据上的数据永远不嫌多。美国数据迷喜欢一些好的元数据。</p><p id="8730" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">Dbt <a class="ae la" href="https://docs.getdbt.com/docs/building-a-dbt-project/documentation" rel="noopener ugc nofollow" target="_blank">允许</a>你将模型的描述直接添加到代码中。这也使得跟踪列名和描述变得容易。这个文档被写在一个与你的模型存储目录相对应的<code class="fe mv mw mx my b">.yml</code>中。</p><p id="160d" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">然后，这些<code class="fe mv mw mx my b">.yml</code>文件可以用来围绕所有dbt文档生成一个网站。Dbt通过向用户提供<code class="fe mv mw mx my b">dbt docs</code>命令使这变得非常容易。您只需在命令行上运行以下命令:</p><ol class=""><li id="5dd4" class="mz na iv ld b le lf lh li lk nb lo nc ls nd lw ne nf ng nh bi translated"><code class="fe mv mw mx my b">dbt docs generate</code></li><li id="6077" class="mz na iv ld b le ni lh nj lk nk lo nl ls nm lw ne nf ng nh bi translated"><code class="fe mv mw mx my b">dbt docs serve</code></li></ol><p id="8458" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">运行这两个命令后，将会填充一个本地网站供您查看。通常，您只需导航到localhost:8080，就可以看到易读格式的文档。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nn"><img src="../Images/6aa1391a211816d108e1aa52d7780766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xn3o7SBakX5qcFWLks4DCQ.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">dbt实验室在<a class="ae la" href="https://docs.getdbt.com/docs/building-a-dbt-project/documentation" rel="noopener ugc nofollow" target="_blank"> dbt </a>上拍摄的照片</p></figure><p id="1fe1" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">这是一个网站看起来像什么的例子。您可以在左侧看到您的项目和数据库，它们的组织方式与您在代码环境中看到的类似。当您单击一个模型时，您可以阅读描述并查看该模型中各列的信息。</p><p id="2d27" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">dbt文档中我最喜欢的特性可能是谱系图(也称为<a class="ae la" href="https://medium.com/geekculture/what-is-a-dag-4dc24bcf14fa" rel="noopener"> DAG </a>)。这类似于您在编排网站上看到的内容。它提供了一个模型之间相互依赖的很好的视觉效果。通过查看这里，您可以很容易地看到您所有的核心模型都使用了哪些基础模型和中间模型。</p><p id="8488" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">如果您想在您的公司内部使用该文档，我建议您将该网站托管在公司内部网站上，或者使用像<a class="ae la" href="https://www.netlify.com/?utm_source=google&amp;utm_medium=paid_search&amp;utm_campaign=12755510784&amp;adgroup=118788138897&amp;utm_term=netlify&amp;utm_content=kwd-371509120223&amp;creative=516906172749&amp;device=c&amp;matchtype=e&amp;location=9007390&amp;gclid=Cj0KCQjwtrSLBhCLARIsACh6RmjoG9BdTmxFP7TTt40bg-ukkCbZzyu-h6ca7B5ZKyw5HzW-Th7m_-gaAh3tEALw_wcB" rel="noopener ugc nofollow" target="_blank"> Netlify </a>这样的解决方案。您每月为每个用户支付19美元，并且您的所有数据模型都有一个很好的真实来源。</p><h2 id="4ef4" class="lx ly iv bd lz ma mb dn mc md me dp mf lk mg mh mi lo mj mk ml ls mm mn mo mp bi translated">结论</h2><p id="7d26" class="pw-post-body-paragraph lb lc iv ld b le mq jw lg lh mr jz lj lk ms lm ln lo mt lq lr ls mu lu lv lw io bi translated">Dbt正在帮助公司采取下一步措施，成为数据驱动的文化。它正在改变现代数据堆栈的理念，将所有其他的转换工具打得落花流水。Dbt将继续成为公司提高数据质量、速度和文档化的重要手段。</p><p id="3b3c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">Dbt不会很快消失。它是一种工具，将一直存在。我强烈建议学习它，并将其融入到您团队的数据文化中。你越早开始整合它，你就能从它身上学到越多，并允许它对你如何使用数据做出不可思议的改变。</p><p id="83c4" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated"><a class="ae la" href="https://mailchi.mp/e04817c8e57e/learn-analytics-engineering" rel="noopener ugc nofollow" target="_blank">通过订阅我的电子邮件列表，了解更多关于dbt和其他流行的现代数据堆栈工具的信息</a>。</p></div></div>    
</body>
</html>