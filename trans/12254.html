<html>
<head>
<title>Feature selection in Scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Scikit-learnä¸­çš„åŠŸèƒ½é€‰æ‹©</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/feature-selection-in-scikit-learn-dc005dcf38b7?source=collection_archive---------14-----------------------#2021-12-13">https://towardsdatascience.com/feature-selection-in-scikit-learn-dc005dcf38b7?source=collection_archive---------14-----------------------#2021-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/cafdb4d53c4fbc45db5b06163b3e761b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PrHExWptvaFD2Zy8"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">ç”±<a class="ae jg" href="https://unsplash.com/@mattpaul?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">é©¬ç‰¹Â·ä¿ç½—Â·å¡å¡”æ‹‰è¯º</a>åœ¨<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><h2 id="bc25" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">Pythonä¸­çš„æœºå™¨å­¦ä¹ </h2><div class=""/><div class=""><h2 id="1011" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">è¿‡æ»¤ç‰¹å¾çš„ç®€å•æ–¹æ³•ï¼Œä»¥è·å¾—æ›´ç®€å•ã€æ›´å¿«é€Ÿçš„æ¨¡å‹</h2></div><p id="d96d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">å½“å»ºç«‹ç›‘ç£æœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬æ”¶é›†å¯¹é¢„æµ‹ç»“æœæ½œåœ¨æœ‰ç”¨çš„ç‰¹å¾ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç‰¹æ€§éƒ½æœ‰åŠ©äºæ„å»ºæ¨¡å‹ã€‚è¿‡æ»¤æ‰ä¸å¯é¢„æµ‹çš„ç‰¹å¾å¹¶ä¿æŒæ¨¡å‹çš„ç²¾ç®€æ€§é€šå¸¸æ˜¯å¯è¡Œçš„ï¼Œè¿™æ ·æ¨¡å‹æ›´å¿«ï¼Œæ›´å®¹æ˜“å‘åˆ©ç›Šç›¸å…³è€…è§£é‡Šï¼Œå¹¶ä¸”æ›´å®¹æ˜“ç”Ÿäº§ã€‚åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä¸€äº›ç®€å•çš„æ–¹æ³•æ¥å‰”é™¤å¯¹é¢„æµ‹ç»“æœæ²¡æœ‰å¸®åŠ©çš„ç‰¹å¾ï¼Œå¹¶é€‰æ‹©è´¡çŒ®æ›´å¤§çš„ç‰¹å¾ã€‚</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi md"><img src="../Images/d2651c11d0a156d69721d5404c9a8938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NbOr43AtZ7MCh16b"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae jg" href="https://unsplash.com/@timmarshall?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">è’‚å§†Â·é©¬æ­‡å°”</a>åœ¨<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„</p></figure></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="2edd" class="mp mq jj bd mr ms mt mu mv mw mx my mz ky na kz nb lb nc lc nd le ne lf nf ng bi translated">ğŸ“¦ 1.æ•°æ®</h1><p id="fad0" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">è®©æˆ‘ä»¬é¦–å…ˆåŠ è½½å¿…è¦çš„åº“ï¼Œå¯¼å…¥ä¸€ä¸ªæ ·æœ¬ç©å…·æ•°æ®ï¼Œå¹¶å°†å…¶åˆ’åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="f83f" class="nr mq jj nn b gy ns nt l nu nv">import pandas as pd<br/>pd.options.display.max_rows = 20<br/># Used Scikit-learn version 1.0.1<br/>from sklearn.datasets import load_breast_cancer<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.ensemble import GradientBoostingClassifier<br/>from sklearn.feature_selection import (RFE, SelectKBest, <br/>                                       SelectPercentile)<br/>from sklearn.metrics import roc_auc_score</span><span id="b2fc" class="nr mq jj nn b gy nw nt l nu nv"># Load data<br/>cancer = load_breast_cancer(as_frame=True)<br/>X = cancer['data']<br/>print(f"Features shape: {X.shape}")<br/>y = cancer['target']<br/>print(f"Target shape: {y.shape}\n")</span><span id="4488" class="nr mq jj nn b gy nw nt l nu nv"># Partition data<br/>X_train, X_test, y_train, y_test = train_test_split(<br/>    X, y, test_size=0.2, random_state=42<br/>)<br/>print(f"Training data - Features shape: {X_train.shape}")<br/>print(f"Training data - Target shape: {y_train.shape}\n")<br/>print(f"Test data - Features shape: {X_test.shape}")<br/>print(f"Test data - Target shape: {y_test.shape}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/64c4fafe3907b2e1d04291ef2dfcc8d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*Ux81vnm2NEIqcMSUVHBRJA.png"/></div></figure><p id="48b7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æˆ‘ä»¬å°†ä½¿ç”¨æœ‰30ä¸ªç‰¹å¾çš„ä¹³è…ºç™Œæ•°æ®ã€‚</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="483a" class="mp mq jj bd mr ms mt mu mv mw mx my mz ky na kz nb lb nc lc nd le ne lf nf ng bi translated">ğŸ’» 2.åŸºçº¿æ¨¡å‹</h1><p id="6413" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">æˆ‘ä»¬å°†ä½¿ç”¨ROC AUC(ä»è¿™é‡Œå¼€å§‹çš„AUC)æ¥è¯„ä¼°æ¨¡å‹ã€‚è®©æˆ‘ä»¬é€šè¿‡ä½¿ç”¨æ‰€æœ‰ç‰¹æ€§æ„å»ºä¸€ä¸ªç®€å•çš„æ¨¡å‹æ¥äº†è§£åŸºå‡†æ€§èƒ½:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="b6af" class="nr mq jj nn b gy ns nt l nu nv">model0 = GradientBoostingClassifier(random_state=42)<br/>model0.fit(X_train, y_train)</span><span id="f0c3" class="nr mq jj nn b gy nw nt l nu nv">def get_roc_auc(model, X, y):<br/>    y_proba = model.predict_proba(X)[:,1]<br/>    return roc_auc_score(y, y_proba)</span><span id="794d" class="nr mq jj nn b gy nw nt l nu nv">print(f"Training data - ROC AUC: {get_roc_auc(model0, X_train, y_train):.4f}")<br/>print(f"Test data - ROC AUC: {get_roc_auc(model0, X_test, y_test):.4f}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/dd07bdec83aede02e20b78fbf2d4e2f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*y7Ev9zuEzHzUKYeD6fuCKw.png"/></div></figure><p id="363b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æµ‹è¯•æ•°æ®é›†çš„AUCä¸º0.9951ã€‚</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h1 id="d737" class="mp mq jj bd mr ms mt mu mv mw mx my mz ky na kz nb lb nc lc nd le ne lf nf ng bi translated">ğŸ“ 3.ç‰¹å¾é€‰æ‹©</h1><p id="9831" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">æˆ‘ä»¬å°†ç€çœ¼äºäº”ç§ä¸åŒçš„æ–¹æ³•æ¥ä¸ºæœ‰ç›‘ç£çš„æœºå™¨å­¦ä¹ é—®é¢˜è¿›è¡Œç‰¹å¾é€‰æ‹©ã€‚</p><h2 id="1680" class="nr mq jj bd mr nz oa dn mv ob oc dp mz lq od oe nb lu of og nd ly oh oi nf jp bi translated">ğŸ“ 3.1.ä»è¦ç´ é‡è¦æ€§ä¸­è¿‡æ»¤</h2><p id="0adf" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">è¦ç´ é‡è¦æ€§æ˜¾ç¤ºäº†æ¯ä¸ªè¦ç´ å¯¹é¢„æµ‹çš„è´¡çŒ®ç¨‹åº¦ã€‚è¿›è¡Œç‰¹å¾é€‰æ‹©çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯åˆ é™¤å¯¹æ¨¡å‹è´¡çŒ®ä¸å¤§çš„ç‰¹å¾ã€‚</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="c8a2" class="nr mq jj nn b gy ns nt l nu nv">imp = pd.DataFrame(model0.feature_importances_, index=X.columns, <br/>                   columns=['importance'])\<br/>        .sort_values('importance', ascending=False)<br/>imp</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/691005fb944bac8ff4728415728e435d.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*vTQIHZmFJwsXTHoHvbLTVw.png"/></div></figure><p id="c025" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">é€šè¿‡ä½¿ç”¨é˜ˆå€¼0.01ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©é‡è¦æ€§è¶…è¿‡é˜ˆå€¼çš„ç‰¹å¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æˆ–è€…ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å¯»æ‰¾å‰nä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åƒè¿™æ ·è°ƒæ•´è¯­æ³•:<code class="fe ok ol om nn b">imp[â€˜importanceâ€™].head(n).index</code>ã€‚</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="19cd" class="nr mq jj nn b gy ns nt l nu nv">imp_features = imp[imp['importance']&gt;0.01].index <br/>print(f"===== {len(imp_features)} features were selected =====")<br/>print(f"{', '.join(imp_features)}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/c83f7400a0efa033755ec51e7115d898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*qfreohebIlLWGOTbPCFRVw.png"/></div></figure><p id="acb4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">10ä¸ªç‰¹å¾é«˜äºé˜ˆå€¼ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™10ä¸ªç‰¹å¾ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥æ¨¡å‹çš„æ€§èƒ½:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="bc04" class="nr mq jj nn b gy ns nt l nu nv">model1 = GradientBoostingClassifier(random_state=42)<br/>model1.fit(X_train[imp_features], y_train)</span><span id="c3f3" class="nr mq jj nn b gy nw nt l nu nv">print(f"Training data - ROC AUC: {get_roc_auc(model1, X_train[imp_features], y_train):.4f}")<br/>print(f"Test data - ROC AUC: {get_roc_auc(model1, X_test[imp_features], y_test):.4f}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/8437dc599071df200d8aa06264357bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*7uxSUpZuP3pe4EeNso6N-Q.png"/></div></figure><p id="f79a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">å³ä½¿æˆ‘ä»¬åªä½¿ç”¨äº†ä¸‰åˆ†ä¹‹ä¸€çš„åŠŸèƒ½ï¼Œæ¨¡å‹æ€§èƒ½ä¹Ÿæ²¡æœ‰æ˜¾è‘—ä¸‹é™ã€‚</p><h2 id="6c28" class="nr mq jj bd mr nz oa dn mv ob oc dp mz lq od oe nb lu of og nd ly oh oi nf jp bi translated">ğŸ“3.2.ä½¿ç”¨é€’å½’ç‰¹å¾æ¶ˆé™¤</h2><p id="1dd1" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">åœ¨é€’å½’ç‰¹å¾æ¶ˆé™¤ä¸­ï¼Œæˆ‘ä»¬ä»æ‰€æœ‰ç‰¹å¾å¼€å§‹ï¼Œç„¶åæ¯æ¬¡é€’å½’åœ°ä¸¢å¼ƒæœ€ä¸é‡è¦çš„ç‰¹å¾(<code class="fe ok ol om nn b">step=1</code>)ï¼Œç›´åˆ°æ»¡è¶³ä¸€ä¸ªæ ‡å‡†ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªæ ‡å‡†æ¥ä¿ç•™10ä¸ªç‰¹å¾ã€‚</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="e20a" class="nr mq jj nn b gy ns nt l nu nv">rfe = RFE(GradientBoostingClassifier(random_state=42), <br/>          n_features_to_select=10)<br/>rfe.fit(X_train, y_train)</span><span id="7021" class="nr mq jj nn b gy nw nt l nu nv">rfe_features = X_train.columns[rfe.support_]<br/>print(f"===== {len(rfe_features)} features were selected =====")<br/>print(f"{', '.join(rfe_features)}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/9864fb6d35880844b86bcdbc20cf524a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*lP-DPPvKfL4vlHHAKBt7vQ.png"/></div></figure><p id="f7f9" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">è®©æˆ‘ä»¬ä½¿ç”¨é€‰å®šçš„åŠŸèƒ½è¿è¡Œæ¨¡å‹ï¼Œå¹¶æ£€æŸ¥å…¶æ€§èƒ½:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="2702" class="nr mq jj nn b gy ns nt l nu nv">model2 = GradientBoostingClassifier(random_state=42)<br/>model2.fit(X_train[rfe_features], y_train)</span><span id="bae2" class="nr mq jj nn b gy nw nt l nu nv">print(f"Training data - ROC AUC: {get_roc_auc(model2, X_train[rfe_features], y_train):.4f}")<br/>print(f"Test data - ROC AUC: {get_roc_auc(model2, X_test[rfe_features], y_test):.4f}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/f92eb4da4a0e51790d968016a76fd748.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*wLFRY9MejfhSS2zyRGK8tA.png"/></div></figure><p id="6e3e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æ€§èƒ½å’Œä»¥å‰ä¸€æ¨¡ä¸€æ ·ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ç§æ–¹æ³•æ˜¯å¦é€‰æ‹©äº†ä¸ä»¥å‰ç›¸åŒçš„åŠŸèƒ½:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="8592" class="nr mq jj nn b gy ns nt l nu nv">imp_features.sort_values().equals(rfe_features.sort_values())</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/d8eaa03ff936719afe599f772c975191.png" data-original-src="https://miro.medium.com/v2/resize:fit:114/format:webp/1*mIzpB48FKXpRK0CblU7OHA.png"/></div></figure><p id="b94e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æ˜¯çš„ï¼Œå®ƒåšåˆ°äº†ï¼è¿™å¹¶ä¸å¥‡æ€ªï¼Œå› ä¸ºä¸¤è€…éƒ½æ˜¯åŸºäºæ¢¯åº¦æ¨è¿›åˆ†ç±»å™¨çš„ç‰¹å¾é‡è¦æ€§ã€‚è¿™ç§æ–¹æ³•ä¹Ÿé€‚ç”¨äºæä¾›ç‰¹å¾é‡è¦æ€§æˆ–ç³»æ•°çš„å…¶ä»–ç®—æ³•ã€‚ä½¿ç”¨ç³»æ•°æ—¶ï¼Œè¯·è®°ä½è¦ç´ çš„æ¯”ä¾‹ä¼šå½±å“ç³»æ•°ã€‚</p><p id="d3c1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">è¿™ç§æ–¹æ³•æ¯”å‰ä¸€ç§æ–¹æ³•æ…¢ï¼Œå› ä¸ºå®ƒéœ€è¦å¤šæ¬¡è¿è¡Œæ¨¡å‹ã€‚åŠ å¿«é€Ÿåº¦çš„ä¸€ä¸ªæ–¹æ³•æ˜¯å¢åŠ <code class="fe ok ol om nn b">step</code>çš„å¤§å°ï¼Œè¿™æ ·å®ƒå¯ä»¥æ›´å¿«åœ°æ¶ˆé™¤ç‰¹å¾ã€‚</p><h2 id="23df" class="nr mq jj bd mr nz oa dn mv ob oc dp mz lq od oe nb lu of og nd ly oh oi nf jp bi translated">ğŸ“ 3.ç”¨SelectKBesté€‰æ‹©å‰nå</h2><p id="f4c1" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">ä¸å‰ä¸¤ç§æ–¹æ³•ä¸åŒï¼Œè¿™ç§æ–¹æ³•å’Œæ¥ä¸‹æ¥çš„æ–¹æ³•æ˜¯æ¨¡å‹ä¸å¯çŸ¥çš„ã€‚æˆ‘ä»¬å°†æ ¹æ®åˆ†æ•°é€‰æ‹©10ä¸ªæœ€ä½³åŠŸèƒ½ã€‚<a class="ae jg" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.f_classif.html#sklearn.feature_selection.f_classif" rel="noopener ugc nofollow" target="_blank"> Få€¼</a>è¢«ç”¨ä½œåˆ†ç±»çš„é»˜è®¤åˆ†æ•°ï¼Œç„¶è€Œï¼Œå¯ä»¥ä½¿ç”¨<a class="ae jg" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html" rel="noopener ugc nofollow" target="_blank">ä¸åŒçš„åˆ†æ•°</a>ã€‚</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="0a59" class="nr mq jj nn b gy ns nt l nu nv">kbest = SelectKBest(k=10)<br/>kbest.fit(X_train, y_train)</span><span id="7e4d" class="nr mq jj nn b gy nw nt l nu nv"># See selected features<br/>kbest_features = X_train.columns[kbest.get_support()]<br/>print(f"===== {len(kbest_features)} features were selected =====")<br/>print(f"{', '.join(kbest_features)}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/3fc2fc96d688998d41bbef6b7640e30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*hJc66sOk4LISYFH2rheIuw.png"/></div></figure><p id="019c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">ç°åœ¨ï¼Œè¯¥ç”¨æ–°é€‰æ‹©çš„ç‰¹æ€§å†æ¬¡è¿è¡Œæ¨¡å‹äº†:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="3ef7" class="nr mq jj nn b gy ns nt l nu nv">model3 = GradientBoostingClassifier(random_state=42)<br/>model3.fit(X_train[kbest_features], y_train)</span><span id="bfa4" class="nr mq jj nn b gy nw nt l nu nv">print(f"Training data - ROC AUC: {get_roc_auc(model3, X_train[kbest_features], y_train):.4f}")<br/>print(f"Test data - ROC AUC: {get_roc_auc(model3, X_test[kbest_features], y_test):.4f}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/c43768696d42c4155b8e44cd2c2ff757.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*KhsQLcpjEPc9ED_Kwda4gQ.png"/></div></figure><p id="1e58" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æ¨¡å‹æ€§èƒ½ä¸ä»¥å‰çš„æ–¹æ³•ç›¸ä¼¼ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹é€‰æ‹©äº†å“ªäº›ä¹‹å‰æ²¡æœ‰é€‰æ‹©çš„åŠŸèƒ½:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="8ffb" class="nr mq jj nn b gy ns nt l nu nv">[var for var in kbest_features if var not in rfe_features]</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/1345ac211094c0ed39119346a62ca63e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*-i2x6nFE8EoszJ2tu-0k0w.png"/></div></figure><h2 id="d48f" class="nr mq jj bd mr nz oa dn mv ob oc dp mz lq od oe nb lu of og nd ly oh oi nf jp bi translated">ğŸ“ 4.ä½¿ç”¨SelectPercentileé€‰æ‹©å‰pä¸ªç™¾åˆ†ç‚¹</h2><p id="5bfe" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">è¿™æ˜¯å‰ä¸€ç§æ–¹æ³•çš„å˜ä½“ï¼Œå®ƒå…è®¸æŒ‡å®šè¦é€‰æ‹©çš„åŠŸèƒ½çš„ç™¾åˆ†æ¯”ï¼Œè€Œä¸æ˜¯åŠŸèƒ½çš„æ•°é‡ã€‚æˆ‘ä»¬å°†é€‰æ‹©å‰33%çš„åŠŸèƒ½æ¥è·å¾—å‰10ä¸ªåŠŸèƒ½:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="96b1" class="nr mq jj nn b gy ns nt l nu nv">percentile = SelectPercentile(percentile=33)<br/>percentile.fit(X_train, y_train)</span><span id="9b0b" class="nr mq jj nn b gy nw nt l nu nv"># See selected features<br/>percentile_features = X_train.columns[percentile.get_support()]<br/>print(f"===== {len(percentile_features)} features were selected =====")<br/>print(f"{', '.join(percentile_features)}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a0645b02a795e39557323de4b01dc08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*YCcCpsprRrv5kh11HbE9_A.png"/></div></figure><p id="9d50" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥æ¨¡å‹æ€§èƒ½:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="e417" class="nr mq jj nn b gy ns nt l nu nv">model4 = GradientBoostingClassifier(random_state=42)<br/>model4.fit(X_train[percentile_features], y_train)</span><span id="7c23" class="nr mq jj nn b gy nw nt l nu nv">print(f"Training data - ROC AUC: {get_roc_auc(model4, X_train[percentile_features], y_train):.4f}")<br/>print(f"Test data - ROC AUC: {get_roc_auc(model4, X_test[percentile_features], y_test):.4f}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/3a31dc41c1bd992106caa310dc2eafb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*sC5w_KP8-qQWzM8peXsEfw.png"/></div></figure><p id="c9cd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æ€§èƒ½å’Œä»¥å‰ä¸€æ ·ã€‚è®©æˆ‘ä»¬çœ‹çœ‹åŠŸèƒ½æ˜¯å¦ä¸å‰é¢çš„æ–¹æ³•ç›¸åŒ:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="74a6" class="nr mq jj nn b gy ns nt l nu nv">percentile_features.sort_values().equals(kbest_features.sort_values())</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/c20e6aa1b7b2b6ddcb0ce08679a5da28.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/format:webp/1*ocB-7lky3OwJAyWEPiIc0Q.png"/></div></figure><p id="f49d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">è¿™æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºæˆ‘ä»¬é€‰æ‹©äº†ç™¾åˆ†ç‚¹å€¼æ¥è·å¾—ä¸ä»¥å‰ç›¸åŒæ•°é‡çš„ç‰¹å¾ã€‚</p><h2 id="3764" class="nr mq jj bd mr nz oa dn mv ob oc dp mz lq od oe nb lu of og nd ly oh oi nf jp bi translated">ğŸ“ 5.ç»“åˆå¤šç§æ–¹æ³•</h2><p id="4334" class="pw-post-body-paragraph lh li jj lj b lk nh kt lm ln ni kw lp lq nj ls lt lu nk lw lx ly nl ma mb mc im bi translated">å¦‚æœä½ ä¸æƒ³åªä½¿ç”¨ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºå¤šç§æ–¹æ³•çš„ç»„åˆæ¥è¿›è¡Œç‰¹å¾é€‰æ‹©ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹æ‰€æœ‰æ–¹æ³•çš„æ€»ç»“:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="80b6" class="nr mq jj nn b gy ns nt l nu nv">selection = pd.DataFrame(index=X.columns)<br/>selection['imp'] = [var in imp_features for var in X.columns]<br/>selection['rfe'] = rfe.support_<br/>selection['kbest'] = kbest.get_support()<br/>selection['percentile'] = percentile.get_support()<br/>selection['sum'] = selection.sum(axis=1)<br/>selection.sort_values('sum', ascending=False, inplace=True)<br/>selection</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/59aa6175abf986ea578469923e50a7f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*eT5nZja_0aK_9gEXIBx9IA.png"/></div></figure><p id="6698" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹<code class="fe ok ol om nn b">sum</code>åˆ—çš„åˆ†å¸ƒ:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="8137" class="nr mq jj nn b gy ns nt l nu nv">pd.concat([selection['sum'].value_counts(normalize=True),<br/>           selection['sum'].value_counts()], axis=1, <br/>          keys=['prop', 'count'])</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/e941a5e622ca4230773d77257995c382.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*a3zZusCaVTaOaX1IoI6yhA.png"/></div></figure><p id="d940" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">è¯¥è¡¨å‘Šè¯‰æˆ‘ä»¬ï¼Œ16ä¸ªç‰¹å¾æ²¡æœ‰è¢«ä»»ä½•æ–¹æ³•é€‰æ‹©ï¼Œ6ä¸ªç‰¹å¾è¢«æ‰€æœ‰æ–¹æ³•é€‰æ‹©ã€‚ç”±äº<code class="fe ok ol om nn b">imp_features</code>å’Œ<code class="fe ok ol om nn b">rfe_features</code>æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”<code class="fe ok ol om nn b">kbest_features</code>å’Œ<code class="fe ok ol om nn b">percentile_features</code>åŒ…å«ç›¸åŒçš„ç‰¹å¾ï¼Œæ‰€ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨è¿™é‡Œåªçœ‹åˆ°å¶æ•°å€¼:0ï¼Œ2ï¼Œ4ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨èšåˆä¸¤ç§æ–¹æ³•ã€‚</p><p id="edde" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">å¦‚æœæˆ‘ä»¬æƒ³æ›´åŠ å°å¿ƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤åœ¨ä¸¤ç§æ–¹æ³•ä¸­éƒ½æ²¡æœ‰é€‰æ‹©çš„ç‰¹æ€§:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="c152" class="nr mq jj nn b gy ns nt l nu nv">selected_features = selection[selection['sum']&gt;0].index<br/>print(f"===== {len(selected_features)} features were selected =====")<br/>print(f"{', '.join(selected_features)}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/d9c829b66e363158e63abdccd68cdcdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*VGYxYmQR3A2cCNzAMYXv_A.png"/></div></figure><p id="2749" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æˆ‘ä»¬ç°åœ¨å·²ç»é€‰æ‹©äº†14ä¸ªç‰¹å¾ï¼Œæ˜¯æ—¶å€™æ£€æŸ¥æ¨¡å‹æ€§èƒ½äº†:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="8cbd" class="nr mq jj nn b gy ns nt l nu nv">model5 = GradientBoostingClassifier(random_state=42)<br/>model5.fit(X_train[selected_features], y_train)</span><span id="5c4c" class="nr mq jj nn b gy nw nt l nu nv">print(f"Training data - ROC AUC: {get_roc_auc(model5, X_train[selected_features], y_train):.4f}")<br/>print(f"Test data - ROC AUC: {get_roc_auc(model5, X_test[selected_features], y_test):.4f}")</span></pre><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/4aef3606e067286900c32a222c453072.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*i0H0WFUuCtq0mWyCMOVeUA.png"/></div></figure><p id="fb6d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">è¯¥æ€§èƒ½ä¸å…·æœ‰æ‰€æœ‰åŠŸèƒ½çš„åŸºçº¿æ¨¡å‹ç›¸åŒï¼Œä½†æˆ‘ä»¬ä»…ä½¿ç”¨äº†å¤§çº¦ä¸€åŠçš„åŠŸèƒ½ã€‚</p><p id="9c7e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">ç§ï¼Œè¿™å°±æ˜¯è¿›è¡Œç‰¹å¾é€‰æ‹©çš„5ç§ç®€å•æ–¹æ³•ã€‚é€šè¿‡æœ‰æ•ˆçš„ç‰¹å¾é€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸ä¸§å¤±é¢„æµ‹èƒ½åŠ›çš„æƒ…å†µä¸‹å»ºç«‹æ›´ç®€å•ã€æ›´å¿«é€Ÿã€æ›´æ˜“äºè§£é‡Šçš„æ¨¡å‹ã€‚å¸Œæœ›ä½ èƒ½åœ¨ä¸‹ä¸€ä¸ªæœ‰ç›‘ç£çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ä¸­ä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/bbe5f055b103936b0173f226d39f471c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i-TkEpoegnAxgo7_"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">é©¬å…‹Â·å“ˆæ™®å°”åœ¨<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></figure><p id="9bb2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="pc">æ‚¨æƒ³è®¿é—®æ›´å¤šè¿™æ ·çš„å†…å®¹å—ï¼Ÿåª’ä½“ä¼šå‘˜å¯ä»¥æ— é™åˆ¶åœ°è®¿é—®åª’ä½“ä¸Šçš„ä»»ä½•æ–‡ç« ã€‚å¦‚æœä½ ä½¿ç”¨</em> <a class="ae jg" href="https://zluvsand.medium.com/membership" rel="noopener"> <em class="pc">æˆ‘çš„æ¨èé“¾æ¥</em></a><em class="pc">æˆä¸ºä¼šå‘˜ï¼Œä½ çš„ä¸€éƒ¨åˆ†ä¼šè´¹ä¼šç›´æ¥å»æ”¯æŒæˆ‘ã€‚</em></p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="f495" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">æ„Ÿè°¢æ‚¨é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œè¿™é‡Œæœ‰æˆ‘çš„ä¸€äº›å…¶ä»–å¸–å­çš„é“¾æ¥:<br/> â—¼ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/explaining-scikit-learn-models-with-shap-61daff21b12a">è§£é‡Šscikit-learn models with shap</a><br/>â—¼ï¸ï¸<a class="ae jg" rel="noopener" target="_blank" href="/k-nearest-neighbours-explained-52c910c035c5">kè¿‘é‚»è§£é‡Š</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/logistic-regression-explained-7695f15d1b8b">é€»è¾‘å›å½’è§£é‡Š</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/comparing-random-forest-and-gradient-boosting-d7236b429c15">æ¯”è¾ƒéšæœºæ£®æ—å’Œæ¢¯åº¦æ¨è¿›</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/how-are-decision-trees-built-a8e5af57ce8?source=your_stories_page-------------------------------------">å†³ç­–æ ‘æ˜¯å¦‚ä½•æ„å»ºçš„ï¼Ÿ</a> <br/> â—¼ï¸ï¸ <a class="ae jg" rel="noopener" target="_blank" href="/pipeline-columntransformer-and-featureunion-explained-f5491f815f?source=your_stories_page-------------------------------------">ç®¡é“ï¼ŒColumnTransformerå’ŒFeatureUnionè¯´æ˜</a>t30ã€‘â—¼ï¸ï¸<a class="ae jg" rel="noopener" target="_blank" href="/featureunion-columntransformer-pipeline-for-preprocessing-text-data-9dcb233dbcb6">feature unionï¼ŒColumnTransformer &amp;ç®¡é“ç”¨äºé¢„å¤„ç†æ–‡æœ¬æ•°æ®</a></p></div></div>    
</body>
</html>