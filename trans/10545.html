<html>
<head>
<title>Guide To SQL And Its Equivalent Commands In Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的SQL及其等效命令指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/guide-to-sql-and-its-equivalent-commands-in-python-445e134adaba?source=collection_archive---------9-----------------------#2021-10-08">https://towardsdatascience.com/guide-to-sql-and-its-equivalent-commands-in-python-445e134adaba?source=collection_archive---------9-----------------------#2021-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4d98" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对于那些想将SQL代码转换成Python中的等效命令的人来说，这是一个快速而详细的备忘单！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3a1ef94eb544320b6a5d2773c03a1729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-ohqwwRKbMqmNVBh"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@lopezrobin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">洛佩兹罗宾</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="7c2f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="d361" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">从头开始学习从来都不是一件容易的事情。原因之一是我们不知道自己不知道的事情。当我第一次学习Python的时候也是这样。我对它的逻辑、语法等感到沮丧，因为要记住它们太难了。最后，我发现了自己学习Python的方法，那就是通过SQL。由于SQL是我在日常工作中经常使用的工具，我试图将我在SQL中学到的一切应用到Python中。这种学习方式帮助我同时研究、练习和记忆。</p><p id="f924" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我将向您展示一些重要的SQL查询和它们在Python中的对等物，具体来说是Pandas。这被认为是对那些想用和我一样的方法学习Python的人的一个指导。希望它能成为那些想买熊猫的人的有用的小抄。</p><h1 id="52e6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据</h1><p id="f9a4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我将创建一个简单的数据集如下:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="333c" class="mx la it mt b gy my mz l na nb">data = {'product_name': ['pencil', 'eraser', 'pen', 'desk', 'laptop'],<br/>        'price': [2, 1, 1, 50, 678], <br/>        'owner': ['Chi','Joe','Dan','Lisa','Rose']}<br/>df = pd.DataFrame(data) </span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/b6d313234a102d3d1cbc092135043b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*JVGAlGGJ3kg38vvsE1hgSA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:测向数据集</p></figure><p id="5b42" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，让我们开始吧！</p><h1 id="490b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">选择</strong></h1><p id="ef30" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下面是SQL的一些简单的<code class="fe nd ne nf mt b">select</code>语句和Python中的等效命令。</p><p id="1d13" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以通过调用数据集的名称(在我的示例中为<strong class="lt iu"> <em class="ng"> df </em> </strong>)来轻松选择所有的列和行。</p><p id="8a25" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在另一种情况下，您只需要从数据中提取特定的列，您可以考虑一些简单的方法，例如使用<code class="fe nd ne nf mt b">loc</code> &amp; <code class="fe nd ne nf mt b">iloc.</code>进行切片和索引。在我下面的示例中，我向您展示了从<strong class="lt iu"> <em class="ng"> df </em> </strong>数据集获取列<strong class="lt iu"> <em class="ng"> owner </em> </strong>的三种不同方法。</p><p id="da35" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我想查看我的数据中存在的独特产品？很简单，只需从<strong class="lt iu"> <em class="ng"> df </em> </strong>数据集提取<strong class="lt iu"> <em class="ng"> product_name </em> </strong>列，并应用<code class="fe nd ne nf mt b">unique()</code>函数即可。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="c9c3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">带条件选择</strong></h1><p id="9d41" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在Pandas中，有几种方法可以选择特定的条件行。我们可以用Python的切片方法，索引，应用查询函数或者lambda。</p><p id="d771" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下面的例子中，我将向您展示一些解决方案，通过对列值的一个或多个约束来获得所需的数据。通常，当在条件论元中处理数值数据时，我们必须处理不同的比较(例如:col_number &gt; 2，total_people ≥ 10等)。作为参考，在Python中，对数值数据的比较运算符描述如下:</p><ul class=""><li id="ab89" class="nj nk it lt b lu mn lx mo ma nl me nm mi nn mm no np nq nr bi translated">等于<code class="fe nd ne nf mt b">==</code></li><li id="540b" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">不等于<code class="fe nd ne nf mt b">!=</code></li><li id="c10a" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">大于<code class="fe nd ne nf mt b">&gt;</code></li><li id="803e" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">不到<code class="fe nd ne nf mt b">&lt;</code></li><li id="1d61" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">大于或等于<code class="fe nd ne nf mt b">&gt;=</code></li><li id="0368" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">小于或等于<code class="fe nd ne nf mt b">&lt;=</code></li></ul><p id="1a27" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，如果您想要提取特定类别等于字符串或对象的行，您应该用<code class="fe nd ne nf mt b">==</code>操作符指定它。我选择所有<strong class="lt iu"><em class="ng">product _ name</em></strong><em class="ng"/>为pen的行的情况如下表所示。让我们来看看。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="afce" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">选择其值与特定模式相似的行</h1><p id="b406" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设您在一个数据中有数千个产品列表，但您只想选择产品名称与<strong class="lt iu"> <em class="ng">笔</em> </strong>相关的数据。在这种情况下，使用<code class="fe nd ne nf mt b">contains()</code>功能是一个很好的选择。</p><p id="ea0f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有时，当您确切地知道所需类别的开始和结束字符时，您可以借助于功能<code class="fe nd ne nf mt b">startswith()</code>或<code class="fe nd ne nf mt b">endswith()</code>来指定它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="471f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">选择其值在确定集合中的行</h1><p id="9423" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果要选择特定列值在某个范围或集合内的行。<code class="fe nd ne nf mt b">isin()</code>命令可以帮你做到。例如，我想选择<strong class="lt iu"> <em class="ng"> product_name </em> </strong>为钢笔或铅笔的数据。我将调用如下命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="ab24" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">计算函数</h1><p id="5284" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">与SQL类似，Python也提供不同的函数来计算聚合或生成描述性摘要。</p><p id="d5e6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我的例子中，我只用一行代码就可以很容易地找到产品的总数、所有产品的总价格、产品价格的范围(例如:最大值、最小值、中间值等)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="2ec4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分组依据</h1><p id="bdc6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Group by很简单。只需在想要分组的列上使用<code class="fe nd ne nf mt b">groupby()</code>功能。例如，从我的<strong class="lt iu"> <em class="ng"> df </em> </strong>数据中，为了计算每个人为他/她的产品支付的钱，我将数据按每个人的名字分组，然后计算相应的产品价格总额。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="01b1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">排序值</strong></h1><p id="4f19" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">基本上，<code class="fe nd ne nf mt b">sort_values</code>默认按升序排列值。因此，如果您想按降序排列值，只需在<code class="fe nd ne nf mt b">sort_values()</code>参数中声明<code class="fe nd ne nf mt b">ascending = 'FALSE'</code>。</p><p id="81ed" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了查看谁付了最多的钱，我用<code class="fe nd ne nf mt b">groupby()</code>和<code class="fe nd ne nf mt b">sum()</code>函数计算每个人付的钱，然后按降序排列价格总和。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="8373" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">加入</h1><p id="6480" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我将创建另一个名为df2的数据帧来描述<code class="fe nd ne nf mt b">join</code>命令。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="61a4" class="mx la it mt b gy my mz l na nb">data1 = {'class': ['A','A','C','B','E'],<br/>        'teacher':['Mona','Mila','Laurel','Wes','Connor'], <br/>        'owner': ['Chi','Joe','Dan','Lisa','Rose']}<br/>df2 = pd.DataFrame(data1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/5e2e4badf6f4a2c6d0ffdba0aa14e6fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*KRU-aUc8Ml5D85Ir-XEwYA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:数据帧df2</p></figure><p id="792b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">基本<strong class="lt iu">连接</strong>包括左连接、右连接、外连接和内连接。在不同的情况下，根据我们的需要，我们可以选择合适的<code class="fe nd ne nf mt b">join.</code></p><p id="222f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们看看如何用四种类型的<code class="fe nd ne nf mt b">join.</code>转换我们的数据</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="644a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="08a0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">通过与你熟悉的东西联系起来，我认为你可以更好地学习和记忆新的东西。我希望这些技巧能够在将来当你开始钻研Python中的数据操作时作为有用的备忘单。祝你好运！</p></div></div>    
</body>
</html>