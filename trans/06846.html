<html>
<head>
<title>How to use AWS Secrets Manager for managing credentials</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用AWS Secrets Manager管理凭据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-aws-secrets-manager-for-managing-credentials-abf57ab7344c?source=collection_archive---------11-----------------------#2021-06-21">https://towardsdatascience.com/how-to-use-aws-secrets-manager-for-managing-credentials-abf57ab7344c?source=collection_archive---------11-----------------------#2021-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/3eb0b7b3b7fa63cb561da790aa2340ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-CXKGwW0dGjfBVmG"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="59d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在很多情况下，您需要使用凭证、令牌、API密钥等。访问某些服务。例如，您需要使用SQL server凭据来访问应用程序的特定数据库。但是，将它们以纯文本文件的形式存储在代码库中并不是最好的主意。这是一个安全漏洞。任何有权访问您的代码库的人都可以读取这些机密，未经授权访问您的服务并执行恶意操作。您可以对秘密进行加密，并将密钥作为配置文件在应用程序外部共享，以允许解密。但是管理这样的秘密会变得很复杂。AWS有一个秘密管理器，顾名思义，它是一个允许你管理秘密的服务。在本文中，我将讨论如何以编程方式存储和检索秘密。</p><h1 id="a1c0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">AWS机密管理器[1]</h1><p id="f6e3" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">此服务允许您保护访问您的应用程序、服务和IT资源所需的机密。人们可以在数据库凭证、API密钥和其他秘密的整个生命周期中轻松地轮换、管理和检索它们。用户和应用程序通过调用Secrets Manager APIs来检索机密，无需以纯文本方式硬编码敏感信息。该服务可扩展到其他类型的秘密，包括API密钥和OAuth令牌。此外，您可以使用细粒度的权限控制对机密的访问，并对AWS云中的资源、第三方服务和内部资源集中审计机密轮换。这些秘密可以很容易地复制到其他区域，以支持多区域应用。现在我们将看看创建一个秘密并以编程方式检索它所需的步骤。</p><h1 id="8231" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">步骤1:创建和存储秘密</h1><p id="fefe" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">您可以使用AWS Secrets manager控制台或AWS CLI来创建机密。</p><h1 id="21f5" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">机密管理器控制台</h1><ol class=""><li id="f6b3" class="mh mi it ki b kj mc kn md kr mj kv mk kz ml ld mm mn mo mp bi translated">登录控制台:【https://console.aws.amazon.com/secretsmanager/ T4】</li></ol><p id="7087" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.在“机密列表”页面上，单击“存储新机密”。</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mq"><img src="../Images/e26bab144baaf602fd6d4145520cdb7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UE5l5pzbQNCZoTmrfYSjQg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">来源:作者</p></figure><p id="f7e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.在“存储新密码”页面上，选择“其他密码类型”。(这种类型允许您存储键值对或纯文本。)然后，您可以在这个页面上将机密指定为键值对。例如，您的密钥可以是“用户名”和值“secrets@aws.com”</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/a05b55d8b32088b1120adfed1ff9cdf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NZBcPZ5G41sNargKO65ZWA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">来源:作者</p></figure><p id="f2a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.对于选择加密密钥，请选择DefaultEncryptionKey。当您选择此选项时，Secrets Manager将始终加密机密，无需额外费用。</p><p id="a95a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5.选择下一步</p><p id="6511" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6.在“机密名称”下，键入机密的名称。它只能是字母数字和/_+=。@-.可以用的例子:tutorial/firstkey。等级制度允许你将你的秘密分组并更好地维护它们。如果你愿意，你可以在这里添加描述和标签。</p><p id="43e1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">7.按下一步。</p><p id="6adc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">8.查看最终细节。此外，该页面还为您提供了不同语言的非常好的示例代码，您可以在您的应用程序中直接使用它们。你可以得到Python，Java，JavaV2，JavaScript，C#，Ruby和Go语言片段。相当整洁！出版社商店。这将创建一个名为tutorial/firstkey的秘密，其中包含testkey:testvalue对作为秘密。</p><h1 id="6c3e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">机密管理器CLI</h1><ol class=""><li id="ed8a" class="mh mi it ki b kj mc kn md kr mj kv mk kz ml ld mm mn mo mp bi translated">打开命令提示符运行AWS CLI。(<a class="ae kf" href="https://docs.aws.amazon.com/cli/latest/userguide/installing.html" rel="noopener ugc nofollow" target="_blank">安装AWS命令行界面</a></li><li id="5ac3" class="mh mi it ki b kj mw kn mx kr my kv mz kz na ld mm mn mo mp bi translated">要创建密码，请运行以下命令:<code class="fe nb nc nd ne b">$ aws secretsmanager create-secret --name tutorial/firstkey <em class="nf">2</em> --description "Basic Create Secret" --secret-string '{"testkey":"testvalue"}'</code></li></ol><h1 id="1488" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">步骤2:从机密管理器中检索机密</h1><h1 id="8cfc" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在AWS机密管理器控制台中检索您的机密</h1><ol class=""><li id="09f3" class="mh mi it ki b kj mc kn md kr mj kv mk kz ml ld mm mn mo mp bi translated">登录秘密管理员控制台:<a class="ae kf" href="https://console.aws.amazon.com/secretsmanager/" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/secretsmanager/</a></li><li id="4faa" class="mh mi it ki b kj mw kn mx kr my kv mz kz na ld mm mn mo mp bi translated">在“机密列表”页面上，选择您创建的机密。</li><li id="320b" class="mh mi it ki b kj mw kn mx kr my kv mz kz na ld mm mn mo mp bi translated">在“机密值”部分，选择“检索机密值”</li><li id="8d2e" class="mh mi it ki b kj mw kn mx kr my kv mz kz na ld mm mn mo mp bi translated">您可以将这个秘密视为键值对，或者JSON文本结构。</li></ol><h1 id="180f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用AWS Secrets Manager CLI检索</h1><ol class=""><li id="b720" class="mh mi it ki b kj mc kn md kr mj kv mk kz ml ld mm mn mo mp bi translated">打开命令提示符。</li><li id="5d36" class="mh mi it ki b kj mw kn mx kr my kv mz kz na ld mm mn mo mp bi translated">输入以下命令:</li></ol><figure class="mr ms mt mu gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="2687" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用boto3 Python代码检索</h1><p id="eb82" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">您也可以使用boto3库检索秘密。需要配置您的AWS CLI。</p><figure class="mr ms mt mu gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="965b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该函数将给出以下结果:</p><figure class="mr ms mt mu gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9596b0bfd7c61550b001d88934964fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*pGKtmnrjgcv2c3PUNA0OuA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">来源:作者</p></figure><h1 id="5fcb" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="ccaa" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">最后，我们将AWS Secrets Manager视为存储数据库凭证、API密钥等的一种方式。我们看到了如何使用控制台和AWS CLI创建密码。最后，我们看了如何使用控制台、AWS CLI和boto3 Python库获得密钥。我希望你喜欢这篇文章，并学到一些有用的东西。感谢您的阅读。关注我更多有趣的文章。</p><h1 id="fd22" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">参考</h1><p id="9d80" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">[1]<a class="ae kf" href="https://aws.amazon.com/secrets-manager/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/secrets-manager/</a></p><p id="1658" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[2] <a class="ae kf" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html" rel="noopener ugc nofollow" target="_blank">快速入门— Boto3文档1.17.96文档</a></p><p id="7e8e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[3]<a class="ae kf" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/secrets-manager.html" rel="noopener ugc nofollow" target="_blank">AWS Secrets Manager—boto 3 Docs 1 . 17 . 97文档</a></p><p id="a707" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[4] <a class="ae kf" href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html" rel="noopener ugc nofollow" target="_blank">教程:创建和检索秘密— AWS秘密管理器</a></p></div></div>    
</body>
</html>