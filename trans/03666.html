<html>
<head>
<title>Lambda Functions 101: From Zero to Hero</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">拉姆达函数101:从零到英雄</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lambda-functions-101-from-zero-to-hero-81b066cb82b7?source=collection_archive---------20-----------------------#2021-03-25">https://towardsdatascience.com/lambda-functions-101-from-zero-to-hero-81b066cb82b7?source=collection_archive---------20-----------------------#2021-03-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ff5f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">大蟒</h2><div class=""/><div class=""><h2 id="276e" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">了解如何对熊猫使用lambda函数——一起编码</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/49d57546dbeb429cde154ab7943bc9cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UKy97QsVWkP9GMLsSMwYgA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由Vlada Karpovich提供。来源:<a class="ae lh" href="https://www.pexels.com/photo/woman-sitting-on-the-floor-using-a-laptop-4050299/" rel="noopener ugc nofollow" target="_blank">像素</a></p></figure><p id="1395" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我开始学习Python时，我记得当我读到Lambda函数部分时，我感到多么失落。我尝试阅读相关文章和观看相关视频，但花了一段时间才最终学会如何为我的数据科学项目创建复杂的Lambda函数。互联网上的文章最大的问题之一是，它们解释了它是如何工作的，它们展示了一个很容易理解的简单例子，但在现实生活中，它永远不会像它们展示给我们的那样简单。为此，在本文中，我将解释如何在您的数据科学项目中使用lambda函数。我将解释如何构建和读取它们。</p><p id="ec0f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">什么是lambda函数？</strong></p><p id="39e5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python编程中的Lambda函数是一个没有名字的函数。它通常是一个小而有限的单行函数，就像任何其他函数一样，它可以在一个表达式中有多个参数。你还困惑吗？不再害怕。我们把它应用到一个项目中，会更容易理解它的工作原理。我将使用著名的<a class="ae lh" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank">泰坦尼克号数据集</a>。我们会用<code class="fe me mf mg mh b">lambda</code>做一些数据清理和数据工程。你可以在这里找到完整的笔记本<a class="ae lh" href="https://github.com/ismael-araujo/Testing-Libraries/blob/main/titanic-micro-project-lambda-functions.ipynb" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="fef9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，让我们导入所有我们需要的包。我将使用<code class="fe me mf mg mh b">pyforest</code>在一行代码中导入<code class="fe me mf mg mh b">pandas</code>、<code class="fe me mf mg mh b">seaborn</code>和<code class="fe me mf mg mh b">matplotlib</code>。我在<a class="ae lh" rel="noopener" target="_blank" href="/how-to-import-all-python-libraries-with-one-line-of-code-2b9e66a5879f">这个博客</a>里讲过<code class="fe me mf mg mh b">pyforest</code>。然后，我将导入我们将使用的数据集。你可以在这里找到数据集<a class="ae lh" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank"/>。这个项目的主要目标是创建一个机器学习模型，预测乘客是否在泰坦尼克号上幸存。在这篇博客中，我不会把重点放在模型上，但我会带着这个目标研究数据集。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="0553" class="mm mn it mh b gy mo mp l mq mr">import pyforest<br/>train = pd.read_csv('train.csv')</span></pre><p id="6784" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们检查一下现有的数据集，看看我们能做些什么。我用<code class="fe me mf mg mh b">train.head(2)</code>检查了前2行。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ms"><img src="../Images/cee2ad453384e4ba8586392b33514b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mztiRlMP3Io_0rB8x7CG0A.png"/></div></div></figure><p id="8071" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">似乎我们的数据集中有一些分类值和数值。让我们使用<code class="fe me mf mg mh b">train.dtypes</code>仔细检查一下，这样我们就可以看到数据类型</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mt"><img src="../Images/f15081e604175683fefec15009290e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ulRd01P-wxDSkPh0B5AMHA.png"/></div></div></figure><p id="dcf6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以看到<code class="fe me mf mg mh b">Sex</code>列是一个对象。对于机器学习，我们应该使用数值，这是我们第一次使用<code class="fe me mf mg mh b">lambda</code>的机会。我将解决1个男性和2个女性。这是一项简单的任务，我们可以这样做。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="66ae" class="mm mn it mh b gy mo mp l mq mr">train['Sex'] = train['Sex'].apply(lambda x: 1 if x == 'male' else 2)</span></pre><p id="e9ad" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">好吧，这是怎么回事？我们分批去吧。我没有创建新的列，而是将数值寻址到现有的<code class="fe me mf mg mh b">Sex</code>列。出于这个原因，我使用<code class="fe me mf mg mh b">train['Sex'] =</code>。如果我要创建一个新列，我应该使用不在数据集中的列的名称。然后，我写下我感兴趣的值所在的列的名称。在这种情况下，是同一个<code class="fe me mf mg mh b">train['Sex']</code>列。到目前为止，我们有<code class="fe me mf mg mh b">train['Sex'] = train['Sex']</code>。下一步是使用<code class="fe me mf mg mh b">apply()</code>，它允许用户传递一个函数，然后<strong class="lk jd">将</strong>应用到Pandas系列的每一个值。</p><p id="ad8a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在里面<code class="fe me mf mg mh b">apply()</code>我们将编写我们的lambda函数，这里是乐趣所在。我们分批去吧。首先，我们来检查一下<code class="fe me mf mg mh b">lambda x:</code>部分。这里，我们初始化lambda并命名一个变量，我们将使用它来调用一个确定列中的每个单元格。<code class="fe me mf mg mh b">x</code>代表<code class="fe me mf mg mh b">Sex</code>列中的每个值。你可以写任何字母或单词；用<code class="fe me mf mg mh b">x</code>只是约定俗成。现在，让我们检查一下<code class="fe me mf mg mh b">1 if x == 'male' else 2</code>部分。这部分的意思是:<em class="mu">如果x等于‘男’字，把x变成1；如果不是，就把x变成2 </em>。你能看到这里发生了什么吗？让我们再分解一次。以下是每一部分应该如何阅读。</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="5923" class="mm mn it mh b gy mo mp l mq mr"># Apply function to this columns<br/>train['Sex'] =</span><span id="89cc" class="mm mn it mh b gy mv mp l mq mr"># This is the columns where the values I'm looking for are<br/>train['Sex'].apply()</span><span id="6fbc" class="mm mn it mh b gy mv mp l mq mr"># Calling lambda function<br/>lambda x: </span><span id="8133" class="mm mn it mh b gy mv mp l mq mr"># Turn value into 1 if value is equal to 'male'<br/>1 if x == 'male' </span><span id="ccb9" class="mm mn it mh b gy mv mp l mq mr"># If value is not equal to 'male', then turn value into 2<br/>else 2</span></pre><p id="aa05" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我也可以这样写，它会以同样的方式工作:</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="ca5a" class="mm mn it mh b gy mo mp l mq mr">train['Sex'] = train['Sex'].apply(lambda x: 1 if x == 'male' else 2 if x == 'female')</span></pre><p id="1144" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以把上面这个例子理解为<em class="mu">如果x等于‘男性’，就把x变成1。然而，如果x等于“女性”，则将x变成2</em>现在有意义吗？我们可以看一个更复杂的例子，确保你能理解。</p><p id="46de" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在让我们继续关注<code class="fe me mf mg mh b">Fare</code>列。我把它画出来，这样我们就可以看到票价分布。它可能有机会进行一些功能工程。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mw"><img src="../Images/d3ea3fc1949b636ccc69810a43e4b57b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C37bSEfXPH-DTwrKQ5Qc1Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者创造的形象</p></figure><p id="2854" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以清楚地看到，大多数门票都不到100英镑(我假设票价以英镑为单位)。他们大多数不到50岁，极少数超过100岁。200多甚至500的门票少之又少。我们可以利用这些数字创造新的价值。我将为这些票创建类别。第一个是给那些多付了200美元的人的。另一个给那些支付了100到200英镑的人，等等。我假设员工没有支付任何费用，所以我将为那些支付0的员工创建一个类别。这是我的lambda函数:</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="5ac4" class="mm mn it mh b gy mo mp l mq mr">train['fare_category'] = train['Fare'].apply(<br/>                        lambda x: 1 if x &gt;= 200 <br/>                        else 2 if x &gt;= 100 and x &lt; 200<br/>                        else 3 if x &gt;= 50 and x &lt; 100<br/>                        else 4 if x &lt; 50 and x &gt; 0<br/>                        else 5)</span></pre><p id="34cf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是一个很大的信息量，但不要担心，让我们分部分进行。我正在使用<code class="fe me mf mg mh b">Fare</code>列中的值创建一个名为<code class="fe me mf mg mh b">fare_category</code>的新特性。然后，我启动了这个函数，就像a在第一个例子中做的那样。以下是你阅读一切的方法:</p><pre class="ks kt ku kv gt mi mh mj mk aw ml bi"><span id="5084" class="mm mn it mh b gy mo mp l mq mr"># Turn x into 1 if x is equal or greater than 200<br/>lambda x: 1 if x &gt;= 200 </span><span id="1c7a" class="mm mn it mh b gy mv mp l mq mr"># Then, turn x into 2 if x is equal or greater than 100 and less than 200<br/>else 2 if x &gt;= 100 and x &lt; 200 </span><span id="ddfa" class="mm mn it mh b gy mv mp l mq mr"># Then, turn x into 3 if x is equal or greater than 50 and less than 100<br/>else 3 if x &gt;= 50 and x &lt; 100 </span><span id="ada9" class="mm mn it mh b gy mv mp l mq mr"># Then, turn x into 50 if x is less than 50 and greater than 0<br/>else 4 if x &lt; 50 and x &gt; 0 </span><span id="81f9" class="mm mn it mh b gy mv mp l mq mr"># Then, turn x into 5 for all the other instances<br/>else 5</span></pre><p id="5a9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我知道，这太多了，但我希望这有意义。这是最难的了。<code class="fe me mf mg mh b">lambda</code>功能没有做的这么长，有时候用普通的<code class="fe me mf mg mh b">functions</code>会更好。不过，我觉得<code class="fe me mf mg mh b">lambda</code>函数可以让你的代码更干净，更易读。</p><p id="0462" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">最终想法</strong></p><p id="9aa4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你到了这一步，恭喜你！你只是向成为一名伟大的程序员迈进了一步。我真的希望我能很容易地解释清楚。最好的学习方法是练习。出于这个原因，我建议你用我给你的这些例子来玩一玩，也许你可以创造更多。让我知道我是否能帮助你。</p></div></div>    
</body>
</html>