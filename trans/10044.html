<html>
<head>
<title>How to train an Out-of-Memory Data with Scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Scikit-learn训练内存不足的数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/strategies-to-train-out-of-memory-data-with-scikit-learn-7b2ed15b9a80?source=collection_archive---------10-----------------------#2021-09-22">https://towardsdatascience.com/strategies-to-train-out-of-memory-data-with-scikit-learn-7b2ed15b9a80?source=collection_archive---------10-----------------------#2021-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0df0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用partial_fit API进行增量学习的基本指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f7273074caa72edb3b81dc4ce53cffb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NPtp8dlu6ZUgyzouBj-2_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/users/publicdomainpictures-14/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=163464" rel="noopener ugc nofollow" target="_blank"> PublicDomainPictures </a>来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=163464" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="53bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Scikit-learn是数据科学社区中流行的Python包，因为它提供了各种<a class="ae ky" href="https://en.wikipedia.org/wiki/Statistical_classification" rel="noopener ugc nofollow" target="_blank">分类</a>、<a class="ae ky" href="https://en.wikipedia.org/wiki/Regression_analysis" rel="noopener ugc nofollow" target="_blank">回归</a>和<a class="ae ky" href="https://en.wikipedia.org/wiki/Cluster_analysis" rel="noopener ugc nofollow" target="_blank">聚类</a>算法的实现。人们可以使用scikit-learn包用几行Python代码训练一个分类或回归机器学习模型。</p><p id="5398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是另一个流行的Python库，它在将数据提供给scikit-learn模型之前提供对数据的处理和预处理。人们可以使用Pandas和Scikit-learn包轻松处理和训练内存中的数据集(可以放入RAM内存的数据)，但当处理大型数据集或内存外的数据集(无法放入RAM内存的数据)时，它会失败，并导致内存问题。</p><p id="8c79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Scikit-learn提供了API选项，如<code class="fe lv lw lx ly b"><strong class="lb iu">warm_start</strong></code>和<code class="fe lv lw lx ly b"><strong class="lb iu">partial_fit</strong></code> <strong class="lb iu"> </strong>来扩展计算。在本文中，我们将讨论如何读取、处理和训练内存不足的数据集。</p><h1 id="ff92" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">什么时候需要增量学习？</h1><p id="8ca3" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">对于机器学习任务来说，新的一批数据随着时间的推移而出现，用以前和新的一批数据重新训练模型是一个计算量很大的过程。因此，人们可以采用增量学习方法，而不是用整个数据集来重新训练模型，其中将恢复模型的过去学习，并用新的一批数据来训练相同的模型。</p><p id="21ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，对于内存不足(大型)的数据集，不可能一次将整个数据加载到RAM中，可以分块加载数据，并为每个数据块拟合训练模型。</p><h1 id="b6e7" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">部分拟合:</h1><p id="2159" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">为了执行增量学习，Scikit-learn附带了partial_fit API选项，它能够从一批实例中进行增量学习。当整个数据集太大而无法一次放入内存时,<code class="fe lv lw lx ly b">partial_fit</code>非常有用。该方法预计将在数据集的不同块上连续调用几次，以便实现核外学习。</p><p id="08bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">partial_fit</code>具有一定的数值稳定性和性能开销，因此建议对相当大批量的数据(适合内存)调用partial_fit函数，以克服开销的限制。</p><h2 id="0077" class="mw ma it bd mb mx my dn mf mz na dp mj li nb nc ml lm nd ne mn lq nf ng mp nh bi translated">实施:</h2><p id="3404" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">其思想是以块的形式读取大型数据集(第8行),并对每个数据块执行特征工程。此外，使用具有逻辑回归模型的增量学习(第11行)来训练每个单独的数据块。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)</p></figure><p id="1dff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于分类任务，必须将可能的目标类标签列表传递给<code class="fe lv lw lx ly b"><strong class="lb iu">classes</strong></code>参数，以处理第一批数据中未出现的目标类。</p><p id="60d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实施<code class="fe lv lw lx ly b">partial_fit</code>所带来的估算器列表如下:</p><ul class=""><li id="7251" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated">分类:<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.naive_bayes.MultinomialNB.html#sklearn.naive_bayes.MultinomialNB" rel="noopener ugc nofollow" target="_blank">多项式分类器</a>，<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.naive_bayes.BernoulliNB.html#sklearn.naive_bayes.BernoulliNB" rel="noopener ugc nofollow" target="_blank">伯努利分类器</a>，<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.linear_model.SGDClassifier.html#sklearn.linear_model.SGDClassifier" rel="noopener ugc nofollow" target="_blank">SGD分类器</a>，<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.linear_model.PassiveAggressiveClassifier.html#sklearn.linear_model.PassiveAggressiveClassifier" rel="noopener ugc nofollow" target="_blank">被动积极分类器</a>，<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.linear_model.Perceptron.html#sklearn.linear_model.Perceptron" rel="noopener ugc nofollow" target="_blank">感知器</a></li><li id="4339" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">回归:<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.linear_model.SGDRegressor.html#sklearn.linear_model.SGDRegressor" rel="noopener ugc nofollow" target="_blank"> SGDRegressor </a>，<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.linear_model.PassiveAggressiveRegressor.html#sklearn.linear_model.PassiveAggressiveRegressor" rel="noopener ugc nofollow" target="_blank">passiveaggressiverregressor</a></li><li id="d128" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">聚类:<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.cluster.MiniBatchKMeans.html#sklearn.cluster.MiniBatchKMeans" rel="noopener ugc nofollow" target="_blank">迷你批处理方式</a></li><li id="c0d6" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated">分解:<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.decomposition.MiniBatchDictionaryLearning.html#sklearn.decomposition.MiniBatchDictionaryLearning" rel="noopener ugc nofollow" target="_blank">minibatchdictionaryllearning</a>，<a class="ae ky" href="https://scikit-learn.org/0.15/modules/generated/sklearn.cluster.MiniBatchKMeans.html#sklearn.cluster.MiniBatchKMeans" rel="noopener ugc nofollow" target="_blank">minibatchkman</a></li></ul><h2 id="b054" class="mw ma it bd mb mx my dn mf mz na dp mj li nb nc ml lm nd ne mn lq nf ng mp nh bi translated">“温暖状态”和“部分适合”有什么不同？</h2><p id="61da" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">如前所述，<code class="fe lv lw lx ly b"><strong class="lb iu">partial_fit</strong></code> <strong class="lb iu"> </strong> API用于对小批量数据进行增量学习，保持估计器常数的超参数。另一方面，<code class="fe lv lw lx ly b"><strong class="lb iu">warm_state</strong></code> <strong class="lb iu"> </strong>不用于增量学习，因为它是在估计器的超参数变化的相同数据集上训练的。</p><p id="0c35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">根据</strong><a class="ae ky" href="https://scikit-learn.org/stable/glossary.html#term-warm_start" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Scikit-学会文档</strong> </a> <strong class="lb iu"> : </strong></p><blockquote class="ny nz oa"><p id="d5f6" class="kz la ob lb b lc ld ju le lf lg jx lh oc lj lk ll od ln lo lp oe lr ls lt lu im bi translated"><code class="fe lv lw lx ly b"><a class="ae ky" href="https://scikit-learn.org/stable/glossary.html#term-partial_fit" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">partial_fit</strong></a></code>也保留了调用之间的模型，但是有所不同:在<code class="fe lv lw lx ly b"><a class="ae ky" href="https://scikit-learn.org/stable/glossary.html#term-warm_start" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">warm_start</strong></a></code>中，参数会改变，而对<code class="fe lv lw lx ly b"><strong class="lb iu">fit</strong></code>的调用之间的数据(或多或少)是恒定的；使用<code class="fe lv lw lx ly b"><strong class="lb iu">partial_fit</strong></code>，小批量的数据变化和模型参数保持不变。</p></blockquote></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><h1 id="5a77" class="lz ma it bd mb mc om me mf mg on mi mj jz oo ka ml kc op kd mn kf oq kg mp mq bi translated">结论:</h1><p id="29bb" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated"><code class="fe lv lw lx ly b"><strong class="lb iu">partial_fit</strong></code>是一个方便的API，可用于在小批量的内存不足数据集上执行增量学习。使用<code class="fe lv lw lx ly b"><strong class="lb iu">warm_state</strong></code>的主要目的是在用不同组的超参数值拟合同一数据集时减少训练时间。通过重用从先前的参数值学习的模型的方面，它可以用于优化网格搜索实现。</p><h1 id="6073" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">参考资料:</h1><p id="947d" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">[1.] Scikit-Learn文档:<a class="ae ky" href="https://scikit-learn.org/0.15/modules/scaling_strategies.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-Learn . org/0.15/modules/scaling _ strategies . html</a></p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="281d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ob">喜欢这篇文章吗？成为</em> <a class="ae ky" href="https://satyam-kumar.medium.com/membership" rel="noopener"> <em class="ob">中等会员</em> </a> <em class="ob">继续无限制学习。如果你使用下面的链接，我会收到你的一小部分会员费，不需要你额外付费。</em></p><div class="or os gp gr ot ou"><a href="https://satyam-kumar.medium.com/membership" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">加入我的推荐链接-萨蒂扬库马尔媒体</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">satyam-kumar.medium.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ks ou"/></div></div></a></div><blockquote class="pj"><p id="6d64" class="pk pl it bd pm pn po pp pq pr ps lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>