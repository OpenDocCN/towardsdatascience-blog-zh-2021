<html>
<head>
<title>Hands-On Climate Time Series Classification with Deep Learning, using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python通过深度学习实践气候时间序列分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hands-on-climate-time-series-classification-with-deep-learning-using-python-6d5de81004c9?source=collection_archive---------4-----------------------#2021-08-06">https://towardsdatascience.com/hands-on-climate-time-series-classification-with-deep-learning-using-python-6d5de81004c9?source=collection_archive---------4-----------------------#2021-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/ff2c46f811a9c0b7aecf287b7493938a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1YMfCnbVYWGxJ8e6FFMCg.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">照片由<a class="ae jd" href="https://unsplash.com/@saffu?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">萨夫</a>在<a class="ae jd" href="https://unsplash.com/s/photos/time?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><div class=""/><div class=""><h2 id="93a0" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">下面介绍如何用几行代码构建一个深度神经网络进行时间序列分类</h2></div><p id="a707" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">时间序列是我们生活中很大的一部分</strong>。基本上<strong class="kx jh">一切</strong>都可以被建模为随着时间增加(在x轴上)而变化的某个量(在y轴上)。</p><p id="13bc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">另一方面，<strong class="kx jh">分类是机器学习的一个重要应用。事实上，我们很容易将许多目标视为分类任务。</strong></p><p id="ce2c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">把这两件事结合在一起我们就有了<strong class="kx jh">时间序列分类。</strong>我们的目标很容易确定:</p><blockquote class="lr"><p id="450d" class="ls lt jg bd lu lv lw lx ly lz ma lq dk translated">我们想要一个模型，给定一个时间序列(即一个随时间变化的量)，能够输出一个类。</p></blockquote><p id="119c" class="pw-post-body-paragraph kv kw jg kx b ky mb kh la lb mc kk ld le md lg lh li me lk ll lm mf lo lp lq ij bi translated">有大量的文章解释了这个目标背后的理论(在我看来，Marco Del Pra在这篇文章中做得非常好)。本文不会关注理论，但会给出一个实用指南<strong class="kx jh">关于如何对现实世界的时间序列进行分类，使用Python从头开始构建你的分类器。</strong></p><p id="eee8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的具体例子中，我们希望根据温度的时间序列来区分一个国家的大陆(欧洲、亚洲或非洲)。</p><p id="24ab" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以让我们开始吧！</p><blockquote class="mg mh mi"><p id="7cb4" class="kv kw mj kx b ky kz kh la lb lc kk ld mk lf lg lh ml lj lk ll mm ln lo lp lq ij bi translated">请注意:本文意在跟随您，<strong class="kx jh">循序渐进，</strong>走向解决方案。如果您对<strong class="kx jh">预处理部分、</strong>不感兴趣，请直接跳到<strong class="kx jh">机器学习模型部分</strong>或<strong class="kx jh">结果部分。</strong></p></blockquote><h2 id="3998" class="mn mo jg bd mp mq mr dn ms mt mu dp mv le mw mx my li mz na nb lm nc nd ne nf bi translated">0.图书馆</h2><p id="1530" class="pw-post-body-paragraph kv kw jg kx b ky ng kh la lb nh kk ld le ni lg lh li nj lk ll lm nk lo lp lq ij bi translated">我们首先要做的是打电话求助一些朋友:)</p><p id="8296" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是我们完成工作所需的东西:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><h2 id="2475" class="mn mo jg bd mp mq mr dn ms mt mu dp mv le mw mx my li mz na nb lm nc nd ne nf bi translated">1.数据集</h2><p id="59a1" class="pw-post-body-paragraph kv kw jg kx b ky ng kh la lb nh kk ld le ni lg lh li nj lk ll lm nk lo lp lq ij bi translated">在我们的实验中，我使用了一个我非常熟悉的<a class="ae jd" href="https://www.kaggle.com/berkeleyearth/climate-change-earth-surface-temperature-data?select=GlobalLandTemperaturesByCountry.csv" rel="noopener ugc nofollow" target="_blank">数据集</a>，它可以用于我们的目标。这是一个由各国收集的地表温度数据组成的时间序列。</p><p id="ba34" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里有一个直接来自英国的例子:</p><figure class="nl nm nn no gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nr"><img src="../Images/78b6745b32d614fda7560b16ec06e9c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IuJqro57rlKjuZyVW4-Beg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">英国时间序列。[图片由作者使用Python制作]</p></figure><h2 id="8cd2" class="mn mo jg bd mp mq mr dn ms mt mu dp mv le mw mx my li mz na nb lm nc nd ne nf bi translated">2.数据预处理</h2><p id="0079" class="pw-post-body-paragraph kv kw jg kx b ky ng kh la lb nh kk ld le ni lg lh li nj lk ll lm nk lo lp lq ij bi translated">现在您已经下载了您的。csv该看了，有<strong class="kx jh">熊猫</strong>。</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="720e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过查看第一行，我们有一些东西需要考虑:</p><p id="8bf1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.<strong class="kx jh">我们还没有“大陆”信息，</strong>我们想称之为“目标”<br/> B. <strong class="kx jh">我们必须处理平均温度列上的一些NaN值</strong>，这是我们将认为是时间序列的y轴的值</p><p id="9b2a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们一步一步地解决这些问题。<br/>我们首先要用的是我们导入的一个魔法库，即<strong class="kx jh"> pycountry_convert </strong>。</p><p id="2524" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过下面几行代码，我们能够从一个国家名称中获取“大陆”:</p><pre class="nl nm nn no gt ns nt nu nv aw nw bi"><span id="88ee" class="mn mo jg nt b gy nx ny l nz oa">country_code = pc.country_name_to_country_alpha2(c, cn_name_format="default")<br/>        continent_name = pc.country_alpha2_to_continent_code(country_code)</span></pre><p id="4913" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是，遗憾的是，这并不适用于整个数据集，我们可以从这些代码在我们的数据上的应用中看到:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="da4e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">很多国家不被pycountry_convert识别，所以我自己手动添加了大洲(稍后感谢；) ):</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="8468" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">我们可以看到，现在所有国家都有一个相关的洲，这就解决了一个点！</strong></p><p id="002c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一些国家来自南极洲，但它们形成了一个非常小的数量，在这个阶段，与添加到我们的数据集无关(顺便说一下，确定一个国家是否在南极洲是非常容易的，不是吗？).</p><p id="bae1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们最终需要将这些国家从我们的数据集中剔除。此外，我们还有那个问题要解决。我们就用神奇的<strong class="kx jh"> pd.fill_na() </strong>函数来做！</p><p id="e7db" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">代码如下:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="1e7b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">而且它解决了B问题！<br/> </strong>不幸的是，我们还没有完成。我们需要确保每个国家在时间序列中有相同数量的条目。在我们的数据集中，有些国家以<strong class="kx jh"> 1743 </strong>为元年，有些国家以<strong class="kx jh"> 1948 </strong>为元年。我们必须<strong class="kx jh">将</strong>数据集标准化到相同的<strong class="kx jh">起始年</strong>，以便拥有<strong class="kx jh">相同数量的条目。</strong>特别是，我们将使用<strong class="kx jh">最近的年份</strong>作为整个数据集的起始年份。</p><p id="f2c0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是我们标准化之前的条目数:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="984e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是<strong class="kx jh">标准化代码和标准化数据集:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d544" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">这是标准化后的条目数直方图:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="5071" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好了，让我们来看看我们的<strong class="kx jh">类</strong>:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="e904" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们考虑三个人口最多的阶层:<strong class="kx jh">欧洲，亚洲</strong>和<strong class="kx jh">非洲。</strong>此外，让我们收集数据集的所有<strong class="kx jh">标签</strong>:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="0c12" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">另外，让我们介绍一些我们将用来绘制数据的<strong class="kx jh">函数</strong>:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="b8f6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过绘制我们三个国家的数据可以看出，<strong class="kx jh">我们的任务一点也不轻松！</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="2ed9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">最后，让我们为机器学习模型准备数据集:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><h2 id="d83d" class="mn mo jg bd mp mq mr dn ms mt mu dp mv le mw mx my li mz na nb lm nc nd ne nf bi translated">3.机器学习模型</h2><p id="6456" class="pw-post-body-paragraph kv kw jg kx b ky ng kh la lb nh kk ld le ni lg lh li nj lk ll lm nk lo lp lq ij bi translated">该模型是一个1D卷积神经网络。该结构非常容易理解，并且计算量小。此外，其细节由Keras <a class="ae jd" href="https://keras.io/examples/timeseries/timeseries_classification_from_scratch/" rel="noopener ugc nofollow" target="_blank">在这里</a>提供。</p><p id="db23" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">这里是模型:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="74e3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">及其摘要:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="5042" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">我们来训练模型:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><h2 id="b6a2" class="mn mo jg bd mp mq mr dn ms mt mu dp mv le mw mx my li mz na nb lm nc nd ne nf bi translated">4.结果是:</h2><p id="6b4a" class="pw-post-body-paragraph kv kw jg kx b ky ng kh la lb nh kk ld le ni lg lh li nj lk ll lm nk lo lp lq ij bi translated">已经获得了79%的准确度；</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="8758" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是其他<strong class="kx jh">指标</strong>:</p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="5938" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里是<strong class="kx jh">混淆矩阵:</strong></p><figure class="nl nm nn no gt is"><div class="bz fp l di"><div class="np nq l"/></div></figure><h2 id="b306" class="mn mo jg bd mp mq mr dn ms mt mu dp mv le mw mx my li mz na nb lm nc nd ne nf bi translated">最终考虑:</h2><p id="011a" class="pw-post-body-paragraph kv kw jg kx b ky ng kh la lb nh kk ld le ni lg lh li nj lk ll lm nk lo lp lq ij bi translated">虽然越来越大的模型通常是为了解决难以置信的复杂问题而构建的，但有时一个相当小的神经网络能够在有限的计算资源下获得可接受的结果。</p><p id="30b8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="036f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.在<a class="ae jd" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Linkedin </strong> </a>上关注我，在那里我发布我所有的故事<br/> B .订阅我的<a class="ae jd" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="kx jh">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae jd" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="kx jh">推荐会员</strong> </a>，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的关于最新可用技术的任何内容。</p></div></div>    
</body>
</html>