<html>
<head>
<title>Overview of Albumentations: Open-source library for advanced image augmentations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç›¸å†Œæ¦‚è¿°:ç”¨äºé«˜çº§å›¾åƒå¢å¼ºçš„å¼€æºåº“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/overview-of-albumentations-open-source-library-for-advanced-image-augmentations-c821a025c2ca?source=collection_archive---------31-----------------------#2021-07-01">https://towardsdatascience.com/overview-of-albumentations-open-source-library-for-advanced-image-augmentations-c821a025c2ca?source=collection_archive---------31-----------------------#2021-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="c24f" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">å®è·µæ•™ç¨‹</a></h2><div class=""/><div class=""><h2 id="1be6" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated"><em class="ko">å¸¦æœ‰å…³äºå¢å¼ºå’Œé›†æˆPyTorchå’ŒTensorflowç®¡é“çš„ä»£ç ç‰‡æ®µ</em>ã€‚</h2></div><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/21263b74461383e34477b912aed4c249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9t26IX1_ssk4WCr8"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><p id="6f3c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">åŸç”ŸPyTorchå’ŒTensorFlowå¢å¼ºå™¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ï¼Œå®ƒä»¬ä¸èƒ½åŒæ—¶å¢å¼ºå›¾åƒåŠå…¶åˆ†æ®µé®ç½©ã€è¾¹ç•Œæ¡†æˆ–å…³é”®ç‚¹ä½ç½®ã€‚æ‰€ä»¥æœ‰ä¸¤ä¸ªé€‰æ‹©â€”â€”è¦ä¹ˆè‡ªå·±å†™å‡½æ•°ï¼Œè¦ä¹ˆç”¨ç¬¬ä¸‰æ–¹åº“ã€‚ä¸¤ä¸ªæˆ‘éƒ½è¯•è¿‡äº†ï¼Œç¬¬äºŒä¸ªé€‰æ‹©æ›´å¥½ğŸ™‚</p><h1 id="718c" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">ä¸ºä»€ä¹ˆæ˜¯ç™½è›‹ç™½ï¼Ÿ</h1><p id="e258" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated"><a class="ae my" href="https://albumentations.ai/" rel="noopener ugc nofollow" target="_blank">albuminations</a>æ˜¯æˆ‘å°è¯•è¿‡çš„ç¬¬ä¸€ä¸ªå›¾ä¹¦é¦†ï¼Œæˆ‘ä¸€ç›´åšæŒç€ï¼Œå› ä¸º:</p><ul class=""><li id="bced" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma ne nf ng nh bi translated">å®ƒæ˜¯å¼€æºçš„ï¼Œ</li><li id="792b" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">ç›´è§‰ï¼Œ</li><li id="1d17" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">å¿«ï¼Œ</li><li id="42e6" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">æ‹¥æœ‰è¶…è¿‡60ç§ä¸åŒçš„å¢å¼ºåŠŸèƒ½ï¼Œ</li><li id="ff11" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">è¯æ®å……åˆ†ï¼Œ</li><li id="1eb5" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">æœ€é‡è¦çš„æ˜¯ï¼Œå¯ä»¥åŒæ—¶å¢å¼ºå›¾åƒåŠå…¶åˆ†æ®µé®ç½©ã€è¾¹ç•Œæ¡†æˆ–å…³é”®ç‚¹ä½ç½®ã€‚</li></ul><p id="634d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">è¿˜æœ‰ä¸¤ä¸ªç±»ä¼¼çš„åº“â€”â€”<a class="ae my" href="https://github.com/aleju/imgaug" rel="noopener ugc nofollow" target="_blank">img aug</a>å’Œ<a class="ae my" href="https://github.com/mdbloice/Augmentor" rel="noopener ugc nofollow" target="_blank"> Augmentor </a>ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä¸èƒ½æä¾›ä»»ä½•æ¯”è¾ƒï¼Œå› ä¸ºæˆ‘è¿˜æ²¡æœ‰å°è¯•è¿‡ã€‚ç›´åˆ°ç°åœ¨ï¼Œç™½è›‹ç™½å·²ç»è¶³å¤Ÿäº†ã€‚</p><h1 id="9026" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">ç®€çŸ­æ•™ç¨‹</h1><p id="6daa" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">åœ¨è¿™ä¸ªç®€çŸ­çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ç”¨å‡ è¡Œä»£ç è½»æ¾åœ°å¢å¼ºå›¾åƒä»¥ç”¨äºåˆ†å‰²å’Œå¯¹è±¡æ£€æµ‹ä»»åŠ¡ã€‚</p><p id="7898" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">å¦‚æœä½ æƒ³è·Ÿéšè¿™ä¸ªæ•™ç¨‹:</p><ol class=""><li id="2067" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma nn nf ng nh bi translated"><a class="ae my" href="https://albumentations.ai/docs/getting_started/installation/" rel="noopener ugc nofollow" target="_blank">å®‰è£…æŠ›å…‰å«</a>ã€‚æˆ‘çœŸçš„å»ºè®®æ£€æŸ¥ä½ æ˜¯å¦æœ‰æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå› ä¸ºæ—§çš„ç‰ˆæœ¬å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚æˆ‘ç”¨çš„æ˜¯1.0.0ç‰ˆæœ¬ï¼Œè¿è¡Œè‰¯å¥½ã€‚</li><li id="e359" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma nn nf ng nh bi translated">ä¸‹è½½æ ‡ç­¾å¦‚ä¸‹çš„æµ‹è¯•å›¾åƒã€‚è¿™åªæ˜¯æ¥è‡ª<a class="ae my" href="https://cocodataset.org/#home" rel="noopener ugc nofollow" target="_blank"> COCOæ•°æ®é›†</a>çš„éšæœºå›¾åƒã€‚æˆ‘ç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œç„¶åæŒ‰ç…§ç›¸å†Œè¦æ±‚çš„æ ¼å¼ä¿å­˜äº†ä¸‹æ¥ã€‚è¯¥åº“æ¥å—NumPyæ•°ç»„å½¢å¼çš„å›¾åƒã€NumPyæ•°ç»„å½¢å¼çš„åˆ†æ®µé®ç½©å’Œåˆ—è¡¨å½¢å¼çš„è¾¹ç•Œæ¡†ã€‚</li></ol><p id="b0ae" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">åœ¨è¿™é‡Œä¸‹è½½<a class="ae my" href="https://notrocketscience.blog/wp-content/uploads/2021/07/image_data.pickle.zip" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><p id="ce84" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">è®©æˆ‘ä»¬åŠ è½½å›¾åƒã€å®ƒçš„äºŒè¿›åˆ¶åƒç´ åˆ†å‰²è’™ç‰ˆå’Œä¸€ä¸ªè¾¹ç•Œæ¡†ã€‚è¾¹ç•Œæ¡†è¢«å®šä¹‰ä¸º4å…ƒç´ åˆ—è¡¨â€” [x_minï¼Œy_minï¼Œwidthï¼Œheight]ã€‚</p><pre class="kq kr ks kt gt no np nq nr aw ns bi"><span id="21f4" class="nt mc iq np b gy nu nv l nw nx">import pickle <br/>import numpy as np <br/>import matplotlib.pyplot as plt <br/>import matplotlib.patches as patches</span><span id="ba6a" class="nt mc iq np b gy ny nv l nw nx"># load data<br/>with open("image_data.pickle", "rb") as handle:<br/>    image_data = pickle.load(handle)</span><span id="7474" class="nt mc iq np b gy ny nv l nw nx">image = image_data["image"]<br/>mask = image_data["mask"]<br/>bbox = image_data["bbox_coco"]</span><span id="3e5a" class="nt mc iq np b gy ny nv l nw nx"># visualize data<br/>fig, ax = plt.subplots(1, 2, figsize=(12, 5))<br/>ax[0].imshow(image)<br/>ax[0].set_title("Image")<br/>ax[1].imshow(image)<br/>bbox_rect = patches.Rectangle(<br/>    bbox[:2], bbox[2], bbox[3], linewidth=2, edgecolor="r", facecolor="none"<br/>)<br/>ax[1].add_patch(bbox_rect)<br/>ax[1].imshow(mask, alpha=0.3, cmap="gray_r")<br/>ax[1].set_title("Image + BBox + Mask")<br/>plt.show()</span></pre></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><p id="6f84" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">åœ¨åŠ è½½å¹¶å¯è§†åŒ–å›¾åƒåï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi og"><img src="../Images/bce9b7579ec1a252be6c3a17ef2f298d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dd1wfqpL2vkCVKjdBmtOAg.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated"><em class="ko">å›¾åƒã€‚è¿è¡Œå›¾åƒåŠå…¶æ ‡ç­¾å¯è§†åŒ–ä»£ç æ—¶çš„è¾“å‡ºã€‚åˆ†å‰²é®ç½©è¢«å¯è§†åŒ–ä¸ºé€æ˜çš„é»‘ç™½å›¾åƒ(1ä¸ºé»‘è‰²ï¼Œâ€œé©¬â€)ã€‚ä½œè€…å›¾ç‰‡</em></p></figure><p id="13b6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">ç”¨äºåˆ†å‰²çš„æ©æ¨¡å¢å¼º</strong>ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»ç™½è›‹ç™½å¼€å§‹ã€‚è¿™é‡Œçš„è½¬æ¢å®šä¹‰éå¸¸ç±»ä¼¼äºPyTorchå’ŒTensorFlow (Keras API):</p><ul class=""><li id="32ce" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma ne nf ng nh bi translated">é€šè¿‡ä½¿ç”¨Composeå¯¹è±¡ç»„åˆå‡ ä¸ªæ‰©å……æ¥å®šä¹‰è½¬æ¢ã€‚</li><li id="6510" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">æ¯ä¸ªå¢å¼ºéƒ½æœ‰å‚æ•°â€œp â€,å³è¦åº”ç”¨çš„æ¦‚ç‡ï¼Œæ­¤å¤–è¿˜æœ‰ç‰¹å®šäºå¢å¼ºçš„å‚æ•°ï¼Œå¦‚RandomCropçš„â€œwidthâ€å’Œâ€œheightâ€ã€‚</li><li id="43dc" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">ä½¿ç”¨å®šä¹‰çš„å˜æ¢ä½œä¸ºå‡½æ•°æ¥å¢åŠ å›¾åƒåŠå…¶é®ç½©ã€‚è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«å…³é”®å­—â€œå›¾åƒâ€å’Œâ€œé®ç½©â€çš„å­—å…¸ã€‚</li></ul><p id="928b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">ä¸‹é¢æ˜¯å¦‚ä½•ç”¨éšæœº256Ã—256è£å‰ª(æ€»æ˜¯)å’Œæ°´å¹³ç¿»è½¬(ä»…åœ¨50%çš„æƒ…å†µä¸‹)æ¥å¢åŠ å›¾åƒ(åŠå…¶é®ç½©)çš„ä»£ç ã€‚</p><pre class="kq kr ks kt gt no np nq nr aw ns bi"><span id="722a" class="nt mc iq np b gy nu nv l nw nx">import albumentations as A</span><span id="9c7a" class="nt mc iq np b gy ny nv l nw nx"># define agumentation<br/>transform = A.Compose([<br/>    A.RandomCrop(width=256, height=256, p=1),<br/>    A.HorizontalFlip(p=0.5),<br/>])</span><span id="8bce" class="nt mc iq np b gy ny nv l nw nx"># augment and visualize images<br/>fig, ax = plt.subplots(2, 3, figsize=(15, 10))<br/>for i in range(6):<br/>    <strong class="np ja">transformed = transform(image=image, mask=mask)</strong><br/>    ax[i // 3, i % 3].imshow(transformed["image"])<br/>    ax[i // 3, i % 3].imshow(transformed["mask"], alpha=0.3, cmap="gray_r")<br/>plt.show()</span></pre><p id="f0ed" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">ç»“æœï¼Œä½ åº”è¯¥å¾—åˆ°è¿™æ ·çš„ä¸œè¥¿ã€‚æ‚¨çš„å¢å¼ºå›¾åƒä¼šæœ‰æ‰€ä¸åŒï¼Œå› ä¸ºç™½è›‹ç™½ä¼šäº§ç”Ÿéšæœºè½¬æ¢ã€‚å…³äºé¢ç½©å¢å¤§çš„è¯¦ç»†æ•™ç¨‹ï¼Œè¯·å‚è€ƒ<a class="ae my" href="https://albumentations.ai/docs/getting_started/mask_augmentation/" rel="noopener ugc nofollow" target="_blank">åŸå§‹æ–‡æ¡£</a>ã€‚</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oh"><img src="../Images/8592dd00b29005ad0f687d93264de275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddgJ9keaFErj-28aRForQg.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated"><em class="ko">å½¢è±¡ã€‚è¿è¡Œç”¨äºåŒæ—¶å¢å¼ºå›¾åƒå’Œé®ç½©çš„ä»£ç æ—¶çš„è¾“å‡ºã€‚</em> <br/> <em class="ko">åˆ†å‰²è’™ç‰ˆè¢«å¯è§†åŒ–ä¸ºé€æ˜çš„é»‘ç™½å›¾åƒ(1ä¸ºé»‘è‰²ï¼Œâ€˜é©¬â€™)ã€‚ä½œè€…å›¾ç‰‡</em></p></figure><p id="35aa" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">ç”¨äºå¯¹è±¡æ£€æµ‹çš„åŒ…å›´ç›’å¢å¼º</strong>ã€‚ç„¶è€Œï¼Œå®ƒç±»ä¼¼äºåˆ†æ®µé®ç½©çš„å¢å¼º:</p><ul class=""><li id="a6b3" class="mz na iq lh b li lj ll lm lo nb ls nc lw nd ma ne nf ng nh bi translated">æ­¤å¤–ï¼Œå®šä¹‰â€œbbox_params â€,å…¶ä¸­æŒ‡å®šè¾¹ç•Œæ¡†çš„æ ¼å¼å’Œè¾¹ç•Œæ¡†ç±»çš„å‚æ•°ã€‚â€œcocoâ€è¡¨ç¤ºCOCOæ•°æ®é›†æ ¼å¼çš„è¾¹ç•Œæ¡†â€” [x_minï¼Œy_minï¼Œwidthï¼Œheight]ã€‚å‚æ•°â€œbbox_classesâ€å°†åœ¨åé¢ç”¨äºä¼ é€’è¾¹ç•Œæ¡†çš„ç±»ã€‚</li><li id="65ce" class="mz na iq lh b li ni ll nj lo nk ls nl lw nm ma ne nf ng nh bi translated">` transform 'æ¥å—è¾¹ç•Œæ¡†ä½œä¸ºåˆ—è¡¨çš„åˆ—è¡¨ã€‚æ­¤å¤–ï¼Œå³ä½¿å›¾åƒä¸­åªæœ‰ä¸€ä¸ªè¾¹ç•Œæ¡†ï¼Œå®ƒä¹Ÿéœ€è¦è¾¹ç•Œæ¡†ç±»(ä½œä¸ºåˆ—è¡¨)ã€‚</li></ul><p id="f1e4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">ä¸‹é¢æ˜¯å¯¹å›¾åƒåŠå…¶è¾¹ç•Œæ¡†åŒæ—¶è¿›è¡ŒRandomCropå’ŒHorizonalFripçš„ä»£ç ã€‚</p><pre class="kq kr ks kt gt no np nq nr aw ns bi"><span id="04e2" class="nt mc iq np b gy nu nv l nw nx"># define augmentation <br/>transform = A.Compose([<br/>     A.RandomCrop(width=256, height=256, p=1),<br/>     A.HorizontalFlip(p=0.5), <br/>], <strong class="np ja">bbox_params=A.BboxParams(format='coco', label_fields=["bbox_classes"])</strong>)</span><span id="754a" class="nt mc iq np b gy ny nv l nw nx"># augment and visualize <br/>bboxes = [bbox]<br/>bbox_classes = ["horse"]</span><span id="1bd6" class="nt mc iq np b gy ny nv l nw nx">fig, ax = plt.subplots(2, 3, figsize=(15, 10))<br/>for i in range(6):<br/><strong class="np ja">    transformed = transform(<br/>        image=image, <br/>        bboxes=bboxes, <br/>        bbox_classes=bbox_classes<br/>    )</strong><br/>    ax[i // 3, i % 3].imshow(transformed["image"])<br/>    trans_bbox = transformed["bboxes"][0]<br/>    bbox_rect = patches.Rectangle(<br/>        trans_bbox[:2],<br/>        trans_bbox[2],<br/>        trans_bbox[3],<br/>        linewidth=2,<br/>        edgecolor="r",<br/>        facecolor="none",<br/>    )<br/>    ax[i // 3, i % 3].add_patch(bbox_rect)<br/>plt.show()</span></pre><p id="8287" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">è¿™æ˜¯ç»“æœã€‚å¦‚æœæ‚¨éœ€è¦ä¸€äº›ç‰¹å®šçš„è¾¹ç•Œæ¡†æ‰©å……ï¼Œè¯·å‚è€ƒ<a class="ae my" href="https://albumentations.ai/docs/getting_started/bounding_boxes_augmentation/" rel="noopener ugc nofollow" target="_blank">åŸå§‹æ–‡æ¡£</a>ã€‚</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oi"><img src="../Images/6f94382d4be24eb6ce0197a21b65d9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8big8pMw2OdSi0aa5DcWQ.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated"><em class="ko">å›¾åƒã€‚è¿è¡ŒåŒæ­¥å›¾åƒ<br/>å’Œè¾¹ç•Œæ¡†æ‰©å……ä»£ç æ—¶çš„è¾“å‡ºã€‚ä½œè€…å›¾ç‰‡</em></p></figure><p id="05bd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">å¤šä¸ªç›®æ ‡çš„åŒæ—¶å¢å¼ºã€‚é™¤äº†å…è®¸åŒæ—¶<a class="ae my" href="https://albumentations.ai/docs/getting_started/mask_augmentation/" rel="noopener ugc nofollow" target="_blank">å¢åŠ å‡ ä¸ªé®ç½©</a>æˆ–<a class="ae my" href="https://albumentations.ai/docs/getting_started/bounding_boxes_augmentation/" rel="noopener ugc nofollow" target="_blank">å‡ ä¸ªè¾¹ç•Œæ¡†</a>ä¹‹å¤–ï¼ŒAlbumentationsè¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½å¯ä»¥åŒæ—¶å¢åŠ ä¸åŒç±»å‹çš„æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªé®ç½©å’Œä¸€ä¸ªè¾¹ç•Œæ¡†ã€‚</p><p id="8760" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">å½“è°ƒç”¨â€œè½¬æ¢â€æ—¶ï¼Œç®€å•åœ°ç»™å®ƒä½ æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡:</p><pre class="kq kr ks kt gt no np nq nr aw ns bi"><span id="8818" class="nt mc iq np b gy nu nv l nw nx"># define augmentation <br/>transform = A.Compose([<br/>     A.RandomCrop(width=256, height=256, p=1),<br/>     A.HorizontalFlip(p=0.5), <br/>], bbox_params=A.BboxParams(format='coco', label_fields=["bbox_classes"]))</span><span id="5f4f" class="nt mc iq np b gy ny nv l nw nx"># augment and visualize <br/>bboxes = [bbox]<br/>bbox_classes = ["horse"]</span><span id="4111" class="nt mc iq np b gy ny nv l nw nx">fig, ax = plt.subplots(2, 3, figsize=(15, 10))<br/>for i in range(6):<br/>    <strong class="np ja">transformed = transform(<br/>        image=image, <br/>        mask=mask, <br/>        bboxes=bboxes, <br/>        bbox_classes=bbox_classes<br/>    )</strong><br/>    ax[i // 3, i % 3].imshow(transformed["image"])<br/>    trans_bbox = transformed["bboxes"][0]<br/>    bbox_rect = patches.Rectangle(<br/>        trans_bbox[:2],<br/>        trans_bbox[2],<br/>        trans_bbox[3],<br/>        linewidth=2,<br/>        edgecolor="r",<br/>        facecolor="none",<br/>    )<br/>    ax[i // 3, i % 3].add_patch(bbox_rect)<br/>    ax[i // 3, i % 3].imshow(transformed["mask"], alpha=0.3, cmap="gray_r")<br/>plt.show()</span></pre><p id="1cbc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">æ‚¨çš„ç»“æœå°†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™é‡Œæ˜¯å…³äºé‚£ä¸ªçš„<a class="ae my" href="https://albumentations.ai/docs/getting_started/simultaneous_augmentation/" rel="noopener ugc nofollow" target="_blank">æ›´è¯¦ç»†çš„æ–‡æ¡£ã€‚</a></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/d656fb341376a0e8147db8852fa04b65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wCEsbvSVK7xDq0GWjQ-SHQ.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated"><em class="ko">å½¢è±¡ã€‚è¿è¡ŒåŒæ­¥å›¾åƒã€åˆ†å‰²é®ç½©ã€<br/>å’Œè¾¹ç•Œæ¡†å¢å¼ºä»£ç æ—¶çš„è¾“å‡ºã€‚åˆ†å‰²è’™ç‰ˆè¢«å¯è§†åŒ–ä¸ºé€æ˜çš„<br/>é»‘ç™½å›¾åƒ(1ä¸ºé»‘è‰²ï¼Œâ€˜é©¬â€™)ã€‚ä½œè€…å›¾ç‰‡</em></p></figure><p id="828a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">è¿˜æœ‰æ›´å¤šã€‚</strong>albuminationsæœ‰æ›´å¤šå¯ç”¨çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å¯¹<a class="ae my" href="https://albumentations.ai/docs/getting_started/keypoints_augmentation/" rel="noopener ugc nofollow" target="_blank">å…³é”®ç‚¹</a>å’Œ<a class="ae my" href="https://albumentations.ai/docs/autoalbument/" rel="noopener ugc nofollow" target="_blank">è‡ªåŠ¨å¢å¼º</a>çš„å¢å¼ºã€‚å®ƒåŒ…æ‹¬å¤§çº¦60ç§ä¸åŒçš„å¢å¼ºç±»å‹ï¼Œå­—é¢æ„æ€æ˜¯ä½ éœ€è¦çš„ä»»ä½•ä»»åŠ¡ã€‚</p><p id="d001" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œä½ å°†ä½¿ç”¨ç™½è›‹ç™½ä½œä¸ºPyTorchæˆ–TensorFlowåŸ¹è®­ç®¡é“çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘å°†ç®€è¦æè¿°å¦‚ä½•åšã€‚</p><p id="d167" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">PyTorch ã€‚å½“<a class="ae my" href="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html#creating-a-custom-dataset-for-your-files" rel="noopener ugc nofollow" target="_blank">åˆ›å»ºè‡ªå®šä¹‰æ•°æ®é›†</a>æ—¶ï¼Œåœ¨` __init__ 'å‡½æ•°ä¸­å®šä¹‰Albumentationsè½¬æ¢ï¼Œå¹¶åœ¨` __getitem__ 'å‡½æ•°ä¸­è°ƒç”¨å®ƒã€‚PyTorchæ¨¡å‹è¦æ±‚è¾“å…¥æ•°æ®æ˜¯å¼ é‡ï¼Œæ‰€ä»¥ç¡®ä¿åœ¨å®šä¹‰â€œtransformâ€æ—¶å°†â€œToTensorV2â€ä½œä¸ºæœ€åä¸€æ­¥æ·»åŠ (è¿™æ˜¯ä¸€ä¸ªæ¥è‡ªAlbumentationsæ•™ç¨‹ä¹‹ä¸€çš„æŠ€å·§)ã€‚</p><pre class="kq kr ks kt gt no np nq nr aw ns bi"><span id="c09b" class="nt mc iq np b gy nu nv l nw nx">from torch.utils.data import Dataset<br/>from albumentations.pytorch import ToTensorV2</span><span id="5662" class="nt mc iq np b gy ny nv l nw nx">class CustomDataset(Dataset):<br/>    def __init__(self, images, masks):<br/>        self.images = images  # assume it's a list of numpy images<br/>        self.masks = masks  # assume it's a list of numpy masks<br/>        <strong class="np ja">self.transform = A.Compose([<br/>            A.RandomCrop(width=256, height=256, p=1),<br/>            A.HorizontalFlip(p=0.5),<br/>            ToTensorV2,<br/>        ])</strong></span><span id="4200" class="nt mc iq np b gy ny nv l nw nx">    def __len__(self):<br/>        return len(self.images)</span><span id="2354" class="nt mc iq np b gy ny nv l nw nx">    def __getitem__(self, idx):<br/>        """Returns a single sample"""<br/>        image = self.images[idx]<br/>        mask = self.masks[idx]<br/>        <strong class="np ja">transformed = self.transform(image=image, mask=mask)<br/>        transformed_image = transformed["image"]<br/>        transformed_mask = transformed["mask"]</strong><br/>        return transformed_image, transformed_mask</span></pre><p id="738b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> TensorFlow </strong> (Keras API)ä¹Ÿå…è®¸åˆ›å»º<a class="ae my" href="https://www.tensorflow.org/api_docs/python/tf/keras/utils/Sequence" rel="noopener ugc nofollow" target="_blank">è‡ªå®šä¹‰æ•°æ®é›†</a>ï¼Œç±»ä¼¼äºPyTorchã€‚å› æ­¤ï¼Œåœ¨â€œ__init__â€å‡½æ•°ä¸­å®šä¹‰Albumentationsè½¬æ¢ï¼Œå¹¶åœ¨â€œ__getitem__â€å‡½æ•°ä¸­è°ƒç”¨å®ƒã€‚å¾ˆç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿ</p><pre class="kq kr ks kt gt no np nq nr aw ns bi"><span id="e476" class="nt mc iq np b gy nu nv l nw nx">from tensorflow import keras</span><span id="bc29" class="nt mc iq np b gy ny nv l nw nx">class CustomDataset(keras.utils.Sequence):<br/>    def __init__(self, images, masks):<br/>        self.images = images<br/>        self.masks = masks<br/>        self.batch_size = 1<br/>        self.img_size = (256, 256)<br/>        <strong class="np ja">self.transform = A.Compose([<br/>            A.RandomCrop(width=256, height=256, p=1), <br/>            A.HorizontalFlip(p=0.5),<br/>        ])</strong></span><span id="fcb0" class="nt mc iq np b gy ny nv l nw nx">    def __len__(self):<br/>        return len(self.images) // self.batch_size</span><span id="91c8" class="nt mc iq np b gy ny nv l nw nx">    def __getitem__(self, idx):<br/>        """Returns a batch of samples"""<br/>        i = idx * self.batch_size<br/>        batch_images = self.images[i : i + self.batch_size]<br/>        batch_masks = self.masks[i : i + self.batch_size]<br/>        batch_images_stacked = np.zeros(<br/>            (self.batch_size,) + self.img_size + (3,), dtype="uint8"<br/>        )<br/>        batch_masks_stacked = np.zeros(<br/>            (self.batch_size,) + self.img_size, dtype="float32"<br/>        )<br/>        for i in range(len(batch_images)):<br/>            <strong class="np ja">transformed = self.transform(<br/>                image=batch_images[i], <br/>                mask=batch_masks[i]<br/>            )<br/>            batch_images_stacked[i] = transformed["image"]<br/>            batch_masks_stacked[i] = transformed["mask"]</strong><br/>        return batch_images_stacked, batch_masks_stacked</span></pre><p id="18e2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">å°±æ˜¯è¿™æ ·ï¼å¸Œæœ›è¿™ç¯‡æ•™ç¨‹é¼“åŠ±ä½ ä¸‹æ¬¡åœ¨åšåˆ†å‰²ã€ç‰©ä½“æ£€æµ‹æˆ–å…³é”®ç‚¹å®šä½ä»»åŠ¡æ—¶å°è¯•Albumentationsã€‚å¦‚æœæœ‰ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼</p></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><p id="ec3b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="oj">åŸè½½äº</em><a class="ae my" href="https://notrocketscience.blog/" rel="noopener ugc nofollow" target="_blank"><em class="oj">notrocketseconomy . blog</em></a></p><p id="d62e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="oj">å¦‚æœä½ æƒ³é˜…è¯»æ›´å¤šç±»ä¼¼çš„æ•™ç¨‹ï¼Œå¯ä»¥è®¢é˜…æˆ‘çš„åšå®¢â€œéç«ç®­ç§‘å­¦â€â€”â€”</em><a class="ae my" href="https://t.me/notrocketscienceblog" rel="noopener ugc nofollow" target="_blank"><em class="oj">ç”µæŠ¥</em> </a> <em class="oj">å’Œ</em> <a class="ae my" href="https://twitter.com/nRocketScience" rel="noopener ugc nofollow" target="_blank"> <em class="oj">æ¨ç‰¹</em> </a> <em class="oj">ã€‚</em></p></div></div>    
</body>
</html>