<html>
<head>
<title>How to get notified when your model is done training with knockknock.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在您的模型完成knockknock训练时得到通知？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-get-notified-when-your-model-is-done-training-with-knockknock-483a0475f82c?source=collection_archive---------31-----------------------#2021-05-12">https://towardsdatascience.com/how-to-get-notified-when-your-model-is-done-training-with-knockknock-483a0475f82c?source=collection_archive---------31-----------------------#2021-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="367e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用这个Python库来发送模型训练更新。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/676572e7114c933e3c5767bc606198f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TI2lGxJ284DxnPCBFlzllw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">萨拉·库菲在<a class="ae ky" href="https://unsplash.com/s/photos/iphone-mail?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9449" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下这个场景——你正在进行一个深度学习项目，刚刚在GPU上开始了一项耗时的培训工作。根据你的估计，完成这项工作大约需要15个小时。显然，你不想看你的火车模型那么久。但是当你离开电脑或者在做不同的工作时，你仍然想知道它什么时候结束训练。</p><p id="e866" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，HuggingFace发布了一个名为knockknock的Python库，允许开发人员设置并在他们的模型完成训练时接收通知。<strong class="lb iu">在本文中，我将用几行代码演示如何使用knockknock在各种平台上接收模型训练更新！</strong></p><h1 id="5a9d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装敲门</h1><p id="1ba9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">您可以使用下面的命令通过Pip轻松安装knockknock。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="92dc" class="mx lw it mt b gy my mz l na nb">pip install knockknock</span></pre><p id="5535" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，这个库只针对Python 3.6和更高版本进行了测试。如果你有一个早期版本的Python，如果你想使用这个库，我建议你升级到Python 3.6或更高版本。</p><h1 id="0fe9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">训练一个简单的神经网络</h1><p id="1cc2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了演示这个库，我将定义一个函数，在经典的MNIST手写数字数据集上训练一个简单的CNN。要找到本教程的完整代码，请查看这个<a class="ae ky" href="https://github.com/AmolMavuduru/KnockKnockExamples" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>。</p><h2 id="8650" class="mx lw it bd lx nc nd dn mb ne nf dp mf li ng nh mh lm ni nj mj lq nk nl ml nm bi translated">导入库</h2><p id="6c9f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了开始，我们需要从Keras导入一些模块。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="0ae3" class="mx lw it mt b gy my mz l na nb">from keras.utils.np_utils import to_categorical<br/>from keras.models import Sequential<br/>from keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Dropout, Activation<br/>from keras.datasets import mnist</span></pre><h2 id="0805" class="mx lw it bd lx nc nd dn mb ne nf dp mf li ng nh mh lm ni nj mj lq nk nl ml nm bi translated">加载数据</h2><p id="03f9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了简化本教程，我使用Keras加载了MNIST数据集。我在下面的代码中执行了以下标准预处理步骤:</p><ol class=""><li id="aa9f" class="nn no it lb b lc ld lf lg li np lm nq lq nr lu ns nt nu nv bi translated">为28 x 28像素的训练和测试图像增加了一个额外的维度。</li><li id="8fc8" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated">将训练和测试数据缩放了255。</li><li id="bdf0" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated">将数字目标转换为分类的一次性向量。</li></ol><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d939" class="mx lw it mt b gy my mz l na nb">(X_train, y_train), (X_test, y_test) = mnist.load_data()<br/>X_train = X_train.reshape(X_train.shape[0], 28, 28,1) # adds extra dimension<br/>X_test = X_test.reshape(X_test.shape[0], 28, 28, 1) # adds extra dimension<br/>input_shape = (28, 28, 1)</span><span id="e857" class="mx lw it mt b gy ob mz l na nb">X_train = X_train.astype('float32')<br/>X_test = X_test.astype('float32')<br/>X_train /= 255<br/>X_test /= 255</span><span id="e0a3" class="mx lw it mt b gy ob mz l na nb">y_train = to_categorical(y_train)<br/>y_test = to_categorical(y_test)</span></pre><h2 id="3261" class="mx lw it bd lx nc nd dn mb ne nf dp mf li ng nh mh lm ni nj mj lq nk nl ml nm bi translated">训练模型</h2><p id="f014" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">下面的函数创建一个简单的CNN，在训练数据集上对其进行训练，并返回准确性和损失值，以展示模型在测试数据集上的性能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用于在输入数据集上训练和测试简单CNN的函数。</p></figure><p id="4e3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不会在上面的代码中详细介绍神经网络的架构，因为本教程的重点是发送模型训练通知。为此，我特意使用了一个简单的神经网络。</p><h1 id="3c09" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">获取桌面通知</h1><p id="0bc2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们有了一个训练神经网络的函数，我们可以创建另一个训练模型的函数，并在函数开始和结束执行时创建桌面通知。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="5a51" class="mx lw it mt b gy my mz l na nb">from knockknock import desktop_sender</span><span id="baa0" class="mx lw it mt b gy ob mz l na nb"><a class="ae ky" href="http://twitter.com/desktop_sender" rel="noopener ugc nofollow" target="_blank">@desktop_sender</a>(title="Knockknock Desktop Notifier")<br/>def train_model_desktop_notify(X_train, y_train, X_test, y_test):<br/>    <br/>    return train_model(X_train, <br/>                       y_train, <br/>                       X_test, <br/>                       y_test)</span><span id="e8d0" class="mx lw it mt b gy ob mz l na nb">train_model_desktop_notify(X_train, y_train, X_test, y_test)</span></pre><p id="562b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的Mac上，运行上面的代码会在训练过程开始时产生一个弹出通知。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/8b4dc81e3d72eb79ce1170d878465167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0e8oFvCe9g-rbl8tCrK0Gw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">培训作业开始时的桌面通知。</p></figure><p id="26b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦作业完成运行，它将生成另一个桌面通知，并显示函数的结果，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/db8115f06f1494211ad30e6dd0933d8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aoZ980RZuKyFrGM57jnBVA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">培训工作完成时的桌面通知。</p></figure><h1 id="ded3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">获取电子邮件通知</h1><p id="394a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们还可以用knockknock设置电子邮件通知。为此，您需要设置一个单独的Gmail帐户来发送电子邮件通知。您还需要在安全设置中<a class="ae ky" href="https://devanswers.co/allow-less-secure-apps-access-gmail-account/" rel="noopener ugc nofollow" target="_blank">允许不太安全的应用程序访问您的Gmail帐户</a>。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="61d0" class="mx lw it mt b gy my mz l na nb">from knockknock import email_sender</span><span id="90d5" class="mx lw it mt b gy ob mz l na nb"><a class="ae ky" href="http://twitter.com/email_sender" rel="noopener ugc nofollow" target="_blank">@email_sender</a>(recipient_emails=["<a class="ae ky" href="mailto:amolmavuduru@gmail.com" rel="noopener ugc nofollow" target="_blank">amolmavuduru@gmail.com</a>"], <br/>              sender_email="<a class="ae ky" href="mailto:knockknocknotificationstest@gmail.com" rel="noopener ugc nofollow" target="_blank">knockknocknotificationstest@gmail.com</a>")<br/>def train_model_email_notify(X_train, y_train, X_test, y_test):<br/>    <br/>    return train_model(X_train, <br/>                       y_train, <br/>                       X_test, <br/>                       y_test)</span><span id="b189" class="mx lw it mt b gy ob mz l na nb">train_model_email_notify(X_train, y_train, X_test, y_test)</span></pre><p id="53bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码会在Gmail中生成以下电子邮件通知。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/88e9c5a56e8d9f27ca97152d7e7dfd54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1QL8EBuH9f6qKhSymhNgBQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Knockknock中的训练开始通知。</p></figure><p id="e847" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当该功能完成运行时，我们会收到另一封通知电子邮件，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/cfeed6b340fd32c0e2eabf87166da1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1hS_AELBkx17k64d97LiPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Knockknock中的训练完成通知。</p></figure><h1 id="44fb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">获取时差通知</h1><p id="d1ca" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">最后，如果您是正在进行机器学习项目的Slack团队的一员，您还可以在模型运行结束时在通道中设置Slack通知。为此，您需要创建一个Slack工作区，向其中添加一个Slack应用程序，并获得一个Slack webhook URL，您可以将它提供给<strong class="lb iu"> slack_sender </strong>函数装饰器。访问<a class="ae ky" href="https://api.slack.com/" rel="noopener ugc nofollow" target="_blank"> Slack API页面</a>，然后按照本教程<a class="ae ky" href="https://api.slack.com/messaging/webhooks#create_a_webhook" rel="noopener ugc nofollow" target="_blank">中的步骤1-3</a>创建一个webhook。</p><p id="a6c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码演示了如何在给定一个webhook URL和一个特定的发布渠道的情况下创建一个Slack通知。请注意，出于安全原因，我将我的webhook URL存储在一个环境变量中。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6526" class="mx lw it mt b gy my mz l na nb">from knockknock import slack_sender<br/>import os</span><span id="b2ba" class="mx lw it mt b gy ob mz l na nb">webhook_url = os.environ['KNOCKKNOCK_WEBHOOK']<br/><a class="ae ky" href="http://twitter.com/slack_sender" rel="noopener ugc nofollow" target="_blank">@slack_sender</a>(webhook_url=webhook_url, channel="#general")<br/>def train_model_slack_notify(X_train, y_train, X_test, y_test):<br/>    <br/>    return train_model(X_train, <br/>                       y_train, <br/>                       X_test, <br/>                       y_test)</span><span id="c8b0" class="mx lw it mt b gy ob mz l na nb">train_model_slack_notify(X_train, y_train, X_test, y_test)</span></pre><p id="87aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行上面的代码会产生以下时差通知。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/e1493dd6b631af8b8394d49e19465a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aZc6HP1TWSq4_CWn99mrAg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练模型时产生的时差通知。</p></figure><p id="3163" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的数据科学团队有一个宽松的工作空间，并希望监控您的模型培训工作，这是一个很好的功能。</p><h1 id="7624" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">更多通知选项</h1><p id="f225" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">使用knockknock，我们还可以在以下平台上发送通知:</p><ul class=""><li id="5f9b" class="nn no it lb b lc ld lf lg li np lm nq lq nr lu oi nt nu nv bi translated">电报</li><li id="1c14" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">微软团队</li><li id="cc67" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">正文消息</li><li id="da0e" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">不调和</li><li id="147c" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">[数]矩阵</li><li id="837b" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">亚马逊钟声</li><li id="f2b8" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">瞎扯</li><li id="243e" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">RocketChat</li><li id="4ea5" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu oi nt nu nv bi translated">微信工作</li></ul><p id="77df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关如何在这些平台上发送通知的详细文档，请务必查看GitHub 上的<a class="ae ky" href="https://github.com/huggingface/knockknock" rel="noopener ugc nofollow" target="_blank">项目资源库。</a></p><h1 id="07af" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">摘要</h1><p id="167b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Knockknock是一个有用的工具，它可以让您通过通知来跟踪您的模型训练作业。您可以使用它在各种各样的平台上发送通知，它对于跟踪数据科学团队的实验非常有用。</p><p id="2cab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像往常一样，你可以在GitHub 上找到本文中的所有代码。</p><h1 id="7270" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">加入我的邮件列表</h1><p id="e004" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">你想在数据科学和机器学习方面变得更好吗？您想了解数据科学和机器学习社区的最新图书馆、开发和研究吗？</p><p id="8932" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">加入我的<a class="ae ky" href="https://mailchi.mp/e8dd82679724/amols-data-science-blog" rel="noopener ugc nofollow" target="_blank">邮件列表</a>，获取我的数据科学内容的更新。当你<a class="ae ky" href="https://mailchi.mp/e8dd82679724/amols-data-science-blog" rel="noopener ugc nofollow" target="_blank">注册</a>时，你还会得到我免费的<strong class="lb iu">解决机器学习问题的逐步指南</strong>！</p><h1 id="9c1c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">来源</h1><ol class=""><li id="c574" class="nn no it lb b lc mn lf mo li oj lm ok lq ol lu ns nt nu nv bi translated">抱紧脸，<a class="ae ky" href="https://github.com/huggingface/knockknock" rel="noopener ugc nofollow" target="_blank"> knockknock Github库</a>，(2020)。</li></ol></div></div>    
</body>
</html>