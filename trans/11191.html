<html>
<head>
<title>How to Write Excel-like Formulas in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python编写类似Excel的公式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-write-excel-like-formulas-in-python-4bdacab75a53?source=collection_archive---------8-----------------------#2021-11-02">https://towardsdatascience.com/how-to-write-excel-like-formulas-in-python-4bdacab75a53?source=collection_archive---------8-----------------------#2021-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4efb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何使用Python中的米托包编写类似Excel的公式的简短教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5036b715008fc6c1665b3ee8365a8090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wNh9YGdSXYZOmpw7"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乔安娜·科辛斯卡在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7706" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> M </span>任何Python用户都在从电子表格过渡，因为Python包允许用户使用类似Excel的语法。这是一个用于JupyterLab的电子表格环境，可以帮助您进行Python分析。</p><p id="c1c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">认识一下米托——一个将交互式电子表格初始化到JupyterLab环境中的Python包。对于您在电子表格中所做的每一次编辑，米托都会生成生产就绪的Python代码。也是免费使用。</p><p id="cffc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过阅读这篇文章，你将学会:</p><ul class=""><li id="324d" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">如何在Python中执行基本的类似Excel的操作</li><li id="8839" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">如何用Python编写类似Excel的公式</li></ul><p id="3519" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你错过了我之前关于这个主题的文章，请参见<a class="ae ky" href="https://romanorac.medium.com/list/mito-a-spreadsheet-that-generates-python-1df29fc67dff" rel="noopener">米托——一个生成Python </a>的电子表格。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="92ce" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">Python中的Excel语法</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用米托2.0进行数据切片</p></figure><p id="1af8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用Excel语法，首先使用以下命令初始化Mitosheet:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="f144" class="ny na it nu b gy nz oa l ob oc">import mitosheet<br/>mitosheet.sheet()</span></pre><p id="cc6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将呈现交互式电子表格，您可以:</p><ul class=""><li id="dc6a" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">从本地文件传入数据集</li><li id="8430" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">或者，您可以传入笔记本中现有的数据帧作为Mitosheet调用的参数:</li></ul><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="6e58" class="ny na it nu b gy nz oa l ob oc">mitosheet.sheet(df))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/fbf84676ed2bcd16adeb96a442e1b307.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ilJg2LgoPUnZ_d1KjhuuOw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将本地文件导入米托表单(图片由作者提供)</p></figure><h2 id="b426" class="ny na it bd nb oe of dn nf og oh dp nj li oi oj nl lm ok ol nn lq om on np oo bi translated">以防你还没有安装米托</h2><p id="e4b9" class="pw-post-body-paragraph kz la it lb b lc op ju le lf oq jx lh li or lk ll lm os lo lp lq ot ls lt lu im bi translated">要安装米托，请运行以下命令:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="1e9d" class="ny na it nu b gy nz oa l ob oc">python -m pip install mitoinstaller<br/>python -m mitoinstaller install</span></pre><p id="4bdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是完整的<a class="ae ky" href="https://docs.trymito.io/getting-started/installing-mito" rel="noopener ugc nofollow" target="_blank">安装说明。</a></p><h1 id="2248" class="mz na it bd nb nc ou ne nf ng ov ni nj jz ow ka nl kc ox kd nn kf oy kg np nq bi translated">添加一列米托</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/1ba23fd632634f525c6c070f45ec0486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KGnDMmqoYcHy6dPLrq-JiA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在米托表单中添加新列(图片由作者提供)</p></figure><p id="1007" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要添加列，请单击Mitosheet顶部工具栏中的“添加列”按钮。使用新列，您可以使用电子表格函数和公式。</p><p id="3d79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您添加一个列时，它会在Mitosheet下面的代码单元中生成等效的Python。</p><h2 id="0c23" class="ny na it bd nb oe of dn nf og oh dp nj li oi oj nl lm ok ol nn lq om on np oo bi translated">用米托重命名列</h2><p id="5750" class="pw-post-body-paragraph kz la it lb b lc op ju le lf oq jx lh li or lk ll lm os lo lp lq ot ls lt lu im bi translated">要重命名某个列，只需双击该列的标题，然后键入您想要的新标题。</p><h1 id="861f" class="mz na it bd nb nc ou ne nf ng ov ni nj jz ow ka nl kc ox kd nn kf oy kg np nq bi translated">使用Excel函数</h1><p id="4afd" class="pw-post-body-paragraph kz la it lb b lc op ju le lf oq jx lh li or lk ll lm os lo lp lq ot ls lt lu im bi translated">在新列的单元格中，您可以分配一个公式。</p><p id="7728" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在新的专栏中，您可以使用普通的类似Excel的函数，米托将生成等效的Python代码。</p><p id="c7e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您开始键入函数时，下面的菜单中将显示一个可供选择的函数建议列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/1c04e0936eee0a4c6b80fe370ad85c12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8GZFgZFZr_qJnV12nmWiwA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用米托工作表编写类似Excel的公式(图片由作者提供)</p></figure><p id="456e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图中使用的函数生成了等效的Python(这是自动记录的)。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="7645" class="ny na it nu b gy nz oa l ob oc">Airport_Pets_csv['New_Column'] = IF(Airport_Pets_csv['Division'] == "Central", 1, 0)</span></pre><p id="a8c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">米托有许多不同类型的Excel函数可以在工作表中使用。您可以使用:</p><ul class=""><li id="01b0" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">日期操作</li><li id="ec04" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">统计分析</li><li id="2cc7" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">数据清理</li><li id="b58f" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">还有更多。</li></ul><p id="8454" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关所有支持的类似Excel的公式，请参见公式<a class="ae ky" href="https://docs.trymito.io/how-to/interacting-with-your-data/mito-spreadsheet-formulas" rel="noopener ugc nofollow" target="_blank">参考页</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/da747e3b088abf10f905932442e3b540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5MkMpkG6yjg7hpJWoox1jw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">米托公式参考页面(由<a class="ae ky" href="https://docs.trymito.io/how-to/interacting-with-your-data/mito-spreadsheet-formulas" rel="noopener ugc nofollow" target="_blank">https://docs . try mito . io/how-to/interactive-with-your-data/mito-spread sheet-formulas</a>页面作者截图)</p></figure><h1 id="1b9d" class="mz na it bd nb nc ou ne nf ng ov ni nj jz ow ka nl kc ox kd nn kf oy kg np nq bi translated">直接编辑数据</h1><p id="03e7" class="pw-post-body-paragraph kz la it lb b lc op ju le lf oq jx lh li or lk ll lm os lo lp lq ot ls lt lu im bi translated">米托允许用户选择数据框中的任何单元格并更改特定值——就像在电子表格中一样。这对于快速数据编辑和数据验证来说是一个重要的特性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/60d961a1d834f896e81b979c0644891f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BaOXUikMD2n5g4fErHhtzQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">编辑米托表单中的列(图片由作者提供)</p></figure><p id="7b0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此编辑会生成等效的代码:</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="7915" class="ny na it nu b gy nz oa l ob oc"># Set column City at index 0 in Airport_Pets_csv to Amherst<br/>Airport_Pets_csv.at[0, 'City'] = "Amherst"</span></pre><h1 id="94e2" class="mz na it bd nb nc ou ne nf ng ov ni nj jz ow ka nl kc ox kd nn kf oy kg np nq bi translated">其他类似Excel的功能</h1><p id="0f98" class="pw-post-body-paragraph kz la it lb b lc op ju le lf oq jx lh li or lk ll lm os lo lp lq ot ls lt lu im bi translated">米托还为用户提供了一个熟悉的电子表格环境来完成其他常见的Python任务。</p><p id="6b09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户可以在交互式设置中创建数据透视表，并让这些数据透视表自动生成等价代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/7432a9f4daeb6e566094a498e240cdc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*USpoHqCxpAATd7NpExvqdQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用米托旋转表格(作者可视化)</p></figure><p id="c0df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户可以生成图形和等价代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/3614c89d75f8dd2ae75d8042bd1a866b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*YYXoQ1h14Hn2pF5AV9fFKQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">与米托一起制作情节(作者视觉化)</p></figure><p id="0db3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">米托还支持常见的分析功能，例如:</p><ul class=""><li id="7a39" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><a class="ae ky" href="https://docs.trymito.io/how-to/filter-data" rel="noopener ugc nofollow" target="_blank">过滤</a></li><li id="e1b8" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><a class="ae ky" href="https://docs.trymito.io/how-to/sort-data" rel="noopener ugc nofollow" target="_blank">排序</a></li><li id="dff5" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><a class="ae ky" href="https://docs.trymito.io/how-to/summary-statistics" rel="noopener ugc nofollow" target="_blank">汇总统计</a></li><li id="b25f" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><a class="ae ky" href="https://docs.trymito.io/how-to/merging-datasets-together" rel="noopener ugc nofollow" target="_blank">合并数据集</a></li><li id="4b37" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><a class="ae ky" href="https://docs.trymito.io/how-to/save-and-repeat-analyses#save-analyses" rel="noopener ugc nofollow" target="_blank">宏</a></li><li id="9bf1" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">导出到CSV</li></ul><h1 id="ea07" class="mz na it bd nb nc ou ne nf ng ov ni nj jz ow ka nl kc ox kd nn kf oy kg np nq bi translated">结论</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/9a996e75554a55a3815802a21cb0858a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cUqgDL7c_jd4AA5a"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@lenstravelier?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Lenstravelier </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="c854" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于那些希望从Excel或Google电子表格环境过渡到Python的人来说，米托是一个强大的工具。</p><p id="4a38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">neet米托的一个特点是它展示了如何计算某些运算。所以你可以边点击分析边学习。</p><p id="48cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名经验丰富的pandas用户，我使用米托进行初步的探索性数据分析。对于米托，我避免一遍又一遍地写同样的熊猫指令。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="624f" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">在你走之前</h1><p id="bbc5" class="pw-post-body-paragraph kz la it lb b lc op ju le lf oq jx lh li or lk ll lm os lo lp lq ot ls lt lu im bi translated"><em class="pc">如果你喜欢看这些故事，为什么不成为</em> <a class="ae ky" href="https://romanorac.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="pc">中等付费会员</em> </strong> </a> <em class="pc">？每月5美元，你可以无限制地阅读10000个故事和作家。</em><strong class="lb iu"><em class="pc"/></strong><a class="ae ky" href="https://romanorac.medium.com/membership" rel="noopener"><strong class="lb iu"><em class="pc">如果你用我的链接</em></strong></a><strong class="lb iu"><em class="pc"/></strong><em class="pc">注册，我会赚一小笔佣金。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/c3b3f316307e1575ab9b5063bffab6c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*srg1Cg8FmC_mxZAD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@alexas_fotos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alexas_Fotos </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div></div>    
</body>
</html>