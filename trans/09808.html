<html>
<head>
<title>Spatio-Temporal ConvLSTM for Crash Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于碰撞预测的时空变换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/spatial-temporal-convlstm-for-crash-prediction-411909ed2cfa?source=collection_archive---------12-----------------------#2021-09-14">https://towardsdatascience.com/spatial-temporal-convlstm-for-crash-prediction-411909ed2cfa?source=collection_archive---------12-----------------------#2021-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/fcd21891243f8da1e3cdb721cc5c5b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wpyktE1BcpaT2E1Mq_xUg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">2015-2019年亚特兰大市的3D场景交通事故。数据源GADOT。作者图片</p></figure><div class=""/><div class=""><h2 id="1622" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated"><strong class="ak"> <em class="ku">一种独特的深度学习方法用于事故预测</em> </strong></h2></div><p id="66c6" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这篇文章讲述了一项独特的实证研究，该研究使用<a class="ae lr" href="https://arxiv.org/abs/1506.04214" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jg"> ConvLSTM </strong> </a>深度学习模型和<strong class="kx jg"> ArcPy </strong>利用碰撞特征数据的时间序列来预测第二天的碰撞风险位置。交通事故被公式化为时空序列预测问题，其中输入和预测数据都是时空序列。卷积LSTM ( <strong class="kx jg"> ConvLSTM </strong>)方法是为崩溃预测建立一个端到端的可训练模型。结果表明<strong class="kx jg"> ConvLSTM </strong>网络能够捕捉交通事故发生的时间和地点的时空相关性。</p><p id="1ab1" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">问题:</strong>交通事故导致严重的人员伤亡和巨大的经济损失。预测时空环境中交通事故风险的能力不仅对于公众而且对于政府官员来说对于预防事故的发生都是重要的。然而，预测交通事故是一项非常具有挑战性的任务，不仅要预测多种因素(如人、时间、几何和环境)的原因，还要预测稀有因素和稀疏数据集。传统的事故预测一般采用统计回归，如<strong class="kx jg">泊松</strong>、<strong class="kx jg">负二项</strong>、<strong class="kx jg">、【NB】、<strong class="kx jg">多元回归</strong>。但是，当处理复杂和高度非线性的数据时，如事故的时空相关性，如事故发生的时间、地点和原因时，它们往往会失败。有经典的机器学习方法，例如<strong class="kx jg"> XGBoost </strong>、<strong class="kx jg"> SVM </strong>和<strong class="kx jg"> RandomForest </strong>分类器，它们将特征设计到模型<a class="ae lr" href="https://github.com/gitWayneZhang/my_Spark/blob/master/right_angle%20crash%20prediction.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="ls">中，以寻求特征对于概率</em> </a>的重要性。我们正在讨论机器学习中的特征，即多维空间中的数字阵列。要了解更多机器学习中的特征工程，请阅读来自<a class="ae lr" href="https://storymaps.arcgis.com/stories/19d90071cee34cf09acce4d00d758357" rel="noopener ugc nofollow" target="_blank"> <em class="ls">丹尼尔·克拉尔</em> </a>的一个最好的故事。</strong></p><p id="358a" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，时间和季节性在决定何时何地发生事故的概率方面起着重要作用。使用ArcGIS Pro中的ArcPy，我们可以聚合特定时间窗口内的崩溃位置。<a class="ae lr" href="https://cobbcountyga.maps.arcgis.com/home/webscene/viewer.html?webscene=15780a20c76b4f11b09e5c350052c4be" rel="noopener ugc nofollow" target="_blank"> <em class="ls">点击查看3D场景中</em> </a>坠机地点示例。</p><p id="6177" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">解决方案:</strong>那么，我们是否可以应用经典的机器学习模型来搜索重要的因果特征，然后提出一个实用的深度学习网络来预测事故发生的时间和地点？答案是肯定的。<strong class="kx jg"> ConvLSTM </strong>模型是最有趣的深度学习模型之一，用于预测下一帧视频或图像。最初的研究是针对<a class="ae lr" href="https://arxiv.org/abs/1506.04214" rel="noopener ugc nofollow" target="_blank"> <em class="ls">降水临近预报</em> </a>进行的。为了更好地理解<strong class="kx jg"> ConvLSTM </strong>模型，我们先来看看普通的<strong class="kx jg"> LSTM </strong>网络模型。<a class="ae lr" href="https://en.wikipedia.org/wiki/Long_short-term_memory" rel="noopener ugc nofollow" target="_blank"><em class="ls"/><strong class="kx jg"><em class="ls">(LSTM</em></strong><em class="ls">)</em></a>网络是一种具有反馈连接的人工递归神经网络(<strong class="kx jg"/><em class="ls">)</em>。它不仅可以处理单个数据点(如图像)，还可以处理整个数据序列(如语音或视频)。以下是迈克尔·菲尔为《LSTM解说指南》制作的最佳解说视频之一。也可以看<a class="ae lr" rel="noopener" target="_blank" href="/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21"> <em class="ls">他的博客</em> </a> <em class="ls">。</em></p><figure class="lt lu lv lw gt is"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="3e1a" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有用吗？现在，让我们看看什么是<strong class="kx jg"> ConvLSTM </strong>。简单的说，<strong class="kx jg"> ConvLSTM </strong>就是<strong class="kx jg"> CNN </strong>卷积神经网络结合<strong class="kx jg"> LSTM </strong>网络。不是只有数据序列的输入，它的输入是最适合图像和视频的<strong class="kx jg"> CNN </strong>卷积神经网络的数据序列。这种组合确保<strong class="kx jg"> ConvLSTM </strong>捕捉潜在的局部时空相关性。<strong class="kx jg"> ConvLSTM </strong>的关键方程和内部结构图见下图1。</p><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lz"><img src="../Images/453d29bed93864886083d5496e68de74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V1rAzn1vSAv51aNvkrN_KA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图一。图片来自<a class="ae lr" href="http://homepage.divms.uiowa.edu/~zhuoning/papers/p984-yuan.pdf" rel="noopener ugc nofollow" target="_blank">http://home page . div ms . uio wa . edu/~宁拙/papers/p984-yuan.pdf </a></p></figure><p id="b893" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">工作原理:</strong>这项实证研究的目标是利用<strong class="kx jg"> ConvLSTM </strong>网络，设计先前的事故数据序列，以预测科布县固定时间段内的车祸地点。每个事故都有记录的时间和位置坐标。想象每个时间段，即每两个小时，是时空空间中的一个画面。当堆叠这些碰撞图像帧并馈入<strong class="kx jg"> ConvLSTM </strong>网络时，我们可以预测固定长度，即接下来几个小时的交通事故图像帧。为了将数据拟合到模型中，数据将被公式化为3D张量，例如图像，并作为具有上述特征的4D张量序列进行叠加，作为第四维。(序列、图像、图像、特征)。使用<strong class="kx jg"> ArcPy </strong>将整个科布县地区划分为45hx41w(总共1845个，每个0.25英里)的方形箱。在这个初始项目中，我使用七天的碰撞序列数据作为模型的输入，并预测第二天的碰撞图像地图，因为县一级的碰撞数据非常稀少，并且具有很强的每周模式。将有另一个项目来预测未来两个小时的崩溃使用相同的模型和算法。当应用<em class="ls"/><a class="ae lr" href="https://github.com/gitWayneZhang/my_Spark/blob/master/right_angle%20crash%20prediction.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="ls"/><strong class="kx jg"><em class="ls">XGBoost和RandomForest </em> </strong> <em class="ls">模型</em></a><em class="ls"/>时，总结出了导致科布交通事故的11个重要特征。这些特征属性包括不随时间变化的变量，如道路长度、道路曲率、平均坡度、人口密度等。以及时变变量，例如天气、一天中的时间、事故和位置等。这些特征被格式化为4D张量的第四维(7，45，41，11)。三年的科布县事故数据被处理并批量输入<strong class="kx jg"> ConvLSTM </strong>模型，其中90%为训练序列，10%为测试序列。每个序列一天移位一次，总共1096个序列用于训练和测试。输出预测是第二天在1845个箱中发生的碰撞(参见图2显示堆叠的县碰撞箱地图的解释性图片。蓝色的箱子是在那个时间段发生事故的箱子)</p><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ma"><img src="../Images/c0274d18ec43dd6f4598dad0faee9ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wty2Vy9BRLizhuakUpBoBg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图二。作者图片</p></figure><p id="6b8a" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">建立模型，训练数据，进行风险预测</strong></p><p id="b5fd" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">幕后</strong>:典型的深度学习模型是工程化数据集，建立模型，训练数据，进行预测，部署模型。用<strong class="kx jg"> <em class="ls">二元交叉熵</em> </strong>和<strong class="kx jg"> <em class="ls">亚当</em> </strong>优化器对模型进行50个历元的训练(实际上可以训练几百个历元)。结果证明很有希望。上面的图库显示了除数据工程部分之外的一些步骤。随机选择2020年12月12日的地面实况和预测样本，这在训练中没有使用。通过使用一定的概率阈值直观地比较实际情况和预测，该模型可以预测当天最匹配的碰撞位置和模式。参见图3。</p><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mb"><img src="../Images/254f03339e21c2cb335258de4e5a8a0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ypfksv33Fdr8GZA6JWEjIQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图3。作者图片</p></figure><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mc"><img src="../Images/a963fab3b1c42a203a1e3d6034de932d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Cf8ScC-ErdnXY8SnjGcTQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="d8eb" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">结果:</strong>通过几行<strong class="kx jg"> ArcPy </strong>代码，我们可以将模型输出记录添加到<strong class="kx jg"> ArcGIS </strong> Pro中的格网要素类和地图中。使用符号化的道路和其他要素，在<strong class="kx jg"> ArcGIS Pro </strong>中更易于可视化。</p><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi md"><img src="../Images/6e63a4a2d61a4e82d6b5dab253db2ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvTJvkrhPIOgqfVRn2xntQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi me"><img src="../Images/9afcc59685fab526043a44ff730152ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3huRMp35b63FoW5-nI3fwA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="87c1" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">为什么重要:</strong>这个实证研究项目展示了我们如何使用<strong class="kx jg"> ArcPy </strong>和深度学习技术，如<strong class="kx jg"> ConvLSTM </strong>来找到一个有希望的崩溃预测解决方案。整个工作流和数据流程可通过更多工程要素和数据得到进一步增强，在<strong class="kx jg"> ESRI ArcGIS </strong> Pro desktop中实现自动化、部署和制图，或成为<strong class="kx jg"> ArcGIS </strong>企业服务。因此，同样的方法可以应用于交通流量、降雨量、犯罪预测等你能想到的造福人类的时空解决方案。</p><p id="affd" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当今世界向我们提出了许多挑战。然而，借助人工智能和深度学习的力量，我们可以共同努力寻求解决方案，让世界变得更加美好。感谢您阅读这个故事地图。</p><p id="1224" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jg">参考文献</strong></p><p id="083d" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[1]邢建石，，陈，，杨迪燕，黄伟建，王春宇，<a class="ae lr" href="https://arxiv.org/abs/1506.04214" rel="noopener ugc nofollow" target="_blank"> <em class="ls">卷积LSTM网络:一种用于降水临近预报的机器学习方法。</em> </a>计算机视觉与模式识别(cs。CV)引用为:<a class="ae lr" href="https://arxiv.org/abs/1506.04214" rel="noopener ugc nofollow" target="_blank">arXiv:1506.04214</a>【cs。简历]</p><p id="ff6e" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[2]袁，，杨天宝，<a class="ae lr" href="http://homepage.divms.uiowa.edu/~zhuoning/papers/p984-yuan.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> Hetero-ConvLSTM:一种基于异构时空数据的交通事故预测深度学习方法</em> </a> <em class="ls">。</em>2018年KDD奥运会，2018年8月19日至23日，英国伦敦。</p><p id="4d68" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[3] Sobhan Moosavi，Mohammad Hossein Samavatian，Srinivasan Parthasarathy，Radu Teodorescu，Rajiv Ramnath，<a class="ae lr" href="https://arxiv.org/abs/1909.09638" rel="noopener ugc nofollow" target="_blank"> <em class="ls">基于异质稀疏数据的事故风险预测:新数据集和见解</em> </a> <em class="ls">。</em>机器学习(cs。LG)；数据库(cs。DB)；as:<a class="ae lr" href="https://arxiv.org/abs/1909.09638" rel="noopener ugc nofollow" target="_blank">arXiv:1909.09638</a>【cs。LG】。</p><p id="6328" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[4] Jeremiah Roland *，Peter D. Way，Connor Firat，Thanh-Nam Doan，Mina Sartipi，<a class="ae lr" href="https://www.sciencedirect.com/science/article/pii/S0001457520316808?via%3Dihub" rel="noopener ugc nofollow" target="_blank">田纳西州查塔努加市车辆事故发生的建模与预测，</a>事故分析与预防149 (2021) 105860</p><p id="26a3" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[5]<a class="ae lr" href="https://pro.arcgis.com/en/pro-app/latest/arcpy/get-started/what-is-arcpy-.htm" rel="noopener ugc nofollow" target="_blank">ESRI·阿皮</a></p><p id="37b8" class="pw-post-body-paragraph kv kw jf kx b ky kz kg la lb lc kj ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[6]丹尼尔·克拉尔，<a class="ae lr" href="https://storymaps.arcgis.com/stories/19d90071cee34cf09acce4d00d758357" rel="noopener ugc nofollow" target="_blank"> <em class="ls">汽车碰撞预测特征工程</em> </a> <em class="ls">。</em>故事地图2020年5月19日</p></div></div>    
</body>
</html>