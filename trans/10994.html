<html>
<head>
<title>Auto Page Refresh in Power BI — Everything You Need to Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Power BI中的自动页面刷新—您需要知道的一切</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/auto-page-refresh-in-power-bi-everything-you-need-to-know-a6e7bd9d0444?source=collection_archive---------26-----------------------#2021-10-26">https://towardsdatascience.com/auto-page-refresh-in-power-bi-everything-you-need-to-know-a6e7bd9d0444?source=collection_archive---------26-----------------------#2021-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2d4e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">您知道Power BI可以自动刷新您的报告页面吗？您知道有两种不同类型的自动刷新吗？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fb0dd0a56129c42d3b58dd38c09cc25f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8-P5jU5TTzljaA0tsMpJiA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/f0dJjQMhfXo" rel="noopener ugc nofollow" target="_blank">由Sigmund在Unsplash上拍摄的图像</a></p></figure><p id="d7ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自动化任务——这是我们都喜欢的东西！而Power BI在这方面做得很出色。尽管其中一些自动化的东西可能会回来困扰你，比如<a class="ae ky" rel="noopener" target="_blank" href="/tiq-part-1-how-to-destroy-your-power-bi-model-with-auto-date-time-8fec32b22aff">自动日期/时间选项</a>，幸运的是还有更多让我们的生活变得更容易。</p><p id="1312" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近研究了自动页面刷新特性，在这篇文章中，我想更多地介绍这个功能——特别是关于特定用例的最佳实践和限制。</p><h2 id="3e46" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">什么是自动页面刷新？</h2><p id="1a9c" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">简而言之，顾名思义，自动页面刷新功能可以让您设置报告中特定页面的<em class="mt">计划刷新！因此，不要将此功能与报告计划刷新混淆，因为自动页面刷新是一个完全不同的故事。第一个至关重要的区别是，自动页面功能仅适用于<a class="ae ky" rel="noopener" target="_blank" href="/direct-query-in-power-bi-what-when-why-8180825812d2"> DirectQuery存储模式</a>(以及某种程度上的实时连接)。<strong class="lb iu"> <em class="mt">不支持导入模式</em> </strong>，切记！</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/d185093bd8d40f8398870d6f3de06e26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4YMEaSZ0KiHp8qT9JAh2cg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7111" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一个重要的考虑是使用哪种类型的自动页面刷新…哦，是的，有两种不同的类型，所以让我们更深入地研究它们。</p><h2 id="fdb6" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">固定间隔</h2><p id="b4c0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这是安排页面自动刷新的基本方式。您可以设置所需的时间间隔(范围从1秒到X天)，当时间间隔到达时，所有的视觉效果都将被刷新。这意味着，每个单独的可视化将生成一个单独的(直接的)查询，并将其发送到底层数据源。但是，在文章的后面会有更多的介绍。</p><h2 id="e892" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">变化检测</h2><p id="70da" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">本质上，它在某种程度上类似于固定间隔类型。您将再次设置间隔，但这一次，不同的事情在后台发生。与固定时间间隔相比，关键的区别在于，您必须指定一个将要被监控的度量(就像检查底层表中是否有新记录一样)，在定义的固定时间间隔之后，Power BI将生成<strong class="lb iu">一个单独的</strong>查询来检查指定的度量是否发生了变化，如果发生了变化，它将执行剩余的查询来刷新所有的视图…如果没有发生变化，报表页面不会发生任何变化！</p><p id="fd9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们来看看在使用这些类型的每一种时会发生什么。</p><h2 id="2dec" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">在Power BI Desktop中配置自动页面刷新</h2><p id="93f4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">进入Power BI Desktop并使用DirectQuery存储模式后，我可以配置页面刷新属性:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/25d2e60ae5a6e5bec4c3c8cb10dc427d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XoqxqPv4wke7KGA2GiclSg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a7e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用的是Contoso数据库，为了简单起见，我只连接到DimCustomer表。如您所见，我在报告页面上放置了三个视觉效果，并设置了自动页面刷新类型(固定间隔)，刷新间隔为2秒。</p><p id="1dc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个设置，Power BI Desktop应该每两秒钟触发三个独立的查询(每个可视化一个)!让我们打开SQL Server Profiler，并检查后台的运行情况:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/926077541430b7250edf637ba8b8b7ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sox5vGheJUoanFc4btAnWQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7ca1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如预期的那样，对DimCustomer表运行了三个查询，并且每两秒钟重复一次。</p><p id="4d75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们切换到Power BI Desktop中的性能分析器，并检查该设置背后的具体指标:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/fe68ec0e240c28cd800f4b90ad4920cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PbB2Gj7_kQGAuRemRZdCsw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d144" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经按照行动顺序对结果进行了分类，以便能够区分不同的行动。而且，您可能会看到我们的表格可视化每次都需要2秒多的时间来呈现(为了清楚起见，Performance analyzer中的值是以毫秒为单位的)！这给我们带来了一个重要的启示:</p><p id="8a7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="mt">如果您注意到渲染视觉所需的时间比您在自动页面刷新设置中指定的时间长，您应该增加刷新间隔的值！</em> </strong>老实说，如果视觉需要比这更多的时间在报表中渲染，那么每两秒刷新一次数据又有什么意义呢？！</p><p id="ba74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mt">Power BI桌面中的变化检测</em></p><p id="3265" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们设置变更检测类型。它比固定时间间隔稍微复杂一些，因为您需要应用一些额外的配置步骤。</p><p id="3465" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我创建了一个非常基本的方法来计算客户总数:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="364b" class="lv lw it mw b gy na nb l nc nd">Total Customers = COUNT(DimCustomer[CustomerKey])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/c2ac465d7ae35926d3bf8abe83197e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcAXe5F2Lt-hrCMfzTHm2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="34b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本质上，一旦我们以这种方式设置了自动刷新，接下来将会发生的是，每隔2秒，Power BI将触发一个查询来检查总客户度量的值。如果measure的值改变了，视觉效果将会刷新，否则什么也不会发生！让我们确认我们的假设:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/42f1d6c8c8b2d2e89d1dbd3fa4595b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZqV5evfeaHSt8H0In1jJ6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="ff73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所想的那样:每2秒钟，在数据源端执行一次查询来检查总客户度量的值，由于没有检测到任何变化，所以没有刷新报告页面。现在，让我们通过在DimCustomer表中插入一个新行来更改度量值:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="dd4f" class="lv lw it mw b gy na nb l nc nd">USE [Contoso]<br/>GO<br/><br/>INSERT INTO [dbo].[DimCustomer]<br/>           ([FirstName]<br/>           ,[LastName]<br/>           ,[Gender]<br/>           ,[GeographyKey]<br/>       ,[CustomerLabel]<br/>           )<br/>     VALUES<br/>           ('Power'<br/>           ,'BI'<br/>       ,'?'<br/>           ,1<br/>           ,112233<br/>           )<br/>GO</span></pre><p id="1a2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是用于在表中填充新行的T-SQL代码。现在，我将检查一旦底层数据发生更改，更改检测将如何表现:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/8f2ad80a2df4abd001968c1613c21b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*JaQ5PlRQmWqIwyVdnHdSBg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者插图</p></figure><p id="f7c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是啊！仔细看看上面的动画:查询检查了又检查，什么也没发生。然后，我在DimCustomer表中插入一行，变更检测捕捉到了这一修改，然后执行所有三个查询来填充我们的视觉效果。之后，再次执行一个查询来检查度量中是否有新的变化。</p><p id="6a7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本测试的一个要点:<strong class="lb iu"> <em class="mt">如果您预计源数据的变化频率低于您在变化检测中指定的值，您应该增加变化检测的间隔。</em>T3】</strong></p><h2 id="c865" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">电源BI服务中的配置</h2><p id="03b6" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在，我将在Power BI服务中将此报告发布到我的工作区。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/cc1408b51534e75696d1749a0501130e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ednf1JMuvBDR6RiQnEDIcg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2eee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">等等，什么？！这是行不通的！正如你在最上面的消息中看到的，<strong class="lb iu"> <em class="mt">改变检测类型</em> </strong>，与固定间隔不同，它将在所有容量下工作，<strong class="lb iu"> <em class="mt">需要高级许可</em> </strong>。</p><h2 id="6aaf" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">总则</h2><p id="5914" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">根据上面执行的测试得出的结论，下面列出了在使用自动页面刷新功能时应该记住的一般规则:</p><ul class=""><li id="fab0" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">如果您希望基础表中的数据每5分钟更改一次，请不要将自动页面刷新间隔设置为低于5分钟</li><li id="1284" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">当您将刷新间隔设置为较低的值时，例如我们示例中的2秒，请考虑您的查询将会产生的工作负载，尤其是使用固定间隔类型时。举例来说，如果有20个并发用户运行这个报告，并且我们在报告页面上有3个视觉效果，那么每2秒钟就有20×3 = 60个查询！现在，想象一下如果页面上有10个以上的视觉效果会有什么影响…</li><li id="c402" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">只有在DirectQuery存储模式或包含至少一个DirectQuery数据源的混合模式下，才支持自动页面刷新。在实时连接模式下，您也可以使用固定时间间隔，但有一些限制</li><li id="b6a9" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">变更检测类型需要高级容量</li><li id="910a" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">对于每个数据集，只能对一个度量设置更改检测类型</li><li id="cb50" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">在Power BI租户中，最多可以使用10个具有更改检测类型的数据模型</li></ul><p id="325e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果您想知道如果您的自动页面刷新工作负载干扰常规工作负载会发生什么——根据<a class="ae ky" href="https://docs.microsoft.com/en-us/power-bi/create-reports/desktop-automatic-page-refresh#automatic-page-refresh-in-the-power-bi-service" rel="noopener ugc nofollow" target="_blank">微软的官方文档</a>，自动页面刷新查询具有较低的优先级。</p><p id="f043" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个合理的问题是:<em class="mt">如果执行该查询需要5秒，并且我已经将刷新间隔设置为2秒</em>，那么会发生什么情况？在前一个周期完成之前，Power BI不会运行下一个周期。简单地说，Power BI将等待5秒钟来完成查询，然后执行下一次运行。</p><p id="4a5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我很想知道自动页面刷新查询是否可以利用来自缓存的结果。答案是否定的，因为这些查询不是由缓存提供的。</p><h2 id="f28f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">结论</h2><p id="6ec6" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当您需要实时监控一些关键事件并根据Power BI报告提供的快速洞察力做出决策时，自动页面刷新是一项非常强大的功能。但是，在什么时候使用这个特性以及使用到什么程度都要非常小心。</p><p id="9400" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><p id="a273" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成为会员，阅读Medium上的每一个故事！</p></div></div>    
</body>
</html>