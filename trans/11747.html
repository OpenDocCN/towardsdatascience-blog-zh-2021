<html>
<head>
<title>Denormalization and Cooking: Metrics are recipes to make your data useful</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反规范化和烹饪:度量是使数据有用的方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/denormalization-and-cooking-metrics-are-recipes-to-make-your-data-useful-100a6933b47e?source=collection_archive---------26-----------------------#2021-11-22">https://towardsdatascience.com/denormalization-and-cooking-metrics-are-recipes-to-make-your-data-useful-100a6933b47e?source=collection_archive---------26-----------------------#2021-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f9a6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如果数据团队是组织中信息的“顶级厨师”，那么度量就是他们获得有价值的数据洞察力的“配方”。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a578005e350aee0a4ddc57b9e3698131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nUQWEL45s4XwZoVS"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="kv">摄影由</em> <a class="ae kw" href="https://unsplash.com/@sebastiancoman?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="kv">塞巴斯蒂安·科曼摄影</em> </a> <em class="kv">上</em> <a class="ae kw" href="https://unsplash.com/s/photos/chef?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="kv">下</em> </a></p></figure><p id="f6d2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">组织、建模和提供数据的最终目标是让数据对利益相关者有用。反规范化是使数据变得有用的关键，然而这个概念没有得到广泛的讨论，并且缺乏为构建干净和结构化的核心数据集而开发的深思熟虑的方法。</p><p id="b8c8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据建模在过去十年中有了很大的改进——无论是在工具方面还是在方法的思想方面——我们都受益匪浅，但下一代数据工具将彻底改变反规范化的过程，那些了解这些趋势的人将是第一批受益者。</p><p id="c3fc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">为了理解反规格化，我们首先需要定义规格化:</strong></p><ul class=""><li id="2be0" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><strong class="kz ir">规范化</strong>是指组织数据，使其在所有记录和字段中看起来相似。规范化旨在减少冗余并确保数据仓库中的一致性。</li></ul><p id="b04d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">标准化做得好的话，可以实现更广泛、更容易的数据消费。为了使用这些数据，数据使用者必须能够组合各种数据集并应用聚合。这个过程叫做反规范化。</p><ul class=""><li id="e854" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><strong class="kz ir">反规范化</strong>是组合和综合来自各种来源的经过清理和组织的数据集的过程，这有助于使数据对分析有用。</li></ul><p id="ec4a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">规范化类似于组织准备烹饪的配料，而非规范化则是获取这些配料并准备一顿饭的过程。保持一个干净整洁的储藏室和冰箱可以让准备你最喜欢的食物的过程更加顺利和愉快。整理你的厨房是不够的。为了利用各种成分，你需要知道如何将它们组合起来。</p><blockquote class="mc md me"><p id="c603" class="kx ky mf kz b la lb jr lc ld le ju lf mg lh li lj mh ll lm ln mi lp lq lr ls ij bi translated"><strong class="kz ir">数据分析师是厨师，通常能够即兴发挥他们的原料，而业务用户通常寻求一致可靠的结果，并希望遵循食谱。</strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/24b11de10ab4742a99680e2a1ec037dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OOd9n6Jak_jgl0jb.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">规范化类似于组织食材准备烹饪，而非规范化则是获取这些食材并准备一顿饭的过程。照片由 <a class="ae kw" href="https://unsplash.com/@kate5oh3?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="kv">凯蒂·史密斯</em> </a> <em class="kv">上</em> <a class="ae kw" href="https://unsplash.com/s/photos/ingredients-cooking?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="kv">下</em> </a></p></figure><p id="aff8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">反规范化和规范化都很关键，在某种形式上，每个数据团队都这样做。虽然标准化在分析工程界定义明确并经常讨论，但在现代数据堆栈中几乎没有做什么来改进我们用来服务非标准化数据集的方法。结果是<a class="ae kw" href="https://benn.substack.com/p/metrics-layer" rel="noopener ugc nofollow" target="_blank">数据堆栈中的逻辑蔓延</a>。</p><p id="1877" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">分析师大部分时间都在进行反规范化，公司的大部分业务逻辑都是在这个过程中定义的。大多数数据分析师都知道这些概念，尽管他们可能会使用核心数据集或数据集市这样的词来表示规范化数据集，使用汇总表或度量表来表示非规范化数据集。</p><h1 id="d416" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">规范化与反规范化:区别是什么？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/9a27674337ff3b775a2882db4fe3b63c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*64jHChZBnT1wdRkm"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="af54" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据的价值并非来自整洁有序的存储。这是成功的必要条件，但是仅仅规范化并不能使数据变得有用。它通过反规范化变得有用，反规范化是将信息提取到数据集的过程，数据集将压缩的信息表示为可用于获得洞察力的数据点或指标。</p><p id="499e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">同样，食物的价值不在于配料或我们组合这些配料的过程，而在于最终产品，即菜肴。反规格化是组合成分的过程，而连接、聚合和过滤器的排序和表达是实现期望的最终产品所需的配方。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cc00a39d4a23a59b86a44108ec5a7f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ki5v1ffMW4qVCCCN"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="kv">反规范化是组合配料(烹饪)的过程，而连接、聚合和过滤是实现所需最终产品所需的配方……就像这道精美的餐厅菜肴。照片由</em> <a class="ae kw" href="https://unsplash.com/@jaywennington?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="kv">周杰伦</em></a><em class="kv"/><a class="ae kw" href="https://unsplash.com/s/photos/plating-food?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"><em class="kv"/></a></p></figure><p id="520a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在我们能够在实践层面上完全理解反规格化之前，我们需要深入一些关于规格化的细节。规范化数据被定义为在确保数据完整性的同时限制数据冗余的数据模型。举几个例子:</p><ul class=""><li id="ce24" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><strong class="kz ir"> <em class="mf">数据冗余(例):</em> </strong> <em class="mf">当用户的地址同时存储在用户表和事务表中时。在规范化的数据集中，工程师将只在 users 表中存储用户的地址，并将 users 表连接到 transactions 表。</em></li><li id="2724" class="lt lu iq kz b la nc ld nd lg ne lk nf lo ng ls ly lz ma mb bi translated"><strong class="kz ir"> <em class="mf">数据完整性(例):</em> </strong> <em class="mf">当同一个字段以多种形式出现时——例如 US、USA、United States。在标准化的数据集中，工程师已经将所有这些不同的值更改为相同的值。</em></li></ul><p id="036d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于数据和分析工程师来说，深思熟虑的规范化过去是、现在仍然是一项非常重要的工作。每个应用程序背后都有一个数据库，甚至许多数据库，这些数据库必须组织在一个分析数据仓库中，以便为数据消费者提供最佳服务。</p><p id="e4ba" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">规范化有时被称为<a class="ae kw" href="https://en.wikipedia.org/wiki/Canonical_form#Computing" rel="noopener ugc nofollow" target="_blank">规范形式</a>，与主数据管理的历史概念密切相关。这个概念在不同程度上来自于 1970 年作为第一范式(1NF)提出的简单定义，到今天相当常见的第三范式(3NF)，以及更远，一直到不切实际的复杂的第六范式(6NF)。正常化是很好的管家。出于这个原因，在过去五十年中提出的一系列数据建模技术对数据团队近年来取得的进步起到了重要作用。</p><h1 id="7a42" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">反规格化和冗余</h1><p id="6129" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">数据堆栈中的几乎每个工具都会发生反规范化。在我们的 EL 任务中，在数据仓库中计划的批量转换作业中，通过编排工具，以及作为下游商业智能(BI)和分析工具中的查询。几乎每个使用数据的接口都要经历反规范化的过程。</p><p id="cbe1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在实践中，应用连接、聚合和过滤器的行为相对简单，但它们会对逻辑治理和可重用性产生显著的二级影响，或者说，实际上，会降低数据集的可重用性。挑战变成了再现性、一致性和数据发现。</p><p id="88ec" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mf">这里是</em> <em class="mf">我们在考虑组织应该如何应用反规范化的策略时应该考虑的几个重要因素:</em></p><ul class=""><li id="86a0" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><strong class="kz ir">非规范化数据比规范化数据更容易查询:</strong>规范化数据查询起来既费钱又费时。由于数据从不重复，我们必须首先连接数据集来做任何有趣的事情。出于这个原因，我们在数据仓库和各种下游工具中创建、消费和管理大量非规范化数据集。</li><li id="69e9" class="lt lu iq kz b la nc ld nd lg ne lk nf lo ng ls ly lz ma mb bi translated"><strong class="kz ir">反规格化无处不在:</strong>反规格化无处不在。向最终用户发布最常见的度量和维度对的简明摘要表是很常见的。这些非规范化数据集反映了最常见的问题，但是，为了更深入地挖掘，我们在分析或 BI 工具中聚合、过滤和连接数据集。许多问题最终需要返回到规范化的表，将新的原始数据集与这些汇总表合并，或者任何其他组合。任何使用数据的工具都会发生这种情况。</li><li id="d34a" class="lt lu iq kz b la nc ld nd lg ne lk nf lo ng ls ly lz ma mb bi translated"><strong class="kz ir">非规范化数据集在大规模管理时可能会面临挑战:</strong>由于各种原因，管理从规范化数据集派生的数据是一件痛苦的事情。具有讽刺意味的是，其中一个最突出的原因是冗余——与规范化的预期好处相反。如果你曾经想知道为什么像 Airbnb 这样的组织在他们的数据仓库中有超过 10 万个表，那是因为有许多数据应用程序，每个应用程序都需要不同的连接、切片和骰子或公司核心规范化数据集的表示。在实践中，他们必须追求这些不同的派生数据集，以从数据中获得价值，并且他们必须付出管理冗余的代价。</li><li id="39ee" class="lt lu iq kz b la nc ld nd lg ne lk nf lo ng ls ly lz ma mb bi translated"><strong class="kz ir">对非规范化数据的治理并非无足轻重:</strong>对于分析来说，可能有许多令人感兴趣的数据组合，但我们只能预计算这么多可能的组合。尽管需要纪律和资源来确保准确性，但其中一些查询值得持续维护和更新。不幸的是，随着时间的推移，这些衍生数据集被遗忘并成为一种负担，其中的指标定义逐渐偏离了当前的时代精神。如果没有适当的上下文，并且没有意识到这些数据集的质量问题，分析人员以后会使用这些数据集，而结果将是可疑的。这导致了对数据的普遍不信任。</li><li id="66dd" class="lt lu iq kz b la nc ld nd lg ne lk nf lo ng ls ly lz ma mb bi translated"><strong class="kz ir">非规范化数据很难或不可能重新调整用途:</strong>聚合是信息压缩，过滤器只是数据移除。因此，从非规范化的数据集回到它们更有用的规范化形式或许多其他相关的数据集几乎是不可行的。就其本身而言，这不成问题。如果非规范化数据集正在创造价值，那很好。挑战来自于非规范化数据集的数量，这些数据集需要支持一系列旨在获取数据并将其转化为见解的问题和答案。</li></ul><h1 id="46f7" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">度量和反规范化:它们是如何联系的？</h1><p id="ab3c" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">指标的核心是将这些规范化的数据集组合成一组有意义且易于理解的值或时间序列的公式。在我们的食品类比中，指标是获取各种成分并创造有价值的东西的配方。虽然你可以用部分重叠的配料做意大利调味饭或西班牙肉菜饭，但如果他们点了一个却收到了另一个，没有人会高兴。我们混合配料的方式很重要。</p><blockquote class="mc md me"><p id="c3c2" class="kx ky mf kz b la lb jr lc ld le ju lf mg lh li lj mh ll lm ln mi lp lq lr ls ij bi translated"><strong class="kz ir">与反规格化相关的定义的度量:</strong>度量是反规格化数据的方法，被合成为通用的、可理解的数据语言。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b77c7f22e80af077346179ee03dcdd97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3DoTy56Xw6Ju7bK9"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="kv">指标的核心是将这些标准化的数据集组合成一组有意义且易于理解的值或时间序列的公式。度量是获取各种成分并创造有价值的东西的方法。照片由</em> <a class="ae kw" href="https://unsplash.com/@danielcgold?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="kv">丹金</em> </a> <em class="kv">上</em> <a class="ae kw" href="https://unsplash.com/s/photos/cookbook?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="kv">下</em> </a> <em class="kv">下。</em></p></figure><p id="0c05" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据团队的任务是提供一个清晰的界面来解决最常见的问题，因此他们创建汇总表、数据集市和视图。大多数公司都有大量难以管理的潜在指标和维度组合，这使得它们无法提前具体化每个有用的数据集。相反，构建指标的逻辑渗透到公司工具堆栈中构建或使用数据的每一个工具中。从性能和易用性的角度来看，预计算总是更可取的，但对于不习惯添加新数据模型的最终用户来说，它也是一种限制——而且它缺乏提出任何问题的灵活性。</p><p id="b1df" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">随着数据接口的改进，消费者能够提出更多的问题。他们最终会从核心数据集构建衍生数据集，以找到问题的答案。除了复制数据来构建这些非规范化的数据集和指标，我们还经常复制应该在多个系统中保持一致的逻辑。结果是各种工具之间重复逻辑的扩散，更糟糕的是，许多人在彼此的逻辑基础上构建，使得最终结果对最终消费者来说几乎是一个黑盒。</p><p id="8281" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据过去两年与数百名数据分析师的交谈，我认为这是数据堆栈中为数不多的几个点之一，在这些点上几乎没有既定的最佳实践，更不用说实现它们的工具了。这个问题限制了数据消费的广度和消费者愿意为其决策提供信息的深度。手动管理这些数据集的解决方案给数据和分析工程师带来了维护负担，使他们无法完成更有意义的工作。</p><p id="1401" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">虽然这篇文章旨在为讨论反规范化及其与指标的关系提供一个知识基础，但论点是在<a class="ae kw" href="https://fivetran.com/blog/what-is-the-modern-data-stack" rel="noopener ugc nofollow" target="_blank">现代数据栈</a>中缺乏支持反规范化的更好的工具和过程。当我们谈论现代数据堆栈的缺失层时，我们实际上是在指出管理非规范化数据集所面临的挑战。</p></div></div>    
</body>
</html>