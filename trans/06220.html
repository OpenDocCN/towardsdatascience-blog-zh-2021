<html>
<head>
<title>Magic 8 Ball: An App to Maximize Wins in Competitive Pool Matches (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">魔术8球:一个应用程序，以最大限度地赢得竞争池比赛(第三部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/magic-8-ball-an-app-to-maximize-wins-in-competitive-pool-matches-part-3-d724fdd65d9?source=collection_archive---------34-----------------------#2021-06-03">https://towardsdatascience.com/magic-8-ball-an-app-to-maximize-wins-in-competitive-pool-matches-part-3-d724fdd65d9?source=collection_archive---------34-----------------------#2021-06-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5ce5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">机器学习和SQL如何帮助你在连续团队游戏中智胜对手</h2></div><p id="f826" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">欢迎回到这个由三部分组成的数据驱动池策略系列的最后一部分！</p><p id="052e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae lb" rel="noopener" target="_blank" href="/magic-8-ball-an-app-to-maximize-wins-in-competitive-pool-matches-part-1-e1d302b5507c">第1部分</a>中，我们探索了竞技团队台球的古怪之处，并确定台球游戏的玩家阵容选择可以通过数据科学来改进。我们开发了一个分类模型，根据过去的结果预测一个玩家击败另一个玩家的概率。</p><p id="8499" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae lb" rel="noopener" target="_blank" href="/magic-8-ball-an-app-to-maximize-wins-in-competitive-pool-matches-part-2-eb9d4793f98f">第2部分</a>中，我们更进一步，用SQL实现了一个马希民玩家选择算法，它使用模型预测来计算最佳玩家选择。</p><p id="3169" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这最后一部分，我们将比较我们的机器学习驱动的玩家选择和现实世界的玩家选择策略，并确定我们是否真的能够持续获得超过对手的竞争优势。</p><p id="95a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/magic-8-ball-an-app-to-maximize-wins-in-competitive-pool-matches-part-1-e1d302b5507c"> <strong class="kh ir">第一部分:引言和预测建模。</strong> </a></p><p id="f4ef" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第2部分:使用SQL制定策略。T11】</p><p id="4073" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">第3部分:“封装”测试！</strong></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="3b44" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated"><strong class="ak">与真实策略的比较</strong></h2><p id="f4bb" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">你可能想知道队长是否真的花了很多心思在他们的球员阵容上，或者他们是否愿意让球员自己选择比赛顺序。答案是，<em class="mh">有的不</em>，认为对抗联盟的均衡盘口是徒劳的。然而，我们在第1部分中看到，尽管有障碍，我们仍然可以<strong class="kh ir"><em class="mh"/></strong>使用与玩家配对相关的<strong class="kh ir">技能余量</strong>、<strong class="kh ir">比赛余量</strong>和<strong class="kh ir">获胜百分比余量</strong>来准确预测一个玩家赢得这一轮的概率。</p><p id="40cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个常用的现实生活策略是<strong class="kh ir">尝试让你的玩家与对手中技术相似的玩家的技术水平相匹配。这种方法背后的逻辑是，每个玩家都有信心能够击败他们同样熟练的对手。</strong></p><p id="edbf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，让我们将这种现实生活中的技能匹配策略与第2部分中开发的马希民选择算法(即我们的应用推荐)进行比较。我们可以在1000次模拟中比较这两种策略的表现，看看哪一种更有说服力。</p><p id="652c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于每个模拟，使用<strong class="kh ir">numpy . rand()</strong>函数生成具有随机分布参数的两个五人小组。</p><p id="866d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">A队的球员选择有三种方式:</p><ul class=""><li id="2239" class="mi mj iq kh b ki kj kl km ko mk ks ml kw mm la mn mo mp mq bi translated"><strong class="kh ir">策略一:</strong>选择与所选B队玩家技能匹配度最接近的玩家。</li><li id="62a1" class="mi mj iq kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated"><strong class="kh ir">策略二:</strong>使用马希民app推荐。</li><li id="621b" class="mi mj iq kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">做出随机选择。</li></ul><p id="8e04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">B队的球员选择总是随机的。</p><p id="4586" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这导致<strong class="kh ir">每场模拟比赛有三种不同的最终阵容</strong>。这些阵容中的每一个都记录了相关的比赛获胜概率，以及根据<a class="ae lb" href="https://www.napaleagues.com/naparules/?ball=8-ball" rel="noopener ugc nofollow" target="_blank"> NAPA规则</a>计算的预计得分。</p><p id="208a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以使用<strong class="kh ir">概率差来量化每个策略的有效性，定义为</strong>:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi mw"><img src="../Images/c2d103e330ced0021ee3432fddca72a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RIJPiTmSYW2EGv2wi0FGQ.png"/></div></div></figure><p id="1cc2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mh">即</em>使用策略1或2时最终阵容的比赛获胜概率减去随机选择时最终阵容的比赛获胜概率。在图1(a)中，绘制了1000个模拟匹配的概率差。红色阴影对应策略1(相似技能策略)时的<em class="mh"> P_diff </em>，蓝色阴影对应策略app策略)时的<em class="mh"> P_diff </em>。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ni"><img src="../Images/fbbf94d8eba4e73d7a17a0eb3bb941c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sje-2E8SvtDl3WGC"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图1(a):使用app推荐时(蓝色)和使用相似技能策略时(红色)的Pdiff。(二)。平均水平和使用替代策略之间的预测得分差异。图片作者。</p></figure><p id="b316" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以看出，红色分布集中在平均值为0 的<strong class="kh ir"> P_diff上，这意味着<strong class="kh ir">是许多比赛的平均值，类似的技能策略不会导致比随机选择更好的结果。</strong>这很有意义，因为在本系列的第一部分中，我们已经展示了技能水平只是决定玩家获胜概率的一个因素。</strong></p><p id="d08d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">另一方面，使用app推荐时P_diff的均值为0.054，在98.4%的模拟匹配中P_diff大于0！</strong></p><p id="fdf0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图1(b)中的预测得分差异遵循正态分布，因此我们可以计算应用程序推荐方法和类似技能方法的预测得分差异均值之间的t检验<em class="mh"> </em>的单侧p值。计算值远低于所选的𝛼=0.05显著性水平<strong class="kh ir">，因此我们可以得出结论，app推荐比使用相似技能策略产生更好的预测分数。</strong></p><h2 id="8d9d" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated">我们能做得更好吗？</h2><p id="84a4" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">我们已经证明，使用应用程序推荐的匹配获胜概率平均比随机选择或使用类似技能策略高0.054%。这是我们能做的最好的吗？我们总是能得到最好的阵容吗？或者我们能增加更多的机会吗？</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ni"><img src="../Images/42f555e0a9557ab0b57f7f3b73987043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*giG5O3X57sqhfZOs"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图2:随机选择(红色)和使用应用程序推荐(蓝色)时，所有排列的最终阵容。图片作者。</p></figure><p id="f1e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据<strong class="kh ir">排列等级</strong>来考虑是有见地的，其中最高等级排列(等级1)是A队具有最高匹配获胜概率的阵容，最低等级排列(等级120)是A队具有最低匹配获胜概率的阵容</p><p id="6ebd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图2显示了从1000次模拟中获得的每个阵容的排列等级直方图，应用程序推荐的阵容为蓝色，随机选择的阵容为红色。很明显，当使用应用程序推荐时，我们很可能会得到最好的阵容，而得到更差阵容的机会会成倍下降。只有在极其罕见的情况下，B队才会幸运地随机选择，我们最终的阵容比60人的平均阵容还要糟糕。另一方面，红色分布的均匀性表明，当我们也进行随机选择时，我们同样有可能得到任何排名。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="505e" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated"><strong class="ak">如果对手是战术天才呢？</strong></h2><p id="3ea1" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">因此，我们已经确认了我们的应用程序策略优于一个天真的随机对手，但它将如何应对一个更具战术敏锐性的队长呢？让我们考虑一下最坏的情况——<strong class="kh ir">让对手也能访问应用推荐</strong>。为了测试这个场景，我们模拟了1000场新的比赛，玩家的选择由两队<strong class="kh ir">的马希民策略决定。像以前一样，使用两个队的随机球员选择重复相同的比赛，以便可以为每场比赛计算P_diff。模拟运行了两次，一次是A队进行第一次挑选，一次是B队进行第一次挑选。P_diff分布如图4所示，其中团队A选择第一名和第二名的结果分别用浅蓝色和深蓝色绘制。</strong></p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ni"><img src="../Images/b44ed74990d2feaa2e1e187bd671e555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IhCBra2UVLpaZfST"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图3:当双方队长都可以访问应用程序推荐时，1000场模拟比赛的概率差异。浅蓝色表示A队先挑，深蓝色表示A队后挑。图片作者。</p></figure><p id="dfb8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从分布来看很明显，在第一轮中无论哪个队长先选择都有一点优势！[请注意，当其中一名队长随机选择时，这种优势<strong class="kh ir">不会</strong>出现，在这种情况下，两种分布都类似于图1(a)中的红色分布]。</p><p id="413d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当A队队长先选时，71.8%的模拟比赛中P_diff大于0，平均值<strong class="kh ir"> P_diff </strong>为<strong class="kh ir"> 0.012 </strong>。</p><p id="414c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当他们选择第二名时，只有28.6%的模拟比赛中P_diff大于0，平均值<strong class="kh ir"> P_diff </strong>为<strong class="kh ir"> -0.012 </strong>。</p><p id="9f70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一结果具有统计学意义，采用p &lt;0.0001 for a <a class="ae lb" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.wilcoxon.html" rel="noopener ugc nofollow" target="_blank"> Wilcoxon符号秩检验</a>。</p><p id="5f6c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以得出令人惊讶的结果:在所有策略都相同的情况下，<strong class="kh ir">在许多比赛中，我们可以简单地通过选择在掷硬币获胜后首先选择一个玩家来预期比赛获胜概率的小幅正增长。</strong></p><p id="d433" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">值得注意的是，从个人经验来看，这与泳池队长的普遍看法相反，他们往往不愿意主动出击！</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="9fc7" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated"><strong class="ak">前端和应用部署</strong></h2><p id="d319" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">应用程序开发的最后一步是设计一个供队长使用的前端界面。有许多<a class="ae lb" href="https://dev.to/paultopia/the-easiest-possible-way-to-throw-a-webapp-online-flask--heroku--postgres-185o" rel="noopener ugc nofollow" target="_blank"/><a class="ae lb" href="https://realpython.com/flask-by-example-part-2-postgres-sqlalchemy-and-alembic/" rel="noopener ugc nofollow" target="_blank">奇妙的</a> <a class="ae lb" href="https://blog.theodo.com/2017/03/developping-a-flask-web-app-with-a-postresql-database-making-all-the-possible-errors/" rel="noopener ugc nofollow" target="_blank">指南</a>用于设置使用Flask与postgreSQL数据库通信的web应用程序，所以我在这里不会深入研究细节。在Heroku上部署网络应用的一步一步的指南可以在这里找到。</p><p id="86b8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相反，你可以在http://magic8billiards.herokuapp.com/随意摆弄最终产品。使用说明可在网站的“如何使用”标签下找到。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a31a6721fe6a5d5a8797a03c5b528a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/1*mk_tAXrgULSCw-SgtrA1RA.gif"/></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图4:应用视觉助手。每个点代表单个排列组合的获胜概率，暗红色的点表示仍然可能的排列组合。随着更多回合的完成，大多数阵容变得不可能，并且变灰。最后的暗红点就是最后的阵容。图片作者。</p></figure><p id="38d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该应用的一个关键元素是<strong class="kh ir">视觉助手:</strong>一个动态的<a class="ae lb" href="https://seaborn.pydata.org/generated/seaborn.swarmplot.html" rel="noopener ugc nofollow" target="_blank">群集图</a>，它将所有120个可能的阵容的比赛获胜概率绘制成红点。随着回合的完成，一些阵容变得不可能，这些点变灰。正如我们上面所展示的，该应用程序指导队长们选择获胜概率最高的阵容。到了第五轮，只剩下一个红点，代表最终选定的阵容。除非船长特别不走运，否则这个点应该在虫群的右边，这表示胜利的机会增加了！</p><h2 id="8bbf" class="lj lk iq bd ll lm ln dn lo lp lq dp lr ko ls lt lu ks lv lw lx kw ly lz ma mb bi translated"><strong class="ak">收尾</strong></h2><p id="6c17" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">祝贺这篇深入探究团队池策略特质的三部分文章结束！</p><p id="96b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第1部分开发了一个概率模型之后，在第2部分，我们设计了SQL查询来识别每轮比赛中的最佳玩家选择。最后，在第3部分中，我们评估了这些查询在许多模拟匹配中的性能。</p><p id="36fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">关键要点是:</strong></p><ul class=""><li id="1726" class="mi mj iq kh b ki kj kl km ko mk ks ml kw mm la mn mo mp mq bi translated">逻辑回归可以可靠地预测一个玩家在NAPA pool联赛中战胜另一个玩家的概率，使用技能水平、以前的胜率和比赛长度作为输入特征。</li><li id="4e7d" class="mi mj iq kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">maxmin玩家选择策略导致比赛获胜概率比随机选择平均提高5.4%。</li><li id="0e57" class="mi mj iq kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">在掷硬币中获胜的队长应该选择在第一轮中首先选择——即使在最坏的情况下，这也会将比赛获胜的概率提高1.2%。</li></ul><p id="98e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里讨论的选择算法的应用已经超出了业余爱好者的范围。出现类似问题的一些行业场景包括:</p><ul class=""><li id="e748" class="mi mj iq kh b ki kj kl km ko mk ks ml kw mm la mn mo mp mq bi translated">两家公司竞相从一系列可供选择的项目中赢得最多的合同。</li><li id="2497" class="mi mj iq kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">两家航空公司竞标赢得一个机场的着陆位置。</li></ul><p id="eb91" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望这个系列已经启发你拿起一个台球杆，并检查你当地的联赛。在泳池队打球是结识新朋友的好方法，而差点系统让所有能力的球员都有愉快的经历。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ni"><img src="../Images/c2dec2b329a5fbe88a514d73efd4e5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*msKep7hLo92iw06n"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图片来自instagram.com/stevenfritters，授权给卡勒姆·安东内尔。</p></figure></div></div>    
</body>
</html>