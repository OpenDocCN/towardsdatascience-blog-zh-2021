<html>
<head>
<title>Distributed Biomedical Text Mining using PySpark for Classification of Cancer Gene Mutations At-scale — Part I: EDA &amp; Pointwise Mutual Information Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PySpark的分布式生物医学文本挖掘用于癌症基因突变的分类——第一部分:EDA和逐点互信息分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/distributed-biomedical-text-mining-using-pyspark-for-classification-of-cancer-gene-mutations-3e11507b2450?source=collection_archive---------26-----------------------#2021-05-08">https://towardsdatascience.com/distributed-biomedical-text-mining-using-pyspark-for-classification-of-cancer-gene-mutations-3e11507b2450?source=collection_archive---------26-----------------------#2021-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="90bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">分布式机器学习使用Apache Spark对癌症肿瘤基因突变进行大规模分类</em></p><p id="5820" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇由两部分组成的文章中，我将分享我在分布式计算研究生课程中参与的一个学期研究项目的心得。我使用PySpark实现了一个机器学习算法，用于对癌症肿瘤基因突变进行分类，PySpark是Apache Spark的Python实现。在这一部分中，我将描述探索性数据分析(EDA)以及逐点互信息(PMI)的自然语言处理(NLP)概念的分布式实现。</p><p id="fd59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在这篇文章中只分享代码的某些部分，因为包含整个代码会使文章太长。完整代码请查看GitHub链接<a class="ae km" href="https://github.com/bsets/Distributed_ML_with_PySpark_for_Cancer_Tumor_Classification/tree/main/BRCA1_PMI_Computation" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">这里</strong> </a>。我还准备了一个5分钟的视频，你可以在这里 找到<a class="ae km" href="https://www.youtube.com/watch?v=LRp75Ku8Hc4" rel="noopener ugc nofollow" target="_blank">。如果你想跳过这一步直接进入分布式ML部分，这里有第二部分</a><a class="ae km" href="https://bharatss.medium.com/distributed-biomedical-text-mining-using-pyspark-for-classification-of-cancer-gene-mutations-bd3b2ca05a9c" rel="noopener"> <strong class="jp ir">的链接。</strong></a></p><p id="7858" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">简介</strong></p><p id="9b88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">癌症如此难以理解并因此难以治疗的主要原因之一是肿瘤基因突变的巨大复杂性。肿瘤细胞中可能有几千个基因，这些基因中的每一个都可能有几千个已知的突变，以及大量尚未发现的突变。并非所有的突变都是癌性的，其中一些可能是良性的。毕竟，基因不断变异是自然进化的一部分，并不是每个突变都对生物体有害。为了开发有效的抗癌药物，药物研究人员需要了解肿瘤中大多数突变的性质。</p><blockquote class="kn ko kp"><p id="693e" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">然而，对肿瘤基因突变进行分类的过程是手工的、费力的和耗时的。对于在实验室的肿瘤标本中发现的每一个突变，研究人员都必须阅读几页医学文献，才能将发现的突变归类到适当的类别。这种以人为媒介从医学文献中检索信息的过程大大减缓了知识增长的速度。如果一名研究人员花1个小时对一个突变进行测序，5个小时对其进行分类，研究界会产生巨大的机会成本，因为花在分类上的时间本可以更好地用于发现新的突变或研究恶性突变的治疗方法。</p></blockquote><p id="5c55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">生物医学文本挖掘是一套计算技术，用于从大型生物医学研究文献数据集中提取见解和可操作信息。</p><p id="d5f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自从互联网出现以来，尤其是在下一代测序(NGS)等新技术在实验室得到广泛采用之后，生物医学文献一直在快速增长。下图显示了一组选定国家癌症研究出版物数量的年增长率。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/7e40a029280cc2df96b9f1e63ee80fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*iOsapOCv6n5pDRBrRhk5EQ.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">全国癌症研究出版物数量的增长(资料来源:<a class="ae km" href="https://www.elsevier.com/?a=230374" rel="noopener ugc nofollow" target="_blank"> Elsevier </a>(第11页))</p></figure><p id="0f18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，越来越需要计算技术来处理这些数据，并从中获得见解，以帮助医学研究人员加快他们的研究。</p><p id="0490" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我将描述我在这项研究中使用的数据集。</p><p id="0d7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">数据集</strong></p><p id="4e86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用了由纪念斯隆-凯特琳癌症中心(MSKCC)汇编和发布的<a class="ae km" href="https://www.kaggle.com/c/msk-redefining-cancer-treatment" rel="noopener ugc nofollow" target="_blank">个性化医疗</a>数据集，用于他们在2017年举办的一场Kaggle比赛。该数据集包含来自各种医学杂志的关于肿瘤基因突变分类研究的研究论文。训练数据集有3321篇这样的论文。每篇论文都是关于一个特定的基因和与之相关的突变。癌症专家研究人员将这些突变归为九类中的一类(1-9)。由于我没有测试数据集的标签，所以我将初始训练数据集拆分为80:20的训练和测试拆分，并使用初始训练数据集大小的80%的新数据集进行训练。</p><p id="5ab8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然Kaggle竞赛中没有说明这些突变类别代表什么，但我从一篇编辑过的文章中发现，它们很可能意味着以下内容:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/5670aaccde15a7a1d7026877fc27ce44.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*4HueIvjg5UFYNK-vVNRBBw.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">突变类的含义(图片由作者提供)</p></figure><p id="fda2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图显示了数据集的结构:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/b384fb6db07fd651905294aa563c0fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*ohFOh3E8Te39A3JZxm4vHQ.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">训练数据集的格式(图片由作者提供)</p></figure><p id="159f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，ID为1的论文是关于CBL基因及其变异(突变)W802*。这种变异属于2类。论文的起始文本显示在标题为“文本”的列中。本文开头的几行如下图所示:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lh"><img src="../Images/b9a2dca29e8836c3d21819e440d1839d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9lZn3G3Vei0qSM3W2KiFrg.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">研究论文的开头句子(图片由作者提供)</p></figure><p id="2186" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们所观察到的，这是一篇密集的科学论文，包含几个生物学术语，总共有5757个单词。测试数据集与训练数据集具有相同的结构。</p><p id="3bd1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">挑战</strong></p><p id="d922" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们假设一名研究人员的阅读速度为每分钟300个单词，她必须阅读5篇这样的论文才能对突变进行分类。这意味着，即使不考虑研究论文不能像小说一样阅读的事实，她完成这项任务也需要2个小时。如果一个肿瘤基因包含10种不同的突变，这对于可能存在的突变数量来说是一个适中的数字，会怎么样呢？</p><blockquote class="kn ko kp"><p id="175a" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">如果<!-- -->我们可以提出一种算法，可以“阅读”大量的生物医学文献，并学习论文中的关键词和论文描述的突变分类之间的关联，我们可以大大减少研究人员手动注释新突变的时间。例如，如果一个算法可以在80%的时间里在1秒钟内注释一个突变(如果我们有足够的计算资源，这是一个相当长的时间，可以大大减少)，这样的方法对癌症研究人员来说非常有用。</p></blockquote><p id="8665" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">想法</strong></p><p id="85dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这项研究中，我有两个想法:</p><ol class=""><li id="9ddc" class="lm ln iq jp b jq jr ju jv jy lo kc lp kg lq kk lr ls lt lu bi translated">作为探索性步骤，我检查了文献中基因的两个突变的频繁共现是否表明它们属于同一类别的可能性较高，反之亦然，即两个突变的共现低于平均水平是否表明它们属于不同类别的可能性较高。为此，我使用了PMI，这是一个在NLP领域中非常成熟的概念。</li><li id="1a1a" class="lm ln iq jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">我使用Spark MLLib训练了一个分布式多项式逻辑回归模型，并使用它对测试数据集中的突变进行分类。</li></ol><p id="7952" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将在这一部分描述第一个想法。在此之前，下面是使用分布式计算的基本原理:</p><p id="e869" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">使用分布式计算背后的基本原理</strong></p><p id="6ba8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两类算法挑战——一类是可以分成更小的部分，这样每个部分都可以单独处理，另一类是需要作为一个整体来处理，因此不能分成更小的部分。例如，要将一个大列表中的所有数字相加，我们可以将列表分成几个子列表，分别将这些子列表中的数字相加，然后将这些子列表相加得到最终结果。另一方面，要计算一个数字列表的平均值，我们需要将所有的数字相加，然后将总和除以列表中数字的总数。我们无法通过将列表分成子列表、计算子平均值、然后计算子平均值的平均值来计算正确的平均值。</p><p id="cdfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于可以分解成几个部分的问题，如果我们将每个部分分配给不同的机器，我们可以加速算法的执行，这就是分布式计算的用武之地。如果我们有10台机器，我们可以为每台机器提供1/10的较大问题，并在1/10的时间内获得结果，而不是在单台机器上处理整个问题，这对于许多涉及大型数据集的问题来说甚至是不可能的。</p><p id="a04b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，计算一对基因突变的PMI分数需要计算同一篇论文中两个突变的同时出现次数，这一任务非常适合拆分成多个部分并在多台机器上执行。</p><p id="1560" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我现在将讨论一些EDA步骤及其结果，以了解数据集的本质:</p><p id="ff5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">探索性数据分析</strong></p><ol class=""><li id="d164" class="lm ln iq jp b jq jr ju jv jy lo kc lp kg lq kk lr ls lt lu bi translated"><strong class="jp ir">查找没有关联发布的条目:</strong>导入库并创建sparkcontext后，我检查数据集中是否有丢失的值。<strong class="jp ir"> </strong>在训练数据集中的3321个条目中，有5个条目没有相关的研究论文，如下图所示:</li></ol><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/acb93054431dd79f2728f7d67f63d4cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*-xGnOE761YcbZTYHraKV0g.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">按列检查缺少的值(图片由作者提供)</p></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/1462a45dcf270450d4c847311117c5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*I5dhgYdFez_SMTWSyRwqvg.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">没有相关研究论文的训练数据行(作者图片)</p></figure><p id="081f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用包含基因名称和相关突变的连接文本填充这些NaN值。例如，对于ID 1277，我用“ARID5B截断突变”替换了TEXT列中的NaN值，如下图所示:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/86b0880b16259ed030a47dc2510e4ac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*5nzoFFslFweycmrKZxAgAQ.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">用基因突变串联替换文本列中的NaN值(图片由作者提供)</p></figure><p id="adc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<strong class="jp ir">确定训练数据集中输出类的分布:</strong>为了检查是否存在显著的类不平衡，我绘制了属于训练数据集中每个类的实例数量，结果如下图所示:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi md"><img src="../Images/14d0d849250938c5a5f964192e2b751c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hddNHaeEg3WF7Orxsp4I7A.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">训练和测试数据集中突变类的分布(图片由作者提供)</p></figure><p id="6ffd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，第7类和第4类在训练和测试数据集中的比例过高。</p><p id="01df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。确定基因及其突变在出版物中出现的分布:</strong></p><p id="d8e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我绘制了所有236个基因中与特定基因相关的发表数量的计数，以检查分布是否相对均匀，或者少数基因是否出现了大量的次数。基因指数相对于其在研究文献中出现频率的图如下所示:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi me"><img src="../Images/6d3c01f8ae548839a31772855111f5f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*hnJ4gkrUzgC4lFALbDccQg.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">基因直方图(图片由作者提供)</p></figure><p id="14c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从图中可以清楚地看出，少量基因(~10个基因)是大部分研究文献的主题，这间接表明了这样一个事实，即这些是突变最多的基因，因为每篇论文对应于一个基因的一个突变。</p><p id="9f3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了检查是否有相同的突变发生在一个以上的基因中，我绘制了突变指数与突变计数的直方图。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/903859d80e66f5a717c47a82b0df9439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*Fbcbwsxw76Wrkkymk-4PDQ.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">突变直方图(图片由作者提供)</p></figure><p id="563f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基因之间存在一般的突变，如缺失、融合、截短，但它们的确切性质取决于所讨论的特定基因。正如所料，我们从右边的图中看到，绝大多数突变是独特的(计数为1)，这意味着它们只发生在一个基因中。</p><p id="eb48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在继续讨论代码实现之前，我将简要讨论PMI的概念。</p><p id="c960" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">点态互信息</strong></p><p id="2b4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逐点互信息(PMI)是信息论和统计学中使用的一种关联度量。事件x和y的PMI由下式给出:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/f0fecd25d54190f15644c01a5ecc232a.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*xx-4aqIA0gW9e6r7XUp4kA.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">PMI公式(图片作者提供)</p></figure><p id="8287" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中，p(x)和p(y)分别是事件x和y的边际概率，p(x，y)是事件x和y的联合概率。正PMI表示事件x和y比它们独立时更有可能同时发生。同样，负的PMI表明x和y不太可能同时出现。</p><p id="bc9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们考虑一个例子。假设我们有一个包含10篇论文的文档，其中有两个单词Alpha和Beta。α出现在6篇论文中，β出现在4篇论文中，它们都出现在3篇论文中。这种情况下的PMI计算如下所示:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/c54f1c96984fb6e1631c0760caf48c31.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*JkFJNmILYu63sfp_QSujpg.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">PMI计算示例(图片由作者提供)</p></figure><p id="8b1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果α和β是基因的两个突变，那么如果它们的PMI得分为正，这意味着它们在研究文献中频繁地同时出现，而不是为零或为负。</p><p id="8087" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">brca 1和CBL基因突变的PMI分布式计算</strong></p><p id="cfc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我考虑了两个基因BRCA1和CBL，并计算了这两个基因所有突变的PMI分数。总共有236个独特的基因。CBL的选择是随机的，以避免任何选择偏差，而我选择了BRCA1基因，因为它有最高数量的突变。</p><p id="6654" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是计算基因突变PMI值的步骤顺序:</p><p id="0fbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.我创建了一个包含所有BRCA1基因突变的列表，然后删除了一般的突变，如截短、缺失、扩增等。然后，我生成了该基因所有剩余独特突变的突变对列表，如果组成突变属于同一类，则将一对标记为1，如果属于不同类，则将一对标记为0。我嵌入了下面的代码片段，它也显示了输出。突变R1753T和C44Y属于相同的第4类，因此我将这对标记为1。另一方面，突变R1753T和R1835P分别属于第4类和第1类，因此我将这对标记为0。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mi mj l"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">根据属于相同或不同类别，将突变对标记为1或0(图片由作者提供)</p></figure><p id="dcb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.我将所有与BRACA1基因相关的文档合并成一个文档，并计算每个突变在这个合并文档中出现的概率。从现在起，分布式计算开始出现。观察PySpark如何将计算突变的任务进行划分，方法是将这个大文档分成几组论文，将这些论文发送到不同的机器，然后通过reduce操作将结果组合起来，得出组合文本中这些突变出现的概率。S1655F突变在合并文献中出现频率最高，出现概率为0.78(这意味着它出现在与BRCA1基因相关的264篇论文中的209篇中)。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mi mj l"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">计算文献中不同BRCA1突变发生的概率(图片由作者提供)</p></figure><p id="e7cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.接下来，我实现了上面讨论的PMI公式的分布式版本，以计算所有BRCA1突变对的PMI值。例如，突变G1743R和L1657P各自单独出现85次，一起出现62次，它们的PMI值为0.358。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mi mj l"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">PMI计算代码片段(图片由作者提供)</p></figure><p id="cef7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结果</strong></p><p id="6a08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了简洁起见，我将讨论BRCA1基因的结果，但我观察到的CBL基因的趋势是相同的。我绘制了所有突变对的PMI与分类相似性，该图如下图所示:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/64f7d27563257365e70c638782f1e008.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*Rjt27Y2qG_pX_gHjwMFogg.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">BRCA1基因突变的PMI与突变相似性(图片由作者提供)</p></figure><p id="7755" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这个图中我们可以得出两个结论:</p><ol class=""><li id="f122" class="lm ln iq jp b jq jr ju jv jy lo kc lp kg lq kk lr ls lt lu bi translated">很明显，与人们的预期相反，PMI得分的值和突变的相似性之间没有明确的关系。存在属于相同突变类别的具有低PMI分数的突变对，并且存在属于不同突变类别的具有高PMI分数的突变。因此，似乎两个突变之间的高PMI分数并不能很好地预测它们的类别相似性。</li><li id="1f06" class="lm ln iq jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">有趣的是，具有最低和最高PMI值的突变对属于同一突变类别。为什么几乎不一起发生的突变(即低PMI值突变对)属于同一类，这是一个令人感兴趣的研究问题，进一步的研究可以揭示这一意外发现。</li></ol><p id="fa9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">应用程序</strong></p><p id="25de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们不仅可以在检测基因突变的相似性方面使用分布式PMI计算，还可以在我们有一组类别和与类别相关的多个指示词的任何领域使用。例如，我们可以通过计算与我们最相关的一组词对的PMI，并通过我们的算法运行几篇新闻文章，找到其中几篇在这些词对的PMI得分方面排名较高的文章，来确定一篇新闻文章是否与我们相关。我们也可以有两个以上的词，分布式计算也可以很容易地扩展到这种情况。</p><p id="28b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一部分到此为止！希望你能从这篇文章中学到一些有用的东西。在<a class="ae km" href="https://bharatss.medium.com/distributed-biomedical-text-mining-using-pyspark-for-classification-of-cancer-gene-mutations-bd3b2ca05a9c" rel="noopener"> <strong class="jp ir">第二部分</strong> </a>中，我将讨论我在Spark MLlib中训练分布式多项逻辑回归模型的工作，以对未见过的研究论文中的突变进行分类。</p><p id="c96a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(我感谢Namratesh关于这个数据集的<a class="ae km" href="https://medium.datadriveninvestor.com/personalized-cancer-diagnosis-aea93bad0587" rel="noopener ugc nofollow" target="_blank">帖子</a>，它帮助指导了我的EDA的初始部分。)</p><p id="cdc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参考</p><ol class=""><li id="78e5" class="lm ln iq jp b jq jr ju jv jy lo kc lp kg lq kk lr ls lt lu bi translated">通过探索不同的分类器对基因突变进行自动分类，Badal Soni等人，使人工智能应用于数据科学，计算智能研究，Springer</li></ol></div></div>    
</body>
</html>