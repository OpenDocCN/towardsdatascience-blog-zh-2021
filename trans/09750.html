<html>
<head>
<title>Generating Geocodes Using Google Maps API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Maps API生成地理编码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generating-geocodes-using-google-maps-api-eb56028821a6?source=collection_archive---------16-----------------------#2021-09-12">https://towardsdatascience.com/generating-geocodes-using-google-maps-api-eb56028821a6?source=collection_archive---------16-----------------------#2021-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b190" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">地理空间分析。数据科学。ANALYTICS.PYTHON</h2><div class=""/><div class=""><h2 id="8549" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用Python快速获取地址的地理编码</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3f0e09172d573194dcd14edb1fe7a410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MkZ7zV_UUBcgXcsJ"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@kobuagency?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> KOBU机构</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="f5f6" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="f1c7" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">地理编码是将文本地址转换为地理纬度和经度坐标的过程，这反过来使得操纵和分析大量地理空间数据变得容易。</p><p id="f4bb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">对于数据科学家来说，了解地理编码有助于以可视化方式绘制地理编码并创建其他要素，例如两点之间的距离和时差。</p><p id="04c0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">与其他类型的数据不同，地理空间数据极大地受益于可视化，因为它使邻域或本地网络中模式的出现变得明显。</p><p id="4b8f" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">因此，企业从使用它中获利，但如果该过程涉及手动获取地理编码，则不会。</p><p id="887d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">虽然这个过程可以使用开源包来完成，<em class="nb"> OpenStreetMap，</em> Google Maps API可能会为更广泛的地址生成更准确的数据。</p><p id="18c5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在本文中，让我们研究如何通过Python和Google Maps API获得这些地理编码，以加速我们的数据项目。</p><h1 id="5368" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">初步:谷歌API密钥</h1><p id="54d4" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">使用谷歌地图API是要收费的，数据科学家在使用它之前需要了解价格。</p><p id="08cf" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">为了使用google maps API，我们需要生成自己的<strong class="mc jd"> API键</strong>来使用它。</p><h2 id="e626" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">第1步—转到<a class="ae lh" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌开发者控制台</a></h2><p id="8a9c" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">您将在这里看到您的仪表板。</p><h2 id="65cc" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">步骤2 —创建新项目</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nn"><img src="../Images/17e092de6f4ad279297d18a8454ea56d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OHjp2aGlYh2YZOFwfQgf3A.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者准备的GIF</p></figure><p id="8425" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">要创建一个新项目，请遵循上面的GIF。右上角有一个“选择一个项目”的文本。命名项目以更好地管理当前和未来涉及Google APIs的项目。</p><h2 id="92b3" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">步骤3-启用谷歌地理编码</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nn"><img src="../Images/3f45c805a0ce5902fa60b8568089b5e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vDeBYpSWCoDXeaTeBOwpBA.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者准备的GIF</p></figure><p id="aa63" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">浏览API库以启用地理编码服务。这被命名为“地理编码API”。</p><h2 id="f282" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">步骤4 —创建凭据以生成API密钥</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nn"><img src="../Images/eb271797fc98ddd6bc005d70d988e7e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*x1ThKBTLEACzVj5Cde4Vqg.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者准备的GIF</p></figure><p id="f57b" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">启用地理编码API服务后，转到<strong class="mc jd">凭证</strong>选项卡并选择“+创建凭证”。创建API密钥后，将其复制到Python代码中使用。</p><p id="55c6" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">您可以重命名API并对其进行限制，以确保其安全。对于每个API键(铅笔符号)，在“API键”表下有一个编辑选项来完成此操作。</em></p><h1 id="11eb" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">用于地理编码的PYTHON代码</h1><p id="83e0" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">要使用API密钥，请确保您已经安装了<code class="fe no np nq nr b">googlemaps</code>包:</p><pre class="ks kt ku kv gt ns nr nt nu aw nv bi"><span id="648e" class="nc lj it nr b gy nw nx l ny nz">pip install googlemaps</span></pre><h2 id="bb61" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">步骤1 —将GOOGLE MAPS API密钥存储为变量</h2><pre class="ks kt ku kv gt ns nr nt nu aw nv bi"><span id="440f" class="nc lj it nr b gy nw nx l ny nz">import googlemaps</span><span id="81ef" class="nc lj it nr b gy oa nx l ny nz">#Set Google MAPS API_Key<br/>g_API = "API-Key Copied"</span><span id="e4a4" class="nc lj it nr b gy oa nx l ny nz">gmaps_key = googlemaps.Client(key=g_API)</span></pre><h2 id="8877" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">步骤2-遍历地址并获取地理编码</h2><p id="6ca8" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在我们的练习中，让我们创建假地址来使用我们的代码:</p><pre class="ks kt ku kv gt ns nr nt nu aw nv bi"><span id="6ae6" class="nc lj it nr b gy nw nx l ny nz">from faker import Faker<br/>import pandas as pd</span><span id="1745" class="nc lj it nr b gy oa nx l ny nz">fake = Faker()</span><span id="44dd" class="nc lj it nr b gy oa nx l ny nz">df = pd.DataFrame(data=[fake.address().replace('\n', " ") for i in range(100)], columns=["address"])</span><span id="0b26" class="nc lj it nr b gy oa nx l ny nz"># Create columns to store longitude and lattitude</span><span id="f131" class="nc lj it nr b gy oa nx l ny nz">df["longitude"] = None<br/>df["latitude"] = None</span><span id="e623" class="nc lj it nr b gy oa nx l ny nz">for i in df.index:<br/>    geocode_obj = gmaps_key.geocode(df.loc[i, "address"])<br/>    try:<br/>        lat = geocode_obj[0]['geometry']['location']['lat']<br/>        lon = geocode_obj[0]['geometry']['location']['lng']<br/>        df.loc[i,'latitude'] = lat<br/>        df.loc[i,'longitude'] = lon<br/>    except:<br/>        lat = None<br/>        lon = None</span></pre><p id="9d67" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">瞧，我们完成了！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/3f176bed0a29a6316cb0f00ff939d0f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*4UjeVY_4qW9b7LFF1FMW8g.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由作者提供。</p></figure><h1 id="eb81" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">结束语</h1><p id="10ca" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">地理编码很重要，因为它允许计算机理解我们的参考点。这意味着，有了地理编码，分析和地理空间可视化(geovisualization)成为可能。除此之外，地理编码是独一无二的。</p><p id="9bc6" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">使用我们上面的方法是为我们的地址对象生成地理编码的最快和最可靠的方法之一。但是，有些地址偶尔会显示“无”，因此需要手动检查。然而，根据经验，当地址变量是干净的时，这种情况很少发生，所以在运行上面的代码之前，我们可能想看看我们是如何生成数据的。</p><p id="971c" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">查看我的其他与此相关的文章:</p><p id="36a8" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/mapping-your-favorite-coffee-shop-in-the-philippines-using-google-places-api-and-folium-2f9d5ad697bf?source=your_stories_page-------------------------------------">使用谷歌地图应用编程接口和树叶在菲律宾绘制你最喜欢的咖啡店地图</a></p><p id="1445" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/spatial-distance-and-machine-learning-2cab72fc6284?source=your_stories_page-------------------------------------">空间距离和机器学习</a></p><p id="42b4" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">让我知道你的想法！</p></div></div>    
</body>
</html>