<html>
<head>
<title>Introduction to Bootstrapping in Data Science — part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学中的引导介绍—第2部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-bootstrapping-in-data-science-part-2-ef7236e464a7?source=collection_archive---------34-----------------------#2021-04-02">https://towardsdatascience.com/introduction-to-bootstrapping-in-data-science-part-2-ef7236e464a7?source=collection_archive---------34-----------------------#2021-04-02</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="2519" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated"><strong class="ak">使用您选择的任何自定义统计数据比较两个样本</strong></h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/95b182c0272e63555b8f563ea6422e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQNepJn59Xh7c_AndbIFtQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@amyshamblen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">艾米·珊布伦</a>在<a class="ae kz" href="https://unsplash.com/collections/34290889/many-of-the-same-thing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4e84" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本系列的第一部分中，我们描述了如何使用随机样本和简单的迭代算法<strong class="lc iv"> bootstrapping </strong>来估计更广泛人群中几乎任何特征的置信区间。这种方法比传统的统计方法有决定性的优势:它是一种通用的方法，允许我们用几行代码来面对挑战性的问题。有趣的是，它也将我们从理论框架中解放出来，这些框架通常受到假设的约束，而这些假设可能并不适用于所有可能的情况。说实话，在很多情况下，我们不能依赖那些众所周知的教科书解决方案。</p><div class="lx ly gq gs lz ma"><a rel="noopener follow" target="_blank" href="/introduction-to-bootstrapping-in-data-science-part-1-6e3483636f67"><div class="mb ab fp"><div class="mc ab md cl cj me"><h2 class="bd iv gz z fq mf fs ft mg fv fx it bi translated">数据科学中的引导介绍—第1部分</h2><div class="mh l"><h3 class="bd b gz z fq mf fs ft mg fv fx dk translated">大胆探索理论从未涉足的领域。</h3></div><div class="mi l"><p class="bd b dl z fq mf fs ft mg fv fx dk translated">towardsdatascience.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo kt ma"/></div></div></a></div><p id="b71f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">好消息是，bootstrapping可以很容易地应用于其他设置，如<strong class="lc iv">双样本问题</strong>和<strong class="lc iv">假设检验</strong>。我们将在本文中讨论前者，并将后者留给本系列的第三部分也是最后一部分(敬请关注！).在本文的第一部分，我们将使用参数法和自举法来估计两个正态分布的<em class="lw">差异，其中方差未知且不等于</em>，作为两种方法一致的证明。然后，我们将提出一个更具挑战性的问题，这个问题没有简单的参数解，而bootstrapping可以毫不费力地解决它。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="1f0a" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated"><strong class="ak">例1.1:方差未知且不相等的传统均值差</strong></h2><p id="37a0" class="pw-post-body-paragraph la lb iu lc b ld np jv lf lg nq jy li lj nr ll lm ln ns lp lq lr nt lt lu lv in bi translated">假设我们有两个服从正态分布的总体(这是一个很大的假设),均值和方差未知。我们也知道方差互不相同。在这种情况下，我们需要估计均值的差异，并提供一个合理的置信区间。尽管这是一个有些不利的样本比较案例，但这也是一个众所周知的问题，你可以在你最喜欢的统计学教科书中查找(<strong class="lc iv">图1 </strong>):</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nu"><img src="../Images/40d02d9774272266bb1585d008835fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QOYbIHjscSe_NtcvLGbH9Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图1:理论框架。图片作者。</p></figure><p id="38ba" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">上面的一些等式相对来说比较密集，但是没有什么是我们不能用Python处理的。此外，如果样本量足够大，你可以简化问题，切换到一个<em class="lw"> z统计量</em>而不是一个<em class="lw"> t统计量</em>(并摆脱复杂的自由度计算)。在任何情况下，让我们坚持完整的公式，并遵循以下程序:</p><ol class=""><li id="7b9a" class="nv nw iu lc b ld le lg lh lj nx ln ny lr nz lv oa ob oc od bi translated">从每个群体中随机抽取一个样本(参见<strong class="lc iv">图2 </strong>和<strong class="lc iv">图3 </strong>)。</li><li id="8097" class="nv nw iu lc b ld oe lg of lj og ln oh lr oi lv oa ob oc od bi translated">使用<strong class="lc iv">图1 </strong>中所示的理论近似值计算统计值和置信区间。</li></ol><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/01fe519a6ec34fe8c12db8e4f72529ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0tk77VcF6FydqYhPYowKg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图2:两个种群A和B的分布，均值分别为1.0和0.0。图片作者。</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ok"><img src="../Images/1cb27ba4fc9de7bf2d23ad96ba140a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-J4w69ErnHMHagmZeU-Kw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图3:样品取自A和B，尺码分别为20和30。图片作者。</p></figure><p id="a0e3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这是一个估计置信区间的Python函数:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ol om l"/></div></figure><pre class="kk kl km kn gu on oo op oq aw or bi"><span id="d7bd" class="mw mx iu oo b gz os ot l ou ov">Difference=1.092<br/>Confidence interval (95%): [0.741, 1.444]</span></pre><p id="6a3b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在95%的置信度下，我们可以保证均值差异大于0.741且小于1.444。这个结果已经足够好了，因为实际值是1。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="0778" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated"><strong class="ak">示例1.2:自举解决了相同的问题</strong></h2><p id="5592" class="pw-post-body-paragraph la lb iu lc b ld np jv lf lg nq jy li lj nr ll lm ln ns lp lq lr nt lt lu lv in bi translated">自举函数来了。该算法非常类似于本系列第篇文章<a class="ae kz" rel="noopener" target="_blank" href="/introduction-to-bootstrapping-in-data-science-part-1-6e3483636f67">中详细描述的单样本版本:</a></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nu"><img src="../Images/6d2b1ddeac95c25f0862b2bdc68b4fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xMwFJKqHR6iLV9bjkLeMkw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><strong class="bd ow">图4: </strong>两个样本的自举算法。图片作者。</p></figure><ol class=""><li id="4c67" class="nv nw iu lc b ld le lg lh lj nx ln ny lr nz lv oa ob oc od bi translated">从两个群体中抽取样本A和B(参见<strong class="lc iv">图2 </strong>和<strong class="lc iv"> 3 </strong>)。</li><li id="98d7" class="nv nw iu lc b ld oe lg of lj og ln oh lr oi lv oa ob oc od bi translated">用完全相同的尺寸，从原始样品A中画出替换的重新样品。</li><li id="c8df" class="nv nw iu lc b ld oe lg of lj og ln oh lr oi lv oa ob oc od bi translated">用完全相同的尺寸，从原始样品B画一个替换的重样品。</li><li id="f546" class="nv nw iu lc b ld oe lg of lj og ln oh lr oi lv oa ob oc od bi translated">计算两次重采样的统计值(在这种情况下，平均值的差异)。</li><li id="80da" class="nv nw iu lc b ld oe lg of lj og ln oh lr oi lv oa ob oc od bi translated">将统计数据存储在列表中。</li><li id="0e0c" class="nv nw iu lc b ld oe lg of lj og ln oh lr oi lv oa ob oc od bi translated">转到2。重复几千遍。</li></ol><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ol om l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/40c0e6695d40d762176fb38bbd34e15a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBcl9aYs1BOKbE39URoe_Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图5:均值差异的Bootstrap分布。图片作者。</p></figure><pre class="kk kl km kn gu on oo op oq aw or bi"><span id="2781" class="mw mx iu oo b gz os ot l ou ov">n1=20 n2=30 iterations=10000<br/>sample_fn=1.092 <strong class="oo iv">bootstrap_mean=1.091</strong> bias=0.002 bootstrap_se=0.169<br/><strong class="oo iv">Confidence interval (95%): [0.762 ... 1.090 ... 1.418]</strong></span></pre><p id="7c9b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">列表中数值的分布为<strong class="lc iv"> bootstrap分布</strong>，其<strong class="lc iv"> </strong>近似于理论抽样分布。一般来说，它以样本(而不是总体)中的统计值为中心，允许有小的<strong class="lc iv">偏差</strong>。绘制它并检查它是否近似正常总是一个好主意。接下来，我们计算非参数<strong class="lc iv"> bootstrap百分位置信区间。也就是说，选择在bootstrap分布下包含您的置信水平所需区域的两个分位数。</strong></p><p id="0100" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">参数结果和自举结果都非常接近。但是，请注意，参数化方法是专门为这个问题定制的，而自举完全是通用的。例如，如果我们需要估计方差或任何其他自定义度量的差异，会发生什么？对于参数方法，我们必须寻找一组不同的方程(如果它们存在的话)。相反，引导只需要对代码进行少量更新。下一节将通过另一个例子精确地描述这些变化。</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="533b" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated"><strong class="ak">例2:两家公司的工资比较</strong></h2><p id="a51b" class="pw-post-body-paragraph la lb iu lc b ld np jv lf lg nq jy li lj nr ll lm ln ns lp lq lr nt lt lu lv in bi translated">假设我们想比较两家竞争公司的薪酬分配。为他们中的任何一个工作都很有吸引力，作为一个工作前景，除了报酬之外，没有任何明显的区别。不幸的是，他们没有透露这类信息，但是我们设法弄到了两个<strong class="lc iv">随机</strong>样品:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ox"><img src="../Images/351cdccf81efd8f705fb7164122b511a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kp_6cfpO-QzncOUx8junMw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图6:从公司A和公司b中随机抽取的月薪样本。</p></figure><p id="a270" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一个问题是:“两种方法如何相互比较？”传统和自举方法都可以解决这一步，结果是:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ol om l"/></div></figure><pre class="kk kl km kn gu on oo op oq aw or bi"><span id="9be8" class="mw mx iu oo b gz os ot l ou ov">Difference=-77.982<br/>Confidence interval (95%): [-460.342, 304.377]</span></pre><p id="5cea" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过自举:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ol om l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oy"><img src="../Images/7407695a71ecc3b795b5db616c9e85e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sa12stU5zhP517SF-Q_WCQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图7:均值差异的Bootstrap分布。图片作者。</p></figure><pre class="kk kl km kn gu on oo op oq aw or bi"><span id="f1b2" class="mw mx iu oo b gz os ot l ou ov">n1=75 n2=150 iterations=10000<br/>sample_fn=-77.982 <strong class="oo iv">bootstrap_mean=-78.844</strong> bias=0.862 bootstrap_se=191.647<br/><strong class="oo iv">Confidence interval (95%): [-454.325 ... -78.545 ... 296.170]</strong></span></pre><p id="21e6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，置信区间从-454.325到+296.170，因此它包含0。因此，我们不能忽视手段之间没有区别的可能性。这个事实引出了一个有趣的话题:如何在假设检验中使用bootstrapping，我们将在本系列的最后一篇文章中讨论。</p><p id="1fdd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在我们想更进一步。作为经验丰富的数据科学家，我们有充分的信心在公司阶梯的前30%找到一个位置。因此，我们想把我们的分析范围缩小到收入最高的四分之一人群。在这一点上，没有“传统的”参数化方法可以求助，所以我们应用bootstrapping。如上所述，除了计算统计数据的函数之外，我们可以方便地重用所有代码。在这种情况下，我们写一个新的来得到高于第70个百分位数的平均工资的差异:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ol om l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oz"><img src="../Images/14c081ba4b1ae0cb03eab1389fff9e51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXKHLU5MFbUyEt2-HqXp9Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图8:第70百分位以上均值差异的Bootstrap分布。图片作者。</p></figure><pre class="kk kl km kn gu on oo op oq aw or bi"><span id="c412" class="mw mx iu oo b gz os ot l ou ov">n1=75 n2=150 iterations=10000<br/>sample_fn=680.252 <strong class="oo iv">bootstrap_mean=676.566</strong> bias=3.686 bootstrap_se=256.013<br/><strong class="oo iv">Confidence interval (95%): [161.172 ... 683.415 ... 1164.408]</strong></span></pre><p id="4272" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以我们有理由确信(95%的信心)T4公司A支付给他们前30%的员工比B多。对于给定的样本，该差异估计为每月683。</p><p id="0fc2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了仔细检查，让我在下面包括我用来生成样本的实际分布。两者都刻意远离正常，均值相等(差正好为0)。然而，30%以上(约1，000)的工资差别很大。所以置信区间足够好了！</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oy"><img src="../Images/952424ca598d48f1864f92a876012632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oP8cunMyHRD-5ZSMV_jh3w.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图9:A公司和b公司的月工资分布，均值差为0，30%以上的工资均值差约为1000。图片作者。</p></figure></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="89c2" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated">最后的话</h2><p id="f0fb" class="pw-post-body-paragraph la lb iu lc b ld np jv lf lg nq jy li lj nr ll lm ln ns lp lq lr nt lt lu lv in bi translated">Bootstrapping是一种优雅的方法，它允许我们在没有任何理论框架(如果存在的话)的先验知识的情况下，轻松地构建自定义指标并比较总体。我们评估一个特征(或在这种情况下的特征比较),并以置信区间的形式评估它的可靠性。当问题变得越来越复杂时，参数方程通常会变得更加复杂，并且需要更多的假设。然而，自举算法保持不变，只需要针对特定问题进行微小的调整。这就是这种方法的优雅和方便之处。</p><p id="e07d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢您的阅读，敬请期待第三部分！</p></div><div class="ab cl mp mq hy mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="in io ip iq ir"><h2 id="e9d8" class="mw mx iu bd my mz na dn nb nc nd dp ne lj nf ng nh ln ni nj nk lr nl nm nn no bi translated">参考</h2><p id="d673" class="pw-post-body-paragraph la lb iu lc b ld np jv lf lg nq jy li lj nr ll lm ln ns lp lq lr nt lt lu lv in bi translated">[1]埃夫龙，B. (1979年)。<a class="ae kz" href="https://projecteuclid.org/journals/annals-of-statistics/volume-7/issue-1/Bootstrap-Methods-Another-Look-at-the-Jackknife/10.1214/aos/1176344552.full" rel="noopener ugc nofollow" target="_blank">自举方法:再看折刀</a>。<em class="lw">统计年鉴</em>，1–26。</p><p id="7121" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[2]埃夫龙，b .，蒂布拉尼，r .，，蒂布拉尼，R. J. (1994年)。<em class="lw">自举简介</em>。查普曼&amp;霍尔/CRC。</p><p id="994f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[3]戴维森和欣克利(1997年)。<em class="lw"> Bootstrap方法及其应用</em>(统计与概率数学中的剑桥系列)。剑桥:剑桥大学出版社。</p><p id="3b60" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[4]哥伦比亚特区蒙哥马利和佐治亚州龙格(2013年)。<em class="lw">工程师应用统计与概率</em>。约翰·威利的儿子们。</p><p id="d7e8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[5]摩尔博士、麦凯布博士和克雷格学士(2014年)。<em class="lw">统计学实践入门。</em>第八版。纽约:麦克米伦高等教育公司W.H. Freeman and Company。</p></div></div>    
</body>
</html>