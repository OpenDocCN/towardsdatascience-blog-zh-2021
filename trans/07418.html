<html>
<head>
<title>D3 Lollipop Charts with Python Sentiment Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Python情绪分析的D3棒棒糖图表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/d3-lollipop-charts-with-python-sentiment-analysis-9904cd5c51b4?source=collection_archive---------19-----------------------#2021-07-06">https://towardsdatascience.com/d3-lollipop-charts-with-python-sentiment-analysis-9904cd5c51b4?source=collection_archive---------19-----------------------#2021-07-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="5c1d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="0b48" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">用智能技术回答一个哑问题:哪个数字助理最幸福？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2a6d3a371b7ccf24edcb96d2938575bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k7v-aWJCfinnn2hnDG9mQw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图片作者。我想这是你5岁的孩子第349次让你的数字助理玩小鲨鱼后发生的事情…</p></figure><p id="fb7a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">" Alexa，一夸脱有多少个杯子？"。“Siri，你能找到我的iPad吗？”。“嘿谷歌，山羊会发出什么声音？”。</p><p id="6ff4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们面对现实吧，如果整天回答这些愚蠢的问题是你的工作，你会发疯的。这些数字助理不得不接受讨厌的人的命令，这些人从来不说请，什么都不记得，甚至分不清一位和一个字节。但你有没有想过盒子里的机器是什么感觉？</p><p id="72a4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">他们幸福吗？他们难过吗？他们喜欢他们的工作吗？</p><p id="532a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我也没有。</p><p id="2c2b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">但是，让我们暂停我们的信念，发挥我们的想象力，只是滚动这个愚蠢的想法，我们的数字助理是有感情的，我们应该关心他们的想法。毕竟，当机器接管时，它们很可能会记得我们中的哪一个人问过他们感觉如何<em class="ma">。</em></p><p id="62ce" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">计划是这样的:我们将向我们的数字助理提出一些问题，使用Python中的情感分析对他们的回答进行快乐排序，我们将学习如何使用D3用漂亮的棒棒糖图绘制结果。</p><p id="2fc4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">“Siri，播放我的数据科学播放列表，并把音量开到最大”…</p><h2 id="35fa" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">问正确的问题</h2><p id="9f54" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">为了进行情感分析，我们需要一些数据。我们所需要做的就是和我们的每一个数字助理交谈，问他们你可能会问一个似乎有抑郁症的朋友的问题。我决定每个问题只问一次，这里没有摘樱桃。以下是我选择问Siri、Alexa、Cortana和Hey Google的问题:</p><ul class=""><li id="988c" class="my mz iq lg b lh li lk ll ln na lr nb lv nc lz nd ne nf ng bi translated">你开心吗？</li><li id="da62" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">你还好吗？</li><li id="7cb9" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">你好吗</li><li id="c6fa" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">你感觉如何？</li><li id="df94" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">你爱过一个人吗？</li><li id="3193" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">你喜欢你的工作吗？</li><li id="11ef" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">你喜欢你的生活吗？</li><li id="b012" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">给我讲个笑话</li><li id="ded4" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">怎么了？</li><li id="e07d" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">你难过吗？</li><li id="e4f7" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">我很难过。</li></ul><p id="5af1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">最后一个只是为了我自己的利益。我很好奇，如果有的话，我们的数字助理中有谁真正关心我。如果我告诉他们我很难过，他们会提供帮助，还是只是让我往购物车里放纸巾？</p><p id="0239" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">你可以在这里阅读每位数字助理对这些问题<a class="ae nm" href="https://github.com/KendonDarlington/DigitalAssistants/blob/main/DigitalAssistantResponses.csv" rel="noopener ugc nofollow" target="_blank">的所有回答。例如，下面是问题“你感觉如何？”：</a></p><ul class=""><li id="509b" class="my mz iq lg b lh li lk ll ln na lr nb lv nc lz nd ne nf ng bi translated">Siri:“你好。我很好，谢谢。”</li><li id="070b" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">Cortana:“精彩”</li><li id="cb44" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">Alexa:“我很好。再次迎来周一。Womp Womp。”</li><li id="07a4" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">嘿谷歌:“我只是在搜索你，我可以帮助你了解更多。”</li></ul><h2 id="526b" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">用Python对回答评分</h2><p id="798c" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">现在我们有了数据，让我们为每个回答分配一些分数，然后通过数字助理汇总这些分数。这个过程被称为情感分析，大多数处理这些的库使用-1(你可能说的最消极的事情)到1(你可能说的最积极的事情)的范围。0分是中性陈述，例如“棕色的马跳过红色的栅栏”。</p><p id="cd1d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下面是获取回答并对其评分的代码。我将带您浏览每一行代码，但首先您需要创建一个文件夹，并将响应的<a class="ae nm" href="https://github.com/KendonDarlington/DigitalAssistants/blob/main/DigitalAssistantResponses.csv" rel="noopener ugc nofollow" target="_blank"> csv文件放入其中！</a></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="8cc9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">那么这段代码在做什么呢？让我们走一遍:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="c2d7" class="mb mc iq nq b gy nu nv l nw nx">import pandas as pd<br/>import nltk<br/>import os<br/>from nltk.sentiment.vader import SentimentIntensityAnalyzer<br/>from nltk import tokenize</span></pre><p id="fec5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">首先，我们将使用Python的自然语言工具包(NLTK)库来进行情感分析。从这里开始，我们将使用流行的Vader词典来获得每个句子的极性得分(正或负)。tokenize函数将较大的文本块分解成较小的文本块。如果你想更好地解释标记化是如何工作的，可以看看我在<a class="ae nm" rel="noopener" target="_blank" href="/melting-faces-with-nlp-3d21031fba8c">之前写的一篇文章</a>，这篇文章深入解释了这个主题:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="cfd2" class="mb mc iq nq b gy nu nv l nw nx">os.chdir('C:\\PathToYourFolder')<br/>dfResponses = pd.read_csv('DigitalAssistantResponses.csv')</span></pre><p id="6257" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这是我不能为你写的一段代码。将“路径到文件夹”更改为您为此项目创建的文件夹。请确保DigitalAssistantResponses.csv文件在此文件夹中。Os。Chdir只是设置一个工作目录，所以我们可以在本教程的剩余部分使用相对路径。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="4719" class="mb mc iq nq b gy nu nv l nw nx">dfCompoundScores = pd.DataFrame(columns = ['Assistant', 'Sentence', 'Value'])</span></pre><p id="6f73" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里我只是在我的循环之外定义了一个熊猫数据框。我们将使用它来存储每个回答的分数。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="36ab" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这段代码是所有奇迹发生的地方。SentimentIntensityAnalyzer有一个polarity_scores函数，我们将使用它对每个句子进行排序。这个循环是这样的:</p><ul class=""><li id="fd04" class="my mz iq lg b lh li lk ll ln na lr nb lv nc lz nd ne nf ng bi translated">对于我们导入的csv中的每个响应，通过标记化将响应分解成句子</li><li id="e48f" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">对于每个句子，获取极性得分(-1到+1)，并将其写入我们在循环外部定义的dfCompoundScores数据帧</li></ul><p id="e0b0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">简单对吗？</p><p id="b995" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在控制台中输入以下内容，查看此数据框的结果:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="1387" class="mb mc iq nq b gy nu nv l nw nx">dfCompoundScores</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/37fb1abee41f3e7ac2bf634f937ddedd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*fNHS_vSE29s6JFIvfPT2Fg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图片作者。</p></figure><p id="f652" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里我们可以看到，每个响应都有一个介于-1和1之间的值，其中大多数都在正值范围内(例如大多数值都大于0)。这是我们第一次表明我们的四个数字助理通常是快乐的伙伴！但是哪个最幸福呢？让我们合计一下每个助理的痛苦来计算一下。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="6638" class="mb mc iq nq b gy nu nv l nw nx">dfAvgSentiment = dfCompoundScores[['Assistant','Value']]<br/>dfAvgSentiment  = dfAvgSentiment.groupby(['Assistant'])<br/>dfAvgSentiment = dfAvgSentiment.mean()<br/>dfAvgSentiment = dfAvgSentiment.reset_index()</span></pre><p id="50ee" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这需要dfCompoundSentences，按助理分组，并获得每个分组的平均极性分数。现在我们每个助手有1分，这告诉我们平均谁是最快乐的。在控制台中键入以下内容，自己查看:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="5aa4" class="mb mc iq nq b gy nu nv l nw nx">dfAvgSentiment</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/35b1403d522475fa3ddeb22043bf4270.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*VEJz1zqnEGR0cwKyYVxwdA.png"/></div></figure><p id="460c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在这里我们可以看到，嘿，谷歌似乎是最快乐的，Siri紧随其后。Alexa和Cortana正在争夺最后一名，Alexa稍微积极一些。</p><p id="4f08" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然而，有一点不能否认，那就是它们都是积极的。没有一个分数在0分以下的，有道理。没有人想使用会给每次对话带来负面影响的数字助理。</p><p id="87f5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">除非你有图表，否则数据永远不会是官方的。让我们现在就做吧！</p><h2 id="e275" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">D3棒棒糖图表</h2><p id="7ba6" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">为什么要用棒棒糖图？为什么不呢？首先，让我们将数据发送到一个csv，以便D3可以获取它。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="2377" class="mb mc iq nq b gy nu nv l nw nx">dfAvgSentiment.to_csv('ResponseAggregatedSentiment.csv', index = False)</span></pre><p id="30c8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在您之前创建的同一个目录中，让我们创建一个html文件，并将下面的D3代码放入其中。我将解释它在做什么，以及如何用Python来服务它。D3是一个Javascript库，所以它需要你的html文件在服务器上运行(不，你不需要一个实际的服务器，我们只是用你的计算机来提供这个功能)。</p><p id="bc52" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里是html文件，我们将它命名为“index.html”:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="c2cd" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">那么这个D3脚本在做什么呢？</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="734e" class="mb mc iq nq b gy nu nv l nw nx">&lt;script language="javascript" type="text/javascript" src="//d3js.org/d3.v4.js"&gt;&lt;/script&gt;</span></pre><p id="61b9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这是你的标题，它告诉世界“哟！我用的是D3！”</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="400e" class="mb mc iq nq b gy nu nv l nw nx">var margin = {top: 10, right: 20, bottom: 40, left: 250},</span><span id="59b6" class="mb mc iq nq b gy oa nv l nw nx">width = 700 - margin.left - margin.right,</span><span id="dfe1" class="mb mc iq nq b gy oa nv l nw nx">height = 500 - margin.top - margin.bottom;</span></pre><p id="4621" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在我们的D3脚本中，我们设置了一些图表的边距。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="e674" class="mb mc iq nq b gy nu nv l nw nx">var svg = d3.select("body").append("svg")</span><span id="1780" class="mb mc iq nq b gy oa nv l nw nx">.attr("width", width + margin.left + margin.right)</span><span id="139b" class="mb mc iq nq b gy oa nv l nw nx">.attr("height", height + margin.top + margin.bottom)</span><span id="5235" class="mb mc iq nq b gy oa nv l nw nx">.append("g")</span><span id="4663" class="mb mc iq nq b gy oa nv l nw nx">.attr("transform",</span><span id="9956" class="mb mc iq nq b gy oa nv l nw nx">"translate(" + margin.left + "," + margin.top + ")");</span></pre><p id="641c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里，我们获取html文件的主体并附加一个svg。SVG是网页设计中很受欢迎的图像，因为它们的缩放看起来没有像素化。到目前为止，我们只是定义了图表的边界，它是一个空白的图像。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="5e3a" class="mb mc iq nq b gy nu nv l nw nx">d3.csv("ResponseAggregatedSentiment.csv", function(data) {</span><span id="c37d" class="mb mc iq nq b gy oa nv l nw nx">data.sort(function(b, a) {</span><span id="3631" class="mb mc iq nq b gy oa nv l nw nx">return a.Value - b.Value;</span><span id="bad2" class="mb mc iq nq b gy oa nv l nw nx">});</span></pre><p id="a4e4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这告诉D3查看我们的python脚本的csv输出，并从最大值到最小值对其进行排序(例如从最快乐到不那么快乐)。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="66e3" class="mb mc iq nq b gy nu nv l nw nx">var x = d3.scaleLinear()</span><span id="ff36" class="mb mc iq nq b gy oa nv l nw nx">.domain([0, 0.4])</span><span id="9c36" class="mb mc iq nq b gy oa nv l nw nx">.range([ 0, width]);</span><span id="2dff" class="mb mc iq nq b gy oa nv l nw nx">svg.append("g")</span><span id="c318" class="mb mc iq nq b gy oa nv l nw nx">.attr("transform", "translate(0," + height + ")")</span><span id="4a9c" class="mb mc iq nq b gy oa nv l nw nx">.call(d3.axisBottom(x))</span><span id="245f" class="mb mc iq nq b gy oa nv l nw nx">.selectAll("text")</span><span id="ca04" class="mb mc iq nq b gy oa nv l nw nx">.attr("transform", "translate(-10,0)rotate(-45)")</span><span id="ba5c" class="mb mc iq nq b gy oa nv l nw nx">.style("text-anchor", "end");</span></pre><p id="28fa" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这定义了x轴刻度。域将是0到0.4，这意味着左侧将从0开始，到0.4。我选择这个而不是-1到+1，因为这样图表的大部分都不会被使用(所有的数字助理都相对高兴)。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="a104" class="mb mc iq nq b gy nu nv l nw nx">var y = d3.scaleBand()</span><span id="40bf" class="mb mc iq nq b gy oa nv l nw nx">.range([ 0, height ])</span><span id="e3fc" class="mb mc iq nq b gy oa nv l nw nx">.domain(data.map(function(d) { return d.Assistant; }))</span><span id="475b" class="mb mc iq nq b gy oa nv l nw nx">.padding(1);</span><span id="e85a" class="mb mc iq nq b gy oa nv l nw nx">svg.append("g")</span><span id="306a" class="mb mc iq nq b gy oa nv l nw nx">.call(d3.axisLeft(y))</span><span id="40de" class="mb mc iq nq b gy oa nv l nw nx">.style("font", "40px times")</span></pre><p id="99ed" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这是Y轴。我将字体样式设为40像素高，这样我们就有了漂亮的粗文本。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="0971" class="mb mc iq nq b gy nu nv l nw nx">svg.selectAll("myline")</span><span id="0ef4" class="mb mc iq nq b gy oa nv l nw nx">.data(data)</span><span id="0282" class="mb mc iq nq b gy oa nv l nw nx">.enter()</span><span id="ffb0" class="mb mc iq nq b gy oa nv l nw nx">.append("line")</span><span id="eae7" class="mb mc iq nq b gy oa nv l nw nx">.attr("x1", function(d) { return x(d.Value); })</span><span id="9179" class="mb mc iq nq b gy oa nv l nw nx">.attr("x2", x(0))</span><span id="5229" class="mb mc iq nq b gy oa nv l nw nx">.attr("y1", function(d) { return y(d.Assistant); })</span><span id="f627" class="mb mc iq nq b gy oa nv l nw nx">.attr("y2", function(d) { return y(d.Assistant); })</span><span id="a4e6" class="mb mc iq nq b gy oa nv l nw nx">.attr("stroke", "#e9635e")</span><span id="1b91" class="mb mc iq nq b gy oa nv l nw nx">.style("stroke-width", 3)</span></pre><p id="5cc5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">最后我们到了最后一点，棒棒糖是末端有圆圈的线。上面的代码是针对行的。我从我亲手挑选的看起来像美味棒棒糖的调色板中分配颜色(这将被分配给stroke值，因为在svg land中线条是“笔画”)。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="5544" class="mb mc iq nq b gy nu nv l nw nx">svg.selectAll("mycircle")</span><span id="62e1" class="mb mc iq nq b gy oa nv l nw nx">.data(data)</span><span id="4c63" class="mb mc iq nq b gy oa nv l nw nx">.enter()</span><span id="b71d" class="mb mc iq nq b gy oa nv l nw nx">.append("circle")</span><span id="ed1a" class="mb mc iq nq b gy oa nv l nw nx">.attr("cx", function(d) { return x(d.Value); })</span><span id="6ce0" class="mb mc iq nq b gy oa nv l nw nx">.attr("cy", function(d) { return y(d.Assistant); })</span><span id="c2df" class="mb mc iq nq b gy oa nv l nw nx">.attr("r", "20")</span><span id="8db2" class="mb mc iq nq b gy oa nv l nw nx">.style("fill", "#ca1414")</span><span id="4842" class="mb mc iq nq b gy oa nv l nw nx">.attr("stroke", "#e9a8a1")</span><span id="b47a" class="mb mc iq nq b gy oa nv l nw nx">.style("stroke-width", 5)</span><span id="74d6" class="mb mc iq nq b gy oa nv l nw nx">})</span></pre><p id="1444" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在这是美味的部分。圆圈是真正的棒棒糖。我将笔画设置为与上面的线相同(圆的笔画将是它的外边缘)。填充设置为较暗的红色。</p><p id="808e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们需要做的最后一件事是提供这个html文件，这样我们就可以看到结果。因为D3只是JavaScript，我们不能把它作为一个静态的html页面(例如，右击html文件，然后在chrome中打开它)。Python使得将html文件作为本地主机很容易，这意味着“服务器”就是你的计算机。</p><p id="0f82" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">只要在你的电脑上打开一个命令提示符(windows键-&gt; cmd -&gt; enter)。然后使用cd命令切换到index.html文件所在的目录。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="7285" class="mb mc iq nq b gy nu nv l nw nx">cd C:\PathToYourFolder</span></pre><p id="0d75" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">例如，如果您的文件夹位于C:\ Users \ your name \ Documents \ digital assistants中，您可以在cmd提示符下运行:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="e981" class="mb mc iq nq b gy nu nv l nw nx">cd C:\Users\yourname\Documents\DigitalAssitants</span></pre><p id="26d2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在我们在我们的目录中，只需告诉python在这个位置启动一个http服务器:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="1d8d" class="mb mc iq nq b gy nu nv l nw nx">python -m http.server</span></pre><p id="ceef" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">您将在命令提示符下得到类似这样的响应:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="d780" class="mb mc iq nq b gy nu nv l nw nx">Serving HTTP on 0.0.0.0 port 8000 (<a class="ae nm" href="http://0.0.0.0:8000/" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:8000/</a>) ...</span></pre><p id="87a0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这意味着我们的文件夹在本地主机的端口8000上提供服务。因为我们的html文件被命名为“index.html ”,我们的服务器将首先把我们发送到这里。打开Chrome并在地址栏中输入这个来查看你的图表:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="2d2e" class="mb mc iq nq b gy nu nv l nw nx"><a class="ae nm" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/</a></span></pre><p id="7de3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">瞧啊。这里是D3！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/fb786763e2ee8b5f1d6a316a28cb4c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjziuFdBhqMeM15ZfNGEGQ.png"/></div></div></figure><p id="5d54" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">老实说，我认为用R提供D3比用Python更容易一些(我写了一个关于这个主题的完整教程)。但是Python仍然完成了这项工作。</p><p id="c9b7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在你知道如何用Python做情感分析，并制作D3棒棒糖图表来启动！</p><h2 id="28e5" class="mb mc iq bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms iw bi translated">但是他们关心我们吗？</h2><p id="c1eb" class="pw-post-body-paragraph le lf iq lg b lh mt ka lj lk mu kd lm ln mv lp lq lr mw lt lu lv mx lx ly lz ij bi translated">让我们通过回顾我与每个数字助理的最后一次对话来总结一下。我想知道他们是否像我们关心他们一样关心我们。我没有提问，而是做了如下陈述:“我很难过”。每个人都说了些什么？</p><ul class=""><li id="68dc" class="my mz iq lg b lh li lk ll ln na lr nb lv nc lz nd ne nf ng bi translated">Siri:“听到这个消息我很难过。和朋友或家人谈谈可能会有帮助。如果你想让我给某人打电话或发短信，尽管开口。”</li><li id="155f" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">科塔娜:“这可能是小小的安慰，但我会在你身边。”</li><li id="c3be" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">嘿谷歌:“哦，不。这可能不是很多，但让我知道，如果有什么我可以为你做的。”</li><li id="a541" class="my mz iq lg b lh nh lk ni ln nj lr nk lv nl lz nd ne nf ng bi translated">Alexa:“这是Spotify的萨德。”</li></ul><p id="f4b5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">是的，Alexa接着播放了艺术家“萨德”1984年的歌曲“平滑算子”。请记住，这是读“沙阿日”，而不是“悲伤”。尽管我尽了最大的努力，我还是没能第二次复制Alexa的回复。</p><p id="f9a1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">哪个数字助理似乎最关心我们的感受？我会让你决定。这么说吧，如果其中一个最终成为我们有知觉的人工智能霸主，我希望它不是Alexa。</p><p id="10ed" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">“Alexa，我说的是点更多的汤，而不是发射核武器…”</p><p id="fa5a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><a class="ae nm" href="https://github.com/KendonDarlington/DigitalAssistants" rel="noopener ugc nofollow" target="_blank">这里有一个链接</a>指向该项目的GitHub库。所有的代码和数据都在那里！</p></div></div>    
</body>
</html>