<html>
<head>
<title>Predicting Pulsar Stars: An Imbalanced Classification Task Comparing Bootstrap Resampling to SMOTE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测脉冲星:一个不平衡的分类任务:比较Bootstrap重采样和SMOTE</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-pulsar-stars-an-imbalanced-classification-task-comparing-bootstrap-resampling-to-smote-8cfbe037b807?source=collection_archive---------15-----------------------#2021-09-30">https://towardsdatascience.com/predicting-pulsar-stars-an-imbalanced-classification-task-comparing-bootstrap-resampling-to-smote-8cfbe037b807?source=collection_archive---------15-----------------------#2021-09-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/30f569404b18dc945f70ba042e5b60b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*56v8V2rti18R9XNp"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">瑞安·赫顿在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="cd99" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对不平衡数据集进行分类是一项非常常见的数据科学任务，有大量的文章解释了不同的方法。</p><p id="fc4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如这些文章将向读者解释的那样，如果机器学习模型是在不平衡数据上训练的，它们通常会发现很难很好地学习和概括，即一个或多个类别被不成比例地代表(通常代表不足)的数据。因此，我们需要采取一些措施来解决这个问题；通常这是通过对学习数据的一些调整来完成的。</p><p id="9bde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我是一个比较事物的爱好者，我经常喜欢比较非常简单的方法和更复杂的方法。</p><p id="8d37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一次，我将用脉冲星的数据来比较随机重采样技术和SMOTE。</p><h1 id="74b0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">背景</strong></h1><p id="f72c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Kaggle用户<strong class="kf ir"> Pavan Raj </strong>最好地描述了任务的背景(他也将数据上传到了<a class="ae kc" href="https://www.kaggle.com/colearninglounge/predicting-pulsar-starintermediate" rel="noopener ugc nofollow" target="_blank">ka ggle</a>——我是从那里获得的):</p><p id="0058" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“HTRU2是一个数据集，描述了在高时间分辨率宇宙调查期间收集的脉冲星候选样本。</p><p id="8e09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">脉冲星是一种罕见的中子星，它产生的无线电辐射在地球上可以探测到。作为时空、星际介质和物质状态的探测器，它们具有相当大的科学价值。</p><p id="8da6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着脉冲星的旋转，它们的发射光束扫过天空，当光束穿过我们的视线时，会产生一种可检测的宽带无线电发射模式。随着脉冲星快速旋转，这种模式周期性重复。因此，脉冲星搜索包括用大型射电望远镜寻找周期性的无线电信号。</p><p id="66bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每颗脉冲星产生的发射模式略有不同，每次旋转都会略有不同。因此，被称为“候选者”的潜在信号探测在脉冲星的多次旋转中被平均化，这由观测的长度决定。在缺乏额外信息的情况下，每个候选者都有可能描述一颗真正的脉冲星。然而，在实践中，几乎所有的检测都是由射频干扰(RFI)和噪声引起的，使得合法信号很难找到。</p><p id="31c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">机器学习工具现在正被用来自动标记脉冲星候选体，以促进快速分析。分类系统尤其被广泛采用，它将候选数据集视为二元分类问题。在这里，合法的脉冲星例子是少数正类，而虚假的例子是多数负类。这里分享的数据集包含了RFI和/或噪声引起的乱真例子，以及真实的脉冲星例子。这些例子都已经被人类注释者检查过了。</p><p id="7b37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每行首先列出变量，类标签是最后一项。使用的类别标签是0(负)和1(正)。</p><p id="d3e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个候选项由8个连续变量和一个单一类别变量描述。前四个是从综合脉冲轮廓(折叠轮廓)获得的简单统计。这是一个连续变量数组，用于描述信号的经度解析版本，该信号在时间和频率上都进行了平均。其余四个变量类似地从DM-SNR曲线中获得。这些总结如下:</p><ol class=""><li id="16eb" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la mj mk ml mm bi translated">积分轮廓的平均值。</li><li id="93ab" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">集成剖面的标准偏差。</li><li id="6626" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">积分轮廓的过度峰度。</li><li id="fa69" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">集成轮廓的偏斜度。</li><li id="601e" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">DM-SNR曲线的平均值。</li><li id="3817" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">DM-SNR曲线的标准偏差。</li><li id="5484" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">DM-SNR曲线的过度峰度。</li><li id="510b" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">DM-SNR曲线的偏斜度。</li><li id="4de1" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">班级</li></ol><h1 id="d928" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">假设</h1><p id="4a38" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><em class="ms">在样本外数据上，基于SMOTE数据重采样数据构建的模型将优于基于bootstrap数据重采样构建的模型。</em></p><p id="503c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">为什么？</strong>考虑两颗具有“相似”特征的脉冲星。在我看来，我们可以认为这些信号在边界之外，我们可以预期任何信号在边界之内的候选星也将是脉冲星。由于SMOTE在现有观察“之间”创建合成观察，因此模型将能够学习这种关系..</p><h1 id="c1e2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">建立</h1><p id="12bb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">让我们导入我们将在分析中使用的包。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="b255" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据</h1><p id="c314" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">导入数据并评估我们正在处理的内容。</p><p id="0551" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">前几行:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/7391c8a6749a53abbd786bbbe509a799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2j5AlZ03vQlOCOoVhEXJ_A.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="8fd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总结:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/cc3e88a75268c52686f9e44d4bc64053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ct6jRMqf1uLsfIZVWN1O5w.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="cc71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查缺失值:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/1d514615ec252990c3cb10642ec4bf55.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*yio0sbdR1OdVG0p271MpyQ.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="10d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的原始数据集包含大约12.5k个观测值，其中一些包含缺失值。我们必须以某种方式处理这些价值观；现在，让我们将它们从数据中删除。</p><p id="28b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">得到的数据集大约有9.2k个观察值，损失了大约25%的行！</p><p id="5bcb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也许我们应该估算这些…一篇关于估算的有用文章(如果我自己这么说的话)可以在这里找到<a class="ae kc" rel="noopener" target="_blank" href="/filling-in-the-gaps-imputation-3-ways-6056c09b6417">填补空白:估算3种方法| Bradley Stephen Shaw |走向数据科学</a>。</p><p id="ac6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">让我们快速看一下我们的目标变量，也就是我们试图预测的。</strong></p><p id="e724" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这本质上是一个指示变量:0表示候选星不是脉冲星启动，1表示相反。至关重要的是，目标中不存在遗漏的观察值。</p><p id="7108" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据到底有多不平衡？我们看到在9.2k的候选者中，只有9.2%是脉冲星。因此，事实证明，数据非常不平衡。</p><p id="b3ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">我们应该已经到了可以探索输入变量的时候了。</strong></p><p id="e61b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在此之前，让我们重命名这些列。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="7dae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对某些人来说，这似乎有些迂腐，但是我的敏锐感觉告诉我，使用包含混合大小写、空格和标点符号的列名将是一场噩梦，我宁愿避免。</p><p id="d943" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">至此，我们可以看看输入要素的分布了。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/481b025c158b2d26cfbc3d3acaf3ac4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yds4G-pIOrlJWt7xmOrlDw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="0651" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些特征看起来都像预期的那样连续。大多数特征似乎都有一定程度的偏斜，有些特征包含大量异常值。</p><p id="1ac2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样重要的是要注意变量在不同的尺度上——如果我们要使用正则化技术，要记住这一点(提示:我们不打算这样做)。</p><p id="1c72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还值得注意的是，一些特征是相互关联的-记住，峰度和偏度都是分布的均值和方差的函数，并且具有非常相似的函数定义。让我们直观地探索一下:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/85588022fd3c9b72291483f5c4f3e5f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlhw0niM2vlslO0mgCLMPA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="72f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们有一个集成轮廓特征的配对图。</p><ul class=""><li id="2bf5" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la ne mk ml mm bi translated">我们可以看到均值和峰度以及均值和偏度之间的非线性关系在减小…</li><li id="ccd7" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ne mk ml mm bi translated">我们可以说标准差和峰度以及标准差和偏度之间的关系也是如此，尽管趋势稍微有些混乱…</li><li id="b6f8" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ne mk ml mm bi translated">并且在偏斜度和峰度之间有明显的关系。</li></ul><p id="2e6d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在探索性的数据分析已经足够了，让我们继续为建模准备数据。</p><h1 id="7cc4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为建模准备数据</h1><p id="6297" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">更具体地说，我们将:</p><ol class=""><li id="8d55" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la mj mk ml mm bi translated">将数据分成训练样本和测试样本</li><li id="6285" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">在我们建模之前平衡数据。我们将研究两种技术来做到这一点——随机重采样和合成少数过采样技术(SMOTE下面会有更多的介绍)。</li></ol><p id="80f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们将数据分成训练样本和测试样本。我将使用标准的80:20训练:测试分割，使用<code class="fe nf ng nh ni b">sklearn</code>来完成繁重的工作。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="d532" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们快速看一下我们的训练数据，区分脉冲星恒星的积极和消极识别。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/c38a08503b3e3f5105cb36e5828d08c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L784ZaY6IC8RJ5zW3L_ChA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="5c9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于大多数特征来说，在大多数特征中，正面和负面的情况似乎有明显的区别。</p><p id="b6e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在可以重新采样我们的训练数据。</p><p id="9633" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们所知，这个数据集是高度不平衡的，也就是说，负面事例比正面事例多得多。这在现实世界中并不是一个完全陌生的概念，任何试图对高超额(再)保险层的欺诈行为或损失建模的人都会证明这一点。</p><p id="4d1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为什么我们需要平衡数据？建立在不平衡数据上的机器学习模型将高度偏向主导阶级，因为该模型没有足够的信息来学习如何识别少数阶级。</p><p id="fcfe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有几种方法可以解决这个问题——我们可以对数据进行采样，以<em class="ms">充分增加</em>少数阶级的比例(“上采样”)，或者对数据进行采样，以<em class="ms">充分减少</em>多数阶级的比例(“下采样”)。如果有必要，我们甚至可以两种方法都用！</p><p id="0a2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将考虑的两种技术——随机重采样和SMOTE——都是“上采样”数据的方法。</p><p id="abf0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">随机重采样(bootstrap) </strong>大多数从业者都会很熟悉。它包括多次随机抽样数据替换。bootstrap实现起来相当简单，并且被广泛理解。</p><p id="d797" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，用户应该注意过度的自举——对现有信息的过多“回收”会导致偏见。如果需要不相称的上采样量来平衡数据集，更好的办法可能是在将自举应用于上采样之前，先对多数类进行下采样。</p><p id="8ad1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">合成少数过采样技术(SMOTE) </strong>是一种执行上采样的新方法。SMOTE不是重新创建现有数据，而是一种“最近邻”技术，它应用插值来合成现有少数实例之间的新少数实例<em class="ms">。</em></p><p id="3b87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像bootstrap一样，在应用SMOTE之前，我们需要考虑数据的适当性。例如，将SMOTE应用于已经以某种方式有偏差的数据提取将导致另一个数据也有偏差。</p><p id="8179" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，想象我们正在模拟信用违约。不为我们所知的是，我们的数据提取出了问题，我们对年轻的信贷申请人产生了偏见——比如说，18至25岁之间的人信贷违约的比例更高。将SMOTE应用于此将创建新的违约者实例，但这些新实例也将在18至25岁之间，从而使偏见永久化。</p><p id="c76e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建像上面这样的图表有助于我们理解我们的数据是否代表现实。没有太多关于脉冲星的知识，我将假设它是，并应用<code class="fe nf ng nh ni b">imbalanced-learn</code>中可用的SMOTE实现。</p><p id="e1f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创建两组平衡的数据—一组由bootstrap平衡，另一组由SMOTE平衡。我们将分别用<code class="fe nf ng nh ni b">resample</code>和<code class="fe nf ng nh ni b">smote</code>作为后缀。</p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="b550" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意SMOTE重采样需要最少的代码。</p><p id="e85c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们检查结果分布<em class="ms">(注意:我已经检查了结果数据集是相同大小的)。</em></p><p id="9a20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先随机上采样数据:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/4eeeb1e75dcd86ac8ae1c30e346e0f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ou94PpWeZ9ACBi3s8MIiAQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="1aa4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在是SMOTE样本:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/f0e14756b71b246b33db532171587b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bF-rn-EvEue7azq8neavzg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="64f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">两个样本现在都是平衡的(50%负实例，50%正实例)，更令人放心的是，特征分布保留了我们最初在不平衡数据中看到的形状和模式。</p><h1 id="052a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">系统模型化</h1><p id="369b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这一次我们将使用随机森林模型来预测脉冲星。为了能够比较不同采样方法的影响，我们将构建并评估两个模型。</p><p id="88fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个模型将根据随机重采样的数据进行训练，另一个模型将根据SMOTE数据进行训练。然后，我们将根据不平衡的测试数据评估这两个模型。</p><p id="df52" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe nf ng nh ni b">sklearn</code>构建模型，然后使用F1分数评估其性能，这相当简单。</p><p id="704e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ms">关于模型验证指标的快速说明…F1分数是对测试准确性的衡量，同时考虑了</em> <strong class="kf ir"> <em class="ms">精度</em> </strong> <em class="ms">和</em> <strong class="kf ir"> <em class="ms">召回</em> </strong> <em class="ms">。F1取[0，1]中的值，其中0代表最差的可能结果，1代表最好的可能结果。F1在机器学习中广泛用于二进制分类问题。</em></p><figure class="mt mu mv mw gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/f0b3e2d4e3b32503e2a4fb39707bd258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*bvD5JqrQEkqLqPRcNFSYig.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="934e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在训练集上有相当高的性能，在样本外测试集上的性能不容小觑。</p><p id="12fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看看在SMOTE数据上训练的模型是如何做的:</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1a4d0e4aa0ed15deeb040d7167d616db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*RQCXM2jHTPIiq2961Wkv7w.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="995b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然我们在平衡训练数据上看到类似的性能，但在SMOTE数据上训练的随机森林模型在样本外测试数据上表现更好。我想这意味着我的假设可能是正确的！</p><p id="983a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，使用多个度量来评估模型性能总是好的。让我们用测试集来看看这两个模型的标准化混淆矩阵。</p><p id="3983" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">标准化的混淆矩阵是评估以下比例的好方法:</p><ul class=""><li id="47ac" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la ne mk ml mm bi translated"><strong class="kf ir">真阳性:</strong>实际目标为阳性且模型预测为阳性的情况。</li><li id="f6d7" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ne mk ml mm bi translated"><strong class="kf ir">真否定:</strong>实际目标为否定，模型预测为否定的情况。</li><li id="ed50" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ne mk ml mm bi translated"><strong class="kf ir">假阳性:</strong>实际目标为阴性，模型预测为阳性的情况。</li><li id="2b58" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ne mk ml mm bi translated"><strong class="kf ir">假阴性:</strong>实际目标为阳性而模型预测为阴性的情况。</li></ul><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/1ffc65f2713341dbc5ef43c9cc07d2e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJIWIyv0A09_uNy8zZNfWw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="4816" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有意思！相对于SMOTE模型，重采样模型</p><ol class=""><li id="0fad" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la mj mk ml mm bi translated">不善于识别负面事例(应该有大约92%的负面事例)…</li><li id="4e5f" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated"><em class="ms">是否比</em>更善于识别正面事例(应该有大约9%的正面事例)…</li><li id="42b9" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">具有更少的假阴性(0.75%比0.81%，尽管从绝对值来看，这种差异可能可以忽略不计)…</li><li id="1e90" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">误报率更高(3.45%比2.69%)…</li><li id="e593" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">准确率较低(95.8%对96.5%)。</li></ol><p id="fab0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，值得思考的是，看起来模型性能有点微妙。</p><p id="de7d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就足够了，让我们总结一下。</p><h1 id="2275" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结束语</h1><p id="ea73" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">…此外还夹杂着一些漫无边际的话。</p><p id="f47c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经做了很多了！大家讨论一下。</p><ol class=""><li id="5fef" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la mj mk ml mm bi translated">直方图和配对图使我们能够<strong class="kf ir">可视化特征的分布以及它们之间的关系</strong>。我非常喜欢用这种方式绘制信息图表，因为我发现直观地发现关系比通过描述性统计更容易。</li><li id="f3d6" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">我们已经<strong class="kf ir">处理了丢失的值，尽管相当粗糙</strong>。删除有缺失值的观察值实际上意味着我们正在丢失建模数据中的信息。对此有更好的方法，一个<strong class="kf ir">未来的改进可能是估算任何丢失的信息</strong>。</li><li id="ddd4" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">我们已经<strong class="kf ir">平衡并检查了两种不同平衡技术产生的数据，注意到特性的分布和类之间的分离被保留。</strong>我们没有探索上采样的其他方法——未来的改进可能是探索ADASYN等技术。</li><li id="ad8d" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">我们在两个平衡的训练集上建立了一个随机森林模型。我随机选择了这个模型，其他模型可能比我们的随机森林要好。在更广泛的建模实践中，可以使用交叉验证方法选择<strong class="kf ir">表现最佳的模型。<strong class="kf ir"> </strong>我们当然需要考虑其他模型在数据缩放和转换方面的要求。</strong></li><li id="8638" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">继续随机森林的主题…没有<strong class="kf ir">保证用于训练模型的超参数接近最优</strong>，我们没有执行任何超参数优化。我们对参数的选择很可能会影响我们比较的结果；让我们将这一点添加到我们的改进列表中。</li><li id="bd3b" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">我们看到，仅基于F1度量，基于SMOTE数据训练的模型优于基于随机采样数据训练的模型。然而，对混淆矩阵的检查表明，模型性能有一点细微的差别。这也是为什么<strong class="kf ir">我们应该使用多个模型性能指标来评估模型的另一个例子。</strong></li><li id="18e3" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">虽然我会说SMOTE模型优于随机样本模型，但我不能说这是一个全垒打性能。<strong class="kf ir">通常不正确的分类会带来某种代价</strong>——在这种情况下，可能是花费时间调查我们认为是脉冲星的候选星，却发现它实际上不是(假阳性的一个例子)。考虑到不正确预测的相关成本，或许可以让我们找到决定性的更好的抽样技术。</li><li id="df27" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">我们使用一个简单的训练测试数据分割来执行这个比较。通过<strong class="kf ir">将工作流程实现为流水线并通过交叉验证运行</strong>，可以实现更可靠的评估。这将最大限度地利用我们的数据，并提高我们的样本外性能估计的可靠性。</li></ol></div></div>    
</body>
</html>