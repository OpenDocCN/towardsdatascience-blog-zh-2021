<html>
<head>
<title>7 Ways to Make Your Python Project Structure More Elegant</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让您的Python项目结构更优雅的7种方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-project-structure-best-practices-d9d0b174ad5d?source=collection_archive---------23-----------------------#2021-10-04">https://towardsdatascience.com/python-project-structure-best-practices-d9d0b174ad5d?source=collection_archive---------23-----------------------#2021-10-04</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="6821" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">以下是易于管理、可伸缩且易于理解的python项目结构的最佳实践</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/40a669c8d22211c66d331bbe4dd6a5bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pN0b6t4LR3OVBDyy.jpg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">完美Python项目结构的蓝图。——照片由来自<a class="ae kz" href="https://www.pexels.com/photo/silver-imac-displaying-collage-photos-1779487/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kz" href="https://www.pexels.com/@designecologist?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">设计生态学家</a>拍摄</p></figure><p id="a495" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">伟大的项目从一个单一的文件脚本开始，并演变成一个社区维护的框架。但是很少有项目能达到这个水平。大多数，不管它们对其他人是否有用，最终都不会被任何人使用。</p><blockquote class="lw"><p id="aa8b" class="lx ly iu bd lz ma mb mc md me mf lv dk translated"><em class="mg">让你的项目对其他人来说方便(或者痛苦)的关键因素是它的结构。</em></p></blockquote><p id="050b" class="pw-post-body-paragraph la lb iu lc b ld mh jv lf lg mi jy li lj mj ll lm ln mk lp lq lr ml lt lu lv in bi translated">什么是运行良好的完美Python项目结构？</p><ul class=""><li id="ac08" class="mm mn iu lc b ld le lg lh lj mo ln mp lr mq lv mr ms mt mu bi translated">伟大的项目总是<a class="ae kz" href="#5269" rel="noopener ugc nofollow"><strong class="lc iv"/></a><strong class="lc iv">。</strong>使用git(或mercurial。)</li><li id="b0fd" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">他们应该有一个<a class="ae kz" href="#a8be" rel="noopener ugc nofollow"> <strong class="lc iv">依赖管理</strong> </a>系统。Virtualenv(或康达)不是一个。</li><li id="ae29" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">他们有自动化的<a class="ae kz" href="#d781" rel="noopener ugc nofollow"> <strong class="lc iv">干净的代码实践</strong> </a>。让丑陋的编码对你的团队成员来说是不可能的。</li><li id="494f" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">伟大的项目总会有一个<a class="ae kz" href="#3507" rel="noopener ugc nofollow"> <strong class="lc iv">自述</strong> </a>并给出更多的脉络。</li><li id="b12b" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">应该有一个<a class="ae kz" href="#82ea" rel="noopener ugc nofollow"> <strong class="lc iv">配置文件</strong> </a>(一个YAML或者一个TOML文件)。将软件参数与硬编码分开。</li><li id="c753" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">秘密应该在一个<a class="ae kz" href="#b87b" rel="noopener ugc nofollow">T29】的环境里(。env)文件。你不想让世界知道你的秘密。</a></li><li id="2ddf" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">他们应该有整洁的<a class="ae kz" href="#66ff" rel="noopener ugc nofollow"> <strong class="lc iv">文档</strong> </a>(可选。)</li></ul><p id="12d9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本文将介绍所有这些，并设置您的python项目以获得最大的可维护性。如果这看起来很难，你可以直接使用我为你创建的<a class="ae kz" href="#cc7b" rel="noopener ugc nofollow"> <strong class="lc iv"> <em class="na">蓝图</em> </strong> </a>。</p><h1 id="5269" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">让每个项目都成为git仓库。</h1><p id="f96f" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">您可以通过一行命令将项目变成git存储库。做这个不会花一分钟。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="7211" class="od nc iu nz b gz oe of l og oh">git init</span></pre><p id="8237" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是我们不常这样做。在大多数情况下，我们倾向于认为我们为一个简单的问题写了一个简单的脚本。没关系。</p><p id="864b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">对你来说简单的对别人来说就复杂了。地球另一端的某人正在解决一个问题，您的简单脚本就是解决方案。</p><p id="8157" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">此外，你的简单问题可能会吸收其他简单问题，并变得可怕。</p><p id="8573" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着它的增长，维护您的代码变得越来越困难。你不知道你做了什么改变，为什么要做这些改变。如果你是一个团队，那么接下来的问题是谁和什么时候做了这些改变。</p><p id="e2a3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">突然，你开始担心你最初写的剧本，而不是为它感到自豪。</p><blockquote class="lw"><p id="e793" class="lx ly iu bd lz ma mb mc md me mf lv dk translated">开始每一行代码，就好像它是下一个脸书的开始。你需要一个版本控制系统来做这件事。</p></blockquote><p id="d846" class="pw-post-body-paragraph la lb iu lc b ld mh jv lf lg mi jy li lj mj ll lm ln mk lp lq lr ml lt lu lv in bi translated">作为第一步，让您的项目成为一个git存储库，并包含一个. gitignore文件。你可以使用在线工具<a class="ae kz" href="https://www.toptal.com/developers/gitignore" rel="noopener ugc nofollow" target="_blank"> gitignore.io </a>生成一个忽略文件。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="6b7e" class="od nc iu nz b gz oe of l og oh">.<br/>├── .git<br/>│   ├── &lt;Git managed files&gt;<br/>│  <br/>├── .gitignore</span></pre><p id="3b30" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着您的进展，请确保使用说明性消息提交您的更改。提交是不同时间的检查点。它们确实是你的软件的版本，你可以在任何时候检验。</p><h2 id="cadb" class="od nc iu bd nd oi oj dn nh ok ol dp nl lj om on nn ln oo op np lr oq or nr os bi translated">如何写好提交消息？</h2><p id="6973" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">一个好的提交消息应该完成句子，“如果应用，这个提交将……”它们应该是句子的大小写，但是没有尾随的句号。提交消息的最佳长度约为50个字符。</p><p id="d032" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以下是使用git CLI的提交消息示例。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="bd19" class="od nc iu nz b gz oe of l og oh">git commit -am 'Print a hello world message'</span></pre><p id="185e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你也可以创建更多的细节。您可以在没有提交消息的情况下运行<code class="fe ot ou ov nz b">git commit</code>。</p><p id="fd78" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">此操作将打开一个编辑器，您可以在其中添加多行提交消息。然而，使用上述约定来创建提交消息的标题。您可以使用空行来分隔邮件的标题和正文。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="65b3" class="od nc iu nz b gz oe of l og oh">Print a hello &lt;user&gt; message<br/><br/>Print a hello world message and a hello &lt;user&gt; message<br/><br/>The main function was hardcoded with 'hello world' message.<br/>But we need a dynamic message that takes the an argument and greet.<br/><br/>Amend the main function to take an argument and string formating to<br/>print hello &lt;user&gt; message</span></pre><p id="1ac8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这些<a class="ae kz" href="https://chris.beams.io/posts/git-commit/" rel="noopener ugc nofollow" target="_blank">提交消息约定</a>将使浏览git日志中您所做的所有更改变得容易。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ow"><img src="../Images/c2525b9f13cbfcbc6fc1dc706adf79b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tC2X3w1c5aDEskGkf-0qtQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">用干净的提交消息清理git历史——来自<a class="ae kz" href="https://www.the-analytics.club" rel="noopener ugc nofollow" target="_blank">作者的博客</a></p></figure><h1 id="a8be" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">使用依赖管理工具。</h1><p id="b22b" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">大多数开发人员，尤其是新开发人员，没有对项目依赖给予足够的重视。首先什么是依赖管理？</p><p id="a13c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您开发的软件可能依赖于其他开发人员创建的包。反过来，它们可能依赖于几个不同的包。这种模块化的方法有助于快速创建软件产品，而不需要一直重新发明轮子。</p><p id="d52a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">即使在同一个项目中，依赖关系在不同的环境中也会有所不同。您的开发团队可能有一组不属于生产系统的依赖项。</p><p id="02f8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一个健全的依赖关系管理系统应该能够区分这些集合。</p><p id="04c4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Python开发人员使用虚拟(或conda)环境来安装项目依赖项。但是Virtualenv不是一个依赖管理工具。它没有上面讨论的好处。这只会有助于将项目环境与您的系统隔离开来。</p><p id="101e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">对于Python项目来说，诗歌是一个完美的依赖管理工具。它允许你，</p><ul class=""><li id="01f0" class="mm mn iu lc b ld le lg lh lj mo ln mp lr mq lv mr ms mt mu bi translated">分离开发和生产依赖关系；</li><li id="bb2f" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">分别为每个项目设置Python版本；</li><li id="3805" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">创建软件的入口点；</li><li id="5682" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">帮助您将其打包并发布到诸如PyPI之类的存储库中。</li></ul><p id="c4c8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">诗歌不是虚拟的替代品。它使用方便的实用程序命令创建和管理虚拟env。</p><p id="99ea" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你喜欢这个想法，我发表了一篇关于如何使用诗歌有效管理项目依赖的完整教程。</p><h1 id="d781" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">在您的Python项目中自动化干净的代码实践。</h1><p id="1955" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">Python是最简单的编程语言。它接近自然语言，但在应用上却很强大。</p><p id="29c3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但这并不意味着你的代码总是可读的。您可能最终会写出太长的代码，并且其风格对于其他人来说太难理解了。为了解决这个问题，Python引入了一个叫做<a class="ae kz" href="https://www.python.org/dev/peps/pep-0008/" rel="noopener ugc nofollow" target="_blank"> PEP 8 </a>的通用标准。</p><p id="ae25" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">PEP 8是python程序员简洁一致地编码的一套指南。它讲述了，</p><ul class=""><li id="2879" class="mm mn iu lc b ld le lg lh lj mo ln mp lr mq lv mr ms mt mu bi translated">Python类、函数和变量的命名约定；</li><li id="e05b" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">正确使用空白；</li><li id="d357" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">代码布局，如最佳线路长度，以及；</li><li id="63c7" class="mm mn iu lc b ld mv lg mw lj mx ln my lr mz lv mr ms mt mu bi translated">关于评论的约定；</li></ul><p id="aa99" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">尽管这一准则为Python程序员解决了一个大问题，但在大型项目中手动维护这一点很有挑战性。</p><p id="2429" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">幸运的是，像<a class="ae kz" href="https://black.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> black </a>和<a class="ae kz" href="https://github.com/peter-evans/autopep8" rel="noopener ugc nofollow" target="_blank"> autopep8 </a>这样的软件包可以很容易地通过一行命令来完成。这一行格式化了blueprint文件夹中的每个文件。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="6b72" class="od nc iu nz b gz oe of l og oh">black blueprint</span></pre><p id="fcd1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Autoflake 是另一个帮助你去除脚本中无用变量的工具。我们声明但不使用的变量给阅读代码带来了不便。下面一行很神奇。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="d28b" class="od nc iu nz b gz oe of l og oh">autoflake --in-place --remove-unused-variables blueprint/main.py</span></pre><p id="3376" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，我想提一下<a class="ae kz" href="https://github.com/PyCQA/isort" rel="noopener ugc nofollow" target="_blank"> isort </a>，这是一个优化导入的Python包。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="782b" class="od nc iu nz b gz oe of l og oh">isort blueprint/main.py</span></pre><p id="6d42" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所有这些包在一行中清理你的代码。但是，即使这样，每次修改脚本时运行它也比我们想象的更有挑战性。</p><p id="0b3c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这就是为什么我更喜欢Git预提交钩子。</p><p id="c941" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用预提交挂钩，您可以配置为在每次提交更改时运行black、autoflake和isort来格式化您的代码库。</p><p id="cf55" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如何配置预提交钩子自动格式化Python代码？</p><p id="dd50" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用poems add或pip安装预提交包。您的项目根目录中应该有一个<code class="fe ot ou ov nz b">.pre-commit-config.yaml</code>文件。您可以配置在每次提交之前运行哪些钩子。然后，您必须将预提交安装到git存储库中。可以通过从项目根目录运行预提交安装命令来实现。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="83ca" class="od nc iu nz b gz oe of l og oh">poetry add pre-commit<br/># Create the .pre-commit-config.yaml file<br/>poetry run pre-commit install</span></pre><p id="e87e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面是您的<code class="fe ot ou ov nz b">.pre-commit-config.yaml</code>文件应该是什么样子。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="b259" class="od nc iu nz b gz oe of l og oh">repos:<br/>  - repo: local<br/>    hooks:<br/>      - id: autoflake<br/>        name: Remove unused variables and imports<br/>        entry: bash -c 'autoflake "$@"; git add -u' --<br/>        language: python<br/>        args:<br/>          [<br/>            "--in-place",<br/>            "--remove-all-unused-imports",<br/>            "--remove-unused-variables",<br/>            "--expand-star-imports",<br/>            "--ignore-init-module-imports",<br/>          ]<br/>        files: \.py$<br/>      - id: isort<br/>        name: Sorting import statements<br/>        entry: bash -c 'isort "$@"; git add -u' --<br/>        language: python<br/>        args: ["--filter-files"]<br/>        files: \.py$<br/>      - id: black<br/>        name: Black Python code formatting<br/>        entry: bash -c 'black "$@"; git add -u' --<br/>        language: python<br/>        types: [python]<br/>        args: ["--line-length=120"]</span></pre><p id="dd56" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">就是这样。现在试着对你的代码做一些修改并提交它。你会惊奇地发现它是如何自动纠正你的编码风格问题的。</p><h1 id="82ea" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">使用配置文件来分隔项目参数。</h1><p id="7ea0" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">配置文件就像应用程序的中央控制面板。您的代码的新用户只需更改配置文件就可以运行它。</p><p id="e781" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">配置文件中包含什么？</p><p id="cfcd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们知道硬编码静态变量是一种不好的做法。例如，如果你需要设置一个服务器URL，你不应该直接把它放在代码中。相反，最合适的方法是将它放在一个单独的文件中并从中读取。如果你或者其他人想改变它，他们只需要做一次，他们知道在哪里做。</p><p id="c4c6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在早期，我们习惯于从文本文件中读取配置。我甚至还用过JSONs和CSV。但是我们有更先进的替代方法来管理配置。</p><p id="726c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一个完美的配置文件应该易于理解并允许注释。我发现TOML文件对这件事来说是不可思议的。poems已经创建了一个TOML文件来管理它的配置。因此，我不必创建一个新的。</p><p id="2b64" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以用<code class="fe ot ou ov nz b">toml</code> python包读取一个TOML文件。只需要一行命令就可以将配置文件转换成字典。</p><p id="0fdf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面是如何读取一个TOML配置文件。</p><ol class=""><li id="3ab5" class="mm mn iu lc b ld le lg lh lj mo ln mp lr mq lv ox ms mt mu bi translated">安装<code class="fe ot ou ov nz b">toml</code>包。如果你使用诗歌来管理依赖关系，你可以使用<code class="fe ot ou ov nz b">add</code>命令来安装它。如果不是平原老<code class="fe ot ou ov nz b">pip</code>作品。</li></ol><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="4bc1" class="od nc iu nz b gz oe of l og oh">poetry add toml<br/># If you're still using pip and virtualenv,<br/># pip install toml</span></pre><p id="6ffb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.创建(或编辑，如果已经存在的话)一个TOML文件。你可以用任何名字。如果你使用诗歌，它会创建一个叫做<code class="fe ot ou ov nz b">pyproject.toml</code>的。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="94b7" class="od nc iu nz b gz oe of l og oh">[app]<br/>name='blueprint'</span></pre><p id="c38e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.将其加载到您的python项目中。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="a08d" class="od nc iu nz b gz oe of l og oh">import toml<br/>app_config = toml.load('pyproject.toml')</span><span id="6c5a" class="od nc iu nz b gz oy of l og oh"># now you can access the configuration parameters<br/>print(app_config)</span><span id="c48d" class="od nc iu nz b gz oy of l og oh"># {'app': {'name': 'blueprint'}}</span></pre><h1 id="b87b" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">将机密存储在环境文件中</h1><p id="93bb" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">一组机密项目不应该放在您的代码库中。常见的做法是将它们放在一个. env文件中，并在运行时读取它们。您也不需要将. env文件提交到代码库中。</p><p id="a515" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用这个文件来存储API密钥和数据库凭证等信息。</p><p id="0f37" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您没有将它提交到您的存储库，那么使用您的配置文件来存储机密是非常好的。此外，您还可以使用。如果没有太多复杂的配置，可以将env文件作为项目配置文件。</p><p id="895d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">环境文件和配置文件之间的一个关键区别是如何读取它们的值。您可以使用Python内置的<code class="fe ot ou ov nz b">os</code>模块在项目的任何地方访问环境变量。但是配置文件值并不是对项目的每个模块都可见的。你必须要么读取每个模块上的文件，要么只读取一次，然后将它和函数参数一起传递。</p><p id="2a42" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是我强烈建议使用两个独立的文件，因为它们有不同的用途。配置文件可以方便地配置您的项目，不需要任何硬编码。env文件存储机密。</p><p id="0c5c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用。gitignore来阻止您的env文件意外地潜入您的存储库。这是你在第0天应该做的事情之一。</p><p id="6b03" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">下面是如何用Python创建和读取环境文件。</strong></p><ol class=""><li id="dc40" class="mm mn iu lc b ld le lg lh lj mo ln mp lr mq lv ox ms mt mu bi translated">在项目根目录下创建一个. env文件</li></ol><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="fcb0" class="od nc iu nz b gz oe of l og oh">SECRET_KEY='R9p9BRDshkwzpsooPEmZS86OWjWxQvn7aPunVexFoDw'</span></pre><p id="0655" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.安装python-dotenv。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="2564" class="od nc iu nz b gz oe of l og oh">poetry add python-dotenv<br/># pip install python-dotenv</span></pre><p id="f074" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.将env文件加载到项目中。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="1b5e" class="od nc iu nz b gz oe of l og oh">from dotenv import load_dotenv</span><span id="2d3f" class="od nc iu nz b gz oy of l og oh">load_dotenv()<br/># If your env file is different from .env you can specify that too,<br/># load_dotenv('.secrets/.environ')</span></pre><p id="69bd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">4.从项目中的任何位置访问环境变量。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="28a8" class="od nc iu nz b gz oe of l og oh">import os</span><span id="b3dc" class="od nc iu nz b gz oy of l og oh">print(os.getenv('SECRET_KEY'))<br/># R9p9BRDshkwzpsooPEmZS86OWjWxQvn7aPunVexFoDw</span></pre><p id="4bb4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">环境文件是一个古老的约定。因此，大多数技术都预先支持它们。此外，您可以直接在操作系统上设置环境变量。</p><h1 id="3507" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">使用自述文件，并给出额外的背景。</h1><p id="9fb4" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">如果你总是给阅读你的代码的人一些上下文，这将会有所帮助。它是关于什么的，你为什么要写它？</p><p id="8143" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">自述文件是项目的简短文档。它应该包括让另一个人在没有你的帮助下在他们的系统上设置你的项目的说明。</p><p id="5804" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">自述文件通常是降价文件。GitHub、Bit Bucket和GitLab正在使用它在项目存储库上呈现样式化的文档。</p><p id="50a0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Markdown添加了一些约定，使普通文本显得特别。例如，你可以在一行前面加一个<code class="fe ot ou ov nz b">#</code>标记作为标题，加一个<code class="fe ot ou ov nz b">##</code>标记作为副标题。这里有一个备忘单，可以了解更多关于减价的信息。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oz"><img src="../Images/4a4eb973ae74766954707eea0389fb65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MSSdOTNeQBHQ0xqG.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">记下备忘单，写出更好的自述文件——来自<a class="ae kz" href="https://www.the-analytics.club/" rel="noopener ugc nofollow" target="_blank">作者的博客。</a></p></figure><h1 id="66ff" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">用附带文档帮助读者(可选。)</h1><p id="bbea" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">你不必有一个多页的web应用程序来记录每个项目。但是有一个是个好主意。因此，我将它设为可选。</p><p id="c8dd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">自述文件用于保存应用程序的基本信息。文档有助于给出项目的具体细节。</p><p id="3826" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">例如，您可以在自述文件中讨论软件包的安装和配置。但是不推荐谈论应用程序中的101 API端点。您可能需要在HTML文档中更好地组织它，并单独存放它。</p><p id="64a1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Python有几个创建HTML文档的优秀工具。Mkdocs(和它的材料主题)斯芬克斯和Swagger是最受欢迎的选择。你如何选择合适的文档工具？</p><p id="4083" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您的应用程序涉及许多API端点，Swagger是生成文档的最佳方式。如果没有，Mkdocs工作良好。使用Mkdocs，您可以创建自定义页面。您也可以使用<code class="fe ot ou ov nz b">mkdocstring</code>扩展名来转换您的文档字符串。但是在我看来，你很少需要为你的代码创建文档。你的代码本身就是一个文档！</p><p id="a4b0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">下面是如何在Python项目中使用Mkdocs</strong></p><p id="c14b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">1.您可以将mkdocs安装为一个开发依赖项。在生产系统中你不需要它。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="b4ec" class="od nc iu nz b gz oe of l og oh">poetry add -D mkdocs-material</span></pre><p id="caab" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.编辑index.md文件(这也是一个降价文件。)</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="eedf" class="od nc iu nz b gz oe of l og oh">mkdocs new docs<br/>cd docs</span></pre><p id="38f3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.启动mkdocs服务器，在浏览器上查看它。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="d7a9" class="od nc iu nz b gz oe of l og oh">mkdos serve</span></pre><h1 id="1ca4" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">你知道你可以用GitHub页面免费托管你的文档吗？</h1><p id="0e25" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">如果您有GitHub帐户，您也可以托管您的文档，并将您的主分支推送到GitHub存储库。它需要一个(并且只有一个)命令和几秒钟。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="4bde" class="od nc iu nz b gz oe of l og oh">mkdocs gh-deploy</span></pre><p id="71b9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">上述命令将构建文档的静态版本，并将其托管在GitHub页面上。托管的URL通常类似于</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="a818" class="od nc iu nz b gz oe of l og oh">https://&lt;Your username&gt;.github.io/&lt;Your repository name/</span></pre><p id="c993" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你也可以让它在你的主站点的自定义域或子域上运行。这里有一个来自GitHub的自定义域名的<a class="ae kz" href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site" rel="noopener ugc nofollow" target="_blank">指南。</a></p><p id="020a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以在这里看到项目蓝图的托管文档<a class="ae kz" href="https://thuwarakeshm.github.io/blueprint/" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="cc7b" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">如何使用Python项目蓝图？</h1><p id="46cf" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">我创建了几个GitHub库，您可以将它们作为Python项目的起点。第一个是一般Python项目的蓝图，另一个是专门针对Django应用程序的。</p><p id="445d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://github.com/thuwarakeshm/blueprint" rel="noopener ugc nofollow" target="_blank"> Python项目蓝图</a></p><p id="6605" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://github.com/The-Analytics-Club/django-blueprint" rel="noopener ugc nofollow" target="_blank"> Django项目蓝图</a></p><p id="3c72" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以克隆存储库并开始工作。每当你认为你应该把它放在远程GitHub(或者Bitbucket，Gitlab)上的时候，你可以创建一个远程存储库，并把它和你的本地存储库连接起来。下面是怎么做的。</p><pre class="kk kl km kn gu ny nz oa ob aw oc bi"><span id="c1be" class="od nc iu nz b gz oe of l og oh">git clone git@github.com:thuwarakeshm/blueprint.git git remote set-url &lt;Your New Repository&gt;</span></pre><p id="39a2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是有更好的方法。</p><p id="b110" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">转到我上面给出的GitHub链接，你会在右上角看到一个按钮，上面写着“fork”分叉允许您创建您可以拥有的存储库的副本。您可以在完全不影响原始源的情况下进行更改。</p><p id="319f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因此，一定要派生存储库并将新的存储库克隆到您的本地计算机上。</p><p id="a323" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这些存储库是用我上面讨论的所有最佳实践构建的。但是你可以随意把它变成你的。你可以改变任何你想改变的东西和你想改变的方式。</p><h1 id="630f" class="nb nc iu bd nd ne nf ng nh ni nj nk nl ka nm kb nn kd no ke np kg nq kh nr ns bi translated">最后的想法，</h1><p id="6e61" class="pw-post-body-paragraph la lb iu lc b ld nt jv lf lg nu jy li lj nv ll lm ln nw lp lq lr nx lt lu lv in bi translated">Python是一种优雅的语言。但是我们需要更多的训练来完成优秀的项目。如果我们把大部分都自动化了呢？</p><p id="06fd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">那是我们刚刚讨论完的。</p><p id="910b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们讨论了拥有一个git存储库对于所有项目的重要性和原因。然后我们讨论了用诗歌管理依赖性。我们还学习了如何使用自述文件、创建文档、管理配置和环境文件。</p><p id="76b7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">上面提到的每一个练习本身都值得一个30天的课程。但是我相信这篇文章已经给出了关于这些技术以及我们为什么使用它们的想法。</p><p id="b2ae" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一旦您意识到这些实践的好处，您就会想要创建支持它们的项目。我已经为你描绘了一幅蓝图，让你不必从头开始。</p><p id="0180" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个指南是基于我的理解和经验。如果你有什么要补充或改正的，我很乐意和你讨论。</p></div><div class="ab cl pa pb hy pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="in io ip iq ir"><blockquote class="ph pi pj"><p id="8bdb" class="la lb na lc b ld le jv lf lg lh jy li pk lk ll lm pl lo lp lq pm ls lt lu lv in bi translated">感谢阅读，在<a class="ae kz" href="https://www.linkedin.com/in/thuwarakesh/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv"> <em class="iu"> LinkedIn </em> </strong> </a>，<a class="ae kz" href="https://twitter.com/Thuwarakesh" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv"><em class="iu">Twitter</em></strong></a>，<a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener"><strong class="lc iv"><em class="iu">Medium</em></strong></a>。</p><p id="9fab" class="la lb na lc b ld le jv lf lg lh jy li pk lk ll lm pl lo lp lq pm ls lt lu lv in bi translated">还不是中等会员？请使用此链接<a class="ae kz" href="https://thuwarakesh.medium.com/membership" rel="noopener"> <strong class="lc iv">成为</strong> </a>的会员，因为，不需要你额外付费，我为你引荐赚取一小笔佣金。</p></blockquote></div></div>    
</body>
</html>