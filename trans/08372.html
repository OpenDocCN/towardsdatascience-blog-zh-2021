<html>
<head>
<title>Performing Computer Vision &amp; NLP Tasks in a Single Of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用一段代码执行计算机视觉和自然语言处理任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/performing-computer-vision-nlp-tasks-in-a-single-of-code-f7205f212d34?source=collection_archive---------35-----------------------#2021-08-01">https://towardsdatascience.com/performing-computer-vision-nlp-tasks-in-a-single-of-code-f7205f212d34?source=collection_archive---------35-----------------------#2021-08-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5579" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用PaddleHub加载图像和文本相关数据的预训练深度学习模型</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4f78313e9203698fb620429763b5abd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dM3uYOIn73a912Zi"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@possessedphotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">附身摄影</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="48e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">随着深度学习建模的出现，执行NLP和深度学习任务变得相对容易。有多个Python库可用于执行计算机视觉任务，如图像分割、图像检测等，NLP相关问题也是如此。</p><p id="0def" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从头开始创建模型可能会花费大量时间和精力，因为我们需要预处理数据并相应地训练模型，并且使用文本数据或图像数据训练模型通常会消耗大量时间。我们可以使用预先训练好的模型进行图像处理，如VGG16、ImageNet等，而不是从头开始创建模型。</p><p id="4d14" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用预训练的模型需要一定的编程经验，尤其是在深度学习领域，因为我们需要创建自己的层或编写代码来使用预训练的模型层。如果我们可以直接使用这些预先训练好的模型进行预测，那不是很好吗？因此，即使是非程序员也可以使用这些模型并生成预测。</p><p id="b48e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">PaddleHub是一个开源的Python库，在使用预先训练好的模型时，它具有多种功能。它提供了预训练模型的直接使用，这些模型不仅仅限于图像或文本，还可用于音频、视频和工业应用。它包含大约300多个预先训练好的模型，可以很容易地免费下载。它还支持多种平台，如Linux、Windows、macOS等。</p><p id="7ee5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">PaddleHub包含的一些主要预训练模型有:</p><p id="439a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">a.文本识别</p><p id="a579" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">b.图像编辑和图像生成</p><p id="05ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">c.人脸检测、对象检测和关键点检测</p><p id="8c7c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">d.图像分割和图像分类</p><p id="434d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">等等。</p><p id="ad86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将使用PaddleHub预训练模型进行人脸检测、关键点检测和NLP相关操作。</p><p id="b784" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们开始吧…</p><h1 id="600b" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">安装所需的库</h1><p id="524f" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">我们将从使用pip安装PaddleHub开始。下面给出的命令可以做到这一点。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="fff6" class="mn lg it mj b gy mo mp l mq mr">!pip install --upgrade paddlepaddle<br/>!pip install --upgrade paddlehub</span></pre><h1 id="e9b7" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">导入所需的库</h1><p id="c0ec" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在这一步中，我们将导入所需的库和函数来加载预先训练好的模型，并相应地使用它们。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="8403" class="mn lg it mj b gy mo mp l mq mr">import paddlehub as hub</span></pre><h1 id="5229" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">使用预先训练的模型</h1><p id="1815" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">现在我们将开始使用不同类型的预训练模型进行预测。</p><ol class=""><li id="128a" class="ms mt it js b jt ju jx jy kb mu kf mv kj mw kn mx my mz na bi translated"><strong class="js iu">人脸检测</strong></li></ol><p id="cd81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将使用人脸检测器模型进行人脸检测。您可以使用任何图像来生成预测。你只需要改变你使用的图像的路径。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="e6e4" class="mn lg it mj b gy mo mp l mq mr">module = hub.Module(name="ultra_light_fast_generic_face_detector_1mb_640")</span><span id="5f38" class="mn lg it mj b gy nb mp l mq mr">res = module.face_detection(<br/>    paths = ["/content/IMG-20191210-WA0024.jpg"],<br/>    visualization=True,<br/>    output_dir='face_detection_output')</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/07a523da1f9924fe4e1f0b246f1fe2fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*LuhcEDt25PxAEY2lW0iKEQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">面部检测(来源:作者)</p></figure><p id="bf4d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.<strong class="js iu">关键点检测</strong></p><p id="b400" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">关键点检测可用于突出关键部分，例如，面部的关键部分是鼻子、耳朵等。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="016c" class="mn lg it mj b gy mo mp l mq mr">module = hub.Module(name="openpose_body_estimation")</span><span id="26ea" class="mn lg it mj b gy nb mp l mq mr">res = module.predict(<br/>    img="/content/IMG-20191210-WA0024.jpg",<br/>    visualization=True,<br/>    save_path='keypoint_output')</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c33ad919325a2b2681926684cd237c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*vGFxZRpiFrvJsVrgbLlz8Q.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">关键点(来源:作者)</p></figure><p id="5cee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.<strong class="js iu">词法分析</strong></p><p id="508e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">词法分析或记号赋予器用于将字符序列转换成记号序列。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="61c0" class="mn lg it mj b gy mo mp l mq mr">lac = hub.Module(name="lac")</span><span id="0515" class="mn lg it mj b gy nb mp l mq mr">test_text = ["This article is in collaboration with Piyush Ingale."]<br/>print(lac.lexical_analysis(texts = test_text))</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ne"><img src="../Images/eccf13cda637fbf6aaba720a0d996d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q15D0Qhuy3dI0VEvLSbLUA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">词汇分析(来源:作者)</p></figure><p id="5961" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 4。情绪分析</strong></p><p id="6874" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这种情况下，我们试图找出文本数据是积极的，消极的，还是中性的。</p><pre class="kp kq kr ks gt mi mj mk ml aw mm bi"><span id="73f0" class="mn lg it mj b gy mo mp l mq mr">senta = hub.Module(name="senta_bilstm")</span><span id="6c96" class="mn lg it mj b gy nb mp l mq mr">test_text = ["Everyone I met in life taught me something"]<br/>print(senta.sentiment_classify(texts = test_text))</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nf"><img src="../Images/4507b9b186d5fc441221ee382be2bd29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3CK5ZCte4Yr8GVERoAzigg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">情感分析(来源:作者)</p></figure><p id="a306" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们尝试制作上面讨论的所有这些模型，将会花费很多时间，但在这里，您看到了我们如何使用所有这些预训练的模型，并仅使用一行代码生成预测。这些是我们在这里探索的Paddlehub的一些模型。</p><p id="d528" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">继续使用不同的数据进行尝试，并使用本文中讨论的所有模型进行预测。如果您发现任何困难，请在回复部分告诉我。</p><p id="78fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文是与<a class="ng nh ep" href="https://medium.com/u/40808d551f5a?source=post_page-----f7205f212d34--------------------------------" rel="noopener" target="_blank">皮尤什·英加尔</a>合作完成的。</p><h1 id="119b" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">在你走之前</h1><p id="aa04" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated"><strong class="js iu"> <em class="ni">感谢</em> </strong> <em class="ni">的阅读！如果你想与我取得联系，请随时通过hmix13@gmail.com联系我或我的</em> <a class="ae le" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> <em class="ni"> LinkedIn个人资料</em> </strong> </a> <em class="ni">。可以查看我的</em><a class="ae le" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="js iu"><em class="ni">Github</em></strong><em class="ni"/></a><em class="ni">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae le" href="https://medium.com/@hmix13" rel="noopener"> <strong class="js iu"> <em class="ni">我的简介</em> </strong> </a> <em class="ni">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>