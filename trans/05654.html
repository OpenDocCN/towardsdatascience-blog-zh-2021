<html>
<head>
<title>Getting Started With C# DataFrame and XPlot.Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C# DataFrame和XPlot入门。Plotly</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-with-c-dataframe-and-xplot-ploty-6ea6ce0ce8e3?source=collection_archive---------4-----------------------#2021-05-20">https://towardsdatascience.com/getting-started-with-c-dataframe-and-xplot-ploty-6ea6ce0ce8e3?source=collection_archive---------4-----------------------#2021-05-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0415" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">探索用C#在Jupyter笔记本上使用数据框和绘制图表的方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5c02cdd6840bcb3aa0e5f14de38a79d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iZrkm9RnUDtvYDJH"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">艾萨克·史密斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="0572" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">原文可以在<a class="ae kv" href="https://developers.refinitiv.com/en/article-catalog/article/getting-started-with-c--dataframe-and-xplot-ploty" rel="noopener ugc nofollow" target="_blank">路孚特开发者社区</a>上找到。</p><p id="dbf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于Python编程语言来说，Pandas是一个高效且流行的数据分析工具，尤其是它的Dataframe，用于操作和显示数据。为了。NET编程语言，我们可以使用微软的<a class="ae kv" href="https://www.nuget.org/packages/Deedle/" rel="noopener ugc nofollow" target="_blank"> Deedle </a>或<a class="ae kv" href="https://www.nuget.org/packages/Microsoft.Data.Analysis/" rel="noopener ugc nofollow" target="_blank">。Data.Analysis </a>包在<a class="ae kv" href="https://www.nuget.org/" rel="noopener ugc nofollow" target="_blank"> NuGet </a>中可用，它还提供了一个DataFrame类，用于操作、转换和显示数据。</p><p id="537b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个例子主要针对<a class="ae kv" href="https://www.nuget.org/packages/Microsoft.Data.Analysis/" rel="noopener ugc nofollow" target="_blank">微软。Data.Analysis </a>包，演示Jupyter Notebook中DataFrame类的一些基本特性。</p><p id="5112" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它还使用了<a class="ae kv" href="https://fslab.org/XPlot//index.html" rel="noopener ugc nofollow" target="_blank"> XPlot。Plotly </a>包是F#数据可视化包，用于绘制数据帧中数据的图表。源代码可在<a class="ae kv" href="https://github.com/Refinitiv-API-Samples/Example.Notebook.CSharp.DataFrame" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p><h1 id="18df" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">先决条件</h1><p id="5618" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">要运行本文中的示例，请参考此<a class="ae kv" href="https://developers.refinitiv.com/en/article-catalog/article/using--net-core-in-jupyter-notebook" rel="noopener ugc nofollow" target="_blank">使用。NET Core in Jupyter Notebook </a>文章，用于设置Jupyter Notebook以支持。NET编程语言。</p><h1 id="5e20" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">安装软件包</h1><p id="23f1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://www.nuget.org/packages/Microsoft.Data.Analysis/" rel="noopener ugc nofollow" target="_blank">微软。数据分析</a>包在NuGet中可用，因此可以使用dot net-interactive<strong class="ky ir"># r</strong><a class="ae kv" href="https://github.com/dotnet/interactive/blob/main/docs/magic-commands.md" rel="noopener ugc nofollow" target="_blank">魔法命令</a>从Nuget安装该包。</p><p id="1941" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行下面的命令来安装微软。数据分析包版本0.4.0。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="2d61" class="mu lt iq mq b gy mv mw l mx my">#r "nuget:Microsoft.Data.Analysis,0.4.0"</span></pre><h1 id="b70a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">引用名称空间</h1><p id="4b76" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">本文使用了以下四个包中的类。因此，它使用<strong class="ky ir"> using </strong>语句来引用那些包。</p><ul class=""><li id="fece" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr ne nf ng nh bi translated"><strong class="ky ir"> XPlot。plotly</strong>:F #和的跨平台数据可视化包。NET编程语言</li><li id="eae5" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr ne nf ng nh bi translated"><strong class="ky ir">微软。Data.Analysis </strong>:一个易于使用的高性能数据分析和转换库</li><li id="ae92" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr ne nf ng nh bi translated"><strong class="ky ir">系统。Linq </strong>:支持使用语言集成查询的查询的类和接口</li><li id="2fbe" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr ne nf ng nh bi translated"><strong class="ky ir">Microsoft.AspNetCore.Html</strong>:操纵HTML内容的类型</li></ul><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="05f9" class="mu lt iq mq b gy mv mw l mx my">using XPlot.Plotly;<br/>using Microsoft.Data.Analysis;<br/>using System.Linq;<br/>using Microsoft.AspNetCore.Html;</span></pre><h1 id="0c47" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">将数据帧呈现为HTML表格</h1><p id="f578" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">默认情况下，DataFrame呈现为具有一行和两列(列和行)的HTML表格。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/7c7302f8298c82f417743fc262a45622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zPhGD_8SjKqefSkwkaf3Yg.png"/></div></div></figure><p id="0ba6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这可以通过注册数据帧的自定义格式化程序来覆盖。以下代码为<strong class="ky ir">数据帧</strong>和<strong class="ky ir">数据帧行</strong>注册自定义格式化程序，以在HTML表格中呈现数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/fe73df3c8b0728998f23a551751ad791.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*jZ28IpIi9cKu3In5nSKZ_w.png"/></div></figure><p id="d806" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它只显示前100行。这可以通过修改<strong class="ky ir"> take </strong>变量的值来改变。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f912" class="mu lt iq mq b gy mv mw l mx my">Formatter&lt;DataFrame&gt;.Register((df, writer) =&gt;<br/>{<br/>    var headers = new List&lt;IHtmlContent&gt;();<br/>    headers.Add(th(i("index")));<br/>    headers.AddRange(df.Columns.Select(c =&gt; (IHtmlContent) th(c.Name)));<br/>    var rows = new List&lt;List&lt;IHtmlContent&gt;&gt;();<br/>    var take = 100;<br/>    for (var i = 0; i &lt; Math.Min(take, df.Rows.Count); i++)<br/>    {<br/>        var cells = new List&lt;IHtmlContent&gt;();<br/>        cells.Add(td(i));<br/>        foreach (var obj in df.Rows[i])<br/>        {<br/>            cells.Add(td(obj));<br/>        }<br/>        rows.Add(cells);<br/>    } <br/>    var t = table(<br/>        thead(<br/>            headers),<br/>        tbody(<br/>            rows.Select(<br/>                r =&gt; tr(r))));<br/>    writer.Write(t);    <br/>    writer.Write(df.Rows.Count + " x "+df.Columns.Count);<br/>}, "text/html");<br/> <br/>Formatter&lt;DataFrameRow&gt;.Register((dataFrameRow, writer) =&gt;<br/>{<br/>    var cells = new List&lt;IHtmlContent&gt;();<br/>    cells.Add(td(i));<br/>    foreach (var obj in dataFrameRow)<br/>    {<br/>        cells.Add(td(obj));<br/>    }<br/>    var t = table(<br/>        tbody(<br/>            cells));<br/>    writer.Write(t);<br/>}, "text/html");</span></pre><h1 id="8c29" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建数据框架</h1><h1 id="e0f7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">数据帧列</h1><p id="079c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">可以通过将<strong class="ky ir"> DataFrameColumn </strong>对象的列表传递给DataFrame的构造函数来创建DataFrame。</p><p id="ac74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">public data frame(params data frame column[]列)；<br/>public data frame(IEnumerable&lt;data frame column&gt;列)；</p><p id="ac24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下代码创建了一个有200行2列的DataFrame。第一列包含日期，第二列包含随机整数。它调用<strong class="ky ir">PrimitiveDataFrameColumn</strong>构造函数来创建<strong class="ky ir"> DataFrameColumn </strong>实例。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d233" class="mu lt iq mq b gy mv mw l mx my">var start = new DateTime(2009,1,1);<br/>Random rand = new Random();<br/>var numDataPoint = 200;</span><span id="527f" class="mu lt iq mq b gy np mw l mx my">PrimitiveDataFrameColumn&lt;DateTime&gt; date = new PrimitiveDataFrameColumn&lt;DateTime&gt;("Date", <br/>    Enumerable.Range(0, numDataPoint)<br/>          .Select(offset =&gt; start.AddDays(offset))<br/>          .ToList()); <br/>PrimitiveDataFrameColumn&lt;int&gt; data = new PrimitiveDataFrameColumn&lt;int&gt;("Data",<br/>    Enumerable.Range(0, numDataPoint)<br/>                        .Select(r =&gt; rand.Next(100))<br/>                        .ToList()); <br/>var df = new DataFrame(date, data);<br/>df</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f956a3f666ddf3baef12576adad8da67.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*Oz8ZxDOh9fnRtn1vjkWmaw.png"/></div></figure><h1 id="9ae3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">CSV文件</h1><p id="8ad0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">也可以通过调用<strong class="ky ir">数据帧从CSV文件创建数据帧。LoadCsv </strong>静态方法。</p><p id="7e95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码从ohcldata.csv文件创建一个DataFrame。这个文件是从<a class="ae kv" href="http://phplot.sourceforge.net/phplotdocs/ex-ohlcbasic.html" rel="noopener ugc nofollow" target="_blank"> 5.30下载的。示例—基本OHLC(开盘价、最高价、最低价、收盘价)金融阴谋</a>网站。该文件包含每日开盘、盘高、盘低、收盘的财务数据。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="7e1c" class="mu lt iq mq b gy mv mw l mx my">var df1 = DataFrame.LoadCsv("ohlcdata.csv");<br/>df1</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/a0030af754b9b211700af424576c3094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*n4i7pGBTiPObBWtoI81HXg.png"/></div></figure><p id="f9f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，可以使用<strong class="ky ir"> Info </strong>方法生成数据帧中每一列的摘要。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="3854" class="mu lt iq mq b gy mv mw l mx my">df1.Info()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/6028ac5aa166ce8ef5e323e1da1ef33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pk4rHdNEgxqp5x40XZRoiw.png"/></div></div></figure><h1 id="918d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">访问数据框架</h1><h1 id="1dd8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">通过索引访问数据</h1><p id="b07d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">行索引和列索引可用于访问数据帧中的特定数据。索引是从零开始的编号。</p><p id="6f63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码访问第一行和第二列中的数据。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="5975" class="mu lt iq mq b gy mv mw l mx my">df[0,1]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/136fb213d915db57bb78d5b365f49c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*Llq_AHmtx1L4fq1WfY1VNw.png"/></div></figure><p id="00d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，可以给数据帧分配一个新值。</p><p id="633b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码将第一行和第二列的数据增加10。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="6c7a" class="mu lt iq mq b gy mv mw l mx my">df[0,1] = int.Parse(df[0,1].ToString()) + 10;<br/>df.Head(10)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/3cde3a8ed0ddac4493d06f78b20d95d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*767bw4uNMmmPxbc4NK1FAA.png"/></div></figure><h1 id="7648" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">访问行数据</h1><p id="8275" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">可以使用行索引来访问整行。索引是从零开始的编号。</p><p id="d3fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码访问数据帧中的第十行。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="e1f0" class="mu lt iq mq b gy mv mw l mx my">df1.Rows[9]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/fc1dc9bedd4d4bc18812bab938168157.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*i4YTVeNUhwyes05K8bPQLg.png"/></div></figure><p id="3e6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">列索引也可用于访问行中的特定列。</p><p id="cacd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码访问第十行的第四列。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="fdc9" class="mu lt iq mq b gy mv mw l mx my">df1.Rows[9][5]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/44c470f902215f1ba72e1e6156a24427.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*Pq4aXg6vOdjde5Hh_UgR_g.png"/></div></figure><p id="cc76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，新值也可以分配给该列。</p><p id="50ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码将50000000分配给第六列。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="46c7" class="mu lt iq mq b gy mv mw l mx my">df1.Rows[9][5] = 50000000f;<br/>df1.Head(10)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/b45eb1217be2f849e11520b1814bd28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*KAeZueoBfMbabKQdDbryWg.png"/></div></figure><h1 id="6dfe" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">访问列数据</h1><p id="a39b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">可以使用列名或索引来访问整列。索引是从零开始的编号。</p><p id="b956" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码访问DataFrame中名为<strong class="ky ir"> Data </strong>的列(第二列)。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="8fa6" class="mu lt iq mq b gy mv mw l mx my">//df.Columns["Data"] or df.Columns[1]<br/>df.Columns["Data"]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/46ab695f237a8123a67c5f7437ada1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*ZXpyOxb7q4pMEtxwkGqfmg.png"/></div></figure><p id="f4b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以使用DataFrame的重载运算符来更改列中的数据。</p><p id="4e69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码将该列中的所有数据增加10。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="3101" class="mu lt iq mq b gy mv mw l mx my">df.Columns["Data"]= df.Columns["Data"]+10;<br/>df</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f12ccd2bebbeabda69a66275836f3c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*HndGKBTT6srtEJNaCfSvZw.png"/></div></figure><h1 id="e9de" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">插入数据</h1><h1 id="83b4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">添加新列</h1><p id="f6b3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">数据帧在<strong class="ky ir">数据帧列集合</strong>中维护一个<strong class="ky ir">数据帧列</strong>的列表。可以向DataFrameColumnCollection中添加新列。</p><p id="26fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码向DataFrame添加了一个新的整数列。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="a937" class="mu lt iq mq b gy mv mw l mx my">df.Columns.Add(new PrimitiveDataFrameColumn&lt;int&gt;("Data1", df.Rows.Count()));<br/>df</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/7a0efedfc1527a39c99b03841cd5edcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*bMGYazpsY1GkTFUO09haYQ.png"/></div></figure><p id="b81a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">新列中的数据被设置为空。</p><p id="f69f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码用10填充新列(Data1)中的空值。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="b78c" class="mu lt iq mq b gy mv mw l mx my">df.Columns["Data1"].FillNulls(10, true);<br/>df</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/5b8135bc1503de44f773232844dce7b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*Laslj9JnRYv1Db1yrHJ0HQ.png"/></div></figure><h1 id="07c1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">追加新行</h1><p id="21a3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir"> Append </strong>方法可用于向数据帧追加新行。</p><p id="ea6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下代码创建一个<strong class="ky ir"> KeyValuePair </strong>实例列表，然后将其添加到DataFrame中。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="4c79" class="mu lt iq mq b gy mv mw l mx my">df.Append(new List&lt;KeyValuePair&lt;string, object&gt;&gt;() { <br/>    new KeyValuePair&lt;string, object&gt;("Date", DateTime.Now),<br/>    new KeyValuePair&lt;string, object&gt;("Data", 12),<br/>    new KeyValuePair&lt;string, object&gt;("Data1", 50)<br/>}, true);<br/>df.Tail(10)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/3fddfab1e57a2a07532ce762c8929636.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*CIxkGbtdB1ntKRCbsuNVnQ.png"/></div></figure><h1 id="2684" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">操纵数据帧</h1><h1 id="fa1c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">对数据帧进行排序</h1><p id="a0a0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir"> OrderBy </strong>或<strong class="ky ir"> OrderByDescending </strong>方法可用于按指定列对数据帧进行排序。</p><p id="5af6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下代码根据名为<strong class="ky ir"> Data </strong>的列对DataFrame进行排序。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="99f4" class="mu lt iq mq b gy mv mw l mx my">df.OrderBy("Data")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/23d929c4667dc0e9d1c9fd54687ebaae.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*n5nqgQ1cyRdQUpfdz2AAPg.png"/></div></figure><h1 id="6707" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">对数据帧进行分组</h1><p id="b621" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir"> GroupBy </strong>方法可用于根据列中的唯一值对数据帧的行进行分组。</p><p id="53a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下代码按名为Data的列对DataFrame进行分组，然后计算每组中值的数量。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="1564" class="mu lt iq mq b gy mv mw l mx my">var groupByData = df.GroupBy("Data");<br/>groupByData.Count().OrderBy("Data")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/47a807ba5b1bbbe3cea2e6aca6b5d79c.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9mSOjbGnavMOKKiEdd1aew.png"/></div></figure><h1 id="57e6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">过滤数据帧</h1><p id="b6f3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir"> Filter </strong>方法可用于通过行索引或布尔值过滤数据帧。</p><p id="9403" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下代码通过返回名为<strong class="ky ir"> Data </strong>的列中的值大于50的行来过滤DataFrame。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="4aed" class="mu lt iq mq b gy mv mw l mx my">df.Filter(df.Columns["Data"].ElementwiseGreaterThan(50))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9a9d894c5462645287a418263153a3a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*XYYUz7ycpYJFHBmQhdz1vA.png"/></div></figure><h1 id="063a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">合并数据帧</h1><p id="a9f9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir"> Merge </strong>方法可用于通过数据库风格的连接合并两个数据帧。</p><p id="44dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下代码通过使用两个数据帧中包含的<strong class="ky ir">日期</strong>列来联接两个数据帧。首先，它将<strong class="ky ir"> df1 </strong>的<strong class="ky ir">日期</strong>列中的数据类型从<strong class="ky ir">字符串</strong>类型转换为<strong class="ky ir">数据时间</strong>类型。然后，它调用<strong class="ky ir">合并</strong>方法来连接数据帧。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="6e6c" class="mu lt iq mq b gy mv mw l mx my">df1.Columns["Date"] = new PrimitiveDataFrameColumn&lt;DateTime&gt;("Date", <br/>    df1.Columns["Date"]<br/>                .Cast&lt;object&gt;()<br/>                .ToList()<br/>                .Select(x =&gt; DateTime.ParseExact(x.ToString(), "yyyy-MM-dd", System.Globalization.CultureInfo.InvariantCulture))<br/>                .Cast&lt;DateTime&gt;());</span><span id="af8f" class="mu lt iq mq b gy np mw l mx my">df1.Merge&lt;DateTime&gt;(df, "Date", "Date")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/dba45bdc68954f591b134e60886b9c0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GSEbSWySM3fKIGdTWSSgQw.png"/></div></div></figure><h1 id="9fdb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用XPlot绘制图表。普罗蒂</h1><p id="6849" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://fslab.org/XPlot/" rel="noopener ugc nofollow" target="_blank"> XPlot。Ploty </a>是用于F#和的跨平台数据可视化包。NET编程语言。它基于流行的JavaScript图表库<a class="ae kv" href="https://plot.ly/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>。</p><p id="1f1c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下示例演示了如何使用XPlot。使用数据框中的数据绘制图表。</p><h1 id="f575" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">折线图</h1><p id="744a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">下面的代码从DataFrame中的<strong class="ky ir">打开</strong>列绘制了一个折线图。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="bf76" class="mu lt iq mq b gy mv mw l mx my">var chart1 = Chart.Plot(<br/>    new Graph.Scatter<br/>    {<br/>        x = df1.Columns["Date"],<br/>        y = df1.Columns["Open"],        <br/>        mode = "lines+markers"<br/>    }<br/>);<br/>var chart1_layout = new Layout.Layout{<br/>    title="Open Price",<br/>    xaxis =new Graph.Xaxis{<br/>        title = "Date"<br/>        },<br/>    yaxis =new Graph.Yaxis{<br/>    title = "Price (USD)"<br/>        }           <br/>    };<br/>chart1.WithLayout(chart1_layout);<br/>chart1</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/0f018e245294f7b0919a5997bf2be8f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-tmYsI_cNkrREguytuL4jA.png"/></div></div></figure><h1 id="3dc4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">多线折线图</h1><p id="fbe5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">以下代码在折线图中绘制了<strong class="ky ir">打开</strong>和<strong class="ky ir">关闭</strong>列。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="c77f" class="mu lt iq mq b gy mv mw l mx my">var chart2_list = new List&lt;Graph.Scatter&gt; <br/>{<br/>    new Graph.Scatter<br/>    {<br/>         x = df1.Columns["Date"],<br/>        y = df1.Columns["Open"],<br/>        name="Open",<br/>        mode = "lines"<br/>    },<br/>    new Graph.Scatter    <br/>    {       <br/>        x = df1.Columns["Date"],<br/>        y = df1.Columns["Close"],<br/>        name="Close",<br/>        mode = "lines"<br/>    }<br/>    <br/>};<br/> <br/>var chart2 = Chart.Plot(<br/>    chart2_list<br/>);<br/> <br/>var chart2_layout = new Layout.Layout{<br/>    title="Open and Close Price",<br/>    xaxis =new Graph.Xaxis{<br/>        title = "Date"<br/>        },<br/>    yaxis =new Graph.Yaxis{<br/>    title = "Price (USD)"<br/>        }           <br/>    };<br/>chart2.WithLayout(chart2_layout);<br/>chart2</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/52b37e3bad9be5b93a8606906156cbe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i9oBYhukmMtHsYctZSY_3Q.png"/></div></div></figure><h1 id="af7e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">条形图</h1><p id="a502" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">以下代码绘制了DataFrame中<strong class="ky ir">卷</strong>列的条形图。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="bf46" class="mu lt iq mq b gy mv mw l mx my">var chart3 = Chart.Plot(</span><span id="ea15" class="mu lt iq mq b gy np mw l mx my">new Graph.Bar<br/>    {<br/>        x = df1.Columns["Date"],<br/>        y = df1.Columns["Volume"],        <br/>        marker = new Graph.Marker{color = "rgb(0, 0, 109)"}<br/>    }<br/>);<br/>var chart3_layout = new Layout.Layout{<br/>    title="Volume",<br/>    xaxis =new Graph.Xaxis{<br/>        title = "Date"<br/>        },<br/>    yaxis =new Graph.Yaxis{<br/>    title = "Unit"<br/>        }           <br/>    };<br/>chart3.WithLayout(chart3_layout);<br/>chart3</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/88c8bea9910e033afb0fe7cc271e08fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nd4CFKy8MCwWalS1uEUDEg.png"/></div></div></figure><h1 id="2b07" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">蜡烛图</h1><p id="5dcf" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">下面的代码从DataFrame中的<strong class="ky ir">打开</strong>、<strong class="ky ir">高</strong>、<strong class="ky ir">低</strong>、<strong class="ky ir">关闭</strong>列绘制一个蜡烛图。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f67d" class="mu lt iq mq b gy mv mw l mx my">var chart4 = Chart.Candlestick(df1.OrderBy("Date").Rows.Select(row =&gt; new Tuple&lt;string, double, double, double, double&gt;(<br/>                 ((DateTime)row[0]).ToString("yyyy-MM-dd"),<br/>                 double.Parse(row[1].ToString()),<br/>                 double.Parse(row[2].ToString()),<br/>                 double.Parse(row[3].ToString()),<br/>                 double.Parse(row[4].ToString())<br/>                )));<br/>chart4.WithLayout(new Layout.Layout{<br/>    title="OHLC",<br/>    xaxis =new Graph.Xaxis{<br/>        title = "Date"<br/>        },<br/>    yaxis =new Graph.Yaxis{<br/>    title = "Price (USD)"<br/>        }           <br/>    });<br/>chart4</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/095853c15818f46c158ff2faa322b856.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NSXZQXCc-icW34sxR2ClEQ.png"/></div></div></figure><h1 id="ece3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="7c52" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Dotnet interactive允许精通Dotnet编程语言的开发人员和数据科学家在Jupyter Notebook上运行C#或F#应用程序。不可否认的是，Jupyter Notebook上运行的大部分应用都是使用Dataframe来操作数据，使用图表库来可视化数据。这篇文章介绍了微软的<strong class="ky ir">。数据分析</strong>和<strong class="ky ir"> XPlot。Plotly </strong>包为dotnet interactive提供DataFrame类和图表库。</p><p id="50fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文的第一部分演示了DataFrame类的基本用法，比如创建和数据操作。虽然与Pandas python库相比，DataFrame类仍然缺少一些基本的特性，例如连接和标准计算，但我希望这在未来的版本中会有所改进。本文的最后一部分展示了如何使用XPlot。Plotly软件包为数据框中的数据创建折线图、条形图和蜡烛图。因为这个库是基于流行的JavaScript图表库<a class="ae kv" href="https://plot.ly/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>的，所以输出看起来很棒。</p><h1 id="ca97" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><ol class=""><li id="08ea" class="mz na iq ky b kz mk lc ml lf ok lj ol ln om lr on nf ng nh bi translated">Phplot.sourceforge.net，荷兰国际发展署5.30。示例-基本OHLC(开盘、盘高、盘低、收盘)财务图。[在线]见:<a class="ae kv" href="http://phplot.sourceforge.net/phplotdocs/ex-ohlcbasic.html" rel="noopener ugc nofollow" target="_blank">http://phplot.sourceforge.net/phplotdocs/ex-ohlcbasic.html</a>[2021年5月6日访问]。</li><li id="618f" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr on nf ng nh bi translated">blue mountain capital . github . io . n . d . Deedle:用于. NET的探索性数据库。[在线]可在:<a class="ae kv" href="https://bluemountaincapital.github.io/Deedle/" rel="noopener ugc nofollow" target="_blank">https://bluemountaincapital.github.io/Deedle/</a>[2021年5月6日访问]。</li><li id="6aea" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr on nf ng nh bi translated">Govindarajan，p . 2019。DataFrame |简介。网络博客。【在线】。网络博客。可从以下网址获取:<a class="ae kv" href="https://devblogs.microsoft.com/dotnet/an-introduction-to-dataframe/" rel="noopener ugc nofollow" target="_blank">【https://dev blogs . Microsoft . com/dotnet/an-introduction-to-data frame/</a>【2021年5月6日获取】。</li><li id="39f0" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr on nf ng nh bi translated">新泽西州塞杰拉，2020年。dotnet/interactive:魔法命令。[在线] GitHub。可在:<a class="ae kv" href="https://github.com/dotnet/interactive/blob/main/docs/magic-commands.md" rel="noopener ugc nofollow" target="_blank">https://github . com/dot net/interactive/blob/main/docs/magic-commands . MD</a>【2021年5月6日访问】。</li><li id="65b5" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr on nf ng nh bi translated">Winnington，e，2019。Eric winning ton——c# Jupyter笔记本的提示和技巧。[在线]ewin ington . github . io .可在:【https://ewinnington.github.io/posts/jupyter-tips-csharp<a class="ae kv" href="https://ewinnington.github.io/posts/jupyter-tips-csharp" rel="noopener ugc nofollow" target="_blank"/>【2021年5月6日访问】。</li><li id="4d26" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr on nf ng nh bi translated">Fslab.org . n . d . XPlot—F #数据可视化包。[在线]可在:<a class="ae kv" href="https://fslab.org/XPlot/index.html" rel="noopener ugc nofollow" target="_blank">https://fslab.org/XPlot/index.html</a>[2021年5月6日访问]。</li><li id="0cde" class="mz na iq ky b kz ni lc nj lf nk lj nl ln nm lr on nf ng nh bi translated">Phuriphanvichai，j .，2021。使用。Jupyter笔记本中的NET Core |路孚特开发者。[在线]Developers.refinitiv.com。可从以下网址获取:<a class="ae kv" href="https://developers.refinitiv.com/en/article-catalog/article/using--net-core-in-jupyter-notebook.html" rel="noopener ugc nofollow" target="_blank">https://developers . refinitiv . com/en/article-catalog/article/using-net-core-in-jupyter-notebook.html</a>【2021年5月10日获取】。</li></ol></div></div>    
</body>
</html>