<html>
<head>
<title>How to connect DataGrip to Apache Druid</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将DataGrip连接到Apache Druid</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-connect-datagrip-to-apache-druid-1a9d502144e9?source=collection_archive---------34-----------------------#2021-10-18">https://towardsdatascience.com/how-to-connect-datagrip-to-apache-druid-1a9d502144e9?source=collection_archive---------34-----------------------#2021-10-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b716" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用传统的SQL编辑器查询Apache Druid的一种简单方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ab4f05b5676ddbe0e137c37f85f2d780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vl6VyzTmZYgtZtNj-jjlw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@sajad_sqs9966b?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">萨贾德·诺里</a>在<a class="ae kv" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><blockquote class="kw kx ky"><p id="5100" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这篇文章最初发表在<a class="ae kv" href="https://www.libramli.ai/blog" rel="noopener ugc nofollow" target="_blank">天秤座人工智能技术博客</a>上。</p></blockquote><h1 id="390d" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">需要第三方SQL客户端编辑器</h1><p id="9b07" class="pw-post-body-paragraph kz la iq lc b ld mo jr lf lg mp ju li mq mr ll lm ms mt lp lq mu mv lt lu lv ij bi translated">在过去的几个月里，我第一次在生产环境中部署了一个Apache Druid集群。这一过程的经验将有望在未来的故事中被涵盖。在这个故事中，我想分享一种创建能够连接到Druid集群并执行SQL查询的DataGrip驱动程序的方法。</p><p id="7f90" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mq lk ll lm ms lo lp lq mu ls lt lu lv ij bi translated">随着越来越多的同事需要在开发阶段访问我们的Druid数据源，使用第三方客户端应用程序查询Druid成为一种必要。而为了管理用户并最终将非管理员从Druid路由器的UI中移除，转移到生产环境会使事情变得更糟。</p><p id="f03e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mq lk ll lm ms lo lp lq mu ls lt lu lv ij bi translated">在网上搜索解决方案时，我找不到方便的方法。起初，我认为使用由<a class="ae kv" href="https://github.com/druid-io/pydruid" rel="noopener ugc nofollow" target="_blank"> pydruid Python库</a>支持的<a class="ae kv" href="https://superset.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Superset </a>的SQL lab可以为我完成这项工作，但这显然是一种过度的做法，因为我不想使用Superset的任何其他特性。</p><p id="c463" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mq lk ll lm ms lo lp lq mu ls lt lu lv ij bi translated">我的团队已经使用<a class="ae kv" href="https://calcite.apache.org/avatica/" rel="noopener ugc nofollow" target="_blank"> Apache方解石Avatica </a>的JDBC驱动程序成功地将Tableau连接到Apache Druid。我经常使用DataGrip来查询不同的数据库系统，因为它支持大量的数据库系统。因此，我研究了DataGrip提供的自定义驱动程序，通过添加Avatica connector jar和其他一些驱动程序，我得到了一个可用的驱动程序。这是最好的解决方案，因为它很容易与其他团队成员交流，而且不会让我们使用新工具，花更多的时间来熟悉它。</p><p id="9393" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mq lk ll lm ms lo lp lq mu ls lt lu lv ij bi translated">背景故事讲完了，让我们打开DataGrip来创建一个驱动程序和一个数据源，以便查询Druid。</p><h2 id="67f3" class="mw lx iq bd ly mx my dn mc mz na dp mg mq nb nc mi ms nd ne mk mu nf ng mm nh bi translated">创建自定义驱动程序</h2><ul class=""><li id="7573" class="ni nj iq lc b ld mo lg mp mq nk ms nl mu nm lv nn no np nq bi translated">导航到文件&gt;新建&gt;驱动程序，打开数据源和驱动程序窗口</li><li id="e939" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">在新窗口中，将驱动程序的<strong class="lc ir">名称</strong>字段更改为Avatica Apache Druid(或任何您想识别的名称)</li><li id="1596" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">进入<strong class="lc ir">驱动文件</strong>点击<strong class="lc ir"> + </strong>按钮，上传我的<a class="ae kv" href="https://github.com/ZisisFl/apache-druid-datagrip-driver" rel="noopener ugc nofollow" target="_blank"> Github repo </a>的jars文件夹中可以找到的所有jar文件</li><li id="10d5" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">在<strong class="lc ir">类</strong>下拉菜单中选择org.apache .方解石. avatica.remote.Driver</li><li id="805e" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">添加一个<strong class="lc ir"> URL模板</strong>，将其命名为<strong class="lc ir"> default </strong>，并将值设置为:</li></ul><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="d093" class="mw lx iq nx b gy ob oc l od oe">jdbc:avatica:remote:url=http://{host::localhost}:{port::8082}/druid/v2/sql/avatica/</span></pre><ul class=""><li id="37c1" class="ni nj iq lc b ld le lg lh mq of ms og mu oh lv nn no np nq bi translated">转到选项卡<strong class="lc ir">选项</strong>，在<strong class="lc ir">其他</strong>部分从下拉菜单中选择通用SQL</li><li id="c864" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">申请保存驱动程序</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/5e5a67b3e3d93590665054cd1b0d78db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qdQxVK3AYgFIFI_HG-clxg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">驱动程序配置</p></figure><h2 id="d00f" class="mw lx iq bd ly mx my dn mc mz na dp mg mq nb nc mi ms nd ne mk mu nf ng mm nh bi translated">使用自定义驱动程序创建新数据源</h2><ul class=""><li id="003b" class="ni nj iq lc b ld mo lg mp mq nk ms nl mu nm lv nn no np nq bi translated">导航到文件&gt;新建&gt;数据源&gt; {Druid驱动程序名称}</li><li id="6668" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">如果需要，更改主机和端口(默认端口设置为8082，因为它是代理节点的默认纯文本端口)</li><li id="347b" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">测试电路</li><li id="b5ea" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">应用于保存数据源</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/ff2f0f8ef7f6127b516e235d9d4c29c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GXWVFnvXR-uR7IVAW8DyA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据源创建</p></figure><p id="b84f" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mq lk ll lm ms lo lp lq mu ls lt lu lv ij bi translated">我还没有尝试使用TLS连接到代理节点，但我认为这不会是一个问题，因为在Tableau中使用Avatica驱动程序是可能的。</p><h2 id="7366" class="mw lx iq bd ly mx my dn mc mz na dp mg mq nb nc mi ms nd ne mk mu nf ng mm nh bi translated">限制</h2><ul class=""><li id="8dca" class="ni nj iq lc b ld mo lg mp mq nk ms nl mu nm lv nn no np nq bi translated">这种变通方法的主要缺点是，通过使用通用SQL方言，自动完成功能不可用，并且关键字突出显示仅限于经典函数，如count。目前有一个<a class="ae kv" href="https://youtrack.jetbrains.com/issue/DBE-3142?_ga=2.123899022.56697963.1633791448-2097587877.1633075564" rel="noopener ugc nofollow" target="_blank">未解决的问题</a>是关于在DataGrip中添加自定义方言的能力。</li><li id="73af" class="ni nj iq lc b ld nr lg ns mq nt ms nu mu nv lv nn no np nq bi translated">缺少自动限制选项可能会导致查询大量数据，甚至导致历史节点不可用。</li></ul><h1 id="86a4" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">结论</h1><p id="c993" class="pw-post-body-paragraph kz la iq lc b ld mo jr lf lg mp ju li mq mr ll lm ms mt lp lq mu mv lt lu lv ij bi translated">在本教程中，我们经历了一个简单的变通方法，使Apache Druid集群的数据消费者能够使用<a class="ae kv" href="https://druid.apache.org/docs/latest/querying/sql.html" rel="noopener ugc nofollow" target="_blank"> Druid的SQL查询语言</a>执行查询。所有这些都在一个熟悉的工具中进行，这个工具可以作为许多不同数据源类型的客户端，<a class="ae kv" href="https://www.jetbrains.com/datagrip/" rel="noopener ugc nofollow" target="_blank"> Datagrip </a>。在这里的评论区或者在<a class="ae kv" href="https://github.com/ZisisFl/apache-druid-datagrip-driver" rel="noopener ugc nofollow" target="_blank">项目</a>的Github问题中，你可以随意发表你在设置驱动时遇到的任何问题。</p></div></div>    
</body>
</html>