<html>
<head>
<title>How to analyze the performance of your classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何分析你的分类器的性能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-analyze-the-performance-of-your-classifier-4567f66318a7?source=collection_archive---------27-----------------------#2021-07-31">https://towardsdatascience.com/how-to-analyze-the-performance-of-your-classifier-4567f66318a7?source=collection_archive---------27-----------------------#2021-07-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="906d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">知道使用哪些指标并不总是简单明了的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6eae4b2799c73fe3be14f67fceaedc7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cqhge1skSbnW56kW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Firmbee.com在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@firmbee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍照</a></p></figure><p id="ef80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着深度学习的蓬勃发展，越来越多的人正在学习如何训练他们的第一个分类器。但是一旦你完成了训练，接下来的分析是至关重要的。知道使用哪些指标并不总是简单明了的。在本文中，我将讨论准确度、精确度、召回率、f1分数和混淆矩阵来衡量分类器的性能。</p><h1 id="de10" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">真与假，正与负</h1><p id="ca8c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在开始度量之前，让我们看一些术语，我们将用来定义这些度量[1]。</p><p id="1ac8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将做出如下定义:</p><ol class=""><li id="d7eb" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">肿瘤阳性类别</li><li id="f724" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">无肿瘤——阴性类别</li></ol><p id="9d6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以积极和消极是我们定义的阶级。True意味着预测和实际的类匹配。False表示预测和实际类不匹配。</p><p id="fea2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以看看以下四个术语:</p><ol class=""><li id="c662" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><strong class="lb iu">真阳性(TP) </strong>:这意味着<strong class="lb iu">预测为阳性类别</strong>且<strong class="lb iu">实际类别也为阳性</strong>。</li><li id="74cf" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu">假阳性(FP) </strong>:这意味着<strong class="lb iu">预测为阳性类别</strong>，而<strong class="lb iu">实际类别为阴性类别</strong>。</li><li id="77a8" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu">真阴性(TN) </strong>:这意味着<strong class="lb iu">预测是阴性类别</strong>，而<strong class="lb iu">实际类别也是阴性。</strong></li><li id="c386" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu">假阴性(FN) </strong>:这意味着<strong class="lb iu">预测为阴性类别</strong>，而<strong class="lb iu">实际类别为阳性类别</strong>。</li></ol><h1 id="d59d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">准确(性)</h1><p id="a17e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是一个非常流行的指标，它告诉你在所有的预测中有多少是正确的。</p><p id="726c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ng nh ni nj b">Accuracy = Total correct predictions / Total predictions</code> [2]</p><p id="670a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者</p><p id="e4fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ng nh ni nj b">Accuracy = (TP + TN) / (TP + FP + TN + FN)</code></p><p id="b6a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注:<code class="fe ng nh ni nj b">Total predictions = TP + FP + TN + FN</code>和<code class="fe ng nh ni nj b">Total correct predictions = TP + TN.</code></p><p id="5ea1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个非常简单的性能衡量标准。然而，对于类别高度不平衡的数据集，这可能会产生误导。假设我们有100个样本，其中10个是肿瘤，90个不是肿瘤。分类器正确地分类了89个非肿瘤，但只有一个是真正的肿瘤。</p><p id="a1b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个例子:TP: 1，FP: 1，TN: 89，FN: 9</p><p id="fde6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将获得90%的准确率。看起来这个模型表现得很好。然而，在现实中，它在肿瘤类中表现很差。医疗应用中的假阴性可能会导致死亡。然而，准确性给人一种表现出色的错觉。我们接下来要看的指标在这些情况下会有所帮助，并让我们更好地理解分类器的性能。</p><h1 id="84a9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">精确</h1><p id="dbb5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu">精度被定义为相关实例在检索到的实例中所占的比例</strong> [3]。它也被称为阳性预测值。它是集合中真阳性与预测阳性的比率，即真阳性和假阳性的总和。</p><p id="e97e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ng nh ni nj b">Precision = TP/ (TP + FP)</code></p><p id="2cce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Precision试图回答这样一个问题:多大比例的肯定识别是正确的？[4] </p><p id="1bdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们继续前面的例子，</p><p id="be9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">精度= 1 / (1 + 1) = 0.5</p><p id="3c6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">精度为0.5，这意味着分类器与随机猜测一样好。</p><p id="bc4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:精度值为1的模型不会有误报。</strong></p><h1 id="2767" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">回忆</h1><p id="027b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu">召回被定义为检索到的相关实例的分数</strong>【3】。也就是所谓的敏感。它是真阳性与集合中总阳性的比率，即真阳性和假阴性的总和。</p><p id="4fa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ng nh ni nj b">Recall = TP/ (TP + FN)</code></p><p id="ae2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Precision试图回答以下问题:正确识别的实际阳性率是多少？[4] </strong></p><p id="dce2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们继续前面的例子，</p><p id="4eba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回忆= 1 / (1 + 9) = 0.1</p><p id="3ab9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">召回率是0.1，这意味着分类器只能检索10%的肿瘤实例，而90%将被错误地分类为非肿瘤。基于肿瘤检测应用的要求，这是非常差的性能。</p><p id="2494" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:召回值为1的模型不会有假阴性。</strong></p><h1 id="7488" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">f1-分数</h1><p id="5636" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是一个结合了精度和召回值来给出性能评估的指标。F1分数被定义为精确度和召回率的调和平均值[5]。</p><p id="14f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ng nh ni nj b">F1-score = 2 * (precision * recall ) / (precision + recall )</code></p><p id="d173" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它对精确度和召回率给予了同等的重视。与仅取精确度和召回值的算术平均值或几何平均值相比，F1分数将给出较低的值。它将倾向于两个值中的较低值，以减轻较大异常值的影响。</p><p id="3b8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于上面的例子，</p><p id="6774" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">f1-得分= 2 * 0.5 * 0.1 / (0.5+0.1) = 0.16667</p><p id="a265" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到的F1值更接近于两个指标中较低的召回值。因此，高F1分数将指示分类器具有高精度以及高召回率。</p><h1 id="eb5d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">混淆矩阵</h1><p id="3853" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在分类的机器学习中，混淆矩阵(也称为误差矩阵)是一个允许可视化分类性能的表格[6]。每行代表实际类中的实例，列代表预测类中的实例或其他方式。</p><p id="e644" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:请确保您正确阅读了您正在使用的库的文档，以确保您知道行和列代表哪些条目。对于scikit-learn，行代表真实标签，列代表预测标签[7]。</strong></p><p id="1f81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于二进制分类，混淆矩阵可以使用TP、FP、TN和FN值灵活地表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/43fdd55178251f53c32f4d4d3c381ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*gm3WGdQswD86D1YIKIMImQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">二元分类的混淆矩阵(来源:作者)</p></figure><p id="d822" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的例子，混淆矩阵是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/06af38256a6f1c9741d809f1f566b319.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*naZ3Yf_fRWsnqduONSbnow.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="8e2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看着这个混淆矩阵，我们可以清楚地看到分类器的性能如何。理想的混淆矩阵将只有对角线元素，没有非对角线元素，即FP和FN为零。在这种情况下，精度和召回值将为1。形象化该矩阵的一个好方法是热图。这将加热有较大条目的地方，也就是说，使那些条目明亮，而其他条目柔和。如果我们观察到一条明亮的对角线，我们很快就知道混淆矩阵是正确的。这对多类分类混淆矩阵更有意义。</p><p id="72b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看矩阵可以快速找出每个类别有多少样本被正确分类，以及错误分类样本的分布。然后，您可以检查并查看是否有突出的内容。就像一个特定的类被严重错误地归类为另一个类，那么您可以手动检查样本，看看是否一切正常。也许样品有问题。或者你明白分类器失效的条件。</p><h1 id="e1f2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="bb12" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们研究了一些对分析分类器性能有用的分类指标。我们从真与假、正与负的概念开始。然后将准确性视为一种度量，并观察到它对不平衡的数据集具有误导性。接下来，我们将精确度、召回率和F1分数作为处理不平衡数据集的指标。最后，我们看了混淆矩阵，这是一个非常有用的表格表示，可以直观地显示分类器的性能。希望这篇文章对你有帮助。如果您使用任何其他工具或指标，请与我分享！感谢您阅读这篇文章。关注更多有趣和有见地的文章。另外，如果你想了解更多的指标，你可以阅读<a class="nm nn ep" href="https://medium.com/u/e8cce06956c9?source=post_page-----4567f66318a7--------------------------------" rel="noopener" target="_blank">拉胡尔·阿加瓦尔</a>的文章<a class="ae ky" rel="noopener" target="_blank" href="/the-5-classification-evaluation-metrics-you-must-know-aa97784ff226">。</a></p><h1 id="9335" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><p id="1508" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">[1]<a class="ae ky" href="https://developers.google.com/machine-learning/crash-course/classification/true-false-positive-negative" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/machine-learning/速成/分类/真-假-正-负</a></p><p id="d886" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]<a class="ae ky" href="https://developers.google.com/machine-learning/crash-course/classification/accuracy" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/machine-learning/crash-course/classification/accuracy</a></p><p id="68d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Precision_and_recall</a></p><p id="f7d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[4]<a class="ae ky" href="https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/machine-learning/crash-course/class ification/precision-and-recall</a></p><p id="d1db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/F-score" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/F-score</a></p><p id="5eb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Confusion_matrix" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Confusion_matrix</a></p><p id="284f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[7]<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . metrics . confusion _ matrix . html</a></p></div></div>    
</body>
</html>