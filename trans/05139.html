<html>
<head>
<title>Generative Adversarial Networks (GANs) — From Intuition to Implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生成性对抗网络(GANs)——从直觉到实现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generative-adversarial-networks-gans-from-intuition-to-implementation-436dc5bd237f?source=collection_archive---------38-----------------------#2021-05-05">https://towardsdatascience.com/generative-adversarial-networks-gans-from-intuition-to-implementation-436dc5bd237f?source=collection_archive---------38-----------------------#2021-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6a9d1500d3e7291391fb1dcfaf05d172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RyX2xNxTZCKMUW_lErbJVw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">图片由<a class="ae kf" href="https://arxiv.org/pdf/1710.10196.pdf" rel="noopener ugc nofollow" target="_blank">纸</a></p></figure><h1 id="ec20" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">生成对抗网络</h1><p id="8a40" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">形式上，GANs被定义为<strong class="lg iu">两个神经网络在一场游戏中相互竞争(在博弈论的意义上，经常但不总是以零和游戏的形式)。给定一个训练集，这种技术学习生成具有与训练集相同的统计数据的新数据。</strong>这个定义似乎非常数学化，如果你对实现算法更感兴趣的话，这可能不是很有用。在这篇博客中，我将为你提供算法如何工作以及你如何实现算法的直觉。</p><p id="e448" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">与普通的神经网络相比，GANs可以生成质量更好的新数据。我们可以把它描述为<strong class="lg iu">两个网络相互竞争，这种竞争导致更好的结果，因为双方都在试图击败对方。</strong></p><p id="cf90" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">它的应用非常有趣，它使我们能够解决许多现实世界的问题。让我们先看看它的一些应用</p><ul class=""><li id="07db" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated">生成与真实人脸惊人相似的人脸。</li><li id="bfb0" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated">图像到图像的转换——给定边缘的图像，网络可以生成物体的彩色图片，或者给定夜间条件下的图片，它可以将其转换为白天条件，这在自动驾驶中有巨大的用途。</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/7c150702c789dba5ec313864bb602ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*3FDRF0ruV-12ItbMUKDLUg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">图片由<a class="ae kf" href="https://arxiv.org/pdf/1611.07004.pdf" rel="noopener ugc nofollow" target="_blank">纸</a>制成</p></figure><ul class=""><li id="6764" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated">修复——给定一个失真的图像，它可以生成完整的图像，这在视频后处理、受损视频恢复和视频编辑中有很大的应用。</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi na"><img src="../Images/aa630fe5c351cdd61f15160b9735385d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*FVJ3W5nh0e4o5r6LZUdqUg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">物体去除，图像由<a class="ae kf" href="https://github.com/amjltc295/Free-Form-Video-Inpainting" rel="noopener ugc nofollow" target="_blank">纸</a></p></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/fd0f3fd274e0c34937e2b40dd0d8dd0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/1*Ov0aPmoM1YR4FeRRfMq11A.gif"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">GIF by <a class="ae kf" href="https://github.com/amjltc295/Free-Form-Video-Inpainting" rel="noopener ugc nofollow" target="_blank"> LGTSM </a></p></figure><p id="cbf0" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在让我们更深入地了解GANs。根据形式定义，我们知道在这个算法中有两个网络。其中一个称为<strong class="lg iu">发生器</strong>，另一个称为<strong class="lg iu">鉴别器</strong>。</p><p id="951b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">生成器网络生成具有某种统计属性的数据。我们希望统计特性与我们想要得到的输出类型相同。例如，在从夜晚到白天的图像到图像的翻译中，它应该能够正确地生成白天的图像。而在生成新的人脸时，它应该能够给出类似于真实世界人脸等的输出。</p><p id="22f0" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="nc">下面的代码是生成器的架构。它接受一个固定大小的随机输入(random_size ),然后生成一个扁平的图像(大小为height*width的1D数组),为了从输出中可视化图像，我们必须将输出向量整形为适当的(height，width)。在这里，我为生成器架构使用了完全连接的层。</em></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">发电机架构</p></figure><p id="27c6" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">鉴别器充当发生器的<strong class="lg iu">评论</strong>(稍后解释)。它的主要工作是，给定一个特征点/图像，它试图将该特征点/图像分类到所需的类别中。例如，给定一幅图像，鉴别器将试图把给定的图像分类为真实的或伪造的(这里生成器的输出可能是伪造的)。在领域自适应的情况下，它试图将给定的特征分类为源或目标领域特征。</p><p id="d5b9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="nc">下面，代码是鉴别器的架构。它是将一幅展平的图像(shape - &gt; height*width)作为输入，然后将输入分类为真假。这里我使用了完全连接的层。</em></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">鉴别器架构</p></figure><p id="0a46" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">既然我们已经看到了单个模型的角色，那么让我们看看它们是如何互相帮助的。</p><h2 id="3315" class="nf kh it bd ki ng nh dn km ni nj dp kq lp nk nl ku lt nm nn ky lx no np lc nq bi translated">仅培训生成器</h2><p id="c1c1" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们假设我们有一个经过训练的鉴别器，即它可以正确地将图像分类为真的和假的(通常情况下不是这样)，并且我们只训练我们的生成器。然后我们用这个评论作为反馈，用生成器生成接近真实的图像。考虑发电机的培训过程如下:</p><ul class=""><li id="3eea" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><strong class="lg iu">最初</strong>，由于神经网络权重的随机初始化，会产生一些随机输出(用<strong class="lg iu"> G(z) </strong>表示)。当这个通过鉴别器时，它肯定会被鉴别器分类为假的。</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ac57ebe14bec8ea413ba43c6398d4934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*P3TdjRsXENyE50H1n7J3Ig.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">当我们开始训练时(图片由作者提供)</p></figure><ul class=""><li id="d3bd" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><strong class="lg iu">最后</strong>，当我们已经训练了生成器模型时，我们希望输出非常类似于训练数据集，即我们的鉴别器应该将生成器的输出(G(z))分类为实数。</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/b6b04ea2db72961334cea02fb6b6fc05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*Tvbo6ZiP0Qdchpwy5qo7ng.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">训练结束时(图片由作者提供)</p></figure><p id="d16f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">为了训练发生器，我们通过将<strong class="lg iu"> G(z) </strong>的标签作为真实数据，使用来自鉴别器的输出来计算损耗，即我们强制发生器产生鉴别器可以分类为真实的输出。这样鉴别器就帮助了发生器。为了更好地说明，请看下面的损失公式:</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/f2423143f5498c2252146353840771da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bTMTnyvDZ9v3yOrIpiP8ZQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">发电机损失(图片由作者提供)</p></figure><p id="cbde" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">理想情况下，</strong>对于真实图像，鉴别器的输出为0，而对于伪图像，其输出为1。<strong class="lg iu"> </strong>为了最小化上述损失，输出<strong class="lg iu"> D(G(z)) </strong>应该接近0，即我们正在训练发生器，以便其输出被鉴别器分类为实数。</p><p id="5d08" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">下面的代码显示了生成器的训练方案。发生器G(z)的输出被馈送到鉴别器，然后通过将输入到鉴别器的标记作为真实图像来计算损耗。然后，该损耗用于更新发电机的参数。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">训练生成器</p></figure><h2 id="803a" class="nf kh it bd ki ng nh dn km ni nj dp kq lp nk nl ku lt nm nn ky lx no np lc nq bi translated">仅训练鉴别器</h2><p id="92e7" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在让我们假设我们有一个生成假图像的生成器，即输出质量很差，我们只训练我们的鉴别器。训练鉴别器与训练普通分类器是一样的。当我们的输入是假图像时，它分类为假，当输入是真实的(即来自训练数据)时，它分类为真实。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/73bbedc099c717d45da9b3f391235938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eL-ZfbsYVar-TjDCn-aGig.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">训练鉴别器(图片由作者提供)</p></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/0a4637e6b79dc910cd963e8ad015aed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hT-_Bbb_FNzrsYIG18d9aA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">鉴别器丢失(由<a class="ae kf" href="https://arxiv.org/pdf/1406.2661.pdf" rel="noopener ugc nofollow" target="_blank">纸</a>成像)</p></figure><p id="b227" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">上面的损耗公式强制鉴别器将真实输出分类为1，将伪造/生成的输出分类为0。</p><p id="5dbc" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="nc">下面是鉴别器的训练方案，我们首先将真实图像(来自训练数据)馈送给鉴别器，并通过将这些图像的标签视为真实来计算损失。然后，我们将假图像(生成器的输出G(z))馈送到鉴别器，并通过将G(z)的标签视为假来计算损失。</em></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">训练鉴别器</p></figure><p id="5ada" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在我们已经讨论了如何分别训练生成器和鉴别器。然而，在现实世界中，我们必须同时训练他们两个。</p><h2 id="53dc" class="nf kh it bd ki ng nh dn km ni nj dp kq lp nk nl ku lt nm nn ky lx no np lc nq bi translated">完整的训练</h2><p id="2490" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">考虑一下，两个网络最初都有随机权重。首先，我们通过将生成器的输出分类为假来训练鉴别器，将训练数据分类为真，并且只更新鉴别器的参数。然后，我们训练生成器，其中使用鉴别器，我们尝试将生成器的输出(<strong class="lg iu"> G(z) </strong>)分类为实数，并仅更新生成器的参数。现在，如果我们的训练是稳定的，并且一切按预期进行，那么当鉴别器的输出对于训练数据和来自生成器的输出相同时，即鉴别器不能区分两者时，我们可以停止训练。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">训练甘</p></figure><p id="af39" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这样，我们就完成了对GANs的介绍。我希望这个博客能让你对GANs的工作有一个好的直觉。完整的实现可以在下面的GitHub仓库中找到。</p><div class="nv nw gp gr nx ny"><a href="https://github.com/harsh-99/PyTorch-Tutorials/blob/master/GANS.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">harsh-99/PyTorch教程</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">permalink dissolve GitHub是4000多万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">github.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om jz ny"/></div></div></a></div><p id="46df" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="nc">成为</em> <a class="ae kf" href="https://medium.com/@AnveeNaik/membership" rel="noopener"> <em class="nc">介质会员</em> </a> <em class="nc">解锁并阅读介质上的许多其他故事。关注我们的</em> <a class="ae kf" href="https://medium.com/@AnveeNaik" rel="noopener"> <em class="nc">媒体</em> </a> <em class="nc">阅读更多此类博文</em>。</p></div></div>    
</body>
</html>