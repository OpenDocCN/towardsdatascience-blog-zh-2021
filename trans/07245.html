<html>
<head>
<title>Session State for Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Streamlit的会话状态</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/session-state-for-streamlit-dc9ea1685ea?source=collection_archive---------20-----------------------#2021-07-01">https://towardsdatascience.com/session-state-for-streamlit-dc9ea1685ea?source=collection_archive---------20-----------------------#2021-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="97c2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">现在，您可以在应用程序交互和重新运行之间存储信息</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8cc87befd4e6042d3d3df955cbeb1c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dDS208JajoKvdobGNCHfPg.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="8681" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在2019年推出Streamlit后不久，社区就开始寻求为他们的应用程序添加状态的方法。针对<a class="ae lr" href="https://gist.github.com/tvst/036da038ab3e999a64497f42de966a92" rel="noopener ugc nofollow" target="_blank">会话状态</a>的黑客攻击自2019年10月就已经出现，但我们希望建立一个优雅的解决方案，你可以用几行代码直观地将其编入应用程序。今天我们很高兴发布它！</p><p id="e6b0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，您可以使用会话状态来跨重新运行存储变量，在输入小部件上创建事件，并使用回调函数来处理事件。这一强大的功能有助于创建能够:</p><ul class=""><li id="2ebb" class="ls lt iq kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">执行数据/图像注释</li><li id="c47b" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">支持分页</li><li id="e726" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">添加依赖于其他小部件的小部件</li><li id="ef45" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">构建简单的有状态游戏，如战舰，井字游戏等。</li><li id="d3f0" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">更多——所有这一切都是通过编写Python脚本的应用程序来实现的！</li></ul><p id="ea1a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">💡如果你想直接进入，请查看我们的<a class="ae lr" href="https://share.streamlit.io/streamlit/release-demos/0.84/0.84/streamlit_app.py?page=headliner" rel="noopener ugc nofollow" target="_blank">演示</a>来看看上面的一些应用程序的运行情况，或者前往<a class="ae lr" href="https://docs.streamlit.io/en/stable/add_state_app.html" rel="noopener ugc nofollow" target="_blank">文档</a>获取更多关于开始的详细信息。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="bcc2" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">向您的应用程序添加状态</h1><p id="efc5" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">在Streamlit中，与小部件交互会触发一次重新运行，代码中定义的变量会在每次重新运行后重新初始化。但是有了会话状态，当你不希望你的变量被重新初始化的时候，有可能在那些实例的重新运行中保持值。</p><p id="5e78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">例如，这里有一个简单的计数器，它在多次按下增量按钮时保持一个计数值。每次按下按钮都会触发一次重新运行，但在重新运行过程中，计数值会保留并递增(或递减):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/8ffee854a95cee81be13431a99bbd1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I1dTeiCI9oSwbWaN.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="d2b1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">💡为了继续构建这个例子，请跟随我们的<a class="ae lr" href="https://docs.streamlit.io/en/stable/add_state_app.html" rel="noopener ugc nofollow" target="_blank">主题指南:向您的应用程序添加状态</a>🤓</p><p id="4a9c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上面展示了一个基本的例子，说明了值是如何在重新运行时保持不变的，但是让我们继续看一些更复杂的东西！</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="76ad" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">回调函数和会话状态API</h1><p id="d52d" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">作为此次发布的一部分，我们将在Streamlit中启动回调。回调可以使用<code class="fe no np nq nr b">on_change</code>参数作为参数传递给像<code class="fe no np nq nr b">st.button</code>或<code class="fe no np nq nr b">st.slider</code>这样的小部件。</p><p id="dc5d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">💡好奇什么是回调？维基百科说得好:“<em class="nk">回调，也称为“call-after”函数，是作为参数传递给其他代码的任何可执行代码；其他代码应该在给定的时间回调(执行)参数。如果你想了解更多，这里有一个链接。</em></p><p id="363e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用会话状态，与小部件更改相关联的事件或与按钮按压相关联的单击事件可以由回调函数来处理。记住以下执行顺序很重要:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/f953f02195d6f5571ec3ead91dfa9d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AkzoDqd-g_2Udtga.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="f968" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">执行顺序:</strong>如果一个回调函数与一个窗口小部件相关联，那么窗口小部件中的一个变化触发以下顺序:首先执行回调函数，然后应用程序从上到下执行。</p><p id="0e4c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里有一个例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/104619eab250a926fd82f796828e7101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F9preM1ht0KOqAdZ.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="fe45" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面，我们展示了回调和会话状态的使用。我们还展示了一个高级概念，其中会话状态可以使用<code class="fe no np nq nr b">key</code>参数与小部件状态相关联。</p><p id="4ef8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要了解更多信息，请查看会话状态文档中的<a class="ae lr" href="https://docs.streamlit.io/en/stable/add_state_app.html#advanced-concepts" rel="noopener ugc nofollow" target="_blank">高级概念部分</a>，要详细查看API，请访问<a class="ae lr" href="https://docs.streamlit.io/en/stable/session_state_api.html" rel="noopener ugc nofollow" target="_blank">状态API文档</a>。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="8c19" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">包扎</h1><p id="cd31" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">这就是对会话状态的介绍，但我们希望这不是对话的结束！我们很高兴看到您将如何使用这些新功能，并且state将为社区解锁所有新功能。</p><p id="5327" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要开始使用，请升级到最新版本，以便在您的应用中使用<code class="fe no np nq nr b">st.session_state</code>和<code class="fe no np nq nr b">callbacks</code>:</p><pre class="kg kh ki kj gt nt nr nu nv aw nw bi"><span id="c9a8" class="nx mo iq nr b gy ny nz l oa ob">pip install --upgrade streamlit</span></pre><p id="bd89" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你对这些有任何疑问(或者对Streamlit有任何疑问)，请在下面的评论中或者在论坛上告诉我们。一定要来论坛或推特分享你做的所有酷的东西！🎈</p><h1 id="a782" class="mn mo iq bd mp mq oc ms mt mu od mw mx jw oe jx mz jz of ka nb kc og kd nd ne bi translated">资源</h1><ul class=""><li id="2ed3" class="ls lt iq kx b ky nf lb ng le oh li oi lm oj lq lx ly lz ma bi translated"><a class="ae lr" href="https://docs.streamlit.io/en/stable/add_state_app.html" rel="noopener ugc nofollow" target="_blank">会话状态主题指南</a></li><li id="98c6" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><a class="ae lr" href="https://docs.streamlit.io/en/stable/session_state_api.html" rel="noopener ugc nofollow" target="_blank">会话状态API引用</a></li><li id="f9ce" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><a class="ae lr" href="https://share.streamlit.io/streamlit/release-demos/0.84/0.84/streamlit_app.py?page=headliner" rel="noopener ugc nofollow" target="_blank">会话状态演示App </a></li><li id="149c" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><a class="ae lr" href="https://github.com/streamlit/streamlit" rel="noopener ugc nofollow" target="_blank"> Github </a></li><li id="47b3" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><a class="ae lr" href="https://discuss.streamlit.io/" rel="noopener ugc nofollow" target="_blank">论坛</a></li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="5c76" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nk">原载于2021年7月1日</em><a class="ae lr" href="https://blog.streamlit.io/session-state-for-streamlit/" rel="noopener ugc nofollow" target="_blank"><em class="nk">https://blog . streamlit . io</em></a><em class="nk">。</em></p></div></div>    
</body>
</html>