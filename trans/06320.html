<html>
<head>
<title>Finding Seasonal Trends in Time-Series Data with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python在时间序列数据中发现季节性趋势</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/finding-seasonal-trends-in-time-series-data-with-python-ce10c37aa861?source=collection_archive---------1-----------------------#2021-06-07">https://towardsdatascience.com/finding-seasonal-trends-in-time-series-data-with-python-ce10c37aa861?source=collection_archive---------1-----------------------#2021-06-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4f2b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解不同种类的季节性以及如何将时间序列分解为趋势和季节的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e352d5caf802d6152b3610b3fe74a2e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwbYyrpDqkfg9I47LTNSJA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由来自<a class="ae kv" href="https://www.pexels.com/photo/concrete-road-between-trees-1563356/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae kv" href="https://www.pexels.com/@thatguycraig000?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">克雷格·阿德利</a>拍摄</p></figure><h1 id="e3d8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为什么要探索季节性？</h1><p id="8f2c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">时间序列数据中的季节性指的是以固定间隔发生的模式。这不同于有规律的周期性趋势，如股票价格的上涨和下跌，这些趋势有规律地重复出现，但没有固定的周期。从了解数据中的季节性模式中可以获得很多洞察力，甚至可以将其用作比较时间序列机器学习模型的基线。</p><h1 id="6963" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">入门</strong></h1><p id="5e82" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><em class="mk">快速提示:在这篇文章中，我将使用魁北克房地产经纪人专业协会发布的数据。该协会每月发布房地产统计数据。为了方便起见，我将魁北克省和蒙特利尔大都会区的每月公寓价格中值放入一个CSV文件中，可在此处获得:</em><a class="ae kv" href="https://drive.google.com/file/d/1SMrkZPAa0aAl-ZhnHLLFbmdgYmtXgpAb/view?usp=sharing" rel="noopener ugc nofollow" target="_blank"><em class="mk">https://drive . Google . com/file/d/1 smrkzpaa 0 AAL-zhnllfbmdgymtxgpab/view？usp =共享</em> </a></p><p id="4987" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">了解数据是否有季节性趋势的最快方法是绘制图表。让我们看看当我们按月绘制蒙特利尔的房价中值时会得到什么。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/072ef368b5799c82cfa7bd5cce4f198a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1nG0Vlj5xK1EK5KqtKe9Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="mt">作者图片</em></p></figure><p id="0192" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">敏锐的眼睛可能已经从这幅图中看出，价格似乎在新年前后下降，并在几个月前夏末左右达到峰值。让我们通过为每年的一月画一条垂直线来更深入地了解这一点。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/da46e770efbbc820c9d8022b85bc28fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iIlqAAYmTuXHZ5mUsDUjHw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="mt">作者图片</em></p></figure><p id="2df9" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">看起来这绝对是一种趋势。在这种情况下，季节性似乎有一年的周期。接下来，我们将研究一个工具，我们可以使用它来进一步检查季节性，并将我们的时间序列分解为趋势、季节性和剩余部分。不过，在我们这样做之前，你必须了解加性和倍增性季节性之间的区别。</p><h1 id="3cf8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">加法与乘法季节性</h1><p id="0295" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在分析时间序列数据时，您可能会遇到两种季节性。为了理解它们之间的区别，让我们看一个具有完美季节性的标准时间序列，一个余弦波:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/56edd55dd4751ee83be47387dce5c1a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*hPVnyDFdMs2L5aXxmqsqaA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">正弦波图— <em class="mt">作者图片</em></p></figure><p id="8dbf" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">我们可以清楚地看到，波浪的周期为20，振幅(从中心线到波峰顶部或波谷底部的距离)为1，并且保持不变。</p><h2 id="b96c" class="mv kx iq bd ky mw mx dn lc my mz dp lg lx na nb li mb nc nd lk mf ne nf lm ng bi translated">附加季节性</h2><p id="056a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">实际时间序列很少具有恒定的波峰和波谷值，相反，我们通常会看到某种总体趋势，如随着时间的推移而增加或减少。例如，在我们的销售价格图中，中间价格往往会随着时间的推移而上升。</p><p id="6d13" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">如果我们的季节性幅度保持不变，那么我们就有了所谓的附加季节性。下面是一个附加季节性的例子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/9ac1224462f9315bbc4d497efe314d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*dDWlQ2DWs8afYlxmReyc7g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">附加季节性— <em class="mt">作者图片</em></p></figure><p id="29a7" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">一个很好的思考方式是，想象我们用标准余弦波，简单地给它添加一个趋势:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/bbdf298d3ecf296e5cef929e943e7205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7lgUd6sVJLi-kqiLEp4FxA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="mt">作者图片</em></p></figure><p id="1dd4" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">我们甚至可以把之前的基本余弦模型想象成一个趋势不变的加性模型！我们可以使用下面的简单等式来模拟加性时间序列:</p><p id="5d22" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">Y[t] = T[t] + S[t] + e[t]</p><p id="9eae" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">Y[t]:我们的时间序列函数<br/> T[t]:趋势(向上或向下移动的总体趋势)<br/> S[t】:季节性(定期出现的循环模式)<br/> e[t]:残差(趋势或季节性中没有考虑的数据中的随机噪声</p><h2 id="0249" class="mv kx iq bd ky mw mx dn lc my mz dp lg lx na nb li mb nc nd lk mf ne nf lm ng bi translated">倍增季节性</h2><p id="f5b2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">您可能在时间序列数据中遇到的另一种季节性是倍增性的。在这种类型中，我们季节性的幅度根据趋势变大或变小。下面是一个倍增季节性的例子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/f99c591ebbe674596c486c8a071b42b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*aBd844aJDYRVPv2u4VVp4w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">倍增的季节性— <em class="mt">作者图片</em></p></figure><p id="1488" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">我们可以采用与加法模型类似的思路，想象我们采用余弦波，但不是将趋势相加，而是将其相乘(因此得名乘法季节性):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/c2aa88e8098129083069f5df10a61e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2iBhF2SJoMtLu1UXSS3VrQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">倍增的季节性— <em class="mt">作者图片</em></p></figure><p id="4b84" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">我们可以用一个类似于加法模型的等式来建模，只需将加法换成乘法。</p><p id="2e8c" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">Y[t] = T[t] *S[t] *e[t]</p><h1 id="4689" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">分解数据集</h1><p id="9d42" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在我们已经对不同的模型有了一个清晰的了解，让我们看看如何将我们的房地产时间序列分解成它的趋势、季节性和剩余部分。我们将使用statsmodels库中的<a class="ae kv" href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.seasonal.seasonal_decompose.html" rel="noopener ugc nofollow" target="_blank">季节性分解</a>模型。</p><p id="2925" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">季节性分解模型要求您选择季节性的模型类型(加法或乘法)。我们将选择乘法模型，因为看起来周期的幅度随着时间而增加。这是有道理的，因为影响房价的一个重要因素是贷款利率，贷款利率是房价的一个百分比。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/8e162ae01a40d98d16a28f791392afc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lnaVfMLKCpwcECEiOFeCqA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="mt">作者图片</em></p></figure><p id="bef1" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">哒哒！趋势、季节和残差分量作为Pandas系列返回，因此您可以通过调用它们的plot()方法来绘制它们，或者对它们执行进一步的分析。可能有用的一件事是衡量它们与外部因素的相关性。例如，您可以测量趋势和抵押贷款利率之间的相关性，或者您可以查看残差和城市新生儿数量之间是否有很强的相关性。</p><h1 id="eccf" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="5da6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">从我们的分解中，我们可以看到这个模型在季节之间获得了5%的差异。如果你想卖掉你的房子，如果你想卖个好价钱，你应该在春末而不是仲冬上市。</p></div></div>    
</body>
</html>