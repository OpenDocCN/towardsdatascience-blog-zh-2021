<html>
<head>
<title>A Deep Dive on ARIMA Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对ARIMA模型的深入研究</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-deep-dive-on-arima-models-8900c199ccf?source=collection_archive---------3-----------------------#2021-08-12">https://towardsdatascience.com/a-deep-dive-on-arima-models-8900c199ccf?source=collection_archive---------3-----------------------#2021-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6e02" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="8902" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从白噪音到SARIMAX及其他</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/398b215e0714fcbcec894bc0dee1b0cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GEUW5rZSsO7Qvl44"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@dastan_khdir?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">达斯坦·卡迪尔</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d390" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">预测未来永远是一个普遍的挑战，从决定是现在还是下周种植作物，结婚还是保持单身，出售股票还是持有，或者上大学还是全职玩音乐。我们永远不可能完美地预测未来[1]，但是我们可以使用统计领域的工具<strong class="lk jd">预测</strong>来更好地理解未来。</p><p id="a880" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">预测涉及<strong class="lk jd">时间序列</strong>数据，或随时间的重复测量。在每小时的温度、每天的电力消耗或每年的全球人口估计等数据中，我们可以寻找将数百或数千个数字归结为几个定义性特征的模式。我们可以使用时间序列分析来量化数值<em class="me">上升或下降</em>的速率，测量一个数值<em class="me">与前几个</em>相关的程度，将我们的数据分解为其<em class="me">潜在的重复周期</em>等等。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mf"><img src="../Images/78615a5900af550c3be7b608ff9c7ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8pUDBjNmpnXNiAaE9uDcQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">过去五年的P 500每日价格，一个被高度研究的时间序列的例子。截图来自谷歌财经。</p></figure><p id="64f7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了总结时间序列并预测其未来，我们需要对时间序列中的值之间的关系进行建模。今天与昨天、一周前或去年有相似之处吗？时间序列之外的因素，比如噪音或者<em class="me">其他</em>时间序列，起到了多大的作用？</p><p id="e6e5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了回答这些问题，我们将从一个基本的预测模型开始，并迭代到一个完整的自回归移动平均(ARMA)模型。然后，我们将进一步包括<a class="ae lh" href="https://www.investopedia.com/terms/a/autoregressive-integrated-moving-average-arima.asp" rel="noopener ugc nofollow" target="_blank"> <em class="me">综合</em></a><a class="ae lh" href="https://otexts.com/fpp2/seasonal-arima.html" rel="noopener ugc nofollow" target="_blank"><em class="me">季节性</em> </a>和<a class="ae lh" href="https://www.statisticshowto.com/endogenous-variable/" rel="noopener ugc nofollow" target="_blank"> <em class="me">外源性</em> </a>组件，扩展成一个<a class="ae lh" href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.statespace.sarimax.SARIMAX.html" rel="noopener ugc nofollow" target="_blank"> SARIMAX </a>模型。</p><p id="5972" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">换句话说，我们将在此基础上构建:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mh"><img src="../Images/dc1cc8057c85582b59c9916f3bc5b315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aICzIzRh6pyqd_xRl96C9Q.png"/></div></div></figure><p id="01fa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对此:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mi"><img src="../Images/607132af62d2977ba25d208867db690c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5RsFqCG4fArQiKkVhV5ufQ.png"/></div></div></figure><p id="e75e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这看起来很复杂，但每一部分——自回归的<strong class="lk jd"/>(蓝色)、<strong class="lk jd">移动平均线</strong>(紫色)、<strong class="lk jd">外生的</strong>(绿色)和<strong class="lk jd">季节性的</strong>(黄色)——只是加在一起。我们可以通过添加或删除项，在原始数据和<strong class="lk jd">差分</strong>(红色)数据之间切换，轻松调整或降低模型的复杂性，以创建ARMA、SARIMA、ARX等。模特。</p><p id="f6ab" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦我们建立了一个模型，我们将能够预测未来的时间序列如下。但也许更重要的是，我们还将理解产生我们的时间序列的<em class="me">潜在模式。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mj"><img src="../Images/f46f66dfb966abcf481deffa9db94bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*81Vo6hlTYloiHbKQUWswxA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="1552" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">(强制说明:本帖不构成投资建议；所有的例子只是为了说明的目的。)</p><p id="b39d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="me">来自《走向数据科学》编辑的提示:</em> </strong> <em class="me">虽然我们允许独立作者根据我们的</em> <a class="ae lh" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="me">规则和指导方针</em> </a> <em class="me">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae lh" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="me">读者术语</em> </a> <em class="me">。</em></p><h1 id="441d" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">目录</h1><ul class=""><li id="4009" class="nc nd it lk b ll ne lo nf lr ng lv nh lz ni md nj nk nl nm bi translated">入门指南</li><li id="bbea" class="nc nd it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">AR:自回归</li><li id="4f09" class="nc nd it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">马:移动平均线</li><li id="b1b0" class="nc nd it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">把它放在一起</li><li id="63f6" class="nc nd it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">附加组件</li><li id="d898" class="nc nd it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">Python中的时间序列</li></ul><h1 id="c883" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">入门指南</h1><h2 id="f582" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">自相关</h2><p id="fae9" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">在我们开始构建任何模型之前，我们需要涵盖一个对于描述时间序列至关重要的主题:<a class="ae lh" href="https://en.wikipedia.org/wiki/Autocorrelation" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">自相关</strong> </a>。自相关意味着“自相关”:它是一个时间序列的值与早期值的相似性，或者说<strong class="lk jd">滞后于</strong>。例如，如果我们的时间序列是值<code class="fe og oh oi oj b">[5, 10, 15]</code>，我们的滞后-1自相关将是<code class="fe og oh oi oj b">[10, 15]</code>与<code class="fe og oh oi oj b">[5, 10]</code>的相关性。</p><p id="2b6b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以用<strong class="lk jd">自相关图将<em class="me">当前值</em>与<em class="me">之前的值</em>的相关性可视化。</strong>这些图是通过计算每个值(y_t)与前一时间步(<em class="me"> y </em> _{t-1})、两步前(y_{t-2})、三步前(y_{t-3})的值的相关性而构建的。y轴显示滞后<em class="me"> n </em>处的相关性强度，我们认为阴影误差区间之外的任何值都是显著相关性。</p><p id="194b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">滞后零点的相关性总是1: y_t最好和y_t完全相关，否则就有问题。对于剩余的滞后，有三种典型的模式:1)缺乏自相关，2)逐渐衰减，3)急剧下降。(尽管在现实世界的数据中，你可能会得到#2和#3的混合。)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/8b285ec211db3f34ebb0185a5aa1aa27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z6qo6lQNLr6N6PPRYNYwOA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="830f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面我们来看看芝加哥植物园<a class="ae lh" href="https://www.marketwatch.com/investing/fund/spy" rel="noopener ugc nofollow" target="_blank">每日标准普尔500收盘价</a>(左)和<a class="ae lh" href="https://www.ncdc.noaa.gov/cdo-web/datasets/GHCND/stations/GHCND:USC00111497/detail" rel="noopener ugc nofollow" target="_blank">每日最高气温</a>(右)的自相关。标准普尔500指数的价格相关性如此之强，以至于你必须查看过去三个月以上的数据才能找到不相关的价值。芝加哥的气温变得不相关得更快，大约在两个月前，但随后从另一边射出，变成与4-7个月前的气温负相关的<em class="me">。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/cceec58685499cab2f0914a57495dc16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CDOto_vxYogafTntbeW3gw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><h2 id="46b5" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">偏自相关</h2><p id="84b9" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">自相关图是有用的，但滞后之间可能存在实质性的相关性“溢出”。例如，在标准普尔500价格中，滞后-1相关性达到惊人的0.994——很难获得后续滞后的良好读数，因为第一个滞后间接影响所有下游相关性。</p><p id="a8b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这就是<a class="ae lh" href="https://online.stat.psu.edu/stat510/lesson/2/2.2" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">偏相关</strong> </a>可以成为一个有用的度量的地方。部分自相关是y_t和y_{t-n}的相关性，<em class="me">控制早期滞后</em>的自相关。</p><p id="9a0d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设我们想要测量滞后-2自相关，而不测量滞后-1溢出。我们不是直接测量y_t和y_{t-2}的相关性，而是拟合y _ t ~<em class="me">β</em>₀+<em class="me">β</em>₁<em class="me">y _ { t-1 }</em>的线性回归，y _ { t-2 } ~<em class="me">β</em>₀+<em class="me">β</em>₁<em class="me">y _ { t-1 }</em>的回归，然后找出<em class="me">残差之间的相关性</em></p><p id="3fb2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">残差量化了y_t和y_{t-2}中无法用y_{t-1}解释的变化量，使我们能够公正地看待y_t和y_{t-2}之间的关系。然后我们可以重复这个过程，测量直到<em class="me"> n </em>的滞后的回归残差之间的相关性，找到滞后<em class="me"> n </em>的偏相关。例如，我们可以通过将y _ t ~<em class="me">β</em>₀+<em class="me">β</em>₁<em class="me">y _ { t-1 }+β</em>₂<em class="me">y _ { t-2 }</em>的残差与y _ { t-3 } ~<em class="me">β</em>₀+<em class="me">β</em>₁<em class="me">y _ { t-1 }+β</em>的残差进行回归来测量滞后3时的偏相关</p><p id="9966" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是标准普尔500价格和芝加哥温度的偏相关图。注意滞后-1自相关如何保持高度显著，但随后的滞后从悬崖上跳水。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/108cea5aada09c84e64ed02c891d36d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pSj24C--Tot_914-hBTjDQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="5971" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">自相关和偏自相关图可用于确定简单的AR或MA模型(相对于完整的ARIMA模型)是否足以描述您的数据[2]，但您可能不会以这种方式使用它们。自自相关图<a class="ae lh" href="https://archive.org/details/timeseriesanalys0000boxg" rel="noopener ugc nofollow" target="_blank">首次推出</a>以来的五十年里，你的笔记本电脑可能已经强大到足以执行强力扫描，以找到最能描述你的数据的ARIMA(甚至SARIMAX)模型的参数，即使有成千上万的观察值。因此，这些图作为可视化数据的时间相关性的补充方式可能更有用。</p><h1 id="00ac" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">平稳性</h1><p id="adb0" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">与任何统计模型一样，预测时间序列数据时必须满足一些假设。最大的假设是时间序列是<strong class="lk jd">平稳的。</strong>换句话说，我们假设<strong class="lk jd">描述时间序列的参数不随时间变化。</strong>无论在时间序列的哪个位置，您都会看到相同的均值、方差和自相关性。[3]</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mj"><img src="../Images/b44fa420d379201aace2e30dd9538e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVENx6-rF1kSY8pWN3HuMw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="d433" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这并不意味着我们只能预测看起来像上面绿色乱糟糟的时间序列。虽然大多数真实世界的时间序列不是平稳的，但我们可以<em class="me">将</em>时间序列转换成平稳的，根据平稳数据生成预测，然后<em class="me">对预测进行解转换</em>以获得真实世界的值。一些常见的转换包括<a class="ae lh" href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="noopener ugc nofollow" target="_blank">求差</a>(然后可能再次求差)，取数据的对数或平方根，或者取百分比变化。</p><p id="fa00" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">转换是必要的，因为线性模型要求它们建模的数据是<em class="me">独立的</em>并且<em class="me">同样可能从母体</em>中提取。时间序列数据则不是这样——任何自相关都会立即违反独立性假设。但是独立随机变量的许多便利之处——例如<a class="ae lh" href="https://en.wikipedia.org/wiki/Law_of_large_numbers" rel="noopener ugc nofollow" target="_blank">大数定律</a>和<a class="ae lh" href="https://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_probability/BS704_Probability12.html" rel="noopener ugc nofollow" target="_blank">中心极限定理</a>—<a class="ae lh" href="https://stats.stackexchange.com/questions/19715/why-does-a-time-series-have-to-be-stationary" rel="noopener ugc nofollow" target="_blank">也适用于平稳时间序列</a>。因此，使时间序列平稳是能够对我们的数据建模的关键一步。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/e08cfc1bb72e1cf50889f764ec9b090a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*are8BVD3YW11b0FN"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@aoddeh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ahmad Odeh </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="3e72" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">AR:自回归</h1><p id="4567" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">有了一些基础知识之后，让我们开始构建我们的ARIMA模型。我们将从<strong class="lk jd"> AR </strong>或<strong class="lk jd">自回归</strong>成分开始，然后再加入移动平均线和积分。</p><h2 id="0fc2" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">AR(0):白噪声</h2><p id="162b" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">我们能建立的最简单的模型是不带任何项的模型。嗯，差不多了。只有一个<em class="me">常数</em>和一个<em class="me">误差</em>项。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mh"><img src="../Images/dc1cc8057c85582b59c9916f3bc5b315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aICzIzRh6pyqd_xRl96C9Q.png"/></div></div></figure><p id="1fe7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种时间序列被称为<strong class="lk jd">白噪声。</strong> <em class="me"> ϵ_t </em>是从均值为0、方差为<em class="me"> σ </em>的正态分布中抽取的随机值。[4]每个值都是独立绘制的，意味着<em class="me"> ϵ_t </em>与<em class="me"> ϵ_ </em> {t-1}、<em class="me"> ϵ </em> _{t+1}、或任何其他<em class="me"> ϵ </em> _{t n}都没有关联。用数学方法写，我们会说:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/24b8e6c61dbae4e9fe7e928efb259acc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NjQFGwiEaLnl65Cq7vqy1A.png"/></div></div></figure><p id="5aed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因为所有的<em class="me"> ϵ_t </em>值都是独立的，所以模型y_t = ϵ_t所描述的时间序列只是一个<strong class="lk jd">无法预测的随机数序列</strong>。你对下一个值的最佳猜测是<em class="me"> c </em>，因为<em class="me"> ϵ_t </em>的期望值是零。</p><p id="52bd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是从标准差递增的正态分布中提取的三个白噪声时间序列。<em class="me"> c </em>为零，因此从等式中省略。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/2257351fda7eec000656100f973d16fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XCNOSHqP87n7_e3X-8PnDg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="215f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们无法预测的随机值的时间序列实际上是一个有用的工具。对于我们的分析来说，这是一个重要的零假设——数据中是否存在一种模式，足以将序列与白噪声区分开来？我们的眼睛喜欢寻找模式——即使实际上并不存在——因此白噪声比较可以防止假阳性。</p><p id="49c9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">白噪声也有助于确定我们的模型是否捕获了它可以从我们的时间序列中获得的所有<a class="ae lh" href="https://conceptually.org/concepts/signal-and-noise" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">信号</strong> </a>。如果我们预测的残差<em class="me">不是</em>白噪声，<a class="ae lh" href="https://machinelearningmastery.com/white-noise-time-series-python/" rel="noopener ugc nofollow" target="_blank">我们的模型忽略了一个模式</a>，它可以用来生成更准确的预测。</p><h2 id="f732" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">AR(1):随机游动和振动</h2><p id="f9f1" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">让我们开始在模型中加入自回归项。这些项将是我们的时间序列的滞后值，乘以将那些先前值最好地转化为我们的当前值的系数。</p><p id="1168" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在AR(1)模型中，我们通过取我们的常数<em class="me"> c </em>，加上由乘数<em class="me"> α </em> ₁调整的<em class="me">先前</em>时间步长y_{t-1}，然后加上白噪声<em class="me"> ϵ_t </em>，来预测当前时间步长y_t。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/2d1604022e40ce2fcd9fb445300fe171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otGSeSEYZute-9BlJDMSPg.png"/></div></div></figure><p id="68da" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">₁的值在我们的时间序列中扮演着决定性的角色。如果<em class="me"> α </em> ₁=1，我们得到一个<a class="ae lh" href="https://www.sciencedirect.com/science/article/pii/S0370157317302946" rel="noopener ugc nofollow" target="_blank">t23】随机行走T25】。与白噪声不同，我们的时间序列可以自由地偏离它的原点。在许多应用中，随机漫步是一个非常有用的随机过程模型，例如建模</a><a class="ae lh" href="https://en.wikipedia.org/wiki/Brownian_motion" rel="noopener ugc nofollow" target="_blank">粒子在流体中的运动</a>，觅食动物的搜索路径，或者股票价格的变化<a class="ae lh" href="https://www.investopedia.com/terms/r/randomwalktheory.asp" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/8fc9fb90d98eeaa2d53700cc1440e8c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXIfPKB-fqACQC2zON3Hcw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="ed82" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以当<em class="me"> α </em> ₁ = 0时，我们得到白噪声，当<em class="me"> α </em> ₁ = 1时，我们得到随机游走。当0 &lt; <em class="me"> α </em> ₁ &lt; 1时，我们的时间序列展现出<a class="ae lh" href="https://www.investopedia.com/terms/m/meanreversion.asp" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">均值回复</strong> </a>。这很微妙，但你会注意到这些值是相互关联的<em class="me">和</em>它们倾向于在零附近徘徊，就像不那么混乱的白噪声。这一过程的一个真实例子是股票价格的巨大变化:突然变化<a class="ae lh" href="https://decodingmarkets.com/mean-reversion-trading-strategy/" rel="noopener ugc nofollow" target="_blank">之后往往是均值回归</a>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/e138f478a8480256de421d0112794f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NJrYV64SWdIL_lfHRsbVIA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="c323" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在拟合AR模型时，统计软件包通常在执行<a class="ae lh" href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation" rel="noopener ugc nofollow" target="_blank">最大似然估计</a>时将<em class="me"> α </em>参数空间约束为1 ≤ <em class="me"> α </em> ≤1。除非你在模拟指数增长或剧烈振荡，否则这些模型描述的时间序列可能不是你想要的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/b1920725bbe682ea4e1ba76a626eeb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6k2vWRyZ2hx9B_Hu1pPV0A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="27f8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我们对<em class="me"> c </em>的解释随着AR(1)模型的变化而变化。在AR(0)模型中，<em class="me"> c </em>对应于我们的时间序列的中心位置。但是由于AR(1)模型考虑到了y_{t-1}，<em class="me"> c </em>现在表示我们的时间序列趋势向上(如果<em class="me">c</em>T50】0)或向下(如果<em class="me">c</em>T51】0)的速率。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/9eea93bb851daf75b99e057230fe9dae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T_kR_50viAxmIbQz_9zXug.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><h2 id="a372" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">AR(p):高阶项</h2><p id="b1f9" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">给我们的模型增加更多的滞后只是增加αn * y { t n }项的问题。这是AR(2)模型的样子，附加项用蓝色突出显示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/517db318f913330c31f016dc639f1ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QUnXsGaohqLYi9vgDM90Xg.png"/></div></div></figure><p id="8bae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这表示当前时间步长y_t的值由我们的常数<em class="me"> c </em>确定，加上前一时间步长y_{t-1}的值乘以某个数<em class="me"> α </em> ₁，加上两个时间步长前y_{t-2}的值乘以另一个数<em class="me"> α </em> ₂，再加上白噪声值<em class="me"> ϵ_t </em>。为了适应这种类型的模型，我们现在估计₁和₂.的值</p><p id="f77e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">随着我们在模型中加入更多的滞后，或者我们开始包括移动平均、外生或季节项，将自回归项重写为总和将变得有用。(统计学家也使用<a class="ae lh" href="https://otexts.com/fpp2/backshift.html" rel="noopener ugc nofollow" target="_blank">后移符号</a>，但是我们将坚持使用总和法来避免学习曲线。)这里是AR(p)模型的一般形式，其中<em class="me"> p </em>是滞后的数量。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/eccf305fa7580fe5d2ee2d38e29ad2dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8If_nqKxNbzd3JPZAXICVg.png"/></div></div></figure><p id="be89" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的等式简单地说“我们的当前值y_t等于我们的常数<em class="me"> c </em>，加上每个滞后y_{t-n}乘以它的系数<em class="me"> α_n </em>，加上<em class="me"> ϵ_t </em>。”不管<em class="me"> p </em>是1还是100，我们都可以使用相同的等式……尽管如果你的模型有100个滞后，你可能需要考虑加入我们将要描述的下一个术语:移动平均线。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/7546f3f6f50c3fecf4a4547e4122b205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kXUDl2gY5dCqgtqP"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@hiveboxx?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> HiveBoxx </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="0088" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">马:移动平均线</h1><p id="422b" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">ARIMA模型的第二个主要部分是<strong class="lk jd">移动平均线</strong>部分。这个分量<em class="me">不是</em>滚动平均值，而是<em class="me">白噪声</em>中的滞后。</p><p id="0358" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ϵ_t术语，以前是我们添加到预测中的一些容易被遗忘的噪音，现在占据了中心舞台。在MA(1)模型中，我们对y_t的预测是我们的常数加上带有乘数<em class="me"> θ </em> ₁的<em class="me">先前</em>白噪声项ϵ_{t−1}，加上<em class="me">当前</em>白噪声项<em class="me"> ϵ_t </em>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/4365bf59b39c95c2368f5cc1235043a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vrg0FP6PitMbKKq4lBQPOw.png"/></div></div></figure><p id="04e3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如前所述，我们可以用下面的总结来简明地描述MA(q)模型:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/a7eb209e16f63573d5df395a5d6fef6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Xu-T1K96Z8wlU2Gnm9fWw.png"/></div></div></figure><p id="4952" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里有三个MA(1)时间序列，它们的值随着ϵ_{t−1}.的乘数<em class="me"> θ </em> ₁的变化而变化如果你在看这些的时候没有经历一个“啊哈”的时刻，不要难过；它们应该看起来相当类似于白噪声。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pa"><img src="../Images/96c19d680d828edd5fb468a64dcd9693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JBNnppkUoHDNrrhohfA7Wg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="e0a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">移动平均过程远没有自回归过程直观——什么时间序列不记得它过去的行为，但记得它以前的随机噪声？然而，数量惊人的<a class="ae lh" href="https://stats.stackexchange.com/questions/45026/real-life-examples-of-moving-average-processes" rel="noopener ugc nofollow" target="_blank">现实世界时间序列<em class="me">是</em>移动平均过程</a>，从商店商品和销售的错位，应对自然灾害的电池购买，以及低通滤波器，如汽车音响上的高音旋钮。</p><p id="fab3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里有一个愚蠢但有用的<a class="ae lh" href="https://www.youtube.com/watch?v=voryLhxiPzE" rel="noopener ugc nofollow" target="_blank">错位例子</a>来自<a class="ae lh" href="https://www.youtube.com/channel/UCUcpVoi5KkJmnE3bvEhHR0Q" rel="noopener ugc nofollow" target="_blank"> YouTuber ritvikmath </a>。想象一下，在一个重复的聚会上，你被分配给每位客人一个纸杯蛋糕。y_t是应该带多少个纸杯蛋糕。你预计大约有10个人，所以你从带10个纸杯蛋糕开始。当你到达时，你会注意到你供应过多或过少的纸杯蛋糕(<em class="me"> ϵ_t) </em>。</p><p id="376e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在接下来的会议中，你带来了10个纸杯蛋糕<em class="me">，这10个蛋糕是根据与上一次会议</em>(现在的ϵ_{t−1})的差异乘以某个系数(<em class="me"> θ </em> ₁).)而调整的你想把你上次掉的蛋糕数量变成负数，所以你设置了<em class="me"> θ </em> ₁=−1.例如，如果你上次少了两个(<em class="me">ϵ</em>_ { t1 } = 2)，你应该多带两个。</p><p id="39f5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">出席的客人数量基本上是随机的，但是<strong class="lk jd">客人会记得上次会议的蛋糕数量</strong>——如果蛋糕太多，就会有更多的客人出席，如果蛋糕太少，就会有更少的客人出席。</p><p id="4f9c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，我们可以在每次会议中模拟正确数量的纸杯蛋糕，如下所示。蓝色部分是你带去参加会议的蛋糕数量，橙色部分是我们带去的蛋糕数量和出席人数之间的差额。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pb"><img src="../Images/0fb51f4946a125cb98737bf07564dc85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fztinZncCar282NOtWNYDg.png"/></div></div></figure><p id="2810" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里要注意的是<strong class="lk jd">这个时间序列并不关心自己的历史</strong>(纸杯蛋糕的正确数量)；它只受到短暂记忆的<strong class="lk jd">外部随机噪声的影响</strong>(纸杯蛋糕的数量和参加聚会的人数之差)。因此，这是一个移动平均过程。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/71ffed4e466254dfc5677a5da32461d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oyYt0QGaPMp5oiLv"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">布鲁克·拉克在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="e5d3" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">把它放在一起</h1><p id="6731" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">在讨论了AR和MA过程之后，我们有了构建ARMA和ARIMA模型所需要的一切。正如您将看到的，这些更复杂的模型只是由AR和MA组件相加而成。</p><h2 id="acb0" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">ARMA:自回归移动平均</h2><p id="d050" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">虽然许多时间序列可以归结为纯自回归或纯移动平均过程，但您通常需要结合AR和MA分量来成功描述您的数据。这些<strong class="lk jd"> ARMA </strong>过程可以用以下等式建模:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pd"><img src="../Images/42fd6d73246c38c7fc7325d3e7c1f702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ndF4nDoVFkP3tkS0-0Ozg.png"/></div></div></figure><p id="561c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ARMA方程简单地说明了当前时间步长的值是一个常数加上自回归滞后及其乘数之和，加上移动平均滞后及其乘数之和，再加上一些白噪声。这个方程是广泛应用的基础，从<a class="ae lh" href="https://www.koreascience.or.kr/article/JAKO201315463253802.pdf" rel="noopener ugc nofollow" target="_blank">建模风速</a>，<a class="ae lh" href="https://link.springer.com/article/10.1007/s00180-014-0543-9" rel="noopener ugc nofollow" target="_blank">预测财务回报</a>，甚至<a class="ae lh" href="https://projecteuclid.org/journals/brazilian-journal-of-probability-and-statistics/volume-23/issue-2/Spatial-ARMA-models-and-its-applications-to-image-filtering/10.1214/08-BJPS019.full" rel="noopener ugc nofollow" target="_blank">过滤图像</a>。</p><p id="9166" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是四个ARMA(1，1)时间序列。与上面的MA(1)图一样，很难查看下面的任何时间序列并直观地了解参数值，甚至很难知道它们是ARMA过程而不是AR或MA。我们现在所处的位置是，我们的时间序列已经变得太复杂，无法通过肉眼观察原始数据来直觉判断模型的类型或参数。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/df300dffbdaa070bf7bd159a89692af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VNhQyUpoXcHddmoX8gVfeA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="a5c4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是没关系。接下来，我们将开始使用<a class="ae lh" href="https://en.wikipedia.org/wiki/Akaike_information_criterion" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> AIC </strong> </a>来确定哪个模型最能描述我们的数据，是AR、MA还是ARMA模型，以及每个组件的最佳滞后数。我们将在这篇文章的最后讨论这个过程，但同时让我们讨论SARIMAX模型的剩余部分。</p><h2 id="133c" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">ARIMA:自回归综合移动平均线</h2><p id="131a" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">我们来到了这篇博文的同名主题:ARIMA模式。尽管如此，我们实际上会看到ARIMA模型只是一个ARMA模型，由模型而不是用户来处理预处理步骤。</p><p id="33c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们从ARIMA(1，1，0)模型的等式开始。(1，1，0)意味着我们有一个自回归滞后，我们对数据进行一次差分，我们没有移动平均项。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/484048f0c5d44ed51f701f4569967690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5E88JB1iz_c6hOSHgdrxA.png"/></div></div></figure><p id="454a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">注意我们是如何从对y_t建模到对y_t和y_{t-1}之间的<em class="me">变化</em>建模的。这样，我们的自回归项，以前是<em class="me"> α </em> ₁ <em class="me"> (y_{t-1}) </em>，现在是<em class="me">α</em>₁(<em class="me">y _ { t-1 }-</em>y _ { t-2 })。</p><p id="0d16" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">换句话说，<strong class="lk jd">ARIMA模型就是<em class="me">差分</em>时间序列的ARMA模型。</strong>就是这样！如果我们用d_t代替y_t，代表我们的差分数据，那么我们就又有了ARMA方程。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/d09d61df35d416273c4b5dca882f6721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wc9haFqTgYxl4lcCoGR1Qg.png"/></div></div></figure><p id="cef2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以自己进行差分，但是如果<em class="me"> d </em>大于1，就会变得很麻烦，大多数统计软件包会为我们处理差分。例如，这里有一个Python演示，展示了对<em class="me">原始</em>数据的ARIMA(1，1，1)模型和对<em class="me">差分</em>数据的ARMA(1，1)模型的模型系数是如何相等的。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ph pi l"/></div></figure><p id="eb09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面，我们首先使用<code class="fe og oh oi oj b">arma_generate_sample</code>函数来模拟具有指定<em class="me"> α </em>和<em class="me"> θ </em>参数的ARMA过程的数据。然后，我们使用<code class="fe og oh oi oj b">ARIMA</code>函数来拟合原始数据的ARIMA模型和差分数据的ARMA数据。最后，我们比较了两个模型的估计参数，表明它们是相等的。</p><p id="26a0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是对原始数据的ARIMA(1，2，1)模型与对经过两次差分的数据的ARMA(1，1)模型的相同概念证明。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ph pi l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/1e8be2530a1954f96da194dac08bef7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5oKTpoo5e35fiWbr"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">克里斯·劳顿在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="226b" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">附加组件</h1><p id="20f2" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">有了AR、MA和I组件，我们就可以分析和预测大范围的时间序列。但是有两个额外的因素将真正把我们的预测提升到下一个水平:<strong class="lk jd">季节性</strong>和<strong class="lk jd">外部变量。在阅读一些代码并结束这篇文章之前，让我们简单地介绍一下。</strong></p><h2 id="7de6" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">学生:季节性</h2><p id="c70b" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">顾名思义，季节性是指<em class="me">在数据中以固定频率</em>重复的模式:每天、每两周、每四个月等重复的模式。例如，电影院的门票销售往往与上周的销售相关，而房屋销售和气温往往与前一年的数值相关。</p><p id="57ce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">季节性违背了ARIMA模型的平稳性假设，所以我们需要对其进行控制。我们可以通过使用季节性ARIMA模型来实现。这些模型有着广泛的应用，从预测巴西的登革热病例到估计台湾的机械工业产出或希腊的发电量。</p><p id="7321" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是SARMA模型的通用等式，季节性因素以橙色突出显示。(对于SARIMA，用差异数据d_t替换y_t。)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pk"><img src="../Images/3afe5f034ced286904b909eb69788c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*feNkO5nl2ET5EXZ2vG8mQg.png"/></div></div></figure><p id="3d8a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">请注意，季节性和非季节性成分看起来非常相似。这是因为<strong class="lk jd">季节性模型在滞后<em class="me">偏移</em>一定数量的滞后<em class="me"> s </em>，即我们季节性的频率上，符合<em class="me">一组额外的</em>自回归和移动平均成分</strong>。</p><p id="2491" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，对于具有强周季节性的每日电子商务利润模型，我们设置<em class="me"> s </em> = 7。这意味着我们将使用一周前的值来帮助预测明天会发生什么。这个过程可以用如下的SARMA(0,0)(1,0)₇模型来建模。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pl"><img src="../Images/e8162787b19a5c8fde052a65a323872d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NqqTxLZemCQ24tdF83Ykw.png"/></div></div></figure><p id="f0f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但对于现实世界的时间序列，即使是高度季节性的数据也可能更好地用一两个非季节性成分建模:季节性成分可能会捕捉到<em class="me">长期模式</em>，而非季节性成分会调整我们对<em class="me">短期变化</em>的预测。我们可以修改我们的模型，加入一个非季节性的自回归项，例如，把它变成一个SARMA(1,0)(1,0)₇模型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pm"><img src="../Images/8eb8ebbdd03fb1c48d89c5e64d4c145e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v1eq2VStcEEhszuuKiYO3A.png"/></div></div></figure><p id="9234" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">SARIMA模型还允许我们根据季节频率来区分我们的数据，以及任何非季节差异。一个<a class="ae lh" href="https://people.duke.edu/~rnau/seasarim.htm#model1" rel="noopener ugc nofollow" target="_blank">常见的季节性ARIMA模型</a>是SARIMA(0，1，1)(0，1，1)，下面我们用<em class="me"> s </em> = 7来表示。滞后在等式的右侧，以便于阅读。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pn"><img src="../Images/181327354aa1a0108eab535b8af437d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F167Guwkt9uSzzdinwuTWA.png"/></div></div></figure><h1 id="abb1" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">x:外来变量</h1><p id="fb44" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">到目前为止，我们描述的所有组件都是时间序列本身的特性。我们的最后一个组成部分，<strong class="lk jd">外生变量，</strong>通过考虑<em class="me">外部数据</em>对我们时间序列的影响来抵消这一趋势。</p><p id="8fd7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这听起来不应该太吓人——<strong class="lk jd">外生变量只是任何非时间序列模型中的<em class="me">特征</em>。例如，在一个预测学生考试成绩的模型中，一个标准的线性回归会使用像<em class="me">学习小时数</em>和<em class="me">睡眠小时数</em>这样的特征。与此同时，ARIMAX模型还将包括<strong class="lk jd"><em class="me"/></strong>内生特征，如学生以前的<em class="me"> n </em>考试成绩。</strong></p><p id="1c01" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ARIMAX模型中其他一些外部变量的例子包括<a class="ae lh" href="https://www.mathworks.com/help/econ/arima-model-including-exogenous-regressors.html" rel="noopener ugc nofollow" target="_blank">油价对美国汇率</a>的影响、<a class="ae lh" href="https://www.mdpi.com/1996-1073/7/5/2938" rel="noopener ugc nofollow" target="_blank">室外温度对电力需求</a>的影响，以及<a class="ae lh" href="https://www.soa.org/globalassets/assets/files/research/projects/research-2013-arima-arimax-ben-appl-rates.pdf" rel="noopener ugc nofollow" target="_blank">关于伤残保险索赔的经济指标</a>。</p><p id="6ced" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是我们完整的SARIMAX方程的样子。外来术语用绿色突出显示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi po"><img src="../Images/b745eef1e08eff80b3f0248a6bd93416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdyr2r-FSIncbHXQTbpZaQ.png"/></div></div></figure><p id="9bee" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">请注意，外部因素的影响已经<em class="me">间接地</em>包含在我们的时间序列的历史中。例如，即使我们在美国汇率模型中不包括石油价格项，石油的影响也会反映在汇率的自回归或移动平均成分中。任何真实世界的时间序列都是几十个或几百个外来影响的结果，所以为什么要用外来术语呢？</p><p id="4364" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">虽然在我们的模型中，外部效应是在内生项中间接表示的，但直接测量这些影响仍然更有效。例如，我们的预测将对外部因素的变化做出更快的反应，而不是需要等待它在滞后中反映出来。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pp"><img src="../Images/98cd855f0114e1802887ca57a6683379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5rGS8ZtmrlFdernB"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Jonathan Chng 在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="44f4" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">Python中的时间序列</h1><p id="f523" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">到目前为止，我们已经介绍了时间序列模型的<a class="ae lh" href="http://localhost:4000/ARIMA-deep-dive/#ar-autoregression" rel="noopener ugc nofollow" target="_blank">自回归</a>、<a class="ae lh" href="http://localhost:4000/ARIMA-deep-dive/#ma-moving-average" rel="noopener ugc nofollow" target="_blank">移动平均</a>、<a class="ae lh" href="http://localhost:4000/ARIMA-deep-dive/#arima-autoregressive-integrated-moving-average" rel="noopener ugc nofollow" target="_blank">综合</a>、<a class="ae lh" href="http://localhost:4000/ARIMA-deep-dive/#s-seasonality" rel="noopener ugc nofollow" target="_blank">季节性</a>和<a class="ae lh" href="http://localhost:4000/ARIMA-deep-dive/#x-exogeneous-variables" rel="noopener ugc nofollow" target="_blank">外生</a>成分背后的理论和数学。只需一点点努力，我们可能就能为SARIMAX模型填写方程，并手工生成预测。但是我们如何找到模型的参数值呢？</p><p id="c12e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为此，我们将使用Python的<code class="fe og oh oi oj b">statsmodels</code>库。我们将首先拟合一个模型，其中我们提前知道我们的模型阶应该是什么，例如一个自回归滞后和两个移动平均滞后。在下一节中，我们将展示如何使用<code class="fe og oh oi oj b">pmdarima</code>库来扫描潜在的模型订单，并为您的数据找到最佳匹配。</p><h2 id="f767" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">拟合模型</h2><p id="5512" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">假设我们是某电子商务公司的数据科学家，我们想预测接下来几周的销售额。我们有去年每日销售额的CSV，以及每天的广告支出。我们知道，我们希望我们的模型有一个非季节性的ARIMA(1，1，1)成分，一个为期7天的季节性AR(1)成分，以及一个广告支出的外部变量。</p><p id="3a96" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">换句话说，我们知道我们想要一个SARIMAX(1,1,1)(1,0,0)₇模式。下面是我们如何在Python中实现这样一个模型。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ph pi l"/></div></figure><p id="54c2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">就是这样！我们用<code class="fe og oh oi oj b">SARIMAX</code>指定我们的模型，然后用<code class="fe og oh oi oj b">.fit</code>方法拟合它(必须保存到一个单独的变量中)。然后我们可以用<code class="fe og oh oi oj b">summary</code>方法得到一个<a class="ae lh" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>风格的模型概要。<code class="fe og oh oi oj b">predict</code>方法让我们将模型<a class="ae lh" href="https://stats.stackexchange.com/questions/260899/what-is-difference-between-in-sample-and-out-of-sample-forecasts" rel="noopener ugc nofollow" target="_blank">样本内预测</a>与实际值进行比较，而<code class="fe og oh oi oj b">forecast</code>方法为未来<code class="fe og oh oi oj b">n</code>步骤生成预测。</p><h2 id="e31d" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">比较模型拟合</h2><p id="a1a3" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">这些都很好，但是如果我们事先不知道我们的模型订单应该是什么呢？对于简单的AR或MA模型，我们可以分别查看<a class="ae lh" href="http://localhost:4000/ARIMA-deep-dive/#partial-autocorrelation" rel="noopener ugc nofollow" target="_blank">部分自相关</a>或<a class="ae lh" href="http://localhost:4000/ARIMA-deep-dive/#autocorrelation" rel="noopener ugc nofollow" target="_blank">自相关图</a>。但是对于更复杂的模型，我们需要执行<strong class="lk jd">模型比较。</strong></p><p id="ef6c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们通常与AIC进行模型比较，以衡量我们的模型与数据的吻合程度。AIC通过惩罚更复杂的模型来防止过度拟合——是的，随着我们添加更多的项，模型的准确性不可避免地会提高，但这种提高足以证明添加另一项是合理的吗？</p><p id="cc6d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了确定最佳模型，我们对各种模型订单执行参数扫描，然后选择具有最低AIC的模型。(如果我们特别担心过度拟合，我们可以使用更严格的<a class="ae lh" href="https://en.wikipedia.org/wiki/Bayesian_information_criterion" rel="noopener ugc nofollow" target="_blank"> BIC </a>来代替。)</p><p id="3ed3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以依靠<a class="ae lh" href="https://pypi.org/project/pmdarima/" rel="noopener ugc nofollow" target="_blank"> pmdarima </a>库中的<code class="fe og oh oi oj b">auto_arima</code>函数来完成繁重的工作，而不需要自己编写一堆<code class="fe og oh oi oj b">for</code>循环。我们只需输入AR、I和MA元件的初始阶数估计值，以及我们会考虑的每个元件的最高阶数。对于季节性模型，我们还需要传递季节性的频率，以及季节性AR、I和MA分量的估计值。</p><p id="ac82" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">从本文开始，我们将在标准普尔500每日收盘价中找出最优的SARIMA模型。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ph pi l"/></div></figure><p id="c24f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的代码说，SARIMA(2,1,0)(1,0,0)₇模型最适合标准普尔500指数过去五年的数据…有一些重要的警告！在你把你一生的积蓄赌在这个模型的预测上之前，我们应该记住，尽管有一个方便的参数扫描，我们仍然可以从建模这个数据中挤出很多准确性。</p><p id="411e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我们没有以任何方式对数据进行预处理，例如扫描异常值或插入任何间隙。类似地，我们没有检查任何转换是否会使数据更容易预测，例如采用百分比回报或平方根。</p><p id="5764" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我们的季节性频率7有点无中生有——可能有一个季节性，如每月、每季度或每年，这大大提高了我们的模型性能。诸如此类的考虑对于发布不会让你尴尬的预测是必不可少的！</p><p id="9605" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">(还有一个提醒，这个帖子不是投资建议！；-))</p><h2 id="b04f" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">为什么不是深度学习？</h2><p id="f4e1" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">还有一个我们还没有涉及的概念，它为这篇文章提供了一个重要的视角。经典统计学是伟大的，但在机器学习的时代，ARIMA是过去的遗物吗？当像<a class="ae lh" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">脸书的Prophet </a>和<a class="ae lh" href="https://engineering.linkedin.com/blog/2021/greykite--a-flexible--intuitive--and-fast-forecasting-library" rel="noopener ugc nofollow" target="_blank"> LinkedIn的Greykite </a>这样的开源库生成的预测比精心打磨的SARIMAX模型更准确时，为什么还要费心去理解早先那个移动平均纸杯蛋糕的例子呢？</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pq"><img src="../Images/c096dfdbf9511dd1b67c1fc7491bbf6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ES8qXTW9CU0l0w2qySwRA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="001c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个问题触及了机器学习和统计学之间的一个重要区别，最终是准确性和可解释性之间的权衡。要选择使用哪种工具，你必须明白你的目标是<strong class="lk jd">生成最准确的预测</strong>，还是<strong class="lk jd">理解数据中潜在的生成过程。</strong></p><p id="550e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当你想最大限度地提高准确性，并愿意牺牲一些可解释性时，机器学习——尤其是深度学习——是首选工具。<a class="ae lh" href="https://en.wikipedia.org/wiki/Recurrent_neural_network" rel="noopener ugc nofollow" target="_blank">例如，递归神经网络</a>是一种强大的预测工具，但解释<em class="me">网络如何生成预测需要搜索向前和向后反馈的隐藏层的混乱——这是一项艰巨的任务。如果你公司的高层领导正在根据你的预测权衡一个重大的商业决策，他们不太可能接受一个甚至你都不太明白它是如何运作的模型。</em></p><p id="5afe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，ARIMA模型可能是一个有吸引力的替代方案，即使其预测能力较低。通过具体了解时间序列中的值如何相互关联，就更容易对时间序列本身建立直觉，例如今天的值对明天的影响有多大、季节性的循环等等。</p><p id="69d0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">正确的工具——机器学习或经典统计学——最终取决于您分析的更广泛的业务背景。</strong>(通过使用曲线拟合模型的线性组合，Prophet实际上位于这两个极端之间的<a class="ae lh" href="https://peerj.com/preprints/3190/#" rel="noopener ugc nofollow" target="_blank">。)</a></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pr"><img src="../Images/2ab10d366813b97a8398c5123bd467f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AsqLqQZhlGDba4nz"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">菲德尔·费尔南多在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="6d40" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">结论</h1><p id="86d3" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">这篇文章深入探讨了ARIMA时间序列预测模型家族。我们从预测模型的一些基础理论开始，包括自相关和平稳性。然后，我们建立了简单的自回归模型，其中时间序列的现值是一些先前值的加权和。然后，我们研究了移动平均过程，这是一种不直观但常见的现象，时间序列会记住历史外部噪声。</p><p id="1009" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将这些成分放在一起形成ARMA模型，然后展示了ARIMA模型如何简单地成为我们差分数据的ARMA模型。然后，我们展示了如何通过添加一组季节性自回归和移动平均成分来解释季节性，以及直接测量外部因素对我们数据的影响。</p><p id="48ef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我们用Python训练了一个SARIMAX模型，并进行了参数扫描，为我们的标准普尔500收盘价数据集确定了一个潜在的模型订单。然后我们讨论了为什么ARIMA仍然是一个有用的选择，即使有更精确的方法存在。</p><p id="23ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">时间序列预测是一个巨大的领域，我们可以用模型选择和公式的细微差别来填充更多的博客帖子。但是不管你的时间序列知识如何，我希望它继续上升。</p><p id="f44f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最好，<br/>马特</p><h1 id="4614" class="mk ml it bd mm mn mo mp mq mr ms mt mu ki mv kj mw kl mx km my ko mz kp na nb bi translated">脚注</h1><h2 id="3b28" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">1.介绍</h2><p id="c7e5" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">“我们永远无法完美预测未来”听起来显而易见，但其背后的推理实际上很吸引人。在<a class="ae lh" href="https://www.ynharari.com/book/sapiens-2/" rel="noopener ugc nofollow" target="_blank"> <em class="me">智人</em> </a>一书中，尤瓦尔·诺亚·哈拉里谈到了<a class="ae lh" href="https://www.goodreads.com/quotes/7426402-history-cannot-be-explained-deterministically-and-it-cannot-be-predicted" rel="noopener ugc nofollow" target="_blank">两种类型的混沌系统</a>。第一种是混沌，它对预测没有反应，比如天气。天气是通过无数空气分子的非线性相互作用出现的——这非常难以预测，但我们可以使用越来越强的计算机模拟来逐步提高我们的准确性。</p><p id="979c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">与此同时，第二类混沌系统<em class="me"/>对关于它的预测做出反应。历史、政治和市场都是这种系统的例子。例如，如果我们完美地预测明天的石油价格会比今天高，那么购买石油的热潮将会改变今天和明天的石油价格，<em class="me">导致预测变得不准确</em>。</p><p id="7a33" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">作为数据科学家，我们习惯于认为我们的分析与我们试图理解的过程是分开的。但是在我们的预测实际上影响结果的情况下，我们几乎没有希望完美地预测未来…除非我们让我们的猜测保持安静。</p><h2 id="20a5" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">2.偏自相关</h2><p id="1279" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">自相关图中滞后<em class="me"> n </em>处的急剧下降表示<strong class="lk jd"> MA(n) </strong>过程，而偏相关图中的明显下降表示<strong class="lk jd"> AR(n) </strong>过程。但是，除非您的数据集确实非常庞大，否则您很可能最终会进行参数扫描，以确定最能描述您的数据的模型的参数。如果两个自相关图都消失了，你看到的是ARMA或ARIMA过程，无论如何都需要进行参数扫描。</p><h2 id="79bd" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">3.平稳性</h2><p id="c2d8" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">我陷入了一个长长的兔子洞，试图理解平稳性假设的真正含义。在平稳过程与非平稳过程的对比图中，我使用一个有噪声的正弦波作为平稳过程的例子。这个数据集<em class="me">确实</em>通过了<a class="ae lh" href="https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test" rel="noopener ugc nofollow" target="_blank">增强的Dicky-Fuller测试</a>，但是如果你将数据扩展到1000个样本，ADF测试不再说时间序列是平稳的。</p><p id="40e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是因为ADF本质上衡量的是向均值的回归——非平稳过程没有漂移的问题，之前的滞后不提供相关信息。同时，平稳过程的滞后值<em class="me">在预测下一个值时提供相关信息。</em></p><h2 id="a344" class="ns ml it bd mm nt nu dn mq nv nw dp mu lr nx ny mw lv nz oa my lz ob oc na iz bi translated">4.AR(0):白噪声</h2><p id="eb48" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr od lt lu lv oe lx ly lz of mb mc md im bi translated">在我们的示例中，<em class="me"> ϵ_t </em>值是从正态分布中采样的，因此这是<strong class="lk jd">高斯白噪声。</strong> <a class="ae lh" href="https://ionides.github.io/531w20/03/notes03.pdf" rel="noopener ugc nofollow" target="_blank">我们可以很容易地使用另一种分布</a>来生成我们的值，比如均匀分布、二进制分布或正弦分布。</p></div></div>    
</body>
</html>