<html>
<head>
<title>Applying Machine Learning to Tic-Tac-Toe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将机器学习应用于井字游戏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/applying-machine-learning-to-tic-tac-toe-47d954671c73?source=collection_archive---------20-----------------------#2021-09-04">https://towardsdatascience.com/applying-machine-learning-to-tic-tac-toe-47d954671c73?source=collection_archive---------20-----------------------#2021-09-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6574" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我创建了一个程序，通过一段时间的模拟来学习如何玩井字游戏</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/8ee83386e8965593f152c05c22165139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*F4tfEXyLjklrMkXwMNpF0g.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><h2 id="a664" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">简介:</h2><p id="cb0c" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在制作了一个可以玩Connect 4的MATLAB程序后，我决定下一步是设计一个可以学习如何玩井字游戏的程序。毕竟它只是Connect 4的简化版，所以机器学习的时间应该会更少，并增加它的胜率。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="572a" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">井字游戏机V1.0</h2><p id="6b09" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">它始于两个完全随机的井字游戏发生器互相游戏。一个游戏结束后，其中一台机器从游戏中收集所有决策数据，并将其放入数据库。如果这步棋赢了，这步棋得3分。如果移动导致损失，它失去1点。平局比赛的结果是加1分。在100，000场游戏中，每一个独特的场景都记录在它的数据库中，以及它在那之后选择的移动。在下一局游戏中，得分较高的棋更有可能被选中，而得分较低的棋则不太可能被选中。</p><p id="d62b" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">这个想法是，在几千场比赛中，赢或平的棋会得到更多的分数，更有可能被选中。由此产生了一个包含2000多种独特游戏场景的数据库，每一步都有不同的权重。下面是100，000场比赛中数据库中独特场景的总量图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e44dc1199e50ce2a0735e637e86729ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VGOedg6rlsMdnUak5ev4YA.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="8a35" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">正如你所看到的，数量收敛于值2，423，在这一点上，机器开始看到重复出现的场景，并为9个可能的移动中的每一个调整权重。</p><p id="f1a0" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">但是在10万场比赛中，TTT-M1的胜率如何呢？下面左边是所有模拟的总胜率，右边是前几千个游戏的放大部分。</p><div class="kj kk kl km gt ab cb"><figure class="mw kn mx my mz na nb paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><img src="../Images/f6d9e9e063a402c3dfd05dd6f3912a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*SSOSKMM5nvJOCo3-x3qAFw.jpeg"/></div></figure><figure class="mw kn ng my mz na nb paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><img src="../Images/46d8214eabc2a9ac7ed3325f95f1654f.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*F4tfEXyLjklrMkXwMNpF0g.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk nh di ni nj translated">图片由作者提供</p></figure></div><p id="9e7f" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">由于TTT-M1和它的随机移动对手都是在对游戏一无所知的情况下开始的，所以在前2000场游戏中，胜率波动很大。到了某个时候，它开始下沉，形成一条平滑的线，随着时间的推移慢慢增加。这是因为机器现在已经看到了所有可能的场景，并且现在正在细化每个移动的权重。</p><p id="53e8" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">正是在这一点上，我认为我有一个完整的项目。任何人都不可能打败一台有10万次井字游戏经验的机器。嗯，我想错了。</p><p id="9040" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">事实证明，虽然100，000场游戏很多，但当它与随机移动生成器对战时，它真的没有任何意义。一个真实的人是有直觉的，这是我的机器的对手没有的。因此，击败这台机器是相当容易的，或者至少打平它。这并不意味着机器在阻挡它的对手时没有学到一些技术。它肯定做出了明智的决定，只是没有考虑到一个具有良好逻辑的人类对手。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="8fd8" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">井字游戏机V2.0</h2><p id="1a14" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">解决这个问题的方法很简单。让另一台机器在没有任何游戏逻辑的情况下启动，并让它面对我的井字游戏机器1.0版(TTT-M1)。使用与以前相同的代码，这台新机器(TTT-M2)将学习超过150，000场如何玩井字游戏，但它将学习如何对抗具有相当技能的对手。理论上，TTT-M2应该比TTT-M1更聪明，因为它有成千上万场比赛来暴露它的弱点，同时还能制定新的策略。</p><p id="2398" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">我感兴趣的一个特殊情况是第一步决策。TTT-M1率先行动，我预计它会集中在中间位置，这是最好的。事实上，它更喜欢角落，因为它是起点。这给第二个玩家留下了空档，导致TTT-M1输掉了很多对真人的比赛。我想看看TTT-M2是否会抓住这个弱点，如果轮到它了，就开始瞄准中间的位置。</p><p id="0c98" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">以下是TTT-M2对TTT-M1的学习率:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/6a3a499e39df30eadd11372d1bc02cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HigZrXYs69-JFLH1LW595A.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="b598" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">正如你所看到的，胜率开始时非常低，因为它面对的是一个有一些游戏知识的对手。随着模拟的进行，它了解了TTT-M1的弱点，直到它收敛到0.50左右的胜率。考虑到它没有第一步棋，这是非常好的。</p><p id="548a" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">它还了解到，如果TTT-M1在第一步没有采取中间路线，那么它应该采取它。这证明了一个众所周知的事实，即在井字游戏中，中间点是最好的位置。</p><p id="1612" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">现在我有了一个像样的对手，我开发了TTT-M3。</p><h2 id="9305" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">井字游戏机3.0版</h2><p id="6c1e" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">我的井字游戏机器学习项目的最终演变是TTT-M3。这台机器在150，000场比赛中对阵TTT-M2，学习最佳策略，同时也在最佳数据库中找到当前的漏洞。经过150，000场比赛，结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/73dd43f87138a092ecffc70567f8fc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pd9-_Ile_v-kJYMHIeJT0A.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="f51e" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">这说明这个井字游戏机器学习项目的最后一代一开始非常弱。在最初的1000场比赛中，它的胜率徘徊在25%左右，但后来开始腾飞，达到了74%左右。这是对一个同样有井字游戏逻辑的对手(TTT-M2)。下面是我和TTT-M3博弈的一个例子(“2”是TTT-M3的棋，“1”是我的棋):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/54c69394a4ccee0073ac4dedc2cbc8ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*CtVvHUrDRvayoQNYfHaX2A.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="c66b" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">我马上注意到它已经发展出一种策略来引诱我选择中心点。一旦我这样做了，每次都是平局，在计算机看来，这是一个好结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/cf890f06304c0f7f3b45e2ee80e7cbd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/1*NzC4yKF7eYg1fgoZhY2TRA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="dd35" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">我扮演了中间的角色，落入了圈套。然后，它设置我采取左上角。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/5fd50268030f2ad03927ea751a87b66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*yAAuVuNRqLnX-vSO189tfw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="b096" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">在顶上挡住它的水平尝试后，它又把我放在最右边的一栏。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e138e7f0b1cf819cf9be8ac52f91f270.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*qnHs1U13E-GuL4Nmb7-M6w.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="7a79" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">这是第二排第一列的下一步棋，决定了这场比赛的命运。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d12fed50745c61ed479f9f989668e583.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*1NUQBT6aOyfgN_4G_z25lQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="dddb" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">结论:</h2><p id="658e" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">经过3代的进化，这个程序已经发展出一种策略来建立联系，阻止对手，并争取胜利。总的来说，这个项目是成功的，因为创建了一个程序，可以学习新的技能，并在与其他对手玩井字游戏时变得更好。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="4445" class="pw-post-body-paragraph lq lr it ls b lt mq ju lv lw mr jx ly ld ms ma mb lh mt md me ll mu mg mh mi im bi translated">如果你对这类内容感兴趣，我有一些基于棋盘游戏和数据科学的文章:</p><ul class=""><li id="5b4d" class="np nq it ls b lt mq lw mr ld nr lh ns ll nt mi nu nv nw nx bi translated"><a class="ae ny" rel="noopener" target="_blank" href="/simulating-monopoly-finding-the-best-properties-using-matlab-130fe557b1ae">模拟垄断</a></li><li id="c080" class="np nq it ls b lt nz lw oa ld ob lh oc ll od mi nu nv nw nx bi translated"><a class="ae ny" rel="noopener" target="_blank" href="/i-taught-a-machine-how-to-play-connect-4-df261da4e23f">教机器玩Connect 4 </a></li><li id="0ba8" class="np nq it ls b lt nz lw oa ld ob lh oc ll od mi nu nv nw nx bi translated"><a class="ae ny" href="https://medium.com/codex/the-best-and-worst-catan-board-setups-989df4ba550a" rel="noopener">最佳和最差卡坦板设置</a></li></ul></div></div>    
</body>
</html>