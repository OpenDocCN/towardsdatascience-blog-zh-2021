<html>
<head>
<title>How I Built a Machine Learning Playground with Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用Streamlit建立一个机器学习平台</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-built-a-machine-learning-playground-with-streamlit-3cddb7368ba9?source=collection_archive---------31-----------------------#2021-04-07">https://towardsdatascience.com/how-i-built-a-machine-learning-playground-with-streamlit-3cddb7368ba9?source=collection_archive---------31-----------------------#2021-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4345" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从浏览器中修改模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/95bbad1c93907a359def1af2c1ad4e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-6fkhRw8MM8muXj4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@welipower?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">动力赖</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="c0b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经在工作中使用<a class="ae ky" href="http://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>几个星期了，我必须说这是一个<strong class="lb iu">神奇的工具。将您的ML代码作为原型进行运输和部署从未如此简单。</strong></p><p id="53f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在对这个库进行实验时，我决定用它来创建一个附带项目，从浏览器上玩机器学习模型，这纯粹是出于教育目的，也是为了让机器学习经验较少的人熟悉模型。</p><p id="14bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的笔记本上构思设计的两个晚上后，<strong class="lb iu">游乐场</strong>诞生了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/0075cc1061ab56d5f218f3361cc8bd42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/0*34vwLJRa4Wl1FPqk.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者Gif</p></figure><p id="d400" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lw"> PS*:由于我最近开始在Youtube上录制一些教程，你可以观看这个视频，了解更多关于我如何构建和部署这个应用的细节</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者视频</p></figure><p id="46a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lw"> PS**:代码在</em><a class="ae ky" href="https://github.com/ahmedbesbes/playground" rel="noopener ugc nofollow" target="_blank"><em class="lw">Github</em></a><em class="lw">上有。随意派生、克隆它，在本地运行它或者为你的任何项目重新利用它</em></p><p id="c110" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lw">PS * * *:app直播。在这里检查一下</em><a class="ae ky" href="https://share.streamlit.io/ahmedbesbes/playground/main/app.py" rel="noopener ugc nofollow" target="_blank"><em class="lw"/></a><em class="lw">并试用一下。</em></p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="583a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看这个应用程序是怎么回事😉</p><h1 id="6aff" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">什么是游乐场？</h1><p id="a6bd" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">Playground是一个Streamlit应用程序，允许您直接从浏览器中修改机器学习模型。</p><p id="47d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，如果你是数据科学从业者，你绝对应该尝试一下😉</p><p id="ece7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lw">这个app的灵感来源于伟大的张量流</em> <a class="ae ky" href="https://playground.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> <em class="lw">游乐场</em> </a> <em class="lw">。这里唯一的区别是，它解决了经典的机器学习模型。</em></p><h1 id="6df0" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">它是如何工作的？</h1><p id="5c10" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">使用操场很简单</p><p id="0e57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 1 — </strong> 🗂️从预定义的列表中选择并配置数据集。您可以设置:</p><ul class=""><li id="bca3" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">样本数量</li><li id="c0df" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">列车上的噪声和测试数据</li></ul><p id="67b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2— </strong> ⚙️您选择一个模型并设置其超参数。你可以从逻辑回归、决策树、随机森林、梯度推进、神经网络、朴素贝叶斯、KNNs和SVM中选择一个模型</p><p id="f8b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3 — </strong>📉该应用程序会自动显示以下结果:</p><ul class=""><li id="2ef9" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">训练和测试数据模型的决策边界</li><li id="0f77" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">训练和测试数据的性能指标(准确性和F1分数)</li><li id="8c55" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">模型的训练时间</li><li id="58bc" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">基于数据集定义和模型超参数生成python脚本以再现模型训练</li></ul><p id="3b30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 4 — </strong>对于每种型号，Playground都提供了一个官方文档的链接以及一个技巧汇编列表</p><p id="872c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">奖励点</strong>:该应用还提供了通过添加多项式特征来执行特征工程的能力。<strong class="lb iu">这被证明有助于线性模型，如非线性问题的逻辑回归。</strong></p><h1 id="51eb" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">你能从游乐场学到什么？</h1><p id="61c6" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">如果你是机器学习的新手，玩这个应用可能会(并且希望😄)让你熟悉基本概念，帮助你建立第一直觉。它不会取代教科书:它只是为了补充你的知识。就这样吧。</p><h2 id="b66a" class="nr mh it bd mi ns nt dn mm nu nv dp mq li nw nx ms lm ny nz mu lq oa ob mw oc bi translated">1.决策边界将(部分地)告诉你模型是如何运作的</h2><p id="50d6" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">通过检查决策边界，您将对每个模型的工作方式有更多的了解。出于教育目的，playground将处理仅具有2个要素的数据集(但是在降维后，可以在多维数据集上获得相同的结果)</p><p id="d4e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您将看到逻辑回归用一条线(或一般情况下的超平面)分隔数据</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/059c5a5235b817c296c97dabe7811117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G6D5eTfAakLaV7LB.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线性回归—作者图片</p></figure><p id="d568" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">而决策树根据特征值的连续条件对数据进行分类，其决策边界由水平线和垂直线组成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/af3abe9e6e0622963fc6f32f0e402c3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*afIfIuE_h9EuhnUV.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">决策树—作者图片</p></figure><p id="cfbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有趣的是，随机森林是多个决策树的集合，其决策边界看起来与决策树相似，但更平滑:这是随机森林使用的投票机制的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/f9ebd0215d8c395d5c0c403f07ea8844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JeoOvU7NxX0_xYzB.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">随机森林——作者图片</p></figure><h2 id="40bf" class="nr mh it bd mi ns nt dn mm nu nv dp mq li nw nx ms lm ny nz mu lq oa ob mw oc bi translated">2.你会感受到每个型号的速度</h2><p id="0e60" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">给定相同的数据集，您可以比较每个模型的速度，并获得哪个更快的感觉。在前面的图中，逻辑回归和决策树分别花费了<strong class="lb iu"> 0.004 </strong>和<strong class="lb iu"> 0.001 </strong>秒进行训练，而随机森林花费了<strong class="lb iu"> 0.154 </strong>秒。</p><p id="942e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尝试一个神经网络，它有4层，每层100个神经元:花费<strong class="lb iu"> 0.253秒。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/b2b30d2099076429f000be337ad6654e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WluuXAAsUOAyfxIz.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">神经网络——作者图片</p></figure><h2 id="7a74" class="nr mh it bd mi ns nt dn mm nu nv dp mq li nw nx ms lm ny nz mu lq oa ob mw oc bi translated">3.特征工程可以有所帮助</h2><p id="2358" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在月球数据集上使用逻辑回归不会给你一个完美的F1分数，因为它是非线性的。</p><p id="7138" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，通过添加多项式特征来增加维度会有所帮助:当使用逻辑回归时，尝试将多项式次数增加到3，并注意决策边界是如何彻底改变的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/db0f32ab158d4b8c9818e36b7be26877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FWvOYsPf-EqODSq9.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逻辑回归+特征工程—作者图片</p></figure><h2 id="4263" class="nr mh it bd mi ns nt dn mm nu nv dp mq li nw nx ms lm ny nz mu lq oa ob mw oc bi translated">4.一些模型比其他模型对噪声更鲁棒</h2><p id="cf07" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">您可以通过在测试数据上设置更高的噪声来进行实验，<strong class="lb iu">从而使其偏离列车分布。</strong>针对此问题，梯度推进等一些模型比其他模型更稳定。</p><h2 id="cd39" class="nr mh it bd mi ns nt dn mm nu nv dp mq li nw nx ms lm ny nz mu lq oa ob mw oc bi translated">5.尝试不同的超参数组合</h2><p id="6a25" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">学习和验证你的直觉的一个很好的方法是实验，这就是这个应用程序的目的:它允许你修改一系列超参数(树深度、估计器数量、层数等)，并立即看到决策边界、指标以及执行时间的结果。</p><p id="db29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">去试试吧，希望你能从中有所收获！</p><h1 id="5b36" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在本地运行应用程序</h1><p id="41f0" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">要在本地运行这个应用程序，你必须确保你已经用Python 3安装了pip。</p><ul class=""><li id="6920" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">安装管道</li></ul><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="ba31" class="nr mh it oi b gy om on l oo op">pip install pipenv</span></pre><ul class=""><li id="7424" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">进入项目的文件夹并安装依赖项</li></ul><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="fc0b" class="nr mh it oi b gy om on l oo op">pipenv install</span></pre><ul class=""><li id="6ca2" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">运行应用程序</li></ul><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="15e1" class="nr mh it oi b gy om on l oo op">streamlit run app.py</span></pre><p id="6b90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将打开一个本地服务器，您可以通过<a class="ae ky" href="http://localhost:8051" rel="noopener ugc nofollow" target="_blank"> http://localhost:8051 </a>访问该服务器</p><h1 id="6d44" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">代码的结构</h1><p id="7a69" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">代码遵循以下结构:</p><ul class=""><li id="61b8" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><code class="fe oq or os oi b">app.py</code>:启动app的主入口点</li><li id="9195" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><code class="fe oq or os oi b">ui.py</code>一组UI函数，用于显示应用程序的不同组件</li><li id="12f1" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><code class="fe oq or os oi b">functions.py</code>:数据处理、模型训练和绘图功能列表</li><li id="f571" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><code class="fe oq or os oi b">models/</code>:定义每个模型的超参数选择器</li></ul><p id="f9cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，<code class="fe oq or os oi b">ui.py</code>和<code class="fe oq or os oi b">functions.py</code>位于<code class="fe oq or os oi b">utils</code>文件夹内。</p><p id="6df4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想了解代码，推荐看我上面的视频。</p><h1 id="dcb9" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">感谢阅读！🙏</h1><p id="956f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">如果你已经做到了这一步，非常感谢你的阅读！</p><p id="6903" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Playground是开源的，我希望随着时间的推移它会变得更好。因此，如果你想贡献自己的一份力量，请随时打开一个拉取请求或一个问题，如果你想在应用程序中看到一个功能。</p><p id="4e1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我现在能想到的是:</p><ul class=""><li id="cb7c" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">添加其他非线性数据集</li><li id="07ea" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">添加更多型号</li><li id="1974" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">实施复杂的特征工程(正弦特征，交互项？)</li><li id="9a8d" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">实现一个具有降维功能的自定义数据集读取器，这样您就可以检查您的数据</li><li id="a753" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">添加要素重要性图和模型可解释性</li></ul><p id="e161" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是如果你有其他的想法，我很乐意听听。</p></div></div>    
</body>
</html>