<html>
<head>
<title>Introducing Daeploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍Daeploy</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introducing-daeploy-the-tool-to-let-data-scientists-be-data-scientists-5e6ba3e8c6f4?source=collection_archive---------34-----------------------#2021-05-11">https://towardsdatascience.com/introducing-daeploy-the-tool-to-let-data-scientists-be-data-scientists-5e6ba3e8c6f4?source=collection_archive---------34-----------------------#2021-05-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a01f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让数据科学家成为数据科学家的工具！</h2></div><p id="8355" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://vikinganalytics.se/" rel="noopener ugc nofollow" target="_blank"> Viking Analytics </a>是一家位于哥德堡的瑞典公司，提供预测性维护和智能状态监控解决方案。<a class="ae lb" href="https://daeploy.com/" rel="noopener ugc nofollow" target="_blank"> Daeploy </a>是4年多来为行业提供机器学习解决方案的巅峰之作。这就是我们旅行和部署的故事！</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/4d5e946439a75ae6fe264efab8be30f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OlkI8__u4GwzQc3oyOf1Jg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">一个hello world服务，用23行代码实现了REST API、配置和通知！(作者创作)</p></figure><h1 id="41ef" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">面向工业4.0客户端的典型机器学习项目</h1><p id="14bd" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">客户经常带着他们希望通过利用他们的数据和机器学习的力量来缓解的痛点来找我们。一个典型的项目通常从发现阶段开始，在这个阶段，我们一起查看客户数据以理解数据并评估找到解决方案的可能性。</p><p id="cdbf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果初始数据准备情况分析显示出潜力，则概念验证阶段开始，重点是证明解决方案的可行性。这一步选择的工具通常是Jupyter笔记本。</p><p id="78f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">成功的概念验证之后是最小可行产品(MVP)。这就是挑战的开始，因为从数据到应用程序的项目是一项要求很高的任务，需要跨越多个技能集。虽然从数据到概念验证的过程通常是机器学习的过程，但MVP阶段需要广泛的其他技能，如软件开发和DevOps。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mp"><img src="../Images/82917571753664c140d2181903f618fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCXao_IIf5OvklSfMOdVvw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">从数据到应用的旅程(由作者创作)</p></figure><p id="d506" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">理想情况下，一个人需要一个由数据科学家、软件开发人员、DevOps工程师组成的团队，如果有必要，还需要UI/UX来成功完成应用程序之旅。然而，在实践中，数据科学家或ML工程师的任务是将他们的模型和算法转化为应用程序，这是很常见的。</p><h1 id="8487" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">我们的使命:</strong>让数据科学家成为数据科学家！</h1><p id="76ac" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我们希望数据科学家能够专注于他们喜欢做的事情:处理和理解数据、模型训练、模型评估、模型优化，并在产品化和部署他们的解决方案上花费尽可能少的时间和精力。我们确定了需要解决的两个关键问题:</p><h2 id="0565" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">1.添加功能</h2><p id="e356" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">正如“机器学习系统中隐藏的技术债务”这篇著名的文章[1]所示，ML代码通常是ML项目的一小部分。要使ML代码能够可靠地传递其值，需要许多功能。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nc"><img src="../Images/65f34434867752008fcd728cdc543389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01DQcuvQYvTs1OYTMYJ8qg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">受“机器学习系统中隐藏的技术债务”启发的图片[1](作者创作)</p></figure><p id="9899" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">世界各地的数据科学家正花费数天甚至数周的时间向他们的模型添加功能，比如REST API、配置和通知。</p><p id="a363" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这个问题，我们开发了Daeploy软件开发工具包(SDK ),它提供了大量现成的功能。</p><h1 id="bba7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.部署</h1><p id="a543" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">软件部署是将代码转换为在主机上运行的应用程序并使其可供使用的过程。这通常是DevOps工程师的领域。要成功部署解决方案，需要理解诸如访问、安全性和身份验证、代理、SSL证书、CI/CD管道、代码容器化、服务管理等概念。</p><p id="f8be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">潜在部署目标的多样性增加了ML部署的复杂性。目标可以在云上或内部。要在云上部署，必须熟悉各种云提供商、他们的术语以及他们的用户界面。内部部署取决于客户IT及其托管软件解决方案的准备情况。</p><p id="cf35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们利用Daeploy manager来解决部署难题，Daeploy manager是一个docker映像，运行在您应用程序的目标上。目标可以是任何符合以下条件的机器:</p><ol class=""><li id="1fd8" class="nd ne iq kh b ki kj kl km ko nf ks ng kw nh la ni nj nk nl bi translated">能够运行Docker</li><li id="4cdd" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">允许访问Docker守护程序。</li></ol><p id="9ae8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果满足上述要求，目标可以是任何具有任何操作系统的机器。它可以是你的个人电脑，工厂里的服务器，云中的虚拟机，或者是树莓Pi。Daeploy manager提供安全性和身份验证，并提供一个安全的API来部署您的代码、从运行的服务中提取日志、获取通知等等。</p><p id="6f88" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们仔细看看Daeploy SDK和Daeploy manager的一些特性。</p><h1 id="35b5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Daeploy SDK</h1><p id="fdde" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">当编写应该作为服务运行的代码时，使用Daeploy SDK。它作为python包安装在Python环境中，并努力使创建这些服务的过程尽可能简单。</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="c210" class="mq lt iq ns b gy nw nx l ny nz">$ pip install daeploy</span></pre><h2 id="de20" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated"><strong class="ak">创建API </strong></h2><p id="3453" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">一个常见的用例是将经过训练的模型转换为预测服务，该服务具有可以接收数据并生成预测的API。使用Daeploy SDK，您可以用一个装饰器将任何Python函数转换成API。</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="0e47" class="mq lt iq ns b gy nw nx l ny nz"># Lets import what we need from daeploy SDK<br/>from daeploy import service</span><span id="4a76" class="mq lt iq ns b gy oa nx l ny nz"># decorate a python function with service.entrypoint to create an API endpoint!</span><span id="a2d6" class="mq lt iq ns b gy oa nx l ny nz">@service.entrypoint<br/>def hello(name: str) -&gt; str:<br/>    logger.info(f"Greeting someone with the name: {name}")<br/>    return f"hello {name}"</span></pre><h2 id="b625" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">警报和通知</h2><p id="109e" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">监控模型或一般运行的服务是创建可靠解决方案的一个重要方面。用例是无穷无尽的。一个常见的棘手问题是经过训练的模型随着时间的推移而退化。Daeploy SDK带有内置的通知功能，因此您可以在经理仪表板上和您的电子邮件中获得通知。</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="63d5" class="mq lt iq ns b gy nw nx l ny nz">@service.entrypoint<br/>def hello(name: str) -&gt; str:<br/>    if name == "world":<br/>        notify(<br/>            msg="Someone is trying to greet the World!!",<br/>            severity=Severity.WARNING,<br/>            emails=["your@email.com"],<br/>        )    <br/>    logger.info(f"Greeting someone with the name: {name}")<br/>return f"hello {name}"</span></pre><h2 id="168a" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">使用微服务架构构建应用</h2><p id="1f9b" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">创建应用程序通常需要多种服务，例如:</p><ul class=""><li id="e70e" class="nd ne iq kh b ki kj kl km ko nf ks ng kw nh la ob nj nk nl bi translated"><strong class="kh ir">数据库连接器服务:</strong>从专用数据库提取数据或将数据保存到专用数据库的服务。</li><li id="7959" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ob nj nk nl bi translated"><strong class="kh ir">预测服务:</strong>获取数据作为输入并返回预测的服务。</li><li id="2547" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ob nj nk nl bi translated"><strong class="kh ir">业务逻辑服务:</strong>包含业务相关逻辑的服务，负责将预测转换为业务相关动作。</li><li id="4a8c" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ob nj nk nl bi translated"><strong class="kh ir">仪表板服务:</strong>提供可视化或与应用程序交互的服务。</li></ul><p id="9608" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用微服务架构比单一应用程序有很多好处，例如灵活性、可伸缩性和关注点分离，等等。然而，也有缺点。管理服务之间的通信是微服务架构导致额外开销的一个例子。</p><p id="cddd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果使用REST，需要为每个服务设置一个Flask服务器，创建和管理端点，并处理使用REST API可能发生的异常。Daeploy SDK使得服务之间的通信像普通的python函数调用一样简单。下面是一个使用call_service并从另一个服务调用hello函数的示例:</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="cd16" class="mq lt iq ns b gy nw nx l ny nz"># import call_service from communication package<br/>from daeploy.communication import call_service</span><span id="a574" class="mq lt iq ns b gy oa nx l ny nz">def greet_the_world() -&gt; str:<br/># No need for API call. Just call any entry point from other        # services using call_service function<br/>    reponse = call_service(<br/>        service_name="greeting_service",<br/>        entrypoint_name="hello",<br/>        arguments={"name": "world"}<br/>     )<br/>    logger.info(f"{reponse}")<br/>return f"{reponse}"</span></pre><h1 id="f764" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">部署经理</h1><p id="e2f2" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">部署管理器旨在简化部署过程。让我们看看Daeploy manager如何简化部署服务的复杂性。</p><h2 id="2058" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">安全性和身份验证</h2><p id="08de" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">处理访问、安全性和身份验证是在远程服务器上部署应用程序的基本部分，无论是在云上还是在客户场所。尤其是在处理业务敏感数据的时候。Daeploy manager带有内置的基于令牌的身份验证和HTTPS功能。</p><p id="2ba4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用户可以直接与Daeploy manager REST API通信，或者使用SDK附带的命令行界面(CLI)。要使用CLI，您所需要的只是一个安装了Daeploy SDK并激活了Python环境的终端。要与Daeploy manager通信，首先使用login命令进行身份验证:</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="28f1" class="mq lt iq ns b gy nw nx l ny nz">$ daeploy login<br/>Enter daeploy host: <a class="ae lb" href="http://localhost" rel="noopener ugc nofollow" target="_blank">https://your-host</a><br/>Logging in to Daeploy instance at <a class="ae lb" href="http://localhost" rel="noopener ugc nofollow" target="_blank">https://your-host</a><br/>Username: admin<br/>Password: ***************<br/>Changed host to https://your-host</span></pre><p id="3eb0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您还可以使用CLI创建具有不同有效期的令牌。例如，您可以创建有效期为五天的令牌，如下所示:</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="4519" class="mq lt iq ns b gy nw nx l ny nz">$ daeploy token 5<br/>Active host: <a class="ae lb" href="http://localhost" rel="noopener ugc nofollow" target="_blank">https://your-host</a><br/>Use the token in the header {"Authorization": "Bearer token"}, for further details see the docs<br/>eyJ0eXAiOiJKV1QiLCJhb.....</span></pre><h2 id="c828" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">集装箱化</h2><p id="c866" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">使用Docker之类的容器部署服务正在成为行业标准。容器有几个优点，如可移植性、一致的操作，并且与虚拟机(VM)相比，它们更轻量级。<br/>Daeploy manager将Python代码转换成Docker映像，安装所有必需的依赖项，并作为服务运行，所有这些都只需一个命令:</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="766f" class="mq lt iq ns b gy nw nx l ny nz">$ daeploy deploy [options] &lt;service-name&gt; &lt;version&gt; &lt;source&gt;</span></pre><p id="3372" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">源代码可以是您的本地开发文件夹、git repo，甚至是现有的docker映像！</p><h2 id="e359" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">影子部署</h2><p id="c1c2" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">影子部署是一个方便的特性，它允许在不中断生产的情况下测试现有服务的新版本。在影子部署中，新版本与当前版本一起部署。新版本接收服务的所有入站流量，但忽略响应。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi oc"><img src="../Images/96a4d0ba57abff191da5fa4195985075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKX6dxluGbRxZgz-NzZ6jQ.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">影子部署(来源:作者)</p></figure><p id="0e1f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用assign命令很容易切换服务的主版本。更多信息，请参见<a class="ae lb" href="https://vikinganalytics.github.io/daeploy-docs/1.0.1/content/getting_started/shadow_deployment.html?highlight=shadow#versioning-and-shadow-deployment" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><pre class="ld le lf lg gt nr ns nt nu aw nv bi"><span id="2c1e" class="mq lt iq ns b gy nw nx l ny nz">$ daeploy assign &lt;service-name&gt; &lt;version&gt;</span></pre><p id="304c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要了解关于启动管理器的更多信息，请查看<a class="ae lb" href="https://daeploy.medium.com/getting-started-with-daeploy-b7aeef918fa5" rel="noopener">入门文章</a>。</p><p id="896b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们很高兴发布Daeploy，并让社区免费获得<a class="ae lb" href="http://www.daeploy.com" rel="noopener ugc nofollow" target="_blank">。我们期待看到它如何帮助您将您的想法付诸实践。就业愉快！</a></p><h2 id="7a52" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">参考资料:</h2><p id="405c" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">[1] D .斯卡利，加里·霍尔特，丹尼尔·戈洛文，尤金·达维多夫，托德·菲利普斯，迪特马尔·埃布纳，维奈·乔德里，迈克尔·杨，江泽龙·克雷斯波，丹·丹尼森，<em class="od">“机器学习系统中隐藏的技术债务”，</em>第28届神经信息处理系统国际会议论文集，2015年12月</p></div></div>    
</body>
</html>