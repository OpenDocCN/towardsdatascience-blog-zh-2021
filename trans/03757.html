<html>
<head>
<title>How to Build an Interactive Confidence Interval Calculator in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python构建交互式置信区间计算器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-an-interactive-confidence-interval-calculator-in-python-6aea08d69be3?source=collection_archive---------18-----------------------#2021-03-28">https://towardsdatascience.com/how-to-build-an-interactive-confidence-interval-calculator-in-python-6aea08d69be3?source=collection_archive---------18-----------------------#2021-03-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ab3e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Python和Jupyter Notebook中为正态和二项式置信区间构建一个可重用的交互式批处理计算器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bd03e87fd1671b579c4b3defa9962d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a0Ve4jk_XRvWkC_SS1S79w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Avel Chuklanov 在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="b362" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">背景</h2><p id="b0a3" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">很常见的是，我们可以获得一个值的样本，可能是点击我们新网站页面的200个用户的样本，或者是在他们离开投票站时进行的投票后调查中的30个选民的样本。</p><p id="dd40" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了对这些观察结果做出陈述，我们需要使用置信区间，而不仅仅是引用试验的百分比或结果。</p><p id="62cc" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">置信区间是一个数值范围，我们相当确定我们的真实值所在，例如，如果我们问30个选民他们投票给谁，75%的人说“候选人A ”,那么整个选民投票给候选人A的范围是多少？</p><p id="e0a6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果你想知道更多关于置信区间的信息，这个在线资源是一个很好的起点——【https://www.mathsisfun.com/data/confidence-interval.html<a class="ae ky" href="https://www.mathsisfun.com/data/confidence-interval.html" rel="noopener ugc nofollow" target="_blank">，但是知道比背景信息更多的信息对于让置信区间为你工作并不重要。</a></p><h2 id="ff25" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">这个想法</h2><p id="9e4e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我曾在工作场合多次使用置信区间，根据样本观察对某件事情发生的可能性做出陈述，每次我要么在Excel中重新创建公式，要么重新编写Python代码。</p><p id="7be4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我决定用Jupyter编写一个交互式置信区间计算器，下次我需要做同样的事情时可以重用它，这就产生了代码和这篇文章</p><h2 id="2571" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">我们开始吧！</h2><p id="725a" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">首先，我们需要导入一些库，我们将使用它们来构建我们的计算器…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="3e4a" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">公式的快速复习</h2><p id="299b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">置信区间的公式看起来很可怕，但作为一个非统计学家，我可以说它们并不可怕。如果你想更深入地了解它们是如何工作的，请看看我的另一篇文章-<a class="ae ky" rel="noopener" target="_blank" href="/hypothesis-testing-in-python-made-easy-7a60e8c27a36">https://towardsdatascience . com/hypothesis-testing-in-python-made-easy-7a 60 e 8 c 27 a 36</a>。</p><p id="691d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">回顾一下要点，我们将在Jupyter和Python中实现两个公式，一个用于正态分布，一个用于二项式分布。</p><p id="c7bd" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">正态分布的公式将用于所有正态分布，例如，英国男性鞋码的分布或一组学习在线课程的学生的年终考试分数的分布。</p><p id="370a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">当出现简单的二元结果时，将使用二项式分布公式，例如，75%的受访选民投票给候选人A，25%的人没有。</p><p id="c1c2" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这是计算正态分布置信区间的公式…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/4b6426a34f5a512dc0e23f64453dcf4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtqYdArtPtB67aAIy79ynQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3afe" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">…这是二项式的公式…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/546bad8cd562ffc4a2f53cdc17106e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u8Fbt2_E6PmIUPMapcdagQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8b70" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">因此，抛开那些讨厌的公式，让我们继续进行比较直接的工作，让它们发挥作用，并创建几个Python函数来实现它们…</p><h2 id="64bb" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">在Python中实现公式</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9a3a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">…让我们快速测试一下我们的功能…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="be4e" class="kz la it my b gy nc nd l ne nf">[71.4489792915286, 74.669551749961]</span></pre><p id="ed8d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我已经使用其他程序测试了输出结果，结果是正确的，但要注意的是，如果您正在从一组测试数据中计算标准偏差(𝜎),您需要注意以下几点</p><p id="cbc4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><code class="fe ng nh ni my b">scipy.stats.sem function()</code>使用默认值<code class="fe ng nh ni my b">ddof=1</code>作为自由度参数，而<code class="fe ng nh ni my b">numpy.std()</code>默认使用<code class="fe ng nh ni my b">ddof=0</code>，这可能会导致不同的结果，取决于您是使用<code class="fe ng nh ni my b">scipy</code>还是<code class="fe ng nh ni my b">numpy</code>来执行计算。</p><p id="70b6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">有关完整的解释，请参见这篇关于stackoverflow的文章:<a class="ae ky" href="https://stackoverflow.com/questions/54968267/scipy-stats-sem-calculate-of-standard-error" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/54968267/scipy-stats-SEM-calculate-of-standard-error</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="714a" class="kz la it my b gy nc nd l ne nf">[0.7546278801351438, 0.8053721198648562]</span></pre><p id="e517" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">该输出也已经使用简单的Excel公式- <code class="fe ng nh ni my b">=1.96*(SQRT(B2*(1-B2))/Sheet2!$B$1)</code>进行了验证，其中1.96是95%置信区间的z得分，单元格B2保存𝑝̂的值，<code class="fe ng nh ni my b">Sheet2!$B$1</code>保存样本大小的值。</p><h1 id="6066" class="nj la it bd lb nk nl nm le nn no np lh jz nq ka ll kc nr kd lp kf ns kg lt nt bi translated">创建交互式计算器</h1><p id="5d6b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">互动计算器是使用Jupyter互动部件创建的，完整的文档可以在这里找到</p><ul class=""><li id="bba6" class="nu nv it lx b ly mo mb mp li nw lm nx lq ny mn nz oa ob oc bi translated"><a class="ae ky" href="https://ipywidgets.readthedocs.io/en/stable/examples/Widget%20List.html" rel="noopener ugc nofollow" target="_blank">https://ipywidgets . readthedocs . io/en/stable/examples/Widget % 20 list . html</a></li><li id="09ef" class="nu nv it lx b ly od mb oe li of lm og lq oh mn nz oa ob oc bi translated"><a class="ae ky" href="https://ipywidgets.readthedocs.io/en/stable/examples/Using%20Interact.html" rel="noopener ugc nofollow" target="_blank">https://ipywidgets . readthedocs . io/en/stable/examples/Using % 20 interact . html</a></li></ul><p id="2178" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们需要做的第一件事是定义我们的输入控件…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2daf" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在我们需要几个简单的包装函数来显示控件，并在单击按钮时调用适当的置信区间函数…</p><h2 id="4646" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">正态分布置信区间计算器</h2><p id="4c97" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">这是解决方案的关键部分；只需几行Python和Jupyter代码，就可以创建交互式计算器，这样您就可以更改输入参数并单击“运行交互”来随时重新运行正态分布的计算-</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/38153e844118a34751ec9bc2246fa2ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2KdwKIuc6Oh1SXvE3tVBg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="0d35" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">二项式分布置信区间计算器</h2><p id="b9ee" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">下面是创建二项式置信区间交互式计算器的等效代码…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/74b2e50d1008d8a7d681bbde90671383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8hNXY1IslDoZIQngIqA7Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="5511" class="nj la it bd lb nk nl nm le nn no np lh jz nq ka ll kc nr kd lp kf ns kg lt nt bi translated">创建批处理计算器</h1><p id="1732" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">由于交互式置信区间计算器适用于单独的计算，我决定将其扩展到批处理模式，以适应我想一次处理几个计算的情况。</p><p id="00fd" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">首先我们需要创建几个助手函数来更新<code class="fe ng nh ni my b">DataFrame</code>中的值...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="220b" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">正态分布置信区间批处理计算器</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/20fdcb5305db34b3a679dc18faab4b71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PrJqs4A7mtu7TdnJQelQ6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/aff3c95697c485f50a6c5f41a3d134f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gjwiImppVH1Nf30dZ4Zkyg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="885d" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">二项式置信区间批量计算器</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/79219cd9a8a8abd9c05b3fd7de282b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b2HR82fExXvojFc1ajeFrA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/7b7d57cfd681968bb5b4e1f486c0553e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhK4urrfIMcxJ_qpZ5xpOg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="66e0" class="nj la it bd lb nk nl nm le nn no np lh jz nq ka ll kc nr kd lp kf ns kg lt nt bi translated">结论</h1><p id="5eb6" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们简要回顾了计算正态分布和二项式分布置信区间的统计公式，并表明能够交互式地计算这些公式是非常有用的，而不是每次我们想要计算它们时都必须在Excel或Python中重新编写代码。</p><p id="e984" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们定义了Python函数来计算置信区间，然后快速创建了两个交互式表单，我们可以反复运行它们来计算我们感兴趣的置信区间。</p><p id="55f3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最后，我们扩展了交互式计算器，从一个<code class="fe ng nh ni my b">.csv</code>文件中读取参数，以便对一批数据快速执行置信区间计算，从而加快我们希望对几组数据而不是一组数据进行计算的过程。</p><p id="acc9" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">Jupyter笔记本的完整源代码可以在这里找到</p><div class="oo op gp gr oq or"><a href="https://github.com/grahamharrison68/Public-Github/blob/master/Hypothesis%20Testing/Confidence%20Interval%20Calculator.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">grahamharrison68/Public-Github</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">GH公共项目库。通过在…上创建帐户，为grahamharrison68/Public-Github开发做出贡献</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">github.com</p></div></div></div></a></div></div></div>    
</body>
</html>