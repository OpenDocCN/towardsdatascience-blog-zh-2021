<html>
<head>
<title>How to Create a Complex Data Science Project With 2 Lines of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用两行代码创建复杂的数据科学项目</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-run-complex-machine-learning-models-with-2-lines-of-code-e0a541502ee9?source=collection_archive---------25-----------------------#2021-04-07">https://towardsdatascience.com/how-to-run-complex-machine-learning-models-with-2-lines-of-code-e0a541502ee9?source=collection_archive---------25-----------------------#2021-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="12cc" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">机器学习</h2><div class=""/><div class=""><h2 id="5df9" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用PyCaret创建一个完整的数据科学项目，从数据清理到复杂的机器学习模型</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/8b036590f17e2f938b3be0cb5c654f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQWV3oxCU3aFVOfpN26img.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由Vlada Karpovich提供。来源:<a class="ae lh" href="https://www.pexels.com/photo/close-up-photo-of-laptop-4050467/" rel="noopener ugc nofollow" target="_blank">像素</a></p></figure><p id="bc5a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一位读者最近在我的博客中问我是否尝试过<code class="fe me mf mg mh b">PyCaret</code>。我答应我会尝试，我很高兴我做到了。<code class="fe me mf mg mh b">PyCaret</code>允许你用两行代码运行整个数据科学项目，从数据清理、处理类不平衡，到超调机器学习模型。不相信我？没关系，我第一次尝试的时候也不敢相信，但事实是它确实有效。让我先向您展示一下<code class="fe me mf mg mh b">PyCaret</code>的运行情况，然后我们可以更深入地了解这个库。出于演示的目的，我将使用Titanic Survivor数据集，它包括分类、数字和<code class="fe me mf mg mh b">NaN</code>值。结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mi"><img src="../Images/2e92fa4188e57da1779678f816927aa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*V1Xe3RpcugelFWpjlTO_XQ.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="74b5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是刚刚发生的事情:<code class="fe me mf mg mh b">PyCaret</code>处理分类数据，将数据集分为训练集和测试集，进行日志实验，检查异常值，修复类不平衡，并在不到30秒的时间内运行从逻辑回归到XGBoost的模型。它也用两行代码得到了0.8154的精度。现在，让我们了解更多关于<code class="fe me mf mg mh b">PyCaret</code>的工作原理以及如何使用它。</p><h1 id="409a" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki mu kj mv kl mw km mx ko my kp mz na bi translated">PyCaret是什么？</h1><p id="77e3" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated">他们的网站是这样说的:</p><blockquote class="ng nh ni"><p id="2f3e" class="li lj nj lk b ll lm kd ln lo lp kg lq nk ls lt lu nl lw lx ly nm ma mb mc md im bi translated">PyCaret是一个用Python编写的开源、<strong class="lk jd">低代码</strong>机器学习库，允许您在自己选择的笔记本环境中，在几分钟内从准备数据到部署模型。</p></blockquote><p id="c47e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">看来<code class="fe me mf mg mh b">PyCaret</code>言出必行。从准备数据到用2或3行代码部署监督和非监督模型。我在几个不同的项目中测试了它，包括一些过去工作过的旧项目，结果与我工作一周后得到的结果非常接近。为了向您展示它是如何工作的，让我们一起创建一个分类项目。你可以在这里找到我写这篇博客<a class="ae lh" href="https://github.com/ismael-araujo/Testing-Libraries/blob/main/PyCarat/PyCarat.ipynb" rel="noopener ugc nofollow" target="_blank">用的笔记本。很快我也会发布一个回归项目。敬请期待！</a></p><h1 id="d4e5" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki mu kj mv kl mw km mx ko my kp mz na bi translated">装置</h1><p id="918e" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated">有几种方法可以通过你的终端安装<code class="fe me mf mg mh b">PyCaret</code>。强烈建议使用虚拟环境，以避免与其他库冲突。第一个是在您的终端中键入<code class="fe me mf mg mh b">pip install pycaret</code>，这是一个精简版的<code class="fe me mf mg mh b">PyCaret</code>及其硬依赖。要安装完整版，可以输入<code class="fe me mf mg mh b">pip install pycaret[full]</code>，这是我推荐的。</p><h1 id="7426" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki mu kj mv kl mw km mx ko my kp mz na bi translated">开始一个新项目</h1><p id="a893" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated"><code class="fe me mf mg mh b">PyCaret</code>对它提供的东西非常有信心，他们的团队给了我们55个数据集，你可以自己试试这个库。这些问题包括:异常检测，关联规则挖掘，二元和多元分类，聚类，自然语言处理和回归。</p><p id="9d43" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦您安装了<code class="fe me mf mg mh b">PyCaret</code>，您可以在Jupyter笔记本上输入以下内容，以获得他们提供的数据集列表。</p><pre class="ks kt ku kv gt nn mh no np aw nq bi"><span id="ee88" class="nr mk it mh b gy ns nt l nu nv"># Get data<br/>from pycaret.datasets import get_data<br/>from pycaret.classification import *<br/>index = get_data('index')</span></pre><p id="929f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集的列表很长，我不会在此添加所有数据集，但您可以从以下分类数据集中进行选择:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/7d5d59384b5b26f28b053aaff5f54039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yx6RHsM4l58ltY1RMBcmcA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="2a66" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这个项目，我将与信用卡默认项目。这有点挑战性，而且非常接近现实生活中的问题。要选择数据集，您只需键入<code class="fe me mf mg mh b">data = get_data('name_of_the_dataset')</code>。由于我们将测试信用卡默认数据集，我们需要键入<code class="fe me mf mg mh b">data = get_data('credit')</code>并运行单元格。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/ecef9d72b071895da38db765cf5093ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PpyV8R6hoRw9Gpmqc5YJCw.png"/></div></div></figure><p id="1be6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们已经做好了数据准备。这需要一行代码。<code class="fe me mf mg mh b">PyCaret</code>将返回一个包含数据集信息的表格，我们将能够决定如何继续。为此，我们将设置数据集、目标标签、实验名称等。下面是代码中最重要的部分:</p><pre class="ks kt ku kv gt nn mh no np aw nq bi"><span id="6818" class="nr mk it mh b gy ns nt l nu nv">clf1 = setup(data, target = ‘default’, session_id=123, log_experiment=True, experiment_name=’default1')</span></pre><p id="a128" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">运行以下代码后，我们将得到以下问题:<em class="nj">以下数据类型已被自动推断，如果它们是正确的，请按enter键继续，否则键入' quit'。</em>键入<code class="fe me mf mg mh b">enter</code>继续。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/883cd13233b15e3b3ca413091f476c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MHO-6cLmmWzQN4GEcf99EA.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="79a3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面这段代码所做的是通过数据清理、训练测试分割、测试日志转换、多项式、转换类别数据、解决类别不平衡，以及你能想到的任何其他数据准备。你可以看到我写的<code class="fe me mf mg mh b">log_transformation = True</code>是个例子，但是有几十个数据准备选项。我强烈建议您键入<code class="fe me mf mg mh b">shift + tab</code>并检查您可以做的所有数据准备工作。我可以就此写一整篇文章(我可能会这样做)，但现在，让我们从基础开始。</p><h1 id="269b" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki mu kj mv kl mw km mx ko my kp mz na bi translated">运行模型</h1><p id="b79a" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated">现在，是时候运行基线模型了。到目前为止，在加载数据集之后，我已经编写了一行代码。我们现在将使用另一行代码运行16个机器学习模型。我将使用5倍的交叉验证。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/650f3d57e37b1a2fd2a87f4a70ab2f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Hd6SP1f-PiZfDDnjaN5ckw.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="455d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">运行所有模型花了1分36秒，包括一些复杂的集合模型。让我们来看看结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/1d97e1ef1fa7a9e1c8efae57b3c66ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nj9mXju9MWWILdYXTHwsnA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="4c0d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里需要注意一些事情。首先，XGBoost失败了。没关系。我们还有15个模型要分析。<code class="fe me mf mg mh b">PyCaret</code>为我们提供了多个指标，并强调了每个指标的最佳结果。对于这个项目，我们需要考虑召回指标，当假阴性的成本很高并且我们得到了0.90的召回分数时，就会用到这个指标。你也可以通过输入来创建单独的模型，例如<code class="fe me mf mg mh b">qda = create_model('qda')</code>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/aceca5dbaed81e55474bc514354cf3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4fum5NVVO2hETQvLbZB_Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="75c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe me mf mg mh b">qda</code>代表二次判别分析模型。默认情况下，<code class="fe me mf mg mh b">PyCaret</code>将测试集分成10层。你可以通过输入<code class="fe me mf mg mh b">qda = create_model('Ada', fold = 5)</code>来编辑。要查看您可以运行的模型的完整列表、它们使用的库以及缩写，请键入<code class="fe me mf mg mh b">models()</code>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/679c17b316955c6a3ba18927225a102b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UFDBi-7Wtyp9HrvQOQ4l6A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="9a8d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以键入<code class="fe me mf mg mh b">tune_models(lr)</code>来调整超参数。在这种情况下，提高了一些指标，但实际上降低了召回分数。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/acf579c57a57fcfc22b99aa1151555d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jwm9kwTjSBu32JiCgiBsMQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="4014" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用<code class="fe me mf mg mh b">PyCaret</code>还可以做很多其他的事情，比如分析和解释模型，用维持集测试模型，保存和部署模型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/796d2d0bec3af50a016d41b9d34391fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*i3KTpwxyMPDUGmU-zC2P8w.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="13b6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我鼓励您访问他们的网站，查看他们的文档、项目和更多教程。我将在另一篇文章中讨论很多内容。</p><h1 id="465b" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki mu kj mv kl mw km mx ko my kp mz na bi translated">最后的想法</h1><p id="998d" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated"><code class="fe me mf mg mh b">PyCaret</code>似乎很神奇，言出必行。然而，正如我总是喜欢提醒读者的那样，数据科学是一个复杂的角色，你不能用几行代码来代替专业人员。如果你喜欢使用<code class="fe me mf mg mh b">PyCaret</code>作为你下一个项目的额外步骤，并且理解你的数据集的潜力，那就去做吧。我用多个数据集进行了尝试，结果非常接近我在一个项目中工作了整整一周所能得到的结果。但是，我不建议你把它用于你的最终结果或者作为一种捷径。您可以将它作为流程的一部分添加进来，无需键入几十行代码就能快速获得洞察力。祝你尝试愉快，并告诉我进展如何。</p><p id="c833" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">不久我也将发布一个使用<code class="fe me mf mg mh b">PyCaret</code>的回归项目，所以请在Medium上关注我，了解最新动态。如果你喜欢这篇文章，别忘了留下你的掌声👏。它激励我继续写作。</p></div></div>    
</body>
</html>