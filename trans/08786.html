<html>
<head>
<title>Essential guide to Impute Missing Values in a single line of Python code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在一行Python代码中估算缺失值的基本指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/essential-guide-to-impute-missing-values-in-a-single-line-of-python-code-d495d40d0c84?source=collection_archive---------27-----------------------#2021-08-13">https://towardsdatascience.com/essential-guide-to-impute-missing-values-in-a-single-line-of-python-code-d495d40d0c84?source=collection_archive---------27-----------------------#2021-08-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d9b4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用随机森林和基于k-NN的插补预测缺失数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8bd5569c8ff7499664095417f9565460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d4m5SWbxIaFUdfYIYYuqAA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=693870" rel="noopener ugc nofollow" target="_blank">pix abay</a>Willi Heidelbach</p></figure><p id="aa63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现实世界中的数据集通常会有许多缺失记录，这可能是由于数据损坏或未能记录值而导致的。为了训练健壮的机器学习模型，在特征工程流水线期间，丢失值的处理是必不可少的。</p><p id="7af3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有多种插补策略可用于对分类、数字或时间序列特征的缺失记录进行插补。你可以参考我以前的一篇文章，我已经讨论了处理数据集中缺失记录的7种策略或技术。</p><p id="2acf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论一个开源Python库— <strong class="lb iu"> <em class="lv"> missingpy </em> </strong>的实现，它使用基于随机森林和k-NN的模型来预测数字特征中的缺失值。</p><h1 id="9e08" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">缺少副本:</h1><p id="9290" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">missingpy是一个开源python库，它使用基于预测的插补策略来插补缺失数据。它有一个类似于scikit-learn的API，所以开发人员可以找到熟悉的界面。截至目前，missingpy仅支持基于随机森林和k-NN的插补策略。</p><blockquote class="mt mu mv"><p id="89ce" class="kz la lv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated">我们将使用Kaggle 的<a class="ae ky" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">信用卡欺诈检测数据集中的一些特征来估算缺失的记录，并比较missingpy库的性能。</a></p></blockquote><h2 id="03be" class="mz lx it bd ly na nb dn mc nc nd dp mg li ne nf mi lm ng nh mk lq ni nj mm nk bi translated">安装:</h2><p id="b79b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">missingpy可以从PyPI安装，使用:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="ec2a" class="mz lx it nm b gy nq nr l ns nt"><strong class="nm iu">pip install missingpy</strong></span></pre><p id="4d2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nu nv nw nm b">KNNImputer()</code>和<code class="fe nu nv nw nm b">MissForest()</code>是missingpy包中的两个API。</p><h1 id="66ae" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">用法:</h1><p id="fefc" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们将仅使用信用卡检测数据集中的8个特征和25，000个实例进行进一步演示。由于数据集没有缺失记录，我们将创建一个<code class="fe nu nv nw nm b">‘Amount’</code>要素的副本，并用NaN值替换实际值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="1c5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">准备好数据后，<code class="fe nu nv nw nm b">‘Amount’</code>特征<code class="fe nu nv nw nm b">‘Amount_with_NaN’</code>的副本在总共25000条记录的样本数据中有4512条空记录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/9f5fc5bb679874844b1d78f540e8e89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*UxkW-dndRqMDW_53WSv_MQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，缺少记录编号</p></figure><h2 id="6317" class="mz lx it bd ly na nb dn mc nc nd dp mg li ne nf mi lm ng nh mk lq ni nj mm nk bi translated">MissForest基于森林的随机插补:</h2><p id="67e4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">missingpy附带了一个基于随机森林的插补模型，可以使用<code class="fe nu nv nw nm b"><strong class="lb iu">MissForest()</strong></code>函数在一行Python代码中实现。</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="cac1" class="mz lx it nm b gy nq nr l ns nt"><strong class="nm iu">from missingpy import MissForest</strong></span><span id="60e2" class="mz lx it nm b gy oa nr l ns nt"><strong class="nm iu">imputer = MissForest()<br/>df_new = imputer.fit_transform(df)</strong></span></pre><p id="0318" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实例化MissForest模型后，拟合具有缺失记录的数据集。该方法返回数据集和估算值。</p><p id="8560" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们将估算值与“金额”特征的真实值进行比较，并查看估算的偏差。</p><div class="kj kk kl km gt ab cb"><figure class="ob kn oc od oe of og paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/dcb08c1d7450965b58fb38d807bcc75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*7Q0CGdjkE3nMo5WuInlhJw.png"/></div></figure><figure class="ob kn oc od oe of og paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/f383cbb499b11dc5bc49d2c5e53da334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*6RkwFgD5pgZwjP9g4rLvjg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk oh di oi oj translated">(图片由作者提供)，<strong class="bd ok">左:</strong>实际金额特征与估算值的PDF图，<strong class="bd ok">右:</strong>实际值与预测值偏差分布的PDF；对于MissForest估算器</p></figure></div><p id="c2eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的情节可以得出结论，</p><ul class=""><li id="72a9" class="ol om it lb b lc ld lf lg li on lm oo lq op lu oq or os ot bi translated">左图:我们可以观察到预测缺失数据和实际数量有相似的PDF图。</li><li id="5a29" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">右图:实际值和预测缺失记录之间的偏差的PDF图是倾斜的，峰值为0。我们有很长的尾巴，代表很少的预测偏离超过100个值。</li></ul><p id="1ba6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们来看一些统计数字，以观察缺失森林插补的表现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/4a3049483a4403efa70bf72a23faa5cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_95F4bXnrhCl5S_wRwb2AA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)、实际数量的统计数字、使用MissForest预测的缺失数量及其偏差</p></figure><h2 id="151b" class="mz lx it bd ly na nb dn mc nc nd dp mg li ne nf mi lm ng nh mk lq ni nj mm nk bi translated">KNNImputer —基于kNN的插补:</h2><p id="1272" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">KNNImputer的实现与MissForest插补的实现相同。现在让我们直接跳到实现和生成PDF图。</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="63e0" class="mz lx it nm b gy nq nr l ns nt"><strong class="nm iu">from missingpy import KNNImputer</strong></span><span id="8686" class="mz lx it nm b gy oa nr l ns nt"><strong class="nm iu">imputer = KNNImputer()<br/>df_new = imputer.fit_transform(df)</strong></span></pre><div class="kj kk kl km gt ab cb"><figure class="ob kn pa od oe of og paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ceaa2213eca9930dedccc267a8df7046.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*RCLozSFmDgCvOYQSMMDdsg.png"/></div></figure><figure class="ob kn pb od oe of og paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/068e0f9bcd8078b0972c03a626233621.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*Q-SkG0-DgPBmkzJyZ48_3w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk oh di oi oj translated">(图片由作者提供)，<strong class="bd ok">左:</strong>实际金额特征与估算值的PDF图，<strong class="bd ok">右:</strong>实际值与预测值之间的偏差分布的PDF；对于KNNImputer</p></figure></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/9ab741517039239a28832246154f4146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyWvEuAICIht36_mY7cZ8w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)、实际数量的统计数字、使用KNNImputer预测的缺失数量及其偏差</p></figure></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><h1 id="ac37" class="lw lx it bd ly lz pk mb mc md pl mf mg jz pm ka mi kc pn kd mk kf po kg mm mn bi translated">结论:</h1><p id="0552" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">MissForest(基于随机森林的插补)和KNNImputer(基于k-NN的插补)的表现几乎相似，给出了类似的插补值和实际值偏差的统计数字。就RMSE指标而言，KNNImputer似乎表现得更好一些。</p><p id="d746" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">missingpy库是一个非常方便的工具，可以在几行Python代码中预测丢失的数据。该包的API实现类似于scikit-learn的API实现，这使得开发人员熟悉该接口。</p><blockquote class="mt mu mv"><p id="7b5b" class="kz la lv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated">阅读我以前的文章，了解处理数据集中缺失值的7种技巧</p></blockquote><div class="pp pq gp gr pr ps"><a rel="noopener follow" target="_blank" href="/7-ways-to-handle-missing-values-in-machine-learning-1a6326adf79e"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd iu gy z fp px fr fs py fu fw is bi translated">机器学习中处理缺失值的7种方法</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">处理数据集中缺失值的常用策略</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">towardsdatascience.com</p></div></div><div class="qb l"><div class="qc l qd qe qf qb qg ks ps"/></div></div></a></div><h1 id="c4dd" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">参考资料:</h1><p id="a59e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">[1]缺少文件副本:<a class="ae ky" href="https://pypi.org/project/missingpy/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/missingpy/</a></p><blockquote class="qh"><p id="c920" class="qi qj it bd qk ql qm qn qo qp qq lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>