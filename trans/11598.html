<html>
<head>
<title>How to Create a Rating Visual in Power BI using DAX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 DAX 在 Power BI 中创建评级可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-a-rating-visual-in-power-bi-using-dax-859c57a96daf?source=collection_archive---------24-----------------------#2021-11-16">https://towardsdatascience.com/how-to-create-a-rating-visual-in-power-bi-using-dax-859c57a96daf?source=collection_archive---------24-----------------------#2021-11-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4e0a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何通过编写几行 DAX 来创建自定义评级视觉效果</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/f9919ca93dfaed92bcd8192d7b96ea0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hitNW3T5lOxHSqXS9h4L5w.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="c654" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我的上一篇文章中，我解释了如何使用<em class="lr"> UNICHAR() </em> DAX 函数利用一个非常简单的技术<a class="ae lq" rel="noopener" target="_blank" href="/enhance-your-power-bi-report-with-images-on-axis-a4227b650e4a">在轴上和切片器</a>中显示图像和图标。现在，我希望对此进行扩展，并展示如何使用简单的 DAX 创建评级可视化！让我不谦虚地说，使用这个技巧，你可以自由地说，你创造了自己的自定义视觉！</p><h1 id="68b7" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">搭建舞台</h1><p id="2302" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">正如在我之前的帖子中一样，我将使用一个与支持代理与客户互动相关的数据集—作为提醒，代理通过聊天、电子邮件和电话与客户沟通，在互动完成后，客户可以填写调查并表达她的/他的意见。要求客户回答三个问题:</p><ul class=""><li id="417b" class="mp mq it kw b kx ky la lb ld mr lh ms ll mt lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="lr">解决方案</em> </strong> —我的问题被支持代理解决了吗？</li><li id="113e" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="lr">满意度</em> </strong> —我对分辨率满意吗？</li><li id="54e5" class="mp mq it kw b kx my la mz ld na lh nb ll nc lp mu mv mw mx bi translated"><strong class="kw iu"> <em class="lr">推荐</em> </strong> —我会向他人推荐公司的服务吗？</li></ul><p id="6cbf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将使用与之前相同的数据集，但只关注调查结果。以下是 Power BI 中导入的原始数据:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/4c3af0cc4b383011c67c218340ab102b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CV-rB4madXZSxHvXGRORCg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="9247" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们首先试着从这个数据集中获得一些洞察力——例如，有多少客户对服务感到满意，其中有多少会推荐该公司的服务。我将创建三种方法来计算积极响应的调查:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="d1be" class="ni lt it ne b gy nj nk l nl nm">Resolution YES = CALCULATE(<br/>                        COUNT(Surveys[Interaction ID]),<br/>                        Surveys[Resolution] = "Y"<br/>                        )</span><span id="d06f" class="ni lt it ne b gy nn nk l nl nm">Satisfaction YES = CALCULATE(<br/>                        COUNT(Surveys[Interaction ID]),<br/>                        Surveys[Satisfaction] = "Y"<br/>                        )</span><span id="d108" class="ni lt it ne b gy nn nk l nl nm">Recommendation YES = CALCULATE(<br/>                        COUNT(Surveys[Interaction ID]),<br/>                        Surveys[Recommendation] = "Y"<br/>                        )</span></pre><p id="7e58" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我将这些指标拖到我的报告中，我可以获得一些，至少是基本的，关于客户满意度的见解:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/632f54956e2b40c45ae86bfadafaeabc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fb2TDNXjVrOt4Jw-xzeikg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="f350" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">还不错，但是企业会问的第一个问题是:对我们的服务满意的客户比例是多少？那么，让我们来创建一个计算肯定答案百分比的方法:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="ee9a" class="ni lt it ne b gy nj nk l nl nm">Resolution % = DIVIDE([Resolution YES], [Total Surveys],0)</span><span id="417e" class="ni lt it ne b gy nn nk l nl nm">Satisfaction % = DIVIDE([Satisfaction YES], [Total Surveys],0)</span><span id="e9c0" class="ni lt it ne b gy nn nk l nl nm">Recommendation % = DIVIDE([Recommendation YES], [Total Surveys],0)</span></pre><p id="c6e2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不要忘记将这些指标格式化为百分比:)</p><p id="6355" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">并且，在我格式化我的表格之后，报告看起来非常好:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/1cf7bf1f7df4666e40a0781a8ebd3b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ccyhcz1ZrhHEtKwpMSl4Hw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><h1 id="00fa" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">将用户体验推向新的高度</h1><p id="c3b8" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">好了，这就达到了目的，报告消费者可以很快看到满意客户的百分比。然而，如果我想让他们“感受”评级体验——你知道亚马逊、网飞等网站上的那些好明星。向你展示产品的等级。Power BI 不提供现成的可视化评级。你可以从 App Source Marketplace 获得它(至少它以前存在过，我猜它现在仍然可用)，但是…</p><p id="cec7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我告诉你，你可以通过写一些简单的 DAX 来创建一个评级可视化？！T19】</p><p id="84f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们卷起袖子开始工作吧。我们的想法是将百分比显示为报告中的星号。上次，我们创建了一个图标的<strong class="kw iu">列</strong>，包含它们的 Unicode 值，作为占位符。这一次，我们想建立一个<strong class="kw iu">衡量指标</strong>，来表达客户满意度背后的数字。同样，我们将利用 UNICHAR()函数，但方式略有不同。</p><p id="7e1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它应该是这样工作的:对于百分比值的每个十进制，我想显示一个星号—简单地说，如果百分比值是，比如说，63%，我将显示 6 个星号…如果值是 72%，我将显示 7 个星号，依此类推。让我向你展示我们如何实现这一点。</p><p id="4e02" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我表中的百分比不过是小数，用百分比表示。也就是说，63.01%本质上是 0.63(如果我们把它切到小数点后两位)，58.93%是 0.59，以此类推。现在，我将复制这些度量，但我会将它们格式化为十进制数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/74baa6be3be91f62d23ae5d6139742ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7YOpo0PW54jlhxjeH-5bPw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="8c3e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我的表格现在显示了客户回答的小数值和百分比。我现在将使用 UNICHAR()函数在我的表中显示星号。但是，为了显示适当数量的星星——记住，53%是 5 颗星，63%是 6 颗星，等等。—我必须对我的度量进行一些修改。</p><p id="8f74" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我会把结果乘以 10，所以 0.78 会变成 7.8，0.56 会变成 5.6，以此类推。然后，我可以从结果中检索整数值，并设置星形符号的外观！</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="627f" class="ni lt it ne b gy nj nk l nl nm">Resolution % Decimal Multiplied = [Resolution % Decimal] * 10</span></pre><p id="ae8f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我现在将使用 REPT() DAX 函数，它基本上重复定义的文本，重复的次数是您在该函数的第二个参数中指定的次数。在我的例子中，我是这样写的:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="cb3b" class="ni lt it ne b gy nj nk l nl nm">Stars v1 = REPT(UNICHAR(11088),[Resolution % Decimal Multiplied])</span></pre><p id="a2b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我停下来解释一下这个度量的特别之处:它将重复第一个参数，这是 Unicode 值 11088 的 Unicode 表示，乘以我们的百分比值中的十进制数。多酷啊！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/b3e4235ff227c5b03d11ebf5f29a24bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHxKic_9fXaL1ppSQcoNDQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="b31b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如您所见，该函数足够“智能”,可以像您预期的那样对多个星进行四舍五入，因此，77.66%表示为 8 个星，而 58.33%和 56.21%显示为 6 个星。</p><p id="599b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">太棒了！但是，如果我想让我的用户能够立即发现评级，而不需要数星星呢？换句话说，我想显示最大可用值(在我们的例子中是 10 颗星)，然后，根据百分比，一些星将保持为空。简单来说，如果百分比值是 77.66%，我想显示 8 颗黄星和 2 颗空星(和亚马逊一样，呵呵)。</p><p id="3135" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们开始写我们的最终措施:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="1559" class="ni lt it ne b gy nj nk l nl nm">Stars v2 = [Stars v1]&amp;(REPT(UNICHAR(10025),10-[Resolution % Decimal Multiplied]))</span></pre><p id="c630" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那么，我们在这里有什么:措施的第一部分是完全相同的，因为我们想要显示我们的积极的星星。但是，神奇的事情发生了:由于 REPT()函数处理文本值，我们可以简单地连接另一部分——在这一部分中，我们显示 Unicode 值 10025 的 Unicode 符号(空星号),然后我们希望重复它的次数，次数等于 10(这是星号的最大值)和我们的“正”星号的数量之间的减法值——因此剩余的次数将显示空星号。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/354cba894b6bb24d8f86f0fc91a961a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VoV-U8Mg3OMzSqcHzUqSmA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="f279" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很棒，不是吗？</p><h1 id="9200" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">结论</h1><p id="690c" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">看了上面的插图，你可能会得出结论，我们已经成功做到了！我们仅使用 DAX 创建了一个显示评级的自定义视觉效果。</p><p id="1e14" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我要再重复一遍:Power BI 是一个非常棒的工具，因为它为您提供了惊人的灵活性，可以用多种不同的方式讲述您的数据故事。只需很少的创意和一些简单的调整，你就可以为你的用户创造一个难忘的体验。</p><p id="3cbb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我已经向您展示了如何通过编写几行 DAX 代码来实现(im)可能性并创建您自己的自定义可视化！</p><p id="9ca8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读！</p><p id="ed07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">成为会员，阅读 Medium 上的每一个故事！</p></div></div>    
</body>
</html>