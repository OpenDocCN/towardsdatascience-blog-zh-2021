<html>
<head>
<title>Urban Health Part 2: Predicting Food Insecurity in Developing Countries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">城市健康第2部分:预测发展中国家的粮食不安全</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/urban-health-part-2-predicting-food-insecurity-in-developing-countries-8cf39e15ecec?source=collection_archive---------41-----------------------#2021-06-24">https://towardsdatascience.com/urban-health-part-2-predicting-food-insecurity-in-developing-countries-8cf39e15ecec?source=collection_archive---------41-----------------------#2021-06-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b9c39fb108974d9fc361e61556bd55c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9dveE6zwcd69-AV1"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@ddawng_rosie?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">nguyễn</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b9fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个故事是我的城市健康教程的第二部分。在这个故事中，我们将使用各种机器学习技术预测发展中国家的粮食不安全状况。你可以在这里找到第一部分:<a class="ae kc" rel="noopener" target="_blank" href="/healthiest-cities-in-the-us-part-1-food-62b9724467e8">https://towards data science . com/healthy-cities-in-the-us-part-1-food-62b 9724467 E8</a></p><h2 id="41d7" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated"><strong class="ak">工具和数据</strong></h2><ul class=""><li id="a641" class="lu lv iq kf b kg lw kk lx ko ly ks lz kw ma la mb mc md me bi translated">Python，Jupyter笔记本，Sklearn，Pandas，Numpy，Seaborn，Scipy</li><li id="5049" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated">数据:<a class="ae kc" href="https://data.humdata.org/dataset" rel="noopener ugc nofollow" target="_blank">https://data.humdata.org/dataset</a></li></ul><p id="9336" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该数据集是通过收集28个国家的食品数据创建的，包含以下变量:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="1883" class="lb lc iq mp b gy mt mu l mv mw">'Dietary_Adj', 'Food_Production', 'Dietary_Supply', 'Cereal_Supply',<br/>       'Average protein supply (g/cap/day) (3-year average)',<br/>       'Average supply of protein of animal origin (g/cap/day) (3-year average)',<br/>       'GDP', 'Prevalence of undernourishment (percent) (3-year average)',<br/>       'Number of people undernourished (million) (3-year average)',<br/>       'Severe_Food_Insec', 'Mod_Sev_Inad',<br/>       'Number of severely food insecure people (million) (3-year average)',<br/>       'Number of moderately or severely food insecure people (million) (3-year average)',<br/>       'Cereal import dependency ratio (percent) (3-year average)',<br/>       'Percent of arable land equipped for irrigation (percent) (3-year average)',<br/>       'Value of food imports in total merchandise exports (percent) (3-year average)',<br/>       'Political stability and absence of violence/terrorism (index)',<br/>       'Per capita food production variability (constant 2004-2006 thousand int$ per capita)',<br/>       'Per capita food supply variability (kcal/cap/day)',<br/>       'Percentage of population using at least basic drinking water services (percent)',<br/>       'Percentage of population using at least basic sanitation services (percent)',<br/>       'Percentage of children under 5 years affected by wasting (percent)',<br/>       'Percentage of children under 5 years of age who are stunted (percent)',<br/>       'Percentage of children under 5 years of age who are overweight (percent)',<br/>       'Prevalence of obesity in the adult population (18 years and older)',<br/>       'Prevalence of anemia among women of reproductive age (15-49 years)',<br/>       'Prevalence of exclusive breastfeeding among infants 0-5 months of age',<br/>       'Prevalence of low birthweight (percent)'</span></pre><h2 id="e7f5" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated"><strong class="ak">数据清理和预处理</strong></h2><p id="4cdb" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">初始数据包括2003年至2019年期间约28个国家及其食品相关指标。这是一张快照:</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/55b911986a2fa57328db0b56168cd975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dj_rIUkSRJdlJHDIW94byw.png"/></div></div></figure><p id="6305" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如您所见，这些指标分布在各个行上，每一行都代表该特定指标一年的价值。让我们转换数据，将这些变量作为列名:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="29cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是更改后的数据集:</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/0f67df48998d41904b3d58de177ad22f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bSwN1AJ3vOYCIFh3Ny4ECg.png"/></div></div></figure><p id="4f87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们继续可视化之前，我们还需要修正NaNs和N/A类型值。使用此函数可以轻松解决前者:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="2bb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了固定N/A虚拟值，我将它们替换为1，然后取每列中其他非1值的平均值，如下所示:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h2 id="8bb3" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">(英)可视化(= visualization)</h2><p id="333e" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">现在我们有了一个干净的数据集，让我们更熟悉一下这些数据。我们将寻找正态分布，因为正态是机器学习数据的一般假设。首先，这是一张所有国家平均膳食能量供应充足度的图表，符合一条相对正常的正态分布线:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/f74494fc5bafb572691a83d43635c9aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*LNczgp6HapNbExHWhY9ljw.png"/></div></figure><p id="723f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，让我们看看另一个变量是如何分布的，即“中度和重度食物不足”，它看起来也聚集在40左右，但仍然是正常的:</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/987c0a7412160bf51eca06070ac0c882.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*nRwLUrdS2HBcem9X1v-krw.png"/></div></figure><p id="23fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们希望这些变量中的许多变量相互关联，因为它们是不同的饮食指标。让我们使用热图<strong class="kf ir"> : </strong>来想象一下</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c62e40e7d1a6f6bcdedd59d1d005701a.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*mHktpcR-Hxl6OuLK9IlAvQ.png"/></div></figure><p id="40c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你所看到的，诸如膳食供应等变量与食物不足呈负相关，这是可以预料的。然而，国内生产总值与膳食充足性的相关性很弱(0.58)，这可能令人惊讶。</p><h2 id="e7ed" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">线性回归</h2><p id="2cc7" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">现在，我们可以开始让模型适合我们的数据集。我们将使用数据中的所有列(除了我们正在预测的那一列)来预测平均膳食能量供应充足性。我们可以从一个简单的线性回归模型开始:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="2625" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用的测试规模为数据的0.2或20%，随机状态等于27。让我们看看斜率和截距是多少:</p><ul class=""><li id="9599" class="lu lv iq kf b kg kh kk kl ko nh ks ni kw nj la mb mc md me bi translated"><strong class="kf ir">系数(斜率):</strong>56660 . 68686868661</li><li id="5954" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated"><strong class="kf ir">截距:</strong>【4.64360863 e-03，3.89312086e-02，-6.49480051e-02，-1.59175835e-02，<br/> 1.38100769e-02，-1.06957325e-04，7.38095045e-02，6.35949018e-03</li></ul><p id="e0e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了衡量我们的模型有多好，我们可以使用sklearn的一些内置指标:</p><ul class=""><li id="6983" class="lu lv iq kf b kg kh kk kl ko nh ks ni kw nj la mb mc md me bi translated">均方误差</li></ul><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="c763" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">顾名思义，均方误差衡量的是误差平方的平均值。误差被定义为实际值和预测值之间的差异。线性回归模型的误差约为2.72。与以下两个指标一起，它可以用来确定一个模型有多好。</p><ul class=""><li id="9201" class="lu lv iq kf b kg kh kk kl ko nh ks ni kw nj la mb mc md me bi translated">绝对平均误差</li></ul><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="e922" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">平均绝对误差是误差绝对值的平均值，在我们的模型中，它约为1.65。</p><ul class=""><li id="ca93" class="lu lv iq kf b kg kh kk kl ko nh ks ni kw nj la mb mc md me bi translated">r的平方</li></ul><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="e1fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">R square衡量数据点与模型预测线的接近程度。分数越高，模型的表现越好。</p><h2 id="c623" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">里脊回归</h2><p id="71e4" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">我们也可以使用岭回归来预测我们的变量。当数据存在多重共线性时，通常使用岭回归，即当一些预测变量与其他预测变量相关时，其主要好处是<strong class="kf ir">避免数据</strong>的过度拟合。这个模型可以很容易地构建成这样:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="436e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们看看山脊模型的三个指标:</p><ul class=""><li id="5000" class="lu lv iq kf b kg kh kk kl ko nh ks ni kw nj la mb mc md me bi translated">r的平方值:0.9662149081149515</li><li id="0655" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated">平均绝对误差:1.6。36860.68686868661</li><li id="f565" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated">均方误差:2。38860 . 68868686861</li></ul><p id="f0f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">R平方值略低于线性回归模型，因为平均绝对误差和均方误差非常相似。我们能进一步调整这个模型以提高它的性能吗？</p><h2 id="ed2d" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">测试各种α值</h2><p id="37bb" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">在这里，我们将查看一组将传递给模型的alpha值，然后构建一个散点图来查看它们的R平方值:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/2da09706b501fbe631a57182e9652f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*Em1cqQg5kv9ce9ng46i9PA.png"/></div></figure><p id="bb76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如您所见，alpha的最佳值是0.001和0.01，因为它们产生最高的R平方值。</p><h2 id="f264" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">套索回归</h2><p id="cd03" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">另一种回归技术是套索回归。它与岭回归有相似的用例，因为它也减少了过度拟合。拟合该模型的代码如下:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="1faa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是lasso回归的指标:</p><ul class=""><li id="70f7" class="lu lv iq kf b kg kh kk kl ko nh ks ni kw nj la mb mc md me bi translated">r的平方是:0.964876876866</li><li id="dc24" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated">平均绝对误差:1.646868686866</li><li id="3cee" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated">均方误差:2.864886888866</li></ul><p id="cbe1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">lasso回归的指标稍差，尤其是误差值。我们可以使用不同的alpha值来优化模型吗？</p><h2 id="95d4" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">测试各种α值</h2><p id="2c2a" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">让我们像处理岭回归一样输入多个α值。下面是alpha数组(0.001，0.01，0.1，1，10)与均方误差的散点图:</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/2132ab3ea58a5fff63d76703620deef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*D-v6m-Xw8ORk1IWwGtAPuw.png"/></div></figure><p id="f063" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如您所见，alpha值为0.001、0.01、0.1时，错误率最低。</p><h2 id="7810" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">随机森林</h2><p id="3307" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">作为我们的最后一个模型，我们将为数据集拟合一个随机森林回归量。这方面的代码如下:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="62aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是衡量标准:</p><ul class=""><li id="4f8e" class="lu lv iq kf b kg kh kk kl ko nh ks ni kw nj la mb mc md me bi translated">r的平方是:0.987686868866</li><li id="2061" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated">均方误差:1.00003863686</li><li id="3766" class="lu lv iq kf b kg mf kk mg ko mh ks mi kw mj la mb mc md me bi translated">平均绝对误差:1.000038686866</li></ul><p id="00bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">需要注意的一点是，随机森林模型的误差值似乎有所减少，这可能会使其更好地用于现实世界的数据集。</p><h2 id="0572" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">做预测</h2><p id="a1a9" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko mx kq kr ks my ku kv kw mz ky kz la ij bi translated">现在我们已经建立了几个模型，我们可以用它们来做一些预测。让我们挑选一些国家，比如塞尔维亚和印度尼西亚，看看这个模型对他们的平均膳食能量供应充足性的预测是什么:</p><figure class="mk ml mm mn gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="ecdd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面可以看出，模型预测值分别为119.07和114.52。现在我们已经建立了一些模型并对它们进行了评估，是时候继续建立神经网络来进行与食物相关的预测了。这将是本系列的第3部分。感谢您的阅读，您可以在这里找到代码:</p><div class="nm nn gp gr no np"><a href="https://github.com/DeaBardhoshi/Data-Science-Projects/blob/main/Urban%20Health%2C%20Part%202%20Developing%20Countries%20-%20Machine%20Learning%20Algorithms.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">数据科学项目</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">在GitHub上创建一个帐户，为DeaBardhoshi/数据科学项目的发展做出贡献。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">github.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od jw np"/></div></div></a></div></div></div>    
</body>
</html>