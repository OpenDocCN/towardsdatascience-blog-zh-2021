<html>
<head>
<title>What is a Generalised Additive Model?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是广义加性模型？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generalised-additive-models-6dfbedf1350a?source=collection_archive---------1-----------------------#2021-05-18">https://towardsdatascience.com/generalised-additive-models-6dfbedf1350a?source=collection_archive---------1-----------------------#2021-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2270" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及您为什么需要了解它…</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/6da8d73880df159133dabad28036c8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*oMjo7R80uJ5rAuG61evEdA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">使用线性模型与GAM的效果。图片作者。</p></figure><h1 id="9f8f" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">介绍</h1><p id="9289" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">线性模型被认为是模型的瑞士军刀。我们可以进行许多调整，以使模型在各种条件和数据类型下表现良好。</p><p id="aa9e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">广义加性模型(gam)是一种适应，它允许我们在保持可解释性的同时对非线性数据建模。</p><h1 id="f6c3" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">目录</h1><ul class=""><li id="cec7" class="mn mo it lo b lp lq ls lt lv mp lz mq md mr mh ms mt mu mv bi translated"><a class="ae mw" href="#c407" rel="noopener ugc nofollow">什么是GAM？</a></li><li id="ad32" class="mn mo it lo b lp mx ls my lv mz lz na md nb mh ms mt mu mv bi translated"><a class="ae mw" href="#4a2c" rel="noopener ugc nofollow">数据集</a></li><li id="1583" class="mn mo it lo b lp mx ls my lv mz lz na md nb mh ms mt mu mv bi translated"><a class="ae mw" href="#232f" rel="noopener ugc nofollow">用线性回归估计非线性函数</a></li><li id="08a5" class="mn mo it lo b lp mx ls my lv mz lz na md nb mh ms mt mu mv bi translated"><a class="ae mw" href="#fb90" rel="noopener ugc nofollow">GAMs是如何工作的？</a></li><li id="7c5a" class="mn mo it lo b lp mx ls my lv mz lz na md nb mh ms mt mu mv bi translated"><a class="ae mw" href="#64f7" rel="noopener ugc nofollow">将GAMs应用于自行车数据集</a></li><li id="decf" class="mn mo it lo b lp mx ls my lv mz lz na md nb mh ms mt mu mv bi translated"><a class="ae mw" href="#6dcc" rel="noopener ugc nofollow">游戏玩家如何工作第二部分</a></li><li id="9f5c" class="mn mo it lo b lp mx ls my lv mz lz na md nb mh ms mt mu mv bi translated"><a class="ae mw" href="#6b0a" rel="noopener ugc nofollow">使用PyGAM实现线性GAM </a></li><li id="1d51" class="mn mo it lo b lp mx ls my lv mz lz na md nb mh ms mt mu mv bi translated"><a class="ae mw" href="#a505" rel="noopener ugc nofollow">结论</a></li></ul><h1 id="c407" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">什么是GAM？</h1><p id="75f7" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">GAM是一个线性模型，与广义线性模型(如线性回归)相比有一个关键的区别。允许游戏者学习非线性特征。</p><blockquote class="nc"><p id="10d3" class="nd ne it bd nf ng nh ni nj nk nl mh dk translated">gam放宽了关系必须是简单加权和的限制，而是假设结果可以通过每个特征的任意函数的和来建模。</p></blockquote><p id="5b09" class="pw-post-body-paragraph lm ln it lo b lp nm ju lr ls nn jx lu lv no lx ly lz np mb mc md nq mf mg mh im bi translated">为此，我们简单地用一个允许非线性关系的灵活函数替换线性回归的β系数(我们将在后面研究数学)。</p><p id="6ed7" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这种灵活的功能称为<strong class="lo iu">花键</strong>。样条是复杂的函数，允许我们为每个特征建立非线性关系模型。许多样条的总和形成一个GAM。结果是一个高度灵活的模型，仍然具有线性回归的一些解释能力。</p><p id="0ce9" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">让我们了解一下如何在没有gam的情况下对非线性特征建模。</p><h1 id="4a2c" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">资料组</h1><p id="9773" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">这篇文章将使用经典的自行车共享数据集，可以从<a class="ae mw" href="https://www.kaggle.com/c/bike-sharing-demand" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载。该数据集跟踪华盛顿特区的自行车租赁数据</p><p id="d84a" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这篇文章的笔记本在这里:</p><div class="nr ns gp gr nt nu"><a href="https://github.com/AdamShafi92/GAM" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">亚当沙菲92/GAM</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">探索广义加性模型探索广义加性模型游戏中期后配套笔记本…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ko nu"/></div></div></a></div><h1 id="232f" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">用线性回归估计非线性函数</h1><p id="b6a8" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><strong class="lo iu">世界不是线性的。这意味着线性回归并不总是代表我们在现实中看到的。有时线性关系是足够好的估计，但通常不是。</strong></p><p id="7b4a" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">让我们来看看一天中每小时<strong class="lo iu">的</strong>自行车租金中位数</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="db97" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">正如所料，这不是线性的。那么如果我们拟合一个简单的线性回归会发生什么呢？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="b8bd" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">还是那句话，不出所料，这行没有太大意义。它没有抓住我们的关系，我们不能真正使用这个模型。</p><p id="a009" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">值得注意的是，我确实做了一点小手脚，我没有对小时进行编码，这意味着模型将每个值都视为递增，然而我认为我的观点仍然有效..</p><p id="4115" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">让我们试着把这模拟成一种非线性关系。为此，我们使用<em class="ol">小时</em>变量创建多项式特征，例如小时、小时等。随着多项式的<strong class="lo iu">阶</strong>变得更高，我们使用更多的变量，因此对于5阶，我们使用x，x，x ,x⁴和x⁵.</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/b1fa005f54dc6cab6627b282ee065fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*blnka6kuADto6FIf9v4WoQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">多项式特征。图片作者。</p></figure><p id="c0cb" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在本例中，我让<strong class="lo iu">在<strong class="lo iu">小时0-21</strong>和<strong class="lo iu">预测小时22-23训练</strong>模型。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="978b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们可以看到，x模型比线性模型做得更好，高阶模型能够很好地模拟我们的关系，挑选出早上和下午的峰值。</p><p id="b045" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">然而，如果我们看看预测点(22小时和23小时)……灾难！我们曾经遇到过<a class="ae mw" href="https://en.wikipedia.org/wiki/Runge%27s_phenomenon" rel="noopener ugc nofollow" target="_blank"> <strong class="lo iu">龙格效应</strong> </a> <strong class="lo iu">。</strong></p><blockquote class="nc"><p id="e26b" class="nd ne it bd nf ng nh ni nj nk nl mh dk translated">龙格现象发现，当我们使用高阶多项式时，函数的边缘可能会振荡到极值，这意味着具有多项式特征的模型并不总是会产生更好的值。</p></blockquote><p id="2f2f" class="pw-post-body-paragraph lm ln it lo b lp nm ju lr ls nn jx lu lv no lx ly lz np mb mc md nq mf mg mh im bi translated">如果我们看看我们的x ⁰模型，我们可以看到，一旦它预测到什么，橙色线就会射向平流层。<strong class="lo iu">这不好。它不仅不准确，还凸显出我们不知道这个模型会对看不见的数据做什么。如果我们想要部署这个模型，并让这个简单的模型变得几乎完全不可理解，这是一个巨大的风险。</strong></p><p id="e48c" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">那么我们如何用一个简单的模型来模拟这种非线性关系呢？</p><p id="7597" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">进入GAM。</strong></p><h1 id="fb90" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">GAM的作品是怎么做的？</h1><h2 id="023c" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">从直线到样条曲线</h2><p id="f20d" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">让我们暂时回到我们的线性回归。该方程由变量的<strong class="lo iu">线性组合之和定义。每个变量被赋予一个权重β并相加。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/54b4458ed2bbaff5802fdcb633815336.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*2SMuwtIYRC7Oq6Ma6CJYyA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">线性回归方程。图片作者。</p></figure><p id="22ae" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在GAMs中，我们放弃了可以使用变量的线性组合来计算我们的目标的假设，只是简单地说我们可以使用变量的非线性组合，用<em class="ol"> s、</em>表示“<strong class="lo iu">平滑函数</strong>”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="pb pc di pd bf pe"><div class="gh gi pa"><img src="../Images/f83cd74133a06d7856528920ce967e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*1IDSsTE71T6ZGTprhtIFiQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">广义加性模型(GAM)方程。s是一个光滑函数。作者图片</p></figure><p id="21e1" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">但是这是什么呢？我们用下面的等式定义它，这里我们看到β回来了，它表示同样的东西；一个砝码。我们的另一个术语，<em class="ol"> b </em>是在<em class="ol">基础上的扩展</em>。基展开就是我们之前对多项式所做的，取x⁰，x，x等。还有其他的基函数，它们可以是多维的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/23b73523dc02ac1c9ab9e152e7f018d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*sa0gfCOqQbv1wdbxNPDLCw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">光滑函数方程。图片作者。</p></figure><p id="186e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">最棒的是，我们可以在方程中为每个变量设置权重和函数。这比我们的线性回归灵活得多，线性程度也低得多。</p><p id="3c8c" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这个<strong class="lo iu">平滑函数</strong>也被称为<strong class="lo iu">样条。</strong>不幸的是，样条真的很难定义，它们本质上是覆盖小范围的多项式函数。如果我们将样条可视化，它们会更容易理解。这里有一个4条样条线的例子，来自GAM，我们将很快拟合！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/b3650173a28541c611dfd8c4b282f4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*VzOEvdZ-xP1RkGaWN67Jng.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">从自行车数据集中的GAM拟合中随机选择4条样条曲线。图片作者。</p></figure><p id="13b5" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如你所见，这些都是小范围的平滑函数。它们在外观上可以变化，甚至可以是线性的。让我们将GAM应用于我们的问题，并尝试理解样条函数，而不是通过更多的理论。</p><blockquote class="nc"><p id="12c2" class="nd ne it bd nf ng nh ni nj nk nl mh dk translated">“定义这些样条函数的方法多得令人困惑。如果您有兴趣了解更多有关定义样条曲线的所有方法，我祝您旅途愉快”</p><p id="8a69" class="nd ne it bd nf ng nh ni nj nk nl mh dk translated">- <em class="ph"> Christoph Molnar，可解释机器学习</em></p></blockquote><p id="3395" class="pw-post-body-paragraph lm ln it lo b lp nm ju lr ls nn jx lu lv no lx ly lz np mb mc md nq mf mg mh im bi translated"><a class="ae mw" href="https://christophm.github.io/interpretable-ml-book/extend-lm.html" rel="noopener ugc nofollow" target="_blank">点击这里查看克里斯托弗的书</a></p><h1 id="64f7" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">将gam应用于自行车数据集</h1><p id="9944" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">让我们继续用一个游戏来解决前面的问题</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="cbca" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如你所见，GAM在评估我们的函数方面做得更好。它遵循曲线，在我们预测的点上(22小时和23小时)，没有龙格现象的迹象。</p><p id="2093" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">那么这是如何工作的呢？我们使用了12个<strong class="lo iu">花键。</strong>还记得我们上面看到的4条样条线吗？我们可以查看整个特征空间中的所有12个。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="0c86" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这看起来不像与我们的曲线相关，这是因为每个样条函数<strong class="lo iu">也有一个权重</strong>。我们可以将函数输出乘以系数，以了解模型在24小时内的表现。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="9420" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">现在这看起来更像我们的曲线！希望这是直观的原因。<strong class="lo iu">曲线只是我们个人样条的总和</strong>！不要忘记顶部绿色的截距术语。</p><p id="98b4" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这是单个变量的问题，但是GAM可以很容易地应用于多个变量。我们甚至可以选择每个变量的样条<strong class="lo iu">数量——我们不需要每个变量都有相同的数量。我们也可以手动编程变量之间的交互。</strong></p><h1 id="6dcc" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">GAM理解第二部分</h1><p id="896f" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">关于游戏还有很多需要理解的地方，我将在以后的文章中讨论。这里我们只看了一个变量。GAM的工作对很多人来说都很好，但是我们以后再看这个。以下是主要概念的概述</p><h2 id="6e37" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">摇摆</h2><p id="57e8" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">波动就是我们的线有多波动。这是描述这个的正确术语！我们包含的样条越多，我们的线相对于我们的特征就越扭曲。这样做的问题是，它将开始过度适应我们的数据。我们需要找到正确数量的样条曲线，这样模型就可以学习问题，并很好地概括。</p><h2 id="024b" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">防止过度拟合</h2><p id="21ee" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">幸运的是，我们不仅仅需要猜测样条的数量。我们有另一个参数叫做<em class="ol">λ，λ。</em>这不利于我们的样条曲线。λ越高，我们的线就越不摆动，直到它变成一条直线。</p><p id="efa3" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在下图中，我们可以看到使用大量的样条和低<em class="ol"> λ </em>导致一个非常<strong class="lo iu">摆动</strong>线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/4e6995707c99eeba290a3cc70181c3d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*AHUBQvDT1KWnJOcy8vsgyg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">样条和λ值的比较。图片作者。</p></figure><p id="3b80" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">一般的经验法则是使用大量的<strong class="lo iu">样条</strong>并使用<strong class="lo iu">λ</strong>(λ)值的交叉验证来找到最通用的模型。记住，我们可以为模型中的每个变量设置不同的<strong class="lo iu">样条</strong>和<strong class="lo iu">λ</strong>值。</p><h2 id="1c7d" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">链接功能</h2><p id="22d5" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">很像常规的广义线性模型，链接函数可以用于不同的分布；用于分类问题的<em class="ol"> Logit </em>函数或用于对数转换的<em class="ol"> Log </em>。</p><h2 id="1eb7" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">分布</h2><p id="0dca" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我们还可以选择不同的分布，如泊松分布、二项式分布、正态分布。</p><h2 id="2c0d" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">张量积</h2><p id="1306" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我们可以在游戏中设计互动。这被称为张量积。这样我们就可以模拟变量之间的相互作用，而不是孤立地考虑每个变量。</p><h1 id="6b0a" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">使用PyGAM实现线性GAM</h1><p id="33fa" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">根据我的研究，似乎R 中的<a class="ae mw" href="https://cran.r-project.org/web/packages/mgcv/mgcv.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="ol"> mgcv </em>包最适合GAMs。但是，我更喜欢Python两个最好的选择是</a><a class="ae mw" href="https://www.statsmodels.org/stable/gam.html" rel="noopener ugc nofollow" target="_blank"> Statsmodels </a>和<a class="ae mw" href="https://pygam.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> PyGAM </a>。</p><p id="de65" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">以下是如何使用PyGAM来适应GAM。这是假设您的数据已经过清理和预处理，可以进行建模，并且您的数据已经拆分为训练数据集和测试数据集。</p><pre class="kj kk kl km gt pj pk pl pm aw pn bi"><span id="1d3c" class="on kv it pk b gy po pp l pq pr">import numpy as np<br/>import pandas as pd</span><span id="f7d4" class="on kv it pk b gy ps pp l pq pr">from pygam import GAM, LinearGAM, s, f, te</span><span id="9aaa" class="on kv it pk b gy ps pp l pq pr"># your training and test datasets should be split as X_train, X_test, y_train, y_test</span><span id="f2ba" class="on kv it pk b gy ps pp l pq pr">n_features = 1 # number of features used in the model<br/>lams = np.logspace(-5,5,20) * n_features<br/>splines = 12 # number of splines we will use</span><span id="a7c6" class="on kv it pk b gy ps pp l pq pr"># linear GAM for Regression</span><span id="d4c2" class="on kv it pk b gy ps pp l pq pr">gam = LinearGAM(<br/>                s(0,n_splines=splines))<br/>     .gridsearch(<br/>                X_train.values, <br/>                y_train.values,<br/>                lam=lams)<br/>gam.summary()</span><span id="5057" class="on kv it pk b gy ps pp l pq pr">print(gam.score(X_test,y_test))</span></pre><p id="5fe6" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">PyGAM有更多的深度，因为它提供了多种游戏类型。查看PyGAM文档，了解其他类型的GAM(例如用于分类)和不同的可用地块类型。</p><div class="nr ns gp gr nt nu"><a href="https://pygam.readthedocs.io/en/latest/notebooks/tour_of_pygam.html" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">pyGAM - pyGAM文档之旅</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">广义可加模型是光滑的半参数模型，其形式为:\[g(\mathbb{E}[y|X]) = \beta_0 +…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">pygam.readthedocs.io</p></div></div><div class="od l"><div class="pt l of og oh od oi ko nu"/></div></div></a></div><h1 id="a505" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">结论</h1><p id="bfcf" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">这是一次短暂的GAMs之旅！希望你现在知道什么是<strong class="lo iu">样条</strong>，以及我们如何使用它们来建模<strong class="lo iu">非线性数据</strong>。因为我们可以理解我们的模型将如何对看不见的数据做出反应，我们必须明确地包括交互，游戏被认为是相对<strong class="lo iu">可解释的</strong>。</p><blockquote class="nc"><p id="7549" class="nd ne it bd nf ng nh ni nj nk nl mh dk translated">当我们需要非线性数据的可解释模型时，gam是最好的。</p></blockquote><p id="0f89" class="pw-post-body-paragraph lm ln it lo b lp nm ju lr ls nn jx lu lv no lx ly lz np mb mc md nq mf mg mh im bi translated">在我的下一篇关于GAMs的文章中，我们将通过一个更复杂的分类问题的视角来看待波动、过度拟合、分布、连接函数和张量积。</p><h2 id="9a68" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">了解更多信息</h2><div class="nr ns gp gr nt nu"><a rel="noopener follow" target="_blank" href="/5-project-ideas-91da0da17b31"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">启动您的数据科学职业生涯的5个项目创意</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">成功项目的框架。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">towardsdatascience.com</p></div></div><div class="od l"><div class="pu l of og oh od oi ko nu"/></div></div></a></div><h2 id="66e9" class="on kv it bd kw oo op dn la oq or dp le lv os ot lg lz ou ov li md ow ox lk oy bi translated">将我的内容直接发送到您的收件箱！</h2><div class="nr ns gp gr nt nu"><a href="https://adamsh.substack.com/p/coming-soon" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">Data Siens:机器学习技巧、诀窍和教程的资源。</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">欢迎来到亚当的数据西恩斯。我是一名数据科学家，有5年的分析经验。我喜欢谈论任何事情…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">adamsh.substack.com</p></div></div><div class="od l"><div class="pv l of og oh od oi ko nu"/></div></div></a></div></div></div>    
</body>
</html>