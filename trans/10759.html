<html>
<head>
<title>10 Most Important SQL Commands Every Data Analyst Needs to Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个数据分析师都需要知道的10个最重要的SQL命令</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/10-most-important-sql-commands-every-data-analyst-needs-to-know-f0f568914b98?source=collection_archive---------6-----------------------#2021-10-18">https://towardsdatascience.com/10-most-important-sql-commands-every-data-analyst-needs-to-know-f0f568914b98?source=collection_archive---------6-----------------------#2021-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c16f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从数据库中查询数据并不复杂</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ee8a0b53825fa99c9558adf76ee36785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f02QyjGieFfk_m8k"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@shunyakoide?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍摄的照片</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="3824" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据分析师或数据科学家，无论你在创建奇特的可视化效果方面有多擅长，或者在构建复杂的模型方面有多熟练，都没有关系——从本质上讲，你需要数据来做这些事情。</p><p id="0248" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在大公司工作时，这些数据通常存储在数据库中，这样每个人都可以轻松地访问和查询他们工作所需的数据。</p><p id="34f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你如何查询这些数据？这就是SQL的用武之地。</p><p id="2ac0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SQL是结构化查询语言的缩写，顾名思义，它是一种用于从关系数据库中查询或检索数据的标准化语言。此外，它还可以用于对数据执行各种操作，如过滤行和列以及简单的数据操作。</p><p id="9e8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我开始作为一名数据分析师工作时，我最早的观察之一是我周围的每个人都知道如何使用SQL，我指的是几乎每个人。无论你是刚入队不久的实习生，还是从业已久的资深分析师，这都是大家需要了解的技能。这表明了SQL在数据科学分析领域的重要性。</p><p id="0988" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有鉴于此，我想在这篇博客文章中重点介绍10大SQL命令，以帮助您开始使用SQL的旅程，但更重要的是，我将使用实际示例演示每个命令，以模拟实际使用数据库的感觉。</p><p id="0ebb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将使用<a class="ae ky" href="http://sqlfiddle.com/#!17/c37c5" rel="noopener ugc nofollow" target="_blank"> SQL Fiddle </a>，这是一个方便的在线测试和共享SQL查询的应用程序。出于本教程的目的，我创建了两个模拟表transaction和customers，它们分别代表一个连锁超市的事务和客户概要。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3ad7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.选择和从</h1><p id="07ab" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">SELECT</code>和<code class="fe mz na nb nc b">FROM</code>构成了所有SQL查询的基础。最基本的SQL查询将涉及这两个命令，随着查询变得越来越复杂，将在它们之上添加更多的命令。</p><p id="a0dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mz na nb nc b">SELECT</code>通知您想要选择哪些列，而<code class="fe mz na nb nc b">FROM</code>指定您想要从哪个表中查询数据。</p><p id="b9d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看一些与事务表相关的例子。</p><p id="d891" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要查看事务表中的所有列，请执行以下操作:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="d3f7" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM transaction;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/90c6a343ba1ab7803505d7d8fc698390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzpCU-w_SXMMXM4DDioUYg.png"/></div></div></figure><p id="a093" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们只需要事务表中的特定列:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="0a58" class="nh md it nc b gy ni nj l nk nl">SELECT transaction_id, purchase_date, sales<br/>FROM transaction;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/0e43751142308fcec96f2c2ba1e4fbc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmjwCsPo3nN68VeATMfJWA.png"/></div></div></figure><h1 id="d887" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">2.明显的</h1><p id="9576" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">DISTINCT</code>用于查看一列中的唯一值。例如，假设我们希望看到交易的唯一日期:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2f96" class="nh md it nc b gy ni nj l nk nl">SELECT DISTINCT purchase_date<br/>FROM transaction;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/415adb3ff0ce9f2d3c0907466d2aec0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:328/format:webp/1*OJzTeIDmEM5J4dpEeN---w.png"/></div></figure><h1 id="c368" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">3.在哪里</h1><p id="3103" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">WHERE</code>用于过滤符合特定条件的行。此外，它还经常与其他运算符如<code class="fe mz na nb nc b">AND</code>、<code class="fe mz na nb nc b">OR</code>、<code class="fe mz na nb nc b">BETWEEN</code>、<code class="fe mz na nb nc b">IN</code>、<code class="fe mz na nb nc b">LIKE</code>一起使用，将多个条件组合在一起。</p><p id="8b93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是一些例子:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="07cc" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM transaction<br/>WHERE purchase_date = '2021-10-15';</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/e23614507f9d7ed370f625c5d34f2e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHbJ7jzoLlLRAoEKCjxMVw.png"/></div></div></figure><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="7673" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM transaction<br/>WHERE purchase_date = '2021-10-15'<br/>AND store_location = 'Melbourne CBD';</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/0787aee90b414fffacf0479826b620bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-yQyKq_sN-0FkFL_-u_fxA.png"/></div></div></figure><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="8242" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM transaction<br/>WHERE purchase_date = '2021-10-15'<br/>OR store_location = 'Melbourne CBD';</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/7eadeef5f1080c9951d83228ed88e21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNEUyCw3yZfa6omyqhMDkw.png"/></div></div></figure><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="cfab" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM transaction<br/>WHERE store_location IN ('Richmond', 'Brunswick', 'Kew');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/48e9396ab897d07e8a9b1ddfe0a9a726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bAs5X3HiPGhAOk1eM4y69Q.png"/></div></div></figure><h1 id="8487" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">4.%通配符</h1><p id="1c66" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在<code class="fe mz na nb nc b">LIKE</code>操作符中使用了<code class="fe mz na nb nc b">%</code>通配符来匹配字符串模式。</p><p id="af4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们研究这个通配符如何工作之前，让我们首先检查一下customer profile表。这张表告诉我们一个特定客户的生命阶段和保费状况。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="ee99" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM customers;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/658b74ef5bc28c37d2e21444f1f1ea0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vs8ZVOQL-lznCYKNMEIVEA.png"/></div></div></figure><p id="360b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设现在我们要过滤掉客户表中客户生命阶段以单词Young开始的行。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="3e9a" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM customers <br/>WHERE customer_lifestage LIKE 'Young%';</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/83af5ca79631519c57afef2f1ef76f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bhHPQvCeepY_IrZ_9yR6hw.png"/></div></div></figure><p id="b9ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，如果我们想要查看客户生命阶段以单词families结束的行。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="156e" class="nh md it nc b gy ni nj l nk nl">SELECT *<br/>FROM customers <br/>WHERE customer_lifestage LIKE '%families';</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/70983d4d874e5f020ddd511be879d436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6uiRtVyfPO-FFzangnko-A.png"/></div></div></figure><p id="9072" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所看到的，SQL提供了一种快速而直接的方法来匹配字符串模式，这在许多情况下过滤掉行时非常方便。</p><h1 id="45e9" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">5.以...排序</h1><p id="8592" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">ORDER BY</code>可用于按字母顺序或数字顺序对特定列的查询结果进行排序。可以有两种排序方式:<code class="fe mz na nb nc b">DESC</code>降序，或者<code class="fe mz na nb nc b">ASC</code>升序。尽管您会注意到大多数人不会在他们的查询中写<code class="fe mz na nb nc b">ASC</code>,因为SQL默认设置了这一点。</p><p id="c396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示这一点，假设我们希望根据销售额对交易进行升序排序。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="6f79" class="nh md it nc b gy ni nj l nk nl">SELECT store_location, sales<br/>FROM transaction <br/>ORDER BY sales;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/cdafb19a82fab7940209e90a8fa9a51d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yXBV3y6rK3aKNg_9k7OpVw.png"/></div></div></figure><p id="8581" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，我们也可以根据销售额对交易进行降序排序。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="4507" class="nh md it nc b gy ni nj l nk nl">SELECT store_location, sales<br/>FROM transaction <br/>ORDER BY sales DESC;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/dbd35ae0ac0cf996d7320389f78b42a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5agzL4vQdUHW_B2uV1E8iw.png"/></div></div></figure><h1 id="66db" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">6.如同</h1><p id="d939" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">AS</code>使我们能够重命名列或表。请注意，这不会直接改变其原始列或表中的名称。</p><p id="235f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给定的查询将从事务表中返回日期列，其中<em class="oa">购买日期</em>被重命名为<em class="oa">日期</em>。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="f2c3" class="nh md it nc b gy ni nj l nk nl">SELECT purchase_date as date<br/>FROM transaction;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4b91d395608a27c880311fa49a401ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:170/format:webp/1*eX0ftEsM7b7LIP52eQzDqw.png"/></div></figure><h1 id="1f9d" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">7.CASE WHEN，ELSE and THEN</h1><p id="e676" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您以前使用过任何其他编程语言，这与if-else语句非常相似。</p><p id="d15d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实际上，用简单的英语来说，这个命令听起来有点像这样:如果满足一个条件，就这样做，否则就那样做。</p><p id="2589" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个例子来巩固这个想法。</p><p id="dd19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想要创建一个新列，告诉我们特定交易的销售额是否超过20美元。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2806" class="nh md it nc b gy ni nj l nk nl">SELECT transaction_id, sales,<br/>CASE WHEN sales &lt; 20 THEN 'Sales amount is less than $20'<br/>ELSE 'Sales amount is greater than $20' END AS sales_threshold <br/>FROM transaction;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/f9576b989343a05220d59be0e89fbb56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H1sm60n9FvkL2-uCUH5bRQ.png"/></div></div></figure><h1 id="16d3" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">8.分组依据和聚合函数</h1><p id="87d9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">GROUP BY</code>将根据相同的值对数据进行分组。它经常与聚合函数一起使用，以总结特定数据组的属性。</p><p id="eb88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，聚合函数对一系列值执行计算，并返回单个值。聚合函数的一些示例包括:</p><ul class=""><li id="64cc" class="oc od it lb b lc ld lf lg li oe lm of lq og lu oh oi oj ok bi translated"><code class="fe mz na nb nc b">COUNT</code>:返回总行数</li><li id="875b" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated"><code class="fe mz na nb nc b">SUM</code>:返回所有值的总和</li><li id="6749" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated"><code class="fe mz na nb nc b">MAX</code>:返回最大值</li><li id="3093" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated"><code class="fe mz na nb nc b">MIN</code>:返回最小值</li><li id="1279" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated"><code class="fe mz na nb nc b">AVG</code>:返回平均值</li></ul><p id="82da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们来看一些例子。</p><p id="3a63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想知道事务数据集中的行数。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="127e" class="nh md it nc b gy ni nj l nk nl">SELECT COUNT(*)<br/>FROM transaction;</span></pre><p id="bb8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">交易数据集中最高销售额是多少？</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="1f92" class="nh md it nc b gy ni nj l nk nl">SELECT MAX(sales) as max_sales<br/>FROM transaction;</span></pre><p id="8bdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，如果我们想知道每天的总销售额，四舍五入到最接近的美元，该怎么办？</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="879c" class="nh md it nc b gy ni nj l nk nl">SELECT purchase_date, ROUND(SUM(sales)) as total_sales <br/>FROM transaction <br/>GROUP BY purchase_date;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/e7249bd1312ec7b28db2afcbaf7d7e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rl1XPq2mHhpW6nFmwiOXVQ.png"/></div></div></figure><h1 id="e3ea" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">9.加入</h1><p id="89a1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们讨论连接的概念之前，我认为首先区分主键和外键是很重要的。</p><p id="747f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在关系数据库中，主键用于唯一标识表中的每一行。例如，事务表的主键是<em class="oa"> transaction_id </em>列，而客户概要表的主键是<em class="oa"> customer_id </em>列。</p><p id="7b54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，外键提供了两个表中数据之间的链接。具体来说，一个表中的外键将链接到另一个表中的主键。例如，<em class="oa"> customer_id </em>列是事务表中的外键，但它是客户概要表中的主键。</p><p id="8f3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给定主键和外键之间的关系，我们可以在这个特定场景中执行<code class="fe mz na nb nc b">LEFT JOIN</code>。</p><p id="7702" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SQL中还有其他类型的连接，比如<code class="fe mz na nb nc b">INNER JOIN</code>、<code class="fe mz na nb nc b">RIGHT JOIN</code>和<code class="fe mz na nb nc b">FULL JOIN</code>，这里就不赘述了。如果你有兴趣了解更多，查看这篇<a class="ae ky" href="https://www.w3schools.com/sql/sql_join.asp" rel="noopener ugc nofollow" target="_blank">博文</a>了解更多细节。</p><p id="3718" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，假设我们想要在基于<em class="oa"> customer_id </em>列的事务表上执行一个<code class="fe mz na nb nc b">LEFT JOIN</code>。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="317a" class="nh md it nc b gy ni nj l nk nl">SELECT a.*, b.customer_lifestage, b.customer_premium<br/>FROM transaction AS a<br/>LEFT JOIN customers AS b<br/>ON a.customer_id = b.customer_id;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/23300eac98e31b7a12e159df9378390f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNw9Vuy8W_QTZYdEapNqsw.png"/></div></div></figure><p id="153e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们执行了<code class="fe mz na nb nc b">LEFT JOIN</code>之后，总是检查行数也是一个很好的实践，以确保新表与连接之前的左表具有相同的行数，在本例中左表是事务表。</p><h1 id="5991" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">10.联盟</h1><p id="2dde" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后但同样重要的是，<code class="fe mz na nb nc b">UNION</code>用于组合来自多个<code class="fe mz na nb nc b">SELECT</code>语句的查询结果。请注意，您希望联合的表必须具有相同的列数，同样重要的是，这些列必须是相同的数据类型。</p><p id="b6ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不得不承认，我在这个练习中放在一起的两个表可能都不能最好地说明<code class="fe mz na nb nc b">UNION</code>的威力，但是，为了完整起见，我将在这里演示一下。</p><p id="7f0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想要将来自事务表的<em class="oa"> customer_id </em>列和<em class="oa"> quantity_purchased </em>列联合起来。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="1b95" class="nh md it nc b gy ni nj l nk nl">SELECT customer_id AS sample_union<br/>FROM transaction <br/>UNION<br/>SELECT quantity_purchased FROM transaction;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/2a57b7c26cb614b5bcc14dbe20a6f92f.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*FPcSO0i-seUNIaaNSXRXJQ.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b38a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至此，我们总结了开始使用SQL时需要的10个最重要的SQL命令。</p><p id="5a67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望，通过这篇博文，你已经更好地理解了什么是SQL，以及它在数据科学分析中的重要性，但更重要的是，认识到一旦你掌握了基础知识，学习起来实际上相对容易。</p><p id="7fe3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于任何有抱负的数据分析师或数据科学家来说，这绝对是您应该考虑添加到您的工具包中的技能之一，因为SQL已经存在。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="0586" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不知道接下来要读什么？这里有一些建议。</p><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/pandas-zero-to-hero-a-beginners-tutorial-to-using-pandas-f64e57386c7c"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">熊猫从零到英雄——使用熊猫的初学者教程</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">熊猫零到英雄是一个视频教程系列，旨在教初学者友好的方式使用熊猫</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk ks ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/five-basic-commands-to-getting-started-with-dplyr-in-r-c8b0451ad916"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">R中开始使用dplyr的五个基本命令</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">Dplyr相当于Python中的Pandas库，可以轻松地进行数据探索和操作</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pl l ph pi pj pf pk ks ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/a-beginners-introduction-to-nlp-building-a-spam-classifier-cf0973c7f42c"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">NLP入门——构建垃圾邮件分类器</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">如果您不熟悉自然语言处理这个激动人心的世界，请从这里开始</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pm l ph pi pj pf pk ks ow"/></div></div></a></div></div></div>    
</body>
</html>