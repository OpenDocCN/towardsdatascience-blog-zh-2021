<html>
<head>
<title>Top Five SQL Window Functions You Should Know For Data Science Interviews</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学面试中你应该知道的五大SQL窗口函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/top-five-sql-window-functions-you-should-know-for-data-science-interviews-b8b334af437?source=collection_archive---------6-----------------------#2021-07-07">https://towardsdatascience.com/top-five-sql-window-functions-you-should-know-for-data-science-interviews-b8b334af437?source=collection_archive---------6-----------------------#2021-07-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f855" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关注数据科学家的重要概念。</h2></div><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/4405c40fecb022673ea89da67f95404e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HsUYklBXZPviOQHxlj6fZw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">由<a class="ae ku" href="https://unsplash.com/s/photos/window?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ku" href="https://unsplash.com/@sashafreemind?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">萨莎·弗里明德</a>拍摄的照片</p></figure><p id="0e09" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">SQL是数据世界中的通用语言，也是数据专业人员需要掌握的最重要的技能。</p><p id="40c5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">SQL如此重要的原因是，它是数据争论阶段所需的主要技能。大量的数据探索、数据操作、管道开发和仪表板创建都是通过SQL完成的。</p><p id="e943" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">伟大的数据科学家与优秀的数据科学家的区别在于，伟大的数据科学家可以在SQL功能允许的情况下尽可能多地争论数据。能够充分利用SQL提供的所有功能，很大一部分是因为知道如何使用窗口函数。</p><p id="3451" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">说了这么多，让我们开始吧！</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="9801" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">1)具有超前()和滞后()的增量</h1><p id="4ca8" class="pw-post-body-paragraph kv kw it kx b ky mq ju la lb mr jx ld le ms lg lh li mt lk ll lm mu lo lp lq im bi translated">LEAD()和LAG()主要用于比较给定指标的一段时间和前一段时间。举几个例子…</p><ul class=""><li id="9552" class="mv mw it kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated">你可以得到每年销售额和前一年销售额之间的差值</li><li id="74cf" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">你可以得到每月注册/转换/网站访问量的增量</li><li id="0087" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">您可以按月比较用户流失情况</li></ul><p id="6321" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例:</strong> <br/>以下查询显示了如何查询每月的成本变化百分比</p><pre class="ki kj kk kl gt nj nk nl nm aw nn bi"><span id="8c80" class="no lz it nk b gy np nq l nr ns">with monthly_costs as (<br/>    SELECT<br/>        date<br/>      , monthlycosts<br/>      , LEAD(monthlycosts) OVER (ORDER BY date) as<br/>        previousCosts<br/>    FROM<br/>        costs<br/>)</span><span id="fe51" class="no lz it nk b gy nt nq l nr ns">SELECT<br/>    date<br/>  , (monthlycosts - previousCosts) / previousCosts * 100 AS<br/>    costPercentChange<br/>FROM monthly_costs</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="e180" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">SUM()或COUNT()的累积和</h1><p id="7da9" class="pw-post-body-paragraph kv kw it kx b ky mq ju la lb mr jx ld le ms lg lh li mt lk ll lm mu lo lp lq im bi translated">通过一个以SUM()或COUNT()开始的windows函数可以简单地计算运行总数。当您想要显示特定指标随时间的增长时，这是一个强大的工具。更具体地说，它在以下情况下很有用:</p><ul class=""><li id="9c0d" class="mv mw it kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated">获得一段时间内的总收入和总成本</li><li id="3bc9" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">获得每个用户在应用上花费的总时间</li><li id="6370" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">获得一段时间内的累计转化率</li></ul><p id="06e5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例:</strong> <br/>以下示例显示了如何包含每月成本的累计和列:</p><pre class="ki kj kk kl gt nj nk nl nm aw nn bi"><span id="a8fa" class="no lz it nk b gy np nq l nr ns">SELECT<br/>    date<br/>  , monthlycosts<br/>  , SUM(monthlycosts) OVER (ORDER BY date) as cumCosts<br/>FROM<br/>    cost_table</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="b225" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">3)AVG的移动平均线()</h1><p id="2a6d" class="pw-post-body-paragraph kv kw it kx b ky mq ju la lb mr jx ld le ms lg lh li mt lk ll lm mu lo lp lq im bi translated">AVG()在windows函数中非常强大，因为它允许你计算一段时间内的移动平均值。</p><p id="3102" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">移动平均线是一种简单而有效的短期预测方法。它们在平滑图形上不稳定的曲线时也非常有用。一般来说，移动平均线用于衡量事物运动的大致方向。</p><p id="e6bb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">更具体地说…</p><ul class=""><li id="4894" class="mv mw it kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated">它们可用于获得每周销售的总体趋势(平均值是否会随着时间的推移而上升？).这将表明公司的成长。</li><li id="acfd" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">他们同样可以用来获得每周转换或网站访问的一般趋势。</li></ul><p id="a64c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例:</strong> <br/>以下查询是获取10天移动平均值进行转换的示例。</p><pre class="ki kj kk kl gt nj nk nl nm aw nn bi"><span id="c12b" class="no lz it nk b gy np nq l nr ns">SELECT<br/>    Date<br/>  , dailyConversions<br/>  , AVG(dailyConversions) OVER (ORDER BY Date ROWS 10 PRECEDING) AS<br/>    10_dayMovingAverage<br/>FROM<br/>    conversions</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="268b" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">4)行号()</h1><p id="963f" class="pw-post-body-paragraph kv kw it kx b ky mq ju la lb mr jx ld le ms lg lh li mt lk ll lm mu lo lp lq im bi translated">当您想要获取第一条或最后一条记录时，ROW_NUMBER()特别有用。例如，如果您有一个健身房会员何时来到健身房的表，并且您想获得他们第一天来到健身房的日期，您可以按客户(姓名/id)进行分区，并按购买日期进行排序。然后，为了获得第一行，您可以简单地筛选rowNumber等于1的行。</p><p id="dcf8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例:</strong> <br/>这个示例展示了如何使用ROW_NUMBER()获取每个成员(用户)第一次访问的日期。</p><pre class="ki kj kk kl gt nj nk nl nm aw nn bi"><span id="ec17" class="no lz it nk b gy np nq l nr ns">with numbered_visits as (<br/>    SELECT<br/>        memberId<br/>      , visitDate<br/>      , ROW_NUMBER() OVER (PARTITION BY customerId ORDER BY<br/>        purchaseDate) as rowNumber<br/>    FROM<br/>        gym_visits<br/>)</span><span id="c170" class="no lz it nk b gy nt nq l nr ns">SELECT<br/>    *<br/>FROM<br/>    numbered_visits<br/>WHERE <br/>    rowNumber = 1</span></pre><p id="84f8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">总的来说，如果您需要获取第一条或最后一条记录，ROW_NUMBER()是实现这一点的好方法。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="4bb3" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">5)用DENSE_RANK()记录排名</h1><p id="80b4" class="pw-post-body-paragraph kv kw it kx b ky mq ju la lb mr jx ld le ms lg lh li mt lk ll lm mu lo lp lq im bi translated">DENSE_RANK()类似于ROW_NUMBER()，只是它对相等的值返回相同的等级。在检索顶级记录时，密集排名非常有用，例如:</p><ul class=""><li id="c629" class="mv mw it kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated">如果你想找出本周十大最受关注的网飞节目</li><li id="4a85" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">如果您想根据花费的金额获得前100名用户</li><li id="eafe" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">如果您想查看1000个最不活跃的用户的行为</li></ul><p id="40b7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例:</strong> <br/>如果您想按总销售额对顶级客户进行排名，DENSE_RANK()是一个合适的函数。</p><pre class="ki kj kk kl gt nj nk nl nm aw nn bi"><span id="617d" class="no lz it nk b gy np nq l nr ns">SELECT<br/>    customerId<br/>  , totalSales<br/>  , DENSE_RANK() OVER (ORDER BY totalSales DESC) as rank<br/>FROM<br/>    customers</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="e6ac" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">感谢阅读！</h1><p id="b4d2" class="pw-post-body-paragraph kv kw it kx b ky mq ju la lb mr jx ld le ms lg lh li mt lk ll lm mu lo lp lq im bi translated">仅此而已！我希望这能对你的面试准备有所帮助——我确信如果你对这5个概念了如指掌，你会在大多数SQL窗口函数问题上做得很好。</p><p id="8a62" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一如既往，我祝你学习一切顺利！</p><p id="c70f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">不确定接下来要读什么？我为你挑选了另一篇文章:</p><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/ten-advanced-sql-concepts-you-should-know-for-data-science-interviews-4d7015ec74b0"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">数据科学面试中你应该知道的十个高级SQL概念</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">让您的SQL技能更上一层楼</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ko nx"/></div></div></a></div><p id="a921" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">又一个！</strong></p><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/a-complete-52-week-curriculum-to-become-a-data-scientist-in-2021-2b5fc77bd160"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">2021年成为数据科学家的完整52周课程</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">连续52周，每周学点东西！</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="om l oi oj ok og ol ko nx"/></div></div></a></div><h1 id="a88a" class="ly lz it bd ma mb on md me mf oo mh mi jz op ka mk kc oq kd mm kf or kg mo mp bi translated">特伦斯·申</h1><ul class=""><li id="af9e" class="mv mw it kx b ky mq lb mr le os li ot lm ou lq na nb nc nd bi translated"><strong class="kx iu"> <em class="ov">如果你喜欢这个，</em> </strong> <a class="ae ku" href="https://medium.com/@terenceshin" rel="noopener"> <strong class="kx iu"> <em class="ov">跟我上媒</em> </strong> </a> <strong class="kx iu"> <em class="ov">了解更多</em> </strong></li><li id="6f3a" class="mv mw it kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated"><strong class="kx iu"> <em class="ov">有兴趣合作吗？让我们连线上</em></strong><a class="ae ku" href="https://www.linkedin.com/in/terenceshin/" rel="noopener ugc nofollow" target="_blank"><strong class="kx iu"><em class="ov">LinkedIn</em></strong></a></li></ul></div></div>    
</body>
</html>