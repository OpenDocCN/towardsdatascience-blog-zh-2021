<html>
<head>
<title>Deep Dive into Delta Lake via Apache Zeppelin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过阿帕奇齐柏林飞艇深入三角洲湖</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-dive-into-delta-lake-via-apache-zeppelin-d59db1673584?source=collection_archive---------11-----------------------#2021-11-28">https://towardsdatascience.com/deep-dive-into-delta-lake-via-apache-zeppelin-d59db1673584?source=collection_archive---------11-----------------------#2021-11-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fdfa" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以互动的方式了解三角洲湖泊的内部机制</h2></div><p id="c622" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Delta Lake 是一个开源项目，支持在数据湖的基础上构建一个 Lakehouse 架构。网上有很多关于如何使用三角洲湖的教程。这个帖子有点不同，是给那些好奇想了解 Delta Lake 内部机制，尤其是事务日志的人看的。</p><h1 id="7043" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated"><strong class="ak">启动齐柏林码头集装箱</strong></h1><p id="3cb0" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">为了更直观地演示内部机制，我使用 Apache Zeppelin 运行所有示例代码。你可以通过 Zeppelin docker 轻松复制我所做的。关于如何在 Zeppelin docker 中<a class="ae ly" href="https://zjffdu.medium.com/learn-spark-on-zeppelin-in-docker-container-9f3f7b2db230" rel="noopener">玩 Spark，可以查看这篇</a><a class="ae ly" href="https://zjffdu.medium.com/learn-spark-on-zeppelin-in-docker-container-9f3f7b2db230" rel="noopener">文章</a>。这里我只总结为以下几个步骤:</p><ul class=""><li id="a2b6" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">第一步。git 克隆<a class="ae ly" href="https://github.com/zjffdu/zeppelin-notebook.git" rel="noopener ugc nofollow" target="_blank">https://github.com/zjffdu/zeppelin-notebook.git</a></li><li id="3d6b" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">第二步。下载 Spark 3.1.2(这个是我在这个教程里用的，不要用 Spark 3.2.0，还不支持)</li><li id="0fb2" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">第三步。运行以下命令启动 Zeppelin docker 容器。<code class="fe mn mo mp mq b">${zeppelin_notebook}</code>是您在步骤 1 中克隆的笔记本文件夹，<code class="fe mn mo mp mq b">${spark_location}</code>是您在步骤 2 中下载的 Spark 文件夹。</li></ul><pre class="mr ms mt mu gt mv mq mw mx aw my bi"><span id="2c14" class="mz lc iq mq b gy na nb l nc nd">docker run -u <strong class="mq ir">$(</strong>id -u<strong class="mq ir">)</strong> -p 8080:8080 -p 4040:4040 --rm -v ${spark_location}:/opt/spark -v ${zeppelin_notebook}:/opt/notebook -e ZEPPELIN_NOTEBOOK_DIR=/opt/notebook -e SPARK_HOME<strong class="mq ir">=</strong>/opt/spark -e ZEPPELIN_LOCAL_IP=0.0.0.0 --name zeppelin apache/zeppelin:0.10.0</span></pre><p id="a20c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后打开<a class="ae ly" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>，打开笔记本<code class="fe mn mo mp mq b">Spark/Deep Dive into Delta Lake</code>，里面有这篇文章的全部代码。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ne"><img src="../Images/3c66ab6f855d030fc42ac001be81609b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6tLe7BmjvU2EOIWGs0Ww_g.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated"><em class="nq">齐柏林飞船主页(图片由作者提供)</em></p></figure><h1 id="7350" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">配置火花</h1><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nr"><img src="../Images/44eb7c703bddb06578e9a5bc775bdf7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_OAhT-TuPJezTpSpuihG1g.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated"><em class="nq">火花配置(图片由作者提供)</em></p></figure><p id="552b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是<code class="fe mn mo mp mq b">Deep Dive into Delta Lake,</code>第一段就是配置 Spark 解释器使用 Delta Lake。</p><p id="adde" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mn mo mp mq b">%spark.conf</code>是一个特殊的解释器，用来在 Zeppelin 中配置 Spark 解释器。在这里，我按照<a class="ae ly" href="https://docs.delta.io/latest/quick-start.html#" rel="noopener ugc nofollow" target="_blank">快速入门</a>中的描述配置 Spark 解释器。除此之外，我显式地指定了仓库文件夹，这样我就可以在本教程的后面轻松地检查表文件夹。现在让我们开始使用 Spark，在 Zeppelin 中播放 Delta Lake。</p><h1 id="745f" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">创建增量表</h1><p id="b1b4" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">首先让我们创建一个包含两个字段的增量表<code class="fe mn mo mp mq b">events</code>: id 和 data。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ns"><img src="../Images/b1f4c6f06f4a19f95013b2c75dc34cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IIsiNnBFl6GfAH-rrsUlKg.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated"><em class="nq">创建增量表(图片由作者提供)</em></p></figure><p id="4696" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么 Delta 在这个 create SQL 语句下面做什么呢？实际上，达美做了两件事:</p><ul class=""><li id="1435" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">在仓库文件夹<code class="fe mn mo mp mq b">/tmp/warehouse</code>下创建一个目录<code class="fe mn mo mp mq b">events</code></li><li id="d79b" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">添加包含该表模式的事务日志</li></ul><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nt"><img src="../Images/6fdcfd752549755f4d20a3f8f9f66d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2_AQ0gjMA2nyAC4geuAaw.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><h1 id="7ae2" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">插入数据</h1><p id="3faf" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">现在让我们将一些数据插入到这个增量表中。这里我只插入了 2 条记录:(1，data_1)，(2，data_2)</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nu"><img src="../Images/fe0d6cc23931b25048c23fdeb2511c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vCySdCvif_3rItgu3OqUqA.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">插入数据(图片由作者提供)</p></figure><p id="a726" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后让我们运行一个 select SQL 语句来验证这个 insert 语句的结果。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nv"><img src="../Images/9e3768afce7a76f4640961531fe2acd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDU_U0HM_my7wmslMLoH7Q.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">查询表(作者图片)</p></figure><p id="1b46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么 Delta 在这个 insert SQL 语句下面做了什么呢？让我们检查表格文件夹<code class="fe mn mo mp mq b">/tmp/warehouse/events</code>，有 2 个变化</p><ul class=""><li id="4fbf" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">生成另一个新的事务日志文件。</li><li id="6fd4" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">生成 2 个拼花文件</li></ul><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nw"><img src="../Images/7ab8fb546df9350319a8c402db13a57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqCc6HkZBJHQ1KH9_omRVg.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><p id="e672" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们来看一下新生成的事务文件(000000000000000001.json)。这个 JSON 文件可读性很强，它包含了这个 insert SQL 语句的操作:添加包含 2 条记录的 2 个 parquet 文件。需要注意的是，这个新的事务日志文件中没有表模式信息，因为它已经在第一个事务日志文件(00000000000000000.json)中。当 Delta 读取该表时，它将合并此后的所有历史事务文件，以获得该表的所有信息(包括该表的模式以及包含哪些数据文件)</p><p id="b878" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们只插入 2 条记录，所以很自然地猜测每个拼花包含一条记录。我们可以直接读取这两个拼花文件来验证这一点。如下面的代码所示，我们的猜测是正确的。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nx"><img src="../Images/c6558cde232c70a3e7d49ad48a3ebf08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*po2Suu9pcYiMrPNKIYmNzg.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><h1 id="3e14" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">更新数据</h1><p id="70a5" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">Delta 最重要的特性是 ACID 支持，你可以在任何时候更新表而不影响同时读/写同一个表的其他人。现在让我们更新这个<code class="fe mn mo mp mq b">events</code>表。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ny"><img src="../Images/e17d3e0f04c6bf9c312b3128e01f3705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gm96vECS5ry4_RttUjrbwA.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">更新数据(图片由作者提供)</p></figure><p id="a4d6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后运行 select 语句来验证这个 update 语句的结果。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nz"><img src="../Images/db046a2372b1a22e859b8951210504bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ejzqWlVh6ZPEkLEPuBgkA.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><p id="9b04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么这个 update 语句在底层做什么呢？我们可以检查<code class="fe mn mo mp mq b">events </code>表文件夹，会发现 2 处变化:</p><ul class=""><li id="5c9e" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">生成另一个新的事务日志文件</li><li id="acf6" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">添加了另一个拼花文件(之前的两个拼花文件仍然存在)</li></ul><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oa"><img src="../Images/07e4d24c1464961780813b64c776c6b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yS9R1xKUiWKJavWnQapMfw.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><p id="70ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，让我们看看新事务日志文件的内容，这里有 2 个操作:</p><ul class=""><li id="3657" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">移除一个拼花文件</li><li id="f53e" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">添加新的拼花文件</li></ul><p id="6d63" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们很自然地猜测，被移除的文件包含记录(2，data_2)，而新添加的文件包含记录(2，data_2_updated)。让我们直接读取这两个 parquet 文件来验证我们的猜测。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ob"><img src="../Images/341eddc301269d1bd360c89667fd5439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gDyr21GUqFw6c67cElaUqg.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><p id="04d6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们使用德尔塔的时间旅行功能。我们希望在此更新操作之前使用此表的最新版本。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oc"><img src="../Images/ad0b0ad69ba28ef1ebd0f8cc96311256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kdL9ZKGsKNwSqkpG2ue0ZA.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><p id="0797" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">时间旅行功能之所以有效，是因为 Delta 不删除数据文件，它只在事务日志中记录所有操作。当您阅读该表的版本 1 时，Delta Lake 将只阅读前两个事务日志:00000000000000000 . JSON &amp; 000000000000001 . JSON。</p><h1 id="ab4c" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">删除数据</h1><p id="565c" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">现在让我们对这个<code class="fe mn mo mp mq b">events</code>表进行删除操作。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi od"><img src="../Images/aad727fd002d6c4922f2e47aa0a5813a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OPSlTIi4IEBJra6kooPu6g.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">删除数据(图片由作者提供)</p></figure><p id="8ad6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后运行 select 语句来验证 delete 语句的结果。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oe"><img src="../Images/357ed233bfc6d18a74e59d1612b169b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yWJTwc9h234_Rkvn8jMHKQ.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><p id="d5bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么 Delta 在底层对这个删除操作做了什么呢？我们仍然可以检查<code class="fe mn mo mp mq b">events</code>表文件夹，并会发现 2 处更改:</p><ul class=""><li id="f020" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">生成新的元数据事务日志文件</li><li id="297c" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">添加了一个新的拼花文件</li></ul><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi of"><img src="../Images/ded04ca1da80160eab0086d93e545311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPgZ5LVQNRZM5UEbFk1h0g.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><p id="5b11" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在新的事务日志文件中，我们仍然可以看到两个操作:<code class="fe mn mo mp mq b">remove</code>和<code class="fe mn mo mp mq b">add</code></p><p id="f50f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">人们很自然地会猜测删除操作只是删除了包含 record (1，data_1)的文件，那么这个新的<code class="fe mn mo mp mq b">add</code>操作是做什么的呢？实际上，新添加的 parquet 文件是空的，其中不包含任何内容，我们可以直接读取这两个 parquet 文件来验证这一点。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi og"><img src="../Images/f06b3d33d1b5c79583af85bec6a717b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*In3zdot_0vVepQ972HXhgw.png"/></div></div><p class="nm nn gj gh gi no np bd b be z dk translated">作者图片</p></figure><h1 id="596c" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">摘要</h1><p id="5b74" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">在这篇文章中，我做了 4 个主要步骤来玩三角洲湖:</p><ul class=""><li id="6f23" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">创建表格</li><li id="1578" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">插入数据</li><li id="01bb" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">更新数据</li><li id="2cdb" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">删除数据</li></ul><p id="121f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在每一步，我都检查事务日志和数据文件中发生了什么变化。所有步骤都是在 Apache Zeppelin docker 容器中完成的，您可以轻松地再现它们，希望本文对您了解 Delta Lake 的内部机制有用。</p><h1 id="c697" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">参考</h1><div class="oh oi gp gr oj ok"><a href="http://zeppelin.apache.org/" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ir gy z fp op fr fs oq fu fw ip bi translated">齐柏林</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">Apache Zeppelin 解释器概念允许任何语言/数据处理后端插入 Zeppelin。目前…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">zeppelin.apache.org</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy nk ok"/></div></div></a></div><div class="oh oi gp gr oj ok"><a href="https://databricks.com/blog/2019/08/21/diving-into-delta-lake-unpacking-the-transaction-log.html" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ir gy z fp op fr fs oq fu fw ip bi translated">了解 Delta Lake 事务日志- Databricks 博客</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">事务日志是理解 Delta Lake 的关键，因为它是贯穿其许多…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">databricks.com</p></div></div><div class="ot l"><div class="oz l ov ow ox ot oy nk ok"/></div></div></a></div><div class="oh oi gp gr oj ok"><a href="https://databricks.com/blog/2020/09/29/diving-into-delta-lake-dml-internals-update-delete-merge.html" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ir gy z fp op fr fs oq fu fw ip bi translated">Delta Lake 教程:如何使用 DML 轻松删除、更新和合并</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">在以前的博客《深入三角洲湖:解包事务日志和深入三角洲湖:模式实施》中…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">databricks.com</p></div></div><div class="ot l"><div class="pa l ov ow ox ot oy nk ok"/></div></div></a></div></div></div>    
</body>
</html>