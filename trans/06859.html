<html>
<head>
<title>3 Ways to Store and Read Credentials Locally in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中本地存储和读取凭证的3种方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-ways-to-store-and-read-credentials-locally-in-python-5195fc1881b6?source=collection_archive---------24-----------------------#2021-06-21">https://towardsdatascience.com/3-ways-to-store-and-read-credentials-locally-in-python-5195fc1881b6?source=collection_archive---------24-----------------------#2021-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8d9c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">秘密被称为秘密是有原因的。我们不希望其他人知道它们，无论是在现实生活中还是在Python中</h2></div><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/576e0697c1637d26faec93c49ac7ef0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-IW46gPsll9xby_g.png"/></div></div><p class="lc ld gj gh gi le lf bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><blockquote class="ln"><p id="8d68" class="lo lp it bd lq lr ls lt lu lv lw lx dk translated"><em class="ly">原帖</em><a class="ae lz" href="https://www.realpythonproject.com/3-ways-to-store-and-read-credentials-locally-in-python/" rel="noopener ugc nofollow" target="_blank"><em class="ly">【realpythonproject.com】</em></a></p><p id="fbe8" class="lo lp it bd lq lr ls lt lu lv lw lx dk translated"><em class="ly">在</em><a class="ae lz" href="https://www.linkedin.com/in/rahulbanerjee2699/" rel="noopener ugc nofollow" target="_blank"><em class="ly">LinkedIn</em></a><em class="ly">，</em> <a class="ae lz" href="https://twitter.com/rahulbanerjee99" rel="noopener ugc nofollow" target="_blank"> <em class="ly"> Twitter </em> </a>上与我联系</p></blockquote></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="f824" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">我们将讨论使用Python存储和读取凭证的3种不同方式。</p><ul class=""><li id="f914" class="mv mw it mc b md me mg mh mj mx mn my mr mz lx na nb nc nd bi translated">将它们存储为系统变量</li><li id="e5d7" class="mv mw it mc b md ne mg nf mj ng mn nh mr ni lx na nb nc nd bi translated">将它们作为变量存储在虚拟环境中</li><li id="2563" class="mv mw it mc b md ne mg nf mj ng mn nh mr ni lx na nb nc nd bi translated">将它们存储在. env文件中</li><li id="9eb1" class="mv mw it mc b md ne mg nf mj ng mn nh mr ni lx na nb nc nd bi translated">最便捷的方式</li></ul><p id="0164" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">吉姆·梅德洛克的这篇文章对环境变量、它们的用例以及如何使用它们进行了深入的解释。</p><div class="nl nm gp gr nn no"><a href="https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa" rel="noopener follow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">环境变量及其使用方法介绍</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">从应用程序中分离配置</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">medium.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc la no"/></div></div></a></div><h1 id="d545" class="od oe it bd of og oh oi oj ok ol om on jz oo ka op kc oq kd or kf os kg ot ou bi translated">将它们存储为全局环境变量</h1><p id="570d" class="pw-post-body-paragraph ma mb it mc b md ov ju mf mg ow jx mi mj ox ml mm mn oy mp mq mr oz mt mu lx im bi translated">如果凭据存储为全局环境变量，则在您PC上的任何环境中运行的任何脚本都可以访问它们。</p><p id="0c56" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">要创建一个全局环境变量，请在您的终端中运行</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="f726" class="pf oe it pb b gy pg ph l pi pj">export varName=varValue</span></pre><p id="f270" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">确保“=”之间没有空格。如果您得到一个错误“zsh: Bad Assignment”，这可能是由于“=”之间的空格引起的。</p><p id="8649" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">让我们创建几个全局环境变量</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="83bb" class="pf oe it pb b gy pg ph l pi pj">export globalSecretUser=global_rahul1999<br/>export globalSecretKey = global_xy76hUihk</span></pre><p id="a4f6" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">在Windows中，您可能必须使用“设置”而不是“导出”</p><p id="2297" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">上面的脚本需要在终端中运行。现在，让我们尝试访问我们之前创建的变量。</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="6df8" class="pf oe it pb b gy pg ph l pi pj">import os<br/>print(os.environ) <br/># This will print a dictionary with <br/># all the global environment variables</span></pre><p id="6dd2" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">我们可以使用字典访问方法来读取环境变量，即使用。get()或[ ]</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="3092" class="pf oe it pb b gy pg ph l pi pj">print(os.environ.get('globalSecretUser'))<br/>print(os.environ.get('globalSecretKey'))</span><span id="1ded" class="pf oe it pb b gy pk ph l pi pj">'''<br/>global_rahul1999<br/>global_xy76hUihk<br/>'''</span></pre><p id="e45c" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">要更新环境变量，只需再次运行export语句</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="e150" class="pf oe it pb b gy pg ph l pi pj">export globalSecretUser=Updated_rahul1999</span></pre><p id="003f" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">让我们再次尝试访问Python中的变量</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="aad7" class="pf oe it pb b gy pg ph l pi pj">import os </span><span id="bdf3" class="pf oe it pb b gy pk ph l pi pj">print(os.environ.get('globalSecretUser'))</span><span id="665e" class="pf oe it pb b gy pk ph l pi pj">'''<br/>Updated_rahul1999<br/>'''</span></pre><p id="ba45" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">要删除环境变量，我们使用unset关键字</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="7349" class="pf oe it pb b gy pg ph l pi pj">unset globalSecretUser</span></pre><p id="e57c" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">如果您尝试在Python中访问该变量，根据您用来访问字典中的值的方法，您将要么得到一个KeyError，要么没有。</p><h1 id="b63b" class="od oe it bd of og oh oi oj ok ol om on jz oo ka op kc oq kd or kf os kg ot ou bi translated">将它们作为变量存储在虚拟环境中</h1><p id="ea3a" class="pw-post-body-paragraph ma mb it mc b md ov ju mf mg ow jx mi mj ox ml mm mn oy mp mq mr oz mt mu lx im bi translated">这些环境变量只能由在创建变量的虚拟环境中运行的脚本访问。我们可以将它们视为“局部”环境变量。</p><p id="c69f" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">首先，我们必须创建一个虚拟环境</p><p id="5b44" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">在Mac上</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="4740" class="pf oe it pb b gy pg ph l pi pj">python3 -m venv venv</span></pre><p id="d212" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">在Windows上</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="ddc6" class="pf oe it pb b gy pg ph l pi pj">python -m venv venv</span></pre><p id="8633" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">这将在您的当前目录中创建一个虚拟环境。bin文件夹中应该有一个名为“activate”的文件。如果您使用的是Windows，它应该在Scripts文件夹中。每当我们激活虚拟环境时，这个脚本就会运行。</p><p id="cd6f" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">我们将在这个脚本中添加变量。因此，每次我们激活虚拟环境时，都会创建环境变量。打开文件。</p><p id="db71" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">在创建变量之前，我们需要添加一些代码，以确保一旦虚拟环境被停用，这些变量就不存在了。</p><p id="b7a4" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">我们将使用unset关键字，转到activate脚本中的函数deactivate()并在函数的开头取消设置变量</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="0e92" class="pf oe it pb b gy pg ph l pi pj">deactivate () {<br/>    unset localSecretUser<br/>    unset localSecretKey<br/>    # Some Code<br/>}</span></pre><p id="8faf" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">现在，我们将使用export关键字来定义变量。这段代码应该位于激活脚本末尾的停用函数之外</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="0648" class="pf oe it pb b gy pg ph l pi pj">deactivate(){<br/>     # Some Code<br/>}<br/># Some More Code<br/>export localSecretUser=local_secret_rahul199<br/>export localSecretKey=local_secret_xyudJIk12AA</span></pre><p id="f24e" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">在Windows中，您可能必须使用“设置”而不是“导出”</p><p id="0ac1" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">现在我们需要激活我们的虚拟环境。如果您已经激活了您的虚拟环境，您可以使用deactivate关键字来停用您的虚拟环境</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="7665" class="pf oe it pb b gy pg ph l pi pj">deactivate</span></pre><p id="f120" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">在终端中键入以上内容。</p><p id="654f" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">现在让我们激活我们的虚拟环境。<br/>在苹果电脑上</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="1a22" class="pf oe it pb b gy pg ph l pi pj">source venv/bin/activate</span></pre><p id="2204" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">在Windows上</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="f95c" class="pf oe it pb b gy pg ph l pi pj">venv/Scripts/activate</span></pre><p id="d5c6" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">您可以在终端中使用以下命令列出当前环境的变量</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="c317" class="pf oe it pb b gy pg ph l pi pj">printenv</span></pre><p id="5b93" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">现在让我们尝试访问我们刚刚创建的变量。这类似于我们访问全局环境变量的方式</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="c7aa" class="pf oe it pb b gy pg ph l pi pj">import os </span><span id="57aa" class="pf oe it pb b gy pk ph l pi pj">print(os.environ.get('localSecretUser'))<br/>print(os.environ.get('localSecretKey'))</span><span id="3a21" class="pf oe it pb b gy pk ph l pi pj">'''<br/>local_secret_rahul199<br/>local_secret_xyudJIk12AA<br/>'''</span></pre><p id="d746" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">现在，让我们停用虚拟环境，并尝试再次运行python脚本</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="d66d" class="pf oe it pb b gy pg ph l pi pj">deactivate<br/>python3 main.py</span></pre><p id="d11a" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">它应该不返回任何值。</p><p id="eb59" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">要了解更多关于Python中虚拟环境的知识，请查看达科塔·莉莉艾的这篇文章</p><div class="nl nm gp gr nn no"><a href="https://medium.com/@dakota.lillie/an-introduction-to-virtual-environments-in-python-ce16cda92853" rel="noopener follow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">Python中虚拟环境的介绍</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">最近我从项目中抽出了一些时间，主要是为了自学数学，但也是为了学习数学。</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">medium.com</p></div></div><div class="nx l"><div class="pl l nz oa ob nx oc la no"/></div></div></a></div><h1 id="3fb9" class="od oe it bd of og oh oi oj ok ol om on jz oo ka op kc oq kd or kf os kg ot ou bi translated">将它们存储在. env文件中</h1><p id="34f0" class="pw-post-body-paragraph ma mb it mc b md ov ju mf mg ow jx mi mj ox ml mm mn oy mp mq mr oz mt mu lx im bi translated">在您的根文件夹(包含您的虚拟环境的文件夹)中，创建一个名为“. env”的文件。在该文件中添加变量</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="deb2" class="pf oe it pb b gy pg ph l pi pj">#inside file named .env<br/>secretUser = "secret_user_rahul1999"<br/>secretKey = "secret_key_adfdsaUj12"</span></pre><p id="28a7" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">我们需要安装一个python库来读取变量</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="ea28" class="pf oe it pb b gy pg ph l pi pj">pip3 install python-dotenv</span></pre><p id="07e3" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">让我们来阅读Python中的变量</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="b8fb" class="pf oe it pb b gy pg ph l pi pj">from dotenv import load_dotenv<br/>import os </span><span id="b5b0" class="pf oe it pb b gy pk ph l pi pj">load_dotenv()<br/>print(os.environ.get('secretUser'))<br/>print(os.environ.get('secretKey'))</span><span id="6f8f" class="pf oe it pb b gy pk ph l pi pj">'''<br/>secret_user_rahul1999<br/>secret_key_adfdsaUj12<br/>'''</span></pre><p id="46bd" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">不要忘记添加。的. env文件。gitignore文件。这将确保您的凭证不会被推送到您的git存储库。</p><pre class="kr ks kt ku gt pa pb pc pd aw pe bi"><span id="8923" class="pf oe it pb b gy pg ph l pi pj"># Inside .gitignore</span><span id="1e26" class="pf oe it pb b gy pk ph l pi pj">.env</span></pre><h1 id="251e" class="od oe it bd of og oh oi oj ok ol om on jz oo ka op kc oq kd or kf os kg ot ou bi translated">最方便的方法</h1><p id="ca03" class="pw-post-body-paragraph ma mb it mc b md ov ju mf mg ow jx mi mj ox ml mm mn oy mp mq mr oz mt mu lx im bi translated">在我看来，最方便的方法是将它们存储在. env文件中。</p><ul class=""><li id="372a" class="mv mw it mc b md me mg mh mj mx mn my mr mz lx na nb nc nd bi translated">它们位于您项目的本地</li><li id="5912" class="mv mw it mc b md ne mg nf mj ng mn nh mr ni lx na nb nc nd bi translated">您不需要担心“取消设置”它们</li><li id="9a95" class="mv mw it mc b md ne mg nf mj ng mn nh mr ni lx na nb nc nd bi translated">如果您将它们添加到您的。gitignore文件，它对外界是安全的</li><li id="097d" class="mv mw it mc b md ne mg nf mj ng mn nh mr ni lx na nb nc nd bi translated">如果您将脚本部署为无服务器函数，您将需要使用“load_dotenve()”来读取Azure/AWS环境的配置文件中存储的环境变量。</li></ul><p id="3193" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">虽然它有很多优点，但是一个缺点是当我们在。与全局环境变量同名的env文件。在Python中访问变量将返回全局值，因为我们没有使用“unset”来取消变量值的设置，也没有使用“export”来为变量赋值。</p><p id="e2f6" class="pw-post-body-paragraph ma mb it mc b md me ju mf mg mh jx mi mj mk ml mm mn mo mp mq mr ms mt mu lx im bi translated">让我知道你是否喜欢任何其他方法，或者是否认为其中一个比另一个更安全。</p></div></div>    
</body>
</html>