<html>
<head>
<title>Medical Cost Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">医疗成本预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/medical-cost-prediction-4876e3449adf?source=collection_archive---------8-----------------------#2021-03-23">https://towardsdatascience.com/medical-cost-prediction-4876e3449adf?source=collection_archive---------8-----------------------#2021-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1eef" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">R中的数据科学</h2><div class=""/><div class=""><h2 id="f887" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">能否根据人们的数据准确预测医疗成本？</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/f29e0a7d7dd4121abc1a3bf2a6582119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*10B3radiyQGAp-QA"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@bermixstudio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Bermix工作室</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="b3c8" class="ln lo it lj b gy lp lq l lr ls"><strong class="lj jd">Table of Contents</strong></span><span id="026c" class="ln lo it lj b gy lt lq l lr ls">· <a class="ae lh" href="#374c" rel="noopener ugc nofollow">Library</a><br/>· <a class="ae lh" href="#572d" rel="noopener ugc nofollow">Dataset</a><br/>· <a class="ae lh" href="#f78b" rel="noopener ugc nofollow">Data Cleaning</a><br/>· <a class="ae lh" href="#7ae7" rel="noopener ugc nofollow">Exploratory Data Analysis</a><br/>· <a class="ae lh" href="#38e4" rel="noopener ugc nofollow">Metrics and Validation Strategy</a><br/>· <a class="ae lh" href="#49dd" rel="noopener ugc nofollow">Modeling</a><br/>  ∘ <a class="ae lh" href="#7a27" rel="noopener ugc nofollow">Linear Regression</a><br/>  ∘ <a class="ae lh" href="#47bb" rel="noopener ugc nofollow">Polynomial Regression</a><br/>  ∘ <a class="ae lh" href="#9184" rel="noopener ugc nofollow">Model Evaluation</a><br/>· <a class="ae lh" href="#7a50" rel="noopener ugc nofollow">Conclusion</a></span></pre><p id="4f5a" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi mq translated">健康保险公司只有在收取的费用超过其受益人的医疗费用时才能盈利。另一方面，即使某些疾病在某些人群中更为普遍，医疗成本也很难预测，因为大部分资金来自于患者的罕见疾病。本文的目的是根据人们的数据，包括年龄、体重指数、吸烟与否等，准确预测保险费用。此外，我们还将确定影响保险成本的最重要的变量是什么。这些估计可用于创建精算表，根据预期的治疗费用来设定更高或更低的年度保费价格。这是一个回归问题。</p><h1 id="374c" class="mz lo it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">图书馆</h1><p id="c0fe" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">我们将完全使用r。首先，导入所有需要的库。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="deef" class="ln lo it lj b gy lp lq l lr ls">library(dplyr)          # data wrangling<br/>library(ggplot2)        # graphing<br/>library(caret)          # machine learning functions<br/>library(MLmetrics)      # machine learning metrics<br/>library(car)            # VIF calculation<br/>library(lmtest)         # linear regression model testing<br/>library(GGally)         # correlation plot</span></pre><h1 id="572d" class="mz lo it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">资料组</h1><p id="1140" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">原始数据集可在<a class="ae lh" href="https://www.kaggle.com/mirichoi0218/insurance" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上获得。在本文中，它已经被随机分为训练和测试数据集。让我们读一读。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="a8d6" class="ln lo it lj b gy lp lq l lr ls">train &lt;- read.csv("train.csv", stringsAsFactors=TRUE)<br/>test &lt;- read.csv("test.csv", stringsAsFactors=TRUE)<br/>glimpse(train)</span><span id="a30c" class="ln lo it lj b gy lt lq l lr ls">#&gt; Rows: 1,070<br/>#&gt; Columns: 7<br/>#&gt; $ age      &lt;int&gt; 37, 18, 23, 32, 58, 25, 36, 34, 53, 45, 20, 60, 58, 34, 60, 18, 38, 23, 39, 43, 26, 18, 19, 61, 49, 31, 55, 55, 23, ...<br/>#&gt; $ sex      &lt;fct&gt; male, male, female, male, female, female, male, female, male, male, male, female, female, male, male, female, male, ...<br/>#&gt; $ bmi      &lt;dbl&gt; 34.100, 34.430, 36.670, 35.200, 32.395, 26.790, 35.200, 33.250, 31.350, 24.310, 32.395, 28.700, 27.170, 35.815, 29.6...<br/>#&gt; $ children &lt;int&gt; 4, 0, 2, 2, 1, 2, 1, 1, 0, 5, 1, 1, 0, 0, 0, 0, 1, 3, 5, 1, 1, 0, 2, 1, 1, 1, 2, 1, 0, 1, 1, 0, 0, 2, 2, 0, 0, 0, 1,...<br/>#&gt; $ smoker   &lt;fct&gt; yes, no, yes, no, no, no, yes, no, no, no, no, no, no, no, no, no, no, no, no, yes, no, no, no, yes, no, no, no, no,...<br/>#&gt; $ region   &lt;fct&gt; southwest, southeast, northeast, southwest, northeast, northwest, southeast, northeast, southeast, southeast, northw...<br/>#&gt; $ charges  &lt;dbl&gt; 40182.246, 1137.470, 38511.628, 4670.640, 13019.161, 4189.113, 38709.176, 5594.846, 27346.042, 9788.866, 2362.229, 1...</span></pre><p id="91c3" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">如我们所见，我们得到了这些特征:</p><ol class=""><li id="909b" class="nv nw it lw b lx ly ma mb md nx mh ny ml nz mp oa ob oc od bi translated"><code class="fe oe of og lj b">age</code>:第一受益人的年龄</li><li id="37f4" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">sex</code>:保险签约人性别，女，男</li><li id="a9bb" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">bmi</code>:体重指数，提供相对于身高体重相对较高或较低的理解，使用身高体重比的体重客观指数(<em class="om"> kg </em> / <em class="om"> m </em>)，理想值为18.5至24.9</li><li id="3c83" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">children</code>:健康保险覆盖的儿童人数，受抚养人人数</li><li id="0c86" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">smoker</code>:吸烟还是不吸烟</li><li id="e8f6" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">region</code>:受益人在美国的居住区域，东北、东南、西南、西北。</li><li id="7dbd" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">charges</code>:由健康保险支付的个人医疗费用</li></ol><p id="5988" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">由于我们预测保险成本，<code class="fe oe of og lj b">charges</code>将是我们的目标特性。</p><h1 id="f78b" class="mz lo it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">数据清理</h1><p id="88b0" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">首先，我们可以从上面看到，每个特性都已经有了正确的类型。让我们检查在训练数据集上是否有任何重复的观察。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="5600" class="ln lo it lj b gy lp lq l lr ls">train[duplicated(train), ]</span><span id="e4a8" class="ln lo it lj b gy lt lq l lr ls">#&gt;     age  sex   bmi children smoker    region  charges<br/>#&gt; 268  19 male 30.59        0     no northwest 1639.563</span></pre><p id="0468" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">有一个。两个人不太可能有相同的年龄、性别、身体质量指数和来自同一地区的孩子，都不吸烟，并且有完全相同的医疗费用。我们可以删除这个重复的行。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="3427" class="ln lo it lj b gy lp lq l lr ls">train &lt;- train %&gt;% distinct()</span></pre><p id="070f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">太好了！现在，我们检查缺失值。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="3a8f" class="ln lo it lj b gy lp lq l lr ls">colSums(is.na(train))</span><span id="9039" class="ln lo it lj b gy lt lq l lr ls">#&gt;      age      sex      bmi children   smoker   region  charges <br/>#&gt;        0        0        0        0        0        0        0</span><span id="bf93" class="ln lo it lj b gy lt lq l lr ls">colSums(is.na(test))</span><span id="3244" class="ln lo it lj b gy lt lq l lr ls">#&gt;      age      sex      bmi children   smoker   region  charges <br/>#&gt;        0        0        0        0        0        0        0</span></pre><p id="e02f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">厉害！没有缺失值。</p><h1 id="7ae7" class="mz lo it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">探索性数据分析</h1><p id="e273" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">这里有一些描述性统计数据。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="2802" class="ln lo it lj b gy lp lq l lr ls">summary(train)</span><span id="1bb7" class="ln lo it lj b gy lt lq l lr ls">#&gt;       age            sex           bmi           children    smoker          region       charges     <br/>#&gt;  Min.   :18.00   female:543   Min.   :15.96   Min.   :0.00   no :850   northeast:249   Min.   : 1122  <br/>#&gt;  1st Qu.:26.00   male  :526   1st Qu.:26.32   1st Qu.:0.00   yes:219   northwest:253   1st Qu.: 4747  <br/>#&gt;  Median :39.00                Median :30.40   Median :1.00             southeast:294   Median : 9447  <br/>#&gt;  Mean   :39.11                Mean   :30.73   Mean   :1.08             southwest:273   Mean   :13212  <br/>#&gt;  3rd Qu.:51.00                3rd Qu.:34.80   3rd Qu.:2.00                             3rd Qu.:16587  <br/>#&gt;  Max.   :64.00                Max.   :53.13   Max.   :5.00                             Max.   :63770</span></pre><p id="5f92" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">就分类特征而言，除了<code class="fe oe of og lj b">smoker</code>之外，数据集的每个类别都有相似的人数。我们不吸烟的人比吸烟的人多，这是有道理的。<code class="fe oe of og lj b">charges</code>本身价格相差很大，从1000美元左右到64000美元。</p><p id="5809" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">让我们看看<code class="fe oe of og lj b">charges</code>的分布。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="2fd4" class="ln lo it lj b gy lp lq l lr ls">ggplot(data = train, aes(x = charges)) + <br/>  geom_density(alpha = 0.5) + <br/>  ggtitle("Distribution of Charges")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/020551d688d853472a51144d472ad057.png" data-original-src="https://miro.medium.com/v2/format:webp/1*tBKTbYTeBEilVE4mCzT0rA.png"/></div></figure><p id="3b0e" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">这种分布是右偏的，右边有一条长尾巴。在40，000美元左右有一个凸起，也许是另一个隐藏的分布。要挖掘这一点，我们需要分类特征。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="95e8" class="ln lo it lj b gy lp lq l lr ls">for (col in c('sex', 'region', 'children', 'smoker')) {<br/>  plot &lt;- ggplot(data = train,<br/>                 aes_string(x = col, y = 'charges', group = col, fill = col)) + <br/>            geom_boxplot(show.legend = FALSE) + <br/>            ggtitle(glue::glue("Boxplot of Medical Charges per {col}"))<br/>  print(plot)<br/>}</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/e6045afaabee24990ab2d76165f4dcb4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*DcqHkKbGb8CioJ_C3dbpKA.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/55c356e86438f66ba38ef9db7e576645.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ydG9lvv-uYzIoxFQCERj0w.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/fa6bf5b01ffa3e6498bc6d0257ca8fcb.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Rk1JXI3KaNYHqyJdCCS6Ow.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/46176ac94309f84f9518f44edfb68ed7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*h_iwbmMno6vAQDvYqNksgg.png"/></div></figure><p id="603f" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">就给出的<code class="fe oe of og lj b">charges</code>而言，<code class="fe oe of og lj b">sex</code>和<code class="fe oe of og lj b">region</code>在每个类别中没有显著差异。我们可以看到随着<code class="fe oe of og lj b">children</code>的增加<code class="fe oe of og lj b">charges</code>有增加的趋势。最后，<code class="fe oe of og lj b">smoker</code>似乎与健康保险给予的<code class="fe oe of og lj b">charges</code>有显著差异。</p><p id="bc16" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">让我们再次画出<code class="fe oe of og lj b">charges</code>的分布，现在将它们归类到<code class="fe oe of og lj b">smoker</code>中。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="f0c2" class="ln lo it lj b gy lp lq l lr ls">ggplot(data = train, aes(x = charges, fill = smoker)) + <br/>  geom_density(alpha = 0.5) + <br/>  ggtitle("Distribution of Charges per Smoking Category")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/779cff8d3f6832b167efbd76e32bc050.png" data-original-src="https://miro.medium.com/v2/format:webp/1*_lZU5K0qrs7htU2_4Lsblg.png"/></div></figure><p id="892c" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">看看我们找到了什么！吸烟者肯定比不吸烟者有更多的<code class="fe oe of og lj b">charges</code>。</p><p id="309c" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">下面我们根据<code class="fe oe of og lj b">smoker</code>因子，通过<code class="fe oe of og lj b">age</code>、<code class="fe oe of og lj b">bmi</code>、<code class="fe oe of og lj b">children</code>来分析一下医疗<code class="fe oe of og lj b">charges</code>。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="b68c" class="ln lo it lj b gy lp lq l lr ls">for (feat in c('age', 'bmi', 'children')) {<br/>  plot &lt;- ggplot(data = train, aes_string(x = feat, y = 'charges', group = 'smoker', fill = 'smoker', col = 'smoker')) + <br/>    geom_jitter() + <br/>    geom_smooth(method = 'lm') +<br/>    ggtitle(glue::glue("Charges vs {feat}"))  <br/>  print(plot)<br/>}</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/95b7fee7be00487a257dd11fee2b6be2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*6-DnbUvc4_DK8eOdbePCZA.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/57528ba874a8901b2beb2b88ea6a5510.png" data-original-src="https://miro.medium.com/v2/format:webp/1*i92I1qWznp1FhyzOjr0xsA.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/4c800c5e7a4f939f75506eeb8bfa910b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*uReHkGn90BbnTPH6nePpbQ.png"/></div></figure><p id="5d9d" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated"><code class="fe oe of og lj b">smoker</code>似乎对医疗的影响最大<code class="fe oe of og lj b">charges</code>，尽管<code class="fe oe of og lj b">charges</code>与<code class="fe oe of og lj b">age</code>、<code class="fe oe of og lj b">bmi</code>和<code class="fe oe of og lj b">children</code>一起成长。此外，孩子越多的人吸烟越少。</p><p id="6309" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">最后，我们有如下特征之间的相关性。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="2d1c" class="ln lo it lj b gy lp lq l lr ls">ggcorr(train %&gt;% mutate_if(is.factor, as.numeric), label = TRUE)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/951524d74056224a024cd586e32064e2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*L5sHWD8c4apL-lyYxvjnLg.png"/></div></figure><p id="2bbe" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">正如我们所看到的，除了<code class="fe oe of og lj b">smoker</code>和<code class="fe oe of og lj b">charges</code>之外，特征之间几乎没有相关性。</p><h1 id="38e4" class="mz lo it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">度量和验证策略</h1><p id="3d51" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">我们将使用平均绝对误差(MAE)、均方根误差(RMSE)和均方根对数误差(RMSLE)作为衡量标准。这三个指标的使用取决于业务角度。为了理解我们的意思，考虑一下<code class="fe oe of og lj b">charges</code>的一次观察的真实价值是10，000美元。假设模型预测与真实值完全相同，除了这个模型预测为<em class="om"> x </em>的特定观察值。我们将把<em class="om"> x </em>从$1，000变到$19，000，并查看产生的错误。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="db1f" class="ln lo it lj b gy lp lq l lr ls">true &lt;- 10000<br/>pred &lt;- seq(from = 1000, to = 19000, length.out = 181)<br/>x &lt;- pred - true<br/>rmse &lt;- (x ^ 2) ^ 0.5<br/>rmsle &lt;- ((log(pred) - log(true)) ^ 2) ^ 0.5<br/><br/>par(mfrow = c(1, 2))<br/>plot(x = x, y = rmse, <br/>     type = "l", <br/>     main = "Root Mean Squared Error", <br/>     xlab = "Error (prediction - actual)", ylab = "RMSE")<br/>plot(x = x, y = rmsle, <br/>     type = "l", <br/>     main = "Root Mean Squared Logarithmic Error", <br/>     xlab = "Error (prediction - actual)", ylab = "RMSLE")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/7b0bf457ebf3995a699fbfc6bfaaef7a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*o4znyCFFGEw_whbKYjzm3Q.png"/></div></figure><p id="9544" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">正如我们所看到的，RMSLE对于实际变量的低估比高估招致了更大的惩罚。另外，RMSLE度量只考虑预测值和实际值之间的相对误差，误差的大小并不显著。另一方面，如果误差范围增大，RMSE值的大小也会增大。这意味着当低估不可取时，RMSLE应该比RMSE更有用。</p><p id="862b" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">梅和RMSE对错误的方向漠不关心。由于误差在平均之前被平方，因此RMSE对大误差给予相对较高的权重。这意味着当大误差特别不理想时，RMSE应该比MAE更有用。</p><p id="1d9b" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">了解了指标，我们只需将新数据<code class="fe oe of og lj b">test.csv</code>应用于模型并查看指标得分，即可验证模型的性能。由于数据较少，我们不做k重交叉验证。</p><h1 id="49dd" class="mz lo it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">建模</h1><p id="2440" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">我们将为这个问题建立和训练线性回归模型。首先，让我们使用模型中所有可用的特性。</p><h2 id="7a27" class="ln lo it bd na oo op dn ne oq or dp ni md os ot nk mh ou ov nm ml ow ox no iz bi translated">线性回归</h2><p id="7e5b" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">线性回归将通过使用<em class="om">反向消除</em>的自动特征选择来实现。从使用所有特征开始，<em class="om">反向消除</em>过程将迭代地丢弃一些特征并评估模型，直到找到一个具有最低阿凯克信息标准(AIC)的特征。给定一组数据模型，AIC根据信息损失估计每个模型相对于其他模型的质量。更低的AIC意味着更好的模型。我们将使用<code class="fe oe of og lj b">step()</code>函数以贪婪的方式应用<em class="om">反向消除</em>。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="75ab" class="ln lo it lj b gy lp lq l lr ls">temp &lt;- lm(charges ~ ., data = train)<br/>step(temp)</span><span id="70c7" class="ln lo it lj b gy lt lq l lr ls">#&gt; Start:  AIC=18667.88<br/>#&gt; charges ~ age + sex + bmi + children + smoker + region<br/>#&gt; <br/>#&gt;            Df   Sum of Sq          RSS   AIC<br/>#&gt; - region    3   136779757  40475571916 18666<br/>#&gt; - sex       1       43071  40338835230 18666<br/>#&gt; &lt;none&gt;                     40338792158 18668<br/>#&gt; - children  1   294681919  40633474078 18674<br/>#&gt; - bmi       1  4133255306  44472047465 18770<br/>#&gt; - age       1 13330028969  53668821128 18971<br/>#&gt; - smoker    1 95616334451 135955126610 19965<br/>#&gt; <br/>#&gt; Step:  AIC=18665.5<br/>#&gt; charges ~ age + sex + bmi + children + smoker<br/>#&gt; <br/>#&gt;            Df   Sum of Sq          RSS   AIC<br/>#&gt; - sex       1      120916  40475692832 18664<br/>#&gt; &lt;none&gt;                     40475571916 18666<br/>#&gt; - children  1   288132465  40763704381 18671<br/>#&gt; - bmi       1  4147134564  44622706480 18768<br/>#&gt; - age       1 13500662196  53976234111 18971<br/>#&gt; - smoker    1 96273590176 136749162092 19965<br/>#&gt; <br/>#&gt; Step:  AIC=18663.5<br/>#&gt; charges ~ age + bmi + children + smoker<br/>#&gt; <br/>#&gt;            Df   Sum of Sq          RSS   AIC<br/>#&gt; &lt;none&gt;                     40475692832 18664<br/>#&gt; - children  1   288027795  40763720627 18669<br/>#&gt; - bmi       1  4151671360  44627364191 18766<br/>#&gt; - age       1 13508639838  53984332670 18969<br/>#&gt; - smoker    1 96513856276 136989549108 19965<br/><br/>#&gt; <br/>#&gt; Call:<br/>#&gt; lm(formula = charges ~ age + bmi + children + smoker, data = train)<br/>#&gt; <br/>#&gt; Coefficients:<br/>#&gt; (Intercept)          age          bmi     children    smokeryes  <br/>#&gt;    -11905.1        254.9        320.6        429.9      23586.1</span></pre><p id="23ef" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">将最佳模型保存为<code class="fe oe of og lj b">lm_all</code>，然后进行预测。之后，计算指标。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="6f53" class="ln lo it lj b gy lp lq l lr ls">lm_all &lt;- lm(formula = charges ~ age + bmi + children + smoker, data = train)<br/>y_pred &lt;- predict(lm_all, test)<br/>mae &lt;- MAE(y_pred, test$charges)<br/>rmse &lt;- RMSE(y_pred, test$charges)</span></pre><p id="d89d" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">要计算RMSLE，请注意，我们必须让预测和目标变量的值为正，否则对数将导致NaN。正如我们在下面检查的，我们在预测中确实有一个负值，观测值149。克服这个问题的一个常见方法是在训练模型之前使用<code class="fe oe of og lj b">charges</code>的<code class="fe oe of og lj b">log()</code>，然后使用<code class="fe oe of og lj b">exp()</code>将预测转换回来。但是，由于我们之前已经使用了线性回归模型而没有取<code class="fe oe of og lj b">charges</code>的<code class="fe oe of og lj b">log()</code>，我们将坚持使用这个模型。带有负面预测的观察值将从RMSLE计算中简单地丢弃。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="5136" class="ln lo it lj b gy lp lq l lr ls">y_pred[y_pred &lt;=0]</span><span id="c9ae" class="ln lo it lj b gy lt lq l lr ls">#&gt;       149 <br/>#&gt; -87.05982</span><span id="ee0c" class="ln lo it lj b gy lt lq l lr ls">rmsle &lt;- RMSLE(y_pred[-149], test$charges[-149])<br/>lin_reg &lt;- cbind("MAE" = mae, "RMSE" = rmse, "RMSLE" = rmsle)<br/>lin_reg</span><span id="445e" class="ln lo it lj b gy lt lq l lr ls">#&gt;           MAE     RMSE     RMSLE<br/>#&gt; [1,] 3941.464 5672.102 0.5455373</span></pre><p id="1e4e" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们得到上述误差。对于梅和RMSE，我们可以将它们解释为模型预测<code class="fe oe of og lj b">charges</code>与真实值分别有3941美元和5672美元的平均差异。然而，我们不能再用<code class="fe oe of og lj b">charges</code>来解释RMSLE了。请注意，RMSE总是大于或等于梅。其实我们有这个不等式:<em class="om"> MAE ≤ RMSE ≤ √n×MAE </em>。</p><h2 id="47bb" class="ln lo it bd na oo op dn ne oq or dp ni md os ot nk mh ou ov nm ml ow ox no iz bi translated">多项式回归</h2><p id="5717" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">我们可以通过<em class="om">特征工程</em>来改进我们的模型，具体来说，就是通过创建新的特征来捕捉现有特征之间的交互。这被称为多项式回归。其思想是生成一个新的特征矩阵，该矩阵由次数小于或等于指定次数的特征的所有多项式组合组成。例如，如果输入样本是二维的并且具有[ <em class="om"> a </em>，<em class="om"> b </em> ]的形式，则2次多项式特征是[1，<em class="om"> a </em>，<em class="om"> b </em>，<em class="om"> a </em>，<em class="om"> ab </em>，<em class="om"> b </em>。我们将使用2度。</p><p id="3f41" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们不希望在生成多项式组合的过程中包含<code class="fe oe of og lj b">charges</code>，所以我们从<code class="fe oe of og lj b">train</code>和<code class="fe oe of og lj b">test</code>中取出<code class="fe oe of og lj b">charges</code>，分别保存为<code class="fe oe of og lj b">y_train</code>和<code class="fe oe of og lj b">y_test</code>。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="4cce" class="ln lo it lj b gy lp lq l lr ls">y_train &lt;- train$charges<br/>y_test &lt;- test$charges</span></pre><p id="da29" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">从EDA我们知道<code class="fe oe of og lj b">sex</code>和<code class="fe oe of og lj b">region</code>与<code class="fe oe of og lj b">charges</code>没有关联。我们可以放弃他们。此外，由于多项式组合对分类特征没有意义，我们将<code class="fe oe of og lj b">smoker</code>突变为数字。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="5527" class="ln lo it lj b gy lp lq l lr ls">X_train &lt;- train %&gt;% <br/>  select(-c(charges, sex, region)) %&gt;% <br/>  mutate(smoker = as.numeric(smoker))<br/>X_test &lt;- test %&gt;% <br/>  select(-c(charges, sex, region)) %&gt;% <br/>  mutate(smoker = as.numeric(smoker))</span></pre><p id="5256" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们使用下面的公式来应用多项式组合。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="9842" class="ln lo it lj b gy lp lq l lr ls">formula &lt;- as.formula(<br/>  paste(<br/>    ' ~ .^2 + ', <br/>    paste('poly(', colnames(X_train), ', 2, raw=TRUE)[, 2]', collapse = ' + ')<br/>  )<br/>)<br/><br/>formula</span><span id="335e" class="ln lo it lj b gy lt lq l lr ls">#&gt; ~.^2 + poly(age, 2, raw = TRUE)[, 2] + poly(bmi, 2, raw = TRUE)[, <br/>#&gt;     2] + poly(children, 2, raw = TRUE)[, 2] + poly(smoker, 2, <br/>#&gt;     raw = TRUE)[, 2]<br/>#&gt; &lt;environment: 0x0000020d27017690&gt;</span></pre><p id="25df" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">然后，将<code class="fe oe of og lj b">y_train</code>和<code class="fe oe of og lj b">y_test</code>插回到新的数据集。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="307d" class="ln lo it lj b gy lp lq l lr ls">train_poly &lt;- as.data.frame(model.matrix(formula, data = X_train))<br/>test_poly &lt;- as.data.frame(model.matrix(formula, data = X_test))<br/>train_poly$charges &lt;- y_train<br/>test_poly$charges &lt;- y_test<br/>colnames(train_poly)</span><span id="5ec3" class="ln lo it lj b gy lt lq l lr ls">#&gt;  [1] "(Intercept)"                        "age"                                "bmi"                               <br/>#&gt;  [4] "children"                           "smoker"                             "poly(age, 2, raw = TRUE)[, 2]"     <br/>#&gt;  [7] "poly(bmi, 2, raw = TRUE)[, 2]"      "poly(children, 2, raw = TRUE)[, 2]" "poly(smoker, 2, raw = TRUE)[, 2]"  <br/>#&gt; [10] "age:bmi"                            "age:children"                       "age:smoker"                        <br/>#&gt; [13] "bmi:children"                       "bmi:smoker"                         "children:smoker"                   <br/>#&gt; [16] "charges"</span></pre><p id="6841" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们可以看到我们的新数据集<code class="fe oe of og lj b">train_poly</code>和<code class="fe oe of og lj b">test_poly</code>现在有16列:</p><ol class=""><li id="db13" class="nv nw it lw b lx ly ma mb md nx mh ny ml nz mp oa ob oc od bi translated"><code class="fe oe of og lj b">(Intercept)</code>是由常数1组成的列，这是多项式中的常数项。</li><li id="87ff" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">age</code>、<code class="fe oe of og lj b">bmi</code>、<code class="fe oe of og lj b">children</code>、<code class="fe oe of og lj b">smoker</code>为原始特征。</li><li id="5480" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">age²</code>、<code class="fe oe of og lj b">bmi²</code>、<code class="fe oe of og lj b">children²</code>、<code class="fe oe of og lj b">smoker²</code>都是正方形的原始特征。</li><li id="5987" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">age x bmi</code>、<code class="fe oe of og lj b">age x children</code>、<code class="fe oe of og lj b">age x smoker</code>、<code class="fe oe of og lj b">bmi x children</code>、<code class="fe oe of og lj b">bmi x smoker</code>、<code class="fe oe of og lj b">children x smoker</code>是四个特征对之间的六种相互作用。</li><li id="37af" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oa ob oc od bi translated"><code class="fe oe of og lj b">charges</code>是目标特征。</li></ol><p id="383a" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">现在，我们准备制作模型。像往常一样，我们从所有的特征开始，使用<em class="om">反向消除</em>一路向下。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="9823" class="ln lo it lj b gy lp lq l lr ls">temp &lt;- lm(formula = charges ~ ., data = train_poly)<br/>step(temp)</span><span id="008f" class="ln lo it lj b gy lt lq l lr ls">#&gt; Start:  AIC=18196.7<br/>#&gt; charges ~ `(Intercept)` + age + bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(smoker, 2, raw = TRUE)[, 2]` + `age:bmi` + `age:children` + <br/>#&gt;     `age:smoker` + `bmi:children` + `bmi:smoker` + `children:smoker`<br/>#&gt; <br/>#&gt; <br/>#&gt; Step:  AIC=18196.7<br/>#&gt; charges ~ `(Intercept)` + age + bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `age:bmi` + `age:children` + `age:smoker` + `bmi:children` + <br/>#&gt;     `bmi:smoker` + `children:smoker`<br/>#&gt; <br/>#&gt; <br/>#&gt; Step:  AIC=18196.7<br/>#&gt; charges ~ age + bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `age:bmi` + `age:children` + `age:smoker` + `bmi:children` + <br/>#&gt;     `bmi:smoker` + `children:smoker`<br/>#&gt; <br/>#&gt;                                        Df   Sum of Sq         RSS   AIC<br/>#&gt; - `age:smoker`                          1      638029 25718637159 18195<br/>#&gt; - `bmi:children`                        1      817883 25718817013 18195<br/>#&gt; - age                                   1     5612815 25723611945 18195<br/>#&gt; - `age:children`                        1     9673381 25727672511 18195<br/>#&gt; - `age:bmi`                             1    26766877 25744766007 18196<br/>#&gt; - `children:smoker`                     1    45654901 25763654030 18197<br/>#&gt; - children                              1    47711668 25765710798 18197<br/>#&gt; &lt;none&gt;                                                25717999130 18197<br/>#&gt; - `poly(children, 2, raw = TRUE)[, 2]`  1    63400816 25781399946 18197<br/>#&gt; - `poly(bmi, 2, raw = TRUE)[, 2]`       1   257208016 25975207146 18205<br/>#&gt; - `poly(age, 2, raw = TRUE)[, 2]`       1   258018286 25976017416 18205<br/>#&gt; - bmi                                   1   446640632 26164639762 18213<br/>#&gt; - smoker                                1  2015205306 27733204436 18275<br/>#&gt; - `bmi:smoker`                          1 13705549198 39423548327 18651<br/>#&gt; <br/>#&gt; Step:  AIC=18194.73<br/>#&gt; charges ~ age + bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `age:bmi` + `age:children` + `bmi:children` + `bmi:smoker` + <br/>#&gt;     `children:smoker`<br/>#&gt; <br/>#&gt;                                        Df   Sum of Sq         RSS   AIC<br/>#&gt; - `bmi:children`                        1      828285 25719465444 18193<br/>#&gt; - age                                   1     4976641 25723613800 18193<br/>#&gt; - `age:children`                        1     9825302 25728462461 18193<br/>#&gt; - `age:bmi`                             1    26787718 25745424877 18194<br/>#&gt; - `children:smoker`                     1    45119820 25763756979 18195<br/>#&gt; - children                              1    47286634 25765923793 18195<br/>#&gt; &lt;none&gt;                                                25718637159 18195<br/>#&gt; - `poly(children, 2, raw = TRUE)[, 2]`  1    63295487 25781932646 18195<br/>#&gt; - `poly(bmi, 2, raw = TRUE)[, 2]`       1   257419441 25976056600 18203<br/>#&gt; - `poly(age, 2, raw = TRUE)[, 2]`       1   257631866 25976269025 18203<br/>#&gt; - bmi                                   1   447419331 26166056489 18211<br/>#&gt; - smoker                                1  2445531784 28164168943 18290<br/>#&gt; - `bmi:smoker`                          1 13756292505 39474929664 18651<br/>#&gt; <br/>#&gt; Step:  AIC=18192.76<br/>#&gt; charges ~ age + bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `age:bmi` + `age:children` + `bmi:smoker` + `children:smoker`<br/>#&gt; <br/>#&gt;                                        Df   Sum of Sq         RSS   AIC<br/>#&gt; - age                                   1     5196666 25724662109 18191<br/>#&gt; - `age:children`                        1    11062155 25730527598 18191<br/>#&gt; - `age:bmi`                             1    27346149 25746811593 18192<br/>#&gt; - `children:smoker`                     1    46443285 25765908729 18193<br/>#&gt; &lt;none&gt;                                                25719465444 18193<br/>#&gt; - `poly(children, 2, raw = TRUE)[, 2]`  1    63858086 25783323530 18193<br/>#&gt; - children                              1   101526014 25820991458 18195<br/>#&gt; - `poly(bmi, 2, raw = TRUE)[, 2]`       1   256592182 25976057625 18201<br/>#&gt; - `poly(age, 2, raw = TRUE)[, 2]`       1   258013469 25977478912 18201<br/>#&gt; - bmi                                   1   446982085 26166447529 18209<br/>#&gt; - smoker                                1  2466700190 28186165633 18289<br/>#&gt; - `bmi:smoker`                          1 13890308278 39609773722 18652<br/>#&gt; <br/>#&gt; Step:  AIC=18190.98<br/>#&gt; charges ~ bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `age:bmi` + `age:children` + `bmi:smoker` + `children:smoker`<br/>#&gt; <br/>#&gt;                                        Df   Sum of Sq         RSS   AIC<br/>#&gt; - `age:children`                        1    10800698 25735462807 18189<br/>#&gt; - `age:bmi`                             1    22525274 25747187384 18190<br/>#&gt; - `children:smoker`                     1    46333040 25770995149 18191<br/>#&gt; &lt;none&gt;                                                25724662109 18191<br/>#&gt; - `poly(children, 2, raw = TRUE)[, 2]`  1    59835331 25784497440 18192<br/>#&gt; - children                              1    97931108 25822593218 18193<br/>#&gt; - `poly(bmi, 2, raw = TRUE)[, 2]`       1   252131105 25976793215 18199<br/>#&gt; - bmi                                   1   441828081 26166490190 18207<br/>#&gt; - `poly(age, 2, raw = TRUE)[, 2]`       1   527300413 26251962522 18211<br/>#&gt; - smoker                                1  2465304613 28189966723 18287<br/>#&gt; - `bmi:smoker`                          1 13885998170 39610660279 18650<br/>#&gt; <br/>#&gt; Step:  AIC=18189.43<br/>#&gt; charges ~ bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `age:bmi` + `bmi:smoker` + `children:smoker`<br/>#&gt; <br/>#&gt;                                        Df   Sum of Sq         RSS   AIC<br/>#&gt; - `age:bmi`                             1    24487435 25759950242 18188<br/>#&gt; &lt;none&gt;                                                25735462807 18189<br/>#&gt; - `children:smoker`                     1    49159638 25784622445 18190<br/>#&gt; - `poly(children, 2, raw = TRUE)[, 2]`  1    64458233 25799921040 18190<br/>#&gt; - children                              1   235234433 25970697239 18197<br/>#&gt; - `poly(bmi, 2, raw = TRUE)[, 2]`       1   255427192 25990889999 18198<br/>#&gt; - bmi                                   1   439409358 26174872164 18206<br/>#&gt; - `poly(age, 2, raw = TRUE)[, 2]`       1   548137618 26283600425 18210<br/>#&gt; - smoker                                1  2461486940 28196949747 18285<br/>#&gt; - `bmi:smoker`                          1 13883155020 39618617827 18649<br/>#&gt; <br/>#&gt; Step:  AIC=18188.44<br/>#&gt; charges ~ bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `bmi:smoker` + `children:smoker`<br/>#&gt; <br/>#&gt;                                        Df   Sum of Sq         RSS   AIC<br/>#&gt; &lt;none&gt;                                                25759950242 18188<br/>#&gt; - `children:smoker`                     1    49343171 25809293413 18189<br/>#&gt; - `poly(children, 2, raw = TRUE)[, 2]`  1    75043200 25834993442 18190<br/>#&gt; - `poly(bmi, 2, raw = TRUE)[, 2]`       1   246287385 26006237626 18197<br/>#&gt; - children                              1   257057142 26017007384 18197<br/>#&gt; - bmi                                   1   414955971 26174906212 18204<br/>#&gt; - smoker                                1  2440592260 28200542501 18283<br/>#&gt; - `bmi:smoker`                          1 13871440992 39631391233 18647<br/>#&gt; - `poly(age, 2, raw = TRUE)[, 2]`       1 14593600500 40353550742 18666<br/><br/>#&gt; <br/>#&gt; Call:<br/>#&gt; lm(formula = charges ~ bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `bmi:smoker` + `children:smoker`, data = train_poly)<br/>#&gt; <br/>#&gt; Coefficients:<br/>#&gt;                          (Intercept)                                   bmi                              children  <br/>#&gt;                            11544.691                              -820.904                              1711.975  <br/>#&gt;                               smoker       `poly(age, 2, raw = TRUE)[, 2]`       `poly(bmi, 2, raw = TRUE)[, 2]`  <br/>#&gt;                           -18804.065                                 3.319                                -9.138  <br/>#&gt; `poly(children, 2, raw = TRUE)[, 2]`                          `bmi:smoker`                     `children:smoker`  <br/>#&gt;                             -154.913                              1405.110                              -458.435</span></pre><p id="7031" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">将最佳模型保存为<code class="fe oe of og lj b">lm_poly</code>，然后预测。之后，计算指标。现在，我们很幸运在预测中没有负值，因此可以直接应用RMSLE计算。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="0919" class="ln lo it lj b gy lp lq l lr ls">lm_poly &lt;- lm(formula = charges ~ bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>    `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>    `bmi:smoker` + `children:smoker`, data = train_poly)<br/><br/>y_pred &lt;- predict(lm_poly, test_poly)<br/>mae &lt;- MAE(y_pred, test$charges)<br/>rmse &lt;- RMSE(y_pred, test$charges)<br/>rmsle &lt;- RMSLE(y_pred, test$charges)<br/><br/>poly_reg &lt;- cbind("MAE" = mae, "RMSE" = rmse, "RMSLE" = rmsle)<br/>poly_reg</span><span id="bd7e" class="ln lo it lj b gy lt lq l lr ls">#&gt;           MAE     RMSE     RMSLE<br/>#&gt; [1,] 2835.106 4327.179 0.3926167</span></pre><h2 id="9184" class="ln lo it bd na oo op dn ne oq or dp ni md os ot nk mh ou ov nm ml ow ox no iz bi translated">模型评估</h2><p id="8eae" class="pw-post-body-paragraph lu lv it lw b lx nq kd lz ma nr kg mc md ns mf mg mh nt mj mk ml nu mn mo mp im bi translated">来看看我们原来的线性回归模型的总结。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="f534" class="ln lo it lj b gy lp lq l lr ls">summary(lm_all)</span><span id="3da6" class="ln lo it lj b gy lt lq l lr ls">#&gt; <br/>#&gt; Call:<br/>#&gt; lm(formula = charges ~ age + bmi + children + smoker, data = train)<br/>#&gt; <br/>#&gt; Residuals:<br/>#&gt;    Min     1Q Median     3Q    Max <br/>#&gt; -11734  -2983  -1004   1356  29708 <br/>#&gt; <br/>#&gt; Coefficients:<br/>#&gt;              Estimate Std. Error t value             Pr(&gt;|t|)    <br/>#&gt; (Intercept) -11905.11    1060.63 -11.225 &lt; 0.0000000000000002 ***<br/>#&gt; age            254.87      13.52  18.844 &lt; 0.0000000000000002 ***<br/>#&gt; bmi            320.64      30.69  10.447 &lt; 0.0000000000000002 ***<br/>#&gt; children       429.86     156.22   2.752              0.00603 ** <br/>#&gt; smokeryes    23586.13     468.26  50.370 &lt; 0.0000000000000002 ***<br/>#&gt; ---<br/>#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>#&gt; <br/>#&gt; Residual standard error: 6168 on 1064 degrees of freedom<br/>#&gt; Multiple R-squared:  0.7359, Adjusted R-squared:  0.7349 <br/>#&gt; F-statistic: 741.3 on 4 and 1064 DF,  p-value: &lt; 0.00000000000000022</span></pre><p id="e514" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们有四个特征，所有这些特征对<code class="fe oe of og lj b">charges</code>都很重要(有真实的影响，而不是由于随机和抽样)。从这些系数中，我们知道一个不吸烟、没有孩子、身体质量指数为零的零岁老人将被医疗保险收取11905美元(我们知道这种情况是不可能的)。此外，由于<code class="fe oe of og lj b">smoker</code>在所有特性中具有最大的系数，所以在所有其他特性都固定的情况下，<code class="fe oe of og lj b">smoker</code>中的单位变化比其他特性中的单位变化产生更大的变化。在这种情况下，假设所有其他特征都是固定的，不吸烟者将比吸烟者少23，586美元的<code class="fe oe of og lj b">charge</code>，这是有道理的。</p><p id="78cc" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">该模型还具有0.7349的调整后R平方，这意味着该模型及其特征解释了<code class="fe oe of og lj b">charges</code>中总变化的73%。</p><p id="57cc" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">现在，让我们将其与新的多项式回归模型进行比较。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="38b1" class="ln lo it lj b gy lp lq l lr ls">summary(lm_poly)</span><span id="7a16" class="ln lo it lj b gy lt lq l lr ls">#&gt; <br/>#&gt; Call:<br/>#&gt; lm(formula = charges ~ bmi + children + smoker + `poly(age, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `poly(bmi, 2, raw = TRUE)[, 2]` + `poly(children, 2, raw = TRUE)[, 2]` + <br/>#&gt;     `bmi:smoker` + `children:smoker`, data = train_poly)<br/>#&gt; <br/>#&gt; Residuals:<br/>#&gt;      Min       1Q   Median       3Q      Max <br/>#&gt; -11017.7  -1932.9  -1339.8   -559.8  29962.3 <br/>#&gt; <br/>#&gt; Coefficients:<br/>#&gt;                                         Estimate  Std. Error t value             Pr(&gt;|t|)    <br/>#&gt; (Intercept)                           11544.6914   3699.3731   3.121              0.00185 ** <br/>#&gt; bmi                                    -820.9038    198.6602  -4.132            0.0000388 ***<br/>#&gt; children                               1711.9751    526.3834   3.252              0.00118 ** <br/>#&gt; smoker                               -18804.0652   1876.3926 -10.021 &lt; 0.0000000000000002 ***<br/>#&gt; `poly(age, 2, raw = TRUE)[, 2]`           3.3189      0.1354  24.505 &lt; 0.0000000000000002 ***<br/>#&gt; `poly(bmi, 2, raw = TRUE)[, 2]`          -9.1376      2.8703  -3.183              0.00150 ** <br/>#&gt; `poly(children, 2, raw = TRUE)[, 2]`   -154.9126     88.1557  -1.757              0.07916 .  <br/>#&gt; `bmi:smoker`                           1405.1099     58.8124  23.891 &lt; 0.0000000000000002 ***<br/>#&gt; `children:smoker`                      -458.4348    321.7241  -1.425              0.15447    <br/>#&gt; ---<br/>#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>#&gt; <br/>#&gt; Residual standard error: 4930 on 1060 degrees of freedom<br/>#&gt; Multiple R-squared:  0.8319, Adjusted R-squared:  0.8307 <br/>#&gt; F-statistic: 655.9 on 8 and 1060 DF,  p-value: &lt; 0.00000000000000022</span></pre><p id="0117" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们有八个特征，除了<code class="fe oe of og lj b">children:smoker</code>之外，所有这些特征在<code class="fe oe of og lj b">charges</code>上都很重要。从这些系数中，我们知道一个不吸烟的零岁无子女且身体质量指数为零的人将被医疗保险收取11，540美元(我们知道这种情况是不可能的)。此外，由于<code class="fe oe of og lj b">smoker</code>在所有特性中具有最大的系数，所以在所有其他特性都固定的情况下，<code class="fe oe of og lj b">smoker</code>中的单位变化比其他特性中的单位变化产生更大的变化。在这种情况下，假设所有其他特征都是固定的，一个不吸烟的人将比一个吸烟的人多18800美元。等等，什么！？从这个分析中，我们知道通过使用多项式组合向我们的模型引入新特征，关于模型的假设可能改变，并且模型的解释可能误导。</p><p id="0a25" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">该模型的调整后R平方为0.8307，这意味着该模型及其特征解释了<code class="fe oe of og lj b">charges</code>中总变化的83%。换句话说，这个多项式回归模型比早期的线性回归模型捕获了更多的方差<code class="fe oe of og lj b">charges</code>。</p><p id="526d" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">但是不要自高自大！使用线性回归模型时，需要满足几个假设:</p><ol class=""><li id="9b80" class="nv nw it lw b lx ly ma mb md nx mh ny ml nz mp oa ob oc od bi translated"><strong class="lw jd">数据的线性度</strong></li></ol><p id="30e5" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们需要确保预测值和目标变量之间存在线性关系。这可以通过直观地查看每对预测变量和目标变量之间的相关性来实现。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="9646" class="ln lo it lj b gy lp lq l lr ls">cols &lt;- c('age', 'children', 'bmi', 'smoker')<br/><br/>temp &lt;- train %&gt;% <br/>  select(cols) %&gt;% <br/>  mutate(smoker = as.numeric(smoker))<br/>temp$charges &lt;- y_train<br/>ggcorr(temp, label = T)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/7f6ac647e9c58165d9bf65592f85f03b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*q4qhEZ-FPZmTo-WLIenOYw.png"/></div></figure><p id="71ac" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">另一种方法是使用皮尔逊积差相关的假设检验。</p><ul class=""><li id="c1dc" class="nv nw it lw b lx ly ma mb md nx mh ny ml nz mp oy ob oc od bi translated">H0:预测者与<code class="fe oe of og lj b">charge</code>没有关联</li><li id="c39a" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oy ob oc od bi translated">H1:预测器与<code class="fe oe of og lj b">charge</code>相关</li></ul><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="8bd7" class="ln lo it lj b gy lp lq l lr ls">for (col in cols) {<br/>  cor &lt;- cor.test(temp[, col], temp$charges)<br/>  print(round(cor$p.value, 4))<br/>}</span><span id="2d15" class="ln lo it lj b gy lt lq l lr ls">#&gt; [1] 0<br/>#&gt; [1] 0.0062<br/>#&gt; [1] 0<br/>#&gt; [1] 0</span></pre><p id="5ec5" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">由于每个预测值-目标值对的p值低于α(0.05)，因此拒绝H0。我们可以有把握地说，预测因素与目标变量相关。</p><p id="9aea" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">现在，对于多项式回归。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="efb8" class="ln lo it lj b gy lp lq l lr ls">cols &lt;- c('bmi', 'children', 'smoker', 'poly(age, 2, raw = TRUE)[, 2]', <br/>          'poly(bmi, 2, raw = TRUE)[, 2]', 'poly(children, 2, raw = TRUE)[, 2]', <br/>          'bmi:smoker', 'children:smoker')<br/><br/>ggcorr(train_poly %&gt;% select(c(cols, 'charges')), hjust = 1, layout.exp = 2, label = T)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/eebde3ecefddfea7284ee4937ffded56.png" data-original-src="https://miro.medium.com/v2/format:webp/1*edmyMrIf6y0ijp3RTXh_gg.png"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="0c19" class="ln lo it lj b gy lp lq l lr ls">for (col in cols) {<br/>  cor &lt;- cor.test(train_poly[, col], train_poly$charges)<br/>  print(round(cor$p.value, 4))<br/>}</span><span id="70ff" class="ln lo it lj b gy lt lq l lr ls">#&gt; [1] 0<br/>#&gt; [1] 0.0062<br/>#&gt; [1] 0<br/>#&gt; [1] 0<br/>#&gt; [1] 0<br/>#&gt; [1] 0.1327<br/>#&gt; [1] 0<br/>#&gt; [1] 0</span></pre><p id="d3bb" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">我们可以说，预测因子与目标变量相关，除了<code class="fe oe of og lj b">children²</code>。</p><p id="6329" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated"><strong class="lw jd"> 2。残差的正态性</strong></p><p id="a05b" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">线性回归模型的残差应该是正态分布的，因为我们期望得到零值附近的残差。为了看到这一点，我们可以绘制残差直方图。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="989b" class="ln lo it lj b gy lp lq l lr ls">hist(lm_all$residuals)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/a86727e3d3ec465b33be50ca4063a103.png" data-original-src="https://miro.medium.com/v2/format:webp/1*8YYX92uiH6-JiX6HUIkzXg.png"/></div></figure><p id="0732" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">另一种方法是用夏皮罗-维尔克检验我们的残差。</p><ul class=""><li id="1b5f" class="nv nw it lw b lx ly ma mb md nx mh ny ml nz mp oy ob oc od bi translated">H0:残差呈正态分布</li><li id="1084" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oy ob oc od bi translated">H1:残差不是正态分布的</li></ul><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="b823" class="ln lo it lj b gy lp lq l lr ls">shapiro.test(lm_all$residuals)</span><span id="28f8" class="ln lo it lj b gy lt lq l lr ls">#&gt; <br/>#&gt;  Shapiro-Wilk normality test<br/>#&gt; <br/>#&gt; data:  lm_all$residuals<br/>#&gt; W = 0.89481, p-value &lt; 0.00000000000000022</span></pre><p id="6a1d" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">因为p值低于alpha (0.05)，所以拒绝H0。因此，残差不是正态分布的。</p><p id="33a4" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">现在，对于多项式回归。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="0994" class="ln lo it lj b gy lp lq l lr ls">hist(lm_poly$residuals)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/97ec4196b0249d789ff81dc024f2819c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*27O-dBUejlFKpLdDyU1PMQ.png"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="035c" class="ln lo it lj b gy lp lq l lr ls">shapiro.test(lm_poly$residuals)</span><span id="4e1d" class="ln lo it lj b gy lt lq l lr ls">#&gt; <br/>#&gt;  Shapiro-Wilk normality test<br/>#&gt; <br/>#&gt; data:  lm_poly$residuals<br/>#&gt; W = 0.65297, p-value &lt; 0.00000000000000022</span></pre><p id="bb3b" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">同理适用，残差不是正态分布。</p><p id="d1f7" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated"><strong class="lw jd"> 3。同方差</strong></p><p id="bdda" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">异方差是指变量在其值域内的可变性不相等的情况。在线性回归模型中，如果其误差的方差在整个目标变量范围内显示出不等的变化，则表明存在异方差，这意味着残差中存在非随机模式。我们可以通过绘制拟合值与残差图来直观地看到这一点。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="bec7" class="ln lo it lj b gy lp lq l lr ls">plot(lm_all$fitted.values, lm_all$residuals)<br/>abline(h=0, col = "red")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/4723f1053bd2f52d5c033106dd210f68.png" data-original-src="https://miro.medium.com/v2/format:webp/1*tG0YbCaKvxEuL9kD9xIQqg.png"/></div></figure><p id="7601" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">另一种方法是使用Breusch-Pagan假说。</p><ul class=""><li id="334f" class="nv nw it lw b lx ly ma mb md nx mh ny ml nz mp oy ob oc od bi translated">H0:同性恋</li><li id="b0f2" class="nv nw it lw b lx oh ma oi md oj mh ok ml ol mp oy ob oc od bi translated">H1:异方差</li></ul><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="0cf5" class="ln lo it lj b gy lp lq l lr ls">bptest(lm_all)</span><span id="f5fb" class="ln lo it lj b gy lt lq l lr ls">#&gt; <br/>#&gt;  studentized Breusch-Pagan test<br/>#&gt; <br/>#&gt; data:  lm_all<br/>#&gt; BP = 89.206, df = 4, p-value &lt; 0.00000000000000022</span></pre><p id="b10d" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">因为p值低于alpha (0.05)，所以拒绝H0。这意味着残差具有异方差性。</p><p id="10b7" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">现在，对于多项式回归。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="8a91" class="ln lo it lj b gy lp lq l lr ls">plot(lm_poly$fitted.values, lm_poly$residuals)<br/>abline(h=0, col = "red")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl on"><img src="../Images/8cbd7961b333b273077169dd20f6a66c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*RB1ka7jBAJBeDkCtE2WTrg.png"/></div></figure><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="c536" class="ln lo it lj b gy lp lq l lr ls">bptest(lm_poly)</span><span id="124f" class="ln lo it lj b gy lt lq l lr ls">#&gt; <br/>#&gt;  studentized Breusch-Pagan test<br/>#&gt; <br/>#&gt; data:  lm_poly<br/>#&gt; BP = 13.059, df = 8, p-value = 0.1098</span></pre><p id="a721" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">因为p值高于alpha (0.05)，所以接受H0。这意味着残差满足同方差假设。</p><p id="6d29" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated"><strong class="lw jd"> 4。预测值之间没有多重共线性</strong></p><p id="859c" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">评估多重共线性的统计工具之一是方差膨胀因子(VIF)。简而言之，VIF是一种在我们的模型中测量预测因子间多重共线性影响的方法。VIF &lt; 10表示预测值之间没有多重共线性。</p><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="88fc" class="ln lo it lj b gy lp lq l lr ls">vif(lm_all)</span><span id="1da5" class="ln lo it lj b gy lt lq l lr ls">#&gt;      age      bmi children   smoker <br/>#&gt; 1.018303 1.013178 1.004060 1.003712</span><span id="b44c" class="ln lo it lj b gy lt lq l lr ls">vif(lm_poly)</span><span id="7bce" class="ln lo it lj b gy lt lq l lr ls">#&gt;                                  bmi                             children                               smoker <br/>#&gt;                            66.442833                            17.844408                            25.228626 <br/>#&gt;      `poly(age, 2, raw = TRUE)[, 2]`      `poly(bmi, 2, raw = TRUE)[, 2]` `poly(children, 2, raw = TRUE)[, 2]` <br/>#&gt;                             1.020981                            56.740085                             6.702367 <br/>#&gt;                         `bmi:smoker`                    `children:smoker` <br/>#&gt;                            32.271971                            11.527064</span></pre><p id="4952" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">在线性回归模型中未发现多重共线性，但在多项式回归模型中发现多重共线性。这是有意义的，因为多项式回归中的某些要素是通过将线性回归模型中的两个要素相乘而创建的。</p><h1 id="7a50" class="mz lo it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">结论</h1><pre class="ks kt ku kv gt li lj lk ll aw lm bi"><span id="4ae1" class="ln lo it lj b gy lp lq l lr ls">result &lt;- rbind(lin_reg, poly_reg)<br/>rownames(result) &lt;- c("Linear Regression", "Polynomial Regression")<br/>result</span><span id="0d18" class="ln lo it lj b gy lt lq l lr ls">#&gt;                            MAE     RMSE     RMSLE<br/>#&gt; Linear Regression     3941.464 5672.102 0.5455373<br/>#&gt; Polynomial Regression 2835.106 4327.179 0.3926167</span></pre><p id="9d83" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">对于线性回归这样的简单模型，特征工程在改进模型方面起着重要的作用。在本文中，我们通过对2阶特征进行多项式组合来应用这一技术。我们看到模型有了显著的提高，MAE为2835，RMSE为4327，RMSLE为0.39。然而，在这个过程中，一些关于线性回归的假设可能会失效。还有，抽烟对钱包不好！！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/e1a6e3674ab93bcb99796285f9d0175c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6HsoGpmIb1oibJc_JWbqJA.gif"/></div></div></figure></div><div class="ab cl pa pb hx pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="im in io ip iq"><p id="4859" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">🔥你好！如果你喜欢这个故事，想支持我这个作家，可以考虑 <a class="ae lh" href="https://dwiuzila.medium.com/membership" rel="noopener"> <strong class="lw jd"> <em class="om">成为会员</em> </strong> </a> <em class="om">。每月只需5美元，你就可以无限制地阅读媒体上的所有报道。如果你注册使用我的链接，我会赚一小笔佣金。</em></p><p id="bd58" class="pw-post-body-paragraph lu lv it lw b lx ly kd lz ma mb kg mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">🔖<em class="om">想了解更多关于经典机器学习模型如何工作以及如何优化其参数的信息？或者MLOps大型项目的例子？有史以来最优秀的文章呢？继续阅读:</em></p><div class="ph pi gp gr pj"><div role="button" tabindex="0" class="ab bv gv cb fp pk pl bn pm lb ex"><div class="pn l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw po pp fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l po pp fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="ps pt gw l"><h2 class="bd jd ux nv fp uy fr fs uz fu fw jc bi translated">从零开始的机器学习</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi va au vb vc vd rn ve an eh ei vf vg vh el em eo de bk ep" href="https://dwiuzila.medium.com/list/machine-learning-from-scratch-b35db8650093?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vi l fo"><span class="bd b dl z dk">8 stories</span></div></div></div><div class="qf dh qg fp ab qh fo di"><div class="di px bv py pz"><div class="dh l"><img alt="" class="dh" src="../Images/4b97f3062e4883b24589972b2dc45d7e.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*CWNoicci28F2TUQc-vKijw.png"/></div></div><div class="di px bv qa qb qc"><div class="dh l"><img alt="" class="dh" src="../Images/b1f7021514ba57a443fe0db4b7001b26.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*wSRsSHYnIiGJFAqC"/></div></div><div class="di bv qd qe qc"><div class="dh l"><img alt="" class="dh" src="../Images/deb73e42c79667024a46c2c8902b81fa.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*HVEz7KwzO0tv1Q4d"/></div></div></div></div></div><div class="ph pi gp gr pj"><div role="button" tabindex="0" class="ab bv gv cb fp pk pl bn pm lb ex"><div class="pn l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw po pp fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l po pp fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="ps pt gw l"><h2 class="bd jd ux nv fp uy fr fs uz fu fw jc bi translated">高级优化方法</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi va au vb vc vd rn ve an eh ei vf vg vh el em eo de bk ep" href="https://dwiuzila.medium.com/list/advanced-optimization-methods-26e264a361e4?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vi l fo"><span class="bd b dl z dk">7 stories</span></div></div></div><div class="qf dh qg fp ab qh fo di"><div class="di px bv py pz"><div class="dh l"><img alt="" class="dh" src="../Images/15b3188b0f29894c2bcf3d0965515f44.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*BVMamoNudzn9UlAE"/></div></div><div class="di px bv qa qb qc"><div class="dh l"><img alt="" class="dh" src="../Images/3249ba2cf680952e2ccdff36d8ebf4a7.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*C1fv3HJdh1RBspwN"/></div></div><div class="di bv qd qe qc"><div class="dh l"><img alt="" class="dh" src="../Images/a73f0494533d8a08b01c2b899373d2b9.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*QZvzgiM2VnhYyx8M"/></div></div></div></div></div><div class="ph pi gp gr pj"><div role="button" tabindex="0" class="ab bv gv cb fp pk pl bn pm lb ex"><div class="pn l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw po pp fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l po pp fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="ps pt gw l"><h2 class="bd jd ux nv fp uy fr fs uz fu fw jc bi translated">MLOps大型项目</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi va au vb vc vd rn ve an eh ei vf vg vh el em eo de bk ep" href="https://dwiuzila.medium.com/list/mlops-megaproject-6a3bf86e45e4?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vi l fo"><span class="bd b dl z dk">6 stories</span></div></div></div><div class="qf dh qg fp ab qh fo di"><div class="di px bv py pz"><div class="dh l"><img alt="" class="dh" src="../Images/41b5d7dd3997969f3680648ada22fd7f.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*EBS8CP_UnStLesXoAvjeAQ.png"/></div></div><div class="di px bv qa qb qc"><div class="dh l"><img alt="" class="dh" src="../Images/41befac52d90334c64eef7fc5c4b4bde.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*XLpRKnIMcJzBzCwvXrLvsw.png"/></div></div><div class="di bv qd qe qc"><div class="dh l"><img alt="" class="dh" src="../Images/80908ef475e97fbc42efe3fae0dfcff5.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*K_gzBmjv-ZHlU0Q6HeXclQ.jpeg"/></div></div></div></div></div><div class="ph pi gp gr pj"><div role="button" tabindex="0" class="ab bv gv cb fp pk pl bn pm lb ex"><div class="pn l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw po pp fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l po pp fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://dwiuzila.medium.com/?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">艾伯斯·乌兹拉</a></p></div></div><div class="ps pt gw l"><h2 class="bd jd ux nv fp uy fr fs uz fu fw jc bi translated">我最好的故事</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi va au vb vc vd rn ve an eh ei vf vg vh el em eo de bk ep" href="https://dwiuzila.medium.com/list/my-best-stories-d8243ae80aa0?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vi l fo"><span class="bd b dl z dk">24 stories</span></div></div></div><div class="qf dh qg fp ab qh fo di"><div class="di px bv py pz"><div class="dh l"><img alt="" class="dh" src="../Images/0c862c3dee2d867d6996a970dd38360d.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*K1SQZ1rzr4cb-lSi"/></div></div><div class="di px bv qa qb qc"><div class="dh l"><img alt="" class="dh" src="../Images/392d63d181090365a63dc9060573bcff.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*hSKy6kKorAfHjHOK"/></div></div><div class="di bv qd qe qc"><div class="dh l"><img alt="" class="dh" src="../Images/f51725806220b60eccf5d4c385c700e9.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*HiyGwoGOMI5Ao_fd"/></div></div></div></div></div><div class="ph pi gp gr pj"><div role="button" tabindex="0" class="ab bv gv cb fp pk pl bn pm lb ex"><div class="pn l"><div class="ab q"><div class="l di"><img alt="Albers Uzila" class="l de bw po pp fe" src="../Images/b4f51438d99b29f789091dd239d7cfa6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*WVCVz-tM5PW1TaWqnVXRLQ.jpeg"/><div class="fb bw l po pp fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated">艾伯斯·乌兹拉</p></div></div><div class="ps pt gw l"><h2 class="bd jd ux nv fp uy fr fs uz fu fw jc bi translated">R中的数据科学</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi va au vb vc vd rn ve an eh ei vf vg vh el em eo de bk ep" href="https://dwiuzila.medium.com/list/data-science-in-r-0a8179814b50?source=post_page-----4876e3449adf--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vi l fo"><span class="bd b dl z dk">7 stories</span></div></div></div><div class="qf dh qg fp ab qh fo di"><div class="di px bv py pz"><div class="dh l"><img alt="" class="dh" src="../Images/e52e43bf7f22bfc0889cc794dcf734dd.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*10B3radiyQGAp-QA"/></div></div><div class="di px bv qa qb qc"><div class="dh l"><img alt="" class="dh" src="../Images/945fa9100c2a00b46f8aca3d3975f288.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*o6A863Vdwq7ThlmW"/></div></div><div class="di bv qd qe qc"><div class="dh l"><img alt="" class="dh" src="../Images/3ca9e4b148297dbc4e7da0a180cf9c99.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*ekmX89TW6N8Bi8bL"/></div></div></div></div></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><a href="https://dwiuzila.medium.com/membership"><div class="gh gi ql"><img src="../Images/f767019309a71e9b3b70d2f9b1016aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_dzEmnimgItuotIZ-y73A.png"/></div></a></figure></div></div>    
</body>
</html>