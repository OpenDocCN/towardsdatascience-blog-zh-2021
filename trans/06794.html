<html>
<head>
<title>How To Build and Deploy an NLP Model with FastAPI: Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ç”¨FastAPIæ„å»ºå’Œéƒ¨ç½²NLPæ¨¡å‹:ç¬¬1éƒ¨åˆ†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/how-to-build-and-deploy-an-nlp-model-with-fastapi-part-1-9c1c7030d40?source=collection_archive---------8-----------------------#2021-06-19">https://towardsdatascience.com/how-to-build-and-deploy-an-nlp-model-with-fastapi-part-1-9c1c7030d40?source=collection_archive---------8-----------------------#2021-06-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a90c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">éƒ¨ç½²NLPæ¨¡å‹çš„ç®€å•æ–¹æ³•ã€‚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/81135e439173da889f818a81fdb96c7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I874eEjLPHIcDhayUERJUA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">æ¥è‡ª<a class="ae kv" href="https://www.pexels.com/photo/person-in-blue-denim-jacket-holding-black-smartphone-5053740/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>çš„<a class="ae kv" href="https://www.pexels.com/@cottonbro?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> cottonbro </a>æ‘„å½±</p></figure><p id="8fb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">æ¨¡å‹éƒ¨ç½²</strong>å¦‚æœä½ è¦ä»äº‹NLPæ¨¡å‹å·¥ä½œï¼Œè¿™æ˜¯ä½ åº”è¯¥æŒæ¡çš„æœ€é‡è¦çš„æŠ€èƒ½ä¹‹ä¸€ã€‚</p><p id="2bbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ¨¡å‹éƒ¨ç½²æ˜¯å°†æ¨¡å‹é›†æˆåˆ°ç°æœ‰ç”Ÿäº§ç¯å¢ƒä¸­çš„è¿‡ç¨‹ã€‚è¯¥æ¨¡å‹å°†æ¥æ”¶è¾“å…¥ï¼Œå¹¶ä¸ºç‰¹å®šç”¨ä¾‹çš„å†³ç­–é¢„æµ‹è¾“å‡ºã€‚</p><blockquote class="ls"><p id="84ef" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated"><em class="mc">â€œåªæœ‰å½“æ¨¡å‹ä¸ä¸šåŠ¡ç³»ç»Ÿå®Œå…¨é›†æˆæ—¶ï¼Œæˆ‘ä»¬æ‰èƒ½ä»å…¶é¢„æµ‹ä¸­æå–çœŸæ­£çš„ä»·å€¼â€ã€‚â€”å…‹é‡Œæ–¯æ‰˜å¼—Â·è¨ç±³ä¹Œæ‹‰</em></p></blockquote><p id="9e4d" class="pw-post-body-paragraph kw kx iq ky b kz md jr lb lc me ju le lf mf lh li lj mg ll lm ln mh lp lq lr ij bi translated">æœ‰ä¸åŒçš„æ–¹æ³•å¯ä»¥å°†ä½ çš„NLPæ¨¡å‹éƒ¨ç½²åˆ°äº§å“ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨Flaskï¼ŒDjangoï¼ŒBottle e.t.c .ä½†æ˜¯åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨FastAPIæ„å»ºå’Œéƒ¨ç½²ä½ çš„NLPæ¨¡å‹ã€‚</p><p id="3298" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨è¿™ä¸€ç³»åˆ—æ–‡ç« ä¸­ï¼Œæ‚¨å°†äº†è§£åˆ°:</p><ul class=""><li id="89e0" class="mi mj iq ky b kz la lc ld lf mk lj ml ln mm lr mn mo mp mq bi translated">å¦‚ä½•å»ºç«‹ä¸€ä¸ªå°†IMDBç”µå½±è¯„è®ºåˆ†ç±»æˆä¸åŒæƒ…ç»ªçš„NLPæ¨¡å‹ï¼Ÿ</li><li id="1573" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated">ä»€ä¹ˆæ˜¯FastAPIï¼Œå¦‚ä½•å®‰è£…ï¼Ÿ</li><li id="5cf6" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated">å¦‚ä½•ç”¨FastAPIéƒ¨ç½²æ‚¨çš„æ¨¡å‹ï¼Ÿ</li><li id="95b3" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated">å¦‚ä½•åœ¨ä»»ä½•Pythonåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æ‚¨éƒ¨ç½²çš„NLPæ¨¡å‹ã€‚</li></ul><p id="82ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ç¬¬1éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹æ„å»ºä¸€ä¸ªNLPæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å¯ä»¥å°†ç”µå½±è¯„è®ºåˆ†ç±»ä¸ºä¸åŒçš„æƒ…æ„Ÿã€‚æ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><h1 id="3c8f" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">å¦‚ä½•å»ºç«‹è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹</h1><p id="a4ee" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹æˆ‘ä»¬çš„NLPæ¨¡å‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<a class="ae kv" href="https://www.kaggle.com/c/word2vec-nlp-tutorial/data?ref=hackernoon.com" rel="noopener ugc nofollow" target="_blank"> IMDBç”µå½±æ•°æ®é›†</a>æ¥æ„å»ºä¸€ä¸ªç®€å•çš„æ¨¡å‹ï¼Œè¯¥æ¨¡å‹å¯ä»¥åˆ†ç±»å…³äºè¯¥ç”µå½±çš„è¯„è®ºæ˜¯æ­£é¢çš„è¿˜æ˜¯è´Ÿé¢çš„ã€‚ä¸‹é¢æ˜¯ä½ åº”è¯¥éµå¾ªçš„æ­¥éª¤ã€‚</p><h2 id="4820" class="nt mx iq bd my nu nv dn nc nw nx dp ng lf ny nz ni lj oa ob nk ln oc od nm oe bi translated">å¯¼å…¥é‡è¦çš„åŒ…</h2><p id="5fcd" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥é‡è¦çš„pythonåŒ…æ¥åŠ è½½æ•°æ®ï¼Œæ¸…ç†æ•°æ®ï¼Œåˆ›å»ºæœºå™¨å­¦ä¹ æ¨¡å‹(åˆ†ç±»å™¨)ï¼Œå¹¶ä¿å­˜æ¨¡å‹ä»¥ä¾›éƒ¨ç½²ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="45d9" class="nt mx iq og b gy ok ol l om on"># import important modules<br/>import numpy as np<br/>import pandas as pd</span><span id="583a" class="nt mx iq og b gy oo ol l om on"># sklearn modules<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.pipeline import Pipeline<br/>from sklearn.naive_bayes import MultinomialNB # classifier </span><span id="935e" class="nt mx iq og b gy oo ol l om on">from sklearn.metrics import (<br/>    accuracy_score,<br/>    classification_report,<br/>    plot_confusion_matrix,<br/>)<br/>from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer</span><span id="9817" class="nt mx iq og b gy oo ol l om on"># text preprocessing modules<br/>from string import punctuation </span><span id="74d0" class="nt mx iq og b gy oo ol l om on"># text preprocessing modules<br/>from nltk.tokenize import word_tokenize</span><span id="4dfb" class="nt mx iq og b gy oo ol l om on">import nltk<br/>from nltk.corpus import stopwords<br/>from nltk.stem import WordNetLemmatizer <br/>import re #regular expression</span><span id="5bb2" class="nt mx iq og b gy oo ol l om on"># Download dependency<br/>for dependency in (<br/>    "brown",<br/>    "names",<br/>    "wordnet",<br/>    "averaged_perceptron_tagger",<br/>    "universal_tagset",<br/>):<br/>    nltk.download(dependency)<br/>    <br/>import warnings<br/>warnings.filterwarnings("ignore")<br/># seeding<br/>np.random.seed(123)</span></pre><p id="0a26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä»æ•°æ®æ–‡ä»¶å¤¹åŠ è½½æ•°æ®é›†ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="a9b0" class="nt mx iq og b gy ok ol l om on"># load data<br/>data = pd.read_csv("../data/labeledTrainData.tsv", sep='\t')</span></pre><p id="ee35" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ˜¾ç¤ºæ•°æ®é›†çš„æ ·æœ¬ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="f24d" class="nt mx iq og b gy ok ol l om on"># show top five rows of data<br/>data.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/3b9084e49dc7382c98161308ef612adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/0*esD8-cAwTmwoXXFY.jpeg"/></div></figure><p id="d6c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬çš„æ•°æ®é›†æœ‰3åˆ—ã€‚</p><ul class=""><li id="c445" class="mi mj iq ky b kz la lc ld lf mk lj ml ln mm lr mn mo mp mq bi translated"><strong class="ky ir"> Id </strong> â€”è¿™æ˜¯å®¡æ ¸çš„Id</li><li id="5c66" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated"><strong class="ky ir">æƒ…ç»ª</strong> â€”ç§¯æ(1)æˆ–æ¶ˆæ(0)</li><li id="7fa1" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated"><strong class="ky ir">è¯„è®º</strong> â€”å¯¹ç”µå½±çš„è¯„è®º</li></ul><p id="05ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ£€æŸ¥æ•°æ®é›†çš„å½¢çŠ¶ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="4350" class="nt mx iq og b gy ok ol l om on"># check the shape of the data<br/>data.shape</span></pre><p id="f33a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">(25000, 3)</p><p id="cf4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¯¥æ•°æ®é›†æœ‰25ï¼Œ000æ¡è¯„è®ºã€‚</p><p id="1e6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬éœ€è¦æ£€æŸ¥æ•°æ®é›†æ˜¯å¦æœ‰ä»»ä½•ç¼ºå¤±å€¼ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="8968" class="nt mx iq og b gy ok ol l om on"># check missing values in data<br/>data.isnull().sum()</span></pre><p id="394d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">id 0 <br/>æ„Ÿæ‚Ÿ0 <br/>å›é¡¾0 <br/> dtype: int64</p><p id="086d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¾“å‡ºæ˜¾ç¤ºæˆ‘ä»¬çš„æ•°æ®é›†æ²¡æœ‰ä»»ä½•ç¼ºå¤±å€¼ã€‚</p><h2 id="1f5a" class="nt mx iq bd my nu nv dn nc nw nx dp ng lf ny nz ni lj oa ob nk ln oc od nm oe bi translated">å¦‚ä½•è¯„ä»·ç­çº§åˆ†å¸ƒ</h2><p id="33f3" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pandasåŒ…ä¸­çš„<strong class="ky ir"> value_counts() </strong>æ–¹æ³•æ¥è¯„ä¼°æ•°æ®é›†çš„ç±»åˆ†å¸ƒã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="20f9" class="nt mx iq og b gy ok ol l om on"># evalute news sentiment distribution<br/>data.sentiment.value_counts()</span></pre><p id="ac65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1 12500 <br/> 0 12500 <br/>åç§°:æƒ…æ“ï¼Œç±»å‹:int64</p><p id="fcae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬æœ‰ç›¸åŒæ•°é‡çš„æ­£é¢å’Œè´Ÿé¢è¯„è®ºã€‚</p><h2 id="1f39" class="nt mx iq bd my nu nv dn nc nw nx dp ng lf ny nz ni lj oa ob nk ln oc od nm oe bi translated">å¦‚ä½•å¤„ç†æ•°æ®</h2><p id="c088" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">åœ¨åˆ†ææ•°æ®é›†ä¹‹åï¼Œä¸‹ä¸€æ­¥æ˜¯åœ¨åˆ›å»ºæˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¹‹å‰ï¼Œå°†æ•°æ®é›†é¢„å¤„ç†æˆæ­£ç¡®çš„æ ¼å¼ã€‚</p><p id="bac9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ä¸ªæ•°æ®é›†ä¸­çš„è¯„è®ºåŒ…å«äº†å¾ˆå¤šæˆ‘ä»¬åœ¨åˆ›å»ºæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ä¸éœ€è¦çš„ä¸å¿…è¦çš„å•è¯å’Œå­—ç¬¦ã€‚</p><p id="448d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬å°†é€šè¿‡åˆ é™¤åœç”¨å­—è¯ã€æ•°å­—å’Œæ ‡ç‚¹æ¥æ¸…ç†é‚®ä»¶ã€‚ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨NLTKåŒ…ä¸­çš„è¯æ±‡åŒ–è¿‡ç¨‹å°†æ¯ä¸ªå•è¯è½¬æ¢æˆå®ƒçš„åŸºæœ¬å½¢å¼ã€‚</p><p id="7822" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å‡½æ•°<strong class="ky ir"> text_cleaning() </strong>å°†å¤„ç†æ‰€æœ‰å¿…è¦çš„æ­¥éª¤æ¥æ¸…ç†æˆ‘ä»¬çš„æ•°æ®é›†ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="cb0e" class="nt mx iq og b gy ok ol l om on">stop_words =  stopwords.words('english')</span><span id="2656" class="nt mx iq og b gy oo ol l om on">def text_cleaning(text, remove_stop_words=True, lemmatize_words=True):<br/>    # Clean the text, with the option to remove stop_words and to lemmatize word</span><span id="f810" class="nt mx iq og b gy oo ol l om on">    # Clean the text<br/>    text = re.sub(r"[^A-Za-z0-9]", " ", text)<br/>    text = re.sub(r"\'s", " ", text)<br/>    text =  re.sub(r'http\S+',' link ', text)<br/>    text = re.sub(r'\b\d+(?:\.\d+)?\s+', '', text) # remove numbers<br/>        <br/>    # Remove punctuation from text<br/>    text = ''.join([c for c in text if c not in punctuation])<br/>    <br/>    # Optionally, remove stop words<br/>    if remove_stop_words:<br/>        text = text.split()<br/>        text = [w for w in text if not w in stop_words]<br/>        text = " ".join(text)<br/>    <br/>    # Optionally, shorten words to their stems<br/>    if lemmatize_words:<br/>        text = text.split()<br/>        lemmatizer = WordNetLemmatizer() <br/>        lemmatized_words = [lemmatizer.lemmatize(word) for word in text]<br/>        text = " ".join(lemmatized_words)<br/>    <br/>    # Return a list of words<br/>    return(text)</span></pre><p id="bec8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨<strong class="ky ir"> text_cleaning() </strong>å‡½æ•°æ¥æ¸…ç†æˆ‘ä»¬çš„æ•°æ®é›†ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="32cc" class="nt mx iq og b gy ok ol l om on">#clean the review<br/>data["cleaned_review"] = data["review"].apply(text_cleaning)</span></pre><p id="8870" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç„¶åå°†æ•°æ®åˆ†ä¸ºç‰¹å¾å˜é‡å’Œç›®æ ‡å˜é‡ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="e5ef" class="nt mx iq og b gy ok ol l om on">#split features and target from  data <br/>X = data["cleaned_review"]<br/>y = data.sentiment.values</span></pre><p id="f44d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬è®­ç»ƒçš„ç‰¹ç‚¹æ˜¯<strong class="ky ir"> cleaned_review </strong>å˜é‡ï¼Œç›®æ ‡æ˜¯<strong class="ky ir">æƒ…ç»ª</strong>å˜é‡ã€‚</p><p id="ffa5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç„¶åï¼Œæˆ‘ä»¬å°†æ•°æ®é›†åˆ†æˆè®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚æµ‹è¯•è§„æ¨¡æ˜¯æ•´ä¸ªæ•°æ®é›†çš„15%ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="8e80" class="nt mx iq og b gy ok ol l om on"># split data into train and validate</span><span id="a8ba" class="nt mx iq og b gy oo ol l om on">X_train, X_valid, y_train, y_valid = train_test_split(<br/>    X,<br/>    y,<br/>    test_size=0.15,<br/>    random_state=42,<br/>    shuffle=True,<br/>    stratify=y,<br/>)</span></pre><h2 id="aa29" class="nt mx iq bd my nu nv dn nc nw nx dp ng lf ny nz ni lj oa ob nk ln oc od nm oe bi translated">å¦‚ä½•å®é™…åˆ›å»ºæˆ‘ä»¬çš„NLPæ¨¡å‹</h2><p id="e3c1" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">æˆ‘ä»¬å°†è®­ç»ƒå¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ç®—æ³•æ¥åˆ†ç±»è¯„è®ºæ˜¯æ­£é¢è¿˜æ˜¯è´Ÿé¢ã€‚è¿™æ˜¯æ–‡æœ¬åˆ†ç±»æœ€å¸¸ç”¨çš„ç®—æ³•ä¹‹ä¸€ã€‚</p><p id="74ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½†æ˜¯åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬æ¸…ç†è¿‡çš„è¯„è®ºè½¬æ¢æˆæ•°å€¼ï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿç†è§£è¿™äº›æ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨scikit-learnä¸­çš„<strong class="ky ir"> TfidfVectorizer </strong>æ–¹æ³•ã€‚TfidfVectorizerå°†å¸®åŠ©æˆ‘ä»¬å°†ä¸€ç»„æ–‡æœ¬æ–‡æ¡£è½¬æ¢ä¸ºTF-IDFç‰¹å¾çŸ©é˜µã€‚</p><p id="55cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†åº”ç”¨è¿™ä¸€ç³»åˆ—æ­¥éª¤(é¢„å¤„ç†å’Œè®­ç»ƒ)ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªscikit-learnçš„ä¸€ä¸ª<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html?ref=hackernoon.com" rel="noopener ugc nofollow" target="_blank">ç®¡é“ç±»</a>ï¼Œå®ƒé¡ºåºåº”ç”¨ä¸€ç³»åˆ—è½¬æ¢å’Œä¸€ä¸ªæœ€ç»ˆä¼°è®¡å™¨ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="216e" class="nt mx iq og b gy ok ol l om on"># Create a classifier in pipeline<br/>sentiment_classifier = Pipeline(steps=[<br/>                               ('pre_processing',TfidfVectorizer(lowercase=False)),<br/>                                 ('naive_bayes',MultinomialNB())<br/>                                 ])</span></pre><p id="a4e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç„¶åæˆ‘ä»¬è®­ç»ƒæˆ‘ä»¬çš„åˆ†ç±»å™¨ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="6504" class="nt mx iq og b gy ok ol l om on"># train the sentiment classifier </span><span id="6289" class="nt mx iq og b gy oo ol l om on">sentiment_classifier.fit(X_train,y_train)</span></pre><p id="3693" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç„¶åï¼Œæˆ‘ä»¬æ ¹æ®éªŒè¯é›†åˆ›å»ºä¸€ä¸ªé¢„æµ‹ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="bf4f" class="nt mx iq og b gy ok ol l om on"># test model performance on valid data <br/>y_preds = sentiment_classifier.predict(X_valid)</span></pre><p id="52e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å°†ä½¿ç”¨<strong class="ky ir"> accuracy_score </strong>è¯„ä¼°æŒ‡æ ‡æ¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚æˆ‘ä»¬ä½¿ç”¨accuracy_scoreæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨æƒ…æ„Ÿå˜é‡ä¸­æœ‰ç›¸åŒæ•°é‡çš„ç±»ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="005e" class="nt mx iq og b gy ok ol l om on">accuracy_score(y_valid,y_preds)</span></pre><p id="63a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">0.8629333333333333</p><p id="4751" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬çš„æ¨¡å‹çš„ç²¾åº¦å¤§çº¦ä¸º86.29%ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ€§èƒ½ã€‚</p><h2 id="bfea" class="nt mx iq bd my nu nv dn nc nw nx dp ng lf ny nz ni lj oa ob nk ln oc od nm oe bi translated">ä¿å­˜æ¨¡å‹ç®¡é“</h2><p id="4b7b" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">æ¨¡å‹ç®¡é“å°†é€šè¿‡ä½¿ç”¨<strong class="ky ir"> joblib </strong> pythonåŒ…ä¿å­˜åœ¨æ¨¡å‹çš„ç›®å½•ä¸­ã€‚</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="7c07" class="nt mx iq og b gy ok ol l om on">#save model <br/>import joblib </span><span id="4ccb" class="nt mx iq og b gy oo ol l om on">joblib.dump(sentiment_classifier, '../models/sentiment_model_pipeline.pkl')</span></pre><h1 id="df73" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">åŒ…æ‰</h1><p id="6078" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">æ­å–œğŸ‘ğŸ‘ï¼Œæ‚¨å·²ç»å®Œæˆäº†ç¬¬1éƒ¨åˆ†çš„å­¦ä¹ ã€‚æˆ‘å¸Œæœ›ä½ å·²ç»å­¦åˆ°äº†ä¸€äº›å…³äºå¦‚ä½•æ„å»ºNLPæ¨¡å‹çš„æ–°çŸ¥è¯†ã€‚åœ¨ç¬¬2éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç”¨FastAPIéƒ¨ç½²NLPæ¨¡å‹ï¼Œå¹¶åœ¨pythonåº”ç”¨ç¨‹åºä¸­è¿è¡Œå®ƒã€‚</p><p id="066e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœä½ å­¦åˆ°äº†æ–°çš„ä¸œè¥¿æˆ–è€…å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œè¯·åˆ†äº«ç»™å…¶ä»–äººçœ‹ã€‚åœ¨é‚£ä¹‹å‰ï¼Œç¬¬2éƒ¨åˆ†å†è§ï¼</p><p id="d65f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ ä¹Ÿå¯ä»¥åœ¨Twitterä¸Šæ‰¾åˆ°æˆ‘<a class="ae kv" href="https://twitter.com/Davis_McDavid?ref=hackernoon.com" rel="noopener ugc nofollow" target="_blank"> @Davis_McDavid </a>ã€‚</p><p id="b8da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="oq">æœ€åä¸€ä»¶äº‹:</em> </strong> <em class="oq">åœ¨ä»¥ä¸‹é“¾æ¥é˜…è¯»æ›´å¤šç±»ä¼¼è¿™æ ·çš„æ–‡ç« ã€‚</em></p><div class="or os gp gr ot ou"><a href="https://medium.com/geekculture/scikit-learn-0-24-top-5-new-features-you-need-to-know-7af15d8cdeac" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">sci kit-å­¦ä¹ 0.24:æ‚¨éœ€è¦äº†è§£çš„5å¤§æ–°åŠŸèƒ½</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">Scikit-learnä»ç„¶æ˜¯æœ€å—æ¬¢è¿çš„Pythonå¼€æºå…è´¹æœºå™¨å­¦ä¹ åº“ä¹‹ä¸€ã€‚çš„â€¦</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">medium.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi kp ou"/></div></div></a></div><div class="or os gp gr ot ou"><a rel="noopener follow" target="_blank" href="/improve-ml-model-performance-by-combining-categorical-features-a23efbb6a215"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">é€šè¿‡ç»„åˆåˆ†ç±»ç‰¹å¾æé«˜MLæ¨¡å‹æ€§èƒ½</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">æé«˜æœºå™¨å­¦ä¹ æ¨¡å‹æ€§èƒ½çš„ç®€å•æŠ€å·§ã€‚</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">towardsdatascience.com</p></div></div><div class="pd l"><div class="pj l pf pg ph pd pi kp ou"/></div></div></a></div><div class="or os gp gr ot ou"><a href="https://medium.com/analytics-vidhya/how-to-deploy-a-machine-learning-model-for-free-7-ml-model-deployment-cloud-platforms-fd9191726a10" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">å¦‚ä½•å…è´¹éƒ¨ç½²æœºå™¨å­¦ä¹ æ¨¡å‹â€” 7 MLæ¨¡å‹éƒ¨ç½²äº‘å¹³å°</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">æˆ‘è®°å¾—æˆ‘ç¬¬ä¸€æ¬¡åˆ›å»ºä¸€ä¸ªç®€å•çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚è¿™æ˜¯ä¸€ä¸ªå¯ä»¥é¢„æµ‹ä½ å·¥èµ„çš„æ¨¡å‹â€¦</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">medium.com</p></div></div><div class="pd l"><div class="pk l pf pg ph pd pi kp ou"/></div></div></a></div><p id="9e91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oq">ä»¥å‰åœ¨è¿™é‡Œå‘è¡¨è¿‡</em> <a class="ae kv" href="https://hackernoon.com/how-to-build-and-deploy-an-nlp-model-with-fastapi-part-1-n5w35cj" rel="noopener ugc nofollow" target="_blank"> <em class="oq">ã€‚</em>T13ã€‘</a></p></div></div>    
</body>
</html>