<html>
<head>
<title>Some Tips on SQL DDL, SQL DML, Consistency, and Performance Index</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于SQL DDL、SQL DML、一致性和性能指数的一些提示</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/some-tips-on-sql-ddl-sql-dml-costintency-and-performance-index-1364230b8a70?source=collection_archive---------36-----------------------#2021-05-24">https://towardsdatascience.com/some-tips-on-sql-ddl-sql-dml-costintency-and-performance-index-1364230b8a70?source=collection_archive---------36-----------------------#2021-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d246" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">开始掌握SQL并构建自己的数据模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7520349ef58a41600a81176f6d6036ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTbpjCnwYqJM9deYATFTVg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">吉列尔莫·费拉在<a class="ae ky" href="https://unsplash.com/s/photos/universe?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="910a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当有人想进入数据分析领域时，最大的错误之一是低估了SQL的能力，以及在您的数据专业职业生涯中掌握这一技能的重要性。在本文中，我将重点介绍一些能够真正帮助您提高对SQL的理解的技巧。这篇文章将分为以下几个主题:</p><ul class=""><li id="d106" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated">SQL数据定义语言</li><li id="3cb9" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">SQL数据操作语言</li><li id="cac6" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">约束的一致性和索引的性能</li></ul><p id="e1a4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果你是SQL新手，建议你先从基础做起，再看这篇文章。在网上，有许多关于SQL基础知识的资源，但是如果你愿意，你可以通过阅读以下三篇文章来跟随我的SQL教程:</p><ul class=""><li id="ddf4" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/some-important-key-concepts-to-start-using-postgresql-c6de63ab683f">开始使用PostgreSQL的一些重要概念</a></li><li id="d996" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/working-with-multiple-tables-thanks-to-sql-and-erd-9cb5dcb99228">借助SQL和ERD处理多个表</a></li><li id="d639" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/window-functions-and-other-concepts-of-sql-d53ca756e254">窗口函数和SQL的其他概念</a></li></ul><p id="e7ce" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">所以，如果你准备好了，让我们开始吧！</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="f5a9" class="mq mr it bd ms mt mu dn mv mw mx dp my lp mz na nb lt nc nd ne lx nf ng nh ni bi translated">第一部分:SQL数据定义语言</h2><p id="ddae" class="pw-post-body-paragraph lg lh it li b lj nj ju ll lm nk jx lo lp nl lr ls lt nm lv lw lx nn lz ma mb im bi translated">对于数据定义语言，我指的是当您想要创建、更改、删除或截断一个表时所必需的所有方面。换句话说，创建和修改表结构所需的一切。</p><p id="d84c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">首先，需要识别数字、整数、小数、文本、日期/时间等不同的数据类型。我将在本文中考虑的数据库管理系统是Postgres，所以如果你想安装它，请查看本文。</p><p id="3b24" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">关于Postgres中的数字数据类型，我们有一堆不同的数字类型，比如SMALLINT、INTEGER、BIGINT、DECIMAL、Numeric、REAL、DOUBLE PRECISION、SMALLSERIAL、SERIAL和BIGSERIAL。现在你可能会问自己它们之间的区别是什么，以及如何才能理解最适合你的情况。</p><p id="ec9c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">不要担心，这些数据类型很多都是相似的，现在我将向您展示。</p><p id="1f82" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">SMALLINT、INTEGER、BIGINT之间的唯一区别是可以存储的数字的给定范围。低于您可以为每种类型存储的数量的维度。</p><p id="cafa" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">SMALLINT:-32768到+32767</p><p id="0116" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">整数:-2147483648到+2147483647</p><p id="8b1e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">BIGINT:-9223372036854775808到+9223372036854775807</p><p id="613c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">因此，如果我需要存储一个大于32K或小于-32K的数，我会更喜欢使用INTEGER或BIGINT。</p><p id="1b1a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">另一个有趣的类型是以下三种类型:</p><p id="6bcf" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">小型串行:1到32，767</p><p id="b85f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">序列号:1至2，147，483，647</p><p id="79ea" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">大序列:1到9，223，372，036，854，775，807</p><p id="87d5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如你所注意到的，它们都没有负值，它们从1开始。关于序列类型的另一个重要考虑是，每次在表中添加一个新行时，Postgres默认会通过递增上一个序列来自动添加下一个序列。</p><p id="d5f3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">假设您有这三个表test_1、test_2和test_3。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="fb2e" class="mq mr it np b gy nt nu l nv nw">CREATE TABLE <strong class="np iu">test_1</strong> (<br/>"id" SMALLINT,<br/>"Test_Number" SMALLINT,<br/>"First_Name" VARCHAR(30),<br/>"Last_Name" VARCHAR(30));</span><span id="6cdb" class="mq mr it np b gy nx nu l nv nw">CREATE TABLE <strong class="np iu">test_2</strong> (<br/>"id" INT,<br/>"Test_Number" INT,<br/>First_Name" VARCHAR(30),<br/>"Last_Name" VARCHAR(30));</span><span id="5595" class="mq mr it np b gy nx nu l nv nw">CREATE TABLE <strong class="np iu">test_3</strong> (<br/>"id" SERIAL,<br/>"Test_Number" INT,<br/>"First_Name" VARCHAR(30),<br/>"Last_Name" VARCHAR(30));</span></pre><p id="4ac7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我想插入这些值:60000，'英里'，'戴维斯'。我们将逐步看到每个表的不同输出。对于第一个表:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0f88" class="mq mr it np b gy nt nu l nv nw">INSERT INTO test_1 VALUES (1, 60000, ‘Miles’, ‘Davis’); </span></pre><p id="869c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="4bc5" class="mq mr it np b gy nt nu l nv nw">ERROR: smallint out of range</span></pre><p id="d011" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如您注意到的，我们收到了一个错误，因为我将SMALLINT设置为表test_1的数据类型。</p><p id="49f6" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">相反，如果我们再次尝试，对于第二个表test_2，输出将是正确的，因为列“Test_Number”的数据类型现在是INT，其范围比以前更大。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="8152" class="mq mr it np b gy nt nu l nv nw">INSERT INTO test_2 VALUES (1, 60000, ‘Miles’, ‘Davis’);</span></pre><p id="a394" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">假设我们已经在表中插入了值(6000，' Miles '和' Davis ')，然后我们想插入第二行的值(70000，' John '和' Coltrane ')，并在默认情况下获得等于1和2的“id”。为了获得这个结果，我需要使用表test_3，其中列“id”的数据类型是SERIAL。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0e5c" class="mq mr it np b gy nt nu l nv nw">INSERT INTO test_3 (“test_number”,”first_name”,”last_name”) <br/>VALUES (60000, ‘Miles’, ‘Davis’), (70000, 'John', 'Coltrane');</span></pre><p id="0019" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/929c1f1a48e19b1dbcec7ef640ed19fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*o9KYRTFZYk6gAuwmUGRV-A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3153" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">对于VARCHAR和TEXT，您需要知道VARCHAR通常在您想要像前面的示例那样设置长度时使用，在前面的示例中，我将first_name和last_name的长度固定为等于<strong class="li iu"> 30 </strong>，但是我也可以使用不对插入到列中的值设置特定长度的TEXT类型。无论如何，请记住，TEXT相当于没有特定长度的VARCHAR。</p><p id="34c4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">另一个有趣的数据类型是日期。在Postgres中，您应该知道有一些技术可以帮助您检查Postgres服务器的时区，以及更改时区。下面的两个命令可以帮助你做到这一点:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0b0f" class="mq mr it np b gy nt nu l nv nw">SHOW TIMEZONE;<br/>SET TIMEZONE = "Europe/Rome"</span></pre><p id="6584" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">要显示当前时间戳、日期或时间，您可以使用以下命令:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="72f6" class="mq mr it np b gy nt nu l nv nw">SELECT CURRENT_TIMESTAMP;</span><span id="6d5e" class="mq mr it np b gy nx nu l nv nw">SELECT CURRENT_DATE;</span><span id="a69f" class="mq mr it np b gy nx nu l nv nw">SELECT CURRENT_TIME;</span></pre><p id="0b6d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">有时我们不想删除一个表，但我们只需要将值删除到表中，以便添加不同的值。因此，TRUNCATE命令可以帮助我们。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="d0f5" class="mq mr it np b gy nt nu l nv nw">TRUNCATE TABLE test_3 RESTART IDENTITY</span></pre><p id="fd54" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">您可以注意到，我添加了RESTART IDENTITY，因为我希望表test_3的列“id”从1而不是从3重新开始。</p><p id="79d6" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在描述中添加一些注释可以帮助其他人更好地理解特定列的含义。所以:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="7f92" class="mq mr it np b gy nt nu l nv nw">COMMENT ON COLUMN test_3.”test_number” <br/>IS ‘describe the number of tests in one year’;</span></pre><p id="e2cf" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">要查看注释，请使用以下命令:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a624" class="mq mr it np b gy nt nu l nv nw"><strong class="np iu">\d+ test_3</strong></span></pre><p id="0a86" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/5febcbf535128f4bd4ce4073e911a504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjVE8EFsEGtEE57vzaNO3w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6bd8" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在上面的输出中，你可以在左边看到我的评论。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="411e" class="mq mr it bd ms mt mu dn mv mw mx dp my lp mz na nb lt nc nd ne lx nf ng nh ni bi translated">第二部分:SQL数据操作语言</h2><p id="a1c7" class="pw-post-body-paragraph lg lh it li b lj nj ju ll lm nk jx lo lp nl lr ls lt nm lv lw lx nn lz ma mb im bi translated">在这一部分中，我们将看到一些关于数据操作的提示，以便添加、修改和删除数据。</p><p id="fd2c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">有时从另一个表中插入数据很有用，因此可以将数据从一个表迁移到另一个表。在前面的例子中，我创建了一个包含一些值的表test_3。现在，我想将表test_3中“名字”和“姓氏”列的值转移到名为test_4的新表中。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="1582" class="mq mr it np b gy nt nu l nv nw">CREATE TABLE test_4 (<br/>first_name VARCHAR(30),<br/>last_name VARCHAR(30));</span></pre><p id="8d0a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">所以这个表test_4是空的，我想插入test_3中的值。过程很简单:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="cf18" class="mq mr it np b gy nt nu l nv nw">INSERT INTO test_4 ("first_name", "last_name) <br/>SELECT “first_name”, ”last_name” FROM test_3;</span></pre><p id="acb0" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/faf8fc14dcc27aa96665f8d19ee8eb00.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*wiVbW4XKGx3DlQCxODHcyQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7709" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我想在这个新表中添加一列。所以:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="ea07" class="mq mr it np b gy nt nu l nv nw">ALTER TABLE test_4 ADD COLUMN “song” VARCHAR;</span></pre><p id="98d4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">另一个有用的技能是能够随时更新您的表。为此，我可以使用更新。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="6a29" class="mq mr it np b gy nt nu l nv nw">UPDATE test_4 SET “song”=’Blue in Gree’ WHERE “last_name”=’Davis’;</span><span id="8599" class="mq mr it np b gy nx nu l nv nw">UPDATE test_4 SET “song”=’In A Sentimental Mood’ <br/>WHERE “last_name”=’Coltrane’;</span><span id="ebde" class="mq mr it np b gy nx nu l nv nw">TABLE test_4;</span></pre><p id="6674" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/346238118922b2ebdc240eb76421e237.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*258_SWLtkpvWhiXtMwvy6g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6622" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我想删除第二行，添加不同的值，并改变表格。所以:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="71f9" class="mq mr it np b gy nt nu l nv nw">DELETE FROM test_4 WHERE “last_name”=’Coltrane’;</span><span id="23af" class="mq mr it np b gy nx nu l nv nw">INSERT INTO test_4 VALUES (‘Duke', 'Ellington’, ‘In A Sentimental Mood’);</span><span id="fba0" class="mq mr it np b gy nx nu l nv nw">ALTER TABLE test_4 ADD COLUMN "song_date" DATE;</span><span id="8ccc" class="mq mr it np b gy nx nu l nv nw">UPDATE test_4 SET "song_date"='1959-03-02' <br/>WHERE "last_name"='Davis';</span><span id="6cca" class="mq mr it np b gy nx nu l nv nw">UPDATE test_4 SET "song_date"='1935-04-30' <br/>WHERE "last_name"='Ellington';</span><span id="ba42" class="mq mr it np b gy nx nu l nv nw">INSERT INTO test_4 <br/>VALUES ('Paul', 'Desmond','Take Five', '1959-07-01');</span></pre><p id="3606" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/f3d395d6c8d4c105dfc24b7bd86ec86e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*FPv5fqoSuKal1Tc9u9MzZA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="847c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我比较一个音程和另一个音程。比如我想知道哪首歌有70多年。但在此之前，最好检查一下当前日期和歌曲日期之间的差异是否给了我们一个时间间隔。所以:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="4508" class="mq mr it np b gy nt nu l nv nw">SELECT <strong class="np iu">pg_typeof</strong>(CURRENT_TIMESTAMP — “song_date”) FROM test_4;</span></pre><p id="f6db" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/727d2d1c29eba28b32bf5c82dced6466.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/format:webp/1*dVCKu77rfR0sYtq-9596UQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="31d8" class="mq mr it np b gy nt nu l nv nw">SELECT “song”,”song_date”, <br/>(CURRENT_TIMESTAMP — “song_date”) &gt; INTERVAL ’70 years’ FROM test_4;</span></pre><p id="f96c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/2e972ac2f988079e783c300516ccbcec.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*OwRaZ0ACYO7n_2tDmSDHxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0e1f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">你可以看到第二首歌是70多年前的。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="c09b" class="mq mr it bd ms mt mu dn mv mw mx dp my lp mz na nb lt nc nd ne lx nf ng nh ni bi translated">第三部分:约束一致性和指标性能</h2><p id="708d" class="pw-post-body-paragraph lg lh it li b lj nj ju ll lm nk jx lo lp nl lr ls lt nm lv lw lx nn lz ma mb im bi translated">一致性在关系数据库中非常重要，您需要知道一些约束条件，比如在一列中只添加正数，在一列中只包含唯一值，或者构建一个引用特定外键的主键。</p><p id="5203" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">第一个约束是独特的。这个约束允许我们在一列或一组列中固定唯一的值。</p><p id="442f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下面我将向你展示使用UNIQUE的不同方法。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="ec0d" class="mq mr it np b gy nt nu l nv nw">--FIRST example--<br/>CREATE TABLE table_name (<br/>"id" SERIAL,<br/>"full_name" VARCHAR(30) UNIQUE);</span><span id="134c" class="mq mr it np b gy nx nu l nv nw">--SECOND example---<br/>CREATE TABLE table_name ( <br/>“id” SERIAL,<br/>"full_name" VARCHAR(30),<br/>UNIQUE ("full_name"));</span><span id="fa60" class="mq mr it np b gy nx nu l nv nw">--THIRD example--<br/>ALTER TABLE table_name ADD UNIQUE ("full_name")</span></pre><p id="7226" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在第三个示例中，您必须记住，如果表中没有重复的值或者表是空的，则可以以唯一的形式更改列。</p><p id="c634" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">一种特殊类型的唯一约束是主键。使用主键，我们可以确保特定的列将只获得唯一的值，而不是空值。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="e6ae" class="mq mr it np b gy nt nu l nv nw">--FIRST example--<br/>CREATE TABLE table_name_1 (<br/>"id" SERIAL PRIMARY KEY,<br/>"full_name" VARCHAR(30) UNIQUE);</span><span id="de07" class="mq mr it np b gy nx nu l nv nw">--SECOND example--<br/>CREATE TABLE table_name_1 (<br/>"id" SERIAL, <br/>"full_name" VARCHAR(30),<br/>PRIMARY KEY ("id"),<br/>UNIQUE ("full_name"));</span><span id="82e1" class="mq mr it np b gy nx nu l nv nw">--THIRD example--<br/>ALTER TABLE table_name_1 ADD PRIMARY KEY ("id")</span></pre><p id="63ea" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">另一个键是外键，它将一列中的值限制为出现在另一列中的值。下面是一些例子。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0467" class="mq mr it np b gy nt nu l nv nw">--FIRST example--<br/>CREATE TABLE table_name_2 (<br/>"id_2" INTEGER REFERENCES teble_name_1 ("id"),<br/>"full_name" VARCHAR(30) UNIQUE);</span><span id="5cb8" class="mq mr it np b gy nx nu l nv nw">--SECOND example--<br/>CREATE TABLE table_name_2 (<br/>"id_2" INTEGER,<br/>"full_name" VARCHAR(30),<br/>FOREIGN KEY ("id_2") REFERENCES table_name_1 ("id"),<br/>UNIQUE ("full_name"));</span><span id="f8bb" class="mq mr it np b gy nx nu l nv nw">--THIRD EXAMPLE--<br/>ALTER TABLE table_name_2 ADD FOREIGN KEY ("id_2") <br/>REFERENCES table_name_1 ("id"); </span></pre><p id="50e1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最后，我们可以看看INDEX，了解它在某些情况下如何帮助我们减少查询的处理时间。</p><p id="5f90" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">因此，要知道我们的查询需要多长时间才能产生输出，我们需要使用以下命令:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="991a" class="mq mr it np b gy nt nu l nv nw">\timing on</span></pre><p id="83f2" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下面列出了创建索引的不同方式:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="c228" class="mq mr it np b gy nt nu l nv nw">CREATE INDEX ON table_name (“col_1”);<br/>CREATE INDEX ON table_name (“col_1”, “col_2);<br/>CREATE UNIQUE INDEX ON table_name ("col_1");</span></pre><p id="d5bf" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">但是，您应该知道，有时Postgres更喜欢使用序列扫描，即使您已经设置了索引。发生这种情况是因为Postgres搜索最佳处理时间，在某些情况下，例如当记录的数量不是很大时，Postgres可以选择顺序扫描，而不是您设置的索引。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="2d8e" class="mq mr it bd ms mt mu dn mv mw mx dp my lp mz na nb lt nc nd ne lx nf ng nh ni bi translated">结论</h2><p id="5818" class="pw-post-body-paragraph lg lh it li b lj nj ju ll lm nk jx lo lp nl lr ls lt nm lv lw lx nn lz ma mb im bi translated">通过这篇文章，我认为您已经很好地了解了数据操作、数据定义、与约束的一致性以及如何使用索引。现在轮到您创建自己的数据模型，并尝试应用我们已经看到的步骤。祝你好运！</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="f575" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">感谢你阅读这篇文章。您还可以通过其他方式与我保持联系并关注我的工作:</p><ul class=""><li id="9db6" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated">订阅我的时事通讯。</li><li id="598f" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">也可以通过我的电报群<a class="ae ky" href="https://t.me/DataScienceForBeginners" rel="noopener ugc nofollow" target="_blank"> <em class="of">初学数据科学</em> </a>联系。</li></ul></div></div>    
</body>
</html>