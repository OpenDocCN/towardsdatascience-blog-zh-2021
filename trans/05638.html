<html>
<head>
<title>Tools to handle class imbalance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理阶级不平衡的工具</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tools-to-handle-class-imbalance-bff20c3bf099?source=collection_archive---------30-----------------------#2021-05-19">https://towardsdatascience.com/tools-to-handle-class-imbalance-bff20c3bf099?source=collection_archive---------30-----------------------#2021-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3def" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">数据科学</h2><div class=""/><div class=""><h2 id="b8fa" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">你的工具带上必须有工具</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/66837f640ff1933825a550c7f20c338e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oxmYyMkrQxcngfhq"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/s/photos/balance?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae le" href="https://unsplash.com/@acharki95?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Aziz Acharki </a>拍摄</p></figure><p id="3c5e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated"><span class="l mc md me bm mf mg mh mi mj di"> C </span>类不平衡指的是属于每个类的观察值的数量与属于其他类的观察值的数量显著不同的情况。这是机器学习中的常见问题之一，因为大多数机器学习算法都偏向于具有更多观察值的类，而且这经常会通过消除稀有类和预测多数类来误导我们的最终目标。</p><p id="ebbe" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">有许多处理类不平衡的技术，如成本敏感学习、采样方法和SMOTE。我们将看到一些python库，它们将帮助我们通过使用这些技术来解决这个问题，从而节省我们的时间并改善结果。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="7f2f" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">Imb-learn:</h1><p id="3571" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">不平衡学习是scikit-learn-contrib项目的一部分。这个软件包通过使用重采样技术的方法帮助我们处理类不平衡问题，例如</p><ul class=""><li id="6875" class="no np iq lh b li lj ll lm lo nq ls nr lw ns ma nt nu nv nw bi translated">欠采样多数类</li><li id="a489" class="no np iq lh b li nx ll ny lo nz ls oa lw ob ma nt nu nv nw bi translated">对少数民族阶层进行过度采样</li><li id="15b6" class="no np iq lh b li nx ll ny lo nz ls oa lw ob ma nt nu nv nw bi translated">结合过采样和欠采样技术</li><li id="f137" class="no np iq lh b li nx ll ny lo nz ls oa lw ob ma nt nu nv nw bi translated">创建平衡数据集的集合</li></ul><h2 id="c55c" class="oc ms iq bd mt od oe dn mx of og dp nb lo oh oi nd ls oj ok nf lw ol om nh iw bi translated">使用</h2><p id="03ef" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">让我们看看如何实现不平衡学习中的欠采样技术</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="1343" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我们导入必要的库和所需的数据集，然后将它们分成训练集和测试集，对于这个例子，我们将使用20个新闻组数据集</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="6bb2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们拟合一个朴素贝叶斯分类器并报告结果，正如您看到的度量宏平均f1分数(用于不平衡数据集)是79%</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="2a15" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们修改了现有代码，添加了一个来自不平衡学习的RandomUnderSampler，并安装了一个朴素贝叶斯分类器，您可以看到我们如何将f1分数从79%提高到85%</p><p id="9ce5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="op">RandomUnderSampler通过随机选择替换或不替换的样本对大多数类别进行欠采样[1]。</em>因此，多数和少数阶级将成为平等的比例，这有助于改善指标</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="3e57" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">SMOTE-变体:</h1><p id="0716" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">SMOTE-Synthetic Minority over sampling Technique的缩写，是一种广泛使用的处理类不平衡问题的重采样技术，这个包smote-variants实现了SMOTE技术的80多种变体，除了这些实现之外，这个框架还可以方便地启用任何数量的过采样技术来处理未知数据集上的类不平衡。</p><p id="8ed1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">尽管不平衡学习包实现了smote技术，但smote-variants包提供了smote技术的其他变体来帮助实现，而且作者已经发表了一篇论文[2]，阐述了SMOTE技术在不平衡数据集上的所有比较和评估</p><h2 id="d701" class="oc ms iq bd mt od oe dn mx of og dp nb lo oh oi nd ls oj ok nf lw ol om nh iw bi translated">用法:</h2><p id="4d64" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">smote-variants包可以以各种方式用于解决类不平衡问题，我们将使用来自不平衡数据库库的不平衡数据集iris0，该不平衡数据库具有许多不平衡数据集。</p><p id="d2c0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是一个二元分类数据集，下图显示了类的散点图。从图中，我们可以注意到两个阶级之间的阶级不平衡</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/d1677317c7094b67aa5500577c906427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*NBYUeZKLBndcdL3-q3VdNQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">两类散点图</p></figure><p id="7613" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们可以使用smote_variant包中的smote技术对此数据集进行过采样</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="6905" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下图显示了使用SMOTE技术创建的新少数民族样本</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/7653a16924b42db06fef48b6c843e7a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*Tbc3rbV58oNPZrnlbqDNCg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">带有X标记的样本是SMOTE新创建的</p></figure><p id="c7df" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们可以使用这个过采样数据集来训练模型。查看<a class="ae le" href="https://github.com/analyticalmindsltd/smote_variants" rel="noopener ugc nofollow" target="_blank">库</a>以获得更多示例。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="affa" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">回归重采样:</h1><p id="336e" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated"><em class="op">难道在回归任务中也会发生职业不平衡的问题！？</em></p><p id="009f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">是的，当目标变量偏离特定范围时，这种情况会发生在回归任务中，即在特定范围内存在更多数量的样本，假设您正在为您所在的州构建一个预测房价的预测分析模型，但由于一些问题，您只能收集几个城市的数据。但是各个城市的房价不同，因此您当前数据集的目标变量现在与几个城市的房价有偏差，这将在您的模型中引起问题，因为您将对整个州使用您的模型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi or"><img src="../Images/9301a7b3b6bd18c81992fd9729dd331c.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*LQzmwlF4UL7N-JNVtV-T0Q.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">偏斜度示例</p></figure><p id="73b6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了避免这种情况，您可以使用此包，并使用不平衡学习包对数据集进行重新采样。</p><h2 id="28c4" class="oc ms iq bd mt od oe dn mx of og dp nb lo oh oi nd ls oj ok nf lw ol om nh iw bi translated">用法:</h2><p id="c925" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">使用这个包相当简单明了</p><ul class=""><li id="e9ab" class="no np iq lh b li lj ll lm lo nq ls nr lw ns ma nt nu nv nw bi translated">从包中导入重采样器类并初始化它。</li><li id="ce32" class="no np iq lh b li nx ll ny lo nz ls oa lw ob ma nt nu nv nw bi translated">使重采样器适合目标变量，这将通过宁滨目标变量来创建目标类</li><li id="8293" class="no np iq lh b li nx ll ny lo nz ls oa lw ob ma nt nu nv nw bi translated">启动您喜欢的过采样技术，通过包中的<em class="op">重采样</em>方法对数据集进行重采样(记住使用目标类而不是目标)</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="e2c1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">查看官方教程以获得更多示例[3]</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="43a4" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">感谢阅读:</h1><p id="c4fe" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">如果你喜欢这篇文章或者有任何问题，请随时联系我</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="4eff" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">参考资料:</h1><p id="0d2c" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">[1] <a class="ae le" href="https://github.com/scikit-learn-contrib/imbalanced-learn" rel="noopener ugc nofollow" target="_blank">不平衡的Github回购-学习</a></p><p id="a39f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[2] <a class="ae le" href="https://www.researchgate.net/publication/334732374_An_empirical_comparison_and_evaluation_of_minority_oversampling_techniques_on_a_large_number_of_imbalanced_datasets" rel="noopener ugc nofollow" target="_blank">在大量不平衡数据集上对少数过采样技术的实证比较和评估</a></p><p id="c22c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[3] <a class="ae le" href="https://github.com/atif-hassan/Regression_ReSampling/tree/master/tutorials" rel="noopener ugc nofollow" target="_blank"> Github repo的回归-重采样</a></p></div></div>    
</body>
</html>