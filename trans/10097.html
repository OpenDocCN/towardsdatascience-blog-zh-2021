<html>
<head>
<title>How To Calculate the Mean and Standard Deviation — Normalizing Datasets in Pytorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何计算平均值和标准差—在Pytorch中归一化数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-calculate-the-mean-and-standard-deviation-normalizing-datasets-in-pytorch-704bd7d05f4c?source=collection_archive---------5-----------------------#2021-09-24">https://towardsdatascience.com/how-to-calculate-the-mean-and-standard-deviation-normalizing-datasets-in-pytorch-704bd7d05f4c?source=collection_archive---------5-----------------------#2021-09-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2103" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如果输入数据是标准化的，神经网络收敛得更快。了解如何计算自己数据集的平均值和标准差。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d57b822eea67c094234a31f71e9ff19a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnWt-TWtrUNNpeZMNLq21A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">露丝·齐默曼在<a class="ae ky" href="https://unsplash.com/s/photos/statistics?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="93f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">为什么归一化允许更快的收敛</h1><p id="581e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据集的规范化通常被视为一项相当平凡的任务，尽管它会强烈影响神经网络的性能。对于非标准化数据，特征的数值范围可能变化很大。以一个机器学习应用程序为例，在该应用程序中，房价是根据几个输入(表面积、年龄等)来预测的。表面积通常在100到500米之间，而年龄更可能在0到25岁之间。如果将这些原始数据输入到我们的机器学习模型中，将会出现缓慢的收敛。</p><p id="51f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如左图所示，搜索最陡的梯度，这在某种程度上是正确的方向，但也拥有相当大的振荡部分。这可以通过对学习率的推理来解释。<em class="ms">表面积</em>特征需要相对较大的学习速率，因为其范围相当大。但是这个大的学习率对于<em class="ms">年龄</em>来说太大了。优化器每一步都会超调，这会导致振荡，从而导致收敛缓慢。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/2a2ca857065d2d9a0d1f1e6e0590f920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onZIiGguLfbUYs3aTtmijg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标准化数据允许更快的收敛</p></figure><p id="ac22" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可以通过减去每个特征的平均值( )并除以标准差(σ)来对数据进行归一化。这样，每个特征的平均值为0，标准差为1。这导致更快的收敛。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/8828a274210cf56726ec4b493e501b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*7QKMRrMU6AG4XbgetvV9Dg.png"/></div></figure><p id="96ea" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在机器视觉中，每个图像通道都是这样标准化的。</p><h1 id="7446" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">计算数据集的平均值和标准差</h1><p id="0f96" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，需要一些进口。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="f99b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我将使用CIFAR数据集及其彩色图像作为例子。但是，同样的代码也适用于灰度图像的MNIST数据集。</p><p id="4cfe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">训练示例被下载并转换为张量，之后加载器获取64个图像的批次。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="8845" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">必须对所有图像、图像的高度和宽度计算平均值，但不能对通道进行计算。在彩色图像的情况下，期望大小为3的输出张量。</p><p id="94b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">标准偏差可通过以下公式计算:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/2e944bfe16e55901e59eb975fb5294bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*DtOEvFof-LjeWGMsgFJ2Gg.png"/></div></figure><p id="a5ca" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">E[X ]表示平方数据的平均值，而(E[X])表示数据平均值的平方。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="3582" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，计算CIFAR数据集的平均值和标准偏差。</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="7f59" class="nd la it mz b gy ne nf l ng nh">Mean: tensor([0.4914, 0.4822, 0.4465])<br/>Standard deviation: tensor([0.2471, 0.2435, 0.2616])</span></pre><h1 id="96ce" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">将标准化集成到您的Pytorch管道中</h1><p id="fd18" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据加载器必须结合这些标准化值，以便在训练过程中使用它们。因此，除了<em class="ms"> ToTensor() </em>变换之外，随后是利用获得的值的归一化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="7941" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，由于网络是在归一化图像上训练的，因此每个图像(无论是验证还是推断)都必须用相同的获得值进行归一化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8c02f80d8c79e08364c65221e7a9d45e.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*INm32Ti2yCM72duggdtjxw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自CIFAR数据集的归一化图像示例</p></figure><h1 id="92fc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="b592" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据规范化是神经网络训练过程中的一个重要步骤。通过将数据归一化为0的统一平均值和1的标准偏差，可以实现更快的收敛。</p><p id="15a2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您有任何问题，请随时联系我！</p></div></div>    
</body>
</html>