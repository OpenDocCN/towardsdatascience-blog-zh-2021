<html>
<head>
<title>DataPrep.Connector: The easiest way to retrieve data from APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据准备。连接器:从API检索数据的最简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dataprep-connector-the-easiest-way-to-retrieve-data-from-apis-ea50422268a1?source=collection_archive---------23-----------------------#2021-03-26">https://towardsdatascience.com/dataprep-connector-the-easiest-way-to-retrieve-data-from-apis-ea50422268a1?source=collection_archive---------23-----------------------#2021-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7a95" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">数据准备。连接器使得从流行的API获取数据变得轻而易举。如果不支持某个API，只需几个简单的步骤就可以自己添加了！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e065173580f1a059a0b99bbfa3525bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vTO1jdnpO0uSCshy"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">迪米特里·卡拉斯泰列夫在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="be91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">摘要:</em> </strong>数据准备。Connector是Python的DataPrep库的一个组件，可以加速数据加载。该工具减少了在项目中设置数据加载所需的开销。它功能强大且高效，允许开发人员以快速、熟悉且可重复的方式加载数据。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="4670" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">数据加载瓶颈</strong></p><p id="07f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据科学家19%的工作时间花在加载数据上[1]。收集数据的开销占用了不必要的时间，并且是重复性的。从数据库或通过API检索数据所需的代码几乎总是相同的。数据收集很耗时，但也不尽然。数据准备。Connector是一个易于使用的、开源的、轻量级的库，可以帮助您快速地从web资源中获取数据。</p><p id="d8b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">介绍DataPrep。连接器</strong></p><p id="c22d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据准备。连接器(或连接器)通过对开发人员隐藏实现细节来加速数据加载。从web API加载典型的数据需要设置身份验证和授权，发出HTTP请求，并牢牢掌握API文档。让这些任务的开销适应不同的API会很快失控。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/ddb65dc1ec7389797d00e035fff2b564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lYy9sjbZlmRVJ5JTOjGPFw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图1:在没有连接器的情况下，将多个服务合并到您的项目中所产生的组合爆炸</p></figure><p id="8bb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Connector是一个工具，它包装web数据源，并使它们在一个直观、快速且可重复的工作流中工作。将数据加载到项目中需要更少的时间和代码。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="47f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来看看连接器的运行情况。假设我们想从Spotify中检索Kanye West的所有专辑。有三个简单的步骤。</p><p id="5d56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">第一步:创建开发者账户</em> </strong></p><p id="5680" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">登录<a class="ae kv" href="https://developer.spotify.com/dashboard/login" rel="noopener ugc nofollow" target="_blank"> Spotify开发者仪表盘</a>，向他们注册一个项目。这将允许您获得调用API所需的授权。获得正确的auth是Connector不能为您做的一件事，并且您将需要它用于大多数API。</p><p id="9a4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">第二步:安装DataPrep </em> </strong></p><p id="5717" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您终端中的一个简单的pip命令将为您解决这个问题。</p><pre class="kg kh ki kj gt mb mc md me aw mf bi"><span id="99bd" class="mg mh iq mc b gy mi mj l mk ml">pip install dataprep</span></pre><p id="7d47" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">第三步:运行代码！</em>T25】</strong></p><pre class="kg kh ki kj gt mb mc md me aw mf bi"><span id="76c8" class="mg mh iq mc b gy mi mj l mk ml">from dataprep.connector import Connector</span><span id="661b" class="mg mh iq mc b gy mm mj l mk ml">client_id = “your_client_id”</span><span id="18c5" class="mg mh iq mc b gy mm mj l mk ml">client_secret = “your_client_secret”</span><span id="f36a" class="mg mh iq mc b gy mm mj l mk ml">spotify = Connector(“spotify”, _auth={“client_id”:client_id, “client_secret”:client_secret})</span><span id="a7f2" class="mg mh iq mc b gy mm mj l mk ml">kanye = await spotify.query(“album”, _q=”kanye west”)</span><span id="291d" class="mg mh iq mc b gy mm mj l mk ml">display(kanye)</span></pre><p id="04e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将这个简单的代码与不使用图2中的连接器时需要的代码进行比较。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/bfada94d879ba1c9019736cf595923fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T2MtMQ8nGoQSWNUr"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图2:使用和不使用连接器的相同任务所需的代码(图片由作者提供)</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="9002" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">连接器功能强大</strong></p><p id="6dea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">连接器不仅仅是一个包装器。您所熟悉的包装器，如<a class="ae kv" href="https://spotipy.readthedocs.io/en/2.17.1/" rel="noopener ugc nofollow" target="_blank"> Spotipy </a>和<a class="ae kv" href="https://www.tweepy.org/" rel="noopener ugc nofollow" target="_blank"> Tweepy </a>在减少与数据加载相关的开销和重复方面做得很好。但是连接器做得更多。它是统一的，可以更快地获取结果。</p><p id="9d45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">统一</em> </strong></p><p id="c371" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">连接器是一个统一的包装器。与特定API的特定包装器(例如专门为Spotify API工作的Spotify)不同，Connector可以包装任何web API。这是可能的，因为连接器是开源的。任何人都可以<a class="ae kv" href="https://github.com/sfu-db/APIConnectors" rel="noopener ugc nofollow" target="_blank">向项目贡献配置文件</a>来支持新的API(关于配置文件的更多内容将在本文后面介绍)。这意味着Connector将在未来不断增加对更多API的支持，并将所有API调用统一到一个简单的工作流中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/53ba02f7fc893137769a0dd56e2f9fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nx5p5N_0HgXB74BG"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图3:使用多个API的连接器。最大的区别在于_auth参数(图片由作者提供)</p></figure><p id="3292" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">分页</em> </strong></p><p id="9e7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Web APIs通常对一次调用可以检索的结果数量有限制。这要求用户了解这些限制，并在结果数量高于限制时处理案例。连接器为用户提供了一个计数参数，该参数允许连接器在后台处理这项工作。为您想要检索的结果数量指定一个值，Connector将处理其余的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/d1a40beaddbe4a4d20187be16e88ca79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZEdkOMTs0ki9shBJ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图4:这些片段显示了count参数用于返回结果的精确数量(图片由作者提供)</p></figure><p id="b504" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">并发</em> </strong></p><p id="fed4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些为count指定了较大值的请求可能需要很长时间。比方说，如果结果限制是50，而您的项目需要250个结果。当指定计数为250时，连接器将一个接一个地调用API 5次。这可能需要一段时间。连接器允许您通过concurrency参数指定您希望在<em class="ls">并行</em>中发出的请求数量。这允许更快地获取结果，因为现在调用不必等待上一个调用完成。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/f0eca7331b2c0c101eec92df591fcb7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g230N8mhrd9B8hw7"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图5:正在使用的并发参数。请注意检索相同数量的结果所用的时间差异(图片由作者提供)</p></figure><p id="de5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">连接器是怎么做到的</strong></p><p id="d567" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">连接器是开源的，这就是为什么它可以支持任何API。连接器从配置文件库中提取。每个API都有自己的配置文件，每个文件都由贡献者编写。如果连接器不支持用户想要访问的API，他们可以很容易地创建配置文件并将其添加到存储库中。然后，连接器将支持该API，所有开发人员都可以使用它。如果您有兴趣做出贡献，请查看我们的<a class="ae kv" href="https://github.com/sfu-db/APIConnectors" rel="noopener ugc nofollow" target="_blank"> APIConnectors </a>资源库。</p><p id="351a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">连接器的未来</strong></p><p id="1c86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前，连接器只从web APIs加载数据。DataPrep团队目前正在研究更多访问数据源的方法，比如数据库。用户提供的配置文件也将有助于连接器的发展，我们正在通过直观的GUI使添加配置文件变得更加容易。我们在<a class="ae kv" href="https://global.pydata.org/talks/340" rel="noopener ugc nofollow" target="_blank"> PyData 2020 </a>上讨论了连接器和其中的一些变化(点击这里查看我们的讨论<a class="ae kv" href="https://www.youtube.com/watch?v=56qu-0Ka-dA&amp;ab_channel=PyData" rel="noopener ugc nofollow" target="_blank">！</a>)。连接器是DataPrep的一个组件，这个库使得准备数据变得轻而易举。还有DataPrep的其他组件，比如DataPrep。EDA和DataPrep.Clean。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/587e34504cd711da79ca0c8f8efb6f7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JTJM-1U7oaJlalcm"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图DataPrep如何处理部分数据准备周期(图片由作者提供)</p></figure><p id="bfd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">DataPrep正在开发更多的特性和组件，以进一步改进数据准备。随着DataPrep的增长，Connector也将增长，加载数据将比以往更加容易。在我们的<a class="ae kv" href="https://dataprep.ai/" rel="noopener ugc nofollow" target="_blank">网站</a>上了解更多关于我们的信息，并关注我们即将发布的版本！</p><p id="f55e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">参考文献</em> </strong></p><p id="c759" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[1] Anaconda，<a class="ae kv" href="https://www.anaconda.com/state-of-data-science-2020" rel="noopener ugc nofollow" target="_blank">2020年数据科学状况</a> (2020)，2020年数据科学状况报告</p></div></div>    
</body>
</html>