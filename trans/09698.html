<html>
<head>
<title>Simple Image Classification Using FastAI.jl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用FastAI.jl进行简单的图像分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-image-classification-using-fastai-jl-83960d1d2ce1?source=collection_archive---------32-----------------------#2021-09-09">https://towardsdatascience.com/simple-image-classification-using-fastai-jl-83960d1d2ce1?source=collection_archive---------32-----------------------#2021-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ab30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Fastai库现在在Julia上，Python中也有类似的特性。在这个项目中，我们将训练Resnet-18模型，通过几个步骤对ImageNet数据集中的图像进行分类。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/0dca151caf0d61b7240986847f6c0a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5p3MNAU2N2pK0-2d.jpg"/></div></div><p class="kx ky gj gh gi kz la bd b be z dk translated">图片作者|元素作者<a class="ae lb" href="https://www.freepik.com/free-vector/hand-drawn-web-developers-working_12063788.htm#page=2&amp;query=coding&amp;position=39" rel="noopener ugc nofollow" target="_blank"> freepik </a></p></figure><h1 id="21c9" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">FastAI.jl简介</h1><p id="cb9c" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><a class="ae lb" href="https://github.com/FluxML/FastAI.jl" rel="noopener ugc nofollow" target="_blank"> FastAI.jl </a>库类似于Python中的<a class="ae lb" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank"> fast.ai </a>库，这是在Julia中试验深度学习项目的最佳方式。该库允许您使用最先进的模型，您可以通过使用几行代码来修改、训练和评估这些模型。FastAI.jl为深度学习提供了一个完整的生态系统，其中包括计算机视觉，自然语言处理，表格数据，每个月都会添加更多的子模块<a class="ae lb" href="https://fluxml.ai/FastAI.jl/dev/README.md.html" rel="noopener ugc nofollow" target="_blank"> FastAI (fluxml.ai) </a>。</p><p id="cdee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个项目中，我们将使用fastai库在带有<a class="ae lb" href="https://github.com/fastai/imagenette/blob/master/LICENSE" rel="noopener ugc nofollow" target="_blank"> Apache License 2.0 </a>的<a class="ae lb" href="https://github.com/fastai/imagenette" rel="noopener ugc nofollow" target="_blank">imagenette 2–160</a>数据集上训练一个图像分类器。imagenette 2–160数据集来自fastai数据集存储库，其中包含我们周围事物的较小尺寸图像，从动物到汽车。ResNet-18模型架构在<a class="ae lb" href="https://arxiv.org/pdf/1512.03385.pdf" rel="noopener ugc nofollow" target="_blank">用于图像识别的深度残差学习</a>中可用。我们不会深入数据集或模型架构如何工作，相反，我们将专注于fastai.jl如何使深度学习变得简单。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mf"><img src="../Images/56ea26415476a839075207f011436c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jUCMnwTPTf16HW3O.png"/></div></div><p class="kx ky gj gh gi kz la bd b be z dk translated">图片1</p></figure><h1 id="653c" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">Julia中的FastAI.jl入门</h1><p id="cfad" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">欲了解更多详情，请访问<a class="ae lb" href="https://fluxml.ai/FastAI.jl/dev/notebooks/quickstart.ipynb.html" rel="noopener ugc nofollow" target="_blank"> Quickstart (fluxml.ai) </a>，因为本项目中使用的代码来自fastai文档。</p><h2 id="d940" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">本地设置</h2><p id="ad4a" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">如果您的系统中安装了Julia，请键入:</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="5e68" class="mg ld iq mt b gy mx my l mz na">using Pkg<br/>Pkg.add("FastAI")<br/>Pkg.add("CairoMakie")</span></pre><p id="1fe6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如下图所示👇</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nb"><img src="../Images/c90ad3f7bfcf075588a1888a2655f531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UoqOJYPQHdOGrPE7.png"/></div></div><p class="kx ky gj gh gi kz la bd b be z dk translated">作者图片</p></figure><h2 id="073e" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">深度笔记</h2><p id="6152" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">对于Deepnote环境，您必须创建一个docker文件并添加:</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="0691" class="mg ld iq mt b gy mx my l mz na">FROM gcr.io/deepnote-200602/templates/deepnote<br/>RUN wget https://julialang-s3.julialang.org/bin/linux/x64/1.6/julia-1.6.2-linux-x86_64.tar.gz &amp;&amp; <br/>    tar -xvzf julia-1.6.2-linux-x86_64.tar.gz &amp;&amp; <br/>    sudo mv julia-1.6.2 /usr/lib/ &amp;&amp; <br/>    sudo ln -s /usr/lib/julia-1.6.2/bin/julia /usr/bin/julia &amp;&amp; <br/>    rm julia-1.6.2-linux-x86_64.tar.gz &amp;&amp; <br/>    julia  -e "using Pkg;pkg"add IJulia LinearAlgebra SparseArrays Images MAT""<br/>ENV DEFAULT_KERNEL_NAME "julia-1.6.2"</span></pre><h2 id="b572" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">Google Colab</h2><p id="001e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">对于Google Colab，你可以在GitHub<a class="ae lb" href="https://github.com/kingabzpro/Image-Classification-FastAI.jl" rel="noopener ugc nofollow" target="_blank">上关注我的报告，或者通过添加一个额外的单元格来创建一个Julia环境，如下所示。安装Julia软件包可能需要15分钟。</a></p><ol class=""><li id="9931" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">将运行时间更改为GPU以获得更快的结果。</li><li id="3e6e" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">执行下面的代码。</li><li id="1520" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">按F5重新加载此页面。</li></ol><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="a9f2" class="mg ld iq mt b gy mx my l mz na">%%shell<br/>set -e<br/>#---------------------------------------------------#<br/>JULIA_VERSION="1.6.2"<br/>export JULIA_PACKAGES="CUDA IJulia CairoMakie"<br/>JULIA_NUM_THREADS="2"<br/>#---------------------------------------------------#<br/>if [ -n "$COLAB_GPU" ] &amp;&amp; [ -z `which julia` ]; then<br/>  # Install Julia<br/>  JULIA_VER=`cut -d '.' -f -2 &lt;&lt;&lt; "$JULIA_VERSION"`<br/>  echo "Installing Julia $JULIA_VERSION on the current Colab Runtime..."<br/>  BASE_URL="https://julialang-s3.julialang.org/bin/linux/x64"<br/>  URL="$BASE_URL/$JULIA_VER/julia-$JULIA_VERSION-linux-x86_64.tar.gz"<br/>  wget -nv $URL -O /tmp/julia.tar.gz # -nv means "not verbose"<br/>  tar -x -f /tmp/julia.tar.gz -C /usr/local --strip-components 1<br/>  rm /tmp/julia.tar.gz<br/>  # Install Packages<br/>  echo "Installing Julia packages, this may take up to 15 minutes. "<br/>  julia -e 'using Pkg; Pkg.add(["CUDA", "IJulia", "CairoMakie"]); Pkg.add(Pkg.PackageSpec(url="https://github.com/FluxML/FastAI.jl")); Pkg.precompile()' &amp;&gt; /dev/null<br/>  # Install kernel and rename it to "julia"<br/>  echo "Installing IJulia kernel..."<br/>  julia -e 'using IJulia; IJulia.installkernel("julia", env=Dict(<br/>      "JULIA_NUM_THREADS"=&gt;"'"$JULIA_NUM_THREADS"'"))'<br/>  KERNEL_DIR=`julia -e "using IJulia; print(IJulia.kerneldir())"`<br/>  KERNEL_NAME=`ls -d "$KERNEL_DIR"/julia*`<br/>  mv -f $KERNEL_NAME "$KERNEL_DIR"/julia  <br/>  echo ''<br/>  echo "Success! Please reload this page and jump to the next section."<br/>fi</span></pre><h1 id="5fcb" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">利用FastAI.jl实现图像分类</h1><p id="7ba1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">检查版本以确保你有一个和我相似的版本。</p><p id="a72c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nq nr ns mt b">versioninfo()</code></p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="d644" class="mg ld iq mt b gy mx my l mz na">Julia Version 1.6.2<br/>Commit 1b93d53fc4 (2021-07-14 15:36 UTC)<br/>Platform Info:<br/>  OS: Linux (x86_64-pc-linux-gnu)<br/>  CPU: Intel(R) Xeon(R) CPU @ 2.30GHz<br/>  WORD_SIZE: 64<br/>  LIBM: libopenlibm<br/>  LLVM: libLLVM-11.0.1 (ORCJIT, haswell)<br/>Environment:<br/>  JULIA_NUM_THREADS = 2</span></pre><h2 id="113f" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">导入库</h2><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="1c7d" class="mg ld iq mt b gy mx my l mz na">using FastAI<br/>import CairoMakie</span></pre><h2 id="1ebf" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">下载数据集</h2><p id="d730" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我们使用<code class="fe nq nr ns mt b">loaddataset</code>函数从fastai导入本地数据集。正如你所看到的，使用一行代码就可以下载数据集，并为您提供访问所有图像位置的标签。</p><p id="b2cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nq nr ns mt b">data, blocks = loaddataset(“imagenette2–160”, (Image, Label))</code></p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="8186" class="mg ld iq mt b gy mx my l mz na">┌ Info: Downloading<br/>│   source = https://s3.amazonaws.com/fast-ai-imageclas/imagenette2-160.tgz<br/>│   dest = /root/.julia/datadeps/fastai-imagenette2-160/imagenette2-160.tgz<br/>│   progress = 1.0<br/>│   time_taken = 2.69 s<br/>│   time_remaining = 0.0 s<br/>│   average_speed = 35.138 MiB/s<br/>│   downloaded = 94.417 MiB<br/>│   remaining = 0 bytes<br/>│   total = 94.417 MiB<br/>└ @ HTTP /root/.julia/packages/HTTP/5e2VH/src/download.jl:128</span></pre><p id="836b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">数据</strong>包含图像的位置，<strong class="jp ir">块</strong>包含结构和图像标签。</p><p id="f8eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nq nr ns mt b">data</code></p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="8cae" class="mg ld iq mt b gy mx my l mz na">(mapobs(loadfile, ["/root/.julia/datadeps/fastai-imagenette2-160/imagenette2-160/train/n01440764/I…]), mapobs(parentname, ["/root/.julia/datadeps/fastai-imagenette2-160/imagenette2-160/train/n01440764/I…]))</span></pre><p id="ca1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nq nr ns mt b">blocks</code></p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="a369" class="mg ld iq mt b gy mx my l mz na">(Image{2}(), Label{String}(["n01440764", "n02102040", "n02979186", "n03000684", "n03028079", "n03394916", "n03417042", "n03425413", "n03445777", "n03888257"]))</span></pre><h1 id="155b" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">使用FastAI.jl探索用于图像分类的图像</h1><p id="809e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">通过使用getobs，我们可以从数据中检查单个样本，并检查类。在我们的例子中，类名是<em class="nt"> n01440764 </em>您也可以将该类重命名为<em class="nt"> fish </em>，但是为了简单起见，我们将为该类使用一个唯一的Id。我们还可以看到样本500中的图像。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="2a1b" class="mg ld iq mt b gy mx my l mz na">image, class = sample =  getobs(data, 500)<br/>@show class<br/>image</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/d4f02c84c277d99affac1fe178fde9b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/0*MF1t3O1V9Qx_yy7F.jpeg"/></div></figure><p id="adc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">或</strong></p><p id="aa73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以通过使用<code class="fe nq nr ns mt b">getobs</code>和<code class="fe nq nr ns mt b">plotsamples</code>来检查多张带有标签的照片。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="ed1a" class="mg ld iq mt b gy mx my l mz na">idxs = rand(1:nobs(data), 9)<br/>samples = [getobs(data, i) for i in idxs]<br/>plotsamples(method, samples)</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/942a413acf609ca86182579a4108fce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sLpeGoJG3xt6k-fP.png"/></div></div></figure><h1 id="fe62" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">图像分类功能</h1><p id="3d16" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">为了加载我们的图像数据，我们需要首先创建一个将图像转换为128X128的函数，并对它们进行预处理以随机放大(剪切、拉伸、旋转、翻转)。对于标签，它将使用一键编码将字符串标签转换为整数。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="6491" class="mg ld iq mt b gy mx my l mz na">method = BlockMethod(<br/><br/>blocks,<br/><br/>(<br/><br/>ProjectiveTransforms((128, 128)),<br/><br/>ImagePreprocessing(),<br/><br/>OneHot()<br/><br/>)<br/><br/>)</span></pre><p id="08ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">或</strong></p><p id="5784" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用<code class="fe nq nr ns mt b">ImageClassificationSingle</code>功能来重现相同的结果。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="1188" class="mg ld iq mt b gy mx my l mz na">method = ImageClassificationSingle(blocks)</span></pre><h1 id="3ebc" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">利用FastAI.jl建立影像分类模型</h1><ol class=""><li id="8c8b" class="nc nd iq jp b jq ma ju mb jy nw kc nx kg ny kk nh ni nj nk bi translated">首先，我们需要使用数据加载器来加载图像链接，并使用转换方法。这将把图像和标签转换成整数数据。</li><li id="e1fc" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated"><code class="fe nq nr ns mt b">methodmodel</code>采用image loader和ResNet architect的方法构建训练模型。</li><li id="7c65" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">我们可以简单地通过在<code class="fe nq nr ns mt b">metholossfn</code>中添加方法来创建一个损失函数。默认情况下，损失函数为<code class="fe nq nr ns mt b">CrossEntropy</code>。</li><li id="ae39" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">通过使用<code class="fe nq nr ns mt b">Learner</code>,我们组合了方法、数据加载器、优化器(ADAM)、损失函数和度量(在我们的例子中是准确性)。</li></ol><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="a97b" class="mg ld iq mt b gy mx my l mz na">dls = methoddataloaders(data, method)<br/>model = methodmodel(method, Models.xresnet18())<br/>lossfn = methodlossfn(method)<br/>learner = Learner(model, dls, ADAM(), lossfn, ToGPU(), Metrics(accuracy))</span></pre><p id="1dab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">或</strong></p><p id="ce30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以使用如下所示的一行代码简单地完成上述所有步骤。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="c839" class="mg ld iq mt b gy mx my l mz na">learner = methodlearner(method, data, Models.xresnet18(), ToGPU(), Metrics(accuracy))</span></pre><h1 id="3ca8" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">图像分类模型的训练与评估</h1><p id="6266" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我们将以0.002的学习率在10个时期上训练我们的模型。正如我们可以看到的，我们的训练和验证损失随着每次迭代而减少，但是在第5个时期之后，验证损失变得稳定。</p><p id="6b66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">最终指标:</strong></p><p id="31b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">训练=损失:0.07313 │准确率:98.38%</p><p id="c172" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">验证=损失:0.59254 │准确率:83.27%</p><blockquote class="nz oa ob"><p id="e1aa" class="jn jo nt jp b jq jr js jt ju jv jw jx oc jz ka kb od kd ke kf oe kh ki kj kk ij bi translated"><em class="iq">这并不坏，因为我们还没有清理数据或执行超参数调整。</em></p></blockquote><p id="d2f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nq nr ns mt b">fitonecycle!(learner, 10, 0.002)</code></p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="c786" class="mg ld iq mt b gy mx my l mz na">Epoch 1 TrainingPhase(): 100%|██████████████████████████| Time: 0:05:50</span><span id="b9cd" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   1.0 │ 1.75345 │  0.43189 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="5077" class="mg ld iq mt b gy of my l mz na">Epoch 1 ValidationPhase(): 100%|████████████████████████| Time: 0:00:19</span><span id="8a98" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   1.0 │ 1.54432 │  0.53701 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="afa1" class="mg ld iq mt b gy of my l mz na">Epoch 2 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:34</span><span id="4a4f" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   2.0 │ 1.37105 │  0.56158 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="07de" class="mg ld iq mt b gy of my l mz na">Epoch 2 ValidationPhase(): 100%|████████████████████████| Time: 0:00:17</span><span id="b67e" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   2.0 │ 1.23731 │  0.62673 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="9b7d" class="mg ld iq mt b gy of my l mz na">Epoch 3 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:32</span><span id="8ee2" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   3.0 │ 1.09463 │  0.65127 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="9ad8" class="mg ld iq mt b gy of my l mz na">Epoch 3 ValidationPhase(): 100%|████████████████████████| Time: 0:00:17</span><span id="1fb7" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   3.0 │ 1.11761 │  0.65932 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="2546" class="mg ld iq mt b gy of my l mz na">Epoch 4 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:31</span><span id="0cc9" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   4.0 │ 0.87518 │  0.71549 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="b875" class="mg ld iq mt b gy of my l mz na">Epoch 4 ValidationPhase(): 100%|████████████████████████| Time: 0:00:16</span><span id="36bf" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   4.0 │ 0.95252 │   0.6995 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="56c0" class="mg ld iq mt b gy of my l mz na">Epoch 5 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:29</span><span id="3a23" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   5.0 │ 0.70251 │  0.77235 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="ccd5" class="mg ld iq mt b gy of my l mz na">Epoch 5 ValidationPhase(): 100%|████████████████████████| Time: 0:00:16</span><span id="c354" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   5.0 │ 0.77653 │  0.75314 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="2bdb" class="mg ld iq mt b gy of my l mz na">Epoch 6 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:29</span><span id="c75e" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   6.0 │ 0.52883 │  0.82565 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="31a5" class="mg ld iq mt b gy of my l mz na">Epoch 6 ValidationPhase(): 100%|████████████████████████| Time: 0:00:16</span><span id="c738" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   6.0 │ 0.76827 │   0.7698 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="b3d4" class="mg ld iq mt b gy of my l mz na">Epoch 7 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:28</span><span id="9f18" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   7.0 │ 0.35174 │  0.88405 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="2e14" class="mg ld iq mt b gy of my l mz na">Epoch 7 ValidationPhase(): 100%|████████████████████████| Time: 0:00:16</span><span id="c7e1" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬────────┬──────────┐<br/>│           Phase │ Epoch │   Loss │ Accuracy │<br/>├─────────────────┼───────┼────────┼──────────┤<br/>│ ValidationPhase │   7.0 │ 0.7575 │  0.77955 │<br/>└─────────────────┴───────┴────────┴──────────┘</span><span id="9775" class="mg ld iq mt b gy of my l mz na">Epoch 8 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:28</span><span id="10aa" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   8.0 │ 0.20262 │  0.93675 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="e6bc" class="mg ld iq mt b gy of my l mz na">Epoch 8 ValidationPhase(): 100%|████████████████████████| Time: 0:00:16</span><span id="a6c3" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   8.0 │ 0.63952 │  0.81444 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="476b" class="mg ld iq mt b gy of my l mz na">Epoch 9 TrainingPhase(): 100%|██████████████████████████| Time: 0:03:28</span><span id="c845" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │   9.0 │ 0.11359 │  0.96763 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="8c5b" class="mg ld iq mt b gy of my l mz na">Epoch 9 ValidationPhase(): 100%|████████████████████████| Time: 0:00:15</span><span id="a3f2" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │   9.0 │ 0.59102 │  0.82806 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span><span id="192a" class="mg ld iq mt b gy of my l mz na">Epoch 10 TrainingPhase(): 100%|█████████████████████████| Time: 0:03:27</span><span id="6773" class="mg ld iq mt b gy of my l mz na">┌───────────────┬───────┬─────────┬──────────┐<br/>│         Phase │ Epoch │    Loss │ Accuracy │<br/>├───────────────┼───────┼─────────┼──────────┤<br/>│ TrainingPhase │  10.0 │ 0.07313 │  0.98377 │<br/>└───────────────┴───────┴─────────┴──────────┘</span><span id="a09d" class="mg ld iq mt b gy of my l mz na">Epoch 10 ValidationPhase(): 100%|███████████████████████| Time: 0:00:16</span><span id="e824" class="mg ld iq mt b gy of my l mz na">┌─────────────────┬───────┬─────────┬──────────┐<br/>│           Phase │ Epoch │    Loss │ Accuracy │<br/>├─────────────────┼───────┼─────────┼──────────┤<br/>│ ValidationPhase │  10.0 │ 0.59254 │  0.83267 │<br/>└─────────────────┴───────┴─────────┴──────────┘</span></pre><h1 id="a1bb" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">评估模型预测</h1><p id="7b93" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">正如我们所看到的，所有四张照片都被正确预测了。您也可以使用“plotprediction”方法查看预测。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="efa0" class="mg ld iq mt b gy mx my l mz na">plotpredictions(method, learner)</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/b39d1322ef672de3991446dafebd4137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ugNEFQWgXMTTP8o8.png"/></div></div></figure><h1 id="f209" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="e3a1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">Julia是数据科学的未来，如果你想成为未来的证明，你需要学习基础知识。随着fastai.jl的引入，对于Julia用户来说事情变得非常简单，因为他们只需编写几行代码来构建最先进的机器学习模型。fastai.jl构建在<a class="ae lb" href="https://github.com/FluxML/Flux.jl" rel="noopener ugc nofollow" target="_blank"> flux.jl </a>之上，后者完全构建在Julia之上，不像Python库集成了其他编程语言，如C和Java脚本。就连Julia用的CUDA都是用Julia语言搭建的，而不是C，这就给了Julia在处理和安全性上的优势。正如我在之前的文章<a class="ae lb" href="https://www.analyticsvidhya.com/blog/2021/07/julia-a-new-age-of-data-science/" rel="noopener ugc nofollow" target="_blank">Julia for Data Science:A New Age Data Science—Analytics vid hya</a>中所讨论的，Julia在许多方面都优于Python。</p><p id="8505" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个项目中，我们使用几行代码在ImageNet数据中构建了一个图像分类器模型，并且我们的模型表现超出了我们的预期。我们还发现了在图像分类中完成类似任务的不同方法，以及该库在探索和预测图像方面是多么强大。总的来说，我很喜欢使用这个库，其中有很多东西我没有在本文中讨论。</p><p id="e722" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你用这个库做实验，并展示已经准备好生产的令人惊奇的项目。</p><h2 id="189c" class="mg ld iq bd le mh mi dn li mj mk dp lm jy ml mm lq kc mn mo lu kg mp mq ly mr bi translated">源代码</h2><p id="6be2" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">源代码可在<a class="ae lb" href="https://github.com/kingabzpro/Image-Classification-FastAI.jl" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> GitHub </strong> </a>和<a class="ae lb" href="https://deepnote.com/project/Image-Classification-FastAIjl-fGgaWhdiTES-vgu7mOwP5g" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Deepnote </strong> </a>获得。</p><blockquote class="nz oa ob"><p id="1717" class="jn jo nt jp b jq jr js jt ju jv jw jx oc jz ka kb od kd ke kf oe kh ki kj kk ij bi translated">你可以关注我在LinkedIn和T21发表的关于数据科学和机器学习的惊人文章。</p></blockquote><h1 id="167d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">图像来源</h1><p id="2d8f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><strong class="jp ir">图片1</strong>-https://www . research gate . net/publication/314646236 _ Global-Attributes _ Assisted _ Outdoor _ Scene _ Geometric _ Labeling</p><p id="f7e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文中显示的媒体不归Analytics Vidhya所有，由作者自行决定使用。</p></div><div class="ab cl og oh hu oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="ij ik il im in"><p id="8b21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nt">原载于2021年9月9日</em><a class="ae lb" href="https://www.analyticsvidhya.com/blog/2021/09/simple-image-classification-using-fastai-jl" rel="noopener ugc nofollow" target="_blank"><em class="nt">【https://www.analyticsvidhya.com】</em></a><em class="nt">。</em></p></div></div>    
</body>
</html>