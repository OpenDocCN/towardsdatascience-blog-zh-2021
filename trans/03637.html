<html>
<head>
<title>How to Acquire and Analyze Data from analytics.usa.gov with Python and Tableau</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python和Tableau获取和分析analytics.usa.gov的数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/acquiring-and-analyzing-data-from-analytics-usa-gov-with-python-and-tableau-b61870ea065c?source=collection_archive---------25-----------------------#2021-03-24">https://towardsdatascience.com/acquiring-and-analyzing-data-from-analytics-usa-gov-with-python-and-tableau-b61870ea065c?source=collection_archive---------25-----------------------#2021-03-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="968c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">analytics.usa.gov免费提供的数据提供了人们如何在网上与美国政府互动的见解。本文向您展示了如何通过下载以及使用Python程序和API来访问站点的报告。</h2></div><h1 id="eb7d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">什么是analytics.usa.gov？</h1><p id="0e60" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">analytics.usa.gov提供了人们如何与美国政府在线互动的数据。美国总务管理局(GSA)的数字分析计划(DAP)运营该网站。它的数据提供了关于公众如何访问大约<a class="ae lw" href="https://analytics.usa.gov/data/live/second-level-domains.csv" rel="noopener ugc nofollow" target="_blank"> 400个行政部门域名</a>上的<a class="ae lw" href="https://analytics.usa.gov/data/live/sites.csv" rel="noopener ugc nofollow" target="_blank">5700个政府网站</a>的洞察。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi lx"><img src="../Images/9e3260db6000d10ef09a4c4cbf676658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNFYvMX3BhnDIiYph3_4fw.png"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">美国政府的analytics.usa.gov网站提供关于公众访问大约5，700个面向公众的政府网站的公开报告。作者捕获的图像。</p></figure><p id="7a37" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">这篇文章描述了公众可以从analytics.usa.gov下载的政府网站使用数据。它还展示了如何使用Python程序和API以JSON流的形式检索数据。最后，它展示了几个用于分析数据子集的Tableau公共仪表板。</p><h1 id="4510" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">可用数据集</h1><p id="f6e1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">用户可以下载下面列出的<a class="ae lw" href="https://analytics.usa.gov/data/" rel="noopener ugc nofollow" target="_blank">数据集，作为CSV或JSON文件</a>。他们还可以调用测试API来检索数据。本文稍后将演示如何从Python程序调用API。</p><h2 id="824f" class="ms kj it bd kk mt mu dn ko mv mw dp ks lj mx my ku ln mz na kw lr nb nc ky nd bi translated">参与机构的访问量和流量来源</h2><p id="3be9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">报告每日更新</strong></p><ul class=""><li id="44b2" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nj nk nl nm bi translated">过去30天内对所有域的访问</li><li id="c8f7" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">昨天下载量最高的</li><li id="0140" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">过去30天的主要流量来源</li><li id="9ab6" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">过去30天的热门退出页面</li></ul><p id="9617" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated"><strong class="lc iu">报告每5分钟更新一次</strong></p><ul class=""><li id="c3e6" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nj nk nl nm bi translated">人们在某个时间点访问的所有页面</li><li id="8a04" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">某一时间点的在线总人数</li></ul><h2 id="d67c" class="ms kj it bd kk mt mu dn ko mv mw dp ks lj mx my ku ln mz na kw lr nb nc ky nd bi translated">参与机构的访客人口统计</h2><p id="e88a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">报告每日更新</strong></p><ul class=""><li id="9ffd" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nj nk nl nm bi translated">语言</li><li id="f80a" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">台式机/手机/平板电脑</li><li id="f645" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">网络浏览器</li><li id="b5b2" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">Internet Explorer的版本</li><li id="ff55" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">操作系统</li><li id="9d8b" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">Windows版本</li><li id="510f" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">操作系统和浏览器(组合)</li><li id="91ec" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">Windows和浏览器(组合)</li><li id="fe26" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">Windows和IE(组合)</li><li id="4180" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">屏幕尺寸</li><li id="3376" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">设备型号</li></ul><p id="aff4" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated"><strong class="lc iu">报告每5分钟更新一次</strong></p><ul class=""><li id="db93" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nj nk nl nm bi translated">每个国家的游客</li><li id="35ac" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">每个城市的游客</li></ul><h1 id="af65" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">使用Python和API访问数据</h1><p id="1b30" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">DAP已经开发了<a class="ae lw" href="https://open.gsa.gov/api/dap/" rel="noopener ugc nofollow" target="_blank">analytics.usa.gov API</a>来以编程的方式检索JSON流形式的报告。在测试阶段，我发现这个API在一个简单的测试中运行良好。要使用API，请通过提交一个请求表单来注册一个密钥，如下所示，其中包含您的姓名和电子邮件地址。当您按下[注册]按钮时，表单将立即返回API密钥。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ns"><img src="../Images/86eb17c086bfe4ff077c50a5db4aede0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*leJVvfyCtRLQTv9J"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">程序员必须申请一个API密钥来使用analytics.usa.gov API检索报告。作者拍摄的图片。</p></figure><p id="8a2e" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">文件<a class="ae lw" href="https://open.gsa.gov/api/dap/#openapi-specification-file" rel="noopener ugc nofollow" target="_blank"> openapi.yaml </a>记录了api规范。YAML代表YAML不是标记语言。用代码编辑器或文本编辑器打开YAML文件。</p><h2 id="82e9" class="ms kj it bd kk mt mu dn ko mv mw dp ks lj mx my ku ln mz na kw lr nb nc ky nd bi translated">程序设计环境</h2><p id="76d3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我用这些免费工具在我的Windows 10 PC上编写并执行了这个程序:</p><ul class=""><li id="7515" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nj nk nl nm bi translated"><a class="ae lw" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">Python 3 . 9 . 2</a>——Python 3的任何版本都可能工作。</li><li id="6a35" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">Microsoft Visual Studio Communityfor Windows——我的大部分代码都是用Visual Studio编写的。但是任何支持Python的编辑器或集成开发环境(IDE)都应该可以工作。注意，Visual Studio的Macintosh版本不支持Python。</li></ul><h2 id="af7d" class="ms kj it bd kk mt mu dn ko mv mw dp ks lj mx my ku ln mz na kw lr nb nc ky nd bi translated">代码逻辑</h2><p id="8f29" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">下面的示例程序执行这些步骤来调用API，以JSON流的形式下载一个报告，并将其保存到一个文件中:</p><ol class=""><li id="65b1" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nt nk nl nm bi translated">调用c_analytics_usa_gov_api类的构造函数。指定所需的报告名称和JSON输出文件名。</li><li id="e657" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nt nk nl nm bi translated">打开JSON输出文件进行写入。</li><li id="97cb" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nt nk nl nm bi translated">调用API来检索报告。</li><li id="c0eb" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nt nk nl nm bi translated">将报告数据流写入JSON文件。</li><li id="ae20" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nt nk nl nm bi translated">关闭JSON文件。</li></ol><h2 id="a763" class="ms kj it bd kk mt mu dn ko mv mw dp ks lj mx my ku ln mz na kw lr nb nc ky nd bi translated">Python模块</h2><p id="3238" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">该程序使用<a class="ae lw" href="https://pypi.org/project/requests/" rel="noopener ugc nofollow" target="_blank">请求</a>和<a class="ae lw" href="https://docs.python.org/3/library/json.html" rel="noopener ugc nofollow" target="_blank"> json </a> Python模块。要安装这些模块，请从命令行调用这些命令，或者如果支持，在您的开发工具中调用这些命令:</p><ul class=""><li id="fc36" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nj nk nl nm bi translated">pip安装请求</li><li id="a9af" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">pip安装json</li></ul><h2 id="4096" class="ms kj it bd kk mt mu dn ko mv mw dp ks lj mx my ku ln mz na kw lr nb nc ky nd bi translated">控制器模块</h2><p id="ef93" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">控制器模块文件call_analytics_usa_gov_api.py是程序入口点。注意对c_analytics_usa_gov_api()的调用。</p><h2 id="54e0" class="ms kj it bd kk mt mu dn ko mv mw dp ks lj mx my ku ln mz na kw lr nb nc ky nd bi translated">c类_分析_美国_政府_应用编程接口</h2><p id="1d52" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">c_analytics_usa_gov_api类由控制器实例化。它执行上面代码逻辑部分中列出的步骤。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="14e9" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">数据使用理念</h1><p id="7e7e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">虽然analytics.usa.gov的可用数据可能对政府开发人员和部门管理人员最有帮助，但我想到了这两种用途:</p><ul class=""><li id="046f" class="ne nf it lc b ld mn lg mo lj ng ln nh lr ni lv nj nk nl nm bi translated">确定访问美国政府网站的最流行的操作系统和浏览器。由于美国政府如此庞大，这些数字可能表明它们在美国的一般使用情况。</li><li id="3b60" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">从事特定行业(例如会计或税务处理)的人员可能会发现昨天的<a class="ae lw" href="https://analytics.usa.gov/data/live/top-downloads-yesterday.csv" rel="noopener ugc nofollow" target="_blank">总下载量</a>报告有助于分析经常访问的政府服务。</li></ul><h1 id="62fb" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">数据分析仪表板示例</h1><p id="f174" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了演示analytics.usa.gov报告的使用，我用免费的<a class="ae lw" href="https://public.tableau.com/s/" rel="noopener ugc nofollow" target="_blank"> Tableau Public </a>商业智能和数据可视化工具开发了几个仪表板。仪表盘的数据来源是<a class="ae lw" href="https://analytics.usa.gov/data/live/os-browsers.csv" rel="noopener ugc nofollow" target="_blank"> OS &amp;浏览器(组合)CSV </a>和<a class="ae lw" href="https://analytics.usa.gov/data/live/devices.csv" rel="noopener ugc nofollow" target="_blank">桌面/移动/平板CSV </a>报表。因为CSV文件的结构是表格形式的，所以在Tableau中很容易处理。</p><p id="b679" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">我很惊讶地得知，如下图所示，iOS(iphone)是用于访问政府网站的头号操作系统。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nw"><img src="../Images/d39737b3e90fc76c6a4b0a9a9565d6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2J5SnuWSqKLynmqV"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">这个交互式的Tableau公共仪表板显示了通过操作系统和网络浏览器访问政府网站的情况。由作者创建的仪表板和捕获的图像。</p></figure><p id="84e1" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">下面的仪表盘显示，访问政府网站的浏览器和操作系统的顶级组合是Safari和iOS、Chrome和Windows、Chrome和Android。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nx"><img src="../Images/97cf0cf98c545792414104eeefd719b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0CsxJkea9AhBd_cOX1-ww.png"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">该Tableau公共仪表板显示了通过操作系统和网络浏览器组合访问政府网站的情况。由作者创建的仪表板和捕获的图像。</p></figure><p id="bd28" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">如下图所示，移动设备(智能手机)对政府网站的访问超过了台式电脑。这些信息表明，web开发人员可能希望确保他们设计的网站能够像在桌面上一样在移动设备上显示页面。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nw"><img src="../Images/bf45d36a745bc822cbbfe9a28ed875b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W-Vnga1yK6ORSZLc"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">这个交互式的Tableau公共仪表板显示了桌面电脑、移动设备(智能手机)和平板电脑对政府网站的访问。由作者创建的仪表板和捕获的图像。</p></figure><h1 id="b63b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">把所有的放在一起</h1><p id="3baa" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如你所知，analytics.usa.gov提供了关于公众访问大约5，700个美国政府网站的各种报告。大多数报告都可以CSV或JSON格式下载。</p><p id="4afd" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">analytics.usa.gov API<a class="ae lw" href="https://open.gsa.gov/api/dap/" rel="noopener ugc nofollow" target="_blank">使用Python或其他语言编写的程序能够轻松下载JSON报告。它还支持按机构过滤。</a></p><p id="b425" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">由于美国政府网站的流量如此之大，analytics.usa.gov上的报告可能会为web和应用程序开发人员提供一些见解。有了这些可以代表整个美国的数据，他们可以识别广泛使用的操作系统、浏览器和平台。也许您可以想到数据的其他用途，以促进理解和支持决策。</p><h1 id="02e8" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">关于作者</h1><p id="5595" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">Randy Runtsch是一名数据分析师、软件开发人员、作家、摄影师、自行车手和冒险家。他和妻子住在美国明尼苏达州东南部。</p><p id="e141" class="pw-post-body-paragraph la lb it lc b ld mn ju lf lg mo jx li lj mp ll lm ln mq lp lq lr mr lt lu lv im bi translated">关注Randy即将发表的关于公共数据集的文章，以推动数据分析见解和决策、编程、数据分析、摄影、自行车旅行等。你可以在shootproof.com和shutterstock.com<a class="ae lw" href="https://www.shutterstock.com/g/rruntsch" rel="noopener ugc nofollow" target="_blank">看到他的一些照片。</a></p></div></div>    
</body>
</html>