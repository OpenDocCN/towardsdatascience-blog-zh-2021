<html>
<head>
<title>3 Low-Code Python Libraries That You Should Know About</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你应该知道的3个低代码Python库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-amazing-low-code-machine-learning-libraries-that-you-should-know-about-a66895c0cc08?source=collection_archive---------14-----------------------#2021-06-18">https://towardsdatascience.com/3-amazing-low-code-machine-learning-libraries-that-you-should-know-about-a66895c0cc08?source=collection_archive---------14-----------------------#2021-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1d23" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">机器学习</h2><div class=""/><div class=""><h2 id="1bf7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">以下哪一个是机器学习的最佳低代码库？</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/5ec0b6f686b0279c560624c38b7b819b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZeD5CxEgQslF08jmUILuA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">卡罗琳娜·格拉博斯卡拍摄的图片。来源:<a class="ae lh" href="https://www.pexels.com/photo/student-doing-home-assignments-on-laptop-while-sitting-in-park-4497809/" rel="noopener ugc nofollow" target="_blank"> Pexels </a></p></figure><p id="8c0d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我在Medium上的一些最受欢迎的博客是关于图书馆的，我认为你应该试试。在这篇博客中，我将关注低代码机器学习库。事实是，许多数据科学家认为低代码库是捷径，应该避免。恐怕我不得不反对！我认为低代码库应该包含在我们的管道中，以帮助我们在不浪费时间的情况下做出重要的决定。</p><p id="be55" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，假设您刚开始一个项目，不知道要开始测试哪个模型。您可以从那些您认为效果不错的模型开始，在您运行了几个模型之后，您可以决定您想要超调哪些模型。不利的一面是，您只能使用自己熟悉的模型，而且设置所有这些模型会花费很多时间。另一种选择是使用低代码库，同时运行几十个模型，选择最好的一个，尝试复制它，然后调用它。哪个对你来说听起来更聪明？</p><p id="bc0b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">幸运的是，我们有许多用于机器学习的低代码库，今天我将介绍我最喜欢的三个。这个博客的目的是介绍一些库，这样你就可以自己尝试了。你可以在<a class="ae lh" href="https://github.com/ismael-araujo/Testing-Libraries/tree/main/Low%20Code%20Machine%20Learning%20Libraries" rel="noopener ugc nofollow" target="_blank">这个笔记本</a>里找到我用的代码。因此，我将不涉及微小的细节。让我们开始吧。</p><h1 id="b140" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">PyCaret</h1><p id="3c0f" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">最流行的用于机器学习的低代码库之一是PyCaret。Medium上有很多关于它的博客，包括我几周前写的一篇，你可以在这里找到它。以下是PyCaret <a class="ae lh" href="https://pycaret.org" rel="noopener ugc nofollow" target="_blank">网站</a>对此的评论:</p><blockquote class="nb nc nd"><p id="aac3" class="li lj ne lk b ll lm kd ln lo lp kg lq nf ls lt lu ng lw lx ly nh ma mb mc md im bi translated">PyCaret是一个用Python编写的开源、<strong class="lk jd">低代码</strong>机器学习库，允许您在自己选择的笔记本环境中，在几分钟内从准备数据到部署模型。</p></blockquote><p id="b797" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">顺便说一下，PyCaret是这个博客中最好的图书馆网站，也是我见过的最好的网站之一。他们有详细的教程展示这个库必须提供的所有功能。现在，让我们看看如何使用PyCaret。</p><p id="31e0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我们需要安装PyCaret。为此，您可以在终端中键入<code class="fe ni nj nk nl b">pip install pycaret[full]</code>。代码的完整部分包括所有的依赖项。为了安全起见，强烈建议您使用不同的环境。然后，我们需要一个数据集。PyCaret内置了多个库。我不会一一赘述，但如果你想了解更多，你可以查看<a class="ae lh" href="http://By the way, PyCaret has, by far, the best website among the libraries in this blog and one of the best that I have ever seen. They have detailed tutorials showing all the functions that this library has to provide. Now, let’s see how to use PyCaret." rel="noopener ugc nofollow" target="_blank">这个博客</a>。PyCaret非常酷的一点是它附带了QuickDA。这使得我们的数据集更容易理解。如果你想了解更多关于QuickDA的知识，你可以看看这个博客:<a class="ae lh" rel="noopener" target="_blank" href="/save-hours-of-work-doing-a-complete-eda-with-a-few-lines-of-code-45de2e60f257">用这个库</a>用几行代码做一个完整的EDA节省了几个小时的工作。</p><pre class="ks kt ku kv gt nm nl nn no aw np bi"><span id="1009" class="nq mf it nl b gy nr ns l nt nu"><strong class="nl jd"># Importing the dataset</strong><br/>from pycaret.datasets import get_data<br/>data = get_data('credit', profile=True)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/0c9016e4f3ea8ec8ec420cd9e5d4a9d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_qeCv8nYyoxiU2d7sCp8yw.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="e54a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们跳过所有的数据处理部分，直接进入建模。PyCaret的网站上有多个数据预处理的例子，我强烈推荐你<a class="ae lh" href="https://github.com/pycaret/pycaret/blob/master/tutorials/Binary%20Classification%20Tutorial%20Level%20Beginner%20-%20%20CLF101.ipynb" rel="noopener ugc nofollow" target="_blank">去看看</a>。然而，关于PyCaret最酷的部分是，我们将用一行代码运行许多模型并对每个模型进行评分。</p><p id="55be" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要运行所有的模型，需要输入<code class="fe ni nj nk nl b">best_model = compare_models()</code>，就这样。此功能将训练库中的所有模型，并使用交叉验证对它们进行评分，以进行指标验证。现在你可能会问:在这一行代码中，数据集在哪里？我不知道，但是如果你发现了，请让我知道。让我们看看结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/63ff0a60d36495d844307eb99dd58204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qqgFmzx61i6s53vgWiSWSg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="6715" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如我们在上面看到的，我们只用一行代码就运行了15个模型。里面甚至还有一个XGBoost。看起来没用，但我们还有十四个其他模型要分析。所有这些模型都是在3分23秒内完成的。好吧，如果我们关注这个项目的准确性得分，线性判别分析是最好的模型。通常，我会使用F1分数，但为了演示的目的，我会使用准确性。现在，我们能超调这个模型吗？答案是肯定的，而且就像运行所有这些模型一样简单。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/e8ef9b06afa9d76f476bcc4f3140aef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rtGg5WSUtL1k-0CApyN_9g.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="5760" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们走吧。精度从0.8206到0.8213。有些人会说这可以忽略不计，但是请记住，您只需输入20个字符就可以获得这种改进。当我们谈论PyCaret时，还有更多的内容需要讨论。这是一个介绍，我强烈建议你检查他们的网站，并尝试它。</p><h1 id="01aa" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">TPOT</h1><p id="e354" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">TPOT是一个自动化的机器学习库。它的目标是自动化机器学习项目中最繁琐的部分，如特征预处理、特征选择、模型选择等。这就像有人为你工作。下图展示了TPOT过程。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/c9e8a2267bf6221ca2d8e7db48408da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VQCLbZfwsabG3fayyDZGxA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">一个机器学习管道的例子。来源:<a class="ae lh" href="http://epistasislab.github.io/tpot/" rel="noopener ugc nofollow" target="_blank"> TPOT文件</a></p></figure><p id="507c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是其网站对此的评论:</p><blockquote class="nb nc nd"><p id="2a6f" class="li lj ne lk b ll lm kd ln lo lp kg lq nf ls lt lu ng lw lx ly nh ma mb mc md im bi translated">TPOT旨在成为一个助手，通过探索你可能从未考虑过的管道配置，给你提供如何解决特定机器学习问题的想法，然后将微调留给更受约束的参数调整技术，如网格搜索。</p></blockquote><p id="0575" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">与PyCaret不同，TPOT不是在几秒钟内跑完的。相反，需要几分钟(取决于您的数据集，可能需要几个小时)才能得到最佳结果。它们的默认设置是100代，种群大小为100。如果我在我的2019款英特尔MacBook Pro上运行，需要几个小时或几天。因此，出于演示目的，我将只运行一个生成。结果，我会得到一个管道。它可能不是最好的，但可能有很好的精度。要安装TPOT，你需要在你的终端键入<code class="fe ni nj nk nl b">pip install tpot</code>。记得使用不同的环境。</p><p id="bd3a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将使用我在PyCaret演示中使用的相同数据集。我们需要为TPOT训练一个测试集，就像使用scikit-learn一样。</p><pre class="ks kt ku kv gt nm nl nn no aw np bi"><span id="04f3" class="nq mf it nl b gy nr ns l nt nu"><strong class="nl jd"># Creating X and y variables</strong><br/>X = data.drop(columns=['default])<br/>y = data['default'] </span><span id="99eb" class="nq mf it nl b gy nz ns l nt nu"><strong class="nl jd"># Train test split</strong><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2, random_state = 42)</span></pre><p id="1f0e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">好了，现在我们有了我们需要的一切。现在让我们运行一些管道。首先，我们需要导入将要使用的包。由于这是一个分类项目，我们将导入TPOT的分类包。</p><pre class="ks kt ku kv gt nm nl nn no aw np bi"><span id="67a3" class="nq mf it nl b gy nr ns l nt nu"><strong class="nl jd">from</strong> tpot <strong class="nl jd">import</strong> TPOTClassifier</span></pre><p id="0743" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，我将设置管道优化器。有几十个参数可供选择。TPOT有很好的文档，你可以很容易地找到每个参数的解释。我用的是最基础的，但是强烈推荐你找更好的参数。</p><pre class="ks kt ku kv gt nm nl nn no aw np bi"><span id="4219" class="nq mf it nl b gy nr ns l nt nu"><strong class="nl jd"># Setting the model up</strong><br/>pipeline_optimizer = TPOTClassifier(generations=1, verbosity=2, scoring='f1', n_jobs=-1)</span><span id="4c4a" class="nq mf it nl b gy nz ns l nt nu"><strong class="nl jd"># Fitting the model <br/></strong>pipeline_optimizer.fit(X_train, y_train)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/a00aaa42edc477eaba53d6405d5d4653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gm-2zAwhjnFHA95B6Z-q-w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="5e55" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">等了33分钟后(！)，TPOT返回了上面的结果。我们可以看到，他们展示了模型和参数，如果你想复制它，就可以得到那个结果。如我们所见，使用树外分类器，最佳模型的精确度为0.8283。它非常接近我们用PyCaret得到的结果。PyCaret还运行了一个树外分类器。然而，TPOT能够超调参数并获得更好的结果。</p><h1 id="a24f" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">懒惰预测</h1><p id="ce87" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">LazyPredict是一个低代码库，用两行代码运行几十个模型。它不如更受欢迎的同类产品强大。然而，LazyPredict能够在几秒钟内返回基线模型！它并没有优化模型。但是，您可以使用scikit-learn轻松复制这些模型。</p><p id="5d28" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我已经写了一些关于LazyPredict的博客，我不打算再谈论这个神奇的库了。然而，这是一个关于机器学习的博客，我不能跳过LazyPredict。你可以在这里找到我的博客<a class="ae lh" rel="noopener" target="_blank" href="/how-to-run-30-machine-learning-models-with-2-lines-of-code-d0f94a537e52">，在这里</a>找到<a class="ae lh" rel="noopener" target="_blank" href="/how-to-run-40-regression-models-with-a-few-lines-of-code-5a24186de7d">，在这里</a>找到<a class="ae lh" rel="noopener" target="_blank" href="/3-awesome-python-libraries-that-you-should-know-about-e2485e6e1cbe">。</a></p><p id="9dbd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我演示一下它是如何工作的。你可以在你的终端中输入<code class="fe ni nj nk nl b">pip install lazypredict</code>来安装它，然后你就可以开始了。我将使用用于PyCaret和TPOT的相同数据集，以便我们可以比较结果。让我们首先导入将要使用的包。</p><pre class="ks kt ku kv gt nm nl nn no aw np bi"><span id="d252" class="nq mf it nl b gy nr ns l nt nu"><strong class="nl jd"># Importing the packages that we will use</strong><br/>import lazypredict<br/>from lazypredict.Supervised import LazyClassifier</span></pre><p id="2b79" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们运行30个模型！LazyPredict与scikit-learn非常相似。我们需要将模型添加到变量中，并使其适合我们的训练和测试数据集</p><pre class="ks kt ku kv gt nm nl nn no aw np bi"><span id="2622" class="nq mf it nl b gy nr ns l nt nu"><strong class="nl jd"># Running all the models</strong><br/>clf = LazyClassifier(verbose=0,ignore_warnings=True)<br/>models, predictions = clf.fit(X_train, X_test, y_train, y_test)<br/>models</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/67f9bccb3baaf53290c8a9421e23c6c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VU1bApDWt97JKliytl3Xog.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="29c1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们走吧！让我们仔细看看结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/bd0a187c79f0b9b7cf4a09ccf43f24e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTRSPlP_Pb9sldH3FvF07w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="73a4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们得到了一些奇妙的结果，它们与我们用PyCaret和TPOT得到的结果非常相似。看起来RandomForest和SVC比我们看到的PyCaret和TPOT等更复杂的库得到了更好的结果。还记得我说过我们可以使用scikit-learn轻松复制这些结果吗？为什么我们不这样做，这样我们就可以看到结果是否相似？让我们使用ExtraTree分类器模型来检查一下。</p><pre class="ks kt ku kv gt nm nl nn no aw np bi"><span id="b295" class="nq mf it nl b gy nr ns l nt nu"><strong class="nl jd"># Importing ExtraTreeClassifier</strong><br/>from sklearn.ensemble import ExtraTreesClassifier</span><span id="c05a" class="nq mf it nl b gy nz ns l nt nu"><strong class="nl jd"># Fitting and predicting model</strong><br/>clf = ExtraTreesClassifier(n_estimators=100, random_state=0)<br/>clf.fit(X_train, y_train)<br/>y_pred = clf.predict(X_test)</span><span id="d08a" class="nq mf it nl b gy nz ns l nt nu"><strong class="nl jd"># Checking score</strong><br/>from sklearn.metrics import accuracy_score<br/>accuracy_score(y_test, y_pred)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/1de065f2fefc508969b5c9e41b7e23a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7O23JY7r88_UsqC68SVww.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="209a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">LazyPredict返回0.82分，scikit-learn返回0.817分。那是非常接近的。我对LazyPredict的出色表现感到惊讶。你明白我为什么要把LazyPredict写进这个博客吗？</p><h1 id="3194" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">结论</h1><p id="99bc" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">PyCaret、TPOT和LazyPredict是每个数据科学家都应该知道的三个优秀的库。虽然它们不能取代数据科学家的工作，但它们可以节省我们的工作时间。我不会使用他们的结果作为最终模型，但我总是在我的管道中包括至少一个。它们都易于使用，并且包含完整的文档。</p><p id="14bf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我强烈建议你自己尝试一下，发现我在这篇博客中没有提到的特性。如果你了解到任何很酷的功能，请告诉我。你知道我应该在我的下一个模型中包括任何其他机器学习库吗？</p><p id="1ac4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">你可能也会喜欢… </strong></p><p id="bd79" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/5-python-libraries-that-you-dont-know-but-you-should-fd6f810773a7"> <em class="ne"> 5个你不知道但应该知道的Python库</em> </a> <a class="ae lh" rel="noopener" target="_blank" href="/4-cool-python-libraries-that-you-should-know-about-bea9619e481c"> <em class="ne"> <br/> 4个你应该知道的很酷的Python库</em></a><em class="ne"><br/></em><a class="ae lh" rel="noopener" target="_blank" href="/3-awesome-python-libraries-that-you-should-know-about-e2485e6e1cbe"><em class="ne">3个你应该知道的很牛逼的Python库</em> </a></p></div></div>    
</body>
</html>