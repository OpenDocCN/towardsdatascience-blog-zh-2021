<html>
<head>
<title>Yolov5 Object Detection on NVIDIA Jetson Nano</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NVIDIA Jetson Nano上的Yolov5对象检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/yolov5-object-detection-on-nvidia-jetson-nano-148cfa21a024?source=collection_archive---------4-----------------------#2021-07-31">https://towardsdatascience.com/yolov5-object-detection-on-nvidia-jetson-nano-148cfa21a024?source=collection_archive---------4-----------------------#2021-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7b24" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Jetson nano开发套件进行IMX477 CSI摄像机配置和Yolov5物体检测的分步指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8bcba9cc54c7d41e302cba082bd1d6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DrGdAT3-Iu9t129ZC1zFzg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7eb5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本文介绍了在NVIDIA Jetson Nano上使用Yolov5和openCV进行CSI摄像机安装、软件和硬件设置以及对象检测的一个简单易行的过程。该项目使用<a class="ae lr" href="https://github.com/JetsonHacksNano/CSI-Camera" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> CSI-Camera </strong> </a>创建流水线并捕获帧，使用<a class="ae lr" href="https://github.com/ultralytics/yolov5" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> Yolov5 </strong> </a>检测对象，在Jetson开发套件上实现了完整的可执行代码。查看视频说明的<a class="ae lr" href="https://www.youtube.com/watch?v=-A_CDLtQig4&amp;list=PLZIi3Od9VUwW49q6T1VjShktoOgrDi3O4&amp;index=3" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir">CodePlay jetson nano YouTube播放列表</strong> </a>和<a class="ae lr" href="https://github.com/amirhosseinh77/JetsonYolo" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir">jetson yolo Github</strong></a>。</p><h1 id="0a7d" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">要求</h1><p id="4d8f" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">杰特森纳米最常用的相机之一是树莓Pi相机模块V2，但如果你需要更高的分辨率呢？最近，我试图在一个项目中使用Waveshare IMX477 CSI摄像机，但在将其连接到电路板时遇到了问题。最后，在尝试了几种不同的方法后，我想出了一个简单的流程，并决定与他人分享。本文由几个部分组成，包括硬件、驱动程序和python库安装，最后是Yolov5。这些步骤对于使用Jetson Nano板上的摄像头进行物体检测都是必不可少的。</p><h2 id="d24e" class="mq lu iq bd lv mr ms dn lz mt mu dp md le mv mw mf li mx my mh lm mz na mj nb bi translated">摄像机设置</h2><p id="860c" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">将摄像机安装在载板上的MIPI-CSI摄像机连接器中。拉起摄像头端口的塑料边。推入摄像头色带，确保摄像头色带上的针脚朝向Jetson Nano模块。向下推塑料接头。您可以使用<a class="ae lr" href="https://www.arducam.com/docs/camera-for-jetson-nano/native-jetson-cameras-imx219-imx477/imx477/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> Arducam摄像机设置</strong> </a> <strong class="kx ir">指南</strong>了解更多信息。</p><div class="kg kh ki kj gt ab cb"><figure class="nc kk nd ne nf ng nh paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/13bd40930a7f10485da695508efbc9b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*dbHObEW3HuK7jqqcXqt1Xw.jpeg"/></div></figure><figure class="nc kk nd ne nf ng nh paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1fe12ec800976314256e391314a9e5ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*LagVGWbzlqA2-skbxNwDDQ.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk ni di nj nk translated">作者图片</p></figure></div><h2 id="dfda" class="mq lu iq bd lv mr ms dn lz mt mu dp md le mv mw mf li mx my mh lm mz na mj nb bi translated">相机驱动程序</h2><p id="2bfc" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">默认情况下，NVIDIA JetPack支持几种不同传感器的摄像头，其中最著名的是Raspberry Pi camera v2。但是如果你使用的是另一种类型的相机，你需要安装一个传感器驱动程序。在这个项目中使用了一个带有imx 477–160传感器的12.3 MP摄像头，需要一个<strong class="kx ir">附加驱动器</strong>来连接。Arducam为带有IMX477传感器的摄像机提供了一个易于绝缘的<a class="ae lr" href="https://www.arducam.com/docs/camera-for-jetson-nano/native-jetson-cameras-imx219-imx477/imx477-how-to-install-the-driver/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> IMX477驱动器</strong> </a>。(确保访问网站并使用最新的命令。)</p><p id="657c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下载自动安装脚本:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5dc4" class="mq lu iq nm b gy nq nr l ns nt"><strong class="nm ir">cd ~</strong></span><span id="255e" class="mq lu iq nm b gy nu nr l ns nt"><strong class="nm ir">wget </strong><a class="ae lr" href="https://github.com/ArduCAM/MIPI_Camera/releases/download/v0.0.3/install_full.sh" rel="noopener ugc nofollow" target="_blank"><strong class="nm ir">https://github.com/ArduCAM/MIPI_Camera/releases/download/v0.0.3/install_full.sh</strong></a></span></pre><p id="026c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">安装驱动程序:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="a7c3" class="mq lu iq nm b gy nq nr l ns nt"><strong class="nm ir">chmod +x install_full.sh</strong></span><span id="ab25" class="mq lu iq nm b gy nu nr l ns nt"><strong class="nm ir">./install_full.sh -m imx477</strong></span></pre><p id="d2c1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，输入y重新启动板。</p><p id="ad96" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用以下命令检查摄像机是否被正确识别。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4d8e" class="mq lu iq nm b gy nq nr l ns nt"><strong class="nm ir">ls /dev/video0</strong></span></pre><p id="5dd7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以使用<a class="ae lr" href="https://github.com/JetsonHacksNano/CSI-Camera/blob/master/simple_camera.py" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir">JetsonHacks</strong></a><strong class="kx ir"/>python代码通过<strong class="kx ir"> OpenCV </strong>从相机中捕捉帧。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/83847d61c21fff17d44c3b808a5ac2dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAm-MNqk7YiyNwMGyRRKNw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="fd78" class="mq lu iq bd lv mr ms dn lz mt mu dp md le mv mw mf li mx my mh lm mz na mj nb bi translated">火炬&amp;火炬视觉</h2><p id="53bb" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">Yolov5模型是在Pytorch框架中实现的。PyTorch是一个基于Torch库的开源机器学习库，用于计算机视觉和自然语言处理应用。这里有一个在Jetson开发套件上安装PyTorch的完整指南。</p><h1 id="ab87" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">推理</h1><p id="e4e2" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated"><strong class="kx ir">在Jetson nano上克隆</strong> JetsonYolo存储库。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="e9e8" class="mq lu iq nm b gy nq nr l ns nt"><strong class="nm ir">git clone </strong><a class="ae lr" href="https://github.com/amirhosseinh77/JetsonYolo.git" rel="noopener ugc nofollow" target="_blank"><strong class="nm ir">https://github.com/amirhosseinh77/JetsonYolo.git</strong></a></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/5fb495cb22e9adefa84e06a35c4e8368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBDoqUTCYG7qlf6Dg1qL3Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="ad50" class="mq lu iq bd lv mr ms dn lz mt mu dp md le mv mw mf li mx my mh lm mz na mj nb bi translated">下载Yolov5型号</h2><p id="c2ee" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">根据模型尺寸、所需速度和精度选择所需的模型。您可以在<strong class="kx ir">资产</strong>部分的 中找到可用的型号<a class="ae lr" href="https://github.com/ultralytics/yolov5/releases" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">。使用下面的命令下载模型，并将其移动到<strong class="kx ir"> weights </strong>文件夹。</strong></a></p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5abd" class="mq lu iq nm b gy nq nr l ns nt"><strong class="nm ir">cd weights</strong></span><span id="eb0b" class="mq lu iq nm b gy nu nr l ns nt"><strong class="nm ir">wget </strong><a class="ae lr" href="https://github.com/ultralytics/yolov5/releases/download/v5.0/yolov5s.pt" rel="noopener ugc nofollow" target="_blank"><strong class="nm ir">https://github.com/ultralytics/yolov5/releases/download/v5.0/yolov5s.pt</strong></a></span></pre><p id="b567" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">运行<code class="fe nw nx ny nm b"><strong class="kx ir">JetsonYolo.py</strong></code>用摄像机检测物体。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="9dc3" class="mq lu iq nm b gy nq nr l ns nt"><strong class="nm ir">python3 JetsonYolo.py</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/ffe4f95803200e9c2dbcc48fd6e4e744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mbsFudGDqVxV7s4m.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="7d3f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="35cc" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">本文重点介绍如何使用IMX477摄像头捕捉帧并执行对象检测。设置这种类型的摄像机需要额外的驱动程序安装步骤，Arducam已经为Jetson Linux Driver (L4T)提供了一个驱动程序。在安装了必要的驱动程序和Python库之后，Yolov5在Jetson Nano上实现为JetsonYolo，并以每秒12帧的速度获得了令人满意的结果。</p></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><blockquote class="og oh oi"><p id="a761" class="kv kw ls kx b ky kz jr la lb lc ju ld oj lf lg lh ok lj lk ll ol ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="iq">引文</em> </strong></p></blockquote><pre class="kg kh ki kj gt nl nm om bn on oo bi"><span id="21dd" class="op lu iq nm b be oq or l os nt">@inproceedings{omidi2021embedded,<br/>  title={An Embedded Deep Learning-based Package for Traffic Law Enforcement},<br/>  author={Omidi, Abbas and Heydarian, Amirhossein and Mohammadshahi, Aida and Beirami, Behnam Asghari and Haddadi, Farzan},<br/>  booktitle={Proceedings of the IEEE/CVF International Conference on Computer Vision},<br/>  pages={262--271},<br/>  year={2021}<br/>}</span></pre></div></div>    
</body>
</html>