<html>
<head>
<title>A Beginner’s Guide to Machine Learning in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python机器学习初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-beginners-guide-to-machine-learning-in-python-750affc4b76d?source=collection_archive---------7-----------------------#2021-04-27">https://towardsdatascience.com/a-beginners-guide-to-machine-learning-in-python-750affc4b76d?source=collection_archive---------7-----------------------#2021-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c917" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">任何数据科学项目的入门代码、说明和学习资源</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2eebd5b0d23593c988c4fc08cde7b9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3B7uy7EftcBIe5vzvsSWw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">米利安·耶西耶在<a class="ae ky" href="https://unsplash.com/s/photos/data-science?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="1474" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">为什么要跟着机器学习教程一起编码？</h1><p id="5b3b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有两种方法可以用来研究任何主题——自上而下和自下而上。</p><p id="487b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当你在学校学习像数学和科学这样的科目时，你会被教授自下而上的方法。</p><p id="2b48" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，你被教授了题目的基础，然后通过材料逐渐进步。</p><p id="08d8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，当学习像数据科学和机器学习这样的学科时，自上而下的方法往往更容易掌握——尤其是如果你没有很强的数学背景。</p><h2 id="d104" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">使用自顶向下的方法，您可以首先通过实现机器学习模型来弄脏您的手。</h2><p id="6406" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这很容易做到，因为Python和r等语言中有很多可用的包。</p><p id="b7ef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">机器学习的民主化</strong>让你可以创建端到端的机器学习模型，而无需了解它们如何工作以及算法背后的数学。</p><p id="353c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当然，你仍然需要了解这些算法是如何工作的，但这可以在以后(一旦你学会了如何在实践中建立这些模型)。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="6f51" class="kz la it bd lb lc nl le lf lg nm li lj jz nn ka ll kc no kd ln kf np kg lp lq bi translated">介绍</h1><p id="fa1b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这篇文章中，我将带你通过Kaggle上的Pima Indian糖尿病数据集完成一个端到端的机器学习项目。</p><p id="fee6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我将为<strong class="lt iu">数据预处理</strong>、<strong class="lt iu">分析</strong>、<strong class="lt iu">模型训练</strong>和<strong class="lt iu">评估</strong>提供代码。你可以用它作为你将来从事的任何机器学习项目的起始代码。</p><p id="a5f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我还将为我使用的每种技术和算法提供额外的学习资源，这样您就可以阅读它们并更好地理解它们的工作原理。</p><p id="e6ab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="nq">注:</em> </strong></p><p id="11ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="nq">我已经做过一个关于同一数据集的数据分析教程，这个你可以在这里</em> </strong>  <strong class="lt iu"> <em class="nq">查阅</em> </strong> <a class="ae ky" rel="noopener" target="_blank" href="/a-beginners-guide-to-data-analysis-in-python-188706df5447"> <strong class="lt iu"> <em class="nq">。因此，在本文中，我不会过多地讨论数据分析和可视化的细节。相反，我将把更多的注意力放在构建机器学习算法上。</em> </strong></a></p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="8dac" class="kz la it bd lb lc nl le lf lg nm li lj jz nn ka ll kc no kd ln kf np kg lp lq bi translated">先决条件</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/6c9a72356d0c9ab23a84be6097dcaa7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qsahpt2kqQ6e8iM5lqfZNg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历克斯·丘马克在<a class="ae ky" href="https://unsplash.com/s/photos/python?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="40ae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要继续学习本教程，您需要在计算机上安装Python IDE。</p><p id="2de5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我建议使用Jupyter笔记本，因为我就是用它来创建本教程的，而且Jupyter允许您在代码所在的同一文档中显示可视化效果。</p><p id="b3d7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你还需要预装以下软件包——<a class="ae ky" href="https://pypi.org/project/pandas/" rel="noopener ugc nofollow" target="_blank">熊猫</a>、<a class="ae ky" href="https://pypi.org/project/numpy/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>、<a class="ae ky" href="https://pypi.org/project/matplotlib/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>、<a class="ae ky" href="https://pypi.org/project/seaborn/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>和<a class="ae ky" href="https://pypi.org/project/scikit-learn/" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn </a>。按照文档中的说明安装这些库。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="04c4" class="kz la it bd lb lc nl le lf lg nm li lj jz nn ka ll kc no kd ln kf np kg lp lq bi translated">步骤1:读取数据</h1><p id="e030" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database" rel="noopener ugc nofollow" target="_blank">这个</a>是我们将在整个教程中使用的数据集。下载并准备好环境后，运行以下代码行:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="71ee" class="ms la it nt b gy nx ny l nz oa"># imports</span><span id="7be8" class="ms la it nt b gy ob ny l nz oa">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="d043" class="ms la it nt b gy ob ny l nz oa"># Reading the data-frame</span><span id="e705" class="ms la it nt b gy ob ny l nz oa">df = pd.read_csv('pima.csv')</span></pre><h1 id="fc2b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤2:探索性数据分析</h1><p id="6c02" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">读取数据框后，运行以下代码行查看不同的变量:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="38a6" class="ms la it nt b gy nx ny l nz oa">df.head()</span></pre><p id="b69a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您将看到以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/f5076298b2ca0a71ad80676ae2f2becd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9nGa0GqbonoHYKZc.png"/></div></div></figure><p id="19e4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据帧中的不同变量包括:</p><ul class=""><li id="0f7a" class="od oe it lt b lu mn lx mo ma of me og mi oh mm oi oj ok ol bi translated">怀孕——怀孕次数</li><li id="4f09" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">葡萄糖——口服葡萄糖耐量试验中2小时的血浆葡萄糖浓度</li><li id="4e3e" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">血压——舒张压</li><li id="17b5" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">皮肤厚度——三头肌皮褶厚度</li><li id="e516" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">胰岛素— 2小时血清胰岛素</li><li id="2564" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">身体质量指数——身体质量指数</li><li id="f99a" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">糖尿病谱系功能——糖尿病谱系功能</li><li id="438a" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">年龄-年龄</li><li id="8ef2" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">结果——患者是否患有糖尿病</li></ul><p id="adc9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">结果变量是我们的<strong class="lt iu">目标</strong>，所有其他变量都是预测变量。我们需要使用剩余的变量来预测机器学习模型的结果。</p><p id="f224" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要查看一些描述性统计数据，请运行以下代码行:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ea3d" class="ms la it nt b gy nx ny l nz oa">df.describe()</span></pre><p id="2b15" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以看到一些简单的数据集统计数据:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/97c6103aeb448bcc89752823ce50e0bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*784Z57ViKjG1Fps3.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="71e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们可以运行几行代码来查看数据集中所有变量之间的关系:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ac4e" class="ms la it nt b gy nx ny l nz oa"># pairplot:<br/>sns.pairplot(df,hue='Outcome')</span></pre><p id="9bac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">渲染出以下情节:<br/><strong class="lt iu"><em class="nq">*因为太大了</em> </strong>我没有包括整个图像</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/575bdea7d19d8366453e960bf91a81cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bqkODEKgSKfXQjI-.png"/></div></div></figure><p id="c7fd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">结对图是非常有用的可视化工具。它允许您一次查看数据集中所有变量之间的关系。</p><p id="1bb2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">乍一看，您将能够注意到突出的变量之间的强关系。然后，您可以继续检查这些关系，并移除可能导致模型中出现多重共线性的高度相关的属性。</p><h1 id="8e9b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第三步:数据预处理</h1><p id="901c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在，我们可以检查数据框中缺失的值:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="5c38" class="ms la it nt b gy nx ny l nz oa">print(df.isnull().values.any())</span></pre><p id="90ad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上面的行应该返回<strong class="lt iu"> False。</strong>数据框中没有缺失值。</p><p id="36fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们将标准化我们的变量，使它们都在相同的范围内。你可以在这里阅读更多关于标准化为何重要的信息<a class="ae ky" href="https://towardsai.net/p/data-science/how-when-and-why-should-you-normalize-standardize-rescale-your-data-3f083def38ff#:~:text=Similarly%2C%20the%20goal%20of%20normalization,dataset%20does%20not%20require%20normalization.&amp;text=So%20we%20normalize%20the%20data,variables%20to%20the%20same%20range." rel="noopener ugc nofollow" target="_blank">。如果你喜欢看而不是读，我建议看一看</a><a class="ae ky" href="https://www.youtube.com/watch?v=mnKm3YP56PY" rel="noopener ugc nofollow" target="_blank">克里斯·纳伊克关于特征缩放重要性的解释</a>。</p><p id="0537" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将做一些叫做Z分数标准化的事情。这将采用我们所有的变量，并将其转换为服从均值为0、标准差为1的正态分布。</p><p id="10f1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">运行以下代码行:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="f37e" class="ms la it nt b gy nx ny l nz oa">X = df.drop('Outcome',axis=1)<br/>y = df['Outcome']</span><span id="ab43" class="ms la it nt b gy ob ny l nz oa"># standardization<br/>X = (X-X.mean())/X.std()</span></pre><p id="1adc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">完成后，再次检查数据帧的头部:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="093d" class="ms la it nt b gy nx ny l nz oa">X.head()</span></pre><p id="2471" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">转换后的数据框将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/9c4760006b7e876312c39e0e121715d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3W-Wx3lZlTEcCmf7.png"/></div></div></figure><p id="67aa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们已经完成了数据预处理，我们可以开始构建机器学习模型了。</p><h1 id="b788" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第四步:机器学习模型</h1><p id="090a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，我们需要将数据帧分成训练集和测试集。我们将在一组数据上训练该模型，然后在它从未见过的数据上评估它的性能。</p><p id="aa3c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有许多方法来执行模型验证，其中最流行的是K-fold交叉验证。你可以在这里阅读不同的交叉验证方法<a class="ae ky" href="https://www.youtube.com/watch?v=7062skdX05Y" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="254b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，我将在本文中介绍最简单的验证方法——将数据集分成两部分，保留一组数据进行测试。</p><p id="854b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是实现这一点的一些代码:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="7148" class="ms la it nt b gy nx ny l nz oa">from sklearn.model_selection import train_test_split</span><span id="ca0a" class="ms la it nt b gy ob ny l nz oa">X_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.25)</span></pre><p id="c7b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这样做之后，我们将获得单独的数据集来训练和测试我们的模型。我们现在可以开始创建模型了。</p><h2 id="313a" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">逻辑回归分类器</h2><p id="53d1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将建立的第一个模型是逻辑回归分类器。该模型将逻辑函数拟合到数据上，以识别每个数据点所属的类别。</p><p id="4d41" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你学过线性回归，你应该知道逻辑回归使用相同的线性函数(y=a+bX)来分离每个类的值。然而，它稍微修改了线性函数，使得值不会低于0或高于1。</p><p id="556e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，逻辑回归分类器输出概率。默认情况下，模型预测是概率最高的类。</p><p id="f3bb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以通过根据自己的需要定制逻辑回归模型的阈值来更改这一点。默认情况下，该值为0.5。在本教程中，我们将使用默认阈值0.5。</p><p id="13d8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想了解更多关于逻辑回归的知识，我建议你看一下<a class="ae ky" href="https://www.youtube.com/watch?v=L_xBe7MbPwk" rel="noopener ugc nofollow" target="_blank">这个</a>视频。</p><p id="b8cc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以运行以下代码行来将逻辑回归模型拟合到定型数据中:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="72bf" class="ms la it nt b gy nx ny l nz oa">from sklearn.linear_model import LogisticRegression</span><span id="8905" class="ms la it nt b gy ob ny l nz oa">lr = LogisticRegression()<br/>lr.fit(X_train,y_train)</span></pre><p id="fda8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们可以根据测试数据做出预测:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="a840" class="ms la it nt b gy nx ny l nz oa">lr_preds = lr.predict(X_test)</span></pre><p id="6175" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们完事了。现在，我们可以在下一个模型上拟合数据。</p><h2 id="1431" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">决策树分类器</h2><p id="b3a1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">决策树分类器是一种基于树的模型。它将获取数据集中的所有变量，并对它们进行分割。</p><p id="42d0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在每次分割时，它要么将数据点分配给一个类，要么在不同的变量上进行分割。此过程会一直持续，直到不再有要分割的要素，或者达到停止标准。</p><p id="d422" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">决策树分类器通过选择在每次分割时损失最小的特征来决定分割什么。基尼指数和熵是决策树分类器中常用的两种损失函数。</p><p id="409d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以观看<a class="ae ky" href="https://www.youtube.com/watch?v=1IQOtJ4NI_0" rel="noopener ugc nofollow" target="_blank">这段</a>视频，更好地了解决策树是如何工作的。</p><p id="df97" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要使决策树分类器适合数据，请运行以下代码行:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="d6fb" class="ms la it nt b gy nx ny l nz oa">from sklearn.tree import DecisionTreeClassifier<br/>dt = DecisionTreeClassifier()</span><span id="5948" class="ms la it nt b gy ob ny l nz oa">dt.fit(X_train,y_train)</span></pre><p id="1a7e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们使用这个模型对测试数据进行预测:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="25c0" class="ms la it nt b gy nx ny l nz oa">dt_preds = dt.predict(X_test)</span></pre><p id="5342" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">搞定了。让我们继续下一个模型。</p><h2 id="9fb7" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">随机森林分类器</h2><p id="eeb3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">随机森林模型使用多个决策树来进行预测。在实践中，随机森林通常优于决策树和线性分类器。</p><p id="e67a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">它使用了一种叫做<strong class="lt iu"> bagging的技术，</strong>代表引导聚合。训练数据集被随机采样多次，决策树被拟合到每个数据样本上。</p><p id="080e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在每个节点上，只考虑要素的子集进行划分，以确保模型中每个变量的公平表示。</p><p id="ac03" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在像这样的分类问题中，输出是所有决策树的多数类预测。</p><p id="309c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要了解更多关于随机森林算法的工作原理，你可以阅读这篇文章。如果你视觉学得更好，你可以看<a class="ae ky" href="https://www.youtube.com/watch?v=nxFG5xdpDto" rel="noopener ugc nofollow" target="_blank">这个</a>视频。</p><p id="2755" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">运行以下代码行，以使随机森林分类器适合定型集:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="f756" class="ms la it nt b gy nx ny l nz oa">from sklearn.ensemble import RandomForestClassifier<br/>rf = RandomForestClassifier()</span><span id="a462" class="ms la it nt b gy ob ny l nz oa">rf.fit(X_train,y_train)</span></pre><p id="ae32" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，运行下面的代码对测试集进行预测:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="6145" class="ms la it nt b gy nx ny l nz oa">rf_preds = rf.predict(X_test)</span></pre><p id="c31f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">搞定了。让我们继续讨论我们将在本教程中构建的最终模型。</p><h2 id="a581" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">XGBoost分类器</h2><p id="ba25" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">XGBoost分类器是基于树的模型的另一种扩展，它使用一种称为boosting的技术来提高决策树的性能。</p><p id="1148" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">梯度推进算法的工作方式非常直观。首先实现一个基础学习器来进行初始预测。计算初始模型的残差，并添加预测初始模型残差的第二决策树。</p><p id="7f35" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">就像这样，增加一个决策树链，形成一个序列模型，使整体残差最小化。</p><p id="bb72" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要了解更多关于梯度推进，你可以观看<a class="ae ky" href="https://www.youtube.com/watch?v=Nol1hVtLOSg" rel="noopener ugc nofollow" target="_blank">这个</a>视频。</p><p id="5b23" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">梯度推进是最流行的监督学习技术之一，它经常被数据科学家用于Kaggle竞赛。实际上，它们的表现往往比决策树好得多。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="6318" class="ms la it nt b gy nx ny l nz oa">from xgboost import XGBClassifier<br/>xgb = XGBClassifier()</span><span id="0274" class="ms la it nt b gy ob ny l nz oa">xgb.fit(X_train,y_train)</span></pre><p id="b09d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，运行这些代码行来对测试集进行预测:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="08ba" class="ms la it nt b gy nx ny l nz oa">xgb_preds = xgb.predict(X_test)</span></pre><p id="3874" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">就是这样！我们已经完成了模型的训练并保存了它们的预测。现在让我们来看看模型性能。</p><h1 id="74eb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第五步:评估</h1><p id="c21c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将看看用于评估模型性能的最简单的度量标准——准确性。</p><p id="fbc9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下代码行将创建一个条形图，显示所有四个模型的准确性得分:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="e951" class="ms la it nt b gy nx ny l nz oa">model = np.array(['Logistic Regression','Decision Tree','Random Forest','Gradient Boosting'])</span><span id="1cc9" class="ms la it nt b gy ob ny l nz oa">from sklearn.metrics import accuracy_score</span><span id="eb95" class="ms la it nt b gy ob ny l nz oa">scores = np.array([accuracy_score(lr_preds,y_test),accuracy_score(dt_preds,y_test),accuracy_score(rf_preds,y_test),accuracy_score(xgb_preds,y_test)])</span><span id="5dd1" class="ms la it nt b gy ob ny l nz oa">df = {'model': model, 'scores': scores}<br/>sns.barplot(x='model',y='scores',data=df)</span></pre><p id="6504" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些代码行将呈现一个如下所示的图表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/4ef90000a91f46766d1a3b1f0c3e1832.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/0*0HEiKkGGbJW8_O83.png"/></div></figure><p id="212b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">每个模型的精度如下:</p><ul class=""><li id="d77b" class="od oe it lt b lu mn lx mo ma of me og mi oh mm oi oj ok ol bi translated">逻辑回归— 0.73</li><li id="bec3" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">决策树分类器— 0.77</li><li id="50c4" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">随机森林分类器— 0.81</li><li id="37bb" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">XGBoost分类器— 0.79</li></ul><p id="ee10" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">看起来随机森林分类器已经胜过了其他模型，XGBoost紧随其后。</p><p id="100a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请记住，当您运行相同的代码行时，您的结果可能与我的略有不同，因为每次您进行训练测试分割时，数据将被不同地分区。</p><p id="bb4f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，您还需要记住其他重要的分类指标，以确保您的模型性能良好，例如精度和召回率。</p><p id="a80d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您正在处理疾病分类等问题，其中一类数据在您的数据集中表示不足，您可能会遇到模型仅预测多数类的问题。</p><p id="29c0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">高验证准确性并不是表现良好的模型的唯一指标。</p><p id="55a1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想了解更多关于其他分类指标的信息，你可以观看<a class="ae ky" href="https://www.youtube.com/watch?v=aWAnNHXIKww" rel="noopener ugc nofollow" target="_blank">这个</a>视频。要了解更多关于解决分类问题中不平衡数据集的问题，你可以跟随<a class="ae ky" href="https://www.youtube.com/watch?v=YMPMZmlH5Bo" rel="noopener ugc nofollow" target="_blank">这篇</a>教程。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="1a3a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文到此为止！我希望你能从这篇教程中学到一些东西。</p><p id="4362" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请务必看看我在整篇文章中链接的其他资源。</p><p id="8724" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，您已经对机器学习建模的工作原理有了很高的理解，这些资源将帮助您对您实现的所有内容有一个很好的理解。</p><p id="09b4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">它们将有助于巩固您对不同数据预处理技术、不同算法如何工作以及可用于评估模型性能的不同指标的理解。</p></div></div>    
</body>
</html>