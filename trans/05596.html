<html>
<head>
<title>A Comprehensive Guide to a Classification Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类项目综合指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-comprehensive-guide-to-a-classification-project-data-cleaning-and-exploration-88edd5617ce2?source=collection_archive---------18-----------------------#2021-05-18">https://towardsdatascience.com/a-comprehensive-guide-to-a-classification-project-data-cleaning-and-exploration-88edd5617ce2?source=collection_archive---------18-----------------------#2021-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2684" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">刚接触数据科学，想从事您的第一个项目？这里有一个关于你的第一个分类问题的全面的项目演练。</h2></div><h1 id="79a6" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated"><strong class="ak">第一部分:数据清理和探索</strong></h1><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/6a5922dff87af783db1d136d666a5ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kZ90WlNu74wWe0TX"/></div></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">由<a class="ae ln" href="https://unsplash.com/@srkraakmo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">斯蒂芬·克拉克莫</a>在<a class="ae ln" href="https://unsplash.com/s/photos/magnifying-glass?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="51fe" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">简介</strong></p><p id="e929" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">当我开始我的数据科学之旅时，我记得获得一个资源是多么困难，这个资源提供了一个全面的数据探索指南，将它与所使用的特性工程技术联系起来。总感觉两者之间有脱节。经过一番努力，我决定写一本指南来帮助初学者更好地理解数据探索，以及如何使用从他们的分析中获得的见解来改进他们的特征工程。</p><p id="c5a4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在这个项目中，我们将关注<a class="ae ln" href="https://www.kaggle.com/rajyellow46/wine-quality" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上的葡萄酒质量数据集。该数据集包含两种葡萄酒变体，红葡萄酒和白葡萄酒，它们的物理化学特性(输入)和一个感官输出变量(质量)。我们将应用分类技术对数据进行建模。以下是我们将在本指南中涵盖的内容:</p><ol class=""><li id="0135" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj mp mq mr ms bi translated">数据清理和探索</li><li id="3587" class="mk ml iq lq b lr mt lu mu lx mv mb mw mf mx mj mp mq mr ms bi translated">特征工程</li><li id="bf2b" class="mk ml iq lq b lr mt lu mu lx mv mb mw mf mx mj mp mq mr ms bi translated">数据建模和超参数调整</li></ol><p id="c5c9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了让这个指南更容易阅读，并且不会让你被太多的信息淹没，我会把它分成三个部分，如上所述。</p><p id="402a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们开始吧！</p><p id="50d5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">数据清理</strong></p><p id="db28" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">与所有的机器学习项目一样，我们将首先将所有相关的依赖项导入到项目中，并加载数据。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="4079" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># import necessary dependencies</strong><br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>sns.set()</span><span id="650d" class="nd kg iq mz b gy ni nf l ng nh">%matplotlib inline</span></pre><p id="c0b8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">读入数据。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="c218" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># read in the data</strong><br/>wine = pd.read_csv("./datasets/winequalityN.csv")</span><span id="cb08" class="nd kg iq mz b gy ni nf l ng nh"><strong class="mz ir"># check if data has been loaded correctly</strong><br/>wine.head(5)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nj"><img src="../Images/12718407f040548b80f22d230ff348bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*33w-5ZZ7vjqbJ6K_"/></div></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="99a0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">看一眼数据，你就会意识到它可能有重复的观察。我们将不得不删除重复，因为这将增加我们的模型过度拟合的可能性。</p><p id="e569" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">保持这种想法！我们稍后再处理这个问题。</p><p id="ba4b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们检查一下数据的形状。这可让您了解数据中存在多少观测值和要素。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="5281" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># check the shape of the data</strong><br/>wine.shape</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nj"><img src="../Images/d499b79367afbf1ac2e9cae28992828a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8JfK8O_R0FYdyj0L"/></div></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="b5b3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">看我们的特征，只看到一堆对我们没有意义的数字。我们不知道这些特征意味着什么，它们之间有什么联系，或者它们对葡萄酒有什么影响。这就是领域知识的重要性。大多数时候，作为一名数据科学家，你要解决的问题是你不知道这个行业是如何运作的。没关系。这就是为什么数据科学家从不单独工作，而是让具有不同专业知识的人参与进来。领域知识，简单地说就是关于某个主题的知识，非常重要，因为它可以让你理解你正在处理的数据。</p><p id="4479" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">以下是对这些功能的简短描述:</p><ol class=""><li id="49a8" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj mp mq mr ms bi translated">固定酸度</li></ol><p id="e05e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是葡萄酒中固定酸的含量。葡萄酒中主要的固定酸有酒石酸、苹果酸、柠檬酸和琥珀酸。固定酸被添加到葡萄酒中以稳定葡萄酒(防止微生物生长)并增加一些风味。</p><p id="450d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">2.挥发性酸度</p><p id="eb67" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这些是葡萄酒中可蒸馏的酸。主要的挥发性酸是乙酸。挥发性酸度通常被用作葡萄酒腐败(葡萄酒中存在微生物)的指标。</p><p id="479a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">3.柠檬酸</p><p id="819b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是葡萄酒中的一种固定酸。它被用作葡萄酒的添加剂来增加酸味和防止铁雾。</p><p id="f787" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">4.残糖</p><p id="7230" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是发酵后剩下的糖，它已经将大部分糖转化为酒精。</p><p id="61cd" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">5.氯化物</p><p id="a314" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">氯化物是葡萄酒咸味的主要来源。由于它们的加工过程，红葡萄酒通常比白葡萄酒具有更高的氯化物浓度。</p><p id="628a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">6.游离二氧化硫</p><p id="fa6e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是葡萄酒中不与其他分子结合的二氧化硫含量。向葡萄酒中添加二氧化硫有助于稳定葡萄酒，并延长葡萄酒的保质期。高浓度的二氧化硫可能会影响葡萄酒的味道。</p><p id="fb38" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">7.二氧化硫总量</p><p id="971c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是葡萄酒中二氧化硫的总量，游离二氧化硫加上任何与葡萄酒中其他分子结合的二氧化硫。</p><p id="9766" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">8.密度</p><p id="6496" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是酒的密度。</p><p id="9c9e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">9.pH值</p><p id="83a5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是葡萄酒的酸度或碱度水平。</p><p id="7535" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">10.硫酸盐</p><p id="ff7d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">增加葡萄酒含硫量的葡萄酒添加剂。</p><p id="0a58" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">11.酒精</p><p id="5322" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是葡萄酒中的酒精含量(以百分比表示)。</p><p id="aca5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">对这些特性有了一些了解后，让我们开始清理和探索。</p><p id="6b30" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们要做的第一件事是检查任何空值(NaN ),并通过丢弃观察值或特征或输入数据来处理它们。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="3329" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Check for null values</strong><br/>total_nulls = wine.isnull().sum()<br/>total_observations = wine.shape[0]</span><span id="441b" class="nd kg iq mz b gy ni nf l ng nh">null_percentages = total_nulls[total_nulls &gt; 0] / total_observations * 100<br/>total_nulls = total_nulls[total_nulls &gt; 0]</span><span id="6da3" class="nd kg iq mz b gy ni nf l ng nh">pd.concat([total_nulls, null_percentages], axis=1, keys=["Total", "Percentage"]).sort_values(by="Total", ascending=False)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/5cd744d476ab3a6bba97169f11b65731.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*xerXRElkLEDWf9U5_wDRGA.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="b538" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们注意到数据中有一些空值，但是，它们只占总观测值的很小一部分(最大值约为0.2%)。在这种情况下，输入缺失值是安全的。由于它们都是数值，我们将使用要素的中值进行插补，因为与平均值相比，中值受异常值的影响较小。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="7b18" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Define columns with null values (NaN) </strong><br/>null_cols = ["fixed acidity", "pH", "volatile acidity", "sulphates", "citric acid", "residual sugar", "chlorides"]</span><span id="eb11" class="nd kg iq mz b gy ni nf l ng nh">from sklearn.impute import SimpleImputer</span><span id="7252" class="nd kg iq mz b gy ni nf l ng nh"><strong class="mz ir"># Fill nulls with the median of the column</strong><br/>median_imputer = SimpleImputer(strategy="median")</span><span id="9b63" class="nd kg iq mz b gy ni nf l ng nh">for col in null_cols:<br/>    wine[col] = median_imputer.fit_transform(wine[col].values.reshape(-1,1))</span></pre><p id="3fdc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们检查并确认所有的空值都已被替换，并且数据中确实没有空值。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="2412" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Check to ensure nulls were imputed</strong><br/>wine.isnull().sum()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/58a55ecba8160876ce68bf3979c729f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*TAfIpVEzrCKHzZLkOE1Uag.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="993f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">记住我们一直保留的关于重复值的想法，现在是探索它的时候了。让我们检查数据中是否有重复的值。如果这样做，我们将保留第一个实例并删除任何其他实例。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="da2a" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Check for duplicates and keep the first instance</strong><br/>duplicates_index = wine[wine.duplicated(keep="first")].index<br/>duplicates_index</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/392ef2d10745b64b10a3ac0ca11f201c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*vsarLZe3BP62QoCcLMXZCw.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="f353" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Drop the duplicated indexes</strong><br/>wine.drop(duplicates_index, axis=0, inplace=True)</span><span id="bba1" class="nd kg iq mz b gy ni nf l ng nh"><strong class="mz ir"># Check to confirm no duplicates</strong><br/>wine[wine.duplicated(keep="first")]</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nn"><img src="../Images/f7a05b5988863b59388d875235b9147d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhBimlhE7vu1v97nuG4Myw.png"/></div></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="39d3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们看看数据的新形状。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="22be" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Check the new shape of the data</strong><br/>wine.shape</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi no"><img src="../Images/44e8b9eab3decd9b5d74bc67b9ce55fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d_vhNT9ttp-h5vO6"/></div></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="e638" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">似乎我们已经丢失了几个观察数据。没关系。这比复制数据要好，因为这会影响我们模型的性能和我们对数据的分析。</p><p id="fda3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这就是我们的数据清理。</p><p id="e913" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">数据探索</strong></p><p id="6822" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们的数据现已准备就绪，可供我们探索和获得见解。探索数据集时的一个关键点是要有一组您希望数据集回答的问题。你获得这些答案的方法将会影响你提取洞察力的技术选择和你所做的任何假设。</p><p id="dfed" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">对于这个数据集，我们想要找出:</p><ul class=""><li id="26fd" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj np mq mr ms bi translated">红葡萄酒和白葡萄酒的物理化学性质的平均组成是什么？</li><li id="8570" class="mk ml iq lq b lr mt lu mu lx mv mb mw mf mx mj np mq mr ms bi translated">理化性质是如何相互联系的，它们最终是如何影响葡萄酒质量的？</li><li id="b376" class="mk ml iq lq b lr mt lu mu lx mv mb mw mf mx mj np mq mr ms bi translated">考虑到高氯化物含量(咸味)和亚硫酸盐的负面影响，这些如何影响葡萄酒的质量？</li><li id="de82" class="mk ml iq lq b lr mt lu mu lx mv mb mw mf mx mj np mq mr ms bi translated">游离二氧化硫占总二氧化硫的比例是多少，它如何影响其他物理化学性质，尤其是pH值、酸度和质量？</li><li id="4050" class="mk ml iq lq b lr mt lu mu lx mv mb mw mf mx mj np mq mr ms bi translated">什么理化特性或它们的组合最能定义优质葡萄酒？</li></ul><p id="b2da" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们将从查看数据中要素的分布开始。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="35e5" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Look at the distribution of the data</strong><br/>fig, ax = plt.subplots(figsize=(11, 11))<br/>wine.hist(bins=50, ax=ax)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/1b0ef6e30ff179df3556cf60eef5537f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/0*_9XaWzQJTx5EHs4K"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="786d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一些特征，如固定酸度、挥发性酸度和残糖似乎有一个正确的偏差。这表明在特征的上限上存在异常值。由于一些值可能太小，很难在直方图上看到，我们将使用一些统计方法来帮助我们确定一些特征的偏斜度。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="15a1" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Look at the skewness of the data</strong><br/>skew = wine.skew()<br/>pd.DataFrame(data=skew, columns=["Skew"])</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e84ec29fac33765b3c2b0e4616e61a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*Pa3wJiCxiVmeEVepBBJ91Q.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="8f65" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">正偏斜(&gt; 0)表示要素中的右偏斜，负偏斜(&lt; 0)表示左偏斜，偏斜为0表示无偏斜(即偏斜类似于高斯分布(正态分布))。从结果中，我们可以确认我们上面确定为偏斜的特征确实是右偏斜的。</p><p id="2774" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">当我们将数据传递到ML模型中时，我们将需要注意这一点。一些模型假设数据具有正态分布。转换数据以满足这一假设将提高模型的性能。把这个记下来。</p><p id="af55" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">知道了我们的特性是如何分布的，让我们看看这些特性是如何相互关联的。相关矩阵将允许我们理解不同特征之间的关系。我们将相关矩阵表示为热图，以减少显示过多数字带来的信息过载。热图让我们一眼就能发现任何有趣的关系。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="81ed" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Visualize the matrix on a heatmap</strong><br/>mask = np.triu(wine.corr())<br/>fig, ax = plt.subplots(figsize=(7,7))<br/>sns.heatmap(data=wine.corr(), annot=True, fmt=".2f", ax=ax, mask=mask)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/47662cc43f28a6f012b123d4d27fbd5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*xb54wmYqel3A1NSlK55jlg.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="4bf9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">热图的上部三角形被屏蔽，因为这将显示底部三角形的重复信息。最好专注于单一半，以便于分析。从一开始，我们就注意到一些有趣的关系，它们的颜色比其他的更亮。下面是一些关系和为什么会这样的描述。同样，领域知识对于帮助我们理解这些关系是必不可少的。</p><ul class=""><li id="3fdf" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj np mq mr ms bi translated"><strong class="lq ir">游离二氧化硫和总二氧化硫含量的增加导致挥发性和固定酸度的降低</strong>。</li></ul><p id="b0db" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">酸度越低，葡萄酒越不稳定。亚硫酸盐被添加到酸度较低的葡萄酒中，以帮助稳定它们，防止细菌生长，并延长保质期。没有添加亚硫酸盐的葡萄酒保质期较短，因此需要更高的酸度(更低的pH值)作为天然防腐剂。</p><ul class=""><li id="3b24" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj np mq mr ms bi translated"><strong class="lq ir">游离二氧化硫和总二氧化硫量的增加导致残糖量的增加。</strong></li></ul><p id="d5a6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">残余糖是发酵后剩下的东西。为了防止葡萄酒装瓶后糖的进一步发酵，添加亚硫酸盐以稳定葡萄酒并防止二次发酵，二次发酵可能导致瓶子爆炸。</p><ul class=""><li id="d03e" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj np mq mr ms bi translated"><strong class="lq ir">固定酸度和挥发酸度越高，葡萄酒密度越高</strong>。</li></ul><p id="fe5f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">葡萄酒中最常见的固定酸是酒石酸、苹果酸和柠檬酸。乙酸是最普遍的挥发性酸。观察它们各自的密度，它们都比水的密度大，酒石酸的密度为1.79克/厘米，柠檬酸为1.67克/厘米，苹果酸为1.61克/厘米，乙酸为1.05克/厘米。酸的这种特性对葡萄酒的密度有积极的影响。</p><ul class=""><li id="b6f8" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj np mq mr ms bi translated"><strong class="lq ir">固定酸度和柠檬酸的增加导致pH值降低，而挥发性酸度的增加导致pH值升高</strong>。</li></ul><p id="d249" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">向葡萄酒中添加固定酸(酒石酸、苹果酸和柠檬酸)以增加其酸度，即降低葡萄酒的pH值，这不仅有助于增加葡萄酒的风味，还有助于保存葡萄酒，因为大多数细菌无法在高酸性环境中存活。挥发性酸度是葡萄酒腐败的一个指标，这意味着葡萄酒中有细菌将一些固定酸(酒石酸和柠檬酸)和残余糖转化为乙酸。这些细菌在酸性较低(高于3.6的高pH值)的环境中生存，因此葡萄酒的pH值会增加。</p><ul class=""><li id="bf79" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj np mq mr ms bi translated"><strong class="lq ir">酒精增加导致残糖减少。</strong></li></ul><p id="074e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">残余的糖是发酵过程的副产品。这些是大多数糖被酵母转化成酒精(乙醇)后的残留物。在这个过程中转化的糖越多，酒的酒精含量就越高，因此很少有糖没有被转化。</p><ul class=""><li id="c1c5" class="mk ml iq lq b lr ls lu lv lx mm mb mn mf mo mj np mq mr ms bi translated">酒精含量越高，葡萄酒的密度越低。</li></ul><p id="7617" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">酒精(乙醇)的密度为0.789克/厘米。这使得酒精的密度小于密度为1克/厘米的水。葡萄酒中的酒精含量越高，那么葡萄酒就会越淡(密度越小)。</p><p id="4080" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在，我们已经了解了特性中存在的一些关系，让我们深入了解理化性质和感官输出(质量)之间的关系，这是我们的目标变量。我们将绘制一个条形图来显示与目标相关性最强的特征。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="3dee" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Bar plot to visualize what physicochemical properties correlate more with the quality</strong><br/>fig, ax = plt.subplots(figsize=(9,5))<br/>wine.corr()["quality"].sort_values(ascending=False).plot(kind="bar", ax=ax)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c23bc1238feebaac4d42d83491a0b0bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*Ab9tCK7kVGLh4Wp2WNBmoQ.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="7988" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">忽略质量，因为它是特性与自身的相关性，酒精与葡萄酒质量的相关性最强。葡萄酒的酒精含量越高，就越有可能被评为优质葡萄酒。密度是第二个与质量相关性最强的因素。然而，密度是负相关的。酒的密度越小，它在质量上的排名就越高。</p><p id="9304" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最后，我们来看看葡萄酒质量等级的分布。根据数据集的描述，数据集中的类是不平衡的。我们需要证实这一点，这样我们就可以找出如何处理不平衡，如果它存在。</p><pre class="ky kz la lb gt my mz na nb aw nc bi"><span id="3d18" class="nd kg iq mz b gy ne nf l ng nh"><strong class="mz ir"># Look at the distribution of classes i.e. quality in wine data<br/></strong>wine.groupby("quality")["quality"].count().plot(kind="bar")</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/36040a9d1dfaff927047bb9f51dc93d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*m2RAwSz78GxSzmrvTWDxvA.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</p></figure><p id="8adb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">正如所描述的，等级严重失衡，一小部分葡萄酒质量极低或高。大多数葡萄酒质量一般。这种不平衡将显著影响分类模型的性能，因为从极端情况中可供模型学习的数据较少。大多数情况下，模型可能会预测大多数类别。仅预测多数类而完全忽略少数类的简单模型将获得更高的准确性，但它在预测少数类方面表现很差。这种不平衡的含义是，当选择我们的分类度量以及如何通过欠采样、过采样或宁滨类来减少类不平衡时，我们需要非常注意。</p><p id="e7f3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">至此，我们的数据探索到此结束。需要注意的一点是，数据探索不是只做一次就忘了的。这是一个重复的过程，你应该将它整合到你的工作流程中。随着您转向特征工程和数据建模，您将始终了解关于您的数据的新见解，并且您应该深入了解当前的关系以及这对您的机器学习工作流意味着什么。</p><p id="4ab9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">接下来，我们将看看你如何利用从探索中获得的洞察力来进行特征工程。请继续关注本系列的第2部分。</p><p id="36f6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><em class="nv">如果你喜欢这个帖子，并且想了解更多关于数据科学和机器学习的知识，</em> <strong class="lq ir"> <em class="nv">在Medium上关注我</em> </strong> <em class="nv">。</em></p></div></div>    
</body>
</html>