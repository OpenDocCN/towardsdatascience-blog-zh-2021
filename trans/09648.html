<html>
<head>
<title>Reviewing the TensorFlow Decision Forests library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">查看TensorFlow决策森林库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reviewing-the-tensorflow-decision-forests-library-1ecf50ae00c3?source=collection_archive---------17-----------------------#2021-09-08">https://towardsdatascience.com/reviewing-the-tensorflow-decision-forests-library-1ecf50ae00c3?source=collection_archive---------17-----------------------#2021-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b1e2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Tensorflow和Keras构建基于树的模型的库</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2c637bf678e828778f25e05c69b020ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ww2S1YHHBM6KHbB2oYC3bg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">感谢<a class="ae ky" href="https://undraw.co/illustrations" rel="noopener ugc nofollow" target="_blank">https://undraw.co/illustrations</a>提供免费插图</p></figure><p id="6fdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在他们的论文<a class="ae ky" href="https://arxiv.org/abs/2106.03253?utm_campaign=Breaking%20the%20Jargons&amp;utm_medium=email&amp;utm_source=Revue%20newsletter" rel="noopener ugc nofollow" target="_blank"> <em class="lv">表格数据:深度学习不是你需要的全部</em> </a>中，作者认为，尽管深度学习方法在图像和文本领域取得了巨大成功，但传统的基于树的方法如XGBoost在表格数据方面仍然大放异彩。作者检查了<a class="ae ky" href="https://arxiv.org/abs/1908.07442?utm_campaign=Breaking%20the%20Jargons&amp;utm_medium=email&amp;utm_source=Revue%20newsletter" rel="noopener ugc nofollow" target="_blank"> Tabnet </a>、<a class="ae ky" href="https://arxiv.org/abs/1909.06312?utm_campaign=Breaking%20the%20Jargons&amp;utm_medium=email&amp;utm_source=Revue%20newsletter" rel="noopener ugc nofollow" target="_blank">神经不经意决策集成(节点)</a>、<a class="ae ky" href="https://arxiv.org/abs/2006.06465?utm_campaign=Breaking%20the%20Jargons&amp;utm_medium=email&amp;utm_source=Revue%20newsletter" rel="noopener ugc nofollow" target="_blank"> DNF网</a>和<a class="ae ky" href="https://paperswithcode.com/method/1d-cnn?utm_campaign=Breaking%20the%20Jargons&amp;utm_medium=email&amp;utm_source=Revue%20newsletter" rel="noopener ugc nofollow" target="_blank"> 1D-CNN </a>深度学习模型，并使用<a class="ae ky" href="https://arxiv.org/abs/1603.02754?utm_campaign=Breaking%20the%20Jargons&amp;utm_medium=email&amp;utm_source=Revue%20newsletter" rel="noopener ugc nofollow" target="_blank"> XGBoost </a>比较了它们在11个数据集上的性能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/75933fb136506fe93790812e3ed5e3df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*7mCJcAViLIbou19g"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表格数据:深度学习不是你需要的全部|来源:<a class="ae ky" href="https://arxiv.org/pdf/2106.03253.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2106.03253.pdf</a></p></figure><p id="6e25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一篇重要的论文，因为它重申了一个事实，即深度学习可能不是解决所有机器学习问题的银弹。另一方面，对于表格数据，基于树的算法已经显示出与神经网络性能相当，甚至优于神经网络，同时易于使用和理解。</p><p id="b905" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于喜欢使用基于树的模型的人来说，这是一个好消息。几个月前，<strong class="lb iu"> TensorFlow Decision Forests，</strong>又名<strong class="lb iu"> TF-DF </strong>库被谷歌开源。在本文中，我们将了解什么是TF-DF，以及它如何对我们有所帮助。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="4910" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">目标</h1><p id="0d47" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">许多优秀的资源和代码示例已经作为文档的一部分提供(参考下面的<strong class="lb iu">参考</strong>部分)。因此，我不会重新发明轮子。本文不是入门指南，而是对该库的快速概述，展示其主要思想和特性。为了深入了解，推荐由<a class="nb nc ep" href="https://medium.com/u/44bc27317e6b?source=post_page-----1ecf50ae00c3--------------------------------" rel="noopener" target="_blank"> Eryk Lewinson </a>撰写的关于使用<a class="ae ky" rel="noopener" target="_blank" href="/tensorflow-decision-forests-train-your-favorite-tree-based-models-using-keras-875d05a441f"> TensorFlow决策森林</a>使用口袋妖怪数据集的文章。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="0d13" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">张量流决策森林</h1><p id="e260" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">决策森林(DF)是一类由多个决策树组成的机器学习算法。<a class="ae ky" href="https://en.wikipedia.org/wiki/Random_forest" rel="noopener ugc nofollow" target="_blank">随机森林</a>和<a class="ae ky" href="https://en.wikipedia.org/wiki/Gradient_boosting" rel="noopener ugc nofollow" target="_blank">梯度提升决策树</a>是两种最流行的测向训练算法。<a class="ae ky" href="https://www.tensorflow.org/decision_forests" rel="noopener ugc nofollow" target="_blank">tensor flow决策森林</a>是为训练、服务、推理和解释这些决策森林模型而创建的库。TF-DF基本上是c++<a class="ae ky" href="https://github.com/google/yggdrasil-decision-forests#:~:text=Yggdrasil%20Decision%20Forests%20(YDF)%20is,interpretation%20of%20Decision%20Forest%20models." rel="noopener ugc nofollow" target="_blank">Yggdrasil Decision Forests(YDF)</a>库的包装器，使其在TensorFlow中可用。</p><p id="dd1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TF-DF为基于树的模型和神经网络提供了统一的API。这对用户来说非常方便，因为他们现在可以对神经网络和基于树的模型使用统一的API。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="6c98" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">实施概述</h1><p id="027b" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">TF-DF库可以很容易地用pip<a class="ae ky" href="https://www.tensorflow.org/decision_forests/installation#installation_with_pip" rel="noopener ugc nofollow" target="_blank">安装</a>。但是，它仍然不能与Mac或Windows兼容。对于非Linux用户来说，通过Google Colab使用它可能是一种变通方法。</p><p id="1373" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看在<a class="ae ky" href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html" rel="noopener ugc nofollow" target="_blank">帕尔默企鹅</a>数据集上使用TF-DF的基本实现示例。该数据集是iris数据集的替代物，目标是根据给定的特征预测<strong class="lb iu">企鹅物种</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/24c58952aaf22ea4d61a3a50a1e1bf6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/0*7nVBHnuefHhGrrjD.jpg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.freepik.com/vectors/water" rel="noopener ugc nofollow" target="_blank">brgfx-www.freepik.com创造的水矢量</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/f2f1f1c2258418f37665d58b3571fa75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jecma_P3KznFwSmLLEEcBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集的前五行</p></figure><p id="7ac6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，数据集是数字和分类特征的混合，是分类机器学习问题的经典示例。TensorFlow中的训练决策森林非常直观，如下例所示。该代码取自官方文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/e8043f353ebf2b5456a3c1c7e47cdbbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dj1YgmZaEoVoO0yh4sWEVw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练张量流决策森林|作者图片</p></figure><p id="1b53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很多事情都很突出。值得注意的是，不需要像一键编码和标准化这样的预处理。我们将在下一节谈到它们。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="0f32" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">应用程序</h1><p id="660c" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我们已经看到了一个分类示例。TF决策森林还可以用于<a class="ae ky" href="https://www.tensorflow.org/decision_forests/tutorials/beginner_colab#training_a_regression_model" rel="noopener ugc nofollow" target="_blank">回归</a>甚至<a class="ae ky" href="https://www.tensorflow.org/decision_forests/tutorials/beginner_colab#training_a_ranking_model" rel="noopener ugc nofollow" target="_blank">排名</a>这样的任务。</p><div class="kj kk kl km gt ab cb"><figure class="ng kn nh ni nj nk nl paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/3b219ff92c49001e31f00d78ceaaf86e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*mQdsIrFP4phHBdn3zmizYw.png"/></div></figure><figure class="ng kn nh ni nj nk nl paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/bcd9f1315b87a319065fb9dd43fd6500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*eZn_XSnPej8GUkLLj44DLw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk nm di nn no translated">使用TF决策森林的回归和排序示例|作者图片</p></figure></div></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="fc16" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">突出</h1><p id="3de5" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">TF-Decision森林在几个方面表现突出。让我们简要讨论其中的几个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/b7e140eaa41fa01457fae4a682a09699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*zHEMVJU0VfkJNKrojtiX9Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">TF决策森林的亮点|作者图片</p></figure><h2 id="a6bb" class="nq mf it bd mg nr ns dn mk nt nu dp mo li nv nw mq lm nx ny ms lq nz oa mu ob bi translated"><strong class="ak">易用性</strong></h2><ul class=""><li id="0b37" class="oc od it lb b lc mw lf mx li oe lm of lq og lu oh oi oj ok bi translated">相同的Keras API可以用于神经网络以及基于树的算法。将决策森林和神经网络结合起来创建新型混合模型是可能的。</li><li id="90a3" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated">无需指定输入特征。TensorFlow决策森林可以自动检测数据集中的输入要素。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/0ad55e89eb35985a1cb0c2c88eff9612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwjM6aOhg1scUWP2N41hig.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过TF决策树自动检测输入特征|图片由作者提供</p></figure><h2 id="225c" class="nq mf it bd mg nr ns dn mk nt nu dp mo li nv nw mq lm nx ny ms lq nz oa mu ob bi translated"><strong class="ak">最小预处理</strong></h2><ul class=""><li id="bd61" class="oc od it lb b lc mw lf mx li oe lm of lq og lu oh oi oj ok bi translated">不需要像分类编码、归一化和缺失值插补这样的预处理。</li><li id="abbc" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated">不需要验证数据集。如果提供，验证数据集将仅用于显示指标。</li></ul><h2 id="2c3c" class="nq mf it bd mg nr ns dn mk nt nu dp mo li nv nw mq lm nx ny ms lq nz oa mu ob bi translated">TensorFlow服务的简单部署选项</h2><ul class=""><li id="7521" class="oc od it lb b lc mw lf mx li oe lm of lq og lu oh oi oj ok bi translated">模型训练完成后，您可以使用<code class="fe or os ot ou b">model.evalute()</code>在测试数据集上对其进行评估，或者使用<code class="fe or os ot ou b">model.predict()</code>进行预测。最后，您可以使用<a class="ae ky" href="https://www.tensorflow.org/tfx/guide/serving" rel="noopener ugc nofollow" target="_blank"> TensorFlow Serving </a>将模型保存为<code class="fe or os ot ou b">SavedModel</code>格式，就像任何TensorFlow模型一样。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/b53a3d440404a27dd225458021ada4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G0QAiTBqQWOJml2CEA1v1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过<a class="ae ky" href="https://www.tensorflow.org/tfx/guide/serving" rel="noopener ugc nofollow" target="_blank"> TensorFlow发球</a> |作者图片</p></figure><h2 id="a126" class="nq mf it bd mg nr ns dn mk nt nu dp mo li nv nw mq lm nx ny ms lq nz oa mu ob bi translated">可解释性</h2><ul class=""><li id="2b64" class="oc od it lb b lc mw lf mx li oe lm of lq og lu oh oi oj ok bi translated">有时候，对于高风险的决策，我们必须理解模型是如何工作的。TensorFlow决策树有内置的绘图方法来绘制和帮助理解树结构。</li></ul><p id="a074" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们的随机森林模型的第一棵树的图。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="2ba3" class="nq mf it ou b gy oz pa l pb pc">tfdf.model_plotter.plot_model_in_colab(model_1, tree_idx=0, max_depth=3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/0c9c42016b495eff23e9193062262193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gPfIuWSYiDfwiakVqWjk0w.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">交互式可视化|作者图片</p></figure><p id="d7ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，用户还可以访问模型结构和特征重要性以及训练日志。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="cb4c" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">改进的余地</h1><p id="7fff" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">TF决策树打包了许多有用的特性，但也有一些需要改进的地方。</p><ul class=""><li id="9055" class="oc od it lb b lc ld lf lg li pe lm pf lq pg lu oh oi oj ok bi translated">不直接支持Windows或macOS(直到日期)。</li><li id="9237" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated">到目前为止，TF DF模块中只有三种算法可用:随机森林、梯度提升树和CART模型。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/3bd709431370c482489bd31bd683c2be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yEi2XL6ib2FObR0UeggN5Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">TF决策森林库中所有可用的学习算法|作者图片</p></figure><ul class=""><li id="2ad1" class="oc od it lb b lc ld lf lg li pe lm pf lq pg lu oh oi oj ok bi translated">目前，也不支持在GPU/TPU基础设施上运行模型。</li></ul></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="979c" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">最后一句话&amp;入门资源</h1><p id="3102" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">总的来说，TF决策树为使用Tensorflow和Keras构建基于树的模型提供了一个很好的选择。对于那些已经有TensorFlow管道的人来说，这尤其方便。这个库还在不断的开发中，所以很快就会有更多的特性出现。如果您想查看代码示例并使用该库作为您的用例，这里有一些适合所有级别的优秀资源。</p><ul class=""><li id="15e1" class="oc od it lb b lc ld lf lg li pe lm pf lq pg lu oh oi oj ok bi translated"><a class="ae ky" href="https://www.tensorflow.org/decision_forests/tutorials" rel="noopener ugc nofollow" target="_blank"> TensorFlow决策森林教程</a></li><li id="9026" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated"><a class="ae ky" href="https://github.com/tensorflow/decision-forests" rel="noopener ugc nofollow" target="_blank">GitHub上的TensorFlow Decision Forests </a>项目。</li><li id="e16a" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated"><a class="ae ky" href="https://blog.tensorflow.org/2021/05/introducing-tensorflow-decision-forests.html" rel="noopener ugc nofollow" target="_blank">官方博客</a></li></ul></div></div>    
</body>
</html>