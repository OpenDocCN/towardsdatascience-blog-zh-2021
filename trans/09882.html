<html>
<head>
<title>How to Learn CircleCI in Simple Words</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用简单的话学习CircleCI</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-learn-circleci-in-simple-words-2275e4299628?source=collection_archive---------22-----------------------#2021-09-16">https://towardsdatascience.com/how-to-learn-circleci-in-simple-words-2275e4299628?source=collection_archive---------22-----------------------#2021-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6df4" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">行业笔记</a></h2><div class=""/><div class=""><h2 id="bc9d" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">作为数据科学家创建CI/CD管道的行动手册</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/2c79ad02f95214f7078fb2518330ceec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sBMo5VkgH6zUtvTq"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@alexas_fotos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alexas_Fotos </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1b10" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在过去的几年里，我开发了几个软件产品。其中常见的一个关键步骤是构建一个管道来<strong class="lk jd">测试</strong>、<strong class="lk jd">构建</strong>，以及<strong class="lk jd">部署</strong>。无论你是建立一个人工智能产品还是Web应用程序，你都需要一个持续集成和部署(CI/CD)管道。拥有这条管道有助于您构建高质量的软件，并加快开发过程。有许多CI/CD工具，如CircleCI、TeamCity和Jenkins。在本文中，我用简单的语言描述了<strong class="lk jd">如何用CircleCI </strong>建立一个简单的CI/CD管道，并为您提供了<strong class="lk jd"> </strong>您必须使用它的<strong class="lk jd">场景</strong>。首先，让我从我如何熟悉软件开发中的这个重要概念开始。</p><blockquote class="me"><p id="6dbc" class="mf mg it bd mh mi mj mk ml mm mn md dk translated"><strong class="ak">当时的MLOps方案并不多。</strong>因此，我们开始使用现有的通用工具创建自己的MLOps解决方案。</p></blockquote><p id="1c2d" class="pw-post-body-paragraph li lj it lk b ll mo kd ln lo mp kg lq lr mq lt lu lv mr lx ly lz ms mb mc md im bi translated">我在2013年开发了一个基于ML的手势识别引擎。我们需要一个自动化的管道来构建、测试和归档ML模型，以确保质量并加快开发过程。<strong class="lk jd">当时的MLOps解决方案并不多。因此，我们开始使用现有的通用工具创建自己的MLOps解决方案。我们开始与团队合作。那时候，<a class="ae lh" href="https://www.jenkins.io/" rel="noopener ugc nofollow" target="_blank"> Jenkins </a>是在DevOps团队中建立CI/CD渠道最流行的选择。然而，我们是一个小型的机器学习团队，没有太多关于DevOps和Jenkins的经验，这不是最简单的解决方案！我们发现，与Jenkins相比，TeamCity提供了一个用户友好且易于设置的环境。因此，我们使用TeamCity创建了一个自动化的管道来构建、测试和归档ML模型。</strong></p><p id="8dfd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">几年后，我发现了CircleCI并爱上了它。你可能会问为什么？因为它非常强大，而且简单直观。<strong class="lk jd">在这里，我想帮助您建立CircleCI的CI/CD渠道。</strong>您可能希望使用CircleCI构建自己的MLOps解决方案，或者构建一个自动化管道来构建和部署Web应用。希望这能帮助你更好地适应这项神奇的技术。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mt"><img src="../Images/9606af31fcd533a9386ff01ed53d8c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Gq2_IfDFV3uqlyye"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@ratushny?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">德米特里·拉图什尼</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="5e51" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">CircleCI的“工作”是什么？</h1><p id="f230" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">“作业”是在单个单元中执行的步骤的集合。您可以出于各种目的创建工作。例如，您可以为<em class="nr">集成测试</em>创建一个作业，并为<em class="nr">性能测试</em>创建另一个作业。您还可以创建一个用于构建解决方案的作业和另一个用于部署该解决方案的作业。一个作业有三个主要部分:(a) <strong class="lk jd">执行者</strong> , (b) <strong class="lk jd">环境变量</strong> , (c) <strong class="lk jd">步骤。</strong>这里有<strong class="lk jd"> </strong>更多关于创建工作的细节，你可以在这里找到<a class="ae lh" href="https://circleci.com/docs/2.0/configuration-reference/#jobs" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="f89e" class="ns mv it bd mw nt nu dn na nv nw dp ne lr nx ny ng lv nz oa ni lz ob oc nk iz bi translated">执行者</h2><p id="f100" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">必须确定作业执行者(即运行作业的机器)。您可以使用Docker容器或虚拟机(Linux或Windows)。我通常为作业执行者使用Docker容器，因为我对它们有更多的控制权。使用Docker技术有助于我减少对服务的依赖，并能够在需要时迁移到其他服务。</p><h2 id="f90d" class="ns mv it bd mw nt nu dn na nv nw dp ne lr nx ny ng lv nz oa ni lz ob oc nk iz bi translated">环境变量</h2><p id="ae82" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">您必须确定该作业所需的所有环境变量。这里定义的环境变量可用于所有步骤。您还可以在某个步骤中定义环境变量，该步骤专用于该步骤。如果你想成为软件开发专家，你应该彻底学习如何定义和使用环境变量。</p><h2 id="f57e" class="ns mv it bd mw nt nu dn na nv nw dp ne lr nx ny ng lv nz oa ni lz ob oc nk iz bi translated">步伐</h2><p id="7bd4" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">最后，在前面的步骤中设置了环境变量之后，您必须确定需要运行的步骤。例如，如果CircleCI和Github连接正确，可以使用<code class="fe od oe of og b">checkout</code>命令将代码库复制到执行器中。您可能还需要运行CircleCI团队预先构建的特殊步骤。例如，如果没有特殊的配置，就不能在docker容器中构建docker映像。CircleCI让您的生活变得轻松！您只需要在<code class="fe od oe of og b">checkout</code>之后添加一个名为<code class="fe od oe of og b">setup_remote_docker</code>的新步骤。要了解更多关于如何在docker容器中运行docker命令的信息，你可以在这里阅读<a class="ae lh" href="https://circleci.com/docs/2.0/building-docker-images/" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="ks kt ku kv gt oh og oi oj aw ok bi"><span id="6b2f" class="ns mv it og b gy ol om l on oo">version: 2.1 </span><span id="9ee6" class="ns mv it og b gy op om l on oo">jobs:<br/>  build:<br/>    <strong class="og jd">docker</strong>:<br/>      - image: circleci/&lt;language&gt;:&lt;version TAG&gt;<br/>        auth:<br/>          username: $USERNAME<br/>          password: $PASSWORD<br/>    <strong class="og jd">environment</strong>:      <br/>      - USERNAME: my-dockerhub-user<br/>      - PASSWORD: my-dockerhub-password<br/>    <strong class="og jd">steps</strong>:<br/>      - checkout<br/>      - run: echo "this is the build job"</span></pre><h1 id="27b1" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">CircleCI中的“工作流”是什么？</h1><p id="3c83" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">“工作流”是一组规则，用于根据需要按特定顺序运行一组作业。例如，您可以定义一个简单的工作流来为开发过程中的每个提交运行一个作业(通常是单元测试)。您还可以定义一个更复杂的工作流来构建一个在“构建”作业之前需要“测试”作业的解决方案。工作流中使用了几个重要的操作来设置所需的规则，例如(a) <strong class="lk jd">过滤器</strong>、( b) <strong class="lk jd">要求</strong>和(c) <strong class="lk jd">触发器。</strong>这里有<strong class="lk jd"> </strong>关于创建工作流的更多细节，你可以在这里找到<a class="ae lh" href="https://circleci.com/docs/2.0/workflows/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="3d39" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面，您可以找到一些需要设计特殊工作流来满足需求的场景。</p><ul class=""><li id="d928" class="oq or it lk b ll lm lo lp lr os lv ot lz ou md ov ow ox oy bi translated"><strong class="lk jd">场景1 ( </strong>当您需要<strong class="lk jd">一个特定分支的作业)</strong> —您希望只在名称以“feature”开头的分支上运行构建作业。您应该过滤分支，只找到那些名称以目标名称开头的分支。在这种情况下，可以使用<code class="fe od oe of og b">filters</code>命令。</li><li id="b0a7" class="oq or it lk b ll oz lo pa lr pb lv pc lz pd md ov ow ox oy bi translated"><strong class="lk jd">场景2 </strong> <strong class="lk jd"> ( </strong>当你需要<strong class="lk jd">一个有序的作业系列)</strong> —你想按顺序设置一系列作业。例如，当一个新的拉请求被合并到主分支中时，您想要在web上自动部署一个解决方案。在部署作业开始之前，必须彻底运行构建作业。在这种情况下，可以使用<code class="fe od oe of og b">requires</code>命令。</li></ul><pre class="ks kt ku kv gt oh og oi oj aw ok bi"><span id="249e" class="ns mv it og b gy ol om l on oo">Workflow:<br/>  jobs:<br/>    - build:<br/>        <strong class="og jd">filters</strong>:<br/>          branches:<br/>            only:<br/>              - /feature\/.*/<br/>    - deploy:<br/>        <strong class="og jd">requires</strong>:<br/>          - build</span></pre><ul class=""><li id="8767" class="oq or it lk b ll lm lo lp lr os lv ot lz ou md ov ow ox oy bi translated"><strong class="lk jd">场景3 </strong>(当您需要一个事件在午夜<strong class="lk jd">被触发</strong>)——您想要使用最新的开发在每天午夜创建一个ML模型。您还想在那个时候自动创建一个测试报告，并在第二天的清晨提供给团队。因此，您希望“train_test”作业在夜间运行。在这种情况下，可以使用<code class="fe od oe of og b">triggers</code>命令。<a class="ae lh" href="https://circleci.com/docs/2.0/workflows/#nightly-example" rel="noopener ugc nofollow" target="_blank">阅读更多</a>。</li></ul><pre class="ks kt ku kv gt oh og oi oj aw ok bi"><span id="2039" class="ns mv it og b gy ol om l on oo">workflow:<br/>  version: 2<br/>  nightly:<br/>    <strong class="og jd">triggers</strong>:<br/>      - schedule:<br/>          cron: "0 0 * * *"<br/>          filters:<br/>            branches:<br/>              only:<br/>                - master<br/>                - beta<br/>  jobs:<br/>    - train_test</span></pre><ul class=""><li id="b288" class="oq or it lk b ll lm lo lp lr os lv ot lz ou md ov ow ox oy bi translated"><strong class="lk jd">场景4 </strong>(当您需要一个事件<strong class="lk jd">由一个拉请求</strong>触发时)——您希望确保没有错误注入到主分支中。因此，您不仅希望在每次提交时运行测试作业，还希望在拉请求时运行构建作业。很抱歉。<strong class="lk jd">在代码</strong>上做不到。您应该在CircleCI高级设置面板上更改配置。<a class="ae lh" href="https://circleci.com/docs/2.0/oss/#only-build-pull-requests" rel="noopener ugc nofollow" target="_blank">阅读更多。</a></li></ul><h1 id="e36f" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">—遗言</h1><p id="4514" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">我强烈建议从项目一开始就使用CircleCI，尤其是在开发基于云的服务时。他们提供令人敬畏的免费服务，可以长期满足个人项目的要求。如今，您可以将MLflow等专门的MLOps解决方案用于数据科学项目。但这并不意味着他们可以取代CircleCI。2013年，我们使用类似于CircleCI的服务创建了自己的MLOps解决方案。但这并不意味着你应该这样做！</p><h1 id="d6f2" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">感谢阅读！</h1><p id="5340" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">如果你喜欢这个帖子，想支持我…</p><ul class=""><li id="72b2" class="oq or it lk b ll lm lo lp lr os lv ot lz ou md ov ow ox oy bi translated"><em class="nr">跟我上</em> <a class="ae lh" href="https://medium.com/@pedram-ataee" rel="noopener"> <em class="nr">中</em> </a> <em class="nr">！</em></li><li id="2ca5" class="oq or it lk b ll oz lo pa lr pb lv pc lz pd md ov ow ox oy bi translated"><em class="nr">在</em> <a class="ae lh" href="https://www.amazon.com/Pedram-Ataee/e/B08D6J3WNW" rel="noopener ugc nofollow" target="_blank"> <em class="nr">亚马逊</em> </a> <em class="nr">上查看我的书！</em></li><li id="6029" class="oq or it lk b ll oz lo pa lr pb lv pc lz pd md ov ow ox oy bi translated"><em class="nr">成为</em> <a class="ae lh" href="https://pedram-ataee.medium.com/membership" rel="noopener"> <em class="nr">中的一员</em> </a> <em class="nr">！</em></li><li id="9a4e" class="oq or it lk b ll oz lo pa lr pb lv pc lz pd md ov ow ox oy bi translated"><em class="nr">连接上</em><a class="ae lh" href="https://www.linkedin.com/in/pedrama/" rel="noopener ugc nofollow" target="_blank"><em class="nr">Linkedin</em></a><em class="nr">！</em></li><li id="6b66" class="oq or it lk b ll oz lo pa lr pb lv pc lz pd md ov ow ox oy bi translated"><em class="nr">关注我的</em> <a class="ae lh" href="https://twitter.com/pedram_ataee" rel="noopener ugc nofollow" target="_blank"> <em class="nr">推特</em> </a> <em class="nr">！</em></li></ul><div class="pe pf gp gr pg ph"><a href="https://pedram-ataee.medium.com/membership" rel="noopener follow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd jd gy z fp pm fr fs pn fu fw jc bi translated">通过我的推荐链接加入Medium-Pedram Ataee博士</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">pedram-ataee.medium.com</p></div></div><div class="pq l"><div class="pr l ps pt pu pq pv lb ph"/></div></div></a></div></div></div>    
</body>
</html>