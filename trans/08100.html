<html>
<head>
<title>Creating Histograms of Well Log Data Using Matplotlib in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python中的Matplotlib创建测井数据直方图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-histograms-to-visualise-well-log-data-16142e2c7f81?source=collection_archive---------14-----------------------#2021-07-25">https://towardsdatascience.com/using-histograms-to-visualise-well-log-data-16142e2c7f81?source=collection_archive---------14-----------------------#2021-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9558" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用直方图可视化数据分布</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/551742a61a84308513757c51d4a17dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vCpq5pcmiafWG_XX"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@marcinjozwiak?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Marcin Jozwiak </a>拍摄的照片</p></figure><h2 id="9990" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="9fcd" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">直方图是探索性数据分析和数据科学中常用的工具。它们是优秀的数据可视化工具，看起来类似于条形图。然而，直方图使我们能够深入了解一组数据中的值的分布，并使我们能够在一个简洁的图中显示大量数据。在岩石物理学和地球科学领域，我们可以使用直方图来识别异常值，也可以挑选关键的解释参数。例如，来自伽马射线的粘土体积或页岩体积端点。</p><p id="1b22" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">要创建直方图:</p><ul class=""><li id="4cc9" class="mt mu it lx b ly mo mb mp li mv lm mw lq mx mn my mz na nb bi translated">我们首先取一条测井曲线，并确定其中包含的数值范围。例如，me可能有一个伽马射线测井，来自我们的一口井，范围从5到145 API。</li><li id="5f1e" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">然后，我们将整个范围划分为不同的仓或区间。以伽马射线测井为例，我们可以得到从0到10、11到20、21到30一直到141到150的区间。</li><li id="debd" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">创建容器后，我们获取数据并将每个值分配到适当的容器中。</li><li id="497c" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">我们最终得到的是一个区间与频率的关系图，如下图所示</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/2a77f1f653ac816ec609bc7149a8cf29.png" data-original-src="https://miro.medium.com/v2/format:webp/1*UhLJ8mXGvYjeYTgVEowCEg.png"/></div></figure><p id="dd43" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在这个简短的教程中，我们将看到如何使用matplotlib在python中快速创建直方图。我们还将看到如何定制绘图以包含额外的信息，如百分位值和平均值。</p><p id="10f3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">相关的Python笔记本可以在<a class="ae ky" href="https://github.com/andymcdgeo/Andys_YouTube_Notebooks/blob/main/02%20-%20Log%20Data%20Visualisation%20-%20Histograms.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="5a69" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">本教程的相关视频可以在我的新YouTube频道上找到:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="0ff5" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">导入库和加载LAS数据</h2><p id="2f28" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">任何python项目或笔记本的第一步通常是导入所需的库。在这种情况下，我们将使用<code class="fe nk nl nm nn b">lasio</code>来加载我们的las文件，<code class="fe nk nl nm nn b">pandas</code>来存储我们的测井记录数据，而<code class="fe nk nl nm nn b">matplotlib</code>用于可视化我们的数据。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="722c" class="kz la it nn b gy ns nt l nu nv">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import lasio</span></pre><p id="80ff" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们在这个简短教程中使用的数据来自公开发布的Equinor Volve数据集。详情请见<a class="ae ky" href="https://www.equinor.com/en/what-we-do/digitalisation-in-our-dna/volve-field-data-village-download.html" rel="noopener ugc nofollow" target="_blank">这里</a>。该数据集由Equinor(前挪威国家石油公司)发布，旨在促进研究、开发和学习。在本练习中，我们将使用该数据集中的一口井。</p><p id="114f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了读取数据，我们将使用lasio库，这是我们在之前的笔记本和<a class="ae ky" href="https://youtu.be/8U4gxMJybJs" rel="noopener ugc nofollow" target="_blank">视频</a>中探索过的。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="4ff8" class="kz la it nn b gy ns nt l nu nv">las = lasio.read("Data/15-9-19_SR_COMP.LAS")</span></pre><p id="8031" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">然后，我们将las文件转换为pandas dataframe对象。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="d7d8" class="kz la it nn b gy ns nt l nu nv">df = las.df()</span></pre><p id="2a4d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">使用<code class="fe nk nl nm nn b">.describe()</code>方法，我们可以探索数据的汇总统计。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="88e2" class="kz la it nn b gy ns nt l nu nv">df.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/f409b912584efd0fabe65e780a233f91.png" data-original-src="https://miro.medium.com/v2/format:webp/1*4iEK7C4lUuhOhwlD_izvZg.png"/></div></figure><p id="a6a1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们可以看到，这个文件中有七条测井曲线。</p><ul class=""><li id="6ce0" class="mt mu it lx b ly mo mb mp li mv lm mw lq mx mn my mz na nb bi translated">AC代表声波压缩慢度</li><li id="7fab" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">井径仪校准</li><li id="eed8" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">容积密度的DEN</li><li id="c034" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">伽马射线的GR</li><li id="d5dd" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">中子孔隙度的NEU</li><li id="086d" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">RDEP深电阻</li><li id="84ec" class="mt mu it lx b ly nc mb nd li ne lm nf lq ng mn my mz na nb bi translated">中等电阻率RMED</li></ul><h2 id="c002" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用熊猫创建直方图</h2><p id="dded" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们可以使用pandas创建一个快速直方图，而不依赖于导入其他库。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="349f" class="kz la it nn b gy ns nt l nu nv">df['GR'].plot(kind='hist')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/a8a1b8a7450155d07234ccb2a42b2e45.png" data-original-src="https://miro.medium.com/v2/format:webp/1*BlI8RLdSqt3StebFQ7Ra2A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用df['GR']创建的Volve数据集的伽马射线测井的简单直方图。plot(kind='hist ')</p></figure><h2 id="1230" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用matplotlib创建直方图</h2><p id="b7f6" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们也可以像这样使用matplotlib创建相同的直方图。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="907d" class="kz la it nn b gy ns nt l nu nv">plt.hist(df['GR'])<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/79993c32e69177735cb8611b4eb32154.png" data-original-src="https://miro.medium.com/v2/format:webp/1*r_aYhd7R_KQVTKKWn-P4Ng.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用plt.hist(df['GR'])创建的Volve数据集的伽马射线测井的简单直方图。图片由作者提供。</p></figure><p id="31a8" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这产生了一个非常小的情节。我们可以看到值的范围从0到150，API为250时有很小一部分数据。每个bin大约有25个API宽，这是一个相当大的范围。</p><p id="418b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们可以通过为bins参数指定一个set number来控制它，在本例中，我们将它设置为30。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="5cc8" class="kz la it nn b gy ns nt l nu nv">plt.hist(df['GR'], bins=30)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/12fc80647d5a9e39a1778d20319a06a9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*DwUOesA8Z8WNQwxfhrXQsg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">条柱数量增加的直方图。图片由作者提供。</p></figure><p id="33ac" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">让我们通过给箱子添加边缘颜色来稍微整理一下情节。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="4e42" class="kz la it nn b gy ns nt l nu nv">plt.hist(df['GR'], bins=30, edgecolor='black')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/06c88cfeec9364ff3560952ed4789343.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Fx5i7yTxlpGPYz2odci7hg.png"/></div></figure><p id="cd3a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">当我们这样做时，我们可以看到API低于100的仓位实际上是两个独立的仓位。</p><p id="31b1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了进一步整理绘图，我们可以指定x和y标签，并设置x轴限制。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="ba57" class="kz la it nn b gy ns nt l nu nv">plt.hist(df['GR'], bins=30, color='red', alpha=0.5, edgecolor='black')<br/>plt.xlabel('Gamma Ray - API', fontsize=14)<br/>plt.ylabel('Frequency', fontsize=14)<br/>plt.xlim(0,200)<br/><br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/2a77f1f653ac816ec609bc7149a8cf29.png" data-original-src="https://miro.medium.com/v2/format:webp/1*UhLJ8mXGvYjeYTgVEowCEg.png"/></div></figure><p id="86a6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">除了条形，我们还可以添加一个核密度估计，它为我们提供了一条显示数据分布的线。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="4816" class="kz la it nn b gy ns nt l nu nv">df['GR'].plot(kind='hist', bins=30, color='red', alpha=0.5, density=True, edgecolor='black')<br/>df['GR'].plot(kind='kde', color='black')<br/>plt.xlabel('Gamma Ray - API', fontsize=14)<br/>plt.ylabel('Density', fontsize=14)<br/>plt.xlim(0,200)</span><span id="6ce7" class="kz la it nn b gy nw nt l nu nv">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/494756d4f8c8c618e16711179e7fc083.png" data-original-src="https://miro.medium.com/v2/format:webp/1*e9vVFvjwtnVoKsYV_cVsvQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">matplotlib直方图，顶部绘制了核密度估计。图片由作者提供。</p></figure><h2 id="a9f9" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">向图中添加额外信息</h2><p id="19bf" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">当计算粘土和页岩体积作为岩石物理工作流程的一部分时，我们通常使用百分位数作为我们的解释参数。这减少了异常值或少量数据点的影响，例如，这些数据点可能代表薄的热页岩。</p><p id="27cf" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们可以使用内置的熊猫函数来计算关键的统计数据:<code class="fe nk nl nm nn b">mean()</code>和<code class="fe nk nl nm nn b">quantile()</code>。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="881c" class="kz la it nn b gy ns nt l nu nv">mean = df['GR'].mean()<br/>p5 = df['GR'].quantile(0.05)<br/>p95 = df['GR'].quantile(0.95)<br/><br/>print(f'Mean: \t {mean}')<br/>print(f'P05: \t {p5}')<br/>print(f'P95: \t {p95}')</span></pre><p id="6d35" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这将返回以下输出。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="3064" class="kz la it nn b gy ns nt l nu nv">Mean: 	 71.98679770957146<br/>P05: 	 12.74656<br/>P95: 	 128.33267999999995</span></pre><p id="4c23" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了更好地了解这些点相对于我们的数据的位置，我们可以使用axvline将它们添加到绘图上，并传入计算的变量、颜色和标签。</p><pre class="kj kk kl km gt no nn np nq aw nr bi"><span id="bea0" class="kz la it nn b gy ns nt l nu nv">df['GR'].plot(kind='hist', bins=30, color='red', alpha=0.5, edgecolor='black')<br/>plt.xlabel('Gamma Ray', fontsize=14)<br/>plt.ylabel('Frequency', fontsize=14)<br/>plt.xlim(0,200)<br/><br/>plt.axvline(mean, color='blue', label='mean')<br/>plt.axvline(p5, color='green', label='5th Percentile')<br/>plt.axvline(p95, color='purple', label='95th Percentile')<br/><br/>plt.legend()<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nh"><img src="../Images/d9a6610567d3e025a472d85be6787496.png" data-original-src="https://miro.medium.com/v2/format:webp/1*faAIiqLcdm1LyVXfbNo84A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">绘制了关键统计线的matplotlib直方图。图片由作者提供。</p></figure><h1 id="e945" class="nx la it bd lb ny nz oa le ob oc od lh jz oe ka ll kc of kd lp kf og kg lt oh bi translated">摘要</h1><p id="040f" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">在这个简短的教程中，我们介绍了如何将测井曲线显示为直方图，并定制一个适合包含在报告和出版物中的图。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><p id="f8f3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><em class="op">感谢阅读！</em></p><p id="246c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><em class="op">如果你觉得这篇文章有用，请随时查看我的其他文章，这些文章从不同的角度研究了Python和测井数据。你也可以在</em> <a class="ae ky" href="https://github.com/andymcdgeo" rel="noopener ugc nofollow" target="_blank"> <em class="op"> GitHub </em> </a> <em class="op">找到我在这篇文章和其他文章中使用的代码。</em></p><p id="2e88" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><em class="op">如果你想联系我，你可以在</em><a class="ae ky" href="https://www.linkedin.com/in/andymcdonaldgeo/" rel="noopener ugc nofollow" target="_blank"><em class="op">LinkedIn</em></a><em class="op">或者我的</em> <a class="ae ky" href="http://andymcdonald.scot/" rel="noopener ugc nofollow" target="_blank"> <em class="op">网站</em> </a> <em class="op">找到我。</em></p><p id="5ecf" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><em class="op">有兴趣了解更多关于python和测井数据或岩石物理学的知识吗？跟我上</em> <a class="ae ky" href="https://medium.com/@andymcdonaldgeo" rel="noopener"> <em class="op">中</em> </a> <em class="op">。</em></p></div></div>    
</body>
</html>