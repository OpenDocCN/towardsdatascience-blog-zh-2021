<html>
<head>
<title>A Straightforward Guide to A/B Testing in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中A/B测试的简明指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-straightforward-guide-to-a-b-testing-in-python-4432d40f997c?source=collection_archive---------19-----------------------#2021-11-08">https://towardsdatascience.com/a-straightforward-guide-to-a-b-testing-in-python-4432d40f997c?source=collection_archive---------19-----------------------#2021-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4c94" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过几个简单的步骤，让您的实验更加严谨</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6178416be79834b656a6d469d8201e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tKN9xNeokix5SNTJ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杰森·登特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5153" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">A/B测试在实验过程中非常有用。在比较一个选项和另一个选项时，增加统计的严谨性。这是有助于防止做出错误结论的一个步骤。</p><p id="28e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将演示A/B测试中的关键步骤:</p><ol class=""><li id="46d8" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">确定最小可检测效应</strong></li><li id="827d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">计算样本量</strong></li><li id="17b9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">分析结果的统计显著性</strong></li></ol><h1 id="74bf" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">场景概述</h1><p id="5015" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了演示公司可能采用A/B测试的情况，我将创建一个虚拟的视频游戏数据集。</p><p id="c552" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，一家视频游戏开发公司意识到许多用户在一个特定的级别后会退出游戏。产品团队提出的一个假设是，关卡太难了，让它变得更容易会减少用户的挫折感，最终会有更多的玩家继续玩这个游戏。</p><h1 id="2584" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">样本量计算</h1><h2 id="87cf" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">期望的业务效果</h2><p id="6d40" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们的视频游戏公司对关卡做了一些调整以使其更容易，有效地将难度从<em class="ns">硬</em>改为<em class="ns">中</em>。在盲目地向所有用户推出更新之前，产品团队希望在一个小样本上测试这些变化，看看它们是否会产生积极的影响。</p><p id="c103" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理想的衡量标准是达到我们的等级后继续玩游戏的玩家的百分比。目前，70%的用户在剩下的30%停止游戏的地方继续玩。产品团队已经决定将这一比例提高到75%,这将保证对游戏进行部署和更新。</p><h2 id="0dd2" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">最小可检测效应</h2><p id="fae1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">这条信息(70%到75%)帮助我们计算<strong class="lb iu">最小可检测效应</strong>——计算样本量的输入之一。我们的问题是测试两个比例，所以我们将使用statsmodels中的<a class="ae ky" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.proportion.proportion_effectsize.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">proportion _ effectsize</strong></a>函数将这种变化转换成我们可以处理的东西。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="5012" class="ng mk it nw b gy oa ob l oc od">Output: For a change from 0.70 to 0.75 - the effect size is -0.11.</span></pre><h2 id="4f21" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">样本量</h2><p id="2101" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">现在我们有了最小可检测效应，我们可以计算样本大小。为了解决比例问题，使用了<a class="ae ky" href="https://www.statsmodels.org/stable/generated/statsmodels.stats.power.zt_ind_solve_power.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">ZT ind solve power</strong></a>(也来自statsmodels库)。</p><p id="af97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们设置<strong class="lb iu"> nobs1 </strong>(样本1的观察值)参数，表示这就是我们要解决的问题。</p><p id="aef0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">0.05 的<strong class="lb iu">显著性水平和0.8 </strong>的<strong class="lb iu">幂是通常选择的默认值，但是这些可以基于场景和期望的假阳性与假阴性灵敏度进行调整。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="a7cb" class="ng mk it nw b gy oa ob l oc od">Output: 1250 sample size required given power analysis and input parameters.</span></pre><h1 id="d46b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">实验数据概述</h1><p id="ecc7" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在与产品团队沟通所需的样本量后，进行了一项实验，随机抽取1250名玩家玩新的较容易的级别，另外1250名玩家玩较难的级别。</p><p id="5566" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">收集数据后，我们了解到980名用户(1250名)在达到中等难度后继续玩游戏，而881名用户(1250名)在达到高难度后继续玩游戏。这看起来相当不错，超过了我们至少5%改进的希望，我们应该做出改变吗？</p><p id="adfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在决定之前，测试统计显著性是很重要的，以防止这种差异可能只是随机发生的(考虑到我们的显著性和功效)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/edfbfd0dec037e4d89db5d18d4c2992a.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/0*gYatAJc-HpnoCG-0.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者提供的实验数据、图像和数据</p></figure><h1 id="ef0f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">分析结果</h1><h2 id="2e0c" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">计算输入</h2><p id="31ce" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们将使用的统计测试是<a class="ae ky" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.proportion.proportions_ztest.html" rel="noopener ugc nofollow" target="_blank">比例_ztest </a>。我们需要首先计算一些输入——成功和观察的数量。数据存储在pandas数据帧中，其中有中、硬列，0代表停止游戏的用户，1代表继续游戏的用户。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="1b43" class="ng mk it nw b gy oa ob l oc od">Output: Medium: 980 successes of 1250 trials. Hard: 881 successes of 1250 trials.</span></pre><h2 id="b3a2" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">执行Z测试</h2><p id="b544" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">执行z测试很简单，只需输入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="5f05" class="ng mk it nw b gy oa ob l oc od">Output: z stat of 4.539 and p value of 0.0000.<!-- --> </span></pre><p id="1713" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">低于0.05的<strong class="lb iu"> <em class="ns"> p值符合我们的标准</em> </strong>。把关卡难度降低到中等才是正道！</p><h1 id="c149" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">摘要</h1><p id="47f1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">虽然这是一个虚构的简单示例，但是在现实世界中使用类似的方法可以为您的实验增加一些严谨性。当您有两个样本，并希望根据您想要的度量来判断某个实验是否导致了显著的变化时，可以考虑使用A/B测试。</p><p id="1f6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ns">在</em><a class="ae ky" href="https://github.com/bstuddard/python-examples/tree/master/ab-testing" rel="noopener ugc nofollow" target="_blank"><em class="ns">Github</em></a><em class="ns">上可以找到所有的例子和文件。</em></p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="1276" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ns">原载于</em><a class="ae ky" href="https://datastud.dev/posts/ab-testing" rel="noopener ugc nofollow" target="_blank"><em class="ns">https://data stud . dev</em></a><em class="ns">。</em></p></div></div>    
</body>
</html>