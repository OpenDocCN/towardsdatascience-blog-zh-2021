<html>
<head>
<title>Visualizing and Preprocessing Image Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化和预处理图像数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-and-preprocessing-image-dataset-e3ad574f7be6?source=collection_archive---------17-----------------------#2021-08-06">https://towardsdatascience.com/visualizing-and-preprocessing-image-dataset-e3ad574f7be6?source=collection_archive---------17-----------------------#2021-08-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dd11" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Tensorbay和SkImage对大型数据集进行可视化和预处理</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/de601554264183cb0c6f26584e11aa1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IppmUNrYlYSmULop.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="d77e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当创建计算机视觉项目或模型时，我们通常使用大型数据集。不仅图像数据集的大小比文本数据集大，而且使用了更多的图像，因此我们的模型不会过拟合，并且具有高性能。</p><p id="16e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在哪里可以找到新的、新鲜的数据集？鉴于它们的大小，下载可能吗？我们都曾在MNIST、FashionMNIST、CIFAR-10等数据集上工作过。，但是这些都是旧的，用过很多次了。一旦我们访问了新的数据集，我们如何在不下载到本地的情况下轻松使用它们？</p><p id="11b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">答案是使用来自<a class="ae lu" href="https://www.graviti.com/?utm_medium=0806Himanshu" rel="noopener ugc nofollow" target="_blank"> Graviti </a>的TensorBay。TensorBay是一个数据集管理平台，可自动化和简化整个流程，包括数据托管、版本控制和数据可视化。为了便于集成，Graviti为TensorBay开发了一个基于Python的SDK来执行这些服务。</p><p id="982b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于本地数据集的可视化，我们可以使用<a class="ae lu" href="https://tensorbay-python-sdk.graviti.com/en/latest/features/visualization.html#visualization/?utm_medium=0806Himanshu" rel="noopener ugc nofollow" target="_blank"> Pharos </a>，它是TensorBay SDK的一个插件。Pharos发布了一个Flask应用程序，允许我们可视化数据并检查其注释。这些可视化有助于识别我们的数据是如何组织的，以及数据中是否存在异常。</p><p id="b21b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于图像处理，使用了一个Python库Skimage。Skimage包含不同的算法，可以用来编辑图像。</p><p id="4283" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将使用TensorBay、Pharos和Skimage探索图像数据可视化。让我们开始吧…</p><h1 id="3bcf" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">为访问密钥创建Graviti帐户</h1><p id="586c" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在可视化数据之前，您需要有一个访问键来访问数据和分叉数据集。除了可视化，这个键还可以让您访问其他功能，如版本控制、数据集创建等。</p><div class="ms mt gp gr mu mv"><a href="https://account.graviti.com/sign-up/?utm_medium=0806Himanshu" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">气体重力服务</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">编辑描述</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">account.graviti.com</p></div></div></div></a></div><p id="394b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面给出的链接可以用来在Graviti上创建一个帐户。注册后，您可以从开发人员工具部分生成并使用您的访问密钥。</p><h1 id="12cd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">分叉数据集</h1><p id="8a0a" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">下一步是派生数据集。<a class="ae lu" href="https://www.graviti.com/?utm_medium=0806Himanshu" rel="noopener ugc nofollow" target="_blank"> Graviti </a>提供了1000多个数据集，可以很容易地进行相应的分叉和使用。您可以在此选择任何<a class="ae lu" href="https://gas.graviti.com/open-datasets/?utm_medium=0806Himanshu" rel="noopener ugc nofollow" target="_blank">数据集。对于本文，我们使用的是</a><a class="ae lu" href="https://gas.graviti.com/dataset/hellodataset/Flower17/?utm_medium=0806Himanshu" rel="noopener ugc nofollow" target="_blank"> 17类别花</a>数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/960be1a536cdb86e42f93330b4d61f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d7lD14LgPktp4ieM"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><h1 id="d340" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用Pharos可视化数据集</h1><p id="83c5" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">要可视化一个数据集，请登陆它在TensorBay的主页，使用Pharos启动Flask应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/411deba8376248b6f3559e60d167a98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zxUpPzMZR-r47kZu"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="23a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">创建Jupyter笔记本</strong></p><p id="6797" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一步是创建一个Jupyter笔记本，用于加载分叉数据集。但是首先，我们需要使用下面给出的命令安装所需的TensorBay及其插件Pharos Python库。</p><p id="d731" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下面显示的代码中，数据集在我们的本地机器上被读取，图像从URL中获取并保存在一个列表中，该列表将用于预处理。请记住，您需要提供自己的访问键，并派生出您想要使用的数据。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="a342" class="nk lw it ng b gy nl nm l nn no">from tensorbay import GAS<br/>from tensorbay.dataset import Segment<br/>from tensorbay.dataset import Data, Dataset<br/>import requests<br/>from PIL import ImageACCESS_KEY = “Your Access Key”<br/>gas = GAS(ACCESS_KEY)dataset_client = gas.get_dataset(“Flower17–1”)</span><span id="77dd" class="nk lw it ng b gy np nm l nn no">img_list=[]</span><span id="7453" class="nk lw it ng b gy np nm l nn no">segments = dataset_client.list_segment_names()segment = Segment(“default”, dataset_client)</span><span id="b2d8" class="nk lw it ng b gy np nm l nn no">for data in segment:<br/>   fp = data.open()<br/>   img_list.append(Image.open(requests.get(fp.url,        <br/>    stream=True).raw))<br/>img_list</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/4b922e39b84e38b83a9d61e90c1003b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/0*L9QM2CuWakBPyAkw"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="b787" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的图片中，你可以看到我们如何从URL加载不同的图片。现在我们将对将要处理的图像进行可视化，然后对这些图像进行预处理，这些图像存储在一个列表中。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="d121" class="nk lw it ng b gy nl nm l nn no">plt.figure(figsize=(11,11))</span><span id="6319" class="nk lw it ng b gy np nm l nn no">for i in range(1,10):</span><span id="3906" class="nk lw it ng b gy np nm l nn no">plt.subplot(3,3,i)</span><span id="6239" class="nk lw it ng b gy np nm l nn no">plt.tight_layout()</span><span id="7ed0" class="nk lw it ng b gy np nm l nn no">plt.imshow(img_list[i-1])</span><span id="a50c" class="nk lw it ng b gy np nm l nn no">plt.title(‘Flower’)</span><span id="33be" class="nk lw it ng b gy np nm l nn no">plt.xlabel(img_list[i-1].shape[1], fontsize=10)</span><span id="3833" class="nk lw it ng b gy np nm l nn no">plt.ylabel(img_list[i-1].shape[0], fontsize=10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/c21d04230ce760051626be0078f8a722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WJ10JlV_lAIzYlGC"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="73a8" class="nk lw it ng b gy nl nm l nn no">#converting image to numpy array</span><span id="7c1c" class="nk lw it ng b gy np nm l nn no">import numpy as np</span><span id="8031" class="nk lw it ng b gy np nm l nn no">image1 = np.array(img_list[0])</span><span id="af70" class="nk lw it ng b gy np nm l nn no">image1</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f09cd2a7c48a0b8cb20613ce4af82e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/0*BsSmh3AJFpMHlR2i"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="45a0" class="nk lw it ng b gy nl nm l nn no">image1.shape</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/9aec9eaff0aaa5cf1b15dcc8b9fd762b.png" data-original-src="https://miro.medium.com/v2/resize:fit:210/0*cJHWc0yQXetcADm_"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="f873" class="nk lw it ng b gy nl nm l nn no">image1.size</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/4dc65b4982f81f215c2b7a483694a180.png" data-original-src="https://miro.medium.com/v2/resize:fit:130/0*YizXh7ko103pdeQf"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="dc7f" class="nk lw it ng b gy nl nm l nn no">#Converting Grayscale<br/>from skimage.color import rgb2gray<br/>grayscale = rgb2gray(img_list[0])#Edge Detection<br/>from skimage import filters<br/>ed_sobel = filters.sobel(grayscale)<br/>imshow(ed_sobel, cmap=’gray’);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/42c977b87a785997ce90393cb989103b.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/0*kfsRHmY9sZgWf8OC"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">边缘(来源:作者)</p></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="68b5" class="nk lw it ng b gy nl nm l nn no">from skimage.exposure import histogram<br/>hist, hist_centers = histogram(grayscale)#Plotting the Image and the Histogram of gray values</span><span id="9760" class="nk lw it ng b gy np nm l nn no">fig, axes = plt.subplots(1, 2, figsize=(8, 3))</span><span id="f75c" class="nk lw it ng b gy np nm l nn no">axes[0].imshow(grayscale, cmap=plt.cm.gray)</span><span id="407a" class="nk lw it ng b gy np nm l nn no">axes[0].axis(‘off’)</span><span id="3d41" class="nk lw it ng b gy np nm l nn no">axes[1].plot(hist_centers, hist, lw=2)</span><span id="64e7" class="nk lw it ng b gy np nm l nn no">axes[1].set_title(‘histogram of gray values’)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ebc50ae19ee092983b448fe8498ae083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aMtjO20NNOZwJNOk"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="9f84" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<a class="ae lu" href="https://www.graviti.com/?utm_medium=0806Himanshu" rel="noopener ugc nofollow" target="_blank"> Graviti </a>使用不同的数据集尝试这个过程，并使用Pharos创建可视化。请在回复部分留下你的评论，让我知道结果如何。</p></div></div>    
</body>
</html>