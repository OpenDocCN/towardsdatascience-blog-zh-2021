<html>
<head>
<title>How to Replace Values in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何替换熊猫中的价值观</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-replace-values-in-pandas-609ba7a031c9?source=collection_archive---------18-----------------------#2021-12-08">https://towardsdatascience.com/how-to-replace-values-in-pandas-609ba7a031c9?source=collection_archive---------18-----------------------#2021-12-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4968" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何在Pandas数据框架中使用值替换方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/817fde35b2d021cbd2c569c74b354786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ZcYx1lZ3HebWE4vG9i6sQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@klerwonder?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Klára Vernarcová </a>在<a class="ae ky" href="https://unsplash.com/s/photos/boxes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="09dc" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">介绍</h2><p id="1e18" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">替换值是探索性数据分析(EDA)过程中的一项常见任务。如果您经常浏览数据，那么您可能不止一次遇到过需要替换某些值、创建某种分类或者只是替换需要以其他方式显示的值的情况。</p><p id="6f26" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">有几种方法可以做到这一点，对于Python来说通常就是这样。就编码而言，有些比其他的好。</p><p id="fc3c" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">由于我打算创建一个简短的帖子，我将直接进入代码片段。</p><p id="1228" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">我将在示例中使用的数据集是seaborn的<em class="na">taxies</em>。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="c528" class="lg lh it nc b gy ng nh l ni nj"># Dataframe<br/>import seaborn as sns<br/>df = sns.load_dataset('taxis')</span><span id="2664" class="lg lh it nc b gy nk nh l ni nj"># Type to datetime<br/>df.pickup = pd.to_datetime(df.pickup)</span><span id="07ef" class="lg lh it nc b gy nk nh l ni nj"># Create column pickup hour<br/>df['pickup_hour'] = df.pickup.dt.hour</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/0c891e34bf26a241b9c9ba1ef3fea0df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zf1ETn7VaK22tluCN7H0Tg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">出租车数据集。图片由作者提供。</p></figure><h2 id="4c05" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">熊猫取代了</h2><p id="a020" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">熊猫是一个很好的方法，它会让你很快变戏法。你要做的就是用一本带<code class="fe nm nn no nc b">{current value: replacement value}</code>的字典。</p><p id="0b27" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">注意，我可以使用整个数据集中的值，而不是单个列上的值。如果您希望更改是永久性的，不要忘记使用参数<code class="fe nm nn no nc b">inplace=True</code>。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="af06" class="lg lh it nc b gy ng nh l ni nj"># Replace "cash" and "credit card" from payment and "Manhattan" from pickup_borough<br/>df.replace({'cash':0, 'credit card': 1, 'Manhattan': 'island'})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/3aac800bdc35683ce2779dcaa3c2bf3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gvq0WthricEEjTXi7Gro0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">付款和提货区列中的替换。作者图片</p></figure><p id="717c" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">也可以只替换一列。该方法还接受列表或嵌套字典，以防您想要指定必须进行更改的列，或者您可以使用Pandas系列的<code class="fe nm nn no nc b">df.col.replace()</code>。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="c75c" class="lg lh it nc b gy ng nh l ni nj"># Replace with nested dictionaries<br/>df.replace({ 'payment': {'cash':0, 'credit card': 1}, <br/>             'pickup_borough': {'Manhattan': 'island'} })</span><span id="970a" class="lg lh it nc b gy nk nh l ni nj"><br/># Replace with lists.<br/># Lists must be same length</span><span id="5128" class="lg lh it nc b gy nk nh l ni nj">old_values = ['credit card', 'cash']<br/>new_values = [1, 0]</span><span id="9e9a" class="lg lh it nc b gy nk nh l ni nj">df.payment.replace(old_values, new_values)</span></pre><h2 id="885a" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">熊猫在哪里</h2><p id="49c4" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">熊猫<code class="fe nm nn no nc b">where()</code>是另一种帮助你替换值的方法，但是这种方法从1.3.0版本开始就被否决了，它有它的局限性。这些更改是基于逻辑条件执行的。所以，我们讨论的是，如果某个条件满足，那么值保持不变，否则就变了。</p><p id="c2b5" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">参见下面的例子，我将小于18小时的值(<em class="na">又名6pm </em>)更改为“day”。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="d1e4" class="lg lh it nc b gy ng nh l ni nj"># Replace with where<br/>df.pickup_hour.where(df.pickup_hour &gt; 18, other='day')</span><span id="e574" class="lg lh it nc b gy nk nh l ni nj"><strong class="nc iu">[OUT]:</strong><br/>0        20 <br/>1       day <br/>2       day <br/>3       day <br/>4       day        <br/>...  <br/>6428    day <br/>6429    day <br/>6430     22 <br/>6431    day <br/>Name: pickup_hour, Length: 6433, dtype: object</span></pre><h2 id="8e87" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">数字选择</h2><p id="494d" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated"><code class="fe nm nn no nc b">select()</code>函数与Pandas <code class="fe nm nn no nc b">replace()</code>方法非常相似。额外的好处是这个方法允许你使用条件。</p><p id="ca99" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><em class="na">它得到一个条件列表和一个长度相同的值列表</em>，并相应地替换它们。我相信这里的主要区别是<code class="fe nm nn no nc b">np.select</code>不会让你看到没有实现的变化，就像如果你不使用<code class="fe nm nn no nc b">inplace=True</code>的话，用replace方法是可能的。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="162b" class="lg lh it nc b gy ng nh l ni nj"># Replace with numpy select</span><span id="eaa8" class="lg lh it nc b gy nk nh l ni nj">conditions = [df.pickup_hour &lt;= 12,<br/>              df.pickup_hour.between(13, 18, inclusive=True),<br/>              df.pickup_hour &gt; 18]</span><span id="9d75" class="lg lh it nc b gy nk nh l ni nj">values = ['day', 'afternoon', 'night']</span><span id="3cf0" class="lg lh it nc b gy nk nh l ni nj"># New column added<br/>df['period'] = np.select(conditions, values)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/ffb0a6cd2106b5525aeef9f26d70a540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qb0c3fKY5j1VDfcaIM7sVA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">np.select()实现了3个条件。图片由作者提供。</p></figure><h2 id="6efc" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在你走之前</h2><p id="e121" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">在这篇简短的文章中，您看到了可以使用不同的方法来替换Pandas DataFrame对象中的值。我知道还有其他人，但我只是认为这里解释的那些会让你已经处于良好的状态。</p><p id="ef9b" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">在:</p><ul class=""><li id="1585" class="nr ns it me b mf mv mi mw lp nt lt nu lx nv mu nw nx ny nz bi translated"><code class="fe nm nn no nc b">df.replace({'old':'new'})</code>对于整个数据集中的变化</li><li id="29b7" class="nr ns it me b mf oa mi ob lp oc lt od lx oe mu nw nx ny nz bi translated"><code class="fe nm nn no nc b">df.col.replace({'old':'new'})</code>针对特定列上的更改</li><li id="df9d" class="nr ns it me b mf oa mi ob lp oc lt od lx oe mu nw nx ny nz bi translated"><code class="fe nm nn no nc b">df.replace({ 'col A': {'old':'new'} })</code>针对特定列上的更改</li><li id="34be" class="nr ns it me b mf oa mi ob lp oc lt od lx oe mu nw nx ny nz bi translated"><code class="fe nm nn no nc b">df.replace([ list old vals ], [list new vals])</code>使用列表进行更改</li><li id="1852" class="nr ns it me b mf oa mi ob lp oc lt od lx oe mu nw nx ny nz bi translated"><code class="fe nm nn no nc b">df[‘new col’] = np.select(conditions_list, values_list)</code>因情况变化而变化。</li></ul><h2 id="a74e" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">参考</h2><p id="4828" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated"><a class="ae ky" href="https://numpy.org/doc/stable/reference/generated/numpy.select.html" rel="noopener ugc nofollow" target="_blank"> Numpy选择文档。</a></p><p id="606d" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.replace.html" rel="noopener ugc nofollow" target="_blank">熊猫代替文档。</a></p><p id="c99b" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.where.html" rel="noopener ugc nofollow" target="_blank">熊猫在哪里文献。</a> <em class="na">【自1.3.0版起已弃用】</em></p><p id="8065" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">如果这些内容对你有用，请关注我的博客。</p><div class="of og gp gr oh oi"><a href="https://medium.com/gustavorsantos" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">古斯塔夫·桑托斯</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">让我们做出更好的决定。数据驱动的决策。我用Python，R，Excel，SQL创建数据科学项目。</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">medium.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow ks oi"/></div></div></a></div></div></div>    
</body>
</html>