<html>
<head>
<title>How to run (Model-Agnostic Meta-Learning) MAML algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何运行(与模型无关的元学习)MAML算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-run-model-agnostic-meta-learning-maml-algorithm-c73040069810?source=collection_archive---------14-----------------------#2021-06-15">https://towardsdatascience.com/how-to-run-model-agnostic-meta-learning-maml-algorithm-c73040069810?source=collection_archive---------14-----------------------#2021-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6d33" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">MAML是一类元学习算法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2223ca6c55f70a1604407410be2698ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZ-aLZhOSJuZeNfK0SDTtg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e215" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">MAML是一类元学习算法，由斯坦福研究中心和加州大学伯克利分校校友切尔西·芬恩博士创建。MAML受到了这个问题背后的想法的启发，这个问题就是学习一件事情到底需要多少数据。<strong class="la iu">我们能教算法学会如何学习吗？</strong></p><p id="2301" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这样的背景下，传统的机器学习算法面临一些挑战:</p><ol class=""><li id="7945" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">需要强化训练</li><li id="5892" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">某些问题的标记数据可能是有限的</li><li id="ca05" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">网络的性能可能对超参数的选择敏感</li></ol><p id="4129" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这方面，元学习算法可以被设计来处理以下任务:</p><ol class=""><li id="90a3" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">感应偏置的动态选择</li><li id="5cc0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">构建多任务学习的元规则</li><li id="98f7" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">学习如何通过超参数优化来学习</li></ol><p id="755d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">摘自切尔西·芬恩的原始研究:</p><blockquote class="mi mj mk"><p id="5da2" class="ky kz ml la b lb lc ju ld le lf jx lg mm li lj lk mn lm ln lo mo lq lr ls lt im bi translated">MAML是一种元学习算法，它与用梯度下降算法训练的任何模型兼容，并涵盖分类、强化学习(RL)和回归的问题</p></blockquote><h1 id="5d2e" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">MAML解决了什么样的问题？</h1><p id="f0f4" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">MAML被设计为在各种任务上训练模型，使得它可以仅用少量训练样本来学习新的学习任务。</p><p id="44ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">MAML的几个要点是:</p><ol class=""><li id="4423" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">MAML没有增加学习参数的数量。</li><li id="030a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">对模型的架构或网络没有限制。</li><li id="2196" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">可以与其他深度学习框架结合，如递归神经网络(RNN)、卷积神经网络(CNN)和多层感知器(MLP)。</li></ol><h1 id="45c6" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">问题设置</h1><p id="7475" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">MAML的问题设置是从原始论文中复制的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/fe3bacf3d89b96abc5f9474f3dbd5347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPTMhcIwPSjZF0VOOBPHwA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/e113e266f124dad7c76966bf5fa9f48e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RQ9-CPK-3b0_CR4tIJCk0w.png"/></div></div></figure><p id="cc78" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">MAML引入了一个叫做元训练的外部循环。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/eb1214f1794044099379da98c5ca791c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tYWLQcvs5B6Nvwki0oU4fQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/9af78e7fc28bc4cccd154aa02ca81118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zvdV74_zSBd7mHMtUrIwVg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/f0e12bc6bbe0c2c1fa8ad816a29bce44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6F-sM3VTEbs7cYA0U01uuw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/34e4ce2fde923c56b5ea6ac6a48ff578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NZ34o6iBvHIW0Cmh3UXPgQ.png"/></div></div></figure><h1 id="7870" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">如何运行MAML代码？</h1><p id="08e3" class="pw-post-body-paragraph ky kz it la b lb nh ju ld le ni jx lg lh nj lj lk ll nk ln lo lp nl lr ls lt im bi translated">Chelsea Finn的Github repo提供了重现MAML结果的代码。您可以使用以下步骤来重现其结果:</p><ol class=""><li id="f5ec" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">我将创建一个python虚拟环境并安装依赖项:<br/> <code class="fe ns nt nu nv b">sudo apt install virtualenv<br/>virtualenv — python=python3.6 maml</code> <br/> <code class="fe ns nt nu nv b">source maml/bin/activate</code></li><li id="2517" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">接下来，我们安装依赖项:</li><li id="0f44" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe ns nt nu nv b">pip install tensorflow==1.11.0<br/>pip install image<br/></code>我没有使用最新版本的Tensorflow，因为MAML代码是几年前写的，当时TF2还没有公开发布。</li><li id="f440" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">克隆MAML回购:<br/> <code class="fe ns nt nu nv b">git clone <a class="ae nw" href="https://github.com/cbfinn/maml" rel="noopener ugc nofollow" target="_blank">https://github.com/cbfinn/maml</a></code></li><li id="3d3c" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">下载omniglot数据，对于本文，除了正弦示例之外，我将只运行omniglot示例:<br/> <code class="fe ns nt nu nv b">wget <a class="ae nw" href="https://github.com/brendenlake/omniglot/raw/master/python/images_background.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/brendenlake/omniglot/raw/master/python/images_background.zip</a><br/>wget <a class="ae nw" href="https://github.com/brendenlake/omniglot/raw/master/python/images_evaluation.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/brendenlake/omniglot/raw/master/python/images_evaluation.zip</a></code></li><li id="ea1a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将images_background和images_evaluation zip文件解压到<code class="fe ns nt nu nv b">maml/data/omniglot</code>文件夹，其中<code class="fe ns nt nu nv b">mamal</code>文件夹是Github repo文件夹。目录结构如下所示:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/8eb491ce37d2d7bbe9297a3e04852c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*qPTNavD0O0J1wVJGXarV_g.png"/></div></figure><p id="989e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">7.导航到<code class="fe ns nt nu nv b">maml</code>文件夹的<code class="fe ns nt nu nv b">data</code>子文件夹，将<code class="fe ns nt nu nv b">omniglot</code>的内容复制到<code class="fe ns nt nu nv b">omniglot_resized</code>。运行调整图像大小脚本</p><pre class="kj kk kl km gt ny nv nz oa aw ob bi"><span id="e7d5" class="oc mq it nv b gy od oe l of og">cd maml/data<br/>cp -r omniglot/* omniglot_resized/<br/>cd omniglot_resized<br/>python resize_images.py</span></pre><p id="711a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">8.现在，我们回到maml repo <br/>的根目录，运行两个示例:</p><p id="5597" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> a .正弦曲线示例:</strong></p><pre class="kj kk kl km gt ny nv nz oa aw ob bi"><span id="ff31" class="oc mq it nv b gy od oe l of og">python main.py --datasource=sinusoid --logdir=logs/sine/ --metatrain_iterations=70000 --norm=None --update_batch_size=10</span></pre><p id="5ddf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> b. omniglot示例:</strong></p><pre class="kj kk kl km gt ny nv nz oa aw ob bi"><span id="57dc" class="oc mq it nv b gy od oe l of og">python main.py --datasource=omniglot --metatrain_iterations=60000 --meta_batch_size=32 --update_batch_size=1 --update_lr=0.4 --num_updates=1 --logdir=logs/omniglot5way/</span></pre><p id="99b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个例子的检查点都会保存在<code class="fe ns nt nu nv b">log/</code>目录下。</p><p id="b3b1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">更新:</strong>我发现代码库中有一个bug。我认为这个漏洞可能是无意中引入的。在<code class="fe ns nt nu nv b">main.py</code>中，第160行<code class="fe ns nt nu nv b">saver.save(sess, FLAGS.logdir + ‘/’ + exp_string + ‘/model’ + str(itr))</code>，<code class="fe ns nt nu nv b">itr</code>变量是<code class="fe ns nt nu nv b">for</code>循环迭代器，我认为<code class="fe ns nt nu nv b">saver.save</code>语句应该在循环末尾的for循环内执行，而不是在循环外执行。</p><p id="0db8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这里开始，我相信一个中级水平的机器学习实践者应该能够修改流水线以满足他/她的要求。</p></div></div>    
</body>
</html>