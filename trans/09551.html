<html>
<head>
<title>Analyze Health Insurance Data using RStudio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RStudio分析医疗保险数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyze-health-insurance-data-using-rstudio-85f1c1e37ec8?source=collection_archive---------7-----------------------#2021-09-05">https://towardsdatascience.com/analyze-health-insurance-data-using-rstudio-85f1c1e37ec8?source=collection_archive---------7-----------------------#2021-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0da3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用RStudio分析医疗保险数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ec5a3f47d869d276884ffc4a46783adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aWLrfRNBF_4ZLzXTB4R47g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">欧文·比尔德在<a class="ae ky" href="https://unsplash.com/s/photos/health-insurance.?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6773" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Data_analysis" rel="noopener ugc nofollow" target="_blank">数据分析</a>在商业中很重要，可以了解任何领域的当前状态，以做出准确的决策，推动业务步入正轨。在这里，我们涵盖了一个实用的领域，可以帮助个人在他们选择的任何领域进行数据分析。让我们从健康保险领域开始。</p><p id="cc4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您收到了一个样本数据集(<a class="ae ky" href="https://sendeyo.com/en/afa8d570b4" rel="noopener ugc nofollow" target="_blank"> medExpense.csv </a>)，其中包含了1340个当前参加健康保险计划的受益人的示例，这些示例显示了被保险人的特征以及该日历年的医疗费用总额。假设您被赋予了分析、讨论和解释这些数据的任务。我们将指导您如何使用<a class="ae ky" href="https://www.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> RStudio </a>处理这种情况。我们将使用<a class="ae ky" href="https://www.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> RStudio </a>来执行我们的数据分析。</p><h1 id="52c8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">加载数据集</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="c905" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="b4b6" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Importing the dataset</strong><br/>dataset &lt;- read.csv(‘medExpense.csv’, stringsAsFactors = TRUE)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/e99ce37de278a22dc5135c302a24fedf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mEC2ZhpWQ0nDuRLL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_1:在Rstudio中加载数据集</p></figure><p id="06b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从在RStudio中加载数据集开始。我们可以使用<strong class="lb iu"> read.csv </strong>函数(Image_1)从CSV文件加载数据集。我们设置<strong class="lb iu"> stringsAsFactors = TRUE </strong>来自动将字符数据转换成因子，因为我们不能在机器学习算法中直接使用字符数据。加载的数据集如Image_2所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/287c49c4d2474db635954990bac04438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FtACRepvntold-hQ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">image _ 2:r studio中加载的数据集</p></figure><h1 id="bd59" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数据探索</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="1883" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="f2d4" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Returns the first parts of the data frame</strong><br/>head(dataset)</span><span id="ed18" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Returns the latter parts of the data frame</strong><br/>tail(dataset)</span><span id="013a" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Compactly display the internal structure of the data frame</strong><br/>str(dataset)</span><span id="a3ef" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Summarize medical expenses</strong><br/>summary(dataset$expenses)</span><span id="274b" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Histogram of medical expenses</strong><br/>hist(dataset$expenses)</span><span id="403d" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Table of region</strong><br/>table(dataset$region)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/3bc2489139cf1cf0e1d238516cd9c719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y431ywjNmkiorsc0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图Rstudio中的数据浏览</p></figure><p id="702b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们探索一下我们的数据集(Image_1)。使用<strong class="lb iu"> head </strong> &amp; <strong class="lb iu"> str </strong>函数对数据集进行初步探索。<strong class="lb iu">头</strong>函数返回数据帧的第一部分(Image_4)。<strong class="lb iu"> tail </strong>函数返回数据帧的后面部分(Image_5)。<strong class="lb iu"> str </strong>函数简洁地显示了数据帧(Image_6)的内部结构。这里我们可以观察数据帧的结构。它包括1340行和7列。年龄列是int类型，性别列是具有两个级别“女性”&amp;“男性”的因子，bmi列是num类型，儿童列是int类型，吸烟者列是具有两个级别“否”、“是”的因子，地区列是具有四个级别“东北”、“西北”、“东南”、“西南”的因子，费用是num类型(Image_6)。从CSV文件中读取数据时，使用<strong class="lb iu"> stringsAsFactors = TRUE </strong>将分类变量转换为因子。我们会用多元线性回归，机器学习算法不能直接对字符数据起作用。我们必须检测特征矩阵和因变量向量。由于我们对医疗费用感兴趣，所以我们选择费用列作为因变量，并对其进行更多的探索。汇总函数汇总医疗费用列的最小值、最大值、第1个&amp;第3个四分位数、中值和平均值(Image_7)。医疗费用的频率分布通过直方图使用hist函数可视化(Image_8)。它表明大多数病例低于10000。table函数用于获取region列的每个因子级别组合的计数。它说325排落在东北地区，326排在西北地区，364排在东南地区，325排在西南地区。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/8687aaaaa167cc799b867a914ca5ef22.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/0*vDEIGoqc8VGA6apg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_4:数据帧的第一部分</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/22a79cde179e266039077713375087b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/0*eU1Iqh6_hU3TK9Hk"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:数据帧的后半部分</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/46f742b3f10533281135e27bf3305c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/0*zPRYua108YRX-kND"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_6:显示数据框的内部结构</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/ccb0fb3b1ed795048c4d2edb401480ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/0*flEFRmMsRtAwPSwR"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片_7:医疗费用汇总</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/75bf446ea94eadf7386c0eea2d9d0a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/0*eRmW_IH0rEkwjorc"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片_8:医疗费用柱状图</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/6b9fdf2c4efb5acc7f8c937b9aba899a.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/0*c-6lLBAbtL0ydvZr"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9:地区表</p></figure><h1 id="6897" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">检查功能之间的关系</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="91a1" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="928a" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Correlation</strong><br/>cor(dataset$age, dataset$expenses)<br/>cor(dataset$bmi, dataset$expenses)<br/>cor(dataset$children, dataset$expenses)</span><span id="72e4" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Correlation matrix</strong><br/>cor(dataset[c(“age”, “bmi”, “children”, “expenses”)])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/9674076e8c70552f58238d5a1648e61a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-y8OAtmnDWsCnvcC"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_10:检查Rstudio中各功能之间的关系</p></figure><p id="066f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们需要检查特性之间是否存在任何关系。我们可以使用cor函数(Image_10)检查特征之间的关系。在这里，我们试图解释有用的特征，这将有助于预测医疗费用。相关值为1表示这两个变量完全相关。在这里，我们分别比较了每个变量年龄、bmi、儿童栏与费用的相关性。然后，我们已经在一个函数调用中实现了所有这些。我们可以看到，年龄字段与医疗费用高度相关，相关值为0.3009237 &amp;儿童字段是最不相关的列，相关值为0.0684989。Bmi与0.1934809的值合理相关。我们已经在一个函数调用中比较了所有这些变量之间的相关性，如Image_12所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/d7bf2e50e400296bde4eafa215e8dca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/0*9th7JinkGfZ538eh"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11:各变量年龄、bmi、子女栏与费用相关性的个别比较</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/d1b397fc200b894351b935b5bccbc78e.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*lfSD4TfxjmR-D1b8"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_12:年龄、体重指数、子女、费用等所有变量的相关性比较</p></figure><h1 id="9a59" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">可视化特征之间的关系</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="fad0" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="a706" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Scatterplot matrix</strong><br/>pairs(dataset[c(“age”, “bmi”, “children”, “expenses”)])</span><span id="9db8" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## More informative Scatterplot matrix using psych package</strong><br/>## install.packages(‘psych’)<br/>library(psych)<br/>pairs.panels(dataset[c(“age”, “bmi”, “children”, “expenses”)])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/32fb77d2592c43087220ea86bf8c9d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Dhruc0tNqPhJGdmF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_13:在Rstudio中可视化功能之间的关系</p></figure><p id="ae0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用pairs函数来可视化年龄、bmi、儿童特征的散点图矩阵(Image_14)。使用psych package "<strong class="lb iu">pairs . panels "</strong>函数提供丰富的图表(Image_15)。在对角线上，我们可以看到每个特征的分布，无论是正态分布、右偏还是左偏等。年龄和bmi特征似乎呈正态分布(Image_15)。孩子和费用是右偏的，所以平均值正好落在峰值上。上半部分显示了这些特征之间的相关性(图15)。年龄与费用高度相关，与其他特征的相关性较低。所以年龄是一个重要的特征。体重指数与其他特征的相关性较小，与费用的相关性也较小。儿童与其他特征的关联度较低，与费用的关联度也较低。下半部分显示了这些特征之间的相关椭圆(Image_15)。它被拉伸得越多，相关性就越强。如果是正圆，那就没有关联。似乎bmi &amp;儿童的相关性最小，因为它接近于圆形。由于椭圆拉伸，年龄和儿童是相关的。年龄和费用之间的椭圆最长，因此年龄在预测费用时很重要-用红色突出显示的黄土曲线表明年龄与费用呈线性关系(Image_15)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/652c3f80706a920a06b3e9638c181be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/0*MBl9O-BthEEZrFlA"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图14:将年龄、体重指数、儿童等特征的散点图矩阵可视化</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/30bd06bc9475b061aa130fbb47e78bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/0*1NSJ7zgmC50fw0uR"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图15:使用“心理”软件包，用丰富的图表可视化年龄、体重指数、儿童的散点图矩阵</p></figure><h1 id="e688" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">将数据集分成训练集和测试集</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="c8a0" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code snippet</strong></span><span id="ef40" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu"># Splitting the dataset into training set and test set</strong><br/>## install.packages(‘caTools’)<br/>library(caTools)<br/>set.seed(123)</span><span id="afbd" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Obtain the training index</strong><br/>training_index &lt;- sample(seq_len(nrow(dataset)), size = floor(0.75 * nrow(dataset)))</span><span id="2ea7" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Partition the data</strong><br/>training_set &lt;- dataset[training_index, ]<br/>test_set &lt;- dataset[-training_index, ]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/5802e118d5177f13aa70196357b7b22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ToXEuSmYDztRtvRV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_16:在Rstudio中将数据集分为训练集和测试集</p></figure><p id="0775" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须在数据集上构建模型，并在一个完全不同的新数据集上进行测试。所以我们需要两套。我们在其中建立机器学习模型的训练集和我们在其中测试机器学习模型的性能的测试集。测试集的性能不应该与训练集相差太多。这意味着机器学习模型已经很好地学习了相关性，因此它可以适应新的情况。我们使用seed设置一个随机状态来获得相同的结果。使用<strong class="lb iu"> sample </strong>函数，我们从数据集中的所有行中随机抽取一个指定大小的样本(Image_16)。这里，我们从数据集中的所有行中获取75%的训练索引。然后，我们使用整个数据集中的这些索引将数据集划分为75%的训练集(Image_17)和25%的测试集(Image_18)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/840ccc5479b795b7fa3a831de0dc441e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/0*7qep92Fvyfq5vyxO"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_17:分区后75%的训练集</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/328ce6e1339b19eec160ef311fb68c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/0*iKNOwhS_zu6oD0CR"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_18:分区后25%的测试集</p></figure><h1 id="e058" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在训练集上训练数据(将多元线性回归拟合到训练集)</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="cb8f" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="5597" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu"># Training the data on the training set</strong></span><span id="5ab8" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Fit Multiple Linear Regression to the training set</strong><br/>initial_model &lt;- lm(expenses ~ ., data = training_set)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/d314a66189189e13d35f694621eade82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q-wBHRY3S1Zj6i36"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_19:在Rstudio的训练集上训练数据</p></figure><p id="f0e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们使用<strong class="lb iu"> lm </strong>函数(Image_19)对训练集进行多元线性回归拟合。我们把医疗费用表示为所有自变量的线性组合，用“<strong class="lb iu">费用~ </strong>表示。”在函数中。使用这个函数，我们在训练集上训练我们的初始模型。生成的模型如Image_20所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/be85e7680dc6aeea3fc8185aa6249eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GI4fDD9XpuM8dg7k"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_20:训练后的初始模型</p></figure><h1 id="e45b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">根据训练数据评估模型性能</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="ee82" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="0042" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu"># Evaluate the model performance on training data<br/></strong>summary(initial_model)</span><span id="d913" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu"># Interpret on residuals, coefficients, statistical significance of predictors<br/># &amp; overall model performance — Adjusted R-squared</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/5d7375455d2d3a17c91a32271ef7bcf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dK_WeBqPrKP3jrAv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_21:评估Rstudio中训练数据的模型性能</p></figure><p id="4fd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们已经使用<strong class="lb iu"> summary </strong>函数获得了初始模型的概要。总结包括四个重要元素残差、系数、预测值的统计显著性&amp;整体模型性能调整的R平方(Image_22)。</p><p id="20a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">残差是误差。在低估的情况下，最大误差是30029。这意味着实际费用高于预测费用。在高估的情况下，最高误差是11439。这意味着我们收取的费用超过了实际费用。第一个四分位数代表第一个25%分界点，第三个四分位数代表75%分界点。第一个四分位数是高估3060，第三个四分位数是低估1445，这是可以接受的范围。</p><p id="9fcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们查看系数部分时，我们看到R确实创建了伪变量&amp;没有落入伪变量陷阱。它自动删除一个虚拟变量，以避免一些冗余的依赖关系。对于每个系数，我们有不同的信息—来自线性回归方程的系数、标准误差、t值、p值、显著性水平。对于模型，我们需要看看我们是否有足够的统计上的强变量。这是基于阈值的。一般来说，一个好的阈值是5%。如果P值低于5%，则自变量在统计上非常显著。它就越会大于5%。它在统计学上不太重要。带星号的最后一列是解释系数的一种更快速的方法。在所有的独立变量中，年龄、体重指数、孩子和吸烟者是费用的强有力的统计预测因素。一些地区也是强有力的预测者。</p><p id="a1cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">调整后的R平方告诉我们因变量(医疗费用)的总可变性中有多少可以用模型(选定的自变量)来解释。这里我们得到了0.7352，这是一个强模型。我们可以通过使用这个值来查看模型是否有所改进。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d4e0bd0bb55ba9791e5d623354cbdb14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/0*7tKN8PLcR60L61OK"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_22:训练数据的初始模型性能摘要</p></figure><h1 id="3ef3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">进一步改进和重新评估模型性能</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="96c2" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="f1f1" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Add a higher order age term</strong><br/>dataset$age2 &lt;- dataset$age^2</span><span id="ca93" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## summary of the BMI column</strong><br/>summary(dataset$bmi)</span><span id="8e26" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Add an indicator for BMI</strong><br/>dataset$bmi30 &lt;- ifelse(dataset$bmi &gt;= 30, 1, 0)</span><span id="5eee" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Partition the data again with the additional columns but using the same index</strong><br/>training_set_new &lt;- dataset[training_index, ]<br/>test_set_new &lt;- dataset[-training_index, ]</span><span id="490c" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu">## Create the final model</strong><br/>final_model &lt;- lm(expenses ~ sex + bmi + children + region + age2 + bmi30*smoker,data = training_set_new)</span><span id="1cea" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu"># Evaluate the model performance on the new training data</strong><br/>summary(final_model)</span><span id="1793" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu"># Interpret on residuals, coefficients, statistical significance of predictors<br/># &amp; overall model performance — Adjusted R-squared</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/5fff9751f1f1b9dc518a155e98216c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OjLqIx_bsz4MYqMs"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_23:使用Rstudio中的附加age^2列评估训练数据的模型性能</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/56afef50e292e658b14db92771f990df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lyNj74Nx5CSbPqD-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_24:使用Rstudio中附加的age^2列和bmi指标列来评估模型在训练数据上的性能</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/a3ffaa365b594f6575a382be7c2fcfa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jl1aTCt9rd9tA6JS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图25:使用Rstudio中的附加age^2列以及bmi指标列和吸烟者列的组合来评估模型在训练数据上的性能</p></figure><p id="d0a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了优化我们的初始模型，我们可以做一些操作。引入互动栏目或特色是一种可能。当我们修改我们的初始模型及其性能时，我们用这些额外的列呈现新的训练数据。具有线性关系的年龄通过引入类似age^新协议的附加列而被视为非线性关系。随着这一新列的添加，调整后的R平方值增加到0.7389，从而提高了模型性能(Image_23 &amp; 26)。此外，对于Bmi，我们不是将其作为一个连续的值，而是将其作为一个健康与否的因素。我们用一个接近均值的值30来区分bmi值健康与否。随着这一新列的添加，调整后的R平方值增加到0.7435，从而提高了模型性能(Image_24 &amp; 28)。然后将具有最小P值的两列合并，这意味着具有高度的统计显著性。随着这一新列的添加，调整后的R平方值增加到0.8565，从而提高了模型性能&amp;，为我们提供了最佳模型(Image_25 &amp; 29)。</p><p id="8807" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们已经使用summary函数获得了最终模型的概要。总结包括三个重要元素残差、系数、预测值的统计显著性和整体模型性能—调整后的R平方(Image_29)。</p><p id="511d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当考虑残差时，在低估的情况下，最高误差为24059.4。这意味着实际费用高于预测费用。在高估的情况下，最高误差为4567.1。这意味着我们收取的费用超过了实际费用。第一个四分位数是高估1768.5，第三个四分位数是高估747.6，这是可以接受的范围。</p><p id="8782" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于模型，我们需要看看我们是否有足够的统计上的强变量。这是基于阈值的。一般来说，一个好的阈值是5%。如果P值低于5%，则自变量在统计上非常显著。它就越会大于5%。它在统计学上不太重要。带星号的最后一列是解释系数的一种更快速的方法。在所有的自变量中，统计上最强的预测因子是bmi指标&amp;吸烟者的乘积，它具有最低的P值。高阶年龄&amp;一些区域也是强有力的预测因子。性别和bmi列在费用预测中各自具有一定的意义。</p><p id="30e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">调整后的R平方告诉我们因变量(医疗费用)的总可变性中有多少可以用模型(选定的自变量)来解释。这里我们得到了0.8565，这是迄今为止我们得到的最高性能模型。该值比初始模型高得多。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/7df2391425be2b84c95d27902bc369d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/0*PfZ6uADkKASz-8Oo"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_26:带有附加age^2列的训练数据的模型性能摘要</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/87323fbf37f58b9cb08216985fb348d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/0*3KB3_d_svxMHXioY"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_27:身体质量指数专栏摘要</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/41b26575d59b412810cf9c916e7b1ac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/0*sTBYZZS8CeaHp11B"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_28:具有附加age^2列和bmi指示列的训练数据的模型性能摘要</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f88b56cd94e3fccd4b877754b70c4a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/0*phW_kZL1AeVfLzTB"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图29:具有额外的age^2列以及bmi指标列和吸烟者列的组合的训练数据的最终模型性能摘要</p></figure><h1 id="9e5e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用改进的模型预测测试集结果</h1><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="1f10" class="ms lw it mo b gy mt mu l mv mw"><strong class="mo iu">Code Snippet</strong></span><span id="12b4" class="ms lw it mo b gy mx mu l mv mw"><strong class="mo iu"># Predicting the test set results with the improved</strong> </span><span id="de0d" class="ms lw it mo b gy mx mu l mv mw">modelmedicalExpensesPredicted = predict(final_model, newdata = test_set_new)</span><span id="d7e3" class="ms lw it mo b gy mx mu l mv mw">cor(medicalExpensesPredicted, test_set_new$expenses)<br/>plot(medicalExpensesPredicted, test_set_new$expenses)<br/>abline(a = 0, b = 1, col = “red”, lwd = 3, lty = 2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/799f78efef3b44592d3a96daca327c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7gKC4rs_0zf-70-E"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_30:使用Rstudio中的改进模型预测测试集结果</p></figure><p id="4ecc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们使用预测函数(Image_30)通过改进的模型对新的测试数据(test_set_new)进行预测。我们使用<strong class="lb iu"> cor </strong>函数比较测试集中预测医疗费用和实际医疗费用的相关性，得到的值为0.9432327，这意味着它们高度相关，具有良好的准确性(Image_31)。这里我们绘制了预测与实际医疗费用的对比图(图32)。很少有异常值，但该图表明在大多数情况下，实际结果和预期结果是一致的。你可以在这里下载上面例子<a class="ae ky" href="https://sendeyo.com/en/2ad9416897" rel="noopener ugc nofollow" target="_blank">的R脚本。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/d145d83fd77042bf4e4dd899be3b4ff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/0*GhEVyYoJD_gHPKE1"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_31:改进模型的预测测试集结果</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/12b9738b78b7e7970dcf681bf57c0031.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/0*KA_dSdU4OInMaa3X"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image_32:绘制预测与实际医疗费用的对比图</p></figure><p id="763a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你可能已经意识到，当你使用RStudio这样的工具时，数据分析并不是一个非常困难的过程。您可以将在本指南中获得的知识应用到任何其他感兴趣的领域。</p></div></div>    
</body>
</html>