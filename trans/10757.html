<html>
<head>
<title>Statistics in Python — Using ANOVA for Feature Selection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的统计数据-使用方差分析进行要素选择</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/statistics-in-python-using-anova-for-feature-selection-b4dc876ef4f0?source=collection_archive---------4-----------------------#2021-10-18">https://towardsdatascience.com/statistics-in-python-using-anova-for-feature-selection-b4dc876ef4f0?source=collection_archive---------4-----------------------#2021-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cda5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用ANOVA比较分类变量和数值变量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f7e82d16d8c7ff1c2cf74f7c9e997ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sh_tF_iLNbqujCmA"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gabriel Gurrola 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="507e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的上一篇文章中，我谈到了使用卡方统计从数据集中选择用于机器学习的特征。当自变量和因变量都是<em class="lv">分类</em>变量时，使用卡方检验。但是，如果你的自变量是<em class="lv">分类</em>，因变量是<em class="lv">数值</em>呢？在这种情况下，您必须使用另一种称为ANOVA的统计测试— <strong class="lb iu">方差分析。</strong></p><p id="3359" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在本文中，我们的讨论将围绕方差分析以及如何在机器学习中使用它进行特征选择。和我之前所有的文章一样，我将用一个具体的例子来解释这个概念。</p><p id="e302" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们开始之前，总结一下我们到目前为止讨论过的不同的特性选择方法是很有用的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/d7400331c38f59bfb8088cf25efba786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t5iKJocvAUgTIuwiD1qjPw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5a29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你需要复习一下<strong class="lb iu">皮尔森相关性</strong>、<strong class="lb iu">斯皮尔曼等级相关性</strong>和<strong class="lb iu">卡方</strong>，我建议你现在就去查阅它们(见下面的链接)，一旦你完成了就回来看这篇文章。本文中讨论的一些概念类似于卡方检验，所以我建议您查看一下。</p><div class="lx ly gp gr lz ma"><a rel="noopener follow" target="_blank" href="/statistics-in-python-using-chi-square-for-feature-selection-d44f467ca745"><div class="mb ab fo"><div class="mc ab md cl cj me"><h2 class="bd iu gy z fp mf fr fs mg fu fw is bi translated">Python中的统计数据-使用卡方进行要素选择</h2><div class="mh l"><h3 class="bd b gy z fp mf fr fs mg fu fw dk translated">在我之前的两篇文章中，我谈到了如何度量数据集中各列之间的相关性，以及…</h3></div><div class="mi l"><p class="bd b dl z fp mf fr fs mg fu fw dk translated">towardsdatascience.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo ks ma"/></div></div></a></div><div class="lx ly gp gr lz ma"><a rel="noopener follow" target="_blank" href="/statistics-in-python-collinearity-and-multicollinearity-4cc4dcd82b3f"><div class="mb ab fo"><div class="mc ab md cl cj me"><h2 class="bd iu gy z fp mf fr fs mg fu fw is bi translated">Python中的统计数据-共线性和多重共线性</h2><div class="mh l"><h3 class="bd b gy z fp mf fr fs mg fu fw dk translated">了解如何发现数据集中的多重共线性</h3></div><div class="mi l"><p class="bd b dl z fp mf fr fs mg fu fw dk translated">towardsdatascience.com</p></div></div><div class="mj l"><div class="mp l ml mm mn mj mo ks ma"/></div></div></a></div><div class="lx ly gp gr lz ma"><a rel="noopener follow" target="_blank" href="/statistics-in-python-understanding-variance-covariance-and-correlation-4729b528db01"><div class="mb ab fo"><div class="mc ab md cl cj me"><h2 class="bd iu gy z fp mf fr fs mg fu fw is bi translated">Python中的统计学-了解方差、协方差和相关性</h2><div class="mh l"><h3 class="bd b gy z fp mf fr fs mg fu fw dk translated">理解你的数据之间的关系，知道皮尔逊相关系数和…</h3></div><div class="mi l"><p class="bd b dl z fp mf fr fs mg fu fw dk translated">towardsdatascience.com</p></div></div><div class="mj l"><div class="mq l ml mm mn mj mo ks ma"/></div></div></a></div><h1 id="46c7" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">什么是方差分析？</h1><p id="6c03" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">ANOVA用于测试两个变量，其中:</p><ul class=""><li id="ff13" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">一个是<em class="lv">分类</em>变量</li><li id="60fa" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">另一个是<em class="lv">数值</em>变量</li></ul><p id="f7ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当分类变量有<em class="lv">至少3组</em>(即三个不同的唯一值)时，使用ANOVA。</p><blockquote class="oc od oe"><p id="f7b0" class="kz la lv lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated">如果你只想比较两组，就用t检验。我将在另一篇文章中介绍t-test。</p></blockquote><p id="03ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">方差分析让你知道你的数值变量是否根据分类变量的水平而变化。</p><blockquote class="oc od oe"><p id="bc0e" class="kz la lv lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated"><strong class="lb iu"> ANOVA使用f检验对平均值的相等性进行统计检验</strong>。F-tests以它的测试统计量F命名，F是为了纪念<strong class="lb iu">罗纳德·费雪爵士</strong>而命名的。</p></blockquote><p id="1563" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一些例子，可以让你更容易理解什么时候可以使用方差分析。</p><ul class=""><li id="775a" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">您有一个数据集，其中包含一组人的社交媒体使用情况和睡眠时间信息:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/d3b1f0e4b0eb1f081aa32e00a2746db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*ZJ6LxDu5FSkZBSVcxsVAYQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3f98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你想知道社交媒体的使用量(分类变量)是否对睡眠时间(数字变量)有直接影响。</p><ul class=""><li id="d3f3" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">您有一个数据集，其中包含三种不同品牌的药物以及药物生效的天数:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/e7379212a0dadb297157772bfe9d6577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*R92ydcUxB2iaAf8CBQWUnw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5c00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你想找出一个特定的品牌和它的有效性之间是否有直接的关系。</p><blockquote class="oc od oe"><p id="8d1f" class="kz la lv lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated">ANOVA检查关于数字响应的分类特征组之间是否有相等的方差。</p></blockquote><p id="0d58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果各组之间的方差相等，这意味着该特征对反应没有影响，因此它(分类变量)不能被考虑用于模型训练。</p><h1 id="bc77" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">用手演奏阿凡纳</h1><p id="ff47" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">理解方差分析的最好方法是用一个例子。在下面的例子中，我使用了一个虚构的数据集，记录了一组人在喝某种饮料时的反应时间。</p><h2 id="2704" class="ok ms it bd mt ol om dn mx on oo dp nb li op oq nd lm or os nf lq ot ou nh ov bi translated">样本数据集</h2><p id="28df" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">我有一个名为<strong class="lb iu"> drinks.csv </strong>的样本数据集，包含以下内容:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="8849" class="ok ms it ox b gy pb pc l pd pe">team,drink_type,reaction_time<br/>1,water,14<br/>2,water,25<br/>3,water,23<br/>4,water,27<br/>5,water,28<br/>6,water,21<br/>7,water,26<br/>8,water,30<br/>9,water,31<br/>10,water,34<br/>1,coke,25 <br/>2,coke,26<br/>3,coke,27<br/>4,coke,29<br/>5,coke,25<br/>6,coke,23<br/>7,coke,22<br/>8,coke,27<br/>9,coke,29<br/>10,coke,21<br/>1,coffee,8<br/>2,coffee,20<br/>3,coffee,26<br/>4,coffee,36<br/>5,coffee,39<br/>6,coffee,23<br/>7,coffee,25<br/>8,coffee,28<br/>9,coffee,27<br/>10,coffee,25</span></pre><p id="7b62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总共有10个小组——每个小组由3人组成。团队中的每个人都有三种不同的饮料——水、可乐和咖啡。喝完饮料后，他们被要求进行一些活动，并记录他们的反应时间。这个实验的目的是确定饮料是否对人的反应时间有任何影响。</p><p id="1867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先将数据集加载到熊猫数据框架中:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="99fb" class="ok ms it ox b gy pb pc l pd pe">import pandas as pd<br/>df = pd.read_csv('drinks.csv')</span></pre><p id="3a67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记录<em class="lv">观察尺寸</em>，我们稍后会用到:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="dde0" class="ok ms it ox b gy pb pc l pd pe">observation_size = df.shape[0]   # number of observations</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/4b7dba70d4233c2b1687e3c75428f4d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*rWvZGZ2aNrx0IgW_cogrzg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="6454" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">可视化数据集</h1><p id="e37b" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">使用箱线图直观显示数据的分布非常有用:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="e275" class="ok ms it ox b gy pb pc l pd pe">_ = df.boxplot('reaction_time', by='drink_type')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/071aa6294fa1a2c7295e0fa187fda945.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*ijv8roMwkVPU9y2uj3BLLA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a62d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到这三种饮料的平均反应时间差不多。</p><h1 id="849f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">旋转数据框</h1><p id="49e3" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">为了便于计算方差分析，我们需要旋转数据框:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="bad2" class="ok ms it ox b gy pb pc l pd pe">df = df.pivot(columns='drink_type', index='team')<br/>display(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/91fd1549af07c2ec52e7082d8e04f9db.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*dSIveGLbON4SMoeB8vfZGg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cad3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列代表三种不同类型的饮料，行代表10个队。我们还将利用这个机会记录每组中的<em class="lv">个项目，以及稍后将使用的<em class="lv">组</em>个项目:</em></p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="7f0a" class="ok ms it ox b gy pb pc l pd pe">n = df.shape[0]   # 10; number of items in each group<br/>k = df.shape[1]   # 3; number of groups</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/97187ba6e6de91aa62a785009b9ab7b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*kwPIDrCfFZRnRGfNTpCTnQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="6510" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">定义假设</h1><p id="c5cd" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">您现在定义您的<em class="lv">零假设</em>和<em class="lv">替代假设</em>，就像卡方检验一样。它们是:</p><ul class=""><li id="77df" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated"><strong class="lb iu"> H₀ </strong>(零假设)——组间均值无差异。</li><li id="771a" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu"> H₁ </strong>(替代假设)——至少有一组显著不同于因变量的总体均值。</li></ul><h1 id="544b" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">步骤1 —计算所有组的平均值</h1><p id="63ff" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">我们现在准备开始方差分析的计算。首先，让我们找出每组的平均值:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="6747" class="ok ms it ox b gy pb pc l pd pe">df.loc['Group Means'] = df.mean()<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/01982f9d8ab31d51a6ae434968fda756.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*8Qf1nQG1wFhebtj0ablhjg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8392" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这里，你现在可以计算出<strong class="lb iu">总的意思是</strong>:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="6604" class="ok ms it ox b gy pb pc l pd pe">overall_mean = df.iloc[-1].mean()<br/>overall_mean    # 25.666666666666668</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/6454a2e67f1c094a0b5bb58610dae61d.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*Ig0-O-gmoOUg-qWhcgPLmQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="9bbb" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">第二步——计算平方和</h1><p id="e500" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">现在我们已经计算出了<em class="lv">的总体平均值</em>，我们可以继续计算如下:</p><ul class=""><li id="f6db" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">所有观察值的平方和— <strong class="lb iu"> SS_total </strong></li><li id="533a" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">范围内的平方和—<strong class="lb iu">SS _范围内</strong></li><li id="2898" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">之间的平方和— <strong class="lb iu"> SS_between </strong></li></ul><h2 id="5777" class="ok ms it bd mt ol om dn mx on oo dp nb li op oq nd lm or os nf lq ot ou nh ov bi translated">所有观察值的平方和— <strong class="ak"> SS_total </strong></h2><p id="4fc8" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">所有观察值的<em class="lv">平方和的计算方法是从<em class="lv">总平均值</em>中减去每个观察值，然后将所有差值的平方和相加:</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/617e174f2f164621507378e40a702cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*250QwH7otw3jXslQGDoHjw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/46f2209448790ca1321b358fdf3d8b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*VqTgxB614DucpY5SxI-Rsw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d6ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过编程，<strong class="lb iu"> SS_total </strong>计算如下:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="1060" class="ok ms it ox b gy pb pc l pd pe">SS_total = (((df.iloc[:-1] - overall_mean)**2).sum()).sum()<br/>SS_total   # 1002.6666666666667</span></pre><h2 id="b537" class="ok ms it bd mt ol om dn mx on oo dp nb li op oq nd lm or os nf lq ot ou nh ov bi translated">范围内的平方和— SS_within</h2><p id="ca99" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在中的<em class="lv">平方和是他们组平均值周围分数的方差之和:</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/6dd37b80c10719081e19d476d400fe2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*tiofBOkb8IDmrO6Ls0qlLA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e9a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过编程，<strong class="lb iu"> SS_within </strong>计算如下:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="ae32" class="ok ms it ox b gy pb pc l pd pe">SS_within = (((df.iloc[:-1] - df.iloc[-1])**2).sum()).sum() <br/>SS_within    # 1001.4</span></pre><h2 id="21a8" class="ok ms it bd mt ol om dn mx on oo dp nb li op oq nd lm or os nf lq ot ou nh ov bi translated">之间的平方和— SS_between</h2><p id="5bfc" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">接下来，我们根据总体平均值计算组平均值的平方和:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/80f9692fe67d6630b899f3993c2faa75.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*0coIVDb_7lz8igtq9OAfgA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/fb41231dbc88c08c4398ef139814f177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*THQGpnjxh_1MKs3LAOxryA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1844" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过编程，<strong class="lb iu"> SS_between </strong>计算如下:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="7ed6" class="ok ms it ox b gy pb pc l pd pe">SS_between = (n * (df.iloc[-1] - overall_mean)**2).sum()<br/>SS_between    # 1.266666666666667</span></pre><p id="3d15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以验证:</p><p id="8b26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">SS _ total</strong>=<strong class="lb iu">SS _ between</strong>+<strong class="lb iu">SS _ within</strong></p><h1 id="fbdd" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">创建方差分析表</h1><p id="feb6" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">计算完所有值后，您现在可以完成ANOVA表。回想一下，您有以下变量:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/f8aec4616324b5d5529a062406ef36b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XT3B3nwMAc3n1r4sktLusA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4b5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以如下计算各种<em class="lv">自由度</em>:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="35e5" class="ok ms it ox b gy pb pc l pd pe">df_total = observation_size - 1        # 29<br/>df_within = observation_size - k       # 27<br/>df_between = k - 1                     # 2</span></pre><p id="ee84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据上述内容，计算各种<em class="lv">均方</em>值:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="928d" class="ok ms it ox b gy pb pc l pd pe">mean_sq_between = SS_between / (k - 1)      # 0.6333333333333335<br/>mean_sq_within = \<br/>    SS_within / (observation_size - k)      # 37.08888888888889</span></pre><p id="4870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，您可以计算<strong class="lb iu"> F值</strong>，它是两个方差的比值:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="10cf" class="ok ms it ox b gy pb pc l pd pe">F = mean_sq_between / mean_sq_within        # 0.017076093469143204</span></pre><blockquote class="oc od oe"><p id="ace8" class="kz la lv lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated">回想一下，我之前提到过ANOVA使用f检验来统计检验均值的相等性。</p></blockquote><p id="e23c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦获得F值，你现在必须参考<em class="lv"> f分布表</em>(例如参见<a class="ae ky" href="http://www.socr.ucla.edu/Applets.dir/F_Table.html" rel="noopener ugc nofollow" target="_blank">http://www.socr.ucla.edu/Applets.dir/F_Table.html</a>)来获得<strong class="lb iu"> f临界值</strong>。f分布表是根据<strong class="lb iu"> α </strong>值(通常为0.05)组织的。因此，您需要首先根据<strong class="lb iu"> α= </strong> 0.05定位表格:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/5e12aaef923c2ff828ae6c15ce144f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYzuyyg2CcAKkfXr8Sq4Xw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="http://www.socr.ucla.edu/Applets.dir/F_Table.html" rel="noopener ugc nofollow" target="_blank">http://www.socr.ucla.edu/Applets.dir/F_Table.html</a></p></figure><p id="a122" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，观察f分布表的列基于<strong class="lb iu"> df1 </strong>，而行基于<strong class="lb iu"> df2 </strong>。你可以从我们之前创建的变量中得到你的<strong class="lb iu"> df1 </strong>和<strong class="lb iu"> df2 </strong>:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="661b" class="ok ms it ox b gy pb pc l pd pe">df1 = df_between    # 2<br/>df2 = df_within     # 27</span></pre><p id="e40d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<strong class="lb iu"> df1 </strong>和<strong class="lb iu"> df2 </strong>的值，您现在可以通过定位<strong class="lb iu"> df1 </strong>列和<strong class="lb iu"> df2 </strong>行来定位<strong class="lb iu">f-临界值</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/974d9ed486d53d2247cf9b96ae532e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-9I-Qt8VgIKas4Mg0KAnhw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自http://www.socr.ucla.edu/Applets.dir/F_Table.html的表格；作者注释</p></figure><p id="944f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上图可以看出<strong class="lb iu">f-临界值</strong>为<strong class="lb iu"> 3.3541 </strong>。使用该值，您现在可以使用<strong class="lb iu"> F分布曲线</strong>决定是接受还是拒绝零假设:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/8cd95a441e171e62372488d056275e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CFTbSoK8BLbX2AAJUWwPAA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e1e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于<strong class="lb iu"> f值</strong> (0.0171，这是我们可以计算的)小于f分布表中的f临界值，我们接受零假设— <strong class="lb iu">这意味着不同组中没有方差—所有均值都相同</strong>。</p><blockquote class="oc od oe"><p id="6ba0" class="kz la lv lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated">对于机器学习来说，这个特征——<em class="it">饮料_类型</em>，应该<strong class="lb iu"> <em class="it">而不是</em> </strong>被包括在训练中，因为不同类型的饮料似乎对反应时间没有影响。</p><p id="fc7c" class="kz la lv lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated">只有当您拒绝零假设时，您才应该包括一个用于训练的特征，因为这意味着饮料类型中的值对反应时间有影响。</p></blockquote><h1 id="94b1" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">使用统计模块计算f分数</h1><p id="8946" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在上一节中，我们手动计算了数据集的f值。实际上，有一种更简单的方法—使用<strong class="lb iu"> stats </strong>模块的<strong class="lb iu"> f_oneway() </strong>函数来计算f值和p值:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="95b6" class="ok ms it ox b gy pb pc l pd pe">import scipy.stats as stats<br/><br/>fvalue, pvalue = stats.f_oneway(<br/>    df.iloc[:-1,0],<br/>    df.iloc[:-1,1],<br/>    df.iloc[:-1,2])</span><span id="b075" class="ok ms it ox b gy ps pc l pd pe">print(fvalue, pvalue)      # 0.0170760934691432 0.9830794846682348</span></pre><p id="c04c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> f_oneway() </strong>函数将组作为输入，并返回方差分析F和p值:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/93537e35b49f50eae5102e3100c30c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*t8cP4wa6KVHE7C44F9UfzQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fc25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图中<strong class="lb iu"> f值</strong>为<strong class="lb iu"> 0.0170760934691432 </strong>(与我们手动计算的相同)<strong class="lb iu"> p值</strong>为<strong class="lb iu"> 0.9830794846682348 </strong>。</p><p id="8318" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意到<strong class="lb iu"> f_oneway() </strong>函数接受可变数量的参数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/f1310ba6d444ec49bdb74ac6b1e73fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*iDR2d8jnZbj4UqwBC8cAGg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3fc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果有很多组，那么逐个传递所有组的值会非常繁琐。所以，有一个更简单的方法:</p><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="305e" class="ok ms it ox b gy pb pc l pd pe">fvalue, pvalue = stats.f_oneway(<br/>    <strong class="ox iu">*df.iloc[:-1,0:3].T.values<br/></strong>)</span></pre><p id="3720" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将把上面的内容作为一个练习，让你理解它是如何工作的。</p><h1 id="fae3" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">使用statsmodels模块计算f分数</h1><p id="d931" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">另一种计算f值的方法是使用<strong class="lb iu"> statsmodel </strong>模块。您首先使用<strong class="lb iu"> ols() </strong>函数构建模型，然后在模型的实例上调用<strong class="lb iu"> fit() </strong>函数。最后，在拟合的模型上调用<strong class="lb iu"> anova_lm() </strong>函数，并指定要对其执行的anova测试的类型:</p><blockquote class="oc od oe"><p id="6574" class="kz la lv lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated">这里有3种要执行的方差分析测试，但是它们的讨论超出了本文的范围。</p></blockquote><pre class="kj kk kl km gt ow ox oy oz aw pa bi"><span id="396a" class="ok ms it ox b gy pb pc l pd pe">import pandas as pd<br/>import statsmodels.api as sm<br/>from statsmodels.formula.api import ols</span><span id="5866" class="ok ms it ox b gy ps pc l pd pe">df = pd.read_csv('drinks.csv')</span><span id="b219" class="ok ms it ox b gy ps pc l pd pe">model = ols('reaction_time ~ drink_type', data=df).fit()<br/>sm.stats.anova_lm(model, typ=2)</span></pre><p id="2fa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码片段产生以下结果，这与我们之前计算的f值(<strong class="lb iu"> 0.017076 </strong>)相同:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/5d1807e09092688e02a9b552cae9c906.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*5lXqu1ij2_h-jReXKbrGUg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fd15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> anova_lm() </strong>函数也返回p值(<strong class="lb iu"> 0.983079 </strong>)。您可以利用以下规则来确定分类变量是否对数值变量有任何影响:</p><ul class=""><li id="6dce" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">如果p &lt; 0.05, this means that the categorical variable has significant influence on the numerical variable</li><li id="74a8" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">if p &gt; 0.05，这意味着分类变量对数值变量没有显著影响</li></ul><p id="1aa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于p值现在是0.983079 (&gt;0.05)，这意味着<strong class="lb iu">饮料类型</strong>对<strong class="lb iu">反应时间</strong>没有显著影响。</p><h1 id="fa72" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">摘要</h1><p id="1a3e" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在这篇文章中，我解释了方差分析如何帮助确定一个分类变量是否对一个数字变量有影响。到目前为止，我们讨论的方差分析测试被称为<strong class="lb iu">单向方差分析</strong>测试。方差分析有几个变体:</p><ul class=""><li id="097c" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated"><strong class="lb iu">单向ANOVA </strong> —用于检查一个数值变量如何响应<em class="lv">一个</em>独立分类变量的水平</li><li id="3423" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu">双向ANOVA</strong>—用于检查一个数值变量如何响应两个独立分类变量的水平</li><li id="e92a" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu">多向ANOVA </strong> —用于检查一个数字变量如何响应<em class="lv">多个</em>独立分类变量的水平</li></ul><p id="bf13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<strong class="lb iu">双向ANOVA </strong>或<strong class="lb iu">多向ANOVA </strong>，您可以调查两个(或更多)独立分类变量对一个相关数值变量的综合影响。</p><p id="204e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这篇文章对你有用。敬请期待下一篇文章！</p><div class="lx ly gp gr lz ma"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="mb ab fo"><div class="mc ab md cl cj me"><h2 class="bd iu gy z fp mf fr fs mg fu fw is bi translated">加入媒介与我的介绍链接-李伟孟</h2><div class="mh l"><h3 class="bd b gy z fp mf fr fs mg fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mi l"><p class="bd b dl z fp mf fr fs mg fu fw dk translated">weimenglee.medium.com</p></div></div><div class="mj l"><div class="pw l ml mm mn mj mo ks ma"/></div></div></a></div></div></div>    
</body>
</html>