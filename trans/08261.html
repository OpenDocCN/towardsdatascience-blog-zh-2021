<html>
<head>
<title>Reshaping Data with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫重塑数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reshaping-data-with-pandas-ecff92572488?source=collection_archive---------25-----------------------#2021-07-29">https://towardsdatascience.com/reshaping-data-with-pandas-ecff92572488?source=collection_archive---------25-----------------------#2021-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e1a2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在分析数据时，我们可能需要重塑表格数据。Pandas有两种方法可以帮助将数据重新整形为所需的格式。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2eebd5b0d23593c988c4fc08cde7b9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3B7uy7EftcBIe5vzvsSWw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">米利安·耶西耶在<a class="ae kv" href="https://unsplash.com/s/photos/data-analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="53a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Pandas有两种方法来重塑数据，即<strong class="ky ir">()</strong>和<strong class="ky ir">()</strong>。这些方法分别类似于R中“tidyr”包的gather()和spread()函数。我们将考虑公司报告格式的资产负债表。资产负债表存储在名为“df”的pandas数据框架中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/5746657b5ed89076a723f0a4193f8130.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*2Npua8lqQlzu8z-seK2hzA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="5b1e" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">融化()</h1><p id="a32f" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">此方法将表格数据平面化/融合，以便将指定的列及其各自的值转换为键值对。“键”是转换前数据集的列名，“值”是相应列中的值。默认情况下，转换后，“键”存储在名为“变量”的列中，“值”存储在另一个名为“值”的列中。</p><p id="48a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这可能看起来有点混乱，开始时我也遇到过。然而，一旦我们看一个例子，事情就变得简单了。让我们把之前看到的资产负债表拉平/融化。最初，我们将调用带有默认参数的melt()方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/1e30bece15c9ddfd36cea3c52736aa40.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*oJ35HodMbs3j31gZSS5smQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="5fb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如前所述，数据帧的列被转换成键值对。这种格式可能没有用，所以，让我们看一个例子，其中“细节”列保持不变，相关的年度数据作为键值对出现在相邻的列中。在这种情况下,“细节”列称为“id”列，应该传递给melt()方法的“id_vars”参数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/06f9078fa0b4ae9d05fa77d71da065f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*LKR2PTJzrWSAYTQg-bkAcg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="2486" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了“细节”列(传递给“id_vars”参数)之外，所有其他列都被转换为键值对。我们还可以指定一个列列表，将这些列视为“id”列。我们可以使用' var_name '和' value_name '参数重命名' value '和' variable '列，如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/51ddd18a9b3157f1aa16840378ddeae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*ZI1GG3_SWfLls07ccz439w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7b51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们在Excel中分析数据时，这种格式会很有用。这种格式使得在Excel中构建数据透视表更加容易。</p><h1 id="3451" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">透视()</h1><p id="2c27" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这个方法与melt()所做的正好相反。它将键值对转换成列。让我们看一个将“df_melt”(如下所示)转换回原始格式的例子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/51ddd18a9b3157f1aa16840378ddeae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*ZI1GG3_SWfLls07ccz439w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">df_melt(图片由作者提供)</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/c3b5e6e94a6b6c86864b88daa39ad36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*wF3XYgMd4dWN98X_WkFtzg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="0837" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">melt()和pivot()是将表格数据转换成所需格式时很方便的两种方法。melt()将列转换为键值对，而pivot()将键值对转换为列。</p></div></div>    
</body>
</html>