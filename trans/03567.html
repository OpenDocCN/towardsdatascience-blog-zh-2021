<html>
<head>
<title>Why you should monitor your pictures’ sharpness when deploying Computer Vision models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么在部署计算机视觉模型时应该监控图片的清晰度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-you-should-monitor-your-pictures-sharpness-when-deploying-computer-vision-models-1e039c7aa08a?source=collection_archive---------47-----------------------#2021-03-22">https://towardsdatascience.com/why-you-should-monitor-your-pictures-sharpness-when-deploying-computer-vision-models-1e039c7aa08a?source=collection_archive---------47-----------------------#2021-03-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f6c8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">永久地评估你从一个设备上获得的图片的质量可能会帮助你保持一个健壮的模型而不是盲目的模型！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3e9126774cdae2e454391f64a9c015c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vb6OuGaQlTff5ZEW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">查理·伊根在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="a5f1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">听说过沸蛙综合症吗？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/7661986b2118bed8a5b6722733ef14c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dGfwkcSxbTb2Wyd8"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jacc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰克·汉密尔顿</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="c0c0" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果你把一只青蛙扔进一锅沸水中，它会很快跳出来！</p><p id="0b31" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">但是，如果你把青蛙放入冷水中，逐渐增加温度，青蛙会享受一会儿热水浴，不久，它就会毫无抵抗地让自己被煮死。</p><p id="229c" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们知道，当数据特征与用于训练模型的数据特征“轻微偏离”时，这同样适用于机器学习模型。</p><p id="4f8e" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><strong class="lu iu">这种现象被称为“畴变”。</strong></p><p id="a10c" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我最近遇到了一个有趣的域名迁移案例，我想分享一下，以及监控这种变化的潜在对策。</p><h1 id="3633" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">又一个失败了！</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/5ab6a2cc3c008e114f59bed8ec10d666.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/1*qpG7f29A219MfaHumUvJGw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">监控摄像头的延时拍摄(已剪辑)<br/>作者制作的动画</p></figure><p id="62dd" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">在左侧，您可以观察到由监控摄像机广播的图片的裁剪部分的50天时间推移。</p><p id="6ada" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">随着时间的推移，很容易发现由于灰尘沉积，照片变得多么模糊。</p><p id="32be" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">(注:我希望我能够分享整个图片，但由于明显的保密原因，我不能)</p><p id="4157" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">由于模型使用这一部分来推断制成品的一些特征，不用说，随着图片变得模糊，深度学习算法的性能开始缓慢下降，这可能比从清晰的图片到空白的图片更难检测(还记得青蛙的故事吗？).</p><p id="afc7" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">在其“模糊性”的顶峰，该部分几乎不提供任何信息(见下文)。</p><div class="kj kk kl km gt ab cb"><figure class="mq kn mr ms mt mu mv paragraph-image"><img src="../Images/07482917051694749bb43a912fc4fe09.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*ytQ1jEkgfxlmEakbjteZdg.jpeg"/></figure><figure class="mq kn mr ms mt mu mv paragraph-image"><img src="../Images/4db78a1d7b3078e3d9432d6a77337cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*9CGGrxSxV24UtkrXX0UOxA.jpeg"/></figure><figure class="mq kn mr ms mt mu mv paragraph-image"><img src="../Images/e0486039bf719260d19512acd64d214e.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*-KD3yQvvx6-GrQB_z9UP9w.jpeg"/><p class="ku kv gj gh gi kw kx bd b be z dk mw di mx my translated">同一区域的不同清晰度/模糊度级别—图片由作者提供</p></figure></div><h1 id="ea5f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">我们如何评价一张照片的清晰度？</h1><p id="9673" class="pw-post-body-paragraph ls lt it lu b lv mz ju lx ly na jx ma mb nb md me mf nc mh mi mj nd ml mm mn im bi translated">因此，在这种特殊情况下，当摄像机提供的图片开始超过预定义的清晰度阈值并需要清洁时，提醒车间人员可能会很有意思。</p><p id="c658" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">唯一的问题是我们如何评估它？</p><p id="3b19" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">您可能知道，图片被编码成n维数组(1层用于灰度图片，3层用于RGB图片)。如果你对这个概念不放心，我向你推荐这篇文章:</p><div class="ne nf gp gr ng nh"><a rel="noopener follow" target="_blank" href="/better-visualizing-tensors-thanks-to-cities-b97e6b4ca2ca"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">由于城市，更好地可视化张量！</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">当然，很容易看出标量、向量或矩阵是什么样子！但是当涉及到n维数组时，我们的…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">towardsdatascience.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ks nh"/></div></div></a></div><p id="12f2" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">例如，对于表格数据集，我们可以监控每个特征的统计特征(最小值、最大值、平均值、标准偏差等。)但是我们可以在下面看到，使用这些指标并不能让我们区分上面的3张图片:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="2686" class="ob la it nx b gy oc od l oe of">Image_0: Min:  69 | Mean : 146 | Max : 187<br/>Image_1: Min: 107 | Mean : 155 | Max : 192<br/>Image_2: Min: 107 | Mean : 151 | Max : 181</span><span id="96b4" class="ob la it nx b gy og od l oe of">Image_0: Min:  #1 | Mean :  #1 | Max :  #2<br/>Image_1: Min:  #3 | Mean :  #3 | Max :  #3<br/>Image_2: Min:  #3 | Mean :  #2 | Max :  #1</span></pre><p id="52fd" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><em class="mo">(文末链接源代码)</em></p><p id="49f3" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">然而，我们可以假设，当照片变得模糊时，每个像素之间的数值距离开始减小。</p><p id="0b6e" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如下所示，当像素值与其周围的差异增加时，锐度将会更高:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/4fe6e2051b3adb1f9464b4f75c00e94f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*C6NTVfoPIduAoVm36giIyg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者对两种不同灰度图像的清晰度比较</p></figure><h1 id="1570" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">救援的梯度！</h1><p id="9d51" class="pw-post-body-paragraph ls lt it lu b lv mz ju lx ly na jx ma mb nb md me mf nc mh mi mj nd ml mm mn im bi translated">因此，我们需要找到一种方法来计算图片中从一个像素到另一个像素的变化。</p><p id="9811" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">当我们根据以x为中心的轴绘制变化时，模糊图形和清晰图形之间的差异是显而易见的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/dd5de2c60b63e4fec809bb2bcfface38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*a7MKOB8KvYdKmcw46xbAAQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">围绕x中心轴的两个图形的锐度比较—图片由作者提供</p></figure><p id="7c4f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果你之前一直在学习机器学习，那么你一定很熟悉梯度计算。基本上，这是所研究的函数在特定位置的导数(这对于定义成本函数的最优值非常有用)。</p><p id="3769" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><strong class="lu iu">我们如何计算梯度呢？当然，有一个NumPy函数可以做到这一点，但我很乐意提供它背后的解释！</strong></p><p id="b245" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">让我们以三个不同但简单的阵列为例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/8b459dab22ddd1ef1c67548277c553ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*FGGMlT64IwlStaN59UuwyQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">三个简单的3x3阵列，具有不同的数字组织—图片由作者提供</p></figure><p id="0e65" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">让我们取随机数组的第一行:1，3，0，并考虑一个线性函数(y=θx)允许从一个像素到另一个像素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/39d815b05df4f22158faa4e928484d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*vIcD8jlClJU2F8DM5OByrg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者对[1，3，0]矢量图像的梯度计算</p></figure><ul class=""><li id="8f35" class="ok ol it lu b lv lw ly lz mb om mf on mj oo mn op oq or os bi translated">从1到3，函数是“y = 2x”，它的导数是“2”。</li><li id="4c64" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated">从3到0，函数为“y = -3x”，其导数为“-3”。</li><li id="dc1d" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated">在3处，梯度是前一个和后一个梯度的平均值:“-0.5”(=(2–3)/2)。</li></ul><p id="7f77" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">让我们将这些值与峰值最高的“正常”数组的第二行进行比较:</p><ul class=""><li id="2526" class="ok ol it lu b lv lw ly lz mb om mf on mj oo mn op oq or os bi translated">从1到5，函数是“y = 4x”，它的导数是“4”。</li><li id="ce04" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated">从5到1，函数是“y = -4x”，它的导数是“-4”。</li><li id="77ad" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated">值为5时，渐变将是前一个和后一个渐变的平均值，因此为“0”(=(4–4)/2)。</li></ul><p id="bf81" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">让我们平均这些梯度的绝对值:</p><ul class=""><li id="2a54" class="ok ol it lu b lv lw ly lz mb om mf on mj oo mn op oq or os bi translated">[1，3，0]:(| 2 |+|-0.5 |+|-3 |)/3 =<strong class="lu iu">1.83</strong></li><li id="ce14" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated">[1，5，1]:(| 4 |+| 0 |+|-4 |)/3 =<strong class="lu iu">2.67</strong></li></ul><p id="fd1f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">结论:二线似乎更“犀利”！</p><p id="d811" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">并且，通过平均两个轴(x和y)周围的所有梯度，我们得到以下结果:</p><ul class=""><li id="47a7" class="ok ol it lu b lv lw ly lz mb om mf on mj oo mn op oq or os bi translated">零点数组:<strong class="lu iu"> 0 </strong>(这里不奇怪！)</li><li id="297a" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated">随机数组:<strong class="lu iu"> 1.89 </strong></li><li id="b03b" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated">“正常”数组:<strong class="lu iu"> 2.67 </strong></li></ul><h1 id="2efb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">我们去大的！</h1><p id="caa8" class="pw-post-body-paragraph ls lt it lu b lv mz ju lx ly na jx ma mb nb md me mf nc mh mi mj nd ml mm mn im bi translated">既然你理解了“为什么”和“如何”，我们可以从延时拍摄的照片中迭代，看看是否有我们可以研究的模式。这段时间从1月19日到3月1日。</p><p id="702b" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">车间团队可以在他们的控制屏幕上监控摄像机的清晰度，因此他们决定在此期间的某个时候清洗摄像机。我们能发现它吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/9a6f9340b70662d420f54dce0816b19a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwCQ3nzjHonnxJQOoIlBjw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">梯度平均值从2001年19月变为2003年1月—图片由作者提供</p></figure><p id="5ba6" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">清洗发生在指数64到65之间！很容易，因为我们看到梯度平均值(=锐度)从0.8增加到1.4。</p><p id="d1d9" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">现在我们可以定义一个阈值(0.9或者1呢？)系统地警告团队，并要求他们清洁相机以保存高质量的照片😀</p><p id="d22c" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">像往常一样，您会找到相应材料的链接:</p><ul class=""><li id="ba51" class="ok ol it lu b lv lw ly lz mb om mf on mj oo mn op oq or os bi translated"><a class="ae ky" href="https://drive.google.com/drive/folders/1KeaiExDBvQz8xUcQvJxBf9G1mebwzjck?usp=sharing" rel="noopener ugc nofollow" target="_blank">样图</a></li><li id="db47" class="ok ol it lu b lv ot ly ou mb ov mf ow mj ox mn op oq or os bi translated"><a class="ae ky" href="https://colab.research.google.com/drive/1v8Nx4LOo4mjqriwgzeFdUSNPlYd_Uuk5?usp=sharing" rel="noopener ugc nofollow" target="_blank">源代码</a></li></ul><p id="c1be" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">不要犹豫，在评论中分享你的经验或自己的做法吧！</p><p id="845a" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">皮埃尔-路易</p><div class="ne nf gp gr ng nh"><a href="https://pl-bescond.medium.com/pierre-louis-besconds-articles-on-medium-f6632a6895ad" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">皮埃尔-路易·贝斯康德关于媒介的文章</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">数据科学、机器学习和创新</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">pl-bescond.medium.com</p></div></div><div class="nq l"><div class="oz l ns nt nu nq nv ks nh"/></div></div></a></div></div></div>    
</body>
</html>