<html>
<head>
<title>3 Keras Design Patterns Every ML Engineer Should Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个ML工程师都应该知道的3个Keras设计模式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-keras-design-patterns-every-ml-engineer-should-know-cae87618c7e3?source=collection_archive---------6-----------------------#2021-07-09">https://towardsdatascience.com/3-keras-design-patterns-every-ml-engineer-should-know-cae87618c7e3?source=collection_archive---------6-----------------------#2021-07-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b231" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">机器学习工程师也有自己的设计模式！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6bb62657c2fc42fdc4bf47a4909d5437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IL3Wzf_O3hndOtuZVzPPzg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@alicegrace?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">爱丽丝·迪特里希</a>在<a class="ae ky" href="https://unsplash.com/s/photos/design?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="12ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Keras是一个建立在TensorFlow之上的机器学习(ML)库，使得创建和适应深度学习模型架构变得极其容易。正如他们喜欢说的，“Keras API是为人类设计的，而不是为机器设计的。”</p><p id="d282" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是事实！如果你想快速勾画出一个想法，Keras是这项工作的工具。然而，Keras可以非常灵活和强大；你可以逐渐剥离复杂的层次，深入定制几乎每一个小细节。</p><p id="77b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，由于其TensorFlow支持的后端，Keras可以利用多GPU配置或TPU训练。</p><p id="2033" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个故事中，我们研究了三种主要的Keras设计模式。我们将首先构建一个简单的序列模型。然后我们将扩展我们的实现来支持非顺序用例。最后，我们将更深入地通过子类化Keras <code class="fe lv lw lx ly b">Model</code>类来创建和执行我们自己的训练循环。开始吧！</p><blockquote class="lz ma mb"><p id="7c9c" class="kz la mc lb b lc ld ju le lf lg jx lh md lj lk ll me ln lo lp mf lr ls lt lu im bi translated"><a class="ae ky" href="https://www.dimpo.me/newsletter?utm_source=medium&amp;utm_medium=article&amp;utm_campaign=keras_design_patterns" rel="noopener ugc nofollow" target="_blank">学习率</a>是为那些对AI和MLOps的世界感到好奇的人准备的时事通讯。你会在每周五收到我关于最新人工智能新闻和文章的更新和想法。订阅<a class="ae ky" href="https://www.dimpo.me/newsletter?utm_source=medium&amp;utm_medium=article&amp;utm_campaign=keras_design_patterns" rel="noopener ugc nofollow" target="_blank">这里</a>！</p></blockquote><h1 id="a538" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">像箭一样直</h1><p id="34b3" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">为了展示Keras的威力，我们需要一个运行的例子。为此，我们将使用“<em class="mc"> Hello world </em>”计算机视觉的例子，即MNIST数据集。我知道，我知道……MNIST的问题现在很无聊，但是我们试图让事情变得简单，这样我们就可以专注于重要的事情:代码。</p><p id="052f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将使用序列模型求解MNIST。这再简单不过了。从现在开始，遵循本文的最佳方式是启动Google Colab笔记本，并将运行时改为支持GPU的运行时。</p><p id="6361" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第一个代码单元格中，提供导入语句:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="f569" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，让我们加载并准备数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e745" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们准备构建我们的模型。Keras sequential API可以毫不费力地构建一个深度学习模型，它的工作方式很像一条开放的高速公路；我们通过一系列直接的层来输入数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cda4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，您所要做的就是编译模型，拟合它，并在测试数据集上评估它。广义编译意味着提供损失函数、优化器和您关心的指标。完成这一步后，你就可以开始训练了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="884f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅此而已！经过15个时期后，我在测试数据集上获得了<code class="fe lv lw lx ly b">0.9912</code>的准确度。不错，但我相信你不会感到惊讶。毕竟，MNIST任务被认为是已经解决的。</p><h1 id="6b50" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">功能API</h1><p id="abcf" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">但是如果你不能用一系列的层来解决你的问题呢？如果您需要执行单独计算的分支，并且模型将它们的结果合并到一起，那该怎么办？然后，是时候使用Keras功能API了。</p><p id="ee2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们将输入通过两个具有不同特性的不同卷积层，然后合并它们的输出。不，对于MNIST问题来说，这不是真的有必要，但我们会假装有必要。</p><p id="e485" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了实现这一切，我们只需要更新模型创建步骤:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2df6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过15个时期后，我在测试数据集上获得了<code class="fe lv lw lx ly b">0.9919</code>的准确度。然而，你不能真的说这个模型更好或更差。这只是一个玩具的例子！</p><h1 id="97e5" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">子类</h1><p id="a447" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">现在是时候拿出大枪了。一些工程师需要知道<code class="fe lv lw lx ly b">fit</code>函数内部发生了什么，并控制一切。Keras提供了子类化API，您可以使用它创建自己的模型类，并完全定制训练步骤。</p><p id="8d10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要创建数据集:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="dab2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，创建我们的模型。这与我们在顺序API部分中使用的模型相同:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8634" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要创建我们的培训和测试步骤:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2b2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们将所有东西放在一起，构建我们的培训循环:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="6708" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过15个时期后，我在测试数据集上获得了<code class="fe lv lw lx ly b">0.9910</code>的准确度。这是一个总结！</p><h1 id="5d27" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="f2d9" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">Keras是一个建立在TensorFlow之上的机器学习(ML)库，使得创建和适应深度学习模型架构变得极其容易。正如他们喜欢说的，“Keras API是为人类设计的，而不是为机器设计的。”</p><p id="02e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Keras提供了三种主要方法来解决您的ML任务:</p><ul class=""><li id="9de3" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">顺序API</li><li id="dd35" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">功能API</li><li id="6281" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">Keras子类化方法</li></ul><p id="92dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每一项技术都让我们对低层次张量流更深入一步。通常，顺序的和功能的API解决了我们99%的问题，但是一个好的ML工程师应该了解每一个设计模式。</p><h1 id="15c0" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">关于作者</h1><p id="00ad" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我的名字是<a class="ae ky" href="https://www.dimpo.me/?utm_source=medium&amp;utm_medium=article&amp;utm_campaign=keras_design_patterns" rel="noopener ugc nofollow" target="_blank">迪米特里斯·波罗普洛斯</a>，我是一名为<a class="ae ky" href="https://www.arrikto.com/" rel="noopener ugc nofollow" target="_blank">阿里克托</a>工作的机器学习工程师。我曾为欧洲委员会、欧盟统计局、国际货币基金组织、欧洲央行、经合组织和宜家等主要客户设计和实施过人工智能和软件解决方案。</p><p id="f935" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣阅读更多关于机器学习、深度学习、数据科学和数据运算的帖子，请在Twitter上关注我的<a class="ae ky" href="https://towardsdatascience.com/medium.com/@dpoulopoulos/follow" rel="noopener" target="_blank"> Medium </a>、<a class="ae ky" href="https://www.linkedin.com/in/dpoulopoulos/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae ky" href="https://twitter.com/james2pl" rel="noopener ugc nofollow" target="_blank"> @james2pl </a>。</p><p id="c691" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所表达的观点仅代表我个人，并不代表我的雇主的观点或意见。</p></div></div>    
</body>
</html>