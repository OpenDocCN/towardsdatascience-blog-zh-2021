<html>
<head>
<title>Add a Customized Rasa Chatbot for Your Facebook Page</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的脸书页面添加自定义的Rasa聊天机器人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/add-a-customized-rasa-chatbot-for-your-facebook-page-9313687fbdcb?source=collection_archive---------34-----------------------#2021-07-27">https://towardsdatascience.com/add-a-customized-rasa-chatbot-for-your-facebook-page-9313687fbdcb?source=collection_archive---------34-----------------------#2021-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="73a7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为您的脸书页面设置Rasa聊天机器人的简单演练</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/656ad87e08b34c04b3180d96f8aa3f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PQutB_Fxuf7CNiev"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">沃洛季米尔·赫里先科在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="05fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在过去的十年里，聊天机器人，或者更正式地称为虚拟助手，已经成为收集和传播信息的流行选择。此外，将这些聊天机器人集成到不同的社交媒体平台和网站的能力使其成为一种可行和方便的通信选择。</p><p id="86f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，脸书是最受欢迎的社交媒体平台之一，它已经成为宣传个人和合作企业的重要舞台。并且将定制的聊天机器人集成到脸书页面中可以导致页面访问量的增加和来自用户的愉快的交互。这个简化的分步教程将指导您完成Rasa安装、设置开发环境以及与脸书页面的集成。最重要的是，<strong class="ky ir">这个程序不包含任何付费工具或软件</strong>。所以让我们进入教程。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6298" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">设置Rasa</h1><h2 id="6bf4" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">安装Python</h2><p id="6cba" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">首先，你必须安装Python。您可以安装从3.6到3.9的任何版本。请注意，3.6版本将在2021年底停止支持。3.9是通常的选择，但是如果你已经安装了上面提到的3个版本中的一个，一切都会好的。这里 可以从<a class="ae kv" href="https://www.python.org/downloads/windows/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">安装Python for Windows。如果能通过Windows installer安装Python，并且<strong class="ky ir">确保在安装时勾选“将Python *version*添加到路径”选项，那就更好了。</strong></strong></a></p><h2 id="96cd" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">选择IDE</h2><p id="1bba" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">IDE有许多可行的选择，但我个人更喜欢VS代码。但是您可以使用大多数可用的流行ide。你可以从<a class="ae kv" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里</strong> </a>下载Visual Studio代码。</p><h2 id="ad91" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">设置虚拟环境</h2><p id="d52f" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">首先，创建一个文件夹，您将在其中创建Rasa项目。现在打开命令提示符，使用<strong class="ky ir">‘CD’</strong>选项进入创建的文件夹。此外，你可以通过在文件浏览器中打开你创建的文件夹，然后在地址栏中键入<strong class="ky ir">‘cmd’</strong>并按回车键。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/cef8a0f7838bbf7ac3c6033e870c58ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPKRDiqo84dg6-6KLHwVWw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图1:在目标文件路径打开命令提示符的另一种方法(图片由作者提供)</p></figure><p id="ceed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在打开相关文件夹地址的命令提示符后，您可以键入<strong class="ky ir">代码。</strong>在给定的目标地址打开VS代码IDE。此快捷方式仅适用于Windows上的VS代码IDE。对于其他IDE和OS，您必须手动打开IDE终端并浏览到创建的文件夹。</p><p id="5e74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果你正在使用VS代码，你必须去<strong class="ky ir">终端标签&gt;新终端</strong>打开一个新终端。之后，你可以使用命令<strong class="ky ir">Python-m venv简单地创建一个虚拟环境。/venv' </strong>。</p><p id="659d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建虚拟环境后，您可以使用命令<strong class="ky ir">激活虚拟环境。\venv\Scripts\activate' </strong>。</p><h2 id="d9ce" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">安装Rasa和其他必要的组件</h2><p id="4de0" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">现在，我们将在虚拟环境中安装一些组件，包括Rasa。首先，我们必须得到<strong class="ky ir"> pip </strong>，它是Python包的包管理器。您可以使用<strong class="ky ir"> 'python get-pip.py' </strong>命令安装pip。之后，通过使用pip，我们可以下载并安装Rasa。使用<strong class="ky ir">‘pip 3安装rasa’</strong>。安装需要几分钟时间。</p><h2 id="b914" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">创建Rasa项目</h2><p id="504e" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">在您创建的主文件夹中创建一个子文件夹。这个新文件夹是我们创建Rasa项目的地方。您可以通过文件浏览器或VS代码本身来实现这一点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/ea5068ef047440ce4424ba64bb64c52f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*grWBqGLd9IfafdYvtwoEXg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图2:为Rasa项目创建一个新文件夹(图片由作者提供)</p></figure><p id="3804" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在使用<strong class="ky ir">‘CD * folder name *’</strong>命令进入新创建的文件夹。之后，您可以输入命令<strong class="ky ir">‘rasa init’</strong>在给定的文件夹中创建新的rasa项目。这也需要几分钟时间。创建项目时会有一些提示，你可以根据你的目标来回复它们。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e2c4" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">与脸书融合</h1><h2 id="a4a1" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">设置脸书应用程序</h2><p id="5115" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">首先，你必须建立一个脸书应用程序。前往开发者的<a class="ae kv" href="https://developers.facebook.com/" rel="noopener ugc nofollow" target="_blank">脸书</a>，进入右上角的<strong class="ky ir">“我的应用”</strong>标签。使用脸书帐户登录，该帐户用于创建您计划集成聊天机器人的页面。点击<strong class="ky ir">“创建应用”</strong>按钮，选择<strong class="ky ir">“业务”</strong>作为应用类型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/e8b6ea43607dc13c6aeaa799c4b3c5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mg7t771WGT2C6DJ5_8aV4w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图3:点击<strong class="bd nl">创建应用</strong>按钮(图片由作者提供)</p></figure><p id="543b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加应用程序显示名称，并选择<strong class="ky ir">“你自己或你自己的生意”</strong>，然后点击<strong class="ky ir">“创建应用程序”</strong>。</p><p id="47d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在向下滚动，在产品列表中找到messenger，点击<strong class="ky ir">“设置”</strong>。现在在<strong class="ky ir">访问令牌</strong>部分，点击<strong class="ky ir">‘添加或删除页面’</strong>按钮，添加你想要聊天机器人进入的脸书页面。保持启用<strong class="ky ir">管理和访问Messenger中的页面对话</strong>属性并继续。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/027367f233bf196bfb34a39a607c9053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OYDwOwV6VmxdJfmntZzYaw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图4:将脸书页面添加到应用程序后(图片由作者提供)</p></figure><h2 id="4f2b" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">更新Rasa项目</h2><p id="8a9a" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">现在，我们必须做一些调整，将脸书应用程序与我们新创建的Rasa项目链接起来。为此，请浏览Rasa项目中的<strong class="ky ir">credit initials . yml</strong>文件。打开文件，找到脸书的位置，取消对该代码块的注释。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/1e355d8790775ff3e0043e434db93eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ub0WhJT2NcIyfA3f4yLs4A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图5:<strong class="bd nl">credentials . yml</strong>文件(图片由作者提供)</p></figure><p id="e98c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你必须返回到脸书应用程序来获取你的<strong class="ky ir"> &lt;秘密&gt; </strong>和<strong class="ky ir"> &lt;你的页面访问令牌&gt; </strong>，然后将它们填入<em class="no">credentials . yml</em>文件中。在脸书应用程序中，在我们链接脸书页面的访问令牌部分(图5)下，单击“生成令牌”按钮。复制这个长令牌并替换<em class="no">creditinitials . yml</em>文件中的<strong class="ky ir"> &lt;页面访问令牌&gt; </strong>标签。</p><p id="f459" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，进入左侧菜单中的<strong class="ky ir">设置&gt;基本</strong>，你将能够找到一个带有标签<strong class="ky ir">‘App Secret’</strong>的加密字段。这将<strong class="ky ir"> &lt;你的秘密&gt; </strong>放在<em class="no">credentials . yml</em>文件中。复制<strong class="ky ir"> App Secret </strong>，替换<strong class="ky ir"> &lt; your secret &gt; </strong>标签。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/0a75e0e41b4c954776cb1b24f87dd990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSO_1ew6vbeIQe4L1x1TAQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图7:<strong class="bd nl">App秘密</strong>(图片由作者提供)</p></figure><p id="e425" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于<strong class="ky ir"> &lt;验证&gt; </strong>字段，您可以添加一个字符串作为设置webhook时的验证令牌，因此您可以键入任何您想要的字符串。</p><p id="a92a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，打开Rasa项目中的<strong class="ky ir"> 'endpoints.yml' </strong>文件，取消对提到<strong class="ky ir"> action_endpoint </strong>的代码块的注释。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/44e539d22d877e52ab6409086d94b486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sBRiuSsZKouJdJQyj0u_A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图8 : <strong class="bd nl"> endpoints.yml </strong>文件(图片由作者提供)</p></figure><p id="4438" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保存在<em class="no">credit initials . yml</em>和<em class="no"> endpoints.yml </em>文件中所做的更改，并重启Rasa服务器。你可以用<strong class="ky ir"> Ctrl+C </strong>停止服务器，用<strong class="ky ir">‘rasa run’</strong>命令启动服务器。</p><h2 id="a2c6" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">用ngrok设置Webhook</h2><p id="287a" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">首先，你得<a class="ae kv" href="https://ngrok.com/download" rel="noopener ugc nofollow" target="_blank">下载<strong class="ky ir">ngrok</strong>T3。ngrok是一个跨平台的应用程序，它允许将本地开发服务器暴露给互联网。下载并解压缩到您计算机上的任何位置。在继续之前，您必须打开代码IDE，并检查Rasa项目正在哪个本地端口上运行。你可以在<strong class="ky ir">‘rasa run’</strong>命令后的细节中找到。我的是5005端口。确认端口后，打开<strong class="ky ir">ngrok.exe</strong>文件，输入<strong class="ky ir">‘ngrok http *端口号*’</strong>。这将把提到的本地端口暴露给互联网。通常，会话应限制在2小时内，这意味着2小时后应重新建立连接，并且转发URL将被更改。您可以在</a><a class="ae kv" href="https://ngrok.com/" rel="noopener ugc nofollow" target="_blank">ngrok.com</a>创建一个免费帐户，并通过使用为创建的免费帐户提供的身份验证令牌来取消会话时间限制。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/b9aa2c3696f2ffef691850c696d95415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bmzH7OQD2yKD48CrlLtokQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图9 : ngrok连接状态(图片由作者提供)</p></figure><p id="6d7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有两个转发网址。你必须复制带有<strong class="ky ir">‘https’</strong>的网址。对我来说就是<strong class="ky ir">' https://BD 0 BCB 258 fc 2 . ngrok . io '</strong>。现在进入脸书应用程序，进入左侧菜单中的<strong class="ky ir">信使&gt;设置</strong>。在<strong class="ky ir"> Webhooks </strong>部分下(在<strong class="ky ir">访问令牌</strong>部分的正下方)，点击<strong class="ky ir">‘添加回调URL’</strong>按钮。对于回调URL，你要粘贴复制的URL，格式为:<strong class="ky ir">*复制的URL */web hooks/Facebook/web hook</strong>。以及<em class="no">creditinitials . yml</em>文件的<strong class="ky ir"> &lt;验证&gt; </strong>字段中的<strong class="ky ir">验证令牌</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/8db5d8cbfcc1ee42d89a971357d897b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqsb8vnNWWXL6ihXCo_KpQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图10:添加回调URL(作者图片)</p></figure><p id="f153" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加以上两个字段后，您可以点击<strong class="ky ir">‘验证并保存’</strong>，如果Rasa服务器和ngrok连接都已启动并运行，它将正常工作。成功验证后，您将能够看到您的脸书页面出现在Webhooks部分，webhooks字段为空。点击<strong class="ky ir">编辑</strong>按钮，添加<strong class="ky ir">‘消息传递’</strong>和<strong class="ky ir">‘消息传递_回发’</strong>订阅字段。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/a97b7baaae7f2415542dd567869ad154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lKYcL3Gmn-Xn6lEPz144oQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图11:编辑页面订阅(作者图片)</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="5bb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成这些步骤后，您将能够使用创建该页面的帐户登录脸书，并与该页面的集成聊天机器人聊天。如果你也想允许其他几个人聊天，你必须将他们添加为你的脸书应用的测试者，方法是在脸书应用页面的左侧菜单中进入<strong class="ky ir">角色&gt;角色</strong>。他们还必须注册脸书开发者账户才能接受邀请，并继续测试该页面的聊天机器人。</p><p id="e5e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你所要做的就是通过Rasa项目按照你需要的方式定制聊天机器人。如果你不了解Rasa的发展，可以在网上找到很多正规聊天机器人的代码库。如果你这样做了，你可以根据你的愿望定制聊天机器人，最后，你可以提交你的应用程序进行审查，一旦通过，脸书的任何人都可以使用你定制的聊天机器人页面！</p><p id="db5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个整合过程中，我确实遇到了很多问题，这也是我觉得以一种简化的循序渐进的方式写这篇文章的主要原因。因此，您可以随时删除您在此过程中遇到的任何其他错误，希望我能够助您一臂之力。编码快乐！注意安全！</p></div></div>    
</body>
</html>