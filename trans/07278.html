<html>
<head>
<title>Learn you a Kedro*</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学你一个凯卓*</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-you-some-kedro-be67d4fc0ce7?source=collection_archive---------6-----------------------#2021-07-02">https://towardsdatascience.com/learn-you-some-kedro-be67d4fc0ce7?source=collection_archive---------6-----------------------#2021-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a5d4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">编写可复制、可维护和模块化的数据科学代码</h2></div><p id="ca73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">*向</em> <a class="ae lc" href="http://learnyouahaskell.com/chapters" rel="noopener ugc nofollow" target="_blank"> <em class="lb">致敬，学你一个哈斯克尔好了！</em></a><em class="lb"/></p><p id="5724" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">拿杯咖啡坐下。这是一个很长的帖子！</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/a8af44495872a07ad9e72e454e8b4ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4cQ6A3FFKNNpeQeObcVBg.jpeg"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">https://flic.kr/p/d9KiHk，段丽阳·本田在Flickr上的拿铁艺术(CC BY-SA 2.0)</p></figure><p id="b09f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将介绍Kedro，这是一个开源的Python框架，用于创建可复制、可维护和模块化的数据科学代码。在简要描述了它是什么以及为什么它可能成为每个数据科学家工具链的标准部分之后，我描述了一些技术性的Kedro概念，并通过一个教程说明了如何使用它们。</p><blockquote class="lt lu lv"><p id="9c5f" class="kf kg lb kh b ki kj jr kk kl km ju kn lw kp kq kr lx kt ku kv ly kx ky kz la ij bi translated">总的来说，你应该能够在30分钟内阅读并消化这篇文章。但是使用Kedro的好处将会持续你的职业生涯。</p></blockquote><p id="64fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设你是一名数据科学家，为一名为公司做出关键财务决策的高管工作。她请你提供一个特别的分析，当你这样做时，她感谢你为她的计划提供了有用的见解。太好了！</p><p id="98f1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">三个月后，新晋升的主管，现在是你的首席执行官，要求你在下一次计划会议上重新运行分析…而你不能。代码被破坏是因为您覆盖了文件的一些关键部分，并且您不记得当时使用的确切环境。或者，代码可能是好的，但它在一个大的Jupyter笔记本中，所有文件路径都是硬编码的，这意味着您必须费力地检查和更改每一个新数据输入。哎呀！那不太好！</p><p id="5efd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它发生了。可能比应该的更频繁。当它发生时，通常的说法是最初的项目没有被规划到一个高标准，因为它不是为生产系统设计的。</p><p id="87fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是……任何支持业务决策过程的代码都应该被认为是生产代码！</p><p id="7a80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，如果你是一名数据科学家，你可能不认为你工作的主要产出是代码。但是你的项目仍然使用代码，为什么不利用软件工程师来之不易的经验呢？希望您的项目至少具备以下特征:</p><ul class=""><li id="687a" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated"><strong class="kh ir">它应该被版本化</strong>——使用<a class="ae lc" href="http://rogerdudler.github.io/git-guide/" rel="noopener ugc nofollow" target="_blank"> git </a>或类似的工具定期保存您的更改，无论您是独自工作还是在团队中工作。</li><li id="8aa1" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><strong class="kh ir">它应该是可复制的</strong>——你应该能够将一个项目转移到另一台计算机上，然后毫不费力地运行它。</li><li id="e014" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><strong class="kh ir">它应该遵循标准</strong>——坚持通用的项目结构、标准的编码约定和工具，以便未来的协作和更好的团队合作。</li><li id="81fe" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><strong class="kh ir">它应该被记录</strong> —使用自动化文档来保持你的文档与你的代码保持同步。</li><li id="508f" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><strong class="kh ir">它应该是模块化的</strong>——代码可以很容易地执行和测试。</li></ul><p id="bb86" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于这些原则的更多细节，请看Thomas Huijskens的一篇有用的博客文章。</p><h1 id="d3f7" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">介绍Kedro</h1><p id="9f22" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">Kedro帮助您创建可复制、可维护和模块化的数据科学代码。它从软件工程中借用概念，并将它们应用到机器学习代码中；应用的概念包括模块化、关注点分离和版本控制。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nk nl l"/></div></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h1 id="4c26" class="mn mo iq bd mp mq nt ms mt mu nu mw mx jw nv jx mz jz nw ka nb kc nx kd nd ne bi translated"><strong class="ak"> Kedro概念</strong></h1><p id="6deb" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">首先，让我们用一个传统的“Hello World”例子来研究Kedro的最基本的元素，这个例子被分成几个部分。你可以在Kedro词汇表中找到更多关于这些概念的信息。</p><h2 id="6605" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">节点</strong></h2><p id="a888" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">节点是Python函数的包装器，用于命名该函数的输入和输出。节点是管道的构建块，您可以链接它们，这样一个节点的输出就是另一个节点的输入。</p><p id="521b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里，一个名为<code class="fe ok ol om on b">return_greeting_node</code>的节点没有输入，只有一个输出(<code class="fe ok ol om on b">my_salutation</code>)。它封装了函数(<code class="fe ok ol om on b">return_greeting</code>):</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="c26e" class="ny mo iq on b gy os ot l ou ov"># Prepare first node<br/>def return_greeting():<br/>    return “Hello”</span><span id="87a7" class="ny mo iq on b gy ow ot l ou ov">return_greeting_node = node(func=return_greeting, inputs=None, outputs=”my_salutation”)</span></pre><p id="23ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里，名为<code class="fe ok ol om on b">join_statements_node</code>的第二个节点命名为单输入(<code class="fe ok ol om on b">my_salutation</code>)和单输出(<code class="fe ok ol om on b">my_message</code>)。它封装了函数(<code class="fe ok ol om on b">join_statements</code>):</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="5fe6" class="ny mo iq on b gy os ot l ou ov"># Prepare second node<br/>def join_statements(greeting):<br/>    return f”{greeting} Kedro!”</span><span id="e395" class="ny mo iq on b gy ow ot l ou ov">join_statements_node = node(join_statements, inputs=”my_salutation”, outputs=”my_message”)</span></pre><p id="3fa1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意<code class="fe ok ol om on b">my_salutation</code>是<code class="fe ok ol om on b">return_greeting_node</code>的<strong class="kh ir"> <em class="lb">输出</em> </strong>，也是<code class="fe ok ol om on b">join_statements_node</code>的<strong class="kh ir"> <em class="lb">输入</em> </strong>。</p><h2 id="c105" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">管道</strong></h2><p id="2307" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">Kedro管道组织了一组节点的依赖关系和执行顺序。在这个例子中，流水线在执行<code class="fe ok ol om on b">join_statements_node</code>之前执行<code class="fe ok ol om on b">return_greeting_node</code>:</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="46d0" class="ny mo iq on b gy os ot l ou ov"># Assemble nodes into a pipeline<br/>pipeline = Pipeline([return_greeting_node, join_statements_node])</span></pre><h2 id="4999" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">数据目录</strong></h2><p id="410b" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">Kedro <code class="fe ok ol om on b">DataCatalog</code>是项目可以使用的所有数据源的注册表。它将节点输入和输出的名称映射为一个<code class="fe ok ol om on b">DataSet</code>中的键，这是一个Kedro类，可以专门用于不同类型的数据存储。Kedro为简单存储在内存中的数据使用了一个<code class="fe ok ol om on b">MemoryDataSet</code>,它还为不同的文件类型和文件系统提供了<a class="ae lc" href="https://kedro.readthedocs.io/en/stable/kedro.extras.datasets.html#data-sets" rel="noopener ugc nofollow" target="_blank">不同的内置数据集</a>,因此您不必编写读/写数据的逻辑:</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="ed98" class="ny mo iq on b gy os ot l ou ov"># Prepare a data catalog<br/>data_catalog = DataCatalog({“my_salutation”: MemoryDataSet()})</span></pre><h2 id="c779" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">转轮</strong></h2><p id="0a9c" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">Runner是运行管道的对象。Kedro解析执行节点的顺序:</p><ol class=""><li id="0351" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la ox mf mg mh bi translated">Kedro首先执行<code class="fe ok ol om on b">return_greeting_node</code>。这将运行<code class="fe ok ol om on b">return_greeting</code>，它不接受任何输入，但输出字符串“Hello”。</li><li id="3bfb" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la ox mf mg mh bi translated">Kedro将输出字符串存储在名为<code class="fe ok ol om on b">my_salutation</code>的<code class="fe ok ol om on b">MemoryDataSet</code>中。</li><li id="f229" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la ox mf mg mh bi translated">Kedro然后执行第二个节点<code class="fe ok ol om on b">join_statements_node</code>。这会加载<code class="fe ok ol om on b">my_salutation</code>数据集并将其注入到<code class="fe ok ol om on b">join_statements</code>函数中。</li><li id="a978" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la ox mf mg mh bi translated">该函数用“Kedro！”加入输入的问候语以形成输出字符串“Hello Kedro！”</li><li id="bf07" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la ox mf mg mh bi translated">Kedro在字典中返回管道的输出，关键字为<code class="fe ok ol om on b">my_message</code>。</li></ol><h2 id="74b6" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated">你好，凯卓！</h2><p id="1e9c" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">现在是时候把所有东西缝合在一起了。以下是完整的示例:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oy nl l"/></div></figure><p id="bb74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您将这个示例放入一个文件，例如<code class="fe ok ol om on b">hello_kedro.py</code>，并在终端(<code class="fe ok ol om on b">python hello_kedro.py</code>)中运行它，您应该看到<code class="fe ok ol om on b">{‘my_message’: ‘Hello Kedro!’}</code>被打印到控制台。</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h1 id="bf78" class="mn mo iq bd mp mq nt ms mt mu nu mw mx jw nv jx mz jz nw ka nb kc nx kd nd ne bi translated"><strong class="ak">开始吧！</strong></h1><p id="97fe" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">现在你对这些概念有了一个基本的理解，为什么不安装Kedro并试用一下呢？大多数人从Kedro spaceflights教程开始，你可以在文档中找到，但为了简化它，我在下面创建了一个简短的版本。</p><p id="abd8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参考Kedro文档中的<a class="ae lc" href="https://kedro.readthedocs.io/en/stable/02_get_started/01_prerequisites.html" rel="noopener ugc nofollow" target="_blank">安装先决条件。准备好之后，运行以下命令从Python包索引(PyPI)安装:<code class="fe ok ol om on b">pip install kedro</code></a></p><p id="ef3f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查是否安装了Kedro:<code class="fe ok ol om on b">kedro info</code></p><p id="4c56" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您应该会看到一个ASCII艺术图形和Kedro版本号。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi oz"><img src="../Images/7128fda0d14e76e3522150982d1a4de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*Xu28FlwuVD6BZtihE-oBOA.png"/></div></div></figure><p id="5cdb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您没有看到显示的图形，或者您的安装有任何问题，请参见常见问题或<a class="ae lc" href="https://discord.com/invite/zBTyPeRN5R" rel="noopener ugc nofollow" target="_blank"> Kedro社区对Discord的支持</a>。更多信息，请查看关于安装Kedro 的<a class="ae lc" href="https://kedro.readthedocs.io/en/stable/02_get_started/02_install.html" rel="noopener ugc nofollow" target="_blank">文档。</a></p><h1 id="a0aa" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated"><strong class="ak"> Kedro spaceflights教程</strong></h1><p id="1f24" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">在本教程中，您将通过一个示例了解Kedro项目开发工作流的每个步骤，该示例为以下价格预测场景构建节点和管道:</p><p id="4af4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在是2160年，太空旅游业正在蓬勃发展。在全球范围内，有数千家航天飞机公司将游客送上月球并返回。你已经能够找到每架航天飞机提供的便利设施、顾客评论和公司信息。</p><p id="b7f2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">您想要构建一个模型来预测每次登月旅行以及相应的返程航班的价格。</em></p><blockquote class="lt lu lv"><p id="fe4a" class="kf kg lb kh b ki kj jr kk kl km ju kn lw kp kq kr lx kt ku kv ly kx ky kz la ij bi translated">Y <!-- -->您将需要大约20分钟来完成本教程，它使用Kedro starter为您创建spaceflights项目，然后遍历最重要的代码部分，将它们与您在上面学到的概念联系起来。</p></blockquote><h2 id="7cb0" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">设置项目</strong></h2><p id="9836" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">我们假设您已经安装了Kedro，如上所述。首先，使用<a class="ae lc" href="https://github.com/quantumblacklabs/kedro-starters/tree/master/spaceflights" rel="noopener ugc nofollow" target="_blank">Kedro starter for the space flights教程</a> : <code class="fe ok ol om on b">kedro new --starter=spaceflights</code>在您喜欢的工作目录中创建您的项目</p><p id="67cb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当您使用它时，您将拥有一个完整的工作项目，所有的代码和数据都已设置好并准备好运行。</p><p id="dc50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以随意命名你的项目，但是这里我们假设它叫做<strong class="kh ir"> Kedro教程</strong>。</p><p id="2551" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">出现提示时，保留repo_name ( <code class="fe ok ol om on b">kedro-tutorial</code>)和python_package ( <code class="fe ok ol om on b">kedro_tutorial</code>)的默认名称。</p><p id="ae39" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，使用Kedro安装特定于项目的依赖项。导航到项目的根目录并运行:<code class="fe ok ol om on b">kedro install</code></p><p id="53c4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Kedro管理您的项目的依赖项，使其他人更容易运行该项目。它避免了版本冲突:Kedro确保你们都使用相同的Python包和版本。你可以在Kedro文档中找到更多关于<a class="ae lc" href="https://kedro.readthedocs.io/en/stable/04_kedro_project_setup/01_dependencies.html" rel="noopener ugc nofollow" target="_blank">如何处理项目依赖关系的信息。</a></p><blockquote class="lt lu lv"><p id="ced0" class="kf kg lb kh b ki kj jr kk kl km ju kn lw kp kq kr lx kt ku kv ly kx ky kz la ij bi translated"><em class="iq">此时，您可以运行项目，看看会发生什么。因此，如果您想向前跳，请向下滚动到“测试管道”部分。</em></p></blockquote><h2 id="362d" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">设置数据</strong></h2><p id="f374" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">spaceflights教程使用了公司的虚拟数据集，将客户往返于月球。您将使用这些数据训练一个模型来预测班车租赁的价格。但是，在开始训练模型之前，您需要为模型构建准备数据。</p><p id="e2c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">航天教程有三个文件，使用两种数据格式:<code class="fe ok ol om on b">.csv</code>和<code class="fe ok ol om on b">.xlsx</code>。你会在你的项目目录的<code class="fe ok ol om on b">data/01_raw/</code>文件夹中找到原始数据:</p><ul class=""><li id="6f1b" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated"><code class="fe ok ol om on b"><a class="ae lc" href="https://quantumblacklabs.github.io/kedro/reviews.csv" rel="noopener ugc nofollow" target="_blank">reviews.csv</a></code></li><li id="d60b" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><code class="fe ok ol om on b"><a class="ae lc" href="https://quantumblacklabs.github.io/kedro/companies.csv" rel="noopener ugc nofollow" target="_blank">companies.csv</a></code></li><li id="85c7" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><code class="fe ok ol om on b"><a class="ae lc" href="https://quantumblacklabs.github.io/kedro/shuttles.xlsx" rel="noopener ugc nofollow" target="_blank">shuttles.xlsx</a></code></li></ul><p id="048f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据集需要注册，以便Kedro可以加载它们。所有Kedro项目都有一个<code class="fe ok ol om on b">conf/base/catalog.yml</code>文件，在示例中，您将看到starter在该文件中添加的每个数据集:</p><ul class=""><li id="6c5f" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated">文件位置(路径)</li><li id="a668" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">给定数据集的参数</li><li id="da84" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">数据类型</li><li id="f38a" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated">版本控制</li></ul><p id="4bd0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于<code class="fe ok ol om on b">csv</code>数据集:</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="55b5" class="ny mo iq on b gy os ot l ou ov">companies:<br/>type: pandas.CSVDataSet<br/>filepath: data/01_raw/companies.csv</span><span id="9e73" class="ny mo iq on b gy ow ot l ou ov">reviews:<br/>type: pandas.CSVDataSet<br/>filepath: data/01_raw/reviews.csv</span></pre><p id="a316" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于xlsx数据集:</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="b71e" class="ny mo iq on b gy os ot l ou ov">shuttles:<br/>type: pandas.ExcelDataSet<br/>filepath: data/01_raw/shuttles.xlsx</span></pre><p id="3a56" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要确认Kedro可以正确加载数据，请打开一个Kedro iPython会话(<code class="fe ok ol om on b">kedro ipython</code>)并运行以下命令:</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="ac86" class="ny mo iq on b gy os ot l ou ov">companies = catalog.load(“companies”)<br/>companies.head()<br/>shuttles = catalog.load(“shuttles”)<br/>shuttles.head()</span></pre><p id="28ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该命令加载每个数据集。pandas的head方法显示数据帧的前五行。</p><p id="0fa7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成后，关闭iPython会话:<code class="fe ok ol om on b">exit()</code></p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="b7fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将为项目设置两条模块化管道:</p><ul class=""><li id="3610" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated"><code class="fe ok ol om on b">data_processing_pipeline</code>预处理数据</li><li id="6357" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><code class="fe ok ol om on b">data_science_pipeline</code>创建特征，训练和评估模型。</li></ul><h2 id="abbc" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">数据处理模块流水线</strong></h2><p id="7d6b" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">让我们看一下用于预处理三个输入数据集以创建主表并为建模准备数据的示例节点。</p><p id="c71f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ok ol om on b">src/kedro_tutorial/pipelines/data_processing/nodes.py</code>中，您将看到两个函数:(<code class="fe ok ol om on b">preprocess_companies</code>和<code class="fe ok ol om on b">preprocess_shuttles</code>)，每个函数输入一个原始数据帧并输出一个包含预处理数据的数据帧:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oy nl l"/></div></figure><p id="e409" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您将在<code class="fe ok ol om on b">src/kedro_tutorial/pipelines/data_processing/pipeline.py</code>内的<code class="fe ok ol om on b">create_pipeline()</code>中找到两种功能的节点，以及用于数据处理的模块化管道:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oy nl l"/></div></figure><p id="aa61" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注:公司和班车指的是<code class="fe ok ol om on b">conf/base/catalog.yml</code>中定义的数据集。这些是<code class="fe ok ol om on b">preprocess_companies</code>和<code class="fe ok ol om on b">preprocess_shuttles</code>功能的输入。Kedro管道使用命名的节点输入(和输出)来确定节点之间的相互依赖关系，从而确定它们的执行顺序。</p><p id="68fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个节点输出一个新的数据集(<code class="fe ok ol om on b">preprocessed_companies</code>和<code class="fe ok ol om on b">preprocessed_shuttles</code>)。Kedro的<code class="fe ok ol om on b">DataCatalog</code>将自动保存数据集(在本例中为<code class="fe ok ol om on b">csv</code>数据)。</p><p id="80e6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的管道中，您将看到另一个节点<code class="fe ok ol om on b">create_master_table()</code>，它在<code class="fe ok ol om on b">src/kedro_tutorial/pipelines/data_processing/nodes.py</code>中将三个数据帧连接成一个主表:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oy nl l"/></div></figure><p id="b207" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Kedro使用从数据集<code class="fe ok ol om on b">preprocessed_shuttles</code>、<code class="fe ok ol om on b">preprocessed_companies</code>和<code class="fe ok ol om on b">reviews</code>加载的数据调用<code class="fe ok ol om on b">create_master_table()</code>，并将输出保存到<code class="fe ok ol om on b">dataset master_table</code>。</p><h2 id="6312" class="ny mo iq bd mp nz oa dn mt ob oc dp mx ko od oe mz ks of og nb kw oh oi nd oj bi translated"><strong class="ak">面向数据科学的模块化管道</strong></h2><p id="ce74" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">现在让我们看看用于价格预测的数据科学管道，它使用来自<a class="ae lc" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>库的<a class="ae lc" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener ugc nofollow" target="_blank"> LinearRegression </a>实现。</p><p id="5175" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您将在<code class="fe ok ol om on b">src/kedro_tutorial/pipelines/data_science/nodes.py</code>中看到三个数据科学功能:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oy nl l"/></div></figure><p id="9bf4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输入参数在配置文件<code class="fe ok ol om on b">conf/base/parameters.yml</code>中:</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="e873" class="ny mo iq on b gy os ot l ou ov">test_size: 0.2<br/>random_state: 3<br/>features:<br/>- engines<br/>- passenger_capacity<br/>- crew<br/>- d_check_complete<br/>- moon_clearance_complete<br/>- iata_approved<br/>- company_rating<br/>- review_scores_rating</span></pre><p id="e27d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些是管道执行时输入到<code class="fe ok ol om on b">DataCatalog</code>的参数。参数<code class="fe ok ol om on b">test_size</code>和<code class="fe ok ol om on b">random_state</code>被用作训练测试分割的一部分，而features给出了主表中用作特性的列的名称。</p><p id="54d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">训练好的模型被保存为数据集(见<code class="fe ok ol om on b">conf/base/catalog.yml</code>):</p><pre class="le lf lg lh gt oo on op oq aw or bi"><span id="03b9" class="ny mo iq on b gy os ot l ou ov">regressor:<br/>type: pickle.PickleDataSet<br/>filepath: data/06_models/regressor.pickle<br/>versioned: true</span></pre><p id="f2c4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据科学的模块化管道在<code class="fe ok ol om on b">src/kedro_tutorial/pipelines/data_science/pipeline.py</code>中创建:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oy nl l"/></div></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="264e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">合并管道</strong></p><p id="1f73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据处理和数据科学管道被添加到<code class="fe ok ol om on b">register_pipelines within src/kedro_tutorial/pipeline_registry</code>的项目中:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oy nl l"/></div></figure><p id="21d1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ok ol om on b">“__default__”: data_processing_pipeline + data_science_pipeline</code>中使用的<code class="fe ok ol om on b">__default__ key</code>将两个模块化管道合并成一个项目默认管道。</p><p id="8453" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">注意:</em>将管道添加在一起的顺序并不重要，并且<code class="fe ok ol om on b">data_science_pipeline + data_processing_pipeline</code>将产生相同的管道，因为Kedro自动检测结果管道中所有节点的正确执行顺序。</p><h1 id="003e" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated"><strong class="ak">测试管道</strong></h1><p id="70bf" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">运行管道:<code class="fe ok ol om on b">kedro run</code></p><p id="7391" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您应该会看到类似下面的输出(可能会有一些警告):</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi pa"><img src="../Images/6acce7952aa74d9795092a10a6d81de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2TF8csX3g9SQoMXq3yCISg.png"/></div></div></figure><h1 id="a320" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated"><strong class="ak">总结</strong></h1><p id="e0be" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">在本教程中，我们展示了一个标准的Kedro开发工作流程:</p><p id="f631" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 1。</strong> <a class="ae lc" href="https://kedro.readthedocs.io/en/stable/03_tutorial/02_tutorial_template.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">项目模板</strong> </a></p><p id="ebd6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用kedro new创建了一个新项目，用<code class="fe ok ol om on b">kedro install</code>安装了项目依赖项(完整教程也谈到了配置)</p><p id="0838" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2。</strong> <a class="ae lc" href="https://kedro.readthedocs.io/en/stable/03_tutorial/03_set_up_data.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">数据</strong> </a></p><p id="3556" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将数据添加到<code class="fe ok ol om on b">data/</code>文件夹，并在<code class="fe ok ol om on b">conf/base/catalog.yml</code>中引用项目的输入数据集</p><p id="f621" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 3。</strong> <a class="ae lc" href="https://kedro.readthedocs.io/en/stable/03_tutorial/04_create_pipelines.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">管道</strong> </a></p><p id="75a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将数据转换步骤创建为Python函数(节点)，构建模块化管道并将它们合并到一个项目管道中。为了简洁起见，我们没有介绍如何<a class="ae lc" href="https://kedro.readthedocs.io/en/stable/03_tutorial/06_visualise_pipeline.html" rel="noopener ugc nofollow" target="_blank">可视化你的管道</a>。</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h1 id="1aba" class="mn mo iq bd mp mq nt ms mt mu nu mw mx jw nv jx mz jz nw ka nb kc nx kd nd ne bi translated">哇，那是一些长的教程！</h1><p id="5af7" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">抱歉，是的，就是它！在Kedro文档中有更多的细节，如果你想更深入地了解正在发生的事情，或者如果你在运行这个例子时有任何问题，你会发现它很有用:</p><ul class=""><li id="a3f6" class="lz ma iq kh b ki kj kl km ko mb ks mc kw md la me mf mg mh bi translated"><a class="ae lc" href="https://kedro.readthedocs.io/en/stable/01_introduction/01_introduction.html" rel="noopener ugc nofollow" target="_blank">Kedro简介</a></li><li id="0c9d" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lc" href="https://kedro.readthedocs.io/en/stable/03_tutorial/01_spaceflights_tutorial.html" rel="noopener ugc nofollow" target="_blank">本教程加长版</a></li><li id="f040" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lc" href="https://kedro.readthedocs.io/en/stable/kedro.html" rel="noopener ugc nofollow" target="_blank"> API参考</a></li><li id="6273" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lc" href="https://github.com/quantumblacklabs/kedro" rel="noopener ugc nofollow" target="_blank"> Kedro Github回购</a></li><li id="e33b" class="lz ma iq kh b ki mi kl mj ko mk ks ml kw mm la me mf mg mh bi translated"><a class="ae lc" href="https://medium.com/quantumblack/the-latest-and-greatest-in-kedro-were-growing-our-community-c868825b0cb4" rel="noopener"> Kedro社区更新</a></li></ul><h1 id="3d1b" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">承认</h1><p id="7351" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">Spaceflights的例子是基于2019年QuantumBlack Labs的Kedro团队编写的教程。没有他们我什么都做不了。非常感谢QB实验室的<a class="ae lc" href="https://github.com/yetudada" rel="noopener ugc nofollow" target="_blank"> Yetunde Dada </a>、<a class="ae lc" href="https://github.com/idanov" rel="noopener ugc nofollow" target="_blank"> Ivan Danov </a>、<a class="ae lc" href="https://github.com/dmder" rel="noopener ugc nofollow" target="_blank"> Dmitrii Deriabin </a>、<a class="ae lc" href="https://github.com/lorenabalan" rel="noopener ugc nofollow" target="_blank"> Lorena Balan </a>、<a class="ae lc" href="https://github.com/921kiyo" rel="noopener ugc nofollow" target="_blank"> Kiyohito Kunii </a>、<a class="ae lc" href="https://github.com/MerelTheisenQB" rel="noopener ugc nofollow" target="_blank"> Merel Theisen </a>以及其他加入团队的人。</p></div></div>    
</body>
</html>