<html>
<head>
<title>5 Steps: Build an SVM Model that Helps Small Businesses Grow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个步骤:建立一个帮助小企业成长的SVM模式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-can-support-vector-machines-help-grow-a-small-business-8e71561616ea?source=collection_archive---------21-----------------------#2021-04-10">https://towardsdatascience.com/how-can-support-vector-machines-help-grow-a-small-business-8e71561616ea?source=collection_archive---------21-----------------------#2021-04-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6dda0ccbf8ee19b9b880e2c4e4c8119c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Zm0lb0DiBvbouxj5"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">斯维特拉娜·古梅罗娃在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ac46" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://github.com/sameehaafr/occ-svm" rel="noopener ugc nofollow" target="_blank"> <em class="le"> Github为此项目。</em> </a></p><p id="5c28" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们经常在数据科学和机器学习等领域听到“大数据”这个术语，尽管这个术语很常见，并且应用于我们的社会，但数据科学方法也可以在“小数据”方面发挥重要作用。那么，我们在哪里可以看到小数据呢？通常，它是在供应商和小型企业的场景中处理的。与公司或常规规模的企业相比，小型企业的客户和交易数量较少，这使得跟踪和分析客户数据以及了解客户行为变得更加容易。</p><p id="f88f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在5个步骤中，我将介绍我创建的一个小型企业场景，以深入了解如何使用数据科学来发现客户行为的趋势，从而帮助企业发展。在我继续这个场景之前，我们应该知道什么是一类分类和支持向量机。</p><ul class=""><li id="9571" class="lf lg it ki b kj kk kn ko kr lh kv li kz lj ld lk ll lm ln bi translated"><strong class="ki iu">一类分类:</strong>使用正常数据创建和训练分类器模型，以在加入新数据时预测异常值</li><li id="0844" class="lf lg it ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="ki iu">支持向量机:</strong>假设我们绘制二维数据，我们可以用一条线将这些数据分成两类。支持向量是该线附近的点，这些点设置了适当的边界，有助于将新点分类为离群点/内点。</li></ul><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/ccfe24163239a3cea168742f736dc838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*YPZ_aZYfcouITURLsEdJoA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="0cde" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">方案</h2><p id="da84" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">我拥有一家花店，我希望人们买更多的向日葵，因为我有很多。所以，我想降低它的成本，但我不想降低太多，我可能会失去潜在的金钱；我希望降价幅度恰到好处，这样可以优化客户数量和我卖向日葵的收入。</p><h2 id="926c" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">步骤1:收集/创建您的数据。</h2><p id="d9ef" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">要在你销售的产品和客户反应/行为之间找到洞察力和趋势，第一步你需要数据。如果您想使用SVM进行一类分类，请创建随机数据。如果你想在现实生活中应用它，下载你当前的数据到一个. csv文件中。</p><p id="1f0c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回到我的场景:假设我已经在很长一段时间内以不同的价格出售了向日葵，并且我将所有的数据合并成一个数据集。我的自变量(向日葵降价)将是我的向日葵降价的200个对象。我的因变量(客户响应)将是200个客户响应对象(1 =客户购买了向日葵，2 =客户没有购买向日葵)。</p><p id="f608" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在现实中，小企业主不会知道客户何时会/不会购买产品的确切价格下限，但为了使该数据不完全随机，我设置了它，以便如果向日葵的降价≥ $3，客户会购买向日葵，否则，他们不会。下面是我的数据集的一部分。</p><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/13b9f6feab4333ad46c884761e597ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*TGLvLyoFO6XXCwr6pnLjWg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="efb4" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">步骤2:训练和测试集。</h2><p id="f698" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">为了创建我们的基本SVM模型，我们需要将整个数据集分成两部分。训练数据集应该大于测试数据集。我们将使用测试数据集来看看我们的模型在最后有多准确。</p><p id="acbd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于我的场景，我的原始数据集的70%用于训练，其余用于测试。我在r中使用了sample.split()函数。</p><pre class="lu lv lw lx gt mx my mz na aw nb bi"><span id="8c08" class="ly lz it my b gy nc nd l ne nf">#df is my dataframe containing my 2 variables (lowered sunflower prices and customer response)</span><span id="bd19" class="ly lz it my b gy ng nd l ne nf">split = sample.split(df$response, SplitRatio = 0.7)<br/>train = subset(df, split == TRUE)<br/>test = subset(df, split == FALSE)</span></pre><h2 id="5832" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">第三步:创建支持向量机(SVM)模型。</h2><p id="882f" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">为了建立我们的SVM模型，我们需要通过分别输入我们的独立(降低的价格)和非独立(响应)变量<em class="le">作为数据集来训练模型，这样函数就知道要训练哪两个变量。</em></p><p id="b7cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我将我的训练数据集分成2个变量，并将它们转化为因子(R中的svm()函数只接受因子)。</p><pre class="lu lv lw lx gt mx my mz na aw nb bi"><span id="58f2" class="ly lz it my b gy nc nd l ne nf">train_x &lt;- train[-2]      #take out the column with response<br/>train_y &lt;- train[2]       #only the response column</span><span id="bb03" class="ly lz it my b gy ng nd l ne nf">#turn into factors (below)</span><span id="7449" class="ly lz it my b gy ng nd l ne nf">train_y$response &lt;- as.factor(train_y$response)<br/>train_x$sunflower &lt;- as.factor(train_x$sunflower)</span></pre><p id="9fb8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们简单地将我们的训练变量放入svm()函数，它将告诉我们在模型和参数信息中有多少个支持向量。</p><pre class="lu lv lw lx gt mx my mz na aw nb bi"><span id="7250" class="ly lz it my b gy nc nd l ne nf">svm &lt;- svm(data=train, train_x, train_y, type='one-classification', nu=0.10, scale=FALSE)</span><span id="e912" class="ly lz it my b gy ng nd l ne nf">summary(svm)</span></pre><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/a19423f43175a0c6c7ca10262e77ae33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbMX3_XJ6D2wfCvpCFPEmA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="d566" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">理解gamma、nu和kernel值有点复杂，在实现最基本的SVM模型时没有必要。这些值可以帮助您在以后使SVM模型更加准确。</p><h2 id="a1a1" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">第四步:预测。</h2><p id="d29f" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">随着我们的SVM模型全部建立，我们现在可以通过输入训练数据集来测试我们的SVM模型有多强。</p><p id="b0a5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我输入我的训练数据集，R中的predict()函数将预测客户对数据集中给出的每一个较低价格的反应。我们应该只包括自变量(降低的价格)作为输入，这样SVM模型可以预测客户的反应。在此之后，我们将使用混淆矩阵来比较预测的客户响应和实际的客户响应，以了解我们的模型结果有多准确。</p><pre class="lu lv lw lx gt mx my mz na aw nb bi"><span id="6de8" class="ly lz it my b gy nc nd l ne nf">p &lt;- predict(svm, test_x)      #predicting test responses using the test independent variables (x)</span><span id="1db1" class="ly lz it my b gy ng nd l ne nf">summary(p)</span></pre><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ba7de7f565dad67792f4af75336cb1a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*v662rRb5KhZyV8Rw6f4rDg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="56b1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上图中，TRUE表示预测客户<em class="le">不会</em>购买向日葵，FALSE表示预测客户<em class="le">会</em>购买向日葵。</p><h2 id="ad26" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">第五步:混淆矩阵。让我们看看我们的SVM模型有多强！</h2><p id="3960" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">这一步相当简单。我们需要将模型在上一步中做出的预测编译成数据集，并将预测和实际响应都转换成因子。我们还必须使响应类型相同，这样混淆矩阵就可以区分真/假和“1”/“2”，因为它们是不同的输出。</p><pre class="lu lv lw lx gt mx my mz na aw nb bi"><span id="0600" class="ly lz it my b gy nc nd l ne nf">p &lt;- as.data.frame(p)</span><span id="d7ad" class="ly lz it my b gy ng nd l ne nf">test_y$response &lt;- as.factor(test_y$response)<br/>p$p &lt;- as.factor(p$p)</span><span id="c7eb" class="ly lz it my b gy ng nd l ne nf">levels(p$p) &lt;- list("1"="FALSE", "2"="TRUE")  #levels have to match the test data levels</span><span id="26a8" class="ly lz it my b gy ng nd l ne nf">confusionMatrix(test_y$response, p$p)</span></pre><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/c243242830a654f6a986dcde8ab3fbca.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*GBeo1DjWU69E9k3Owd1D8Q.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="326b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以上是我的混淆矩阵的结果，我的SVM模型的准确率约为50%。这意味着我的SVM模型在50%的时间里预测了正确的客户反应。即使看起来不多，许多小企业在开始时也会有较低的准确率。随着时间的推移，企业将为每种产品收集越来越多的数据，该模型将在预测客户反应方面变得更好。</p><p id="3d07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，如果我将向日葵的价格降低了3美元，并想知道客户是否会购买我的向日葵，我可以使用SVM模型来<em class="le">预测单个值</em>，这在我没有训练集的情况下会很有帮助。</p><pre class="lu lv lw lx gt mx my mz na aw nb bi"><span id="d6a8" class="ly lz it my b gy nc nd l ne nf">p3 &lt;- predict(svm, 3)<br/>summary(p3)</span></pre><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/4612ed33ccacef1e0f183db0a21c60dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*hFuvGHIlB59dnkh1u8QzGw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="ecf1" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">设想</h2><p id="4e29" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">我使用ggplot来可视化我的数据，但只要您可以选择显示客户反应的差异，任何东西都可以。</p><pre class="lu lv lw lx gt mx my mz na aw nb bi"><span id="d23e" class="ly lz it my b gy nc nd l ne nf">ggplot(df2, aes(x=X, y=sunflower, color=response)) + geom_point(size=5) + theme_ipsum()</span></pre><figure class="lu lv lw lx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/ecd93751568239ccf7b48cb6e7484905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXbmluzRFDnfuQCEemJkUg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="cb43" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如你从上面的图像中看到的，购买向日葵的顾客和没有购买向日葵的顾客之间有明显的差异(3美元)。如果我把价格降到3美元以下，顾客就不会买向日葵，反之亦然。在现实中，这种分裂不会如此明显，但会有一定的模式，你可以用一种常见的方式找到它，如回归线。</p><h2 id="de6e" class="ly lz it bd ma mb mc dn md me mf dp mg kr mh mi mj kv mk ml mm kz mn mo mp mq bi translated">结论</h2><p id="86b2" class="pw-post-body-paragraph kg kh it ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">通过我简短的花店场景，我们学习了如何使用支持向量机(SVM)实现一类分类(OCC ),并创建了一个模型，该模型可以根据我降低向日葵价格的程度来预测客户的反应。任何有产品和客户的小企业场景都适用于这种模型，并且可以揭示关于客户行为的有价值的信息。这种SVM模型可以指出所有者需要关注的地方，以及他们需要营销什么来优化他们的业务。</p><p id="9660" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">感谢您的阅读！</em></p></div></div>    
</body>
</html>