<html>
<head>
<title>Stop Hardcoding Sensitive Data in Your Python Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止在Python应用程序中硬编码敏感数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stop-hardcoding-sensitive-data-in-your-python-applications-86eb2a96bec3?source=collection_archive---------0-----------------------#2021-09-25">https://towardsdatascience.com/stop-hardcoding-sensitive-data-in-your-python-applications-86eb2a96bec3?source=collection_archive---------0-----------------------#2021-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="011e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用将您的设置和凭据保密。环境文件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4c5e0615c176b84638a0f8bd123e3979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5BOE9-6TZZwRWcECI29_PA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像</p></figure><p id="e9fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为一名数据科学家，我每天使用Python来构建依赖于<strong class="la iu">凭证</strong>和<strong class="la iu">敏感设置的应用程序。</strong></p><p id="7c48" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是一些例子，我想了想:</p><ul class=""><li id="6258" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><strong class="la iu">访问第三方服务的API密钥</strong></li><li id="78d4" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">密码和凭证</strong></li><li id="3d66" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">电子邮件地址或个人数据(姓名、年龄、社会保险号等。)</strong></li><li id="cea3" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">调试标志</strong></li><li id="414f" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">主机，网址，URI </strong></li></ul><p id="1e9c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很明显，更多的事情。</p><p id="2954" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中一些设置本质上是私有的。其他人很敏感，因为他们可以提供对网络攻击或威胁的见解。</p><h2 id="fadd" class="mi mj it bd mk ml mm dn mn mo mp dp mq lh mr ms mt ll mu mv mw lp mx my mz na bi translated">️️️️⚠️️This不言而喻，但我们还是要说出来<strong class="ak"> <em class="nb">:这些数据永远不应该被硬编码到你的python文件中。你必须找到一种方法来保持它的私密性，永远不要与世界分享(尤其是Github)</em></strong></h2></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><blockquote class="nj nk nl"><p id="f1b9" class="ky kz nm la b lb lc ju ld le lf jx lg nn li lj lk no lm ln lo np lq lr ls lt im bi translated"><strong class="la iu"> <em class="it">在这篇快速的帖子中，我们将看到如何使用环境变量和一个名为</em> </strong> <code class="fe nq nr ns nt b"><strong class="la iu"><em class="it">.env</em></strong></code> <strong class="la iu"> <em class="it">的特殊文件来解决这个问题。<br/>我们还将学习如何使用</em> </strong> <code class="fe nq nr ns nt b"><strong class="la iu"><em class="it">python-dotenv</em></strong></code> <strong class="la iu"> <em class="it">模块与该文件交互，并使您的敏感数据隐藏起来。</em> </strong></p></blockquote><p id="f2fd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事不宜迟，我们来看看🔍</p><h1 id="d417" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated">什么是环境变量？</h1><p id="b778" class="pw-post-body-paragraph ky kz it la b lb of ju ld le og jx lg lh oh lj lk ll oi ln lo lp oj lr ls lt im bi translated">环境变量是保存您不想硬编码到程序中的数据的变量。它们被抽象出来，从代码中删除。</p><p id="1b95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它们的值存在于你的操作系统中；它们可以是内置的，也可以通过自定义应用程序来设置。</p><h2 id="803b" class="mi mj it bd mk ml mm dn mn mo mp dp mq lh mr ms mt ll mu mv mw lp mx my mz na bi translated"><strong class="ak">一些内置的环境变量</strong></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/3ecd5b1993102c5790bfe98b221510bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33gavVz9ffXj3H-t1aapVg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“PATH”环境变量—作者截图</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/580aa89b79a04b0c5715816d8d147bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhG9dptb8mgkJzg-bFWAsw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“SHELL”环境变量—作者截图</p></figure><p id="b47a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">环境变量由键/值对组成，您可以使用它们来存储不同类型的数据。</p><ul class=""><li id="3bad" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">域名</li><li id="faf2" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">执行模式(生产、开发、暂存)</li><li id="febb" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">认证密钥、登录或密码等凭证</li><li id="2985" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">电子邮件地址等。</li></ul><h1 id="bb43" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated"><strong class="ak">如何使用Python访问环境变量？</strong></h1><p id="96cb" class="pw-post-body-paragraph ky kz it la b lb of ju ld le og jx lg lh oh lj lk ll oi ln lo lp oj lr ls lt im bi translated">要访问环境变量，您需要使用<code class="fe nq nr ns nt b">os</code>模块，该模块提供了读写这些值的实用程序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="a4b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这似乎是隐藏敏感数据的一种简便方法，对吗？</p><p id="27c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想象一下，您需要在代码中使用一个API键，而不泄露它的值。您需要做的就是从环境变量中加载它:</p><pre class="kj kk kl km gt oo nt op oq aw or bi"><span id="3c2c" class="mi mj it nt b gy os ot l ou ov"><strong class="nt iu">api_key = os.gentenv("SECRET_API_KEY")  </strong></span></pre><p id="bcf3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">但是等等，我不记得把我的API键设置为环境变量了。我该怎么做？</strong></p><p id="db9b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有两种常见的方式:</p><ul class=""><li id="0a28" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">通过键入以下命令:</li></ul><pre class="kj kk kl km gt oo nt op oq aw or bi"><span id="0d3f" class="mi mj it nt b gy os ot l ou ov"><strong class="nt iu">export SECRET_API_KEY=XXXXXXXXXXXX</strong></span></pre><ul class=""><li id="e933" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">或者在你的<code class="fe nq nr ns nt b">.<strong class="la iu">zshrc</strong></code>、<code class="fe nq nr ns nt b">.<strong class="la iu">bashrc</strong></code>或<code class="fe nq nr ns nt b">.<strong class="la iu">bash_profile</strong></code>中添加相同的行，并对其进行采购</li></ul><blockquote class="nj nk nl"><p id="d5b0" class="ky kz nm la b lb lc ju ld le lf jx lg nn li lj lk no lm ln lo np lq lr ls lt im bi translated">如果你需要只在特定项目中使用的环境变量，我不推荐这两种方法。其实，</p></blockquote><ul class=""><li id="1cec" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">如果你使用你的终端，你需要记住每次在运行你的程序之前设置你的环境变量，这似乎是不对的。</li><li id="58c0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">如果每次需要添加新的环境变量时都要修改<code class="fe nq nr ns nt b">.zshrc</code>或<code class="fe nq nr ns nt b">.bashrc</code>，这些文件很快就会被大量不必要的信息弄得乱七八糟。如果您的环境变量与非常具体的项目相关联，那么将它们设置在一个可以随时随地访问的全局范围内是没有意义的。</li></ul><p id="f856" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">但愿，</strong> <code class="fe nq nr ns nt b"><strong class="la iu">.env</strong></code> <strong class="la iu">文件似乎能解决这个问题。</strong></p><h1 id="dab7" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated">。env文件:在局部范围内设置环境变量的一种方式</h1><p id="9a8e" class="pw-post-body-paragraph ky kz it la b lb of ju ld le og jx lg lh oh lj lk ll oi ln lo lp oj lr ls lt im bi translated"><code class="fe nq nr ns nt b"><strong class="la iu">.env</strong></code> <strong class="la iu"> </strong>文件首先是文本文件，包含应用程序所需的所有环境变量的键/值对。</p><p id="fb25" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它们使您能够在不污染全局环境名称空间的情况下使用环境变量。事实上，每个单独的项目都可以有自己的<code class="fe nq nr ns nt b">.env</code>文件。</p><p id="9438" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="5a25" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">文件通常放在项目的根目录下。要访问其中列出的值，您需要安装<code class="fe nq nr ns nt b"><strong class="la iu">python-dotenv</strong></code>库。</p><pre class="kj kk kl km gt oo nt op oq aw or bi"><span id="7fbe" class="mi mj it nt b gy os ot l ou ov"><strong class="nt iu">pip install python-dotenv</strong></span></pre><p id="57e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，您只需要添加两行代码:</p><ul class=""><li id="b8af" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><strong class="la iu">一个要导入的库:</strong></li></ul><pre class="kj kk kl km gt oo nt op oq aw or bi"><span id="84c8" class="mi mj it nt b gy os ot l ou ov"><strong class="nt iu">from dotenv import load_dotenv</strong></span></pre><ul class=""><li id="a9cf" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><strong class="la iu">寻找一个</strong> <code class="fe nq nr ns nt b"><strong class="la iu">.env</strong></code> <strong class="la iu">文件并从中加载环境变量</strong></li></ul><pre class="kj kk kl km gt oo nt op oq aw or bi"><span id="0ca9" class="mi mj it nt b gy os ot l ou ov"><strong class="nt iu">load_dotenv()</strong></span></pre><p id="797f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉当这两行代码被执行时，环境变量被注入到项目运行时。当项目终止时，它们被刷新，并且在任何时候都没有被添加到全局命名空间中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正在访问。python中的env文件</p></figure><h1 id="413a" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated">🔴永远不要承诺。env文件或将它们推送到Git</h1><p id="9261" class="pw-post-body-paragraph ky kz it la b lb of ju ld le og jx lg lh oh lj lk ll oi ln lo lp oj lr ls lt im bi translated">一个<code class="fe nq nr ns nt b">.<strong class="la iu">env</strong></code>文件的全部意义在于将敏感数据从代码库中具体化</p><p id="5be1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此你不应该将这个文件版本化或者推送到Github。</p><p id="ce6f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以将它保存在您的本地开发环境中进行测试，并且永远不要与公众共享它。</p><p id="e6ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">避免这种不必要情况的一个简单方法是将<code class="fe nq nr ns nt b">.env</code>添加到您的<code class="fe nq nr ns nt b">.gitignore</code>文件中:</p><pre class="kj kk kl km gt oo nt op oq aw or bi"><span id="b8df" class="mi mj it nt b gy os ot l ou ov"><strong class="nt iu">.env</strong></span></pre><h1 id="f609" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated">让我们结束它</h1><p id="5723" class="pw-post-body-paragraph ky kz it la b lb of ju ld le og jx lg lh oh lj lk ll oi ln lo lp oj lr ls lt im bi translated">Python应用不仅仅是一系列指令和代码。它们还与数据和配置设置相关联。</p><p id="e92a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">大多数时候，这些配置数据是敏感的，需要以保密的方式访问。</p><p id="0450" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">希望环境变量和<code class="fe nq nr ns nt b">.env</code>文件能够处理这种情况。</p><p id="1fff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要开始使用<code class="fe nq nr ns nt b">.env</code>文件，您可以这样做</p><ul class=""><li id="5030" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">使用pip安装<code class="fe nq nr ns nt b">python-dotenv</code>模块</li><li id="58dd" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用项目中适当的环境变量创建<code class="fe nq nr ns nt b">.env</code>文件</li><li id="9040" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将它添加到<code class="fe nq nr ns nt b">.gitignore</code>文件中以防止git提交它</li><li id="f423" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使用<code class="fe nq nr ns nt b">python-dotenv</code>模块将设置加载到Python文件中</li></ul><h1 id="0fc5" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated">资源</h1><p id="ffba" class="pw-post-body-paragraph ky kz it la b lb of ju ld le og jx lg lh oh lj lk ll oi ln lo lp oj lr ls lt im bi translated">虽然这个主题并不复杂，但我浏览了一些很棒的资料，并学到了一些我不知道的关于环境变量和使用<code class="fe nq nr ns nt b">.env</code>文件的知识。</p><p id="058d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一些资源的精选列表。</p><ul class=""><li id="e7ad" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><code class="fe nq nr ns nt b">python-dotenv</code> <a class="ae ow" href="https://pypi.org/project/python-dotenv/" rel="noopener ugc nofollow" target="_blank">文档</a></li><li id="4963" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae ow" href="https://betterprogramming.pub/getting-rid-of-hardcoded-python-variables-with-the-dotenv-module-d0aff8ce0c80" rel="noopener ugc nofollow" target="_blank">https://better programming . pub/getting-rid-of-hard coded-python-variables-with-the-dotenv-module-d 0 aff 8 ce 0 c 80</a></li><li id="35c8" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae ow" href="https://dev.to/jakewitcher/using-env-files-for-environment-variables-in-python-applications-55a1" rel="noopener ugc nofollow" target="_blank">https://dev . to/Jake witcher/using-env-files-for-environment-variables-in-python-applications-55a 1</a></li><li id="3d78" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae ow" href="https://www.askpython.com/python/python-dotenv-module" rel="noopener ugc nofollow" target="_blank">https://www.askpython.com/python/python-dotenv-module</a></li><li id="8c8e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">https://www.youtube.com/watch?v=YdgIWTYQ69A&amp;ab _ channel =乔纳森·索玛</li><li id="d86b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">https://www.youtube.com/watch?v=rKiLd40HIjc</li><li id="7a54" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">一个漂亮的网站生成。gitignore文件:<a class="ae ow" href="https://www.toptal.com/developers/gitignore" rel="noopener ugc nofollow" target="_blank">https://www.toptal.com/developers/gitignore</a></li></ul><p id="62cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也许你也会学到一些东西😉</p><h1 id="9a2e" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated">感谢阅读🙏</h1><p id="8231" class="pw-post-body-paragraph ky kz it la b lb of ju ld le og jx lg lh oh lj lk ll oi ln lo lp oj lr ls lt im bi translated">如果你已经做到这一步，我真的很感谢你的时间。</p><p id="1c15" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天就这些了。直到下一次的其他编程技巧👋</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/413b8e00b584d92c5e15193c191b5c8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mjhn8z_fUdUeNRdq"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ow" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ow" href="https://unsplash.com/@karsten116?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Karsten Winegeart </a>拍摄</p></figure><h1 id="5820" class="nu mj it bd mk nv nw nx mn ny nz oa mq jz ob ka mt kc oc kd mw kf od kg mz oe bi translated">新到中？你可以订阅每月5美元，并解锁无限的文章——<a class="ae ow" href="https://ahmedbesbes.medium.com/membership" rel="noopener">点击这里。</a></h1></div></div>    
</body>
</html>