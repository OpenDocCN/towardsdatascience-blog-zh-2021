<html>
<head>
<title>Is Gradient Boosting good as Prophet for Time Series Forecasting?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">梯度推进作为时间序列预测的预言者好吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/is-gradient-boosting-good-as-prophet-for-time-series-forecasting-3dcbfd03775e?source=collection_archive---------6-----------------------#2021-11-03">https://towardsdatascience.com/is-gradient-boosting-good-as-prophet-for-time-series-forecasting-3dcbfd03775e?source=collection_archive---------6-----------------------#2021-11-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7568" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Sklearn模型进行多季节长期预测</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e6fb506e3ea72844474abf73dc59be07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G27y1DNacRGf_kXd"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马克·巴萨拉布在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5fa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">近年来，我们协助提出各种时间序列预测架构。最著名的是Prophet，这是一种由脸书发布的算法，基于加法方法预测具有多重复杂季节性的时间序列。随着它的发布，时间序列预测的新时代开始了。由于其可用性和对各种情况的适应性，Prophet最近成为更经典的SARIMA的一个有价值的替代品，以提供长期预测。</p><p id="0dcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着Prophet在数据科学界的成功，<strong class="lb iu">大型科技公司开始发布用于时间序列预测的开源工具</strong>。所有这些类型的框架都宣称使用可伸缩的和直观的API以快速有效的方式(包括自动调整)提供准确的预测。考虑到这些前提，如今执行时间序列预测任务似乎比以往任何时候都容易。</p><p id="1c9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们知道所有这些开源库的力量。然而，我们意识到，它们的有效性因研究案例而异。<strong class="lb iu">测试一个更标准的预测管道在很多情况下可能是有益的</strong>，以评估提供最准确预测的最佳工具。</p><p id="fe08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们执行了一个简单的时间序列预测任务。我们的目标是对具有多种季节性模式的系列进行长期的每小时预测。<strong class="lb iu">我们尝试将Prophet与简单特征工程制作的标准管道和梯度推进模型</strong>进行比较。当预测非平稳序列时，我们重复实验，在原始序列上引入趋势分量来评估该过程。</p><h1 id="1689" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数据</h1><p id="fb05" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们从Kaggle收集了一个数据集。<a class="ae ky" href="https://www.kaggle.com/robikscube/hourly-energy-consumption" rel="noopener ugc nofollow" target="_blank">每小时能耗</a>顾名思义，以兆瓦为单位存储美国不同地区不同年份的每小时能耗。</p><p id="dc75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的分析，我们选择了一个单一地区的消费，在此基础上我们开发了我们的预测模型。所有KPI都是固定的，并根据日常和季节性行为显示多个季节性模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/8fe8ef4c433f63af94c1b0364165de82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03fd_SMZWKD-MzdTVW8u1w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据中呈现的季节模式(图片由作者提供)</p></figure><h1 id="a800" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">模拟多重季节性</h1><p id="d58c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">作为第一阶段，我们用Prophet和梯度推进对原始时间序列进行建模。我们使用最近一年的可用数据来测试性能，并从剩余的数据中连续3年进行训练。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/42326e5c34cfa0507fad6fcefa48b58e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QJEAc6sgNSOHLcJZBZOM_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原始时间序列被分割成训练和测试(图片由作者提供)</p></figure><p id="de58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拟合先知很简单。不需要预处理，因为它声明对异常值、缺失数据和变化点是健壮的。它不需要任何手动操作，因为默认情况下会自动检测季节性模式。鉴于这些前提，为我们的时间序列提前一年提供预测对Prophet来说似乎是一件容易的事情。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/0af2dc0911b8e3d5f56efa1be2bdef97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1LC81zVSlK-Znmov-fOGrA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预言家对测试数据的预测(图片由作者提供)</p></figure><p id="ffb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">预测显示了强烈的每日和每周季节性。Prophet还可以检测到以夏季和冬季能源消耗增加为特征的长期季节性。通过Prophet获得的预测似乎是合理的。它们概述了能源消耗的基本行为，肯定会产生重大影响。</p><p id="3247" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们要测试的下一个模型是sklearn库中的梯度增强。我们习惯于将梯度推进视为表格数据的算法。将它应用于时间序列预测是非常容易的。我们只需要提供足够的功能。我们的预测器必须在未来的任何时候都可以访问，因为我们正在进行长期预测，我们希望不要造成泄漏。</p><p id="d535" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们创建了一些对时间变量进行循环编码的基本特性。这种方法非常灵活，允许我们简单地应用傅立叶变换，以数字格式合并多个时间回归量。此外，我们意识到，在任何未来的上下文中，同样的特征是容易检索的。在我们的例子中，我们对小时、星期、月份、星期和季节进行循环编码。参数的调整总是可以用标准技术来实现。</p><p id="93e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如预言家所说，梯度推进充分再现了季节模式。最大的区别在于预测误差。与Prophet相比，梯度增强在测试数据上达到非常低的误差(计算为均方根误差)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/75cbbe813a48d17668d96a32f82ccb8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yiNsQ7ATYfLbdzSCqxpdLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对测试数据的梯度推进预测(图片由作者提供)</p></figure><h1 id="3976" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用趋势模拟多重季节性</h1><p id="78ca" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">梯度增强只需使用正弦特征就能很好地处理这类数据。为了使事情更准确，我们在原始时间序列上引入一个增长趋势，并尝试再次预测。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/155191bf07ba2d4bece5142b98e3255f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5CUHpW-875cBdP_oUboVGg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原始时间序列加趋势(图片由作者提供)</p></figure><p id="6302" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理非平稳时间序列是现实应用中的常见做法。默认情况下，Prophet声明处理输入序列中的趋势行为。和以前一样，我们需要做的只是提供一个时间序列，以适合适当的格式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/14cf089e653a4dfa06aec6144bacdeb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*55UID2KTv9gwgf0M-3O5xw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预言家对测试数据的预测(图片由作者提供)</p></figure><p id="ccfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对测试数据的预测与没有趋势的情况非常相似，但是测试数据的误差急剧增加。</p><p id="9e2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在梯度推进的情况下，目标的不稳定特性可能会造成困难。因此，作为第一步，我们建立一个简单的线性回归(总是基于训练数据)来模拟趋势模式。从训练数据中减去预测的趋势(以使它们稳定)，然后在预测时再次相加。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/3057669a76dd7174409a36e485e41f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBKyksrN8PTCxmLpwz5aEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">关于培训和测试的趋势预测(图片由作者提供)</p></figure><p id="a5b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在从训练中减去预测的趋势之后，如前所述进行具有梯度增强的建模。最终预测遵循再现季节性模式的趋势。与Prophet相比，测试误差再次非常低。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/a72efc2cbc2ced961a6b9745e4251c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5_x3F1rskVWSSg2bcwUxHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对测试数据的梯度推进预测(图片由作者提供)</p></figure><h1 id="2269" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">摘要</h1><p id="139c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这篇文章中，我们进行了一项长期预测的时间序列预测任务。我们测试了Prophet对更经典的管道的预测能力，该管道由时间变量的循环编码和梯度推进建模组成。我们发现，<strong class="lb iu">对于我们的用例，梯度提升在测试误差方面压倒性地优于Prophet】。由于拟建管道的适应性，它可能被视为一个良好的基线。可以使用每个标准的机器学习算法来代替梯度提升，并且可以集成每个其他的预测器。同时，我们知道Prophet是一个很好的框架，有效性取决于研究的案例。</strong></p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><p id="c8eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/cerlymarco/MEDIUM_NoteBook" rel="noopener ugc nofollow" target="_blank">T3】查看我的GITHUB回购T5】</a></p><p id="4e3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保持联系:<a class="ae ky" href="https://www.linkedin.com/in/marco-cerliani-b0bba714b/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a></p></div></div>    
</body>
</html>