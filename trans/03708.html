<html>
<head>
<title>Two examples of a content-based recommendation system</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于内容的推荐系统的两个例子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/two-examples-of-a-content-based-recommendation-system-with-the-most-efficient-array-functions-93899113a890?source=collection_archive---------19-----------------------#2021-03-26">https://towardsdatascience.com/two-examples-of-a-content-based-recommendation-system-with-the-most-efficient-array-functions-93899113a890?source=collection_archive---------19-----------------------#2021-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="407d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基于内容、加权的基于内容的数字函数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/69675cd9755756db522c38f537722b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7aFSJTnGKbMiXBT5DdHTQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片来自<a class="ae ky" href="https://unsplash.com/@michalmatlon" rel="noopener ugc nofollow" target="_blank">米哈尔·马特隆在Unsplash </a></p></figure><p id="3526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天我想讨论两个基于内容的推荐系统的例子，以及我从中学到的一些有效的数组函数。这两个例子是</p><p id="c39a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 1:基于项目内容推荐</strong></p><p id="4bfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2:基于加权内容推荐</strong></p><p id="bc14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用一个简单的电影集作为例子，希望将重点放在主要过程上，而忽略其他过程和特殊情况。让我们开始吧。</p><h2 id="611b" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">数据集准备:</h2><p id="6d90" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">使用以下代码生成两个数据集:movie_df和review_df</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1882" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个表为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e99af9eac9876c24260b3f5fdb729575.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*_P1OFynxLg2uY3HM3jOk7Q.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/bd3200d39a8f8ebe08748ef13643b796.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*P9sT-XPtdvSnQg_r8dTAjg.png"/></div></div></figure><p id="e24c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">方法一:基于电影内容，当内容相似度大于0时，为每个用户做推荐。</strong></p><p id="d740" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们可以用于电影的内容只有类型。对于基于内容的推荐系统技术来说，以列表格式保存风格并不是最佳选择，我们将使用One Hot编码技术将风格列表转换为一个向量，其中每一列对应于一个可能的特征值。</p><p id="4977" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每种类型都用“，”分隔，所以我们只需调用split函数</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/6cbc2d529c9bc43061065f3234d8e08a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*JwOqLmq4HHIOmIw0EEfEZQ.png"/></div></figure><p id="678c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤1:计算电影-电影相似度矩阵:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b7cd08b4afa469c40c639c01fa76490c.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*8JtyM8BNQtRxp_AWlS8B_w.png"/></div></figure><p id="ff57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点积显示了电影之间的相似性。</p><p id="d121" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第二步:寻找相似电影</strong>:这里的标准是如果有关系那么选择推荐为小数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="b6b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我给出的标准是，如果两部电影相关(点积大于0)，值不重要。下面还给出其他标准，这些标准只选择相似性的最高值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="97fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> np.where() </strong>显示项目在表格中的位置(索引)。</p><p id="8606" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对movie_id =1进行测试:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/5a94c4843a67c0bd9556cea667b83aef.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*sLX4vNiMJE0X5yKCBbC2iA.png"/></div></figure><p id="b361" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与《玩具总动员》类似的电影是《超人》，其类型是儿童。结果在意料之中。</p><p id="5caf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后得到一个电影名称列表，如果电影的名称是一个列表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="36c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第三步:为特定用户做推荐:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2333" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对user_id=100进行测试</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/5a4d6413a903425ca994262ab21c4f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*k7BXr-5se1i4qbcsXrT1Vg.png"/></div></figure><p id="fc83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">两部都是剧，因为用户100也评论过剧《超人》，所以推荐有道理。</p><p id="d52d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">方法2:基于加权含量</strong></p><p id="8061" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">方法1很容易理解，但似乎没有使用评级信息。现在我想整合信息来计算加权流派。</p><p id="f514" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我想根据用户的评分来构建加权流派。让我们选择user_id=100。</p><p id="352a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤1:过滤掉用户100评价的电影，只得到流派:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/461ee06da223a0f62d8443ce992fb586.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*3q8hcAAxsb3qbjgQ_Ox_iA.png"/></div></figure><p id="abcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第二步:获取该用户的加权流派:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/4e9852de838bfaf31068db47590b055e.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/format:webp/1*vGYTfRYwHpjHDaAa68EC-Q.png"/></div></figure><p id="b7f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第三步:获得推荐(也包括用户评论)</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/3c59e7a2e041e28a5dd2fc67093d9b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*q-VjIh3oUko9G0RGm8qDqA.png"/></div></figure><p id="8955" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该rec_movies显示了加权流派≥0.5的所有推荐电影，但也包括用户已经评论过的电影。</p><p id="10ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第四步:过滤已评论的电影</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/d5cdf4d0ac21e22b3a5d434a79ece04b.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*qwBtfwpG4ocZMjzfWhF1Mw.png"/></div></figure><p id="9ef7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，由于用户100的minari的加权流派是0.2，所以它被排除在推荐之外。</p><p id="c3b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">概要:</strong></p><ul class=""><li id="8559" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">从这两个案例中，我们可以看到，没有评论的体裁是不会被推荐的，这是基于内容的推荐系统的特点。它对用户来说是高度个性化的。</li><li id="6946" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">在某种程度上，推荐系统就像一门艺术，你也可以创建自己的标准来适应你的目标，就像在这个故事中，我展示了不同的标准，甚至是相同的方法。</li><li id="eafd" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">有一些我认为在处理推荐系统时非常有效的数组函数，我想在这里再次总结一下:</li><li id="600d" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">1) <strong class="lb iu"> np.setdiff1d() </strong>:这个函数可以找出两个数组的区别。即使你有一个列表，你也可以把它转移到一个数组中使用。</li><li id="001c" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">2)<strong class="lb iu">NP . dot(NP . transpose())</strong>:这个点积不仅可以用于项本身，还可以用于得到加权项。</li><li id="3f9b" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">3) <strong class="lb iu"> np.where() </strong>:这里我用它来查找物品的位置(索引)。</li><li id="f5c1" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">当然，你也可以把它们推广到其他情况，而不仅仅是推荐系统。由于限制，我没有足够的时间来展示这些函数是如何高效的，我将在本故事中详细解释它们<a class="ae ky" href="https://annie-wangliu.medium.com/the-most-5-efficient-functions-used-in-recommendation-system-data-processing-2cda1a809441" rel="noopener">。</a></li></ul><p id="951f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>