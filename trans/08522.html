<html>
<head>
<title>Going for Gold: Predicting Medal Outcomes in the Olympics Using Generalized Linear Modeling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">争取金牌:使用广义线性模型预测奥运会奖牌结果</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/going-for-gold-predicting-medal-outcomes-in-the-olympics-using-generalized-linear-modeling-e6e9d4837ae8?source=collection_archive---------11-----------------------#2021-08-06">https://towardsdatascience.com/going-for-gold-predicting-medal-outcomes-in-the-olympics-using-generalized-linear-modeling-e6e9d4837ae8?source=collection_archive---------11-----------------------#2021-08-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="68f6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们能建立一个运动员赢得奖牌几率的广义线性模型吗？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3595d5c2c690e354f9fbd099526b5d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IvuBvCLPO-AuZq9mCuO7vg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯尔·迪亚斯在<a class="ae ky" href="https://unsplash.com/s/photos/olympics?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0850" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和许多人一样，我一直在家里享受东京奥运会。作为一名数据科学家，在观看一些网球比赛时，我摆弄了一个关于奥运选手的<a class="ae ky" href="https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results" rel="noopener ugc nofollow" target="_blank"> Kaggle数据集，列出了他们的年龄、性别和国籍等特征，以及每个运动员获得的奖牌(如果有的话)，并想看看我能否基于这些特征建立一个运动员赢得奖牌几率的广义线性模型。</a></p><h1 id="e944" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">动机</h1><p id="2481" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">根据年龄、身高和国籍等相关特征，我们能否预测某个运动员在奥运会上赢得奖牌的可能性？</p><h1 id="52ea" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">资料组</h1><p id="c223" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将使用从雅典1896年到里约2016年的夏季和冬季奥运会的综合数据集。对每位运动员的以下特征进行测量:</p><ul class=""><li id="f5a7" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">ID(每个运动员的唯一标识符，以说明重复的姓名)</li><li id="455a" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">名字</li><li id="1c73" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">性别(F代表女性，M代表男性)</li><li id="5fbf" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">年龄</li><li id="b3f1" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">高度(厘米)</li><li id="72e8" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">重量(千克)</li><li id="e4cf" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">组</li><li id="c134" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">NOC——由国家奥林匹克委员会为每个国家制定的三个字母的代码(例如，USA:美利坚合众国)</li><li id="1ca6" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">游戏(例如，2008年夏季，2010年冬季)</li><li id="2ec0" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">年</li><li id="0fa5" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">季节(夏季或冬季)</li><li id="873a" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">城市(如东京)</li><li id="4805" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">运动(如网球)</li><li id="133d" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">项目(如网球女子单打)</li><li id="69a0" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">奖牌(金、银、铜、钠)</li></ul><h1 id="366c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">初始数据探索</h1><p id="7d47" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，让我们加载数据集:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/25e71e470ba86aa29ce71f64bdd1d407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NIqHrI3G_5AjI_MCoIXYtg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a475" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看哪个国家积累的金牌最多:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="efbf" class="no lw it nk b gy np nq l nr ns">USA    1131<br/>URS     471<br/>GER     319<br/>GBR     289<br/>FRA     264<br/>       ... <br/>HAI       1<br/>FIJ       1<br/>PER       1<br/>HKG       1<br/>SYR       1<br/>Name: NOC, Length: 109, dtype: int64</span></pre><p id="2dd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到美国获得了最多的金牌，截至2016年，共有1131枚奖牌，这是有道理的，因为它自1896年成立以来一直参加奥运会。</p><p id="6fe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看美国在哪个运动项目上赢得了最多的奖牌:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="7dac" class="no lw it nk b gy np nq l nr ns">Athletics                    344<br/>Swimming                     246<br/>Shooting                      54<br/>Wrestling                     52<br/>Boxing                        50<br/>Diving                        48<br/>Gymnastics                    35<br/>Rowing                        33<br/>Speed Skating                 29<br/>Basketball                    23<br/>Tennis                        21<br/>Sailing                       19<br/>Weightlifting                 16<br/>Cycling                       16<br/>Alpine Skiing                 16<br/>Figure Skating                15<br/>Archery                       14<br/>Equestrianism                 11<br/>Snowboarding                  10<br/>Freestyle Skiing               8<br/>Bobsleigh                      7<br/>Beach Volleyball               6<br/>Synchronized Swimming          5<br/>Canoeing                       5<br/>Short Track Speed Skating      4<br/>Fencing                        4<br/>Football                       4<br/>Art Competitions               4<br/>Skeleton                       3<br/>Golf                           3<br/>Softball                       3<br/>Ice Hockey                     3<br/>Water Polo                     3<br/>Rugby                          3<br/>Volleyball                     3<br/>Judo                           2<br/>Taekwondo                      2<br/>Nordic Combined                1<br/>Jeu De Paume                   1<br/>Baseball                       1<br/>Triathlon                      1<br/>Roque                          1<br/>Tug-Of-War                     1<br/>Polo                           1<br/>Name: Sport, dtype: int64</span></pre><p id="1908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，看起来美国以344枚金牌在田径项目上独占鳌头，其次是游泳项目，有246枚金牌。但是，我需要注意的是，截至2016年里约奥运会，田径项目的实际金牌数为<a class="ae ky" href="https://www.nbcsports.com/northwest/tokyo-olympics/us-olympic-medal-records-history-our-countrys-biggest-wins" rel="noopener ugc nofollow" target="_blank"> 335枚。截至2018年，当这些数据汇总在一起时，大多数剩余的运动项目都有正确的统计数据，然而，在过去如何计算奖牌方面存在一些轻微的差异。例如，在击剑比赛中，数据显示美国获得了4枚奖牌，但一些消息来源却报道了3枚。这是由于1904年国际奥委会将美国人艾伯特森·范·佐·波斯特算作代表古巴而不是美国的</a><a class="ae ky" href="https://en.wikipedia.org/wiki/Fencing_at_the_1904_Summer_Olympics" rel="noopener ugc nofollow" target="_blank">差异</a>T5造成的。在该数据集中，假设美国人表示。我推测，在奥运会早期的田径比赛中也有类似的争议，这可以解释略高的数字，所以我鼓励读者在得出结论之前，与官方的奥运资料进行交叉验证，以自己对这个数据集的分析。尽管如此，上面这些统计数据大部分都是正确的，比如游泳和网球。</p><p id="7f05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以根据运动发生的季节来划分运动项目:冬天或夏天。既然田径和游泳是夏季项目，让我们来看看美国在哪个冬季项目中获得了最多的金牌:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="a497" class="no lw it nk b gy np nq l nr ns">Speed Skating                29<br/>Alpine Skiing                16<br/>Figure Skating               14<br/>Snowboarding                 10<br/>Freestyle Skiing              8<br/>Short Track Speed Skating     4<br/>Skeleton                      3<br/>Ice Hockey                    3<br/>Nordic Combined               1<br/>Name: Sport, dtype: int64</span></pre><p id="3641" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">美国以29枚奖牌获得了最多的速滑金牌，但似乎夏天才是美国真正闪光的地方。让我们看看哪个国家在冬奥会上赢得了最多的金牌。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="d500" class="no lw it nk b gy np nq l nr ns">NOR    111<br/>USA     96<br/>GER     86<br/>URS     77<br/>CAN     62<br/>AUT     59<br/>SUI     50<br/>SWE     50<br/>RUS     49<br/>FIN     42<br/>GDR     39<br/>ITA     37<br/>NED     37<br/>FRA     31<br/>KOR     26<br/>CHN     12<br/>FRG     11<br/>GBR     11<br/>JPN     10<br/>EUN      9<br/>CZE      7<br/>BLR      6<br/>AUS      6<br/>POL      6<br/>CRO      4<br/>EST      4<br/>SVK      2<br/>SLO      2<br/>UKR      2<br/>LIE      2<br/>TCH      2<br/>ESP      1<br/>KAZ      1<br/>IND      1<br/>BEL      1<br/>NEP      1<br/>UZB      1<br/>BUL      1<br/>Name: NOC, dtype: int64</span></pre><p id="b2e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">挪威也没有NOC代码，根据该数据集，挪威在冬季奥运会上以111枚金牌领先。然而，截至2014年索契冬奥会(这是该数据集中最近的一次冬季奥运会)，官方统计数据为118次，其中缺少了一些1992年和1994年的数据。然而，像田径运动一样，这并不是一个巨大的偏差。</p><p id="6973" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们可以看到挪威在冬季奥运会上占主导地位的运动:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="7a6c" class="no lw it nk b gy np nq l nr ns">Cross Country Skiing    33<br/>Speed Skating           25<br/>Biathlon                15<br/>Nordic Combined         13<br/>Alpine Skiing           10<br/>Ski Jumping              9<br/>Figure Skating           3<br/>Freestyle Skiing         2<br/>Curling                  1<br/>Name: Sport, dtype: int64</span></pre><p id="2eba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，越野滑雪是挪威的强项，共获得33枚金牌。</p><p id="ba7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用熊猫的<code class="fe nt nu nv nk b">crosstab</code>函数来可视化这些奖牌分布</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/5986507e4357194fcc75cd4ba0dadc95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l888faYsRpXQsVlRMFnMGw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1bdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与美国相比</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/f9656f44da9639a8612f1a6991c4f00c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m3m3t_SSxaSdfSMgk0_IwA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8098" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，并不是每一项冬季运动都有代表，因为美国并没有在每一项冬季运动中获得奖牌。例如，冬季两项没有出现，不像在挪威的图表中也有一些运动没有出现。</p><h1 id="7c61" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">广义线性建模</h1><p id="c6a6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们已经做了一些基本的汇总统计，让我们看看我们是否可以建立一个模型来预测单个运动员(而不是一支球队/国家)赢得奖牌的机会。有各种方法可以做到这一点，如训练神经网络，但在本文中，我们将重点放在广义线性模型(GLM)。</p><p id="5948" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回想一下，线性回归通过一些解释变量<em class="nx"> X </em>的线性组合，对一个连续变量<em class="nx"> y </em> ~ N( <em class="nx"> μ </em>，<em class="nx"> σ </em>)进行建模。例如，我们可以根据运动员的身高和性别预测他们的体重，如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/115bf104f2331d8efaed66e98708945f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Ped5RTbAK-mZNH69iJD5w.png"/></div></div></figure><p id="0bd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中<em class="nx"> β </em>是第<em class="nx"> i </em>名运动员的每个特征的系数——在这种情况下，是身高和性别——而<em class="nx"> ϵ </em>是残差的误差项。这可以更概括地描述为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/492a29f3d295856d078e6f0b3e72f9b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZX3dZikfLLLvszqO-uZUrg.png"/></div></div></figure><p id="fde9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于线性回归的更深入的讨论，见<a class="ae ky" href="https://medium.com/nerd-for-tech/hypothesis-testing-on-linear-regression-c2a1799ba964" rel="noopener">这里</a>和<a class="ae ky" href="https://medium.com/analytics-vidhya/understanding-the-linear-regression-808c1f6941c0" rel="noopener">这里</a>。</p><p id="b83b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像这样的线性回归模型满足三个关键属性:</p><ol class=""><li id="e7c9" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu oa my mz na bi translated">它们有一个随机成分<em class="nx">y</em>——我们的因变量——遵循正态分布。</li><li id="93ca" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu oa my mz na bi translated">如上所述定义的线性预测器，通常称为<em class="nx"> η </em></li><li id="7251" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu oa my mz na bi translated">将线性预测器连接到均值的链接函数<em class="nx"> g </em>在线性模型的情况下，<em class="nx"> g </em>是恒等链接函数g，因此<em class="nx">g(ηᵢ</em>)=<em class="nx">ηᵢ=</em><em class="nx">μᵢ</em>。</li></ol><p id="6f30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在假设我们想预测自奥运会以来每个国家获得的奖牌数。因为我们的<em class="nx"> y </em>变量统计的是奖牌数，它是一个离散变量，违背了线性回归中使用的正态分布下连续变量的假设。在这种情况下，更合适的模型是泊松回归模型。这是一个广义线性模型(GLM)的例子。</p><p id="4581" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">广义线性模型在某种意义上是广义的，尽管在它的根部仍然有一个线性模型，但是随机分量<em class="nx"> y </em>可以是分布的<a class="ae ky" href="https://people.eecs.berkeley.edu/~jordan/courses/260-spring10/other-readings/chapter8.pdf" rel="noopener ugc nofollow" target="_blank">指数族</a>的任何成员(例如，正态、伽玛、泊松等)，并且链接函数可以是任何函数，只要它是平滑且可逆的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/b83d73ec42ab08a05da1a0a9e96e21b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yyp6tiQRKppxWsXiTtYp5Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想模拟一名运动员是否获得了奖牌:铜牌、银牌或金牌。因为这是一个二元结果，我们的响应变量<em class="nx"> y </em>应该遵循伯努利分布<em class="nx"> y </em> ~ Bin(1 <em class="nx">，p </em> )=Ber( <em class="nx"> p </em>)，我们的线性预测器的链接函数定义如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ccd3238fcb11cd65b71811b58fdc9347.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*VGAOC1P2Y07ywmtDsiBfUQ.png"/></div></figure><p id="0003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在哪里</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/5474f924d288217e67abd57cc4d7e26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sXO2jOs3TtyFr2RXNQa30w.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/267a13997a52764589ec337ef4052b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*ka22k74US-MC0eMwUIlxNQ.png"/></div></figure><p id="a3d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">逆logit函数称为逻辑函数，它基于线性预测值对赢得奖牌的概率进行建模。由于通常<em class="nx"> n </em> = 1(因此我们得到<em class="nx"> μᵢ </em> = <em class="nx"> pᵢ </em>)，这个模型被称为逻辑回归。</p><p id="3472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将以游泳为例，展示具有物流链接功能的GLM:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/93617139622b39579078efa95dc73250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_yQ1cthwlnlWm-rYcGXBQQ.png"/></div></div></figure><p id="c26a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，有几个身高和体重条目是NaNs，因此我们将删除这些条目以及年龄，以便更好地衡量:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/3573712c7bdcedbbcd25186696c33d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gWbqGEk7twdxfuE33lL8Fw.png"/></div></div></figure><p id="577c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还将我们的响应变量Medal建模为0代表北美，1代表金牌、银牌或铜牌</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="105d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们将性别编码为0代表男性，1代表女性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6a22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们准备好构建我们的模型了。我们将使用<code class="fe nt nu nv nk b">statsmodels</code>和<code class="fe nt nu nv nk b">patsy </code>包，您可以使用pip来安装它们。<code class="fe nt nu nv nk b">statsmodels</code>包含了我们将需要来适应我们的GLM的函数，而<code class="fe nt nu nv nk b">patsy</code>是一个用户友好的库，用于构建我们可以使用以前的包来适应的统计模型。让我们从一些简单的事情开始，建立年龄和奖牌结果之间的关系模型。我们将首先安装软件包并运行以下代码:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="654b" class="no lw it nk b gy np nq l nr ns">pip install statsmodels<br/>pip install patsy</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="caaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行此代码，我们获得以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/171e3e526c288b577b5c8d366002f7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PJdEMeRGxDHKXVwb2SB7Zg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="14e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个输出包含很多内容，但是我希望您关注的主要内容是两行，截距和年龄，以及偏差。对于前两行中的每一行，它们都列出了该参数的估计系数β、标准误差、z得分、表示模型中该预测值显著性的p值以及估计系数β的置信区间。</p><p id="241c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">偏差是对<a class="ae ky" href="https://www.statisticshowto.com/residual-sum-squares/" rel="noopener ugc nofollow" target="_blank">残差平方和</a>的概括，它量化了GLMs的拟合优度。理想情况下，我们希望这个度量小于<em class="nx"> n-p </em>，其中<em class="nx"> n </em>是观察值的数量(18776)，而<em class="nx"> p </em>是我们模型中的参数数量(2)。因此我们的偏差是14645&lt;18776–2 = 18774。因此，模型通过了拟合优度测试，但让我们尝试将其可视化。<code class="fe nt nu nv nk b">statsmodels</code>没有用于GLMs的直观绘图库，但我们可以使用<code class="fe nt nu nv nk b">matplotlib</code>绘图库轻松地对其进行编码，绘制拟合概率与年龄的关系。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/e7cfc2d8d98913da155b9b8dd2414eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*eRoC-4pEJHNPRyn_RiaSxA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="08ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这并没有真正给我们一个很好的拟合，这是有道理的，因为年龄不一定与性能的增长率相关联。让我们尝试添加额外的特征，比如身高、体重和性别。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/dbec758f521869847d8092e2bc01baff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-0NoFDh0id3Bcmcy-wIGuw.png"/></div></div></figure><p id="2f9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据高度绘图，我们获得了稍微好一点的拟合，正如偏差从14645下降到14202所证明的那样，但它仍然不能有效地给我们的数据一个稳健的拟合。年龄不是一个具有高p值的重要预测因素，这在我们的年龄模型中并不令人惊讶。</p><p id="0314" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回想一下，美国的第二大运动是游泳，所以我们可以将美国作为一个解释变量。与该数据集中的性别二进制分类(不包括任何非二进制运动员)不同，国家(NOC)是一个跨越两个以上类别的分类变量，因此我们需要以这样一种方式修改它，即我们有一个列来指定某个运动员是否代表美国。<code class="fe nt nu nv nk b">pandas</code>有一个函数<code class="fe nt nu nv nk b">get_dummies()</code>，它创建一个虚拟变量，将输入列的每个分类变量二进制化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/d8a9988368aecbe7b5fd21d9f2bab6ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJ6iGaX4IAievbkzY-_OSQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="eb38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将删除NOC列，取而代之的是为每个国家添加二进制列，以“NOC_”为前缀，表示某个运动员是否代表该国。因此，“NOC_USA”告诉我们一名参赛运动员是否代表美国，而“NOC_CAN”告诉我们一名运动员是否代表加拿大。</p><p id="3efd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们将这个新变量添加到我们的模型中，看看它是否能更好地拟合我们的游泳数据。我们将删除年龄，因为它的表现不佳，并再次按高度绘图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/f66a0be93e793ef63b83421f82e5387e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZC6g_IwRpziZmqGnnD5C9Q.png"/></div></div></figure><p id="0fc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这给了我们一个比以前的模型更好的拟合，从14202年到11922年偏差的显著下降也可以看出这一点。鉴于美国在游泳方面的声誉，根据数据，成为美国人会增加一个人成功的机会是有道理的。如果我们建立0.6或0.7的截止概率作为决定奖牌结果的阈值，我们将获得非常接近二进制数据的拟合。</p><h1 id="7cd8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="d55f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们学习了GLMs，使用一个综合的奥运会数据集作为逻辑回归的例子，以及一些数据格式化/清理技术。虽然GLMs是统计建模的强大工具，但它们也有缺点。如果数据集包含大量要素，则可能会过度拟合模型或遇到性能计算瓶颈，具体取决于数据集的大小。此外，还有其他不在该数据集中的特征可以改进我们的模型，例如在非奥运场馆的运动表现(例如网球的温布尔登)。还有其他可能更有效的数据建模方法，如支持向量机或神经网络。最后，对于像这样的历史数据集，很可能会因为有争议的视图而导致缺失值或错误，因此当您从该数据集和类似数据集得出结论时，请记住这一点。</p><p id="1eef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章。我鼓励你自己尝试这个数据集并进行分析。请在下面的评论中告诉我你的经历，或者如果你有任何问题。编码快乐！</p></div></div>    
</body>
</html>