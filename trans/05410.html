<html>
<head>
<title>Concepts about Positional Encoding You Might Not Know About</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您可能不知道的位置编码概念</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/concepts-about-positional-encoding-you-might-not-know-about-1f247f4e4e23?source=collection_archive---------9-----------------------#2021-05-13">https://towardsdatascience.com/concepts-about-positional-encoding-you-might-not-know-about-1f247f4e4e23?source=collection_archive---------9-----------------------#2021-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="22e0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于Transformer中的位置编码，您只需要知道</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/29d42912af2138101be569854eb2954a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5chJb8JPTz13kpRYAy2jOg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/s/visual/738f86ea-52ed-4701-9cca-9f8198fa1674?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@corina?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> corina ardeleanu </a>拍摄的照片</p></figure><p id="79ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在LSTM RNN，单词是按顺序输入的，因此它能理解单词的顺序。随着刑期的增加，在LSTM复发将需要大量手术。但是在transformer中，我们并行处理所有的单词。这有助于减少培训时间。为了记住单词的顺序，引入了位置编码的概念。这是一种表示单词位置的编码。简而言之，我们将位置编码添加到现有的单词嵌入中，这将为我们提供最终的预处理嵌入，它将用于编码器部分。</p><p id="f683" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:- </strong>在开始这篇博文之前，我强烈推荐访问我之前关于变形金刚 概述的<a class="ae kv" rel="noopener" target="_blank" href="/transformers-you-just-need-attention-f3775734c0da"> <strong class="ky ir">博文。</strong></a></p><h2 id="fa25" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">位置嵌入的不同技术:-</h2><ol class=""><li id="d405" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated"><strong class="ky ir">位置嵌入=单词索引</strong></li></ol><p id="d530" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，如果句子的长度是30。那么对应于每个单词，索引号可以是它的位置嵌入，如下图所示:-</p><p id="6fad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，如果句子的长度是30。那么对应于每个单词，索引号可以是它的位置嵌入，如下图所示:-</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/461474c5ba7eac6b08142357c15a8f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*coerL38n85zr0n3l.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">位置嵌入和单词嵌入相加得到最终嵌入<strong class="bd mx">(作者的</strong>图片)</p></figure><p id="3c1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用这种编码方式，但问题是随着句子长度的增加，位置嵌入的大值支配了原始单词嵌入，因此扭曲了单词嵌入的值。因此，我们在自然语言处理任务中放弃了这种方法。</p><p id="3658" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2。位置=句子长度的分数。</strong></p><p id="1d85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们将嵌入值转换为长度的一部分，即1/N，其中N=字数，它应该可以工作，因为值将被限制在0和1之间。这里唯一的漏洞是，当我们比较两个不同长度的不同句子时，对于一个特定的索引，位置嵌入值是不同的。一般来说，对于不同长度的句子，位置词嵌入对于特定的索引应该具有相同的值，否则会扭曲对模型的理解。因此，对于我们的自然语言处理任务，我们放弃了这种方法，而采用基于频率的位置编码方法，正如在原始论文“注意力是你所需要的全部”中提到的。</p><p id="e795" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 3。基于频率的位置嵌入</strong></p><p id="1766" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该论文的作者提出了一个独特的想法，即使用波频率来捕捉位置信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/568605065c1ced1757dd0d60a6725b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*79mkzjnmskAJOlD3lC3xog.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">正弦函数(图片由作者提供)</p></figure><p id="a98a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于第一位置嵌入，</p><p id="af50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">位置=0</p><p id="3dd8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">d=嵌入的大小，应等于现有嵌入的尺寸。</p><p id="6ae8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">i=每个位置嵌入维度的索引，也表示频率(i=0是最高频率)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/130a050cd76e1049e8dce792daaffd4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*uT3cKkL65hzqV_4l7wYwpw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">位置嵌入(作者图片)</p></figure><p id="bdcb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在第一个正弦曲线图中(其中i=4)，我们绘制了具有不同位置值的正弦曲线，其中位置表示单词的位置。由于正弦曲线的高度取决于x轴上的位置，我们可以使用高度来绘制单词位置。由于曲线高度以固定长度变化，且不依赖于文本长度，这种方法有助于克服前面讨论的限制。请查看这个令人敬畏的<a class="ae kv" href="https://www.youtube.com/watch?v=dichIcUZfOw&amp;t=606s" rel="noopener ugc nofollow" target="_blank">视频</a>了解更多。</p><p id="bb67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">值介于-1和1之间。并且随着长度的增加，位置编码值保持不变。但是在从下面看的平滑正弦曲线中(其中i=4)，我们看到y轴上的<strong class="ky ir">字位置0 </strong>和<strong class="ky ir">字位置5 </strong>的距离非常小。为了克服这一点，我们提高了频率(freq =秒内完成的周期数)。如果我们这样做，那么在上面的第一条正弦曲线(i=0)中，我们看到<strong class="ky ir">位置0 </strong>和<strong class="ky ir">位置5 </strong>之间的距离清晰可见。</p><p id="0adc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作者使用了正弦和余弦函数的组合来获得这些嵌入。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/7235eaba4aeb1827ba7659640eaa5a58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1KsZk0lnuZ2K8MrJn2LHmA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">波频(图片由作者提供)</p></figure><p id="f376" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们编码这个</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/f7db772f9b7643d3cc03b2cba4229814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mOfwiFzHVCfvrqEyvgp08g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用于生成位置嵌入的代码(图片由作者提供)</p></figure><p id="3e71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出预览为:-</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/512ae4ca6c4e7ea6cac14dbadc2f93fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/0*5UGJYxnufd2H2zsl.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">以上代码输出(图片由作者提供)</p></figure><p id="b581" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们可以看到第一个和第二个单词的接近度/紧密度很高，因此余弦相似度很高，而第一个和第九个单词之间的距离很远，因此余弦相似度很低。</p><p id="5109" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是位置编码，如果你喜欢，可以和你的朋友分享。在那之前，</p></div></div>    
</body>
</html>