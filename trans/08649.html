<html>
<head>
<title>A Beginner’s Guide to Graph Neural Networks Using PyTorch Geometric — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyTorch几何图形的神经网络初学者指南—第1部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-1-d98dc93e7742?source=collection_archive---------1-----------------------#2021-08-10">https://towardsdatascience.com/a-beginners-guide-to-graph-neural-networks-using-pytorch-geometric-part-1-d98dc93e7742?source=collection_archive---------1-----------------------#2021-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="162f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">PyTorch几何入门</h2></div><blockquote class="ki kj kk"><p id="32a0" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">不知何故，你偶然发现了图形神经网络，现在你有兴趣用它来解决一个问题。让我们探索一下如何使用我们可以使用的不同工具来建模一个问题。</p></blockquote><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi li"><img src="../Images/91968ffe2edb4e802b5b291eb4fa1b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-VLap2Pgremq1uMh_vk-g.jpeg"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">来自<a class="ae ly" href="https://www.pexels.com/photo/ferris-wheel-at-night-2911364/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的照片</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="9a48" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">首先，我们需要解决一个问题。</p><h1 id="c5f2" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">开始使用。</h1><p id="70c3" class="pw-post-body-paragraph kl km it ko b kp nb ju kr ks nc jx ku mg nd kx ky mh ne lb lc mi nf lf lg lh im bi translated">让我们挑选一个简单的图形数据集，比如<a class="ae ly" href="https://en.wikipedia.org/wiki/Zachary%27s_karate_club" rel="noopener ugc nofollow" target="_blank">扎卡里的空手道俱乐部</a>。这里，节点代表参与俱乐部的34名学生，链接代表俱乐部外成对成员之间的78种不同互动。有两种不同类型的标签<em class="kn">即</em>两派。我们可以使用这些信息来制定节点分类任务。</p><p id="0408" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">我们将图分为训练集和测试集，其中我们使用训练集来构建图神经网络模型，并使用该模型来预测测试集中的缺失节点标签。</p><p id="3508" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">这里我们用<a class="ae ly" href="https://github.com/rusty1s/pytorch_geometric" rel="noopener ugc nofollow" target="_blank"> <strong class="ko iu"> PyTorch几何</strong> </a> <strong class="ko iu"> </strong> (PyG) python库来建模图形神经网络。或者，<a class="ae ly" href="https://docs.dgl.ai/" rel="noopener ugc nofollow" target="_blank">深度图形库</a> (DGL)也可以用于同样的目的。</p><p id="cabb" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">PyTorch Geometric是一个基于PyTorch构建的几何深度学习库。已经使用PyG实现了几种流行的图形神经网络方法，您可以使用内置数据集来研究代码，或者创建自己的数据集。PyG使用了一个漂亮的实现，它提供了一个InMemoryDataset   类，可以用来创建自定义数据集(<em class="kn">注意:InMemoryDataset应该用于小到足以加载到内存中的数据集</em>)。</p><p id="8284" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">Zachary的空手道俱乐部图表数据集的简单可视化如下所示:</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ng"><img src="../Images/98a5d90559060a838ccb1a068d2fb44f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4jMXW67NyNDVw_ofmu7GJw.jpeg"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">扎卡里空手道俱乐部图形数据可视化(来源:me)</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="25fd" class="mj mk it bd ml mm nh mo mp mq ni ms mt jz nj ka mv kc nk kd mx kf nl kg mz na bi translated">公式化问题。</h1><p id="4b9d" class="pw-post-body-paragraph kl km it ko b kp nb ju kr ks nc jx ku mg nd kx ky mh ne lb lc mi nf lf lg lh im bi translated">为了阐明这个问题，我们需要:</p><ol class=""><li id="a98d" class="nm nn it ko b kp kq ks kt mg no mh np mi nq lh nr ns nt nu bi translated">图形本身和每个节点的标签</li><li id="5604" class="nm nn it ko b kp nv ks nw mg nx mh ny mi nz lh nr ns nt nu bi translated"><a class="ae ly" href="https://scipy-lectures.org/advanced/scipy_sparse/coo_matrix.html" rel="noopener ugc nofollow" target="_blank">坐标格式的边缘数据</a>(首席运营官)</li><li id="9ac1" class="nm nn it ko b kp nv ks nw mg nx mh ny mi nz lh nr ns nt nu bi translated">节点的嵌入或数字表示</li></ol><blockquote class="ki kj kk"><p id="8856" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">注意:对于节点的数字表示，我们可以使用图的属性，如度，或者使用不同的嵌入生成方法，如<a class="ae ly" href="https://github.com/eliorc/node2vec" rel="noopener ugc nofollow" target="_blank"> node2vec </a>、<a class="ae ly" href="https://github.com/phanein/deepwalk" rel="noopener ugc nofollow" target="_blank"> DeepWalk </a>等。在这个例子中，我将使用节点度作为它的数字表示。</p></blockquote><p id="4bb6" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">让我们进入编码部分。</p><h1 id="8eda" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">准备工作。</h1><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="22ae" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">空手道俱乐部数据集可以直接从NetworkX库中加载。我们从图中检索标签，并以坐标格式创建边索引。节点度被用作节点的嵌入/数字表示(在有向图的情况下，入度可以用于相同的目的)。由于学位值往往是多种多样的，我们在使用这些值作为GNN模型的输入之前对它们进行归一化。</p><p id="87fd" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">至此，我们已经准备好了构建Pytorch几何自定义数据集的所有必要部分。</p><h1 id="afe1" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">自定义数据集。</h1><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="7e33" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated"><em class="kn"> KarateDataset </em>类继承自<em class="kn"> InMemoryDataset类</em>，并使用一个数据对象来整理与空手道俱乐部数据集相关的所有信息。然后将图形数据分割成训练集和测试集，从而使用分割创建训练和测试掩码。</p><p id="8f69" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">数据对象包含以下变量:</p><blockquote class="oc"><p id="ea32" class="od oe it bd of og oh oi oj ok ol lh dk translated"><em class="om">数据(edge_index=[2，156]，num_classes=[1]，test_mask=[34]，train_mask=[34]，x=[34，1]，y=[34]) </em></p></blockquote><p id="2580" class="pw-post-body-paragraph kl km it ko b kp on ju kr ks oo jx ku mg op kx ky mh oq lb lc mi or lf lg lh im bi translated">这个自定义数据集现在可以与Pytorch几何库中的几个图形神经网络模型一起使用。让我们挑选一个图卷积网络模型，并使用它来预测测试集上的缺失标签。</p><blockquote class="ki kj kk"><p id="2ade" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">注意:PyG库更侧重于节点分类任务，但它也可以用于链接预测。</p></blockquote><h1 id="f391" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">图卷积网络。</h1><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="75d3" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">GCN模型由两个隐层构成，每个隐层包含16个神经元。让我们训练模型！</p><h1 id="abac" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">训练GCN模型。</h1><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="d43d" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">随机超参数的初始实验给出了这些结果:</p><blockquote class="oc"><p id="9719" class="od oe it bd of og oh oi oj ok ol lh dk translated">训练精度:0.913 <br/>测试精度:0.727</p></blockquote><p id="add1" class="pw-post-body-paragraph kl km it ko b kp on ju kr ks oo jx ku mg op kx ky mh oq lb lc mi or lf lg lh im bi translated">这并不令人印象深刻，我们当然可以做得更好。在我的下一篇文章中，我将讨论我们如何使用<a class="ae ly" href="https://optuna.org/#code_examples" rel="noopener ugc nofollow" target="_blank"> Optuna </a>(关于超参数调优的python库)来轻松地调优超参数并找到最佳模型。本例中使用的代码取自PyTorch Geometric的GitHub库，并做了一些修改(<a class="ae ly" href="https://github.com/rusty1s/pytorch_geometric/blob/master/examples/gcn.py" rel="noopener ugc nofollow" target="_blank">链接</a>)。</p><h1 id="be01" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">总结。</h1><p id="eed7" class="pw-post-body-paragraph kl km it ko b kp nb ju kr ks nc jx ku mg nd kx ky mh ne lb lc mi nf lf lg lh im bi translated">总结一下我们到目前为止所做的一切:</p><ol class=""><li id="538b" class="nm nn it ko b kp kq ks kt mg no mh np mi nq lh nr ns nt nu bi translated">为图中的每个节点生成数字表示(在本例中为节点度数)。</li><li id="7330" class="nm nn it ko b kp nv ks nw mg nx mh ny mi nz lh nr ns nt nu bi translated">构建一个PyG自定义数据集，并将数据分为训练和测试两部分。</li><li id="33f8" class="nm nn it ko b kp nv ks nw mg nx mh ny mi nz lh nr ns nt nu bi translated">使用像GCN这样的GNN模型并训练该模型。</li><li id="2fb5" class="nm nn it ko b kp nv ks nw mg nx mh ny mi nz lh nr ns nt nu bi translated">对测试集进行预测，并计算准确度分数。</li></ol><p id="f8d1" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">鸣谢:<br/>这篇文章中的大部分解释都是我在Cesson-sévigne的Orange Labs实习期间学到并应用的概念。我研究过图形嵌入方法，也研究过可以应用于知识图的图形神经网络。</p><p id="2af2" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">在接下来的部分中，我将更多地解释我们如何使用图嵌入作为初始节点表示来处理相同的节点分类任务。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="2995" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku mg kw kx ky mh la lb lc mi le lf lg lh im bi translated">感谢阅读，干杯！</p><pre class="lj lk ll lm gt os ot ou ov aw ow bi"><span id="36a2" class="ox mk it ot b gy oy oz l pa pb"><strong class="ot iu">Want to Connect?</strong></span><span id="698d" class="ox mk it ot b gy pc oz l pa pb">Reach me at <a class="ae ly" href="https://www.linkedin.com/in/rohithteja/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="ae ly" href="https://twitter.com/rohithtejam" rel="noopener ugc nofollow" target="_blank">Twitter</a>, <a class="ae ly" href="https://github.com/rohithteja" rel="noopener ugc nofollow" target="_blank">GitHub</a> or just <a class="ae ly" href="https://www.buymeacoffee.com/rohithteja" rel="noopener ugc nofollow" target="_blank">Buy Me A Coffee</a>!</span></pre></div></div>    
</body>
</html>