<html>
<head>
<title>Python Pandas Interview Questions for Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python熊猫面试数据科学的问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-pandas-interview-questions-for-data-science-377dfac4a7a1?source=collection_archive---------23-----------------------#2021-11-09">https://towardsdatascience.com/python-pandas-interview-questions-for-data-science-377dfac4a7a1?source=collection_archive---------23-----------------------#2021-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8dc6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">利用熊猫进行Python数据科学面试试题</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/d95f25a297dca038380bc4621bd3c6a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ReVhN6eEZBjsgnUG"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kw" href="https://unsplash.com/@wocintechchat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christina @ wocintechchat.com</a>拍摄的照片</p></figure><p id="8877" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在上一篇文章<a class="ae kw" href="https://www.stratascratch.com/blog/python-pandas-interview-questions-for-data-science/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> <em class="lt"> Python Pandas数据科学面试问题第1部分</em> </a>中，我们研究了如何将数据导入Pandas并执行基本计算，例如</p><ul class=""><li id="995c" class="lu lv iq kz b la lb ld le lg lw lk lx lo ly ls lz ma mb mc bi translated">排序数据帧</li><li id="9ec2" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">处理重复</li><li id="0952" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">聚集</li><li id="6b13" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">合并数据帧</li><li id="322f" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">计算字段</li></ul><p id="169c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这一部分中，我们将基于这些知识，用它们来解决更复杂的Python熊猫面试问题。我们将关注以下领域</p><ul class=""><li id="3d76" class="lu lv iq kz b la lb ld le lg lw lk lx lo ly ls lz ma mb mc bi translated">日期时间操作</li><li id="536d" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">文本操作</li><li id="1927" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">应用函数</li><li id="7363" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">高级聚合</li><li id="c090" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">偏移数据</li><li id="0882" class="lu lv iq kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated">使用熊猫的统计</li></ul><p id="fdf2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你不熟悉熊猫图书馆，请浏览那篇文章。让我们开始吧。</p><h1 id="eff4" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">应用函数</h1><p id="4b0c" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">在本系列的前一部分中，我们研究了如何创建额外的字段。我们也可以使用Python库中的函数或用户定义的函数来操作值。为此，我们使用apply()方法。apply()方法使用矢量化，因此与遍历序列中的每一行相比，可以更快地计算值。这里有一个来自AirBnB数据科学采访的简单问题。</p><p id="39ad" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">T11】</strong></p><p id="d451" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">生活设施最多的城市</strong></p><p id="cfcf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">从Airbnb上给定的房产搜索数据集中，找出主人所有房产中设施最多的城市。假设每行代表一个唯一的主机。输出城市名称作为您的解决方案。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nf"><img src="../Images/944030ba18d222922cba325c66a535f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgD5ViETv61mGkMvODvwdA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="4044" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决这个Python熊猫面试问题。<a class="ae kw" href="https://platform.stratascratch.com/coding/9633-city-with-most-amenities?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/9633-拥有最多便利设施的城市？python=1 </a></p><p id="f275" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题使用包含这些字段的<strong class="kz ir"> airbnb_search_details </strong>数据集</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ng"><img src="../Images/1cd9d07bb6dc131f6a43c31220d5b72e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-Pc2NEvLdXw1QttrZFtmw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="7ef7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">以下是数据的显示方式。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nh"><img src="../Images/2c22c125ee87cad01f546625e4715a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AXk-5hZ2-qhlmauTAHH2_w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="e8e5" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="a837" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">让我们把这个问题分解一下。给定酒店的所有便利设施都在便利设施栏中给出。便利设施以逗号分隔的字符串形式列出。我们通过简单地使用逗号分隔符分割字符串并取结果列表的长度来找到便利设施的数量。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="c1ee" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># get the number of number of amenities<br/>airbnb_search_details['num_amenities'] = airbnb_search_details<br/>['amenities'].apply(lambda x : len(x.split(",")))<br/>airbnb_search_details[['city', 'id', 'amenities', 'num_amenities']]</span></pre><p id="9c09" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据集现在看起来像这样。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi od"><img src="../Images/0ec8acfd1b40095fec67b01356a205df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-ALAX29vYgB6BL2cBT5RA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="0243" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们现在可以简单地合计每个城市的设施数量，并输出设施数量最多的城市。我们可以使用方法链接将所有这些方法组合在一行中。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="24b8" class="ni mj iq nv b gy nz oa l ob oc"># Summarize by city and output the city with the most amenities<br/>airbnb_search_details.groupby(by = ['city'], as_index = False).agg<br/>({'num_amenities' : 'sum'}).sort_values(by = ['num_amenities'], <br/>ascending = False).reset_index()['city'][0]</span></pre><p id="0ffc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们不局限于内置函数。我们可以创建自己的函数，也可以动态创建lambda函数。让我们在下面的Python熊猫采访问题中尝试一下。这个出现在旧金山数据科学采访中。</p><p id="f59e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">划分业务类型</strong></p><p id="3f1b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">将每家企业归类为餐馆、咖啡馆、学校或其他。被归类为餐馆的企业名称中应包含“餐馆”一词。对于咖啡馆，企业名称中应包含“咖啡馆”、“咖啡馆”或“咖啡”。学校会有‘学校’这个词。根据上述规则，如果企业不是餐馆、咖啡馆或学校，则应归类为“其他”</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oe"><img src="../Images/bf365ca53dc0779fa74b9e5261cec392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X0mn3vUr3x7CO0xWJpOgnQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="b5f8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决这个python面试问题。<a class="ae kw" href="https://platform.stratascratch.com/coding/9726-classify-business-type?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/9726-classify-business-type？python=1 </a></p><p id="4ed2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">此问题使用具有以下字段的<strong class="kz ir">SF _ restaurant _ health _ violations</strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi of"><img src="../Images/0592738b4dbbe23819fb9a05aa5f2b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nl4bmrbfBBn_rbVFjkYBAA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="20d1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据是这样的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi og"><img src="../Images/8b74d62c67a929d53c5ded732f4b6f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wO4OYLL06fQGgFpwe5ivPw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="ca66" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="0e63" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">这个Python Pandas面试问题的唯一相关字段是business_name列。我们编写一个lambda函数，并使用apply方法来检查企业满足了哪些业务规则。一旦我们有了类别，我们就输出问题中所需的相关字段。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="98d6" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Classify as per the rules<br/>sf_restaurant_health_violations['category'] = sf_restaurant_health_violations<br/>['business_name'].apply(lambda x: \<br/>'school' if x.lower().find('school') &gt;= 0 \<br/>else 'restaurant' if x.lower().find('restaurant') &gt;= 0 \<br/>else 'cafe' if (x.lower().find('cafe') &gt;= 0 or x.lower().find('café') &gt;= 0 \<br/>or  x.lower().find('coffee') &gt;= 0) \<br/>else 'other'<br/>    )<br/># Output relevant fields    <br/>sf_restaurant_health_violations[['business_name', 'category']].drop_duplicates()</span></pre><p id="888c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">正如我们所见，apply方法是使用用户定义的函数或Python库中的函数操作值和创建计算字段的一种非常强大的方法。</p><h1 id="e10d" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">高级聚合</h1><p id="e78d" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">在上一篇文章中，我们已经看到了使用groupby方法的聚合。Pandas也支持其他聚合，我们还可以创建一个电子表格风格的数据透视表。让我们看看如何在熊猫身上做到这一点。我们从旧金山市的一个数据科学问题开始。</p><p id="addc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">制作一张数据透视表，找出每位员工每年的最高工资</strong></p><p id="5bad" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">查找从2011年到2014年每年每位员工的最高薪酬。以表格的形式输出结果，列中是年份，行中是按字母顺序排序的员工姓名。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nf"><img src="../Images/1a5b64d642ae736f23cadacbb40eaff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nf9vCPNmutd7ryZokjED_g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="f934" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决这个Python熊猫面试问题。https://platform . stratascratch . com/coding/10145-make-a-pivot-table-to-find-the-high-payment in-year-per-employee？python=1 </p><p id="4fac" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题使用具有以下字段的<strong class="kz ir"> sf_public_salaries </strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/3ff2a5738715c42be4f7758a1aa4ec5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVrCF4jjyGcmnG2-GclbtA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="11b6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据是这样显示的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oi"><img src="../Images/583c10e16a088995722c4e221ad4e9a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iLfvj2NZdHa3zL1ULAMlRQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="8d21" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="264f" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">虽然这个问题对于SQL来说可能有点困难，但是对于Pandas来说，这个问题可以通过使用<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.pivot_table.html" rel="noopener ugc nofollow" target="_blank"> pivot_table()函数</a>在一行代码中解决。我们只需传递正确的参数，并获得想要的输出。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="9e5b" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># create the pivot table <br/>pd.pivot_table(data = sf_public_salaries, columns = ['year'], <br/>index = 'employeename', values = 'totalpay', aggfunc = <br/>'max', fill_value = 0).reset_index()</span></pre><p id="2237" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">pivot_table()方法非常强大，可以帮助快速解决复杂的聚合问题。这是另一个例子。这是来自脸书数据科学的采访。</p><p id="7995" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">两个事件之间的时间</strong></p><p id="40d2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">报告用户从页面加载到第一次向下滚动的最短时间。输出应该包括用户id、页面加载时间、第一次向下滚动时间以及两个事件之间的时间间隔(秒)。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oj"><img src="../Images/720d2f193252d1c4789fddd51dd17948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qeYfq8eX2aX6v0VA8V_R4g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="dc02" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决问题<a class="ae kw" href="https://platform.stratascratch.com/coding/9784-time-between-two-events?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/9784-time-between-two-events？python=1 </a></p><p id="290b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题使用了包含以下各列的<strong class="kz ir"> facebook_web_log </strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ok"><img src="../Images/39ec42670dea85e3f3b7868b8c2dda49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aD3muIyQFX-Z1tuuF8bSLQ.png"/></div></div></figure><p id="66dd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据是这样显示的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ol"><img src="../Images/a9d417060f4bc3a2b9c42ec0f3cf6356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FY6KBsqZd1nngWvBSGlF7A.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="7013" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="1cfb" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">同样，这个面试问题在SQL中可能有点复杂。然而，在熊猫中，使用数据透视表是相对简单的。我们首先创建一个数据透视表，其中包含每个user_id的每个动作的最早实例。因为我们只需要page_load和scroll_down事件，所以我们只在输出中保留那些列。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="4b0a" class="ni mj iq nv b gy nz oa l ob oc">import pandas as pd<br/> <br/># Find the first instance of diffrent actions<br/>summ_df = pd.pivot_table(data = facebook_web_log, index = 'user_id', columns = <br/>'action', aggfunc = 'min', values = 'timestamp').reset_index()[['user_id', <br/>'page_load', 'scroll_down']]</span></pre><p id="0e43" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">输出如下所示。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi om"><img src="../Images/bf38fdf68dc9e6f81eda28b762507cb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNpSHXR1akJDOz4NTwPH6w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="fc3c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在问题变得很简单。我们可以通过获取scroll_down和page_load时间戳之间的差值来直接计算持续时间。然后，我们输出持续时间最短的用户的user_id和其他必填字段。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="4edb" class="ni mj iq nv b gy nz oa l ob oc"># Caclulate duration<br/>summ_df['duration'] = summ_df['scroll_down'] - summ_df['page_load']<br/># Output the user details for the user with the lowest duration<br/>summ_df.sort_values(by = ['duration'])[:1]</span></pre><p id="c42a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如您所见，pivot_table()函数允许我们进行多个聚合，而不必像在SQL中那样将它们分离和合并。</p><h1 id="e3d3" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">日期时间操作</h1><p id="1de5" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">日期时间操作是最常被问到的<a class="ae kw" href="https://www.stratascratch.com/blog/data-science-interview-guide-questions-from-80-different-companies/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">数据科学面试问题</a>之一。datetime数据集的普遍性和一系列可以通过简单的数据实现的复杂性使其成为一个流行的数据科学测试领域。Pandas有许多日期时间函数，涵盖了广泛的日期时间用例。一旦以日期时间格式将数据加载到Pandas中，就可以通过调用。dt访问器。这为我们提供了对各种日期时间方法的访问，这些方法可以通过<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.dt.html" rel="noopener ugc nofollow" target="_blank">整个熊猫系列</a>来访问。</p><p id="76e3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们在一个真实世界的Python熊猫面试问题中使用它。这是一个来自DoorDash数据科学的采访。</p><p id="1d0b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">每个工作日和每个小时的平均收入</strong></p><p id="d736" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">报告一周中每天每小时的平均收入数。使用customer_placed_order_datetime字段计算相关的日期时间值。收益可视为“订单总额”字段的总和。把星期一当作一周的第一天。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi on"><img src="../Images/a7bdb84c51123a33b8f9b494874fb6ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uZHXVfdNpac5PeL1Lfs3kA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="5f93" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决问题:<a class="ae kw" href="https://platform.stratascratch.com/coding/2034-avg-earnings-per-weekday-and-hour?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/2034-avg-earnings-per-weekday-and-hour？python=1 </a></p><p id="94f6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题使用了具有以下字段的<strong class="kz ir"> doordash_delivery </strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oo"><img src="../Images/a72ed10578bb3af592d976485bff989a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cSodA4VIO2v7YULPnwA8Og.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="25e3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据集看起来像这样。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi op"><img src="../Images/dd10b6c4bd8d7c53496cef7877705d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKDrvVFL_6_SU0DRe6Yckg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="91fe" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="a957" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">为了解决这个Python熊猫采访问题，我们需要从相关的datetime字段中提取星期几和小时。如问题中所述，该字段为“客户_已下单_订单_日期时间”。</p><p id="0ad1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了获得星期几，我们使用. dt.weekday属性。根据<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.dt.weekday.html" rel="noopener ugc nofollow" target="_blank">文档</a>，这将为周一返回0，为周日返回6。因为周一我们需要从1开始，所以我们在结果上加1。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="0ca6" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Keep relevant fields<br/>dd_df = doordash_delivery[['customer_placed_order_datetime', 'order_total']]<br/># Get the day of the week (add 1 to keep have Monday = 1)<br/>dd_df['weekday'] = dd_df['customer_placed_order_datetime'].dt.weekday + 1</span></pre><p id="df50" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">同样，我们也可以提取一天中的小时。为此，我们使用datetime对象的. dt.hour属性。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="39fc" class="ni mj iq nv b gy nz oa l ob oc"># Hour of the day<br/>dd_df['hour'] = dd_df['customer_placed_order_datetime'].dt.hour</span></pre><p id="f9b9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们现在可以简单地按一周中的某一天和一天中的某个小时进行聚合，并输出相关的列。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="56af" class="ni mj iq nv b gy nz oa l ob oc">dd_df.groupby(by = ['weekday', 'hour'], as_index = False).agg<br/>({'order_total': 'mean'})</span></pre><p id="b52f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们尝试一个稍微难一点的Python熊猫面试问题。这一个来自Salesforce Data Science访谈，使用日期时间操作和数据透视表。</p><p id="1110" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">用户增长率</strong></p><p id="1c34" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">计算每个账户在2021年1月和2020年12月的活跃用户增长率。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oq"><img src="../Images/cb3616a035410cb462c69ab1072e0e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8e1Jjz4QUTOpI1YXQ_m5Bw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="a87b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决问题。<a class="ae kw" href="https://platform.stratascratch.com/coding/2052-user-growth-rate?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/2052-user-growth-rate？python=1 </a></p><p id="2c0f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题使用了包含以下各列的<strong class="kz ir"> sf_events </strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi or"><img src="../Images/32f281e8d9b82e593bfa6493fe52933c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJ5w1WPq4SlV-M0rneDGSQ.png"/></div></div></figure><p id="0a88" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据是这样的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi os"><img src="../Images/d2b94151b8c8852715a353d51da03982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UBqjbZEVs3rKOFhHkhAwA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="b0c6" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="a178" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">我们需要汇总每个帐户在两个不同时间段的用户数量。这是数据透视表的一个完美案例。但是在我们这样做之前，我们首先从日期中提取年和月，因为我们必须对几个月进行汇总。为此，我们使用。strftime()方法。这扩展了Python日期时间库中<a class="ae kw" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank">可用的strftime()方法。这非常类似于我们在</a><a class="ae kw" href="https://www.stratascratch.com/blog/sql-scenario-based-interview-questions-and-answers/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> SQL Datetime文章</a>中讨论过的SQL中的TO_CHAR()函数。​</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="64e4" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Create the Year - Month indicator<br/>sf_events['month'] = sf_events['date'].dt.strftime('%Y-%m')</span></pre><p id="f826" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们现在可以使用数据透视表对2020年12月和2021年1月进行汇总，计算增长率并输出相关列。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="6902" class="ni mj iq nv b gy nz oa l ob oc"># Aggregate relevant months<br/>summ_df = sf_events[sf_events['month'].isin(['2020-12', '2021-01'])].<br/>pivot_table(<br/>    index = 'account_id', columns = 'month', values = 'user_id', aggfunc = <br/>    'nunique').reset_index()<br/># Calculate growth rate and output relevant columns<br/>summ_df['growth_rate'] = summ_df['2021-01'] / summ_df['2020-12']<br/>summ_df[['account_id', 'growth_rate']]</span></pre><h1 id="6486" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">文本操作</h1><p id="bd22" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">与datetime函数一样，Pandas提供了一系列字符串函数。就像。对于日期时间函数，我们可以使用。str访问器在整个系列中使用标准字符串函数。除了标准的字符串库之外，还有一些额外的函数可以派上用场。让我们来看几个Python熊猫面试问题的例子。第一个是来自洛杉矶一个城市的数据科学采访。</p><p id="742c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">“面包店”自有设施</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ng"><img src="../Images/666501a7d2c53da09cc556e155d185e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CBWca-64uol10g-9QzGjdA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="fe1f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决问题<a class="ae kw" href="https://platform.stratascratch.com/coding/9697-bakery-owned-facilities?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/9697-bakery-owned-facilities？python=1 </a></p><p id="c0e6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题使用具有以下字段的<strong class="kz ir">洛杉矶餐厅健康检查数据集</strong>。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ot"><img src="../Images/d686aba83fa85db5a992a648d20ff4e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9qrne_Ce9BF3z-glkkoiPw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="ff71" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据如下所示。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ou"><img src="../Images/4f4fa2b49884754288984403db5d5f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkJ5cSxSelVRumfFkCbCHg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="1082" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="5499" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">虽然数据集中有许多列，但相关的是owner_name和pe_description。我们首先只保留数据集中的相关列，删除重复的列(如果有的话)。</p><p id="1755" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后，我们在owner_name字段中搜索文本BAKERY，在pe_description字段中搜索低风险。为此，我们使用str.lower()方法将所有值转换为小写，并使用. str.find()方法查找相关文本的实例。<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.find.html" rel="noopener ugc nofollow" target="_blank"> .str.find() </a>是Python内置方法find()对字符串类型变量的扩展。</p><p id="b768" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后，我们使用布尔掩码输出满足这两个标准的行。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="9cf7" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Keep relevant fields<br/>rel_df = los_angeles_restaurant_health_inspections<br/>[['owner_name', 'pe_description']].drop_duplicates()<br/># Find the relevant text in the two fields. <br/>rel_df[(rel_df['owner_name'].str.lower().str.find('bakery') &gt;= 0) &amp;( rel_df<br/>['pe_description'].str.lower().str.find('low risk') &gt;=0)]</span></pre><p id="53c8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">除了通常的字符串方法之外。str访问器还有一些额外的方法。一种这样方法是explode()。</p><p id="4b78" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">顾名思义，该方法拆分数据帧中的系列或特定列。其他值(如果是数据帧)和索引是重复的。让我们看看这在实践中是如何使用的。我们在本文前面解决的AirBnB数据科学面试问题中使用了这一点。</p><p id="30d8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">生活设施最多的城市</strong></p><p id="8ca3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">从Airbnb上给定的房产搜索数据集中，找出主人所有房产中设施最多的城市。假设每行代表一个唯一的主机。输出城市名称作为您的解决方案。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nf"><img src="../Images/944030ba18d222922cba325c66a535f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgD5ViETv61mGkMvODvwdA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="a13c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> airbnb_search_details </strong>数据集中的相关字段是便利设施和城市</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nh"><img src="../Images/2c22c125ee87cad01f546625e4715a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AXk-5hZ2-qhlmauTAHH2_w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="94bc" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="e460" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">我们从保留数据集中的相关字段开始(这在实际解决方案中是不需要的。我们这样做是为了使解决方案更容易理解)。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="57d4" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Keep Relevant fields<br/>rel_df = airbnb_search_details[['amenities', 'city']]</span></pre><p id="6428" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们通过调用split方法将便利设施字符串拆分成一个列表。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="d2b4" class="ni mj iq nv b gy nz oa l ob oc"># Split the amenities string<br/>rel_df['amenities'] = rel_df['amenities'].str.split(",")</span></pre><p id="5456" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们调用便利设施列上的explode()方法。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="0b18" class="ni mj iq nv b gy nz oa l ob oc">rel_df = rel_df.explode('amenities')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ov"><img src="../Images/142f5abe9504338df4dbbf33992217fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Etn3kSjuWaSO8Z14Vu9QKg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="6bd1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">可以看到，explode方法为一个iterable内部的每个对象创建了一个单独的行，比如list、set、tuple等。现在，我们可以聚合城市中的便利设施，并像前面一样输出结果。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="a011" class="ni mj iq nv b gy nz oa l ob oc"># Summaroze by city<br/>rel_df.groupby(by = ['city'], as_index = False).agg({'amenities' : 'count'}).<br/>sort_values(by = ['amenities'], ascending = False).reset_index()['city'][0]</span></pre><p id="62d2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.explode.html" rel="noopener ugc nofollow" target="_blank"> explode是一个非常强大的函数</a>，对于基于文本操作的问题来说非常方便。</p><h1 id="0734" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">使用熊猫的统计</h1><p id="e126" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">考虑到处理表格数据的能力，Pandas也是统计操作的自然选择。虽然<a class="ae kw" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a>被认为是统计操作的首选库，但由于Pandas是基于NumPy构建的，它继承了相当多的统计度量，可以很容易地调用这些度量来计算这些度量。让我们看几个例子。第一个是来自洛杉矶一个城市的数据科学面试问题。</p><p id="1a58" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">求A级分数的方差和标准差</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ow"><img src="../Images/6e4edae3325d8914a3624d72d28db9e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vp3KdiHYRtwE5zQBEeuA4Q.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="afe6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决这个Python熊猫面试问题。<a class="ae kw" href="https://platform.stratascratch.com/coding/9708-find-the-variance-and-the-standard-deviation-of-scores-that-have-grade-a?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/9708-find-the-variance-and-the-standard-deviation-of-scores-that-have a grade？python=1 </a></p><p id="1e8d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题使用了我们之前看到的<strong class="kz ir">洛杉矶餐厅健康检查数据集。该数据集具有以下字段。</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ot"><img src="../Images/b803b881a0ddca74a26657712f731ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s3rfUNIGKvGMM2Grh59aMg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="bf71" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据是这样显示的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ou"><img src="../Images/4f4fa2b49884754288984403db5d5f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkJ5cSxSelVRumfFkCbCHg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="7fcd" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="1c76" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">让我们自己通过计算来解决这个问题。然后我们将通过调用内置的Pandas方法来解决这个问题。我们首先对相关字段进行子集划分，只保留那些与a级相对应的分数。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="1451" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Subset relevant rows<br/>la_df = los_angeles_restaurant_health_inspections[los_angeles_restaurant_health_<br/>inspections['grade'] == 'A'][['grade', 'score']]<br/>la_df</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ox"><img src="../Images/ce78fab4afd0b421076197b09977fe6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*84WlOdUF7K3UwMqP1RN9Ww.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="96ce" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><a class="ae kw" href="https://en.wikipedia.org/wiki/Variance" rel="noopener ugc nofollow" target="_blank">方差</a>是平均值的均方差。人口方差被定义为</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oy"><img src="../Images/4868a5969492b5bf755b8546b7085b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ANiXPzjsnoYpoZIkIVocGA.png"/></div></div></figure><p id="2d78" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><a class="ae kw" href="https://en.wikipedia.org/wiki/Standard_deviation" rel="noopener ugc nofollow" target="_blank">标准差</a>是方差的平方根</p><p id="fc47" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以通过计算等级平均值的平方差的平均值来计算方差。我们可以通过使用向量化操作一步完成。根据方差，我们可以很容易地计算出标准差。最后以期望的格式输出结果。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="0a34" class="ni mj iq nv b gy nz oa l ob oc">variance = ((la_df['score'] - la_df['score'].mean())**2).mean()<br/>stdev = variance ** 0.5<br/>output_df = pd.DataFrame({'variance' : [variance], 'stdev' : [stdev]})</span></pre><p id="cb1d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">除了从公式中计算方差，我们还可以调用内置的Pandas统计方法。由于我们正在计算人口方差和标准差，我们需要指定熊猫不使用<a class="ae kw" href="https://en.wikipedia.org/wiki/Bessel%27s_correction" rel="noopener ugc nofollow" target="_blank">贝塞尔校正</a>。我们可以通过在<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.var.html" rel="noopener ugc nofollow" target="_blank">方差</a>和<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.std.html" rel="noopener ugc nofollow" target="_blank">标准差</a>计算中将ddof参数设置为0来做到这一点。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="12f5" class="ni mj iq nv b gy nz oa l ob oc">variance = la_df['score'].var(ddof = 0)<br/>stdev = la_df['score'].std(ddof = 0)<br/>output_df = pd.DataFrame({'variance' : [variance], 'stdev' : [stdev]})</span></pre><p id="edbd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们试试稍微复杂一点的。这是来自谷歌数据科学的采访。</p><p id="360e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">邮件与活动时间的关联</strong></p><p id="4deb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">找出一个用户收到的邮件数量和每天总运动量之间的相关性。每天的总运动量就是每天的用户会话数。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ow"><img src="../Images/472e3544535dab892c0e4ff924111c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WLsgSrWfq1aTSLgVp_ChOw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="6159" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决问题<a class="ae kw" href="https://platform.stratascratch.com/coding/10069-correlation-between-e-mails-and-activity-time?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10069-correlation-between-e-mail-and-activity-time？python=1 </a></p><p id="42d4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题使用了两个数据集</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi of"><img src="../Images/0167dbbe6372ad2413cc0eeaf721613f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2L_Jj0qvAP9lFwSKoMkj-g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="de47" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据显示如下:</p><p id="cd97" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> google_gmail_emails </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oz"><img src="../Images/539f7a9749bf6fc8fce919aeeab14a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bprSJhq1ySodEioO6IyKZg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="c63a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> google_fit_location </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oz"><img src="../Images/3aac3804eab3e71ceef4a11e9ab3d394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wAOieW5PTYnoxXk0F6w2wQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="aeaa" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="2b7c" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">我们首先计算每天发送给每个用户的电子邮件数量。我们通过按用户id和日期合计电子邮件数量来做到这一点</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="881a" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Get the number of emails per day<br/>mail_df = google_gmail_emails.groupby(by = ['to_user', 'day'], <br/>as_index = False).agg({'id' : 'count'}).fillna(0)<br/>mail_df</span></pre><p id="b84d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们得到下面的数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pa"><img src="../Images/e21d02d4819f33eda4436a0d229fecf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gG5mOa46ikgoLhVnue4KCQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="6be8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们对其他数据集做同样的事情，计算每天的用户会话数。注意:我们只需要对每个用户会话计数一次。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="32f6" class="ni mj iq nv b gy nz oa l ob oc">exer_df = google_fit_location.groupby(by = ['user_id', 'day'], as_index = <br/>False).agg({'session_id' : 'nunique'}).rename(columns = <br/>{'user_id': 'to_user'}).fillna(0)<br/>exer_df</span></pre><p id="8a71" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">给了我们</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pb"><img src="../Images/371dd84d8755631a4ab3f27fd11388e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cbi3bZ2kznk7imruYw5UuQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="5db9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们现在合并用户和日期的两个数据集</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="ac57" class="ni mj iq nv b gy nz oa l ob oc">merged_df = pd.merge(mail_df, exer_df, on = ['to_user', 'day'], how = 'inner')<br/>merged_df</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pc"><img src="../Images/fb851f16b556b48d965bab5ff836f946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-tv7PBBsQwQLjHMaP1uAg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="68c5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们现在可以使用内置的协方差函数来计算协方差。协方差输出将提供两个变量的协方差。例如，两个变量x和y的协方差输出将包含与此类似的内容。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oy"><img src="../Images/11b290089d928d164877f8af37c312a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fACUfOyb1mWwy4HC2diZWg.png"/></div></div></figure><p id="be69" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可能需要对角线上的值(用绿色突出显示)。因此，我们对相关字段进行子集划分。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="3698" class="ni mj iq nv b gy nz oa l ob oc">merged_df[['id', 'session_id']].corr()[:1]['session_id']</span></pre><h1 id="679b" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">偏移数据</h1><p id="f5f9" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">另一个常见的商业案例，尤其是时间序列数据，是找出它们的前一个或后一个值。Pandas有能力支持这些SQL风格的滞后和超前操作。让我们在实践中使用这些方法，解决优步数据科学采访中的一个问题。</p><p id="c0ba" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="lt">逐年流失</em> </strong></p><p id="fce7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">计算每年的司机流失率，并报告与前一年相比，人数是增加了还是减少了。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pd"><img src="../Images/fcb8a549ea6a257802822edca4b486b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_4XcXyokPQfKiCG_Zp8ldQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="18f0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决所有的问题。<a class="ae kw" href="https://platform.stratascratch.com/coding/10017-year-over-year-churn?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10017-同比-流失？python=1 </a></p><p id="54ff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题使用了具有以下字段的<strong class="kz ir"> lyft_drivers </strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi or"><img src="../Images/dfb52ceea08c8c30f196f8aa0d4f9d23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVNqTOyw3IVdmSe-Uv6b3Q.png"/></div></div></figure><p id="af2e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据集看起来像这样。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oz"><img src="../Images/a3a1cc2310bf2651f47c34479223ae58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ru1qxcEp6bnUDFOiyCTwow.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="4575" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="059c" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">我们从计算每年的流失率开始。为此，我们首先从end_date字段计算客户流失的年份，然后计算每年的客户流失数量。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="635d" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Get the year from exit date<br/>lyft_drivers['year'] = lyft_drivers['end_date'].dt.year<br/> <br/># Get the number of the drivers churned for each year<br/>summ_df = lyft_drivers.groupby(by = ['year'], as_index = False).agg<br/>({'index' : 'count'}).sort_values(by = ['year']).rename<br/>(columns = {'index' : 'churn'}).dropna()</span></pre><p id="5df0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这为我们提供了以下汇总数据。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pe"><img src="../Images/0273cb3353b384e76ecff5a26bea2e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W4RtzwB1nUzcEdN980V1Nw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="d8b3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">检查与前一年相比，该数字是增加了还是减少了。为此，我们需要偏移或下移客户流失数量的值。我们可以通过使用shift()方法来实现这一点。顾名思义，shift方法将数据偏移n行。也可以传递负数，以便向上移动数值。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="6742" class="ni mj iq nv b gy nz oa l ob oc"># Fetch the prev year's churn numbers<br/>summ_df['prev_churn'] = summ_df['churn'].shift(1).fillna(0)<br/>summ_df</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ol"><img src="../Images/bd2f787eca5be6f821d0ded6fed1b925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ulF0tP3GGRCD3qNGa7hE8w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="40d8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以将该值与前一项进行比较，并确定数字是增加了还是减少了。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="2ba1" class="ni mj iq nv b gy nz oa l ob oc"># Compare the two churn numbers and output the change<br/>summ_df['change'] = (summ_df['churn'] &gt; summ_df['prev_churn']).apply<br/>(lambda x : 'increase' if x == True else 'decrease')<br/>summ_df</span></pre><h1 id="a0b0" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">额外的Python熊猫面试问题</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oy"><img src="../Images/b0920288f4671f053e644a07154f16b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LA2L8LzVR_VXjc3Ph_oUxg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="ac9b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们最后解决了几个问题，这些问题结合了我们所学的所有知识。第一种使用窗口函数。这是来自亚马逊数据科学的采访。</p><p id="32bd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="lt">收入随时间变化</em> </strong></p><p id="638c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">求每个月的三个月移动平均线。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pd"><img src="../Images/6c2bfacc3259c262929c69fa376e189e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lIp-K1XrWbQXarMfIJTDEw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="f1ed" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决这个Python熊猫面试问题<a class="ae kw" href="https://platform.stratascratch.com/coding/10314-revenue-over-time?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10314-收入-时间？python=1 </a></p><p id="bc90" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题使用了具有以下字段的<strong class="kz ir"> amazon_purchases </strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ok"><img src="../Images/0487e5b4adf4df439d006c93d9f2e55a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0_727s4hDiht9T2nYENNw.png"/></div></div></figure><p id="00dd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据是这样的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pf"><img src="../Images/69e6ae1665d29681af9f69a82fd9d567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7g6NkV1ZZYB65eqjQLgHYg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="800a" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="faf5" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">我们从相关事务的数据子集开始。我们删除问题中描述的退款交易。我们通过调用created_date字段上的strftime方法找到所需的月份指示器。我们进一步汇总每个月的购买交易。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="c4a2" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Remove refund transactions<br/>pos_df = amazon_purchases[amazon_purchases['purchase_amt'] &gt; 0]<br/># Create Month indicator<br/>pos_df['month'] = pos_df['created_at'].dt.strftime("%Y-%m")<br/># Aggregate the purchases by month<br/>summ_df = pos_df.groupby(by = ['month'], as_index = False).sum()<br/>[['month', 'purchase_amt']].sort_values(by = ['month'])</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pf"><img src="../Images/6a7c42f41eb61d2cd50ac9649100e32a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SP8zQUr35duslrEN326F0w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="a45b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了找到移动平均线，我们使用<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.rolling.html" rel="noopener ugc nofollow" target="_blank">滚动函数</a>。滚动函数创建n行的移动窗口。我们可以改变参数来得到我们想要的输出。因为我们不希望前两个观察返回空值，所以我们将min_periods参数设置为1。最后，我们调用mean()方法来计算三个月的平均值，并返回相关字段。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="48fd" class="ni mj iq nv b gy nz oa l ob oc"># Calculate the rolling average, ensure that the value is calculated <br/>  even for the first two months<br/>summ_df['roll_avg'] = summ_df['purchase_amt'].rolling<br/>(3, min_periods = 1).mean()<br/># Output relevant fields<br/>summ_df[['month', 'roll_avg']]</span></pre><p id="7c2b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下一个来自亚马逊数据科学访谈，以创新的方式使用了apply方法。</p><p id="bad2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> <em class="lt">连胜最久的选手</em> </strong></p><p id="27e1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">连胜是特定玩家赢得的一系列连续比赛。当一名球员输掉下一场比赛时，连胜就结束了。输出具有最长连胜的玩家的ID和连胜的长度。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi on"><img src="../Images/6eac818ebef4845f4ad77aab049be23d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vgbzy2x_B7x7wF6hzebw-A.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="8739" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以在这里解决这个Python熊猫面试问题。<a class="ae kw" href="https://platform.stratascratch.com/coding/2059-player-with-longest-streak?python=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/2059-连胜最长的球员？python=1 </a></p><p id="2475" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个熊猫面试问题使用带有以下字段的<strong class="kz ir">玩家_结果</strong>数据集。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pg"><img src="../Images/95a03ce0e082b894d83a50f41bf60d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LDo7xVuuyxj7zYplFSEr6Q.png"/></div></div></figure><p id="21a5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据是这样显示的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi om"><img src="../Images/299ef23dc8dd5fd6540cb37837a0314b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uh5mlTXFmDHhIXGcLBJ6cQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="aec1" class="ni mj iq bd mk nj nk dn mo nl nm dp ms lg nn no mu lk np nq mw lo nr ns my nt bi translated">方法和解决方案</h2><p id="d03a" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">为了解决这个问题，我们需要得到一个玩家的结果。假设一个玩家的结果序列是</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="5d56" class="ni mj iq nv b gy nz oa l ob oc">WWLWLWWWLWWWWWWWLLLWLW</span></pre><p id="5a9f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以简单地通过使用字母“L”作为分隔符来拆分字符串。这将把字符串分成几个列表。类似这样的。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="9e84" class="ni mj iq nv b gy nz oa l ob oc">[WW] [W] [WWW] [WWWWWWW] [] [] [] [W] [W].</span></pre><p id="253e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，我们找到最长列表的长度，我们将能够确定玩家的连胜。为了在熊猫身上做到这一点，我们需要连接结果。为此，我们只需应用sum()方法。</p><p id="4ba5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当传递数字数据时，sum()方法应该给出值的总数。但是当<a class="ae kw" href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.GroupBy.sum.html" rel="noopener ugc nofollow" target="_blank">字符串类型数据被传递时，</a>就会执行加法运算。Python中的加法运算符将连接字符串，这正是我们需要的！！。</p><p id="96cf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们从连接结果开始。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="af36" class="ni mj iq nv b gy nz oa l ob oc"># Import your libraries<br/>import pandas as pd<br/> <br/># Create the sequence of results<br/>streak_df = players_results.groupby(by = ['player_id'], as_index = False).agg<br/>({'match_result': 'sum'})</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi om"><img src="../Images/720b0602787582e53220f7827b782752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ht6vREoGLhPfIr5mOHEUAQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="1ac3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后，我们继续使用字母L作为分隔符来拆分match_result字符串。我们还分解了结果，这样每个列表都是单独的一行。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="3598" class="ni mj iq nv b gy nz oa l ob oc"># Split the sequence using 'L' as the separator and explode<br/>streak_df['streak'] = streak_df['match_result'].str.split('L')<br/>streak_df = streak_df.explode(column = 'streak')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ph"><img src="../Images/656bc7946ebf8bbe01904a326963d702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFAwvEEWXV3On5zysGmPWA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://www.stratascratch.com/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="ab1b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在剩下的问题就简单了。我们只需要合计条纹字符串的最大长度，并输出相关字段。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="ed61" class="ni mj iq nv b gy nz oa l ob oc"># Find the length of the streak<br/>streak_df['streak_len'] = streak_df['streak'].apply(len)<br/># Aggregate<br/>streaks_df = streak_df.groupby(by = ['player_id'], as_index = False).agg<br/>({'streak_len' : 'max'})<br/># Output relevant fields<br/>streaks_df['rank'] = streaks_df['streak_len'].rank(method = <br/>'dense', ascending = False)<br/>streaks_df[streaks_df['rank'] == 1].drop(columns = ['rank'])</span></pre><h1 id="dfde" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">结论</h1><p id="2f22" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">在这一系列文章中，我们看了如何使用熊猫和如何解决Python熊猫面试问题。如果一个人真的想从事以Python为主要工具的数据科学领域的工作，那么他应该精通熊猫。使用Pandas就像使用MS-Excel、Google Sheets、Numbers或LibreOffice Calc等电子表格软件一样简单。一个人要精通熊猫只需要一点时间和好奇心。我们在StrataScratch平台上有超过700个与数据科学面试相关的编码和非编码问题。这些问题来源于优步、网飞、Noom、微软、脸书等顶级公司的实际数据科学面试。查看我们最近关于<a class="ae kw" href="https://www.stratascratch.com/blog/top-30-python-interview-questions-and-answers/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> <em class="lt">前30名Python面试问题和答案</em> </a>的帖子。在StrataScratch上，您将有机会加入一个由20，000多名志同道合的数据科学爱好者组成的团体，获得协作学习体验。今天就在StrataScratch上注册，为全球大型科技公司和初创公司最受欢迎的职位做好准备。</p></div><div class="ab cl pi pj hu pk" role="separator"><span class="pl bw bk pm pn po"/><span class="pl bw bk pm pn po"/><span class="pl bw bk pm pn"/></div><div class="ij ik il im in"><p id="42a6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">原载于</em><a class="ae kw" href="https://www.stratascratch.com/blog/python-pandas-interview-questions-for-data-science-part-2/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"><em class="lt">https://www.stratascratch.com</em></a><em class="lt">。</em></p></div></div>    
</body>
</html>