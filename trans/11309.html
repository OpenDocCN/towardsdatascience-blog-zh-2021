<html>
<head>
<title>Getting Started with Python Virtual Environments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 虚拟环境入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-with-python-virtual-environments-252a6bd2240?source=collection_archive---------1-----------------------#2021-11-06">https://towardsdatascience.com/getting-started-with-python-virtual-environments-252a6bd2240?source=collection_archive---------1-----------------------#2021-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6219" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="02f6" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">避免 python 项目间冲突的简短指南</h2></div><p id="d89b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您刚刚开始使用 python 进行数据科学或开发，您可能会遇到一个常见的初学者问题——为什么您的项目在从事其他工作一段时间后不再运行。您可能也不知道您的 python 包存储在哪里，或者不知道如何在项目之间管理不同版本的 python。好了，松一口气吧，虚拟环境已经来拯救我们了(实际上它们已经存在很长时间了。长到找不到参考文献……)。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/c28db6e05d96ad437dd3e63efc9f5040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*uOrkkLIezHfdk0dj1MaxCQ.jpeg"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">不要让你的 python 和你的头发纠缠在一起，使用虚拟环境。图片是卡拉瓦乔的美杜莎，来源于<a class="ae lw" href="https://commons.wikimedia.org/wiki/File:Medusa_by_Caravaggio.jpg" rel="noopener ugc nofollow" target="_blank">维基共享</a>。</p></figure></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="ffe7" class="me mf iq bd mg mh mi mj mk ml mm mn mo kf mp kg mq ki mr kj ms kl mt km mu mv bi translated">它们是什么？</h1><p id="c877" class="pw-post-body-paragraph ko kp iq kq b kr mw ka kt ku mx kd kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">简单地说，Python 虚拟环境是一个独立 python 在您的计算机上运行的封闭环境🐍。这意味着您可以拥有单独的虚拟环境，为您的每个项目提供单独版本的 python 和 python 包。因此，您可以在一个项目上安装或删除 python 包，这不会影响您可能拥有的任何其他项目。</p><p id="46d5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="nb">注意:本指南假设您已经安装了 python 3。如果没有，请访问</em><a class="ae lw" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"><em class="nb">https://www.python.org/</em></a><em class="nb">获取安装说明。</em></p><h1 id="241a" class="me mf iq bd mg mh nc mj mk ml nd mn mo kf ne kg mq ki nf kj ms kl ng km mu mv bi translated">你把它们放在哪里？</h1><p id="0bad" class="pw-post-body-paragraph ko kp iq kq b kr mw ka kt ku mx kd kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">有些人喜欢把他们所有的 python 虚拟环境放在一个文件夹中，然而，我发现这种方法很难跟踪什么环境属于什么项目。对于 python 虚拟环境，一个更常见的做法是将它们放在每个项目的根目录下。</p><p id="d1d4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">例如，如果您有一个名为“example_project”的项目，您可以将当前目录更改到那里</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="f8d7" class="nm mf iq ni b gy nn no l np nq">cd example_project</span></pre><p id="3593" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">然后按照以下步骤创建您的虚拟环境。</p><h1 id="0671" class="me mf iq bd mg mh nc mj mk ml nd mn mo kf ne kg mq ki nf kj ms kl ng km mu mv bi translated">创建虚拟环境</h1><p id="d905" class="pw-post-body-paragraph ko kp iq kq b kr mw ka kt ku mx kd kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">人们用来创建虚拟环境的一种常见方式是使用一个名为<a class="ae lw" href="https://virtualenv.pypa.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq ja"> virtualenv </strong> </a>的 python 包，但从 python 3.3 版本开始，virtualenv 的部分内容实际上是以模块名<code class="fe nr ns nt ni b">venv</code>内置到 python 中的。现在，您可以使用以下命令创建虚拟环境:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="140e" class="nm mf iq ni b gy nn no l np nq">python3 -m venv venv</span></pre><p id="9b00" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这是怎么回事？</p><ul class=""><li id="c389" class="nu nv iq kq b kr ks ku kv kx nw lb nx lf ny lj nz oa ob oc bi translated">嗯，<code class="fe nr ns nt ni b">python3</code>就是你安装的 python。如果你安装的 python 版本叫<code class="fe nr ns nt ni b">python</code>、<code class="fe nr ns nt ni b">python3.7</code>或者<code class="fe nr ns nt ni b">python3.9</code>或者别的什么，那就用那个；</li><li id="7e92" class="nu nv iq kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated"><code class="fe nr ns nt ni b">-m venv</code>是一个告诉 python 运行虚拟环境模块的参数，<code class="fe nr ns nt ni b">venv</code>；</li><li id="c16a" class="nu nv iq kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">最后，最后一个<code class="fe nr ns nt ni b">venv</code>是虚拟环境文件夹的名称。有些人喜欢用另一个名字(如 env 或。env)，不过，这完全取决于你。</li></ul><p id="5bcd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这个命令应该做的是在当前目录下创建一个名为 venv 的 python 虚拟环境。</p><p id="871a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="nb">注意:如果你使用 git，你会想把</em> <code class="fe nr ns nt ni b"><em class="nb">venv/</em></code> <em class="nb">添加到一个名为。gitignore 确保你不会对你的虚拟环境进行版本控制。如果您忘记了这一步，那么您的 git 存储库可能会被数百个额外的版本控制文件堵塞。</em></p><p id="b191" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">一旦你创建了你的虚拟环境，你就不需要再这样做了。现在，您将能够按照以下步骤使用您的环境。</p><h1 id="b60d" class="me mf iq bd mg mh nc mj mk ml nd mn mo kf ne kg mq ki nf kj ms kl ng km mu mv bi translated">如何使用它们</h1><p id="d5fb" class="pw-post-body-paragraph ko kp iq kq b kr mw ka kt ku mx kd kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">要使用虚拟环境，您需要使用以下命令“激活”该环境:</p><p id="4119" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">(在 MacOS 和 Linux 上)</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="5fb3" class="nm mf iq ni b gy nn no l np nq">source venv/bin/activate</span></pre><p id="e1f1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">或(Windows)</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="a769" class="nm mf iq ni b gy nn no l np nq">venv\Scripts\activate</span></pre><p id="f310" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您在 MacOS 或 Linux 上使用 fish shell(像我一样),您需要将上面的 MacOS 或 Linux 命令替换为:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="c40e" class="nm mf iq ni b gy nn no l np nq">source venv/bin/activate.fish</span></pre><p id="f06a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">上述命令所做的是改变命令<code class="fe nr ns nt ni b">python</code>和<code class="fe nr ns nt ni b">pip</code>(python 包管理器)来引用那些位于 venv 文件夹中的命令。应该会出现一个有用的指示器，显示您正在使用虚拟环境，如下所示:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="cea5" class="nm mf iq ni b gy nn no l np nq">(venv) $</span></pre><p id="3058" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这意味着当您安装带有 pip 的软件包时，例如</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="ce69" class="nm mf iq ni b gy nn no l np nq">pip install numpy</span></pre><p id="5ef0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，您将把它安装到 venv 文件夹中的虚拟环境中。如果您愿意，您应该能够查看您在<code class="fe nr ns nt ni b">venv/lib/python3.9/site-packages</code>中安装的包的文件。如果不同，您必须用<code class="fe nr ns nt ni b">python3.9</code>替换您的版本。</p><p id="7b61" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">按照上面的步骤操作，应该会看到类似下面 GIF 的东西。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/365dc9b7e776cfc2837b34310013867b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*pV_1ktgml_Wd0St3aNbNcw.gif"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">创建虚拟环境。图片作者。</p></figure><p id="ae7e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">继续这个例子，如果您现在以交互模式启动 python，您将能够使用以下命令访问这些包:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="c8cb" class="nm mf iq ni b gy nn no l np nq">python</span><span id="a82c" class="nm mf iq ni b gy oj no l np nq">import numpy as np</span><span id="277b" class="nm mf iq ni b gy oj no l np nq">print(np.sqrt(5))</span></pre><p id="7c39" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果一切正常，您应该会看到类似下面的内容:</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/c6b0402efdd46f4374fa6de701795125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*uh5sqp_An1BRWZRtuA7f2g.gif"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">使用虚拟环境。图片作者。</p></figure><p id="4c94" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在使用 python 运行 python 文件时，您还应该能够访问您安装的任何包。例如，如果您想使用虚拟环境中包含的 python 来运行一个名为“main.py”的文件，您可以使用以下命令:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="1ff5" class="nm mf iq ni b gy nn no l np nq">python main.py</span></pre><p id="340a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">完成虚拟环境后，您可以关闭终端，或者使用如下命令停用环境:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="a391" class="nm mf iq ni b gy nn no l np nq">deactivate</span></pre><p id="6626" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果需要的话，这也将允许您为您的另一个项目激活一个不同的虚拟环境。</p><h1 id="83c7" class="me mf iq bd mg mh nc mj mk ml nd mn mo kf ne kg mq ki nf kj ms kl ng km mu mv bi translated">复制你的环境</h1><p id="e5a1" class="pw-post-body-paragraph ko kp iq kq b kr mw ka kt ku mx kd kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">为了重现 python 虚拟环境(例如，在另一台机器上)，通常需要将安装的包保存到一个文件中。这将允许任何拥有您的文件的人安装您在开发项目时使用的相同版本的包。然而，你可能还是想告诉他们你使用的 python 版本。通常人们喜欢使用一个名为“requirements.txt”的文件来实现这个目的。</p><p id="2f52" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您已经激活了 python 虚拟环境，那么您可以自动生成 requirements.txt 文件，包含以下内容:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="a0cd" class="nm mf iq ni b gy nn no l np nq">pip freeze &gt; requirements.txt</span></pre><p id="5125" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您也可以编辑这个文件或者手动创建一个，如果您愿意的话(例如，您不想对包的版本要求如此严格)。更多详情见<a class="ae lw" href="https://pip.pypa.io/en/stable/user_guide/" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="3eb0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">因此，如果您或其他人想要创建一个虚拟环境并使用与您相同的包，他们可以按照上面的命令创建并激活一个虚拟环境，然后安装您的需求。可以使用 pip 的-r 方法安装需求，如下所示:</p><pre class="ll lm ln lo gt nh ni nj nk aw nl bi"><span id="de42" class="nm mf iq ni b gy nn no l np nq">pip install -r requirements.txt</span></pre></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="43f9" class="me mf iq bd mg mh mi mj mk ml mm mn mo kf mp kg mq ki mr kj ms kl mt km mu mv bi translated">现在去哪里？</h1><p id="e890" class="pw-post-body-paragraph ko kp iq kq b kr mw ka kt ku mx kd kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">我已经向您展示了使用 python 的虚拟环境的最简单和标准的方法，但是，如果您愿意，您可以使用虚拟环境和 python 的各种方法。大多数情况下，这些都不是不必要的，但是如果您愿意，一些著名的包提供了一种不同的方式来处理虚拟环境和包，它们是:</p><ul class=""><li id="debd" class="nu nv iq kq b kr ks ku kv kx nw lb nx lf ny lj nz oa ob oc bi translated">诗歌【https://python-poetry.org/】T2，还有</li><li id="77a0" class="nu nv iq kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">https://www.anaconda.com/products/individual<a class="ae lw" href="https://www.anaconda.com/products/individual" rel="noopener ugc nofollow" target="_blank">康达</a></li></ul><p id="f454" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果你已经走了这么远，谢谢你。我希望这篇文章能帮助您在数据科学(或您所做的任何事情)之旅中取得更大的进步。如果你喜欢这篇文章，请鼓掌并关注我，让我有动力写更多。如果你有任何问题，请在下面补充。</p></div></div>    
</body>
</html>