<html>
<head>
<title>How to Tune Hyperparameters of Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何调整机器学习模型的超参数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-tune-hyperparameters-of-machine-learning-models-a82589d48fc8?source=collection_archive---------17-----------------------#2021-06-07">https://towardsdatascience.com/how-to-tune-hyperparameters-of-machine-learning-models-a82589d48fc8?source=collection_archive---------17-----------------------#2021-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/31f8852ce85abf669aea81f73b3bb3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ff6hOZGdmN-zLXN_ASAKPw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用来自<a class="ae jg" href="https://1.envato.market/c/2346717/628379/4662" rel="noopener ugc nofollow" target="_blank"> envato元素</a>的<a class="ae jg" href="https://elements.envato.com/user/BoykoPictures" rel="noopener ugc nofollow" target="_blank"> BoykoPictures </a>的图像创建(经许可)。</p></figure><h2 id="cf9c" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/tag/data-science" rel="noopener">数据科学</a> | <a class="ae ep" href="https://medium.com/tag/machine-learning" rel="noopener">机器学习</a></h2><div class=""/><div class=""><h2 id="42c5" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">使用Scikit-learn的分步教程</h2></div><p id="013c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">通常情况下，您会使用默认参数来构建机器学习模型。只需几段代码，您就可以为您的机器学习模型搜索最佳超参数。为什么？因为最佳的超参数集可以大大提高模型的性能。</p><p id="a3de" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本文中，您将学习如何使用scikit-learn库在Python中执行随机森林模型的超参数调优。</p><p id="75b9" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> <em class="md">注:</em> </strong>本文灵感来源于我前段时间做的一个YouTube视频(<a class="ae jg" href="https://youtu.be/jUxhUgkKAjE" rel="noopener ugc nofollow" target="_blank"><strong class="lj jt"><em class="md">Python中机器学习模型的超参数调优</em> </strong> </a>)。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="90c2" class="ml mm jj bd mn mo mp mq mr ms mt mu mv ky mw kz mx lb my lc mz le na lf nb nc bi translated">1.超参数</h1><p id="3865" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">在应用机器学习中，调整机器学习模型的超参数代表了尽可能实现最佳性能的有利可图的机会。</p><h2 id="93f6" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">1.1.参数与超参数</h2><p id="f0c5" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在让我们定义什么是超参数，但在此之前，让我们考虑一下<em class="md">参数</em>和<em class="md">超参数</em>之间的区别。</p><p id="926a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">参数可以被认为是模型固有的或内部的，并且可以在模型从数据中学习之后获得。参数的例子是线性回归中的回归系数、支持向量机中的支持向量和神经网络中的权重。</p><p id="64e3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">超参数可以被认为是模型的外在或外部参数，可以由从业者任意设置。超参数的例子包括k-最近邻中的k、随机森林中的树的数量和特征的最大数量、神经网络中的学习速率和动量、支持向量机中的C和gamma参数。</p><h2 id="a03d" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">1.2.超参数调谐</h2><p id="58d5" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">由于没有通用的最佳超参数可用于任何给定的问题，超参数通常被设置为默认值。然而，超参数的最佳集合可以从手动经验(试错法)超参数搜索中获得，或者通过使用优化算法来最大化适应度函数以自动方式获得。</p><p id="d158" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">两种常见的超参数调谐方法包括<em class="md">网格搜索</em>和<em class="md">随机搜索</em>。顾名思义，<strong class="lj jt"> <em class="md">网格搜索</em> </strong>需要创建可能的超参数值的网格，从而以强力方式为所有这些超参数组合迭代构建模型。在<strong class="lj jt"> <em class="md">随机搜索</em> </strong>中，不是所有的超参数组合都被使用，而是每次迭代使用一个随机超参数组合。</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nt"><img src="../Images/09847fa410a6317ba1e6d3a7b836521d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4NoUdaVyquPZetjydZs0A.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">比较两种常用超参数调整方法的示意图:(1)网格搜索与(2)随机搜索。作者绘制的图像。</p></figure><p id="fe63" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">此外，随机优化方法也可用于超参数调整，其将以算法方式自动导航超参数空间，作为<em class="md">损失函数</em>(即性能度量)的函数，以便监控模型性能。</p><p id="61d3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本教程中，我们将使用网格搜索方法。</p><h1 id="9e7c" class="ml mm jj bd mn mo ny mq mr ms nz mu mv ky oa kz mx lb ob lc mz le oc lf nb nc bi translated">2.资料组</h1><p id="46bc" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">今天，我们既不使用虹膜数据集，也不使用企鹅数据集，而是要生成我们自己的合成数据集。但是，如果您想继续使用您自己的数据集进行替换，那就太好了！</p><h2 id="493a" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">2.1.生成合成数据集</h2><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="e743" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">2.2.检查数据集维度</h2><p id="6b5f" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在让我们检查数据集的维度</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="c3d2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这将给出以下输出:</p><pre class="nu nv nw nx gt of og oh oi aw oj bi"><span id="6b52" class="ni mm jj og b gy ok ol l om on">((200, 10), (200,))</span></pre><p id="656f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其中<code class="fe oo op oq og b">(200, 10)</code>是X变量的维度，这里我们可以看到有200行和10列。至于<code class="fe oo op oq og b">(200,)</code>，这是Y变量的维度，表示有200行和1列(没有显示数值)。</p><h1 id="0f7d" class="ml mm jj bd mn mo ny mq mr ms nz mu mv ky oa kz mx lb ob lc mz le oc lf nb nc bi translated">3.数据分割</h1><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="482f" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">3.1.检验训练集的维数</h2><p id="890e" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在让我们检查一下<strong class="lj jt">训练集</strong>(80%子集)的维度。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="106e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这将给出以下输出:</p><pre class="nu nv nw nx gt of og oh oi aw oj bi"><span id="b2e1" class="ni mm jj og b gy ok ol l om on">((160, 10), (160,))</span></pre><p id="6603" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其中<code class="fe oo op oq og b">(160, 10)</code>是X变量的维数，这里我们可以看到有160行和10列。至于<code class="fe oo op oq og b">(160,)</code>，这是Y变量的维度，表示有200行1列(没有显示数值)。</p><h2 id="f1b6" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">3.2.检验训练集的维数</h2><p id="f1c8" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在让我们检查一下<strong class="lj jt">测试集</strong>的维度(20%子集)。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="1bb3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这将给出以下输出:</p><pre class="nu nv nw nx gt of og oh oi aw oj bi"><span id="9f80" class="ni mm jj og b gy ok ol l om on">((40, 10), (40,))</span></pre><p id="44ae" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其中<code class="fe oo op oq og b">(40, 10)</code>是X变量的维数，这里我们可以看到有40行10列。至于<code class="fe oo op oq og b">(40,)</code>，这是Y变量的维度，表示有40行1列(没有显示数值)。</p><h1 id="3869" class="ml mm jj bd mn mo ny mq mr ms nz mu mv ky oa kz mx lb ob lc mz le oc lf nb nc bi translated">4.构建基线随机森林模型</h1><p id="cdf8" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">这里，我们将首先构建一个基线随机森林模型，该模型将用作基线，以便与使用最佳超参数集的模型进行比较。</p><p id="efd2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于基线模型，我们将为2个超参数(例如<code class="fe oo op oq og b">n_estimators</code>和<code class="fe oo op oq og b">max_features</code>)设置一个任意数字，我们也将在下一节中使用该数字进行超参数调整。</p><h2 id="8190" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">4.1.实例化随机森林模型</h2><p id="3746" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">我们首先导入必要的库，并将随机森林分类器分配给<strong class="lj jt"> rf </strong>变量。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="39b9" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">4.2.训练随机森林模型</h2><p id="c4fe" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在，我们将应用随机森林分类器，使用训练数据上的<code class="fe oo op oq og b">rf.fit()</code>函数(例如<code class="fe oo op oq og b">X_train</code>和<code class="fe oo op oq og b">Y_train</code>)来构建分类模型。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="836a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">模型定型后，会出现以下输出:</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/8d5def9769502da3c281a9fd974c85b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cP9ncC8RG_jZCcYzLXs6Ew.jpeg"/></div></div></figure><p id="6ed5" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">之后，我们可以应用训练好的模型(<code class="fe oo op oq og b">rf</code>)进行预测。在上面的示例代码中，我们应用模型来预测训练集(<code class="fe oo op oq og b">X_test</code>)，并将预测的Y值赋给<code class="fe oo op oq og b">Y_pred</code>变量。</p><h2 id="d791" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">4.3.评估模型性能</h2><p id="f7aa" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在让我们来评估模型性能。这里，我们计算3个性能指标，包括准确性、马修斯相关系数(MCC)和受试者工作特征曲线下面积(ROC AUC)。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><h1 id="3a4b" class="ml mm jj bd mn mo ny mq mr ms nz mu mv ky oa kz mx lb ob lc mz le oc lf nb nc bi translated">5.超参数调谐</h1><p id="28cd" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在，我们将对随机森林模型的超参数进行调整。我们将调整的两个超参数包括<code class="fe oo op oq og b">max_features</code>和<code class="fe oo op oq og b">n_estimators</code>。</p><h2 id="fd0e" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">5.1.代码</h2><p id="e0bb" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">应该注意的是，下面显示的一些代码改编自<a class="ae jg" href="http://scikit-learn.org/stable/auto_examples/svm/plot_rbf_parameters.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="32b5" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">5.2.代码解释</h2><p id="0501" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">首先，我们将导入必要的库。</p><p id="798e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">scikit-learn的<code class="fe oo op oq og b">GridSearchCV()</code>功能将用于执行超参数调谐。特别需要注意的是，<code class="fe oo op oq og b">GridSearchCV()</code>功能可以执行分类器的典型功能，如<code class="fe oo op oq og b">fit</code>、<code class="fe oo op oq og b">score</code>、<code class="fe oo op oq og b">predict</code>以及<code class="fe oo op oq og b">predict_proba</code>、<code class="fe oo op oq og b">decision_function</code>、<code class="fe oo op oq og b">transform</code>和<code class="fe oo op oq og b">inverse_transform</code>。</p><p id="668d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其次，我们定义了作为<code class="fe oo op oq og b">GridSearchCV()</code>函数必要输入的变量，这包括2个超参数(<code class="fe oo op oq og b">max_features_range</code>和<code class="fe oo op oq og b">n_estimators_range</code>)的范围值，然后将其作为字典分配给<code class="fe oo op oq og b">param_grid</code>变量。</p><p id="b68c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，打印出最佳参数(<code class="fe oo op oq og b">grid.best_params_</code>)及其对应的度量(<code class="fe oo op oq og b">grid.best_score_</code>)。</p><h2 id="b961" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">5.3.性能指标</h2><p id="d7d8" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated"><code class="fe oo op oq og b">GridSearchCV()</code>的默认性能指标是准确性，在本例中，我们将使用ROC AUC。</p><p id="f4ac" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了以防万一，您想知道可以使用哪些其他性能指标，运行以下命令来找出答案:</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="2d5d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这将打印以下受支持的性能指标:</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="6387" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">因此，在本例中，我们将使用ROC AUC，并在<code class="fe oo op oq og b">GridSearchCV()</code>函数中设置输入参数<code class="fe oo op oq og b">scoring = 'roc_auc'</code>。</p><h2 id="f6df" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">5.4.超参数调整的结果</h2><p id="a501" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">第5.1节代码的第14–15行打印了性能指标，如下所示:</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/9eb0248045e774bbf3f2be3f1b3a9cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bL9SN0d7zMnnrvGUUbFTVw.png"/></div></div></figure><p id="d39e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其表明最优或最佳超参数集具有3的<code class="fe oo op oq og b">max_features</code>和60的<code class="fe oo op oq og b">n_estimators</code>，ROC AUC分数为0.93。</p><h1 id="8b56" class="ml mm jj bd mn mo ny mq mr ms nz mu mv ky oa kz mx lb ob lc mz le oc lf nb nc bi translated">6.调谐超参数的数据可视化</h1><p id="49a9" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">让我们首先来看看底层数据，稍后我们将使用它进行数据可视化。超参数调整的结果已被写出到<code class="fe oo op oq og b">grid.cv_results_</code>，其内容显示为如下所示的字典数据类型。</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/bc99bda93037f540ea5e0ddc467aaa69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/1*Sz_oq7Zdkx4tdIgQ9Xi2LA.gif"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><code class="fe oo op oq og b"><strong class="bd ou"><em class="ov">grid.cv_results_</em></strong>.</code>内容截图</p></figure><h2 id="5356" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">6.1.准备数据帧</h2><p id="0c46" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在，我们将有选择地从<code class="fe oo op oq og b">grid.cv_results_</code>中提取一些数据，以创建一个包含2个超参数组合及其相应性能指标的数据框架，在本例中是ROC AUC。特别地，下面的代码块允许组合2个超参数(<code class="fe oo op oq og b">params</code>)和性能度量(<code class="fe oo op oq og b">mean_test_score</code>)。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="25dd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出为以下数据帧，其中3列由<code class="fe oo op oq og b">max_features</code>、<code class="fe oo op oq og b">n_estimators</code>和<code class="fe oo op oq og b">ROC_AUC</code>组成。</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ow"><img src="../Images/f44fc048ab9af524538f82d0fb59e006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tr7okmZZ-ru332R300lYsA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">包含超参数组合及其相应性能度量值的串联数据帧的输出屏幕截图。</p></figure><h2 id="61f0" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">6.2.重塑数据框架</h2><p id="b1cf" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated"><strong class="lj jt">6 . 2 . 1<em class="md">。</em>分组列</strong></p><p id="d8c9" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了将上述数据框可视化为等高线图(即2D或3D版本)，我们首先需要重塑数据结构。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="b0a2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在上面的代码中，我们使用来自<code class="fe oo op oq og b">pandas</code>库的<code class="fe oo op oq og b">groupby()</code>函数根据两列(<code class="fe oo op oq og b">max_features</code>和<code class="fe oo op oq og b">n_estimators</code>)对数据帧进行分组，从而合并第一列(<code class="fe oo op oq og b">max_features</code>)的内容。</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ow"><img src="../Images/f9043481a54c410f9b83fe7b85fbfd7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4t0nwHV45MpYbPwwhWpbFw.png"/></div></div></figure><p id="1372" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">6 . 2 . 2<em class="md">。旋转数据</em> </strong></p><p id="fcca" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">通过将数据旋转到m ⨯ n矩阵中，数据被重新整形，其中行和列分别对应于<code class="fe oo op oq og b">max_features</code>和<code class="fe oo op oq og b">n_estimators</code>。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="ec50" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上面的代码块产生了下面的整形数据帧。</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/2d7bfda8679cece0629e74cbedf10b58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*DGNZqHTLHaM3lzn-u9j1BQ.gif"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">已准备好绘制等值线图的整形数据框的屏幕截图。</p></figure><p id="afa5" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，我们将整形后的数据分配给各自的<code class="fe oo op oq og b">x</code>、<code class="fe oo op oq og b"> y</code>和<code class="fe oo op oq og b">z</code>变量，这些变量将用于绘制等高线图。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="85f6" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">6.3.制作2D等高线图</h2><p id="cff9" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">现在，有趣的部分来了，我们将通过使用Plotly绘制2D等高线图，可视化我们正在调整的2个超参数的景观及其对ROC AUC分数的影响。前述<code class="fe oo op oq og b">x</code>、<code class="fe oo op oq og b"> y</code>和<code class="fe oo op oq og b">z</code>变量用作输入数据。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="8d27" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上述代码块生成以下2D等高线图。</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/084294598e2d0309405e9b6d27ed77dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxBUPI6Ly65w1Xv4kQzgKg.png"/></div></div></figure><h2 id="5986" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">6.4.制作3D等高线图</h2><p id="56f0" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">这里，我们将使用Plotly创建一个交互式3D等高线图，使用<code class="fe oo op oq og b">x</code>、<code class="fe oo op oq og b">y</code>和<code class="fe oo op oq og b">z</code>变量作为输入数据。</p><figure class="nu nv nw nx gt iv"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="496c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上述代码块生成以下3D等高线图。</p><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/4b5a4619e2f23b77a920a96f45dc6395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/1*fC5AviNMzndv_Z_qe0UmtQ.gif"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">2个超参数相对于性能指标ROC AUC的3D等高线图的屏幕截图。</p></figure><h1 id="d197" class="ml mm jj bd mn mo ny mq mr ms nz mu mv ky oa kz mx lb ob lc mz le oc lf nb nc bi translated">结论</h1><p id="9566" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">恭喜你！您刚刚执行了超参数调优，并创建了数据可视化。希望您能够提高您的模型性能，与默认值相比。</p><p id="4c86" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下一步是什么？在本教程中，您已经研究了两个超参数的调优，但这还不是全部。对于随机森林模型，您还可以调整其他几个超参数。您可以查看来自<code class="fe oo op oq og b">scikit-learn</code>的API，获得一个可以尝试的超参数列表。</p><div class="is it gp gr iu pa"><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener  ugc nofollow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd jt gy z fp pf fr fs pg fu fw js bi translated">sk learn . ensemble . randomforestclassifier-sci kit-learn 0 . 24 . 2文档</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">随机森林分类器。随机森林是一个元估计器，它适合于许多决策树分类器…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">scikit-learn.org</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ja pa"/></div></div></a></div><p id="2f30" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">或者，您可以使用本文中描述的代码作为起始模板，尝试为其他机器学习算法调整超参数。</p><p id="7592" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在评论里让我知道，你在做什么好玩的项目！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="8f37" class="ni mm jj bd mn nj nk dn mr nl nm dp mv lq nn no mx lu np nq mz ly nr ns nb jp bi translated">订阅我的邮件列表，获取我在数据科学方面的最佳更新(偶尔还有免费赠品)!</h2></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="3894" class="ml mm jj bd mn mo mp mq mr ms mt mu mv ky mw kz mx lb my lc mz le na lf nb nc bi translated">关于我</h1><p id="f1d4" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">我是泰国一所研究型大学的生物信息学副教授和数据挖掘和生物医学信息学负责人。在我下班后的时间里，我是一名YouTuber(又名<a class="ae jg" href="http://bit.ly/dataprofessor/" rel="noopener ugc nofollow" target="_blank">数据教授</a>)制作关于数据科学的在线视频。在我制作的所有教程视频中，我也在GitHub上分享Jupyter笔记本(<a class="ae jg" href="https://github.com/dataprofessor/" rel="noopener ugc nofollow" target="_blank">数据教授GitHub page </a>)。</p><div class="is it gp gr iu pa"><a href="https://www.youtube.com/dataprofessor" rel="noopener  ugc nofollow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd jt gy z fp pf fr fs pg fu fw js bi translated">数据教授</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">数据科学、机器学习、生物信息学、研究和教学是我的激情所在。数据教授YouTube…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">www.youtube.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po ja pa"/></div></div></a></div><h1 id="0ee5" class="ml mm jj bd mn mo ny mq mr ms nz mu mv ky oa kz mx lb ob lc mz le oc lf nb nc bi translated">在社交网络上与我联系</h1><p id="6f07" class="pw-post-body-paragraph lh li jj lj b lk nd kt lm ln ne kw lp lq nf ls lt lu ng lw lx ly nh ma mb mc im bi translated">✅YouTube:<a class="ae jg" href="http://youtube.com/dataprofessor/" rel="noopener ugc nofollow" target="_blank">http://youtube.com/dataprofessor/</a><br/>♇网站:<a class="ae jg" href="https://www.youtube.com/redirect?redir_token=w4MajL6v6Oi_kOAZNbMprRRJrvJ8MTU5MjI5NjQzN0AxNTkyMjEwMDM3&amp;q=http%3A%2F%2Fdataprofessor.org%2F&amp;event=video_description&amp;v=ZZ4B0QUHuNc" rel="noopener ugc nofollow" target="_blank">http://dataprofessor.org/</a>(在建)<br/>♇LinkedIn:<a class="ae jg" href="https://www.linkedin.com/company/dataprofessor/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/company/dataprofessor/</a><br/>♇Twitter:<a class="ae jg" href="https://twitter.com/thedataprof" rel="noopener ugc nofollow" target="_blank">https://twitter.com/thedataprof</a>/<br/>♇Facebook:<a class="ae jg" href="https://www.youtube.com/redirect?redir_token=w4MajL6v6Oi_kOAZNbMprRRJrvJ8MTU5MjI5NjQzN0AxNTkyMjEwMDM3&amp;q=http%3A%2F%2Ffacebook.com%2Fdataprofessor%2F&amp;event=video_description&amp;v=ZZ4B0QUHuNc" rel="noopener ugc nofollow" target="_blank">http://facebook.com/dataprofessor/</a><br/>♇github:<a class="ae jg" href="https://github.com/dataprofessor/" rel="noopener ugc nofollow" target="_blank">https://github.com/dataprofessor/</a><br/>♇Instagram:)</p></div></div>    
</body>
</html>