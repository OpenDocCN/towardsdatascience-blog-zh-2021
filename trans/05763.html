<html>
<head>
<title>Gibbs Sampling Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">吉布斯采样解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gibbs-sampling-explained-b271f332ed8d?source=collection_archive---------15-----------------------#2021-05-23">https://towardsdatascience.com/gibbs-sampling-explained-b271f332ed8d?source=collection_archive---------15-----------------------#2021-05-23</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="7ea8" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="a1e0" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">通过视觉化建立直觉</h2></div><h1 id="2fb4" class="ks kt iu bd ku kv kw kx ky kz la lb lc kj ld kk le km lf kn lg kp lh kq li lj bi translated">介绍</h1><p id="d352" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">从<a class="ae mg" href="https://imai.fas.harvard.edu/research/SMCredist.html" rel="noopener ugc nofollow" target="_blank">政治学</a>到<a class="ae mg" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0221764" rel="noopener ugc nofollow" target="_blank">癌症基因组学</a>，马尔可夫链蒙特卡罗(MCMC)已经被证明是各种不同领域统计分析的一个有价值的工具。在高层次上，MCMC描述了一组迭代算法，这些算法从难以直接采样的分布中获取样本。这些基于马尔可夫链的算法与过去30年计算能力的惊人增长相结合，使研究人员能够从极其复杂的理论分布中进行采样。在软件中实现，如<a class="ae mg" href="https://www.mrc-bsu.cam.ac.uk/software/bugs/" rel="noopener ugc nofollow" target="_blank"> BUGS </a>(使用吉布斯采样的贝叶斯推理)和<a class="ae mg" href="https://mcmc-jags.sourceforge.io/" rel="noopener ugc nofollow" target="_blank"> JAGS </a>(只是另一个吉布斯采样器)，吉布斯采样是最流行的MCMC算法之一，应用于贝叶斯统计、计算语言学等领域。</p><p id="0230" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated"><strong class="lm je">在本文中，我们将通过一系列可视化来揭示吉布斯采样的工作原理，</strong>通过一个二元正态目标分布的简单示例进行追踪。</p><h1 id="88c0" class="ks kt iu bd ku kv kw kx ky kz la lb lc kj ld kk le km lf kn lg kp lh kq li lj bi translated">设置问题</h1><p id="5218" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">假设有一个m分量感兴趣的联合分布，很难从中采样。即使我不知道如何从联合分布中抽样，假设我知道如何从完全条件分布中抽样。也就是说，我可以很容易地从m个分量的每一个中取样，条件是另一个m-1。<strong class="lm je">在这些条件下，吉布斯采样基于全条件迭代地更新每个分量，以从联合分布中获得样本。</strong></p><p id="a45a" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">为了确切了解这是如何工作的，让我们考虑一个简单的例子。假设我只能访问基R，它可以很容易地对单变量法线进行采样，但不能对多变量法线进行采样。假设目标分布是二元正态分布，其中边际是具有相关性<em class="mm"> ρ的标准正态分布。</em></p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj mn"><img src="../Images/0e3d8fe3967290a6b9a6ff616c8deb0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6fPLoGAE1Aiy0xvs.png"/></div></div><p class="mz na gk gi gj nb nc bd b be z dk translated">目标分布</p></figure><p id="33da" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated"><a class="ae mg" href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution#Conditional_distributions" rel="noopener ugc nofollow" target="_blank">利用多元正态分布</a>的性质，我们得到以下全条件分布。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj nd"><img src="../Images/5db223e40af311fbbee64cdd1fdf175c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DPvhhlrdeR1-rG2a.png"/></div></div><p class="mz na gk gi gj nb nc bd b be z dk translated">完全条件分布</p></figure><p id="ffd7" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">由于这些条件只是单变量法线，我可以很容易地从中取样。那么，用于联合分布的吉布斯采样算法将如下:</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj ne"><img src="../Images/b26c19937b5c8544e2b6dcdd370542c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0vABQqe58E-irLrZNW2MJg.png"/></div></div><p class="mz na gk gi gj nb nc bd b be z dk translated">吉布斯采样算法</p></figure><p id="4afc" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">这个算法起初看起来有点吓人，所以让我们用一些可视化的方法来分解它。</p><h1 id="1892" class="ks kt iu bd ku kv kw kx ky kz la lb lc kj ld kk le km lf kn lg kp lh kq li lj bi translated">遍历算法的一次迭代</h1><p id="7d0d" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">让我们一步一步地完成吉布斯采样器的第一次迭代，其中<em class="mm"> ρ </em>等于0.9。</p><h2 id="046d" class="nf kt iu bd ku ng nh dn ky ni nj dp lc lt nk nl le lx nm nn lg mb no np li ja bi translated"><em class="nq">第一步:初始化</em></h2><p id="34e9" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">这里没什么要做的，将<em class="mm"> </em> (xₒ，yₒ)初始化为(0，0)并将迭代计数器t设置为0。这是我们最初观点的一个非常无趣的情节。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div class="gi gj nr"><img src="../Images/dbd637290e4d267e7f265f8582c5aded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*cp2VsvSEKdcYvShQ94mO3A.png"/></div><p class="mz na gk gi gj nb nc bd b be z dk translated">步骤1:初始化</p></figure><h2 id="7cfe" class="nf kt iu bd ku ng nh dn ky ni nj dp lc lt nk nl le lx nm nn lg mb no np li ja bi translated"><strong class="ak">步骤2:给定Y的X的条件更新</strong></h2><p id="9097" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">现在，我们从给定Y等于0的X的条件分布中得出。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj ns"><img src="../Images/bb3f6fdef6b16aed5e1921fe3699c68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a-THQoRF4HnPA7xF.png"/></div></div><p class="mz na gk gi gj nb nc bd b be z dk translated">给定Y的X的条件更新</p></figure><p id="3571" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">在我的模拟中，这个平局的结果是-0.4。这是我们第一次条件更新的图表。请注意，我们新点的Y坐标没有改变。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div class="gi gj nr"><img src="../Images/bf45570df7acdbd2a403e5af120c46cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*3o53AxbUUF5iec241VYifg.png"/></div><p class="mz na gk gi gj nb nc bd b be z dk translated">步骤2:给定Y的X的条件更新</p></figure><h2 id="461a" class="nf kt iu bd ku ng nh dn ky ni nj dp lc lt nk nl le lx nm nn lg mb no np li ja bi translated">步骤3:给定X，有条件地更新Y</h2><p id="6f6d" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">现在，我们从给定X等于-0.4的Y的条件分布中得出。请注意，在进行第3步的绘制时，我们使用了刚刚在第2步中绘制的X值。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj nt"><img src="../Images/8d8c7f83ec2af3ad775e5937d8994cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AcPXtiUnrHJI1ap3.png"/></div></div><p class="mz na gk gi gj nb nc bd b be z dk translated">给定X的Y的条件更新</p></figure><p id="02c8" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">在我们的情况下，这个平局的结果是-0.32。这一次，我们的新点的X坐标与步骤2中的点的X坐标相同。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div class="gi gj nr"><img src="../Images/14c62ea9fb451acba90130d8b866a6d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*S1U4wph7_4IH-RlynWNggQ.png"/></div><p class="mz na gk gi gj nb nc bd b be z dk translated">步骤3:给定X的Y的条件更新</p></figure><h2 id="6f77" class="nf kt iu bd ku ng nh dn ky ni nj dp lc lt nk nl le lx nm nn lg mb no np li ja bi translated">第4步和第5步</h2><p id="4e9a" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">增加迭代计数器<em class="mm"> t </em>并返回步骤2。吉布斯采样器的这个迭代的最终点是(-0.4，-0.32)。我们现在有两个吉布斯样本。一个来自我们的初始化，一个来自我们的第一次迭代。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div class="gi gj nr"><img src="../Images/2fee053ed9330d8fcc2ac2551a6c4a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*sPLjrJ-Qj-ujTrihsADtSA.png"/></div><p class="mz na gk gi gj nb nc bd b be z dk translated">第4步和第5步:增量和返回</p></figure><h1 id="d2f1" class="ks kt iu bd ku kv kw kx ky kz la lb lc kj ld kk le km lf kn lg kp lh kq li lj bi translated">更多迭代</h1><p id="1bce" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">如果我们继续运行我们的算法(即运行步骤2到5)，我们将继续生成样本。让我们运行迭代2和3，并绘制结果，以确保我们已经得到了模式。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj nu"><img src="../Images/7dac2b8cb3e601197209bb80ef08e98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wRBdW2uIPfLSkhHeyV2txQ.png"/></div></div><p class="mz na gk gi gj nb nc bd b be z dk translated">迭代2和3</p></figure><p id="df67" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">放下条件更新的中间图，我们可以绘制吉布斯采样器的前100次和10，000次迭代。</p><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div class="gi gj nv"><img src="../Images/dea88f8cb93df81d76fb094efa532ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*KL9zKOf0U2q0OTh0.gif"/></div><p class="mz na gk gi gj nb nc bd b be z dk translated">吉布斯采样图，前100次迭代</p></figure><figure class="mo mp mq mr gu ms gi gj paragraph-image"><div class="gi gj nv"><img src="../Images/a9b6808d02acaa44d5b71539d03ef479.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*XBtbjGWSRrB5X92h"/></div><p class="mz na gk gi gj nb nc bd b be z dk translated">吉布斯采样图，前10，000次迭代</p></figure><p id="4fe9" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">上面图上的蓝线是目标二元正态分布的等高线。我们的样本似乎是根据需要从目标分布中抽取的！我们的Gibbs抽样器确实从联合分布中提取数据。</p><p id="21d8" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated"><em class="mm">注意:为了方便起见，我没有在动画中使用真实的理论密度，而是使用了来自MASS包的100，000 MVN绘图的经验密度。</em></p><h1 id="7966" class="ks kt iu bd ku kv kw kx ky kz la lb lc kj ld kk le km lf kn lg kp lh kq li lj bi translated"><strong class="ak">总结</strong></h1><p id="4928" class="pw-post-body-paragraph lk ll iu lm b ln lo ke lp lq lr kh ls lt lu lv lw lx ly lz ma mb mc md me mf in bi translated">本文展示了当我们能够访问完整的条件时，如何使用Gibbs抽样从复杂的联合分布中提取数据——从分层贝叶斯建模到计算集成，统计分析中的场景无时无刻不在出现。通过追踪一个二元正态目标分布的例子，我们对Gibbs抽样实际上是如何工作的建立了直觉。</p></div><div class="ab cl nw nx hy ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="in io ip iq ir"><p id="6e4a" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated"><em class="mm">延伸阅读:</em></p><p id="28f8" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">[1]马克林，科里。“吉布斯采样”<em class="mm">中【2020年10月2日【https://towardsdatascience.com/gibbs-sampling-8e4844560ae5】T4。</em></p><p id="3496" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated"><em class="mm">【2】马尔可夫链蒙特卡罗(MCMC)抽样介绍，第二部分:吉布斯抽样</em>。<a class="ae mg" href="https://www.tweag.io/blog/2020-01-09-mcmc-intro2/" rel="noopener ugc nofollow" target="_blank">https://www.tweag.io/blog/2020-01-09-mcmc-intro2/</a>。2021年5月23日访问。</p></div><div class="ab cl nw nx hy ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="in io ip iq ir"><p id="5ed8" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated"><em class="mm">来源:</em></p><p id="2a22" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated">[1]:罗伯特·p·多布罗(2016)。随机过程导论。</p></div><div class="ab cl nw nx hy ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="in io ip iq ir"><p id="4705" class="pw-post-body-paragraph lk ll iu lm b ln mh ke lp lq mi kh ls lt mj lv lw lx mk lz ma mb ml md me mf in bi translated"><em class="mm">鸣谢:这篇文章的想法来自于我辅导哈佛统计学课程“Stat 171:随机过程介绍”我的学生让我帮助他们理解多布罗书中的例子5.6，所以我创建了这篇文章中的R脚本。我为本文创建的算法和采样器来自Dobrow的例子。</em></p></div></div>    
</body>
</html>