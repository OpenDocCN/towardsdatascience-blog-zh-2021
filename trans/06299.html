<html>
<head>
<title>The Perfect Shuffle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">完美洗牌</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-perfect-shuffle-aa388ad1ffd1?source=collection_archive---------16-----------------------#2021-06-06">https://towardsdatascience.com/the-perfect-shuffle-aa388ad1ffd1?source=collection_archive---------16-----------------------#2021-06-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="5fdb" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/thoughts-and-theory" rel="noopener" target="_blank">思想和理论</a></h2><div class=""/><div class=""><h2 id="155d" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">调查faro洗牌背后的数学，同时回答以下问题:将一副牌恢复到原始顺序需要多少次完美的洗牌？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/f494186d7f143ba6067030bcba9f7335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsrbjzRkF4bmR_x_-1xBMA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="1935" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">两年前，我偶然发现了一副工匠扑克牌。看起来光滑的霓虹灯红色口音，我买了它没有太多的想法。我从来没有特别擅长处理卡片，扇动卡片或做法罗洗牌对我来说是一个有点挣扎。但那副全新的牌给了我足够的虚假信心，让我再次尝试掌握它。</p><p id="14ad" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">进步是渐进的，但我越来越被一副简单纸牌的神秘所吸引。这是我经历了一个<a class="ae ma" href="https://www.reddit.com/r/Showerthoughts/" rel="noopener ugc nofollow" target="_blank"><em class="mb">r/shower thoughts</em></a><em class="mb"/>的时刻。</p><blockquote class="mc"><p id="bc2f" class="md me iq bd mf mg mh mi mj mk ml lz dk translated"><strong class="ak">我要完美地洗牌多少次才能让它回到原来的顺序？</strong></p></blockquote><p id="954f" class="pw-post-body-paragraph le lf iq lg b lh mm ka lj lk mn kd lm ln mo lp lq lr mp lt lu lv mq lx ly lz ij bi translated">正如你可能预测的那样，我没有达到可以轻松地将52张牌完美地洗牌8次的水平，无法计算出需要洗牌的次数才能将它恢复到原来的顺序。最后，我写了一个简单的脚本来帮我洗牌。</p><p id="cb2a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我将这些发现绘制在线图上<em class="mb">(图1) </em>，立即引起我注意的是出现的模式。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mr"><img src="../Images/ab862a9d908a199841d8aa1e2105196b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MmlExNWENTPBIV__5gPNjQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图1恢复一副牌所需的洗牌次数(图片由作者提供)</p></figure><p id="f2d9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我无法解释为什么一副384张牌只需要<strong class="lg ja"> 14次洗牌</strong>，而一副54张牌需要<strong class="lg ja"> 52次洗牌</strong>。另一个有趣的图案是图形的“峰值”,完美地形成一条直线。事情开始变得有点复杂了…</p><p id="2128" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我走上<a class="ae ma" href="https://www.reddit.com/r/math/comments/azgq4z/number_of_faroshuffles_to_return_a_deck_of_cards/?utm_source=share&amp;utm_medium=web2x&amp;context=3" rel="noopener ugc nofollow" target="_blank"> <em class="mb"> r/math </em> </a>希望找到答案。它收到了一些冗长的解释(对此我很感激),提到了<em class="mb">模函数</em>和<em class="mb">二进制幂。有了基本的高中数学知识，我努力理解答案背后的直觉，慢慢地就听其自然了。</em></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="9be0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">快进到今天，当我在<a class="ae ma" href="https://adventofcode.com/2020" rel="noopener ugc nofollow" target="_blank"> <em class="mb">代码</em> </a> <em class="mb"> </em>降临的最后一天工作时，我在那里遇到了<a class="ae ma" href="https://en.wikipedia.org/wiki/Discrete_logarithm" rel="noopener ugc nofollow" target="_blank"> <strong class="lg ja">【离散对数问题】</strong> </a>。<strong class="lg ja">欧拉的全等函数<em class="mb">φ(n)</em></strong>在我试图求解DLP的时候，出现了一个重要的概念。</p><blockquote class="mz na nb"><p id="c1d1" class="le lf mb lg b lh li ka lj lk ll kd lm nc lo lp lq nd ls lt lu ne lw lx ly lz ij bi translated">全宿函数<em class="iq">φ</em>(n)，也称为欧拉全宿函数，定义为与n互质(即不包含任何共同因子)的正整数&lt; =n的个数。</p></blockquote><p id="7755" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在搜索totient函数时，我弹出了一个解释页面，上面有一个针对正整数范围的totient函数的线图<em class="mb">(图2) </em>。一种似曾相识的感觉压倒了我，我认出了熟悉的模式。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/346d1c3f65aad71dd013c81ee9532f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2nJanqy2G6AZdN57sLycQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图2图片来自<a class="ae ma" href="https://commons.wikimedia.org/wiki/File:EulerPhi100.PNG" rel="noopener ugc nofollow" target="_blank">维基共享</a></p></figure><p id="faf8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这个函数有点类似于恢复一副<em class="mb"> n </em>牌所需的洗牌次数之间的关系。我的脑海里立即开始形成假设，确信完美洗牌的秘密与<strong class="lg ja">离散对数</strong>和<strong class="lg ja">全能函数</strong>有关。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="53a5" class="ng nh iq bd ni nj nk nl nm nn no np nq kf nr kg ns ki nt kj nu kl nv km nw nx bi translated">法罗洗牌</h1><p id="5bce" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">在我开始计算之前，让我们来看看“完美”/faro洗牌意味着什么。</p><p id="a54d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">要进行法罗洗牌，你首先要把这副牌分成两等份，然后一次交织一张牌，再把它们组合起来。</p><p id="e905" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">许多人不需要太多的思考就可以表演法罗洗牌，而且做起来也相对容易(两年后，我还是和以前一样糟糕)，然而，许多人不会注意到实际上有两种不同类型的法罗洗牌。</p><h2 id="1793" class="od nh iq bd ni oe of dn nm og oh dp nq ln oi oj ns lr ok ol nu lv om on nw iw bi translated">洗牌出局</h2><p id="6ac3" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">向外洗牌会将原来的顶牌和底牌保持在原来的位置。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/65f973593feda914f48c09f902cf299c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-obWLafSmFo2pknaLV0qvw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">无序播放(图片由作者提供)</p></figure><h2 id="2a68" class="od nh iq bd ni oe of dn nm og oh dp nq ln oi oj ns lr ok ol nu lv om on nw iw bi translated">混洗</h2><p id="67d1" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">内洗牌会将原来最上面的牌移到第二张，将原来最下面的牌移到倒数第二张。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/cf613ae724993b3981d4fd18c6763121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TypIfPSjMzVEEAHY0XI39g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">无序播放(图片由作者提供)</p></figure><p id="d2bf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我猜你现在会意识到，直觉上不同类型的法罗洗牌将需要不同次数的洗牌来恢复牌组的原始顺序。</p><p id="f29c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了巩固这种直觉，我们必须用数学的方式来表达法罗洗牌。</p><h1 id="60d8" class="ng nh iq bd ni nj op nl nm nn oq np nq kf or kg ns ki os kj nu kl ot km nw nx bi translated">洗牌之后会发生什么？</h1><p id="75ec" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">让我们先来看看洗牌的结果，以及在一次洗牌后每张牌的位置会如何变化。</p><h2 id="c171" class="od nh iq bd ni oe of dn nm og oh dp nq ln oi oj ns lr ok ol nu lv om on nw iw bi translated">洗牌出局</h2><p id="0506" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">我们首先用一个<strong class="lg ja">零索引编号系统</strong>标记每张卡片的位置。该副牌中的第一张牌将位于位置<em class="mb"> 0 </em>，而该牌的最后一张牌将位于位置<em class="mb"> N-1 </em>，其中<em class="mb"> N </em>代表该副牌中的牌总数<em class="mb">。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/151bcc608f4949b1d6f96160012bd044.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6g2Paj-zAhC0m8cSHJ3RQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">零索引数字系统(作者图片)</p></figure><p id="afef" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">由于我们需要将这副牌分成2等份，如果我们使用<em class="mb"> n </em>修改符号会更有用，其中<em class="mb"> n </em>表示每个等份中的牌的数量。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/47cf709e31159bddb5feb3d487510995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NaJ5qoPJQDV_KfsF4Qpmvg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="792f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">位置<code class="fe ow ox oy oz b">0, 1,..., n-2, n-1</code>属于前半部分，第一张牌的位置值为<em class="mb"> 0 </em>，最后一张牌的位置值为<em class="mb"> n-1 </em>。类似地，位置<code class="fe ow ox oy oz b">n, n+1,..., 2n-1, 2n-1</code>属于后半部分，其第一张牌的位置值为<em class="mb"> n </em>，而其最后一张牌的位置值为<em class="mb"> 2n-1。</em></p><p id="f114" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">这种修改后的符号允许我们将牌分成两个不同的部分，为我们在模拟洗牌时提供了更自然的表达。</strong></p><p id="e014" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">由于该副牌的顶牌和底牌的位置不变，在一次洗牌后，只有该副牌的内侧部分的位置会改变。</p><p id="43fa" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们可以这样想象一次洗牌后每张牌的最终位置:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pa"><img src="../Images/c6974af462112905d8a2e1d3d901234a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_KPZnSnaoXlJPFIDWEzsnw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="1c15" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在牌已经交织在一起了，对于每一次洗牌，我们可以用这个模式来决定每张牌的位置(稍后会有更多的介绍)。</p><h2 id="9be7" class="od nh iq bd ni oe of dn nm og oh dp nq ln oi oj ns lr ok ol nu lv om on nw iw bi translated">混洗</h2><p id="ca3f" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">按照相同的零索引编号系统，我们可以像对出洗牌一样表达一副牌的入洗牌的结果。</p><p id="cffc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在一次洗牌后，所有的牌都将经历一次位置的改变，这与洗牌不同。</p><p id="fb59" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">in-shuffle的结果可以表示如下:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/db68c0da2dafebcd4fa548b3d8c7b271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rk_k7K_sF4cCvxJbPKU4dw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="20f8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">原来最上面的牌变成从上面数的第二张牌，原来最下面的牌变成从下面数的第二张牌。</p><h1 id="8d72" class="ng nh iq bd ni nj op nl nm nn oq np nq kf or kg ns ki os kj nu kl ot km nw nx bi translated">我们能把这浓缩成一个优雅的方程式吗？</h1><p id="f9dc" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">洗牌有一个明确的模式，毕竟，直觉告诉我们，它只是把一半的一张牌放在另一半的一张牌上面。</p><p id="df6f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">两种洗牌方式的交织运动肯定可以浓缩成一个优雅的方程式。</p><h2 id="b2fe" class="od nh iq bd ni oe of dn nm og oh dp nq ln oi oj ns lr ok ol nu lv om on nw iw bi translated">洗牌出局</h2><p id="c319" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">为了简单起见，让我们用一副6张牌来形象化地表示出洗牌。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/737418b5206815037e294063ad587190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6sfIXLsM_XvMb3EU1sA5Q.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="4ff9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">经过一次洗牌后，<strong class="lg ja">位置的原牌<em class="mb"> 1 </em>移动到位置<em class="mb">2</em>T5，而<strong class="lg ja">位置的原牌<em class="mb"> 2 </em>移动到位置<em class="mb"> 4 </em> </strong>。如果你马上注意到这个模式，那么说也许在一次洗牌后，位置随着一个函数<em class="mb">2×原始位置而改变是不会错的。</em>然而，当你检查其他卡片时，你意识到它并不适用于所有的卡片，尤其是后半部分的卡片。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/2266466453491405dbd291b8ec11dd0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zR_VSfuH8ZABhQVQxgpmCA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="37a1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">函数<em class="mb">2×原始位置</em>在前半段运行良好的原因是，结果直接等于出洗牌后前半段中单张牌之前的牌数。</strong></p><p id="b53b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">事实上，我们可以认为后半部分的卡片也是如此，只是不太明显。一次洗牌的交织运动对牌的两半都是一样的，因此，如果<em class="mb">2×原始位置</em>的函数足以确定前半部分牌的最终位置，也许我们正好处于一个一般等式的顶点。</p><p id="6a93" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">同样的交织运动发生在卡片的后半部分，但是函数<em class="mb">2×原始位置</em>给了我们一个超过最大位置的最终位置。如果我们只是把它“包”起来会怎么样？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pe"><img src="../Images/f28d8f8865e11d1add464df9d2b7d21c.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*WUNkDKi7rM6M4TueDLmGxA.png"/></div></div></figure><p id="c934" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">通过应用模运算符，我们将函数<em class="mb">2×原始位置</em>的结果“包装”起来，这样我们就能够在后半部分得出纸牌的正确位置。</strong></p><p id="0cae" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">将额外的模运算符添加到函数<em class="mb">2×原始位置</em>中，得到了我们一直在寻找的通用(并且相当优雅)方程。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/f0acb7df1880a0ba94f27c1a0622c6b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*CbdNhDfJUg09gBXoej7eGw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">其中j是卡片的原始位置</p></figure><h2 id="d057" class="od nh iq bd ni oe of dn nm og oh dp nq ln oi oj ns lr ok ol nu lv om on nw iw bi translated">混洗</h2><p id="5730" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">我们也可以采用同样的6张牌实验来形象化洗牌。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pg"><img src="../Images/0dde73c0ba9b205cb6ca21dd5264eac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZ7EoAneQ7mIUauBFsH0-w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="cd0c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在一次洗牌后，我们看到顶牌和底牌的位置发生了变化。<strong class="lg ja">位置<em class="mb"> 0 </em>的原卡移动到<em class="mb">1</em>T35】位置，而<strong class="lg ja">位置<em class="mb"> 1 </em>的原卡已经移动到<em class="mb">3</em>T41】位置。</strong></strong></p><p id="9bf0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在这一点上，你意识到我们刚刚发现的等式显然不适用于in-shuffle。<strong class="lg ja">但是如果我们简单地在它后面加一个<em class="mb"> +1 </em>会怎么样呢？</strong></p><p id="ff7a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">你又兴奋了，所以你开始在卡片的后半部分测试它…</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ph"><img src="../Images/2c9695d2dfdd818c2df12a6a03479d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXOmVMGPcYp8IKKnnyXw7A.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="dc98" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">失望之余，你意识到<code class="fe ow ox oy oz b">2j mod (2n-1) + 1</code>对卡的后半部分不会一概而论。但是如此坚定之后，你发现<code class="fe ow ox oy oz b">2j-1 mod (2n-1)</code>在后半段有效。用一个条件函数来表示单一的混洗操作开始变得混乱了。</p><p id="9dd2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">出洗牌的交织动作和入洗牌的交织动作之间的唯一区别是一半的牌“走在”另一半的上面。在外洗牌中，牌的前半部分放在后半部分的上面，反之亦然。</strong></p><p id="84a2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">直觉上，内洗牌和外洗牌的一般等式应该没有太大区别。</p><p id="97c2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们知道，在外洗牌中，等式<code class="fe ow ox oy oz b">2j mod (2n-1)</code>将给出洗牌后某张牌之前的牌数。它也方便地等于卡片的最终位置。<strong class="lg ja">这部分是因为零索引编号系统的良好特性。</strong></p><p id="5e63" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">按照同样的思路，我们需要一个包含这些属性的等式来进行混洗。<strong class="lg ja">零基索引系统效果不佳，但一基索引系统呢？</strong></p><p id="30e9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">使用基于一的索引系统:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pi"><img src="../Images/ef3c6a2598410671de650dffd3041a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-YitTSiKMgw1hNIXDKSlA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pj"><img src="../Images/14dacd13782fc5c402538cbff70a0df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6zJsUsuFAqR258EGxY19SQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="d729" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">仅仅改变索引系统还不够。我们需要重新考虑如何修改我们的“包装”逻辑/模操作数。</p><p id="f984" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">因为我们使用的是以1为基础的索引系统，所以我们的通用等式不应该产生零值。做一个简单的测试，如果我们将我们的模操作数指定为<em class="mb"> 6 </em>，如果我们使用等式<code class="fe ow ox oy oz b">2j mod (2n)</code>其中<em class="mb"> 2n </em>是最后一张牌的位置，那么位置<em class="mb"> 4 </em>处的原始牌将具有最终值<em class="mb"> 0 </em>。</p><p id="ed8e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">因此，为了维护基于1的索引，我们的模操作数应该改为<strong class="lg ja"> <em class="mb"> 2n+1 </em> </strong>。</p><p id="7f53" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">把所有的东西拼凑在一起，我们现在得到了一个通用的(同样优雅的)内混洗方程。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/aab1680f0c52c8cf66c22a75fa4e8c23.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*xsanGKmmytDkbMD-jq8OVw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">其中j是一张卡从1开始的原始位置</p></figure><h1 id="ba5d" class="ng nh iq bd ni nj op nl nm nn oq np nq kf or kg ns ki os kj nu kl ot km nw nx bi translated">多次洗牌</h1><p id="a75c" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">现在我们有了表示内洗牌和外洗牌的等式，让我们找出在<em class="mb"> n </em>洗牌后一张特定的牌将被放置在哪里。</p><p id="6538" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">本质上，这是我们正在解决的一个简单的递归问题。</p><p id="7cb4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">编写一个简单的python脚本来运行这个递归将是一个简单的任务(简单地增加large <em class="mb"> n </em>的堆栈大小)，然而，通常理解正确的数学概念而不是强力递归会给我们带来无与伦比的性能提升。</p><h2 id="aa73" class="od nh iq bd ni oe of dn nm og oh dp nq ln oi oj ns lr ok ol nu lv om on nw iw bi translated">模运算</h2><p id="08cb" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">当我们手动写出递归时，我们可以感觉到我们的脚本将会做什么</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/2db28cdb879d91ad5e15215cf2940089.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*IH7Ohy1mH3q-XjFElRt_ng.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">其中j是卡片的起始位置</p></figure><p id="a9bf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">前一个操作的结果将被输入到下一个操作中，重复这个循环，直到该副牌已经完成<em class="mb"> n </em>次洗牌。执行时间肯定不会很长，但是让我们试着简化一下，给它一点提升。</p><p id="57f3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们把范围缩小到仅仅是<strong class="lg ja"> <em class="mb"> 2 </em>出洗牌</strong>:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/56a22158fdb47cedac7acb8a86a8bdf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*kDGL9d3DHNQqtJoG27u6Ng.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">其中J是一次洗牌后牌的位置</p></figure><p id="7d86" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">通过应用模运算 的<a class="ae ma" href="https://brilliant.org/wiki/modular-arithmetic/#:~:text=Properties%20of%20multiplication%20in%20modular,(modN)." rel="noopener ugc nofollow" target="_blank"> <strong class="lg ja">模乘性质</strong> <strong class="lg ja">，我们可以将上面的等式展开为下面的形式。</strong></a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/c8bfb073086dafe244873fa9f990817e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cgF1pspHhdNQvyXAFmchzw.png"/></div></div></figure><p id="d070" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">通过对k<em class="mb">混洗进行求解，我们将得到一个具有非常方便的性质的方程。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi po"><img src="../Images/592c140506b67ed0ef8a39a213816d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*tADrQxxj2qvCtPc2KFD0Og.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">在k <strong class="bd pq">洗出</strong>后，获得原始位置为<em class="pp"> j </em>的牌的最终位置的功能</p></figure><p id="3e30" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们刚刚击败了递归！</p><p id="42f5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">上面的例子利用了外混洗，但是由于内混洗只是在模操作数方面有所不同，我们可以用同样的方式简化它的等式。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/6d225b53340d97f9d59bc982949dad26.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*n6htr4sTOIv-KPRLOOoMFA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">在k <strong class="bd pq">之后得到原始位置为j的牌的最终位置的功能-洗牌</strong></p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="9a6e" class="ng nh iq bd ni nj nk nl nm nn no np nq kf nr kg ns ki nt kj nu kl nv km nw nx bi translated">回到原来的问题…</h1><p id="0e6b" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">既然我们已经对faro-shuffle进行了相当多的分析，让我们将注意力转移回我们要解决的问题上。</p><blockquote class="mc"><p id="19bf" class="md me iq bd mf mg mh mi mj mk ml lz dk translated">将一副牌洗回原来的顺序需要多少次法罗洗牌？T25】</p></blockquote><p id="47ec" class="pw-post-body-paragraph le lf iq lg b lh mm ka lj lk mn kd lm ln mo lp lq lr mp lt lu lv mq lx ly lz ij bi translated">我们探索了用数学方法表达两种不同类型的faro洗牌的方法，并查看了帮助我们计算出在<em class="mb"> n </em>次洗牌后一张牌会在什么位置的等式。到目前为止，我们已经从一个单独的卡片层面看了这个问题，下一步是把它推广到整个卡片组。</p><p id="a845" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当每张牌都回到原来的位置时，一副牌就回到原来的顺序。</p><p id="4877" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">将这种直觉转化为数学术语，我们得到以下结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/1cfa068123de0cb2dac730412f46dd4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*xNV47CPVPHa8F9HleZxoyQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">将一副牌恢复到原始顺序所需的洗牌次数(用k表示)</p></figure><p id="493d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">通过进一步应用模算术的相同模乘特性，我们看到了一个<strong class="lg ja">离散对数问题<em class="mb">的最初迹象。</em> </strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pt"><img src="../Images/c90c5391c2ac621c46c1dae39acc5878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bp_vx0vpJZSf5oCro0CqFg.png"/></div></div></figure><p id="9fd0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">我们看到，我们现在能够独立于牌的原始位置来处理洗牌操作。</strong>更棒的是，洗牌操作模型经过了<strong class="lg ja">离散对数问题</strong>。</p><p id="32b4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们终于找到了！</p><p id="20d8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">只关注洗牌操作将给出一个略显简洁的方程来求解:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/5c448c7c9e14d557b5da6c462b725cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*xML1BCSLjiLuz70UaGVcSA.png"/></div></figure><p id="c734" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在，这个等式似乎很难解决，暴力似乎是唯一可行的方法。我不想做那些试错的工作，所以我心中的愤世嫉俗者决定不洗牌。</p><p id="4845" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">当<em class="mb"> k = 1 </em>时，我们不用做任何繁琐的工作就能完美地满足方程。</strong></p><p id="c980" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">毕竟，即使是人工智能算法有时也认为这是赢得游戏的最佳方式。虽然从技术上来说，这是一个完全可以接受且符合逻辑的答案，但它对这个问题没有任何价值。</p><p id="aef6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这假设我们可能需要设置一个重要的约束，<strong class="lg ja"> k必须至少为1。</strong></p><h1 id="b9b1" class="ng nh iq bd ni nj op nl nm nn oq np nq kf or kg ns ki os kj nu kl ot km nw nx bi translated">求解DLP</h1><p id="f321" class="pw-post-body-paragraph le lf iq lg b lh ny ka lj lk nz kd lm ln oa lp lq lr ob lt lu lv oc lx ly lz ij bi translated">我们可以进一步简化方程，将其推广为一般的离散对数问题。简单回顾一下，<em class="mb">2n-1</em>&amp;<em class="mb">2n+1</em>的模操作数与我们选择的索引系统非常接近，分别用于模拟出混和入混。然而，当试图将手头的问题简化为一般的DLP时，形式<em class="mb">2n-1</em>&amp;<em class="mb">2n+1</em>没有数学上的重要性。我们可以简单地用一个<strong class="lg ja">正整数X </strong>来表示它们。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/8a5ebe31f9b1d4e3d6daab798bcd2e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*uwLqUTpQnSiDmw4SyGLVFQ.png"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/2c927d58896fde6461f3e6f06e27a279.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*f1ZfWhblMrIHDePeUDoWHQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">其中X可以代表2n+1或2n-1</p></figure><p id="a0fc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">有很多方法可以解决DLP，无论是使用蛮力还是<a class="ae ma" href="https://en.wikipedia.org/wiki/Baby-step_giant-step" rel="noopener ugc nofollow" target="_blank">小步快走(BSGS)算法</a>。你也可以通过实现<a class="ae ma" href="https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm" rel="noopener ugc nofollow" target="_blank">poh lig–Hellman算法</a>来加快速度。</p><p id="0b36" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我不会详细讨论DLP或解决它的各种方法，因为它本身值得另一篇文章来讨论。但是为了完整起见，我包含了一个用python写的BSGS的简单实现，我用它来求解这个方程。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="px py l"/></div></figure><h1 id="b0a4" class="ng nh iq bd ni nj op nl nm nn oq np nq kf or kg ns ki os kj nu kl ot km nw nx bi translated">回到图表</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mr"><img src="../Images/ab862a9d908a199841d8aa1e2105196b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MmlExNWENTPBIV__5gPNjQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="c253" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这个线图是通过手动模拟洗牌操作生成的。在将faro洗牌浓缩成一个“简单的”DLP之后，我们现在可以验证我们的新方法是否对应并且工作良好。</p><p id="4424" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我将解决DLP(橙色线)的结果叠加在手动模拟(蓝色色调)的结果之上。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pz"><img src="../Images/ebbe142683b4a0c1c8547ef69a25c5da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JBW1Atn-p_CILLs0SYf2Vg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="d2f4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们可以看到它排列得非常完美，并且它充当了我们已经成功地将该问题建模为离散对数问题的视觉和定量证明。</p><p id="2553" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">你可能已经意识到的另一件事是，从观察绘制的图表来看，进出洗牌所需的洗牌次数似乎是相同的。这可能有点违背我们的直觉，因为它们实际上仍然是不同种类的洗牌。</p><p id="f334" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当我们比较这两个线图时，我们发现实际上有一个很小的有趣的区别。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi qa"><img src="../Images/2347afcfb8a65a70e92b893afd8d06bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUwSh8bZGQd_S0KD9QGgbg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="8d2e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">红线标记了需要相同次数洗牌才能将一副牌恢复到原来位置的点。有趣的是，所需的内洗次数的线图似乎“落后于”外洗次数的线图。仔细观察，我们可以看到<em class="mb"> N张</em>牌所需的<strong class="lg ja">外洗牌次数与<em class="mb"> N-2张</em>牌所需的内洗牌次数相同，</strong>有效地使内洗牌比外洗牌落后“一步”。</p><p id="78f5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">关键的直觉来自我们之前检查过的一个重要细节。<em class="mb">出洗牌并不影响该副牌的顶牌和底牌，它只是改变它们之间的位置，而不是所有的牌在入洗牌中改变它们的位置。</em></p><p id="ac0a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">但是在洗牌过程中，顶牌和底牌中间的牌是如何被洗牌的呢？</strong></p><p id="ae5d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">回到我们使用的6张牌的例子，让我们进一步分解出洗牌。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi qb"><img src="../Images/b3508b569ef260340e89943a557fd340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*whcwHVdHGIQIe5NAr-utvA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="f15f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">忽略顶部和底部没有改变位置的卡片，我们看到中间部分以一种奇怪的熟悉的方式洗牌。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi qc"><img src="../Images/e615af9869d87e114bd22736130d43de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofucoTz4qflXDNoYpoVD1A.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="6632" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">分离出牌的中间部分，我们意识到在洗牌后，它的所有位置都会改变。这类似于内洗牌，当我们仔细观察它的位置如何变化时，它与内洗牌相同<strong class="lg ja">。</strong></p><blockquote class="mz na nb"><p id="4a0f" class="le lf mb lg b lh li ka lj lk ll kd lm nc lo lp lq nd ls lt lu ne lw lx ly lz ij bi translated"><strong class="lg ja">每次出牌本质上都是在顶牌和底牌之间的一次入牌。</strong></p></blockquote><p id="638e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我想说出洗牌基本上是由入洗牌组成的，只是在末尾增加了两张在这个过程中不会被洗牌的额外的牌，这样说不会不恰当。</p><h1 id="3f1e" class="ng nh iq bd ni nj op nl nm nn oq np nq kf or kg ns ki os kj nu kl ot km nw nx bi translated"><strong class="ak">但是等等……那些山峰呢？</strong></h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mr"><img src="../Images/ab862a9d908a199841d8aa1e2105196b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MmlExNWENTPBIV__5gPNjQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="d13e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在我展示的图表中，一个引人注目的细节是当我们洗牌到一定数量的牌时会出现“峰值”。“峰”和“谷”是为什么一副54张牌需要<strong class="lg ja"> 52次洗牌</strong>才能恢复其顺序，而一副384张牌只需要<strong class="lg ja"> 14次洗牌</strong>的原因。至少可以说，这是不直观的，但是也许研究一下<strong class="lg ja">欧拉的全能函数<em class="mb">φ(n)</em></strong>可以给我们一个起点。</p><p id="bdc1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当我们画出这个函数时，我们看到了相同的“峰值”模式。另一个要注意的有趣的点是“峰值”形成一条直线。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/346d1c3f65aad71dd013c81ee9532f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2nJanqy2G6AZdN57sLycQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图片来自<a class="ae ma" href="https://commons.wikimedia.org/wiki/File:EulerPhi100.PNG" rel="noopener ugc nofollow" target="_blank">维基共享</a></p></figure><p id="4720" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mb">to entint函数给出了给定整数n之前的正整数的数目，这些正整数是</em><a class="ae ma" href="https://en.wikipedia.org/wiki/Coprime_integers" rel="noopener ugc nofollow" target="_blank"><em class="mb"/></a><em class="mb">到n的互质数</em>【峰值】对应的质数为<strong class="lg ja"><em class="mb">【φ(n)= n-1</em></strong><em class="mb">。</em>因此，直线遵循一条<em class="mb"> y = x -1 </em>线的形状。</p><p id="57a5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">也许这和我们的洗牌问题有关。</p><p id="2070" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们知道我们可以把洗牌问题浓缩成一个DLP，事实上，一个非常特殊的DLP。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/8db3044d917d8b90057ef2b44e0703e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*HzBrGzA0Eh76Z-JQU5SrPg.png"/></div></figure><p id="bf32" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">碰巧的是<a class="ae ma" href="https://en.wikipedia.org/wiki/Euler%27s_theorem" rel="noopener ugc nofollow" target="_blank"> <strong class="lg ja">欧拉定理</strong> </a> <strong class="lg ja"> </strong>有着相对相似的形式，并且给了我们一个更好的概念，即全能函数如何与我们的洗牌问题相联系。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/a4d65bf4ca0e1ff43a74386d94d823bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*HimoQEUCEEdXvIkMFVnKzg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">欧拉定理</p></figure><p id="47d6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们来看看为什么一副54张牌需要52次洗牌。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/5303998f003ea0927947b3b42b7333f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*yuooSOwor0iThQhE-HqQ4A.png"/></div></figure><p id="5fef" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">很明显，当我们输入数字时，我们的模就变成了一个质数。根据欧拉定理，指数是模的渐近函数的结果。<strong class="lg ja">由于53是质数，所以会有<em class="mb">53–1</em>个正整数与其互质，导致指数为52。</strong></p><p id="d60b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这也扩展到内混洗，只要模是质数并且符合欧拉定理，我们得到一个指数，它对应于所需的混洗次数，即<em class="mb">模1。</em></p><p id="65a7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">作为一个总的结论，因此“峰值”是在一副牌中的牌的数量产生一个素数模的点上，无论是在洗牌中还是在洗牌中。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi qg"><img src="../Images/d5788095d47f437ff703feb451f458a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OZ5X9dcTnkLCKpS5IVI5rA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><blockquote class="mc"><p id="2a0f" class="md me iq bd mf mg qh qi qj qk ql lz dk translated">我们现在已经破解了完美洗牌的内部运作</p></blockquote></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="55f3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这是我写第一篇文章的一次有趣尝试，它确实有助于巩固我对手头主题的理解。你也会很高兴地知道，红色的霓虹灯牌现在在我的桌子上占据了一个永久的位置，既是一个坐立不安的玩具，也是花一些时间深入挖掘简单事物的灵感来源。</p></div></div>    
</body>
</html>