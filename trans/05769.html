<html>
<head>
<title>Understanding Convolutions by hand vs TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">手动理解卷积与张量流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-convolutions-by-hand-vs-tensorflow-8e64053f673e?source=collection_archive---------21-----------------------#2021-05-23">https://towardsdatascience.com/understanding-convolutions-by-hand-vs-tensorflow-8e64053f673e?source=collection_archive---------21-----------------------#2021-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="463a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你觉得我们可以手工匹配TensorFlow吗？你打赌！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0f7c53f812c1c4ab34e88dd17d49784e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sYwlMykVbKh27WOwDCQG6g.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供，灵感来自<a class="ae kv" href="https://cs231n.github.io/convolutional-networks/" rel="noopener ugc nofollow" target="_blank">来源。</a></p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="343f" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">1.目的</h1><p id="afaa" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">TensorFlow和各种其他用于机器学习的开源库，如SciPy，提供了这些用于执行卷积的内置函数。然而，尽管这些函数很好，但是打开引擎盖去发现代码背后的强大功能是值得的。在我看来，如果没有卷积层，计算机视觉就会像蝙蝠一样瞎。因此，我希望您喜欢这篇文章，因为我们将深入研究构成卷积层的卷积，并一起了解全局。</p><p id="9ee5" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">我为此制作的Jupyter笔记本在我的<a class="ae kv" href="https://github.com/stevensmiley1989/Convolutions_by_hand_vs_TensorFlow" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="c4fa" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">2.背景</h1><p id="f75b" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">卷积对于计算机视觉中的深度学习任务来说并不新鲜。它们只是图像处理中使用的一种技术。在图像处理中，卷积运算是将输入图像的每个元素与其局部相邻元素相加的过程，通过内核进行加权。输出大小将取决于以下因素:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/8dbc52e5f40eedad2f776b35596e885c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*yzNmtHOe838Wi1Y-IC0Jag.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供，灵感来自<a class="ae kv" href="https://cs231n.github.io/convolutional-networks/" rel="noopener ugc nofollow" target="_blank">来源。</a></p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="a004" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">3.输入过滤器</h1><p id="a519" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">玉米粒有各种形状和大小。这些内核组成了滤波器，滤波器是卷积层中使用的一个参数。对于本文，我将坚持使用基于边缘检测的普通过滤器:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/e9b68913802e42ff1eb924cd5f5794de.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*n4wjasNM5mCBLuWEnS1t_g.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/5bab1761dc10c34991406eadbca37fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*CNGznqUaLJ0X_hJxh_ygpg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/67d7bda494f812e88bdd4841621feb69.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*s54pB0IiRxZxNORpxazVoQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="75c6" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">4.输入音量</h1><p id="ade7" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">为了便于对示例进行数学检查，我将使用5x5x3的随机输入量:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/670d9618ed213ebb7955285ba1622378.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*DuadGPC8L62jUIC914B5Dg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/8c42ba4f48e530a2166f9e211f313b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*e4OUG0kL0WeQV4vB87CAew.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/cdde00be054a44a3b8a408c4b31a9ba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*9aC3RoO6SQ7xlmCOjM6Cqg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="1b21" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">5.零填充</h1><p id="fece" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">通常，零填充被添加到输入图像中。因此，在本例中，我将添加一个零填充，P=1，这将返回7x7x3的输入量:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/ce965dcc8c2b9e189f9ecfd417b9661b.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HrjPIelhrvNp2fdJ0Fm3Vw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c899a7f5d587f03e72e0f37d9c41a5ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*ORFbSfN_Qm8m2Nrf_AoQtQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/c0fe7e15bb371e8e63fc057c3a1b4218.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*69FRc02qUIFAGmzeBeGrvQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><h1 id="cfae" class="ld le iq bd lf lg ni li lj lk nj lm ln jw nk jx lp jz nl ka lr kc nm kd lt lu bi translated">6.进展</h1><p id="2a46" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">对于这个例子，步幅将是S=2。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="42c2" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">7.手算输出量</h1><p id="9b5a" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">将过滤器通过左上方输入体积的局部感受野:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b9ea3a9257c70a3028d0c5e2daa6e913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*RC-LTtakKQDlIdvuMjFtmw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><p id="b6b9" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">按步幅移动，S=2:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/57b5e73fa39c451f8706cbc59d8f1696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*fXrDuIrXcfGmq3eppe3-ww.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><p id="3442" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">手动将它投入使用:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="de43" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">现在将过滤器通过整个输入体积:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0f7c53f812c1c4ab34e88dd17d49784e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sYwlMykVbKh27WOwDCQG6g.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供，灵感来自<a class="ae kv" href="https://cs231n.github.io/convolutional-networks/" rel="noopener ugc nofollow" target="_blank">来源。</a></p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/a291111679d1cd8d087cb750d8cef2ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*gktuoujPpVOao6bbWhIObw.png"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="b3e9" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">8.使用张量流</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/85ac863f36cfd117f21a7cb7ac550a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*qBCTJJxHX3G7L82CVE1vlw.png"/></div></figure><p id="5986" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">厉害！与我在上一节中手工做的相匹配。现在让我们试着以S=1的步幅传递一个图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/cc1c03887aba28f4d578a82c1e7d0085.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*PHQNYLxH3m0DCl_vKm6LrQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/cb67842e7b08ba3aeac20c5b3c855a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*S3UxqP81nvQK_wM8paRvKQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/cb6db00c79049e7e7684143a3a80c12e.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*4eIY1bTbGoil2FhGFDHG2w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><p id="ebef" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">使用TensorFlow:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/3dbcbdc740cc6567c7ebd004f5b6755d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*aEdovXWm1OFZMlQMUvWHfg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/bce3feb6d4cbe15291d6983e0c4a801d.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*lrbYD6L1zh3Am2KNZ4zBqA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><p id="918a" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">不出所料！TensorFlow和手动定制功能产生相同的卷积图像。边缘检测过滤器现在真的更有意义了，因为你可以看到玩具驯鹿周围的线条。</p><p id="736b" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">这是卷积神经网络(CNN)如此伟大的原因之一。随着卷积层被训练，权重(核)被更新，并且有希望创建有意义的特征图，以使用训练过的模型来执行你的计算机视觉任务。</p><p id="db7d" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">感谢您的阅读！我希望你已经学到了一些关于卷积的新知识，如果你还不能看到的话，我希望你能在这之后看到更大的图景。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="f455" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">9.参考</h1><p id="e2ab" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">1.内核(图像处理)[<a class="ae kv" href="https://en.wikipedia.org/wiki/Kernel_(image_processing)]" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Kernel _(图像处理)] </a></p><p id="5f64" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">2.TF . nn . conv 2d[【https://www.tensorflow.org/api_docs/python/tf/nn/conv2d】T2</p><p id="bb94" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">3.Python。特拉维斯·奥列芬特。用于科学计算的Python,《科学与工程中的计算》, 9，10–20(2007年b) K. Jarrod Millman和Michael Aivazis。面向科学家和工程师的Python，科学与工程中的计算，13，9–12(2011)</p><p id="cbd3" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">4.张量流。马丁·阿巴迪、阿希什·阿加瓦尔、保罗·巴勒姆、尤金·布莱夫多、陈质枫、克雷格·西特罗、格雷格·科拉多、安迪·戴维斯、杰弗里·迪恩、马蒂厄·德文、桑杰·格玛瓦特、伊恩·古德菲勒、安德鲁·哈普、杰弗里·欧文、迈克尔·伊萨德、拉斐尔·约泽福维茨、杨青·贾、卢卡斯·凯泽、曼朱纳斯·库德鲁尔、乔希·莱文伯格、丹·曼内、迈克·舒斯特、拉杰特·蒙加、雪莉·穆尔、德里克·默里、克里斯·奥拉、黄邦贤·施伦斯、伯努瓦·施泰纳TensorFlow:异构系统上的大规模机器学习，2015。tensorflow.org提供的软件。</p><p id="bd38" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">5.SciPy。保利·维尔塔宁、拉尔夫·戈默斯、特拉维斯·奥列芬特、马特·哈伯兰、泰勒·雷迪、戴维·库尔纳波、叶夫根尼·布罗夫斯基、皮鲁·彼得森、沃伦·韦克塞、乔纳森·布赖特、斯蒂芬·范德沃特、马修·布雷特、约书亚·威尔逊、贾罗德·米尔曼、尼古拉·马约罗夫、安德鲁·纳尔逊、埃里克·琼斯、罗伯特·克恩、埃里克·拉森、希杰·凯里、i̇lhan·波拉特、余峰、埃里克·摩尔、杰克·范德普拉斯、丹尼斯·拉克萨尔德、约瑟夫·佩尔(2019)SciPy 1.0-Python中科学计算的基本算法。预印本arXiv:1907.10121</p><p id="d095" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">6.NumPy。特拉维斯·奥列芬特。美国NumPy指南:特雷戈尔出版公司(2006年)。(b)斯蒂芬·范德沃特、克里斯·科尔伯特和盖尔·瓦洛夸。NumPy数组:高效数值计算的结构，科学与工程中的计算，13，22–30(2011)</p><p id="bb95" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">7.IPython。费尔南多·佩雷斯和布莱恩·格兰杰。IPython:用于交互式科学计算的系统，科学与工程中的计算，9，21–29(2007)</p><p id="5b42" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">8.Matplotlib。亨特，“Matplotlib:2D图形环境”，《科学与工程中的计算》，第9卷，第3期，第90–95页，2007年。</p><p id="2237" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">9.熊猫。韦斯·麦金尼。Python中统计计算的数据结构，第9届科学中的Python会议录，51–56(2010)</p><p id="2b9b" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">10.sci kit-学习。法比安·佩德雷戈萨、加尔·瓦洛夸、亚历山大·格拉姆福特、文森特·米歇尔、贝特朗·蒂里翁、奥利维尔·格里塞尔、马蒂厄·布隆德尔、彼得·普雷登霍弗、罗恩·韦斯、文森特·杜伯格、杰克·范德普拉斯、亚历山大·帕索斯、戴维·库尔纳波、马蒂厄·布鲁彻、马蒂厄·佩罗特、爱德华·杜谢斯奈。sci kit-learn:Python中的机器学习，机器学习研究杂志，12，2825–2830(2011)</p><p id="723a" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">11.sci kit-图像。斯蒂芬·范德沃特、约翰内斯·l·舍恩伯格、胡安·努涅斯-伊格莱西亚斯、弗朗索瓦·布洛涅、约书亚·d·华纳、尼尔·雅戈、伊曼纽尔·古亚尔特、托尼·于和scikit-image供稿者。sci kit-Image:Python中的图像处理，PeerJ 2:e453 (2014)</p></div></div>    
</body>
</html>