<html>
<head>
<title>Train Your Own Chess AI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">训练你自己的象棋人工智能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/train-your-own-chess-ai-66b9ca8d71e4?source=collection_archive---------0-----------------------#2021-08-17">https://towardsdatascience.com/train-your-own-chess-ai-66b9ca8d71e4?source=collection_archive---------0-----------------------#2021-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bea2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">看着你的作品打败你</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4fbe11d2b5e595e2d1d28dbcc9239bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qdzOFL1k8WMfeMcB"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">迈克尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="c864" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="24ae" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">TLDR: <a class="ae kv" href="https://colab.research.google.com/drive/1smI2B7kiwzkr43TqnCYOpxocZlI0kPUh?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Colab链接</a></p><p id="5d85" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">深度学习已经接管了计算机象棋世界。2017年<a class="ae kv" href="https://deepmind.com/blog/article/alphazero-shedding-new-light-grand-games-chess-shogi-and-go" rel="noopener ugc nofollow" target="_blank"> AlphaZero </a>，AlphaGo针对国际象棋的迭代，通过轻松击败Stockfish迷住了国际象棋迷。该领域的新发展，如<a class="ae kv" href="https://lczero.org" rel="noopener ugc nofollow" target="_blank"> Leela Zero </a>(一个开源的AlphaZero实现，碰巧使用了<a class="ae kv" href="https://github.com/notnil/chess" rel="noopener ugc nofollow" target="_blank"> my chess lib </a>)和<a class="ae kv" href="https://stockfishchess.org/blog/2020/introducing-nnue-evaluation/" rel="noopener ugc nofollow" target="_blank"> Stockfish NNUE </a>(可高效更新的反向神经网络)表明，在可预见的未来，神经网络将继续主导国际象棋。</p><p id="1a40" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">作为一名国际象棋爱好者和人工智能实践者，我开始创造自己的国际象棋人工智能，但一个令人生畏的传言让我气馁:<a class="ae kv" href="https://www.yuzeh.com/data/agz-cost.html" rel="noopener ugc nofollow" target="_blank"> AlphaZero花费3500万美元训练</a>。AlphaZero完全通过强化学习和自我游戏进行训练，以避免外部依赖。虽然明显有效，但从成本角度来看，自我游戏的效率低得令人难以置信。今天的引擎已经可以区分好位置和坏位置。这种先验知识可以用来引导学习过程，并使以非常有限的成本(或在<a class="ae kv" href="http://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Colab </a>上免费)训练象棋AI成为可能。让我们试试吧！并使用来自现有引擎的数据集使用监督机器学习来训练神经网络。</p><h1 id="b0ef" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">定义模型</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/1312ff6bd09720db59efa4bc833eb90f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXQwAx83eKQshWfSftI9bQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型图，图片由作者提供</p></figure><p id="7682" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">引擎如何决定一个位置好不好？给定一个位置，引擎返回从白色角度看这个位置有多好的分数。这个分数被称为评估，通常简称为eval，eval函数是国际象棋引擎的核心。eval是一个以卒当量为单位的真实实力衡量标准。例如，如果白棋是一个棋子，评估将是+1。如果黑棋是骑士，评估将是-3。原材料不是决定评估的唯一因素，位置信息和未来的移动也会被考虑在内。</p><p id="68b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">传统上，eval功能是通过手工算法实现的，这些算法定量测量材料不平衡、工件移动性和国王安全等概念。这些直接测量，结合<a class="ae kv" href="https://www.chessprogramming.org/Iterative_Deepening" rel="noopener ugc nofollow" target="_blank">迭代加深</a>单独产生超人的结果。神经网络可以取代这些手工算法，并直接返回评估结果，无需专门编码。总的来说，eval函数接受一个位置并返回一个评估分数。我们如何把它变成一个模型？</p><p id="543d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">输出eval可以由单个基于浮点的神经元来表示。代表棋盘位置的输入可以使用每种棋子类型的<a class="ae kv" href="https://www.chessprogramming.org/Bitboards" rel="noopener ugc nofollow" target="_blank">位棋盘</a> (64位，棋盘上的每个方格一个)进行编码，剩余的几个位用于移动索引、要移动的颜色和路过的方格。这些输入数据一起形成了一个808位(1和0)的字符串，可以转换成浮点数并直接输入到模型中。</p><p id="e040" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们已经计划好了输入、输出和一般模型概念，让我们开始构建数据集。</p><h1 id="30c1" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">建立数据集</strong></h1><p id="717b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我在<a class="ae kv" href="http://Lichess.com" rel="noopener ugc nofollow" target="_blank">Lichess.com</a>上玩，因为它是免费的，开源的，由开发者运营。Lichess <a class="ae kv" href="https://database.lichess.org" rel="noopener ugc nofollow" target="_blank">拥有网站上所有游戏的每月下载片段</a>。2021年7月包含9200多万场比赛。在注释部分，它提到了一个非常重要的细节:“大约6%的游戏包括Stockfish分析评估”，在这种情况下，这将是550多万个游戏。一般的国际象棋游戏持续大约40步，80个位置(每一方每“步”得到一个回合)，七月应该包含441，600，000个非唯一位置。这似乎足以创建我们的初始数据集。</p><p id="5108" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">Lichess的每月碎片编码为. pgn.bz2文件。文件扩展名. bz2是一种压缩形式。pgn是“<a class="ae kv" href="https://en.wikipedia.org/wiki/Portable_Game_Notation" rel="noopener ugc nofollow" target="_blank">可移植游戏符号</a>”，这是一种基于文本的格式，用于将国际象棋游戏编码为<a class="ae kv" href="https://en.wikipedia.org/wiki/Algebraic_notation_(chess)" rel="noopener ugc nofollow" target="_blank">代数符号</a>中的一系列移动。以下是单个PGN文件记录的文本:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="1c55" class="mv kx iq mr b gy mw mx l my mz">[Event "Rated Bullet tournament https://lichess.org/tournament/yc1WW2Ox"]<br/>[Site "https://lichess.org/PpwPOZMq"]<br/>[Date "2017.04.01"]<br/>[Round "-"]<br/>[White "Abbot"]<br/>[Black "Costello"]<br/>[Result "0-1"]<br/>[UTCDate "2017.04.01"]<br/>[UTCTime "11:32:01"]<br/>[WhiteElo "2100"]<br/>[BlackElo "2000"]<br/>[WhiteRatingDiff "-4"]<br/>[BlackRatingDiff "+1"]<br/>[WhiteTitle "FM"]<br/>[ECO "B30"]<br/>[Opening "Sicilian Defense: Old Sicilian"]<br/>[TimeControl "300+0"]<br/>[Termination "Time forfeit"]<br/><br/>1. e4 { [%eval 0.17] [%clk 0:00:30] } c5 { [%eval 0.19] [%clk 0:00:30] }<br/>2. Nf3 { [%eval 0.25] [%clk 0:00:29] } 2... Nc6 { [%eval 0.33] [%clk 0:00:30] }<br/>3. Bc4 { [%eval -0.13] [%clk 0:00:28] } 3... e6 { [%eval -0.04] [%clk 0:00:30] }<br/>4. c3 { [%eval -0.4] [%clk 0:00:27] } 4... b5? { [%eval 1.18] [%clk 0:00:30] }<br/>5. Bb3?! { [%eval 0.21] [%clk 0:00:26] } 5... c4 { [%eval 0.32] [%clk 0:00:29] }<br/>6. Bc2 { [%eval 0.2] [%clk 0:00:25] } 6... a5 { [%eval 0.6] [%clk 0:00:29] }<br/>7. d4 { [%eval 0.29] [%clk 0:00:23] } 7... cxd3 { [%eval 0.6] [%clk 0:00:27] }<br/>8. Qxd3 { [%eval 0.12] [%clk 0:00:22] } 8... Nf6 { [%eval 0.52] [%clk 0:00:26] }<br/>9. e5 { [%eval 0.39] [%clk 0:00:21] } 9... Nd5 { [%eval 0.45] [%clk 0:00:25] }<br/>10. Bg5?! { [%eval -0.44] [%clk 0:00:18] } 10... Qc7 { [%eval -0.12] [%clk 0:00:23] }<br/>11. Nbd2?? { [%eval -3.15] [%clk 0:00:14] } 11... h6 { [%eval -2.99] [%clk 0:00:23] }<br/>12. Bh4 { [%eval -3.0] [%clk 0:00:11] } 12... Ba6? { [%eval -0.12] [%clk 0:00:23] }<br/>13. b3?? { [%eval -4.14] [%clk 0:00:02] } 13... Nf4? { [%eval -2.73] [%clk 0:00:21] } 0-1</span></pre><p id="27f1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">每次移动后，在注释部分，基于Stockfish的评估以定制的文本格式编写。</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="da70" class="mv kx iq mr b gy mw mx l my mz">1. e4 { [%eval 0.24] [%clk 0:05:00] }</span></pre><p id="29a1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这给了我们与位置配对的eval(从一系列移动中计算)。2021年7月的原始压缩月度碎片为25.2 GB，因此单个CSV文件很可能是不可能的。带有适当索引的SQLite数据库似乎更合适。该架构包括FEN(用于调试的位置的文本编码)、供模型直接使用的二进制以及对定型输出的评估:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="39e1" class="mv kx iq mr b gy mw mx l my mz">&gt; select * from evaluations limit 7;</span><span id="45ae" class="mv kx iq mr b gy na mx l my mz">id|fen|binary|eval<br/>1|rnbqkbnr/pppppppp/8/8/3P4/8/PPP1PPPP/RNBQKBNR b KQkq d3 0 1|0.0<br/>2|rnbqkbnr/ppp1pppp/8/3p4/3P4/8/PPP1PPPP/RNBQKBNR w KQkq d6 0 2|0.27<br/>3|rnbqkbnr/ppp1pppp/8/3p4/2PP4/8/PP2PPPP/RNBQKBNR b KQkq c3 0 2|0.0<br/>4|rnbqkbnr/ppp2ppp/4p3/3p4/2PP4/8/PP2PPPP/RNBQKBNR w KQkq - 0 3|0.09<br/>5|rnbqkbnr/ppp2ppp/4p3/3P4/3P4/8/PP2PPPP/RNBQKBNR b KQkq - 0 3|0.1<br/>6|rnbqkbnr/ppp2ppp/8/3p4/3P4/8/PP2PPPP/RNBQKBNR w KQkq - 0 4|0.0<br/>7|rnbqkbnr/ppp2ppp/8/3p4/3P4/2N5/PP2PPPP/R1BQKBNR b KQkq - 1 4|0.09</span></pre><p id="75f3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们有了数据，让我们开始训练吧！</p><h1 id="4f52" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">培养</h1><p id="0567" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">对于这个项目，让我们使用<a class="ae kv" href="https://www.pytorchlightning.ai" rel="noopener ugc nofollow" target="_blank"> Pytorch Lightning </a>，它是Pytorch上面的一个便利层。为了训练，我们必须首先实现两个类:Dataset和LightningModule。由于数据集的规模很大(数据库最终有37毫米的位置)，IterableDataset最有意义，它将数据视为无限流。__next__方法只需要返回随机的一行数据。因为我们不担心在数千万个位置上过度拟合，所以我们不需要将数据分成训练集、验证集和测试集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/9a6a311cdf6a0ec9c52a86b93cf31288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38UpR5OMoA37Fj1nBrJqIQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Pytorch数据集的实现，使用<a class="ae kv" href="https://carbon.now.sh" rel="noopener ugc nofollow" target="_blank"> https://carbon.now.sh </a>创建</p></figure><p id="a26f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">EvaluationDataset从SQLite表中随机提取一行，并通过提取原始字节中的二进制值对其进行预处理，使用numpy的frombuffer和unpackbits函数将这些字节转换为浮点型，并形成所需的808长度的浮点型数组作为输入。评估值is被提取并限制在-15和15之间。边界保护防止极端赢的位置支配损失函数(例如+45白)。+-15是非常肯定的胜利，每一方，并评估过去，这是不必要的，我们的目的，将减缓训练收敛。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/13c3d20dd5427aa60a242575b575697e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JkuVtnfc-Bo7aBx-FUmaFw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Pytorch模型的实现，用<a class="ae kv" href="https://carbon.now.sh" rel="noopener ugc nofollow" target="_blank"> https://carbon.now.sh </a>创建</p></figure><p id="ba0b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">该模型由808个神经元的N层(初始设置为4)组成，直到直接输出评估的1个神经元的最终输出层。使用L1损失，或标签和预测之间的绝对平均差异，因为输出是直观的。例如，如果L1损失是2.0，那么平均而言，该模型与stockfish的评估相差2个卒。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/4f065dc2d1a02f59eec3f786ee503389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AP_9UQbw_JDPeS3F7j2ZGQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Tensorboard的训练损失，图片由作者提供</p></figure><p id="a78f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">成功了，失败了！最终我们的模型的两个版本被训练。四层的一个达到1.29的损耗，六层的一个达到1.06的损耗。</p><h1 id="8020" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">测试</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/ccd65ba0dd28669702bb9e64a9b744e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s5sF2GBFNQu5LRAP"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">JESHOOTS.COM在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kv" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">的照片</a></p></figure><p id="e862" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">测试我们AI最好的方法就是玩！使用阿尔法贝塔搜索，换位表，和一些其他标准的国际象棋人工智能技术，我们可以创建一个完整的国际象棋引擎来对抗。AI客户端在Go ( <a class="ae kv" href="https://github.com/notnil/chess" rel="noopener ugc nofollow" target="_blank">中实现，所以我可以使用我的象棋库</a>)，模型托管在一个基于python的gRPC服务器上，该服务器为我家里的Nvidia 2080加速linux服务器上的模型提供服务。</p><p id="3b21" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">基于围棋的象棋引擎少于300 LOC，这里是主要走法的代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/869f3ad40697e66449cd59608f8f33b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qy-UHJVGZOGfxZHKY1A3kw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Go客户端的实现</p></figure><p id="0214" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是服务于该模型的pthon gRPC服务器实现。它接受成批的编码位置并返回评估结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/b6c80a963ff4e70ea9827d41ee87b50f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kp2Of5kNJ-P27h_xlgtoOw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Python服务器的实现</p></figure><p id="a970" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，我们已经连接了我们的机器人和我们的模型服务板评估，我们已经准备好玩了！这个机器人的对手(我自己)在快速、闪电战和子弹上只有可怜的1200左右的平均等级。这些游戏没有时间限制。我花了我需要的时间，a I每一步花了大约20秒。在我与机器人的两场比赛中，我仁慈地给了自己白。</p><p id="92b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">不幸的是，Medium不允许嵌入，所以我在Lichess上放了一张整个游戏的Gif和一个完整游戏的链接，还有一个Stockfish分析。</p><h1 id="465b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第一场:洛根·斯皮尔斯(白)对切斯·博特·DNN-4层-损失-1.29(黑)</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/92e14604a3a548226d957cde51d2890b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*31IVFmDpQVULiEGdMah-gA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">洛根斯皮尔斯(白)诉国际象棋机器人DNN-4层-损失-1.29(黑)。画吧。完整游戏:<a class="ae kv" href="https://lichess.org/rh7jL6rL" rel="noopener ugc nofollow" target="_blank">https://lichess.org/rh7jL6rL</a></p></figure><div class="nh ni gp gr nj nk"><a href="https://lichess.org/rh7jL6rL" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">通信国际象棋*洛根斯皮尔斯vs国际象棋机器人DNN-4层-损失-1.29</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">洛根斯皮尔斯在一个休闲的国际象棋进口游戏中玩国际象棋机器人DNN-4层-损失-1.29。经过45步棋后，游戏是平局…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">lichess.org</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny kp nk"/></div></div></a></div><p id="8aa0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我玩E4(我总是玩E4)，人工智能选择了被称为“西西里防御”的C5。黑棋的第一步很吸引人，因为人工智能没有打开的书，也没有玩游戏的经验，却为黑棋选择了一个最受欢迎的防御。开局相当平衡，没有一方获得明显的优势，直到我用我的黑暗广场主教换了移动中的黑骑士。事后看来，这揭开了布莱克的黑暗广场主教，暴露了B2广场上的弱点。然后我在移动<a class="ae kv" href="https://lichess.org/rh7jL6rL#25" rel="noopener ugc nofollow" target="_blank"> 13 </a>时与另一个骑士交易的主教复合了这个错误，他掉了一个兵，让黑方女王的攻击线通过。我蹲下身子，尽我最大的努力防守，通过移动<a class="ae kv" href="https://lichess.org/rh7jL6rL#49" rel="noopener ugc nofollow" target="_blank"> 25 </a>让比赛接近平手。由于忽略了拿走我的兵，黑棋低估了E8的潜在升级，并在移动<a class="ae kv" href="https://lichess.org/rh7jL6rL#52" rel="noopener ugc nofollow" target="_blank"> 26 </a>时犯了个错误，让骑士去B3，他认为如果骑士拿走了我可以强迫车交易，主教不能保护A的兵不被升级。不幸的是，我也没有看到这一点，我让我暂时的优势溜走了。游戏以一系列平淡无奇的举动结束，我同意和棋(斯托克菲什同意双方势均力敌)。</p><h1 id="84ec" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第二场:洛根·斯皮尔斯(白)对切斯·博特·DNN-6层-损失-1.06(黑)</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/1dd4d8bab7081ad1557ef3bf89757006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mF-yDCIUUhwWvxN7EkF7zg.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">洛根斯皮尔斯(白)诉国际象棋机器人DNN-6层-损失-1.06(黑)。黑棋赢了。完整游戏:<a class="ae kv" href="https://lichess.org/K5OEAa3w" rel="noopener ugc nofollow" target="_blank">https://lichess.org/rh7jL6rL</a></p></figure><div class="nh ni gp gr nj nk"><a href="https://lichess.org/K5OEAa3w" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">通信国际象棋*洛根斯皮尔斯vs国际象棋机器人DNN-6层-损失-1.06</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">洛根斯皮尔斯发挥国际象棋机器人DNN-6层-损失-1.06在一个休闲进口的国际象棋游戏。洛根·斯皮尔斯在48年后辞职…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">lichess.org</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny kp nk"/></div></div></a></div><p id="63de" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以法国开局，黑棋允许我通过移动<a class="ae kv" href="https://lichess.org/K5OEAa3w#15" rel="noopener ugc nofollow" target="_blank"> 8 </a>占据中心位置，导致白棋的stockfish评估为+1.1。有趣的是Stockfish想让我站在城堡女王一边，把我的优势推到中间。我有一个王侧易位的习惯，以更安全的方式玩，以避免不熟悉的游戏。在移动中<a class="ae kv" href="https://lichess.org/K5OEAa3w#22" rel="noopener ugc nofollow" target="_blank"> 11 </a>，黑棋提供了一个女王交易，我接受了这个交易，把女王从棋盘上拿走，减少了可能有利于人工智能的战术机会。我做得很好，直到我在移动<a class="ae kv" href="https://lichess.org/K5OEAa3w#31" rel="noopener ugc nofollow" target="_blank"> 16 </a>时出错。我看不出黑棋可以用它的方形象串我的车并赢得交换。由于移动中的兵推<a class="ae kv" href="https://lichess.org/K5OEAa3w#63" rel="noopener ugc nofollow" target="_blank"> 32 </a>没有导致获胜的机会(即使平衡了车)，黑棋逐渐吃掉我的兵，迫使我放弃。</p><p id="9867" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">虽然人工智能赢了，但我不知道是计算机变得更好了，还是我的失误让比较变得不公平。解决这个问题的最公平的方法是让人工智能版本互相比赛。</p><h1 id="fe11" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第三场:切斯博特DNN-6层-损失-1.06(白)对切斯博特DNN-4层-损失-1.29(黑)</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/2f5813336cc032016b3364e65aa024cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qXJVDEYb98ZYIFHYqwjIXw.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">象棋机器人DNN-6层-损失-1.06(白)对象棋机器人DNN-4层-损失-1.29(黑)。白棋赢了。完整游戏:<a class="ae kv" href="https://lichess.org/es0pajXC" rel="noopener ugc nofollow" target="_blank">https://lichess.org/es0pajXC</a></p></figure><div class="nh ni gp gr nj nk"><a href="https://lichess.org/es0pajXC" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">对应象棋*象棋机器人DNN-6层-损失-1.06 vs象棋机器人DNN-4层-损失-1.29</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">国际象棋机器人DNN-6层-损失-1.06发挥国际象棋机器人DNN-4层-损失-1.29在一个休闲进口游戏的国际象棋。象棋机器人…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">lichess.org</p></div></div><div class="nt l"><div class="oa l nv nw nx nt ny kp nk"/></div></div></a></div><p id="36e4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">最初我给了4层人工智能白色，但它以一个平淡无奇的画结束，所以我尊重颜色的分配。第二场比赛导致了一场令人难以置信的精彩比赛。快节奏的行动开始于第12步,主教拿走了G7的兵，并分别叉走了H6和H8的骑士和车。黑棋回应了一个狂野的牺牲，使用了黑方主教，然后是女王检定。白棋冷静地偏转，最终拿到了悬车。在移动中<a class="ae kv" href="https://lichess.org/es0pajXC#32" rel="noopener ugc nofollow" target="_blank"> 16 </a>黑棋牺牲了另一个棋子，这次是一个骑士，为了保住对白棋国王的攻击。在防守并掷出自己的皇后检查牌后，白棋自信地检查了黑王的移动<a class="ae kv" href="https://lichess.org/es0pajXC#43" rel="noopener ugc nofollow" target="_blank"> 22 </a>。这是非常危险的，因为如果给黑棋自由移动的话，它可以一步就将死！怀特发现了原力交配序列，在一场令人兴奋的将死中获胜，并证明了其较低的训练损失会导致更好的象棋。</p><h1 id="4e2d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">分析</h1><p id="1c65" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">分析这些游戏最显著的方面是人工智能感觉有多“像人”。常见的开局，等待失误，以及用疯狂的牺牲来试图卷土重来是在线人类游戏中的标准公平。</p><p id="4961" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们的方法当然有改进的余地。许多众所周知的技术没有被使用，以保持这个项目的复杂性易于管理，并专注于人工智能部分:</p><ul class=""><li id="e039" class="ob oc iq lq b lr mk lu ml lx od mb oe mf of mj og oh oi oj bi translated">移动排序优先搜索“感兴趣的”移动序列</li><li id="f6a1" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Endgame_tablebase" rel="noopener ugc nofollow" target="_blank"> Endgame Tablebase </a>用于预先计算的获胜残局位置</li><li id="ae77" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Chess_opening_book" rel="noopener ugc nofollow" target="_blank">预计算开口的开口书</a></li><li id="1a95" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">只搜索4层<a class="ae kv" href="https://en.wikipedia.org/wiki/Ply_(game_theory)" rel="noopener ugc nofollow" target="_blank">的几十万个位置</a></li><li id="c685" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">许多其他人</li></ul><p id="0a98" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们过于简单的模型和训练程序也存在一些缺陷</p><ul class=""><li id="7355" class="ob oc iq lq b lr mk lu ml lx od mb oe mf of mj og oh oi oj bi translated">移动计数以位的形式输入到模型中，而不是以浮点数的形式输入</li><li id="6271" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">模型架构是第一个没有优化的设计</li><li id="0307" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">学习率和批量大小调度器可以导致较低的总损失</li><li id="457a" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">象棋位置在数据库中是唯一的，因此更可能是唯一的较后位置在数据集中被过度表示</li><li id="59bd" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">大多数游戏都是业余玩家玩的，高级游戏的搜索空间可能没有得到充分的体现</li><li id="4949" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">该模型可以被训练更长时间</li></ul><p id="d5bb" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">总的来说，这很有趣！对现有发动机评估的监督训练是一种比自玩和蒙特卡罗树搜索(a la AlphaZero)更快和更经济的权重初始化方法，并且一个可玩的模型可以在几个GPU小时内生成。希望你喜欢这篇文章，我期待在评论中看到你的AI游戏的链接！</p></div></div>    
</body>
</html>