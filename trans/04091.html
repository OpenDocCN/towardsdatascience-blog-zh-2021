<html>
<head>
<title>5 Minute Guide to Pandas GroupBy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫小组5分钟指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-minute-guide-to-pandas-groupby-929d1a9b7c65?source=collection_archive---------31-----------------------#2021-04-06">https://towardsdatascience.com/5-minute-guide-to-pandas-groupby-929d1a9b7c65?source=collection_archive---------31-----------------------#2021-04-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="1b2a" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用这个有用的工具开始数据分析</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/824c682b92df21b34769ed7d7c44a26d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6WFRmNnk8GW52RBLjIg-g.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@camylla93?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Camylla Battani </a>在<a class="ae kz" href="https://unsplash.com/s/photos/questions?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="e1ef" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">数据分析从根本上讲就是用数据寻找问题的答案。当我们对一组数据执行一些计算或统计时，通常在整个数据集上这样做是不够的。相反，我们通常希望将数据分组，进行计算，然后比较不同组的结果。</p><blockquote class="lw"><p id="f4b1" class="lx ly iu bd lz ma mb mc md me mf lv dk translated">数据分析从根本上讲就是用数据寻找问题的答案。</p></blockquote><p id="ef2e" class="pw-post-body-paragraph la lb iu lc b ld mg jv lf lg mh jy li lj mi ll lm ln mj lp lq lr mk lt lu lv in bi translated">假设我们是一个数字营销团队，正在调查最近转化率下降背后的潜在原因。随着时间的推移，将转换率作为一个整体来看不太可能导致我们找到可能的原因。相反，我们希望比较不同营销流、活动、品牌和时间段的转化率，以确定指标的差异。</p><p id="d0e0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Pandas是非常受欢迎的python数据分析库，它有一个<a class="ae kz" href="https://pandas.pydata.org/docs/user_guide/groupby.html" rel="noopener ugc nofollow" target="_blank"> GroupBy </a>函数，提供了一种高效的方法来执行这种数据分析。在下一篇文章中，我将通过代码示例简要介绍GroupBy函数，以了解该工具的核心特性。</p></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="e65f" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">数据</h1><p id="fcc3" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">在本教程中，我将使用openml.org网站上的一个名为“credit-g”的数据集。该数据集由许多提出贷款申请的客户的特征和一个表示贷款是否已偿还的目标变量组成。</p><p id="e569" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">数据可以在这里<a class="ae kz" href="https://www.openml.org/d/31" rel="noopener ugc nofollow" target="_blank">下载</a>，或者使用Scikit-learn API导入，如下所示。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="cb64" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">基本用法</h1><p id="a9a1" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">该函数最基本的用法是简单地将<code class="fe nr ns nt nu b">GroupBy</code>添加到整个数据帧中，并指定我们想要进行的计算。这将生成按您选择的段分组的所有数字变量的汇总。这是快速获取整个数据集摘要的有用方法。</p><p id="9f66" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在下面的代码中，我按照作业类型对所有东西进行了分组，并计算了所有数值变量的平均值。输出显示在代码下方。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nv"><img src="../Images/65549e5947fc3dee555d852889c131dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDYwExR1jzvdJAvK-45DDA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">汇总所有数值变量。图片作者。</p></figure><p id="2f2b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果我们想更具体一些，我们可以取数据帧的一个子集，只计算某些列的统计数据。在以下代码中，我只选择了credit_amount。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nw"><img src="../Images/82a7800ce0760f4290c4af8dd319cc9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*2bA155MNuaQaswRGdhyYsQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">按工作类型列出的贷方金额。图片作者。</p></figure><p id="5fb4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们也可以根据多个变量进行分组。在这里，我计算了平均信贷金额的工作和住房类型。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nx"><img src="../Images/4e0c6b650fada27862dda190605374b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8reCLwRTmx8oyj-9FJldcQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">按工作和住房状况列出的平均信贷额。图片作者。</p></figure></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="4450" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">多重聚合</h1><p id="8b6a" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">能够为变量计算多个聚合通常非常有用。<code class="fe nr ns nt nu b"><a class="ae kz" href="https://pandas.pydata.org/pandas-docs/version/0.23/generated/pandas.core.groupby.DataFrameGroupBy.agg.html" rel="noopener ugc nofollow" target="_blank">DataFrameGroupBy.<strong class="lc iv">agg</strong></a></code> <strong class="lc iv"> </strong>功能让这一切成为可能。</p><p id="4e49" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在下面的代码中，我计算了每个工作组的信用额度的最小值和最大值。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ny"><img src="../Images/20fe3bb1b3e5ba8566b8614bf5f3b136.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*Wr1YEi19apwhi1uSNVwe1w.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">按工作类型列出的最低和最高信用额。图片作者。</p></figure><p id="5951" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">也可以对不同的列使用不同的聚合。在这里，我计算了credit_amount的最小和最大金额，以及每种工作类型的平均年龄。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nz"><img src="../Images/6723fc4f114bb186fc0057ce7d24aecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJUDBumaI010uLTF9oGsWw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">按工作类型分列的最低和最高cedit金额和平均年龄。图片作者。</p></figure></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="4a19" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">命名聚合</h1><p id="78a5" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated"><code class="fe nr ns nt nu b"><a class="ae kz" href="https://pandas-docs.github.io/pandas-docs-travis/user_guide/groupby.html#groupby-aggregate-named" rel="noopener ugc nofollow" target="_blank">pd.NamedAgg</a></code>函数允许您为多个聚合提供名称，从而提供更清晰的输出。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/bcf95b1d56179a305e56d6d6f03fb196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xftnP1lN4ewx7Eknkbrgfw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">NamedAgg函数提供了更清晰的输出。图片作者。</p></figure></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="c9a2" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">自定义聚合</h1><p id="5103" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">还可以对groupby应用自定义函数来扩展可能的聚合。</p><p id="c527" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">例如，如果我们想计算每种工作类型的好贷款和坏贷款的百分比，我们可以使用下面的代码。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ob"><img src="../Images/55ad05802077a457ecab6b913bd731a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*SBwyLW_9jRXi5aS-CEFzDw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">按工作类型划分的好贷款和坏贷款的百分比。图片作者。</p></figure></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="c9ff" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">测绘</h1><p id="b5ac" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">我们可以将内置的pandas绘图功能添加到GroupBy中，以便更好地可视化趋势和模式。</p><p id="6cea" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我扩展了在上一节中创建的代码，创建了一个堆叠条形图，以更好地显示每种工作类型的好贷款和坏贷款的分布。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oc"><img src="../Images/1a46d0c004aac596258ececbeb7ff496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8kjxkji4cSswxJh0YRRTVQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用GroupBy生成堆积条形图。图片作者。</p></figure><p id="9415" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">除了使用GroupBy在同一个图表中创建比较之外，我们还可以在多个图表中创建比较。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="np nq l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj od"><img src="../Images/cd818d984e2123556cff5233132ecb25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gOCKymfiQrLsamARcYyuzg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">用一行代码生成多重图。图片作者。</p></figure></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><p id="3e46" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">pandas GroupBy函数是一个工具，作为一名数据科学家，我几乎每天都使用它来执行探索性数据分析。这篇文章是关于这个函数的基本用法的一个简短的教程，但是还有许多更强大的方法可以用来分析数据。</p><p id="0893" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">pandas文档包含了对GroupBy函数的所有可能特性和用法的更详细的描述。这可以在这个<a class="ae kz" href="https://pandas.pydata.org/docs/user_guide/groupby.html" rel="noopener ugc nofollow" target="_blank">环节</a>找到。</p><p id="b923" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本教程的完整笔记本和代码可以在这个<a class="ae kz" href="https://github.com/rebecca-vickery/machine-learning-tutorials/blob/master/data-analysis/pandas_grouby.ipynb" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到。更多有用的pandas方法、函数和技巧，请看我以前的文章。</p><div class="oe of gq gs og oh"><a rel="noopener follow" target="_blank" href="/10-things-you-didnt-know-about-pandas-d20f06d1bf6b"><div class="oi ab fp"><div class="oj ab ok cl cj ol"><h2 class="bd iv gz z fq om fs ft on fv fx it bi translated">关于熊猫你不知道的10件事</h2><div class="oo l"><h3 class="bd b gz z fq om fs ft on fv fx dk translated">直到现在…</h3></div><div class="op l"><p class="bd b dl z fq om fs ft on fv fx dk translated">towardsdatascience.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov kt oh"/></div></div></a></div><div class="oe of gq gs og oh"><a rel="noopener follow" target="_blank" href="/tips-and-tricks-for-fast-data-analysis-in-python-f108ad32fa90"><div class="oi ab fp"><div class="oj ab ok cl cj ol"><h2 class="bd iv gz z fq om fs ft on fv fx it bi translated">Python中快速数据分析的技巧和诀窍</h2><div class="oo l"><h3 class="bd b gz z fq om fs ft on fv fx dk translated">用python快速总结和描述数据集</h3></div><div class="op l"><p class="bd b dl z fq om fs ft on fv fx dk translated">towardsdatascience.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov kt oh"/></div></div></a></div><p id="7997" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢阅读！</p><p id="2bc0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://datacademy.eo.page/h7g4c" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv">我每月发一份简讯，如果你想加入请通过这个链接注册。期待成为您学习旅程的一部分</strong> </a></p></div></div>    
</body>
</html>