<html>
<head>
<title>Formulate the shape and number of parameters for a simple CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用公式表示简单CNN的形状和参数数量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/discuss-the-dog-image-classification-project-with-cnn-bc5c90ee4fec?source=collection_archive---------19-----------------------#2021-05-19">https://towardsdatascience.com/discuss-the-dog-image-classification-project-with-cnn-bc5c90ee4fec?source=collection_archive---------19-----------------------#2021-05-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="61d2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及CNN项目的其他挑战</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/16ac602a8fff5291bb96bfe6308ca136.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*bldwsBRYwYtjarkwApdI0w.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">维基上的照片由<a class="ae ku" href="https://commons.wikimedia.org/w/index.php?curid=45661858" rel="noopener ugc nofollow" target="_blank"> Aphex34 </a>拍摄</p></figure><p id="11db" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">今天我想展示一个例子，如何计算一个简单的卷积神经网络的形状和参数数量，还包括一些其他的经验。它以狗分类项目为例。这是入门级的，不精通技术，但欢迎您的专业意见，以帮助我更好地理解这个主题。</p><p id="c74b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们开始吧。</p><p id="afc0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">问题1:计算CNN模型的形状和参数个数</strong></p><p id="0fcf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">假设您了解CNN的架构。一个CNN模型有五个卷积层，包括池层，三个全连接层，1000个输出分类，如下图所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/d84f3bf37b6e62f20b12ddb059f7df85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dOxPvoJzJIaYBfZPt88eLQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片来自Udacity DL ND</p></figure><p id="6e8e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">请提醒:</p><blockquote class="lw lx ly"><p id="7754" class="kv kw lz kx b ky kz ju la lb lc jx ld ma lf lg lh mb lj lk ll mc ln lo lp lq im bi translated"><strong class="kx iu">我们需要为全连接层1的空间维度计算CNN模型的形状，并且我们*不需要计算*模型的参数数目来构造CNN模型，但是必须*知道*卷积层中的参数数目。</strong></p></blockquote><p id="6fe1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">CNN模型中的参数:</strong></p><p id="38bb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">假设<code class="fe md me mf mg b">__init__</code>函数中的卷积层使用以下格式:</p><pre class="kj kk kl km gt mh mg mi mj aw mk bi"><span id="0af0" class="ml mm it mg b gy mn mo l mp mq">self.conv = nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)<br/>self.pool = nn.MaxPool2d(kernel_size,stride)<br/>self.fc = nn.Linear(in_features, out_features)</span></pre><p id="e390" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">将使用的参数有:</p><ul class=""><li id="8100" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq mw mx my mz bi translated"><code class="fe md me mf mg b">in_channels</code> -输入的数量(深度)，例如RGB图像为3。</li><li id="5e97" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">out_channels</code> -输出通道的数量，即构成卷积层的过滤“图像”的数量，或者将应用于输入的唯一卷积核的数量。</li><li id="3beb" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">kernel_size</code> -指定(平方)卷积内核和池内核的高度和宽度的数字。</li><li id="94d2" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">in_features</code> -每个输入样本的大小</li><li id="6b7f" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">out_features</code> -每个输出样本的大小</li></ul><p id="dd41" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">除了全连接第1层的in_features(这是计算模型形状的目标)之外，所有参数都将给出(由您决定)。</strong></p><p id="e9f8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在让我们检查给定的CNN模型。它包含卷积层、批量标准化层、激活函数、池层和完全连接层。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="1906" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">计算卷积层的形状</strong></p><p id="a1ff" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">当我们说卷积层的形状时，它包括<strong class="kx iu">空间维度和层的深度</strong>。</p><p id="74c5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="lz">卷积层的</em> <strong class="kx iu"> <em class="lz">空间维度</em> </strong> <em class="lz"> (x，y)可以计算为:</em> <code class="fe md me mf mg b"><strong class="kx iu"><em class="lz">(W_in−F+2P)/S+1</em></strong><em class="lz"> .</em></code></p><p id="dc81" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="lz">卷积层的</em> <strong class="kx iu"> <em class="lz">深度</em> </strong> <em class="lz">将始终等于滤波器的数量</em> <code class="fe md me mf mg b"><em class="lz">K</em></code> <em class="lz">。</em></p><ul class=""><li id="afde" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq mw mx my mz bi translated"><code class="fe md me mf mg b">K</code> -卷积层中的滤波器数量</li><li id="0257" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">F</code> -卷积滤波器的高度和宽度</li><li id="3eaf" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">S</code>——回旋的大步</li><li id="747d" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">P</code> -填充</li><li id="991c" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">W_in</code> -前一层的宽度/高度(平方)</li></ul><p id="c297" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">同时:</p><ul class=""><li id="b747" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq mw mx my mz bi translated"><code class="fe md me mf mg b">K</code> = <code class="fe md me mf mg b">out_channels</code></li><li id="e4fb" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">F</code> = <code class="fe md me mf mg b">kernel_size</code></li><li id="a56a" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">S</code> = <code class="fe md me mf mg b">stride</code></li><li id="90c5" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">W_in</code>是<code class="fe md me mf mg b">input_shape</code>元组的第一个和第二个值(比如224*224，W_in=224)。</li></ul><p id="78b9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">代码给出的参数:</p><p id="7dfb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">input_shape</code>元组:224* <em class="lz"> 224* </em> 3(RGB)</p><p id="d4cf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">out_channels</code>从conv1，2，3是:32，64，128</p><p id="2471" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">kernel_size</code> =F : 3x3，</p><p id="0e16" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">padding</code> =1用于三个卷积层</p><p id="f90f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">stride</code>在conv1，2，3=1</p><p id="c4f9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">stride</code>在maxpool=2</p><p id="43d8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们来计算一下:</p><p id="090d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Conv1输入:W_in =224，F=3，P=1，S=1，in_channels=3，out_channels=32</p><p id="545c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Conv1输出:conv1输出的(x，y)大小:(224–3+2 x1)/1+1 = 224，depth_1=out_channels=32。</p><p id="8022" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">池化第1层输入:W_in=224，kernel_size=2，stride=2</p><p id="44cd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">池层1输出:<br/>最大池层后输出的x-y大小:224/2(kernel_size)=112</p><p id="9382" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Conv2输入:W_in=112，内核大小=3，in_channels=32，out_channels=64</p><p id="53e6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Conv2输出:conv2输出的x-y尺寸:(112–3+2 x1)/1+1 = 112，depth_2=64</p><p id="4b03" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">池化第2层输入:W_in=112，kernel_size=2，stride=2</p><p id="e510" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">第2层输出池:112/2=56</p><p id="92bd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Conv3输入:W_in=56，内核大小=3，in_channels=64，out_channels=128</p><p id="0dd2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Conv3输出:conv3输出的x-y尺寸:(56–3+2 x1)/1+1 = 56，depth3=128</p><p id="f6de" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">池化第3层输入:W_in=56，kernel_size=2，stride=2</p><p id="c2bb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">池化第3层输出:56/2=28</p><p id="9e97" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">来自池层3的输出大小:28*28*128=100352，将作为全连接层的输入。</strong></p><p id="04cb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">FC1:尺寸变为100352*1，输出2500*1</p><p id="f5e3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">FC2:尺寸从2500*1到500*1</p><p id="336f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">FC3:尺寸从500*1到133*1</p><p id="2a38" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在我们看看128*28*28是怎么来的。理论上，一旦我们得到了形状，模型的设计就完成了，但我们最好知道这个模型有多少参数，以便更清楚地了解这个过程。</p><p id="7156" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">计算卷积层中的参数数量</strong></p><p id="c073" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">卷积层中参数的数量取决于所提供的<code class="fe md me mf mg b">filters/out_channels</code>、<code class="fe md me mf mg b">kernel_size</code>和<code class="fe md me mf mg b">input_shape</code>的值。</p><ul class=""><li id="13bb" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq mw mx my mz bi translated"><code class="fe md me mf mg b">D_in</code> -前一层的深度</li><li id="db6d" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">F</code> -卷积滤波器的高度和宽度</li><li id="e9c1" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><code class="fe md me mf mg b">K</code> -卷积层中滤波器的数量</li></ul><p id="455b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">同时:</p><p id="55a9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">K</code> = <code class="fe md me mf mg b">out_channels</code></p><p id="b9a7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">F</code> = <code class="fe md me mf mg b">kernel_size</code></p><p id="05b9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><code class="fe md me mf mg b">D_in</code>是<code class="fe md me mf mg b">input_shape</code>元组中的最后一个值，通常为1或3(分别为RGB和灰度)。</p><p id="5544" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">计算过程为:</p><ul class=""><li id="843a" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq mw mx my mz bi translated">每个过滤器都有<code class="fe md me mf mg b">F*F*D_in</code>重量</li><li id="700f" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated">卷积层由<code class="fe md me mf mg b">K</code>滤波器组成</li><li id="9840" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated">卷积层中权重的总数是<code class="fe md me mf mg b">K*F*F*D_in</code></li><li id="8ce8" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated">每个滤波器有一个偏差项，卷积层有<code class="fe md me mf mg b">K</code>偏差</li><li id="94fc" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated"><em class="lz">卷积层中的</em> <strong class="kx iu"> <em class="lz">参数数量</em> </strong> <em class="lz">为</em> <code class="fe md me mf mg b"><strong class="kx iu"><em class="lz">K*F*F*D_in + K</em></strong></code></li></ul><p id="2d08" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对于每一层:</p><p id="ee19" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">输入层:</strong>输入层所做的就是读取输入图像，所以这里没有你可以学习的参数。</p><p id="abdd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">池层</strong>:该层没有需要学习的参数。</p><p id="8a3f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">卷积层:</strong></p><p id="ad82" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> conv1 </strong>:每个滤波器有3*3*3个权重，该层由32个滤波器组成，该层的权重数为3*3*3*32，加上32个偏差，该层的参数数为3*3*3*32+32=896</p><p id="c1b4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> conv2 </strong> : k=64，F=3，D_in=32，参数个数= 64*3*3*32+64=18496</p><p id="0ff9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> conv3 </strong> : k=128，F=3，D_in=64，参数个数=128*3*3*64+128=73856</p><p id="5033" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> FC1 </strong>:在全连接层中，所有输入单元对每个输出单元都有单独的权重。对于100352个输入和2500个输出，权重数为100352*2500=250880000。此外，该层对于每个输出节点都有一个偏差，因此有(100352+1)*2500=250882500个参数。</p><p id="1f34" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">FC2</strong>:(2500+1)* 500 = 1250500</p><p id="7514" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> FC3 </strong> : (500+1)*133=66633</p><p id="0339" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在我们看看有多少参数将被模拟。</p><p id="9cd3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">附加信息:</p><ul class=""><li id="296a" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq mw mx my mz bi translated">添加BatchNorm2d层有助于通过最小化内部协变量偏移来提高测试精度。</li><li id="e8ec" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq mw mx my mz bi translated">“放弃”设置为0.2，以消除过度拟合效果。</li></ul><p id="4aa4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我知道这个过程很长，可能会很无聊:-)，但这是基本的，如果一旦理解了这个案例，对理解类似的案例会有很大的帮助。</p><p id="010e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">问题2:自己验证空间维度公式</strong><code class="fe md me mf mg b"><strong class="kx iu"><em class="lz">(W_in−F+2P)/S+1 </em></strong></code><strong class="kx iu"/></p><p id="23b7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如何验证空间维度公式？可以参考<a class="ae ku" href="https://cs231n.github.io/convolutional-networks" rel="noopener ugc nofollow" target="_blank">cs 231n课程链接</a>查看理论。但对我来说，一个例子会帮助我牢牢记住它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi nh"><img src="../Images/11f415913534fdd730db66c92e2edf48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OZ5cIoQzbmqp3dhy3Q_vw.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">来源:图片由作者提供</p></figure><p id="1d8a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">情况1: padding =0，stride=0，输入:6x6，滤波器:3x3，输出(x，y)大小怎么样？(6–3)/1+1=4</p><p id="a165" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">情况二:填充=1，步幅=0，输入:6x6，滤波器:3x3，输出(x，y)大小怎么样？(6–3+2)/1+1=6</p><p id="653c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">没有公式，你有什么答案？以及你的答案是否符合公式(W_in-F+2p)/S+1的结果？</p><p id="7304" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们可以看到，填充保持了目标与输入具有相同的大小，这将减少信息损失。</p><p id="658a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">问题3:图像转换器的一些隐含知识和规则</strong></p><p id="5db6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">一些隐性知识</strong>更好地了解:</p><p id="2a18" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> OpenCV </strong>的检测器需要输入的图像是灰度的，但对大小没有要求。</p><p id="38e7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">VGG16、VGG19和ResNet接受224x224的图像大小，而Inception V3和Xception接受299×299的图像大小。</p><p id="25f9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">使用ImageNet中的图像创建CNN </strong>事实上，您可以选择自己的图像大小，不同于VGG16: 240x240或256x256，但您必须确定大小，因为ImageNet中的图像大小是多种多样的。</p><p id="da53" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">图像数据集</strong></p><p id="df07" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">CIFAR-10:包含10个固定大小的类图像:32x32x3，有60000个图像，每个类包括6000个。这十类是飞机、汽车、鸟、猫、鹿、狗、青蛙、马、船和卡车。</p><p id="8d37" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">MNIST:包含60，000个28×28像素的灰度图像，手写的位数在0到9之间。</p><p id="9ac6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ImageNet:ImageNet中的图像有各种尺寸，如224×224、227×227、256×256和299×299等。</p><p id="4aba" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">一些规则:</strong></p><p id="0f42" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">图像预处理我没有找到确切的规则，只有一些零散的规则。有欢迎分享。下面的规则是我从<a class="ae ku" href="https://stackoverflow.com/questions/61637447/validation-set-augmentations-pytorch-example/61637688#61637688" rel="noopener ugc nofollow" target="_blank">这个StackOverflow线程</a>中搜索到的，很有帮助:</p><ol class=""><li id="4c31" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq ni mx my mz bi translated"><em class="lz"> " </em>随机数据扩充只允许在训练集上进行，您可以将数据扩充应用于验证集和测试集，前提是这些扩充都不是随机的"。</li><li id="9599" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq ni mx my mz bi translated">“当您在验证和测试集上使用规范化时，您<em class="lz">必须</em>使用与您在训练集上使用的完全相同的因子。”</li><li id="138f" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq ni mx my mz bi translated">需要调整大小然后居中裁剪是因为val集需要来自训练集的同一域，因此，如果前者被随机调整大小并裁剪为224，则val集需要确定性地调整大小和裁剪。</li></ol><p id="ae90" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在今天的故事中，我将重点讨论计算一个简单CNN模型的形状和参数数量，并包括一些其他挑战。</p><p id="17d8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">感谢您的阅读。</p><p id="54a0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">参考资料:</p><ol class=""><li id="63e3" class="mr ms it kx b ky kz lb lc le mt li mu lm mv lq ni mx my mz bi translated">【https://pytorch.org/docs/stable T4】</li><li id="5d58" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq ni mx my mz bi translated">Udacity深度学习纳米学位</li><li id="2ea8" class="mr ms it kx b ky na lb nb le nc li nd lm ne lq ni mx my mz bi translated"><a class="ae ku" href="https://cs231n.github.io/convolutional-networks/" rel="noopener ugc nofollow" target="_blank">https://cs231n.github.io/convolutional-networks</a></li></ol></div></div>    
</body>
</html>