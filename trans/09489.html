<html>
<head>
<title>How to Extract PDF data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中提取PDF数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-extract-pdf-data-in-python-876e3d0c288?source=collection_archive---------4-----------------------#2021-09-03">https://towardsdatascience.com/how-to-extract-pdf-data-in-python-876e3d0c288?source=collection_archive---------4-----------------------#2021-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="49db" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Adobe在没有订阅的情况下很难做到这一点，但这应该会有所帮助</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e66f92bc2783e95ad5b2d804db293d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXlolybuP5JSKFkiZNztMg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/s/photos/lock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@imattsmart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> iMattSmart </a>拍摄的照片</p></figure><p id="b348" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于某种原因，pdf仍然在行业中一直使用，它们真的很烦人。尤其是当你没有为某些订阅付费来帮助你管理它们的时候。这篇文章是为那些处于那种情况的人写的，<em class="lv">那些需要免费从pdf获取文本数据的人。</em></p><p id="ba8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，如果你想分析手写文本，这篇文章是错误的——但它很快就会出现。</p><p id="d84a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该过程包括将PDF转换为。然后通过正则表达式和其他简单的方法提取数据。</p><p id="c6cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你没有读过我的文章<a class="ae ky" rel="noopener" target="_blank" href="/how-to-easily-automate-your-keyboard-to-do-tasks-in-python-b698e98a5c40">关于自动化你的键盘将pdf转换成。txt群发，那么我建议你先这样做。这会节省你很多时间。如果你不想点击离开，那么这里的所有代码做到这一点。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lw lx l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者写的代码——可以在这里下载:<a class="ae ky" href="https://gist.github.com/jasher4994" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/jasher4994</a></p></figure><h1 id="a6b9" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">转换为。txt然后从字里行间读出</h1><p id="c97b" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">既然你已经皈依了。txt文件，你所要做的就是写一些代码，找出你想要的答案。</p><p id="cf87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当翻译成。txt文件，输出可能会有点滑稽。有时问题周围的文本可以在响应框的上方，有时可以在下方。我不确定这是否有技术上的原因，或者只是为了让做这样的事情更加困难。</p><p id="1d84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">诀窍是在文本中寻找常量，并隔离它们。</strong></p><p id="081b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不管怎样，都有解决的办法。我们只想要答案，并不关心它们周围的文字。幸运的是当转换成。txt文件，我们所有的所有输入部分都在新的一行开始。正如我们所知，如果我们试图提取的所有事物都有一个不变的因素，那么我们的生活就会轻松很多。</p><p id="b3bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们可以读取我们的。用open()和read()将txt文件转换成Python，然后对它使用splitlines()。这将提供一个字符串列表，每当原始字符串中出现一个换行符(\n)时，就会开始一个新的实例。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="ea2b" class="na lz it mw b gy nb nc l nd ne">import os<br/>os.chdir(r"path/to/your/file/here")<br/>f = open(r"filename.txt", "r")<br/>f = f.read()<br/>sentences = f.splitlines()</span></pre><p id="8614" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如承诺的那样，这会给你一个字符串列表。</p><p id="6ceb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如前所述，这里我们只对用户输入感兴趣。幸运的是，还有另一个决定性因素可以帮助我们隔离输入。所有的输入，以及从新的一行开始，都以一对括号开始。这些括号内的内容定义了输入的类型。例如，文本部分应该是</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="efa1" class="na lz it mw b gy nb nc l nd ne">(text)James Asher</span></pre><p id="9613" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个复选框是</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="31d8" class="na lz it mw b gy nb nc l nd ne">(checkbox)unchecked</span></pre><p id="b05e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他例子包括“单选按钮”和“组合按钮”，大多数PDF输入都是这四种类型。</p><p id="837d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，偶尔会有随机的以括号开头的部分或句子，所以您可以使用set(sentences)来仔细检查。在我的例子中，只有5个不同类型的问题，我想包括在内，所以使用下面的列表理解来删除所有其他内容。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="8992" class="na lz it mw b gy nb nc l nd ne">questions = ["(text", "(button", "(:", "(combobox", "(radiobutton" ]</span><span id="0538" class="na lz it mw b gy nf nc l nd ne">sentences= [x for x in sentences if x.startswith(tuple(questions))]</span></pre><p id="d246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您将拥有一份针对您的问题的所有输入/答案的列表。只要你使用相同的PDF，这个列表的结构将保持不变。</p><p id="5d17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以简单地把它转换成熊猫的数据帧，做一些处理，然后输出成我们想要的任何格式。</p><p id="fbb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">不全是。txt文件像这样从pdf中输出，但大多数都是这样。如果您的没有，那么您必须使用regex并在您的特定文档中查找常量。但是一旦你编写了从一个文档中提取它的代码，只要它们是同类的，它对你所有的文档都是一样的。</em></p><h1 id="8030" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">从字符串列表中提取数据</h1><p id="7854" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">提取文本很容易。在这种情况下，我需要做的就是删除前面的括号。这可以通过列表理解和一些正则表达式轻松完成。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="90b5" class="na lz it mw b gy nb nc l nd ne">list_strings = [re.sub(r"\([^()]*\)", "", x) for x in list_strings]<br/>df = pd.DataFrame(list_strings)<br/>df.to_excel("output.xlsx")</span></pre><p id="d4d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/da0a2dfd5f8df3f4c1bd1ca27267b068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHC3aLIyZl9E3lOGtCrecw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用Python提取PDF数据的输出</p></figure><p id="41b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以简单地在所有。txt文件并与熊猫合并在一起。然后，您可以根据需要旋转或清洁。</p><p id="43c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您现在有了一个可用的excel(或CSV)文件，它存储了所有pdf中的所有数据。几乎所有这些代码都是可重用的，您只需确保如果您尝试使用新的一批不同的pdf，它们会在转换为时转换为类似的布局。txt文件。</p><p id="67c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这有所帮助。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="cbb4" class="na lz it mw b gy nb nc l nd ne">If I’ve inspired you to join medium I would be really grateful if you did it through this <a class="ae ky" href="https://jamesasher4994.medium.com/membership" rel="noopener">link</a> — it will help to support me to write better content in the future.</span><span id="c588" class="na lz it mw b gy nf nc l nd ne">If you want to learn more about data science, become a certified data scientist, or land a job in data science, then checkout <a class="ae ky" href="https://365datascience.pxf.io/c/3458822/791349/11148" rel="noopener ugc nofollow" target="_blank">365 data science</a> through my <a class="ae ky" href="https://365datascience.pxf.io/c/3458822/791349/11148" rel="noopener ugc nofollow" target="_blank">affiliate link.</a></span></pre></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="2309" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，请看看我的其他文章。</p><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/how-to-easily-run-python-scripts-on-website-inputs-d5167bd4eb4b"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">如何在网站输入上轻松运行Python脚本</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">这是我建立的一个网站的演示，它将动态分析文本情感</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/how-to-easily-show-your-matplotlib-plots-and-pandas-dataframes-dynamically-on-your-website-a9613eff7ae3"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">如何轻松地在你的网站上动态显示你的Matplotlib图和Pandas数据框。</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">这是一种令人惊讶的简单方法，可以在线向全世界展示您的图表和数据框架，而且不到…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="og l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/how-to-easily-automate-your-keyboard-to-do-tasks-in-python-b698e98a5c40"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">如何轻松地自动化您的键盘来完成Python中的任务</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">永远告别单调的任务</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="oh l oc od oe oa of ks nr"/></div></div></a></div><p id="4ffd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">干杯，</p><p id="c1c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">詹姆斯</p></div></div>    
</body>
</html>