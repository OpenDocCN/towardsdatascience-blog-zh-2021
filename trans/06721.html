<html>
<head>
<title>7 Common File System Operations You Can Do With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python可以完成的7种常见文件系统操作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/7-common-file-system-operations-you-can-do-with-python-e4670c0d92f2?source=collection_archive---------9-----------------------#2021-06-17">https://towardsdatascience.com/7-common-file-system-operations-you-can-do-with-python-e4670c0d92f2?source=collection_archive---------9-----------------------#2021-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c7f0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用OS和Pathlib模块来自动化Python的任务。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3e32ddeae5dc13315fd43a875530462a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sh9a5u5gJ-ErgXo7nQtg7w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(Canva上制作)</p></figure><p id="856f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在不安装任何第三方库的情况下，您可以在Python中做的最酷的事情之一是执行文件系统操作，例如创建文件夹、重命名文件和处理目录。尽管这些任务可以很容易地手动完成，但是您可以使用Python代码来自动化它们，以节省一些时间。</p><p id="d3aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将看到在Python中使用os和Pathlib模块可以完成的7种文件系统操作。每个操作包括实际的例子，所以你可以理解这两个模块之间的区别。</p><h1 id="abf8" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">1.获取当前工作目录</h1><p id="94ae" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在Python脚本中处理路径时，了解当前工作目录是最基本的。有两种路径—相对路径和绝对路径。绝对路径是指文件系统中相对于根目录(/)的相同位置，而相对路径是指文件系统中相对于当前工作目录的特定位置。</p><p id="b95c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相对路径为你的脚本提供了灵活性，这就是为什么它有时比绝对路径更受欢迎。我们可以使用当前的工作目录来创建一个相对路径。</p><p id="1fc7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个操作以及本文中列出的所有文件系统操作，我们必须导入操作系统和路径。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="c242" class="mw lv it ms b gy mx my l mz na">import os</span><span id="f826" class="mw lv it ms b gy nb my l mz na">In [1]: os.getcwd()<br/>Out [1]: /Users/frank/PycharmProjects/DataScience</span></pre><p id="c5eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从上面的代码可以看出，我得到了包含我的数据科学项目的所有脚本的目录。这是我在Pycharm的工作目录。我们可以用Pathlib库获得相同的目录</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="3222" class="mw lv it ms b gy mx my l mz na">from pathlib import Path<br/><br/>In [1]: Path.cwd()<br/>Out [1]: /Users/frank/PycharmProjects/DataScience</span></pre><p id="16b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们打印<code class="fe nc nd ne ms b">type(os.getcwd())</code>或<code class="fe nc nd ne ms b">type(Path.cwd()</code>，我们可以看到os和Pathlib模块之间的主要区别。第一个只返回一个<code class="fe nc nd ne ms b">string</code>，而第二个返回一个<code class="fe nc nd ne ms b">PosixPath</code>对象，可以帮助我们做额外的操作。</p><h1 id="c936" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">2.列出目录内容</h1><p id="486c" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">除了显示当前的工作目录，我们还可以列出目录中的所有文件。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="cf43" class="mw lv it ms b gy mx my l mz na">In [1]: os.listdir()<br/>Out [1]: ['script1.py', 'script2.py', 'script3.py']</span></pre><p id="7975" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就我而言，我的“数据科学”文件夹中只有3个Python脚本。我们可以用<code class="fe nc nd ne ms b">Path().iterdir()</code>得到同样的结果，但是我们会得到一个<code class="fe nc nd ne ms b">generator object</code>。为了从这个生成器中获得一个列表目录内容，我们使用了如下面的代码所示的<code class="fe nc nd ne ms b">list()</code>。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="c680" class="mw lv it ms b gy mx my l mz na">In [1]: list(Path().iterdir())<br/>Out [1]: [PosixPath('script1.py'), PosixPath('script2.py'), PosixPath('script3.py')]</span></pre><p id="5914" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们甚至可以看到特定文件夹中的内容。例如，我的“数据科学”文件夹中有一个名为“数据集”的文件夹我们可以用下面的代码列出“Dataset”文件夹中的目录内容。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="aafa" class="mw lv it ms b gy mx my l mz na"># os<br/>os.listdir('Dataset')</span><span id="dbf0" class="mw lv it ms b gy nb my l mz na"># pathlib<br/>list(Path('Dataset').iterdir())</span></pre><h1 id="0e6d" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">3.连接路径</h1><p id="57c4" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在Python中连接字符串就像在两个单词之间使用“+”号一样简单；然而，当涉及到连接路径时，事情变得有点棘手。这是因为Mac OS在目录名中使用正斜杠“/”，而Windows使用反斜杠“\”，所以如果您希望Python代码能够跨平台运行，您需要一种不同的方法。幸运的是，os和Pathlib模块可以解决这个问题。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="aa53" class="mw lv it ms b gy mx my l mz na"># os<br/>os.path.join(os.getcwd(), 'Dataset')</span><span id="3d27" class="mw lv it ms b gy nb my l mz na"># pathlib<br/>from pathlib import Path, PurePath<br/>PurePath.joinpath(Path.cwd(), 'Dataset')</span></pre><p id="e7da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们打印上面写的代码，我们将得到一个包含工作目录和“数据集”的路径路径将看起来像这样<code class="fe nc nd ne ms b">/Users/frank/PycharmProjects/DataScience/Dataset</code>。OS库创建一个字符串，而Pathlib创建一个PosixPath类。但是，我们还没有创建“数据集”文件夹。要创建目录，请检查下一个文件系统操作。</p><h1 id="73b5" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">4.创建目录</h1><p id="339b" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">虽然您可以在几秒钟内创建一个目录，但当涉及到任务自动化时，编写一些Python代码将是最佳解决方案。我们可以用这两个库来执行这个任务，只是略有不同。让我们创建一个“数据集”文件夹作为示例。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="aa05" class="mw lv it ms b gy mx my l mz na"># os<br/>os.mkdir('Dataset')</span><span id="3b84" class="mw lv it ms b gy nb my l mz na"># pathlib<br/>Path('Dataset').mkdir()</span></pre><p id="4529" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果“数据集”文件夹不存在，将创建该文件夹。然而，如果我们试图创建一个已经存在的目录，Python会抛出一个错误。也就是说，如果我已经有了一个名为Dataset的文件夹，脚本将会中断。幸运的是，我们可以用Pathlib轻松控制这种行为。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="a639" class="mw lv it ms b gy mx my l mz na">Path('Dataset').mkdir(exist_ok=True)</span></pre><p id="0470" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过添加<code class="fe nc nd ne ms b">exist_ok</code>参数，我们可以忽略错误，以防目录已经存在。</p><h1 id="15d8" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">5.重命名文件名</h1><p id="f008" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">与创建目录类似，重命名文件名是一项我们可以用Python脚本自动完成的任务。使用操作系统库，我们可以通过引入字符串名称来重命名文件。例如，让我们将“数据集”文件夹重命名为“数据”</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="9c36" class="mw lv it ms b gy mx my l mz na">os.rename('Dataset', 'Data')</span></pre><p id="bf75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们也可以用Pathlib来完成这个任务。在这种情况下，目标名称可以是字符串或另一个path对象。让我们将文件夹重命名为“数据集”</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="181a" class="mw lv it ms b gy mx my l mz na">current_path = Path('Data')<br/>target_path = Path('Dataset')<br/>Path.rename(current_path, target_path)</span></pre><p id="ee36" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您甚至可以使用for循环重命名具有特定扩展名的多个文件。比如，我要在每个前面加上2021年。csv文件在我的工作目录。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="b8be" class="mw lv it ms b gy mx my l mz na">for i, file in os.listdir():<br/>    if file.endswith('.csv'):<br/>        os.rename(file, f'2021_{file}')</span></pre><p id="ae16" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想更进一步，您可以使用<a class="ae nf" href="https://docs.python.org/3/library/time.html" rel="noopener ugc nofollow" target="_blank">时间模块</a>将脚本运行的日期添加到文件名等等！</p><h1 id="0945" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">6.检查现有文件</h1><p id="ce56" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">您可以使用OS和Pathlib模块检查文件/目录是否存在。让我们看看文件夹数据集是否存在于我的工作目录中。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="06c7" class="mw lv it ms b gy mx my l mz na"># os<br/>os.path.exists('Dataset')</span><span id="4448" class="mw lv it ms b gy nb my l mz na"># pathlib<br/>check_path = Path('Dataset')<br/>check_path.exists()</span></pre><p id="0f95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果打印上面的代码，Python将在文件夹存在时返回一个<code class="fe nc nd ne ms b">True</code>值，或者在文件夹不存在时返回<code class="fe nc nd ne ms b">False</code>值。因为我有一个名为“数据集”的文件夹，所以我得到了<code class="fe nc nd ne ms b">True</code>。</p><h1 id="d7b4" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">7.[计]元数据</h1><p id="5057" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">元数据是描述其他数据的数据。例如，创建日期、修改日期和文件大小。让我们获取我的工作目录中的一个<code class="fe nc nd ne ms b">test.py</code>脚本的绝对路径。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="5aff" class="mw lv it ms b gy mx my l mz na"># os<br/>os.path.abspath('test.py')</span><span id="4ba6" class="mw lv it ms b gy nb my l mz na"># pathlib<br/>script = Path('test.py')<br/>script.resolve()</span></pre><p id="b303" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打印上面的代码后得到了绝对路径<code class="fe nc nd ne ms b">/Users/frank/PycharmProjects/DataScience/test.py</code>。</p><p id="0aaa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用Pathlib，我们可以很容易地获得文件的词干、后缀、文件大小和出生时间。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="17be" class="mw lv it ms b gy mx my l mz na">In [1]: print(script.stem)<br/>In [2]: print(script.suffix)<br/>In [3]: print(script.stat().st_size)<br/>In [4]: print(script.stat().st_birthtime)</span><span id="f170" class="mw lv it ms b gy nb my l mz na">Out [1]: test<br/>Out [2]: .py<br/>Out [3]: 1060<br/>Out [4]: 1614190828.6</span></pre><p id="5846" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见，出生时间是时间戳格式的。如果您想获得一个datetime对象，运行下面的代码。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="57c0" class="mw lv it ms b gy mx my l mz na">from datetime import datetime<br/><br/>timestamp = 1614190828.6<br/>dt_object = datetime.fromtimestamp(timestamp)<br/><br/>print("dt_object =", dt_object)</span></pre></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="9d62" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nn">就是这样！现在你知道了使用Python可以做的7个文件系统操作，你可以在</em> <a class="ae nf" href="https://docs.python.org/3/library/os.html" rel="noopener ugc nofollow" target="_blank"> <em class="nn"> os </em> </a> <em class="nn">和</em><a class="ae nf" href="https://docs.python.org/3/library/pathlib.html" rel="noopener ugc nofollow" target="_blank"><em class="nn">pathlib</em></a><em class="nn">文档中查看更多操作。</em></p><p id="3d3e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae nf" href="https://frankandrade.ck.page/bd063ff2d3" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">与3k以上的人一起加入我的电子邮件列表，获取我在所有教程中使用的Python for Data Science备忘单(免费PDF) </strong> </a></p></div></div>    
</body>
</html>